{"count":19451,"tag":"hibernate","questions":[{"tags":["hibernate","jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13278544,"title":"Returning a numeric value with hibernate @NamedNativeQuery","body":"<p>I've this question:</p>\n\n<p>\"... if the query just returns a number (i.e., the query is something like ‘select count(id) where…..) I came up against this error</p>\n\n<p><em>org.hibernate.cfg.NotYetImplementedException: Pure native scalar queries are not yet supported</em>\"</p>\n\n<p>For more details see: <a href=\"http://atechnicaljourney.wordpress.com/2012/09/30/hibernate-pure-native-scalar-queries-are-not-yet-supported/\" rel=\"nofollow\">http://atechnicaljourney.wordpress.com/2012/09/30/hibernate-pure-native-scalar-queries-are-not-yet-supported/</a></p>\n\n<p>I don't want to have a wrapper class and especially not some extra table. What is the proper way of doing this?</p>\n"},{"tags":["spring","hibernate","jpa-2.0","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":11238662,"title":"Hibernate not flushing before find() results in null entity (JBoss AS7 container managed emf using jpa2)","body":"<p>I switched my application's entity manager factory from spring-managed to container-managed and have run into a problem. While creating an entity, there are times when I have to query for it within the same transaction that it was originally created in, before it has been flushed automatically at the end. In spring, the entity manager would (I believe) automatically flush the context before running find and be able to return the correct object, but in jboss the find method returns null.</p>\n\n<p>Here is a sample of the problem:</p>\n\n<pre><code>@PersistenceContext\nprivate EntityManager entityManager;\n\nprivate void test(){\n    Person person = new Person(\"firstname\", \"lastname\", \"email\", \"user\", \"pass\", Person.PersonType.admin);\n    entityManager.persist(person);\n    assert person.getId() != null;\n    Person person2 = entityManager.find(Person.class, person.getId());\n    assert person2 != null; //fail in jboss, ok in Spring\n}\n</code></pre>\n\n<p>If I try to add an <code>entityManager.flush()</code> call in between <code>persist()</code> and <code>find()</code> methods, jboss throws a <code>javax.persistence.TransactionRequiredException: no transaction is in progress</code> error, regardless of whether I throw @Transactional annotations around the method/class running the test.</p>\n\n<p>My persistence.xml file sets <code>&lt;property name=\"org.hibernate.FlushMode\" value=\"auto\"/&gt;</code>, but it doesn't seem to be working.</p>\n\n<p>Is there some configuration property that I missed to tell jboss to flush its context to the database before running a Find? Or am I ordering my statements incorrectly?</p>\n\n<p>I've put my <a href=\"http://pastebin.com/BPXxxRbY\" rel=\"nofollow\">persistence.xml</a> and <a href=\"http://pastebin.com/tHjhZTqi\" rel=\"nofollow\">my-ds.xml</a> files on pastebin.</p>\n\n<p>Thanks for the help.</p>\n\n<h2>Edit</h2>\n\n<p>Resolved. See comments below</p>\n"},{"tags":["java","hibernate","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13279462,"title":"Hibernate Caching - Empty table","body":"<p>I left our application running overnight with JProfiler to analyse the performance bottlenecks and something I uncovered was that a query that was executed very frequently was taking up a significant amount of time - nothing new. The difference this time compared to normal was that there was no data in the table. The query did execute quickly (2.8ms) but I was wondering if there was anything I could do to 'cache' the output that there is no results?</p>\n"},{"tags":["mysql","hibernate","jpa","spring-mvc","blob"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13234790,"title":"MySQLSyntaxErrorException while attempting to persist blob with hibernate","body":"<p>I'm creating some simple webpage with Spring MVC, Hibernate4 and MySQL5. One of models I use contains BLOB value (byte[]). When I try to persist that model with <code>entityManager.persist()</code> \nI get MySQLSytnaxException. Actually there are more problems with current configuration, such as persist/merge/remove ignoring @Transactional annotation, but this one is the most critical.</p>\n\n<p>I already tried using <code>session.save(object);</code> or replacing byte[] by Blob. Still the same result. All working examples I found use completely diffirent approach - e.g. they use HibernateSessionManager and HibernateTransactionManager instead of JPA ones - and I would like to found solution that doesn't require complete change in how I persist entities, when I'm still not sure that it would help.</p>\n\n<p>Could You tell me what mistakes I made in code/configuration/assumptions?</p>\n\n<p>Beginning of a stack trace together with Hibernate trace:</p>\n\n<pre><code>Hibernate: \n        insert \n        into\n            updates\n            (changelog, added, developmentVersion, filedata, filedataType, major, minor, nightly, release, package, type, uploader, id) \n        values\n            (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n22:53:10,888 TRACE BasicBinder:83 - binding parameter [1] as [VARCHAR] - sdfsd\n22:53:10,891 TRACE BasicBinder:71 - binding parameter [2] as [DATE] - &lt;null&gt;\n22:53:10,894 TRACE BasicBinder:83 - binding parameter [3] as [BOOLEAN] - false\n22:53:10,898 TRACE BasicBinder:83 - binding parameter [4] as [BLOB] - javax.sql.rowset.serial.SerialBlob@298fd36c\n22:53:10,924 TRACE BasicBinder:83 - binding parameter [5] as [VARCHAR] - image/png\n22:53:10,926 TRACE BasicBinder:83 - binding parameter [6] as [INTEGER] - 1\n22:53:10,928 TRACE BasicBinder:83 - binding parameter [7] as [INTEGER] - 0\n22:53:10,935 TRACE BasicBinder:83 - binding parameter [8] as [INTEGER] - 0\n22:53:10,936 TRACE BasicBinder:83 - binding parameter [9] as [INTEGER] - 0\n22:53:10,939 TRACE BasicBinder:83 - binding parameter [10] as [INTEGER] - 36\n22:53:10,941 TRACE EnumType:292 - Binding {0} to parameter: {1}\n22:53:10,944 TRACE BasicBinder:83 - binding parameter [12] as [INTEGER] - 18\n22:53:10,955 TRACE BasicBinder:83 - binding parameter [13] as [INTEGER] - 0\n22:53:10,998  WARN SqlExceptionHelper:143 - SQL Error: 1064, SQLState: 42000\n22:53:10,999 ERROR SqlExceptionHelper:144 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'release, package, type, uploader, id) values ('sdfsd', null, 0, _binary'â€°PNG\n' at line 1\n22:53:11,027  INFO AbstractBatchImpl:195 - HHH000010: On release of batch it still contained JDBC statements\nNov 07, 2012 10:53:11 PM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet [repoApplication] in context with path [/server] threw exception [Request processing failed; nested exception is org.springframework.dao.InvalidDataAccessResourceUsageException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'release, package, type, uploader, id) values ('sdfsd', null, 0, _binary'â€°PNG\n' at line 1; SQL [n/a]; nested exception is org.hibernate.exception.SQLGrammarException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'release, package, type, uploader, id) values ('sdfsd', null, 0, _binary'â€°PNG\n' at line 1] with root cause\ncom.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'release, package, type, uploader, id) values ('sdfsd', null, 0, _binary'â€°PNG\n' at line 1\n</code></pre>\n\n<p>beans.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    ...\n    &gt;\n\n    ...\n\n    &lt;!-- Hibernate configuration --&gt;    \n\n    &lt;!-- Specifies dataSource object managing connections to database --&gt;  \n    &lt;bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt; \n        &lt;property name=\"driverClassName\" value=\"${database.driver}\" /&gt; \n        &lt;property name=\"url\" value=\"${database.url}\" /&gt; \n        &lt;property name=\"username\" value=\"${database.user}\" /&gt; \n        &lt;property name=\"password\" value=\"${database.password}\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Defines SessionFactory --&gt;\n    &lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        ...\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;util:properties location=\"classpath:Hibernate.properties\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Defines TransactionManager --&gt;\n    &lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n        &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Binds TransactionManager to annotations --&gt;\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\" /&gt;\n\n    &lt;!-- Enables Spring annotations --&gt;\n    &lt;context:annotation-config /&gt;\n\n    ...\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>Hibernate.properties:</p>\n\n<pre><code>hibernate.database         =MYSQL\nhibernate.dialect          =org.hibernate.dialect.MySQL5InnoDBDialect\nhibernate.show_sql         =true\nhibernate.format_sql       =true\nhibernate.use_sql_comments =true\nhibernate.hbm2ddl.auto     =update\n</code></pre>\n\n<p>All tables in MySQL database uses InnoDB engine.</p>\n\n<p>Update.java (model):</p>\n\n<pre><code>import java.sql.Blob;\nimport java.sql.Date;\nimport java.sql.SQLException;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.EnumType;\nimport javax.persistence.Enumerated;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.Lob;\nimport javax.persistence.ManyToOne;\nimport javax.persistence.Table;\nimport javax.persistence.Transient;\nimport javax.sql.rowset.serial.SerialBlob;\nimport javax.validation.constraints.NotNull;\n\nimport org.hibernate.annotations.Type;\nimport org.hibernate.validator.constraints.NotEmpty;\nimport org.springframework.web.multipart.commons.CommonsMultipartFile;\n\n...\n\n@Entity\n@Table(name = \"updates\")\n@VersionNumberCorrect\npublic class Update {\n    @Id\n    @Column(name = \"id\", unique = true)\n    private int id;\n\n    @NotNull\n    @ManyToOne\n    @JoinColumn(name = \"package\")\n    private Package thePackage;\n\n    @NotNull\n    @ManyToOne\n    @JoinColumn(name = \"uploader\")\n    private User uploader;\n\n    @Column(name = \"added\")\n    private Date date;\n\n    @Column(name = \"changelog\")\n    @NotNull\n    @NotEmpty\n    private String changelog;\n\n    @Column(name = \"major\")\n    private int major;\n\n    @Column(name = \"minor\")\n    private int minor;\n\n    @Column(name = \"release\")\n    private int release;\n\n    @Column(name = \"nightly\")\n    private int nightly;\n\n    @Column(name = \"developmentVersion\")\n    private boolean developmentVersion;\n\n    @Column(name = \"type\")\n    @Enumerated(EnumType.ORDINAL)\n    private EUpdateStrategy type;\n\n    @Column(name = \"filedata\")\n    @Lob\n    @Type(type = \"blob\")\n    @NotNull\n    private Blob filedata;\n\n    @Column(name = \"filedataType\")\n    private String filedataType;\n\n    public Update() {\n    }\n\n    ...\n}\n</code></pre>\n\n<p>UpdateServiceImp.java (Service):</p>\n\n<pre><code>import java.sql.SQLException;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport javax.persistence.EntityManager;\nimport javax.persistence.EntityManagerFactory;\nimport javax.persistence.EntityTransaction;\n\nimport org.hibernate.Hibernate;\nimport org.hibernate.Session;\nimport org.hibernate.criterion.Order;\nimport org.hibernate.criterion.Restrictions;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\n...\n\n@Service\n@Transactional\npublic class UpdateServiceImp implements UpdateService {\n    @Autowired\n    private SessionFactory sessionFactory;\n\n    @Override\n    public void persist(Update update) {\n        getSession().persist(update);\n    }\n\n    @Override\n    public Update merge(Update update) {\n        return (Update) getSession().merge(update);\n    }\n\n    @Override\n    public void remove(Update update) {\n        getSession().delete(update);\n    }\n\n    ...\n\n    /**\n     * Returns new Session instance.\n     * \n     * @return new Session\n     */\n    private Session getSession() {\n        return sessionFactory.getCurrentSession();\n    }\n}\n</code></pre>\n\n<p>EDIT: \nI changed EntityManagerManager usage into Hibernate's SessionFactory - I tried to change that thinking it might help. It didn't, but code got a little bit cleaner :). I've added some information from Hibernate log that might be helpful. I've also added Hibernate.properties content, since this error is most likely something Hibernate configuration related.</p>\n"},{"tags":["hibernate","tapestry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13270783,"title":"What am i doing in this postgreSQL configuration (Tapestry)","body":"<p><strong>hibernate.cfg.xml</strong></p>\n\n<pre><code> &lt;session-factory&gt;\n                &lt;property name=\"hibernate.connection.driver_class\"&gt;org.postgresql.Driver&lt;/property&gt;\n                &lt;property name=\"hibernate.connection.url\"&gt;jdbc:postgresql://localhost:5432/thetable&lt;/property&gt;\n                &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;\n                &lt;property name=\"hibernate.connection.username\"&gt;postgres&lt;/property&gt;\n                &lt;property name=\"hibernate.connection.password\"&gt;postgres123&lt;/property&gt;\n                &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n                &lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt;\n&lt;/session-factory&gt;\n</code></pre>\n\n<p><strong>pom.xml</strong></p>\n\n<pre><code>&lt;dependency&gt;\n            &lt;groupId&gt;org.apache.tapestry&lt;/groupId&gt;\n            &lt;artifactId&gt;tapestry-hibernate&lt;/artifactId&gt;\n            &lt;version&gt;${tapestry-release-version}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n        &lt;groupId&gt;postgresql&lt;/groupId&gt;\n        &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n        &lt;version&gt;9.1-901.jdbc4&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p><strong>ERROR</strong></p>\n\n<pre><code>HTTP ERROR 500\n\nProblem accessing /blah/balahhh. Reason:\n\n    Exception constructing service 'ValueEncoderSource': Error invoking service contribution method org.apache.tapestry5.hibernate.HibernateModule.contributeValueEncoderSource(MappedConfiguration, boolean, HibernateSessionSource, Session, TypeCoercer, PropertyAccess, LoggerSource): Exception constructing service 'HibernateSessionSource': Error invoking constructor public org.apache.tapestry5.internal.hibernate.HibernateSessionSourceImpl(org.slf4j.Logger,java.util.List): Could not initialize class org.hibernate.annotations.common.reflection.java.JavaReflectionManager \n</code></pre>\n\n<p>It worked before when i use a \"hsqldb\". But now i get the shown error.</p>\n"},{"tags":["hibernate","jpa","mapping","native"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1257,"score":0,"question_id":3436913,"title":"Map a NativeQuery into an entity","body":"<p>I'm having trouble trying to map a native SQL query using JPA, and Hibernate as a provider. This is the code for the entity that I'm using for this purpose:</p>\n\n<pre><code>package com.prueba.entities;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.EntityResult;\nimport javax.persistence.FieldResult;\nimport javax.persistence.Id;\nimport javax.persistence.NamedNativeQuery;\nimport javax.persistence.SqlResultSetMapping;\n\n@Entity\n@SqlResultSetMapping(name=\"CustomerOrderInfo\",entities=@EntityResult(entityClass=com.prueba.entities.JoinEntity.class,\n        fields={@FieldResult(name=\"id\",column=\"id\"),@FieldResult(name=\"title\",column=\"title\"),\n                @FieldResult(name=\"firstName\",column=\"firstName\"),@FieldResult(name=\"lastName\",column=\"lastName\"),\n                @FieldResult(name=\"orderId\",column=\"oderId\"),@FieldResult(name=\"shipping\",column=\"shipping\")}))\n@NamedNativeQuery(name=\"CustomerOrderInfoJoin\",query=\"SELECT c.customer_id as id,c.title as title ,c.fname as firstName,c.lname as lastName,\"+\n\"o.orderinfo_id as orderId,\"+\n\"o.shipping as shipping FROM customer c,orderinfo o WHERE\"+\n\"c.customer_id=o.customer_id\")\npublic class JoinEntity {\n    @Id\n    private Integer id;\n    @Column\n    private String title;\n    @Column\n    private String firstName;\n    @Column\n    private String lastName;\n    @Column\n    private Integer orderId;\n    @Column\n    private Double shipping;\n\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public String getFirstName() {\n        return firstName;\n    }\n\n    public void setFirstName(String firstName) {\n        this.firstName = firstName;\n    }\n\n    public String getLastName() {\n        return lastName;\n    }\n\n    public void setLastName(String lastName) {\n        this.lastName = lastName;\n    }\n\n    public Integer getOrderId() {\n        return orderId;\n    }\n\n    public void setOrderId(Integer orderId) {\n        this.orderId = orderId;\n    }\n\n    public Double getShipping() {\n        return shipping;\n    }\n\n    public void setShipping(Double shipping) {\n        this.shipping = shipping;\n    }\n\n\n}\n</code></pre>\n\n<p>When I try to deploy this entity using JBoss AS 5.1, I get the following exception:</p>\n\n<pre><code>DEPLOYMENTS IN ERROR:\n  Deployment \"&lt;UNKNOWN jboss.j2ee:jar=Prueba.jar,name=CustomerSessionImpl,service=EJB3&gt;\" is in error due to the following reason(s): ** UNRESOLVED Demands 'persistence.unit:unitName=#pruebaPU' **\n  Deployment \"persistence.unit:unitName=#pruebaPU\" is in error due to the following reason(s): org.hibernate.cfg.NotYetImplementedException: Pure native scalar queries are not yet supported\n  Deployment \"&lt;UNKNOWN jboss.j2ee:jar=Prueba.jar,name=OrderInfoSessionImpl,service=EJB3&gt;\" is in error due to the following reason(s): ** UNRESOLVED Demands 'persistence.unit:unitName=#pruebaPU' **\n</code></pre>\n\n<p>I really don't understand what does this exception mean, and also I wanted to as what should I modify in order to get that Native sql mapped into my entity?. Thanks a lot.</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13273944,"title":"Trying to use the @transient variable in a different class","body":"<p>I am working on a project that is writing to the database using Hibernate. </p>\n\n<p>I have an Abstract POJO for the model</p>\n\n<p><strong>Removed code</strong></p>\n\n<p>There isn't anything special going on in the subclasses. But I have a controller class that I'm trying to modify some of the data. I want to use the Transient variable, but its not letting me. I am doing this in the other class</p>\n\n<p><strong>REMOVED CODE</strong></p>\n\n<p>Then I call an iterator to take what is in the database and add it to the map. This all is working fine.</p>\n\n<p>My main question, \nWhen I do temp.setDescription...it isn't saving a description element in the temp object. Therefore it isn't passing to the map.</p>\n\n<p>Any suggestions? I hope I provided enough information</p>\n"},{"tags":["hibernate","ireport"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":5,"score":1,"question_id":13276928,"title":"ireport with hibernate, Could not instantiate dialect class","body":"<p>I am working with hibernate and iReport, configure the classpath well, but I get this error Could not instantiate dialect class, esoty working with SQLServer.</p>\n\n<p>this is the dialect</p>\n\n<pre><code>&lt;property name=\"dialect\"&gt; org.hibernate.dialect.SQLServerDialect &lt;/property&gt;\n</code></pre>\n\n<p>Thanks for your time.</p>\n"},{"tags":["hibernate","hibernate-envers"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13243096,"title":"Hibernate Envers throwing EntityNotFoundException when fetching deleted parent objects","body":"<p>I have the following simple data structure (details omitted for brevity):</p>\n\n<pre><code>@Audited\n@Entity\nclass SettingsGroup implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    Integer id\n\n    @OneToMany(mappedBy = \"group\", cascade = [CascadeType.ALL])\n    @OrderBy(\"key\")\n    List&lt;SettingsEntry&gt; entries = []\n\n}\n\n\n\n@Audited\n@Entity\nclass SettingsEntry implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    Integer id\n\n    @ManyToOne\n    SettingsGroup group\n\n}\n</code></pre>\n\n<p>I've set the org.hibernate.envers.store_data_at_delete=true flag. Upon fetching the revisions for SettingsEntry, it will throw an EntityNotFoundException while trying to lazy fetch the associated group from the _aud table.</p>\n\n<pre><code>def reader = AuditReaderFactory.get(manager)\ndef query = reader.createQuery().forRevisionsOfEntity(SettingsEntry, false, true)\naudits = query.resultList.collect {\n    //noinspection GroovyAssignabilityCheck\n    new AuditRevision&lt;T&gt;(entity:it[0], revision: it[1], type: it[2])\n}   \n</code></pre>\n\n<p>I took a look at the SQL generated and it appears to be filtering out delete revision types while trying to fetch the parent record which causes no records to show up:</p>\n\n<pre><code>select *\nfrom settings_group_aud sg \nwhere sg.rev=(\n  select max(sg2.rev) from settings_group_aud sg2 where sg2.rev&lt;=3 and sg.id=sg2.id\n) and sg.revtype&lt;&gt;2 and sg.id=1\n</code></pre>\n\n<p>There are records in the table.. it just that the most recent is a delete:</p>\n\n<pre><code>select * from SETTINGS_GROUP_AUD;\nID      NAME    ENVIRONMENT     KEY_NAME    REV     REVTYPE  \n1   test    prod    Default Key 2   0\n1   test    prod    Default Key 3   2\n(2 rows, 1 ms)\n</code></pre>\n\n<p>Is there  a way to tweak the lazy initialization within Envers to prevent the filtering of deleted rev types? That would fix my problem. I'm just not seeing anything which is configurable.</p>\n\n<p>My other option is to just off org.hibernate.envers.store_data_at_delete again but I'd prefer to keep it on if possible. This seems a little like a bug but I'm new to Envers so maybe I'm just looking at this all wrong :-)</p>\n"},{"tags":["hibernate","reverse-engineering","hibernate-mapping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13274524,"title":"Hibernate reverse engineering for particular tables in a schema","body":"<p>I have installed Hibernate tool with eclipse for reverse enginnering. Now, I want to generate POJO and xml files for a new set of tables in a schema. When i rightclick and 'Hibernate code generation configurations' it filters the schema and not the table. As a result the entire tables in the schema is reverse engineered. How do i reverse engg paticular set of tables?</p>\n\n<p>any inputs pls?</p>\n"},{"tags":["mysql","hibernate","jpa","playframework","full-text-search"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13095283,"title":"How can I search playframework JPA entities without sacrificing good performance?","body":"<p>I'm using playframework 1.2.4 and JPA for persistent storage.  In the <a href=\"http://www.playframework.org/documentation/1.2.4/jpa#Findusingasimplifiedquery\" rel=\"nofollow\">playframework documentation</a> there are many references of using the \"like\" operator to find entities.  I can see using this  for a search operation, but because the \"like\" operator does a full table scan, this is going to be really slow as I have more and more entities.  In other words, it doesn't scale.  What is a scalable way to search for entities efficiently?  I know that Mysql has a FullText feature to solve this problem, but how can I access this feature using JPA in playframework?</p>\n"},{"tags":["ajax","hibernate","jsf","primefaces","ejb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13215335,"title":"Generate primefaces ajax tree on demand?","body":"<p>I have a project using JSF primefaces and EJB managed Beans with hibernate storage.\n <a href=\"http://www.primefaces.org/showcase/ui/treeAjax.jsf\" rel=\"nofollow\">http://www.primefaces.org/showcase/ui/treeAjax.jsf</a></p>\n\n<p>Question: I keep on getting a out of memory or stack overflow errors can you see a problem with my recursion?</p>\n\n<pre><code>@ManagedBean(name = \"categoryController\")\n@RequestScoped\npublic class CategoryController implements Serializable {\n    ...\n\n    @EJB\n    private CategoryFacade ejbFacade;\n    private TreeNode root;\n\n    public TreeNode getRoot() {\n        return root;\n    }\n\n    @PostConstruct\n    public void init() {\n        root = new DefaultTreeNode(\"Root\", null);\n        System.out.print(\"Facade value=\" + getFacade());\n        Category categoryRoot = getFacade().find(new Integer(1));\n        getSubcategories(categoryRoot, root);\n\n    }\n\n    private void getSubcategories(Category categoryRoot, TreeNode root) {\n        List&lt;Category&gt; list = getFacade().findByNamedQuery(\"Category.findByPCatid\", \"pcatid\", categoryRoot);\n        Iterator&lt;Category&gt; it = list.iterator();\n        while (it.hasNext()) {\n            Category subcategory = it.next();\n            TreeNode nextNode = new DefaultTreeNode(subcategory.getUcatid(), root);\n            getSubcategories(subcategory, nextNode);\n\n        }\n\n    }\n\n    ...\n}\n</code></pre>\n"},{"tags":["hibernate","java-ee","mappingexception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13273750,"title":"org.hibernate.MappingException: Unable to find column with logical name:","body":"<p>I have this TABLES:</p>\n\n<p>1.- PARTICIPANTE</p>\n\n<pre><code>CREATE TABLE participante ( \n    id_participa    SMALLINT NOT NULL,\n    nasi            INTEGER NOT NULL,\n    PRIMARY KEY(id_participa,nasi),\n    FOREIGN KEY(nasi) REFERENCES persona(nasi)\n)\n</code></pre>\n\n<p>2.- PERSONA </p>\n\n<pre><code>CREATE TABLE persona ( \n    nasi        INTEGER NOT NULL,\n    PRIMARY KEY(nasi)\n)\n</code></pre>\n\n<p>3.- CITA    </p>\n\n<pre><code>CREATE TABLE cita ( \n    id_participa    SMALLINT NOT NULL,\n    nasi            INTEGER NOT NULL,\n    idcita          INTEGER NOT NULL,\n    PRIMARY KEY(id_participa,idcita,nasi),\n    FOREIGN KEY(id_participa, nasi) REFERENCES participante(id_participa, nasi)\n)\n</code></pre>\n\n<p>4.- FORMULARIO</p>\n\n<pre><code>CREATE TABLE formulario ( \n        id_participa        SMALLINT NOT NULL,\n        nasi                INTEGER NOT NULL,\n        idcita              INTEGER NOT NULL,\n        PRIMARY KEY(id_participa,idcita,nasi),\n        FOREIGN KEY(id_participa, nasi, idcita) REFERENCES cita(id_participa, nasi, idcita)\n    )\n</code></pre>\n\n<p>(among other fields, I just show you the ones that are involved in the problem)</p>\n\n<p>and here are the ENTITIES:</p>\n\n<p>1.- PARTICIPANTE</p>\n\n<pre><code>@Entity\n@Table(name = \"participante\")\npublic class Participante implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n    @Id\n    @Column(name = \"id_participa\")\n    private Integer idParticipante;\n    @Id\n    @OneToOne\n    @JoinColumn(name = \"nasi\")\n    private Persona persona;\n</code></pre>\n\n<p>2.- PERSONA</p>\n\n<pre><code>@Entity\n@Table(name = \"persona\")\npublic class Persona implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n    @Id\n    @Column(name = \"nasi\")\n    private Integer nasi;\n</code></pre>\n\n<p>3.- CITA</p>\n\n<pre><code>@Entity\n@Table(name = \"cita\")\npublic class Cita implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n    @Id\n    @Column(name = \"idcita\")\n    private Integer idCita;\n    @Id\n    @ManyToOne\n    @JoinColumns({\n            @JoinColumn(name = \"id_participa\", referencedColumnName = \"id_participa\"),\n            @JoinColumn(name = \"nasi\", referencedColumnName = \"nasi\") })\n    private Participante participante;\n</code></pre>\n\n<p>4.- FORMULARIO</p>\n\n<pre><code>@Entity\n@Table(name = \"formulario\")\npublic class Formulario implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n    @Id\n    @OneToOne\n    @JoinColumns({\n            @JoinColumn(name = \"id_participa\", referencedColumnName = \"id_participa\"),\n            @JoinColumn(name = \"nasi\", referencedColumnName = \"nasi\"),\n            @JoinColumn(name = \"idcita\", referencedColumnName = \"idcita\") })\n    private Cita cita;\n</code></pre>\n\n<p>And when I try to start the server I got this exception:</p>\n\n<pre><code>Caused by: org.hibernate.MappingException: Unable to find column with logical name: nasi in participante\n    at org.hibernate.cfg.Ejb3JoinColumn.checkReferencedColumnsType(Ejb3JoinColumn.java:575)\n    at org.hibernate.cfg.BinderHelper.createSyntheticPropertyReference(BinderHelper.java:126)\n    at org.hibernate.cfg.ToOneFkSecondPass.doSecondPass(ToOneFkSecondPass.java:116)\n    at org.hibernate.cfg.Configuration.processEndOfQueue(Configuration.java:1514)\n    at org.hibernate.cfg.Configuration.processFkSecondPassInOrder(Configuration.java:1437)\n    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1355)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1724)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1775)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:242)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:372)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:357)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    ... 73 more\n</code></pre>\n"},{"tags":["hibernate","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13256245,"title":"It is possible to do such mapping with XML?","body":"<p>I have found solution for my task here: <a href=\"http://stackoverflow.com/questions/8494367/mixing-joined-and-single-table-inheritance-and-querying-for-all-objects\">mixing-joined-and-single-table-inheritance</a>.\nQuestion contains example where mixed two inheritance strategies: joined with single table.\nBut, is it possible to convert this annotation mapping to XML mapping?</p>\n\n<pre><code>@Entity\n@Inheritance(strategy = InheritanceType.JOINED)\n@Table(name = \"animals\")\npublic abstract class Animal { ...\n\n@MappedSuperclass\n@Inheritance(strategy = InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name = \"type\")\npublic abstract class Mammal extends Animal { ...\n\n@Entity\n@Table(name = \"mammals\")\n@PrimaryKeyJoinColumn(name = \"mammal_id\")\n@DiscriminatorValue(value = \"dog\")\npublic class Dog extends Mammal { ...\n\n@Entity\n@Table(name = \"mammals\")\n@PrimaryKeyJoinColumn(name = \"mammal_id\")\n@DiscriminatorValue(value = \"cat\")\npublic class Cat extends Mammal { ...\n</code></pre>\n"},{"tags":["spring","hibernate","jpa","jdbc","tomcat7"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13260768,"title":"Cannot create JDBC driver of class '' for connect URL 'null' java.lang.NullPointerException Tomcat 7 Hibernate 4 Spring 3","body":"<p>Help!  I've googled and searched StackOverflow and nothing has fixed the stack trace below.</p>\n\n<p>How do I debug the situation to find the source of the NullPointerException?  Is there a way to have Hibernate or Spring show me the exact line in the configuration XML files which is causing this issue?</p>\n\n<p>Configuration:</p>\n\n<ul>\n<li>Tomcat 7 </li>\n<li>Hibernate 4 </li>\n<li>Spring 3 </li>\n<li>Struts 2 </li>\n<li>CentOS 6.3</li>\n<li>mysql-connector-java-5.1.20.jar is located in tomcat/lib</li>\n</ul>\n\n<p>tomcat/conf/server.xml: </p>\n\n<pre><code>&lt;Context docBase=\"ROOT\" path=\"/\" reloadable=\"false\"\n                         source=\"org.eclipse.jst.j2ee.server:ddddd\"&gt;\n                    &lt;Resource name=\"jdbc/cccc\" auth=\"Container\" type=\"javax.sql.DataSource\"\n                              maxActive=\"30\" maxIdle=\"15\" maxWait=\"300000\" removeAbandoned=\"true\"\n                              removeAbandonedTimeout=\"20\" driverClassName=\"com.mysql.jdbc.Driver\"\n                              logAbandoned=\"true\" username=\"aaaa\" password=\"bbbb\"\n                              url=\"jdbc:mysql://xxxx:yyyy/zzzzz\" /&gt;\n                &lt;/Context&gt;\n</code></pre>\n\n<p>WAR applicationContext.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:aop=\"http://www.springframework.org/schema/aop\"\n       xmlns:context=\"http://www.springframework.org/schema/context\"\n       xmlns:tx=\"http://www.springframework.org/schema/tx\"\n       xmlns:task=\"http://www.springframework.org/schema/task\"\n       xsi:schemaLocation=\"\n    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd\n    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd\n    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd\n    http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd\n    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd\" default-autowire=\"autodetect\"&gt;\n\n    &lt;context:property-placeholder location=\"classpath:amqp_connection.properties\"/&gt;\n    &lt;import resource=\"rabbit-config.xml\"/&gt;\n\n    &lt;task:annotation-driven scheduler=\"myScheduler\"/&gt;\n    &lt;task:scheduler id=\"myScheduler\" pool-size=\"10\"/&gt;\n\n   &lt;various beans/&gt;\n    &lt;bean class=\"org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor\"/&gt;\n    &lt;bean class=\"org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor\" /&gt;\n\n    &lt;!--  JPA implementation --&gt;\n    &lt;bean id=\"entityManagerFactory\"\n      class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"jndiDataSource\" /&gt;\n    &lt;property name=\"persistenceUnitName\" value=\"punit\"/&gt;\n    &lt;property name=\"jpaVendorAdapter\"&gt;\n        &lt;bean\n        class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n        &lt;property name=\"showSql\" value=\"false\" /&gt;\n        &lt;property name=\"database\" value=\"MYSQL\" /&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean \n    class=\"org.springframework.beans.factory.config.MethodInvokingFactoryBean\" \n    lazy-init=\"false\"&gt; \n    &lt;property name=\"targetObject\" ref=\"jndiDataSource\" /&gt; \n    &lt;property name=\"targetMethod\" value=\"addConnectionProperty\" /&gt; \n    &lt;property name=\"arguments\"&gt; \n        &lt;list&gt; \n        &lt;value&gt;characterEncoding&lt;/value&gt; \n        &lt;value&gt;UTF-8&lt;/value&gt; \n        &lt;/list&gt; \n    &lt;/property&gt; \n    &lt;/bean&gt; \n\n    &lt;bean id=\"jndiDataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n    &lt;property name=\"jndiName\" value=\"java:comp/env/jdbc/cccc\" /&gt;\n    &lt;property name=\"resourceRef\" value=\"false\" /&gt;\n    &lt;property name=\"defaultObject\" value=\"dummy\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\"\n      class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n    &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- The 'proxy-target-class=\"true\"' is to correctly autowire classes that implement interfaces.\n    e.g ReportUserDAO. All it means is that Spring will inject the concrete class instead of an\n    auto-proxied object that only implements the interface. --&gt;\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\" proxy-target-class=\"true\"/&gt;\n\n    &lt;!-- the transactional advice (i.e. what 'happens'; see the &lt;aop:advisor/&gt; bean below) --&gt;\n    &lt;tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\"&gt;\n    &lt;!-- the transactional semantics... --&gt;\n    &lt;tx:attributes&gt;\n        &lt;!-- all methods starting with 'get' are read-only (optimization) --&gt;\n        &lt;tx:method name=\"get*\" read-only=\"true\"/&gt;\n        &lt;!-- other methods use the default transaction settings (see below) --&gt;\n        &lt;tx:method name=\"*\"/&gt;\n    &lt;/tx:attributes&gt;\n    &lt;/tx:advice&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>Stack Trace:</p>\n\n<pre><code>Cannot create JDBC driver of class '' for connect URL 'null'\njava.lang.NullPointerException\n        at sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(JdbcOdbcDriver.java:507)\n        at sun.jdbc.odbc.JdbcOdbcDriver.knownURL(JdbcOdbcDriver.java:476)\n        at sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(JdbcOdbcDriver.java:307)\n        at java.sql.DriverManager.getDriver(DriverManager.java:253)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)\n        at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:70)\n        at org.hibernate.engine.jdbc.internal.JdbcServicesImpl$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcServicesImpl.java:242)\n        at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.configure(JdbcServicesImpl.java:117)\n        at org.hibernate.service.internal.StandardServiceRegistryImpl.configureService(StandardServiceRegistryImpl.java:75)\n        at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:159)\n        at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:131)\n        at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:71)\n        at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2277)\n        at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2273)\n        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1742)\n        at org.hibernate.ejb.EntityManagerFactoryImpl.&lt;init&gt;(EntityManagerFactoryImpl.java:94)\n        at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:905)\n        at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:890)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:74)\n        at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:268)\n        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:310)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n        at org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.findDefaultEntityManagerFactory(PersistenceAnnotationBeanPostProcessor.java:530)\n        at org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.findEntityManagerFactory(PersistenceAnnotationBeanPostProcessor.java:496)\n        at org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor$PersistenceElement.resolveEntityManager(PersistenceAnnotationBeanPostProcessor.java:657)\n        at org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor$PersistenceElement.getResourceToInject(PersistenceAnnotationBeanPostProcessor.java:630)\n        at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:159)\n        at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n        at org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.postProcessPropertyValues(PersistenceAnnotationBeanPostProcessor.java:339)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)\n        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)\n        at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:313)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)\n        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)\n        at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n        at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doG59737 [localhost-startStop-1] \n\n\nINFO  c.t.u.m.j.JdbcMigrationLauncherFactory - Creating JdbcMigrationLauncher for web-application.\n59882 [localhost-startStop-1] \n\n\nINFO  c.t.u.m.MigrationRunnerFactory - Using specified migration strategy: 'com.tacitknowledge.util.migration.MissingPatchMigrationRunnerStrategy'\n60182 [localhost-startStop-1] \n\n\nERROR c.t.u.m.j.WebAppJNDIMigrationLauncher - java.lang.RuntimeException: Migration exception caught during migration\nMigration exception caught during migration\njava.lang.RuntimeException: Migration exception caught during migration\n        at com.tacitknowledge.util.migration.jdbc.WebAppJNDIMigrationLauncher.contextInitialized(WebAppJNDIMigrationLauncher.java:87)\n        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:963)\n        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1600)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)\nCaused by: com.tacitknowledge.util.migration.MigrationException: Unable to create a connection.\n        at com.tacitknowledge.util.migration.jdbc.PatchTable.createPatchStoreIfNeeded(PatchTable.java:117)\n        at com.tacitknowledge.util.migration.jdbc.PatchTable.isPatchStoreLocked(PatchTable.java:223)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.waitForFreeLock(JdbcMigrationLauncher.java:587)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.lockPatchStore(JdbcMigrationLauncher.java:546)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.doMigrations(JdbcMigrationLauncher.java:477)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.doMigrations(JdbcMigrationLauncher.java:136)\n        at com.tacitknowledge.util.migration.jdbc.util.MigrationUtil.doMigrations(MigrationUtil.java:46)\n        at com.tacitknowledge.util.migration.jdbc.WebAppJNDIMigrationLauncher.contextInitialized(WebAppJNDIMigrationLauncher.java:79)\n        ... 14 more\nCaused by: org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)\n        at com.tacitknowledge.util.migration.jdbc.DataSourceMigrationContext.getConnection(DataSourceMigrationContext.java:76)\n        at com.tacitknowledge.util.migration.jdbc.PatchTable.createPatchStoreIfNeeded(PatchTable.java:99)\n        ... 21 more\nCaused by: java.lang.NullPointerException\n        at sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(JdbcOdbcDriver.java:507)\n        at sun.jdbc.odbc.JdbcOdbcDriver.knownURL(JdbcOdbcDriver.java:476)\n        at sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(JdbcOdbcDriver.java:307)\n        at java.sql.DriverManager.getDriver(DriverManager.java:253)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)\n        ... 25 more\nMigration exception caught during migration\njava.lang.RuntimeException: Migration exception caught during migration\n        at com.tacitknowledge.util.migration.jdbc.WebAppJNDIMigrationLauncher.contextInitialized(WebAppJNDIMigrationLauncher.java:87)\n        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:963)\n        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1600)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)\nCaused by: com.tacitknowledge.util.migration.MigrationException: Unable to create a connection.\n        at com.tacitknowledge.util.migration.jdbc.PatchTable.createPatchStoreIfNeeded(PatchTable.java:117)\n        at com.tacitknowledge.util.migration.jdbc.PatchTable.isPatchStoreLocked(PatchTable.java:223)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.waitForFreeLock(JdbcMigrationLauncher.java:587)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.lockPatchStore(JdbcMigrationLauncher.java:546)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.doMigrations(JdbcMigrationLauncher.java:477)\n        at com.tacitknowledge.util.migration.jdbc.JdbcMigrationLauncher.doMigrations(JdbcMigrationLauncher.java:136)\n        at com.tacitknowledge.util.migration.jdbc.util.MigrationUtil.doMigrations(MigrationUtil.java:46)\n        at com.tacitknowledge.util.migration.jdbc.WebAppJNDIMigrationLauncher.contextInitialized(WebAppJNDIMigrationLauncher.java:79)\n        ... 14 more\nCaused by: org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)\n        at com.tacitknowledge.util.migration.jdbc.DataSourceMigrationContext.getConnection(DataSourceMigrationContext.java:76)\n        at com.tacitknowledge.util.migration.jdbc.PatchTable.createPatchStoreIfNeeded(PatchTable.java:99)\n        ... 21 more\nCaused by: java.lang.NullPointerException\n        at sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(JdbcOdbcDriver.java:507)\n        at sun.jdbc.odbc.JdbcOdbcDriver.knownURL(JdbcOdbcDriver.java:476)\n        at sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(JdbcOdbcDriver.java:307)\n        at java.sql.DriverManager.getDriver(DriverManager.java:253)\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)\n        ... 25 more\n\n\nNov 6, 2012 12:06:50 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error listenerStart\n\n\nNov 6, 2012 12:06:50 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Context [] startup failed due to previous errors\n\n\nNov 6, 2012 12:06:51 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [] appears to have started a thread named [perf4j-async-stats-appender-sink-CoalescingStatistics] but has failed to stop it. This is very likely to create a memory leak.\n\n\nNov 6, 2012 12:06:51 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads\nSEVERE: The web application [] appears to have started a thread named [myScheduler-1] but has failed to stop it. This is very likely to create a memory leak.\n\n\nNov 6, 2012 12:06:51 PM org.apache.catalina.loader.WebappClassLoader loadClass\nINFO: Illegal access: this web application instance has been stopped already.  Could not load org.hibernate.engine.spi.ActionQueue.  The eventual following stack trace is caused by an error thrown for debugging purposes as well as to attempt to terminate the thread which caused the illegal access, and has no functional impact.\njava.lang.IllegalStateException\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1600)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)\n        at org.hibernate.internal.SessionImpl.&lt;init&gt;(SessionImpl.java:238)\n        at org.hibernate.internal.SessionFactoryImpl$SessionBuilderImpl.openSession(SessionFactoryImpl.java:1839)\n        at org.hibernate.ejb.EntityManagerImpl.getRawSession(EntityManagerImpl.java:121)\n        at org.hibernate.ejb.EntityManagerImpl.getSession(EntityManagerImpl.java:97)\n        at org.hibernate.ejb.AbstractEntityManagerImpl.setDefaultProperties(AbstractEntityManagerImpl.java:273)\n        at org.hibernate.ejb.AbstractEntityManagerImpl.postInit(AbstractEntityManagerImpl.java:181)\n        at org.hibernate.ejb.EntityManagerImpl.&lt;init&gt;(EntityManagerImpl.java:89)\n        at org.hibernate.ejb.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:179)\n        at org.hibernate.ejb.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:174)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:376)\n        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:517)\n        at $Proxy132.createEntityManager(Unknown Source)\n        at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:234)\n        at $Proxy133.find(Unknown Source)\n        at com.picsauditing.dao.FeatureToggleDAO.find(FeatureToggleDAO.java:20)\n        at com.picsauditing.dao.FeatureToggleDAO.findFeatureToggle(FeatureToggleDAO.java:12)\n        at com.picsauditing.dao.FeatureToggleDAO$$FastClassByCGLIB$$47d66cf5.invoke(&lt;generated&gt;)\n        at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\n        at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:618)\n        at com.picsauditing.dao.FeatureToggleDAO$$EnhancerByCGLIB$$ab7976be.findFeatureToggle(&lt;generated&gt;)\n        at com.picsauditing.toggle.FeatureToggleCheckerGroovy.scriptBodyFromProperty(FeatureToggleCheckerGroovy.java:100)\n        at com.picsauditing.toggle.FeatureToggleCheckerGroovy.script(FeatureToggleCheckerGroovy.java:69)\n        at com.picsauditing.toggle.FeatureToggleCheckerGroovy.isFeatureEnabled(FeatureToggleCheckerGroovy.java:46)\n        at com.picsauditing.messaging.subscription.EmailSubscriptionPoller.pollForMessage(EmailSubscriptionPoller.java:46)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:64)\n        at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:53)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)\n        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13273933,"title":"Is it possible to avoid that the Hibernate put a single quote when setString is invoked?","body":"<p>I am using Hibernate and I configured an SQL-Query in HBM file with one parameter. I would like to set to this parameter some value like an expression, but the Hibernate encloses the value with single quotes.</p>\n\n<p>Example:</p>\n\n<pre><code>&lt;sql-query name=\"myQuery\"&gt;\n    select A,B from table where A in (:words)\n&lt;/sql-query&gt;\n\nhibernateSession.getNamedQuery(\"myQuery\").setString(\"words\", \"soundex('someWord1'), soundex('someWord2')\");\n\n// As a result:\n\nselect A,B from table where A in ('soundex('someWord1'), soundex('someWord2')')\n</code></pre>\n\n<p>So it's not working! I would like to get the following as a result: </p>\n\n<pre><code>hibernateSession.getNamedQuery(\"myQuery\").setString(\"words\", \"soundex('someWord1'), soundex('someWord2')\");\n=&gt; select A,B from table where A in (soundex('someWord1'), soundex('someWord2'))\n</code></pre>\n\n<p>Is it possible using a SQL-Query configured in hbm file?</p>\n\n<p>Thanks</p>\n"},{"tags":["hibernate","orm","mapping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13273872,"title":"Hibernate ORM - Mapping relationships between two classes that extend from the same base class","body":"<p>I have a base domain class called 'Service' and about 3 other classes that extend it to add one or two properties for specialized instances.  These classes keep track of the existence/location/metadata of various web services.  My service class is annotated as follows:</p>\n\n<pre><code>@Entity\n@Inheritance(strategy=InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name=\"servicediscriminator\", discriminatorType=DiscriminatorType.STRING)\n@DiscriminatorValue(\"Service\")\n@Table(name = \"services\")\n</code></pre>\n\n<p>So of the two sublcasses, call them ServiceA and ServiceB, they represent real live web services... ServiceA contains a whole lot of data and can take quite a while to query.  ServiceB contains a small subset of the data in ServiceA and is used like a registry to keep track of all the instances of ServiceA.</p>\n\n<p>I want to add a <code>Set&lt;Long&gt;</code> of id's in both ServiceA and ServiceB -- ServiceA will maintain a set of all ServiceB's that have indexed it and are aware of it.  SerivceB will have a set of all of the ServiceA's that it knows about. </p>\n\n<p>It would seem if these were in separate tables, I would use an @ManyToMany relationship with a @JoinColumn, but since they're in the same table, I don't know how to create the mapping correctly.  I'm sure it's probably pretty simple, but how do I create the relationship between two entities that exist in the same table?</p>\n"},{"tags":["java","hibernate","amazon-s3","amazon-web-services","elastic-beanstalk"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":243,"score":0,"question_id":11337951,"title":"upload files on aws elastic beanstalk?","body":"<p>I have created an Java web application and deployed it on AWS Elastic Beanstalk. It;s working fine with its database. </p>\n\n<p>Now, in my project users have the option to upload documents, pdfs and images. This is creating problems. In the local system I am using <code>./</code> as the path for saving uploaded documents but on Amazon I don't know where to store these uploaded documents and how to assign a path. </p>\n\n<p>So far I've done the following, which is all working okay.</p>\n\n<ol>\n<li>Uploaded a project on AWS Elastic Beanstalk.</li>\n<li>Created a database using AWS <code>RDS</code>.</li>\n<li>Both application and database are communicating with each other.   </li>\n</ol>\n"},{"tags":["java","hibernate","jsf","primefaces"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13233529,"title":"jsf & hibernate integration - picklist values from database","body":"<p>i am new to hibernate and jsf technologies and i am trying to have a picklist which retrieves and updates (if user alters its values) values from database. </p>\n\n<p>My database schema is as follows:</p>\n\n<p>I have two tables (entities) CRImageType(ImTypeId(PK),ImTypeName,ImTypeDescription) &amp; CRVariable(VarId(PK),VarName,VarDescription) which have a many to many relation through the table 'imtype_variable' implemented in my Hibernate Data Model.</p>\n\n<p>The Model seems to work fine. I am also able to use jsf elements (datatables with insert, edit and delete buttons + corresponding dialogboxes + bean classes) in order to read and write to tables CRVariable &amp; CRImageType.</p>\n\n<p><strong>I want to have also a picklist</strong> in order to be able to associate CRImageType with CRVariable records. My business scenario is to be able to re-associate an image type with one or more variables (medical term) so i am using a jsf picklist:</p>\n\n<pre><code>&lt;p:dialog id=\"dialog-associatevariables\" header=\"Associate Variables\" widgetVar=\"dlg7\"     dynamic=\"true\" showEffect=\"fade\"&gt;\n&lt;h:panelGrid id=\"associateVariables\" columns=\"1\" cellpadding=\"4\"&gt;\n&lt;p:pickList id=\"pickList\" \n                value=\"#{reportConfiguratorBean.getAssocImTypVariables(reportConfiguratorBean.selectedCRImageType.imTypeId)}\"\n                var=\"cRVariable\" \n                itemValue=\"#{cRVariable}\" \n                itemLabel=\"#{cRVariable.varName}\"&gt;\n    &lt;f:facet name=\"sourceCaption\"&gt;Available Variables&lt;/f:facet&gt;\n        &lt;f:facet name=\"targetCaption\"&gt;Associated Variables&lt;/f:facet&gt;\n&lt;/p:pickList&gt;\n&lt;/h:panelGrid&gt;  \n&lt;/p:dialog&gt;\n</code></pre>\n\n<p>In My 'reportConfigurator' backbean i have implemented the following method in order to populate the picklist (following the online primefaces demo):</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\npublic DualListModel&lt;CRVariable&gt; getAssocImTypVariables(Long imTypeId)     {\n\nList&lt;CRVariable&gt; source1;\nList&lt;CRVariable&gt; target;\n...         \nString hq3 = \"select distinct v from CRVariable v join v.crimagetypes t where t.id in (:itid)\";\nQuery query3 = session.createQuery(hq3);\nquery3.setParameter(\"itid\",imTypeId);\ntarget = query3.list();\nSystem.out.println(\"Associated Variables with Id: \" + target);          \nString hq4 = \"select v FROM CRVariable v WHERE v.id not in (\" +\n            \"select distinct v1.id \" +\n            \"from CRVariable v1 \" +\n            \"join v1.crimagetypes t2 \" +\n            \"where t2.id in (:itid))\";\nQuery query4 = session.createQuery(hq4);\nquery4.setParameter(\"itid\",imTypeId);\nsource = query4.list();\nSystem.out.println(\"Non Associated Variables with Id: \" + source);\nString hq5 = \"FROM CRVariable\";\nQuery query5 = session.createQuery(hq5);\nsource1 = query5.list();\nSystem.out.println(\"Non Associated Variables with Id: \" + source1);         \ndualListVars = new DualListModel&lt;CRVariable&gt;(source1, target);          \nSystem.out.println(\"Dual List Model: \" + dualListVars);\n...\n{\nsession.close();\n}\nreturn dualListVars;\n}\n</code></pre>\n\n<p>Back bean method '' seem to work fine since in my console the correct list item object are populated (source1 &amp; target) and it returnes a Dual List Model object as shown in the following lines (console output):</p>\n\n<pre><code>Associated ImageType with Id: 26\n...\nAssociated Variables with Id: [varId : 75, varName : Ki67(X), varDescription : Ki67(X)]\nNon Associated Variables with Id: [varId : 71, varName : ER (X), varDescription : ER (X), varId : 72, varName : HER2(X), varDescription : HER2(X), varId : 73, varName : IHC, varDescription : IHC, varId : 74, varName : FISH, varDescription : FISH, varId : 76, varName : PTEN(X), varDescription : PTEN(X), varId : 77, varName : Histology (X), varDescription : Histology (X)]\n...\nNon Associated Variables with Id: [varId : 71, varName : ER (X), varDescription : ER (X), varId : 72, varName : HER2(X), varDescription : HER2(X), varId : 73, varName : IHC, varDescription : IHC, varId : 74, varName : FISH, varDescription : FISH, varId : 75, varName : Ki67(X), varDescription : Ki67(X), varId : 76, varName : PTEN(X), varDescription : PTEN(X), varId : 77, varName : Histology (X), varDescription : Histology (X)]\n...\n</code></pre>\n\n<p>Τhe PROBLEM is that **when i call the picklist dialog, picklist columns does not populate correctly ... </p>\n\n<p>After some debugging/research i think that it has to do with the way i am calling my  picklist method \"reportConfiguratorBean.getAssocImTypVariables(...)\" . </p>\n\n<p>If i use <strong>\"reportConfiguratorBean.selectedCRImageType.imTypeId\" as method argument</strong> it is passed as <strong>ZERO value in the backbean</strong>!!! </p>\n\n<p>If i hardcode an <strong>integer number as an argument e.g. 25</strong> the <strong>picklist is populated correctly</strong> but in the console i can see  the following exception:</p>\n\n<pre><code>ERROR class java.lang.IllegalArgumentException: can't parse argument number reportConfiguratorBean.getAssocImTypVariables(25): javax.el.PropertyNotWritableException: /views/report-configurator.xhtml @271,10 value=\"#{reportConfiguratorBean.getAssocImTypVariables(25)}\": Illegal Syntax for Set Operation\n</code></pre>\n\n<p>Any ideas of what i have been missing???</p>\n"},{"tags":["java","hibernate","jpa","bean-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13272813,"title":"I'm using bean validation. In the PerPersist method of my entity, how do I stop the persist if validation fails?","body":"<p>Here's my DAO and entity.  Thanks.</p>\n\n<pre><code>import javax.persistence.EntityManager;\nimport javax.persistence.EntityManagerFactory;\nimport javax.persistence.Persistence;\n\nimport com.westfieldgrp.beanvalidation.persistence.Car;\nimport com.westfieldgrp.beanvalidation.persistence.Driver;\nimport com.westfieldgrp.beanvalidation.persistence.Person;\nimport com.westfieldgrp.common.data.dao.DAOInterface;\n\npublic class CarDAO  {\n\n    private EntityManager entityManager;\n\n\n    public void save(Person convertedPerson, Driver convertedDriver, Car convertedCar) {\n        EntityManager em = getEntityManager();\n        //convertedPerson.setName(convertedPerson.getName()); // To test JPA validation\n        Person savedPerson =  em.merge(convertedPerson);\n        convertedDriver.setPersonId(savedPerson.getPersonId());\n        Driver savedDriver = em.merge(convertedDriver);\n        convertedCar.setDriverId(savedDriver.getPersonId());\n        if(\"test\".equals(convertedCar.getManufacturer())){\n            convertedCar.setManufacturer(null);// To test JPA validation\n        }\n        em.persist(convertedCar);\n        em.flush();\n    }\n\n    public EntityManager getEntityManager() {\n            EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"src_persistence\");\n            entityManager = emf.createEntityManager();\n        return entityManager;\n    }\n\n    public void setEntityManager(EntityManager entityManager) {\n        this.entityManager = entityManager;\n    }\n}\n</code></pre>\n\n<p>Entity:</p>\n\n<pre><code>import java.io.Serializable;\nimport java.util.Set;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.PrePersist;\nimport javax.persistence.Table;\nimport javax.validation.ConstraintViolation;\nimport javax.validation.Validation;\nimport javax.validation.Validator;\nimport javax.validation.ValidatorFactory;\nimport javax.validation.constraints.AssertTrue;\nimport javax.validation.constraints.Min;\nimport javax.validation.constraints.NotNull;\nimport javax.validation.constraints.Size;\n\n\n/**\n * The persistent class for the CAR database table.\n * \n */\n@Entity\n@Table(name=\"CAR\")\npublic class Car implements Serializable {\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    @Column(name=\"CAR_ID\")\n    private int carId;\n\n    @Column(name=\"INSPECTION_PASSED\")\n    @AssertTrue(message = \"The car has to pass the vehicle inspection first\")//, groups = CarChecks.class)\n    private boolean inspectionPassed;\n\n    @Column(name=\"LICENSE_PLATE_NUMBER\")\n    @NotNull(message = \"A license plate is required.\")\n    @Size(min = 2, max = 14, message=\"The license plate field must be 2-14 characters.\")\n    private String licensePlateNumber;\n\n    @Column(name=\"MANUFACTURER\")\n    @NotNull(message = \"A manufacturer is required.\")\n    private String manufacturer;\n\n    @Column(name=\"REGISTERED\")\n    private boolean registered;\n\n    @Column(name=\"SEAT_COUNT\")\n    @Min(value =2, message=\"The car must contain more than 1 seat.\")\n    private int seatCount;\n\n    @Column(name=\"DRIVER_ID\")\n    private int driverId;\n\n    @PrePersist\n    public void testPrePersist(){\n        System.out.println(\"@@@@PrePersist was called. \" + manufacturer);\n        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();\n        Validator validator = factory.getValidator();\n        Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = validator.validate(this);\n        for (ConstraintViolation&lt;Car&gt; violation : violations) {\n               System.out.format(\"%s: %s%n\",violation.getPropertyPath(), violation.getMessage());\n        }\n    }\n\n    public Car() {\n    }\n\n    public int getCarId() {\n        return this.carId;\n    }\n\n    public void setCarId(int carId) {\n        this.carId = carId;\n    }\n\n    public boolean getInspectionPassed() {\n        return this.inspectionPassed;\n    }\n\n    public void setInspectionPassed(boolean inspectionPassed) {\n        this.inspectionPassed = inspectionPassed;\n    }\n\n    public String getLicensePlateNumber() {\n        return this.licensePlateNumber;\n    }\n\n    public void setLicensePlateNumber(String licensePlateNumber) {\n        this.licensePlateNumber = licensePlateNumber;\n    }\n\n    public String getManufacturer() {\n        return this.manufacturer;\n    }\n\n    public void setManufacturer(String manufacturer) {\n        this.manufacturer = manufacturer;\n    }\n\n    public boolean getRegistered() {\n        return this.registered;\n    }\n\n    public void setRegistered(boolean registered) {\n        this.registered = registered;\n    }\n\n    public int getSeatCount() {\n        return this.seatCount;\n    }\n\n    public void setSeatCount(int seatCount) {\n        this.seatCount = seatCount;\n    }\n\n    public void setDriverId(int diverId) {\n        this.driverId = diverId;\n    }\n\n    public int getDriverId() {\n        return driverId;\n    }\n}\n</code></pre>\n"},{"tags":["java","mysql","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13272297,"title":"Starting a new project, how to setup UTC time correctly in java with hibernate and mysql","body":"<p>So I am starting a new project using java, hibernate and mysql (spring mvc).</p>\n\n<p>At the database level, what column type should I use?</p>\n\n<p>At the java level, I believe I should be using Joda time.  </p>\n\n<p>My users table will store their time offset, which I will then convert/format at the UI level using the UTC value from the database.</p>\n\n<p>With hibernate, do I really need that joda time hibernate plugin or is adding joda time enough?</p>\n\n<p>Can someone tell me what methods I will be needing, or an article that goes over things with source code?</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":129,"score":4,"question_id":13210638,"title":"Hibernate Delete query","body":"<p>When I try to delete an entry from a db, using </p>\n\n<pre><code>session.delete(object) \n</code></pre>\n\n<p>then I can the following:</p>\n\n<p>1) If the row is present in DB then two SQL queries are getting executed: A select and then a delete</p>\n\n<p>2) If the row is not present in the DB then only the select query is getting executed</p>\n\n<p>But again this is not the case for update. Irrespective of the presence of DB row, only the update query is getting executed.</p>\n\n<p>Please let me know why this kind of behaviour for delete operation. Isn't it a performance issue since two queries are getting hit rather than one?</p>\n\n<p><strong>Edit:</strong> </p>\n\n<p>I am using hibernate 3.2.5</p>\n\n<p><strong>Sample code:</strong></p>\n\n<pre><code>SessionFactory sessionFactory = new Configuration().configure(\"student.cfg.xml\").buildSessionFactory();\n    Session session = sessionFactory.openSession();\n    Student student = new Student();\n    student.setFirstName(\"AAA\");\n    student.setLastName(\"BBB\");\n    student.setCity(\"CCC\");\n    student.setState(\"DDD\");\n    student.setCountry(\"EEE\");\n    student.setId(\"FFF\");\n    session.delete(student);\n    session.flush();\n            session.close();\n</code></pre>\n\n<p><strong>cfg.xml</strong></p>\n\n<pre><code>&lt;property name=\"hibernate.connection.username\"&gt;system&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;XXX&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;oracle.jdbc.OracleDriver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:oracle:thin:@localhost:1521/orcl&lt;/property&gt;      \n    &lt;property name=\"hibernate.jdbc.batch_size\"&gt;30&lt;/property&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.OracleDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.cache.use_query_cache\"&gt;false&lt;/property&gt;\n    &lt;property name=\"hibernate.cache.use_second_level_cache\"&gt;false&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.release_mode\"&gt;after_transaction&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.autocommit\"&gt;true&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.pool_size\"&gt;0&lt;/property&gt;\n    &lt;property name=\"hibernate.current_session_context_class\"&gt;thread&lt;/property&gt;    \n    &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/property&gt;        \n</code></pre>\n\n<p><strong>hbm.xml</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n&lt;class name=\"com.infy.model.Student\" table=\"STUDENT\"&gt;\n    &lt;id name=\"id\" column=\"ID\"&gt;\n        &lt;generator class=\"assigned\"&gt;&lt;/generator&gt;\n    &lt;/id&gt;\n    &lt;property name=\"firstName\" type=\"string\" column=\"FIRSTNAME\"&gt;&lt;/property&gt;\n    &lt;property name=\"lastName\" type=\"string\" column=\"LASTNAME\"&gt;&lt;/property&gt;\n    &lt;property name=\"city\" type=\"string\" column=\"CITY\"&gt;&lt;/property&gt;\n    &lt;property name=\"state\" type=\"string\" column=\"STATE\"&gt;&lt;/property&gt;\n    &lt;property name=\"country\" type=\"string\" column=\"COUNTRY\"&gt;&lt;/property&gt;        \n&lt;/class&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["hibernate","hibernate-tools"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":841,"score":2,"question_id":10552362,"title":"Hibernate Tools: Error parsing JNDI name","body":"<p>We are trying to upgrade from Hibernate 3.6.7 to 4.1.2 and Hibernate Tools 3.2.0 to 3.5.0</p>\n\n<p>We generate a DB creation script using Ant:</p>\n\n<pre><code>     &lt;hibernatetool destdir=\"${target}\"&gt;\n        &lt;jpaconfiguration persistenceunit=\"stdcmpOrderPersistenceUnit\" propertyfile=\"@{propertyfile}\"/&gt;\n        &lt;classpath refid=\"@{classpathid}\"/&gt;\n        &lt;!-- the file name is relative to $destdir --&gt;\n        &lt;hbm2ddl outputfilename=\"@{output}\" format=\"true\" export=\"false\" drop=\"false\"/&gt;\n     &lt;/hibernatetool&gt;\n</code></pre>\n\n<p>Our persistence unit look like this:</p>\n\n<pre><code>&lt;persistence-unit name=\"stdcmpOrderPersistenceUnit\" transaction-type=\"JTA\"&gt;\n\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;jta-data-source&gt;jdbc/lakshmi_stdcmp&lt;/jta-data-source&gt;\n    &lt;mapping-file&gt;META-INF/stdcmpOrderNamedQueries.xml&lt;/mapping-file&gt;\n\n    &lt;class&gt;ch.ethz.id.wai.lakshmi.stdcmp.persistency.PersistentOrder&lt;/class&gt;\n\n    &lt;exclude-unlisted-classes&gt;true&lt;/exclude-unlisted-classes&gt;\n\n    &lt;properties&gt;\n        &lt;property name=\"hibernate.show_sql\" value=\"false\"/&gt;\n        &lt;property name=\"hibernate.format_sql\" value=\"false\"/&gt;\n    &lt;/properties&gt;\n\n&lt;/persistence-unit&gt;\n</code></pre>\n\n<p>After the upgrade we get the following error:</p>\n\n<pre><code>[hibernatetool] org.hibernate.service.jndi.JndiException: Error parsing JNDI name [jdbc/lakshmi_stdcmp]\n[hibernatetool] javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial\n</code></pre>\n\n<p>Why does Hibernate try to resolve the JNDI name since all the information on the PersistenceUnit is available?\nWe had no problems with the old version.</p>\n\n<p>And in any case how can we specify a NamingFactory? (and which one?)</p>\n"},{"tags":["java","hibernate","hibernate-envers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13271732,"title":"hibernate envers performance of queries","body":"<p>We are currently using envers in a project and performance degrades a lot as we query some audited data that is spread around multiple tables.</p>\n\n<p>Basically we create a stream of audited data as follows:</p>\n\n<pre><code>List&lt;Object[]&gt; auditStream = new LinkedList&lt;Object[]&gt;();\nfor (Class&lt;?&gt; entityClass : desiredEntityClasses) {\n    auditStream.addAll(\n        auditReader.createQuery()\n            .forRevisionsOfEntity(entityClass, false, true)\n            .add(AuditEntity\n                .revisionProperty(\"timestamp\")\n                .ge(startTimestamp))\n            .getResultList());    \n} \n</code></pre>\n\n<p>On top of that some more audit information is needed for some kinds of entity (like nested entities).</p>\n\n<p>The response times are reasonable for small amounts of data (by reducing the timestamp) but with 500 entries in the <code>auditStream</code>, it takes about 3sec to get it all, which is way too long.</p>\n\n<p><code>Q1</code> I was wondering if it was possible to turn on batch-fetching on those kind of queries and how?</p>\n\n<p><code>Q2</code> Is there some way to optimize the queries, for instance getting more than one kind of entity at once?</p>\n"},{"tags":["hibernate","jpa","cascade","hibernate-cascade"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13272161,"title":"Hibernate cascade update into collections' objects in that haven't changed","body":"<p>I'm having an issue with cascading updates to objects that contain collections of other objects. Here's a contrived (slightly) example to illustrate (getters/setters omitted). Sorry its lots of code, I can't find another way to express the issue and its all fairly straightforward here.</p>\n\n<pre><code>@Entity\npublic class Salesman\n{\n  @Id\n  @GeneratedValue\n  @Column(name=\"salesman_id\")\n  private long id;\n\n  @OneToMany(mappedBy=salesman, targetEntity=ContactSet.class, fetch=FetchType.EAGER, cascade=CascadeType.All)\n  private Set&lt;ContactSet&gt; contacts;\n}\n\n\n@Entity\npublic class Company\n{\n  @Id\n  @GeneratedValue\n  @Column(name=\"company_id\")\n  private long id;\n\n  @Column(name=\"company_name\")\n  private String name;\n}\n\n\n@Entity\npublic class ContactSet\n{\n  @Id\n  @GeneratedValue\n  @Column(name=\"contact_set_id\")\n  private long id;\n\n  @ManyToOne(fetch=FetchType.EAGER)\n  @JoinColumn(name=\"salesman_id\",referencedColumnName=\"salesman_id\", updatable=false, nullable=false)\n  private Salesman salesman\n\n  @ManyToOne\n  @JoinColumn(name=\"company_id\", referencedColumnName=\"company_id\", updatable=false, nullable=false)\n  private Company company;\n\n  @OneToMany(mappedBy=\"contactSet\", targetEntity=Contact.class, fetch=FetchType.EAGER, cascade=CascadeType.ALL)\n  private Set&lt;Contact&gt; contacts;\n}\n\n\n@Entity\npublic class Contact\n{\n  @Id\n  @GeneratedValue\n  @Column(name=\"contact_id\")\n  private long id;\n\n  @ManyToOne(fetch=FetchType.EAGER)\n  @JoinColumn(name=\"contact_set_id\",referencedColumnName=\"contact_set_id\", updatable=true, nullable=false)\n  private ContactSet contactSet;\n\n  @Column(name=\"contact_name\", updatable=false, nullable=false)\n  private String name;\n}\n</code></pre>\n\n<p>So a salesman has a set of contacts for each company, and there may be many salesman that service a company, each with different contacts. I can add a new company (and associated contacts) to a salesman, everything is fine. </p>\n\n<p>The issue comes when adding a new company (and contacts) to a salesman that already has some:</p>\n\n<pre><code>session.beginTransaction();\nContactSet newSet = new ContactSet();\n/*...Add contacts to ContactSet...*/\nsalesman.addContactSet(newSet);\nsession.saveOrUpdate(salesman);\nsession.commit();\n</code></pre>\n\n<p>When running this with hibernate.show_sql=true, I can see this has the expected effect of running an Insert for each Contact, and insert for the new ContactSet. I also see an update for the Salesman itself, as well as an update for every other ContactSet and Contact that the salesman in question has. Since there are thousands of contacts for each salesman, this transaction takes a long time.</p>\n\n<p>My question is, how do I avoid all the updates for ContactSets and Contacts that I know haven't changed? I have tried adding the @Version tags, changing CascadeType (anything but ALL fails in my application) and loads of more specific code tinkering, but no success!</p>\n\n<p>Thanks in advance for any pointers,</p>\n\n<p>Phil</p>\n"},{"tags":["hibernate","validation","grails","database-schema"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3910,"score":0,"question_id":2524966,"title":"Hibernate: Found: float, expected: double precision","body":"<p>I have a problem with the mapping of Oracle Float double precision datatype to Java Double datatype. The hibernate schema validator seems to fail when the Java Double datatype is used.</p>\n\n<pre><code>org.hibernate.HibernateException: Wrong column type in DB.TABLE for column amount. Found: float, expected: double precision\n</code></pre>\n\n<p>The only way to avoid this is to disable schema validation and hope the schema is in sync with the app about to run. It must be fixed before it goes out to production.</p>\n\n<p>App's evironment:<br>\n- Grails 1.2.1<br>\n- Hibernate-core 3.3.1.GA<br>\n- Oracle 10g</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13271849,"title":"Why this hibernate configuration doesn't work","body":"<pre><code>&lt;session-factory&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;org.postgresql.Driver&lt;/property&gt;     \n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:postgresql://localhost:5432/balh&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;postgres&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;postgres123&lt;/property&gt;\n        &lt;property name=\"hbm2ddl.auto\"&gt;update&lt;/property&gt;\n    &lt;/session-factory&gt;\n</code></pre>\n\n<p>I can connect to the DB through pgAdmin. The data seem to be right. Since I'm using Tapestry error is not directly showing what's the problem.</p>\n"},{"tags":["java","database","hibernate","spring-mvc","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13250758,"title":"DB use an excessive amount of CPU - 95%","body":"<p>I am using Spring MVC + hibernate in my application. Application server is IBM WebSphere v7. While restarting and after restart application, <strong>Db2syscs</strong> process makes CPU usage 99% and consumes memory usage about <strong>1,034,352K</strong>. This goes about <strong>10~15 minutes</strong>. I tried increasing the heap size allocated to DB2, which made no difference.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>These are my hibernate properties in spring configuration file. Will adding cache, pool properties will affect?</p>\n\n<pre><code>&lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.DB2Dialect&lt;/prop&gt;\n&lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n&lt;prop key=\"hibernate.show_sql\"&gt;false&lt;/prop&gt;\n&lt;prop key=\"hibernate.connection.datasource\"&gt;jdbc/logincfg&lt;/prop&gt;\n&lt;prop key=\"hibernate.transaction.factory_class\"&gt;org.hibernate.transaction.CMTTransactionFactory\n&lt;/prop&gt;\n&lt;prop key=\"hibernate.transaction.manager_lookup_class\"&gt;org.hibernate.transaction.WebSphereExtendedJTATransactionLookup\n&lt;/prop&gt;\n</code></pre>\n"},{"tags":["mysql","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13271217,"title":"Database refusing connection for locale 'en_US'","body":"<p>I am using MySQL server for database and Hibernate as ORM framework in my application.\nWhenever hibernate tries to establish a connection with desired database, an exception occurrs  stating 'org.hibernate.exception.Genericjdbcexception cannot open connection' for locale 'en_US'. I am getting no idea how to resolve this issue. Please help.</p>\n"},{"tags":["hibernate","caching","domain-driven-design"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13271154,"title":"hibernate - cache collections accessed by repository without having a set","body":"<p>Usually in hibernate we have lots of parent/child relationships with <code>HashSet</code>s. So the parent has a Set of children. This can be easily cached in second level cache with hibernate collection cache. When you add or remove objects to the set the cache is invalidated. </p>\n\n<p>Now we want to drop the set relationship on the parent object. This is because following DDD (Domain driven Design) semantics the child is not part of the aggregate root of the parent. The child class still has a relationship to the parent. </p>\n\n<p>So we started using a repository to access the children with methods like this:</p>\n\n<pre><code>public Set&lt;Child&gt; getChildren(Parent parent) {\n    Criteria criteria = getSession().createCriteria(Child.class);\n    criteria.add(Restrictions.naturalId().set(\"parent\", parent));\n    criteria.setCacheable(true); // does not work here!\n    return criteria.list();\n}\n</code></pre>\n\n<p>The problem is the <code>setCacheable</code>. As our child has two naturalId which is the parent and its own naturalId (for example a name).</p>\n\n<p>The hibernate query cache with naturalIds does not work if I use only one of the two naturalIds as hibernate does not recognise adding or deleting more entities with repository methods like save() or delete(). </p>\n\n<p>when we use it without <code>Restrictions-naturalId()</code> we can use the normal query cache but this one gets invalidated if any child is added or modified. This is common problem with the query cache and not specific to our problem.</p>\n\n<p>Therefore we tried to write our own CollectionRepository ending up with a class like this:</p>\n\n<pre><code>public abstract class CollectionRepositoryHibernate&lt;T extends PersistableEntity, E extends PersistableEntity&gt; extends StandardRepositoryHibernate&lt;T&gt; implements\n        CollectionRepository&lt;T, E&gt;\n{\n    private Class&lt;T&gt;    entityClass = getGenericClass();\n    private Class&lt;E&gt;    parentClass = getGenericParentClass();\n\n    @Override\n    public void save ( T persistableEntity )\n    {\n        evictCache(persistableEntity);\n        super.save(persistableEntity);\n    }\n\n    @Override\n    @SuppressWarnings(\"unchecked\")\n    public List&lt;T&gt; getCollection ( E persistableEntity )\n    {\n        return getNaturalCollectionCriteria(persistableEntity).list();\n    }\n\n    protected Criteria getNaturalCollectionCriteria ( E persistableEntity )\n    {\n        Criteria criteria = getSession().createCriteria(entityClass);\n        criteria.add(Restrictions.naturalId().set(getPropertyName(), persistableEntity));\n        criteria.setCacheable(true);\n        criteria.setCacheRegion(getCacheRegion(persistableEntity.getId()));\n        return criteria;\n    }\n\n    private String getPropertyName ( )\n    {\n        ClassMetadata classMetadata = getSession().getSessionFactory().getClassMetadata(entityClass);\n        int[] naturalIdentifierProperties = classMetadata.getNaturalIdentifierProperties();\n        String[] propertyNames = classMetadata.getPropertyNames();\n        for (int i : naturalIdentifierProperties)\n        {\n            String propertyName = propertyNames[i];\n            try\n            {\n                Field field = entityClass.getDeclaredField(propertyName);\n                Class&lt;?&gt; type = field.getType();\n                if (type.equals(parentClass))\n                {\n                    return propertyName;\n                }\n            }\n            catch (Exception e)\n            {\n                e.printStackTrace();\n            }\n        }\n        throw new IllegalStateException(\"No property name found\");\n    }\n\n    private void evictCache ( T persistableEntity )\n    {\n        Cache cache = getSession().getSessionFactory().getCache();\n        String cacheRegion = getCacheRegion(getCollectionId(persistableEntity));\n        cache.evictQueryRegion(cacheRegion);\n    }\n\n    protected String getCacheRegion ( Integer id )\n    {\n        return entityClass + \"#\" + id;\n    }\n\n    @Override\n    public void delete ( T persistableEntity )\n    {\n        evictCache(persistableEntity);\n        super.delete(persistableEntity);\n    }\n\n    protected Integer getCollectionId ( T persistableEntity )\n    {\n        try\n        {\n            Field field = persistableEntity.getClass().getDeclaredField(getPropertyName());\n            field.setAccessible(true);\n            PersistableEntity parentEntity = (PersistableEntity) field.get(persistableEntity);\n            return parentEntity.getId();\n        }\n        catch (Exception e)\n        {\n            throw new IllegalStateException(\"no collection id found, e\");\n        }\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    protected Class&lt;E&gt; getGenericParentClass ( )\n    {\n        Class&lt;E&gt; result = null;\n        Type type = this.getClass().getGenericSuperclass();\n\n        if (type instanceof ParameterizedType)\n        {\n            ParameterizedType pt = (ParameterizedType) type;\n            Type[] fieldArgTypes = pt.getActualTypeArguments();\n            result = (Class&lt;E&gt;) fieldArgTypes[1];\n        }\n        return result;\n    }\n}\n</code></pre>\n\n<p><strong>The trick we use here is to have one cache region per collection.</strong></p>\n\n<p>When it comes to save or delete we evict this cache region. It works fine, but has some drawbacks:</p>\n\n<ul>\n<li>we need lots of cache regions. So far we don't know if there are some limitations or performance considerations to make.</li>\n<li>As the names of the cache regions are not known before you can't configure the cache regions, like setting the maximum number of elements or the time-to-live</li>\n</ul>\n\n<p>Summary: we don't want a set in our parent. We need to have second level collection cache which is not always invalidated if an entity is added or removed (like it is the case with usual query cache).   </p>\n\n<p>Do you know a proper way to have a collection cache which are not mapped with a parent/child relationship in a set?</p>\n"},{"tags":["java","hibernate","detachedcriteria"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13270924,"title":"Eager fetching nested object with DetachedCriteria in Hibernate","body":"<p>I have to modify a large Hibernate DetachedCriteria query to fetch some additional associations.</p>\n\n<p>My object graph resembles the structure below, I want to fetch the sales associated with each Car:</p>\n\n<pre><code>&lt;class name=\"Showroom\" table=\"showroom\"&gt;\n    ...\n    &lt;bag name=\"cars\" lazy=\"false\"&gt;\n        &lt;one-to-many class=\"Car\" /&gt;\n    &lt;/bag&gt;\n    ...\n&lt;/class&gt;\n\n&lt;class name=\"Car\" table=\"car\"&gt;\n    ...\n    &lt;set name=\"sales\" lazy=\"true\"&gt;\n        &lt;one-to-many class=\"Sale\" /&gt;\n    &lt;/set&gt;\n    ...\n&lt;/class&gt;\n</code></pre>\n\n<p>What I want to do is something like:</p>\n\n<pre><code>DetachedCriteria criteria = DetachedCriteria.forClass(Showroom.class);\n// ... Existing criteria query code ...\ncriteria.setFetchMode(\"cars.sales\", FetchMode.JOIN);\n</code></pre>\n\n<p>But the associationPath argument in setFetchMode seems to ignore the dot notation and I get a LazyInitializationException:</p>\n\n<blockquote>\n  <p>Caused by: org.hibernate.LazyInitializationException: failed to lazily\n  initialize a collection of role: Car.sales, no session or session was closed</p>\n</blockquote>\n\n<p>I've search around and so far found no examples or information. The <a href=\"http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html#querycriteria-dynamicfetching\" rel=\"nofollow\">Hibernate documentation</a> does not provide examples on how to fetch nested associations, and the <a href=\"http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/Criteria.html#setFetchMode%28java.lang.String,%20org.hibernate.FetchMode%29\" rel=\"nofollow\">Javadoc for setFetchMode</a> seems to suggest that my dot-notation approach should have worked...</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["java","hibernate","exception","exception-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13263945,"title":"how to handle com.ibm.ejs.cm.portability.DuplicateKeyException","body":"<p>I am getting ibm.ejs.cm.portability.DuplicateKeyException while saving a data Object. It is actually coming when i am trying to insert the same row in the Table and the condition is that i cant avoid it. So i need a handler but while putting this exception in try catch block i m getting compilation error.</p>\n"},{"tags":["java","hibernate","cascade"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13266907,"title":"cannot delete orphan children Hibernate","body":"<p>Ive found lots of these issues but for some reason they dont work for me. So im obviously doing something wrong.</p>\n\n<p>Form Object</p>\n\n<pre><code>@Entity\n@Table(name = \"WEBFORMS_WEBFORM\")\npublic class Form {\n\n    @Id\n    @GeneratedValue\n    @Column(name = \"FORM_ID\")\n    Long id;\n\n    @Column(name = \"NAME\")\n    String name;\n\n    @OrderBy(\"priority\")\n    @OneToMany(mappedBy = \"form\", cascade={javax.persistence.CascadeType.ALL}, orphanRemoval = true)\n    Set&lt;FormField&gt; formFields;\n\n    @OrderBy(\"creationDate DESC\")\n    @OneToMany(mappedBy = \"form\", cascade={javax.persistence.CascadeType.ALL}, orphanRemoval = true)\n    Set&lt;FormResult&gt; formResults;\n\n    @Column(name = \"ALLOW_GUESTS\")\n    Boolean allowGuest;\n\n    @Column(name = \"SEND_MAIL\")\n    Boolean sendMail;\n</code></pre>\n\n<p>Form Field Object</p>\n\n<pre><code>@Entity\n@Table(name = \"WEBFORMS_FORM_FIELD\")\npublic class FormField {\n\n    @Id\n    @GeneratedValue\n    @Column(name = \"FORM_FIELD_ID\")\n    Long id;\n\n    @Column(name = \"TYPE\")\n    String type;\n\n    @Column(name = \"CONTENT\")\n    String content;\n\n    @Column(name = \"PRIORITY\")\n    Long priority;\n\n    @ManyToOne()\n    @JoinColumn(name = \"FORM_ID\")\n    public Form form;\n</code></pre>\n\n<p>Im using hibernate annotation</p>\n\n<pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n   &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n   &lt;version&gt;3.5.6-Final&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>If i create a formField object within the form then no problems. Both objects are created. When i delete the form object the formfield object stays in the database.</p>\n\n<p>What am i doing wrong ?</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":33,"score":1,"question_id":13268570,"title":"'Having' is possible in hibernate hsql?","body":"<p>I am new to hibernate. I want to use having keyword in my hibernate sql query as like:</p>\n\n<pre><code> select from Store where storeName like 'a%' having productCount &gt;1\n</code></pre>\n\n<p>Here Store is mapped with store table and storeName is mapped with store_name of store table and productCount is mapped with product_count of store table.</p>\n\n<p>All the mapping is working fine. But when i run this query it is returning the following error:</p>\n\n<pre><code> org.hibernate.hql.ast.QuerySyntaxException: unexpected token: having near line 1, column 43.\n</code></pre>\n\n<p>So anyone help me to solve this issue?</p>\n"},{"tags":["java","hibernate","orm"],"answer_count":12,"favorite_count":4,"up_vote_count":14,"down_vote_count":0,"view_count":38542,"score":14,"question_id":1074081,"title":"Hibernate Error: org.hibernate.NonUniqueObjectException: a different object with the same identifier value was already associated with the session","body":"<p>I have two user Objects and while I try to save the object using </p>\n\n<pre><code>sessio.save(userObj)\n</code></pre>\n\n<p>I am getting the following error :</p>\n\n<pre><code>Caused by: org.hibernate.NonUniqueObjectException: a different object with the same identifier value was already associated with the session:\n[com.pojo.rtrequests.User#com.pojo.rtrequests.User@d079b40b]\n</code></pre>\n\n<p>I am creating the session using </p>\n\n<pre><code>BaseHibernateDAO dao = new BaseHibernateDAO();          \n\nrtsession = dao.getSession(userData.getRegion(),\n                           BaseHibernateDAO.RTREQUESTS_DATABASE_NAME);\n\nrttrans = rtsession.beginTransaction();\nrttrans.begin();\n\nrtsession.save(userObj1);\nrtsession.save(userObj2);\n\nrtsession.flush();\nrttrans.commit();\n\nrtsession.close() // in finally block\n</code></pre>\n\n<p>I also tried doing the <code>session.clear()</code> before saving, still no luck.</p>\n\n<p>This is for the first I am getting the session object when a user request comes, so i am getting why is saying that object is present in session.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["java","hibernate","spring-mvc","websphere"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13269363,"title":"Hibernate: Could not register synchronization","body":"<p>While using spring + hibenate alongwith Websphere server I am getting this exeption</p>\n\n<pre><code>org.hibernate.TransactionException: Could not register synchronization\n</code></pre>\n\n<p>Hibernate properties in spring config file is</p>\n\n<pre><code>&lt;props&gt;\n    &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.DB2Dialect&lt;/prop&gt;\n    &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n    &lt;prop key=\"hibernate.show_sql\"&gt;false&lt;/prop&gt;\n    &lt;prop key=\"hibernate.connection.datasource\"&gt;jdbc/jndiName&lt;/prop&gt;\n    &lt;prop key=\"hibernate.transaction.factory_class\"&gt;org.hibernate.transaction.CMTTransactionFactory&lt;/prop&gt;\n    &lt;prop key=\"hibernate.transaction.manager_lookup_class\"&gt;org.hibernate.transaction.WebSphereExtendedJTATransactionLookup&lt;/prop&gt;\n\n    &lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.EhCacheProvider&lt;/prop&gt;\n    &lt;prop key=\"hibernate.connection.aggressive_release\"&gt;false&lt;/prop&gt;\n    &lt;prop key=\"hibernate.connection.release_mode\"&gt;after_transaction&lt;/prop&gt;\n    &lt;prop key=\"hibernate.connection.autocommit\"&gt;true&lt;/prop&gt;\n    &lt;prop key=\"hibernate.connection.pool_size\"&gt;5&lt;/prop&gt;\n    &lt;prop key=\"hibernate.current_session_context_class\"&gt;thread&lt;/prop&gt;\n    &lt;prop key=\"hibernate.cache.use_query_cache\"&gt;true&lt;/prop&gt;\n    &lt;prop key=\"hibernate.cache.use_second_level_cache\"&gt;true&lt;/prop&gt;  \n&lt;/props&gt;\n</code></pre>\n"},{"tags":["oracle","hibernate","jboss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13269894,"title":"Getting a handle to native Oracle Connection in Hibernate 4 to run a stored proc","body":"<p>This is a follow-up to <a href=\"http://stackoverflow.com/questions/11524984/executing-native-query-with-hibernate-4-1\">Executing native query with Hibernate 4.1</a></p>\n\n<p>I've tried the options in the listed answer but we get errors and are unable to unwrap the proxied connection into the native connection which Oracle needs </p>\n\n<p>Option 2 code</p>\n\n<pre><code>public void execute(Connection connection) throws SQLException {\n    OracleConnection oracleConnection = connection.unwrap( OracleConnection.class );\n    ...\n}\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>java.lang.reflect.UndeclaredThrowableException\nERROR [stderr] (http-localhost/127.0.0.1:8080-3) at $Proxy64.unwrap(Unknown Source)\n</code></pre>\n\n<p>Option 3 code</p>\n\n<pre><code>public void execute(Connection connection) throws SQLException {\n    Connection unproxiedConnection = ( (JdbcWrapper&lt;Connection&gt;) connection ).getWrappedObject();\n    ...\n}\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>java.lang.Exception: javax.ejb.EJBException: java.lang.ClassCastException: org.jboss.jca.adapters.jdbc.jdk6.WrappedConnectionJDK6 cannot be cast to oracle.jdbc.OracleConnection\n</code></pre>\n\n<p>any suggestions?</p>\n\n<p>I've also tried this option <a href=\"http://stackoverflow.com/questions/10731266/sessionfactory-opensessionconnection-in-hibernate-4\">SessionFactory.openSession(Connection) in Hibernate 4</a> but that class does not get instantiated at all</p>\n"},{"tags":["hibernate","maven-2","jar","m2eclipse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12649664,"title":"Why mvn command not download hibernate-distribution.jar file?","body":"<p>I am trying to add a hibernate-distribution.jar version 3.5.4-Final inside the dependencies of a pom.xml file. When I am issuing this command, <code>mvn eclipse:eclipse -Dwtpversion=2.0</code>, I get the following output. And when I check in my <code>.m2/repository</code> folder, I don't see hibernate-distribution.jar is download. May I know how could I download the jar file using mvn command?</p>\n\n<pre><code>[INFO] Scanning for projects...\n[INFO]\n[INFO] ------------------------------------------------------------------------\n[INFO] Building Web3 0.0.1-SNAPSHOT\n[INFO] ------------------------------------------------------------------------\n[INFO]\n[INFO] &gt;&gt;&gt; maven-eclipse-plugin:2.9:eclipse (default-cli) @ Web3 &gt;&gt;&gt;\n[INFO]\n[INFO] &lt;&lt;&lt; maven-eclipse-plugin:2.9:eclipse (default-cli) @ Web3 &lt;&lt;&lt;\n[INFO]\n[INFO] --- maven-eclipse-plugin:2.9:eclipse (default-cli) @ Web3 ---\n[INFO] Adding support for WTP version 2.0.\n[INFO] Using Eclipse Workspace: C:\\Documents and Settings\\kok.hoe.loh\\workspace\n[WARNING] Workspace defines a VM that does not contain a valid jre/lib/rt.jar: C\n:\\Program Files\\Java\\jre6\n[INFO] no substring wtp server match.\n[INFO] Using as WTP server : JBoss v4.2\n[INFO] Adding default classpath container: org.eclipse.jdt.launching.JRE_CONTAIN\nER\n[INFO] Unable to read jar manifest from C:\\Documents and Settings\\kok.hoe.loh\\.m\n2\\repository\\org\\hibernate\\hibernate-distribution\\3.5.4-Final\\hibernate-distribu\ntion-3.5.4-Final.pom\n[INFO] File C:\\Documents and Settings\\kok.hoe.loh\\workspace\\Web3\\.project alread\ny exists.\n       Additional settings will be preserved, run mvn eclipse:clean if you want\nold settings to be removed.\n[INFO] Wrote Eclipse project for \"Web3\" to C:\\Documents and Settings\\kok.hoe.loh\n\\workspace\\Web3.\n[INFO]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time: 18.418s\n[INFO] Finished at: Sat Sep 29 11:11:01 SGT 2012\n[INFO] Final Memory: 6M/15M\n[INFO] ------------------------------------------------------------------------\n</code></pre>\n"},{"tags":["java","hibernate","persistent","mappings"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13265319,"title":"Hibernate - How to configure mapping programmatically?","body":"<p>Our Hibernate configuration mapping have been implemented programatically in <code>java</code>, not with <code>annotation</code> and not with <code>XML</code> mapping.</p>\n\n<p>We have a mapping classes hierarchy that we're setting in the Hibernate Mappings instance when the context is initialized, for instance:</p>\n\n<pre><code>Mappings mappings = configuration.createMappings();\nmappings.addClass(PersistentClass instance);\n</code></pre>\n\n<p>Now, the issue I'm facing with is quite simple but i don't find an example how to add it for our implementation.</p>\n\n<p>Let's say that</p>\n\n<p>we have 2 tables<code>A</code> and <code>B</code> with Many to one relation,\n<code>A.type_id = B.id.</code> and i want to retrieve all records from <code>A</code> with the following condition:\n<code>A.type_id = B.id and B.id = 4;</code></p>\n\n<p>How can i add the association (many to one) in my mapping object. <code>org.hibernate.mapping.RootClass.</code></p>\n"},{"tags":["java","swing","hibernate","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13264799,"title":"Hibernate \"No session or session was closed\" when i trying to get data from database","body":"<p>I am trying to write a stock management system. But now I have a few question. Please help me to sort out these problems.</p>\n\n<p>I have 2 entities. <code>Item</code>  and <code>ItemPrice</code>. <code>Item</code> has <em>one or more</em> <code>ItemPrice</code></p>\n\n<p>When I try to save <code>Item</code> object, it works fine; but when I try to retrieve details from database, it gives following <code>Exception</code> stack trace.</p>\n\n<pre>\norg.hibernate.HibernateException: Found shared references to a collection: com.pos.entities.ItemGroup.items\nHibernate: select itemmodel0_.id as id9_, itemmodel0_.item_model as item2_9_, itemmodel0_.status as status9_ from smartpos.item_model itemmodel0_ where (itemmodel0_.status=? )\nHibernate: select itemsize0_.id as id3_, itemsize0_.item_size as item2_3_, itemsize0_.status as status3_ from smartpos.item_size itemsize0_ where (itemsize0_.status=? )\n    at org.hibernate.engine.Collections.processReachableCollection(Collections.java:163)\n    at org.hibernate.event.def.FlushVisitor.processCollection(FlushVisitor.java:37)\n    at org.hibernate.event.def.AbstractVisitor.processValue(AbstractVisitor.java:101)\n    at org.hibernate.event.def.AbstractVisitor.processValue(AbstractVisitor.java:61)\n    at org.hibernate.event.def.AbstractVisitor.processEntityPropertyValues(AbstractVisitor.java:55)\n    at org.hibernate.event.def.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:138)\n    at org.hibernate.event.def.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:196)\n    at org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:76)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:26)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)\n    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:338)\n    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)\n    at com.pos.dao.ItemDaoImpl.getItem(ItemDaoImpl.java:761)\n    at com.pos.manager.ItemManager.getItem(ItemManager.java:296)\n    at com.pos.ui.ItemDefinitionForm$RefreshTask.doInBackground(ItemDefinitionForm.java:464)\n    at com.pos.ui.ItemDefinitionForm$RefreshTask.doInBackground(ItemDefinitionForm.java:458)\n    at javax.swing.SwingWorker$1.call(SwingWorker.java:277)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at javax.swing.SwingWorker.run(SwingWorker.java:316)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:619)\nNov 7, 2012 12:03:42 PM org.hibernate.LazyInitializationException \nSEVERE: failed to lazily initialize a collection of role: com.pos.entities.Item.itemPrices, no session or session was closed\norg.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.pos.entities.Item.itemPrices, no session or session was closed\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)\n    at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:97)\n    at org.hibernate.collection.PersistentSet.size(PersistentSet.java:139)\n    at com.pos.ui.ItemDefinitionForm$RefreshTask.doInBackground(ItemDefinitionForm.java:520)\n    at com.pos.ui.ItemDefinitionForm$RefreshTask.doInBackground(ItemDefinitionForm.java:458)\n    at javax.swing.SwingWorker$1.call(SwingWorker.java:277)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at javax.swing.SwingWorker.run(SwingWorker.java:316)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:619)\norg.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.pos.entities.Item.itemPrices, no session or session was closed\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)\n    at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:97)\n    at org.hibernate.collection.PersistentSet.size(PersistentSet.java:139)\n    at com.pos.ui.ItemDefinitionForm$RefreshTask.doInBackground(ItemDefinitionForm.java:520)\n    at com.pos.ui.ItemDefinitionForm$RefreshTask.doInBackground(ItemDefinitionForm.java:458)\n    at javax.swing.SwingWorker$1.call(SwingWorker.java:277)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at javax.swing.SwingWorker.run(SwingWorker.java:316)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:619)\n</pre>\n\n<p><strong>This is entity class files.</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"   \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Nov 3, 2012 10:36:51 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n&lt;class catalog=\"smartpos\" name=\"com.pos.entities.ItemPrice\" table=\"item_price\" lazy=\"false\"&gt;\n&lt;id name=\"id\" type=\"java.lang.Integer\"&gt;\n  &lt;column name=\"id\"/&gt;\n  &lt;generator class=\"identity\"/&gt;\n&lt;/id&gt;\n&lt;many-to-one class=\"com.pos.entities.Item\" fetch=\"select\" name=\"item\"&gt;\n  &lt;column name=\"item_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.PriceList\" fetch=\"select\" name=\"priceList\"&gt;\n  &lt;column name=\"price_list_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;property name=\"price\" type=\"float\"&gt;\n  &lt;column name=\"price\" not-null=\"true\" precision=\"12\" scale=\"0\"/&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p><strong>Item Entity</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"     \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Nov 3, 2012 10:36:51 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n&lt;class catalog=\"smartpos\" lazy=\"false\" name=\"com.pos.entities.Item\" table=\"item\"&gt;\n&lt;id name=\"id\" type=\"java.lang.Integer\"&gt;\n  &lt;column name=\"id\"/&gt;\n  &lt;generator class=\"identity\"/&gt;\n&lt;/id&gt;\n&lt;many-to-one class=\"com.pos.entities.ItemColor\" fetch=\"select\" name=\"itemColor\"&gt;\n  &lt;column name=\"item_color_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.ItemModel\" fetch=\"select\" name=\"itemModel\"&gt;\n  &lt;column name=\"item_model_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.ItemGrade\" fetch=\"select\" name=\"itemGrade\"&gt;\n  &lt;column name=\"item_grade_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.BusinessPartner\" fetch=\"select\" name=\"businessPartner\"&gt;\n  &lt;column name=\"supplier_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.ItemSize\" fetch=\"select\" name=\"itemSize\"&gt;\n  &lt;column name=\"item_size_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.Login\" fetch=\"select\" name=\"login\"&gt;\n  &lt;column name=\"login_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.ItemGroup\" fetch=\"select\" name=\"itemGroup\"&gt;\n  &lt;column name=\"item_group_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;many-to-one class=\"com.pos.entities.ItemBrand\" fetch=\"select\" name=\"itemBrand\"&gt;\n  &lt;column name=\"item_brand_id\" not-null=\"true\"/&gt;\n&lt;/many-to-one&gt;\n&lt;property name=\"itemCode\" type=\"string\"&gt;\n  &lt;column length=\"50\" name=\"item_code\" not-null=\"true\" unique=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"itemName\" type=\"string\"&gt;\n  &lt;column length=\"200\" name=\"item_name\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"shortName\" type=\"string\"&gt;\n  &lt;column length=\"100\" name=\"short_name\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"barcode\" type=\"string\"&gt;\n  &lt;column length=\"50\" name=\"barcode\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"warrentyItem\" type=\"byte\"&gt;\n  &lt;column name=\"warrenty_item\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"taxableItem\" type=\"byte\"&gt;\n  &lt;column name=\"taxable_item\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"status\" type=\"byte\"&gt;\n  &lt;column name=\"status\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"createdDate\" type=\"timestamp\"&gt;\n  &lt;column length=\"19\" name=\"created_date\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"batchSerial\" type=\"byte\"&gt;\n  &lt;column name=\"batch_serial\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"warrentyPeriod\" type=\"int\"&gt;\n  &lt;column name=\"warrenty_period\" not-null=\"true\"/&gt;\n&lt;/property&gt;\n&lt;set inverse=\"true\" name=\"itemPrices\" cascade=\"save-update\"&gt;\n  &lt;key&gt;\n    &lt;column name=\"item_id\" not-null=\"true\"/&gt;\n  &lt;/key&gt;\n  &lt;one-to-many class=\"com.pos.entities.ItemPrice\"/&gt;\n&lt;/set&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p><strong>GUI Coding</strong></p>\n\n<pre><code>headers = new SupportedMethod().getTableHeaderValues(tblItemPrice);\nSystem.out.println(\"sdff\" + item.getItemPrices().size());\nitemPriceSet = item.getItemPrices();\nIterator it = itemPriceSet.iterator();\n\nwhile (it.hasNext()) {\n    ItemPrice ip = (ItemPrice) it.next();\n    Vector&lt;Object&gt; oneRow = new Vector&lt;Object&gt;();\n\n    oneRow.add(ip.getId());\n    oneRow.add(ip.getPriceList().getPriceListName());\n    oneRow.add(Float.toString(ip.getPrice()));\n\n    tableData.add(oneRow);\n}\ntblItemPrice.setModel(new DefaultTableModel(tableData, headers));\n</code></pre>\n\n<p><code>cascade</code> is OK, and I already set <code>lazy=false</code>, but it throws <code>Exception</code>. \nPlease anyone help me.</p>\n"},{"tags":["oracle","spring","hibernate","spring-mvc","spring-security"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13267920,"title":"spring security login not working with oracle","body":"<p>I am working on spring security login using jdbc-user-service. It is working on Mysql but not on oracle. I am using oracle 11 XE.</p>\n\n<p>The queries I have mentioned in  tag are correct because those return expected rows when I run those on oracle console.</p>\n\n<p>The datasource is :</p>\n\n<pre><code>&lt;bean id=\"dataSource\"\n    class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${jdbc.driver}\" /&gt;\n    &lt;property name=\"url\" value=\"${datasource.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${jdbc.user}\" /&gt;\n    &lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>in sessionFactory bean hibernate dialect for oracle is given.</p>\n\n<pre><code>&lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.Oracle10gDialect&lt;/prop&gt;\n</code></pre>\n\n<p>Same code works for mysql and not on oracle. The application control is redirected to login page which I have set in spring security file. This means it is getting username &amp; password correctly.</p>\n\n<pre><code>&lt;form-login login-page=\"/landing\" default-target-url=\"/home\"\n        authentication-failure-url=\"/landing?msg=cw\" /&gt;\n</code></pre>\n\n<p>The authentication provider code in spring security xml is :</p>\n\n<pre><code>&lt;authentication-manager&gt;\n    &lt;authentication-provider&gt;\n    &lt;jdbc-user-service data-source-ref=\"dataSource\"\n            users-by-username-query=\" \n    select USERNAME as username, PASSWORD as password,'true' as enabled from \n    users where USERNAME=?\"\n\n            authorities-by-username-query=\" select u.USERNAME \n    as username, r.ROLE as authority from users u, roles r, user_roles \n    ur where u.USER_ID = ur.USER_ID and ur.ROLE_ID = r.id and u.USER_ID = (SELECT \n    USER_ID from users where USERNAME = ?)\" /&gt;\n\n    &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n</code></pre>\n\n<p>Is there anything need to be configured in order to use oracle in spring security ?</p>\n\n<p>UPDATE : I set spring security debug and this is what is printing after I try to login.</p>\n\n<pre><code>INFO : Spring Security Debugger - \n\n************************************************************\n\nRequest received for '/j_spring_security_check':\n\norg.apache.catalina.connector.RequestFacade@7262b6\n\nservletPath:/j_spring_security_check\npathInfo:null\n\n  Security filter chain: [\n  ConcurrentSessionFilter\n  SecurityContextPersistenceFilter\n  LogoutFilter\n  UsernamePasswordAuthenticationFilter\n  BasicAuthenticationFilter\n  RequestCacheAwareFilter\n  SecurityContextHolderAwareRequestFilter\n  AnonymousAuthenticationFilter\n  SessionManagementFilter\n  ExceptionTranslationFilter\n  FilterSecurityInterceptor\n]\n\n\n************************************************************\n\n\nINFO : Spring Security Debugger - \n\n************************************************************\n\nRequest received for '/landing?msg=cw':\n\norg.apache.catalina.connector.RequestFacade@bf1a4a\n\nservletPath:/landing\npathInfo:null\n\nSecurity filter chain: [\nConcurrentSessionFilter\nSecurityContextPersistenceFilter\nLogoutFilter\nUsernamePasswordAuthenticationFilter\nBasicAuthenticationFilter\nRequestCacheAwareFilter\nSecurityContextHolderAwareRequestFilter\nAnonymousAuthenticationFilter\nSessionManagementFilter\nExceptionTranslationFilter\nFilterSecurityInterceptor\n]\n\n\n************************************************************\n</code></pre>\n"},{"tags":["javascript","spring","hibernate","extjs"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13193361,"title":"Cascading Combobox in extjs","body":"<p>I want to do cascading combobox in extjs. I have to comboboxes  </p>\n\n<p><strong>Course combobox</strong>  </p>\n\n<pre><code>{ \n    xtype : 'combobox',  \n    emptyText : 'Course',  \n    id:'combo-course',  \n    displayField : 'name',  \n    valueField : 'id',  \n    store:coursestore,  \n    forceSelection: true,  \n    triggerAction:'all',  \n    queryMode: 'remote',  \n    listeners: {  \n        'select': {  \n            fn:function(combo, value) {  \n                var comboModule = Ext.getCmp('combo-module');  \n                comboModule .setDisabled(true);\n        comboModule .clearValue('');\n        comboModule .getStore().removeAll();\n        comboModule .getStore().load({\n        params: {courseId: combo.getValue()}\n         });\n                comboModule .setDisabled(false);  \n            }  \n        }  \n    }  \n}\n</code></pre>\n\n<p><strong>Course-Module:</strong></p>\n\n<pre><code>{\n    xtype : 'combobox',  \n    emptyText : 'Module',  \n    id:'combo-module',  \n    displayField : 'name',  \n    valueField : 'id',  \n    disabled:true,  \n    remoteFilter:true,  \n    store:coursemodulestore,  \n    forceSelection: true,  \n    queryMode: 'remote',  \n    triggerAction:'all'\n}\n</code></pre>\n\n<p><strong>Rest Service</strong></p>\n\n<pre><code>    @Path(\"/coursemodule/{courseId}\")\n    public List&lt;CourseModule&gt; getAllCourseModules(@PathParam(\"courseId\")String courseId ) {\n        try {           \n            return courseObj.getModulesForCourse(courseId);\n                } catch (HibernateException e) {\n            logger.debug(e.getMessage());\n        }\n        return null;\n    }\n</code></pre>\n\n<p>When I am running the application and select the first combobox it shows the right values in second combobox in the first time only;<br>\nBut when I am selecting the combobox the second time its not displaying values in second combobox.</p>\n"},{"tags":["java","hibernate","generator","sequence"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12305888,"title":"How to get hibernate internal properties?","body":"<p>I want to use hibernate's TableGenerator for custom key generation</p>\n\n<pre><code>final SessionImpl session = ((SessionImpl) EntityManagerUtils\n            .getEntityManager(\"CORE\").getDelegate());\n\nTableGenerator generator = new TableGenerator();\n\n\n\n    Properties params = new Properties(??????????);\n    // params.put(\"identifier_normalizer\", ?);\n\n    params.put(\"table_name\", \"eflow.docs_number_generators\");\n    params.put(\"value_column_name\", \"tbl.GENERATOR_VALUE\");\n    params.put(\"segment_column_name\", \"tbl.GENERATOR_KEY\");\n    params.put(\"increment_size\", \"25\");\n    params.put(\"segment_value\", \"2011\");\n    generator.configure(IntegerType.INSTANCE, params, session\n            .getSessionFactory().getDialect());\n\n    Serializable id = generator.generate(session, new Object());\n    System.out.println(id);\n</code></pre>\n\n<p>But object with key \"identifier_normalizer\" is missing and this snippet throws null pointer exception. This object is of type <code>ObjectNameNormalizer</code> which normalizes db object names and is stored in hibernate local mappings.</p>\n\n<p>how to access hibernate's internal mappings and consequently this <code>ObjectNameNormalizer</code> object ?</p>\n\n<p>Actually as it seems i will need hibernate Mappings object which i don't know hot to get.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["hibernate","jpa","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13235842,"title":"Hibernate Criteria Query for Self Referencing Entity; incorrect result","body":"<p>I have a self-referencing entity, <code>Department</code>, which can have child <code>Departments</code> (n-level deep). Hibernate Criteria Query seems to be getting confused. It creates the tree correctly in that all parents have their correct children, however it also arbitrarily puts children directly under grand-parents, so a grand-parent ends up having it's children (which is correct) and the children's children (incorrect) directly under it.</p>\n\n<p>There is a top level entity <code>Organization</code> which can have n <code>LoB</code> entities under it. Lob stands for Line of Business. Under each <code>LoB</code> there is a hierarchy of <code>Department</code> entities.</p>\n\n<p><strong>Organization:</strong></p>\n\n<pre><code>public class Organization {\n    ...\nprivate Set&lt;Lob&gt; lobs = new HashSet&lt;Lob&gt;();\n\n@OneToMany(mappedBy = \"organization\", cascade = { CascadeType.PERSIST,\n        CascadeType.MERGE, CascadeType.REMOVE })\npublic Set&lt;Lob&gt; getLobs() {\n    return lobs;\n}\n\npublic void setLobs(Set&lt;Lob&gt; lobs) {\n    this.lobs = lobs;\n}\n}\n</code></pre>\n\n<p><strong>LOB:</strong></p>\n\n<pre><code>public class Lob {\n...\nprivate Long id;    \nprivate Organization organization;\nprivate Set&lt;Department&gt; departments = new HashSet&lt;Department&gt;();\n\n@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"ORG_ID\", nullable = false)\npublic Organization getOrganization() {\n    return organization;\n}\n\npublic void setOrganization(Organization organization) {\n    this.organization = organization;\n}\n\n@OneToMany(mappedBy = \"lob\", cascade = { CascadeType.PERSIST,\n        CascadeType.MERGE, CascadeType.REMOVE })\npublic Set&lt;Department&gt; getDepartments() {\n    return departments;\n}\n\npublic void setDepartments(Set&lt;Department&gt; departments) {\n    this.departments = departments;\n}\n}\n</code></pre>\n\n<p><strong>Department:</strong></p>\n\n<pre><code>public class Department {\n...\nprivate Set&lt;Department&gt; children = new HashSet&lt;Department&gt;();\nprivate Department parent;\nprivate Lob lob;\n\n@OneToMany(mappedBy = \"parent\")\npublic Set&lt;Department&gt; getChildren() {\n    return children;\n}\n\npublic void setChildren(Set&lt;Department&gt; children) {\n    this.children = children;\n}\n\n@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"PARENT_ID\") \npublic Department getParent() {\n    return parent;\n}\n\npublic void setParent(Department parent) {\n    this.parent = parent;\n}\n\n@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"LOB_ID\")\npublic Lob getLob() {\n    return lob;\n}\n\npublic void setLob(Lob lob) {\n    this.lob = lob;\n}\n}\n</code></pre>\n\n<p><strong>Hibernate Criteria Query:</strong></p>\n\n<pre><code>Session session = (Session) getEntityManager().getDelegate();\nCriteria crit = session.createCriteria(Organization.class);\n\n// Get the whole Org tree\norg = (Organization) crit.createAlias(\"lobs\", \"l\", Criteria.LEFT_JOIN)\n    .setFetchMode(\"l\", FetchMode.JOIN)\n    .createAlias(\"l.departments\", \"d\", Criteria.LEFT_JOIN)\n    .setFetchMode(\"d\", FetchMode.JOIN)\n    .createAlias(\"d.children\", \"dc\", Criteria.LEFT_JOIN)\n    .setFetchMode(\"dc\", FetchMode.JOIN)\n    .add(Restrictions.eq(\"id\", orgId))                                      \n    .uniqueResult();\n</code></pre>\n\n<p>I'm not sure if I have mapped the self-referencing association right.\nAny help will be greatly appreciated.</p>\n"},{"tags":["hibernate","struts2","struts","struts-1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":23,"score":-3,"question_id":13266800,"title":"Website development using struts and hibernate","body":"<p>I want to develop a website using struts and hibernate. Please suggest me a book or a source for learning..</p>\n\n<p>Thanks</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13243643,"title":"How to use hibernate <join><any>?","body":"<p>I'm reading hibernate reference, they're two elements in Hibernate: <code>&lt;join&gt;&lt;any&gt;</code>. After reading it, I don't know what the reference is talking about. </p>\n\n<p>I don't understand when to use join/any, what kind of scenarios are they suitable for? For &lt;join/&gt;: when setting \"fetch\", when will hibernate use inner join, when will use outer join, when will use select? Which tables which columns are used? And for the example hibernate reference provided, it said:\n&lt;join table=\"ADDRESS\"> &lt;key column=\"ADDRESS_ID\"/> &lt;property name=\"address\"/> &lt;property name=\"zip\"/> &lt;property name=\"country\"/> &lt;/join>, then which column is used to join these two tables? </p>\n\n<p>When setting fetch for &lt;join>, it said:\nfetch (optional - defaults to join): If set to join, the default, Hibernate will use an inner join to retrieve a &lt;join> defined by a class(My question: Would anybody please give me an example to say: which is this class?) or its superclasses((My question: Would anybody please give me an example to say: which is this class?) ) and an outer join for a &lt;join> defined by a subclass((My question: Would anybody please give me an example to say: which is this class?) ). If set to select then Hibernate will use a sequential select for a &lt;join> defined on a subclass((My question: Would anybody please give me an example to say: which is this class?)), which will be issued only if a row turns out to represent an instance of the subclass((My question: Would anybody please give me an example to say: which is this class?)). Inner joins will still be used to retrieve a  defined by the class and its superclasses((My question: Would anybody please give me an example to say: which is this class?) ).</p>\n\n<p>In other words, I want to know what are all the classes said below:\nfetch (optional - defaults to join): If set to join, the default, Hibernate will use an inner join to retrieve a &lt;join> defined by a class or its superclasses and an outer join for a &lt;join> defined by a subclass. If set to select then Hibernate will use a sequential select for a &lt;join> defined on a subclass, which will be issued only if a row turns out to represent an instance of the subclass. Inner joins will still be used to retrieve a &lt;join> defined by the class and its superclasses. </p>\n\n<p>For &lt;any>, what kind of scenarios is it suitable for?, would u please explain how it works? Is there anybody providing example and explaining this to me? Thanks. </p>\n"},{"tags":["hibernate","exception","serialization","deserialization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13253403,"title":"org.hibernate.type.SerializationException: could not deserialize","body":"<p>I'm using two tables by Hibernate and\nI dont understand why for particular query I have this problem.\nI hope someone recognizes the problem.</p>\n\n<p>I have a table user </p>\n\n<pre><code>@Entity\n@Table(name=\"user\")\npublic class User implements Serializable {\nprivate static final long serialVersionUID = 1L;\nprivate Long idUser;\nprivate Area area;\n\n//...other get and setter\n\n@OneToOne(fetch=FetchType.EAGER)\n@JoinColumn(name=\"idarea\")\npublic Area getArea() {\nreturn area;\n}\n}\n</code></pre>\n\n<p>and a table area</p>\n\n<pre><code>@Entity\n@Table(name = \"area\")\npublic class Area implements Serializable {\nprivate static final long serialVersionUID = 1L;\n\n@Id @GeneratedValue(strategy=GenerationType.AUTO)\n@Column(name=\"idarea\")\nprivate Long idArea;\n\n@Column(name=\"area_name\")\nprivate String areaName;\n//...other get and setter\n\n}\n</code></pre>\n\n<p>LOGS says:</p>\n\n<pre><code>15:27:28,140  INFO DefaultLoadEventListener:160 - Error performing load command\norg.hibernate.type.SerializationException: could not deserialize\nat org.hibernate.util.SerializationHelper.doDeserialize(SerializationHelper.java:262)\nat org.hibernate.util.SerializationHelper.deserialize(SerializationHelper.java:306)\nat org.hibernate.type.descriptor.java.SerializableTypeDescriptor.fromBytes(SerializableTypeDescriptor.java:130)\nat org.hibernate.type.descriptor.java.SerializableTypeDescriptor.wrap(SerializableTypeDescriptor.java:116)\nat org.hibernate.type.descriptor.java.SerializableTypeDescriptor.wrap(SerializableTypeDescriptor.java:39)\nat org.hibernate.type.descriptor.sql.VarbinaryTypeDescriptor$2.doExtract(VarbinaryTypeDescriptor.java:62)\nat org.hibernate.type.descriptor.sql.BasicExtractor.extract(BasicExtractor.java:64)\nat org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:254)\nat org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:250)\nat org.hibernate.type.AbstractStandardBasicType.nullSafeGet(AbstractStandardBasicType.java:230)\nat org.hibernate.type.AbstractStandardBasicType.hydrate(AbstractStandardBasicType.java:331)\nat org.hibernate.persister.entity.AbstractEntityPersister.hydrate(AbstractEntityPersister.java:2283)\n....//other lines\norg.springframework.orm.hibernate3.HibernateSystemException: could not deserialize; nested exception is org.hibernate.type.SerializationException: could not deserialize\n</code></pre>\n"},{"tags":["hibernate","spring-mvc","like-operator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13266229,"title":"HQL like operator for case insensitive search","body":"<p>I am implementing an autocomplete functionality using Jquery, when I type the name, it fetches the record from the db, The records stored in db are mixture of capital &amp; small letters. I have written a HQL Query which fetches me the records with case-sensitive, but I need to records irrespective of case. Here is the query,</p>\n\n<pre><code>List&lt;OrganizationTB&gt; resultList = null;\nQuery query = session.createQuery(\"from DataOrganization dataOrg where dataOrg.poolName   \nlike '%\"+ poolName +\"%'\");\nresultList =  query.list();    \n</code></pre>\n\n<p>Ex : If I have pool names, HRMS Data set, Hrms Data, Hr data etc... if I type HR or hr I need to get all the 3 records, which I'm not able to. </p>\n\n<p>Please help... </p>\n"},{"tags":["hibernate","hibernate-search"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13239678,"title":"how to use \"or\" in hibernate for keyword search through a table fields","body":"<p>I want to search my table (book) on any of its fields (author_name, book_title, description, publisher name) by keyword, using Hibernate.</p>\n\n<p>I tried using the code below but my code is good enough for only two fields:</p>\n\n<p><strong>New Update Code</strong> but here \"createDisjunction()\" is not supporting.Showing error ->The method create disjunction is undefined for the type restrictions</p>\n\n<pre><code>           import org.hibernate.Criteria;\n           import org.hibernate.HibernateException;\n           import org.hibernate.Query;\n           import org.hibernate.Session;\n           import org.hibernate.SessionFactory; \n           import org.hibernate.criterion.Restrictions;\n            ............\n           ............\n           qry.add(Restrictions.createDisjunction()//But this 'createDisjunction()'  is showing error              \n                          //error:the method create disjunction is undefined for the type restrictions\n\n                         .add(Restrictions.eq(\"authLastname\",   keywordsearch ))\n                          .add(Restrictions.eq(\"bookTitile\", keywordsearch  ))\n                          .add(Restrictions.eq(\"description\",   keywordsearch  )) \n                     ); \n</code></pre>\n\n<p>I also tried <a href=\"http://docs.jboss.org/hibernate/search/4.1/reference/en-US/html_single/\" rel=\"nofollow\">this tutorial</a> to understand, but I am unable to solve my problem. </p>\n"},{"tags":["hibernate","hql","criteria-api","hibernate-criteria","hibernate-annotations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13265788,"title":"Hibernate @ManyToOne to non-primary key column always fetched lazily","body":"<p>I have an issue with Hibernate, with two tables:</p>\n\n<pre><code>         Table \"steamx.users\"\n Column |          Type          | Modifiers\n--------+------------------------+-----------\n id     | integer                | not null\n userid | character varying(255) | not null\nIndexes:\n    \"Users_pkey\" PRIMARY KEY, btree (id)\n</code></pre>\n\n<p>and (from Spring Social):</p>\n\n<pre><code>            Table \"steamx.userconnection\"\n     Column     |          Type          | Modifiers\n----------------+------------------------+-----------\n userid         | character varying(255) | not null\n providerid     | character varying(255) | not null\n provideruserid | character varying(255) | not null\n rank           | integer                | not null\n displayname    | character varying(255) |\n profileurl     | character varying(512) |\n imageurl       | character varying(512) |\n accesstoken    | character varying(255) | not null\n secret         | character varying(255) |\n refreshtoken   | character varying(255) |\n expiretime     | bigint                 |\nIndexes:\n    \"userconnection_pkey\" PRIMARY KEY, btree (userid, providerid, provideruserid)\nForeign-key constraints:\n    \"uc_u_fk\" FOREIGN KEY (userid) REFERENCES steamx.users(userid) ON DELETE RESTRICT\n</code></pre>\n\n<p>and the following mapping:</p>\n\n<p>User:</p>\n\n<pre><code>@Entity\n@Table(name = \"Users\")\n@Access(AccessType.PROPERTY)\n@SequenceGenerator(name = \"Users_seq\", sequenceName = \"Users_seq\", allocationSize = 1, initialValue = 1)\npublic class User implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    private int id;\n    private String userId;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"Users_seq\")\n    public int getId()\n    {\n        return this.id;\n    }\n...\n</code></pre>\n\n<p>UserConnection:</p>\n\n<pre><code>@Entity\n@Table(name = \"UserConnection\")\n@Access(AccessType.PROPERTY)\npublic class UserConnection\n{\n    private UserConnectionPk pk;\n...\n\n    /**\n     * @return the pk\n     */\n    @Id\n    public UserConnectionPk getPk()\n    {\n        return this.pk;\n    }\n...\n</code></pre>\n\n<p>UserConnectionPk:</p>\n\n<p>@Embeddable\npublic class UserConnectionPk implements Serializable\n{\n    private User user;\n...</p>\n\n<pre><code>@ManyToOne(fetch = FetchType.EAGER)\n@Fetch(FetchMode.JOIN)\n@JoinColumn(name = \"userId\", referencedColumnName = \"userId\")\npublic User getUser()\n{\n    return this.user;\n}\n</code></pre>\n\n<p>...</p>\n\n<p>(All these extra annotations are just an attempt to get JOINs...)</p>\n\n<p>The key point is <code>@JoinColumn(name = \"userId\", referencedColumnName = \"userId\")</code> - UserConnection references Users on non User's primary key.</p>\n\n<p>Now I want to get some (all or one) UserConnections with associated (<code>@ManyToOne</code>) users in one query. Unfortunately everything ends with two queries...</p>\n\n<p><strong>standard Criteria Query relying on annotations:</strong></p>\n\n<pre><code>session.createCriteria(UserConnection.class).list();\n</code></pre>\n\n<p>result: two queries - one for each table</p>\n\n<p><strong>standard Criteria query with explicit fetch mode:</strong></p>\n\n<pre><code>session.createCriteria(UserConnection.class).setFetchMode(\"pk.user\", org.hibernate.FetchMode.JOIN).list();\n</code></pre>\n\n<p>result: two queries - one for each table</p>\n\n<p><strong>standard Criteria query with explicit join (sic!)</strong></p>\n\n<pre><code>session.createCriteria(UserConnection.class).createCriteria(\"pk.user\", \"u\", JoinType.INNER_JOIN).add(Restrictions.eq(\"u.userId\", \"jan.nowak.333\")).list();\n</code></pre>\n\n<p>result: error (!) because the generated SQL doesn't contain <code>JOIN</code> clause (but contains proper <code>WHERE</code> clause):</p>\n\n<pre><code>select\n    this_.providerId as providerId1_0_,\n    this_.providerUserId as provider2_1_0_,\n    this_.userId as userId1_0_,\n    this_.accessToken as accessTo3_1_0_,\n    this_.displayName as displayN4_1_0_,\n    this_.expireTime as expireTime1_0_,\n    this_.imageUrl as imageUrl1_0_,\n    this_.profileUrl as profileUrl1_0_,\n    this_.rank as rank1_0_,\n    this_.refreshToken as refreshT9_1_0_,\n    this_.secret as secret1_0_ \nfrom\n    steamx.UserConnection this_ \nwhere\n    u1_.userId=?\n</code></pre>\n\n<p><strong>HQL query with explicit <code>join fetch</code></strong></p>\n\n<pre><code>session.createQuery(\"from UserConnection uc join fetch uc.pk.user u where u.userId=?\").setString(0, \"jan.nowak.333\").list();\n</code></pre>\n\n<p>result: almost OK, but the second <code>SELECT</code> is executed anyway. Here are the statements:</p>\n\n<p>first (just what I need!):</p>\n\n<pre><code>select\n    userconnec0_.providerId as providerId1_0_,\n    userconnec0_.providerUserId as provider2_1_0_,\n    userconnec0_.userId as userId1_0_,\n    user1_.id as id2_1_,\n    userconnec0_.accessToken as accessTo3_1_0_,\n    userconnec0_.displayName as displayN4_1_0_,\n    userconnec0_.expireTime as expireTime1_0_,\n    userconnec0_.imageUrl as imageUrl1_0_,\n    userconnec0_.profileUrl as profileUrl1_0_,\n    userconnec0_.rank as rank1_0_,\n    userconnec0_.refreshToken as refreshT9_1_0_,\n    userconnec0_.secret as secret1_0_,\n    user1_.userId as userId2_1_ \nfrom\n    steamx.UserConnection userconnec0_ \ninner join\n    steamx.Users user1_ \n        on userconnec0_.userId=user1_.userId \nwhere\n    user1_.userId=?\n</code></pre>\n\n<p>second (very unnecessary):</p>\n\n<pre><code>select\n    user0_.id as id2_0_,\n    user0_.userId as userId2_0_ \nfrom\n    steamx.Users user0_ \nwhere\n    user0_.userId=?\n</code></pre>\n\n<p>Is there a way to optimize this case?</p>\n"},{"tags":["spring","hibernate","jsp","oracle10g","clob"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":411,"score":6,"question_id":12075253,"title":"java.sql.SQLException: operation not allowed: streams type cannot be used in batching while inserting data into Oracle clob data type","body":"<p>I'm using Hibernate Tools 3.2.1.GA with Spring version 3.0.2. I'm tying to insert data into Oracle (10g) database field of type <code>clob</code> as follows.</p>\n\n<pre><code>Clob c=Hibernate.createClob(request.getParameter(\"someTextFieldValueOnJSPPage\");\npojoObj.setSomeClobProperty(c);\n</code></pre>\n\n<p>it works just fine but when I attempt to insert a stream of data using a <a href=\"http://ckeditor.com/blog/CKEditor_for_Java_released\">CKEditor</a>,  <a href=\"http://ckeditor.com/demo\">demo</a> on my JSP page (the CKEditor simply renders an HTML <code>&lt;textarea&gt;&lt;/textarea&gt;</code> element) that may involve formatted text as well as images, flash etc, it throws the following exception.</p>\n\n<pre><code>org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.hibernate.exception.GenericJDBCException: could not update: [model.Cms#1]\n</code></pre>\n\n<hr>\n\n<pre><code>org.hibernate.exception.GenericJDBCException: could not update: [model.Cms#1]\n</code></pre>\n\n<hr>\n\n<pre><code>java.sql.SQLException: operation not allowed: streams type cannot be used in batching\n</code></pre>\n\n<p>How to resolve that exception? Is this the <a href=\"http://srikanth-myjavaj2eeblog.blogspot.in/2008/08/javasqlsqlexception-operation-not.html\">Oracle driver problem</a> or something else? I'm using <code>ojdbc14.jar</code>, <code>Oracle JDBC Driver version - 9.0.2.0.0</code>.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>One of the entities that uses the <code>Clob</code> type is </p>\n\n<pre><code>public class Cms  implements java.io.Serializable\n{\n     private BigDecimal cmsId;\n     private Clob aboutUs;     //I'm currently dealing with this property.\n     private Clob contactUs;\n     private Clob privacyPolicy;\n     private Clob returnPolicy;\n     private Clob shippingPolicy;\n     private Clob termsOfUse;\n     private Clob exchangeLinks;\n     private Clob disclaimer;\n     private Clob aboutProducts;\n     private Clob purchasingConditions;\n     private Clob faq;\n\n    public Cms() {\n    }\n\n    public Cms(BigDecimal cmsId) {\n        this.cmsId = cmsId;\n    }\n    public Cms(BigDecimal cmsId, Clob aboutUs, Clob contactUs, Clob privacyPolicy, Clob returnPolicy, Clob shippingPolicy, Clob termsOfUse, Clob exchangeLinks, Clob disclaimer, Clob aboutProducts, Clob purchasingConditions, Clob faq) {\n       this.cmsId = cmsId;\n       this.aboutUs = aboutUs;\n       this.contactUs = contactUs;\n       this.privacyPolicy = privacyPolicy;\n       this.returnPolicy = returnPolicy;\n       this.shippingPolicy = shippingPolicy;\n       this.termsOfUse = termsOfUse;\n       this.exchangeLinks = exchangeLinks;\n       this.disclaimer = disclaimer;\n       this.aboutProducts = aboutProducts;\n       this.purchasingConditions = purchasingConditions;\n       this.faq = faq;\n    }\n\n    public BigDecimal getCmsId() {\n        return this.cmsId;\n    }\n\n    public void setCmsId(BigDecimal cmsId) {\n        this.cmsId = cmsId;\n    }\n\n    public Clob getAboutUs() {        &lt;-------------\n        return this.aboutUs;\n    }\n\n    public void setAboutUs(Clob aboutUs) {  &lt;-------------\n        this.aboutUs = aboutUs;\n    }\n    public Clob getContactUs() {\n        return this.contactUs;\n    }\n\n    public void setContactUs(Clob contactUs) {\n        this.contactUs = contactUs;\n    }\n    public Clob getPrivacyPolicy() {\n        return this.privacyPolicy;\n    }\n\n    public void setPrivacyPolicy(Clob privacyPolicy) {\n        this.privacyPolicy = privacyPolicy;\n    }\n    public Clob getReturnPolicy() {\n        return this.returnPolicy;\n    }\n\n    public void setReturnPolicy(Clob returnPolicy) {\n        this.returnPolicy = returnPolicy;\n    }\n    public Clob getShippingPolicy() {\n        return this.shippingPolicy;\n    }\n\n    public void setShippingPolicy(Clob shippingPolicy) {\n        this.shippingPolicy = shippingPolicy;\n    }\n    public Clob getTermsOfUse() {\n        return this.termsOfUse;\n    }\n\n    public void setTermsOfUse(Clob termsOfUse) {\n        this.termsOfUse = termsOfUse;\n    }\n    public Clob getExchangeLinks() {\n        return this.exchangeLinks;\n    }\n\n    public void setExchangeLinks(Clob exchangeLinks) {\n        this.exchangeLinks = exchangeLinks;\n    }\n    public Clob getDisclaimer() {\n        return this.disclaimer;\n    }\n\n    public void setDisclaimer(Clob disclaimer) {\n        this.disclaimer = disclaimer;\n    }\n    public Clob getAboutProducts() {\n        return this.aboutProducts;\n    }\n\n    public void setAboutProducts(Clob aboutProducts) {\n        this.aboutProducts = aboutProducts;\n    }\n    public Clob getPurchasingConditions() {\n        return this.purchasingConditions;\n    }\n\n    public void setPurchasingConditions(Clob purchasingConditions) {\n        this.purchasingConditions = purchasingConditions;\n    }\n    public Clob getFaq() {\n        return this.faq;\n    }\n\n    public void setFaq(Clob faq) {\n        this.faq = faq;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>In my Spring controller class, I'm using the following code to perform insertion on the <code>Clob</code> type in Oracle.</p>\n\n<pre><code>Cms c=new Cms();\nc.setCmsId(new BigDecimal(0));\nc.setAboutUs(Hibernate.createClob(request.getParameter(\"txtAboutUs\").toString()));\nsession.save(c);\nsession.flush();\nsession.getTransaction().commit();\nmodel.put(\"status\", \"1\");\nmodel.put(\"msg\",\"Insertion done successfully.\");\n//setParameter(cb);\n</code></pre>\n\n<p>Where <code>model</code> is simply a <code>Map model</code>, a formal parameter of the <code>submit()</code> method in the Spring controller class which is invoked when a submit button is clicked on the JSP page.</p>\n\n<hr>\n\n<p>I'm retrieving data using the following simple method in the Spring controller class</p>\n\n<pre><code>private void getData(Map model)\n{\n    Session session=NewHibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Cms&gt;list=session.createQuery(\"from Cms order by cmsId desc\").list();\n    model.put(\"list\", list);\n\n    session.flush();\n    session.getTransaction().commit();\n}\n</code></pre>\n\n<p>Tried to do as mentioned <a href=\"http://stackoverflow.com/q/1644559/1391249\">here</a> but to no avail (I'm facing the same exceptions as specified in that question).</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13264488,"title":"The method getCastTypeName(int) is undefined for the type Dialect","body":"<p>I'm getting this error for the application that uses <code>Hibernate</code> I need to work with:</p>\n\n<pre><code>The method getCastTypeName(int) is undefined for the type Dialect\n</code></pre>\n\n<p>It looks like I am using the wrong version of <code>Hibernate</code>.</p>\n\n<p>What version of does have this method in <code>Dialect</code>? </p>\n"},{"tags":["java","hibernate","jpa","validator"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13265191,"title":"hibernate validator with jpa, violations on transitive @Transient @NotNull fields","body":"<p>Validation using hibernate validator fails on the fields marked as <code>@Transient</code> and <code>@NotNull</code>. \nHowever it fails only for those that were already stored in the DB, but now are traversed in the tree of objects. (as their value is null of course)</p>\n\n<p>For the entities like this:</p>\n\n<pre><code>public class User {\n\n  @ManyToMany\n  @Fetch(org.hibernate.annotations.FetchMode.JOIN)\n  @Valid\n  private Set&lt;Role&gt; roles;\n\n  @NotNull\n  private String someField;\n}\n\npublic class Role {\n\n  @ManyToMany\n  @Fetch(org.hibernate.annotations.FetchMode.JOIN)\n  @Valid\n  private Set&lt;User&gt; users;\n}\n</code></pre>\n\n<p>As I do the validation of the <code>User</code> and there are more users with particular <code>Role</code> I have problem, that even if the current user validation succeeds, for the others I'm getting error.</p>\n\n<p>I do this validation on the client side prio to submitting data to server side.</p>\n\n<p>I've seen some ideas how to fix problems with validation of <code>@Transient</code> and <code>@NotNull</code>:</p>\n\n<ul>\n<li><p><a href=\"http://stackoverflow.com/questions/9266427/constraintviolationexception-user-entity-with-transient-confirmpassword-field\">ConstraintViolationException: User Entity with transient confirmPassword field</a></p></li>\n<li><p><a href=\"http://stackoverflow.com/questions/7267028/ignore-transient-pattern-on-save-hibernate-entity\">Ignore transient pattern on save hibernate entity</a></p></li>\n</ul>\n\n<p>However these didn't cover my case (of having violations on related objects). And moreover I didn't come to validation problems on server side yet :). As to test that would be a next step.</p>\n\n<p>So the question is, is there any way to explain validator, that transitive objects fetched from DB should be skipped during validation?</p>\n\n<p>I was thinking of extending the <code>JPATraversableResolver</code> that I currently use by overriding:</p>\n\n<pre><code> /**\n     * Determine if the Bean Validation provider is allowed to reach the property state\n     *\n     * @param traversableObject object hosting &lt;code&gt;traversableProperty&lt;/code&gt; or null  \n     *                          if validateValue is called\n     * @param traversableProperty the traversable property.\n     * @param rootBeanType type of the root object passed to the Validator.\n     * @param pathToTraversableObject path from the root object to\n     *        &lt;code&gt;traversableObject&lt;/code&gt;\n     *        (using the path specification defined by Bean Validator).\n     * @param elementType either &lt;code&gt;FIELD&lt;/code&gt; or &lt;code&gt;METHOD&lt;/code&gt;.\n     *\n     * @return &lt;code&gt;true&lt;/code&gt; if the Bean Validation provider is allowed to\n     *         reach the property state, &lt;code&gt;false&lt;/code&gt; otherwise.\n     */\n     boolean isReachable(Object traversableObject,\n                     Path.Node traversableProperty,\n                     Class&lt;?&gt; rootBeanType,\n                     Path pathToTraversableObject,\n                     ElementType elementType);\n</code></pre>\n\n<p>however, I still face the problem of determining which properties to check and which not. \nIf my check would be for transient fields of the currently persisted object, I'd not cover the case of persisting entities (2 related ones), where check would be on one of them and the other one would have problematic transient field.</p>\n\n<p>Any ideas? Any experiences with that?</p>\n"},{"tags":["java","mysql","hibernate","flex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13249620,"title":"How to select multiple values from Database using Hibernate IN key word?","body":"<p>I have Sample applicaion Flex+Java(using mysql database).\nActually i'm sending search result from flex to java method it is working one value.</p>\n\n<pre><code>for ex: we are giving flex textbox value---- \"java\" ------it is working fine \n</code></pre>\n\n<p>but we are giving more then two keywords <code>forex: java,flex</code>----it is not working</p>\n\n<p>Here is mysql query:</p>\n\n<pre><code>from Course where coursename in (:name)\n</code></pre>\n\n<p>and setting parameter....</p>\n"},{"tags":["database","hibernate","postgresql","gregorian-calendar","hijri"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12794072,"title":"Hijri Date Inserting to the Database","body":"<p>In my database, I used gregorian Date. I want to insert hijri date. How can it be done or is there any problem with it. I used hibernate and JPA.</p>\n\n<p>e.g. 2/30/1433 is hijri date. However, february is at most 29 days. In that case, is  there any error? </p>\n\n<p>best regards</p>\n"},{"tags":["java","hibernate","java-ee","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":11995430,"title":"Get the id of an entity in JPA without pulling the entity from the database?","body":"<p>Suppose I have the following two JPA entities which have a one to one relationship </p>\n\n<pre><code>@Entity\npublic class Foo {\n  @Id \n  private Integer id; \n\n  @Column(...)\n  private String data;\n}\n\n@Entity\npublic class Bar {\n    @Id \n    private Integer id; \n\n    @OneToOne(fetchType=LAZY)\n    @JoinColumn(name=\"foo_fk\")\n    private Foo foo; \n\n    @Column(...)\n    private String x; \n\n    @Column(...)\n    private String y; \n}\n</code></pre>\n\n<p>What I want to do is find all the Bar entities that meet some search criteria for example <code>SELECT Bar b FROM Bar WHERE b.x = :xValue</code> What i want to do is iterate the result set and extract the the primary key of foo and the value y i.e. code along the lines of.</p>\n\n<pre><code>List&lt;Bar&gt; results = // query to get all the results that meet value x \nfor(Bar bar: results) {\n    String x = bar.getX();\n    String y = bar.getY();\n    Integer fooId = bar.getFoo().getId(); // at this point Hibernate pulls back foo from the db \n    // do something with x,y and fooId \n }\n</code></pre>\n\n<p>What I want to avoid is having the ORM issue a SELECT for when i do <code>bar.getFoo().getId()</code>\n. I know that I can do a report query along the lines of <code>SELECT new com.example.MyResult(b.x,b.y,b.foo.id) FORM Bar b WHERE b.x = :xValue</code></p>\n\n<p>Is there a way to to avoid the select on <code>bar.getFoo().getId()</code>without writing a report query? I am using Hibernate 3.6.10 and JPA 2 I am happy to upgrade to Hibernate 4.1.x if it can do what I want.  </p>\n"},{"tags":["hibernate","jpa-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13265002,"title":"Store singelton value in JPA2/Hibernate","body":"<p>Is it possible in any way to make sure that I store one row in the DB for my Domain object using JPA/Hibernate or do  have to write my own logic for this? </p>\n"},{"tags":["hibernate","spring","orm","pojo","sessionfactory"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":944,"score":2,"question_id":8227217,"title":"ORM library jar into spring application to define a 'sessionFactory'","body":"<p><strong>Problem</strong></p>\n\n<p>I can't define a correct <code>sessionFactory</code> bean in my project and fails web application initialization.</p>\n\n<p><strong>Log output</strong></p>\n\n<pre><code>    Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'webServiceTest' defined in ServletContext resource [/WEB-INF/\nclasses/appcontext-spring.xml]: Invocation of init method failed; nested exception is java.lang.IllegalArgumentException: 'sessionFactory' or 'hibernateTemplate\n' is required\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1336)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:471)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:409)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:380)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:264)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:220)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:261)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:185)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:164)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:269)\n        ... 50 more\nCaused by: java.lang.IllegalArgumentException: 'sessionFactory' or 'hibernateTemplate' is required\n        at org.springframework.orm.hibernate3.support.HibernateDaoSupport.checkDaoConfig(HibernateDaoSupport.java:117)\n        at org.springframework.dao.support.DaoSupport.afterPropertiesSet(DaoSupport.java:44)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1367)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1333)\n        ... 60 more\n</code></pre>\n\n<p>I've created an ORM library with maven using <em>xml</em> mappings and pojos.\nI've imported into my project and I can't configure to access into DDBB.</p>\n\n<ul>\n<li><em>jdbc.properties</em> file is well defined with DDBB connection (<code>db.url</code>, <code>db.properties</code>, etc).</li>\n<li>All POJOs in library extend <em>HibernateDaoSupport</em> and implement basic op interface (CRUD). I'm using a service <strong>webServiceTest</strong> that extends <em>DaoBase</em> to make a test.</li>\n<li>I've did <em>JUnit</em> tests in ORM-library with good results.</li>\n</ul>\n\n<p>Here is <code>dataSource</code>, <code>sessionFactory</code>, etc definitions from <em>appcontext-persistance.xml</em> file:</p>\n\n<pre><code>    &lt;!-- PERSISTENCE SETUP --&gt;\n&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"\n    destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClassName\"&gt;\n        &lt;value&gt;${db.driver}&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"url\"&gt;\n        &lt;value&gt;${db.url}&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"username\"&gt;\n        &lt;value&gt;${db.username}&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"password\"&gt;\n        &lt;value&gt;${db.password}&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;property name=\"maxActive\"&gt;\n        &lt;value&gt;${db.maxActive}&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;!-- Maximum number of idle dB connections to retain in pool. Set \n        to 0 for no limit --&gt;\n    &lt;property name=\"maxIdle\"&gt;\n        &lt;value&gt;${db.maxIdle}&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;!-- Maximum time to wait for a dB connection to become available \n        in ms, in this example 10 seconds. An Exception is thrown if this timeout \n        is exceeded. Set to -1 to wait indefinitely. --&gt;\n    &lt;property name=\"maxWait\"&gt;\n        &lt;value&gt;${db.maxWait}&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;!-- Autocommit setting. This setting is required to make Hibernate \n        work. Or you can remove calls to commit(). --&gt;\n    &lt;property name=\"defaultAutoCommit\"&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;!-- Recover abandoned connections --&gt;\n    &lt;property name=\"removeAbandoned\"&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;!-- Set the number of seconds a dB connection has been idle before \n        it is considered abandoned. --&gt;\n    &lt;property name=\"removeAbandonedTimeout\"&gt;\n        &lt;value&gt;11&lt;/value&gt;\n    &lt;/property&gt;\n\n    &lt;!-- Log a stack trace of the code which abandoned the dB connection \n        resources. --&gt;\n    &lt;property name=\"logAbandoned\"&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/property&gt;\n\n&lt;/bean&gt;\n\n&lt;bean id=\"transactionManager\"\n    class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;\n        &lt;ref local=\"sessionFactory\" /&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\"\n    class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"lobHandler\"&gt;\n        &lt;ref bean=\"oracleLobHandler\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n\n    &lt;!-- configura la fuente de los mappings --&gt;\n    &lt;property name=\"configLocation\" value=\"classpath:hibernate.cfg.xml\" /&gt;\n\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n\n            &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.Oracle9iDialect&lt;/prop&gt;\n            &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>Questions:</p>\n\n<ul>\n<li>Spring configuration has to load <em>hibernate.cfg.xml</em> from ORM jar? How can I do this ?</li>\n<li>How should I load a configuration from a Spring ORM project into another ?</li>\n<li>I define the mappings in ORM but I don't have any application context defined in ORM to include in the jar.</li>\n</ul>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13251818,"title":"Fetching specific number of records not working in Hibernate","body":"<p>I have a table which contains 1000 records.</p>\n\n<p>I needed to pull 100 records at a time so I used <code>setFetchSize</code> in the hibernate Criteria as below(<code>Deal</code> is the entity object) </p>\n\n<pre><code> List&lt;Deal&gt; dealList= sess.createCriteria(Deal.class).setFetchSize(100).list();\n</code></pre>\n\n<p>But, after the above query when I printed the <code>dealList</code> size as   </p>\n\n<pre><code>System.out.println(\"no. of deals \"+dealList.size());\n</code></pre>\n\n<p>it gave 1000 records not 100 records.</p>\n\n<p>Did I miss anything?</p>\n"},{"tags":["java","hibernate","spring","transactions"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1655,"score":3,"question_id":3573418,"title":"Spring Transaction propagation issue","body":"<p>I am using Transaction management with Spring and Hibernate.\nMy situation is as follow: <br>\nI have got bean <strong>A</strong> which is sorrounded by transaction\nand it call bean <strong>B</strong> which is defined with transaction including the attribute 'PROPAGATION_REQUIRED'</p>\n\n<p>B in this case doesn't open new transaction but uses the exsiting one (saw in the logs: 'Participating in existing transaction'). However in case the method in B will throw a runtimeException, on its way back to A it will dirty the transaction and will cause it to be marked for roll-back, even if the external method of A will catch the exception and won't throw it away. I think that this behavior is wrong, in this case I want A to control the transaction and B should not interrupt the transaction in any case. <br>\nIs there any way to define B to open transaction if no transaction defined but DO NOTHING if it is already inside an exising transaction and let the upper level make the decision whether to commit or roll-back?</p>\n\n<p>See more responses about this issue in a thread in Spring community <a href=\"http://forum.springsource.org/showthread.php?t=94324\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13264187,"title":"Commiting the failed transaction again","body":"<p>I have some database operation present inside the transaction. I am setting the entity objects and tried to save them using session.merge(object). But due to some constraint transaction is failing. I have provided a exception handler in which i am setting the same object once again and tried to commit it. My question is that after the failed transaction whether the values which i have set earlier will still be there in the object or not.</p>\n"},{"tags":["java","hibernate","dynamic","orm"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":32,"score":0,"question_id":13263910,"title":"dynamic class creation in java solution","body":"<p>I know that this will not work, which sucks IMO, but I am wondering what is my best solution.  After some searching I have found out about ORM and hibernate.  After finding out about them I have found many people who say its more hassle than it is worth and promotes laziness.  Please can anyone point me in a good direction?</p>\n\n<pre><code>//Setup the weapon classes\nlogger.info(\"Initializing the weapon classes.\");\nstat = conn.prepareStatement(\"SELECT *\" + \n                            \" FROM \" + DB_NAME + \".weapons\");\nrs = stat.executeQuery();\nwhile (rs.next()) {\n    Weapon rs.getString(\"name\") = new Weapon(rs.getint(\"weapon_id\"), rs.getString(\"name\"), rs.getString(\"description\"), rs.getString(\"filename\"), rs.getint(\"rarity\"), rs.getint(\"sell_price\"), rs.getint(\"quantity_max\"), rs.getint(\"slot\"), rs.getint(\"level_requirement\"), rs.getint(\"strength_requirement\"), rs.getint(\"dexterity_requirement\"), rs.getint(\"intelligence_requirement\"), rs.getint(\"enchanted_increase\"), rs.getint(\"enchanted_cost\"), rs.getint(\"hit_min\"), rs.getint(\"hit_max\"), rs.getint(\"speed\"), rs.getint(\"elemental_type\"), rs.getint(\"elemental_hit_min\"), rs.getint(\"elemental_hit_max\"));\n}\n</code></pre>\n\n<p>I know this has been asked many times, but I am just finding so many contradictory opinions. :(</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13262508,"title":"ORDER BY a result column AFTER a native JPA/Hibernate query has executed","body":"<p>Say I have the following native SQL:</p>\n\n<pre><code>SELECT a, b, c + d AS cd\nFROM stuff\n</code></pre>\n\n<p>I know it's easy to just sort it using <code>order by</code>.</p>\n\n<p>I was just wondering if JPA/Hibernate has a way to specify ordering AFTER the query executes and the results have returned, e.g. for sorting by the <code>cd</code> column. Basically something like a Comparator (except it's built into the ORM).</p>\n"},{"tags":["query","hibernate","grails","data-binding","gorm"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13262418,"title":"GORM delay in binding SQL param to a query","body":"<p>Trying to tweak a long running grails service and going through the SQL logs I find this behavior that is puzzling me a bit. The hibernate generated query is parametrized and one would hope that the query would be cached in the db-server and the binding should be instantaneous as well (used Burt Beckwith's suggestions to implement the SQL logging). </p>\n\n<pre><code>2012-11-06 00:30:39,488 [Thread-22] DEBUG hibernate.SQL  -\n    /* criteria query */ select\n..\n..\n2012-11-06 00:30:39,605 [Thread-22] TRACE sql.BasicBinder  -  - binding parameter [1] as [TIMESTAMP] - \n</code></pre>\n\n<p>So, it looks like binding is happening after 100ms. I would like to know why should this happen? Other queries report the same time for query and binding. What can be done to make it more efficient?</p>\n"},{"tags":["java","hibernate","annotations","one-to-many","many-to-one"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13262287,"title":"How does hibernate save one-to-many / many-to-one annotations? (Children not saving)","body":"<p>I've inherited a hibernate application and I've run into issues. It seems that the code does not save the child in a One-To-Many relationship. It's bidirectional, but on save of parent object, it doesn't seem to save the child. </p>\n\n<p>The Question class is the parent in this case.</p>\n\n<pre><code>// Question.java\n@Entity\n@SequenceGenerator(name = \"question_sequence\", sequenceName = \"seq_question\", allocationSize = 1000)\n@Table(name = \"question\")\npublic class Question {\n   protected Long questionId;\n   protected Set&lt;AnswerValue&gt; answerValues;\n\n   public TurkQuestion(){}\n\n   public TurkQuestion(Long questionId){\n      this.questionId = questionId;\n   }\n\n   @Id @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"question_sequence\")\n   @Column(name = \"question_id\")\n   public Long getQuestionId(){\n      return questionId;\n   }\n\n   @OneToMany(fetch = FetchType.EAGER)\n   @JoinColumn(name = \"question_id\",referencedColumnName=\"question_id\")\n   public Set&lt;AnswerValue&gt; getAnswerValues(){\n      return answerValues;\n   }\n\n   public void setQuestionId(Long questionId){\n      this.questionId = questionId;\n   }\n\n   public void setAnswerValues(Set&lt;AnswerValue&gt; answerValues){\n      this.answerValues = answerValues;\n   }\n}\n</code></pre>\n\n<p>AnswerValue is the child class.</p>\n\n<pre><code>// AnswerValue.java\n@Entity\n@SequenceGenerator(name = \"answer_value_sequence\", sequenceName = \"seq_answer_value\", allocationSize = 1)\n@Table(name = \"answer_value\")\npublic class AnswerValue {\n    protected Long answerValueId;\n    protected Question question;\n    protected String answerValue;\n\n    public AnswerValue(){}\n\n    public AnswerValue(Long answerValueId, Long questionId, String answerValue){\n       this.answerValueId = answerValueId;\n       this.question = new Question(questionId);\n       this.answerValue = answerValue;\n    }\n\n    @Id @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"answer_value_sequence\")\n    @Column(name = \"answer_value_id\")\n    public Long getAnswerValueId(){\n       return answerValueId;\n    }\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"question_id\", nullable = false )\n    public Question getQuestion(){\n       return question;\n    }\n\n    @Column(name = \"answer_value\")\n    public String getAnswerValue(){\n       return answerValue;\n    }\n\n    public void setAnswerValueId(Long answerValueId){\n       this.answerValueId = answerValueId;\n    }\n\n    public void setQuestion(Question question){\n       this.question = question;\n    }\n\n    public void setAnswerValue(){\n       this.answerValue = answerValue;\n    }\n}\n</code></pre>\n\n<p>And the DAO:</p>\n\n<pre><code>// QuestionDao.java\npublic class QuestionDao {\n   public void saveOrUpdateAll(List&lt;Question&gt; list){\n      getHibernateTemplate().saveOrUpdateAll(list);\n   }\n}\n</code></pre>\n\n<p>It seems when I call saveOrUpdateAll, Question is saved, but the AnswerValue that are children of the Question object are not.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks.</p>\n"},{"tags":["spring","hibernate","jsf-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13261566,"title":"JSF2 + Spring3 and hibernate: Spring Managed Bean (@Scope value=\"view\") LazyInitializationException exception","body":"<p>I've created custom spring scope using code found <a href=\"http://comdynamics.net/blog/109/spring3-jsf2-view-scope/\" rel=\"nofollow\">in this link</a> which enables the use of <code>view</code> scoped Spring managed bean similar to that of JSF2 @ViewScoped.</p>\n\n<p>When user presses the Submit button the following takes place:</p>\n\n<pre><code>- Backbean AA (@Scope(value=\"view\") calls injected @Service BB\n- @Service BB calls DAO class CC \n- CC is @Transactional(readOnly = true) and has sessionFactory injected \n     private SessionFactory sessionFactory;\n\n    //inject sessionGactory\n    public void setSessionFactory(SessionFactory sessionFactory) {\n        this.sessionFactory = sessionFactory;\n    }\n- in CC i set the @Transactional(readOnly = false, propagation = Propagation.REQUIRED)\n  for functions such as save/delete/saveOrUpdate\n</code></pre>\n\n<p>The Hibernate mapping concerning this class are:</p>\n\n<h2>RegUser.hbm.xml</h2>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.testApp.hibernate.RegUser\" table=\"reg_users\" schema=\"dbo\" catalog=\"devDB\"&gt;\n        &lt;id name=\"userPk\" type=\"java.lang.Long\"&gt;\n            &lt;column name=\"userPK\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"firstname\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"firstname\" length=\"25\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"lastname\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"lastname\" length=\"50\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;set name=\"UserVsOrderses\" inverse=\"true\"&gt;\n            &lt;key&gt;\n                &lt;column name=\"userPK\" not-null=\"true\" /&gt;\n            &lt;/key&gt;\n            &lt;one-to-many class=\"com.testApp.hibernate.UserVsOrders\" /&gt;\n        &lt;/set&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<h2>UserVsOrders.hbm.xml</h2>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.testApp.hibernate.custOrders\" table=\"custOrders\" schema=\"dbo\" catalog=\"devDB\"&gt;\n        &lt;composite-id name=\"id\" class=\"com.testApp.hibernate.custOrdersId\"&gt;\n            &lt;key-property name=\"userPk\" type=\"java.lang.Long\"&gt;\n                &lt;column name=\"userPK\" /&gt;\n            &lt;/key-property&gt;\n            &lt;key-property name=\"OrderPk\" type=\"java.lang.Long\"&gt;\n                &lt;column name=\"OrderPK\" /&gt;\n            &lt;/key-property&gt;\n        &lt;/composite-id&gt;\n        &lt;many-to-one name=\"RegUser\" class=\"com.testApp.hibernate.RegUser\" update=\"false\" insert=\"false\" fetch=\"select\"&gt;\n            &lt;column name=\"userPK\" not-null=\"true\" /&gt;\n        &lt;/many-to-one&gt;\n        &lt;many-to-one name=\"Order\" class=\"com.testApp.hibernate.Order\" update=\"false\" insert=\"false\" fetch=\"select\"&gt;\n            &lt;column name=\"OrderPK\" not-null=\"true\" /&gt;\n        &lt;/many-to-one&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<h2>applicationContext.xml</h2>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:p=\"http://www.springframework.org/schema/p\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n                        http://www.springframework.org/schema/tx\n                        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n                        http://www.springframework.org/schema/context\n                        http://www.springframework.org/schema/context/spring-context-3.1.xsd\"&gt;\n\n    &lt;context:component-scan base-package=\"com.testApp\" /&gt;\n    &lt;context:annotation-config /&gt;\n\n    &lt;bean class=\"org.springframework.beans.factory.config.CustomScopeConfigurer\"&gt;\n        &lt;property name=\"scopes\"&gt;\n            &lt;map&gt;\n                &lt;entry key=\"view\"&gt;\n                    &lt;bean class=\"com.testApp.util.ViewScope\" /&gt;\n                &lt;/entry&gt;\n            &lt;/map&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"&gt;\n        &lt;property name=\"driverClassName\" value=\"net.sourceforge.jtds.jdbc.Driver\"&gt;\n        &lt;/property&gt;\n        &lt;property name=\"url\" value=\"jdbc:jtds:sqlserver://localhost:1433/devDB\"&gt;\n        &lt;/property&gt;\n        &lt;property name=\"username\" value=\"blabla\"&gt;&lt;/property&gt;\n        &lt;property name=\"password\" value=\"blabla\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\"&gt;\n            &lt;ref bean=\"dataSource\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServer2008Dialect&lt;/prop&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.min_size\"&gt;5&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.max_size\"&gt;20&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.idle_test_period\"&gt;300&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.timeout\"&gt;1800&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.max_statements\"&gt;50&lt;/prop&gt;\n                &lt;prop key=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"c3p0.acquire_increment\"&gt;1&lt;/prop&gt;\n            &lt;props&gt;\n        &lt;/property&gt;\n\n\n    &lt;bean id=\"transactionManager\"\n        class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"\n        p:sessionFactory-ref=\"sessionFactory\" /&gt;\n\n    &lt;bean id=\"transactionTemplate\" class=\"org.springframework.transaction.support.TransactionTemplate\"&gt;\n        &lt;property name=\"transactionManager\" ref=\"transactionManager\"/&gt;\n    &lt;/bean&gt;\n\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n    ...\n    &lt;!-- some other beans declared below --&gt;\n\n    ...\n    &lt;!-- all the Mapping Resource  --&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<p>My Problem is that one first form submit all is well, but on the next form submit i get: </p>\n\n<pre><code>failed to lazily initialize a collection, no session or session was closed\n\nviewId=/page/regNewCust.xhtml\nlocation=C:\\repo\\dev\\WebRoot\\nz\\regNewCust.xhtml\nphaseId=PROCESS_VALIDATIONS(3)\n\nCaused by:\norg.hibernate.LazyInitializationException - failed to lazily initialize a collection, no session or session was closed\nat org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:394)\n</code></pre>\n\n<p>The page works fine if i set bean scope as <code>@Scope(value='request')</code></p>\n\n<p>I have tried adding the folloiwng to <code>web.xml</code> but it didn't help:</p>\n\n<pre><code>&lt;filter&gt;\n    &lt;filter-name&gt;openSessionInViewFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.orm.hibernate4.support.OpenSessionInViewFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;openSessionInViewFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre>\n\n<p>I've also tried adding <code>&lt;set name=\"UserVsOrderses\" inverse=\"true\" fetch=\"join\"&gt;</code> which didn't help either.</p>\n\n<p>Can anyone point of what i'm doing wrong and how i can fix the issue?</p>\n"},{"tags":["hibernate","one-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":494,"score":2,"question_id":11104897,"title":"Hibernate : attempted to assign id from null one-to-one property: employee","body":"<p>This is my Databse Structure one to one mapping in mysql </p>\n\n<p><img src=\"http://i.stack.imgur.com/oodn4.png\" alt=\"DB Schema\"></p>\n\n<p>This is my java file:</p>\n\n<pre><code>public class Employee {\n\nprivate EmployeeDetail empdetail ;\nprivate String firstname;\nprivate String lastname;\n\n// getters and setters \n\n}\n\n\npublic class EmployeeDetail {\n                private Employee employee ;\n                private int employee_id;\n    private String street;\n    private String city;\n    private String state;\n    private String country;\n\n// getters and setters \n\n}\n</code></pre>\n\n<p>This is my mapping file: </p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n\n     &lt;class name=\"Employee\" table=\"employee\"&gt;\n        &lt;id name=\"employee_id\"  type=\"java.lang.Integer\"  column=\"employee_id\"&gt;\n            &lt;generator class=\"assigned\" /&gt;\n        &lt;/id&gt;\n        &lt;one-to-one name=\"empdetail\" class=\"EmployeeDetail\"\n            cascade=\"all\"&gt;&lt;/one-to-one&gt;\n\n        &lt;property name=\"firstname\" type=\"java.lang.String\" column=\"firstname\" /&gt;\n        &lt;property name=\"lastname\" type=\"java.lang.String\" column=\"lastname\" /&gt;\n\n    &lt;/class&gt;\n\n\n\n &lt;class name=\"EmployeeDetail\" table=\"employeedetail\"&gt;\n        &lt;id name=\"employee_id\" type=\"java.lang.Integer\"  column=\"employee_id\"&gt;\n       &lt;generator class=\"foreign\"&gt;\n                &lt;param name=\"property\"&gt;employee&lt;/param&gt;\n            &lt;/generator&gt;\n        &lt;/id&gt;\n        &lt;one-to-one name=\"employee\" class=\"Employee\"\n            cascade=\"save-update\"&gt;&lt;/one-to-one&gt;\n\n        &lt;property name=\"street\"  type=\"java.lang.String\" column=\"street\" /&gt;\n        &lt;property name=\"city\" type=\"java.lang.String\" column=\"city\" /&gt;\n        &lt;property name=\"state\" type=\"java.lang.String\" column=\"state\" /&gt;\n        &lt;property name=\"country\" type=\"java.lang.String\" column=\"country\" /&gt;\n\n &lt;/class&gt;\n\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>This is my client program: </p>\n\n<pre><code>Session session = factory.openSession();\n        Transaction tx = session.beginTransaction();\n\n        EmployeeDetail edetail = new EmployeeDetail();\n        edetail.setCity(\"Hyd\");\n        edetail.setCountry(\"India\");\n        edetail.setEmployee_id(222);\n        edetail.setState(\"Andhra Pradesh\");\n\n        Employee employee = new Employee();\n\n        employee.setEmployee_id(222);\n        employee.setFirstname(\"Pavan\");\n        employee.setLastname(\"Jaooi\");\n        employee.setEmpdetail(edetail);\n\n        session.merge(employee);\n        tx.commit();\n        session.close();\n        factory.close();\n</code></pre>\n\n<p>This is the exception I am getting:</p>\n\n<pre><code>INFO: Not binding factory to JNDI, no JNDI name configured\nHibernate: select employee0_.employee_id as employee1_0_1_, employee0_.firstname as firstname0_1_, employee0_.lastname as lastname0_1_, employeede1_.employee_id as employee1_1_0_, employeede1_.street as street1_0_, employeede1_.city as city1_0_, employeede1_.state as state1_0_, employeede1_.country as country1_0_ from employee employee0_ left outer join employeedetail employeede1_ on employee0_.employee_id=employeede1_.employee_id where employee0_.employee_id=?\nHibernate: select employeede0_.employee_id as employee1_1_0_, employeede0_.street as street1_0_, employeede0_.city as city1_0_, employeede0_.state as state1_0_, employeede0_.country as country1_0_ from employeedetail employeede0_ where employeede0_.employee_id=?\nException in thread \"main\" org.hibernate.id.IdentifierGenerationException: attempted to assign id from null one-to-one property: employee\n    at org.hibernate.id.ForeignGenerator.generate(ForeignGenerator.java:44)\n    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:99)\n    at org.hibernate.event.def.DefaultMergeEventListener.entityIsTransient(DefaultMergeEventListener.java:186)\n    at org.hibernate.event.def.DefaultMergeEventListener.entityIsDetached(DefaultMergeEventListener.java:240)\n    at org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:120)\n    at org.hibernate.impl.SessionImpl.fireMerge(SessionImpl.java:687)\n    at org.hibernate.impl.SessionImpl.merge(SessionImpl.java:669)\n    at org.hibernate.engine.CascadingAction$6.cascade(CascadingAction.java:245)\n    at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:268)\n    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:216)\n    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)\n    at org.hibernate.engine.Cascade.cascade(Cascade.java:130)\n    at org.hibernate.event.def.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:456)\n    at org.hibernate.event.def.DefaultMergeEventListener.entityIsTransient(DefaultMergeEventListener.java:194)\n    at org.hibernate.event.def.DefaultMergeEventListener.entityIsDetached(DefaultMergeEventListener.java:240)\n    at org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:120)\n    at org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:53)\n    at org.hibernate.impl.SessionImpl.fireMerge(SessionImpl.java:677)\n    at org.hibernate.impl.SessionImpl.merge(SessionImpl.java:661)\n    at org.hibernate.impl.SessionImpl.merge(SessionImpl.java:665)\n    at CustomerClient.main(CustomerClient.java:31)\n</code></pre>\n"},{"tags":["eclipse","hibernate","persistence","jpa-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1456,"score":1,"question_id":5143353,"title":"Unable to configure EntityManagerFactory from runnable jar","body":"<p>I'm developing a JPA-2.0 application using Hibernate3. It runs fine from eclipse, but if run it from a generated runnable jar, it gives a javax.persistence.PersistenceException: Unable to configure EntityManagerFactory:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:56)\nCaused by: javax.persistence.PersistenceException: Unable to configure EntityManagerFactory\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:374)\n    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:56)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:48)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:32)\nCaused by: java.lang.StringIndexOutOfBoundsException: String index out of range: -1\n    at java.lang.String.substring(String.java:1937)\n    at org.hibernate.ejb.packaging.JarVisitorFactory.getJarURLFromURLEntry(JarVisitorFactory.java:55)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:340)\n    ... 12 more\n</code></pre>\n\n<p>If I unpack this same jar, and run the class directly, it works though:</p>\n\n<pre><code>java -cp .:&lt;add list to all .jar files&gt; MainClass\n</code></pre>\n\n<p>I cannot figure out what's wrong.</p>\n"},{"tags":["spring","hibernate","jpa","transactions","flush"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13259677,"title":"How do I set flush mode to \"COMMIT\" in my configuration files?","body":"<p>I'm using Spring 3.1.1.RELEASE, Hibernate 4.1.0.Final, and JPA 2.0.  Is there a way I can configure Spring transactions to commit after the transactions are executed without Java code?  In other words, I would like to set flush mode to commit in either the application context file, hibernate configuration file, or persistence.xml file.  My Spring transaction service class looks like</p>\n\n<pre><code>@Transactional(rollbackFor = Exception.class)\n@Service\npublic class ContractServiceImpl implements ContractService\n{\n\n    @Autowired\n    private ContractDAO m_contractDao;\n\n    public void addContract(Contract contract)\n    {\n       m_contractDao.create(contract);\n    }\n\n    ...\n</code></pre>\n\n<p>and my application context is set up like so …</p>\n\n<pre><code>&lt;bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"org.hsqldb.jdbcDriver\"/&gt;\n    &lt;property name=\"url\" value=\"jdbc:hsqldb:mem:myproject\" /&gt;\n    &lt;property name=\"username\" value=\"sa\" /&gt;\n    &lt;property name=\"password\" value=\"\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n    &lt;property name=\"jpaVendorAdapter\"&gt;\n        &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"persistenceXmlLocation\" value=\"classpath*:META-INF/test-persistence.xml\"/&gt;\n    &lt;property name=\"persistenceUnitName\" value=\"testingDatabase\"/&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sharedEntityManager\" class=\"org.springframework.orm.jpa.support.SharedEntityManagerBean\"&gt;\n   &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n    &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;tx:annotation-driven /&gt;\n</code></pre>\n\n<p>My persistence.xml file is</p>\n\n<pre><code>&lt;persistence version=\"2.0\"\n   xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n   xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence\n        http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"&gt;\n        &lt;persistence-unit name=\"testingDatabase\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n                &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n                &lt;properties&gt;\n                        &lt;property name=\"hibernate.ejb.cfgfile\" value=\"/hsql_hibernate.cfg.xml\" /&gt;\n                &lt;/properties&gt;\n        &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>and my hibernate config file is</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD//EN\"\n\"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.connection.pool_size\"&gt;1&lt;/property&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"dialect\"&gt;org.hibernate.dialect.HSQLDialect&lt;/property&gt;\n        &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;create-drop&lt;/property&gt;\n\n        &lt;mapping class=\"org.mainco.subco.sbadmin.domain.Product\" /&gt;\n        &lt;mapping class=\"org.mainco.subco.sbadmin.domain.Contract\" /&gt;\n        &lt;mapping class=\"org.mainco.subco.organization.domain.Country\" /&gt;\n        &lt;mapping class=\"org.mainco.subco.organization.domain.State\" /&gt;\n        &lt;mapping class=\"org.mainco.subco.organization.domain.Address\" /&gt;\n        &lt;mapping class=\"org.mainco.subco.organization.domain.OrganizationType\" /&gt;\n        &lt;mapping class=\"org.mainco.subco.organization.domain.Organization\" /&gt;\n\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n"},{"tags":["spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13259377,"title":"Error in my spring-hibernate application","body":"<p>I am new to Spring, i am trying to create a simple project with spring and Hibernate with annotations(without use of configuration and mapping XML's). I am held up with this below error since 3 days, to go with troubles from hurricane 'Sandy'.</p>\n\n<p><strong>Here is the error i see..</strong></p>\n\n<pre><code>`ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/Spring]] (MSC service thread 1-2) StandardWrapper.Throwable: java.lang.NoClassDefFoundError: Lorg/hibernate/cache/CacheProvider;\nat java.lang.Class.getDeclaredFields0(Native Method) [rt.jar:1.6.0_25]\nat java.lang.Class.privateGetDeclaredFields(Class.java:2291) [rt.jar:1.6.0_25]\nat java.lang.Class.getDeclaredFields(Class.java:1743) [rt.jar:1.6.0_25]\nat org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.findPersistenceMetadata(PersistenceAnnotationBeanPostProcessor.java:373) [org.springframework.orm-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.postProcessMergedBeanDefinition(PersistenceAnnotationBeanPostProcessor.java:321) [org.springframework.orm-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyMergedBeanDefinitionPostProcessors(AbstractAutowireCapableBeanFactory.java:830) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:493) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:591) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) [org.springframework.context-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469) [org.springframework.context-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat javax.servlet.GenericServlet.init(GenericServlet.java:242) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]\nat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1202) [jbossweb-7.0.13.Final.jar:]\nat org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1102) [jbossweb-7.0.13.Final.jar:]\nat org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3655) [jbossweb-7.0.13.Final.jar:]\nat org.apache.catalina.core.StandardContext.start(StandardContext.java:3873) [jbossweb-7.0.13.Final.jar:]\nat org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]\nat org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)\nat org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_25]\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_25]\nat java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_25]\nCaused by: java.lang.ClassNotFoundException: org.hibernate.cache.CacheProvider from [Module \"deployment.Spring.war:main\" from Service Module Loader]\nat org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)\nat org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)\n... 32 more\n\n16:42:59,393 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/Spring]] (MSC service thread 1-2) Servlet /Spring threw load() exception: java.lang.ClassNotFoundException: org.hibernate.cache.CacheProvider from [Module \"deployment.Spring.war:main\" from Service Module Loader]\nat org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)\nat org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)\nat org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)\nat java.lang.Class.getDeclaredFields0(Native Method) [rt.jar:1.6.0_25]\nat java.lang.Class.privateGetDeclaredFields(Class.java:2291) [rt.jar:1.6.0_25]\nat java.lang.Class.getDeclaredFields(Class.java:1743) [rt.jar:1.6.0_25]\nat org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.findPersistenceMetadata(PersistenceAnnotationBeanPostProcessor.java:373) [org.springframework.orm-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor.postProcessMergedBeanDefinition(PersistenceAnnotationBeanPostProcessor.java:321) [org.springframework.orm-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyMergedBeanDefinitionPostProcessors(AbstractAutowireCapableBeanFactory.java:830) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:493) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:591) [org.springframework.beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) [org.springframework.context-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469) [org.springframework.context-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133) [org.springframework.web.servlet-3.1.2.RELEASE.jar:3.1.2.RELEASE]\nat javax.servlet.GenericServlet.init(GenericServlet.java:242) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]\nat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1202) [jbossweb-7.0.13.Final.jar:]\nat org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1102) [jbossweb-7.0.13.Final.jar:]\nat org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3655) [jbossweb-7.0.13.Final.jar:]\nat org.apache.catalina.core.StandardContext.start(StandardContext.java:3873) [jbossweb-7.0.13.Final.jar:]\nat org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]\nat org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)\nat org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_25]\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_25]\nat java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_25]`\n</code></pre>\n\n<p><strong>Here is the code</strong></p>\n\n<pre><code>[ Spring-servlet.xml]\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans ...\n\n&lt;context:property-placeholder location=\"classpath:jdbc.properties\" /&gt;\n\n&lt;bean id=\"jspViewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n    &lt;property name=\"viewClass\" value=\"org.springframework.web.servlet.view.JstlView\" /&gt;\n    &lt;property name=\"prefix\" value=\"/WEB-INF/jsp/\" /&gt;\n    &lt;property name=\"suffix\" value=\".jsp\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${database.driver}\" /&gt;\n    &lt;property name=\"url\" value=\"${database.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${database.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${database.password}\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"annotatedClasses\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;com.spring.form.Items&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.show_sql\"&gt;${hibernate.show_sql}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.connection.pool_size\"&gt;${hibernate.connection.pool_size}&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n\n&lt;context:component-scan base-package=\"com.spring\" /&gt;\n\n&lt;tx:annotation-driven /&gt;\n\n\n&lt;/beans&gt;\n\nController\n\n\nimport java.util.HashMap;\nimport java.util.Map;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.validation.BindingResult;\nimport org.springframework.web.bind.annotation.ModelAttribute;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport com.spring.form.Items;\nimport com.spring.service.ReceiptsService;\nimport org.springframework.web.bind.annotation.RequestMethod;\nimport org.springframework.web.servlet.ModelAndView;\n\n@Controller\n@RequestMapping(\"/receiptsnew\")\npublic class ReceiptsSpringController {\n\n@Autowired\nprivate ReceiptsService receiptsService;\n\npublic ReceiptsSpringController()\n{\n\n}\n\n@RequestMapping(value=\"/save\", method=RequestMethod.POST)\npublic ModelAndView saveItems(@ModelAttribute(\"item\")Items item, BindingResult result)\n{\n    receiptsService.addItem(item);\n\n    return new ModelAndView(\"redirect:/receiptsnew.html\");\n\n}\n\n@RequestMapping(method=RequestMethod.GET)\npublic ModelAndView viewItems()\n{\n    Map model= new HashMap();\n    model.put(\"items\", receiptsService.getAllItems());\n    //items is just a key values\n\n    return new ModelAndView(\"itemsView\",model);\n}\n\n@RequestMapping(value=\"/add\", method=RequestMethod.GET)\npublic ModelAndView addItems(@ModelAttribute(\"item\")Items item, BindingResult result) \n{\n    return new ModelAndView(\"itemAdd\"); \n}\n}\n\nDAO\n\n\n\nimport java.util.List;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Repository;\nimport org.hibernate.SessionFactory;\nimport com.spring.form.Items;\n@Repository(\"itemDao\")\npublic class HibernateItemDao implements ItemDao {\n\n@Autowired\nprivate SessionFactory sessionFactory;\n\n\npublic void saveItem(Items item) {\n    // TODO Auto-generated method stub\n    sessionFactory.getCurrentSession().saveOrUpdate(item);\n}\n\n@SuppressWarnings(\"unchecked\")\npublic List&lt;Items&gt; getAllItems() {\n    // TODO Auto-generated method stub\n    return sessionFactory.getCurrentSession().createCriteria(Items.class).list();\n}\n\n}\n\n\n\n\nService layer  \n\n\nimport java.util.List;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Propagation;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport com.spring.dao.ItemDao;\nimport com.spring.form.Items;\n\n\n\n@Service(\"receiptsService\")\n@Transactional(propagation=Propagation.SUPPORTS, readOnly=true)\npublic class ReceiptsServiceImpl implements ReceiptsService {\n\n@Autowired\nprivate ItemDao itemDao;\n\npublic ReceiptsServiceImpl()\n{\n}\n\n\n@Transactional(propagation=Propagation.REQUIRED,readOnly=false)\npublic void addItem(Items item) {\n    // TODO Auto-generated method stub\n    itemDao.saveItem(item);\n}\n\npublic List&lt;Items&gt; getAllItems() {\n    // TODO Auto-generated method stub\n    return itemDao.getAllItems();\n}\n\n}\n\nForm data\n\n\n@Entity\n@Table(name=\"INVP200B\") \npublic class Items {\n\n@Id\n@Column(name=\"ITEMB\")\nprivate String itemno;\n\n@Column(name=\"QUARTB\")\nprivate String quantity;\n\n@Column(name=\"QTYPLB\")\nprivate String pallet;\n\npublic Items()\n{\n\n}\n\npublic String getItemno() {\n    return itemno;\n}\n\npublic void setItemno(String itemno) {\n    this.itemno = itemno;\n}\n\npublic String getQuantity() {\n    return quantity;\n}\n\npublic void setQuantity(String quantity) {\n    this.quantity = quantity;\n}\n\npublic String getPallet() {\n    return pallet;\n}\n\npublic void setPallet(String pallet) {\n    this.pallet = pallet;\n}\n\npublic String toString()\n{\n    return \" ITEM NO IS \"+itemno+\" QUANTITY IS\"+quantity+\" PALLET QUANTITY IS \"+pallet ;\n}\n}\n\nproperties\ndatabase.driver=oracle.jdbc.driver.OracleDriver\nhibernate.dialect=org.hibernate.dialect.Oracle10gDialect\nhibernate.show_sql=true\nhibernate.connection.pool_size=10\ndatabase.url=jdbc\\:oracle\\:thin\\:@app11.corebusiness.com\\:2521\\:oracle1\ndatabase.username=Alleg\ndatabase.password=Alleg\n</code></pre>\n\n<p>The following is the list of jars: <a href=\"http://i.stack.imgur.com/18rKU.png\" rel=\"nofollow\">http://i.stack.imgur.com/18rKU.png</a></p>\n\n<p>I used to get \"error-creating-bean-sessionfactory -nested exception\" until i changed the order of my bean declarations in the spring-servlet code.</p>\n"},{"tags":["java","hibernate","session","tomcat","struts2"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":13247702,"title":"code works fine on localhost but not on remote server","body":"<p>i have experience in android, but not familiar with hibernate and advance java. But i have to fix this issue.Please suggest.  </p>\n\n<p>the problem is that,\nBelow code works fine on my tomcat local host server.\nbut shows the errors on remote server.\nwhen i login it says \"invalid login\" try the same two or three times it login with the same id password.</p>\n\n<pre><code>public String Login() {\n        boolean isValidUser = applicationManager.isValidUser(getUserName(), getUserPassword());\n\n        if (isValidUser == false) {\n            if (getLang()!=null &amp;&amp; getLang().equals(\"de\")) {\n                setLang(\"de\");\n                addActionMessage(\"Ungültige Anmeldung\");\n            } else {\n                setLang(\"en\");\n                addActionMessage(\"Invalid login\");\n            }\n            return ERROR;\n        } else { \n            session = ActionContext.getContext().getSession();\n            session.put(\"loggedIn\",\"true\");\n            session.put(\"userName\", getUserName());\n            session.put(\"userPassword\", getUserPassword());\n\n            try {\n\n                HttpSession session1;\n                session1 = ServletActionContext.getRequest().getSession();\n                session1.setAttribute(\"lang\", getLang());\n                session1.setAttribute(\"loggedIn\", \"true\");\n                session1.setAttribute(\"userName\", getUserName());\n                session1.setAttribute(\"userPassword\", getUserPassword());\n            } catch(Exception e) {\n                System.out.println(e);\n                e.printStackTrace();\n            }\n            this.countryList = applicationManager.getCountries();\n            return SUCCESS;\n        }\n    }\n</code></pre>\n\n<p>HibernateUtil.java :</p>\n\n<pre><code>public class HibernateUtil {\n\n    private static final SessionFactory sessionFactory = buildSessionFactory();\n\n    private static SessionFactory buildSessionFactory(){\n        try{\n            // create session factory from hibernate.cfg.xml\n            return new AnnotationConfiguration().configure().buildSessionFactory();\n        }catch(Throwable ex){\n            System.err.println(\"Initial SessionFactory creation failed.\" + ex);\n            throw new ExceptionInInitializerError(ex);\n        }\n    }\n\n    public static SessionFactory getSessionFactory(){\n        return sessionFactory;\n    }\n}\n</code></pre>\n\n<p>UserManager.java :</p>\n\n<pre><code>public class UserManager extends HibernateUtil{\n\n    public ArrayList&lt;User&gt; validateUser(String userName,String userPassword){\n        Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n        session.beginTransaction();\n        ArrayList&lt;User&gt; userList =  new ArrayList&lt;User&gt;();\n        try{\n            Query query = session.createQuery(\"from User where userName=:userName and userPassword=:userPassword\");\n            query.setString(\"userName\", userName);\n            query.setString(\"userPassword\", userPassword);\n            for(Iterator itr = query.iterate();itr.hasNext();){\n                User user = (User) itr.next();\n                userList.add(user);\n            }\n            return userList;\n        }catch(HibernateException he){\n            he.printStackTrace();\n            session.getTransaction().rollback();\n        }\n        session.getTransaction().commit();\n        return userList; \n    }\n}\n</code></pre>\n\n<p>Hiberanate.cfg.xml looks like this :</p>\n\n<blockquote>\n  <p> </p>\n\n<pre><code>    &lt;hibernate-configuration&gt;\n      &lt;session-factory&gt;\n          &lt;property name=\"connection.driver_class\"&gt;\n              com.mysql.jdbc.Driver\n          &lt;/property&gt;\n\n          &lt;property name=\"connection.url\"&gt;\n              jdbc:mysql://xxxxx/xxxxx\n          &lt;/property&gt;\n\n          &lt;property name=\"connection.username\"&gt;samir&lt;/property&gt;\n          &lt;property name=\"connection.password\"&gt;samir&lt;/property&gt;\n          &lt;property name=\"c3p0.acquire_increment\"&gt;1&lt;/property&gt; \n          &lt;property name=\"c3p0.idle_test_period\"&gt;100&lt;/property&gt; &lt;!-- seconds --&gt; \n          &lt;property name=\"c3p0.max_size\"&gt;100&lt;/property&gt; \n          &lt;property name=\"c3p0.max_statements\"&gt;0&lt;/property&gt; \n          &lt;property name=\"c3p0.min_size\"&gt;10&lt;/property&gt; \n          &lt;property name=\"c3p0.timeout\"&gt;100&lt;/property&gt; &lt;!-- seconds --&gt;               \n          &lt;property name=\"dialect\"&gt;\n              org.hibernate.dialect.MySQLDialect\n          &lt;/property&gt;\n          &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n          &lt;property name=\"cache.provider_class\"&gt;\n              org.hibernate.cache.NoCacheProvider\n          &lt;/property&gt;\n          &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n          &lt;property name=\"hibernate.use_sql_comments\"&gt;true&lt;/property&gt;\n\n          &lt;property name=\"hbm2ddl.auto\"&gt;update&lt;/property&gt;\n\n\n          &lt;mapping class=\"login.model.User\" /&gt;\n\n      &lt;/session-factory&gt;\n    &lt;/hibernate-configuration&gt;\n</code></pre>\n</blockquote>\n\n<p>log :</p>\n\n<pre><code>  Hibernate: /* from User where userName=:userName and userPassword=:userPassword */ select user0_.USER_ID as col_0_0_ from users user0_ where user0_.USER_NAME=? and user0_.USER_PASSWORD=?\norg.hibernate.exception.JDBCConnectionException: could not execute query using iterate\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:97)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java:450)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.iterate(QueryTranslatorImpl.java:403)\n    at org.hibernate.engine.query.HQLQueryPlan.performIterate(HQLQueryPlan.java:248)\n    at org.hibernate.impl.SessionImpl.iterate(SessionImpl.java:1219)\n    at org.hibernate.impl.QueryImpl.iterate(QueryImpl.java:69)\n    at application.controller.ApplicationManager.isValidUser(ApplicationManager.java:177)\n    at application.view.ApplicationAction.Login(ApplicationAction.java:95)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:440)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:279)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:242)\n    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:163)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:249)\n    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:148)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:93)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:128)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.ProfilingActivationInterceptor.intercept(ProfilingActivationInterceptor.java:104)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:148)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:128)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:468)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:567)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)\n    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: No operations allowed after connection closed.Connection was implicitly closed due to underlying exception/error:\n\n\n** BEGIN NESTED EXCEPTION ** \n\ncom.mysql.jdbc.exceptions.jdbc4.CommunicationsException\nMESSAGE: Communications link failure\n\nLast packet sent to the server was 47 ms ago.\n\nSTACKTRACE:\n\ncom.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nLast packet sent to the server was 47 ms ago.\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n    at java.lang.reflect.Constructor.newInstance(Unknown Source)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)\n    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1074)\n    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2873)\n    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2763)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3299)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1837)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1961)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2543)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1737)\n    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1888)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1808)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:697)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\n    at org.hibernate.loader.Loader.doList(Loader.java:2228)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2125)\n    at org.hibernate.loader.Loader.list(Loader.java:2120)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:401)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:361)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1148)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)\n    at application.controller.ApplicationManager.getCountries(ApplicationManager.java:34)\n    at application.view.ApplicationAction.execute(ApplicationAction.java:90)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:440)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:279)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:242)\n    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:163)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:249)\n    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:148)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:93)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:128)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.ProfilingActivationInterceptor.intercept(ProfilingActivationInterceptor.java:104)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:148)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:128)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:236)\n    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:468)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:567)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)\n    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.\n    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:2332)\n    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2774)\n    ... 86 more\n\n\n** END NESTED EXCEPTION **\n\n\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n    at java.lang.reflect.Constructor.newInstance(Unknown Source)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)\n    at com.mysql.jdbc.Util.getInstance(Util.java:381)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:985)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:957)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:927)\n    at com.mysql.jdbc.ConnectionImpl.checkClosed(ConnectionImpl.java:1113)\n    at com.mysql.jdbc.ConnectionImpl.prepareStatement(ConnectionImpl.java:4038)\n    at com.mysql.jdbc.ConnectionImpl.prepareStatement(ConnectionImpl.java:4004)\n    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:534)\n    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:452)\n    at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)\n    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)\n    at org.hibernate.loader.hql.QueryLoader.iterate(QueryLoader.java:422)\n    ... 71 more\norg.hibernate.exception.JDBCConnectionException: could not execute query using iterate\n</code></pre>\n"},{"tags":["hibernate","gwt","tomcat","jetty"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13145026,"title":"NoClassDefFoundError: org/hibernate/cfg/Configuration","body":"<p>I am using Hibernate to implement a remote procedure call in my Google Web Toolkit project.  When I run it from Eclipse as a Google \"Web Application\", I get a NoClassDefFoundError exception when the service is called (when I press a button on the web page):</p>\n\n<pre><code>Starting Jetty on port 8888\n   [WARN] Exception while dispatching incoming RPC call\ncom.google.gwt.user.server.rpc.UnexpectedException: Service method 'public abstract java.lang.String edu.mit.ll.irbenchmark.client.MetricDataTableService.getDataString(edu.mit.ll.irbenchmark.EvaluationMetric)' threw an unexpected exception: java.lang.NoClassDefFoundError: org/hibernate/cfg/Configuration\n    at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:385)\n    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:588)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)\n</code></pre>\n\n<p>But when I \"GWT Compile\" the project and copy the contents of directory \"war\" to tomcat6, it works perfectly!  </p>\n\n<p>The following jars are in my war/WEB-INF/lib directory:</p>\n\n<pre><code>antlr-3.4-complete.jar\ncommons-collections3-3.2.1.jar\ndom4j.jar\ngwt-servlet.jar\nhibernate-commons-annotations-3.2.0.Final.jar\nhibernate-core-3.6.9.Final.jar\nhibernate-jpa-2.0-api-1.0.1.Final.jar\nIRBenchmarker.jar\njavassist-3.12.0.GA.jar\njta-1.1.jar\nlog4j-1.2-1.2.16.jar\nmysql-connector-java-5.1.16.jar\nslf4j-api-1.6.4.jar\nslf4j-log4j12-1.6.4.jar\n</code></pre>\n"},{"tags":["hibernate","grails","groovy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13257923,"title":"Preventing stale state errors in Grails","body":"<p>I've got an issue with a method that's accessed concurrently by a bunch of threads. The scenario is that Thread A iterates through a list, creates and saves a domain object. Thread B  calls the same method while Thread A is still iterating, tries to access the domain object that Thread A created, and a StaleStateException is thrown.</p>\n\n<p>To illustrate:</p>\n\n<pre><code>def populateStudents(listOfStudents) {\n\n   listOfStudents.each { Student student -&gt;\n      def schoolName = student.schoolName\n      def school = School.findByName(schoolName) ?: new School(name: schoolName).save(flush:true)\n\n      student.addToSchools(school)\n\n      // So Thread A creates a new School domain object and continues to iterate.\n      // Thread B comes along and finds the domain created by Thread A.\n      // However, it appears that the StaleStateException is thrown when Thread B tries to addToSchools\n\n   }\n\n}\n</code></pre>\n\n<p>Here is the stack:</p>\n\n<p>org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [com.app.School#60]\n    at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1792)\n    at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2435)\n    at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2335)\n    at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2635)\n    at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:115)\n    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:168)\n    at org.codehaus.groovy.grails.orm.hibernate.events.PatchedDefaultFlushEventListener.performExecutions(PatchedDefaultFlushEventListener.java:46)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)\n    at org.springframework.orm.hibernate3.HibernateTemplate$28.doInHibernate(HibernateTemplate.java:883)\n    at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:406)\n    at org.springframework.orm.hibernate3.HibernateTemplate.executeWithNativeSession(HibernateTemplate.java:374)\n    at org.springframework.orm.hibernate3.HibernateTemplate.flush(HibernateTemplate.java:881)\n    at org.codehaus.groovy.grails.orm.hibernate.metaclass.MergePersistentMethod$1.doInHibernate(MergePersistentMethod.java:60)\n    at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:406)\n    at org.springframework.orm.hibernate3.HibernateTemplate.execute(HibernateTemplate.java:339)\n    at org.codehaus.groovy.grails.orm.hibernate.metaclass.MergePersistentMethod.performSave(MergePersistentMethod.java:54)\n    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractSavePersistentMethod.doInvokeInternal(AbstractSavePersistentMethod.java:179)\n    at org.codehaus.groovy.grails.orm.hibernate.metaclass.AbstractDynamicPersistentMethod.invoke(AbstractDynamicPersistentMethod.java:59)\n    at sun.reflect.GeneratedMethodAccessor23965.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:616)\n    at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoCachedMethodSite.invoke(PojoMetaMethodSite.java:188)\n    at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\n    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:132)\n    at org.codehaus.groovy.grails.plugins.orm.hibernate.HibernatePluginSupport$_addBasicPersistenceMethods_closure73.doCall(HibernatePluginSupport.groovy:814)\n    at sun.reflect.GeneratedMethodAccessor845.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:616)\n    at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n    at org.codehaus.groovy.runtime.metaclass.ClosureMetaMethod.invoke(ClosureMetaMethod.java:80)\n    at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoMetaMethodSiteNoUnwrapNoCoerce.invoke(PogoMetaMethodSite.java:307)\n    at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.call(PogoMetaMethodSite.java:63)\n    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:124)\n    at com.app.TransactionService$_populateStudents_closure3.doCall(TransactionService.groovy:96)\n    at sun.reflect.GeneratedMethodAccessor24059.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:616)\n    at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n    at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1058)\n    at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1070)\n    at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:886)\n    at groovy.lang.Closure.call(Closure.java:282)\n    at org.codehaus.groovy.runtime.DefaultGroovyMethods.eachWithIndex(DefaultGroovyMethods.java:1213)\n    at org.codehaus.groovy.runtime.dgm$150.invoke(Unknown Source)\n    at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:270)\n    at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:52)\n    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:124)\n    at com.app.TransactionService.populateStudents(TransactionService.groovy:49)\n    at com.app.TransactionService$$FastClassByCGLIB$$1b289e99.invoke()\n    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)\n    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:688)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:621)\n    at com.app.TransactionService$$EnhancerByCGLIB$$8986440c.populateStudents()</p>\n\n<p>INFO UpdateController - Object of class [com.app.School] with identifier [60]: optimistic locking failed; nested exception is org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [com.app.School#60]</p>\n\n<p>Any ideas</p>\n"},{"tags":["java","mysql","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13256569,"title":"Hibernate issue: @OneToMany annotation returns duplicates","body":"<p>I am facing a problem with Hibernate (4.3.0) where as unidirectional @OneToMany returns duplicates.</p>\n\n<p>My database structure (MySQL with InnoDB) where as 'entry' table has a 1:N relationship with 'entry_address' table. The 'entry' table is the main table and 'entry_address' is a sub-table of 'entry' table.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE IF NOT EXISTS `entry` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `name` varchar(500) NOT NULL,\n  `active` int(1) NOT NULL DEFAULT '0',\n  `modifiedTS` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,\n  `createdTS` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;\n\nINSERT INTO `entry` (`id`, `name`, `active`, `modifiedTS`, `createdTS`) VALUES\n(1, 'Test1', 0, '2012-11-05 13:41:03', '2012-11-01 10:11:22'),\n(2, 'Test2', 1, '2012-11-05 11:19:37', '2012-11-01 10:11:33'),\n(3, 'Test3', 1, '2012-11-05 11:19:37', '2012-11-01 10:11:44');\n\nCREATE TABLE IF NOT EXISTS `entry_address` (\n  `id` int(10) unsigned NOT NULL,\n  `precedence` int(1) NOT NULL DEFAULT '0',\n  `line` varchar(255) DEFAULT NULL,\n  `line2` varchar(255) DEFAULT NULL,\n  `street` varchar(255) DEFAULT NULL,\n  `street2` varchar(255) DEFAULT NULL,\n  `zip` int(5) DEFAULT NULL,\n  `city` varchar(255) DEFAULT NULL,\n  `country` varchar(255) DEFAULT NULL,\n  UNIQUE KEY `entry_address_uq` (`id`,`precedence`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\nINSERT INTO `entry_address` (`id`, `precedence`, `line`, `line2`, `street`, `street2`, `zip`, `city`, `country`) VALUES\n(1, 0, 'Line4.1', 'Line4.2', 'Street4.1', 'Street4.2', 9488, 'Schellenberg', 'Liechtenstein'),\n(2, 10, 'Line1.1', 'Line1.2', 'Street1.1', 'Street1.2', 9492, 'Eschen', 'Liechtenstein'),\n(2, 20, 'Line2.1', 'Line2.2', 'Street2.1', 'Street2.2', 9490, 'Vaduz', 'Liechtenstein'),\n(2, 30, 'Line3.1', 'Line3.2', 'Street3.1', 'Street3.2', 9494, 'Schaan', 'Liechtenstein'),\n(3, 10, 'Line5.1', 'Line5.2', 'Street5.1', 'Street5.2', 9492, 'Eschen', 'Liechtenstein'),\n(3, 20, 'Line6.1', 'Line6.2', 'Street6.1', 'Street6.2', 9492, 'Eschen', 'Liechtenstein');\n\nALTER TABLE `entry_address`\n  ADD CONSTRAINT `entry_address_fk` FOREIGN KEY (`id`) REFERENCES `entry` (`id`);\n</code></pre>\n\n<p>Here's the minimal code of \"entry\" entity.</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Collection;\nimport javax.persistence.*;\n\n@Entity\n@Table(name = \"entry\")\npublic class Entry {\n    @Id\n    @GeneratedValue\n    @Column(name = \"id\")\n    private Integer id;\n\n    @Column(name = \"name\")\n    private String name;\n\n    @OneToMany(fetch=FetchType.EAGER)\n    @JoinColumn(name = \"id\")\n    private Collection&lt;EntryAddress&gt; addresses;\n\n    @Override\n    public String toString() {\n        return String.format(\"Entry [id=%s, name=%s, addresses=%s]\", id, name, addresses);\n    }\n}\n</code></pre>\n\n<p>Here's the minimal code of \"entry_address\" entity:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>import javax.persistence.*;\n\n@Entity\n@Table(name = \"entry_address\")\npublic class EntryAddress {\n    @Id\n    @Column(name = \"id\")\n    private Integer id;\n\n    @Column(name = \"line\")\n    private String line;\n\n    @Override\n    public String toString() {\n        return String.format(\"EntryAddress [line=%s]\", line);\n    }\n}\n</code></pre>\n\n<p>This is the query done by Hibernate (looks good!):\nHibernate: select this_.id as id0_1_, this_.name as name0_1_, addresses2_.id as id0_3_, addresses2_.id as id1_3_, addresses2_.id as id1_0_, addresses2_.line as line1_0_ from entry this_ left outer join entry_address addresses2_ on this_.id=addresses2_.id</p>\n\n<p><img src=\"http://i.stack.imgur.com/26wP3.jpg\" alt=\"MySQL Output\"></p>\n\n<p>But if I run JUnit using:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Collection;\n\nimport junit.framework.Assert;\nimport li.pitschmann.transaction.dao.EntryDao;\nimport li.pitschmann.transaction.entity.Entry;\n\nimport org.junit.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.AbstractTransactionalJUnit4SpringContextTests;\n\n@ContextConfiguration(locations={\"file:**/web-spring.xml\"})\npublic class EntryDaoTest extends AbstractTransactionalJUnit4SpringContextTests {\n    @Autowired\n    private EntryDao entryDao;\n\n    @Test\n    public void findAllEntries() {\n        Collection&lt;Entry&gt; entries = entryDao.findEntries();\n\n        Assert.assertNotNull(entries);\n\n        for (Entry e : entries) {\n            System.out.println(\"++: \" + e);\n        }\n        // Assert.assertEquals(3, entries.size());\n\n    }\n}\n</code></pre>\n\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Collection;\n\nimport org.hibernate.SessionFactory;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport li.pitschmann.transaction.dao.EntryDao;\nimport li.pitschmann.transaction.entity.Entry;\n\npublic class EntryDaoImpl implements EntryDao {\n    private SessionFactory sessionFactory;\n\n    /**\n     * {@inheritDoc}\n     */\n    @SuppressWarnings(\"unchecked\")\n    @Transactional\n    public Collection&lt;Entry&gt; findEntries() {\n        return sessionFactory.getCurrentSession().createCriteria(Entry.class).list();\n    }\n\n    public void setSessionFactory(SessionFactory sessionFactory) {\n        this.sessionFactory = sessionFactory;\n    }\n}\n</code></pre>\n\n<p>Spring XML (most important part, Spring 3.1.2.RELEASE):</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;tx:annotation-driven transaction-manager=\"transactionManager\" /&gt;\n&lt;context:annotation-config /&gt;\n&lt;!-- MySQL DataSource --&gt;\n&lt;bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\"&gt;\n    &lt;property name=\"driverClass\" value=\"com.mysql.jdbc.Driver\" /&gt;\n    &lt;property name=\"jdbcUrl\" value=\"jdbc:mysql://localhost:3306/entry_db\" /&gt;\n    &lt;property name=\"user\" value=\"root\" /&gt;\n    &lt;property name=\"password\" value=\"\" /&gt;\n&lt;/bean&gt;\n&lt;!-- Session Factory --&gt;\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"packagesToScan\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;li.pitschmann.transaction.entity&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQL5InnoDBDialect&lt;/prop&gt;\n            &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n&lt;!-- Transaction Manager --&gt;\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>The console log is:</p>\n\n<pre><code>++: Entry [id=1, name=Test1, addresses=[EntryAddress [line=Line4.1]]]\n++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]\n++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]\n++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]\n++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line5.1]]]\n++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line5.1]]]\n</code></pre>\n\n<p>I also tried to use @OneToMany(fetch=FetchType.LAZY) instead of FetchType.EAGER - same issue with duplicate addresses.</p>\n\n<pre><code>++: Entry [id=1, name=Test1, addresses=[EntryAddress [line=Line4.1]]]\n++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]\n++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line5.1]]]\n</code></pre>\n\n<p><strong>Expectation</strong></p>\n\n<p>This is my expecation (3 entry objects with different addresses):</p>\n\n<pre><code>++: Entry [id=1, name=Test1, addresses=[EntryAddress [line=Line4.1]]]\n++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line2.1], EntryAddress [line=Line3.1]]]\n++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line6.1]]]\n</code></pre>\n\n<p>Is there a bug in Hibernate or am I doing something wrong? Hope someone can help me to find the root cause?! Thank you :-)</p>\n"},{"tags":["java","database","hibernate","java-ee","struts2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":27,"score":-2,"question_id":13257445,"title":"How should I manage a hibernate session in struts 2 web application","body":"<p>I am working on a web application but I am confuse how I should manage hibernate session object in struts 2 application.\nthere are two ways to use session\n1- using session factory\n2 using thread local</p>\n"},{"tags":["hibernate","hibernate-criteria"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13256137,"title":"Hibernate Criterion for where condition my_table.a = my_table.b + 1","body":"<p>I need to create an Hibernate Criteria to make a query like the following.</p>\n\n<pre><code>select something\nfrom my_table\nwhere my_table.a = my_table.b + 1\n</code></pre>\n\n<p>How is it possible to make a Criterion for this kind of where condition?\nThank you</p>\n\n<p>Davide</p>\n"},{"tags":["java","hibernate","maven","hbm2ddl","hibernate3-maven-plugin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13255108,"title":"Why does hbm2ddl not like my @Temporal annotation on a GregorianCalendar?","body":"<p>Here is the background:  I have an annotated <code>@Embeddable</code> Java class that has a <code>GregorianCalendar</code> field.  I am attempting to use hibernate3:hbm2ddl to generate a schema via the hibernate3 Maven plugin so that I can persist another object into which this is embedded, but it runs into an error regarding the use of <code>@Temporal</code>.</p>\n\n<p>Here is the embeddable class:</p>\n\n<pre><code>@Embeddable\npublic class OperationalStatus implements Serializable {\n        .\n        .\n        .\n    /**\n     * Recorded date/time that the status value is valid\n     */\n    private GregorianCalendar time;\n\n    /**\n     * No-argument constructor.\n     */\n    public OperationalStatus() {}\n        .\n        .\n        .\n    /**\n     * @return the time\n     */\n    @Temporal(TemporalType.TIMESTAMP) \n    public GregorianCalendar getTime() {\n        return time;\n    }\n\n    /**\n     * @param time the time to set\n     */\n    public void setTime(GregorianCalendar time) {\n        this.time = time;\n    }\n}\n</code></pre>\n\n<p>And here is the error readout:</p>\n\n<blockquote>\n  <p>[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:2.2:hbm\n  2ddl (default-cli) on project STRIPES_V2: Execution default-cli of goal org.code\n  haus.mojo:hibernate3-maven-plugin:2.2:hbm2ddl failed: @Temporal should only be s\n  et on a java.util.Date or java.util.Calendar property: stripes.datamodel.\n  util.OperationalStatus.time</p>\n</blockquote>\n\n<p>Here are some excerpts from the pom:</p>\n\n<pre><code>&lt;plugin&gt;\n&lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n&lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n&lt;version&gt;2.2&lt;/version&gt;\n&lt;configuration&gt;\n    &lt;components&gt;\n        &lt;component&gt;\n            &lt;name&gt;hbm2ddl&lt;/name&gt;\n            &lt;implementation&gt;annotationconfiguration&lt;/implementation&gt;\n        &lt;/component&gt;\n    &lt;/components&gt;\n    &lt;componentProperties&gt;\n        &lt;drop&gt;false&lt;/drop&gt;\n        &lt;configurationfile&gt;src/main/resources/hibernate.cfg.xml&lt;/configurationfile&gt;\n        &lt;outputfilename&gt;schema.sql&lt;/outputfilename&gt;\n    &lt;/componentProperties&gt;\n&lt;/configuration&gt;\n&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;postgresql&lt;/groupId&gt;\n        &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n        &lt;version&gt;9.2-1000.jdbc4&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n&lt;/plugin&gt;\n.\n.\n.\n&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;version&gt;4.1.7.Final&lt;/version&gt;\n    &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>What am I missing?  GregorianCalendar is a concrete extension of Calendar, so what's wrong?</p>\n"},{"tags":["java","hibernate","many-to-many","one-to-many","hibernate-tools"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12919540,"title":"Hibernate Tools 4.0.0 Detect many-to-many tables NOT working with MySQL Db","body":"<p>I am using Hibernate Tools to reverse engineer from a MySQL 5.5.27 using STS 2.9.2 and Hibernate Tools 4.0.0.</p>\n\n<p>It generates the POJO classes correctly, but is <strong><em>NOT</em></strong> picking up on the foreign key relationships defined across the tables (i.e. no sets nor relationships created <strong><em>at all!</em></strong>).</p>\n\n<p>Any idea from your experience whether this tool works with MySQL or what I am doing wrong?</p>\n\n<p>Thanks,</p>\n\n<p>Bob</p>\n"},{"tags":["ajax","spring","hibernate","jsp","jackson"],"answer_count":2,"favorite_count":7,"up_vote_count":8,"down_vote_count":0,"view_count":1300,"score":8,"question_id":11856005,"title":"Returning a java.util.List from a Spring MVC controller via Ajax using Jackson","body":"<p>Based on <a href=\"http://stackoverflow.com/q/11777153/1391249\">my question</a> posted a few days ago, I realized that <a href=\"http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/servlet/mvc/SimpleFormController.html\" rel=\"nofollow\"><code>SimpleFormController</code></a> is inappropriate for handling Ajax requests. Therefore, I'm migrating my application towards annotated controllers.</p>\n\n<p>I'm trying to return a <code>java.util.List</code> from Oracle database using Spring MVC 3.0.2 with Hibernate via Ajax using <a href=\"http://jackson.codehaus.org/1.9.8/jackson-all-1.9.8.jar\" rel=\"nofollow\">Jackson 1.9.8</a> (its download <a href=\"http://wiki.fasterxml.com/JacksonDownload\" rel=\"nofollow\">page</a>) but I haven't yet worked with JSON in any technology. I have read up some tutorials/articles but I couldn't get the idea of how to return such complex data structures and parse them using JSON in Spring. I'm trying to learn JSON-like concepts first.</p>\n\n<p>What basically I'm trying is when a country is selected from a country select box, the states corresponding to that country should be populated from the database via Ajax. I don't have precise idea about how to return a <code>java.util.List</code> over an Ajax response, how to parse it and again use it in Java code. I'm only upto the following level.</p>\n\n<p>JS code.</p>\n\n<pre><code>function getStates(countryId)\n{\n    $.ajax({\n        datatype:\"json\",\n        type: \"POST\",\n        url: \"/wagafashion/ajax/TempAjax.htm\",\n        data: \"countryId=\" + countryId,\n\n        success: function(response)\n        {\n            $('#msg').html(response);\n            $('#stateList').val('');\n        },\n        error: function(e)\n        {\n            alert('Error: ' + e);\n        }\n    });\n}\n</code></pre>\n\n<p>The method in the Spring controller class which is invoked when the Ajax request is made on the <code>onchange</code> event of the country select box.</p>\n\n<pre><code>@RequestMapping(method=RequestMethod.POST, value=\"ajax/TempAjax\")\npublic @ResponseBody List&lt;StateTable&gt; getStateList(@ModelAttribute(\"tempBean\") TempBean tempBean, BindingResult error, Map model, HttpServletRequest request, HttpServletResponse response)\n{\n    Session session=NewHibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;StateTable&gt;list=session.createQuery(\"from StateTable where country.countryId=:countryId order by stateId\").setParameter(\"countryId\", new BigDecimal(request.getParameter(\"countryId\"))).list();\n\n    session.flush();\n    session.getTransaction().commit();\n    return list;\n}\n</code></pre>\n\n<p>The state select box I need to populate with the list of states returned by the Ajax response using a <code>&lt;c:forEach&gt;&lt;/c:forEach&gt;</code> loop of EL.</p>\n\n<pre><code>&lt;form:select path=\"cmbState\" class=\"validate[required] text-input tooltip\" title=\"Mandatory select field.\"&gt;\n    &lt;form:option value=\"\"&gt;Select&lt;/form:option&gt;\n        &lt;c:forEach items=\"${stateList}\" var=\"row\"&gt;\n            &lt;c:choose&gt;\n                &lt;c:when test=\"${row.stateId==param['stateId'] and deselectCombo!=1}\"&gt;\n                    &lt;form:option value=\"${row.stateId}\" selected=\"selected\"&gt;${row.stateName}&lt;/form:option&gt;\n                &lt;/c:when&gt;\n                &lt;c:otherwise&gt;\n                    &lt;form:option value=\"${row.stateId}\"&gt;${row.stateName}&lt;/form:option&gt;\n                &lt;/c:otherwise&gt;\n            &lt;/c:choose&gt;\n        &lt;/c:forEach&gt;\n    &lt;/form:select&gt;\n\n    &lt;font style=\"color: red\"&gt;&lt;form:errors path=\"stateId\"/&gt;&lt;/font&gt;&lt;br/&gt;\n</code></pre>\n\n<p>I could only make Ajax request and response successfully. Nothing more I could understand from those tutorials found over the internet. More precisely, how can I use the Ajax response in the <code>items</code> attribute of the preceding <code>&lt;c:forEach&gt;&lt;c:forEach&gt;</code> loop such as <code>items=\"${stateList}\"</code>? </p>\n\n<p>Could you give me some hint/idea how can I return a list of data and use it in the preceding loop to populate the state select box? Could you please lead me some steps ahead from here?</p>\n\n<p>I'm using NetBeans 6.9.1 (not Eclipse). In some tutorials about Marvan projects in Eclipse, it was mentioned that the <code>pom.xml</code> file is required to configure to include <code>&lt;dependencies&gt;&lt;/dependencies&gt;</code> (Jackson dependency). There is no such thing like <code>pom.xml</code> in my project in NetBeans. Is it required to configure somewhere in some xml file in NetBeans such as the one mentioned <a href=\"http://www.mkyong.com/spring-mvc/spring-3-mvc-and-json-example/\" rel=\"nofollow\">here</a>?</p>\n"},{"tags":["java","hibernate","jpa","mapping","persistence"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1006,"score":0,"question_id":6284213,"title":"Hibernate mapping with JPA-Annotations: Could not determine type","body":"<p>I recently started my first Java project that uses Hibernate (and JPA Annotations) for persistence.</p>\n\n<p>I've got the following classes:</p>\n\n<p><strong>User class</strong></p>\n\n<pre><code>*some imports*\n@Entity\npublic class Owner {\n        private int id;\n        private String name;\n        @OneToOne(fetch=FetchType.LAZY)\n        @JoinColumn(name=\"id\")\n        private Pet pet;\n\n        @Id\n        @GeneratedValue\n        public int getId() {\n            return id;\n        }\n        public void setId(int id) {\n            this.id = id;\n        }\n        public String getName() {\n            return name;\n        }\n        public void setName(String name) {\n            this.name = name;\n        }\n\n        public void setPet(Pet pet) {\n            this.pet = pet;\n        }\n        public Pet getPet() {\n            return pet;\n        }\n    }\n</code></pre>\n\n<p><strong>Pet Class</strong></p>\n\n<pre><code>*some imports*\n@Entity \npublic class Pet {\n        private String name;\n        @Id\n        @GeneratedValue\n        private int id;\n\n        public void setId(int id) {\n            this.id = id;\n        }\n        public int getId() {\n            return id;\n        }\n        public String getName() {\n            return name;\n        }\n        public void setName(String name) {\n            this.name = name;\n        }\n    }\n</code></pre>\n\n<p>Whenever I try to save an object, Hibernate gives me the following error output.</p>\n\n<pre><code>Exception in thread \"main\" org.hibernate.MappingException: Could not determine type for: Pet, at table: Owner, for columns: [org.hibernate.mapping.Column(pet)]\nat org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:306)\nat org.hibernate.mapping.Column.getSqlTypeCode(Column.java:164)\n</code></pre>\n\n<p>What am I missing? I can't figure out how to do this PF-FK mapping.</p>\n\n<p>Do I need to tell Hibernate which table Pet maps into or is it smart enough to do that? Could someone please suggest how I can change my declaration of the Pet ivar so that Hibernate and I can be happy? :)</p>\n\n<p>Thanks!</p>\n"},{"tags":["database","spring","hibernate","spring-mvc","spring-security"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13254715,"title":"Authentication using Spring 3 and Hibernate 3 (annotation based)","body":"<p>My application is based on Spring 3, Hibernate 3, MySQL. I read the Spring Security document and learnt that I can implement Authentication as given below,</p>\n\n<pre><code>&lt;authentication-manager&gt;\n   &lt;authentication-provider&gt;\n    &lt;jdbc-user-service data-source-ref=\"dataSource\"\n\n       users-by-username-query=\"\n          select username,password, enabled \n          from users where username=?\" \n\n       authorities-by-username-query=\"\n          select u.username, ur.authority from users u, user_roles ur \n          where u.user_id = ur.user_id and u.username =?  \" \n\n    /&gt;\n   &lt;/authentication-provider&gt;\n&lt;/authentication-manager&gt;\n</code></pre>\n\n<p>I understood above part but my concern is, in my application user table doesn't only store the userName, password and enabled field. It also stores first and last name, emailID, phone etc. On successful authentication, I want next jsp to populate all user details automatically and not ask user the same information which it will ask to non-regirstered user.</p>\n\n<ol>\n<li>I want to use annotation based configuration and not xml based (unlike\nmentioned in spring 2.5 examples)</li>\n<li>spring document doesnt use hibernate for security. Should i use\nhibernate or jdbc-user-service? if hibernate then how?</li>\n<li>I saw couple of examples use customized UserService. Is that I need\nto do as well?</li>\n</ol>\n\n<p>Can someone kindly advice with good examples? any references to other posts will help too.</p>\n"},{"tags":["spring","hibernate","spring-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":13078798,"title":"\"No Session found for current thread\" with Spring3+Hibernate4 using JTA TransactionManager","body":"<p>I am trying to do a migration from </p>\n\n<p>spring 1.2.9 with hibernate 3.2.0.ga </p>\n\n<p>to </p>\n\n<p>spring 3.1.1.RELEASE with hibernate 4.0.1.Final</p>\n\n<p>Most of the <strong>bean wiring are done with xml</strong> instead of annotation.  I have done the necessary changes as well as unit testing for dao, service and controller objects before deployment to ensure the compatibility of the existing spring configuration.</p>\n\n<p>When I deploy to JBoss AS 7.1.1.Final, I get \"No Session found for current thread\".  I have been looking for answer through this forum and spring and hibernate documentation, and I still not able to find a solution that is applicable to my problem.</p>\n\n<p>Here is the hibernate exception logs</p>\n\n<pre><code>&gt; 06:18:25,703 ERROR [com.test.customer.dao.InvoicingInfoDAOImpl] (http--12\n7.0.0.1-8080-1) selectBillingInfoIdById:Runtime error.: org.hibernate.HibernateE\nxception: **No Session found for current thread**\n        at org.springframework.orm.hibernate4.SpringSessionContext.currentSessio\nn(SpringSessionContext.java:97) [spring-orm-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFa\nctoryImpl.java:883) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]\n        at com.test.customer.dao.InvoicingInfoDAOImpl.selectBillingInfoBy\nId(InvoicingInfoDAOImpl.java:58) [classes:]\n        at com.test.customer.services.CustomerServiceImpl.getBillingInfo(\nCustomerServiceImpl.java:535) [classes:]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1\n.6.0_25]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.\njava:39) [rt.jar:1.6.0_25]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\nsorImpl.java:25) [rt.jar:1.6.0_25]\n        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_25]\n        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflecti\non(AopUtils.java:318) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJo\ninpoint(ReflectiveMethodInvocation.java:183) [spring-aop-3.1.1.RELEASE.jar:3.1.1\n.RELEASE]\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(\nReflectiveMethodInvocation.java:150) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE\n]\n        at org.springframework.transaction.interceptor.TransactionInterceptor.in\nvoke(TransactionInterceptor.java:110) [spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE\n]\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(\nReflectiveMethodInvocation.java:172) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE\n]\n        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynami\ncAopProxy.java:202) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at $Proxy22.getBillingInfo(Unknown Source)      at com.test.custo\nmer.CustomerController.getBillingInfo(CustomerController.java:205) [classes:]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1\n.6.0_25]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.\njava:39) [rt.jar:1.6.0_25]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces\nsorImpl.java:25) [rt.jar:1.6.0_25]\n        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_25]\n        at org.springframework.web.method.support.InvocableHandlerMethod.invoke(\nInvocableHandlerMethod.java:213) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.method.support.InvocableHandlerMethod.invokeF\norRequest(InvocableHandlerMethod.java:126) [spring-web-3.1.1.RELEASE.jar:3.1.1.R\nELEASE]\n        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocabl\neHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96) [spring-we\nbmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingH\nandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617) [spring\n-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingH\nandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578) [spring-webm\nvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapt\ner.handle(AbstractHandlerMethodAdapter.java:80) [spring-webmvc-3.1.1.RELEASE.jar\n:3.1.1.RELEASE]\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(Dispatch\nerServlet.java:923) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.servlet.DispatcherServlet.doService(Dispatche\nrServlet.java:852) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(Frame\nworkServlet.java:882) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServ\nlet.java:789) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:754) [jboss-s\nervlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-s\nervlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl\nicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF\nilterChain.java:248) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV\nalve.java:275) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV\nalve.java:161) [jbossweb-7.0.13.Final.jar:]\n        at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(Secu\nrityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]\n</code></pre>\n\n<p>Here is the spring configuration for session factory and transaction manager (it is using jta here)</p>\n\n<pre><code>&gt; &lt;!-- Configuration of Hibernate SessionFactory --&gt;\n    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\"&gt;\n            &lt;ref bean=\"csvliteDataSource\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;ref bean=\"csvliteHibernateProperties\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"mappingResources\"&gt;\n            &lt;list&gt;\n                &lt;!-- Customer Domain Mapping --&gt;\n                &lt;value&gt;com/test/customer/domain/InvoicingInfo.hbm.xml&lt;/value&gt;\n                &lt;value&gt;com/test/customer/domain/PickupAddress.hbm.xml&lt;/value&gt;\n            &lt;/list&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configurationof Hibernate Configuration Properties --&gt;\n    &lt;bean id=\"csvliteHibernateProperties\" class=\"java.util.Properties\"&gt;\n        &lt;constructor-arg&gt;\n            &lt;props&gt;\n                &lt;!-- Hibernate Configuration Properties --&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServer2008Dialect&lt;/prop&gt;             \n                &lt;prop key=\"hibernate.current_session_context_class\"&gt;org.springframework.orm.hibernate4.SpringSessionContext&lt;/prop&gt;\n                &lt;!-- Hibernate Configuration Properties - enabled only if debugging --&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.use_sql_comments\"&gt;true&lt;/prop&gt;\n                &lt;!-- Hibernate Cache Properties --&gt;\n                &lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.OSCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"hibernate.cache.use_query_cache\"&gt;true&lt;/prop&gt;         \n            &lt;/props&gt;\n        &lt;/constructor-arg&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Data Source --&gt;\n    &lt;bean id=\"csvliteDataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n        &lt;property name=\"jndiName\"&gt;\n            &lt;value&gt;java:jboss/datasources/CSLiteDS&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Transaction Manager --&gt;\n    &lt;bean id=\"csvliteTxManager\"\n        class=\"org.springframework.transaction.jta.JtaTransactionManager\"&gt;\n        &lt;property name=\"transactionManagerName\"&gt;\n            &lt;value&gt;java:jboss/TransactionManager&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<p>Here is spring configuration for relevant dao and service objects (it uses TransactionProxyFactoryBean for each service object)</p>\n\n<pre><code>&lt;bean id=\"invoicingInfoDAO\"\n    class=\"com.test.customer.dao.InvoicingInfoDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"pickupAddressDAO\"\n    class=\"com.test.customer.dao.PickupAddressDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"customerService\"\n    class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\" ref=\"csvliteTxManager\"/&gt;\n    &lt;property name=\"target\" ref=\"customerServiceImpl\"/&gt;\n    &lt;property name=\"transactionAttributes\"&gt; \n        &lt;props&gt;     \n            &lt;prop key=\"getBillingInfo\"&gt;PROPAGATION_REQUIRES_NEW, -Throwable&lt;/prop&gt;                                              \n            &lt;prop key=\"addBillingInfo\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"updateBillingInfo\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"addPickupAddress\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"updatePickupAddress\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"getPickupAddress\"&gt;PROPAGATION_REQUIRES_NEW, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"unlockPickupAddress\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"lockPickupAddress\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"lockBillingInfo\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"unlockBillingInfo\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"closePickupAddress\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"processPurgePickupAddress\"&gt;PROPAGATION_REQUIRED, -Throwable&lt;/prop&gt;\n            &lt;prop key=\"getMultiplePickupAddress\"&gt;PROPAGATION_REQUIRES_NEW, -Throwable&lt;/prop&gt;           \n        &lt;/props&gt;\n    &lt;/property&gt;     \n&lt;/bean&gt; \n&lt;bean id=\"customerServiceImpl\" class=\"com.test.customer.services.CustomerServiceImpl\"&gt;\n    &lt;property name=\"invoicingInfoDAO\" ref=\"invoicingInfoDAO\"/&gt;  \n    &lt;property name=\"pickupAddressDAO\" ref=\"pickupAddressDAO\"/&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>What have really I missed out in my configuration?</p>\n\n<p>=========================</p>\n\n<p>[Update - 20121101]</p>\n\n<p>I took the suggestion from @adrian-shum, and cross reference with some information I found over the net.</p>\n\n<p>I did the following tests, but all of the test are not working except when i switch to HibernateTransaction instead of JTA transaction.</p>\n\n<h1>Test 1 - SUCCESS</h1>\n\n<p>(with HibernateTransactionManager)</p>\n\n<pre><code>&lt;!-- Configurationof Hibernate Configuration Properties --&gt;\n    &lt;bean id=\"csvliteHibernateProperties\" class=\"java.util.Properties\"&gt;\n        &lt;constructor-arg&gt;\n            &lt;props&gt;\n                &lt;!-- Hibernate Configuration Properties --&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServer2008Dialect&lt;/prop&gt;             \n                &lt;prop key=\"hibernate.current_session_context_class\"&gt;org.springframework.orm.hibernate4.SpringSessionContext&lt;/prop&gt;\n\n        &lt;!-- Hibernate Configuration Properties - enabled only if debugging --&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.use_sql_comments\"&gt;true&lt;/prop&gt;\n                &lt;!-- Hibernate Cache Properties --&gt;\n                &lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.OSCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"hibernate.cache.use_query_cache\"&gt;true&lt;/prop&gt;         \n            &lt;/props&gt;\n        &lt;/constructor-arg&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Data Source --&gt;\n    &lt;bean id=\"csvliteDataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n        &lt;property name=\"jndiName\"&gt;\n            &lt;value&gt;java:jboss/datasources/CSLiteDS&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Transaction Manager --&gt;\n    &lt;bean id=\"csvliteTxManager\"\n        class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n        &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<h1>TEST 2 - FAILED</h1>\n\n<p>(with JtaTransactionManager - hibernate.transaction.manager_lookup_class + hibernate.transaction.factory_class)</p>\n\n<pre><code>&lt;!-- Configurationof Hibernate Configuration Properties --&gt;\n    &lt;bean id=\"csvliteHibernateProperties\" class=\"java.util.Properties\"&gt;\n        &lt;constructor-arg&gt;\n            &lt;props&gt;\n                &lt;!-- Hibernate Configuration Properties --&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServer2008Dialect&lt;/prop&gt;             \n                &lt;prop key=\"hibernate.current_session_context_class\"&gt;org.springframework.orm.hibernate4.SpringSessionContext&lt;/prop&gt;\n                &lt;prop key=\"hibernate.transaction.factory_class\"&gt;org.hibernate.transaction.JtaTransactionFactory&lt;/prop&gt;\n                &lt;prop key=\"hibernate.transaction.manager_lookup_class\"&gt;org.hibernate.transaction.JBossTransactionManagerLookup&lt;/prop&gt;\n\n                &lt;!-- Hibernate Configuration Properties - enabled only if debugging --&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.use_sql_comments\"&gt;true&lt;/prop&gt;\n                &lt;!-- Hibernate Cache Properties --&gt;\n                &lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.OSCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"hibernate.cache.use_query_cache\"&gt;true&lt;/prop&gt;         \n            &lt;/props&gt;\n        &lt;/constructor-arg&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Data Source --&gt;\n    &lt;bean id=\"csvliteDataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n        &lt;property name=\"jndiName\"&gt;\n            &lt;value&gt;java:jboss/datasources/CSLiteDS&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Transaction Manager --&gt;   \n    &lt;bean id=\"csvliteTxManager\"\n        class=\"org.springframework.transaction.jta.JtaTransactionManager\"&gt;\n        &lt;property name=\"transactionManagerName\"&gt;\n            &lt;value&gt;java:jboss/TransactionManager&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<h1>TEST 3 - FAILED</h1>\n\n<p>(with JtaTransactionManager - hibernate.transaction.jta.platform property)</p>\n\n<pre><code>&lt;!-- Configurationof Hibernate Configuration Properties --&gt;\n    &lt;bean id=\"csvliteHibernateProperties\" class=\"java.util.Properties\"&gt;\n        &lt;constructor-arg&gt;\n            &lt;props&gt;\n                &lt;!-- Hibernate Configuration Properties --&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServer2008Dialect&lt;/prop&gt;             \n                &lt;prop key=\"hibernate.current_session_context_class\"&gt;org.springframework.orm.hibernate4.SpringSessionContext&lt;/prop&gt;\n                &lt;!-- prop key=\"hibernate.transaction.jta.platform\"&gt;org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform&lt;/prop--&gt;\n                &lt;prop key=\"hibernate.transaction.jta.platform\"&gt;org.hibernate.service.jta.platform.internal.JBossStandAloneJtaPlatform&lt;/prop&gt;\n\n                &lt;!-- Hibernate Configuration Properties - enabled only if debugging --&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.use_sql_comments\"&gt;true&lt;/prop&gt;\n                &lt;!-- Hibernate Cache Properties --&gt;\n                &lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.OSCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"hibernate.cache.use_query_cache\"&gt;true&lt;/prop&gt;         \n            &lt;/props&gt;\n        &lt;/constructor-arg&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Data Source --&gt;\n    &lt;bean id=\"csvliteDataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n        &lt;property name=\"jndiName\"&gt;\n            &lt;value&gt;java:jboss/datasources/CSLiteDS&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!-- Configuration of Transaction Manager --&gt;\n    &lt;bean id=\"csvliteTxManager\"\n        class=\"org.springframework.transaction.jta.JtaTransactionManager\"&gt;\n        &lt;property name=\"transactionManagerName\"&gt;\n            &lt;value&gt;java:jboss/TransactionManager&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<p>Using Hibernate Transaction is not an option for me.  Is there anything I need to do on JBoss AS 7 side in order to make the JTA transaction works? </p>\n\n<p>=========================</p>\n\n<p>[Update - 20121101]</p>\n\n<p>Basically, I did not find any other exception from the log other than the exception that I have posted earlier.</p>\n\n<p>However, interestingly i did not see any log entry that shows the binding of transaction manager to the JNDI that I have specified, and it always says it will be using \"HHH000399: Using default transaction strategy (direct JDBC transactions)\"  </p>\n\n<pre><code>15:46:00,548 INFO  [org.springframework.transaction.jta.JtaTransactionManager] (\nMSC service thread 1-5) Using JTA UserTransaction: org.jboss.tm.usertx.client.Se\nrverVMClientUserTransaction@307c44\n15:46:00,548 INFO  [org.springframework.transaction.jta.JtaTransactionManager] (\nMSC service thread 1-5) Using JTA TransactionManager: com.arjuna.ats.jbossatx.jt\na.TransactionManagerDelegate@a2f435\n15:46:00,548 INFO  [org.springframework.transaction.jta.JtaTransactionManager] (\nMSC service thread 1-5) Using JTA TransactionSynchronizationRegistry: com.arjuna\n.ats.internal.jta.transaction.arjunacore.TransactionSynchronizationRegistryImple\n@4ef523\n15:46:01,736 INFO  [org.hibernate.annotations.common.Version] (MSC service threa\nd 1-5) HCANN000001: Hibernate Commons Annotations {4.0.1.Final}\n15:46:01,767 INFO  [org.hibernate.Version] (MSC service thread 1-5) HHH000412: H\nibernate Core {4.0.1.Final}\n15:46:01,783 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-5) HHH0\n00206: hibernate.properties not found\n15:46:01,783 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-5) HHH0\n00021: Bytecode provider name : javassist\n15:46:06,142 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-5) HHH0\n00400: Using dialect: org.hibernate.dialect.SQLServer2008Dialect\n15:46:06,189 INFO  [org.hibernate.engine.transaction.internal.TransactionFactory\nInitiator] (MSC service thread 1-5) HHH000399: Using default transaction strateg\ny (direct JDBC transactions)\n15:46:06,205 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (M\nSC service thread 1-5) HHH000397: Using ASTQueryTranslatorFactory\n15:46:06,361 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-\n5) Hibernate Validator 4.2.0.Final\n</code></pre>\n\n<p>Not sure if this is the cause... if yes, what do i need to do then? </p>\n"},{"tags":["hibernate","transactions"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":2581,"score":2,"question_id":6477054,"title":"org.hibernate.AssertionFailure","body":"<p>I am getting this strange error sometimes while my thread executes. What could this be related to?</p>\n\n<pre><code>2011-Jun-25 09:05:22,339 ERROR AssertionFailure:45 - an assertion failure occured (this             may indicate a bug in Hibernate, but is more likely due to unsafe use of the session)\norg.hibernate.AssertionFailure: null id in com.inrev.bm.bean.IRKeyWordTweet entry (don't flush the Session after an exception occurs)\n    at         org.hibernate.event.def.DefaultFlushEntityEventListener.checkId(DefaultFlushEntityEventListener.java:78)\nat org.hibernate.event.def.DefaultFlushEntityEventListener.getValues(DefaultFlushEntityEventListener.java:187)\nat org.hibernate.event.def.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:143)\nat org.hibernate.event.def.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:219)\nat org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:99)\nat org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:49)\nat org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1028)\nat org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:366)\nat org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)\nat com.inrev.bm.streaming.IRKeyWordStreaminThread.run(IRKeyWordStreaminThread.java:119)\n</code></pre>\n\n<p>My code for inserting,</p>\n\n<pre><code>    Transaction tx = null;\n    Session session = sessionFactory.openSession();\n    tx = session.beginTransaction();\n\n    int count = 0;\n    try\n    {\n        for (Iterator itrList = statusToInsert.iterator(); itrList.hasNext();) \n        {\n            try \n            {\n                IRecord record = (IRecord) itrList.next();\n                session.save(record);\n                count++;\n                if ( count % 10 == 0 ) \n                { \n                    session.flush();\n                    session.clear();\n                    tx.commit();\n                    tx = session.beginTransaction();\n                }\n\n            }\n            catch (Exception e) \n            {\n                tx.commit();\n                session.close();\n                session = sessionFactory.openSession();\n                tx = session.beginTransaction();\n                StringWriter sw = new StringWriter(); \n                PrintWriter pw = new PrintWriter(sw); \n                e.printStackTrace(pw); \n                log.error(sw.toString());\n            }\n        }\n    }\n    catch (Exception e) {\n        StringWriter sw = new StringWriter(); \n        PrintWriter pw = new PrintWriter(sw); \n        e.printStackTrace(pw); \n        log.error(sw.toString());\n    }\n    finally {\n        tx.commit();\n        session.close();\n    }\n</code></pre>\n\n<p>Regards,</p>\n\n<p>Rohit</p>\n"},{"tags":["hibernate","grails","groovy","spring-security","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13249884,"title":"Find user with specific spring security role","body":"<p>I have the following:</p>\n\n<pre><code>def userInstance=User.findAll(\"from User u where u.merchant is not null and u.merchant.id = ? and u.authorities.authority.contains('ROLE_MERCHANT')\", merchantId)\n</code></pre>\n\n<p>And get the following error:</p>\n\n<pre><code>org.hibernate.hql.ast.QuerySyntaxException: unexpected AST node: ( near line 1, column 121 [from com.testing.tests.User u where u.merchant is not null and u.merchant.id = ? and u.authorities.authority.contains('ROLE_MERCHANT')]\n    at $Proxy20.createQuery(Unknown Source)\n    at testing.admin.UserService.findByMerchantId(UserService.groovy:14)\n</code></pre>\n\n<p>How can I return only users that have a specific role?</p>\n\n<p>Thanks</p>\n"},{"tags":["hibernate","wicket","aspectj"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13070295,"title":"AspectJ and Wicket throws nullpointer for Injector","body":"<p>I have wicket aspectj application which uses hibernate annotated classes and uses a DAO service layer.</p>\n\n<p>I have developed an updatetask that does not run in an applicationcontext. Therefor i created a main method and loaded the context as a global variable.</p>\n\n<pre><code>public static void main(String[] args) throws Exception\n{\n    context = new ClassPathXmlApplicationContext(LOCATIONS);\n    XS2RAWebApp webApp = new XS2RAWebApp() {\n        @Override\n        public void init() {\n            getComponentInstantiationListeners().add(new SpringComponentInjector(this, context,true));\n        }\n    };\n    ThreadContext.setApplication(webApp);\n    ResponseUpdateTask updatetask = new ResponseUpdateTask();\n\n    updatetask.run();\n}\n</code></pre>\n\n<p>As you can see, the SpringComponentInjector provided with a springcomponent injector.</p>\n\n<p>In this update task i want to save some data with hibernate.</p>\n\n<p>I have Hibernate entity and inside this entity i have a reference to my service DAO.</p>\n\n<pre><code>@MappedSuperclass()\npublic abstract class Entiteit {\n    private static final Logger log = LoggerFactory.getLogger(Entiteit.class);\n\n    @SpringBean()\n    @Transient\n    private transient DataAccessHelper daoHelper;\n    ...\n    public DataAccessHelper getDaoHelper() {\n    if (daoHelper== null) {\n        Injector.get().inject(daoHelper);\n    }\n    return daoHelper;\n  }\n}\n</code></pre>\n\n<p>Things i have tried</p>\n\n<ol>\n<li>simply use a Mockapplication and add new new SpringComponentInjector(this, context,true), this causes a exception telling me to do an init on the application (Apllication.init())\n<ol>\n<li>trial and error solutions</li>\n</ol></li>\n</ol>\n\n<p>I know it doesnt seem much what i have tried, but im really out of options right now :S</p>\n"},{"tags":["oracle","spring","hibernate","stored-procedures","jdbc"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13253854,"title":"spring 3.1 with hibernate 4 can't use StoredProcedure with OracleTypes","body":"<p>Recently we upgraded from hibernate 3.5 to 4.1.7 as well as spring from 3.0.5 to 3.1.3. Hibernate is configured via jpa in spring so no changes is made. </p>\n\n<p>After the upgrade, most of the stuff works fine but one function that uses StoredProcedure is broken with the following exception: </p>\n\n<pre><code>java.lang.ClassCastException: $Proxy188 cannot be cast to oracle.jdbc.OracleConnection\n    at oracle.sql.TypeDescriptor.setPhysicalConnectionOf(TypeDescriptor.java:829)\n    at oracle.sql.TypeDescriptor.&lt;init&gt;(TypeDescriptor.java:583)\n    at oracle.sql.ArrayDescriptor.&lt;init&gt;(ArrayDescriptor.java:224)\n    at org.springframework.data.jdbc.support.oracle.SqlArrayValue.createTypeValue(SqlArrayValue.java:71)\n    at org.springframework.jdbc.core.support.AbstractSqlTypeValue.setTypeValue(AbstractSqlTypeValue.java:58)\n    at org.springframework.jdbc.core.StatementCreatorUtils.setValue(StatementCreatorUtils.java:281)\n    at org.springframework.jdbc.core.StatementCreatorUtils.setParameterValueInternal(StatementCreatorUtils.java:217)\n    at org.springframework.jdbc.core.StatementCreatorUtils.setParameterValue(StatementCreatorUtils.java:128)\n    at org.springframework.jdbc.core.CallableStatementCreatorFactory$CallableStatementCreatorImpl.createCallableStatement(CallableStatementCreatorFactory.java:212)\n    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:1008)\n    at org.springframework.jdbc.core.JdbcTemplate.call(JdbcTemplate.java:1064)\n    at org.springframework.jdbc.object.StoredProcedure.execute(StoredProcedure.java:144)\n</code></pre>\n\n<p>In debug mode, I found the <code>AbsructSqlTypeValue.setTypeValue()</code> method has the following implementation:</p>\n\n<pre><code>public final void setTypeValue(PreparedStatement ps, int paramIndex, int sqlType, String typeName)\n        throws SQLException {\n\n    Object value = createTypeValue(ps.getConnection(), sqlType, typeName);\n    if (sqlType == TYPE_UNKNOWN) {\n        ps.setObject(paramIndex, value);\n    }\n    else {\n        ps.setObject(paramIndex, value, sqlType);\n    }\n}\n</code></pre>\n\n<p>The <code>ps.getConnection()</code> method here actually returns a new Hibernate 4 LogicalConnectionImpl which wraps around the real OracleConnection. And that's why the it throws the ClassCastException in Oracle driver. </p>\n\n<p>The reason why it calls to oracle.SqlArrayValue is because the store proc takes list of longs as input parameter. When the input parameter is defined, we uses OracleTypes.ARRAY then while binding the values, we create a new SqlArrayValue object to wrap around the Long[]. I tried to use the generic Types.Array and Long[] directly but it didn't work either with the following exception:</p>\n\n<pre><code>Caused by: java.sql.SQLException: Fail to convert to internal representation: [Ljava.lang.Long;@337f5afe\n    at oracle.sql.ARRAY.toARRAY(ARRAY.java:187)\n    at oracle.jdbc.driver.OraclePreparedStatement.setObjectCritical(OraclePreparedStatement.java:8782)\n    at oracle.jdbc.driver.OraclePreparedStatement.setObjectInternal(OraclePreparedStatement.java:8278)\n    at oracle.jdbc.driver.OraclePreparedStatement.setObjectInternal(OraclePreparedStatement.java:8877)\n    at oracle.jdbc.driver.OracleCallableStatement.setObject(OracleCallableStatement.java:4992)\n    at oracle.jdbc.driver.OraclePreparedStatementWrapper.setObject(OraclePreparedStatementWrapper.java:240)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at oracle.ucp.jdbc.proxy.StatementProxyFactory.invoke(StatementProxyFactory.java:230)\n    at oracle.ucp.jdbc.proxy.PreparedStatementProxyFactory.invoke(PreparedStatementProxyFactory.java:124)\n    at oracle.ucp.jdbc.proxy.CallableStatementProxyFactory.invoke(CallableStatementProxyFactory.java:101)\n    at $Proxy214.setObject(Unknown Source)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122)\n</code></pre>\n\n<p>I don't understand why the jdbcTemplate somehow uses the hibernate connection instead of the native OracleConnection, maybe there is some configuration somewhere can fix it magically?</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":30,"score":-3,"question_id":13253087,"title":"what is best site to study Spring and Hibernate?","body":"<p>I am wiling to learn the Spring and Hibernate in java ? So what is best site to study Spring and Hibernate ?Thanks in advance...</p>\n"},{"tags":["hibernate","jpa","stateless-session"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13252921,"title":"Is there a class similar to stateless session hibernate for JPA?","body":"<p>Is there a class similar to stateless session hibernate for JPA or some way to get the results of a query without the proxies, like the objects are already detached from the Entity Manager?</p>\n"},{"tags":["java","hibernate","cascade"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13231219,"title":"Getting Hibernate to cascade on save, but not delete?","body":"<p>So I'm having a problem with my hibernate implementation. When I try to delete a parent class, I receive a foreign key constraint exception on a class deep within the cascade hierarchy. Before I go into specifics, I'll first describe the relationships of the classes, as it has a bearing on how they need to be saved and deleted.</p>\n\n<p>At the top level, I have a Customer class, which contains a list of DefaultMask objects. This is the master list, in that these default masks are used by other classes in my object hierarchy, but always from this list. Masks are only created into this list and deleted from this list.</p>\n\n<p>Further down the hierarchy, I have a Column class, which can (optionally) have a DefaultMask set on it. To describe the relationship more succinctly;</p>\n\n<p>A Customer OWNS zero to many DefaultMasks.\nA Customer OWNS zero to many Columns.\nA Column may have one DefaultMask.</p>\n\n<p>In my application, when I attempt to delete a Customer, the exception comes from the foreign-key constraint on the Column class to the DefaultMask class, and I believe the problem is incorrect settings with CascadeType. I have researched the problem and found information on an attribute called mappedBy and on using Hibernate's own CascadeType.SAVE_UPDATE (in order to prevent Hibernate trying to delete a DefaultMask held by a Column), but I will admit I am a bit lost here and could use some direct guidance. Relevant code for the classes and the actual exception message are below.</p>\n\n<p>Customer:</p>\n\n<pre><code>@Entity\npublic class Customer {\n\n@Id\nprivate String id;\n@OneToMany(cascade = CascadeType.ALL)\nprivate List&lt;DefaultMask&gt; masks;\n    //(Columns are held further down in hierarchy)\n</code></pre>\n\n<p>Column:</p>\n\n<pre><code>@Entity\n@Table(name = \"WarehouseColumn\")\npublic class Column implements Comparable&lt;Column&gt; {\n\n@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate int hibernateID;\n@OneToOne\nprivate DefaultMask mask;\n</code></pre>\n\n<p>DefaultMask:</p>\n\n<pre><code>@Entity\npublic class DefaultMask implements Mask {\n\n@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate int hibernateID;\nprivate String type;\nprivate String mask;\n</code></pre>\n\n<p>Exception message:</p>\n\n<p>org.hibernate.exception.ConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (<code>hibernate</code>.<code>WarehouseColumn</code>, CONSTRAINT <code>FK8BB153D994AD57D3</code> FOREIGN KEY (<code>mask_hibernateID</code>) REFERENCES <code>DefaultMask</code> (<code>hibernateID</code>))\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (<code>hibernate</code>.<code>WarehouseColumn</code>, CONSTRAINT <code>FK8BB153D994AD57D3</code> FOREIGN KEY (<code>mask_hibernateID</code>) REFERENCES <code>DefaultMask</code> (<code>hibernateID</code>))</p>\n"},{"tags":["hibernate","repository","left-join","one-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13251912,"title":"left join with Hibernate by @OneToOne and FetchType.EAGER","body":"<p>I have two tables with @OneToOne by a id.\nSo if the second id refer to a not present row of the table\ncan I say to Hibernate to skyp this row. \nInstead I have an error.</p>\n\n<pre><code>@Entity\n@Table(name=\"user\")\npublic class User implements Serializable {\n\nprivate Long idUser;\nprivate Area area;\n\n//...other get and setter\n\n@OneToOne(fetch=FetchType.EAGER)\n@JoinColumn(name=\"idarea\")\npublic Area getArea() {\nreturn area;\n}\n}\n</code></pre>\n\n<p>now if I have an row of user with non-existent idarea , how can I skip the user,\nor can I make a LEFT JOIN?</p>\n"},{"tags":["java","oracle","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":33,"score":0,"question_id":13251646,"title":"quering oracle view with hibernate everytime results to null","body":"<p>i've built an entitybean using the hibernate tools from an existing oracle view.\nThe problem is that every query results to NULL.</p>\n\n<p>I have searched the web to find a solution but i didn't find one.</p>\n\n<p>I've tried something like this:</p>\n\n<pre><code>public static List&lt;View&gt; getBillRecord()\n  {\n    Query query = em.createQuery(\"from View where column=123\");\n    return query.getResultList();\n  }\n</code></pre>\n\n<p>The resulting query seems to be ok when i switch on \n<code>&lt;property name=\"show_sql\"&gt;true&lt;/property&gt;</code> in hibernate.cfg.xml.</p>\n\n<p>Any suggestions/hints?</p>\n"},{"tags":["java","hibernate","jqgrid","reload"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13251847,"title":"Java code for reloading jqgrid","body":"<p>I'm using jqgrid in a web application. And all operation on jqgrid is been  performed through Java code. I’m using Hibernate MVC for this. I want to reload grid after some operation. Is there any code which I can use in my servlet to reload jqgrid???</p>\n"},{"tags":["ajax","hibernate","jsf","lazy-loading"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13251792,"title":"JSF2 + Ajax EL issue with Hibernate Lazy Loading","body":"<p>I am attempting to intergrate spring, JSF2 and hibernate into a new project, but I am having an issue with lazy-loaded collections.  Here is the summary of my issue, I am attempting to figure out how I can lazy load (from hibernate with fetch = Lazy) via an ajax/PPR request from EL(JSF).</p>\n\n<p>The problem is that my view is attempting to access a collection that should be lazy loaded via EL, but the object is detached because the request has finished (I am using opensessioninviewfilter).  So is there any way to lazy load data when using PPR with many short ajax-y requests?  </p>\n\n<p>In this instance I am attempting to list multiple domain objects, and in a partial page render, using a view scoped bean, I want to pick one of the objects and display details about it and potentially update it.  The typical flow of information in my application would be as follows:  </p>\n\n<p>*A list of domain objects is loaded and populated to a p:datatable. The domain objects are stored in a list in a backing bean that is View scoped.<br>\n*When the user clicks on an item to edit it, the item is loaded into a variable in the backing bean called workingItem using ajax/PPR with the viewscoped bean.<br>\n*Typically, then the item would be loaded into a dialog (typcially a Primefaces p:dialog), once again this would be done in ajax.\n*Here is where things break down.  If the domain object has a collection that is lazy loaded (maybe to populate a p:selectOneMenu) it always throws a LazyLoadingException.  </p>\n\n<p>So my question is, how can I get the a lazy loaded collection to be loaded when the proxy is accessed during an ajax call (where I wouldn’t have the opportunity to re-attached the detached object).  </p>\n\n<p>*I CAN NOT use a eager fetch to work around this, the object graph is very large and I need to replicate the session information to other servers.<br>\n*I am using Spring’s opensessioninviewfilter, but I don’t believe it can help me in this instance (right?)\n*My root problem is that I don’t know how to attach an domain object to a session to do the lazy-load when the UI attempting to pull a property on the domain object.  </p>\n\n<p>I am finding that lazy-loading (with hibernate) is very hard to do where ajax is used a lot.  Any recommendations, suggestions would be GREATLY appreciated!</p>\n\n<h1>Here is my backing bean (Generic):</h1>\n\n<pre><code>@Component\n@Scope(\"view\")\npublic abstract class CrudBean&lt;T extends DomainObject,U extends CrudService&gt; extends AgoraBean     implements Serializable\n{\nprivate static final Logger logger = LoggerFactory.getLogger(CrudBean.class);\n\nprotected U crudService;\n\nprotected T workingItem;\nprotected List&lt;T&gt; cachedItems;\nprotected List&lt;T&gt; filteredList;\n\npublic abstract String createWorkingItem();\n\npublic void setWorkingItem(T item)\n{\n    workingItem = item;\n}\n\npublic T getWorkingItem()\n{\n    return workingItem;\n}\n\n\npublic List&lt;T&gt; getAllItems()\n{\n    if ( cachedItems == null )\n    {\n        cachedItems = getCrudService().getAllItems();\n    }\n    return cachedItems;\n}\n\n/* Other crud-dy stuff removed */\n\n}\n</code></pre>\n\n<h1>Here is an example of one of my domain objects:</h1>\n\n<pre><code>@Entity\n@Table(name = \"sites\" )\npublic class Site implements Serializable, DomainObject {\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Column(updatable = false, nullable = false)\nprivate Long id; \n\n@Version\nprivate Integer version;\n\n@Column(length=255,nullable=false)\nprivate String name;\n\n@Column(length=25)\nprivate String abbreviation;\n\n@Column(length=100)\nprivate String street;\n\n@Column(length=100)\nprivate String city;\n\n@Column(length=2)\nprivate String locationState;\n\n@Column(length=10)\nprivate String zip;\n\n@Column(length=20)\nprivate String phone;\n\n@Column(length=20)\nprivate String fax;\n\n@Column(length=50)\nprivate String contactEmail;\n\n@Index(name = \"idxSitePublished\")\nprivate boolean published;\n\n@Index(name = \"idxSiteDefault\")\nprivate boolean defaultSite;\n\n@ManyToOne\nprivate Header header;\n\n@ManyToMany\n@Fetch(FetchMode.SELECT)\n@BatchSize(size=5)\n@OrderBy(\"priority ASC\")\nprivate List&lt;Script&gt; scripts;\n\n@ManyToMany\n@BatchSize(size=5)\n@OrderBy(\"priority ASC\")\nprivate List&lt;Style&gt; styles;\n}\n</code></pre>\n\n<h1>And My Web.xml</h1>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"3.0\" xmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;javax.faces.PROJECT_STAGE&lt;/param-name&gt;\n    &lt;param-value&gt;Development&lt;/param-value&gt;\n&lt;/context-param&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;/WEB-INF/application-context.xml&lt;/param-value&gt;\n&lt;/context-param&gt;    \n&lt;context-param&gt;\n    &lt;param-name&gt;primefaces.THEME&lt;/param-name&gt;\n    &lt;param-value&gt;home&lt;/param-value&gt;\n&lt;/context-param&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n&lt;session-config&gt;\n    &lt;session-timeout&gt;\n        60\n    &lt;/session-timeout&gt;\n&lt;/session-config&gt;\n\n\n&lt;!-- Listeners - Spring should come first because we need them for our listener --&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.request.RequestContextListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;net.dupage88.www.servlet.SiteServletContextListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;welcome-file-list&gt;\n    &lt;welcome-file&gt;index.html&lt;/welcome-file&gt;\n&lt;/welcome-file-list&gt;\n&lt;error-page&gt;\n    &lt;exception-type&gt;javax.faces.application.ViewExpiredException&lt;/exception-type&gt;\n    &lt;location&gt;/public/index.html&lt;/location&gt;\n&lt;/error-page&gt;\n&lt;!--&lt;error-page&gt;\n    &lt;error-code&gt;404&lt;/error-code&gt;\n    &lt;location&gt;/public/404.jsf&lt;/location&gt;\n&lt;/error-page&gt;\n&lt;error-page&gt;\n    &lt;error-code&gt;401&lt;/error-code&gt;\n    &lt;location&gt;/public/401.jsf&lt;/location&gt;\n&lt;/error-page&gt;\n&lt;error-page&gt;\n    &lt;error-code&gt;500&lt;/error-code&gt;\n    &lt;location&gt;/public/500.jsf&lt;/location&gt;\n&lt;/error-page&gt;--&gt;\n\n&lt;!-- For Lazy Loading --&gt;\n&lt;filter&gt;\n    &lt;filter-name&gt;hibernateFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.orm.hibernate3.support.OpenSessionInViewFilter&lt;/filter-class&gt;\n&lt;/filter&gt; \n&lt;filter-mapping&gt; \n    &lt;filter-name&gt;hibernateFilter&lt;/filter-name&gt; \n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n\n&lt;filter&gt;\n    &lt;filter-name&gt;RootRedirectFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;net.dupage88.www.filters.RootRedirectFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;RootRedirectFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/index.html&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n\n\n&lt;filter&gt;\n    &lt;filter-name&gt;ShiroFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.apache.shiro.web.servlet.ShiroFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;ShiroFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;\n    &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;\n    &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;\n    &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;\n&lt;/filter-mapping&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;org.apache.shiro.web.env.EnvironmentLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n\n&lt;filter&gt;\n    &lt;filter-name&gt;PrimeFaces FileUpload Filter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.primefaces.webapp.filter.FileUploadFilter&lt;/filter-class&gt;\n&lt;/filter&gt;   \n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;PrimeFaces FileUpload Filter&lt;/filter-name&gt;\n    &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n&lt;/filter-mapping&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>Any help or guidance would be appreciated and thanks for any help you can provide in advance!</p>\n\n<p>Thanks,\nChuck</p>\n"},{"tags":["java","hibernate","spring","jsf"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":5902,"score":3,"question_id":3081441,"title":"org.hibernate.HibernateException: Illegal attempt to associate a collection with two open sessions","body":"<p>Upon deleting an entity from the database I get the following exception: </p>\n\n<pre><code>org.hibernate.HibernateException: Illegal attempt to associate a collection with two open sessions\n   at org.hibernate.collection.AbstractPersistentCollection.setCurrentSession(AbstractPersistentCollection.java:410)\n   at org.hibernate.event.def.OnUpdateVisitor.processCollection(OnUpdateVisitor.java:43)\n   at org.hibernate.event.def.AbstractVisitor.processValue(AbstractVisitor.java:101)\n   at org.hibernate.event.def.AbstractVisitor.processValue(AbstractVisitor.java:61)\n   at org.hibernate.event.def.AbstractVisitor.processEntityPropertyValues(AbstractVisitor.java:55)\n at org.hibernate.event.def.AbstractVisitor.process(AbstractVisitor.java:123)\n at org.hibernate.event.def.DefaultDeleteEventListener.onDelete(DefaultDeleteEventListener.java:101)\n at org.hibernate.event.def.DefaultDeleteEventListener.onDelete(DefaultDeleteEventListener.java:52)\n at org.hibernate.impl.SessionImpl.fireDelete(SessionImpl.java:767)\n at org.hibernate.impl.SessionImpl.delete(SessionImpl.java:745)\n at org.springframework.orm.hibernate3.HibernateTemplate$25.doInHibernate(HibernateTemplate.java:790)\n at org.springframework.orm.hibernate3.HibernateTemplate.execute(HibernateTemplate.java:372)\n at org.springframework.orm.hibernate3.HibernateTemplate.delete(HibernateTemplate.java:784)\n at org.springframework.orm.hibernate3.HibernateTemplate.delete(HibernateTemplate.java:780)\n at pl.edu.agh.adam.core.projects.dao.TagDAO.delete(TagDAO.java:98)\n at pl.edu.agh.adam.core.projects.ProjectService.deleteTag(ProjectService.java:109)\n at pl.edu.agh.adam.core.projects.web.TagPresenter.deleteTag(TagPresenter.java:97)\n at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n at java.lang.reflect.Method.invoke(Method.java:597)\n at com.sun.el.parser.AstValue.invoke(AstValue.java:234)\n at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:297)\n at org.apache.myfaces.view.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:83)\n at javax.faces.component._MethodExpressionToMethodBinding.invoke(_MethodExpressionToMethodBinding.java:88)\n at org.apache.myfaces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:100)\n at javax.faces.component.UICommand.broadcast(UICommand.java:120)\n at javax.faces.component.UIData.broadcast(UIData.java:708)\n at javax.faces.component.UIViewRoot._broadcastAll(UIViewRoot.java:890)\n at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:234)\n at javax.faces.component.UIViewRoot._process(UIViewRoot.java:1202)\n at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:623)\n at org.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:35)\n at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:143)\n at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:93)\n at javax.faces.webapp.FacesServlet.service(FacesServlet.java:189)\n at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)\n at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)\n at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n at java.lang.Thread.run(Thread.java:619)\n</code></pre>\n\n<p>I've dug deep and tried numerous solutions from the hibernate forum, but still I don't know what's going on and where the sessions are opened. The conditions under which this problem occurs:</p>\n\n<p>First: <code>OpenSessionInViewFilter</code> - I've asked about it here. Everything seemed to work fine, but the deleting stopped all of a sudden the following day and all I've done is - I've added a non-connected class to a non-connected package.</p>\n\n<pre><code>  &lt;!-- Hibernate OpenSession Filter --&gt;\n  &lt;filter&gt;\n   &lt;filter-name&gt;hibernateFilter&lt;/filter-name&gt;\n   &lt;filter-class&gt;org.springframework.orm.hibernate3.support.OpenSessionInViewFilter&lt;/filter-class&gt;\n   &lt;init-param&gt;\n    &lt;param-name&gt;singleSession&lt;/param-name&gt;\n    &lt;param-value&gt;false&lt;/param-value&gt;\n   &lt;/init-param&gt;\n   &lt;init-param&gt;\n    &lt;param-name&gt;sessionFactoryBeanName&lt;/param-name&gt;\n    &lt;param-value&gt;sessionFactory&lt;/param-value&gt;\n   &lt;/init-param&gt;\n   &lt;/filter&gt;\n  &lt;filter-mapping&gt;\n    &lt;filter-name&gt;hibernateFilter&lt;/filter-name&gt;\n   &lt;url-pattern&gt;*&lt;/url-pattern&gt;\n  &lt;/filter-mapping&gt;\n</code></pre>\n\n<p>Second: three-tier architecture. Here are the classes and the JSF page:</p>\n\n<pre><code>@Entity\n@Table(name = \"tag\")\npublic class Tag implements Serializable {\nprivate static final long serialVersionUID = 1L;\n@ManyToMany(mappedBy = \"tags\", targetEntity = Project.class)\nList&lt;Project&gt; projects = new ArrayList&lt;Project&gt;();\n@Transient\npublic static final String PROP_ID = \"id\";\n@Id\n@GeneratedValue(strategy=GenerationType.IDENTITY)\n@Column(name = \"tag_id\")\nprivate Long id;\n@Transient\npublic static final String PROP_NAME = \"name\";\n@Column(name = \"name\", length = 25, unique = true)\nprivate String name;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>public class TagDAO extends HibernateDaoSupport implements ITagDAO {\n\n@Override\npublic void create(Tag tag) {\n  getHibernateTemplate().save(tag);\n}\n\n@Override\npublic Tag getTag(String name){\n  Tag group = null;\n\n  DetachedCriteria criteria = DetachedCriteria.forClass(Tag.class);\n  criteria.add(Restrictions.eq(\"name\", name));\n  List&lt;Tag&gt; tags = getHibernateTemplate().findByCriteria(criteria);\n  if ((tags != null) &amp;&amp; (tags.size() &gt; 0)) {\n    group = (Tag)tags.get(0);\n  }\n  return group;\n}\n\n@Override\npublic Tag getTag(Long id){\nTag group = null;\nList&lt;Tag&gt; groups = getHibernateTemplate().find(\n \"from Tag where id = ?\", id);\nif ((groups != null) &amp;&amp; (groups.size() &gt; 0)) {\ngroup = (Tag)groups.get(0);\n}\nreturn group;\n}\n\n@Override\npublic List&lt;Tag&gt; getTags(){\nList&lt;Tag&gt; ret = getHibernateTemplate().find(\"from Tag\");\nSystem.out.println(\"Dao got \"+ret.size()+\" tags\");\nreturn ret;\n}\n\n@Override\npublic Integer getTagCount() {\nDetachedCriteria criteria = DetachedCriteria.forClass(Tag.class);\ncriteria.setProjection(Projections.rowCount());\nreturn (Integer)(getHibernateTemplate().findByCriteria(criteria).get(0));\n}\n\n@Override\npublic void delete(Tag group) {\ngetHibernateTemplate().delete(group);\n\n}\n\n@Override\npublic void update(Tag group) {\n\ngetHibernateTemplate().update(group);\n\n}\n\n@Override\npublic List&lt;Tag&gt; getTags(Integer first, Integer resultsPerPage,\nString order, Boolean asc) {\n\nDetachedCriteria criteria = DetachedCriteria.forClass(Tag.class);\nif (asc){\ncriteria.addOrder(Order.asc(order));\n}else{\ncriteria.addOrder(Order.desc(order));\n} \nreturn (List&lt;Tag&gt;)getHibernateTemplate().findByCriteria(criteria, first, resultsPerPage);\n}\n}\n</code></pre>\n\n<hr>\n\n<pre><code>public class ProjectService implements IProjectService {\n\n// Beans used by this service.\nprivate IProjectDAO projectDao;\nprivate ITagDAO tagDao;\n\n@Override\npublic void createProject(Project project) throws AlreadyExistsException {\n if (projectDao.getProject(project.getName()) != null) {\n  throw new AlreadyExistsException();\n }\n projectDao.addProject(project);\n}\n\n@Override\npublic List&lt;Project&gt; getProjects(Integer first, Integer howMany, String order,\n  boolean asc) {\n return projectDao.getProjects(first, howMany, order, asc);\n} \n\n@Override\npublic Integer getProjectCount(){\n return projectDao.getProjectCount();\n}\n\n@Override\npublic List&lt;Project&gt; getProjects() {\n return projectDao.getAllProjects();\n}\n\n@Override\npublic void deleteProject(Long id) {\n projectDao.removeProject(id);\n}\n\n@Override\npublic List&lt;Tag&gt; getTags() {\n return tagDao.getTags();\n}\n\n@Override\npublic Tag getTag(String name){\n return tagDao.getTag(name);\n}\n@Override\npublic void createTag(Tag tag) throws AlreadyExistsException {\n if (tagDao.getTag(tag.getName()) != null) {\n  throw new AlreadyExistsException();\n }\n tagDao.create(tag);\n}\n@Override\npublic void deleteTag(Long id) {\n  tagDao.delete(tagDao.getTag(id));\n}\n@Override\npublic void updateTag(Tag tag) {\ntagDao.update(tag);\n\n}\n}\n</code></pre>\n\n<hr>\n\n<pre><code>@ManagedBean(name = \"tagPresenter\")\n@RequestScoped\npublic class TagPresenter {\n\n private List&lt;Tag&gt; tags;\n private IProjectService projectService;\n private Tag tag;\n\n\n public void setTag(Tag tag) {\n  this.tag= tag;\n }\n public Tag getTag() {\n  return tag;\n }\n\n public TagPresenter() {\n  projectService = (IProjectService)ServiceFinder.getInstance()\n   .findBean(\"projectService\");\n  tags = projectService.getTags();\n }\n\n private void refresh() {\n  tags = projectService.getTags();\n }\n\n public List&lt;Tag&gt; getTags() {\n  refresh();\n  return tags;\n }\n\n public void deleteTag() {\n  projectService.deleteTag(tag.getId());\n }\n\n}\n</code></pre>\n\n<hr>\n\n<p>finally the webpage:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:ui=\"http://java.sun.com/jsf/facelets\"     xmlns:h=\"http://java.sun.com/jsf/html\" xmlns:f=\"http://java.sun.com/jsf/core\" xmlns:p=\"http://primefaces.prime.com.tr/ui\"&gt; \n &lt;ui:composition template=\"/templates/template.xhtml\"&gt;\n  &lt;ui:define name=\"head\"&gt;\n   &lt;title&gt;Tags&lt;/title&gt;\n   &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"#{facesContext.externalContext.requestContextPath}/styles/style.css\"/&gt;\n  &lt;/ui:define&gt;\n  &lt;ui:define name=\"content\"&gt;\n  &lt;h:form name=\"commandForm\"&gt;\n  &lt;p:dataTable var=\"tag\" name=\"tagsList\" value=\"${tagPresenter.tags}\" paginator=\"true\" rows=\"10\"  &gt;\n    &lt;p:column sortBy=\"#{tag.id}\"&gt;\n      &lt;f:facet name=\"header\"&gt;\n       &lt;h:outputText value=\"Id\" /&gt;\n      &lt;/f:facet&gt;\n       &lt;h:outputText value=\"#{tag.id}\" /&gt;\n     &lt;/p:column&gt;\n     &lt;p:column sortBy=\"#{tag.name}\"&gt;\n      &lt;f:facet name=\"header\"&gt;\n       &lt;h:outputText value=\"Name\" /&gt;\n      &lt;/f:facet&gt;\n       &lt;h:outputText value=\"#{tag.name}\" /&gt;\n     &lt;/p:column&gt;\n      &lt;p:column&gt;\n       &lt;h:commandLink action=\"#{tagDisplayer.showTag}\" value=\"Modify\"&gt;\n         &lt;f:setPropertyActionListener target=\"#{tagDisplayer.tag}\" value=\"#{tag}\"/&gt;\n       &lt;/h:commandLink&gt;\n       &lt;h:commandLink action=\"#{tagPresenter.deleteTag}\" value=\"Delete\"&gt;\n        &lt;f:setPropertyActionListener target=\"#{tagPresenter.tag}\" value=\"#{tag}\"/&gt;\n       &lt;/h:commandLink&gt;\n     &lt;/p:column&gt;\n    &lt;/p:dataTable&gt;\n    &lt;/h:form&gt;\n    &lt;p:messages id=\"deletingError\" showDetail=\"true\"/&gt;\n  &lt;/ui:define&gt;\n &lt;/ui:composition&gt;\n    &lt;/html&gt;\n</code></pre>\n\n<p>How is this problem caused and how can I solve it?</p>\n"},{"tags":["java","hibernate","jpa","jpa-2.0","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12951701,"title":"How to get entity manger or transaction in jpa listener","body":"<p>I was using Hibernate event listener like <code>PostDeleteEventListener, PostInsertEventListener, PostUpdateEventListener</code> to do some operations during insert, delete and update. Now I would like to use JPA listener to do this because if I like to move from Hibernate to any other JPA provider my listener should work. Hibernate listener gives me <code>event</code> from which I can get the transaction and check whether its committed or rollback. JPA listeners only provides me the entity object. Now how can I get the transaction or session or entity manger in the JPA listener?? Thanks in advance!! I am using Jboss as my CMT.</p>\n"},{"tags":["spring","hibernate","transactions","jpa-2.0","lazy-loading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":210,"score":0,"question_id":9848931,"title":"Spring 3 JPA: LazyInitializationException despite @Transactional Service Method","body":"<p>I am working with Spring 3, Hibernate 3.0.6 and JPA 2.</p>\n\n<p>I am getting <code>LazyInitializationException</code>:</p>\n\n<p>Here is the Service:\n    @Service\n    public class ReportServiceImpl implements ReportService {\n        private ReportDAO reportDAO;\n        private FieldDefDAO fieldDefDAO;\n        private FieldDefService fieldDefService;</p>\n\n<pre><code>    /**\n     * \n     */\n    @Override\n    @Transactional(propagation = Propagation.REQUIRED)\n    public void updateReport(ReportTemplate reportTemplate, String[] fieldIds) {\n        logger.entry(reportTemplate);\n\n        try {\n            ReportTemplate existingReport = reportDAO.findById(\n                    reportTemplate.getId(), true);\n\n            existingReport.setName(reportTemplate.getName());\n            existingReport.setDepartment(reportTemplate.getDepartment());\n\n            // set selected fields\n            if (fieldIds != null) {\n                existingReport.removeReportFields();\n\n                for (String fieldId : fieldIds) {\n\n                    FieldDef fd = fieldDefDAO.findById(Long.parseLong(fieldId), false);\n\n                    // EXCEPTION THROWN HERE (\n                    reportTemplate.addReportField(fd, i);\n                }\n            }\n            reportDAO.mergeState(existingReport, false);\n        } catch (FocusDAOException fde) {\n            throw new FocusServiceException(fde);\n        }\n        logger.exit();\n    }\n}\n</code></pre>\n\n<p>The Entities:</p>\n\n<pre><code>@Entity\n@Table(name = \"REPORT_TEMPLATE\")\n@SQLDelete(sql = \"UPDATE REPORT_TEMPLATE SET deleted = 1 WHERE REPORTTEMPLATE_ID = ? and OPTLOCK = ?\")\n@Where(clause = \"deleted &lt;&gt; 1\")\npublic class ReportTemplate extends Template {\n\n    private Long id;\n    private Set&lt;ReportField&gt; reportFields = new HashSet&lt;ReportField&gt;();\n\n    /**\n     * @return the id\n     */\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"REPORTTEMPLATE_ID\")\n    public Long getId() {\n        return id;\n    }\n\n    /**\n     * @param id\n     *            the id to set\n     */\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    /**\n     * @return the reportFields\n     */\n    @OneToMany(mappedBy = \"reportTemplate\", cascade = { CascadeType.PERSIST,\n            CascadeType.MERGE })\n    public Set&lt;ReportField&gt; getReportFields() {\n        return reportFields;\n    }\n\n    /**\n     * @param reportFields\n     *            the reportFields to set\n     */\n    public void setReportFields(Set&lt;ReportField&gt; reportFields) {\n        this.reportFields = reportFields;\n    }\n\n    /**\n     * \n     * @param field\n     */\n    @Transient\n    public void addReportField(FieldDef field, int order) {\n        ReportField rf = new ReportField(this, field, order);\n\n        reportFields.add(rf);\n        field.getReportFields().add(rf);        \n    }\n\n    /**\n     * \n     */\n    public void removeReportFields() {\n        for (ReportField rf : reportFields) {\n            rf.setReportTemplate(null);\n            reportFields.remove(rf);\n        }\n    }\n\n}\n\n@Entity\n@Table(name = \"REPORT_FIELD\", uniqueConstraints = @UniqueConstraint(columnNames = {\n    \"REPORTFIELD_ID\", \"FIELDDEF_ID\", \"DISPLAY_ORDER\" }))\npublic class ReportField {\n\nprivate Long id;\n\n// @OrderColumn\nprivate FieldDef field;\nprivate ReportTemplate reportTemplate;\nprivate int order;\n\n/**\n * \n */\npublic ReportField() {}\n\n/**\n * \n * @param reportTemplate\n * @param field\n * @param order\n */\npublic ReportField(ReportTemplate reportTemplate, FieldDef field, int order) {\n    this.reportTemplate = reportTemplate;\n    this.field = field;\n    this.order = order;\n}\n\n/**\n * @return the id\n */\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Column(name = \"REPORTFIELD_ID\")\npublic Long getId() {\n    return id;\n}\n\n/**\n * @param id\n *            the id to set\n */\npublic void setId(Long id) {\n    this.id = id;\n}\n\n/**\n * @return the field\n */\n@ManyToOne\n@JoinColumn(name = \"FIELDDEF_ID\", nullable = false)\npublic FieldDef getField() {\n    return field;\n}\n\n/**\n * @param field\n *            the field to set\n */\npublic void setField(FieldDef field) {\n    this.field = field;\n}\n\n/**\n * @return the report\n */\n@ManyToOne\n@JoinColumn(name = \"REPORTTEMPLATE_ID\", nullable = false)\npublic ReportTemplate getReportTemplate() {\n    return reportTemplate;\n}\n\n/**\n * @param report\n *            the report to set\n */\npublic void setReportTemplate(ReportTemplate reportTemplate) {\n    this.reportTemplate = reportTemplate;\n}\n\n/**\n * @return the order\n */\n@Column(name = \"DISPLAY_ORDER\", nullable = false)\npublic int getOrder() {\n    return order;\n}\n\n/**\n * @param order\n *            the order to set\n */\npublic void setOrder(int order) {\n    this.order = order;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>configuration:\n        \n        </p>\n\n<pre><code>        &lt;security:global-method-security\n            pre-post-annotations=\"enabled\" /&gt;\n\n        &lt;mvc:resources mapping=\"/resources/**\" location=\"/resources/\" /&gt;\n\n        &lt;bean id=\"jspViewResolver\"\n            class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n            &lt;property name=\"viewClass\"\n                value=\"org.springframework.web.servlet.view.JstlView\" /&gt;\n            &lt;property name=\"prefix\" value=\"/WEB-INF/jsp/\" /&gt;\n            &lt;!-- &lt;property name=\"suffix\" value=\".jsp\" /&gt; --&gt;\n        &lt;/bean&gt;\n\n        &lt;bean id=\"tilesViewResolver\"\n            class=\"org.springframework.web.servlet.view.UrlBasedViewResolver\"&gt;\n            &lt;property name=\"viewClass\"&gt;\n                &lt;value&gt;\n                    org.springframework.web.servlet.view.tiles2.TilesView\n            &lt;/value&gt;\n            &lt;/property&gt;\n            &lt;property name=\"order\" value=\"1\" /&gt;\n        &lt;/bean&gt;\n\n        &lt;bean id=\"tilesConfigurer\"\n            class=\"org.springframework.web.servlet.view.tiles2.TilesConfigurer\"&gt;\n            &lt;property name=\"definitions\"&gt;\n                &lt;list&gt;\n                    &lt;value&gt;/WEB-INF/tiles/tiles.xml&lt;/value&gt;\n                &lt;/list&gt;\n            &lt;/property&gt;\n        &lt;/bean&gt;\n\n        &lt;bean id=\"projectDS\" class=\"org.apache.tomcat.jdbc.pool.DataSource\"\n            destroy-method=\"close\"\n            p:driverClassName=\"${driver.class.name}\"\n            p:url=\"${url}\"\n            p:initialSize=\"${initial.size}\"\n            p:maxActive=\"${max.active}\"\n            p:maxIdle=\"${max.idle}\"\n            p:minIdle=\"${min.idle}\"\n            p:testOnBorrow=\"true\"\n            p:validationQuery=\"SELECT 1\"\n            p:validationInterval=\"30000\"\n            p:timeBetweenEvictionRunsMillis=\"30000\"\n            p:removeAbandoned=\"true\"\n            p:removeAbandonedTimeout=\"60\"\n            p:logAbandoned=\"true\"\n            p:abandonWhenPercentageFull=\"75\"\n            p:jdbcInterceptors=\"ConnectionState;StatementFinalizer;ResetAbandonedTimer;SlowQueryReport(threshold=3000)\"\n        /&gt;\n\n        &lt;bean id=\"projectEMF\"\n            class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n            &lt;property name=\"dataSource\" ref=\"projectDS\" /&gt;\n            &lt;property name=\"jpaVendorAdapter\" ref=\"jpaVendorAdapter\" /&gt;\n        &lt;/bean&gt;\n\n        &lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n            &lt;property name=\"entityManagerFactory\" ref=\"projectEMF\" /&gt;\n            &lt;property name=\"dataSource\" ref=\"projectDS\" /&gt;\n        &lt;/bean&gt;\n\n        &lt;bean id=\"jpaVendorAdapter\"\n            class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n\n            &lt;property name=\"database\" value=\"SQL_SERVER\" /&gt;\n            &lt;property name=\"showSql\" value=\"false\" /&gt;\n            &lt;property name=\"generateDdl\" value=\"false\" /&gt;\n            &lt;property name=\"databasePlatform\" value=\"org.hibernate.dialect.SQLServerDialect\" /&gt;\n        &lt;/bean&gt;\n\n        &lt;bean id=\"validator\"\n            class=\"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean\" /&gt;\n\n        &lt;bean id=\"auditLog\" class=\"ca.utoronto.med.dc.focus.persistence.audit.AuditLog\" /&gt;\n\n        &lt;bean\n            class=\"org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor\" /&gt;\n\n    &lt;!-- focus: Edit the package name below. --&gt;\n        &lt;bean id=\"logoutHandlerBean\"\n            class=\"ca.utoronto.med.dc.focus.security.LogoutSuccessHandlerImpl\" /&gt;\n\n        &lt;bean id=\"customAuthenticationFailureHandlerBean\"\n            class=\"ca.utoronto.med.dc.focus.security.AuthenticationFailureHandlerImpl\" /&gt;\n\n        &lt;bean id=\"customAuthenticationSuccessHandlerBean\"\n            class=\"ca.utoronto.med.dc.focus.security.AuthenticationSuccessHandlerImpl\" /&gt;\n\n        &lt;bean id=\"httpSessionEventListener\"\n            class=\"ca.utoronto.med.dc.focus.security.SimpleHttpSessionEventListenerImpl\" /&gt;\n\n        &lt;mvc:annotation-driven /&gt;\n        &lt;task:annotation-driven /&gt;\n        &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n        &lt;context:component-scan base-package=\"ca.utoronto.med.dc.*\" /&gt;\n\n    &lt;!-- Uncomment the following section to enable Aspects --&gt;\n    &lt;!-- &lt;aop:aspectj-autoproxy /&gt; \n        &lt;bean id=\"authorizationMgr\" class=\"ca.utoronto.med.dc.focus.aspect.AuthorizationMgr\" /&gt;\n    --&gt; \n\n        &lt;context:annotation-config\n            transaction-manager=\"transactionManager\" proxy-target-class=\"false\" /&gt;\n\n        &lt;util:properties id=\"projectProperties\" location=\"/WEB-INF/focus.properties\" /&gt;\n\n        &lt;!--Bean to load properties file --&gt;\n        &lt;bean id=\"placeholderConfig\"\n            class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n            &lt;property name=\"location\" value=\"/WEB-INF/focus.properties\" /&gt;\n        &lt;/bean&gt;\n\n        &lt;!-- mail --&gt;\n    &lt;!-- &lt;bean id=\"mailSender\" class=\"org.springframework.mail.javamail.JavaMailSenderImpl\"&gt;        \n            &lt;property name=\"host\" value=\"${mailserver.host}\" /&gt;\n            &lt;property name=\"port\" value=\"${mailserver.port}\" /&gt;\n            &lt;property name=\"username\" value=\"${mailserver.username}\" /&gt;\n            &lt;property name=\"password\" value=\"${mailserver.password}\" /&gt;\n        &lt;/bean&gt; --&gt;\n\n        &lt;!-- Configure the multipart resolver --&gt;\n        &lt;bean id=\"multipartResolver\" class=\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"&gt;\n\n            &lt;!-- one of the properties available; the maximum file size in bytes --&gt;\n            &lt;property name=\"maxUploadSize\" value=\"1000000\"/&gt;\n\n        &lt;/bean&gt;\n\n    &lt;/beans&gt;\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13250764,"title":"session.persist() method confusion","body":"<p>I read this in doc:</p>\n\n<p><code>persist() also guarantees that it will not execute an INSERT statement if it is called outside of transaction boundaries.</code></p>\n\n<p>But when I try this code:</p>\n\n<pre><code>SessionFactory sessionFactory = new Configuration().configure(\"student.cfg.xml\").buildSessionFactory();\n    Session session = sessionFactory.openSession();\n    Student student = new Student();\n    student.setFirstName(\"XXX\");\n    student.setLastName(\"YYY\");\n    student.setCity(\"ZZZ\");\n    student.setState(\"PPP\");\n    student.setCountry(\"XXX\");\n    student.setId(\"NNN\");\n    session.persist(student);       \n    session.flush();\n    session.close();\n</code></pre>\n\n<p>The record is getting inserted. As you can see in the above code, I have not used any transaction. Then in that case according to the doc, the data should not be inserted in the DB right?</p>\n\n<p>Transaction boundaries means any operation between <code>Transaction tran = session.beginTransaction();</code> and <code>tran.commit();</code> right?</p>\n\n<p>Please let me know where am I making the mistake.</p>\n\n<p>Regards,</p>\n"},{"tags":["java","hibernate","orm"],"answer_count":4,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":10516,"score":10,"question_id":3526556,"title":"session.connection() deprecated on Hibernate?","body":"<p>We need to be able to get the associated <code>java.sql.Connection</code> of a hibernate session. No other connection will work, as this connection may be associated with a running transaction. </p>\n\n<p>If session.connection() is now deprecated, how am I supposed to do that?</p>\n"},{"tags":["java","database","hibernate","revision","hibernate-envers"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13235093,"title":"Hibernate Envers dont create revisions","body":"<p>I have a problem with hibernate envers. I added the eventlisteners and I added the @Audited Annotation, but when I change the name (or anything else) there are no revisions in the database created. I hope you can help me. </p>\n\n<p>This is the Main class where I build the session etc.</p>\n\n<pre><code>import org.hibernate.Session;\nimport org.hibernate.SessionFactory;\nimport org.hibernate.cfg.Configuration;\nimport org.hibernate.service.ServiceRegistry;\nimport org.hibernate.service.ServiceRegistryBuilder;\n\npublic class Main {\n\n    public static void main(String[] args) {\n        new Main();\n    }\n\n    public Main() {\n\n        Configuration configuration = new Configuration().configure();\n        ServiceRegistryBuilder registry = new ServiceRegistryBuilder();\n        registry.applySettings(configuration.getProperties());\n        ServiceRegistry serviceRegistry = registry.buildServiceRegistry();\n        SessionFactory sessionFactory = configuration\n                .buildSessionFactory(serviceRegistry);\n        Session session = sessionFactory.openSession();\n\n        Address address1 = new Address();\n        address1.setStreetName(\"Privet Drive\");\n        address1.setHouseNumber(4);\n        Person person1 = new Person();\n\n\n        person1.setName(\"Hi\");\n        person1.setSurname(\"test\");\n        person1.setAddress(address1);\n\n        session.beginTransaction();\n        session.persist(person1);\n        session.persist(address1);\n        session.getTransaction().commit();\n\n        person1.setName(\"Hans\");\n\n        session.beginTransaction();\n        session.persist(person1);\n        session.persist(address1);\n        session.getTransaction().commit();\n\n        session.close();\n\n\n    }\n\n}\n</code></pre>\n\n<p>Here the Person class: </p>\n\n<pre><code>package Main;\n\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.ManyToOne;\nimport javax.persistence.Table;\n\nimport org.hibernate.envers.Audited;\nimport org.hibernate.envers.RevisionEntity;\nimport org.hibernate.envers.RevisionNumber;\nimport org.hibernate.envers.RevisionTimestamp;\n\n@Entity\n@Table(name=\"PERSON\")\n@Audited\npublic class Person{\n    @Id\n    @GeneratedValue\n    @RevisionNumber\n    private int id;\n\n    private String name;\n\n    private String surname;\n\n    private String username;\n\n    @ManyToOne\n    private Address address;\n\n    public int getId() {\n        return id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public String getSurname() {\n        return surname;\n    }\n\n    public Address getAddress() {\n        return address;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public void setSurname(String surname) {\n        this.surname = surname;\n    }\n\n    public void setAddress(Address address) {\n        this.address = address;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n}\n</code></pre>\n\n<p>The adress:</p>\n\n<pre><code>package Main;\n\nimport java.util.Set;\n\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.OneToMany;\nimport javax.persistence.Table;\n\nimport org.hibernate.envers.Audited;\n\n@Entity\n@Table(name=\"ADDRESS\")\n@Audited\npublic class Address {\n    @Id\n    @GeneratedValue\n    private int id;\n\n    private String streetName;\n\n    private Integer houseNumber;\n\n    private Integer flatNumber;\n\n    @OneToMany(mappedBy = \"address\")\n    private Set&lt;Person&gt; persons;\n\n    public int getId() {\n        return id;\n    }\n\n    public String getStreetName() {\n        return streetName;\n    }\n\n    public Integer getHouseNumber() {\n        return houseNumber;\n    }\n\n    public Integer getFlatNumber() {\n        return flatNumber;\n    }\n\n    public Set&lt;Person&gt; getPersons() {\n        return persons;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public void setStreetName(String streetName) {\n        this.streetName = streetName;\n    }\n\n    public void setHouseNumber(Integer houseNumber) {\n        this.houseNumber = houseNumber;\n    }\n\n    public void setFlatNumber(Integer flatNumber) {\n        this.flatNumber = flatNumber;\n    }\n\n    public void setPersons(Set&lt;Person&gt; persons) {\n        this.persons = persons;\n    }\n\n\n}\n</code></pre>\n\n<p>And my hibernate.cfg.xml: </p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD//EN\"\n\"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;\n            jdbc:mysql://localhost:3306/hwdb2&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;&lt;/property&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"format_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n        &lt;property name=\"hbm2ddl.auto\"&gt;create&lt;/property&gt;\n\n        &lt;property name=\"hibernate.ejb.event.post-insert\"&gt;org.hibernate.ejb.event.EJB3PostInsertEventListener,org.hibernate.envers.event.AuditEventListener&lt;/property&gt;\n        &lt;property name=\"hibernate.ejb.event.post-update\"&gt;org.hibernate.ejb.event.EJB3PostUpdateEventListener,org.hibernate.envers.event.AuditEventListener&lt;/property&gt;\n        &lt;property name=\"hibernate.ejb.event.post-delete\"&gt;org.hibernate.ejb.event.EJB3PostDeleteEventListener,org.hibernate.envers.event.AuditEventListener&lt;/property&gt;\n        &lt;property name=\"hibernate.ejb.event.pre-collection-update\"&gt;org.hibernate.envers.event.AuditEventListener&lt;/property&gt;\n        &lt;property name=\"hibernate.ejb.event.pre-collection-remove\"&gt;org.hibernate.envers.event.AuditEventListener&lt;/property&gt;\n        &lt;property name=\"hibernate.ejb.event.post-collection-recreate\"&gt;org.hibernate.envers.event.AuditEventListener&lt;/property&gt;\n\n\n        &lt;!-- Mapping files --&gt;\n        &lt;mapping class=\"Main.Person\" /&gt;\n        &lt;mapping class=\"Main.Address\" /&gt;\n        &lt;mapping class=\"Main.ExampleListener\" /&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>I hope you have a solution for me. Many thanks!</p>\n"},{"tags":["java","hibernate","jpa","drools"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13230374,"title":"Why multiple task is not coming in my drools application?","body":"<p>I am trying to make a drools application which is based on spring mvc and hibernate.</p>\n\n<pre><code>EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"org.drools.task\");   \nEnvironment env = KnowledgeBaseFactory.newEnvironment();\nenv.set(EnvironmentName.ENTITY_MANAGER_FACTORY, emf);\nTaskService taskService = new TaskService(emf, systemEventListener);\n\nTaskServiceSession taskSession = taskService.createSession();\ntaskSession.addUser(new User(\"Administrator\"));\ntaskSession.addUser(new User(\"Myuser\"));// can be set to logged in user at runtime\n\nMinaTaskServer server = new MinaTaskServer(taskService);\nThread thread = new Thread(server);\nthread.start();\n\nksession.getWorkItemManager().registerWorkItemHandler(\"Log\",humanTaskHandler);\nksession.getWorkItemManager().registerWorkItemHandler(\"Human Task\", wsHumanTaskHandler);\n\n KnowledgeRuntimeLogger logger = KnowledgeRuntimeLoggerFactory.newFileLogger(ksession, \"test\");\n// start a new process instance\nksession.startProcess(\"HumanTaskSample\");\n</code></pre>\n\n<p>What does <code>createEntityManagerFactory</code> does? \nDoes it drop all my tables from the db and create a new one every time?</p>\n\n<p>Because in my task table , everytime it contains only one rows?</p>\n\n<p>Why??</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","mysql","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13248737,"title":"Java Hibernate constant in sql-query","body":"<p>Below is the original content of a hibernate sql query I have:</p>\n\n<pre><code>&lt;sql-query name=\"countryOfOrigin-limit-country-city-location\"&gt;\n&lt;return alias=\"rb\" class=\"RecentBooking\"/&gt;\n    SELECT \n        bb.reserv_num as {rb.reservNum}, \n        bb.origin as {rb.countryOfOrigin}, \n        bb.pick_up_loc as {rb.locationId}, \n        bb.first_date as {rb.bookingDate}, \n        bb.pick_up_time as {rb.pickUpDate}, \n        bb.drop_off_time as {rb.dropOffDate},  \n        bb.car_price as {rb.carPrice}, \n        bb.discount as {rb.discount}, \n        bb.exchange_rate as {rb.exchangeRate},\n        SUBSTRING(a.internal_class,1,1)as {rb.carClass},\n        a.car_type as {rb.carType}, \n        bb.vehicle_type as {rb.vehicleType}, \n        s.name as {rb.supplier}, \n        vv.country as {rb.country}, \n        vv.city as {rb.city}, \n        vv.location as {rb.location}, \n        bb.cur as {rb.currency}, \n        a.pics as {rb.carImage}\n    FROM (SELECT * FROM b  WHERE first_date &gt; DATE(NOW()-1)AS bb  \n    JOIN a a ON a.id = bb.car_id\n    JOIN d  d ON d.id = bb.pick_up_loc\n    JOIN supplier s ON s.id = d.supplier_id\n    JOIN v_location_trans vv ON vv.location_id = d.location_id\n    AND vv.lang=33\n    AND vv.country = :country\n    AND vv.city = :city\n    AND vv.location = :location\n    AND bb.origin = :countryOfOrigin\n    ORDER BY bb.id DESC\n    LIMIT :limit\n&lt;/sql-query&gt;\n</code></pre>\n\n<p>The sql runs fast enough, but as you might have noticed there is a big, the NOW()-1 should be NOW() - INTERVAL 1 DAY.</p>\n\n<p>I modified the nested select statement as follows:</p>\n\n<pre><code>FROM (SELECT * FROM b WHERE first_date &gt; DATE(NOW() - INTERVAL 1 DAY)) AS bb\n</code></pre>\n\n<p>The fix works fine in terms of results, however the query slows down massively (pretty much almost instant up to a few seconds).</p>\n\n<p>I believe this is because the DATE(NOW() - INTERVAL 1 DAY) is being evaluated a large number of times (we have a very large data set). How would I go about seperating this calculation so that it only occurs once, without having to pass it in from java code like the country, city, limit, etc?</p>\n\n<p>I have very little experience with hibernate or SQL, and I have tried seperating the calculation out into a variable before the select statement, which isnt allowed. I have also tried making small changes to the SQL query but I keep getting runtime errors, presumably due to invalid SQL.</p>\n\n<p>How would I go about doing this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","sql","hibernate","netbeans"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13247006,"title":"Error in HIbernate Querying Language","body":"<p>I am pretty new to Hibernate based Application Developing.\nRecently i run the same code(which is shown in the below) in Eclipse Juno IDE. It works fine.\nBut when coming to Netbeans it doesn't work.And it shows the error as </p>\n\n<blockquote>\n  <p>SEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='username'' at line 1</p>\n</blockquote>\n\n<p>Here Iam using the Mysql 5.5,IDE-NetBeans-7.2.1.</p>\n\n<p>Here the code i am executing is,</p>\n\n<p>Hibernate.cfg.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt;\n    &lt;mapping resource=\"hibernatefiles/Users.hbm.xml\"/&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Hibernating Mapping File:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Nov 6, 2012 12:42:42 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"hibernatefiles.Users\" table=\"users\" catalog=\"OFFICE MANAGER\"&gt;\n        &lt;id name=\"uid\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"Uid\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"uname\" type=\"string\"&gt;\n            &lt;column name=\"uname\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"upass\" type=\"string\"&gt;\n            &lt;column name=\"upass\" length=\"30\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"ename\" type=\"string\"&gt;\n            &lt;column name=\"ename\" length=\"100\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"edesg\" type=\"string\"&gt;\n            &lt;column name=\"edesg\" length=\"100\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"contactnumber\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"contactnumber\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Users.java(POJO File)</p>\n\n<pre><code>package hibernatefiles;\npublic class Users  implements java.io.Serializable {\n\n\n     private Integer uid;\n     private String uname;\n     private String upass;\n     private String ename;\n     private String edesg;\n     private Integer contactnumber;\n\n    public Users() {\n    }\n\n    public Users(String uname, String upass, String ename, String edesg, Integer contactnumber) {\n       this.uname = uname;\n       this.upass = upass;\n       this.ename = ename;\n       this.edesg = edesg;\n       this.contactnumber = contactnumber;\n    }\n\n    public Integer getUid() {\n        return this.uid;\n    }\n\n    public void setUid(Integer uid) {\n        this.uid = uid;\n    }\n    public String getUname() {\n        return this.uname;\n    }\n\n    public void setUname(String uname) {\n        this.uname = uname;\n    }\n    public String getUpass() {\n        return this.upass;\n    }\n\n    public void setUpass(String upass) {\n        this.upass = upass;\n    }\n    public String getEname() {\n        return this.ename;\n    }\n\n    public void setEname(String ename) {\n        this.ename = ename;\n    }\n    public String getEdesg() {\n        return this.edesg;\n    }\n\n    public void setEdesg(String edesg) {\n        this.edesg = edesg;\n    }\n    public Integer getContactnumber() {\n        return this.contactnumber;\n    }\n\n    public void setContactnumber(Integer contactnumber) {\n        this.contactnumber = contactnumber;\n    }\n\n}\n</code></pre>\n\n<p>I am Executing the HQL in the below JSP File by using Query Class.</p>\n\n<pre><code>&lt;%@page import=\"hibernatefiles.Users\"%&gt;\n&lt;%@page import=\"java.util.Iterator\"%&gt;\n&lt;%@page import=\"org.hibernate.Query\"%&gt;\n&lt;%@page import=\"org.hibernate.Session\"%&gt;\n&lt;%@page import=\"org.hibernate.Transaction\"%&gt;\n&lt;%\n    String user_id = request.getParameter(\"uid\");\n    String u_pass = request.getParameter(\"upass\");\n    out.println(\"got it dude we get the details...\"+user_id+\"\\n\"+u_pass);\n\n    //writing the hibernate code\n\n    Transaction transaction;\n\n    Session ses = hibernatefiles.NewHibernateUtil.getSessionFactory().openSession();\n    try{\n             transaction = ses.beginTransaction();\n             String HQL = \"FROM Users u WHERE u.uname='\"+user_id+\"'\";\n             Query query = ses.createQuery(HQL);\n            java.util.List li = query.list();\n            Iterator itera = li.iterator();\n            while(itera.hasNext()){\n        //getting record\n                Users u= (Users) itera.next();\n        out.println(\"user name is:\"+u.getUname());\n                out.println(\"user password is :\"+u.getUpass());         \n\n            }\n\n    }\n    catch(Exception error){\n        error.printStackTrace();\n\n    }\n\n%&gt;\n</code></pre>\n\n<p>Here NetBeans Log</p>\n\n<pre><code>Nov 06, 2012 2:31:27 PM org.apache.catalina.core.StandardContext reload\nINFO: Reloading Context with name [/Office_Manager] is completed\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.annotations.Version &lt;clinit&gt;\nINFO: Hibernate Annotations 3.3.1.GA\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: Hibernate 3.2.5\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: hibernate.properties not found\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: Bytecode provider name : cglib\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: using JDK 1.4 java.sql.Timestamp handling\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration configure\nINFO: configuring from resource: /hibernate.cfg.xml\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration getConfigurationInputStream\nINFO: Configuration resource: /hibernate.cfg.xml\nNov 06, 2012 2:31:45 PM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : hibernatefiles/Users.hbm.xml\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.Configuration doConfigure\nINFO: Configured SessionFactory: null\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nINFO: Mapping class: hibernatefiles.Users -&gt; users\nNov 06, 2012 2:31:46 PM org.hibernate.cfg.AnnotationConfiguration secondPassCompile\nINFO: Hibernate Validator not found: ignoring\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: Using Hibernate built-in connection pool (not for production use!)\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: Hibernate connection pool size: 20\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: autocommit mode: false\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: using driver: com.mysql.jdbc.Driver at URL: jdbc:mysql://localhost:3306/office manager?zeroDateTimeBehavior=convertToNull\nNov 06, 2012 2:31:46 PM org.hibernate.connection.DriverManagerConnectionProvider configure\nINFO: connection properties: {user=root, password=****}\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: RDBMS: MySQL, version: 5.5.25a\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC driver: MySQL-AB JDBC Driver, version: mysql-connector-java-5.1.18 ( Revision: tonci.grgin@oracle.com-20110930151701-jfj14ddfq48ifkfq )\nNov 06, 2012 2:31:47 PM org.hibernate.dialect.Dialect &lt;init&gt;\nINFO: Using dialect: org.hibernate.dialect.MySQLDialect\nNov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionFactoryFactory buildTransactionFactory\nINFO: Using default transaction strategy (direct JDBC transactions)\nNov 06, 2012 2:31:47 PM org.hibernate.transaction.TransactionManagerLookupFactory getTransactionManagerLookup\nINFO: No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Automatic flush during beforeCompletion(): disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Automatic session close at end of transaction: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC batch size: 15\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC batch updates for versioned data: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Scrollable result sets: enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JDBC3 getGeneratedKeys(): enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Connection release mode: auto\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Maximum outer join fetch depth: 2\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Default batch fetch size: 1\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Generate SQL with comments: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Order SQL updates by primary key: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Order SQL inserts for batching: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createQueryTranslatorFactory\nINFO: Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory\nNov 06, 2012 2:31:47 PM org.hibernate.hql.ast.ASTQueryTranslatorFactory &lt;init&gt;\nINFO: Using ASTQueryTranslatorFactory\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Query language substitutions: {}\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: JPA-QL strict compliance: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Second-level cache: enabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Query cache: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory createCacheProvider\nINFO: Cache provider: org.hibernate.cache.NoCacheProvider\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Optimize cache for minimal puts: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Structured second-level cache entries: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Echoing all SQL to stdout\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Statistics: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Deleted entity synthetic identifier rollback: disabled\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Default entity-mode: pojo\nNov 06, 2012 2:31:47 PM org.hibernate.cfg.SettingsFactory buildSettings\nINFO: Named query checking : enabled\nNov 06, 2012 2:31:47 PM org.hibernate.impl.SessionFactoryImpl &lt;init&gt;\nINFO: building session factory\nNov 06, 2012 2:31:48 PM org.hibernate.impl.SessionFactoryObjectFactory addInstance\nINFO: Not binding factory to JNDI, no JNDI name configured\nNov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nWARNING: SQL Error: 1064, SQLState: 42000\nNov 06, 2012 2:31:48 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nSEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1\norg.hibernate.exception.SQLGrammarException: could not execute query\nHibernate: \n    select\n        users0_.Uid as Uid0_,\n        users0_.uname as uname0_,\n        users0_.upass as upass0_,\n        users0_.ename as ename0_,\n        users0_.edesg as edesg0_,\n        users0_.contactnumber as contactn6_0_ \n    from\n        OFFICE MANAGER.users users0_ \n    where\n        users0_.uname='manikanta'\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.doList(Loader.java:2223)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\n    at org.hibernate.loader.Loader.list(Loader.java:2099)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)\n    at org.apache.jsp.Employers.checking_jsp._jspService(checking_jsp.java:88)\n    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)\n    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)\n    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '.users users0_ where users0_.uname='manikanta'' at line 1\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n    at com.mysql.jdbc.Util.getInstance(Util.java:386)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)\n    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2293)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n    at org.hibernate.loader.Loader.doList(Loader.java:2220)\n    ... 33 more\n</code></pre>\n"},{"tags":["hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":165,"score":0,"question_id":10798754,"title":"Theta Style Left Outer Join in HQL","body":"<p>I have the following SQL query that I am attempting to convert to HQL. Unfortunately, outer joins have never been my favorite to deal with.</p>\n\n<pre><code>SELECT DISTINCT T_EMPLOYEE.SSN,   \n     T_EMPLOYEE.TRANSACTION_ID,   \n     T_EMPLOYEE.NAME,   \n     T_EMPLOYEE.CANCEL_DATE,   \n     T_EMPLOYEE.CAN_USERID,   \n     T_DEPARTMENT.LOC FROM T_EMPLOYEE,   \n     T_DEPARTMENT  \nWHERE ( T_EMPLOYEE.DEPARTMENT_CODE = T_DEPARTMENT.CODE (+)) and  \n     ( ( T_EMPLOYEE.SSN = :s_ssn ) )  \n</code></pre>\n\n<p>I know the (+) symbol on the right of the where is Oracle's old style outer join sequence (and since it's on the right its a left outer join). There is also no foreign key relationship between T_EMPLOYEE and T_DEPARTMENT (legacy database).</p>\n\n<p>Two questions:\n1. Is a theta-style (i.e. using =) outer join possible in HQL without the foreign key relationship?\n2. If so, can someone help me convert this to HQL?</p>\n\n<p>Jason</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13245886,"title":"How do I rollback transactions in multiple classes?","body":"<p>I have two classes, ServiceA and ServiceB, both which have methods calling the database</p>\n\n<p>in ServiceA i have the following code </p>\n\n<pre><code>public void updateData() {\n//some database updates\nserviceB.addDetails();\n//some more database updates\n}\n</code></pre>\n\n<p>here is my configuration in applicationContext for both the classes</p>\n\n<pre><code>&lt;bean id=\"serviceATarget\" class=\"com.company.service.ServiceA\"&gt;\n    &lt;property name=\"serviceB\" ref=\"serviceB\" /&gt;\n    &lt;property name=\"serviceADAO\" ref=\"serviceADAO\" /&gt;\n&lt;/bean&gt;\n&lt;bean id=\"serviceA\" class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\" ref=\"transactionManager\" /&gt;\n    &lt;property name=\"target\" ref=\"serviceATarget\" /&gt;\n    &lt;property name=\"transactionAttributes\"&gt;\n    &lt;props&gt;\n        &lt;prop key=\"update*\"&gt;PROPAGATION_REQUIRED,-Exception&lt;/prop&gt;\n    &lt;/props&gt;\n&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"serviceBTarget\" class=\"com.company.service.serviceB\"&gt;\n    &lt;property name=\"serviceBDAO\" ref=\"serviceBDAO\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"serviceB\" class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\" ref=\"transactionManager\" /&gt;\n    &lt;property name=\"target\" ref=\"serviceBTarget\" /&gt;\n    &lt;property name=\"transactionAttributes\"&gt;\n    &lt;props&gt;\n    &lt;prop key=\"add*\"&gt;PROPAGATION_REQUIRED,-Exception&lt;/prop&gt;\n    &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>The issue is that in ServiceA, if an exception occurs after the \"//some more database updates\" section, the updates made in <code>serviceB.addDetails()</code> are not being rolled back. </p>\n\n<p>Help would be appreciated. Thanks. </p>\n"},{"tags":["java","hibernate","postgresql","jpa","jpa-2.0"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1780,"score":5,"question_id":5249004,"title":"Triggers vs. JPA @PrePersist for creation and update timestamps pros and cons","body":"<p>I am building a new web app and I am using Spring, JPA/Hibernate, and Postgres. Some of my tables have creation_ts and lastupdate_ts columns which are timestamp columns that track when an insert occurred and when the last update occurred on a row.</p>\n\n<p>I am also using a naming convention for columns in my tables so as a matter of design policy every table is guaranteed to have two columns pkey which is an integer surrogate key, and version for optimistic locking.</p>\n\n<p>I have two ways to keep these fields up to date.</p>\n\n<p><strong>Option A: use triggers</strong> </p>\n\n<p>This is the solution I have in place right now, I have two Postgres trigger that fire on insert and update and will keep these fields up to date. and I have two classes. </p>\n\n<pre><code>@MappedSuperclass\npublic abstract class PersistableObject\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name=\"pkey\")\n    private Integer pkey;\n\n    @Version\n    @Column(name=\"version\")\n    private Integer version;\n\n    public Integer getPkey()\n    {\n        return this.pkey;\n    }\n\n    public Integer getVersion()\n    {\n        return this.version;\n    }\n}\n</code></pre>\n\n<p>and I have </p>\n\n<pre><code>@MappedSuperclass\npublic class TimeStampedPersistableObject extends PersistableObject {\n\n    @Column(name = \"creation_ts\")\n    @Temporal(TemporalType.DATE)\n    @org.hibernate.annotations.Generated(value = GenerationTime.INSERT)\n    private Date    creationTimestamp;\n\n    @Column(name = \"update_ts\")\n    @Temporal(TemporalType.DATE)\n    @org.hibernate.annotations.Generated(value = GenerationTime.ALWAYS)\n    private Date    updateTimestamp;\n\n    public Date getCreationTimestamp()\n    {\n        return this.creationTimestamp;\n    }\n\n    public Date getUpdateTimestamp()\n    {\n        return this.updateTimestamp;\n    }\n}\n</code></pre>\n\n<p><strong>Option B: Use JPA listeners</strong> </p>\n\n<p>In this option I would use JPA listeners to keep to timestamp columns up-to-date. </p>\n\n<p><strong>My Question:</strong></p>\n\n<p>Which of those two approaches is better? As I see things here is my personal list of pros and cons of each option and I very interested from hearing the experience of others with these two choices. </p>\n\n<p>Option A pros:</p>\n\n<ol>\n<li>Database is doing the updates with the triggers so there is no danger of having clock skew in the cluster running the web app. </li>\n<li>If a non-JPA application accesses the database the requirement to keep those two columns is enforced.</li>\n</ol>\n\n<p>Option A cons:</p>\n\n<ol>\n<li>Have to do a select after the insert and update to read the values that the triggers put into place.</li>\n<li>I am using hibernate annotations to read back the values</li>\n</ol>\n\n<p>Option B pros:</p>\n\n<ol>\n<li>Less typing when creating the DDL</li>\n<li>No need to read back values from the database after insert and update</li>\n<li>Pure JPA annotations no hibernate specific annotations</li>\n</ol>\n\n<p>Option B cons:</p>\n\n<ol>\n<li>Danger of clock skew in the cluster</li>\n<li>Fields set whenever the JPA provider decides to call the callback methods not predictable </li>\n</ol>\n\n<p>How you would solve this problem for a new app where you have total control over the database and the java code.</p>\n"},{"tags":["java","hibernate","orm","nhibernate-mapping"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":8927,"score":6,"question_id":1126029,"title":"How to map a set of enum type in Hibernate?","body":"<p>In hibernate, is it possible to define a mapping for a class to a set of enums?  </p>\n\n<p>I've been able to find examples of how to define mappings of Sets and I've been able to find separate examples for how to map Enums, but I cannot figure out how to define a  of Enums for a class.</p>\n\n<p>Could anyone please provide me with an example?  </p>\n\n<p>This is being built on top of an existing application, so I cannot alter the database schema. </p>\n\n<p>This is the relation I wish to model.  Wicket is a normal class and WicketType is a Java Enum.</p>\n\n<pre><code>+----------------+    +------------+    +------------+\n| Wicket         |    | Ref Table  |    | WicketType |\n+----------------+    +------------+    +------------+\n| INT     | W_ID |    |            |    | W_TypeId   |\n| ....    |      | FK | W_ID       | FK | WicketType |\n| INT     | TYPE |----| W_TypeId   |----|            |\n+----------------+    +------------+    +------------+\n</code></pre>\n\n<p>Thanks again</p>\n"},{"tags":["hibernate","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13245684,"title":"Hibernate Query cache understanding","body":"<p>I have gont through lot of materials but I am not able to clear one doubt for hibernate second level cache. </p>\n\n<p>1) Lets say, I have a query which returns 1000 records. (for eg, from employee where age>30).\nI have made the query as cacheable. In the meantime the number of records have increased and now the results should be 2000 for the same query.Now next time when I execute the same query, how hibernate fetches the records from cache. Does it fetches only the new records?</p>\n\n<p>2) Scenario 2. Lets say I execute the query(for eg, from employee where age>30). I got records of 1000. Now the records are updated internally. Again I execute the same query. In this case how hibernate fetches?</p>\n"},{"tags":["java","hibernate","google-app-engine","jpa","datanucleus"],"answer_count":5,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":4473,"score":9,"question_id":2523220,"title":"Can Hibernate be used as the JPA provider in Google App Engine","body":"<p>Can <a href=\"http://repository.jboss.org/maven2/org/hibernate/hibernate-core/3.5.0-CR-2/\" rel=\"nofollow\">Hibernate 3.5.x</a> be used as the JPA provider instead of the default provider in the latest version of Google App Engine (1.3.2)</p>\n"},{"tags":["java","hibernate","gwt","jpa"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2695,"score":0,"question_id":5641690,"title":"One to Many relationship JPA/Hibernate removing links","body":"<p>I have bidirectional relationship setup as follows:</p>\n\n<pre><code>class Child{\n    @ManyToOne\n    @JoinTable(name = \"CHILDREN_WITH_PARENT\", \n            joinColumns = {@JoinColumn(name = \"CHILD_ID\")}, \n            inverseJoinColumns = {@JoinColumn(name = \"PARENT_ID\")}\n    )\n    private Parent parent;\n}\n\nclass Parent{\n    @OneToMany(mappedBy=\"parent\", cascade=CascadeType.ALL)\n    Set&lt;Child&gt; childrens = new HashSet&lt;Child&gt;();\n\n    public void persistOrMerge() {\n        EntityManager em = entityManager();\n        em.getTransaction().begin();\n        try {\n            if (em.contains(this))\n                return;\n            if (id == null || id == 0) {\n                this.setCreatedDate(new Date());\n                em.persist(this);\n            } else {\n                Parent prev = em.find(Parent.class, this.id);\n                if (prev == null) {\n                    em.persist(this);\n                } else{\n                    this.setCreatedDate(new Date());\n                    em.merge(this);\n                }\n            }\n            em.flush();\n            em.getTransaction().commit();\n\n        }  finally {\n            em.close();\n\n        }\n    }\n\n}\n</code></pre>\n\n<p>On my client side I have following code (GWT + EntityProxy)</p>\n\n<pre><code>Set&lt;ChildProxy&gt; children  = new HashSet&lt;ChildProxy&gt;();\nif(childIsNew)\n   child = request.create(Children.class)\nelse\n   child = request.edit(oldChild)\nchildren.add(child);\n//If children are deleted, they are not contained in the set\n//we are sending back to server\nparent.setChildren(children)\nparent.persistOrMerge();\n</code></pre>\n\n<p><strong>This code only works for adding new children. Removing of children from parent does not work even if parent class receives an empty children set. The linkages in JOIN table are not removed.</strong></p>\n\n<p>Can you please tell where I am missing something?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","json","spring","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13244039,"title":"Cycle in Hibernate OneToMany relation","body":"<p>I use Hibernate and </p>\n\n<p>have two entities(City and Region) with OneToMany relation.</p>\n\n<p>the First:</p>\n\n<pre><code> @Entity\n @Table(name = \"p_region\")\n public class Region implements Serializable{\n\n@OneToMany(mappedBy = \"region\",fetch= FetchType.LAZY,  cascade = CascadeType.MERGE)\nprivate List&lt;City&gt; citys;\n\nprivate static final long serialVersionUID = 1L;\n@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate Integer id;\n\n\nprivate String name;\n\n//++++++++++++++++++++ GETSET\n\npublic List&lt;City&gt; getCitys() {\n    return citys;\n}\n\npublic void setCitys(List&lt;City&gt; citys) {\n    this.citys = citys;\n}\n\npublic Integer getId() {\n    return id;\n}\n\npublic void setId(Integer id) {\n    this.id = id;\n}\n\npublic String getName() {\n    return name;\n}\n\npublic void setName(String name) {\n    this.name = name;\n}\n\n }\n</code></pre>\n\n<p>and the second one:</p>\n\n<pre><code>    @Entity\n    @Table(name = \"p_city\")\n    public class City implements Serializable {\nprivate static final long serialVersionUID = 1L;\n@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate Integer id;\n\n@NotEmpty(message = \"Название не должно быть пустым\")\n@Length(max = 10, min = 2, message = \"Название должно быть менее 2 символов и не \n более 100\")\n     private String cityName;\n\n@NotEmpty(message = \"Код города не должно быть пустым\")\nprivate String cityCode;\n    @Column(name = \"zone\")\n    private Integer zone;\n\n\n@Basic(optional = true)\n@Temporal(javax.persistence.TemporalType.TIMESTAMP)\nprivate Date entryDate = Calendar.getInstance().getTime();\n\n@ManyToOne()\nprivate Region region;\n\n@Basic(optional = true)\nprivate String zip_code;\n\n// GET SET ::::::::::::::::::::::::::::::::::\n    public Integer getZone() {\n    return zone;\n    }\n\n    public void setZone(Integer zone) {\n    this.zone = zone;\n    }\npublic Region getRegion() {\n    return region;\n}\n\npublic void setRegion(Region region) {\n    this.region = region;\n}\n\npublic void delete() {\n    System.out.println(\"QQQQQQQQQQQQQQQQQQQQQQ\");\n}\n\npublic String getCityCode() {\n    return cityCode;\n}\n\npublic void setCityCode(String cityCode) {\n    this.cityCode = cityCode;\n}\n\npublic String getCityName() {\n    return cityName;\n}\n\npublic void setCityName(String cityName) {\n    this.cityName = cityName;\n}\n\npublic Date getEntryDate() {\n    return entryDate;\n}\n\npublic void setEntryDate(Date entryDate) {\n    this.entryDate = entryDate;\n}\n\npublic Integer getId() {\n    return id;\n}\n\npublic void setId(Integer id) {\n    this.id = id;\n}\n\npublic String getZip_code() {\n    return zip_code;\n}\n\npublic void setZip_code(String zip_code) {\n    this.zip_code = zip_code;\n}\n\n     }\n</code></pre>\n\n<p><strong>When I try to get simple Object(City) with JSON it returns the cycle:</strong></p>\n\n<pre><code>     {\"id\":577,\"region\":{\"name\":\"нет региона\",\"id\":15,\"citys\":[{\"id\":577,\"region\":  \n     {\"name\":\"нет региона\",\"id\":15,\"citys\":[{\"id\":577,\"region\":{\"name\":\"нет   \n     региона\",\"id\":15,\"citys\":[{\"id\":577,\"region\":{\"name\":\"нет\n     региона\",\"id\":15,\"citys\":[{\"id\":577,\"region\":{\"name\":\"нет    \n     региона\",\"id\":15,\"citys\":[{\"id\":577,\"region\":{\"name\":\"нет \n     региона\",\"id\":15,\"citys\":[{\"id\":577,\"region\":{\"name\":\"нет......so on.\n</code></pre>\n\n<p><strong>Is there any solutions for this issue?</strong></p>\n"},{"tags":["java","spring","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13234498,"title":"Hibernate Exception When deleting","body":"<p>When i'm trying to delete object it's throwing excption <code>org.springframework.dao.DataIntegrityViolationException: could not delete</code>. </p>\n\n<p>Please verify my classes.</p>\n\n<pre><code>class Address{\n}\n\nclass Location{\n    @OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)\n    private Address address;\n}\n\nclass SupplierLocation{\n\n    @ManyToOne(fetch=FetchType.LAZY)\n    @Cascade( { CascadeType.ALL })\n    private Location locations;\n\n    @ManyToOne(fetch=FetchType.LAZY)\n    private Supplier supplier;\n\n}\n\nLocation location;\n</code></pre>\n\n<p>Which object we need to remove. i'm tried like <code>sess.delete(location)</code>.</p>\n\n<p>Thanks in advance</p>\n\n<p>Best Regards,\nRavi</p>\n"},{"tags":["java","hibernate","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13243263,"title":"How to annotate a PostgreSQL GIN index in Hibernate","body":"<p>How do I properly annotate a PostgreSQL GIN index with Hibernate?</p>\n\n<pre><code>@Index(...)\nString text;\n</code></pre>\n\n<p>Does hibernate create a GIN index by default, or do I have to set a special property somewhere?</p>\n"},{"tags":["hibernate","logging"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":4009,"score":5,"question_id":847041,"title":"How do I change the Hibernate logging level?","body":"<p>How can I change the Hibernate logging level programmatically?</p>\n"},{"tags":["java","hibernate","postgresql","maven"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13242196,"title":"How do you add PostgreSQL Driver as a dependency in Maven?","body":"<p>I'm trying to develop a Java application with Maven while using Hibernate with Postgresql database for persistence. I don't understand how I'm supposed to connect the Postgresql drivers to my application. I get that you add dependencies in Maven's pom.xml file, which finds jars from a remote repository, but what about other jars?</p>\n"},{"tags":["java","hibernate","jpa","class-hierarchy"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13186572,"title":"Retrieve only the superclass from a class hierarchy","body":"<p>I have an scenario as the following:</p>\n\n<pre><code>@Entity\n@Table(name = \"ANIMAL\")\n@Inheritance(strategy = InheritanceType.JOINED)\n\npublic class Animal implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"S_ANIMAL\")\n    @SequenceGenerator(name = \"S_ANIMAL\", sequenceName = \"S_ANIMAL\", allocationSize = 1)\n    public int getNumero() {\n        return numero;\n    }\n\n    public void setNumero(int numero) {\n        this.numero = numero;\n    }\n        .\n        .\n        .\n}\n</code></pre>\n\n<p>and as the subclass:</p>\n\n<pre><code>@Entity\n@Table(name = \"DOG\")\npublic class Dog extends Animal {\n\n    private static final long serialVersionUID = -7341592543130659641L;\n        .\n        .\n        .\n}\n</code></pre>\n\n<p>I have a JPA Select statement like this:</p>\n\n<pre><code>SELECT a FROM Animal a;\n</code></pre>\n\n<p>I'm using Hibernate 3.3.1</p>\n\n<p>As I can see the framework retrieves instances of <code>Animal</code> and also of <code>Dog</code> using a left outer join. </p>\n\n<p>Is there a way to Select only the \"part\" <code>Animal</code>? I mean, the previous <code>Select</code> will get all the <code>Animal</code>s, those that are only <code>Animal</code>s but not <code>Dog</code>s and those that are <code>Dog</code>s.</p>\n\n<p>I want them all, but in the case of <code>Dog</code>s I want to only retrieve the \"Animal part\" of them.</p>\n\n<p>I found the <code>@org.hibernate.annotations.Entity(polymorphism = PolymorphismType.EXPLICIT)</code>\nbut as I could see this only works if Animal isn't an <code>@Entity</code>.</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["java","hibernate","enums"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13191508,"title":"Hibernate unable to save entity with one of the fields as enum","body":"<p>Here is the exception - \n<a href=\"http://pastebin.com/9sNVjeRQ\" rel=\"nofollow\">pastebin</a></p>\n\n<pre><code>Caused by: java.sql.SQLException: Unknown Parameter: 13\n    at com.google.cloud.sql.jdbc.ParameterMetadata.getParameterType(ParameterMetadata.java:45)\n    at org.hibernate.type.EnumType.nullSafeSet(EnumType.java:121)\n    at org.hibernate.type.CustomType.nullSafeSet(CustomType.java:155)\n    at org.hibernate.persister.entity.AbstractEntityPersister.dehydrate(AbstractEntityPersister.java:2705)\n    at org.hibernate.persister.entity.AbstractEntityPersister.dehydrate(AbstractEntityPersister.java:2682)\n    at org.hibernate.persister.entity.AbstractEntityPersister$4.bindValues(AbstractEntityPersister.java:2863)\n    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:57)\n    ... 111 more\n</code></pre>\n\n<p>Enum's in my hibernate mapping - </p>\n\n<pre><code>&lt;property name=\"userStatus\" column=\"user_status\" insert=\"true\" update=\"true\" index=\"true\"&gt;\n  &lt;type name=\"org.hibernate.type.EnumType\"&gt;\n    &lt;param name=\"enumClass\"&gt;com.tutorial.enums.UserStatus&lt;/param&gt;\n    &lt;param name=\"type\"&gt;12&lt;/param&gt;\n  &lt;/type&gt;\n&lt;/property&gt;\n&lt;property name=\"userType\" column=\"user_type\" insert=\"true\" update=\"true\" index=\"true\"&gt;\n  &lt;type name=\"org.hibernate.type.EnumType\"&gt;\n    &lt;param name=\"enumClass\"&gt;com.tutorial.enums.UserType&lt;/param&gt;\n    &lt;param name=\"type\"&gt;12&lt;/param&gt;\n  &lt;/type&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p>My entity has UserType and UserStatus as enums. Hibernate is not able to convert enums properly. Should I switch back to hibernate 3 because in another project(with hibernate 3)I had my own custom type and it was working perfectly fine. I'm right now using hibernate 4.1.7.</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13119656,"title":"Hibernate EnumType instantiation exception","body":"<p>I'm using hibernate 4 and xml based mapping. Here is the exception I'm getting</p>\n\n<pre><code>Caused by: org.hibernate.MappingException: Unable to instantiate custom type: org.hibernate.type.EnumType\n    at org.hibernate.type.TypeFactory.custom(TypeFactory.java:193)\n    at org.hibernate.type.TypeFactory.custom(TypeFactory.java:179)\n    at org.hibernate.type.TypeFactory.byClass(TypeFactory.java:103)\n    at org.hibernate.type.TypeResolver.heuristicType(TypeResolver.java:130)\n    at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:307)\n    at org.hibernate.mapping.SimpleValue.isValid(SimpleValue.java:294)\n    at org.hibernate.mapping.Property.isValid(Property.java:238)\n    at org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:469)\n    at org.hibernate.mapping.RootClass.validate(RootClass.java:270)\n    at org.hibernate.cfg.Configuration.validate(Configuration.java:1294)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1742)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1788)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:189)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:350)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:335)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$6.run(AbstractAutowireCapableBeanFactory.java:1504)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1502)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    ... 35 more\nCaused by: java.lang.NullPointerException\n    at org.hibernate.type.EnumType.setParameterValues(EnumType.java:153)\n    at org.hibernate.type.TypeFactory.injectParameters(TypeFactory.java:131)\n    at org.hibernate.type.TypeFactory.custom(TypeFactory.java:189)\n    ... 53 more\n</code></pre>\n\n<p>And here is the enum mapping that I'm using</p>\n\n<pre><code>&lt;property name=\"coachingStatus\" column=\"status\" update=\"true\" insert=\"true\" index=\"true\"&gt;\n      &lt;type name=\"org.hibernate.type.EnumType\"&gt;\n        &lt;param name=\"enumClass\"&gt;com.tutorial.enums.CoachingStatus&lt;/param&gt;\n        &lt;param name=\"type\"&gt;12&lt;/param&gt;\n      &lt;/type&gt;\n    &lt;/property&gt;\n</code></pre>\n\n<p>And here is the enum:</p>\n\n<pre><code>public enum CoachingStatus {\n  ACTIVE, BLOCKED, PENDING, EXPIRED\n}\n</code></pre>\n\n<p>here is the entity</p>\n\n<pre><code>public class Coaching implements Serializable {\n  private Integer id;\n  private String name;\n  private Long locationId;\n  private Integer organisationId;\n  private Long ownerId;\n  private Date createdOn;\n  private Date modifiedOn;\n  private CoachingStatus coachingStatus;\n  private Long createdBy;\n  private Long modifiedBy;\n  private String email;\n  private String logo;\n  private String about;\n  private String phone;\n... //getters and setters\n}\n</code></pre>\n\n<p>I checked out tutorial from here - <a href=\"http://blog.javachap.com/index.php/enumeration-mapping-in-hibernate/\" rel=\"nofollow\">here</a> but I'm getting above error. Need help with this.</p>\n"},{"tags":["java","mysql","hibernate","genericdao"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13239120,"title":"What's the best way to calling a Stored Procedure using Hibernate in a Generic DAO?","body":"<p>I'm using MySql and my query to call is like:</p>\n\n<pre><code>call SPGetChart (idNumber, nameChart);\n</code></pre>\n"},{"tags":["java","hibernate","spring","dbunit"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4515,"score":2,"question_id":5066201,"title":"org.dbunit.dataset.NoSuchTableException: Did not find table 'xxx' in schema 'null'","body":"<p>I know there have been discussions wrt to dbunit here. I have read most of them but I cant seem to find a solution to my problem.</p>\n\n<p>I have set up hibernate and spring. I am doing TDD so I had to wire up a proper DAO testing framework before writing code. Dbunit came to mind and I got to setting it up. Here is ma testdataset.xml</p>\n\n<pre><code>    &lt;?xml version='1.0' encoding='UTF-8'?&gt;\n    &lt;dataset&gt;\n        &lt;table name=\"status\"&gt;\n            &lt;column&gt;statusId&lt;/column&gt;\n            &lt;column&gt;status&lt;/column&gt;\n            &lt;row&gt;\n                &lt;value&gt;0&lt;/value&gt;\n                &lt;value&gt;Available&lt;/value&gt;\n            &lt;/row&gt;\n        &lt;/table&gt;\n        &lt;table name=\"user\"&gt;\n            &lt;column&gt;userId&lt;/column&gt;\n            &lt;column&gt;firstName&lt;/column&gt;\n            &lt;column&gt;lastName&lt;/column&gt;\n            &lt;column&gt;username&lt;/column&gt;\n            &lt;column&gt;password&lt;/column&gt;\n            &lt;column&gt;email&lt;/column&gt;\n            &lt;row&gt;\n                &lt;value&gt;0&lt;/value&gt;\n                &lt;value&gt;system&lt;/value&gt;\n                &lt;value&gt;admin&lt;/value&gt;\n                &lt;value&gt;admin&lt;/value&gt;\n                &lt;value&gt;admin&lt;/value&gt;\n                &lt;value&gt;admin@ccbs.com&lt;/value&gt;\n            &lt;/row&gt;\n        &lt;/table&gt;\n        &lt;table name=\"reservation\"&gt;\n            &lt;column&gt;reservationId&lt;/column&gt;\n            &lt;column&gt;userId&lt;/column&gt;\n            &lt;column&gt;reservationDate&lt;/column&gt;\n            &lt;column&gt;startDate&lt;/column&gt;\n            &lt;column&gt;endDate&lt;/column&gt;\n            &lt;column&gt;statusId&lt;/column&gt;\n            &lt;row&gt;\n                &lt;value&gt;0&lt;/value&gt;\n                &lt;value&gt;0&lt;/value&gt;\n                &lt;value&gt;2011-02-20 12:46:00.0&lt;/value&gt;\n                &lt;value&gt;2011-03-01 12:00:00.0&lt;/value&gt;\n                &lt;value&gt;2011-04-01 12:00:00.0&lt;/value&gt;\n                &lt;value&gt;0&lt;/value&gt;\n            &lt;/row&gt;\n        &lt;/table&gt;\n    &lt;/dataset&gt;\n</code></pre>\n\n<p>All seems well until i try to wire up some code using a base class that loads the dataset. Here is my code:</p>\n\n<pre><code>@Transactional\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = { \"classpath:test-applicationContext.xml\" })\n@TransactionConfiguration(transactionManager = \"transactionManager\", defaultRollback = true)\npublic class BaseContextSensitiveTest {\n\n    @BeforeClass\npublic static void setUpDatabase() throws Exception {\n    URL file = getInitalDatasetURL();\n    testDataset = createDataset(file);\n}\n\n   @Before\npublic void init() throws Exception {\n    log.info(\"Initializing Data Set\");\n    connection = createDBUnitConnection();\n\n    DatabaseOperation.CLEAN_INSERT.execute(connection, testDataset);\n}\n\nprivate static URL getInitalDatasetURL() throws FileNotFoundException {\n    URL file = ClassLoader.getSystemResource(TEST_DATASET_LOCATION);\n    if (file == null) {\n        throw new FileNotFoundException(\"Unable to find '\"\n                + TEST_DATASET_LOCATION + \"' in the classpath\");\n    }\n    return file;\n}\n\nprivate static IDataSet createDataset(URL file) throws IOException,\n        DataSetException {\n\n    return new XmlDataSet(file.openStream());\n}\n\nprivate IDatabaseConnection createDBUnitConnection()\n        throws DatabaseUnitException, SQLException {\n\n    Connection connection = getConnection();\n    IDatabaseConnection dbUnitConn = new DatabaseConnection(connection);\n\n    // use the hsql datatypefactory so that boolean properties work\n    // correctly\n    DatabaseConfig config = dbUnitConn.getConfig();\n    config.setProperty(DatabaseConfig.PROPERTY_DATATYPE_FACTORY,\n            new HsqldbDataTypeFactory());\n\n    return dbUnitConn;\n}\n</code></pre>\n\n<p>As soon as it hits the <code>DatabaseOperation.CLEAN_INSERT.execute(connection, testDataset);</code> it throws the following exception:</p>\n\n<pre><code>org.dbunit.dataset.NoSuchTableException: Did not find table 'USER' in schema 'null'\nat org.dbunit.database.DatabaseTableMetaData.&lt;init&gt;(DatabaseTableMetaData.java:142)\nat org.dbunit.database.DatabaseDataSet.getTableMetaData(DatabaseDataSet.java:290)\nat org.dbunit.operation.DeleteAllOperation.execute(DeleteAllOperation.java:109)\nat org.dbunit.operation.CompositeOperation.execute(CompositeOperation.java:79)\nat com.cottage.test.BaseContextSensitiveTest.init(BaseContextSensitiveTest.java:64)\n</code></pre>\n\n<p>I have all the hibernate mapping files in place and the database is already set up with no data. Funny thing (or annoying thing depending on how you look at it) is that if I change the order of the tables in the dataset, the missingtableexception complains of another table... either user, reservation or status.</p>\n\n<p>Any suggestions on what I might be doing wrong?</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13239040,"title":"org.springframework.dao.DataIntegrityViolationException misreporting cause?","body":"<p>I'm using hibernate to insert to a mysql table on which all columns are defined as not null. It has a unique primary key and another unique index on several columns.</p>\n\n<p>I'm getting the following error:</p>\n\n<blockquote>\n  <p>org.springframework.dao.DataIntegrityViolationException: Could not\n  execute JDBC batch update; SQL [insert into MY_TABLE(col1, col2, col3,\n  col4, ID_) values (?, ?, ?, ?, ?)]; constraint [null]</p>\n</blockquote>\n\n<p>This error is in customer logs and I can't reproduce the problem myself, so I can't put in debugging to see what the values are in the insert statement.</p>\n\n<p>My understanding is that \"constraint [null]\" means a \"not null\" constraint is being violated. However, looking at my code, I cannot see any possible way that any of the data could be null at the time of the insert, unless hibernate is trying to insert a null ID (which would be a very bad bug in hibernate and so seems unlikely).</p>\n\n<p>However, I can see how it could happen that a unique constraint is being violated. Is it possible that the message is misleading and I'm actually getting a unique key violation? Does \"constraint[null]\" always mean a not null constraint was violated?</p>\n"},{"tags":["java","hibernate","jsf","crud"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1631,"score":1,"question_id":492315,"title":"Best strategy to multiple CRUD with jsf","body":"<p>on my company we are developing a ERP-like app using java and jsf, so far the design team has identified about 20 entities,each with diferent properties, usually we'll be building 20 pages of CRUD , is there any better way to do this?, we are using hibernate as db access, so we came up with the idea of a single DAO for this part of the system, have you faced a similiar situation? what are your thoughts on it?</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13235818,"title":"Setting Batch size in configuration","body":"<p>I am using hibernate 3.2.5. What is the exact use/meaning of the statement <code>hibernate.jdbc.batch_size</code> in a hibernate configuration file?</p>\n\n<p>From the documentation, I can see that we need to add this line in the configuration for batch processing otherwise, batch processing is disabled by default. Apart from that, what is the specific reason for assigning the above line to a number? </p>\n\n<p>It is <strong>not</strong> like if I assign it to 30(suppose) then my batch will be able to insert/update/delete at max 30 rows, I tested this thing in my local. Then what is the use of the number we assign for this?</p>\n\n<p>Please let me know about this.</p>\n\n<p>Regards,</p>\n"},{"tags":["java","mysql","hibernate","jpa"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":3946,"score":3,"question_id":1376543,"title":"Table not created by Hibernate","body":"<p>I annotated a bunch of POJO's so JPA can use them to create tables in Hibernate.  It appears that all of the tables are created except one very central table called \"Revision\".  The Revision class has an <code>@Entity(name=\"RevisionT\")</code> annotation so it will be renamed to RevisionT so there is not a conflict with any reserved words in MySQL (the target database).</p>\n\n<p>I delete the entire database, recreate it and basically open and close a JPA session.  All the tables seem to get recreated without a problem.</p>\n\n<p>Why would a single table be missing from the created schema?  What instrumentation can be used to see what Hibernate is producing and which errors?</p>\n\n<p>Thanks.</p>\n\n<p>UPDATE:  I tried to create as a Derby DB and it was successful.  However, one of the fields has a a name of \"index\".  I use <code>@org.hibernate.annotations.IndexColumn</code> to specify the name to something other than a reserved word.  However, the column is always called \"index\" when it is created.</p>\n\n<p>Here's a sample of the suspect annotations.</p>\n\n<pre><code>\n    @ManyToOne\n    @JoinColumn(name=\"MasterTopID\")\n    @IndexColumn(name=\"Cx3tHApe\")\n    protected MasterTop masterTop;\n</code></pre>\n\n<p>Instead of creating <code>MasterTop.Cx3tHApe</code> as a field, it creates <code>MasterTop.Index</code>.  Why is the name ignored?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13236055,"title":"Caused by: java.lang.ClassNotFoundException: org.hibernate.Interceptor","body":"<p>I am trying to run a utility class which calls some project specific classes, from .bat file. Utility class runs fine from Eclipse IDE but from command line I get <code>Caused by: java.lang.ClassNotFoundException: org.hibernate.Interceptor</code>.<br/> I assumed that to fix this issue I should find corresponding jar from the project's lib folder and set it explicitly into the bat file's CLASSPATH. But I could not find any jar with class org.hibernate.Interceptor.<br/><br/> What is wrong with my approach? I have following hibernate related jars in my lib folder:</p>\n\n<ul>\n<li>hibernate3.jar</li>\n<li>hibernate-jpa-2.0-api-1.0.0.Final.jar</li>\n</ul>\n\n<p>Batch file has just two commands</p>\n\n<pre><code>@ECHO OFF\njava -cp .;D:\\Projects\\Name\\webapps\\WEB-INF\\classes dbchanges.CreateQuery\n</code></pre>\n"},{"tags":["hibernate","parent","children","composite-key","persist"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13130898,"title":"Save parent and child entities with composite keys","body":"<p>parent entity <code>Inventory_Item</code>:</p>\n\n<pre><code>@OneToMany(mappedBy = \"inventoryItem\")\n    @Cascade({ org.hibernate.annotations.CascadeType.PERSIST, org.hibernate.annotations.CascadeType.MERGE,\n            org.hibernate.annotations.CascadeType.SAVE_UPDATE })\n    private List&lt;Inventory_Item_Media&gt; inventoryItemMedias = new ArrayList&lt;Inventory_Item_Media&gt;();\n</code></pre>\n\n<p>child entity <code>Inventory_Item_Media</code>:</p>\n\n<pre><code>@ManyToOne\n@JoinColumns({\n        @JoinColumn(name = \"Room_Id\", referencedColumnName = \"Room_Id\", nullable = false, insertable = false, updatable = false),\n        @JoinColumn(name = \"Inventory_Id\", referencedColumnName = \"Inventory_Id\", nullable = false, insertable = false, updatable = false) })\nprivate Inventory_Item inventoryItem;\n</code></pre>\n\n<p>got exception when trying to persist parent with list of children:</p>\n\n<pre><code>Caused by: javax.persistence.EntityExistsException: a different object with the same identifier value was already associated with the session: [com.ensuremystuff.persistence.entities.Inventory_Item_Media#com.ensuremystuff.persistence.entities.Inventory_Item_MediaPK@fc1a0597]\n</code></pre>\n\n<p>problem:<br>\nwhen set composite primary key to child entity,that it contains <code>inventory_id=0</code> from parent entity,as far it's not generated yet(because is not persisted to DB)</p>\n\n<p>Is there practice how to save parent and children together which wired by composite key?</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13235724,"title":"Hibernate List-index occassionally getting null value","body":"<p>I have this mapping in my hbm.xml file.  But for some strange reasong I am getting occassional null values on SEQUENCE column.  How to restrict it from being set to null?\nI cannot use Set in the mapping since i need to index my categories.</p>\n\n<pre><code>    &lt;list name=\"categories\" table=\"CATEGORY\" cascade=\"save-update, delete\" lazy=\"false\"      outer-join=\"false\"&gt;\n            &lt;key column=\"ID\" /&gt;\n            &lt;list-index column=\"SEQUENCE\"/&gt; \n            &lt;one-to-many class=\"Category\"/&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["hibernate","criteria"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3975,"score":1,"question_id":1526177,"title":"Hibernate Criteria query - Class cast exception","body":"<p>I am using Hibernate(3.2) Criteria for querying and its giving me exception when converting to a list.</p>\n\n<p>Please see my code and exception below:</p>\n\n<pre><code>    List&lt;Summary&gt; summaryList;\n    Criteria criteria = session.createCriteria(Summary.class);\n    session.beginTransaction();\n    summaryList = Criteria.setProjection(\n      Projections.projectionList().add(Projections.sum(\"contractDollar\"))\n      .add(Projections.groupProperty(\"department\"))).list() ;\n</code></pre>\n\n<p>exception:\njava.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to com.abc.model.Summary</p>\n\n<p>I am not sure why the result is returned as 'Object' even though I specified it as my pojo(Summary)</p>\n\n<p>Could you please help me with this. I am a newbie to hibernate.</p>\n\n<p>Thanks,\nRaja.</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":5933,"score":9,"question_id":82429,"title":"When Hibernate flushes a Session, how does it decide which objects in the session are dirty?","body":"<p>My understanding of Hibernate is that as objects are loaded from the DB they are added to the Session. At various points, depending on your configuration, the session is flushed. At this point, modified objects are written to the database.</p>\n\n<p>How does Hibernate decide which objects are 'dirty' and need to be written?</p>\n\n<p>Do the proxies generated by Hibernate intercept assignments to fields, and add the object to a dirty list in the Session?</p>\n\n<p>Or does Hibernate look at each object in the Session and compare it with the objects original state?</p>\n\n<p>Or something completely different?</p>\n"},{"tags":["hibernate","spring-mvc","spring-transactions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":270,"score":0,"question_id":11740746,"title":"Hibernate entity interceptor triggerd but set values not saving","body":"<p>I'm working with a spring configured hibernate application.  There is transactionmanagement and an auditInterceptor defined as entityInterceptor.  When I debug the code I'm entering the entityInterceptors methods and the date's are being set, however at the end of the save they are not in the database :(.</p>\n\n<p>Consider following configuration</p>\n\n<pre><code>    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;     \n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;value&gt;\n                hibernate.dialect=${hibernate.dialect}\n                hibernate.show_sql=${hibernate.show_sql}\n                hbm2ddl.auto=${hbm2ddl.auto}\n            &lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property name=\"schemaUpdate\"&gt;\n            &lt;value&gt;true&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property name=\"annotatedClasses\"&gt;\n            &lt;list&gt;\n                                .. bunch of annotatedClasses\" ...\n            &lt;/list&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;bean name=\"auditInterceptor\" class=\"com.mbalogos.mba.dao.AuditInterceptor\" /&gt;\n\n    &lt;bean id=\"transactionManager\"\n        class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n        &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n        &lt;property name=\"entityInterceptor\" ref=\"auditInterceptor\"/&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"namedQueryDao\" class=\"com.mbalogos.mba.dao.NamedQueryDaoImpl\"&gt;\n        &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<p>and following entityInterceptor</p>\n\n<pre><code>public class AuditInterceptor extends EmptyInterceptor{\n\n    /**\n     * \n     */\n    private static final long serialVersionUID = -8374988621501998008L;\n\n    @Override\n    public boolean onSave(Object entity, Serializable id, Object[] state,\n            String[] propertyNames, Type[] types) {\n        if(entity instanceof DomainObject){\n            Timestamp date = new Timestamp(new Date().getTime());\n            ((DomainObject)entity).setCreationDate(date);\n            ((DomainObject)entity).setModificationDate(date);\n        }       \n        return true;\n    }\n\n    @Override\n    public boolean onFlushDirty(Object entity, Serializable id,\n            Object[] currentState, Object[] previousState,\n            String[] propertyNames, Type[] types) {\n        if(entity instanceof DomainObject){\n            DomainObject domainObject = (DomainObject)entity;\n            Timestamp date = new Timestamp(new Date().getTime());\n            domainObject.setModificationDate(date);             \n        }\n        return true;\n    }\n\n    @Override\n    public void onDelete(Object entity, Serializable id, Object[] state,\n            String[] propertyNames, Type[] types) {\n        super.onDelete(entity, id, state, propertyNames, types);\n    }\n\n    @SuppressWarnings(\"rawtypes\")\n    @Override\n    public void preFlush(Iterator entities) {\n        super.preFlush(entities);\n    }\n\n    @SuppressWarnings(\"rawtypes\")\n    @Override\n    public void postFlush(Iterator entities) {\n        super.postFlush(entities);\n    }\n}\n</code></pre>\n\n<p>following save method, sessionFactory is injected in the class</p>\n\n<pre><code>public &lt;T extends DomainObject&gt; T save(T objectToSave) {\n    Session currentSession = null;\n    try {\n        currentSession = sessionFactory.getCurrentSession();\n        currentSession.save(objectToSave);\n\n        return objectToSave;\n    } catch (Exception ex) {\n        logger.error(ex);\n    }\n    return null;\n}\n</code></pre>\n\n<p>Anyone has any idea why this behaviour is happening.  Oh I also tried putting the entityInterceptor in the sessionFactory instead of the transactionmanager that was my first try , same behaviour :(</p>\n"},{"tags":["java","hibernate","jpa","jpa-2.0","eclipselink"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13222699,"title":"Using @ElementCollection and @CollectionTable on @MappedSuperclass base class with EclipseLink","body":"<p>I have a base class defined as follow:  </p>\n\n<pre><code>@MappedSuperclass\npublic abstract class BaseUser {\n    @ElementCollection(fetch = FetchType.EAGER)\n    @CollectionTable(name = \"user_tags\",\n        joinColumns = {\n                @JoinColumn(name = \"owner_id\", referencedColumnName= \"tagName\")})\n    public Set&lt;String&gt; getTags() {...}\n</code></pre>\n\n<p>And a bunch of derived user classes which extends BaseUser.<br>\nWith Hibernate a single \"user_tags\" table was created for all the derived classes (which was what I wanted).<br>\nAfter moving to EclipseLink it seems the engine tried to add the \"owner_id\" and the \"tagName\" columns over and over as the number of the derived classes which obviously result with table creation failure. \nIs there a way to get the same behavior as Hibernate in EclipseLink?\nWhat does the JPA spec expects in such a scenario? </p>\n"},{"tags":["java","hibernate","collections","mapping"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13127184,"title":"Hibernate Criteria for map of basic type","body":"<p>I have a Hibernate mapping that looks something like this:</p>\n\n<pre><code>class A {\n    private Long id;\n    private Map&lt;C,String&gt; someMap;\n    ...\n\n    @Id\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    public Long getId() {\n         return id;\n    }\n\n    public void setId(Long id) {\n         this.id = id;\n    }\n\n    @ElementCollection(targetClass=String.class, fetch=FetchType.EAGER)\n    public Map&lt;C, String&gt; getSomeMap() {\n        return someMap;\n    }\n\n    pubic void setSomeMap(Map&lt;C,String&gt; someMap){\n           this.someMap = someMap;\n    }\n}\n\nclass B {\n    private Long id;\n    private A a;\n    ...\n    @Id\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    public Long getId() {\n         return id;\n    }\n\n    public void setId(Long id) {\n         this.id = id;\n    }\n\n    @OneToOne\n    public A getA(){\n         return a;\n    }\n\n    public void setA(A a){\n         this.a = a;\n    }\n}\n\nclass C {\n    private Long id;\n    ...\n    @Id\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    public Long getId() {\n         return id;\n    }\n\n    public void setId(Long id) {\n         this.id = id;\n    }\n}\n</code></pre>\n\n<p>How can I do a query (with criteria) to get all \"В\" which have such \"A\" which have, for example, \"test\" as value in \"someMap\"? Or can I do it only with clear sql?</p>\n"},{"tags":["hibernate","solr","hibernate-search"],"answer_count":6,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":2050,"score":11,"question_id":6068831,"title":"Solr vs Hibernate Search - Which to choose and When?","body":"<p>We are building an ecommerce application. We are using JAVA stack with Hibernate and Spring Framework. As with all ecommerce application, we need to build search capability into ours.</p>\n\n<p>So, we came across <a href=\"http://www.hibernate.org/subprojects/search.html\">Hibernate Search</a> and <a href=\"http://lucene.apache.org/solr/\">Apache Solr</a> . Can someone list out the pros and cons of both of them so that we can select the ideal solution for Enterprise Search?</p>\n"},{"tags":["java","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":13233029,"title":"How to query a maximum of a list?","body":"<p>I have a list (in this example: list of cars) in my stock. I want to query for the stock and find the highest price that is available within the cars list.</p>\n\n<pre><code>class Stock {\n    List&lt;Car&gt; cars;\n}\n\nclass Car {\n    int price;\n}\n</code></pre>\n\n<p>Tried:</p>\n\n<pre><code>SELECT DISTINCT s.cars.price FROM Stock s;\n</code></pre>\n\n<p>But this always gives an \"error in named query\". What could be wrong, or how could this be done better?</p>\n"},{"tags":["java","hibernate","null","dirty"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13233662,"title":"Null properties also dirty on creation?","body":"<p>When I create a new instance and then <a href=\"https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#flush%28%29\" rel=\"nofollow\"><code>flush()</code></a> my Hibernate <a href=\"https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html\" rel=\"nofollow\"><code>Session</code></a>, are all properties of this instance marked as dirty, including the <code>null</code> ones?</p>\n\n<p>Or are only those properties dirty that aren't <code>null</code>?</p>\n"},{"tags":["java","hibernate","jpa","lazy-loading"],"answer_count":4,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":4635,"score":7,"question_id":4306463,"title":"How to test whether lazy loaded JPA collection is initialized?","body":"<p>I have a service that gets a JPA entity from outside code. In this service I would like to iterate over a lazily loaded collection that is an attribute of this entity to see if the client has added something to it relative to the current version in the DB.</p>\n\n<p>However, the client may have never touched the collection so it's still not initialized. This results in the well known org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.example.SomeEntity.</p>\n\n<p>Of course, if the client never touched the collection, my service doesn't have to check it for possible changes. The thing is that I can't seem to find a way to test whether the collection is initialized or not. I guess I could call size() on it and if it throws LazyInitializationException I would know, but I'm trying not to depend on such patterns.</p>\n\n<p>Is there some isInitialized() method somewhere?</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13232691,"title":"What is the Best Practive to user Hibernate DetachedCriteria?","body":"<p>I have used DetachedCriteria in the web application and would like to know what is the best practice to use it, so will achieve best ORM performance ?</p>\n"},{"tags":["java","mysql","spring","hibernate","transactions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":848,"score":0,"question_id":1635633,"title":"Spring Transactions in different DAOs does not work anyway?","body":"<p>Here is my implementation in summary</p>\n\n<p>1) all DAOs implemented using HibernateDAO support/ @Transational annotation is only used in Service layer</p>\n\n<p>2) Use MySQL / HibernateTransactionManager</p>\n\n<p>3) Test using main(String args[]) method  (do transactions work using this method? )</p>\n\n<p>Transactions does not get rollbacked and invalid entried can be seen in the database.\nWhat am I doing wrong here?</p>\n\n<p>Detailed information is given below.</p>\n\n<p>1) I have configured transactions using @Transactional annotation in service layer as:</p>\n\n<pre><code>@Transactional(readOnly=false, rollbackFor={DuplicateEmailException.class,DuplicateLoginIdException.class,IdentityException.class},propagation=Propagation.REQUIRES_NEW)\n    public void createUserProfile(UserProfile profile)\n    \t\tthrows DuplicateEmailException, DuplicateLoginIdException,\n    \t\tIdentityException {\n\n    \t//Accessing DAO (implemented using HibernateDAOSupport)\n                identityDAO.createPrincipal(profile.getSecurityPrincipal());\n    \ttry {\n                //Accessing DAO\n    \t\tuserProfileDAO.createUserProfile(profile);\n    \t} catch (RuntimeException e) {\n    \t\tthrow new IdentityException(\"UseProfile create Error\", e);\n    \t}\n\n    }\n</code></pre>\n\n<p>2) My Transation Manager configuration / datasource is as follows :</p>\n\n<pre><code>&lt;bean id=\"dataSource\"\n    \tclass=\"org.apache.commons.dbcp.BasicDataSource\"\n    \tdestroy-method=\"close\"&gt;\n    \t&lt;property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\" /&gt;\n    \t&lt;property name=\"url\"\n    \t\tvalue=\"jdbc:mysql://localhost:3306/ibmdusermgmt\" /&gt;\n    \t&lt;property name=\"username\" value=\"root\" /&gt;\n    \t&lt;property name=\"password\" value=\"root\" /&gt;\n    \t&lt;property name=\"defaultAutoCommit\" value=\"false\"/&gt;\t\t\n    &lt;/bean&gt;\n\n    &lt;bean id=\"sessionFactory\"\n    \tclass=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n    \t&lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\t\t\n    \t&lt;property name=\"mappingLocations\"\n    \t\tvalue=\"classpath*:hibernate/*.hbm.xml\" /&gt;\n    \t&lt;property name=\"hibernateProperties\"&gt;\n    \t\t\t&lt;prop key=\"hibernate.dialect\"&gt;\n    \t\t\torg.hibernate.dialect.MySQLDialect\n    \t\t\t&lt;/prop&gt;\t\t\t\t\n    \t\t\t&lt;prop key=\"hibernate.query.substitutions\"&gt;\n    \t\t\t\ttrue=1 false=0\n    \t\t\t&lt;/prop&gt;\n    \t\t\t&lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n    \t\t\t&lt;prop key=\"hibernate.use_outer_join\"&gt;false&lt;/prop&gt;\n    \t\t&lt;/props&gt;\n    \t&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\"\n    \tclass=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    \t&lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n</code></pre>\n\n<p>3) Test using main() method as follows :</p>\n\n<pre><code>public static void main(String[] args) {\n\n    \tApplicationContext cnt=new ClassPathXmlApplicationContext(\"testAppContext.xml\");\n    \tIUserProfileService upServ=(IUserProfileService)cnt.getBean(\"ibmdUserProfileService\");\n\n    \tUserProfile up=UserManagementFactory.createProfile(\"testlogin\");//\t\t\n    \tup.setAddress(\"address\");\n    \tup.setCompany(\"company\");\n    \tup.setTelephone(\"94963842\");\n    \tup.getSecurityPrincipal().setEmail(\"security@email.com\");\n    \tup.getSecurityPrincipal().setName(\"Full Name\");\n    \tup.getSecurityPrincipal().setPassword(\"password\");\n    \tup.getSecurityPrincipal().setSecretQuestion(new SecretQuestion(\"Question\", \"Answer\"));\n\n    \ttry {\n    \t\tupServ.createUserProfile(up);\n    \t} catch(Exception e){\n    \t\te.printStackTrace();\n    \t}\n</code></pre>\n"},{"tags":["java","sql","database","hibernate","jpql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13230956,"title":"conditional left outer join SQL query To JPQL","body":"<p>What is a <strong>jpql</strong> equivalent of following <strong>SQL</strong> query :</p>\n\n<pre><code>select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=1;\n</code></pre>\n\n<p><strong>Sample Data:</strong></p>\n\n<pre><code>ij&gt; select * from App;\nID         |STATUS\n----------------------\n1          |active\n2          |active1\n3          |active3\n5          |active\n\n4 rows selected\nij&gt; select * from App_Child;\nID         |STATUS    |D\n----------------------------------\n1          |active    |1\n2          |active11  |2\n1          |active111 |3\n1          |active    |4\n\n4 rows selected\nij&gt; select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=1;\nID         |STATUS    |ID         |STATUS    |D\n---------------------------------------------------------\n1          |active    |1          |active    |1\n1          |active    |1          |active    |4\n\n2 rows selected\nij&gt; select * from App left outer join App_Child on (App.id=App_Child.id and App_Child.status = 'active') where App.status='active' and App.id=5;\nID         |STATUS    |ID         |STATUS    |D\n---------------------------------------------------------\n5          |active    |NULL       |NULL      |NULL\n\n1 row selected\n</code></pre>\n\n<p>EDIT : We are using <strong>jpa 2.0</strong></p>\n"},{"tags":["hibernate","mapping","one-to-one","composite-primary-key"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13177611,"title":"Hibernate one-to-one with composite keys","body":"<p>I have an issue with my mapping file, relating to a one-to-one relationship, with composite primary keys, where the field names of the keys do not match.</p>\n\n<p>Table 1:</p>\n\n<pre><code>&lt;class entity-name=\"CompPkTest\" table=\"compPkTest\" catalog=\"data\" mutable=\"true\" polymorphism=\"implicit\" dynamic-update=\"false\" dynamic-insert=\"false\" select-before-update=\"false\" optimistic-lock=\"version\"&gt;\n&lt;composite-id mapped=\"false\" unsaved-value=\"undefined\"&gt;\n  &lt;key-property name=\"id1\" type=\"int\"&gt;\n    &lt;column name=\"id1\"/&gt;\n  &lt;/key-property&gt;\n  &lt;key-property name=\"id2\" type=\"int\"&gt;\n    &lt;column name=\"id2\"/&gt;\n  &lt;/key-property&gt;\n&lt;/composite-id&gt;\n&lt;property name=\"details\" type=\"string\" unique=\"false\" optimistic-lock=\"true\" lazy=\"false\" generated=\"never\"&gt;\n  &lt;column name=\"Details\" length=\"500\"/&gt;\n&lt;/property&gt;\n&lt;one-to-one name=\"CompPkTestDetail\" entity-name=\"CompPkTestDetail\" constrained=\"false\" embed-xml=\"true\"/&gt;\n</code></pre>\n\n<p></p>\n\n<p>Table 2:</p>\n\n<pre><code>&lt;class entity-name=\"CompPkTestDetail\" table=\"compPkTestDetail\" catalog=\"data\" mutable=\"true\" polymorphism=\"implicit\" dynamic-update=\"false\" dynamic-insert=\"false\" select-before-update=\"false\" optimistic-lock=\"version\"&gt;\n&lt;composite-id mapped=\"false\" unsaved-value=\"undefined\"&gt;\n  &lt;key-property name=\"idetail1\" type=\"int\"&gt;\n    &lt;column name=\"idetail1\"/&gt;\n  &lt;/key-property&gt;\n  &lt;key-property name=\"idetail2\" type=\"int\"&gt;\n    &lt;column name=\"idetail2\"/&gt;\n  &lt;/key-property&gt;\n&lt;/composite-id&gt;\n&lt;one-to-one name=\"CompPkTest\" entity-name=\"CompPkTest\" constrained=\"true\" embed-xml=\"true\"/&gt;\n&lt;property name=\"someDetail\" type=\"string\" unique=\"false\" optimistic-lock=\"true\" lazy=\"false\" generated=\"never\"&gt;\n  &lt;column name=\"someDetail\" length=\"300\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"moreDetail\" type=\"string\" unique=\"false\" optimistic-lock=\"true\" lazy=\"false\" generated=\"never\"&gt;\n  &lt;column name=\"moreDetail\" length=\"300\"/&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p></p>\n\n<p>The problem is that when querying table 1, the \"details\" property is null.\nIf I change the key-property names in CompPkTestDetail to be id1 and id2, (while leaving the column name unchanged), the relationship works as expected, and the query returns a value for \"details\".</p>\n\n<p>My questions:</p>\n\n<p>Is the above mapping xml the correct way to make this association (with the non-matching field names)?</p>\n\n<p>Is hibernate correct to impose that the field names must match, or is this a bug?</p>\n\n<p>Please note that in my application there are no classes for the entities, and hibernate is in map-mode. My application has fully dynamic access to the (arbitrary) databases, and so the xml for the mappings is generated at run time.</p>\n"},{"tags":["spring","hibernate","jsf","transactions","richfaces"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13225207,"title":"org.hibernate.LazyInitializationException when migrating webapp to JSF 2.1 & RichFaces 4","body":"<p>I know this question has been asked a lot, but the strange thing here is that I had no problems when using jsf 1.1 / richfaces 3, along with hibernate 3.7 and spring 2.5.</p>\n\n<p>Now that I migrated my front-end to jsf 2.1 / richfaces 4 (hibernate and spring remained the same) the following exception appears when I try to access a collection marked as \"lazy=true\" in hibernate mapping config:</p>\n\n<pre><code>org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.mu.afs.Afi.cods, no session or session was closed\nat org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)\nat org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)\nat org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:97)\nat org.hibernate.collection.PersistentBag.size(PersistentBag.java:225)\nat javax.faces.model.ListDataModel.isRowAvailable(ListDataModel.java:91)\nat javax.faces.model.ListDataModel.setRowIndex(ListDataModel.java:105)\n</code></pre>\n\n<p>The collection that I try to reach is referenced by a <code>rich:datatable</code> in the same xhtml that the <code>Afi</code> entity; \nHere is the part of the xhtml that tries to access the collecion upon an ajax request of a master table:</p>\n\n<pre><code>&lt;rich:extendedDataTable id=\"tableCods\" selectionMode=\"single\" \nselection=\"#{afiBean.codSelected}\"\nstyle=\"width: 100%; height: 100px\" \nvalue=\"#{afiBean.selectedAfi.cods}\" var=\"cod\"&gt;\n...\n&lt;rich:column width=\"50px\" style=\"text-align: right;\"&gt;\n    &lt;f:facet name=\"header\"&gt;&lt;h:outputText value=\"Months\"/&gt;&lt;/f:facet&gt;\n    &lt;h:outputText value=\"#{cod.months}\" /&gt;\n&lt;/rich:column&gt;\n&lt;rich:column width=\"80px\" style=\"text-align: right;\"&gt;\n    &lt;f:facet name=\"header\"&gt;&lt;h:outputText value=\"Cap\" /&gt; &lt;/f:facet&gt;\n    &lt;h:outputText  value=\"#{cod.cap}\"&gt;\n        &lt;f:convertNumber pattern=\"######,##0.00\" locale=\"es_AR\" /&gt;\n    &lt;/h:outputText&gt;\n&lt;/rich:column&gt;\n&lt;rich:column width=\"200px\" style=\"text-align: center;\"&gt;\n    &lt;f:facet name=\"header\"&gt;&lt;h:outputText value=\"Class\"/&gt;&lt;/f:facet&gt;\n    &lt;h:outputText value=\"#{cod.clazz}\" /&gt;\n&lt;/rich:column&gt;\n...\n</code></pre>\n\n<p></p>\n\n<p>Here is my web.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:web=\"http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nversion=\"2.5\"&gt;\n...\n&lt;filter&gt;\n    &lt;filter-name&gt;sessionFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.orm.hibernate3.support.OpenSessionInViewFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n\n&lt;filter-mapping&gt;\n    &lt;filter-name&gt;sessionFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;\n    &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;\n    &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;\n&lt;/filter-mapping&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.request.RequestContextListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;servlet&gt;\n    &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/faces/*&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n...\n</code></pre>\n\n<p></p>\n\n<p>This is part of my application-context.xml:</p>\n\n<pre><code>...\n    &lt;bean id=\"txManager\"\n    class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"txProxyTemplate\" abstract=\"true\"\n    class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\" ref=\"txManager\" /&gt;\n    &lt;property name=\"transactionAttributes\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"save*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"store*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"get*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"read*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"load*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n...\n</code></pre>\n\n<p>The service that is accessing the <code>Afi</code> entity is defined as follow:</p>\n\n<pre><code>&lt;bean id=\"afiService\" parent=\"txProxyTemplate\"&gt;\n    &lt;property name=\"proxyInterfaces\" value=\"com.mu.afs.services.AfiService\" /&gt;\n    &lt;property name=\"target\"&gt;\n        &lt;bean class=\"com.mu.afs.services.impl.AfiServiceImpl\"&gt;\n            &lt;property name=\"afiDao\" ref=\"afiDao\" /&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n    &lt;bean id=\"afiliadosDao\"\n    class=\"com.mu.afs.dao.impl.HibernateAfiDaoImpl\"\n    parent=\"hibernateDaoSupport\"&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>I would really appreciate if someone can throw some light on this issue. I dont know whether is related to a migration issue or if there is a problem with this configuration and was somehow \"masked\" with a previous version of jsf and richfaces. </p>\n\n<p>I tried to put here any relevant information that I thought it would help without boring and overwhelm the reader, but let me know if something is missing here.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","grails","constraints","unique","unique-constraint"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":216,"score":1,"question_id":11648496,"title":"Grails Unique Constraint","body":"<p>I have a grails application using <code>hibernate</code>.Under <code>grails 1.3.7</code> everything works properly, but when I switch to <code>grails 2.0.3</code> the following problem appears:</p>\n\n<p>I can't check for unique fields under <code>java/src</code> directory. If I try to add or update any record with the same unique key, batch insert error appears.</p>\n\n<p>Under <code>src/groovy</code> I create a class to check validation:</p>\n\n<pre><code>Example: LanguageCommand.groovy\n\npackage myproject.command\n\nimport org.codehaus.groovy.grails.validation.Validateable;\n\n@Validateable\nclass LanguageCommand {\n\n    String code\n    String codeDescription\n\n    static constraints= {\n        code(blank:false, maxSize:50)\n        codeDescription(maxSize:200)\n    }\n}\n</code></pre>\n\n<p>and under <code>src/java</code> I create a class to check for unique fields</p>\n\n<pre><code>Example: LanguageConstraints.groovy\n\npackage myproject.model\n\n    constraints = {\n        code unique: true\n    }\n</code></pre>\n\n<p>where <code>myproject.model</code> is the name of the package that contains hibernate classes.</p>\n\n<p><b>Note:</b> <code>Validation class works fine but the unique one not. i try to add unique constraints to validation class, same error appears</code></p>\n\n<p><b>Error:</b></p>\n\n<pre><code>Error 500: Executing action [save] of controller \n           [myproject.controller.LanguageController] \n           caused exception: Runtime error executing action\nServlet: grails\nURI: /myproject/grails/language/save.dispatch\nException Message: Batch entry 0 insert into language \n                   (language_code, code_description, version, id) \n                   values (en, English, 0, 1) was aborted. \n                   Call getNextException to see the cause.\nCaused by: Batch entry 0 insert into language \n           (language_code, code_description, version, id) \n           values (en, English, 0, 1) was aborted. \n           Call getNextException to see the cause.\nClass: LanguageController\nAt Line: [125]\nCode Snippet:\n</code></pre>\n\n<p>Any help?</p>\n"},{"tags":["hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13194835,"title":"hql and inheritance","body":"<p>I have the following HQL statement:</p>\n\n<pre><code>    Query q = session.createQuery(\n        \"SELECT ze \" +\n        \"FROM NormaleZone zo \" +\n        \"LEFT JOIN zo.zaal za \" +\n        \"LEFT JOIN za.vertoningen v \" +\n        \"LEFT JOIN zo.normaleZetels ze \" +\n        \"WHERE v = :vertoning \" +\n        \" AND zo = :zone \" +\n        \" AND ze NOT IN (SELECT t.zetel FROM Ticket t WHERE t.vertoning = :vertoning)\"\n    );\n</code></pre>\n\n<p>The problem I have is that <code>NormaleZone</code> inherits from <code>Zone</code>, as do <code>HandicapZone</code> and <code>LoveZone</code>.</p>\n\n<p>What I would like to do is the following:</p>\n\n<pre><code>    Query q = session.createQuery(\n        \"SELECT ze \" +\n        \"FROM Zone zo \" +\n        \"LEFT JOIN zo.zaal za \" +\n        \"LEFT JOIN za.vertoningen v \" +\n        \"LEFT JOIN zo.??? ze \" +\n        \"WHERE v = :vertoning \" +\n        \" AND zo = :zone \" +\n        \" AND ze NOT IN (SELECT t.zetel FROM Ticket t WHERE t.vertoning = :vertoning)\"\n    );\n</code></pre>\n\n<p>You can see I put <code>zo.???</code> in there. The object of this HQL is to find out which seats have not yet been taken in a movie theater. The problem is that the abstract class <code>Zone</code> has no seats (the <code>ze</code> would be the alias for seats).</p>\n\n<p>I don't understand how I can solve this besides looking at the incoming <code>Zone</code> object in that method and then making two strings, one for the zone and one for the seats and then concatenating them in the HQL string.</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13194962,"title":"Single table inheritance with enum type","body":"<p>I have parent-child entity relationship as follows. Here I am going to map this inheritance for single table which is User</p>\n\n<pre><code>@Entity\n@Table(name = \"USER\")\n@Inheritance(strategy = InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name = \"USER_TYPE\", discriminatorType = DiscriminatorType.STRING,    length = 20)\n@DiscriminatorValue(\"USER\")\npublic class User implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = \"ID\", unique = true, nullable = false)\n    private Long id;\n\n    .\n    .\n    @Enumerated(EnumType.STRING)\n    @Column(name = \"USER_TYPE\", insertable = false, updatable = false)\n    private UserType userType;\n    .\n    .\n\n    //setters, getters\n\n}\n\n\n@Entity\n@DiscriminatorValue(\"MANAGER\")\npublic class Manager extends User implements Serializable {\n    // manager specific fields\n}\n\nUser Types :\n\npublic enum UserType {\n    MANAGER,\n    ADMIN,\n    ACCOUNTS_CLEARK\n}\n</code></pre>\n\n<p>When I persist User object, the user type column get only USER, even I set user type in the persistance object (i.e. UserType.MANAGER). The actual hibernate insert statement as was follows;</p>\n\n<pre><code>Hibernate: insert into USER (ID, DOB, EMAIL, FIRST_NAME, MIDDLE_NAME, LAST_NAME,     NICKNAME, USER_NAME, PASSWORD, USER_TYPE) values (null, ?, ?, ?, ?, ?, ?, ?, ?, 'USER')\n</code></pre>\n\n<p>and I am getting following exception when I tries to retrieve all records from user the table;</p>\n\n<pre><code>java.lang.IllegalArgumentException: Unknown name value for enum class     com.test.domain.user.UserType: USER\n    at org.hibernate.type.EnumType.nullSafeGet(EnumType.java:127)\n    at org.hibernate.type.CustomType.nullSafeGet(CustomType.java:132)\n    at org.hibernate.type.AbstractType.hydrate(AbstractType.java:105)\n    at     org.hibernate.persister.entity.AbstractEntityPersister.hydrate(AbstractEntityPersister.java:2267)\n    at org.hibernate.loader.Loader.loadFromResultSet(Loader.java:1443)\n    at org.hibernate.loader.Loader.instanceNotYetLoaded(Loader.java:1371)\n    at org.hibernate.loader.Loader.getRow(Loader.java:1271)\n    at org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:619)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:745)\n    at     org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:270)\n    at org.hibernate.loader.Loader.doList(Loader.java:2449)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2192)\n    at org.hibernate.loader.Loader.list(Loader.java:2187)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:452)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:363)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1258)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at     sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at     sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at     org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)\n    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)\n    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    at     org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: java.lang.IllegalArgumentException: No enum const class com.test.domain.user.UserType.USER\n    at java.lang.Enum.valueOf(Enum.java:196)\n    at org.hibernate.type.EnumType.nullSafeGet(EnumType.java:124)\n    ... 47 more\n</code></pre>\n\n<p>I guess that each time I am going to save a user it picks @DiscriminatorValue which is USER and save in the user type field. Anyone come across and foud solution for this. Note that there is no type USER in the user type table.</p>\n"},{"tags":["java","hibernate","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13228455,"title":"Hibernate Bi-Directional Many to Many association creates duplicates","body":"<p>My question is pretty similar to this one <a href=\"http://stackoverflow.com/questions/2951350/hibernate-bi-directional-manytomany-updates-with-second-level-cache\">Hibernate Bi-Directional ManyToMany Updates with Second Level cache</a></p>\n\n<p>I've class as shown below</p>\n\n<pre><code>@Cache(usage = CacheConcurrencyStrategy.TRANSACTIONAL)\n@Entity \npublic class A{\n     private int id;\n     private List&lt;B&gt; listB;\n\n     ...\n     @Cache (usage = CacheConcurrencyStrategy.TRANSACTIONAL)\n     @ManyToMany(cascade = {CascadeType.PERSIST, CascadeType.MERGE}, targetEntity = B.class)\n     @JoinTable(name = \"A_B\", joinColumns = { @JoinColumn(name = \"a_id\") }, \n        inverseJoinColumns = { @JoinColumn(name = \"b_id\") })\n     public List&lt;B&gt; getListB() {\n         return listB ;\n     }\n}\n\n@Cache (usage = CacheConcurrencyStrategy.TRANSACTIONAL)\n@Entity\npublic class B{\n     private int id;\n     private List&lt;A&gt; listA;\n\n     @ManyToMany(cascade = {CascadeType.PERSIST, CascadeType.MERGE}, targetEntity = A.class)\n     @JoinTable(name = \"A_B\", joinColumns = { @JoinColumn(name = \"b_id\") }, inverseJoinColumns = { @JoinColumn(name = \"a_id\") })\n     public List&lt;a&gt; getListA() {\n         return listA ;\n     }\n\n     public void addToA(A a) {\n         a.getListB().add(this);\n     }\n}\n</code></pre>\n\n<p>As expected in a Many to Many relation, I've been updating both sides of the bi-directional relation . </p>\n\n<p>Now the problem I face is, duplicate entries popup when I try to add/update a item in the collection. The following is the code I use to persist the entity...</p>\n\n<pre><code>b.getA().clear() ;\n...\n...\nb.getListA().add(A) ;\nb.addToA(A) ;\nem.saveOrUpdate(b) ;\n</code></pre>\n\n<p>The following are the queries fired by Hibernate which are obtained from the logs.</p>\n\n<pre><code>delete from A_B where b_id=?\n\ninsert into A_B (b_id, a_id) values (?, ?)\ninsert into A_B (b_id, a_id) values (?, ?)\n\ndelete from A_B where a_id=?\n\ninsert into A_B (a_id, b_id) values (?, ?)\ninsert into A_B (a_id, b_id) values (?, ?)\ninsert into A_B (a_id, b_id) values (?, ?)\ninsert into A_B (a_id, b_id) values (?, ?)\n</code></pre>\n\n<p>Where am I going wrong here ?\nHow to get rid of the duplicates that are being inserted ?\nCache is being flushed properly but the duplicate entries are the only problem !</p>\n"},{"tags":["java","hibernate","index","hibernate-annotations"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13127441,"title":"How to specify a range index in hibernate annotations","body":"<p>Is it possible to specify via JPA or Hibernate annotations that a given index should use a range capable indexing method (such as a btree)?  If so, how?</p>\n"},{"tags":["java","spring","hibernate","connection","isolation-level"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13223019,"title":"How to set Diffrent value then 'auto' in connection.release_mode (spring + hibernate)","body":"<p>Is it possible to set a diffrent value then 'auto' to the hibernate propery - \"connection.release_mode\"?</p>\n\n<p>We use Spring with hibernate, When I try to define in this propery - 'after_transaction' (When i define hibernate properties in session factory definition), In runtime i get an exception (Spring exception) that the only valid value (in Spring terms) for this prop is 'on_close'. This fact cause us many troubles. We use the session-per-request pattern (meaning \" a client sends a request to the server, where the Hibernate persistence layer is running. Hibernate opens a new Session, and all database operations are executed in this unit of work.\"(<a href=\"http://docs.jboss.org/hibernate/orm/4.0/devguide/en-US/html/ch02.html#session-per-operation\" rel=\"nofollow\">hibernate doc</a>  ). when   on_close is defined - connection is being allocate per service (there is not re-use of connections).</p>\n\n<p>We use HibernateTransactionManager to manage transactions in combination with TransactionInterceptor. We handle sessions with AnnotationSessionFactoryBean (our session factory) , I try to define in the session factory decleration in the \"hibernateProperties\" part - > connection.release_mode=after_transaction. In Runtime when server try loading session factory I got this exception :     </p>\n\n<pre><code>org.springframework.transaction.InvalidIsolationLevelException: HibernateTransactionManager is not allowed to support custom isolation levels: make sure that its 'prepareConnection' flag is on (the default) and that the Hibernate connection release mode is set to 'on_close' (SpringTransactionFactory's default). Make sure that your LocalSessionFactoryBean actually uses SpringTransactionFactory: Your Hibernate properties should *not* include a 'hibernate.transaction.factory_class' property!\n    at org.springframework.orm.hibernate3.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:515)\n    ... 121 more\n</code></pre>\n\n<p>Why spring do that? and is there a bypass</p>\n\n<p>any advice would be appreciated.</p>\n"},{"tags":["java","spring","hibernate","tomcat6"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13226994,"title":"java tomcat6 - How to automatically refresh page when a data is added?","body":"<p>first of all let me explain what Im tring to do. Im trying to create a very simple web based chat program. In my development I have 2 pcs using only 1 ip address. The ip address that is being used is the ip address which runs the tomcat6 server. The simple chat is connected to the database. How will I make the web page automatically update when the other pc input data(message) in the database without reloading the page.</p>\n\n<p>Please forgive me if my question might sound idiotic. I have no experience in chat program. Please help.</p>\n"},{"tags":["spring","hibernate","jpa","jboss","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":200,"score":0,"question_id":10554039,"title":"Hibernate tuple criteria queries","body":"<p>I am trying to create a query using hibernate following the example given in section 9.2 of <a href=\"http://docs.jboss.org/hibernate/entitymanager/3.5/reference/en/html/querycriteria.html#querycriteria-tuple\" rel=\"nofollow\">chapter 9</a></p>\n\n<p>The difference with my attempt is I am using spring MVC 3.0. Here is my Address class along with the method i created.</p>\n\n<pre><code>@RooJavaBean\n@RooToString\n@RooEntity\n@RooJson\npublic class Address {\n\n    @NotNull\n    @Size(min = 1)\n    private String street1;\n\n    @Size(max = 100)\n    private String street2;\n\n    private String postalcode;\n\n    private String zipcode;\n\n    @NotNull\n    @ManyToOne\n    private City city;\n\n    @NotNull\n    @ManyToOne\n    private Country country;\n\n    @ManyToOne\n    private AddressType addressType;\n\n    @Transient\n    public static List&lt;Tuple&gt; jqgridAddresses(Long pID){\n        CriteriaBuilder builder = Address.entityManager().getCriteriaBuilder();\n        CriteriaQuery&lt;Tuple&gt; criteria = builder.createTupleQuery();\n        Root&lt;Address&gt; addressRoot = criteria.from( Address.class );\n        criteria.multiselect(addressRoot.get(\"id\"), addressRoot.get(\"street1\"), addressRoot.get(\"street2\"));\n        criteria.where(builder.equal(addressRoot.&lt;Set&lt;Long&gt;&gt;get(\"id\"), pID));\n        return Address.entityManager().createQuery( criteria ).getResultList();\n    }\n}\n</code></pre>\n\n<p>The method called <code>jqgridAddresses</code> above is the focus. I opted not to use the \"<strong>Path\"</strong> because when I say something like <strong>Path idPath = addressRoot.get( Address_.id );</strong> as in section 9.2 of the documentation, the <strong>PathAddress_.id</strong> stuff produces a compilation error.</p>\n\n<p>The method above returns an empty list of type <code>Tuple</code> as its size is zero even when it should contain something. This suggests that the query failed. Can someone please advise me.</p>\n"},{"tags":["java","eclipse","oracle","hibernate","tomcat"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3771,"score":1,"question_id":8757264,"title":"Fail to convert to internal representation","body":"<p>I am bringing up Broadleaf Commerce application using <code>Oracle Database</code> and <code>Tomcat 6 server</code>.\n    I followed the steps from <a href=\"http://www.broadleafcommerce.org/confluence/display/BLC15/Eclipse+-+Maven\" rel=\"nofollow\">here</a>\n    I have made changes in <code>Persistence-admin.xml</code>, <code>application_context-custom.xml</code> and <code>pom.xml</code> for <code>Connecting to oracle</code> and <code>tomcat</code>. \n    The application is up but when i m trying to login to admin or store i m getting below error. </p>\n\n<pre><code>org.springframework.jdbc.UncategorizedSQLException: PreparedStatementCallback; uncategorized SQLException for SQL [SELECT USER_NAME,PASSWORD,'TRUE' FROM BLC_CUSTOMER WHERE USER_NAME=?]; SQL state [null]; error code [17059]; Fail to convert to internal representation; nested exception is java.sql.SQLException: Fail to convert to internal representation\n    org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:83)\n    org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)\n    org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:80)\n    org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:602)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:636)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:665)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:673)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:713)\n    org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl.loadUsersByUsername(JdbcDaoImpl.java:189)\n    org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl.loadUserByUsername(JdbcDaoImpl.java:152)\n    org.broadleafcommerce.profile.service.LoginServiceImpl.loginCustomer(LoginServiceImpl.java:25)\n    org.broadleafcommerce.profile.web.controller.RegisterCustomerController.registerCustomer(RegisterCustomerController.java:75)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:175)\n    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:421)\n    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:409)\n    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:774)\n    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)\n    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)\n    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)\n    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:343)\n    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)\n    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.broadleafcommerce.profile.web.security.CustomerStateFilter.doFilter(CustomerStateFilter.java:123)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:112)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:149)\n    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\n    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\n    org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:113)\n    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n\n\nroot cause \n\njava.sql.SQLException: Fail to convert to internal representation\n    oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:125)\n    oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:162)\n    oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:227)\n    oracle.jdbc.driver.CharCommonAccessor.getBigDecimal(CharCommonAccessor.java:325)\n    oracle.jdbc.driver.CharCommonAccessor.getBoolean(CharCommonAccessor.java:158)\n    oracle.jdbc.driver.OracleResultSetImpl.getBoolean(OracleResultSetImpl.java:394)\n    org.apache.commons.dbcp.DelegatingResultSet.getBoolean(DelegatingResultSet.java:178)\n    org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl$1.mapRow(JdbcDaoImpl.java:193)\n    org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl$1.mapRow(JdbcDaoImpl.java:189)\n    org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:92)\n    org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:1)\n    org.springframework.jdbc.core.JdbcTemplate$1.doInPreparedStatement(JdbcTemplate.java:648)\n    org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:586)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:636)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:665)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:673)\n    org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:713)\n    org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl.loadUsersByUsername(JdbcDaoImpl.java:189)\n    org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl.loadUserByUsername(JdbcDaoImpl.java:152)\n    org.broadleafcommerce.profile.service.LoginServiceImpl.loginCustomer(LoginServiceImpl.java:25)\n    org.broadleafcommerce.profile.web.controller.RegisterCustomerController.registerCustomer(RegisterCustomerController.java:75)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:175)\n    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:421)\n    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:409)\n    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:774)\n    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)\n    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)\n    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)\n    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:343)\n    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)\n    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.broadleafcommerce.profile.web.security.CustomerStateFilter.doFilter(CustomerStateFilter.java:123)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:112)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)\n    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:149)\n    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\n    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\n    org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:113)\n    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\n\n\n\n\nCan anybody help me ? \n</code></pre>\n"},{"tags":["spring","hibernate","logback","spring-data"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":24,"score":3,"question_id":13223905,"title":"hibernate logback sql","body":"<p>I want to see the actual parameters of my SQL queries when I use Hibernate. I add this to my logback.xml to see the queries (with question marks):</p>\n\n<pre><code>&lt;logger name=\"org.hibernate.type\" level=\"TRACE\" /&gt;\n</code></pre>\n\n<p>but to no effect. </p>\n\n<p>Is there any special configuration necessary?</p>\n\n<p>OnConsoleStatusListener shows me the correct configuration</p>\n\n<pre><code>23:48:15,246 |-INFO in ch.qos.logback.classic.joran.action.LoggerAction - Setting level of logger [org.hibernate.type] to TRACE\n</code></pre>\n\n<p>but no output from org.hibernate.type package.</p>\n\n<p>I'm using Spring with Jpa.</p>\n"},{"tags":["mysql","hibernate","jboss-tools"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13220532,"title":"org.hibernate.exception.SQLGrammarException with MySQL5 (InnoDB or MyISAM) database, Hibernate 3/4 in a get() method","body":"<p>I am getting this exception (<strong>SQLGrammarException</strong>) when I am trying to perform a <strong>get()</strong> or a findByExample() against a <strong>MySQL</strong> database.</p>\n\n<ol>\n<li>MySQL version: <strong>MySQL 5.1.61-0ubuntu0.10.10.1</strong> </li>\n<li>Driver: <strong>mysql-connector-java 5.1.21</strong></li>\n<li>Database: MySQL world example:\n<a href=\"http://dev.mysql.com/doc/index-other.html\" rel=\"nofollow\">http://dev.mysql.com/doc/index-other.html</a> (InnoDB or MyISAM)</li>\n<li>Hibernate: <strong>3.5.1 or 4.0.1</strong> (both Final) Project setup: <em>hibernate layer</em> generated with Hibernate Tools\n(3.4.0.v20111025-0625-H210-Final) for Eclipse (Helios)</li>\n</ol>\n\n<p><code>Country instance = (Country) session.get(\"ch.cern.it.db.mw.hibernate.Country\", id);</code></p>\n\n<p>Any idea?</p>\n\n<p>Thanks in advance,</p>\n\n<p>Luis</p>\n"},{"tags":["oracle","hibernate","oracle10g","pagination","top-n"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13221912,"title":"Oracle and Pagination","body":"<p>In MySql, the concept of pagination can easily be implemented with a single SQL statement using the <code>LIMIT</code> clause something like the following.</p>\n\n<pre><code>SELECT country_id, country_name \nFROM country c \nORDER BY country_id DESC \nLIMIT 4, 5;\n</code></pre>\n\n<p>It would retrieve the rows starting from <code>5</code> to <code>10</code> in the result set which the SQL query retrieves.</p>\n\n<hr>\n\n<p>In Oracle, the same thing can be achieved using <em>row numbers</em> with a subquery making the task somewhat tedious as follows.</p>\n\n<pre><code>SELECT country_id, country_name\nFROM\n  (SELECT rownum as row_num, country_id, country_name\n   FROM\n    (SELECT country_id, country_name\n     FROM country\n     ORDER BY country_id desc)\n  WHERE rownum &lt;= 10\n  )\nWHERE row_num &gt;=5;\n</code></pre>\n\n<p>In Oracle 10g (or higher, I'm not sure about the higher versions though), this can be made somewhat easy such as,</p>\n\n<pre><code>SELECT country_id, country_name\n  FROM (SELECT country_id, country_name, row_number() over (order by country_id desc) rank\n      FROM country)\n WHERE rank BETWEEN 6 AND 10;\n</code></pre>\n\n<hr>\n\n<p>Regarding an application like a web application, the concept of pagination is required to implement almost everywhere and writing such SQL statements every time a (select) query is executed is sometimes a tedious job. </p>\n\n<p>Suppose, I have a web application using Java. If I use the Hibernate framework then there is a direct way to do so using some methods supported by Hibernate like,</p>\n\n<pre><code>List&lt;Country&gt;countryList=session.createQuery(\"from Country order by countryId desc\")\n.setFirstResult(4).setMaxResults(5).list();\n</code></pre>\n\n<p>but when I simply use JDBC connectivity with Oracle like,</p>\n\n<pre><code>String connectionURL = \"jdbc:oracle:thin:@localhost:1521:xe\";\nConnection connection = null;\nStatement statement = null;\nResultSet rs = null;\n\nClass.forName(\"oracle.jdbc.OracleDriver\").newInstance();\nconnection = DriverManager.getConnection(connectionURL, \"root\", \"root\");\nstatement = connection.createStatement();\nrs = statement.executeQuery(\"SELECT * from country\");\n</code></pre>\n\n<p>My question in this case, is there a precise way to retrieve a specified range of rows using this code? Like in the preceding case using the methods something like <code>setFirstResult()</code> and <code>setMaxResults()</code>? or the only way to achieve this is by using those subqueries as specified.</p>\n"},{"tags":["java","hibernate","jpa-2.0","eclipselink"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13222431,"title":"JPA @PrimaryKeyJoinColumn with Hibernate?","body":"<p>I try to use @OneToOne  relationship by sharing the same primary keys values. \nI found this example :</p>\n\n<pre><code>@Entity\npublic class Body {\n    @Id\n    public Long getId() { return id; }\n\n    @OneToOne(cascade = CascadeType.ALL)\n    @PrimaryKeyJoinColumn\n    public Heart getHeart() {\n        return heart;\n    }\n    ...\n} \n\n@Entity\npublic class Heart {\n    @Id\n    public Long getId() { ...}\n}   \n</code></pre>\n\n<p>at <a href=\"http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/\" rel=\"nofollow\">http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/</a></p>\n\n<p>When i run the code i see only two table being create and there is not added any foreign key constraints like it is added when i use JoinColumn</p>\n\n<p>So the generated DB code for create table is :</p>\n\n<pre><code>create table Body (\n        id bigint generated by default as identity (start with 1),\n        primary key (id)\n    )\ncreate table Heart (\n        id bigint generated by default as identity (start with 1),\n        primary key (id)\n    )\n</code></pre>\n\n<p>After NO constrains added...</p>\n\n<p>When running this agains EclipseLink implementation :</p>\n\n<pre><code>CREATE TABLE BODY (ID BIGINT NOT NULL, PRIMARY KEY (ID))\nCREATE TABLE HEART (ID BIGINT NOT NULL, PRIMARY KEY (ID))\n**ALTER TABLE BODY ADD CONSTRAINT FK_BODY_ID FOREIGN KEY (ID) REFERENCES HEART (ID)**\nCREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT NUMERIC(38), PRIMARY KEY (SEQ_NAME))\nINSERT INTO SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0)\n</code></pre>\n\n<p>exactly what i expected to get from Hibernate.</p>\n\n<p>Any idea if Hibernate is supposed to behave like this ?</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13221730,"title":"How to create a JPAQL to pull a tree of parent with multiple children collections and avoid Hibernate Illegal attempt to dereference collection","body":"<p>I am trying to mimic a eager fetch for a specific situation only.I use <code>spring-data-jpa</code> with <code>hibernate 4.1</code> as implementation. i have <code>User</code>, <code>Role</code> and <code>Right</code>. <code>Role</code> and <code>User</code> have many-to-many with additional field thus mapped as an Entity <code>RoleUser</code>. <code>Role</code> and <code>Right</code> also are in <code>many-to-many</code> mapped as an Entity <code>RoleRight</code>.</p>\n\n<p>I would like to load all right and role for a user into the <code>Authorization</code> mechanism of the application when needed. this query below is giving <code>illegal attempt to dereference collection</code> </p>\n\n<pre><code>   List&lt;Role&gt; roles = (List&lt;Role&gt;)em.createQuery(\"select r from RoleImpl r JOIN FETCH r.roleRightMap rrm JOIN FETCH rrm.right ur WHERE r.userRoleMap.user.ID=:id \")\n            .setParameter(\"id\", ID).getResultList();\n</code></pre>\n\n<p>How can it be rewritten to load the role and its mapping thanks.</p>\n"},{"tags":["java","hibernate","jpa","orm","eclipselink"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13220770,"title":"Why can't the id field be used in where caluse with EclipseLink","body":"<p>I'm moving an application from Hibernate to EclipseLink.\nI have the following named query:  </p>\n\n<pre><code>delete from MyObject where id&lt;=:LAST_ID\n</code></pre>\n\n<p>The query worked fine with Hibernate but fails with the following error with EclipseLink:  </p>\n\n<blockquote>\n  <p>The identification variable 'id' cannot be used in conjunction with the &lt;= operator.</p>\n</blockquote>\n\n<p>Isn't it allowed to use the ID field in the where caluse with JPA?  </p>\n\n<p>Any workaround will be appreciated.</p>\n"},{"tags":["java","hibernate","connection-pooling","c3p0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13220409,"title":"how to choose maximum connection pool size?","body":"<pre><code>&lt;property name=\"hibernateProperties\"&gt;\n  &lt;props&gt;           \n    &lt;prop key=\"hibernate.c3p0.max_size\"&gt;?&lt;/prop&gt;\n  &lt;/props&gt;\n&lt;/property&gt;\n</code></pre>\n\n<p>is it just a random number guess ? or are there any studies that suggest to use a particular range for a specific use case?  </p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13212030,"title":"Hibernate batch insert oracle 10g","body":"<p>I want to perform a hibernate batch insert using HibernateTemplate but I am not able to find the correct jar containing this class. I know that it should present in spring.jar but not able to find out where to download the spring.jar. For getting this jar, I tried with downloading the entire spring framework also but unfortunately did not found anything like spring.jar in the downloaded package. May be the name is changed, can you please let me know in which jar can I find this HibernateTemplate class??</p>\n\n<p>Also, shall we use the HibernateTemplate class for batch insert in hibernate or there are some other better alternative for batch insert in hibernate?</p>\n\n<p>Regards,</p>\n"},{"tags":["hibernate","spring-mvc","hibernate-mapping","jta"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2968,"score":2,"question_id":5694899,"title":"IllegalArgumentException in class: ..., getter method of property: id","body":"<p>am facing a weird problem, I have googled it for hours, but did not find out how to solve it.</p>\n\n<p>Here is the the situation :  i have two class <code>Roles</code> and <code>Privileges</code> with the relation ManyToMany. When adding a Privilege to a Role, the calling <code>saveOrUpdate(role)</code> , i came into this exception.</p>\n\n<p>here is the Role Class</p>\n\n<pre><code>@Entity\n@Table(name = \"ROLES\")\npublic class Role implements GenericDomain {\n\nprivate static final long serialVersionUID = -7620550658984151796L;\n\nprivate Long    id;\nprivate String  code;\nprivate String  name;\n\nprivate Set&lt;User&gt; users = new HashSet&lt;User&gt;(0);\nprivate Set&lt;Privilege&gt; privileges = new HashSet&lt;Privilege&gt;(0);\n\npublic Role() {\n}\n\npublic Role(String code, String name) {\n    this.code = code;\n    this.name = name;\n}\n\n\n@Id\n@GeneratedValue(strategy=GenerationType.AUTO)\n@Column(name = \"ID\")\npublic Long getId() { return id; }\npublic void setId(Long id) { this.id = id; }\n\n@Column(name = \"CODE\", unique = true, nullable = false, length = 16)\n@NotEmpty(message= \"password.required\")\n@Length(min = 3, max = 16)\npublic String getCode() { return code; }\npublic void setCode(String code) { this.code = code; }\n\n@Column(name=\"NAME\", nullable = false, length = 64)\n@NotEmpty\n@Length(min = 1, max = 32)\npublic String getName() { return name; }\npublic void setName(String name) { this.name = name; }\n\n@ManyToMany(cascade=CascadeType.ALL)\n@JoinTable(name = \"ROLES_PRIVILEGES\"\n    , joinColumns = { @JoinColumn(name = \"ROLE_ID\") }\n    , inverseJoinColumns = { @JoinColumn(name = \"PRIVILEGE_ID\") }\n)\n\npublic Set&lt;Privilege&gt; getPrivileges() {\n    return this.privileges;\n}\npublic void setPrivileges(Set&lt;Privilege&gt; privileges) {\n    this.privileges = privileges;\n}\n    /*  overide of hascode, equals*/ \n}\n</code></pre>\n\n<p>Here is the Privileges Class</p>\n\n<pre><code>@Entity\n@Table(name = \"PRIVILEGES\")\npublic class Privilege implements GenericDomain {\n\nprivate static final long serialVersionUID = 4649689934972816194L;\n\nprivate Long    id;\nprivate String  code;\n\nprivate Set&lt;Role&gt; roles = new HashSet&lt;Role&gt;(0);\n\npublic Privilege() {\n}\n\npublic Privilege(String code) {\n    this.code = code;\n}\n\n@Id\n@GeneratedValue(strategy=GenerationType.AUTO)\n@Column(name = \"ID\")\npublic Long getId() { return id; }\npublic void setId(Long id) { this.id = id; }\n\n@Column(name = \"CODE\", unique = true, nullable = false, length = 16)\n@NotEmpty(message= \"password.required\")\n@Length(min = 3, max = 16)\npublic String getCode() { return code; }\npublic void setCode(String code) { this.code = code; }\n\n@ManyToMany(cascade=CascadeType.REFRESH, mappedBy=\"privileges\")\npublic Set&lt;Role&gt; getRoles() {\n    return this.roles;\n}\npublic void setRoles(Set&lt;Role&gt; roles) {\n    this.roles = roles;\n}\n\n/*overide equals and hascode*/\n</code></pre>\n\n<p>}</p>\n\n<p>And here is the the exception :</p>\n\n<pre><code> IllegalArgumentException in class: com.stunaz.domain.Privilege, getter method of property: id\n ....\n javax.persistence.PersistenceException: org.hibernate.PropertyAccessException: IllegalArgumentException occurred calling getter of com.stunaz.domain.Privilege.id\n ....\n java.lang.IllegalArgumentException: object is not an instance of declaring class\n</code></pre>\n\n<p>Its seems something is wrong with my mapping, that somewhere i should pass an object but i am passing an Id.but i dont see that mistake.</p>\n\n<p>thank for any advise.</p>\n"},{"tags":["spring","hibernate","aop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13171987,"title":"Spring Hibernate Connection through AOP standalone application","body":"<p>I am trying to develop Annotation based Spring Hibernate standalone application to connect to DB. I've gone through the some blogs and wondered like we should not make use of hibernateTemplate becoz coupling your application tightly to the spring framework. For this reason, Spring recommends that HibernateTemplate no longer be used.Further more my requirement is changed to Spring Hibernate with AOP using Declarative Transaction management.I am new to AOP concepts. Can any one please give an example on Spring Hibernate Connection through AOP. That would be a great help to me.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","junit","ehcache","hibernate-4.x"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13200562,"title":"ehcache with Hibernate 4 ,giving Could not initialize class net.sf.ehcache.config.ConfigurationFactory while running Junit test","body":"<p>I am trying to implement Hibernate 4 with Ehcache as my second level cache</p>\n\n<p>XML config for Hibernate properties</p>\n\n<pre><code>&lt;prop key=\"hibernate.cache.use_second_level_cache\"&gt;true&lt;/prop&gt;\n    &lt;prop key=\"hibernate.cache.region.factory_class\"&gt;org.hibernate.cache.ehcache.EhCacheRegionFactory&lt;/prop&gt;\n&lt;prop key=\"hibernate.cache.use_query_cache\"&gt;true&lt;/prop&gt;\n&lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n</code></pre>\n\n<p>pom for the test case and application</p>\n\n<pre><code>    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-ehcache&lt;/artifactId&gt;\n        &lt;version&gt;4.1.8.Final&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>I also have ehcache core 2.4.3 in my pom,but now when I run my Hibernate Junit test cases I get the following error</p>\n\n<pre><code>     Failed to load ApplicationContext\n    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:157)\n    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)\n    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)\n    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:321)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:211)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:288)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:290)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [spring/database/Hibernate.xml]: Invocation of init method failed; nested exception is java.lang.NoClassDefFoundError: Could not initialize class net.sf.ehcache.config.ConfigurationFactory\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)\n    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:103)\n    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:1)\n    at org.springframework.test.context.support.DelegatingSmartContextLoader.loadContext(DelegatingSmartContextLoader.java:228)\n    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)\n    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)\n    ... 24 more\nCaused by: java.lang.NoClassDefFoundError: Could not initialize class net.sf.ehcache.config.ConfigurationFactory\n    at org.hibernate.cache.ehcache.internal.util.HibernateUtil.loadAndCorrectConfiguration(HibernateUtil.java:63)\n    at org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory.start(SingletonEhCacheRegionFactory.java:91)\n    at org.hibernate.internal.CacheImpl.&lt;init&gt;(CacheImpl.java:70)\n</code></pre>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13213643,"title":"Spring + session + hibernate = error listener start and error creating bean","body":"<p>I have some problems with things mentioned above.</p>\n\n<p>Here is my springconfig:</p>\n\n<pre><code>    &lt;context:annotation-config/&gt;\n&lt;context:property-placeholder location=\"jdbc.properties\"/&gt;\n\n&lt;bean id=\"cart\" class=\"cart.ShoppingCart\" scope=\"session\"&gt;\n    &lt;aop:scoped-proxy/&gt;\n&lt;/bean&gt;\n&lt;bean id=\"shopServlet\" class=\"ShopServlet\" scope=\"request\"/&gt;\n&lt;bean id=\"cartServlet\" class=\"cart.ShoppingCartServlet\" scope=\"request\"/&gt;\n&lt;bean id=\"productService\" class=\"products.ProductService\"/&gt;\n&lt;bean id=\"orderBean\" class=\"order.OrderBean\" scope=\"request\"/&gt;\n&lt;bean id=\"orderService\" class=\"order.OrderService\"/&gt;\n\n&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${jdbc.driverClassName}\"/&gt;\n    &lt;property name=\"url\" value=\"${jdbc.url}\"/&gt;\n    &lt;property name=\"username\" value=\"${jdbc.username}\"/&gt;\n    &lt;property name=\"password\" value=\"${jdbc.password}\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\"/&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.show_sql\"&gt;${hibernate.show_sql}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.format_sql\"&gt;${hibernate.format_sql}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.generate_statistics\"&gt;${hibernate.generate_statistics}&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>@Repository\n@Transactional\npublic class ProductService{\n\n@Autowired\nSessionFactory sessionFactory;\n</code></pre>\n\n<p>And the stack trace:</p>\n\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cart' defined in BeanDefinition defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.transaction.interceptor.TransactionAttributeSourceAdvisor#0': Cannot create inner bean '(inner bean)' of type [org.springframework.transaction.interceptor.TransactionInterceptor] while setting bean property 'transactionInterceptor'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name '(inner bean)': Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class\n\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.transaction.interceptor.TransactionAttributeSourceAdvisor#0': Cannot create inner bean '(inner bean)' of type [org.springframework.transaction.interceptor.TransactionInterceptor] while setting bean property 'transactionInterceptor'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name '(inner bean)': Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class\n\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name '(inner bean)': Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class\n\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class\n\nCaused by: java.lang.IncompatibleClassChangeError: Implementing class\n</code></pre>\n\n<p>I tried to work with this example <a href=\"http://javaprogrammingtips4u.blogspot.com/2010/04/spring-integration-with-hibernate_23.html\" rel=\"nofollow\">link</a> and search through many different solutions, but I dont know. Some version mismatch or I am not understanding something.</p>\n\n<p>Dependencies:</p>\n\n<pre><code>  &lt;dependency&gt;\n        &lt;groupId&gt;mysql&lt;/groupId&gt;\n        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n        &lt;version&gt;5.1.9&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n        &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;cglib&lt;/groupId&gt;\n        &lt;artifactId&gt;cglib-nodep&lt;/artifactId&gt;\n        &lt;version&gt;2.2.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;\n        &lt;artifactId&gt;gson&lt;/artifactId&gt;\n        &lt;version&gt;2.2.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;commons-dbcp&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-dbcp&lt;/artifactId&gt;\n        &lt;version&gt;20030825.184428&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;commons-pool&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-pool&lt;/artifactId&gt;\n        &lt;version&gt;20030825.183949&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n        &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.myfaces.core&lt;/groupId&gt;\n        &lt;artifactId&gt;myfaces-impl&lt;/artifactId&gt;\n        &lt;version&gt;2.1.3&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n        &lt;artifactId&gt;jstl&lt;/artifactId&gt;\n        &lt;version&gt;1.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-hibernate3&lt;/artifactId&gt;\n        &lt;version&gt;2.0.8&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;\n        &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;aopalliance&lt;/groupId&gt;\n        &lt;artifactId&gt;aopalliance&lt;/artifactId&gt;\n        &lt;version&gt;1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n        &lt;version&gt;3.5.6-Final&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n        &lt;version&gt;4.1.7.Final&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-commons-annotations&lt;/artifactId&gt;\n        &lt;version&gt;3.2.0.Final&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>If someone feels very powerful - here is the full code. Application is very small. <a href=\"https://www.dropbox.com/s/smy50sjlrvsiiyo/shoplab2-test.zip\" rel=\"nofollow\">link</a></p>\n"},{"tags":["hibernate","jpa","jpql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13181624,"title":"JPA and Hibernate: compare only time portions of timestamps","body":"<p>I'm using Hibernate through JPA and I need to filter records by the time portion of their <code>Date</code> property .</p>\n\n<pre><code>public class Foo {\n    Date getDateTime() {\n        // Returns a date and time value.\n    }\n}\n\nTime startTime = ...;\nTime endTime = ...;\n\nTypedQuery&lt;Foo&gt; query = entityManager.createQuery(\"SELECT foo FROM Foo foo where :startTime &lt;= foo.dateTime AND foo.dateTime &lt;= :endTime\", Foo.class);\nquery.setParameter(\"startTime\", startTime);\nquery.setParameter(\"endTime \", endTime);\n</code></pre>\n\n<p>Of course this will not work because you can't directly compare a <code>Date</code> and a <code>Time</code>. If this were a SQL query, then I would use a few DBMS-specific date functions to compare them, but how do you compare a Date and a Time in JPA?</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13216841,"title":"Conflict in Hibernate 3.6 and 4.1","body":"<p>Currently I am using Hibernate version 4.1.17_final in my current application. I am using Multi-Tenancy feature of hibernate in my application.\nI have to integrate one another application into my current application. But that application using Hibernate 3.6 version. I integrated that application by copying jars from that application and pasted it into my WEB-INF/lib folder. I thought hibernate 4.1.17 version will have the compatibility. My requirement is like I have to get the data by using their API and display it in my application. But when I am trying to call any class method from that jar to get the data it is giving me following error. </p>\n\n<p><code>java.lang.NoSuchMethodError: org.hibernate.SessionFactory.openSession()Lorg/hibernate/classic/Session;</code></p>\n\n<p>and if I change the version to 3.6 of my current application so Multi-Tenancy feature will not work. Because it is available in 4.0 version.\nAny help would be really appreaciable..Please guide me in this problem. I googled it but not found any specific way. I am using Maven for building and mapping dependancies.</p>\n\n<p>Please let me know If you want more information.</p>\n\n<p>Thanks &amp; regards,\nParag737</p>\n"},{"tags":["oracle","hibernate","ora-00904"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3142,"score":1,"question_id":4548735,"title":"Hibernate native SQL error","body":"<p>I am trying to execute sql native query using hibernate 3.3.2.GA.</p>\n\n<p>I have following query.</p>\n\n<pre><code>session.createSQLQuery(\"SELECT {dept1.*}, {dept2.*} FROM Dept d1, Dept d2 WHERE d1.deptId = d2.deptId\").\n   addEntity(\"dept1\",com.test.pojo.Dept.class).\n   addEntity(\"dept2\",com.test.pojo.Dept.class).\n   list();\n</code></pre>\n\n<p>Mapping file for Dept class is </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n                                   \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n&lt;class name=\"com.test.pojo.Dept\"&gt;\n  &lt;id column=\"deptId\" name=\"deptId\" type=\"long\"&gt;\n   &lt;generator class=\"native\"/&gt;\n  &lt;/id&gt;\n  &lt;version name=\"version\" access=\"field\" column=\"version\"&gt;&lt;/version&gt;\n  &lt;property  name=\"deptName\" type=\"string\" column=\"deptName\"/&gt;\n\n  &lt;set name=\"emps\" cascade=\"all\" inverse=\"true\"&gt;\n     &lt;key column=\"deptId\"&gt;&lt;/key&gt;\n     &lt;one-to-many class=\"com.test.pojo.Emp\"/&gt;\n  &lt;/set&gt;\n&lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>But why I get following error? It is converting my query to </p>\n\n<p>SELECT <strong>dept1.**deptId as deptId1_0_, *<em>dept1.</em>*version as version1_0_, *<em>dept1.</em>*deptName as deptName1_0_, *<em>dept2.</em>*deptId as deptId1_1_, *<em>dept2.</em>*version as version1_1_, *<em>dept2.</em>*deptName as deptName1_1_ **FROM Dept d1, Dept d2</strong> WHERE d1.deptId = d2.deptId.</p>\n\n<p>Hibernate: SELECT dept1.deptId as deptId1_0_, dept1.version as version1_0_, dept1.deptName as deptName1_0_, dept2.deptId as deptId1_1_, dept2.version as version1_1_, dept2.deptName as deptName1_1_ FROM Dept d1, Dept d2 WHERE d1.deptId = d2.deptId\n20:43:41,109 WARN JDBCExceptionReporter:100 - SQL Error: 904, SQLState: 42000\n20:43:41,109 ERROR JDBCExceptionReporter:101 - ORA-00904: \"DEPT2\".\"DEPTNAME\": invalid identifier</p>\n\n<p>Exception in thread \"main\" org.hibernate.exception.SQLGrammarException: could not execute query\nat org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:90)\nat org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\nat org.hibernate.loader.Loader.doList(Loader.java:2235)\nat org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2129)\nat org.hibernate.loader.Loader.list(Loader.java:2124)\nat org.hibernate.loader.custom.CustomLoader.list(CustomLoader.java:312)\nat org.hibernate.impl.SessionImpl.listCustomQuery(SessionImpl.java:1723)\nat org.hibernate.impl.AbstractSessionImpl.list(AbstractSessionImpl.java:165)\nat org.hibernate.impl.SQLQueryImpl.list(SQLQueryImpl.java:175)\nat com.test.test.Test1.main(Test1.java:96)\nCaused by: java.sql.SQLException: ORA-00904: \"DEPT2\".\"DEPTNAME\": invalid identifier</p>\n\n<p>at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134)\nat oracle.jdbc.ttc7.TTIoer.processError(TTIoer.java:289)\nat oracle.jdbc.ttc7.Oall7.receive(Oall7.java:590)\nat oracle.jdbc.ttc7.TTC7Protocol.doOall7(TTC7Protocol.java:1973)\nat oracle.jdbc.ttc7.TTC7Protocol.parseExecuteDescribe(TTC7Protocol.java:850)\nat oracle.jdbc.driver.OracleStatement.doExecuteQuery(OracleStatement.java:2599)\nat oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:2963)\nat oracle.jdbc.driver.OraclePreparedStatement.executeUpdate(OraclePreparedStatement.java:658)\nat oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:584)\nat org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)\nat org.hibernate.loader.Loader.getResultSet(Loader.java:1812)\nat org.hibernate.loader.Loader.doQuery(Loader.java:697)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.doList(Loader.java:2232)\n... 7 more</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13214551,"title":"java.lang.IllegalArgumentException: Property 'transactionManager' is required","body":"<p>I am getting the following error when I deploy a Spring application:</p>\n\n<p>java.lang.IllegalArgumentException: Property 'transactionManager' is required</p>\n\n<p>I am using:\nOS: OSX Mountain Lion\nIDE: Springsource Tools Suite 3.1.0\nSpring: 3.1.2\nHibernate: 4.1.7\nJava: 1.6\nwebserver: vFabric tomcat v2.7</p>\n\n<p>Do I have some missing configuration? Are the libraries in my pom.xml wrong? </p>\n\n<p>deployment log:</p>\n\n<pre><code>Nov 3, 2012 2:32:12 PM org.apache.catalina.core.StandardContext loadOnStartup\nSEVERE: Servlet /basicServer threw load() exception\njava.lang.IllegalArgumentException: Property 'transactionManager' is required\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.afterPropertiesSet(TransactionAspectSupport.java:195)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:292)\n    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852.transactionInterceptor(&lt;generated&gt;)\n    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration.transactionAdvisor(ProxyTransactionManagementConfiguration.java:46)\n    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852.CGLIB$transactionAdvisor$0(&lt;generated&gt;)\n    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852$$FastClassByCGLIB$$4a8a503d.invoke(&lt;generated&gt;)\n    at net.sf.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:228)\n    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:280)\n    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852.transactionAdvisor(&lt;generated&gt;)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:149)\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:570)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:86)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:100)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findEligibleAdvisors(AbstractAdvisorAutoProxyCreator.java:86)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.getAdvicesAndAdvisorsForBean(AbstractAdvisorAutoProxyCreator.java:68)\n    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:359)\n    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:322)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:407)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1461)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:353)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:748)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)\n    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:353)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:86)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:100)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findEligibleAdvisors(AbstractAdvisorAutoProxyCreator.java:86)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.getAdvicesAndAdvisorsForBean(AbstractAdvisorAutoProxyCreator.java:68)\n    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:359)\n    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:322)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:407)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1461)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:740)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)\n    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)\n    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)\n    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)\n    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)\n    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)\n    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)\n    at javax.servlet.GenericServlet.init(GenericServlet.java:160)\n    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)\n    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)\n    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)\n    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5027)\n    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5314)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)\n    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:650)\n    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1582)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:680)\nNov 3, 2012 2:32:12 PM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory /Users/bruce/springsource/vfabric-tc-server-developer-2.7.2.RELEASE/base-instance/webapps/manager\nNov 3, 2012 2:32:12 PM org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory /Users/bruce/springsource/vfabric-tc-server-developer-2.7.2.RELEASE/base-instance/webapps/ROOT\nNov 3, 2012 2:32:13 PM org.apache.coyote.AbstractProtocol start\nINFO: Starting ProtocolHandler [\"http-bio-8080\"]\nNov 3, 2012 2:32:13 PM org.apache.catalina.startup.Catalina start\nINFO: Server startup in 8754 ms\n</code></pre>\n\n<p>My Config files (ServicesConfiguration.java  AppConfig.java)\nServicesConfiguration.java:</p>\n\n<pre><code>package com.bsches.basicServer.config;\n\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Properties;\n\nimport javax.sql.DataSource;\n\nimport org.hibernate.SessionFactory;\nimport org.hibernate.dialect.H2Dialect;\nimport org.hibernate.service.ServiceRegistry;\nimport org.hibernate.service.ServiceRegistryBuilder;\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.cache.Cache;\nimport org.springframework.cache.CacheManager;\nimport org.springframework.cache.annotation.EnableCaching;\nimport org.springframework.cache.concurrent.ConcurrentMapCache;\nimport org.springframework.cache.support.SimpleCacheManager;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.jdbc.datasource.DriverManagerDataSource;\nimport org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseBuilder;\nimport org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;\nimport org.springframework.orm.hibernate4.HibernateTransactionManager;\nimport org.springframework.orm.hibernate4.LocalSessionFactoryBuilder;\nimport org.springframework.transaction.PlatformTransactionManager;\nimport org.springframework.transaction.annotation.EnableTransactionManagement;\nimport org.springframework.web.servlet.config.annotation.EnableWebMvc;\n\nimport com.bsches.basicServer.services.CustomerService;\n\nimport entities.Customer;\n\n@Configuration\n@EnableCaching\n@EnableWebMvc\n@EnableTransactionManagement\npublic class ServicesConfiguration {\n\n    @Value(\"${jdbc.driverClassName}\")\n    private String driverClassName;\n    @Value(\"${jdbc.url}\")\n    private String url;\n    @Value(\"${jdbc.username}\")\n    private String username;\n    @Value(\"${jdbc.password}\")\n    private String password;\n\n    @Value(\"${hibernate.dialect}\")\n    private String hibernateDialect;\n    @Value(\"${hibernate.show_sql}\")\n    private String hibernateShowSql;\n    @Value(\"${hibernate.hbm2ddl.auto}\")\n    private String hibernateHbm2ddlAuto;\n\n    @Bean\n    public CustomerService customerService() throws Exception {\n        return new CustomerService(this.sessionFactory());\n    }\n\n    @Bean\n    public SessionFactory sessionFactory() throws Exception {\n        Properties props = new Properties();\n\n        Map&lt;String, String&gt; p = new HashMap&lt;String, String&gt;();\n        p.put(org.hibernate.cfg.Environment.HBM2DDL_AUTO, hibernateHbm2ddlAuto);\n        p.put(org.hibernate.cfg.Environment.HBM2DDL_IMPORT_FILES,\n                \"import_h2.sql\");\n        p.put(org.hibernate.cfg.Environment.DIALECT, hibernateDialect);\n        p.put(org.hibernate.cfg.Environment.SHOW_SQL, hibernateShowSql);\n        Map&lt;String, String&gt; propsMap = p;\n\n        for (String k : propsMap.keySet())\n            props.setProperty(k, propsMap.get(k));\n\n         org.hibernate.cfg.Configuration configuration = new org.hibernate.cfg.Configuration();\n         configuration.configure();\n         ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(props).buildServiceRegistry();        \n         SessionFactory sessionFactory = configuration.buildSessionFactory(serviceRegistry);\n         return sessionFactory;\n\n    }\n\n    @Bean\n    public PlatformTransactionManager transactionManager() throws Exception {\n        return new HibernateTransactionManager(sessionFactory());\n    }\n\n    @Bean()\n    public DataSource dataSource() {\n        DriverManagerDataSource ds = new DriverManagerDataSource();\n        ds.setDriverClassName(driverClassName);\n        ds.setUrl(url);\n        ds.setUsername(username);\n        ds.setPassword(password);\n        return ds;\n    }\n\n    @Bean\n    public CacheManager cacheManager() throws Exception {\n        SimpleCacheManager scm = new SimpleCacheManager();\n        Cache cache = new ConcurrentMapCache(\"customers\");\n        scm.setCaches(Arrays.asList(cache));\n        return scm;\n    }\n}\n</code></pre>\n\n<p>AppConfig.java:</p>\n\n<pre><code>package com.bsches.basicServer.config;\n\nimport org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.Import;\nimport org.springframework.core.io.ClassPathResource;\n\n@Import({ServicesConfiguration.class})\n@Configuration\npublic class AppConfig {\n    @Bean\n    public static PropertyPlaceholderConfigurer getPropertyPlaceholderConfigurer()\n    {\n        PropertyPlaceholderConfigurer ppc = new PropertyPlaceholderConfigurer();\n        ppc.setLocation(new ClassPathResource(\"application.properties\"));\n        ppc.setIgnoreUnresolvablePlaceholders(true);\n        return ppc;\n    }\n\n}\n</code></pre>\n\n<p>pom.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;com.bsches&lt;/groupId&gt;\n    &lt;artifactId&gt;basicServer&lt;/artifactId&gt;\n    &lt;name&gt;basicServer&lt;/name&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;version&gt;1.0.0-BUILD-SNAPSHOT&lt;/version&gt;\n    &lt;properties&gt;\n        &lt;java-version&gt;1.6&lt;/java-version&gt;\n        &lt;org.springframework-version&gt;3.1.0.RELEASE&lt;/org.springframework-version&gt;\n        &lt;org.aspectj-version&gt;1.6.9&lt;/org.aspectj-version&gt;\n        &lt;org.slf4j-version&gt;1.5.10&lt;/org.slf4j-version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;!-- Spring --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework-version}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;!-- Exclude Commons Logging in favor of SLF4j --&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n                 &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework-version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- AspectJ --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;\n            &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;\n            &lt;version&gt;${org.aspectj-version}&lt;/version&gt;\n        &lt;/dependency&gt;   \n\n        &lt;!-- Logging --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;${org.slf4j-version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;\n            &lt;version&gt;${org.slf4j-version}&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n            &lt;version&gt;${org.slf4j-version}&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n            &lt;version&gt;1.2.15&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.mail&lt;/groupId&gt;\n                    &lt;artifactId&gt;mail&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.jms&lt;/groupId&gt;\n                    &lt;artifactId&gt;jms&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.sun.jdmk&lt;/groupId&gt;\n                    &lt;artifactId&gt;jmxtools&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.sun.jmx&lt;/groupId&gt;\n                    &lt;artifactId&gt;jmxri&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- @Inject --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.inject&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.inject&lt;/artifactId&gt;\n            &lt;version&gt;1&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Servlet --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\n            &lt;version&gt;2.5&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;\n            &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;\n            &lt;version&gt;2.1&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;jstl&lt;/artifactId&gt;\n            &lt;version&gt;1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Test --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.7&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-jpa&lt;/artifactId&gt;\n            &lt;version&gt;2.0.8&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;\n            &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n            &lt;version&gt;5.0.0.Alpha1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;cglib&lt;/groupId&gt;\n            &lt;artifactId&gt;cglib&lt;/artifactId&gt;\n            &lt;version&gt;2.2.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;4.1.7.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-eclipse-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.9&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;additionalProjectnatures&gt;\n                        &lt;projectnature&gt;org.springframework.ide.eclipse.core.springnature&lt;/projectnature&gt;\n                    &lt;/additionalProjectnatures&gt;\n                    &lt;additionalBuildcommands&gt;\n                        &lt;buildcommand&gt;org.springframework.ide.eclipse.core.springbuilder&lt;/buildcommand&gt;\n                    &lt;/additionalBuildcommands&gt;\n                    &lt;downloadSources&gt;true&lt;/downloadSources&gt;\n                    &lt;downloadJavadocs&gt;true&lt;/downloadJavadocs&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.3.2&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;1.6&lt;/source&gt;\n                    &lt;target&gt;1.6&lt;/target&gt;\n                    &lt;compilerArgument&gt;-Xlint:all&lt;/compilerArgument&gt;\n                    &lt;showWarnings&gt;true&lt;/showWarnings&gt;\n                    &lt;showDeprecation&gt;true&lt;/showDeprecation&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n                &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;1.2.1&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;mainClass&gt;org.test.int1.Main&lt;/mainClass&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n"},{"tags":["java","hibernate","orm","jpa","jdo"],"answer_count":10,"favorite_count":70,"up_vote_count":98,"down_vote_count":1,"view_count":66513,"score":97,"question_id":530215,"title":"Hibernate vs JPA vs JDO - pros and cons of each?","body":"<p>I'm familiar with ORM as a concept, and I've even used nHibernate several years ago for a .NET project; however, I haven't kept up with the topic of ORM in Java and haven't had a chance to use any of these tools.</p>\n\n<p>But, now I may have the chance to begin to use some ORM tools for one of our applications, in an attempt to move away from a series of legacy web services.</p>\n\n<p>I'm having a hard time telling the difference betweeen the JPA spec, what you get with the Hibernate library itself, and what JDO has to offer.</p>\n\n<p>So, I understand that this question is a bit open-ended, but I was hoping to get some opinions on:</p>\n\n<ul>\n<li>What are the pros and cons of each?</li>\n<li>Which would you suggest for a new project?</li>\n<li>Are there certain conditions when it would make sense to use one framework vs the other?</li>\n</ul>\n"},{"tags":["java","mysql","security","hibernate","tomcat"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1049,"score":1,"question_id":6290015,"title":"Tomcat security manager - c3p0 and hibernate","body":"<p>I am using a Tomcat security enabled server, and Hibernate3 with c3p0.\nHere are my policies in catalina.policy (I found these lines on the net and changed a bit):</p>\n\n<pre><code>grant codeBase \"file:${catalina.base}/webapps/omiccir/-\" \n{\n\n    /////////////// FilePermission ////////// \n    permission java.io.FilePermission \"${catalina.home}/log4j.properties\", \"read\"; \n    permission java.io.FilePermission \"${catalina.home}/logging.properties\", \"read\"; \n    permission java.io.FilePermission \"${catalina.home}/hibernate.properties\", \"read\"; \n    permission java.io.FilePermission \"${java.home}/lib/xerces.properties\", \"read\"; \n    //permission java.io.FilePermission \"opproject.log\", \"write\"; \n    //permission java.io.FilePermission \"${catalina.home}/Onepoint Project Home/-\", \"read, write, delete\"; \n\n\n    // FIXME line below is VERY system specific, take care! \n    permission java.io.FilePermission \"/tmp/tomcat6-tmp\", \"write\"; \n\n\n    // thought it was java.io.tmpdir, but may be wrong // \n    permission java.io.FilePermission \"${java.io.tmpdir}/tomcat6-tmp\", \"write\"; \n\n\n    /////////////// LoggingPermission ////////// \n    permission java.util.logging.LoggingPermission \"control\"; \n\n\n    /////////////// PropertyPermission ////////// \n    permission java.util.PropertyPermission \"org.apache.cxf.Logger\", \"read\"; \n    permission java.util.PropertyPermission \"org.apache.commons.logging.*\", \"read\"; \n    permission java.util.PropertyPermission \"log4j.*\", \"read\"; \n    permission java.util.PropertyPermission \"logger.home\", \"read\"; \n    permission java.util.PropertyPermission \"user.*\", \"read\"; \n    permission java.util.PropertyPermission \"org.apache.xerces.*\", \"read\"; \n    permission java.util.PropertyPermission \"ONEPOINT_PROJECT_HOME\", \"read\"; \n    permission java.util.PropertyPermission \"com.sun.xml.bind.v2.*\", \"read\"; \n    permission java.util.PropertyPermission \"com.sun.xml.bind.v2.runtime.JAXBContextImpl.fastBoot\", \"write\"; \n    permission java.util.PropertyPermission \"cglib.debugLocation\", \"read\"; \n    permission java.util.PropertyPermission \"org.dom4j.*\", \"read\"; \n    permission java.util.PropertyPermission \"c3p0.*\", \"read\"; \n    permission java.util.PropertyPermission \"net.sf.ehcache.*\", \"read\"; \n    permission java.util.PropertyPermission \"ANTLR_DO_NOT_EXIT\", \"read\"; \n    permission java.util.PropertyPermission \"ANTLR_USE_DIRECT_CLASS_LOADING\", \"read\"; \n\n\n    /////////////// RuntimePermission ////////// \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.jdbc.odbc\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.tomcat.util.http\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.tomcat.util.http.res\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.reflect.generics.reflectiveObjects\"; \n    permission java.lang.RuntimePermission \"accessClassInPackage.sun.util.calendar\"; \n    permission java.lang.RuntimePermission \"defineClassInPackage.java.lang\"; \n    permission java.lang.RuntimePermission \"getClassLoader\"; \n    permission java.lang.RuntimePermission \"getProtectionDomain\"; \n\n\n\n    /////////////// ReflectPermission ////////// \n    permission java.lang.reflect.ReflectPermission \"suppressAccessChecks\"; \n\n    permission java.net.SocketPermission \"*\", \"resolve\"; \n    permission java.net.SocketPermission \"localhost:5432\", \"connect,resolve\"; \n\n    //What is this line??\n    //permission java.net.SocketPermission \"www.onepoint.at:80\", \"connect,resolve\"; \n\n\n    /////////////// MBean...Permission ///////// \n    permission javax.management.MBeanServerPermission \"createMBeanServer\"; \n    permission javax.management.MBeanPermission \"com.mchange.v2.c3p0.*\", \"*\"; \n    permission javax.management.MBeanTrustPermission \"register\"; \n\n\n    permission java.util.PropertyPermission \"*\", \"read,write\"; \n}\n</code></pre>\n\n<p>I don't know what is wrong, but it seems that there is a problem with c3p0, and this goes away when I use Tomcat without a security manager.</p>\n\n<p>This is my stack trace:</p>\n\n<pre><code>org.apache.jasper.JasperException: org.hibernate.exception.GenericJDBCException: Cannot open connection\n    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:491)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:419)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\norg.hibernate.exception.GenericJDBCException: Cannot open connection\n    org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)\n    org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)\n    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\njava.sql.SQLException: Connections could not be acquired from the underlying database!\n    com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:106)\n    com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529)\n    com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n\nroot cause\n\ncom.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.\n    com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319)\n    com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557)\n    com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477)\n    com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525)\n    com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.hibernate.context.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:345)\n    $Proxy4.beginTransaction(Unknown Source)\n    ir.omicc.classes.Publisher.getTop5News(Publisher.java:100)\n    org.apache.jsp.index_jsp._jspService(index_jsp.java:229)\n    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n    java.security.AccessController.doPrivileged(Native Method)\n    javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n    org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n    org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162)\n</code></pre>\n"},{"tags":["sql-server","hibernate","sql-server-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13211170,"title":"Hibernate configuration for MS SQL Server 2012 Standard","body":"<p>i am new to hibernate and need to configure it for MS SQL-server 2012 standard.\ni found this deprecated article <a href=\"http://stackoverflow.com/questions/3585544/how-to-configure-hibernate-config-file-for-sql-server\">how to configure hibernate config file for sql server</a> but i need a new one. where i can find the driver for the new database (if there is any)!\nthanks for answers</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13210767,"title":"Transaction in HIbernate","body":"<p>In the below code:</p>\n\n<pre><code>SessionFactory sessionFactory = new Configuration().configure(\"student.cfg.xml\").buildSessionFactory();\n    Session session = sessionFactory.openSession();\n    //Transaction tran = session.beginTransaction();\n    session.save(student);\n    //tran.commit();\n    session.flush();\n    session.close();\n</code></pre>\n\n<p>Irrespective of whether I comment/uncomment the Transaction, they works fine i.e. without transaction also save operation is performed successfully. But whn I check the documentation then they always use the transaction before insert update delete. Any specific reasons for the same? Am I missing something?</p>\n\n<p>Please let me know about this. I am fairly confused :(</p>\n\n<p>Regards,</p>\n"},{"tags":["hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":547,"score":1,"question_id":6611437,"title":"How to make Hibernate not drop tables","body":"<p>I am using hibernate and whenever I try to add a record, it drops the table and adds it. It never uses the existing table and make changes on that.</p>\n\n<p>This is the relevant part of my hibernate.cfg.xml:</p>\n\n<pre><code>&lt;hibernate-configuration&gt;\n&lt;session-factory&gt;\n  &lt;property name=\"hibernate.connection.driver_class\"&gt;org.apache.derby.jdbc.ClientDriver&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.url\"&gt;jdbc:derby://localhost:1527/sample&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.username\"&gt;user&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.password\"&gt;password&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.pool_size\"&gt;10&lt;/property&gt;\n  &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n  &lt;property name=\"dialect\"&gt;org.hibernate.dialect.DerbyDialect&lt;/property&gt;\n  &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/property&gt;\n  &lt;property name = \"current_session_context_class\"&gt;thread&lt;/property&gt;\n  &lt;!-- Mapping the entities --&gt;\n&lt;mapping class=\"inputDetails.Table1\"/&gt;\n&lt;mapping class=\"inputDetails.Table2\"/&gt;\n\n\n  &lt;!--mapping resource=\"contact.hbm.xml\"/--&gt;\n&lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>This is how I save data:</p>\n\n<pre><code>SessionFactory factory = new Configuration().configure().buildSessionFactory();\n    Session session = factory.getCurrentSession();\n    session.beginTransaction();\n...\nsession.save(newrecord)\nsession.getTransaction().commit();\n</code></pre>\n"},{"tags":["java","hibernate","join"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13202537,"title":"Hibernate Mapping of Join Table with Meta Data","body":"<p>I'm trying to figure out how to map the relationship between two tables through a join table that has some meta data in it.  In short, the three tables represent the page of a form, and each page can contain any number of elements (questions.)  For some reason, the original developer decided that elements could be used on multiple forms.  This means that the weight column, used to order the elements on the page, is in the join table.</p>\n\n<p><img src=\"http://i.stack.imgur.com/GVzEj.jpg\" alt=\"enter image description here\"></p>\n\n<p>How the heck do I map this in XML?  (Annotations aren't an option.)</p>\n\n<p>For the join table, I guess it's like this:</p>\n\n<pre><code>&lt;class name=\"com.foo.bar.model.db.ApplicationPageElements\"  \n       table=\"APPLICATION_PAGE_ELEMENTS\"&gt;\n    &lt;composite-id name=\"id\" class=\"com.foo.bar.model.db.ApplicationPageElementsKey\"&gt;\n        &lt;key-property name=\"pageId\" column=\"page_id\"/&gt;\n        &lt;key-property name=\"elementId\" column=\"element_id\"/&gt;\n    &lt;/composite-id&gt;\n    &lt;property name=\"weight\" type=\"java.lang.Long\"&gt;\n        &lt;column name=\"WEIGHT\" precision=\"0\" /&gt;\n    &lt;/property&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>My instincts have me wanting to do something like this from the ApplicationPage side of things:</p>\n\n<pre><code>&lt;set name=\"applicationElements\" table=\"applicationPageElement\"&gt;\n    &lt;key column=\"page_id\"/&gt;\n    &lt;many-to-many column=\"element_id\" unique=\"true\"\n          class=\"com.foo.bar.model.db.ApplicationElements\" /&gt;        \n&lt;/set&gt;\n</code></pre>\n\n<p>And that's where I get all slack-jawed, stare at the screen, and sob.</p>\n\n<p>We're using .hbm.xml files to map our database.  We also made the decision to not change our database.</p>\n\n<p>Any ideas on how to map this in XML?</p>\n"},{"tags":["java","hibernate","postgresql","full-text-search"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":43,"score":1,"question_id":12986485,"title":"Postgres fts - conditions after fts is not working","body":"<p>I have a following query. While executing this query, the conditions after fts is not executing. Hibernate is ignoring this</p>\n\n<pre><code>Session session = getSession();\nString queryString = \"select prj from AppPrjProject prj where prj.firmId =39302 and \" +  \n\"fts('english',prj.searchColumn,'management') = true) and prj.projectId in \" + \n\"(select prjPeople.appPrjProject.projectId from  AppPrjProjectPeople prjPeople \" +\n\"where prjPeople.firmId = 39302 and prjPeople.appHrEmployee.employeeId=15260) \" +\n\"order by prj.name asc\";\n\nQuery query = session.createQuery(queryString);\n</code></pre>\n\n<p>Can any one pls give the solution for this. Any wrong with my code?</p>\n"},{"tags":["spring","hibernate","activemq","apache-camel","spring-transactions"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13209406,"title":"Apache Camel Shared Transaction Resource","body":"<p>I have a Spring-Camel app backed with a Mysql+Hibernate on a Tomcat. I'm trying to implement a <a href=\"http://camel.apache.org/transactional-client.html\" rel=\"nofollow\">transacted route</a> that consumes from embedded ActiveMQ queue, makes some db based duplicate check and produces to another embedded ActiveMQ queue.</p>\n\n<p>To provide transactionality I'm using <a href=\"http://www.javaworld.com/javaworld/jw-01-2009/jw-01-spring-transactions.html?page=4\" rel=\"nofollow\">Shared Transaction Resource pattern</a>. Both Hibernate sessionFactory and ActiveMQ BrokerService JDBCPersistenceAdapter use the same datasource.</p>\n\n<p>Camel endpoints use HibernateTransactionManager(PROPAGATION_REQUIRES_NEW). It seems to be working but I want to clarify if this is a bulletproof approach in case of system crash, failure,</p>\n\n<p>Do I need to migrate to jta, 2PC?</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13208701,"title":"Does Updating a child object make the parent object dirty?","body":"<p>Suppose I do something like this in a session</p>\n\n<pre><code>Parent temp = session.get(parentid);\ntemp.getChildren.get(0).setName('test');\n\n//close session and transaction\ntx.commit()\nsession.close();\n</code></pre>\n\n<p>I know that adding or removing a child will cause corresponding database changes but what about this scenario?</p>\n\n<p>And also do I need to enable the cascade = \"save-update\" in order to do this?</p>\n"},{"tags":["java","hibernate","criteria-api","hibernate-criteria"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13208412,"title":"Criteria for embedded key data","body":"<p>Good day, guys. I 've come accross a problem with creating criteria and cant sort it out.\nHere's my objects:</p>\n\n<pre><code>    @Embeddable\n    public class Pk {\n    @ManyToOne(optional = false)\n    @JoinColumn(name = \"SUBKEY1_ID\", nullable = false, \n              referencedColumnName = \"ID\")\n    private SubKey1 subKey1;\n    @ManyToOne(optional = false)\n    @JoinColumn(name = \"SUBKEY2_ID\", nullable = false, \n              referencedColumnName = \"ID\")\n    prviate subKey2 subKey2;\n    ... getters setters\n}\n\n @Entity\n    @Table(name = \"TABLENAME\", schema = \"SCHEMANAME\")\n    @AssociationOverrides({\n        @AssociationOverride(name = \"pk.subKey1\", joinColumns =\n        @JoinColumn(name = \"SUBKEY1_ID\")),\n        @AssociationOverride(name = \"pk.subKey2\", joinColumns =\n        @JoinColumn(name = \"SUBKEY2_ID\"))\n    })\n    public class Entity1 {\n    @EmbeddedId\n    private Pk pk = new Pk();\n    ... other fields\\getters setters\n    }\n</code></pre>\n\n<p>So, i want to get some fields of pk.subkey1. \nI wrote criteria to load whole object, and after that, i can get all necessary fields through getters.</p>\n\n<pre><code>Criteria criteria = Entity1DAO.instance().createCriteria();\n        criteria.createAlias(\"activity\", \"activity\")\n                .createAlias(\"pk.subKey1\", \"subKey1\")\n                .setProjection(Projections.projectionList()\n                        .add(Projections.property(\"activity.product\"))\n                        .add(Projections.property(\"pk.subKey1\"))\n                        .add(Projections.property(\"field\")))\n                .add(Restrictions.eq(\"activity.prodDate\", date))\n                .addOrder(Order.asc(\"pk.subKey1.id\"));\n</code></pre>\n\n<p>But here i cant add any restrictions on <strong>pk</strong>.<em>subKey1</em> object (for example - i need to restrict records by <strong>subKey1</strong>.<em>enabled</em> flag) \n- because criteria dont do any joins of table related to subKey1 object. its ok, i can skip all records where <strong>subKey1</strong>.<em>enabled</em> = <strong>false</strong> in java-code, but is's weird.</p>\n\n<p>And now, i tried to create criteria to get not objects, but some certain fields of objects.</p>\n\n<pre><code>criteria.createAlias(\"activity\", \"activity\")\n                .createAlias(\"pk.subKey1\", \"subKey1\")\n                .createAlias(\"subKey1.zone\", \"zone\")\n                .setProjection(Projections.projectionList()\n                        .add(Projections.property(\"activity.product.id\"))\n                        .add(Projections.property(\"subKey1.id\"))\n                        .add(Projections.property(\"subKey1.zone.id\"))\n                        .add(Projections.property(\"zone.description\"))\n                        .add(Projections.property(\"dryQty\")))\n                .add(Restrictions.eq(\"activity.prodDate\", date))\n                .add(Restrictions.eq(\"subKey1.enabled\", true))\n                .addOrder(Order.asc(\"pk.subKey1.id\"));\n</code></pre>\n\n<p>But criteria doesnt do any joins (there 's only one join for activity field :( ) of necessary tables (<strong>subKey1</strong> and <strong>zone</strong> table) to get data and sql query crushes with exception, that it cant find columns.\n(Field <em>zone</em> of <em>subkey1</em> is object with its own table).</p>\n\n<p><strong>So, where did i make mistake, how do i refer to fields of objects to be fields of embedded id?</strong></p>\n"},{"tags":["java","hibernate","jpa","uniqueidentifier","id-generation"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1906,"score":1,"question_id":10041938,"title":"How to choose the id generation strategy when using hibernate","body":"<p>I was going through Id generation section of the Hibernate reference guide and \"java persistence with Hibernate\"</p>\n\n<p>There are quite a few options available with Hibernate and JPA combined.</p>\n\n<p>I was looking for a further documentation on how to choose the specific id generation strategy.</p>\n\n<p>I am also looking for tipping points.</p>\n\n<p>For example, hilo strategy is expected to reduce contention. I am assuming there must be a trade off associated with this choice. </p>\n\n<p>I want to be educated about the trade offs.</p>\n\n<p>Is there any literature available? </p>\n"},{"tags":["java","spring","hibernate","persistence","jax-rs"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13096250,"title":"JAX-RS + jersy persistence","body":"<p>I am creating a Rest Server using JAX-RS (Jersy) + Spring. My DB layer is MySQL.</p>\n\n<p>What would be the best way to store my data in my DB? Is there any alternative to Hibernate? I have never worked in Hibernate but there seems to be a lot of XML files and configuration. </p>\n\n<p>It would be easier to use Grails or ROR instead. Can anyone point me out a better solution to persist my data in the project? </p>\n"},{"tags":["hibernate","jpa","jpa-2.0","hibernate-entitymanager"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1583,"score":2,"question_id":4077075,"title":"Declared metamodel attributes work fine BUT Inherited Metamodel Attributes are NULL. Why?","body":"<p>I am not able to run the following test:-</p>\n\n<pre><code>@Test\npublic void test() {\n    EntityManager em = entityManagerFactory.createEntityManager();\n    em.getTransaction().begin();\n\n    CriteriaBuilder builder = em.getCriteriaBuilder();\n    CriteriaQuery&lt;Project&gt; query = builder.createQuery(Project.class);\n\n    Root&lt;Project&gt; project = query.from(Project.class);\n\n    Path&lt;String&gt; name = project.get(Project_.name);\n    Assert.assertNotNull(name);\n\n    Path&lt;EntityLifeCycleImpl&gt; lifeCycle = project.get(Project_.lifeCycle); // problem is here, throws NullPointer\n    Assert.assertNotNull(lifeCycle);\n}\n</code></pre>\n\n<p>it throws NullPointerException at <code>project.get(Project_.lifeCycle)</code> line. Why?</p>\n\n<pre><code>java.lang.NullPointerException\n    at org.hibernate.ejb.criteria.path.AbstractPathImpl.get(AbstractPathImpl.java:138)\n</code></pre>\n\n<p><strong>PersistenceEntityBase.java</strong></p>\n\n<pre><code>import org.hibernate.annotations.GenericGenerator;\n        @MappedSuperclass\n@Access(AccessType.PROPERTY)\npublic abstract class PersistentEntityBase {\n\nprotected String identifier;\n\nprotected EntityLifeCycleImpl lifeCycle = new EntityLifeCycleImpl();\n\nprotected PersistentEntityBase() {\n}\n\n@Id\n@GeneratedValue(generator=\"generator\") \n@GenericGenerator(name=\"generator\", strategy=\"guid\", parameters = {})\n@Column(name=\"identifier\")\npublic String getIdentifier() {\n    return identifier;\n}\n\npublic void setIdentifier(String identifier) {\n    this.identifier = identifier;\n}\n\n@Embedded\npublic EntityLifeCycleImpl getLifeCycle() {\n    return lifeCycle;\n}\npublic void setLifeCycle(EntityLifeCycleImpl lifeCycle) {\n    this.lifeCycle = lifeCycle;\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>Project.java</strong></p>\n\n<pre><code>@Entity\n@Table(name=\"project\")\n@Access(AccessType.PROPERTY)\npublic class Project extends PersistentEntityBase {\n\n    private String name;\n\n    protected Project() {\n    }\n\n    public Project(String name) {\n        this();\n        this.name = name;\n    }\n\n    @Column(name=\"name\", nullable=false, unique=true)\n    public String getName() {\n        return name;\n}\npublic void setName(String name) {\n    this.name = name;\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>EntityLifeCycleImpl.java</strong></p>\n\n<pre><code>@Embeddable\npublic class EntityLifeCycleImpl implements EntityLifeCycle {\n    private String createdBy;\n    private Date createdDate;\n       @Column(name=\"created_by\")\npublic String getCreatedBy() {\n    return createdBy;\n}\npublic void setCreatedBy(String createdBy) {\n\n    this.createdBy = createdBy;\n}\n\n@Column(name=\"created_date\")\npublic Date getCreatedDate() {\n    return createdDate;\n}\npublic void setCreatedDate(Date createdDate) {\n    this.createdDate = createdDate;\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>PersistentEntityBase_.java</strong> (Generated using Hibernate Metamodel Generator)</p>\n\n<pre><code>   @StaticMetamodel(PersistentEntityBase.class)\npublic abstract class PersistentEntityBase_ {\n    public static volatile SingularAttribute&lt;PersistentEntityBase, EntityLifeCycleImpl&gt; lifeCycle;\n        public static volatile SingularAttribute&lt;PersistentEntityBase, String&gt; identifier;\n     }\n</code></pre>\n\n<p><strong>Project_.java</strong></p>\n\n<pre><code>    @StaticMetamodel(Project.class)\npublic abstract class Project_ extends PersistentEntityBase_ {\n    public static volatile SingularAttribute&lt;Project, String&gt; name;\n    }\n</code></pre>\n\n<p><strong>EntityLifeCycleImpl_.java</strong></p>\n\n<pre><code>   @StaticMetamodel(EntityLifeCycleImpl.class)\npublic abstract class EntityLifeCycleImpl_ {\n    public static volatile SingularAttribute&lt;EntityLifeCycleImpl, String&gt; createdBy;\n    public static volatile SingularAttribute&lt;EntityLifeCycleImpl, Date&gt; createdDate;\n}\n</code></pre>\n\n<p><strong>persistence.xml</strong> (only relavent part)</p>\n\n<pre><code>&lt;class&gt;com.comp.timetracking.entity.PersistentEntityBase&lt;/class&gt;\n&lt;class&gt;com.comp.timetracking.entity.Project&lt;/class&gt;\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI use hibernate-entitymanager.3.6.0.Final and hibernate-jpamodelgen.1.0.0.Final.</p>\n\n<p><strong>EDIT 2</strong>\n@Pascal <br/>\nI think Hibernate EM 3.6.0.Final allows us to define <code>@Embedded</code> annotated field at <code>@Entity</code> level but it denies such field at <code>@MappedSuperclass</code> level. What do you say?</p>\n\n<p>As I cannot see \"file upload option\" here, I've uploaded the TestCase in my esnips account. <a href=\"http://www.esnips.com/doc/6810954f-168a-48de-ba1e-5b631784b795/embedded-singular-attribute\" rel=\"nofollow\">Download</a> the maven-based-project and run <code>SingularAttributeTest.java</code>. And checkout the console output</p>\n\n<pre><code>ERROR main metamodel.MetadataContext:413 - Unable to locate static metamodel field : timetracking.entity.Employee_#lifeCycle\n</code></pre>\n\n<p>Click on \"<strong>Download embedded-singular-attribute.zip</strong>\" link to download the file WITHOUT installing the download manager. (If you click on <code>Download link with Green arrow</code>, you'll have to install the download manager!!)</p>\n"},{"tags":["java","spring","hibernate","multi-tenant"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13204558,"title":"Abstract class varible with spring","body":"<p>I am using spring and Hibernate and Dao design pattern for the my project, In my <code>GenericDaoImpl</code>(Abstract class) class has \"tenentId\", I want to set the \"tenentId\" when use login to the System. My other DaoImpl classes extends from <code>GenericDaoImpl</code>, so I need to set the tenentId(It's define in <code>GenericDaoImpl</code>) user login time and reset the \"tenentId\" when user log out.</p>\n\n<p>What is the best way to do this?</p>\n\n<p>In my test cases I tried @Autowired the \"GenericDaoImpl\" but I couldn't do that, It throws an exception telling, <code>org.springframework.beans.factory.NoSuchBeanDefinitionException: No unique bean of type</code>. I know the problem now,</p>\n\n<p>(We can't create instance of abstract classes,if use tenantId as static variable, is it going to be a problem?)\nCan any one suggest me any solution?</p>\n\n<p>Thank you,\nUdeshika  </p>\n"},{"tags":["spring","hibernate","testng"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13206153,"title":"How to prevent test from cleaning up db before each test in TestNG?","body":"<p>I have a test like this:</p>\n\n<pre><code> @RunWith(SpringJUnit4ClassRunner.class),\n @ContextConfiguration(locations = { \"file:war/WEB-INF/application-context.xml\" })\n @Transactional\n public class ServiceImplTest extends AbstractTestNGSpringContextTests\n {\n     @Autowired\n     private Service service;\n\n     @Test\n     @Rollback(false)\n     public void testCreate()\n     {\n         .....\n         //save an entity to table_A\n         service.save(a);\n     }\n }\n</code></pre>\n\n<p>It seems that the table_A will be cleaned up before each test running(not roolback after test ran),because after each test,all old data entries in the table are cleaned up,only new inserted entry by test is left.How to prevent this \"cleaning\" action?</p>\n"},{"tags":["java","spring","hibernate","junit"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13198968,"title":"Failed to load ApplicationContext: No persistence exception translators found in bean factory","body":"<p>I have an abstract test case created for testing my Spring MVC controllers:</p>\n\n<pre><code>@SuppressWarnings(\"unused\")\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration({\"classpath:META-INF/spring/applicationContext.xml\",\n                        \"classpath:META-INF/spring/applicationContext-jpa.xml\",\n                        \"file:src/main/webapp/WEB-INF/spring/webmvc-config-test.xml\"}) \n@PersistenceContext(name = \"persistenceUnit\")\npublic class TestableControllerTest {\n\n    @Autowired\n    ApplicationContext applicationContext;\n\n    private MockHttpServletRequest request;\n    private MockHttpServletResponse response;   \n    private RequestMappingHandlerAdapter handlerAdapter;\n\n    @Before\n    public void setUp() {\n        request = new MockHttpServletRequest();\n        response = new MockHttpServletResponse();\n\n        handlerAdapter = applicationContext.getBean(RequestMappingHandlerAdapter.class);\n    }\n\n    @Test\n    public void testMethod() {\n\n    }\n\n    private Object getHandler(MockHttpServletRequest request) throws Exception {\n        HandlerExecutionChain chain = null;  \n\n        Map&lt;String, HandlerMapping&gt; map = applicationContext.getBeansOfType(HandlerMapping.class);  \n        Iterator&lt;HandlerMapping&gt; itt = map.values().iterator();  \n\n        while (itt.hasNext()) {  \n            HandlerMapping mapping = itt.next();  \n            chain = mapping.getHandler(request);  \n            if (chain != null) {  \n                break;  \n            }   \n        }  \n\n        if (chain == null) {  \n            throw new InvalidParameterException(\"Unable to find handler for request URI: \" + request.getRequestURI());  \n        }  \n\n        return chain.getHandler();      \n    }\n\n}\n</code></pre>\n\n<p>Running <strong>mvn clean surefire-report:report</strong></p>\n\n<p>Results in:</p>\n\n<pre><code>java.lang.IllegalStateException: Failed to load ApplicationContext\n    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:157)\n    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)\n    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)\n    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:321)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:211)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:288)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:290)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:236)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:134)\n    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:113)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:601)\n    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)\n    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)\n    at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)\n    at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:103)\n    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:74)\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0': Initialization of bean failed; nested exception is java.lang.IllegalStateException: No persistence exception translators found in bean factory. Cannot perform exception translation.\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:728)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)\n    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:103)\n    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:1)\n    at org.springframework.test.context.support.DelegatingSmartContextLoader.loadContext(DelegatingSmartContextLoader.java:228)\n    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)\n    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)\n    ... 30 more\nCaused by: java.lang.IllegalStateException: No persistence exception translators found in bean factory. Cannot perform exception translation.\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.detectPersistenceExceptionTranslators(PersistenceExceptionTranslationInterceptor.java:142)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.&lt;init&gt;(PersistenceExceptionTranslationInterceptor.java:79)\n    at org.springframework.dao.annotation.PersistenceExceptionTranslationAdvisor.&lt;init&gt;(PersistenceExceptionTranslationAdvisor.java:70)\n    at org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor.setBeanFactory(PersistenceExceptionTranslationPostProcessor.java:103)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeAwareMethods(AbstractAutowireCapableBeanFactory.java:1475)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1443)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    ... 42 more\n</code></pre>\n\n<p>Which is odd because not only does my persistence.xml configure a JPA dialect:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"2.0\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"&gt;\n&lt;persistence-unit name=\"persistenceUnit\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;properties&gt;\n            &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQL5InnoDBDialect\"/&gt;\n            &lt;!-- value=\"create\" to build a new database on each run; value=\"update\" to modify an existing database; value=\"create-drop\" means the same as \"create\" but also drops tables when Hibernate closes; value=\"validate\" makes no changes to the database --&gt;\n            &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"create\"/&gt;\n            &lt;property name=\"hibernate.ejb.naming_strategy\" value=\"org.hibernate.cfg.ImprovedNamingStrategy\"/&gt;\n            &lt;property name=\"hibernate.connection.charSet\" value=\"UTF-8\"/&gt;\n            &lt;!-- Uncomment the following two properties for JBoss only --&gt;\n            &lt;!-- property name=\"hibernate.validator.apply_to_ddl\" value=\"false\" /--&gt;\n            &lt;!-- property name=\"hibernate.validator.autoregister_listeners\" value=\"false\" /--&gt;\n            &lt;property name=\"hibernate.hbm2ddl.import_files\" value=\"dynamic.sql, static.sql\"/&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>But I've also explicitly registered an exception translator in applicationContext-jpa.xml</p>\n\n<pre><code>&lt;bean class=\"org.springframework.orm.hibernate4.HibernateExceptionTranslator\"/&gt;\n</code></pre>\n\n<p>I can't for the life of me work out why the bean factory doesn't offer this instance. Any ideas or suggestions appreciated.</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2872,"score":1,"question_id":4033414,"title":"Hibernate Named Query with Join issue","body":"<p>I am trying to create a named query which joins a two tables based on an id. I am getting a HibernateException saying \"errors in named queries: Users.getAllUsers</p>\n\n<p>the Users bean has a private Set image variable. The UserImages bean is mapped to a table with the images for all the users. This is my named query.</p>\n\n<pre><code>@NamedQueries ({\n    @NamedQuery(name = \"Users.getUserImage\",\n    query(\"from Users as users INNER JOIN fetch users.image as image WHERE users.userId = image.userId\" AND users.userId =: passedId)\n})\n</code></pre>\n\n<p>I pass in the variable one as the passedId argument in the named query.</p>\n\n<p>I am pretty new to hibernate but I was told to use the fetch command for this since I have a set within the User bean which holds a bunch of UserImage bean objects. Anyone see why this would not work? The actual SQL query that I am basing this off of which works in my sql editor is</p>\n\n<p>SELECT * FROM users as u WHERE INNER JOIN user_images as images ON users.userId = images.userId AND users.userId = 1;</p>\n"},{"tags":["hibernate","jpa"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13156856,"title":"jpa children size performance","body":"<p>In my web application I have an Object with a OneToMany relationship with Child. \nWhen selecting my Objects I execute the following query:</p>\n\n<pre><code>from Object o\n</code></pre>\n\n<p>and then i should print for every object how many children it has with </p>\n\n<pre><code>// Foreach\nobject.children.size()\n</code></pre>\n\n<p>Assuming the object has a lot of children (let's say 30'000);\nIs it a waste of resources calling size() or the ORM framework (in my case Hibernate) will take care of that without loading all the children?</p>\n"},{"tags":["java","swing","hibernate","java-ee"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":34,"score":-3,"question_id":13202892,"title":"OpenSwing and Hibernate","body":"<p>I am using a Grid control from OpenSwing Framwork, and I make my HQL query at the loadData from GridDataLocator implementation. I know everything is going right with the query, but the grid just shows column names without values. and there is no error output. The query is the most simple one, just from one entity.</p>\n"},{"tags":["hibernate","view","hql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13202347,"title":"Selecting from force view returns same rows using hibernate query","body":"<pre><code>I am trying to select from a force view using hibernate query language, this query returns the rows but all are identical. Number of rows matches but all are identical. \n\nThe view is join of 4 tables. \n</code></pre>\n\n<p>I am using hibernate 3 for development.</p>\n\n<p>using views is allowed in hibernate or does it lead to inconsistant results if i do a select on view?</p>\n\n<pre><code>When I select from sql prompt, I will get correct rows.\n\nview defination is given below\n\n\n\n\nCREATE OR REPLACE FORCE VIEW \"CUSTOM\".\"USER_ENTITY_PERMISSIONS\" (\"USER_ID\", \"GROUP_ID\", \"ROLE_ID\", \"ENTITY_NAME\", \"ENTITY_TYPE\", \"PERMISSION_TYPE\", \"ENTITY_HIERARCHY\")\nAS\n  SELECT u.ID,\n    ua.GROUP_ID,\n    ur.ID,\n    re.NAME,\n    RE.TYPE,\n    RE.PERMISSION,\n    re.HIERARCHY\n  FROM USERS u,\n    user_usr_grp_assn ua,\n    USER_GRP_ROLE_ASSN ur,\n    ROLE_ENTITY_ASSN re\n  WHERE u.ID     =ua.ID\n  AND UA.GROUP_ID=UR.GROUP_ID\n  AND ur.ID      =re.ID;\n\n\nthe following is the java code used to get the list\n\nList results = session.createQuery(\" from UserEntityPermissionsImpl where userId='\" + userId +\"'\").list();\n</code></pre>\n\n<p>UserEntityPermissionsImpl is a hibernate implementation.</p>\n\n<p>the following entry is made in hibernate.config.xml file.</p>\n\n<pre><code>&lt;mapping class=\"com.cisco.spp.abstractions.rbac.data.impl.UserEntityPermissionsImpl\"/&gt;\n</code></pre>\n\n<p>The defination of <strong>UserEntityPermissionsImpl</strong> class is as follows</p>\n\n<pre><code>    @Entity\n            @Table (name=\"USER_ENTITY_PERMISSIONS\")\n            public class UserEntityPermissionsImpl extends UserEntityPermissions implements Serializable {\n\n/**\nThis class holds information about user,entity,role mapping*/\n**/\n\n                /**\n                 * Serial version UID for this class\n                 */\n                private static final long serialVersionUID = 3826821959615577338L;\n                protected String userId;\n                protected String groupId;\n                protected String roleId;\n                protected String entityName;\n                protected String entityType;\n                protected String permissionType;\n                protected String entityHierarchy;\n\n\n                @Id\n                @Column(name = \"USER_ID\", nullable = false, updatable = false)\n                public String getUserId() {\n                    return userId;\n                }\n                public void setUserId(String userId) {\n                    this.userId = userId;\n                }\n\n                @Column(name = \"GROUP_ID\", nullable = false, updatable = false)\n                public String getGroupId() {\n                    return groupId;\n                }\n                public void setGroupId(String groupId) {\n                    this.groupId = groupId;\n                }\n\n                @Column(name = \"ROLE_ID\", nullable = false, updatable = false)\n                public String getRoleId() {\n                    return roleId;\n                }\n                public void setRoleId(String roleId) {\n                    this.roleId = roleId;\n                }\n\n                @Column(name = \"ENTITY_NAME\", nullable = false, updatable = false)\n                public String getEntityName() {\n                    return entityName;\n                }\n                public void setEntityName(String entityName) {\n                    this.entityName = entityName;\n                }\n\n                @Column(name = \"ENTITY_TYPE\", nullable = false, updatable = false)\n                public String getEntityType() {\n                    return entityType;\n                }\n                public void setEntityType(String entityType) {\n                    this.entityType = entityType;\n                }\n\n                @Column(name = \"PERMISSION_TYPE\", nullable = false, updatable = false)\n                public String getPermissionType() {\n                    return permissionType;\n                }\n                public void setPermissionType(String permissionType) {\n                    this.permissionType = permissionType;\n                }\n\n                @Column(name = \"ENTITY_HIERARCHY\", nullable = false, updatable = false)\n                public String getEntityHierarchy() {\n                    return entityHierarchy;\n                }\n                public void setEntityHierarchy(String entityHierarchy) {\n                    this.entityHierarchy = entityHierarchy;\n                }\n\n                @Override\n                public String toString() {\n                    // TODO Auto-generated method stub\n                    return entityName + \" \" + entityType + \" \" + entityHierarchy + \" \"+permissionType + \"\\n\";\n                }\n\n            }\n\n-------------------------------------------------------------------\n</code></pre>\n"},{"tags":["mysql","spring","hibernate","spring-mvc","jspx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13195806,"title":"Adding data to multiple tables using Spring forms in Spring MVC","body":"<p>I have the following database schema and I need to add data to all three tables using a single view <a href=\"http://i.stack.imgur.com/3HXhC.png\" rel=\"nofollow\">http://i.stack.imgur.com/3HXhC.png</a> (Due to stackoverflow rules, I cannot link the image directly).</p>\n\n<p>What I hope to achieve, is to create an order, have it given an Workshop order id, and have it linked to LineItems which will let the user specify the quantity of items from the Inventory table to be added to the order.</p>\n\n<p>I can create a workshop order in my database, and create a lineitem with the workshop orders id, and add the id and quantity from an inventory item into the lineitem table, and then use the attached code to display each lineitem orderline, with the total amount of items, which item is in the order, total price, customer name etc.</p>\n\n<p>How do I go about creating a view that will let me create an order this way? The flow I imagine is:\nCreate workshop order -> add line items from inventory -> save the order.</p>\n\n<p>Having worked on Spring and Hibernate for only a couple of weeks, I have not really figured out a smart approach to solve this, but hopefully someone in here has. By all means, feel free to criticize my database scheme, my classes and anything else. It may be a stupid design, not well suited for an actual production system. </p>\n\n<p>I have attached my primary classes involved in this.</p>\n\n<p>LineItems.java</p>\n\n<pre><code>@Entity\n@Table(name = \"LINE_ITEMS\")\n@AssociationOverrides({\n@AssociationOverride(name = \"pk.inventory\", \n    joinColumns = @JoinColumn(name = \"INVENTORY_Id\")),\n@AssociationOverride(name = \"pk.workshop\", \n    joinColumns = @JoinColumn(name = \"WORKSHOP_ORDERS_Id\"))\n})\npublic class LineItems implements Serializable {\n\nprivate static final long serialVersionUID = 5703588914404465647L;\n\n\n@EmbeddedId\nprivate LineItemsPK pk = new LineItemsPK();\n\nprivate int quantity;\n\n\npublic LineItems() {\n\n}\n\npublic LineItemsPK getPK() {\n    return pk;\n}\n\npublic void setPK(LineItemsPK pk) {\n    this.pk = pk;\n}\n\n@Column(name = \"WORKSHOP_ORDERS_Id\", nullable=false, updatable=false,    \n    insertable=false)\npublic Long getWorkshopOrdersId() {\n    return getPK().getWorkshop().getId();\n}\n\n@Column(name = \"Id\")\n@JoinColumn(name=\"INVENTORY_Id\", nullable=false, updatable=false, insertable=false)\npublic Long getInventoryId() {\n    return getPK().getInventory().getId();\n}\n\n\n@ManyToOne\npublic Workshop getWorkshop() {\n    return getPK().getWorkshop();\n}\n\npublic void setWorkshop(Workshop workshop) {\n    getPK().setWorkshop(workshop);\n}\n\n@ManyToOne\n@JoinColumn(name = \"INVENTORY_Id\")\npublic Inventory getInventory() {\n    return getPK().getInventory();\n}\n\npublic void setInventory(Inventory inventory) {\n    getPK().setInventory(inventory);\n}\n\n\npublic int getQuantity() {\n    return this.quantity;\n}\n\npublic void setQuantity(int quantity) {\n    this.quantity = quantity;\n}\n\npublic boolean equals(Object o) {\n    if (this == o) {\n        return true;\n    }\n\n    if (o == null || getClass() != o.getClass()) {\n        return false;\n    }\n\n    LineItems that = (LineItems) o;\n\n    if (getPK() != null ? !getPK().equals(that.getPK())\n            : that.getPK() != null) {\n        return false;\n    }\n\n    return true;\n}\n\npublic int hashCode() {\n    return (getPK() != null ? getPK().hashCode() : 0);\n}\n} \n</code></pre>\n\n<p>LineItemsPK.java</p>\n\n<pre><code>@Embeddable\npublic class LineItemsPK implements Serializable {\n\nprivate static final long serialVersionUID = -4285130025882317338L;\n\n@ManyToOne\nprivate Inventory inventory;\n@ManyToOne\nprivate Workshop workshop;\n\npublic Workshop getWorkshop() {\n    return workshop;\n}\n\npublic void setWorkshop(Workshop workshop) {\n    this.workshop = workshop;\n}\n\npublic Inventory getInventory() {\n    return inventory;\n}\n\npublic void setInventory(Inventory inventory) {\n    this.inventory = inventory;\n}\n\n@Override\npublic boolean equals(Object o) {\n    if(this == o) {\n        return true;\n    }\n\n    if(o == null || getClass() != o.getClass()) {\n        return false;\n    }\n\n    LineItemsPK that = (LineItemsPK) o;\n\n    if(workshop != null ? !workshop.equals(that.workshop) : that.workshop != null) {\n        return false;\n    }\n\n    if(inventory != null ? !inventory.equals(that.inventory) : that.inventory != null) {\n        return false;\n    }\n\n    return true;\n}\n\n@Override\npublic int hashCode() {\n    int result;\n    result = (workshop != null ? workshop.hashCode() : 0);\n    result = 31 * result + (inventory != null ? inventory.hashCode() : 0);\n\n    return result;\n}\n}\n</code></pre>\n\n<p>Workshop.java</p>\n\n<pre><code>@Entity\n@Table(name = \"WORKSHOP_ORDERS\")\npublic class Workshop implements Serializable {\n\nprivate static final long serialVersionUID = -8106245965993313684L;\n\npublic Long id;\npublic Long inventoryItemId;\npublic String workshopService;\npublic String workshopNotes;\npublic Long customersId;\npublic Long paymentId;\n\nprivate Customer customer;\nprivate Payment payment;\n\nprivate Set&lt;LineItems&gt; lineItems = new HashSet&lt;LineItems&gt;(0);\n\npublic Workshop() {\n\n}\n\npublic Workshop(Long inventoryItemId, String workshopService, String workshopNotes,\n        Customer customer, Payment payment) {\n\n    this.inventoryItemId = inventoryItemId;\n    this.workshopService = workshopService;\n    this.workshopNotes = workshopNotes;\n    this.customer = customer;\n    this.payment = payment;\n}\n\npublic Workshop(Long inventoryItemId, String workshopService, String workshopNotes,\n        Customer customer, Payment payment, Set&lt;LineItems&gt; lineItems) {\n\n    this.inventoryItemId = inventoryItemId;\n    this.workshopService = workshopService;\n    this.workshopNotes = workshopNotes;\n    this.customer = customer;\n    this.payment = payment;\n\n    this.lineItems = lineItems;\n}\n\n@OneToMany(mappedBy = \"pk.workshop\", fetch = FetchType.LAZY, cascade = CascadeType.ALL)\npublic Set&lt;LineItems&gt; getLineItems() {\n    return this.lineItems;\n}\n\npublic void setLineItems(Set&lt;LineItems&gt; lineItems) {\n    this.lineItems = lineItems;\n}\n\n@ManyToOne\n@JoinColumn(name=\"CUSTOMERS_Id\", nullable = false, insertable = false, updatable = false)\npublic Customer getCustomer() {\n    return customer;\n}\n\npublic void setCustomer(final Customer customer) {\n    this.customer = customer;\n}\n\n@OneToOne(cascade = CascadeType.ALL)\n@JoinColumn(name=\"PAYMENT_Id\", insertable = false, updatable = false, nullable = false)\npublic Payment getPayment() {\n    return payment;\n}\n\npublic void setPayment(final Payment payment) {\n    this.payment = payment;\n}\n\n\n@Id\n@GeneratedValue(strategy = IDENTITY)\n@Column(name = \"Id\", nullable = false)\npublic Long getId() {\n    return id;\n}\n\n@Column(name = \"InventoryItemId\")\npublic Long getInventoryItemId() {\n    return inventoryItemId;\n}\n\n@Column(name = \"WorkshopService\")\npublic String getWorkshopService() {\n    return workshopService;\n}\n\n@Column(name = \"WorkshopNotes\")\npublic String getWorkshopNotes() {\n    return workshopNotes;\n}\n\n@Column(name = \"CUSTOMERS_Id\")\npublic Long getCustomersId() {\n    return customersId;\n}\n\n@Column(name = \"PAYMENT_Id\")\npublic Long getPaymentId() {\n    return paymentId;\n}\n\npublic void setId(Long id) {\n    this.id = id;\n}\n\npublic void setInventoryItemId(Long inventoryItemId) {\n    this.inventoryItemId = inventoryItemId;\n}\n\npublic void setWorkshopService(String workshopService) {\n    this.workshopService = workshopService;\n}\n\npublic void setWorkshopNotes(String workshopNotes) {\n    this.workshopNotes = workshopNotes;\n}\n\npublic void setCustomersId(Long customersId) {\n    this.customersId = customersId;\n}\n\npublic void setPaymentId(Long paymentId) {\n    this.paymentId = paymentId;\n}\n\npublic String toString() {\n    return \"Customer id: \" + this.customersId + \"Notes: \" + workshopNotes;\n}\n}\n</code></pre>\n\n<p>Inventory.java</p>\n\n<pre><code>@Entity\n@Table(name = \"INVENTORY\")\npublic class Inventory implements Serializable {\n\nprivate static final long serialVersionUID = -8907719450013387551L;\n\nprivate Long id;\nprivate String itemName;\nprivate String itemVendorName;\nprivate Long itemInventoryStatus;\nprivate Double itemBuyPrice;\nprivate Double itemSellPrice;\n\nprivate Set&lt;LineItems&gt; lineItems = new HashSet&lt;LineItems&gt;(0);\n\npublic Inventory() {\n\n}\n\npublic Inventory(String itemName, String itemVendorName, Long itemInventoryStatus,\n        Double itemBuyPrice, Double itemSellPrice) {\n    this.itemName = itemName;\n    this.itemVendorName = itemVendorName;\n    this.itemInventoryStatus = itemInventoryStatus;\n    this.itemBuyPrice = itemBuyPrice;\n    this.itemSellPrice = itemSellPrice;\n}\n\npublic Inventory(String itemName, String itemVendorName, Long itemInventoryStatus,\n        Double itemBuyPrice, Double itemSellPrice, Set&lt;LineItems&gt; lineItems) {\n    this.itemName = itemName;\n    this.itemVendorName = itemVendorName;\n    this.itemInventoryStatus = itemInventoryStatus;\n    this.itemBuyPrice = itemBuyPrice;\n    this.itemSellPrice = itemSellPrice;\n\n    this.lineItems = lineItems;\n}\n\n@OneToMany(mappedBy = \"pk.inventory\", fetch = FetchType.LAZY, cascade = CascadeType.ALL)\npublic Set&lt;LineItems&gt; getLineItems() {\n    return this.lineItems;\n}\n\npublic void setLineItems(Set&lt;LineItems&gt; lineItems) {\n    this.lineItems = lineItems;\n}\n\n\n@Id\n@Column(name = \"Id\", nullable = false)\n@GeneratedValue(strategy = IDENTITY)\npublic Long getId() {\n    return this.id;\n}\n\n@Column(name = \"ItemName\")\npublic String getItemName() {\n    return this.itemName;\n}\n\n@Column(name = \"ItemVendorName\")\npublic String getItemVendorName() {\n    return this.itemVendorName;\n}\n\n@Column(name = \"ItemInventoryStatus\")\npublic Long getItemInventoryStatus() {\n    return this.itemInventoryStatus;\n}\n\n@Column(name = \"ItemBuyPrice\")\npublic Double getItemBuyPrice() {\n    return this.itemBuyPrice;\n}\n\n@Column(name = \"ItemSellPrice\")\npublic Double getItemSellPrice() {\n    return this.itemSellPrice;\n}\n\n\npublic void setId(Long id) {\n    this.id = id;\n}\n\npublic void setItemName(String itemName) {\n    this.itemName = itemName;\n}\n\npublic void setItemVendorName(String itemVendorName) {\n    this.itemVendorName = itemVendorName;\n}\n\npublic void setItemInventoryStatus(Long itemInventoryStatus) {\n    this.itemInventoryStatus = itemInventoryStatus;\n}\n\npublic void setItemBuyPrice(Double itemBuyPrice) {\n    this.itemBuyPrice = itemBuyPrice;\n}\n\npublic void setItemSellPrice(Double itemSellPrice) {\n    this.itemSellPrice = itemSellPrice;\n}\n\npublic String toString() {\n    return \"Item id:\" + this.id + \" ItemName: \" + this.itemName +\n            \" ItemInventoryStatus: \" + this.itemInventoryStatus +\n            \" ItemBuyPrice: \" + this.itemBuyPrice + \" ItemSellPrice \" + this.itemSellPrice;\n}\n}\n</code></pre>\n"},{"tags":["java","hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13195369,"title":"hibernate buildSessionFactory ClassFormatError:","body":"<p>ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/persistence/InheritanceType</p>\n\n<p>I got this error when try to build sessionFactory\nmy hibernate.cfg.xml file :</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.bytecode.use_reflection_optimizer\"&gt;false&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;mateusz&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;mateusz123&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/carpool&lt;/property&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;mapping class=\"org.mathew.data.User\"&gt;&lt;/mapping&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>my HibernateUtil class:</p>\n\n<pre><code>public class HibernateUtil {\n\n    private static final SessionFactory sessionFactory = buildSessionFactory();\n\n    private static SessionFactory buildSessionFactory() {\n        try {\n            // Create the SessionFactory from hibernate.cfg.xml\n            return new AnnotationConfiguration().configure().buildSessionFactory();\n\n        }\n        catch (Throwable ex) {\n            // Make sure you log the exception, as it might be swallowed\n            System.err.println(\"Initial SessionFactory creation failed.\" + ex);\n            throw new ExceptionInInitializerError(ex);\n        }\n    }\n\n    public static SessionFactory getSessionFactory() {\n        return sessionFactory;\n    }\n\n    public static void shutdown() {\n        // Close caches and connection pools\n        getSessionFactory().close();\n    }\n\n}\n</code></pre>\n\n<p>StackTrace:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.ExceptionInInitializerError\n    at org.mathew.hibutil.HibernateUtil.buildSessionFactory(HibernateUtil.java:19)\n    at org.mathew.hibutil.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:8)\n    at org.mathew.mysql.MySqlQueries.&lt;init&gt;(MySqlQueries.java:16)\n    at org.mathew.test.AppMain.main(AppMain.java:8)\nCaused by: java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/persistence/InheritanceType\n    at java.lang.ClassLoader.defineClass1(Native Method)\n    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)\n    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)\n    at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)\n    at java.net.URLClassLoader.access$100(URLClassLoader.java:71)\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:361)\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n    at org.hibernate.cfg.InheritanceState.extractInheritanceType(InheritanceState.java:51)\n    at org.hibernate.cfg.InheritanceState.&lt;init&gt;(InheritanceState.java:21)\n    at org.hibernate.cfg.AnnotationBinder.buildInheritanceStates(AnnotationBinder.java:2146)\n    at org.hibernate.cfg.AnnotationConfiguration.processArtifactsOfType(AnnotationConfiguration.java:492)\n    at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:277)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1319)\n    at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)\n    at org.mathew.hibutil.HibernateUtil.buildSessionFactory(HibernateUtil.java:13)\n    ... 3 more\n</code></pre>\n\n<p>My libraries:</p>\n\n<pre><code>cglib\ncommons-collections\ncommons-logging\ndom4j\nhibernate3\nhibernate-annotations\nhibernate-commons-annotations\nhibernate-core\njava-api-6.0\njavassist\njta\nlog4j\nmysql-connector-java\npersistence-api\nslf4j\nslf4j-log4j\n</code></pre>\n\n<p>I can't upload image :)</p>\n\n<p>I would be thankfull if anybody can help.\nTHANKS! :)</p>\n"},{"tags":["mysql","hibernate","reverse-engineering","myeclipse"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2786,"score":0,"question_id":306722,"title":"Why does MyEclipse's Hibernate Reverse-engineering creates multiple classes when mapping certain tables?","body":"<p>I have a table in my MYSQL database which does not have a primary key, but has a unique key on two columns.  When using MyEclipse's Hibernate reverse engineer tool to create a mapping for that table, it generates two classes, one for named after the table itself, and one with an \"Id\" suffix.  It seems most of the useful methods ended up in the Id class, so it seems that is the one you would instantiate and save to persist data.  I can appreciate the fact that the Id class is created in order to represent a unique row in the table / mapped object, but what is the use of splitting out this into two classes, and what, then is the use of the non-Id-suffixed class?</p>\n\n<p>My colleague argues you can accomplish the same with just one class and scoffs at using the reverse engineering for these tables which don't have a primary key.  I, on the other hand, assume MyEclipse developers are much smarter than me and that there is a really good reason to do it this way.  Is there?</p>\n"},{"tags":["hibernate","jpa","jdo","datanucleus"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12952460,"title":"Mix JDO (DataNucleus) and JPA (Hibernate) objects in one transaction","body":"<p>Is this going to be a problem?</p>\n\n<p>I have a legacy system which uses javax.jdo API and XML mapping to handle writing/reading it's objects from the DB.</p>\n\n<p>I also have some code that extends this system, this part is using JPA with Hibernate (via annotations, with Spring managed declarative transactions). </p>\n\n<p>I would like to get them under the same umbrella, so I can manage the transactions better. I want to rewrite my code to use DataNucleus, but I'd like to stick with JPA (so I don't have to change the mappings, etc .. ).</p>\n\n<p>So the question is: is it possible to mix JPA nad JDO in two parts of the project and span transactions over the mix? or do I have to choose only one approach?</p>\n\n<p>Thanks for the help.</p>\n"},{"tags":["java","hibernate","many-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13198977,"title":"Hibernate many-to-many relationship","body":"<p>I have two mapped types, related many-to-many.</p>\n\n<pre><code>@Entity\n@Table(name = \"students\")\npublic class Student{\n\n...\n\n@ManyToMany(fetch = FetchType.EAGER)\n@JoinTable(\n    name = \"students2courses\",\n    joinColumns = { @JoinColumn(\n        name = \"student_id\",\n        referencedColumnName = \"_id\") },\n    inverseJoinColumns = { @JoinColumn(\n        name = \"course_id\",\n        referencedColumnName = \"_id\") })\n\npublic Set&lt;Course&gt; getCourses() {\n    return courses;\n}\n\npublic void setCourses(Set&lt;Course&gt; courses) {\n    this.courses = courses;\n}\n\n...\n}\n</code></pre>\n\n<p>__</p>\n\n<pre><code>@Entity\n@Table(name = \"courses\")\npublic class Course{\n\n...\n\n@ManyToMany(fetch = FetchType.EAGER, mappedBy = \"courses\")\n\npublic Set&lt;Student&gt; getStudents() {\n    return students;\n}\n\npublic void setStudents(Set&lt;Student&gt; students) {\n    this.students = students;\n}\n\n...\n}\n</code></pre>\n\n<p>But if I update/delete Course entity, records are not created/deleted in table students2courses. (with Student entity updating/deleting goes as expected)</p>\n\n<p>I wrote abstract class HibObject</p>\n\n<pre><code>public abstract class HibObject {\n    public String getRemoveMTMQuery() {\n        return null;\n    }\n}\n</code></pre>\n\n<p>which is inherited by Student and Course.</p>\n\n<p>In DAO I added this code (for delete() method):</p>\n\n<pre><code>String query = obj.getRemoveMTMQuery();\nif (query != null) {\n    session.createSQLQuery(query).executeUpdate();\n}\n</code></pre>\n\n<p>and I ovrerided method getRemoveMTMQuery() for Course</p>\n\n<pre><code>@Override\n@Transient\npublic String getRemoveMTMQuery() {\n    return \"delete from students2courses where course_id = \" + id + \";\";\n}\n</code></pre>\n\n<p>Now it works but I think it's a bad code.</p>\n\n<p>Is there a best way to solve this problem?</p>\n"},{"tags":["java","hibernate","java-ee","cascade"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13199541,"title":"Cascade.ALL, but just clearing reference on delete?","body":"<p>I have a @ManyToOne entry within one of my entities. If I delete the surrounding entity, I'm getting a <code>deleted object would be re-saved by cascade (remove deleted object from associations)</code></p>\n\n<p>But I need the cascade option there, so: how can I cascade anywhing <em>beside</em> delete, respectively just <em>clear</em> the reference instead of cascading the deletion?</p>\n"},{"tags":["java","hibernate","orm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13199045,"title":"hibernate many to one mapping, should I insert this way?","body":"<p>Let's say we have two tables, <code>user</code> and <code>domain</code>. User may have one Domain, one Domain may be for many users. So we will do unidirectional many to one:</p>\n\n<pre><code>@Entity\n@Table(name = \"DOMAIN\")\npublic class Domain implements Serializable\n{\n    @Id\n    @Column(name = \"DOMAIN_ID\")\n    private Integer domainId;\n\n    @Column(name = \"NAME\")\n    private String domainName;\n}\n\n@Entity\n@Table(name = \"\\\"USER\\\"\")\npublic class User implements Serializable\n{\n    @Id\n    @GeneratedValue(generator = \"USER_SEQ\")\n    @GenericGenerator(name = \"USER_SEQ\", strategy = \"sequence\", parameters = @Parameter(name = \"sequence\", value = \"SEQ_USER_ID\"))\n    @Column(name = \"USER_ID\", nullable = false)\n    private Long userId;\n\n    @Column(name = \"FIRST_NAME\")\n    private String firstName;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"DOMAIN_ID\")\n    @ForeignKey(name = \"DOMAIN_ID\")\n    private Domain domain;\n}\n</code></pre>\n\n<p><code>Domain</code> table is something unchangable, dictionary. While <code>User</code> is editable table.</p>\n\n<p>I'm creating a basic form where user selects domain in which new user will be created. Lets say that my controller received those data:</p>\n\n<pre><code>Integer domainId = 1;\nString firstName = \"aaa\";\n</code></pre>\n\n<p>So I'm creating new user:</p>\n\n<pre><code>User newUser = new User();\nnewUser.setFirstName( firstName );\n</code></pre>\n\n<p>Now comes my question, should I do this way?</p>\n\n<pre><code>Domain domain = somthingThatWillFetchObjectFromDb.getDomain( domainId );\nnewUser.setDomain( domain );\n//save user\n</code></pre>\n\n<p>THis will generate additional select, to fetch domain. Of course I can use <code>Integer domainId</code> instead of POJO, but that's not ORM. So once again the question, is this the way it should be done?</p>\n"},{"tags":["hibernate","grails"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":639,"score":3,"question_id":6625515,"title":"clear hibernate cache of specific domain class","body":"<p>Imagine i have following class:</p>\n\n<pre><code>class Test {\n   String name    \n   static mapping = {\n      cache true\n      version false\n}\n</code></pre>\n\n<p>The goal would be to insert rows using native sql on the database level so hibernate wouldn't recognize those changes. how can i notifiy hibnerate about this new rows?</p>\n\n<p>Is there something like -> Test.clearCache?</p>\n"},{"tags":["sql-server","hibernate","hbm2ddl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13174286,"title":"Hibernate hbm2ddl does not create foreign keys on SQLServer 2008","body":"<p>I am trying to generate foreign keys via hibernate hbm2ddl with: </p>\n\n<pre><code>   hibernate.hbm2ddl.auto=update\n</code></pre>\n\n<p>And using the following mapping:</p>\n\n<pre><code>   @OneToOne\n   @ForeignKey(name=\"FK_address_nationality_id\")\n   private Nationality country;\n</code></pre>\n\n<p>It creates the table, with a country column but no foreign key is created.\nWhy might this be?</p>\n"},{"tags":["java","hibernate","orm","scala","types"],"answer_count":5,"favorite_count":5,"up_vote_count":18,"down_vote_count":0,"view_count":725,"score":18,"question_id":2698665,"title":"ORM supporting immutable classes","body":"<p>Which ORM supports a domain model of <strong>immutable</strong> types?</p>\n\n<p>I would like to write classes like the following (or the Scala equivalent):</p>\n\n<pre><code>class A {\n  private final C c; //not mutable\n\n  A(B b) {\n     //init c\n  }\n\n  A doSomething(B b) {\n     // build a new A\n  }\n}\n</code></pre>\n\n<p>The ORM has to <strong>initialized the object with the constructor</strong>. So it is possible to check invariants in the constructor. Default constructor and field/setter access to intialize is not sufficient and complicates the class' implementation.</p>\n\n<p>Working with <strong>collections</strong> should be supported. If a collection is changed it should create a copy from the user perspective. (Rendering the old collection state stale. But user code can still work on (or at least read) it.) Much like the <a href=\"http://en.wikipedia.org/wiki/Persistent_data_structure\">persistent data structures</a> work.</p>\n\n<p>Some words about the motivation. Suppose you have a FP-style domain object model. Now you want to persist this to a database. Who do you do that? You want to do as much as you can in a pure functional style until the evil sides effect come in. If your domain object model is not immutable you can for example not share the objects between threads. You have to copy, cache or use locks. So unless your ORM supports immutable types your constrainted in your choice of solution.</p>\n"},{"tags":["hibernate","design","design-patterns"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":531,"score":0,"question_id":4180983,"title":"design pattern in hibernate?","body":"<p>can anyone tell me what design patterns in hibernate? </p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13197743,"title":"Constructor in persistance class","body":"<p>I am using HIbernate version 3.2.5.</p>\n\n<p>I read the below line in hibernate tutorials:</p>\n\n<p><code>The no-argument constructor is a requirement for all persistent classes.Hibernate has to create objects for you, using Java Reflection. The constructor can be private</code></p>\n\n<p>This is the link for the tutorial:</p>\n\n<p><a href=\"http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html\" rel=\"nofollow\">http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/tutorial.html</a></p>\n\n<p>But when I write a persistence class without a no-arg constructor, then also it works fine (I tried only retrieval part). </p>\n\n<p>Hence where lies the validity of the above statement?</p>\n\n<p>Please let me know if I am getting something worng.</p>\n\n<p>Regards,</p>\n"},{"tags":["spring","hibernate","jsf","transactions","open-session-in-view"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13194511,"title":"OSIV pattern ViewScped","body":"<p>Is there any accepted way to use OSIV pattern in viewscoped; I am trying to use JSF, Spring and Hibernate with JPA</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13179285,"title":"hibernate mapping exception: could not determine type","body":"<p>I found many links regarding this type of error but I didn't find anything explaining for Enumtypes. I downladed the latest hibernate jar files but no use!</p>\n\n<p>Stacktrace of error:</p>\n\n<pre><code>SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [dao-hbm.xml]: Invocation of init method failed; nested exception is org.hibernate.MappingException: Could not determine type for: ca.ups.tundra.dao.MessageSystemUserType, at table: History, for columns: [org.hibernate.mapping.Column(SCANMSGSYS)]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1338)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:473)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:409)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:380)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:264)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:261)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:185)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:164)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:423)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:728)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:380)\n    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:255)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:199)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:45)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4701)\n    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5204)\n    at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5199)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:662)\nCaused by: org.hibernate.MappingException: Could not determine type for: ca.ups.tundra.dao.MessageSystemUserType, at table: History, for columns: [org.hibernate.mapping.Column(SCANMSGSYS)]\n    at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:292)\n    at org.hibernate.mapping.SimpleValue.isValid(SimpleValue.java:276)\n    at org.hibernate.mapping.Property.isValid(Property.java:207)\n    at org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:458)\n    at org.hibernate.mapping.SingleTableSubclass.validate(SingleTableSubclass.java:66)\n    at org.hibernate.cfg.Configuration.validate(Configuration.java:1149)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1334)\n    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.newSessionFactory(LocalSessionFactoryBean.java:814)\n    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:732)\n    at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1369)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1335)\n    ... 23 more\n</code></pre>\n\n<p>Following is my EnumUserType Class:</p>\n\n<pre><code>import org.hibernate.usertype.UserType; \n\npublic class EnumUserType&lt;E extends Enum&lt;E&gt;&gt; implements UserType { \n</code></pre>\n\n<p>extending the EnumUserType class:</p>\n\n<pre><code>public class MessageSystemUserType extends EnumUserType&lt;MessageSystem&gt; {\n</code></pre>\n\n<p>following is my enum class:</p>\n\n<pre><code>public enum MessageSystem { OPSYS, GIPLD, AA, CISCME,LOCAL, TFCS,LH, XPLD, CDC }\n</code></pre>\n\n<p>it was working good untill I added the last two enumtypes.</p>\n\n<p>EDITED: this is how I am mapping the Enums,</p>\n\n<pre><code>&lt;property name=\"messageSystem\" type=\"ca.ups.tundra.dao.MessageSystemUserType\" length=\"10\" column=\"SCANMSGSYS\"/&gt;\n</code></pre>\n\n<p>Any suggestions in fixing this or about the error.</p>\n"},{"tags":["java","database","spring","hibernate","gwt"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13196441,"title":"Self teaching professional java skills","body":"<p>I've been programming in java for a while and I really like the language, I've mostly just done game programming, but I want to get a feel for some of the more commonly used api's and frameworks and just get a generally more well-rounded grasp of the language and the common libraries in the current job market.</p>\n\n<p>From what I found things like spring, hibernate, and GWT are pretty in demand right now. I looked at some tutorials online and they weren't hard to follow but I really felt like I had no context for what I was learning - I had no idea how any of it would be use in a real work environment. I know nothing can rival the benefit I'd get from actual work experience but that's not an option for me right now, I need another way to learn these technologies in a way where I'll at least feel comfortable working with them and know what I'm doing beyond just understanding what code does what. I checked out a few books but they were all really old(like pre-2006, am I right to assume those books would be kind of out of date today?) or required experience with libraries that I didn't have and can't get. I hate getting stuck looking for the best resource to learn something instead of spending my time actually learning.</p>\n\n<p>All I really want is someone to point me to a resource(website or ebook) that is aimed at already experienced java developers and will not only teach me some interesting useful java technology(anything that is useful, I dont know much outside of graphics libraries and game related things so I was thinking some database or web programming api's) but also give me a good perspective of it and leave me feeling confident that I could actually use what I learned on a practical application.</p>\n\n<p>If my post makes you think I'm not yet experienced to be learning these things, which I doubted earlier today but am now starting to question, then what do you think is the next step for me? I just want to get better at java.</p>\n\n<p>Thanks everyone</p>\n"},{"tags":["hibernate","jboss","migration","entitymanager","websphere-7"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13195945,"title":"Nullpointer exception while persisting entity in websphere 7, ear developed and built on Jboss","body":"<p>We have an application being build and tested in JBoss environment. (Hibernate (Entity Beans) + Oracle DB)...when its deployed in websphere 7, the selects work fine; but when the entity manager tries to persist an entity \nwe get a NullPointerException </p>\n\n<pre><code>BusinessExcep E   CNTR0020E: \nEJB has an unexpected (non-declared) exception when the method \"saveOrUpdate\" \nfor bean \"BeanId (application-ear # application-ejb-4.0.1-SNAPSHOT.jar #    \nWorkEditServiceBean, C1104BFD-013A -4000-E000-172CA114A197) \" \nis triggered.Exception data: java.lang.NullPointerException. \n</code></pre>\n\n<p>The entity being persisted has some boolean fields and their corresponding datatypes in the database are varchar2(1). The code works fine in the jboss environment. </p>\n\n<p>Any clues.</p>\n\n<p>STACK TRACE:</p>\n\n<pre><code>11/2/12 14:33:08:083 MET] 0000003d FfdcProvider  W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /app/WAS/dyn/was70/1.0.0.0/profiles/Node_Mit02/logs/ffdc/as_appi_ea320c1_12.11.02_14.33.06.446701466325468961692.txt com.ibm.ejs.container.BusinessExceptionMappingStrategy.setUncheckedException 506\n[11/2/12 14:33:10:195 MET] 0000003d FfdcProvider  W com.ibm.ws.ffdc.impl.FfdcProvider logIncident FFDC1003I: FFDC Incident emitted on /app/WAS/dyn/was70/1.0.0.0/profiles/Node_Mit02/logs/ffdc/as_appi_ea320c1_12.11.02_14.33.08.0887194928887482275608.txt com.ibm.ejs.container.EJSContainer.postInvoke 2326\n[11/2/12 14:33:10:199 MET] 0000003d application   E   javax.ejb.EJBTransactionRolledbackException: nested exception is: javax.ejb.EJBException: See nested exception; nested exception is: java.lang.NullPointerException\n                                 javax.faces.el.EvaluationException: javax.ejb.EJBTransactionRolledbackException: nested exception is: javax.ejb.EJBException: See nested exception; nested exception is: java.lang.NullPointerException\n        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:108)\n        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)\n        at javax.faces.component.UICommand.broadcast(UICommand.java:387)\n        at org.ajax4jsf.component.AjaxViewRoot.processEvents(AjaxViewRoot.java:329)\n        at org.ajax4jsf.component.AjaxViewRoot.broadcastEventsForPhase(AjaxViewRoot.java:304)\n        at org.ajax4jsf.component.AjaxViewRoot.processPhase(AjaxViewRoot.java:261)\n        at org.ajax4jsf.component.AjaxViewRoot.processApplication(AjaxViewRoot.java:474)\n        at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:82)\n        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:100)\n        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:265)\n        at com.ibm.ws.cache.servlet.ServletWrapper.serviceProxied(ServletWrapper.java:307)\n        at com.ibm.ws.cache.servlet.CacheHook.handleFragment(CacheHook.java:576)\n        at com.ibm.ws.cache.servlet.CacheHook.handleServlet(CacheHook.java:250)\n        at com.ibm.ws.cache.servlet.ServletWrapper.service(ServletWrapper.java:259)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1657)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1597)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:131)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:83)\n        at org.jboss.seam.web.IdentityFilter.doFilter(IdentityFilter.java:40)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.MultipartFilter.doFilter(MultipartFilter.java:90)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.ExceptionFilter.doFilter(ExceptionFilter.java:64)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.RedirectFilter.doFilter(RedirectFilter.java:45)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:530)\n        at org.jboss.seam.web.Ajax4jsfFilter.doFilter(Ajax4jsfFilter.java:56)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.LoggingFilter.doFilter(LoggingFilter.java:60)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:206)\n        at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290)\n        at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:388)\n        at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:515)\n        at org.jboss.seam.web.Ajax4jsfFilter.doFilter(Ajax4jsfFilter.java:56)\n        at com.vendo.ams.logic.lead.lead.DownloadCsvFilter.doFilter(DownloadCsvFilter.java:150)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.HotDeployFilter.doFilter(HotDeployFilter.java:53)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at com.vendo.ams.logic.framework.servlet.RichFacesFirefox11Filter.doFilter(RichFacesFirefox11Filter.java:30)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.servlet.SeamFilter.doFilter(SeamFilter.java:158)\n        at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:188)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:116)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:368)\n        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)\n        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.doFilter(AbstractPreAuthenticatedProcessingFilter.java:89)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:169)\n        at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\n        at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\n        at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:188)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:116)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain._doFilter(WebAppFilterChain.java:77)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:908)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:934)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:502)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:179)\n        at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:91)\n        at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:864)\n        at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)\n        at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:186)\n        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)\n        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)\n        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)\n        at com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)\n        at com.ibm.ws.ssl.channel.impl.SSLReadServiceContext$SSLReadCompletedCallback.complete(SSLReadServiceContext.java:1784)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager.requestComplete(WorkQueueManager.java:557)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager.attemptIO(WorkQueueManager.java:607)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager.workerRun(WorkQueueManager.java:984)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager$Worker.run(WorkQueueManager.java:1069)\n        at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604)\nCaused by: javax.ejb.EJBTransactionRolledbackException: nested exception is: javax.ejb.EJBException: See nested exception; nested exception is: java.lang.NullPointerException\nCaused by: javax.ejb.EJBException: See nested exception; nested exception is: java.lang.NullPointerException\nCaused by: java.lang.NullPointerException\n        at com.vendo.ams.logic.framework.template.base.InheritEntity.saveOrUpdateValidated(InheritEntity.java:32)\n        at com.vendo.ams.logic.framework.template.base.InheritEntity.saveOrUpdateValidated(InheritEntity.java:1)\n        at com.vendo.ams.logic.framework.template.custom.AbstractEditCustomEntity.saveOrUpdate(AbstractEditCustomEntity.java:77)\n        at com.vendo.ams.logic.entity.EntityEditServiceBean.saveOrUpdate(EntityEditServiceBean.java:119)\n        at com.vendo.ams.logic.entity.EJSLocal0SFEntityEditServiceBean_96f7c97b.saveOrUpdate(EJSLocal0SFEntityEditServiceBean_96f7c97b.java)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.jboss.seam.util.Reflections.invoke(Reflections.java:22)\n        at org.jboss.seam.intercept.RootInvocationContext.proceed(RootInvocationContext.java:32)\n        at org.jboss.seam.intercept.ClientSideInterceptor$1.proceed(ClientSideInterceptor.java:76)\n        at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:56)\n        at org.jboss.seam.ejb.RemoveInterceptor.aroundInvoke(RemoveInterceptor.java:43)\n        at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:68)\n        at org.jboss.seam.intercept.RootInterceptor.invoke(RootInterceptor.java:107)\n        at org.jboss.seam.intercept.ClientSideInterceptor.invoke(ClientSideInterceptor.java:54)\n        at org.javassist.tmp.java.lang.Object_$$_javassist_seam_14.saveOrUpdate(Object_$$_javassist_seam_14.java)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.jboss.el.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:335)\n        at org.jboss.el.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:280)\n        at org.jboss.el.parser.AstMethodSuffix.getValue(AstMethodSuffix.java:59)\n        at org.jboss.el.parser.AstMethodSuffix.invoke(AstMethodSuffix.java:65)\n        at org.jboss.el.parser.AstValue.invoke(AstValue.java:96)\n        at org.jboss.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:276)\n        at com.sun.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:68)\n        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:94)\n        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)\n        at javax.faces.component.UICommand.broadcast(UICommand.java:387)\n        at org.ajax4jsf.component.AjaxViewRoot.processEvents(AjaxViewRoot.java:329)\n        at org.ajax4jsf.component.AjaxViewRoot.broadcastEventsForPhase(AjaxViewRoot.java:304)\n        at org.ajax4jsf.component.AjaxViewRoot.processPhase(AjaxViewRoot.java:261)\n        at org.ajax4jsf.component.AjaxViewRoot.processApplication(AjaxViewRoot.java:474)\n        at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:82)\n        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:100)\n        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:265)\n        at com.ibm.ws.cache.servlet.ServletWrapper.serviceProxied(ServletWrapper.java:307)\n        at com.ibm.ws.cache.servlet.CacheHook.handleFragment(CacheHook.java:576)\n        at com.ibm.ws.cache.servlet.CacheHook.handleServlet(CacheHook.java:250)\n        at com.ibm.ws.cache.servlet.ServletWrapper.service(ServletWrapper.java:259)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1657)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1597)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:131)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:83)\n        at org.jboss.seam.web.IdentityFilter.doFilter(IdentityFilter.java:40)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.MultipartFilter.doFilter(MultipartFilter.java:90)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.ExceptionFilter.doFilter(ExceptionFilter.java:64)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.RedirectFilter.doFilter(RedirectFilter.java:45)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:530)\n        at org.jboss.seam.web.Ajax4jsfFilter.doFilter(Ajax4jsfFilter.java:56)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.LoggingFilter.doFilter(LoggingFilter.java:60)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:206)\n        at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290)\n        at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:388)\n        at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:515)\n        at org.jboss.seam.web.Ajax4jsfFilter.doFilter(Ajax4jsfFilter.java:56)\n        at com.vendo.ams.logic.lead.lead.DownloadCsvFilter.doFilter(DownloadCsvFilter.java:150)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.web.HotDeployFilter.doFilter(HotDeployFilter.java:53)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at com.vendo.ams.logic.framework.servlet.RichFacesFirefox11Filter.doFilter(RichFacesFirefox11Filter.java:30)\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69)\n        at org.jboss.seam.servlet.SeamFilter.doFilter(SeamFilter.java:158)\n        at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:188)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:116)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:368)\n        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)\n        at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.authentication.preauth.AbstractPreAuthenticatedProcessingFilter.doFilter(AbstractPreAuthenticatedProcessingFilter.java:89)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)\n        at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:380)\n        at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:169)\n        at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\n        at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\n        at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:188)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:116)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterChain._doFilter(WebAppFilterChain.java:77)\n        at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:908)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:934)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:502)\n        at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:179)\n        at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:91)\n        at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:864)\n        at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)\n        at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:186)\n        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)\n        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)\n        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)\n        at com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)\n        at com.ibm.ws.ssl.channel.impl.SSLReadServiceContext$SSLReadCompletedCallback.complete(SSLReadServiceContext.java:1784)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager.requestComplete(WorkQueueManager.java:557)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager.attemptIO(WorkQueueManager.java:607)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager.workerRun(WorkQueueManager.java:984)\n        at com.ibm.ws.tcp.channel.impl.WorkQueueManager$Worker.run(WorkQueueManager.java:1069)\n        at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1604)\n</code></pre>\n"},{"tags":["c#","hibernate","nhibernate","mapping-by-code"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13114693,"title":"Single column joins in NHibernate using mapping by code","body":"<p>Consider the following relationship between Item and ItemContent.</p>\n\n<p><strong>Item</strong><br>\nItemId<br>\nItemName<br></p>\n\n<p><strong>ItemContent</strong><br>\nContentId<br>\nItemId<br>\nContent<br>\nContentType<br></p>\n\n<p>What I would like to do is have a <code>Content</code> property on Item that JOINS the Content column from ItemContent based on ContentType that is provided in the mapping itself or injected in some other way.</p>\n\n<p>What is the best way to accomplish this? What is the simplest way to accomplish this? </p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13195487,"title":"connection proxy error in hibernate","body":"<p>While we get connection through hibernate we arise an error <strong>connection proxy error</strong> while we are using multiple connection's </p>\n\n<p>Error message is like below statements</p>\n\n<pre><code>SEVERE: Servlet.service() for servlet action threw exception org.hibernate.HibernateException: connnection proxy not usable after transaction completion at org.hibernate.jdbc.BorrowedConnectionProxy.invoke(BorrowedConnectionProxy.java:66) at $Proxy0.prepareStatement(Unknown Source) at com.indiamoney.api.advisor.dashboard.dao.impl.AdvisorDashboardDAOImpl.getCustemerRequestsCount(AdvisorDashboardDAOImpl.java:571) at com.indiamoney.api.advisor.dashboard.bo.AdvisorDashboardBO.getCustemerRequestsCount(AdvisorDashboardBO.java:226) at com.indiamoney.advisor.dashboard.action.AdvisorDashboardAction.dashboardDetails(AdvisorDashboardAction.java:307) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org.apache.struts.actions.DispatchAction.dispatchMethod(DispatchAction.java:269) at org.apache.struts.actions.DispatchAction.execute(DispatchAction.java:170) at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:425) at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:228) at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913) at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:449) at javax.servlet.http.HttpServlet.service(HttpServlet.java:690) at javax.servlet.http.HttpServlet.service(HttpServlet.java:803) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:230) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:104) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:261) at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844) at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:581) at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447) at java.lang.Thread.run(Unknown Source) Nov 1, 2012 9:18:37 PM org.apache.tomcat.util.http.Parameters processParameters WARNING: Parameters: Invalid chunk ignored. Nov 1, 2012 9:18:37 PM org.apache.tomcat.util.http.Parameters processParameters WARNING: Parameters: Invalid chunk ignored.\n</code></pre>\n"},{"tags":["java","spring","hibernate","inheritance"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13195284,"title":"Calling method from abstract class","body":"<p>I have the following abstract class</p>\n\n<pre><code>public abstract class ReturnAgentFromTab extends BasePage{\n\n    @Persist(\"session\")\n    public abstract Agent getAgent();\n    public abstract void setAgent(Agent agent);\n\n    @InjectObject(\"spring:agentApplicationModeResolver\")\n    public abstract AgentApplicationModeResolver getAgentApplicationModeResolver();\n\n    .... more @InjectObject()\n\n    public void nextPage(IRequestCycle cycle) {\n\n        setApplicationModeUsingAgentStatus(getAgent());\n\n        AgentSearchNavigationManager navManager = getAgentSearchNavigationManagerFactory().getAgentSearchNavigationManager();\n        FlowStage stage = getFlowStage();\n        if (stage == null) {\n            setApplicationModeUsingAgentStatus(getAgent());\n            stage = getUserDefaultFlowStageService().getDefaultFlowStage(UserHolder.getUser(), getVisitClass().getApplicationMode());\n        }\n\n        Class nextPageClass = navManager.getNextPage(getUserDefaultFlowStageService());\n\n        String nextPageQualifier = getUserDefaultFlowStageService().getPageQualifier(getAgent(), nextPageClass, getVisitClass().getApplicationMode());\n        IPage nextPage = getPageUtils().getPage(nextPageClass, nextPageQualifier);\n        if ((getFlowStage() instanceof PSDFlowStage)) {\n            nextPageQualifier = getFlowStage().getValue();\n        }\n        nextPage = getPageUtils().getPage(nextPageClass, nextPageQualifier);\n        if (navManager instanceof NameBasedAgentSearchNavigationManager &amp;&amp; nextPageClass != SignOffStatusPage.class) {\n            NameBasedAgentSearchNavigationManager nameBasedNavManager = (NameBasedAgentSearchNavigationManager) navManager;\n            String nextPageName = nameBasedNavManager.getNextPageName(stage); \n            if (!nextPageName.equals(nextPageClass.getSimpleName())) {\n                nextPage = getPageUtils().getPage(nextPageName, nextPageQualifier);\n            }\n        }\n\n        if (isNextPageActivateAgentGeneral(nextPage)) {\n            initialisePageLink(nextPageClass, nextPage);\n        }\n        ((WuamsBasePage) nextPage).init(getAgent().getAgentId());\n        getPageUtils().navigateTo(nextPage);\n\n    }\n\n    private void setApplicationModeUsingAgentStatus(Agent agent) {\n        getVisitClass().setApplicationMode(getHomeLinksFactory().getRegionHomeLinksService().getApplicationMode(agent));\n    }\n\n    private boolean isNextPageActivateAgentGeneral(IPage nextPage) {\n        return nextPage instanceof ActiveAgentGeneralPage;\n    }\n\n    private void initialisePageLink(Class nextPageClass, IPage nextPage) {\n        if (getVisitClass().getPageLink() == null) {\n            getVisitClass().setPageLink(PageLinkUtil.getPageLinkMessageKeyFromPageClass(nextPageClass, \n                    getUserDefaultFlowStageService().getDefaultFlowStage(UserHolder.getUser(), getVisitClass().getApplicationMode()).getValue()));\n        }\n    }\n\n}\n</code></pre>\n\n<p>What I want to do is call my <code>nextPage(cycle)</code> from another class that is abstract and extends <code>ReturnAgentFromTab</code>, but when I try </p>\n\n<pre><code>public abstract class DoSomethingWithAgent extends ReturnAgentFromTab {\n\n@Persist(\"session\")\npublic abstract ReturnAgentFromTab getReturnAgentFromTab();\npublic abstract void setReturnAgentFromTab(ReturnAgentFromTab returnAgentFromTab);\n....\ngetReturnAgentFromTab().nextPage(cycle);\n</code></pre>\n\n<p>I get a null pointer exception, I know this is because I am not actually setting ReturnAgentFromTab anywhere but I do not understand how to set it using abstract classes. Can anybody help?</p>\n\n<p>If ye need more code just ask</p>\n"},{"tags":["hibernate","jpa-2.0"],"answer_count":2,"favorite_count":3,"up_vote_count":9,"down_vote_count":1,"view_count":5280,"score":8,"question_id":3035308,"title":"JPA 2.0 Implementations comparison : Hibernate 3.5 vs EclipseLink 2 vs OpenJPA 2","body":"<p>What's your choice? Do You have any suggestions and experience? </p>\n\n<p>I'm developing an application with Hibernate 3.5 and Spring 3.0</p>\n\n<p>Pros:</p>\n\n<ul>\n<li>Good documentation</li>\n<li>Easy configuration and helpful logs</li>\n<li>Popularity - wide community</li>\n<li>Some extensions to JPA</li>\n<li>Some additional Tools - JBoss Tools for Eclipse, hbm2ddl, generating static metamodel etc...</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>Bugs! (Sequences, collections etc...)</li>\n<li>Lots of reatures are doubled with \"pure\" Hibernate. There's a mess in legacy Hibernate and JPA annotations.</li>\n</ul>\n\n<p>I'm considering to switch to EclipseLink. What do You think ?</p>\n\n<p>Edit:</p>\n\n<p>I've tried EclipseLink and have very bad experiences. It seems like EclipseLink needs LoadTimeWeaver and likes to run on OSGi platform rather than simple Jetty or Tomcat environment. I just don't have time for all this configuration stuff.</p>\n"},{"tags":["hibernate","orm","performance"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":535,"score":2,"question_id":4468150,"title":"Hibernate/EclipseLink? Which is best with Weblogic,Oracle DB?","body":"<p>In my company, we are using Oracle DB and Weblogic application server. So in the process to upgrade or switch to new ORM, we shortlisted two options - Hibernate and EclipseLink.</p>\n\n<p>I gathered following summary regarding both ORMs -</p>\n\n<p>Hibernate:</p>\n\n<ol>\n<li>When you need to train people, like we are going to do next week – most of the companies have Hibernate experts.</li>\n<li>When you hire new developers, most of them come with specific Hibernate experience.</li>\n<li>When you need to consult with experts, both in the internet or consultants, you have LOTS of options. Endless forums and communities all regarding Hibernate.</li>\n<li>Hibernate is an open source which has a huge community. This means that it will be improved all the time and will push the ORM market forward.</li>\n<li>Hibernate is an open source which means you have the code to handle, and in case needed, fit it to your needs.</li>\n<li>There are lots of plugins to Hibernate, such as validations tool, audit tools, etc. These becomes standard as well and dismiss you from impl. things yourself.</li>\n<li>One most important thing with ORM tool, is to configure it according to your application’s needs. Usually the default setting doesn’t fit to your needs.\nFor that sake, when the market has a huge experience with the tool’s configuration, and lots of experts (see point 1 and 3) – most of chances you will find similar cases and\nlots of knowledge about how to configure the tool and thus – your application.</li>\n</ol>\n\n<p>EclipseLink:</p>\n\n<ol>\n<li>Fully supported by Oracle. Hibernate no. In case of pb, it could be cumbersome to prove that it is a pure Weblogic one. Concretely, we will have to prove it (waste of time and complexity).</li>\n<li>Eclipse link is developed by Oracle and the preferred ORM in the Weblogic /Oracle DB world.</li>\n<li>Even if at a certain time EclipseLink was a bit late compared to Hibernate (feature), EclipseLink evolved very fast and we can consider now that they close the gap.</li>\n<li>No additional fee as soon as you have Weblogic license. You will need to pays additional fee if you want some professional support on Hibernate.</li>\n<li>We are currently relying on Hibernate for our legacy offer and are facing pb in second level cache (JGroups). Today, we are riding off this part!. Consequences are limitation in clustering approach (perf)</li>\n<li>On EclipseLink side we do succeed to manage first and second level cache in a clustering approach.</li>\n<li>Indeed Hibernate is open source, so you can imagine handling it. In reality, the code is so complex that it is nearly impossible to modify it. Moreover as it is LGPL, you need to feedback all the modified sources to the community systematically.</li>\n<li>All tests performed by Oracle concerning Weblogic are using EclipseLink. Moreover, Oracle says that some specific optimizations are done to manage Oracle DB.</li>\n<li>Hibernate comes from JBoss community.</li>\n</ol>\n\n<p>Right now we are preferring Hibernate but there are concerns/reasons like EclipseLink developed by Oracle and preferred ORM in Webogic/ Oracle DB world (compatibility of ORM with DB and App. server), support comparison with both ORM, which are preventing to finalize the decision.</p>\n\n<p>Please help me with you views and opinions and share you experience with us as which one is better and why so that we can make a perfect decision.</p>\n\n<p>If you want you can also reply to me @ yogesh.golande@gmail.com.</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","hibernate","jpa","concurrency","optimistic-concurrency"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13194748,"title":"Hibernate/JPA version concurrency control and DTO/change command patterns","body":"<p>I would like to use <code>@Version</code> for optimistic concurrency control with JPA &amp; Hibernate.</p>\n\n<p>I know how it works in the typical scenario of two parallel transactions. I also know that if I have a CRUD with 1:1 mapping between the form and entity, I can just pass <code>version</code> along as a hidden field and use this to prevent concurrent modifications by users.</p>\n\n<p>What about more interesting cases, which use DTOs or change command patterns? Is it possible to use <code>@Version</code> in this scenario as well, and how?</p>\n\n<p>Let me give you an example.</p>\n\n<pre><code>@Entity\npublic class MyEntity {\n    @Id private int id;\n    @Version private int version;\n    private String someField;\n    private String someOtherField;\n    // ...\n}\n</code></pre>\n\n<p>Now let's say two users open the GUI for this, make some modifications and save changes (not at the same time, so the transactions don't overlap).</p>\n\n<p>If I pass the entire entity around, the second transaction will fail:</p>\n\n<pre><code>@Transactional\npublic void updateMyEntity(MyEntity newState) {\n    entityManager.merge(newState);\n}\n</code></pre>\n\n<p>That's good, but I don't like the idea of passing entities everywhere and sometimes would use DTOs, change commands etc.</p>\n\n<p>For simplicity change command is a map, eventually used in a call like this on some service:</p>\n\n<pre><code>@Transactional\npublic void updateMyEntity(int entityId, int version, Map&lt;String, Object&gt; changes) {\n    MyEntity instance = loadEntity(entityId);\n    for(String field : changes.keySey()) {\n        setWithReflection(instance, field, changes.get(field));\n    }\n    // version is unused - can I use it somehow?\n}\n</code></pre>\n\n<p>Obviously, if two users open my GUI, both make a change, and execute it one after another, in this case both changes will be applied, and the last one will \"win\". I would like this scenario to detect concurrent modification as well (the second user should get an exception).</p>\n\n<p>How can I achieve it?</p>\n"},{"tags":["java","hibernate","jsf","tomcat7","myfaces"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13194063,"title":"Tomcat 7, Myfaces 2, Ehcache, Hibernate 3.6.10 - webapp slow when load goes up","body":"<p>we have SunOS 5.1 sparcv9 image running on a virtual machine with 32GB ram.\nOn the SunOS we run number of services including Clearcase 7 and a webapp /see title/</p>\n\n<p>The webapp is one part of a hudson like software. The other part is a core java program /using tanuki wrapper to run as service/ on the same host which acts as a executor for different tasks.\nThe executor connects to the webapp using http /mapped to normal servlets/ on the same port where users connect to the webapp.</p>\n\n<p>Webapp and executor run on jdk 1.7 /separate processes/</p>\n\n<p>Tomcat is configured with 300 http threads /which is sufficient/;</p>\n\n<p>The webapp uses opensession in view filter which binds a 'SessionToken' object to the http session. SessionToken is an object holding:</p>\n\n<pre><code>private ViewState viewstate;\nprivate User user;\nprivate static final ThreadLocal&lt;Session&gt; session;\nprivate static final ThreadLocal&lt;Transaction&gt; transaction;\n</code></pre>\n\n<p>We have wily introscope hooked in and tomcat probe running on the same TC instance.\nProfiling shows some slow queries called by the executor http threads but it doesn't look like this is the problem.</p>\n\n<p>Problem:\nIt looks like the more users hit the webapp the slower it gets.</p>\n\n<p>I think this might be due to the way the hibernate session is managed or due to the fact that the executor creates a session for each connect, i.e 10 sessions in 20 seconds.</p>\n\n<p>I realize this is very vague but and I am happy to provide more information. </p>\n\n<p>Thanks</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13158824,"title":"detachedcriteria and detachedquery without EntityManager","body":"<p>I have one question concerning JPA:\nIs there a way to simulate DetachedCriteria (from Hibernate) using the api of JPA 2.0 ?</p>\n\n<p>And if there is a way which classes I need to extend in order to achieve this?</p>\n\n<p>I'm using hibernate 3.6.5 and hibernate-jpa-2.0-api-1.0.0.Final.</p>\n"},{"tags":["spring","hibernate","struts2","testng","hsqldb"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13193171,"title":"For test suite, replacing MYSQL by in memory HSQLDB is not working","body":"<p>We have an application where we use Struts, Spring, and hibernate.\nPreviously, we were using mysql databse for running test suites using testng framework.\nNow we want to use “in memory” database of HSQLDB. \nWe have made all the required code changes to use HSQLDB in “in memory” mode.</p>\n\n<p>For ex.</p>\n\n<p>Datasource url = jdbc:hsql:mem:TEST_DB</p>\n\n<p>Username = sa</p>\n\n<p>Password =</p>\n\n<p>Driver = org.hsqldb.jdbcDriver</p>\n\n<p>Hibernate dialect= org.hibernate.dialect.HSQLDialect</p>\n\n<p>Hibernate.hbm2ddl.aoto = create</p>\n\n<pre><code>   @Autowired\nprivate DriverManagerDataSource dataSource;\nprivate static Connection dbConnection;\nprivate static IDatabaseConnection dbUnitConnection;\nprivate static IDataSet dataSet;\nprivate MockeryHelper mockeryHelper;\n\n    public void startUp() throws Exception {\nmockeryHelper = new MockeryHelper();\n        if (dbConnection == null) {\n            dbConnection = dataSource.getConnection();\n            dbUnitConnection = new DatabaseConnection(dbConnection);\n            dbUnitConnection.getConfig().setProperty(DatabaseConfig.PROPERTY_DATATYPE_FACTORY, new HsqldbDataTypeFactory());\n            dataSet = new XmlDataSet(new FileInputStream(\"src/test/resources/test-data.xml\"));\n        }\n        DatabaseOperation.CLEAN_INSERT.execute(dbUnitConnection, dataSet);\n}\n</code></pre>\n\n<p>We have done required code changes to our base class where we do startup and teardown of database before and after each test.\nWe use test-data.xml file from where we insert test data to created database using testng framework.  Now my questions  are</p>\n\n<p>1.when I run  test case, database gets created and data is also inserted correctly. However, my respective daos return empty object list when I try to retrieve them from interceptors of struts.</p>\n\n<p>2.We use HSQLDB version 1.8.0.10. Same configurations are made for other project. In that project, most of the test cases are running with success, however for some of them sorting order of data is incorrect.\nWe discovered that HSQLDB is case sensitive for sorting. And there is one property sql.ignore_case, when set to true, sorting becomes case insensitive. But this is not working for us.\nCan someone please help in this?\n Thanks in adavance. </p>\n"},{"tags":["mysql","hibernate","jpa","foreign-keys","many-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13192325,"title":"How can I tell Hibernate to delete a table row through the entity it's foreign key points to?","body":"<p>I have three tables in my database; an Author table, which has an id column, a Publisher table, which has an id column, and a Book table, which has an id column, an authorId foreign key column, to the Author id, and a publisherId foreign key column,to the Publisher id. The foreign key on update/on delete options are all set to 'NO ACTION', but from what I understand, Hibernate should be able to handle these itself.</p>\n\n<p>The Author entity has a set of Books, which contain the publisher Id, but do not know about the Author. I've set this up as follows:</p>\n\n<pre><code>@Entity\n@Table(name=\"author\")\npublic class Author {\n    private Integer id;\n    private Set&lt;Book&gt; books;\n\n    @Id @GeneratedValue\n    public Integer getId() {\n        return id;\n    }\n\n    @OneToMany(fetch=FetchType.EAGER, cascade=CascadeType.ALL) {\n    @JoinColumn(name=\"authorId\")\n    public Set&lt;Book&gt; getBooks() {\n        return books;\n    }\n\n    public void setBooks(Set&lt;Book&gt; books) {\n        this.books = books;\n    }\n}\n\n@Entity\n@Table(name=\"book\") {\n    private Integer id;\n    private Integer publisherId;\n\n    @Id @GeneratedValue\n    public Integer getId() {\n        return id;\n    }\n\n    @ManyToOne(FetchType.EAGER)\n    @JoinColumn(name=\"publisherId\")\n    public Integer getPublisherId() {\n        return publisherId;\n    }\n\n    public void setPublisherId(Integer publisherId) {\n        this.publisherId = publisherId;\n    }\n}\n</code></pre>\n\n<p>My problem is that when I attempt to delete a Book from the Author's set of books, Hibernate tries to update the authorId foreign key to null, and I get the error that the column authorId cannot be null in the Book table. What I want to happen is for that row to be deleted entirely. </p>\n\n<p>I have also tried to add 'orphanRemoval=true' to the OneToMany annotation, and set on update/on delete to Cascade, but I get the same error.</p>\n\n<p>Which annotations can I use to indicate that when a book is removed from the Author's set of books, I want that row in the Book table to be removed? Is this possible at all with how I have my relationships set up and, if not, what is a better way to approach this?</p>\n"},{"tags":["eclipse","hibernate","gwt"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13192482,"title":"Getting gwt hibernate example code to work with eclipse","body":"<p>I am starting out with GWT and hibernate. I'm going through the tutorial at <a href=\"https://developers.google.com/web-toolkit/articles/using_gwt_with_hibernate\" rel=\"nofollow\">https://developers.google.com/web-toolkit/articles/using_gwt_with_hibernate</a>.</p>\n\n<p>I downloaded the sample code provided with the tutorial (http://google-web-toolkit.googlecode.com/files/gwt_hibernate_base.zip). This is a simple music store where you can add an account and records. I am able to run this and successfully add accounts and records to the database by doing the following commands:</p>\n\n<pre><code>(in the data directory) java -cp ../lib/hsqldb.jar org.hsqldb.Server\n\nant build hosted\n</code></pre>\n\n<p>Here is the build.xml file used to build this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;project name=\"Guestbook\" default=\"build\" basedir=\".\"&gt;\n\n  &lt;!-- Define gwt.home, gwt.dev.jar, appengine.sdk.home --&gt;\n  &lt;property file=\"build.properties\"/&gt;\n\n  &lt;path id=\"project.class.path\"&gt;\n    &lt;pathelement location=\"war/WEB-INF/classes\"/&gt;\n    &lt;pathelement location=\"${gwt.home}/gwt-user.jar\"/&gt;\n    &lt;!-- Add any additional non-server libs (such as JUnit) --&gt;\n    &lt;fileset dir=\"war/WEB-INF/lib\"&gt;\n      &lt;include name=\"**/*.jar\"/&gt;\n    &lt;/fileset&gt;\n  &lt;/path&gt;\n\n  &lt;target name=\"libs\" description=\"Copy libs to WEB-INF/lib\"&gt;\n    &lt;mkdir dir=\"war/WEB-INF/lib\" /&gt;\n    &lt;copy todir=\"war/WEB-INF/lib\" file=\"${gwt.home}/gwt-servlet.jar\" /&gt;\n    &lt;!-- Add any additional server libs that need to be copied --&gt;\n    &lt;copy todir=\"war/WEB-INF/lib\" flatten=\"true\"&gt;\n      &lt;fileset dir=\"lib/\"&gt;\n        &lt;include name=\"**/*.jar\"/&gt;\n      &lt;/fileset&gt;\n    &lt;/copy&gt;\n  &lt;/target&gt;\n\n  &lt;target name=\"javac\" depends=\"libs\" description=\"Compile java source\"&gt;\n    &lt;mkdir dir=\"war/WEB-INF/classes\"/&gt;\n    &lt;javac srcdir=\"src\" includes=\"**\" encoding=\"utf-8\"\n        destdir=\"war/WEB-INF/classes\"\n        source=\"1.5\" target=\"1.5\" nowarn=\"true\"\n        debug=\"true\" debuglevel=\"lines,vars,source\"&gt;\n      &lt;classpath refid=\"project.class.path\"/&gt;\n    &lt;/javac&gt;\n  &lt;/target&gt;\n\n  &lt;!-- can add additional arguments like -logLevel INFO or -style PRETTY --&gt;\n  &lt;target name=\"gwtc\" depends=\"javac\" description=\"GWT compile to JavaScript\"&gt;\n    &lt;java failonerror=\"true\" fork=\"true\" classname=\"com.google.gwt.dev.Compiler\"&gt;\n      &lt;classpath&gt;\n        &lt;pathelement location=\"src\"/&gt;\n        &lt;path refid=\"project.class.path\"/&gt;\n        &lt;pathelement location=\"${gwt.home}/${gwt.dev.jar}\"/&gt;\n      &lt;/classpath&gt;\n      &lt;!-- add jvmarg -Xss16M or similar if you see a StackOverflowError --&gt;\n      &lt;jvmarg value=\"-Xmx256M\"/&gt;\n      &lt;arg value=\"com.google.musicstore.MusicStore\"/&gt;\n    &lt;/java&gt;\n  &lt;/target&gt;\n\n  &lt;target name=\"hosted\" depends=\"javac\" description=\"Run hosted mode\"&gt;\n    &lt;java failonerror=\"true\" fork=\"true\" classname=\"com.google.gwt.dev.DevMode\"&gt;\n      &lt;classpath&gt;\n        &lt;pathelement location=\"src\"/&gt;\n        &lt;path refid=\"project.class.path\"/&gt;\n        &lt;pathelement location=\"${gwt.home}/${gwt.dev.jar}\"/&gt;\n      &lt;/classpath&gt;\n      &lt;jvmarg value=\"-Xmx256M\"/&gt;\n      &lt;arg value=\"-startupUrl\"/&gt;\n      &lt;arg value=\"MusicStore.html\"/&gt;\n      &lt;arg value=\"com.google.musicstore.MusicStore\"/&gt;\n      &lt;!-- Additional arguments like -style PRETTY or -logLevel DEBUG --&gt;\n    &lt;/java&gt;\n  &lt;/target&gt;\n\n  &lt;target name=\"build\" depends=\"gwtc\" description=\"Build this project\" /&gt;\n\n  &lt;target name=\"clean\" description=\"Cleans this project\"&gt;\n    &lt;delete dir=\"war/WEB-INF/classes\" failonerror=\"false\" /&gt;\n    &lt;delete dir=\"war/musicstore\" failonerror=\"false\" /&gt;\n  &lt;/target&gt;\n</code></pre>\n\n<p></p>\n\n<p>Now I would like to get this simple example working in eclipse. I created a project called MusicStore using the gwt eclipse plugin. I then copied over the tutorial files without changing them. I can't post an image but here is a link to my eclipse project structure:</p>\n\n<p><a href=\"http://oi50.tinypic.com/t6rn2w.jpg\" rel=\"nofollow\">http://oi50.tinypic.com/t6rn2w.jpg</a></p>\n\n<p>Again, I start by running</p>\n\n<pre><code>(in the data directory) java -cp ../lib/hsqldb.jar org.hsqldb.Server\n</code></pre>\n\n<p>Then I try to run my project in eclipse but hibernate doesn't work. When I try to add an account in the UI it alerts \"Failed to save account\" and I get the error java.lang.NoClassDefFoundError: org/hibernate/Session.</p>\n\n<p>Please let me know how I should go about getting the sample code working with eclipse. I think that many users new to hibernate will also want to do this.</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","hibernate","struts2","struts","struts-1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":39,"score":-1,"question_id":13191532,"title":"Struts-Hibernate Book","body":"<p>I want to develop a struts application. I will be using hibernate and postgresql server. Can anybody suggest a good book for reference or any useful link? The application will be for online complaint management system where users can post a new complaint and the administrator can view all the complaints categorywise. Would really appreciate if somebody helps on this.</p>\n\n<p>Thanks.</p>\n"},{"tags":["hibernate","jpa","timezone"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13191134,"title":"Hibernate and oracle issues with timestamps and daylight saving","body":"<p>I'm trying to add data to a table in an oracle 11g database with the definition.</p>\n\n<pre><code>CREATE TABLE FOO_TIME_TEST  \n(ID      NUMBER(20) NOT NULL, TIME    TIMESTAMP(6),\n CONSTRAINT FOO_TIME_TEST_PK   PRIMARY KEY (ID) USING INDEX);\n\nCREATE UNIQUE INDEX \"foo_time_test_idx\" ON \"FOO_TIME_TEST\" (TIME)\n</code></pre>\n\n<p>The Hibernate/JPA mapping using Joda time with the following </p>\n\n<pre><code>@Type(type = \"com.foo.PersistentDateTime\")\n@Column(name = \"TIME\")\npublic DateTime getTime() {\n    return time;\n}\n</code></pre>\n\n<p>The mapping class PersistentDateTime relevant bits</p>\n\n<pre><code>public void nullSafeSet(PreparedStatement preparedStatement, Object value, int index) throws SQLException {\n    if (value == null) {\n        Hibernate.TIMESTAMP.nullSafeSet(preparedStatement, null, index);\n    } else {\n        Hibernate.TIMESTAMP.nullSafeSet(preparedStatement, ((DateTime) value).toDate(), index);\n    }\n}\n\npublic int[] sqlTypes() {\n    return new int[] { Types.TIMESTAMP, };\n}\n</code></pre>\n\n<p>And the code to write is like this, it was in a loop using plusTime() but I isolated it to these two calls.</p>\n\n<pre><code>{\n    DateTime time = new DateTime(2012, 10, 28, 0, 0, DateTimeZone.UTC);\n    FooTest data = new FooTest();\n    data.setTime(time);\n    em.persist(data);\n    System.out.println(time + \" \" + time.getMillis() / 1000 / 60 / 60);\n}\n\n{\n    DateTime time = new DateTime(2012, 10, 28, 1, 0, DateTimeZone.UTC);\n    FooTest data = new FooTest();\n    data.setTime(time);\n    em.persist(data);\n    System.out.println(time + \" \" + time.getMillis() / 1000 / 60 / 60);\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>2012-10-28T00:00:00.000Z 375384\n2012-10-28T01:00:00.000Z 375385\n\n19:23:42,081  WARN JDBCExceptionReporter:100 - SQL Error: 1, SQLState: 23000\n19:23:42,081 ERROR JDBCExceptionReporter:101 - ORA-00001: unique constraint (Foo.foo_time_test_idx) violated\n</code></pre>\n\n<p>I've tried removing the unique index, the code then succeeds but the two rows in the database are then the same:</p>\n\n<pre><code>ID  Time\n1   28-OCT-12 01.00.00.000000000 AM\n2   28-OCT-12 01.00.00.000000000 AM\n</code></pre>\n\n<p>With hibernate tracing enabled, it appears to show the two different dates are being flattened to same value.</p>\n\n<pre><code>Hibernate: insert into FOO_TIME_TEST (ID, TIME) values (?, ?)\n07:38:54,217 TRACE TimestampType:151 - binding '2012-10-28 01:00:00' to parameter: 22\nHibernate: insert into FOO_TIME_TEST (ID, TIME) values (?, ?)\n07:38:54,217 TRACE TimestampType:151 - binding '2012-10-28 01:00:00' to parameter: 22\n</code></pre>\n\n<p>Really need source for ojdbc-6.jar to debug further...</p>\n\n<p>I've enabled more debug by downloading the ojdbc6_g.jar for 11.2.0.2.0 and putting in classpath along with the -Doracle.jdbc.Trace=true option as suggested <a href=\"http://docs.oracle.com/cd/B28359_01/java.111/b31224/diagnose.htm\" rel=\"nofollow\">here</a> and a custom java util log.properties</p>\n\n<p>This provides the additional info after each binding call, in both cases the 01:00 value is shown.</p>\n\n<pre><code>Nov 2, 2012 8:20:21 AM oracle.jdbc.driver.OraclePreparedStatementWrapper setTimestamp\nTRACE_30: 3C322E7D Enter: 22, 2012-10-28 01:00:00.0\nNov 2, 2012 8:20:21 AM oracle.jdbc.driver.OraclePreparedStatement setTimestamp\nFINE: 3C322E7D Public Enter: 22, 2012-10-28 01:00:00.0\nNov 2, 2012 8:20:21 AM oracle.jdbc.driver.OraclePreparedStatement setTimestampInternal\nFINER: 3C322E7D Enter: 22, 2012-10-28 01:00:00.0\n</code></pre>\n"},{"tags":["java","hibernate","google-app-engine","google-cloud-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13189623,"title":"Google cloud sql access denied exception in local","body":"<p>I've pasted the full stack trace here - \n<a href=\"http://pastebin.com/nG8shz7j\" rel=\"nofollow\">Pastebin</a>.</p>\n\n<pre><code>Caused by: java.security.AccessControlException: access denied (java.net.SocketPermission localhost resolve)\n    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)\n    at java.security.AccessController.checkPermission(AccessController.java:546)\n    at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n    at \n\n    com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:283)\n        at java.lang.SecurityManager.checkConnect(SecurityManager.java:1031)\n        at java.net.InetAddress.getAllByName0(InetAddress.java:1145)\n        at java.net.InetAddress.getAllByName(InetAddress.java:1083)\n        at java.net.InetAddress.getAllByName(InetAddress.java:1019)\n        at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:243)\n        at com.mysql.jdbc.MysqlIO.&lt;init&gt;(MysqlIO.java:284)\n        at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2043)\n        ... 123 more\n    Caused by:\n\n    com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n</code></pre>\n\n<p>Here is my database properties</p>\n\n<pre><code>jdbc.driverClassName=com.google.appengine.api.rdbms.AppEngineDriver\njdbc.url=jdbc:mysql://localhost:3306/tester\njdbc.username=root\njdbc.password=root\nhibernate.dialect = org.hibernate.dialect.MySQL5Dialect\nhibernate.hbm2ddl.auto=update\n</code></pre>\n\n<p>And applicationCOntext - </p>\n\n<pre><code>&lt;bean class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n    &lt;property name=\"location\"&gt;\n      &lt;value&gt;/WEB-INF/classes/database.properties&lt;/value&gt;\n    &lt;/property&gt;\n  &lt;/bean&gt;\n\n  &lt;bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${jdbc.driverClassName}\" /&gt;\n    &lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n  &lt;/bean&gt;\n\n  &lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\"&gt;\n      &lt;ref local=\"dataSource\"/&gt;\n    &lt;/property&gt;\n\n    &lt;property name=\"hibernateProperties\"&gt;\n      &lt;props&gt;\n        &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n        &lt;prop key=\"hibernate.show_sql\"&gt;false&lt;/prop&gt;\n        &lt;prop key=\"hibernate.cache.use_query_cache\"&gt;\n          false\n        &lt;/prop&gt;\n        &lt;prop key=\"hibernate.cache.use_second_level_cache\"&gt;\n          false\n        &lt;/prop&gt;\n        &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;${hibernate.hbm2ddl.auto}&lt;/prop&gt;\n      &lt;/props&gt;\n    &lt;/property&gt;\n</code></pre>\n\n<p>Here is how I tried to use it - </p>\n\n<pre><code>public class MainDao {\n  protected SessionFactory sessionFactory;\n\n  public SessionFactory getSessionFactory() {\n    return sessionFactory;\n  }\n\n  public void setSessionFactory(SessionFactory sessionFactory) {\n    this.sessionFactory = sessionFactory;\n  }\n\n  private Session openSession(){\n    return this.sessionFactory.openSession();\n  }\n}\n</code></pre>\n\n<p>I get the error when I call openSession. Need help with this. I'm not able to figure out the problem.</p>\n"},{"tags":["hibernate","jpa","entitymanager","persist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13187449,"title":"hibernate does not add entity to persistencecontext after persist","body":"<p>I have a managedbean that has a list of entity objects of current page. after I create a new object and persist it to db using persist() in a transaction; in another transaction when I call merge(because the entity is in detached state due to previous transaction commit); entitymanager cannot find the object in persistence context and throw a select query to database. Am I missing something or is that normal behavior?</p>\n\n<p>Update: The above problem exists when I use mysql database and autogenerated Id column. It does not exist when I use Oracle where I use sequence for Ids; but still; persistence context should know about the generated id; also is there any way to peek into persistence context to see what entities exits; I am using hibernate btw</p>\n"},{"tags":["hibernate","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13191085,"title":"Table partitioning with hibernate and PostgreSQL","body":"<p>I'm trying an example of table partitioning with Hibernate and PostgreSQL</p>\n\n<p>I've implemented example from \n <a href=\"http://www.postgresql.org/docs/9.1/static/ddl-partitioning.html\" rel=\"nofollow\">http://www.postgresql.org/docs/9.1/static/ddl-partitioning.html</a></p>\n\n<p>Now I want to insert data to Measurement table using Hibernate.</p>\n\n<p>I'm getting following exception:</p>\n\n<pre><code>org.hibernate.exception.GenericJDBCException: Could not execute JDBC batch update\nat org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)\nat org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)\nat org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\nat org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:275)\nat org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\nat org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:179)\nat org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\nat org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)\nat org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1206)\nat org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:375)\nat org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)\n</code></pre>\n\n<p>Please guide me how to configure <code>sqlinsert</code> property in hbm.xml file to resolve this.\nOr any other method for resolving this.</p>\n"},{"tags":["performance","hibernate","join","associations","one-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13190307,"title":"Hibernate: LazyLoading - Search by Object in One-To-Many Collection","body":"<p>I got an Entity 1 -> SubEntity n One-To-Many-relation.</p>\n\n<p>I just would like to check, if this is the <em>most efficient</em> way <strong>to search for an Entity, including a specified SubEntity in its \"One-To-Many-Collection\"</strong>. It works, but do I have to join fetch the SubEntities or is there a <strong>more lightweight</strong> solution if I don't need all SubEntities to be loaded? (FetchMode = Lazy)</p>\n\n<pre><code>public Entity getEntityBySubEntity(SubEntity subEntity) { \n     List&lt;Entity&gt; result = (List&lt;Entity&gt;)getHibernateTemplate.findByNamedParam(\n         \"From Entity as e left join fetch e.subEntities as sub where sub.id = :id\",\"id\",subEntity.getId()); \n     if (!result.isEmpty()) { \n          return result.get(0);\n     } else {\n          throw new NoResultException();\n     }\n }\n</code></pre>\n\n<p>(by the way, there should always be just one result...)     </p>\n\n<p>thx in adv,</p>\n\n<p>cav              </p>\n"},{"tags":["mysql","hibernate","tomcat"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13190849,"title":"MySql : \"Plugin 'FEDERATED' is disabled\"","body":"<p>121101  9:03:48 [Note] Event Scheduler: Purging the queue. 0 events\n121101  9:03:48  InnoDB: Starting shutdown...\n121101  9:03:53  InnoDB: Shutdown completed; log sequence number 0 28916183\n121101  9:03:53 [Note] /usr/sbin/mysqld: Shutdown complete</p>\n\n<p>121101  9:03:54 [Note] Plugin 'FEDERATED' is disabled.\n121101  9:03:54  InnoDB: Initializing buffer pool, size = 8.0M\n121101  9:03:54  InnoDB: Completed initialization of buffer pool\n121101  9:03:54  InnoDB: Started; log sequence number 0 28916183\n121101  9:03:54 [Note] Event Scheduler: Loaded 0 events\n121101  9:03:54 [Note] /usr/sbin/mysqld: ready for connections.\nVersion: '5.1.61-0ubuntu0.10.04.1'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  (Ubuntu)</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":19,"score":-4,"question_id":13190646,"title":"New Starter of Hibernate any basic idea , Suggestion, links","body":"<p>I am a no voice to ORM's. I just starting to learn Hibernate. </p>\n\n<p>Any suggestion where to start with? Which is the greatest version to prefer? Can any one summarize various version of hibernate? And also other various trending ORM which I need to keep track for better understanding future flexibility.</p>\n\n<p>Can any one suggest some link or book which is good for beginners to reach to the stage of Experts? </p>\n"},{"tags":["sql","hibernate","orm","coldfusion","coldfusion-9"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":181,"score":0,"question_id":7409927,"title":"One-to-One or Many-to-One with CF9 ORM in 2 queries","body":"<p>I have two objects</p>\n\n<pre><code>HomeFeatures\n&lt;cfcomponent persistent=\"true\"&gt;\n    &lt;cfproperty name=\"id\" column=\"homeFeatureid\"&gt;\n    &lt;cfproperty name=\"tabTitle\"&gt;\n    &lt;cfproperty name=\"title\"&gt;\n    &lt;cfproperty name=\"description\"&gt;\n    &lt;cfproperty name=\"sort\"&gt;\n    &lt;cfproperty name=\"moretext\"&gt;\n    &lt;cfproperty name=\"url\"&gt;\n    &lt;cfproperty name=\"active\"&gt;\n    &lt;cfproperty name=\"media\" fieldtype=\"many-to-one\" fkcolumn=\"mediaid\" cfc=\"media\" lazy=\"false\" fetch=\"join\" missingrowIgnored=\"true\"&gt;\n&lt;/cfcomponent&gt;\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Media\n&lt;cfcomponent persistent=\"true\" table=\"cms.dbo.media\"&gt;\n    &lt;cfproperty name=\"id\" column=\"mediaid\"&gt;\n    &lt;cfproperty name=\"filename\"&gt;\n&lt;/cfcomponent&gt;\n</code></pre>\n\n<p>Thus I have multiple homeFeatures, each of which has a media item associated with it. The same media item could be associated with multiple homeFeatures, but each homeFeature can only have one media item joined by homeFeatures.mediaid.</p>\n\n<p>If I do an entityLoad(\"homeFeatures\") I get 1 query for the homeFeatures and 1 query of the media table for EVERY ROW IN homeFeatures. In other words this is the N+1 problem. Why? This should be two queries total, one to get all of the homeFeatures, and one to get all of the media who's media ID is in the list determined by homeFeatures. I am attempting to do \"eager\" loading as defined at <a href=\"http://www.rupeshk.org/blog/index.php/2009/09/coldfusion-orm-performance-tuning-fetching-strategy/\" rel=\"nofollow\">http://www.rupeshk.org/blog/index.php/2009/09/coldfusion-orm-performance-tuning-fetching-strategy/</a> and in the adobe docs.</p>\n\n<p>In this specific view I need to access the media record for every entry, so that is why I have lazy set to false. I swear I have tried every iteration of lazy=false|true, batch=999, fieldtype=one-to-one|many-to-one, fetch=join|select, and all of them produce the same N+1 problem.</p>\n\n<p>Any ideas? Please help!</p>\n"},{"tags":["spring","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13190315,"title":"In Spring, why needn't we begin a transaction before a session.createQuery method call?","body":"<p>I have read this thread:<a href=\"https://forum.hibernate.org/viewtopic.php?f=1&amp;t=987460\" rel=\"nofollow\">Why to start DB transaction for createCriteria/createQuery</a>, <br/>\nthen I understand why we need to begin a transaction. <br/>\nbut now, I found that, we don't needs to do that in spring... <br/></p>\n\n<p>Then why is this?</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":5,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":15081,"score":9,"question_id":582526,"title":"Hibernate not respecting MySQL auto_increment primary key field","body":"<p>I am trying to learn how Hibernate works, and I am running into an almost unacceptable learning curve. I can't see how to get Hibernate to respect the auto_increment policy for my objects. Instead, it is overwriting entries in the database with existing IDs, beginning with 1.</p>\n\n<p>I have a simple <code>Foo</code> object, backed by a MySQL table defined like this:</p>\n\n<pre><code>CREATE TABLE `Foo` (\n  `fooId` int(11) NOT NULL AUTO_INCREMENT,\n  PRIMARY KEY (`fooId`),\n)\n</code></pre>\n\n<p>I have confirmed that inserting multiple Foo objects by hand with SQL (<code>insert into Foo values();</code>) does the right thing.</p>\n\n<p>My Java class has the ID specified using annotations like this:</p>\n\n<pre><code>@Id\n@GeneratedValue(strategy=GenerationType.AUTO)\n@Column(name=\"fooId\")\nprivate Integer id;\n</code></pre>\n\n<p>I then execute some test code that simply instantiates Foo objects and saves them to the database (using <code>session.save(obj)</code>). It seems that it uses its own primary key sequence, beginning with one, and does not look at the table's key policy. It overwrites whatever was there.</p>\n\n<p>I have tried variations on the <code>@GeneratedValue</code> bit (using all possible strategies, leaving off the parenthetic clause). Somebody even suggested leaving off the <code>GeneratedValue</code> entirely. Nothing seems to work. </p>\n\n<p>Am I leaving something out? What am I missing? Is Hibernate really this hard?</p>\n\n<p>(If anybody has an alternative Java database persistence option, please suggest one. I am making prototypes, not long-lasting mondo-engineered projects.)</p>\n"},{"tags":["java","hibernate","hibernate-mapping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13189393,"title":"@DiscriminatorFormula - redundant IN restriction","body":"<p>I have hierarchy of classes, for example AbstractClass - Employee - Engineer (and many others subclasses), and I use single table per class hierarchy strategy.\nAbstractClass has property <code>case</code>, in Employee I define <code>@DiscriminatorFormula(\"case\")</code>, Engineer has some <code>@DiscriminatorValue</code>.</p>\n\n<p>When I load all objects with HQL-query <code>SELECT id FROM Employee</code>, Hibernate makes this SQL-query:</p>\n\n<p><code>select employee0_.id as col_0_0_ from public.tbl_employee employee0_ where employee0_.case in ('engineer', 'operator')</code></p>\n\n<p>In other words, Hibernate adds redundant restrictoin with all discriminator values.</p>\n\n<p>Is there a way to exclude this IN restriction from SQL?</p>\n\n<hr>\n\n<p>There is some simplified mapping of AbstractClass and Employee:</p>\n\n<pre><code>@MappedSuperclass\n@Inheritance(strategy = InheritanceType.SINGLE_TABLE)\npublic abstract class AbstractClass {\n\n    @Id\n    @Column(name = \"id\")\n    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"SEQ_GEN\")\n    @SequenceGenerator(name = \"SEQ_GEN\", sequenceName = \"objectid_sequence\", allocationSize = 100)\n    private long id;\n\n    @Column(name = \"case\", nullable = false)\n    private String case;\n}\n\n@Entity\n@Table(name = \"tbl_employee\")\n@DiscriminatorFormula(\"case\")\npublic class Employee extends AbstractClass {\n\n    @Column(name = \"name\", nullable = false)\n    private String name = \"\";\n}\n</code></pre>\n"},{"tags":["hibernate","jpa-2.0","jboss7.x"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":61,"score":-2,"question_id":13066212,"title":"How to re-establish the connection after network failure in JBoss AS 7.x -JPA","body":"<p>My application is using JPA(Hbernate ORM)  to connect to the SQL server 2008 , Which was deployed in JBoss AS 7.x server. If the network goes down and came up again , i am getting the following exception</p>\n\n<pre><code>14:59:27,996 ERROR [stderr] (http-localhost-127.0.0.1-8080-1) javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: The connection is closed.\n14:59:28,002 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1361)\n14:59:28,012 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1289)\n14:59:28,020 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:261)\n14:59:28,025 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at com.honeywell.domoweb.dataservice.dao.impl.UserDaoImpl.getUsers(UserDaoImpl.java:372)\n14:59:28,030 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n14:59:28,034 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n14:59:28,039 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n14:59:28,044 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at java.lang.reflect.Method.invoke(Method.java:597)\n14:59:28,047 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)\n14:59:28,052 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)\n14:59:28,058 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n14:59:28,064 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\n14:59:28,069 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n14:59:28,075 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n14:59:28,080 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at $Proxy66.getUsers(Unknown Source)\n14:59:28,083 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at com.honeywell.domoweb.dataservice.dao.impl.TemplateDaoImpl.getTemplate(TemplateDaoImpl.java:44)\n14:59:28,089 ERROR [stderr] (http-localhost-127.0.0.1-8080-1)   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)...\n</code></pre>\n\n<p>I googled out this issue and found that this issue needs a change in the connection pool configuration to reconnect again using autoReconnect attribute ,but didn't found any example ,how to embed the autoReconnect with my Connection pool settings.Below is my Connection pool settings in the Standalone.xml file</p>\n\n<pre><code>&lt;subsystem xmlns=\"urn:jboss:domain:datasources:1.0\"&gt;\n        &lt;datasources&gt;\n\n\n            &lt;datasource jndi-name=\"java:jboss/datasources/DataServiceDS\" pool-name=\"dataServicePool\" enabled=\"true\" use-java-context=\"true\"&gt;\n                &lt;connection-url&gt;jdbc:sqlserver://ipaddress:1433;databaseName=myDataBase&lt;/connection-url&gt;\n                &lt;driver&gt;sqlserver&lt;/driver&gt;\n                &lt;pool&gt;\n                    &lt;min-pool-size&gt;10&lt;/min-pool-size&gt;\n                    &lt;max-pool-size&gt;100&lt;/max-pool-size&gt;\n                    &lt;prefill&gt;true&lt;/prefill&gt;\n                &lt;/pool&gt;\n                &lt;security&gt;\n                    &lt;user-name&gt;usename&lt;/user-name&gt;\n                    &lt;password&gt;password&lt;/password&gt;\n                &lt;/security&gt;\n            &lt;/datasource&gt;\n            &lt;drivers&gt;\n\n                &lt;driver name=\"sqlserver\" module=\"com.microsoft.sqlserver\"&gt;\n                    &lt;xa-datasource-class&gt;com.microsoft.sqlserver.jdbc.SQLServerDriver&lt;/xa-datasource-class&gt;\n                &lt;/driver&gt;\n            &lt;/drivers&gt;\n        &lt;/datasources&gt;\n    &lt;/subsystem&gt;\n</code></pre>\n\n<p>Can you please let me know ,how to re-connect to the database , if Network goes down and reconnected again ? </p>\n"},{"tags":["java","hibernate","spring","exception","lazyload"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6457,"score":1,"question_id":7654818,"title":"org.hibernate.LazyInitializationException: could not initialize proxy - no Session","body":"<p>I have 2 physical servers which my web application hits managed by load balancers. I always get -</p>\n\n<p><strong>org.hibernate.LazyInitializationException: could not initialize proxy - no Session</strong> </p>\n\n<p>when one of the servers are hit while the other one runs smoothly without any problems. I have a local managed cache store enabled and managed by the application. This exception happens only while trying to access one particular column from one table. The rest of the operations work absolutely fine regardless of which server is hit.</p>\n\n<p>Making lazy=false will become a performance issue because the number of rows on that table is quite large. And by the way, we are using get(object) on session instead of load(object).</p>\n"},{"tags":["java","hibernate","list","orm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13185332,"title":"How to remove an object from ordered list in hibernate?","body":"<p>I try to remove an object from an ordered list, which is ordered by an order column:</p>\n\n<pre><code>@OneToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL, orphanRemoval = true)\n@OrderColumn(name = \"images_order\")\nprivate List&lt;ProductImage&gt; productImages;\n</code></pre>\n\n<p>In this way the imaged field is configured and in this way I try to remove on image from this list:</p>\n\n<pre><code>ProductImage productImage = productImageService.getById(imageId);\n    Accessory accessory = accessoryService.getById(accessoryId);\n\n    if (accessory.getProductImages().remove(productImage)) {\n        accessoryService.edit(accessory);\n    }\n</code></pre>\n\n<p>with a set, which I had earlier, it works perfect in this way but now I got the following error:</p>\n\n<blockquote>\n  <p>SEVERE: Servlet.service() for servlet [admin] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.dao.DataIntegrityViolationException: Could not execute JDBC batch update; SQL [update Product_ProductImage set productImages_id=? where Product_id=? and images_order=?]; constraint [null]; nested exception is org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update] with root cause\n  com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry '0d97ce5b3abdb376013abdb3dffa0043' for key 'productImages_id'</p>\n</blockquote>\n\n<p>I have search a couple of hours and tried many other configs via annotations but nothing works as expected.</p>\n"},{"tags":["java","hibernate","jpa","java-ee","eclipselink"],"answer_count":12,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":4221,"score":5,"question_id":413131,"title":"An alternative to Hibernate or TopLink?","body":"<p>Is there a viable alternative to Hibernate? Preferably something that doesn't base itself on JPA.</p>\n\n<p>Our problem is that we are building a complex (as in, many objects refer to each other) stateful RIA system. It seems as Hibernate is designed to be used mainly on one-off applications - JSF and the like.</p>\n\n<p>The problem is mainly that of lazy loading. Since there can be several HTTP requests between the initialization and actually loading lazy collections, a session per transaction is out of the question. A long-lived session (one per application) doesn't work well either, because once a transaction hits a snag and throws an exception, the whole session is invalidated, thus the lazy loaded objects break. Then there's all kinds of stuff that just don't work for us (like implicit data persisting of data from outside an initialized transaction).</p>\n\n<p>My poor explanations aside, the bottom line is that Hibernate does magic we don't like. It seems like TopLink isn't any better, it also being written on top of EJB.</p>\n\n<p>So, a stateless persistence layer (or even bright-enough object-oriented database abstraction layer) is what we would need the most.</p>\n\n<p>Any thoughts, or am I asking for something that doesn't exist?</p>\n\n<p><strong>Edit:</strong> I'm sorry for my ambiguous terminology, and thank you all for your corrections and insightful answers. Those who corrected me, you are all correct, I meant JPA, not EJB.</p>\n"},{"tags":["java","database","hibernate","sqlite"],"answer_count":19,"favorite_count":32,"up_vote_count":45,"down_vote_count":0,"view_count":29717,"score":45,"question_id":296587,"title":"Light weight alternative to Hibernate?","body":"<p>I have a single user java program that I would like to have store data in a light weight database such as Derby or Sqlite. I would like to use a data abstraction layer in my program. Hibernate appears to require a lot of configuration and is overkill for what I need. What are light weight alternatives to Hibernate?</p>\n"},{"tags":["java","android","performance","hibernate"],"answer_count":3,"favorite_count":11,"up_vote_count":19,"down_vote_count":0,"view_count":8839,"score":19,"question_id":4257374,"title":"Is Hibernate an overkill for an Android application?","body":"<p>I'm looking for a good ORM for my android application and at first glance it seems like for a mobile device I would prefer to use something simpler maybe. The thing is I'm just assuming here with no real evidence, so I thought I would ask the community's opinion (maybe there's is someone that has been through the experience). It is a fairly large(for mobile) application and will be run on a dedicated tablet.</p>\n\n<p>What does everyone else think ? Is Hibernate too much for an android application ? Will there be performance problems ?</p>\n\n<p>What would you use instead if you think it is too much ?</p>\n\n<p>I am aware there are other questions asking for alternatives, but I decided to ask since most of those questions simply assumed it was an overkill and asked for other options and I started wondering \"Is it really and overkill ? Why ?\" Due to my lack of experience I simply think it it, but can't really provide an answer if I'm asked to explain why. Is it performance ? Is it too much configuration (Which I don't mind) ? </p>\n\n<p>Thanks!</p>\n"},{"tags":["java","hibernate","serialization","orm","jpa"],"answer_count":7,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":6231,"score":10,"question_id":2020904,"title":"When and why JPA entities should implement Serializable interface?","body":"<p>The question is in the title. Below I just described some of my thoughts and findings.</p>\n\n<p>When I had very simple domain model (3 tables without any relations) all my entities did NOT implement Serializable.</p>\n\n<p>But when domain model became more complex I got RuntimeException which said that one of my entities didn't implement Serializable.</p>\n\n<p>I use Hibernate as a JPA implementation.</p>\n\n<p>I wonder:</p>\n\n<ol>\n<li>Is it vendor-specific requirement/behavior?</li>\n<li>What happens with my serializable entities? Should they be serializable for storing or for transferring?</li>\n<li>At which moment it becomes necessary to make my entity serializable? </li>\n</ol>\n"},{"tags":["hibernate","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2752,"score":0,"question_id":6138014,"title":"How get all the rows value in hibernate?","body":"<p>I am writing the following code to get the values from the Data base using Hibernate</p>\n\n<pre><code>try {\n    System.out.println(\"In getDetails() try block\");\n    configuration = new Configuration();\n    configuration.configure(\"resources\\\\hibernate.cfg.xml\");\n\n    sessionFactory = cfg.buildSessionFactory();\n    session = sessionFactory.openSession();\n\n    Query query = session.createQuery(\"from ServiceManagerDetails\");\n\n    List l = query.list();\n    Iterator i1 = l.iterator();\n\n    ServiceManagerDetails smd = null;\n    while (i1.hasNext()) {\n        smd = (ServiceManagerDetails)i1.next();\n        System.out.println(smd.getServiceMode());\n    }                \n} catch (Exception e) {\n    System.out.println(\"Error:- \"+e);\n    //tx.rollback();\n    e.printStackTrace();\n} finally {\n    session.close();\n}\n</code></pre>\n\n<p>There are two records but I am getting the value of one row twice. But I have get the value of both the rows. Please help me find out what I am missing. Thanks</p>\n"},{"tags":["java","json","hibernate","gson"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":13175019,"title":"Custom Conversion from Java Object to JSON Object","body":"<p>I have the following code</p>\n\n<pre><code>Gson gson = new Gson();\nString json = gson.toJson(criteria.list()); // list is passed by Hibernate\n</code></pre>\n\n<p>The result would be something like this:</p>\n\n<pre><code>{creationTime:0, enabled:true, id:1, loginDuration:0, online:false, userName:someone}\n</code></pre>\n\n<p>I would like to add new attribute (DT_RowId which has the same value as id) within the JSON response. The end result should be like this:</p>\n\n<pre><code>{creationTime:0, enabled:true, id:1, loginDuration:0, online:false, userName:someone, DT_RowId=1}\n</code></pre>\n\n<p><strong>UPDATED</strong></p>\n\n<p>I created a field with @Transient annotation on the entity in order to solve this issue.</p>\n\n<pre><code>    ...\n    @Transient\n    private long DT_RowId;\n\n    public void setId(long id) {\n            this.id = id;\n            this.DT_RowId=id;\n        }\n    ...\n</code></pre>\n\n<p>However the setId function was never been called. Can someone enlighten me on this ?</p>\n"},{"tags":["java","spring","hibernate","classcastexception"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13145603,"title":"ClassCastException in implementation class","body":"<p>Why am I getting the ClassCastException:</p>\n\n<p>Wrapped exception:</p>\n\n<pre><code>java.lang.ClassCastException: com.avt.model.CasePmt\n    at com.avt.dao.impl.CasePmtDaoImpl.findAllCasePmt(CasePmtDaoImpl.java:68)\n    at com.avt.ViewCasePmtAction.view(ViewCasePmtAction.java:127)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:585)\n    at org.apache.struts.actions.DispatchAction.dispatchMethod(DispatchAction.java:280)\n    at gov.pbgc.spectrum.util.SpectrumLookupDispatchAction.execute(SpectrumLookupDispatchAction.java:113)\n    at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:484)\n    at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:274)\n    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1482)\n    at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:525)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:763)    \n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:856)\n</code></pre>\n\n<p>My implementation class is</p>\n\n<pre><code>public List&lt;CasePmt&gt; findAllCasePmt() {\n            List list;\n            list = getHibernateTemplate().executeFind(new HibernateCallback() {\n                    public Object doInHibernate(Session session)\n                                    throws HibernateException, SQLException {\n\n                            Query q = session\n                                            .getNamedQuery(\"findAll\");\n                            return q.list();\n                    }\n            });\n            Iterator it = list.iterator();\n            List&lt;CasePmt&gt; l = new ArrayList&lt;CasePmt&gt;();\n\n            CasePmt voObj;\n            while (it.hasNext()) {\n                    voObj = new CasePmt();\n\n                    Object[] objs = (Object[]) it.next();\n                    // System.out.print(\"\\n\" + objs[0].toString());\n\n                    if (objs[2] != null) {\n                            voObj.setCaseTxNum(objs[1].toString());\n                    }\n\n\n    .......................\n                        }\n                    l.add(voObj);\n            }\n            return l;\n    }\n</code></pre>\n\n<p>and my action call is :</p>\n\n<pre><code>List&lt;CasePmt&gt; CsList =       \n             CasePmtBo.getCaseDao().findAllCasePmt();\n</code></pre>\n\n<p>Im getting error in line 68 which is \"Object[] objs = (Object[]) it.next();\" line.\nWhy am i getting this issue?</p>\n\n<p>Any inputs..im revisiting this today and facing the issue. </p>\n"},{"tags":["hibernate","spring-mvc","jpa-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13180104,"title":"Persistence xml in tests","body":"<p>In my spring JPa app..</p>\n\n<p>I recently got into a bit of an issue whereby i had to add the following in the persistence xml to enable my tests to work:</p>\n\n<pre><code>&lt;class&gt;com....&lt;/class&gt;\n&lt;class&gt;com....&lt;/class&gt;\n</code></pre>\n\n<p>what i found odd, was that it worked fine if i placed a bare bones persistence xml in main resources.. and my tests would pick it up.</p>\n\n<p>But it refused to pick up the bare bones persistence xml from my tests resources.</p>\n\n<p>Anyone shed any light why this is </p>\n"},{"tags":["java","hibernate","mapping","dto","dozer"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":6578,"score":1,"question_id":2826313,"title":"Dozer mapping for Hibernate object to DTO","body":"<p>I try to use Dozer to convert my domain entity to DTO objects.\nSo, I want to convert PersistentList, PersistentBag, ... from my domain entity to ArrayList, ... in my DTO objects to avoid lazy problem.</p>\n\n<p>This is an example of two of my domain entity :</p>\n\n<pre><code>public class User {\n      private Collection&lt;Role&gt; roles;\n      ...\n}\n\npublic class Role {\n      private Collection&lt;User&gt; users;\n      ...\n}\n</code></pre>\n\n<p>My DTO objects are the same except that class are of types DTO. So, to convert domain to DTO objects, I use the following Dozer mapping :</p>\n\n<pre><code> &lt;configuration&gt;\n  &lt;custom-converters&gt;\n   &lt;converter type=com.app.mapper.converter.BagConverter\"&gt;\n    &lt;class-a&gt;org.hibernate.collection.PersistentBag&lt;/class-a&gt;\n    &lt;class-b&gt;java.util.List&lt;/class-b&gt;\n   &lt;/converter&gt;\n  &lt;/custom-converters&gt;\n &lt;/configuration&gt;\n\n &lt;mapping&gt;\n  &lt;class-a&gt;com.app.domain.User&lt;/class-a&gt;\n  &lt;class-b&gt;com.app.dto.UserDTO&lt;/class-b&gt;\n &lt;/mapping&gt;\n\n &lt;mapping&gt;\n  &lt;class-a&gt;com.app.domain.Role&lt;/class-a&gt;\n  &lt;class-b&gt;com.app.dto.RoleDTO&lt;/class-b&gt;\n &lt;/mapping&gt;\n</code></pre>\n\n<p>BagConverter is a Dozer custom converter and that is its code :</p>\n\n<pre><code>  public class BagConverter&lt;T&gt; extends DozerConverter&lt;PersistentBag, List&gt;{\n\n public BagConverter() {\n  super(PersistentBag.class, List.class);\n }\n\n public PersistentBag convertFrom(List source, PersistentBag destination) {\n  PersistentBag listDest = null;\n\n  if (source != null) {\n\n   if (destination == null) {\n    listDest = new PersistentBag();\n   } else {\n    listDest = destination;\n   }\n\n   listDest.addAll(source);\n  }\n\n  return listDest;\n }\n\n public List convertTo(PersistentBag source, List destination) {\n  List listDest = null;\n\n  if (source != null) {\n\n   if (destination == null) {\n    listDest = new ArrayList&lt;T&gt;();\n   } else {\n    listDest = destination;\n   }\n\n   if (source.wasInitialized()) {\n    listDest.addAll(source);\n   }\n  }\n\n  return listDest;\n }}\n</code></pre>\n\n<p>So, I get a User object that contains a PersistentBag with roles. I apply dozer mapper map on that object to obtain UserDTO object. The result that I obtain is a UserDTO object with a ArrayList of Role and no an ArrayList of RoleDTO like I wished.</p>\n\n<p>I thought that even if I used custom converter, dozer will convert the content of my list. It's not the right way ? If no, how to do to convert my domain entity to dto object by replacing persitent collections to classic java collections ?</p>\n\n<p>Thanks for your help.</p>\n\n<p>Sylvain.</p>\n"},{"tags":["hibernate","postgresql","jpa","oracle11g"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":118,"score":2,"question_id":13090089,"title":"org.hibernate.type.TextType and Oracle","body":"<p>We use Hibernate as a JPA provider and we have a class with a large object field marked with</p>\n\n<pre><code>@Lob\n@Type( type = \"org.hibernate.type.TextType\" )\nprivate String someString;\n</code></pre>\n\n<p>The column is created as</p>\n\n<pre><code>SOMESTRING            LONG()             \n</code></pre>\n\n<p>This works flawlessly with PostgreSQL and MySQL. With Oracle when persisting the object</p>\n\n<pre><code>entityManager.persist( object );\n</code></pre>\n\n<p>we get an <code>org.hibernate.exception.GenericJDBCException: Could not execute JDBC batch update</code> exception.</p>\n\n<p>Removing the <code>@Type( type = \"org.hibernate.type.TextType\" )</code> annotation will solve the problem with Oracle but introduces an encoding problem with PostgreSQL as described in <a href=\"http://stackoverflow.com/questions/9993701/cannot-store-euro-sign-into-lob-string-property-with-hibernate-postgresql\">Cannot store Euro-sign into LOB String property with Hibernate/PostgreSQL</a></p>\n\n<p>I would like to know how to define a large text field so that out program works on both PostgreSQL and Oracle. A pure JPA solution would be optimal but an Hibernate specific one will also do.</p>\n\n<p>Edit:</p>\n\n<p>The real exception:</p>\n\n<pre><code>java.sql.BatchUpdateException: ORA-22295: cannot bind more than 4000 bytes data to LOB and LONG columns in 1 statement\n</code></pre>\n\n<p>Now, the exception I missed explains the problem and in fact the object I am persisting has more than then the large string (at least one long DBID).</p>\n"},{"tags":["hibernate","criteria","hibernate-criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":103,"score":1,"question_id":8295292,"title":"Criteria to list of Entityinstance+Extrafield","body":"<p>im pretty sure this question anywhere already has been asked anywhere - didnt found the answer. </p>\n\n<p>I got an simple Criteria like this:</p>\n\n<pre><code>s.createCriteria(Human.class).list()\n</code></pre>\n\n<p>gives me an resultlist of entityinstance of Human (gender and name).</p>\n\n<p><strong>Can i add an calculation like \"salutation\"</strong> to the resulting entityinstances only (without changing Human.java) and avoid the creation of an 2-dimensional array?</p>\n\n<p>I know, this should be the job of such an Decorator-Class, is there any workaround? The enlarged entityinstance should extends the Human-class!</p>\n"},{"tags":["java","hibernate","hql","dao"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13169377,"title":"HQL DISTINCT doesn't work","body":"<p>I searched throughout the forum; almost every answer comes to this but didn't help.\nI have the below query in my DAO but it doesn't work and I don't understand why?</p>\n\n<p>Here's my complete method:</p>\n\n<pre><code>public List&lt;RwTac&gt; findAll(){\n        String sql = \"select distinct v from RwTac v \" +\n                     \"order by v.vendor\" ;\n        Query query = sessionFactory.getCurrentSession().createQuery(sql);\n        return query.list();\n    }\n</code></pre>\n\n<p>Thank you.</p>\n"},{"tags":["hibernate","select","join","jersey","hql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13177593,"title":"HIbernate select join issue","body":"<p>I have an issue, help please: there a are two tables <code>Customer(id, name)</code> and <code>Fee(id, amount, customer_id</code>), so in class <code>Customer</code> i have <code>Set&lt;Fee&gt;</code> and a mapping One-To-Many to the Fee table. I use Jersey for POJO-to-JSON translation and i need two <code>GET</code> queries: <code>GetCustomerById</code> and <code>GetFeesByCustomer</code>. In second case i can just do <code>session.get(Customer.class, someId).getFees()</code> but in first case i have a JSON of Customer object with field <code>Fees</code> which is array, but i don't need this array, i just need Customer object without Fees field. What should i do? </p>\n\n<p>It seems the question is: <em>how can i get some persistent class without some fields?</em></p>\n"},{"tags":["java","hibernate","jsf","java-ee","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13176285,"title":"Developing a Database simplified manager, should i use JSF or JSF+Hibernate?","body":"<p>I've been away from web java for some time and now I have to develop a simplified database manager, basically a web interface for select, update, delete and create controllers for existing tables without having to use SQL directly.</p>\n\n<p>My question is, JSF with SQL queries would be enough ? I was thinking about using JSF + Hibernate but since i won't be using these entities for anything other than a simple display of information, i thought it might be like using a bazooka against an ant.</p>\n\n<p>What would you guys suggest ? </p>\n\n<p>Thanks in advance</p>\n\n<p>PS: If this isn't the kind of question to be made here on SO, let me know and i will take it down...</p>\n"},{"tags":["java","hibernate","design","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13176819,"title":"Hibernate ORM design strategy","body":"<p>I need to build a Vehicle domain object.  All Vehicle objects will have about 5 properties... no big deal.  I annotate the class with @Entity, slap in an id annotated with @Id.  My problem is, there are two other types of specialty vehicles I need to account for.  One needs to hold 2 additional string values, and the other needs to hold a list of strings.</p>\n\n<p>I would like to be able to do a findAll() and get all of the vehicles, so I'm not really sold on creating completely separate domain objects for the other two types of vehicles and having completely separate tables for them.  I toyed around with an idea to create an \"AdditionalProperties\" abstract class, make it a member of Vehicle, then extend it for my two specialty vehicles, but I quickly got lost in the proper way to annotate it and map it to the database. But even then I'd be stuck with writing lots of monolithic if statements to check vechicle type and cast that class etc etc</p>\n\n<p>My other thought was just to include the extra fields in the single Vehicle domain object I have now (even though they don't make any sense for all the other types of vehicles) and leave the values null except for when it is one of the specialty vehicles.</p>\n\n<p>Does anybody have any ideas on how I should approach this with possibly some examples of how the classes should be annotated?</p>\n"},{"tags":["hibernate","grails"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3522,"score":1,"question_id":1212689,"title":"Grails: Adding sorting and paging to a custom HQL query","body":"<p>I have a list method that uses HQL. how do I add the paging and sorting parameters to this query?  </p>\n\n<pre><code>   def list = {\n         def termList\n        log.info \"Getting terms for product: $params.productId\"\n        params.max = 10\n        def p = Product.get(params.productId)\n        if (p) {\n            log.info \"Product found: $p.name\"\n            termList = Term.executeQuery(\"select distinct t from Term as t join t.definitions def join def.definitionProducts dp where dp.product=?\",\n                p )\n\n        } else {\n            log.info \"No Product found\"\n            termList = Term.list(params)\n\n        }\n        log.info \"Terms found: $termList.size\"\n\n        [ termInstanceList: termList, termInstanceTotal: termList.size]\n    }\n</code></pre>\n"},{"tags":["hibernate","netbeans","jar"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13175971,"title":"How do I update Hibernate library in Netbeans 7.2.1?","body":"<p>I've realised that Netbeans 7.2.1 comes with an obsolete version of Hibernate libraries (version 3.2.5) and I was wondering if there is any way to update it through the plugins manager. I mean, is there any URL that I can use in the Update Center (Tools>Plugings>Settings tab) so I can upgrade the current Hibernate version?\nThank you all.</p>\n"},{"tags":["hibernate","hbm2ddl"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":4253,"score":7,"question_id":9276808,"title":"Unable to generate hbm2ddl using hibernate3-maven-plugin-3.0","body":"<p>I have updated to a newer version of hibernate3-maven-plugin. I get the following error trying to use the plugin mentioned below.</p>\n\n<p>Would appreciate any pointers in resolving this issue.</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.0&lt;/version&gt;\n\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;id&gt;create sql schema&lt;/id&gt;\n            &lt;phase&gt;process-test-resources&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;hbm2ddl&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n                &lt;componentProperties&gt;\n                    &lt;persistenceunit&gt;${app.module}&lt;/persistenceunit&gt;\n                    &lt;drop&gt;false&lt;/drop&gt;\n                    &lt;create&gt;true&lt;/create&gt;\n                    &lt;outputfilename&gt;${app.sql}-create.sql&lt;/outputfilename&gt;\n                    &lt;skip&gt;${db.schema.gen.skip}&lt;/skip&gt;\n                &lt;/componentProperties&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n\n        &lt;execution&gt;\n            &lt;id&gt;drop sql schema&lt;/id&gt;\n            &lt;phase&gt;process-test-resources&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;hbm2ddl&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;configuration&gt;\n                &lt;componentProperties&gt;\n                    &lt;persistenceunit&gt;${app.module}&lt;/persistenceunit&gt;\n                    &lt;drop&gt;true&lt;/drop&gt;\n                    &lt;create&gt;false&lt;/create&gt;\n                    &lt;outputfilename&gt;${app.sql}-drop.sql&lt;/outputfilename&gt;\n                    &lt;skip&gt;${db.schema.gen.skip}&lt;/skip&gt;\n                &lt;/componentProperties&gt;\n            &lt;/configuration&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n\n[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (create sql schema) on project sample: There was an error creating the AntRun task. NullPointerException -&gt; [Help 1]org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (create sql schema) on project framework: There was an error creating the AntRun task.\n</code></pre>\n"},{"tags":["java","hibernate","mapping","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13159945,"title":"Hibernate Many-to-Many doesn't work","body":"<p>I try to understand hibernate but it is very hard.</p>\n\n<p>I have a problem now that i don't really understand. Its about the many-to-many relations in my mapping file. If I save an object it wont save the \"many\" in my DB but it wont save it. I think it is in my mapping but i don't see it.</p>\n\n<p>It's about flight and staff on the plane. When I save the plane the staff members must be save with it. But that wont happen.</p>\n\n<p>Here is my mapping of both:\nThe Flight mapping:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n    \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n    &lt;!-- Generated 28-sep-2012 11:49:37 by Hibernate Tools 3.2.1.GA --&gt;\n     &lt;hibernate-mapping&gt;\n    &lt;class name=\"model.Flight\" table=\"flights\" catalog=\"flyaway_db\"&gt;\n\n    &lt;id name=\"number\" type=\"int\"&gt;\n        &lt;column name=\"FlightNumber\" /&gt;\n        &lt;generator class=\"assigned\" /&gt;\n    &lt;/id&gt;\n\n    &lt;set name=\"staffs\" table=\"flightstaff\" cascade=\"save-update\"&gt; \n        &lt;key&gt;\n            &lt;column name=\"FlightNumber\" not-null=\"true\" /&gt;\n        &lt;/key&gt;\n        &lt;many-to-many class=\"model.Staff\"&gt;\n            &lt;column name=\"StaffNumber\" length=\"5\" not-null=\"true\" /&gt;\n        &lt;/many-to-many&gt;\n    &lt;/set&gt;\n\n&lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>The staff mapping:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated 28-sep-2012 11:49:37 by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n&lt;class name=\"model.Staff\" table=\"staff\" catalog=\"flyaway_db\"&gt;\n\n    &lt;id name=\"staffNumber\" type=\"string\"&gt;\n        &lt;column name=\"StaffNumber\" length=\"5\" /&gt;\n        &lt;generator class=\"assigned\" /&gt;\n    &lt;/id&gt;\n\n    &lt;set name=\"flightses\" table=\"flightstaff\" cascade=\"save-update\"&gt;\n        &lt;key&gt;\n            &lt;column name=\"StaffNumber\" length=\"5\" not-null=\"true\" /&gt;\n        &lt;/key&gt;\n        &lt;many-to-many class=\"model.Flight\"&gt;\n            &lt;column name=\"FlightNumber\" not-null=\"true\" /&gt;\n        &lt;/many-to-many&gt;\n    &lt;/set&gt;\n&lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>if you need anything else to see what the problem is.</p>\n\n<p>Thanks in advance\nKevin</p>\n"},{"tags":["hibernate","inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13172802,"title":"How to let hibernate handle inheritance automatically?","body":"<p>I have B extends from A,and set InheritanceType to JOINED,the code like this:</p>\n\n<pre><code> @Entity\n @Table(name = \"parent\")\n public class Parent implements IsSerializable\n {\n        @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY)\n    List&lt;A&gt; children;\n        ...\n }\n\n\n @Entity\n @Inheritance(strategy= InheritanceType.JOINED)\n public class A implements IsSerializable\n {\n    @Id\n    @GeneratedValue\n    @Column(name = \"id\")\n    Long id;\n }\n\n @PrimaryKeyJoinColumn(name=\"id\")\n public class B extends A\n {\n     String name;\n }\n</code></pre>\n\n<p>then push a A to list </p>\n\n<pre><code>   A a=new A();\n   list.getChildern().add(a); \n</code></pre>\n\n<p>push a B to list </p>\n\n<pre><code>   B b=new B();\n   list.getChildern().add(b); \n</code></pre>\n\n<p>then </p>\n\n<pre><code>    Parent p=new Parent();\n    p.setChildren(list);\n    hibernate.persist(entity);\n</code></pre>\n\n<p>hope first element of the list will will be saved into table_A,and second element will be saved into table_B automatically.but they are not.What did I do wrong?</p>\n"},{"tags":["hibernate","validator"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3527,"score":3,"question_id":2051078,"title":"Hibernate validator error - 4.0.2.GA","body":"<p>the validate function of the Hibernate Validator seems to be buggy (version hibernate-validator-4.0.2.GA.jar). Do I maybe miss a dependency?</p>\n\n<p>Part of my stack trace:</p>\n\n<pre><code>java.lang.NoSuchMethodError: javax.persistence.Persistence.getPersistenceUtil()Ljavax/persistence/PersistenceUtil;\n        at org.hibernate.validator.engine.resolver.JPATraversableResolver.isReachable(JPATraversableResolver.java:33)\n        at org.hibernate.validator.engine.resolver.DefaultTraversableResolver.isReachable(DefaultTraversableResolver.java:112)\n        at org.hibernate.validator.engine.resolver.SingleThreadCachedTraversableResolver.isReachable(SingleThreadCachedTraversableResolver.java:47)\n        at org.hibernate.validator.engine.ValidatorImpl.isValidationRequired(ValidatorImpl.java:764)\n        at org.hibernate.validator.engine.ValidatorImpl.validateConstraint(ValidatorImpl.java:331)\n        at org.hibernate.validator.engine.ValidatorImpl.validateConstraintsForRedefinedDefaultGroup(ValidatorImpl.java:278)\n        at org.hibernate.validator.engine.ValidatorImpl.validateConstraintsForCurrentGroup(ValidatorImpl.java:260)\n        at org.hibernate.validator.engine.ValidatorImpl.validateInContext(ValidatorImpl.java:213)\n        at org.hibernate.validator.engine.ValidatorImpl.validate(ValidatorImpl.java:119)\n</code></pre>\n"},{"tags":["java","hibernate","many-to-many","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":9477798,"title":"Query with the many-to-many set (joined table) in the WHERE clause","body":"<p>For example, I have the mapping file like this</p>\n\n<pre><code>   &lt;class name=\"my.test.model.Product\" table=\"PRODUCT\"&gt;\n    ...\n            &lt;set name=\"retailers\" table=\"product_shop\" lazy=\"false\"&gt;\n                &lt;key column=\"PRODUCT_ID\" /&gt;\n                &lt;many-to-many column=\"SHOP_ID\" class=\"my.test.model.Shop\" /&gt;\n            &lt;/set&gt;\n    ...\n    &lt;/class&gt;\n</code></pre>\n\n<p>Now I want to query the Products of a particular Shop A. Something like this come to mind:</p>\n\n<pre><code>String searchHql = \"select p from Product p inner join p.retailers retailing where p.retailers.shop_id = :shopId\";\n\n        @SuppressWarnings(\"unchecked\")\n        List&lt;Product&gt; productList = sessionFactory.getCurrentSession().createQuery(searchHql ).setInteger(\"shopId\", shopId).list(); \n</code></pre>\n\n<p>But it won't work. The error returned is:</p>\n\n<p>could not resolve property: shop_id of: my.test.model.Shop. I have searched a lot, but still not find the right way to access the \"many-to-many\" subset in hql. Is this possible? Or I need to map the Product_Shop table to a model class?</p>\n\n<p><strong>UPDATE</strong>: as it seems there's no other way, I end up mapping Product_Shop into a class.</p>\n"},{"tags":["spring","hibernate","tomcat","spring-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13172738,"title":"Can I initialize Spring via Tomcats web xml (../webapps/WEB-INF/web.xml)?","body":"<p>Thanks to the UNUSUAL deployment of Tomcat6 I need to deploy my web app that is using the Spring &amp; Hibernate on a server where access to the WAR deployment's web.xml at <em>/webapps/MyDeployment/WEB-INF/web.xml</em> is not allowed. </p>\n\n<p>So I need to know if such a deployment is even possible, Where we will initialize the spring framework in the serever's web.xml at <em>/webapps/WEB-INF/web.xml</em> and not use the WAR's web.xml ?</p>\n\n<p>Below is the WAR's web.xml that I am currently using at my environment,</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns=\"http://java.sun.com/xml/ns/javaee\" xmlns:web=\"http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nid=\"WebApp_ID\" version=\"2.5\"&gt;\n&lt;display-name&gt;abcd&lt;/display-name&gt;\n\n&lt;!--Here we specify about the DispatcherServlet class in the Web Deployment \n    Descriptor --&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;*.abcd&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;*.xyz&lt;/url-pattern&gt;\n    &lt;url-pattern&gt;*.pqr&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre>\n\n<p></p>\n\n<p>Unfortunately changes in the Tomcat configuration is not allowed,</p>\n\n<p>Any suggestions will be highly appreciated.</p>\n"},{"tags":["java","spring","hibernate","flex","blazeds"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13171782,"title":"How to Append Login userid into url using spring Flex?","body":"<p>In my Sample Application i'm using Spring+Hibernate+Flex using BlazeDs plugin.\nActually i have an <code>Login mxml</code> file in flex.when authenticate user login it shows <code>LoginSuccess</code> (it is moving Service Page it is another component in flex).</p>\n\n<pre><code>With out Login:http://localhost:8080/A2M/A2M-debug/A2M.html\nAfter Login:http://localhost:8080/A2M/A2M-debug/A2M.html\n\nActually i want adding userid and password into url after login.\n</code></pre>\n\n<p>why i'm asking this one is when we are copy url(appending username &amp; password) another tab of browser it is continue that session only. </p>\n\n<p>So <code>How to add userid into Url?</code>\nPlease help me...give me your Valuable Suggestion or reference..</p>\n\n<pre><code>Thank you\n</code></pre>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":14,"score":-3,"question_id":13171682,"title":"Using createSQLquery","body":"<p>I want to make this with createSQLQuery(),but i am not able to do it.Kindly help please.  </p>\n\n<blockquote>\n  <p>select audit_Id,audit_Date from Sm_Audit where audit_Date=(select\n  rs.ad from(select supplier_plant_id,max(audit_Date)as ad from Sm_Audit\n  as a where supplier_plant_id=497 and audit_type_id=1 group by\n  supplier_plant_id)as rs)</p>\n</blockquote>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":376,"score":2,"question_id":10319205,"title":"Hibernate Performance Best Practice?","body":"<p>Im writing a Web application using Hibernate 3. </p>\n\n<p>So, after a while i noticed that something was slow. So i tested hibernate profiler and found that hibernate will make unreasonably many db-calls for simple operation. The reason is ofcourse that i load an Object (this object has several \"parents\") and these \"parents\" have other \"parents\". So basicly hibernate loads them all, even though i just need the basic object.\nOk, so i looked into lazy-loading. Which lead me into the Lazyloading-exception, because i have a MVC webapp.</p>\n\n<p>So now i'm a bit confused as to what is my best approach to this.\nBasicly all I need is to update a single field on an object. I already have the object-key.</p>\n\n<p>Should I:\n1. Dig into Lazy-loading. And then rewrite my app for a open-session-view?\n2. Dig into lazy-loading. And then rewrite my dao's to be more specific. E.g. writing DAO-methods that will return objects instanciated with only whats necessary for each use-case? Could be a lot of extra methods...\n3. Scratch hibernate and do it myself?\n4. Cant really think of other solutions right now. Any suggestions?</p>\n\n<p>What is the best practice?</p>\n"},{"tags":["hibernate","jpa","spring-mvc","jndi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13155958,"title":"JNDI type specification conflict with Spring","body":"<p>I am trying to have JNDI data source for my application along with spring. the configuration are working fine if i don't inject any classes if i inject i am facing the below mentioned issue</p>\n\n<p><strong>Server.xml(Tomcat)</strong></p>\n\n<pre><code>&lt;GlobalNamingResources&gt;\n   &lt;Resource name=\"jdbc/purpleDS\" auth=\"Container\" type=\"javax.sql.DataSource\"\n    driverClassName=\"oracle.jdbc.OracleDriver\" url=\"jdbc:oracle:thin:@localhost:1521:xe\"\n    username=\"test\" password=\"test\" maxActive=\"100\" maxIdle=\"30\"\n    maxWait=\"10000\" /&gt;\n\n&lt;/GlobalNamingResources&gt;\n</code></pre>\n\n<p><strong>Context.xml</strong></p>\n\n<pre><code>&lt;Context&gt;\n    &lt;!-- Oracle Database configuration --&gt;\n    &lt;ResourceLink global=\"jdbc/purpleDS\" name=\"jdbc/purpleDS\" type=\"javax.sql.DataSource\"/&gt;\n&lt;/Context&gt;\n</code></pre>\n\n<p><strong>persistence.xml</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"2.0\"\n    xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"&gt;\n\n    &lt;persistence-unit name=\"CoreProject\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;non-jta-data-source&gt;jdbc/purpleDS&lt;/non-jta-data-source&gt;\n\n\n            &lt;property name=\"hibernate.show_sql\" value=\"true\" /&gt;\n            &lt;property name=\"hibernate.format_sql\" value=\"true\" /&gt;\n            &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.Oracle10gDialect\" /&gt;\n            &lt;property name=\"hibernate.search.default.directory_provider\"\n                value=\"org.hibernate.search.store.impl.FSDirectoryProvider\" /&gt;\n\n            &lt;property name=\"hibernate.search.default.indexBase\" value=\"indexes\" /&gt;\n\n        &lt;/properties&gt;\n\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p><strong>web.xml</strong></p>\n\n<pre><code>&lt;resource-ref&gt;\n    &lt;description&gt;Oracle DataSource &lt;/description&gt;\n    &lt;res-ref-name&gt;jdbc/purpleDS&lt;/res-ref-name&gt;\n    &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;\n    &lt;res-auth&gt;Container&lt;/res-auth&gt;\n&lt;/resource-ref&gt;\n</code></pre>\n\n<p><strong>application-Context.xml</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans:beans xmlns=\"http://www.springframework.org/schema/mvc\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:beans=\"http://www.springframework.org/schema/beans\"\n    xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xmlns:jee=\"http://www.springframework.org/schema/jee\" xmlns:p=\"http://www.springframework.org/schema/p\"\n    xmlns:aop=\"http://www.springframework.org/schema/aop\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd\n        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd\n        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd\n        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd\n        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd\"&gt;\n\n    &lt;!-- DispatcherServlet Context: defines this servlet's request-processing \n        infrastructure --&gt;\n\n    &lt;!-- Enables the Spring MVC @Controller programming model --&gt;\n    &lt;annotation-driven /&gt;\n    &lt;tx:annotation-driven /&gt;\n    &lt;context:component-scan base-package=\"com.purple.service\" /&gt;\n    &lt;context:component-scan base-package=\"com.purple.app\" /&gt;\n    &lt;context:component-scan base-package=\"com.purple.dao\" /&gt;\n    &lt;context:component-scan base-package=\"com.purple.domain\" /&gt;\n\n\n\n    &lt;!-- Handles HTTP GET requests for /resources/** by efficiently serving \n        up static resources in the ${webappRoot}/resources directory --&gt;\n    &lt;resources mapping=\"/resources/**\" location=\"/resources/\" /&gt;\n\n    &lt;!-- Resolves views selected for rendering by @Controllers to .jsp resources \n        in the /WEB-INF/views directory --&gt;\n    &lt;beans:bean\n        class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n        &lt;beans:property name=\"prefix\" value=\"/WEB-INF/views/\" /&gt;\n        &lt;beans:property name=\"suffix\" value=\".jsp\" /&gt;\n    &lt;/beans:bean&gt;\n\n    &lt;jee:jndi-lookup id=\"purpleDS\" jndi-name=\"jdbc/purpleDS\" /&gt;\n    &lt;beans:bean id=\"entityManagerFactory\"\n        class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n        &lt;beans:property name=\"dataSource\" ref=\"purpleDS\" /&gt;\n    &lt;/beans:bean&gt;\n    &lt;beans:bean id=\"transactionManager\"\n        class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n        &lt;beans:property name=\"entityManagerFactory\" ref=\"entityManagerFactory\" /&gt;\n    &lt;/beans:bean&gt;\n\n&lt;/beans:beans&gt;\n</code></pre>\n\n<p>I am facing the following error</p>\n\n<pre><code>ERROR: org.springframework.web.servlet.DispatcherServlet - Context initialization failed\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'CustProductMapService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.purple.dao.ICustProductMapDAO com.purple.service.CustProductMapService.custProductMapDAO; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'CustProductMapDAO': Injection of persistence dependencies failed; nested exception is org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named 'purpleDS' must be of type [javax.persistence.EntityManagerFactory], but was actually of type [org.apache.tomcat.dbcp.dbcp.BasicDataSource]\nat org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\nat org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\nat org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\nat org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\nat org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\nat org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\nat org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)\nat org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)\nat org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)\nat org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)\nat org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)\nat org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)\nat org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)\nat org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)\nat org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)\nat javax.servlet.GenericServlet.init(GenericServlet.java:212)\nat org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1206)\nat org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1026)\nat org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4421)\nat org.apache.catalina.core.StandardContext.start(StandardContext.java:4734)\nat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)\nat org.apache.catalina.core.StandardHost.start(StandardHost.java:840)\nat org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)\nat org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)\nat org.apache.catalina.core.StandardService.start(StandardService.java:525)\nat org.apache.catalina.core.StandardServer.start(StandardServer.java:754)\nat org.apache.catalina.startup.Catalina.start(Catalina.java:595)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\nat org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.purple.dao.ICustProductMapDAO com.purple.service.CustProductMapService.custProductMapDAO; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'CustProductMapDAO': Injection of persistence dependencies failed; nested exception is org.springframework.beans.factory.BeanNotOfRequiredTypeException: Bean named 'purpleDS' must be of type [javax.persistence.EntityManagerFactory], but was actually of type [org.apache.tomcat.dbcp.dbcp.BasicDataSource]\nat org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)\nat org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\nat org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n... 34 more\n</code></pre>\n\n<p>Could anyone help me to identify the issue or am i missing something?</p>\n\n<p>Thanks &amp; Regards\nVijay</p>\n"},{"tags":["java","hibernate","orm","jpa","jpql"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2490,"score":2,"question_id":3585488,"title":"JPA Fetch Join Filter on List/Set","body":"<p>I'm having problem on JPA (Hibernate) Fetch Join :</p>\n\n<p>Here is my JPQL query </p>\n\n<p><code>\n SELECT n FROM News n LEFT JOIN FETCH n.profiles AS pr WHERE pr.id=?1\n</code></p>\n\n<p>But it's not working. How can I make a query that filters on the list that is being fetched ?</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13168467,"title":"How do I map a java Map including another Map, as element, into hibernate *.hbm.xml","body":"<p>is there possibility to map something like: </p>\n\n<pre><code>private Map&lt;Website, Map&lt;String, String&gt;&gt; parameterMaps =\n  new HashMap&lt;Website, Map&lt;String, String&gt;&gt;();\n</code></pre>\n\n<p>Where 'Website' is my class having some strings attributes, and inner map should be some website specific url parts. I'd like to map it into *.hbm.xml rather than using annotations, because its habit in my project. I appreciate any useful reference to any manual too. Thanks!</p>\n"},{"tags":["java","hibernate","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13160562,"title":"Order by is not working with postgres fts","body":"<p>I have a following query. While executing this query, order by after fts is not working. Hibernate ignores the order by in the following HQL (Hibernate Query Language) code:</p>\n\n<pre><code>Session session = getSession();\nString queryString = \"select estimate.finEstimateId as finEstimateId, \nestimate.estimateNumber as estimateNumber, estimate.customerName as customerName, \nestimate.amountTotal as amountTotal,estimate.estimateStatus as estimateStatus, \nestimate.estimateDate as estimateDate, estimate.expirationDate as expirationDate, \nestimate.creationDate as creationDate,estimate.searchColumn as searchColumn \nfrom AppFinEstimate estimate where estimate.firmId = :firmId  \nand fts('english',estimate.searchColumn,'avaranam') = true) \n\norder by estimate.customerName desc\"\n\nQuery query = session.createQuery(queryString);\n</code></pre>\n\n<p>The sorting is not working. If we sort without using fts, its working fine. </p>\n\n<p>This is the SQL that Hibernate generates from the above HQL:</p>\n\n<pre><code>select\n    appfinesti0_.fin_estimate_id as col_0_0_,\n    appfinesti0_.estimate_number as col_1_0_,\n    appfinesti0_.customer_name as col_2_0_,\n    appfinesti0_.amount_total as col_3_0_,\n    appfinesti0_.estimate_status as col_4_0_,\n    appfinesti0_.estimate_date as col_5_0_,\n    appfinesti0_.expiration_date as col_6_0_,\n    appfinesti0_.CREATION_DATE as col_7_0_,\n    appfinesti0_.search_column as col_8_0_ \nfrom\n    fin_estimates appfinesti0_ \nwhere\n    appfinesti0_.firm_id=? \n    and to_tsvector('english'::regconfig, appfinesti0_.search_column) @@ to_tsquery('english', 'avaranam')=true\n</code></pre>\n\n<p>Note that the <code>ORDER BY</code> clause is missing, despite it being present in the HQL.</p>\n\n<p>Why? Any ideas?</p>\n"},{"tags":["java","hibernate","netbeans","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13166694,"title":"Hibernate (HQL)","body":"<p>I am working with NetBeans and when I write an HQL query I see some weird results, when I make a query, at the HQL Editor, like this <code>from User</code>, it returns what I expect, but If I write: <code>select a.name from User a</code>, it returns nothing, just types names at the column name <code>query(Char Char Byte Byte)</code>, although it says the number of records. Anyone has seen this before?</p>\n"},{"tags":["java","hibernate","jpa","dao"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13163146,"title":"DAO class for association entity with an attribute - how to implement it?","body":"<p>I have class CreatureType and Weapon (the best weapon to use against some creature) and I need to model the fact that a weapon has various efficiency against particular CreatureType. So I created the association entity CreatureTypeWeapon which has the efficiency attribute.</p>\n\n<p>I coded it in this way (the principle is the same) <a href=\"http://uaihebert.com/?p=1674&amp;page=22\" rel=\"nofollow\">http://uaihebert.com/?p=1674&amp;page=22</a></p>\n\n<p>The reason why I am asking this question is that I don't know how to implement dao class for the association entity.</p>\n\n<p>I have the DAO class for CreatureType and I have the DAO class for Weapon which implements the interfaces with CRUD operations.</p>\n\n<p>But I am somehow missing a way ho to deal with CRUD operations on the association entity. Let's say I have this DAO</p>\n\n<pre><code>public class CreatureTypeWeaponDAOImpl implements CreatureTypeWeaponDAO {\n\n    @Override\n    public void create(CreatureTypeWeapon creatureTypeWeapon) {\n        // implementation\n    }\n    // ... other CRUD methods\n}\n</code></pre>\n\n<p>I use it like this:</p>\n\n<pre><code>// this is like a person\nCreatureType creatureType = new CreatureType();\ncreatureType.setName(\"alien\");\ncreatureType.setMaxHitPoints(200);\n\n// this is like a dog\nWeapon weapon = new Weapon();           \nweapon.setName(\"ak-47\");\n\n// this is like PersonDog\nCreatureTypeWeapon creatureTypeWeapon = new CreatureTypeWeapon();\ncreatureTypeWeapon.setWeapon(weapon);\ncreatureTypeWeapon.setCreatureType(creatureType);\n// this is like \"adoptionDate\" in the link posted\n// 0.5 means when I hit it with ak-47 it takes half of its max hit points\n// so I have to fire 2 times on it and it will die.\ncreatureTypeWeapon.setEfficiency(0.5);\n\n// this is actually injected\nCreatureTypeWeaponDAO dao = new CreatureTypeWeaponDAOImpl();\ndao.create(creatureTypeWeapon);\n</code></pre>\n\n<p>But the question is, how to implement it? I am able to persist it normally, but let's say I am going to remove this relationship:</p>\n\n<pre><code>dao.remove(creatureTypeWeapon);\n</code></pre>\n\n<p>Which could be implemented like this</p>\n\n<pre><code>public class CreatureTypeWeaponDAOImpl implements CreatureTypeWeaponDAO {\n    void remove(CreatureTypeWeapon arg) {\n        CreatureTypeWeapon toRemove = em.find(/* WHAT TO PUT HERE */);\n        em.remove(toRemove);\n    }\n}\n</code></pre>\n\n<p>Normally, I put there</p>\n\n<pre><code>em.find(CreatureTypeWeapon.class, arg.getId());\n</code></pre>\n\n<p>but there is not \"id\" in the association entity ....</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Ok so this is the way how I am getting a CreatureTypeWeapon instances in the CreatureTypeWeaponDAOImpl</p>\n\n<pre><code>TypedQuery&lt;CreatureTypeWeapon&gt; query = \n    em.createQuery(\n        \"SELECT ctw FROM CreatureTypeWeapon ctw WHERE \"\n            + \"creatureType = :creatureType \"\n            + \"AND \"\n            + \"weapon = :weapon\", \n        CreatureTypeWeapon.class);\n\n    CreatureType creatureTypePersisted = \n        em.getReference(CreatureType.class, creatureType.getId());\n    Weapon weaponPersisted = em.getReference(Weapon.class, weapon.getId());\n\n    query.setParameter(\"creatureType\", creatureTypePersisted);\n    query.setParameter(\"weapon\", weaponPersisted);\n    return query.getSingleResult();\n</code></pre>\n\n<p>Getting seems to be ok but when I am going to remove it in the remove method as simple as em.remove(creatureTypeWeapon); (as advised) I am getting this error: </p>\n\n<pre><code>javax.persistence.NoResultException: No entity found for query at org.hibernate.ejb.QueryImpl.getSingleResult(QueryImpl.java:291)\nat cz.muni.fi.pa165.creatures.dao.impl.CreatureTypeWeaponDAOImpl.get(CreatureTypeWeaponDAOImpl.java:101)\n</code></pre>\n\n<p>This is a way how I am testing it:</p>\n\n<pre><code>public void testRemoveCreatureTypeWeapon() {\n\n    Weapon w = new Weapon(\"ak-47\");\n    weaponDAO.create(w);\n\n    CreatureType ct = new CreatureType(\"alien\", 200);\n    creatureTypeDAO.create(ct);\n\n    assertNotNull(weaponDAO.get(w.getId()));\n    assertNotNull(creatureTypeDAO.get(ct.getId()));\n\n    CreatureTypeWeapon ctw = new CreatureTypeWeapon();\n    ctw.setCreatureType(ct);\n    ctw.setWeapon(w);\n    ctw.setEffectivity(new Float(0.5));\n    creatureTypeWeaponDAO.create(ctw);\n\n    CreatureTypeWeapon ctw2 =\n            creatureTypeWeaponDAO.get(ctw.getCreatureType(), ctw.getWeapon());\n\n    ctw2.setCreatureType(ctw.getCreatureType());\n    ctw2.setWeapon(ctw.getWeapon());\n\n    creatureTypeWeaponDAO.remove(ctw);\n\n    assertNull(creatureTypeWeaponDAO.get(ctw2.getCreatureType(), ctw2.getWeapon()));\n} \n</code></pre>\n\n<p><strong>UPDATE #2</strong></p>\n\n<p>Ok I got it, the reason there was such error was that when query.getSingleResult() throws NoResultException, it means that when I try to get the entity after its removing in the test, there is no such record, so that method throws an execption, which is good. I handled it like this:</p>\n\n<pre><code>try {\n    return query.getSingleResult();\n} catch(NoResultException ex) {\n    return null;\n}\n</code></pre>\n\n<p>After doing so, it is possible to remove it normally, (it was doable even before it but I was confused and thought the error was there).</p>\n"},{"tags":["java","mysql","hibernate","types"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":3230,"score":5,"question_id":8038939,"title":"Map a tinyint as boolean hibernate","body":"<p>I know this question sounds stupid, but I have tried everything, and I'm stumped.</p>\n\n<p>I have a BOOLEAN type in a MySQL table (TINYINT(1)) and I'm trying to map the boolean field in an entity but this generates an exception:</p>\n\n<pre><code>org.hibernate.HibernateException: Wrong column type in maegul.users for column admin. Found: bit, expected: boolean\n</code></pre>\n\n<p>Ok, so I change the field in my entity to byte and make the respective changes so it acts a boolean, and I get:</p>\n\n<pre><code>org.hibernate.HibernateException: Wrong column type in maegul.users for column admin. Found: bit, expected: tinyint\n</code></pre>\n\n<p>I tried using the <code>@Type</code> annotation on the field:</p>\n\n<pre><code>@Type(type = \"org.hibernate.type.NumericBooleanType\")\n</code></pre>\n\n<p>with this I get:</p>\n\n<pre><code>org.hibernate.HibernateException: Wrong column type in maegul.users for column admin. Found: bit, expected: integer\n</code></pre>\n\n<p>I seriously don't know what to do...</p>\n"},{"tags":["java","hibernate","join","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13148446,"title":"Hibernate unnecessarily update joined tables","body":"<p>Basically, I have 2 classes P &amp; M, and their corresponding tables T_P &amp; T_M, and they are joined in a one-to-many relation, one P has a set of Ms. Something like this:</p>\n\n<pre><code>&lt;class name=\"P\" table=\"T_P\"&gt;\n    &lt;set name=\"ms\" cascade=\"all\" lazy=\"false\" inverse=\"true\"&gt;\n        &lt;key column=\"P_ID\" not-null=\"true\" foreign-key=\"FK_M_P\"/&gt;\n        &lt;one-to-many class=\"M\"/&gt;\n    &lt;/set&gt;\n&lt;/class&gt;\n&lt;class name=\"M\" table=\"T_M\"&gt;\n    &lt;many-to-one name=\"p\" column=\"P_ID\" foreign-key=\"FK_M_P\" class=\"P\"\n                 update=\"false\" not-null=\"true\" cascade=\"none\"/&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>Now when I make changes to P and ask Hibernate to update DB. It's very likely Hibernate will do a batch of updates, one to T_P, several to T_M, and I know the later part is not necessary as I didn't change those Ms. But I think because my object is detached, hibernate has to update everything.</p>\n\n<p>So my question is, in my case, can I ask Hibernate to only update partially, and not to make excessive DB hits? Or other suggestion to optimize this is also appreciated. But this is a legacy program, and I may not be able to make drastic changes.</p>\n"},{"tags":["java","hibernate","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":197,"score":2,"question_id":12035135,"title":"Error trying to execute a stored procedure with Hibernate and PostgreSQL","body":"<p>I'm trying to execute a stored procedure with hibernate (Java Persistence API) and postgreSQL. My mapping file looks as follows:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n&lt;sql-query name=\"getnotificaciones\" callable=\"true\"&gt;\n&lt;return alias=\"notificacion\"\nclass=\"tempranillo.entidades.sistemanotificaciones.NotificacionDB\" lock-mode=\"read\"&gt;\n&lt;return-property name=\"fecha\" column=\"fecha\"/&gt;\n&lt;return-property name=\"notificacion\" column=\"notificacioncolumn\"/&gt;\n&lt;return-property name=\"xmlnotificacion\" column=\"xmlcolumn\"/&gt;\n&lt;/return&gt;\n{call getnotificaciones(:idusuario)}\n&lt;/sql-query&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>The stored procedure is shown below:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION getNotificaciones(idusuario  int4,\nOUT fecha               date,\nOUT notificacioncolumn  varchar,\nOUT xmlcolumn           xml\n)\nRETURNS SETOF record\nAS $$\nSELECT \n   INFONOT.fecha, \n   INFONOT.notificacion, \nxmlelement (name notificacion, xmlattributes(current_date as \"fecha\",\nINFONOT.xmlTipoNotificacion as \"tipoNotificacion\"),\n   xmlelement (name infovino,\n     xmlforest(\n                 tvinos.idvino,\n                 tvinos.nombre,\n                 tvinos.tipovino,\n                 tvinos.anio,\n                 tvinos.variedad,\n                 tvinos.zona,\n                 tvinos.pais)\n                 ),\n     xmlelement (name infousuario,\n     xmlforest(\n                 tusuarios.idusuario,\n                 tusuarios.ALIAS)\n                 ),\n     xmlelement (name infologro,\n     xmlforest(\n               tlogros.idlogro,\n               tlogros.nombrelogro,\n               tlogros.descripcion\n                 )\n               )\n     )\nFROM\npublic.tusuarios\nINNER JOIN \n(SELECT DISTINCT(xpath('//Notificacion/usuarioOrigina\n/id/text()',xmlnotificacion::xml))[1]::varchar::int4 as xmlidusuario, \n             (xpath('//Notificacion/vino/idvino/text()',xmlnotificacion::xml\n[1]::varchar::int4 as XMLIDVINO, \n             (xpath('//Notificacion/tipoNotificacion/text()',xmlnotificacion::xml\n[1]::varchar as xmlTipoNotificacion,\n             (xpath('//Notificacion/Logro/IdLogro/text()',xmlnotificacion::xml\n[1]::varchar::int4 as xmlIdLogro,\n             public.tnotificacion.idnotificacion,\n             public.tnotificacion.fecha,\n             public.tnotificacion.notificacion\nFROM  \n  public.tamistad  RIGHT OUTER JOIN public.tnotificacion ON\n(public.tamistad.idamigo=     public.tnotificacion.idusuario) \nWHERE  (public.tamistad.idusuario = $1 OR   public.tnotificacion.idusuario = $1) AND\npublic.tnotificacion.xmlnotificacion IS NOT NULL)  AS INFONOT \nON (public.tusuarios.idusuario = INFONOT.xmlidusuario)\nLEFT OUTER JOIN public.tvinos \non (public.tvinos.idvino = INFONOT.xmlidvino)\nLEFT OUTER JOIN public.tlogros\non (public.tlogros.idlogro = INFONOT.xmlIdLogro) \nORDER BY \nINFONOT.fecha DESC;          \n$$ LANGUAGE SQL;\n</code></pre>\n\n<p>The entity declared in java as follows:</p>\n\n<pre><code>package tempranillo.entidades.sistemanotificaciones;\n\npublic class NotificacionDB implements Serializable {\n\n    public NotificacionDB() {\n    }\n\n    public NotificacionDB(int idusuario,\n                            Date fecha,\n                            String notificacion) {\n        this.idusuario = idusuario;\n        this.fecha = fecha;\n        this.notificacion = notificacion;\n    }\n\n     public NotificacionDB(int idusuario,\n                            Date fecha,\n                            String notificacion,\n                            String xmlnotificacion) {\n        this.idusuario = idusuario;\n        this.fecha = fecha;\n        this.notificacion = notificacion;\n        this.xmlnotificacion = xmlnotificacion;\n    }\n\n\n    private int idnotificacion;\n\n    public int getIdnotificacion() {\n        return idnotificacion;\n    }\n\n    private void setIdnotificacion(int idnotificacion) {\n        this.idnotificacion = idnotificacion;\n    }\n    private int idusuario;\n\n    public int getIdusuario() {\n        return idusuario;\n    }\n\n    public void setIdusuario(int idusuario) {\n        this.idusuario = idusuario;\n    }\n    private Date fecha;\n\n    public Date getFecha() {\n        return fecha;\n    }\n\n    public void setFecha(Date fecha) {\n        this.fecha = fecha;\n    }\n    private String notificacion;\n\n    public String getNotificacion() {\n        return notificacion;\n    }\n\n    public void setNotificacion(String notificacion) {\n        this.notificacion = notificacion;\n    }\n\n    private String xmlnotificacion;\n\n    public String getXmlnotificacion() {\n        return xmlnotificacion;\n    }\n\n    public void setXmlnotificacion(String xmlnotificacion) {\n        this.xmlnotificacion = xmlnotificacion;\n    }\n\n}\n</code></pre>\n\n<p>When I try to execute the following code:</p>\n\n<pre><code>   Query query = sesion.getNamedQuery(\"getnotificaciones\");\n   query.setInteger(\"idusuario\", idusuario);\n   List listanotificaciones = query.list();\n</code></pre>\n\n<p>I always get the same error: <code>There is a problema with the postgreSQLDialect</code>.</p>\n\n<p>I tried with <code>select * from getnotificaciones (:idusuario)</code> but in this case I get \"could not execute query\" error message.</p>\n\n<p>Can anyone help me?</p>\n"},{"tags":["hibernate","orm","code-generation","ddl"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":419,"score":5,"question_id":6633384,"title":"Can I configure Hibernate to create separate sequence for each table by default?","body":"<p>Hibernate by default creates a globel sequence which is used to generate ids for all tables, (in the case for PostgreSQL) which scales very bad IMHO. Though I can specify for each entity type which sequence to use, I don't like to do it. I don't like to explicit name the sequence and force to use sequence as the generator strategy, because I want hibernate generate DDL for databases which may not support sequence at all. The single global sequence also make it impossible to use 32-bit int as the primary key, which means I must convert all int id(s) to long type.</p>\n"},{"tags":["hibernate","spring","zk"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4501,"score":0,"question_id":2487972,"title":"zk selecting combobox item programatically","body":"<p>I cannot set the value of combobox programatically can some one tell me what missing in the code</p>\n\n<pre><code> public class Profile extends Window implements AfterCompose {\n\n    @Override\n    public void afterCompose() {\n       Session session = Sessions.getCurrent(false);\n                ApplicationContext ctx = WebApplicationContextUtils.getRequiredWebApplicationContext(\n                (ServletContext) getDesktop().getWebApp().getNativeContext());\n\n        UsersDao usersDao = (UsersDao) ctx.getBean(\"daoUsers\");\n\n\n        User user = (User) session.getAttribute(\"user\");\n        user = usersDao.getUser(user.getUsername(),user.getPassword());\n\n        Textbox username_t = (Textbox) this.getFellow(\"username\");\n        Textbox password_t = (Textbox) this.getFellow(\"password\");\n        Textbox conpassword_t = (Textbox) this.getFellow(\"con_password\");\n        Textbox firstname_t = (Textbox) this.getFellow(\"firstName\");\n        Textbox lastname_t = (Textbox) this.getFellow(\"lastName\");\n        Textbox email_t = (Textbox) this.getFellow(\"email\");\n        Combobox hintQuestion_t = (Combobox) this.getFellow(\"hintQuestion\");\n        Textbox hintAnswer_t = (Textbox) this.getFellow(\"hintAnswer\");\n        Combobox locale_t = (Combobox) this.getFellow(\"locale\");\n        Combobox authority_t = (Combobox) this.getFellow(\"authority\");\n\n        username_t.setText(user.getUsername());\n        firstname_t.setText(user.getUserDetails().getFirstName());\n        lastname_t.setText(user.getUserDetails().getLastName());\n        email_t.setText(user.getUserDetails().getEmail());\n        Comboitem selectedItem = getSelectedIndexComboboxItem(hintQuestion_t, user.getHintQuestion());\n        hintQuestion_t.setSelectedItem(selectedItem);\n        hintAnswer_t.setText(user.getHintAnswer());\n        selectedItem = getSelectedIndexComboboxItem(locale_t, user.getUserDetails().getLocale());\n        locale_t.setSelectedItem(selectedItem);\n        selectedItem = getSelectedIndexComboboxItem(authority_t, ((Authority)user.getAuthorities().toArray()[0]).getRole());\n        authority_t.setSelectedItem(selectedItem);\n\n\n    }\n\n   private Comboitem getSelectedIndexComboboxItem(Combobox combobox, String value) {\n        List&lt;Comboitem&gt; items = combobox.getItems();\n        Comboitem item = items.get(0);\n        for (int i = 0; i &lt; items.size(); i++) {\n            Comboitem comboitem = items.get(i);\n            String label = (String)comboitem.getLabel();\n            String cval = (String)comboitem.getValue();\n            if ((label!=null &amp;&amp; label.equalsIgnoreCase(value)) || (cval != null  &amp;&amp; cval.equalsIgnoreCase(value))) {\n                item = comboitem;\n                break;\n            }\n        }\n        return item;\n    }\n}\n</code></pre>\n\n<p>// zk file</p>\n\n<pre><code>&lt;window id=\"profile\" use=\"com.jf.web.zk.ui.Profile\"&gt;\n        &lt;tabbox  id=\"tabbox\" width=\"40%\" &gt;\n            &lt;tabs&gt;\n                &lt;tab label=\"Account Information\"/&gt;\n                &lt;tab label=\"Personal Information\"/&gt;\n                &lt;tab label=\"Contact Details\"/&gt;\n            &lt;/tabs&gt;\n            &lt;tabpanels&gt;\n                &lt;tabpanel&gt;\n                    &lt;grid&gt;\n                        &lt;rows&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.username')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"username\" /&gt;*,a-zA-Z,0-9\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.password')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"password\" type=\"password\"/&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('registration.user.password.confirm')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"con_password\" type=\"password\"/&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.details.first.name')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"firstName\" type=\"text\"/&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.details.last.name')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"lastName\" type=\"text\"/&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.details.email')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"email\" type=\"text\"/&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.hint.question')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;combobox id=\"hintQuestion\" onCreate='self.setSelectedIndex(1);'&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.hint.question.possible.value1')}\" /&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.hint.question.possible.value2')}\" /&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.hint.question.possible.value3')}\" /&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.hint.question.possible.value4')}\" /&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.hint.question.possible.value5')}\" /&gt;\n                                    &lt;/combobox&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.hint.answer')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;textbox id=\"hintAnswer\" type=\"text\"/&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('user.details.locale')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;combobox id=\"locale\" onCreate='self.setSelectedIndex(1);self.setReadonly(true);'&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.details.locale.en')}\" value=\"en_US\"/&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('user.details.locale.bg')}\" value=\"bg_BG\"/&gt;\n                                    &lt;/combobox&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                            &lt;row&gt;\n                                &lt;label value=\"${i18nUtils.message('authority.account.type')}\"/&gt;\n                                &lt;hbox&gt;\n                                    &lt;combobox id=\"authority\" onCreate='self.setSelectedIndex(0);self.setReadonly(true);'&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('authority.job.seeker')}\" value=\"Job Seeker\"/&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('authority.employer')}\" value=\"Employer\"/&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('authority.hra')}\" value=\"Human Resource Agency\"/&gt;\n                                        &lt;comboitem label=\"${i18nUtils.message('authority.advertiser')}\" value=\"Advertiser\"/&gt;\n                                    &lt;/combobox&gt;*\n                                &lt;/hbox&gt;\n                            &lt;/row&gt;\n                        &lt;/rows&gt;\n                    &lt;/grid&gt;\n                &lt;/tabpanel&gt;\n            &lt;/tabpanels&gt;\n        &lt;/tabbox&gt;\n        &lt;grid width=\"40%\"&gt;\n            &lt;rows&gt;\n                &lt;row&gt;\n                    &lt;button label=\"${i18nUtils.message('bttn.save')}\" onClick=\"save()\"/&gt;\n                    &lt;button label=\"${i18nUtils.message('bttn.cancel')}\" onClick=\"cancel()\"/&gt;\n                &lt;/row&gt;\n            &lt;/rows&gt;\n        &lt;/grid&gt;\n    &lt;/window&gt;\n&lt;/zk&gt;\n</code></pre>\n\n<p>The \"getSelectedIndexComboboxItem()\" does return the correct selected item but there seems no effect on the UI. Like for example the locale is set to default Bulgarian language and I need to set it to English.</p>\n\n<p>Abdul Khaliq </p>\n"},{"tags":["java","database","hibernate","orm"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":10278714,"title":"Stackoverflowerror / Unresolved Object Exception with Hibernate, Collections and Session.refresh(...)","body":"<p>In my current project, I'm using Hibernate 3. The tool I'm working on connects to a MS SQL Server Database. The tool is installed on two different Machines, both connect to the same Database. </p>\n\n<p>On the first machine I'm altering an object that contains a collection. On the second Machine I'm using session.refresh(...) to see the Changes made on the first Machine. </p>\n\n<p>When I add an Object to the collection and refresh, I get a Stackoverflowerror. When I remove an Object from the collection and refresh, I get an UnresolvedObjectException. </p>\n\n<pre><code>session.evict(...)\nsession.get(...) \n</code></pre>\n\n<p>seems to work. But <code>session.refresh(...)</code>. Why?</p>\n\n<p>Here is a full stacktrace:</p>\n\n<pre><code>java.lang.StackOverflowError\nat net.sourceforge.jtds.jdbc.JtdsStatement.&lt;init&gt;(JtdsStatement.java:129)\nat net.sourceforge.jtds.jdbc.JtdsPreparedStatement.&lt;init&gt;(JtdsPreparedStatement.java:99)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.prepareStatement(ConnectionJDBC2.java:2456)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.prepareStatement(ConnectionJDBC2.java:2414)\nat net.sourceforge.jtds.jdbcx.proxy.ConnectionProxy.prepareStatement(ConnectionProxy.java:394)\nat org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:534)\nat org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:452)\nat org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)\nat org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1573)\nat org.hibernate.loader.Loader.doQuery(Loader.java:696)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:588)\nat org.hibernate.loader.Loader.doQuery(Loader.java:724)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1881)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:71)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:65)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3072)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:434)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:415)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:165)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:207)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:126)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:905)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:873)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:590)\nat org.hibernate.type.EntityType.resolve(EntityType.java:412)\nat org.hibernate.type.ComponentType.resolve(ComponentType.java:607)\nat org.hibernate.type.ComponentType.nullSafeGet(ComponentType.java:298)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1121)\n</code></pre>\n"},{"tags":["java","hibernate","map","hashmap","persist"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13155660,"title":"Hibernate - How to persist a HashMap","body":"<p>Searching Stackoverflow, I saw that many people have my same problem, but I can't find out the solution looking at the other posts. So:</p>\n\n<p>I am trying to persist a Hibernate class, but without using an Entity Object. Instead I am using a Map.</p>\n\n<p>This is my map:</p>\n\n<pre><code>Map&lt;String, Object&gt; record;\nrecord = new HashMap&lt;String, Object&gt;();\n\n...\n\nrecord.put(\"key1\", \"value\");\nrecord.put(\"key2\", \"value\");\nrecord.put(\"field1\", \"value\");\nrecord.put(\"field2\", \"value\");\nrecord.put(\"field3\", \"value\");\nrecord.put(\"field4\", \"value\");\nrecord.put(\"field5\", \"value\");\nrecord.put(\"field6\", value);\nrecord.put(\"field7\", value);\n</code></pre>\n\n<p>and this is the hbm.xml</p>\n\n<pre><code>&lt;class entity-name=\"entity_name\" dynamic-update=\"true\"&gt;\n&lt;composite-id name=\"Key1Key2\" class=\"classname\"&gt;\n    &lt;key-property name=\"Key1\" column=\"Key1\" type=\"string\"/&gt;\n    &lt;key-property name=\"Key2\" column=\"Key2\" type=\"string\"/&gt;\n&lt;/composite-id&gt;\n    &lt;property name=\"field1\" column=\"field1\" type=\"string\"/&gt;\n    &lt;property name=\"field2\" column=\"field2\" type=\"string\"/&gt;\n    &lt;property name=\"field3\" column=\"field3\" type=\"string\"/&gt;\n    &lt;property name=\"field4\" column=\"field4\" type=\"string\"/&gt;\n    &lt;property name=\"field5\" column=\"field5\" type=\"string\"/&gt;\n    &lt;property name=\"field6\" column=\"field6\" type=\"double\"/&gt;\n    &lt;property name=\"field7\" column=\"field7\" type=\"double\"/&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>When I try to persist the record:</p>\n\n<pre><code>super.session.persist(\"entity_name\", record)\n</code></pre>\n\n<p>This error is returned:</p>\n\n<p><strong>org.hibernate.id.IdentifierGenerationException: ids for this class must be manually assigned before calling save()</strong></p>\n\n<p>Can anyone help me?\nThank in advance!</p>\n"},{"tags":["java","hibernate","composite-key"],"answer_count":3,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":15818,"score":5,"question_id":2301259,"title":"hibernate composite key","body":"<p>Is it necessary that composite-id should be mapped to class ??</p>\n\n<p>can it be like this ?</p>\n\n<pre><code>&lt;composite-id&gt;\n  &lt;key-property=..../&gt;\n  &lt;key-property=..../&gt;\n&lt;/composite-id&gt;\n</code></pre>\n\n<p>or should be </p>\n\n<pre><code>&lt;composite-id class=....&gt;\n  &lt;key-property=..../&gt;\n  &lt;key-property=..../&gt;\n&lt;/composite-id&gt;\n</code></pre>\n\n<p>should that necessary that if we have composite key then that class should implement <code>equals()</code> and <code>override()</code> method ?</p>\n"},{"tags":["java","query","hibernate","collate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13160476,"title":"How I should use COLLATE in Hibernate Query","body":"<p>I'am trying to use COLLATE statment in a Hibernate SQL query but, it doesn't reconise the statment.</p>\n\n<pre><code>CONSULTA: FROM Articulos WHERE activo=0 and (codigodearticulo like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI' or descripcion like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI'  or descripcionadicional like '%CIN EMB%' COLLATE='Modern_Spanish_CI_AI' ) and codigodelinea in (select CODIGODELINEA from Lineas where CATAUTOPARTES='1')\n</code></pre>\n\n<p>And when app compile, Hibernate return this exception :</p>\n\n<pre><code>- line 1:107: unexpected token: COLLATE\n- line 1:107: unexpected token: COLLATE\n- line 1:107: unexpected token: COLLATE\n- Error hibernate: unexpected token: COLLATE near line 1, column 107\n</code></pre>\n\n<p>I can't find the problem, in mi MSSQL Server it works fine.</p>\n\n<p>Thanks you!</p>\n"},{"tags":["java","regex","hibernate","hql","antlr"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":114,"score":2,"question_id":12986782,"title":"HQL: Dynamically adding JOINS and WHERE parts (ANTLR, regex or String)","body":"<p>I've to write HQL based engine that patch HQL queries on the fly dynamically add joins and where parts (to prevent questions - I must use HQL, not criteria API). </p>\n\n<p>E.g. inject to HQL <code>from Object a</code> something like <code>from Object a JOIN a.path b WHERE b.id='XYZ'</code></p>\n\n<p>I see a several options, but neither work for me:</p>\n\n<ol>\n<li><p>Java <code>String.insert()</code> approach. Find position of WHERE statement and add joins before and other part after the statement. It's not a trivial task for HQL like this</p>\n\n<p>SELECT a, (SELECT b FROM Object2 b WHERE b.path=a) FROM Object a WHERE EXISTS(SELECT 1 FROM ... WHERE)</p></li>\n</ol>\n\n<p>Pending algorithm: I could calculate number of brackets () before each WHERE and if it zero - I found correct WHERE position. Could anybody propose me a simpler algorithm or simple implementation on Java my one?</p>\n\n<p>2.I suspect that my task could be solved via regular expressions, but can't write correct regular expression for <code>String.replace()</code></p>\n\n<p>3.I saw AST/ANTLR based grammar and could parse my HQL, but don't see a way how it could help me (i.e. I've got statement, but not position of correct statement <code>WHERE</code>).</p>\n\n<p>4.Standalone libs exists for SQL parsing, but not for HQL. </p>\n\n<p>Anyway, thanks for any thoughts :)</p>\n"},{"tags":["java","oracle","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13145288,"title":"Overflow when trying to bind double.max_value in Oracle","body":"<p>I am trying to get our Hibernate app running on Oracle 11g, but we keep getting the following error when trying to persist a double.max_value: </p>\n\n<pre><code>Caused by: java.sql.SQLException: Internal Error: Overflow Exception trying to bind 1.7976931348623157E308\nat oracle.jdbc.driver.SQLStateMapping.newSQLException(SQLStateMapping.java:70)\nat oracle.jdbc.driver.DatabaseError.newSQLException(DatabaseError.java:133)\nat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:199)\nat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:263)\nat oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:271)\nat oracle.jdbc.driver.DoubleBinder.bind(OraclePreparedStatement.java:15676)\nat oracle.jdbc.driver.OraclePreparedStatement.setupBindBuffers(OraclePreparedStatement.java:2948)\nat oracle.jdbc.driver.OraclePreparedStatement.processCompletedBindRow(OraclePreparedStatement.java:2202)\nat oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3382)\nat oracle.jdbc.driver.OraclePreparedStatement.executeUpdate(OraclePreparedStatement.java:3468)\nat oracle.jdbc.driver.OraclePreparedStatementWrapper.executeUpdate(OraclePreparedStatementWrapper.java:1350)\nat org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2437)\n... 11 more\n</code></pre>\n\n<p><strong>Does anyone know why we can't persist this value?</strong> </p>\n\n<p>We only have this problem in Oracle -- Postgres and H2 work fine. </p>\n\n<p>We've tried forcing the Oracle datatype to Number and Binary_Double, but with the same result. We are using Hibernate 3 and Oracle 11g, along with the oracle jdbc driver and the OracleSpatial10g dialect. </p>\n\n<p>(I'm a Hibernate and Oracle newbie, so any help is appreciated.)</p>\n\n<p>EDIT: Some helpful comments so far, but I still haven't figured out my issue. Here's some more info:</p>\n\n<ul>\n<li>I found out that I can insert the number straight into the DB using BINARY_DOUBLE. I tried it with sqlfiddle and through my local db using SQLDeveloper. I can also retrieve it in SQLDeveloper.</li>\n<li>My problem is that I can't ever commit the number to my Database... The exception is thrown <em>before</em> anything makes it into the db.</li>\n</ul>\n"},{"tags":["java","hibernate","map","hbmxml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13160145,"title":"Hibernate Map with unknown element type","body":"<p>I'm wondering if it's possible to define a map with unknown (Object) element type.<BR>\nI have an object with the following map defined:</p>\n\n<pre><code>Map&lt;String, Object&gt; attributes = new HashMap&lt;String, Object&gt;();\n</code></pre>\n\n<p>Sometimes an attribute can be a <code>String</code> and sometimes it can be a <code>java.util.Date</code><BR>\nIs there any elegant way to handle such a data object in Hibernate?<BR>\nBTW I'm using HBM XML</p>\n\n<p>Thanks!</p>\n"},{"tags":["spring","hibernate","jpa","transactions","spring-transactions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13155373,"title":"Two JPA EntityManagers within Spring managed transactions?","body":"<p>I'm using Spring's transaction support and JPA (Hibernate) to persist my entities. Everything's working as it should, but I'm stuck when dealing with partial updates within one request:</p>\n\n<p>For every user (HTTP) request I've to write a log entry into a database table, even if an update of the \"main\" business entity fails (for instance because of a validation error). So my first/principal transaction get's rolled back, but the second (writing the log) should commit. This seems to work using the correct propagation level for writing the log entry:</p>\n\n<pre><code>@Repository\n@Transactional(propagation = Propagation.REQUIRES_NEW)\npublic class UserTracker extends ... {\n\n  @PersistenceContext private EntityManager em;\n\n  public void log(...) {\n    // create log entity and persist it\n    ...\n    em.persist(log);\n    em.flush();\n  }\n\n}\n</code></pre>\n\n<p>My problem is, however, that I get the same EntityManager injected in the second transaction as in the first. So flushing the entity manager (either explicitly or implicitly when the second transaction commits) will also flush my dirty business entity from the first transaction.</p>\n\n<p>How can I remedy this? I would like to use a second, clean and fresh EntityManager for the logging part and I know I could open one programmatically, but is there a cleaner/declarative \"Spring-way\" of doing this? </p>\n"},{"tags":["java","hibernate","jpa","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12860781,"title":"Hibernate (JPA) multiple @OneToMany for same model","body":"<p>I have two models.</p>\n\n<pre><code>@Entity\npublic class Student\n{\n    @Id\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    protected long id;\n\n    @?\n    protected Address homeAddress;\n\n    @?\n    protected Address schoolAddress;\n}\n\n@Entity\npublic class Address\n{\n   @Id\n   @GeneratedValue(strategy=GenerationType.AUTO)\n   protected long id;\n\n   @?\n   protected List&lt;Student&gt; students;\n}\n</code></pre>\n\n<p>What JPA/hibernate annotations do I need to put above <code>homeAddress</code>, <code>schoolAddress</code> and <code>students</code> to make the association work?</p>\n\n<p>Of course I've tried many things and nothing worked.\nFor example, setting</p>\n\n<pre><code>    @ManyToOne\n    @JoinColumn (name=\"student_homeAddress_id\", updatable = false, insertable = false)\n    protected Address homeAddress;\n\n    @ManyToOne\n    @JoinColumn (name=\"student_schoolAddress_id\", updatable = false, insertable = false)\n    protected Address schoolAddress;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    @OneToMany(cascade={CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH}, fetch = FetchType.EAGER)\n    @JoinColumns({\n    @JoinColumn(name = \"student_homeAddress_id\", referencedColumnName = \"student_homeAddress_id\"),\n    @JoinColumn(name = \"student_schoolAddress_id\", referencedColumnName = \"student_schoolAddress_id\")})\n    @IndexColumn(name=\"students_index\")\n    protected List&lt;Student&gt; students;\n</code></pre>\n\n<p>yealds <code>Unable to find column with logical name: student_homeAddress_id in org.hibernate.mapping.Table(Address) and its related supertables and secondary tables</code>.\nAlso tried using <code>mappedBy</code> but that takes a single argument (can't do <code>mappedBy=\"student_homeAddress_id, student_schoolAddress_id\"</code>.</p>\n\n<p>Also looked into moving the <code>JoinColumns</code> to the <code>Student</code> tablet but I am not sure what the annotations should look like for OneToMany and ManyToOne  as I have multiple Addresses there which JoinColumns doesn't make much sense.</p>\n\n<p>The thing that did work but was not creating the associations was having:</p>\n\n<pre><code>    @OneToMany(cascade={CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH}, fetch = FetchType.EAGER)\n    @JoinColumn(name=\"address_id\")\n    @IndexColumn(name=\"students_index\")\n    protected List&lt;Student&gt; students;\n</code></pre>\n\n<p>Using this, when storing in the DB the models, the student_homeAddress_id and student_schoolAddress_id were always null even after storing both ends (the Student and Address model).</p>\n\n<p>My thought is that on the <code>Address</code> table there will be 3 extra columns: student_homeAddress_id (the id of the Student in the Student table for the homeAddress), student_schoolAddress_id (the id of the Student in the Student table for the schoolAddress) and students_index (the 0-based location on the <code>students</code> list). That should suffice, correct?</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks a lot!</p>\n"},{"tags":["linux","spring","hibernate","sessionfactory"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13147292,"title":"Spring DataSource with embedded HSQL in memory database and hibernate create-drop ordering on Linux","body":"<p>I am using Spring 3.1 with annotations to create a DataSource that uses embedded HSQL.</p>\n\n<pre><code>@Bean\npublic DataSource dataSource() throws Exception {\n    EmbeddedDatabaseFactoryBean bean = new EmbeddedDatabaseFactoryBean();\n    bean.setDatabaseType(EmbeddedDatabaseType.HSQL);\n    bean.afterPropertiesSet();\n    DataSource object = bean.getObject();\n    return object;\n}\n</code></pre>\n\n<p>I am also configuring a SessionFactory like this</p>\n\n<pre><code>@Bean\npublic SessionFactory sessionFactory() {\n    SessionFactory sessionFactory = new LocalSessionFactoryBuilder(dataSource)\n        .setNamingStrategy(namingStrategy())\n        .addProperties(hibernateProperties)\n        .addAnnotatedClass(Some.class)\n        .buildSessionFactory();\n    logger.info(\"Created session factory: \" + sessionFactory + \" with dataSource: \" + dataSource);\n    return sessionFactory;\n}\n</code></pre>\n\n<p>The problem is if I create some other beans using @Component in which I populate the database, the SQL script fails because the database has not been created. My hibernate.properties includes the following line to generate DDL</p>\n\n<pre><code>properties.put(\"hibernate.hbm2ddl.auto\", \"create-drop\");\n</code></pre>\n\n<p>So it is some sort of ordering issue with bean creating. However this problem only occurs in Linux (Kubuntu 12.04) and not on Windows 7!</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13158710,"title":"Hibernate Projections for Sub Collections within an Entity","body":"<p>Here is a very simplified example of what I am trying to accomplish with Hibernate and projections.  Here are some sample tables:</p>\n\n<pre><code>class User{\n    int id;\n    String firstName;\n    String lastName;\n    List&lt;Address&gt; address ;\n}\n\nclass Address{\n    int id;\n    String city;\n    String state;   \n    User user;\n}\n</code></pre>\n\n<p>This how I perform a regular select of the data.</p>\n\n<pre><code>Criteria crit = getSession().createCriteria(\"User\");\ncrit.add(CriterionUtils.in(\"id\", new Object[]{1,2,3}));   \ncriteria.list();\n</code></pre>\n\n<p>This works and returns the full User object and full Address list.  This will load the complete  User objects with the list of Address objects.</p>\n\n<p>Now I am having trouble understanding how Projections work with Hibernate.  This is my goal.  I have large entities that I have to load but I do not need all the data, I just need a few columns and a sub collection loaded, all the other data I do not need.  Essentially I want to load the same object just with a restricted amount of data.  But, I don't want the firstName and lastName of the User object because I do not need them; I want a \"lighter\" User object that has the full Address list loaded and the id of the User.  Remember my goal is not to load the Address list but the User object that has the Address list</p>\n\n<p>If i try this:</p>\n\n<pre><code>ProjectionList proList = Projections.projectionList();\nproList.add(Projections.property(\"id\"));\ncriteria = criteria.setProjection(proList);      \ncriteria.list(); //an Object[] of just the ids\n</code></pre>\n\n<p>I only get ids and no User objects!</p>\n\n<p>If I try this:</p>\n\n<pre><code>ProjectionList proList = Projections.projectionList();\nproList.add(Projections.property(\"id\"));\nproList.add(Projections.property(\"address\"));\ncriteria = criteria.setProjection(proList);      \ncriteria.list(); //this actually fails with an Array out of bounds exception\n</code></pre>\n\n<p>This just fails!</p>\n\n<p>It seems that Projections only return the exact data you want and not the entity.  I was expecting that the User object to be returned with partially filled fields.</p>\n\n<p>Maybe I am going about this incorrectly?</p>\n"},{"tags":["java","hibernate","properties","column"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13156519,"title":"Many to One in hibernate, get column type","body":"<p>In Hibernate when I got simple Pojo, for example User:</p>\n\n<pre><code>private class User{\n   private String name;\n}\n</code></pre>\n\n<p>When I want to get property of the \"name\", a simply use:</p>\n\n<pre><code>sessionFactory.getClassMetadata(User.class).getPropertyType(\"name\")\n</code></pre>\n\n<p>But when I add a class Grou to my User:</p>\n\n<pre><code>private class User{\n   private String name;\n   private Group group;\n}\n</code></pre>\n\n<p>My previous code :</p>\n\n<pre><code>  sessionFactory.getClassMetadata(User.class).getPropertyType(\"group.name\")\n</code></pre>\n\n<p>doesn't work. \nAny way to solve it?</p>\n"},{"tags":["c#","sql","hibernate","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13144100,"title":"HQL select ID of entity with max value within group","body":"<p>I have this small entity</p>\n\n<pre><code>class Order\n{\n    public long Id;\n    public DateTime Date;\n    public long ProductId;\n}\n</code></pre>\n\n<p>I want to select <code>Id</code> of entity which has <code>MAX(Date)</code> among orders grouped by <code>ProductId</code>.\nPair (<code>MAX(Date)</code>, <code>ProductId</code>) is not unique so this query is wrong:</p>\n\n<pre><code>select o.Id \nfrom Order o \nwhere o.Date = \n   (select max(o2.Date) \n    from Order o2 \n    where o2.ProductId = o.ProductId);\n</code></pre>\n\n<p>Do you have any ideas?</p>\n\n<p>Basically what I want is to get most recent Order from group, so if I assume that greater <code>Id</code> == newer <code>Order</code> this:</p>\n\n<pre><code>select o \nfrom Order o \nwhere o.Id in \n   (select max(o2.Id) \n    from Order o2 \n    group by o2.ProductId);\n</code></pre>\n\n<p>will work for me. Are there any better solutions?</p>\n"},{"tags":["hibernate","postgresql","jpa","h2","liquibase"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13152918,"title":"Incompatible sequence names between Liquibase and Hibernate JPA for PostgreSQL and H2","body":"<p>I have an app running with standard Hibernate JPA and Liquibase for generating the db. I use H2 for testing and PostgreSQL when running.</p>\n\n<p>My problem is I can't seem to get this setup to work nicely for primary keys with sequence generation.</p>\n\n<p>When I have an entity id like this:</p>\n\n<pre><code>@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Long id;\n</code></pre>\n\n<p>and use liquibase to create the database, like this:</p>\n\n<pre><code>&lt;column name=\"id\" type=\"BIGINT\" autoIncrement=\"true\" incrementBy=\"1\"&gt;\n    &lt;constraints nullable=\"false\" primaryKey=\"true\" /&gt;\n&lt;/column&gt;\n</code></pre>\n\n<p>it works fine in H2, but for PostgreSQL Hibernate complains that it is:</p>\n\n<pre><code>\"Missing sequence or table: hibernate_sequence\"\n</code></pre>\n\n<p>I can fix this for PostgreSQL by changing the JPA @GeneratedValue to something like:</p>\n\n<pre><code>@Id\n@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"text_id_seq\")\n@SequenceGenerator(name = \"text_id_seq\", sequenceName = \"text_id_seq\", allocationSize = 1)\nprivate Long id;\n</code></pre>\n\n<p>But now the H2 sequence won't match what Hibernate expects.</p>\n\n<p>There doesn't seem to be any easy way to make sure Liquibase the sequence with a specific name. What can I do to get this setup to work?</p>\n\n<p>I'm looks like I'm currently running </p>\n\n<ul>\n<li>liquibase.version 2.0.4</li>\n<li>hibernate 4.1.7</li>\n<li>postgres driver 9.1-901.jdbc3</li>\n<li>postgres 9.2.1 (at least locally)</li>\n<li>h2 1.3.168</li>\n</ul>\n"},{"tags":["query","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13136729,"title":"How can I get a sorted children without access parent entity[many-to-many] in hibernate","body":"<p>For example, there is a many-to-many association between A and B. And<pre> <strong>A.bs</strong> is sorted List&lt;B> that sorted by an index-column in the middle-table: idx</pre>  So we haven't mapping idx column as Class field. </p>\n\n<p>Now we want to query the list of B individually and the main condition is A's id. But when query B directly, it comes out with an unsorted List (don't order by the idx field). </p>\n\n<p>I know we can retrieve A at first then collect the B into a List. However, considering the framework, we can do like that, it have to return a List without manual coding (don't want to describe too much about the framework. in one word, this limitation is caused by the pagination tool encapsulate by our self, I don't want to modify that.).</p>\n\n<p>Is there any methods to solve this problem via HQL/Criteria. Criteria are preferable.</p>\n"},{"tags":["java","hibernate","inheritance","postgresql-9.1","hibernate-annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13131143,"title":"Java hibernate Joined inheritence (id not found)","body":"<p>Sorry for my English, it's not my native language and it's allready 2 o'clock, so can't think strait now.\nNow i have next problem while using hibernate with Java and PostgreSQL:\nI have entity Human and User as follows (with annotation mappings):</p>\n\n<pre><code>    @Inheritance(strategy = InheritanceType.JOINED)\n    public class Human implements Serializable{\n        private static final long serialVersionUID = 1L;\n        public static enum Gender{\n            Male,\n            Female}\n        @Id\n        @GeneratedValue\n        private Integer id;\n        @Enumerated(EnumType.STRING)\n        private Gender gender;\n        @Column\n        @Temporal(TemporalType.DATE)\n        private Date dateOfBirth;\n        private String firstName;\n        private String middleName;\n        private String lastName;\n        // getters,setters\n    }\n\n    @Entity\n    @PrimaryKeyJoinColumn\n    public class User extends Human{\n        private static final long serialVersionUID= 1L;\n        @Column\n        @Temporal(TemporalType.DATE)\n        private Date registrationDate;\n        private Boolean activationStatus;\n        private String activationCode;\n        private String login;\n        private String password;\n        private String sessionCode;\n        private String email;\n        private String country;\n        private String city;\n        private String avatarURL;\n        private String description;\n        // getters,setters\n    }\n</code></pre>\n\n<p>And database structure as follows:</p>\n\n<pre><code>human\n(\n  dateofbirth date NOT NULL,\n  firstname text NOT NULL,\n  middlename text NOT NULL,\n  lastname text NOT NULL,\n  id serial NOT NULL,\n  gender text,\n  CONSTRAINT \"Human_id\" PRIMARY KEY (id )\n)\n\"user\"\n(\n  login text NOT NULL,\n  password text NOT NULL,\n  activationcode text NOT NULL,\n  activationstatus status NOT NULL,\n  avatarurl text NOT NULL,\n  city text NOT NULL,\n  country text NOT NULL,\n  description text NOT NULL,\n  registrationdate date NOT NULL,\n  email text NOT NULL,\n  id integer,\n  CONSTRAINT uid PRIMARY KEY (id )\n)\n</code></pre>\n\n<p>When I try to run my project (simple unit test) i get next error:</p>\n\n<pre><code>    org.postgresql.util.PSQLException: ERROR: column human0_1_.id does not exist\n      Позиция: 778\n        at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2103)\n        at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1836)\n        at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)\n        at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:512)\n        at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)\n        at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)\n        at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n        at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n        at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n        at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n        at org.hibernate.loader.Loader.loadEntity(Loader.java:1860)\n        at org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:48)\n        at org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:42)\n        at org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3044)\n        at org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:395)\n        at org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:375)\n        at org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:139)\n        at org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:195)\n        at org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:103)\n        at org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:878)\n        at org.hibernate.impl.SessionImpl.get(SessionImpl.java:815)\n        at org.hibernate.impl.SessionImpl.get(SessionImpl.java:808)\n        at org.tempos.server.modules.users.HumanTest.testGetId(HumanTest.java:31)\n...\n</code></pre>\n\n<p>(I cut out tail of log, while it responds on invokin JUnit methods).</p>\n\n<p>Generated query (that fails):</p>\n\n<pre><code>select human0_.id as id3_0_, human0_.dateOfBirth as dateOfBi2_3_0_, human0_.firstName as firstName3_0_, human0_.gender as gender3_0_, human0_.lastName as lastName3_0_, human0_.middleName as middleName3_0_, human0_1_.activationCode as activati1_4_0_, human0_1_.activationStatus as activati2_4_0_, human0_1_.avatarURL as avatarURL4_0_, human0_1_.city as city4_0_, human0_1_.country as country4_0_, human0_1_.description as descript6_4_0_, human0_1_.email as email4_0_, human0_1_.login as login4_0_, human0_1_.password as password4_0_, human0_1_.registrationDate as registr10_4_0_, human0_1_.sessionCode as session11_4_0_, case when human0_1_.id is not null then 1 when human0_.id is not null then 0 end as clazz_0_ from Human human0_ left outer join User human0_1_ on human0_.id=human0_1_.id where human0_.id=?\n</code></pre>\n\n<p>As one can see, it tries to JOIN columns on human1_1_.id (originally User.id), but it isn't specified and obtained in SELECT part of query.</p>\n\n<p>What I was tried:</p>\n\n<ol>\n<li>Creating @Column private Integer id in class User (got Annotation\nparser exception for overriding primary column for class);</li>\n<li>Created @Column private Integer hid in class User and set it as\n    PrimaryKeyJoinColumn (but i got (should be mapped with\n    insert=\"false\" update=\"false\") even if I map it as\n    @JoinColumn(insertable=false,updatable=false,referencedColumnName=\"id\"));</li>\n<li>Created column \"hid\" and pointed it as PrimaryKeyJoinColumn in\n    annotation to column itself, not whole class (got the same error as\n    in original, column \"human0_1_.id not found);</li>\n</ol>\n\n<p>Anyone, give me some ideas please!</p>\n"},{"tags":["hibernate","datatables"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13155480,"title":"Server Side processing for Datatables","body":"<p>I have formed a generic function that will perform search and returns the result as JSON object. The function takes in a search keyword and currently only applicable for String datatype.</p>\n\n<pre><code>public String listAsJsonResponse(String echo, String searchableProperties,\n            int start, int limit, String searchKeyword, String sortProperty,\n            String sortDirection) throws JSONException {\n        Criteria criteria = getSession().createCriteria(getPersistentClass());\n        Integer iTotalRecords = ((Long) criteria.setProjection(\n                Projections.rowCount()).uniqueResult()).intValue();\n        if (sortDirection.equals(\"asc\"))\n            criteria.addOrder(Order.asc(sortProperty));\n        else\n            criteria.addOrder(Order.desc(sortProperty));\n        if (StringUtils.hasText(searchKeyword)) {\n            // only applicable for string\n            String[] someColumns = searchableProperties.split(\",\");\n            for (int i = 0; i &lt; someColumns.length; i++) {\n                criteria.add(Restrictions.like(someColumns[i], \"%\"\n                        + searchKeyword + \"%\"));\n            }\n            // TODO: apply filtering for different datatypes e.g BigDecimal,Long\n        }\n        Integer iFilteredTotalRecords = ((Long) criteria.setProjection(\n                Projections.rowCount()).uniqueResult()).intValue();\n        criteria.setProjection(null);\n        criteria.setResultTransformer(Criteria.ROOT_ENTITY);\n        criteria.setFirstResult(start);\n        criteria.setMaxResults(limit);\n        Gson gson = new Gson();\n        String json = \"##\" + gson.toJson(criteria.list()) + \"##\";\n        JSONObject jsonResponse = new JSONObject();\n        jsonResponse.put(\"sEcho\", echo);\n        jsonResponse.put(\"iTotalRecords\", iTotalRecords);\n        jsonResponse.put(\"iTotalDisplayRecords\", iFilteredTotalRecords);\n        jsonResponse.put(\"aaData\", json);\n        return jsonResponse.toString().replace(\"\\\"##\", \"\").replace(\"##\\\"\", \"\")\n                .replace(\"\\\\\", \"\");\n    }\n</code></pre>\n\n<p>I would like to enable this function to perform search on different datatypes as well such as Number. Do I have to pass in every property data types to the function ? Is there any better way to do this ?</p>\n"},{"tags":["hibernate","jpa","foreign-keys","composite-key","overlapping"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":964,"score":1,"question_id":4231452,"title":"Should Hibernate be able to handle overlapping foreign keys?","body":"<p>I have a table that has two foreign keys to two different tables with both foreign keys <strong>sharing one column</strong>:</p>\n\n<pre><code>CREATE TABLE ZipAreas\n(\n  country_code CHAR(2) NOT NULL,\n  zip_code VARCHAR(10) NOT NULL,\n  state_code VARCHAR(5) NOT NULL,\n  city_name VARCHAR(100) NOT NULL,\n  PRIMARY KEY (country_code, zip_code, state_code, city_name),\n  FOREIGN KEY (country_code, zip_code) REFERENCES Zips (country_code, code),\n  FOREIGN KEY (country_code, state_code, city_name) REFERENCES Cities (country_code, state_code, name)\n)\n</code></pre>\n\n<p>As you can see, there are two FKs sharing country_code (coincidentally referencing the same column at the end of the referentiation path). The entity class looks like (JPA 1.0 @IdClass):</p>\n\n<pre><code>@Entity\n@Table(name = \"ZipAreas\")\n@IdClass(value = ZipAreaId.class)\npublic class ZipArea implements Serializable\n{\n    @Id\n    @Column(name = \"country_code\", insertable = false, updatable = false)\n    private String countryCode;\n\n    @Id\n    @Column(name = \"zip_code\", insertable = false, updatable = false)\n    private String zipCode;\n\n    @Id\n    @Column(name = \"state_code\", insertable = false, updatable = false)\n    private String stateCode;\n\n    @Id\n    @Column(name = \"city_name\", insertable = false, updatable = false)\n    private String cityName;\n\n    @ManyToOne\n    @JoinColumns(value = {@JoinColumn(name = \"country_code\", referencedColumnName = \"country_code\"), @JoinColumn(name = \"zip_code\", referencedColumnName = \"code\")})\n    private Zip zip = null;\n\n    @ManyToOne\n    @JoinColumns(value = {@JoinColumn(name = \"country_code\", referencedColumnName = \"country_code\", insertable = false, updatable = false), @JoinColumn(name = \"state_code\", referencedColumnName = \"state_code\"), @JoinColumn(name = \"city_name\", referencedColumnName = \"name\")})\n    private City city = null;\n\n    ...\n}\n</code></pre>\n\n<p>As you can see I flagged the countryCode property and city's country_code @JoinColumn as read-only (insertable = false, updatable = false). Hibernate fails with this saying:</p>\n\n<pre><code>Exception in thread \"main\" javax.persistence.PersistenceException: [PersistenceUnit: geoinfo] Unable to configure EntityManagerFactory\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:374)\n    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:56)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:48)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:32)\n    at tld.geoinfo.Main.main(Main.java:27)\nCaused by: org.hibernate.AnnotationException: Mixing insertable and non insertable columns in a property is not allowed: tld.geoinfo.model.ZipAreacity\n    at org.hibernate.cfg.Ejb3Column.checkPropertyConsistency(Ejb3Column.java:563)\n    at org.hibernate.cfg.AnnotationBinder.bindManyToOne(AnnotationBinder.java:2703)\n    at org.hibernate.cfg.AnnotationBinder.processElementAnnotations(AnnotationBinder.java:1600)\n    at org.hibernate.cfg.AnnotationBinder.processIdPropertiesIfNotAlready(AnnotationBinder.java:796)\n    at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:707)\n    at org.hibernate.cfg.Configuration$MetadataSourceQueue.processAnnotatedClassesQueue(Configuration.java:3977)\n    at org.hibernate.cfg.Configuration$MetadataSourceQueue.processMetadata(Configuration.java:3931)\n    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1368)\n    at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1345)\n    at org.hibernate.ejb.Ejb3Configuration.buildMappings(Ejb3Configuration.java:1477)\n    at org.hibernate.ejb.EventListenerConfigurator.configure(EventListenerConfigurator.java:193)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:1096)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:278)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:362)\n    ... 4 more\n</code></pre>\n\n<p>This looks pretty basic to me honestly. \"Mixing insertable and non insertable columns in a property is not allowed\" is such a weak \"excuse\", isn't it?</p>\n\n<p>Should Hibernate be able to handle this, e.g. according to the JPA spec? Is this a bug?</p>\n"},{"tags":["hibernate","if-statement","associations","lazy-loading"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13154430,"title":"Hibernate - If clause required","body":"<p>This is regarding hibernate. In the following query, <code>DataAccessControlGroup</code> has an association with a list <code>lstAdhocQuery</code>  which further has an association with a list <code>lstFilterDimensionSet</code> which contains dimension, <code>appliedFilter</code> and <code>originalDimensionSet</code> as shown. The reason I have manually selected these using fetch, is because I used lazy loading. (lazy proxy due to Abstractions)</p>\n\n<p>My question here is, in the query below, for some cases my <code>lstAdhocQuery</code> will be null (ie the table will not have a mapping at all for this).</p>\n\n<p>How do I re-write this query with the condition that if the <code>lstOfAdhocQuery</code> is Null, then dont fetch the rest (IE simply Fire this - <code>from com.nova.accesscontrol.DataAccessControlGroup as dacg where dacg.strDacgId=?</code>)\nElse if <code>lstOfAdhocQuery</code> does exist in the table, then fire the entire query.</p>\n\n<p>Full Query:</p>\n\n<pre><code>from com.nova.accesscontrol.DataAccessControlGroup as dacg inner join fetch dacg.lstAdhocQuery as adhocQueries inner join fetch adhocQueries.lstFilterDimensionSet as listFilters inner join fetch listFilters.dimension inner join fetch listFilters.appliedFilter inner join fetch listFilters.originalDimensionSet where dacg.strDacgId=?\n</code></pre>\n\n<p>Thanks all!</p>\n"},{"tags":["java","sql","hibernate","many-to-many","hql"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":13153592,"title":"Hibernate many-to-many join with condition","body":"<pre><code>+-------+    +--------------|     +-------+\n| BOY   |    | BOY_GIRL     |     | GIRL  | \n+-------+    +--------------|     +-------+\n| id    |    | id           |     | id    |\n| name  |    | boy_id       |     | name  |\n| birth |    | girl_id      |     | birth |\n+-------+    | start_dating |     +-------+\n             +--------------|\n</code></pre>\n\n<p><code>START_DATING</code> is type of <code>TIMESTAMP</code> or <code>DATE</code></p>\n\n<p>I have two beans Boy and Girl with many-to-many relation</p>\n\n<pre><code>@ManyToMany(fetch = FetchType.LAZY)\n@JoinTable(name = \"BOY_GIRL\", joinColumns = {@JoinColumn(name = \"BOY_ID\")}, inverseJoinColumns = {@JoinColumn(name = \"GIRL_ID\")})\npublic Set&lt;Girl&gt; getGirls() {\n    return girls;\n}\n</code></pre>\n\n<p>Now, how can I do select query with HQL, if I want to get the list girls with condition:  </p>\n\n<pre><code>where boy_id = (some_boy_id) and START_DATING &gt; (some_timestamp)\n</code></pre>\n"},{"tags":["sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7585,"score":0,"question_id":6899502,"title":"org.hibernate.exception.SQLGrammarException: could not execute query?","body":"<p>I got this exception when i try to get the list using NamedQuery:</p>\n\n<p><code>org.hibernate.exception.SQLGrammarException: could not execute query</code></p>\n\n<p>Below I mentioned code:</p>\n\n<p><strong>Entity Class  Code:<br></strong></p>\n\n<pre><code>@Table(name = \"tbl_users\")\n@XmlRootElement\n@NamedQueries({@NamedQuery(name = \"TblUsers.findAll\", query = \"SELECT t FROM TblUsers t\")});\n</code></pre>\n\n<p><strong>DAO implement Code:<br></strong></p>\n\n<pre><code>org.hibernate.Query query = session.getNamedQuery(\"TblUsers.findAll\");\nList list = query.list();\n</code></pre>\n\n<p>Please provide solution for this exception.</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13154261,"title":"Sequence generator doesnt work when saveorUpdate or merge","body":"<p>My problem is when saveOrUpdate is not getting the right  sequence number.</p>\n\n<p>Theses are my entities:</p>\n\n<p>Factura.java</p>\n\n<pre><code>//bi-directional many-to-one association to FacturaConcepto\n@OneToMany(mappedBy=\"factura\", cascade={CascadeType.ALL}, fetch=FetchType.LAZY)\n@org.hibernate.annotations.Cascade({org.hibernate.annotations.CascadeType.SAVE_UPDATE})\nprivate List&lt;FacturaConcepto&gt; facturaConceptos;\n</code></pre>\n\n<p>FacturaConcepto.java</p>\n\n<pre><code>@Id\n@SequenceGenerator(name = \"concepto_secuencia\", sequenceName = \"ID_CONCEPTO_SEC\")\n@GeneratedValue(strategy=GenerationType.AUTO, generator = \"concepto_secuencia\") \n@Column(name=\"ID_CONCEPTO\", unique=true, nullable=false, precision=22)\nprivate long idConcepto;\n\n//bi-directional many-to-one association to FacturaConcepto\n@OneToMany(mappedBy=\"factura\", cascade={CascadeType.PERSIST}, fetch=FetchType.LAZY)\n@org.hibernate.annotations.Cascade({org.hibernate.annotations.CascadeType.SAVE_UPDATE})\nprivate List&lt;FacturaConcepto&gt; facturaConceptos;\n\n//bi-directional many-to-one association to FacturaHonorario\n@OneToMany(mappedBy=\"facturaConcepto\", cascade={CascadeType.ALL}, fetch=FetchType.LAZY)\n@org.hibernate.annotations.Cascade({org.hibernate.annotations.CascadeType.SAVE_UPDATE})\nprivate List&lt;FacturaHonorario&gt; facturaHonorarios;\n</code></pre>\n\n<p>FacturaHonorario.java</p>\n\n<pre><code>@Id\n@SequenceGenerator(name = \"honorario_secuencia\", sequenceName = \"ID_HONORARIO_SEQ\")\n@GeneratedValue(strategy=GenerationType.AUTO, generator = \"honorario_secuencia\")\n@Column(name=\"ID_HONORARIO\", unique=true, nullable=false, precision=22)\nprivate long idHonorario;\n\n//bi-directional many-to-one association to FacturaConcepto\n@ManyToOne\n@JoinColumn(name=\"ID_CONCEPTO\", referencedColumnName=\"ID_CONCEPTO\")\nprivate FacturaConcepto facturaConcepto;\n</code></pre>\n\n<p>As you can see, factura has many facturaConcepto, and facturaConcepto has many facturaHonorario.</p>\n\n<p>I have an object factura, with two facturaConcepto and one of these with more than one object facturaHonorario.</p>\n\n<p>In my dao when saveOrUpdate is done The error is \"a different object with the same identifier value was already associated with the session\". Its happen because in the first facturaConcepto object, the first facturaHonorario has as id a sequence number from dual, but the second one as id has '1'. in the second facturaConcepto object happend exactly the same. The first facturaHonorario object has a sequence number from dual as id, but the second one has '1'. So the sequence generator is not working properly.</p>\n\n<p>If I try merge instead of saveOrUpdate it doesnt fail but when save the second facturaHonorario from  the second facturaConcepto smash the second facturaHonorario from the first facturaConcepto.</p>\n\n<p>I suppose all come from entities relationship :s</p>\n\n<p>thanks all!!</p>\n"},{"tags":["java","hibernate","jpa","duplicate-entry"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":34,"score":1,"question_id":13138729,"title":"JPA 2(hibernate) insertion duplicates of child collection while persisting the parent.WHat is the workaround as of today","body":"<p>I believed so many people have experienced this issue stated as title and cleary expressed on <a href=\"https://hibernate.onjira.com/browse/HHH-5855\" rel=\"nofollow\">hibernate jira</a> and on <a href=\"http://stackoverflow.com/questions/7903800/hibernate-inserts-duplicates-into-a-onetomany-collection\">stackOV 1</a> and <a href=\"http://stackoverflow.com/questions/12902827/jpa-merge-results-in-duplicate-entry-of-foreign-entity\">stackOV 2</a> . i use <code>hibernate 4.0.1.Final</code> and <code>spring-data-jpa 1.1.0.M1</code> . the concerbed POJOs are actully  ID Generated so i would like to find out whether specific implementation of <code>equals</code> and <code>hashcode</code> can help solve the problem or i would have to find another way of generating the IDs</p>\n\n<p>thanks for reading this.</p>\n"},{"tags":["performance","hibernate","jpa","openjpa","timesten"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13152822,"title":"performance issue in find() method after migration to Hibernate 4.0 from OpenJPA 1.2","body":"<p>I migrate from OpenJPA 1.2 to Hiberante 4.0<br>\nI'm using TimesTen DB  </p>\n\n<p>I'm doing a native query to get id's of object's that I need , and then perform find on each on of them.\nIn <code>OpenJPA</code> instead of find I used <code>findCache()</code> method and if it return null I use the <code>find()</code> method , In hibernate I used only the <code>find()</code> method.</p>\n\n<p>I performed this operation on the same DB.</p>\n\n<p>after running couple of test I saw that the performance of OpenJPA is far better.</p>\n\n<p>I printed the statistics of hibernate session ( after querying and finding the same object's) and saw that the <code>hit\\miss</code> count to the first level cache is always 0.\nwhile the OpenJPA is clearly reaching it's cache by fetching object's with the <code>findCache</code> method.</p>\n\n<p>How can I improve the performance of find in Hibernate ?\nI suspect it referred to the difference in the first level cache implementation of this tools.</p>\n\n<p>another fact: I use the same EntityManager for the application run time ( I need to minimize the cost of creating of an EntityManager - my app is soft real time )</p>\n\n<p>thanks.</p>\n"},{"tags":["java","hibernate","jsp","servlets","struts2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13152271,"title":"Code working in Localhost but it dosent work in online website in java using hibernate","body":"<p>I had made one web application in Java using frameworks -struts 2.0, hibernate 3.0, and tiles 2.0 . \nand in my local system i am using JDK 1.6, apache- tomcat 6.0 and my SQL 5.5\nwhen i registering the user it works OK in my local system on my local-host.\nBut when i registering on <a href=\"http://www.shreerajinvestment.com/Home/registration.jsp\" rel=\"nofollow\">http://www.shreerajinvestment.com/Home/registration.jsp</a> its not working properly.</p>\n\n<p>what i have to do...?</p>\n\n<p><strong>In Online redirected on error action. But in local-host redirected on success action recored added successfully and registered.</strong> </p>\n\n<p><strong>struts code</strong></p>\n\n<pre><code>&lt;action name=\"registration\" class=\"Registration\" &gt;\n\n    &lt;result name=\"input\" &gt;/registration.jsp&lt;/result&gt;\n    &lt;result name=\"error\" &gt;/error.jsp&lt;/result&gt;\n    &lt;result name=\"success\" type=\"tiles\" &gt;home&lt;/result&gt;\n&lt;/action&gt;\n</code></pre>\n\n<p>This is <strong>hibernateConfiguration.xml</strong> file</p>\n\n<pre><code> &lt;hibernate-configuration&gt;\n&lt;session-factory&gt;\n\n    &lt;property name=\"connection.useUnicode\" &gt;true&lt;/property&gt;\n    &lt;property name=\"connection.characterEncoding\" &gt;UTF-8&lt;/property&gt;\n    &lt;property name=\"connection.driver_class\" &gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"connection.url\" &gt;jdbc:mysql://localhost:3306/databasename&lt;/property&gt; \n    &lt;property name=\"connection.username\" &gt;root&lt;/property&gt;\n    &lt;property name=\"connection.password\" &gt;admin&lt;/property&gt;\n    &lt;property name=\"dialect\" &gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"current_session_context_class\" &gt;thread&lt;/property&gt;\n    &lt;property name=\"hibernate.transaction.factory_class\" &gt;org.hibernate.transaction.JDBCTransactionFactory&lt;/property&gt;\n\n    &lt;mapping resource=\"pojo/registrationpojo.hbm.xml\" /&gt;\n    &lt;mapping resource=\"pojo/lifepojo.hbm.xml\" /&gt;\n    &lt;mapping resource=\"pojo/gipojo.hbm.xml\" /&gt;\n    &lt;mapping resource=\"pojo/mfpojo.hbm.xml\" /&gt;\n    &lt;mapping resource=\"pojo/cdpojo.hbm.xml\" /&gt;\n    &lt;mapping resource=\"pojo/fdpojo.hbm.xml\" /&gt;\n\n&lt;/session-factory&gt;\n</code></pre>\n\n<p></p>\n\n<p>This is <strong>registration.java</strong> file</p>\n\n<pre><code>package SRI.User;\n\nimport java.util.Date;\nimport java.util.List;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\nimport org.apache.struts2.interceptor.ServletRequestAware;\nimport org.hibernate.Session;\nimport org.hibernate.Transaction;\nimport pojo.RegistrationPojo;\nimport admin.Common;\nimport admin.HibernateUtils;\nimport com.opensymphony.xwork2.ActionSupport;\n\npublic class Registration extends ActionSupport implements ServletRequestAware\n{\nprivate static final long serialVersionUID = 1L;\nprivate HttpServletRequest myrequest = null;\npublic List&lt;Registration&gt; regpojo = null;\n\npublic HttpServletRequest getMyrequest() {\n    return myrequest;\n}\npublic void setMyrequest(HttpServletRequest myrequest) {\n    this.myrequest = myrequest;\n}\npublic List&lt;Registration&gt; getRegpojo() {\n    return regpojo;\n}\npublic void setRegpojo(List&lt;Registration&gt; regpojo) {\n    this.regpojo = regpojo;\n}\n\npublic String getFirst_name() {\n    return first_name;\n}\npublic void setFirst_name(String firstName) {\n    first_name = firstName;\n}\npublic Date getDob() {\n    return dob;\n}\npublic void setDob(Date dob) {\n    this.dob = dob;\n}\n    //other fields getter - seter\n\nprivate String first_name = null;\nprivate Date dob = null;\n    //other fields\n\nprivate int flag;\nprivate String re = null;\nprivate Common mCommon = new Common(); \n\n@SuppressWarnings(\"unchecked\")\npublic String execute() throws Exception\n{\n    try\n    {\n        Session session = HibernateUtils.getSession();\n        Transaction tx = session.beginTransaction();\n\n        regpojo = session.createQuery(\"select m.uname from RegistrationPojo m\").list();\n\n        if(regpojo.size() == 0)\n        {\n            //code to add record in the table\n            RegistrationPojo p1=new RegistrationPojo();\n            p1.setFirst_name(getFirst_name());\n            p1.setDob(mCommon.ChangeDateformat(getDob()));\n            //set other fields \n            session.save(p1);\n            tx.commit();\n\n            System.out.println(\"Registration Successfully\");\n            re=SUCCESS;\n        }\n        else\n        {\n            for(int i=0; i&lt;regpojo.size(); i++)\n            {\n                if(username.equals(regpojo.get(i)))\n                {\n                    flag = 1;\n                    break;\n                }\n                else\n                {\n                    flag = 0;\n                }\n            }\n            if(flag == 0)\n            {\n\n                    //code to add record in the table\n                    RegistrationPojo p1=new RegistrationPojo();\n                    p1.setFirst_name(getFirst_name());\n                    p1.setDob(mCommon.ChangeDateformat(getDob()));\n                    //set other fields \n                    session.save(p1);\n                    tx.commit();                \n\n                                    System.out.println(\"Registration Successfully\");\n                re=SUCCESS;\n            }\n            else\n            {\n                System.out.println(\"ERROR\");\n                addFieldError(\"un\", \"User Name is not Available\");\n                re=INPUT;   \n            }\n        }\n        HttpSession s=myrequest.getSession(true);\n        s.setAttribute(\"uname\",username);\n        s.setAttribute(\"pwd\",password);\n\n    }\n    catch(Exception ex)\n    {\n        re = ERROR;\n        System.out.println(\"Connection Failed: \"+ex);\n        ex.printStackTrace();\n    }\n    return re;\n}\n\npublic void setServletRequest(HttpServletRequest request) \n{\n    this.myrequest=request;\n}\n}\n</code></pre>\n"},{"tags":["hibernate","transactions","jms","jta"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13149583,"title":"Two Phase commit + JTA + JMS + Hibernate","body":"<p>I have a requirement where the messages are put into the queue and then a method call is made to update the DB which is \ndone through Hibernate. I want to make this as part of a single transaction, so that if the update call in the db fails\nthe JMS roll back and do not put message in the queue. \nI tried configuring it but looks like i am missing something.\nAny help will be appreciated.</p>\n\n<p>and method where i am calling JMS and DAO is </p>\n\n<pre><code>@Transactional(rollbackFor = Exception.class)               \npublic boolean retrieveBatchOrders(BatchPullCriteria batchPullCriteria) throws SQLException, IOException{\n\n    List&lt;IntrmStrg&gt; IntrmStrgOrderLst  = iStorageDAO.retrieveByStoreId(batchPullCriteria);\n    List&lt;IntrmStrg&gt; IntrmStrgFinalLst  = iStorageDAO.retrieveOrdersByStoreIdLst(batchPullCriteria,IntrmStrgOrderLst);\n    sendMsgToQueue.sendMessageToTarget(IntrmStrgFinalLst);\n\n    iStorageDAO.updateOrdersStatus(IntrmStrgFinalLst,batchPullCriteria.getRetrievedBy(),BATCHRTRVD);\n    return true;\n}\n\n@Transactional\n\npublic void updateOrdersStatus(List&lt;IntrmStrg&gt; IntrmStrgLst , String retrivedBy, String status ){\n        Date retriveDate = new Date();\n        Timestamp retriveDTimestamp = new Timestamp(retriveDate.getTime());\n    try{\n        for (Iterator&lt;IntrmStrg&gt; iterator = IntrmStrgLst.iterator(); iterator.hasNext();) {\n            IntrmStrg intrmStrg = (IntrmStrg) iterator.next();\n            intrmStrg.setRtrvdBy(retrivedBy);\n            intrmStrg.setRtrvdDt(retriveDTimestamp);\n            intrmStrg.setStts(status);\n            LOGGER.info(\"Updating Order Status with ID\" + intrmStrg.getIntrmStrgId());\n            getHibernateTemplate().getSessionFactory().getCurrentSession().beginTransaction();\n            getHibernateTemplate().update(intrmStrg);\n            LOGGER.info(\"Updated Order Status with ID\" + intrmStrg.getIntrmStrgId());\n            getHibernateTemplate().getSessionFactory().getCurrentSession().getTransaction().commit();\n        }\n    }\n    catch(HibernateException he)\n    {\n        getHibernateTemplate().getSessionFactory().getCurrentSession().getTransaction().rollback();\n    }\n\n\n    if (LOGGER.isDebugEnabled()) {\n        LOGGER.info(\"Order Status Updated\");    \n    }\n\n}\n</code></pre>\n\n<p>application.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:p=\"http://www.springframework.org/schema/p\"\n    xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd\n       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd\"&gt;\n\n\n   &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n\n   &lt;bean id=\"txManager\" class=\"org.springframework.transaction.jta.JtaTransactionManager\"&gt;\n\n\n   &lt;/bean&gt;\n\n\n\n\n\n    &lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"&gt;\n        &lt;property name=\"driverClassName\" value=\"oracle.jdbc.OracleDriver\" /&gt;\n        &lt;property name=\"url\"\n            value=\"\" /&gt;\n        &lt;property name=\"username\" value=\"\" /&gt;\n        &lt;property name=\"password\" value=\"\" /&gt;\n    &lt;/bean&gt;\n\n\n    &lt;bean id=\"iStorageSessionFactory\"\n        class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\"&gt;\n            &lt;ref local=\"dataSource\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"mappingDirectoryLocations\"&gt;\n            &lt;list&gt;\n                &lt;value&gt;classpath:org/entity&lt;/value&gt;\n            &lt;/list&gt;\n\n        &lt;/property&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.Oracle10gDialect&lt;/prop&gt;\n                &lt;prop key=\"hibernate.default_schema\"&gt;DEV1&lt;/prop&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n            &lt;/props&gt;\n        &lt;/property&gt;\n\n    &lt;/bean&gt;\n\n\n    &lt;bean id=\"transactionManager\"\n        class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"\n        lazy-init=\"true\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;/bean&gt;\n\n        &lt;!-- -DAO Beans --&gt;\n\n    &lt;bean id=\"storageDAO\" class=\"org.kp.oppr.iStorage.dao.IStorageDAOImpl\" &gt;\n    &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref local=\"iStorageSessionFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;!--  Service Beans  --&gt;\n    &lt;bean id=\"iStorageService\" class=\"org.kp.oppr.iStorage.services.IStorageServiceImpl\" &gt;\n    &lt;/bean&gt;\n\n\n        &lt;!-- BROKER CONNECTION SETTING FOR TARXHB00 --&gt;\n    &lt;bean id=\"jmsFactory\" class=\"com.ibm.mq.jms.MQQueueConnectionFactory\"&gt;\n        &lt;property name=\"hostName\" value=\"${mq.conn.hostName}\" /&gt;\n        &lt;property name=\"port\" value=\"${mq.conn.hostPort}\" /&gt;\n        &lt;property name=\"queueManager\" value=\"${mq.conn.queueManager}\" /&gt;\n        &lt;property name=\"channel\" value=\"${mq.conn.channel}\" /&gt;\n        &lt;property name=\"transportType\" value=\"${mq.conn.transportType}\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"jmsFactorySecurity\"\n        class=\"org.springframework.jms.connection.UserCredentialsConnectionFactoryAdapter\"&gt;\n        &lt;property name=\"targetConnectionFactory\" ref=\"jmsFactory\" /&gt;\n        &lt;property name=\"username\" value=\" \" /&gt;\n        &lt;property name=\"password\" value=\" \" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"jmsQueueSender\" class=\"org.kp.oppr.storage.jms.JmsQueueSender\"&gt;\n        &lt;property name=\"connectionFactory\" ref=\"jmsFactorySecurity\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n\n    &lt;bean id=\"SendMsgToQueue\" class=\"org.kp.oppr.storage.jms.SendMsgToQueue\"&gt;\n    &lt;property name=\"queueNamePrfix\" value=\"${QUEUE_PREFIX}\"&gt;&lt;/property&gt;\n    &lt;property name=\"queueNameSufix\" value=\"${QUEUE_SUFFIX}\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"iStorageConfig\" class=\"org.kp.oppr.storage.config.storageConfig\"&gt;\n        &lt;property name=\"maxNumberofOrders\" value=\"${MAX_ORDER_COUNT}\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n\n\n\n&lt;/beans&gt;\n</code></pre>\n"},{"tags":["java","spring","hibernate","maven","production-environment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13146643,"title":"Production-ready configurations for Spring + Hibernate?","body":"<p>The Hibernate connection provider works for development and simple testing purposes, but should be explicitly set to a more robust provider, like c3p0, before moving the project to a production environment.</p>\n\n<p>What other configurations or dependencies should typically be changed, added, or at least checked for production-readiness, in any of the Hibernate, Maven, or Spring xml config files (hibernate.cfg.xml, applicationContext.xml, pom.xml, etc.)?</p>\n"},{"tags":["hibernate","jpa-2.0","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":83,"score":2,"question_id":12736622,"title":"MappingException: Could not determine type; Using @Embeddable and @Embedded","body":"<p>I am attempting to move a framework from hibernate3 to 4, this code worked in 3.  The framework uses Interfaces to break the tight coupling of classes.  Hence:</p>\n\n<p>The Entity class is marked with @Entity and this instance uses and an instance of and @Embeddable defined as its interface, a very familiar pattern in Spring.</p>\n\n<p>The code works fine in older versions of hibernate (V3), I am moving it to JPA2 and Hibernate 4</p>\n\n<p>I realize that Hibernate would have a difficult time figuring out which implementation (concrete class) of the interface was being being mapped.  Hence I understand the error, however, it does work on older versions. </p>\n\n<p>Is this due to hibernate templates and mapping classes in older versions that are abstracted away in JPA2 &amp; H4.</p>\n\n<p>Is the best approach to simply create concrete implementations of all the interface implementing classes and define the @embedded as a concrete class.</p>\n\n<p>Thanks much in advance.</p>\n\n<p>// the Entity class HibAttribute</p>\n\n<pre><code>@Entity\n@Inheritance(strategy=InheritanceType.SINGLE_TABLE)\n// Define a unique constraint on item, namespace, and localname\n@Table(name=\"attribute\", uniqueConstraints = {\n        @UniqueConstraint(columnNames={\"itemid\", \"namespace\", \"localname\"})})\n// Define indexes on discriminator and key fields\n@org.hibernate.annotations.Table(\n        appliesTo=\"attribute\", \n        indexes={@Index(name=\"idx_attrtype\", columnNames={\"attributetype\"}),\n                 @Index(name=\"idx_attrname\", columnNames={\"localname\"}),\n                 @Index(name=\"idx_attrns\", columnNames={\"namespace\"})})\n@DiscriminatorColumn(\n        name=\"attributetype\",\n        discriminatorType=DiscriminatorType.STRING,\n        length=16)\n@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\n\npublic abstract class HibAttribute extends HibAuditableObject implements java.io.Serializable, Attribute {\n\n    // Fields\n\n    @Embedded\n    @AttributeOverrides( {\n            @AttributeOverride(name=\"namespace\", column = @Column(name=\"namespace\", nullable = false, length=255) ),\n            @AttributeOverride(name=\"localName\", column = @Column(name=\"localname\", nullable = false, length=255) )\n    } )\n    private QName qname;\n\n\n//  The interface public interface QName {\n\n    /**\n     * Get local name\n     * @return local name\n     */\n    public String getLocalName();\n\n    /**\n     * Set local name\n     * @param localName local name\n     */\n    public void setLocalName(String localName);\n\n    /**\n     * Get namespace\n     * @return namespace\n     */\n    public String getNamespace();\n\n    /**\n     * Set namespace\n     * @param namespace namespace\n     */\n    public void setNamespace(String namespace);\n\n    /**\n     * Create copy of QName object.\n     * @return copy of current QName object\n     */\n    public QName copy();\n\n}\n\n@Embeddable\npublic class HibQName implements QName {\n\n    public static final String DEFAULT_NAMESPACE = \"org.osaf.cosmo.default\";\n\n    private String namespace = null;\n    private String localName = null;\n\n    public HibQName() {}\n\n    /**\n     * Create new QName with specified namespace and local name.\n     * @param namespace namespace\n     * @param localName local name\n     */\n    public HibQName(String namespace, String localName) {\n        this.namespace = namespace;\n        this.localName = localName;\n    }\n</code></pre>\n\n<p>// rest of class has been omitted ....... it is not needed to understand this issue.</p>\n\n<p>The Stack trace:\nCaused by: org.hibernate.MappingException: Could not determine type for: org.timbre.model.QName, at table: attribute, for columns: [org.hibernate.mapping.Column(attributes_KEY)]\n    at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:304)\n    at org.hibernate.mapping.SimpleValue.isValid(SimpleValue.java:288)\n    at org.hibernate.mapping.IndexedCollection.validate(IndexedCollection.java:90)\n    at org.hibernate.cfg.Configuration.validate(Configuration.java:1294)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1732)\n    at org.hibernate.ejb.EntityManagerFactoryImpl.(EntityManagerFactoryImpl.java:88)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:904)\n    ... 57 more</p>\n"},{"tags":["hibernate","spring","tomcat","spring-mvc","apache-commons-dbcp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2184,"score":0,"question_id":7773719,"title":"Hibernate Exception: Connection Pool exhausted error after Spring upgrade","body":"<p>I am using Spring + Hibernate + Dbcp + Tomcat in my application. For some reason after a recent spring upgrade to version 3.0.6 the application has started to throw the following exception.</p>\n\n<pre><code>    org.springframework.transaction.CannotCreateTransactionException: Could not open Hibernate Session for transaction; nested exception is org.hibernate.exception.GenericJDBCException: Cannot open connection\nat org.springframework.orm.hibernate3.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:596)\nat org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)\nat org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:335)\nat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:105)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\nat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\nat $Proxy7.findURLByPattern(Unknown Source)\nat com.xxx.security.DAOBasedFilterInvocationDefinitionMap.lookupAttributes(DAOBasedFilterInvocationDefinitionMap.java:80)\nat org.acegisecurity.intercept.web.AbstractFilterInvocationDefinitionSource.getAttributes(AbstractFilterInvocationDefinitionSource.java:39)\nat org.acegisecurity.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:236)\nat org.acegisecurity.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:104)\nat org.acegisecurity.intercept.web.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:72)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.ntlm.HttpFilter.doFilter(HttpFilter.java:51)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:110)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.logout.LogoutFilter.doFilter(LogoutFilter.java:106)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:286)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.util.FilterChainProxy.doFilter(FilterChainProxy.java:149)\nat org.acegisecurity.util.FilterToBeanProxy.doFilter(FilterToBeanProxy.java:98)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\nat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:874)\nat org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\nat org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\nat org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\nat org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\nat java.lang.Thread.run(Thread.java:619)\n    Caused by: org.hibernate.exception.GenericJDBCException: Cannot open connection\nat org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:103)\nat org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:91)\nat org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\nat org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:29)\nat org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:420)\nat org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:144)\nat org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:119)\nat org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:57)\nat org.springframework.orm.hibernate3.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:551)\n... 36 more\n    Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool exhausted, cause: Timeout waiting for idle object\nat org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:148)\nat org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:518)\nat org.springframework.orm.hibernate3.LocalDataSourceConnectionProvider.getConnection(LocalDataSourceConnectionProvider.java:81)\nat org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:417)\n... 40 more\n    Caused by: java.util.NoSuchElementException: Timeout waiting for idle object\nat org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:801)\nat org.apache.commons.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:119)\nat org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:140)\n... 43 more\n</code></pre>\n\n<p>My configuration is as follows </p>\n\n<pre><code>&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${db.driverClassName}\" /&gt;\n    &lt;property name=\"url\" value=\"${db.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${db.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${db.password}\" /&gt;\n    &lt;property name=\"maxActive\" value=\"10\" /&gt;\n    &lt;property name=\"maxIdle\" value=\"6\" /&gt;\n    &lt;property name=\"maxWait\" value=\"120\" /&gt;\n    &lt;property name=\"defaultAutoCommit\" value=\"true\" /&gt;\n    &lt;property name=\"removeAbandoned\" value=\"true\" /&gt;\n    &lt;property name=\"removeAbandonedTimeout\" value=\"60\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\"&gt;\n        &lt;ref bean=\"dataSource\" /&gt;\n    &lt;/property&gt;\n\n    &lt;property name=\"configLocations\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;classpath:com/xxx/model/hibernate/hibernate-gas.cfg.xml&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt; org.hibernate.dialect.SQLServerDialect &lt;/prop&gt;\n            &lt;prop key=\"hibernate.jdbc.fetch_size\"&gt;10&lt;/prop&gt;\n            &lt;prop key=\"hibernate.jdbc.batch_size\"&gt;50&lt;/prop&gt;\n            &lt;prop key=\"hibernate.generate_statistics\"&gt;true&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"hibernateTemplate\" class=\"org.springframework.orm.hibernate3.HibernateTemplate\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;\n        &lt;ref bean=\"sessionFactory\" /&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n\n&lt;bean id=\"myTransactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;\n        &lt;ref local=\"sessionFactory\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"nestedTransactionAllowed\" value=\"true\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"propagationRequired\" abstract=\"true\" class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\"&gt;\n        &lt;ref bean=\"myTransactionManager\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"transactionAttributes\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"select*\"&gt;\n                PROPAGATION_REQUIRED,readOnly, timeout_300\n            &lt;/prop&gt;\n            &lt;prop key=\"search*\"&gt;\n                PROPAGATION_REQUIRED,readOnly, timeout_300\n            &lt;/prop&gt;\n            &lt;prop key=\"*\"&gt;\n                PROPAGATION_REQUIRED, timeout_300,\n                -Exception\n            &lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"propagationRequiresNew\" abstract=\"true\" class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\"&gt;\n        &lt;ref bean=\"transactionManager\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"transactionAttributes\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"*\"&gt;\n                PROPAGATION_REQUIRES_NEW, timeout_300,\n                -Exception\n            &lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n"},{"tags":["java","sql","hibernate","postgresql","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13115798,"title":"SQLGrammarException on Heroku after local database change","body":"<p>I created a Java webapp that uses Hibernate and PostgreSQL. It is based on Heroku's Java MVC tutorial (<a href=\"https://devcenter.heroku.com/articles/spring-mvc-hibernate\" rel=\"nofollow\">https://devcenter.heroku.com/articles/spring-mvc-hibernate</a>). I made some minor database changes and correctly update all hibernate annotation. Everything works fine locally, but after pushing to Heroku, I now get this error: </p>\n\n<pre><code>org.hibernate.exception.SQLGrammarException: could not execute query\n</code></pre>\n\n<p>...</p>\n\n<pre><code>Caused by: org.postgresql.util.PSQLException: ERROR: relation \"MY_TABLE\" does not exist\n</code></pre>\n\n<p>So it seems the database changes which exist on my local machine are not reflected up in the heroku cloud. How can I get Heroku to \"reset\" or \"rebuild\" my database?</p>\n\n<p><strong>Update</strong> - I ran <code>heroku pg:reset</code> and it threw an \"Internal server error\" telling me to \"Run 'heroku status' to check for known platform issues\", however running that gave no info. I then checked the site and it was working again (no data of course, but that was expected). Not sure what really happened, but that fixed the problem. Of course, it helps that i was ok with losing all my data.</p>\n"},{"tags":["hibernate","jpa","polymorphism"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13148166,"title":"How can I get hibernate to persist a one-to-many sub-subclass of a MappedSuperclass without altering the parent classes?","body":"<p>I have an abstract <code>@MappedSuperclass</code>, <code>Vehicle</code>, and a concrete implementation <code>Car</code>.</p>\n\n<pre><code>@MappedSuperclass\npublic abstract class Vehicle { ... }\n\n@Entity\n@Table(schema = \"Dealer\", name = \"Cars\")\npublic class Car {\n    ...\n    // you can have any color you like, as long as it's black...\n    private final String color = \"Black\";  \n\n    public String getColor() { return \"Black\"; }\n}\n</code></pre>\n\n<p>However, those implementations are not under my control so I can not change <code>Vehicle</code> or <code>Car</code>, and I can not change the database either.  Assume that there's a read-only list of <code>Car</code> in the dealer's schema to which I have access.  Of course, there are many other methods in <code>Car</code> too, as well as other <code>Vehicles</code>, <code>Bike</code>, <code>Skateboard</code>, etc.</p>\n\n<p>I run a paint shop, so I provide <code>PaintedCar</code>, which overrides <code>getColor()</code>.  In all other ways, this class is identical to <code>Car</code>:</p>\n\n<pre><code>public class PaintedCar extends Car {\n    ...\n    private String customColor;\n\n    @Override\n    public String getColor() { return customColor; }\n\n}\n</code></pre>\n\n<p>The same <code>Car</code> can be painted multiple times, or different instances of <code>Car</code> can be painted differently by different owners, so there's a possibility for one <code>Car</code> to many <code>PaintedCar</code>s.</p>\n\n<p>Theoretically, I should be able to store all the information I need to represent a <code>PaintedCar</code> in a table with fields:</p>\n\n<pre><code>int paintedCarId;\nint carId;  /* FK to Car */\nvarchar color; \n</code></pre>\n\n<p>Note that <code>PaintedCar</code> must be an instance of <code>Car</code>, not just an implementation of <code>Vehicle</code>.  However, I can't quite figure out how to get Hibernate to persist this relationship.  What's the trick?</p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13145045,"title":"JPA / Hibernate removing \"child\" entities","body":"<p>I have two entity classes <em>A</em> and <em>B</em> that exist in a bidirectional one-to-many relationship respectively.</p>\n\n<p><strong>A.java:</strong></p>\n\n<pre><code>@OneToMany(cascade = CascadeType.ALL, mappedBy = \"aId\",\n           fetch=FetchType.EAGER, orphanRemoval=true)\nprivate Set&lt;B&gt; bCollection = new LinkedHashSet&lt;B&gt;();\n</code></pre>\n\n<p><strong>B.java</strong></p>\n\n<pre><code>  @JoinColumn(name = \"A_ID\", referencedColumnName = \"ID\", nullable=false)\n  @ManyToOne(optional = false)   \n  private A aId;\n</code></pre>\n\n<p>In a simple console application I obtain a specific <em>A</em> row from the database and try to delete one of its detail <em>B</em> rows (at random) but <strong>JPA/Hibernate</strong> not only does remove the row - it doesn't even issue any <strong>DELETE</strong> statements towards the database. The only way to remove the <em>B</em> row is by removing the corresponding entity from the collection (<strong>LinkedHashSet</strong>) of <strong>A.java</strong>. So, while I have a workaround, I would like to understand why the below code fails, and fails quietly too!</p>\n\n<pre><code>public static void main(String[] args) {\n    EntityManagerFactory entityManagerFactory =  Persistence.createEntityManagerFactory(\"testjpa\");\n    EntityManager em = entityManagerFactory.createEntityManager();\n    EntityTransaction entityTransaction = em.getTransaction();\n    entityTransaction.begin();\n    A a = em.find(A.class, 1);\n    B b = getARandomChildOfA(a);\n    em.remove(em.merge(b));     // simple em.remove(b) doesn't work either\n    entityTransaction.commit();\n    em.close();\n    entityManagerFactory.close();\n}\n</code></pre>\n"},{"tags":["java","mysql","sql","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":90,"score":-1,"question_id":13147791,"title":"Is it possible to soft code sql statements?","body":"<p>I was told that it is possible to soft code SQL queries instead of hard coding them. Just like we parse JSON responses in Java, we can do that through an external file like below:</p>\n\n<pre><code>abc:[\n{\nsql:\"selecct count(*) from some_database\",\ncount:\"100\"\n}]\n</code></pre>\n\n<p>Is it possible? How I can do that? Links or articles would be appreciated. I am using <strong>Hibernate</strong>. How can I run a SQL query through external file in Hibernate?</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13146544,"title":"Hibernate equivalent for TIMESTAMP query","body":"<p>Just out of curiosity, what is the best way to accomplish this using hibernate</p>\n\n<pre><code>   select * \n   from USERS \n   where TO_CHAR(CREATE_TIMESTAMP, 'YYYY-MM-DD HH24:MI:SS.FF') = '1972-   07-31 13:52:50.381000'\n</code></pre>\n"},{"tags":["spring","hibernate","maven","hbm2ddl","hibernate3-maven-plugin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13130397,"title":"NullPointerException when switching from hibernate-maven-plugin version 2.2 to version 3.0","body":"<p>I am updating the versions of my pom.xml dependencies and I've run into a vague error when I change the version of the hibernate3-maven-plugin from</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;!-- Run \"mvn hibernate3:hbm2ddl\" to generate schema --&gt;\n    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;!-- Run \"mvn hibernate3:hbm2ddl\" to generate schema --&gt;\n    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.0&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p>With version 2.2, everything compiles successfully, and</p>\n\n<pre><code>mvn hibernate3:hbm2ddl\n</code></pre>\n\n<p>creates the correct schema from annotated classes.</p>\n\n<p>Changing nothing else but the version results in the following error when I run the hbm2ddl command again:</p>\n\n<pre><code>[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project myProject: There was an error creating the AntRun task. NullPointerException -&gt; [Help 1]\n</code></pre>\n\n<p>The full stack trace is as follows:</p>\n\n<pre><code>[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project myProject: There was an error creating the AntRun task. NullPointerException -&gt; [Help 1]\norg.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project myProject: There was an error creating the AntRun task.\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)\n    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)\n    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)\n    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)\n    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)\n    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)\nCaused by: org.apache.maven.plugin.MojoExecutionException: There was an error creating the AntRun task.\n    at org.codehaus.mojo.hibernate3.AbstractHibernateMojo.execute(AbstractHibernateMojo.java:84)\n    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)\n    ... 19 more\nCaused by: java.lang.NullPointerException\n    at org.codehaus.plexus.configuration.DefaultPlexusConfiguration.add(DefaultPlexusConfiguration.java:174)\n    at org.codehaus.plexus.configuration.DefaultPlexusConfiguration.addChild(DefaultPlexusConfiguration.java:150)\n    at org.codehaus.mojo.hibernate3.util.PlexusConfigurationUtils.setHibernateConfiguration(PlexusConfigurationUtils.java:289)\n    at org.codehaus.mojo.hibernate3.util.PlexusConfigurationUtils.parseHibernateTool(PlexusConfigurationUtils.java:67)\n    at org.codehaus.mojo.hibernate3.AbstractHibernateToolMojo.getConfiguration(AbstractHibernateToolMojo.java:60)\n    at org.codehaus.mojo.hibernate3.AbstractHibernateMojo.execute(AbstractHibernateMojo.java:76)\n    ... 21 more\n</code></pre>\n\n<p>If I go back to version 2.2, everything works fine. And because I am not looking to upgrade for any particular reason other than simply having the most up-to-date dependencies, I'll stick with 2.2 for the time being.</p>\n\n<p>Hopefully someone can shed some light on this!</p>\n"},{"tags":["spring","hibernate","readonly","interceptor","flush"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13142765,"title":"Why hibernate flushes on select queries (EmptyInterceptor)?","body":"<p>I would like to understand a counter intuitive Hibernate behaviour I am seeing. I always thought that \"flush\" meant that hibernate had a data structure in-memory that has to be written to the DB. This is not what I am seeing. </p>\n\n<p>I have created the following Interceptor:</p>\n\n<pre><code>public class FeedInterceptor extends EmptyInterceptor\n{\n    @Override\n    public void postFlush(Iterator entities)\n    {\n          System.out.println(\"postFlush\");          \n    }\n}\n</code></pre>\n\n<p>Registered it in my ApplicationContext</p>\n\n<pre><code>&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n   &lt;property name=\"entityInterceptor\"&gt;\n      &lt;bean class=\"interceptor.FeedInterceptor\"/&gt;\n   &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>But, strange enough, I see \"postFlush\" written to the console for every row retrieved from the DB from my DAO:</p>\n\n<pre><code>Session session = sessionFactory.getCurrentSession();\nQuery query = session.createQuery(\"from Feed feed\");\nquery.list();\n</code></pre>\n\n<p>Why is that?</p>\n"},{"tags":["java","hibernate","exception","jpa","try-catch"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13139236,"title":"How to Continue bulk inserts when exception occurs","body":"<p>I am using jpa with hibernate I want to insert 100 record in Database, suppose I get  exception   JDBC batch update in 50th record insertion i need to handling the Exception and I need to persist remaining record to DB.</p>\n\n<p>Code:</p>\n\n<pre><code> private List&lt;TempCustomers&gt; tempCustomer =new ArrayList&lt;TempCustomers&gt;();\n\n    public String migrateCustomers() {\n\n      TempCustomers temp = null;\n        for(DoTempCustomers tempCustomers:doTempCustomers){\n\n              try {\n                temp=new TempCustomers();\n                BeanUtils.copyProperties(temp, tempCustomers);\n                        tempCustomer.add(temp);\n                    entityManager.persist(temp);\n\n\n              }catch (Exception e) {\n                  tempCustomer.add(temp);\n                  entityManager.persist(temp);\n                  log.info(\"Exception ...\"+e);\n                  return \"null\";\n              }\n        }\n\n\n        return \"null\";\n    }\n</code></pre>\n"},{"tags":["hibernate","hibernate-mapping","many-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13085038,"title":"Why does Hibernate attempt to load \"not-found=ignore\" associations?","body":"<p>I've got a class (representing a project) which maps another class (representing a user) through a many-to-one relationship. As users come and go I've made sure to set the <strong>not-found</strong> property to <strong>ignore</strong> on the relationship.</p>\n\n<p>However, it appears that Hibernate still attempts to load the \"missing\" users by executing one extra SQL query for each of the projects where the <strong>not-found</strong> property should have set the relationship to <strong>null</strong>. That is, in cases where the associated user no long exist, I would except the not-found property to simple \"nullify\" that relationship. However, Hibernate attempts to fetch these relationships one by one.</p>\n\n<p>Any idea what I might do wrong?</p>\n"},{"tags":["java","hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13108618,"title":"Map a list within an embeddable class object?","body":"<p>How do I have to map a List within a TreeMap contained i a embeddable object?</p>\n\n<p>I'm trying to give an example, though it does not make that much sense. But you get my problem:</p>\n\n<pre><code>@Embeddable\nclass BookStore {\n\n    Map&lt;BookType, List&lt;Order&gt;&gt; orders = new TreeMap&lt;BookType, List&lt;Order&gt;&gt;();\n}\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>@OneToMany: targeting an unmapped class List&lt;Order&gt;.\n@ElementCollection: HibernateMappingException: could not determine type for: java.util.List\n</code></pre>\n"},{"tags":["hibernate","grails","groovy","proxy","gorm"],"answer_count":2,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":557,"score":2,"question_id":5622481,"title":"Removing proxy part of grails domain object?","body":"<p>I want to get at an actual instance of a domain object. That is, I need to serialize the object, and I'm trying to use the domain object on two sides of an <code>httpinvoker</code> chain. Is there a way to get a fully-loaded domain object that doesn't have any grails wiring, so that I can serialize it?</p>\n"},{"tags":["hibernate","jpa","sqlxml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":11779162,"title":"How to initialize SQLXML with Document object in Java","body":"<p>How do I convert a <code>org.w3c.dom.Document</code> object to <code>java.sql.SQLXML</code> so that it can be persisted into the database using Hibernate? Currently I can get it to work by converting it to a String via <code>javax.xml.transform.Transformer</code>, but I imagine it is the least efficient approach. </p>\n\n<p>I have tried the following but nothing got saved into the DB column.</p>\n\n<pre><code>SQLXML sqlxml = session.connection().createSQLXML();\nsqlxml.setResult(DOMResult.class).setNode(myDocument);\npreparedStmt.setSQLXML(index, sqlxml);\n</code></pre>\n"},{"tags":["hibernate","orm","mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13113065,"title":"many-to-many mapping with limited options on one side","body":"<p>I'm implementing a Java application which simulates a movie theater holding. One of the entities is a <code>Film</code>, this entity can have many <code>Genres</code> but there are obviously only a limited number of <code>Genres</code>. I'm not sure how I should implement this in Hibernate.</p>\n\n<p>First I made an enum class <code>Genre</code> and gave the <code>Film</code> entity a <code>Set&lt;Genre&gt; genres = new HashSet&lt;&gt;();</code> attribute.</p>\n\n<p>The problem with this is that the <code>Genre</code> is stored as a <code>BLOB</code> in the database, in a table created by Hibernate called <code>film_genres</code> and I would be unable to ask for all films of a particular <code>Genre</code>. (At least in my limited experience of Hibernate).</p>\n\n<p>Then I thought I could populate the database at startup with all possible <code>Genres</code> where the <code>Genre</code> class looks like this:</p>\n\n<pre><code>public class Genre {\n    private Integer id;\n    private String name;\n\n    private Genre() {}\n\n    public Genre(String name) {\n        this.name = name;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    private void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    private void setName(String name) {\n        this.name= name;\n    }\n}\n</code></pre>\n\n<p>A very basic class. But now say I want to add a <code>Genre</code> to a <code>Film</code>, I can't do:</p>\n\n<pre><code>Film film = new Film(\"The Terminal\");\nfilm.addGenre(new Genre(\"Drama\"));\n</code></pre>\n\n<p>Seeing as this would create a new <code>Genre</code> object for each film that is of genre drama. Would I then have to go to the database first to fetch the <code>Genre</code> object that is of value \"Drama\" and then add that object?</p>\n\n<p>If that's what should be done, then I would still like to use an enum like this:</p>\n\n<pre><code>public enum GenreEnum {\n    DRAMA(\"Drama\"),\n    ADVENTURE(\"Adventure\"),\n    ACTION(\"Action\"),\n    ...\n\n    private String value;\n\n    GenreEnum(String value) {\n        this.value = value;\n    }\n\n    public String getValue() {\n        return value;\n    }\n}\n</code></pre>\n\n<p>The reason for this is that I have full control over the spelling of the initial values going into the database (the prepopulation) and the values of the enum, so I could now do this:</p>\n\n<pre><code>Film film = new Film(\"The Terminal\");\nfilm.addGenre(GenreEnum.DRAMA);\n</code></pre>\n\n<p>And then in the <code>addGenre</code> method I could do:</p>\n\n<pre><code>public void addGenre(GenreEnum ge) {\n    Query query = session.createQuery(\"from Genre g where g.name = \" + ge.getValue());\n    Genre genre = (Genre)query.list().get(0);\n    this.genres.add(genre);\n}\n</code></pre>\n\n<p>I wouldn't put the transaction code in the model, but I've just put it there for simplification. I also realize the use of concatenation is unsafe.</p>\n\n<p>Is this a decent solution or am I missing something simpler to achieve this?</p>\n"},{"tags":["java","hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13141262,"title":"How to implement a List within a map for hibernate?","body":"<p>I have a working terminal application, and implementing Hibernate DB now.\nWonder how the following is done properly:</p>\n\n<p>A enclosing object <code>BookStore</code> holds a list of orders, grouped by type.</p>\n\n<pre><code>class BookStore {\n    Map&lt;BookType, List&lt;Order&gt;&gt; orders;\n}\n</code></pre>\n\n<p>When switching to Hibernate, I cannot use List within a map. So I would have to introduce another Object, like:</p>\n\n<pre><code>class OrderList {\n    List&lt;Order&gt; orders;\n}\nclass BookStore {\n    Map&lt;BookType, OrderList&gt; orders;\n}\n</code></pre>\n\n<p>But is this suitable?\nWould it be better to just let the bookstore hold an unsorted list of all orders, and fetch them if needed with a sql statement, like: <code>SELECT * FORM order o WHERE o.ordertype=OrderTypeA</code></p>\n\n<p>with:</p>\n\n<pre><code>class BookStore {\n    List&lt;Order&gt; orders;\n}\n</code></pre>\n"},{"tags":["java","oracle","hibernate","seam","c3p0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":13116452,"title":"Tomcat 6 Errors out on Startup","body":"<p>I have apache-tomcat-6.0.35 installed locally on my Windows 7 Machine. I also do have Hiberanate Java application that I am trying to run on Tomcat. The RDBMS used on back end is Oracle 11g and hence I do have Oracle client(11.2.0) installed on my machine. The Java app is using c3p0-0.9.1.2 to create connection pool with Oracle in the back end. All the connection information are stored in tnsnames.ora file.</p>\n\n<p>The entire project code is in Version Control System and hence the exact same code runs with no problem on my co-worker's machine but Tomcat fails to launch on mine with the following log. I have had this problem since early this year (Feb 2012) but never got it resolved. I am trying one more time to see if anyone can notice something that I am missing. I appreciate your time looking into this issue! <strong>Thank you much!</strong></p>\n\n<h2>Here is the content from log file  after I run the Tomcat Server:</h2>\n\n<pre><code>Using CATALINA_BASE:                 \"C:\\Users\\MyName\\.IntelliJIdea11\\system\\tomcat\\Unnamed_cerdoafebd8b4\"\nUsing CATALINA_HOME:   \"C:\\Program Files (x86)\\Apache\\Tomcat6\\apache-tomcat-6.0.35\"\nUsing CATALINA_TMPDIR: \"C:\\Program Files (x86)\\Apache\\Tomcat6\\apache-tomcat-6.0.35\\temp\"\nUsing JRE_HOME:        \"C:\\Program Files\\Java\\jdk1.6.0_31\"\nUsing CLASSPATH:       \"C:\\Program Files (x86)\\Apache\\Tomcat6\\apache-tomcat-6.0.35\\bin\\bootstrap.jar\"\n...\n2012-10-29T03:37:54.054Z INFO   [main] EnvironmentProperties  - Filtering properties using environment dev\n2012-10-29T03:38:51.693Z INFO   [main] MLog  - MLog clients using log4j logging.\n2012-10-29T03:39:40.497Z INFO   [main] C3P0Registry  - Initializing c3p0-0.9.1.2 [built 21-May-2007 15:04:56; debug? true; trace: 10]\n2012-10-29T03:39:45.066Z INFO   [main] AbstractPoolBackedDataSource  - Initializing c3p0 pool... com.mchange.v2.c3p0.PoolBackedDataSource@f1bda9a6 [ connectionPoolDataSource -&gt; com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@1091d257 [ acquireIncrement -&gt; 1, acquireRetryAttempts -&gt; 3, acquireRetryDelay -&gt; 1000, autoCommitOnClose -&gt; false, automaticTestTable -&gt; null, breakAfterAcquireFailure -&gt; false, checkoutTimeout -&gt; 0, connectionCustomizerClassName -&gt; null, connectionTesterClassName -&gt; com.mchange.v2.c3p0.impl.DefaultConnectionTester, debugUnreturnedConnectionStackTraces -&gt; false, factoryClassLocation -&gt; null, forceIgnoreUnresolvedTransactions -&gt; false, identityToken -&gt; 2zggjq8q1bc3mwlm6u21f|3bf60430, idleConnectionTestPeriod -&gt; 0, initialPoolSize -&gt; 2, maxAdministrativeTaskTime -&gt; 0, maxConnectionAge -&gt; 604800, maxIdleTime -&gt; 7200, maxIdleTimeExcessConnections -&gt; 120, maxPoolSize -&gt; 10, maxStatements -&gt; 0, maxStatementsPerConnection -&gt; 0, minPoolSize -&gt; 2, nestedDataSource -&gt; com.mchange.v2.c3p0.DriverManagerDataSource@7c977f23 [ description -&gt; null, driverClass -&gt; null, factoryClassLocation -&gt; null, identityToken -&gt; 2zggjq8q1bc3mwlm6u21f|2bbef4c6, jdbcUrl -&gt; jdbc:oracle:thin:@TRACKER_DEV, properties -&gt; {user=******, .username=cerdo_app, password=******, .password=PEOPLE_WHOUSE_ADHOC, url.dev=jdbc:oracle:thin:@TRACKER_DEV, .url=jdbc:oracle:thin:@DW_DEV, .url.dev=jdbc:oracle:thin:@DW_DEV} ], preferredTestQuery -&gt; select 1 from dual, propertyCycle -&gt; 0, testConnectionOnCheckin -&gt; true, testConnectionOnCheckout -&gt; false, unreturnedConnectionTimeout -&gt; 0, usesTraditionalReflectiveProxies -&gt; false; userOverrides: {} ], dataSourceName -&gt; null, factoryClassLocation -&gt; null, identityToken -&gt; 2zggjq8q1bc3mwlm6u21f|293a985, numHelperThreads -&gt; 3 ]\noracle.net.TNSAddress.SOException\n    at oracle.net.TNSAddress.ServiceAlias.initFromNVPair(Unknown Source)\n    at oracle.net.TNSAddress.ServiceAlias.initFromString(Unknown Source)\n    at oracle.net.resolver.AddrResolution.resolveAddrTree(Unknown Source)\n    at oracle.net.resolver.AddrResolution.resolveAndExecute(Unknown Source)\n    at oracle.net.ns.NSProtocol.establishConnection(Unknown Source)\n    at oracle.net.ns.NSProtocol.connect(Unknown Source)\n    at oracle.jdbc.ttc7.TTC7Protocol.connect(TTC7Protocol.java:1213)\n    at oracle.jdbc.ttc7.TTC7Protocol.logon(TTC7Protocol.java:209)\n    at oracle.jdbc.driver.OracleConnection.&lt;init&gt;(OracleConnection.java:252)\n    at oracle.jdbc.driver.OracleDriver.getConnectionInstance(OracleDriver.java:365)\n    at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:260)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:134)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)\n    at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)\n    at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)\n    at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)\n    at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)\n</code></pre>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13135309,"title":"JPA / Hibernate :: find whether an entity is detached","body":"<p>Is there a way to query the JPA <strong>EntityManager</strong> whether a given entity is detached? <a href=\"http://stackoverflow.com/questions/2779857/how-to-know-if-a-detached-jpa-entity-has-already-been-persisted-or-not\">This SO post</a> is discussing a similar issue but does not indicate a way to query the JPA <strong>EntityManager</strong> on the detachment status of an entity. I would prefer a JPA way, otherwise Hibernate-specific.</p>\n"},{"tags":["hibernate","tapestry"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13141043,"title":"How to use a custom hibernate.cfg.xml file path in Tapestry5","body":"<p>How can I change the name or path of the hibernate configuration file <code>hibernate.cfg.xml</code> in a tapestry application?</p>\n"},{"tags":["java","eclipse","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":363,"score":0,"question_id":11499104,"title":"Error: /hibernate.cfg.xml not found","body":"<p>I am using Eclipse \"Indigo\". I made a Java Project with the following Structure:\n<br>Hibernate  (Project Name)\n<br>src\n<br>Referenced Libraries\n<br>JRE System Libraries\n<br>employee.hbm.xml\n<br>hibernate.cfg.xml</p>\n\n<p><br> Now when I am running my code its showing error <strong>\"/hibernate.cfg.xml not found\"</strong>\n<br> Is there a way to set a path for hibernate configuration file??</p>\n"},{"tags":["hibernate","jpa-2.0","criteria-api"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":49,"score":5,"question_id":13123920,"title":"How to query for a M:N relationship using enums with CriteriaBuilder","body":"<p>I am curently working on a Company entity which contains a List of Area enum values. These are the areas, the company is working in. They are mapped as <code>@ElementCollection</code>.</p>\n\n<pre><code>@Entity\npublic class Company {\n\n  @ElementCollection\n  @CollectionTable(name = \"company2area\")\n  @Enumerated(EnumType.STRING)\n  private List&lt;Area&gt; areas = new ArrayList&lt;Area&gt;();\n\n  ...\n}\n</code></pre>\n\n<p>Area is a simple enum, containing the available areas.</p>\n\n<pre><code> public enum Area {\n    ASIA,\n    AMERICA,\n    EUROPE;\n}\n</code></pre>\n\n<p>I tried to query for all companies that are currently working in ASIA and AMERICA like this:</p>\n\n<pre><code>CriteriaQuery&lt;Company&gt; query = this.entityManager.getCriteriaBuilder()\n                                             .createQuery(Company.class);\nquery.where(query.from(Company.class)\n        .get(\"areas\")\n        .in(Arrays.asList(Area.ASIA, Area.AMERICA)));\nList&lt;Company&gt; result = entityManager.createQuery(q)\n                                    .getResultList();\n</code></pre>\n\n<p>But all I got is an exception:</p>\n\n<pre><code>Caused by: java.lang.IllegalArgumentException: Parameter value [ASIA]\ndid not match expected type [java.util.Collection]  at\norg.hibernate.ejb.AbstractQueryImpl.validateParameterBinding(AbstractQueryImpl.java:375)\n    at\norg.hibernate.ejb.AbstractQueryImpl.registerParameterBinding(AbstractQueryImpl.java:348)\n    at org.hibernate.ejb.QueryImpl.setParameter(QueryImpl.java:375)     at\norg.hibernate.ejb.criteria.CriteriaQueryCompiler$1$1.bind(CriteriaQueryCompiler.java:195)\n    at\norg.hibernate.ejb.criteria.CriteriaQueryCompiler.compile(CriteriaQueryCompiler.java:241)\n    at\norg.hibernate.ejb.AbstractEntityManagerImpl.createQuery(AbstractEntityManagerImpl.java:587)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)     at\norg.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)\n    at $Proxy61.createQuery(Unknown Source)     ... 29 more\n</code></pre>\n\n<p>What am I doing wrong? Is there a special trick about the enums? </p>\n\n<p>I'm well aware of the question <a href=\"http://stackoverflow.com/questions/11297241/how-to-query-an-mn-relationship-with-jpa2\">How to query an M:N relationship with JPA2?</a> I asked some months ago. Unfortunately, the solution from there does not work with enums.</p>\n\n<p>Thanks for your help. :)</p>\n\n<p>Edit: </p>\n\n<p>Here's the description of my MySQL database:</p>\n\n<pre><code>create table company2area (\n    Company_fk bigint not null,\n    areas varchar(255)\n) ENGINE=InnoDB;\n\ncreate table company (\n    id bigint not null auto_increment,\n    fullName varchar(255),\n    ...,\n    primary key (id)\n) ENGINE=InnoDB;\n\nalter table company2area \n    add index FK52BA7162CE087250 (Company_fk), \n    add constraint FK52BA7162CE087250 \n    foreign key (Company_fk) \n    references company (id);\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13135055,"title":"time_to_sec of mysql equivalent in hibernate HQL","body":"<p>Any method in hibernate HQL which does same functionality as time_to_sec in mysql database.\nthis is because i want to use this HQL even in oracle DB</p>\n\n<p>\"select count(log) from Entry log where time_to_sec(lclTime) between '\"\n             + timeInSeconds + \"' and '\" + nextHour + \"</p>\n\n<p>i have to make this query to be executed in oracle and mysql databases using hibernate HQL</p>\n\n<p>pls suggest</p>\n"},{"tags":["java","hibernate","jpa","orm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13139935,"title":"One entity class maps few tables","body":"<p>I have one very important table in my project - Mandatory table. It has a few column but in this case the most important is the primary key.</p>\n\n<pre><code>Mandatory\n1. id (Long Primary Key)\n...\n</code></pre>\n\n<p>Now I have to add tow new tables - Additional table, and Extra table. Both of them have only two columns. In Additional both are primary key. One of them are also foreign key as you can see.</p>\n\n<pre><code>Additional\n1. mandatory_id (Long Primary Key FK -&gt; Mandatory.id)\n2. description (Varchar(512) Primary Key)\n</code></pre>\n\n<p>In Extra table primary key is also foreign key.</p>\n\n<pre><code>Extra\n1. mandatory_id (Long Primary Key FK -&gt; Mandatory.id)\n2. text (Varchar(512) \n</code></pre>\n\n<p>I am considering how can I implement it in my project using Hibernate.</p>\n\n<p>I have declared them in this way (here without getters, setter and etc), <code>MandatoryEntity</code> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"mandatory\")\npublic class MandatoryEntity {\n\n    @OneToMany\n    @JoinColumn(name = \"mandatory_id\")\n    protected List&lt;AdditionalEntity&gt; additonals;\n\n    @OneToOne\n    @JoinColumn(name = \"mandatory_id\")\n    protected ExtraEntity extra;\n}\n</code></pre>\n\n<p><code>AdditionalEntity</code> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"additional\")\npublic class AdditionalEntity {\n\n    @EmbeddedId\n    private AdditionalPK id;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @Fetch(value = FetchMode.JOIN)\n    @JoinColumn(name = \"mandatory_id\", nullable = false, insertable = false, updatable = false)\n    protected MandatoryEntity mandatory;\n}\n</code></pre>\n\n<p><code>AdditionalPK</code> class:</p>\n\n<pre><code>@Embeddable\npublic class AdditionalPK {\n\n    @Column(name = \"mandatory_id\")\n    private Long mandatoryId;\n\n    @Column(name = \"description\")\n    private String description;\n}\n</code></pre>\n\n<p><code>ExtraEntity</code> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"extra\")\npublic class ExtraEntity {\n\n    @Id\n    @Column(name = \"mandatory_id\")\n    private Long id;\n\n    @OneToOne \n    @PrimaryKeyJoinColumn\n    protected MandatoryEntity mandatory\n\n    @Column(name = \"text\")\n    protected String text;\n}\n</code></pre>\n\n<p>At this moment the laptop on which I am working is broken so I have time to my considerations. I have found in JPA Specification <code>@SecondaryTables</code> annotation. May I use this annotation in my case? These are only two tables, each of them has only two columns. The first has composite primary key, the second not.</p>\n\n<p>Maybe there is another way to implement this tables in one <code>MandatoryEntity</code>? Without two new entities: <code>AdditionalEntity</code> and <code>ExtraEntity</code>?</p>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13066509,"title":"can anyone please help me understand this query?","body":"<p>Can anyone help me understand this query? The <code>mktpgmvhclxref.mktpgmvhclxrefId.mktgPgm</code> part mostly. Generally it is <code>table_name.columnName</code> but here the format seems to be different </p>\n\n<pre><code>SELECT mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm, \n       mktpgm.mktgpgm, \n       mktpgmvhclxref.cmpgn, \n       campaign.cmpgndescription, \n       mktpgmvhclxref.mktpgmvhclxrefid.vhcl, \n       vhclhierarchy.modname, \n       mktpgmvhclxref.mktpgmvhclxrefid.modyr, \n       mktpgmvhclxref.userinsrt, \n       mktpgmvhclxref.rowinsrt \nFROM   mktpgmvhclxref mktpgmvhclxref, \n       mktpgm mktpgm, \n       vhclhierarchy vhclHierarchy, \n       campaign campaign \nWHERE  mktpgmvhclxref.mktpgmvhclxrefid.mktgpgm = mktpgm.idmktgpgm \n       AND mktpgmvhclxref.cmpgn = campaign.campaignid \n       AND mktpgmvhclxref.mktpgmvhclxrefid.vhcl = vhclhierarchy.vhcl \n</code></pre>\n"},{"tags":["java","spring","hibernate","rest","transactions"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13138564,"title":"Catch Hibernate Persistence Exceptions in @Transactional REST service methods","body":"<p>We're building a REST service with Spring and JPA where each method is annotated <code>@Transactional</code>, since one REST call is one transaction. Now if say a user is trying to call delete on a resource that has dependencies, hibernate will throw a <code>PersistenceException</code>, causing the REST server call to return with status 500. </p>\n\n<p>We want to catch those exceptions and wrap them in our own error object, that will contain custom error codes as well as the orignial message.</p>\n\n<p>I tried just plain catching all <code>RuntimeExceptions</code> in the REST call and then returning our custom error object. That however won't work, as appearently the fact that the transaction has been aborted will get handled outside my method.</p>\n\n<p>I also tried to catch the <code>PersistenceException</code> directly at DAO level. This worked fine in my unit tests didn't change anything outside them. Also our web container seems to just do its own thing by throwing a <code>DataIntegrityViolationException</code> instead of a <code>PersistenceException</code>. That doesn't even appear in the trace. As a side note, that's rather confusing, as I thought Hibernate would take care of its own stuff. Why is spring interfering?</p>\n\n<p>Well anyway.. I also tried to use </p>\n\n<pre><code>TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();\n</code></pre>\n\n<p>inside the REST service method with no success. </p>\n\n<p>I'm at a loss here.. It seems error handling for a transaction started by <code>@Transactional</code> is just out of my hands..?! Is it maybe because the annotation creates a proxy that gets processed in a different scope?</p>\n\n<p>Is the only option to handle transactions manually with the <code>TransactionTemplate</code>?</p>\n"},{"tags":["hibernate","postgresql","spring-roo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":434,"score":0,"question_id":9362067,"title":"Hibernate schema Export failure","body":"<p>I am using Spring Roo 1.2 and changed my database connection from mysql to postgres. I did this by excuting \"persistence setup\" in the Roo shell and also set the parameters in the file database.properties. As final step I've included the jdbc driver for postgres as dependency in pom.xml.</p>\n\n<p>When executing \"mvn clean jetty:run\" I get following response:</p>\n\n<pre><code>2012-02-20 14:31:15,465 [main] ERROR org.hibernate.tool.hbm2ddl.SchemaExport - schema export unsuccessful\njava.lang.UnsupportedOperationException: Not supported by BasicDataSource\n    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1062)\n    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:68)\n    at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:51)\n    at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:263)\n    at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:219)\n    at org.hibernate.impl.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:372)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1872)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:906)\n    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:74)\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:257)\n</code></pre>\n\n<p>What does this mean? Is schema export for Postgres not supported or do I have an configuration problem?</p>\n"},{"tags":["spring","hibernate","interceptor","sessionfactory"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13137647,"title":"How to wire a SessionFactory into a Hibernate Interceptor with Spring?","body":"<p>So, I am following the Hibernate documentation to configure interceptors (<a href=\"http://docs.jboss.org/hibernate/core/4.0/manual/en-US/html/events.html#objectstate-interceptors\" rel=\"nofollow\">link</a>). Then, I am registering my interceptor in the AnnotationSessionFactoryBean as follows:</p>\n\n<pre><code>&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n&lt;property name=\"entityInterceptor\"&gt;\n&lt;bean class=\"domain.interceptor.AddressInterceptor\"/&gt;\n&lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>What I want to achieve is to insert a row in my log table when something is caught in my Interceptor. Though, this introduces a cyclical configuration dependency: the Interceptor needs the SessionFactory and the SessionFactory needs the Interceptor. How could I wire in the SessionFactory in my Interceptor?</p>\n"},{"tags":["hibernate","spring","spring-3"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":4038,"score":3,"question_id":4041645,"title":"Set Hibernate session's flush mode in Spring","body":"<p>I am writing integration tests and in one test method I'd like to write some data to DB and then read it. </p>\n\n<pre><code>@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = {\"classpath:applicationContext.xml\"})\n@TransactionConfiguration()\n@Transactional\npublic class SimpleIntegrationTest {\n\n    @Resource\n    private DummyDAO dummyDAO;\n\n    /**\n     * Tries to store {@link com.example.server.entity.DummyEntity}.\n     */\n    @Test\n    public void testPersistTestEntity() {\n        int countBefore = dummyDAO.findAll().size();\n        DummyEntity dummyEntity = new DummyEntity();\n        dummyDAO.makePersistent(dummyEntity);\n\n        //HERE SHOULD COME SESSION.FLUSH()\n\n        int countAfter = dummyDAO.findAll().size();\n\n        assertEquals(countBefore + 1, countAfter);\n    }\n}\n</code></pre>\n\n<p>As you can see between storing and reading data, the session should be flushed because the default <code>FushMode</code> is <code>AUTO</code> thus no data can be actually stored in DB.</p>\n\n<p><strong>Question:</strong> Can I some how set <code>FlushMode</code> to <code>ALWAYS</code> in session factory or somewhere else to avoid repeating <code>session.flush()</code> call?</p>\n\n<p>All DB calls in DAO goes with <code>HibernateTemplate</code> instance.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13136006,"title":"Row position in MySQL","body":"<p>I was looking <a href=\"http://stackoverflow.com/questions/1895110/row-number-in-mysql\">here</a>, but can't find the answer to my question. </p>\n\n<p>Need to get a list of objects from MySQL, for e.g.:</p>\n\n<pre><code>+-----------------------------+\n+ id | username | password    +\n+-----------------------------+\n+  1 | User1                  +\n+  2 | User2                  +\n+  5 | User3                  +\n+  9 | User4                  +\n+ 11 | User5                  +\n+ 18 | User6                  +\n+ .....                       +\n+ 25 | User10                 +\n+-----------------------------+\n</code></pre>\n\n<p>and count the position oh each item, not the id, but the position where item is at this moment, all this with pagination, for e.g.:</p>\n\n<pre><code>Page 1\n1, User1, id1\n2, User2, id2\n3, User3, id5\n\nPage 2\n4, User4, id9\n5, User5, id11\n6, User6, id18\n\nPage 3\n...\n</code></pre>\n\n<p>I understand that he must calculate the position of each item in the page list on every change of the page but don't know how to do this in MySQL. </p>\n\n<p>I will highly appreciate if someone will help me with an advice. Thanks</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":25,"score":-1,"question_id":13136574,"title":"How to get column name specified in hibernate entity?","body":"<p>I have an hibernate entity.i am using annotations to map entity properties to database table. my requirement is, is there any way to get the column name configured in an entity?</p>\n\n<pre><code>    @Column(name = \"some_id\", nullable = false)\n    private Long someID;\n    //it has setters and getters\n</code></pre>\n\n<p>Now i need to get some_id column name. is there any way to do that?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","hibernate","orm","apache-torque"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":785,"score":2,"question_id":2673180,"title":"Hibernate vs. Apache Torque","body":"<p>Can anybody provide detailed advantages and disadvantages of each ORM?\nFirst of all I'm interested in things that Hibernate provides, and Torquay not.</p>\n"},{"tags":["java","hibernate","jpa","seam","jta"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13136001,"title":"Autocommit error using JPA and Hibernate","body":"<p>i have seen google upto that i found below way to done with the jpa but i am getting exception this is correct way to follow bulk inserts and rollback in jpa with hibernate \nI am using seam 2.1.2</p>\n\n<p>i have done bulk inserts done in migrateCustomers() method after that i am getting  confirmation from user then i need to commit and rollback in updatedData() method.</p>\n\n<pre><code> import javax.naming.InitialContext;\n   import javax.naming.NamingException;\n   import javax.persistence.EntityManager;\n   import javax.persistence.EntityManagerFactory;\n   import javax.persistence.EntityTransaction;\n   import javax.transaction.UserTransaction;\n\n\n@In\nprivate EntityManager entityManager;\nUserTransaction tx;\n      @Begin(join = true)\npublic String migrateCustomers() {\n\n\n\n     EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"sampleadmin\");\n     entityManager= emf.createEntityManager();\n     tx = (UserTransaction) new InitialContext().lookup(\"UserTransaction\");\n\n\n\n\n               for(DoTempCustomers tempCustomers:doTempCustomers){\n        try {\n\n            TempCustomers temp=new TempCustomers();\n            BeanUtils.copyProperties(temp, tempCustomers);\n\n                         tx.begin();\n             entityManager.joinTransaction();\n             entityManager.persist(temp);\n\n              }catch (Exception e) {\n\n        e.printStackTrace();\n        return \"null\";\n        }\n\n     }\n\n    return \"null\"\n    }\n @Begin(join = true)\npublic String updatedData(){\n\n\n    try{    \n   if(decision.equals(\"YES\"){\n\n       tx.commit();\n       entityManager.close();\n\n\n   }else{\n       tx.rollback();\n       entityManager.close();\n\n    }\n    }\n    catch(Exception e){\n\n    }\n\n    return \"null\";\n}\n</code></pre>\n\n<p>persistence-prod.xml</p>\n\n<pre><code>&lt;persistence-unit name=\"sampleadmin\" transaction-type=\"JTA\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;jta-data-source&gt;sampleDataSource&lt;/jta-data-source&gt;\n\n        &lt;mapping-file&gt;META-INF/orm.xml&lt;/mapping-file&gt;\n\n        &lt;exclude-unlisted-classes&gt;true&lt;/exclude-unlisted-classes&gt;\n        &lt;properties&gt;\n\n\n            &lt;property name=\"hibernate.dialect\"                   value=\"org.hibernate.dialect.OracleDialect\" /&gt;\n            &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"validate\" /&gt;\n            &lt;property name=\"hibernate.jdbc.batch_size\" value=\"20\" /&gt;\n            &lt;property name=\"hibernate.cache.use_second_level_cache\"\n                value=\"false\" /&gt;\n            &lt;property name=\"hibernate.show_sql\" value=\"true\" /&gt;\n            &lt;property name=\"hibernate.default_schema\" value=\"sample\" /&gt;\n\n\n            &lt;property name=\"hibernate.transaction.manager_lookup_class\"\n                value=\"@transactionManagerLookupClass@\" /&gt;\n                &lt;/properties&gt;\n&lt;/persistence-unit&gt;\n\n\nxxx-ds.xml\n         &lt;local-tx-datasource&gt;\n        &lt;jndi-name&gt;sampleDataSource&lt;/jndi-name&gt;\n        &lt;use-java-context&gt;false&lt;/use-java-context&gt;\n        &lt;connection-url&gt;jdbc:oracle:thin:@localhost:1521:sid&lt;/connection-url&gt;\n        &lt;driver-class&gt;oracle.jdbc.OracleDriver&lt;/driver-class&gt;\n         &lt;user-name&gt;sample&lt;/user-name&gt;\n        &lt;password&gt;passwd&lt;/password&gt;\n        &lt;min-pool-size&gt;10&lt;/min-pool-size&gt;\n        &lt;max-pool-size&gt;200&lt;/max-pool-size&gt;\n       &lt;blocking-timeout-millis&gt;50000&lt;/blocking-timeout-millis&gt;\n\n    &lt;/local-tx-datasource&gt;\n</code></pre>\n\n<p>Exception :</p>\n\n<pre><code> 11:56:16,934 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,934 [] ASTQueryTranslatorFactory - Using ASTQueryTranslatorFactory\n11:56:16,934 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,934 [] SettingsFactory - Query language substitutions: {}\n11:56:16,934 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,934 [] SettingsFactory - JPA-QL strict compliance: enabled\n11:56:16,934 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,934 [] SettingsFactory - Second-level cache: disabled\n11:56:16,934 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,934 [] SettingsFactory - Query cache: disabled\n11:56:16,935 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,935 [] SettingsFactory - Optimize cache for minimal puts: disabled\n11:56:16,935 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,935 [] SettingsFactory - Structured second-level cache entries: disabled\n11:56:16,935 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,935 [] SettingsFactory - Statistics: disabled\n11:56:16,935 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,935 [] SettingsFactory - Deleted entity synthetic identifier rollback: disabled\n11:56:16,936 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,935 [] SettingsFactory - Default entity-mode: pojo\n11:56:16,936 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:16,936 [] SettingsFactory - Named query checking : enabled\n11:56:17,069 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:17,069 [] SessionFactoryImpl - building session factory\n11:56:17,654 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:17,653 [] SessionFactoryObjectFactory - Not binding factory to JNDI, no JNDI name configured\n11:56:17,654 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:17,654 [] SchemaUpdate - Running hbm2ddl schema update\n11:56:17,654 INFO  [STDOUT] [Mobee]- INFO 2012-10-30 11:56:17,654 [] SchemaUpdate - fetching database metadata\n11:56:17,658 INFO  [STDOUT] [Mobee]-ERROR 2012-10-30 11:56:17,655 [] SchemaUpdate - could not get database metadata\njava.sql.SQLException: You cannot set autocommit during a managed transaction!\n    at org.jboss.resource.adapter.jdbc.BaseWrapperManagedConnection.setJdbcAutoCommit(BaseWrapperManagedConnection.java:482)\n    at org.jboss.resource.adapter.jdbc.WrappedConnection.setAutoCommit(WrappedConnection.java:322)\n    at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:36)\n    at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)\n    at org.hibernate.impl.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:314)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1294)\n</code></pre>\n"},{"tags":["java","hibernate","criteria-api","hibernate-criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13135354,"title":"Hibernate Criteria API - How to get a list of an object attribute","body":"<p>I have two classes</p>\n\n<pre><code>class House {\n    String id\n    Long size\n    Resident resident\n}\n\nclass Resident {\n    String id\n    String name\n}\n</code></pre>\n\n<p>What I want, is a list of Residents but i need some restrictions for the House. E.q. on the size e.q. > 20 and limit results by 10</p>\n\n<p>The Residents have no references to the House.</p>\n\n<p>I really don't know how to go on with this.</p>\n\n<p>I tried this:</p>\n\n<pre><code>Criteria crit = session.createCriteria(House.class);\ncrit.add(Expression.ge(\"size\", 20));\ncrit.setMaxResults(10);\ncrit.addOrder(Order.desc(\"size\"));\nreturn crit.list();\n</code></pre>\n\n<p>but i dont know how to get the connection to the Resident</p>\n"},{"tags":["hibernate","list","jpa","collections","empty-list"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12670656,"title":"Hibernate JPA empty result with correct query","body":"<p>Hibernate retrieve returns empty list, while populated list is expected.\nInvolving 2 objects, mapping done by annotations:</p>\n\n<pre><code>@Entity\n@Table(name = \"parent\")\n@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\nclass Parent {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"ID\")\n    private long id;\n}\n\n@Entity\n@Table(name = \"child\")\n@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\nclass Child {\n    @ManyToOne\n    @JoinColumn(name = \"parentId\")\n    @OrderBy(value=\"id\")\n    private Parent parent;\n}\n</code></pre>\n\n<p>Query performed:</p>\n\n<pre><code>String queryString = \"select c from Child c where c.parent.id = ?1\";\nQuery q = getEntityManager().createQuery(queryString);\nq.setParameter(\"1\", parentId);\nreturn q.getResultList();\n</code></pre>\n\n<p>When hibernate executes that set of code it returns a list with size = 0. Turning SQL logging on and performing the query provided in the logs in MAMP returns the expected result, any one any ideas?</p>\n"},{"tags":["hibernate","caching","jpa","load-balancing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13134619,"title":"JPA Entity(Hibernate) update is not replicated with REPL_SYNC cache mode with JbossCache","body":"<p>Dear experts/experienced members,</p>\n\n<p>I am using jboss AS 5.0 and I have the following issue :</p>\n\n<p>I am working on POF with having stateless session bean in cluster (round robin) in front of the hibernate-jpa. The second level cache is turned on.</p>\n\n<p>I have tried all cache configuration (optimistic-shared, pessimistic-shared, optimistic-entity, etc...), but I do experience in all cases that the Entity update does not get synced/invalidated on the other node. When a new item is added to the cache it is always replicated well, but the entity update does not. So this means that on only one node the second level cache is updated on the other node the old data remains. So when after the entity update I make the call to the session beans on the different nodes they return different data for the same entity. On the node which received the entity update call everything is fine, however the other node does not receive any notification about the update. I turned the org.hibernate.cache log to INFO and I see \"externalPutRead\" command notification when a new item is added to the cache on the other node, however I see nothing when the entity is updated by the other node. My JPA Entity's cache configuration is TRANSACTIONAL and the JPA EntityManager access is done in REQUIRED transaction in the session bean. Do I miss anything? My perssitence xml is listed below.</p>\n\n<pre><code>------------------------------------------------------------------------\n\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"1.0\" xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\"&gt;\n    &lt;persistence-unit name=\"AppStore\" transaction-type=\"JTA\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;jta-data-source&gt;java:/appstore&lt;/jta-data-source&gt;\n        &lt;class&gt;com.miklos.Customer&lt;/class&gt;\n        &lt;class&gt;com.miklos.Item&lt;/class&gt;\n        &lt;properties&gt;\n          &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQLDialect\"/&gt;\n          &lt;property name=\"hibernate.generate_statistics\" value=\"true\"/&gt;\n          &lt;property name=\"hibernate.transaction.manager_lookup_class\" value=\"org.hibernate.transaction.JBossTransactionManagerLookup\" /&gt;\n          &lt;property name=\"hibernate.cache.use_second_level_cache\" value=\"true\"/&gt;\n          &lt;property name=\"hibernate.cache.use_query_cache\" value=\"true\"/&gt;\n          &lt;property name=\"hibernate.cache.region.factory_class\" value=\"org.hibernate.cache.jbc2.MultiplexedJBossCacheRegionFactory\"/&gt;\n          &lt;property name=\"hibernate.cache.region.jbc2.cfg.query\" value=\"replicated-query\"/&gt;\n          &lt;property name=\"hibernate.cache.region.jbc2.cachefactory\" value=\"java:CacheManager\"/&gt;\n          &lt;property name=\"hibernate.cache.region.jbc2.cfg.entity\" value=\"replicated-query\"/&gt;\n          &lt;property name=\"hibernate.cache.region.jbc2.cfg.collection\" value=\"replicated-query\"/&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n\n\n------------------------------------------------------------------------ \n</code></pre>\n"},{"tags":["java","android","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":40,"score":0,"question_id":13115835,"title":"Adding Hibernate to an Android Project (Mistaken usage of core class)","body":"<p>Our primary focus is a java-based desktop application. The data for our application is stored in an H2 database using Hibernate. The H2 database runs in server mode so that other clients can connect to it.</p>\n\n<p>Will a Android application be possible to build to view the data hosted on a server. When I include hibernate jar's in my android application libs folder I get the following errors.</p>\n\n<pre><code>   [dx] trouble processing \"javax/transaction/Transaction.class\":\n   [dx] \n   [dx] Ill-advised or mistaken usage of a core class (java.* or javax.*)\n   [dx] when not building a core library.\n   [dx] \n   [dx] This is often due to inadvertently including a core library file\n   [dx] in your application's project, when using an IDE (such as\n   [dx] Eclipse). If you are sure you're not intentionally defining a\n   [dx] core class, then this is the most likely explanation of what's\n   [dx] going on.\n   [dx] \n   [dx] However, you might actually be trying to define a class in a core\n   [dx] namespace, the source of which you may have taken, for example,\n   [dx] from a non-Android virtual machine project. This will most\n   [dx] assuredly not work. At a minimum, it jeopardizes the\n   [dx] compatibility of your app with future versions of the platform.\n   [dx] It is also often of questionable legality.\n   [dx] \n   [dx] If you really intend to build a core library -- which is only\n   [dx] appropriate as part of creating a full virtual machine\n   [dx] distribution, as opposed to compiling an application -- then use\n   [dx] the \"--core-library\" option to suppress this error message.\n   [dx] \n   [dx] If you go ahead and use \"--core-library\" but are in fact\n   [dx] building an application, then be forewarned that your application\n   [dx] will still fail to build or run, at some point. Please be\n   [dx] prepared for angry customers who find, for example, that your\n   [dx] application ceases to function once they upgrade their operating\n   [dx] system. You will be to blame for this problem.\n   [dx] \n   [dx] If you are legitimately using some code that happens to be in a\n   [dx] core package, then the easiest safe alternative you have is to\n   [dx] repackage that code. That is, move the classes in question into\n   [dx] your own package namespace. This means that they will never be in\n   [dx] conflict with core system classes. JarJar is a tool that may help\n   [dx] you in this endeavor. If you find that you cannot do this, then\n   [dx] that is an indication that the path you are on will ultimately\n   [dx] lead to pain, suffering, grief, and lamentation.\n   [dx] \n   [dx] 1 error; aborting\n</code></pre>\n\n<p>There are two required Hibernate libraries that use the javax namespace (hibernate-jpa-2.0-api.1.0.1-Final.jar and jboss-transaction-api_1.1_spec-1.0.0.Final.jar). </p>\n\n<ul>\n<li>It tries to combine all of the libraries together into the .apk and throws a exception because it finds a class using a reserved namespace.</li>\n<li>Classes could conflict with system (core) classes that are part of Android/Java.</li>\n</ul>\n\n<p>I believe the last paragraph of this error/warning applies to what I am trying to do. </p>\n\n<ul>\n<li>Would using a tool like JarJar help? </li>\n<li>How does repackaging code work with licensing? </li>\n<li>Would it be difficult to repackage all of the code? </li>\n<li>Why would a 3rd party create a package in javax anyway?</li>\n</ul>\n\n<p>Edit: I am using ant to compile the Android project via the auto-generated build file and the command \"ant debug\".</p>\n"},{"tags":["java","hibernate","session"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13123968,"title":"Hibernate session save","body":"<p>I'm try to add a subject to my forum and every time I create a Forum object I get this error:</p>\n\n<pre><code>HTTP Status 500 -\n\ntype Exception report\n\nmessage\n\ndescription The server encountered an internal error () that prevented it from fulfilling this request.\n\nexception\n\norg.hibernate.AssertionFailure: null id in com.versusfootball.hibernate.entity.ForumTopic entry (don't flush the Session after an exception occurs)\n    org.hibernate.event.def.DefaultFlushEntityEventListener.checkId(DefaultFlushEntityEventListener.java:82)\n    org.hibernate.event.def.DefaultFlushEntityEventListener.getValues(DefaultFlushEntityEventListener.java:190)\n    org.hibernate.event.def.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:147)\n    org.hibernate.event.def.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:219)\n    org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:99)\n    org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n    org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1216)\n    com.versusfootball.dao.DAO.rollback(DAO.java:46)\n    com.versusfootball.dao.ForumTopicDAO.create(ForumTopicDAO.java:31)\n    com.versusfootball.struts.main.forum.SaveForumSubject.execute(SaveForumSubject.java:46)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    java.lang.reflect.Method.invoke(Method.java:616)\n    com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:452)\n    com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:291)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:254)\n    com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:176)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:263)\n    org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:133)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:207)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:207)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:94)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:142)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:166)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:190)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:248)\n    org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)\n    org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:485)\n    org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)\n    com.versusfootball.filters.InitSession.doFilter(InitSession.java:81)\n    com.versusfootball.filters.DisableUrlSessionFilter.doFilter(DisableUrlSessionFilter.java:87)\nnote The full stack trace of the root cause is available in the Apache Tomcat/6.0.29 logs.\n\nApache Tomcat/6.0.29\n</code></pre>\n\n<p>Here is my Forum constructor:</p>\n\n<pre><code>public Forum create (Forum forum) throws AppException {\n    try {\n        begin();\n        if(forum.getId() != null) {\n            getSession().merge(forum);\n        }\n        else {\n            getSession().save(forum);\n        }\n        commit();\n        close();\n        return forum;\n    }\n    catch (HibernateException e) {\n        log.error(\"Error creating forum : \" + e.getCause().getMessage());\n        rollback();\n        throw new AppException(e.getCause().getMessage());\n    }\n}\n</code></pre>\n\n<p>Here is my submit execution:</p>\n\n<pre><code>package com.versusfootball.struts.main.forum;\n\nimport java.util.Date;\n\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpSession;\n\nimport org.apache.log4j.Logger;\nimport org.apache.struts2.interceptor.ServletRequestAware;\n\nimport com.opensymphony.xwork2.ActionSupport;\nimport com.versusfootball.dao.ForumDAO;\nimport com.versusfootball.dao.ForumMessageDAO;\nimport com.versusfootball.dao.ForumTopicDAO;\nimport com.versusfootball.exceptions.AppException;\nimport com.versusfootball.hibernate.entity.Forum;\nimport com.versusfootball.hibernate.entity.ForumMessage;\nimport com.versusfootball.hibernate.entity.ForumTopic;\nimport com.versusfootball.hibernate.entity.Personne;\n\npublic class SaveForumSubject extends ActionSupport implements ServletRequestAware {\n    /**\n     * \n     */\n    private static final long serialVersionUID = -2131201082127318301L;\n    private static final Logger log = Logger.getLogger(SaveForumSubject.class);  \n\n    public String execute() {\n        try {\n            HttpSession session = request.getSession();\n            Personne usager = (Personne)session.getAttribute(\"usagerFoot\");\n            if(usager == null) {\n                return ERROR;\n            }\n\n            Date today = new Date();\n\n            forum = forumDAO.getById(forumId);\n            ForumTopic newTopic = new ForumTopic();\n            newTopic.setNbMessages(0);\n            newTopic.setNbViews(0);\n            newTopic.setForum(forum);\n            newTopic.setCreationDate(today);\n            newTopic.setTitle(msgTitle);\n            newTopic.setAuthor(usager);\n            newTopic = ftDAO.create(newTopic);\n            subjectId = newTopic.getId();\n            ForumMessage newMsg = new ForumMessage();\n\n            newMsg.setAuthor(usager);            \n            newMsg.setMessageDate(today);\n            message = message.replaceAll(\"\\n\", \"&lt;br /&gt;\");\n            newMsg.setText(message);            \n            newMsg.setTopic(newTopic);\n            newMsg.setNiveau(0);\n            newMsg = fmDAO.create(newMsg);\n\n            messageId = newMsg.getId();\n\n            forum.setNbMessages(forum.getNbMessages() + 1);\n            forum.setNbTopics(forum.getNbTopics() + 1);\n            forum.setLastMessage(newMsg);\n            newTopic.setLastMessage(newMsg);\n            newTopic = ftDAO.create(newTopic);\n\n            forumDAO.create(forum);\n\n        } catch (AppException e) {\n            // TODO Auto-generated catch block\n            log.error(e.getMessage());\n        }\n        return SUCCESS;     \n    }\n\n    private ForumDAO forumDAO = new ForumDAO();\n    private ForumMessageDAO fmDAO = new ForumMessageDAO();\n    private ForumTopicDAO ftDAO = new ForumTopicDAO();\n\n    private HttpServletRequest request;\n\n    private String msgTitle = \"\";\n    private String message = \"\";\n    private Integer forumId;\n    private Integer messageId;\n    private Integer subjectId;\n\n    private Forum forum;\n\n    public void setMsgTitle(String msgTitle) {\n        this.msgTitle = msgTitle;\n    }\n    public String getMsgTitle() {\n        return msgTitle;\n    }\n\n    public void setMessage(String message) {\n        this.message = message;\n    }\n    public String getMessage() {\n        return message;\n    }\n\n    public void setForumId(Integer forumId) {\n        this.forumId = forumId;\n    }\n    public Integer getForumId() {\n        return forumId;\n    }\n\n    public Integer getMessageId() {\n        return messageId;\n    }\n\n    public Forum getForum() {\n        return forum;\n    }\n\n    public Integer getSubjectId() {\n        return subjectId;\n    }\n\n    @Override\n    public void setServletRequest(HttpServletRequest request) {\n        this.request = request;        \n    }\n}\n</code></pre>\n\n<p>Does someone have any idea how I could fix this?</p>\n"},{"tags":["java","sql","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13126457,"title":"Hibernate retrieve results from database based on condition","body":"<p>I am a bit lost when it comes to retrieving results from the database.</p>\n\n<p>My <code>MemberModel</code> consists of 4 fields: <code>id</code>, <code>username</code>, <code>password</code> and <code>email</code>. I have been able to successfully save it to database.</p>\n\n<p>Now I need to retrieve an <code>id</code> of a member who's <code>username</code> equals \"Test\".</p>\n\n<p>I tried something along the lines:</p>\n\n<pre><code>SQLQuery query = session.createSQLQuery(\"SELECT id FROM members WHERE username = :username\");\nquery.setString(\"username\", username);\nList&lt;MemberModel&gt; returnedMembers = query.list();\nMemberModel member = returnedMembers.get(0);\nint id = member.getId();\n</code></pre>\n\n<p>However I get an error that <code>member.getId()</code> cannot be converted to int, since it is <code>MemberModel</code>... But the getter <code>getId()</code> returns <code>int</code>.</p>\n\n<p>I am quite confused. The question is: what would be the easiest and fastes way to retrieve member <code>id</code> based on condition (value of <code>username</code>)?</p>\n"},{"tags":["spring","hibernate","jax-rs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13111048,"title":"JAX-RS with Spring and Hibernate","body":"<p>I am new to using Spring and Hibernate with JAX-RS. I have managed to Configure Spring with JAX-RS together, and now i want to configure Hibernate in this. Can anyone show me a good tutorial to using Spring JAX-RS and Hibernate ?</p>\n\n<p>Kind Regards.</p>\n"},{"tags":["mysql","spring","swing","hibernate","password-encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13131304,"title":"Working with password in Hibernate (for standalone applications)","body":"<p>I'm looking for best practices around how to deal with password fields in my Java standalone application (Netbeans+Spring+Hibernate+MySQL database+Swing).</p>\n\n<p>1) I've created a table with a password column.... so, which data type must be this column?\n2) Which kind of algorythms for SALTing passwords do you recomend to follow and implement on my app?\n3) Do you recommend saving password as a plain-text or after being transformed according with the algorythm?\n4) Sample codes of all this process</p>\n\n<p>I hope we can help many other developers who must deal with Spring for standalone apps and around the tasks with Hibernate on this kind of questions.</p>\n\n<p>Thanks in advance for any suggestions.</p>\n"},{"tags":["hibernate","auto-populate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13121278,"title":"hibernate populate database on first run","body":"<p>It is possible to make Hibernate insert Java Objects only one first run of the application?</p>\n\n<p>I don't want to load an inser.sql file, i think that is possible to instantiate all my java objects in a specific java file and only on the first run hibernate populate de DB with that objects.\nHow to do it?</p>\n"},{"tags":["java","hibernate","java-ee","hibernate-annotations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13126999,"title":"how to make a hibernate query","body":"<p>These are my tables,</p>\n\n<pre><code>supported table\n---------------------\nsupported field id    supported fields           category\n-----------------------------------------------------------------------\n           1               A                        section\n           2               B                        section\n           3               LKG                      class\n           4               UKG                      class\n\nInstitution table\n---------------------\nInstitution id                 classid                     sectionid\n--------------------------------------------------------------------\n           1                    3                            1\n           2                    4                            1\n\nAcademic year table\n---------------------------\n\nAcademic year id            Academic year        Institution id\n---------------------------------------------------------------------------\n           1                  2012                           1\n           2                  2013                           2\n</code></pre>\n\n<p>I want to display records like Academic year, class, section .</p>\n\n<ol>\n<li><p>how to make a  hibernate query for those requirements</p></li>\n<li><p>If i want to display class \"LKG\" and section \"A\"  in system.out.println(); how to make a codings like (acadmic.getInstitution().getClassid() here i get Classid but i want to display class and section from supported field ).</p></li>\n</ol>\n"},{"tags":["java","spring","hibernate","unit-testing","transactions"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13131242,"title":"How to test transactional work performed on `POST_COMMIT_INSERT` callback","body":"<p>I'm having difficulty debugging and diagnosing an issue within my application.</p>\n\n<p>I have a JPA event listener wired in to perform work in a <code>POST_COMMIT_INSERT</code>.  The work that is performed is also transactional.</p>\n\n<p>I'm having difficulty writing a test that captures the work that occurred in the post-transactional transaction.</p>\n\n<p>My current test performs it's assertions in a <code>@PostTransaction</code> method.  However, although I see the data being persisted (using log statements), the postTransaction-transaction work isn't available to me.</p>\n\n<p>I suspect it's because in my <code>@PostTransaction</code> method, I'm still too early - and that there's another transaction in progress.</p>\n\n<p>Here's a sample that roughly demonstrates the scenario:</p>\n\n<blockquote>\n  <p>After a <code>Foo</code> has been created &amp; saved, create and save a <code>Bar</code>.</p>\n</blockquote>\n\n<pre><code>// Step 1.  The factory that responds to creation of the Foo, and build a bar.\n@Component\nclass BarFactory implements PostInsertEventListener\n{\n     // Note:  I've tried various versions of @Transactional on different points\n     // within this class, and none have worked.\n\n     @Autowired\n     private BarRepository repository;\n\n     @Override\n     public void onPostInsert(PostInsertEvent event) \n     {\n         if (event.getEntity() instanceof Foo)\n         {\n             createBar();\n         }\n     }\n     @Transactional\n     public createBar()\n     {\n         Bar bar = new Bar();\n         repository.save(bar);\n         log.info(\"Bar was created: \" + bar.getId());\n     }\n }\n\n // Step 2:  Register the BarFactory\n @Component\n class LifecycleListenerFactory {\n    // This is a spring bean, and the listeners are also spring beans\n    // so we have to use a somewhat long-winded approach to register them\n    // with the EntityManager\n    @Autowired\n    public LifecycleListenerFactory(EntityManager em, BarFactory barFactory)\n    {\n        SessionFactory sessionFactory = getSessionFactory(em);\n        EventListenerRegistry registry = ((SessionFactoryImpl) sessionFactory).getServiceRegistry().getService(EventListenerRegistry.class);\n        EventListenerGroup&lt;PostInsertEventListener&gt; eventListenerGroup = registry.getEventListenerGroup(EventType.POST_COMMIT_INSERT);\n        eventListenerGroup.appendListener(barFactory);\n    }\n\n\n   SessionFactory getSessionFactory(EntityManager entityManager) {\n       Session session = (Session) entityManager.getDelegate();\n       SessionFactory sessionFactory = session.getSessionFactory();\n       return sessionFactory;\n   }\n } \n\n\n// Step 3:  Test.\n@RunWith(SpringJUnit4ClassRunner.class)\n@Transactional\n@TransactionConfiguration(defaultRollback=false)\nclass MyTest {\n   @Autowired\n   private FooRepository fooRepo;\n   @Autowired\n   private BarRepository barRepo;\n\n   @Test\n   public void test()\n   {\n       fooRepo.save(new Foo());\n   }\n\n   @AfterTransaction\n   public void assert()\n   {\n       assertThat(barRepo.findAll().size(),equalTo(1));\n   }\n}\n</code></pre>\n\n<p>In this scenario, I see the following output:</p>\n\n<p><code>INFO:  Bar was created: 1</code></p>\n\n<p>But the test fails.</p>\n\n<p>Am I correct in my assumption that my <code>@AfterTransaction</code> is running after the wrong transaction, or is something else wrong here?</p>\n\n<p>If so, how do I test this?</p>\n\n<p>I've tried moving the <code>@Transaction</code> boundaries around in the <code>BarFactory</code>, but that hasn't had any effect.</p>\n"},{"tags":["spring","hibernate","maven","hbm2ddl","hibernate3-maven-plugin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13131432,"title":"What are the <hbm2ddl/> configuration options for the hibernate3-maven-plugin-3.0?","body":"<p>I can't seem to find any documentation on the configuration options for hbm2ddl. Here is what I have in my pom.xml:</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;!-- Run \"mvn hibernate3:hbm2ddl\" to generate schema --&gt;\n    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.0&lt;/version&gt;\n\n    &lt;configuration&gt;\n        &lt;hibernatetool&gt;\n            &lt;annotationconfiguration\n                    propertyfile=\"src/main/resources/hibernate.cfg.xml\" /&gt;\n            &lt;hbm2ddl update=\"true\" create=\"true\" drop=\"true\" export=\"false\"\n                     outputfilename=\"shemaDiff.ddl\" format=\"true\"\n                     console=\"false\"/&gt;\n        &lt;/hibernatetool&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p>If I run</p>\n\n<pre><code>mvn hibernate3:hbm2ddl\n</code></pre>\n\n<p>It builds successfully, but the database is empty when I check.</p>\n\n<p>The .script file looks like the following:</p>\n\n<pre><code>SET DATABASE UNIQUE NAME HSQLDB3AAEB9E84A\nSET DATABASE GC 0\nSET DATABASE DEFAULT RESULT MEMORY ROWS 0\nSET DATABASE EVENT LOG LEVEL 0\nSET DATABASE SQL NAMES FALSE\nSET DATABASE SQL REFERENCES FALSE\nSET DATABASE SQL SIZE TRUE\nSET DATABASE SQL TYPES FALSE\nSET DATABASE SQL TDC DELETE TRUE\nSET DATABASE SQL TDC UPDATE TRUE\nSET DATABASE SQL TRANSLATE TTI TYPES TRUE\nSET DATABASE SQL CONCAT NULLS TRUE\nSET DATABASE SQL NULLS FIRST TRUE\nSET DATABASE SQL UNIQUE NULLS TRUE\nSET DATABASE SQL CONVERT TRUNCATE TRUE\nSET DATABASE SQL AVG SCALE 0\nSET DATABASE SQL DOUBLE NAN TRUE\nSET DATABASE SQL LONGVAR IS LOB FALSE\nSET DATABASE TRANSACTION CONTROL LOCKS\nSET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED\nSET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE\nSET DATABASE TEXT TABLE DEFAULTS ''\nSET FILES WRITE DELAY 500 MILLIS\nSET FILES BACKUP INCREMENT TRUE\nSET FILES CACHE SIZE 10000\nSET FILES CACHE ROWS 50000\nSET FILES SCALE 8\nSET FILES LOB SCALE 32\nSET FILES DEFRAG 0\nSET FILES NIO TRUE\nSET FILES NIO SIZE 256\nSET FILES LOG TRUE\nSET FILES LOG SIZE 50\nCREATE USER SA PASSWORD DIGEST 'd41d8cd98f00b204e9800998ecf8427e'\nALTER USER SA SET LOCAL TRUE\nCREATE SCHEMA PUBLIC AUTHORIZATION DBA\nALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1\nSET DATABASE DEFAULT INITIAL SCHEMA PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC\nGRANT DBA TO SA\nSET SCHEMA SYSTEM_LOBS\nINSERT INTO BLOCKS VALUES(0,2147483647,0)\n</code></pre>\n\n<p>Interestingly, if I set console=\"true\", it prints the correct sql table setup:</p>\n\n<pre><code>create table ACCOUNT (\n    ACCOUNT_ID integer generated by default as identity (start with 1),\n    ...\n);\n\ncreate table ... etc.\n</code></pre>\n\n<p>If I downgrade to version 2.2, so the plugin looks like the following:</p>\n\n<pre><code>&lt;plugin&gt;\n    &lt;!-- Run \"mvn hibernate3:hbm2ddl\" to generate schema --&gt;\n    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.2&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre>\n\n<p>and (without changing anything else) run mvn hibernate3:hbm2ddl, then the database tables are created properly from the annotated classes and the .script file reflects this:</p>\n\n<pre><code>SET DATABASE UNIQUE NAME HSQLDB3AAEB9E84A\nSET DATABASE GC 0\nSET DATABASE DEFAULT RESULT MEMORY ROWS 0\nSET DATABASE EVENT LOG LEVEL 0\nSET DATABASE SQL NAMES FALSE\nSET DATABASE SQL REFERENCES FALSE\nSET DATABASE SQL SIZE TRUE\nSET DATABASE SQL TYPES FALSE\nSET DATABASE SQL TDC DELETE TRUE\nSET DATABASE SQL TDC UPDATE TRUE\nSET DATABASE SQL TRANSLATE TTI TYPES TRUE\nSET DATABASE SQL CONCAT NULLS TRUE\nSET DATABASE SQL NULLS FIRST TRUE\nSET DATABASE SQL UNIQUE NULLS TRUE\nSET DATABASE SQL CONVERT TRUNCATE TRUE\nSET DATABASE SQL AVG SCALE 0\nSET DATABASE SQL DOUBLE NAN TRUE\nSET DATABASE SQL LONGVAR IS LOB FALSE\nSET DATABASE TRANSACTION CONTROL LOCKS\nSET DATABASE DEFAULT ISOLATION LEVEL READ COMMITTED\nSET DATABASE TRANSACTION ROLLBACK ON CONFLICT TRUE\nSET DATABASE TEXT TABLE DEFAULTS ''\nSET FILES WRITE DELAY 500 MILLIS\nSET FILES BACKUP INCREMENT TRUE\nSET FILES CACHE SIZE 10000\nSET FILES CACHE ROWS 50000\nSET FILES SCALE 8\nSET FILES LOB SCALE 32\nSET FILES DEFRAG 0\nSET FILES NIO TRUE\nSET FILES NIO SIZE 256\nSET FILES LOG TRUE\nSET FILES LOG SIZE 50\nCREATE USER SA PASSWORD DIGEST 'd41d8cd98f00b204e9800998ecf8427e'\nALTER USER SA SET LOCAL TRUE\nCREATE SCHEMA PUBLIC AUTHORIZATION DBA\nSET SCHEMA PUBLIC\nCREATE MEMORY TABLE PUBLIC.ACCOUNT(ACCOUNT_ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY, ...)\nALTER TABLE PUBLIC.ACCOUNT ALTER COLUMN ACCOUNT_ID RESTART WITH 1\n...\nALTER SEQUENCE SYSTEM_LOBS.LOB_ID RESTART WITH 1\nSET DATABASE DEFAULT INITIAL SCHEMA PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.YES_OR_NO TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.TIME_STAMP TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CARDINAL_NUMBER TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.CHARACTER_DATA TO PUBLIC\nGRANT USAGE ON DOMAIN INFORMATION_SCHEMA.SQL_IDENTIFIER TO PUBLIC\nGRANT DBA TO SA\nSET SCHEMA SYSTEM_LOBS\nINSERT INTO BLOCKS VALUES(0,2147483647,0)\n</code></pre>\n\n<p>Does anyone know what the configurations of hbm2ddl need to be, in order to properly create the tables with hibernate3-maven-plugin-3.0?</p>\n"},{"tags":["hibernate","intellij-idea"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13128106,"title":"prepopulate database","body":"<p>For test purposes I'm trying to prepopulate a table which is created by Hibernate. I have this in my <code>hibernate.cfg.xml</code>:</p>\n\n<pre><code>&lt;!-- Prepopulate database with these DML scripts --&gt;\n&lt;property name=\"hibernate.hbm2ddl.import_files\"&gt;/genres.sql&lt;/property&gt;\n</code></pre>\n\n<p>I have added the file <code>genres.sql</code> to the root of my <code>src</code> folder but it doesn't execute the file?</p>\n\n<p>This is the <code>genres.sql</code> file:</p>\n\n<pre><code>INSERT INTO genre (naam) VALUES (\"Action\");\nINSERT INTO genre (naam) VALUES (\"Adventure\");\nINSERT INTO genre (naam) VALUES (\"Animation\");\nINSERT INTO genre (naam) VALUES (\"Biography\");\nINSERT INTO genre (naam) VALUES (\"Comedy\");\n</code></pre>\n\n<p>Why is this not working?</p>\n"},{"tags":["hibernate","log4j","java-ee-6","maven-3","glassfish-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13131460,"title":"How to configure Log4j in a multi project maven","body":"<p>I have a maven war project which depends on an EJB maven project. The EJB project handles all business logic including DB access through Hibernate. Both projects are JEE6 and run on glassfish 3.1.2 using maven.\nI'm currently trying to configure Log4j to work (also log hibernate) in the scenario described. I have the following log4j.xml file in my ejb's src/main/resources folder (I'm that it is in the classpath):</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;!DOCTYPE log4j:configuration SYSTEM \"log4j.dtd\"&gt;\n\n    &lt;log4j:configuration xmlns:log4j=\n                \"http://jakarta.apache.org/log4j/\"\n                        debug=\"false\"&gt;\n\n        &lt;appender name=\"consoleAppender\"\n                class=\"org.apache.log4j.ConsoleAppender\"&gt;\n            &lt;param name=\"Threshold\" value=\"INFO\" /&gt;\n            &lt;layout class=\"org.apache.log4j.PatternLayout\"&gt;\n                &lt;param name=\"ConversionPattern\" value=\"%d\n                %-5p  [%c{1}] %m %n\" /&gt;\n            &lt;/layout&gt;\n        &lt;/appender&gt;\n\n        &lt;logger name=\"javabeat.net.log4j\" additivity=\"false\" &gt;\n            &lt;level value=\"INFO\" /&gt;\n            &lt;appender-ref ref=\"consoleAppender\"/&gt;\n        &lt;/logger&gt;\n    &lt;/log4j:configuration&gt;\n</code></pre>\n\n<p>I keep getting this error from log4j:</p>\n\n<blockquote>\n  <p>SEVERE: log4j:ERROR A \"org.apache.log4j.xml.DOMConfigurator\" object is not assignable to a \"org.apache.log4j.spi.Configurator\" variable.</p>\n  \n  <p>SEVERE: log4j:ERROR The class \"org.apache.log4j.spi.Configurator\" was loaded by </p>\n  \n  <p>SEVERE: log4j:ERROR [WebappClassLoader (delegate=true; repositories=WEB-INF/classes/)] whereas object of type </p>\n  \n  <p>SEVERE: log4j:ERROR \"org.apache.log4j.xml.DOMConfigurator\" was loaded by [WebappClassLoader (delegate=true; repositories=WEB-INF/classes/)].</p>\n  \n  <p>SEVERE: log4j:ERROR Could not instantiate configurator [org.apache.log4j.xml.DOMConfigurator].</p>\n  \n  <p>SEVERE: log4j:WARN No appenders could be found for logger (org.hibernate.type.BasicTypeRegistry).</p>\n  \n  <p>SEVERE: log4j:WARN Please initialize the log4j system properly.</p>\n  \n  <p>SEVERE: log4j:WARN See <a href=\"http://logging.apache.org/log4j/1.2/faq.html#noconfig\" rel=\"nofollow\">http://logging.apache.org/log4j/1.2/faq.html#noconfig</a> for more info.</p>\n</blockquote>\n\n<p>I'm out of ideas thx for the help</p>\n"},{"tags":["mysql","hibernate","postgresql","sybase","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13122799,"title":"Convert query to hibernate criteria query","body":"<p>I have the following Sybase query,</p>\n\n<pre><code>select *\n  from dbo.translation_style_sheet t1\n where t1.create_date = (select max(t2.create_date) \n                           from dbo.translation_style_sheet t2\n                          where t1.file_name = t2.file_name);\n</code></pre>\n\n<p>I'm trying to convert it to a hibernate criteria query, but haven't been able to figure it out. I'm assuming I need to use a DetachedCriteria to handle this, but not sure how to work with it. </p>\n\n<p>This is what I have thus far. </p>\n\n<pre><code>DetachedCriteria maxCreateDate = DetachedCriteria.forClass(TranslationStyleSheet.class, \"translationStyleSheet2\")\n    .setProjection( Property.forName(\"createDate\").max() )\n    .add( Property.forName(\"translationStyleSheet2.fileName\").eqProperty(\"translationStyleSheet.fileName\") );\n\nList&lt;TranslationStyleSheet&gt; translationStyleSheets = this.session.createCriteria(TranslationStyleSheet.class, \"translationStyleSheet\")\n            .add( Property.forName(\"createDate\").eq(maxCreateDate))\n            .list();\n</code></pre>\n\n<p>I'm getting the following exception. </p>\n\n<pre><code>org.hibernate.exception.GenericJDBCException\ncould not execute query\n\nSQL\n    select this_.translation_style_sheet_id as translat1_20_0_, this_.create_date as create2_20_0_, this_.description as descript3_20_0_, this_.file_content as file4_20_0_, this_.file_extension as file5_20_0_, this_.file_name as file6_20_0_, this_.file_size as file7_20_0_, this_.style_sheet_content as style8_20_0_, this_.style_sheet_type as style9_20_0_ from translation_style_sheet this_ where this_.create_date = (select max(translationStyleSheet2_.create_date) as y0_ from translation_style_sheet translationStyleSheet2_ where translationStyleSheet2_.file_name=this_.file_name)\nSQLState\n    ZZZZZ\n</code></pre>\n\n<p>Does anybody know what I'm doing wrong?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The error seems to be be happening at the max(translationStyleSheet2_.create_date) as y0_\nas. When I remove the as y0_ in the sql statement, I'm able to run the query the query, however I'm not sure how to repair this in hibernate criteria though. </p>\n"},{"tags":["hibernate","caching","jpa","jboss","second-level-cache"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13118106,"title":"Hibernate 2nd level cache update","body":"<p>I have following problem. \nI use JBoss 5.1, JPA/Hibernate with 2-nd level cache.\nMy system has few entities mapping the same database table.\nExample:\nTable FURNITURES is mapped by entity 'Furn' and 'Furniture'.</p>\n\n<p>These classes CAN NOT be changed.</p>\n\n<p>Now the when i change the data of 'Furn' with id 1, the 'Furniture' with id 1 still has the old data. Is there some possibility to evict 'Furniture' after 'Furn' was updated?</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":42,"score":-5,"question_id":13130736,"title":"Criteria in word length","body":"<p>I need search for results when word length is 4</p>\n\n<pre><code>criteria.add(Restrictions.eq(restiction.length, 4)\n</code></pre>\n\n<p>and the result \"Hell\", \"word\", etc </p>\n"},{"tags":["mysql","database","hibernate","locking"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13125813,"title":"How to implement row level locking using Hibernate Query Language?","body":"<p>Background: I am working on a MYSql database where multiple instances reads from the same Account Table . I want to implement row level exclusive lock using Hibernate Query Language to avoid dirty read.</p>\n\n<p>My code is as below.</p>\n\n<pre><code>List&lt;AccountTableBean&gt; currentRequestslist = sessionFactory.getCurrentSession()\n                .createQuery(\"from Account where status = :finalStatus\")\n                .setLockMode(\"MappCurrentRequests\", LockMode.PESSIMISTIC_READ)\n                .setParameter(\"finalStatus\",\"Active\").list();   \n</code></pre>\n\n<p>Currently, I have used Pessimistic_read on the entire table. Is there a way i can apply to lock on individual rows? Any example will be very helpful.</p>\n\n<p>Thank you,\nGendaful</p>\n"},{"tags":["java","hibernate","junit","h2"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13115729,"title":"Why do I get an error running JUnit tests on the 3rd time this code is executed?","body":"<p>I have almost identical code in the <code>setUp()</code> method of three tests. When run individually, the tests all work, but when I run them as part of the complete set of tests, the last one fails.</p>\n\n<p>The \"offending\" code is:</p>\n\n<pre><code>@Before\npublic void setUp() throws Exception {\n    AnnotationConfiguration configuration = new AnnotationConfiguration();\n\n    configuration.addAnnotatedClass(User.class);\n    configuration.setProperty(\"hibernate.dialect\", \"org.hibernate.dialect.H2Dialect\");\n    configuration.setProperty(\"hibernate.connection.driver_class\", \"org.h2.Driver\");\n    configuration.setProperty(\"hibernate.connection.url\", \"jdbc:h2:mem\");\n    configuration.setProperty(\"hibernate.hbm2ddl.auto\", \"create\");\n    configuration.setProperty(\"hibernate.current_session_context_class\", \"org.hibernate.context.ThreadLocalSessionContext\");\n\n    sessionFactory = configuration.buildSessionFactory();\n\n    sessionFactory.openSession();\n\n    // This is where it dies:\n    sessionFactory.getCurrentSession().beginTransaction();\n\n    User user = new User();\n    user.setUsername(\"emanymton\");\n    user.setPassword(passwordEncoder.encodePassword(\"password\", null));\n    user.setAccess(1);\n\n    sessionFactory.getCurrentSession().save(user);\n    sessionFactory.getCurrentSession().getTransaction().commit();\n}\n</code></pre>\n\n<p>The stack trace is:</p>\n\n<pre><code>1    [main] ERROR org.hibernate.tool.hbm2ddl.SchemaExport  - schema export unsuccessful ava.sql.SQLException: No suitable driver found for jdbc:h2:mem\n    at java.sql.DriverManager.getConnection(DriverManager.java:604)\n    at java.sql.DriverManager.getConnection(DriverManager.java:190)\n    at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:133)\n    at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:51)\n    at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:252)\n    at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:211)\n    at org.hibernate.impl.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:383)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1385)\n    at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:954)\n    at [MYPROJECT].security.authentication.manager.CustomAuthenticationManagerTest.setUp(CustomAuthenticationManagerTest.java:73)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:601)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)\n    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)\n    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\n7    [main] ERROR org.hibernate.util.JDBCExceptionReporter  - No suitable driver found for jdbc:h2:mem\n</code></pre>\n\n<p>I'm using Maven for dependencies, and have the dependency com.h2database.h2, version 1.3.168 in my classpath. As mentioned before, it works fine in the previous two tests, just fails here.</p>\n\n<p>Any ideas?</p>\n\n<p>Cheers in advance</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>This is my <code>tearDown</code> for this Test:</p>\n\n<pre><code>@After\npublic void tearDown() throws Exception {\n    try {\n        sessionFactory.getCurrentSession().getTransaction().rollback();\n    } catch (Exception e) {\n        //\n    }\n    sessionFactory.close();\n}\n</code></pre>\n\n<p>I've commented out the other two tests, and this one still fails, but ONLY if it's run as one of many, it runs Fine wen run on it's own.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I managed to get past some of the Driver issue when I commented out the line:</p>\n\n<pre><code>    configuration.setProperty(\"hibernate.current_session_context_class\", \"org.hibernate.context.ThreadLocalSessionContext\");\n</code></pre>\n\n<p>Not sure it this is a red herring, but for testing, is there a better class to use for the context class?</p>\n"},{"tags":["java","multithreading","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13129593,"title":"Unknown Entity in multithreading hibernate","body":"<p>We are converting a large database from one DBMS to another. We are mostly using JDBC for this but there are some Hibernate calls mixed in. So far, a small portion of the database is taking seven hours to migrate. To mitigate this, we decided we could migrate different parts of the database simultaneously. We rewrote the migration routine to use threads. After wading through Java heap space issues and making sure we had separate JDBC and Hibernate sessions in each thread, we found ourselves with one last problem: We are getting Unknown entity: exceptions everywhere. We are creating a SchemaExport and executing it before any migration thread starts. What are we missing?</p>\n"},{"tags":["spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13116893,"title":"How to handle Error/Exception on multiple database connections with spring and hibernate?","body":"<p><br/>\nI am using spring and hibernate to work on multiple database server save,update simultaneously using 2 datasource configuration.\nI am using</p>\n\n<pre><code>org.springframework.jdbc.datasource.DriverManagerDataSource\n</code></pre>\n\n<p>class for creating datasource.\nIf both the database server up/running then it's work fine.\nIf I close one of my database server and trying to catch the exception then it's not coming in catch block\nand the stack trace error displaying on my web browser.</p>\n\n<pre><code>Stack Trace:\n</code></pre>\n\n<pre>\n    ** BEGIN NESTED EXCEPTION **\n    java.net.ConnectException\n    MESSAGE: Connection refused: connect\nSTACKTRACE:\n\njava.net.ConnectException: Connection refused: connect\n    at java.net.PlainSocketImpl.socketConnect(Native Method)\n    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)\n    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)\n    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)\n    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)\n    at java.net.Socket.connect(Socket.java:525)\n    at java.net.Socket.connect(Socket.java:475)\n    at java.net.Socket.(Socket.java:372)\n    at java.net.Socket.(Socket.java:215)\n    at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:256)\n    at com.mysql.jdbc.MysqlIO.(MysqlIO.java:271)\n    at com.mysql.jdbc.Connection.createNewIO(Connection.java:2771)\n    at com.mysql.jdbc.Connection.(Connection.java:1555)\n    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:285)\n    at java.sql.DriverManager.getConnection(DriverManager.java:582)\n    at java.sql.DriverManager.getConnection(DriverManager.java:154)\n    at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:173)\n    at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:164)\n    at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:149)\n    at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:119)\n    at org.springframework.orm.hibernate3.LocalDataSourceConnectionProvider.getConnection(LocalDataSourceConnectionProvider.java:82)\n    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:116)\n    at org.hibernate.id.insert.AbstractSelectingDelegate.performInsert(AbstractSelectingDelegate.java:54)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2186)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2666)\n    at org.hibernate.action.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:71)\n    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n    at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:321)\n    at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:204)\n    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:130)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:210)\n    at org.hibernate.event.def.DefaultSaveEventListener.saveWithGeneratedOrRequestedId(DefaultSaveEventListener.java:56)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:195)\n    at org.hibernate.event.def.DefaultSaveEventListener.performSaveOrUpdate(DefaultSaveEventListener.java:50)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)\n    at org.hibernate.impl.SessionImpl.fireSave(SessionImpl.java:562)\n    at org.hibernate.impl.SessionImpl.save(SessionImpl.java:550)\n    at org.hibernate.impl.SessionImpl.save(SessionImpl.java:546)\n    at org.springframework.orm.hibernate3.HibernateTemplate$12.doInHibernate(HibernateTemplate.java:686)\n    at org.springframework.orm.hibernate3.HibernateTemplate$12.doInHibernate(HibernateTemplate.java:1)\n    at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:406)\n    at org.springframework.orm.hibernate3.HibernateTemplate.executeWithNativeSession(HibernateTemplate.java:374)\n    at org.springframework.orm.hibernate3.HibernateTemplate.save(HibernateTemplate.java:683)\n    at com.service.RegistrationServiceImpl.add(RegistrationServiceImpl.java:56)\n    at com.controller.RegistrationController.onSubmit(RegistrationController.java:48)\n    at org.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:272)\n    at org.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:268)\n    at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)\n    at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:763)\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:709)\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:613)\n    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:536)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:172)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:879)\n    at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n    at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n    at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n    at java.lang.Thread.run(Thread.java:619)\n\n\n** END NESTED EXCEPTION *\n</pre>\n\n<p>How can I handle this exception.\nI want to display in my GUI that one of my db server is down If any of my db server is down.</p>\n\n<p>Please help on this.</p>\n"},{"tags":["java","spring","hibernate","jpa-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13100536,"title":"Advice about spring transaction management redesign","body":"<p>I will try to describe the issue I'm trying to solve. I realized that an app that I've developed has a poorly implemented spring transaction management. I'm using declarative approach with transactions defined on DAO interface methods (CRUD), not on service layer methods. It's a web app that does some kind of message processing and multiple threads operate on the same message instance simultaneously. Here are the steps in a typical sequence:</p>\n\n<ol>\n<li>Message is created in T1 (transaction 1) and is put into outbound queue. T1 is terminated.</li>\n<li>Message is taken from the queue by a different thread, sent and updated with time of sending and some additional info. Properties of the message object are set and dao.update(m) is called, t2 starts.</li>\n<li>Before t2 commits, delivery report is received and Tread3 starts to process same message object by finding it in db (saved in step 1), updating it's state property and calling dao.upate(m) so t3 starts while t2 is still in progress. </li>\n<li>Another thread (thread 4) further process same message object by changing it's state again in t4.</li>\n</ol>\n\n<p>The result that occurs from time to time is that changes from t2 are lost and sending time is null in db. \nI need help in figuring out how to improve app design and eliminate this issue by preventing concurrent processing of the same message.</p>\n\n<ol>\n<li><p>Should I concentrate on transaction redesign (using it on service level instead of dao) and using the serializable isolation level(or other) or </p></li>\n<li><p>should i use JPA entity manager locking?</p></li>\n</ol>\n\n<p>App uses spring 3 and JPA2 with hibernate implementation.</p>\n"},{"tags":["hibernate","bidirectional-relation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13127561,"title":"How do I setup a bi-directional relationship in Hibernate (3.2)?","body":"<p>I'm having trouble setting up a bi-directional relationship in Hibernate (v 3.2.1.g a -- can't upgrade now).  I have an object, TrainingSession, which contains many TrainingLink objects.  So I have</p>\n\n<pre><code>@Entity\n@Table(name = \"cb_pd_training_session\",\n    uniqueConstraints = {@UniqueConstraint(columnNames={\"ORDER_NUMBER\"})}\n)\npublic class TrainingSession {\n...    \n    @OneToMany(cascade = CascadeType.ALL, mappedBy = \"trainingSession\")\n    private Set&lt;TrainingLink&gt; links;\n    …\n    public void addTrainingLink(final TrainingLink link)\n    {\n        if (this.links == null)\n        {\n            this.links = new HashSet&lt;TrainingLink&gt;();\n        }\n        link.setTrainingSessionId(this);\n        this.links.add(link);\n    }\n</code></pre>\n\n<p>and the child entity …</p>\n\n<pre><code>@Entity\n@Table(name = \"cb_training_link\",\n    uniqueConstraints = {@UniqueConstraint(columnNames={\"LINK\"})}\n)\npublic class TrainingLink {\n    …\n    @ManyToOne(fetch = FetchType.EAGER)\n    @JoinColumn(name = \"TRAINING_SESSION_ID\")\n    @NotNull\n    private TrainingSession trainingSession;\n</code></pre>\n\n<p>but when I try and create a parent object, add a child entity and save, I'm getting an error.  What else do I need to do to set this up properly?</p>\n\n<pre><code>org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:71)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:249)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:235)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:139)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java   298)\n    at org.hibernate.event.def.DefaultAutoFlushEventListener.onAutoFlush(DefaultAutoFlushEventListener.java:41)\n    at org.hibernate.impl.SessionImpl.autoFlushIfRequired(SessionImpl.java:969)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1562)\n    at org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:283)\n    at org.hibernate.impl.CriteriaImpl.uniqueResult(CriteriaImpl.java:305)\n    at org.mainco.subco.client.dao.myproject.AbstractHibernateDAO.findByUniqueConstraint(AbstractHibernateDAO.java:63)\n    at org.mainco.subco.client.dao.myproject.TrainingSessionDAOImpl.findByOrderNumber(TrainingSessionDAOImpl.java:18)\n    at org.mainco.subco.dao.TrainingSessionDAOTest.testSaveTrainingSessionTrainerAndLink(TrainingSessionDAOTest.java:76)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: java.sql.BatchUpdateException: Cannot add or update a child row: a foreign key constraint fails (`myproject`.`cb_training_link`, CONSTRAINT `FK1_CB_TRAINING_LINK` FOREIGN KEY (`TRAINING_SESSION_ID`) REFERENCES `CB_TRAINING_SESSION` (`ID`) ON DELETE CASCADE)\n    at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:2024)\n    at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:1449)\n    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:48)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:242)\n    ... 36 more\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`myproject`.`cb_training_link`, CONSTRAINT `FK1_CB_TRAINING_LINK` FOREIGN KEY (`TRAINING_SESSION_ID`) REFERENCES `CB_TRAINING_SESSION` (`ID`) ON DELETE CASCADE)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:407)\n    at com.mysql.jdbc.Util.getInstance(Util.java:382)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1039)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3603)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3535)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1989)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2150)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2626)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2119)\n    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2415)\n    at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1976)\n    ... 39 more\n</code></pre>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13094272,"title":"Hibernate Composite key with database generated timestamp","body":"<p>I'm having trouble saving an object with a composite primary key using Hibernate 3.3 and annotations. </p>\n\n<p>My key consists of a user's unique ID and a database generate Timestamp.</p>\n\n<p>How do I map this key using annotations? I've used some reverse engineering tools, but when I try to save the entity I run into problems.</p>\n\n<p>Example:</p>\n\n<pre><code>@Entity\n@Table(name = \"ACTIVITY_LOG\", schema = \"WEB\")\npublic class ActivityLog implements java.io.Serializable {\n\n    // Fields\n\n    private ActivityLogId id;\n    private SearchAuditRecord searchAuditRecord;\n\n    // Constructors\n\n         .....\n\n    // Property accessors\n    @EmbeddedId\n    @AttributeOverrides({\n        @AttributeOverride(name = \"identifier\", column = @Column(name = \"IDENTIFIER\", nullable = false, length = 11)),\n        @AttributeOverride(name = \"createTimestamp\", column = @Column(name = \"CREATE_TIMESTAMP\", insertable=false, updatable=false, nullable = false, length = 26)) })\n    public ActivityLogId getId() {\n    return this.id;\n    }\n\n    public void setId(ActivityLogId id) {\n    this.id = id;\n    }\n\n    .....\n\n}\n\n\n@Embeddable\npublic class ActivityLogId implements java.io.Serializable {\n\n    // Fields\n\n    private String identifier;\n    private Date createTimestamp;\n\n    // Constructors\n\n    /** default constructor */\npublic ActivityLogId() {\n    }\n\n    /** full constructor */\n    public ActivityLogId(String hrmisIdentifier, Date createTimestamp) {\n    this.identifier = identifier;\n    this.createTimestamp = createTimestamp;\n}\n\n// Property accessors\n\n    @Column(name = \"IDENTIFIER\", nullable = false, length = 11)\n    public String getIdentifier() {\n        return this.identifier;\n    }\n\n    public void setIdentifier(String identifier) {\n        this.identifier = identifier;\n    }\n\n\n    @Column(name = \"CREATE_TIMESTAMP\",insertable= false, updatable= false,  nullable = false, length = 26)\n    public Date getCreateTimestamp() {\n        return this.createTimestamp;\n    }\n\n    public void setCreateTimestamp(Timestamp createTimestamp) {\n        this.createTimestamp = createTimestamp;\n    }\n\n}\n</code></pre>\n\n<p>I figure I need to tell Hibernate that ActivityLogID.createTimestamp is being created by the Database... but I'm not sure how.</p>\n\n<p>As it stand right now, when I try to save theses objects I get:</p>\n\n<pre><code>org.hibernate.exception.ConstraintViolationException: \ncould not insert: [ca.gc.rcmp.persistence.ActivityLog]........ \nCaused by: com.ibm.db2.jcc.am.fo: DB2 SQL Error: SQLCODE=-407, SQLSTATE=23502, SQLERRMC= , DRIVER=3.57.82\n</code></pre>\n\n<p>Which is telling me I can't put a null into a Not-null column. CreateTimestamp is the only field in my entity that is null.</p>\n\n<p>Any advice would be greatly appreciated. </p>\n\n<p>Thanks!</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13128172,"title":"Multiple transaction managers, no session found","body":"<p>I need to have two transaction managers in my Spring application. I use them by annotating service classes by @Transactional(\"nameOfTxManager\"). Howewer, I am only able to use one of them - when I call some method of service class annotated with second transaction manager, I get \"org.hibernate.HibernateException: No Session found for current thread\" exception. Here is some code that reflects problem:</p>\n\n<p>1st service class:</p>\n\n<pre><code>@Transactional(\"txManagerHSQL\")\npublic class LocalSynchroServiceImpl extends SynchroServiceImpl implements LocalSynchroService {\n\n    public List&lt;Synchro&gt; findAll() {\n        return getDaoAgent().getSynchroDao().findAllLocal();\n    }\n}\n</code></pre>\n\n<p>2nd service class</p>\n\n<pre><code>@Transactional(\"txManagerMySQL\")\npublic class RemoteSynchroServiceImpl extends SynchroServiceImpl implements RemoteSynchroService {\n\n    public List&lt;Synchro&gt; findAll() {\n        return getDaoAgent().getSynchroDao().findAllRemote();\n    }\n}\n</code></pre>\n\n<p>Piece of configuration connected with transactions:</p>\n\n<pre><code>&lt;tx:annotation-driven /&gt;\n&lt;bean id=\"txManagerHSQL\" class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n     &lt;property name=\"sessionFactory\" ref=\"sessionFactoryHSQL\"/&gt;\n&lt;/bean&gt;\n&lt;bean id=\"txManagerMySQL\" class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n     &lt;property name=\"sessionFactory\" ref=\"sessionFactoryMySQL\"/&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>org.hibernate.HibernateException: No Session found for current thread\n    at org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)\n    at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:941)\n    at pl.mbrnwsk.clientsRegister.dao.DaoImpl.getCurrentSession(DaoImpl.java:75)\n</code></pre>\n\n<p>The annotation of 2nd service class is interpreted correctly, because when I change name of transaction manager to some random name, I get the exception that such bean was not found. And also, when I set name as @Transactional(\"txManagerHSQL\"), it works fine but with not the transaction manager I want.</p>\n"},{"tags":["hibernate","jpa","map","primary-key"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13127523,"title":"Issue with annotations for Primary Keys on Map<String, String>","body":"<p>The following code generates a table where there is a constraint for the PK using the fields \"Propriedade\" and \"doc_id\". </p>\n\n<p>I would like to know what is the most appropriate annotation that I can use to specify a PK?</p>\n\n<pre><code> public class Documento {\n        @Id\n        @GeneratedValue(strategy=GenerationType.SEQUENCE)\n        private long id;\n        private String numero;\n        private TipoDeMidia midia;\n        private String nomeDoArquivo;\n        @ElementCollection\n        @MapKeyColumn(name=\"propriedade\")\n    @Column(name=\"valor\")\n        @CollectionTable(name=\"DOCINFO\",joinColumns=@JoinColumn(name=\"doc_id\"))\n        private Map&lt;String,String&gt; informacoesDoDocumento= new HashMap&lt;String, String&gt;();\n</code></pre>\n\n<p>Here is the SQL generated</p>\n\n<pre><code>CREATE TABLE docinfo\n(\n  doc_id bigint NOT NULL,\n  valor character varying(255),\n  propriedade character varying(255) NOT NULL,\n  CONSTRAINT docinfo_pkey PRIMARY KEY (doc_id, propriedade),\n  CONSTRAINT fk97c919c6e3b42d44 FOREIGN KEY (doc_id)\n      REFERENCES documento (id) MATCH SIMPLE\n      ON UPDATE NO ACTION ON DELETE NO ACTION\n)\n</code></pre>\n"},{"tags":["eclipse","hibernate","import","gradle","sts-springsourcetoolsuite"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13109048,"title":"import hibernate-orm as gradle project in STS eclipse","body":"<p>Trying to import gradle project(hibernate-orm) in eclipse and get exception during build model:</p>\n\n<pre><code>org.gradle.api.GradleScriptException: A problem occurred evaluating project ':hibernate-core'.\nat org.gradle.groovy.scripts.internal.DefaultScriptRunnerFactory$ScriptRunnerImpl.run(DefaultScriptRunnerFactory.java:54)\nat org.gradle.configuration.DefaultScriptPluginFactory$ScriptPluginImpl.apply(DefaultScriptPluginFactory.java:127)\nat org.gradle.configuration.BuildScriptProcessor.evaluate(BuildScriptProcessor.java:38)\nat org.gradle.configuration.LifecycleProjectEvaluator.evaluate(LifecycleProjectEvaluator.java:43)\nat org.gradle.api.internal.project.AbstractProject.evaluate(AbstractProject.java:463)\nat org.gradle.api.internal.project.AbstractProject.evaluate(AbstractProject.java:75)\nat org.gradle.configuration.ProjectEvaluationConfigurer.execute(ProjectEvaluationConfigurer.java:23)\nat org.gradle.configuration.ProjectEvaluationConfigurer.execute(ProjectEvaluationConfigurer.java:21)\nat org.gradle.configuration.DefaultBuildConfigurer$1.execute(DefaultBuildConfigurer.java:38)\nat org.gradle.configuration.DefaultBuildConfigurer$1.execute(DefaultBuildConfigurer.java:35)\nat org.gradle.api.internal.project.AbstractProject.configure(AbstractProject.java:439)\nat org.gradle.api.internal.project.AbstractProject.allprojects(AbstractProject.java:434)\nat org.gradle.configuration.DefaultBuildConfigurer.configure(DefaultBuildConfigurer.java:35)\nat org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:139)\nat org.gradle.initialization.DefaultGradleLauncher.doBuild(DefaultGradleLauncher.java:110)\nat org.gradle.initialization.DefaultGradleLauncher.getBuildAnalysis(DefaultGradleLauncher.java:89)\nat org.gradle.tooling.internal.provider.BuildModelAction.run(BuildModelAction.java:48)\nat org.gradle.tooling.internal.provider.DelegatingBuildModelAction.run(DelegatingBuildModelAction.java:42)\nat org.gradle.tooling.internal.provider.ConfiguringBuildAction.run(ConfiguringBuildAction.java:94)\nat org.gradle.launcher.exec.InProcessGradleLauncherActionExecuter.execute(InProcessGradleLauncherActionExecuter.java:39)\nat org.gradle.launcher.daemon.server.exec.ExecuteBuild.doBuild(ExecuteBuild.java:45)\nat org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.WatchForDisconnection.execute(WatchForDisconnection.java:45)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.ResetDeprecationLogger.execute(ResetDeprecationLogger.java:24)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.StartStopIfBuildAndStop.execute(StartStopIfBuildAndStop.java:28)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.ReturnResult.execute(ReturnResult.java:34)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.ForwardClientInput$4.call(ForwardClientInput.java:116)\nat org.gradle.launcher.daemon.server.exec.ForwardClientInput$4.call(ForwardClientInput.java:114)\nat org.gradle.util.Swapper.swap(Swapper.java:38)\nat org.gradle.launcher.daemon.server.exec.ForwardClientInput.execute(ForwardClientInput.java:114)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.LogToClient.doBuild(LogToClient.java:60)\nat org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.EstablishBuildEnvironment.doBuild(EstablishBuildEnvironment.java:61)\nat org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.StartBuildOrRespondWithBusy.doBuild(StartBuildOrRespondWithBusy.java:48)\nat org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:34)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.HandleStop.execute(HandleStop.java:34)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.CatchAndForwardDaemonFailure.execute(CatchAndForwardDaemonFailure.java:32)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.HandleClientDisconnectBeforeSendingCommand.execute(HandleClientDisconnectBeforeSendingCommand.java:21)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.StopConnectionAfterExecution.execute(StopConnectionAfterExecution.java:27)\nat org.gradle.launcher.daemon.server.exec.DaemonCommandExecution.proceed(DaemonCommandExecution.java:121)\nat org.gradle.launcher.daemon.server.exec.DefaultDaemonCommandExecuter.executeCommand(DefaultDaemonCommandExecuter.java:54)\nat org.gradle.launcher.daemon.server.Daemon$1$1.run(Daemon.java:123)\nat org.gradle.internal.concurrent.DefaultExecutorFactory$StoppableExecutorImpl$1.run(DefaultExecutorFactory.java:66)\n Caused by: org.gradle.api.plugins.PluginInstantiationException: Could not create plugin of type 'MatrixTestingPlugin'.\nat org.gradle.api.internal.plugins.DefaultPluginRegistry.loadPlugin(DefaultPluginRegistry.java:68)\nat org.gradle.api.internal.plugins.DefaultPluginRegistry.loadPlugin(DefaultPluginRegistry.java:54)\nat org.gradle.api.internal.plugins.DefaultProjectsPluginContainer.providePlugin(DefaultProjectsPluginContainer.java:106)\nat org.gradle.api.internal.plugins.DefaultProjectsPluginContainer.addPluginInternal(DefaultProjectsPluginContainer.java:71)\nat org.gradle.api.internal.plugins.DefaultProjectsPluginContainer.apply(DefaultProjectsPluginContainer.java:41)\nat org.gradle.api.internal.plugins.DefaultObjectConfigurationAction.applyPlugin(DefaultObjectConfigurationAction.java:90)\nat org.gradle.api.internal.plugins.DefaultObjectConfigurationAction.access$100(DefaultObjectConfigurationAction.java:32)\nat org.gradle.api.internal.plugins.DefaultObjectConfigurationAction$2.run(DefaultObjectConfigurationAction.java:63)\nat org.gradle.api.internal.plugins.DefaultObjectConfigurationAction.execute(DefaultObjectConfigurationAction.java:114)\nat org.gradle.api.internal.project.AbstractProject.apply(AbstractProject.java:841)\nat org.gradle.api.Project$apply.call(Unknown Source)\nat org.gradle.api.internal.project.ProjectScript.apply(ProjectScript.groovy:34)\nat org.gradle.api.Script$apply.callCurrent(Unknown Source)\nat hibernate_core_7q7cqc9dhu87lh08q18h1n9i8.run(/home/user/development/linux/hibernate-workspace/hibernate-orm/hibernate-core/hibernate-core.gradle:3)\nat org.gradle.groovy.scripts.internal.DefaultScriptRunnerFactory$ScriptRunnerImpl.run(DefaultScriptRunnerFactory.java:52)\n... 55 more\n Caused by: java.lang.NullPointerException\nat org.hibernate.build.gradle.util.Jdk.&lt;init&gt;(Jdk.java:64)\nat org.hibernate.build.gradle.util.Jdk.&lt;init&gt;(Jdk.java:52)\nat org.hibernate.build.gradle.testing.matrix.MatrixTestingPlugin.&lt;init&gt;(MatrixTestingPlugin.groovy:65)\nat org.gradle.api.internal.plugins.DefaultPluginRegistry.loadPlugin(DefaultPluginRegistry.java:63)\n... 69 more\n</code></pre>\n\n<p>How to fix this exception? I'm using gradle eclipse plugin. The same problem appears then i import project as eclipse project(successfully) and try to add Gradle support after that.</p>\n\n<p><ul>\n<li>What went wrong:\nA problem occurred evaluating project ':hibernate-core'.</p>\n\n<blockquote>\n  <p>Could not create plugin of type 'MatrixTestingPlugin'.</li>\n  </ul></p>\n</blockquote>\n"},{"tags":["mysql","hibernate","caching","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13122861,"title":"Hibernate JPA+mysql: can not disable caching in createNativeQuery","body":"<p>I am using Hibernate/JPA with mySQL, and because of legacy reasons createNativeQuery at one point. The application works with different servers using the same database, so it should do no caching at all but always show the most recent result. I simulate other servers by changing a value manually in a database-editor, but after a change it always gives old results.</p>\n\n<p>As far as I know I should disable any 2nd level caching (not very important because I do not use any ORM-objects), clear() any 1st level caching, and disable mysql query caching (is already done on database level). Where do I fail, or what do I forget? It drives me crazy.</p>\n\n<p>init(): start of the servlet</p>\n\n<pre><code>    entityFactory = Persistence.createEntityManagerFactory(\"persistence-id\");\n</code></pre>\n\n<p>getEntityManager(): start of each request</p>\n\n<pre><code>    destroyEntityManager(); // just in case\n    entityFactory.getCache().evictAll();\n    entityManager = entityFactory.createEntityManager();\n    entityManager.setProperty(\"javax.persistence.cache.storeMode\",\n            CacheStoreMode.BYPASS);\n    entityManager.clear(); // just in case\n</code></pre>\n\n<p>destroyEntityManager(): end of each request</p>\n\n<pre><code>    if (entityManager != null) {\n        if (entityManager.getTransaction().isActive()) {\n            entityManager.flush();\n            entityManager.getTransaction().commit();\n        }\n        entityManager.clear();\n        if (entityManager.isOpen()) {\n            entityManager.close();\n        }\n        entityManager = null;\n    }\n</code></pre>\n\n<p>destroy(): end of servlet</p>\n\n<pre><code>    destroyEntityManager();\n    if (entityFactory != null) {\n        entityFactory.close();\n    }\n</code></pre>\n\n<p>persistence.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence\nhttp://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\" version=\"1.0\"&gt;\n&lt;persistence-unit name=\"WallMountBackOffice-PU\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;class&gt;...&lt;/class&gt;\n    &lt;class&gt;...&lt;/class&gt;\n    &lt;properties&gt;\n        &lt;property name=\"hibernate.connection.driver_class\" value=\"com.mysql.jdbc.Driver\" /&gt;\n        &lt;property name=\"hibernate.connection.url\" value=\"jdbc:mysql://localhost/ourschema\" /&gt;\n        &lt;property name=\"hibernate.connection.username\" value=\"root\" /&gt;\n        &lt;property name=\"hibernate.connection.password\" value=\"\" /&gt;\n        &lt;property name=\"hibernate.connection.pool_size\" value=\"10\" /&gt;\n        &lt;property name=\"hibernate.connection.autocommit\" value=\"false\" /&gt;\n        &lt;property name=\"hibernate.connection.release_mode\" value=\"on_close\" /&gt;\n        &lt;property name=\"dialect\" value=\"org.hibernate.dialect.MySQLDialect\" /&gt;\n        &lt;property name=\"hibernate.cache.use_second_level_cache\"\n            value=\"false\" /&gt;\n        &lt;property name=\"hibernate.cache.use_query_cache\" value=\"false\" /&gt;\n        &lt;property name=\"javax.persistence.sharedCache.mode\" value=\"NONE\" /&gt;\n        &lt;property name=\"org.hibernate.cacheable\" value=\"false\" /&gt;\n    &lt;/properties&gt;\n&lt;/persistence-unit&gt;\n</code></pre>\n\n<p></p>\n\n<p>The code which does the 'select ...':</p>\n\n<pre><code>    ...\n    Query jpaQuery = entityManager.createQuery(query);\n    entityManager.getTransaction().begin();\n    jpaQuery.executeUpdate();\n    entityManager.getTransaction().commit();\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6838,"score":1,"question_id":1618925,"title":"Hibernate Exception, what wrong ? [[Exception in thread \"main\" org.hibernate.InvalidMappingException: Could not parse mapping document from resource hibernate/Tbluser.hbm.xml]]","body":"<p>I use netbean 6.7.1 to write \"hello world\" witch hibernate, but I get some errors, plz help me, thank you very much.</p>\n\n<p><strong>my exception</strong></p>\n\n<pre><code>init:\ndeps-module-jar:\ndeps-ear-jar:\ndeps-jar:\nCopying 1 file to F:\\Documents and Settings\\My Dropbox\\DropboxNetBeanProjects\\loginspring\\build\\web\\WEB-INF\\classes\ncompile-single:\nrun-main:\nOct 25, 2009 2:44:05 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: Hibernate 3.2.5\nOct 25, 2009 2:44:05 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: hibernate.properties not found\nOct 25, 2009 2:44:05 AM org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: Bytecode provider name : cglib\nOct 25, 2009 2:44:05 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: using JDK 1.4 java.sql.Timestamp handling\nOct 25, 2009 2:44:05 AM org.hibernate.cfg.Configuration configure\nINFO: configuring from resource: /hibernate.cfg.xml\nOct 25, 2009 2:44:05 AM org.hibernate.cfg.Configuration getConfigurationInputStream\nINFO: Configuration resource: /hibernate.cfg.xml\nOct 25, 2009 2:44:06 AM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : hibernate/Tbluser.hbm.xml\nOct 25, 2009 2:44:06 AM org.hibernate.util.XMLHelper$ErrorLogger error\nSEVERE: Error parsing XML: XML InputStream(1) Document is invalid: no grammar found.\nOct 25, 2009 2:44:06 AM org.hibernate.util.XMLHelper$ErrorLogger error\nSEVERE: Error parsing XML: XML InputStream(1) Document root element \"hibernate-mapping\", must match DOCTYPE root \"null\".\nException in thread \"main\" org.hibernate.InvalidMappingException: Could not parse mapping document from resource hibernate/Tbluser.hbm.xml\n        at org.hibernate.cfg.Configuration.addResource(Configuration.java:569)\n        at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:1587)\n        at org.hibernate.cfg.Configuration.parseSessionFactory(Configuration.java:1555)\n        at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:1534)\n        at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:1508)\n        at org.hibernate.cfg.Configuration.configure(Configuration.java:1428)\n        at org.hibernate.cfg.Configuration.configure(Configuration.java:1414)\n        at hibernate.CreateTest.main(CreateTest.java:22)\nCaused by: org.hibernate.InvalidMappingException: Could not parse mapping document from invalid mapping\n        at org.hibernate.cfg.Configuration.addInputStream(Configuration.java:502)\n        at org.hibernate.cfg.Configuration.addResource(Configuration.java:566)\n        ... 7 more\nCaused by: org.xml.sax.SAXParseException: Document is invalid: no grammar found.\n        at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:195)\n        at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:131)\n        at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:384)\n        at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:318)\n        at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:250)\n        at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(XMLNSDocumentScannerImpl.java:626)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:3095)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:921)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n        at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:140)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:807)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n        at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:107)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n        at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n        at org.dom4j.io.SAXReader.read(SAXReader.java:465)\n        at org.hibernate.cfg.Configuration.addInputStream(Configuration.java:499)\n        ... 8 more\nJava Result: 1\nBUILD SUCCESSFUL (total time: 1 second)\n</code></pre>\n\n<p><strong>hibernate.cfg.xml</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/hibernate&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p><strong>Tbluser.hbm.xml</strong></p>\n\n<pre><code> &lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Oct 25, 2009 2:37:30 AM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"hibernate.Tbluser\" table=\"tbluser\" catalog=\"hibernate\"&gt;\n        &lt;id name=\"userId\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"userID\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"username\" type=\"string\"&gt;\n            &lt;column name=\"username\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"password\" type=\"string\"&gt;\n            &lt;column name=\"password\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"email\" type=\"string\"&gt;\n            &lt;column name=\"email\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"phone\" type=\"string\"&gt;\n            &lt;column name=\"phone\" length=\"50\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"groupId\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"groupID\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p><strong>Tbluser.java</strong></p>\n\n<pre><code>  package hibernate;\n// Generated Oct 25, 2009 2:37:30 AM by Hibernate Tools 3.2.1.GA\n\n\n\n    /**\n     * Tbluser generated by hbm2java\n     */\n    public class Tbluser  implements java.io.Serializable {\n\n\n         private Integer userId;\n         private String username;\n         private String password;\n         private String email;\n         private String phone;\n         private Integer groupId;\n\n        public Tbluser() {\n        }\n\n        public Tbluser(String username, String password, String email, String phone, Integer groupId) {\n           this.username = username;\n           this.password = password;\n           this.email = email;\n           this.phone = phone;\n           this.groupId = groupId;\n        }\n\n        public Integer getUserId() {\n            return this.userId;\n        }\n\n        public void setUserId(Integer userId) {\n            this.userId = userId;\n        }\n        public String getUsername() {\n            return this.username;\n        }\n\n        public void setUsername(String username) {\n            this.username = username;\n        }\n        public String getPassword() {\n            return this.password;\n        }\n\n        public void setPassword(String password) {\n            this.password = password;\n        }\n        public String getEmail() {\n            return this.email;\n        }\n\n        public void setEmail(String email) {\n            this.email = email;\n        }\n        public String getPhone() {\n            return this.phone;\n        }\n\n        public void setPhone(String phone) {\n            this.phone = phone;\n        }\n        public Integer getGroupId() {\n            return this.groupId;\n        }\n\n        public void setGroupId(Integer groupId) {\n            this.groupId = groupId;\n        }\n\n\n}\n</code></pre>\n"},{"tags":["java","hibernate","jpa","fluent-nhibernate","hibernate-entitymanager"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13125809,"title":"How to commit and rollback data after getEntityManager.perist(object)","body":"<p>Now I am using jpa with hibernate , when i was done getEntityManager.persist(objects) then i will ask for user confirmation like continue and rollback using user interface</p>\n\n<pre><code>private List&lt;TempCustomers&gt; tempCustomer =new ArrayList&lt;TempCustomers&gt;();\n\n @Begin(join = true)\n    public String migrateData() {\n\n    log.info(\"Mobee Migrate Customer Size  :\"+doTempCustomers.size());\n\n\n\n\n            for(DoTempCustomers tempCustomers:doTempCustomers){\n            try {\n\n                TempCustomers temp=new TempCustomers();\n                BeanUtils.copyProperties(temp, tempCustomers);\n\n\n                tempCustomer.add(temp);\n                getEntityManager().persist(temp);\n\n            }catch (Exception e) {\n                // TODO: handle exception\n                return \"null\";\n            }\n\n             }\n            log.info(\"Size.........\"+tempCustomer.size());\n            return \"null\";\n    }\n\n@Begin(join = true)\n    public String updatedData(){\n         log.info(\"Size of Customers :\"+tempCustomer.size());\n         log.info(\"Decision ...\"+decision);\n\n        try{    \n       if(decision.equals(\"Continue\")){\n        for(TempCustomers tempCust:tempCustomer){\n\n            TempCustomers temp=new TempCustomers();\n            BeanUtils.copyProperties(temp, tempCust);   \n\n            log.info(\"updated Sucessfully\");\n\n           getEntityManager().getTransaction().commit();\n\n       }}else{\n           getEntityManager().getTransaction().rollback();\n\n        }\n        }\n        catch(Exception e){\n\n        }\n}\n</code></pre>\n\n<p>please help me how to do continue and rollback in jpa with hibernate when getEntityManager().persist() is done.</p>\n"},{"tags":["java","query","hibernate","map","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13056216,"title":"Using HQL to search in a Map","body":"<p>I have a Java class (let's call it BigClass) which has a Map as attribute (Map&lt; MyClass, Integer >), what I would like to do is to make an HQL query to filter this classes depending on the values of this map.</p>\n\n<p>In fact, what I would like to do is to recover all instances (b) of BigClass which satisfy for a specific instance (m) of MyClass b.map.get(m) > 0.</p>\n\n<p>For example: I would like to recover an instance of BigClass, if its map has an entry like &lt; m, 2 >, and I would't like to recover an instance of BigClass if its map has an entry like &lt; m, 0 > or if m doesn't belong to the map keys.</p>\n\n<p>I've been searching and I found this post related to my problem:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10804664/using-hql-to-query-on-a-maps-values\">Using HQL to query on a Map&#39;s Values</a></p>\n\n<p>Although, it didn't give me a solution.</p>\n\n<hr>\n\n<p>These are some queries I've been trying with no success:</p>\n\n<pre><code>org.hibernate.QueryException: No index value! \n[SELECT e FROM BigClass e WHERE ( map[(SELECT b FROM MyClass b WHERE b.id = ?)] &gt; 0) ]\n\norg.hibernate.QueryException: No index value! \n[SELECT e FROM BigClass e WHERE ( index(map) = (SELECT b FROM MyClass b WHERE b.id = ?) ) &gt; 0) ]\n</code></pre>\n\n<p>Thanks in advance...</p>\n"},{"tags":["hibernate","jpa","xml-parsing","persistence.xml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":12473748,"title":"JPA2 Extract info from a persistence.xml","body":"<p>I work with JPA2 and I use a multiple persistence unit configuration that is represented in my persistence.xml, like this: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"2.0\"&gt;                           \n  &lt;persistence-unit name=\"FirstPU\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;class&gt;entities.Book&lt;/class&gt;\n    &lt;properties&gt;        \n      &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.PostgreSQLDialect\"/&gt;\n      ...\n    &lt;/properties&gt;\n  &lt;/persistence-unit&gt;  \n  &lt;persistence-unit name=\"SecondPU\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;class&gt;entities.Book&lt;/class&gt;\n    &lt;properties&gt;        \n      &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.PostgreSQLDialect\"/&gt;\n      ...\n    &lt;/properties&gt;\n  &lt;/persistence-unit&gt;  \n&lt;/persistence&gt;\n</code></pre>\n\n<p>Is there any method to extract persistence unit names from persistence.xml programmatically (using Hibernate or JPA2)? Like this:</p>\n\n<pre><code>EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"manager1\");\n\n// or\n\nMap&lt;String, Object&gt; configOverrides = new HashMap&lt;String, Object&gt;();\nconfigOverrides.put(\"hibernate.hbm2ddl.auto\", \"create-drop\");\nEntityManagerFactory programmaticEmf =\n    Persistence.createEntityManagerFactory(\"manager1\", configOverrides);\n</code></pre>\n\n<p>But I need to <strong>read</strong> not only properties. </p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13123076,"title":"Unique Constraint for Set<String> with Hibernate","body":"<p>I'm having an Entity that contains a Set like the following:</p>\n\n<pre><code>@ElementCollection\nSet&lt;String&gt; branches;\n</code></pre>\n\n<p>Now what Hibernate does, is creating a table <code>project_branches</code> (project_id | branches) and adding a unique constraint on <code>branches</code>. Is there any way to tell hibernate that the unique constraint should involve both, <code>project_id</code> <strong>and</strong> <code>branches</code>?</p>\n\n<p>I could not find an answer to this question, though I think I'm not the first with this problem... Thanks</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":649,"score":0,"question_id":7634638,"title":"Hibernate throws SQLException Could not reset reader","body":"<pre><code>java.sql.SQLException: could not reset reader\n        at org.hibernate.lob.ClobImpl.getCharacterStream(ClobImpl.java:100)\n        at org.hibernate.type.ClobType.set(ClobType.java:70)\n        at org.hibernate.type.ClobType.nullSafeSet(ClobType.java:141)\n        at org.hibernate.persister.entity.AbstractEntityPersister.dehydrate(AbstractEntityPersister.java:2025)\n        at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2271)\n        at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2688)\n        at org.hibernate.action.EntityInsertAction.execute(EntityInsertAction.java:79)\n        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\n        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:167)\n        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\n        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)\n</code></pre>\n\n<p>Hi,</p>\n\n<p>Above is the stack trace.\nIt is working with small amount of data but fails with large data.\nI cant figure out what could be the problem?</p>\n\n<p>Regards,\nPreet</p>\n"},{"tags":["java","hibernate","oracle11g","hibernate-mapping","database-locking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13123601,"title":"Hibernate delete/insert database blocking lock","body":"<p>We are using <code>Hibernate 3.6.1.FINAL</code> against <code>Oracle 11g</code>.  </p>\n\n<p>We are experiencing blocking locks in our database that I believe is caused by an unexpected side-effect of Hibernate. </p>\n\n<p>This is a critical issue we need to resolve, as the database blocking locks quickly snowball and transactions begin timing out, causing a production outage.</p>\n\n<p><strong>I am trying to figure out if there is a certain scenario in which Hibernate can do a behind-the-scenes delete and re-insert of a collection of children, or some way that it could cause blocking locks on a delete/insert.</strong></p>\n\n<p>I'm looking for ideas/suggestions/insight about possible causes, not necessarily an exact answer.</p>\n\n<p>I've isolated the entities involved and their mappings.  Unfortunately due to the fact that we have a huge legacy system with tons of code, I had to come up with a simplified example:</p>\n\n<p><strong>Parent.hbm.xml</strong></p>\n\n<pre><code>// Parent has a unique ID generated with a Sequence,\n// an index column called ORD, and a Version column called UPDATE_COUNTER.\n&lt;!-- bi-directional one-to-many association to Child --&gt;\n&lt;bag\n    name=\"children\"\n    lazy=\"false\"\n    inverse=\"true\"\n    cascade=\"all-delete-orphan\"\n    order-by=\"ord asc\"&gt;\n    &lt;key column=\"PARENT_ID\" /&gt;\n    &lt;one-to-many class=\"Child\" /&gt;\n&lt;/bag&gt;\n</code></pre>\n\n<p><strong>Child.hbm.xml</strong></p>\n\n<pre><code>// Child has a unique ID generated with a Sequence, \n// and a Version column called UPDATE_COUNTER.\n&lt;!-- bi-directional many-to-one association to Parent --&gt;\n&lt;many-to-one\n    name=\"parent\"\n    class=\"Parent\"\n    not-null=\"true\"\n&gt;\n    &lt;column name=\"PARENT_ID\" /&gt;\n&lt;/many-to-one&gt;\n</code></pre>\n\n<p>Our DBAs have reported that they see the following:</p>\n\n<p>The Blocked SQL: </p>\n\n<pre><code>insert into CHILD (UPDATE_COUNTER, ORD, PARENT_ID, ID) values (:1 , :2 , :3 , :4)\n</code></pre>\n\n<p>The Blocking SQL: </p>\n\n<pre><code>delete from CHILD where ID=:1  and UPDATE_COUNTER=:2\n</code></pre>\n\n<p>Here's what I've tried thus far:</p>\n\n<ol>\n<li><p>Did a full audit of our codebase, established that there is nowhere where we delete and insert a row with the same primary key.  All of our INSERT for Child is done with ID set to null, in which case the Sequence will generate the Unique ID.</p></li>\n<li><p>Turned on show_sql.  Also, DBAs set up a trigger on Child to capture all DML activity so we could get the bind variables in development.  </p>\n\n<p>I found the following articles saying that Hibernate could do delete all then re-insert for bags and lists:</p>\n\n<p><a href=\"http://assarconsulting.blogspot.com/2009/08/why-hibernate-does-delete-all-then-re.html\" rel=\"nofollow\">Why Hibernate does \"Delete all then re-insert\"</a></p>\n\n<p><a href=\"http://dannylesnik.blogspot.com/2010/10/hibernate-set-map-bag-list-differences.html\" rel=\"nofollow\">Hibernate - set, map, bag &amp; list differences</a></p>\n\n<p>However, I determined that this is not occurring.  I wrote test code that removes one of the Child objects in the middle (ORD=5 with a collection of 10 children that had ORD=0 through ORD=9) and then saved Parent.  </p>\n\n<p>I saw in the DML activity table that a delete was issued for the removed Child and UPDATE was done for the remaining 9 children that set their ORD to the correct value.  </p></li>\n</ol>\n\n<p>As I mentioned, I'm not looking for an exact answer.  I would just be tremendously grateful if anyone who has a lot of experience with Hibernate could lend any insight or suggestions as to additional paths or avenues I could run down. </p>\n\n<p>Thank you very much in advance. </p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13121839,"title":"ConstraintViolationException Duplicate entry when using @EmbeddedId","body":"<p>i have the following entities:</p>\n\n<p><strong>1- ADDRESS</strong></p>\n\n<pre><code>@Entity\n@Table(name = \"Address\")\npublic class Address implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    @EmbeddedId\n    private AddressPK id = new AddressPK();\n\n               @OneToOne(mappedBy = \"address\")\n    private Insurance_Detail insuranceDetail;\n\n}\n</code></pre>\n\n<p><strong>2- ADDRESSPK</strong></p>\n\n<pre><code>@Embeddable\npublic class AddressPK implements Serializable\n{\n    // default serial version id, required for serializable classes.\n    private static final long serialVersionUID = 1L;\n\n    @Column(unique = false, nullable = false, length = 45)\n    private String customer_EmailAddress;\n\n    @Column(unique = true, nullable = false)\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private int address_Id;\n\n}\n</code></pre>\n\n<p>3- <strong>Insurance_Detail</strong> </p>\n\n<pre><code>@Entity\n@Table(name = \"Insurance_Detail\")\npublic class Insurance_Detail implements Serializable\n{\n    private static final long serialVersionUID = 1L;\n\n    @EmbeddedId\n    private AddressPK id;\n\n    @OneToOne\n@JoinColumns({\n        @JoinColumn(name = \"customer_EmailAddress\", referencedColumnName = \"customer_EmailAddress\", nullable = false, insertable = false, updatable = false),\n        @JoinColumn(name = \"address_Id\", referencedColumnName = \"address_Id\", nullable = false, insertable = false, updatable = false) })\n\n\n\n}\n</code></pre>\n\n<p><strong>4- Persisting the address object</strong> is as follows:</p>\n\n<pre><code>Address address= new Address(data1,data2);\n\naddress.getId().setCustomer_EmailAddress(\n                    currentCustomer.getEmailAddress());\n\nentityManager.persist(address);\n</code></pre>\n\n<p><strong>5- Persisting the insurance details</strong> object is as follows:</p>\n\n<pre><code>Insurance_Detail insuranceDetail = new Insurance_Detail(address.getId(), data3,data4);\nentityManager.persist(insuranceDetail);\n</code></pre>\n\n<p>and it's saved correctly with no problems.</p>\n\n<p><strong>ISSUE:</strong> when trying to <strong>persist</strong> the <strong>Insurance_Detail</strong> object, in first insertion for an insurance, it's persisted successfully, but in second insertion for another insurance i am getting the following exception.</p>\n\n<pre><code>javax.servlet.ServletException: org.springframework.orm.jpa.JpaSystemException: org.hibernate.exception.ConstraintViolationException: Duplicate entry 'test@msn.com' for key 'customer_EmailAddress'; nested exception is javax.persistence.PersistenceException: org.hibernate.exception.ConstraintViolationException: Duplicate entry 'test@msn.com' for key 'customer_EmailAddress'\n    javax.faces.webapp.FacesServlet.service(FacesServlet.java:606)\n    org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330)\n    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118)\n    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:103)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:183)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)\n    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)\n    org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192)\n    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160)\n    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)\n    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)\n</code></pre>\n\n<p>please advise how to fix this exception.</p>\n"},{"tags":["hibernate","session","grails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13123267,"title":"grails hibernate session in taglib","body":"<p>I have a taglib that have to use a domain class which have a collection that is lazily initialized. So, when I try to access it Hibernate throws an exception.<br>\nI've tried to access it with the methods: <em>DomainClass.withSession</em> and <em>DomainClass.withTransaction</em> but it doesn't works.<br>\nWhich is the better way to avoid this problem?<br>\nDo I have to use the session factory inside the taglib? (I don't like this way very much)<br>\nLast question, how Grails manage the Hibernate session? It is open just during the controllers execution?</p>\n\n<p>Cheers</p>\n"},{"tags":["spring","hibernate","transactions"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13087928,"title":"Spring Hibernate transaction management","body":"<p>I have just started making a project using spring and hibernate. My DAO layer class extends HibernateDaoSupport. We are not using annotations. \nEarlier, we were using struts, hence we used getTransaction, commit, roolback.. methods provided by Session object.\nMy requirement is very simple, for all DAO classes, if there is an exception, rollback otherwise commit. Please suggest a simplest way of introducing spring transaction management. </p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13080830,"title":"Incorrect string value: '\\xE5\\x8F\\x96\\xE3\\x82\\x8A...' for column","body":"<p>getting follwing error while trying to saving data. I am trying to store Japanese language string the column so I tried updating the collation of table to <strong>COLLATE = ujis_japanese_ci</strong> and <strong>UTF-8</strong> but still not effect.</p>\n\n<pre><code>Caused by: java.sql.BatchUpdateException: Incorrect string value: '\\xE5\\x8F\\x96\\xE3\\x82\\x8A...' for column 'BIDDERRESTRICTION' at row 1\n    at com.mysql.jdbc.ServerPreparedStatement.executeBatch(ServerPreparedStatement.java:647)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:57)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:174)\n    ... 34 more\n2012-10-25 17:26:29 [action] [ERROR] Servlet.service() for servlet action threw exception\njava.sql.BatchUpdateException: Incorrect string value: '\\xE5\\x8F\\x96\\xE3\\x82\\x8A...' for column 'BIDDERRESTRICTION' at row 1\n    at com.mysql.jdbc.ServerPreparedStatement.executeBatch(ServerPreparedStatement.java:647)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:57)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:174)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:226)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:137)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:274)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:730)\n    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:324)\n    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:86)\n    at net.startbahn.web.app.PostAuctionVPAction.execute(PostAuctionVPAction.java:175)\n    at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:421)\n    at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:226)\n    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1164)\n    at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:415)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at net.startbahn.filters.PrivilegeManageFilter.doFilter(PrivilegeManageFilter.java:112)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at net.startbahn.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:121)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:172)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:879)\n    at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n    at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n    at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n    at java.lang.Thread.run(Thread.java:722)\n</code></pre>\n\n<h1><strong>Solution:</strong></h1>\n\n<p>Setting collation of table as well as all its fields to <strong>utf8-utf8_bin</strong> did the trick for me.</p>\n"},{"tags":["java","mysql","hibernate","struts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13066423,"title":"Always getting JDBC batch update error","body":"<p>I am new to hibernate and I am working on an application that is using MySQl, Hibernate and Struts. I am always getting following error for given code. I did google for this error but those threads did not helped.</p>\n\n<p><strong>Error</strong></p>\n\n<pre><code>javax.servlet.ServletException: Could not execute JDBC batch update\n    at org.apache.struts.action.RequestProcessor.processException(RequestProcessor.java:516)\n    ....\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Session session = new HibernateSession().currentSession(this.getServlet().getServletContext());\n        if(auctionform.getId() == null || auctionform.getId().intValue() == 0){\n            auction.setId(null);\n            auctionform.setId(null);\n        }else{\n            auction.setId(auctionform.getId());\n            Criteria criteria = session.createCriteria(Auction.class);\n            criteria.add(Restrictions.idEq(Integer.valueOf(req.getParameter(\"id\"))));\n            auction = (Auction) criteria.uniqueResult();\n\n        }\n\n        Boolean isAuctionActive = false;\n        Calendar currentDate = Calendar.getInstance();\n        SimpleDateFormat formatter= new SimpleDateFormat(\"yyyy/MM/dd HH:mm:ss\");\n\n        Date auctionEndingDate = DateUtils.getDate(req, \"auctionenddate\");\n        Date todaysDate = formatter.parse(formatter.format(currentDate.getTime()));\n\n        if(auctionEndingDate.after(todaysDate)){\n            isAuctionActive = true;\n        }\n\n        auction.setDescription(auctionform.getDescription());\n        auction.setDate(auctionform.getDate());\n        auction.setCurrentprice(auctionform.getCurrentprice());\n        ....some code\n\n        Attachment attachment1 = AttachmentUtils.saveAttachment(auctionform, session, auction, 0);\n        Attachment attachment2 = AttachmentUtils.saveAttachment(auctionform, session, auction, 1);\n        Attachment attachment3 = AttachmentUtils.saveAttachment(auctionform, session, auction, 2);\n\n\n        Transaction transaction = session.beginTransaction();\n        if(attachment1!=null){\n            session.save(attachment1.getDbFile());\n            session.save(attachment1.getThmnailDbFile());\n            session.save(attachment1);\n            auction.setFirstimage(attachment1);\n        }\n        if(attachment2!=null){\n            session.save(attachment2.getDbFile());\n            session.save(attachment2.getThmnailDbFile());\n            session.save(attachment2);\n            auction.setSecoundimage(attachment2);\n        }\n        if(attachment3 != null){\n            session.save(attachment3.getDbFile());\n            session.save(attachment3.getThmnailDbFile());\n            session.save(attachment3);\n            auction.setSignimage(attachment3);\n        }\n\n        session.saveOrUpdate(auction);\n        transaction.commit();\n        session.flush();\n</code></pre>\n\n<p>I am always getting this error at <code>transaction.commit()</code> line. I am not getting what is going wrong.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I setup log4j and complete stacktrace is as below.</p>\n\n<p><strong>Complete stacktrace</strong></p>\n\n<pre><code>Caused by: java.sql.BatchUpdateException: Incorrect string value: '\\xE5\\x8F\\x96\\xE3\\x82\\x8A...' for column 'BIDDERRESTRICTION' at row 1\n    at com.mysql.jdbc.ServerPreparedStatement.executeBatch(ServerPreparedStatement.java:647)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:57)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:174)\n    ... 34 more\n2012-10-25 17:26:29 [action] [ERROR] Servlet.service() for servlet action threw exception\njava.sql.BatchUpdateException: Incorrect string value: '\\xE5\\x8F\\x96\\xE3\\x82\\x8A...' for column 'BIDDERRESTRICTION' at row 1\n    at com.mysql.jdbc.ServerPreparedStatement.executeBatch(ServerPreparedStatement.java:647)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.apache.tomcat.dbcp.dbcp.DelegatingStatement.executeBatch(DelegatingStatement.java:297)\n    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:57)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:174)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:226)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:137)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:274)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:730)\n    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:324)\n    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:86)\n    at net.startbahn.web.app.PostAuctionVPAction.execute(PostAuctionVPAction.java:175)\n    at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:421)\n    at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:226)\n    at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1164)\n    at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:415)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at net.startbahn.filters.PrivilegeManageFilter.doFilter(PrivilegeManageFilter.java:112)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at net.startbahn.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:121)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:172)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:879)\n    at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n    at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n    at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n    at java.lang.Thread.run(Thread.java:722)\n</code></pre>\n\n<p>I am trying to store some Japanese language stuff in the column so I tried updating the collation of table to <strong>COLLATE = ujis_japanese_ci</strong> and <strong>UTF-8</strong> but still not effect. </p>\n\n<h1><strong>Solution:</strong></h1>\n\n<p>Setting collation of table as well as all its fields to <strong>utf8-utf8_bin</strong> did the trick for me.</p>\n"},{"tags":["java","mysql","oracle","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13122943,"title":"hibernate HQL query that supports multiple databases oracle and mysql","body":"<p>I have an application that should support oracle and mysql databases.\nI will get different configuration for different database.</p>\n\n<p>But i want all HSQL used in the code to be intact.</p>\n\n<p>But i am not able to do so bcoz of below :</p>\n\n<p>I have created a query like below:</p>\n\n<pre><code>String SQL_QUERY = \"select count(log) from dbtable where created_date='\"+ givenDate\nQuery query = session.createQuery(SQL_QUERY);\nquery.uniqueResult();\n</code></pre>\n\n<p>This works very well in mysql\nbut not in oracle</p>\n\n<p>because oracle db expects formatting the value of created_date column with </p>\n\n<pre><code>to_date(givenDate,\"yyyy-MM-dd\")\n</code></pre>\n\n<p>so i have to change the above query as :</p>\n\n<pre><code>String SQL_QUERY = \"select count(log) from dbtable where created_date=to_date('\"+ givenDate+\",\"yyyy-MM-dd\")\n</code></pre>\n\n<p>Can I avoid this multiple query declarations in any way for mysql and oracle ??</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13115648,"title":"Hibernate/mysql connection issues","body":"<p>We are working on a java struts2 framework webapplication with Hibernate 3 ORM. We use mysql as our database. </p>\n\n<p>We found a some DB related exceptions in logs. Connection to the database is timed out before the configured time. Here are the commons exceptions we found.</p>\n\n<pre><code>104343235 [pool-6-thread-19] ERROR org.hibernate.util.JDBCExceptionReporter  - The last packet successfully received from the server was 100,838,460 milliseconds ago.  The last packet sent successfully to the server was 100,838,461 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.\n\norg.hibernate.exception.JDBCConnectionException: could not execute query\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:99)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.loader.Loader.doList(Loader.java:2536)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2276)\n    at org.hibernate.loader.Loader.list(Loader.java:2271)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:452)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:363)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1268)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)\n    at com.myproject.model.dao.entities.EntitiesDAO.getByIds(EntitiesDAO.java:148)\n\nCaused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 100,838,460 milliseconds ago.  The last packet sent successfully to the server was 100,838,461 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.\n    at sun.reflect.GeneratedConstructorAccessor345.newInstance(Unknown Source)104343242 [pool-6-thread-16] ERROR org.hibernate.util.JDBCExceptionReporter  - The last packet successfully received from the server was 100,838,544 milliseconds ago.  The last packet sent successfully to the server was 100,838,544 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.\n104343242 [pool-6-thread-16] ERROR org.hibernate.util.JDBCExceptionReporter  - The last packet successfully received from the server was 100,838,544 milliseconds ago.  The last packet sent successfully to the server was 100,838,544 milliseconds ago. is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem.\n\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1117)\n    at com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3829)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2449)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2629)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2719)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)\n    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2318)\n    at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:76)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1953)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:802)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)\n    at org.hibernate.loader.Loader.doList(Loader.java:2533)\n    ... 21 more\n</code></pre>\n\n<p>Everyday we are restarting our app server as a temparory fix to the issue. </p>\n\n<p>Any help will be highly appreciated.</p>\n"},{"tags":["java","sql","hibernate","java-ee","onetomany"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13121613,"title":"Show size of a OneToMany list within same table of the object?","body":"<p>I have a table grid, which displays all users contained in the database.\nA user has a list of own products. I want to display the size of the products list also within the same table grid.</p>\n\n<p>What am I doing wrong here?</p>\n\n<pre><code>class User {\n    String username;\n\n    @OneToMany(mappedBy=\"user\", cascade=CascadeType.ALL) \n    List&lt;Product&gt; products = new ArrayList&lt;Product&gt;();\n}\n\nclass Product {\n    @ManyToOne\n    User user;\n}\n</code></pre>\n\n<p>Ex:</p>\n\n<pre><code> org.hibernate.exception.SQLGrammarException: could not initialize a collection: [User.products#1]\n\nat org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:92)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.loader.Loader.loadCollection(Loader.java:2173)\n    at org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:62)\n    at org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:627)\n    at org.hibernate.event.def.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:83)\n    at org.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:1863)\n    at org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:369)\n    at org.hibernate.collection.AbstractPersistentCollection.read(AbstractPersistentCollection.java:111)\n    at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:134)\n    at org.hibernate.collection.PersistentBag.size(PersistentBag.java:248)\n    at UserPage.setupRender(UserPage.java:41)\n    at UserPage.setupRender(UserPage.java)\n    at org.apache.tapestry5.internal.structure.ComponentPageElementImpl$SetupRenderPhase.invokeComponent(ComponentPageElementImpl.java:174)\n    at org.apache.tapestry5.internal.structure.ComponentPageElementImpl$AbstractPhase.invoke(ComponentPageElementImpl.java:133)\n    ... 94 more\n\nCaused by: java.sql.SQLSyntaxErrorException: user lacks privilege or object not found: PRODUCT\n    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)\n    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)\n    at org.hsqldb.jdbc.JDBCPreparedStatement.&lt;init&gt;(Unknown Source)\n    at org.hsqldb.jdbc.JDBCConnection.prepareStatement(Unknown Source)\n    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:534)\n    at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:452)\n    at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)\n    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1700)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:801)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)\n    at org.hibernate.loader.Loader.loadCollection(Loader.java:2166)\n    ... 106 more\n</code></pre>\n"},{"tags":["spring","hibernate","servlets","context","config"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13121222,"title":"How to use Spring hibernate with Servlet","body":"<p>I have 2 project:</p>\n\n<ul>\n<li>core: Spring hibernate </li>\n<li>web: servlet-jsp, web refer to core project.</li>\n</ul>\n\n<p>I want to use some DAO (in core project) in servlet, these DAO config as beans by using @Repository annotation. \nCan anyone tell me how can i do that?\nThanks.</p>\n"},{"tags":["spring","hibernate","thread-safety","batch-processing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13118267,"title":"Thread safety hibernate DAO layer","body":"<p>I have a list of Transaction objects.</p>\n\n<pre><code>List&lt;Transaction&gt; transactions;\n</code></pre>\n\n<p>I need to batch process these transactions by creating a pool of threads which update transactions concurrently.\nThese threads update these transactions using the same DAO class(<strong>Spring</strong> singleton bean) to update the transaction. I'm using <strong>Hibernate</strong> as <strong>ORM</strong></p>\n\n<p>What am I to consider to make sure my code is thread safe? I'm a bit confused.</p>\n\n<p>Here's the DAO class. <code>SessionFactory</code> is also defined as a Spring bean which is then autowired to DAO class.</p>\n\n<pre><code>@Autowired\nSessionFactory sessionFactory;\n\n@Override\npublic Transaction update(Transaction transaction) {\n    Session session = sessionFactory.openSession();\n    session.beginTransaction();\n\n    session.update(transaction);\n\n    session.getTransaction().commit();\n    return transaction;\n}\n</code></pre>\n"},{"tags":["hibernate","jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":21,"score":-4,"question_id":13120744,"title":"Difference between JPA and Hibernate","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1770211/similarity-and-difference-between-jpa-and-hibernate\">similarity and difference between jpa and hibernate</a>  </p>\n</blockquote>\n\n\n\n<p>Before jumping into the world of Hibernate, i though JPA and Hibernate were two names of the same thing. JPA is just a specification and Hibernate is build upon that specification. But now i see that JPA is more then just a specification, rather a framework, in itself. Can anyone please explain the difference between the two ? </p>\n\n<p>Kind Regards,</p>\n"},{"tags":["java","spring","hibernate","spring-transactions"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13106679,"title":"Transaction in Spring + hibernate","body":"<p>We are using transaction management through declarative approach, we have specify that all the method which is start with <strong>update*</strong> must follow the transaction.</p>\n\n<p>Suppose we have a transaction method <strong>updatePayroll()</strong> inside this method we are calling four another method, but our requirement is to rollback only in case of first two method get failed else no rollback is required. I don't know how to implement this as my <strong>updatePayroll()</strong> is transacted method so how it is possible to tell the spring that we need only two method's of <strong>updatePayroll()</strong> should be transacted.</p>\n\n<p>code:</p>\n\n<pre><code>public void updatePayroll()\n{\n// below two methods of updateParyroll is required transaction where updatePayroll is transacted method through declarative approach.\nupdateLWPEmployees();\n\nprocessSalary();\n\n// below methods does not require transaction.\nprintSalarySlip();\n\nsendEmail();\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13119044,"title":"How Join hibernate Value objects using HQL query?","body":"<p>Hi i'm New to write HQL Query please help me.....\n my Hibernate have three ValueObjects ie.</p>\n\n<pre><code>@Entity\n@Table(name=\"user\")\npublic class UserVO {\n\n    @Id\n    @Column(name=\"S_ID\")\n    private String s_id;\n\n    @Column(name=\"FIRSTNAME\")\n    private String firstName;\n    private String email;\n}\n</code></pre>\n\n<p>CourseVO class</p>\n\n<pre><code>    @Entity\n@Table(name=\"course\")\npublic class CourseVO\n{\n    @Id\n    @Column(name=\"S_ID\")\n    public String s_id;\n\n    @Column(name=\"NAME\")\n    public String name;\n}\n</code></pre>\n\n<p>Skillset VO</p>\n\n<pre><code>@Entity\n@Table(name=\"skillset\")\npublic class SkillsetVO \n{\n    @Id\n    @Column(name=\"S_ID\")\n    public String s_id;\n\n    @Column(name=\"COURSE_ID\")//Foreign Key \"USER\"\n    public String course_id;\n\n    @Column(name=\"USER_ID\")//Foreign key \"COURSE\"\n    public String user_id;\n\n    @Column(name=\"TEACH_EXP\")\n    public String teach_Exp;\n}\n</code></pre>\n\n<p>Now How to get Values of FirstName,NAME,TEACH_EXP values using EMAIL of USER table using <code>HQL</code> query </p>\n"},{"tags":["java","hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13102124,"title":"How to map a Deque with hibernate?","body":"<p>How can I map a Deque with hibernate?</p>\n\n<pre><code>@Entity\nclass MyClass {\n    @OneToMany\n    Deque&lt;StackObject&gt; stack = new LinkedList&lt;StackObject&gt;();\n}\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>java.lang.RuntimeException: Error invoking constructor public org.apache.tapestry5.internal.hibernate.HibernateSessionSourceImpl(org.slf4j.Logger,java.util.List): Illegal attempt to map a non collection as a @OneToMany, @ManyToMany or @CollectionOfElements\n</code></pre>\n"},{"tags":["json","hibernate","spring","spring-mvc","lazy-loading"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2486,"score":0,"question_id":6277439,"title":"Lazy Loadng error in JSON serializer","body":"<p>I have such kind of @OneToOne Hibernate relationShip</p>\n\n<pre><code>public class Address implements Serializable {\n\n    private String id;\n    private String city;\n    private String country;\n//setter getters ommitted\n}\n\npublic class Student implements Serializable {\n\n    private String id;\n    private String firstName;\n    private String lastName;    \n    private Address address;\n}\n</code></pre>\n\n<p>address Item is mapped as LAZY.</p>\n\n<p>Now I want to fetch user and it's address using </p>\n\n<pre><code>session.load(Student.class,id);\n</code></pre>\n\n<p>In my daoService.</p>\n\n<p>Then I return it as JSON from my Spring MVC controller:</p>\n\n<pre><code>@RequestMapping(value=\"/getStudent.do\",method=RequestMethod.POST)\n    @ResponseBody\n    public Student getStudent(@RequestParam(\"studentId\") String id){\n        Student student = daoService.getStudent(id);\n        return student;\n    }\n</code></pre>\n\n<p>Unfortunately, it's not working because of Lazy clasees and I fails with: </p>\n\n<pre><code>org.codehaus.jackson.map.JsonMappingException: No serializer found for class org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer and no properties discovered to create BeanSerializer (to avoid exception, disable SerializationConfig.Feature.FAIL_ON_EMPTY_BEANS) ) (through reference chain: com.vanilla.objects.Student_$$_javassist_1[\"address\"]-&gt;com.vanilla.objects.Address_$$_javassist_0[\"handler\"])\n    at org.codehaus.jackson.map.ser.StdSerializerProvider$1.serialize(StdSerializerProvider.java:62)\n</code></pre>\n\n<p>I do use OpenSessionInViewInterceptor and it works just fine.\nI understand that I can user left join HQL query and retrieve student and address that way and solve the problem. I also understand that changing relation to EAGER will solve it. </p>\n\n<p>But how can I serialize to JSON lazy classes using standard jackson message converter which of cause I added to my XML file. </p>\n"},{"tags":["mysql","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13118821,"title":"group by successive days","body":"<p>I have a table of actions , eache action has two dates, startDate and endDate, \ni want to writ a request that groupe by day , <strong>but in a successive manner</strong></p>\n\n<p>Exemple :</p>\n\n<pre><code>action ;  startDate ;  endDate\n\nAction1 ; 2012-10-10 ; 2012-10-10\n\nAction2 ; 2012-10-10 ; 2012-10-12\n\nAction3 ; 2012-10-14 ; 2012-10-15\n</code></pre>\n\n<p>my request is </p>\n\n<pre><code>SELECT DAY(startDate), COUNT(Name) FROM ActionTable \nWHERE startDate &lt; '2012-10-09' and endDate &gt; '2012-10-15'\nGROUP BY DAY(startDate)\n</code></pre>\n\n<p>This request return me that :</p>\n\n<pre><code>10 ; 2\n\n14 ; 1\n</code></pre>\n\n<p>I need a request to get this results</p>\n\n<pre><code>10 ; 2\n\n11 ; 1\n\n12 ; 1\n\n14 ; 1\n\n15 ; 1\n</code></pre>\n\n<p>so if an Action is in three days a need that I get +1 in each day</p>\n"},{"tags":["hibernate","jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13064223,"title":"Hibernate @SecondaryTable and @OrderBy","body":"<p>I have an issue trying to sort a @OneToMany collection using an @OrderBy annotation when the target of the @OneToMany is an Entity mapped to multiple tables (using @SecondaryTable) and the sort property is in the secondary table. </p>\n\n<p>A 'column not found' exception is thrown when trying to access the property as the generated SQL order by clause references the sort column using an alias to the primary table rather than the secondary table.</p>\n\n<p>I cannot see anything I could add to make this work. Any thoughts?</p>\n\n<pre><code>public class Product{\n\n    @OneToMany(orphanRemoval = true, mappedBy = \"product\", cascade = CascadeType.ALL)\n    // @OrderBy(value = \"displaySequence\")\n    public Set&lt;Benefit&gt; getBenefits() {\n    return benefits;\n    }\n}\n\npublic class Benefit{\n    @Column(table = SECONDARY_TABLE_NAME, name = \"display_sequence\", nullable = false)\n    public Integer getDisplaySequence() {\n    return displaySequence;\n    }\n}\n</code></pre>\n\n<p>This is using the JPA @OrderBy annotation rather than the Hibernate specific. </p>\n\n<p>Version of Hibernate is 3.6.9. </p>\n\n<p>Within these classes everything is mapped using properties. </p>\n\n<p>Other unrelated classes use mixed access mode</p>\n\n<p>There is an existsing JIRA item which seems to demonstrate the same issue with an @Where clause:</p>\n\n<p><a href=\"https://hibernate.onjira.com/browse/HHH-4246\" rel=\"nofollow\">https://hibernate.onjira.com/browse/HHH-4246</a></p>\n\n<p>The exception is a stanard SQL invalid column error.</p>\n\n<p>The generated SQL is below. The 'order by' should reference display_sequence with reference to alias benefit0_.</p>\n\n<pre><code>select \n.....\nfrom as_benefits_additional_data benefits0_ \ninner join as_benefits benefit1_ on benefits0_.id=benefit1_.id \nleft outer join as_benefits_additional_data benefit1_1_ on benefit1_.id=benefit1_1_.id \ninner join as_products product2_ on benefit1_1_.product_id=product2_.id \nleft outer join as_products_additional_data product2_1_ on product2_.id=product2_1_.id \nwhere benefits0_.product_id=1 \norder by benefit1_.display_sequence asc\n</code></pre>\n"},{"tags":["hibernate","join","hql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13118599,"title":"HQL left outer join","body":"<p>I have this query:</p>\n\n<pre><code>select \n  new ErrorTree \nfrom \n  ErrorSet es\njoin\n  es.errors errors\nleft join\n  errors.extraFields extraFields\nwhere\n  index(extraFields) = es.providerField\n</code></pre>\n\n<p>ErrorSet contains errors and errors can have extra fields stored in extra fields table. We define special extra fields column names in ErrorSet (providerField) in order to be able to filter on it later ( this field could have different name across different error sets). </p>\n\n<p>Why isn't left outer join working? If an error does not have that field the query does not return anything. I expect that the extra field would be null in this case.</p>\n"},{"tags":["java","spring","hibernate","ehcache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13090948,"title":"hibernate `cache usage` parameter programmatically","body":"<p>I'm currently configuring hibernate to use ehcache and provide a <code>CacheManager</code> programmatically. We do not use hibernate.xml nor ehcache.xml as we have our own configuration service to provide such informataion.</p>\n\n<p>Now I'm facing an issue: where must the configuration <code>cache usage</code> be defined programmatically?</p>\n\n<p>I'd like to activate it when I create the <code>CacheConfiguration</code> if it is possible but I do not find a method that allows setting the property.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2751,"score":1,"question_id":4290220,"title":"Hibernate Session.save() doesn't return a value?","body":"<p>Below code throws a casting error</p>\n\n<blockquote>\n  <p>Long newID = (Long)session.save(object);</p>\n</blockquote>\n\n<p>I am new to hibernate. Don't know why.</p>\n"},{"tags":["spring","hibernate","jpa","persistence-unit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13113739,"title":"spring jpa hibernate with more datasources","body":"<p>I have to use two different database in my application(spring) with Hibernate,Jpa. \nI'd like to define the different table directly to the different data sources. \nSo I use two different persistence unit and I try to use</p>\n\n<pre><code>&lt;property name=\"packagesToScan\" value=\"it.two.app.domain.first\" /&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;property name=\"packagesToScan\" value=\"it.two.app.domain.second\" /&gt;\n</code></pre>\n\n<p>putting the different tables into the different packages.\nbut It doesn't work.\nInfact all the table is with the first data source.\nthen I tried to write into the perstistence XML file the name of the class\nlike</p>\n\n<pre><code> &lt;persistence-unit name=\"persistenceFirst\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n &lt;class&gt;it.two.app.domain.first.OneTable&lt;/class&gt;\n &lt;exclude-unlisted-classes/&gt;\n&lt;/persistence-unit&gt;\n</code></pre>\n\n<p>and\n    \n     it.two.app.domain.second.OtherTable\n     \n    </p>\n\n<p>But when I run Log says\n    Table 'firstDB.other-table' doesn't exist\nand I use into the services file </p>\n\n<pre><code>@PersistenceContext(unitName =\"persistenceFirst\")\nprivate EntityManager em;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>@PersistenceContext(unitName = \"persistenceSecond\")\nEntityManager em;\n</code></pre>\n\n<p>Have you got some Ideas?\nThi is the data sources XML file</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:context=\"http://www.springframework.org/schema/context\"\nxmlns:jdbc=\"http://www.springframework.org/schema/jdbc\"\nxmlns:jpa=\"http://www.springframework.org/schema/data/jpa\"\nxmlns:tx=\"http://www.springframework.org/schema/tx\"\nxmlns:p=\"http://www.springframework.org/schema/p\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd\n    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n    http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.0.xsd\n    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n    http://www.springframework.org/schema/context     http://www.springframework.org/schema/context/spring-context-3.1.xsd\"&gt;\n\n&lt;!-- first datasource --&gt;\n&lt;context:property-placeholder location=\"classpath:jdbc-first.properties\"/&gt;\n&lt;bean id=\"dataSourceFirst\"  class=\"org.apache.commons.dbcp.BasicDataSource\"\n    p:driverClassName=\"${jdbc.driverClassName}\" p:url=\"${jdbc.databaseurl}\"\n    p:username=\"${jdbc.username}\" p:password=\"${jdbc.password}\"  /&gt;\n&lt;!-- second datasource --&gt;      \n&lt;context:property-placeholder location=\"classpath:jdbc-second.properties\"/&gt;\n&lt;bean id=\"dataSourceSecond\"     class=\"org.apache.commons.dbcp.BasicDataSource\"\n    p:driverClassName=\"${jdbc.driverClassName}\" p:url=\"${jdbc.databaseurl}\"\n    p:username=\"${jdbc.username}\" p:password=\"${jdbc.password}\"  /&gt;     \n\n\n&lt;bean id=\"transactionManagerFirst\"  class=\"org.springframework.orm.jpa.JpaTransactionManager\"\np:entityManagerFactory-ref=\"emfFirst\"/&gt;\n\n&lt;bean id=\"transactionManagerSecond\"     class=\"org.springframework.orm.jpa.JpaTransactionManager\"\np:entityManagerFactory-ref=\"emfSecond\"/&gt;\n\n&lt;tx:annotation-driven transaction-manager=\"transactionManagerFirst\"/&gt;\n&lt;tx:annotation-driven transaction-manager=\"transactionManagerSecond\"/&gt;\n\n\n&lt;jpa:repositories base-package=\"it.two.app.repository.first\"\nentity-manager-factory-ref=\"emfFirst\" transaction-manager-ref=\"transactionManagerFirst\" /&gt;\n\n&lt;jpa:repositories base-package=\"it.two.app.repository.second\"\nentity-manager-factory-ref=\"emfSecond\" transaction-manager-ref=\"transactionManagerSecond\" /&gt;\n\n&lt;bean id=\"emfFirst\"\nclass=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n&lt;property name=\"persistenceUnitName\" value=\"persistenceFirst\"/&gt;\n&lt;property name=\"persistenceXmlLocation\" value=\"classpath:/META-INF/persistence-first.xml\"/&gt;\n&lt;property name=\"jpaVendorAdapter\"&gt;\n    &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\" /&gt;\n&lt;/property&gt;\n\n&lt;property name=\"dataSource\" ref=\"dataSourceFirst\" /&gt;\n&lt;property name=\"packagesToScan\" value=\"it.two.app.domain.first\" /&gt;\n&lt;property name=\"jpaProperties\"&gt;\n    &lt;props&gt;\n        &lt;prop     key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/prop&gt;\n        &lt;prop key=\"hibernate.max_fetch_depth\"&gt;3&lt;/prop&gt;\n        &lt;prop key=\"hibernate.jdbc.fetch_size\"&gt;50&lt;/prop&gt;\n        &lt;prop key=\"hibernate.jdbc.batch_size\"&gt;10&lt;/prop&gt;\n    &lt;/props&gt;\n&lt;/property&gt;\n\n&lt;/bean&gt;\n\n&lt;bean id=\"emfSecond\"     class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n&lt;property name=\"persistenceUnitName\" value=\"persistenceSecond\"/&gt;\n&lt;property name=\"persistenceXmlLocation\" value=\"classpath:/META-INF/persistence-        second.xml\"/&gt;\n&lt;property name=\"jpaVendorAdapter\" &gt;\n &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"/&gt;\n&lt;/property&gt;\n&lt;property name=\"dataSource\" ref=\"dataSourceSecond\"/&gt;\n&lt;property name=\"packagesToScan\" value=\"it.two.app.domain.second\"/&gt;\n&lt;property name=\"jpaProperties\"&gt;\n &lt;props&gt;\n&lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/prop&gt; \n&lt;prop key=\"hibernate.max_fetch_depth\"&gt;3&lt;/prop&gt;\n&lt;prop key=\"hibernate.jdbc.fetch_size\"&gt;50&lt;/prop&gt;\n&lt;prop key=\"hibernate.jdbc.batch_size\"&gt;10&lt;/prop&gt;\n &lt;/props&gt;\n&lt;/property&gt;\n\n&lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>SOLUTION!!!!!!\nI undestand the problem.\nSimply</p>\n\n<pre><code>&lt;!-- first datasource --&gt;\n &lt;bean id=\"dataSourceFirst\"  class=\"org.apache.commons.dbcp.BasicDataSource\"\n    p:driverClassName=\"com.mysql.jdbc.Driver\" p:url=\"url....\"\n    p:username=\"username\" p:password=\"password\"  /&gt;\n&lt;!-- second datasource --&gt;      \n&lt;bean id=\"dataSourceSecond\"     class=\"org.apache.commons.dbcp.BasicDataSource\"\n     p:driverClassName=\"com.mysql.jdbc.Driver\" p:url=\"url2....\"\n    p:username=\"username2\" p:password=\"password2\"  /&gt;    \n</code></pre>\n"},{"tags":["hibernate","connection-pooling","c3p0"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":994,"score":1,"question_id":4303988,"title":"Hibernate > 3.3 and c3p0","body":"<p>As c3p0 does not seem to be bundled with Hibernate anymore (as of versions > 3.3, I am using Hibernate 3.6.0), I'd like to know how to integrate c3p0 with Hibernate.</p>\n\n<p>Obviously the old approach with</p>\n\n<pre><code>&lt;property name=\"connection.provider_class\"&gt;org.hibernate.connection.C3P0ConnectionProvider&lt;/property&gt;\n</code></pre>\n\n<p>does not seem to work anymore, as the class C3P0ConnectionProvider is not provided by Hibernate anymore. Do I now have to build this on my own or is it safe to integrate the hibernate-c3p0-3.3.x.jar?</p>\n\n<p>Note: I am using bare Hibernate, no Spring etc.</p>\n"},{"tags":["mysql","hibernate","spring","jdbc","c3p0"],"answer_count":3,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":9508,"score":9,"question_id":1511855,"title":"Reproduce com.mysql.jdbc.exceptions.jdbc4.CommunicationsException with a setup of Spring, hibernate and C3P0","body":"<p>I got this error from the production code:</p>\n\n<blockquote>\n  <p>com.mysql.jdbc.exceptions.jdbc4.CommunicationsException:\n  The last packet successfully received\n  from the server was36940 seconds\n  ago.The last packet sent successfully\n  to the server was 36940 seconds ago,\n  which is longer than the server\n  configured value of 'wait_timeout'.\n  You should consider either expiring\n  and/or testing connection validity\n  before use in your application,\n  increasing the server configured\n  values for client timeouts, or using\n  the Connector/J connection property\n  'autoReconnect=true' to avoid this\n  problem.</p>\n</blockquote>\n\n<p>And now I'm trying to reproduce the problem locally and fix it. I setup the spring context as following:</p>\n\n<pre><code>&lt;bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\n    &lt;bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\n    destroy-method=\"close\" p:driverClass=\"com.mysql.jdbc.Driver\"\n    p:jdbcUrl=\"jdbc:mysql://localhost:3306/test?userUnicode=yes&amp;amp;characterEncoding=UTF-8&amp;amp\"\n    p:idleConnectionTestPeriod=\"120\" p:initialPoolSize=\"1\" p:maxIdleTime=\"1800\"\n    p:maxPoolSize=\"1\" p:minPoolSize=\"1\" p:checkoutTimeout=\"1000\"\n\n/&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\"/&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;value&gt;\n            hibernate.connection.provider_class = org.hibernate.connection.C3P0ConnectionProvider\n            hibernate.dialect=org.hibernate.dialect.MySQL5Dialect\n            hibernate.default_schema=platform_server_original\n            hibernate.show_sql=false\n        &lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"mappingResources\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;sometables.hbm.xml&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>Then I set my mysql wait_timeout to 10 seconds, then run my test, which is basically open a connection, do a query, close it, so it returns to the pool, then sleep the thread for 15 seconds, and then open a connection again, and do a query again, so it will break. However, I got a similar error only:</p>\n\n<blockquote>\n  <p>com.mysql.jdbc.exceptions.jdbc4.CommunicationsException:\n  Communications link failure</p>\n  \n  <p>Last packet sent to the server was 16\n  ms ago.</p>\n</blockquote>\n\n<p>So I wonder are these two errors the same, or they are different? I did some researches, and it seems both errors came down to the same solution: using a property \"testConnectionOnCheckout=true\". However, according to c3p0 doc, this is a very expensive check. It advises the use of \"idleConnectionTestPeriod\", but I'm already setting that to 120 seconds. What value should I use it so it can properly verify the idle connection?</p>\n\n<p>So I'm basically ask two things: \n1. how do I reproduce the error I got in production code? \n2. how do I fix it?</p>\n\n<p>Thanks!</p>\n"},{"tags":["json","spring","hibernate","jpa","spring-roo"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13112921,"title":"Spring Roo, JSON, Detached entity passed to persist","body":"<p>I am new to learning Spring roo. I am getting <code>org.hibernate.PersistentObjectException: detached entity passed to persist</code> exception, when I post JSON for creating entity with <code>MANY_TO_MANY</code> relation. Here are details:</p>\n\n<p>.roo file:</p>\n\n<pre><code>project --topLevelPackage com.test.book --projectName bookmanager --java 6 --packaging JAR\njpa setup --provider HIBERNATE --database HYPERSONIC_IN_MEMORY\n\nentity jpa --class ~.domain.Category\nfield string --fieldName title --sizeMin 2 --notNull\n\nentity jpa --class ~.domain.Book\nfield string --fieldName name --notNull --unique\nfield set --fieldName categories --type ~.domain.Category --cardinality MANY_TO_MANY\n\nfocus --class ~.domain.Category\nfield set --fieldName books --type ~.domain.Book --cardinality MANY_TO_MANY --mappedBy categories\n\nweb mvc setup\nweb mvc all --package ~.web\n\njson all --deepSerialize\nweb mvc json all After project is created I used following script to create entities\n</code></pre>\n\n<p>After project is created I used following script to create entities:</p>\n\n<pre><code>// curl -i -X POST -H \"Content-Type: application/json\" -H \"Accept: application/json\" -d '{title:'cat1'}' http:// localhost: 8080/bookmanager/categorys\n</code></pre>\n\n<p>Worked fine. <code>cat1</code> Category was created sucessfully.</p>\n\n<p>But ...</p>\n\n<pre><code>// curl -i -X POST -H \"Content-Type: application/json\" -H \"Accept: application/json\" -d '{name:'bookname1',categories:[{\"id\":1,\"title\":\"cat1\",\"version\":0}]}' http:// localhost: 8080/bookmanager/books\n</code></pre>\n\n<p>returned following exception:</p>\n\n<pre><code>Data access failure\nSorry, a problem occurred while accessing the database.\n\n\nDetails\norg.hibernate.PersistentObjectException: detached entity passed to persist: com.test.book.domain.Category; nested exception is javax.persistence.PersistenceException: org.hibernate.PersistentObjectException: detached entity passed to persist: com.test.book.domain.Category\norg.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:326)\norg.springframework.orm.jpa.aspectj.JpaExceptionTranslatorAspect.ajc$afterThrowing$org_springframework_orm_jpa_aspectj_JpaExceptionTranslatorAspect$1$18a1ac9(JpaExceptionTranslatorAspect.aj:15)\ncom.test.book.domain.Book_Roo_Jpa_ActiveRecord.ajc$interMethod$com_test_book_domain_Book_Roo_Jpa_ActiveRecord$com_test_book_domain_Book$persist(Book_Roo_Jpa_ActiveRecord.aj:43)\ncom.test.book.domain.Book.persist(Book.java:1)\ncom.test.book.domain.Book_Roo_Jpa_ActiveRecord.ajc$interMethodDispatch1$com_test_book_domain_Book_Roo_Jpa_ActiveRecord$com_test_book_domain_Book$persist(Book_Roo_Jpa_ActiveRecord.aj)\ncom.test.book.web.BookController_Roo_Controller_Json.ajc$interMethod$com_test_book_web_BookController_Roo_Controller_Json$com_test_book_web_BookController$createFromJson(BookController_Roo_Controller_Json.aj:44)\ncom.test.book.web.BookController.createFromJson(BookController.java:1)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\njava.lang.reflect.Method.invoke(Method.java:597)\norg.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)\norg.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)\norg.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)\norg.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)\norg.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)\norg.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)\norg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)\norg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)\norg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)\norg.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)\njavax.servlet.http.HttpServlet.service(HttpServlet.java:641)\njavax.servlet.http.HttpServlet.service(HttpServlet.java:722)\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\norg.springframework.orm.jpa.support.OpenEntityManagerInViewFilter.doFilterInternal(OpenEntityManagerInViewFilter.java:147)\norg.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\norg.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)\norg.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\norg.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)\norg.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\norg.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\ncom.springsource.insight.collection.tcserver.request.HttpRequestOperationCollectionValve.invoke(HttpRequestOperationCollectionValve.java:88)\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\norg.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)\norg.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\norg.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\njava.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\njava.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>When I create objects using UI generated by spring roo, it works fine but it doesn't when I attempt same with JSON. I think I may not be passing json object in correct format. Please can anyone tell me how to post JSON object to create new Book entity associated with a specific Categories.</p>\n"},{"tags":["java","database","hibernate","orm","annotations"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8133,"score":1,"question_id":951372,"title":"Hibernate mapping a second @Embeddable field in a subclass","body":"<p>I'm trying to map an @Embeddable object in a subclass whose parent class already has a field of that @Embeddable type.</p>\n\n<p>The hibernate <a href=\"http://docs.jboss.org/ejb3/app-server/HibernateAnnotations/reference/en/html%5Fsingle/index.html#d0e483\" rel=\"nofollow\">Embeddable Objects documentation</a> claims I can use the @AttributeOverrides to override the column names of an @Embeddable object:</p>\n\n<p>e.g.</p>\n\n<pre><code>@Entity\npublic class Person implements Serializable {\n\n    // Persistent component using defaults\n    Address homeAddress;\n\n    @Embedded\n    @AttributeOverrides( {\n            @AttributeOverride(name=\"iso2\", column = @Column(name=\"bornIso2\") ),\n            @AttributeOverride(name=\"name\", column = @Column(name=\"bornCountryName\") )\n    } )\n    Country bornIn;\n    ...\n}\n</code></pre>\n\n<p>Here's the case I have:</p>\n\n<pre><code> @Embeddable\n    public class ContentID implements Serializable {\n        @Column(name=\"contentID\")\n        private String contentPath;\n    }\n\n   @MappedSuperclass\n   public abstract class BaseDomainObject implements Serializable  {\n\n       @Embedded\n       private ContentID contentID;\n    }\n\npublic class Achievement extends BaseDomainObject {\n\n    @Embedded\n    @AttributeOverrides( {\n        @AttributeOverride(name=\"contentID\", column = @Column(name=\"awardedItem\") ),\n    } )\n    private ContentID awardedItem;\n}\n</code></pre>\n\n<p>The error I get is:</p>\n\n<blockquote>\n  <p>org.hibernate.MappingException:\n  Repeated column in mapping for entity:\n  Achievement column: contentID (should\n  be mapped with insert=\"false\"\n  update=\"false\")   at\n  org.hibernate.mapping.PersistentClass.checkColumnDuplication(PersistentClass.java:652)\n    at\n  org.hibernate.mapping.PersistentClass.checkPropertyColumnDuplication(PersistentClass.java:674)\n    at\n  org.hibernate.mapping.PersistentClass.checkPropertyColumnDuplication(PersistentClass.java:670)\n    at\n  org.hibernate.mapping.PersistentClass.checkColumnDuplication(PersistentClass.java:696)\n    at\n  org.hibernate.mapping.PersistentClass.validate(PersistentClass.java:450)\n    at\n  org.hibernate.mapping.SingleTableSubclass.validate(SingleTableSubclass.java:43)\n    at\n  org.hibernate.cfg.Configuration.validate(Configuration.java:1108)\n    at\n  org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1293)\n    at\n  org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:867)</p>\n</blockquote>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I looked in for Hibernate issues relating to this and the GRAILS project claimed they fixed this issue but their annotation solution doesn't seem to be valid javax.persistence annotations (maybe it's a new version).</p>\n\n<p><a href=\"http://jira.codehaus.org/browse/GRAILS-3225\" rel=\"nofollow\">JPA @Embeddable/@Embedded throws org.hibernate.MappingException: Repeated column in mapping for entity</a></p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":10,"up_vote_count":16,"down_vote_count":0,"view_count":6874,"score":16,"question_id":1638723,"title":"equals and hashcode in Hibernate","body":"<p>How should model class's equals and hashcode be implemented in Hibernate? What are the common pitfalls? Is the default implementation good enough for most cases? Is there any sense to use business keys?</p>\n\n<p>It seems to me that it's pretty hard to get it right to work in every situation, when lazy fetching, id generation, proxy, etc are taken into account.</p>\n"},{"tags":["sql-server","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13115314,"title":"Hibernate SQLServerException for username","body":"<p>I'm trying to run a java app that uses Hibernate and MS SQL Server Express.</p>\n\n<p>SQL Server is configured with windows authentication as the login methond. I've also enabled TCP/IP port 1433(default), but I still keep getting the following error.</p>\n\n<pre><code>...// more output\nat test.models.TestHibernate.main(TestHibernate.java:11)\nCaused by: com.microsoft.sqlserver.jdbc.SQLServerException: Login failed for user 'not required'. ClientConnectionId:de7daf69-2619-4906-b063-459a5b614bdb\n...// more output\n</code></pre>\n\n<p>The line throwing the exception:</p>\n\n<pre><code>session.beginTransaction();\n</code></pre>\n\n<p>hibernate.cfg.xml:</p>\n\n<pre><code>&lt;property name=\"connection.driver_class\"&gt;com.microsoft.sqlserver.jdbc.SQLServerDriver&lt;/property&gt;\n        &lt;property name=\"connection.url\"&gt;jdbc:sqlserver://localhost;databaseName=hibernatexml;integratedSecurity=false;&lt;/property&gt;\n        &lt;property name=\"connection.username\"&gt;not required&lt;/property&gt;\n        &lt;property name=\"connection.password\"/&gt;\n</code></pre>\n\n<p>I removed other configuration errors but with this I'm out of ideas. If you need more info just let me know</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","orm","coldfusion"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":8672723,"title":"ColdFusion 9 ORM Relationship Mappings","body":"<p>I am trying to define the relationship between tables using ColdFusion 9.0.1 ORM.</p>\n\n<p>I have 2 tables: users and companies</p>\n\n<p>I am working on the relationship between users to companies. Right now I have this:</p>\n\n<pre><code>component persistent=\"true\" table=\"users\" datasource=\"core\"\n{\n    property name=\"userID\" fieldtype=\"id\" column=\"userID\" \n    setter=\"false\" generator=\"native\";\n\n    property name=\"firstName\" length=\"255\";\n    property name=\"lastName\" length=\"255\";\n    property name=\"userName\" length=\"45\";\n\n    property name=\"companies\" fieldtype=\"many-to-one\" cfc=\"company\" \n    fkcolumn=\"companyID\" singularname=\"company\";\n\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>component persistent=\"true\" table=\"companies\" datasource=\"core\"\n{\n    property name=\"companyID\" fieldtype=\"id\" column=\"companyID\" \n    setter=\"false\" generator=\"native\";\n\n    property name=\"companyName\" length=\"255\";\n    property name=\"companyCode\" length=\"45\";;\n\n    property name=\"users\" fieldtype=\"one-to-many\" fkcolumn=\"userID\" cfc=\"user\"\n    cascade=\"all\" inverse=\"true\";\n\n\n}\n</code></pre>\n\n<p>I am having an issue with writing to the user table. I need to write a companyID into the user table so that I can link back to the company. On this insert I do not want insert anything into the companies table. I just want to write to the users table and have it link to the companies table via a companyID in the users table.</p>\n\n<p>Here is my EntitySave code:</p>\n\n<pre><code>transaction{\n\n        newUser = EntityNew(\"user\");\n\n            newUser.setCompanies(#FORM.companyID#);     \n            newUser.setFirstName(#FORM.firstName#);\n            newUser.setLastName(#FORM.lastName#);\n            newUser.setUserName(#FORM.userName#);\n\n        EntitySave(newUser);\n\n    }\n</code></pre>\n\n<p>When I run it like that I get this error \"The value for property java.lang.String cannot be retrieved from object of type companyID. Expected object type is company.\"</p>\n\n<p>I was thinking maybe I need to have separate property for the companyID like this \"property name=\"companyID\" ormType=\"int\" and then maybe I could use \"newUser.setCompanyID(#FORM.companyID#);\" in the EntitySave but that does not work. I get an error on the ORMReload(); when I have that in there.</p>\n\n<p>I am obviously pretty confused about the best way to setup relationships. I can get this working without trying to officially reference the relationship in the user.cfc file and just using property name=\"companyID\" ormType=\"int\" but that does not give me a proper relationship between the tables. I think?</p>\n\n<p>Any help on this would be great.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","hibernate","intellij-idea"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":595,"score":0,"question_id":3622287,"title":"How to setup intellij-idea to understands table names in hibernate XML files","body":"<p>I'm using Intellij 9 and Hibernate. Everything works fine, however Intellij does not detect table names in *.hbm.xml files. I've setup hibernate facet and everything else is recognized by intellij (links between hbm.xml files and corresponding classes are working). Just the table name and column name is not get resolved by Intellij. What did I miss in setting up the intellij? Do I need to somehow bind the intellij to the MySql which I'm using?</p>\n"},{"tags":["oracle","hibernate","jdbc","blob"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":596,"score":1,"question_id":5978041,"title":"hibernate + Oracle 11.2 + BLOB","body":"<p>I googled a lot and haven't found working issue... In my web app I need to upload large files using ajax. I use ajaxfileupload plugin for it. In my FormBean class I mapped file to InputStream:</p>\n\n<pre><code>private InputStream fileData;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>@FormParam(\"file\")\n@PartType(\"application/octet-stream\")\n@JsonIgnore\npublic void setFileData(InputStream fileData) {\n    this.fileData = fileData;\n}\n</code></pre>\n\n<p>It works fine. I can save this stream into a file and haven't got any problems with java heap size. Now I'm trying to save it into database using Hibernate. Like this:</p>\n\n<pre><code>repFile.setFileData(session.getLobHelper().createBlob(file.getFileData(), 1024L));\n</code></pre>\n\n<p>and when I save repFile object I have <strong>ORA-01461</strong> can bind a LONG value only for insert into a LONG column.\nIt works with Oracle 10. But it crashes with Oracle 11.2\nI tried to add lobHandler to my configuration - didn't help</p>\n\n<pre><code>&lt;property name=\"lobHandler\"&gt;\n        &lt;bean class=\"org.springframework.jdbc.support.lob.OracleLobHandler\"&gt;\n            &lt;property name=\"nativeJdbcExtractor\"&gt;\n                &lt;bean class=\"org.springframework.jdbc.support.nativejdbc.CommonsDbcpNativeJdbcExtractor\"/&gt;\n            &lt;/property&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n</code></pre>\n\n<p>And set batch size to 0 and allow steams</p>\n\n<pre><code>&lt;prop key=\"hibernate.jdbc.use_streams_for_binary\"&gt;true&lt;/prop&gt;\n            &lt;prop key=\"hibernate.jdbc.batch_size\"&gt;0&lt;/prop&gt;\n</code></pre>\n\n<p>That didn't help also... does anyone have a solution for this? Any help would be good. </p>\n"},{"tags":["hibernate","struts2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13085640,"title":"Struts2 Hibernate Login with User table and group table","body":"<p>My problem is, i have a table User and Table Group (this table use to authorization for user - it mean when user belong to a group like admin, they can login into admincp and other user belong to group member, they just only read and write and can not login into admincp) each user maybe belong to many groups and each group has been contain many users and they have relationship are many to many</p>\n\n<p>I use hibernate for persistence storage. and struts 2 to handle business logic.</p>\n\n<p>When i want to implement login action from Struts2 how can i get value of group member belong to ? to compare with value i want to know?</p>\n\n<p>Example</p>\n\n<p>I get user from username and password then get group from user class but i dont know how to get value of group user belong to</p>\n\n<p>it mean if user belong to Groupid is 1 and in group table , at column adminpermission is 1, that user can login into admincp, otherwise he can't</p>\n\n<p>my code:</p>\n\n<p>User.java</p>\n\n<pre><code>/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\npackage org.dejavu.software.model;\nimport java.io.Serializable;\nimport java.util.Date;\nimport java.util.HashSet;\nimport java.util.Set;\nimport javax.persistence.CascadeType;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.FetchType;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.JoinTable;\nimport javax.persistence.ManyToMany;\nimport javax.persistence.Table;\nimport javax.persistence.Temporal;\n\n/**\n *\n * @author Administrator\n */\n@Entity\n@Table(name=\"User\")\npublic class User implements Serializable{\n\n    private static final long serialVersionUID = 2575677114183358003L;    \n    private Long userId;\n    private String username;\n    private String password;\n    private String email;\n    private Date DOB;\n    private String address;\n    private String city;\n    private String country;\n    private String avatar;\n    private Set&lt;Group&gt;  groups = new HashSet&lt;Group&gt;(0);\n\n    @Column(name=\"dob\")\n    @Temporal(javax.persistence.TemporalType.DATE)\n    public Date getDOB() {\n        return DOB;\n    }\n\n    public void setDOB(Date DOB) {\n        this.DOB = DOB;\n    }\n    @Column(name=\"address\")\n    public String getAddress() {\n        return address;\n    }\n\n    public void setAddress(String address) {\n        this.address = address;\n    }\n    @Column(name=\"city\")\n    public String getCity() {\n        return city;\n    }\n\n    public void setCity(String city) {\n        this.city = city;\n    }\n    @Column(name=\"country\")\n    public String getCountry() {\n        return country;\n    }\n\n    public void setCountry(String country) {\n        this.country = country;\n    }\n    @Column(name=\"email\")\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n    @ManyToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)\n    @JoinTable(name=\"usergroup\",joinColumns={@JoinColumn(name=\"userid\")},inverseJoinColumns={@JoinColumn(\n            name=\"groupid\")})\n    public Set&lt;Group&gt; getGroups() {\n        return groups;\n    }\n\n    public void setGroups(Set&lt;Group&gt; groups) {\n        this.groups = groups;\n    }\n    @Column(name=\"password\")\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n    @Id\n    @GeneratedValue\n    @Column(name=\"iduser\")\n    public Long getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Long userId) {\n        this.userId = userId;\n    }\n    @Column(name=\"username\")\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n    @Column(name=\"avatar\")\n    public String getAvatar() {\n        return avatar;\n    }\n\n    public void setAvatar(String avatar) {\n        this.avatar = avatar;\n    }\n\n\n}\n</code></pre>\n\n<p>Group.java</p>\n\n<pre><code>/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\npackage org.dejavu.software.model;\n\nimport java.io.Serializable;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n/**\n *\n * @author Administrator\n */\n@Entity\n@Table(name=\"Group\")\npublic class Group implements Serializable{\n    private static final long serialVersionUID = -2722005617166945195L;\n\n    private Long idgroup;\n    private String groupname;\n    private String adminpermission;\n    private String editpermission;\n    private String modpermission;\n\n    @Column(name=\"adminpermission\")\n    public String getAdminpermission() {\n        return adminpermission;\n    }\n\n    public void setAdminpermission(String adminpermission) {\n        this.adminpermission = adminpermission;\n    }\n    @Column(name=\"editpermission\")\n    public String getEditpermission() {\n        return editpermission;\n    }\n\n    public void setEditpermission(String editpermission) {\n        this.editpermission = editpermission;\n    }\n    @Column(name=\"groupname\")\n    public String getGroupname() {\n        return groupname;\n    }\n\n    public void setGroupname(String groupname) {\n        this.groupname = groupname;\n    }\n    @Id\n    @GeneratedValue\n    @Column (name=\"idgroup\")\n    public Long getIdgroup() {\n        return idgroup;\n    }\n\n    public void setIdgroup(Long idgroup) {\n        this.idgroup = idgroup;\n    }\n    @Column(name=\"modpermission\")\n    public String getModpermission() {\n        return modpermission;\n    }\n\n    public void setModpermission(String modpermission) {\n        this.modpermission = modpermission;\n    }\n\n}\n</code></pre>\n\n<p>UserDAO</p>\n\n<pre><code>/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\npackage org.dejavu.software.dao;\n\nimport java.util.List;\nimport org.dejavu.software.model.User;\nimport org.dejavu.software.util.HibernateUtil;\nimport org.hibernate.Query;\nimport org.hibernate.Session;\n\n/**\n *\n * @author Administrator\n */\npublic class UserDAO extends HibernateUtil{\n\n    public User addUser(User user){\n        Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n        session.beginTransaction();\n        session.save(user);\n        session.getTransaction().commit();\n        return user;\n    }\n\n    public List&lt;User&gt; getAllUser(){\n        Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n        session.beginTransaction();\n        List&lt;User&gt; user = null;\n        try {\n            user = session.createQuery(\"from User\").list();\n        } catch (Exception e) {\n            e.printStackTrace();\n            session.getTransaction().rollback();\n        }\n        session.getTransaction().commit();\n        return user;\n    }\n\n    public User checkUsernamePassword(String username, String password){\n        Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n        session.beginTransaction();\n        User user = null;\n        try {\n            Query query = session.createQuery(\"from User where username = :name and password = :password\");\n            query.setString(\"username\", username);\n            query.setString(\"password\", password);\n            user = (User) query.uniqueResult();\n        } catch (Exception e) {\n            e.printStackTrace();\n            session.getTransaction().rollback();\n        }\n        session.getTransaction().commit();\n        return user;\n    }\n}\n</code></pre>\n\n<p>AdminLoginAction</p>\n\n<pre><code>/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\npackage org.dejavu.software.view;\n\nimport com.opensymphony.xwork2.ActionSupport;\nimport org.dejavu.software.dao.UserDAO;\nimport org.dejavu.software.model.User;\n\n/**\n *\n * @author Administrator\n */\npublic class AdminLoginAction extends ActionSupport{\n\n    private User user;\n    private String username,password;\n    private String role;\n    private UserDAO userDAO;\n\n    public AdminLoginAction(){\n        userDAO = new UserDAO();\n    }\n\n    @Override\n    public String execute(){\n\n        return SUCCESS;\n    }\n\n    @Override\n    public void validate(){\n       if(getUsername().length() == 0){\n           addFieldError(\"username\", \"Username is required\");\n       }if(getPassword().length()==0){\n           addFieldError(\"password\", getText(\"Password is required\"));\n       }              \n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getRole() {\n        return role;\n    }\n\n    public void setRole(String role) {\n        this.role = role;\n    }\n\n    public User getUser() {\n        return user;\n    }\n\n    public void setUser(User user) {\n        this.user = user;\n    }\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n\n}\n</code></pre>\n\n<p>Other question.  I saw some example about Login, I saw some developers use interceptor, I can't understand why they use it, and what benefit \"Interceptor\" will give us.</p>\n\n<p>Thank You Very Much!</p>\n\n<p>Edit\nStacktrace</p>\n\n<pre><code>Hibernate: select user0_.iduser as iduser3_0_, group2_.idgroup as idgroup4_1_, user0_.dob as dob3_0_, user0_.address as address3_0_, user0_.avatar as avatar3_0_, user0_.city as city3_0_, user0_.country as country3_0_, user0_.email as email3_0_, user0_.password as password3_0_, user0_.username as username3_0_, group2_.adminpermission as adminper2_4_1_, group2_.editpermission as editperm3_4_1_, group2_.groupname as groupname4_1_, group2_.modpermission as modpermi5_4_1_, groups1_.iduser as iduser0__, groups1_.idgroup as idgroup0__ from User user0_ inner join usergroup groups1_ on user0_.iduser=groups1_.iduser inner join Group group2_ on groups1_.idgroup=group2_.idgroup where user0_.username=?\nOct 28, 2012 12:16:49 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nWARNING: SQL Error: 1064, SQLState: 42000\nOct 28, 2012 12:16:49 PM org.hibernate.util.JDBCExceptionReporter logExceptions\nSEVERE: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Group group2_ on groups1_.idgroup=group2_.idgroup where user0_.username='admin'' at line 1\norg.hibernate.exception.SQLGrammarException: could not execute query\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.doList(Loader.java:2223)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\n    at org.hibernate.loader.Loader.list(Loader.java:2099)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)\n    at org.hibernate.impl.AbstractQueryImpl.uniqueResult(AbstractQueryImpl.java:811)\n    at org.dejavu.software.dao.UserDAO.checkUsernamePassword(UserDAO.java:52)\n    at org.dejavu.software.view.AdminLoginAction.execute(AdminLoginAction.java:31)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:601)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:453)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:292)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:255)\n    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:256)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:176)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:265)\n    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:138)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:236)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:236)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:90)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:511)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:432)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:964)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:304)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Group group2_ on groups1_.idgroup=group2_.idgroup where user0_.username='admin'' at line 1\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n    at com.mysql.jdbc.Util.getInstance(Util.java:386)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1053)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4096)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4028)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2490)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2651)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2734)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)\n    at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2322)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n    at org.hibernate.loader.Loader.doList(Loader.java:2220)\n    ... 78 more\n</code></pre>\n"},{"tags":["java","mysql","hibernate","jdbc","prepared-statement"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":8749,"score":5,"question_id":222019,"title":"How to use MySQL prepared statement caching?","body":"<p>How do i take advantage of MySQL's ability to cache prepared statements?\nOne reason to use prepared statements is that there is no need to send the prepared statement itself multiple times if the same prepared statement is to be used again. </p>\n\n<pre><code>Class.forName(\"com.mysql.jdbc.Driver\");\nConnection conn = DriverManager.getConnection(\"jdbc:mysql://127.0.0.1:3306/mydb\" +\n        \"?cachePrepStmts=true\", \"user\", \"pass\");\nfor (int i = 0; i &lt; 5; i++) {\n    PreparedStatement ps = conn.prepareStatement(\"select * from MYTABLE where id=?\");\n    ps.setInt(1, 1);\n    ps.execute();\n}\nconn.close()\n</code></pre>\n\n<p>When running the above Java example I see 5 pairs of Prepare and Execute commands in the mysqld log file. Moving the ps assignment outside of the loop results in a single Prepare and 5 Execute commands of course. The connection parameter \"cachePrepStmts=true\" doesn't seem to make any difference here.<br />\nWhen running a similar program using Spring and Hibernate the number of Prepare commands sent (1 or 5) depends on whether the cachePrepStmts connection parameter is enabled. How does Hibernate execute prepared statements to take advantage of the cachePrepStmts setting? Is it possible to mimic this using pure JDBC?<br />\nI was running this on MySQL Server 4.1.22 and mysql-connector-java-5.0.4.jar</p>\n"},{"tags":["hibernate","hsqldb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13112966,"title":"No schema in file database after running program persisted to hsqldb:file via hibernate","body":"<p>Here is hibernate.cfg.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:hsqldb:file:test_db_file&lt;/property&gt;\n    &lt;property name=\"hsqldb.write_delay\"&gt;false&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;org.hsqldb.jdbcDriver&lt;/property&gt;\n    &lt;property name=\"dialect\"&gt;org.hibernate.dialect.HSQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;combine1&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;&lt;/property&gt;\n\n    &lt;!-- Enable Hibernate's automatic session context management --&gt;\n    &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n    &lt;!-- Disable the second-level cache  --&gt;\n    &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;\n    &lt;!-- Echo all executed SQL to stdout --&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n    &lt;!-- Drop and re-create the database schema on startup --&gt;\n    &lt;property name=\"hbm2ddl.auto\"&gt;create&lt;/property&gt;\n    &lt;!--\n         few resources\n    --&gt;\n\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>When I change hsqldb to mysql db, it works fine. But when I leave it like this, and I connect hsqldb:file as database in NetBeans, there is nothing in Public schema where I suppose to find created tables after running program.</p>\n\n<p>During runtime, classes are persisted, I can load them from session etc., but after program ends, there is nothing. Except in test_db_file.script are queries to create desired schema, but not rows I saved into db. </p>\n\n<p>Here is my simple main, as I wrote, when I use some mysql database, it works:</p>\n\n<pre><code>import java.util.List;\nimport org.hibernate.Criteria;\nimport org.hibernate.Session;\nimport resources.HibernateUtil;\nimport website.Website;\n\npublic class MrhAdministration {\n\n  public static void main(String[] args) {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n\n    WebsiteCreator.create(session);\n\n    Criteria criterial = session.createCriteria(Website.class);\n    for (Website w : (List&lt;Website&gt;) criterial.list()) {\n      System.out.println(\"Sites: \" + w.getSiteName() + \" \" + w.getSiteUrl());\n    }\n    session.getTransaction().commit();\n  }\n}\n</code></pre>\n\n<p>Thanks for answers!</p>\n"},{"tags":["spring","hibernate","maven","hbm2ddl","hibernate3-maven-plugin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":13113115,"title":"Maven + Spring + Hibernate: hibernate3-maven-plugin hbm2ddl fails for reason \"Caused by: java.lang.NullPointerException\"","body":"<p>I had to downgrade Hibernate from version 4 to version 3 (3.3.2.GA to be specific), due to current lack of support for Hibernate 4 within Spring, and now the project fails to build when it attempts to generate schema with hbm2ddl. The error is too vague, and Google-ing it hasn't yielded much.</p>\n\n<p>Here's my pom.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"\n         http://maven.apache.org/POM/4.0.0\n         http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;example&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;Spring + Hibernate Example&lt;/name&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;spring.version&gt;3.1.2.RELEASE&lt;/spring.version&gt;\n        &lt;hibernate.version&gt;3.3.2.GA&lt;/hibernate.version&gt;\n        &lt;java.version&gt;1.6&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n    &lt;build&gt;\n        &lt;extensions&gt;\n            &lt;extension&gt;\n                &lt;groupId&gt;org.hsqldb&lt;/groupId&gt;\n                &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;\n                &lt;version&gt;2.0.0&lt;/version&gt;\n            &lt;/extension&gt;\n            &lt;extension&gt;\n                &lt;groupId&gt;log4j&lt;/groupId&gt;\n                &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n                &lt;version&gt;1.2.17&lt;/version&gt;\n            &lt;/extension&gt;\n        &lt;/extensions&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.0.2&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;${java.version}&lt;/source&gt;\n                    &lt;target&gt;${java.version}&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;!-- Run \"mvn hibernate3:hbm2ddl\" to generate schema --&gt;\n                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n                &lt;artifactId&gt;hibernate3-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.0&lt;/version&gt;\n\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;generate-ddl&lt;/id&gt;\n                        &lt;phase&gt;process-classes&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;hbm2ddl&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n\n                &lt;configuration&gt;\n                    &lt;hibernatetool destdir=\"${project.build.directory}/generated\"&gt;\n                        &lt;annotationConfiguration configurationfile=\"hibernate.cfg.xml\"/&gt;\n\n                        &lt;hbm2ddl export=\"false\" create=\"true\" update=\"true\"\n                                 format=\"format\" outputfilename=\"schemaDiff.ddl\"/&gt;\n\n                    &lt;/hibernatetool&gt;\n                &lt;/configuration&gt;\n\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;dependencies&gt;\n        &lt;!-- Inversion of Control: Spring Dependencies --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;!-- Exclude the problematic commons-logging --&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-dbcp&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-dbcp&lt;/artifactId&gt;\n            &lt;version&gt;1.4&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Object Relational Mapping: Hibernate --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;${hibernate.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n            &lt;version&gt;${hibernate.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.transaction&lt;/groupId&gt;\n            &lt;artifactId&gt;jta&lt;/artifactId&gt;\n            &lt;version&gt;1.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate.javax.persistence&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-jpa-2.0-api&lt;/artifactId&gt;\n            &lt;version&gt;1.0.1.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Hibernate Annotations Dependencies --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n            &lt;version&gt;3.5.6-Final&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-commons-annotations&lt;/artifactId&gt;\n            &lt;version&gt;3.3.0.ga&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Database: HSQLDB --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hsqldb&lt;/groupId&gt;\n            &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;\n            &lt;version&gt;2.0.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Connection Pool: C3P0 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;c3p0&lt;/groupId&gt;\n            &lt;artifactId&gt;c3p0&lt;/artifactId&gt;\n            &lt;version&gt;0.9.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Second-level caching: Ehcache --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;ehcache&lt;/groupId&gt;\n            &lt;artifactId&gt;ehcache&lt;/artifactId&gt;\n            &lt;version&gt;1.2.3&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Logging: SLF4j &amp; Log4J --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;jcl-over-slf4j&lt;/artifactId&gt;\n            &lt;version&gt;1.6.6&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;1.6.6&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n            &lt;version&gt;1.6.6&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n            &lt;version&gt;1.2.17&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Testing: JUnit --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.10&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Testing: Spring --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;version&gt;${spring.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n&lt;/project&gt;\n</code></pre>\n\n<p>Running</p>\n\n<pre><code>mvn hibernate3:hbm2ddl\n</code></pre>\n\n<p>fails with</p>\n\n<pre><code>[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl\n(default-cli) on project example: There was an error creating the AntRun task.\nNullPointerException -&gt; [Help 1]\n</code></pre>\n\n<p>The full stack trace is:</p>\n\n<pre><code>[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project example: There was an error creating the AntRun task. NullPointerException -&gt; [Help 1]\norg.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project example: There was an error creating the AntRun task.\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)\n    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)\n    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)\n    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)\n    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)\n    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)\nCaused by: org.apache.maven.plugin.MojoExecutionException: There was an error creating the AntRun task.\n    at org.codehaus.mojo.hibernate3.AbstractHibernateMojo.execute(AbstractHibernateMojo.java:84)\n    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)\n    ... 19 more\nCaused by: java.lang.NullPointerException\n    at org.codehaus.plexus.configuration.DefaultPlexusConfiguration.add(DefaultPlexusConfiguration.java:174)\n    at org.codehaus.plexus.configuration.DefaultPlexusConfiguration.addChild(DefaultPlexusConfiguration.java:150)\n    at org.codehaus.mojo.hibernate3.util.PlexusConfigurationUtils.setHibernateConfiguration(PlexusConfigurationUtils.java:289)\n    at org.codehaus.mojo.hibernate3.util.PlexusConfigurationUtils.parseHibernateTool(PlexusConfigurationUtils.java:67)\n    at org.codehaus.mojo.hibernate3.AbstractHibernateToolMojo.getConfiguration(AbstractHibernateToolMojo.java:60)\n    at org.codehaus.mojo.hibernate3.AbstractHibernateMojo.execute(AbstractHibernateMojo.java:76)\n    ... 21 more\n</code></pre>\n\n<p>Hopefully someone can shed some light on this!</p>\n"},{"tags":["java","mysql","spring","hibernate","java-ee"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":11846144,"title":"hibernate not able to reconnect to the mysql DB","body":"<p>In my spring-hibernate application, we are using <code>org.apache.tomcat.jdbc.pool.DataSource</code> for connection pooling. When we start the server, we are able to see the connection to the DB is established and after the mysql service is stopped the server starts throwing error saying that the connection is lost. When the mysql service is started again, should we have to restart the server to reestablish the connections to the DB? Cuz even after providing autoReconnect=true parameter, the application is not able to establish connection to the DB.</p>\n"},{"tags":["hibernate","spring","tomcat","jpa","entitymanager"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":670,"score":0,"question_id":9203122,"title":"Spring JPA Read Write splitting - have transactional use the write datasource","body":"<p>I have an application that uses Hibernate/JPA, with Spring and Jersey. In my application context I set the data source, define an entity manager factory, set the transaction manager with that entity manger factory, and have various service methods annotated with the transactional annotation, so I also have the tx:annotation-driven definition to wire in my transaction manager where needed. This setup works great, I've been able to read and right just fine. I would like to move to a DB setup where I have a Master with multiple slaves (MySQL). So I want all the methods annotated with transactional to use a data source pointing to the master db server, and all others to use a connection pool of the slaves. </p>\n\n<p>I've tried creating two different datasources, with two different entity manager factories, and two different persistent units - ugly to say the least. I tried a MySQL Proxy but we had more problems with that then we need. The connection pooling is handled in the servlet container already. Could I implement something in Tomcat that reads the transaction and directs it to the right database server, or is there a way I could get all those methods annotated with the transactional annotation to use a particular datasource?</p>\n"},{"tags":["hibernate","jpa-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13111819,"title":"String as primary key hibernate and postgres","body":"<p>I is it possible to use a String as a primary key in an Entity. I tried it but its get converted to a biginteger in my postgres db? </p>\n"},{"tags":["java","hibernate","spring","books"],"answer_count":5,"favorite_count":11,"up_vote_count":16,"down_vote_count":0,"view_count":22067,"score":16,"question_id":460739,"title":"What is the best book to learn Spring and Hibernate","body":"<p>I would like to learn Spring and Hibernate in an efficient way.</p>\n\n<p>Next weeks, I will have a lot of time to read but I will not be in front of a computer (so it will difficult to read online tutorials for example).</p>\n\n<p>So, my question is : what is the best book to learn Spring and Hibernate ?</p>\n\n<p>Of course, I know that I'll have to practice a little when I'll progress further in my reading.</p>\n"},{"tags":["hibernate","criteria","restrictions","detachedcriteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13110498,"title":"Hibernate Restcrition Criteria OR with DetachedCritera","body":"<p>I am trying to create a detached criteria that has an OR restriction</p>\n\n<pre><code>    DetachedCriteria subquery = DetachedCriteria.forClass(Component.class);\n    subquery.createCriteria(\"review\").add(Restrictions.eq(\"owner\", user));\n    subquery.createCriteria(\"review\").createCriteria(\"observers\").\n                                   add(Restrictions.eq(\"id\", user.getId())); \n</code></pre>\n\n<p>so bascially I need to put the Restriction.or for the second and third line of the code above, however the Restriction.or does not except DetachedCritera. So I need to do something like this </p>\n\n<pre><code>  Restrictions.or(\n        subquery.createCriteria(\"review\").add(Restrictions.eq(\"owner\", user)),\n        subquery.createCriteria(\"review\").createCriteria(\"observers\").\n                                   add(Restrictions.eq(\"id\", user.getId()));\n</code></pre>\n\n<p>However this wont compile. So how do I achieve this? Any suggestions?</p>\n\n<p>Thanks in advance.\ncheers</p>\n"},{"tags":["spring","hibernate","ehcache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13083987,"title":"Spring3.1 and hibernate4 + eh-cache","body":"<p>I am using <strong>Spring3.1</strong> and <strong>hibernate4</strong> for my web application. Here i am trying for <strong>eh cache</strong> but getting some error, here is my configuration that i have used:- </p>\n\n<p><strong>dispatcher-servlet.xml</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns:cache=\"http://www.springframework.org/schema/cache\"\n    http://www.springframework.org/schema/cache\n    http://www.springframework.org/schema/cache/spring-cache-3.1.xsd\"&gt;\n\n    &lt;cache:annotation-driven /&gt;\n    &lt;bean id=\"defaultEhCacheManager\"\n        class=\"org.springframework.cache.ehcache.EhCacheManagerFactoryBean\"\n        p:config-location=\"/WEB-INF/ehcache.xml\" p:shared=\"false\"&gt;&lt;/bean&gt;\n    &lt;bean id=\"cacheManager\" class=\"org.springframework.cache.ehcache.EhCacheCacheManager\"&gt;\n        &lt;property name=\"cacheManager\" ref=\"ehcache\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n    &lt;cache:annotation-driven cache-manager=\"cacheManager\" /&gt;\n    &lt;bean id=\"cacheManager\"&gt;\n        &lt;property name=\"cacheManager\" ref=\"ehcache\" /&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"ehcache\"\n        class=\"org.springframework.cache.ehcache.EhCacheManagerFactoryBean\"&gt;\n        &lt;property name=\"configLocation\" value=\"/WEB-INF/ehcache.xml\" /&gt;\n    &lt;/bean&gt; \n</code></pre>\n\n<p><strong>ehcache.xml</strong></p>\n\n<pre><code>&lt;cache name=\"sampleCache1\" \n    maxElementsInMemory=\"10000\"\n    eternal=\"false\"\n    overflowToDisk=\"true\"\n    timeToIdleSeconds=\"300\"\n    timeToLiveSeconds=\"600\"&gt;\n&lt;/cache&gt;\n</code></pre>\n\n<p>and here is the dependency:-</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;\n    &lt;artifactId&gt;ehcache-core&lt;/artifactId&gt;\n    &lt;version&gt;2.5.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>I am getting the following error:-- </p>\n\n<p><strong>SEVERE: Context initialization failed\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.cache.interceptor.CacheInterceptor#0': Cannot resolve reference to bean 'cacheManager' while setting bean property 'cacheManager';</strong> nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'cacheManager' defined in ServletContext resource [/WEB-INF/dispatcher-servlet.xml]: Cannot resolve reference to bean 'ehcache' while setting bean property 'cacheManager'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'ehcache' is defined\n    at </p>\n\n<p>Please suggest any solution ASAP.</p>\n\n<p>Thanks In Advance</p>\n"},{"tags":["hibernate","jsp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13109991,"title":"org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:102)","body":"<p>When I compile my jsp page, i have this error : </p>\n\n<pre><code>org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:102)\n</code></pre>\n\n<p>this error is generated when the parser found this code line </p>\n\n<pre><code>Session sessionHibernate = HibernateUtil.getSessionFactory().openSession(); \n</code></pre>\n\n<p>I try to manipulate hibernate in my jsp page. I know that isn't a good practise but i want to know why this code doesn't work. </p>\n"},{"tags":["java","hibernate","orm","maven-2","hibernate-mapping"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1152,"score":1,"question_id":9014760,"title":"Exception in thread \"main\" org.hibernate.MappingException: Unknown entity: from Destination","body":"<p>I am learning hibernate and I can't figure out why is this error popping up. I tried searching but I couldn't find a solution that helped me. I'd like to learn why am I getting this error.</p>\n\n<p><code>Exception in thread \"main\" org.hibernate.MappingException: Unknown entity: from Destination</code></p>\n\n<p>Here are some details:</p>\n\n<pre><code>main():\n\n    public static void main(String[] args) {\n        Session session = HibernateUtil.getSessionFactory().openSession();\n        session.beginTransaction();\n\n//      Destination destination = new Destination();\n//      destination.setName(\"IDelhi\");\n//      destination.setLatitude(1.0f);\n//      destination.setLongitude(123.0f);\n//      session.save(destination);\n\n        List result = session.createCriteria(\"from Destination\").list();\n\n        session.getTransaction().commit();\n\n        session.close();\n\n//      for (Object dest : result) {\n//          Destination d = (Destination)dest;\n//          System.out.println(d.getId() + \": \"+ d.getName());\n//      }\n    }\n}\n</code></pre>\n\n<p>When I try to insert the destination (commented code), values are being inserted into db.</p>\n\n<p>Configurations:</p>\n\n<p>hibernate.cfg.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n                                         \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n &lt;session-factory name=\"\"&gt;\n  &lt;property name=\"hibernate.connection.driver_class\"&gt;org.gjt.mm.mysql.Driver&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.password\"&gt;*****&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.username\"&gt;*****&lt;/property&gt;\n  &lt;property name=\"hibernate.default_schema\"&gt;wah_schema&lt;/property&gt;\n  &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQL5InnoDBDialect&lt;/property&gt;\n  &lt;!-- Echo all executed SQL to stdout --&gt;\n  &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n  &lt;!-- Enable Hibernate's automatic session context management --&gt;\n  &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n  &lt;mapping class=\"org.wah.dao.Destination\" resource=\"org/wah/dao/Destination.hbm.xml\"/&gt;\n &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Destination.hbm.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n                                   \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Jan 25, 2012 3:31:00 PM by Hibernate Tools 3.4.0.CR1 --&gt;\n&lt;hibernate-mapping&gt;\n &lt;class name=\"org.wah.dao.Destination\" table=\"DESTINATION\"&gt;\n  &lt;id name=\"id\" type=\"int\"&gt;\n   &lt;column name=\"ID\"/&gt;\n   &lt;generator class=\"identity\"/&gt;\n  &lt;/id&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"name\" type=\"java.lang.String\"&gt;\n   &lt;column name=\"NAME\"/&gt;\n  &lt;/property&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"latitude\" type=\"float\"&gt;\n   &lt;column name=\"LATITUDE\"/&gt;\n  &lt;/property&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"longitude\" type=\"float\"&gt;\n   &lt;column name=\"LONGITUDE\"/&gt;\n  &lt;/property&gt;\n &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Can someone please help me figure this out ?</p>\n"},{"tags":["hibernate","primefaces"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13108838,"title":"var is the collection, not the item","body":"<p>I'm looping through a collection of 'RSVP' objects and printing out the value of each one's 'Name' property like this</p>\n\n<pre><code>&lt;p:dataTable id=\"rsvpDataTable\" var=\"rsvp\" value=\"#{eventController.event.rsvps}\"...\n   &lt;h:outputText value=\"#{rsvp.name}\" /&gt;\n&lt;/p:dataTable&gt;\n</code></pre>\n\n<p>But I get the error: The class 'org.hibernate.collection.internal.PersistentSet' does not have the property 'name'</p>\n\n<p>If instead, I print out 'rsvp.class.name' to see what type it is, it is indeed a PersistentSet.</p>\n\n<p>But why? It should be single RSVP instance from the collection. </p>\n\n<p>If I debug the code and stop at getRsvps(), I can see that it's returning a PersistentSet containing my RSVP objects. RSVP has a bidirectional relationship back to Event. Would that be causing this? </p>\n\n<p>I'm a bit suspicious about it being a PersistentSet too actually, I would have thought it would have been converted back to a normal 'Java' set by now, but maybe not.</p>\n\n<p>Thanks</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13094031,"title":"Hibernate 4, JPA 2 and HSQL, not able to query by ID","body":"<p>I have a domain object called Service that contains an id field amongst others:</p>\n\n<pre><code>@Id\n@GeneratedValue(strategy = GenerationType.SEQUENCE)\n@Column(name = \"id\", nullable = false)\nprivate Integer id;\n\n@Column(name = \"type\")\nprivate Service.ServiceTypes serviceType;\n</code></pre>\n\n<p>In my DAO implementation, I can easily query by serviceType:</p>\n\n<pre><code>@Override\n    public Set&lt;Service&gt; queryDatabaseByServiceType(ServiceTypes serviceType) {\n        logger.debug(\"Querying the database by service type \" + serviceType.toString());\n        return new HashSet&lt;Service&gt;(super.entityManager.createQuery(\"from Service s where s.type = :serviceType\").setParameter(\"serviceType\", serviceType).getResultList());\n    }\n</code></pre>\n\n<p>When I copy and past that method and try to run the query against \"id\", I get zero results.</p>\n\n<pre><code>@Override\n    public Service queryDatabaseByServiceId(int id) {\nList&lt;Service&gt; results = super.entityManager.createQuery(\"from Service s where s.id = :id\").setParameter(\"id\", id).getResultList();\nreturn results.get(0);\n</code></pre>\n\n<p>always returns nothing....  I've tried it a million different ways...</p>\n\n<pre><code>CriteriaBuilder builder = super.entityManager.getCriteriaBuilder();\nCriteriaQuery&lt;Service&gt; criteria = builder.createQuery(Service.class);\nRoot&lt;Service&gt; s1 = criteria.from(Service.class);\nTypedQuery&lt;Service&gt; query = super.entityManager.createQuery(\n    criteria.select(s1).where(builder.equal(s1.get(\"id\"), id)));\nService service = query.getSingleResult();\nreturn service;\n</code></pre>\n\n<p>Still nothing.  I'm not sure why I can query against other columns but not the ID.  I've verified the IDs I'm passing in are valid, nothing ever works.</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT:  Here are other ways I've tried the query:</p>\n\n<pre><code>Service ser = super.entityManager.find(Service.class, new Integer(1));\n\nList z1 = super.entityManager.createQuery(\"select s.id from Service s\").getResultList();\n\nList results1 = super.entityManager.createQuery(\"SELECT s FROM Service s WHERE id = 1\").getResultList();\n\nList&lt;Service&gt; results = super.entityManager.createQuery(\"from Service as s where s.id = :id\").setParameter(\"id\", new Integer(1)).getResultList();\n</code></pre>\n\n<p>I've tried changing the field in my domain object to \"idx\" instead of \"id\", I've tried changing the column name to \"service_id\" thinking maybe there's some internal conflict between what it uses for the id field and my object, but still nothing.  As noted before and in the comments, querying by any other field works fine and I can easily get results showing the IDs:</p>\n\n<pre><code>return new HashSet&lt;Service&gt;(super.entityManager.createQuery(\"from Service s where s.type = :serviceType\").setParameter(\"serviceType\", serviceType).getResultList());\n</code></pre>\n\n<p>produces a populated list and when converted to json i see this in my browser:</p>\n\n<pre><code>{\"services\":[{\"id\":2,\"serviceType\":\"x\",.....\n</code></pre>\n\n<p>With all those various types of queries, here is the log output:</p>\n\n<pre><code>DEBUG: service.impl.ServiceServiceImpl - Querying the database by service id 2\nHibernate: select service0_.service_id as service1_0_, service0_.description as descript2_0_, service0_.name as name0_, service0_.type as type0_, service0_.tmodel as tmodel0_, service0_.uddi_id as uddi6_0_, service0_.url as url0_, service0_.version as version0_ from services service0_ where service0_.service_id=?\nTRACE: org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [INTEGER] - 1\nINFO : service.impl.ServiceServiceImpl - results list from id query: 0\nHibernate: select service0_.service_id as service1_0_0_, service0_.description as descript2_0_0_, service0_.name as name0_0_, service0_.type as type0_0_, service0_.tmodel as tmodel0_0_, service0_.uddi_id as uddi6_0_0_, service0_.url as url0_0_, service0_.version as version0_0_ from services service0_ where service0_.service_id=?\nTRACE: org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [INTEGER] - 1\nHibernate: select service0_.service_id as col_0_0_ from services service0_\nINFO : service.impl.ServiceServiceImpl - z1 count: 0\nHibernate: select service0_.service_id as service1_0_, service0_.description as descript2_0_, service0_.name as name0_, service0_.type as type0_, service0_.tmodel as tmodel0_, service0_.uddi_id as uddi6_0_, service0_.url as url0_, service0_.version as version0_ from services service0_ where service0_.service_id=1\nINFO : service.impl.ServiceServiceImpl - results1 from id query: 0\nHibernate: select service0_.service_id as service1_0_, service0_.description as descript2_0_, service0_.name as name0_, service0_.type as type0_, service0_.tmodel as tmodel0_, service0_.uddi_id as uddi6_0_, service0_.url as url0_, service0_.version as version0_ from services service0_ where service0_.service_id=2\nINFO : service.impl.ServiceServiceImpl - results2 from id query: 0\nHibernate: select service0_.service_id as service1_0_0_, service0_.description as descript2_0_0_, service0_.name as name0_0_, service0_.type as type0_0_, service0_.tmodel as tmodel0_0_, service0_.uddi_id as uddi6_0_0_, service0_.url as url0_0_, service0_.version as version0_0_ from services service0_ where service0_.service_id=?\nTRACE: org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [INTEGER] - 2\n</code></pre>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13108559,"title":"Lowercase annotation in Hibernate","body":"<p>Is there any way in hibernate to annotate the column of the entity to string lowercase? I mean for example</p>\n\n<pre><code>@Entity  \npublic class User {  \n    @Column  \n    private String username;  \n}\n</code></pre>\n\n<p>I want the hibernate to convert the username to lowercase in all queries not tied to a specific database.</p>\n"},{"tags":["java","hibernate","transactions","tomcat7","jndi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":13108136,"title":"Configure hibernate 4 to connect to database via JNDI Datasource in tomcat 7","body":"<p>I am using Tomcat7,Struts-2.3.5,hibernate-4.1.7 and jotm-2.1.9 width microsoft sqlserver 2005 as my java web application framework. when I use jndi datasource in hibernate configurarion, it refuse to work. I have read a seemingly post in this site,<a href=\"http://stackoverflow.com/questions/5303671/configure-hibernate-to-connect-to-database-via-jndi-datasource/13107547#comment17817603_13107547\">Configure hibernate to connect to database via JNDI Datasource</a>,did not solve the problem.\n1, I put the resource definition in tomcat server.xml,not context.xml under META-INF ;</p>\n\n<pre><code>&lt;Context docBase=\"C:\\workspace\\javaspaces\\sitexa\\web\"\nprivileged=\"true\" antiResourceLocking=\"false\" antiJARLocking=\"false\"&gt;\n&lt;Resource name=\"jdbc/sitexaDB\"\nauth=\"Container\" \ntype=\"javax.sql.DataSource\"\nmaxActive=\"20\" maxIdle=\"5\" maxWait=\"10000\"\nfactory=\"org.objectweb.jotm.datasource.DataSourceFactory\"\ndriverClassName=\"com.microsoft.sqlserver.jdbc.SQLServerDriver\"\nurl=\"jdbc:sqlserver://127.0.0.1:1433;databaseName=sitexa\"\nusername=\"sa\" password=\"\"/&gt;\n&lt;Resource name=\"UserTransaction\" auth=\"Container\"         type=\"javax.transaction.UserTransaction\" /&gt;\n &lt;/Context&gt;\n</code></pre>\n\n<p>2, I put all libs need for database connection and jta under the tomcat folder /lib;</p>\n\n<p>3, in web.xml:</p>\n\n<pre><code>&lt;resource-env-ref&gt;\n&lt;description&gt;DB Connection&lt;/description&gt;\n&lt;resource-env-ref-name&gt;jdbc/sitexaDB&lt;/resource-env-ref-name&gt;\n&lt;resource-env-ref-type&gt;javax.sql.DataSource&lt;/resource-env-ref-type&gt;\n&lt;/resource-env-ref&gt;\n</code></pre>\n\n<p>4, in hibernate.cfg.xml:</p>\n\n<pre><code>&lt;session-factory&gt;\n\n&lt;property name=\"hibernate.connection.datasource\"&gt;java:comp/env/jdbc/sitexaDB&lt;/property&gt;\n\n&lt;property name=\"dialect\"&gt;org.hibernate.dialect.SQLServer2005Dialect&lt;/property&gt;\n&lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n&lt;property name=\"hbm2ddl.auto\"&gt;update&lt;/property&gt;\n&lt;property name=\"hibernate.max_fetch_depth\"&gt;3&lt;/property&gt;\n\n\n&lt;property name=\"hibernate.transaction.jta.platform\"&gt;org.hibernate.service.jta.platform.internal.JOTMJtaPlatform&lt;/property&gt;\n&lt;property name=\"hibernate.transaction.factory_class\"&gt;org.hibernate.engine.transaction.internal.jta.JtaTransactionFactory&lt;/property&gt;\n&lt;property name=\"hibernate.current_session_context_class\"&gt;jta&lt;/property&gt;\n...\n&lt;/session-factory&gt;\n</code></pre>\n\n<p>5, exception:</p>\n\n<pre><code>%%%% Error Creating SessionFactory %%%%\norg.hibernate.service.jndi.JndiException: Unable to lookup JNDI name [java:comp/env/jdbc/sitexaDB]\nat org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:68)\nat org.hibernate.service.jdbc.connections.internal.DatasourceConnectionProviderImpl.configure(DatasourceConnectionProviderImpl.java:116)\n...\nCaused by: javax.naming.NamingException: This context must be accessed through a java: URL\nat org.apache.naming.SelectorContext.parseName(SelectorContext.java:776)\nat org.apache.naming.SelectorContext.lookup(SelectorContext.java:135)\nat javax.naming.InitialContext.lookup(InitialContext.java:415)\nat org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:65)\n</code></pre>\n"},{"tags":["java","hibernate","jndi","connection-pooling"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":13492,"score":3,"question_id":5303671,"title":"Configure hibernate to connect to database via JNDI Datasource","body":"<p>Hi all\nI'm using Hibernate+Struts2+Tomcat6+Mysql as my J2EE framework. I've been using hibernate's built-in connection pooling mechanism but it turned out to be problematic where mysql closes it's connections after 8 hours. Anyway I googled around a little bit and found that I should get my connections through JNDI datasource but I couldn't reach a good and complete tutorial on this. What steps should I take to do so? please provide me enough of details, I'm kinda new on this.\nhere is my hibernate.cfg.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n\n    &lt;property name=\"connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;\n            jdbc:mysql://localhost/hposg?characterEncoding=UTF-8\n    &lt;/property&gt;\n    &lt;property name=\"connection.username\"&gt;root&lt;/property&gt;\n    &lt;property name=\"connection.password\"&gt;&lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n    &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;\n    &lt;property name=\"hbm2ddl.auto\"&gt;update&lt;/property&gt;\n\n    &lt;property name=\"hibernate.max_fetch_depth\"&gt;3&lt;/property&gt;\n\n    &lt;property name=\"hibernate.connection.provider_class\"&gt;org.hibernate.connection.C3P0ConnectionProvider&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.acquire_increment\"&gt;2&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.idle_test_period\"&gt;300&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.timeout\"&gt;1800&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.max_size\"&gt;25&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.min_size\" &gt;3&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.max_statement\"&gt;0&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.preferredTestQuery\"&gt;select 1;&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.testConnectionOnCheckout\"&gt;true&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.validate\"&gt;true&lt;/property&gt;\n\n      &lt;!-- Mapping files --&gt;\n\n      &lt;mapping resource=\"com/hposg/hibernate/resources/Player.hbm.xml\"/&gt;\n      &lt;mapping resource=\"com/hposg/hibernate/resources/Game.hbm.xml\"/&gt;\n      ...\n\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>I also tried this but it didn't work out:\nCreating a context.xml in WebContent/META-INF containing:</p>\n\n<pre><code>&lt;Context path=\"\" docBase=\"../RSGames\" debug=\"0\" reloadable=\"true\"&gt;\n    &lt;Resource name=\"jdbc/RSGames\" auth=\"Container\" type=\"javax.sql.DataSource\"\n         username=\"root\"\n         password=\"\"\n         driverClassName=\"com.mysql.jdbc.Driver\"\n         url=\"jdbc:mysql://localhost:3306/hposg?autoReconnect=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=utf8\"\n         maxActive=\"15\"\n         maxIdle=\"7\"\n         validationQuery=\"Select 1\" /&gt;\n&lt;/Context&gt;\n</code></pre>\n\n<p>putting this in web.xml:</p>\n\n<pre><code>&lt;resource-ref&gt;\n    &lt;description&gt;Connection Pool&lt;/description&gt;\n    &lt;res-ref-name&gt;jdbc/RSGames&lt;/res-ref-name&gt;\n    &lt;res-type&gt;javax.sql.Datasource&lt;/res-type&gt;\n    &lt;res-auth&gt;Container&lt;/res-auth&gt;\n&lt;/resource-ref&gt;\n</code></pre>\n\n<p>and modifying hibernate config like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n  ...\n    &lt;property name=\"connection.datasource\"&gt;java:comp/env/jdbc/RSGames&lt;/property&gt;\n  ...\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>as I mentioned before, it doesn't get connected to database this way. any ideas?</p>\n\n<p>[EDIT]\nWhen I execute the app I get this exception:</p>\n\n<pre><code>Mar 16, 2011 12:29:13 AM com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask run\nWARNING: com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@1f18cbe -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: \njava.lang.NullPointerException\n    at sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(Unknown Source)\n    at sun.jdbc.odbc.JdbcOdbcDriver.knownURL(Unknown Source)\n    at sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(Unknown Source)\n    at java.sql.DriverManager.getDriver(Unknown Source)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.driver(DriverManagerDataSource.java:224)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:120)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:143)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:132)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)\n    at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)\n    at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)\n    at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)\n    at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)\nMar 16, 2011 12:29:13 AM com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask run\nWARNING: com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@14f1726 -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: \njava.lang.NullPointerException\n    at sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(Unknown Source)\n    at sun.jdbc.odbc.JdbcOdbcDriver.knownURL(Unknown Source)\n    at sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(Unknown Source)\n    at java.sql.DriverManager.getDriver(Unknown Source)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.driver(DriverManagerDataSource.java:224)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:120)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:143)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:132)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)\n    at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)\n    at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)\n    at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)\n    at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)\nMar 16, 2011 12:29:13 AM com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask run\nWARNING: com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@cad437 -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: \njava.lang.NullPointerException\n    at sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(Unknown Source)\n    at sun.jdbc.odbc.JdbcOdbcDriver.knownURL(Unknown Source)\n    at sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(Unknown Source)\n    at java.sql.DriverManager.getDriver(Unknown Source)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.driver(DriverManagerDataSource.java:224)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:120)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:143)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:132)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)\n    at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)\n    at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)\n    at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)\n    at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)\n29994 [http-8081-3] WARN org.hibernate.cfg.SettingsFactory - Could not obtain connection to query metadata\njava.sql.SQLException: Connections could not be acquired from the underlying database!\n    at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:106)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:529)\n    at com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:128)\n    at org.hibernate.connection.C3P0ConnectionProvider.getConnection(C3P0ConnectionProvider.java:78)\n    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:114)\n    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2163)\n    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2159)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1383)\n    at com.hposg.hibernate.util.HibernateUtil.buildSessionFactory(HibernateUtil.java:12)\n    at com.hposg.hibernate.util.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:7)\n    at com.hposg.login.LoginFactory.doLogin(LoginFactory.java:25)\n    at com.hposg.controller.struts.LoginAction.execute(LoginAction.java:59)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:441)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:280)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:243)\n    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:165)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:252)\n    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:179)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:94)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:130)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:165)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:179)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:488)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)\n    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.\n    at com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1319)\n    at com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:557)\n    at com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:477)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:525)\n    ... 74 more\n</code></pre>\n"},{"tags":["java","hibernate","postgresql","sequence"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13107502,"title":"GeneratedValue in Postgres","body":"<p>I have my entity class mapped like below:</p>\n\n<pre><code>@Entity\n@Audited\n@Table(name=\"messages_locale\")\npublic class Locale {\n\n    @Id\n    @GeneratedValue\n    @Getter @Setter //Project Lombok's annotations, equal to generated getter and setter method\n    private int id;\n        (...)\n</code></pre>\n\n<p>I create clean new database ,and properties:</p>\n\n<blockquote>\n  <p>&lt; prop key=\"hibernate.hbm2ddl.auto\" >create &lt; /prop></p>\n</blockquote>\n\n<p>WHY THE HELL (Sorry, almost two days wasted on this bug) after created database, i got a sequence in my postgres db?:</p>\n\n<pre><code>CREATE SEQUENCE hibernate_sequence\n  INCREMENT 1\n  MINVALUE 1\n  MAXVALUE 9223372036854775807\n  START 2\n  CACHE 1;\nALTER TABLE hibernate_sequence\n  OWNER TO postgres;\n</code></pre>\n\n<p>I dont want to have a sequence, I want to have just auto increment auto generated values..</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13090747,"title":"Hibernate save new if dirty","body":"<p>Is there a way to force hibernate to save a new instance of an object (new identifier) on saveOrUpdate when an object is dirty (been modified)?  Is this possible via configuration or Interceptor? I have three entities:</p>\n\n<pre><code>Entity A (has B)\nEntity B\nEntity C (has B)\nEntity B can only be updated through A\n</code></pre>\n\n<p>Basically I want C to always hold a snapshot of B when it (C) is created and saved and not directly reference the instance of B that is referenced by A.</p>\n\n<p>B should be modifiable and A should point to the latest version of B.</p>\n\n<p>I could do this manually by implementing equals method, checking for equality and nullifying the id field of B when necessary before calling saveOrUpdate(). Is there a built in way in Hibernate or simpler way?</p>\n"},{"tags":["spring","hibernate","jsf-2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13080166,"title":"Integrating JSF2 with Spring3 and Hibernate4 - applicationContext.xml error?","body":"<p>I'm trying to create a JSF2 application which uses Spring3 for the DI and hibernate to handle the persistence.</p>\n\n<p>I'm stock on the following error and don't know how to proceed:</p>\n\n<pre><code>26/10/2012 1:57:04 PM org.apache.catalina.core.StandardContext listenerStart\nSEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is org.hibernate.InvalidMappingException: Unable to read XML\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)\n    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4206)\n    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)\n    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1079)\n    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:1002)\n    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:506)\n    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317)\n    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065)\n    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)\n    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)\n    at org.apache.catalina.core.StandardService.start(StandardService.java:525)\n    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)\n    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: org.hibernate.InvalidMappingException: Unable to read XML\n    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:109)\n    at org.hibernate.cfg.Configuration.add(Configuration.java:478)\n    at org.hibernate.cfg.Configuration.add(Configuration.java:474)\n    at org.hibernate.cfg.Configuration.add(Configuration.java:647)\n    at org.hibernate.cfg.Configuration.addInputStream(Configuration.java:685)\n    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:272)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    ... 36 more\nCaused by: org.dom4j.DocumentException: Connection refused: connect Nested exception: Connection refused: connect\n    at org.dom4j.io.SAXReader.read(SAXReader.java:484)\n    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:78)\n    ... 43 more\n</code></pre>\n\n<p>my <code>applicationContext.xml</code> is listed below:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:p=\"http://www.springframework.org/schema/p\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n                        http://www.springframework.org/schema/tx\n                        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n                        http://www.springframework.org/schema/context\n                        http://www.springframework.org/schema/context/spring-context-3.1.xsd\"&gt;\n\n    &lt;context:component-scan base-package=\"com.myapp.techrro\" /&gt;\n    &lt;context:annotation-config /&gt;\n\n    &lt;bean class=\"org.springframework.beans.factory.config.CustomScopeConfigurer\"&gt;\n        &lt;property name=\"scopes\"&gt;\n            &lt;map&gt;\n                &lt;entry key=\"view\"&gt;\n                    &lt;bean class=\"com.myapp.util.ViewScope\" /&gt;\n                &lt;/entry&gt;\n            &lt;/map&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"&gt;\n        &lt;property name=\"driverClassName\" value=\"net.sourceforge.jtds.jdbc.Driver\"&gt;\n        &lt;/property&gt;\n        &lt;property name=\"url\" value=\"jdbc:jtds:sqlserver://localhost:1433/myapp\"&gt;\n        &lt;/property&gt;\n        &lt;property name=\"username\" value=\"mydb\"&gt;&lt;/property&gt;\n        &lt;property name=\"password\" value=\"somepass\"&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\"&gt;\n            &lt;ref bean=\"dataSource\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.HSQLDialect&lt;/prop&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.min_size\"&gt;5&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.max_size\"&gt;20&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.idle_test_period\"&gt;300&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.timeout\"&gt;1800&lt;/prop&gt;\n                &lt;prop key=\"hibernate.c3p0.max_statements\"&gt;50&lt;/prop&gt;\n                &lt;prop key=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"c3p0.acquire_increment\"&gt;1&lt;/prop&gt;\n            &lt;/props&gt;\n        &lt;/property&gt;\n        &lt;property name=\"mappingResources\"&gt;\n            &lt;list&gt;\n                &lt;value&gt;com/myapp/techrro/hibernate/UserOrderHist.hbm.xml\n                &lt;/value&gt;\n                &lt;value&gt;com/myapp/techrro/hibernate/UserAccessHist.hbm.xml\n                &lt;/value&gt;\n                &lt;value&gt;com/myapp/techrro/hibernate/User.hbm.xml&lt;/value&gt;\n            &lt;/list&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"userOrderHistDAO\" class=\"com.myapp.techrro.hibernate.userOrderHistDAO\"&gt;\n        &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref bean=\"sessionFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"userAccessHistDAO\" class=\"com.myapp.techrro.hibernate.userAccessHistDAO\"&gt;\n        &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref bean=\"sessionFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"userDAO\" class=\"com.myapp.techrro.hibernate.userDAO\"&gt;\n        &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref bean=\"sessionFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<h2>Update:</h2>\n\n<p>below are my mapping files, they were generated by myEclipse:</p>\n\n<p><code>User.hbm.xml</code>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd \"&gt;\n&lt;!-- \n    Mapping file autogenerated by MyEclipse Persistence Tools\n--&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.myapp.techrro.hibernate.User\" table=\"User\" schema=\"dbo\" catalog=\"mydb\"&gt;\n        &lt;id name=\"user_PK\" type=\"java.lang.Long\"&gt;\n            &lt;column name=\"user_PK\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"username\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"username\" length=\"20\" not-null=\"true\" unique=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"password\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"password\" length=\"40\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"userRole\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"userRole\" length=\"1\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"active\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"active\" length=\"1\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"type\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"type\" length=\"3\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"firstName\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"firstName\" length=\"30\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"lastName\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"lastName\" length=\"30\" /&gt;\n        &lt;/property&gt;\n        &lt;set name=\"userOrderHistLog\" inverse=\"true\"&gt;\n            &lt;key&gt;\n                &lt;column name=\"user_PK\" /&gt;\n            &lt;/key&gt;\n            &lt;one-to-many class=\"com.myapp.techrro.hibernate.userOrderHist\" /&gt;\n        &lt;/set&gt;\n        &lt;set name=\"userAccessHistLog\" inverse=\"true\"&gt;\n            &lt;key&gt;\n                &lt;column name=\"user_PK\" not-null=\"true\" /&gt;\n            &lt;/key&gt;\n            &lt;one-to-many class=\"com.myapp.techrro.hibernate.userAccessHist\" /&gt;\n        &lt;/set&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p><code>UserOrderHist.hbm.xml</code>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd \"&gt;\n&lt;!-- \n    Mapping file autogenerated by MyEclipse Persistence Tools\n--&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.myapp.techrro.hibernate.userOrderHist\" table=\"userOrderHist\" schema=\"dbo\" catalog=\"mydb\"&gt;\n        &lt;id name=\"userOrderHis_PK\" type=\"java.lang.Long\"&gt;\n            &lt;column name=\"userOrderHis_PK\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;many-to-one name=\"user\" class=\"com.myapp.techrro.hibernate.User\" fetch=\"select\"&gt;\n            &lt;column name=\"user_PK\" /&gt;\n        &lt;/many-to-one&gt;\n        &lt;property name=\"action\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"action\" length=\"1\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"prod\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"username\" length=\"20\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"type\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"userRole\" length=\"1\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"Updated\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"deleteFG\" length=\"1\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p><code>UserAccessHist.hbm.xml</code>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd \"&gt;\n&lt;!-- \n    Mapping file autogenerated by MyEclipse Persistence Tools\n--&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.myapp.techrro.hibernate.userAccessHist\" table=\"userAccessHist\" schema=\"dbo\" catalog=\"mydb\"&gt;\n        &lt;id name=\"userAccessHistPK\" type=\"java.lang.Long\"&gt;\n            &lt;column name=\"userAccessHistPK\" /&gt;\n            &lt;generator class=\"identity\" /&gt;\n        &lt;/id&gt;\n        &lt;many-to-one name=\"user_PK\" class=\"com.myapp.techrro.hibernate.User\" fetch=\"select\"&gt;\n            &lt;column name=\"adminUserPK\" not-null=\"true\" /&gt;\n        &lt;/many-to-one&gt;\n        &lt;property name=\"createdDate\" type=\"java.sql.Timestamp\"&gt;\n            &lt;column name=\"createdDate\" length=\"23\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"accessDetail\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"accessDetail\" length=\"100\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Can someone please possible causes of such error? Thanks </p>\n"},{"tags":["hibernate","annotations","criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5957,"score":1,"question_id":6083660,"title":"Join two tables in Hibernate with Criteria API and Annotation","body":"<p>I want to join 2 tables in mysql with Hibernate Annotations and Criteria\nLike for example \nI have 2 tables  candidates and jobs having 2 columns each ,candidates: candID &amp; candName jobs: jobID &amp; jobName</p>\n\n<pre><code>                            candidates                     jobs       \n                  candID    candName          jobID          jobName\n                      1          abc                       1               job1\n                      2          xyz                       2               job2\n</code></pre>\n\n<p>i need to create a query in Criteria in hibernate     as     select candName  ,jobName    from candidates as c ,jobs as j  where c.candID = j.jobID where candName = abc and jobName=job1</p>\n\n<p>what will be the criteria query for that and most importantly what will i write in my annotation class ( as i am using spring annotations) and do i need to write anything in my applicantioncontext.xml...</p>\n\n<p>Thanks \nI will be really greatful if you can help me with that as i am struggling for last  3 days for it with no success</p>\n\n<p>thanks</p>\n"},{"tags":["java","hibernate","jpa","equals"],"answer_count":2,"favorite_count":19,"up_vote_count":20,"down_vote_count":0,"view_count":3148,"score":20,"question_id":6033905,"title":"Create the perfect JPA entity","body":"<p>I've been working with JPA (implementation Hibernate) for some time know and each time I need to create entities I find myself struggling with issues as AccessType, immutable properties, equals/hashCode, ... .<br>\nSo I decided to try and find out the general best practice for each issue and write this down for personal use.<br>\nI would not mind however for anyone to comment on it or to tell me where I'm wrong.</p>\n\n<h2>Entity Class</h2>\n\n<ul>\n<li><p>implement Serializable  </p>\n\n<p>Reason: <em>The specification says you have to, but some JPA providers do not enforce this. Hibernate as JPA provider does not enforce this, but it can fail somewhere deep in its stomach with ClassCastException, if Serializable has not been implemented.</em></p></li>\n</ul>\n\n<h2>Constructors</h2>\n\n<ul>\n<li><p>create a constructor with all required fields of the entity </p>\n\n<p><em>Reason: A constructor should always leave the instance created in a sane state.</em>  </p></li>\n<li><p>besides this constructor: have a package private default constructor  </p>\n\n<p><em>Reason: Default constructor is required to have Hibernate initialize the entity; private is allowed but package private (or public) visibility is required for runtime proxy generation and efficient data retrieval without bytecode instrumentation.</em></p></li>\n</ul>\n\n<h2>Fields/Properties</h2>\n\n<ul>\n<li><p>Use field access in general and property access when needed  </p>\n\n<p><em>Reason:  this is probably the most debatable issue since there are no clear and convincing  arguments for one or the other (property access vs field access); however, field access seems to be general favourite because of clearer code, better encapsulation and no need to create setters for immutable fields</em> </p></li>\n<li><p>Omit setters for immutable fields (not required for access type field)</p></li>\n<li>properties may be private<br>\nReason: I once heard that protected is better for (Hibernate) performance but all I can find on the web is: <em>Hibernate can access public, private, and protected accessor methods, as well as public, private and protected fields directly. The choice is up to you and you can match it to fit your application design.</em></li>\n</ul>\n\n<h2>Equals/hashCode</h2>\n\n<ul>\n<li>Never use a generated id if this id is only set when persisting the entity</li>\n<li>By preference: use immutable values to form a unique Business Key and use this to test equality</li>\n<li>if a unique Business Key is not available use a non-transient UUID which is created when the entity is initialized</li>\n<li><strong>never</strong> refer to related entities (ManyToOne); if this entity (like a parent entity) needs to be part of the Business Key then add a non insertable, non updatable field to store the parent id (with the same name as the ManytoOne JoinColumn) and use this id in the equality check</li>\n</ul>\n\n<h2>Example Entity</h2>\n\n<pre><code>@Entity\n@Table(name = \"ROOM\")\npublic class Room implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"room_id\")\n    private Integer id;\n\n    @Column(name = \"number\") \n    private String number; //immutable\n\n    @Column(name = \"capacity\")\n    private Integer capacity;\n\n    @ManyToOne(fetch = FetchType.LAZY, optional = false)\n    @JoinColumn(name = \"building_id\")\n    private Building building; //immutable\n\n    @Column(name = \"building_id\", insertable = false, updatable = false)\n    private Integer buildingId; //also stores the building_id so we can reference this without fetching the parent building\n\n    Room() {\n        // default constructor\n    }\n\n    public Room(Building building, String number) {\n        // constructor with required field\n        notNull(building, \"Method called with null parameter (application)\");\n        notNull(number, \"Method called with null parameter (name)\");\n\n        this.building = building;\n        this.number = number;\n        this.buildingId = building.getId();\n    }\n\n    @Override\n    public boolean equals(final Object otherObj) {\n        if ((otherObj == null) || !(otherObj instanceof Room)) {\n            return false;\n        }\n        // a room can be uniquely identified by it's number and the building it belongs to\n        final Room other = (Room) otherObj;\n        return new EqualsBuilder().append(getNumber(), other.getNumber())\n                .append(getBuildingId(), other.getBuildingId())\n                .isEquals();\n    }\n\n    public Building getBuilding() {\n        return building;\n    }\n\n    public Integer getBuildingId() {\n        return buildingId;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public String getNumber() {\n        return number;\n    }\n\n    @Override\n    public int hashCode() {\n        return new HashCodeBuilder().append(getNumber()).append(getBuildingId()).toHashCode();\n    }\n\n    public void setCapacity(Integer capacity) {\n        this.capacity = capacity;\n    }\n\n//no setters for number, building nor id\n    }\n</code></pre>\n\n<p>Other suggestions to add to this list are more than welcome...</p>\n"},{"tags":["java","hibernate","named-query","hibernate-entitymanager"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13102792,"title":"Hibernate update with EntityManager","body":"<p>I am using Hibernate 4.1.7 and trying to update object, but theres no documentation how it should be done. Currently, I am doing this:</p>\n\n<pre><code>    Person person = personDao.getPersonById(1);\n    person.setAge(23);\n    person.setLastname(\"McName\");\n    person = personDao.update(person);\n</code></pre>\n\n<p>In PersonDao update looks like:</p>\n\n<pre><code>    public Person update(Person person) {\n      return entityManager.merge(person);\n    }\n</code></pre>\n\n<p>In PersonDao getPersonById is:</p>\n\n<pre><code>    public Person getPersonById(int id) {\n      personQuery = entityManager.createNamedQuery(\"Person.findPerson\", Person.class);\n      personQuery.setParameter(\"id\", id);\n      return personQuery.getSingleResult();\n    }\n</code></pre>\n\n<p>Also I have defined named query inside Person class and is here:</p>\n\n<pre><code>    @NamedQuery(name=\"Person.findPerson\", query=\"SELECT p FROM Person p WHERE p.id = :id\")\n</code></pre>\n\n<p>By using that my Person won't be updated, how should I implement update using hibernate?</p>\n"},{"tags":["hibernate","osgi","classnotfound"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13104553,"title":"Virgo Hibernate ClassNotFound","body":"<p>I am trying to deploy a sample application to virgo (I put third-party jar files on repository/usr). after some long hours of resolving project dependencies I got ClassNotFound for \"org.springframework.orm.hibernate3.LocalSessionFactoryBean\", so I added spring-orm dependency on the manifest. the problem got solved but this time I got NoClassDefFound for \"org/hibernate/cfg/Configuration\". so I added \"com.springsource.org.hibernate.core\" on bundles in manifest but nothing happens:\n...\nCaused by: java.lang.NoClassDefFoundError: org/hibernate/cfg/Configuration\n    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.(LocalSessionFactoryBean.java:189)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n    at java.lang.reflect.Constructor.newInstance(Unknown Source)\n    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:126)\n    ... 20 common frames omitted\nI don't have a clue where to look for something suspicious!!! help me plz :|</p>\n"},{"tags":["spring","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":59,"score":-1,"question_id":13041123,"title":"Hibernate Spring JPA annotations exception on context initialization - NoSuchMethodError: javax.persistence.Table.uniqueConstraints()","body":"<p>Having this problem. Seems to deploy okay then the problem reappears... Can't figure out what's up. Tried from both netbeans and intellij, tried on tomcat and jetty.</p>\n\n<p>Looks like it's somehow related to JPA annotations... Unsure how to proceed. Could this be related to my jdk?</p>\n\n<p>Pom.xml for the services module that uses annotations.</p>\n\n<p>http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    \n        hpweb\n        hpweb\n        1.0\n    \n    4.0.0</p>\n\n<pre><code>&lt;artifactId&gt;service&lt;/artifactId&gt;\n&lt;packaging&gt;jar&lt;/packaging&gt;\n\n&lt;name&gt;service&lt;/name&gt;\n&lt;url&gt;http://maven.apache.org&lt;/url&gt;\n\n&lt;properties&gt;\n    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;hibernate.version&gt;3.5.4-Final&lt;/hibernate.version&gt;\n&lt;/properties&gt;\n\n&lt;repositories&gt;\n\n&lt;/repositories&gt;\n\n&lt;dependencies&gt;\n\n    &lt;dependency&gt;\n        &lt;artifactId&gt;common&lt;/artifactId&gt;\n        &lt;groupId&gt;hpweb&lt;/groupId&gt;\n        &lt;version&gt;1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;junit&lt;/groupId&gt;\n        &lt;artifactId&gt;junit&lt;/artifactId&gt;\n        &lt;version&gt;3.8.1&lt;/version&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- Spring framework --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n        &lt;version&gt;${spring.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n        &lt;version&gt;${spring.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;\n        &lt;version&gt;${spring.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- MySQL database driver --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;mysql&lt;/groupId&gt;\n        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n        &lt;version&gt;5.1.9&lt;/version&gt;\n    &lt;/dependency&gt;\n\n\n    &lt;!-- SQLite JDBC library --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.xerial&lt;/groupId&gt;\n        &lt;artifactId&gt;sqlite-jdbc&lt;/artifactId&gt;\n        &lt;version&gt;3.7.2&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- Hibernate framework --&gt;\n\n\n    &lt;!--dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate&lt;/artifactId&gt;\n        &lt;version&gt;${hibernate.version}&lt;/version&gt;\n    &lt;/dependency--&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n        &lt;version&gt;${hibernate.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n        &lt;version&gt;${hibernate.version}&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n        &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n        &lt;version&gt;1.6.6&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!--Hibernate library dependecy start &gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;dom4j&lt;/groupId&gt;\n        &lt;artifactId&gt;dom4j&lt;/artifactId&gt;\n        &lt;version&gt;1.6.1&lt;/version&gt;\n    &lt;/dependency--&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n        &lt;version&gt;1.1.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;commons-collections&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;\n        &lt;version&gt;3.2.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!--dependency&gt;\n        &lt;groupId&gt;org.hibernate.javax.persistence&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-jpa-2.0-api&lt;/artifactId&gt;\n        &lt;version&gt;1.0.1.Final&lt;/version&gt;\n    &lt;/dependency--&gt;\n\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;antlr&lt;/groupId&gt;\n        &lt;artifactId&gt;antlr&lt;/artifactId&gt;\n        &lt;version&gt;2.7.7&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;javassist&lt;/groupId&gt;\n        &lt;artifactId&gt;javassist&lt;/artifactId&gt;\n        &lt;version&gt;3.12.1.GA&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- Generic dao --&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.sakaiproject&lt;/groupId&gt;\n        &lt;artifactId&gt;generic-dao&lt;/artifactId&gt;\n        &lt;version&gt;0.9.18&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.soundcloud&lt;/groupId&gt;\n        &lt;artifactId&gt;java-api-wrapper&lt;/artifactId&gt;\n        &lt;version&gt;1.0.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n&lt;/dependencies&gt;\n</code></pre>\n\n<p></p>\n\n<p>stack trace</p>\n\n<pre><code>SEVERE: Context initialization failed\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: com.heavypressure.service.IUserService com.heavypressure.web.controller.impl.UserController.userService; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.heavypressure.orm.dao.impl.UserDao com.heavypressure.service.impl.UserService.userDao; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userDao' defined in URL [jar:file:/Users/tripled153/IdeaProjects/heavypressure/hpweb/web/target/web/WEB-INF/lib/service-1.0.jar!/com/heavypressure/orm/dao/impl/UserDao.class]: Unsatisfied dependency expressed through constructor argument with index 0 of type [org.hibernate.SessionFactory]: : Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)\n    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)\n    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:655)\n    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1628)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:680)\nCaused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: com.heavypressure.service.IUserService com.heavypressure.web.controller.impl.UserController.userService; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.heavypressure.orm.dao.impl.UserDao com.heavypressure.service.impl.UserService.userDao; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userDao' defined in URL [jar:file:/Users/tripled153/IdeaProjects/heavypressure/hpweb/web/target/web/WEB-INF/lib/service-1.0.jar!/com/heavypressure/orm/dao/impl/UserDao.class]: Unsatisfied dependency expressed through constructor argument with index 0 of type [org.hibernate.SessionFactory]: : Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)\n    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n    ... 27 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.heavypressure.orm.dao.impl.UserDao com.heavypressure.service.impl.UserService.userDao; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userDao' defined in URL [jar:file:/Users/tripled153/IdeaProjects/heavypressure/hpweb/web/target/web/WEB-INF/lib/service-1.0.jar!/com/heavypressure/orm/dao/impl/UserDao.class]: Unsatisfied dependency expressed through constructor argument with index 0 of type [org.hibernate.SessionFactory]: : Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:876)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:818)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)\n    ... 29 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.heavypressure.orm.dao.impl.UserDao com.heavypressure.service.impl.UserService.userDao; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userDao' defined in URL [jar:file:/Users/tripled153/IdeaProjects/heavypressure/hpweb/web/target/web/WEB-INF/lib/service-1.0.jar!/com/heavypressure/orm/dao/impl/UserDao.class]: Unsatisfied dependency expressed through constructor argument with index 0 of type [org.hibernate.SessionFactory]: : Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)\n    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\n    ... 40 more\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userDao' defined in URL [jar:file:/Users/tripled153/IdeaProjects/heavypressure/hpweb/web/target/web/WEB-INF/lib/service-1.0.jar!/com/heavypressure/orm/dao/impl/UserDao.class]: Unsatisfied dependency expressed through constructor argument with index 0 of type [org.hibernate.SessionFactory]: : Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:730)\n    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:196)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:876)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:818)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)\n    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)\n    ... 42 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [service-spring.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:876)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:818)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)\n    at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:795)\n    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:723)\n    ... 55 more\nCaused by: java.lang.NoSuchMethodError: javax.persistence.Table.uniqueConstraints()[Ljavax/persistence/UniqueConstraint;\n    at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:550)\n    at org.hibernate.cfg.AnnotationConfiguration.processArtifactsOfType(AnnotationConfiguration.java:636)\n    at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:359)\n    at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1206)\n    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:717)\n    at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:188)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    ... 66 more\n</code></pre>\n"},{"tags":["hibernate","spring"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2776,"score":0,"question_id":6716087,"title":"java.lang.IllegalStateException: LifecycleProcessor not initialized - call 'refresh' before invoking lifecycle methods via the context","body":"<p>I'm using maven_spring 3.1.M2 + hibernate 3.5. Once I put the line <code>&lt;tx:annotation-driven /&gt;</code> in my applicationcontex xml file, the follwoing error will occur:</p>\n\n<pre><code>WARNING: Exception thrown from LifecycleProcessor on context close\njava.lang.IllegalStateException: LifecycleProcessor not initialized - call 'refresh' before invoking lifecycle methods via the context: Root WebApplicationContext: startup date [Sat Jul 16 13:00:52 IST 2011]; root of context hierarchy\n    at org.springframework.context.support.AbstractApplicationContext.getLifecycleProcessor(AbstractApplicationContext.java:350)\n    at org.springframework.context.support.AbstractApplicationContext.doClose(AbstractApplicationContext.java:1033)\n    at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:988)\n    at org.springframework.web.context.ContextLoader.closeWebApplicationContext(ContextLoader.java:534)\n    at org.springframework.web.context.ContextLoaderListener.contextDestroyed(ContextLoaderListener.java:142)\n    at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4721)\n    at org.apache.catalina.core.StandardContext$4.call(StandardContext.java:5423)\n        at org.apache.catalina.core.StandardContext$4.call(StandardContext.java:5402)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>What should I do to fix this?</p>\n"},{"tags":["hibernate","grails","join"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12804627,"title":"Join statement in hibernate criteria builder in grails","body":"<p>I would like to create following statement in Grails with HibernateCriteriaBuilder :</p>\n\n<pre><code>SELECT * FROM person p \n  JOIN person_authority pa ON p.id=pa.person_id \n  JOIN authority a ON pa.authority_id=a.id \n  WHERE a.authority IN ('ROLE_ADMIN');\n</code></pre>\n\n<p>person_authority is join table.</p>\n\n<p>Update:</p>\n\n<p>My Person class is:</p>\n\n<pre><code>class Person {\n\ntransient springSecurityService\n\nDate dateCreated\nDate lastLogin\n\nString username\nString password\nString email;\nboolean enabled\nboolean accountExpired\nboolean accountLocked\nboolean passwordExpired\n\nstatic constraints = {\n    username blank: false, unique: true\n    email blank:false, unique: true, email: true\n    password blank: false\n    lastLogin nullable:true\n}\n\nstatic mapping = {\n    hasMany authority:Authority;\n    password column: '`password`'\n}\n\n//Set&lt;Authority&gt; getAuthorities() {\n//  PersonAuthority.findAllByPerson(this).collect { it.authority } as Set\n//}\n\ndef beforeInsert() {\n    encodePassword()\n}\n\ndef beforeUpdate() {\n    if (isDirty('password')) {\n        encodePassword()\n    }\n}\n\nprotected void encodePassword() {\n    password = springSecurityService.encodePassword(password)\n}\n\npublic static def query(Map params = [:]){\n\n    def rows = withCriteria(max:params.max,offset:params.offset){\n        if(params.authorities){\n            authorities{\n                'in'('authority', params.authorities)\n            }\n        }\n        order(params.column?:\"id\",params.order?:\"asc\")\n        if(params.id){\n            idEq (params.id as Long);\n        }\n        if(params.username){\n            ilike \"username\",\"%\"+params.username+\"%\"\n        }\n        if(params.email){\n            ilike \"email\",\"%\"+params.email+\"%\"\n        }\n        if(params.accountLocked){\n            eq \"accountLocked\",Boolean.valueOf(params.accountLocked)\n        }\n        if(params.enabled){\n            eq \"enabled\",Boolean.valueOf(params.enabled)\n        }\n        if(params.passwordExpired){\n            eq \"passwordExpired\",Boolean.valueOf(params.passwordExpired)\n        }\n    }\n    return rows;\n}\n}\n</code></pre>\n\n<p>Criteria I want to build is in method query. When I try to execute it I get <code>groovy.lang.MissingMethodException: No signature of method: grails.orm.HibernateCriteriaBuilder.authorities() is applicable for argument types ...</code></p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1775,"score":1,"question_id":4431059,"title":"Data not inserted using hibernate, but gives no error?","body":"<p>I'm trying to get started with Hibernate, but can't insert data, for some reason. It seems to be working properly as no error is given, but when I check the database the table is empty. I don't think it the connection to the database itself that fail, because when I change the table name to a non-excisting one in the mapping xml, Hibernate creates this on the fly (But as I said, no data is inserted). Does anyone know what the problem could be?</p>\n\n<p>Here's my code:</p>\n\n<p>hibernate.cfg.xml:</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD//EN\"\n\"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n          &lt;property     name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n          &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/intex&lt;/property&gt;\n          &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n          &lt;property name=\"hibernate.connection.password\"&gt;&lt;/property&gt;\n          &lt;property name=\"hibernate.connection.pool_size\"&gt;10&lt;/property&gt;\n          &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n          &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n          &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/property&gt;\n          &lt;!-- Mapping files --&gt;\n          &lt;mapping resource=\"intex.hbm.xml\"/&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>My mapping xml:</p>\n\n<p>\n</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n  &lt;class name=\"com.intex.uni.courses.Course\" table=\"course\"&gt;\n   &lt;id name=\"id\" column=\"id\" &gt;\n   &lt;generator class=\"increment\"/&gt;\n  &lt;/id&gt;\n\n  &lt;property name=\"name\" column=\"name\" /&gt;\n  &lt;property name=\"description\" column=\"description\" /&gt;\n  &lt;property name=\"url\" column=\"url\" /&gt;\n  &lt;property name=\"code\" column=\"code\" /&gt;\n &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>And my test client:</p>\n\n<pre><code>public class HibernateTest {\n\n    public static void main(String[] args) {\n\n        Session session = null;\n\n        try {\n            SessionFactory sessionFactory = new Configuration().configure().buildSessionFactory();\n            session = sessionFactory.openSession();\n            Course course = new Course();\n            course.setDescription(\"Description\");\n            course.setName(\"NAME\");\n            course.setUrl(\"http://www.url.com\");\n            session.save(course);\n        } catch (Exception e) {\n            System.out.println(e.getMessage());\n        } finally {\n            session.flush();\n            session.close();\n        }\n    }\n}\n</code></pre>\n\n<p>I really hope someone will be able to help me! Thanks in advance :)</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":74,"score":2,"question_id":13101882,"title":"JPA OneToMany : List vs Set","body":"<p>Say I have two entities USER and NOTIFICATION. And I have a relationship as shown below.</p>\n\n<pre><code> public class UserAccount{\n\n    @Id\n    @Column(name = \"USER_NAME\")\n    private String emailid;\n\n    @OneToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @JoinTable(name = \"USERS_NOTIFICATIONS\", joinColumns = { @JoinColumn(name = \"USER_NAME\") }, inverseJoinColumns = { @JoinColumn(name = \"NOTIFICATION_ID\") })\n    private List&lt;Notification&gt; notifications;\n\n    //setters, getter, equals and hashcode\n }\n</code></pre>\n\n<p>I have overridden equals and hashcode (IDE generated with my business key/primary key). Say I have user A. When I add the first notification I get a normal insert statement. But on further addition for the same user it deletes and then inserts. This is the log:</p>\n\n<pre><code>Hibernate: delete from USERS_NOTIFICATIONS where USER_NAME=?\nHibernate: insert into USERS_NOTIFICATIONS (USER_NAME, NOTIFICATION_ID) values (?, ?)\nHibernate: insert into USERS_NOTIFICATIONS (USER_NAME, NOTIFICATION_ID) values (?, ?)\nHibernate: insert into USERS_NOTIFICATIONS (USER_NAME, NOTIFICATION_ID) values (?, ?)\n//as many inserts as the notifications the user has\n</code></pre>\n\n<p>Same thing happens with every user. Now, if I replace the List with Set, a normal insert happens. And I found the reason after reading the <a href=\"http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch20.html#performance-collections-mostefficientupdate\" rel=\"nofollow\">doucmentation</a> and a <a href=\"http://assarconsulting.blogspot.in/2009/08/why-hibernate-does-delete-all-then-re.html\" rel=\"nofollow\">blog</a>. </p>\n\n<p><strong>Observations from docs</strong></p>\n\n<ul>\n<li>In a unidirectional OneToMany association Set is preferred.</li>\n</ul>\n\n<blockquote>\n  <p>it should be clear that indexed collections and sets allow the most efficient operation in terms of adding, removing and updating elements.</p>\n</blockquote>\n\n<ul>\n<li>In a bidirectional OneToMany  relationship (ManyToOne managing) List and Bags are efficient.</li>\n</ul>\n\n<blockquote>\n  <p>Bags and lists are the most efficient inverse collections</p>\n</blockquote>\n\n<p>Couple of questions</p>\n\n<ol>\n<li>Does this mean I have to prefer a Set over a List in a unidirectional OneToMany mapping (pretty obvious though)? But is there a work around?</li>\n<li>Or do I have to tweak my domain to make it a bidirectional relationship to use a list, esp when I have duplicates.</li>\n</ol>\n"},{"tags":["java","hibernate","spring-mvc","criteria","displaytag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13100720,"title":"Hibernate criteria addOrder messes results","body":"<p>My User table looks like this:</p>\n\n<pre><code>USER (\n    \"USER_ID\" NUMBER(15,0) NOT NULL, \n    \"TYPE\" NUMBER(2,0), \n    \"DOMAIN_ID\" NUMBER(15,0), \n    \"FIRST_NAME\" VARCHAR2(64), \n    \"LAST_NAME\" VARCHAR2(64) NOT NULL, \n    \"EMAIL\" VARCHAR2(256), \n    \"PHONE_NUMBER\" VARCHAR2(11), \n    \"IS_ENABLED\" NUMBER(1,0),\n)\n</code></pre>\n\n<p>ORM looks like this:</p>\n\n<pre><code>@Entity\n@Table(name = \"\\\"USER\\\"\")\npublic class User implements Serializable\n{\n    @Id\n    @GeneratedValue(generator = \"USER_SEQ\")\n    @GenericGenerator(name = \"USER_SEQ\", strategy = \"sequence\", parameters = @Parameter(name = \"sequence\", value = \"SEQ_USER_ID\"))\n    @Column(name = \"USER_ID\", nullable = false)\n    private Long userId;\n\n    @Column(name = \"FIRST_NAME\")\n    private String firstName;\n\n    @Column(name = \"LAST_NAME\")\n    private String lastName;\n\n    @Column(name = \"EMAIL\")\n    private String email;\n\n    @Column(name = \"PHONE_NUMBER\")\n    private String phoneNumber;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @Cascade(CascadeType.ALL)\n    @JoinColumn(name = \"DOMAIN_ID\")\n    @ForeignKey(name = \"DOMAIN_ID\")\n    private Domain domain;\n\n    @Column(name = \"IS_ENABLED\")\n    private Boolean isEnabled;\n\n    @Column(name = \"TYPE\")\n    private Integer type;\n}\n</code></pre>\n\n<p>And I'm doing Criteria for the user list:</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\npublic List&lt;User&gt; getUsersList( String firstName, String lastName, Integer domainId, Boolean activeFlag, String email,\n                                String phoneNr, int pageNr, int pageSize, String sortColumn, Boolean sortAscending )\n{\n    Session session = sessionFactory.getCurrentSession();\n    Criteria criteria = createUserCriteria( firstName, lastName, domainId, activeFlag, email, phoneNr, session );\n\n    criteria.createAlias( \"domain\", \"domain\" );\n    criteria.setFirstResult( pageSize * pageNr );\n    criteria.setMaxResults( pageSize );\n    criteria.setFetchSize( pageSize );\n\n    Order order;\n    if ( sortColumn != null &amp;&amp; sortAscending != null )\n    {\n        order = (sortAscending) ? Order.asc( sortColumn ) : Order.desc( sortColumn );\n    } else\n    {\n        order = Order.asc( \"lastName\" );\n    }\n\n    criteria.addOrder( order );\n\n    return criteria.list();\n}\n\nprivate Criteria createBusinessUserCriteria( String firstName, String lastName, Integer domainId, Boolean activeFlag, String email, String phoneNr, Session session )\n{\n    Criteria criteria = session.createCriteria( User.class );\n    // only businness users\n    criteria.add( Restrictions.eq( \"type\", UserTypeEnum.BUSINESS_USER.getUserTypeId() ) );\n\n    if ( firstName != null )\n    {\n        criteria.add( Restrictions.like( \"firstName\", firstName + \"%\" ).ignoreCase() );\n    }\n    if ( lastName != null )\n    {\n        criteria.add( Restrictions.like( \"lastName\", lastName + \"%\" ).ignoreCase() );\n    }\n    if ( domainId != null )\n    {\n        criteria.add( Restrictions.eq( \"domain.domainId\", domainId ) );\n    }\n    if ( activeFlag != null )\n    {\n        criteria.add( Restrictions.eq( \"isEnabled\", activeFlag ) );\n    } else\n    {\n        criteria.add( Restrictions.eq( \"isEnabled\", true ) );\n    }\n    if ( email != null )\n    {\n        criteria.add( Restrictions.like( \"email\", email + \"%\" ).ignoreCase() );\n    }\n    if ( phoneNr != null )\n    {\n        criteria.add( Restrictions.like( \"phoneNumber\", phoneNr + \"%\" ).ignoreCase() );\n    }\n    return criteria;\n}\n</code></pre>\n\n<p>Quite simple, when theres no Order param passed to method, I'm using default sort by user <code>Lastname</code>.\nPageSize is 25, pageNr is taken from httpRequest param (DisplayTag), it starts from 0 and goes up.</p>\n\n<p>Spring MVC controller for this:</p>\n\n<pre><code>@RequestMapping(value = \"/GetNotificationUsers/\", method = RequestMethod.GET)\npublic String getNotificationUsers( @ModelAttribute(\"eventNotifUserSearchForm\") UsersSearchForm searchForm, Model model,\n                                     HttpServletRequest request ) throws IOException\n{\n    searchForm.setDefaultsToNull();\n\n    Integer pageNr = 0;\n    String pageNoParamAsString = request.getParameter( new ParamEncoder( \"eventNotifUsers\" ).encodeParameterName(\n            TableTagParameters.PARAMETER_PAGE ) );\n    if ( pageNoParamAsString != null &amp;&amp; !pageNoParamAsString.isEmpty() )\n    {\n        pageNr = Integer.parseInt( pageNoParamAsString ) - 1;\n    }\n\n    List&lt;User&gt; resultUsersList = administrativeManager.getUsersList( searchForm.getFirstName(),\n            searchForm.getLastName(), userManager.getLoggedInUser().getDomain().getDomainId(), searchForm.getEnabledFlag(),\n            searchForm.getEmail(), searchForm.getPhoneNumber(), pageNr, PAGE_SIZE, null, null );\n\n    Long size = administrativeManager.getUsersListCount( searchForm.getFirstName(), searchForm.getLastName(),\n            searchForm.getDomainId(), searchForm.getEnabledFlag(), searchForm.getEmail(), searchForm.getPhoneNumber() );\n    //for ( User user : resultUsersList )\n    //{\n    //   System.out.println( user );\n    //}\n    model.addAttribute( \"eventUserListSize\", size.intValue() );\n    model.addAttribute( \"eventNotifUsers\", resultUsersList );\n    model.addAttribute( \"pageSize\", PAGE_SIZE );\n\n    return \"notifications/EventNotificationUserList\";\n}\n</code></pre>\n\n<p>DisplayTag jsp:</p>\n\n<pre><code>&lt;display:table name=\"${eventNotifUsers}\" id=\"eventNotifUsers\" pagesize=\"${pageSize}\"\n               cellspacing=\"0\" cellpadding=\"10\" requestURI=\"\" partialList=\"true\" size=\"eventUserListSize\" sort=\"external\" defaultsort=\"2\"&gt;\n    &lt;display:column title=\"FirstName\" property=\"firstName\"/&gt;\n    &lt;display:column property=\"lastName\" title=\"LastName\"/&gt;\n    &lt;display:column property=\"email\" title=\"Email\"/&gt;\n    &lt;display:column property=\"phoneNumber\" title=\"Phone\"/&gt;\n&lt;/display:table&gt;\n</code></pre>\n\n<p>But when I display actuall list, first page looks fine, but then till the end the first one is repeated. When I remove <code>Order</code> it works fine. I have no idea why... what might be wrong?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>After some research I discovered that the problem is only when sorting by lastName. Is it possible because my test that has all same <code>lastName</code>? When sorting by other column it works fine.</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2482,"score":0,"question_id":1747067,"title":"InvalidMappingException Hibernate mapping file...anybody can you give resolution","body":"<p>My mapping file is </p>\n\n<p>\n\n</p>\n\n<pre><code>&lt;class name=\"com.myapp.companypojo.Company\" table=\"COMPANY\"&gt;\n        &lt;property column=\"COMPANYNAME\" length=\"25\" name=\"companyName\" not-null=\"false\" type=\"java.lang.String\"/&gt;\n        &lt;property column=\"LOCATION\" length=\"25\" name=\"location\" not-null=\"false\" type=\"java.lang.String\"/&gt;\n        &lt;property column=\"NOOFEMPLOYESS\" length=\"25\" name=\"totalEmployees\" type=\"java.lang.String\"/&gt;\n        &lt;property column=\"LOB\" length=\"25\" name=\"lineOfBusiness\" type=\"java.lang.String\"/&gt;\n\n&lt;/class&gt;\n</code></pre>\n\n<p></p>\n\n<p>After validating the mapping file from IDE it throw an below error  and console i got InvalidMappingException...anybody can u give resolution??</p>\n\n<p>XML validation started.</p>\n\n<p>Checking file:/C:/Documents%20and%20Settings/Administrator/My%20Documents/NetBeansProjects/CMCApp/src/java/com/myapp/companypojo/Company.hbm.xml...\nThe content of element type \"class\" must match \"(meta*,subselect?,cache?,synchronize*,comment?,tuplizer*,(id|composite-id),discriminator?,natural-id?,(version|timestamp)?,(property|many-to-one|one-to-one|component|dynamic-component|properties|any|map|set|list|bag|idbag|array|primitive-array)<em>,((join</em>,subclass*)|joined-subclass*|union-subclass*),loader?,sql-insert?,sql-update?,sql-delete?,filter*,resultset*,(query|sql-query)*)\". [12] \nXML validation finished.</p>\n\n<p>INFO: Launching GlassFish on Apache Felix OSGi platform</p>\n\n<h1>Welcome to Felix.</h1>\n\n<p>INFO: Started bundle org.glassfish.core.kernel [73]\nINFO: Started bundle org.glassfish.common.glassfish-mbeanserver [12]\nINFO: Started bundle org.glassfish.common.common-util [90]\nINFO: Started bundle GlassFish-Application-Common-Module [13]\nINFO: APIClassLoader = Class Loader for Bundle [GlassFish-Application-Common-Module [13] ]\nINFO: registering service = org.apache.felix.framework.StartLevelImpl@16dadf9, contract = org.osgi.service.startlevel.StartLevel, name = null\nINFO: registering service = org.apache.felix.framework.PackageAdminImpl@290fbc, contract = org.osgi.service.packageadmin.PackageAdmin, name = null\nno resource bundle found for version, using default GlassFish version\nINFO: Started bundle org.glassfish.branding.branding [92]\nINFO: [Thread[GlassFish Kernel Main Thread,5,main]] started\nINFO: Started bundle org.glassfish.admin.config-api [81]\nINFO: Started bundle org.glassfish.common.internal-api [31]\nINFO: Started bundle org.glassfish.deployment.deployment-common [103]\nINFO: Started bundle org.glassfish.deployment.deployment-autodeploy [38]\nINFO: Started bundle org.glassfish.registration.glassfish-registration [79]\nINFO: Started bundle org.glassfish.flashlight.flashlight-framework [106]\nINFO: Listening on port 8080\nINFO: Network listener http-listener-2 on port 8181 disabled per domain.xml\nINFO: Listening on port 4848\nINFO: Started bundle org.glassfish.common.container-common [34]\nINFO: The Admin Console is already installed, but not yet loaded.\nINFO: Started bundle org.glassfish.connectors.gf-connectors-connector [76]\nINFO: Started bundle org.glassfish.security.security [63]\nINFO: Started bundle org.glassfish.scripting.gf-jruby-connector [75]\nINFO: Started bundle org.glassfish.persistence.jpa-connector [91]\nINFO: Started bundle org.glassfish.web.gf-web-connector [120]\nINFO: security.secmgroff\nINFO: Started bundle org.glassfish.security.securitycommon [53]\nINFO: Security startup service called\nINFO: Started bundle org.glassfish.security.realms [23]\nINFO: Security service(s) started successfully....\nINFO: registering service = org.glassfish.web.DirContextURLStreamHandlerService@179f36b, contract = org.osgi.service.url.URLStreamHandlerService, name = null\nINFO: Started bundle org.glassfish.common.glassfish-naming [28]\nINFO: Started bundle org.glassfish.web.web-glue [116]\nINFO: Total number of available updates : 1\nINFO: Number of available updates since Fri Nov 13 17:55:30 IST 2009 : 0\nINFO: Started bundle org.glassfish.common.glassfish-api [104]\nINFO: Started bundle org.glassfish.connectors.connectors-runtime [37]\nINFO: Started bundle org.glassfish.transaction.jta [68]\nINFO: Started JMXConnector, JMXService URL = service:jmx:rmi:///jndi/rmi://HP26258104442:8686/jmxrmi\nINFO: Created HTTP listener http-listener-1 on port 8080\nINFO: Created HTTP listener admin-listener on port 4848\nINFO: Created virtual server server\nINFO: Created virtual server __asadmin\nINFO: Started bundle org.glassfish.deployment.dol [22]\nINFO: Started bundle org.glassfish.web.web-core [112]\nINFO: Dual registration of jndi stream handler: factory already defined\nINFO: Unknown loader 116.0 class org.apache.felix.framework.searchpolicy.ContentClassLoader\nINFO: Started bundle org.glassfish.web.jsf-connector [125]\nINFO: Started bundle org.glassfish.web.jstl-connector [117]\nINFO: Using com.sun.enterprise.transaction.JavaEETransactionManagerSimplifiedDelegate as the delegate\nINFO: Started bundle org.glassfish.connectors.work-management [77]\nINFO: Started bundle org.glassfish.common.glassfish-ee-api [48]\nINFO: Started bundle org.glassfish.connectors.connectors-internal-api [30]\nINFO: policy.loading\nINFO: Started bundle org.glassfish.web.war-util [110]\nINFO: Started bundle org.glassfish.security.websecurity [109]\nINFO: Unknown loader org.glassfish.internal.api.DelegatingClassLoader@1cbd4f7 class org.glassfish.internal.api.DelegatingClassLoader\nINFO: Loading chain catalog from jar:file:/C:/Documents%20and%20Settings/Administrator/My%20Documents/NetBeansProjects/MyStrutsApp/build/web/WEB-INF/lib/struts-core-1.3.8.jar!/org/apache/struts/chain/chain-config.xml\nINFO: Tiles definition factory loaded for module ''.\nINFO: Loading validation rules file from '/WEB-INF/validator-rules.xml'\nINFO: Loading validation rules file from '/WEB-INF/validation.xml'\nINFO: Loading application MyStrutsApp at /MyStrutsApp\nINFO: Loading MyStrutsApp Application done is 11141 ms\nINFO: Unknown loader org.glassfish.internal.api.DelegatingClassLoader@1cbd4f7 class org.glassfish.internal.api.DelegatingClassLoader\nINFO: Loading chain catalog from jar:file:/C:/Documents%20and%20Settings/Administrator/My%20Documents/NetBeansProjects/CMCApp/build/web/WEB-INF/lib/struts-core-1.3.8.jar!/org/apache/struts/chain/chain-config.xml\nINFO: Tiles definition factory loaded for module ''.\nINFO: Loading validation rules file from '/WEB-INF/validator-rules.xml'\nINFO: Loading validation rules file from '/WEB-INF/validation.xml'\nINFO: Loading application CMCApp at /CMCApp\nINFO: Loading CMCApp Application done is 3109 ms\nINFO: Sun GlassFish Enterprise Server v3 Prelude startup time : Felix(17750ms) startup services(17109ms) total(34859ms)\nINFO: Unknown loader org.glassfish.internal.api.DelegatingClassLoader@1cbd4f7 class org.glassfish.internal.api.DelegatingClassLoader\nINFO: Loading chain catalog from jar:file:/C:/Documents%20and%20Settings/Administrator/My%20Documents/NetBeansProjects/CMCApp/build/web/WEB-INF/lib/struts-core-1.3.8.jar!/org/apache/struts/chain/chain-config.xml\nINFO: Tiles definition factory loaded for module ''.\nINFO: Loading validation rules file from '/WEB-INF/validator-rules.xml'\nINFO: Loading validation rules file from '/WEB-INF/validation.xml'\nINFO: Loading application CMCApp at /CMCApp\nINFO: Deployment of CMCApp done is 4406 ms\nINFO: Tiles definition factory found for request processor ''.\nINFO: Hibernate 3.2.5\nINFO: hibernate.properties not found\nINFO: Bytecode provider name : cglib\nINFO: using JDK 1.4 java.sql.Timestamp handling\nINFO: configuring from resource: /hibernate.cfg.xml\nINFO: Configuration resource: /hibernate.cfg.xml\nINFO: Reading mappings from resource : com/myapp/companypojo/Company.hbm.xml\nSEVERE: Error parsing XML: XML InputStream(11) The content of element type \"class\" must match \"(meta*,subselect?,cache?,synchronize*,comment?,tuplizer*,(id|composite-id),discriminator?,natural-id?,(version|timestamp)?,(property|many-to-one|one-to-one|component|dynamic-component|properties|any|map|set|list|bag|idbag|array|primitive-array)<em>,((join</em>,subclass*)|joined-subclass*|union-subclass*),loader?,sql-insert?,sql-update?,sql-delete?,filter*,resultset*,(query|sql-query)<em>)\".\nSEVERE: org.hibernate.InvalidMappingException: Could not parse mapping document from resource com/myapp/companypojo/Company.hbm.xml\n        at org.hibernate.cfg.Configuration.addResource(Configuration.java:569)\n        at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:1587)\n        at org.hibernate.cfg.Configuration.parseSessionFactory(Configuration.java:1555)\n        at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:1534)\n        at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:1508)\n        at org.hibernate.cfg.Configuration.configure(Configuration.java:1428)\n        at org.hibernate.cfg.Configuration.configure(Configuration.java:1414)\n        at com.myapp.hibernate.CompanyHibernateUtil.addCompanyDetails(CompanyHibernateUtil.java:33)\n        at com.myapp.struts.CompanyDetailsAction.execute(CompanyDetailsAction.java:43)\n        at org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:425)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:228)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n        at org.apache.catalina.core.ApplicationFilterChain.servletService(ApplicationFilterChain.java:431)\n        at org.apache.catalina.core.StandardWrapperValve.preInvoke(StandardWrapperValve.java:462)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:139)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:186)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:719)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:657)\n        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:96)\n        at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:98)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:187)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:719)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:657)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:651)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1030)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:142)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:719)\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:657)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:651)\n        at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1030)\n        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:325)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:242)\n        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:180)\n        at com.sun.grizzly.http.DefaultProcessorTask.invokeAdapter(DefaultProcessorTask.java:633)\n        at com.sun.grizzly.http.DefaultProcessorTask.doProcess(DefaultProcessorTask.java:570)\n        at com.sun.grizzly.http.DefaultProcessorTask.process(DefaultProcessorTask.java:827)\n        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:152)\n        at com.sun.enterprise.v3.services.impl.GlassfishProtocolChain.executeProtocolFilter(GlassfishProtocolChain.java:71)\n        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:103)\n        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:89)\n        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)\n        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:67)\n        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:56)\n        at com.sun.grizzly.util.WorkerThreadImpl.processTask(WorkerThreadImpl.java:325)\n        at com.sun.grizzly.util.WorkerThreadImpl.run(WorkerThreadImpl.java:184)\nCaused by: org.hibernate.InvalidMappingException: Could not parse mapping document from invalid mapping\n        at org.hibernate.cfg.Configuration.addInputStream(Configuration.java:502)\n        at org.hibernate.cfg.Configuration.addResource(Configuration.java:566)\n        ... 47 more\nCaused by: org.xml.sax.SAXParseException: The content of element type \"class\" must match \"(meta</em>,subselect?,cache?,synchronize*,comment?,tuplizer*,(id|composite-id),discriminator?,natural-id?,(version|timestamp)?,(property|many-to-one|one-to-one|component|dynamic-component|properties|any|map|set|list|bag|idbag|array|primitive-array)<em>,((join</em>,subclass*)|joined-subclass*|union-subclass*),loader?,sql-insert?,sql-update?,sql-delete?,filter*,resultset*,(query|sql-query)*)\".\n        at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:236)\n        at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:172)\n        at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:382)\n        at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:316)\n        at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.handleEndElement(XMLDTDValidator.java:2048)\n        at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.endElement(XMLDTDValidator.java:932)\n        at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(XMLNSDocumentScannerImpl.java:719)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(XMLDocumentFragmentScannerImpl.java:1685)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:368)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:834)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)\n        at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:148)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1242)\n        at org.dom4j.io.SAXReader.read(SAXReader.java:465)\n        at org.hibernate.cfg.Configuration.addInputStream(Configuration.java:499)\n        ... 48 more\nINFO: Unknown loader org.glassfish.internal.api.DelegatingClassLoader@1cbd4f7 class org.glassfish.internal.api.DelegatingClassLoader\nINFO: Loading chain catalog from jar:file:/C:/Documents%20and%20Settings/Administrator/My%20Documents/NetBeansProjects/CMCApp/build/web/WEB-INF/lib/struts-core-1.3.8.jar!/org/apache/struts/chain/chain-config.xml\nINFO: Tiles definition factory loaded for module ''.\nINFO: Loading validation rules file from '/WEB-INF/validator-rules.xml'\nINFO: Loading validation rules file from '/WEB-INF/validation.xml'\nINFO: Loading application CMCApp at /CMCApp\nINFO: Deployment of CMCApp done is 3109 ms</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13101139,"title":"Hibernate needed values to save a child","body":"<p>I currently have working code to save children to a parent entity.  But I'm wondering if I'm doing things right since I now have an overload on select statements going thru hibernate.  I do use caching so atm I don't have delay problems but I'm wondering if I can't be more efficient.  Take this little extract as example</p>\n\n<pre><code>MbaLog.debugLog(logger, \"Saving CodeType\");\nSite site = codeType.getSite();\nif (site != null &amp;&amp; site.isProxy())\n    codeType.setSite(siteRepository.loadSiteById(site.getId()));\nLong recordId = codeRepository.saveCodeType(codeType);\n</code></pre>\n\n<p>I have an entity CodeType that I'm saving that has a child Site.  This child is passed to the method as a proxy object with just it's id filled in.  Then I fetch a fully loaded Site object from the database and set it on codetype.  Next up I save the codeType with the sessionfactory of hibernate to the database (code not visible here, but it's behind the codeRepository).</p>\n\n<p>This works but I'm loading a full site, that has childs of it's own so I see at least 5 queries passing before the insert.  I could put a lot of stuff lazy on site, but for the time being I rather not do that due to possible code complications in deeper layers.  I had to learn hibernate and JPA on the job and never had much training from experts in the past.  So I'm wondering, is there a shortcut to save the site on codetype ?  Do I need to have it fully loaded or is the id enough ?  or just the id and version (I'm using @version annotation on all my entities for optimistic locking)</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["hibernate","hibernate3-maven-plugin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":421,"score":0,"question_id":8666624,"title":"hibernate3-maven-plugin not compatible with hibernate4","body":"<p>hibernate3-maven-plugin not compatible with hibernate4, I get the following error while trying to run any goals in that plugin. How do I circumvent this issue?</p>\n\n<pre><code>[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:2.2:hbm2\nddl (create sql schema) on project framework: Execution create sql schema of goal\norg.codehaus.mojo:hibernate3-maven-plugin:2.2:hbm2ddl failed: An API incompatibi\nlity was encountered while executing org.codehaus.mojo:hibernate3-maven-plugin:2.\n2:hbm2ddl: java.lang.IllegalAccessError: tried to access method org.hibernate.cfg\n.Configuration.&lt;init&gt;(Lorg/hibernate/cfg/SettingsFactory;)V from class org.hibern\nate.ejb.Ejb3Configuration\n</code></pre>\n"},{"tags":["hibernate","java-ee","struts2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12479960,"title":"Full Hibernate Plugin only working with Hibernate3. Anyway with Hibernate4?","body":"<p>I been struggling with <strong><em>struts2-fullhibernatecore-plugin-2.2.2-GA</em></strong> for my CRUD demo project for learning purpose. Below is the error I get and than different hibernate dependencies tried to make it work. See below</p>\n\n<p><strong>ERROR</strong></p>\n\n<pre><code>java.lang.NoSuchMethodError: org.hibernate.SessionFactory.openSession()Lorg/hibernate/classic/Session;\n    com.googlecode.s2hibernate.struts2.plugin.util.HibernateSessionFactory.createAndTestSessionFactory(HibernateSessionFactory.java:284)\n    com.googlecode.s2hibernate.struts2.plugin.util.HibernateSessionFactory.rebuildSessionFactory(HibernateSessionFactory.java:227)\n    com.googlecode.s2hibernate.struts2.plugin.util.HibernateSessionFactory.getNewSession(HibernateSessionFactory.java:155)\n</code></pre>\n\n<p><em>I understand from this thread answer</em> <a href=\"http://stackoverflow.com/questions/8799121/java-lang-nosuchmethoderror-org-hibernate-sessionfactory-opensessionlorg-hibe\">Click Here</a></p>\n\n<p>Than I started different maven dependeces to check hibernate version working with plugin and found</p>\n\n<p><strong>NOT WORKING FROM BELOW VERSION</strong></p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n    &lt;version&gt;4.1.6.Final&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p><strong>WORKING TILL THIS VERSION</strong></p>\n\n<pre><code>  &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;3.6.10.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre>\n\n<p><strong>Question:</strong> Obviously don't want to use Hibernate3 so is there a way I can use latest hibernate4+ with struts2-fullhibernatecore-plugin-2.2.2-GA?</p>\n\n<p><strong>Question:</strong> What is the most widely used DI for hibernate in struts2. Should I go for <strong><em>Spring or google juice</em></strong> if above plugin not working?. Don't see any other viable solution for managing hibernate session except that <strong><em>viewpattern</em></strong> but say its antipattern and has many drawbacks.</p>\n"},{"tags":["java","hibernate","maven-2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5279,"score":0,"question_id":4324068,"title":"NoSuchMethodError: org.hibernate.SessionFactory.getCurrentSession()","body":"<p>Hello all <br /><br />\nI'm getting this very strange error: <br /></p>\n\n<pre><code>java.lang.NoSuchMethodError: org.hibernate.SessionFactory.getCurrentSession()Lor\ng/hibernate/classic/Session;\n        at org.cometd.hibernate.util.HibernateUtil.getSessionFactory(HibernateUt\nil.java:29)\n        at org.cometd.hibernate.util.HibernateUtil.getSession(HibernateUtil.java\n:54)\n</code></pre>\n\n<p>But this method exists in SessionFactory class in JavaDocs! <br />\nMy Eclipse also shows me it in the autocomplete. <br />\nBut some other methods, i.e. openSession() or closeSession() work correct. <br />\nWhere the problem can hide? <br />\nMy pom.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\"&gt;\n\n\n\n    &lt;build&gt;\n        &lt;defaultGoal&gt;install&lt;/defaultGoal&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;1.5&lt;/source&gt;\n                    &lt;target&gt;1.5&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;overlays&gt;\n                        &lt;overlay /&gt;\n                        &lt;overlay&gt;\n                            &lt;groupId&gt;org.cometd.javascript&lt;/groupId&gt;\n                            &lt;artifactId&gt;cometd-javascript-dojo&lt;/artifactId&gt;\n                        &lt;/overlay&gt;\n                    &lt;/overlays&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-jetty-plugin&lt;/artifactId&gt;\n                &lt;version&gt;6.1.24&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;scanIntervalSeconds&gt;10&lt;/scanIntervalSeconds&gt;\n                    &lt;webAppConfig&gt;\n                        &lt;contextPath&gt;/sample&lt;/contextPath&gt;\n                    &lt;/webAppConfig&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\n            &lt;version&gt;2.5&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.cometd.java&lt;/groupId&gt;\n            &lt;artifactId&gt;cometd-api&lt;/artifactId&gt;\n            &lt;version&gt;1.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.cometd.javascript&lt;/groupId&gt;\n            &lt;artifactId&gt;cometd-javascript-dojo&lt;/artifactId&gt;\n            &lt;version&gt;1.1.2&lt;/version&gt;\n            &lt;type&gt;war&lt;/type&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.cometd.java&lt;/groupId&gt;\n            &lt;artifactId&gt;cometd-java-server&lt;/artifactId&gt;\n            &lt;version&gt;1.1.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;3.3.2.GA&lt;/version&gt;\n            &lt;!--&lt;version&gt;3.6.0.Final&lt;/version&gt;--&gt;\n        &lt;/dependency&gt;               \n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n            &lt;version&gt;3.4.0.GA&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n            &lt;version&gt;3.1.0.GA&lt;/version&gt;\n        &lt;/dependency&gt;\n\n\n        &lt;!-- log4j --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n            &lt;version&gt;1.5.10&lt;/version&gt;\n            &lt;!-- &lt;scope&gt;runtime&lt;/scope&gt;  --&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n            &lt;version&gt;1.5.10&lt;/version&gt;\n            &lt;!-- &lt;scope&gt;runtime&lt;/scope&gt;  --&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;1.5.10&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n            &lt;version&gt;1.2.15&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.mail&lt;/groupId&gt;\n                    &lt;artifactId&gt;mail&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;javax.jms&lt;/groupId&gt;\n                    &lt;artifactId&gt;jms&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.sun.jdmk&lt;/groupId&gt;\n                    &lt;artifactId&gt;jmxtools&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;com.sun.jmx&lt;/groupId&gt;\n                    &lt;artifactId&gt;jmxri&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n            &lt;!-- &lt;scope&gt;runtime&lt;/scope&gt;  --&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;5.1.9&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.jmock&lt;/groupId&gt;\n            &lt;artifactId&gt;jmock-junit4&lt;/artifactId&gt;\n            &lt;version&gt;2.5.1&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt; \n            &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt; \n            &lt;artifactId&gt;quartz&lt;/artifactId&gt;\n            &lt;version&gt;1.8.2&lt;/version&gt; \n        &lt;/dependency&gt; \n\n        &lt;!-- Hibernate framework --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate3&lt;/artifactId&gt;\n        &lt;version&gt;3.2.3.GA&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;!-- Hibernate annotation --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;hibernate-annotations&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n        &lt;version&gt;3.3.0.GA&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;hibernate-commons-annotations&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-commons-annotations&lt;/artifactId&gt;\n        &lt;version&gt;3.0.0.GA&lt;/version&gt;\n    &lt;/dependency&gt;\n\n\n\n    &lt;!-- Hibernate library dependecy start --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;dom4j&lt;/groupId&gt;\n        &lt;artifactId&gt;dom4j&lt;/artifactId&gt;\n        &lt;version&gt;1.6.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;commons-collections&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;\n        &lt;version&gt;3.2.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;antlr&lt;/groupId&gt;\n        &lt;artifactId&gt;antlr&lt;/artifactId&gt;\n        &lt;version&gt;2.7.7&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n    &lt;groupId&gt;javassist&lt;/groupId&gt;\n    &lt;artifactId&gt;javassist&lt;/artifactId&gt;\n    &lt;version&gt;3.5.0.GA&lt;/version&gt;\n&lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;repositories&gt;\n        &lt;repository&gt;\n            &lt;id&gt;JBoss repository&lt;/id&gt;\n            &lt;url&gt;http://repository.jboss.com/maven2/&lt;/url&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n\n&lt;/project&gt;\n</code></pre>\n\n<p>P.S. the code is</p>\n\n<pre><code>org.hibernate.SessionFactory sessionFactory = new Configuration().configure().buildSessionFactory();\n\norg.hibernate.Session session = sessionFactory.getCurrentSession();\n</code></pre>\n"},{"tags":["java","hibernate","hql","criteria"],"answer_count":11,"favorite_count":49,"up_vote_count":94,"down_vote_count":0,"view_count":54867,"score":94,"question_id":197474,"title":"Hibernate: Criteria vs. HQL","body":"<p>What are the pros and cons of using Criteria or HQL? The Criteria API is a nice object-oriented way to express queries in Hibernate, but sometimes Criteria Queries are more difficult to understand/build than HQL. </p>\n\n<p>When do you use Criteria and when HQL? What do you prefer in which use cases? Or is it just a matter of taste?</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13097185,"title":"JPA : illegal attempt to dereference collection","body":"<pre><code>@Entity\n@Table(name=\"users\")\npublic class User implements Serializable \n{\n    private List&lt;Request&gt; sentRequest;\n    private List&lt;Request&gt; receivedRequest;\n    private Profile profile;\n}\n\npublic  List&lt;Object&gt; getUserProfiles(Integer userid) \n{\n    query = em.createQuery(\n            \"SELECT p from Profile p1,Profile p2 WHERE \" + \n            \"p1.user.sentRequest.sender.id (:id) NOT IN \" + \n            \" p2.user.receivedRequest.receiver.id and \" + \n            \"p1.user.id NOT IN (:id)\"\n        ).setParameter(\"id\",userid);\n</code></pre>\n\n<p>I tried above query it's throwing  illegal attempt to dereference collection.\nThe relationship are<br>\nUser - Profile OneToOne and User - Request OneToMany</p>\n\n<p>I want to select all user Profiles those have not sent request and except own profile.</p>\n"},{"tags":["hibernate","jpa","annotations","many-to-many","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13095850,"title":"JPA annotation with association table","body":"<p>I'm using JPA annotation with Hibernate and I don't really know how to manage association table.</p>\n\n<p>Here is my database :</p>\n\n<pre><code>| COUNTRY |      | COUNTRY_MOVIE|      | MOVIE   |\n|---------|      |--------------|      |---------|\n| COU_ID  |*    *| COUNTRY_ID   |*    *| MO_ID   |\n| LABEL   |&lt;----&gt;| MOVIE_ID     |&lt;----&gt;| LABEL   |\n|---------|      |--------------|      |---------|\n</code></pre>\n\n<p>The table <code>COUNTRY_MOVIE</code> is an association table between <code>COUNTRY</code> and <code>MOVIE</code> with many-to-many association</p>\n\n<p>In my JPA object I didn't create a <code>CountryMovie.java</code> class but I use <code>@JoinTable</code> in <code>Country.java</code> as in the following code :</p>\n\n<pre><code>//Package, Import...\n\n@Entity\n@Table(name=\"COUNTRY\")\npublic class Country implements Serializable {\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy=GenerationType.IDENTITY)\n    @Column(name=\"COU_ID\")\n    private Integer couID;\n\n    @Column(name=\"LABEL\")\n    private String label;\n\n    //bi-directional many-to-many association to TFilmFil\n    @ManyToMany\n    @JoinTable(\n        name=\"COUNTRY_MOVIE\"\n        , joinColumns={\n            @JoinColumn(name=\"COU_ID\")\n            }\n        , inverseJoinColumns={\n            @JoinColumn(name=\"MO_ID\")\n            }\n        )\n    private List&lt;Movie&gt; movies;\n\n    public Country() {\n        super();\n    }\n\n    // Other constructor, Getter &amp; Setter, and \"toString\" method...\n}\n</code></pre>\n\n<p>And in <code>Movie.java</code> I use only a <code>@ManyToMany</code> annotation :</p>\n\n<pre><code>//Package, Import...\n\n@Entity\n@Table(name=\"MOVIE\")\npublic class Movie implements Serializable {\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy=GenerationType.IDENTITY)\n    @Column(name=\"MO_ID\")\n    private Integer moId;\n\n    @Column(name=\"LABEL\")\n    private String label;\n\n    //bi-directional many-to-many association to TrPaysPay\n    @ManyToMany(mappedBy=\"movies\")\n    private List&lt;Country&gt; countries;\n\n    public Film() {\n        super();\n    }\n\n    // Other constructor, Getter &amp; Setter, and \"toString\" method...\n}\n</code></pre>\n\n<p>I don't know if it's the best way to manage this kind of association table but it looks ok, but when I try to get all the countries of a movie I obtain a <code>LazyInitializationException</code> from Hibernate.</p>\n\n<p>So I tried to add a fetch EAGER to each many to many annotation :</p>\n\n<p>In Country :</p>\n\n<pre><code>@ManyToMany(fetch=FetchType.EAGER)\n@JoinTable(\n</code></pre>\n\n<p>In movie :</p>\n\n<pre><code>@ManyToMany(mappedBy=\"movies\",fetch=FetchType.EAGER)\n</code></pre>\n\n<p>Then I obtain this :</p>\n\n<p>org.springframework.beans.factory.support.DefaultSingletonBeanRegistry destroySingletons</p>\n\n<p>Do I have to create another java class to map <code>COUNTRY_MOVIE</code>? or is there a way to fix this problem by using the same java class as now ?</p>\n\n<p>Tako</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13092296,"title":"Hibernate entity class is not picking up","body":"<p>I am trying to use hibernate with annotations. I annotated my class with @Entity (Made sure that this is javax.persistance.Entity instead of Hibernate's entity) and @Table. </p>\n\n<p>When I am trying to query the table with </p>\n\n<pre><code>session.createQuery(\"from HibernateMatchedInvoiceItem\").list()\n</code></pre>\n\n<p>But this is failing with following exception</p>\n\n<pre><code>caused by: org.hibernate.hql.ast.QuerySyntaxException: HibernateMatchedInvoiceItem is not mapped [from HibernateMatchedInvoiceItem]\n</code></pre>\n\n<p>my session factory is defined as follows. </p>\n\n<pre><code>   &lt;bean id=\"SessionFactory\"\n      class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"\n      parent=\"AbstractSessionFactory\" depends-on=\"AppConfigHelper\"&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n      &lt;props&gt;\n        &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.OracleDialect&lt;/prop&gt;\n     &lt;/props&gt;\n    &lt;/property&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n</code></pre>\n\n<p>I didn't define persistant.xml file. Is it the reason behind this exception? \nMy doubt is that, since everything hibernate wants(database connection &amp; class mapping) is specified through configuration and annotations, why do we need to specify persistance.xml file explicitly? </p>\n"},{"tags":["hibernate","jetty","h2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13098462,"title":"H2 database resets (using Auto Server)","body":"<p>I am using H2 as my dev database for an application I am writing. The app is deployed with Jetty and the connection is handled through Hibernate. To construct the tables, I am using the INIT parameter in the connection URL to run statements.</p>\n\n<p>The problem is that it seems like this connection resets frequently, re-running that script (and thus erasing everything that has been stored in the database since last startup). This seems to happen almost immediately after startup.</p>\n\n<p>At the end of my script, I have added the following which allows me to confirm that this script is run after the initial startup of the application:</p>\n\n<pre><code>DROP TABLE IF EXISTS system_msg;\nCREATE TABLE system_msg (\n    id int AUTO_INCREMENT NOT NULL,\n    msg_date timestamp NULL,\n    msg text NULL,\n    PRIMARY KEY(id)\n);\nINSERT INTO system_msg(msg_date, msg)\nVALUES (NOW(), 'Database schema created from DDL script');\n</code></pre>\n\n<p>On application startup, I am populating the application with some core data, using Hibernate. A webpage menu-structure is one of the entities that is generated on startup, and typically I can only load the page once. The second time I load the page, I get something like this:</p>\n\n<pre><code>org.hibernate.ObjectNotFoundException: No row with the given identifier exists: [com.example.web.model.front.Menu#1]\n</code></pre>\n\n<p>This indicates that the cached entity was not found in the database anympore. If I look at  the H2 database using the web console, I can indeed see that the init script has been run again (looking at the timestamp for the post in the system_msg table)</p>\n\n<ul>\n<li>This is my jetty-env.xml file: <a href=\"http://pastebin.com/N5184L6d\" rel=\"nofollow\">http://pastebin.com/N5184L6d</a> </li>\n<li>This is my hibernate.cfg.xml file: <a href=\"http://pastebin.com/bgsCVg0q\" rel=\"nofollow\">http://pastebin.com/bgsCVg0q</a></li>\n</ul>\n\n<p>I am using Ehcache as well as 2nd level cache, but I am not sure if this is relevant to the problem. In case it is, here is the current configuration file: <a href=\"http://pastebin.com/nGG3eENf\" rel=\"nofollow\">http://pastebin.com/nGG3eENf</a></p>\n\n<p>I am developing in Eclipse (Indigo), using Maven (embedded). I thought at first that it reset the H2 database server whenever I did code changes that triggered a behind-the-scenes reset of the Jetty instance, but it also happens without touching the code.</p>\n\n<p>Other specifications:</p>\n\n<ul>\n<li>Windows 7</li>\n<li>H2 v1.3.168</li>\n<li>Hibernate (and Ehcache) v4.1.7.Final</li>\n<li>Jetty Maven plugin (if relevant?) v8.1.3.v20120416</li>\n</ul>\n\n<p>Are there any settings I have missed, or any other possible explanation to why my H2 database keeps resetting?</p>\n"},{"tags":["oracle","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13097722,"title":"Hibernate: Connecting as SYSDBA to Oracle database","body":"<p>How to connect to Oracle database as SYSDBA using Hibernate?</p>\n"},{"tags":["java","hibernate","orm","detachedcriteria"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":206,"score":0,"question_id":11507868,"title":"What is the best way to limit results using a DetachedCriteria of Hibernate in Java?","body":"<p>I'm using Hibernate 3.5.6-Final in Java. Since I don't have access to the Hibernate <a href=\"http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html\" rel=\"nofollow\">Session</a>, I'm using a <a href=\"http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/criterion/DetachedCriteria.html\" rel=\"nofollow\">DetachedCriteria</a>. So, I would like to know <strong>what is the best way to limit the results for a DetachedCriteria</strong> (in my case I would like to get only the first row).</p>\n\n<p><em>Additional info:</em></p>\n\n<p>The <a href=\"http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Criteria.html\" rel=\"nofollow\">Criteria</a> class has some methods to achieve this, like <a href=\"http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Criteria.html#setMaxResults%28int%29\" rel=\"nofollow\">setMaxResults(int maxResults)</a> or <a href=\"http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Criteria.html#setFirstResult%28int%29\" rel=\"nofollow\">setFirstResult(int firstResult)</a>, but the DetachedCriteria doesn't have neither. Again, I can't use the Criteria because I don't have access to the Hibernate's Session.</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13064940,"title":"How to insert a object which has a list of objects in it?","body":"<p>ContentPack class,</p>\n\n<pre><code>@Entity\npublic class ContentPack {\n\n@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate int id;\n\n@Property\nprivate String name;\n\n@OneToMany  // ????\nprivate List&lt;ContentItem&gt; songsList;\n}\n</code></pre>\n\n<p>Next the ContentItem class,</p>\n\n<pre><code>@Entity\npublic class ContentItem {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private int id;\n\n    private String mp3Url;\n}\n</code></pre>\n\n<p>but when i try to call the following,</p>\n\n<pre><code>session.beginTransaction();\nsession.save(contentPack);\nsession.getTransaction().commit();\n</code></pre>\n\n<p>i get the following error. I believe the <code>list</code> creates the error. How can i fix it?</p>\n\n<p>Error :</p>\n\n<pre><code>org.hibernate.exception.GenericJDBCException: Could not execute JDBC batch update\n    at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:140)\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:128)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:275)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:268)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:188)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1216)\n    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:383)\n    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:133)\n</code></pre>\n"},{"tags":["hibernate","where-clause"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13092277,"title":"Hibernate @where Annotation: usage for attribute present on the inverse side of @OnetoOne association. (mappedBy)","body":"<p>Here are my classes Alpha and Beta. Alpha has a one to one relationship with Beta</p>\n\n<p>I want to fetch only those Alpha records which have Beta. </p>\n\n<p>I am unable to create a where clause annotation for Alpha which will help me achieve this.</p>\n\n<p>Is there a better way to arrange the annotations, since i want to avoid any additional queries in the code while fetching alpha objects.</p>\n\n<pre><code>/** CLass Alpha*/\n@Entity\n@Where(clause x =0  and y =0  and  ????????)\nclass Alpha {    \n\n    @Column(name =\"X\")\n    int x;\n\n    @Column(name =\"Y\")\n    int Y;\n\n    @OneToOne(mappedBy = \"alpha\")\n    Beta beta;\n}\n\n/** Class Beta*/\n@Entity\nclass Beta {    \n    @OneToOne\n    @JoinColumn(name = \"ALPHA_REF\")\n    Alpha alpha;    \n}\n</code></pre>\n\n<p>Any pointers would be very much appreciated</p>\n"},{"tags":["hibernate","second-level-cache","hibernate-4.x"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":188,"score":0,"question_id":11832369,"title":"How to configure second level cache in Hibernate 4.1.5 SP1?","body":"<p>I have read other threads on here about this subject but none of the solutions work for me.</p>\n\n<p>I tried putting this in my hibernate.cfg.xml:</p>\n\n<pre><code>&lt;property name=\"hibernate.cache.region.factory_class\"&gt;org.hibernate.cache.spi.EntityRegion&lt;/property&gt;\n</code></pre>\n\n<p>I always get this error:\n<em>could not instantiate RegionFactory [org.hibernate.cache.spi.EntityRegion]</em></p>\n\n<p>I also tried most suggestions from threads on Hibernate websites but no luck.</p>\n\n<p>So how do I configure this?</p>\n"},{"tags":["java","hibernate","spring"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":606,"score":4,"question_id":9318378,"title":"ClassCastException InjectedDataSourceConnectionProvider Spring 3.1.0, Hibernate 4, JPA EntityManagerFactory","body":"<p>Using:</p>\n\n<ul>\n<li>Spring 3.1.0</li>\n<li>Hibernate 4</li>\n<li>JPA 2</li>\n<li>GWT 2.3.0.</li>\n</ul>\n\n<p>[Similar to <a href=\"http://stackoverflow.com/questions/8891467/exception-in-spring-3-1-hibernate-4-0-1\">Exception in Spring 3.1 + Hibernate 4.0.1</a> ]</p>\n\n<p>When running a very simple GWT application (using the Greeting Service) and adding a spring configuration to the application (via web.xml and related spring configuration files), an exception occurs when the system is brought up in gwt dev mode (from within Eclipse and from the command-line (mvn gwt:run)).</p>\n\n<p>The exception is shown below:</p>\n\n<blockquote>\n  <p>[WARN] Nested in org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'jgkgwtclasscastissueEntityManagerFactory' defined in ServletContext resource [/WEB-INF/classes/spring-main-config.xml]: Invocation of init method failed; nested exception is javax.persistence.PersistenceException: [PersistenceUnit: jgkgwtclasscastissue-PU] Unable to build EntityManagerFactory: java.lang.ClassCastException: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider cannot be cast to org.hibernate.service.jdbc.connections.spi.ConnectionProvider</p>\n</blockquote>\n\n<p>pom.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\"&gt;\n\n    &lt;!-- POM file generated with GWT webAppCreator --&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;com.gs&lt;/groupId&gt;\n    &lt;artifactId&gt;jgkgwtclasscastissue&lt;/artifactId&gt;\n    &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;GWT Maven Archetype&lt;/name&gt;\n\n    &lt;properties&gt;\n        &lt;gwtVersion&gt;2.3.0&lt;/gwtVersion&gt;\n        &lt;maven.compiler.source&gt;1.6&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;1.6&lt;/maven.compiler.target&gt;\n        &lt;webappDirectory&gt;${project.build.directory}/${project.build.finalName}    &lt;/webappDirectory&gt;\n        &lt;antlr.version&gt;2.7.6&lt;/antlr.version&gt;\n        &lt;aopalliance.version&gt;1.0&lt;/aopalliance.version&gt;\n        &lt;c3p0.version&gt;0.9.1.2&lt;/c3p0.version&gt;\n        &lt;cglib.version&gt;2.2.2&lt;/cglib.version&gt;\n        &lt;commons-beanutils.version&gt;1.8.3&lt;/commons-beanutils.version&gt;\n        &lt;commons-collections.version&gt;3.1&lt;/commons-collections.version&gt;\n        &lt;commons-logging.version&gt;1.1.1&lt;/commons-logging.version&gt;\n        &lt;ojdbc6.version&gt;11.1.0.7.0&lt;/ojdbc6.version&gt;\n        &lt;commons-dbcp.version&gt;1.4&lt;/commons-dbcp.version&gt;\n        &lt;dom4j.version&gt;1.6.1&lt;/dom4j.version&gt;\n        &lt;ehcache.version&gt;2.4.6&lt;/ehcache.version&gt;\n        &lt;javassist.version&gt;3.9.0.GA&lt;/javassist.version&gt;\n        &lt;javax.inject.version&gt;1.0-PFD-1&lt;/javax.inject.version&gt;\n        &lt;javax.transaction.version&gt;1.1&lt;/javax.transaction.version&gt;\n        &lt;junit.version&gt;4.9&lt;/junit.version&gt;\n        &lt;log4j.version&gt;1.2.16&lt;/log4j.version&gt;\n        &lt;slf4j-api.version&gt;1.6.1&lt;/slf4j-api.version&gt;\n        &lt;slf4j-log4j12.version&gt;1.6.1&lt;/slf4j-log4j12.version&gt;\n\n        &lt;org.aspectj.version&gt;1.6.10&lt;/org.aspectj.version&gt;\n        &lt;org.hibernate.version&gt;4.0.0.Final&lt;/org.hibernate.version&gt;\n        &lt;org.hibernate-commons-annotations.version&gt;4.0.1.Final&lt;/org.hibernate-commons-annotations.version&gt;\n            &lt;org.hibernate.hibernate-validator.version&gt;4.1.0.Final&lt;/org.hibernate.hibernate-validator.version&gt;\n        &lt;org.hibernate.jpamodelgen.version&gt;1.1.1.Final&lt;/org.hibernate.jpamodelgen.version&gt;\n        &lt;org.springframework.version&gt;3.1.0.RELEASE&lt;/org.springframework.version&gt;\n        &lt;org.springframework.data.version&gt;1.0.1.RELEASE&lt;/org.springframework.data.version&gt;\n        &lt;wagon-ssh.version&gt;1.0-beta-6&lt;/wagon-ssh.version&gt;\n\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n            &lt;version&gt;${log4j.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n            &lt;version&gt;${slf4j-api.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n            &lt;version&gt;${slf4j-log4j12.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.gwt&lt;/groupId&gt;\n            &lt;artifactId&gt;gwt-servlet&lt;/artifactId&gt;\n            &lt;version&gt;2.3.0&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.gwt&lt;/groupId&gt;\n            &lt;artifactId&gt;gwt-user&lt;/artifactId&gt;\n            &lt;version&gt;2.3.0&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.7&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n            &lt;version&gt;4.1.0.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate.common&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-commons-annotations&lt;/artifactId&gt;\n            &lt;version&gt;${org.hibernate-commons-annotations.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n            &lt;version&gt;${org.hibernate.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;${org.hibernate.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-ehcache&lt;/artifactId&gt;\n            &lt;version&gt;${org.hibernate.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-asm&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n                    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-expression&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-jms&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;    \n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-oxm&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;aopalliance&lt;/groupId&gt;\n            &lt;artifactId&gt;aopalliance&lt;/artifactId&gt;\n            &lt;version&gt;${aopalliance.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.aspectj&lt;/groupId&gt;\n            &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;\n            &lt;version&gt;${org.aspectj.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-instrument&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-instrument-tomcat&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;\n            &lt;version&gt;${org.springframework.data.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-data-commons-core&lt;/artifactId&gt;\n            &lt;version&gt;1.1.0.RELEASE&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.oracle&lt;/groupId&gt;\n            &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt;\n            &lt;version&gt;${ojdbc6.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;\n            &lt;version&gt;${commons-beanutils.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-jpamodelgen&lt;/artifactId&gt;\n            &lt;version&gt;${org.hibernate.jpamodelgen.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-dbcp&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-dbcp&lt;/artifactId&gt;\n            &lt;version&gt;${commons-dbcp.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;!-- Generate compiled stuff in the folder used for developing mode --&gt;\n        &lt;outputDirectory&gt;${webappDirectory}/WEB-INF/classes&lt;/outputDirectory&gt;\n\n        &lt;plugins&gt;\n\n            &lt;!-- GWT Maven Plugin --&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;\n                &lt;artifactId&gt;gwt-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.3.0&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;compile&lt;/goal&gt;\n                            &lt;goal&gt;test&lt;/goal&gt;\n                            &lt;goal&gt;i18n&lt;/goal&gt;\n                            &lt;goal&gt;generateAsync&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n                &lt;configuration&gt;\n                    &lt;runTarget&gt;jgkgwtclasscastissue.html&lt;/runTarget&gt;\n                    &lt;hostedWebapp&gt;${webappDirectory}&lt;/hostedWebapp&gt;\n                                &lt;i18nMessagesBundle&gt;com.gs.client.Messages&lt;/i18nMessagesBundle&gt;\n                    &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n            &lt;!-- Copy static web files before executing gwt:run --&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.1.1&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;compile&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;exploded&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n                &lt;configuration&gt;\n                    &lt;webappDirectory&gt;${webappDirectory}&lt;/webappDirectory&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n\n<p>It is unclear where the problem is.  Any suggestions?</p>\n"},{"tags":["hibernate","jpa","persistence.xml"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":202,"score":2,"question_id":10837584,"title":"Hibernate JPA how to configure dynamic-update in persistence.xml","body":"<p>I do NOT want to configure in my java source code which can be done like:</p>\n\n<pre><code>@org.hibernate.annotations.Entity(\n        dynamicUpdate = true) \n</code></pre>\n\n<p>because I want it to be configurable.</p>\n\n<p>I am not using hibernate.properties, only persistence.xml as I am using JPA. How can I make <code>dynamicUpdate</code> as <code>true</code> for all entities using <code>persistence.xml</code> only?</p>\n"},{"tags":["java","hibernate","one-to-many","cascade","all-delete-orphan"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":13067698,"title":"Can't get hibernate to delete children instances via cascade, that were removed from a one-to-many relation","body":"<p>slight problem here:</p>\n\n<p>I have two entity classes, let's say</p>\n\n<pre><code>class Parent {\n    Set&lt;Child&gt; children;\n}\nclass Child {\n    SomethingElse reference;\n}\n</code></pre>\n\n<p>now the mapping is essentially:</p>\n\n<pre><code>&lt;class name=\"Parent\" lazy=\"false\"&gt;\n    &lt;set name=\"children\" lazy=\"false\" cascade=\"all-delete-orphan\"&gt;\n        &lt;key column=\"parent_id\"/&gt;\n        &lt;one-to-many class=\"Child\"/&gt;\n    &lt;/set&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>(i omitted the id mappings and fields here, i use regular generated ids)</p>\n\n<p>i essentially need to keep a clean database as in when i remove elements from a parent's list and then commit the parent, the according removed child database entries need to be deleted. The Child instances reference other entities that i need to be able to delete later, so if the child instance remains in the database i cannot delete those referenced objects.</p>\n\n<p>What i have found out so far: any of the things i try below should work if i were to keep hibernate's PersistentCollection wrapper in place. The issue is, my database objects come through a few layers of frameworks, which include a UI framework, that uses bean property abstractions to invoke setters, and a network communication layer that clones and serializes the objects back and forth. Both of these layers internally replace the collection instances and thus remove these PersistentCollection wrappers. Rewriting these to not do so is not an option.</p>\n\n<p>That said, there's 8 things i tried that did not work:</p>\n\n<p>1) configure the relation as cascade=\"all\", use session.update(parent).</p>\n\n<p>2) configure the relation as cascade=\"all-delete-orphan\", use session.update(parent).</p>\n\n<p>3) configure the relation as cascade=\"all\" and use session.merge(parent)</p>\n\n<p>All of these result in hibernate executing a \"UPDATE CHILD SET parent.id = null WHERE parent.id = ...\". This succeeds in removing the children from the parent list when reloading the parent instance, but the child instance remains in the database and prevents me from deleting the other referenced entities.</p>\n\n<p>4-6) using configuration 1-3 while additionally having the parent key column defined as non-null</p>\n\n<p>This results in hibernate not doing anything. I read in another post that making the key column non-null would cause the deletion. Sounded possible since updating to null is no longer an option, but doesn't work. If i remove children from the collection, commit the change and reload the instance from the database, the children re-appear.</p>\n\n<p>7+8) parent key nullable or non-null doesn't matter, but configure the relation as cascade=all-delete-orphans and use session.merge(parent)</p>\n\n<p>This causes hibernate to throw an exception \"A collection with cascade=\"all-delete-orphan\" was no longer referenced by the owning entity instance\", due to the removed PersistentCollection wrapper.</p>\n\n<p>To solve my problem, the only thing that i need is hibernate to execute the query from options 1-3 as a DELETE instead of an UPDATE. I hope i am just unable to find the option to configure the mapping in a way that deletes these without the PersistentCollection wrappers, but to me currently it appears like there is no such option. Does anyone know if there is a way to configure this?</p>\n\n<p>/edit: To clarify, example of what i want to happen:</p>\n\n<pre><code>Parent parent = new Parent();\nparent.setChildren(new HashSet&lt;Child&gt;(Arrays.asList(new Child()))));\nsession.insert(parent)\n// this correctly results in (approximately):\n// SQL&gt; INSERT INTO PARENT ...\n// SQL&gt; INSERT INTO CHILD ...\n\nparent.setChildren(new HashSet&lt;Child&gt;()); // using .clear() is not an option.\nsession.update(parent);\n// this results in:\n// SQL&gt; UPDATE CHILD set parent_id = null WHERE parent_id = ${id.of.parent}\n// but i need this to result in:\n// SQL&gt; DELETE FROM CHILD WHERE parent_id = ${id.of.parent}\n</code></pre>\n"},{"tags":["hibernate","grails","gorm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13094936,"title":"Get a class type of a field in Hibernate UserType in Grails?","body":"<p>It's possible to use <code>UserType</code>s and even <code>CompositeUserType</code>s in Grails. According to <a href=\"http://grails.org/doc/latest/guide/GORM.html#customHibernateTypes\" rel=\"nofollow\">docs</a>:</p>\n\n<pre><code>class Book {\n\nString title\nName author\nRating rating\n\nstatic mapping = {\n    name type: NameUserType, {\n        column name: \"first_name\"\n        column name: \"last_name\"\n    }\n    rating type: RatingUserType\n}\n}\n</code></pre>\n\n<p>But what if I need to recognize the field type (e.g. <code>Rating</code> in example), like to create a (custom) one-to-one relationship?</p>\n\n<p>How can I address the related field classtype from a hibernate <code>UserType</code> implementation?</p>\n\n<p>I've found a <code>ParameterizedType</code> interface in hibernate (looks like it even <a href=\"http://markmail.org/message/qkpfsgsdgnm6jfcc#query%3a+page:1+mid%3aqkpfsgsdgnm6jfcc+state%3aresults\" rel=\"nofollow\">works</a> in Grails), but it's not so good to require developer to type again what could be achieved from code.</p>\n"},{"tags":["hibernate","struts","entity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13094202,"title":"error in integration of struts & hibernate","body":"<p>When i try to integrate struts2 &amp; hibernate3.6, i got the below mentioned problems. Kindly solve the my problem, i used mysql database and tomcat server in this integeration. Please friends any one answer ASAP...</p>\n\n<p>Struts Problem Report<br>\nStruts has detected an unhandled exception:   </p>\n\n<p>Messages: <strong>Error! Please, check your JDBC/JDNI Configurations and Database Server avaliability.</strong> at /addStudent - Method: com.tutorialspoint.struts2.AddStudentAction.execute() Could not open or inject a Hibernate Session in ValueStack: org.hibernate.MappingException: An AnnotationConfiguration instance is required to use   </p>\n\n<pre><code>File:   com/googlecode/s2hibernate/struts2/plugin/interceptors/SessionTransactionInjectorInterceptor.java   \nLine number: 182 \n</code></pre>\n\n<hr>\n\n<p>Stacktraces<br>\ncom.googlecode.s2hibernate.lang.SessionInjectionException: Error! Please, check your JDBC/JDNI Configurations and Database Server avaliability. at /addStudent - Method: com.tutorialspoint.struts2.AddStudentAction.execute() Could not open or inject a Hibernate Session in ValueStack: org.hibernate.MappingException: An AnnotationConfiguration instance is required to use \n    com.googlecode.s2hibernate.struts2.plugin.interceptors.SessionTransactionInjectorInterceptor.intercept(SessionTransactionInjectorInterceptor.java:182)<br>\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)<br>\n    com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept  (DefaultWorkflowInterceptor.java:176)<br>\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept  (MethodFilterInterceptor.java:98)<br>\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)<br>\n    com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept  (ConversionErrorInterceptor.java:138)<br>\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)<br>\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:211)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:90)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.ProfilingActivationInterceptor.intercept(ProfilingActivationInterceptor.java:104)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:256)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept  (ExceptionMappingInterceptor.java:187)<br>\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)<br>\n    org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)<br>\n    org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:510)<br>\n    org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:434)<br>\n    org.apache.catalina.core.ApplicationFilterChain.internalDoFilter  (ApplicationFilterChain.java:243)<br>\n    org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)<br>\n    org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)<br>\n    org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)<br>\n    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)<br>\n    org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)<br>\n    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)<br>\n    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:563)<br>\n    org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)<br>\n    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:403)<br>\n    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:301)<br>\n    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process  (Http11Protocol.java:162)<br>\n    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)<br>\n    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)<br>\n    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)<br>\n    java.lang.Thread.run(Unknown Source)  </p>\n\n<hr>\n\n<p>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nStruts Problem Report\nStruts has detected an unhandled exception: </p>\n\n<p>Messages: Error! Please, check your JDBC/JDNI Configurations and Database Server avaliability. at /addStudent - Method: com.tutorialspoint.struts2.AddStudentAction.execute() Could not open or inject a Hibernate Session in ValueStack: org.hibernate.MappingException: An AnnotationConfiguration instance is required to use </p>\n\n<p>File: com/googlecode/s2hibernate/struts2/plugin/interceptors/SessionTransactionInjectorInterceptor.java \nLine number: 182 </p>\n\n<hr>\n\n<p>Stacktraces\ncom.googlecode.s2hibernate.lang.SessionInjectionException: Error! Please, check your JDBC/JDNI Configurations and Database Server avaliability. at /addStudent - Method: com.tutorialspoint.struts2.AddStudentAction.execute() Could not open or inject a Hibernate Session in ValueStack: org.hibernate.MappingException: An AnnotationConfiguration instance is required to use \n    com.googlecode.s2hibernate.struts2.plugin.interceptors.SessionTransactionInjectorInterceptor.intercept(SessionTransactionInjectorInterceptor.java:182)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:176)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:138)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:211)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:90)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.ProfilingActivationInterceptor.intercept(ProfilingActivationInterceptor.java:104)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:256)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)\n    org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:510)\n    org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:434)\n    org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)\n    org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)\n    org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)\n    org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)\n    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n    org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:563)\n    org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:403)\n    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:301)\n    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:162)\n    org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)\n    java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n    java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    java.lang.Thread.run(Unknown Source)</p>\n\n<hr>\n\n<p>You are seeing this page because development mode is enabled. Development mode, or devMode, enables extra debugging behaviors and reports to assist developers. To disable this mode, set: </p>\n\n<p>struts.devMode=false</p>\n\n<p>in your WEB-INF/classes/struts.properties file.</p>\n"},{"tags":["performance","hibernate","jpa"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1569,"score":3,"question_id":4196921,"title":"Dynamic-update with JPA","body":"<p>I was surprised to recently learn that the default hibernate behavior is to update all of the fields in an object if only a single change is made and merge is called.</p>\n\n<p>Dynamic-update is the field that allows you to configure an alternative approach of just updating the changed field...</p>\n\n<p><a href=\"http://www.mkyong.com/hibernate/hibernate-dynamic-update-attribute-example/\" rel=\"nofollow\">http://www.mkyong.com/hibernate/hibernate-dynamic-update-attribute-example/</a></p>\n\n<p>I am using JPA with hibernate and I tried to add the following </p>\n\n<pre><code>@javax.persistence.Entity\n@org.hibernate.annotations.Entity(dynamicInsert=true, dynamicUpdate=true) \n</code></pre>\n\n<p>to my class (previously it only had the JPA annotation)</p>\n\n<p>Anyway, i've been monitoring the sql and unfortunately it didn't change it and I'm still seeing every field updated.</p>\n\n<p>This is my java that updates the object...</p>\n\n<pre><code>    @Transactional(readOnly = false, propagation = Propagation.REQUIRES_NEW)    \npublic void setAccountStatusForUser(String username, AccountStatus act){\n    User u = this.getUser(username);\n    u.setAccountStatus(act);\n    this.update(u);\n}\n</code></pre>\n\n<p>and the update method does the following:</p>\n\n<pre><code>    @Transactional(readOnly = false, propagation = Propagation.REQUIRES_NEW)\n  public Object update(Object o) {\n      Object a = this.entityManager.merge(o);\n      this.entityManager.flush();\n      return a;\n}\n</code></pre>\n\n<p>Any help would greatly be appreciated.</p>\n"},{"tags":["sql","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":395,"score":1,"question_id":10315377,"title":"Why in JPA Hibernate update query ; all attributes get update in SQL","body":"<p>I am using JPA with Hibernate. When I modify one attribute of an object and update it; the generated SQL shows all the columns getting updated ! Why doesn't it update only the modified columns? Is there a way to achieve that because I feel that will be more optimized.</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13092607,"title":"Bean creation exception","body":"<p>My application context looks likt this,</p>\n\n<pre><code>&lt;bean id=\"caseTxBo\" class=\"gov.case.rcp.bo.impl.caseTxBoImpl\" &gt;\n            &lt;property name=\"caseTxDao\" ref=\"caseTxDao\" /&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"caseTxDao\" class=\"gov.case.rcp.dao.impl.caseTxDaoImpl\" &gt;\n            &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n</code></pre>\n\n<p>Action class gets the context like this:</p>\n\n<pre><code>ServletContext context = request.getSession().getServletContext();\n     BeanFactory factory = WebApplicationContextUtils.\n           getRequiredWebApplicationContext(context);\n     CaseTxBOImpl caseTxBo = (\n\n             caseTxBoImpl) factory.getBean(\"caseTxBo\");\n\n     List&lt;caseTxPmt&gt; errorVarList =       \n     caseTxBo.getcaseTxDao().findAllcaseTx();\n\n    model.put(\"caseTxList\", caseTxList);\n</code></pre>\n\n<p>BOImpl implements Dao and DAOImpl implements Dao:</p>\n\n<p>DaoImpl has the implementation and returns caseTxList.</p>\n\n<p>but I get a runTimeException as </p>\n\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'caseTxBo' defined in ServletContext resource [/WEB-INF/classes/applicationContext.xml]: Cannot resolve reference to bean 'caseTxDao' while setting bean property 'caseTxDao'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'caseTxDao' defined in ServletContext resource [/WEB-INF/classes/applicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'sessionFactory' of bean class [gov.case.rcp.pp.dao.impl.CaseTxDaoImpl]: Bean property 'sessionFactory' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?\nfollows:\nat org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:275)\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:104)\n</code></pre>\n\n<p>Where did i go wrong?</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13091127,"title":"Hibernate group results by name then get the most current date","body":"<p>I'm using the following query to retrieve the following results. </p>\n\n<pre><code>List&lt;TranslationStyleSheet&gt; results = this.session.createCriteria(TranslationStyleSheet.class).list();\n\nFile_Name     Create_Date TimeStamp\n\nPDF Version | 10/1/2012\nPDF Version | 10/2/2012\nPDF Version | 10/10/2012\nTXT Version | 9/2/2012\nDOC Version | 9/31/2012\nDOC Version | 10/5/2012\n</code></pre>\n\n<p>From there I need to only return the most current file name excluding older results. </p>\n\n<p>example </p>\n\n<pre><code>File_Name     Create_Date TimeStamp\n\nPDF Version | 10/10/2012\nTXT Version | 9/2/2012\nDOC Version | 10/5/2012\n</code></pre>\n\n<p>I tried the following code without success. </p>\n\n<pre><code>List&lt;TranslationStyleSheet&gt; results = this.session.createCriteria(TranslationStyleSheet.class)\n            .setProjection(Projections.projectionList()\n            .add(Projections.groupProperty(\"fileName\"))\n            .add(Projections.max(\"createDate\")))\n            .list();\n</code></pre>\n\n<p>Does anybody know how to accomplish this? I first get an exception that says [Ljava.lang.Object; cannot be cast to org.mycompany.test.entities.TranslationStyleSheet</p>\n\n<p>When I iterate the results, I only get one in return. </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I was able to get the filtering to work properly with the following query, however I'm not sure how I could return a TranslationStyleSheet obj rather than just pieces of it. </p>\n\n<p>query </p>\n\n<pre><code>List results = this.session.createCriteria(TranslationStyleSheet.class)\n            .setProjection(Projections.projectionList()\n            .add(Projections.groupProperty(\"fileName\"))\n            .add(Projections.max(\"createDate\")))\n            .list();\n\n    List&lt;Object[]&gt; objs = results;\n\n    for (Object[] obj : objs ) {\n        System.out.println(obj[0] + \" \" + obj[1]);\n    } \n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13088341,"title":"Hibernate Error IllegalArgumentException: node to traverse cannot be null","body":"<p>My DELETE query is failing.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>String q = \"SELECT p.id FROM Person p, DomainGroup g WHERE \n   p member of g.coordinators\" + \" AND g.id = :groupId \n   AND p.id = :personId\";\n\nList&lt;Long&gt; test = getEntityManager()\n  .createQuery(q).setParameter(\"groupId\", followingId)\n  .setParameter(\"personId\", followerId).getResultList();\n\nlog.debug(\"test = \" + test);\n\nString deleteGroupCoordinatorQuery = \n  \"DELETE FROM Person p, DomainGroup g WHERE p member \n     of g.coordinators\" + \" AND g.id = :groupId \n        AND p.id = :personId\";\n\nList&lt;Long&gt; test = getEntityManager()\n      .createQuery(deleteGroupCoordinatorQuery).setParameter\n      (\"groupId\", followingId)\n      .setParameter(\"personId\", followerId).executeUpdate();\n</code></pre>\n\n<p>output:</p>\n\n<blockquote>\n  <p>test = [1,2,3]</p>\n  \n  <p>2012-10-26 13:44:56,437 ERROR\n  org.company.commons.server.service.ServiceActionController - Error\n  occurred performing transaction. java.lang.IllegalArgumentException:\n  node to traverse cannot be null!\n          at org.hibernate.hql.ast.util.NodeTraverser.traverseDepthFirst(NodeTraverser.java:55)\n          at org.hibernate.hql.ast.QueryTranslatorImpl.parse(QueryTranslatorImpl.java:280)\n          at org.hibernate.hql.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:182)\n          at org.hibernate.hql.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)</p>\n</blockquote>\n\n<p>Thanks,\nKevin</p>\n"},{"tags":["spring","hibernate","transactions"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":1,"view_count":81,"score":1,"question_id":13066017,"title":"@Transactional in Spring+Hibernate","body":"<p>I an using <strong>Spring 3.1 + Hibernate 4.x</strong> in my web application. \nIn my DAO, i am saving User type object as following </p>\n\n<pre><code>sessionFactory.getCurrentSession().save(user);\n</code></pre>\n\n<p>But getting following exception:</p>\n\n<pre><code>org.hibernate.HibernateException: save is not valid without active transaction\n</code></pre>\n\n<p>I googled and found similar <a href=\"http://stackoverflow.com/questions/12002737/org-hibernate-hibernateexception-save-is-not-valid-without-active-transaction\">question</a> on SO, with following solution:</p>\n\n<pre><code>   Session session=getSessionFactory().getCurrentSession();\n   Transaction trans=session.beginTransaction();\n   session.save(entity);\n   trans.commit();\n</code></pre>\n\n<p>That solves the problem. But in that solution, there is lot of mess of beginning and committing the transactions manually. </p>\n\n<p>Can't i use     <code>sessionFactory.getCurrentSession().save(user);</code> directly without begin/commit of transactions manually?</p>\n\n<p>I try to use <code>@Transactional</code> on my service/dao methods too, but the problem persists.</p>\n\n<p><strong>EDIT :</strong> Here is my Hibernate Config File:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     xmlns:p=\"http://www.springframework.org/schema/p\"\n     xmlns:aop=\"http://www.springframework.org/schema/aop\"\n     xmlns:tx=\"http://www.springframework.org/schema/tx\"\n     xsi:schemaLocation=\"\n     http://www.springframework.org/schema/beans \n     http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n     http://www.springframework.org/schema/tx\n     http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n     http://www.springframework.org/schema/aop \n     http://www.springframework.org/schema/aop/spring-aop-3.1.xsd\"&gt;\n\n\n  &lt;!-- enable the configuration of transactional behavior based on annotations --&gt;\n  &lt;tx:annotation-driven transaction-manager=\"txManager\"/&gt;\n\n    &lt;bean id=\"dataSource\"\n        class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"\n        p:driverClassName=\"${db.driverClassName}\" p:url=\"${db.url}\"\n        p:username=\"${db.username}\" p:password=\"${db.password}\" /&gt;\n\n    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"packagesToScan\" value=\"com.myapp.entities\" /&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/prop&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n            &lt;/props&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n\n    &lt;bean id=\"txManager\"\n        class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n        &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref bean=\"sessionFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>I am using following Hibernate 4 dependencies:</p>\n\n<pre><code>&lt;!-- Hibernate Dependency --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;4.1.7.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n            &lt;version&gt;4.1.1.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;cglib&lt;/groupId&gt;\n            &lt;artifactId&gt;cglib&lt;/artifactId&gt;\n            &lt;version&gt;${cglib.version}&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n</code></pre>\n\n<p>Please help.</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13085508,"title":"How to give Trigger generated value into Hibernate ValueObject?","body":"<p>In my Hibernate Application i'm using create a ValueObject class </p>\n\n<pre><code>@Entity\n@Table(name=\"user\")\npublic class UserVO{\n\n    @Id\n    @Column(name=\"S_ID\")\n    private String s_id;\n\n    @Column(name=\"FIRSTNAME\")\n    private String firstName;\n\n    @Column(name=\"LASTNAME\")\n    private String lastName;\n }\n</code></pre>\n\n<p>and in my Service class i'm writing like this</p>\n\n<pre><code>public void createOrUpdateUser(UserVO userVO) {\n        userDAO.createOrUpdateUser(userVO);\n    }\n</code></pre>\n\n<p>and in my DAO class i'm writing like this</p>\n\n<pre><code>private EntityManager entityManager;\npublic void createOrUpdateUser(UserVO userVO) throws DataAccessException {\n        entityManager.persist(userVO);\n    }\n</code></pre>\n\n<p>now i'm calling createOrUpdateUser(userVO) but it give error</p>\n\n<pre><code>Caused by: org.hibernate.id.IdentifierGenerationException: ids for this class must be manually assigned before calling save()\n</code></pre>\n\n<p>Actually my data base i have created one <code>trigger</code> for <code>user</code> table to generate unique id for <code>s_id</code> column is their any problem for trigger..please suggest me..</p>\n"},{"tags":["hibernate","subquery","detachedcriteria"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13075390,"title":"Hibernate subquery detachedCriteria","body":"<p>How to write a subquery in hibernate which is having multiple subqueries. for example</p>\n\n<pre><code>select * from project_dtls where project_id in  \n  (select project_id from project_users where user_id =\n  (select user_id from user_dtls where email='abc@email.com'))\n</code></pre>\n\n<p>I know that we can write through DetachedCriteria but couldnot find any example where I can use multiple subqueries.</p>\n"},{"tags":["spring","hibernate","jpa","spring-security","jpa-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13086821,"title":"Put Spring EntityManager in thread for async Servlet 3.0?","body":"<p>We're trying to enable Servlet's 3.0 \"async-supported\" in our Spring application:</p>\n\n<ul>\n<li><p>Added in web.xml <strong>(async-supported)true(/async-supported)</strong> for all servlets and filters.</p></li>\n<li><p>Rewrote the request handling code as</p></li>\n</ul>\n\n<p>**</p>\n\n<pre><code>request.getAsyncContext().start(new Runnable() {\n  @Override\n  public void run() {\n    handleRequest(servlet, request, response);\n  }\n});\n</code></pre>\n\n<p>**</p>\n\n<p>This causes two problems:</p>\n\n<ol>\n<li><p>Spring Security authentication is lost when running the asynchronous code.</p></li>\n<li><p>There is no EntityManager/session/... any more either.</p></li>\n</ol>\n\n<p>Of course both problems are due to the fact the handler code is not executed in the same thread as the thread that created the Runnable. Ideally the worker thread should \"inherit\" the Spring contexts from the invoking thread.</p>\n\n<p>I could get around the Spring Security problem by saving the authentication at construction time and setting it at execution time. </p>\n\n<pre><code>private final Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n\ntry {\n  SecurityContextHolder.clearContext();\n  SecurityContextHolder.getContext().setAuthentication(authentication);\n\n  ..run code here..\n\n} finally {\n  SecurityContextHolder.clearContext();\n} \n</code></pre>\n\n<p>However, for the second problem I have no clue how to \"transfer\" the session to the executing thread. For servlet 2.x we were using <strong><em>OpenEntityManagerInViewFilter</em></strong> to stick a session to the thread.</p>\n\n<pre><code>&lt;filter&gt;\n  &lt;filter-name&gt;openEntityManagerInViewFilter&lt;/filter-name&gt;\n  &lt;filter-class&gt;org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter&lt;/filter-class&gt;\n  &lt;async-supported&gt;true&lt;/async-supported&gt;\n  &lt;init-param&gt;\n    &lt;param-name&gt;entityManagerFactoryBeanName&lt;/param-name&gt;\n    &lt;param-value&gt;entityManagerFactory&lt;/param-value&gt;\n  &lt;/init-param&gt;\n&lt;/filter&gt;\n</code></pre>\n\n<p>But now of course this does not make sense any more because the thread it sticks it to is not the same as the one which executed the request.</p>\n\n<p>I've tried various versions of Spring 3.1 and 3.2. But to no effect. </p>\n\n<p>Anybody who knows how to get around this ? Preferably with hacking. :-)</p>\n\n<p>My <strong>web.xml</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app xmlns=\"http://java.sun.com/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd\"\n         version=\"3.0\"&gt;\n\n  &lt;servlet&gt;\n    &lt;servlet-name&gt;Foo&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;com.foo.Main&lt;/servlet-class&gt;\n    &lt;async-supported&gt;true&lt;/async-supported&gt;\n  &lt;/servlet&gt;\n\n  &lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;Foo&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/restricted/*&lt;/url-pattern&gt;\n  &lt;/servlet-mapping&gt;\n\n  &lt;filter&gt;\n    &lt;filter-name&gt;openEntityManagerInViewFilter&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter&lt;/filter-class&gt;\n    &lt;async-supported&gt;true&lt;/async-supported&gt;\n    &lt;init-param&gt;\n      &lt;param-name&gt;entityManagerFactoryBeanName&lt;/param-name&gt;\n      &lt;param-value&gt;entityManagerFactory&lt;/param-value&gt;\n    &lt;/init-param&gt;\n  &lt;/filter&gt;\n\n  &lt;filter&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n    &lt;async-supported&gt;true&lt;/async-supported&gt;\n  &lt;/filter&gt;\n\n  &lt;filter-mapping&gt;\n    &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n  &lt;/filter-mapping&gt;\n\n  &lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n  &lt;/listener&gt;\n\n  &lt;listener&gt;\n    &lt;listener-class&gt;org.bar.ServletInit&lt;/listener-class&gt;\n  &lt;/listener&gt;\n\n  &lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;/WEB-INF/applicationContext.xml&lt;/param-value&gt;\n  &lt;/context-param&gt;\n\n  &lt;context-param&gt;\n    &lt;param-name&gt;contextInitializerClasses&lt;/param-name&gt;\n    &lt;param-value&gt;com.foo.SpringCtxInitializer&lt;/param-value&gt;\n  &lt;/context-param&gt;\n\n  &lt;filter-mapping&gt;\n    &lt;filter-name&gt;openEntityManagerInViewFilter&lt;/filter-name&gt;\n    &lt;url-pattern&gt;/restricted/*&lt;/url-pattern&gt;\n  &lt;/filter-mapping&gt;\n\n&lt;/web-app&gt;\n</code></pre>\n"},{"tags":["java","mysql","hibernate","large-data-volumes","scrollableresults"],"answer_count":8,"favorite_count":4,"up_vote_count":10,"down_vote_count":0,"view_count":14273,"score":10,"question_id":2826319,"title":"Using Hibernate's ScrollableResults to slowly read 90 million records","body":"<p>I simply need to read each row in a table in my MySQL database using Hibernate and write a file based on it.  But there are 90 million rows and they are pretty big.  So it seemed like the following would be appropriate:</p>\n\n<pre><code>ScrollableResults results = session.createQuery(\"SELECT person FROM Person person\")\n            .setReadOnly(true).setCacheable(false).scroll(ScrollMode.FORWARD_ONLY);\nwhile (results.next())\n    storeInFile(results.get()[0]);\n</code></pre>\n\n<p>The problem is the above will try and load all 90 million rows into RAM before moving on to the while loop... and that will kill my memory with OutOfMemoryError: Java heap space exceptions :(.</p>\n\n<p>So I guess ScrollableResults isn't what I was looking for?  What is the proper way to handle this?  I don't mind if this while loop takes days (well I'd love it to not).</p>\n\n<p>I guess the only other way to handle this is to use setFirstResult and setMaxResults to iterate through the results and just use regular Hibernate results instead of ScrollableResults.  That feels like it will be inefficient though and will start taking a ridiculously long time when I'm calling setFirstResult on the 89 millionth row...</p>\n\n<p>UPDATE: setFirstResult/setMaxResults doesn't work, it turns out to take an unusably long time to get to the offsets like I feared.  There must be a solution here!  Isn't this a pretty standard procedure??  I'm willing to forgo Hibernate and use JDBC or whatever it takes.</p>\n\n<p>UPDATE 2: the solution I've come up with which works ok, not great, is basically of the form:</p>\n\n<pre><code>select * from person where id &gt; &lt;offset&gt; and &lt;other_conditions&gt; limit 1\n</code></pre>\n\n<p>Since I have other conditions, even all in an index, it's still not as fast as I'd like it to be...  so still open for other suggestions..</p>\n"},{"tags":["spring","hibernate","sessionfactory"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1870,"score":3,"question_id":10298483,"title":"Spring and hibernate: No Session found for current thread","body":"<p>im gettting the following error</p>\n\n<pre><code>org.hibernate.HibernateException: No Session found for current thread\nat org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)\nat org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:1024)\nat com.fexco.shoptaxfreemobile.service.ProfileService.registerVisitor(ProfileService.java:57)\nat com.fexco.shoptaxfreemobile.controller.ProfileController.registerVisitor(ProfileController.java:91)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)\nat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)\nat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)\nat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)\nat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:668)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:770)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\nat com.fexco.shoptaxfreemobile.jsonp.JsonpCallbackFilter.doFilter(JsonpCallbackFilter.java:33)\nat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)\nat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\nat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\nat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\nat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\nat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)\nat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:300)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\nat java.lang.Thread.run(Thread.java:619)\n</code></pre>\n\n<p>Service class</p>\n\n<pre><code>@Service\npublic class ProfileService {\n\n@Resource(name = \"mySessionFactory\")\nprivate SessionFactory sessionFactory;\n\n@Autowired\nprivate ProfileDao profileDao;\n\nprivate class CountrySorter implements Comparator&lt;Country&gt; {\n    @Override\n    public int compare(Country country1, Country country2) {\n        if ( country1.getId().compareTo(new Long (3)) &lt; 0){\n            return country1.getId().compareTo(country2.getId());\n        }\n        return country1.getName().compareToIgnoreCase(country2.getName());\n    }               \n}\n\npublic List&lt;Country&gt; getCountries() {\n\n    List&lt;VisitorCountry&gt; visitorCountries = profileDao.getAllCountries();       \n\n    List&lt;Country&gt; countries = new ArrayList&lt;Country&gt;();\n    for ( VisitorCountry country : visitorCountries){\n        countries.add(country.getCountry());\n    }\n\n    Comparator&lt;Country&gt; comparator = new CountrySorter();       \n    Collections.sort(countries, comparator);\n\n    return countries;\n}\n\npublic RegisterResponse registerVisitor(JsonVisitor visitorDetails){\n    Visitor storedVisitor = (Visitor) sessionFactory.getCurrentSession().get(Visitor.class, visitorDetails.getTfscNumber(), LockMode.NONE);\n    if ( storedVisitor == null){\n        storedVisitor = new Visitor(visitorDetails);\n    }else{\n        storedVisitor.setVisitorDetails(visitorDetails);    \n    }\n\n    try{\n        sessionFactory.getCurrentSession().saveOrUpdate(storedVisitor);\n\n    }catch(Exception ex){\n        return new RegisterResponse(false, \"Failed To Register Card. Please Try Again Later.\", visitorDetails);\n    }\n\n    return new RegisterResponse(true, \"\", visitorDetails);\n\n}\n\n}\n</code></pre>\n\n<p>bit of DAO class</p>\n\n<pre><code>@Service\n@Transactional\npublic class ProfileDao {\n\n@Resource(name = \"mySessionFactory\")\nprivate SessionFactory sessionFactory;\n\npublic List getAllCountries(){\n\n    List&lt;VisitorCountry&gt; visitorCountries = sessionFactory.getCurrentSession()\n    .getNamedQuery(\"GET_ALL_COUNTRIES\").list();\n\n    return visitorCountries;\n\n}\n\npublic List&lt;Retailer&gt; getRetailerByRetailerNumber(String retailerNo) {\n\n    List&lt;Retailer&gt; retailerByRetailerNumber = sessionFactory.getCurrentSession()\n    .getNamedQuery(\"FindRetailerByRetailerNo\").setString(\"retailerNo\", retailerNo).list();\n\n    return retailerByRetailerNumber;\n}\n</code></pre>\n\n<p>and i have this in my application-context.xml</p>\n\n<pre><code>&lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n&lt;bean id=\"mySessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"myDataSource\" /&gt;\n    &lt;property name=\"configLocation\" value=\"classpath:hibernate.cfg.xml\" /&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;value&gt;\n            &lt;![CDATA[\n        hibernate.show_sql=true\n        hibernate.format_sql=true\n        hibernate.cache.provider_class=org.hibernate.cache.NoCacheProvider\n        ]]&gt;\n        &lt;/value&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>can anyone spot why i am getting the following error?</p>\n"},{"tags":["spring","hibernate","struts2","log4j","tiles"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13087529,"title":"Unnecessary logging by logger in struts 2 + tiles + hibernate aaplication","body":"<p>I have a struts 2 plus spring plus hibernate application. In efforts of modularising the application, i incorporated tiles in the application. After using TILES, the pages are loading very slowly. I can see in the console that CommonsLogger.java and Log4JLoggerFactory.java are maniacally putting logs viz..<code>Key 'disabled' was not found on instance of java.util.LinkedHashMap. Introsp...</code> I dont see any reason why this should be logged. earlier the pages were loading fine but now it is crazy. Please help me solve this issue.</p>\n"},{"tags":["spring","hibernate","exception","maven","sharding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13072690,"title":"java.lang.NoClassDefFoundError: org/hibernate/engine/SessionFactoryImplementor from Spring 3.1.2/Hibernate 4.1.7 and Shards 3.0.0.Beta2","body":"<p>I'm trying a simple Hibernate shard example (Yes, odd, 3.0.0.Beta2 released 4 years ago) using Hibernate Core 4.1.7 and Spring 3.1.2 and hit this issue during session factory initialization:</p>\n\n<pre><code>Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'mySessionFactory' defined in class path resource [shardedspring-config.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Factory method [public org.hibernate.SessionFactory it.sella.lab.crm.sys.persistence.ShardedSessionFactoryBuilder.createSessionFactory()] threw exception; nested exception is java.lang.NoClassDefFoundError: org/hibernate/engine/SessionFactoryImplementor\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:581)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)\n    at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:139)\n    at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:83)\n    at in.rixx.crm.model.Activity.&lt;clinit&gt;(Activity.java:17)\n</code></pre>\n\n<p>This is how I pick Spring and Hibernate:</p>\n\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n        &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n        &lt;version&gt;4.1.7.Final&lt;/version&gt;\n &lt;/dependency&gt;\n &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n        &lt;version&gt;3.1.2.RELEASE&lt;/version&gt;\n &lt;/dependency&gt; \n</code></pre>\n\n<p>This doesn't seem like a issue with shards library - it looks like a general issue caused by refactored SessionFactoryImplementor class. Referring to <a href=\"https://jira.springsource.org/browse/SPR-8885\" rel=\"nofollow\">https://jira.springsource.org/browse/SPR-8885</a>, I've also switched to org.springframework.orm.hibernate4.HibernateTransactionManager for bean 'transactionmanager' - it isn't helping.</p>\n\n<p>Is there any functional workaround right now for Spring 3.x and Hibernate 4.x?</p>\n"},{"tags":["eclipse","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13087355,"title":"hibernate console configuration dissappeared in eclipse","body":"<p>I'm working with Eclipse Indigo and the Hibernate tools/plugins (3.4.0...) by JBoss Red Hat. For the purpose of reverse engineering of Hibernate value object classes I created several console configurations with the wizard that pops up when clicking on add in the Hibernate Configurations view. </p>\n\n<p>Later when I wanted to regenerate the classes, some of the configurations had dissapeared. When I wanted to add a new configuration with the name of one of the now dissapeared configurations the wizard tells me that the configuration already exists.</p>\n\n<p>Since I couldn't find out where these configurations are stored I'm unable to do anything about it.</p>\n\n<p>Do I have to create a new configuration with a different name? </p>\n"},{"tags":["java","spring","hibernate","java-ee"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":588,"score":0,"question_id":12433499,"title":"org.hibernate.QueryParameterException: could not locate named parameter","body":"<p>My project setting are Spring MVC, Hibernate 3.2.x, on MySQL DB</p>\n\n<p>Getting the following error: \norg.hibernate.QueryParameterException: could not locate named parameter email </p>\n\n<p>Approach #1:</p>\n\n<pre><code>@Override\n    public Boolean isExist(String email)\n    {\n    boolean flag = false;  \n   String hql = \"from com.cmgr.beans.UserAccount u where u.email = :email\";\n  List&lt;UserAccount&gt; result = currentSession().createQuery(hql)\n .setParameter(\"email\", email)\n .list();\n\n  UserAccount userAccount = (UserAccount)result.get(0);\n  if (userAccount!=null &amp;&amp; userAccount.getEmail().equalsIgnoreCase(email))\n  {\n      flag = true;\n  }\n    return flag;\n    }\n</code></pre>\n\n<p>Approach #2:</p>\n\n<pre><code> @Override\n    public Boolean isExist(String email) {\n        boolean flag = false;\n        String hql = \"from com.cmgr.beans.UserAccount u where u.email = :email\";\n        List&lt;UserAccount&gt; result = currentSession().createQuery(hql).setString(\"email\", email).list();\n\n        UserAccount userAccount = (UserAccount) result.get(0);\n        if (userAccount != null &amp;&amp; userAccount.getEmail().equalsIgnoreCase(email)) {\n            flag = true;\n        }\n        return flag;\n    }\n</code></pre>\n\n<p>Error:\njava.lang.IllegalArgumentException: Parameter email does not exist as a named parameter in [from com.cmgr.beans.UserAccount u where u.email = :email]</p>\n\n<p>UserAccount class:</p>\n\n<pre><code>package com.cmgr.beans;\n\nimport java.io.Serializable;\nimport java.util.List;\nimport java.util.Set;\nimport javax.persistence.*;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\n\n@Entity\n@Table(name = \"user_account\")\npublic class UserAccount implements Serializable {\n\n    @Autowired\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY, generator = \"user_account_seq\")\n    @SequenceGenerator(name = \"user_account_seq\", sequenceName = \"user_account_seq\")\n    @Column(name = \"user_id\")\n    private Long UserId = null;\n    //\n    @Autowired\n    @Column(name = \"user_name\")\n    private String UserName;\n    //\n    @Autowired\n    @Column(name = \"user_type\")\n    private String UserType = null;\n    //\n    @Autowired\n    @Column(name = \"first_name\")\n    private String FirstName;\n    //\n    @Autowired\n    @Column(name = \"last_name\")\n    private String LastName;\n    //\n    @Autowired\n    @Column(name = \"email\")\n    private String Email;\n    //\n    @Autowired\n    @Column(name = \"phone_contact_1\")\n    private String PhoneContact1 = null;\n    //\n    @Autowired\n    @Column(name = \"phone_contact_2\")\n    private String PhoneContact2 = null;\n    //primary_address_is_usa\n    @Autowired\n    @Column(name = \"primary_address_is_usa\")\n    private Boolean primaryAddressIsUsa = null;\n    //\n    @Autowired\n    @Column(name = \"address_1\")\n    private String Address1 = null;\n    //\n    @Autowired\n    @Column(name = \"city1\")\n    private String city1 = null;\n    //\n    @Autowired\n    @Column(name = \"state1\")\n    private String state1 = null;\n    //\n    @Autowired\n    @Column(name = \"country1\")\n    private String country1 = null;\n    //\n    @Autowired\n    @Column(name = \"zipcode\")\n    private Integer zipcode = 0;\n    //\n    @Autowired\n    @Column(name = \"Industry\")\n    private String Industry = null;\n    //is the user account Active either due to user deactivation,admin deactivation, or nonpayment\n    @Autowired\n    @Column(name = \"active\")\n    private boolean Active = false;\n    //1 to 1 relation with registerationCode in Registeration class \n    @Autowired\n    @Qualifier(\"UserRegisteration\")\n    @OneToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"Registeration_Code_fk\", referencedColumnName = \"registeration_code\", nullable = false)\n    private UserRegisteration UserRegisteration;\n    //1 to many relation with EmailId in Email class  \n    @OneToMany(cascade = {CascadeType.ALL})\n    @JoinColumn(name = \"emailed_id\")\n    private List&lt;Emailed&gt; emailed = null;\n    //1 to many relation with signatureId in signature class\n    @OneToMany(cascade = {CascadeType.ALL})\n    @JoinColumn(name = \"signature_id\")\n    private List&lt;Signature&gt; signatures;\n    //1 to many relation with UserAccountDocId in UserAccountDoc class \n    @OneToMany(cascade = {CascadeType.ALL})\n    @JoinColumn(name = \"user_doc_id\")\n    private Set&lt;UserAccountDocumentRelationship&gt; UserAccountDocumentRelationship;\n\n    @Autowired(required = false)\n    public UserAccount() {\n    }\n\n    @Autowired(required = true)\n    public UserAccount(String UserName, String FirstName, String LastName, String Email, String Industry) {\n        this.FirstName = FirstName;\n        this.LastName = LastName;\n        this.Email = Email;\n        this.Industry = Industry;\n        this.UserName = UserName;\n    }\n\n    @Autowired(required = false)\n    public UserAccount(String UserName, Long UserId, String FirstName, String LastName, String Email, String Industry) {\n        this.UserId = UserId;\n        this.FirstName = FirstName;\n        this.LastName = LastName;\n        this.Email = Email;\n        this.Industry = Industry;\n        this.UserName = UserName;\n    }\n\n    public String getIndustry() {\n        return Industry;\n    }\n\n    public void setIndustry(String Industry) {\n        this.Industry = Industry;\n    }\n\n    public String getAddress1() {\n        return Address1;\n    }\n\n    public void setAddress1(String Address1) {\n        this.Address1 = Address1;\n    }\n\n    public String getPhoneContact1() {\n        return PhoneContact1;\n    }\n\n    public void setPhoneContact1(String PhoneContact1) {\n        this.PhoneContact1 = PhoneContact1;\n    }\n\n    public String getPhoneContact2() {\n        return PhoneContact2;\n    }\n\n    public void setPhoneContact2(String PhoneContact2) {\n        this.PhoneContact2 = PhoneContact2;\n    }\n\n    public boolean isActive() {\n        return Active;\n    }\n\n    public void setActive(boolean Active) {\n        this.Active = Active;\n    }\n\n    public String getEmail() {\n        return Email;\n    }\n\n    public void setEmail(String Email) {\n        this.Email = Email;\n    }\n\n    public String getFirstName() {\n        return FirstName;\n    }\n\n    public void setFirstName(String FirstName) {\n        this.FirstName = FirstName;\n    }\n\n    public String getLastName() {\n        return LastName;\n    }\n\n    public void setLastName(String LastName) {\n        this.LastName = LastName;\n    }\n\n    public com.cmgr.beans.UserRegisteration getUserRegisteration() {\n        return UserRegisteration;\n    }\n\n    public void setUserRegisteration(com.cmgr.beans.UserRegisteration UserRegisteration) {\n        this.UserRegisteration = UserRegisteration;\n    }\n\n    public Long getUserId() {\n        return UserId;\n    }\n\n    public void setUserId(Long UserId) {\n        this.UserId = UserId;\n    }\n\n    public String getUserType() {\n        return UserType;\n    }\n\n    public void setUserType(String UserType) {\n        this.UserType = UserType;\n    }\n\n    public List&lt;Emailed&gt; getEmailed() {\n        return emailed;\n    }\n\n    public void setEmailed(List&lt;Emailed&gt; emailed) {\n        this.emailed = emailed;\n    }\n\n    public List&lt;Signature&gt; getSignatures() {\n        return signatures;\n    }\n\n    public void setSignatures(List&lt;Signature&gt; signatures) {\n        this.signatures = signatures;\n    }\n\n    public String getCity1() {\n        return city1;\n    }\n\n    public void setCity1(String city1) {\n        this.city1 = city1;\n    }\n\n    public String getCountry1() {\n        return country1;\n    }\n\n    public void setCountry1(String country1) {\n        this.country1 = country1;\n    }\n\n    public Boolean getPrimaryAddressIsUsa() {\n        return primaryAddressIsUsa;\n    }\n\n    public void setPrimaryAddressIsUsa(Boolean primaryAddressIsUsa) {\n        this.primaryAddressIsUsa = primaryAddressIsUsa;\n    }\n\n    public String getState1() {\n        return state1;\n    }\n\n    public void setState1(String state1) {\n        this.state1 = state1;\n    }\n\n    public Integer getZipcode() {\n        return zipcode;\n    }\n\n    public void setZipcode(Integer zipcode) {\n        this.zipcode = zipcode;\n    }\n\n    public String getUserName() {\n        return UserName;\n    }\n\n    public void setUserName(String UserName) {\n        this.UserName = UserName;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (obj == null) {\n            return false;\n        }\n        if (getClass() != obj.getClass()) {\n            return false;\n        }\n        final UserAccount other = (UserAccount) obj;\n        if ((this.UserId == null) ? (other.UserId != null) : !this.UserId.equals(other.UserId)) {\n            return false;\n        }\n        return true;\n    }\n\n    @Override\n    public int hashCode() {\n        int hash = 3;\n        hash = 73 * hash + (this.UserId != null ? this.UserId.hashCode() : 0);\n        return hash;\n    }\n\n    public Set&lt;com.cmgr.beans.UserAccountDocumentRelationship&gt; getUserAccountDocumentRelationship() {\n        return UserAccountDocumentRelationship;\n    }\n\n    public void setUserAccountDocumentRelationship(Set&lt;com.cmgr.beans.UserAccountDocumentRelationship&gt; UserAccountDocumentRelationship) {\n        this.UserAccountDocumentRelationship = UserAccountDocumentRelationship;\n    }\n}\n</code></pre>\n"},{"tags":["hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2651,"score":0,"question_id":2380224,"title":"JPA + Hibernate + Named Query + how to JOIN a subquery result","body":"<p>Can anybody help me in converting the following native query into a Named Query?</p>\n\n<p><strong>Native Query:</strong></p>\n\n<pre>\nSELECT \n      usr1.user_id, urr1.role_id, usr2.user_id, urr2.role_id, usr1.school_id, \n      term.term_name, count(material.material_id) as \"Total Book Count\", \n      fpc.FOLLETT_PENDING_COUNT as \"Follett Pending Count\", \n      rrc.RESOLUTION_REQUIRED_COUNT as \"Resolution Required Count\" \nFROM  va_school sch \n\nJOIN va_user_school_rel usr1 on sch.school_id=usr1.school_id  \nJOIN va_user_role_rel urr1 on usr1.user_id=urr1.user_id and urr1.role_id=1001 \nJOIN va_user_school_rel usr2 on sch.school_id=usr2.school_id \nJOIN va_user_role_rel urr2 on usr2.user_id=urr2.user_id and urr2.role_id=1002 \nJOIN va_term term on term.school_id = usr1.school_id \nJOIN va_class course on course.term_id = term.term_id \nJOIN va_material material on material.class_id = course.class_id\n\nLEFT JOIN \n      (SELECT VA_CLASS.TERM_ID as \"TERM_ID\", COUNT(*) as \"FOLLETT_PENDING_COUNT\" \n       FROM VA_CLASS JOIN VA_MATERIAL ON VA_MATERIAL.CLASS_ID = VA_CLASS.CLASS_ID \n       WHERE VA_CLASS.reference_flag = 'A' AND trunc(VA_MATERIAL.FOLLETT_STATUS) = 0 \n       GROUP BY VA_CLASS.TERM_ID) fpc on term.term_id = fpc.term_id \n\nLEFT JOIN \n      (SELECT VA_CLASS.TERM_ID as \"TERM_ID\", COUNT(*) as \"RESOLUTION_REQUIRED_COUNT\" \n       FROM VA_CLASS JOIN VA_MATERIAL ON VA_MATERIAL.CLASS_ID = VA_CLASS.CLASS_ID \n       WHERE VA_CLASS.reference_flag = 'A' AND trunc(VA_MATERIAL.FOLLETT_STATUS) = 1 \n       GROUP BY VA_CLASS.TERM_ID) rrc on term.term_id = rrc.term_id \nWHERE course.reference_flag = 'A' \nGROUP BY usr1.user_id, urr1.role_id, usr2.user_id, urr2.role_id, usr1.school_id, term.term_name, fpc.FOLLETT_PENDING_COUNT, rrc.RESOLUTION_REQUIRED_COUNT \nORDER BY usr1.school_id, term.term_name;\n</pre>\n\n<p>Thanks in advance.</p>\n\n<ul>\n<li>Srihari</li>\n</ul>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13046985,"title":"Two threads writing different fields of same entity","body":"<p>I have the following situation.</p>\n\n<p>One business entity (BE) consists of 2 parts provided asynchronously by 2 threads.\nExample: our BE has fields id and, A, B, C - all in one table in database. Id is generated by sequence when entity is stored into database. B is unique field, there's constraint on it in database.  Process1 provides fields A and B. Process2  provides fields B and C. So after both processes finish, we should have one row in a table with all columns filled in. </p>\n\n<p>What is the good way to make this work? </p>\n\n<p>What is done now:</p>\n\n<p>In each process we first select all values from table where value in column B is what we now have. (If any - this means the other process already saved it's part). If there's something, it is enriched with the missing column and persisted. If there's nothing - we just persist what we have. But while all this is done, it can occur that the other process finished it's job and when we persist our entity, we get ConstraintViolationException and hibernate marks transaction to rollback. And the missing column is still missing. </p>\n"},{"tags":["java","eclipse","hibernate","eclipse-plugin"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13086368,"title":"Error in using hibernate","body":"<p>i am new to Java Application based on Hibernate technology.\ni get some problems in installing my system..\nso i am installed in my friends system.. so , i installed JBOSS Tools(in that only Hibernate tools) in Eclipse Juno(Portable).. </p>\n\n<p>I just copied that folder in to my system and i run the Eclipse.exe file and it runs smooth but when i trying to create new Hibernate Configuration file in hibernate perspective.</p>\n\n<p>But i got below error..</p>\n\n<p>\"Class path must be set or restored default\".  </p>\n\n<p><img src=\"http://i.stack.imgur.com/wl3qG.png\" alt=\"\">\nAny one help to solve this problem...</p>\n"},{"tags":["java","json","hibernate","spring-mvc","jackson"],"answer_count":7,"favorite_count":6,"up_vote_count":15,"down_vote_count":0,"view_count":13032,"score":15,"question_id":4362104,"title":"Strange Jackson exception being thrown when serializing Hibernate object","body":"<p>Jackson is throwing a weird exception that I don't know how to fix. I'm using Spring, Hibernate and Jackson.</p>\n\n<p>I have already considered that lazy-loading is causing the problem, but I have taken measures to tell Jackson to NOT process various properties as follows:</p>\n\n<pre><code>@JsonIgnoreProperties({ \"sentMessages\", \"receivedMessages\", \"educationFacility\" })\npublic class Director extends UserAccount implements EducationFacilityUser {\n   ....\n}\n</code></pre>\n\n<p>I have done the same thing for all the other UserAccount subclasses as well.</p>\n\n<p>Here's the exception being thrown:</p>\n\n<pre><code>org.codehaus.jackson.map.JsonMappingException: No serializer found for class org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer and no properties discovered to create BeanSerializer (to avoid exception, disable SerializationConfig.Feature.FAIL_ON_EMPTY_BEANS) ) (through reference chain: java.util.ArrayList[46]-&gt;jobprep.domain.educationfacility.Director_$$_javassist_2[\"handler\"])\n    at org.codehaus.jackson.map.ser.StdSerializerProvider$1.serialize(StdSerializerProvider.java:62)\n    at org.codehaus.jackson.map.ser.BeanPropertyWriter.serializeAsField(BeanPropertyWriter.java:268)\n    at org.codehaus.jackson.map.ser.BeanSerializer.serializeFields(BeanSerializer.java:146)\n    at org.codehaus.jackson.map.ser.BeanSerializer.serialize(BeanSerializer.java:118)\n    at org.codehaus.jackson.map.ser.ContainerSerializers$IndexedListSerializer.serializeContents(ContainerSerializers.java:236)\n    at org.codehaus.jackson.map.ser.ContainerSerializers$IndexedListSerializer.serializeContents(ContainerSerializers.java:189)\n    at org.codehaus.jackson.map.ser.ContainerSerializers$AsArraySerializer.serialize(ContainerSerializers.java:111)\n    at org.codehaus.jackson.map.ser.StdSerializerProvider._serializeValue(StdSerializerProvider.java:296)\n    at org.codehaus.jackson.map.ser.StdSerializerProvider.serializeValue(StdSerializerProvider.java:224)\n    at org.codehaus.jackson.map.ObjectMapper.writeValue(ObjectMapper.java:925)\n    at org.springframework.http.converter.json.MappingJacksonHttpMessageConverter.writeInternal(MappingJacksonHttpMessageConverter.java:153)\n</code></pre>\n\n<p>Suggestions on how I can get more info to see what's causing this? Anyone know how to fix it?</p>\n\n<p><strong>EDIT:</strong> I discovered that getHander() and other get*() methods exist on the proxy object. GRR!! Is there any way I can tell Jackson to not process anything on the proxy, or am I sol? This is really weird because the method that spits out the JSON only crashes under certain circumstances, not all the time. Nonetheless, it's due to the get*() methods on the proxy object.</p>\n\n<p>Aside: Proxies are evil. They disrupt Jackson, equals() and many other parts of regular Java programming. I am tempted to ditch Hibernate altogether :/</p>\n"},{"tags":["spring","hibernate","postgresql","java-ee","spring-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13086240,"title":"Spring + Hibernate + Postgres query issue","body":"<p>I have written a sample code in Spring + Hibernate + Postgres to get the results from MySql and it is working fine. I changed the dialect and other parameters in Hibernate according to Postgres and when I execute the same program; \nI got the following error:</p>\n\n<pre>\nHibernate: select this_.ID as ID0_0_, this_.Address as Address0_0_, this_.Country as Country0_0_, this_.Email as Email0_0_, this_.FirstName as FirstName0_0_, this_.IsDelete as IsDelete0_0_, this_.LastName as LastName0_0_, this_.LastUpdated as LastUpda8_0_0_, this_.Password as Password0_0_, this_.Phone as Phone0_0_, this_.RoleID as RoleID0_0_, this_.State as State0_0_, this_.Status as Status0_0_, this_.UserName as UserName0_0_ from User this_\nWARN : [Oct-26 17:05:42,914] hibernate.util.JDBCExceptionReporter - SQL Error: 0, SQLState: 42703\nERROR: [Oct-26 17:05:42,914] hibernate.util.JDBCExceptionReporter - ERROR: column this_.id does not exist\n  Position: 8\nDEBUG: [Oct-26 17:05:42,914] mvc.annotation.AnnotationMethodHandlerExceptionResolver - Resolving exception from handler [com.medrubik.webservices.rest.LoginController@14f5021]: org.hibernate.exception.SQLGrammarException: could not execute query\nDEBUG: [Oct-26 17:05:42,930] mvc.annotation.ResponseStatusExceptionResolver - Resolving exception from handler [com.medrubik.webservices.rest.LoginController@14f5021]: org.hibernate.exception.SQLGrammarException: could not execute query\nDEBUG: [Oct-26 17:05:42,930] mvc.support.DefaultHandlerExceptionResolver - Resolving exception from handler [com.medrubik.webservices.rest.LoginController@14f5021]: org.hibernate.exception.SQLGrammarException: could not execute query\nDEBUG: [Oct-26 17:05:42,930] web.servlet.DispatcherServlet - Could not complete request\norg.hibernate.exception.SQLGrammarException: could not execute query\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.doList(Loader.java:2216)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\n    at org.hibernate.loader.Loader.list(Loader.java:2099)\n    at org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:94)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1569)\n    at org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:283)\n    at com.medrubik.services.UserService.getAllUsers(UserService.java:58)\n    at com.medrubik.services.UserService$$FastClassByCGLIB$$f4a499c6.invoke()\n    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)\n    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:692)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:108)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:625)\n    at com.medrubik.services.UserService$$EnhancerByCGLIB$$ff758697.getAllUsers()\n    at com.medrubik.webservices.rest.LoginController.getAllUsers(LoginController.java:81)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.doInvokeMethod(HandlerMethodInvoker.java:710)\n    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:167)\n    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:414)\n    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:402)\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:771)\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716)\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:647)\n    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:552)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: org.postgresql.util.PSQLException: ERROR: column this_.id does not exist\n  Position: 8\n    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2157)\n    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1886)\n    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:255)\n    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:555)\n    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:417)\n    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:302)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n    at org.hibernate.loader.Loader.doList(Loader.java:2213)\n    ... 44 more\n</pre>\n\n<p>Could anyone advice me on how to resolve this issue? Is there any issue while creating db or any ACL issues?</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13079683,"title":"Saying position beyond number of declared ordinal parameters","body":"<p>I want to perform a native/raw mysql query using hibernate, I have this:</p>\n\n<pre><code> sessionFactory.getCurrentSession().createSQLQuery(\"update table1 set someCounter = someCounter + 1 where id = ?\")\n                .setParameter(1, someId)\n                .executeUpdate();\n</code></pre>\n\n<p>I'm getting the error:</p>\n\n<pre><code>threw exception [Request processing failed; nested exception is org.hibernate.QueryParameterException: Position beyond number of declared ordinal parameters. Remember that ordinal parameters are 1-based! Position: 2] with root cause\norg.hibernate.QueryParameterException: Position beyond number of declared ordinal parameters. Remember that ordinal parameters are 1-based! Position: 2\n</code></pre>\n\n<p>What's wrong here?</p>\n"},{"tags":["java","hibernate"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3227,"score":5,"question_id":6887643,"title":"Hibernate Select Top and Bottom n Rows with Criteria","body":"<p>Let's say I have two tables, Books and Reviews. Reviews has a column, stars, that can have a value between 1 and 5. A Book can have many Reviews. </p>\n\n<p>How would I select all books such that only the top and bottom 3 reviews for each book are returned (instead of all reviews) using the Criteria API?</p>\n\n<p>If the Criteria API is not capable, I am up for other suggestions like HQL, SQL, etc.</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13086252,"title":"State machine.. with state stored in database","body":"<p>I have created a state machine before, where the state has been held in the context. however i need to create a state machine in Java/spring/hibernate which can have the state injected in from perhaps the database. So the state machine almost behaves like a static state machine.</p>\n\n<p>Not sure how this would work or even if it would .. any ideas?</p>\n"},{"tags":["java","hibernate","criteria-api","hibernate-criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13083861,"title":"Java Hibernate HQL to Hibernate Criteria","body":"<p>I have a class that uses Hibernate HQL queries. I would like to change these into Hibernate Criteria queries.\nHowever, Hibernate Criteria is a lot harder for me to understand than HQL, even with tutorials. Could someone show me how one of the queries would look like using Hibernate Criteria/Filters?</p>\n\n<pre><code>Configuration configuration = new Configuration();\n        configuration.configure().setProperty(\"hibernate.show_sql\", \"false\");\nServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(\n                                  configuration.getProperties()).buildServiceRegistry();\nSessionFactory sessionFactory = new Configuration().configure().buildSessionFactory(serviceRegistry);\n\nSession session =sessionFactory.openSession();\nTransaction tx = session.beginTransaction();\nQuery query = session.createQuery(\"from TABLENAME WHERE IDObject1= :idObjectA\" +\n              \"AND IDObject2= :idObjectB AND IDSettingOption = :idSettingOption\");\nquery.setParameter(\"idObjectA\", idObjectB);\nquery.setParameter(\"idObjectB\", idObjectB);\nquery.setParameter(\"idSettingOption\", idSettingOption);\n\nList results = query.list();\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["database","hibernate","database-design","relational-database","database-optimization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13084063,"title":"which is more efficient single table with large data columns or multiple tables? (hibernate - database)","body":"<p>My web application is implemented in Grails.</p>\n\n<p>My situation is that I have a domain class (hibernate class) with more columns and some of them are large Strings, up to 4000 characters. </p>\n\n<p>For example :</p>\n\n<pre><code>String description // max 4000\n// column2, column3, etc\n</code></pre>\n\n<p>Now I have to implement a multiple language database for this elements and my strategy is to have one field for every language.</p>\n\n<pre><code>String description_en_US\nString description_de_DE\n</code></pre>\n\n<p>My question is if it is more efficient if I have a separate table for every language, or to save it in one large table. \nThe question has two parts. First, which is more efficient for hibernate if it uses a large memory when loading the data and second, which is more efficient for the database?</p>\n\n<p>It can happen that later I'll have more than 10 languages.</p>\n"},{"tags":["spring","hibernate","jsf","jsf-2","migration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13073546,"title":"java.io.NotSerializableException with spring and @ViewScoped bean","body":"<p>I do migration form JSF 1.2 to JSF 2.1 in a quite large project. There is a few libraries use: hibernate 3.6, spring 3.1(far as i know updated form 2.x by my predecessor), acegi-security-1.0.5, tomahawk20, urlrewrite-3.2.0. I will update all of them, when i finish migration to jsf2.1</p>\n\n<p>I changed entries for beans in faces-config.xml to annotations, and change JSTL markup to JSF (c:if to rendered atribute or ui:fragment section) there is no JSTL now. Beans in this project had a lot of params. Ajax is used there, so I decided use @ViewScoped, but i have exception(pasted down). I don't know why with @SessionScoped exeption doesn't appear, and everything works correctly. I know SessionSoped life longer then View, but what is difference for this example?</p>\n\n<p>I read a few Q&amp;A hear and added Serializable interface to classes which i found in spring beans configuration files, but still doesn't work.</p>\n\n<p>i.e for this entry:</p>\n\n<pre><code>&lt;bean id=\"SomeDaoImpl\" class=\"my.package\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;\n        &lt;ref bean=\"sessionFactory\" /&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>I implemented Serializable in SomeDaoImpl class, but didn't help.</p>\n\n<p>I added this entry to my web.xml, but still doesn't work.</p>\n\n<pre><code>&lt;context-param&gt;\n    &lt;param-name&gt;javax.faces.PARTIAL_STATE_SAVING&lt;/param-name&gt;\n    &lt;param-value&gt;false&lt;/param-value&gt;\n&lt;/context-param&gt;\n</code></pre>\n\n<p>this class org.springframework.orm.hibernate3.HibernateInterceptor i found in xml file where are spring beans, </p>\n\n<p>EXCEPTION: </p>\n\n<pre><code>SEVERE: Error Rendering View[/folder1/folder2/index.xhtml]\njava.io.NotSerializableException: org.springframework.orm.hibernate3.HibernateInterceptor\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1164)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.writeArray(ObjectOutputStream.java:1346)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1154)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:330)\nat java.util.HashMap.writeObject(HashMap.java:1001)\nat sun.reflect.GeneratedMethodAccessor117.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:940)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1469)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1518)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1483)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.writeArray(ObjectOutputStream.java:1346)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1154)\nat java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:330)\nat java.util.HashMap.writeObject(HashMap.java:1001)\nat sun.reflect.GeneratedMethodAccessor117.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:940)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1469)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1400)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1158)\nat java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:330)\nat com.sun.faces.renderkit.ClientSideStateHelper.doWriteState(ClientSideStateHelper.java:346)\nat com.sun.faces.renderkit.ClientSideStateHelper.writeState(ClientSideStateHelper.java:182)\nat com.sun.faces.renderkit.ResponseStateManagerImpl.writeState(ResponseStateManagerImpl.java:122)\nat com.sun.faces.application.StateManagerImpl.writeState(StateManagerImpl.java:113)\nat com.sun.faces.application.view.WriteBehindStateWriter.flushToWriter(WriteBehindStateWriter.java:225)\nat com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:441)\nat com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:124)\nat javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:288)\nat javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:288)\nat org.apache.myfaces.tomahawk.application.ResourceViewHandlerWrapper.renderView(ResourceViewHandlerWrapper.java:93)\nat com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)\nat com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)\nat com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)\nat my.package.util.faces.LifecycleDecorator.render(LifecycleDecorator.java:90)\nat javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\nat my.package.util.ie9fix.ie9fixFilter.doFilter(ie9fixFilter.java:41)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\nat org.tuckey.web.filters.urlrewrite.RuleChain.handleRewrite(RuleChain.java:176)\nat org.tuckey.web.filters.urlrewrite.RuleChain.doRules(RuleChain.java:145)\nat org.tuckey.web.filters.urlrewrite.UrlRewriter.processRequest(UrlRewriter.java:92)\nat org.tuckey.web.filters.urlrewrite.UrlRewriteFilter.doFilter(UrlRewriteFilter.java:381)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\nat org.apache.myfaces.webapp.filter.ExtensionsFilter.doFilter(ExtensionsFilter.java:357)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\nat org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:265)\nat org.acegisecurity.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:107)\nat org.acegisecurity.intercept.web.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:72)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:166)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.providers.anonymous.AnonymousProcessingFilter.doFilter(AnonymousProcessingFilter.java:125)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.rememberme.RememberMeProcessingFilter.doFilter(RememberMeProcessingFilter.java:135)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.wrapper.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:81)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:271)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.ui.logout.LogoutFilter.doFilter(LogoutFilter.java:110)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:249)\nat org.acegisecurity.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:275)\nat org.acegisecurity.util.FilterChainProxy.doFilter(FilterChainProxy.java:149)\nat org.acegisecurity.util.FilterToBeanProxy.doFilter(FilterToBeanProxy.java:98)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\nat org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\nat org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)\nat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\nat java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>Any tips what should i check or read to understand what do i wrong?\nI working with JSF for few weeks, and I am still learning. I never used spring.</p>\n"},{"tags":["hibernate","design-patterns","java-ee","ejb-3.0"],"answer_count":6,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":1753,"score":9,"question_id":1086204,"title":"Is using data transfer objects in ejb3 considered best practice","body":"<p>Although obviously not all scenarios can be covered by a single design, is it generally felt now that ORM classes should be passed to and fro between the presentation and business layer (either local or remote), replacing the need for data transfer objects? As far as I can see, using ORM classes presents problems of unnecessary eager loading, context management issues and tight coupling, but also saves a great deal of time and keeps things simple. Is there now a standard approach that generally favours one over the other (for the majority of situations)?</p>\n"},{"tags":["hibernate","jpa-2.0","named-query"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13085440,"title":"jpa delete query error: unexpected token","body":"<p>I want to delete a list of items and I defined the following query for the Entity Email:</p>\n\n<p>@NamedQuery(name = Email.namedQueryDeleteOldEmails,\nquery = \"DELETE FROM Email e where e.creationDate &lt;= :creationDate\")</p>\n\n<p>When I execute it, I have the following error:\n2012-10-26 12:45:25,570 ERROR [SGVISTA] org.hibernate.hql.internal.ast.ErrorCounter - line 1:1: unexpected token: Email\nline 1:1: unexpected token: Email</p>\n\n<p>Does anybody know what is wrong with my query?\nThank you very much</p>\n"},{"tags":["java","hibernate","persistence"],"answer_count":5,"favorite_count":19,"up_vote_count":31,"down_vote_count":0,"view_count":17700,"score":31,"question_id":161224,"title":"What are the differences between the different saving methods in Hibernate?","body":"<p>Hibernate has a handful of methods that, one way or another, takes your object and puts it into the database. What are the differences between them, when to use which, and why isn't there just one intelligent method that knows when to use what?</p>\n\n<p>The methods that I have identified thus far are:</p>\n\n<ul>\n<li>save()</li>\n<li>update()</li>\n<li>saveOrUpdate()</li>\n<li>saveOrUpdateCopy()</li>\n<li>merge()</li>\n<li>persist()</li>\n</ul>\n"},{"tags":["hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":49,"score":-2,"question_id":13083905,"title":"How to connect two databases to hibernate eclipse web project?","body":"<p>MY project is java ee web application I used hibernate for database purposes. I connect one data base to this application now I need to connect another mysql database to this project how can I do this is it possible? can you give me proper link or solution thanx in advanced</p>\n\n<p>I used this 1st answer thanx lot for that but it gives this exception can you please help me to solve this \n{16:02:39,552  WARN SettingsFactory - Could not obtain connection metadata\njava.sql.SQLException: No suitable driver found for hsqldb:hsql://127.0.0.1:9001/openreports\n    at java.sql.DriverManager.getConnection(Unknown Source)\n    at java.sql.DriverManager.getConnection(Unknown Source)\n    at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)\n    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:72)\n    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:1881)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1174)\n    at org.efs.openreports.actions.admin.ServerDataAction.(ServerDataAction.java:23)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n    at java.lang.reflect.Constructor.newInstance(Unknown Source)\n    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:84)\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:71)\n    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:150)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:745)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowire(AbstractAutowireCapableBeanFactory.java:253)\n    at com.opensymphony.xwork2.spring.SpringObjectFactory.buildBean(SpringObjectFactory.java:145)\n    at com.opensymphony.xwork2.spring.SpringObjectFactory.buildBean(SpringObjectFactory.java:128)\n    at com.opensymphony.xwork2.ObjectFactory.buildBean(ObjectFactory.java:143)\n    at com.opensymphony.xwork2.ObjectFactory.buildAction(ObjectFactory.java:113)\n    at com.opensymphony.xwork2.DefaultActionInvocation.createAction(DefaultActionInvocation.java:275)\n    at com.opensymphony.xwork2.DefaultActionInvocation.init(DefaultActionInvocation.java:365)\n    at com.opensymphony.xwork2.DefaultActionInvocation.access$000(DefaultActionInvocation.java:38)\n    at com.opensymphony.xwork2.DefaultActionInvocation$1.doProfiling(DefaultActionInvocation.java:83)\n    at com.opensymphony.xwork2.util.profiling.UtilTimerStack.profile(UtilTimerStack.java:455)\n    at com.opensymphony.xwork2.DefaultActionInvocation.(DefaultActionInvocation.java:74)\n    at com.opensymphony.xwork2.DefaultActionProxy.prepare(DefaultActionProxy.java:189)\n    at org.apache.struts2.impl.StrutsActionProxyFactory.createActionProxy(StrutsActionProxyFactory.java:41)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:494)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:419)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)\n    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n    at java.lang.Thread.run(Unknown Source)\n16:02:39,610  WARN SessionFactoryObjectFactory - InitialContext did not implement EventContext                                                                                  this is my error msg what is reson for this can you please help me..........}</p>\n"},{"tags":["hibernate","postgresql","tomcat","annotations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13085255,"title":"How to enable Hibernate to drop-create with annotations (Tomcat & PgSQL)?","body":"<p>So far I used Hibernate with XML mapping files to update/drop-create my DB from entity classes (on Tomcat 7.0.29 and PgSQL 9.1.6, with Hibernate 4.1.7).</p>\n\n<p>XML mapping files worked fine, but I would like to do this with annotations. Sadly, I couldn't get it to work. Here is what I tried to do:</p>\n\n<ul>\n<li>removed the <code>hibernate.hbm.xml</code> file from the project (also removed the reference to it from <code>hibernate.cfg.xml</code>)</li>\n<li><p>added some more annotations to my entity class:</p>\n\n<pre><code>import java.io.Serializable;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name = \"useriffic\")\npublic class User implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"id\", nullable = false, unique = true)\n    private Integer id;\n\n    @Column(nullable = false, unique = true, length = 200, name = \"email\")\n    private String email;\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n}\n</code></pre></li>\n<li><p>Put this into my <code>hibernate.cfg.xml</code> file:</p>\n\n<pre><code>&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;org.postgresql.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:postgresql://localhost/mydb&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;myuid&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;mypwd&lt;/property&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"format_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hbm2ddl.auto\"&gt;create-drop&lt;/property&gt;\n        &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n        &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre></li>\n<li>I use Maven, but the <code>pom.xml</code> file is a bit too big to put here. So, a short summary of it:\n<ul>\n<li><strong>Dependencies</strong>: org.hibernate (ejb3-persistence 1.0.2.GA; hibernate-entitymanager 4.1.7.Final; hibernate-core 4.1.7.Final), javax.sql jdbc-stdext 2.0, javax.transaction jta 1.1, postgresql 9.1-901-1.jdbc4, javax javaee-web-api 6.0</li>\n<li><strong>Plugins</strong>: org.apache.maven.plugins (maven-compiler-plugin 2.5.1; maven-war-plugin 2.3; maven-dependency-plugin 2.5.1)</li>\n</ul></li>\n<li>I build with <code>mvn clean install package</code>.</li>\n</ul>\n\n<p>I run the web page by building the session factory (the way it is described in <a href=\"http://stackoverflow.com/questions/8621906/is-buildsessionfactory-deprecated-in-hibernate-4\">this question</a>) but the DB does not get drop-created (previously, with XML mapping files it worked).</p>\n\n<p>So, in short, how do I enable DB drop/create through Hibernate annotations.</p>\n\n<p>Thanks a lot for your help!</p>\n"},{"tags":["java","hibernate","validation","bean-validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13048993,"title":"javax.validation ORDER of failures-entries as result of validate method","body":"<p>I'm using <code>javax.validation</code> for <code>JSR-303</code> bean validation.</p>\n\n<p>After calling the validate method, I go through the result and do someting in my GUI(for example highlighting the failed fields in my form).</p>\n\n<p>My question here:</p>\n\n<p><strong>MyBean.java</strong></p>\n\n<pre><code>public class MyBean {\n\n    @Size(min = 1, message = \"Please insert title\")\n    private String title;\n\n    @Size(min = 1, message = \"Please insert author\")\n    private String author;\n\n    @Size(min = 1, message = \"Please insert publisher\")\n    private String publisher;\n\n    // ... something\n}\n</code></pre>\n\n<p><strong>My Validation method:</strong></p>\n\n<pre><code>Set&lt;ConstraintViolation&lt;MyBean&gt;&gt; failures = this.validator.validate(bean);\n</code></pre>\n\n<p>After that, I iterate over my failures object:</p>\n\n<pre><code>for (ConstraintViolation&lt;MyBean&gt; constraintViolation : failures) {\n        propertyPath = constraintViolation.getPropertyPath().toString();\n        if (propertyPath.equals(\"title\")) {\n            Color bg = new Color(242, 242, 251);\n            this.txtTitle.setBackground(bg);\n\n        }\n        // some else if for other attributes (for example: author)\n        // add error to all error messages\n        errorMessage += constraintViolation.getMessage();\n}\n</code></pre>\n\n<p>Now my problem is: The <strong>order</strong> of these objects in the failures set. It is not correct.\nIs there a solution to get the correct order?</p>\n\n<p>Thanks to all</p>\n"},{"tags":["mysql","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13083279,"title":"Connecting two tables with a middle table using Hibernate and annotations","body":"<h2>Got 3 tables I need to connect.</h2>\n\n<p>Got my first project where I am making the database myself, while learning a new framework, which can be kinda confusing as I am not that well off when it come down to DBs.</p>\n\n<p>I am using Spring 3.1.0.RELEASE and Hibernate 3.6.8.Final</p>\n\n<p>I will name the most important attributes here, to give the general idea of what it is I am trying to achieve here.</p>\n\n<blockquote>\n  <p><strong>Inventory</strong> (id, ItemName...)</p>\n  \n  <p><strong>Line_Items</strong> (WORKSHOP_ORDERS_Id, INVENTORY_Id, Quantity)</p>\n  \n  <p><strong>Workshop_Order</strong> (Id, WorkshopService, WorkshopNotes...)</p>\n</blockquote>\n\n<p>This way I can hopefully have more than one item for each order, planning to hold one Line_Items for each different product in every order, linking it to the correct order by FKs.</p>\n\n<p>I have tried different things with my annotations, my persistence.xml works, this is the only place in my code where there are any issues. I am 100% clueless on how to map this relation with annotations, so I am going to post my code here, even though it is no where near anything useful (but I may get some pointers).</p>\n\n<pre><code>import java.io.Serializable;\n\nimport javax.persistence.*;\n\n@Entity\n@Table(name = \"LINE_ITEMS\")\npublic class LineItems implements Serializable {\n\nprivate static final long serialVersionUID = 2414994088922470197L;\n\npublic Long workshopOrderId;\npublic Long inventoryId;\npublic int quantity;\n\npublic Workshop workshop;\npublic Inventory inventory;\n\n@OneToMany(mappedBy = \"workshop\",cascade = CascadeType.ALL)\n@JoinColumn(name=\"WORKSHOP_ORDERS_Id\", insertable = false, updatable = false, nullable = false)\npublic Workshop getWorkshop() {\n    return workshop;\n}\n\n@OneToMany(mappedBy = \"inventory\", cascade = CascadeType.ALL)\n@JoinColumn(name=\"INVENTORY_Id\", insertable = false, updatable = false, nullable = false)\npublic Inventory getInventory() {\n    return inventory;\n}\n\npublic void setWorkshop(Workshop workshop) {\n    this.workshop = workshop;\n}\n\npublic void setInventory(Inventory inventory) {\n    this.inventory = inventory;\n}\n\n@Id\n@Column(name = \"WORKSHOP_ORDERS_Id\")\npublic Long getWorkshopOrderId() {\n    return workshopOrderId;\n}\n\n@Id\n@Column(name = \"INVENTORY_Id\")\npublic Long getInventoryId() {\n    return inventoryId;\n}\n\n@Column(name = \"Quantity\")\npublic int getQuantity() {\n    return quantity;\n}   \n\npublic void setWorkshopOrderId(Long workshopOrderId) {\n    this.workshopOrderId = workshopOrderId;\n}\n\npublic void setInventoryId(Long inventoryId) {\n    this.inventoryId = inventoryId;\n}\n\npublic void setQuantity(int quantity) {\n    this.quantity = quantity;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>I have heard some talk about a bug in Hibernate, but not sure if this relates to my issue.</p>\n\n<p>Basically what I need is not necessary the complete solution to the problem, but some idea of what I am doing and what I should do to correct it. I would love some assistance in both smart database design (regarding the tables I have shown, and the correct way to do it in Hibernate).</p>\n\n<p>Any advice or help will be appreciated.</p>\n"},{"tags":["sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13082744,"title":"How to Search substring in Multiple columns using Hibernate","body":"<p>following is my code to call the database to find the substring \"ello\".</p>\n\n<pre><code>String queryString = \"from ContentItem where singerName = '%\"+searchString+\"%' OR  songName = '%\"+searchString+\"%'\";\nSystem.out.println(queryString);\nQuery query = session.createQuery(queryString);\nreturn query.list();  \n</code></pre>\n\n<p>the string output is </p>\n\n<pre><code>from ContentItem where singerName = '%ello%' OR songName = '%ello%'\n</code></pre>\n\n<p>it says Unexpected Token for %. How to make this possible to search substring inside those columns? </p>\n\n<p>I'm working Hibernate inside Tapestry. </p>\n"},{"tags":["performance","hibernate","oracle11g"],"answer_count":0,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":34,"score":4,"question_id":13074500,"title":"Hibernate Query Running Slow","body":"<p>I am currently facing a problem with a slow running Hibernate query that is being kicked off from a Java program. It is making a call to Oracle 11g at the back end.</p>\n\n<p>This query is taking anything from 40-90 seconds the first time it is run. On subsequent executions however the query is returned in a fraction of the time (and I don't even see the database being hit, so assume that hibernate is caching it).</p>\n\n<p>If I copy and paste the query from Enterprise Manager into a SQL client and run the very same query directly (even changing a few parameters) the query returns in a fraction of a second.</p>\n\n<p>If I look at the performance tuning tab in EM I see that the time taken is primarily taken up with User I/O Waits (97.5%), and CPU (2.5%). Could this mean that the fetch size I am using in hibernate is configured at too small a value?</p>\n\n<p>If there is any other information you might need to help me get to the bottom of this issue then please let me know.</p>\n\n<p>=====</p>\n\n<h2>Additional information:</h2>\n\n<p>We do have an index on the table and I can see that it is being used as part of the execution of the query, unfortunately it isn't very readable but I am not sure how else to include it:</p>\n\n<p>Id  Operation   Name    Rows\n(Estim)     Cost    Time\nActive(s)   Start\nActive  Execs   Rows\n(Actual)    Read\nReqs    Read\nBytes   Mem\n(Max)   Activity\n(%)     Activity Detail\n(# samples)\n0   SELECT STATEMENT                        1<br>\n1   . FILTER                        1<br>\n2   .. HASH JOIN RIGHT OUTER        2674    7223    1   +4  1   0           1M<br>\n3   ... TABLE ACCESS FULL   TOTEM_EQ_EXPIRYCODES    475     4   1   +4  1   481<br>\n4   ... HASH JOIN RIGHT OUTER       2674    7219    1   +4  1   0           399K<br>\n5   .... TABLE ACCESS BY INDEX ROWID    TOTEM_EQ_UNDERLYINGS    1   2   1   +4  1   1<br>\n6   ..... INDEX UNIQUE SCAN     TOTEM_EQ_UND_PK     1   1   1   +4  1   1<br>\n7   .... NESTED LOOPS                       1<br>\n8   ..... NESTED LOOPS      2674    7216    42  +4  1   0<br>\n9   ...... TABLE ACCESS BY GLOBAL INDEX ROWID   EQUITIES_MONTHLY_INSTRUMENTS    2671    1871    45  +1  1   8438    3517    27MB        24.44   db file sequential read (11)\n10  ....... INDEX RANGE SCAN    EQ_MON_INS_UNDERLYING_INDX  2671    12  42  +4  1   8438    27  216KB<br>\n11  ...... PARTITION RANGE ITERATOR         1   2           8438<br>\n12  ....... INDEX RANGE SCAN    EQ_MON_RESULT_INSPT_UNQ     1   2   44  +2  8438    0   5403    42MB        75.56   Cpu (1)\ndb file sequential read (33)\n13  ..... TABLE ACCESS BY LOCAL INDEX ROWID     EQUITIES_MONTHLY_RESULTS    1   3                   </p>\n\n<p>Here are the Global stats:</p>\n\n<p>Elapsed\nTime(s)     Cpu\nTime(s)     IO\nWaits(s)    Fetch\nCalls   Buffer\nGets    Read\nReqs    Read\nBytes\n45  0.73    45  1   22980   9740    76MB            </p>\n"},{"tags":["sql","oracle","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13083487,"title":"select null fields in hibernate","body":"<p>I had made select query in hibernate from employees table that had following columns:</p>\n\n<pre><code>private int id;\n    private String firstname;\n    private String lastname;\n    private String email;\n    private String phoneno;\n    private Date hiredate;\n    private Jobs jobid;\n    private Integer salary;\n    private Integer commpct;\n    private Employee managerid;\n    private Departments deptid;\n</code></pre>\n\n<p>On this table, \nfirst record had managerid set to null, and afterwards every record managerid set to first record employeeid;</p>\n\n<p>when i select data from employees table using query: (\"FROM EMPLOYEES\") using following code:</p>\n\n<pre><code>Query query = session.createQuery(\"FROM Employee\");\n\n        List&lt;Employee&gt; employees = query.list();\n\n        for(Employee employee:employees){\n            System.out.println(\"ID=&gt;\"+employee.getId()+\"\\tFirstName=&gt;\"+employee.getFirstname()+\"\\tLastName=&gt;\"+employee.getLastname()\n                    +\"\\temail=&gt;\"+employee.getEmail()+\"\\tPhoneNO=&gt;\"+employee.getPhoneno()+\"\\tHireDate=&gt;\"+employee.getHiredate()\n                    +\"\\tJob=&gt;\"+employee.getJobid().getJobtitle()+\"\\tMax Salary=&gt;\"+employee.getJobid().getMaxsalary()\n                    +\"\\tPresent Salary=&gt;\"+employee.getSalary()+\"\\tCommission %=&gt;\"+employee.getCommpct()+\"\\tManager=&gt;\"+employee.getManagerid().getFirstname()+\",\"+employee.getManagerid().getLastname()\n                    +\"\\tDepartment ID=&gt;\"+employee.getDeptid().getName());\n\n        }\n</code></pre>\n\n<p>Exception throws bcoz first record managerid is null,</p>\n\n<p>Then, i used this query </p>\n\n<pre><code>Query query = session.createQuery(\"FROM Employee em WHERE em.managerid IS NOT NULL AND em.deptid IS NOT NULL\");\n</code></pre>\n\n<p>I get the record other than first record.</p>\n\n<p><strong>ID is the primarykey and managerid is the foreign key pointing to Employees Table (id) field.\nAll rows have id present but some rows/one row had managerid set to null.</strong></p>\n\n<p>My Question is how to get all the records even if first record managerid is set to null?</p>\n\n<p>What setting i had to made?</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":41,"score":-1,"question_id":13068663,"title":"how to serialize and deserialize hibernate object?","body":"<p>i want to serailize &amp; deserialized hibernate object.\nCan anybody tell me how can i achieve this?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","hibernate","jpa","jboss","resteasy"],"answer_count":2,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":15968,"score":5,"question_id":4708035,"title":"PersistenceContext EntityManager injection NullPointerException","body":"<p>I have a war containing the following:</p>\n\n<pre><code>META-INF/MANIFEST.MF\nWEB-INF/classes/META-INF/persistence.xml\nWEB-INF/classes/com/test/service/TestServlet.class\nWEB-INF/classes/com/test/service/TestEntity.class\nWEB-INF/classes/jndi.properties\nWEB-INF/classes/postgresql-ds.xml\nWEB-INF/jboss-web.xml\nWEB-INF/web.xml\nindex.jsp</code></pre>\n\n<p>persistence.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\" version=\"1.0\"&gt;\n    &lt;persistence-unit name=\"test\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;jta-data-source&gt;java:/TestDS&lt;/jta-data-source&gt;\n\n        &lt;properties&gt;\n            &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.PostgreSQLDialect\"/&gt;\n            &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"update\" /&gt;\n            &lt;property name=\"hibernate.show_sql\" value=\"true\" /&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>web.xml:</p>\n\n<pre><code>&lt;!DOCTYPE web-app PUBLIC\n \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\"\n \"http://java.sun.com/dtd/web-app_2_3.dtd\" &gt;\n\n&lt;web-app&gt;\n  &lt;display-name&gt;Test Web Application&lt;/display-name&gt;\n\n    &lt;context-param&gt;\n        &lt;param-name&gt;resteasy.scan&lt;/param-name&gt;\n        &lt;param-value&gt;true&lt;/param-value&gt;\n    &lt;/context-param&gt;\n    &lt;listener&gt;\n        &lt;listener-class&gt;org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap&lt;/listener-class&gt;\n    &lt;/listener&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;Resteasy&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/service/*&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n\n    &lt;resource-ref&gt;\n        &lt;res-ref-name&gt;TestDS&lt;/res-ref-name&gt;\n        &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;\n        &lt;res-auth&gt;Container&lt;/res-auth&gt;\n        &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;\n    &lt;/resource-ref&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>My TestServlet class is as follows:</p>\n\n<pre><code>package com.test.service;\n\nimport java.util.*;\nimport javax.persistence.*;\nimport javax.ws.rs.*;\n\n@Path(\"/service\")\npublic class TestService {\n\n    @PersistenceContext(unitName = \"test\")\n    private EntityManager em;\n\n    @GET\n    @Path(\"/get\")\n    @Produces(\"application/json\")\n    public List get() {\n        return em.createQuery(\"from TestEntity\").getResultList();\n    }\n}</code></pre>\n\n<p>When the get() method is invoked I get a NullPointerException; the EntityManager hasn't been injected. Any suggestions on what I might be missing or how I can diagnose it? There's very little in the server log.</p>\n\n<p>I'm sure I had this working without the jboss-web.xml or the datasource entry in web.xml. I've deployed the ds.xml to the deploy directory separately too and that's definitely picked up - I can see it in the JMX console.</p>\n\n<p>Tried using JBoss 4.2.3 and a 6.0 build with the same result.</p>\n"},{"tags":["mysql","hibernate","grails","jdbc","apache-commons-dbcp"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13069668,"title":"Grails app seems like it's holding a reference to a stale DB connection","body":"<p><strong>Update: Rackspace have got back to me and told me that their MySQL cloud uses a <code>wait_timeout</code> value of 120 seconds</strong></p>\n\n<p>I've been banging my head against this so I thought I'd ask you guys. Any ideas you might have would be appreciated</p>\n\n<pre><code>util.JDBCExceptionReporter  - SQL Error: 0, SQLState: 08S01\nutil.JDBCExceptionReporter  - Communications link failure\nThe last packet successfully received from the server was 264,736 milliseconds \nago. The last packet sent successfully to the server was 32 milliseconds ago.\n</code></pre>\n\n<p>The error occurs intermittently, often just minutes after the server in question comes up. The DB is nowhere near capacity in terms of load or connections, and I've tried dozens of different configuration combinations.</p>\n\n<p>The fact that this connection last received a packet from the server 264 seconds ago is revealing because it's well above the 120 second timeout put in place by Rackspace. I've also confirmed from the DB end that my 30 second limit is being respected.</p>\n\n<h3>Things I've tried</h3>\n\n<ul>\n<li>Setting DBCP to expire connections aggressively after 30 seconds, and verified that the MySQL instance reflects this behaviour via <code>SELECT * FROM PROCESSLIST</code></li>\n<li>Switched connection string from hostname to IP address, so this isn't a DNS issue</li>\n<li>Various different combinations of connection settings</li>\n<li>Tried declaring the connection pool settings in DataSources.groovy or resources.groovy, but I'm fairly sure that the settings are being respected as the DB reflects them: anything over 30 seconds is quickly killed </li>\n</ul>\n\n<h3>Any ideas?</h3>\n\n<p>Right now my best guess is that something in Grails is holding onto a reference to a stale connection for long enough that the 120 second limit is problematic... but it's a desperate theory and realistically I doubt it's true, but that leaves me short of ideas.</p>\n\n<p>The latest config I've tried:</p>\n\n<pre><code>dataSource {\n    pooled = true\n    driverClassName = \"com.mysql.jdbc.Driver\"\n    dialect = 'org.hibernate.dialect.MySQL5InnoDBDialect'\n    properties {\n        maxActive = 50\n        maxIdle = 20\n        minIdle = 5 \n        maxWait = 10000\n        initialSize = 5\n        minEvictableIdleTimeMillis = 1000 * 30\n        timeBetweenEvictionRunsMillis = 1000 * 5\n        numTestsPerEvictionRun = 50\n        testOnBorrow = true\n        testWhileIdle = true\n        testOnReturn = true\n        validationQuery = \"SELECT 1\"\n    }\n}\n</code></pre>\n\n<p>Stack trace:</p>\n\n<pre><code>2012-10-25 12:36:12,375 [http-bio-8080-exec-2] WARN  util.JDBCExceptionReporter  - SQL Error: 0, SQLState: 08S01\n2012-10-25 12:36:12,375 [http-bio-8080-exec-2] ERROR util.JDBCExceptionReporter  - Communications link failure\n\nThe last packet successfully received from the server was 264,736 milliseconds ago.  The last packet sent successfully to the server was 32 milliseconds ago.\n2012-10-25 12:36:12,433 [http-bio-8080-exec-2] ERROR errors.GrailsExceptionResolver  - EOFException occurred when processing request: [GET] /cart\nCan not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.. Stacktrace follows:\norg.hibernate.exception.JDBCConnectionException: could not execute query\nat grails.orm.HibernateCriteriaBuilder.invokeMethod(HibernateCriteriaBuilder.java:1531)\nat SsoRealm.hasRole(SsoRealm.groovy:30)\nat org.apache.shiro.grails.RealmWrapper.hasRole(RealmWrapper.groovy:193)\nat org.apache.shiro.authz.ModularRealmAuthorizer.hasRole(ModularRealmAuthorizer.java:374)\nat org.apache.shiro.mgt.AuthorizingSecurityManager.hasRole(AuthorizingSecurityManager.java:153)\nat org.apache.shiro.subject.support.DelegatingSubject.hasRole(DelegatingSubject.java:225)\nat ShiroSecurityFilters$_closure1_closure4_closure6.doCall(ShiroSecurityFilters.groovy:98)\nat grails.plugin.cache.web.filter.PageFragmentCachingFilter.doFilter(PageFragmentCachingFilter.java:195)\nat grails.plugin.cache.web.filter.AbstractFilter.doFilter(AbstractFilter.java:63)\nat org.apache.shiro.grails.SavedRequestFilter.doFilter(SavedRequestFilter.java:55)\nat org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)\nat org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)\nat org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)\nat org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)\nat org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:380)\nat org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)\nat org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\nat java.lang.Thread.run(Thread.java:662)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure\n\nThe last packet successfully received from the server was 264,736 milliseconds ago.  The last packet sent successfully to the server was 32 milliseconds ago.\nat com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\nat com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)\nat com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3589)\nat com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3478)\nat com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4019)\nat com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2490)\nat com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2651)\nat com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2683)\nat com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2144)\nat com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2310)\nat org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)\nat org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)\n... 20 more\nCaused by: java.io.EOFException: Can not read response from server. Expected to read 4 bytes, read 0 bytes before connection was unexpectedly lost.\nat com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:3039)\nat com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3489)\n... 29 more\n</code></pre>\n"},{"tags":["performance","oracle","hibernate","index","order"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":450,"score":2,"question_id":8729760,"title":"Query from Hibernate App does not use DB indexes","body":"<p>I try to solve a performance issue of my application. The query hibernate generates, is of the form:</p>\n\n<pre><code>select * \nfrom ( \n    select this.a, this.b, this.state, this.id \n    from view_user this \n    where this.state=:1 order by this.a asc, this.b\n) \nwhere rownum &lt;= :2\n</code></pre>\n\n<p>where</p>\n\n<ul>\n<li>id is the primary key</li>\n<li>there is a combined, unique index on (a, b, id).</li>\n<li>view_user has ~ 2 million entries</li>\n<li>view_user performs some further joins to other tables</li>\n</ul>\n\n<p><strong>Issue</strong></p>\n\n<p>The above query performs\n - fast from SQLDeveloper\n - fast from a small Java app with hibernate\n - extremely slow (>100x slower) from the application with hibernate\n - values for the bind variables are 2 respectively 30 (rownum origins from paging)\n - the hibernate query is \"of the form\" above. There are actually about 20 columns in the view.</p>\n\n<p><strong>Current state of analysis</strong></p>\n\n<ul>\n<li>query plan shows that index is used when query comes from SQlDeveloper or \"small java app\".</li>\n<li>query plan shows that full table scans are performed if query comes from hibernate app</li>\n<li>DB tracing shows only two differences: NLS settings (from SQLDeveloper) and slightly different formatting (whitespaces). Everything else seems to be the same...</li>\n</ul>\n\n<p><strong>Versions</strong></p>\n\n<ul>\n<li>hibernate: 2.1.8</li>\n<li>jdbc driver: used ojdbc14, 5 and 6. Makes no difference</li>\n<li>Oracle: 10.2 and 11. Makes no difference</li>\n</ul>\n\n<p>=> I'm glad about every hint somebody might have concerning this issue. What troubles me is the fact that the DB tracing did not show any differences... Yes, it looks like it is something about hibernate. But what? How to detect?</p>\n\n<hr>\n\n<p>For the sake of completeness, here the hibernate query (from the log):</p>\n\n<pre><code>Select * from ( \n    select this.USER_ID as USER_ID0_, this.CLIENT_ID as CLIENT_ID0_, \n    this.USER_NAME as USER_NAME0_, this.USER_FIRST_NAME as USER_FIR5_0_, this.USER_REMARKS as \n    USER_REM6_0_, this.USER_LOGIN_ID as USER_LOG7_0_, this.USER_TITLE as USER_TITLE0_, \n    this.user_language_code as user_lan9_0_, this.USER_SEX as USER_SEX0_, \n    this.USER_BIRTH_DATE as USER_BI11_0_, this.USER_TELEPHONE as USER_TE12_0_, \n    this.USER_TELEFAX as USER_TE13_0_, this.USER_MOBILE as USER_MO14_0_, \n    this.USER_EMAIL as USER_EMAIL0_, this.USER_ADDRESSLINE1 as USER_AD16_0_, \n    this.USER_ADDRESSLINE2 as USER_AD17_0_, this.USER_POSTALCODE as USER_PO18_0_, \n    this.USER_CITY as USER_CITY0_, this.USER_COUNTRY_CD as USER_CO20_0_, \n    this.USER_COUNTRY_NAME as USER_CO21_0_, this.USER_STATE_ID as USER_ST24_0_, \n    this.USER_STATE as USER_STATE0_, this.USER_TEMP_COLL_ID as USER_TE26_0_, \n    this.USER_TEMP_COLL_NAME as USER_TE27_0_, this.UNIT_ID as UNIT_ID0_, \n    this.CLIENT_NAME as CLIENT_38_0_, this.PROFILE_EXTID as PROFILE39_0_\n    from VIEW_USER this\n    where this.USER_STATE_ID=:1 order by this.USER_NAME asc, this.USER_FIRST_NAME asc\n) \nwhere rownum &lt;= :2\n</code></pre>\n\n<p>Unique index is over user_name, user_first_name, user_id.</p>\n"},{"tags":["hibernate","spring"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":122,"score":0,"question_id":2231256,"title":"How do I prevent Spring/Hibernate from automatically committing my modifications to the database?","body":"<p>I am working with Spring and Hibernate. I have an object which was retrieved from the database with HibernateTemplate. </p>\n\n<p>When I modify this object Hibernate is making inserts into the database before the data is ready to be inserted, the result is a lot of database errors along the line of \"cannot insert NULL into ...\". </p>\n\n<p>Is there a way to tell Spring/Hibernate \"don't update the database with this until I call HibernateTemplate.persist()\"? I looked in the HibernateTemplate javadoc but couldn't find anything</p>\n"},{"tags":["java","sql","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13074162,"title":"Hibernate logs: what does mean term \"load\" in logs","body":"<p>Short and simple question (sorry if this question has already been answered somewhere):\nBut after turning on <code>hibernate.use_sql_comments=true</code> in logs, between my normal select queries, I can see many entries like: </p>\n\n<pre>\n  Hibernate: SELECT doc FROM Document doc WHERE doc.entity = ?1\")\n  Hibernate: /* load com.my.Entity */  SELECT entity from ... where entity0_.id=?\n</pre>\n\n<p>My question is simple: does <strong>load</strong> mean separate <code>select</code> query to the database or just hit the hibernate cache?  <br/>\nIf former is true, then why there's so many such unnecessary queries?</p>\n\n<p>I'm asking because all my custom HQL queries, that take some entities as parameters, causes such entry in hibernate logs.</p>\n\n<p><strong>UPDATED</strong>  <br>\nI finally have found that launching any HQL query with some entity in WHERE clause is going to always load that entity. And thus second query is being launched.</p>\n"},{"tags":["hibernate","jpa","mapping","one-to-one","bidirectional"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2217,"score":1,"question_id":5837891,"title":"Hibernate: AnnotationException: Unknown mappedBy in ... referenced property unknown on reverse (mappedBy), bi-directional @OneToOne associations","body":"<p>I have the following simple design:</p>\n\n<p><img src=\"http://www.kawoolutions.com/media/persons-roles-reduced.png\" alt=\"Valid XHTML\"></p>\n\n<p>That's basically a workaround for non-disjoint inheritance which JPA doesn't support. Persons can exist by their own, but there can optionally be a single player entity, a single coach entity, or both entities to complete the logic.</p>\n\n<p>Here are the rather easy-to-understand <strong>JPA 2.0</strong> mappings (note the @Id forward associations):</p>\n\n<pre><code>@Entity\n@Table(name = \"Persons\")\npublic class Person implements Serializable\n{\n    @Id\n    @Column(name = \"id\")\n    private Integer id;\n\n    @Column(name = \"first_name\")\n    private String firstName;\n\n    @Column(name = \"last_name\")\n    private String lastName;\n\n    @OneToOne(mappedBy = \"person\")\n    private Coach coach = null;\n\n    @OneToOne(mappedBy = \"person\")\n    private Player player = null;\n\n    ...\n}\n\n@Entity\n@Table(name = \"Players\")\npublic class Player implements Serializable\n{\n    @Column(name = \"registration_nbr\")\n    private String registrationNbr = null;\n\n    @Id\n    @OneToOne\n    @JoinColumn(name = \"id\")\n    private Person person = null;\n\n    ...\n}\n\n@Entity\n@Table(name = \"Coaches\")\npublic class Coach implements Serializable\n{\n    @Column(name = \"license_nbr\")\n    private String licenseNbr = null;\n\n    @Id\n    @OneToOne\n    @JoinColumn(name = \"id\")\n    private Person person = null;\n\n    ...\n}\n</code></pre>\n\n<p>The Player and Coach entity classes are almost identical.</p>\n\n<p>The problem here are the two bi-directional associations (mappedBy). These mappings work perfectly with EclipseLink, but Hibernate somehow freaks out with an AnnotationException:</p>\n\n<pre><code>Exception in thread \"main\" javax.persistence.PersistenceException: [PersistenceUnit: persons] Unable to configure EntityManagerFactory\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:374)\n    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:56)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:48)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:32)\n    at tld.persons.Main.main(Main.java:32)\nCaused by: org.hibernate.AnnotationException: Unknown mappedBy in: tld.persons.model.Person.coach, referenced property unknown: tld.persons.model.Coach.person\n    at org.hibernate.cfg.OneToOneSecondPass.doSecondPass(OneToOneSecondPass.java:159)\n    at org.hibernate.cfg.Configuration.originalSecondPassCompile(Configuration.java:1686)\n    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1393)\n    at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1345)\n    at org.hibernate.ejb.Ejb3Configuration.buildMappings(Ejb3Configuration.java:1477)\n    at org.hibernate.ejb.EventListenerConfigurator.configure(EventListenerConfigurator.java:193)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:1096)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:278)\n    at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:362)\n    ... 4 more\n</code></pre>\n\n<p>When switching to old-school JPA 1.0 mappings all runs fine again. Hibernate somehow seems to have problems with the above mappings.</p>\n\n<p>I've looked at soo many other problem reports, in fact the forum at hibernate.org is filled with similar unsolved problems, but I couldn't find any clues as to why this throws an exception.</p>\n\n<p>To me it appears to be a Hibernate bug. Can anybody confirm this? (Note I'm using Hibernate 3.6)</p>\n"},{"tags":["hibernate","exception","jboss7.x","h2db"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13081608,"title":"Hibernate throws org.hibernate.persister.entity.SingleTableEntityPersister","body":"<p>I am using JBoss AS 7 with H2 database.\nI have a standalone application that tries to connect to this database like this.</p>\n\n<p>My config file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n                                         \"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n &lt;session-factory name=\"Test\"&gt;\n  &lt;property name=\"hibernate.connection.driver_class\"&gt;org.h2.Driver&lt;/property&gt;\n  &lt;property name=\"hibernate.connection.url\"&gt;jdbc:h2:mem:test&lt;/property&gt;\n  &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.H2Dialect&lt;/property&gt;\n  &lt;mapping class=\"Kunde\" resource=\"Kunde.hbm.xml\"/&gt;\n  &lt;mapping class=\"Mitarbeiter\" resource=\"Mitarbeiter.hbm.xml\"/&gt;\n &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>My mapping files are:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Oct 26, 2012 7:34:15 AM by Hibernate Tools 3.4.0.CR1 --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"Kunde\" table=\"KUNDE\"&gt;\n        &lt;id name=\"id\" type=\"long\"&gt;\n            &lt;column name=\"ID\" /&gt;\n            &lt;generator class=\"assigned\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"vorname\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"VORNAME\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"nachname\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"NACHNAME\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"firma\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"FIRMA\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n\n&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Oct 26, 2012 7:34:15 AM by Hibernate Tools 3.4.0.CR1 --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"Mitarbeiter\" table=\"MITARBEITER\"&gt;\n        &lt;id name=\"id\" type=\"long\"&gt;\n            &lt;column name=\"ID\" /&gt;\n            &lt;generator class=\"assigned\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"vorname\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"VORNAME\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"nachname\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"NACHNAME\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>My entity classes:</p>\n\n<pre><code>public class Kunde {\n    long id;\n    String vorname;\n    String nachname;\n    String firma;\n\n    public long getId() {\n        return id;\n    }\n\n    public void setId(long id) {\n        this.id = id;\n    }\n\n    public String getVorname() {\n        return vorname;\n    }\n\n    public void setVorname(String vorname) {\n        this.vorname = vorname;\n    }\n\n    public String getNachname() {\n        return nachname;\n    }\n\n    public void setNachname(String nachname) {\n        this.nachname = nachname;\n    }\n\n    public String getFirma() {\n        return firma;\n    }\n\n    public void setFirma(String firma) {\n        this.firma = firma;\n    }\n}\n</code></pre>\n\n<p>(The other one looks similar).</p>\n\n<p>My test code:</p>\n\n<pre><code>public static void main(String[] args) {\n    try {\n        // This step will read hibernate.cfg.xml and prepare hibernate for\n        // use\n        Configuration configuration = new Configuration();\n        configuration.configure();\n        ServiceRegistry serviceRegistry = new ServiceRegistryBuilder()\n                .applySettings(configuration.getProperties())\n                .buildServiceRegistry();\n        SessionFactory sessionFactory = configuration\n                .buildSessionFactory(serviceRegistry);\n\n        Session session = sessionFactory.openSession();\n\n        // Create new instance of Kinde and set values in it by reading them\n        // from form object\n        System.out.println(\"Inserting Record\");\n        Kunde kunde = new Kunde();\n        kunde.setId(1);\n        kunde.setVorname(\"A\");\n        kunde.setNachname(\"N\");\n        kunde.setFirma(\"Privat\");\n        session.save(kunde);\n        System.out.println(\"Done\");\n\n        // Actual insertion will happen at this step\n        session.flush();\n        session.close();\n    } catch (Exception e) {\n        System.out.println(e.getMessage());\n    }\n}\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>Okt 26, 2012 7:56:45 AM org.hibernate.annotations.common.Version &lt;clinit&gt;\nINFO: HCANN000001: Hibernate Commons Annotations {4.0.1.Final}\nOkt 26, 2012 7:56:45 AM org.hibernate.Version logVersion\nINFO: HHH000412: Hibernate Core {4.0.1.Final}\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: HHH000206: hibernate.properties not found\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: HHH000021: Bytecode provider name : javassist\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Configuration configure\nINFO: HHH000043: Configuring from resource: /hibernate.cfg.xml\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Configuration getConfigurationInputStream\nINFO: HHH000040: Configuration resource: /hibernate.cfg.xml\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Configuration addResource\nINFO: HHH000221: Reading mappings from resource: Kunde.hbm.xml\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Configuration addResource\nINFO: HHH000221: Reading mappings from resource: Mitarbeiter.hbm.xml\nOkt 26, 2012 7:56:45 AM org.hibernate.cfg.Configuration doConfigure\nINFO: HHH000041: Configured SessionFactory: Test\nOkt 26, 2012 7:56:45 AM org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl configure\nINFO: HHH000402: Using Hibernate built-in connection pool (not for production use!)\nOkt 26, 2012 7:56:45 AM org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl configure\nINFO: HHH000115: Hibernate connection pool size: 20\nOkt 26, 2012 7:56:45 AM org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl configure\nINFO: HHH000006: Autocommit mode: false\nOkt 26, 2012 7:56:45 AM org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl configure\nINFO: HHH000401: using driver [org.h2.Driver] at URL [jdbc:h2:mem:test]\nOkt 26, 2012 7:56:45 AM org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl configure\nINFO: HHH000046: Connection properties: {}\nOkt 26, 2012 7:56:46 AM org.hibernate.dialect.Dialect &lt;init&gt;\nINFO: HHH000400: Using dialect: org.hibernate.dialect.H2Dialect\nOkt 26, 2012 7:56:46 AM org.hibernate.engine.jdbc.internal.LobCreatorBuilder useContextualLobCreation\nINFO: HHH000423: Disabling contextual LOB creation as JDBC driver reported JDBC version [3] less than 4\nOkt 26, 2012 7:56:46 AM org.hibernate.engine.transaction.internal.TransactionFactoryInitiator initiateService\nINFO: HHH000399: Using default transaction strategy (direct JDBC transactions)\nOkt 26, 2012 7:56:46 AM org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory &lt;init&gt;\nINFO: HHH000397: Using ASTQueryTranslatorFactory\nCould not get constructor for org.hibernate.persister.entity.SingleTableEntityPersister\n</code></pre>\n\n<p>Any idea?</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>Stupid me :)</p>\n\n<p>I printed the entire stack trace which revealed that my classpath was incomplete:</p>\n\n<pre><code>Caused by: java.lang.ClassNotFoundException: javassist.util.proxy.MethodFilter\n    at java.net.URLClassLoader$1.run(Unknown Source)\n    at java.net.URLClassLoader$1.run(Unknown Source)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.net.URLClassLoader.findClass(Unknown Source)\n    at java.lang.ClassLoader.loadClass(Unknown Source)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)\n    at java.lang.ClassLoader.loadClass(Unknown Source)\n    ... 23 more\n</code></pre>\n\n<p>I added the javaassist JAR and it is working fine now.</p>\n\n<p>Sorry.</p>\n"},{"tags":["hibernate","java-ee"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":33,"score":-4,"question_id":13080475,"title":"How to solve hibernate data insertion?","body":"<p>MY project is eclipse java ee web site I wrote code for data insertion but its not working and   data not going for the implimenter class this is my code please give me some solution thanx in advanced.</p>\n\n<pre><code>protected static Logger log = Logger.getLogger(ServerDataAction.class);\n\nprivate String os_serial;\n\nprivate String tdate;\n\nprivate String b_number;\n\nprivate String os;\n\nprivate String os_code;\n\nprivate String server_serial;\n\nprivate String server_code;\n\nprivate String server_company;\n\nprivate String hdisk_usage;\n\nprivate String submitType;\n\nprivate ToremoveProviderImpliment toremove;\n\npublic String execute()\n{\n    if(submitType == null)\n    {\n        return INPUT;\n\n\n     }\n    try {\n\n        ToremoveObject to =new ToremoveObject();\n\n        to.setTdate(\"tdate\");\n\n        to.setB_number(b_number);\n\n        to.setOs(os);\n\n        to.setOs_serial(os_serial);\n\n        to.setOs_code(os_code);\n\n        to.setServer_serial(server_serial);\n\n        to.setServer_code(server_code);\n\n        to.setServer_company(server_company);\n\n        to.setHdisk_usage(hdisk_usage);\n\n        System.out.println(\"wrong worning\");\n\n        //datas come to this point and print wrong worning\n\n        toremove.insertToremove(to);\n\n\n\n\n\n    } catch (Exception e) {\n        // TODO: handle exception\n    }\n    return SUCCESS;\n}\n\npublic void setSubmitType(String submitType) {\n\n    this.submitType = submitType;\n}\n\npublic String getSubmitType() {\n\n    return submitType;\n}\n\npublic void setHdisk_usage(String hdisk_usage) {\n    this.hdisk_usage = hdisk_usage;\n}\npublic String getHdisk_usage() {\n\n    return hdisk_usage;\n\n}\n\npublic void setServer_company(String server_company) {\n\n    this.server_company = server_company;\n\n}\npublic String getServer_company() {\n\n    return server_company;\n\n}\npublic void setServer_code(String server_code) {\n\n    this.server_code = server_code;\n}\npublic String getServer_code() {\n    return server_code;\n}\npublic void setServer_serial(String server_serial) {\n\n    this.server_serial = server_serial;\n\n}\npublic String getServer_serial() {\n\n    return server_serial;\n\n}\npublic void setOs_code(String os_code) {\n\n    this.os_code = os_code;\n}\npublic String getOs_code() {\n    return os_code;\n}\npublic void setOs(String os) {\n\n    this.os = os;\n\n}\npublic String getOs() {\n\n    return os;\n\n}\n\npublic void setB_number(String b_number) {\n\n    this.b_number = b_number;\n\n}\npublic String getB_number() {\n\n    return b_number;\n\n}\npublic void setTdate(String tdate) {\n\n    this.tdate = tdate;\n}\n\npublic String getTdate() {\n\n    return tdate;\n}\npublic void setOs_serial(String os_serial) {\n\n    this.os_serial = os_serial;\n}\npublic String getOs_serial() {\n\n    return os_serial;\n\n}\n\npublic void setToremove(ToremoveProviderImpliment toremove) {\n\n    this.toremove = toremove;\n}\n\npublic ToremoveProviderImpliment getToremove() {\n\n    return toremove;\n\n}\n\n}\n</code></pre>\n\n<p>my implementer class is---------</p>\n\n<pre><code>public class ToremoveProviderImpliment {\n\n  protected static Logger log = Logger.getLogger(ToremoveProviderImpliment.class\n            .getName());    \n\n  SessionFactory sessionFactory1 = new Configuration().configure(\"hibernate-mysql-map.cfg.xml\").buildSessionFactory();\n\n\n\n  public Session openSession() throws ProviderException\n    {\n        try\n        {\n            return sessionFactory1.openSession();\n        }\n\n        catch (HibernateException he)\n        {\n            throw new ProviderException(he);\n        }\n\n    }   \n\n    public void closeSession(Session session) throws ProviderException\n    {\n        try\n        {\n            if (session != null)\n                session.close();\n        }\n\n        catch (HibernateException he)\n        {\n            throw new ProviderException(he);\n        }\n\n    }\n\n    public void rollbackTransaction(Transaction tx)\n    throws ProviderException\n{\n\n    try\n    {\n        if (tx != null)\n\n         tx.rollback();\n    }\n    catch (HibernateException he)\n    {\n        throw new ProviderException(he);\n    }\n}\n\n\n    public void insertToremove(ToremoveObject to) throws ProviderException\n    {\n        System.out.println(\"wrong worning\");\n\n                    // but data does not come to this point  not shown the wrong worning\n\n\n        Session session = openSession();\n\n        Transaction tx = null;\n\n\n        try\n        {\n            tx = session.beginTransaction();\n\n            session.save(to);\n            tx.commit();\n        }\n        catch (HibernateException he)\n        {\n            rollbackTransaction(tx);            \n\n            if (he instanceof JDBCException)\n            {\n                throw new ProviderException(((JDBCException)he).getSQLException());\n            }\n\n            throw new ProviderException(he);\n        }\n        finally\n        {\n            closeSession(session);\n        }\n\n        //return toremove;\n\n    }\n    }\n</code></pre>\n\n<p>this is cgf--------------------</p>\n\n<pre><code>{\n    &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n                                     \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n\n    &lt;session-factory name=\"\"&gt;\n\n    &lt;!-- Database connection settings --&gt;\n\n    &lt;property name=\"connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n\n    &lt;property name=\"connection.url\"&gt;jdbc:mysql//l:10.1.2.130//localhost:3306/pbdsp&lt;/property&gt;\n\n    &lt;property name=\"connection.username\"&gt;misd&lt;/property&gt;\n\n    &lt;property name=\"connection.password\"&gt;misd&lt;/property&gt;\n\n    &lt;!-- JDBC connection pool (use the built-in) --&gt;\n\n    &lt;property name=\"connection.pool_size\"&gt;1&lt;/property&gt;\n\n    &lt;!-- SQL dialect --&gt;\n\n    &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n\n    &lt;!-- Echo all executed SQL to stdout --&gt;\n\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n\n    &lt;mapping resource=\"org/efs/openreports/objects/ToremoveObject.hbm.xml\"/&gt;\n\n    &lt;mapping class=\"org.efs.openreports.providers.impl.ToremoveProviderImpliment\"/&gt;\n\n    &lt;!-- Mapping files --&gt;\n\n    &lt;/session-factory&gt;\n\n&lt;/hibernate-configuration&gt;\n\n}\n</code></pre>\n\n<p>please see the comments also\nmapping file is -------------------------</p>\n\n<pre><code>      &lt;?xml version=\"1.0\"?&gt;\n    &lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n                                   \"http://hibernate.sourceforge.net/hibernate-mapping-       3.0.dtd\"&gt;\n  &lt;!-- Generated Oct 22, 2012 10:48:52 AM by Hibernate Tools 3.4.0.CR1 --&gt;\n   &lt;hibernate-mapping&gt;\n\n\n   &lt;class dynamic-insert=\"true\" dynamic-update=\"true\"\n\n  name=\"org.efs.openreports.objects.ToremoveObject\" table=\"serverdata\"&gt;\n\n   &lt;id column=\"OS_SERIAL\" name=\"os_serial\" type=\"java.lang.String\"&gt;\n\n   &lt;/id&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"tdate\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"tdate\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"b_number\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"b_number\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"os\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"os\"/&gt;\n\n  &lt;/property&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"os_code\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"os_code\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"server_serial\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"server_serial\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"server_code\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"server_code\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"server_company\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"server_company\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;property generated=\"never\" lazy=\"false\" name=\"hdisk_usage\" type=\"java.lang.String\"&gt;\n\n   &lt;column name=\"hdisk_usage\"/&gt;\n\n  &lt;/property&gt;\n\n  &lt;/class&gt;\n\n &lt;/hibernate-mapping&gt;\n</code></pre>\n"},{"tags":["hibernate","mapping"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":12280,"score":3,"question_id":502898,"title":"Hibernate change fetch mode in runtime","body":"<p>I have two tables related together using one-to-many relation :\n  employee -> department : and relation through department_id in the employee table.</p>\n\n<p>I use hibernate : and my hibernate mapping files are:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n                                   \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- \n    Mapping file autogenerated by MyEclipse Persistence Tools\n--&gt;\n&lt;hibernate-mapping default-lazy=\"false\"&gt;\n &lt;class catalog=\"moi\"\n  name=\"com.ebla.moi.correspondence.model.entity.user.User\" table=\"user\"&gt;\n  &lt;id name=\"id\" type=\"java.lang.Long\"&gt;\n   &lt;column name=\"id\"/&gt;\n   &lt;generator class=\"identity\"/&gt;\n  &lt;/id&gt;\n  &lt;many-to-one\n   class=\"com.ebla.moi.correspondence.model.entity.department.Department\"\n   fetch=\"select\" name=\"department\"&gt;\n   &lt;column name=\"department_id\"/&gt;\n  &lt;/many-to-one&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"name\" type=\"java.lang.String\"&gt;\n   &lt;column length=\"128\" name=\"name\" not-null=\"true\"/&gt;\n  &lt;/property&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"email\" type=\"java.lang.String\"&gt;\n   &lt;column length=\"128\" name=\"email\" not-null=\"true\" unique=\"true\"/&gt;\n  &lt;/property&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"maritalStatus\" type=\"java.lang.Short\"&gt;\n   &lt;column name=\"marital_status\" not-null=\"true\"/&gt;\n  &lt;/property&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"hireDate\" type=\"java.lang.String\"&gt;\n   &lt;column length=\"64\" name=\"hire_date\"/&gt;\n  &lt;/property&gt;\n &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>and the second mapping file is : </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n                                   \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- \n    Mapping file autogenerated by MyEclipse Persistence Tools\n--&gt;\n&lt;hibernate-mapping default-lazy=\"false\"&gt;\n &lt;class catalog=\"moi\"\n  name=\"com.ebla.moi.correspondence.model.entity.department.Department\" table=\"department\"&gt;\n  &lt;id name=\"id\" type=\"java.lang.Long\"&gt;\n   &lt;column name=\"id\"/&gt;\n   &lt;generator class=\"identity\"/&gt;\n  &lt;/id&gt;\n  &lt;property generated=\"never\" lazy=\"false\" name=\"name\" type=\"java.lang.String\"&gt;\n   &lt;column length=\"256\" name=\"name\" unique=\"true\"/&gt;\n  &lt;/property&gt;\n  &lt;set inverse=\"true\" name=\"users\" sort=\"unsorted\"&gt;\n   &lt;key&gt;\n    &lt;column name=\"department_id\"/&gt;\n   &lt;/key&gt;\n   &lt;one-to-many class=\"com.ebla.moi.correspondence.model.entity.user.User\"/&gt;\n  &lt;/set&gt;\n &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>My problem is : sometimes i need to get the employee with his department, and other times i need only the employee information with out department information..... and the same thing with department with employee.... using the mapping file above the hibernate bring the department and it's users if i need the employee or not... how to define my needs to hibernate to fetch just what i need...</p>\n\n<p>thank you</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13072638,"title":"Spring 3.1 + Hibernate 4.1 - Run code before webapp finishes deploying","body":"<p>I have a spring based webapp that persists data with Hibernate.  The default web page that comes up when the service is deployed immediately makes an ajax request for the data.  So if the data doesn't already exist, it needs to be fetched and persisted.  I want to make sure that when I deploy the service, before spring is up and tomcat is serving out my web pages that I can execute code to fetch and persist my data.</p>\n\n<p>I thought a regular context listener might do the trick, but I don't know if there's any guarantee that it will finish before everything else is initialized.  Is there something in Spring that can do this?  Or will a context listener do the trick?</p>\n"},{"tags":["hibernate","azure","sql-azure"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":267,"score":2,"question_id":10665843,"title":"Hibernate + SQL Azure = Cannot find data type boolean","body":"<p>i am using hbm2ddl.auto=create to generate the schema in a SQL Azure database with hibernate.\nThis fails when using a Boolean or boolean type with an \"Cannot find data type boolean.\" exception. </p>\n\n<p>This might be related to the used dialect \"org.hibernate.dialect.SQLServerDialect\" and this <a href=\"https://hibernate.onjira.com/browse/HHH-6420?page=com.atlassian.jira.plugins.jira-github-connector-plugin%3agithub-commits-tabpanel\" rel=\"nofollow\">Bug report</a>. I am using Hibernate-core 4.1.3 and therefore this bug should be resolved.</p>\n\n<p>Can somebody help me to fix this problem?</p>\n\n<p>Thanks,\nSebastian</p>\n"},{"tags":["java","oracle","hibernate","database-schema","hbm2ddl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13077784,"title":"DB (oracle) column description using hibernate / data dictionary","body":"<p>we use Hibernate for creating the DB schema and as ORM. We like to have the persistent layer exchangable between Postgres, Oracle and HSQLDB.</p>\n\n<p>Since there is also a DB team for Oracle, there are many times questions like \"What does this column mean?\" and the answer is in the Java class as JavaDoc. So what I am looking for is a possibility to add description to columns by using the text at the class property (best would be the java doc). However, google didn't find anything helpful except of this:</p>\n\n<p><a href=\"https://hibernate.onjira.com/browse/HHH-4369\" rel=\"nofollow\">https://hibernate.onjira.com/browse/HHH-4369</a></p>\n\n<p>I doubt, that this request will be implemented.</p>\n\n<p>One idea might be to write my own annotation @ColumnDesc(\"my description\") and write a lib, that scans class for this annotation and generate extra DDL (alter table) script for the column description and execute this script. This seems little bit complicated, since I need to get the table and column name.</p>\n\n<p>So my question is:</p>\n\n<p>Is there a workaround or other easy way to create column descriptions in the DB (oracle) when creating the DB with Hibernate Tools (hbm2ddl)?</p>\n\n<p>Alternative: Is there an easy way to generate a data dictionary for the tables and columns generated by hibernate? (Please don't say JavaDoc, DBAs can't read JavaDocs)</p>\n\n<p>We use the annotation hibernate defintion (no XML).</p>\n\n<p>Thanks for any hint!</p>\n\n<p>Regards,</p>\n\n<p>Andreas</p>\n"},{"tags":["java","hibernate","jpa","connection-pooling","c3p0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13076572,"title":"hibernate, jpa, c3p0, and warning HHH000208","body":"<p>I'm using Hibernate 4.1.6Final for accessing a JPA data source. While adding connection pooling via c3p0 I ran into this log message:</p>\n\n<pre><code>611  [main] WARN  org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator  - HHH000208: org.hibernate.connection.C3P0ConnectionProvider has been deprecated in favor of org.hibernate.service.jdbc.connections.internal.C3P0ConnectionProvider; that provider will be used instead.\n</code></pre>\n\n<p>Here are the hibernate artifacts from my POM:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n  &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n  &lt;version&gt;4.1.6.Final&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n  &lt;artifactId&gt;hibernate-c3p0&lt;/artifactId&gt;\n  &lt;version&gt;4.1.6.Final&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>and the relevant properties from <code>persistence.xml</code>:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;property name=\"hibernate.connection.provider_class\" value=\"org.hibernate.connection.C3P0ConnectionProvider\" /&gt;\n&lt;property name=\"hibernate.c3p0.max_size\" value=\"100\" /&gt;\n&lt;property name=\"hibernate.c3p0.min_size\" value=\"5\" /&gt;\n&lt;property name=\"hibernate.c3p0.acquire_increment\" value=\"5\" /&gt;\n&lt;property name=\"hibernate.c3p0.idle_test_period\" value=\"500\" /&gt;\n&lt;property name=\"hibernate.c3p0.max_statements\" value=\"50\" /&gt;\n&lt;property name=\"hibernate.c3p0.timeout\" value=\"10000\" /&gt;\n</code></pre>\n\n<p>I get the same warning even if I change the name of the provider to the favored class. What's the correct class name to use for <code>hibernate.connection.provider_class</code>? Is there a preferred connection provider for production use that's not c3p0?</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":358,"score":3,"question_id":11938253,"title":"JPA JoinColumn vs mappedBy","body":"<p>What is the difference between:</p>\n\n<pre><code>@Entity\npublic class Company {\n\n    @OneToMany(cascade = CascadeType.ALL , fetch = FetchType.LAZY)\n    @JoinColumn(name = \"companyIdRef\", referencedColumnName = \"companyId\")\n    private List&lt;Branch&gt; branches;\n    ...\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>@Entity\npublic class Company {\n\n    @OneToMany(cascade = CascadeType.ALL , fetch = FetchType.LAZY, mappedBy = \"companyIdRef\")\n    private List&lt;Branch&gt; branches;\n    ...\n}\n</code></pre>\n"},{"tags":["hibernate","criteria","one-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2718,"score":0,"question_id":1119794,"title":"one-to-many with criteria question","body":"<p><code>enter code here</code>I want to apply restrictions on the list of items, so only items from a given dates will be retrieved.</p>\n\n<p>Here are my mappings:</p>\n\n<pre><code>    &lt;class name=\"MyClass\" \n            table=\"MyTable\" mutable=\"false\" &gt;\n            &lt;cache usage=\"read-only\"/&gt;\n    &lt;id name=\"myId\" column=\"myId\" type=\"integer\"/&gt;\n    &lt;property name=\"myProp\" type=\"string\" column=\"prop\"/&gt;\n    &lt;list name=\"items\" inverse=\"true\" cascade=\"none\"&gt;\n    \t&lt;key column=\"myId\"/&gt;\n    \t&lt;list-index column=\"itemVersion\"/&gt;\n    \t&lt;one-to-many class=\"Item\"/&gt;\n    &lt;/list&gt;\t\n   &lt;/class&gt;\n    &lt;class name=\"Item\" \n            table=\"Items\" mutable=\"false\" &gt;\n            &lt;cache usage=\"read-only\"/&gt;\n    &lt;id name=\"myId\" column=\"myId\" type=\"integer\"/&gt;\n    &lt;property name=\"itemVersion\" type=\"string\" column=\"version\"/&gt;\n    &lt;property name=\"startDate\" type=\"date\" column=\"startDate\"/&gt;\n   &lt;/class&gt;\n</code></pre>\n\n<p>I tried this code:</p>\n\n<pre><code>Criteria crit = session.createCriteria(MyClass.class);\ncrit.add( Restrictions.eq(\"myId\", new Integer(1)));\ncrit = crit.createCriteria(\"items\").add( Restrictions.le(\"startDate\", new Date()) );\n</code></pre>\n\n<p>which result the following quires:</p>\n\n<pre><code>select ...\nfrom MyTable this_ inner join Items items1_ on this_.myId=items1_.myId \nwhere this_.myId=? and items1_.startDate&lt;=?\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>select ...\nfrom Items items0_ \nwhere items0_.myId=?\n</code></pre>\n\n<p>But what I need is something like:</p>\n\n<pre><code>select ...\nfrom MyTable this_ \nwhere this_.myId=?\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>select ...\nfrom Items items0_ \nwhere items0_.myId=? and items0_.startDate&lt;=?\n</code></pre>\n\n<p>Any idea how I can apply a criteria on the list of items?</p>\n"},{"tags":["java","database","spring","hibernate","sessionfactory"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13072948,"title":"Multiple Hibernate data sources","body":"<p>I have a project that currently uses 3 databases on the same database server. One of the databases has now been moved to another physical server and I'm trying to get hibernate to handle this but struggling to work out where to start - should I duplicate datasource, sessionfactory, hibernatetemplate, and transaction manager and then try to manage this in the code? I'm using Spring 3 and Hibernate 3.5. Is this a common thing to do? Any advice would be much appreciated.</p>\n\n<p>If it helps my config currently looks like this:</p>\n\n<pre><code>&lt;bean id=\"datasource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\"/&gt;\n    &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/DatabaseOne\"/&gt;\n    &lt;property name=\"username\" value=\"username\"/&gt;\n    &lt;property name=\"password\" value=\"password\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"datasource\"/&gt;\n    &lt;property name=\"exposeTransactionAwareSessionFactory\"&gt;&lt;value&gt;true&lt;/value&gt;&lt;/property&gt;\n    &lt;property name=\"annotatedClasses\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;domain.DatabaseOneObject&lt;/value&gt;\n            &lt;value&gt;domain.DatabaseTwoObject&lt;/value&gt;\n            &lt;value&gt;domain.DatabaseThreeObject&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"hibernateTemplate\" class=\"org.springframework.orm.hibernate3.HibernateTemplate\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13062759,"title":"Can I change default (AUTO) value for GenerationType in @GeneratedValue for persistence unit?","body":"<p>I'm writing junit tests for a server part of our application that connects to a database. Our usual strategy is to put into <code>src/test/resources/</code> new <code>META-INF/persistence.xml</code> file that overrides the default one so that tests won't connect to Oracle database, but hsqldb.</p>\n\n<p>And here is my problem - one of the entities has a field defined like so:</p>\n\n<pre><code>@Id\n@Column(name = \"ID\", nullable = false)\n@SequenceGenerator(name=\"sequence\", sequenceName=\"sequence\")\n@GeneratedValue(generator=\"sequence\")\nprotected Integer id;\n</code></pre>\n\n<p>During standard run of the application it works fine - I'm not defining specific strategy for @GeneratedValue so it defaults to <code>GenerationType.AUTO</code> which, according to <a href=\"http://docs.oracle.com/javaee/5/api/javax/persistence/GenerationType.html#AUTO\" rel=\"nofollow\">http://docs.oracle.com/javaee/5/api/javax/persistence/GenerationType.html#AUTO</a> , lets the persistence provider decide which strategy to use depending on which database lies underneath, and since normally it's Oracle and Oracle's default generator strategy is <code>GenerationType.SEQUENCE</code>.</p>\n\n<p>But when I run tests I get:</p>\n\n<pre><code>[junit] Testcase: xxx.TestCase took 0 sec\n[junit]     Caused an ERROR\n[junit] \"xxx.Entity.id\" declares generator name \"sequence\", but uses the AUTO generation type.  The only valid generator names under AUTO are \"uuid-hex\" and \"uuid-string\".\n</code></pre>\n\n<p>According to comment in <a href=\"http://stackoverflow.com/questions/3596848/hibernate-generatedvalue-for-hsqldb\">Hibernate @generatedvalue for HSQLDB</a> hsqldb's default strategy is <code>GenerationType.IDENTITY</code>.</p>\n\n<p>The obvious solution would be to add <code>strategy=GenerationType.SEQUENCE</code> to entity's field definition, but 1) it's generally bad practice to change working code to accomodate for test cases 2) I don't exactly have access nor authority to change this entity. So assuming I can't change that my next hunch would be to put some property in our test <code>META-INF/persistence.xml</code> inside persistece-unit definition that would tell Hibernate to default generator strategy to <code>SEQUENCE</code> instead of database's default.</p>\n\n<p>Can I do that, if yes then how can I do that, if no then what else can I do?</p>\n"},{"tags":["java","hibernate","jodatime"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":9034014,"title":"How do I store a date time in a local time that can be unambiguously retrieved with hibernate?","body":"<p>I think I understand the fundamentals of it. I would need the local date and time, as well as the UTC offset. Right now I'm using a joda-time DateTime object with the hibernate usertype <code>@Type(type = \"org.jadira.usertype.dateandtime.joda.PersistentDateTimeWithZone\")</code> which works great, except that the timezone stored is the ID, ie \"America/Los_Angeles\" as opposed to PST/PDT. </p>\n\n<p>The problem then lies during that one hour of overlap in the fall every year during DST. These times cannot be retrieved unambiguously during this period.</p>\n\n<p>Is there any way I can achieve this without manually adding in a column with the hours/minutes offset from UTC?</p>\n"},{"tags":["hibernate","spring","jpa","persist","postconstruct"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":166,"score":1,"question_id":8903499,"title":"Spring + JPA + Hibernate: No inserts at startup","body":"<p>I'm executing a method at startup time with <code>@PostConstruct</code> annotation. This method has to check a value stored in a table in DB. If it doesn't exist, then it has to insert it. The checking of the value in DB is done correctly, however if I had to persist it, it won't write it to DB. It doesn't throw any exception and <code>persist()</code> is executed (apparently) without problems, only the value is not inserted in DB.</p>\n\n<p>Moreover, once everything is up, if I manually call that method (from a Controller, for example), it will insert the value correctly.</p>\n\n<pre><code>@PostConstruct\npublic void insertIfNecessary()\n{\n   Request r = Request.findRequestForUser(this.me);\n   if ( r == null )\n   {\n      r = new Request();\n      r.setOwner(this.me);\n      r.persist();\n   }\n}\n</code></pre>\n\n<p>Do you know what may be wrong?</p>\n\n<p>Best regards,\nMiguel</p>\n"},{"tags":["hibernate","eclipse-plugin","jndi","sessionfactory"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":4993,"score":3,"question_id":1620612,"title":"Problems using eclipse Hibernate plugin - could not locate sessionfactory in JNDI","body":"<p>I'm using the reverse engineering capabilities built into the eclipse hibernate plugin to generate dao's and hbm.xml files for each table.</p>\n\n<p>It does it quite well but when I try to use the generated Objects I get a Could not locate SessionFactory in JNDI error.</p>\n\n<p>I saw a post that suggested this happens when you name your SessionFactory in the hibernate.cfg.xml file so I removed the name tag and i'm still getting the same error.</p>\n\n<p>This is my hibernate.cfg.xml</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.bytecode.use_reflection_optimizer\"&gt;false&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;qwerty&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://127.0.0.1:3306/agilegroup3&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.default_catalog\"&gt;agilegroup3&lt;/property&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLInnoDBDialect&lt;/property&gt;\n        &lt;mapping resource=\"generated/Usersroles.hbm.xml\" /&gt;\n        &lt;mapping resource=\"generated/Role.hbm.xml\" /&gt;\n        &lt;mapping resource=\"generated/Logdata.hbm.xml\" /&gt;\n        &lt;mapping resource=\"generated/Logtrigger.hbm.xml\" /&gt;\n        &lt;mapping resource=\"generated/User.hbm.xml\" /&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>This is the generated code that triggers the exception</p>\n\n<pre><code>protected SessionFactory getSessionFactory() {\n\ttry {\n\t\treturn (SessionFactory) new InitialContext()\n\t\t\t\t.lookup(\"SessionFactory\");\n\t} catch (Exception e) {\n\t\tlog.error(\"Could not locate SessionFactory in JNDI\", e);\n\t\tthrow new IllegalStateException(\n\t\t\t\t\"Could not locate SessionFactory in JNDI\");\n\t}\n}\n</code></pre>\n\n<p>I don't know much about JNDI but I guess its some sort of lookup equiv to a config file. I dont want to use JNDI but I dont know how to achieve this using the eclipse pluggin.</p>\n\n<p>Changing the generated code wont really help me because I'll need to keep regenerating it at some points so if anyone could explain why/how this is happening and what I can do about it I'd be grateful</p>\n\n<p>Thanks</p>\n\n<p>Jonathan</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13072668,"title":"Illegal Argument Exception in Hibernate","body":"<p>I'd like to perform a Hibernate query to get the number of \"Coordinators\" within a Group. A \"Coordinator\" has an admin-like role of a group.</p>\n\n<p>At a higher level, I have two tables: domaingroup and group_coordinators. The latter table has 2 columns: coordinators_id and domaingroup_id. I'd like to check the # of rows for a particular user (shown in coordinators_id) and group (shown in domaingroup_id).</p>\n\n<p>I get the error,</p>\n\n<blockquote>\n  <p>java.lang.IllegalArgumentException:\n  org.hibernate.hql.ast.QuerySyntaxException:\n  DomainGroup.Group_Coordinators is not \\ mapped</p>\n</blockquote>\n\n<p>for the query,</p>\n\n<pre><code>SELECT Coordinators_Id=:followerId FROM DomainGroup.Group_Coordinators \nWHERE Coordinators_Id=:followerId and DomainGroup_id=:followingId\n</code></pre>\n\n<p>for the code,</p>\n\n<pre><code> class DomainGroup ... {\n\n                /**\n                 * List of coordinators for this group.\n                 */\n                @Size(min = 1, message = MIN_COORDINATORS_MESSAGE)\n                @ManyToMany(fetch = FetchType.EAGER, cascade = \n        { CascadeType.PERSIST })\n                @JoinTable(name = \"Group_Coordinators\")\n                private Set&lt;Person&gt; coordinators;\n</code></pre>\n\n<p>Please advise me on how to properly execute this query.</p>\n\n<p>Thanks,\nKevin</p>\n"},{"tags":["java","hibernate","session","jdbc"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13067372,"title":"converting sessions in hibernate to plein JDBC connections","body":"<p>I am shifting back from hibernate to plain JDBC in order to overcome the overheads incurred in using hibernate.I wanted to know how to deal with the sessions associated with hibernate.How should i convert back to Plain JDBC so that all my sessions are replaced with the JDBC connections.And please let me know if I am wrong in my thoughts that replacing a session with a connection converts back to plain JDBC as I am not well versed in these concepts and dont know if i am going in the right way.</p>\n"},{"tags":["spring","hibernate","caching","tomcat","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13072220,"title":"monitor performance with JPA + Spring","body":"<p>What are the tools and approaches you suggest to use for monitoring performance? My app is running on Tomcat, Spring 3, JPA, Hibernate and solr. I've noticed some lag/slow activity on a certain page.\nThe app does not have any code of cache setup. Or even connection pooling.</p>\n\n<p>Pardon my beginner-style questions, I'm only entering the \"performance monitoring\" world just now...</p>\n\n<p>I know couple of things to look at is- dabatase calls, connection pooling, indexed tables, caching etc.</p>\n"},{"tags":["java","hibernate","persistence"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":440,"score":5,"question_id":5800814,"title":"Is it possible to detach Hibernate entity, so that changes to object are not automatically saved to database?","body":"<p>I have Hibernate entity that I have to convert to JSON, and I have to translate some values in entity, but when I translate values, these values are instantly saved to database, but I don't want to save these changes to database. Is there any workaround for this porblem?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13070942,"title":"How to delete all children in a foreign key relationship","body":"<p>I have two tables in my database USERS, and USER_SESSIONS.  USER_SESSIONS has a foreign key on userid that maps to the USERS table's userid, and I have defined the many-to-one relationship in hibernate with:</p>\n\n<pre><code>&lt;many-to-one name=\"user\" column=\"USERID\" class=\"com.Users\" /&gt;\n</code></pre>\n\n<p>How do I write a hibernate method to delete all rows in the USER_SESSIONS database for a given user when only given the username.</p>\n\n<p>My first attempt was to load the user object for the given username, and then do an HSQL to delete all sessions for that user's userid.  Is there a simpler way?</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13070682,"title":"Set default values using hibernate annotations in MYSQL","body":"<p>I have searched on internet and seen hundred of ideas about setting default values in entity class using hibernate annotations in mysql and I have done with setting default values to column with datatype integer only as follows.</p>\n\n<pre><code>@Column(name = \"COLUMN_NAME\", insertable=false, updatable = false, nullable = false, columnDefinition = \"int default 1\")\nprotected Integer test_id;\n</code></pre>\n\n<p>and is working fine.</p>\n\n<p>But I haven't seen any example for varchar/string datatype and I have try with different types in columnDefinition like,</p>\n\n<pre><code>columnDefinition = \"TEXT default `TEST`\"  \ncolumnDefinition = \"TEXT default TEST\"  \ncolumnDefinition = \"varchar(255) default `15-JUL-1980`\")  \ncolumnDefinition = \"varchar(255) default 15-JUL-1980\")  \ncolumnDefinition = \"varchar default 15-JUL-1980\")  \ncolumnDefinition = \"varchar default `15-JUL-1980`\")  \ncolumnDefinition = \"CHAR(100) default `15JUL1980`\")  \ncolumnDefinition = \"CHAR default `15JUL1980`\")\n</code></pre>\n\n<p>With length attribute:-</p>\n\n<pre><code>`length=100, columnDefinition = \"CHAR default `15JUL1980`\")` \n</code></pre>\n\n<p>etc.</p>\n\n<p>but in this case table is not created by hibernate, that may be due to wrong syntax.\nBut if I am creating the table with only integer values as above table is created.</p>\n"},{"tags":["mysql","sql","hibernate","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13069689,"title":"How to get last record from Mysql using Hibernate?","body":"<pre><code>List&lt;Lahetys&gt; last = session.createQuery(\"from lahetys order by lahetysNro DESC LIMIT 1\").list();\n</code></pre>\n\n<p>and in the log I got:</p>\n\n<pre><code>INFO: Hibernate: select  from order by  lahetysNro DESC LIMIT 1\nWARN: SQL Error: 1064, SQLState: 42000\nERROR: You have an error in your SQL syntax; check the manual that corresponds to your       MySQL server version for the right syntax to use near 'from order by  lahetysNro DESC LIMIT 1' at line 1\n</code></pre>\n\n<p>What has happend to \"from LAHETYS\"? What is the best practice to handle that with HQL or/and with SQL?</p>\n\n<p>Another problem:</p>\n\n<pre><code>Lahetys last = (Lahetys)session.createSQLQuery(\"select * from lahetys order by lahetysNro DESC LIMIT 1\").uniqueResult();\nsession.getTransaction().commit();  \n</code></pre>\n\n<p>and I get a exception:</p>\n\n<pre><code>Ljava.lang.Object; cannot be cast to Lahetys \n</code></pre>\n\n<p>So I can't cast an object to my Lahetys-object, weird?</p>\n\n<p>Thank you!\nSami</p>\n"},{"tags":["java","hibernate","criteria"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13068706,"title":"How to properly check if a row exist in database?","body":"<p>One of my DAO methods contains the following method:</p>\n\n<pre><code>@Override\npublic boolean isAvailable(String code) {\n    Criteria criteria = getSession().createCriteria(MyEntity.class);\n    cr.add(Restrictions.eq(\"code\", code).ignoreCase());\n    cr.setProjection(Projections.rowCount());\n    Long rowCount = (Long) cr.uniqueResult();\n    return (rowCount &gt; 0) ? true : false;\n}\n</code></pre>\n\n<p>On the last line the following exception is thrown:</p>\n\n<pre><code>org.hibernate.exception.DataException: could not execute query\nat org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:102)\nat org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\nat org.hibernate.loader.Loader.doList(Loader.java:2452)\nat org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2192)\nat org.hibernate.loader.Loader.list(Loader.java:2187)\nat org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:119)\nat org.hibernate.impl.SessionImpl.list(SessionImpl.java:1706)\nat org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:347)\nat org.hibernate.impl.CriteriaImpl.uniqueResult(CriteriaImpl.java:369)\n</code></pre>\n\n<p>The <code>code</code> is primary key in this table. Hibernate is generating its select command in console. When I am checking this select command in SQL console in my database it returns correct values. So what am I doing wrong?</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":38,"score":4,"question_id":13069532,"title":"I'm restoring a database and I need to lock any activity to it from my Java application while doing it","body":"<p>I'm using a c3p0 ComboPooledDataSource with Spring and Hibernate and the solution I came up with is a custom Datasource class that accepts the actual Datasource in it's constructor. I delegate all the responsibility to the actual datasource. I have a locked boolean which when set to true makes getConnection() wait until locked is false again.</p>\n\n<p>I was just wondering whether anyone can see flaws in my approach or have better alternatives? Thanks!</p>\n\n<pre><code>public interface LockableDataSource extends DataSource {\n    public boolean isLocked();\n\n    public void setLocked(boolean locked);\n}\n\n\npublic class LockableDataSourceImpl implements LockableDataSource{\n\n    private DataSource dataSource;\n    private boolean locked = false;\n\n\n    public LockableDataSourceImpl(DataSource dataSource) {\n        this.dataSource = dataSource;\n    }\n\n    public Connection getConnection() throws SQLException {\n        while(locked){\n            try {\n                Thread.sleep(500);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n        return dataSource.getConnection();\n    }\n\n    public Connection getConnection(String s, String s1) throws SQLException {\n        while(locked){\n            try {\n                Thread.sleep(500);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n        return dataSource.getConnection(s, s1);\n    }\n\n    public PrintWriter getLogWriter() throws SQLException {\n        return dataSource.getLogWriter();\n    }\n\n    public void setLogWriter(PrintWriter printWriter) throws SQLException {\n        dataSource.setLogWriter(printWriter);\n    }\n\n    public void setLoginTimeout(int i) throws SQLException {\n        dataSource.setLoginTimeout(i);\n    }\n\n    public int getLoginTimeout() throws SQLException {\n        return dataSource.getLoginTimeout();\n    }\n\n    public &lt;T&gt; T unwrap(Class&lt;T&gt; tClass) throws SQLException {\n        return dataSource.unwrap(tClass);\n    }\n\n    public boolean isWrapperFor(Class&lt;?&gt; aClass) throws SQLException {\n        return dataSource.isWrapperFor(aClass);\n    }\n\n    public boolean isLocked() {\n        return locked;\n    }\n\n    synchronized public void setLocked(boolean locked) {\n        this.locked = locked;\n    }\n}   \n</code></pre>\n"},{"tags":["sql","hibernate","null"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4716,"score":0,"question_id":5817775,"title":"node to traverse cannot be null (Hibernate SQL)","body":"<p>I'm performing a SQL query through hibernate, which looks like:</p>\n\n<pre><code>SELECT thi \nFROM track_history_items thi \nJOIN artists art \n  ON thi.artist_id = art.id \nWHERE thi.type = \"TrackBroadcast\" \nGROUP BY art.name \nORDER thi.createdAt DESC\n</code></pre>\n\n<p>but I'm getting the message that 'Node to traverse cannot be null!'.  Anyone know what could be causing this?</p>\n\n<p>--<strong>EDIT</strong>--</p>\n\n<p>I'm pretty sure that this problem is being caused by the possibility of artist_id to be null.  However, I can't prevent this, so can I just skip the rows track_history_item rows which have a null artist_id?</p>\n"},{"tags":["java","hibernate","jpa","concurrency","hashmap"],"answer_count":5,"favorite_count":8,"up_vote_count":13,"down_vote_count":0,"view_count":25206,"score":13,"question_id":602636,"title":"ConcurrentModificationException and a HashMap","body":"<p>I am persisting objects using JPA.  The Main object has an owning One-Many relationship with another object.  The other object is stored in a HashMap.  What sort of synchronization would fix this problem?  It seems to happen at completely random times and is very unpredictable.  Here is the exception I get:</p>\n\n<pre><code>Exception in thread \"pool-1-thread-1\" java.util.ConcurrentModificationException\n        at java.util.HashMap$HashIterator.nextEntry(Unknown Source)\n        at java.util.HashMap$ValueIterator.next(Unknown Source)\n        at org.hibernate.collection.AbstractPersistentCollection$IteratorProxy.next(AbstractPersistentCollection.java:555)\n        at org.hibernate.engine.Cascade.cascadeCollectionElements(Cascade.java:296)\n        at org.hibernate.engine.Cascade.cascadeCollection(Cascade.java:242)\n        at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:219)\n        at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)\n        at org.hibernate.engine.Cascade.cascade(Cascade.java:130)\n</code></pre>\n"},{"tags":["java","database","hibernate","oracle11g"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13068156,"title":"Testing performance / connection speed of (Oracle) database","body":"<p>I have two test environments. My application is performing much worst on the seconds one. I suspect that this because the first one system is using database which runs on better hardware (more CPU, faster connection). I would like to verify my claims somehow. Are there any tools, which would help me with that? Should it helpful, I am using Oracle 11g and my app is using Hibernate to connect to the database.</p>\n\n<p>Mind you, I am not interested in profiling my schema. I would like to compare how fast is the same database (meaning schema + data) on two different machines. </p>\n\n<p>If you are interested, why I suspect that database is the problem: I profiled my application during tests on those two environments. During the second test environment methods responsible for connecting to database (namely org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery()) are using much more of the CPU time.</p>\n"},{"tags":["hibernate","caching","second-level-cache"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13068417,"title":"hibernate: updating second level cached element","body":"<p>I have an entity (User) cached with Hibernate at second level as READ-WRITE on top of the class User:</p>\n\n<pre><code>@org.hibernate.annotations.Cache(usage = org.hibernate.annotations.CacheConcurrencyStrategy.READ_WRITE)\n</code></pre>\n\n<p>When I start the application the only thing I can see is:</p>\n\n<blockquote>\n  <p>java.lang.IllegalStateException\n      at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1597)\n      at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)\n      at org.infinispan.util.concurrent.BoundedConcurrentHashMap.values(BoundedConcurrentHashMap.java:1696)\n      at org.infinispan.container.DefaultDataContainer.purgeExpired(DefaultDataContainer.java:164)\n      at org.infinispan.eviction.EvictionManagerImpl.processEviction(EvictionManagerImpl.java:92)\n      at org.infinispan.eviction.EvictionManagerImpl$ScheduledTask.run(EvictionManagerImpl.java:132)\n      at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n      at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)\n      at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)\n      at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)\n      at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)\n      at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)\n      at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n      at java.lang.Thread.run(Thread.java:662)\n  25-Oct-2012 13:00:12 org.apache.catalina.loader.WebappClassLoader loadClass\n  INFO: Illegal access: this web application instance has been stopped already.  Could not load org.jgroups.protocols.pbcast.STABLE$1.  The eventual following stack trace is caused by an error thrown for debugging purposes as well as to attempt to terminate the thread which caused the illegal access, and has no functional impact.\n  java.lang.IllegalStateException\n      at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1597)\n      at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)\n      at org.jgroups.protocols.pbcast.STABLE.sendStableMessage(STABLE.java:663)\n      at org.jgroups.protocols.pbcast.STABLE.access$1100(STABLE.java:43)\n      at org.jgroups.protocols.pbcast.STABLE$StableTask.run(STABLE.java:808)\n      at org.jgroups.util.TimeScheduler2$RecurringTask.run(TimeScheduler2.java:592)\n      at org.jgroups.util.TimeScheduler2$MyTask.run(TimeScheduler2.java:524)\n      at org.jgroups.util.TimeScheduler2$Entry.execute(TimeScheduler2.java:429)\n      at org.jgroups.util.TimeScheduler2$1.run(TimeScheduler2.java:295)\n      at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n      at java.lang.Thread.run(Thread.java:662)</p>\n</blockquote>\n\n<p>The only configuration I have on my app is:</p>\n\n<pre><code>    &lt;property name=\"hibernate.cache.region.factory_class\"&gt;org.hibernate.cache.infinispan.InfinispanRegionFactory&lt;/property&gt;\n    &lt;property name=\"hibernate.cache.infinispan.statistics\"&gt;false&lt;/property&gt;\n    &lt;property name=\"hibernate.cache.infinispan.expiration.wake_up_interval\"&gt;300000&lt;/property&gt;\n</code></pre>\n\n<blockquote>\n<pre><code>  &lt;property name=\"hibernate.cache.infinispan.org.myapp.User.expiration.lifespan\"&gt;600000&lt;/property&gt;\n    &lt;property name=\"hibernate.cache.infinispan.org.myapp.User.expiration.max_idle\"&gt;600000&lt;/property&gt;\n    &lt;property name=\"hibernate.cache.infinispan.org.myapp.User.expiration.max_entries\"&gt;25000&lt;/property&gt;\n</code></pre>\n</blockquote>\n\n<p>How can make \"read_write\" possible in my app for \"User\" entity?</p>\n"},{"tags":["java","hibernate","hql"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":1240,"score":7,"question_id":5686412,"title":"How to escape reserved words in Hibernate's HQL","body":"<p>I use the following query to get a <code>java.util.Map</code> with indexes <code>id</code>, <code>text</code> and <code>object</code>:</p>\n\n<pre><code>Query q = mySession.createQuery(\n    \"SELECT u.id AS id, u.name AS text, u AS object FROM User u\")\n    .setResultTransformer(Transformers.ALIAS_TO_ENTITY_MAP);\n</code></pre>\n\n<p>... but <code>object</code> seems to be a reserved word. For example <code>obj</code> is OK. What is the current way to escape an <em>alias</em> in HQL the way MySQL uses backtick escapes?</p>\n\n<p>Using backtick gives the following error:</p>\n\n<pre><code>Exception in thread \"main\" org.hibernate.QueryException: unexpected char: \n'`' [SELECT u.id AS id, u.name AS text, u AS `object` FROM User u]\n</code></pre>\n"},{"tags":["java","mysql","hibernate","ant","struts"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":3584,"score":1,"question_id":7158273,"title":"Struts Hibernate tutorial for beginner","body":"<p>1.) I am hoping to learn Struts. Can someone point me to a step by step tutorial that makes use of Structs, Hibernate which connects to a MySQL DB (or any other DB). </p>\n\n<p>2.) I need to use ANT as my build tool. and a tutorial on how to create ANT project and use it to develop my struts, hibernate project</p>\n"},{"tags":["hibernate","postgresql","hsqldb"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2163,"score":5,"question_id":4213782,"title":"Hibernate postgresql/hsqldb TEXT column incompatibility problem","body":"<p>I have a problem using Hibernate and PostgreSQL for production and HSQLDB for testing.<br />\nI am using top-down approach letting Hibernate create database schema.<br />\nI am also using annotations; mapping part of hibernate.cfg.xml only contains lines like<br />\n<code>&lt;mapping class=\"package.subpackage.ClassName\" /&gt;</code> <br />\nHibernate defaults String variables to character varying(255) on PostgreSQL which is not sufficient for me in some cases, so I have to redefine some columns manually using <br />\n<code>@Column(columnDefinition = \"TEXT\")</code>. <br />\nBut, TEXT type is invalid for HSQLDB, so those tables can not be created. <br /> <br />\nCan anyone help to solve this?</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13059241,"title":"org.hibernate.ObjectDeletedException: deleted instance passed to merge","body":"<p>This is my remove method:</p>\n\n<pre><code>public void removeIletisimAdresi(Integer index){\n              getUser().getIletisimBilgileri().remove(getUser().getIletisimBilgileri().get(index))\n        }\n</code></pre>\n\n<p>this is my parent relation</p>\n\n<p>...</p>\n\n<pre><code>@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, targetEntity= IletisimBilgileri.class,  mappedBy = \"user\")\n@Cascade(org.hibernate.annotations.CascadeType.DELETE_ORPHAN)\nprivate List&lt;IletisimBilgileri&gt; iletisimBilgileri = new ArrayList&lt;IletisimBilgileri(0);\n</code></pre>\n\n<p>...</p>\n\n<p>this is my child :</p>\n\n<pre><code>@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"Kullanici\")\nprivate Users user ;\n</code></pre>\n\n<p>so if i call remove method and update parent like entityManager.merge(user),it throws an exception like this:</p>\n\n<p>Caused by: org.hibernate.ObjectDeletedException: deleted instance passed to merge: [com.medikalborsasi.model.IletisimBilgileri#]</p>\n\n<p>..</p>\n\n<p>can you explain and help me how can i solve this problem?</p>\n"},{"tags":["hibernate","grails","criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12938219,"title":"How to create criteria in groovy/grails for nested object?","body":"<p>I need help on creating hibernate criteria for nested object. For example :</p>\n\n<pre><code>class office{\n    Integer id;\n    OfficeDetails cmdData ;\n}\n\nclass OfficeDetails {\n    Integer id;\n    Region region;\n\n}\n\nclass Region {\n    Integer id;\n    Integer regionNum;\n}\n</code></pre>\n\n<p>Now, from the service class ( officeService) I am trying to pull up all of the offices that matches a certain region as :</p>\n\n<pre><code>List&lt;Office&gt; findAllByRegion( Integer regionNumber){\n    def criteria =  {  eq ( 'cmdData.region.regionNum', regionNumber ) }\n    def allOfficesInTheRegion =  Office.findAll(criteria)\n\n    return allOfficesInTheRegion\n}\n</code></pre>\n\n<p>Always getting exception :\"org.hibernate.QueryException: could not resolve property:\"\nI need to find out right way to create criteria for this query.Can anyone help?</p>\n"},{"tags":["hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13052613,"title":"How can I add a guard to a JPA manyToMany join","body":"<p>My testing app for JPA tracks the number of pubs a user has visited in my town. I have this on the user object</p>\n\n<pre><code>@ManyToMany(mappedBy = \"users\")\nprivate List&lt;Pub&gt; visited;\n</code></pre>\n\n<p>And the other side on the pub object</p>\n\n<pre><code>@ManyToMany(cascade = CascadeType.ALL)\n@JoinTable(\n    joinColumns =\n@JoinColumn(name = \"pubid\"),\ninverseJoinColumns =\n@JoinColumn(name = \"userid\"))\nprotected Set&lt;User&gt; users;\n</code></pre>\n\n<p>However, I've updated the pub table with a column indicating that the pub has been closed. I only want the the user's visited List to contain active pubs so the question is</p>\n\n<p><strong>How can I conditionally join these objects so that only pubs that pass a test (e.g. table.closed=false) will be put in the user's visited list?</strong></p>\n\n<p>I'm using hibernate and postgres underneath. </p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13050094,"title":"What is the work around for Hibernate 4 persistence support for org.joda.time.contrib.hibernate.PersistentDateTime","body":"<p>Hi All I am new to Spring and am building application using the following dependencies      </p>\n\n<pre><code> &lt;dependency&gt;\n            &lt;groupId&gt;joda-time&lt;/groupId&gt;\n            &lt;artifactId&gt;joda-time&lt;/artifactId&gt;\n            &lt;version&gt;2.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;joda-time&lt;/groupId&gt;\n            &lt;artifactId&gt;joda-time-hibernate&lt;/artifactId&gt;\n            &lt;version&gt;1.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n            &lt;version&gt;4.1.7.Final&lt;/version&gt;\n        &lt;/dependency&gt;\n                &lt;spring.framework.version&gt;3.1.2.RELEASE&lt;/spring.framework.version&gt;\n</code></pre>\n\n<p>I am not able to persist the objects with fields with datatype DateTime from the class  org.joda.time.contrib.hibernate.PersistentDateTime.</p>\n\n<pre><code>@Column(name = \"LAST_MODIFIED_DATE\")\n    @Type(type = \"org.joda.time.contrib.hibernate.PersistentDateTime\")\n    public DateTime getLastModifiedDate() {\n        return lastModifiedDate;\n    }\n</code></pre>\n\n<p>Can anybody suggest how to use the joda DateTime.</p>\n"},{"tags":["java","hibernate","criteria","query-by-example"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13051914,"title":"Hibernate Example does not find any instance","body":"<p>I gota wired problem.</p>\n\n<p>I use the Hibernate to find entities by Example.</p>\n\n<p>Unfortunately I can not find any instance even if i got I have about 20000 entries in the Table.</p>\n\n<p>My question is, how to debug this problem.</p>\n\n<pre><code>01  Puppy p = new Puppy()\n02  List list = session.createCriteria(Puppy.class).add(Example.create(p)).list();\n03  System.out.println(list.length());\n</code></pre>\n\n<p>Returns 0</p>\n\n<p>EDIT: I even set all n-m and 1-n reations to <i>null</i></p>\n"},{"tags":["hibernate","postgresql","localhost","hibernate.cfg.xml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13064411,"title":"Hibernate bad configurated: Not binding factory to JNDI, no JNDI name configured","body":"<p>This is my \"hibernate.cfg.xml\", i'm trying to connec to my localhost(postgres) and i'm not sure if i'm typing well the values for the parameters (for example the connection url or the others):</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;org.postgresql.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:postgresql://localhost:5432/postgres&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;postgres&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;quesooloroso&lt;/property&gt;\n    &lt;property name=\"connection.autocommit\"&gt;false&lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n    &lt;mapping resource=\"model/Comprobante.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Parametro.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Usuario.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Detalleitinerario.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Configusuario.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Notaalmacen.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Perfilxventana.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Ruta.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Pedido.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Itinerario.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Privilegio.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Modulo.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Ventana.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Perfilxprivilegio.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Persona.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Almacen.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Cargo.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Continente.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Logusuario.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Reservaalmacen.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Tipousuario.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Pais.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Perfil.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Vuelo.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Vueloxruta.hbm.xml\"/&gt;\n    &lt;mapping resource=\"model/Logpedido.hbm.xml\"/&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>This is my the part of my code where my program fails I guess:</p>\n\n<pre><code>public Frm_SimularAlmacen() {\n        //1. Consultar todos los almacenes\n        almacenes_consultaBD = consultarAlmacenes();\n        //2. Armar el String[]\n        initComponents();\n    }\n\nprivate List&lt;Almacen&gt; consultarAlmacenes(){\n    Session session = Utils.openConnection();\n    Query queryResult = session.createQuery(\"from Almacen\");\n    return queryResult.list();\n\n}\n</code></pre>\n\n<p>This is my output:</p>\n\n<pre><code>oct 25, 2012 2:57:20 AM org.hibernate.cfg.annotations.Version &lt;clinit&gt;\nInformación: Hibernate Annotations 3.3.1.GA\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nInformación: Hibernate 3.2.5\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nInformación: hibernate.properties not found\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Environment buildBytecodeProvider\nInformación: Bytecode provider name : cglib\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Environment &lt;clinit&gt;\nInformación: using JDK 1.4 java.sql.Timestamp handling\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration configure\nInformación: configuring from resource: /hibernate.cfg.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration getConfigurationInputStream\nInformación: Configuration resource: /hibernate.cfg.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Comprobante.hbm.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Parametro.hbm.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Usuario.hbm.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Detalleitinerario.hbm.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Configusuario.hbm.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Notaalmacen.hbm.xml\noct 25, 2012 2:57:20 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Perfilxventana.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Ruta.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Pedido.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Itinerario.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Privilegio.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Modulo.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Ventana.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Perfilxprivilegio.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Persona.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Almacen.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Cargo.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Continente.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Logusuario.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Reservaalmacen.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Tipousuario.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Pais.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Perfil.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Vuelo.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Vueloxruta.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration addResource\nInformación: Reading mappings from resource : model/Logpedido.hbm.xml\noct 25, 2012 2:57:21 AM org.hibernate.cfg.Configuration doConfigure\nInformación: Configured SessionFactory: null\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Comprobante -&gt; comprobante\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Parametro -&gt; parametro\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Usuario -&gt; usuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Detalleitinerario -&gt; detalleitinerario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Configusuario -&gt; configusuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Notaalmacen -&gt; notaalmacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Perfilxventana -&gt; perfilxventana\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Ruta -&gt; ruta\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Pedido -&gt; pedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Itinerario -&gt; itinerario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Privilegio -&gt; privilegio\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Modulo -&gt; modulo\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Ventana -&gt; ventana\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Perfilxprivilegio -&gt; perfilxprivilegio\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Persona -&gt; persona\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Almacen -&gt; almacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Cargo -&gt; cargo\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Continente -&gt; continente\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Logusuario -&gt; logusuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Reservaalmacen -&gt; reservaalmacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Tipousuario -&gt; tipousuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Pais -&gt; pais\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Perfil -&gt; perfil\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Vuelo -&gt; vuelo\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Vueloxruta -&gt; vueloxruta\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nInformación: Mapping class: model.Logpedido -&gt; logpedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Parametro.pedidos -&gt; pedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Parametro.comprobantes -&gt; comprobante\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Parametro.vuelos -&gt; vuelo\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Parametro.personasForIdtipodocumento -&gt; persona\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Parametro.personasForIdtipopersona -&gt; persona\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Usuario.logpedidos -&gt; logpedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Usuario.logusuarios -&gt; logusuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Usuario.personas -&gt; persona\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Usuario.notaalmacens -&gt; notaalmacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Usuario.comprobantes -&gt; comprobante\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Configusuario.tipousuarios -&gt; tipousuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Ruta.pedidos -&gt; pedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Ruta.vueloxrutas -&gt; vueloxruta\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Ruta.itinerarios -&gt; itinerario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Pedido.reservaalmacens -&gt; reservaalmacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Pedido.comprobantes -&gt; comprobante\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Pedido.logpedidos -&gt; logpedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Pedido.detalleitinerarios -&gt; detalleitinerario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Itinerario.detalleitinerarios -&gt; detalleitinerario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Privilegio.perfilxprivilegios -&gt; perfilxprivilegio\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Modulo.ventanas -&gt; ventana\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Ventana.logusuarios -&gt; logusuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Ventana.perfilxventanas -&gt; perfilxventana\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Persona.pedidos -&gt; pedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Almacen.reservaalmacens -&gt; reservaalmacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Almacen.vuelosForOrigen -&gt; vuelo\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Almacen.vuelosForDestino -&gt; vuelo\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Cargo.usuarios -&gt; usuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Continente.paises -&gt; pais\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Reservaalmacen.notaalmacens -&gt; notaalmacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Tipousuario.usuarios -&gt; usuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Pais.almacens -&gt; almacen\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Pais.personas -&gt; persona\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Perfil.perfilxventanas -&gt; perfilxventana\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Perfil.usuarios -&gt; usuario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Perfil.perfilxprivilegios -&gt; perfilxprivilegio\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Vuelo.vueloxrutas -&gt; vueloxruta\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Vuelo.detalleitinerarios -&gt; detalleitinerario\noct 25, 2012 2:57:21 AM org.hibernate.cfg.HbmBinder bindCollectionSecondPass\nInformación: Mapping collection: model.Vuelo.logpedidos -&gt; logpedido\noct 25, 2012 2:57:21 AM org.hibernate.cfg.AnnotationConfiguration secondPassCompile\nInformación: Hibernate Validator not found: ignoring\noct 25, 2012 2:57:21 AM org.hibernate.connection.DriverManagerConnectionProvider configure\nInformación: Using Hibernate built-in connection pool (not for production use!)\noct 25, 2012 2:57:21 AM org.hibernate.connection.DriverManagerConnectionProvider configure\nInformación: Hibernate connection pool size: 20\noct 25, 2012 2:57:21 AM org.hibernate.connection.DriverManagerConnectionProvider configure\nInformación: autocommit mode: false\noct 25, 2012 2:57:21 AM org.hibernate.connection.DriverManagerConnectionProvider configure\nInformación: using driver: org.postgresql.Driver at URL: jdbc:postgresql://localhost:5432/postgres\noct 25, 2012 2:57:21 AM org.hibernate.connection.DriverManagerConnectionProvider configure\nInformación: connection properties: {user=postgres, password=****, autocommit=false}\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: RDBMS: PostgreSQL, version: 9.2.1\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: JDBC driver: PostgreSQL Native Driver, version: PostgreSQL 9.1 JDBC4 (build 901)\noct 25, 2012 2:57:22 AM org.hibernate.dialect.Dialect &lt;init&gt;\nInformación: Using dialect: org.hibernate.dialect.PostgreSQLDialect\noct 25, 2012 2:57:22 AM org.hibernate.transaction.TransactionFactoryFactory buildTransactionFactory\nInformación: Using default transaction strategy (direct JDBC transactions)\noct 25, 2012 2:57:22 AM org.hibernate.transaction.TransactionManagerLookupFactory getTransactionManagerLookup\nInformación: No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional second-level cache is not recommended)\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Automatic flush during beforeCompletion(): disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Automatic session close at end of transaction: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: JDBC batch size: 15\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: JDBC batch updates for versioned data: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Scrollable result sets: enabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: JDBC3 getGeneratedKeys(): enabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Connection release mode: auto\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Default batch fetch size: 1\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Generate SQL with comments: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Order SQL updates by primary key: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Order SQL inserts for batching: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory createQueryTranslatorFactory\nInformación: Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory\noct 25, 2012 2:57:22 AM org.hibernate.hql.ast.ASTQueryTranslatorFactory &lt;init&gt;\nInformación: Using ASTQueryTranslatorFactory\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Query language substitutions: {}\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: JPA-QL strict compliance: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Second-level cache: enabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Query cache: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory createCacheProvider\nInformación: Cache provider: org.hibernate.cache.NoCacheProvider\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Optimize cache for minimal puts: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Structured second-level cache entries: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Echoing all SQL to stdout\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Statistics: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Deleted entity synthetic identifier rollback: disabled\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Default entity-mode: pojo\noct 25, 2012 2:57:22 AM org.hibernate.cfg.SettingsFactory buildSettings\nInformación: Named query checking : enabled\noct 25, 2012 2:57:22 AM org.hibernate.impl.SessionFactoryImpl &lt;init&gt;\nInformación: building session factory\noct 25, 2012 2:57:23 AM org.hibernate.impl.SessionFactoryObjectFactory addInstance\nInformación: Not binding factory to JNDI, no JNDI name configured\nHibernate: select almacen0_.idalmacen as idalmacen15_, almacen0_.idpais as idpais15_, almacen0_.latitud as latitud15_, almacen0_.longitud as longitud15_, almacen0_.nombreciudad as nombreci5_15_, almacen0_.nombreaeropuerto as nombreae6_15_, almacen0_.stock as stock15_, almacen0_.fechacreacion as fechacre8_15_, almacen0_.estado as estado15_, almacen0_.capacidad as capacidad15_, almacen0_.nombre as nombre15_, almacen0_.ultimamodificacion as ultimam12_15_ from public.almacen almacen0_\noct 25, 2012 2:57:23 AM org.hibernate.util.JDBCExceptionReporter logExceptions\nAdvertencia: SQL Error: 0, SQLState: 42P01\noct 25, 2012 2:57:23 AM org.hibernate.util.JDBCExceptionReporter logExceptions\nGrave: ERROR: no existe la relación «public.almacen»\n  Position: 451\nException in thread \"AWT-EventQueue-0\" org.hibernate.exception.SQLGrammarException: could not execute query\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.doList(Loader.java:2223)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\n    at org.hibernate.loader.Loader.list(Loader.java:2099)\n    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:378)\n    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:338)\n    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:172)\n    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1121)\n    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:79)\n    at pe.edu.pucp.dp1.TSPSolution.view.sim.almacen.Frm_SimularAlmacen.consultarAlmacenes(Frm_SimularAlmacen.java:29)\n    at pe.edu.pucp.dp1.TSPSolution.view.sim.almacen.Frm_SimularAlmacen.&lt;init&gt;(Frm_SimularAlmacen.java:35)\n    at pe.edu.pucp.dp1.TSPSolution.view.componentes.Index$8.actionPerformed(Index.java:270)\n    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)\n    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)\n    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)\n    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259)\n    at javax.swing.AbstractButton.doClick(AbstractButton.java:376)\n    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(BasicMenuItemUI.java:833)\n    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(BasicMenuItemUI.java:877)\n    at java.awt.Component.processMouseEvent(Component.java:6505)\n    at javax.swing.JComponent.processMouseEvent(JComponent.java:3321)\n    at java.awt.Component.processEvent(Component.java:6270)\n    at java.awt.Container.processEvent(Container.java:2229)\n    at java.awt.Component.dispatchEventImpl(Component.java:4861)\n    at java.awt.Container.dispatchEventImpl(Container.java:2287)\n    at java.awt.Component.dispatchEvent(Component.java:4687)\n    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4832)\n    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4492)\n    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4422)\n    at java.awt.Container.dispatchEventImpl(Container.java:2273)\n    at java.awt.Window.dispatchEventImpl(Window.java:2719)\n    at java.awt.Component.dispatchEvent(Component.java:4687)\n    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:703)\n    at java.awt.EventQueue.access$000(EventQueue.java:102)\n    at java.awt.EventQueue$3.run(EventQueue.java:662)\n    at java.awt.EventQueue$3.run(EventQueue.java:660)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)\n    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)\n    at java.awt.EventQueue$4.run(EventQueue.java:676)\n    at java.awt.EventQueue$4.run(EventQueue.java:674)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)\n    at java.awt.EventQueue.dispatchEvent(EventQueue.java:673)\n    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)\n    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)\n    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)\n    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)\n    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)\n    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97)\nCaused by: org.postgresql.util.PSQLException: ERROR: no existe la relación «public.almacen»\n  Position: 451\n    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2103)\n    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1836)\n    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)\n    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:512)\n    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)\n    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)\n    at org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:186)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:674)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\n    at org.hibernate.loader.Loader.doList(Loader.java:2220)\n    ... 48 more\n</code></pre>\n\n<p>It's my first time with hibernate, so i apologies if i'm not giving enough information or if it's too confusing.</p>\n"},{"tags":["java","hibernate","jpa","jboss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13045123,"title":"Hibernate mapping with embedded interface and superclass","body":"<p>Here is an example of the structure I use. All the classes should go in one table. I need the interfaces and the diffrent implementations to ensure, that the model is correctly used.</p>\n\n<pre><code>// Main model\n@Entity\npublic class Example implements Serializable{\n    // different types of people\n    @NotNull\n    @Valid\n    private Person p;\n    // more stuff here\n}\n\ninterface Person implements Serializable{\n\n   String getName();\n   // more stuff here\n}\n\n\n@Embeddable\n@Inheritance(strategy= InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name=\"typePerson\", discriminatorType=DiscriminatorType.STRING,length=50)\n@DiscriminatorValue(\"AbstractPerson\")\nabstract class AbstractPerson implements Person{\n    // stuff here    \n}\n\n@DiscriminatorValue(\"Employe\")\npublic class Employe extends AbstractPerson{\n    @Column(name=\"something\")\n    private String something;\n}\n\n// and them some other types of people.\n</code></pre>\n\n<p>When using it, the following message ( I tried to translate it) \"...ORA-12899 Value to big for Example.Person....(now: 2746, max: 255) \" is thrown.</p>\n\n<p>It seems to me, that hibernate is trying to put a gigantic String inside of person, instead of mapping an implementation.</p>\n\n<p>I am using JBOSS 7</p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>I switched the debug log to trace:\nHibernates tries to bind a String representation of Abstrat Person: [VARBINARY] - AbstractPerson......\n....\nBinding via setBytes: [3, [B@7f25fc1b]\n...</p>\n\n<pre><code>11:14:54,807 TRACE [org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler] (pool-3-thread-1) Handling invocation of statement method [setBytes]\n11:14:54,807 TRACE [org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler] (pool-3-thread-1) Handling invocation of statement method [setBytes]\n11:14:54,807 TRACE [org.hibernate.engine.jdbc.internal.proxy.PreparedStatementProxyHandler] (pool-3-thread-1) Binding via setBytes: [3, [B@7f25fc1b]\n11:14:54,807 TRACE [org.hibernate.engine.jdbc.internal.proxy.PreparedStatementProxyHandler] (pool-3-thread-1) Binding via setBytes: [3, [B@7f25fc1b]\n11:14:54,808 TRACE [org.hibernate.type.descriptor.sql.BasicBinder] (pool-3-thread-1) binding parameter [4] as [VARCHAR] - 134081 PEC\n11:14:54,808 TRACE [org.hibernate.type.descriptor.sql.BasicBinder] (pool-3-thread-1) binding parameter [4] as [VARCHAR] - 134081 PEC\n11:14:54,808 TRACE [org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler] (pool-3-thread-1) Handling invocation of statement method [setString]\n</code></pre>\n\n<p>When I use @Ebedded with Private Person p - the error goes away, but nothing is beeing put into the DB.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>Sorry, I messed up:</p>\n\n<ul>\n<li>Example has a Object of Person.</li>\n<li>Person is an Interface</li>\n<li>AbstractPerson implements this Interface.</li>\n<li>Employe extends AbstractPerson.</li>\n</ul>\n\n<p>(The code example has been updates)</p>\n\n<p>All the Information should go in one table.</p>\n\n<p>Somthing like this is possible:</p>\n\n<pre><code>Example example = new Example();\nexample.setPerson(new Employe(...));\n</code></pre>\n"},{"tags":["mysql","linux","hibernate","java-ee","character-encoding"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":117,"score":2,"question_id":13063372,"title":"Hibernate + MySQL: How to set the encoding utf-8 for database and tables","body":"<p>My system runs on <strong>Linux Mandriva</strong>, RDBMS - <strong>MySQL 5</strong>.\nI need to have the database and tables created in <strong>UTF-8</strong>.</p>\n\n<p>Here is a fragment of <strong>hibernate.cfg.xml</strong> -</p>\n\n<pre><code>... \n &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;create-drop&lt;/property&gt;   \n &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n &lt;property name=\"hibernate.connection.characterEncoding\"&gt;utf8&lt;/property&gt; \n...\n</code></pre>\n\n<p><strong>my.cnf</strong> -</p>\n\n<pre><code># The MySQL server\n[mysqld]\n...\ndefault-character-set=cp1251\ncharacter-set-server=cp1251\ncollation-server=cp1251_general_ci\ninit-connect=\"SET NAMES cp1251\"\nskip-character-set-client-handshake\n...\n[mysqldump]\n...    \ndefault-character-set=cp1251\n...\n</code></pre>\n\n<p>Some class, for example -</p>\n\n<pre><code>@Entity\n@Table(name = \"USER\")\npublic class User {\n    @Id \n    @Column(name = \"USERID\")\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private Integer id;\n\n    @Column(name = \"USERNAME\")\n    private String name;\n\n    @Column(name = \"USERPASSWORD\")\n    private String password;\n\n    @Column(name = \"USERIP\")\n    private String ip;\n        // getter's and setter's here\n        ...\n</code></pre>\n\n<p>But when the tables are generated, I see the encoding <strong>latin1</strong>\nFor example- </p>\n\n<pre><code>SHOW CREATE TABLE USER;\n\nUSER  | CREATE TABLE `user` (\n  `USERID` int(11) NOT NULL auto_increment,\n  `USERIP` varchar(255) default NULL,\n  `USERNAME` varchar(255) default NULL,\n  `USERPASSWORD` varchar(255) default NULL,\n  PRIMARY KEY  (`USERID`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1 |\n</code></pre>\n\n<p>How to change the encoding to <strong>UTF-8</strong>?</p>\n\n<p>I would be most grateful for the information!\nThank you!</p>\n\n<p>...</p>\n\n<p>This is strange, I have changed all to <strong>utf8</strong> -</p>\n\n<pre><code># The MySQL server\n    [mysqld]\n    ...\n    default-character-set=utf8\n    character-set-server=utf8\n    collation-server=utf8_general_ci\n    init-connect=\"SET NAMES utf8\"\n    skip-character-set-client-handshake\n    ...\n    [mysqldump]\n    ...    \n    default-character-set=utf8\n    ...\n</code></pre>\n\n<p>And now -</p>\n\n<pre><code>SHOW CREATE TABLE USER;\n\nUSER  | CREATE TABLE `USER` (\n  `USERID` int(11) NOT NULL auto_increment,\n  `USERIP` varchar(255) default NULL,\n  `USERNAME` varchar(255) default NULL,\n  `USERPASSWORD` varchar(255) default NULL,\n  PRIMARY KEY  (`USERID`)\n) ENGINE=MyISAM DEFAULT CHARSET=cp1251 |\n</code></pre>\n"},{"tags":["java","hibernate","caching","second-level-cache"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":1466,"score":6,"question_id":7058843,"title":"When and how to use hibernate second level cache?","body":"<p>I have trouble understanding when hibernate hits the second level cache and when does it invalidate the cache.</p>\n\n<p>This is what I currently understand:</p>\n\n<ul>\n<li>Second level cache stores entities between sessions, scope is the SessionFactory</li>\n<li>You have to tell which entities to cache, no entity will get cached by default</li>\n<li>Query cache stores results of queries in the cache.</li>\n</ul>\n\n<p>What I don't understand is when does hibernate hit this cache? Let's say I've set up the second level cache but not the query caching. I want to cache my customers, there's 50000 of them. In what ways can I retrieve the customers from the cache? I assume I can get them by id from cache. That would be easy but also not worthy of caching. But what if I want to do some calculation with all my customers. Let's say I want to show a list of the customers then how would I access them? How would I get all my customers if query caching is disabled? What would happen if someone updated one of the customers? Would that customer get invalidated in the cache or would all customers get invalidated? </p>\n\n<p>Or am I thinking caching totally wrong? What would be more appropriate uses of second level cache in that case? The hibernate documentation is not at all clear how the cache works in reality. There are only instructions on how to get it set up.</p>\n\n<p><strong>Update:</strong>\nSo I've come to understand that second level cache(without query cache) would be good for loading data by id's. For example I have user object that I want to check for permissions in every request in a web application. Would this be a good case to reduce database access by caching the user in the second level cache? Like I would store the user id in the session or wherever and when I need to check for permissions I would load the user by it's id and check permissions.</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2478,"score":0,"question_id":2053040,"title":"hibernate annotation bi-directional mapping","body":"<p>I'm building a web application using Spring framework and Hibernate with annotation and get stuck with a simple mapping between two entities.</p>\n\n<p>I'm trying to create a many-to-many relationship between User and Course. I followed one of the Hibernate tutorials and my implementation is as follows:</p>\n\n<p>User class:</p>\n\n<pre><code>@Entity\n@Table(name=\"USER\")\npublic class User {\n\n    private Long id;\n    private String email;\n    private String password;\n    private Set&lt;Course&gt; courses = new HashSet&lt;Course&gt;(0);\n\n\n    @Id\n    @GeneratedValue\n    @Column(name=\"USER_ID\")\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n\n    @Column(name=\"USER_EMAIL\") \n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    @Column(name=\"USER_PASSWORD\")\n    public String getPassword() {\n        return password;\n    }\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    @ManyToMany(cascade = CascadeType.ALL)\n    @JoinTable(name = \"USER_COURSE\", joinColumns = \n    { @JoinColumn(name = \"USER_ID\") }, \n    inverseJoinColumns = { @JoinColumn(name = \"COURSE_ID\") })\n    public Set&lt;Course&gt; getCourses() {\n        return courses;\n    }\n\n    public void setCourses(Set&lt;Course&gt; courses) {\n        this.courses = courses;\n    } \n}\n</code></pre>\n\n<p>Course class:</p>\n\n<pre><code>@Entity\n@Table(name=\"COURSE\")\npublic class Course {\n\n    private Long id;\n    private String name;\n\n    @Id\n    @GeneratedValue\n    @Column(name=\"COURSE_ID\")\n    public Long getId() {\n        return id;\n    }\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    @Column(name=\"NAME\")\n    public String getName() {\n        return name;\n    }\n    public void setName(String name) {\n        this.name = name;\n    }\n\n}\n</code></pre>\n\n<p>The problem is that this implementation only allows me to go one way</p>\n\n<pre><code>user.getCourses()\n</code></pre>\n\n<p>What do I need to change, so I can go in both directions?</p>\n\n<pre><code>user.getCourses()\ncourse.getUsers()\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["java","spring","hibernate","jsf","annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":59,"score":-2,"question_id":13060059,"title":"Efficiently managing the memory in Java Web Application","body":"<p>I am working with medium sized Java web application. I need to create 25 Spring Managed services and DAO;s and and around 20 JSF Managed beans.Along with this I have around 20 model classes. In this 20 are session scoped beans.How can I effectively do memory management with all the beans. How can I efficiently work with session scoped beans? How much heap memory is required for this kind of application. I am mostly using annoatations.Does this increase my performance.Please suggest.</p>\n"},{"tags":["hibernate","subselect","jointable"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13025887,"title":"HIbernate 4: Mapping last audit row as association property","body":"<p>I need to map two classes Person and PersonAudit:</p>\n\n<pre><code>public class Person implements Serializable {\n\n    private int id;\n    private String name;\n    private PersonAudit personAudit;\n\n    public Person() {\n    }\n\n    //getters and setters omitted\n}\n\npublic class PersonAudit implements Serializable {\n\n    private int id;\n    private Person person;\n    private String name;\n    private String user;\n    private Date date;\n\n    public PersonAudit() {\n    }\n\n    //getters and setters omitted\n}\n</code></pre>\n\n<p>The table PersonAudit stores the historical changes on Person table.</p>\n\n<p>Is it possible to map the <strong>Person.personAudit</strong> property to get always the last audit register, considering that Person table doesn't actually have any column referencing PersonAudit table? </p>\n\n<p>I'm following the Employee-Employment-Organization documentation's example (<a href=\"http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#assoc-complex\" rel=\"nofollow\">http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#assoc-complex</a>) but it seems to work only if Employee table includes an orgId column.</p>\n\n<p>This is the mapping of Person class so far:</p>\n\n<pre><code>&lt;class catalog=\"test\" name=\"test.Person\" table=\"Person\"&gt;\n    &lt;id name=\"id\" type=\"int\"&gt;\n      &lt;column name=\"Id\"/&gt;\n      &lt;generator class=\"increment\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"name\" type=\"string\"&gt;\n      &lt;column length=\"30\" name=\"Name\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n\n    &lt;join table=\"PersonAudit\"&gt; \n        &lt;subselect&gt;\n            select Id,IdPerson\n            from PersonAudit\n            group by IdPerson\n            having Id = max(Id)\n        &lt;/subselect&gt;\n        &lt;key column=\"Id\" /&gt;\n        &lt;many-to-one name=\"personAudit\" class=\"test.PersonAudit\" column=\"???\"/&gt;\n    &lt;/join&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>So, many-to-one isn't the way to go, how can I resolve this scenario?</p>\n\n<p>Any help I'll appreciate, thanks in advance.</p>\n"},{"tags":["java","hibernate","inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13054722,"title":"hibernate generic inheritance","body":"<p>i have a generic class which is superclass of some non-generic class and those are just setting its generic parameter like this:</p>\n\n<pre><code>@ManagedProperty\nclass A&lt;T&gt;{\n    @Id\n    getId(){..}\n    setID(int id){..}\n    int id\n\n    T t;\n    T getT(){...}\n    setT(T t){...}\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>@Entity\nclass B extends A&lt;Integer&gt;{}\n</code></pre>\n\n<p>but i get MappingException which says:</p>\n\n<blockquote>\n  <p>t has an unbound type and no explicit target entity. Resolve this Generic usage issue or set an explicit target attribute.</p>\n</blockquote>\n\n<p>how should i fix it?</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13061746,"title":"How to access hibernate session in Thread?","body":"<p>As Hibernate sessions are not thread-safe, I am not able to get currnet hibernate session through sessionFactory.getCurrentSession(); </p>\n\n<p>If I choose sessionFactory.openSession(); it works fine for thread itself but for nested classes[called from the thread] it wont allow me to access same newly opened session[Throws \"No Session found for current thread\" exception].</p>\n\n<p>I am using Spring 3.1.1 and Hibernate 4.1.3</p>\n\n<p>Is there any way to get the current session in thread?</p>\n\n<p>Or is there any way to access newly opened session to nested classes which are called from the thread? </p>\n"},{"tags":["hibernate","default","validator","isvalid"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13062088,"title":"Hibernate Validator - Setting a default value after entity fails validation","body":"<p>I want to validate the data in my EclipseLink entities before inserting them into the database using Hibernate Validator.</p>\n\n<p>If the validation fails then I want to set default values on those entities.  Then I want to insert the data into the database and flag those entities as having failed validation with the relevant error messages.</p>\n\n<p>Is the best way to do this to use the validator's isValid() method?</p>\n\n<p>I am new to Hibernate Validator, googled and search stackoverflow but couldn't find a question similar to mine.  </p>\n"},{"tags":["spring","hibernate","spring-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":174,"score":0,"question_id":13044127,"title":"Spring MVC 3 with Hibernate 4 integration","body":"<p>My current goal is to enable transaction management in my web app with using Hibernate 4. </p>\n\n<p>Firstly, my web.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app version=\"2.5\" xmlns=\"http://java.sun.com/xml/ns/javaee\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"&gt;\n\n    &lt;!-- The definition of the Root Spring Container shared by all Servlets \n        and Filters --&gt;\n    &lt;context-param&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;\n             /WEB-INF/spring/root-context.xml,\n             /WEB-INF/spring/appServlet/*-context.xml\n        &lt;/param-value&gt;\n    &lt;/context-param&gt;\n\n\n    &lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;\n    &lt;listener&gt;\n        &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n    &lt;/listener&gt;\n\n    &lt;listener&gt;\n        &lt;listener-class&gt;org.springframework.security.web.session.HttpSessionEventPublisher&lt;/listener-class&gt;\n    &lt;/listener&gt;\n\n    &lt;!-- Processes application requests --&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n    &lt;/servlet&gt;\n\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;mvc-dispatcher&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n\n    &lt;!-- Spring Security --&gt;\n    &lt;filter&gt;\n        &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n        &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;\n    &lt;/filter&gt;\n\n    &lt;filter-mapping&gt;\n        &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;\n        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n    &lt;/filter-mapping&gt;\n\n    &lt;session-config&gt;\n        &lt;session-timeout&gt;5&lt;/session-timeout&gt;\n    &lt;/session-config&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>mvc-dispatcher-servlet.xml (renamed from servlet-context.xml):</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans:beans xmlns=\"sec://www.springframework.org/schema/mvc\"\n    xmlns:beans=\"http://www.springframework.org/schema/beans\"\n    xmlns:mvc=\"http://www.springframework.org/schema/mvc\" \n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd\n        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd\n        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd\"&gt;\n\n    &lt;!-- DispatcherServlet Context: defines this servlet's request-processing \n        infrastructure --&gt;\n\n    &lt;context:component-scan base-package=\"com.moose.springmvc.controller\" /&gt;\n\n    &lt;!-- Enables the Spring MVC @Controller programming model --&gt;\n    &lt;mvc:annotation-driven /&gt;\n\n    &lt;!-- Handles HTTP GET requests for /resources/** by efficiently serving \n        up static resources in the ${webappRoot}/resources directory --&gt;\n    &lt;mvc:resources mapping=\"/resources/**\" location=\"resources/\" /&gt;\n\n    &lt;!-- Resolves views selected for rendering by @Controllers to .jsp resources \n        in the /WEB-INF/views directory --&gt;\n    &lt;beans:bean\n        class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n        &lt;beans:property name=\"prefix\" value=\"/WEB-INF/views/\" /&gt;\n        &lt;beans:property name=\"suffix\" value=\".jsp\" /&gt;\n    &lt;/beans:bean&gt;\n\n    &lt;mvc:interceptors&gt;\n        &lt;beans:bean\n            class=\"org.springframework.web.servlet.i18n.LocaleChangeInterceptor\"&gt;\n            &lt;beans:property name=\"paramName\" value=\"lang\" /&gt;\n        &lt;/beans:bean&gt;\n    &lt;/mvc:interceptors&gt;\n&lt;/beans:beans&gt;\n</code></pre>\n\n<p>My database-context.xml (renamed from spring-database.xml) configuration:</p>\n\n<pre><code>&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xmlns:p=\"http://www.springframework.org/schema/p\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd\"&gt;\n\n    &lt;context:component-scan base-package=\"com.moose.springmvc.service,com.moose.springmvc.dao\" /&gt;\n\n    &lt;tx:annotation-driven proxy-target-class=\"true\" transaction-manager=\"transactionManager\"/&gt;\n\n    &lt;bean id=\"transactionManager\"\n        class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"\n        p:sessionFactory-ref=\"sessionFactory\" /&gt;\n\n    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"\n        p:packagesToScan=\"com.moose.springmvc.entity\" p:dataSource-ref=\"dataSource\"\n        p:configLocation=\"classpath:hibernate.cfg.xml\"&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\"&gt;\n        &lt;property name=\"driverClass\" value=\"com.mysql.jdbc.Driver\" /&gt;\n        &lt;property name=\"jdbcUrl\" value=\"jdbc:mysql://localhost:3306/crud\" /&gt;\n        &lt;property name=\"user\" value=\"root\" /&gt;\n        &lt;property name=\"password\" value=\"mysql@123#\" /&gt;\n        &lt;!--  TODO adjust pooling parameters... --&gt;\n    &lt;/bean&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<p>My DAO class:</p>\n\n<pre><code>@Repository\npublic class UserDAO\n{\n    @Autowired\n    private SessionFactory sessionFactory;\n\n    ...\n\n    public int save(User user)\n    {\n        return (Integer) sessionFactory.getCurrentSession().save(user);\n    }\n\n    ...  \n}\n</code></pre>\n\n<p>My Service class:</p>\n\n<pre><code>@Service\n@Transactional\npublic class UserService {\n\n    protected static Logger logger = LoggerFactory\n            .getLogger(UserService.class);\n\n    @Autowired\n    private UserDAO userDAO;\n\n\n    public Integer createUser(User user){\n\n        return userDAO.save(user);\n    }\n}\n</code></pre>\n\n<p>Relevant code for AjaxBootstrapController class:</p>\n\n<pre><code>@Controller\npublic class AjaxBootstrapController {\n    @Autowired\n    private UserService userService;\n\n        ....\n\n    @RequestMapping(value = \"/userAjaxCustomTag\", method = RequestMethod.POST)\n    public String processFormAjax(\n            @ModelAttribute(value = \"user\") @Valid User user,\n            BindingResult result) {\n        if (!result.hasErrors()) {\n            userService.createUser(user);\n        }\n        return \"userForm\";\n    }\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>hibernate.cfg.xml config:</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n        \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n        \"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;!-- Database connection settings --&gt;\n        &lt;property name=\"connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"connection.url\"&gt;jdbc:mysql://localhost:3306/crud&lt;/property&gt;\n        &lt;property name=\"connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"connection.password\"&gt;mysql@123#&lt;/property&gt;\n\n        &lt;!-- JDBC connection pool (use the built-in) --&gt;\n        &lt;property name=\"connection.pool_size\"&gt;1&lt;/property&gt;\n\n        &lt;!-- SQL dialect --&gt;\n        &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n\n        &lt;!-- Disable the second-level cache --&gt;\n        &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.internal.NoCacheProvider&lt;/property&gt;\n\n        &lt;!-- Echo all executed SQL to stdout --&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n\n        &lt;!-- Drop and re-create the database schema on startup\n        &lt;property name=\"hbm2ddl.auto\"&gt;create&lt;/property&gt;\n         --&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>I get new exception : </p>\n\n<pre><code>org.hibernate.HibernateException: save is not valid without active transaction\n    at org.hibernate.context.internal.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:348)\n    at $Proxy31.save(Unknown Source)\n    at com.moose.springmvc.dao.UserDAO.save(UserDAO.java:45)\n    at com.moose.springmvc.service.UserService.createUser(UserService.java:23)\n    at com.moose.springmvc.service.UserService$$FastClassByCGLIB$$60239454.invoke(&lt;generated&gt;)\n    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:191)\n    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)\n    at com.moose.springmvc.service.UserService$$EnhancerByCGLIB$$419f68a0.createUser(&lt;generated&gt;)\n    at com.moose.springmvc.controller.AjaxBootstrapController.processFormAjax(AjaxBootstrapController.java:60)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n</code></pre>\n\n<p>Is there anything wrong with configuration or annotation ?</p>\n"},{"tags":["hibernate","usertype","hibernate.cfg.xml"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13061691,"title":"what is the property name for registering an user type in hibernate","body":"<p>Accoriding to hibernate document: <strong>section 6.5. Type registry</strong>:\n<a href=\"http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/types.html\" rel=\"nofollow\">http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/types.html</a></p>\n\n<p>We can create a new user type and override existing hibernate's basic types. To use the new user type we need to register it using (see above link):</p>\n\n<pre><code>Configuration cfg = ...;\ncfg.registerTypeOverride( new SuperDuperStringType() );\n</code></pre>\n\n<p>But never in document mentioned how we can register it in hibernate.cfg.xml? I can't believe they forgot to add this to hibernate.cfg.xml, Does anybody know about this?\nThanks</p>\n"},{"tags":["hibernate","postgresql","grails","gorm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":104,"score":2,"question_id":12966292,"title":"Grails with PostgreSQL not generating tables","body":"<p>So I have some simple domain classes that I have ensured are not using any PostgreSQL (or any other vendor, for that matter) reserved words. Executing <code>grails schema-export</code> produces a ddl which when run against the same database will successfully execute, and create all tables without issue. </p>\n\n<p>However, when running my grails application, I get the error <code>ERROR: relation \"artist\" does not exist</code>. (artist being the domain I am trying to create a sample of in BootStrap.groovy).</p>\n\n<p>Looking at my database, I can see that none of the tables have been created for my domains. </p>\n\n<p>I have enabled all logging for <code>org.hibernate</code>, but there is nothing there that would indicate any problem. The only issue I can see is that there is no logging that relates to the creation of any tables, only what appears to be sample queries for simple selects.</p>\n\n<p>Here is my DataSource.groovy:</p>\n\n<pre><code>dataSource {\n    pooled = true\n    driverClassName = \"org.postgresql.Driver\"\n    dialect = \"org.hibernate.dialect.PostgreSQLDialect\"\n    username = \"my_username\"\n    password = \"my_password\"\n}\nhibernate {\n    cache.use_second_level_cache = false\n    cache.use_query_cache = false\n    cache.region.factory_class = 'net.sf.ehcache.hibernate.EhCacheRegionFactory'\n}\n// environment specific settings\nenvironments {\n    development {\n        dataSource {\n            dbcreate = \"create-drop\"\n            url = \"jdbc:postgresql://localhost:5432/dev\"\n        }\n    }\n    test {\n        dataSource {\n            dbCreate = \"update\"\n            url = \"jdbc:postgresql://localhost:5432/test\"\n        }\n    }\n    production {\n        dataSource {\n            dbCreate = \"update\"\n            url = \"jdbc:postgresql://localhost:5432/prod\"\n            pooled = true\n            properties {\n               maxActive = -1\n               minEvictableIdleTimeMillis=1800000\n               timeBetweenEvictionRunsMillis=1800000\n               numTestsPerEvictionRun=3\n               testOnBorrow=true\n               testWhileIdle=true\n               testOnReturn=true\n               validationQuery=\"SELECT 1\"\n           }\n       }\n    }\n}\n</code></pre>\n\n<p>I have verified that the credentials (fakes above) are valid, the user has permissions, database is running at the specified location, etc. </p>\n\n<p>Is there anything that I am missing, or any other type of logging that I can enable that will perhaps show what the error is, or aid in finding it?</p>\n\n<p>What I find most curious is that the ddl generated by <code>schema-export</code> runs just fine. Does grails generate the SQL differently at runtime, or is there anything that would cause grails not to execute any of the create statements?</p>\n\n<p>Grails version 2.1.1, PostgreSQL 9.2.1</p>\n\n<p>BootStrap as requested:</p>\n\n<pre><code>import my.site.domain.artist.*\n\nclass BootStrap {\n\n    def init = { servletContext -&gt;\n        System.out.println(\"\\n\")\n        log.info(\"---------------------------------------------------\")\n        log.info(\"BootStrap initializing...\")\n        log.info(\"---------------------------------------------------\")\n        TimeZone.setDefault(TimeZone.getTimeZone(\"UTC\"))\n        log.info(\"Default TimeZone set to \" + TimeZone.getDefault().displayName)\n\n        Artist artist = new Artist(artistName: 'Artist Name', shortBio: \"Short Bio\", biography: \"Bio\", url: \"/some_artist\")\n\n        artist.save()\n        if(artist.hasErrors()) {\n            log.info(artist.errors)\n        } else {\n            log.info(\"--Artist--\")\n            log.info(\"dateCreated: \" + artist.dateCreated)\n            log.info(\"lastUpdated: \" + artist.lastUpdated)\n            log.info(\"mediumImageURL: \" + artist.mediumImageURL)\n        }\n    }\n\n    def destroy = {\n    }\n}\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13059153,"title":"Hibernate criteria when using mapped classes","body":"<p>I have created an object which maps two tables in my database, the Dictionary table and the Token table.   The object (class) that represents the join between these two tables is called DictionaryToken.</p>\n\n<p>Here is the class:</p>\n\n<pre><code>import java.util.List;\n\nimport javax.persistence.CascadeType;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\n import javax.persistence.FetchType;\n import javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\n import javax.persistence.Id;\nimport javax.persistence.OneToMany;\n import javax.persistence.Table;\n\nimport org.apache.log4j.Logger;\n\n\n@Entity\n@Table(name=\"dictionary\", catalog=\"emscribedxcode\")\n</code></pre>\n\n<p>public class DictionaryToken {\n    private static Logger  LOG = Logger.getLogger(DictionaryToken.class);</p>\n\n<pre><code>private Long _seq;\nprivate String _code;\nprivate String _acute;\nprivate String _gender;\nprivate String _codeType;\nprivate String _papplydate;\nprivate String _capplydate;\nprivate Long _tokenLength;\nprivate List &lt;TokenDictionary&gt; _token;\nprivate int _type;\nprivate String _system;\nprivate String _physicalsystem;\n/*\n * type of 0 is a straight line insert type of 1 is a language dictionary\n * entyr type of 2 is a multiple token entry\n */\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Column(name = \"seq\")\npublic Long getSeq() {\n    return _seq;\n}\npublic void setSeq(Long seq_) {\n    _seq = seq_;\n}\n\n@Column(name = \"code\")\npublic String getCode() {\n    return _code;\n}\npublic void setCode(String code_) {\n    _code = code_;\n}\n\n@Column(name = \"acute\")\npublic String getAcute() {\n    return _acute;\n}\npublic void setAcute(String acute_) {\n    _acute = acute_;\n}\n\n@Column(name = \"gender\")\npublic String getGender() {\n    return _gender;\n}\npublic void setGender(String gender_) {\n    _gender = gender_;\n}\n\n@Column(name = \"codetype\")\npublic String getCodeType() {\n    return _codeType;\n}\npublic void setCodeType(String codeType_) {\n    _codeType = codeType_;\n}\n\n@Column(name = \"papplydate\")\npublic String getPapplydate() {\n    return _papplydate;\n}\npublic void setPapplydate(String papplydate_) {\n    _papplydate = papplydate_;\n}\n\n@Column(name = \"capplydate\")\npublic String getCapplydate() {\n    return _capplydate;\n}\npublic void setCapplydate(String capplydate_) {\n    _capplydate = capplydate_;\n}\n\n\n@Column(name = \"token_length\")\npublic Long getTokenLength() {\n    return _tokenLength;\n}\npublic void setTokenLength(Long tokenLength_) {\n    _tokenLength = tokenLength_;\n}\n@OneToMany (mappedBy = \"dictionarytoken\", targetEntity = TokenDictionary.class, cascade = CascadeType.ALL, fetch = FetchType.EAGER)\npublic List&lt;TokenDictionary&gt; get_token() {\n    return _token;\n}\npublic void set_token(List&lt;TokenDictionary&gt; _token) {\n    this._token = _token;\n}\npublic void addToToken(TokenDictionary token){\n    this._token.add(token);\n}\n@Column(name = \"type\")\npublic int getType() {\n    return _type;\n}\npublic void setType(int _type) {\n    this._type = _type;\n}\n@Column(name = \"physicalsystem\")\npublic String get_physicalsystem() {\n    return _physicalsystem;\n}\npublic void set_physicalsystem(String _physicalsystem) {\n    this._physicalsystem = _physicalsystem;\n}\n@Column(name = \"codingsystem\")\npublic String get_system() {\n    return _system;\n}\npublic void set_system(String _system) {\n    this._system = _system;\n}\n\n\n\n   }\n</code></pre>\n\n<p>Here is my problem.    I can perform queries using a service with this object with no problems UNLESS I add a criteria.  Here is the method which retrieves the entries</p>\n\n<pre><code>public List&lt;DictionaryToken&gt; getDictionaryTokenEntries(String system) {\n    Session session = null;\n    List&lt;DictionaryToken&gt; dictonaries = new ArrayList&lt;DictionaryToken&gt;();\n    try {\n        session = HibernateUtils.beginTransaction(\"emscribedxcode\");\n           session.createCriteria(Dictionary.class).addOrder(Order.desc(\"codeType\"))\n\n        Criteria criteria = session.createCriteria(DictionaryToken.class);\n                  /*******THIS IS THE PROBLEM STATEMENT*************************/\n        if (system != null) {\n            criteria.add(Restrictions.eq(\"codingsystem\", system));\n        }\n                  /****************************************************************/\n        // dictonaries = criteria.list();\n        Order order = Order.asc(\"seq\");\n        criteria.addOrder(order);\n        dictonaries = criteria.list();\n        System.out.println(\"Dictionaryentries = \" + dictonaries.size());\n\n        // System.out.println(\"Dictionaries entries EVICT start...\");\n        // for(Dictionary dic : dictonaries){\n        // session.evict(dic);\n        // }\n        // System.out.println(\"Dictionaries entries EVICT end\");\n    } catch (HibernateException e_) {\n        e_.printStackTrace();\n        NTEVENT_LOG.error(\"Error while getting List of Dictionary entries\");\n    } finally {\n        if (session != null &amp;&amp; session.isOpen()) {\n            try {\n                HibernateUtils.closeSessions();\n            } catch (HibernateException e) {\n                // TODO Auto-generated catch block\n                e.printStackTrace();\n            }\n        }\n    }\n    return dictonaries;\n}\n</code></pre>\n\n<p>When I add the criteria, I get the following error:</p>\n\n<p>org.hibernate.QueryException:  could not resolve property: coding system of : com.artificialmed.domain.dictionary.model.DictionaryToken</p>\n\n<p>I know that it has something to do with the nature of the object which is really a join between my dictionary class and the underlying table and my token class and table.   </p>\n\n<p>The field codingsystem is a field in my dictionary class.    I think I am suppose to use aliases but I don't know how to do this under the current circumstances.    Any help would be greatly appreciated.</p>\n\n<p>Elliott</p>\n"},{"tags":["mysql","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2988,"score":2,"question_id":4969258,"title":"Select one column from a row in hibernate","body":"<p>I am trying to do a simple query to get a unique result back in hibernate here is my code.</p>\n\n<pre><code>public String getName(Integer id) {\n     Session session = getSessionFactory().openSession();\n     String name = (String)session.createSQLQuery(\"SELECT name FROM users WHERE user_id = :userId\").setParameter(\"userId\", id).uniqueResult();\n     return name;\n}\n</code></pre>\n\n<p>The name that is being returned is stored as HTML text that includes html syntacx language. I think this is what is causing the problem but it doesnt make sense I just want to return it as a string.</p>\n\n<p>It is only happening on this one field name, I can get every other field in the row but this one it gives me the error.</p>\n\n<p>I am getting an exception. The exception I am getting is</p>\n\n<blockquote>\n  <p>No Dialect mapping for JDBC type: -1; nested exception is org.hibernate.HibernateException</p>\n</blockquote>\n\n<p>How do you query for a specific column on a row in hibernate?</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":12075327,"title":"Issue with Spring Hibernate PostgreSQL configuration","body":"<p>I am getting various issues with configuration of spring hibernate and postgresql. I try to resolve one issue and i get some different issue. \nI am using spring 3.1.0 release version and hibernate 4.1.4.Final\nI am getting error BeanFactory not initialized or already closed - call 'refresh' before accessing beans via the ApplicationContext</p>\n\n<p>and my web.xml is </p>\n\n<pre><code>&lt;web-app id=\"WebApp_ID\" version=\"2.4\"\n    xmlns=\"http://java.sun.com/xml/ns/j2ee\" \n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\"&gt;\n&lt;servlet&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;*.htm&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n&lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;/WEB-INF/dispatcher-servlet.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>And my dispatcher-servlet is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:aop=\"http://www.springframework.org/schema/aop\"\nxmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:util=\"http://www.springframework.org/schema/util\"\nxmlns:context=\"http://www.springframework.org/schema/context\"\nxsi:schemaLocation=\"\n   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n   http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n   http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd\n   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd\n   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd\"&gt;\n&lt;mvc:annotation-driven&gt; &lt;/mvc:annotation-driven&gt;\n&lt;context:component-scan base-package=\"com.max.ade.common.model\" /&gt;\n&lt;context:component-scan base-package=\"com.max.ade.daoImpl\" /&gt;\n&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"org.postgresql.Driver\" /&gt;\n    &lt;property name=\"url\" value=\"jdbc:postgresql://localhost:5432/TestUserDB\" /&gt;\n    &lt;property name=\"username\" value=\"postgres\" /&gt;\n    &lt;property name=\"password\" value=\"root123\" /&gt;\n&lt;/bean&gt;\n&lt;bean id=\"viewResolver\"\n    class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n    &lt;property name=\"prefix\"&gt;\n        &lt;value&gt;/WEB-INF/pages/&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"suffix\"&gt;\n        &lt;value&gt;.jsp&lt;/value&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n&lt;bean id=\"sessionFactory\"\n    class=\"org.springframework.orm.hibernate4.annotation.AnnotationSessionFactoryBean\"&gt;\n\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"configLocation\" value=\"classpath:hibernate.cfg.xml\" /&gt;\n    &lt;!-- Scan packages for annotated entities --&gt;\n    &lt;property name=\"packagesToScan\" value=\"com.max.ade.common.model\" /&gt;\n&lt;/bean&gt;\n&lt;!-- Transaction support beans --&gt;\n&lt;bean id=\"transactionManager\"\n    class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n&lt;tx:annotation-driven transaction-manager=\"transactionManager\"&gt;&lt;/tx:annotation-  driven&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<p>And after issue resolving, above is my file structure for dispatcher-servlet.xml. \nAre configuration things work differently with hibernate 3.6.4 and hibernate 4.1.4 beside issue mentioned (BeanFactory not initialized or already closed - call 'refresh' before accessing beans via the ApplicationContext)</p>\n\n<p>Any concrete pointer will be great help. </p>\n\n<p>Thanks. </p>\n"},{"tags":["java","hibernate","deadlock"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":173,"score":1,"question_id":12807890,"title":"hibernate exception LockAcquisitionException: could not update","body":"<p>In my application I am using Java ,Hibernate(Annotations) and mySQL.\nIt's working fine most of the time, but this error happens occasionally:</p>\n\n<pre><code>SEVERE: Could not synchronize database state with session\norg.hibernate.exception.LockAcquisitionException: could not update: [myPack.Analysis$TestRun#5191]\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:107)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2596)\n    at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2478)\n    at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2805)\n    at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:114)\n    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:268)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:260)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:180)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1206)\n    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:375)\n    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)\n    at myPack.Analysis.fileHelper(Analysis.java:977)\n    at myPack.Analysis.dirHelper(Analysis.java:702)\n    at myPack.Analysis.dirHelper(Analysis.java:714)\n    at myPack.Analysis.dirHelper(Analysis.java:714)\n    at myPack.Analysis.dirHelper(Analysis.java:714)\n    at myPack.Analysis.dirHelper(Analysis.java:714)\n    at myPack.Analysis.dirHelper(Analysis.java:711)\n    at myPack.Analysis.parseLog(Analysis.java:682)\n    at myPack.Analysis.main(Analysis.java:614)\n</code></pre>\n\n<p>The most suspicious line in <code>Analysis.java</code> is:</p>\n\n<pre><code>dbPerson = (Person) session.get(Person.class, dbPersonId, LockOptions.READ);\n</code></pre>\n\n<p>What I did is grab the row with the <code>dbPersonId</code> and update/change the row contents as needed. For example:</p>\n\n<pre><code>dbPerson.Name = \"Jack\";\ndbPerson.Age ++;\nsession.saveOrUpdate(dbPerson);\n</code></pre>\n\n<p>I am guessing something's wrong with the <code>LockOptions</code> and\nI tried using different lockoptions such as <code>NONE, UPGRADE</code>... but still no luck.</p>\n\n<p>The most frustrated thing is I can't even reproduce this error manually. It only happens once a while when Analysis.java are called multiple times.</p>\n\n<p>I know session is not thread-safe, but I am not sure whether this is related to that.</p>\n\n<p>Any idea would be appreciated, thank you very much!</p>\n"},{"tags":["java","mysql","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13057266,"title":"Hibernate Parent Child Same Table Error","body":"<p>I have a problem with Hibernate using a parent child relationship in the same table.  I can do selects and inserts but I can not delete.  I wrote a JUnit test to see what was going on and found some odd behavior.</p>\n\n<p>Here is how I define my table:</p>\n\n<pre><code>CREATE TABLE `product` (\n  `productId` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(50) NOT NULL,\n  `parentProductId` bigint(20) NULL DEFAULT NULL,\n  PRIMARY KEY (`productId`),\n  CONSTRAINT `FK_PARENTPRODUCT` FOREIGN KEY (`parentProductId`) REFERENCES `product` (`productId`)\n) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;\n</code></pre>\n\n<p>My Product class looks like :</p>\n\n<pre><code>@Entity\n@Table(name = \"product\")\npublic class Product {\n\n    private Long productId;\n    private String name;\n    private Product parentProduct;\n    private Set&lt;Product&gt; children;\n    private List&lt;CustomerProduct&gt; productCustomers;\n\n    public Product() {\n    }\n\n    public Product(Long productId, String name) {\n        this.productId = productId;\n        this.name = name;\n    }\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    public Long getProductId() {\n        return productId;\n    }\n\n    public void setProductId(Long productId) {\n        this.productId = productId;\n    }\n\n    @NotNull\n    @Size(min = 1, max = 50)\n    public String getName() {\n    return name;\n    }\n\n    public void setName(String name) {\n    this.name = name;\n    }\n\n    @ManyToOne\n    @JoinColumn(name = \"parentProductId\")\n    public Product getParentProduct() {\n        return parentProduct;\n    }\n\n    public void setParentProduct(Product parentProduct) {\n        this.parentProduct = parentProduct;\n    }\n\n    @OneToMany(mappedBy = \"parentProduct\", fetch = FetchType.EAGER)\n    public Set&lt;Product&gt; getChildren() {\n        return children;\n    }\n\n    public void setChildren(Set&lt;Product&gt; children) {\n        this.children = children;\n    }\n\n    @OneToMany(mappedBy = \"product\")\n    public List&lt;CustomerProduct&gt; getProductCustomers() {\n        return productCustomers;\n    }\n\n    public void setProductCustomers(List&lt;CustomerProduct&gt; productCustomers) {\n        this.productCustomers = productCustomers;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        final Product other = (Product) obj;\n        if (this.productId != other.productId\n            &amp;&amp; (this.productId == null || !this.productId.equals(other.productId)))\n                return false;\n        if ((this.name == null) ? (other.name != null) : !this.name.equals(other.name))\n            return false;\n        return true;\n    }\n\n    @Override\n    public int hashCode() {\n        int hash = 7;\n        hash = 31 * hash + name.length();\n        hash = 31 * hash + (name == null ? 0 : name.hashCode());\n        return hash;\n    }\n\n    @Override\n    public String toString() {\n        return \"Product [productId=\" + productId + \", name=\" + name + \"]\";\n    }\n}\n</code></pre>\n\n<p>I wrote a few JUnit tests which are:</p>\n\n<pre><code>@Test\n@Transactional(readOnly=true)\npublic void getProductNoChildren() {\n    Product p = productService.getProductById(Long.parseLong(\"1\"));\n    assertNotNull(p);\n    assertTrue(p.getName().equals(\"Test\"));\n    assertNull(p.getParentProduct());\n    assertTrue(p.getChildren().size() == 0);\n}\n\n@Test\n@Transactional(readOnly=true)\npublic void getProductWithChildren() {\n    Product p = productService.getProductById(Long.parseLong(\"10\"));\n    assertNotNull(p);\n    assertTrue(p.getName().equals(\"Test_2\"));\n    assertNull(p.getParentProduct());\n    assertTrue(p.getChildren().size() &gt; 0);\n}\n\n@Test\n@Transactional(readOnly=true)\npublic void getProductWithParent() {\n    Product p = productService.getProductById(Long.parseLong(\"20\"));\n    assertNotNull(p);\n    assertTrue(p.getName().equals(\"Test_3\"));\n    assertNotNull(p.getParentProduct());\n    assertTrue(p.getParentProduct().getProductId() == Long.parseLong(\"2\"));\n    assertTrue(p.getChildren().size() == 0);\n}\n</code></pre>\n\n<p>The first 2 tests pass.  The 3rd always fails with a NullPointerException on the 2nd line of the hashcode method.  Says name is null.  I verified this only happens when a parentProductId is set.  I can not figure out why this is happening.  The name should never be null.  Do I have an error in the way I defined the hibernate annotations for my class?</p>\n\n<p>Here is my stacktrace if anyone is interested.....</p>\n\n<pre><code>java.lang.NullPointerException\nat com.symmetry.security.model.Product.hashCode(Product.java:145)\nat java.util.HashMap.put(HashMap.java:372)\nat java.util.HashSet.add(HashSet.java:200)\nat java.util.AbstractCollection.addAll(AbstractCollection.java:305)\nat org.hibernate.collection.PersistentSet.endRead(PersistentSet.java:352)\nat org.hibernate.engine.loading.CollectionLoadContext.endLoadingCollection(CollectionLoadContext.java:261)\nat org.hibernate.engine.loading.CollectionLoadContext.endLoadingCollections(CollectionLoadContext.java:246)\nat org.hibernate.engine.loading.CollectionLoadContext.endLoadingCollections(CollectionLoadContext.java:219)\nat org.hibernate.loader.Loader.endCollectionLoad(Loader.java:1005)\nat org.hibernate.loader.Loader.initializeEntitiesAndCollections(Loader.java:993)\nat org.hibernate.loader.Loader.doQuery(Loader.java:857)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:2037)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:86)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:76)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3293)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:496)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:477)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:227)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:285)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:152)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:1090)\nat org.hibernate.impl.SessionImpl.internalLoad(SessionImpl.java:1038)\nat org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:630)\nat org.hibernate.type.EntityType.resolve(EntityType.java:438)\nat org.hibernate.engine.TwoPhaseLoad.initializeEntity(TwoPhaseLoad.java:139)\nat org.hibernate.loader.Loader.initializeEntitiesAndCollections(Loader.java:982)\nat org.hibernate.loader.Loader.doQuery(Loader.java:857)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:274)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:2037)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:86)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:76)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:3293)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:496)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:477)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:227)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:285)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:152)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:1090)\nat org.hibernate.impl.SessionImpl.get(SessionImpl.java:1005)\nat org.hibernate.impl.SessionImpl.get(SessionImpl.java:998)\nat com.symmetry.security.dao.hibernate.HibernateAbstractDao.findById(HibernateAbstractDao.java:52)\nat com.symmetry.security.dao.hibernate.HibernateAbstractDao$$FastClassByCGLIB$$b227fdff.invoke(&lt;generated&gt;)\nat net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:191)\nat org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\nat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\nat org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)\nat com.symmetry.security.dao.hibernate.HibernateProductDao$$EnhancerByCGLIB$$415fcf17.findById(&lt;generated&gt;)\nat com.symmetry.security.service.ProductServiceImpl.getProductById(ProductServiceImpl.java:42)\nat com.symmetry.security.service.ProductServiceImpl$$FastClassByCGLIB$$8b8f4a88.invoke(&lt;generated&gt;)\nat net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:191)\nat org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\nat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\nat org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)\nat com.symmetry.security.service.ProductServiceImpl$$EnhancerByCGLIB$$b032e753.getProductById(&lt;generated&gt;)\nat com.symmetry.security.service.ProductServiceImplUnitTest.getProductWithParent(ProductServiceImplUnitTest.java:87)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\nat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\nat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\nat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\nat org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)\nat org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)\nat org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)\nat org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)\nat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)\nat org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\nat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\nat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\nat org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\nat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\nat org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\nat org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\nat org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\nat org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)\nat org.junit.runners.ParentRunner.run(ParentRunner.java:236)\nat org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)\nat org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)\nat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\nat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\nat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\nat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\nat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["java","spring","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13055910,"title":"What are the causes for javax.persistence.TransactionRequiredException: no transaction is in progress","body":"<p>What are the causes for </p>\n\n<pre><code>javax.persistence.TransactionRequiredException: no transaction is in progress  at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:971)\n</code></pre>\n\n<p>Even after having </p>\n\n<ul>\n<li><p><code>&lt;tx:annotation-driven/&gt;</code> in applicationContext</p></li>\n<li><p>methods annotated with @Transactional</p></li>\n</ul>\n\n<p>In Spring 3.1.1 + Hibernate 4.1</p>\n"},{"tags":["hibernate","domain-driven-design","ejb-3.0","repository-pattern","data-access-layer"],"answer_count":6,"favorite_count":5,"up_vote_count":19,"down_vote_count":0,"view_count":3129,"score":19,"question_id":8550124,"title":"What is the difference between DAO and Repository patterns","body":"<p>What is the difference between the two.  I am developing and application using EJB3 and Hibernate as infrastructure and DDD and TDD as design techniques.</p>\n"},{"tags":["hibernate","maven","jboss","annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":53,"score":-4,"question_id":13047539,"title":"Access denied to http://repository.jboss.com/maven2/","body":"<p>I tried to add hibernate annotation to my Maven project but I had this following error : </p>\n\n<blockquote>\n  <ul>\n  <li>ArtifactDescriptorException: Failed to read artifact descriptor for hibernate-commons-annotations:hibernate-commons-annotations:jar:3.0.0.GA: \n  ArtifactResolutionException: Failure to transfer hibernate-commons-annotations:hibernate-commons-annotations:pom:3.0.0.GA from http://\n  repository.jboss.com/maven2/ was cached in the local repository, resolution will >not be reattempted until the update interval of JBoss repository has elapsed \n  or updates are forced. Original error: Could not transfer artifact hibernate->commons-annotations:hibernate-commons-annotations:pom:3.0.0.GA from/to \n  JBoss repository (http://repository.jboss.com/maven2/): Access denied to >http://repository.jboss.com/maven2/hibernate-commons-annotations/hibernate-\n  commons-annotations/3.0.0.GA/hibernate-commons-annotations-3.0.0.GA.pom. Error >code 403, Forbidden\n  <ul>\n  <li>ArtifactDescriptorException: Failed to read artifact descriptor for hibernate->annotations:hibernate-annotations:jar:3.3.0.GA: \n  ArtifactResolutionException: Failure to transfer hibernate-annotations:hibernate->annotations:pom:3.3.0.GA from <a href=\"http://repository.jboss.com/maven2/\" rel=\"nofollow\">http://repository.jboss.com/maven2/</a> was \n  cached in the local repository, resolution will not be reattempted until the >update interval of JBoss repository has elapsed or updates are forced. Original \n  error: Could not transfer artifact hibernate-annotations:hibernate->annotations:pom:3.3.0.GA from/to JBoss repository (http://repository.jboss.com/\n  maven2/): Access denied to <a href=\"http://repository.jboss.com/maven2/hibernate-\" rel=\"nofollow\">http://repository.jboss.com/maven2/hibernate-</a>>annotations/hibernate-annotations/3.3.0.GA/hibernate-\n  annotations-3.3.0.GA.pom. Error code 403, Forbidden</li>\n  </ul></li>\n  </ul>\n</blockquote>\n\n<p>I use this code </p>\n\n<pre><code>&lt;repository&gt;\n  &lt;id&gt;JBoss repository&lt;/id&gt;\n  &lt;url&gt;http://repository.jboss.com/maven2/&lt;/url&gt;\n&lt;/repository&gt;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>&lt;!-- Hibernate annotation --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;hibernate-annotations&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n    &lt;version&gt;3.3.0.GA&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;hibernate-commons-annotations&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-commons-annotations&lt;/artifactId&gt;\n    &lt;version&gt;3.0.0.GA&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n"},{"tags":["java","spring","hibernate","junit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13051090,"title":"Spring, Hibernate and AbstractTransactionalJUnit4SpringContextTests: objects with multiple mappings to same underlying data cannot be found","body":"<p>I have successfully created numerous database-related unit tests for a Spring 2.5.6/Hibernate 3.5.3 project using <a href=\"http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/test/context/junit4/AbstractTransactionalJUnit4SpringContextTests.html\" rel=\"nofollow\">AbstractTransactionalJUnit4SpringContextTests</a>. One example, where a Device object is created and then verified that the same object is included in the list of all Device objects:</p>\n\n<pre><code>@ContextConfiguration(locations = { \"classpath:/UnitTests-context.xml\" })\n@RunWith(SpringJUnit4ClassRunner.class)\npublic class DeviceDaoTests extends AbstractTransactionalJUnit4SpringContextTests {\n\n    @Test\n    public void testGetDeviceList() {\n        Device device = new Device();\n        this.sessionFactory.getCurrentSession().merge(device);\n\n        Query myQuery = this.sessionFactory.getCurrentSession().createQuery(\"from Device\");\n        List&lt;Device&gt; allDevices = myQuery.list();\n        assertTrue(allDevices.contains(device);\n    }\n}\n</code></pre>\n\n<p>This test works.</p>\n\n<p>The Device class, which is mapped to a table named DEVICES:</p>\n\n<pre><code>@Entity\n@Table(name = \"DEVICES\")\npublic class Device {\n\n//properties omitted for brevity and readability\n\n}\n</code></pre>\n\n<p>There is also a class named DeviceListItem, which is mapped to a database view named DEVICESLIST_VIEW containing parts of the DEVICES table (as well as other tables):</p>\n\n<pre><code>@Entity\n@Table(name = \"DEVICESLIST_VIEW\")\npublic class DeviceListItem {\n\n//properties omitted for brevity and readability\n\n}\n</code></pre>\n\n<p>Now if I want to test that inserting a Device in the database results in a DeviceListItem with the same id being found from the list of all DeviceListItem  objects (similarily to the first test), there is a problem - the following test fails:</p>\n\n<pre><code>   @Test\n   public void testGetDeviceListItemList() {\n      Device device = new Device();\n      this.sessionFactory.getCurrentSession().merge(device);\n\n      Query myQuery = this.sessionFactory.getCurrentSession().createQuery(\"from DeviceListItem\");\n      List&lt;DeviceListItem&gt; allDeviceListItems = myQuery.list();\n      assertTrue(allDeviceListItems.get(0).getId().equals(device.getId())\n  }\n</code></pre>\n\n<p>All the mappings, DAO classes etc. work when running the application on the web server - only the aforementioned unit test fails. This is probably because a new object of type Device is saved, but the items read are of type DeviceListItem and Hibernate does not \"know\" that they both refer to the same underlying database table and becase the objects are not really saved to the database.</p>\n\n<p>Is there a way to make this test work, i.e. to test the scenario where a Device object is written to the database and read from the database as a DeviceListItem object?</p>\n\n<p>(Please note that there might by typos, style issues etc. in the code examples, as the examples are strongly simplified and are not necessarily copy/pasted from actually executed code)</p>\n"},{"tags":["java","spring","hibernate","transactions","spring-transactions"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13051204,"title":"Spring transaction REQUIRED vs REQUIRES_NEW : Rollback Transaction","body":"<p>I have a method that have the <code>propagation = Propagation.REQUIRES_NEW</code> transactional property:</p>\n\n<pre><code>@Transactional(propagation = Propagation.REQUIRES_NEW)\npublic void createUser(final UserBean userBean) {\n    //Some logic here that requires modification in DB\n}\n</code></pre>\n\n<hr>\n\n<p>This method can be called multiple times simultaneously, and for every transaction if an error occurs than it's rolled back (independently from the other transactions).</p>\n\n<p>The problem is that this might force Spring to create multiple transactions, even if another one is available, and may cause some performance problems.</p>\n\n<hr>\n\n<p>Java doc of <code>propagation = Propagation.REQUIRED</code> says: <code>Support a current transaction, create a new one if none exists.</code></p>\n\n<p>This seems to solve the performance problem, doesn't it?</p>\n\n<p>What about the rollback issue ? What if a new method call rolls back while using an existing transaction ? won't that rollback the whole transaction even the previous calls ?</p>\n\n<p><strong>[EDIT]</strong>\nI guess my question wasn't clear enough:</p>\n\n<p>We have hundreds of clients connected to our server. </p>\n\n<p>For each client we naturally need to send a feedback about the transaction (OK or exception -> rollback). </p>\n\n<p>My question is: if I use <code>REQUIRED</code>, does it mean only one transaction is used, and if the 100th client encounters a problem the 1st client's transaction will rollback as well ?</p>\n"},{"tags":["hibernate","jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13052717,"title":"Hibernate override @transient","body":"<p>I have a mapped super class, which has a field that some of the tables in my DB share. </p>\n\n<p>I wish to annotate this field with @Transient so most entities will ignore it, but de-@Transient or un-@Transient it on child entities.</p>\n\n<p>Is this possible?</p>\n\n<p>Thank you,\nIdob</p>\n"},{"tags":["java","spring","hibernate","jpa-2.0"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":905,"score":1,"question_id":6843198,"title":"JPA/Hibernate remove all in Entity","body":"<p>I have this Entity Class</p>\n\n<pre><code>public class Entity {\n\n    @Id \n    @Column(name=\"ID\")\n    private int id;\n\n    @OneToMany(mappedBy=\"flusso\", cascade=CascadeType.ALL, orphanRemoval=true)\n    private List&lt;Cron&gt; listCron;\n\n    //getter and setter Method\n}\n</code></pre>\n\n<p>and in my Dao Class i have this method</p>\n\n<pre><code>(...)\n    @Transactional\n    public void removeAll(Entity entity) throws PersistenceDaoException {\n        try {\n            final Class&lt;? extends Object&gt; paramClass = entity.getClass();\n            String nameClass = paramClass.getSimpleName();\n            Query q = em.createQuery (\"DELETE FROM \" + nameClass);\n            int del = q.executeUpdate ();\n            if (del == 1){\n                System.out.println(\"risultato:\" + del);\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n(...)\n</code></pre>\n\n<p>I do a simple test and i have this problem:</p>\n\n<pre><code>javax.persistence.TransactionRequiredException: Executing an update/delete query\n    at org.hibernate.ejb.AbstractQueryImpl.executeUpdate(AbstractQueryImpl.java:96)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:310)\n    at $Proxy24.executeUpdate(Unknown Source)\n    at it.synclab.fb.jpa.dao.impl.GenericDaoImpl.removeAll(GenericDaoImpl.java:138)\n    at it.synclab.fb.jpa.dao.impl.FlussoDaoImpl.removeAll(FlussoDaoImpl.java:143)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:196)\n    at $Proxy22.removeAll(Unknown Source)\n    at it.synclab.fb.jpa.test.FlussoDaoTest.main(FlussoDaoTest.java:30)\n</code></pre>\n\n<p>This method is marked with @Transactional, where am I doing wrong?</p>\n\n<p>PS:This is my applicationContext.xml:</p>\n\n<pre><code>&lt;bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalEntityManagerFactoryBean\"&gt;\n        &lt;property name=\"persistenceUnitName\" value=\"fb-persistence\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt; \n        &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\"/&gt; \n    &lt;/bean&gt;\n\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n\n    &lt;bean class=\"org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor\" /&gt;\n\n\n    &lt;bean name=\"entityDaoImpl\" class=\"it.synclab.fb.jpa.dao.impl.EntityDaoImpl\" /&gt;\n</code></pre>\n"},{"tags":["hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13034480,"title":"javax.faces.FacesException: #{loginBean.authenticate}: java.lang.NullPointerException","body":"<p>in an application I m using JPA + hibernate. However when I m trying to access the db I m getting the following error :</p>\n\n<pre><code> java.lang.NullPointerException: javax.faces.FacesException:\n#{loginBean.authenticate}: java.lang.NullPointerException\n</code></pre>\n\n<p>the exception occurs when i execute the line: <code>EntityManager em = emf.createEntityManager();</code></p>\n\n<p>Below you see the full serverlog.</p>\n\n<pre><code>18:21:48,174 INFO  [org.hibernate.engine.transaction.internal.TransactionFactoryInitiator] (http--0.0.0.0-8080-1) HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory\n\n18:21:48,177 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (http--0.0.0.0-8080-1) HHH000397: Using ASTQueryTranslatorFactory\n\n18:21:48,189 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000228: Running hbm2ddl schema update\n\n18:21:48,191 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000102: Fetching database metadata\n\n18:21:48,193 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000396: Updating schema\n\n18:21:48,195 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000232: Schema update complete\n\n18:22:08,153 WARNING [javax.enterprise.resource.webcontainer.jsf.lifecycle] (http--0.0.0.0-8080-1) #{loginBean.authenticate}: java.lang.NullPointerException: javax.faces.FacesException: #{loginBean.authenticate}: java.lang.NullPointerException\n\n    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118) [jsf-impl-2.1.7-jbossorg-2.jar:]\n\n    at javax.faces.component.UICommand.broadcast(UICommand.java:315) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]\n\n    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]\n\n    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]\n\n    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81) [jsf-impl-2.1.7-jbossorg-2.jar:]\n\n    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101) [jsf-impl-2.1.7-jbossorg-2.jar:]\n\n    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118) [jsf-impl-2.1.7-jbossorg-2.jar:]\n\n    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]\n\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]\n\n    at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50) [jboss-as-jpa-7.1.1.Final.jar:7.1.1.Final]\n\n    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]\n\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]\n\n    at java.lang.Thread.run(Unknown Source) [rt.jar:1.6.0_32]\n\nCaused by: javax.faces.el.EvaluationException: java.lang.NullPointerException\n\n    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]\n\n    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102) [jsf-impl-2.1.7-jbossorg-2.jar:]\n\n    ... 21 more\n\nCaused by: java.lang.NullPointerException\n\n    at org.hibernate.engine.transaction.internal.jta.JtaStatusHelper.getStatus(JtaStatusHelper.java:73) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.engine.transaction.internal.jta.JtaStatusHelper.isActive(JtaStatusHelper.java:115) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.engine.transaction.internal.jta.CMTTransaction.join(CMTTransaction.java:149) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.ejb.AbstractEntityManagerImpl.joinTransaction(AbstractEntityManagerImpl.java:1207) [hibernate-entitymanager-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.ejb.AbstractEntityManagerImpl.postInit(AbstractEntityManagerImpl.java:176) [hibernate-entitymanager-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.ejb.EntityManagerImpl.&lt;init&gt;(EntityManagerImpl.java:89) [hibernate-entitymanager-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.ejb.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:125) [hibernate-entitymanager-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.hibernate.ejb.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:120) [hibernate-entitymanager-4.0.1.Final.jar:4.0.1.Final]\n\n    at org.Handlers.UserHandler.getAllUsers(UserHandler.java:32) [classes:]\n\n    at org.tutorial.LoginBean.authenticate(LoginBean.java:50) [classes:]\n\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_32]\n\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) [rt.jar:1.6.0_32]\n\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) [rt.jar:1.6.0_32]\n\n    at java.lang.reflect.Method.invoke(Unknown Source) [rt.jar:1.6.0_32]\n\n    at org.apache.el.parser.AstValue.invoke(AstValue.java:262) [jbossweb-7.0.13.Final.jar:]\n\n    at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278) [jbossweb-7.0.13.Final.jar:]\n\n    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105) [jsf-impl-2.1.7-jbossorg-2.jar:]\n\n    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]\n\n    ... 22 more\n</code></pre>\n\n<p>My guess is that, for some reason ,  it has to do with the entity manager. I m really new to using hibernate and JPA . I also attach a class to show you how I access the db. Could someone figure out what I m doing wrong?</p>\n\n<pre><code>public class ProjectHandler {\n\n    public void create(Project project) {\n        EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"ResearchManagement.Data\");\n\n        EntityManager em = emf.createEntityManager();\n        em.getTransaction().begin();\n        em.persist(project);\n        em.getTransaction().commit();\n        em.close();\n    }\n\n    public List&lt;Project&gt; getAllProjects() {\n        EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"ResearchManagement.Data\");\n\n        EntityManager em = emf.createEntityManager();\n        em.getTransaction().begin();\n\n        Query query = em.createQuery(\"SELECT p FROM Project p\");\n        List&lt;Project&gt; projects = query.getResultList();\n        em.getTransaction().commit();\n        em.close();\n        return projects;\n    }\n\n    public int deleteByProjectName(String projectName) {\n        EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"ResearchManagement.Data\");\n\n        EntityManager em = emf.createEntityManager();\n        em.getTransaction().begin();\n\n        Query q = em.createQuery(\"DELETE FROM Project p WHERE p.projectName = :u\");\n        q.setParameter(\"u\", projectName );    \n        int deleted = q.executeUpdate();\n        em.getTransaction().commit();\n        em.close();\n        return deleted;\n    }\n\n}\n</code></pre>\n\n<hr>\n\n<p>Thnx for your answer and your tips about my code.\n However I debug my app and I  see that the emf  is not null .\nI still get the error at the line : EntityManager em = emf.createEntityManager();</p>\n\n<p>So my guess is that the emf returns a null entityManager. Still doesnt understand why</p>\n\n<p>What I noticed and looks strange  the server log when I run the application.  it reads the pesistence unit and connects to the db reading corerclty all the tables:</p>\n\n<p>12:02:06,094 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-3) Hibernate Validator 4.2.0.Final</p>\n\n<p>12:02:06,328 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (MSC service thread 1-3) HHH000228: Running hbm2ddl schema update</p>\n\n<p>12:02:06,328 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (MSC service thread 1-3) HHH000102: Fetching database metadata</p>\n\n<p>12:02:06,328 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (MSC service thread 1-3) HHH000396: Updating schema</p>\n\n<p>12:02:06,343 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.departments</p>\n\n<p>12:02:06,343 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [phonenumber, departmentid, name, city]</p>\n\n<p>12:02:06,343 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: []</p>\n\n<p>12:02:06,343 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [primary]</p>\n\n<p>12:02:06,359 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.employees</p>\n\n<p>12:02:06,359 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [phonenumber, departmentid, employeeid, lastname, firstname]</p>\n\n<p>12:02:06,359 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: [fk9d39ef85d77ba982]</p>\n\n<p>12:02:06,359 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [fk9d39ef85d77ba982, primary]</p>\n\n<p>12:02:06,374 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.partners</p>\n\n<p>12:02:06,374 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [partnerid, name, contactmail, city]</p>\n\n<p>12:02:06,374 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: []</p>\n\n<p>12:02:06,374 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [primary]</p>\n\n<p>12:02:06,374 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.projects</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [departmentid, duration, description, projectname, projectid]</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: [fkc479187ad77ba982]</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [primary, fkc479187ad77ba982]</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.projects_has_employees</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [projects_projectid, employees_employeeid]</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: [fk294f111bcd3ec025, fk294f111b92772ef4]</p>\n\n<p>12:02:06,390 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [fk294f111bcd3ec025, primary, fk294f111b92772ef4]</p>\n\n<p>12:02:06,406 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.projects_has_partners</p>\n\n<p>12:02:06,406 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [partners_partnerid, projects_projectid]</p>\n\n<p>12:02:06,406 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: [fk8d741055cd3ec025, fk8d7410555290eb4]</p>\n\n<p>12:02:06,406 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [fk8d741055cd3ec025, fk8d7410555290eb4, primary]</p>\n\n<p>12:02:06,421 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.users</p>\n\n<p>12:02:06,421 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [username, userid, password]</p>\n\n<p>12:02:06,421 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: []</p>\n\n<p>12:02:06,421 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: [primary]</p>\n\n<p>12:02:06,421 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000261: Table found: researchprojects.hibernate_sequence</p>\n\n<p>12:02:06,437 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000037: Columns: [next_val]</p>\n\n<p>12:02:06,437 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000108: Foreign keys: []</p>\n\n<p>12:02:06,437 INFO  [org.hibernate.tool.hbm2ddl.TableMetadata] (MSC service thread 1-3) HHH000126: Indexes: []</p>\n\n<p>12:02:06,437 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (MSC service thread 1-3) HHH000232: Schema update complete</p>\n\n<p>However when I m trying to read the user table (getallUsers() ) , it creates the emf and at the log i see:</p>\n\n<p>12:03:53,346 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (http--0.0.0.0-8080-1) HHH000397: Using ASTQueryTranslatorFactory</p>\n\n<p>12:03:53,347 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000228: Running hbm2ddl schema update</p>\n\n<p>12:03:53,347 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000102: Fetching database metadata</p>\n\n<p>12:03:53,347 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000396: Updating schema</p>\n\n<p>12:03:53,347 INFO  [org.hibernate.tool.hbm2ddl.SchemaUpdate] (http--0.0.0.0-8080-1) HHH000232: Schema update complete</p>\n\n<p>That means that it cannot read the tables anymore. Does this mean anything to you ?</p>\n"},{"tags":["java","hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13050507,"title":"mapping a list of integer with hibernate","body":"<p>how can i map a list of integers in Hibernate??\ntanx!</p>\n\n<p>like this:</p>\n\n<pre><code>@Entity \nclass A{\n List&lt;Integer&gt; p;\n @OneToMany\n getP(...){..};\n setP(...){..};\n}\n</code></pre>\n"},{"tags":["hibernate","jboss","transactions","timeout","locks"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12976089,"title":"JBoss arjuna TransactionReaper don't rollback on timeout","body":"<p>I'm working with an application that access an oracle database. Sometimes objects (rows) on that database are locked by process outside my application.</p>\n\n<p>The problem I'm having is that when the transaction reaches the transaction timeout, arjuna coordinator tries to rollback the transaction but don't succeed in it</p>\n\n<p>The stack trace is the following</p>\n\n<pre><code>09:15:42,494 WARN  [InterceptorsFactory] EJBTHREE-1246: Do not use InterceptorsF\nactory with a ManagedObjectAdvisor, InterceptorRegistry should be used via the b\nean container\n09:16:12,287 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio\nnReaper_18] - TransactionReaper::check timeout for TX -7ffd9392:a9b:507ff0a4:97\nin state  RUN\n09:16:12,292 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.BasicActio\nn_58] - Abort of action id -7ffd9392:a9b:507ff0a4:97 invoked while multiple thre\nads active within it.\n09:16:12,294 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.CheckedAct\nion_2] - CheckedAction::check - atomic action -7ffd9392:a9b:507ff0a4:97 aborting\n with 1 threads active!\n09:16:12,789 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio\nnReaper_18] - TransactionReaper::check timeout for TX -7ffd9392:a9b:507ff0a4:97\nin state  CANCEL\n09:16:13,291 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio\nnReaper_18] - TransactionReaper::check timeout for TX -7ffd9392:a9b:507ff0a4:97\nin state  CANCEL_INTERRUPTED\n09:16:13,293 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio\nnReaper_6] - TransactionReaper::check worker Thread[Thread-11,5,jboss] not respo\nnding to interrupt when cancelling TX -7ffd9392:a9b:507ff0a4:97 -- worker marked\n as zombie and TX scheduled for mark-as-rollback\n09:16:13,297 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio\nnReaper_11] - TransactionReaper::check failed to mark TX -7ffd9392:a9b:507ff0a4:\n97  as rollback only\n</code></pre>\n\n<p>I'm using jboss-5.1.0.GA, Hibernate 3.3.1.GA and Oracle 9.2.08.</p>\n\n<p>I have done several tests and while the row is locked the rollback don't work. It doesn't matter the time that have passed since the transaction timeout.\nIf i unlock the row after the transaction timeout, the rollback starts at that moment.</p>\n\n<p>I have done some research on the web but didn't find exactly the same error.</p>\n\n<p>Thanks.</p>\n\n<p>Diego.</p>\n"},{"tags":["java","query","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13048733,"title":"Quering depending on children id","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3492018/how-to-write-jpa-query-where-parameter-is-a-set\">How to write JPA query where parameter is a set?</a>  </p>\n</blockquote>\n\n\n\n<p>I have 2 entities</p>\n\n<pre><code>@Entity\npublic class Container {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    Long id;\n\n    @ManyToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    Set&lt;Child&gt; data = newHashSet();\n}\n@Entity\npublic class Child {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    Long id;\n}\n</code></pre>\n\n<p>Now I want select all containers that contains specified child.\nI wrote jpa query <code>select c from Container c where :child in c.data</code> that produce sql</p>\n\n<pre><code>select \n    container0_.id as id4_ \nfrom \n    Container container0_ \n    cross join Container_Child data1_, Child child2_ \nwhere \n    container0_.id=data1_.Container_id \nand data1_.data_id=child2_.id \nand (? in (.)) \nlimit ? [42001-168]\n</code></pre>\n\n<p>and fails with <code>JdbcSQLException</code>. How can I fix it?</p>\n"},{"tags":["java","sql","query","hibernate","count"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13049137,"title":"hibernate native query, count","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1372317/how-do-we-count-rows-using-hibernate\">How do we count rows using Hibernate?</a>  </p>\n</blockquote>\n\n\n\n<p>I want count number of records by criteria in database.<br>\nI try use next query  </p>\n\n<pre><code>String queryString = \"SELECT Count(*) FROM my_table\";  \nQuery query = entityManager.createNativeQuery(queryString);  \n</code></pre>\n\n<p>but there is no method to execute this <code>Query query</code> and get result.<br>\nI know, that I can count records using   </p>\n\n<pre><code>String queryString = \"SELECT * FROM my_table\";  \nQuery query = entityManager.createNativeQuery(queryString); \nquery.getResultList().size();  \n</code></pre>\n\n<p>so question, is query with <code>Count(*)</code> more performance, and if <code>yes</code>, then how can I execute query with <code>Count(*)</code>?</p>\n"},{"tags":["java","hibernate","hibernate-mapping","hibernate-annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13048436,"title":"@ManyToOne and @BatchSize","body":"<p>I found in some old code strange thing (at least for me).</p>\n\n<p>The field which is annotated <code>@ManyToOne</code> is also annotated with <code>@BatchSize</code>. </p>\n\n<p>I always thought that <code>@BatchSize</code> annotation only affects when annotated at class level or on a collection (<code>@OneToMany</code>) and affects <strong>pre-fetching</strong> when iterating.</p>\n\n<p>But maybe I am wrong and annotating <code>@ManyToOne</code> with <code>@BatchSize</code> affects something. I can't find the answer in the documentation.</p>\n\n<p>Does annotating <code>@ManyToOne</code> with <code>@BatchSize</code> have sense?</p>\n\n<p>Greetings,</p>\n\n<p>Lukasz</p>\n"},{"tags":["hibernate","annotations","one-to-many","hibernate-annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13047483,"title":"hibernate one to many using a join table, and hibernate annotations","body":"<p>I want do a one-to-many relationship between two tables using a join table.</p>\n\n<p>This is why I want to use a join table:</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/1307203/hibernate-unidirectional-one-to-many-association-why-is-a-join-table-better\">Hibernate unidirectional one to many association - why is a join table better?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/2092611/why-is-it-recommended-to-avoid-unidirectional-one-to-many-association-on-a-forei\">Why is it recommended to avoid unidirectional one-to-many association on a foreign key?</a></li>\n</ul>\n\n<p>Finally, I want to use Hibernate annotations to perform this.</p>\n\n<p>I found some examples to do this using xml mapping but nothing with annotations.</p>\n\n<p>I believe this would be how the tables need to be created</p>\n\n<pre><code>CREATE TABLE `PRODUCT` (\n  `PRODUCT_ID`      BIGINT       PRIMARY KEY AUTO_INCREMENT\n);\n\nCREATE TABLE `PARTS` (\n  `PART_ID`         BIGINT       PRIMARY KEY AUTO_INCREMENT\n);\n\n-- USER_IMAGE_ID must be unique if we want a one-to-many relationship between PRODUCTS &amp; PARTS tables\nCREATE TABLE `USER_DETAILS_IMAGE` (\n  `PRODUCT_ID`      BIGINT,\n  `PART_ID`         BIGINT UNIQUE,\n  CONSTRAINT `FK_PRODUCT_ID`  FOREIGN KEY (`PRODUCT_ID`)   REFERENCES `PRODUCT`(`PRODUCT_ID`),\n  CONSTRAINT `FK_PART_ID`     FOREIGN KEY (`PART_ID`)      REFERENCES `PARTS`(`PART_ID`)\n);\n</code></pre>\n"},{"tags":["hibernate","lazy-loading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13048068,"title":"Hibernate OnDemand eager-fetch","body":"<p>I understand how to configure my model to fetch eager or lazy.\nBut how should i tell my application to eager-fetch a collection just this time?</p>\n\n<p>In other words. I have a DAO with a get-method. <code>EntityDao.getEntity(entityId)</code>\nThis entity has a collection of <code>Children</code> which is lazy-loaded by default.</p>\n\n<p>Lets say the dao-method is transactional.</p>\n\n<p>Most of the time i only need the Entity without the children, but every once in a while i need to eager fetch the children. Now how would i go about that? </p>\n\n<p>If i understand this all correct, then the session only lives within the transaction. So after the transaction ends (in this case after the dao-method) then no more lazy-fetching can be done.\nSo then i can either put my transaction further up my code, or eager fetch my object within the transaction?</p>\n\n<p>So how would i do this eager-fetch within my transaction? </p>\n\n<p>What are my options?</p>\n"},{"tags":["spring","hibernate","sessionfactory"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13047716,"title":"Spring + Hibernate4 Error CurrentSessionContext is always null","body":"<p>I'm using Hibernate 4 with spring 3.1 in a simple java Apllication.</p>\n\n<p>I use the following code to create  the Spring SessionFactory and then convert it into a hibernate SessionFactory:\npls waht is missing here ... Is this the right way to go?? Or do I miss something..? pls help!</p>\n\n<pre><code>.....\n......\ncontext=new ClassPathXmlApplicationContext(new String[]{\"spring.xml\"});\n    return (SessionFactory) context.getBean(\"mySessionFactory\");\n......\n</code></pre>\n\n<p>The CurrentSessionContext ofthe sessionfactory is always null!\nSo I cant execute</p>\n\n<pre><code>sessionFactory.getcurrentSession() \n</code></pre>\n\n<p>-> gives me an java.lang.NullPointer Exception</p>\n\n<p>myBean Declarations in spring.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\"&gt;\n\n\n\n &lt;bean id=\"myDataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\"/&gt;\n    &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/test\"/&gt;\n    &lt;property name=\"username\" value=\"root\"/&gt;\n    &lt;property name=\"password\" value=\"\"/&gt;\n  &lt;/bean&gt;\n\n      &lt;bean id=\"mySessionFactory\"  name=\"mySessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\" scope=\"singleton\"&gt;\n        &lt;property name=\"dataSource\" ref=\"myDataSource\"/&gt;\n        &lt;property name=\"mappingResources\"&gt;\n\n          &lt;list&gt;\n            &lt;value&gt;TblUrls.hbm.xml&lt;/value&gt;\n          &lt;/list&gt;\n        &lt;/property&gt;\n         &lt;property name=\"hibernateProperties\"&gt;\n             &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/prop&gt; \n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt; \n                &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/prop&gt; \n                &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt; \n                &lt;prop key=\"hibernate.transaction.jta.platform\"&gt;org.hibernate.service.jta.platform.internal.SunOneJtaPlatform&lt;/prop&gt;\n                &lt;prop key=\"hibernate.current_session_context_class\"&gt;org.springframework.orm.hibernate4.SpringSessionContext&lt;/prop&gt;\n              &lt;/props&gt;\n        &lt;/property&gt;\n      &lt;/bean&gt;\n   &lt;bean class=\"org.springframework.orm.hibernate4.support.OpenSessionInViewInterceptor\"&gt;\n        &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref local=\"mySessionFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id = \"transactionManager\" class = \"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n        &lt;property name = \"sessionFactory\" ref = \"mySessionFactory\" /&gt;\n\n    &lt;/bean&gt;\n&lt;!--   &lt;bean id=\"myProductDao\" class=\"hib.TblUrlsHome\"&gt; --&gt;\n&lt;!--     &lt;property name=\"sessionFactory\" ref=\"mySessionFactory\"/&gt; --&gt;\n&lt;!--   &lt;/bean&gt; --&gt;\n\n&lt;/beans&gt;\n</code></pre>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":165,"score":1,"question_id":10556368,"title":"How to use group_concat in Hibernate + Spring","body":"<p>How can I use <code>addSqlFunction()</code> in spring when I configured hibernate with hibernate.cfg.xml file? Or is there any other way to use group_concat?</p>\n"},{"tags":["hibernate","jpa-2.0","jboss7.x","h2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13047645,"title":"H2, JPA2, JBoss7 and Transactions","body":"<p>I have a test that runs perfectly when I use a MySQL Backend. </p>\n\n<p>persistence.xml:</p>\n\n<pre><code>&lt;persistence-unit name=\"pu\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;jta-data-source&gt;java:jboss/datasources/mysqlTM&lt;/jta-data-source&gt;\n    &lt;properties&gt;\n        &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQLDialect\"/&gt;\n        &lt;property name=\"hibernate.cache.use_second_level_cache\" value=\"true\" /&gt;\n\n        &lt;!-- Properties for Hibernate --&gt;\n        &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"create-drop\" /&gt;\n        &lt;property name=\"hibernate.show_sql\" value=\"true\" /&gt;\n    &lt;/properties&gt;\n&lt;/persistence-unit&gt;\n</code></pre>\n\n<p>However, when I switch to H2 as follows:</p>\n\n<p>persistence.xml</p>\n\n<pre><code>    &lt;persistence-unit name=\"pu\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;jta-data-source&gt;java:jboss/datasources/ExampleDS&lt;/jta-data-source&gt;\n    &lt;properties&gt;\n        &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.H2Dialect\"/&gt;\n        &lt;property name=\"hibernate.cache.use_second_level_cache\" value=\"true\" /&gt;\n\n        &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"create-drop\" /&gt;\n        &lt;property name=\"hibernate.show_sql\" value=\"true\" /&gt;\n    &lt;/properties&gt;\n&lt;/persistence-unit&gt;\n</code></pre>\n\n<p>using the standard datasource as defined in the stock JBoss 7.1 install and I get the following exception:</p>\n\n<pre><code>Caused by: javax.persistence.TransactionRequiredException: JBAS011469: Transaction is required to perform this operation (either use a transaction or extended persistence context)\n</code></pre>\n\n<p>Google has been of little help. I would prefer to use H2 for testing merely to speed up the testing process.</p>\n\n<p>Thanks in advance for any assistance,</p>\n"},{"tags":["hibernate","oop","spring-mvc","data-layer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13047240,"title":"Hibernate and Spring MVC - representing computed data","body":"<p>Consider the following simplified entities:</p>\n\n<pre><code>public abstract class Alert {\n    @Id\n    @GeneratedValue\n    private Long id;\n    @NaturalId\n    private String client;\n}\n\npublic class Type1Alert extends Alert {\n    private int type1value;\n}\n\npublic class Type2Alert extends Alert {\n    private double type2value;\n}\n</code></pre>\n\n<p>These are represented as table-per-class-hierarchy.  Next, another condition is that we're dealing with a common for Spring MVC controller-service-repository structure. Now what I need to display is the following table:</p>\n\n<pre><code>| Client | Type1 Value | Type2 Value |\n</code></pre>\n\n<p>This table requires a lot of functionality from the data layer: pagination, various sorting and filtering, and so on. So one solution to this is to compose a view (I'm dealing with Oracle), create another entity that represents these aggregated rows, and just pull it into the controller. This makes all those operations trivial but the solution looks kind of crude and also brings some trouble, duplication and contortion to CRUD operations.</p>\n\n<p>I can just fetch raw data (<code>Alert</code> instances) and manipulate them in the service layer, but that brings a lot of redundant work with filtering/sorting/paging. Basically, I would need to fetch <strong>all</strong> the data, all the <code>Alert</code> instances in order to construct correct output (to determine the number of pages, for example).</p>\n\n<p>My question is whether there's a way to elegantly handle such situation without resorting to the first solution? I mean, without falling back upon the specifics of the DB (like Oracle views and such).</p>\n"},{"tags":["java","hibernate","spring"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2495,"score":2,"question_id":1561543,"title":"hibernate and spring persistance problem. Possible identity value not incremented?","body":"<p>I am using hibernate 3.2.6, and spring 2.5.6 \nThe database Im connecting to is: DB2 for Z OS 390 V8.1</p>\n\n<p>When I run my testcase (below) I save the test file object. Hibernate DOES Save the object to the database, but my test blows out after the save, where it's trying to update the object with the correct id.  I think that it's not getting the  correct id (it looks like it's getting a '0' for the id), or Im not even sure why its trying to update the object that is already persisted.  I dont know if this is a spring, hibernate, mapping, dialect, or etc issue.</p>\n\n<p>My config:</p>\n\n<p>The business object:</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n\n    &lt;class name=\"cat.edis.tmiweb.business.File\" table=\"FILE\"&gt;\n\n    \t&lt;id name=\"id\" type=\"java.lang.Long\" column=\"gen_file_id\"&gt;\n    \t\t&lt;generator class=\"native\"&gt;&lt;/generator&gt;\n    \t&lt;/id&gt;\n\n    \t&lt;property name=\"creationTimeStamp\" type=\"java.util.Date\" column=\"crte_ts\" /&gt;\n    \t&lt;property name=\"name\" type=\"java.lang.String\" column=\"file_nm\" /&gt;\n    \t&lt;property name=\"type\" type=\"java.lang.String\" column=\"file_typ_desc\" /&gt;\n    \t&lt;property name=\"description\" type=\"java.lang.String\" column=\"file_desc\" /&gt;\n    \t&lt;property name=\"length\" type=\"java.lang.Long\" column=\"file_lgth\" /&gt;\n    \t&lt;property name=\"contentBlob\" type=\"blob\" column=\"file_cntnt\" /&gt;\n\n    &lt;/class&gt;\n\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>The pojo:</p>\n\n<pre><code>/*\n * Created on Oct 9, 2009\n *\n */\npackage cat.edis.tmiweb.business;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.sql.Blob;\nimport java.sql.SQLException;\nimport java.util.Date;\n\nimport org.hibernate.Hibernate;\n\n/**\n * @author dudekta\n */\npublic class File {\n    private Long id;\n    private Date creationTimeStamp;\n    private String name;\n    private String type;\n    private String description;\n    private Long length;\n    private byte[] content;\n\n\n    /** Don't invoke this. Used by Hibernate only. */\n    public void setContentBlob(Blob imageBlob) {\n     this.content = this.toByteArray(imageBlob);\n    }\n\n    /** Don't invoke this. Used by Hibernate only. */\n    public Blob getContentBlob() {\n     return Hibernate.createBlob(this.content);\n    }\n\n    private byte[] toByteArray(Blob fromBlob) {\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        try {\n         return toByteArrayImpl(fromBlob, baos);\n        } catch (SQLException e) {\n         throw new RuntimeException(e);\n        } catch (IOException e) {\n         throw new RuntimeException(e);\n        } finally {\n         if (baos != null) {\n          try {\n           baos.close();\n          } catch (IOException ex) {\n          }\n         }\n        }\n       }\n\n    private byte[] toByteArrayImpl(Blob fromBlob, ByteArrayOutputStream baos)\n    throws SQLException, IOException {\n    byte[] buf = new byte[4000];\n    InputStream is = fromBlob.getBinaryStream();\n    try {\n     for (;;) {\n      int dataSize = is.read(buf);\n\n      if (dataSize == -1)\n       break;\n      baos.write(buf, 0, dataSize);\n     }\n    } finally {\n     if (is != null) {\n      try {\n       is.close();\n      } catch (IOException ex) {\n      }\n     }\n    }\n    return baos.toByteArray();\n   }\n\n    /**\n     * @return Returns the creationTimeStamp.\n     */\n    public Date getCreationTimeStamp() {\n        return creationTimeStamp;\n    }\n    /**\n     * @param creationTimeStamp\n     *            The creationTimeStamp to set.\n     */\n    public void setCreationTimeStamp(Date creationTimeStamp) {\n        this.creationTimeStamp = creationTimeStamp;\n    }\n    /**\n     * @return Returns the description.\n     */\n    public String getDescription() {\n        return description;\n    }\n    /**\n     * @param description\n     *            The description to set.\n     */\n    public void setDescription(String description) {\n        this.description = description;\n    }\n    /**\n     * @return Returns the id.\n     */\n    public Long getId() {\n        return id;\n    }\n    /**\n     * @param id\n     *            The id to set.\n     */\n    public void setId(Long id) {\n        this.id = id;\n    }\n    /**\n     * @return Returns the length.\n     */\n    public Long getLength() {\n        return length;\n    }\n    /**\n     * @param length\n     *            The length to set.\n     */\n    public void setLength(Long length) {\n        this.length = length;\n    }\n    /**\n     * @return Returns the name.\n     */\n    public String getName() {\n        return name;\n    }\n    /**\n     * @param name\n     *            The name to set.\n     */\n    public void setName(String name) {\n        this.name = name;\n    }\n    /**\n     * @return Returns the type.\n     */\n    public String getType() {\n        return type;\n    }\n    /**\n     * @param type\n     *            The type to set.\n     */\n    public void setType(String type) {\n        this.type = type;\n    }\n    /**\n     * @return Returns the content.\n     */\n    public byte[] getContent() {\n        return content;\n    }\n\n    /**\n     * @param content\n     *            The content to set.\n     */\n    public void setContent(byte[] content) {\n        this.content = content;\n    }\n}\n</code></pre>\n\n<p>The application context:</p>\n\n<pre><code>&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\"&gt;\n\n    &lt;!--  Webservices --&gt;\n    &lt;bean id=\"FPSService\" class=\"cat.edis.tmiweb.services.fps.FPSServiceImpl\"&gt;\n    \t&lt;constructor-arg type=\"java.lang.String\" value=\"http://localhost:8888/someendpoint\" /&gt;\n    \t&lt;constructor-arg type=\"java.lang.String\" value=\"bill\" /&gt;\n    \t&lt;constructor-arg type=\"java.lang.String\" value=\"will\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;!--  Database stuff that we should separate out--&gt;\n\n    &lt;bean id=\"fileDAO\" class=\"cat.edis.tmiweb.dao.FileDAOImpl\"&gt;\n    \t&lt;property name=\"sessionFactory\"&gt;\n    \t\t&lt;ref bean=\"TMISessionFactory\" /&gt;\n    \t&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"TMIDataSource\" class=\"cat.cis.template.spring.util.TUFDataSource\" destroy-method=\"close\"&gt;\n    \t&lt;property name=\"poolName\" value=\"db2OS390GenData\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"TMISessionFactory\" class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n    \t&lt;property name=\"dataSource\" ref=\"TMIDataSource\" /&gt;\n\n    \t&lt;property name=\"mappingResources\"&gt;\n    \t\t&lt;list&gt;\n    \t\t\t&lt;!-- PUT HIBERNATE MAPPING FILES HERE --&gt;\n    \t\t\t&lt;value&gt;cat/edis/tmiweb/business/File.hbm.xml&lt;/value&gt;\n    \t\t&lt;/list&gt;\n    \t&lt;/property&gt;\n    \t&lt;property name=\"hibernateProperties\"&gt;\n    \t\t&lt;map&gt;\n    \t\t\t&lt;entry&gt;\n    \t\t\t\t&lt;key&gt;\n    \t\t\t\t\t&lt;value&gt;hibernate.show_sql&lt;/value&gt;\n    \t\t\t\t&lt;/key&gt;\n    \t\t\t\t&lt;value&gt;true&lt;/value&gt;\n    \t\t\t&lt;/entry&gt;\n    \t\t\t&lt;entry&gt;\n    \t\t\t\t&lt;key&gt;\n    \t\t\t\t\t&lt;value&gt;hibernate.default_schema&lt;/value&gt;\n    \t\t\t\t&lt;/key&gt;\n    \t\t\t\t&lt;value&gt;N4GK001$&lt;/value&gt;\n    \t\t\t&lt;/entry&gt;\n    \t\t\t&lt;entry&gt;\n    \t\t\t\t&lt;key&gt;\n    \t\t\t\t\t&lt;value&gt;hibernate.dialect&lt;/value&gt;\n    \t\t\t\t&lt;/key&gt;\n    \t\t\t\t&lt;ref bean=\"TMIDialect\" /&gt;\n    \t\t\t&lt;/entry&gt;\n    \t\t&lt;/map&gt;\n    \t&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"TMIDialect\" factory-bean=\"TMIDialectFactory\" factory-method=\"instance\" /&gt;\n\n    &lt;bean id=\"TMIDialectFactory\" class=\"cat.cis.template.spring.util.EnvironmentBeanStrategyFactory\"&gt;\n    \t&lt;property name=\"envKey\" value=\"tuf.environment\" /&gt;\n    \t&lt;property name=\"defaultKey\" value=\"DEV\" /&gt;\n    \t&lt;property name=\"target\"&gt;\n    \t\t&lt;map&gt;\n    \t\t\t&lt;entry key=\"DEV\" value=\"org.hibernate.dialect.DB2390Dialect\" /&gt;\n    \t\t\t&lt;entry key=\"TEST\" value=\"org.hibernate.dialect.DB2390Dialect\" /&gt;\n    \t\t\t&lt;entry key=\"QA\" value=\"org.hibernate.dialect.DB2390Dialect\" /&gt;\n    \t\t\t&lt;entry key=\"PROD\" value=\"org.hibernate.dialect.DB2390Dialect\" /&gt;\n    \t\t&lt;/map&gt;\n    \t&lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    \t&lt;property name=\"sessionFactory\"&gt;\n    \t\t&lt;ref bean=\"TMISessionFactory\" /&gt;\n    \t&lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>FileDAO:</p>\n\n<pre><code>/*\n * Created on Oct 9, 2009\n */\npackage cat.edis.tmiweb.dao;\n\nimport org.springframework.orm.hibernate3.support.HibernateDaoSupport;\n\nimport cat.edis.tmiweb.business.File;\n\n/**\n * @author dudekta\n *  \n */\npublic class FileDAOImpl extends HibernateDaoSupport implements FileDAO {\n\n    /**\n     * \n     * @param id\n     * @return\n     */\n    public File load(Long id) {\n        return (File) getHibernateTemplate().get(File.class, id);\n    }\n\n    /**\n     * \n     * @param file\n     * @return\n     */\n    public void save(File file) {\n        getHibernateTemplate().save(file);\n    }\n\n}\n</code></pre>\n\n<p>My Test:</p>\n\n<pre><code>public void testSaveBlob() {\n        FileDAO fileDAO =(FileDAO)SpringTestInitializer.getContext().getBean(\"fileDAO\");\n        File file = new File();\n        file.setName(\"TestMe\");\n        file.setType(\"txt\");\n        file.setCreationTimeStamp(new Date());\n        file.setDescription(\"idc\");\n\n        byte[] testBytes = new byte[1024];\n        byte byteValue = 1;\n        for (int i = 0; i &lt; testBytes.length; i++) {\n            testBytes[i] = byteValue;\n        }\n        file.setLength(new Long(testBytes.length));\n        file.setContent(testBytes);\n        fileDAO.save(file);\n\n        File dbFile = fileDAO.load(file.getId());\n        assertNotNull(file);\n    }\n</code></pre>\n\n<p>Output to console from Hibernate:</p>\n\n<pre><code>Initializing Spring....\nSpring test context created....\nHibernate: insert into N4GK001$.FILE (gen_file_id, crte_ts, file_nm, file_typ_desc, file_desc, file_lgth, file_cntnt) values (default, ?, ?, ?, ?, ?, ?)\nHibernate: select identity_val_local() from sysibm.sysdummy1\nHibernate: update N4GK001$.FILE set crte_ts=?, file_nm=?, file_typ_desc=?, file_desc=?, file_lgth=?, file_cntnt=? where gen_file_id=?\n</code></pre>\n\n<p>Trace:</p>\n\n<blockquote>\n  <p>org.springframework.dao.DataIntegrityViolationException:\n  could not update:\n  [cat.edis.tmiweb.business.File#0];\n  nested exception is\n  org.hibernate.exception.DataException:\n  could not update:\n  [cat.edis.tmiweb.business.File#0]     at\n  org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:639)\n    at\n  org.springframework.orm.hibernate3.HibernateAccessor.convertHibernateAccessException(HibernateAccessor.java:412)\n    at\n  org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:424)\n    at\n  org.springframework.orm.hibernate3.HibernateTemplate.executeWithNativeSession(HibernateTemplate.java:374)\n    at\n  org.springframework.orm.hibernate3.HibernateTemplate.save(HibernateTemplate.java:694)\n    at\n  cat.edis.tmiweb.dao.FileDAOImpl.save(FileDAOImpl.java:31)\n    at\n  cat.edis.tmiweb.dao.FileDAOImplTest.testSaveBlob(FileDAOImplTest.java:50)\n    at\n  sun.reflect.NativeMethodAccessorImpl.invoke0(Native\n  Method)   at\n  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n    at\n  sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n    at\n  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n    at\n  java.lang.reflect.Method.invoke(Method.java:391)\n    at\n  junit.framework.TestCase.runTest(TestCase.java:154)\n    at\n  org.jmock.core.VerifyingTestCase.runBare(VerifyingTestCase.java:39)\n    at\n  junit.framework.TestResult$1.protect(TestResult.java:106)\n    at\n  junit.framework.TestResult.runProtected(TestResult.java:124)\n    at\n  junit.framework.TestResult.run(TestResult.java:109)\n    at\n  junit.framework.TestCase.run(TestCase.java:118)\n    at\n  junit.framework.TestSuite.runTest(TestSuite.java:208)\n    at\n  junit.framework.TestSuite.run(TestSuite.java:203)\n    at\n  org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:436)\n    at\n  org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:311)\n    at\n  org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:192)\n  Caused by:\n  org.hibernate.exception.DataException:\n  could not update:\n  [cat.edis.tmiweb.business.File#0]     at\n  org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:77)\n    at\n  org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at\n  org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2430)\n    at\n  org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2312)\n    at\n  org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2612)\n    at\n  org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:96)\n    at\n  org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n    at\n  org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\n    at\n  org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:168)\n    at\n  org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:298)\n    at\n  org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)\n    at\n  org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)\n    at\n  org.springframework.orm.hibernate3.HibernateAccessor.flushIfNecessary(HibernateAccessor.java:390)\n    at\n  org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:420)\n    ... 20 more Caused by:\n  COM.ibm.db2.jdbc.DB2Exception:\n  [IBM][CLI Driver][DB2] SQL0100W  No\n  row was found for FETCH, UPDATE or\n  DELETE; or the result of a query is an\n  empty table.  SQLSTATE=02000</p>\n  \n  <p>at\n  COM.ibm.db2.jdbc.app.SQLExceptionGenerator.throw_SQLException(Unknown\n  Source)   at\n  COM.ibm.db2.jdbc.app.SQLExceptionGenerator.throw_SQLException(Unknown\n  Source)   at\n  COM.ibm.db2.jdbc.app.SQLExceptionGenerator.check_return_code(Unknown\n  Source)   at\n  COM.ibm.db2.jdbc.app.DB2PreparedStatement.loadParameters(Unknown\n  Source)   at\n  COM.ibm.db2.jdbc.app.DB2PreparedStatement.execute2(Unknown\n  Source)   at\n  COM.ibm.db2.jdbc.app.DB2PreparedStatement.executeUpdate(Unknown\n  Source)   at\n  cat.cis.tuf.server.connector.jdbc.v1.JDBCv1DBStatement.executeUpdate(JDBCv1DBStatement.java:206)\n    at\n  org.hibernate.jdbc.NonBatchingBatcher.addToBatch(NonBatchingBatcher.java:23)\n    at\n  org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2408)\n    ... 31 more</p>\n</blockquote>\n\n<p>The exception object:</p>\n\n<pre><code> ex= DataException  (id=341)\nbacktrace= Object[35]  (id=349)\ncause (NestableRuntimeException)= DB2Exception  (id=325)\ncause (Throwable)= DataException  (id=341)\ndelegate= NestableDelegate  (id=350)\ndetailMessage= \"could not update: [cat.edis.tmiweb.business.File#0]\"\nsql= \"update N4GK001$.FILE set crte_ts=?, file_nm=?, file_typ_desc=?, file_desc=?, file_lgth=?, file_cntnt=? where gen_file_id=?\"\nsqle= DB2Exception  (id=325)\nstackTrace= null\n</code></pre>\n\n<p>**</p>\n\n<p>Switched to type 4 driver: (still using org.hibernate.dialect.DB2390Dialect)</p>\n\n<p>NEW error! **\\</p>\n\n<pre><code>org.springframework.orm.hibernate3.HibernateOptimisticLockingFailureException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1; nested exception is org.hibernate.StaleStateException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1\n   at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:672)\n   at org.springframework.orm.hibernate3.HibernateAccessor.convertHibernateAccessException(HibernateAccessor.java:412)\n   at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:424)\n   at org.springframework.orm.hibernate3.HibernateTemplate.executeWithNativeSession(HibernateTemplate.java:374)\n   at org.springframework.orm.hibernate3.HibernateTemplate.save(HibernateTemplate.java:694)\n   at cat.edis.tmiweb.dao.FileDAOImpl.save(FileDAOImpl.java:31)\n   at cat.edis.tmiweb.dao.FileDAOImplTest.testSaveBlob(FileDAOImplTest.java:50)\n   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)\n   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)\n   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:60)\n   at java.lang.reflect.Method.invoke(Method.java:391)\n   at junit.framework.TestCase.runTest(TestCase.java:154)\n   at org.jmock.core.VerifyingTestCase.runBare(VerifyingTestCase.java:39)\n   at junit.framework.TestResult$1.protect(TestResult.java:106)\n   at junit.framework.TestResult.runProtected(TestResult.java:124)\n   at junit.framework.TestResult.run(TestResult.java:109)\n   at junit.framework.TestCase.run(TestCase.java:118)\n   at junit.framework.TestSuite.runTest(TestSuite.java:208)\n   at junit.framework.TestSuite.run(TestSuite.java:203)\n   at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:436)\n   at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:311)\n   at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:192)\nCaused by: org.hibernate.StaleStateException: Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1\n   at org.hibernate.jdbc.Expectations$BasicExpectation.checkBatched(Expectations.java:61)\n   at org.hibernate.jdbc.Expectations$BasicExpectation.verifyOutcome(Expectations.java:46)\n   at org.hibernate.jdbc.NonBatchingBatcher.addToBatch(NonBatchingBatcher.java:24)\n   at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2408)\n   at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2312)\n   at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2612)\n   at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:96)\n   at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n   at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\n   at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:168)\n   at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:298)\n   at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)\n   at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)\n   at org.springframework.orm.hibernate3.HibernateAccessor.flushIfNecessary(HibernateAccessor.java:390)\n   at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:420)\n   ... 20 more\n</code></pre>\n"},{"tags":["spring","hibernate","tomcat","tomcat6","noclassdeffounderror"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":13045262,"title":"Spring + Hibernate + Tomcat Dependency problems","body":"<p>when I run tomcat and the war is deployed I get :\n<strong>NoClassDefFoundError : org/apache/commons/collections/map/LRUMap</strong></p>\n\n<blockquote>\n  <p>Invocation of init method failed; nested exception is\n  java.lang.NoClassDefFoundError:\n  org/apache/commons/collections/map/LRUMap\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)\n  ~[spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]</p>\n</blockquote>\n\n<p>What is strange is that I got the <code>commons-collections-2.1.jar</code> (I even tried 3.1) in my WEB-INF lib folder.</p>\n\n<p>Edit :\nI did copy the <code>commons-collections</code> from <code>WEB-INF/lib</code> to <code>Tomcat lib</code> and it seems to work. However I won't be able to do that on the production server, why isn't it taking my <code>WEB-INF/lib</code> version ?</p>\n"},{"tags":["eclipse","hibernate","eclipse-plugin"],"answer_count":12,"favorite_count":31,"up_vote_count":58,"down_vote_count":0,"view_count":139663,"score":58,"question_id":351640,"title":"How to install Hibernate Tools in Eclipse?","body":"<p>What is the proper way to install Hibernate Tools in Eclipse as a plugin?\nThe <a href=\"http://www.hibernate.org/255.html\" rel=\"nofollow\" title=\"Hibernate site\">Hibernate site</a> doesn't really give any instructions.</p>\n\n<p>Looking at the Hibernate Tools binary <code>HibernateTools-3.2.4.Beta1-R200810311334.zip</code>, it appears that I can just unzip this in my eclipse directory. Do I just unzip it in my eclipse directory? This seems like a hacky was to install it.</p>\n"},{"tags":["java","hibernate","spring-mvc","junit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13045579,"title":"Hibernate 3 : optimistic locking unit test","body":"<p>I'm trying to test my optimistic locking implementation of my application.  However the result is not what I expect.  The steps I take to test are the following</p>\n\n<ul>\n<li>load an entity from the database</li>\n<li>set the version attribute to one less than present in the database</li>\n<li>change another attribute thats just a string to something else</li>\n<li>save the entity</li>\n</ul>\n\n<p>I expected a staleException now, however the entity just gets saved and the version increases to the next in line.</p>\n\n<p>Here is a small extract of my save code</p>\n\n<pre><code>   public &lt;T extends DomainObject&gt; T save(T objectToSave) {\n        Session currentSession = null;\n        try {\n            currentSession = sessionFactory.getCurrentSession();\n            currentSession.save(objectToSave);\n            return objectToSave;\n        } catch (Exception ex) {\n            logger.error(\"save error\",ex);\n        }\n        return null;\n    }\n</code></pre>\n\n<p>I load objects by id with named queries thru my entire application with following code</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\npublic &lt;T extends Object&gt; List&lt;T&gt; query(Class&lt;T&gt; returnClass, String query, List&lt;String&gt; namedParams, List&lt;? extends Object&gt; params, Integer limit) {\n    Session currentSession = null;\n    try {\n        currentSession = sessionFactory.getCurrentSession();\n        Query namedQuery = currentSession.getNamedQuery(query);\n        if(limit != null){\n            namedQuery.setMaxResults(limit);\n        }\n        namedQuery.setCacheable(true);\n        if (namedParams != null &amp;&amp; namedParams.size() &gt; 0) {\n            addParams(namedQuery, namedParams, (List&lt;Object&gt;) params);\n        }\n        return namedQuery.list();\n    } catch (Exception ex) {\n        logger.error(\"query error\",ex);\n    }\n    return null;\n}\n</code></pre>\n\n<p>And this is the configuration of my sessionfactory</p>\n\n<pre><code>&lt;bean id=\"sessionFactory\"\n    class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n    &lt;property name=\"entityInterceptor\" ref=\"auditInterceptor\" /&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;value&gt;\n            hibernate.dialect=${hibernate.dialect}\n            hibernate.show_sql=${hibernate.show_sql}\n            hibernate.cache.provider_class=org.hibernate.cache.EhCacheProvider\n            hibernate.cache.region.factory_class=net.sf.ehcache.hibernate.EhCacheRegionFactory\n            hibernate.cache.use_query_cache=true\n            hibernate.cache.use_second_level_cache=true\n            hibernate.cache.provider_configuration_file_resource_path=ehcache.xml\n            hibernate.generate_statistics=true\n            hbm2ddl.auto=${hbm2ddl.auto}\n            hibernate.c3p0.min_size=${hibernate.c3p0.min_size}\n            hibernate.c3p0.max_size=${hibernate.c3p0.max_size}\n            hibernate.c3p0.timeout=${hibernate.c3p0.timeout}\n            hibernate.c3p0.max_statements=${hibernate.c3p0.max_statements}\n            hibernate.c3p0.idle_test_period=${hibernate.c3p0.idle_test_period}\n        &lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"schemaUpdate\"&gt;\n        &lt;value&gt;true&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property name=\"annotatedClasses\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;com.mbalogos.mba.domain.site.Site&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;          \n</code></pre>\n\n<p>Is there anything I missed on the configuration of the sessionFactory or do I test it completly wrong and should I test it in a different way ?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["hibernate","one-to-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13044567,"title":"Hibernate - bidirectional @OneToOne","body":"<p>I have 2 classes: User and UserPicture which have a 1:1 relationship.</p>\n\n<pre><code>public class User {\n     @Id\n     @GeneratedValue(strategy=GenerationType.AUTO)\n     @Column(name=\"id\", nullable = false, unique = true)\n private int id;\n\n     private String firstname;\n\n     private String lastname;\n\n     @OneToOne\n     @JoinColumn(name = \"picture\") //field named \"picture\" in the database\n     private UserPicture userPicture;\n\n     ..\n}\n\n\npublic class UserPicture {\n\n     @Id\n     @GeneratedValue(strategy=GenerationType.AUTO)\n     @Column(name=\"id\", nullable = false, unique = true)\n     private int id;\n\n     private Blob image;\n\n     @OneToOne\n     @JoinColumn(name = \"user\")\n     User user;\n</code></pre>\n\n<p>'user' in UserPicture will be loaded but 'userPicture' in User not - what did Im wrong?</p>\n\n<p><strong>EDIT</strong>\nHave to add that Im just create a UserPicture and insert them (with existing userId) - maybe I need to cascade 'user' in UserPicture?</p>\n"},{"tags":["java","hibernate","jpa","orm","mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13035745,"title":"JPA @SecondaryTable foreign key violation","body":"<p>I want to map two entities in a <code>one to many</code> fashion.</p>\n\n<pre><code>A-&gt;[B, B]\n</code></pre>\n\n<p>I want to add to the  <code>join table</code> more fields. <code>Pojos</code> looks like:</p>\n\n<pre><code>@Entity\n@Table(name = \"A\", schema = \"examples\")\n@SecondaryTable(name = \"A_B\", pkJoinColumns = @PrimaryKeyJoinColumn(name = \"a_id\", referencedColumnName = \"id\"))\npublic class A\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private Integer id;\n\n    @Basic\n    private String name;\n\n    @Basic\n    private Integer field1;\n\n    @Column(table = \"A_B\", name = \"field2\")\n    private Integer field2;\n\n    @OneToMany(cascade = {CascadeType.ALL})\n    @JoinTable(name = \"A_B\", joinColumns = {@JoinColumn(name = \"a_id\")}, inverseJoinColumns = {@JoinColumn(name = \"b_id\")})\n    private List&lt;B&gt; datastores;\n}\n\n\n@Entity\n@Table(name = \"B\", schema = \"examples\")\n@SecondaryTable(name = \"A_B\", pkJoinColumns = @PrimaryKeyJoinColumn(name = \"b_id\", referencedColumnName = \"id\"))\npublic class B\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private Integer id;\n\n\n    @Basic\n    private String field1;\n\n    @Basic\n    private int field2;\n\n    @Column(table = \"A_B\", name = \"field3\")\n    private int field3;\n}\n</code></pre>\n\n<p>Thing is that in order to add I had to remove the <code>foreign key</code> on <code>A_B</code> table. How do I solve the mapping to allow the <code>foreign keys</code> ?</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","hibernate","hibernate-mapping"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13024569,"title":"How to map an attribute like Map<Class, AbstractEntity> with hibernate?","body":"<p>Is there any possibility with Hibernate to do the following entity structure?</p>\n\n<pre><code>@Entity\npublic class Person {\n\n    @OneToMany\n    private Map&lt;Class&lt;? extends PersonRole&gt;, PersonRole&gt; personRoles;\n\n    public &lt;T extends PersonRole&gt; T getRole(Class&lt;T&gt; roleClass) {\n         return roleClass.cast(roles.get(roleClass));\n    }\n\n}\n\n@Entity\npublic abstract class PersonRole {\n\n    @ManyToOne\n    private Person person;\n\n}\n</code></pre>\n\n<p>Basically Hibernate can persist this mapped entity but it is not possible to load it anymore from the database with the following exception:</p>\n\n<pre><code>Exception in thread \"main\" org.hibernate.HibernateException: null index column for      collection: de.his.cs.sys.hibernate.Person.roles\nat org.hibernate.persister.collection.AbstractCollectionPersister.readIndex(AbstractCollectionPersister.java:822)\nat org.hibernate.collection.internal.PersistentMap.readFrom(PersistentMap.java:277)\nat org.hibernate.loader.Loader.readCollectionElement(Loader.java:1189)\nat org.hibernate.loader.Loader.readCollectionElements(Loader.java:804)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:655)\nat org.hibernate.loader.Loader.doQuery(Loader.java:854)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:293)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:263)\nat org.hibernate.loader.Loader.loadCollection(Loader.java:2094)\nat org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:61)\n</code></pre>\n\n<p>A workaround could be using a \"simple\" collection and filling the map with an interceptor, but I hope for a possibility achieving this without additional infrastructure.</p>\n"},{"tags":["java","hibernate","spring-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":13037433,"title":"Context initialization failed while starting jetty server","body":"<p>My webapp was running fine until i did the complete build of project and it started breaking.</p>\n\n<p>I get the following error:</p>\n\n<pre><code>[gogii] INFO [main] XmlBeanDefinitionReader.loadBeanDefinitions(315) | Loading XML bean definitions from class path resource [store.cfg.xml]\n[gogii] DEBUG [main] DefaultDocumentLoader.loadDocument(72) | Using JAXP provider [com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderFactoryImpl]\n[gogii] ERROR [main] ContextLoader.initWebApplicationContext(220) | Context initialization failed\norg.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Failed to import bean definitions from relative location [store.cfg.xml]\nOffending resource: class path resource [billingCoreAppContext.xml]; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from class path resource [store.cfg.xml]; nested exception is java.net.SocketException: Connection reset\n    at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)\n    at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)\n    at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:76)\n    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.importBeanDefinitionResource(DefaultBeanDefinitionDocumentReader.java:218)\n    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseDefaultElement(DefaultBeanDefinitionDocumentReader.java:147)\n    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:132)\n    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:93)\n    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)\n    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)\n    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)\n    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)\n    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)\n    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)\n    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)\n    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:124)\n    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:93)\n    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)\n    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:467)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:397)\n    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:276)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:197)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)\n    at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)\n    at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)\n    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)\n    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)\n    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)\n    at org.mortbay.jetty.plugin.Jetty6PluginWebAppContext.doStart(Jetty6PluginWebAppContext.java:115)\n    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)\n    at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)\n    at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)\n    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)\n    at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)\n    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)\n    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)\n    at org.mortbay.jetty.Server.doStart(Server.java:224)\n    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)\n    at org.mortbay.jetty.plugin.Jetty6PluginServer.start(Jetty6PluginServer.java:132)\n    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:454)\n    at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:396)\n    at org.mortbay.jetty.plugin.AbstractJettyRunMojo.execute(AbstractJettyRunMojo.java:210)\n    at org.mortbay.jetty.plugin.Jetty6RunMojo.execute(Jetty6RunMojo.java:184)\n</code></pre>\n\n<p>This was working earlier.. The cfg file is in correct location, Db is up..\nI am using spring 3.0.5</p>\n"},{"tags":["java","hibernate","vaadin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13043152,"title":"Multiuser work with the Vaadin table","body":"<p>With one table several operators are working, and always have to show up to date.\nI do this by clicking on the line -</p>\n\n<pre><code>...\ntable.addListener(new Table.ValueChangeListener() {\n            public void valueChange(final com.vaadin.data.Property.ValueChangeEvent event) {\n\n   ...\n   BeanItemContainer&lt;Incoming&gt; bic;\n   Query query = sess.createQuery(\"....\");\n   List l = query.....\n   bic = new BeanItemContainer&lt;Incoming&gt;(l);\n   table.setContainerDataSource(bic);\n   ...\n\n}\n});\n...\n</code></pre>\n\n<p>But when I load -</p>\n\n<pre><code>table.setContainerDataSource(bic);\n</code></pre>\n\n<p>Selected line <strong>is lost</strong>.</p>\n\n<p>What to do in this case?\nI would be grateful for the information!</p>\n\n<p>Thank you!</p>\n"},{"tags":["query","hibernate","join","one-to-many","jql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13042231,"title":"JQL for One To Many with join table","body":"<p>I have the following relationships: A CustomerApplication has a list of Customer objects as a OneToMany with a join table.  A CustomerApplication also has a OneToOne to a CustomerAgreement.  The code in the CustomerApplication class is as follows:</p>\n\n<pre><code>@OneToMany( fetch = FetchType.EAGER )  \n@JoinTable(  \n        name = \"customer_application_customer\",  \n        joinColumns = @JoinColumn( name = \"customer_application_id\" ),  \n        inverseJoinColumns = @JoinColumn( name = \"customer_id\" ) )  \nprivate List&lt;Customer&gt; customers = new ArrayList&lt;Customer&gt;();  \n\n@OneToOne( mappedBy = \"customerApplication\" )  \nprivate CustomerAgreement customerAgreement;\n</code></pre>\n\n<p>I need to use JQL to query all active agreements for customers with the same Social Security number.  I have the following, which gives the error: </p>\n\n<p>Errors in named queries: CustomerAgreement.fetchActiveForSsn  </p>\n\n<p>Here is the query.  </p>\n\n<p>@NamedQuery( name = \"CustomerAgreement.fetchActiveForSsn\", query = \"select o from CustomerAgreement o where o.status = :status and o.customerApplication.customers.customer.socialSecurityNumber = :ssn\" )</p>\n\n<p>It's the join between the CustomerApplication and the list of customers to check the social that I'm not sure of.  Can someone tell me how that's done?</p>\n"},{"tags":["hibernate","session","object"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13038299,"title":"Java Hibernate Object doesn't refresh","body":"<p>I'm working on Hibernate. I'm testing a simple Java to load 2 entities of book in 2 separate sessions. I loaded the first book object, let the main thread sleep 5s, during this time, I changed the name of the book in the db. After that, the second session would load the book again. But the name of the book is still the same. When it's expected to be changed also. </p>\n\n<p>Please help. I wrote a servlet program but with the same issue, the updated data doesn't show after db change.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>import java.util.Date;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Set;\n\nimport org.hibernate.CacheMode;\nimport org.hibernate.Hibernate;\nimport org.hibernate.Query;\nimport org.hibernate.Session;\nimport org.hibernate.SessionFactory;\nimport org.hibernate.Transaction;\nimport org.hibernate.cfg.Configuration;\n\nimport org.hibernate.stat.Statistics;\n\n/**\n * @author Guruzu\n * \n */\npublic class Launch_3_5 {\n\n    private static SessionFactory sessionFactory;\n\n    public static Session getSession() {\n        if (sessionFactory == null) {\n            sessionFactory = new Configuration().configure()\n                    .buildSessionFactory();\n        }\n        Session hibernateSession = sessionFactory.openSession();\n        return hibernateSession;\n    }\n\n    public static SessionFactory getSessionFactory() {\n        if (sessionFactory == null) {\n            sessionFactory = new Configuration().configure()\n                    .buildSessionFactory();\n        }\n        return sessionFactory;\n    }\n\n    public static void main(String[] args) {\n        Session session1 = getSessionFactory().openSession();\n\n        try {\n\n            Transaction tx = session1.beginTransaction();\n\n            Book book1 = (Book) session1.get(Book.class, (long) 1);\n\n            System.out.println(\"Book: \" + book1.getName());\n\n\n        //  session1.flush();\n        } finally {\n\n            session1.close();\n        }\n\n        try {\n            Thread.sleep(5000);\n        } catch (InterruptedException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n        Session session2 = getSessionFactory().openSession();\n\n        try {\n\n            Book book2 = (Book) session2.get(Book.class, (long) 1);\n            System.out.println(\"Book: \" + book2.getName());\n\n        } finally {\n\n            session2.close();\n        }\n\n    }\n}\n</code></pre>\n\n<p>Book6_1.hbm.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt; \n&lt;!DOCTYPE hibernate-mapping PUBLIC \n\"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"Book\" table=\"Book6_1\"&gt;\n\n        &lt;id name=\"book_id\" type=\"long\" column=\"BOOK_ID\"&gt;\n            &lt;generator class=\"increment\"&gt;\n            &lt;/generator&gt;\n        &lt;/id&gt;\n        &lt;property name=\"isbn\" type=\"string\"&gt;\n            &lt;column name=\"ISBN\" length=\"50\" not-null=\"true\" unique=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"name\" type=\"string\"&gt;\n            &lt;column name=\"BOOK_NAME\" length=\"100\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"publishDate\" type=\"date\" column=\"PUBLISH_DATE\" /&gt;\n        &lt;property name=\"price\" type=\"int\" column=\"PRICE\" /&gt;\n\n\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt; \n</code></pre>\n\n<p>hibernate.cfg.xml</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD//EN\"\n\"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/hibernatetutorial&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.pool_size\"&gt;10&lt;/property&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n\n        &lt;mapping resource=\"Book_6_1.hbm.xml\" /&gt;\n\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n"},{"tags":["hibernate","hibernate-envers"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":708,"score":2,"question_id":1102365,"title":"Unable to add custom logging data in REVINFO in envers","body":"<p>I am trying to use Envers for implementing Audit trails. It's creating the audit table <code>Person_AUD</code> and entering the audit data as well. But, when I try to add custom fields that are updated by Envers, nothing happens.</p>\n"},{"tags":["hibernate","audit","hibernate-envers"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12736811,"title":"Why does overriding change column names","body":"<p>I was using the default implementation of the rev listener and as expected the columns in my REVINFO table were: revtstmp and rev.</p>\n\n<p>However, when I overrode the default - all I did was:</p>\n\n<pre><code>... MyRevisionEntity extends DefaultRevisionEntity\n</code></pre>\n\n<p>those column names were changed to \"timestamp\" and \"id\".</p>\n\n<p>Anyone know why?</p>\n\n<p>Using envers 4.1.5_Final...</p>\n\n<p>** EDIT **\nAs no one has yet answered, I am adding more information.</p>\n\n<p>The Adam Warski authored \"DefaultRevisionEntity\" class defines only two members:\n    private int id;</p>\n\n<p>and \n    private long timestamp;</p>\n\n<p>Thus, I understand that when I extend that class, those will be the column names that I should expect.  However, the \"baffling\" question is: why was it that when I did NOT extend the default, the columns were different (rev and revtstmp respectively) and also what the documentation said?</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["hibernate","spring-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13020724,"title":"Spring MVC and Hibernate throws Null Pointer exception occasionally","body":"<p>I'm getting a NPE occasionally on the following code:\nI'm a rookie in hibernate and and this was taken out of some tutorial that I don't recall:</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\n    public static List&lt;RawLine&gt; getLastLines(){\n            List&lt;RawLine&gt; result = null;\n            Transaction tx = null;\n            Session session= HibernateUtil.getSessionFactory().getCurrentSession();\n\n            try{\n                tx = session.beginTransaction();\n\n// Line 54 is next:\n            result = session.createCriteria(RawLine.class)\n                             .add(Restrictions.eq(\"status\", new Integer(\"0\"))).list();\n\n                tx.commit();\n            } catch (HibernateException e) {\n                tx.rollback();\n                e.printStackTrace();\n                return null;\n            }\n\n\n            return result;\n\n    }\n</code></pre>\n\n<p>Here is the exception.\nIt only happens sometimes, maybe one in every 5 or 10 times I load the page.</p>\n\n<pre><code>WARNING: StandardWrapperValve[mvc-dispatcher]: PWC1406: Servlet.service() for servlet mvc-dispatcher threw exception\njava.lang.NullPointerException\n    at pt.itgest.readings.Readings.getLastLines(Readings.java:54)\n    at pt.itgest.common.controller.LastReadingsController.printWelcome(LastReadingsController.java:26)\n    at sun.reflect.GeneratedMethodAccessor157.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:601)\n    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)\n    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)\n    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)\n    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)\n    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)\n    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)\n    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)\n    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)\n    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)\n    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)\n    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)\n    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)\n    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)\n    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)\n    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)\n    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)\n    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)\n    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)\n    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)\n    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)\n    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)\n    at java.lang.Thread.run(Thread.java:722)\n</code></pre>\n\n<p>Thank you for your help.</p>\n"},{"tags":["hibernate","criteria"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13040791,"title":"Hibernate If row exits map to boolean attribute","body":"<p>I have a hibernate domain class, let say Product and it is mapped to the product table.   I have another table called Order.  Each table has an linkId field and these table can be joined by this field.  In the product class I have a boolean attribute but it is not mapped to any column in the product table.   Is it possible to create a criteria that would join these two tables and populate the boolean field on porduct to true if matching rows exist in the order table and false if no matching rows exist.</p>\n\n<p>I would need an example.\nThanks</p>\n"},{"tags":["hibernate","jpa","jpa-2.0","criteria-api"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3581,"score":0,"question_id":3799135,"title":"org.hibernate.QueryException: Not all named parameters have been set","body":"<p>I'm getting extremely weird behavior out of JPA 2.0 Criteria API with Hibernate 3.5.1-Final as a provider.</p>\n\n<p>I'm trying to build a dynamic query that looks like this in JPQL:</p>\n\n<pre><code> SELECT e FROM Employee e WHERE lower(e.firstName) like lower(:employeeName) OR lower(e.lastName) like lower(:employeeName)     \n</code></pre>\n\n<p>but keep getting the error</p>\n\n<pre><code>java.lang.IllegalArgumentException: org.hibernate.QueryException: Not all named parameters have been set: [param0] [select generatedAlias0 from com.company.model.Employee as generatedAlias0 where ( lower(generatedAlias0.firstName) like lower(:param0) ) or ( lower(generatedAlias0.lastName) like lower(:param1) ) order by generatedAlias0.firstName asc]    \n</code></pre>\n\n<p>If I take away the path for <code>lastName</code> it works fine.  Am I doing something wrong?  Below are the classes and query involved.  Thanks!</p>\n\n<p><strong>AbstractEntity.java:</strong></p>\n\n<pre><code>@MappedSuperclass\n@SuppressWarnings(\"serial\")\npublic abstract class AbstractEntity&lt;ID extends Serializable&gt; extends AbstractBaseEntity\n    implements Serializable {\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Basic(optional = false)\n@Column(nullable = false)\nprotected ID id;\n\n/**\n * Gets the identifier of the entity.\n * \n * @since 0.0.1\n * @return the identifier\n */\npublic ID getId() {\n    return this.id;\n}\n\n/**\n * Sets the identifier of the entity\n *\n * @since 0.0.1\n * @param id the identifier\n */\npublic void setId(ID id) {\n    this.id = id;\n}\n\n/**\n * Determines if the entity is new by checking if the Id is null\n * \n * @since 0.0.1\n * @return true if id == null\n */\npublic boolean isNew() {\n    return id == null;\n}\n\n@Override\npublic int hashCode() {\n    int hash = 0;\n    hash += (id != null ? id.hashCode() : 0);\n    return hash;\n}\n\n@Override\npublic String toString() {\n    return this.getClass().toString() + \"[id=\" + id + \"]\";\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>Employee.java:</strong></p>\n\n<pre><code>@Entity\npublic class Employee  {\n\n@Basic(optional = false)\n@Column(nullable = false, length = 50)\nprivate String firstName;\n\n@Basic(optional = false)\n@Column(nullable = false, length = 50)\nprivate String lastName;\n\npublic Employee() {\n}\n\npublic Employee(Integer id) {\n    this.id = id;\n}\n\npublic Employee(Integer id, String firstName, String lastName) {\n    this.id = id;\n    this.firstName = firstName;\n    this.lastName = lastName;\n}\n\npublic Employee(String firstName, String lastName) {\n    this.firstName = firstName;\n    this.lastName = lastName;\n}\n\npublic String getFirstName() {\n    return firstName;\n}\n\npublic void setFirstName(String firstName) {\n    this.firstName = firstName;\n}\n\npublic String getLastName() {\n    return lastName;\n}\n\npublic void setLastName(String lastName) {\n    this.lastName = lastName;\n}\n\n@Override\npublic boolean equals(Object object) {\n    // TODO: Warning - this method won't work in the case the id fields are not set\n    if (!(object instanceof Employee)) {\n        return false;\n    }\n    Employee other = (Employee) object;\n    if ((this.id == null &amp;&amp; other.id != null) || (this.id != null &amp;&amp; !this.id.equals(other.id))) {\n        return false;\n    }\n    return true;\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>EmployeeService.java method:</strong></p>\n\n<pre><code>public List&lt;Employee&gt; findByCriteria(String employeeName, String officeName,\n        int pageNumber, int pageSize) {\n    CriteriaBuilder cb = entityManager.getCriteriaBuilder();\n    CriteriaQuery&lt;Employee&gt; c = cb.createQuery(Employee.class);\n    Root&lt;Employee&gt; emp = c.from(Employee.class);\n    c.select(emp);\n    c.orderBy(cb.asc(emp.get(\"firstName\")));\n\n    List&lt;Predicate&gt; criteria = new ArrayList&lt;Predicate&gt;();\n    ParameterExpression&lt;String&gt; paramEmployeeName = cb.parameter(String.class);\n    //Build the criteria with parameters\n    if (!StringUtils.isEmpty(employeeName)) {\n\n        criteria.add(cb.or(\n                cb.like(cb.lower(emp.&lt;String&gt;get(\"firstName\")), cb.lower(paramEmployeeName)),\n                cb.like(cb.lower(emp.&lt;String&gt;get(\"lastName\")), cb.lower(paramEmployeeName))));\n    }\n    //Add the criteria to the CriteriaQuery\n    c.where(criteria.toArray(new Predicate[0]));\n\n    TypedQuery&lt;Employee&gt; query = entityManager.createQuery(c);\n    if (!StringUtils.isEmpty(employeeName)) {\n        query.setParameter(paramEmployeeName, \"%\" + employeeName + \"%\");\n    }\n\n    page(query, pageNumber, pageSize);\n\n    return query.getResultList();\n}\n</code></pre>\n"},{"tags":["hibernate","postgresql","tomcat","jdbc"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":283,"score":3,"question_id":11290960,"title":"How to configure PreparedStatement Caching with Postgres and Tomcat7 JDBC Pool?","body":"<p>I am using Tomcat7 with Postgres 9.1 and JPA with Hibernate and I want to configure prepared statement pooling. </p>\n\n<p>The normal default behavior that I have seen by looking at the postgres query log is to see lots of PARSE, BIND, execute for the same query so it seems that even though jdbc prepared statements are used they are not being cached by the postgres jdbc driver or on the server. </p>\n\n<p>Reading online seemed to indicate that I had to configure prepared statement pooling on the postgres jdbc driver so I added <code>connectionProperties=\"prepareThreshold=3\"</code> to my application context.xml resource definition but I still don't see any caching going on it is still a lot of PARSE, BIND messages in the log file, even when I get a prepared statement to execute more than 3 times. </p>\n\n<p>I am aware that the query planner can't make as good of a plan for a prepared statement as a statement with the parameters passed in. Since I am using Hibernate all the statements being sent to the db will be JDBC prepared statements so there is nothing I can do about that. </p>\n\n<p>The application I am working on is not yet in production so I have no field measurements about the value of configuring prepared statement caching? Does it generally improve improve performance in the \nreal world when using postgres and hibernate?</p>\n\n<p>Anyone know to successfully configure prepared statement caching with postgres and tomcat7 jdbc pool not the dbcp pool? my config is below.</p>\n\n<pre><code>&lt;Resource \n        name=\"jdbc/thedb\"\n        factory=\"org.apache.tomcat.jdbc.pool.DataSourceFactory\"\n        auth=\"Container\"\n        type=\"javax.sql.DataSource\"\n\n    jmxEnabled=\"true\"\n    logAbandoned=\"true\"\n    suspectTimeout=\"60000\"\n    jdbcInterceptors=\"StatementFinalizer;ResetAbandonedTimer\"\n\n    driverClassName=\"org.postgresql.Driver\"\n    url=\"jdbc:postgresql://127.0.0.1:5432/thedb\"\n    username=\"theusername\" \n    password=\"thepassword\" \n    connectionProperties=\"prepareThreshold=3\"\n\n    maxActive=\"20\"\n    maxIdle=\"20\" \n    minIdle=\"3\"        \n    maxWait=\"5000\"\n\n    testOnBorrow=\"true\"\n    validationInterval=\"30000\"\n    validationQuery=\"SELECT count(*) FROM data_source_test\"\n/&gt;\n</code></pre>\n"},{"tags":["java","hibernate","jpa-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":13038724,"title":"@GenericGenerator(name = \"generator\", strategy = \"foreign\") to standard JPA 2","body":"<p>I would like to know if there is a standard way to convert something like that</p>\n\n<pre><code>@GenericGenerator(name = \"generator\", strategy = \"foreign\", parameters = @Parameter(name = \"property\", value = \"user\"))\n@Id\n@GeneratedValue(generator = \"generator\")\n@Column(name = \"id\", unique = true, nullable = false)\npublic Integer getId() {\n    return this.id;\n}\n</code></pre>\n\n<p>to standard JPA 2 model without hibernate</p>\n\n<p>EDit : lets see both entities (i've only keep the annoted interessting portion)</p>\n\n<pre><code>@Entity\n@Table(name = \"author\", catalog = \"test\")\npublic class Author implements java.io.Serializable {\n\n    @GenericGenerator(name = \"generator\", strategy = \"foreign\", parameters = @Parameter(name = \"property\", value = \"user\"))\n    @Id\n    @GeneratedValue(generator = \"generator\")\n    @Column(name = \"id\", unique = true, nullable = false)\n    public Integer getId() {\n        return this.id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    @OneToOne(fetch = FetchType.LAZY)\n    @JsonBackReference\n    @PrimaryKeyJoinColumn\n    public User getUser() {\n        return this.user;\n    }\n</code></pre>\n\n<p>AND</p>\n\n<pre><code>@Entity\n@Table(name = \"user\", catalog = \"test\")\npublic class User implements java.io.Serializable {\n    @OneToOne(fetch = FetchType.LAZY, mappedBy = \"user\")\n    public Author getAuthor() {\n        return this.author;\n    }\n</code></pre>\n"},{"tags":["hibernate","jpa","jpa-2.0"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13031469,"title":"JPA single table inheritance: cannot query on the base entity","body":"<p>I have the following entities:</p>\n\n<pre><code>@Entity\n@Table(name = \"TABLENAME\")\n@Inheritance(strategy=InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name=\"discriminator\", discriminatorType=DiscriminatorType.STRING)\npublic class Base { ... }\n\n@Entity\n@DiscriminatorValue(\"value1\")\npublic class SubEntity1 extends Base {}\n\n@Entity\n@DiscriminatorValue(\"value2\")\npublic class SubEntity2 extends Base {}\n</code></pre>\n\n<p>I need to make a query without knowing the actual type of the result. Something like:</p>\n\n<pre><code>select b from Base b where b.discriminator=? and ...\n</code></pre>\n\n<p>I get this exception: <code>Object with id: 31 was not of the specified subclass: packagename.Base</code></p>\n\n<p>In this case the query result would contains only instances of the same sub-entity, but I have other queries where the result would be \"mixed\".</p>\n\n<p>Is there any way to make a query like these?</p>\n"},{"tags":["hibernate","hibernate-mapping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13038768,"title":"Hibernate mapping many to one composite key","body":"<p>I am trying to map a composite key with a many to one relationship.  <a href=\"http://i.stack.imgur.com/ZNPol.png\" rel=\"nofollow\">Here is my SQL Server schema, with identity id fields.</a></p>\n\n<p>Below are my mapping files:</p>\n\n<p>For the Agency Login Alert table:</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n&lt;class name=\"AgencyLoginAlert\" table=\"AGENCY_ALERTS\"&gt;\n    &lt;id name=\"agencyAlertsGID\" type=\"integer\"&gt;\n        &lt;column name=\"AGENCY_ALERTS_GID\" /&gt;\n        &lt;generator class=\"identity\" /&gt;\n    &lt;/id&gt;\n    &lt;property name=\"createdByName\" type=\"string\"&gt;\n        &lt;column name=\"CREATED_BY_NAME\" length=\"30\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"creationDatetime\" type=\"date\"&gt;\n        &lt;column name=\"CREATION_DATETIME\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"lastUpdatedByName\" type=\"string\"&gt;\n        &lt;column name=\"LAST_UPDATED_BY_NAME\" length=\"30\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"lastUpdatedDatetime\" type=\"date\"&gt;\n        &lt;column name=\"LAST_UPDATED_DATETIME\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"startDisplayDatetime\" type=\"date\"&gt;\n        &lt;column name=\"START_DISPLAY_DATETIME\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"endDisplayDatetime\" type=\"date\"&gt;\n        &lt;column name=\"END_DISPLAY_DATETIME\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"messageCategoryCode\" type=\"string\"&gt;\n        &lt;column name=\"MESSAGE_CATEGORY_CODE\" length=\"6\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"messageTitle\" type=\"string\"&gt;\n        &lt;column name=\"MESSAGE_TITLE\" length=\"250\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"messageStatusCode\" type=\"string\"&gt;\n        &lt;column name=\"MESSAGE_STATUS_CODE\" length=\"10\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"messageBodyText\" type=\"string\"&gt;\n        &lt;column name=\"MESSAGE_BODY_TEXT\" length=\"2048\" /&gt;\n    &lt;/property&gt;\n\n    &lt;set name=\"agencyLoginAlertState\" table=\"AGENCY_ALERT_STATE\" inverse=\"true\" lazy=\"true\" fetch=\"select\"&gt;\n        &lt;key&gt;\n            &lt;column name=\"AGENCY_ALERTS_GID\" not-null=\"true\" /&gt;\n        &lt;/key&gt;\n        &lt;one-to-many class=\"AgencyLoginAlertState\" /&gt;\n    &lt;/set&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p></p>\n\n<p>For the Agency Login Alert State table:</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n&lt;class name=\"AgencyLoginAlertState\" table=\"AGENCY_ALERTS\"&gt;\n    &lt;composite-id&gt;\n          &lt;key-many-to-one name=\"agencyAlertsGID\" class=\"AgencyLoginAlert\"&gt;\n                &lt;column name=\"AGENCY_ALERTS_GID\" /&gt;\n          &lt;/key-many-to-one&gt;\n          &lt;key-property name=\"stateCode\" type=\"string\"&gt;\n              &lt;column name=\"STATE_CODE\" length=\"2\" /&gt;\n        &lt;/key-property&gt;\n    &lt;/composite-id&gt;\n    &lt;many-to-one name=\"agencyLoginAlert\" class=\"AgencyLoginAlert\" fetch=\"select\" insert=\"false\" update=\"false\"&gt;\n        &lt;column name=\"AGENCY_ALERTS_GID\" not-null=\"true\" /&gt;\n    &lt;/many-to-one&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p></p>\n\n<p>I am getting the following error: org.hibernate.MappingException: Foreign key (FK416A6411D6548611:AGENCY_ALERTS [AGENCY_ALERTS_GID])) must have same number of columns as the referenced primary key (AGENCY_ALERTS [AGENCY_ALERTS_GID,STATE_CODE])</p>\n\n<p>Any suggestions?  Thanks!</p>\n"},{"tags":["java","hibernate","logging","log4j"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":11723030,"title":"Hibernate suppress info messages","body":"<p>So I am not very experience in Java and I am creating a simple test project with Hibernate but I am gettinga lot of INFO messages on the console that I want to suppress.  I am creating a Java SE program in Eclipse.</p>\n\n<p>Now as I think I understand it then I need to control this in a log4j.properties file, and I seem to have found the appropiate config to use, but the problem is that it appears that it makes no difference!</p>\n\n<p>My guess is that my log4j.properties file is somehow not being read.  But all the details I have found say to place in in the root of my src directory, but it appears not to make any difference.  And I have tried placing it in other places in my classpath but all with no luck.</p>\n\n<p>Can somebody help me track down the issue and resolve this?</p>\n\n<p>I had a similar issue last week with a jndi.properties files while using JMS.  I eventually resolved that by I am guessing that I am doing something wrong in general.  So any tips would be appreciated on where to place config/properties files.</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13035441,"title":"Hibernate Correct Mapping Map","body":"<p>I've the following classes in Hibernate</p>\n\n<pre><code>@Entity\n@Table(name=\"MODEL\")\npublic class Model {\n\n    @Id\n    @GeneratedValue(generator=\"increment\")\n    @GenericGenerator(name=\"increment\", strategy = \"increment\") \n    Long id;\n\n  @ElementCollection(fetch=FetchType.EAGER)\n    @CollectionTable\n    (\n        name=\"DEVICE_LiCENSE_ATTRIBUTE\",\n        joinColumns=@JoinColumn(name=\"DEVICE\")\n    )\n    @MapKeyJoinColumn(name=\"LICENSE_ATTRIBUTE\",nullable=false)\n    Map&lt;String,SoftwareLicense&gt; softwareLicenses = new HashMap&lt;String, SoftwareLicense&gt;();\n\n}\n</code></pre>\n\n<p>And this is my embedded Class</p>\n\n<pre><code>@Embeddable\npublic class SoftwareLicense {\n\n    @Column(name = \"Type\", nullable = false)\n    @Enumerated(EnumType.STRING)\n    private Type type;\n\n    @Column(name = \"VALUE\", nullable = false)\n    private String value;\n}\n</code></pre>\n\n<p>Now when I run Hibernate it trues to build Table</p>\n\n<pre><code>create table DEVICE_LiCENSE_ATTRIBUTE (DEVICE bigint not null, Type varchar(255) not null, VALUE varchar(255) not null, softwareLicenses_KEY varchar(255), primary key (DEVICE, softwareLicenses_KEY)) \n\ncreate table DMS_DEVICE_MODEL (id bigint not null, DESCRIPTION varchar(255) not null, DISPLAYNAME varchar(255) not null, UNIQUENAME varchar(255) not null, primary key (id), unique (UNIQUENAME)) \n</code></pre>\n\n<p>My problem occurs when <code>DEVICE_LICENSE_ATTRIBUTE</code> table created. </p>\n\n<p>Just look at DEVICE_LICENSE_ATTRIBUTE table:</p>\n\n<p><code>softwareLicenses_KEY varchar(255)</code> is nullable and Hibernate tries to create Composite Primary Key on row which is nullable.</p>\n\n<pre><code>primary key (DEVICE, softwareLicenses_KEY)\n</code></pre>\n\n<p>It works on some DB (HSQLDB), but switching my code to another environment (MS SQL 2008) gives me an error. </p>\n\n<pre><code>Cannot define PRIMARY KEY constraint on nullable column in table 'DEVICE_LICENSE_ATTRIBUTE'\n</code></pre>\n\n<p>How can I solve this problem? </p>\n"},{"tags":["hibernate","jpa","orm","coldfusion","railo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":42,"score":-3,"question_id":13033055,"title":"Integrate Hibernate/JPA in Railo CFML","body":"<p>I am working on a project to based on <a href=\"http://getrailo.org\" rel=\"nofollow\">Railo CFML engine</a>, and now want to add an ORM layer to it.</p>\n\n<p>Please provide me some sample codes.</p>\n"},{"tags":["java","apache","hibernate","rest","tomcat"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":11330905,"title":"Using the same Hibernate sessionFactory on all requests on Apache Tomcat 6","body":"<p>I'm trying to understand how <a href=\"http://en.wikipedia.org/wiki/Apache_Tomcat\" rel=\"nofollow\">Apache Tomcat</a> worksm, and I so far believe that it's creating another instance of my application for every request. That's what I get from this line:</p>\n\n<pre><code>result = m.invoke(cls.newInstance(), parameters);\n</code></pre>\n\n<p>in the <code>RestfulTools.java</code>.</p>\n\n<p>I'm using <a href=\"http://en.wikipedia.org/wiki/Hibernate_%28Java%29\" rel=\"nofollow\">Hibernate</a> in my application and getting the Hibernate session from another <a href=\"http://en.wikipedia.org/wiki/Data_access_object\" rel=\"nofollow\">DAO</a> class with methods related to session management. </p>\n\n<p>Is it possible that all these instances created per request use the same <code>sessionFactory</code> for getting the session?</p>\n"},{"tags":["java","hibernate","lazy-loading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":180,"score":0,"question_id":10224282,"title":"How to compare lazy loading objects of same entity on Hibernate?","body":"<p>What's the best way to compare lazy-loaded objects of same entity on Hibernate?</p>\n\n<pre><code>//instanceC and instanceD are different objects of different classes\n\ninstanceC.getA().equals(instanceD.getA()) // false\n\ninstanceC.getA().getId() == insttanceD.getA().getId() // false!\n</code></pre>\n\n<p>So what I do at last is:</p>\n\n<pre><code>int idA=instanceC.getA().getId();\nint idB=instanceD.getA().getId();\n\na==b // true\n</code></pre>\n\n<p>And it looks awfully crooked of course. So what I decided at last is to override the <code>equals()</code> method and hide this mess.</p>\n\n<p>Is there a better (or a right) solution?</p>\n\n<p>Note: I have checked Stack Overflow question <em><a href=\"http://stackoverflow.com/questions/5002670\">Lazy-loaded NHibernate properties in Equals and GetHashCode</a></em> and some more. I'm not asking for a workaround. I want to put up this question for bringing out a better or the exact solution if any exists.</p>\n"},{"tags":["java","multithreading","hibernate","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":205,"score":0,"question_id":9992716,"title":"Multithreading on Hibernate's 'session.flush'","body":"<p>First of all, is this possibly ready-made?</p>\n\n<blockquote>\n  <p>Hibernate 3.6 , JDBC batch_size 500 , using Hilo generator on the\n  200.000 entities.</p>\n</blockquote>\n\n<p>In my example case, I have a request that takes 56 seconds, and I am creating 200,000 entities in the session. So, the <code>session.flush()</code> command takes 32 of those 56 seconds with only one CPU core at %100.</p>\n\n<p>Is there a way to get the list of entities that need to be updated and create the SQL statements, say in four threads?</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13030677,"title":"Hibernate read only session - updating entities","body":"<p>We have set all our sessions to read only by calling <code>setDefaultReadOnly(true)</code>. However our updates no longer work even after we explicitly call <code>session.update(entity)</code>. I can see why this is happening, hibernate does not know that this entity is dirty.</p>\n\n<p>My question is, how can I tell hibernate that I have made changes to this entity which need to be sync'd back? I tried merging the entity with <code>session.merge(entity)</code> but that didn't work.</p>\n"},{"tags":["java","sql","hibernate","java-ee"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3305,"score":3,"question_id":8984837,"title":"org.hibernate.ObjectNotFoundException: No row with the given identifier exists, but it DOES","body":"<p>I've got a hibernate problem that I can't fix.</p>\n\n<p>The setup: JEE, web app, Hibernate 3.2, Tomcat 6, Struts 2.</p>\n\n<p>Basically, I persist an object with my server logic (a struts action), then try and pull that data out for the next page and display it.</p>\n\n<p>I check the database after I save the object, and sure enough, I can see the row there with all the data.</p>\n\n<p>But when I try and retrieve it I get this:</p>\n\n<pre><code>org.hibernate.ObjectNotFoundException: No row with the given identifier exists: [msc.model.Picture#73]\n</code></pre>\n\n<p>To make things even muddier, when I restart Tomcat and try and access the same object, I don't get the error - Hibernate finds the row just fine.</p>\n\n<p>Hibernate will also be able to see the row if I do some other operations - maybe add a row here and there to the database, not even on the same table.</p>\n\n<p>From all this I suspect a Hibernate bug, but I'm a Hibernate newbie so I am probably wrong. Please help! I've googled and googled to no avail.</p>\n\n<p>Here is my Hibernate config:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/msc&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;-------&lt;/property&gt;\n        &lt;!-- JDBC connection pool (use the built-in) --&gt;\n        &lt;property name=\"connection.pool_size\"&gt;80&lt;/property&gt;\n        &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n        &lt;!-- Echo all executed SQL to stdout --&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;mapping resource=\"msc/model/Picture.hbm.xml\"/&gt;\n        &lt;mapping resource=\"msc/model/Comment.hbm.xml\"/&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Here are my two mapping files:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n  &lt;class name=\"msc.model.Picture\" table=\"PICTURE\"&gt;\n    &lt;id column=\"PICTURE_ID\" name=\"id\"&gt;\n      &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"story\"/&gt;\n    &lt;property name=\"email\"/&gt;\n    &lt;property name=\"category\"/&gt;\n    &lt;property name=\"state\"/&gt;\n    &lt;property name=\"ratings\"/&gt;\n    &lt;property name=\"views\"/&gt;\n    &lt;property name=\"timestamp\"/&gt;\n    &lt;property name=\"title\"/&gt;\n    &lt;property lazy=\"true\" name=\"image\" type=\"blob\"&gt;\n      &lt;column name=\"IMAGE\"/&gt;\n    &lt;/property&gt;\n    &lt;property lazy=\"true\" name=\"refinedImage\" type=\"blob\"&gt;\n      &lt;column name=\"REFINEDIMAGE\"/&gt;\n    &lt;/property&gt;\n    &lt;property lazy=\"true\" name=\"thumbnail\" type=\"blob\"&gt;\n      &lt;column name=\"THUMBNAIL\"/&gt;\n    &lt;/property&gt;\n    &lt;bag cascade=\"save-update\" lazy=\"true\" name=\"comments\" table=\"COMMENT\"&gt;\n      &lt;key column=\"PICTURE\"/&gt;\n      &lt;one-to-many class=\"msc.model.Comment\"/&gt;\n    &lt;/bag&gt;\n  &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n  &lt;class name=\"msc.model.User\" table=\"USER\"&gt;\n    &lt;id column=\"USER_ID\" name=\"id\"&gt;\n      &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"username\"/&gt;\n    &lt;property name=\"email\"/&gt;\n    &lt;bag cascade=\"save-update\" lazy=\"true\" name=\"pictures\" table=\"PICTURE\"&gt;\n      &lt;key column=\"USER\"/&gt;\n      &lt;one-to-many class=\"msc.model.Picture\"/&gt;\n    &lt;/bag&gt;\n    &lt;bag cascade=\"save-update\" lazy=\"true\" name=\"comments\" table=\"COMMENT\"&gt;\n      &lt;key column=\"USER\"/&gt;\n      &lt;one-to-many class=\"msc.model.Comment\"/&gt;\n    &lt;/bag&gt;\n  &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Please let me know if you need more info, I'm happy to oblige.</p>\n\n<p>(note: this is not a duplicate of this question, the scenario is not the same <a href=\"http://stackoverflow.com/questions/2847231/no-row-with-the-given-identifier-exists-although-it-does-exist\">&quot;No row with the given identifier exists&quot; although it DOES exist!</a>)</p>\n\n<p><strong>EDIT</strong>: as requested, posting Java code:</p>\n\n<p>Code to save object</p>\n\n<pre><code>Session hib_ses = HibernateUtil.getSessionFactory().getCurrentSession();\n\nhib_ses.beginTransaction();\n\nhib_ses.save(user);\n\nhib_ses.getTransaction().commit(); \n</code></pre>\n\n<p>Code to display data (an image in this case)</p>\n\n<pre><code>public class ImageAction extends ActionSupport implements ServletResponseAware, SessionAware {\n\n    private HttpServletResponse response;\n    Map session;\n    private Long id;\n    private int thumbnail;\n    private InputStream inputStream;\n\n    @Override\n    public String execute() throws Exception {\n        response.setContentType(\"image/jpeg\");\n        Session hib_session = HibernateUtil.getSessionFactory().getCurrentSession();\n        hib_session.beginTransaction();\n\n        //what is the ID now?\n        Picture pic = (Picture) hib_session.load(Picture.class, getId());\n\n        if (thumbnail == 1) {\n            inputStream = (ByteArrayInputStream) pic.getThumbnail().getBinaryStream();\n        } else {\n            inputStream = (ByteArrayInputStream) pic.getRefinedImage().getBinaryStream();\n        }\n\n        hib_session.close();\n        return SUCCESS;\n    }\n</code></pre>\n"},{"tags":["hibernate","struts2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13034439,"title":"Hibernate: java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.(Z)V","body":"<p>When i access to my app login page, the page is loaded. But i a enter a login and password to access to another page i have an exception: </p>\n\n<pre><code>Struts has detected an unhandled exception:\nMessages:   \norg.objectweb.asm.ClassWriter.(Z)V\nFile:   net/sf/cglib/core/DebuggingClassWriter.java\nLine number:    47\nStacktraces\njava.lang.reflect.InvocationTargetException\n\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:453)\n    com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:292)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:255)\n    org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:256)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:176)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:265)\n    org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:138)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:236)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:236)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:90)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)\n    org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:511)\n    org.apache.struts2.dispatcher.ng.ExecuteOperations.executeAction(ExecuteOperations.java:77)\n    org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.doFilter(StrutsPrepareAndExecuteFilter.java:91)\n    org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n    org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235)\n    org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190)\n    org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92)\n    org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)\n    org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70)\n    org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)\n    org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330)\n    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:829)\n    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:598)\n    org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n    java.lang.Thread.run(Thread.java:662)\n\n\njava.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.(Z)V\n\n    net.sf.cglib.core.DebuggingClassWriter.(DebuggingClassWriter.java:47)\n    net.sf.cglib.core.DefaultGeneratorStrategy.getClassWriter(DefaultGeneratorStrategy.java:30)\n    net.sf.cglib.core.DefaultGeneratorStrategy.generate(DefaultGeneratorStrategy.java:24)\n    net.sf.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:216)\n    net.sf.cglib.core.KeyFactory$Generator.create(KeyFactory.java:145)\n    net.sf.cglib.core.KeyFactory.create(KeyFactory.java:117)\n    net.sf.cglib.core.KeyFactory.create(KeyFactory.java:108)\n    net.sf.cglib.core.KeyFactory.create(KeyFactory.java:104)\n    net.sf.cglib.proxy.Enhancer.(Enhancer.java:69)\n    org.hibernate.proxy.pojo.cglib.CGLIBLazyInitializer.getProxyFactory(CGLIBLazyInitializer.java:111)\n    org.hibernate.proxy.pojo.cglib.CGLIBProxyFactory.postInstantiate(CGLIBProxyFactory.java:43)\n    org.hibernate.tuple.entity.PojoEntityTuplizer.buildProxyFactory(PojoEntityTuplizer.java:162)\n    org.hibernate.tuple.entity.AbstractEntityTuplizer.(AbstractEntityTuplizer.java:135)\n    org.hibernate.tuple.entity.PojoEntityTuplizer.(PojoEntityTuplizer.java:55)\n    org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping.(EntityEntityModeToTuplizerMapping.java:56)\n    org.hibernate.tuple.entity.EntityMetamodel.(EntityMetamodel.java:269)\n    org.hibernate.persister.entity.AbstractEntityPersister.(AbstractEntityPersister.java:425)\n    org.hibernate.persister.entity.SingleTableEntityPersister.(SingleTableEntityPersister.java:109)\n    org.hibernate.persister.PersisterFactory.createClassPersister(PersisterFactory.java:55)\n    org.hibernate.impl.SessionFactoryImpl.(SessionFactoryImpl.java:226)\n    org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1218)\n    fr.si2m.occ.dao.sessions.HibernateFactory.(HibernateFactory.java:56)\n    fr.si2m.occ.dao.interfaces.AbstractDAO.(AbstractDAO.java:26)\n    fr.si2m.occ.dao.impl.MessageDAOImpl.(MessageDAOImpl.java:19)\n    fr.si2m.occ.utils.MessageUtils.listMessages(MessageUtils.java:22)\n    fr.si2m.occ.web.actions.LoginAction.execute(LoginAction.java:128)\n    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    java.lang.reflect.Method.invoke(Method.java:597)\n    com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:453)\n    com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:292)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:255)\n    org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:256)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:176)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:265)\n    org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:138)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:236)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:236)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:190)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:90)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:243)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:100)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:141)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:145)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:171)\n    com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:98)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:176)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:192)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:187)\n    com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:249)\n    org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:54)\n    org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:511)\n    org.apache.struts2.dispatcher.ng.ExecuteOperations.executeAction(ExecuteOperations.java:77)\n    org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.doFilter(StrutsPrepareAndExecuteFilter.java:91)\n    org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)\n    org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n    org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n    org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:235)\n    org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n    org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:190)\n    org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:92)\n    org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.process(SecurityContextEstablishmentValve.java:126)\n    org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:70)\n    org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n    org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n    org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)\n    org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:330)\n    org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:829)\n    org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:598)\n    org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n    java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p>I think i have a conflict but i don't know which one. Here is my pom file : </p>\n\n<pre><code>&lt;dependencies&gt;\n      &lt;dependency&gt;\n        &lt;groupId&gt;commons-collections&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;\n        &lt;version&gt;3.1&lt;/version&gt;\n      &lt;/dependency&gt;\n      &lt;dependency&gt;\n        &lt;groupId&gt;commons-digester&lt;/groupId&gt;\n        &lt;artifactId&gt;commons-digester&lt;/artifactId&gt;\n        &lt;version&gt;1.7&lt;/version&gt;\n      &lt;/dependency&gt;\n      &lt;dependency&gt;\n        &lt;groupId&gt;com.sas&lt;/groupId&gt;\n        &lt;artifactId&gt;sas.core&lt;/artifactId&gt;\n        &lt;version&gt;902000&lt;/version&gt;\n        &lt;scope&gt;provided&lt;/scope&gt;\n      &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n  &lt;/dependencyManagement&gt;\n  &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;asm&lt;/groupId&gt;\n      &lt;artifactId&gt;asm&lt;/artifactId&gt;\n      &lt;version&gt;3.3.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;cglib&lt;/groupId&gt;\n      &lt;artifactId&gt;cglib-nodep&lt;/artifactId&gt;\n      &lt;version&gt;2.1_3&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n      &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n      &lt;version&gt;1.6.6&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;log4j&lt;/groupId&gt;\n      &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n      &lt;version&gt;1.2.17&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n      &lt;exclusions&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;jmxtools&lt;/artifactId&gt;\n          &lt;groupId&gt;com.sun.jdmk&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;jmxri&lt;/artifactId&gt;\n          &lt;groupId&gt;com.sun.jmx&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n      &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n      &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n      &lt;version&gt;1.1.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;javax.transaction&lt;/groupId&gt;\n      &lt;artifactId&gt;jta&lt;/artifactId&gt;\n      &lt;version&gt;1.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n      &lt;artifactId&gt;hibernate&lt;/artifactId&gt;\n      &lt;version&gt;3.2.0.ga&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n      &lt;exclusions&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n          &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n      &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n      &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;\n      &lt;version&gt;3.2.0.ga&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;mysql&lt;/groupId&gt;\n      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n      &lt;version&gt;5.1.21&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.sas&lt;/groupId&gt;\n      &lt;artifactId&gt;sas.core&lt;/artifactId&gt;\n      &lt;version&gt;902300&lt;/version&gt;\n      &lt;scope&gt;provided&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.sas&lt;/groupId&gt;\n      &lt;artifactId&gt;sas.svc.connection&lt;/artifactId&gt;\n      &lt;version&gt;902300&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n      &lt;artifactId&gt;struts2-core&lt;/artifactId&gt;\n      &lt;version&gt;2.3.4.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;javassist&lt;/groupId&gt;\n      &lt;artifactId&gt;javassist&lt;/artifactId&gt;\n      &lt;version&gt;3.8.0.GA&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;\n      &lt;version&gt;2.5&lt;/version&gt;\n      &lt;scope&gt;provided&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;jstl&lt;/groupId&gt;\n      &lt;artifactId&gt;jstl&lt;/artifactId&gt;\n      &lt;version&gt;1.2&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n      &lt;artifactId&gt;struts2-tiles-plugin&lt;/artifactId&gt;\n      &lt;version&gt;2.3.4.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;\n      &lt;artifactId&gt;tiles-jsp&lt;/artifactId&gt;\n      &lt;version&gt;2.0.6&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n      &lt;exclusions&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n          &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n      &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;\n      &lt;artifactId&gt;tiles-core&lt;/artifactId&gt;\n      &lt;version&gt;2.0.6&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt;\n      &lt;artifactId&gt;tiles-api&lt;/artifactId&gt;\n      &lt;version&gt;2.0.6&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n      &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;\n      &lt;version&gt;1.8.3&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n      &lt;exclusions&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n          &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n      &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;junit&lt;/groupId&gt;\n      &lt;artifactId&gt;junit&lt;/artifactId&gt;\n      &lt;version&gt;4.0&lt;/version&gt;\n      &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n      &lt;artifactId&gt;struts2-json-plugin&lt;/artifactId&gt;\n      &lt;version&gt;2.3.4.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.jgeppert.struts2.jquery&lt;/groupId&gt;\n      &lt;artifactId&gt;struts2-jquery-plugin&lt;/artifactId&gt;\n      &lt;version&gt;3.3.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.jsoup&lt;/groupId&gt;\n      &lt;artifactId&gt;jsoup&lt;/artifactId&gt;\n      &lt;version&gt;1.3.3&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.lowagie&lt;/groupId&gt;\n      &lt;artifactId&gt;itext&lt;/artifactId&gt;\n      &lt;version&gt;2.1.7&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;net.sf.jasperreports&lt;/groupId&gt;\n      &lt;artifactId&gt;jasperreports&lt;/artifactId&gt;\n      &lt;version&gt;4.1.2&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n      &lt;exclusions&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n          &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n      &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.eclipse.jdt&lt;/groupId&gt;\n      &lt;artifactId&gt;core&lt;/artifactId&gt;\n      &lt;version&gt;3.3.0-v_771&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n      &lt;artifactId&gt;struts2-jasperreports-plugin&lt;/artifactId&gt;\n      &lt;version&gt;2.2.1.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;\n      &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;\n      &lt;version&gt;1.2.2&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;commons-io&lt;/groupId&gt;\n      &lt;artifactId&gt;commons-io&lt;/artifactId&gt;\n      &lt;version&gt;2.4&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.freemarker&lt;/groupId&gt;\n      &lt;artifactId&gt;freemarker&lt;/artifactId&gt;\n      &lt;version&gt;2.3.19&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.xhtmlrenderer&lt;/groupId&gt;\n      &lt;artifactId&gt;core-renderer&lt;/artifactId&gt;\n      &lt;version&gt;R8pre2&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.mentaframework&lt;/groupId&gt;\n      &lt;artifactId&gt;mentawai&lt;/artifactId&gt;\n      &lt;version&gt;1.13&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;xalan&lt;/groupId&gt;\n      &lt;artifactId&gt;xalan&lt;/artifactId&gt;\n      &lt;version&gt;2.7.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n      &lt;exclusions&gt;\n        &lt;exclusion&gt;\n          &lt;artifactId&gt;xml-apis&lt;/artifactId&gt;\n          &lt;groupId&gt;xml-apis&lt;/groupId&gt;\n        &lt;/exclusion&gt;\n      &lt;/exclusions&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.google.collections&lt;/groupId&gt;\n      &lt;artifactId&gt;google-collections&lt;/artifactId&gt;\n      &lt;version&gt;1.0&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n</code></pre>\n\n<p>Could you give me some help please ?</p>\n"},{"tags":["java","mysql","sql","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13028959,"title":"Hibernate mysql groupe by day concequetive results","body":"<p>I have this function</p>\n\n<p>i need to do that in sql (hibernate or mysql) or a java function that interpert the array of results</p>\n\n<p>i need a consequetive results fort groupe by day</p>\n\n<p>select DAY(prop.docCreationDate), count(prop.docfullName) from propCode.propClass as prop where prop.docCreationDate >= '\" + startDate + \" 00:00:00' and prop.docCreationDate &lt;= '\" + endDate + \" 23:59:59' GROUP BY DAY(prop.docCreationDate)\"</p>\n\n<pre><code>i have this entitie count in my table\n2012-10-05   3\n2012-10-06   0\n2012-10-07   7\n2012-10-08   13\n2012-10-09   9\n2012-10-10   0\n2012-10-11   0\n2012-10-12   3\n\nthe request return me this values\n5    3\n7    7\n8    13\n9    9\n12   3\n\nin this way i loose three lignes that have 0 as value, i need a request that return me this\n5    3\n6    0\n7    7\n8    13\n9    9\n10   0\n11   0\n12   3  \n</code></pre>\n"},{"tags":["java","spring","hibernate","ehcache"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13032552,"title":"A soft-locked cache entry was removed already. Out of balance lock/unlock sequences?","body":"<p>I'am using java 1.6, spring 2.5, hibernate 3.3.1 and ehcache 2.6.0. Programs is connected to two databases. There is two ehcache configurations, but in this case only one is used.\nAt the end of the batch the programs return this error :</p>\n\n<pre><code>    2012-10-23 15:44:43,406 ERROR (AbstractReadWriteEhcacheAccessStrategy.java:159) - Cache dao.data.MyObject Key dao.data.MyObject#28 Lockable : null\nA soft-locked cache entry was removed already. Out of balance lock/unlock sequences ?\n</code></pre>\n\n<p>What can produce this error ?</p>\n"},{"tags":["java","mysql","hibernate","jdbc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13031351,"title":"com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'sequence_next_hi_value' in 'field list","body":"<p>Anybody can tell what cause this error?</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: \nUnknown column 'sequence_next_hi_value' in 'field list\n</code></pre>\n\n<p>I am connecting to a <code>mysql</code> database using <code>hibernate</code>. I was able to connect to the database and everything was working fine till I change the <code>persistence.xml</code> and added a <code>datasource</code>.</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13012333,"title":"spring persistence xml","body":"<p>What is the difference between:</p>\n\n<p>persistenc.xml can be configured with hibernate properties OR Javax.persistence properties.</p>\n\n<p>What scenarios would you use either one.</p>\n\n<p>I tried using javax.persistence but my spring app would not work.. changed it to hibernate and it started working.</p>\n"},{"tags":["java","spring","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13006398,"title":"unable to persist entity in spring tests with JpaTransactionManager","body":"<p>I'm trying to persist an entity using. My test case works (data are persisted in db) when I handle my transaction myself.</p>\n\n<pre><code>public User saveUser(User user) {\n    getEm().getTransaction().begin();\n    getEm().persist(user);\n    getEm().getTransaction().commit();      \n    return user;\n}\n</code></pre>\n\n<p>(entity manager comes from a template class which my DAO class extends)</p>\n\n<p>It stops persisiting data when I configure spring to handle transactions.</p>\n\n<p>test-context.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:jdbc=\"http://www.springframework.org/schema/jdbc\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd \n    http://www.springframework.org/schema/jdbc \n    http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd \n    http://www.springframework.org/schema/tx \n    http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\"&gt;\n\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n    &lt;bean id=\"entityManagerFactory\"\n        class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"persistenceUnitName\" value=\"domainPU\" /&gt;\n        &lt;property name=\"loadTimeWeaver\"&gt;\n            &lt;bean\n                class=\"org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"\n        destroy-method=\"close\"&gt;\n        &lt;property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\" /&gt;\n        &lt;property name=\"url\" value=\"jdbc:mysql://192.168.5.111/testdb\" /&gt;\n        &lt;property name=\"username\" value=\"sdgdsgs\" /&gt;\n        &lt;property name=\"password\" value=\"sdfgdsg\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n        &lt;property name=\"entityManagerFactory\"&gt;\n            &lt;ref local=\"entityManagerFactory\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>UsersRepositoryTest:</p>\n\n<pre><code>@ContextConfiguration(locations = { \"classpath:test-context.xml\", \"classpath:module-context.xml\" })\n@TransactionConfiguration(defaultRollback=false)\npublic class UsersRepositoryTest extends AbstractTransactionalTestNGSpringContextTests {\n\n    @Autowired\n    private UsersRepository usersRepository;\n\n    @Test(dependsOnMethods = {\"findUserByLogin\"})\n    public void registerUser() throws DataAccessException {\n        User myUser = getUserHomer();\n        usersRepository.saveUser(myUser);\n\n        User returnedUser = usersRepository.getUserByLogin(myUser.getLogin());\n\n        assertNotNull(returnedUser);\n                ...\n    }\n}\n</code></pre>\n\n<p>stacktrace:</p>\n\n<pre><code>2012-10-22 08:26:26 org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean createNativeEntityManagerFactory\nINFO: Building JPA container EntityManagerFactory for persistence unit 'domainPU'\n2012-10-22 08:26:26 org.hibernate.annotations.common.Version &lt;clinit&gt;\nINFO: HCANN000001: Hibernate Commons Annotations {4.0.1.Final}\n2012-10-22 08:26:26 org.hibernate.Version logVersion\nINFO: HHH000412: Hibernate Core {4.1.6.Final}\n2012-10-22 08:26:26 org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: HHH000206: hibernate.properties not found\n2012-10-22 08:26:26 org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: HHH000021: Bytecode provider name : javassist\n2012-10-22 08:26:26 org.hibernate.ejb.Ejb3Configuration configure\nINFO: HHH000204: Processing PersistenceUnitInfo [\n    name: domainPU\n    ...]\n2012-10-22 08:26:26 org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator instantiateExplicitConnectionProvider\nINFO: HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider\n2012-10-22 08:26:27 org.hibernate.dialect.Dialect &lt;init&gt;\nINFO: HHH000400: Using dialect: org.hibernate.dialect.MySQLDialect\n2012-10-22 08:26:27 org.hibernate.engine.jdbc.internal.LobCreatorBuilder useContextualLobCreation\nINFO: HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException\n2012-10-22 08:26:27 org.hibernate.engine.transaction.internal.TransactionFactoryInitiator initiateService\nINFO: HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory\n2012-10-22 08:26:27 org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory &lt;init&gt;\nINFO: HHH000397: Using ASTQueryTranslatorFactory\n2012-10-22 08:26:27 org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization\nINFO: Bean 'entityManagerFactory' of type [class org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)\n2012-10-22 08:26:27 org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization\nINFO: Bean 'hibernateTranslator' of type [class org.springframework.orm.hibernate4.HibernateExceptionTranslator] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)\n2012-10-22 08:26:27 org.springframework.beans.factory.support.DefaultListableBeanFactory preInstantiateSingletons\nINFO: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@5c28305d: defining beans [org.springframework.aop.config.internalAutoProxyCreator,org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0,org.springframework.transaction.interceptor.TransactionInterceptor#0,org.springframework.transaction.config.internalTransactionAdvisor,entityManagerFactory,dataSource,transactionManager,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,hibernateTranslator,usersDao,zoneDao,usersRepository,zoneRepository,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy\n2012-10-22 08:26:27 org.springframework.test.context.transaction.TransactionalTestExecutionListener startNewTransaction\nINFO: Began transaction (1): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3341b736]; rollback [false]\nHibernate: select user0_.id as id0_, user0_.active as active0_, user0_.creation_date as creation3_0_, user0_.email as email0_, user0_.last_login_date as last5_0_, user0_.login as login0_, user0_.password as password0_, user0_1_.AVATAR as AVATAR1_, user0_1_.FIRST_NAME as FIRST2_1_, user0_1_.ID as ID1_, user0_1_.LAST_NAME as LAST4_1_, case when user0_1_.id is not null then 1 when user0_.id is not null then 0 end as clazz_ from user user0_ left outer join client user0_1_ on user0_.id=user0_1_.id where user0_.login=?\nHibernate: select phone0_.id as id2_0_, phone0_.phone_number as phone2_2_0_, phone0_.user_id as user3_2_0_ from phone phone0_ where phone0_.id=?\nHibernate: select address0_.ID as ID6_0_, address0_.apartment_number as apartment2_6_0_, address0_.city as city6_0_, address0_.country as country6_0_, address0_.house_number as house5_6_0_, address0_.post_code as post6_6_0_, address0_.street as street6_0_ from address address0_ where address0_.ID=?\nHibernate: select user0_.id as id0_, user0_.active as active0_, user0_.creation_date as creation3_0_, user0_.email as email0_, user0_.last_login_date as last5_0_, user0_.login as login0_, user0_.password as password0_, user0_1_.AVATAR as AVATAR1_, user0_1_.FIRST_NAME as FIRST2_1_, user0_1_.ID as ID1_, user0_1_.LAST_NAME as LAST4_1_, case when user0_1_.id is not null then 1 when user0_.id is not null then 0 end as clazz_ from user user0_ left outer join client user0_1_ on user0_.id=user0_1_.id where user0_.login=?\n2012-10-22 08:26:27 org.springframework.test.context.transaction.TransactionalTestExecutionListener endTransaction\nINFO: Committed transaction after test execution for test context [[TestContext@63edf84f testClass = UsersRepositoryTest, testInstance = pl.eports.zonen.user.repository.UsersRepositoryTest@7e3bc473, testMethod = findUserByLogin@UsersRepositoryTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1c493dca testClass = UsersRepositoryTest, locations = '{classpath:test-context.xml, classpath:module-context.xml}', classes = '{}', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader']]]\n2012-10-22 08:26:27 org.springframework.test.context.transaction.TransactionalTestExecutionListener startNewTransaction\nINFO: Began transaction (2): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3341b736]; rollback [false]\nHibernate: select user0_.id as id0_, user0_.active as active0_, user0_.creation_date as creation3_0_, user0_.email as email0_, user0_.last_login_date as last5_0_, user0_.login as login0_, user0_.password as password0_, user0_1_.AVATAR as AVATAR1_, user0_1_.FIRST_NAME as FIRST2_1_, user0_1_.ID as ID1_, user0_1_.LAST_NAME as LAST4_1_, case when user0_1_.id is not null then 1 when user0_.id is not null then 0 end as clazz_ from user user0_ left outer join client user0_1_ on user0_.id=user0_1_.id where user0_.login=?\n2012-10-22 08:26:27 org.springframework.test.context.transaction.TransactionalTestExecutionListener endTransaction\nINFO: Committed transaction after test execution for test context [[TestContext@63edf84f testClass = UsersRepositoryTest, testInstance = pl.eports.zonen.user.repository.UsersRepositoryTest@7e3bc473, testMethod = registerUser@UsersRepositoryTest, testException = java.lang.AssertionError: expected object to not be null, mergedContextConfiguration = [MergedContextConfiguration@1c493dca testClass = UsersRepositoryTest, locations = '{classpath:test-context.xml, classpath:module-context.xml}', classes = '{}', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader']]]\nPASSED: findUserByLogin\nFAILED: registerUser\njava.lang.AssertionError: expected object to not be null\n    at org.testng.Assert.fail(Assert.java:94)\n        ...\n</code></pre>\n\n<p>As you can see from the stacktrace, transaction seems to be started and finished, but no sql inserts are produced and no data are inserted into db (data rollback is set to false)</p>\n\n<p>I've tried force flushing data after persist() but spring managed transaction seems to be finished by then.</p>\n\n<p>I've looked for a similar issue on forums but none works.\nI can provide some more code if necessary.</p>\n\n<p>I'm using Spring 3.1.2 and Hibernate 4.1.6.Final</p>\n\n<p><strong>update:</strong></p>\n\n<p>DAO: (@Transactional annotation is put here instead on service layer temporarily)</p>\n\n<pre><code>@Repository\npublic class JpaUsersDAO extends JpaDAOTemplate&lt;User&gt; implements UsersDAO {\n\npublic JpaUsersDAO(EntityManagerFactory factory) {\n    super(factory.createEntityManager(), User.class);\n}\n\n    @Transactional\n    public User saveUser(User user) {\n        getEm().persist(user);  \n        return user;\n    }\n}\n</code></pre>\n\n<p>DAOTemplate:</p>\n\n<pre><code>public abstract class JpaDAOTemplate&lt;T extends Serializable&gt; {\n\n    private EntityManager em;\n\n    private Class&lt;T&gt; clazz;\n\n    public JpaDAOTemplate(EntityManager em, final Class&lt;T&gt; clazz) {\n        this.em = em;\n        this.clazz = clazz;\n    }\n\n    public EntityManager getEm() {\n        return em;\n    }\n\n    public T getById(Integer id) {...}\n    ...\n}\n</code></pre>\n\n<p>bean definition:</p>\n\n<pre><code>&lt;bean id=\"usersDao\"\n    class=\"pl.package.user.dao.impl.JpaUsersDAO\"&gt;\n    &lt;constructor-arg ref=\"entityManagerFactory\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>It seems that the transaction is lost somewhere after selects and before calling getEm().persist() - <strong>org.hibernate.ejb.TransactionImpl#tx is null</strong> when calling persist() but it was <strong>org.hibernate.engine.transaction.internal.jdbc.JDBCTransaction</strong> before the call (when sql select statements calls were made)</p>\n\n<p><strong>update 2</strong>\ndebug level stacktrace:</p>\n\n<pre><code>[2012-10-23 11:15:14,546]DEBUG 38629[main] - org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:365) - Creating new transaction with name [registerUser]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; ''\n[2012-10-23 11:15:33,252]DEBUG 57335[main] - org.hibernate.internal.SessionImpl.&lt;init&gt;(SessionImpl.java:316) - Opened session at timestamp: 13509837332\n[2012-10-23 11:15:33,252]DEBUG 57335[main] - org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:368) - Opened new EntityManager [org.hibernate.ejb.EntityManagerImpl@18025c5c] for JPA transaction\n[2012-10-23 11:15:40,085]DEBUG 64168[main] - org.hibernate.engine.transaction.spi.AbstractTransactionImpl.begin(AbstractTransactionImpl.java:158) - begin\n[2012-10-23 11:15:40,101]DEBUG 64184[main] - org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.obtainConnection(LogicalConnectionImpl.java:295) - Obtaining JDBC connection\n[2012-10-23 11:15:40,101]DEBUG 64184[main] - org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.obtainConnection(LogicalConnectionImpl.java:301) - Obtained JDBC connection\n[2012-10-23 11:15:40,101]DEBUG 64184[main] - org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.doBegin(JdbcTransaction.java:69) - initial autocommit status: true\n[2012-10-23 11:15:40,101]DEBUG 64184[main] - org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.doBegin(JdbcTransaction.java:71) - disabling autocommit\n[2012-10-23 11:16:06,934]DEBUG 91017[main] - org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:407) - Not exposing JPA transaction [org.hibernate.ejb.EntityManagerImpl@18025c5c] as JDBC transaction because JpaDialect [org.springframework.orm.jpa.DefaultJpaDialect@5f343722] does not support JDBC Connection retrieval\n[2012-10-23 11:16:06,934]DEBUG 91017[main] - org.springframework.test.context.transaction.TransactionalTestExecutionListener.isRollback(TransactionalTestExecutionListener.java:357) - No method-level @Rollback override: using default rollback [false] for test context [[TestContext@5809fdee testClass = UsersRepositoryTest, testInstance = pl.eports.zonen.user.repository.UsersRepositoryTest@3fde891b, testMethod = registerUser@UsersRepositoryTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@77fe4169 testClass = UsersRepositoryTest, locations = '{classpath:test-context.xml, classpath:module-context.xml}', classes = '{}', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader']]]\n[2012-10-23 11:16:06,934] INFO 91017[main] - org.springframework.test.context.transaction.TransactionalTestExecutionListener.startNewTransaction(TransactionalTestExecutionListener.java:275) - Began transaction (1): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@37977909]; rollback [false]\n[2012-10-23 11:17:08,103]DEBUG152186[main] - org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:245) - Returning cached instance of singleton bean 'org.springframework.transaction.interceptor.TransactionInterceptor#0'\n[2012-10-23 11:17:08,118]DEBUG152201[main] - org.springframework.transaction.interceptor.AbstractFallbackTransactionAttributeSource.getTransactionAttribute(AbstractFallbackTransactionAttributeSource.java:106) - Adding transactional method 'saveUser' with attribute: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; ''\n[2012-10-23 11:17:08,118]DEBUG152201[main] - org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:245) - Returning cached instance of singleton bean 'txManager'\n[2012-10-23 11:17:27,073]DEBUG171156[main] - org.springframework.orm.jpa.JpaTransactionManager.doGetTransaction(JpaTransactionManager.java:331) - Found thread-bound EntityManager [org.hibernate.ejb.EntityManagerImpl@18025c5c] for JPA transaction\n[2012-10-23 11:18:04,031]DEBUG208114[main] - org.springframework.transaction.support.AbstractPlatformTransactionManager.handleExistingTransaction(AbstractPlatformTransactionManager.java:470) - Participating in existing transaction\n</code></pre>\n\n<p><strong>Final update:</strong></p>\n\n<p>Problem was in the way I injected EntityManagerFactory to my DAO. I used applicationContext.xml configuration file to inject it (this way EMF does not participate in transaction). To have it working I changed my DAO class to:</p>\n\n<pre><code>@Repository\npublic class JpaUsersDAO extends JpaDAOTemplate&lt;User&gt; implements UsersDAO {\n\n    @PersistenceContext\n    private EntityManager em;\n...\n}\n</code></pre>\n"},{"tags":["java","mysql","hibernate","primary-key"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":114,"score":-1,"question_id":13029355,"title":"ConstraintViolationException: Duplicate entry for key 'PRIMARY' when using Hibernate and MySQL?","body":"<pre><code>    Session session = HibernateUtil.getTestSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    session.save(test1);\n    session.save(test2);\n    session.save(test3);\n    session.getTransaction().commit();\n\n    WARN: SQL Error: 1062, SQLState: 23000\nERROR: Duplicate entry '9900001' for key 'PRIMARY'\nWARNING: #{RmaBean.send}: org.hibernate.exception.ConstraintViolationException: Duplicate entry '9900001' for key 'PRIMARY'\njavax.faces.FacesException: #{RmaBean.send}: org.hibernate.exception.ConstraintViolationException: Duplicate entry '9900001' for key 'PRIMARY'\n    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118)\n</code></pre>\n\n<p>So, when trying to insert test1 to db I always get that exception. Before inserting that test1 I populate its PK fetching the last PK from DB and adding +1 into it. Is Hibernate somehow keeping in memory that pk and I shouldn't use insert but update?</p>\n\n<p>UPDATE: `</p>\n\n<pre><code>&lt;class name=\"test1\" table=\"test1\" catalog=\"testing\"&gt;\n    &lt;id name=\"testPK\" type=\"long\"&gt;\n        &lt;column name=\"testPK\" /&gt;\n        &lt;generator class=\"assigned\" /&gt;\n    &lt;/id&gt;`\n</code></pre>\n\n<p>This code was implemented by another person and I just checked from db that there is no Auto Increment true. Assigned means that I have to provide the PK and I am trying to do it.</p>\n\n<pre><code>public Integer getLastPK {\n\n\n    Session session = HibernateUtil.getTestSessionFactory().getCurrentSession();\n    Integer pk = null;\n    try{\n\n    session.beginTransaction();\n\n\n    pk = new Integer(session.createSQLQuery(\"SELECT LAST_INSERT_ID() from testing.test1\").uniqueResult().toString());  \n    session.getTransaction().commit();\n\n    System.out.println(\"1.....pk-----------&gt;\"+pk);\n\n    if(pk != null &amp;&amp; pk &lt;= 9900001){\n        System.out.println(\"IF...\");\n        pk=9900001;\n\n    }else if(pk != null &amp;&amp; pk &gt; 9900001){\n\n        pk = pk+1;\n    }\n</code></pre>\n\n<p>UPDATE2: I changed the pk to Auto Increment:</p>\n\n<p>ALTER TABLE <code>testing</code>.<code>test1</code> AUTO_INCREMENT = 9900001 , CHANGE COLUMN <code>testPK</code> <code>testPK</code> BIGINT(20) NOT NULL AUTO_INCREMENT  ;</p>\n\n<p>Is this good idea or not? I changed hbm.xml file as well...</p>\n\n<p>Thanks for helping!\nSami</p>\n"},{"tags":["hibernate","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":279,"score":2,"question_id":6723918,"title":"Hibernate Tools fails to detect One-to-One Relationship","body":"<p>i am trying to generate Entity Classes from MySQL database using Hibernate Tools (Annotations) in Eclipse. However, I am having trouble in generating one-to-one relationship code. My MySQL table is currently ensuring this relationship yet Hibernate tools does not detect it...</p>\n\n<p>\"A User is Associated with Exactly One Employee\"</p>\n\n<p>Here is the code for my tables.. Users first</p>\n\n<pre><code>CREATE TABLE `user` (\n`user_id` int(11) NOT NULL AUTO_INCREMENT,\n`username` varchar(20) NOT NULL,\n`password` varchar(45) NOT NULL,\n`is_active` tinyint(1) NOT NULL DEFAULT '1',\n`role_id` int(11) NOT NULL,\n`emp_id` int(11) NOT NULL,\nPRIMARY KEY (`user_id`),\nUNIQUE KEY `employee_emp_id_UNIQUE` (`emp_id`),\nKEY `fk_user_role` (`role_id`),\nKEY `fk_user_employee1` (`emp_id`),\nCONSTRAINT `fk_user_role` FOREIGN KEY (`role_id`) REFERENCES `role` (`role_id`) ON\nDELETE NO ACTION ON UPDATE NO ACTION,\nCONSTRAINT `fk_user_employee1` FOREIGN KEY (`emp_id`) REFERENCES `employee` (`emp_id`)\nON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=latin1\n</code></pre>\n\n<p>And Employee 2nd</p>\n\n<pre><code>CREATE TABLE `employee` (\n`emp_id` int(11) NOT NULL AUTO_INCREMENT,\n`name` varchar(45) NOT NULL,\n`address` varchar(45) DEFAULT NULL,\n`CNIC` varchar(15) DEFAULT NULL,\n`hourly_rate` int(11) NOT NULL,\n`is_allowed` tinyint(1) NOT NULL DEFAULT '0',\n`is_active` tinyint(1) NOT NULL DEFAULT '1',\n`code` varchar(5) NOT NULL,\nPRIMARY KEY (`emp_id`),\nUNIQUE KEY `code_UNIQUE` (`code`)\n) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1\n</code></pre>\n\n<p>The code generated is One to Many...</p>\n\n<p>For User Class</p>\n\n<pre><code>@Entity\n@Table(name = \"user\", catalog = \"ieeepi_pharmacy\", uniqueConstraints =\n@UniqueConstraint(columnNames = \"emp_id\"))\npublic class User implements java.io.Serializable {\n\nprivate int userId;\nprivate Role role;\nprivate Employee employee;\nprivate String username;\nprivate String password;\nprivate boolean isActive;\n\n@Id\n@GeneratedValue(strategy = IDENTITY)\n@Column(name = \"user_id\", unique = true, nullable = false)\npublic int getUserId() {\n    return this.userId;\n}\n\npublic void setUserId(int userId) {\n    this.userId = userId;\n}\n\n@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"role_id\", nullable = false)\npublic Role getRole() {\n    return this.role;\n}\n\npublic void setRole(Role role) {\n    this.role = role;\n}\n\n@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"emp_id\", unique = true, nullable = false)\npublic Employee getEmployee() {\n    return this.employee;\n}\n\npublic void setEmployee(Employee employee) {\n    this.employee = employee;\n}\n\n@Column(name = \"username\", nullable = false, length = 20)\npublic String getUsername() {\n    return this.username;\n}\n\npublic void setUsername(String username) {\n    this.username = username;\n}\n\n@Column(name = \"password\", nullable = false, length = 45)\npublic String getPassword() {\n    return this.password;\n}\n\npublic void setPassword(String password) {\n    this.password = password;\n}\n\n@Column(name = \"is_active\", nullable = false)\npublic boolean isIsActive() {\n    return this.isActive;\n}\n\npublic void setIsActive(boolean isActive) {\n    this.isActive = isActive;\n}\n\n}\n</code></pre>\n\n<p>And for Employee..</p>\n\n<pre><code>@Entity\n@Table(name = \"employee\", catalog = \"ieeepi_pharmacy\", uniqueConstraints = \n@UniqueConstraint(columnNames = \"code\"))\npublic class Employee implements java.io.Serializable {\n\nprivate int empId;\nprivate String name;\nprivate String address;\nprivate String cnic;\nprivate int hourlyRate;\nprivate boolean isAllowed;\nprivate boolean isActive;\nprivate String code;\nprivate Set&lt;User&gt; users = new HashSet&lt;User&gt;(0);\nprivate Set&lt;Attendance&gt; attendances = new HashSet&lt;Attendance&gt;(0);\n\n@Id\n@GeneratedValue(strategy = IDENTITY)\n@Column(name = \"emp_id\", unique = true, nullable = false)\npublic int getEmpId() {\n    return this.empId;\n}\n\npublic void setEmpId(int empId) {\n    this.empId = empId;\n}\n\n@Column(name = \"name\", nullable = false, length = 45)\npublic String getName() {\n    return this.name;\n}\n\npublic void setName(String name) {\n    this.name = name;\n}\n\n@Column(name = \"address\", length = 45)\npublic String getAddress() {\n    return this.address;\n}\n\npublic void setAddress(String address) {\n    this.address = address;\n}\n\n@Column(name = \"CNIC\", length = 15)\npublic String getCnic() {\n    return this.cnic;\n}\n\npublic void setCnic(String cnic) {\n    this.cnic = cnic;\n}\n\n@Column(name = \"hourly_rate\", nullable = false)\npublic int getHourlyRate() {\n    return this.hourlyRate;\n}\n\npublic void setHourlyRate(int hourlyRate) {\n    this.hourlyRate = hourlyRate;\n}\n\n@Column(name = \"is_allowed\", nullable = false)\npublic boolean isIsAllowed() {\n    return this.isAllowed;\n}\n\npublic void setIsAllowed(boolean isAllowed) {\n    this.isAllowed = isAllowed;\n}\n\n@Column(name = \"is_active\", nullable = false)\npublic boolean isIsActive() {\n    return this.isActive;\n}\n\npublic void setIsActive(boolean isActive) {\n    this.isActive = isActive;\n}\n\n@Column(name = \"code\", unique = true, nullable = false, length = 5)\npublic String getCode() {\n    return this.code;\n}\n\npublic void setCode(String code) {\n    this.code = code;\n}\n\n@OneToMany(fetch = FetchType.LAZY, mappedBy = \"employee\")\npublic Set&lt;User&gt; getUsers() {\n    return this.users;\n}\n\npublic void setUsers(Set&lt;User&gt; users) {\n    this.users = users;\n}\n\n@OneToMany(fetch = FetchType.LAZY, mappedBy = \"employee\")\npublic Set&lt;Attendance&gt; getAttendances() {\n    return this.attendances;\n}\n\npublic void setAttendances(Set&lt;Attendance&gt; attendances) {\n    this.attendances = attendances;\n}\n\n}\n</code></pre>\n\n<p>The Result as you see is one to many... I Have also checked the \"Detect One-to-one associations\" option to no avail... :(</p>\n"},{"tags":["hibernate","jpa","jpa-2.0","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":428,"score":1,"question_id":5829761,"title":"best latest Hibernate book","body":"<p>Which is the latest hibernate book that includes information about hibernate 3 and also the latest JPA specification. </p>\n"},{"tags":["java","hibernate","generics","inheritance"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13015032,"title":"hibernate inheritance in generic classes","body":"<p>i have a generic class which is supper class of some non-generic class and those are just setting  its generic parameter like this:</p>\n\n<pre><code>@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)\nclass A&lt;T&gt;{\n    @Id\n    getId(){..}\n    setID(int id){..}\n    int id\n\n    T t;\n    T getT(){...}\n    setT(T t){...}\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>@Entity\nclass B extends A&lt;Integer&gt;{}\n</code></pre>\n\n<p>but hibernate says that B does not have an identifier what should I do?</p>\n"},{"tags":["hibernate","hql","criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13029375,"title":"HQL returning associated join, how to do this in Criteria?","body":"<p>I'm making dynamic query using HQL, but due to many parameters, I believe Criteria would much more \"readable\". Query looks like this:</p>\n\n<pre><code>String queryString = \"select u from ReportSalesUnit as r join r.recipients as u where r.id = :reportSalesUnitId\";\nif ( firstName != null )\n{\n    queryString += \" and lower(u.firstName) like :firstName\";\n}\nif ( lastName != null )\n{\n    queryString += \" and lower(u.lastName) like :lastName\";\n}\nif ( email != null )\n{\n    queryString += \" and lower(u.email) like :email\";\n}\nif ( phoneNr != null )\n{\n    queryString += \" and u.phoneNr like :phoneNr\";\n}\nQuery query = session.createQuery( queryString );\nif ( firstName != null )\n{\n    query.setParameter( \"firstName\", firstName.toLowerCase() + \"%\" );\n}\nif ( lastName != null )\n{\n    query.setParameter( \"lastName\", lastName.toLowerCase() + \"%\" );\n}\nif ( email != null )\n{\n    query.setParameter( \"email\", email.toLowerCase() + \"%\" );\n}\nif ( phoneNr != null )\n{\n    query.setParameter( \"phoneNr\", phoneNr + \"%\" );\n}\nquery.setParameter( \"reportSalesUnitId\", reportSalesUnitId );\n</code></pre>\n\n<p>To be honest I have no idea how to return associated join with Criteria. I was looking for answer here, but couldn't find one: <a href=\"http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html\" rel=\"nofollow\">http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html</a> , could somebody help me? A little explanation would be great.</p>\n"},{"tags":["hibernate","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13029520,"title":"select query in hibernate","body":"<p>I had made class with java class name as \"Employee\" and db table name as \"EMPLOYEE\". The table had many columns but i had declare only two variables on the employee class. Following is the code of Employee class:</p>\n\n<pre><code>package com.mmi.education;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name=\"EMPLOYEES\")\npublic class Employee {\n    private int id;\n    private String firstname;\n    private String lastname;\n\n    @Id\n    @Column(name=\"EMPLOYEE_ID\")\n    public int getId() {\n        return id;\n    }\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    @Column(name=\"FIRST_NAME\")\n    public String getFirstname() {\n        return firstname;\n    }\n    public void setFirstname(String firstname) {\n        this.firstname = firstname;\n    }\n    @Column(name=\"LAST_NAME\")\n    public String getLastname() {\n        return lastname;\n    }\n    public void setLastname(String lastname) {\n        this.lastname = lastname;\n    }\n\n}\n</code></pre>\n\n<p>On the TestEmployee class, i had written the following code:</p>\n\n<pre><code>package com.mmi.education;\n\nimport java.util.List;\n\nimport org.hibernate.Query;\nimport org.hibernate.Session;\nimport org.hibernate.SessionFactory;\nimport org.hibernate.cfg.AnnotationConfiguration;\n\npublic class TestEmployee {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n        AnnotationConfiguration config= new AnnotationConfiguration();\n        config.configure(\"hibernate.cfg.xml\");\n\n        SessionFactory factory = config.buildSessionFactory();\n\n        Session session = factory.getCurrentSession();\n        //session.beginTransaction();\n        Query query = session.createQuery(\"FROM Employee\");\n\n        List&lt;Employee&gt; employees = query.list();\n\n        for(Employee employee:employees){\n            System.out.println(\"ID=&gt;\"+employee.getId()+\"\\tFirstName=&gt;\"+employee.getFirstname()+\"\\tLastName=&gt;\"+employee.getLastname());\n        }\n    }\n\n}\n</code></pre>\n\n<p>Firstly, i am confusing whether to write \"FROM EMPLOYEES\" or \"FROM Employee\".\nSecondly, is it safe to declare the two variable in the POJO class (Employee) whereas there are many columns in the table.</p>\n\n<p>Lastly, on executing the code I am facing the following exception:</p>\n\n<pre><code>Exception in thread \"main\" org.hibernate.hql.ast.QuerySyntaxException: Employee is not mapped [FROM Employee]\n</code></pre>\n\n<p>My Database is locally installed (Oracle 10g XE)</p>\n"},{"tags":["hibernate","locking"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2626,"score":0,"question_id":5518981,"title":"Hibernate - How to restrict the concurrent read of the record by multiple users?","body":"<p>We are using Hibernate 3.6.0. We have requirement of retrieve next available record from the table. How do we control retrieving same record by multiple concurrent users. \n  We need to read the next available record and update the status on column (kind of lock) to avoid next user retrieving the same record. We added Version column on the table (Optimistic lock), but it seems controlling on update.</p>\n\n<p>What is the best solution in Hibernate to achieve this?</p>\n\n<p>Thanks in advance.\nVenkat</p>\n"},{"tags":["java","hibernate","spring","amazon-web-services","pessimistic-locking"],"answer_count":4,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":10196,"score":4,"question_id":8645694,"title":"Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect)","body":"<p>i have a java project works as a webserver  </p>\n\n<p>i face this exception always   </p>\n\n<p>i read some documentation, i found that pessimistic locking (or optimistic, but i read that pessimistic is better) is the best way to solve this exception   </p>\n\n<p>but i couldn't found any clear example that explain how to use it  </p>\n\n<p>my methods style is:  </p>\n\n<pre><code>@Transactional\nPublic void test(Email email, String Subject){\n   getEmailById(String id);\n   email.setSubject(Subject);\n   updateEmail(email);\n}\n</code></pre>\n\n<p><b>while:</b>  </p>\n\n<pre><code>email is a hibernate class (it will be a table in the database) \ngetEmailById(String id) is a function that return an email \n                                  (this method not annotated with @Transctional)\nupdateEmail(email): is a method that update the email\n</code></pre>\n\n<p><b>Note:</b> i use hibernate for save, update &amp; so on (example: session.getcurrentSession.save(email))</p>\n\n<p><b>Exception:</b></p>\n\n<pre><code>            ERROR 2011-12-21 15:29:24,910 Could not synchronize database state with session [myScheduler-1]\n            org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [email#21]\n                at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1792)\n                at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2435)\n                at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2335)\n                at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2635)\n                at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:115)\n                at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n                at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\n                at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:168)\n                at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\n                at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n                at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)\n                at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)\n                at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)\n                at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:656)\n                at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)\n                at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)\n                at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393)\n                at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120)\n                at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n                at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n                at $Proxy130.generateEmail(Unknown Source)\n                at com.admtel.appserver.tasks.EmailSender.run(EmailNotificationSender.java:33)\n                at com.admtel.appserver.tasks.EmailSender$$FastClassByCGLIB$$ea0d4fc2.invoke(&lt;generated&gt;)\n                at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)\n                at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:688)\n                at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n                at org.springframework.aop.aspectj.AspectJAfterThrowingAdvice.invoke(AspectJAfterThrowingAdvice.java:55)\n                at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:161)\n                at org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:50)\n                at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:161)\n                at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:50)\n                at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:161)\n                at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:89)\n                at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n                at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:621)\n                at com.admtel.appserver.tasks.EmailNotificationSender$$EnhancerByCGLIB$$33eb7303.run(&lt;generated&gt;)\n                at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n                at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n                at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n                at java.lang.reflect.Method.invoke(Method.java:597)\n                at org.springframework.util.MethodInvoker.invoke(MethodInvoker.java:273)\n                at org.springframework.scheduling.support.MethodInvokingRunnable.run(MethodInvokingRunnable.java:65)\n                at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:51)\n                at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n                at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)\n                at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)\n                at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)\n                at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)\n                at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)\n                at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n                at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n                at java.lang.Thread.run(Thread.java:680)\n            ERROR 2011-12-21 15:29:24,915 [ exception thrown &lt; EmailNotificationSender.run() &gt; exception message Object of class [Email] with identifier [211]: optimistic locking failed; nested exception is org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [Email#21] with params ] [myScheduler-1]\n            org.springframework.orm.hibernate3.HibernateOptimisticLockingFailureException: Object of class [Email] with identifier [21]: optimistic locking failed; nested exception is \n</code></pre>\n"},{"tags":["hibernate","caching","collections","ehcache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13006251,"title":"Hibernate second level collection cache on new entity","body":"<p>Here's my scenario:</p>\n\n<p>I've a process that is spaned across 2 spring transactions (P=Required,I=Default).</p>\n\n<p>On T1 I instantiated an Entity A, which has an empty collection of B's.</p>\n\n<p>Both, A and B entities, and the oneToMany relationship are marked with @Cache annotation.I've tried both CacheConcurrencyStrategy.READ_WRITE and CacheConcurrencyStrategy.NONSTRICT_READ_WRITE.</p>\n\n<p>I'm using ehcache as the cache provider.</p>\n\n<p>On T1, I merged A entity.</p>\n\n<p>On T2, I merge it again. </p>\n\n<p>The problem is, whenever the A entity gets merged on T2, hibernate does a query for B's collection, since he could not find it on the second level cache.</p>\n\n<p>As soon as the collection gets loaded, the cache gets used (if I did the same merge on  a new transaction T3,it gets the collection from the cache).</p>\n\n<p>How to avoid this query to be executed? I.E: How to make hibernate second-level-cache the newly created collection, before loading it?</p>\n\n<p>Also, I thought about using the first level cache, somehow managing to make one hibernate session to be thread-bounded, across T1 and T2(but I'm not sure it will work for the collection either...) Is it an acceptable procedure? how to achieve this?</p>\n\n<p>TKS.</p>\n"},{"tags":["nhibernate","hibernate","record","active"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5369,"score":2,"question_id":722560,"title":"Querying Many-To-Many relationship with Hibernate Criteria API","body":"<p>I've the following many to many relation: <code>File 1 --- * File_Insurer * --- 1 Insurer</code>. I'm trying to query this relation using the Criteria API (Active Record) to get Files that meet ALL specified Insurers (Get all Files where <code>Insurer.Id == 2</code> AND <code>Insurer.Id == 3</code>).</p>\n\n<p><em><strong>Mapping files (parts)</em></strong>:</p>\n\n<h2>File</h2>\n\n<pre><code>[HasAndBelongsToMany(typeof(Insurer),\nTable = \"Insurer_File\", ColumnKey = \"IdFile\", ColumnRef = \"IdInsurer\")]\npublic virtual IList&lt;Insurer&gt; Insurers\n{\nget { return insurers; }\nset { insurers = value; }\n}\n</code></pre>\n\n<h2>Insurer</h2>\n\n<pre><code>[HasAndBelongsToMany(typeof(File),\nTable = \"Insurer_File\", ColumnKey = \"IdInsurer\", ColumnRef = \"IdFile\")]\npublic virtual IList&lt;File&gt; Files\n{\nget { return files; }\nset { files = value; }\n}\n</code></pre>\n\n<p><strong>I've tried many options</strong>:</p>\n\n<pre><code>DetachedCriteria dc = DetachedCriteria.For&lt;File&gt;();\ndc.SetResultTransformer(new DistinctRootEntityResultTransformer());\ndc.CreateCriteria(\"Insurers\").Add(Expression.Eq(\"Id\", long.Parse(\"2\")));\ndc.CreateCriteria(\"Insurers\").Add(Expression.Eq(\"Id\", long.Parse(\"3\")));\nList&lt;File&gt; searchResults = File.FindAll(dc).ToList&lt;File&gt;();\n</code></pre>\n\n<p>That gives me an error: <code>duplicate association path: Insurers</code>.</p>\n\n<p><strong>Next option</strong>:</p>\n\n<pre><code>DetachedCriteria dc = DetachedCriteria.For&lt;File&gt;();\ndc.SetResultTransformer(new DistinctRootEntityResultTransformer());\ndc.CreateCriteria(\"Insurers\").Add(Expression.And(Expression.Eq(\"Id\", long.Parse(\"3\")), Expression.Eq(\"Id\", long.Parse(\"2\"))));\nList&lt;File&gt; searchResults = File.FindAll(dc).ToList&lt;File&gt;();\n</code></pre>\n\n<p>The result list is empty (but shouldn't be).</p>\n\n<p><strong>Next option with alias</strong>:</p>\n\n<pre><code>DetachedCriteria dc = DetachedCriteria.For&lt;File&gt;();\ndc.SetResultTransformer(new DistinctRootEntityResultTransformer());\ndc.CreateAlias(\"Insurers\", \"i\").Add(Expression.Eq(\"i.Id\", long.Parse(\"2\"))).Add(Expression.Eq(\"i.Id\", long.Parse(\"3\")));\nList&lt;File&gt; searchResults = File.FindAll(dc).ToList&lt;File&gt;();\n</code></pre>\n\n<p>The result list is empty again - strange.</p>\n\n<p><strong>Next try</strong>:</p>\n\n<pre><code>DetachedCriteria dc = DetachedCriteria.For&lt;File&gt;();\ndc.SetResultTransformer(new DistinctRootEntityResultTransformer());\nList&lt;long&gt; insurerIds = new List&lt;long&gt;();\ninsurerIds.Add(2);\ninsurerIds.Add(3);\ndc.CreateCriteria(\"Insurers\").Add(Expression.In(\"Id\", insurerIds));\nList&lt;File&gt; searchResults = File.FindAll(dc).ToList&lt;File&gt;();\n</code></pre>\n\n<p>This works somehow, but the result set contains a all possible options (OR) - it's not an exact match.</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13026969,"title":"How to override hibernate collection join column?","body":"<p>This is my abstract father:</p>\n\n<pre><code>@MappedSuperclass   \npublic abstract class AbstractEntity implements Serializable {\n\n    @OneToMany(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"entity_no\", referencedColumnName = \"MY_COLUMN\")\n    private Set&lt;CLASS_TYPE&gt; list; \n}\n</code></pre>\n\n<p>All my entities has this set, but each entity has different <code>referencedColumnName</code>.</p>\n\n<p>Is there a way to override only the <code>@JoinColumn</code> annotation?</p>\n"},{"tags":["hibernate","many-to-one","discriminator"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12995504,"title":"Hibernate 4: Partial many-to-one association + where/filter discriminator","body":"<p>I'm using Hibernate 4. I have this database with Category and CategoryItem tables:</p>\n\n<pre><code>CREATE  TABLE `test`.`Category` (\n  `Id` INT NOT NULL AUTO_INCREMENT ,\n  `Description` VARCHAR(50) NOT NULL ,\n  PRIMARY KEY (`Id`) )\n\nCREATE  TABLE `test`.`CategoryItem` (\n  `IdCategory` INT NOT NULL ,\n  `Id` VARCHAR(10) NOT NULL ,\n  `Description` VARCHAR(100) NOT NULL ,\n  PRIMARY KEY (`Id`, `IdCategory`) ,\n  CONSTRAINT `fk_table1_Category1`\n    FOREIGN KEY (`IdCategory` )\n    REFERENCES `test`.`Category` (`Id` ))\n</code></pre>\n\n<p>This are used to store different categories or catalogs and its values. For example:</p>\n\n<p>Category table:</p>\n\n<pre><code>1, 'Genders'\n2, 'Marital status'\n3, 'Countries'\n</code></pre>\n\n<p>CategoryItem table:</p>\n\n<pre><code>1, 'FEM', 'Female'\n1, 'MAL', 'Male'\n2, 'SIN', 'Single'\n2, 'MAR', 'Married'\n3, 'US', 'United States'\n3, 'UK', 'England'\n</code></pre>\n\n<p>These values are used all over the schema, but with logical reference to CategoryItem(Id) only, for example:</p>\n\n<pre><code>CREATE  TABLE `test`.`Person` (\n  `Id` INT NOT NULL ,\n  `Name` VARCHAR(30) NULL ,\n  --this fields are referencing CategoryItem(Id)\n  `IdGender` VARCHAR(10) NOT NULL ,\n  `IdMaritalStatus` VARCHAR(10) NOT NULL ,\n  `IdCountryOrigen` VARCHAR(10) NOT NULL ,\n  PRIMARY KEY (`Id`) )\n</code></pre>\n\n<p>Is it possible to map this tables with some technique in Hibernate? I'm not able to change this schema right now.</p>\n\n<p><strong>EDITED:</strong></p>\n\n<p>These are the classes and mappings so far:</p>\n\n<pre><code>public class Category implements Serializable {\n\n    private int id;\n    private String description;\n\n    private Set&lt;CategoryItem&gt; items = new HashSet&lt;CategoryItem&gt;();\n\n    public Category() {\n    }\n\n    //getters and setters omitted\n}\n\npublic class CategoryItem implements Serializable {\n\n    private CategoryItemId id;\n    private Category category;\n    private String description;\n\n    public CategoryItem() {\n    }\n    //getters and setters omitted\n}\n\npublic class CategoryItemId implements Serializable {\n\n    private Category category;\n    private String id;\n\n    public CategoryItemId() {\n    }\n    //getters and setters omitted\n}\n\npublic class Person implements Serializable {\n\n    private int id;\n    private String name;\n    private CategoryItem gender;\n    private CategoryItem maritalStatus;\n    private CategoryItem countryOrigen;\n\n    public PersonaNatural() {\n    }\n    //getters and setters omitted\n}\n\n  &lt;class catalog=\"test\" name=\"test.Category\" table=\"Category\"&gt;\n    &lt;id name=\"id\" type=\"int\"&gt;\n      &lt;column name=\"Id\"/&gt;\n      &lt;generator class=\"increment\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"description\" type=\"string\"&gt;\n      &lt;column length=\"50\" name=\"Description\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;set inverse=\"true\" name=\"items\"&gt;\n      &lt;key&gt;\n        &lt;column name=\"IdCategory\" not-null=\"true\"/&gt;\n      &lt;/key&gt;\n      &lt;one-to-many class=\"test.CategoryItem\"/&gt;\n    &lt;/set&gt;    \n  &lt;/class&gt;\n\n  &lt;class catalog=\"test\" name=\"test.CategoryItem\" table=\"CategoryItem\"&gt;\n    &lt;composite-id class=\"test.CategoryItemId\" name=\"id\"&gt;\n        &lt;key-many-to-one name=\"category\" class=\"test.Category\"&gt;\n            &lt;column name=\"IdCategory\" not-null=\"true\"/&gt;\n        &lt;/key-many-to-one&gt;\n      &lt;key-property name=\"id\" type=\"string\"&gt;\n        &lt;column name=\"Id\"/&gt;\n      &lt;/key-property&gt;\n    &lt;/composite-id&gt;\n    &lt;many-to-one name=\"category\" class=\"test.Category\" fetch=\"select\" insert=\"false\" update=\"false\"&gt;\n      &lt;column name=\"IdCategory\" not-null=\"true\"/&gt;\n    &lt;/many-to-one&gt;\n    &lt;property name=\"description\" type=\"string\"&gt;\n      &lt;column name=\"Description\" length=\"100\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n  &lt;/class&gt;\n\n&lt;class catalog=\"test\" name=\"test.Person\" table=\"Person\"&gt;\n    &lt;id name=\"id\" type=\"int\"&gt;\n      &lt;column name=\"Id\"/&gt;\n      &lt;generator class=\"increment\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"name\" type=\"string\"&gt;\n      &lt;column length=\"30\" name=\"Name\" not-null=\"false\"/&gt;\n    &lt;/property&gt;\n    &lt;many-to-one name=\"gender\" class=\"test.CategoryItem\" fetch=\"select\"&gt;\n        &lt;column name=\"IdGender\" not-null=\"true\"/&gt;\n    &lt;/many-to-one&gt;\n    &lt;many-to-one name=\"maritalStatus\" class=\"test.CategoryItem\" fetch=\"select\"&gt;\n        &lt;column name=\"IdMaritalStatus\" not-null=\"true\"/&gt;\n    &lt;/many-to-one&gt;\n    &lt;many-to-one name=\"countryOrigen\" class=\"test.CategoryItem\" fetch=\"select\"&gt;\n        &lt;column name=\"IdCountryOrigen\" not-null=\"true\"/&gt;\n    &lt;/many-to-one&gt;\n  &lt;/class&gt;\n</code></pre>\n\n<p>I'm trying with many-to-one but I'm getting this error: <strong>'must have same number of columns as the referenced primary key'</strong>. This makes sense because I'm pretending to map just CategoryId(Id) on Person.hbm.xml.</p>\n\n<p>I'm gonna need to specific a <em>where</em> or <em>discriminator</em> value to complete the left join condition, because CategoryItem(Id) alone is not unique.</p>\n\n<p>Maybe this is not even possible with Hibernate, but any help I will appreciate.\nThanks.</p>\n"},{"tags":["query","hibernate","caching","second-level-cache","hazelcast"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13027369,"title":"clear specific query in the QueryRegion","body":"<p>How can I clear a specific query in some query region that I created, and not all of the query region.</p>\n\n<p>I'm using Hibernate and Hazelcast as second level cache.  </p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13024018,"title":"Hibernate session per request vs Hibernate session per application?","body":"<p>I want to know that which is better for the web application using:- \nSpring3.1\nHibernate4</p>\n\n<p><strong>Hibernate session per request</strong> OR <strong>Hibernate session per application</strong>?</p>\n\n<p>Please suggest</p>\n\n<p>Thanks In Advance</p>\n"},{"tags":["java","hibernate","hibernate3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":264,"score":0,"question_id":5454953,"title":"Hibernate get Collection from another session","body":"<p>Hi i've been getting the infamous \"no session or session was closed\" i know that is because i am trying to invke a collection of a hibernate persisted object in another session, so is there a way to actually do this without having to create the filter and add the JOIN fetch mode into it....</p>\n\n<p>GRAVE: failed to lazily initialize a collection of role: ni.edu.uni.id.data.object.Curso.modulos, no session or session was closed\norg.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: ni.edu.uni.id.data.object.Curso.modulos, no session or session was closed</p>\n"},{"tags":["eclipse","hibernate","xml-parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13024809,"title":"Formatting XML files in eclipse","body":"<p>When i try to format a xml file in eclipse it puts each of the fields on a new line. instead i want each property to be on one line. for e.g. now when i press CTRL+SHFT+F, eclipse formats it like this.</p>\n\n<pre><code>&lt;hibernate-mapping package=\"com.server.entities\"&gt;\n&lt;class\n    name=\"Branch\"\n    table=\"Branch\"\n&gt;\n    &lt;meta attribute=\"sync-DAO\"&gt;false&lt;/meta&gt;\n    &lt;id name=\"Id\"\n        type=\"java.lang.Long\"\n        column=\"id\"\n    &gt;\n        &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n\n    &lt;property\n        name=\"Created\"\n        column=\"created\"\n        type=\"timestamp\"\n        not-null=\"false\"\n        length=\"23\"\n    /&gt;\n    &lt;property\n        name=\"LastUpdated\"\n        column=\"lastUpdated\"\n        type=\"timestamp\"\n        not-null=\"false\"\n        length=\"23\"\n    /&gt;\n    &lt;property\n        name=\"CreatedBy\"\n        column=\"createdBy\"\n        type=\"java.lang.Long\"\n        not-null=\"false\"\n        length=\"19\"\n    /&gt;\n</code></pre>\n\n<p>but what i want is</p>\n\n<pre><code>&lt;hibernate-mapping package=\"com.kaizen.report.server.entities\"&gt;\n&lt;class name=\"Branch\" table=\"Branch\"&gt;\n    &lt;meta attribute=\"sync-DAO\"&gt;false&lt;/meta&gt;\n    &lt;id name=\"Id\" type=\"java.lang.Long\" column=\"id\"&gt;\n        &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n\n&lt;property name=\"Created\" column=\"created\" type=\"timestamp\" not-null=\"false\" length=\"23\"/&gt;\n</code></pre>\n"},{"tags":["java","hibernate","transactions"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13014823,"title":"Is the following Hibernate custom ID generator code correct?","body":"<p>I just created a custom hibernate ID generator, and since I'm not an hibernate expert I would like to get some feedback on my code. The generated ID is <code>select max(id) from table</code>, +1.</p>\n\n<pre><code>public class MaxIdGenerator implements IdentifierGenerator, Configurable {\n\n    private Type identifierType;\n    private String tableName;\n    private String columnName;\n\n    @Override\n    public void configure(Type type, Properties params, Dialect dialect) {\n        identifierType = type;\n        tableName = (String) params.getProperty(\"target_table\");\n        columnName = (String) params.getProperty(\"target_column\");\n    }\n\n    @Override\n    public synchronized Serializable generate(SessionImplementor session,\n            Object object) {\n        return generateHolder(session).makeValue();\n    }\n\n    protected IntegralDataTypeHolder generateHolder(SessionImplementor session) {\n        Connection connection = session.connection();\n        try {\n            IntegralDataTypeHolder value = IdentifierGeneratorHelper\n                .getIntegralDataTypeHolder(identifierType\n                        .getReturnedClass());\n            String sql = \"select max(\" + columnName + \") from \" + tableName;\n            PreparedStatement qps = connection.prepareStatement(sql);\n            try {\n                ResultSet rs = qps.executeQuery();\n                if (rs.next())\n                    value.initialize(rs, 1);\n                else\n                    value.initialize(1);\n                rs.close();\n            } finally {\n                qps.close();\n            }\n            return value.copy().increment();\n        } catch (SQLException e) {\n            throw new IdentifierGenerationException(\n                    \"Can't select max id value\", e);\n        }\n    }\n    }\n</code></pre>\n\n<p>I'd like to know:</p>\n\n<ol>\n<li>How can I make this <strong>multi-transaction-safe</strong>? (ie if two concurrent transactions insert data, how can I safely assume that I will not end-up having twice the same ID?) -- I guess the only solution here would be to prevent two concurrent hibernate transaction to run at the same time if they use the same generator, is this possible?</li>\n<li>If the code <strong>could be improved</strong>: I feel wrong having to use hard-coded <code>\"select\"</code>, <code>\"target_column\"</code>, etc...</li>\n</ol>\n\n<p>To guarantee point 1), I can fallback if necessary on synchronizing inserts on my java client code.</p>\n\n<p><em>Please do not comment on the reasons why I'm using this kind of generator: legacy code still insert data onto the same database and uses this mechanism... and can't be modified. And yes, I know, it sucks.</em></p>\n"},{"tags":["spring","hibernate","jpa","transactions"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":370,"score":0,"question_id":9721004,"title":"@Transactional Annotation + for a data insertion in a loop","body":"<p>I am using <strong>Spring 3, JPA + Hibernate</strong> for a <code>CMS</code> application. In that application I have a service class method which is annotated with <code>@Transactional</code> Annotation with <code>rollBack</code> property. Inside that method I am inserting data (ie entity classes) to a table using a loop. For each <code>iteration</code> of the loop entity classes has to be saved to the database. But it is not happening. The commit only happens when the execution of the loop has completed and exits from the method. Then it commits and saves all at once. But I need to read data once it gets inserted into the database before committing in this case. I tried with the <code>ISOLATION LEVEL</code> to read uncommitted but it didn't supported since I am using the default <code>JPADialect</code>. Also tried to add the <strong>hibernate</strong> implementation of <code>jpaDialect</code> but still it didn't worked. Please help with a workaround for this problem. One more thing, is there any way using propagation required method.</p>\n"},{"tags":["java","spring","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13014910,"title":"SimpleJpaRepository does not modify persisted entity","body":"<p>When I'm persisting an entity with <code>SimpleJpaRepository#save()</code> it will not modify it. E.g. it will not set the new id of the entity.</p>\n\n<p>Apart from that, everything works fine. The entity is being persisted and given an id. If I read it from the database I can see the id. Is this normal behavior? I know the #save method returns the persisted entity but I would prefer it to modify the given entity. Is there a way of configuring this?</p>\n\n<p>Thanks</p>\n\n<p>-- edit</p>\n\n<p>Let's assume this is what I do:</p>\n\n<pre><code>User user = new User();\n// do something with user\n\nuserRepository.save(user);\n</code></pre>\n\n<p>Then <code>user</code> stays the same. The object <em>is</em> written to the database but user does not become managed. Also <code>saveAndFlush(user)</code> will not result in different behavior. What I can do is <code>user = userRepository.save(user)</code>. In this case user becomes the managed instance. But from Hibernate I'm used to just save the object and my submitted object becomes managed. Is there a way of archieving this with JPA?</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13013313,"title":"hibernate: change a bean field and then issue a query, query sees changed field","body":"<p>I am confused about the behavior of hibernate bean setters within a Session.  I thought that when you set a bean field in a session, hibernate just knows that the bean is dirty, and on session close, this is a pending update, which will be flushed to the database.</p>\n\n<p>However, I ran a test within one hibernate session where I fetched a bean by its id, changed a field from true to false, and then did an HQL query for a list of all such beans where this field was false.  The \"dirty\" bean showed up in the result set as if hibernate had already made a database UPDATE when I called the setter.  Then I did a session.clear() before leaving the session, to cancel pending updates and evict all beans.  I assumed that this would effectively throw away the dirty changes of the setter calls.  Yet I checked the database and the change from true to false was recorded.  NOTE: never called session.flush() inside this session.</p>\n\n<p>It seems that Hibernate must be issuing a database UPDATE call as soon as I call a bean setter.  But this doesn't seem right?</p>\n\n<p>Andy</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13006908,"title":"session.isOpen() vs session.isConnected()","body":"<p>I am working on sample of Hibernate4 with Spring 3.1.</p>\n\n<p>In my sample , While i print <code>sessionFactory.getCurrentSession().isOpen()</code> on console it prints </p>\n\n<blockquote>\n  <p>true</p>\n</blockquote>\n\n<p>But I am facing an exception on </p>\n\n<pre><code>sessionFactory.getCurrentSession().isConnected()\n</code></pre>\n\n<p>Exception is:</p>\n\n<pre><code>org.hibernate.HibernateException: isConnected is not valid without active transaction\n</code></pre>\n\n<p><strong>EDIT :</strong> I googled more and found following solution</p>\n\n<p><code>sessionFactory.getCurrentSession().beginTransaction();\nsessionFactory.getCurrentSession().isConnected()</code> </p>\n\n<p>But i don't want to write begin transaction maually every time i opearte with session methods like <code>isConnected</code>, <code>get</code>,<code>find</code> , <code>save</code> etc. </p>\n\n<ol>\n<li>What are the other possible solutions for above exception?</li>\n<li>What if i place <code>@Transactional</code> on my dao class methods?</li>\n</ol>\n\n<p>Regards,</p>\n\n<p>Arun Kumar</p>\n"},{"tags":["java","python","hibernate","struts2","jython-2.5"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":65,"score":-4,"question_id":13024113,"title":"calling a python method from our java code","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8898765/calling-python-in-java\">Calling Python in Java?</a>  </p>\n</blockquote>\n\n\n\n<p>I have no idea about python. I am working on a project where I have a set of already developed python files for some specific purpose such as (Account Creation,Transaction_settlement etc.) , \n    But now I have to build a web application using struts2 and hibernate to do the same complex operation. <strong>So Is it possible to use the Existing Python Scripting in my web Application.</strong> as well as am I able to manage the return value from Python method\n     Any help ,any examples would be appropriated.</p>\n"},{"tags":["hibernate","tomcat","path","relative","h2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":575,"score":2,"question_id":3905953,"title":"How can I provide a relative path for H2 database file, using hibernate under Tomcat?","body":"<p>I have a setup which must be fairly common: I have an H2 db, with a db file. I'm using the db in standalone mode. Hibernate provides access to db and I've deployed my code into Tomcat.</p>\n\n<p>The problem is: I could not find a nice way of simply putting the db file into the <code>war</code> and providing a relative path in hibernate config file. </p>\n\n<p>At the moment, I have to use a path to c://whatever_db_file_container_dir/dbname in hibernate config. </p>\n\n<p>This stops me from deploying a zero config web app. Is there a way of turning this setup into a self containing zero configuration package?</p>\n"},{"tags":["java","hibernate","singleton","persistence"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12937775,"title":"Hibernate/persistence and singleton pattern","body":"<p>I have a singleton that is to be persisted in database. Other persisted entities should have reference to this singleton. How can it be achieved with Hibernate?</p>\n\n<p>I ended with something not-yet-working like this, faking the single ID of the singleton:</p>\n\n<pre><code>@Entity\n@Subselect(\"select '1' as ID\")\nclass Singleton {\n    @Id\n    @Column(name=\"ID\")\n    private Long getId() { return 1l; }\n    private void setId(Long id) { }\n}\n\n@Entity\n@Table(name=\"ENT\")\nclass MyEnt {\n    // TODO: how to annotate so that table ENT doesn't need foreign key column \n   Singleton s;\n}\n</code></pre>\n\n<p>The problem is that I don't want to have a column with foreign key in entities referencing the Singleton - because the singleton is only one and we don't need its ID...</p>\n\n<p>Maybe I am thinking in a wrong way? Maybe it is wrong architecture issue? Did you solve similar issue?</p>\n"},{"tags":["database","performance","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12898638,"title":"Database commit performance","body":"<p>I develop an App and recently I've caught me on the thought. What of the following has better performance?</p>\n\n<ol>\n<li>Perform single commit of 1000 entities.</li>\n<li>Perform 20 commits with 50 entities at each commit.</li>\n</ol>\n\n<p>And how do you think will it be implementation dependable?</p>\n"},{"tags":["hibernate","transactions","implicit","identity-insert"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":79,"score":6,"question_id":12921560,"title":"Hibernate 3.5 vs 4 IDENTITY_INSERT issues","body":"<p>We run a Spring 3.1/Hibernate 4/Java 7/Tomcat 7/MSSQL 2008 R2 web application. We must deal with legacy data and archived data. When extracting data from an archive, we have a need to use the original unique identifier so that other (non-archived) records will re-hydrate correctly. These identifiers are stored in the primary key/auto increment field.</p>\n\n<p>Prior to now, when we were using Spring 3.0/Hibernate 3.5, the following code worked to INSERT an extracted record back into its appropriate table (we already have the variables <code>session</code>, <code>entity</code>, and <code>fullTableName</code> in scope):</p>\n\n<pre><code>session.doWork( new Work() \n{ \n    @Override\n    public void execute(Connection connection) throws SQLException\n    {\n        PreparedStatement statement = null;\n        try\n        {\n            statement = connection.prepareStatement(String.format(\"SET IDENTITY_INSERT %s ON\", fullTableName));\n            statement.execute();\n\n            session.save(entity);\n\n            statement = connection.prepareStatement(String.format(\"SET IDENTITY_INSERT %s OFF\", fullTableName));\n            statement.execute();\n        }\n        finally\n        {  /* close the statement */ }\n    }\n});\n</code></pre>\n\n<p>Like I mentioned, this all worked fine in Hibernate 3.5, but now that we've upgraded to Hibernate 4, it has stopped working. Is there something up with the difference between Work and IsolatedWork?</p>\n\n<p>In an effort to solve the problem, and avoid any Work interface issues, we tried the following:</p>\n\n<pre><code>session.createSQLQuery(String.format(\"SET IDENTITY_INSERT %s ON\", fullTableName)).executeUpdate();\nsession.save(entity);\nsession.createSQLQuery(String.format(\"SET IDENTITY_INSERT %s OFF\", fullTableName)).executeUpdate();\n</code></pre>\n\n<p>However, this did not work either. Specifically, the exception that gets thrown is <code>java.sql.SQLException: Cannot insert explicit value for identity column in table 'Employee' when IDENTITY_INSERT is set to OFF.</code> Yet, it should be clear that we're going through pains to set it ON.</p>\n\n<p>We did a SQL Server Profiler trace of the situation, and found something interesting. Something is setting IMPLICIT_TRANSACTIONS ON in each of our transaction bodies. Here's some sample output from the Profiler trace (I've replaced our actual schema with <code>&lt;schema&gt;</code>, and some large bits of data with shorter labels):</p>\n\n<pre><code>SET IMPLICIT_TRANSACTIONS ON\ngo\ndeclare @p1 int\nset @p1=55\nexec sp_prepare @p1 output,N'',N'SET IDENTITY_INSERT &lt;schema&gt;.Employee ON',1\nselect @p1\ngo\nexec sp_execute 55\ngo\n\ndeclare @p1 int\nset @p1=56\nexec sp_prepare @p1 output,N'&lt;parameters for the INSERT&gt;',N'insert into &lt;schema&gt;.Employee (&lt;all the column names&gt;) values ( &lt;all the parameters&gt; )',1\nselect @p1\ngo\nexec sp_execute 56,&lt;the actual values to insert&gt;\ngo\nIF @@TRANCOUNT &gt; 0 ROLLBACK TRAN\ngo\nIF @@TRANCOUNT &gt; 0 COMMIT TRAN\nSET IMPLICIT_TRANSACTIONS OFF\ngo\nexec sp_execute 54,N'Error writing EMPLOYEE archive record. ',&lt;an id&gt;,N'1'\ngo\n</code></pre>\n\n<p>Now, we are specifically setting IMPLICIT_TRANSACTIONS to be OFF, via Connection.setAutoCommit(false) in our transaction (transactions are being managed via Spring @Transactional and Hibernate Transaction Manager). Obviously, that is not working, but what are the alternatives apart from using setAutoCommit, and why would it work in Spring3.0/Hibernate 3.5 but not Spring 3.1/Hibernate 4?</p>\n\n<p>Thanks for any thoughts or suggestions - we're stumped.</p>\n"},{"tags":["java","hibernate","caching","memcached"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":79,"score":5,"question_id":13016916,"title":"Needs clarity on hibernate second level cache","body":"<p>I need some clarification with the hibernate second level cache. </p>\n\n<ol>\n<li><p>How does the hibernate second level cache works? </p></li>\n<li><p>Does it loads all the data from the tables for which there is @Cacheable annotation (with respect to hibernate annotation) in the entity classes on server start up in the J2EE environment?</p></li>\n<li><p>Will the cache gets sync up when there is an update on those tables and how?</p></li>\n<li><p>Last one is there any ways for my DAO code to get notified when there is an updated on some table which i am interested upon? (Looking for any listener which can intimate abt the updates of the tables).</p></li>\n</ol>\n\n<p>Ill appreciated for your time</p>\n\n<p>Thanks</p>\n"},{"tags":["java","mysql","hibernate","wavemaker"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":13017517,"title":"Setting a local variable in MySQL no longer works","body":"<p>I use a user variable in MySQL to control the operation of triggers in my database. These variables are set in a service with the following Java code:</p>\n\n<pre><code>    MedicalDB service = (MedicalDB)RuntimeAccess.getInstance().getServiceBean(\"medicalDB\"); // medicaldb is the name of the connection to DB\n    try {\n        service.begin();\n        Session session = service.getDataServiceManager().getSession();\n\n        sql = \"SET @disableTriggers = 0;\";\n        session.createQuery(sql).executeUpdate(); &lt;---- Throws null pointer exception\n</code></pre>\n\n<p>This code has worked properly for a long time but now when the service executes the executeUpdate() method it throws a null pointer exception. The issue is with the SET statement since, if I comment it out, subsequent sql statements function properly. </p>\n\n<p>Has something changed with the JRE (build 1.7.0-03-b05) or Hibernate. I am using Wavemaker 6.4.6GA</p>\n"},{"tags":["java","mysql","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":6067,"score":2,"question_id":8230309,"title":"JPA mapping: \"QuerySyntaxException: foobar is not mapped...\"","body":"<p>I've been playing around with a very simple JPA example and am trying to tweak it to an existing database.  But I can't get past this error.  (Below.)  It just has to be some simple thing I am not seeing.</p>\n\n<pre><code>org.hibernate.hql.internal.ast.QuerySyntaxException: FooBar is not mapped [SELECT r FROM FooBar r]\n  org.hibernate.hql.internal.ast.util.SessionFactoryHelper.requireClassPersister(SessionFactoryHelper.java:180)\n  org.hibernate.hql.internal.ast.tree.FromElementFactory.addFromElement(FromElementFactory.java:110)\n  org.hibernate.hql.internal.ast.tree.FromClause.addFromElement(FromClause.java:93)\n</code></pre>\n\n<p>In the DocumentManager class below (a simple servlet, as that is my target goal) does two things:</p>\n\n<ol>\n<li>insert a row</li>\n<li>return all rows</li>\n</ol>\n\n<p>The insertion works perfectly--all is good there.  The problem is with the retrieval.  I've tried all sorts of values for the <code>Query q = entityManager.createQuery</code> parameters, but no luck, and I've tried variously more explicate annotations of the class (like column types), all without success.</p>\n\n<p>Please save me from myself.  I'm certain it is something small.  My inexperience with JPA is preventing me from going any farther.</p>\n\n<p><strong>My ./src/ch/geekomatic/jpa/FooBar.java file:</strong></p>\n\n<pre><code>@Entity\n@Table( name = \"foobar\" )\npublic class FooBar {\n    @Id \n    @GeneratedValue(strategy=GenerationType.IDENTITY) \n    @Column(name=\"id\")\n    private int id;\n\n    @Column(name=\"rcpt_who\")\n    private String rcpt_who;\n\n    @Column(name=\"rcpt_what\")\n    private String rcpt_what;\n\n    @Column(name=\"rcpt_where\")\n    private String rcpt_where;\n\n    public int getId() {\n        return id;\n    }\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getRcpt_who() {\n        return rcpt_who;\n    }\n    public void setRcpt_who(String rcpt_who) {\n        this.rcpt_who = rcpt_who;\n    }\n\n    //snip...the other getters/setters are here\n}\n</code></pre>\n\n<p><strong>My ./src/ch/geekomatic/jpa/DocumentManager.java class</strong></p>\n\n<pre><code>public class DocumentManager extends HttpServlet {\n    private EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory( \"ch.geekomatic.jpa\" );\n\n    protected void tearDown() throws Exception {\n        entityManagerFactory.close();\n    }\n\n   @Override\n   public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n       FooBar document = new FooBar();\n       document.setRcpt_what(\"my what\");\n       document.setRcpt_who(\"my who\");\n\n       persist(document);\n\n       retrieveAll(response);\n   }\n\n   public void persist(FooBar document) {\n       EntityManager entityManager = entityManagerFactory.createEntityManager();\n       entityManager.getTransaction().begin();\n       entityManager.persist( document );\n       entityManager.getTransaction().commit();\n       entityManager.close();\n   }\n\n    public void retrieveAll(HttpServletResponse response) throws IOException {\n        EntityManager entityManager = entityManagerFactory.createEntityManager();\n        entityManager.getTransaction().begin();\n\n        //  *** PROBLEM LINE ***\n        Query q = entityManager.createQuery( \"SELECT r FROM foobar r\", FooBar.class );\n        List&lt;FooBar&gt; result = q.getResultList();\n\n        for ( FooBar doc : result ) {\n            response.getOutputStream().write(event.toString().getBytes());\n            System.out.println( \"Document \" + doc.getId()  );\n        }\n        entityManager.getTransaction().commit();\n        entityManager.close();\n    }\n}\n</code></pre>\n\n<p><strong>The {tomcat-home}/webapps/ROOT/WEB-INF/classes/METE-INF/persistance.xml file</strong></p>\n\n<pre><code>&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"\n    version=\"2.0\"&gt;\n\n&lt;persistence-unit name=\"ch.geekomatic.jpa\"&gt;\n    &lt;description&gt;test stuff for dc&lt;/description&gt;\n\n    &lt;class&gt;ch.geekomatic.jpa.FooBar&lt;/class&gt;\n\n    &lt;properties&gt;\n        &lt;property name=\"javax.persistence.jdbc.driver\"   value=\"com.mysql.jdbc.Driver\" /&gt;\n        &lt;property name=\"javax.persistence.jdbc.url\"      value=\"jdbc:mysql://svr:3306/test\" /&gt;\n        &lt;property name=\"javax.persistence.jdbc.user\"     value=\"wafflesAreYummie\" /&gt;\n        &lt;property name=\"javax.persistence.jdbc.password\" value=\"poniesRock\" /&gt;\n\n        &lt;property name=\"hibernate.show_sql\"     value=\"true\" /&gt;\n        &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"create\" /&gt;\n    &lt;/properties&gt;\n\n&lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p><strong>The MySQL table description:</strong></p>\n\n<pre><code>mysql&gt; describe foobar;\n+------------+--------------+------+-----+---------+----------------+\n| Field      | Type         | Null | Key | Default | Extra          |\n+------------+--------------+------+-----+---------+----------------+\n| id         | int(11)      | NO   | PRI | NULL    | auto_increment |\n| rcpt_what  | varchar(255) | YES  |     | NULL    |                |\n| rcpt_where | varchar(255) | YES  |     | NULL    |                |\n| rcpt_who   | varchar(255) | YES  |     | NULL    |                |\n+------------+--------------+------+-----+---------+----------------+\n4 rows in set (0.00 sec)\n</code></pre>\n"},{"tags":["java","spring","hibernate","model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13015803,"title":"Spring, Hibernate and multiple schemas in one codebase","body":"<p>What is the accepted practice to use multiple database 'models' in a Spring / Hibernate combo ? </p>\n\n<p>Would appreciate some help on an issue that has me scratching my head, as I am no expert in Spring/Hibernate !</p>\n\n<p>We are developing a web project that up until now has been built to the specification of its first customer. All the database tables are mapped to POJOs and we use Hibernate Annotations. Very simply, the project is a CRUD application that allows end users to update database information via a front end.</p>\n\n<p>We now need to support a new customer, but this customer has a slightly different specification; we will have changes to a number of tables' columns and datatypes.</p>\n\n<p>We don't want to combine into one table, as this bloats up the database with lots of NULL columns (there will be 10+ unique columns per customer in some table). </p>\n\n<p>The front end we can handle easily enough, as we just convert to and from JSON and the front end has been implemented per-customer from the ground up. But the backend is a bit more complicated.</p>\n\n<p>We have tried a prototype where we override two tables at runtime; we converted two corresponding model classes to interfaces and implemented a concrete class per customer, loaded via the Spring configuration, e.g for a \"products\" table, we tried:</p>\n\n<pre><code>package com.mycompany.generic.model;\npublic interface Product \n</code></pre>\n\n<p>and then</p>\n\n<pre><code>package com.mycompany.customera.model;\n@Table(name=\"products\")\npublic class CustomerAProduct implements Properties {\n  String colour;\n  int weight;\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>package com.mycompany.customerb.model;\n@Table(name=\"products\")\npublic class CustomerBProduct implements Properties {\n  String colour;\n  int volume;\n  Double price;\n}\n</code></pre>\n\n<p>..where Spring loads, as a runtime option, <em>com.mycompany.customera</em> or <em>customerb</em> depending on configuration, along with any customer-specific validations/service classes to act on the new POJO's. You see that the underlying columns can be different.</p>\n\n<p>However, I am hesitate to pitch into implementing this, because..</p>\n\n<ul>\n<li>Almost every model class will need converting and implementing per-customer, not just the ones that are different. This is because we have many joins (OneToMany etc) within the model classes, Hibernate does not let you join to an interface (eg <a href=\"https://hibernate.onjira.com/browse/HHH-4338\" rel=\"nofollow\">HHH-4338</a>)</li>\n<li>some sort of util/factory is required to generate new instances of classes, as where we used to do <em>new Properties</em> we do not know whether to use <em>new CustomerAProperties()</em> or <em>new CustomerBProperties()</em> (for the same reason, we cannot use TargetEntity to solve the above problem, because this requires a .class file which cannot be set in the code)</li>\n</ul>\n\n<p>These seem pretty major downsides so I am trying to research a better way to do it. We can build per-customer, via Maven, but then I am not sure how to implement this in a way that isn't going to break Eclipse while we develop locally..</p>\n\n<p>Or, is there some other method that I am not aware of ? </p>\n\n<p>thanks in advance for any suggestions or pointers on what to research etc.</p>\n"},{"tags":["hibernate","list","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13015409,"title":"hibernate: how to map join table with extra column without JPA annotation","body":"<p>Assume I have the following classes:</p>\n\n<pre><code>class Student{\n  String name;\n  List&lt;StudentClassMark&gt; courseMarks;\n}\n\nclass Class {\n  String title;\n}\n\nclass StudentClassMark {\n   Student student;\n   Class class;\n   MarkType markType;   &lt;-- notice this is the extra column that is causing problems\n}\n\nclass MarkType {\n    String description;\n}\n</code></pre>\n\n<p>how do I map the list using a hibernate mapping file (so no JPA annotation)? Here is what i tried:</p>\n\n<pre><code>&lt;class name=\"Student\" table=\"PERSON\"&gt;\n    &lt;property name=\"name\" column=\"NAME\"/&gt;\n    &lt;bag name=\"courseMarks\" inverse=\"false\" cascade=\"all\" table=\"STUDENT_CLASS_MARK\"&gt;\n        &lt;key column=\"STUDENT\" /&gt;\n        &lt;many-to-many&gt;    &lt;-- this is the section that I don't know how to do\n            &lt;column name=\"CLASS\"/&gt;\n            &lt;column name=\"MARK_TYPE\"/&gt;\n        &lt;/many-to-many&gt;\n    &lt;/bag&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>The examples I found are all using JPA notation which I can't use.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","hibernate","hibernate-search"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":12134410,"title":"Cannot cast org.hibernate.search.hcore.impl.HibernateSearchIntegrator to org.hibernate.integrator.spi.Integrator","body":"<p>I am getting the following error:</p>\n\n<pre><code>Cannot cast org.hibernate.search.hcore.impl.HibernateSearchIntegrator to \norg.hibernate.integrator.spi.Integrator\n</code></pre>\n\n<p>Stack trace:<pre><code>   [WARN] Exception while dispatching incoming RPC call\ncom.google.gwt.user.server.rpc.UnexpectedException: Service method 'XXX threw an unexpected exception: java.util.ServiceConfigurationError: org.hibernate.integrator.spi.Integrator: Provider org.hibernate.search.hcore.impl.HibernateSearchIntegrator could not be instantiated: java.lang.ClassCastException: Cannot cast org.hibernate.search.hcore.impl.HibernateSearchIntegrator to org.hibernate.integrator.spi.Integrator\n    at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:385)\n    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:588)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)\n    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\n    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\n    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729)\n    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\n    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.handler.RequestLogHandler.handle(RequestLogHandler.java:49)\n    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.Server.handle(Server.java:324)\n    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\n    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843)\n    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647)\n    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)\n    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)\n    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\n    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)\nCaused by: java.util.ServiceConfigurationError: org.hibernate.integrator.spi.Integrator: Provider org.hibernate.search.hcore.impl.HibernateSearchIntegrator could not be instantiated: java.lang.ClassCastException: Cannot cast org.hibernate.search.hcore.impl.HibernateSearchIntegrator to org.hibernate.integrator.spi.Integrator\n    at java.util.ServiceLoader.fail(ServiceLoader.java:224)\n    at java.util.ServiceLoader.access$100(ServiceLoader.java:181)\n    at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:370)\n    at java.util.ServiceLoader$1.next(ServiceLoader.java:438)\n    at org.hibernate.service.classloading.internal.ClassLoaderServiceImpl.loadJavaServices(ClassLoaderServiceImpl.java:251)\n    at org.hibernate.integrator.internal.IntegratorServiceImpl.(IntegratorServiceImpl.java:53)\n    at org.hibernate.service.internal.BootstrapServiceRegistryImpl.(BootstrapServiceRegistryImpl.java:80)\n    at org.hibernate.service.internal.BootstrapServiceRegistryImpl.(BootstrapServiceRegistryImpl.java:57)\n    at org.hibernate.service.ServiceRegistryBuilder.(ServiceRegistryBuilder.java:76)\n    at com.orangeraft.hms.server.module.login.service.LoginServiceImpl.login(LoginServiceImpl.java:46)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:616)\n    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)\n    ... 22 more\nCaused by: java.lang.ClassCastException: Cannot cast org.hibernate.search.hcore.impl.HibernateSearchIntegrator to org.hibernate.integrator.spi.Integrator\n    at java.lang.Class.cast(Class.java:3007)\n    at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:362)\n    ... 34 more\n</code></pre></p>\n\n<p>Here is my code:</p>\n\n<pre><code>Configuration configuration = new Configuration();\nconfiguration.configure();\nServiceRegistry serviceRegistry = new ServiceRegistryBuilder()\n        .applySettings(configuration.getProperties())\n        .buildServiceRegistry();\nSessionFactory sf = configuration.buildSessionFactory(serviceRegistry);\nSession hibernateSession = sf.getCurrentSession();\nFullTextSession fullTextSession = Search.getFullTextSession(hibernateSession);\n    fullTextSession.createIndexer().startAndWait();\n\n</code></pre>\n\n<p>I'm just trying to create the index as shown in the hibernate search tutorial <a href=\"http://docs.jboss.org/hibernate/search/3.2/reference/en/html_single/#d0e350\" rel=\"nofollow\">here</a> in a GWT application. Any ideas how to fix this?</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":128,"score":2,"question_id":13013227,"title":"Cannot set boolean to null","body":"<p>I have a class Shop with the following variable</p>\n\n<pre><code>@Column(columnDefinition = \"bit\")\nprivate boolean atShop;\n</code></pre>\n\n<p>Using this value, I am using HSQL to retrieve this information from the application</p>\n\n<pre><code>from Person person\nleft join fetch person.shop\n</code></pre>\n\n<p>when I try call this HSQL statement i get the following error</p>\n\n<pre><code>org.springframework.orm.hibernate3.HibernateSystemException: could not set a field value by reflection setter of com.test.dataobject.Shop.atShop; nested exception is org.hibernate.PropertyAccessException: could not set a field value by reflection setter of com.test.dataobject.Shop.atShop\n</code></pre>\n\n<p>It is throwing this because it is trying to set the boolean to null in the HSQL. I can solve this problem by changing <code>private boolean atShop;</code> to <code>private Boolean atShop;</code> but i want to keep this as a <code>boolean</code> as i am saving it as a bit in my database</p>\n\n<p>Is there a way to solve this without changing <code>boolean</code> to <code>Boolean</code>?</p>\n\n<p><strong>EDIT:</strong> </p>\n\n<p>I know that boolean can only be true/false and Boolean can be set to null, but is there a way to get hibernate/spring to set this value to false(which i thought it should do automatically) instead of trying to set it to null and throwing this exception?</p>\n\n<p>I have also tried adding annotation to automatically set the value to false but this does not work either</p>\n\n<pre><code>@Column(nullable = false, columnDefinition = \"bit default 0\")\nprivate boolean atShop;\n</code></pre>\n"},{"tags":["hibernate","grails","createcriteria"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13014497,"title":"Hibernate createCriteria JOIN, ORDER, DISTINCT from one level","body":"<p>I have 3 classes: first, second, third\nI have createria approximately like this:</p>\n\n<pre><code>First.createCriteria().listDistinct {\n            if(....){fetchMode(\"second\", FetchMode.JOIN)\n            fetchMode(\"second.third\", FetchMode.JOIN)}\n            order(sortOrder, orderBy)\n            order(\"id\", \"desc\")\n}\n</code></pre>\n\n<p>(when \"if\" false, createCriteria works fine)</p>\n\n<p>when \"if\" true Hibernate generated sql request like this</p>\n\n<pre><code>select \n  distinct id,\n  secondfield\nfrom\n  FIRST as firsts\ninner join\n  SECOND\n       ... on ...\ninner join\n  THIRD\n       ... on ...\nwhere(...)\norder by \n     firsts.name asc\n     firsts.id desc\n</code></pre>\n\n<p>But so sql request cannot be executed because (distinct, join, order by) cannot be on the same level togehter.\nI lunch it in SQL developer. This request without one of (distinct, join, order by) works fine.\nWhat can I do with this.\nMay by I can coerce hibernate do (join, distinct) and (order) in \"different SELECT\" levels?\nHow i can wrap SELECT by another SELECT?</p>\n\n<pre><code>select *\nfrom \n   (select \n     distinct id,\n     secondfield\n   from\n     FIRST as firsts\n   inner join\n     SECOND\n          ... on ...\n   where(......))\norder by\n    (......)\n</code></pre>\n"},{"tags":["hibernate","grails","join","hql","isnull"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12058095,"title":"HQL: How to filter for property if it is null at times","body":"<p>two domain classes (beans)</p>\n\n<p>A and B, A has a property b of type B (-> A.b)\nIn addition, A is the parent of an inheritance hierarchy using a single table.</p>\n\n<p>I would like to join these using HQL and to preserve all Bs that are not associated with an A in the result set.\nIf there are associations between A and B, I want only some of them based on some criteria on A.</p>\n\n<p>My initial query looked like this</p>\n\n<pre><code>SELECT (a.something, b.something)\nFROM A as a RIGHT OUTER JOIN a.b\nWHERE a.dateCreated &lt; someDate;\n</code></pre>\n\n<p>The problem with this query: a is sometimes null such that the WHERE criteria resolves to false and the tuple is not returned so that the result set does not contain Bs that are not associated to an A.</p>\n\n<p>So I modified the query to something like this:</p>\n\n<pre><code>SELECT (a.something, b.something)\nFROM A as a RIGHT OUTER JOIN a.b\nWHERE a is null or (a.dateCreated &lt; someDate);\n</code></pre>\n\n<p>This does not help as in the generated SQL, it does not seem possible to control where the class selection statement, e.g.</p>\n\n<pre><code>where a.class in ('someChildOfA', 'anotherChildOfA', 'aThirdChildOfA')\n</code></pre>\n\n<p>is inserted; it would have to go inside the parentheses, i.e.</p>\n\n<pre><code>where a is null or (a.dateCreated &lt; someDate and a.class in ('someChildOfA', 'anotherChildOfA', aThirdChildOfA'))\n</code></pre>\n\n<p>but it ends up being added outside, i.e.</p>\n\n<pre><code>where (a.id is null OR dateCreated &lt; someDate) and a.class in ('someChildOfA', 'anotherChildOfA', 'aThirdChildOfA')\n</code></pre>\n\n<p>Right now, I am a bit out of ideas... Any (maybe even cleaner) suggestions? If it matters, I am using Grails.</p>\n\n<p>Thanks</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3198,"score":3,"question_id":10818291,"title":"Spring 3.1 + Hibernate 4 - HibernateTemplate","body":"<p>Spring's <a href=\"http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate4/package-summary.html\" rel=\"nofollow\">hibernate4 package</a> appears to have done away with HibernateTemplate and HibernateDaoSupport. I'm in the process of upgrading Hibernate from 3 to 4 in my Spring app and I have a fair few subclasses of Spring's HibernateDaoSupport and a couple of Hibernate callbacks through HibernateTemplate. Perhaps I'm not using the right search terms, but I can't find any info in the reference docs on how I should be refactoring these to <a href=\"http://forum.springsource.org/showthread.php?124677-Is-there-a-class-to-replace-o-s-o-hibernate3-HibernateTemplate-with-Hibernate-4&amp;p=406779#post406779\" rel=\"nofollow\">\"use plain hibernate daos as explained in the reference guide\"</a>. Can anyone help point me in the right direction?</p>\n"},{"tags":["java","hibernate","locking","jpa-2.0","entitymanager"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":138,"score":0,"question_id":12835385,"title":"EntitManager does of singleton bean not work properly incase multiple access from stateless beans","body":"<p>I have an 2 application.One is application client,other one is EJB project.\nMy client  has references to server side.Container Managed Bean transaction is used in beans.I can not I inject entity manager to beans using following statement.</p>\n\n<pre><code>@PersistenceContext(unitName = \"DBService\")\nprivate EntityManager em;\n</code></pre>\n\n<p>I have a message driven bean, 2 stateless bean and a <strong>singleton bean</strong> in server side.\nI have local injection of  2 stateless bean from message driven bean.According to \nmessage type of JMS message (it is come from server or client), message driven bean calls business methods of related statefull beans.Also each one of stateless beans inject singleton bean. </p>\n\n<p>I am doing some changes on entities in singleton bean, updating some fields of entities,  I am sending jms messages  client or server. when messages are handled by 2 stateless beans, it calls business methods of singleton bean. For example I changed a field of entity.Then singleton bean send jms message to client, then client makes some work, then he send message back to server, server consumes this message in message driven bean, then it calls business method of related  Stateless bean\n, then stateless mean calls buısiness method of singleton bean.Then I am doing a query from database,  But I can not see the latest state of changed entity.My changes are overwritten.\nI thought that EntityManager of Singleton bean does not hold state of entities correctly if it is injected by multiple beans.I thought that same singleton bean instance must be get from connection pool. I have serious problems about this. </p>\n\n<p>Do you think that  my detection is correct? or  I am doing something wrong?</p>\n\n<p><strong>Problem</strong>: I think that when a stateless bean calls a method of singleton bean new transaction begins,  then second stateless beans calls a method of singleton bean, it also starts a transaction, but previous one is not committed, 2 transactions are not aware of changes which made by each other's. But I do not know how to solve this.  Using Bean managed transaction is a good solution for singleton beans? </p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13013042,"title":"HibernateSession and EntityManager","body":"<p>A beginning question:</p>\n\n<p>If Hibernate is an implementation of JPA, why doesn't it implement the EntityManager, but the HibernateSession? The two are functionally equivalent (roughtly), but different in use?\nThank you for the clarification.</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13009576,"title":"Hibernate connection12","body":"<p>I have a problem in hibernate connection. In my hibernate.hbm.xml file is like below </p>\n\n<p>\n</p>\n\n<p></p>\n\n<pre><code>&lt;session-factory&gt;\n\n    &lt;!-- Database connection settings --&gt;\n    &lt;!-- &lt;property name=\"connection.driver_class\"&gt;org.hsqldb.jdbcDriver&lt;/property&gt; \n        &lt;property name=\"connection.url\"&gt;jdbc:hsqldb:hsql://localhost/Test&lt;/property&gt; --&gt;\n\n    &lt;property name=\"connection.driver_class\"&gt;com.microsoft.sqlserver.jdbc.SQLServerDriver&lt;/property&gt;\n    &lt;property name=\"connection.url\"&gt;jdbc:jtds:sqlserver://localhost/Test&lt;/property&gt;\n    &lt;property name=\"connection.username\"&gt;test&lt;/property&gt;\n    &lt;property name=\"connection.password\"&gt;sa&lt;/property&gt;\n    &lt;!-- JDBC connection pool (use the built-in) --&gt;\n    &lt;property name=\"connection.pool_size\"&gt;1&lt;/property&gt;\n\n    &lt;!-- SQL dialect --&gt;\n    &lt;property name=\"dialect\"&gt;\n        org.hibernate.dialect.SQLServerDialect\n    &lt;/property&gt;\n    &lt;mapping resource=\"UserdetailsHbmFile.hbm.xml\" /&gt;\n    &lt;mapping class=\"com.sam.UserDetails\" /&gt;\n&lt;/session-factory&gt;\n</code></pre>\n\n<p></p>\n\n<p>AND i get this error</p>\n\n<pre><code>SLF4J: Failed to load class \"org.slf4j.impl.StaticLoggerBinder\".\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\nException in thread \"main\" org.hibernate.exception.JDBCConnectionException: Cannot open connection\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:99)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)\n    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)\n    at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)\n    at org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:160)\n    at org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:81)\n    at org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1473)\n    at RunUserDetails.main(RunUserDetails.java:18)\nCaused by: java.sql.SQLException: No suitable driver found for jdbc:jtds:sqlserver://localhost/Test\n    at java.sql.DriverManager.getConnection(DriverManager.java:604)\n    at java.sql.DriverManager.getConnection(DriverManager.java:190)\n    at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:133)\n    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)\n    ... 5 more\n</code></pre>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13007096,"title":"Hibernate: Query for join with SubQuery","body":"<p>I need to convert below query to hibernate - </p>\n\n<pre><code>select * from ep_batch eb\nINNER JOIN ep_slide slide ON eb.batch_scanner_id  = slide.slide_batch_id\nWHERE eb.batch_scanner_id = 1 AND \neb.batch_status = \n(\nIF((SELECT count(batch_id) as cnt from ep_batch WHERE batch_scanner_id = 1) =1,'Ready','In Progress')\n) ;\n</code></pre>\n\n<p>I do have the \"Slide\" and \"Batch\" pojo represents ep_slide  and ep_batch  resp. with join annotations as  - </p>\n\n<pre><code>@OneToMany(mappedBy = \"batch\")\n    private Set&lt;Slide&gt; slides;\n@ManyToOne\n    @JoinColumn(name = \"batchId\")\n    private Batch batch;\n</code></pre>\n\n<p>I am not very sure how to add the subquery with conditions. \nI am trying something like below - </p>\n\n<pre><code>DetachedCriteria subCriteria = DetachedCriteria.forClass(Slide.class);\n        subCriteria.setProjection(Projections.count(\"batchId\"));\n</code></pre>\n"},{"tags":["hibernate","one-to-many","cascade"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":318,"score":2,"question_id":2870995,"title":"What is best practice about having one-many hibernate","body":"<p>I believe this is a common scenario. Say I have a one-many mapping in hibernate\nCategory has many Item\nCategory:</p>\n\n<pre><code>@OneToMany(\n    cascade = {CascadeType.ALL},fetch = FetchType.LAZY)\n@JoinColumn(name=\"category_id\")\n@Cascade(\n    value = org.hibernate.annotations.CascadeType.DELETE_ORPHAN\n)\nprivate List&lt;Item&gt; items;\n</code></pre>\n\n<p>Item:</p>\n\n<pre><code>@ManyToOne(targetEntity=Category.class,fetch=FetchType.EAGER)\n@JoinColumn(name=\"category_id\",insertable=false,updatable=false)\nprivate Category category;\n</code></pre>\n\n<p>All works fine. I use Category to fully control Item's life cycle. But, when I am writing code to update Category, first I get Category out from DB. Then pass it to UI. User fill in altered values for Category and pass back. Here comes the problem. Because I only pass around Category information not Item. Therefore the Item collection will be empty. When I call saveOrUpdate, it will clean out all associations. </p>\n\n<p>Any suggestion on what's best to address this? I think the advantage of having Category controls Item is to easily main the order of Item and not to confuse bi-directly. But what about situation that you do want to just update Category it self? Load it first and merge? </p>\n\n<p>Thank you.</p>\n"},{"tags":["oracle","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":107,"score":3,"question_id":8034735,"title":"Spring-Hibernate app works differently in 2 different oracles DBs","body":"<p>I have a spring-hibernate application and facing a strange issue. I have 2 separate instances of same app connecting to two different oracle databases. I have a function which uses hibernate's saveOrUpdate() method to update an object in DB. Also primary key of this entity is foreign key of number of tables.</p>\n\n<p>Problem is when we update this entity's object, all the foreign references of this object in other tables are nullified in one of the DB though everything works fine in other DB. Because of this we are having lots of null foreign keys in the DB. I am not able to figure out why this is happening and what exactly needs to be done as for one db everything seems to work fine. Please help.</p>\n"},{"tags":["hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13006866,"title":"Hibernate row mappers","body":"<p>I got my LogEventType in my object array. Is there a way of creating a new LogEventType using its constructor? This is possible i LogEventType was a mapped entity but it is not. Created table logeventtype using sql and regular inserts. In this case returning </p>\n\n<pre><code>new LogEventType(obj[0],obj[1]); \n</code></pre>\n\n<p>would be fine but i will need to fetch a list later.  </p>\n\n<pre><code>Session session = sessionFactory.getCurrentSession();\nString queryString = \"select type.eventid, type.value from logeventtype type where type.eventid = :eventid\";\nQuery query = session.createSQLQuery(queryString).setParameter(\"eventid\", enventId);\nObject[] obj = (Object[]) query.uniqueResult();\n</code></pre>\n\n<p>Edit:\nThis is what I have been trying</p>\n\n<pre><code>Session session = sessionFactory.getCurrentSession();\nString queryString = \"select new com.company.Test(type.value) from logeventtype type where type.eventid = :eventid\";\nQuery query = session.createQuery(queryString).setParameter(\"eventid\", 1l);\nObject[] obj = (Object[]) query.uniqueResult();\n</code></pre>\n\n<p>I get logeventtype is not mapped. </p>\n"},{"tags":["sql","hibernate","maven"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12628614,"title":"How can I load a .sql file when running a Maven/Hibernate project?","body":"<p>I am using  hbm2ddl to create my tables and it works just fine but I also want hibernate to load a .sql file to populate the database each time I run my project.\nI found that Hibernate should do this if my .sql file is in the classpath but it doesn't seem to work. </p>\n\n<p>I am not sure if the file is in the classpath and I dont know how to find that out.\nCurrently my load.sql is in Other Sources/csr/main/resources/</p>\n\n<p>I googled and read that I could add a file to te class path in the properties/libraries menu of my project but it seems Maven project doesn't have that section.</p>\n\n<p>I am using Mysql with JDBC and Netbeans 7.1.2.</p>\n"},{"tags":["java","hibernate","sql-update","hibernate-4.x"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":91,"score":0,"question_id":13009369,"title":"Java: Best practice for updating information","body":"<p>I have an application that is connected to an SQL database using Hibernate. When removing a person from a particular part of the application I want to reset all the information that had been set in the particular part. Below is an example of what I am on about</p>\n\n<pre><code>Stage: Bank\n\nFields to be set in stage:\nBankName\nAccNo\nIBANNo\n...\n</code></pre>\n\n<p>When removing a Person from this stage, what is the best way to reset all the information</p>\n\n<pre><code>public void resetInfo(Person person){\n    person.setBankName(null);\n    person.setAccNo(null);\n    person.setIBANNo(null;)\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>public void resetInfo(Person person){\n    if(person.getBankName != null)  {  \n        person.setBankName(null);\n    }\n    if(person.getAccNo != null)  {  \n        person.setAccNo(null);\n    }\n    if(person.getIBANNo != null)  {  \n        person.setIBANNo(null;)\n    }\n}\n</code></pre>\n\n<p>or is there a better way to do this?</p>\n"},{"tags":["spring","hibernate","calendar","primefaces","spring-webflow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13008652,"title":"Primfaces calendar/hibernate - send date only to database","body":"<p>I have a form which inserts a date into a table. When primefaces calendar is used, the date is correct, but the time is added as well (in my case: 00:00:00.0) </p>\n\n<p>here's my form:</p>\n\n<pre><code>&lt;h:form&gt;\n        &lt;h:messages/&gt;\n        &lt;h:inputText value=\"#{testBean.saveTabletest.first}\"/&gt;&lt;br/&gt;\n        &lt;p:inputMask value=\"#{testBean.saveTabletest.second}\" mask=\"99999\"/&gt;&lt;br/&gt;\n        &lt;p:calendar id=\"testcal\" value=\"#{testBean.saveTabletest.dates}\" dateOnly=\"true\" showOn=\"button\"/&gt;&lt;br/&gt;\n        &lt;p:commandButton value=\"Send\" action=\"save\"/&gt;\n&lt;/h:form&gt;\n</code></pre>\n\n<p>And here is how the date is inserted in the database :  2012-10-03 00:00:00.0</p>\n\n<p>I want the date inserted into the database without the time. The column in the table is a \"date-column\"</p>\n\n<p>Is there a primefaces property that I can set to do this? or do I have to change the function that saves the data in the table (i am using hibernates saveOrupdate)? </p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13007332,"title":"Fetching entity of multiple level using criteria hibernate","body":"<p>I have the following structure:</p>\n\n<p><strong>A.java</strong></p>\n\n<pre><code>private long id;\nprivate String name;\nprivate B bObj;\n// getter-setter\n</code></pre>\n\n<p><strong>B.java</strong></p>\n\n<pre><code>private long id;\nprivate List&lt;B&gt; bList;\n//getter-setter\n</code></pre>\n\n<p>As you can see the structure is recursive.</p>\n\n<p>Now I want to write a Criteria that fetches an object of A along with <code>bObj</code>, <code>bObj.bList</code>, <code>bObj.bList.bList</code>, <code>bObj.bList.bList.bList</code> &amp; so on where no. of level of join is not known.</p>\n\n<p>Any other way except Criteria is also welcome.</p>\n\n<p>Can anyone help me?</p>\n"},{"tags":["linux","hibernate","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":13007824,"title":"Hibernate exception in netbeans?","body":"<pre><code>WARNING: StandardWrapperValve[Faces Servlet]: PWC1406: Servlet.service() for servlet Faces Servlet threw exception\njava.lang.NullPointerException\n    at com.sun.faces.context.flash.ELFlash.doLastPhaseActions(ELFlash.java:607)\n    at com.sun.faces.context.ExternalContextImpl.responseFlushBuffer(ExternalContextImpl.java:857)\n    at com.sun.faces.application.view.JspViewHandlingStrategy.buildView(JspViewHandlingStrategy.java:155)\n    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:100)\n    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)\n    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)\n    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)\n    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)\n    at org.apache.myfaces.webapp.filter.ExtensionsFilter.doFilter(ExtensionsFilter.java:349)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)\n    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)\n    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)\n    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)\n    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)\n    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)\n    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)\n    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)\n    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)\n    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)\n    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)\n    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)\n    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)\n    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)\n    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)\n    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)\n    at java.lang.Thread.run(Thread.java:722)\n</code></pre>\n"},{"tags":["java","hibernate","hsqldb","dbvisualizer"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1027,"score":1,"question_id":1723861,"title":"something funny with embedded hsql","body":"<p>Hello good people\ni'm just curious about something.I'm using hsql in myproject (embedded of course).At some time i felt the need to visualize what hibernate was generating.I took a free copy of dbvisualizer. here is the hsqljdbc.properties </p>\n\n<blockquote>\n  <p>jdbc.url=jdbc:hsqldb:file:mydb;create=true<br>\n   hibernate hbm2ddl.auto=create  </p>\n</blockquote>\n\n<p>i downloaded the hsql 1.8.0_10. i did all the required procedure.i could connect and see the tables but after that changes made to the table don't seem be willing to show up.then i've tried to delete the db generate a new one but still.You got any idea in this?</p>\n\n<p>I usually Derby but i've realized lately that it's not that precise about relationship management.I use mysql for the moment which is not good for development so i want to know if i forgot to do something or it's just meant to behave that way.Thanks for reading this</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13004142,"title":"Hibernate restriction in causes an error if the list is empty","body":"<p>If my list is empty, I can the following error:</p>\n\n<pre><code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')'\n</code></pre>\n\n<p>Below is my hibernate related method:</p>\n\n<pre><code>  @Override\n    public List&lt;SomeThing&gt; findByIds(List&lt;Integer&gt; someIds) {\n        return sessionFactory.getCurrentSession().createCriteria(SomeClass.class)\n                .add(Restrictions.in(\"id\", someIds))\n                .list();\n    }\n</code></pre>\n\n<p>What should I do to guard against this error?</p>\n\n<p>I know I could short-circuit the call and return an empty list like:</p>\n\n<pre><code>if(someIds == null || someIds.size() == 0) {\n  return new List&lt;SomeThing&gt;();\n}\n</code></pre>\n\n<p>But is the a more elagent way to do this?</p>\n"},{"tags":["hibernate","composite-key","self-join"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13006930,"title":"hibernate self join composite key with annotation","body":"<p>I want to map a class category by itself using another class categoryRef.\nClass category has child categories and a parent category all throu by class categoryRef</p>\n\n<pre><code>CREATE TABLE ` category` (\n  ` category_id`  int unsigned NOT NULL AUTO_INCREMENT,\n  `category_name`  varchar(50) NOT NULL,\n  PRIMARY KEY (`category_id`),\n}\n\nCREATE TABLE ` categoryXREF` (\n  ` category_parent_id`  int unsigned NOT NULL,\n  `category_child_id`  int unsigned NOT NULL,\n  `ordering`  smallint(1) unsigned,\n PRIMARY KEY (category_parent_id , category_child_id )\n}\n</code></pre>\n\n<p>and classes as follows</p>\n\n<pre><code>import javax.persistence.*;\nimport java.io.Serializable;\n\n@Embeddable\npublic class PrimaryKeyCategoryXRef implements Serializable {\n\n@Column(name = \"category_parent_id\")\nprivate Long parentId;\n\n@Column(name = \"category_child_id\")\nprivate Long childId;\n\npublic PrimaryKeyCategoryXRef() {\n}\n\npublic PrimaryKeyCategoryXRef(Long parentId, Long childId) {\n    this.parentId = parentId;\n    this.childId = childId;\n}\n\n\n\npublic Long getChildId() {\n    return childId;\n}\n\npublic void setChildId(Long childId) {\n    this.childId = childId;\n}\n\npublic Long getParentId() {\n    return parentId;\n}\n\npublic void setParentId(Long parentId) {\n    this.parentId = parentId;\n}\n\n\n\n\npublic boolean equals(Object o) {\n    if (o != null &amp;&amp; o instanceof PrimaryKeyCategoryXRef) {\n        PrimaryKeyCategoryXRef that = (PrimaryKeyCategoryXRef) o;\n        return this.parentId.equals(that.parentId)\n                &amp;&amp; this.childId.equals(that.childId);\n    } else {\n        return false;\n    }\n}\n\npublic int hashCode() {\n    return parentId.hashCode() + childId.hashCode();\n}\n</code></pre>\n\n<p>}</p>\n\n<pre><code>@Entity\n@Table(name = \"categoryRef\")\npublic class CategoryXRef implements Serializable{\n\n@EmbeddedId   \nprivate PrimaryKeyCategoryXRef id;\n\n@Column(name = \"ordering\")\nprivate Long ordering;\n\n@ManyToOne(targetEntity=Category.class,fetch = FetchType.LAZY, cascade =   CascadeType.ALL)\n@JoinColumn(name = \"category_parent_id\",insertable = false,updatable = false)\n@org.hibernate.annotations.NotFound(action=org.hibernate.annotations.NotFoundAction.IGNORE)\nprivate ProductCategory parent;\n\n@ManyToOne(targetEntity=Category.class,fetch = FetchType.LAZY, cascade = CascadeType.ALL)\n@JoinColumn(name = \"category_child_id\",insertable = false,updatable = false)\n@org.hibernate.annotations.NotFound(action=org.hibernate.annotations.NotFoundAction.IGNORE)\nprivate ProductCategory child;\n\n\n\npublic CategoryRef(){\n\n}\n\npublic CategoryRef(Long ordering, ProductCategory parent, ProductCategory child) {\n    this.ordering = ordering;\n    this.parent = parent;\n    this.child = child;\n\n    // Set identifier values\n    id = new PrimaryKeyCategoryXRef();\n    this.id.setParentId(parent.getId());\n    this.id.setChildId(child.getId());\n\n    // Guarantee referential integrity\n    parent.getCategories().add(this);\n}\n\npublic ProductCategory getChild() {\n    return child;\n}\n\npublic void setChild(ProductCategory child) {\n    this.child = child;\n}\n\npublic ProductCategory getParent() {\n    return parent;\n}\n\npublic void setParent(ProductCategory parent) {\n    this.parent = parent;\n}\n\npublic Long getOrdering() {\n    return ordering;\n}\n\npublic void setOrdering(Long ordering) {\n    this.ordering = ordering;\n}\n\n\npublic PrimaryKeyCategoryXRef getId() {\n    return id;\n}\n\npublic void setId(PrimaryKeyCategoryXRef id) {\n    this.id = id;\n}\n\n\n@Entity\n@Table(name = \"category\")\npublic class Category implements Serializable{\n\n@Id\n@GeneratedValue(strategy=GenerationType.IDENTITY)\n@Column(name = \" category_id\")\nprivate Long id;\n\n@Column(name = \"name\")\nprivate String name;\n\n@OneToMany(targetEntity=CategoryRef.class, mappedBy = \"parent\", cascade = CascadeType.ALL, fetch = FetchType.LAZY)\n@OrderBy(\"ordering\")\n@JoinColumn(name = \"category_parent_id\")\nprivate Set&lt;CategoryRef&gt; categories =  new HashSet&lt;CategoryRef&gt;();\n\n@ManyToOne(targetEntity=CategoryRef.class, fetch=FetchType.LAZY)\n@JoinColumns(value = {\n     @JoinColumn(name = \"childId\", referencedColumnName = \"category_child_id\"), \n     @JoinColumn(name = \"parentId\", referencedColumnName = \"category_parent_id\")\n\n})  \n   @org.hibernate.annotations.NotFound(action=org.hibernate.annotations.NotFoundAction.IGNORE)\nprivate CategoryRef parent = new CategoryRef();\n\n\npublic ProductCategory(){\n\n}\n\npublic Set&lt;CategoryRef&gt; getCategories() {\n    return categories;\n}\n\npublic void setCategories(Set&lt;CategoryRef&gt; categories) {\n    this.categories = categories;\n}\n\npublic Long getId() {\n    return id;\n}\n\npublic void setId(Long id) {\n    this.id = id;\n}\n\npublic CategoryRef getParent() {\n    return parent;\n}\n\npublic void setParent(CategoryRef parent) {\n    this.parent = parent;\n}\n\n}\n</code></pre>\n\n<p>but when i try to get a list of categories am getting the following message:</p>\n\n<pre><code>org.hibernate.PropertyAccessException: could not get a field value by reflection\ngetter of PrimaryKeyCategoryXRef.childId\n.....\n</code></pre>\n"},{"tags":["java","hibernate","spring","jpa","jboss"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1861,"score":0,"question_id":6853112,"title":"Spring 3..0.5 + hierbnate 3.6.6.final + jboss as 7 Database access","body":"<p>I'm upgrading our projects from spring 2.5.6, hibernate 3.3.2, jboss 4.2 to <strong>Spring 3..0.5 + hierbnate 3.6.6.final + jboss as 7</strong>.</p>\n\n<p>Lots of issues there and I decided to write a simple project and delopy it on jboss as7(with Spring 3..0.5 + hierbnate 3.6.6.final) at the begining. The project is very simple: A DAO class will access the MYSQL database. But the application fails when it's entityManager try to access the DB, throwing \"threw exception: org.hibernate.MappingException: Unknown entity\".</p>\n\n<p>Below is my project:</p>\n\n<p>My web controller class:</p>\n\n<pre><code>package com.yan.testing.web.controller;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport com.yan.testing.jpa.dao.IYanDao;\nimport com.yan.testing.jpa.entity.Yan;\n\n@Controller\npublic class WebController {\n\n    @Autowired\n    IYanDao yanDao;\n\n    @RequestMapping(\"sayHello.do\")\n    public String SayHello(){\n        Yan yan = yanDao.findById(1L);\n        System.out.println(yan.getName());\n        return \"sayHello\";\n    }\n}\n</code></pre>\n\n<p>My DAO inferface:</p>\n\n<pre><code>package com.yan.testing.jpa.dao;\n\nimport com.yan.testing.jpa.entity.Yan;\n\npublic interface IYanDao {\n    Yan findById(Long id);\n}\n</code></pre>\n\n<p>And In my DAO class :</p>\n\n<pre><code>package com.yan.testing.jpa.dao.impl;\n\nimport javax.persistence.EntityManager;\nimport javax.persistence.PersistenceContext;\nimport org.springframework.stereotype.Repository;\nimport com.yan.testing.jpa.dao.IYanDao;\nimport com.yan.testing.jpa.entity.Yan;\n\n@Repository(value=\"yanDao\")\npublic class YanDao implements IYanDao{\n\n    private EntityManager entityManager;\n    @PersistenceContext \n    public void setEntityManager(EntityManager entityManager) {\n        this.entityManager = entityManager;\n    }\n\n    public Yan findById(Long id){\n        return entityManager.find(Yan.class, id);\n    }\n}\n</code></pre>\n\n<p><strong>Here comes the problem:\n    <code>\"entityManager.find(Yan.class, id);\"</code> throw exception:</strong></p>\n\n<pre><code>Servlet.service() for servlet spring threw exception: org.hibernate.MappingException: Unknown entity: com.yan.testing.jpa.entity.Yan\n</code></pre>\n\n<p>It seems like hibernate don't recognize my entity. As my entity is generated using Jboss tools, I can't find any error in my entity class. </p>\n\n<p>Below is my entity class:</p>\n\n<pre><code>package com.yan.testing.jpa.entity;\n\n// default package\n// Generated Jul 27, 2011 4:15:52 PM by Hibernate Tools 3.4.0.CR1\n\nimport static javax.persistence.GenerationType.IDENTITY;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n/**\n * Yan generated by hbm2java\n */\n\n@Entity\n@Table(name = \"yan\", catalog = \"fuhu_app_submission\")\npublic class Yan implements java.io.Serializable {\n\n    private static final long serialVersionUID = -6812001362936479032L;\n    private Integer objId;\n    private String name;\n\n    public Yan() {\n    }\n\n    public Yan(String name) {\n        this.name = name;\n    }\n\n    @Id\n    @GeneratedValue(strategy = IDENTITY)\n    @Column(name = \"obj_id\", unique = true, nullable = false)\n    public Integer getObjId() {\n        return this.objId;\n    }\n\n    public void setObjId(Integer objId) {\n        this.objId = objId;\n    }\n\n    @Column(name = \"name\", length = 45)\n    public String getName() {\n        return this.name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n}\n</code></pre>\n\n<p>Below is my application and jboss as 7 configuration:</p>\n\n<p>applicationContext.xml(which basically define a entityManagerFactory bean)</p>\n\n<pre><code>&lt;context:component-scan base-package=\"com.yan.testing\"/&gt; \n&lt;context:annotation-config/&gt;\n\n&lt;bean id=\"dataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n    &lt;property name=\"jndiName\" value=\"java:jboss/datasources/MySqlDS\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"persistenceXmlLocation\" value=\"classpath*:META-INF/jpa-persistence.xml\"/&gt;   \n    &lt;property name=\"jpaVendorAdapter\"&gt;\n            &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n                &lt;property name=\"showSql\" value=\"false\" /&gt;\n            &lt;/bean&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;    \n&lt;tx:annotation-driven /&gt;\n</code></pre>\n\n<p>jpa-persistence.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;persistence version=\"1.0\"\n    xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\"&gt;\n\n    &lt;persistence-unit name=\"app_sub_jpa\"&gt;\n        &lt;description&gt;Hibernate for JPA&lt;/description&gt;\n        &lt;properties&gt;\n            &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQLDialect\" /&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>My jboss confi standalone.xml:</p>\n\n<pre><code>&lt;subsystem xmlns=\"urn:jboss:domain:datasources:1.0\"&gt;\n            &lt;datasources&gt;\n                &lt;datasource jndi-name=\"java:jboss/datasources/MySqlDS\" pool-name=\"MySqlDS\" enabled=\"true\" jta=\"true\" use-java-context=\"true\" use-ccm=\"true\"&gt;\n                    &lt;connection-url&gt;\n                        jdbc:mysql://127.0.0.1:3306/my_schema\n                    &lt;/connection-url&gt;\n                    &lt;driver&gt;\n                        com.mysql\n                    &lt;/driver&gt;\n                    &lt;transaction-isolation&gt;\n                        TRANSACTION_READ_COMMITTED\n                    &lt;/transaction-isolation&gt;\n                    &lt;security&gt;\n                        &lt;user-name&gt;\n                            root\n                        &lt;/user-name&gt;\n                        &lt;password&gt;\n                            root\n                        &lt;/password&gt;\n                    &lt;/security&gt;\n                    &lt;statement&gt;\n                        &lt;prepared-statement-cache-size&gt;\n                            32\n                        &lt;/prepared-statement-cache-size&gt;\n                    &lt;/statement&gt;\n                &lt;/datasource&gt;\n                &lt;drivers&gt;\n                    &lt;driver name=\"com.mysql\" module=\"com.mysql\"&gt;\n                        &lt;xa-datasource-class&gt;\n                            com.mysql.jdbc.jdbc2.optional.MysqlXADataSource\n                        &lt;/xa-datasource-class&gt;\n                    &lt;/driver&gt;\n                &lt;/drivers&gt;\n            &lt;/datasources&gt;\n        &lt;/subsystem&gt;\n</code></pre>\n\n<p>Any help or hints are appreciated. </p>\n\n<p>Thank you</p>\n\n<p>Andrew</p>\n"},{"tags":["spring","hibernate","java-ee","spring-data","spring-data-jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":13005864,"title":"Spring Data JPA select Distinct values with ability to use Pageable","body":"<p>I use Spring Data JPA in project. I have next Entity Bean \"TABLE\". I have created own repository </p>\n\n<pre><code>TableRepository extends JpaRepository&lt;Table, Long&gt;, JpaSpecificationExecutor&lt;TABLE&gt;. \n</code></pre>\n\n<p>Also I've created Specification to select filtered data. I have bean with items that should be selected and group them in one list of <em>.in()</em> predicates (something like \"<em>SELECT * FROM WHERE ID in(...) AND VALUE in(...) AND VALUE2 in(...) ...</em>\")</p>\n\n<pre><code>public static Specification&lt;Table&gt; filteredListOfValues(final FilterRequestsParametersBean filterRequestsParametersBean) {\n        return new Specification&lt;Table&gt;() {\n\n            public Predicate toPredicate(Root&lt;Table&gt; root, CriteriaQuery&lt;?&gt; criteriaQuery, CriteriaBuilder criteriaBuilder) {\n                List&lt;Predicate&gt; listOfPredicates = createListOfPredicates(root, filterRequestsParametersBean);\n                return criteriaBuilder.and(listOfPredicates.toArray(new Predicate[listOfPredicates.size()]));\n            }\n        };\n    }\n</code></pre>\n\n<p>After that I <em>findAll()</em> items with <em>TableRepository</em> and <em>Pageable</em> parameter.</p>\n\n<pre><code>this.getTableRepository().findAll(where(filteredListOfValues(filterRequestsParametersBean)), pageable);\n</code></pre>\n\n<p><em>Table</em> view:</p>\n\n<pre><code>id, value, etc..\n 1,   1,   ...\n 2,   1,   ...\n 3,   2,   ...\n 4,   2,   ...\n 5,   3,   ...\n 6,   5,   ...\n</code></pre>\n\n<p>And question. How can I select all values that are distinct from field <em>VALUE</em> in <em>TABLE</em> with using Pageable.</p>\n\n<hr>\n\n<p>Of course I can use HashMap, but I will not have facilities of Pageable from Spring Data JPA. I need sorting and paging. </p>\n\n<p>I also can use Specification for one field Value, like:</p>\n\n<pre><code>    public static Specification&lt;Long&gt; filteredListOfValues(final FilterRequestsParametersBean filterRequestsParametersBean) {\n            return new Specification&lt;Long&gt;() {\n\n                public Predicate toPredicate(Root&lt;Long&gt; root, CriteriaQuery&lt;?&gt; criteriaQuery, CriteriaBuilder criteriaBuilder) {\n\n....//somethind like that\ncriteriaQuery.select(root.&lt;Long&gt; get(\"value\")).distinct(true);\n....\nList&lt;Predicate&gt; listOfPredicates = createListOfPredicates(root, filterRequestsParametersBean);\n                    return criteriaBuilder.and(listOfPredicates.toArray(new Predicate[listOfPredicates.size()]));\n                }\n            };\n        }\n</code></pre>\n\n<p>but in that case, method findAll() from repository TableRepository only can accept specification like: <code>JpaSpecificationExecutor&lt;Table&gt;</code>, not <code>JpaSpecificationExecutor&lt;Long&gt;</code></p>\n\n<p>Thanks.</p>\n"},{"tags":["hibernate","jpa-2.0","criteriaquery"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1533,"score":0,"question_id":5563724,"title":"JPA/Hibernate typesafe DELETE queries","body":"<p>The only CriteriaQuery examples I've seen are for SELECT queries.  Is there a way to construct typesafe DELETE queries, either with JPA 2 or Hibernate APIs?</p>\n"},{"tags":["hibernate","java-ee"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":24,"score":-2,"question_id":13003801,"title":"How to display my search result?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12999663/how-to-retrieve-search-result\">How to retrieve search result?</a>  </p>\n</blockquote>\n\n\n\n<p>Can you please give me some solution for solve this please I have trouble this please kindness to me.\n<a href=\"http://stackoverflow.com/questions/12999663/how-to-retrieve-search-result\">How to retrieve search result?</a></p>\n"},{"tags":["hibernate","datasource","tomcat7","jndi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13003711,"title":"JNDI datasource error upgrading from Tomcat 7.0.23 to 7.0.27","body":"<p>I'm trying to upgrade from Tomcat 7.0.23 to 7.0.27 (actually running Liferay). I'm getting the following exception when trying to access a datasource via Hibernate:</p>\n\n<pre><code>16:28:27,694 ERROR [http-bio-8080-exec-1][DatasourceConnectionProvider:110] Could not find datasource: java:/comp/env/jdbc/MySqlDS\njavax.naming.NameNotFoundException: Name [java:/comp/env/jdbc/MySqlDS] is not bound in this Context. Unable to find [java:].\n    at org.apache.naming.NamingContext.lookup(NamingContext.java:820)\n    at org.apache.naming.NamingContext.lookup(NamingContext.java:168)\n    at org.apache.naming.SelectorContext.lookup(SelectorContext.java:158)\n    at javax.naming.InitialContext.lookup(InitialContext.java:392)\n    at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:75)\n    at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:143)\n    at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:84)\n    at org.hibernate.cfg.SettingsFactory.createConnectionProvider(SettingsFactory.java:459)\n    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:90)\n    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2863)\n    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2859)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1870)\n[...]\n</code></pre>\n\n<p>The exact same code runs fine in 7.0.23 (I can drop the WAR file in either instance).</p>\n\n<p>Here is my $CATALINA_HOME/conf/context.xml file (comments removed):</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;!-- The contents of this file will be loaded for each web application --&gt;\n&lt;Context&gt;\n\n    &lt;!-- Default set of monitored resources --&gt;\n    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;\n\n  &lt;Resource name=\"jdbc/MySqlDS\" auth=\"Container\"\n            type=\"javax.sql.DataSource\"\n            driverClassName=\"com.mysql.jdbc.Driver\"\n            username=\"xxx\"\n            password=\"xxx\"\n            url=\"jdbc:mysql://localhost:3306/xx?useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;relaxAutoCommit=true\"\n            maxActive=\"200\" maxIdle=\"30\" maxWait=\"10000\"\n            minIdle=\"3\"\n            testWhileIdle=\"true\" testOnBorrow=\"true\"\n            timeBetweenEvictionRunsMillis=\"120000\"\n            minEvictableIdleTimeMillis=\"600000\"\n            validationQuery=\"select 1\"\n        /&gt;\n&lt;/Context&gt;\n</code></pre>\n\n<p>The web.xml from the application:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;web-app version=\"2.4\" xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"     xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\"&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;HibernateServlet&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;com.liferay.samplehibernate.servlet.HibernateServlet&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;HibernateServlet&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/servlet/*&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n    &lt;jsp-config&gt;\n        &lt;taglib&gt;\n            &lt;taglib-uri&gt;http://java.sun.com/portlet_2_0&lt;/taglib-uri&gt;\n            &lt;taglib-location&gt;\n                /WEB-INF/tld/liferay-portlet.tld\n            &lt;/taglib-location&gt;\n        &lt;/taglib&gt;\n    &lt;/jsp-config&gt;\n    &lt;resource-ref&gt;\n            &lt;description&gt;data source&lt;/description&gt;\n            &lt;res-ref-name&gt;jdbc/MySqlDS&lt;/res-ref-name&gt;\n            &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;\n            &lt;res-auth&gt;Container&lt;/res-auth&gt;\n    &lt;/resource-ref&gt;\n&lt;/web-app&gt;\n</code></pre>\n\n<p>And finally the the hibernate.cfg.xml file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n    &lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"     \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n\n        &lt;!-- Mappings --&gt;\n        &lt;property name=\"connection.datasource\"&gt;java:/comp/env/jdbc/MySqlDS&lt;/property&gt;\n        &lt;property name=\"dialect\"&gt;\n            org.hibernate.dialect.MySQLDialect\n        &lt;/property&gt;\n\n        &lt;mapping\n            resource=\"com/liferay/samplehibernate/model/FoodItem.hbm.xml\" /&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Any suggestions about what I'm missing? Thanks.</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12988538,"title":"JPA - How to map the relationship between two tables?","body":"<p>I'm new to JPA, and trying to figure out how to correctly map the following relationship between two database tables:</p>\n\n<p><code>movies { id, title, rating }</code></p>\n\n<p><code>ratings { id, rating }</code></p>\n\n<p>So that querying the movies database will return the rating string ('g', 'pg', etc) from the second table for that movie.  Each of these is their own @Entity and java class as shown below.    Do I have to something in the <code>getRating()</code> method of the <code>MovieCatalogEntity</code> to get the correct rating?</p>\n\n<pre><code>    @Entity(name=\"movieCatalog\")\n    public class MovieCatalogEntity {\n\n        @Id\n        @Column(name=\"ID\", nullable=false)\n        private long id;\n\n        @Column(name=\"Title\", nullable=false)\n        private String title;\n\n            ??? What goes here ????????\n            private RatingEntity rating;\n    }\n\n\n@Entity(name=\"Rating\")\npublic class RatingEntity {\n\n    @Id\n    @Column(name = \"id\", nullable=false)\n    private long id;\n\n    @Column(name=\"Rating\", nullable=false)\n    private String rating;\n}\n</code></pre>\n"},{"tags":["hibernate","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":12999663,"title":"How to retrieve search result?","body":"<p>my project is java ee web application i used hibernate for that I want to search values accoding to item_id so, I write the code for search result but that search values are not display so how can i solve this please help me.</p>\n\n<pre><code>        if(submitType != null &amp;&amp; item_id != null)\n     {\n\n\n     try {\n        AssetsObject assets = new AssetsObject();\n\n        assets.setItem_id(item_id);\n\n        AssetsObject assets1 =assetsProvider.getAssets(assets);\n\n\n\n\n\n\n                item_name= assets1.getItem_name();\n\n                hardware = assets1.getHardware();\n\n                software = assets1.getSoftware();\n\n                vender = assets1.getVender();\n\n                venderTel = assets1.getVenderTel();\n\n                venderaddress= assets1.getVenderaddress();\n\n\n                return INPUT;\n\n\n                }\n         catch (Exception e)\n         {\n        addActionError(\"Not vailed item No or its not in the database\");\n                        //return INPUT;\n        }\n</code></pre>\n\n<p>my implimenter class query is this I think problem of the this class,can you please fix this?</p>\n\n<p>public  class AssetsProviderImpl  implements AssetsProvider\n      {\n          protected static Logger log = Logger.getLogger(AssetsProviderImpl.class\n                    .getName());    </p>\n\n<pre><code>        private HibernateProvider hibernateProvider;\n\n        public AssetsProviderImpl(HibernateProvider hibernateProvider) throws ProviderException\n        {\n            this.hibernateProvider = hibernateProvider;\n\n            log.info(\"AssetsProviderImpl created\");\n        }   \n\n        public AssetsObject insertAssets(AssetsObject assets) throws ProviderException\n        {\n\n\n            return (AssetsObject) hibernateProvider.save(assets);\n\n\n        }\n\n        public AssetsObject getAssets(AssetsObject assets) throws ProviderException\n        {\n            try\n            {\n                Session session = hibernateProvider.openSession();          \n\n                try\n                {               \n\n                    Query query = (Query) session.createQuery(\"from org.efs.openreports.objects.AssetsObject as assets \"\n                                + \"where assets.item_id = ?\");\n                    List list1 = (List) ((org.hibernate.Query) query).list();\n\n                    AssetsObject as = (AssetsObject) list1; \n\n                    return as;\n                }\n                catch (HibernateException he)\n                {               \n                    throw he;\n                }\n                finally\n                {\n                    session.close();\n                }\n            }\n            catch (HibernateException he)\n            {\n                throw new ProviderException(he);\n            }\n        }\n</code></pre>\n\n<p>></p>\n"},{"tags":["hibernate","lazy-initialization"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":20771,"score":3,"question_id":2469700,"title":"Could not initialize proxy - No Session again","body":"<p>I get these error log when viewing a page</p>\n\n<pre>\nERROR [TP-Processor11] (LazyInitializationException.java:42) - could not initialize proxy - no Session\norg.hibernate.LazyInitializationException: could not initialize proxy - no Session\n    at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:132)\n    at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:174)\n    at org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:190)\n    at org.osmoz.contents.model.enm.ContentType_$$_javassist_71.getDefaultShortMode(ContentType_$$_javassist_71.java)\n    at org.osmoz.contents.web.tapestry.components.EnmContentZone.getTemplate(EnmContentZone.java:67)\n    at org.osmoz.contents.web.tapestry.base.AbstractRawContentZone.getContent(AbstractRawContentZone.java:67)\n    at $PropertyConduit_1276091af82.get($PropertyConduit_1276091af82.java)\n    at org.apache.tapestry5.internal.bindings.PropBinding.get(PropBinding.java:58)\n    at org.apache.tapestry5.internal.structure.InternalComponentResourcesImpl$1.read(InternalComponentResourcesImpl.java:510)\n    at org.apache.tapestry5.internal.structure.InternalComponentResourcesImpl$1.read(InternalComponentResourcesImpl.java:496)\n    at org.apache.tapestry5.corelib.components.OutputRaw._$read_parameter_value(OutputRaw.java)\n    at org.apache.tapestry5.corelib.components.OutputRaw.beginRender(OutputRaw.java:43)\n    at org.apache.tapestry5.corelib.components.OutputRaw.beginRender(OutputRaw.java)\n    at\n</pre>\n\n<p>I know the problem is Session has been closed. But I really don't know why this error occur not so often that why I don't know the root cause is.</p>\n\n<p><strong>Enviroment:</strong> </p>\n\n<p>Tapestry5, JPA, Hibernate 3.3.2.GA</p>\n\n<p>I've set</p>\n\n<pre><code>&lt;filter-class&gt;org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter&lt;/filter-class&gt;\n</code></pre>\n\n<p>in web.xml \nalso</p>\n"},{"tags":["hibernate","inheritance","hql"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13002430,"title":"HQL - join with only one subclasses","body":"<p>My model (InheritanceType.JOINED):</p>\n\n<blockquote>\n<pre><code>class Parent{...} \nclass Child1 extends Parent{...}   \nclass Child2 extends Parent{...}\nclass Child3 extends Parent{...}\nclass Child4 extends Parent{...}\nclass Agg{\n  List&lt;Parent&gt; l;\n}\n</code></pre>\n</blockquote>\n\n<p>Agg is connected with parent via join table. Parent don't have Agg object.</p>\n\n<p>I am doing some filtering on Child2 i.e:\n\" From Child2 ch2 WHERE ch2.field1 =... ch2.field2 =... etc.\"</p>\n\n<p>How can I now join Child2 with Agg, without causing join with all subclasses tables. \nI simple want to join only with Child2 table (without joining with Child2, Child3, Child4)</p>\n\n<p>I was trying to use 'class' property (i.e. ch2.class =...) the result is correct, but generated query contains join to every subclasses ;/ </p>\n\n<p>HQL \"From Agg a Join a.l\" also join with all sub-classes (even with ch2.class)</p>\n\n<p>Thanks!</p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3762,"score":1,"question_id":3718015,"title":"object references an unsaved transient instance","body":"<p>I get this hibernate error(in the title), when I turn off the cascading<code>(Cascade.ALL)</code> and start to manually <code>em.persist()</code> the lower-in-the-hierarchy entities. So this is not possible at all?\nI'm sure that the entities are persistent before, they are even in the database, but I get this error.\nHow to fix it?<br>\nEDIT:</p>\n\n<pre><code>java.lang.IllegalStateException: org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: cz.domain.model.PlayerInMatch.player -> cz.domain.model.Player\n        at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1176)\n        at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1112)\n        at org.hibernate.ejb.AbstractEntityManagerImpl$1.beforeCompletion(AbstractEntityManagerImpl.java:1008)\n        at com.sun.enterprise.transaction.JavaEETransactionImpl.commit(JavaEETransactionImpl.java:412)\n        at com.sun.enterprise.transaction.JavaEETransactionManagerSimplified.commit(JavaEETransactionManagerSimplified.java:837)\n        at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5040)\n        at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4805)\n        at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2004)\n        at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1955)\n        at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:198)\n        at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:84)\n        at $Proxy202.create(Unknown Source)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.springframework.ejb.access.LocalSlsbInvokerInterceptor.invokeInContext(LocalSlsbInvokerInterceptor.java:71)\n        at org.springframework.ejb.access.AbstractSlsbInvokerInterceptor.invoke(AbstractSlsbInvokerInterceptor.java:189)\n        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n        at $Proxy205.create(Unknown Source)\n        at cz.domain.controller.Controllers.persistMatch(Controllers.java:29)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:174)\n        at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:421)\n        at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:409)\n        at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:771)\n        at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716)\n        at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)\n        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n        at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1523)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)\n        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)\n        at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)\n        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:325)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)\n        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:165)\n        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)\n        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)\n        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)\n        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)\n        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)\n        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)\n        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)\n        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)\n        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)\n        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)\n        at com.sun.grizzly.ContextTask.run(ContextTask.java:69)\n        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)\n        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)\n        at java.lang.Thread.run(Thread.java:619)\nCaused by: org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: cz.domain.model.PlayerInMatch.player -> cz.domain.model.Player\n        at org.hibernate.engine.CascadingAction$9.noCascade(CascadingAction.java:387)\n        at org.hibernate.engine.Cascade.cascade(Cascade.java:172)\n        at org.hibernate.event.def.AbstractSaveEventListener.cascadeBeforeSave(AbstractSaveEventListener.java:451)\n        at org.hibernate.event.def.DefaultPersistEventListener.entityIsPersistent(DefaultPersistEventListener.java:158)\n        at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:132)\n        at org.hibernate.impl.SessionImpl.firePersistOnFlush(SessionImpl.java:826)\n        at org.hibernate.impl.SessionImpl.persistOnFlush(SessionImpl.java:818)\n        at org.hibernate.engine.CascadingAction$9.cascade(CascadingAction.java:357)\n        at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:392)\n        at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:335)\n        at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:204)\n        at org.hibernate.engine.Cascade.cascade(Cascade.java:161)\n        at org.hibernate.event.def.AbstractSaveEventListener.cascadeBeforeSave(AbstractSaveEventListener.java:451)\n        at org.hibernate.event.def.DefaultPersistEventListener.entityIsPersistent(DefaultPersistEventListener.java:158)\n        at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:132)\n        at org.hibernate.impl.SessionImpl.firePersistOnFlush(SessionImpl.java:826)\n        at org.hibernate.impl.SessionImpl.persistOnFlush(SessionImpl.java:818)\n        at org.hibernate.engine.CascadingAction$9.cascade(CascadingAction.java:357)\n        at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:392)\n        at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:335)\n        at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:204)\n        at org.hibernate.engine.Cascade.cascade(Cascade.java:161)\n        at org.hibernate.event.def.AbstractFlushingEventListener.cascadeOnFlush(AbstractFlushingEventListener.java:154)\n        at org.hibernate.event.def.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:145)\n        at org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:88)\n        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1206)\n        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:375)\n        at org.hibernate.ejb.AbstractEntityManagerImpl$1.beforeCompletion(AbstractEntityManagerImpl.java:1001)\n        ... 56 more\n</code></pre>\n"},{"tags":["java","mysql","sql","hibernate","lazy-loading"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":271,"score":2,"question_id":11526255,"title":"Lazy fetching single column (class attribute) with Hibernate","body":"<p>I have an old table that I'm working with, which looks like this:</p>\n\n<pre><code>+------------------+--------------+------+-----+---------+-------+\n| Field            | Type         | Null | Key | Default | Extra |\n+------------------+--------------+------+-----+---------+-------+\n| BINARY_DATA_ID   | varchar(255) | NO   | PRI |         |       |\n| BINARY_DATA      | longblob     | YES  |     | NULL    |       |\n| BINARY_DATA_NAME | varchar(255) | YES  |     | NULL    |       |\n+------------------+--------------+------+-----+---------+-------+\n</code></pre>\n\n<p>The main problem with this is that the <code>BinaryData</code> Java class loads the <code>BINARY_DATA</code> column, even if I only require the <code>BINARY_DATA_NAME</code>. I know that the best way to architect this is to split the data from the meta-data (like the file name) so they live in separate tables. From there it's trivial to make the data lazy-loaded. This is how it should have been done in the first place.</p>\n\n<p>Unfortunately it may not be possible for me to do the above due to organizational constraints. As a workaround, is it possible to make that column lazy-loaded using some annotations instead of splitting things out into separate tables? I've modified the <code>BinaryData</code> class so that it has an inner static <code>BinaryDataData</code> class which is <code>@Embedded</code> and the attribute is <code>@Basic(fetch=FetchType.LAZY)</code>:</p>\n\n<pre><code>@Entity\n@Table\n@Proxy(lazy=false)\n@Inheritance(strategy=InheritanceType.JOINED)\npublic class BinaryData implements Serializable, Persistable&lt;BinaryData&gt;, Cloneable {\n\n    private static final long serialVersionUID = /** blah */;\n\n    @Id @Column @GeneratedValue(generator=\"uuid\") @GenericGenerator(name=\"uuid\", strategy=\"uuid\")\n    private String id;\n\n    @Column\n    private String binaryDataName;\n\n    @Embedded\n    @Basic(fetch = FetchType.LAZY)\n    private BinaryDataData binaryData;\n\n    @Transient\n    private String cacheId;\n\n    /**\n     * Hibernate constructor\n     */\n    public BinaryData() { /* Creates a new instance of Attachment. */}\n\n    public BinaryData(byte[] binaryData, String binaryDataName) {\n        this.binaryData = new BinaryDataData(ArrayUtils.clone(binaryData));\n        this.binaryDataName = binaryDataName;\n    }\n\n    /**\n     * Returns the BinaryData byte stream.\n     *\n     * @return binaryData byte stream\n     */\n    @Embedded\n    @Basic(fetch = FetchType.LAZY)\n    public byte[] getBinaryData() {\n        if (this.binaryData == null) {\n            return new byte[0];\n        }\n        return binaryData.getActualData();\n    }\n\n    @Embeddable\n    public static class BinaryDataData implements Serializable {\n        @Column(length=32*1024*1024, columnDefinition=\"longblob\", name=\"BINARY_DATA\") @Lob\n        private byte[] actualData;\n\n        public BinaryDataData() { }\n\n        public BinaryDataData(byte[] data) {\n            this.actualData = data;\n        }\n\n        public byte[] getActualData() {\n            if (this.actualData == null) {\n                return new byte[0];\n            }\n            return this.actualData;\n        }\n\n        public void setBinaryData(byte[] newData) {\n            this.actualData = newData;\n        }\n\n        @Override public boolean equals(Object obj) {\n            if (this == obj) {\n                return true;\n            }\n            if (obj == null) {\n                return false;\n            }\n            if (!(obj instanceof BinaryDataData)) {\n                return false;\n            }\n            final BinaryDataData other = (BinaryDataData) obj;\n            if (!Arrays.equals(actualData, other.actualData)) {\n                return false;\n            }\n            return true;\n        }\n    }\n\n    /** onwards... */\n</code></pre>\n\n<p>Unfortunately this doesn't work. The SQL that I'm seeing still shows a complete fetch of the object even if the binary data isn't requested:</p>\n\n<pre><code>select ideaattach0_.BINARY_DATA_ID as BINARY1_9_, ideaattach0_1_.BINARY_DATA as BINARY2_9_, ideaattach0_1_.BINARY_DATA_NAME as BINARY3_9_, ideaattach0_.IDEA_BUCKET_ID as IDEA2_136_ from IDEA_ATTACHMENT ideaattach0_ inner join BINARY_DATA ideaattach0_1_ on ideaattach0_.BINARY_DATA_ID=ideaattach0_1_.BINARY_DATA_ID where ideaattach0_.BINARY_DATA_ID=?\n</code></pre>\n\n<p>Any ideas? Thank you.</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13001461,"title":"How to retrive data in suffled manner using hibernate","body":"<p>Hi I want retrieve data in shuffled manner using hibernate . Suppose that I have five rows of data and when I fire a select query I will get the data but if I fire the same query I should get same data but not in same or as previous result suppose for 1st select I get data in 1,2,3,4 second time I should get like 2,3,5,4,1.</p>\n\n<p>Thanks </p>\n"},{"tags":["java","hibernate","jpa","annotations","jpa-2.0"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":135,"score":0,"question_id":11735501,"title":"JPA mapping annotations for Object type","body":"<p>I will implement an entity class, something like:</p>\n\n<pre><code>@Entity\npublic class XXXEntity {\n     @Id\n     private Long id;\n\n     private Object entity;\n}\n</code></pre>\n\n<p>But I am not sure how to map the Object type field?</p>\n\n<p>Actually, in my project the object types contain several other entities, like A, B, C. (all A,B, and C implement Serilizable interface)</p>\n\n<p>I want to annotate it as @Lob, but I am not sure it is correct? Because Object doesn't implement Serilizable interface.</p>\n\n<p>Any ideas about that? Thanks.</p>\n"},{"tags":["java","hibernate","orm"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":790,"score":1,"question_id":9908082,"title":"Does a Hibernate transaction rollback delete \"session.flush()\"ed entities?","body":"<p>I have been confused about <code>transaction.rollback</code>. Here is example pseudocode: </p>\n\n<pre><code>transaction = session.beginTransaction()    \nEntityA a = new EntityA();    \nsession.save(a);    \nsession.flush();    \ntransaction.rollback();\n</code></pre>\n\n<p>What happens when this code works? Do I have the entity in the database or not?</p>\n"},{"tags":["java","hibernate","relations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":289,"score":1,"question_id":2857979,"title":"How to get Hibernate object relations dynamically?","body":"<p>I'm using Hibernate and I need to find a way of retrieving the relations for an object dynamically at run-time. I can't find this in the API.</p>\n\n<p>Can anyone point me in the right direction please?</p>\n\n<p>Thanks</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13000358,"title":"Using Hibernate to map a class with variable amount of variables","body":"<p>I want to use Hibernate to map a class to a database. The class contains values from different sensors. It is important that the class may be changed at runtime(new sensor added...). Changes of the variables are estimated to be quite rare. Can I use Hibernate in this case?</p>\n\n<p>I thought about using a Hashmap with String Keys representing the Column Header and the Sensorname. The mapped value would be the current Double sensor value.</p>\n\n<p>An example table could look like this:</p>\n\n<pre><code>Table Station1\n-----------------------------------------------------\n+ Timestamp           + Sensor1 + Sensor2 + Sensor3 +\n-----------------------------------------------------\n+ 2012-10-10 12:12:12 + 12.1212 + 23.2323 + 34.3434 +\n+ 2012-10-10 12:12:13 + 12.1213 + 23.2323 + 54.3434 +\n-----------------------------------------------------\n</code></pre>\n\n<p>I would be happy if someone could give me feedback if its possible and maybe some directions for me to search further.</p>\n"},{"tags":["hibernate","hibernate.cfg.xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12677783,"title":"Where to place hibernate.cfg.xml?","body":"<p>My project is like this:</p>\n\n<pre><code>/src/main/java\n     -thegamers\n         -app.java\n         -hibernateutil.java\n</code></pre>\n\n<p>can someone tell me where to put the hibernate.cfg.xml?</p>\n\n<p>because I'm getting this error:</p>\n\n<pre><code>Initial SessionFactory creation failed.org.hibernate.HibernateException: hibernate.cfg.xml not found\nException in thread \"main\" java.lang.ExceptionInInitializerError\n    at thegamers.HibernateUtil.buildSessionFactory(HibernateUtil.java:17)\n    at thegamers.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:8)\n    at thegamers.App.main(App.java:15)\nCaused by: org.hibernate.HibernateException: hibernate.cfg.xml not found\n    at org.hibernate.util.ConfigHelper.getResourceAsStream(ConfigHelper.java:170)\n    at org.hibernate.cfg.Configuration.getConfigurationInputStream(Configuration.java:2149)\n    at org.hibernate.cfg.Configuration.configure(Configuration.java:2130)\n    at thegamers.HibernateUtil.buildSessionFactory(HibernateUtil.java:13)\n    ... 2 more\n</code></pre>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":12999719,"title":"Hibernate relations","body":"<p>I want to query child object while loading, </p>\n\n<p>here is the query i am using : </p>\n\n<pre><code>SELECT app FROM ApplicantPerson app left join app.gpaList gpa , DesignatedSchool ds\nWHERE\n    app.applicantPersonId.applPersonId = ds.applPersonId \n    AND app.appStatusCd = 'P'  and gpa.verifiedInd= 1\n    AND ds.designateStatusCd = 'A' \n    AND ds.medInstId = ?  \n    AND app.applicantPersonId.applYear = ?\n    AND ds.applYear = ?\n</code></pre>\n\n<p>but applicantperson is having 24 records, and child gpalist has 2 records with one verified = 1 and the second is having verified =0 </p>\n\n<p>Note: there is one to many relation between ApplicantPerson and Gpa </p>\n\n<p>But the output of the above query is 30 records and gpalist is getting 2 records. </p>\n\n<p>I need out put with 24 records in parent and child gpalist with one record verified =1 </p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":12998937,"title":"Returning spatial data with Hibernate","body":"<p>I am trying to return spatial data (ie Point) from database using Hibernate Spatial library (http://www.hibernatespatial.org/) using this WORKING approach...</p>\n\n<pre><code>    ... \n    Session session = sessionFactory.openSession();\n    Query query = session.createQuery(\"select location, distance(location, :requestPoint) from \"+Event.class.getName());\n    query.setParameter(\"requestPoint\", requestPoint);\n\n    List&lt;?&gt; rows = query.list();\n    session.close();\n\n    List&lt;Event&gt; events = new ArrayList&lt;Event&gt;();\n\n    for (Iterator&lt;?&gt; it = rows.iterator(); it.hasNext(); ) {\n       Object[] row = (Object[]) it.next();\n\n       Event event = new Event();\n       event.setLocation((Point) row[0]);\n       event.setDistance((Double) row[1]);\n\n       events.add(event);\n    }\n\n    return events;\n</code></pre>\n\n<p>but I would like to use something like this (use Event class constructor in select statment)...</p>\n\n<pre><code>    Session session = sessionFactory.openSession();\n    Query query = session.createQuery(\"select new Event(location, distance(location, :requestPoint)) from \"+Event.class.getName());\n    query.setParameter(\"requestPoint\", requestPoint);\n\n    List&lt;Event&gt; rows = query.list();\n    session.close();\n\n    return rows;\n</code></pre>\n\n<p>The problem is that the second approach gives me following exception...</p>\n\n<pre><code>org.hibernate.hql.internal.ast.QuerySyntaxException: Unable to locate appropriate constructor on class [com.jaygridley.aet.Event] [select new Event(location, distance(location, :requestPoint)) from com.jaygridley.aet.domain.Event]\n</code></pre>\n\n<p>but I cannot see why, because inside of my Event class I have a constructor...</p>\n\n<pre><code>public Event(Point location, Double distance) {\n    this.location = location;\n    this.distance = distance;\n}\n</code></pre>\n\n<p>for clarity Event class has following properties...</p>\n\n<pre><code>@Column(name=\"LOCATION\", columnDefinition = \"MDSYS.SDO_GEOMETRY\", nullable = false)\n@Type(type = \"org.hibernate.spatial.GeometryType\")\nprivate Point location;\n\nprivate Double distance;\n</code></pre>\n\n<p>I have checked return class for each column that Hibernate returns and it matches Point and Double. Does anyone has any idea what I am doing wrong? Thanks you!</p>\n"},{"tags":["hibernate","jpa","spring-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12998157,"title":"ManyToOne and retrieving and inserting id only in Spring JPA Hibernate Annotation?","body":"<p>There are First Name, Last Name, Phone No, City_ID, Country_ID columns in my Person table. </p>\n\n<p>In the list page, I need to show First Name, Last Name, City Name in each line and when I save, I only need to choose City_ID from the dropdown list.</p>\n\n<p>I want to use Annotation and save into the table.</p>\n\n<p>Currently I use below code in Person.java file. But it is saving city_id in City table instead of saving into Person table. </p>\n\n<pre><code>   @ManyToOne\n    @JoinColumn(name=\"city_id\", insertable = true, updatable = true)\n    private City city;\n</code></pre>\n\n<p>If my way of approach is wrong, which way can I use for above case?</p>\n\n<p>Could you help me? I am facing this problem nearly two weeks and still cannot solve.</p>\n\n<p>Thank you.</p>\n\n<p>Update :\nPerson.java</p>\n\n<pre><code>@Entity\n@Table(name=\"person\")\npublic class Person {\n        @Id\n    @GeneratedValue(strategy=GenerationType.IDENTITY)\n    @Column(name = \"id\")\n    private Integer id;\n    @Column(name = \"first_name\")\n    private String firstName;\n    @Column(name = \"last_name\")\n    private String lastName;\n    @Column(name = \"phone_no\")\n    private String phoneNo;\n        @ManyToOne\n        @JoinColumn(name=\"city\", insertable = true, updatable = true)\n        private City cityobj;\n    //need to add below line also to save city id in Person table     \n    @Column(name = \"city\")\n    private String city;\n        @ManyToOne\n        @JoinColumn(name=\"country\", insertable = true, updatable = true)\n        private Country countryobj;\n    @Column(name = \"country\")\n    private String country;\n        //// getter and setter\n\n}\n</code></pre>\n\n<p>City.java</p>\n\n<pre><code>@Entity\n@Table(name=\"cdd_status\")\npublic class CddStatus {\n    @Id\n    @GeneratedValue(strategy=GenerationType.IDENTITY)\n    @Column(name = \"id\")\n    private Integer id;\n    @Column(name = \"city_name\")\n    private String cityName;\n}\n</code></pre>\n\n<p>PersonDAOImpl.java</p>\n\n<pre><code>@Repository\npublic class PersonDAOImpl implements PersonDAO {\n  @Transactional\n    public void createPerson(Person perso) {\n        try{\n        sessionFactory.getCurrentSession().save(perso);\n        }catch(HibernateException e)\n        {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n\n<p>listperson.jsp</p>\n\n<pre><code>&lt;tbody&gt;\n           &lt;c:if test=\"${! empty listPerson}\"&gt;\n          &lt;c:forEach items=\"${listPerson}\" var=\"person\"&gt; \n             &lt;tr&gt;\n            &lt;td&gt;&lt;c:out value=\"${person.companyName}\"&gt;&lt;/c:out&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;c:out value=\"${person.companyId}\"/&gt;&lt;/td&gt;\n            &lt;td&gt;\n                &lt;c:out value=\"${person.city.cityName}\"/&gt;\n            &lt;/td&gt;\n            &lt;td&gt;\n                &lt;c:out value=\"${person.country.countryName}\"/&gt;\n            &lt;/td&gt;\n            &lt;td&gt;\n                 &lt;a href=\"&lt;c:url value=\"updatePerson.do?id=${person.id}\" /&gt;\"&gt;&lt;i class=\"icon-pencil\"&gt;&lt;/i&gt;&lt;/a&gt;\n            &lt;/td&gt;\n\n&lt;/tr&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>newPerson.jsp</p>\n\n<pre><code>&lt;form:form cssClass=\"form-horizontal\" method=\"post\" commandName=\"newperson\"&gt;\nFirst Name : &lt;form:input path=\"firstName\" cssClass=\"span2/&gt;&lt;br /&gt;\nLast Name : &lt;form:input path=\"lastName\" cssClass=\"span2/&gt;&lt;br /&gt;\nPhone No : &lt;form:input path=\"phoneNo\" cssClass=\"span2/&gt;&lt;br /&gt;\nCity : &lt;spring:bind path=\"newperson.city.cityName\"&gt;\n    &lt;form:select path=\"${status.expression}\" cssClass=\"span2\" &gt;\n         &lt;form:options items=\"${cityList}\" itemValue=\"id\" itemLabel=\"status\" /&gt;\n        &lt;/form:select&gt;\n         &lt;form:errors path=\"${status.expression}\" value=\"${status.errorMessage}\" cssClass=\"alert-error\" /&gt;\nCity : &lt;spring:bind path=\"newperson.country.countryName\"&gt;\n    &lt;form:select path=\"${status.expression}\" cssClass=\"span2\" &gt;\n         &lt;form:options items=\"${cityList}\" itemValue=\"id\" itemLabel=\"status\" /&gt;\n        &lt;/form:select&gt;\n         &lt;form:errors path=\"${status.expression}\" value=\"${status.errorMessage}\" cssClass=\"alert-error\" /&gt; \n        &lt;/spring:bind&gt;\n&lt;input name=\"btnSave\" type=\"submit\" class=\"btn btn-primary\" value=\"Save\"&gt;\n&lt;/form:form&gt;\n</code></pre>\n\n<p>PersonController.java</p>\n\n<pre><code>@RequestMapping(value=\"/addPerson\", method=RequestMethod.POST)\n public String createCompanyProfile(@ModelAttribute(\"newperson\")Person person, BindingResult result, SessionStatus status,HttpSession session)\n {\n    validator.validate(person, result);\n    if (result.hasErrors())\n    {   \n       return \"newperson\";\n    }\n       personDao.createPerson(person);\n       status.setComplete();\n\n       return \"redirect:listPerson.do\";\n }\n</code></pre>\n"},{"tags":["java","spring","hibernate","intellij-idea"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12998450,"title":"Basic attribute type should not be IDao - intellij message","body":"<p>I am receiving the following message in my Entity object ?</p>\n\n<blockquote>\n  <p>Basic attribute type should not be IDao</p>\n</blockquote>\n\n<p>Where it is being used like this :</p>\n\n<pre><code>@Entity\n@Table\npublic final class MyEnity {\n\n    @Resource(name = \"Dao\")\n    private IDao dao;\n</code></pre>\n\n<p>I know the name is bad, but what is the problem with injecting my Dao(annotated with repository) into my Domain object that is annotated as a hibernate entity ? And IDao is an interface implemented by Dao class ... </p>\n"},{"tags":["java","mysql","hibernate","spring-mvc","transactions"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12997580,"title":"How to use Spring, Hibernate, MySQL ISAM with transactions?","body":"<p>I am using Hibernate and Spring on a small personal project. Well, still a newbie in this area, so would like to raise some basic questions re transactions. </p>\n\n<ul>\n<li><p>It seems that I have to declare transactional manager and annotate the DAO class as \n@Transactional(propagation = Propagation.REQUIRED, readOnly = false). Otherwise i get some strange exceptions or the entities are not saved in the database. Is there actually a must to use transactions? Can't i save data in the database without using them (i thought that MySQL ISAM tables don't support transactions), how would you use them then? </p></li>\n<li><p>What is the best place to put the @Transactional attribute on? Currently its declared on my generic HibernateDAO superclass, possibly the deepest level it can be. I guess that's not the best place for that. But if moving it up, I would wind up having it in the Spring MVC Controller, which is arguably also inappropriate place for that. So far there is no other service layer, because i do nothing except for saving and serving words and definitions from the database. </p></li>\n</ul>\n\n<p>Many thanks</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":12996686,"title":"How to customize the automatically generated schema (or to override the Table class)?","body":"<p>I use Hibernate's automatic schema generation in some tests, but it generates random names for FK constrains and no name for other constraints at all. This makes SQL exceptions a bit difficult to understand.</p>\n\n<p>I am wondering is there any way to customize the output? I have already checked Dialect and the NamingStrategy, but constraint names are not generated by these. The source code of Table reveals that the format is hard-coded, so it seems I'll have to override Table. However, the Table class is also hard-coded in many places, so this seems to be very difficult. I can run loads of reg ex on the output to add the names in, but I'd really like to do it from the source.</p>\n\n<p>I am using Hibernate 3.6.</p>\n"},{"tags":["java","hibernate","log4j"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12995303,"title":"hibernate.cfg.xml not found exception, was working with configure() yesterday","body":"<p>Loading a hibernate based runnable jar on ec2, I am suddenly getting a hibernate.cfg.xml not found exception.</p>\n\n<pre><code>233  [main] FATAL com.mcruiseon.server.hibernate.ReadOnlyOperations  - Unable to create SessionFactory for Hibernate\n233  [main] FATAL com.mcruiseon.server.hibernate.ReadOnlyOperations  - ./hibernate.cfg.xml not found\n234  [main] FATAL com.mcruiseon.server.hibernate.ReadOnlyOperations  - org.hibernate.HibernateException: ./hibernate.cfg.xml not found\norg.hibernate.HibernateException: ./hibernate.cfg.xml not found\n    at org.hibernate.internal.util.ConfigHelper.getResourceAsStream(ConfigHelper.java:173)\n    at org.hibernate.cfg.Configuration.getConfigurationInputStream(Configuration.java:1929)\n    at org.hibernate.cfg.Configuration.configure(Configuration.java:1910)\n</code></pre>\n\n<p>Here is a snapshot of the folder containing the cfg.xml file.\n<img src=\"http://i.stack.imgur.com/MbpEJ.png\" alt=\"enter image description here\"></p>\n\n<p>I am trying to initialize hibernate using the following code snippet. It was working with just <code>configure()</code>, for some reason it just stopped working.</p>\n\n<pre><code>Configuration configuration = new Configuration().configure(\"./hibernate.cfg.xml\");\nsessionFactory = configuration.buildSessionFactory(new ServiceRegistryBuilder().buildServiceRegistry());\n</code></pre>\n\n<p>Edit : Even worse, I started getting a log4j issue now. I am just having a bad day.</p>\n\n<pre><code>INFO net.spy.memcached.MemcachedConnection:  Connection state changed for sun.nio.ch.SelectionKeyImpl@480457\nException in thread \"main\" java.lang.NoSuchFieldError: TRACE\n    at org.jboss.logging.Log4jLogger.translate(Log4jLogger.java:58)\n    at org.jboss.logging.Log4jLogger.isEnabled(Log4jLogger.java:39)\n    at org.jboss.logging.Logger.tracev(Logger.java:197)\n</code></pre>\n"},{"tags":["nhibernate","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":5983,"score":4,"question_id":887474,"title":"NHibernate property formula filter","body":"<p>I have a following class:</p>\n\n<pre><code>MyClass\npublic virtual int Id { get; set; }\npublic virtual int Code { get; set; }\npublic virtual int Description { get; set; }\npublic virtual int Name { get; set; }\n</code></pre>\n\n<p>with the following mapping:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;hibernate-mapping xmlns=\"urn:nhibernate-mapping-2.2\" namespace=\"TestApplication\" assembly=\"TestApplication\"&gt;\n  &lt;class name=\"MyClass\" table=\"MyTable\"&gt;\n    &lt;id name=\"Id\" column=\"id\"&gt;\n      &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n\n    &lt;property name=\"Code\" column=\"code\"/&gt;\n    &lt;property name=\"Description\" column=\"description\"/&gt;\n    &lt;property name=\"Name\" formula=\"(SELECT b.translation FROM translations b WHERE b.translation_id = translation_id AND b.language_id = :TranslationFilter.LanguageId)\"/&gt;\n  &lt;/class&gt;\n\n  &lt;filter-def name=\"TranslationFilter\"&gt;\n    &lt;filter-param name=\"LanguageId\" type=\"Int32\"/&gt;\n  &lt;/filter-def&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>I'm trying to load entity through spring with:</p>\n\n<pre><code>Session.EnableFilter(\"TranslationFilter\").SetParameter(\"LanguageId\", 1);\nreturn Session.Get&lt;MyClass&gt;(1);\n</code></pre>\n\n<p>but I'am getting adoexception. I see (in a profiler) that variable :TranslationFilter.LanguageId is not replaced with ? and that parameter value is not send to the server?</p>\n\n<p>Is it this possible (to have filters in formula) and how?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["java","hibernate","hibernate-criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":141,"score":1,"question_id":8074916,"title":"Hibernate generate count(1)","body":"<p>By default when do count with hibernate, it will generate count(*) , is it possible to change it so that the default become count(1)  ? i do not want to use HQL to do this.  I mean when using         <code>criteria.setProjection(Projections.rowCount());</code></p>\n"},{"tags":["java","hibernate","spring-mvc","hibernate-annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":10048037,"title":"Hibernate enableFetchProfile -> unknow","body":"<p>I want to use a FetchProfile with my DAO for the entity Example.</p>\n\n<p>This is the annotation on my entity :</p>\n\n<pre><code>@FetchProfiles({ @FetchProfile(name = \"example-profile\", fetchOverrides = {\n    @FetchProfile.FetchOverride(entity = Example.class, association = \"association1\", mode = FetchMode.JOIN),\n    @FetchProfile.FetchOverride(entity = Example.class, association = \"association2\", mode = FetchMode.JOIN) }) \n})\n</code></pre>\n\n<p>This is my DAO :</p>\n\n<pre><code>    @Autowired\nprivate SessionFactory sessionFactory;\n\npublic Example getExample(Long id) {\n    sessionFactory.getCurrentSession().enableFetchProfile(\"example-profile\");\n    return (Example) sessionFactory.getCurrentSession().get(Example.class, id);\n}\n</code></pre>\n\n<p>When i call getExample, i got this exception :</p>\n\n<pre><code>org.hibernate.UnknownProfileException: Unknow fetch profile [example-profile]\n</code></pre>\n\n<p>Anyone know how to resolve this ? Am i missing mapping or something ?</p>\n\n<p>Thx !</p>\n"},{"tags":["java","spring","hibernate","jpa","tomcat7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":164,"score":0,"question_id":12717895,"title":"Memory Leak on stop or redeploy - Spring 3.1.2, Hibernate 4.1.0, Spring Data-Jpa 1.1.0, Tomcat 7.0.30","body":"<h1>Problem</h1>\n\n<p>The application has no issues running for days on end on the production server, but when I perform a deploy for updates, the Tomcat Manager program will complain about leaks (if I click find leaks). If I perform 6-10 deploys, eventually Tomcat runs out of memory with a PermGen memory error and I need to restart the Tomcat service and everything returns to normal.</p>\n\n<p>When I run/debug the application locally and perform some actions that require access through Jpa/Hibernate (ie, I login or request a List from a JpaRepository) and then shutdown the application, I receive the following messages in my debug output from Tomcat:</p>\n\n<blockquote>\n  <p>Oct 03, 2012 2:55:13 PM org.apache.catalina.loader.WebappClassLoader\n  checkThreadLocalMapForLeaks SEVERE: The web application [/]\n  created a ThreadLocal with key of type\n  [org.springframework.core.NamedThreadLocal] (value [Transactional\n  resources]) and a value of type [java.util.HashMap] (value [{public\n  abstract java.lang.Object\n  org.springframework.data.repository.CrudRepository.findOne(java.io.Serializable)=java.lang.Object@842e211}])\n  but failed to remove it when the web application was stopped. Threads\n  are going to be renewed over time to try and avoid a probable memory\n  leak. </p>\n  \n  <p>Oct 03, 2012 2:55:13 PM\n  org.apache.catalina.loader.WebappClassLoader\n  checkThreadLocalMapForLeaks SEVERE: The web application [/]\n  created a ThreadLocal with key of type\n  [org.springframework.core.NamedThreadLocal] (value [Transactional\n  resources]) and a value of type [java.util.HashMap] (value [{public\n  abstract java.util.List\n  org.springframework.data.jpa.repository.JpaRepository.findAll()=java.lang.Object@842e211}])\n  but failed to remove it when the web application was stopped. Threads\n  are going to be renewed over time to try and avoid a probable memory\n  leak. </p>\n  \n  <p>Oct 03, 2012 2:55:13 PM\n  org.apache.catalina.loader.WebappClassLoader\n  checkThreadLocalMapForLeaks SEVERE: The web application [/]\n  created a ThreadLocal with key of type\n  [org.springframework.core.NamedThreadLocal] (value [Transactional\n  resources]) and a value of type [java.util.HashMap] (value [{public\n  abstract java.lang.Iterable\n  org.springframework.data.querydsl.QueryDslPredicateExecutor.findAll(com.mysema.query.types.Predicate)=java.lang.Object@842e211}])\n  but failed to remove it when the web application was stopped. Threads\n  are going to be renewed over time to try and avoid a probable memory\n  leak. </p>\n  \n  <p>Oct 03, 2012 2:55:13 PM\n  org.apache.catalina.loader.WebappClassLoader\n  checkThreadLocalMapForLeaks SEVERE: The web application [/]\n  created a ThreadLocal with key of type\n  [org.springframework.core.NamedThreadLocal] (value [Transactional\n  resources]) and a value of type [java.util.HashMap] (value [{public\n  abstract data.domain.UserAccount\n  UserAccountRepository.findByUserName(java.lang.String)=java.lang.Object@842e211}])\n  but failed to remove it when the web application was stopped. Threads\n  are going to be renewed over time to try and avoid a probable memory\n  leak.</p>\n</blockquote>\n\n<p>etc, etc.</p>\n\n<h1>Configuration</h1>\n\n<p>Spring is configured via annotations and I'm also using Postgres 8.4 as the database backend.</p>\n\n<p>JPA is configured via annotations (jpa-repository-context.xml just says to look for this class):</p>\n\n<pre><code>@Configuration\n@EnableTransactionManagement\n@ImportResource( \"classpath*:*jpa-repository-context.xml\" )\n@ComponentScan( basePackages = { \"data.repository\" } )\npublic class PersistenceJpaConfig\n{\n    @Bean\n        public LocalContainerEntityManagerFactoryBean entityManagerFactory()\n        {\n            LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();\n            factoryBean.setDataSource( dataSource() );\n            factoryBean.setPackagesToScan( new String[] { \"data.domain\" } );\n\n            // Setup vendor specific information. This will depend on the chosen DatabaseType\n            HibernateJpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter();\n            vendorAdapter.setGenerateDdl( true );\n            vendorAdapter.setShowSql( false );\n            vendorAdapter.setDatabasePlatform( \"org.hibernate.dialect.PostgreSQL82Dialect\" );\n\n            factoryBean.setJpaVendorAdapter( vendorAdapter );\n\n            Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();\n            properties.put( \"hibernate.ejb.naming_strategy\", \"org.hibernate.cfg.ImprovedNamingStrategy\" );\n\n            factoryBean.setJpaPropertyMap( properties );\n\n            return  factoryBean;\n        }\n\n        @Bean\n        public DataSource dataSource()\n        {\n            JndiDataSourceLookup lookup = new JndiDataSourceLookup();\n            DataSource dataSource;\n\n            dataSource = lookup.getDataSource( \"java:comp/env/jdbc/postgres\" );\n\n\n            return dataSource;\n        }\n\n        @Bean\n        public PlatformTransactionManager transactionManager()\n        {\n            JpaTransactionManager transactionManager = new JpaTransactionManager();\n            transactionManager.setEntityManagerFactory( entityManagerFactory().getObject() );\n\n            return transactionManager;\n        }\n}\n</code></pre>\n\n<p>Example Repository:</p>\n\n<pre><code>public interface UserAccountRepository extends JpaRepository&lt;UserAccount, Long&gt;, QueryDslPredicateExecutor&lt;UserAccount&gt; {\n}\n</code></pre>\n\n<p>All of my Repositories are accessed through a Service class which is registered as an @Component in Spring. This is done to remove repository access from Spring controllers:</p>\n\n<pre><code>@Component\npublic class UserAccountService {\n\n    @Autowired\n    private UserAccountRepository userAccountRepository;\n\n    public List&lt;UserAccount&gt; getUserAccounts() {\n        return userAccountRepository.findAll();\n    }\n    ...\n}\n</code></pre>\n\n<p>And here are the versions for the various components in use in Maven's pom.xml:</p>\n\n<pre><code>&lt;properties&gt;\n        &lt;!-- Persistence and Validation--&gt;\n        &lt;hibernate.version&gt;4.1.0.Final&lt;/hibernate.version&gt;\n        &lt;hibernate.jpa.version&gt;1.0.1.Final&lt;/hibernate.jpa.version&gt;\n        &lt;javax.validation.version&gt;1.0.0.GA&lt;/javax.validation.version&gt;\n        &lt;querydsl.version&gt;2.2.5&lt;/querydsl.version&gt;\n        &lt;spring.jpa.version&gt;1.1.0.RELEASE&lt;/spring.jpa.version&gt;\n\n        &lt;!-- Spring and Logging --&gt;\n        &lt;spring.version&gt;3.1.2.RELEASE&lt;/spring.version&gt;\n        &lt;spring.security.version&gt;3.1.2.RELEASE&lt;/spring.security.version&gt;\n        &lt;slf4j.version&gt;1.6.4&lt;/slf4j.version&gt;\n        &lt;jackson.version&gt;1.9.9&lt;/jackson.version&gt;\n\n        &lt;!-- Testing Suites --&gt;\n        &lt;selenium.version&gt;2.24.1&lt;/selenium.version&gt;\n&lt;/properties&gt;\n</code></pre>\n\n<h1>Questions</h1>\n\n<ol>\n<li>What is causing the memory leak and how do I fix it? </li>\n<li>How would I go about debugging this particular issue?</li>\n<li>Is there anything in my configuration set that could be improved?</li>\n</ol>\n\n<p>I have really run out of ideas on solving this problem.</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12994001,"title":"Hibernate runs all tables for to do simple login","body":"<p>I have done some maintenances in a web system, this system was done in Java, Struts2 and Hibernate 3. One of items that my customer asked me urgently was to correct the Login, because it was very slow.</p>\n\n<p>I could identify that when the user do the login, the Hibernate generate a lot of queries on the database in differents tables that don't have relation with login.</p>\n\n<p>My relationship are three tables: User, Student, Teacher</p>\n\n<p>Student</p>\n\n<ul>\n<li>ID</li>\n<li>Name</li>\n</ul>\n\n<p>Teacher</p>\n\n<ul>\n<li>ID</li>\n<li>Name</li>\n</ul>\n\n<p>User</p>\n\n<ul>\n<li>ID</li>\n<li>Login</li>\n<li>Password</li>\n</ul>\n\n<p>Every time that a student do a login, the query check if it have correct Login and Password and if it (ID) there is in Student table. How you can see there is not a foreign key ID like for example, ID_USER in Student table.</p>\n\n<p>My Query:</p>\n\n<pre><code>Student student =(Student)session.createCriteria(Student.class)\n.add( Property.forName(\"login\").eq(login) )\n.add( Property.forName(\"password\").eq(password) )\n.setMaxResults(1)\n.uniqueResult();\n</code></pre>\n\n<ul>\n<li>Student inherits from User...</li>\n</ul>\n\n<p>My User.hbm.xml</p>\n\n<p>...</p>\n\n<pre><code>&lt;class name=\"com.xxx.User\" table=\"TBL_USERS\" discriminator-value=\"0\" lazy=\"true\"&gt;\n    &lt;id name=\"id\" column=\"ID\"&gt;\n     &lt;generator class=\"sequence\"&gt;\n         &lt;param name=\"sequence\"&gt;seq_users&lt;/param&gt;\n     &lt;/generator&gt;\n    &lt;/id&gt;\n\n    &lt;discriminator column=\"TYPE\" insert=\"true\" /&gt;\n\n    &lt;subclass name=\"com.xxx.Student\" discriminator-value=\"1\" lazy=\"true\"&gt;\n      &lt;join table=\"TBL_STUDENTS\"&gt;\n         &lt;key column=\"ID\"/&gt;\n            &lt;property name=\"name\" column=\"NAME\"/&gt;\n      &lt;/join&gt;\n     &lt;/subclass&gt;\n\n     &lt;subclass name=\"com.xxx.Teacher\" discriminator-value=\"2\" lazy=\"true\"&gt;\n        &lt;join table=\"TBL_TEACHERS\"&gt;\n           &lt;key column=\"ID\" /&gt;\n               &lt;property name=\"name\" column=\"NAME\"  /&gt;\n        &lt;/join&gt;\n     &lt;/subclass&gt;\n</code></pre>\n\n<p>...</p>\n\n<p>In my Hibernate log a lot of stranger queries, like bellow:</p>\n\n<p>It's happening in more than 20 differents tables and repete any times, because that, the login is slow. But I don't know why it's happening, I don't have much experience with Hibernate.</p>\n\n<p>Hibernate:</p>\n\n<pre><code>select\n      exerc0_.ID_CLASS as ID6_1_,\n      exerc0_.ID as ID1_,\n      exerc0_.ID as ID14_0_,\n      exerc0_.DATE_ENT as DATA2_14_0_,\n        exerc0_.TITLE as TITTLE14_0_,\n        exerc0_.TEXT as TEXT14_0_,\n        exerc0_.TYPE_EXERC as TYPE5_14_0_,\n        exerc0_.ID_CLASS as ID6_14_0_ \n    from\n        TBL_EXERC exerc0_ \n    where\n        exerc0_.ID_CLASS=?\n</code></pre>\n\n<p>What can is happening?</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","xml","hibernate","xml-parsing"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12911166,"title":"xml mapping error","body":"<p>i am working on project , in that there is one xml file (IDE Eclipse Indigo).\nI am facing a problem with sincle line</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;BookingConfirmRQ xmlns=\"http://www.expediaconnect.com/EQC/BC/2007/09\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n&lt;Authentication username=\"yyyyyyyy\" password=\"xxxxxxxx\" /&gt;\n&lt;Hotel id=\"&lt;hotelId/&gt;\" /&gt;\n&lt;BookingConfirmNumbers&gt;\n    &lt;BookingConfirmNumber bookingID=\"&lt;bookindId/&gt;\"\n        bookingType=\"&lt;bookingType/&gt;\" confirmNumber=\"&lt;confirmNumber/&gt;\"\n        confirmTime=\"&lt;confirmTime/&gt;\" /&gt;\n&lt;/BookingConfirmNumbers&gt;\n&lt;/BookingConfirmRQ&gt;\n</code></pre>\n\n<p>Here near <em>&lt; Hotel id=\"&lt; hotelId/>\"/></em> am getting error like_</p>\n\n<p><em>The value of attribute \"id\" associated with an element type \"Hotel\" must not contain the '&lt;' character.</em></p>\n\n<p>i search it , checked jar's, reformatted still getting error, can sombody help me?\nthank u.</p>\n"},{"tags":["java","hibernate","list","collections"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":367,"score":4,"question_id":3849662,"title":"Can i use a set or List in this example?","body":"<pre><code>public class Student implements java.io.Serializable {\n\nprivate long studentId;\nprivate String studentName;\nprivate Set&lt;Course&gt; courses = new HashSet&lt;Course&gt;(0);\n\npublic Student() {\n}\n\npublic Student(String studentName) {\n    this.studentName = studentName;\n}\n\npublic Student(String studentName, Set&lt;Course&gt; courses) {\n    this.studentName = studentName;\n    this.courses = courses;\n}\n\npublic long getStudentId() {\n    return this.studentId;\n}\n\npublic void setStudentId(long studentId) {\n    this.studentId = studentId;\n}\n\npublic String getStudentName() {\n    return this.studentName;\n}\n\npublic void setStudentName(String studentName) {\n    this.studentName = studentName;\n}\n\npublic Set&lt;Course&gt; getCourses() {\n    return this.courses;\n}\n\npublic void setCourses(Set&lt;Course&gt; courses) {\n    this.courses = courses;\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Here they are using Hashset to get the courses. My doubt is can i use a list to get the\ncourses here. I read in internet that list get the vaues in a specified order and allows\nduplicates inside the list. whereas in set it doesnt have any order and wont allow\nduplicates. I want to know where i should uses sets and lists? Can anyone suggest?</p>\n"},{"tags":["java","spring","hibernate","bean-validation"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":12986030,"title":"Hibernate Validator not invoked on Object Graph","body":"<p>I have a model object which has entities annotated with hibernate validation annotations. For example @NotBlank, @NotNull, @Length.\nI have a form backing this model which decorates an instance of the model object. I have annotated this instance with an @NotNull, @Valid annotation. I am registering a validator for this backing form in the Controller Class and the form validator is being invoked when the @RequestMapping method argument is annotated with @Valid annotation.</p>\n\n<p>Note the model is also annotated with the @Entity annotation, the model backing form is just \na thin wrapper around the model.</p>\n\n<p>However the validations on the decorated object are not being checked? I know this because in the request mapping method definition I check the BindResult for errors and there are none.\nMy form fields are all empty, hence the validations on the fields on the decorated model annotated with @NotBlank should be checked. However that does not happen.</p>\n\n<p>Can you help me fix this?</p>\n\n<p>Edit:\nSample Code</p>\n\n<pre><code>@Entity\nclass MyModel {\n    @Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(nullable=false)\n    private Long id;\n\n    @NotBlank\n    @Column(unique=true, length=30, nullable=false)\n    private String number;\n\n    @Column(length=30, nullable=false)\n    @Length(min=1, max=30)\nprivate String firstName;\n    /* ... getters and setters ... */\n}\n\npublic class MyModelBackingForm {\n\n   @NotNull\n   @Valid\n   private MyModel model;\n   /* ... delegate getters and setters for all fields in MyModel ...  */\n }\n</code></pre>\n\n<p>Edit:\nAdd Controller Code</p>\n\n<pre><code>@InitBinder\nprotected void initBinder(WebDataBinder binder) {\n  binder.setValidator(new MyBackingFormValidator());\n}\n</code></pre>\n\n<p>Edit:</p>\n\n<pre><code>public class MyBackingFormValidator implements Validator {\n\n  public MyBackingFormValidator() {\n    super();\n  }\n\n  @Override\n  public boolean supports(Class&lt;?&gt; clazz) {\n    return Arrays.asList(MyBackingForm.class, MyModel.class).contains(clazz);\n  }\n\n  @Override\n  public void validate(Object obj, Errors errors) {\n   // custom validation code commented ... as I want to check if JSR 303 validations invoked\n  }\n}\n</code></pre>\n"},{"tags":["java","hibernate","dao"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12790991,"title":"hibernate gives two rows the same instead of two distinct rows","body":"<p>I have a user dao</p>\n\n<pre><code>@Entity\n@Table(name=\"EBIGUSERTIM\")\npublic class EbigUser {\n\n\nprivate String id;\nprivate Integer source;\nprivate String entryscheme;\nprivate String fullName;\nprivate String email;\n\nprivate Long flags;\nprivate String status;\nprivate String createdBy;\nprivate Date createdStamp;\nprivate String modifiedBy;\nprivate Date modifiedStamp;\n\n@Id\n@Column(name=\"ID\")\npublic String getId() {\n    return id;\n}\npublic void setId(String id) {\n    this.id = id;\n}\n@Id\n@Column(name=\"SOURCE\")\npublic Integer getSource() {\n    return source;\n}\npublic void setSource(Integer source) {\n    this.source = source;\n}\n@Column(name=\"ENTRYSCHEME\")\npublic String getEntryscheme() {\n    return entryscheme;\n}\npublic void setEntryscheme(String entryscheme) {\n    this.entryscheme = entryscheme;\n}\n@Column(name=\"FULLNAME\")\npublic String getFullName() {\n    return fullName;\n}\npublic void setFullName(String fullName) {\n    this.fullName = fullName;\n}\n@Column(name=\"EMAIL\")\npublic String getEmail() {\n    return email;\n}\npublic void setEmail(String email) {\n    this.email = email;\n}\n@Column(name=\"FLAGS\")\npublic Long getFlags() {\n    return flags;\n}\npublic void setFlags(Long flags) {\n    this.flags = flags;\n}\n@Column(name=\"STATUS\")\npublic String getStatus() {\n    return status;\n}\npublic void setStatus(String status) {\n    this.status = status;\n}\n@Column(name=\"CREATEDBY\")\npublic String getCreatedBy() {\n    return createdBy;\n}\npublic void setCreatedBy(String createdBy) {\n    this.createdBy = createdBy;\n}\n@Column(name=\"CREATEDSTAMP\")\npublic Date getCreatedStamp() {\n    return createdStamp;\n}\npublic void setCreatedStamp(Date createdStamp) {\n    this.createdStamp = createdStamp;\n}\n@Column(name=\"MODIFIEDBY\")\npublic String getModifiedBy() {\n    return modifiedBy;\n}\npublic void setModifiedBy(String modifiedBy) {\n    this.modifiedBy = modifiedBy;\n}\n@Column(name=\"MODIFIEDSTAMP\")\npublic Date getModifiedStamp() {\n    return modifiedStamp;\n}\npublic void setModifiedStamp(Date modifiedStamp) {\n    this.modifiedStamp = modifiedStamp;\n}\n</code></pre>\n\n<p>i am selecting 2 rows out of the db. The sql works</p>\n\n<pre><code>select * from ebigusertim where id='blah'\n</code></pre>\n\n<p>It returns 2 distinct rows. When i query the data using hibernate, it appears that the object memory is not being allocated for each entry in the list. Thus, i get 2 entries in the list with the same object.</p>\n\n<pre><code>        Criteria userCriteria = session.createCriteria(EbigUser.class);\n        userCriteria.add(Restrictions.eq(\"id\", id));\n        userlist = userCriteria.list();\n</code></pre>\n"},{"tags":["hibernate","design-patterns","dao","separation-of-concerns"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12990791,"title":"Hibernate collection mapping: a really good separation of concern?","body":"<p>I'm new to Hibernate ORM and I think you can help me understand it better. More precisely, I found myself thinking if the separation of concern is very well implemented (of course it is, it's me I can't grasp... but please explain me). Let me explain: it seems to me that the main goal of hibernate is to allow developer to deal with classes forgetting about databases' peculiarities. Good!\nBut let's examine this case:</p>\n\n<p>I have an object, let's say a UserDetail having a one to may relation with an Athority object.</p>\n\n<pre><code>@Entity(name=\"user\")\n@Table(name=\"USERS\")\npublic class User implements UserDetails, DomainObject {\n\nprivate static final long serialVersionUID = 1L;\nprivate long id;\nprivate String username;\nprivate String password;\nCollection&lt;Authority&gt; authorities = new ArrayList&lt;Authority&gt;();\n\npublic User() {\n    super();\n}\n\n\n@Id\n@GeneratedValue(strategy=GenerationType.AUTO)\n@Column(name=\"id\", unique=true, nullable=false)\npublic long getId() {\n    return id;\n}\n\n//various getters &amp; setters\n\n@OneToMany(mappedBy=\"user\")\npublic Collection&lt;Authority&gt; getAuthorities() {\n    return authorities;\n}\n\npublic void setAuthorities(Collection&lt;Authority&gt; authorities) {\n    this.authorities = authorities;\n}       \n}\n</code></pre>\n\n<p>here's the Authority object</p>\n\n<pre><code>@Entity(name=\"authority\")\n@Table(name=\"AUTHORITIES\")\npublic class Authority implements GrantedAuthority, DomainObject{\n\nprivate long id;\nprivate User user;\nprivate String authority;  //Spring Security demands them to start with \"ROLE_\"\n\npublic Authority() {\n    super();\n}\n\n\n@Id\n@GeneratedValue(strategy=GenerationType.AUTO)\n@Column(name=\"id\", unique=true, nullable=false)\npublic long getId() {\n    return id;\n}\n\npublic void setId(long id) {\n    this.id = id;\n}\n\n@ManyToOne\npublic User getUser() {\n    return user;\n}\n\npublic void setUser(User user) {\n    this.user = user;\n}\n\n@Column(name=\"authority\", nullable=false)\npublic String getAuthority() {\n    return this.authority;\n}\n\npublic void setAuthority(String authority) {\n    this.authority = authority;\n}\n\n}\n</code></pre>\n\n<p>ok, let's suppose I have a UserDaoImpl and AuthorityDaoImpl (here omitted for brevity). If I want to create a new UserDetails and persist it I have to do the following (it is a inizializer bean, but it really doesn't matter here):</p>\n\n<pre><code>@Component\npublic class Initializer {\n\n    @Autowired\n    @Qualifier(\"userDaoImpl\")\n    private UserDao userDao;\n    @Autowired\n    @Qualifier(\"authorityDaoImpl\")\n    private AuthorityDao authorityDao;\n\n    @PostConstruct\n    public void init()\n    {\n        if(userDao.loadUserByUsername(\"admin\")==null)\n        {\n            System.out.println(\"starting initialization.\");\n            User admin = new User();\n            admin.setUsername(\"admin\");\n            admin.setPassword(\"admin\");\n\n            Authority authority = new Authority();\n            authority.setAuthority(\"ROLE_ADMIN\");\n            authority.setUser(admin);\n\n            admin.getAuthorities().add(authority);\n\n            userDao.save(admin);\n            authorityDao.save(authority);\n            System.out.println(\"admin user created.\");\n        }\n\n    }\n}\n</code></pre>\n\n<p>ok, I find strange I have to explicitly call the AuthorityDao to persist the Authority Object. If the separation of concern was well implemented I'd just had to add the <code>authority</code> object to the <code>admin</code> autority list and persist the admin alone. If I do that, the only entity to be persisted is the admin.\nDon't you think the same? Am I missing something?</p>\n"},{"tags":["hibernate","lazy"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":450,"score":0,"question_id":9805387,"title":"what is difference between lazy=\"true\" and fetch=\"select\" in hibernate?","body":"<p>The <code>lazy=true</code> attribute is enable lazy loading of the parent and child collections and same thing <code>fetch=\"select\"</code> attribute.  Is there any difference between <code>lazy=\"true\"</code> and <code>fetch=\"select\"</code> in hibernate?.</p>\n"},{"tags":["hibernate","orm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2537,"score":2,"question_id":1644434,"title":"@SecondaryTable annotation problem","body":"<p>I have following model,</p>\n\n<pre><code>\n@Entity\n@Table(name = \"user\")\n@PrimaryKeyJoinColumn(name=\"user_id\")\n@SecondaryTables({\n@SecondaryTable(name = \"user_personal_details\", pkJoinColumns = {@PrimaryKeyJoinColumn(name = \"user_id\", referencedColumnName = \"user_id\")}),\n@SecondaryTable(name = \"user_address\", pkJoinColumns = {@PrimaryKeyJoinColumn(name = \"user_id\", referencedColumnName = \"user_id\")}),\n@SecondaryTable(name = \"user_contact_info\", pkJoinColumns = {@PrimaryKeyJoinColumn(name = \"user_id\", referencedColumnName = \"user_id\")}),\n@SecondaryTable(name = \"user_auth_info\", pkJoinColumns = {@PrimaryKeyJoinColumn(name = \"user_id\", referencedColumnName = \"user_id\")})\n})\npublic abstract class User extends Member implements IUser {\n    @Column(table=\"user_personal_details\")\n    private UserPersonalDetails personalInfo;\n    @Column(table=\"user_address\")\n    private Address address;\n    @Column(table=\"user_contact_info\")\n    private UserContactDetails contactDetails;\n    @Column(table=\"user_auth_info\")\n    private UserAuthInfo authInfo;\n...\n}\n</code></pre>\n\n<p>When I try to insert a subclass of <code>User</code> I get an error shown below</p>\n\n<pre><code>10641 [main] ERROR org.hibernate.AssertionFailure - an assertion failure occured (this may indicate a bug in Hibernate, but is more likely due to unsafe use of the session)\norg.hibernate.AssertionFailure:Table user_personal_details not found</code></pre>\n\n<p>Please shed some light on this behavior.</p>\n\n<p><strong>Class Definitions:-</strong></p>\n\n<p><strong>ManagedObject Class</strong></p>\n\n<pre><code>\n\n@Entity\n@Table(name=\"managed_object\")\n@Inheritance(strategy=InheritanceType.JOINED)\n\npublic abstract class ManagedObject implements IManagedObject\n{\n    @Id\n        @Column(name=\"mo_id\", nullable=false, updatable=false)\n        private String id;\n    @Column(name=\"mo_name\", nullable=false, updatable=true)\n        private String name;\n        @Column(name=\"mo_type\", nullable=false, updatable=true)\n    private String type;\n        @Column(name=\"mo_additional_info\", nullable=true, updatable=true)\n    private String additionalInfo;\n...\n}\n\n</code></pre>\n\n<p><strong>Member Class</strong></p>\n\n<pre><code>\n\n@Entity\n@Table(name=\"t_member\")\n@PrimaryKeyJoinColumn(name=\"member_id\")\npublic abstract class Member extends ManagedObject implements IMember {\n\n}\n\n</code></pre>\n\n<p><strong>One of the Data/Info Class like UserPersonalDetails</strong></p>\n\n<pre><code>\n\n@Embeddable\n@Table\npublic class UserPersonalDetails extends InfoObject{\n    private String firstName;\n    private String middleName;\n    private String lastName;\n...\n}\n\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>Added <code>@Column(table=\"\")</code> annotation in UserPersonalDetails members and yes I do have <code>@Embedded</code> annotation in <code>User</code> class.\nI have encountered following exception:</p>\n\n<pre><code>\n4469 [main] ERROR org.hibernate.AssertionFailure - an assertion failure occured (this may indicate a bug in Hibernate, but is more likely due to unsafe use of the session)\norg.hibernate.AssertionFailure: Table user_personal_details not found\n</code></pre>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12988164,"title":"Tracking a Row's \"last updated by\"","body":"<p>I am using hibernate and I have a table that is constantly updated by various users logged in a web application. I would want to add \"last updated by\" and a \"last update time\" columns in that table. For the timestamp bit, I can simply use a trigger and fetch the time/date from oracle but for the \"last updated by\", the data should be fetched from the application layer.</p>\n\n<p>One way to do is would be to explicitly identify all the scenarios where that entity is being modified and add a entity.setLastUpdatedBy(username) or something of that sort but this would mean that I have to identify all such scenarios where the entity might get modified. </p>\n\n<p>Is there any other way I can achieve that?</p>\n\n<p>ps: my problem is strikingly similar to <a href=\"https://forum.hibernate.org/viewtopic.php?f=1&amp;t=950834\" rel=\"nofollow\">this problem</a> but I could not find the answer to it. The link mentioned in the problem does not work.</p>\n"},{"tags":["java","mysql","hibernate","mapping","innodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12985533,"title":"Getting org.hibernate.MappingException: No Dialect mapping for JDBC type: -4 exception?","body":"<p>I am getting following exception at <strong>query.list()</strong> line:</p>\n\n<pre><code>org.hibernate.MappingException: No Dialect mapping for JDBC type: -4\n    at org.hibernate.dialect.TypeNames.get(TypeNames.java:56)\n    at org.hibernate.dialect.TypeNames.get(TypeNames.java:81)\n    at org.hibernate.dialect.Dialect.getHibernateTypeName(Dialect.java:369)\n    at org.hibernate.loader.custom.CustomLoader$Metadata.getHibernateType(CustomLoader.java:559)\n    at org.hibernate.loader.custom.CustomLoader$ScalarResultColumnProcessor.performDiscovery(CustomLoader.java:485)\n    at org.hibernate.loader.custom.CustomLoader.autoDiscoverTypes(CustomLoader.java:501)\n    at org.hibernate.loader.Loader.getResultSet(Loader.java:1787)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:662)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:224)\n    at org.hibernate.loader.Loader.doList(Loader.java:2211)\n    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2095)\n    at org.hibernate.loader.Loader.list(Loader.java:2090)\n    at org.hibernate.loader.custom.CustomLoader.list(CustomLoader.java:289)\n    at org.hibernate.impl.SessionImpl.listCustomQuery(SessionImpl.java:1695)\n    at org.hibernate.impl.AbstractSessionImpl.list(AbstractSessionImpl.java:142)\n    at org.hibernate.impl.SQLQueryImpl.list(SQLQueryImpl.java:152)\n</code></pre>\n\n<p>following is my configuration file:</p>\n\n<pre><code>&lt;property name=\"hibernate.connection.driver_resource\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;mysql&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/mydatabase&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.default_schema\"&gt;mydatabase&lt;/property&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQL5InnoDBDialect&lt;/property&gt;\n</code></pre>\n\n<p>When I am trying to run application into Eclipse IDE then this exception is not coming but when I create jar of application and run then only I am getting it.\nthanks in advance...</p>\n"},{"tags":["eclipse","hibernate","hibernate-tools"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2022,"score":3,"question_id":7470619,"title":"Hibernate: An AnnotationConfiguration instance is required to use ... error","body":"<p>I build my HibernateUtil this way :</p>\n\n<pre><code>public class HibernateUtil {\n\n        private static final SessionFactory sessionFactory;\n\n        static {\n            try { \n                // Create the SessionFactory from standard (hibernate.cfg.xml) config file.\n                sessionFactory = new Configuration().configure().buildSessionFactory();\n\n            } catch (Throwable ex) {\n                // Log the exception. \n                System.err.println(\"Initial SessionFactory creation failed.\" + ex);\n                throw new ExceptionInInitializerError(ex);\n            }\n        }\n\n        public static SessionFactory getSessionFactory() {\n            return sessionFactory;\n        }\n}\n</code></pre>\n\n<p>So when I try to execute the HQL command in HQL Editor in Eclipse (with Hibernate Tools) gives the follow error:\n<img src=\"http://i.stack.imgur.com/dDOYh.png\" alt=\"enter image description here\">\nWhy this happening ? It shouln't change the AnnotationConfiguration by ConfigureAnnotation ?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n        \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n        \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;&lt;password&gt;&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://&lt;hostname&gt;:3306/&lt;schema&gt;&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;!-- &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt; --&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n\n        &lt;!-- SQL --&gt;\n        &lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n        &lt;!-- C3P0 --&gt;\n        &lt;property name=\"hibernate.c3p0.acquire_increment\"&gt;2&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.max_size\"&gt;20&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.min_size\"&gt;5&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.timeout\"&gt;180&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.idle_test_period\"&gt;100&lt;/property&gt;\n        &lt;!-- Classes --&gt;\n        &lt;mapping class=\"com.suaparte.pojo.Area\" /&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","oracle","hibernate","jpa","persistence"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":12986073,"title":"How to merge two transactions for different schemes into one?","body":"<p>There is a code like this:</p>\n\n<pre><code>ATransaction.commit ();\nBTransaction.commit ();\n</code></pre>\n\n<p>Both transactions are working with different schemes (ie persistence-unit they are different). It is necessary to combine both in one transaction. So if any one transaction fails to rollback both. How to do it?</p>\n"},{"tags":["html","mysql","hibernate","spring-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12986444,"title":"Save free form description along with spaces and line breaks","body":"<p>I'm sure there must be a lot of posts answering my query, but I am just not able to find the correct post.</p>\n\n<p>In my application user is entering free from description in the text area. but when data is saved and displayed on the next page, entire text is wrapped in to single para. I want whole text to be saved as user enters it along with line spaces and newlines, tabs etc.</p>\n\n<p>please redirect me to correct post. Do i have to save textarea as blob?</p>\n\n<p>Thanks</p>\n"},{"tags":["spring","hibernate","jpa-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12985269,"title":"Best Audit trail mechanism for Spring + JPA + Hibernate application","body":"<p>I am using Spring 3.0 + JPA2 + Hibernate 4.1 with MySQL 5.5\nI am looking to record 5 fields in my tables for audit trail purposes - lastModifiedByUser, lastModifiedTime, createdByUser, createdTime, isActive</p>\n\n<p>I am not deleting any data from the tables, just marking them off as isActive false.</p>\n\n<p>What is the best tool to help me record these audit fields in my tables ?\nI am wondering if DB triggers are not the best idea, specially since modifying / creating user  name is also recorded.</p>\n"},{"tags":["spring","hibernate","bean-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12985206,"title":"How to detect if Spring Validation passed?","body":"<p>I am trying to use Spring 3.0 validations using annotations.\n<a href=\"http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#core-convert\" rel=\"nofollow\">http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#core-convert</a></p>\n\n<p>My code looks like in the documentation:</p>\n\n<pre><code>@Controller\npublic class MyController {\n\n    @InitBinder\n    protected void initBinder(WebDataBinder binder) {\n       binder.setValidator(new FooValidator());\n    }\n\n    @RequestMapping(\"/foo\", method=RequestMethod.POST)\n    public void processFoo(@Valid Foo foo) { ... }\n\n}\n\npublic class PersonValidator implements Validator {\n\n    /**\n     * This Validator validates just Person instances\n     */\n   public boolean supports(Class clazz) {\n    return Person.class.equals(clazz);\n  }\n\npublic void validate(Object obj, Errors e) {\n    ValidationUtils.rejectIfEmpty(e, \"name\", \"name.empty\");\n}\n</code></pre>\n\n<p>}</p>\n\n<p>How do I tell in my RequestMapping method if the validation passed or not?</p>\n"},{"tags":["hibernate","jsf","richfaces"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12984573,"title":"Rich Faces Validator on hibernate object","body":"<p>I would like to use JSF, Spring , Hibernate as my system framework. I encounter a problem is, I have a input field on JSF with value bind to the bean with #{carBean.vehicle.name}. The code of my xhtml as be low:</p>\n\n<pre><code>&lt;h:inputText id=\"pcqwidth\" value=\"#{carBean.vehicle.wheels}\" \n                                        requiredMessage=\"#{errMsg['validation.field.required']}\"\n                                        size=\"30\"\n                                        required=\"true\"&gt;\n                                            &lt;rich:validator/&gt;\n                                        &lt;/h:inputText&gt;\n</code></pre>\n\n<p>my car bean validation as below :</p>\n\n<pre><code>@Valid\nprivate Vehicle vehicle;\n</code></pre>\n\n<p>my persistence view objects as below:</p>\n\n<pre><code>@Range(min=0,max=9999,message=\"Must be number between {min} and {max}\")\n    @Column(name=\"F_wheels\")\n    private Integer wheels;\n</code></pre>\n\n<p>However, when I click submit, I wont get the message \"Must be number between 0 and 9999\", but I get the message \"carForm:carwheel: 'addasd' must be a number between -2147483648 and 2147483647 Example: 21\". It seem like not really validate the value by rich validator. Is anyway I can get the message that I expected ?</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":91,"score":4,"question_id":12970799,"title":"Hibernate many-to-many withe extracolumn criteria problems","body":"<p>I followed this <a href=\"http://www.mkyong.com/hibernate/hibernate-many-to-many-example-join-table-extra-column-annotation/\" rel=\"nofollow\">tutorial</a> to implement in my domain model a many-to-many relationship with an extra column.  It works great but I'm unable to create a criteria to query a field within the left side of my relation.</p>\n\n<p>Taking this code </p>\n\n<pre><code>        @Entity\n        @Table( name = \"projects\")\n        public class Project implements Cloneable, Serializable{\n\n            private Long id;\n            private String name;\n            private Set&lt;ProjectOrganization&gt; projectOrganizations = new HashSet&lt;ProjectOrganization&gt;(0);\n\n            @Id\n            @GeneratedValue(strategy = GenerationType.AUTO)\n            @Column(nullable = false)\n            public Long getId() {\n                return this.id;\n            }\n\n\n            public void setId(Long id) {\n                this.id = id;\n            }\n\n\n            @Column(name = \"name\", length = 255, nullable = false)\n            public String getName() {\n                return this.name;\n            }\n\n\n            public void setName(String name) {\n                this.name = name;\n            }\n\n\n            @OneToMany(fetch = FetchType.EAGER, mappedBy = \"pk.project\")\n            @Cascade(value = { CascadeType.ALL })\n            public Set&lt;ProjectOrganization&gt; getProjectOrganizations() {\n                return this.projectOrganizations;\n            }\n\n\n            public void setProjectOrganizations(Set&lt;ProjectOrganization&gt; organizationProjects) {\n                this.projectOrganizations = organizationProjects;\n            }\n\n        }\n\n\n\n\n\n    @Entity\n    @Table(name = \"projects_has_organizations\")\n    @AssociationOverrides({ @AssociationOverride(name = \"pk.project\", joinColumns = @JoinColumn(name = \"projects_id\")), \n                            @AssociationOverride(name = \"pk.organization\", joinColumns = @JoinColumn(name = \"organizations_id\"))\n                            })\n    public class ProjectOrganization implements Cloneable, Serializable {\n\n\n        private ProjectOrganizationPK pk = new ProjectOrganizationPK();\n        private OrganizationRolesEnum role;\n\n        public ProjectOrganization() {\n        }\n\n        @Transient\n        public Organization getOrganization() {\n            return getPk().getOrganization();\n        }\n\n        public void setOrganization(Organization organization) {\n            getPk().setOrganization(organization);\n        }\n\n        @EmbeddedId\n        public ProjectOrganizationPK getPk() {\n            return pk;\n        }\n\n        public void setPk(ProjectOrganizationPK pk) {\n            this.pk = pk;\n        }\n\n        @Transient\n        public Project getProject() {\n            return getPk().getProject();\n        }\n\n        public void setProject(Project project) {\n            getPk().setProject(project);\n        }\n\n        @Enumerated(EnumType.STRING)\n        @Column(nullable = false, length = 50)\n        public OrganizationRolesEnum getRole() {\n            return role;\n        }\n\n        public void setRole(OrganizationRolesEnum role) {\n            this.role = role;\n        }\n\n    }\n\n    @Embeddable\n    public class ProjectOrganizationPK implements Cloneable, Serializable {\n\n        /** Generated serial version UID */\n        private static final long serialVersionUID = -4534322563105003365L;\n\n        private Organization organization;\n        private Project project;\n\n        @ManyToOne\n        public Organization getOrganization() {\n            return organization;\n        }\n\n        public void setOrganization(Organization organization) {\n            this.organization = organization;\n        }\n\n        @ManyToOne\n        public Project getProject() {\n            return project;\n        }\n\n        public void setProject(Project project) {\n            this.project = project;\n        }\n    }\n\n    @Entity\n    @Table(name = \"organizations\")\n    public class Organization implements Cloneable, Serializable {\n\n        private Long id;\n        private String name;\n        private Set&lt;ProjectOrganization&gt; projectOrganizations = new HashSet&lt;ProjectOrganization&gt;(0);\n\n        public Organization() {\n        }\n\n\n        @Id\n        @GeneratedValue(strategy = GenerationType.AUTO)\n        @Column(nullable = false)\n        @Override\n        public Long getId() {\n            return this.id;\n        }\n\n        public void setId(Long id) {\n            this.id = id;\n        }\n\n        @Column(name = \"name\", nullable = false, length = 255)\n        @NotNull(message = \"A name is required!\")\n        public String getName() {\n            return this.name;\n        }\n\n        public void setName(String name) {\n            this.name = name;\n        }\n\n\n        @OneToMany(fetch = FetchType.EAGER, mappedBy = \"pk.organization\")\n        public Set&lt;ProjectOrganization&gt; getProjectOrganization() {\n            return this.projectOrganizations;\n        }\n\n\n        public void setProjectOrganization(Set&lt;ProjectOrganization&gt; projectOrganizations) {\n            this.projectOrganizations = projectOrganizations;\n        }\n}\n</code></pre>\n\n<p>I want is to create a criteria to select a <code>Project</code> which has an <code>organization</code> with a requested name.</p>\n\n<pre><code>final Criteria crit = getSession().createCriteria(Project.class);\ncrit.createCriteria(\"projectOrganizations\", \"projectOrganization\").\n createAlias(\"pk.organization\", \"organization\").\n  add( Restrictions.like(\"organization.name\", \"TEST\"));\n</code></pre>\n\n<p>But when i run this code i have this error </p>\n\n<blockquote>\n  <p>2012-10-19 10:38:43,095 ERROR  [org.hibernate.util.JDBCExceptionReporter] Unknown column 'organizati2_.name' in 'where clause' </p>\n</blockquote>\n\n<p>and the sql query generated by hibernate is incomplete, doesn't join projects_has_organizations.organization with organization.id.. So it can't find column organization.name</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT\n   ....\nFROM\n    projects this_\nINNER JOIN projects_has_organizations projectorg1_ ON this_.id = projectorg1_.projects_id\nWHERE\n    projectorg1_.role =?\nAND organizati2_. NAME LIKE ?\nORDER BY\n    this_.publish_date DESC\n</code></pre>\n\n<p>What's wrong with this code? How can i build query using criteria ?</p>\n"},{"tags":["java","sql-server","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12981051,"title":"hibernate to MSSQL server Connection refused: connect","body":"<p>Im trying to run a java desktop application which accesses a MSSQL server using hibernate, but when trying to connect, it throws an exception and i really dont know what to do, here is my config file</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n      \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n      \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;!-- Generated by MyEclipse Hibernate Tools.                   --&gt;\n&lt;hibernate-configuration&gt;\n\n&lt;session-factory&gt;\n&lt;property name=\"connection.username\"&gt;&lt;/property&gt;\n&lt;property name=\"connection.password\"&gt;&lt;/property&gt;\n&lt;property name=\"connection.url\"&gt;\n    jdbc:jtds:sqlserver://localhost/databasename;useNTLMv2=true\n&lt;/property&gt;\n\n&lt;property name=\"dialect\"&gt;\n    ba.fit.utilities.FDialect_SqlServer\n&lt;/property&gt;\n&lt;property name=\"myeclipse.connection.profile\"&gt;nova 3&lt;/property&gt;\n\n\n&lt;property name=\"connection.driver_class\"&gt;\n    net.sourceforge.jtds.jdbc.Driver\n&lt;/property&gt;\n\n&lt;!-- JDBC connection pool (use the built-in) --&gt;\n&lt;property name=\"connection.pool_size\"&gt;1&lt;/property&gt;\n\n&lt;!-- Opcije printanja SQL koda u konzolnom prozoru--&gt;\n&lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n&lt;property name=\"format_sql\"&gt;false&lt;/property&gt;\n&lt;property name=\"use_sql_comments\"&gt;false&lt;/property&gt;\n\n\n&lt;!--vrijednost \"update\" kreira tabele ako nepostoje, ali ih nece mijenjati ako ima potrebe--&gt;\n&lt;property name=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/property&gt;\n\n\n&lt;!-- Enable Hibernate's automatic session context management --&gt;\n&lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n\n&lt;!-- Disable the second-level cache --&gt;\n&lt;property name=\"cache.provider_class\"&gt;\n    org.hibernate.cache.NoCacheProvider\n&lt;/property&gt;\n\n&lt;!-- mapirane klase koje trebaju biti \"persistence\" --&gt;\n&lt;!-- \n\n--&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Administrator\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.BiografijaPosloprimca\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.BiografijaPoslodavca\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Drzava\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Grad\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Kategorija\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.KategorijaBiografija\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.OcjenePoslodavca\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.OcjenePosloprimca\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Poslodavac\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Posloprimaoc\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Projekt\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.ProjektKategorija\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Racun\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.StatusTuzbe\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.StrucnaSprema\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Tuzba\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.Uplatnica\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.ZahtjevZaRadNaProjektu\" /&gt;\n&lt;mapping class=\"ba.fit.Tomo_seminar.model.RadnoVrijeme\" /&gt;\n\n\n\n\n\n&lt;/session-factory&gt;\n\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>but i get this exception</p>\n\n<pre><code>20:52:43,562  WARN SettingsFactory:109 - Could not obtain connection metadata\njava.sql.SQLException: Network error IOException: Connection refused: connect\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.&lt;init&gt;(ConnectionJDBC2.java:410)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC3.&lt;init&gt;(ConnectionJDBC3.java:50)\nat net.sourceforge.jtds.jdbc.Driver.connect(Driver.java:184)\nat java.sql.DriverManager.getConnection(Unknown Source)\nat java.sql.DriverManager.getConnection(Unknown Source)\nat org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)\nat org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:76)\nat org.hibernate.cfg.Configuration.buildSettings(Configuration.java:1933)\nat org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1216)\nat org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)\nat ba.fit.utilities.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:24)\nat ba.fit.Tomo_seminar.persistence.PosloprimaocDAO.pronadji(PosloprimaocDAO.java:17)\nat ba.fit.Tomo_seminar.services.servLogin.LoginPosloprimaoc(servLogin.java:31)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin.do_btnLogin_widgetSelected(FrmLogin.java:142)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin$1.widgetSelected(FrmLogin.java:92)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)\nat org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)\nat org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin.main(FrmLogin.java:44)\nCaused by: java.net.ConnectException: Connection refused: connect\nat java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)\nat java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)\nat java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)\nat java.net.AbstractPlainSocketImpl.connect(Unknown Source)\nat java.net.PlainSocketImpl.connect(Unknown Source)\nat java.net.SocksSocketImpl.connect(Unknown Source)\nat java.net.Socket.connect(Unknown Source)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat net.sourceforge.jtds.jdbc.SharedSocket.createSocketForJDBC3(SharedSocket.java:307)\nat net.sourceforge.jtds.jdbc.SharedSocket.&lt;init&gt;(SharedSocket.java:257)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.&lt;init&gt;(ConnectionJDBC2.java:311)\n... 20 more\n20:52:46,015 ERROR SchemaUpdate:134 - could not get database metadata\njava.sql.SQLException: Network error IOException: Connection refused: connect\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.&lt;init&gt;(ConnectionJDBC2.java:410)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC3.&lt;init&gt;(ConnectionJDBC3.java:50)\nat net.sourceforge.jtds.jdbc.Driver.connect(Driver.java:184)\nat java.sql.DriverManager.getConnection(Unknown Source)\nat java.sql.DriverManager.getConnection(Unknown Source)\nat org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)\nat org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:27)\nat org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)\nat org.hibernate.impl.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:314)\nat org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1218)\nat org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)\nat ba.fit.utilities.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:24)\nat ba.fit.Tomo_seminar.persistence.PosloprimaocDAO.pronadji(PosloprimaocDAO.java:17)\nat ba.fit.Tomo_seminar.services.servLogin.LoginPosloprimaoc(servLogin.java:31)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin.do_btnLogin_widgetSelected(FrmLogin.java:142)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin$1.widgetSelected(FrmLogin.java:92)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)\nat org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)\nat org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin.main(FrmLogin.java:44)\nCaused by: java.net.ConnectException: Connection refused: connect\nat java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)\nat java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)\nat java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)\nat java.net.AbstractPlainSocketImpl.connect(Unknown Source)\nat java.net.PlainSocketImpl.connect(Unknown Source)\nat java.net.SocksSocketImpl.connect(Unknown Source)\nat java.net.Socket.connect(Unknown Source)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat net.sourceforge.jtds.jdbc.SharedSocket.createSocketForJDBC3(SharedSocket.java:307)\nat net.sourceforge.jtds.jdbc.SharedSocket.&lt;init&gt;(SharedSocket.java:257)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.&lt;init&gt;(ConnectionJDBC2.java:311)\n... 21 more\n20:52:46,015 ERROR SchemaUpdate:165 - could not complete schema update\njava.sql.SQLException: Network error IOException: Connection refused: connect\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.&lt;init&gt;(ConnectionJDBC2.java:410)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC3.&lt;init&gt;(ConnectionJDBC3.java:50)\nat net.sourceforge.jtds.jdbc.Driver.connect(Driver.java:184)\nat java.sql.DriverManager.getConnection(Unknown Source)\nat java.sql.DriverManager.getConnection(Unknown Source)\nat org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:110)\nat org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:27)\nat org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:127)\nat org.hibernate.impl.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:314)\nat org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1218)\nat org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:915)\nat ba.fit.utilities.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:24)\nat ba.fit.Tomo_seminar.persistence.PosloprimaocDAO.pronadji(PosloprimaocDAO.java:17)\nat ba.fit.Tomo_seminar.services.servLogin.LoginPosloprimaoc(servLogin.java:31)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin.do_btnLogin_widgetSelected(FrmLogin.java:142)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin$1.widgetSelected(FrmLogin.java:92)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)\nat org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)\nat org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)\nat ba.fit.imeprojekta.ui.gui.v1.FrmLogin.main(FrmLogin.java:44)\nCaused by: java.net.ConnectException: Connection refused: connect\nat java.net.TwoStacksPlainSocketImpl.socketConnect(Native Method)\nat java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)\nat java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)\nat java.net.AbstractPlainSocketImpl.connect(Unknown Source)\nat java.net.PlainSocketImpl.connect(Unknown Source)\nat java.net.SocksSocketImpl.connect(Unknown Source)\nat java.net.Socket.connect(Unknown Source)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat net.sourceforge.jtds.jdbc.SharedSocket.createSocketForJDBC3(SharedSocket.java:307)\nat net.sourceforge.jtds.jdbc.SharedSocket.&lt;init&gt;(SharedSocket.java:257)\nat net.sourceforge.jtds.jdbc.ConnectionJDBC2.&lt;init&gt;(ConnectionJDBC2.java:311)\n... 21 more\n20:52:47,328  WARN JDBCExceptionReporter:71 - SQL Error: 0, SQLState: 08S01\n20:52:47,328 ERROR JDBCExceptionReporter:72 - Network error IOException: Connection refused: connect\n</code></pre>\n"},{"tags":["sql-server","spring","hibernate","junit","rollback"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":12713973,"title":"Junit test not rolling back transaction on sqlserver","body":"<p>I have created an integration test of a service that is not rolling back the transaction after completion. I know this from looking at the db and from my the error I get when I run the test a second time. I've been googling this issue all morning and feel I have everything set properly. This is a hibernate/jpa app writing to SQLServer 2008. I am not sure where else to look. Snippet below.</p>\n\n<pre><code>@RunWith(SpringJUnit4ClassRunner.class)\n@TestExecutionListeners({\n        DependencyInjectionTestExecutionListener.class,\n        DirtiesContextTestExecutionListener.class,\n        TransactionalTestExecutionListener.class })\n@TransactionConfiguration(defaultRollback=true)\n@Transactional // extend transactional boundary to test class so that automatic rollback works properly\n@ContextConfiguration(locations = {\n        \"file:./src/main/resources/AghostMobile.Service-business.service-context.xml\",\n        \"file:./src/main/resources/AghostMobile.Service-service-context.xml\",\n        \"file:./src/main/resources/AghostMobile.Service-dao-context.xml\"})\npublic class ColorSchemeMigrationServiceIntTest {\n\n    /**\n     * The service being tested, injected by Spring\n     *\n     */\n    @Autowired\n    ColorSchemeMigrationService service;\n\n    /**\n     * The helper services, injected by Spring.\n     *\n     */\n    @Autowired\n    protected WebsitecolorpaletteuserdefinedService userPaletteService;\n    @Test\n    public void testSaveColorPalette() {\n        Integer mobileWebsiteId = Integer.valueOf(386);\n        Integer custId = Integer.valueOf(15);\n        Integer siteId = Integer.valueOf(2);\n        String user = \"Test\";\n\n        Websitecolorpaletteuserdefined palette = service.translateColorScheme(mobileWebsiteId, custId, siteId, user);\n\n        service.saveColorPalette(palette);\n\n        Websitecolorpaletteuserdefined response = userPaletteService.findWebsitecolorpaletteuserdefinedByCustIdAndSiteId(custId, siteId);\n\n        assertNotNull(\"User palette not found.\", response);\n        assertEquals(\"CustId is not the expected value.\", custId, response.getCustId());\n        assertEquals(\"SiteId is not the expected value.\", siteId, response.getSiteId());\n    }\n</code></pre>\n\n<p>Currently, I have the following beans defined:</p>\n\n<pre><code>&lt;!-- ******************************************************************** --&gt;\n&lt;!-- Setup the transaction manager --&gt;\n&lt;!-- ******************************************************************** --&gt;\n    &lt;!-- Using Atomikos Transaction Manager --&gt;\n    &lt;bean id=\"atomikosTransactionManager\" class=\"com.atomikos.icatch.jta.UserTransactionManager\" init-method=\"init\"\n        destroy-method=\"close\"&gt;\n        &lt;property name=\"forceShutdown\" value=\"true\" /&gt;\n        &lt;property name=\"startupTransactionService\" value=\"true\" /&gt;\n        &lt;property name=\"transactionTimeout\" value=\"60\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"atomikosUserTransaction\" class=\"com.atomikos.icatch.jta.UserTransactionImp\" /&gt;\n    &lt;!-- Configure the Spring framework to use JTA transactions from Atomikos --&gt;\n    &lt;bean id=\"transactionManager\" class=\"org.springframework.transaction.jta.JtaTransactionManager\"&gt;\n        &lt;property name=\"transactionManager\" ref=\"atomikosTransactionManager\" /&gt;\n        &lt;property name=\"userTransaction\" ref=\"atomikosUserTransaction\" /&gt;\n        &lt;property name=\"transactionSynchronizationName\" value=\"SYNCHRONIZATION_ON_ACTUAL_TRANSACTION\" /&gt;\n    &lt;/bean&gt;\n&lt;!-- ******************************************************************** --&gt;\n&lt;!-- Setup a data source --&gt;\n&lt;!-- ******************************************************************** --&gt;\n&lt;!-- Using Apache DBCP Data Sources --&gt;\n&lt;bean name=\"hostDataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\" &gt;\n    &lt;property name=\"driverClassName\" value=\"${My_JDTs_to_AgHost_Host_scheme.connection.driver_class}\" /&gt;\n    &lt;property name=\"username\" value=\"${My_JDTs_to_AgHost_Host_scheme.connection.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${My_JDTs_to_AgHost_Host_scheme.connection.password}\" /&gt;\n    &lt;property name=\"url\" value=\"${My_JDTs_to_AgHost_Host_scheme.connection.url}\" /&gt;\n    &lt;property name=\"maxIdle\" value=\"${My_JDTs_to_AgHost_Host_scheme.minPoolSize}\" /&gt;\n    &lt;property name=\"maxActive\" value=\"${My_JDTs_to_AgHost_Host_scheme.maxPoolSize}\" /&gt;\n&lt;/bean&gt;\n\n&lt;!-- ******************************************************************** --&gt;\n&lt;!-- Setup each persistence unit --&gt;\n&lt;!-- ******************************************************************** --&gt;\n            &lt;!-- Configure a JPA vendor adapter --&gt;\n            &lt;bean id=\"My_JDTs_to_AgHost_Host_schemeJPAVendorAdapter\" class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n                &lt;property name=\"showSql\" value=\"${My_JDTs_to_AgHost_Host_scheme.show_sql}\" /&gt;\n                &lt;property name=\"generateDdl\" value=\"${My_JDTs_to_AgHost_Host_scheme.generateDdl}\" /&gt;\n                &lt;property name=\"databasePlatform\" value=\"${My_JDTs_to_AgHost_Host_scheme.dialect}\" /&gt;\n            &lt;/bean&gt;\n            &lt;!-- EntityManager Factory that brings together the persistence unit, datasource, and JPA Vendor --&gt;\n            &lt;bean id=\"My_JDTs_to_AgHost_Host_scheme\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n                &lt;property name=\"dataSource\" ref=\"hostDataSource\" /&gt;\n                &lt;property name=\"persistenceUnitName\" value=\"My_JDTs_to_AgHost_Host_scheme\" /&gt;\n                &lt;property name=\"jpaVendorAdapter\" ref=\"My_JDTs_to_AgHost_Host_schemeJPAVendorAdapter\" /&gt;\n                    &lt;property name=\"jpaPropertyMap\"&gt;\n                        &lt;map&gt;\n                                    &lt;entry key=\"hibernate.transaction.manager_lookup_class\" value=\"com.atomikos.icatch.jta.hibernate3.TransactionManagerLookup\" /&gt;\n                                    &lt;!-- &lt;entry key=\"hibernate.transaction.factory_class\" value=\"org.hibernate.transaction.JTATransactionFactory\" /&gt; --&gt;\n                                    &lt;entry key=\"hibernate.connection.release_mode\" value=\"on_close\" /&gt;\n                        &lt;/map&gt;\n                    &lt;/property&gt;\n            &lt;/bean&gt;\n</code></pre>\n\n<p>This does allow me to update my data, but does not rollback my transaction. So, I am using a transaction manager,  org.springframework.jdbc.datasource.DataSourceTransactionManager. I replaced the three beans in the \"Setup transaction manager\" block with:</p>\n\n<pre><code>    &lt;bean id=\"transactionManager\"\n        class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"&gt;\n        &lt;property name=\"dataSource\" ref=\"hostDataSource\" /&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<p>This left me with tests failing with <em>IllegalStateException: This method needs a transaction for the calling thread and none exists.</em> The exception also stated:</p>\n\n<pre><code>Possible causes: either you didn't start a transaction,\nit rolledback due to timeout, or it was committed already.\nACTIONS: You can try one of the following: \n1. Make sure you started a transaction for the thread.\n2. Make sure you didn't terminate it yet.\n3. Increase the transaction timeout to avoid automatic rollback of long transactions;\n   check [http://www.atomikos.com/Documentation/JtaProperties][1] for how to do this.\n</code></pre>\n\n<p>I'll admit to not having read that document yet and will do so after posting these updates. I have also found this thread, which looked promising: <a href=\"http://stackoverflow.com/questions/10897015/persistence-unit-different-hibernate-transaction-manager-lookup-class-property\">persistence-unit, different hibernate.transaction.manager_lookup_class property</a>. You can see that commented out in bean My_JDTs_to_AgHost_Host_scheme. This failed pretty miserably. But, perhaps I didn't use it properly.</p>\n\n<p>I also found this thread: <a href=\"http://stackoverflow.com/questions/3128111/spring-jta-jpa-dao-integration-test-doesnt-rollback\">Spring/JTA/JPA DAO integration test doesn&#39;t rollback?</a>. This looks quite promising, but again I am not sure how to use what it is telling me.</p>\n"},{"tags":["java","multithreading","hibernate","unique-constraint"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12980217,"title":"Unique constraint violation error in while SaveOrUpdate","body":"<p>I have a hibernate entity called customer which contains the information about customer.In my method i m getting customer details as parametres which i need to insert in database. So to remove duplicate entries i m checking whether that customer already exists in db or not. But the problem is that if two calls are made to same method at one instant with same customer information then i m getting constraint violation error. I thought saveOrupdate() will solve the problem but it hasnt. Can someone suggest a solution for this scenario.</p>\n"},{"tags":["hibernate","hibernate-annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2634,"score":0,"question_id":6909796,"title":"How to prevent having org.hibernate.loader.MultipleBagFetchException","body":"<p>I get the following exception:</p>\n\n<blockquote>\n  <p>org.hibernate.loader.MultipleBagFetchException: cannot simultaneously fetch multiple bags</p>\n</blockquote>\n\n<p>the bean I use is:</p>\n\n<pre><code>@Entity\n@Table(name=\"user\")\npublic class User implements Serializable {\n\n/**\n * \n */\nprivate static final long serialVersionUID = -5689970869179555442L;\n\n@Id\n@Column(name=\"username\")\n/*@NotNull*/\nprivate String username;\n\n@Column(name=\"password\")\nprivate String password;\n\n@Column(name=\"email\")\n/*@Email*/\nprivate String email;\n\n@LazyCollection(LazyCollectionOption.FALSE)\n@ManyToMany\n@JoinTable(name=\"user_follower\",joinColumns={@JoinColumn(name=\"username\")},\n        inverseJoinColumns={@JoinColumn(name=\"follower\")})\nprivate List&lt;User&gt; followers = new ArrayList&lt;User&gt;(0);\n\n/*@LazyCollection(LazyCollectionOption.FALSE)*/\n@OneToMany(fetch=FetchType.EAGER)\n@JoinTable(name=\"user_message\",joinColumns={@JoinColumn(name=\"username\")},\n        inverseJoinColumns={@JoinColumn(name=\"message_date\")})\n@OrderBy(value=\"messageDate\")\nprivate List&lt;Message&gt; messages = new ArrayList&lt;Message&gt;(0);\n\npublic User() {\n\n}\n</code></pre>\n\n<p>in the dao I have the following code:</p>\n\n<pre><code>public void followUser(String userToFollow, String username) {\n    System.out.println(\"repository invoked\");\n    session=sessionFactory.getCurrentSession();\n    User user=retrieveUser(username);\n    @SuppressWarnings(\"unchecked\")\n    List&lt;User&gt; followers=session.createCriteria(User.class).setFetchMode(\"followers\", FetchMode.JOIN)\n    .add(Restrictions.eq(\"username\", username)).list();\n    for(User follower: followers){\n        if(follower.getUsername().equals(userToFollow)){\n            //do nothing\n        }else{\n            followers.add(retrieveUser(userToFollow));\n            user.setUserFollowers(followers);\n        }\n    }\n    session.saveOrUpdate(user);\n}\n</code></pre>\n\n<p>I don't know what to do to prevent such exception</p>\n"},{"tags":["hibernate","jpa","eclipselink"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12952625,"title":"JPA category-language relationship","body":"<p>I am building a category-based web application multilanguage using JPA/Hibernate + Spring</p>\n\n<p>I currently built these three beans/entities: Category, CategoryLanguage and Language.</p>\n\n<p><strong>Category:</strong></p>\n\n<pre><code>@Entity\npublic class Category implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private int id;\n    @ManyToOne\n    private Category father;\n    @OneToMany(mappedBy = \"father\")\n    private List&lt;Category&gt; children;\n    @OneToMany(mappedBy=\"category\")\n    private List&lt;CategoryLanguage&gt; categoryLanguages;\n</code></pre>\n\n<p><strong>CategoryLanguage:</strong></p>\n\n<pre><code>@Entity\npublic class CategoryLanguage implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private int id;\n    @ManyToOne\n    Category category;\n    @Column(length = 20, nullable = false)\n    private String name;\n    @ManyToOne\n    private Language language;\n</code></pre>\n\n<p>and <strong>Language</strong></p>\n\n<pre><code>public class Language implements Serializable {\n    private static final long serialVersionUID = 1L;\n    @Id\n    @Column(length=2)\n    private String id; // en, de, fr, it, es,...\n\n    @Column(length=25)\n    private String name; // English, Deutsch, Français,...\n</code></pre>\n\n<p>By calling </p>\n\n<pre><code>from Category c join c.categoryLanguages cl where c.father = null and cl.language.id = :lang\n</code></pre>\n\n<p>It returns the first level of categories with the right language, but contains all the languages as children. </p>\n\n<p><strong>Children are extracted for every language instead of the one I chose on the query.</strong></p>\n\n<p>What could I do to solve this problem? I can not use \"join <strong>on</strong>\" in JPQL, can i?</p>\n"},{"tags":["hibernate","foreign-keys","multikey"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12978278,"title":"MultiKey FK fails in the child insert with Hibernate","body":"<p>I got the following code, the problem is that the child Mmt, doesn't get fill up the FK with the mmt.setMapMovAnomes(miMapMovAnomes) If I check in debug, the object mmt, have data into the parent property MapMovAnomes, then you don't get any error but If you check into database the FK fields are empty.</p>\n\n<pre><code>@Test\npublic void creaMmt()\n{\n    Transaction tx = null\n    Date fecha = getFecha(\"2012-12-09\")\n    Integer anho = fecha.year + 1900\n    Integer mes = fecha.month\n    Integer anomes = anho * 100 + mes\n    Integer idmap = 10000\n    Mmt mmt = new Mmt()\n    MapMovAnomes miMapMovAnomes = new MapMovAnomes()\n    Session session = staticFactory.getCurrentSession();\n    tx = session.beginTransaction()\n\n    Map miMap = session.get (Map.class, idmap)\n        MapMovAnomesId mId = new MapMovAnomesId()\n        mId.setAnho(anho)\n        mId.setMes(mes)\n        mId.setIdMap(idmap)\n        miMapMovAnomes.setId(mId)\n        miMapMovAnomes.setMap(miMap)\n        session.save miMapMovAnomes\n    mmt.setMapMovAnomes(miMapMovAnomes)\n    mmt.setFechMovimiento(fecha)\n    mmt.setCantidad(100)\n    mmt.setClaveES(\"E\")\n    session.save mmt\n    miMapMovAnomes.addMmt(mmt)\n\n    tx.commit();\n}\n</code></pre>\n\n<p>relationship in the POJO of mmt </p>\n\n<pre><code>    @ManyToOne(fetch = FetchType.LAZY)\n@JoinColumns({\n        @JoinColumn(name = \"id_map\", referencedColumnName = \"id_map\", insertable = false, updatable = false),\n        @JoinColumn(name = \"anho\", referencedColumnName = \"anho\", insertable = false, updatable = false),\n        @JoinColumn(name = \"mes\", referencedColumnName = \"mes\", insertable = false, updatable = false) })\npublic MapMovAnomes getMapMovAnomes() {\n    return this.mapMovAnomes;\n}\n\npublic void setMapMovAnomes(MapMovAnomes mapMovAnomes) {\n    this.mapMovAnomes = mapMovAnomes;\n}\n</code></pre>\n\n<p>I have Also the following relationships: map -> mapMovAnomes and map -> mmt</p>\n\n<pre><code>@OneToMany(fetch = FetchType.LAZY, mappedBy = \"map\")\npublic Set&lt;MapMovAnomes&gt; getMapMovAnomeses() {\n    return this.mapMovAnomeses;\n}\n\npublic void setMapMovAnomeses(Set&lt;MapMovAnomes&gt; mapMovAnomeses) {\n    this.mapMovAnomeses = mapMovAnomeses;\n}\n\n@OneToMany(fetch = FetchType.LAZY, mappedBy = \"map\")\npublic Set&lt;Mmt&gt; getMmts() {\n    return this.mmts;\n}\n\npublic void setMmts(Set&lt;Mmt&gt; mmts) {\n    this.mmts = mmts;\n}\n</code></pre>\n\n<p>I has discover that the problem is that I have map->MapMovAnomes -> mmt and map-> mmt, then If I take off the relationship map->mmt, the it works fine, but how can this make to work keeping  this relationship.</p>\n"},{"tags":["sql","hibernate","native","loader"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2516,"score":1,"question_id":4603065,"title":"Load only some columns with Hibernate native SQL queries","body":"<p>I have a table on the database and I want to load only some columns from the result set, because the main object mapped in Hibernate has a relation with itself and the object is very big. I defined a native sql query in the hbm file:</p>\n\n<pre><code>    &lt;sql-query name=\"query\"&gt;\n  &lt;return alias=\"r\" class=\"RawData\"/&gt;    \n     &lt;![CDATA[\n       SELECT DESCRIPTION as {r.description}\n       FROM RAWD_RAWDATAS r       \n       WHERE r.RAWDATA_ID=?\n      ]]&gt;\n &lt;/sql-query&gt;\n</code></pre>\n\n<p>This query however fails with error: <strong>could not read column value from result set: RAWDATA1_14_0_; Invalid column name SQL Error: 17006, SQLState: null</strong>, because Hibernate tries to load all fields from the result set. I found also a bug in Hibernate JIRA (http://opensource.atlassian.com/projects/hibernate/browse/HHH-3035). Anyone knows how to accomplish this task with a workaround?</p>\n"},{"tags":["java","sql","oracle","hibernate","hql"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":382,"score":2,"question_id":11793159,"title":"how to use Oracle's regexp_like in Hibernate HQL?","body":"<p>I am using <code>oracle 10g</code> and <code>hibernate 3.3.2</code>. I have used regular expression in sql before, now for the first time I am using it in HQL.</p>\n\n<pre><code>Query query = getSession().createQuery(\"From Company company \nwhere company.id!=:companyId and \nregexp_like(upper(rtrim(ltrim(company.num))), '^0*514619915$' )\");\n</code></pre>\n\n<p>This is my hql, when i run it without <code>regex_like</code> function it runs as expected. But I am not able to execute it with <code>regex_like</code> expression. </p>\n\n<p>It says..</p>\n\n<blockquote>\n  <p>nested exception is org.hibernate.hql.ast.QuerySyntaxException:\n  unexpected AST node: ( near line 1, column 66.....</p>\n</blockquote>\n\n<p>Kindly help, how can I use <code>regex_like</code> in hibernate native query? OR some other alternative to do so.</p>\n"},{"tags":["spring","hibernate","grails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12971451,"title":"Releasing Grails database connection early","body":"<p>I have a controller action that does the following things:</p>\n\n<ol>\n<li><p>Gets a domain object from the database</p></li>\n<li><p>Uses info on that object to find a data file (on disk) and writes contents of that file to the response output stream.</p></li>\n</ol>\n\n<p>My problem is that the database connection is reserved for the duration of the action, including the (long) time required to stream the data. This results in a lot of unnecessary database connections when there are several users streaming data at the same time.</p>\n\n<pre><code>def stream() {\n  StreamDetails sd = StreamDetails.get(params.id)\n\n  // Extract info needed to read the stream\n  String filename = sd.filename\n\n  // The database connection is no longer needed, how to properly release it?\n\n  // Start writing the data stream to response output\n  // This may take a long time and does not use a db connection\n  streamService.writeToOutput(filename,response.getOutputStream())\n}\n</code></pre>\n\n<p>I have tried:</p>\n\n<ol>\n<li><p>Injecting the <code>sessionFactory</code> bean to the controller and calling <code>sessionFactory.currentSession.close()</code> before calling the service. However this causes a <code>SessionException</code> on the line calling the service, ie. before entering the <code>writeToOutput()</code> method (and nothing in that method needs a database connection). AND I don't think the session should be really closed, just released to the pool.</p></li>\n<li><p>Copy-pasting the code from <code>streamService.writeToOutput(...)</code> to the controller to avoid the service call. In this case all the code gets executed but a <code>SessionException</code> is still thrown after the action is complete.</p></li>\n</ol>\n\n<p>How to properly release the connection early?</p>\n"},{"tags":["hibernate","jpa"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12976328,"title":"error while testing Hibernate JPA","body":"<p>I create a jUnit test to test my code, when I try to instatiate my object, I get this error</p>\n\n<pre><code>java.lang.IllegalAccessError: tried to access method org.hibernate.cfg.Configuration.&lt;init&gt;(Lorg/hibernate/cfg/SettingsFactory;)V from class org.hibernate.ejb.Ejb3Configuration\n    at org.hibernate.ejb.Ejb3Configuration.&lt;init&gt;(Ejb3Configuration.java:134)\n    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:124)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:63)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)\n    at gov.ic.isso.sentry.rest.data.CeReportDaoImpl.init(CeReportDaoImpl.java:41)\n    at gov.ic.isso.sentry.rest.data.DaoBase.&lt;init&gt;(DaoBase.java:20)\n    at gov.ic.isso.sentry.rest.data.CeReportDaoImpl.&lt;init&gt;(CeReportDaoImpl.java:33)\n    at gov.ic.isso.sentry.rest.AppTest.testApp(AppTest.java:41)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:601)\n    at junit.framework.TestCase.runTest(TestCase.java:168)\n    at junit.framework.TestCase.runBare(TestCase.java:134)\n    at junit.framework.TestResult$1.protect(TestResult.java:110)\n    at junit.framework.TestResult.runProtected(TestResult.java:128)\n    at junit.framework.TestResult.run(TestResult.java:113)\n    at junit.framework.TestCase.run(TestCase.java:124)\n    at junit.framework.TestSuite.runTest(TestSuite.java:243)\n    at junit.framework.TestSuite.run(TestSuite.java:238)\n    at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)\n</code></pre>\n\n<p>My code for my init method is </p>\n\n<pre><code>protected void init() {\n        emf = Persistence.createEntityManagerFactory(\"ceDataSessionData\");\n\n        em = emf.createEntityManager();\n    }\n</code></pre>\n\n<p>My jUnit test is as </p>\n\n<pre><code> public void testApp()\n    {\n        CeReportDao reportDao = new CeReportDaoImpl();\n        try {\n            reportDao.getMoneyTransferReportJson(100, \"TESTUSER1\", \"NS\", null);\n        } catch (SQLException e) {\n            // TODO Auto-generated catch block\n            e.printStackTrace();\n        }\n\n    }\n</code></pre>\n"},{"tags":["java","hibernate","transactions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12973894,"title":"Understanding hibernate @Proxy","body":"<p>I`m trying to understand Hibernate @Proxy and I failed with one thing:\nWhen I use Interface in the @Proxy within read-write transaction then I got this exception:</p>\n\n<pre><code>SEVERE: &gt;&gt;java.lang.RuntimeException: java.lang.reflect.InvocationTargetException\n&gt;&gt;java.lang.reflect.InvocationTargetException: null\n&gt;&gt;org.hibernate.PropertyAccessException: IllegalArgumentException occurred calling getter of cz.kontraktor.entity.Property.id\n&gt;&gt;java.lang.IllegalArgumentException: object is not an instance of declaring class\n</code></pre>\n\n<p>There is no exception wen I use read-only transaction.</p>\n\n<pre><code>@Transactional(propagation=Propagation.REQUIRED, readOnly=true)\n</code></pre>\n\n<p>Would enyone explain me how to use @Proxy annotation to working with entity interface?</p>\n\n<pre><code>@Entity\n@Table(name = \"property\")\n@Proxy(proxyClass=IProperty.class)\npublic class Property implements Serializable, IProperty {\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(insertable = false, updatable = false, unique = true, nullable = false)\n    private Long id;\n\n    private String value;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getValue() {\n        return value;\n    }\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n}\n</code></pre>\n\n<p>...</p>\n\n<pre><code>@NamedQueries ({\n    @NamedQuery (name=Person.FIND, query = \"SELECT p FROM Person p WHERE p.id = :id\"),\n    @NamedQuery (name=Person.FIND_ALL, query = \"SELECT p FROM Person p\")\n})\n@Entity\n@Table(name = \"person\")\npublic class Person implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    public static final String FIND = \"Person.Find\";\n    public static final String FIND_ALL = \"Person.FindAll\";\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(insertable = false, updatable = false, unique = true, nullable = false)\n    private Long id;\n    private String name;\n\n    @ManyToOne(optional=true, fetch=FetchType.LAZY)\n    @JoinColumn(name=\"boss_id\")\n    private Person boss;\n\n    @OneToMany(mappedBy=\"boss\", fetch=FetchType.LAZY)\n    private List&lt;Person&gt; employees = new ArrayList&lt;Person&gt;();\n\n    @ManyToOne(fetch=FetchType.LAZY)\n    @JoinColumn(name=\"address_id\")\n    private Address address;\n\n    @OneToOne(fetch=FetchType.LAZY, targetEntity=Property.class)\n    private IProperty prop;\n\n    public Long getId() {\n        return id;\n    }\n    public void setId(Long id) {\n        this.id = id;\n    }\n    public String getName() {\n        return name;\n    }\n    public void setName(String name) {\n        this.name = name;\n    }\n    public Person getBoss() {\n        return boss;\n    }\n    public void setBoss(Person boss) {\n        this.boss = boss;\n    }\n    public List&lt;Person&gt; getEmployees() {\n        return employees;\n    }\n    public void addEmployee(Person employee) {\n        employee.setBoss(this);\n        this.employees.add(employee);\n    }\n    public Address getAddress() {\n        return address;\n    }\n    public void setAddress(Address address) {\n        this.address = address;\n    }\n    public IProperty getProp1() {\n        return prop;\n    }\n    public void setProp(IProperty prop1) {\n        this.prop = prop1;\n    }\n}\n</code></pre>\n\n<p>Here is the DAO where exception occured on transaction commit (or on exit from method).</p>\n\n<pre><code>@Transactional(propagation=Propagation.REQUIRED, readOnly=false)\npublic class PersonDao implements IPersonDao {\n    @PersistenceContext\n    private EntityManager em;\n\n    @SuppressWarnings(\"unchecked\")\n    @Override\n    public Person load() {\n        org.hibernate.Session session = (Session) this.em.getDelegate();\n        Iterator&lt;Person&gt; iterator = session.getNamedQuery(Person.FIND_ALL).iterate();\n        Person person = (Person) iterator.next();\n        Transaction tr = session.getTransaction();\n        tr.commit(); // Exception !!!\n        return person;\n    }\n}\n</code></pre>\n\n<p>Exception also disappear when I use <code>Property.class</code> instead of interface <code>IProperty.class</code> in Proxy annotation.</p>\n\n<pre><code>@Proxy(proxyClass=Property.class)\n</code></pre>\n\n<p>Could not be user interface within <code>@Proxy</code>?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I'm using latest hibernate version <code>4.1.7.Final</code> which use <code>javassist</code> for creating proxy. When I tied to use old hibernate version with <code>CGLIB</code> then problem disappeared.</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n    &lt;version&gt;3.2.1.ga&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>Why it's not working with latest hibernate version? Any idea?</p>\n"},{"tags":["java","hibernate","orm","tapestry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12975508,"title":"How to refer another table in Hibernate","body":"<p>I have two classes: <code>User</code> and <code>Video</code>:</p>\n\n<pre><code>@Entity    \nclass User{\n    @Id\n    int id;        \n    String name;\n}\n\n@Entity\n    class Video{\n    @Id\n    int id;        \n    String url;\n    User user;\n}\n</code></pre>\n\n<p>When i use this I get the following error:</p>\n\n<blockquote>\n  <p>Could not determine type for: User, at table: Video</p>\n</blockquote>\n\n<p>I'm using Hibernate through Tapestry. Any suggestions?</p>\n"},{"tags":["hibernate","loops","sequence","derby"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":12975279,"title":"Derby Sequence Loop in junit test","body":"<p>I'm in trouble when using Derby with embedded driver (derby-10.9.1.0) and in-memory db in my JUNIT with Hibernate (hibernate-core-3.6.8.Final) environment.</p>\n\n<p>I'm using annotations and using hbm2ddl to create my in-memory db.</p>\n\n<p>Everything is working except when I try to use an sequence.</p>\n\n<p>The sequence is created (it appears in the log), but when I try to add one entity (hibernate) with PK related to that sequence my code starts a infinite loop writing in each line:</p>\n\n<pre><code>Hibernate: values next value for app.SE_FERI\n</code></pre>\n\n<p>My db is created as:</p>\n\n<pre><code>jdbc:derby:memory:testdb;create=true\n</code></pre>\n\n<p>I'm using hbm2ddl inside my code, before the database use, as:</p>\n\n<pre><code>SchemaExport schemaExport = new SchemaExport(config);\nschemaExport.drop(true, true);\nschemaExport.create(true, true);\n</code></pre>\n\n<p>Some help !?</p>\n"},{"tags":["hibernate","configuration","entity","jpa-2.0","entities"],"answer_count":2,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":1568,"score":8,"question_id":6380728,"title":"JPA 2.0: Adding entity classes to PersistenceUnit *from different jar* automatically","body":"<p>I have a maven-built CDI-based Java SE app, which has a <em>core</em> module, and other modules.<br>\nCore has the <code>persistence.xml</code> and some entities.\nModules have additional entities.</p>\n\n<p>How can I add the entities to the spotlight of the persistence unit?</p>\n\n<p>I have read Hibernate manual, <a href=\"http://docs.jboss.org/hibernate/stable/entitymanager/reference/en/html/configuration.html#setup-configuration-packaging\">http://docs.jboss.org/hibernate/stable/entitymanager/reference/en/html/configuration.html#setup-configuration-packaging</a></p>\n\n<p>I have also seen these SO questions</p>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/1211777/how-can-i-merge-extend-persistence-units-from-different-jars\">How can I merge / extend persistence units from different JARs?</a></li>\n<li><a href=\"http://stackoverflow.com/questions/3774663/define-jpa-entity-classes-outside-of-persistence-xml\">define jpa entity classes outside of persistence.xml</a></li>\n<li><a href=\"http://stackoverflow.com/questions/2838634/programmatically-loading-entity-classes-with-jpa-2-0\">Programmatically loading Entity classes with JPA 2.0?</a></li>\n</ul>\n\n<p>I am looking for a solution where Hibernate would scan for all loaded classes, or, would pick up some config file form the other jars (like e.g. CDI does with <code>beans.xml</code>).  </p>\n\n<p>My app does not use Spring.\nI don't insist on portability - I'll stick with Hibernate.</p>\n\n<ul>\n<li><strong>Is there some such solution?</strong></li>\n<li><strong>Is there's a way to create a PU from <code>persistence.xml</code> and add classes to it programmatically?</strong></li>\n<li><strong>Can I add @Entity classes to <code>EntityManagerFactory</code> after it was created?</strong></li>\n</ul>\n\n<hr>\n\n<p><em>Update:</em> I found in <code>org.​hibernate.​ejb.​Ejb3Configuration</code>:<br>\npublic Ejb3Configuration configure(String persistenceUnitName, Map integration)<br>\n<a href=\"http://docs.jboss.org/hibernate/entitymanager/3.6/javadocs/\">http://docs.jboss.org/hibernate/entitymanager/3.6/javadocs/</a></p>\n"},{"tags":["java","spring","hibernate","java-ee","spring-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":12971848,"title":"Making Spring 3 MVC controller method Transactional","body":"<p>I am using Spring 3.1 and have my DAO and service layer(transactional) written.</p>\n\n<p>However in a special case to avoid a lazy init exception I have to make a spring mvc request handler method @transactional. But It is failing to attach transaction to that method. Method name is ModelAndView home(HttpServletRequest request, HttpServletResponse response). \n<a href=\"http://forum.springsource.org/showthread.php?46814-Transaction-in-MVC-Controller\" rel=\"nofollow\">http://forum.springsource.org/showthread.php?46814-Transaction-in-MVC-Controller</a> \nFrom this link it seems it is not possible to attach transaction (by  default ) to mvc methods. Solution suggested in that link seems to be for Spring 2.5 (overriding handleRequest ). Any help will be reallyappreciated. Thanks</p>\n\n<pre><code>@Controller\npublic class AuthenticationController { \n@Autowired\nCategoryService categoryService;    \n@Autowired\nBrandService brandService;\n@Autowired\nItemService itemService;\n\n@RequestMapping(value=\"/login.html\",method=RequestMethod.GET)\nModelAndView login(){       \n    return new ModelAndView(\"login.jsp\");       \n}   \n@RequestMapping(value=\"/home.html\",method=RequestMethod.GET)\n@Transactional\nModelAndView home(HttpServletRequest request, HttpServletResponse response){\n    List&lt;Category&gt; categories = categoryService.readAll();\n    request.setAttribute(\"categories\", categories);     \n    List&lt;Brand&gt; brands = brandService.readAll();\n    request.setAttribute(\"brands\", brands);     \n    List&lt;Item&gt; items = itemService.readAll();\n    request.setAttribute(\"items\", items);\n    Set&lt;Image&gt; images = items.get(0).getImages();\n    for(Image i : images ) {\n        System.out.println(i.getUrl());\n    }\n    return new ModelAndView(\"home.jsp\");    \n}\n</code></pre>\n"},{"tags":["sql","query","hibernate","hql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12973700,"title":"Hibernate query date compare on year and month only","body":"<p>I need to grab some records from a table which has a Column <code>birthDate</code> which is a <code>Date</code>(without time). I need to filter records by comparing against year and month only. \nFor example I want all the users born on March of 1990. The day doesn't matter.</p>\n\n<p>How do you handle it?</p>\n"},{"tags":["java","hibernate","freemarker"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12974059,"title":"Hibernate Reveng - Pass values to Template","body":"<p>i got a custom Strategy extending DelegatingReverseEngineeringStrategy.</p>\n\n<p>Now i like to pass custom values to the pojo.ftl-Template.</p>\n\n<p>If i call </p>\n\n<pre><code>@Override\npublic Map columnToMetaAttributes(TableIdentifier identifier, String column) {\n    Map&lt;String, MetaAttribute&gt; metaAttributes =\n            super.columnToMetaAttributes(identifier, column);\n    MetaAttribute metaAttribute = new MetaAttribute(\"test\");\n    metaAttribute.addValue(\"mytest\");\n    metaAttributes.put(\"test\", metaAttribute);\n    return metaAttributes;\n}\n</code></pre>\n\n<p>If i use </p>\n\n<pre><code>    d${pojo.getMetaAsString(\"examples\")}d \n</code></pre>\n\n<p>in template, it prints \"dd\" only.</p>\n\n<p>Any idea how to pass values to template?</p>\n"},{"tags":["java","hibernate","spring-mvc","spring-transactions"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":90,"score":1,"question_id":12971007,"title":"Howto configure TransactionManager programmatically","body":"<p>Im having an application here based on Spring MVC. My workmate (btw he's not here) configured it programmatically and everything seems to work, except for the TransactionManager. I have never configured a Spring web application like this and I have no clue what to do and also can not find any documentation about how to configure a webapplication like this. </p>\n\n<p>I'll just show you the 'AppInitializer' and the 'EntityManagerConfig'.</p>\n\n<p>AppInitializer:</p>\n\n<pre><code>public class AppInitializer implements WebApplicationInitializer {\n\n@Override\npublic void onStartup(ServletContext servletContext) throws ServletException {\n    AnnotationConfigWebApplicationContext context;\n    ServletRegistration.Dynamic dispatcherServletRegistration;\n    FilterRegistration.Dynamic encodingFilterRegistration, compressionFilterRegistration;\n    Set&lt;SessionTrackingMode&gt; sessionTrackingModes = new HashSet&lt;SessionTrackingMode&gt;();\n\n    sessionTrackingModes.add(SessionTrackingMode.SSL);\n\n    context = new AnnotationConfigWebApplicationContext();\n    context.setServletContext(servletContext);\n    context.scan(\"de.devbliss.doc\");\n\n    servletContext.addListener(new ContextLoaderListener(context));\n    servletContext.addListener(new Log4jConfigListener());\n\n    dispatcherServletRegistration = servletContext.addServlet(\"main\", new DispatcherServlet(context));\n    dispatcherServletRegistration.setLoadOnStartup(1);\n    dispatcherServletRegistration.addMapping(\"/*\");\n\n    encodingFilterRegistration = servletContext.addFilter(\"encodingFilter\", CharacterEncodingFilter.class);\n    encodingFilterRegistration.setInitParameter(\"encoding\", \"UTF-8\");\n    encodingFilterRegistration.setInitParameter(\"forceEncoding\", \"true\");\n    encodingFilterRegistration.addMappingForUrlPatterns(null, false, \"/*\");\n\n    compressionFilterRegistration = servletContext.addFilter(\"compressionFilter\", GzipFilter.class);\n    compressionFilterRegistration.addMappingForUrlPatterns(null, false, \"/*\");\n\n    compressionFilterRegistration = servletContext.addFilter(\"springSecurityFilterChain\",\n            DelegatingFilterProxy.class);\n    compressionFilterRegistration.addMappingForUrlPatterns(null, false, \"/*\");\n\n    servletContext.setSessionTrackingModes(sessionTrackingModes);\n}\n}\n</code></pre>\n\n<p>EntityManagerConfig:</p>\n\n<pre><code>@Configuration\n@PropertySource(\"classpath:/db.properties\")\npublic class EntityManagerConfig {\n\n@Bean\npublic DataSource dataSource(Environment env) {\n    BasicDataSource ds = new BasicDataSource();\n\n    ds.setUrl(env.getProperty(\"url\", \"localhost\"));\n    ds.setUsername(env.getProperty(\"user\", \"blissdoc\"));\n    ds.setPassword(env.getProperty(\"password\", \"s3cret\"));\n\n    return ds;\n}\n\n@Bean\n@Inject\npublic LocalSessionFactoryBean sessionFactory(DataSource dataSource) {\n    LocalSessionFactoryBean factory = new LocalSessionFactoryBean();\n\n    factory.setDataSource(dataSource);\n\n    return factory;\n}\n\n@Bean\npublic HibernateTransactionManager transactionManager(\n        SessionFactory sessionFactory) {\n    HibernateTransactionManager tm = new HibernateTransactionManager(\n            sessionFactory);\n    return tm;\n}\n\n@SuppressWarnings(\"unchecked\")\n@Bean\n@Inject\npublic LocalContainerEntityManagerFactoryBean entityManager(\n        DataSource dataSource, AbstractEnvironment env) {\n    LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean();\n    HibernateJpaVendorAdapter jpaVendorAdapter = new HibernateJpaVendorAdapter();\n    HibernateJpaDialect jpaDialect = new HibernateJpaDialect();\n    org.springframework.core.env.PropertySource&lt;?&gt; source;\n    Iterator&lt;org.springframework.core.env.PropertySource&lt;?&gt;&gt; sources;\n\n    // jpaVendorAdapter.setDatabase(Database.MYSQL);\n\n    jpaVendorAdapter.setGenerateDdl(true);\n    jpaVendorAdapter.setShowSql(true);\n\n    Properties jpaProperties = new Properties();\n\n    sources = env.getPropertySources().iterator();\n    while (sources.hasNext()) {\n        source = sources.next();\n        if (source.getSource() instanceof Map) {\n            for (Map.Entry&lt;String, String&gt; property : ((Map&lt;String, String&gt;) source\n                    .getSource()).entrySet()) {\n                jpaProperties.put(property.getKey(), property.getValue());\n            }\n        }\n    }\n\n    em.setJpaProperties(jpaProperties);\n\n    em.setDataSource(dataSource);\n    em.setPersistenceUnitName(\"blissdoc-unit\");\n    em.setPackagesToScan(\"de.devbliss.doc.model\");\n    em.setJpaDialect(jpaDialect);\n    em.setJpaVendorAdapter(jpaVendorAdapter);\n\n    return em;\n}\n\n// @Bean\n// @Inject\n// public JpaTransactionManager jpaTransactionManager(\n// EntityManagerFactory entityManagerFactory) {\n// JpaTransactionManager tm = new JpaTransactionManager(\n// entityManagerFactory);\n// return tm;\n// }\n\n@Bean\n@Inject\npublic JpaRepositoryFactory jpaRepositoryFactory(\n        EntityManagerFactory entityManagerFactory) {\n    JpaRepositoryFactory factory = new JpaRepositoryFactory(\n            entityManagerFactory.createEntityManager());\n    return factory;\n}\n\n@Bean\n@Inject\npublic UserRepository userRepository(\n        JpaRepositoryFactory jpaRepositoryFactory) {\n    return jpaRepositoryFactory.getRepository(UserRepository.class);\n}\n\n@Bean\n@Inject\npublic ProjectRepository projectRepository(\n        JpaRepositoryFactory jpaRepositoryFactory) {\n    return jpaRepositoryFactory.getRepository(ProjectRepository.class);\n}\n\n}\n</code></pre>\n\n<p>Sorry for this maybe dumb question but I've tried to figure out how this works for hours now and couldn't achieve any helpful information :(\nIf you need more information just let me know please.</p>\n\n<p>Thanks in advance</p>\n\n<p>--- Update\nPersistenceJPAConfig (former EntityManagerConfig):</p>\n\n<pre><code>@Configuration\n@EnableTransactionManagement\n@PropertySource(\"classpath:/db.properties\")\npublic class PersistenceJPAConfig {\n\n@Inject\nprivate Environment env;\n\n@Bean\npublic LocalContainerEntityManagerFactoryBean entityManagerFactoryBean() {\n    LocalContainerEntityManagerFactoryBean factoryBean = new LocalContainerEntityManagerFactoryBean();\n    factoryBean.setDataSource(dataSource());\n    factoryBean.setPackagesToScan(new String[] { \"de.devbliss.doc\" });\n    JpaVendorAdapter vendorAdapter = new HibernateJpaVendorAdapter() {\n        {\n            // JPA properties\n        }\n    };\n    factoryBean.setJpaVendorAdapter(vendorAdapter);\n\n    return factoryBean;\n}\n\n@Bean\npublic DataSource dataSource() {\n    DriverManagerDataSource dataSource = new DriverManagerDataSource();\n    dataSource.setUrl(env.getProperty(\"url\", \"localhost\"));\n    dataSource.setUsername(env.getProperty(\"user\", \"blissdoc\"));\n    dataSource.setPassword(env.getProperty(\"password\", \"s3cret\"));\n    return dataSource;\n}\n\n@Bean\npublic PlatformTransactionManager transactionManager() {\n    JpaTransactionManager transactionManager = new JpaTransactionManager();\n    transactionManager.setEntityManagerFactory(entityManagerFactoryBean()\n            .getObject());\n\n    return transactionManager;\n}\n\n@Bean\npublic PersistenceExceptionTranslationPostProcessor exceptionTranslation() {\n    return new PersistenceExceptionTranslationPostProcessor();\n}\n}\n</code></pre>\n"},{"tags":["spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12971101,"title":"HibernateTemplate vs HibernateDaoSupport vs SessionFactory Injection","body":"<p>I have seen in lot of forums and still in confusion. We are starting a new project with Spring 3.1 &amp; Hibernate 4 and need to decide which strategy to use for Hibernate with Spring:</p>\n\n<ol>\n<li><p>Accessing Hibernate directly</p>\n\n<p>Session session = HibernateUtil.getSessionFactory().getCurrentSessio n();\nsession.beginTransaction();</p></li>\n<li><p>Using HibernateTemplate</p>\n\n<p>List bb = (List)hibernateTemplate.find(\"from cc\");</p></li>\n<li><p>Using HibernateDAOSupport classes </p>\n\n<p>List bb =(List)getHibernateTemplate().find(\"from cc\");</p></li>\n</ol>\n\n<p>Can you please help what should i use? I have read from <a href=\"http://www.coderanch.com/t/501712/Spring/HibernateTemplate-or-HibernateDaoSupport-or-Hibernate\" rel=\"nofollow\">CodeRanch</a> and one another <a href=\"http://www.coderanch.com/t/479938/ORM/databases/Diff-between-Hinernate-Template-HibernateDAOSupport\" rel=\"nofollow\">link</a> which tell that from <strong>Hibernate 3.x</strong> onwards we should inject <code>SessionFactory</code> in our DAO Classes(using <code>@Repository</code>). </p>\n\n<p>Can someone explain this in detail?</p>\n\n<p>Regards,</p>\n\n<p>Arun Kumar</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12969975,"title":"Prevent proxy initialization when accessing @Id field via method with JPA/Hibernate","body":"<p>I'd like to let my entities implement a certain interface, which returns the id:</p>\n\n<pre><code>public interface IdentifiableEntity&lt;T extends Comparable&lt;T&gt;&gt; {\n    public T getIdentifier();\n}\n</code></pre>\n\n<p>But if I do so and the entity is lazy-loaded, <code>getIdentifier()</code> initializes the proxy (and causes a separate select). Here's an example entity:</p>\n\n<pre><code>@Entity\npublic class AppFile implements IdentifiableEntity&lt;Long&gt; {\n\n    @Id\n    @GeneratedValue\n    private Long id;\n\n    public Long getIdentifier() {\n        return id;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    ...\n\n}\n</code></pre>\n\n<p>Is there a way to tell Hibernate/JPA that <code>getIdentifier()</code> only accesses the well-known ID and there is no need to initialize the proxy?</p>\n\n<p>What I already found out:</p>\n\n<ol>\n<li>When I annotate the properties (getters) instead of all fields, <code>getId()</code> will not initialize the proxy.</li>\n<li>Using <code>@Access(AccessType.PROPERTY)</code> on <code>private Long id;</code> it will behave as 1. without the requirement to annotate everything on property level.</li>\n</ol>\n\n<p><strong>UPDATE:</strong>\nBoth 1. and 2. do not satisfy my requirements yet, namely:</p>\n\n<ul>\n<li><code>getIdentifier()</code> returns the id without proxy initialization</li>\n<li>The field <code>id</code> does not change its name (because of a lot of existing JPQL statements).</li>\n</ul>\n"},{"tags":["java","nhibernate","hibernate","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1542,"score":1,"question_id":324105,"title":"Hibernate: Parse/Translate HQL FROM part to get pairs class alias, class name","body":"<p>Can anyone point me out, how can I parse/evaluate HQL and get map where key is table alias and value - full qualified class name.</p>\n\n<p>E.g. for HQL</p>\n\n<blockquote>\n  <p>SELECT a.id from Foo a INNER JOIN a.test b</p>\n</blockquote>\n\n<p>I wish to have pairs:</p>\n\n<p>a, package1.Foo</p>\n\n<p>b. package2.TestClassName</p>\n\n<p>It's relatively easy to do for result set</p>\n\n<blockquote>\n<pre><code>HQLQueryPlan hqlPlan = ((SessionFactoryImpl)sf).getQueryPlanCache().getHQLQueryPlan( getQueryString(), false, ((SessionImpl)session).getEnabledFilters() );\nString[] aliases = hqlPlan.getReturnMetadata().getReturnAliases();\nType[] types = hqlPlan.getReturnMetadata().getReturnTypes();\n</code></pre>\n</blockquote>\n\n<p>See <a href=\"http://www.hibernate.org/389.html\" rel=\"nofollow\">details here</a>.</p>\n"},{"tags":["java","hibernate","orm","eclipselink","ibatis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12960545,"title":"Do any of the JPA implementations (or wider Java ORM implementations) support updatable Cursors","body":"<p>I'm hoping that one of the Object/Relational Mapping (ORM) tools available for Java will meet these requirements:</p>\n\n<ul>\n<li>Use a JPA or native-SQL query to fetch a large number of rows and return them as <strong>entity</strong> objects.</li>\n<li>Allow for iteration through the rows (entities) and persistence of the current entity after I've made change to it.</li>\n</ul>\n\n<p>I want to do perform a complex batch operation (actually I'm comparing and reconciling known-good data from a file against data in my database) row by row. If it was simpler, I'd just resort to using JDBC and execute some SQL; but in this case I really do get benefits from going directly from beans to the database.</p>\n\n<p>In SQL, I could use an updatable cursor to achieve my goal efficiently.</p>\n\n<p>For reference, I'm testing all this out in an embedded Java H2 environment.</p>\n\n<h2>JPA Query</h2>\n\n<p>My first naive attempt was to call on <a href=\"http://docs.oracle.com/javaee/5/api/javax/persistence/Query.html#getResultList%28%29\" rel=\"nofollow\">Query.getResultList()</a> which returns the entity beans fine but they're \"disconnected\". If I call <code>persistenceUnitUtil.getIdentifier(myEntity)</code> then it complains that it's not an entity type.</p>\n\n<h2>Hibernate</h2>\n\n<p>Then I investigated Hibernate which supports <a href=\"http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/ScrollableResults.html\" rel=\"nofollow\">ScrollableResults</a>. The interface allows me to get hold of individual column values by name, but not the entities.</p>\n\n<h2>EclipseLink</h2>\n\n<p>Next up was EclipseLink which supports <a href=\"http://www.eclipse.org/eclipselink/api/2.4/org/eclipse/persistence/queries/ScrollableCursor.html\" rel=\"nofollow\">ScrollableCursor</a>. I held out good hope for this one, using it with:</p>\n\n<pre><code>Query query = entityManager.createQuery(jpaQuery);\nquery.setHint(\"eclipselink.cursor\", true);\nCursoredStream cursoredStream = (CursoredStream)query.getSingleResult();\n</code></pre>\n\n<p>Unfortunately <code>cursoredStream.next();</code> again returns a \"disconnected\" version of the entity. So, I can't see a way to write back to the entity.</p>\n\n<h2>Conclusion</h2>\n\n<p>I'm currently investigating ways to at least get the entity's @Id passed back as part of a query (unfortunately, I want to keep the tool flexible and sometimes I have strings as keys and other times composite key objects). That would at least allow me to iterate through the rows then lookup and persist each entity individually.</p>\n\n<p>But, what I would prefer is to have a cursor-backed iterator that would fetch me a JPA-connected entity and allow me to make changes to it and persist it.</p>\n\n<p>If this isn't a known feature of one of the ORM tools, I'll probably have to give up and resort to good-old-JDBC.</p>\n"},{"tags":["java","sql","database","hibernate","reverse-engineering"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12972556,"title":"Reverse Engineering a Hibernate Database Structure","body":"<p>I'm thinking about writing some code for a project where it is likely that there will be several different hibernate structured databases, about which little or nothing will be known.</p>\n\n<p>The code will ideally be able to receive objects (serialized, transmitted over http) and based on the database connection it has been given, decide if the object fits and if so, persist it.</p>\n\n<p>Is there an established or relatively straightforward way to generate the persistence.xml or the class structure based on access to the database and the metadata?</p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3211,"score":1,"question_id":7706094,"title":"org.hibernate.exception.SQLGrammarException: could not initialize a collection","body":"<p>I have 3 tables tbl_category , tbl_Advertisment and tbl_linkcategoryadvert( having many to many association b/w category &amp; advertisment )</p>\n\n<p>My POJO's as given below</p>\n\n<p><strong>Advertisment.java</strong></p>\n\n<pre><code>@Entity\n@Table(name=\"tbl_advertisment\")\npublic class Advertisment implements Serializable {\n    private long id;\n    private String title;\n    private String message;\n    private Set&lt;Category&gt; categories;\n\n    public Advertisment(String title, String message) {\n        this.title = title;\n        this.message = message;\n        this.categories=new HashSet&lt;Category&gt;();\n    }\n\n    protected Advertisment() {\n    }\n\n    @Id\n    @GeneratedValue\n    protected long getId() {\n        return id;\n    }\n\n    protected void setId(long id) {\n        this.id = id;\n    }\n\n    public String getMessage() {\n        return message;\n    }\n\n    public void setMessage(String message) {\n        this.message = message;\n    }\n\n    @Column(nullable=false)\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    @ManyToMany(mappedBy=\"adverts\")\n    public Set&lt;Category&gt; getCategories() {\n        return categories;\n    }\n\n    public void setCategories(Set&lt;Category&gt; categories) {\n        this.categories = categories;\n    }\n}\n</code></pre>\n\n<p><strong>Category.java</strong></p>\n\n<pre><code>@Entity\n@Table(name=\"tbl_category\")\npublic class Category implements Serializable {\n    private long id;\n    private String title;\n    private Set&lt;Advertisment&gt; adverts=new HashSet&lt;Advertisment&gt;();\n\n    public Category(String title) {\n        this.title = title;\n    }\n\n    protected Category() {\n    }\n\n    @ManyToMany\n    @JoinTable(name=\"tbl_linkcategoryadvert\")\n    public Set&lt;Advertisment&gt; getAdverts() {\n        return adverts;\n    }\n\n    public void setAdverts(Set&lt;Advertisment&gt; adverts) {\n        this.adverts = adverts;\n    }\n\n    public void addAdvert(Advertisment advert){\n        adverts.add(advert);\n    }\n\n    @Id\n    @GeneratedValue\n    protected long getId() {\n        return id;\n    }\n\n    protected void setId(long id) {\n        this.id = id;\n    }\n\n    @Column(unique=true,nullable=false)\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n}\n</code></pre>\n\n<p><strong>PostAdvert.java - Main class</strong></p>\n\n<pre><code>public class PostAdvertisment extends DAO{\n\n    public Advertisment post(String username,String catTitle,String title,String message) \n            throws DAOException {\n        try{\n            begin();\n\n            Query categoryQuery=getSession().createQuery(\"from Category where title=:categoryTitle\");\n            categoryQuery.setString(\"categoryTitle\", catTitle);\n            Category category=(Category)categoryQuery.uniqueResult();\n\n            Advertisment advert=new Advertisment(title,message,user);\n            getSession().save(advert);\n\n            category.addAdvert(advert);     \n            getSession().save(category);\n\n            commit();\n\n            return advert;\n        } catch(HibernateException he){\n            he.printStackTrace();\n            throw new DAOException(he.getMessage());\n        }     \n    }\n\n    public static void main(String[] args){\n\n        String catTitle=\"LCD\";\n        String title=\"Bravia\";\n        String message=\"High Contrast Television\";\n\n        try{\n            PostAdvertisment post=new PostAdvertisment();\n            post.post(username, catTitle, title, message);\n            DAO.close();\n        } catch(DAOException daoEx){\n            System.out.println(daoEx.getMessage());\n        }\n    }\n}\n</code></pre>\n\n<p><strong>DAO.java</strong></p>\n\n<p>I'm not providing DAO.java as it only contains Hibernate boilerplate code.</p>\n\n<p>When I run main class I get following exception:</p>\n\n<pre><code>SEVERE: Unknown column 'adverts0_.categories_id' in 'field list'\norg.hibernate.exception.SQLGrammarException: could not initialize a collection: [hibernate.Category.adverts#3]\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:67)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\n    at org.hibernate.loader.Loader.loadCollection(Loader.java:2001)\n    at org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:36)\n    at org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:565)\n    at org.hibernate.event.def.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:60)\n    at org.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:1716)\n    at org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:344)\n    at org.hibernate.collection.PersistentSet.add(PersistentSet.java:189)\n    at hibernate.Category.addAdvert(Category.java:48)\n    at hibernate.client.PostAdvertisment.post(PostAdvertisment.java:35)\n    at hibernate.client.PostAdvertisment.main(PostAdvertisment.java:56)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'adverts0_.categories_id' in 'field list'\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:409)\n    at com.mysql.jdbc.Util.getInstance(Util.java:384)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1054)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3566)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3498)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1959)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2113)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2568)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2113)\n</code></pre>\n\n<p>Please Help me out....</p>\n\n<hr>\n\n<p>My Tables looks like as :</p>\n\n<p><strong>1. tbl_advert</strong></p>\n\n<pre><code>id PK BIGINT\ntitle VARCHAR(255)\n</code></pre>\n\n<p><strong>2. tbl_category</strong></p>\n\n<pre><code>id PK BIGINT\ntitle VARCHAR(255)\n</code></pre>\n\n<p><strong>3. tbl_linkcategoryadvert</strong></p>\n\n<pre><code>advert_id FK references(advert.id)\ncategory_id FK references(category.id)\n</code></pre>\n\n<p>Now my questions are...</p>\n\n<ol>\n<li>Am i taking wrong names for fields in table \"link_categoryadvert\"?</li>\n<li>how hibernate looks for column names &amp; mappings?</li>\n<li>what are other possible attributes for @JoinTable Annotation?</li>\n</ol>\n"},{"tags":["java","spring","hibernate","jpa","spring-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12966144,"title":"SQL Error: 1366 Incorrect integer value Spring MVC Hibernate","body":"<p>I am having some trouble figuring out why something is not working when trying to persist an object using Springs default Repositories. I am using hibernate as my persistence layer and Spring MVC framework. I use JPA instead of hibernate mapping files. </p>\n\n<p>The error I am seeing is the following:</p>\n\n<pre><code>WARN : org.hibernate.util.JDBCExceptionReporter - SQL Error: 1366, SQLState: HY000\nERROR: org.hibernate.util.JDBCExceptionReporter - Incorrect integer value: '\\xAC\\xED\\x00\\x05sr\\x00!com.kwhours.butternut.domain.Type\\xCF;\\xBF\\xEF\\x8A\\x82\\x87\\xF1\\x02\\x00\\x0DZ\\x00\\x06isLeafI\\x00\\x05levelL\\' for column 'type_id' at row 1\n</code></pre>\n\n<p>I am trying to persist a domain object with JPA annotations the relevant part of that code is:</p>\n\n<pre><code>@Entity\n@Table(name = \"question\")\npublic class Question implements java.io.Serializable {\n    private Type type;\n\n    @Column(name = \"type_id\")\n    public Type getType() {\n        return this.type;\n    }\n\n    public void setType(Type type) {\n        this.type = type;\n    }\n}\n</code></pre>\n\n<p>I have a foreign key constraint properly set up on the question.type_id column to type.id column. I am able to have my objects all properly represented in code but when I try to make the following repository persist the object, I get the afore mentioned error.</p>\n\n<pre><code>public interface QuestionRepository extends CrudRepository&lt;Question, Long&gt; {\n    public List&lt;Question&gt; findByDatasetInstanceId(Long datasetInstanceId);\n}\n</code></pre>\n\n<p>So to be clear. I can make a new question object and retrieve a type object from the db using a repository. I can set questions.type to this new type object but I get that error whenever I try to persist the question which contains that type using the repository above. I checked out the type object in the debugger and there seems to be nothing amiss with it. Any clues or suggestions are helpful. That looks like some kind of escape character sequence but I am not really sure.</p>\n"},{"tags":["hibernate","jboss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12959786,"title":"Hibernate two entity discrimator","body":"<p>I want to create entity Article, Blog and News. This three entities contains the same fields. I want to use one table. I'm doing it with @DiscriminatorValue(\"A\"), @DiscriminatorValue(\"B\"), @DiscriminatorValue(\"N\")\nIt work perfect. Now I need to add new entity Comment. I want to link comment to Article, Blog and News with one field \"TARGET\". Is it possible? Database is Postgresql</p>\n"},{"tags":["spring","hibernate","jpa","jpa-2.0","mule"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12778068,"title":"Mule to JPA compatibility","body":"<p>I using Mule Studio version: 1.3.1 .</p>\n\n<p>buildDate: 201209061215</p>\n\n<p>I am not able to get JPA end point. I also downloaded <code>jpa-connector-1.0-20120925-2201.jar</code>\nBut I dont know to to integrate with mule studio.</p>\n\n<p>So I decided to use a simple Java transformer and write my processing logic which will be internally using JPA/Hibernate.</p>\n\n<p>I came to know that i have to use a JPA vendor adapter for spring, else none of my service, DAO classes will be instantiated.</p>\n\n<p>I have declared a datasource and entityManager as beans of spring inside mule flow xml as shown.</p>\n\n<pre><code>&lt;spring:bean id=\"dataSource\"\n            class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n                &lt;spring:property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\" /&gt;\n                &lt;spring:property name=\"url\" value=\"jdbc:mysql://localhost:3306/eigDB\" /&gt;\n                &lt;spring:property name=\"username\" value=\"root\" /&gt;\n                &lt;spring:property name=\"password\" value=\"tiger\" /&gt;\n        &lt;/spring:bean&gt;\n\n        &lt;spring:bean id=\"entityManagerFactory\"\n        class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n        &lt;spring:property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;spring:property name=\"persistenceUnitName\" value=\"autoRebateSystem\" /&gt;\n        &lt;spring:property name=\"jpaVendorAdapter\"&gt;\n            &lt;spring:bean\n                class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n                &lt;spring:property name=\"databasePlatform\" value=\"org.hibernate.dialect.Oracle10gDialect\" /&gt;\n                &lt;spring:property name=\"showSql\" value=\"true\" /&gt;\n            &lt;/spring:bean&gt;\n</code></pre>\n\n<p>But mule flow xml is not able to recognize any class of spring framework.\nFinding very difficult to replace those class names.</p>\n\n<p>Plez provide the solution for my problem, \nBy letting me know the PROPER replacements for mule studio.</p>\n\n<pre><code>1) org.springframework.jdbc.datasource.DriverManagerDataSource\n2) org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\n3) org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\n</code></pre>\n"},{"tags":["java","hibernate","jar"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12970573,"title":"How to get a jar with source attachment for Hibernate?","body":"<p>We just upgraded our old Hibernate (3.*) to the newest release and after half an hour of searching I was not able to find a .jar file with source attachment of Hibernate 4.1.7. Do you have any ideas where can it be found? I tried sourceforge, Hibernate's official page and I checked out Github too. It will be also fine if you point me out some tutorials about building a jar file with source attachment.</p>\n"},{"tags":["java","database","hibernate","jpa","java-ee"],"answer_count":5,"favorite_count":8,"up_vote_count":13,"down_vote_count":0,"view_count":22279,"score":13,"question_id":297438,"title":"Auto generate data schema from JPA annotated entity classes","body":"<p>I'm using JPA (Hibernate's implementation) to annotate entity classes to persist to a relational database (MySQL or SQL Server). Is there an easy way to auto generate the database schema (table creation scripts) from the annotated classes?</p>\n\n<p>I'm still in the prototyping phase and anticipate frequent schema changes. I would like to be able to specify and change the data model from the annotated code. Grails is similar in that it generates the database from the domain classes.</p>\n"},{"tags":["hibernate","spring-batch"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":12968076,"title":"Bulk inserts with Hibernate 3.5","body":"<p>How can I perform following operation with hibernate 3.5</p>\n\n<pre><code>INSERT INTO Table (Column1, Column2 ) VALUES\n(Value1, Value2), (Value1, Value2)\n</code></pre>\n"},{"tags":["java","hibernate","java-ee","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12969308,"title":"Any problems in using hibernate's session.connection() to run native sql","body":"<p>In my project, they use Hibernate's session the below mentioned way and then save entity objects with in a <strong>transaction</strong>. </p>\n\n<pre><code>Session session = HibernateUtil.getCurrentSession();\nsession.beginTransaction();\n\nEmployee employee = new Employee() ;\n\nemployee.setName(\"someName\") ;\nemployee.setEmailId (\"someId\")\nemployee.setID (100000) ;\n\nsession.saveOrUpdate(employee) ;\n\nsession.getTransaction().commit();\n</code></pre>\n\n<p>Now for few functionality I decided to run native SQL. Below is the way i used to run native sql. I wanted to run the queries with-in a transaction and so i decided to write the code the below way</p>\n\n<pre><code>String query = \"select name from master_employee where id=?\"\n\nSession session = HibernateUtil.getCurrentSession();\nsession.beginTransaction();\n\nConnection connection = session.connection();\nPreparedStatement psStmt = connection.prepareStatement(query);\npsStmt.setInt(1,id) ;\n\nResultSet resultSet = psStmt.executeQuery();\n// here i will take data from this result set\npsStmt.close();\nresultSet.close() ;\n\n// I am not closing the connection object since am taking it from hibernate session\n// rather i commit hibernate's transaction\nsession.getTransaction().commit();\n</code></pre>\n\n<p>Is this the right way ?? will the transaction's still be managed ?? taking the connection object from session cannot be managed in to the transaction ????</p>\n\n<p>Please tell if there any problems in using this way ??? thanks</p>\n"},{"tags":["java","hibernate","jpa","persistence"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12969089,"title":"Entities not mapped when persistence unit is on EAR level","body":"<p>I need an EAR java application in which I can define a persistence unit and use that persistence unit in different components. For example: I define 2 JAR's in my application.xml: my-product.jar and my-product-module.jar - both of the JAR files should be able to work with the same PersistenceUnit. This PersistenceUnit is defined in a separate jar which is the lib folder of my EAR application.\nIn the JAR files, there's no other persistence.xml. So in the whole EAR folder: only 1 persistence.xml.</p>\n\n<p>I currently have the following EAR structure. We are deploying on a JBoss 6.1.0.Final server.</p>\n\n<pre><code>/\n-- lib\n|    |\n|    -- my-persistence.jar\n|           |\n|           -- META-INF\n|                  |\n|                  -- persistence.xml\n-- my-product.jar\n|\n-- my-product.war\n|\n-- my-product-module.jar\n</code></pre>\n\n<p>My persistence.xml is looking like this:</p>\n\n<pre><code>&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n             xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n             xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"\n             version=\"2.0\"&gt;\n    &lt;persistence-unit name=\"MyPersistenceUnitName\"&gt;\n                &lt;jta-data-source&gt;java:/MyDatasource&lt;/jta-data-source&gt;\n                &lt;jar-file&gt;../my-product.jar&lt;/jar-file&gt;\n                &lt;jar-file&gt;../my-product-module.jar&lt;/jar-file&gt;    \n                &lt;properties&gt;\n                    &lt;property name=\"jboss.entity.manager.factory.jndi.name\" value=\"java:/MyProduct/ManagerFactory\" /&gt;\n                    &lt;property name=\"jboss.entity.manager.jndi.name\" value=\"java:/MyProduct/EntityManager\" /&gt;\n            &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;  \n</code></pre>\n\n<p>All of this is working fine. The persistence unit gets detected and bounded inside the EAR context.\nBut, from the moment we create a JPA query and we ask the EntityManager to perform the query, we get the following error:</p>\n\n<pre><code>org.hibernate.hql.ast.QuerySyntaxException: MyEntity is not mapped [from MyEntity]\n</code></pre>\n\n<p>So all of our entities are not mapped/detected when the application was loaded. It seems like the jar-file element is not doing what it should do.</p>\n\n<p>How can we detect all of our entities (in both of our JAR's)?\nAnybody able to help us out?</p>\n"},{"tags":["hibernate","multitenancy","hibernate-filters"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12894357,"title":"Hibernate: Discriminator based multi tenancy using filter?","body":"<p>I have read several articles (i.e. <a href=\"https://community.jboss.org/wiki/Multi-tenancyDesign\" rel=\"nofollow\">this</a> and <a href=\"http://www.devx.com/Java/Article/47817/0/page/2\" rel=\"nofollow\">that</a> and <a href=\"http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch16.html\" rel=\"nofollow\">that</a>) on the web regarding multi tenancy (for different clients in a SaaS application). Once you have decided to go for the discriminator based approach, the <a href=\"http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch16.html\" rel=\"nofollow\">hibernate doc states</a>, that this is not supported in version 4, but will come in version 5.</p>\n\n<p>Nevertheless, you may find several articles about using hibernate filters for that purpose (i.e. <a href=\"http://www.devx.com/Java/Article/47817/0/page/2\" rel=\"nofollow\">this</a> and <a href=\"https://community.jboss.org/wiki/Multi-tenancyDesign\" rel=\"nofollow\">that</a>).</p>\n\n<p>I am wondering, why there will be some special implementation for it in version 5, if a filter based solution would be fine. Thus: What are the drawbacks of the filter based solution? (I have <a href=\"https://hibernate.onjira.com/browse/HHH-6054\" rel=\"nofollow\">read</a> (see comment from 06/Dec/11) that they do not work with find statements. But no other souce seems to approve that. Is this true?)</p>\n"},{"tags":["oracle","hibernate","foreign-keys","composite-key"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12964216,"title":"Oracle composite key deletion very slow","body":"<p>I have one table with a composite key (REGION) and another table (CITY) that references that table. Inserts, queries, and individual deletions work quickly. The problem is that when I try to bulk-delete the contents of CITY using sqlplus, delete from CITY, it takes forever. This table will have ~400,000 entries and it takes 15-20 minutes just to delete 50,000 entries. Here is my setup using Oracle 11:</p>\n\n<pre><code>create table COUNTRY\n(\n  id varchar2(32) NOT NULL -- PK\n...\n);\n\ncreate table REGION -- about 4000 entries\n(\n  country    varchar2(32) NOT NULL -- PK, FK to COUNTRY\n  regionCode char(2)      NOT NULL -- PK\n...\n);\n\ncreate table CITY -- about 400,000 entries\n(\n  id            number       NOT NULL -- PK\n  country       varchar2(32) NOT NULL -- FK to COUNTRY\n  regionCountry varchar2(32) NULL     -- FK to REGION\n  regionCode    char(2)      NULL     -- FK to REGION\n...\n);\n\ncreate table LOCATION -- about 2,500,000 entries\n(\n  id       varchar2(32) NOT NULL -- PK\n  country  varchar2(32) NOT NULL -- FK to COUNTRY\n  city     number       NULL     -- FK to CITY\n...\n);\n\n\n\nALTER TABLE COUNTRY ADD CONSTRAINT PK_COUNTRY PRIMARY KEY (id) USING INDEX;\n\nALTER TABLE REGION ADD CONSTRAINT PK_REGION PRIMARY KEY (country, regionCode) USING INDEX;\n\nALTER TABLE CITY ADD CONSTRAINT PK_CITY PRIMARY KEY (id) USING INDEX;\n\nALTER TABLE IPGeoLoc ADD CONSTRAINT PK_LOCATION PRIMARY KEY (id) USING INDEX;\n\n\n\nALTER TABLE REGION ADD CONSTRAINT FK_REGION_COUNTRY\n   FOREIGN KEY (country) REFERENCES COUNTRY (id);\n\nALTER TABLE CITY ADD CONSTRAINT FK_CITY_COUNTRY\n   FOREIGN KEY (country) REFERENCES COUNTRY (id);\n\nALTER TABLE CITY ADD CONSTRAINT FK_CITY_REGION\n   FOREIGN KEY (regionCountry, regionCode) REFERENCES REGION (country, regionCode);\n\nALTER TABLE LOCATION ADD CONSTRAINT FK_LOCATION_COUNTRY\n   FOREIGN KEY (country) REFERENCES COUNTRY (id);\n\nALTER TABLE LOCATION ADD CONSTRAINT FK_LOCATION_CITY\n   FOREIGN KEY (city) REFERENCES CITY (id);\n</code></pre>\n\n<p>The varchar2(32) fields are GUIDs. I know I should not use GUIDs as a PK but I cannot change that unless I have proof that this is the problem.</p>\n\n<p>I can bulk-delete entries from LOCATION with no problem, 300,000 in a couple of seconds, so this leads me to believe it is the composite key that is giving me trouble.</p>\n\n<p>The secondary issue is that I currently have two country columns in the CITY table - one linked directly to COUNTRY and the other linked as part of the composite key to REGION. I know how I would do this in code and only have one country column but I have to use Hibernate. This works the way it is except for the delete problem so I can't change it unless I can prove this is causing an issue. I'm using sqlplus to try the deletions so I know Hibernate is not causing the delete problem.</p>\n"},{"tags":["java","hibernate","validation","form-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12965049,"title":"How to allow javax.validation to be ignored in some cases","body":"<p>Given the following class</p>\n\n<pre><code>public class Website {\n\n    @NotNull\n    String owner:\n\n    @ValidUrl\n    String url;\n\n}\n</code></pre>\n\n<p>When we validate that (e.g. using @Valid) and if Website.url does not respect my custom @ValidUrl constraint we'll get an constraint violation (e.g. \"url is unreachable\").</p>\n\n<p>I was wondering if it is possible to ignore that validation if the user wants to.</p>\n\n<p>Steps:</p>\n\n<ol>\n<li>Validate form for the 1st time</li>\n<li>Throw constraint violation and show it to the user </li>\n<li>User chooses \"I know, add it anyway\" and re-submit</li>\n<li>Validate form for the 2nd time, validating everything except @ValidUrl</li>\n</ol>\n"},{"tags":["hibernate","plugins","struts2","stackoverflowerror"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":813,"score":0,"question_id":6182067,"title":"java.lang.StackOverflowError when invoking action from Struts2 action tag","body":"<p>I have dccr.jsp file that calls an action via the  tag:</p>\n\n<pre><code>&lt;s:action name=\"query-privilege\" executeResult=\"false\" var=\"privilege\"&gt;\n            &lt;s:param name=\"moduleid\"&gt;9&lt;/s:param&gt;\n            &lt;s:param name=\"privilege\"&gt;v&lt;/s:param&gt;\n            &lt;s:param name=\"pagename\"&gt;dccr&lt;/s:param&gt;\n&lt;/s:action&gt;\n</code></pre>\n\n<p>i use this action to query module privileges amongst users, like this:</p>\n\n<pre><code>&lt;s:if test=\"%{#privilege.allowable == false}\"&gt;\n       //do something\n&lt;/s:if&gt;\n</code></pre>\n\n<p>Here's my Action Support Class:</p>\n\n<pre><code>    private String pagename;\n    private String moduleid;\n    private boolean allowable;\n    private String privilege;\n    private final UsertypeModuleDAO umodDao = (UsertypeModuleDAO) ServletActionContext.getServletContext().getAttribute(\"usermoduleDAO\");\n\n    //loggers, session properties etc.\n\n@Action(value = \"/query-privilege\", results = {\n        @Result(name = \"SUCCESSdccr\", location = \"/dccr.jsp\"),\n        @Result(name = \"ERROR\", location = \"../error/messages.jsp\")\n    })\n    @Override\n    public String execute() {\n        try {\n            char p = privilege.charAt(0);\n            int i = Integer.parseInt(moduleid);\n            allowable = queryPrivilege(i, p);\n            logger.info(privilege+\", \"+moduleid+\", \"+ut.getUsertypeid()+\", \"+allowable);\n            return SUCCESS + pagename;\n        } catch (Exception e) {\n            if (emps != null) {\n                logger.fatal(\"(\" + emps.getIdnumber() + \"):\" + e.getLocalizedMessage(), e);\n            } else {\n                logger.fatal(e.getLocalizedMessage(), e);\n\n            }\n            e.printStackTrace();\n            addActionError(e.getLocalizedMessage());\n            return ERROR;\n        }\n    }\n\n    private boolean queryPrivilege(int moduleid, char privilege) {\n        DetachedCriteria criteria = DetachedCriteria.forClass(UsertypeModule.class);\n        criteria.createCriteria(\"usertypes\", \"ut\").setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);\n        criteria.createCriteria(\"modules\", \"m\").setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);\n        criteria.add(Restrictions.eq(\"m.moduleid\", moduleid));\n        criteria.add(Restrictions.eq(\"ut.usertypeid\", ut.getUsertypeid()));\n        UsertypeModule um = umodDao.getPrivilege(criteria);\n        logger.info(um.getModulename());\n        boolean p = false;\n        switch (privilege) {\n            case 'v': p = um.isViewable();\n                break;\n            case 'e': p = um.isEditable();\n                break;\n            case 'c': p = um.isCreateable();\n                break;\n            case 'd': p = um.isDeleteable();\n                break;\n        }\n        return p;\n    }\n\n//getters and setters\n</code></pre>\n\n<p>And here's my code in my Data Access Object: 'umodDao':</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\n    public UsertypeModule getPrivilege(DetachedCriteria dc){\n        Criteria criteria = dc.getExecutableCriteria(session);\n        criteria.setMaxResults(1);\n        return (UsertypeModule) criteria.uniqueResult();\n    }\n</code></pre>\n\n<p>When i run my project and navigate to dccr.jsp I get this error:</p>\n\n<pre><code>May 31, 2011 8:34:52 AM org.apache.catalina.core.ApplicationDispatcher invoke\nSEVERE: Servlet.service() for servlet jsp threw exception\njava.lang.StackOverflowError\n    at java.util.HashMap.get(HashMap.java:300)\n    at java.lang.Package.getSystemPackage(Package.java:491)\n    at java.lang.Package.getPackage(Package.java:313)\n    at java.lang.Class.getPackage(Class.java:698)\n    at com.googlecode.s2hibernate.struts2.plugin.interceptors.SessionTransactionInjectorInterceptor.isCandidadeClass(SessionTransactionInjectorInterceptor.java:313)\n    at com.googlecode.s2hibernate.struts2.plugin.interceptors.SessionTransactionInjectorInterceptor.injectHibernateCoreSession(SessionTransactionInjectorInterceptor.java:340)\n    at com.googlecode.s2hibernate.struts2.plugin.interceptors.SessionTransactionInjectorInterceptor.injectHibernateCoreSession(SessionTransactionInjectorInterceptor.java:361)\n</code></pre>\n\n<p>Yeah, Im using FHP(Full Hibernate Plugin 1.4GA) and my Servlet Container is Tomcat 7.0 on netbeans 7.0. I've been stuggling for days but kept failing at each attempt, The stacktraces point to FHP Plugin's SessionTransactionInjectorInterceptor.injectHibernateCoreSession method. Please help me or just say anything that may shed some light.</p>\n\n<hr>\n\n<p>I have a suspicion that this problem had to do something with my tomcat policy, because when i upgraded to fhp 2.2GA I still came across with stackoverflowerror however</p>\n\n<p><code>java.security.AccessController.doPrivileged(Native Method</code>) </p>\n\n<p>is already included in the stacktrace. But this is only a suspicion. I cannot continue my work because of this problem so I am thinking of reverting my project's to the most recent working revision in order to continue my work and eventually commit my changes when I am able to fix this persistent problem.</p>\n"},{"tags":["java","hibernate","orm","jpa","jpa-2.0"],"answer_count":8,"favorite_count":22,"up_vote_count":48,"down_vote_count":0,"view_count":57454,"score":48,"question_id":306144,"title":"JPA CascadeType.ALL does not delete orphans","body":"<p>I am having trouble deleting orphan nodes using JPA with the following mapping</p>\n\n<pre><code>@OneToMany (cascade = CascadeType.ALL, fetch = FetchType.EAGER, mappedBy = \"owner\")\nprivate List&lt;Bikes&gt; bikes;\n</code></pre>\n\n<p>I am having the issue of the orphaned roles hanging around the database.</p>\n\n<p>I can use the annotation <em>org.hibernate.annotations.Cascade</em> Hibernate specific tag but obviously I don't want to tie my solution into a hibernate implementation.</p>\n\n<p>Any pointers greatly appreciated.</p>\n\n<p><strong>EDIT</strong>: It seems JPA 2.0 will include support for this, which I am very happy about.</p>\n"},{"tags":["java","spring","hibernate","annotations","inner-classes"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":103,"score":5,"question_id":12955201,"title":"Hibernate session within inner class","body":"<p>I have an issue with getting session on anonymus inner class in hibernate with spring session factory.\nHere is the code:</p>\n\n<pre><code>public class DomainDaoImpl extends BasicDaoImpl&lt;Domain&gt; implements Iterable&lt;Collection&lt;Domain&gt;&gt; {\n\n...\n\n@Override\npublic Iterator&lt;Collection&lt;Domain&gt;&gt; iterator() {\n    return (new Iterator&lt;Collection&lt;Domain&gt;&gt;() {\n        private int counter = 0;\n        public static final int LIMIT = 100;\n\n        ...\n\n        @Override\n        @Transactional(readOnly = true)\n        public Collection&lt;Domain&gt; next() {\n            final Criteria criteria = getCurrentSession().createCriteria(Domain.class);\n            final LinkedHashSet&lt;Domain&gt; result = new LinkedHashSet&lt;Domain&gt;();\n\n            List resultList = null;\n            while (!(resultList = criteria.list()).isEmpty()) {\n                criteria.setFirstResult((counter++ * LIMIT) + 1);\n                criteria.setMaxResults(LIMIT);\n                result.addAll(resultList);\n            }\n            return result;\n        }\n\n        ...\n    });\n</code></pre>\n\n<p>The issue is <em>org.hibernate.HibernateException: No Session found for current thread</em>\nthis happens usually when DAO method is not within transaction.\nSo how to make it work with an inner class?</p>\n"},{"tags":["hibernate","join","jpa-2.0","criteria-api"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12960593,"title":"In hibernate using CriteriaBuilder how to add condition to left join immediately and not as part of where condition?","body":"<p>I want criteriabuilder to put AND condition immediately with join (1st left join in below query).\nBut When I put condition in predicate it adds if to final where clause.</p>\n\n<p>I want output like this:</p>\n\n<pre>\n\n    select\n            *\n        from\n            milestone milestone0_ \n        left outer join\n            disc_user_milestone_watch userswatch1_ \n                on milestone0_.id=userswatch1_.milestone_id AND userswatch1_.disc_user_id=2  \n        left outer join\n            disc_user discuser2_ \n                on userswatch1_.disc_user_id=discuser2_.id cross \n        join\n            campaign campaign3_ cross \n        join\n            department department4_ \n        where\n            milestone0_.campaign=campaign3_.id \n            and milestone0_.department=department4_.id;\n\n</pre>\n\n<p>But after putting condition in predicate I get that AND condition in final where clause.\nCurrently I am getting like this:</p>\n\n<pre>\n\n    select\n            *\n        from\n            milestone milestone0_ \n        left outer join\n            disc_user_milestone_watch userswatch1_ \n                on milestone0_.id=userswatch1_.milestone_id   \n        left outer join\n            disc_user discuser2_ \n                on userswatch1_.disc_user_id=discuser2_.id cross \n        join\n            campaign campaign3_ cross \n        join\n            department department4_ \n        where\n            milestone0_.campaign=campaign3_.id \n            and milestone0_.department=department4_.id \n            AND userswatch1_.disc_user_id=2;\n</pre>\n\n<p>What is a way to add AND condition immediately to join ?</p>\n\n<p>My current code looks like this:</p>\n\n<pre>\n\n    EntityManager em = Milestone.entityManager();\n    CriteriaBuilder criteriaBuilder = em.getCriteriaBuilder();\n    CriteriaQuery criteriaQuery = criteriaBuilder.createQuery(UserMilestoneWatchStatus.class);\n\n    Root milestoneRoot = criteriaQuery.from(Milestone.class);\n    Join milestonediscUserJoin = milestoneRoot.join(\"usersWatching\", JoinType.LEFT);\n\n    // this is used for extending the milestone table to the user table\n    Expression userId = milestonediscUserJoin.get(\"id\"); // id\n    int currUserId = Integer.parseInt(params.get(\"currUserId\").toString());\n\n    milestoneRoot.alias(\"x\");\n    criteriaQuery.select(criteriaBuilder.construct(UserMilestoneWatchStatus.class, milestoneRoot, userId));\n    criteriaQuery.distinct(true);\n\n    List predicatesList = new ArrayList();\n    predicatesList.add(criteriaBuilder.or(criteriaBuilder.equal(userId, currUserId), criteriaBuilder.isNull(userId)));\n\n    criteriaQuery.where(criteriaBuilder.and(predicatesList.toArray(new Predicate[predicatesList.size()]))).orderBy(sort);\n\n</pre>\n\n<p>Whats is way to add AND condition immediately to join and not in where ?</p>\n"},{"tags":["java","sql","hibernate","orm","group-by"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":12947098,"title":"How to select a list of objects as part of the constructor argument for a Hibernate group by query","body":"<p>I'm trying to figure out how to select a list of objects as part of a Hibernate group-by query. I know how to do it a harder way, but I'm curious if there is some special sugar syntax that achieves the same thing.</p>\n\n<p>Basically, I have a query of this structure:</p>\n\n<pre><code>select com.myapp.domain.TagSummary(\n   tag.id, tag.term, tag.description, tag.synonyms, count(user)\n)\nfrom User user\n   join user.tags tag\n</code></pre>\n\n<p>I'd like to store the <code>tag.synonyms</code> as a <code>List&lt;Tag&gt;</code>. Is that possible, or do I need to query the cross product and do the separation manually after the query results come back?</p>\n\n<p>Alternatively, what I really want in the end is a list of synonym terms separated by commas. So if a tag is <code>spring</code> and it has synonym terms <code>spring-framework</code> and <code>spring-framework-3.1</code>, it would be great to put into the constructor the string <code>spring-framework, spring-framework-3.1</code>. Is that possible?</p>\n\n<p><strong>EDIT</strong>: I have learned that I can use group_concat() to achieve the second half of the functionality, but it's only available in MySQL. Is there a way to make it available in hsqldb as well? In Spring 3.1, how do I add this function to Hibernate? I know I should call something on <code>Configuration</code>, but I don't know what bean to access it by.</p>\n"},{"tags":["sql","hibernate","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12956409,"title":"null value in column violates not-null constraint","body":"<p>I have sql error null value in column \"kladr_full_name\" violates not-null constraint.</p>\n\n<p>Table in database to wich request is performed: </p>\n\n<pre><code>СREATE TABLE kladr.kladr_name\n(\n  kladr_code character varying(255) NOT NULL,\n  kladr_city_name character varying(121),\n  kladr_full_name character varying(487) NOT NULL,\n  kladr_index character varying(6),\n  kladr_name character varying(100) NOT NULL,\n  kladr_naspunkt_name character varying(121),\n  kladr_rayon_name character varying(121),\n  kladr_region_name character varying(121),\n  kladr_socr character varying(20),\n  CONSTRAINT kladr_name_pkey PRIMARY KEY (kladr_code )\n)\nWITH (\n  OIDS=FALSE\n);\nALTER TABLE kladr.kladr_name\n  OWNER TO postgres;\n</code></pre>\n\n<p>Request to db:</p>\n\n<pre><code>    INSERT INTO kladr.kladr_name \n            (kladr_code, \n             kladr_name, \n             kladr_socr, \n             kladr_index, \n             kladr_region_name, \n             kladr_rayon_name, \n             kladr_city_name, \n             kladr_naspunkt_name, \n             kladr_full_name) \nSELECT kladr_code, \n       Upper(kladr_name)                 kladr_name, \n       kladr_socr, \n       kladr_index, \n       (SELECT k1.kladr_socr \n               ||' ' \n               ||k1.kladr_name \n        FROM   kladr.kladr_tmp k1 \n        WHERE  k1.kladr_region = k.kladr_region \n               AND k1.kladr_rayon = '000' \n               AND k1.kladr_city = '000' \n               AND k1.kladr_nas_punkt = '000' \n               AND k1.kladr_mod = '00' \n               AND k1.kladr_status = '0')kladr_region_name, \n       (SELECT k1.kladr_socr \n               ||' ' \n               ||k1.kladr_name \n        FROM   kladr.kladr_tmp k1 \n        WHERE  k1.kladr_region = k.kladr_region \n               AND k1.kladr_rayon = k.kladr_rayon \n               AND k1.kladr_rayon &lt;&gt; '000' \n               AND k1.kladr_city = '000' \n               AND k1.kladr_nas_punkt = '000' \n               AND k1.kladr_name = '00') kladr_rayon_name, \n       (SELECT k1.kladr_socr \n               ||' ' \n               ||k1.kladr_name \n        FROM   kladr.kladr_tmp k1 \n        WHERE  k1.kladr_region = k.kladr_region \n               AND k1.kladr_rayon = k.kladr_rayon \n               AND k1.kladr_city = k.kladr_city \n               AND k1.kladr_city &lt;&gt; '000' \n               AND k1.kladr_nas_punkt = '000' \n               AND k1.kladr_mod = '00')  kladr_city_name, \n       (SELECT k1.kladr_socr \n               ||' ' \n               ||k1.kladr_name \n        FROM   kladr.kladr_tmp k1 \n        WHERE  k1.kladr_region = k.kladr_region \n               AND k1.kladr_rayon = k.kladr_rayon \n               AND k1.kladr_city = k.kladr_city \n               AND k1.kladr_nas_punkt = k.kladr_nas_punkt \n               AND k1.kladr_nas_punkt &lt;&gt; '000' \n               AND k1.kladr_mod = '00')  kladr_naspunkt_name, \n       (SELECT k1.kladr_socr \n               ||' ' \n               ||k1.kladr_name \n        FROM   kladr.kladr_tmp k1 \n        WHERE  k1.kladr_region = k.kladr_region \n               AND k1.kladr_rayon = '000' \n               AND k1.kladr_city = '000' \n               AND k1.kladr_nas_punkt = '000' \n               AND k1.kladr_mod = '00' \n               AND k1.kladr_status = '0') \n       ||' ' \n       ||(SELECT k1.kladr_socr \n                 ||' ' \n                 ||k1.kladr_name \n          FROM   kladr.kladr_tmp k1 \n          WHERE  k1.kladr_region = k.kladr_region \n                 AND k1.kladr_rayon = k.kladr_rayon \n                 AND k1.kladr_rayon &lt;&gt; '000' \n                 AND k1.kladr_city = '000' \n                 AND k1.kladr_nas_punkt = '000' \n                 AND k1.kladr_mod = '00') \n       ||' ' \n       ||(SELECT k1.kladr_socr \n                 ||' ' \n                 ||k1.kladr_name \n          FROM   kladr.kladr_tmp k1 \n          WHERE  k1.kladr_region = k.kladr_region \n                 AND k1.kladr_rayon = k.kladr_rayon \n                 AND k1.kladr_city = k.kladr_city \n                 AND k1.kladr_city &lt;&gt; '000' \n                 AND k1.kladr_nas_punkt = '000' \n                 AND k1.kladr_mod = '00') \n       ||' ' \n       ||(SELECT k1.kladr_socr \n                 ||' ' \n                 ||k1.kladr_name \n          FROM   kladr.kladr_tmp k1 \n          WHERE  k1.kladr_region = k.kladr_region \n                 AND k1.kladr_rayon = k.kladr_rayon \n                 AND k1.kladr_city = k.kladr_city \n                 AND k1.kladr_nas_punkt = k.kladr_nas_punkt \n                 AND k1.kladr_nas_punkt &lt;&gt; '000' \n                 AND k1.kladr_mod = '00')kladr_full_name \nFROM   kladr.kladr_tmp k \nWHERE  k.kladr_mod = '00' \n</code></pre>\n\n<p>DB postgreSql. jpa prov hibernate. What could be the reason of this?</p>\n\n<p>Question now is how to modify this query to work in postgres(before it was working in oracle db) if some subquerys returns null?</p>\n"},{"tags":["hibernate","glassfish","log4j","slf4j"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":87,"score":-3,"question_id":12939554,"title":"Hibernate 4.1.1 logging with log4j(1.2.17) and sl4fj(1.7.2) under GlassFish Server","body":"<p>Dudes, I was using hibernate 3.5 with log4j and slf4. And it was working, logging and binding parameter values. So I updated the hibernate for 4.1.1 version, and after this the log4 doesn't log any information about hibernate(And doesn't show the SQL parameter values). I know the new version use the jboss logging, but I've tried to remove and did not work. I am using GlassFish 3.1.1.2(build5). In my libs i have:</p>\n\n<pre><code>-commons-logging\n-slf4j-log4j\n-log4j(1.2.17)\n-slf4j-api(1.7.2)\n</code></pre>\n\n<p>Follow my log4j.properties and hibernate.cfg</p>\n\n<p>hibernate.cfg</p>\n\n<pre><code>&lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n&lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt;\n</code></pre>\n\n<p>log4.properties</p>\n\n<pre><code># Direct log messages to a log file\nlog4j.appender.file=org.apache.log4j.RollingFileAppender\nlog4j.appender.file.File=D:\\\\teste.log\nlog4j.appender.file.MaxFileSize=1MB\nlog4j.appender.file.MaxBackupIndex=1\nlog4j.appender.file.layout=org.apache.log4j.PatternLayout\nlog4j.appender.file.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n\n\n# Direct log messages to stdout\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.Target=System.out\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n\n\n# Root logger option\nlog4j.rootLogger=INFO, file, stdout\n\n# Log everything. Good for troubleshooting\nlog4j.logger.org.hibernate=INFO\n\nlog4j.logger.org.hibernate.type=ALL\nlog4j.logger.org.hibernate.jdbc=trace\n</code></pre>\n\n<p>So, its works for other things as you can see my teste.log :</p>\n\n<pre><code>13:52:36,692  INFO AbstractTilesApplicationContextFactory:76 - Initializing Tiles2     application context. . .\n13:52:36,707  WARN ChainedTilesApplicationContextFactory:117 - Cannot find    TilesContextFactory class   org.apache.tiles.portlet.context.PortletTilesApplicationContextFactory\n13:52:36,707  INFO AbstractTilesApplicationContextFactory:95 - Finished initializing Tiles2 application context.\n13:52:36,708  WARN ChainedTilesApplicationContextFactory:117 - Cannot find TilesContextFactory class org.apache.tiles.portlet.context.PortletTilesApplicationContextFactory\n13:52:36,770  WARN TilesContainerFactory:365 - DEPRECATION WARNING! You are using parameter-based initialization, that is no longer supported! Please see docs:  http://tiles.apache.org/framework/tutorial/configuration.html\n13:52:36,771  INFO TilesContainerFactory:372 - Initializing Tiles2 container. . .\n13:52:36,774  WARN ChainedTilesApplicationContextFactory:117 - Cannot find TilesContextFactory class org.apache.tiles.portlet.context.PortletTilesApplicationContextFactory\n13:52:36,780  INFO ChainedTilesRequestContextFactory:105 - Cannot find TilesRequestContextFactory class org.apache.tiles.portlet.context.PortletTilesRequestContextFactory, skipping support for the managed platform\n13:52:36,836  WARN BaseLocaleUrlDefinitionDAO:209 - Unable to find configured definition '/WEB-INF/tiles.xml'\n13:52:36,907  INFO TilesContainerFactory:382 - Tiles2 container initialized\n13:52:36,909  INFO TilesAccess:113 - Publishing TilesContext for context: org.apache.tiles.servlet.context.ServletTilesApplicationContext\n</code></pre>\n\n<p>But, the hibernate showing the informations in server stdout as follows. I dont know what the hibernate is using for show it, if i remove the jboss logging, it keep showing</p>\n\n<pre><code>Informações: Hibernate: \nselect\n    this_.cobs_id as cobs1_5_0_,\n    this_.cobs_attributes as cobs2_5_0_,\n    this_.cobs_description as cobs3_5_0_,\n    this_.cobs_name as cobs4_5_0_,\n    this_.cobs_position as cobs5_5_0_,\n    this_.cobs_sequence as cobs6_5_0_,\n    this_.cobs_status as cobs7_5_0_,\n    this_.cobs_template as cobs8_5_0_,\n    this_.cobs_cosi_id as cobs9_5_0_ \nfrom\n    core.core_blocks this_ \nwhere\n    this_.cobs_cosi_id=? \n    and not exists (\n        select\n            1 \n        from\n            core.core_groups_blocks \n        where\n            this_.cobs_id=cogb_cobs_id\n    ) \norder by\n    this_.cobs_sequence asc\nInformações: Hibernate: \n</code></pre>\n\n<p>Checking my server stdout i found this:</p>\n\n<pre><code>Informações: HHH000046: Connection properties: {user=root, password=****}\nInformações: HHH000006: Autocommit mode: false\n</code></pre>\n\n<p>Probably hibernate is using other log for register the informations, but  i cant find it</p>\n"},{"tags":["java","hibernate","struts2","proxool"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":209,"score":0,"question_id":8711034,"title":"proxool runed some hours，then it gives me the exceptions","body":"<p>these are my configuration below:</p>\n\n<pre><code>proxool.xml:\n\n&lt;something-else-entirely&gt;  \n        &lt;proxool&gt;  \n            ... ...\n            &lt;maximum-connection-count&gt;100&lt;/maximum-connection-count&gt;    \n            &lt;minimum-connection-count&gt;10&lt;/minimum-connection-count&gt;    \n            &lt;maximum-active-time&gt;6000000&lt;/maximum-active-time&gt;  \n            &lt;house-keeping-sleep-time&gt;120000&lt;/house-keeping-sleep-time&gt;  \n            &lt;maximum-new-connections&gt;10&lt;/maximum-new-connections&gt;    \n            &lt;prototype-count&gt;5&lt;/prototype-count&gt;    \n            &lt;test-before-use&gt;true&lt;/test-before-use&gt;  \n            &lt;house-keeping-test-sql&gt;select CURRENT_DATE&lt;/house-keeping-test-sql&gt;  \n        &lt;/proxool&gt;  \n    &lt;/something-else-entirely&gt;\n</code></pre>\n\n<p>and the exceptions:</p>\n\n<pre><code>Struts Problem Report\nStruts has detected an unhandled exception: \nMessages:   \nCouldn't perform the operation prepareStatement: You can't perform any operations on this connection. It has been automatically closed by Proxool for some reason (see logs).\nFreeMarker template error!\n\n\nMethod public java.lang.String org.hibernate.exception.NestableRuntimeException.getMessage(int) threw an exception when invoked on org.hibernate.exception.GenericJDBCException: could not execute query\nThe problematic instruction:\n----------\n==&gt; ${msg[0]} [on line 68, column 29 in org/apache/struts2/dispatcher/error.ftl]\n----------\n\nJava backtrace for programmers:\n----------\nfreemarker.template.TemplateModelException: Method public java.lang.String org.hibernate.exception.NestableRuntimeException.getMessage(int) threw an exception when invoked on org.hibernate.exception.GenericJDBCException: could not execute query\n    at freemarker.ext.beans.SimpleMethodModel.exec(SimpleMethodModel.java:130)\n    at freemarker.ext.beans.SimpleMethodModel.get(SimpleMethodModel.java:138)\n    at freemarker.core.DynamicKeyName.dealWithNumericalKey(DynamicKeyName.java:111)\n      ... ... \nCaused by: java.lang.NullPointerException\n    at freemarker.ext.beans.SimpleMemberModel.unwrapArguments(SimpleMemberModel.java:85)\n    at freemarker.ext.beans.SimpleMethodModel.exec(SimpleMethodModel.java:106)\n    ... 44 more\n</code></pre>\n\n<p>tomcat6.0+mysql5.0+struts2+hibernate3.1。</p>\n\n<p>could you please tell me how to solve the problem? thank you very much!</p>\n"},{"tags":["java","hibernate","automation","code-generation","pojo"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1995,"score":1,"question_id":308860,"title":"hibernate auto-discovery and generation of of database mappings to POJOs","body":"<p>Are there any tools that auto-generate the hibernate POJOs by gathering information from the database?</p>\n\n<p>I made a perl script to do this after the schema got changed for the third or fourth time in a project i'm working with and just wondered if there is any established tool that will do this for me as my script is rather crude and needs some tweaking of the generated <code>.java</code> and <code>.hbm.xml</code> files.</p>\n\n<p>For example (based on what my script does), having a table <code>statement</code>:</p>\n\n<pre><code>Object_Name  Type_Name Base_Type Nulls Identity\n------------ --------- --------- ----- --------\nid           id_int    int       no    yes\nid_user      id_tiny   tinyint   no    no\nvalue        float     float     no    no\n</code></pre>\n\n<p>I would like the program to autogenerate the following java:</p>\n\n<pre><code>package com.some.company.schema;\n\nimport java.io.Serializable;\n\npublic class Statement implements Serializable {\n    private static final long serialVersionUID = 1227171190L;\n    private Integer id;\n    private User user;\n    private Float value;\n\n    public void setId(Integer id){\n        this.id = id;\n    }\n\n    public Integer getId(){\n        return this.id;\n    }\n\n    public void setUser(User user){\n        this.user = user;\n    }\n\n    public User getUser(){\n        return this.user;\n    }\n\n    public void setValue(Float value){\n        this.value = value;\n    }\n\n    public Float getValue(){\n        return this.value;\n    }\n}\n</code></pre>\n\n<p>And the corresponding Hibernate mapping file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC\n        \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n        \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.some.company.schema.Statement\" table=\"statement\"&gt;\n        &lt;id name=\"id\" column=\"id\"&gt;\n            &lt;generator class=\"native\" /&gt;\n        &lt;/id&gt;\n        &lt;many-to-one name=\"user\" class=\"com.some.company.schema.User\" column=\"id_user\" not-null=\"true\" /&gt;\n        &lt;property name=\"value\" column=\"value\" not-null=\"true\" /&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n"},{"tags":["java","hibernate","criteria-api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":12956645,"title":"Problems with Hibernate Criteria API (Disjunction and Conjunction)","body":"<p>I have a problem with using <code>Conjunction</code>s and <code>Disjunction</code>s. My program receives an arbitrary number of filter elements (each representing a <code>Criterion</code>) from the ui and is intended to chain together them as an <code>AND</code> or <code>OR</code>.</p>\n\n<p>So for example I can have 3 elements like this (I represent a <code>Criterion</code> with a letter):</p>\n\n<pre><code>a OR b AND c\n</code></pre>\n\n<p>My code looks like this:</p>\n\n<pre><code>    // ...\n    Criteria rootCriteria = createCriteria(entityClass);\n    Conjunction conjunction = Restrictions.conjunction();\n    Disjunction disjunction = Restrictions.disjunction();\n    boolean isFirst = true;\n    for (InternalFilterElement element : elements) {\n        if (isFirst) {\n            isFirst = false;\n            rootCriteria.add(createCriterion(element.getFilterRelation(), element.getValue()));\n        } else if (InternalFilterOperand.AND.equals(element.getInternalFilterOperand())) {\n            addCriterionToJunction(conjunction, element);\n        } else {\n            addCriterionToJunction(disjunction, element);\n        }\n    }\n    rootCriteria.add(disjunction);\n    rootCriteria.add(conjunction);\n    // ...\n</code></pre>\n\n<p>My problem is that I always get <code>a AND b AND c</code> and some unnecessary parentheses.</p>\n\n<p><em><strong>What I really wish to know is that I am using the wrong tool for this task or not? How can I mix <code>AND</code> and <code>OR</code> operators?</em></strong></p>\n\n<p><strong>edit</strong></p>\n\n<p><code>InternalFilterOperand</code> is basically an <code>enum</code> containing <code>OR</code> and <code>AND</code></p>\n\n<p><code>addCriterionToJunction</code> just adds a <code>Criterion</code> to the <code>Junction</code> based on the relation (&lt;, >, ...) and the value. It does not have any side effects.</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":33,"score":-3,"question_id":12953223,"title":"Can I access data hibernate has written to its temporary files?","body":"<p>Hibernate writes date to java.io.tmpdir as it caches. I tried to open file in that directory but could not find anything relevant.</p>\n\n<p>Is there a way to get all objects present in cache?</p>\n\n<p>Or is there a way to open the cache and see what objects are present in it?</p>\n"},{"tags":["hibernate","session","grails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12957329,"title":"Grails: Getting/solving \"Could not synchronize database state with session\"?","body":"<p>The root of this question is, what can cause the failure to synchronize?  Is this a generic message that just means \"something went wrong\" or is there something actually wrong with the session itself?  <strong>There are a handful of threads with similar titles but none seem to actually address why hibernate is failing to synchronize the session</strong>, it's just part of the error message that's ignored by people.</p>\n\n<p>My specific case/details (though it's really tangential to the above question):</p>\n\n<p>During a data import (20-120 minutes) I'm doing a large amount of processing. Persistence doesn't begin until the entire set of domain objects have been built and validated for consistency.  Over this time, I build somewhere around 200,000 domain objects.  At the end of the process, it loops across them all saving them to the database and (for performance reasons) flushing/clearing the session after every 50 or 100 objects.  Once persistence begins, the Domain objects do not get changed.</p>\n\n<p>This is all happening within a single service call, a single transaction.  I also cannot reproduce this on my test system, it has only happened in production.</p>\n\n<p>I am using <code>domainObj.save()</code> rather than <code>session.saveOrUpdate(domainObj)</code>, the only time I manually touch the session at all is flushing/cleaning it after a set of updates:</p>\n\n<pre><code>def session = sessionFactory.currentSession\nsession.flush()\nsession.clear()\n</code></pre>\n\n<p>This is the place where the exception gets thrown.</p>\n\n<p>Immediately following the failed to sync message is (presumably the result, but maybe relevant to the cause):</p>\n\n<pre><code>Could not execute JDBC batch update; SQL [insert into domainB(field1, field2, etc) values (?, ?, ?)];  \nnested exception is org.hibernate.exception.ConstrainViolationException: Could not execute JDBC batch update\n</code></pre>\n\n<p>I realize this ConstrainViolation (yes, \"constrain\" not \"constraint\") appears to be a data error, but the dataset has been working, and without change to either the import file or the code, began throwing this error.  It also continues to work on other systems, so I have ruled out data error to a relatively certain degree.</p>\n\n<p>I'm almost positive the same objects are getting saved multiple times due to the nature of the object relationships.  That's another spot for performance improvement, but I think is unrelated since once the object gets saved, it should have its ID assigned and being re-saved shouldn't cause an error.</p>\n\n<p>I've digressed into rambling and speculation at this point, I don't want someone to solve my problem for me, but hopefully someone knows something explicitly about synchronizing the session and not \"have you made sure you're not inserting duplicate data?\" because I am as certain as I can be (iterating over a Hashmap.keySet() using the constrained unique field as the key to lookup the domain object to save).</p>\n"},{"tags":["java","spring","hibernate","open-session-in-view"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12941751,"title":"Open Session In Conversation Implementations","body":"<p>Until now I have been using my own OpenSessionInConversation filter which basically tracks a cookie that has a UUID which I use as a key in a map of Hibernate Sessions.</p>\n\n<p>This approach is giving me trouble when I want to know when to close a Hibernate Session. I set my servlet container (tomcat for testing and glassfish for production) session timeout to 30 mins and I use a HttpSessionListener to close Hibernate Sessions. But as I'm using Spring Security, when my users log in or log out Spring destroys the HttpSession and creates a new One, then my previous Hibernate Session is still open and I have to create a new one for the newly open HttpSession.</p>\n\n<p>UPDATE: The idea is to close the hibernate session when the cookie expires i.e. about 30 minutes that the browser shuts-down, not when the user logins or logs out.</p>\n\n<p>So, I have configured spring with session fixation protection with this:</p>\n\n<pre><code> &lt;!-- Sessions --&gt;\n        &lt;sec:session-management\n            session-fixation-protection=\"migrateSession\"&gt;\n            &lt;sec:concurrency-control max-sessions=\"1\"\n                session-registry-alias=\"springSessionRegistry\" expired-url=\"/login/?expired=true\"\n                error-if-maximum-exceeded=\"true\" /&gt;\n        &lt;/sec:session-management&gt;\n</code></pre>\n\n<p>As you can see, Spring will invalidate (and migrate) the current session when a user login or logout. So my HttpSessionListener is called when the user logins to invalidate the former session (and I don't want to close the Hibernate Session in this moment) and when the session expires (thats the moment when I want to close the Hibernate Session).</p>\n\n<p>Is there a better way to implement this functionality?</p>\n\n<p>OK, here is what I got:</p>\n\n<pre><code>public class OpenSessionInViewInsideConversationFilter extends\n          OncePerRequestFilter {\n\n     protected static final Logger log = LoggerFactory\n               .getLogger(OpenSessionInViewInsideConversationFilter.class);\n\n     public OpenSessionInViewInsideConversationFilter() {\n\n     }\n\n     @Override\n     protected void doFilterInternal(HttpServletRequest request,\n               HttpServletResponse response, FilterChain filterChain)\n               throws ServletException, IOException {\n\n          UUID conversationId = lookupConversationOrCreateIfNecessary(request,\n                    response);\n\n          if ( !ConversationManager.isConversationOpen(conversationId) ) {\n               log.debug(\"Conversation for this request already expired, restarting.\");\n               ConversationManager.restartConversation(conversationId);\n          }\n\n          ConversationManager\n                    .bindConversationToRequest(conversationId, request);\n          log.debug(\"Binding conversation '{}' to Request\", conversationId);\n\n          try {\n\n               filterChain.doFilter(request, response);\n\n          } finally {\n\n               log.debug(\"Unbinding conversation from request '{}'\", request);\n               ConversationManager.unbindConversationToRequest(request);\n\n          }\n\n     }\n\n     private UUID lookupConversationOrCreateIfNecessary(\n               HttpServletRequest request, HttpServletResponse response) {\n          UUID conversationId = null;\n\n          conversationId = lookupConversationIdOnCookies(request);\n\n          if ( conversationId == null ) {\n               conversationId = startNewConversationAndStoreCookie(request,\n                         response);\n          }\n          return conversationId;\n     }\n\n     private UUID startNewConversationAndStoreCookie(\n               HttpServletRequest request, HttpServletResponse response) {\n          UUID conversationId;\n          log.debug(\"No conversation cookie found in request {}, creating new conversation.\",\n                    request);\n\n          conversationId = ConversationManager.createNewConversation();\n\n          Cookie cookie = new Cookie(\n                    Constantes.ACTIVE_CONVERSATION_COOKIE_NAME,\n                    conversationId.toString());\n\n          cookie.setMaxAge(-1); // It will expire after browser shut-down\n\n          response.addCookie(cookie);\n          return conversationId;\n     }\n\n     private UUID lookupConversationIdOnCookies(HttpServletRequest request) {\n\n          if ( request.getCookies() == null || request.getCookies().length == 0 )\n               return null;\n\n          UUID conversationId = null;\n\n          for (Cookie cookie : request.getCookies()) {\n               if ( cookie.getName().equals(\n                         Constantes.ACTIVE_CONVERSATION_COOKIE_NAME) ) {\n                    log.debug(\"Conversation cookie found in request {}.\",\n                              request);\n                    conversationId = UUID.fromString(cookie.getValue());\n                    break;\n               }\n          }\n\n          return conversationId;\n     }\n}\n</code></pre>\n\n<p>Conversation Manager:</p>\n\n<pre><code>    public class ConversationManager {\n\n        private static Map&lt;UUID, Session&gt; conversationMap = new HashMap&lt;UUID, Session&gt;();\n\n        private static Map&lt;HttpServletRequest, UUID&gt; requestMap = new HashMap&lt;HttpServletRequest, UUID&gt;();\n\n        private static Session defaultSession = null;\n\n        private static SessionFactoryImplementor factory = null;\n\n        public static UUID createNewConversation() {\n\n            UUID conversationId = UUID.randomUUID();\n\n            Session sessionForConversation = factory.openSession();\n\n            conversationMap.put(conversationId, sessionForConversation);\n\n            return conversationId;\n        }\n\n        public static Session getSessionFromConversation(UUID conversationId) {\n            return conversationMap.get(conversationId);\n        }\n\n        public static void bindConversationToRequest(UUID conversationId, HttpServletRequest request) {\n            requestMap.put(request, conversationId);\n        }\n\n        public static UUID getConversationForRequest(HttpServletRequest request) {\n            return requestMap.get(request);\n        }\n\n        public static Session getSessionForRequest(HttpServletRequest request) {\n            UUID conversationId = ConversationManager.getConversationForRequest(request);\n            return conversationMap.get(conversationId);\n        }\n\n        public static UUID unbindConversationToRequest(HttpServletRequest request) {\n            UUID conversationId = requestMap.remove(request);\n            return conversationId;\n        }\n\n        public static void endConversation(UUID conversationId) {\n            Session session = conversationMap.remove(conversationId);\n            session.close();\n        }\n\n        public static void endDefaultConversation() {\n            defaultSession.close();\n            defaultSession = null;\n        }\n\n        public static Session getDefaultConversationSession() {\n            return defaultSession;\n        }\n\n        public static void startDefaultConversation(Session defaultSession) {\n            ConversationManager.defaultSession = defaultSession;\n        }\n\n        public static boolean isConversationOpen(UUID conversationID) {\n            return conversationMap.containsKey(conversationID);\n        }\n\n        public static void restartConversation(UUID conversationId) {\n            Session sessionForConversation = factory.openSession();\n            conversationMap.put(conversationId, sessionForConversation);\n        }\n\n        public static SessionFactoryImplementor getFactory() {\n            return factory;\n        }\n\n        public static void setFactory(SessionFactoryImplementor factory) {\n            ConversationManager.factory = factory;\n        }\n\n    }\n</code></pre>\n\n<p>Conversation Hibernate Context</p>\n\n<pre><code>public class ConversationalCurrentSessionContext implements CurrentSessionContext {\n\n    private static final long serialVersionUID = 803157986557235023L;\n\n    protected static final Logger log = LoggerFactory\n            .getLogger(ConversationalCurrentSessionContext.class);\n\n    public ConversationalCurrentSessionContext() {\n\n    }\n\n    public ConversationalCurrentSessionContext(SessionFactoryImplementor sessionFactoryImplementor) {\n        ConversationManager.setFactory(sessionFactoryImplementor);\n    }\n\n    @Override\n    public Session currentSession() throws HibernateException {\n\n        HttpServletRequest request = null;\n\n        try {\n            request = JsfUtils.getCurrentHttpRequest();\n        } catch (Exception e) {\n            log.debug(\"No current faces context found, returning default conversation.\");\n        }\n\n        if (request == null) {\n            return (Session) ConversationManager.getDefaultConversationSession();\n        } else {\n            return (Session) ConversationManager.getSessionForRequest(request);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["java","hibernate","hibernate-mapping"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":12952243,"title":"Configured SessionFactory: null","body":"<p>I have created basic hibernate application. It throw error message.</p>\n\n<p><strong>Error is:</strong></p>\n\n<pre><code>     Oct 18, 2012 3:36:13 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: Hibernate 3.2.5\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: hibernate.properties not found\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Environment buildBytecodeProvider\nINFO: Bytecode provider name : cglib\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Environment &lt;clinit&gt;\nINFO: using JDK 1.4 java.sql.Timestamp handling\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Configuration configure\nINFO: configuring from resource: /hibernate.cfg.xml\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Configuration getConfigurationInputStream\nINFO: Configuration resource: /hibernate.cfg.xml\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : com/crmcall/entity/CallUsers.hbm.xml\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nINFO: Mapping class: com.crmcall.entity.CallUsers -&gt; crmcallusers\nOct 18, 2012 3:36:13 PM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : com/crmcall/entity/Customers.hbm.xml\nOct 18, 2012 3:36:14 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nINFO: Mapping class: com.crmcall.entity.Customers -&gt; crmcustomermaster\nOct 18, 2012 3:36:14 PM org.hibernate.cfg.Configuration addResource\nINFO: Reading mappings from resource : com/crmcall/entity/User.hbm.xml\nOct 18, 2012 3:36:14 PM org.hibernate.cfg.HbmBinder bindRootPersistentClassCommonValues\nINFO: Mapping class: com.crmcall.entity.User -&gt; crmusers\nOct 18, 2012 3:36:14 PM org.hibernate.cfg.Configuration doConfigure\nINFO: Configured SessionFactory: null\nInitial SessionFactory creation failed.org.hibernate.MappingException: component class not found: string\nException in thread \"main\" java.lang.ExceptionInInitializerError\n        at com.crmcall.util.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:27)\n        at com.crmcall.dao.UserDAO.&lt;init&gt;(UserDAO.java:23)\n        at com.crmcall.dao.UserDAO.main(UserDAO.java:36)\nCaused by: org.hibernate.MappingException: component class not found: string\n        at org.hibernate.mapping.Component.getComponentClass(Component.java:104)\n        at org.hibernate.tuple.component.PojoComponentTuplizer.buildGetter(PojoComponentTuplizer.java:133)\n        at org.hibernate.tuple.component.AbstractComponentTuplizer.&lt;init&gt;(AbstractComponentTuplizer.java:43)\n        at org.hibernate.tuple.component.PojoComponentTuplizer.&lt;init&gt;(PojoComponentTuplizer.java:38)\n        at org.hibernate.tuple.component.ComponentEntityModeToTuplizerMapping.&lt;init&gt;(ComponentEntityModeToTuplizerMapping.java:52)\n        at org.hibernate.tuple.component.ComponentMetamodel.&lt;init&gt;(ComponentMetamodel.java:50)\n        at org.hibernate.mapping.Component.buildType(Component.java:152)\n        at org.hibernate.mapping.Component.getType(Component.java:145)\n        at org.hibernate.mapping.SimpleValue.isValid(SimpleValue.java:253)\n        at org.hibernate.mapping.RootClass.validate(RootClass.java:193)\n        at org.hibernate.cfg.Configuration.validate(Configuration.java:1102)\n        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1287)\n        at com.crmcall.util.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:24)\n        ... 2 more\nCaused by: java.lang.ClassNotFoundException: string\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:276)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:169)\n        at org.hibernate.util.ReflectHelper.classForName(ReflectHelper.java:100)\n        at org.hibernate.mapping.Component.getComponentClass(Component.java:101)\n</code></pre>\n\n<p>This is my Hibernate.cfg.xml file:</p>\n\n<pre><code>     &lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://192.168.1.5:3306/crmtest&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;root&lt;/property&gt;\n    &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;create-drop&lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"format_sql\"&gt;true&lt;/property&gt;\n    &lt;!-- Enable Hibernate automatic session context management --&gt;\n    &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n\n        &lt;!-- Disable the second-level cache  --&gt;\n   &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;\n\n    &lt;mapping resource=\"com/crmcall/entity/CallUsers.hbm.xml\"/&gt;\n    &lt;mapping resource=\"com/crmcall/entity/Customers.hbm.xml\"/&gt;\n    &lt;mapping resource=\"com/crmcall/entity/User.hbm.xml\"/&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>This is my User.hbm.xml</p>\n\n<pre><code>    &lt;hibernate-mapping&gt;\n  &lt;class name=\"com.crmcall.entity.User\" table=\"crmusers\"&gt;\n      &lt;composite-id name=\"userPK\" &gt;\n           &lt;key-property name=\"businessUnit\" column=\"BusinessUnit\" type=\"string\"/&gt;\n           &lt;key-property name=\"userID\" column=\"UserID\" type=\"string\"/&gt;\n      &lt;/composite-id&gt;\n\n        &lt;property name=\"recID\" &gt;\n          &lt;column name=\"RecID\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"password\"&gt;\n          &lt;column name=\"Password\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"userName\"&gt;\n          &lt;column name=\"UserName\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"userType\"&gt;\n          &lt;column name=\"UserType\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"userLevel\"&gt;\n          &lt;column name=\"UserLevel\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"customerCode\"&gt;\n          &lt;column name=\"CustomerCode\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"customerCodeson\"&gt;\n          &lt;column name=\"CustomerCodeson\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"locationCode\"&gt;\n          &lt;column name=\"LocationCode\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"lastUpdatedBy\"&gt;\n          &lt;column name=\"LastUpdatedBy\"/&gt;\n        &lt;/property&gt;\n\n        &lt;property name=\"lastUpdatedOn\" type=\"timestamp\"&gt;\n          &lt;column name=\"LastUpdatedOn\"/&gt;\n        &lt;/property&gt;\n\n      &lt;property name=\"email\" type=\"string\"&gt;\n          &lt;column name=\"Email\"/&gt;\n        &lt;/property&gt;\n\n  &lt;/class&gt;\n\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>This is my calling place :</p>\n\n<pre><code>     public class UserDAO {\n    private Session session = null;\n\n    public UserDAO() {\n        session =  HibernateUtil.currentSession();\n    }\n\n     public List&lt;User&gt; getAllUsers() {\n        Transaction tn = session.beginTransaction();\n        List&lt;User&gt; users = session.createQuery(\"from crmusers cu order by cu.UserID\").list();\n        System.out.println(\"==\" + users.size());\n        tn.commit();\n        return users;\n    }\n\n\n     public static void main(String[] args){\n         UserDAO userDAO = new UserDAO();\n         userDAO.getAllUsers();\n     }\n}\n</code></pre>\n\n<p>This is my project folder structre:\n<img src=\"http://i.stack.imgur.com/ozoOc.png\" alt=\"enter image description here\"></p>\n\n<p>Please tell me what is an issue in my code?</p>\n\n<p>Thanks in advance..</p>\n"},{"tags":["spring","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":150,"score":1,"question_id":12635205,"title":"Spring JPA/Hibernate in standalone app","body":"<p>I am utilizing spring in non web application and I am using hibernate for working with DB. Problem I am experiencing is that while \"registerShutdownHook();\" does close spring context container it does not properly shut down and close resources for JPA so my connections to DB are getting maxed out.</p>\n\n<pre><code>&lt;bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"persistenceUnitName\" value=\"pu\" /&gt;\n    &lt;property name=\"jpaVendorAdapter\"&gt;\n        &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n            &lt;property name=\"generateDdl\" value=\"false\" /&gt;\n            &lt;property name=\"showSql\" value=\"false\" /&gt;\n            &lt;property name=\"databasePlatform\" value=\"org.hibernate.dialect.MySQL5Dialect\" /&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n    &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n&lt;bean class=\"org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor\" /&gt;\n\n&lt;bean class=\"org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor\"/&gt;\n</code></pre>\n\n<p>I use configuration presented above to fire up JPA layer and use \"@Transactional\" annotations to inject EM's into DAO's.</p>\n\n<p>Maybe someone could help me out what am I missing or how should I handle proper closing of JPA sessions in standalone environment ?</p>\n\n<p>Thank you,</p>\n\n<p>P.S. Exception I am getting is: java.net.SocketException: No buffer space available (maximum connections reached?): connect</p>\n"},{"tags":["java","hibernate","orm","apache-cayenne"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":290,"score":4,"question_id":2334146,"title":"Is cayenne good choice for my requirement?","body":"<p>We are evaluating ORM solutions for my project that has tight coupling between business layer and datalayer(JDBC). I started doing a PoC with Cayenne. My requirement goes like this\na) Already there exists database schema\nb) Schema is very granular level. I.e. real time java objects are only derived by combining tables.\nc) At the moment I just want to perform read operation (to be precise filter and sort on a list by inputing criteria)</p>\n\n<p>Till now, the observations I have made with Cayenne are\n1) Table and Object are tightly coupled. Modeler is not allowing to create java object without associated table.\n2) I could not find easy way to map output of a named query to a java object so that I get list in a way application needs.\n3) Also I am not sure Expressions work with named queries.</p>\n\n<p>I would like to know your inputs on best choice for my requirement?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["hibernate","hbm2ddl"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12946044,"title":"Hibernate hbm2ddl issue","body":"<p>I'm developing a new hibernate project. By defining <code>*.hbm.xml</code> I want to generate java class and SQL query. I have done that. I am not able to generate alter table query upon setting <code>hbm2ddl.auto</code> property to update. I have tried this in persistence.xml file and also in hibernate.cfg.xml file. Also tried with true in pom.xml from , that did not work. Please share your thoughts on this. When this update is set to true in <code>pom.xml</code> hbm2ddl goal does not generate the query too.</p>\n"},{"tags":["java","hibernate","hbm2java"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12953532,"title":"Hibernate hbm2java","body":"<p>I am generating annotated pojos via hibernate code generation in eclipse. Classes are generated fine, but class for views are composed of @EmbeddedId and i dont want that. I want to have attributes directly in this class. I found an option \"Generate basic typed composite ids\" in generation dialog, but when i uncheck it, it would generate view classes with  @EmbeddedId too, but will not generate corresponding  Id classes. Is there a way to generate these classes without  @EmbeddedId? </p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":12949239,"title":"Hibernate raising \"NullPointerException\" on when setting a parameter to a @Filter","body":"<p>I am having a very weird problem. I am using Hibernate 4.1.7 with Postgres 9.1. In my entity class I defined a filter using annotation:</p>\n\n<pre><code>@FilterDef(name = \"filterName\", parameters=@ParamDef(name=\"paramInt\", type=\"integer\" ))\n</code></pre>\n\n<p>Then I added the @Filter to the collection. If the filter is defined this way:</p>\n\n<pre><code>@OneToMany(cascade = CascadeType.ALL, mappedBy = \"linkField\")\n@Filter(name = \"filterName\", condition = \"fieldVal=0\")\nprivate Collection&lt;ChildClass&gt; children;\n</code></pre>\n\n<p>Everything works properly, the collection is properly filtered and I see only the children whose fieldVal is 0. If, on the other hand, I do:</p>\n\n<pre><code>@OneToMany(cascade = CascadeType.ALL, mappedBy = \"linkField\")\n@Filter(name = \"filterName\", condition = \"fieldVal=:paramInt\")\nprivate Collection&lt;ChildClass&gt; children;\n</code></pre>\n\n<p>and I set the parameter in my code, the \"filter\" is properly set (inspecting it in the debugger) but, when accessing the collection, it raises the following exception:</p>\n\n<pre><code>java.lang.NullPointerException: \n    at org.hibernate.engine.spi.QueryParameters.processFilters(QueryParameters.java:492)\n    at org.hibernate.engine.spi.QueryParameters.processFilters(QueryParameters.java:462)\n    at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1688)\n    at org.hibernate.loader.Loader.doQuery(Loader.java:832)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:293)\n    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:263)\n    at org.hibernate.loader.Loader.loadCollection(Loader.java:2094)\n    at org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:61)\n    at org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:678)\n    at org.hibernate.event.internal.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:82)\n    at org.hibernate.internal.SessionImpl.initializeCollection(SessionImpl.java:1801)\n    at org.hibernate.collection.internal.AbstractPersistentCollection$4.doWork(AbstractPersistentCollection.java:524)\n    at org.hibernate.collection.internal.AbstractPersistentCollection.withTemporarySessionIfNeeded(AbstractPersistentCollection.java:212)\n    at org.hibernate.collection.internal.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:520)\n    at org.hibernate.collection.internal.AbstractPersistentCollection.read(AbstractPersistentCollection.java:125)\n    at org.hibernate.collection.internal.AbstractPersistentCollection$1.doWork(AbstractPersistentCollection.java:152)\n    at org.hibernate.collection.internal.AbstractPersistentCollection$1.doWork(AbstractPersistentCollection.java:139)\n    at org.hibernate.collection.internal.AbstractPersistentCollection.withTemporarySessionIfNeeded(AbstractPersistentCollection.java:212)\n    at org.hibernate.collection.internal.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:138)\n    at org.hibernate.collection.internal.PersistentBag.size(PersistentBag.java:242)\n</code></pre>\n\n<p>I am out of ideas, I have been trying to figure out what it can be for days, searched everywhere to no avail. Anybody has a clue on what can be?</p>\n\n<p>Thanks!</p>\n\n<p>Edited: made more clear when the exception was raised</p>\n"},{"tags":["hibernate","unit-testing","transactions","junit4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12916014,"title":"Test DAO in java using Junit4 and Hibernate","body":"<p>Testing DAO'm using junit and mainly what I do is start a transaction in hibernate, call the compare function, and then roll back the transaccion.El problem is that if I'm Testing function is a transaction error I can not strip nest, I thought about the idea of ​​implementing DBUnit xml but management does not seem a good idea and less in this instance that I did enough test cases with this method.\nAnyone have any idea how to fix it without having to use anything other than Junit or hibernate?</p>\n\n<p>This is a example</p>\n\n<pre><code>@Test\npublic void Test1GetByCodigo(){\n    String cod = \"999999999\";\n    DBTenant dbTenant = null; \n    Session sess = null;\n    Transaction trans = null;\n    ClienteBO cli = null;\n    Clientes clie = null;\n    try{\n        try{\n            dbTenant = new DBTenant();\n            sess = dbTenant.getTenantSession();\n            trans = sess.beginTransaction();\n        }\n        catch(Exception e){\n            fail(\"Error en la carga de la transaccion.Quedo alguna transaccion abierta?\");\n        }   \n        clie  = CargaCliente(cod);\n        sess.save(clie);\n        cli = cliBL.getByCodigo(cod);\n    }\n    catch(Exception e){\n        trans.rollback();\n        dbTenant.closeSession();\n        fail(\"Error la carga del cliente.Se modifico la bse de datos Clientes??\");\n    }\n    trans.rollback();\n    sess.clear();\n    dbTenant.closeSession();\n    ClienteBO clieEsp = CargaClienteBO(clie);\n    assertNotNull(clieEsp);\n    assertNotNull(cli);\n    assertEquals(\"Error el cliente no coincide\",clieEsp,cli);\n}\n</code></pre>\n\n<p>if cliBL.getbycodigo function () tubiera a transaction would have a bug, thank you for your help thanks</p>\n"},{"tags":["hibernate","jpa","jdbc"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12950747,"title":"jpa mapping java type to database type","body":"<p>Every JPA-Provider (at least hibernate, eclipselink and openjpa) gives the possibility to create the ddl-schema on the basis of the jpa entity classes. But every database management system has his own data types. </p>\n\n<p>So how do the jpa-providers decide which sql datatype will be chosen. (I think it will be provider specific). Is there a Mapping like <code>String-&gt;varchar(xx), boolean-&gt;tinyint</code> and so on. But then this mapping has to be exist for every database, right?  Can anyone put me in the right direction please? I searched in the hibernate source-code but I did not find the right code snippets. </p>\n\n<p>Thanks!</p>\n"},{"tags":["hibernate","logging","hibernate-4.x","jboss-logging"],"answer_count":4,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":505,"score":5,"question_id":11639997,"title":"How do you configure logging in Hibernate 4?","body":"<p>Hibernate 3.x used <a href=\"/questions/tagged/slf4j\" class=\"post-tag\" title=\"show questions tagged 'slf4j'\" rel=\"tag\">slf4j</a> for logging. Hibernate 4.x uses <a href=\"/questions/tagged/jboss-logging\" class=\"post-tag\" title=\"show questions tagged 'jboss-logging'\" rel=\"tag\">jboss-logging</a>. I am writing a standalone application which uses Hibernate 4, and SLF4J for logging.</p>\n\n<p>How can i configure Hibernate to log to SLF4J?</p>\n\n<p>If that's not possible, how can i configure Hibernate's logging at all?</p>\n\n<p>The Hibernate manual's <a href=\"http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch03.html#configuration-logging\">section on logging</a> starts with the warning that it is ...</p>\n\n<blockquote>\n  <p>Completely out of date. Hibernate uses JBoss Logging starting in 4.0. This will get documented as we migrate this content to the Developer Guide.</p>\n</blockquote>\n\n<p>... goes on to talk about SLF4J, and so is useless. Neither the <a href=\"http://docs.jboss.org/hibernate/orm/4.1/quickstart/en-US/html/\">getting started guide</a> nor the <a href=\"http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/\">developer guide</a> talk about logging at all. Nor does the <a href=\"https://community.jboss.org/wiki/HibernateCoreMigrationGuide40\">migration guide</a>.</p>\n\n<p>I have looked for documentation on jboss-logging itself, but i haven't been able to find any at all. The <a href=\"https://github.com/jboss-logging/jboss-logging\">GitHub page is silent</a>, and JBoss's <a href=\"http://www.jboss.org/projects\">community projects page</a> doesn't even list jboss-logging. I wondered if th project's <a href=\"https://issues.jboss.org/secure/IssueNavigator.jspa?reset=true&amp;jqlQuery=project%20=%20JBLOGGING%20AND%20resolution%20=%20Unresolved%20AND%20component%20is%20EMPTY%20ORDER%20BY%20priority%20DESC&amp;mode=hide\">bug tracker</a> might have any issues relating to providing documentation, but it doesn't.</p>\n\n<p>The good news is that when using Hibernate 4 inside an application server, such as JBoss AS7, logging is largely taken care of for you. But how can i configure it in a standalone application?</p>\n"},{"tags":["java","hibernate","lucene","hibernate-search"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":200,"score":1,"question_id":10548598,"title":"Hibernate Search issue on Amazon","body":"<p><strong><em>Technology Versions</em>:<br></strong>\n<code>\nHibernate 3.6.5<br>\nHibernate Search 3.4.0<br>\nLucene (lucene-core-*.jar) 3.1.0<br>\nSpring 3.1.0.M2\n</code></p>\n\n<p><strong><em>Hibernate (Search) Configuration</em>:<br></strong>\n<code>&lt;prop key=\"hibernate.search.default.indexBase\"&gt;/some/dir&lt;/prop&gt;\n&lt;prop key=\"hibernate.search.default.directory_provider\"&gt;org.hibernate.search.store.FSDirectoryProvider&lt;/prop&gt;\n&lt;prop key=\"hibernate.search.default.locking_strategy\"&gt;native&lt;/prop&gt;\n&lt;prop key=\"hibernate.search.default.exclusive_index_use\"&gt;false&lt;/prop&gt;</code></p>\n\n<p><strong><em>The issue</em>:<br></strong>\nOur application is deployed in Amazon (AWS cloud), but we've faced this issue in our local clusters as well:</p>\n\n<p>The application design is such that there is a <code>Thread</code> that is spawned from within the main (Web) application wherefrom we need to update an <em>Indexed</em> entity. Basically it's like a status monitor thread which reads a .status file and updates the database every 30 seconds or so. This keeps happening for about 10mins to 1/2 an hour on an average.\nThe issue we see is that: every few days we need to regenerate the indexes because Hibernate Search stops returning anything for the entity in question (the one discussed above).</p>\n\n<p>I went through few forums and seems it is suggested that only a single thread should be updating the Lucene indexes. But it is also given that index writing is thread-safe. So even if multiple threads are writing to the same index, I still expect that it should not cause the issue (of nothing being returned in the search). That is to say, I may get stale status of the entity in question, but still, something should be returned.</p>\n\n<p>We're using the default IndexReader/Writer implementation of Hibernate Search.</p>\n\n<p>Any help would be highly appreciated. Thanks.</p>\n"},{"tags":["hibernate","ejb-3.0","jpa-2.0","seam3","jboss7.x"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":352,"score":5,"question_id":9125813,"title":"JPA/Hibernate emits no UPDATE on commit in EJB/Seam environment","body":"<p>I have a Seam 3 sandbox application using JBoss 7, Hibernate as default JPA implementation and as JSF as web front end.</p>\n\n<p>I have the problem, that the SQL UPDATE is swallowed by default.</p>\n\n<p>My stateful EJB in conversation scope maintains an extended scoped EntityManager and one Entity, Container Managed Transactions (Requires new)</p>\n\n<ol>\n<li>The EntityManager gets injected</li>\n<li>The EJB uses the EM to load the Entity and keeps it in a field</li>\n<li>JSF application accesses the EJB and its entity, changes a String field</li>\n<li>JSF application calles \"Save\" method in EJB</li>\n<li>In save() I check, if the Entities field was changed -> it was changed properly</li>\n<li>I do nothing more, the container commits the transaction after save() is finished.</li>\n<li>Problem: No SQL update is performed against the DB.</li>\n</ol>\n\n<p>If i extend save() by:</p>\n\n<p>a) entityManager.contains(entity) the UPDATE is executed as expected (result is \"true\")</p>\n\n<p>OR</p>\n\n<p>b) entityManager.persist(entity) the UPDATE is executed as expected</p>\n\n<p>Q: As far as I understand the specs neither of a) or b) should be required, because the Entity remains managed during the entire process.\nI dont understand, why a) has an effect on saving. \nI can imaging the b) has an effect on saving, but it should not be required, should it?</p>\n\n<p>Any explanation is welcome.</p>\n\n<p>Here is my EJB:</p>\n\n<pre><code>@Named\n@ConversationScoped\n@Stateful\n@TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)\npublic class LanguageBean {\n\n    @PersistenceContext(type = PersistenceContextType.EXTENDED)\n    private EntityManager em;\n    @Inject\n    private UserTransaction transaction;\n\n    private Language value;\n\n    @Inject\n    Conversation conversation;\n\n    public LanguageBean() {\n        super();\n    }\n\n    @Begin\n    public void selectLanguage(Long anId) {\n        conversation.setTimeout(10 * 60 * 1000);\n        if (anId != null) {\n            value = em.find(Language.class, anId);\n        }\n    }\n\n    @BeforeCompletion\n    public void transactionComplete(){\n        System.out.println(\"transactionComplete\");\n    }\n\n    public Language getValue() {\n        return value;\n    }\n\n    @Produces\n    @Named\n    @ConversationScoped\n    public Language getLanguage() {\n        return getValue();\n    }\n\n    public void setValue(Language aValue) {\n        value = aValue;\n    }\n\n    @End\n    public String save() {\n//      displays the changed attribute:\n        System.out.println(\"save code: \"+value.getCode());\n\n//      why is either this required:\n//      boolean tempContains = em.contains(value);\n//      System.out.println(\"managed: \"+tempContains);\n\n//      or: why is persist required:\n        em.persist(value);\n        return \"languages?faces-redirect=true\";\n    }\n\n    @End\n    public String cancel() throws SystemException {\n        transaction.setRollbackOnly();\n        return \"languages?faces-redirect=true\";\n    }\n\n}\n</code></pre>\n"},{"tags":["java","hibernate","postgresql","oracle11g"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":53,"score":-2,"question_id":12949603,"title":"Which database is ideal for a java based web application?","body":"<p>I am about to start a Java based ERP application. But I am confused with which database to choose. My two options are PostgreSQL 8.4 and Oracle 11g. I also use Hibernate 3.6 and REST Web Services in my application. So please feel free to comment to this question with your valuable suggestions.</p>\n"},{"tags":["oracle","hibernate","size","byte"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12949128,"title":"How related hibernate @Size max and oracle varchar in bytes","body":"<p>I have @Size annotation of field: </p>\n\n<pre><code>@Column(name = \"SHARE_PART_STR\")\n@Size(max = 10)\nprivate String shareStr;\n</code></pre>\n\n<p>This field declared in Oracle as:</p>\n\n<pre><code>CREATE TABLE ...\n(\n  SHARE_PART_STR  VARCHAR2(10 BYTE)\n)\n</code></pre>\n\n<p>How @Size(max = 10) related to 10 BYTE? Did hibernate tries to save VARCHAR2(10 CHAR) to VARCHAR2(10 BYTE)? Is this desired correct behaviour? Or is it incorrect to use VARCHAR2(... BYTE) with hibernate?</p>\n"},{"tags":["hibernate","many-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":55,"score":4,"question_id":12943622,"title":"hibernate ManyToMany Map<String, Entity> where map key is a property referenced via FK","body":"<p>I'm working on a tricky many to many mapping that I want represented in my entity as a map.  The catch, is that I want the map key to be a column from one of the associated tables and not a column of the mapping table as is typically the case.</p>\n\n<p>Account holds basic information about a user, AccountMetadata defines all the possible attributes an account may have, and Account_MetadataAccount defines a specific account's values for each possible AccountMetadata.</p>\n\n<p>I've mapped these to the following entities:</p>\n\n<pre><code>@Entity\n@Table(name = \"ACCOUNT\")\npublic class Account implements Serializable\n{\n  @Id\n  @Column(name = \"ACCOUNT_ID\")\n  private Long accountId;\n\n  @OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL, mappedBy = \"pk.account\")\n  private Set&lt;AccountMetadataAccount&gt; metadata = new HashSet&lt;AccountMetadataAccount&gt;();\n...\n}\n\n@Entity\n@Table(name = \"ACCOUNT_METADATA\")\npublic class AccountMetadata implements Serializable\n{\n  @Id\n  @Column(name = \"ACCOUNT_METADATA_ID\")\n  private Long accountMetadataId;\n\n  @Column(name = \"KEY\", unique = true)\n  private String key;\n\n  @Column(name = \"TYPE\")\n  private Class&lt;?&gt; type;\n...\n}\n\n@Entity\n@Table(name = \"ACCOUNT_METADATA_ACCOUNT\")\n@AssociationOverrides({\n                @AssociationOverride(name = \"pk.account\",\n                  joinColumns = @JoinColumn(name = \"ACCOUNT_ID\")),\n                @AssociationOverride(name = \"pk.metadata\",\n                  joinColumns = @JoinColumn(name = \"ACCOUNT_METADATA_ID\"))\n              })\npublic class AccountMetadataAccount implements Serializable\n{\n  @EmbeddedId\n  private AccountMetadataAccountId pk;\n\n  @Column(name = \"VALUE\")\n  private Serializable value;\n...\n}\n\n@Embeddable\npublic class AccountMetadataAccountId implements Serializable\n{\n  @ManyToOne\n  private AccountInfo account;\n\n  @ManyToOne\n  private AccountMetadataInfo metadata;\n...\n}\n</code></pre>\n\n<p>This all works great.  My problem, is the Account's metadata Set.  This isn't ideal.  If I've got a metadata key I want to look up a value for, I've got to iterate over the entire Set until I find the correct entry.  In our system, there could be hundreds of these.  I thought a <code>Map&lt;String, AccountMetadataAccount&gt;</code> or <code>Map&lt;String, Serializable&gt;</code> would be more ideal.  However, I'd want the map key to be the AccountMetadata key.</p>\n\n<p>I've been experimenting with <code>@MapKeyColumn</code> and <code>@MapKeyJoinColumn</code> with no luck.  I can only find examples where the map key is derived from a column of the join table.</p>\n\n<p>I'm hoping someone out there has done something similar, or at least has some words of wisdom on how to accomplish this.</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","sql","oracle","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12932799,"title":"Improving performance of native sql query in spring/hibernate applicaiton?","body":"<p>I have below the <code>native sql query</code>. i am using <code>Oracle</code> database.</p>\n\n<pre><code>select\n         * \n     from\n         (select\n             row_.*,\n             rownum rownumber \n         from\n             (select\n                 colmn1,\n                 colmn2,\n                 colmn3,\n                 colmn4,\n                 colmn5,\n                 colmn6,\n                 from\n                 Table5\n             where\n                 colmn5 In (\n                    '19901','10001'\n                 ) \n             order by\n                colmn1 ) row_ ) \n         Where\n             Rownumber &lt;= 50000\n             and rownumber &gt; 0\n</code></pre>\n\n<p>Above query returns <code>50000</code> records. if i execute above query in <code>sqldeveloper</code>, it takes only <code>30 seconds</code> but in the spring and hibernate integrated application it takes <code>15 minutes</code>. How can i improve the performance?</p>\n\n<p>Thanks!</p>\n"},{"tags":["hibernate","maven","annotations"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12818036,"title":"Maven hibernate jpamodelgen code generation","body":"<p>I have some troubles with generating code with maven.</p>\n\n<p>i am using the following plugin:</p>\n\n<pre><code>&lt;plugin&gt; \n    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; \n    &lt;version&gt;2.4&lt;/version&gt; \n    &lt;configuration&gt; \n        &lt;source&gt;1.6&lt;/source&gt; \n        &lt;target&gt;1.6&lt;/target&gt; \n    &lt;/configuration&gt; \n    &lt;dependencies&gt; \n        &lt;dependency&gt; \n            &lt;groupId&gt;org.hibernate&lt;/groupId&gt; \n            &lt;artifactId&gt;hibernate-jpamodelgen&lt;/artifactId&gt; \n            &lt;version&gt;1.2.0.Final&lt;/version&gt; \n        &lt;/dependency&gt; \n    &lt;/dependencies&gt; \n&lt;/plugin&gt; \n</code></pre>\n\n<p>Is there any possibility to ignore Inheritance in the <code>.java</code> files.</p>\n\n<p>My problem is:</p>\n\n<p>There is a <code>.java</code> file in which the code is like: <code>X extends Y {...}</code> (Y is a <code>.class</code> file)</p>\n\n<p>The generated code looks like <code>X_ extends Y_ {...}</code></p>\n\n<p>But there is no class <code>Y_</code> generated (and this is fine because I don't need this class). If I generate the code in Eclipse, only the class <code>X_</code> is generated and is working fine.</p>\n"},{"tags":["java","hibernate","gwt","tomcat"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2980,"score":1,"question_id":4754728,"title":"org.hibernate.cfg.Environment - hibernate.properties not found","body":"<p>I am working on a project which uses GWT on client side, Tomcat Apache server, MySQL, Hibernate with JPA. I am also using annotations and EntityManager\nMy folder structure is as follows:</p>\n\n<pre><code>+build\n+java\n   +com\n   +META-INF\n       persistence.xml\n+webcontent\n   +WEB-INF\n</code></pre>\n\n<p>I am getting following output in the console among other info</p>\n\n<pre><code>INFO org.hibernate.cfg.Environment  - hibernate.properties not found\nINFO org.hibernate.cfg.Environment  - Bytecode provider name : javassist\n</code></pre>\n\n<p>I also tried placing persistence.xml inside web-inf/meta-inf but I still get same error.\nThis is happening only when I operate it on server. If I test it locally using a main class, it works.\nAny idea why it can not find properties file</p>\n"},{"tags":["mysql","hibernate","ant","hbm2ddl"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1245,"score":7,"question_id":654833,"title":"How to find a JNDI resource inside the hibernatetool Ant task","body":"<p>I want to generate my database schema with Ant. I am using hbm2ddl task. </p>\n\n<p>I am using Hibernate with JNDI. My hibernate.cfg.xml looks like: </p>\n\n<pre><code>&lt;!DOCTYPE hibernate-configuration PUBLIC\n        \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n        \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;!-- Database connection settings --&gt;\n        &lt;property name=\"connection.datasource\"&gt;java:comp/env/jdbc/my_app&lt;/property&gt;\n        &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n        &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n\n            &lt;!-- Mapping --&gt;   \n  &lt;/session-factory&gt;  \n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>My $CATALINA_HOME/webapps/myapp/META-INF/context.xml looks like: </p>\n\n<pre><code>&lt;Context&gt;\n    &lt;Resource name=\"jdbc/my_app\" \n            global=\"jdbc/my_app\"\n            auth=\"Container\"\n            type=\"javax.sql.DataSource\" \n            username=\"userA\"\n            password=\"userA123\"\n            driverClassName=\"com.mysql.jdbc.Driver\"\n    \t\turl=\"jdbc:mysql://localhost:3306/myapp?autoReconnect=true\"\n            maxActive=\"8\" \n            maxIdle=\"4\"/&gt;\n&lt;/Context&gt;\n</code></pre>\n\n<p>And inside $CATALINA_HOME/webapps/myapp/WEB-INF/web.xml I have:</p>\n\n<pre><code>     &lt;resource-ref&gt;\n\t&lt;description&gt;DB Connection&lt;/description&gt;\n\t&lt;res-ref-name&gt;jdbc/my_app&lt;/res-ref-name&gt;\n\t&lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;\n\t&lt;res-auth&gt;Container&lt;/res-auth&gt;\n&lt;/resource-ref&gt;\n</code></pre>\n\n<p>Inside <strong>build.xml</strong> I have the next target. </p>\n\n<pre><code>&lt;target name=\"schema\" description=\"Generate DB schema from the O/R mapping files\"&gt;\n\t&lt;hibernatetool destdir=\"${basedir}\"&gt;\n    \t&lt;classpath path=\"${java.src.home}\"&gt;\n\t      &lt;fileset dir=\"${java.src.home}\"&gt;\n    \t          &lt;include name=\"**/*.hbm.xml\"/&gt;\n\t      &lt;/fileset&gt;\n    \t&lt;/classpath&gt;\n\t&lt;configuration configurationfile=\"${java.src.home}/hibernate.cfg.xml\"/&gt;\t    \t\n    \t&lt;hbm2ddl \n    \t\tdrop=\"true\" \n    \t\tcreate=\"true\"\n    \t\texport=\"true\"\n    \t\toutputfilename=\"myapp-ddl.sql\"\n      \t\tdelimiter=\";\"\n    \t\tformat=\"true\"/&gt;\t      \n   \t&lt;/hibernatetool&gt;\n&lt;/target&gt;\n</code></pre>\n\n<p>The problem is that ant is not finding the Resource element stored in context.xml.    </p>\n\n<pre><code>[hibernatetool] Error #1: org.hibernate.HibernateException: Could not find datasource\n</code></pre>\n\n<p>I tried, without success, to add the nex snippet inside the classpath element.</p>\n\n<pre><code> &lt;fileset dir=\"${web.home}/META-INF\"&gt;\n       &lt;include name=\"context.xml\"/&gt;\n   &lt;/fileset&gt;\n</code></pre>\n\n<p><strong>How can i point Ant to find the Resource defined in context.xml?</strong></p>\n\n<p>I post a complete error stacktrace. </p>\n\n<pre><code>[hibernatetool] INFO: JNDI InitialContext properties:{}\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:423)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:423)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:423)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:423)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:423)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTargets(Project.java:1181)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.run(InternalAntRunner.java:423)\n[hibernatetool]     at org.eclipse.ant.internal.ui.antsupport.InternalAntRunner.main(InternalAntRunner.java:137)\n[hibernatetool] java.util.zip.ZipException: error in opening zip file\n[hibernatetool]     at java.util.zip.ZipFile.open(Native Method)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:114)\n[hibernatetool]     at java.util.zip.ZipFile.&lt;init&gt;(ZipFile.java:131)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.getResourceURL(AntClassLoader.java:1014)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.findNextResource(AntClassLoader.java:146)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader$ResourceEnumeration.&lt;init&gt;(AntClassLoader.java:108)\n[hibernatetool]     at org.apache.tools.ant.AntClassLoader.findResources(AntClassLoader.java:958)\n[hibernatetool]     at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12$5.run(VersionHelper12.java:149)\n[hibernatetool]     at java.security.AccessController.doPrivileged(Native Method)\n[hibernatetool]     at com.sun.naming.internal.VersionHelper12.getResources(VersionHelper12.java:146)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getApplicationResources(ResourceManager.java:468)\n[hibernatetool]     at com.sun.naming.internal.ResourceManager.getInitialEnvironment(ResourceManager.java:159)\n[hibernatetool]     at javax.naming.InitialContext.init(InitialContext.java:219)\n[hibernatetool]     at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:175)\n[hibernatetool]     at org.hibernate.util.NamingHelper.getInitialContext(NamingHelper.java:28)\n[hibernatetool]     at org.hibernate.connection.DatasourceConnectionProvider.configure(DatasourceConnectionProvider.java:52)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:124)\n[hibernatetool]     at org.hibernate.connection.ConnectionProviderFactory.newConnectionProvider(ConnectionProviderFactory.java:56)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.ManagedProviderConnectionHelper.prepare(ManagedProviderConnectionHelper.java:27)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:180)\n[hibernatetool]     at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:133)\n[hibernatetool]     at org.hibernate.tool.ant.Hbm2DDLExporterTask.execute(Hbm2DDLExporterTask.java:55)\n[hibernatetool]     at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:171)\n[hibernatetool]     at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)\n[hibernatetool]     at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)\n[hibernatetool]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n[hibernatetool]     at java.lang.reflect.Method.invoke(Method.java:597)\n[hibernatetool]     at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)\n[hibernatetool]     at org.apache.tools.ant.Task.perform(Task.java:348)\n[hibernatetool]     at org.apache.tools.ant.Target.execute(Target.java:357)\n[hibernatetool]     at org.apache.tools.ant.Target.performTasks(Target.java:385)\n[hibernatetool]     at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)\n[hibernatetool]     at org.apache.tools.ant.Project.executeTarget(Project.java:1298)\n[hibernatetool]     at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultE\n</code></pre>\n"},{"tags":["mysql","hibernate","delete","hashmap","cascade"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12309969,"title":"hibernate does not generate on delete cascade in mysql for mapping of a HashMap","body":"<p>I have a problem generating a mysql schema with hibernate. I've searched for an answer to my problem but I haven't found it (many similar problems but not exactly mine).</p>\n\n<p>I need to map a State diagram into mysql (or transition table), and delete the states in cascade. A State may have many States as children (many to many relationship). I succeeded in mapping the State class and the \"next state\" relationship, but not in generating the correct SQL option ON DELETE CASCADE.</p>\n\n<p>The Java class is as follows:</p>\n\n<pre><code>public class State {\nprivate Integer version;\nprivate Integer oid;\nprivate String name;\nprivate Map&lt;String, State&gt; nextStates;\n\npublic State(String name) {\n    super();\n    this.name = name;\n    this.nextStates = new HashMap&lt;String, State&gt;();\n}\n\n/**\n * Adds some state to the transitions table. \n * The table is indexed by states names.\n * \n */\npublic void addNextState(State s) {\n    this.nextStates.put(s.getName(), s);\n}\n(...)\n</code></pre>\n\n<p>The hibernate configuration is :</p>\n\n<pre><code>&lt;hibernate-configuration&gt;\n&lt;session-factory&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost/testStatesDB&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;pass&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.pool_size\"&gt;10&lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"format_sql\"&gt;true&lt;/property&gt;     \n    &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQL5InnoDBDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;create-drop&lt;/property&gt;\n    &lt;property name=\"hibernate.bytecode.use_reflection_optimizer\"&gt;false&lt;/property&gt;       \n    &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;\n    &lt;mapping resource=\"State.hbm.xml\" /&gt;\n&lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>and the State mapping is as follows:</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n&lt;class name=\"State\" table=\"state\" optimistic-lock=\"version\"&gt;\n    &lt;id name=\"oid\" column=\"OID\"&gt;\n        &lt;generator class=\"increment\" /&gt;\n    &lt;/id&gt;\n    &lt;version column=\"version\" name=\"version\" unsaved-value=\"null\"/&gt;     \n\n    &lt;property name=\"name\" type=\"java.lang.String\"/&gt;\n\n    &lt;map name=\"nextStates\" table=\"nextStates\" cascade=\"delete\" optimistic-lock=\"true\"&gt; \n            &lt;key column=\"parentState_oid\" /&gt; \n            &lt;index column=\"children_stateName\" type=\"java.lang.String\"/&gt; \n            &lt;many-to-many column=\"children_oid\" class=\"State\" /&gt; \n    &lt;/map&gt;\n&lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>which creates the following schema:</p>\n\n<pre><code>Hibernate: \ncreate table nextStates (\n    parentState_oid integer not null,\n    children_oid integer not null,\n    children_stateName varchar(255) not null,\n    primary key (parentState_oid, children_stateName)\n) ENGINE=InnoDB\n\nHibernate: \ncreate table state (\n    OID integer not null,\n    version integer not null,\n    name varchar(255),\n    primary key (OID)\n) ENGINE=InnoDB\n\nHibernate: \nalter table nextStates \n    add index FKB4A102D5587BDC23 (parentState_oid), \n    add constraint FKB4A102D5587BDC23 \n    foreign key (parentState_oid) \n    references state (OID)\n\nHibernate: \nalter table nextStates \n    add index FKB4A102D5F71F7FB (children_oid), \n    add constraint FKB4A102D5F71F7FB \n    foreign key (children_oid) \n    references state (OID)\n</code></pre>\n\n<p>As an example, consider running the following test code, </p>\n\n<pre><code>State pend   = new State(\"Pending\");\nState dev   = new State(\"In development\");\nState finali = new State(\"Finalized\");\n\nSession session = HibernateUtil.getSessionFactory().openSession();\nsession.beginTransaction();\n\npend.addNextState(dev);\ndev.addNextState(finali);\ndev.addNextState(pend);\n\nsession.save(pend);\nsession.save(dev);\nsession.save(finali);\nsession.getTransaction().commit();\n\nsession.beginTransaction();\ndev = (State)session.load(State.class, 3);\nsession.delete(dev);\nsession.getTransaction().commit();\n</code></pre>\n\n<p>I get the following error message:</p>\n\n<pre><code>Cannot delete or update a parent row: a foreign key constraint fails (`testStatesDB`.`nextstates`, CONSTRAINT `FKB4A102D5F71F7FB` FOREIGN KEY (`children_oid`) REFERENCES `state` (`OID`))\n</code></pre>\n\n<p>and if I go to the database and add the property ON DELETE CASCADE to the generated foreign keys, the example works as I need.</p>\n\n<p>The question is: Is this the correct way of mapping a many to many relationship using HashMaps? And if it is correct, how do I generate the ON DELETE CASCADE option with an hibernate xml mapping?</p>\n\n<p>I've been dealing with this problem for a long time, but I didn't find a good solution.</p>\n"},{"tags":["mysql","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12944521,"title":"Hibernate bidirectional OneToMany with JoinTable and polymorphic classes with table per concrete class","body":"<p>I'm using Hibernate 4.1.7 Java with Spring, working on MySql.</p>\n\n<p>I have a Publication class, which is abstract and has 3 subclasses, and a Page class which is also abstract and has 2 subclasses.</p>\n\n<p>In Publication there is a List and in Page i have a Publication, so it's a common OneToMany/ManyToOne bidirectional relation, but since I need the pages to be sorted I'm using a cross table as shown :</p>\n\n<pre><code>// Publication.java\n@OneToMany(fetch=FetchType.LAZY)\n@JoinTable(name=\"publication_pages\",\n            joinColumns=@JoinColumn(table=\"publication_pages\", name=\"pub_id\", referencedColumnName=\"id\"),\n            inverseJoinColumns=@JoinColumn(table=\"publication_pages\", name=\"pg_id\", referencedColumnName=\"id\"))\n@OrderColumn(name=\"i\")\npublic List&lt;Page&gt; getPages() {\n    return pages;\n}\n\n// Page.java\n\n@ManyToOne\n@JoinTable(name=\"publication_pages\",\n        joinColumns=@JoinColumn(table=\"publication_pages\", name=\"pg_id\", referencedColumnName=\"id\", insertable=false, updatable=false),\n        inverseJoinColumns=@JoinColumn(table=\"publication_pages\", name=\"pub_id\", referencedColumnName=\"id\", insertable=false, updatable=false))\npublic Publication getPublication() {\n    return publication;\n}\n</code></pre>\n\n<p>Hibernate does not complain about annotations, but as soon as I try to call getPages, it generates a query that searches for pub_id on Page subclasses tables, instead that only in the cross table. </p>\n\n<p>The error is :</p>\n\n<pre><code>com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'page1_.pub_id' in 'field list'\nat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\nat java.lang.reflect.Constructor.newInstance(Constructor.java:532)\nat com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\nat com.mysql.jdbc.Util.getInstance(Util.java:386)\nat com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1053)\nat com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4074)\nat com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4006)\nat com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2468)\nat com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2629)\nat com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2719)\nat com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)\nat com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2318)\nat com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:76)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:616)\nat org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122)\nat org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81)\nat $Proxy54.executeQuery(Unknown Source)\nat org.hibernate.loader.Loader.getResultSet(Loader.java:1897)\nat org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1698)\nat org.hibernate.loader.Loader.doQuery(Loader.java:832)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:293)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:263)\nat org.hibernate.loader.Loader.loadCollection(Loader.java:2094)\nat org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:61)\nat org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:678)\nat org.hibernate.event.internal.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:82)\nat org.hibernate.internal.SessionImpl.initializeCollection(SessionImpl.java:1801)\nat org.hibernate.collection.internal.AbstractPersistentCollection$4.doWork(AbstractPersistentCollection.java:524)\nat org.hibernate.collection.internal.AbstractPersistentCollection.withTemporarySessionIfNeeded(AbstractPersistentCollection.java:212)\nat org.hibernate.collection.internal.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:520)\nat org.hibernate.collection.internal.AbstractPersistentCollection.read(AbstractPersistentCollection.java:125)\nat org.hibernate.collection.internal.AbstractPersistentCollection$1.doWork(AbstractPersistentCollection.java:152)\nat org.hibernate.collection.internal.AbstractPersistentCollection$1.doWork(AbstractPersistentCollection.java:139)\nat org.hibernate.collection.internal.AbstractPersistentCollection.withTemporarySessionIfNeeded(AbstractPersistentCollection.java:212)\nat org.hibernate.collection.internal.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:138)\nat org.hibernate.collection.internal.PersistentList.isEmpty(PersistentList.java:121)\n</code></pre>\n\n<p>An I doing something wrong, or is a Hibernate bug, or is it simply impossible due to the high number of unions it performs in the query?</p>\n\n<p>TIA</p>\n\n<p>EDIT: this is the query hibernate is generating (I removed all the not-related columns) :</p>\n\n<pre><code>Hibernate: \nselect \npages0_.pub_id as pub1_46_3_, \npages0_.pg_id as pg2_43_3_, \npages0_.i as i3_,\npage1_.id as id42_0_, \n[...] \npage1_.pub_id as pub1_43_0_ [...]\n\nfrom publication_pages pages0_ \ninner join ( \n  select id, [...] from page_fixed union select id, [...] from page_query \n) page1_\n\non pages0_.pg_id=page1_.id left outer join ( \n  select id, [...] from publication \n) publicatio2_ \non page1_.pub_id=publicatio2_.id left where pages0_.pub_id=?\n</code></pre>\n\n<p>As you can see, it uses page1_.pub_id in the join (as if pub_id was on Page) instead of pages0_.pub_id (which is correctly used on the where clause).</p>\n\n<p>This happens on a call to Publication.getPages().isEmpty() </p>\n"},{"tags":["flex","hibernate","spring","blazeds"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3252,"score":0,"question_id":2489978,"title":"How to solve \"NullPointerException\" with \"Server.processing\" error while we are using Flex Builder 3 and BlazeDS?","body":"<p>I am using Flex builder 3, BlazeDS, and Java with Spring and Hibernate framework. I using the remote object to load a string from spring's configuration files. But in testing, I found this fault event like this:</p>\n\n<blockquote>\n  <p>RPC Fault\n  faultString=\"java.lang.NullPointerException\"\n  faultCode=\"Server.Processing\"\n  faultDetail=\"null\"</p>\n</blockquote>\n\n<p>I have checked the configuration in remote-config.xml and services-config.xml. But it looks good. Some people have talked about this problem around the Internet and I think you can help me and them.</p>\n\n<p>I am using these environment:</p>\n\n<ul>\n<li>Flex Builder 3</li>\n<li>BlazeDS 3.2.0</li>\n<li>JBoss server</li>\n</ul>\n\n<p>Full stacktrace:</p>\n\n<pre>\n[RPC Fault faultString=\"java.lang.NullPointerException\" faultCode=\"Server.Processing\" faultDetail=\"null\"]\n at mx.rpc::AbstractInvoker/http://www.adobe.com/2006/flex/mx/internal::faultHandler()[C:\\autobuild\\3.2.0\\frameworks\\projects\\rpc\\src\\mx\\rpc\\AbstractInvoker.as:220]\n at mx.rpc::Responder/fault()[C:\\autobuild\\3.2.0\\frameworks\\projects\\rpc\\src\\mx\\rpc\\Responder.as:53]\n at mx.rpc::AsyncRequest/fault()[C:\\autobuild\\3.2.0\\frameworks\\projects\\rpc\\src\\mx\\rpc\\AsyncRequest.as:103]\n at NetConnectionMessageResponder/statusHandler()[C:\\autobuild\\3.2.0\\frameworks\\projects\\rpc\\src\\mx\\messaging\\channels\\NetConnectionChannel.as:569]\n at mx.messaging::MessageResponder/status()[C:\\autobuild\\3.2.0\\frameworks\\projects\\rpc\\src\\mx\\messaging\\MessageResponder.as:222]\n</pre>\n"},{"tags":["spring","hibernate","tomcat","jpa","persistence-unit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12941265,"title":"Can I use one hibernate persistence unit on tomcat and share it between deployed wars?","body":"<p>I have an application running on tomcat where we have multiple wars. </p>\n\n<ol>\n<li>War1 is a web app that is used to provision the database.</li>\n<li>War2 is for uploading data via a web service.</li>\n<li>War3 is for getting data via a web service.</li>\n<li>War4 is another web app that is used to view the data in a dashboard.</li>\n</ol>\n\n<p>We use hibernate/jpa and spring. The classes are annotated and we don't have a persistence.xml  for any of them. All configuration is in the spring context file and the annotations.\nHere's the spring file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:jpa=\"http://www.springframework.org/schema/data/jpa\"\n       xmlns:aop=\"http://www.springframework.org/schema/aop\"\n       xmlns:context=\"http://www.springframework.org/schema/context\"\n       xmlns:flow=\"http://www.springframework.org/schema/webflow-config\"\n       xmlns:lang=\"http://www.springframework.org/schema/lang\"\n       xmlns:osgi=\"http://www.springframework.org/schema/osgi\"\n       xmlns:tx=\"http://www.springframework.org/schema/tx\"\n       xmlns:util=\"http://www.springframework.org/schema/util\"\n       xmlns:p=\"http://www.springframework.org/schema/p\"\n       xmlns:cache=\"http://www.springframework.org/schema/cache\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd\n          http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd\n          http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd\n          http://www.springframework.org/schema/webflow-config http://www.springframework.org/schema/webflow-config/spring-webflow-config-2.0.xsd\n          http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-3.0.xsd\n          http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi-3.0.xsd\n          http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd\n          http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd\n          http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd\n          http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd\n\"&gt;\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n    &lt;!-- Directory to scan for repository classes --&gt;\n    &lt;jpa:repositories\n        base-package=\"com.blah.db.model.repository\" /&gt;\n    &lt;bean id=\"propertyConfigurer\"\n          class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n        &lt;property name=\"locations\"&gt;\n            &lt;list&gt;\n                &lt;value&gt;/WEB-INF/configuration.properties&lt;/value&gt;\n            &lt;/list&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n    &lt;cache:annotation-driven /&gt;\n        &lt;bean id=\"cacheManager\" class=\"org.springframework.cache.ehcache.EhCacheCacheManager\" p:cache-manager-ref=\"ehcache\"/&gt;\n        &lt;bean id=\"ehcache\" class=\"org.springframework.cache.ehcache.EhCacheManagerFactoryBean\"\n                    p:config-location=\"/WEB-INF/ehcache.xml\"\n                    p:shared=\"true\"/&gt;\n    &lt;context:component-scan base-package=\"com.blah.db.model.service\" /&gt;\n    &lt;context:component-scan base-package=\"com.blah.business.objects\" /&gt;\n    &lt;context:component-scan base-package=\"com.blah.data.access.objects\" /&gt;\n    &lt;context:component-scan base-package=\"com.blah.common\" /&gt;\n\n    &lt;bean class=\"org.springframework.orm.jpa.JpaTransactionManager\"\n      id=\"transactionManager\"&gt;\n        &lt;property name=\"entityManagerFactory\"\n            ref=\"entityManagerFactory\" /&gt;\n        &lt;property name=\"jpaDialect\"&gt;\n            &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaDialect\" /&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"entityManagerFactory\"\n      class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n        &lt;property name=\"packagesToScan\" value=\"com.blah.db.model\"  /&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"jpaVendorAdapter\"&gt;\n            &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n                &lt;property name=\"generateDdl\" value=\"${hibernate.generate.ddl}\" /&gt;\n                &lt;property name=\"database\" value=\"${hibernate.database}\" /&gt;\n                &lt;property name=\"showSql\" value=\"${show.sql}\" /&gt;\n            &lt;/bean&gt;\n        &lt;/property&gt;\n        &lt;property name=\"jpaProperties\"&gt;\n            &lt;map&gt;\n                &lt;entry key=\"hibernate.default_schema\" value=\"${default.schema}\"/&gt;\n                &lt;entry key=\"hibernate.dialect\" value=\"${jdbc.hibernate.dialect}\"/&gt;\n                &lt;entry key=\"hibernate.id.new_generator_mappings\" value=\"${new.generator.mappings}\"/&gt;\n                &lt;entry key=\"hibernate.cache.region.factory_class\" value=\"${hibernate.cache.factory.class}\"/&gt;\n                &lt;entry key=\"hibernate.cache.use_second_level_cache\" value=\"${hibernate.use.second.level.cache}\"/&gt;\n                &lt;entry key=\"hibernate.cache.use_query_cache\" value=\"${hibernate.use.query.cache}\"/&gt;\n                &lt;entry key=\"net.sf.ehcache.configurationResourceName\" value=\"${ehcache.config.file}\"/&gt;\n            &lt;/map&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"dataSource\"\n      class=\"org.apache.commons.dbcp.BasicDataSource\"\n      destroy-method=\"close\"&gt;\n        &lt;property name=\"driverClassName\" value=\"org.postgresql.Driver\" /&gt;\n        &lt;property name=\"url\" value=\"jdbc:postgresql://127.0.0.1:5432/blah\" /&gt;\n        &lt;property name=\"username\" value=\"postgres\" /&gt;\n        &lt;property name=\"password\" value=\"password\" /&gt;\n    &lt;/bean&gt;\n    &lt;bean id=\"openSessionInViewInterceptor\" class=\"org.springframework.orm.jpa.support.OpenEntityManagerInViewInterceptor\"&gt;\n        &lt;property name=\"entityManagerFactory\"&gt;\n            &lt;ref local=\"entityManagerFactory\"/&gt;\n        &lt;/property&gt;\n        &lt;property name=\"jpaProperties\"&gt;\n            &lt;map&gt;\n                &lt;entry key=\"singleSession\" value=\"true\"/&gt;\n                &lt;entry key=\"flushModeName\" value=\"FLUSH_AUTO\"/&gt;\n            &lt;/map&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<p>How do I ensure that all the wars use a single persistence unit? I want to be able to use ehcache, but I know I can't use it if they all use their own PU.</p>\n\n<p>Is my only option moving to JavaEE and packaging it all in an EAR?</p>\n\n<p>Thanks!</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12942549,"title":"Automatically confirm foreign key constraint for ManyToOne persist","body":"<p>This is similar to the question here:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/12347759/best-practice-for-working-with-foreign-key-fields\">Best practice for working with Foreign key fields</a></p>\n\n<p>but I'm wondering whether there is any way to automatically enforce this kind of logic. When I perist a new record in the \"many\" table, that has a foreign key in \"one\" table, I'd like hibernate to automatically load the referenced entity and check that it exists, and access that entity's fields (for validation purposes). </p>\n\n<p>Any way to do this just through annotations?</p>\n"},{"tags":["sql-server","hibernate","exception","netbeans"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12941591,"title":"Netbeans hibernate MS SQL Server 2005 Exception","body":"<p>I am trying to configure Hibernate with NetBeans 7.2 to connect to a MS SQL 2005 server(localhost). Whenever I try to input a query to test at HQL Query0 window I get Exception dialog that says only my driver class name which is \"com.microsoft.sqlserver.jdbc.SQLServerDriver\" with big red 'X' icon and OK button below even before I finish typing the query line. It's like hibernate doesn't even see the driver at all.</p>\n\n<p>I configured everything as instructed by Netbeans website and consulted some online search result that seemed to relevant to my case. I checked and re-checked every line. The connection was successful when I made one at services tab with 'new connection' wizard thingy. \nDose my Windows 7 OS being 64-bit Home premium edition have something to do with this? I am very frustrated. Please help! </p>\n\n<p>BTW, my colleague with a same code (His might be 32bit Win 7) have no problem with the same test.</p>\n"},{"tags":["hibernate","design","spring-mvc","jdbc","jdbctemplate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12940524,"title":"How to design service layer for spring mvc3 for Hibernate implementation in the future","body":"<p>We're using Spring jdbcTemplate for implementing the service layer right now but at some point in future we'd like to move to hibernate. I am concerned whether the way our current service layer is designed will be efficient when we move to Hibernate. </p>\n\n<p>Currently we have: I've left out details for clarity</p>\n\n<p>Datasource in context xml</p>\n\n<pre><code>&lt;bean id=\"dataSource\" destroy-method=\"close\" class=\"...BasicDataSource\"&gt;\n    &lt;property name=\"\" value=\"\" /&gt;\n    &lt;property name=\"\" value=\"\" /&gt;\n    &lt;property name=\"username\" value=\"\" /&gt;\n    &lt;property name=\"password\" value=\"\"/&gt;      \n&lt;/bean&gt;\n</code></pre>\n\n<p>Service classes</p>\n\n<pre><code>@Repository \npublic class MyService {\n   private JdbcTemplate jdbcTemplate;\n        @Autowired\n        public void setDataSource (DataSource ds) {\n            this.jdbcTemplate = new JdbcTemplate(ds);\n        } \n@Transactional \npublic void myTransactions () {...}  \n} \n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>@Autowired\nprivate MyService  myService;\n</code></pre>\n\n<p>I've seen a lot of implementations of hibernate service layer in spring mvc and most of them use an <code>interface</code>. What would be the benefit of adding an interface? And should I be adding an <code>interface</code> into my design? Would that make things easier when transitioning in to hibernate?</p>\n"},{"tags":["java","hibernate","postgresql","c3p0"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":169,"score":1,"question_id":12913593,"title":"PostgreSQL + Hibernate + C3P0 = FATAL: sorry, too many clients already","body":"<p>I have the following code</p>\n\n<pre><code>    Configuration config = new Configuration().configure();\n    config.buildMappings();\n    serviceRegistry = new ServiceRegistryBuilder().applySettings(config.getProperties()).buildServiceRegistry(); \n    SessionFactory factory = config.buildSessionFactory(serviceRegistry);\n    Session hibernateSession = factory.openSession();\n    Transaction tx = hibernateSession.beginTransaction();\n    ObjectType ot = (ObjectType)hibernateSession.merge(someObj);\n    tx.commit();\n    return ot;\n</code></pre>\n\n<p><code>hibernate.cfg.xml</code> contains:</p>\n\n<p>\n</p>\n\n<pre><code>&lt;session-factory&gt;\n\n    &lt;property name=\"connection.url\"&gt;jdbc:postgresql://127.0.0.1:5432/dbase&lt;/property&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;\n    &lt;property name=\"connection.driver_class\"&gt;org.postgresql.Driver&lt;/property&gt;\n\n    &lt;property name=\"connection.username\"&gt;username&lt;/property&gt;\n    &lt;property name=\"connection.password\"&gt;password&lt;/property&gt;\n\n    &lt;property name=\"connection.provider_class\"&gt;org.hibernate.connection.C3P0ConnectionProvider&lt;/property&gt;        \n    &lt;property name=\"hibernate.c3p0.acquire_increment\"&gt;1&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.min_size\"&gt;5&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.max_size\"&gt;20&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.max_statements\"&gt;50&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.timeout\"&gt;300&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.idle_test_period\"&gt;3000&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.acquireRetryAttempts\"&gt;1&lt;/property&gt;\n    &lt;property name=\"hibernate.c3p0.acquireRetryDelay\"&gt;250&lt;/property&gt;\n\n    &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"hibernate.use_sql_comments\"&gt;true&lt;/property&gt;\n\n    &lt;property name=\"hibernate.transaction.factory_class\"&gt;org.hibernate.transaction.JDBCTransactionFactory&lt;/property&gt;\n    &lt;property name=\"hibernate.current_session_context_class\"&gt;thread&lt;/property&gt;\n\n    &lt;mapping class=\"....\" /&gt;\n\n&lt;/session-factory&gt;\n</code></pre>\n\n<p></p>\n\n<p>After a few seconds and some successful inserts, the following exception appears:</p>\n\n<pre><code>org.postgresql.util.PSQLException: FATAL: sorry, too many clients already\n    at org.postgresql.core.v3.ConnectionFactoryImpl.doAuthentication(ConnectionFactoryImpl.java:291)\n    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:108)\n    at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:66)\n    at org.postgresql.jdbc2.AbstractJdbc2Connection.&lt;init&gt;(AbstractJdbc2Connection.java:125)\n    at org.postgresql.jdbc3.AbstractJdbc3Connection.&lt;init&gt;(AbstractJdbc3Connection.java:30)\n    at org.postgresql.jdbc3g.AbstractJdbc3gConnection.&lt;init&gt;(AbstractJdbc3gConnection.java:22)\n    at org.postgresql.jdbc4.AbstractJdbc4Connection.&lt;init&gt;(AbstractJdbc4Connection.java:30)\n    at org.postgresql.jdbc4.Jdbc4Connection.&lt;init&gt;(Jdbc4Connection.java:24)\n    at org.postgresql.Driver.makeConnection(Driver.java:393)\n    at org.postgresql.Driver.connect(Driver.java:267)\n    at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:135)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)\n    at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)\n    at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)\n    at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)\n    at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)\n    at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)\n    at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)\n12:24:19.151 [          Thread-160] WARN                   internal.JdbcServicesImpl - HHH000342: Could not obtain connection to query metadata : Connections could not be acquired from the underlying database!\n12:24:19.151 [          Thread-160] INFO                             dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect\n12:24:19.151 [          Thread-160] INFO                  internal.LobCreatorBuilder - HHH000422: Disabling contextual LOB creation as connection was null\n12:24:19.151 [          Thread-160] INFO        internal.TransactionFactoryInitiator - HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory\n12:24:19.151 [          Thread-160] INFO               ast.ASTQueryTranslatorFactory - HHH000397: Using ASTQueryTranslatorFactory\n12:24:19.151 [          Thread-160] INFO                        hbm2ddl.SchemaUpdate - HHH000228: Running hbm2ddl schema update\n12:24:19.151 [          Thread-160] INFO                        hbm2ddl.SchemaUpdate - HHH000102: Fetching database metadata\n12:24:19.211 [Runner$PoolThread-#0] WARN              resourcepool.BasicResourcePool - com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@ee4084 -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (1). Last acquisition attempt exception: \norg.postgresql.util.PSQLException: FATAL: sorry, too many clients already\n    at org.postgresql.core.v3.ConnectionFactoryImpl.doAuthentication(ConnectionFactoryImpl.java:291)\n</code></pre>\n\n<p>It seems that the hibernate doesn't realse the connection. But <code>hibernateSession.close()</code> causes exception <code>Session is closed</code> because <code>tx.commit()</code> is called.</p>\n"},{"tags":["hibernate","criteria-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12940867,"title":"Inner Join Criteria Hibernate","body":"<p>I want this sql:</p>\n\n<pre><code>SELECT COUNT(*) FROM table1 t1, table2 t2 \nWHERE t1.id &gt; 0  \nAND (( t1.name = 'foo') \n    OR ( t1.id2 = t2.id AND t1.name = 'det')) \n</code></pre>\n\n<p>If I use alias for table2:</p>\n\n<pre><code>detachedCriteria.createAlias(\"table2\", \"t2\");\n</code></pre>\n\n<p>and set like this:</p>\n\n<pre><code>detachedCriteria.add(Restrictions.eqProperty(\"t1.id2\", \"t2.id\"));\n</code></pre>\n\n<p>Hibernate always generates INNER JOIN in SELECT query which I don't want and that gives me wrong results.</p>\n\n<pre><code>select count(*) as y0_ \nfrom\n    table1 this_ \ninner join\n    table2 table2_ \n        on this_.id2=table2_.id \nwhere \n...\n</code></pre>\n\n<p>How can I achive \"INNER JOIN\" in WHERE clause (t1.id2 = t2.id) not in SELECT?</p>\n"},{"tags":["java","multithreading","spring","hibernate","repository"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12936928,"title":"Problems with threads and hibernate sessions","body":"<p>Im using hibernate 3 and spring.\nWhen I start a thread an exception occurred:</p>\n\n<pre><code>org.hibernate.HibernateException: Illegal attempt to associate a collection with two open sessions\n</code></pre>\n\n<p>I dont know how to detach entities or close session with this architecture.\nI appreciate some help.</p>\n\n<p><code>CommunicationService.sendCommunications()</code> code:</p>\n\n<pre><code>public void sendCommunications(HibernateMessageToSendRepository messageToSendRepository)  {\n    Long messageId = new Long(41); //this is only for test. the idea is get a list of id and generate a thread group.\n    MessageSender sender = SmsSender(messageId, messageToSendRepository);\n    sender.start();\n}\n</code></pre>\n\n<p>Invoking <code>sendCommunications</code> code:</p>\n\n<pre><code>ApplicationContext appCont = new ClassPathXmlApplicationContext(\"appContext.xml\");      \nServiceLocator serviceLocator = ServiceLocator.getInstance();\nHibernateMessageToSendRepository messageToSendRepository = (HibernateMessageToSendRepository) appCont.getBean(\"messageToSendRepository\");\n\nCommunicationService communication = serviceLocator.getCommunicationService();\ncommunication.sendCommunications(messageToSendRepository);\n</code></pre>\n\n<p>SmsSender (extends from MessageSender (thread)) code:</p>\n\n<pre><code>public class SmsSender extends MessageSender {\n\n    public SmsSender(Long messageToSendId, HibernateMessageToSendRepository messageToSendRepository) {\n        super(messageToSendRepository);\n        MessageToSend messageToSendNew = this.messageToSendRepository.getById(messageToSendId);     \n        this.messageToSend = messageToSendNew;\n    }\n\n    public void run() {\n        try {\n            MessageToSendSms messageToSendSms = (MessageToSendSms) this.messageToSend;\n            Iterator&lt;CustomerByMessage&gt; itCbmsgs = messageToSendSms.getCustomerByMessage().iterator();          \n            while (itCbmsgs.hasNext()) {                \n                CustomerByMessage cbm = (CustomerByMessage) itCbmsgs.next();                        \n\n                //sms sending\n                this.getGateway().sendSMS(cbm.getBody(), cbm.getCellphone());                       \n                cbm.setStatus(CustomerByMessageStatus.SENT_OK);\n                cbm.setSendingDate(Calendar.getInstance().getTime());               \n            }           \n\n            messageToSendSms.getMessage().setStatus(messageToSendStatus.ALL_MESSAGES_SENT);\n            this.messageToSendRepository.update(messageToSendSms);      \n        } catch (Exception e) {         \n            this.log.error(\"Error en sms sender \" + e.getMessage());\n        }\n\n    }\n}\n</code></pre>\n\n<p><code>MessageToSendRepository</code> code:</p>\n\n<pre><code>public void update(MessageToSend messageToSend) {\n    try {\n        this.getSession().update(messageToSend);\n    } catch (HibernateException e) {\n        this.log.error(e.getMessage(), e);\n        throw e;\n    }\n}\n</code></pre>\n"},{"tags":["hibernate","ant","code-generation","hibernate-tools","hbm2java"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":961,"score":0,"question_id":11218230,"title":"\"'hibernate.dialect' must be set when no Connection available \" error despite having set the dialect","body":"<p>I have tried to run a hibernatetool Ant task but i've been unsuccesfull.Help. The jars are from my eclipse(3.7.2) hibernate tools plugin(3.4).  I get a org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available  despite having set the dialect</p>\n\n<p>Here is my build.xml:  </p>\n\n<pre><code>&lt;project&gt;\n&lt;target name=\"genero\"&gt;\n    &lt;path id=\"toolslib\"&gt;\n        &lt;path location=\"mylibs/hibernate-tools.jar\" /&gt;\n        &lt;path location=\"mylibs/hibernate3.jar\" /&gt;\n        &lt;path location=\"mylibs/freemarker.jar\" /&gt;\n        &lt;path location=\"mylibs/postgresql-9.0-802.jdbc4.jar\" /&gt;\n        &lt;path location=\"mylibs/dom4j-1.6.1.jar\" /&gt;\n        &lt;path location=\"mylibs/commons-logging-1.0.4.jar\" /&gt;\n        &lt;path location=\"mylibs/slf4j-api-1.5.8.jar\" /&gt;\n        &lt;path location=\"mylibs/slf4j-log4j12-1.5.8.jar\" /&gt;\n        &lt;path location=\"mylibs/log4j-1.2.15.jar\" /&gt;\n        &lt;path location=\"mylibs/cglib-2.2.jar\" /&gt;\n        &lt;path location=\"mylibs/asm.jar\" /&gt;\n        &lt;path location=\"mylibs/commons-collections-3.1.jar\" /&gt;\n\n        &lt;path location=\"mylibs/slf4j-api-1.5.8.jar\" /&gt;          \n\n\n\n\n    &lt;/path&gt;\n\n    &lt;taskdef name=\"hibernatetool\" classname=\"org.hibernate.tool.ant.HibernateToolTask\" classpathref=\"toolslib\" /&gt;\n\n    &lt;hibernatetool&gt;\n        &lt;jdbcconfiguration propertyfile=\"src/hibernate.cfg.xml\" packagename=\"demo\" revengfile=\"src/hibernate.reveng.xml\" /&gt;\n\n        &lt;hbm2hbmxml destdir=\"${build.dir}/src\" /&gt;\n        &lt;hbm2java jdk5=\"true\" destdir=\"${build.dir}/src\" /&gt;\n\n    &lt;/hibernatetool&gt;\n&lt;/target&gt;\n</code></pre>\n\n<p></p>\n\n<p>And my hibernate.cfg.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n        \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n        \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;org.postgresql.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;blablabla&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:postgresql://localhost:5432/projteste&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;postgres&lt;/property&gt;\n\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>And the stack trace:</p>\n\n<pre><code>  Apache Ant(TM) version 1.8.2 compiled on December 20 2010\nBuildfile: C:\\Users\\mrtykop\\workspace2\\testjavahib\\build.xml\nparsing buildfile C:\\Users\\mrtykop\\workspace2\\testjavahib\\build.xml with URI = file:/C:/Users/mrtykop/workspace2/testjavahib/build.xml\nProject base dir set to: C:\\Users\\mrtykop\\workspace2\\testjavahib\nBuild sequence for target(s) `genero' is [genero]\nComplete build sequence is [genero, ]\ngenero:\nparsing buildfile jar:file:/E:/jave/eclipse/plugins/org.apache.ant_1.8.2.v20120109-1030/lib/ant.jar!/org/apache/tools/ant/antlib.xml with URI = jar:file:/E:/jave/eclipse/plugins/org.apache.ant_1.8.2.v20120109-1030/lib/ant.jar!/org/apache/tools/ant/antlib.xml from a zip file\nProperty \"build.dir\" has not been set\nProperty \"build.dir\" has not been set\n[hibernatetool] Executing Hibernate Tool with a JDBC Configuration (for reverse engineering)\n[hibernatetool] 1. task: hbm2hbmxml (Generates a set of hbm.xml files)\n[hibernatetool] log4j:WARN No appenders could be found for logger (org.hibernate.cfg.Environment).\n[hibernatetool] log4j:WARN Please initialize the log4j system properly.\n[hibernatetool] An exception occurred while running exporter #2:hbm2hbmxml (Generates a set of hbm.xml files)\n[hibernatetool] To get the full stack trace run ant with -verbose\n[hibernatetool] org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available\n\nBUILD FAILED\nC:\\Users\\mrtykop\\workspace2\\testjavahib\\build.xml:26: org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available\n    at org.hibernate.tool.ant.HibernateToolTask.reportException(HibernateToolTask.java:226)\n    at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:189)\n    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n    at org.apache.tools.ant.Task.perform(Task.java:348)\n    at org.apache.tools.ant.Target.execute(Target.java:390)\n    at org.apache.tools.ant.Target.performTasks(Target.java:411)\n    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)\n    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)\n    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n    at org.eclipse.ant.internal.launching.remote.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)\n    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)\n    at org.eclipse.ant.internal.launching.remote.InternalAntRunner.run(InternalAntRunner.java:424)\n    at org.eclipse.ant.internal.launching.remote.InternalAntRunner.main(InternalAntRunner.java:138)\nCaused by: org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available\n    at org.hibernate.dialect.resolver.DialectFactory.buildDialect(DialectFactory.java:107)\n    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:142)\n    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2163)\n    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2155)\n    at org.hibernate.cfg.JDBCMetaDataConfiguration.readFromJDBC(JDBCMetaDataConfiguration.java:41)\n    at org.hibernate.tool.ant.JDBCConfigurationTask.doConfiguration(JDBCConfigurationTask.java:83)\n    at org.hibernate.tool.ant.ConfigurationTask.getConfiguration(ConfigurationTask.java:55)\n    at org.hibernate.tool.ant.HibernateToolTask.getConfiguration(HibernateToolTask.java:302)\n    at org.hibernate.tool.ant.HibernateToolTask.getProperties(HibernateToolTask.java:318)\n    at org.hibernate.tool.ant.ExporterTask.configureExporter(ExporterTask.java:94)\n    at org.hibernate.tool.ant.ExporterTask.execute(ExporterTask.java:39)\n    at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:186)\n    ... 16 more\n</code></pre>\n"},{"tags":["hibernate","database-design","jpa"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12909365,"title":"Database Model Table for each Relationship?","body":"<p>I have a question modelling a relationship in my database.</p>\n\n<p>I have a table \"comment\" and three tables \"user\", \"car\", \"house\". Every user can comment on user, cars and houses.</p>\n\n<p>Normally this would result in a relationship where all fks are hold in table \"comment\" like car_id, house_id, user_id. But these relationships are exclusive so its not possible to have a comment which belongs to a car and house.</p>\n\n<p>Is it wise now to have all the fks in the comment table? So if we want to extend(e.g. comments on pictures) it could result in a lot of nullable fks.</p>\n\n<p>Or is it a good choice to have a new table for each relationship like \"UserComment\", \"CarComment\" and \"HouseComment\".</p>\n\n<p>I hope this is not a duplicate but I found it very hard to search this issue.</p>\n\n<p>Thank you!</p>\n"},{"tags":["java","spring","hibernate","entitymanager"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12937394,"title":"EntityManager cannot use persist to save element to database(solved)","body":"<p>I met the problem of persisting element to database using EntityManager. Based on the  answers I found, I tried those 4 ways in my DaoJpa to do such thing but still failed. Here I attached the four ways I tried:</p>\n\n<p>Code in Controller part:</p>\n\n<pre><code>   @Transactional \n   SmartProduct smartProduct = new SmartProduct();\n            smartProduct.setName(\"Dove Soap\");\n            smartProductDao.persist(smartProduct);\n</code></pre>\n\n<p>1.\n    DaoJpa:</p>\n\n<pre><code> @Transactional\n public void persist(SmartProduct smartProduct) {\n            entityManager.persist(smartProduct);\n</code></pre>\n\n<p>Doesn't work!</p>\n\n<p>2.</p>\n\n<pre><code>@Transactional\npublic void persist(SmartProduct smartProduct) {\nentityManager.persist(smartProduct);\nentityManager.flush();\n</code></pre>\n\n<blockquote>\n  <p>Exception I got: no transaction is in progress</p>\n</blockquote>\n\n<p>3.</p>\n\n<pre><code>@Transactional\npublic void persist(SmartProduct smartProduct) {\nEntityTransaction emTransaction = entityManager.getTransaction();\n        emTransaction.begin();  \n        entityManager.persist(smartProduct);\n        emTransaction.commit();\n        entityManager.close();\n</code></pre>\n\n<blockquote>\n  <p>Exception I got:\n      Not allowed to create transaction on shared EntityManager - use Spring \n      transactions or EJB CMT instead</p>\n</blockquote>\n\n<p>4.</p>\n\n<pre><code>@Transactional\npublic void persist(SmartProduct smartProduct) {\n                    EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"persistenceUnit\");\n                EntityManager em = emf.createEntityManager();\n                EntityTransaction etx = em.getTransaction();\n                etx.begin();\n                em.persist(smartProduct);\n                etx.commit();\n                em.close();\n                emf.close();\n</code></pre>\n\n<blockquote>\n  <p>Exception I got:\n      The application must supply JDBC connections</p>\n</blockquote>\n\n<p>Could someone help me  figure out the problem please? Many thanks in advance! </p>\n\n<p>Many thanks JustinKSU's help. I add the annotation in Spring context and then it solved!\nHere is the previous version of my Spring context:</p>\n\n<pre><code>&lt;bean class=\"org.springframework.orm.jpa.JpaTransactionManager\" id=\"transactionManager\"&gt;\n        &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;tx:annotation-driven mode=\"aspectj\" transaction-manager=\"transactionManager\" /&gt;\n\n    &lt;bean class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\" id=\"entityManagerFactory\"&gt;\n        &lt;property name=\"persistenceUnitName\" value=\"persistenceUnit\" /&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<p>After added the </p>\n\n<pre><code>&lt;tx:annotation-driven /&gt;\n</code></pre>\n\n<p>it works:</p>\n\n<pre><code>&lt;tx:annotation-driven /&gt;\n    &lt;bean class=\"org.springframework.orm.jpa.JpaTransactionManager\" id=\"transactionManager\"&gt;\n        &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;tx:annotation-driven mode=\"aspectj\" transaction-manager=\"transactionManager\" /&gt;\n\n    &lt;bean class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\" id=\"entityManagerFactory\"&gt;\n        &lt;property name=\"persistenceUnitName\" value=\"persistenceUnit\" /&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;/bean&gt;\n</code></pre>\n"},{"tags":["hibernate","groovy","classloader"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":78,"score":2,"question_id":12923232,"title":"How do I register a custom classloader with Hibernate's ClassLoaderService?","body":"<h2>Background</h2>\n\n<p>I have a set of Groovy files which I parse as classes using Groovy's classloader:</p>\n\n<pre><code>    GroovyClassLoader gcl = new GroovyClassLoader();\n    while (groovyIter.hasNext()) {\n      File groovyFile = (File) groovyIter.next();\n      try {\n        Class clazz = gcl.parseClass(groovyFile);\n      } catch (IOException ioe) {\n        log.error(\"Unable to read file \" + groovyFile + \" to parse class \", ioe);\n      }\n    }\n</code></pre>\n\n<p>Once the GroovyClassLoader is complete I parse XML files using XStream to deserialize the XML as different instances of Groovy objects. I'm starting with one type for now: invoice. So that XStream can see the groovy classes, I set the classloader to be the instance of the GroovyClassLoader.</p>\n\n<pre><code>  XStream xstream = new XStream();\n  xstream.setClassLoader(gcl); \n\n  // Read the file and get objects\n  Object deserialized = xstream.fromXML(file);\n</code></pre>\n\n<p>Once I have the de-serialized object I want to store it in a database using Hibernate. In my hibernate.config.xml I have a mapping entry </p>\n\n<p>&lt;mapping class=\"invoice\"/&gt;</p>\n\n<p>Which maps to my annotated groovy class</p>\n\n<pre><code>import javax.persistence.Entity\nimport javax.persistence.GeneratedValue\nimport javax.persistence.Id\nimport javax.persistence.GenerationType\nimport groovy.transform.ToString\nimport groovy.transform.EqualsAndHashCode\nimport javax.persistence.Table\nimport javax.persistence.Column\n\n@ToString\n@EqualsAndHashCode\n@Entity\n@Table(name=\"invoice\")\nclass invoice {\n  @Id\n  @GeneratedValue(strategy = GenerationType.AUTO)\n  Long id\n\n  String invoicedate\n  String invoicenumber\n\n  String ponumber\n  String salesrep\n  String servicedate\n  String terms\n  String duedate\n\n  String notes\n  String subtotal\n  String discountpercent\n  String discountamount\n  String total\n  String paid\n  String totaldue\n\n}\n</code></pre>\n\n<h2>The problem:</h2>\n\n<p>When I try to open a session I get class not found.</p>\n\n<pre><code>    Configuration hibernateConfig = new Configuration();\n\n    Properties hibernateConfigProps = hibernateConfig.getProperties();\n    hibernateConfigProps.put(\"hibernate.classLoader.application\", gcl);\n    hibernateConfig.setProperties(hibernateConfigProps);\n\n    SessionFactory sf = hibernateConfig.configure(new File(\"hibernate.config.xml\")).buildSessionFactory();        \n    Session sess = sf.openSession();\n</code></pre>\n\n<p>Caused by: org.hibernate.MappingException: Unable to load class [ invoice] declared in Hibernate configuration  entry.</p>\n\n<p>I tried setting hibernate.classLoader.application property to the GroovyClassLoader instance and then setting the property in the configuration, but no luck.</p>\n\n<p>My searches have turned up that I might need to use org.hibernate.service.classloading.spi.ClassLoaderService but I'm not sure how to do this with Hibernate.</p>\n\n<p>See below for stacktrace:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:601)\n    at com.simontuffs.onejar.Boot.run(Boot.java:342)\n    at com.simontuffs.onejar.Boot.main(Boot.java:168)\nCaused by: org.hibernate.MappingException: Unable to load class [ invoice] declared in Hibernate configuration &lt;mapping/&gt; entry\n    at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:2139)\n    at org.hibernate.cfg.Configuration.parseSessionFactory(Configuration.java:2087)\n    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2067)\n    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2020)\n    at org.hibernate.cfg.Configuration.configure(Configuration.java:1993)\n    at com.referencelogic.xmlormupload.main.XmlormuploadMain.run(XmlormuploadMain.java:101)\n    at     com.referencelogic.xmlormupload.main.XmlormuploadMain.main(XmlormuploadMain.java:54)\n    ... 6 more\nCaused by: java.lang.ClassNotFoundException: invoice\n    at com.simontuffs.onejar.JarClassLoader.findClass(JarClassLoader.java:713)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)\n    at com.simontuffs.onejar.JarClassLoader.loadClass(JarClassLoader.java:630)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n    at java.lang.Class.forName0(Native Method)\n    at java.lang.Class.forName(Class.java:186)\n    at org.hibernate.internal.util.ReflectHelper.classForName(ReflectHelper.java:192)\n    at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:2136)\n    ... 12 more\n</code></pre>\n\n<p>Tried as suggested setting the thread's context class loader, but Hibernate is ignoring it.</p>\n\n<pre><code>    ClassLoader oldcl = Thread.currentThread().getContextClassLoader();        \n    System.out.println(\"Old classloader is \" + oldcl);\n    Thread.currentThread().setContextClassLoader(gcl);\n    ClassLoader newcl = Thread.currentThread().getContextClassLoader();\n    System.out.println(\"New classloader is \" + newcl);\n\n    Configuration hibernateConfig = new Configuration();\n\n    System.out.println(\"Hibernate config class loader is: \" + hibernateConfig.getClass().getClassLoader());\n</code></pre>\n\n<p>results in </p>\n\n<pre><code>Old classloader is com.simontuffs.onejar.JarClassLoader@5c58d6b0\nNew classloader is groovy.lang.GroovyClassLoader@3ed4b480\nHibernate config class loader is: com.simontuffs.onejar.JarClassLoader@5c58d6b0\n</code></pre>\n\n<p>Followed by the previously mentioned stack trace.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["spring","hibernate","tomcat","spring-security"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12937977,"title":"using spring 3 latest source in apache tomcat 6.0.14","body":"<p>Is latest spring 3 framework compatible with apache tomcat application server - version 6.0.14?</p>\n\n<p>Also can what is the best version of hibernate i can use along with latest version of spring. </p>\n\n<p>Is it fine to use configuration xml file in the spring 3 application setup instead of @configuration annotation in the code ?</p>\n\n<p>Please share your thoughts.</p>\n\n<p>Thanks</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12937830,"title":"How to set a global query timeout for hibernate / mysql?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2101455/hibernate-set-default-query-timeout\">Hibernate: set default query timeout?</a>  </p>\n</blockquote>\n\n\n\n<p>It seems I can set a timeout for hibernate queries on a per query basis, but not on global basis.  Looking at my datasource configuration and JDBC driver properties, it seems I can set a connection timeout, but not a timeout for query time (I am assuming these are different, because the socket has not timed out if the query is taking a long time?)  The best solution I have found is to create a stored procedure on the MySql server which kills off all long running queries, but I am looking to see if there is something on the application level?</p>\n"},{"tags":["java","hibernate","orm","jpa","enums"],"answer_count":3,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":1021,"score":9,"question_id":3639225,"title":"SINGLE_TABLE inheritance strategy using enums as discriminator value","body":"<p>Is it possible to use an enum as a discriminator value when using SINGLE_TABLE inheritance strategy?</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12935248,"title":"Current Time/Date Code Error","body":"<p>How do I get Current Time as this code is giving (Time-->Thu Jan 01 05:56:27 ACT 1970)?? </p>\n\n<pre><code>DateFormat timeFormat = new SimpleDateFormat(\"HH:mm:ss.SS\"); \n         Date time = new Date(); \n         String currentTime=timeFormat.format(time);\n         time=timeFormat.parse(currentTime);\n         System.out.println(\"Time--&gt;\"+time);\n         salesOrder.setOrderTime(time);\n</code></pre>\n"},{"tags":["java","eclipse","hibernate","spring-mvc","jar"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":270,"score":0,"question_id":12509579,"title":"Could not initialize class net.sf.cglib.proxy.Enhancer","body":"<p>Getting the following error when trying to run a spring mvc application with hibernate in eclipse.</p>\n\n<pre><code>java.lang.NoClassDefFoundError: Could not initialize class net.sf.cglib.proxy.Enhancer\norg.springframework.aop.framework.Cglib2AopProxy.createEnhancer(Cglib2AopProxy.java:229)\norg.springframework.aop.framework.Cglib2AopProxy.getProxy(Cglib2AopProxy.java:171)\norg.springframework.aop.framework.ProxyFactory.getProxy(ProxyFactory.java:112)\norg.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.createProxy(AbstractAutoProxyCreator.java:476)\norg.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:362)\norg.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:322)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:407)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1461)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\norg.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\norg.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\norg.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\norg.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:876)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:818)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)\norg.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredMethodElement.inject(AutowiredAnnotationBeanPostProcessor.java:551)\norg.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)\norg.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\norg.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\norg.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\norg.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\norg.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:876)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:818)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:735)\norg.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:795)\norg.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:723)\norg.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:196)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)\norg.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\norg.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\norg.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\norg.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\norg.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)\norg.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)\norg.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)\norg.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)\norg.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)\norg.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)\norg.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)\norg.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)\norg.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)\norg.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)\njavax.servlet.GenericServlet.init(GenericServlet.java:160)\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\norg.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\norg.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)\norg.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\norg.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\njava.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\njava.lang.Thread.run(Thread.java:679)\n</code></pre>\n\n<p>I've placed cglib-nodep-2.2.3 .jar into my web-inf/lib folder but I'm continuing to get the same error. Not sure why as the class is there in the jar. I get the same error message whether or not the jar is there.</p>\n"},{"tags":["spring","hibernate","jpa-2.0","jboss5.x"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":277,"score":2,"question_id":10642868,"title":"Persistence unit not finding managed entity","body":"<p><code>@PersistenceContext</code> entity manager cannot find an/any entity class which it appeared to have processed during container launch.</p>\n\n<p>During persistence unit setup, it appears that the container finds and registers the entity:</p>\n\n<pre><code>2012-05-17 15:28:21,978 INFO  [org.hibernate.cfg.annotations.Version] (main) Hibernate Annotations 3.4.0.GA\n2012-05-17 15:28:21,997 INFO  [org.hibernate.annotations.common.Version] (main) Hibernate Commons Annotations 3.1.0.GA\n2012-05-17 15:28:22,004 INFO  [org.hibernate.ejb.Version] (main) Hibernate EntityManager 3.4.0.GA\n2012-05-17 15:28:22,039 INFO  [org.hibernate.ejb.Ejb3Configuration] (main) Processing \nPersistenceUnitInfo [\n    name: dashboardPu\n    ...]\n2012-05-17 15:28:22,069 WARN  [org.hibernate.ejb.Ejb3Configuration] (main) Persistence provider caller does not implement the EJB3 spec correctly. PersistenceUnitInfo.getNewTempClassLoader() is null.\n2012-05-17 15:28:22,146 INFO  [org.hibernate.cfg.AnnotationBinder] (main) Binding entity from annotated class: scholastic.dashboard.dto.ReportRequest\n2012-05-17 15:28:22,161 INFO  [org.hibernate.cfg.annotations.QueryBinder] (main) Binding Named query: ReportRequest.getReportsByUser =&gt; from ReportRequest where userId = :userId\n</code></pre>\n\n<p>However, the later attempt to use that entity fails. I've verified that the entitymanager is indeed using dashboardPu (there are 3 persistence units in this ear) by dropping into the debugger and looking through the entitymanager>factory>persistenceUnit.</p>\n\n<pre><code>2012-05-17 15:28:54,730 DEBUG [org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter] (http-127.0.0.1-8080-2) Opening JPA EntityManager in OpenEntityManagerInViewFilter\n2012-05-17 15:28:54,731 DEBUG [org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter] (http-127.0.0.1-8080-1) Using EntityManagerFactory 'dashboardEntityManagerFactory' for OpenEntityManagerInViewFilter\n2012-05-17 15:28:54,731 DEBUG [org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter] (http-127.0.0.1-8080-1) Opening JPA EntityManager in OpenEntityManagerInViewFilter\n2012-05-17 15:28:54,775 DEBUG [scholastic.dashboard.dao.ReportRequestDao] (http-127.0.0.1-8080-2) Get reports for secretuserid\n2012-05-17 15:28:54,797 WARN  [org.hibernate.hql.QuerySplitter] (http-127.0.0.1-8080-2) no persistent classes found for query class: from scholastic.dashboard.dto.ReportRequest where user_id = secretuserid\n</code></pre>\n\n<p>I got here by first having it fail to find the <code>\"ReportRequest.getReportsByUser\"</code> query using <code>em.createNamedQuery()</code>, then trying a query w/o using the full path name to the entity class <code>from ReportRequest where userId = :userId</code>, and then the query in the last code block line above.</p>\n\n<p>Using JBoss 5.1, JPA 2, Hibernate 3.3 or 3.6, Spring 3.0.5.</p>\n\n<p>Code snippets:</p>\n\n<pre><code>@Entity\n@Table(name=\"td_report_request\")\n@NamedQueries({\n@NamedQuery(name=ReportRequestDao.GET_REPORTS_BY_USER, \n        query=\"from ReportRequest where userId = :userId\"),\n})\npublic class ReportRequest extends SlmsGuidAbstract {...}\n\n...\n@Repository\npublic class ReportRequestDao {\n\n    @PersistenceContext\n    private EntityManager em;\n\n    public List&lt;ReportRequest&gt; getReportRequests(String userId) {\n    // TODO uncomment this line and remove the one after when we go to JBoss &gt;= 6\n//      TypedQuery&lt;ReportRequest&gt; query = em.createNamedQuery(GET_REPORTS_BY_USER, ReportRequest.class);\n//      Query query = em.createNamedQuery(GET_REPORTS_BY_USER);\n    Query query = em.createQuery(\"from scholastic.dashboard.dto.ReportRequest where user_id = \" + userId);\n\n...\n&lt;bean id=\"dashboardEntityManagerFactory\"\n      class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n      &lt;property name=\"dataSource\" ref=\"lycea.ds.jndi-MySqlDS\" /&gt;\n      &lt;property name=\"persistenceUnitName\" value=\"dashboardPu\"/&gt;\n&lt;/bean&gt;\n...\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"\n         version=\"2.0\"&gt;\n&lt;persistence-unit name=\"dashboardPu\" transaction-type=\"JTA\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n    &lt;jta-data-source&gt;java:/MySqlDS&lt;/jta-data-source&gt;\n    &lt;properties&gt;\n        &lt;property name=\"jboss.entity.manager.factory.jndi.name\" value=\"java:/dashboardPu\"/&gt;\n        &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.MySQLDialect\"/&gt;\n        &lt;property name=\"hibernate.query.factory_class\" value=\"org.hibernate.hql.ast.ASTQueryTranslatorFactory\"/&gt;\n        &lt;property name=\"hibernate.connection.release_mode\" value=\"auto\"/&gt;\n        &lt;property name=\"hibernate.transaction.manager_lookup_class\" value=\"org.hibernate.transaction.JBossTransactionManagerLookup\" /&gt;\n        &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"update\"/&gt;\n    &lt;/properties&gt;\n&lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n"},{"tags":["java","hibernate","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12930935,"title":"IllegalArgumentException: expecting IdClass mapping","body":"<p>During deploying my app I occurs on that exception. I have a lot of class in my app and I dont know where I must to place <code>@IdClass</code> and what does this exception mean anyway.\nI am using Hibernate 4.1 and JBoss AS 7.1</p>\n\n<pre><code>12:10:23,761 INFO  [org.hibernate.engine.jdbc.internal.LobCreatorBuilder] (MSC service thread 1-5) HHH000424: Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException\n12:10:24,075 ERROR [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-5) HHH000389: Unsuccessful: drop sequence hibernate_sequence\n12:10:24,076 ERROR [org.hibernate.tool.hbm2ddl.SchemaExport] (MSC service thread 1-5) ERROR: sequence \"hibernate_sequence\" does not exist\n12:10:24,281 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-5) MSC00001: Failed to start service jboss.persistenceunit.\"kladr.ear/kladr-ejb-1.0-SNAPSHOT.jar#primary\": org.jboss.msc.service.StartException in service jboss.persistenceunit.\"kladr.ear/kladr-ejb-1.0-SNAPSHOT.jar#primary\": Failed to start service\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1767) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_35]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_35]\n    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_35]\nCaused by: java.lang.IllegalArgumentException: expecting IdClass mapping\n    at org.hibernate.ejb.metamodel.AttributeFactory$3.resolveMember(AttributeFactory.java:878)\n    at org.hibernate.ejb.metamodel.AttributeFactory$4.resolveMember(AttributeFactory.java:915)\n    at org.hibernate.ejb.metamodel.AttributeFactory.determineAttributeMetadata(AttributeFactory.java:423)\n    at org.hibernate.ejb.metamodel.AttributeFactory.buildAttribute(AttributeFactory.java:91)\n    at org.hibernate.ejb.metamodel.MetadataContext.wrapUp(MetadataContext.java:214)\n    at org.hibernate.ejb.metamodel.MetamodelImpl.buildMetamodel(MetamodelImpl.java:64)\n    at org.hibernate.ejb.EntityManagerFactoryImpl.&lt;init&gt;(EntityManagerFactoryImpl.java:91)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:904)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:889)\n    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n    at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.createContainerEntityManagerFactory(PersistenceUnitServiceImpl.java:162)\n    at org.jboss.as.jpa.service.PersistenceUnitServiceImpl.start(PersistenceUnitServiceImpl.java:85)\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    ... 3 more\n</code></pre>\n"},{"tags":["hibernate","hibernate-mapping"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12935077,"title":"Hibernate mapping element differs with the strategey like between Unidirectional and Unidirectional with join table","body":"<p>I have seen in the documentation (best practices ) in the hibernate documentation that we have four categories basically </p>\n\n<p><a href=\"http://docs.jboss.org/hibernate/core/4.0/manual/en-U/html/associations.html\" rel=\"nofollow\">Hibernate Mapping </a>  </p>\n\n<p>1 .UniDirectional \n2. UniDirectinal with Join table \n3 . BiDirection \n4. BiDirectional with join table </p>\n\n<p>For ex   ONE TO ONE (in Unidirectional)    many-to-one with unique= true<br>\n         ONE TO MANY(in Unidirectional with Join table)    many-to-many  with unique =true </p>\n\n<p>when we have elements as one-to-one or one-to-many then why are we using this type of work-arounds or manipulation to get it . </p>\n"},{"tags":["hibernate","many-to-many","rdbms","hbmxml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12934603,"title":"How to add extra columns in many to many join table in hbm.xml : hibernate?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1153409/can-add-extra-fields-to-manytomany-hibernate-extra-table\">Can add extra field(s) to @ManyToMany Hibernate extra table?</a>  </p>\n</blockquote>\n\n\n\n<p>Here is my problem,is there any way to add extra columns in many to many join table using hbm.xml files in hibernate. Just like:</p>\n\n<pre><code>Create table employee(\nemp_id int primary key,\nemp_name varchar(50)\n);\n\nCreate table address(\naddress_id int primary key,\naddress varchar(500)\n);\n\nCreate table employee_address(\nemp_id int,\naddress_id int,\n/********** this is an extra column **********/\nno_of_letters_sent int,\n\nforeign key(emp_id) references employee(emp_id),\nforeign key(address_id) references address(address_id)\n);\n</code></pre>\n\n<p>How to make hbm.xml files for third table?</p>\n"},{"tags":["hibernate","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12933731,"title":"Why some associations in hibernate are very unusal what the reason behind their unusualness","body":"<p>I was going through the hibernate documentation and i got the following </p>\n\n<p><em><strong>UNI = Unidirectional</em></strong>  and <strong><em>Bi = BiDirectional</em></strong></p>\n\n<pre><code>                     OneToOne      OneToMany         ManyToOne       ManyToMany \nUni                  ok                UNUSUAL       MOST COMMON      \nUni with Join Tbl    UNUSUAL                        Common whn optional\nBi                   COMMON        &lt;------ Most Common ------------&gt;  \nBi with Join Tbl   Possible bt Unusual \n</code></pre>\n\n<p>So If we have Person and Phone Table and i want only person to know all its phone not phone the same (his owner) , Why it is unusual ? </p>\n\n<p>Or why some mapping is much preferred in its category(like in Uni , Uni with Join table , Bi, Bi with Join table)</p>\n"},{"tags":["java","hibernate","jpa","openjpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12933719,"title":"Auto Update OpenJPA tables","body":"<p>Is there a way to tell <code>OpenJPA</code> to automatically update tables in the database on application deployment?</p>\n\n<p>I know that hibernate has a property:</p>\n\n<pre><code>&lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/prop&gt;\n</code></pre>\n\n<p>Is there something similar in <code>OpenJPA</code>?</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12920349,"title":"Random errors with Threads and Hibernate sessions","body":"<p>Im using hibernate3 and spring.</p>\n\n<p>Java code:</p>\n\n<p>Class CommunicationServiceImpl, method sendAllMessages:</p>\n\n<pre><code>Collection&lt;MessageToSend&gt; messagesToSend = this.repositoriesLocator.getMessageToSendRepository().getMessagesToSend();\n\n\n        Iterator&lt;MessageToSend&gt; iteratorMesToSe = messagesToSend.iterator();\n        while (iteratorMesToSe.hasNext()) {\n            MessageToSend mts = iteratorMesToSe.next();\n\n            MessageSender sender = new SmsSender(mts, this.repositoriesLocator);\n            sender.start(); //run thread                \n        }\n</code></pre>\n\n<p>SmsSender:</p>\n\n<pre><code>public class SmsSender extends MessageSender {\n\npublic SmsSender(MessageToSend messageToSend, RepositoriesLocator repositoriesLocator) {\n    super(messageToSend, repositoriesLocator);      \n}\n\npublic void sendMessages() {            \n    try {\n        MessageToSendSms messageToSendSms = (MessageToSendSms) this.messageToSend;                                                      \n        Iterator&lt;CustomerByMessage&gt; itCbmsgs = messageToSendSms.getCustomerByMessage().iterator();          \n        while (itCbmsgs.hasNext()) {                \n            CustomerByMessage cbm = (CustomerByMessage) itCbmsgs.next();        \n\n            //sms sending                           \n            String sResult = this.sendSMS(cb.getBody(), cbm.getCellPhone());\n            cbm.setStatus(CustomerByMessageStatus.SENT_OK);\n            cbm.setSendingDate(Calendar.getInstance().getTime());                               \n        }\n\n        messageToSendSms.setStatus(messageToSendStats.PROCESSED)\n        this.log.info(\"saving messageToSend...\"); \n        //this line dont work!\n        this.repositoriesLocator.getMessageToSendRepository().update(messageToSendSms);         \n        this.log.info(\"messageToSend saved!\");                      \n    } catch (Exception e) {         \n        this.log.error(\"Error sms sender \" + e.getMessage());\n    }       \n}\n</code></pre>\n\n<p>This is a part of my appContext.xml:</p>\n\n<pre><code>&lt;bean id=\"serviceCommunication\"\n    class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\"&gt;\n        &lt;ref local=\"transactionManager\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"target\"&gt;\n        &lt;ref local=\"communicationServiceImpl\" /&gt;\n    &lt;/property&gt;             \n    &lt;property name=\"transactionAttributes\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"communicationServiceImpl\"\n    class=\"com.ninatec.fnet3.services.communication.impl.CommunicationServiceImpl\"\n    parent=\"serviceParent\"&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>HibernateRepository<br>\nrepositoriesLocator.getMessageToSendRepository().update CODE:</p>\n\n<pre><code>public void update(MessageToSend messageToSend) {\n    try {\n        this.getSession().update(messageToSend);\n    } catch (HibernateException e) {\n        this.log.error(e.getMessage(), e);\n        throw e;\n    }\n}\n</code></pre>\n\n<p>The entity MessageToSend, has never been updated.</p>\n\n<p>When I invoke CommunicationServiceImpl.sendAllMessages()  I have in a collection all messagesToSend.\nFor each MessageToSend I make a Thread to send the message.\nThe Thread smsSender works good, but not the persistence in the data base. Changes in the object MessageToSend has not been updated in my database.</p>\n\n<p>Randoms errors are:</p>\n\n<p>session closed,</p>\n\n<p>could not initialize proxy - no Session,</p>\n\n<p>could not initialize proxy - the owning Session was closed,</p>\n\n<p>Illegal attempt to associate a collection with two open sessions in hibernate and</p>\n\n<p>failed to lazily initialize a collection of role: no session or session was closed</p>\n\n<hr>\n\n<ul>\n<li><ul>\n<li>about the thread. I want to use one thread for x sms. Every smsSender, send a group of sms.</li>\n</ul></li>\n</ul>\n\n<p>I dont understand how detach the objects from session explicitly in my architecture.</p>\n"},{"tags":["query","hibernate","many-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12932207,"title":"Hibernate: Inner Join Mapped and Unmapped Table using HibernateTempate","body":"<p>I have the following tables:</p>\n\n<pre><code>USER\n    ID VARCHAR(32) INTEGER NOT NULL\n\nROLE\n    ID INTEGER NOT NULL\n\nUSERROLE /*Many to Many*/\n    USER_ID VARCHAR(32) NOT NULL\n    ROLE_ID INTEGER NOT NULL\n</code></pre>\n\n<p>and I'm using annotations to Map the DB Tables to my Classes.</p>\n\n<pre><code>/* Mapping for USER table */\n@Entity\n@Table (name=\"USER\")\npublic class User{\n    @Id\n    @Column (name=\"ID\")\n    private String id;\n\n    @ManyToMany \n    @JoinTable (name=\"USERROLE\", joinColumns = {@JoinColumn (name=\"USER_ID\")}, \n            inverseJoinColumns = {@JoinColumn (name=\"ROLE_ID\")})\n    @LazyCollection (LazyCollectionOption.FALSE)\n    private List&lt;Role&gt; roles;\n}\n\n/* Mapping for ROLE table */\n@Entity\n@Table (name=\"ROLE\")\npublic class Role {\n    @Id\n    @Column (name=\"ID\")\n    private int id;\n\n}\n</code></pre>\n\n<p>Now I would like to do a query that Joins ROLE and USERROLE tables so that i could get those ROLEs that has user assigned to it.</p>\n\n<p>--EDIT</p>\n\n<p>I have the Role.id, and I want to check whether this Role is being referenced in the USERROLE table. in native SQL, I would do it this way:</p>\n\n<pre><code>SELECT DISTINCT A.* from ROLE A INNER JOIN USERROLE B \nWHERE A.ID = B.ROLE_ID AND A.ID = ?;\n</code></pre>\n\n<p>how to do it in hibernate using HibernateTemplate?</p>\n"},{"tags":["spring","hibernate","configuration","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12832444,"title":"Can I load attribute values of a Hibernate mapping file from a properties file?","body":"<p>Does Hibernate or the combination of Spring Framework and Hibernate (I'm working on a Java web app which uses Spring 2.5 and Hibernate 3.2) offer any mechanism for loading attribute values in Hibernate's hbm.xml mapping files from e.g. <code>properties</code> files?</p>\n\n<p>More specifically some of our domain objects are mapped to a different database catalog than most of the Hibernate mapped classes. Thus we use the <code>catalog=\"secondaryCatalogName\"</code> attribute to specify the catalog name for these classes.</p>\n\n<p>We use a <code>database.properties</code> file and Spring's <code>PropertyPlaceholderConfigurer</code> to specify the default and secondary catalog names in all of our Spring configuration. However, if I need to change the secondary catalog name, I also have to change the catalog attribute in those few hbm.xml -files. It would be great if I could use a placeholder such as <code>${secondary.catalog}</code> for the catalog attribute in the mapping files as well. </p>\n\n<p>Is this possible?</p>\n\n<p>Here's a simplified example using configuration snippets:</p>\n\n<p><strong>Database structure</strong></p>\n\n<pre><code>MySQL instance\n- catalog: CatalogA\n    - table: TableFoo\n    - table: TableBar\n    - ...\n- catalog: CatalogB\n    - table: TableBaz\n    - ...\n</code></pre>\n\n<p><strong>database.properties</strong></p>\n\n<pre><code>primary.catalog=CatalogA\nsecondary.catalog=CatalogB # &lt;-- wish I could use this property in hbm.xml\n</code></pre>\n\n<p><strong>SessionFactory -configuration (Spring):</strong></p>\n\n<pre><code>&lt;bean id=\"sessionFactory\" class=\"...hibernate3.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"mappingResources\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;Foo.hbm.xml&lt;/value&gt;\n            &lt;value&gt;Bar.hbm.xml&lt;/value&gt;\n            &lt;value&gt;Baz.hbm.xml&lt;/value&gt;\n            ...\n        &lt;/list&gt;\n    &lt;/property&gt; \n\n   ...\n\n    &lt;property name=\"hibernateProperties\"&gt;\n       &lt;props&gt;\n           ...\n           &lt;prop key=\"hibernate.default_catalog\"&gt;${primary.catalog}&lt;/prop&gt;\n       &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;                 \n</code></pre>\n\n<p><strong>Foo.hbm.xml:</strong></p>\n\n<p>Hibernate mapping for a domain object in <strong>CatalogA</strong> (CatalogA entity mappings always work fine because of <code>hibernate.default_catalog</code> property)</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n    &lt;class name=\"Foo\" table=\"TableFoo\"&gt;\n    ...\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p><strong>Baz.hbm.xml:</strong></p>\n\n<p>Hibernate mapping for a domain object in <strong>CatalogB</strong> (this is the problem because of the <strong>catalog</strong> attribute: it must change in <em>all</em> hbm.xmls of CatalogB entities if I want to use a different secondary catalog name)</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n    &lt;class name=\"Baz\" table=\"TableBaz\" catalog=\"CatalogB\"&gt;\n    ...\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":113,"score":0,"question_id":12933043,"title":"Hibernate,one-to-many, children not inserted with parent","body":"<p>I have a bi-direction one-to-many relationship, ie one parent can have many children, one child must have one parent, many children can have the same parent.</p>\n\n<p>See the following hibernate xml config. This works fine for loading the objects. Selecting a parent by its id successfully returns the parent object that includes a set of its children (if any).</p>\n\n<p>However when I create a new parent, add some children and then ask hibernate to create the parent, the children aren't saved along with it. I would have thought hibernate would take care of that for me?</p>\n\n<p>I suspect my issue is because the parent has a db managed sequence as an id so the children can't have their parent's id until after the parent is inserted. But then this shouldn't be too difficult for hibernate to handle should it?</p>\n\n<p>Parent.hbm.xml;</p>\n\n<pre><code>&lt;hibernate-mapping default-cascade=\"none\"&gt;\n    &lt;class name=\"com.mydomain.ParentImpl\" table=\"PARENT\" dynamic-insert=\"false\" dynamic-update=\"false\"&gt;\n        &lt;id name=\"id\" type=\"java.lang.Long\" unsaved-value=\"null\"&gt;\n            &lt;column name=\"ID\" sql-type=\"BIGINT\"/&gt;\n            &lt;generator class=\"sequence\"&gt;\n                &lt;param name=\"sequence\"&gt;PARENT_SEQ&lt;/param&gt;\n            &lt;/generator&gt;\n        &lt;/id&gt;\n        ....\n        lots of other properties\n        ...\n        &lt;set name=\"children\" lazy=\"true\" fetch=\"select\" inverse=\"true\"&gt;\n            &lt;key foreign-key=\"parent_child_fkc\"&gt;\n                &lt;column name=\"PARENT_FK\" sql-type=\"BIGINT\"/&gt;\n            &lt;/key&gt;\n            &lt;one-to-many class=\"com.mydomain.ChildImpl\" not-found=\"exception\"/&gt;\n        &lt;/set&gt;\n   &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Child.hbm.xml;</p>\n\n<pre><code>&lt;hibernate-mapping default-cascade=\"none\"&gt;\n    &lt;class name=\"com.mydomain.ChildImpl\" table=\"CHILD\" dynamic-insert=\"false\" dynamic-update=\"false\"&gt;\n        &lt;id name=\"id\" type=\"java.lang.Integer\" unsaved-value=\"null\"&gt;\n            &lt;column name=\"ID\" sql-type=\"INTEGER\"/&gt;\n            &lt;generator class=\"sequence\"&gt;\n                &lt;param name=\"sequence\"&gt;child_seq&lt;/param&gt;\n            &lt;/generator&gt;\n        &lt;/id&gt;\n        &lt;many-to-one name=\"parent\" class=\"com.mydomain.ParentImpl\" foreign-key=\"parent_child_fkc\" not-null=\"true\" lazy=\"proxy\" fetch=\"select\"&gt;\n            &lt;column name=\"PARENT_FK\" not-null=\"true\" sql-type=\"BIGINT\"/&gt;\n        &lt;/many-to-one&gt;\n        ...\n        lots of other properties\n        ...\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Assuming Parent class has a method;</p>\n\n<pre><code>public void addChild(Child child){\n    if(children == null) {\n        children = new HashSet&lt;Child&gt;();\n    }\n    children.add(child);\n    child.setParent(this);\n}\n</code></pre>\n\n<p>Then in code somewhere;</p>\n\n<pre><code>Parent parent = new Parent();\nparent.addChild(new Child());\nparent.addChild(new Child());\ngetHibernateTemplate().save(parent);\n</code></pre>\n\n<p>Result is Parent is saved to PARENT table, CHILD table remains empty.</p>\n"},{"tags":["java","spring","hibernate","exception"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":11490636,"title":"Why are exception in spring and hibernate most unchecked exception?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4609870/why-hibernate-changed-hibernateexception-to-runtimeexception-unchecked\">why hibernate changed HibernateException to RuntimeException (unchecked)</a>  </p>\n</blockquote>\n\n\n\n<p>What is the reason for keeping exception in spring and hibernate as unchecked exception?</p>\n\n<p>Is only to reduce the cluttering while coding or there is some other design principal behind it?</p>\n"},{"tags":["java","mysql","hibernate","driver"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2084,"score":0,"question_id":6378165,"title":"Problems using Hibernate - JDBC Driver class not found: com.mysql.jdbc.Driver","body":"<p>I have a really strange issue when using hibernate to connect to a MySQLDB and add data.</p>\n\n<p>This is the error I get:</p>\n\n<blockquote>\n  <p>JDBC Driver class not found:\n  com.mysql.jdbc.Driver</p>\n</blockquote>\n\n<p>This is how my hibernate.cfg.xml looks like</p>\n\n<pre><code>&lt;!DOCTYPE hibernate-configuration PUBLIC\n        \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n        \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/fpa-webapp&lt;/property&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLInnoDBDialect&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n        &lt;property name=\"hibernate.connection.password\"&gt;&lt;/property&gt;\n        &lt;property name=\"hbm2ddl.auto\"&gt;update&lt;/property&gt;\n        &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>I dont understand why I see a 500 Error when I navigate to the application; it says that the driver is not found.</p>\n\n<blockquote>\n  <p>HTTP ERROR 500</p>\n  \n  <p>Problem accessing /fpa-webapp/.\n  Reason:</p>\n\n<pre><code>Exception constructing service 'ValueEncoderSource': Error invoking\n</code></pre>\n  \n  <p>service builder method\n  org.apache.tapestry5.services.TapestryModule.buildValueEncoderSource(Map,\n  InvalidationEventHub) (at\n  TapestryModule.java:2287) (for service\n  'ValueEncoderSource'): Error invoking\n  service contribution method\n  org.apache.tapestry5.hibernate.HibernateModule.contributeValueEncoderSource(MappedConfiguration,\n  boolean, HibernateSessionSource,\n  Session, TypeCoercer, PropertyAccess,\n  LoggerSource): Exception constructing\n  service 'HibernateSessionSource':\n  Error invoking service builder method\n  org.apache.tapestry5.hibernate.HibernateCoreModule.buildHibernateSessionSource(Logger,\n  List, RegistryShutdownHub) (at\n  HibernateCoreModule.java:123) (for\n  service 'HibernateSessionSource'):\n  JDBC Driver class not found:\n  com.mysql.jdbc.Driver</p>\n</blockquote>\n\n<p>I'm sure the driver is in the class path.</p>\n\n<p>What it could be?</p>\n"},{"tags":["spring","hibernate","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":56,"score":-3,"question_id":12915045,"title":"Hibernate configuration for using PostgreSQL Schemas","body":"<p>I'm trying to use <a href=\"http://www.postgresql.org/docs/current/static/ddl-schemas.html\" rel=\"nofollow\">PostgreSQL Schemas</a> in my web app, but I'm having a hard time getting Hibernate to use them.</p>\n\n<p>By reading many posts I came to know that <a href=\"http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#services-MultiTenantConnectionProvider\" rel=\"nofollow\">Hibernate Multi-Tenant</a> is an approach which is required to be used for this. I've tried all possible kind of configurations to make it work but it's not working.</p>\n\n<p>Any pointers towards making this work would be really helpful.</p>\n\n<p>How to make Spring-Hibernate-PostgreSQL talk to one another?</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12915815,"title":"HQL Query Having group of column in IN clause","body":"<p>I need to convert the below SQL query into HQL query.</p>\n\n<blockquote>\n  <p>select * from table where (column1, column2 , column3) in\n  (('A','B','C'),('D','E','F'));</p>\n</blockquote>\n"},{"tags":["query","hibernate","jpa","jpql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":12922320,"title":"Hibernate query - How to select those parents that have ALL the children matching a value?","body":"<p>I'm trying to write a Hibernate (JPA) query to select those parents where <strong>ALL</strong> their children match a property.</p>\n\n<p>Let's make a pratical example... </p>\n\n<p>I want to select those fathers who have <strong>ALL</strong> their children blond. If just one is black haired the father is not selected.</p>\n\n<p>How will the query look like?\nThank you in advance!</p>\n"},{"tags":["java","spring","hibernate","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":12899315,"title":"Hibernate Criteria most recent date field of Collection","body":"<p>I have Laboratories with a collection of states, here are my simplified Classes:</p>\n\n<pre><code>    LabState {\n        private Integer id;\n        private State state;\n        private Date date;\n        private String comments;\n    }\n\n    State{\n        private Integer id;\n        private String name;\n\n    }\n\n    Lab{\n        private Integer id;\n        private List&lt;LabState&gt; states = new ArrayList&lt;LabState&gt;();\n        private Date date;\n        private String name\n    }\n</code></pre>\n\n<p>I want to get via Hibernate Criteria the Last State from a specific laboratory. in mySql this work fine:</p>\n\n<pre><code>SELECT ls.* FROM labs_states les INNER JOIN\n    ( SELECT idLab, idLabState, MAX(date) AS lastDate FROM labs_states GROUP BY idLab)\n        groupedLabs ON les.idLab = groupedLabs.idLab  AND les.date = groupedLabs.lastDate\n</code></pre>\n\n<p><strong>Edit: SearchMethod:</strong></p>\n\n<pre><code>   public List&lt;Labs&gt; search(LabSearch labSearch) {\n\n            SessionFactory sessionFactory = hibernateTemplate.getSessionFactory();\n            Session session = sessionFactory.openSession();\n\n            Criteria criteria = session.createCriteria(Lab.class);\n\n            criteria.add(Restrictions.like(\"name\", \"%\" + labSearch.getName() + \"%\"));\n\n            if(labSearch.getState() != null){\n                criteria.createCriteria(\"states\").add(Restrictions.eq(\"state\", labSearch.getState())).addOrder(Order.asc(\"date\")).list().get(0);\n\n\n            return (List&lt;Lab&gt;) criteria.list();\n}\n</code></pre>\n\n<p>I don't nkow how to do this with Criteria, or if there is any other way to do</p>\n\n<p>thanks</p>\n"},{"tags":["spring","hibernate","jpa","jpa-2.0","hibernate-annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12930686,"title":"JPA: Deleting detached instance","body":"<p>I get resultList from typedQuery object.\nI take first object from that list. </p>\n\n<p>eg. <code>LoginAttempt loginAttempt = loginAttempts.get(0);</code>  </p>\n\n<p>When, I update this object and call <code>entityManager.merge(loginAttempt);</code> it is updated successfully.</p>\n\n<p>But when I am going to delete this object it gives me exception ie. <code>java.lang.IllegalArgumentException: Removing a detached instance.</code></p>\n\n<p>Any suggestion. Thanks :)</p>\n\n<p>Actually, I want to remove only. I just mention merge because, I am get confused that merge is working but remove is not working...</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12929789,"title":"Current Date and Time (Java)","body":"<p>I have separate Coloums of Date and Time in Data Base and also they are mapped according to my bean (Using Hibernate), I want to save formatted (Date and Time) i.e 17 10 2012 and 2 : 47 Pm respectively. I am having problem of how do I get formatted date and time into there respective coloums as my Data Base coloums are set to Date and Time type but Formatted Date and Time return a String. Code example will be much appriciated. </p>\n\n<pre><code>DateFormat dateFormat = new SimpleDateFormat(\"ddMMyyyy\");\n        Date date = new Date();\n        salesOrder.setOrderDate(dateFormat.format(date));//Error:The method    setOrderDate(Date) in the type SalesOrder is not applicable for the arguments (String)\n</code></pre>\n"},{"tags":["hibernate","spring","maven","c3p0"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":615,"score":2,"question_id":6841596,"title":"C3P0 won't start configured in Hibernate properties with Spring?","body":"<p>I'm using Hibernate 3.3.1GA and Spring 3.0.2 (and Maven from eclipse). I added c3p0-0.9.1 jar to classpath, and first tried this approach (configuring c3p0 within datasource bean):</p>\n\n<pre><code>&lt;bean id=\"dataSource2\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\" destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClass\" value=\"${ora.driverClassName}\" /&gt;\n    &lt;property name=\"jdbcUrl\" value=\"${ora.url}\" /&gt;\n    &lt;property name=\"user\" value=\"${ora.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${ora.password}\" /&gt;\n\n    &lt;property name=\"minPoolSize\" value=\"${minPoolSize}\" /&gt;\n    &lt;property name=\"maxPoolSize\" value=\"${maxPoolSize}\" /&gt;\n    &lt;property name=\"maxIdleTime\" value=\"${maxIdleTime}\" /&gt;\n    &lt;property name=\"maxStatements\" value=\"${maxStatements}\" /&gt;\n    &lt;property name=\"acquireIncrement\" value=\"${acquireIncrement}\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>This seems to <strong>work</strong>, as I can see c3p0 log in the eclipse console.<br>\nHowever, when I tried configuring it within hibernate sessionFactory properties, like this:</p>\n\n<pre><code>&lt;bean id=\"sessionFactory2\" class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\" name=\"sessionFactory2\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource2\" /&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.Oracle10gDialect&lt;/prop&gt;\n            &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n            &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n            &lt;prop key=\"hibernate.query.substitutions\"&gt;true 1, false 0&lt;/prop&gt;\n\n            &lt;!-- C3P0 properties (hibernate.c3p0.idle_test_period)  --&gt;\n            &lt;prop key=\"hibernate.connection.provider_class\"&gt;org.hibernate.connection.C3P0ConnectionProvider&lt;/prop&gt;\n            &lt;prop key=\"hibernate.c3p0.min_size\"&gt;1&lt;/prop&gt;\n            &lt;prop key=\"hibernate.c3p0.max_size\"&gt;20&lt;/prop&gt;\n            &lt;prop key=\"hibernate.c3p0.timeout\"&gt;600&lt;/prop&gt;\n            &lt;prop key=\"hibernate.c3p0.acquire_increment\"&gt;1&lt;/prop&gt;\n            &lt;prop key=\"hibernate.c3p0.max_statements\"&gt;50&lt;/prop&gt;\n\n        &lt;/props&gt;\n    &lt;/property&gt;\n    &lt;property name=\"mappingResources\"&gt;\n        &lt;list&gt;\n                     ...\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>this <strong>doesn't work</strong>, c3p0 just won't start, no output, no error, nothing...<br>\nActually, I don't find it so strange , because when I opened hibernate-core-3.3.1.GA jar from Maven repository, I couldn't find <em>org.hibernate.connection.C3P0ConnectionProvider</em> class. I tried some other versions of hibernate (3.3.2, 3.6.0), and still same thing was happening (no C3P0ConnectionProvider class was in jar file). I treid removing <em>connection.providerclass</em> property, no difference.</p>\n\n<p>I read a ton of related questions here and on other forums, and I can't really understand what's the problem. <a href=\"http://stackoverflow.com/questions/4303988/hibernate-3-3-and-c3p0\">This</a> is basically my problem, but I didn't find it useful. Am I missing something in the properties configuration, did I name them wrong or something?  </p>\n\n<p>Thanks.</p>\n"},{"tags":["xml","hibernate","spring","lucene"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":157,"score":0,"question_id":9264931,"title":"Set dynamic index directory for hibernate-search in Spring","body":"<p>This has been discussed already, however none of the solutions/advices worked for me. I want to configure the lucene search index path in Spring via persistence.xml. This is important, since the deployment server is (of course) different from my local machine, so paths will not match. Right now, my configuration of hibernate-search inside the  persistence.xml looks like this:</p>\n\n<pre><code>&lt;property name=\"hibernate.search.default.directory_provider\" value=\"filesystem\" /&gt; \n&lt;property name=\"tempdir\" value=\"#{ systemProperties['java.io.tmpdir'] }\" /&gt;\n&lt;property name=\"hibernate.search.default.indexBase\" value=\"${tempdir}\\hibernate\\index\" /&gt; \n</code></pre>\n\n<p>I've seen this...</p>\n\n<p><a href=\"http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/expressions.html#expressions-beandef-xml-based\" rel=\"nofollow\">http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/expressions.html#expressions-beandef-xml-based</a></p>\n\n<p>...so it should work?! However, the variable is not replaced, and the files are written to a newly created subdir having the name ${tempdir}, which is not what I wanted :)</p>\n\n<p>Thanks for your help!</p>\n"},{"tags":["java","hibernate","jsp","servlets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":12930106,"title":"Servlet how to call mutiple submit button","body":"<p>I have a problem regarding my simple application I have 2 separate .JSP file let say register and login.jsp both have submit action and both this jsp share the same servlet let say usercontrol.servlet how can I call the action once the login button is clicked the same also with register.jsp if they sharecommon servlet?</p>\n\n<p>here is my servlet code: </p>\n\n<pre><code>if(request.getParameter(\"register\").equals(\"Register\")){\n            if(request.getParameter(\"first\") == \"\" || request.getParameter(\"middle\") == \"\" || request.getParameter(\"last\") == \"\" || \n                    request.getParameter(\"loginid\") == \"\" || request.getParameter(\"pass\") == \"\" || request.getParameter(\"pass2\")== \"\"){\n                JOptionPane.showMessageDialog(null, \"Cannot leave null value from one of the textfields\");\n                response.sendRedirect(\"AdminPage/Register.jsp\");\n\n            }\n            //else if(request.getParameter(\"pass\") != request.getParameter(\"pass2\")){\n                //JOptionPane.showMessageDialog(null, \"Password Mismatch, Check you password and retype it correctly\");\n                //response.sendRedirect(\"AdminPage/Register.jsp\");\n            //}\n            else{\n                RegisterUser(request, response);\n            }\n    }\n\n    else if(request.getParameter(\"login\").equals(\"Login\")){\n        if(request.getParameter(\"username\") == \"\"){\n            JOptionPane.showMessageDialog(null, \"Username is required\");\n            response.sendRedirect(\"AdminPage/Login.jsp\");\n        }\n        else if(request.getParameter(\"password\") == \"\"){\n            JOptionPane.showMessageDialog(null, \"Password is required\");\n            response.sendRedirect(\"AdminPage/Login.jsp\");\n        }\n        else if(request.getParameter(\"username\") == \"\" || request.getParameter(\"password\") == \"\"){\n            JOptionPane.showMessageDialog(null, \"Password/Username is required\");\n            response.sendRedirect(\"AdminPage/Login.jsp\");\n        }\n        else{\n            LoginUser(response, request);\n        }   \n    }\n</code></pre>\n\n<p>I'm integrating my application with hibernate.</p>\n\n<p>this are my jsp submit buttons I did not include the whole forms I just include the submit button.</p>\n\n<p>Login.jsp</p>\n\n<pre><code>&lt;input type=\"submit\" name=\"login\" value=\"Login\" /&gt;\n</code></pre>\n\n<p>Register.jsp</p>\n\n<pre><code>&lt;input type=\"submit\" name=\"register\" value=\"Register\"/&gt;\n</code></pre>\n\n<p>My question is everytime I run the application it always does all the action in the if..else statement is there any other ways to fix this?</p>\n"},{"tags":["java","oracle","hibernate","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3654,"score":3,"question_id":4724344,"title":"How to call stored procedure by hibernate?","body":"<p>Hi I have an oracle stored procedure </p>\n\n<pre><code>GET_VENDOR_STATUS_COUNT(DOCUMENT_ID IN NUMBER , NOT_INVITED OUT NUMBER,INVITE_WITHDRAWN OUT NUMBER,...\n</code></pre>\n\n<p>rest all parameters are OUT parameters.</p>\n\n<p>In  hbm file I have written - </p>\n\n<pre><code>&lt;sql-query name=\"getVendorStatus\" callable=\"true\"&gt;\n     &lt;return-scalar column=\"NOT_INVITED\" type=\"string\"/&gt;\n     &lt;return-scalar column=\"INVITE_WITHDRAWN\" type=\"string\"/&gt;\n     &lt;return-scalar column=\"INVITED\" type=\"string\"/&gt;\n     &lt;return-scalar column=\"DISQUALIFIED\" type=\"string\"/&gt;\n     &lt;return-scalar column=\"RESPONSE_AWAITED\" type=\"string\"/&gt;\n     &lt;return-scalar column=\"RESPONSE_IN_PROGRESS\" type=\"string\"/&gt;\n     &lt;return-scalar column=\"RESPONSE_RECEIVED\" type=\"string\"/&gt;\n     { call GET_VENDOR_STATUS_COUNT(:DOCUMENT_ID , :NOT_INVITED ,:INVITE_WITHDRAWN ,:INVITED ,:DISQUALIFIED ,:RESPONSE_AWAITED ,:RESPONSE_IN_PROGRESS ,:RESPONSE_RECEIVED ) }\n    &lt;/sql-query&gt;\n</code></pre>\n\n<p>In java I have written -</p>\n\n<pre><code> session.getNamedQuery(\"getVendorStatus\").setParameter(\"DOCUMENT_ID\", \"DOCUMENT_ID\").setParameter(\"NOT_INVITED\", \"NOT_INVITED\") \n</code></pre>\n\n<p>... continue till all the parametes .</p>\n\n<p>I am getting the sql exception </p>\n\n<pre>\n    18:29:33,056 WARN  [JDBCExceptionReporter] SQL Error: 1006, SQLState: 72000\n    18:29:33,056 ERROR [JDBCExceptionReporter] ORA-01006: bind variable does not exist\n</pre>\n\n<p>Please let me know what is the exact process of calling a stored procedure from hibernate. I do not want to use JDBC callable statement. </p>\n"},{"tags":["hibernate","hsqldb","h2","hbm2ddl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12917629,"title":"db2 hibernate hbm2ddl table not found error","body":"<p>I'm having the following problem while trying to execute unit tests. I'm working with a database in memory (I have used h2 and hsqldb for this purpose, but both of them drive me to the same error).</p>\n\n<p>Having the following hibernate.cfg.xml file:</p>\n\n<pre><code>&lt;hibernate-configuration&gt;\n&lt;session-factory&gt;\n &lt;property name=\"hibernate.bytecode.use_reflection_optimizer\"&gt;false&lt;/property&gt;\n &lt;property name=\"hibernate.connection.driver_class\"&gt;org.h2.Driver&lt;/property&gt;\n &lt;property name=\"hibernate.connection.url\"&gt;jdbc:h2:mem:news;INIT=create schema IF NOT EXISTS news&lt;/property&gt;\n &lt;property name=\"hibernate.c3p0.min_size\"&gt;5&lt;/property&gt;\n &lt;property name=\"hibernate.c3p0.max_size\"&gt;20&lt;/property&gt;\n &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.H2Dialect&lt;/property&gt;\n &lt;property name=\"hibernate.connection.autocommit\"&gt;false&lt;/property&gt;\n &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n &lt;property name=\"hibernate.hbm2ddl.auto\"&gt;create-drop&lt;/property&gt;\n &lt;property name=\"show_sql\"&gt;false&lt;/property&gt;\n &lt;mapping resource=\"com/mycom/common/List.hbm.xml\"&gt;&lt;/mapping&gt;\n &lt;mapping resource=\"com/mycom/common/Info.hbm.xml\"&gt;&lt;/mapping&gt;\n &lt;mapping resource=\"com/mycom/common/User.hbm.xml\"&gt;&lt;/mapping&gt;\n &lt;mapping resource=\"com/mycom/common/Category.hbm.xml\"&gt;&lt;/mapping&gt;\n &lt;mapping resource=\"com/mycom/common/Topic.hbm.xml\"&gt;&lt;/mapping&gt;\n &lt;mapping resource=\"com/mycom/common/CategoryRelation.hbm.xml\"&gt;&lt;/mapping&gt;\n &lt;mapping resource=\"com/mycom/common/TopicRelation.hbm.xml\"&gt;&lt;/mapping&gt;\n&lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>The purpouse of CategoryRelation.hbm.xml and TopicRelation.hbm.xml are just intermediate tables which contains a mapping between Category/Topic tables (master data tables) and other tables.</p>\n\n<p>While autogenerating through hbm2ddl the database during the sessionFactory creation the following problem is raised:</p>\n\n<pre><code>2012-10-16 16:36:35,448 DEBUG [main] com.mchange.v2.c3p0.impl.NewPooledConnection  - com.mchange.v2.c3p0.impl.NewPooledConnection@af4627 handling a throwable.\norg.h2.jdbc.JdbcSQLException: Table \"T_RELATIONTOCATEGORY\" not found\n</code></pre>\n\n<p>And same for t_relationtoTopic.</p>\n\n<p>Extrac of CategoryRelation.hbm.xml file</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n &lt;class name=\"com.yell.news.model.CategoryRelation\" table=\"t_relationToCategory\"&gt;\n...\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Extract of any other that has a fk to this</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n &lt;class name=\"com.mycom.myapp.model.List\" table=\"t_List\"&gt;\n  ...\n  &lt;set name=\"categoryRelation\" fetch=\"join\" table=\"t_relationToCategory\" lazy=\"false\"  inverse=\"true\" &gt;\n   &lt;key&gt;\n    &lt;column name=\"rec_ListId\"&gt;&lt;/column&gt;\n   &lt;/key&gt;\n   &lt;one-to-many class=\"com.yell.news.model.CategoryRelation\"/&gt;\n  &lt;/set&gt;\n &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Any idea what could be the problem? </p>\n"},{"tags":["hibernate","mapping","subclassing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12895968,"title":"Hibernate, subclassing because of calculated fields (Hibernate 2.8.1)","body":"<p>I have a view in my db e.g <strong>view1</strong> and I need to use this view up to making report <strong>view1report</strong> with some calculated fields, say AplusB</p>\n\n<p>(of course I want to handle them as objects by Hibernate)</p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>view1\n    int a\n    int b\n---    \nview1report extends view1\n    int AplusB\n....\npublic int setAplusB() { ... my own logic ...}\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<ul>\n<li>A. Can it be solved by Hibernate ?</li>\n</ul>\n\n<p>If yes</p>\n\n<ul>\n<li>B. How can I build up my hmb.xml to express the subclassing ? </li>\n<li>C. AND last but not least how can use my own logic in the setters of calculated fields ?</li>\n</ul>\n\n<p>(The reason why i want to separate them the additional calculated fields)</p>\n"},{"tags":["java","spring","hibernate","transactional"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":12814801,"title":"Spring @Transactional(readOnly=true) revert the properties?","body":"<p>Just a simple Question with a Car-entity persisted field color of value red:</p>\n\n<pre><code>00  @Transactional public class MyBean{...\n01    public void test(){\n02        Car c = s.find(Car.class,1);\n03        c.setColor(\"blue\");\n04        test1(c);\n05        System.out.println(c.getColor());   \n06    }\n07    @Transactional(readOnly=true)\n08    public void test1(Car c){\n09        c.setName(\"black\");\n10    }\n11  }\n</code></pre>\n\n<p>Assuming, we are in Spring ORM TX-Transactional-Annotation environment, with transactional semantics and transaction scoped persistence context.</p>\n\n<p>What will be printed to Console?</p>\n\n<ul>\n<li>red</li>\n<li>blue</li>\n<li>black</li>\n</ul>\n"},{"tags":["spring","hibernate"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12802986,"title":"Integrating OSuser with spring and hibernate","body":"<p>What are the configuration I have to do in order to use <code>OSuser</code>in Spring with Hibernate.I know <code>OSuser</code> provides hibernate providers but how can I configure it inside spring.Please explain in detail if anybody knows.</p>\n"},{"tags":["java","sql","oracle","hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12928692,"title":"Using trigger to generate ID vs creating IDs manually","body":"<p>If we have a sequence to generate unique ID fields for a table, which of the 2 approaches is more efficient:</p>\n\n<ol>\n<li>Create a trigger on insert, to populate the ID field by fetching nextval from sequence.</li>\n<li>Calling nextval on the sequence in the application layer before inserting the object (or tuple) in the db.</li>\n</ol>\n\n<p>EDIT: The application performs a mass upload. So assume thousands or a few millions of rows to be inserted each time the app runs. Would triggers from #1 be more efficient than calling the sequence within the app as mentioned in #2?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12928402,"title":"What is use of LazyCollection","body":"<p>I have 2 entities as Parent and Child as OneToMany relation as</p>\n\n<pre><code>@Entity\npublic class Parent {\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\nprivate Integer id;\n\nprivate String name;\n\n@OneToMany(mappedBy = \"parent\", fetch = FetchType.LAZY)\n@IndexColumn(name = \"index\", base = 1)\n@Cascade(org.hibernate.annotations.CascadeType.ALL)\n@LazyCollection(LazyCollectionOption.EXTRA)\nprivate List&lt;Child&gt; childs = new ArrayList&lt;Child&gt;();\n// getter and setter\n\n}\n</code></pre>\n\n<p>So here what is use of <strong>@LazyCollection(LazyCollectionOption.EXTRA)</strong> and when does it will come in picture, like for which operation with child list, it will be beneficial ?</p>\n"},{"tags":["spring","hibernate","osworkflow"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":12776676,"title":"Integrating OSworkflow with Spring and Hibernate","body":"<p>How can I integrate OSworkflow with spring and hibernate.What are the configuration i need to specify in xml files and which jar files are requires for it.</p>\n\n<p>Update </p>\n\n<p>I have defined the applicationContext.xml as follows</p>\n\n<pre><code>&lt;bean id=\"workflowStore\" class=\"com.opensymphony.workflow.spi.hibernate.SpringHibernateWorkflowStore\" autowire=\"byName\"&gt; &lt;property name=\"resource\" value=\"workflow-defs.xml\"/&gt;\n    &lt;property name=\"reload\" value=\"true\"/&gt;  &lt;/bean&gt;\n\n  &lt;bean id=\"workflowFactory\" class=\"com.opensymphony.workflow.loader.XMLWorkflowFactory\" init-method=\"initDone\"/&gt;\n\n    &lt;bean id=\"workflowConfiguration\" class=\"com.opensymphony.workflow.config.SpringConfiguration\"&gt;\n        &lt;property name=\"store\"&gt;&lt;ref local=\"workflowStore\"/&gt;&lt;/property&gt;\n        &lt;property name=\"factory\"&gt;&lt;ref local=\"workflowFactory\"/&gt;&lt;/property&gt;\n    &lt;/bean&gt;\n\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n\n\n\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"namingStrategy\"&gt;\n            &lt;bean class=\"org.hibernate.cfg.ImprovedNamingStrategy\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;${hibernate.show_sql}&lt;/prop&gt;\n                &lt;prop key=\"hibernate.format_sql\"&gt;${hibernate.format_sql}&lt;/prop&gt;\n                &lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.EhCacheProvider&lt;/prop&gt;\n                &lt;prop key=\"hibernate.cache.provider_configuration_file_resource_path\"&gt;ehcache/ehcache-hibernate-local.xml&lt;/prop&gt;\n                &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/prop&gt;\n            &lt;/props&gt;\n        &lt;/property&gt;\n        &lt;property name=\"packagesToScan\" value=\"net.top.*.entity.*\" /&gt;\n\n        &lt;property name=\"mappingResources\"&gt;\n    &lt;list&gt;\n        &lt;value&gt;com/opensymphony/workflow/spi/hibernate/WorkflowDescriptor.hbm.xml&lt;/value&gt;\n        &lt;value&gt;com/opensymphony/workflow/spi/hibernate/HibernateCurrentStep.hbm.xml&lt;/value&gt;\n        &lt;value&gt;com/opensymphony/workflow/spi/hibernate/HibernateHistoryStep.hbm.xml&lt;/value&gt;\n        &lt;value&gt;com/opensymphony/workflow/spi/hibernate/HibernateWorkflowEntry.hbm.xml&lt;/value&gt;               \n        &lt;value&gt;com/opensymphony/module/propertyset/hibernate/PropertySetItemImpl.hbm.xml&lt;/value&gt;\n  &lt;/list&gt;\n  &lt;/property&gt;\n    &lt;/bean&gt;\n</code></pre>\n\n<p>It shows an error as</p>\n\n<pre><code>Could not determine type for: com.opensymphony.workflow.loader.NotNullStringType, for columns: [org.hibernate.mapping.Column(value)]\n</code></pre>\n\n<p>Did i miss anything?.</p>\n"},{"tags":["eclipse","hibernate","osgi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12919684,"title":"How to add jars properly to a eclipse bundle","body":"<p>I got a little problem. I want to use hibernate in an eclipse rcp. (i'm new to osgi and eclipse rcp). So I added the jar into the plugin-project folder and the build path and the bundle build path, but when I try to use hibernate from my bundle, it crashes with a ClassNotFoundException.</p>\n\n<p>What is the proper way to do this? </p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":26,"score":-2,"question_id":12927144,"title":"Hibernate multiple table in criteria","body":"<p>I have two table \n1.table A(id primarkey,name);\n2.Table B (id primaryKey,Name ,Value);</p>\n\n<p>how to use criteria  to get Name field value A Table.</p>\n"},{"tags":["hibernate","function","jpa","stored-procedures","postgresql-9.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":166,"score":1,"question_id":12557957,"title":"JPA Hibernate Call Postgres Function Void Return MappingException:","body":"<p>I have a problem where I am getting an: <em>org.hibernate.MappingException: No Dialect mapping for JDBC type: 1111</em> when trying to call a postgres function using JPA create native query.</p>\n\n<p>I created an EJB timer in a startup singleton to run a Postgres function every 6 hours. The function returns void and checks for expired records, deletes them, and updates some statuses. It takes no arguments and it returns void. </p>\n\n<ul>\n<li><p>The postgres function runs perfectly if I call it using PgAdmin query tool (select function();) and returns void.</p></li>\n<li><p>When I deploy the app on Glassfish 3.1.1 I get an exception and a failure to deploy.</p></li>\n</ul>\n\n<p>This is the (shortened) stack trace:</p>\n\n<pre><code>WARNING: A system exception occurred during an invocation on EJB UserQueryBean method public void com.mysoftwareco.entity.utility.UserQueryBean.runRequestCleanup()\njavax.ejb.TransactionRolledbackLocalException: Exception thrown from bean\n...STACK TRACE BLAH BLAH BLAH ...\nCaused by: javax.persistence.PersistenceException: org.hibernate.MappingException: No Dialect mapping for JDBC type: 1111\n</code></pre>\n\n<p>Here is the code:</p>\n\n<p>First the JPA stuff:</p>\n\n<pre><code>public void runRequestCleanup() {\n    String queryString = \"SELECT a_function_that_hibernate_chokes_on()\";\n    Query query = em.createNativeQuery(queryString);\n    Object result = query.getSingleResult();\n}\n</code></pre>\n\n<p>This is the singleton calling it:</p>\n\n<pre><code>@Startup\n@Singleton\npublic class RequestCleanupTimer {\n    @Resource\n    TimerService timerService;\n    @EJB\n    UserQueryBean queryBean;\n\n    @PostConstruct\n    @Schedule(hour = \"*/6\")\n    void runCleanupTimer() {\n        queryBean.runRequestCleanup();\n    }\n}\n</code></pre>\n\n<p>And the function:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION a_function_that_hibernate_chokes_on()\n  RETURNS void AS\n$BODY$\n    DECLARE \n        var_field_id myTable.field_id%TYPE;\n    BEGIN\n        FOR var_field_id IN\n                select field_id from myTable \n                where status = 'some status'\n                and disposition = 'some disposition'\n                and valid_through &lt; now()\n        LOOP\n            BEGIN\n                -- Do Stuff\n            END;\n        END LOOP;\n    END;\n$BODY$\n  LANGUAGE plpgsql VOLATILE\n  COST 100;\n</code></pre>\n"},{"tags":["mysql","hibernate","distributed-caching","sessionfactory","database-engine"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":59,"score":-1,"question_id":12614411,"title":"Issue with Multiple/Distributed hibernate SessionFactory instances with MySQL","body":"<p>I am having an issue while accessing single database instance using multiple/distributed Hibernate SessionFactories i.e. multiple instances of Hibernate SessionFactory.\nIf I use one session factory to perform insert operation and create new SessionFactory to retrieve data from database without closing the former SessionFactory then I get \"null\".\nI have also tried to use multiple Second Level Cache Platforms but none resolved issues.\nDo reply if anyone have found any solution to this.</p>\n\n<p>I am using MySql database and my the database engine chosen at installation time is Innodb.\nThanks.</p>\n"},{"tags":["java","hibernate","postgresql","jpa","persistence"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12895079,"title":"Loading data avoiding the entities found in the persistence context","body":"<p>I'd like to execute a method (compareEntities ) which requires the entity which is currently in the database and the object which has just been saved. Something like this in my DAO where em is the EntityManager:</p>\n\n<pre><code>public void save(MyObj myObj) {\n    MyObj previous = null;\n    MyObj current = null;\n    Integer id = myObj.getId();     \n    if (id == null) {\n        // new\n        current = em.persist(myObj);\n    } else {\n        previous = em.find(MyObj.class, id);\n        // update\n        current = em.merge(myObj);\n    }\n    compareEntities (previous, current);\n}\n</code></pre>\n\n<p>The problem is that, as the entity which is going to be saved comes from the database and I have made some changes on it, when I try to get the data from the database (with the find method) I get the data with the changes because the entity is found in the persistence context. Is there any way to get the data which is in the database without the changes I have done to the entity inside the same transaction?</p>\n\n<p>Thanks.</p>\n"},{"tags":["spring","hibernate","transactions","rollback"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12926516,"title":"Hibernate + Spring transaction rollback not working","body":"<p>When service thown an exception that is configured to rollback (rollbackfor), this rollback not working.</p>\n\n<p>Service class:</p>\n\n<pre><code>@Service(\"bookService\")\n@Transactional(propagation = Propagation.REQUIRED, rollbackFor = { BusinessException.class }, readOnly = true)\npublic class BookServiceImpl implements BookService {\n\n    @Autowired\n    private BookRepository bookDAO;\n\n     @Override\n     @Transactional(readOnly = false)\n     public void transactionTest(Book book) throws BusinessException {\n          try {\n               bookDAO.test(book);\n          } catch (DAOException e) {\n               throw new BusinessException(\"test rollback - service\");\n          }\n     }\n}\n</code></pre>\n\n<p>Repository class:</p>\n\n<pre><code>@Repository(\"bookRepository\")\npublic class BookRepositoryImpl implements BookRepository {\n\n    @Autowired\n    private SessionFactory sessionFactory;\n\n@Transactional(readOnly = false)\n@Override\npublic Book saveOrUpdate(Book book) {\n    if (book.getId() != null) {\n        getSession().merge(book);\n    } else {\n        getSession().save(book);\n    }\n    return book;\n}\n\n@Transactional(readOnly = false)\n@Override\npublic void test(Book book) throws DAOException {\n\n    saveOrUpdate(book);\n    System.out.println(book.getTitle() + \" inserted!\");\n    throw new DAOException(\"Test rollback\");\n}\n\n}\n</code></pre>\n\n<p>There are one situation that rollback works. To this, I need change BookServiceImpl removing readOnly = true and removing \"@Transactional(readOnly = false)\" of the \"transactionTest\" method. But for security reasons I wish use readOnly = true for all class and specify what is method use readOnly = false</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":12913793,"title":"Error in converting transient object to persistent object","body":"<pre><code>public void updateMovements(Movement mvt) throws SwtException {\n    // Holds the hibernate session instance\n    Session session = null;\n    // Holds the hibernate Transaction instance\n    Transaction transaction = null;\n    try {\n        log.error(this.getClass().getName()\n                + \"- [updateMovements] - Entering \");\n        // To open the session\n        session = getHibernateTemplate().getSessionFactory().openSession();\n        // Initiate the transaction instance\n        transaction = session.beginTransaction();\n        // Updates the details of the inputInterface\n        session.update(mvt);\n        session.flush();\n        transaction.commit();\n\n        /* Updates the given movement details */\n        // getHibernateTemplate().update(mvt);\n        // getHibernateTemplate().flush();\n        log.debug(this.getClass().getName()\n                + \"- [updateMovements] - Exiting \");\n    } catch (DataAccessException e) {\n        if (transaction != null) {\n            // Error occurs, so roll back the transaction\n            try {\n                transaction.rollback();\n            } catch (HibernateException e1) {\n                // TODO Auto-generated catch block\n                e1.printStackTrace();\n            }\n        }\n        log.error(\"DataAccessException caught in \"\n                + this.getClass().getName()\n                + \" - [updateMovements]. Cause: \" + e.getMessage());\n        throw SwtErrorHandler.getInstance().handleException(e,\n                \"updateMovements\", MatchDisplayDAOHibernate.class);\n    } catch (HibernateException e) {\n        if (transaction != null) {\n            // Error occurs, so roll back the transaction\n            try {\n                transaction.rollback();\n            } catch (HibernateException e1) {\n                // TODO Auto-generated catch block\n                e1.printStackTrace();\n            }\n        }\n        log.error(\"HibernateException caught in \"\n                + this.getClass().getName()\n                + \" - [updateMovements]. Cause: \" + e.getMessage());\n        throw SwtErrorHandler.getInstance().handleException(e,\n                \"updateMovements\", MatchDisplayDAOHibernate.class);\n    } catch (Exception e) {\n        if (transaction != null) {\n            // Error occurs, so roll back the transaction\n            try {\n                transaction.rollback();\n            } catch (HibernateException e1) {\n                // TODO Auto-generated catch block\n                e1.printStackTrace();\n            }\n        }\n        log.error(\"Exception caught in \" + this.getClass().getName()\n                + \" - [updateMovements]. Cause: \" + e.getMessage());\n        throw SwtErrorHandler.getInstance().handleException(e,\n                \"updateMovements\", MatchDisplayDAOHibernate.class);\n    } finally {\n        transaction = null;\n        JDBCCloser.close(session);\n    }\n}\n</code></pre>\n\n<p>Above method is in DAO class.\nI am trying to execute this method through Manager class in my framework. \nFor a particular action in my application  i am calling the above method for four times. On fourth time transaction.commit() line is not working.Their is no exception caught and no logs. \nWhen i used debugger it is not moving from the transaction.commit() line 4th time.</p>\n"},{"tags":["php","django","hibernate","symfony2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":54,"score":-3,"question_id":12927192,"title":"Is there any possibility of django coming with chnages like in Symfony2","body":"<p>Initially i was using Symfony1.4 framework and i didn't liked that much but was good.\nThen when Symfony2 came i never looked back at other php framework with things like annotation , service classes , repository classes , it almost similar to Spring/Hibernate of java at enterprise level.</p>\n\n<p>Now i am doing Django. But i see that Django can't beat Symfony2. The service classes, DI container , Annotation based routes , validations etc excellent to use when you get your head around.</p>\n\n<p>Spring/Hibernate also doing similar way.</p>\n\n<p>So is there any possibility in some djnago ver2 that they can think about those things. I don't think it will hard if it can be done in PHP why can't in Python</p>\n"},{"tags":["hibernate","annotations","associations","hibernate-annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2860,"score":1,"question_id":1702471,"title":"hibernate @DiscriminatorValue does not apply to associations","body":"<p>I have the following inheritance hierarchy.</p>\n\n<pre><code>@Entity\n@Table(FRUIT)\n@Inheritance(strategy=InheritanceType.SINGLE_TABLE)\n@DiscriminatorColum(name=\"FRUIT_TYPE\",discriminatorType=STRING)\npublic class Fruit {\n..\n@Id\nprivate FruitId id;\n...\n}\n\n@DiscriminatorValue(\"APPLE\")\npublic class Apple extends Fruit {\n...\n@ManyToOne\nprivate FruitBowl bowl; //this association is only present in the subclass\n\n...\n}\n\nclass FruitBowl .. {\n...\n        @OneToMany(fetch = FetchType.LAZY, mappedBy = \"bowl\")\n    @IndexColumn(name=\"POSITION\",base = 1) \n        List&lt;Apple&gt; apples;\n...\n</code></pre>\n\n<p>When I do a <code>session.load(Apple.class,...)</code>, it adds <code>FRUIT_TYPE = 'APPLE'</code> to the select query. But if I do a select on FruitBowl(which has a 1:m relationship with Apple), the select query on the Apple does not contain <code>FRUIT_TYPE = 'APPLE'</code>. Why does this happen? How do I rectify the problem?</p>\n\n<p>Query\n --Query for FruitBowl </p>\n\n<pre><code>select fruitbowl0_.BOWL_ID as BOWL1_1_0_ from FRUITBOWL fruitbowl0_ where fruitbowl0_.BOWL_ID=?\n</code></pre>\n\n<p>--Query for Fruit to retrieve Apples (records with fruit_type ='A') \n--but it does not include that condition </p>\n\n<pre><code>select apples0_.ENTITY_ID as ENTITY3_1_, apples0_.POS as POS1_, apples0_.POS as POS0_0_, apples0_.ENTITY_ID as ENTITY3_0_0_, apples0_.COLOR as COLOR0_0_ from FRUIT apples0_ where apples0_.ENTITY_ID=?\n</code></pre>\n"},{"tags":["java","hibernate","jackson"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12923803,"title":"deserialize lazy loading in hibernate and jackson","body":"<p>Is there a way to keep LAZY loading and deserialize the object using the id instead of the POJO object.</p>\n\n<p>I have 2 class that are joined by a many-to-many relationship.</p>\n\n<p>Something like this</p>\n\n<pre><code>public class User {\n    @Id\n    @JsonProperty\n    public long id;\n\n    @ManyToMany(\n            fetch = FetchType.EAGER,\n    )\n    @JoinTable(\n            name = \"User_EntityType\",\n            joinColumns = @JoinColumn(name = \"user_id\"),\n            inverseJoinColumns = @JoinColumn(name = \"type_id\")\n    )\n    @JsonProperty\n    public Set&lt;Type&gt; types;\n\n}\n\npublic class Type {\n    @Id\n    @JsonProperty\n    public long id;\n\n    @ManyToMany(\n            fetch = FetchType.EAGER,\n            mappedBy = \"types\",\n            targetEntity = User.class\n    )\n    @JsonProperty\n    public Set&lt;User&gt; users;\n}\n</code></pre>\n\n<p>The data type works just fine. I can write and read using hibernate with no issue.</p>\n\n<p>However, I want to be able to return an User object with a REST API, so I'm using Jackson to deserialize it. The issue is when I do that, it deserialize every Type in the User object, which includes other Type objects, and it creates a huge mess.</p>\n\n<p><strong>Is it possible to instead just return the Set of Long type ids instead of Set of Type?</strong></p>\n"},{"tags":["eclipse","hibernate","postgresql","gwt","ubuntu-12.04"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12926398,"title":"\"Could not locate SessionFactory in JNDI\" with Hibernate in Jetty under Eclipse Juno","body":"<p>I've spent a few days understanding this problem, but I have not come up with a solution.  The following are posts that are having similar problems:\n<a href=\"http://stackoverflow.com/questions/7714899/jetty-data-source-hibernate-datasource-not-found\">Similar Post 1</a>, <a href=\"http://stackoverflow.com/questions/1620612/problems-using-eclipse-hibernate-plugin-could-not-locate-sessionfactory-in-jnd\">Similar Post 2</a>, <a href=\"http://stackoverflow.com/questions/8818198/hibernate-sessionfactory-as-a-global-jndi-resource\">Similar Post 3</a>.  I have tried some of the partial solutions there, but nothing has resolved the problem.</p>\n\n<h2>Problem</h2>\n\n<p>I'm developing a Google Web Application and using Hibernate for the persistence layer to connect to a Postgresql database.  I run it in development mode with the built-in Jetty server that comes with the GWT Eclipse plugin.  I have received some help from this <a href=\"http://stackoverflow.com/questions/5454421/gwt-jetty-jndi-lookup-fails\">post</a> in configuring the Jetty server.</p>\n\n<p>I have used the Hibernate Tools to reverse engineer and export the following:</p>\n\n<ul>\n<li>Domain Code (.java)</li>\n<li>Hibernate XML Mappings (.hbm.xml)</li>\n<li>DAO code (.java)</li>\n<li>Hibernate XML Configuration</li>\n</ul>\n\n<p>These have all been exported to the src folder, and I've verified using the Hibernate Tool that the configurations are at least able to pull schema information.</p>\n\n<p>Now the problem comes after the Jetty server starts running.  As soon as you visit the site associated with the application, it reports the following errors in Eclipse's debug console:</p>\n\n<pre><code>    com.site.application.&lt;reverse engineered DAO&gt; getSessionFactory\n    SEVERE: Could not locate SessionFactory in JNDI\n    javax.naming.NameNotFoundException; remaining name 'SessionFactory'\n        at org.mortbay.naming.NamingContext.lookup(NamingContext.java:578)\n        at org.mortbay.naming.NamingContext.lookup(NamingContext.java:680)\n        at org.mortbay.naming.local.localContextRoot.lookup(localContextRoot.java:164)\n        at javax.naming.InitialContext.lookup(InitialContext.java:411)\n        at com.site.application.&lt;reverse engineered DAO&gt;.getSessionFactory(&lt;reverse engineered DAO&gt;.java:31)\n</code></pre>\n\n<p>Ending with:</p>\n\n<pre><code>    [ERROR] 500 - POST &lt;application path&gt; (127.0.0.1) xxxx bytes\n</code></pre>\n\n<p>Please let me know if you need any more details.  I did not want to inundate the page with debug information.</p>\n\n<h2>Environment</h2>\n\n<ul>\n<li>Ubuntu 12.04 LTS</li>\n<li>Eclipse Juno 4.2 Build id: 20120614-1722</li>\n<li>GWT SDK 2.4.0</li>\n<li>Hibernate 4.0</li>\n<li>Postgresql 9.1</li>\n</ul>\n"},{"tags":["hibernate","spring","jpa"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":10012,"score":6,"question_id":679518,"title":"Can't make hibernate stop showing SQL using Spring JPA Vendor Adapter","body":"<p>Hibernate is continuing to spew SQL traces to stdout, and I can't figure out how to change a Hibernate configuration property when it's hidden behind a JPA adapter.  This is the Spring bean for the entityManagerFactory:</p>\n\n<pre><code>&lt;bean id=\"entityManagerFactory\" \n    class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"ssapDataSource\"/&gt;\n    &lt;property name=\"jpaVendorAdapter\"&gt;\n        &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\" &gt;\n            &lt;property name=\"showSql\" value=\"false\"/&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>Even with the showSql property set to false, Hibernate keeps printing SQL.</p>\n\n<p>I've tried making a hibernate.properties file in my classpath with \"hibernate.show_sql=false\", but it didn't pick that up either.</p>\n"},{"tags":["performance","hibernate","commit","flush"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3196,"score":1,"question_id":5523101,"title":"Hibernate Performance flush v commit","body":"<p>Im creating a hibernate component to interact with large incoming data to persist, both save(create) and update data with volumes in the million of rows.</p>\n\n<p>I am aware of the main differences around flush v commit, for example flush syncing the \"dirty\" data into the persistable underlying data, and that flush allows you to sync with the underlying persistable data without actually committing so that the transaction can be rolled back if required. Commit essentially commits all persistable data to the database.</p>\n\n<p>Im creating a hibernate component to interact with large incoming data to persist, both save(create) and update data with volumes in the million of rows.</p>\n\n<p>I am aware of the main differences around flush v commit, for example flush syncing the \"dirty\" data into the persistable underlying data, and that flush allows you to sync with the underlying persistable data without actually committing so that the transaction can be rolled back if required. Commit essentially commits all persistable data to the database.</p>\n\n<p>Whats a reasonable size to do a batch insert? IS 50 the max amount for reasonable performance so something like:</p>\n\n<p>for (i &lt; 1000000)</p>\n\n<p>if(i % 50 ) {\nsession.flush()\n}</p>\n\n<p>I gather 50 should match the value in the hibernate.jdbc.batch_size 50</p>\n"},{"tags":["java","hibernate","sqlite","data"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":54,"score":3,"question_id":12921454,"title":"Hibernate per-user database","body":"<p>I am currently working on a (website-)project in which I intent to keep each user's data separate from another. The main database (containing information about the user (user, password etc)) is a MySQL database.</p>\n\n<p>Per-user there is a lot of data that needs to be stored and is important not to mix up with another user his/her data. Now I was thinking of using a sqlite db per user but I found out Hibernate (the db framework of my choice) does support sqlite by default.</p>\n\n<p>I found <a href=\"http://code.google.com/p/hibernate-sqlite/\" rel=\"nofollow\">http://code.google.com/p/hibernate-sqlite/</a> as an option. But I was wondering if there are any other database types with which it is easy to create one per-user, and preferably compatible with hibernate? If so, which ones?</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12924668,"title":"Hibernate Reparenting issue","body":"<p>I have two entities like this</p>\n\n<pre><code>class Users {\n\n@OneToMany(fetch = FetchType.LAZY, mappedBy = \"id.userId\", cascade=CascadeType.ALL, orphanRemoval=true)\n@BatchSize(size=20) \npublic Set&lt;UserPermissions&gt; getUserPermissionses() {...}\n\n}\n\nclass UserPermissions {\n\n@EmbeddedId\n@AttributeOverrides({\n        @AttributeOverride(name = \"permissionsId\", column = @Column(name = \"permissions_id\", nullable = false)),\n        @AttributeOverride(name = \"userId\", column = @Column(name = \"user_id\")) })\npublic UserPermissionsId getId() {....}\n\n@OneToOne(fetch = FetchType.EAGER)\n@JoinColumn(name = \"permissions_id\", nullable = false, insertable = false, updatable = false)\npublic Permissions getPermissions() {....}\n\n@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"user_id\", insertable = false, updatable = false)\n@MapsId(\"userId\")\npublic Users getUsers() {....}\n</code></pre>\n\n<p>}</p>\n\n<pre><code>@Embeddable\npublic class UserPermissionsId {\n\n@Column(name = \"permissions_id\", nullable = false)\npublic int getPermissionsId() { .... }\n\n@Column(name = \"user_id\")\npublic int getUserId() {....}\n</code></pre>\n\n<p>The problem occurs when trying to reparent UserPermissions.User from one user to another user.</p>\n\n<p>Here is the code that does the reparenting</p>\n\n<pre><code>UserPermission perm = UserPermissionDAO.findByExample(example);\nUsers newUser = UserDAO.findById(23);\nperm.getUser().getUserPermissionses().remove(perm);\nperm.setUser(newUser);\nnewUser.getUserPermissionses().add(perm);\n</code></pre>\n\n<p>When I do this, I get the error</p>\n\n<pre><code>org.springframework.dao.InvalidDataAccessApiUsageException: deleted object would be re-saved by cascade (remove deleted object from associations): [UserPermissions#UserPermissionsId@d4cf]\n</code></pre>\n\n<p>I tried fixing this by adding this statement before adding it to the new object collection, but still the same error.</p>\n\n<pre><code>perm.getId().setUserId(newUser.getUserId());\n</code></pre>\n\n<p>What is the correct way to perform this re-parenting. I know one option is to remove it from the first parent, do an update on the object, add it the second parent's collection and then do an update. Thus resulting in one deletion and one insert. But was wondering if this can be done using a single update.</p>\n"},{"tags":["java","hibernate","exception","tags","transient"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12922003,"title":"How to resolve a TransientObjectException that honestly does not make sense","body":"<p>I am using Hibernate 4.1 and I'm getting the following exception whenever I try and store a list of transient tags that have been added to a collection for an object.</p>\n\n<pre><code>org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: com.myapplication.domain.Tag\n    at org.hibernate.engine.internal.ForeignKeys.getEntityIdentifierIfNotUnsaved(ForeignKeys.java:249)\n    at org.hibernate.type.EntityType.getIdentifier(EntityType.java:459)\n    at org.hibernate.type.ManyToOneType.nullSafeSet(ManyToOneType.java:132)\n    at org.hibernate.persister.collection.AbstractCollectionPersister.writeElement(AbstractCollectionPersister.java:811)\n</code></pre>\n\n<p>Now, I need to explain things a bit. My Tag class has a collection of synonyms. Before I added this relationship, I never got this exception and everything worked fine:</p>\n\n<p></p>\n\n<pre><code>&lt;class name=\"com.myapplication.domain.Tag\"&gt;\n    &lt;id name=\"id\" column=\"tag_id\" type=\"long\"&gt;\n        &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"term\" index=\"termIndex\" unique=\"true\" not-null=\"true\" /&gt;\n    &lt;property name=\"description\" /&gt;\n    &lt;property name=\"approved\" /&gt;\n\n    &lt;many-to-one name=\"masterTag\" column=\"master_tag_id\"\n                 class=\"com.myapplication.domain.Tag\" /&gt;\n\n    &lt;bag name=\"synonyms\"&gt;\n        &lt;key column=\"master_tag_id\" /&gt;\n        &lt;one-to-many class=\"com.myapplication.domain.Tag\" /&gt;\n    &lt;/bag&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p></p>\n\n<p>Here is how an object maps tags. The <code>Tags</code> class is just a component class. Tags.list is the actual collection that Hibernate is persisting.</p>\n\n<pre><code>    &lt;component name=\"tags\"&gt;\n        &lt;bag name=\"list\" table=\"user_to_tag\"&gt;\n            &lt;key column=\"user_id\" /&gt;\n            &lt;many-to-many class=\"com.myapplication.domain.Tag\" column=\"tag_id\"/&gt;\n        &lt;/bag&gt;\n    &lt;/component&gt;\n</code></pre>\n\n<p>The tags I am trying to save in the database actually don't contain any synonyms at all, so I don't believe it has anything to do with transient synonym tags. I don't want these to cascade, which is why I have not given it a cascade attribute on the <code>&lt;bag&gt;</code> tag.</p>\n\n<p>User's will typically insert tags into the system via a list of strings. I did it this way because I want to create tags or link to existing tags at the same time on the fly whenever the object containing tags is saved. Maybe this is more trouble than it's worth? If I only let them link to tags that exist, then I know I can solve my problem. Perhaps the complexity of dealing with on-the-fly tag creation in Hibernate is a bit more than it can deal with?</p>\n\n<p>This is the method I am using to save new/existing tags all in one go. Whenever an object is saved to the database, it first calls into this method to persist the tags collection:</p>\n\n<pre><code>public void saveAll(Tags tags) {\n    List&lt;Tag&gt; tagsToOverwrite = new ArrayList&lt;Tag&gt;();\n\n    Iterator&lt;Tag&gt; i = tags.getList().iterator();\n    while(i.hasNext()) {\n        Tag tag = i.next();\n\n        if(stopListService.hasWord(tag.getTerm())) {\n            i.remove();\n        } else {\n            if(tag.isTransient()) {\n                Tag dbTag = findByTerm(tag.getTerm());\n\n                if(dbTag == null) {\n                    save(tag);\n                } else {\n                    tagsToOverwrite.add(dbTag);\n                }\n            }\n        }\n    }\n\n    tags.overwriteAll(tagsToOverwrite);\n}\n</code></pre>\n\n<p>For some reason, it fails on <code>Tag dbTag = findByTerm(tag.getTerm());</code> That's when it throws the <code>TransientObjectException</code>. This method is just a simple query:</p>\n\n<pre><code>public Tag findByTerm(final String term) {\n    Query query = getCurrentSession().createQuery(\n        \"from Tag tag \" +\n        \"where tag.term = :term \"\n    );\n\n    return (Tag) query\n        .setParameter(\"term\", term.toLowerCase())\n        .setCacheable(true)\n        .uniqueResult(); // This is where the exception gets thrown specifically\n}\n</code></pre>\n\n<p>I am not sure why this method would throw this exception, because all I want to do is simply check to see if it's in the database or not before I save it. Why is complaining about objects not being saved when all I am doing is querying it?</p>\n\n<p>If the tags list only contains a single tag, the method works. It only fails when the number of transient tags to save is 2 or more. For example, this fails:</p>\n\n<pre><code>@Test\npublic void saveShouldPersistTransientTags() {\n    User user = userRepository.find(1);\n            // makes list of 3 tags that are transient (id = 0)\n    user.getTags().setTagsAsString(\"training learning business\");\n\n    userRepository.save(user);\n    flush();\n\n    user = userRepository.find(1);\n    assertEquals(3, user.getTags().getList().size());\n}\n</code></pre>\n\n<p>Here is the UserRepository.save() method:</p>\n\n<pre><code>@Override\npublic void save(User user) {\n    tagRepository.saveAll(user.getTags());\n\n    super.save(user);\n}\n</code></pre>\n\n<p>As you can see, I am trying to save all of the transient tags first (or look them up in the database) before the user is saved. Yet, Hibernate seems to want to persists the <code>user.tags.list</code> collection during the call <code>tagRepository.saveAll(user.getTags());</code> in the location where the exception is being thrown anyway, even though I never asked it to.</p>\n\n<p>Of course, if I remove the <code>synonyms</code> collection from the Hibernate mapping, this test passes without any problems. It only fails when I enable the <code>synonym</code> collection, and it only fails when it gets to the <code>learning</code> tag (the <code>training</code> tag is not found in the database, and is persisted just fine.)</p>\n\n<p>Any idea as to why the synonym collection is causing this problem?</p>\n\n<p>If I can't figure this out soon, in the interest of saving time, I am highly tempted to just use JDBC for this, as Hibernate's complexity in cases like this can't be such a good thing. I think this may even be a bug given the behaviour. It still doesn't make any sense to me.</p>\n"},{"tags":["java","hibernate","hibernate-mapping","hibernate-annotations","hibernate-tools"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":101,"score":2,"question_id":12878199,"title":"Hibernate Tools: Mappings and Annotations Fail","body":"<p>This is driving me crazy -- I'm pretty sure that Hibernate can determine mapping\nrelationships between tables and thus reflect this in the POJO's generated.</p>\n\n<p>Except it's not.</p>\n\n<p>I am using MySQL with STS &amp; Hibernate Tools 4.0.0 and I have a one-to-many and a one-to-one table relationship, between Person &lt;--> Phone and Phone &lt;--> PhoneType and I am able to generate using the 'Hibernate Code Generation Configuration' the 'Domain Code' and the 'DAO Code', however neither of the files have any mappings between the tables.</p>\n\n<p><strong>Now here is a possible issue:</strong></p>\n\n<p>In order to get any annotations at all, I have switched on the option <em>'Generate EJB3 annotations'</em>. Now I am using plain old Hibernate here, and <strong><em>not</em></strong> JPA.</p>\n\n<p>So my questions are:</p>\n\n<ol>\n<li>Can Hibernate Tools generate Annotations for plain old Hibernate?</li>\n<li>Can it generate mapping information in the POJO's (i.e. @manytomany / @manytoone) ?</li>\n</ol>\n\n<p>Thanks a lot for your help,</p>\n\n<p>Bob</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12922783,"title":"Spring, @PostConstruct, transactions...and will anything bad happen w/this workaround?","body":"<p>From some searching of prior questions I've seen that I can't expect to have a Hibernate session available to me in a method annotated with <code>@PostConstruct</code>I've seen solutions such as <a href=\"http://stackoverflow.com/a/5635147/617188\">this one</a> which suggest just creating your own session from the session factory something like this:</p>\n\n<pre><code>getSession().getSessionFactory().openSession()\n</code></pre>\n\n<p>This works like a charm for me, but it feels a little...off...are there any potential pitfalls I ought to be aware of?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12922573,"title":"Flushing Session in Services","body":"<p>Maybe it is my misunderstanding of Hibernate's Session flushing but I have been thinking in flushing my session inside my services but It does not feel ok to make things like this in a service:</p>\n\n<pre><code>public Object serviceMethod(Object model){\n\n    //Do things with model\n    sessionFactory.getCurrentSession().flush();\n\n}\n</code></pre>\n\n<p>It feels wrong because my services will be knowing about my persistence mechanism.</p>\n\n<p>So I have been thinking about making an aspect and using annotations so my code looks like this:</p>\n\n<pre><code>@FlushAfter\npublic Object serviceMethod(Model model){\n    //Do things with model\n}\n</code></pre>\n\n<p>Is this approach correct or am I doing things the wrong way?</p>\n"},{"tags":["hibernate","mapping","hibernate-criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12922954,"title":"Criteria query returns child objects rather parent object that was requested","body":"<p>I have a problem with a hibernate criteria query. I have:</p>\n\n<pre><code>DetachedCriteria carCriteria = DetachedCriteria.forClass(Car.class);\nList&lt;Car&gt; cars = getHibernateTemplate().findByCriteria(carCriteria);\n\nfor(Car car : cars) {\nSystem.out.println(\"class type \" + car.getClass());\n}\n</code></pre>\n\n<p>The above prints class type model.FourByFour where FourByFour extends Car. As I have specified the Car class in the DetachedCriteria, I was expecting the class type to be Car and not FourByFour.</p>\n\n<p>Mapping (simplified):</p>\n\n<pre><code>&lt;hibernate-mapping default-access=\"field\" default-lazy=\"true\" package=\"model\"&gt;\n&lt;class name=\"model.Vehicle\" table=\"VEHICLE\"&gt;\n&lt;id column=\"VEHICLE_ID\" name=\"id\" type=\"long\"&gt;\n    &lt;generator class=\"native\" /&gt;\n&lt;/id&gt;\n\n    ...\n\n    &lt;joined-subclass extends=\"model.Vehicle\" name=\"model.Car\" table=\"CAR\"&gt;\n    &lt;key column=\"VEHICLE_ID\" /&gt;\n        ....\n        &lt;joined-subclass extends=\"model.Car\" name=\"model.FourByFour\" table=\"FOUR_BY_FOUR\"&gt;\n    &lt;key column=\"VEHICLE_ID\" /&gt;\n    &lt;/joined-subclass&gt;\n&lt;/joined-subclass&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>How can I make the object returned from the criteria query be a Car object and not the FourByFour object?</p>\n"},{"tags":["spring","hibernate","jpa-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":166,"score":1,"question_id":11546632,"title":"Hibernate returning lazy loaded collections with null session","body":"<p>(SORT OF SOLVED, SEE BELOW)</p>\n\n<p>Hibernate 4.1/Spring/JPA project. I'm using Spring &amp; JPA annotations for transactions support, entity manager injection etc.</p>\n\n<p>What I'm seeing that within the same transaction my @OneToMany lazy-loaded collections dont have session property set, and of course cannot be loaded. If I do 'left join fetch' to force loading I get multiple records that point to the same PersistentBag - obviously this throws 'shared collection' exception.</p>\n\n<p>Here is my setup:</p>\n\n<p>Transaction entity ('transaction' is meant as in financial transaction)</p>\n\n<p>Code:</p>\n\n<pre><code>@Entity\n@Table(name = \"transactionData\")\n@Access(AccessType.PROPERTY)\npublic class TransactionData extends AbstractTransaction implements java.io.Serializable {\n\n   @Id\n   @GeneratedValue(strategy = IDENTITY)\n   @Column(name = \"id\", unique = true, nullable = false)\n   public int getId() {\n      return this.id;\n   }\n\n   public void setId(int id) {\n      this.id = id;\n   }\n\n   @OneToMany(cascade=CascadeType.ALL,targetEntity=Location.class,fetch=FetchType.LAZY)\n   @JoinColumns(\n         {\n            @JoinColumn(name=\"routecode\",referencedColumnName=\"v_OPERSTAT\"),\n            @JoinColumn(name=\"cogrp\", referencedColumnName=\"v_COUNTRY\")      \n         })\n   @Transactional\n   public Collection&lt;Location&gt; getLocations() {\n      return super.getLocations();\n   }\n\n   public void setLocations(Collection&lt;Location&gt; l) {\n      super.setLocations(l);\n   }\n\n}\n</code></pre>\n\n<p>Base class for Transaction:</p>\n\n<p>Code:</p>\n\n<pre><code>public abstract class AbstractTransaction  {\n\n   private List&lt;Location&gt; _locations;\n\n   @Override\n   @Transactional\n   public List&lt;Location&gt; getLocations() {\n      return _locations;\n   }\n\n   @Override\n   public void setLocations(List&lt;Location&gt; value) {\n      _locations = value;\n   }\n}\n</code></pre>\n\n<p>Transaction entity is linked to Location entity using 2 integer type columns, these cols are not PK on either Transaction or Location entity.</p>\n\n<p>Location entity:</p>\n\n<p>Code:</p>\n\n<pre><code>@Entity\n@Table(name = \"locations\", uniqueConstraints = @UniqueConstraint(columnNames = {\n      \"cogrp\", \"cugrp\", \"bogrp\", \"status\", \"id\" }))\npublic class Location implements java.io.Serializable {\n\n   @Id\n   @GeneratedValue(strategy = IDENTITY)\n   @Column(name = \"id\", unique = true, nullable = false)\n   public Integer getId() {\n      return this.id;\n   }\n\n   public void setId(Integer id) {\n      this.id = id;\n   }\n\n   @Column(name = \"cogrp\", nullable = false)\n   public int getCogrp() {\n      return this.cogrp;\n   }\n\n   public void setCogrp(int cogrp) {\n      this.cogrp = cogrp;\n   }\n\n   @Column(name = \"routecode\")\n   public Integer getRoutecode() {\n      return this.routecode;\n   }\n\n   public void setRoutecode(Integer routecode) {\n      this.routecode = routecode;\n   }\n\n}\n</code></pre>\n\n<p>Transaction entity has 1-to-many relationship to locations, and most Transaction entities will point to the same list of locations.</p>\n\n<p>Now, if I do the following query:</p>\n\n<p>Code:</p>\n\n<pre><code>select distinct t from \" + Transaction.class.getName() + \" t left join fetch t.locations where \" + filterSQL\n</code></pre>\n\n<p>I get results back, but almost every Transaction entity points to the same PersistentBag of locations - needless to say this causes shared references error.</p>\n\n<p>If I omit left join fetch all entities come back with lazily loaded collections, but none have session property set. </p>\n\n<p>If I do eager loading I only get 2 entities eagerly loaded, the rest are still lazy (I know this is a built-in restriction, any way to override that?)</p>\n\n<p><strong>EDIT:</strong> \nI have come to believe this is a bug in Hibernate. If your query returns multiple records pointing to the same collection (perfectly valid scenario I might add!) then Hibernate will reuse the same collection when eagerly fetching, and set session to null when lazy loading. It will always result in either shared reference to same collection, or 'no session' errors. </p>\n\n<p>I have switched to EclipseLink 2.4, and after fixing my JPSQL it seems to work fine in the above described case.</p>\n"},{"tags":["hibernate","criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":986,"score":0,"question_id":1888445,"title":"Hibernate criteria restriction on a property for all elements of a set","body":"<p>I have an entity with a set say like </p>\n\n<pre><code>Library---&gt;&lt;Set&gt;books\n</code></pre>\n\n<p>Now I want to retrieve the libraries where ALL the books have a genre.</p>\n\n<p>So I have something like this:</p>\n\n<pre><code>c.createCriteria(\"library\", \"library\").createCriteria(\"books\", \"book\");\nc.add(Restrictions.isNotNull(\"book.genre\"));\n</code></pre>\n\n<p>If I execute the query I get the libraries where at least one book has a genre \nbut I'd like hibernate to check the genre property for all the elements of the book set and return the libraries where ALL the elements satisfy the not null restriction.</p>\n\n<p>Sorry for my English, I hope the problem is clear, any help is very much appreciated.</p>\n\n<p>Thanks.</p>\n"},{"tags":["hibernate","spring","jpa","configuration"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1023,"score":1,"question_id":6140949,"title":"Configuring Spring/JPA Hibernate on Eclipse","body":"<p>I have been fighting for days to install Spring 3.1(latest) and Hibernate JPA on my system.\nI went through all the tutorial but have not been able to fix it.\nI've already installed Spring from Eclipse's <em>Install New Software</em>. I now want to add Hibernate JPA to it and want to test everything.</p>\n"},{"tags":["spring","hibernate","jpa","transactions","transactional"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12897882,"title":"Commit during transaction in @Transactional","body":"<p>Is that possible to perform commit in the method that is marked as Spring's <strong>@Transactional</strong>? </p>\n\n<pre><code>@PersistenceContext\nprivate EntityManager em;\n\n@Transactional(propagation = Propagation.REQUIRED)\npublic void saveMembersWithMultipleCommits(List&lt;Member&gt; members)\n    throws HibernateException\n{\n    Iterator&lt;Member&gt; it = members.iterator();\n    while (it.hasNext())\n    {\n        while (it.hasNext())\n        {\n            Member wsBean = it.next();\n            em.persist(wsBean); // overall commit will be made after method exit\n            log.info(\"Webservices record \" + wsBean + \" saved. \" + i++);\n        }\n    }\n}\n</code></pre>\n\n<p>I would like to have commit to DB after say each 500 items. Is that possible with aforementioned context?</p>\n"},{"tags":["spring","hibernate","maven-2","spring-security","dependency-management"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12921519,"title":"Migrating to Spring 3.1 from 3.0.5 using apache-ivy: java.lang.IncompatibleClassChangeError:","body":"<p>I'm struggling with Apache Ivy for the last two weeks to manage dependencies but the apparent ease of use which everybody talks about on the web (once maven/gradle/apache-ivy is used for DM) has eluded me. Can somebody please help and see what am I doing wrong? I'll really appreciate it.</p>\n\n<p>I'm trying to use migrate an existing Spring/JPA-Hibernate application to the latest Spring and Hibernate distributions: </p>\n\n<pre><code>Spring 3.1.2\nSpring Security 3.1.1\nHibernate 4.1\n</code></pre>\n\n<p>My Environment:</p>\n\n<pre><code>Eclipse Helios\nTomcat 7.23\n</code></pre>\n\n<p>ivy.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;ivy-module version=\"2.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n   xsi:noNamespaceSchemaLocation=\"http://ant.apache.org/ivy/schemas/ivy.xsd\"&gt;    &lt;info\n    organisation=\"\"\n    module=\"FocusIvy\"\n    status=\"integration\"&gt;\n&lt;/info&gt;\n&lt;dependencies&gt;  \n    &lt;dependency org=\"org.hibernate\" name=\"com.springsource.org.hibernate.ejb\" rev=\"4.1.0.Final\" /&gt;\n    &lt;dependency org=\"org.hibernate\" name=\"com.springsource.org.hibernate.annotations\" rev=\"3.4.0.GA-A\" /&gt;\n    &lt;dependency org=\"org.hibernate.common\" name=\"com.springsource.org.hibernate.annotations.common\" rev=\"4.1.0.Final\" /&gt;\n    &lt;dependency org=\"org.hibernate\" name=\"com.springsource.org.hibernate\" rev=\"4.1.0.Final\" /&gt;\n    &lt;dependency org=\"org.hibernate\" name=\"com.springsource.org.hibernate.core\" rev=\"4.1.0.Final\" /&gt;\n    &lt;dependency org=\"org.hibernate\" name=\"com.springsource.org.hibernate.validator\" rev=\"4.2.0.Final\" /&gt; \n\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.core\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.beans\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.context\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.context.support\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.transaction\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.jdbc\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.expression\" rev=\"3.1.2.RELEASE\" /&gt;  \n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.aop\" rev=\"3.1.2.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.web\" rev=\"3.1.2.RELEASE\" /&gt; \n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.web.servlet\" rev=\"3.1.2.RELEASE\" /&gt; \n    &lt;dependency org=\"org.springframework\" name=\"org.springframework.orm\" rev=\"3.1.2.RELEASE\" /&gt;\n\n    &lt;dependency org=\"org.springframework.security\" name=\"org.springframework.security.core\" rev=\"3.1.1.RELEASE\" /&gt;      \n    &lt;dependency org=\"org.springframework.security\" name=\"org.springframework.security.aspects\" rev=\"3.1.1.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework.security\" name=\"org.springframework.security.taglibs\" rev=\"3.1.1.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework.security\" name=\"org.springframework.security.web\" rev=\"3.1.1.RELEASE\" /&gt;\n    &lt;dependency org=\"org.springframework.security\" name=\"org.springframework.security.annotation\" rev=\"2.0.6.RELEASE\" /&gt;\n\n    &lt;dependency org=\"javax.activation\" name=\"com.springsource.javax.activation\"\n            rev=\"1.1.1\" /&gt;\n    &lt;dependency org=\"net.sourceforge.cglib\" name=\"com.springsource.net.sf.cglib\" rev=\"2.2.0\" /&gt;             \n&lt;/dependencies&gt; \n&lt;/ivy-module&gt;\n</code></pre>\n\n<p>ivysettings.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;ivysettings&gt;\n&lt;settings defaultResolver=\"defaultChain\"\n    defaultConflictManager=\"all\" /&gt;\n\n&lt;resolvers&gt;\n    &lt;url name=\"com.springsource.repository.bundles.release\"&gt;\n        &lt;ivy\n            pattern=\"http://repository.springsource.com/ivy/bundles/release/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]\" /&gt;\n        &lt;artifact\n            pattern=\"http://repository.springsource.com/ivy/bundles/release/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]\" /&gt;\n    &lt;/url&gt;\n\n    &lt;url name=\"com.springsource.repository.bundles.external\"&gt;\n        &lt;ivy\n            pattern=\"http://repository.springsource.com/ivy/bundles/external/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]\" /&gt;\n        &lt;artifact\n            pattern=\"http://repository.springsource.com/ivy/bundles/external/[organisation]/[module]/[revision]/[artifact]-[revision].[ext]\" /&gt;\n    &lt;/url&gt;\n    &lt;chain name=\"defaultChain\" returnFirst=\"true\"&gt;\n        &lt;resolver ref=\"com.springsource.repository.bundles.release\" /&gt;\n        &lt;resolver ref=\"com.springsource.repository.bundles.external\" /&gt;\n    &lt;/chain&gt;\n&lt;/resolvers&gt;\n&lt;/ivysettings&gt;\n</code></pre>\n\n<p>Tomcat server startup (and application deployment) results in a score of errors:</p>\n\n<pre><code> WARNING: Unable to load class     [org.springframework.instrument.classloading.jboss.JBossMCAdapter] to check against the     @HandlesTypes annotation of one or more ServletContentInitializers.\n java.lang.IncompatibleClassChangeError: Implementing class\nat java.lang.ClassLoader.defineClass1(Native Method)\nat java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)\nat java.lang.ClassLoader.defineClass(ClassLoader.java:616)\nat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)\nat org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2823)\nat org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1160)\nat org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1655)\nat org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1533)\nat org.apache.catalina.startup.ContextConfig.checkHandlesTypes(ContextConfig.java:1988)\nat org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:1951)\nat org.apache.catalina.startup.ContextConfig.processAnnotationsJar(ContextConfig.java:1840)\nat org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1808)\nat org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1794)\nat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1214)\nat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:828)\nat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:302)\nat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\nat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\nat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5148)\nat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\nat org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1525)\nat org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1515)\nat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\nat java.util.concurrent.FutureTask.run(FutureTask.java:138)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\nat java.lang.Thread.run(Thread.java:662)\n Oct 16, 2012 2:31:42 PM org.apache.catalina.startup.ContextConfig checkHandlesTypes\n WARNING: Unable to load class      [org.springframework.instrument.classloading.jboss.JBossModulesAdapter] to check against   the @HandlesTypes annotation of one or more ServletContentInitializers.\njava.lang.IncompatibleClassChangeError: Implementing class\nat java.lang.ClassLoader.defineClass1(Native Method)\nat java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)\nat java.lang.ClassLoader.defineClass(ClassLoader.java:616)\nat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)\nat org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2823)\nat org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1160)\nat org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1655)\nat org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1533)\nat org.apache.catalina.startup.ContextConfig.checkHandlesTypes(ContextConfig.java:1988)\nat org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:1951)\nat org.apache.catalina.startup.ContextConfig.processAnnotationsJar(ContextConfig.java:1840)\nat org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1808)\nat org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1794)\nat org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1214)\nat org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:828)\nat org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:302)\nat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\nat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\nat org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5148)\nat org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\nat org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1525)\nat org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1515)\nat java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\nat java.util.concurrent.FutureTask.run(FutureTask.java:138)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\nat java.lang.Thread.run(Thread.java:662)\n   Oct 16, 2012 2:31:44 PM org.apache.catalina.startup.ContextConfig checkHandlesTypes\n</code></pre>\n"},{"tags":["java","hibernate","spring","java-ee"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":259,"score":3,"question_id":6704161,"title":"When to use @Transactional's propagation=Proagation.REQUIRES_NEW?","body":"<p>My question is simple and nearly already stated in the title: Is there a specific pattern/ use-case where one would say that @Transactional(propagation=Proagation.REQUIRES_NEW) instead of the default propagation should be used?</p>\n\n<p>Thanks !</p>\n"},{"tags":["hibernate","jpa","oracle10g"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":97,"score":2,"question_id":12846621,"title":"Why might EntityManagerFactoryImpl.createEntityManager() result in a NullPointerException?","body":"<p>I am new to JPA.  My code trying to connect to an Oracle 10.3 database to populate some tables.  However, before it even gets to the code population, it throws a NullPointerException in EntityManagerFactoryImpl.createEntityManager(String).  I have already verified that the <code>emf</code> variable is not null. Here is the relevant code in Populator.java, which is just like many tutorial examples:</p>\n\n<pre><code>public static void main(String[] args) {\n    EntityManagerFactory emf =\n        Persistence.createEntityManagerFactory(\"LeaveSchedulerJPA\");\n    EntityManager em = emf.createEntityManager();\n</code></pre>\n\n<p>The exception trace is:</p>\n\n<pre><code>[EL Severe]: 2012-10-11 14:37:02.415--ServerSession(37999235)--java.lang.NullPointerException\n    at java.util.ResourceBundle.getBundle(ResourceBundle.java:950)\n    at org.eclipse.persistence.exceptions.i18n.ExceptionMessageGenerator.buildMessage(ExceptionMessageGenerator.java:47)\n    at org.eclipse.persistence.exceptions.ValidationException.errorDecryptingPassword(ValidationException.java:864)\n    at org.eclipse.persistence.internal.security.JCEEncryptor.decryptPassword(JCEEncryptor.java:124)\n    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.updateLogins(EntityManagerSetupImpl.java:1183)\n    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.updateServerSession(EntityManagerSetupImpl.java:1450)\n    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:372)\n    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.getServerSession(EntityManagerFactoryImpl.java:164)\n    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:221)\n    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:209)\n    at com.engilitycorp.leaveschedulerjpa.Populator.main(Populator.java:28)\n</code></pre>\n\n<p>My persistence.xml is below.  The specified URL works when I use it from Eclipse to generate classes corresponding to the tables.  Any ideas?</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"2.0\" xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"&gt;\n    &lt;persistence-unit name=\"LeaveSchedulerJPA\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n        &lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.Holiday&lt;/class&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.Leave&lt;/class&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.LeaveType&lt;/class&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.Notification&lt;/class&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.NotificationType&lt;/class&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.Role&lt;/class&gt;\n        &lt;class&gt;com.engilitycorp.leaveschedulerjpa.User&lt;/class&gt;\n        &lt;properties&gt;\n        &lt;property name=\"javax.persistence.jdbc.url\" value=\"jdbc:oracle:thin:@localhost:1521:xe\"/&gt;\n            &lt;property name=\"javax.persistence.jdbc.user\" value=\"leavescheduler\"/&gt;\n            &lt;property name=\"javax.persistence.jdbc.password\" value=\"xxxx\"/&gt;\n            &lt;property name=\"javax.persistence.jdbc.driver\" value=\"oracle.jdbc.OracleDriver\"/&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n"},{"tags":["java","hibernate","example","flush"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":320,"score":0,"question_id":7221945,"title":"Practical examples use Hibernate FlushMode.ALWAYS","body":"<p>Could you give me some practical examples that use FlushMode.ALWAYS in Hibernate session?</p>\n\n<p>Thanks,</p>\n"},{"tags":["java","mysql","hibernate","jpa","jpa-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12919337,"title":"JPA entity has more than one objects of the same class","body":"<pre><code>@Entity\npublic class A {\n\n    //should be mapped by a                         \n    public B b1;\n    //should be mapped by a\n    public B b2;\n\n}\n\n@Entity\npublic class B {\n    @ManyToOne\n    public A a;\n}\n</code></pre>\n\n<p>Can I achieve something like this? \nI know that I can use <code>long b1_id</code> and <code>long b2_id</code> in <code>class A</code> but I just want to see if there is a way to use the object right away.\nBasically, <code>class A</code> will have exactly 2 instances of <code>class B</code>. It is not in a collection so I can't use <code>@OneToMany</code>. \n<code>Class B</code> always map to a single A. </p>\n\n<p>The db table should be something like this:</p>\n\n<pre><code>A\nid | b1_id | b2_id\n\nB\nid | a_id\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12917873,"title":"Does Spring OpenSessionInViewFilter persist changes?","body":"<p>I realise this is a pretty dumb question, and I have googled.</p>\n\n<p>Does Spring OpenSessionInViewFilter persist changes made in the Weblayer to the DB when the form is submitted?</p>\n\n<p>i.e. Is the Session kept open long enough for Hibernate to know that the domain objects which populated the UI are now \"dirty\" and should be updated?</p>\n\n<p>I thought it (OpenSessionInViewFilter) was only used to keep the hibernate session open long enough to allow the Web/UI layer to access lazy loaded collections etc and then it closed.</p>\n"},{"tags":["oracle","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12919190,"title":"Hibernate String to Oracle Varchar2 mapping","body":"<p>This is regarding mapping of Hibernate to Oracle Data Types. In our hibernate mapping file we are mapping one of the columns to hibernate as</p>\n\n<p><code>&lt;property name = \"serialnumber\"           column = \"SERIAL_NUMBER\"          type = \"java.lang.String\" not-null = \"true\" /&gt;</code> .</p>\n\n<p>This at runtime resolves to either a VARCHAR2(128) and sometimes as a VARCHAR2(2000), this is causing some performance issue in DB because of cursor mutex contention. </p>\n\n<p>What is the reason for this behavior and how can we fix this?</p>\n"},{"tags":["java","spring","hibernate","transactions","mybatis"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":95,"score":4,"question_id":12917523,"title":"With Spring @Transactionnal, how do Spring know which datasource to use?","body":"<p>When using @Transactionnal with Spring</p>\n\n<ul>\n<li><p>How does it select the datasource on which it should open the transaction?</p></li>\n<li><p>Is there some magic trick like proxies, threadlocals or anything?</p></li>\n<li><p>If so, do these tricks work with any JDBC library (for Hibernate it works but what about MyBatis?)</p></li>\n<li><p>What if there are 2 datasources?</p></li>\n<li><p>And what if i'm calling, in a @Transactionnal service, DAO's with 2 underlying different datasources? Will it be transactionnal for both datasources or just for one of them or will it fail?</p></li>\n</ul>\n\n<p>Thanks</p>\n"},{"tags":["hibernate","tapestry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12916881,"title":"How to search items in a DB using Hibernate","body":"<p>I'm new (very new) to hibernate. I'm using Hibernate with Tapestry. What i want to do is search some element in the DB. I have userId, username and password in the DB ( and a class named User). I need to check the input string with the username, and if its there then need to check the password is right.</p>\n\n<pre><code>List&lt;User&gt; moderators =  session.createCriteria(User.class).list();\n</code></pre>\n\n<p>I can get the list of objects and search though it. but i believe Hibernate will do it better and faster. Can any one tell me how to do it?</p>\n"},{"tags":["java","query","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12900029,"title":"Hibernate Sorting by associated (optional) fields","body":"<p>I am trying to do a sort on a Hibernate dataset, ordering by a attribute of an (optionally) associated object. I followed the example from <a href=\"http://stackoverflow.com/questions/870029/hibernate-order-by-association\">hibernate order by association</a> - and that works to an extent. The problem comes when there is not an associated object, the whole record is ignored.</p>\n\n<p>If I change the association type of the object to be an outer join, will it help matters? And if so, can someone please point me towards the correct directive?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["hibernate","jpa","postgresql-9.1"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1546,"score":2,"question_id":8120181,"title":"JPA with Hibernate 3.6.8.Final, PostgresSQL 9.1, SQLGrammarException - configuration issue? Weird SQL statement","body":"<p><strong>Edit</strong>:\n<strong>SOLVED</strong>\nRight. I found the thing that confused me.\nI use pgadmin to create tables and others database internals, checked right now: if at least one letter in the name (table name, column name, pk name, etc) is in the upper case, then pgadmin uses it in the SQL creation script as it is, using double quotes, so PostgreSQL interprets the name as it was written. If run the following script:</p>\n\n<pre><code>CREATE TABLE SAMPLE\n(\n  ID integer NOT NULL,\n  TITLE character varying(100) NOT NULL,\n  CONSTRAINT SAMPLE_ID_PK PRIMARY KEY (ID)\n)\nWITH (\n  OIDS=FALSE\n);\nALTER TABLE SAMPLE\n  OWNER TO postgres;_\n</code></pre>\n\n<p>it creates everything in the lower case, and the original Sample.java version works fine. \n<hr />\nWhat is wrong here? Is this issue specific to PostgreSQL 9.1 or PostgreSQL in general, or some hibernate configuration is missing?</p>\n\n<p><strong>persistence.xml:</strong></p>\n\n<p>\n</p>\n\n<pre><code>&lt;persistence-unit name=\"com.sample.persistence.jpa\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n    &lt;class&gt;com.sample.persistence.Sample&lt;/class&gt;\n    &lt;properties&gt;\n        &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.PostgreSQLDialect\"/&gt;\n        &lt;property name=\"hibernate.connection.url\" value=\"jdbc:postgresql:sample\"/&gt;\n        &lt;property name=\"javax.persistence.jdbc.driver\" value=\"org.postgresql.Driver\"/&gt;\n        &lt;property name=\"hibernate.connection.username\" value=\"postgres\"/&gt;\n        &lt;property name=\"hibernate.connection.password\" value=\"postgres\"/&gt;\n        &lt;property name=\"hibernate.show_sql\" value=\"true\"/&gt;\n        &lt;property name=\"hibernate.format_sql\" value=\"true\"/&gt;\n        &lt;property name=\"hbm2ddl.auto\" value=\"update\"/&gt;\n    &lt;/properties&gt;\n&lt;/persistence-unit&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>Sample.java</strong>:</p>\n\n<pre><code>@Entity\n@Table(name = \"SAMPLE\")\npublic class Sample {\n\n    @Id\n    @Column(name = \"ID\")\n    private long id;\n\n    @Column(name = \"TITLE\")\n    private String title;\n\n    public String getTitle() {\n        return title;\n    }\n}\n</code></pre>\n\n<p><strong>PersistenceMain.java:</strong></p>\n\n<pre><code>public class PersistenceMain {\n\n\n    public static void main(String[] args) {\n        EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"com.sample.persistence.jpa\");\n        EntityManager em = emf.createEntityManager();\n\n        Sample sample = em.find(Sample.class, 1l);\n\n        System.out.println(\"Sample Title: \" + sample.getTitle());\n\n        em.close();\n\n        emf.close();\n    }\n}\n</code></pre>\n\n<p><strong>Exception:</strong></p>\n\n<pre><code>...\nHibernate: \n    select\n        sample0_.ID as ID0_0_,\n        sample0_.TITLE as TITLE0_0_ \n    from\n        SAMPLE sample0_ \n    where\n        sample0_.ID=?\nException in thread \"main\" javax.persistence.PersistenceException:     org.hibernate.exception.SQLGrammarException: could not load an entity:   [com.sample.persistence.Sample#1]\n ...\nCaused by: org.postgresql.util.PSQLException: ERROR: relation \"sample\" does not exist\n ...\n</code></pre>\n\n<p>Obviously, this SQL statement above:</p>\n\n<pre><code>select\n    sample0_.ID as ID0_0_,\n    sample0_.TITLE as TITLE0_0_ \nfrom\n    SAMPLE sample0_ \nwhere\n    sample0_.ID=?\n</code></pre>\n\n<p>is not executed successfully from the PostgreSQL itself (from pgadmin).</p>\n\n<p>But, if I change Sample.java to:</p>\n\n<pre><code>@Entity\n@Table(name = \"\\\"SAMPLE\\\"\")\npublic class Sample {\n\n    @Id\n    @Column(name = \"\\\"ID\\\"\")\n    private long id;\n\n    @Column(name = \"\\\"TITLE\\\"\")\n    private String title;\n\n    public String getTitle() {\n        return title;\n    }\n}\n</code></pre>\n\n<p>which is weird, it works.</p>\n\n<pre><code>Hibernate: \n    select\n        sample0_.\"ID\" as ID1_0_0_,\n        sample0_.\"TITLE\" as TITLE2_0_0_ \n    from\n        \"SAMPLE\" sample0_ \n    where\n        sample0_.\"ID\"=?\nSample Title: Sample\n</code></pre>\n\n<p>Is hibernate.dialect useless here, or it doesn't work properly with PostgreSQL 9.1?\nAlso, I would like not to type columns names if they are the same as the field, but in upper case, is it also possible?</p>\n\n<p>Thank you.</p>\n"},{"tags":["hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12897680,"title":"Hibernate performs several queries instead of one","body":"<p>I've been trying to optimize the way hibernate achieve some information, but I can't understand next issue.</p>\n\n<p>I've one entity like this</p>\n\n<pre><code>public class AnoEmp{\n    //bi-directional many-to-one association to Empleado\n    @ManyToOne(fetch=FetchType.EAGER)\n    @JoinColumn(name=\"ID_EMPLEADO\", nullable=false, insertable=false, updatable=false)\n    private Empleado empleado;\n}\n...\n</code></pre>\n\n<p>And another one like this</p>\n\n<pre><code>public class Empleado{\n    //bi-directional many-to-one association to AnoEmp\n    @JsonIgnore\n    @OneToMany(mappedBy=\"empleado\", fetch=FetchType.LAZY)\n    private List&lt;AnoEmp&gt; anosEmp;\n...\n</code></pre>\n\n<p>Althoug it's eager (and it has to be like that) It performs N + 1 queries one for the list of AnoEmp and one per Empleado. But it could be done with just one query (as I expected becouse of @eager)</p>\n\n<p>I found this <a href=\"http://stackoverflow.com/questions/3381521/why-hibernate-perform-two-queries-for-eager-load-a-onetoone-bidirectional-assoc\">Why hibernate perform two queries for eager load a @OneToOne bidirectional association?</a> but can't get mine running properly. Any suggestion? Thank you very much.</p>\n"},{"tags":["hibernate","one-to-many","cascade"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12914829,"title":"Spring Hibernate DefaultSaveOrUpdateEventListener does not work one-to-many relationships(Cascade.persist)","body":"<p>I am using org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean for the session factory and I have following models.  </p>\n\n<pre><code>@Entity\n@Audited\n@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)\npublic abstract class BaseModel {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"ID\")\n    private Long id;\n\n    @Version\n    @Column(name = \"VERSION\")\n    private Long version;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    @Column(name = \"CREATION_TIME\")\n    private Date createTime;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    @Column(name = \"LAST_UPDATE_TIME\")\n    private Date lastUpdateTime;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public Long getVersion() {\n        return version;\n    }\n\n    public void setVersion(Long version) {\n        this.version = version;\n    }\n\n    public Date getCreateTime() {\n        return createTime;\n    }\n\n    public void setCreateTime(Date createTime) {\n        this.createTime = createTime;\n    }\n\n    public Date getLastUpdateTime() {\n        return lastUpdateTime;\n    }\n\n    public void setLastUpdateTime(Date lastUpdateTime) {\n        this.lastUpdateTime = lastUpdateTime;\n    }\n}  \n</code></pre>\n\n<p>Test1  </p>\n\n<pre><code>@Entity\npublic class Test1 extends BaseModel {\n\n    @ManyToOne()\n    @JoinColumn(name = \"parent_Id\", insertable = false, updatable = false)\n    private Test1 parent;\n\n    @OneToMany(cascade = CascadeType.ALL, orphanRemoval = false)\n    @OrderColumn\n    @JoinColumn(name = \"parent_Id\")\n    private Set&lt;Test1&gt; children = new HashSet&lt;Test1&gt;(0);\n\n    public Test1 getParent() {\n        return parent;\n    }\n\n    public void setParent(Test1 parent) {\n        this.parent = parent;\n    }\n\n    public Set&lt;Test1&gt; getChildren() {\n        return children;\n    }\n\n    public void setChildren(Set&lt;Test1&gt; children) {\n        this.children = children;\n    }\n}\n</code></pre>\n\n<p>Furthermmore I have a listener for the persist operations  </p>\n\n<pre><code>@Component\npublic class ApplicationSaveEventListener extends DefaultSaveOrUpdateEventListener {\n\n    @Override\n    public void onSaveOrUpdate(SaveOrUpdateEvent event)\n            throws HibernateException {\n        if (event.getObject() instanceof BaseModel) {\n            BaseModel record = (BaseModel) event.getObject();\n            record.setLastUpdateTime(new Date());\n            record.setCreateTime(new Date());\n        }\n        super.onSaveOrUpdate(event);\n    }\n}\n</code></pre>\n\n<p>I test it with the following method:   </p>\n\n<pre><code>Test1Bo test1Bo = (Test1Bo) context.getBean(\"test1Bo\");\n\nTest1 parent = new Test1();\nTest1 child1 = new Test1();\nchild1.setParent(parent);\nTest1 child2 = new Test1();\nchild2.setParent(parent);\n\nparent.getChildren().add(child1);\nparent.getChildren().add(child2);\ntest1Bo.addTest1(parent);  \n</code></pre>\n\n<p>Now, I can catch and set the relevant time fields of the parent. On the other hand, listener cannot catch the cascade persist of children. Do you have an idea why listener's onSaveOrUpdate method did not called while persisting the children?</p>\n"},{"tags":["hibernate","classcastexception"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":975,"score":0,"question_id":5285588,"title":"Hibernate createQuery() throws ClassCastException, Transformer doesn't help","body":"<p>Trying to SELECT an entity using Using Hibernate 3.6 and MySQL5.1 but I keep getting a ClassCastException.</p>\n\n<pre><code>@Entity\n@Table( name = \"USER\" )\npublic class User {\n   @Id\n   @Column(name= \"user_id\")\n   private Long userId;\n\n   @OneToOne()\n   @JoinColumn(name=\"status_id\")\n   protected UserStatusType userStatusType;\n\n   @OneToOne()\n   @JoinColumn(name=\"region_id\")\n   protected Region region;\n\n\n@Entity\n@Table( name = \"REGION\" )\npublic class Region   \n   @Id\n   @Column(name = \"region_id\")\n   private Long regionId\n\n\n@Entity\n@Table( name = \"USER_STATUS_TYPE\" )\npublic class UserStatusType  \n   @Id\n   @Column(name = \"type_id\")\n   private Long typeId\n</code></pre>\n\n<p>When attempting to use HQL in createQuery() I keep getting a ClassCastException:</p>\n\n<pre><code>session.beginTransaction();\nUser user = (User)session.createQuery(\n   \"from User u, UserStatusType ust, Region r \"\n   + \" where u.userId = ? and u.userStatusType.typeId = ust.typeId\"\n   + \" and u.region.regionId = r.regionId\")\n   .setLong(0, 42L)                     \n   .uniqueResult();\n\n\n java.lang.ClassCastException:\n[Ljava.lang.Object; cannot be cast to com.scd.dao.entity.User\n</code></pre>\n\n<p>I tried using setResultTransformer(Transformers.aliasToBean(User.class)), but that gave me a NullPointerException.</p>\n\n<p>Not sure what I'm doing wrong.</p>\n"},{"tags":["java","hibernate","unit-testing","tdd"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":12899103,"title":"How to test the hibernate generic dao pattern","body":"<p>I'm starting a project using Google Guice and Hibernate and, in the way to configure the database access layer, I got troubled with several doubts along this process.</p>\n\n<p>I'm using JPA annotations in my POJOs and my Generic DAO implementation uses an EntityManager object to communicate with the database. I did several \"manual\" tests and I saw it was working fine but I prefer to follow a TDD methodology to enforce my knowledge in this kind of methodologies. I'm not sure what is the best way to test generics in java and even less the best solution for testing the Hibernate Generic DAO pattern.</p>\n\n<p>I have read several solutions but I don't feel really comfortable with none of them:</p>\n\n<ul>\n<li>One of them is to make an abstract class to test the Generic DAO and use abstract methods to get the specific DAO and to get the instances to persist, etc.</li>\n<li>Another solution consist on use an abstract class (like the previous solution) and use factories instead of abstract methods: With these two solutions I don't know if it's worth to have a method to get an entity to test every each case in my project.</li>\n<li>Another one solution could be to test every functionality in the specific DAO better than in the generic dao: I think this is the worst solution because, in the most of cases, I will have to repeat a lot of code to test the same thing.</li>\n</ul>\n\n<p>Apart from that, I have read that it could be better to remove the DAO layer and use the entity manager directly from services: I don't think this is the best way because you are mixing the database layer with the service layer.</p>\n\n<p>Anyone who could help me please?!</p>\n"},{"tags":["sql","database","hibernate","relational-database"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12890615,"title":"What reason to use sequences in databases?","body":"<p>I new to DB/Hibernate and found code:</p>\n\n<pre>\n@SequenceGenerator(name = \"entSeq\", allocationSize = 5, sequenceName = \"CODE_SEQ\")\n...\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"entSeq\")\n</pre>\n\n<p>which set sequence for primary key.</p>\n\n<p>Why was sequences used for values of primary key? Which goals was addressed:</p>\n\n<ul>\n<li>increase performance</li>\n<li>add constraints, some checks</li>\n<li>limit possible value range of integer values of ID, why to do so??</li>\n<li>why to start counting from 1?</li>\n</ul>\n\n<p>I read about syntax and usage in:</p>\n\n<ul>\n<li><a href=\"http://msdn.microsoft.com/en-us/library/ff878091.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/ff878091.aspx</a></li>\n<li><a href=\"http://www.techonthenet.com/oracle/sequences.php\" rel=\"nofollow\">http://www.techonthenet.com/oracle/sequences.php</a></li>\n</ul>\n\n<p>but doesn't found answer for my question.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I enjoyed reading:</p>\n\n<ul>\n<li><a href=\"http://www.oracle.com/technetwork/products/rdb/0307-sequences-130053.pdf\" rel=\"nofollow\">http://www.oracle.com/technetwork/products/rdb/0307-sequences-130053.pdf</a>\n            Guide to Using SQL: Sequence Number Generator</li>\n</ul>\n\n<p>where shown that there is problem in DB theory how to get unique ID for primary keys. That mean that I can make <strong>insert</strong> into table without providing value for primary key from my own:</p>\n\n<pre>\n    INSERT INTO suppliers\n    (supplier_id, supplier_name)\n    VALUES\n    (supplier_seq.nextval, 'Kraft Foods');\n</pre>\n\n<p>But I expect that this feature must be present in all DB without forcing me to supply primary key values...</p>\n\n<p>Do I think right?</p>\n\n<p><strong>UPDATE2:</strong></p>\n\n<p>Answer for why use <strong>START WITH</strong>:</p>\n\n<p><em>This clause can be useful when adding sequences to existing databases. When an older scheme was in\nuse by the application and has already consumed some values from the legal range this clause can be\nused to skip those consumed values. MINVALUE and MAXVALUE are used to specify the legal range but\nSTART WITH would initiate the sequence usage within that range so that previously generated values\nwould not reappear.</em></p>\n\n<p><strong>UPDATE3:</strong> *<em>sequences</em>* provide <a href=\"http://en.wikipedia.org/wiki/Surrogate_key\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Surrogate_key</a></p>\n"},{"tags":["hibernate","join","map","one-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2933,"score":1,"question_id":920309,"title":"Left outer join fetch doesn't fill map collection properly (HQL)","body":"<p>I've got classes with mappings like this:</p>\n\n<pre><code>@Entity\npublic class CurrencyTable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Long id;\n\n    @Version\n    @Column(nullable=false)\n    private Timestamp version;\n\n    @Column(length=32, unique=true)\n    private String refCode;\n\n   @OneToMany(mappedBy=\"currencyTable\", fetch=FetchType.LAZY, cascade =  {CascadeType.ALL})\n   @MapKey(name=\"currency\")\n   private Map&lt;String, CurrencyTableRate&gt; rateMap = new HashMap&lt;String, CurrencyTableRate&gt;();\n}\n\n@Entity\npublic class CurrencyTableRate{\n    @Id\n    @GeneratedValue(strategy = GenerationType.SEQUENCE)\n    private Long id;\n\n    @Version\n    @Column(nullable=false)\n    private Timestamp version;\n\n    @Column(length=3)\n    private String currency;\n\n    @Basic\n    private BigDecimal rateValue;\n\n    @ManyToOne(optional=false,fetch=FetchType.LAZY)\n    private CurrencyTable currencyTable;\n}\n</code></pre>\n\n<p>There is one row in CurrencyTable and three rows in CurrencyTableRate referring to the CurrencyTable in database.</p>\n\n<p>When I load CurrencyTable using HQL:</p>\n\n<pre><code>from CurrencyTable where refCode = :refCode\n</code></pre>\n\n<p>I get an entity with three entries in rateMap, but if I try this:</p>\n\n<pre><code>from CurrencyTable table left outer join fetch table.rateMap where refCode = :refCode\n</code></pre>\n\n<p>there is only one entry in rateMap.</p>\n\n<p>I looked on query generated by Hibernate and ran it manually - it returned three rows, as expected, so it seems to be a problem with mapping them after fetching. Has anyone encuntered such a problem?\nI use Hibernate version 3.2.6.ga and Oracle 10g</p>\n"},{"tags":["hibernate","jboss","entitymanager","jta"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12708543,"title":"Can not close EntityManager after doing a rollback","body":"<p>Following is my environment specifications:</p>\n\n<p>Server: JBOSS6.1 final</p>\n\n<p>Persistence layer: JPA with Hibernate as persistence provider (Hibernate version 3.6.6.Final)</p>\n\n<p>Application architecture is like: Controller -> Session Beans -> Businell Logic Layer -> Builder (Hibernate layer) - DB (MYSQL)</p>\n\n<p>We are using \"RESOURCE_LOCAL\" transaction which is configured in the persistence.xml as follows:</p>\n\n<pre><code>&lt;persistence-unit name=\"test\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n  &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n  &lt;non-jta-data-source&gt;java:/TestDS&lt;/non-jta-data-source&gt;\n</code></pre>\n\n<p>And we use the transactions as shown below:</p>\n\n<pre><code>try {\n  txUtil.beginTransaction();\n  &lt;-- some entity update etc here --&gt;\n  if(some validation fail here){\n      txUtil.rollbackTransaction();\n  } else {\n      txUtil.commitTransaction();\n  } catch (Exception e) {\n      txUtil.rollbackTransaction();\n  } finally {\n      try {\n          txUtil.closeEntityManager();\n      } catch (BAException e) {\n          log.warn(\"Problem occurred while closing the EntityManager: \" + e.getLocalizedMessage(), e);\n      }\n  }\n</code></pre>\n\n<p>Where the code for various methods used above is something like (below is not exact impl but a crude representation of what we have):</p>\n\n<pre><code>beginTransaction(){\n    EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"test\");\n    EntityManager em = emf.createEntityManager();\n    if(em.isOpen())\n    {\n            transaction = em.getTransaction();\n            if(!transaction.isActive())\n            {   \n                transaction.begin();\n            }\n    }\n}\n\n\ncommitTransaction(){\n    if(em.isOpen())\n    {\n        EntityTransaction transaction = em.getTransaction();\n        if(transaction.isActive())\n        {   \n            transaction.commit();\n        }\n    }\n}\n\nrollbackTransaction(){\n    if(em.isOpen())\n    {\n        EntityTransaction transaction = em.getTransaction();\n        if(transaction.isActive())\n        {   \n            log.debug(\"EntityManager for thread (\" + \n                Thread.currentThread().hashCode() +\n                \") has active transaction (\" + \n                transaction.hashCode() + \"): rollback\");\n            transaction.rollback();\n        }\n    }\n}\n\ncloseEntityManager() {\n    if(em.isOpen()) {\n        EntityTransaction tx=em.getTransaction();\n        if(tx==null) {\n           log.debug(\"No transaction associated with EntityManager\");\n        } else {\n            if(tx.isActive()) {\n               log.debug(\"EntityManager has active transaction, rolling out\");\n               tx.rollback();\n            } else {\n               log.debug(\"EntityManager transaction was not active\");\n            }\n        }\n     } try {\n        em.close();\n     }\n}\n</code></pre>\n\n<p>The problem is that anytime we do a rollback and then if we try to close the entity manager, it throws a rollback exception. The stacktrace for the same is as follows:</p>\n\n<pre><code>04:46:16,378 ERROR [STDERR] org.hibernate.TransactionException: could not register synchronization\n04:46:16,384 ERROR [STDERR]     at org.hibernate.transaction.JTATransaction.registerSynchronization(JTATransaction.java:316)\n04:46:16,385 ERROR [STDERR]     at org.hibernate.ejb.EntityManagerImpl.close(EntityManagerImpl.java:125)\n04:46:16,386 ERROR [STDERR]     at com.test.builder.util.EntityManagerUtil.rollbackAndCloseEntityManager(EntityManagerUtil.java:201)\n04:46:16,387 ERROR [STDERR]     at com.test.builder.util.TransactionUtilImpl.closeEntityManager(TransactionUtilImpl.java:40)\n04:46:16,391 ERROR [STDERR]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n04:46:16,392 ERROR [STDERR]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n04:46:16,393 ERROR [STDERR]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n04:46:16,394 ERROR [STDERR]     at java.lang.reflect.Method.invoke(Method.java:597)\n04:46:16,395 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeTarget(MethodInvocation.java:122)\n04:46:16,396 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:111)\n04:46:16,397 ERROR [STDERR]     at org.jboss.ejb3.interceptors.container.ContainerMethodInvocationWrapper.invokeNext(ContainerMethodInvocationWrapper.java:72)\n04:46:16,398 ERROR [STDERR]     at org.jboss.ejb3.interceptors.aop.InterceptorSequencer.invoke(InterceptorSequencer.java:76)\n04:46:16,399 ERROR [STDERR]     at org.jboss.ejb3.interceptors.aop.InterceptorSequencer.aroundInvoke(InterceptorSequencer.java:62)\n04:46:16,401 ERROR [STDERR]     at sun.reflect.GeneratedMethodAccessor950.invoke(Unknown Source)\n04:46:16,402 ERROR [STDERR]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n04:46:16,403 ERROR [STDERR]     at java.lang.reflect.Method.invoke(Method.java:597)\n04:46:16,404 ERROR [STDERR]     at org.jboss.aop.advice.PerJoinpointAdvice.invoke(PerJoinpointAdvice.java:174)\n04:46:16,405 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,406 ERROR [STDERR]     at org.jboss.ejb3.interceptors.aop.InvocationContextInterceptor.fillMethod(InvocationContextInterceptor.java:74)\n04:46:16,407 ERROR [STDERR]     at org.jboss.aop.advice.org.jboss.ejb3.interceptors.aop.InvocationContextInterceptor_z_fillMethod_446939511.invoke(InvocationContextInterceptor_z_fillMethod_446939511.java)\n04:46:16,408 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,408 ERROR [STDERR]     at org.jboss.ejb3.interceptors.aop.InvocationContextInterceptor.setup(InvocationContextInterceptor.java:90)\n04:46:16,409 ERROR [STDERR]     at org.jboss.aop.advice.org.jboss.ejb3.interceptors.aop.InvocationContextInterceptor_z_setup_446939511.invoke(InvocationContextInterceptor_z_setup_446939511.java)\n04:46:16,410 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,411 ERROR [STDERR]     at org.jboss.ejb3.async.impl.interceptor.AsynchronousServerInterceptor.invoke(AsynchronousServerInterceptor.java:128)\n04:46:16,412 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,414 ERROR [STDERR]     at org.jboss.ejb3.connectionmanager.CachedConnectionInterceptor.invoke(CachedConnectionInterceptor.java:62)\n04:46:16,415 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,416 ERROR [STDERR]     at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke(TransactionScopedEntityManagerInterceptor.java:56)\n04:46:16,417 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,418 ERROR [STDERR]     at org.jboss.ejb3.AllowedOperationsInterceptor.invoke(AllowedOperationsInterceptor.java:47)\n04:46:16,419 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,420 ERROR [STDERR]     at org.jboss.ejb3.tx.NullInterceptor.invoke(NullInterceptor.java:42)\n04:46:16,421 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,422 ERROR [STDERR]     at org.jboss.ejb3.stateless.StatelessInstanceInterceptor.invoke(StatelessInstanceInterceptor.java:68)\n04:46:16,423 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,424 ERROR [STDERR]     at org.jboss.ejb3.core.context.SessionInvocationContextAdapter.proceed(SessionInvocationContextAdapter.java:95)\n04:46:16,425 ERROR [STDERR]     at org.jboss.ejb3.tx2.impl.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:247)\n04:46:16,426 ERROR [STDERR]     at org.jboss.ejb3.tx2.impl.CMTTxInterceptor.required(CMTTxInterceptor.java:349)\n04:46:16,427 ERROR [STDERR]     at org.jboss.ejb3.tx2.impl.CMTTxInterceptor.invoke(CMTTxInterceptor.java:209)\n04:46:16,428 ERROR [STDERR]     at org.jboss.ejb3.tx2.aop.CMTTxInterceptorWrapper.invoke(CMTTxInterceptorWrapper.java:52)\n04:46:16,430 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,431 ERROR [STDERR]     at org.jboss.aspects.tx.TxPropagationInterceptor.invoke(TxPropagationInterceptor.java:76)\n04:46:16,432 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,434 ERROR [STDERR]     at org.jboss.ejb3.tx.NullInterceptor.invoke(NullInterceptor.java:42)\n04:46:16,435 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,436 ERROR [STDERR]     at org.jboss.ejb3.security.Ejb3AuthenticationInterceptorv2.invoke(Ejb3AuthenticationInterceptorv2.java:182)\n04:46:16,436 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,437 ERROR [STDERR]     at org.jboss.ejb3.ENCPropagationInterceptor.invoke(ENCPropagationInterceptor.java:41)\n04:46:16,438 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,439 ERROR [STDERR]     at org.jboss.ejb3.BlockContainerShutdownInterceptor.invoke(BlockContainerShutdownInterceptor.java:67)\n04:46:16,440 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,441 ERROR [STDERR]     at org.jboss.ejb3.core.context.CurrentInvocationContextInterceptor.invoke(CurrentInvocationContextInterceptor.java:47)\n04:46:16,442 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,443 ERROR [STDERR]     at org.jboss.aspects.currentinvocation.CurrentInvocationInterceptor.invoke(CurrentInvocationInterceptor.java:67)\n04:46:16,444 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,446 ERROR [STDERR]     at org.jboss.ejb3.interceptor.EJB3TCCLInterceptor.invoke(EJB3TCCLInterceptor.java:86)\n04:46:16,447 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,448 ERROR [STDERR]     at org.jboss.ejb3.stateless.StatelessContainer.dynamicInvoke(StatelessContainer.java:392)\n04:46:16,449 ERROR [STDERR]     at org.jboss.ejb3.remoting.IsLocalInterceptor.invokeLocal(IsLocalInterceptor.java:88)\n04:46:16,450 ERROR [STDERR]     at org.jboss.ejb3.remoting.IsLocalInterceptor.invoke(IsLocalInterceptor.java:75)\n04:46:16,451 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,452 ERROR [STDERR]     at org.jboss.ejb3.async.impl.interceptor.AsynchronousClientInterceptor.invoke(AsynchronousClientInterceptor.java:143)\n04:46:16,453 ERROR [STDERR]     at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)\n04:46:16,454 ERROR [STDERR]     at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:62)\n04:46:16,455 ERROR [STDERR]     at $Proxy215.invoke(Unknown Source)\n04:46:16,456 ERROR [STDERR]     at org.jboss.ejb3.proxy.impl.handler.session.SessionProxyInvocationHandlerBase.invoke(SessionProxyInvocationHandlerBase.java:185)\n04:46:16,457 ERROR [STDERR]     at $Proxy224.addMyEntity(Unknown Source)\n04:46:16,458 ERROR [STDERR]     at test.mycomp.services.MyServicesImpl.addMyEntity(MyServicesImpl.java:134)\n04:46:16,459 ERROR [STDERR]     at tv.mycomp.controllers.MyController.addMyEntity(MyController.java:106)\n04:46:16,460 ERROR [STDERR]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n04:46:16,461 ERROR [STDERR]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n04:46:16,462 ERROR [STDERR]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n04:46:16,463 ERROR [STDERR]     at java.lang.reflect.Method.invoke(Method.java:597)\n04:46:16,464 ERROR [STDERR]     at org.springframework.web.servlet.mvc.multiaction.MultiActionController.invokeNamedMethod(MultiActionController.java:472)\n04:46:16,465 ERROR [STDERR]     at org.springframework.web.servlet.mvc.multiaction.MultiActionController.handleRequestInternal(MultiActionController.java:409)\n04:46:16,466 ERROR [STDERR]     at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)\n04:46:16,468 ERROR [STDERR]     at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\n04:46:16,469 ERROR [STDERR]     at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:874)\n04:46:16,470 ERROR [STDERR]     at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:808)\n04:46:16,471 ERROR [STDERR]     at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:476)\n04:46:16,472 ERROR [STDERR]     at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:441)\n04:46:16,473 ERROR [STDERR]     at javax.servlet.http.HttpServlet.service(HttpServlet.java:754)\n04:46:16,474 ERROR [STDERR]     at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n04:46:16,475 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:324)\n04:46:16,476 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:242)\n04:46:16,478 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:274)\n04:46:16,479 ERROR [STDERR]     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:242)\n04:46:16,480 ERROR [STDERR]     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275)\n04:46:16,481 ERROR [STDERR]     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)\n04:46:16,482 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:181)\n04:46:16,484 ERROR [STDERR]     at org.jboss.modcluster.catalina.CatalinaContext$RequestListenerValve.event(CatalinaContext.java:285)\n04:46:16,485 ERROR [STDERR]     at org.jboss.modcluster.catalina.CatalinaContext$RequestListenerValve.invoke(CatalinaContext.java:261)\n04:46:16,486 ERROR [STDERR]     at org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:88)\n04:46:16,487 ERROR [STDERR]     at org.jboss.web.tomcat.security.SecurityContextEstablishmentValve.invoke(SecurityContextEstablishmentValve.java:100)\n04:46:16,488 ERROR [STDERR]     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:159)\n04:46:16,489 ERROR [STDERR]     at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n04:46:16,490 ERROR [STDERR]     at org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:158)\n04:46:16,491 ERROR [STDERR]     at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n04:46:16,492 ERROR [STDERR]     at org.jboss.web.tomcat.service.request.ActiveRequestResponseCacheValve.invoke(ActiveRequestResponseCacheValve.java:53)\n04:46:16,493 ERROR [STDERR]     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:362)\n04:46:16,494 ERROR [STDERR]     at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877)\n04:46:16,495 ERROR [STDERR]     at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:654)\n04:46:16,496 ERROR [STDERR]     at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:951)\n04:46:16,498 ERROR [STDERR]     at java.lang.Thread.run(Thread.java:662)\n04:46:16,501 ERROR [STDERR] Caused by: javax.transaction.RollbackException: ARJUNA-16083 Can't register synchronization because the transaction is in aborted state\n04:46:16,502 ERROR [STDERR]     at com.arjuna.ats.internal.jta.transaction.arjunacore.TransactionImple.registerSynchronizationImple(TransactionImple.java:363)\n04:46:16,503 ERROR [STDERR]     at com.arjuna.ats.internal.jta.transaction.arjunacore.TransactionImple.registerSynchronization(TransactionImple.java:344)\n04:46:16,504 ERROR [STDERR]     at org.hibernate.transaction.JTATransaction.registerSynchronization(JTATransaction.java:313)\n04:46:16,505 ERROR [STDERR]     ... 108 more\n</code></pre>\n\n<p>And following are the transaction related attributes from the persistence.xml</p>\n\n<pre><code>&lt;property name=\"hibernate.transaction.manager_lookup_class\" value=\"org.hibernate.transaction.JBossTransactionManagerLookup\" /&gt;\n\n&lt;property name=\"hibernate.transaction.factory_class\" value=\"org.hibernate.transaction.JTATransactionFactory\" /&gt;\n\n&lt;property name=\"hibernate.transaction.flush_before_completion\" value=\"true\" /&gt;\n</code></pre>\n\n<p>Everywhere I have seen and read about closing the entity manager after rolling back a transaction. But why am I getting the above exception? Is it expected or am I missing something here?</p>\n\n<p>Thanks a lot in advance, please let me know if you need any further information regarding the same.</p>\n"},{"tags":["hibernate","jboss","upgrade","jboss7.x"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12891415,"title":"Not Been able to connect to JNDI while Upgrading to JBoss 7.1 and Hibernate 4.0","body":"<p>We are in a process of upgrading our servers from Jboss 5.1 to Jboss 7.1 Final. But not all the servers will be moving to the new Technology at once.</p>\n\n<p>I am upgrading the first server on Hibernate 4.0 and Jboss 7.1. But was not been able to connect to the Datasource located on the Other Jboss Server (5.1) via JNDI.</p>\n\n<p>Data Source (*-ds.xml)</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;datasources&gt;\n  &lt;local-tx-datasource&gt;\n    &lt;jndi-name&gt;jdbc/wc-mysql&lt;/jndi-name&gt;\n\n    &lt;connection-url&gt;jdbc:mysql://XXX:3306/wellclub&lt;/connection-url&gt;\n    &lt;driver-class&gt;com.mysql.jdbc.Driver&lt;/driver-class&gt;\n    &lt;user-name&gt;myclub&lt;/user-name&gt;\n    &lt;password&gt;myclub&lt;/password&gt;\n\n    &lt;exception-sorter-class-name&gt;\n          org.jboss.resource.adapter.jdbc.vendor.MySQLExceptionSorter\n    &lt;/exception-sorter-class-name&gt;\n\n    &lt;!-- The minimum connections in a pool/sub-pool. \n         Pools are lazily constructed on first use --&gt;\n    &lt;min-pool-size&gt;50&lt;/min-pool-size&gt;\n    &lt;!-- The maximum connections in a pool/sub-pool --&gt;\n    &lt;max-pool-size&gt;200&lt;/max-pool-size&gt;\n    &lt;!-- setting java context as Global so outsider can also use it. --&gt;\n    &lt;use-java-context&gt;false&lt;/use-java-context&gt;\n    &lt;metadata&gt;\n       &lt;type-mapping&gt;mySQL&lt;/type-mapping&gt;\n    &lt;/metadata&gt;\n  &lt;/local-tx-datasource&gt;\n&lt;/datasources&gt;\n</code></pre>\n\n<p>hibernate.cfg.xml</p>\n\n<pre><code>&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n\n        &lt;property name=\"hibernate.connection.datasource\"&gt;jdbc/wc-mysql&lt;/property&gt;\n        &lt;property name=\"hibernate.jndi.url\"&gt;jnp://jndi.wellclub.me:1099&lt;/property&gt;\n        &lt;property name=\"hibernate.transaction.factory_class\"&gt;org.hibernate.transaction.JTATransactionFactory&lt;/property&gt;\n        &lt;property name=\"hibernate.jta.UserTransaction\"&gt;UserTransaction&lt;/property&gt;\n\n        &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.current_session_context_class\"&gt;jta&lt;/property&gt;\n        &lt;property name=\"hibernate.transaction.manager_lookup_class\"&gt;org.hibernate.transaction.JBossTransactionManagerLookup&lt;/property&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>And in Hibernate Utility class I am initiating the SessionFactory as</p>\n\n<pre><code>Configuration configuration = new Configuration().configure();\n\n// Add all the Annotated classes here...\n\nServiceRegistryBuilder builder = new ServiceRegistryBuilder();\nbuilder.applySettings(configuration.getProperties());\nserviceRegistry = builder.buildServiceRegistry();\n\nsessionFactory = configuration.buildSessionFactory(serviceRegistry); &lt;== Error\n</code></pre>\n\n<p><strong>Exception:</strong></p>\n\n<pre><code>03:28:01,820 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/core]] (MSC service thread 1-2) Exception sending context initialized event to listener instance of class com.wellclub.service.WCStartupService: org.hibernate.service.jndi.JndiException: Unable to lookup JNDI name [jdbc/wc-mysql]\n    at org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:68) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.jdbc.connections.internal.DatasourceConnectionProviderImpl.configure(DatasourceConnectionProviderImpl.java:116) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.internal.StandardServiceRegistryImpl.configureService(StandardServiceRegistryImpl.java:75) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:159) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:131) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.buildJdbcConnectionAccess(JdbcServicesImpl.java:223) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.configure(JdbcServicesImpl.java:89) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.internal.StandardServiceRegistryImpl.configureService(StandardServiceRegistryImpl.java:75) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:159) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:131) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:71) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2273) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2269) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1738) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    at com.wellclub.model.util.ParentHibernateUtil.initiateSessionFactory(ParentHibernateUtil.java:131) [wc-model-2.3.0.jar:]\n    at com.wellclub.model.util.HibernateUtil.initiateSessionFactory(HibernateUtil.java:32) [classes:]\n    at com.wellclub.service.WCStartupService.contextInitialized(WCStartupService.java:44) [classes:]\n    at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:3392) [jbossweb-7.0.13.Final.jar:]\n    at org.apache.catalina.core.StandardContext.start(StandardContext.java:3850) [jbossweb-7.0.13.Final.jar:]\n    at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_26]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_26]\n    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_26]\nCaused by: javax.naming.NameNotFoundException: jdbc/wc-mysql -- service jboss.naming.context.java.jdbc.wc-mysql\n    at org.jboss.as.naming.ServiceBasedNamingStore.lookup(ServiceBasedNamingStore.java:97)\n    at org.jboss.as.naming.NamingContext.lookup(NamingContext.java:178)\n    at org.jboss.as.naming.InitialContext.lookup(InitialContext.java:113)\n    at javax.naming.InitialContext.lookup(InitialContext.java:396) [rt.jar:1.6.0_26]\n    at org.hibernate.service.jndi.internal.JndiServiceImpl.locate(JndiServiceImpl.java:65) [hibernate-core-4.1.1.Final.jar:4.1.1.Final]\n    ... 24 more\n</code></pre>\n\n<p>Error Line</p>\n\n<pre><code>org.hibernate.service.jndi.JndiException: Unable to lookup JNDI name [jdbc/wc-mysql]\n</code></pre>\n\n<p>Please tell me what I am missing. If I am doing it the correct way please I would like a guidance as well. </p>\n\n<p>Thanks.</p>\n\n<p>Talha Ahmed Khan</p>\n"},{"tags":["hibernate","sorting"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":721,"score":1,"question_id":810671,"title":"hibernate sorting","body":"<p>hey i want to do nested sorting in hibernate.</p>\n\n<p>i have a set of <code>application</code>s in <code>course</code> object. <code>application</code> has a <code>time</code> and <code>type</code> attribute.\nI want to sort by <code>type</code> first and then within application of particular type i want to sort it by <code>time</code>.</p>\n\n<p>can i use it as follows??</p>\n\n<pre><code>order-by=\"type desc,time asc\" \n</code></pre>\n\n<p>Note that type should be sorted descendingly ( type is a int datatype in java)\nand time ascendingly (time is of date datatype in jave )</p>\n\n<p>eg of ordering  <BR> Type   time <BR>\n                  5           1 <BR>\n                  5        2 <BR>\n                  5         3<BR>\n                  4         1<BR>\n                   4         2<BR></p>\n\n<p>time was given as integer in this example</p>\n"},{"tags":["spring","hibernate","websphere","jta"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":136,"score":0,"question_id":12889462,"title":"Auto Flush not working for Spring 3.1 LocalEntityManagerFactoryBean + Hibernate 4 + Websphere JTA","body":"<p>I have did a lot of search on the web and pages like <a href=\"http://forum.springsource.org/showthread.php?126363-Session-not-flushed-with-Hibernate-4-1-3-JTA-and-Spring-transaction-management-integ\" rel=\"nofollow\">this</a> and <a href=\"https://jira.springsource.org/browse/SPR-9480\" rel=\"nofollow\">this</a> and <a href=\"https://jira.springsource.org/browse/SPR-9404\" rel=\"nofollow\">this</a> mostly suggested for using CMTTransactionFactory.  However I am still unable to make it work (I wonder if it is because I am creating a EM using a LocalContainerEntityManagerFactoryBean instead of creating Hibernate session by LocalSessionFactoryBean)</p>\n\n<p>My App Service looks something like:</p>\n\n<pre><code>@Transactional(propagation=Propagation.REQUIRES_NEW)\npublic class FooServiceImpl implements FooService {\n  @Inject\n  private FooRepository fooRepo;\n\n  public void doSomething() {\n    Foo foo = fooRepo.findBySomething(...);\n    foo.setBar(...);\n    //fooRepo.flush();     // un-comment to do manual-flushing\n  }\n}\n</code></pre>\n\n<p>Here is the snippet in my app ctx</p>\n\n<pre><code>&lt;jee:jndi-lookup  id=\"dataSource\" jndi-name=\"jdbc/fooDs\" /&gt;\n\n&lt;bean id=\"transactionManager\"\n    class=\"org.springframework.transaction.jta.WebSphereUowTransactionManager\" /&gt;\n\n&lt;bean id=\"emf\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n    &lt;property name=\"jpaVendorAdapter\"&gt;\n        &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n            &lt;property name=\"databasePlatform\" value=\"org.hibernate.dialect.Oracle10gDialect\" /&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n    &lt;property name=\"persistenceUnitName\" value=\"foo\" /&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"packagesToScan\" value=\"com.foo\" /&gt;\n    &lt;!--\n      &lt;property name=\"persistenceXmlLocation\" value=\"classpath:/META-INF/test-persistence.xml\" /&gt;\n     --&gt;\n    &lt;property name=\"jpaPropertyMap\"&gt;\n        &lt;map&gt;\n            &lt;entry key=\"hibernate.dialect\" value=\"org.hibernate.dialect.Oracle10gDialect\" /&gt;\n              &lt;entry key=\"hibernate.transaction.manager_lookup_class\" value=\"org.hibernate.transaction.WebSphereExtendedJTATransactionLookup\" /&gt;\n              &lt;entry key=\"hibernate.transaction.factory_class\" value=\"org.hibernate.transaction.CMTTransactionFactory\"/&gt;\n\n            &lt;entry key=\"hibernate.transaction.flush_before_completion\"  value = \"true\" /&gt;\n        &lt;/map&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>I am making use of Spring Data JPA and after the entity is retrieved, I updated the content.  If I am not flushing the repository manually (which means session/entityManager) manually, it simply discard my changes.</p>\n\n<p>Can anyone give me some hints on what I have missed in the setting?  Is there anything special to notice for using LocalContainerEntityManagerFactoryBean?</p>\n\n<p>I tried to change the jpaProperty entry of manager_lookup_class to \n<code>hibernate.transaction.jta.platform  =&gt; org.hibernate.service.jta.platform.internal.WebSphereExtendedJtaPlatform</code> but it does not help.</p>\n\n<p>I also tried to use <code>org.hibernate.transaction.JTATransactionFactory</code> as <code>transaction factory class</code>, or even remove the <code>transaction factory class</code>.  Such change seems makes Hibernate unable to pickup the transaction.  When I am manually flushing the repository, it simply give me a <code>javax.persistence.TransactionRequiredException</code> with message <code>no transaction is in progress</code></p>\n\n<p>I am using Spring 3.1.2.RELEASE, JPA with Hibernate 4.1.6.Final, Websphere 8</p>\n\n<p>Is there anyone using the above combination and have a working config that I can follow? </p>\n\n<hr>\n\n<p>Edit: I have tried to inject EntityManager to the service to avoid using Spring Data JPA.  The symptom is the same: I have to explicitly call entityManager.flush() to let Hibernate pickup the updated entities.  At least we can take Spring Data out of picture :)</p>\n"},{"tags":["java","hibernate","object","mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12899160,"title":"Mapping native java Object to own implemented class","body":"<p>I have a call to database using hibernate</p>\n\n<pre><code>List&lt;Object&gt; result = session.openSession().createSQLQuery(myNativeSQLQuery).list();\n</code></pre>\n\n<p>No I can iterate over that list</p>\n\n<pre><code>Iterator iter = result.iterator();\nwhile(iter.hasNext()){\n    Object[] item = (Object[]) iter.next();\n}\n</code></pre>\n\n<p>But that Object is of no use for myself and so I want to have that object mapped on a class I implemented.</p>\n\n<pre><code>public class MyClass {\n\n    private Long id;\n\n    private String name\n\n    private Set&lt;MySecondClass&gt; myList\n\n    public void myFunc(){\n        // do sth with that id or any other attribute mapped\n    }   \n}\n</code></pre>\n\n<p>I do not want to use hibernate annotations and stuff, because a defined class will be filled up with data by a xml file that defines native sql queries. That way I want to materialize the resulting document into mongodb for a fast data access.</p>\n\n<p>An example of such an xml file you see below</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;mapping&gt;\n&lt;resource&gt;myResource&lt;/resource&gt; &lt;!-- the resource table in mysql where the base query is executed --&gt;\n&lt;destination&gt;myDestination&lt;/destination&gt; &lt;!-- the destination collection in mongodb --&gt;\n\n&lt;document mapped=\"MyClass\"&gt; &lt;!-- that docuemnt and the base query will be mapped on the class \"MyClass\"\n\n    &lt;base sql=\"select id, name from table1\" /&gt;\n    &lt;reference id=\"_ID_\" column=\"id\" /&gt; &lt;!-- use the result from the base query and replace the placeholder _ID_ of all following sql querys with the value of id in that current iteration --&gt;\n\n    &lt;lists&gt;\n        &lt;myList mapped=\"MySecondClass\" sql=\"select col1, col2 from table2 where referenceId=_ID_\" /&gt; &lt;!-- each element of that listed will be mapped on MySecondClass and fills the property \"myList\"\n    &lt;/lists&gt;\n\n&lt;/document&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":45,"score":0,"question_id":12909032,"title":"Retrieve specific record using Hibernate","body":"<p>I want to retrieve a specific record from Data Base using Hibernate. What I want to do is commented below in the function.</p>\n\n<pre><code>public List&lt;Customer&gt; showCustomer(long customerIdFromCustomerListPage)\n        throws Exception {\n\n    Session session = HibernateUtil.getSessionFactory().openSession();\n    Transaction transaction = null;\n    List&lt;Customer&gt; customerList = new ArrayList&lt;Customer&gt;();\n    try {\n        transaction = session.beginTransaction();\n\n        **//Select * from Customers where customerId=\"customerIdFromCustomerListPage\"**\n\n        transaction.commit();\n    } catch (HibernateException e) {\n        transaction.rollback();\n        e.printStackTrace();\n    } finally {\n        session.close();\n    }\n    return customerList;\n\n}\n</code></pre>\n"},{"tags":["hibernate","java-ee","maven-3","weblogic-10.x","jboss6.x"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1117,"score":1,"question_id":7333541,"title":"Problem deploying hibernate depended project into weblogic 10.3.5","body":"<p>I've been developing an application intending to deploy my war into jboss6. However, in the middle of the development, I had to deploy my application into weblogic(no experience before) 10.3.5(company policies!) Now, I am stuck. I have no success to gather the necessary libs for the weblogic. Here is the my pom fragment and the exception that I got from the web logic console.</p>\n\n<p>pom.xml</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-jpamodelgen&lt;/artifactId&gt;\n    &lt;version&gt;1.1.1.Final&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;\n    &lt;version&gt;4.1.0.Final&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;\n    &lt;version&gt;3.6.7.Final&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;\n    &lt;version&gt;1.5.11&lt;/version&gt;\n    &lt;type&gt;jar&lt;/type&gt;\n    &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;log4j&lt;/groupId&gt;\n    &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n    &lt;version&gt;1.2.12&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>exception</p>\n\n<pre><code>SLF4J: The requested version 1.5.11 by your slf4j binding is not compatible with [1.5.5, 1.5.6]\nSLF4J: See http://www.slf4j.org/codes.html#version_mismatch for further details.\nINFO  Version                         - Hibernate Commons Annotations 3.2.0.Final\nINFO  Environment                     - Hibernate 3.6.7.Final\nINFO  Environment                     - hibernate.properties not found\nINFO  Environment                     - Bytecode provider name : javassist\nINFO  Environment                     - using JDK 1.4 java.sql.Timestamp handling\nINFO  Version                         - Hibernate EntityManager 3.6.7.Final\nINFO  Ejb3Configuration               - Processing PersistenceUnitInfo [name: ...]\n&lt;Sep 7, 2011 2:14:58 PM EEST&gt; &lt;Error&gt; &lt;Deployer&gt; &lt;BEA-149265&gt; &lt;Failure occurred in the execution of deployment request with ID '1315394097821' for task '13'. Error is: 'java.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;'\njava.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:629)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:393)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:386)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.&lt;init&gt;(BasePersistenceUnitInfoImpl.java:158)\n        Truncated. see log file for complete stacktrace\nCaused By: java.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:629)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:393)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:386)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.&lt;init&gt;(BasePersistenceUnitInfoImpl.java:158)\n        Truncated. see log file for complete stacktrace\n&gt;\n&lt;Sep 7, 2011 2:14:58 PM EEST&gt; &lt;Warning&gt; &lt;Deployer&gt; &lt;BEA-149004&gt; &lt;Failures were detected while initiating deploy task for application 'beyazfatura'.&gt;\n&lt;Sep 7, 2011 2:14:58 PM EEST&gt; &lt;Warning&gt; &lt;Deployer&gt; &lt;BEA-149078&gt; &lt;Stack trace for message 149004\njava.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:629)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:393)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:386)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.&lt;init&gt;(BasePersistenceUnitInfoImpl.java:158)\n        Truncated. see log file for complete stacktrace\nCaused By: java.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:629)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:393)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:386)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.&lt;init&gt;(BasePersistenceUnitInfoImpl.java:158)\n        Truncated. see log file for complete stacktrace\n&gt;\n&lt;Sep 7, 2011 2:15:13 PM EEST&gt; &lt;Error&gt; &lt;Console&gt; &lt;BEA-240003&gt; &lt;Console encountered the following error weblogic.application.WrappedDeploymentException: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:629)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:393)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.initializeEntityManagerFactory(BasePersistenceUnitInfoImpl.java:386)\n        at weblogic.deployment.BasePersistenceUnitInfoImpl.&lt;init&gt;(BasePersistenceUnitInfoImpl.java:158)\n        at weblogic.deployment.PersistenceUnitInfoImpl.&lt;init&gt;(PersistenceUnitInfoImpl.java:39)\n        at weblogic.deployment.AbstractPersistenceUnitRegistry.storeDescriptors(AbstractPersistenceUnitRegistry.java:349)\n        at weblogic.deployment.AbstractPersistenceUnitRegistry.loadPersistenceDescriptors(AbstractPersistenceUnitRegistry.java:124)\n        at weblogic.deployment.ModulePersistenceUnitRegistry.&lt;init&gt;(ModulePersistenceUnitRegistry.java:58)\n        at weblogic.servlet.internal.WebAppModule.setupPersistenceUnitRegistry(WebAppModule.java:1790)\n        at weblogic.servlet.internal.WebAppServletContext.initClassLoader(WebAppServletContext.java:3028)\n        at weblogic.servlet.internal.WebAppServletContext.&lt;init&gt;(WebAppServletContext.java:447)\n        at weblogic.servlet.internal.WebAppServletContext.&lt;init&gt;(WebAppServletContext.java:493)\n        at weblogic.servlet.internal.HttpServer.loadWebApp(HttpServer.java:418)\n        at weblogic.servlet.internal.WebAppModule.registerWebApp(WebAppModule.java:972)\n        at weblogic.servlet.internal.WebAppModule.prepare(WebAppModule.java:382)\n        at weblogic.application.internal.flow.ScopedModuleDriver.prepare(ScopedModuleDriver.java:176)\n        at weblogic.application.internal.flow.ModuleListenerInvoker.prepare(ModuleListenerInvoker.java:199)\n        at weblogic.application.internal.flow.DeploymentCallbackFlow$1.next(DeploymentCallbackFlow.java:517)\n        at weblogic.application.utils.StateMachineDriver.nextState(StateMachineDriver.java:52)\n        at weblogic.application.internal.flow.DeploymentCallbackFlow.prepare(DeploymentCallbackFlow.java:159)\n        at weblogic.application.internal.flow.DeploymentCallbackFlow.prepare(DeploymentCallbackFlow.java:45)\n        at weblogic.application.internal.BaseDeployment$1.next(BaseDeployment.java:613)\n        at weblogic.application.utils.StateMachineDriver.nextState(StateMachineDriver.java:52)\n        at weblogic.application.internal.BaseDeployment.prepare(BaseDeployment.java:184)\n        at weblogic.application.internal.SingleModuleDeployment.prepare(SingleModuleDeployment.java:43)\n        at weblogic.application.internal.DeploymentStateChecker.prepare(DeploymentStateChecker.java:154)\n        at weblogic.deploy.internal.targetserver.AppContainerInvoker.prepare(AppContainerInvoker.java:60)\n        at weblogic.deploy.internal.targetserver.operations.ActivateOperation.createAndPrepareContainer(ActivateOperation.java:207)\n        at weblogic.deploy.internal.targetserver.operations.ActivateOperation.doPrepare(ActivateOperation.java:98)\n        at weblogic.deploy.internal.targetserver.operations.AbstractOperation.prepare(AbstractOperation.java:217)\n        at weblogic.deploy.internal.targetserver.DeploymentManager.handleDeploymentPrepare(DeploymentManager.java:747)\n        at weblogic.deploy.internal.targetserver.DeploymentManager.prepareDeploymentList(DeploymentManager.java:1216)\n        at weblogic.deploy.internal.targetserver.DeploymentManager.handlePrepare(DeploymentManager.java:250)\n        at weblogic.deploy.internal.targetserver.DeploymentServiceDispatcher.prepare(DeploymentServiceDispatcher.java:159)\n        at weblogic.deploy.service.internal.targetserver.DeploymentReceiverCallbackDeliverer.doPrepareCallback(DeploymentReceiverCallbackDeliverer.java:171)\n        at weblogic.deploy.service.internal.targetserver.DeploymentReceiverCallbackDeliverer.access$000(DeploymentReceiverCallbackDeliverer.java:13)\n        at weblogic.deploy.service.internal.targetserver.DeploymentReceiverCallbackDeliverer$1.run(DeploymentReceiverCallbackDeliverer.java:46)\n        at weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:528)\n        at weblogic.work.ExecuteThread.execute(ExecuteThread.java:209)\n        at weblogic.work.ExecuteThread.run(ExecuteThread.java:178)\n&gt;\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","hibernate","caching"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12908634,"title":"How to cache complex java objects at application level","body":"<p>I am looking for a solution to cache complex objects in java at application level.</p>\n\n<p>For example, i want to load some data set from database to memory and make my application services to work on top of the objects loaded into memory. I considered this in order to improve performance.</p>\n\n<p>But I am wondering how to keep the relationships of an object in a cache. </p>\n\n<p>That is for example,</p>\n\n<p>If a category has many items, what is the best approach to store the relationship. \nMy idea is to store category and items separately and store the relationship in some other place. This is because I use hibernate and the associations are configured to lazy loading. </p>\n\n<p>Please share your thoughts to approach this problem.</p>\n"},{"tags":["java","hibernate","jboss7.x","interceptor","integrator"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12908937,"title":"Hibernate interceptor transaction is null","body":"<p>I am using a interceptor to index a(or multiple) entity for a transaction. I would like to perform the indexing action to be performed only once for a successful transaction. I was trying for <code>afterTransactionCompletion(Transaction tx)</code> but it is never called, <code>beforeTransactionCompletion(Transaction tx)</code> is getting called but the parameter tx is null in all cases. I am using CMT. jboss 7. How can I get the tx for beforeTransactionCompletion.</p>\n"},{"tags":["hibernate","spring-mvc","spring-annotations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":93,"score":-3,"question_id":12908539,"title":"Form handling in spring mvc and hibernate annotation","body":"<p>I am new to spring mvc, i developed simple spring mvc annotation application </p>\n\n<pre><code>&lt;form:form action=\"formoutput.htm\" commandName=\"user\" &gt; &lt;table align=\"center\" &gt; &lt;tr&gt; &lt;td&gt;User Name :&lt;/td&gt; &lt;td&gt;&lt;form:input path=\"userName\" /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Email :&lt;/td&gt; &lt;td&gt;&lt;form:input path=\"email\" /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;input type=\"submit\" value=\"Submit\" /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/form:form&gt;\n</code></pre>\n\n<p>My question is when i use above form tag i got an following error </p>\n\n<pre><code>Oct 16, 2012 11:26:02 AM org.apache.jasper.compiler.TldLocationsCache tldScanJar INFO:\n</code></pre>\n\n<p>At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.**</p>\n\n<p>Oct 16, 2012 11:26:02 AM org.springframework.web.servlet.tags.RequestContextAwareTag doStartTag SEVERE: Neither BindingResult nor plain target object for bean name 'user' available as request attribute \n<code>java.lang.IllegalStateException:</code> Neither BindingResult nor plain target object for bean name 'user' available as request attribute</p>\n\n<pre><code> `at org.springframework.web.servlet.support.BindStatus.&lt;init&gt;(BindStatus.java:141) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:174) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:194) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getName(AbstractDataBoundFormElementTag.java:160) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.autogenerateId(AbstractDataBoundFormElementTag.java:147) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.resolveId(AbstractDataBoundFormElementTag.java:138) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.writeDefaultAttributes(AbstractDataBoundFormElementTag.java:122) at org.springframework.web.servlet.tags.form.AbstractHtmlElementTag.writeDefaultAttributes(AbstractHtmlElementTag.java:409) at org.springframework.web.servlet.tags.form.InputTag.writeTagContent(InputTag.java:140) at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:102) at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:79) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspx_meth_form_005finpstrong textut_005f0(example_jsp.java:166) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspx_meth_form_005fform_005f0(example_jsp.java:124) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspService(example_jsp.java:82) at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432) at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390) at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:690) at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:477) at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402) at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329) at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238) at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250) at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1060) at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:798) at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716) at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644) at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549) at javax.servlet.http.HttpServlet.service(HttpServlet.java:621) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98) at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001) at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Oct 16, 2012 11:26:02 AM org.apache.catalina.core.ApplicationDispatcher invoke SEVERE: Servlet.service() for servlet jsp threw exception java.lang.IllegalStateException: Neither BindingResult nor plain target object for bean name 'user' available as request attribute at org.springframework.web.servlet.support.BindStatus.&lt;init&gt;(BindStatus.java:141) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:174) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:194) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getName(AbstractDataBoundFormElementTag.java:160) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.autogenerateId(AbstractDataBoundFormElementTag.java:147) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.resolveId(AbstractDataBoundFormElementTag.java:138) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.writeDefaultAttributes(AbstractDataBoundFormElementTag.java:122) at org.springframework.web.servlet.tags.form.AbstractHtmlElementTag.writeDefaultAttributes(AbstractHtmlElementTag.java:409) at org.springframework.web.servlet.tags.form.InputTag.writeTagContent(InputTag.java:140) at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:102) at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:79) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspx_meth_form_005finput_005f0(example_jsp.java:166) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspx_meth_form_005fform_005f0(example_jsp.java:124) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspService(example_jsp.java:82) at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432) at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390) at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:690) at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:477) at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402) at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329) at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238) at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250) at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1060) at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:798) at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716) at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644) at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549) at javax.servlet.http.HttpServlet.service(HttpServlet.java:621) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98) at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001) at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Oct 16, 2012 11:26:02 AM org.apache.catalina.core.StandardWrapperValve invoke SEVERE: Servlet.service() for servlet [dispatcher] in context with path [/Student04] threw exception [An exception occurred processing JSP page /WEB-INF/jsp/example.jsp at line 18 15: &lt;table align=\"center\" &gt; 16: &lt;tr&gt; 17: &lt;td&gt;SectionName:&lt;/td&gt; 18: &lt;td&gt;&lt;form:input path=\"userName\" /&gt;&lt;/td&gt; 19: &lt;/tr&gt; 20: 21: &lt;tr&gt; Stacktrace:] with root cause java.lang.IllegalStateException: Neither BindingResult nor plain target object for bean name 'user' available as request attribute at org.springframework.web.servlet.support.BindStatus.&lt;init&gt;(BindStatus.java:141) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:174) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:194) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getName(AbstractDataBoundFormElementTag.java:160) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.autogenerateId(AbstractDataBoundFormElementTag.java:147) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.resolveId(AbstractDataBoundFormElementTag.java:138) at org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.writeDefaultAttributes(AbstractDataBoundFormElementTag.java:122) at org.springframework.web.servlet.tags.form.AbstractHtmlElementTag.writeDefaultAttributes(AbstractHtmlElementTag.java:409) at org.springframework.web.servlet.tags.form.InputTag.writeTagContent(InputTag.java:140) at org.springframework.web.servlet.tags.form.AbstractFormTag.doStartTagInternal(AbstractFormTag.java:102) at org.springframework.web.servlet.tags.RequestContextAwareTag.doStartTag(RequestContextAwareTag.java:79) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspx_meth_form_005finput_005f0(example_jsp.java:166) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspx_meth_form_005fform_005f0(example_jsp.java:124) at org.apache.jsp.WEB_002dINF.jsp.example_jsp._jspService(example_jsp.java:82) at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432) at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390) at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:690) at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:477) at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402) at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329) at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238) at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250) at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1060) at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:798) at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716) at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644) at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549) at javax.servlet.http.HttpServlet.service(HttpServlet.java:621) at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98) at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001) at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585) at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source) Mycontroller ----------------`enter code here` package com.kqics.student.controller; import java.util.HashMap; import java.util.Map; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Controller; import org.springframework.ui.Model; import org.springframework.validation.BindingResult; import org.springframework.web.bind.annotation.ModelAttribute; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RequestMethod; import org.springframework.web.servlet.ModelAndView; import com.kqics.student.model.StudentSection; import com.kqics.student.model.User; import com.kqics.student.service.StudentService; @Controller public class StudentController { @Autowired private StudentService userService; @RequestMapping(value=\"student_main.htm\") public ModelAndView disp() { ModelAndView mav1=new ModelAndView(\"example\"); return mav1; } @RequestMapping(value = \"save.htm\", method = RequestMethod.POST) public ModelAndView addUser ( @ModelAttribute User user,Model model) { userService.addEvent(user); return new ModelAndView ( \"example\" ); } } Myservice -------------`enter code here` package com.kqics.student.service; import java.sql.ResultSet; import java.sql.SQLException; import java.util.List; import javassist.bytecode.Descriptor.Iterator; import org.hibernate.Session; import org.hibernate.SessionFactory; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.orm.hibernate3.HibernateTemplate; import com.kqics.student.model.StudentReports; import com.kqics.student.model.StudentSection; import com.kqics.student.model.User; import com.mysql.jdbc.CallableStatement; import com.mysql.jdbc.Connection; import com.sun.org.apache.bcel.internal.generic.GETSTATIC; public class StudentServiceImpl implements StudentService { private HibernateTemplate hibernateTemplate; @Autowired public void setSessionFactory(SessionFactory sessionFactory) { hibernateTemplate = new HibernateTemplate(sessionFactory); } @Override public void addEvent(User event) { hibernateTemplate.save(event); } } \n</code></pre>\n\n<p>Mymodal :-\nenter code here</p>\n\n<pre><code> package com.kqics.student.model; public class User { private String userName; private String email; public void setUserName(String userName){ this.userName=userName; } public String getUserName(){ return userName; } public void setEmail(String email){ this.email=email; } public String getEmail(){ return email; } }`\n</code></pre>\n\n<p>Any one have idea please help me !</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12908657,"title":"How to create database using hibernate and from where I can get proper example with all configurations and usage?","body":"<p>I want to create database using hibernate but I am not getting proper example for this. any suggestion? I am new to hibernate.</p>\n"},{"tags":["eclipse","hibernate","jpa"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1314,"score":0,"question_id":5258284,"title":"Where to put the User Library for Eclipse-Dali-Hibernate integration?","body":"<p>I am struggling with the configuration of the Eclipse Dali plugin and Hibernate. The version I'm using is <a href=\"http://www.jboss.org/tools/download/installation/update_3_2.html\" rel=\"nofollow\">as recommended</a>:</p>\n\n<ul>\n<li>Eclipse 3.6.1 (Helios SR1) IDE for Java EE Developers (including Dali 2.3)</li>\n<li>JBoss Tools 3.2 (for the Hibernate Tools plugin)</li>\n</ul>\n\n<p>When configuring the Java Persistence properties for my project, I created a user library named \"Hibernate JPA\" and included the following JARs:</p>\n\n<ul>\n<li>hibernate-distribution-3.6.1.Final\\hibernate3.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\jpa\\hibernate-jpa-2.0-api-1.0.0.Final.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\required\\dom4j-1.6.1.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\required\\slf4j-api-1.6.1.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\required\\javassist-3.12.0.GA.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\required\\commons-collections-3.1.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\required\\antlr-2.7.6.jar</li>\n<li>hibernate-distribution-3.6.1.Final\\lib\\required\\jta-1.1.jar</li>\n</ul>\n\n<p>As long as the <em>hibernate-distribution-3.6.1.Final</em> folder is outside of my project directory, everything works fine. However, if I put the Hibernate folder into the project directory, I get an error saying \"Required class org.hibernate.SessionFactory does not exist in selected libraries\":</p>\n\n<p><img src=\"http://i.stack.imgur.com/QVwZA.png\" alt=\"enter image description here\"></p>\n\n<p>The error text is wrong, the required class is definitely included in <em>hibernate3.jar</em>, and everything works as expected when I move the JARs outside of my project directory.</p>\n\n<p>I have two questions about that:</p>\n\n<ol>\n<li>I do not understand why the User Library behaves differently depending on whether the JARs are placed inside or outside of my project directory. Could anybody explain what's happening here?</li>\n<li>I would like to have my project in SVN, including all the required libraries. Is there any way to configure Dali to accept User Libraries within the project directory?</li>\n</ol>\n\n<p>Thank you very much.</p>\n"},{"tags":["android","spring","hibernate","struts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12907910,"title":"Can we make Communication between android UI and spring,struts,Hibernate integration application?","body":"<p>I am new to android application development.</p>\n\n<p>I developed one login application. In this application I designed UI screen using <code>android sdk</code>, I enter the username,password and send those values to servlet using <code>HttpClient</code>,<code>HttpPost</code> classes for authentication. After completing the authentication I print authentication message on android UI screen.</p>\n\n<p>But now my requirement is ,I wants to use Spring,Hibernate and Struts integration instead of Servlets and jdbc code, Is it possible to use?</p>\n\n<p>please help...</p>\n"},{"tags":["java","hibernate","jpa","lazy-loading","relationships"],"answer_count":4,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":3229,"score":10,"question_id":7733717,"title":"JPA/Hibernate: @ManyToOne and @OneToOne relationships tagged as FetchType.LAZY and optional = false not loading lazily on em.find()?","body":"<p>I have the following entity (only relevant mappings shown):</p>\n\n<pre><code>@Entity\n@Table(name = \"PQs\")\npublic class PQ implements Serializable\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column\n    private Integer id;\n\n    @Column\n    private String name;\n\n    @ManyToOne(fetch = FetchType.LAZY)                 // lazy XToOne\n    @JoinColumn(name = \"user_id\", referencedColumnName = \"person_id\")\n    private User user;\n\n    @OneToOne(mappedBy = \"pq\", fetch = FetchType.LAZY) // lazy XToOne\n    private Group group;\n\n    @OneToOne(mappedBy = \"pq\", fetch = FetchType.LAZY) // lazy XToOne\n    private Tendering tendering;\n\n    ...\n}\n</code></pre>\n\n<p>Note the comments above: there are three <code>@XToOne</code> relationships to other entities:</p>\n\n<p><strong>User</strong> (a SecurityIdentity sub class with a simple ID as PK, referenced by PQ representing the owner):</p>\n\n<pre><code>@Entity\n@Table(name = \"Users\")\n@DiscriminatorValue(value = \"user\")\npublic class User extends SecurityIdentity\n{\n    @Column\n    private String name;\n\n    @OneToMany(mappedBy = \"user\")\n    private Set&lt;PQ&gt; pqs = new HashSet&lt;PQ&gt;();\n\n    ...\n}\n</code></pre>\n\n<p><strong>Group</strong> (also a SecurityIdentity sub class with a simple ID as PK, references the PQ to represent a set of users that can interact with that PQ):</p>\n\n<pre><code>@Entity\n@Table(name = \"Groups\")\n@DiscriminatorValue(value = \"group\")\npublic class Group extends SecurityIdentity\n{\n    @OneToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"pq_id\", referencedColumnName = \"id\")\n    private PQ pq;\n\n    ...\n}\n</code></pre>\n\n<p><strong>Tendering</strong>:</p>\n\n<pre><code>@Entity\n@Table(name = \"Tenderings\")\npublic class Tendering implements Serializable\n{\n    @Id\n    @Column(name = \"pq_id\", insertable = false, updatable = false)\n    private Integer pqId;\n\n    @Column(name = \"external_code\")\n    private String externalCode;\n\n    @OneToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"pq_id\", referencedColumnName = \"id\")\n    private PQ pq;\n\n    ...\n}\n</code></pre>\n\n<p>Don't be confused about groups and users sharing IDs, just treat them as simple IDs. A tendering is just a separate document object (one-to-one).</p>\n\n<p>As you can see there are three <code>@XToOne</code> relationships on the PQ entity, which, if no fetch type was set, would be loaded eagerly (JPA default). So to prevent this I tagged all <code>@XToOne</code> relationships as <code>FetchType.LAZY</code>.</p>\n\n<p>Now when using</p>\n\n<p><code>em.find(PQ.class, someExistingId);</code></p>\n\n<p>I get the Hibernate output:</p>\n\n<pre><code>23:53:55,815 INFO  [stdout] Hibernate: select pq0_.id as id291_0_, pq0_.description as descript2_291_0_, pq0_.name as name291_0_, pq0_.submission_date as submission4_291_0_, pq0_.user_id as user5_291_0_ from PQs pq0_ where pq0_.id=?\n23:53:55,818 INFO  [stdout] Hibernate: select user0_.id as id280_0_, user0_1_.identity_type_id as identity2_280_0_, user0_.is_enabled as is1_297_0_, user0_.name as name297_0_, user0_.password as password297_0_, user0_.person_id as person5_297_0_ from Users user0_ inner join SecurityIdentities user0_1_ on user0_.id=user0_1_.id where user0_.person_id=?\n23:53:55,821 INFO  [stdout] Hibernate: select group0_.id as id280_0_, group0_1_.identity_type_id as identity2_280_0_, group0_.pq_id as pq2_281_0_ from Groups group0_ inner join SecurityIdentities group0_1_ on group0_.id=group0_1_.id where group0_.pq_id=?\n23:53:55,823 INFO  [stdout] Hibernate: select tendering0_.pq_id as pq1_296_0_, tendering0_.binary_file as binary2_296_0_, tendering0_.customer_id as customer6_296_0_, tendering0_.description as descript3_296_0_, tendering0_.external_code as external4_296_0_, tendering0_.title as title296_0_ from Tenderings tendering0_ where tendering0_.pq_id=?\n</code></pre>\n\n<p>The three extra SELECTs stem from the @XToOne relationships (as described in many places on the net). The source I was looking at mostly is this: </p>\n\n<p><a href=\"http://stackoverflow.com/questions/1444227/making-a-onetoone-relation-lazy\">Making a OneToOne-relation lazy</a></p>\n\n<p>As mentioned there, the <code>@ManyToOne</code> relationship <code>User user</code> shouldn't be fetched:</p>\n\n<blockquote>\n  <p><code>@ManyToOne(fetch=FetchType.LAZY)</code> should work just fine.</p>\n</blockquote>\n\n<p>... here the relationship from <strong>PQ</strong> to <strong>User</strong>, but it <strong>is</strong> fetched as you can see from the <code>select user0_.id as id280_0_, ...</code> statement...</p>\n\n<p>For the other two <code>Group group</code> and <code>Tendering tendering</code>, both <code>@OneToOne</code> <strong>reverse</strong> mappings, the foreign keys reference the PQs table's PK (ID), resulting in the same mapping in the PQ entity.</p>\n\n<p>Note that all three relationships aren't optional: a PQ always has an owner (user), and a PQ is always referenced by a tendering and a group entity. I just hadn't modeled that in JPA above yet...</p>\n\n<p>So, when adding <code>optional = false</code> to the three relationships of the PQ entity:</p>\n\n<pre><code>@Entity\n@Table(name = \"PQs\")\npublic class PQ implements Serializable\n{\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column\n    private Integer id;\n\n    @Column\n    private String name;\n\n    @ManyToOne(fetch = FetchType.LAZY, optional = false)\n    @JoinColumn(name = \"user_id\", referencedColumnName = \"person_id\")\n    private User user;\n\n    @OneToOne(mappedBy = \"pq\", fetch = FetchType.LAZY, optional = false)\n    private Group group;\n\n    @OneToOne(mappedBy = \"pq\", fetch = FetchType.LAZY, optional = false)\n    private Tendering tendering;\n\n    ...\n}\n</code></pre>\n\n<p>... I get the following Hibernate output:</p>\n\n<pre><code>00:47:34,397 INFO  [stdout] Hibernate: select pq0_.id as id361_0_, pq0_.description as descript2_361_0_, pq0_.name as name361_0_, pq0_.submission_date as submission4_361_0_, pq0_.user_id as user5_361_0_ from PQs pq0_ where pq0_.id=?\n00:47:34,410 INFO  [stdout] Hibernate: select user0_.id as id350_0_, user0_1_.identity_type_id as identity2_350_0_, user0_.is_enabled as is1_367_0_, user0_.name as name367_0_, user0_.password as password367_0_, user0_.person_id as person5_367_0_ from Users user0_ inner join SecurityIdentities user0_1_ on user0_.id=user0_1_.id where user0_.person_id=?\n00:47:34,413 INFO  [stdout] Hibernate: select group0_.id as id350_0_, group0_1_.identity_type_id as identity2_350_0_, group0_.pq_id as pq2_351_0_ from Groups group0_ inner join SecurityIdentities group0_1_ on group0_.id=group0_1_.id where group0_.pq_id=?\n</code></pre>\n\n<p>Note, that I've only been playing with the <code>optional = false</code> on the PQ entity, as this is the one I use in <code>em.find(...)</code>. (If this is not sufficient, please enlighten me.)</p>\n\n<p>My question now is two-fold:</p>\n\n<ol>\n<li>Why is the <code>@ManyToOne</code> to the <code>User</code> entity fetched eagerly (given that is was said to be working lazily, see <a href=\"http://stackoverflow.com/questions/1444227/making-a-onetoone-relation-lazy\">Making a OneToOne-relation lazy</a>)?</li>\n<li>Why is only the <code>OneToOne</code> relationship to the <code>Tendering</code> entity left off being fetched? Is it because the <code>Tendering</code> entity references the PQ's PK column as a PK itself (<code>@Id</code> in <code>Tendering</code>), which the <code>Group</code> entity doesn't (regular relationship to the PQ's PK)?</li>\n</ol>\n\n<p>What's wrong? How do I make these non-optional relationships lazy? (without code-instrumentation or other hacks, just plain annotations...)</p>\n\n<p>I know the LAZY thing is just a hint for the JPA provider to do something about lazy loading or not, but in this case it seems as if something else is wrong (as part of it is working).</p>\n\n<p>PS: I'm using Hibernate 4.0 BETA, the version that comes with JBoss 7.0.0.Final along with JPA annotations only (the above are all JPA 1.0 compatible).</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":140,"score":1,"question_id":12905781,"title":"How to use two databases/datasources in Spring and Hibernate","body":"<p>I need to use two databases in my standalone application, one local HSQLDB and another remote MySQL. I use Spring 3.1.2, Hibernate 4.1.7. So far I managed to use only HSQLDB, this is how my DAO and configurations look like:</p>\n\n<pre><code>@Transactional\npublic abstract class HibernateDao&lt;T, ID extends Serializable&gt; implements Dao&lt;T, ID&gt;{\n\nSessionFactory sessionFactoryHSQL;\n\n\npublic void setSessionFactoryHSQL(SessionFactory sessionFactory) {\n    this.sessionFactoryHSQL = sessionFactory;\n}\n\npublic ID save(T object) {\n    return (ID) getCurrentSession().save(object);\n}\n\npublic void persist(T object){\n    getCurrentSession().persist(object);\n}\n\npublic void update(T object) {\n    getCurrentSession().update(object);\n}\n\npublic void delete(T object) {\n    getCurrentSession().delete(object);\n}\n\npublic List&lt;T&gt; find(String query) {\n    return getCurrentSession().createQuery(query).list();\n}\n\npublic Session getCurrentSession(){\n    return sessionFactoryHSQL.getCurrentSession();\n}\n}\n\n\n&lt;bean id=\"sessionFactoryHSQL\" \nclass=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n\n    &lt;property name=\"dataSource\"&gt;\n      &lt;ref bean=\"dataSourceHSQL\"/&gt;\n    &lt;/property&gt;\n\n    &lt;property name=\"hibernateProperties\"&gt;\n       &lt;props&gt;\n         &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.HSQLDialect&lt;/prop&gt;\n         &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n         &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/prop&gt;\n       &lt;/props&gt;\n    &lt;/property&gt;\n\n    &lt;property name=\"annotatedClasses\"&gt;\n    &lt;list&gt;\n        //annotated classes\n    &lt;/list&gt;\n    &lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;bean id=\"txManager\" class=\n    \"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n   &lt;property name=\"sessionFactory\" ref=\"sessionFactoryHSQL\" /&gt;\n&lt;/bean&gt;\n&lt;tx:annotation-driven transaction-manager=\"txManagerHSQL\" /&gt;\n\n&lt;bean id=\"configHSQL\"\nclass=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n    &lt;property name=\"location\"&gt;\n        &lt;value&gt;properties/HSQL.properties&lt;/value&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"dataSourceHSQL\" \n         class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${jdbc.driverClassName}\" /&gt;\n    &lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>I created separate beans for MySQL, such as sessionFactoryMySQL, dataSourceMySQL (I'm not going to paste their implementations as they are nearly the same as for HSQL). I managed to correctly inject sessionFactoryMySQL to DAO, but I can't use both sessionFactorys at the same time, for example I can't do following:</p>\n\n<pre><code>public void persist(T object) {\n    sessionFactoryHSQL.getCurrentSession().persist(object);\n    sessionFactoryMySQL.getCurrentSession().persist(object);\n}\n</code></pre>\n\n<p>As I already discovered, it has something to do with transactions, but I can't properly configure transaction manager. I have been searching for solution for a long time but examples or tutorias was either not clear or did not refer to exaclty my case.</p>\n"},{"tags":["hibernate","java-ee","jpa","foreign-keys"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":71,"score":0,"question_id":11843408,"title":"Specifying a foreign key in JPA","body":"<p>I currently have a table which looks like this:</p>\n\n<p>Users</p>\n\n<p>username\naddress\ndob\n...</p>\n\n<p>And</p>\n\n<p>Roles\nusername\nrole</p>\n\n<p>I want to make a foreign key constraint between Role.username and User.username. How should I go about doing this with ann</p>\n"},{"tags":["java","hibernate","timestamp"],"answer_count":9,"favorite_count":27,"up_vote_count":40,"down_vote_count":0,"view_count":47854,"score":40,"question_id":221611,"title":"Creation timestamp and last update timestamp with Hibernate and MySQL","body":"<p>For a certain Hibernate entity we have a requirement to store its creation time and the last time it was updated.  How would you design this?</p>\n\n<ul>\n<li><p>What data types would you use in the database (assuming MySQL, possibly in a different timezone that the JVM)?  Will the data types be timezone-aware?</p></li>\n<li><p>What data types would you use in Java (<code>Date</code>, <code>Calendar</code>, <code>long</code>, ...)?</p></li>\n<li><p>Whom would you make responsible for setting the timestamps&mdash;the database, the ORM framework (Hibernate), or the application programmer?</p></li>\n<li><p>What annotations would you use for the mapping (e.g. <code>@Temporal</code>)?</p></li>\n</ul>\n\n<p>I'm not only looking for a working solution, but for a safe and well-designed solution.</p>\n"},{"tags":["java","hibernate","lucene","hibernate-search","hashtag"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":128,"score":2,"question_id":12723683,"title":"Using a common query convention for multiple search fields","body":"<p>Imagine that I am building a hashtag search. My main indexed type is called Post, which has a list of Hashtag items, which are marked as IndexedEmbedded. Separately, every post has a list of Comment objects, each of which, again, contains a list of Hashtag objects.</p>\n\n<p>On the search side, I am using a MultiFieldQueryParser, to which I pass a long list of possible search fields, including some nested fields like:</p>\n\n<p><code>hashTags.value</code> and \n<code>coments.hashTags.value</code> </p>\n\n<p>Now, the interesting thing happens when I want to search for something, say #architecture. I figure out where the hashtags are, so the simplest logical thing to do would be to convert a query of the type #architecture, into one of the type <code>hashTags.value:architecture or comments.hashTags.value:architecture</code> Although possible, this is very inflexible. What if I come up with yet another field that contains hashtags? I'd have to include that too.</p>\n\n<p>Is there a general way to do this?</p>\n\n<p>P.S. Please have in mind that the root type I am searching for is Post, because this is the kind of results I'd like to achieve</p>\n"},{"tags":["eclipse","hibernate","spring"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":13537,"score":0,"question_id":7026924,"title":"org.springframework.beans.factory.BeanCreationException: Error creating bean with name","body":"<p>Good Afternoon!</p>\n\n<p>I'm having the following error and I though perhaps someone could help me?? :/</p>\n\n<pre><code>11/Ago/2011 14:04:48 org.apache.catalina.core.AprLifecycleListener init\nINFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\\Program Files\\Java\\jre6\\bin;.;C:\\Windows\\Sun\\Java\\bin;C:\\Windows\\system32;C:\\Windows;C:/Program Files (x86)/Java/jre6/bin/client;C:/Program Files (x86)/Java/jre6/bin;C:/Program Files (x86)/Java/jre6/lib/i386;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Sun\\SDK\\bin;C:\\Program Files (x86)\\eclipse;\n11/Ago/2011 14:04:48 org.apache.coyote.http11.Http11Protocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8080\n11/Ago/2011 14:04:48 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 625 ms\n11/Ago/2011 14:04:48 org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\n11/Ago/2011 14:04:48 org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.32\n11/Ago/2011 14:04:48 org.apache.catalina.startup.HostConfig deployDescriptor\nINFO: Deploying configuration descriptor ServerTest.xml\n11/Ago/2011 14:04:49 org.apache.catalina.core.ApplicationContext log\nINFO: Initializing Spring root WebApplicationContext\n11/Ago/2011 14:04:49 org.springframework.web.context.ContextLoader initWebApplicationContext\nINFO: Root WebApplicationContext: initialization started\n11/Ago/2011 14:04:49 org.springframework.context.support.AbstractApplicationContext prepareRefresh\nINFO: Refreshing org.springframework.web.context.support.XmlWebApplicationContext@6293df2c: display name [Root WebApplicationContext]; startup date [Thu Aug 11 14:04:49 BST 2011]; root of context hierarchy\n11/Ago/2011 14:04:49 org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions\nINFO: Loading XML bean definitions from ServletContext resource [/WEB-INF/applicationContext.xml]\n11/Ago/2011 14:04:49 org.springframework.context.support.AbstractApplicationContext obtainFreshBeanFactory\nINFO: Bean factory for application context [org.springframework.web.context.support.XmlWebApplicationContext@6293df2c]: org.springframework.beans.factory.support.DefaultListableBeanFactory@7df1bd98\n11/Ago/2011 14:04:49 org.springframework.core.io.support.PropertiesLoaderSupport loadProperties\nINFO: Loading properties file from class path resource [jdbc.properties]\n11/Ago/2011 14:04:49 org.springframework.beans.factory.support.DefaultListableBeanFactory preInstantiateSingletons\nINFO: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@7df1bd98: defining beans [productManager,productDao,dataSource,propertyConfigurer,transactionManager,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.aop.support.DefaultBeanFactoryPointcutAdvisor#0,txAdvice]; root of factory hierarchy\n11/Ago/2011 14:04:49 org.springframework.beans.factory.support.DefaultSingletonBeanRegistry destroySingletons\nINFO: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@7df1bd98: defining beans [productManager,productDao,dataSource,propertyConfigurer,transactionManager,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.aop.support.DefaultBeanFactoryPointcutAdvisor#0,txAdvice]; root of factory hierarchy\n11/Ago/2011 14:04:49 org.springframework.web.context.ContextLoader initWebApplicationContext\nSEVERE: Context initialization failed\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'productManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'productDao' while setting bean property 'productDao'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'productDao' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'dataSource' while setting bean property 'dataSource'; nested exception is org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\nRelated cause: org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\nRelated cause: org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:274)\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:104)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1274)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1042)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:539)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:485)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:251)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:169)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:248)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:170)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:413)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:735)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:369)\n    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:251)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:190)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:45)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4205)\n    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4704)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)\n    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:675)\n    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:601)\n    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:502)\n    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1315)\n    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1061)\n    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)\n    at org.apache.catalina.core.StandardService.start(StandardService.java:525)\n    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)\n    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'productDao' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Cannot resolve reference to bean 'dataSource' while setting bean property 'dataSource'; nested exception is org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\nRelated cause: org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:274)\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:104)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1274)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1042)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:539)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:485)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:251)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:169)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:248)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:170)\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:268)\n    ... 41 more\nCaused by: org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\n    at org.springframework.beans.factory.support.AbstractBeanFactory.resolveBeanClass(AbstractBeanFactory.java:1160)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.resolveBeanClass(AbstractBeanFactory.java:1133)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:462)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:251)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:169)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:248)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:170)\n    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:268)\n    ... 53 more\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\n    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)\n    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)\n    at org.springframework.util.ClassUtils.forName(ClassUtils.java:230)\n    at org.springframework.beans.factory.support.AbstractBeanDefinition.resolveBeanClass(AbstractBeanDefinition.java:371)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.resolveBeanClass(AbstractBeanFactory.java:1157)\n    ... 62 more\nRelated cause:\norg.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.commons.dbcp.BasicDataSource] for bean with name 'dataSource' defined in ServletContext resource [/WEB-INF/applicationContext.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\n    at org.springframework.beans.factory.support.AbstractBeanFactory.resolveBeanClass(AbstractBeanFactory.java:1160)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.predictBeanType(AbstractAutowireCapableBeanFactory.java:581)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanNamesForType(DefaultListableBeanFactory.java:206)\n    at org.springframework.beans.factory.BeanFactoryUtils.beanNamesForTypeIncludingAncestors(BeanFactoryUtils.java:187)\n    at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:73)\n    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:98)\n    at org.springframework.aop.aspectj.autoproxy.AspectJAwareAdvisorAutoProxyCreator.shouldSkip(AspectJAwareAdvisorAutoProxyCreator.java:105)\n    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessBeforeInstantiation(AbstractAutoProxyCreator.java:244)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:828)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.resolveBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:799)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:475)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:251)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:169)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:248)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:170)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:413)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:735)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:369)\n    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:251)\n    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:190)\n    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:45)\n    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4205)\n    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4704)\n    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)\n    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)\n    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)\n    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:675)\n    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:601)\n    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:502)\n    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1315)\n    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1061)\n    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)\n    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)\n    at org.apache.catalina.core.StandardService.start(StandardService.java:525)\n    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)\n    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: java.lang.ClassNotFoundException: org.apache.commons.dbcp.BasicDataSource\n    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)\n    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)\n    at org.springframework.util.ClassUtils.forName(ClassUtils.java:230)\n    at org.springframework.beans.factory.support.AbstractBeanDefinition.resolveBeanClass(AbstractBeanDefinition.java:371)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.resolveBeanClass(AbstractBeanFactory.java:1157)\n    ... 46 more\n\n(etc...)\n\n11/Ago/2011 14:04:49 org.apache.catalina.core.StandardContext start\nSEVERE: Error listenerStart\n11/Ago/2011 14:04:49 org.apache.catalina.core.StandardContext start\nSEVERE: Context [/ServerTest] startup failed due to previous errors\n11/Ago/2011 14:04:49 org.apache.catalina.core.ApplicationContext log\nINFO: Closing Spring root WebApplicationContext\n11/Ago/2011 14:04:49 org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc\nSEVERE: The web application [/ServerTest] registered the JDBC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered.\n11/Ago/2011 14:04:49 org.apache.coyote.http11.Http11Protocol start\nINFO: Starting Coyote HTTP/1.1 on http-8080\n11/Ago/2011 14:04:49 org.apache.jk.common.ChannelSocket init\nINFO: JK: ajp13 listening on /0.0.0.0:8009\n11/Ago/2011 14:04:49 org.apache.jk.server.JkMain start\nINFO: Jk running ID=0 time=0/16  config=null\n11/Ago/2011 14:04:49 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 1592 ms\n</code></pre>\n\n<hr>\n\n<p>My applicationContext.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:aop=\"http://www.springframework.org/schema/aop\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd\n           http://www.springframework.org/schema/aop \n           http://www.springframework.org/schema/aop/spring-aop-2.0.xsd\n           http://www.springframework.org/schema/tx \n           http://www.springframework.org/schema/tx/spring-tx-2.0.xsd\"&gt;\n\n    &lt;bean id=\"productManager\" class=\"ServerTest.service.SimpleProductManager\"&gt;\n        &lt;property name=\"productDao\" ref=\"productDao\"/&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"productDao\" class=\"ServerTest.repository.JdbcProductDao\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;/bean&gt;\n\n\n    &lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\"\n        destroy-method=\"close\"&gt;\n        &lt;property name=\"driverClassName\" value=\"${jdbc.driverClassName}\" /&gt;\n        &lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n        &lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n        &lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"propertyConfigurer\"\n        class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n        &lt;property name=\"locations\"&gt;\n            &lt;list&gt;\n                &lt;value&gt;classpath:jdbc.properties&lt;/value&gt;\n            &lt;/list&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\"\n        class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;aop:config&gt;\n        &lt;aop:advisor pointcut=\"execution(* *..ProductManager.*(..))\"\n            advice-ref=\"txAdvice\" /&gt;\n    &lt;/aop:config&gt;\n\n    &lt;tx:advice id=\"txAdvice\"&gt;\n        &lt;tx:attributes&gt;\n            &lt;tx:method name=\"save*\" /&gt;\n            &lt;tx:method name=\"*\" read-only=\"true\" /&gt;\n        &lt;/tx:attributes&gt;\n    &lt;/tx:advice&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<hr>\n\n<p>My SimpleProductManager.java</p>\n\n<pre><code>package ServerTest.service;\n\nimport java.util.List;\n\nimport ServerTest.domain.Product;\nimport ServerTest.repository.ProductDao;\nimport ServerTest.service.ProductManager;\n\npublic class SimpleProductManager implements ProductManager {\n    // private List&lt;Product&gt; products;\n    private ProductDao productDao;\n\n    public List&lt;Product&gt; getProducts() {\n        // return products;\n        return productDao.getProductList();\n    }\n\n    public void increasePrice(int percentage) {\n         List&lt;Product&gt; products = productDao.getProductList();\n        if (products != null) {\n            for (Product product : products) {\n                double newPrice = product.getPrice().doubleValue() * \n                                    (100 + percentage)/100;\n                product.setPrice(newPrice);\n                productDao.saveProduct(product);\n            }\n        }             \n    }\n\n    public void setProductDao(ProductDao productDao) {\n        this.productDao = productDao;\n    }\n\n//    public void setProducts(List&lt;Product&gt; products) {\n//        this.products = products;\n//    }\n}\n</code></pre>\n\n<p>I'have already done a lot of research in google and so on, but I can't just get a good answer to my problem, and I've seen a lot more people with the same problem or almost the same.</p>\n\n<p>I already have the necessary jars in the classpath and in the WEB-INF/lib folder (I mean, I do think so)</p>\n\n<ul>\n<li>antlr-2.7.6</li>\n<li>aspectjweaver</li>\n<li>commons-collections-3.1</li>\n<li>commons-dbcp-1.4</li>\n<li>commons-logging</li>\n<li>commons-pool</li>\n<li>dom4j-1.6.1</li>\n<li>ehcache-1.1</li>\n<li>hibernate3</li>\n<li>hibernate-jpa-2.0-api-1.0.1.Final</li>\n<li>hsqldb</li>\n<li>javassist-3.12.0.GA</li>\n<li>jstl</li>\n<li>jta-1.1</li>\n<li>mysql-connector-java-5.1.11-bin</li>\n<li>slf4j-api-1.6.1</li>\n<li>slf4j-simple-1.6.1</li>\n<li>spring</li>\n<li>spring-test</li>\n<li>spring-webmvc</li>\n<li>standard</li>\n<li>standard-1.0.2</li>\n</ul>\n\n<p>Oh and I'm doing the project with Eclipse. I don't know if it is relevant, but just in case..</p>\n\n<p><strong>Edited</strong></p>\n\n<pre><code>  And one more thing, this appens when I start or restart the server\n</code></pre>\n\n<p><strong>Edited</strong></p>\n\n<p>Thankyou anyway</p>\n\n<p>One</p>\n\n<p>** Solved! Seems it was library conflicts**</p>\n"},{"tags":["hibernate","hql","jpql"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12394038,"title":"HQL 'with' clause in JPQL","body":"<p>From Hibernate 3.6 documentation:</p>\n\n<blockquote>\n  <p>You may supply extra join conditions using the HQL with keyword. </p>\n</blockquote>\n\n<pre><code>from Cat as cat\nleft join cat.kittens as kitten\n    with kitten.bodyWeight &gt; 10.0\n</code></pre>\n\n<p>This <code>with</code> clause allows to add a restriction on the JOIN condition (ON clause). Is there any such thing in JPQL?</p>\n\n<p>When I run the following JPQL:</p>\n\n<pre><code>select c from ContainerDef c left join fetch c.displayState ds where c.id = 1 and ds.user.id = 2\n</code></pre>\n\n<p>The following SQL is generated:</p>\n\n<pre><code>select\n        ...\n    from\n        CONTAINER_DEF containerd0_ \n    left outer join\n        USER_CONTAINERDEF displaysta1_ \n            on containerd0_.CONTAINERDEF_ID=displaysta1_.CONTAINERDEF_ID \n    where\n        containerd0_.CONTAINERDEF_ID=? \n        and displaysta1_.AUTHUSER_ID=?\n</code></pre>\n\n<p>What should really get generated is:</p>\n\n<pre><code>select\n        ...\n    from\n        CONTAINER_DEF containerd0_ \n    left outer join\n        USER_CONTAINERDEF displaysta1_ \n            on containerd0_.CONTAINERDEF_ID=displaysta1_.CONTAINERDEF_ID \n            and displaysta1_.AUTHUSER_ID=?\n    where\n        containerd0_.CONTAINERDEF_ID=? \n</code></pre>\n\n<p>I am sure I'm missing the right JPQL clause for HQL's <code>with</code>.</p>\n"},{"tags":["java","hibernate","orm","jpa","foreign-keys"],"answer_count":5,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":5899,"score":8,"question_id":462898,"title":"JPA not generating \"on delete set null\" FK restrictions","body":"<p>I have two related clases JPA-annotated.  Alarm and Status.  One Alarm can have one Status.</p>\n\n<p>What I need is to be able to delete one Status and \"propagate\" a null value to the Alarms that are in that Status that has been deleted.</p>\n\n<p>That is, I need the foreign key to be defined as \"<strong>on delete set null</strong>\".</p>\n\n<pre><code>@Entity\npublic class Alarm {\n    @Id\n    @GeneratedValue(strategy=GenerationType.SEQUENCE, generator=\"sequence\")\n    @SequenceGenerator(name=\"sequence\", sequenceName=\"alarm_pk_seq\")\n    private Integer id;\n\n    @OneToOne(cascade=CascadeType.ALL)\n    @JoinColumn(name=\"idStatus\")\n    private Status status;\n\n    // get/set\n}\n\n@Entity\npublic class Status {\n    @Id\n    @Column(name=\"idStatus\")\n    private Integer id;\n\n    private String description;\n\n    // get/set\n}\n</code></pre>\n\n<p>Example:</p>\n\n<p>Before:</p>\n\n<pre><code>STATUS\nid  description\n1   new\n2   assigned\n3   closed\n\nALARMS\nid  status\n1   1\n2   2\n3   2\n</code></pre>\n\n<p>After (deleting the status with id=2)</p>\n\n<pre><code>STATUS\nid  description\n1   new\n3   closed\n\nALARMS\nid  status\n1   1\n2   NULL\n3   NULL\n</code></pre>\n\n<p>I am using Hibernate and PostgreSQL, automatically generating the database from source code.  I have tried with every possible CascadeType with no success.</p>\n\n<p>Is there anything wrong in the code ?  Is it possible to do it with JPA ?</p>\n"},{"tags":["java","sql","hibernate","sybase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":12864826,"title":"Hibernate timestamp version controlled by database.","body":"<p>I'm using both Hibernate annotations and Sybase. I'm looking to setup a version column to prevent locking. The database needs to administrate the timestamp rather than the application. I would like to accomplish this using annotations rather than hbm.xml.</p>\n\n<p>I've tried the following without success,</p>\n\n<p>I read on jboss.org to use </p>\n\n<pre><code>@org.hibernate.annotations.SourceType.DB\n@org.hibernate.annotations.Generated(GenerationTime.ALWAYS)\n</code></pre>\n\n<p>however I'm getting an IDE compiling error for DB, \n\"cannot find symbol\n  symbol:   class DB\n  location: class SourceType\"</p>\n\n<p>and a compiling error for rowVersion, </p>\n\n<p>The Version field or property is not one of the supported types. Make sure that it is one of the following types: int, Integer, short, Short, long, Long, java.sql.Timestamp.</p>\n\n<p>A temporal attribute must be marked with the @Temporal annotation.</p>\n\n<p><a href=\"http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#d0e5785\" rel=\"nofollow\">http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#d0e5785</a></p>\n\n<p>5.1.3.2. Timestamp</p>\n\n<p>Sample Code</p>\n\n<pre><code>@Version\n@org.hibernate.annotations.SourceType.DB\n@org.hibernate.annotations.Generated(GenerationTime.ALWAYS)\n@Column(name = \"row_version\")\nprivate Date rowVersion;\n\npublic Date getRowVersion() {\n    return rowVersion;\n}\n\npublic void setRowVersion(Date rowVersion) {\n    this.rowVersion = rowVersion;\n}\n</code></pre>\n\n<p>Could someone tell me what I'm missing? </p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":9500708,"title":"How to commit non-session objects using Hibernate session","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3553200/hibernate-different-object-with-the-same-identifier-value-was-already-associate\">Hibernate: different object with the same identifier value was already associated with the session</a>  </p>\n</blockquote>\n\n\n\n<p>I am working with Hibernate and Struts 1. My web application is running on one machine and my Hibernate code on another. I am using web services to access the database. My problem is that when I attempt to update any object it throws \"org.hibernate.NonUniqueObjectException\", when I call commit via my service method.</p>\n\n<blockquote>\n  <p>Caused by: org.hibernate.NonUniqueObjectException: a different object\n  with the same identifier value was already associated with the\n  session: [<strong>.</strong>.emp#2]</p>\n</blockquote>\n\n<p>I am unable to find the what the problem is, but I think when I retrieve the object for editing, it gets attached to the Hibernate session and then when I attempt an update it creates a new object on the service side as I am deserializing the object, so there may be two object with same identifier.</p>\n\n<p>Does anyone have any insight into what might be going on with this?</p>\n"},{"tags":["hibernate","sybase","jconnect"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12901631,"title":"Hibernate version sybase java.sql.SQLException JZ0TE: Attempted conversion between an illegal pair of types","body":"<p>I'm trying to setup Sybase to automatically handle timestamp version. I'm using hibernate, jconn version 3, and com.sybase.jdbc3.jdbc.SybDataSource. Below is my code code,</p>\n\n<pre><code>@Version\n@org.hibernate.annotations.Source(SourceType.DB)\n@org.hibernate.annotations.Generated(GenerationTime.ALWAYS)\nprivate java.sql.Timestamp lastModified;\n</code></pre>\n\n<p>However I continue to get the following exception. </p>\n\n<pre><code>java.sql.SQLException\nJZ0TE: Attempted conversion between an illegal pair of types. Valid database datatypes are: 'char, unichar, varchar, univarchar, text, unitext, datetime, short datetime, date, time'\n\nSQLState\n    JZ0TE\nerrorCode\n    0\n</code></pre>\n\n<p>Does anybody know what I'm doing wrong?</p>\n"},{"tags":["hibernate","serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12901206,"title":"Could not deserialize org.hibernate.type.SerializationException","body":"<p>Please help- My application was working fine until today. Today I got the exception \"could not deserialize\". java.io.eofException. And sometimes I was able to get the data. The problem was intermittent. What could be the issue here? </p>\n\n<pre><code>@Entity\n@Cacheable\n@Cache(usage = CacheConcurrencyStrategy.TRANSACTIONAL)\npublic class Filter {\nprivate int id;\n    private String name;\n    private User user;\n    private NameValue[][] filterMap;\n\n\n    @Id\n    @GeneratedValue(strategy=GenerationType.SEQUENCE)\n    public int getId() {\n        return id;\n    }\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    @ManyToOne(\n            targetEntity = User.class\n    )\n    @JoinColumn(name=\"userName\")\n    public User getUser() {\n        return user;\n    }\n    public void setUser(User user) {\n        this.user = user;\n    }\n    @Lob\n        public NameValue[][] getFilterMap() {\n        return filterMap;\n    }\n    public void setFilterMap(NameValue[][] filterMap) {\n        this.filterMap = filterMap;\n    }\n</code></pre>\n"},{"tags":["hibernate","struts","displaytag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12893518,"title":"Load data at the same time used scroll down page","body":"<p>I'd like to show a list of values that were read from database and will be shown by displaytag of struts to the user, that list of values should be loaded at the same time user scrolls down the page. My problem is as I already have an action that loads just only a few data, now I was thinking of doing the load using <code>$.ajax()</code> function of jquery, but before try something like that I would like to know if there is a best option of doing that using other struts tag or something. I'm using displaytag just because I need sorting.</p>\n"},{"tags":["java","hibernate","annotations"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6015,"score":0,"question_id":376093,"title":"hibernate column name issues","body":"<pre><code>@Column(name=\"DateOfBirth\")\nprivate Date dateOfBirth;\n</code></pre>\n\n<p>I specifically need the above code to create a column named \"DateOfBirth,\" instead Hibernate gives me a column named date_of_birth.  How can I change this?  Is there a web.xml property?  I came across DefaultNamingStrategy and ImprovedNamingStrategy, but not sure how to specify one or the other.</p>\n"},{"tags":["hibernate","jpa","spring-data"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12899297,"title":"Spring Data Custom Queries for nested collection entity properties","body":"<p>I have the following entity structure based on JPA annotations</p>\n\n<p>The following entity represents a User Class with a one to one mapping to the Contact class</p>\n\n<pre><code>@Entity\npublic class User {\n\n    @OneToOne\n    private Contact contact;\n    ...\n}\n</code></pre>\n\n<p>The following is a Contact Class which has multiple nested Emails</p>\n\n<pre><code>@Entity\npublic class Contact {\n\n    @OneToMany\n    private Set&lt;Emails&gt; emails;\n\n}\n</code></pre>\n\n<p>the property emailAddress;</p>\n\n<pre><code>@Entity\npublic class Email {\n\n    @Column\n    private String email;\n\n}\n</code></pre>\n\n<p>In my user repository, I am attempting to load the User Object who's Contact has an email with a specific email address such that:</p>\n\n<pre><code>public User findOneByEmailAddress(String emailAddress);\n</code></pre>\n\n<p>I tried using <code>findByContactEmailsEmailAddressIgnoreCase</code> instead of <code>findByEmailAddress</code> within the JpaRepository but that caused an exception.</p>\n\n<p>I currently use<code>@Query(\"select up from UserPrincipal up inner join up.contact.emails e where e.emailAddress = ?\")</code> but this has the drawback of not accepting limits (So it might return 2 or more objects and I will have to write even more code).</p>\n\n<p>Is there a way to represent this Nested Collection Entity property using Custom queries?</p>\n\n<p>Thanks..</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12898541,"title":"Mapping multiple columns from a legacy database table to an (java) List in hibernate?","body":"<p>When dealing with a denormalised (legacy) database table, whereby you have columns such as:</p>\n\n<p>price_1, price_2, price_3, ..., price_10</p>\n\n<p>What is the most efficient and cleanest way of mapping such columns into a java collection (a List for example), instead of mapping them to corresponding price1, price2, ... properties. </p>\n\n<p>Is there a simple way of doing it that does not involve UserTypes.</p>\n\n<p>I am talking about columns residing on the same table, not the usual one-to-many relationship between multiple entities.</p>\n"},{"tags":["java","hibernate","sqlite","windows-7","pragma"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":350,"score":1,"question_id":7239913,"title":"Hibernate + enabling SQLite Pragmas to gain speed on Windows 7 machine","body":"<p>Used software:  </p>\n\n<ul>\n<li>hibernate 3.6</li>\n<li>sqlite jbdc 3.6.0</li>\n<li>java jre 1.6.X</li>\n</ul>\n\n<p>I have a problem with transferring data over a tcp connection ( 20 000 entrys )</p>\n\n<ul>\n<li>create a sqlite database with the help of hibernate</li>\n<li>use hibernateview and hibernate annotations to create querys</li>\n<li>hibernate proberties are also used</li>\n<li>storing 20 000 entries with hibernate and NO sqlite pragmas enabled lasts nearly 6 minutes ( ~ 330 sec) on Windows 7 </li>\n<li>storing 20 000 entries without hibernate and all relevant sql pragmas enabled lasts ca 2 minutes ( ~ 109 sec ) on windows 7 </li>\n<li>tests with hibernate and sqlite without pragmas on windows XP and windows Vista run fast, but on win7 it lasts nearly\n3 times ( ~ 330 sec - win 7) as long as on the XP machine</li>\n<li>on windows 7 we want to activate sqlite pragmas to gain speed boost </li>\n<li><p>relevant pragmas are: </p>\n\n<pre><code>PRAGMA cache_size = 400000;\nPRAGMA synchronous = OFF;\nPRAGMA count_changes = OFF;\nPRAGMA temp_store = MEMORY;\nPRAGMA auto_vacuum = NONE;\n</code></pre></li>\n</ul>\n\n<p><strong>Problem:</strong> we must use hibernate ( no Nhibernate ! )</p>\n\n<p>Questions:  </p>\n\n<ul>\n<li>how to enable these pragmas in hibernate sqlite connection if its possible?  </li>\n<li>Is it possible to do so with using hibernate?</li>\n</ul>\n"},{"tags":["java","hibernate","spring","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2298,"score":1,"question_id":5648595,"title":"Spring 3.0.5 + hibernate 3.6 hibernate.show_sql not showing.Is it due to use of transaction?","body":"<p>i have a small maven project with </p>\n\n<pre><code>            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;  \n            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;\n            &lt;artifactId&gt;spring-asm&lt;/artifactId&gt;\n            &lt;artifactId&gt;log4j&lt;/artifactId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;artifactId&gt;hibernate-cglib-repack&lt;/artifactId&gt;\n            &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;\n\n\n    &lt;spring.version&gt;3.0.5.RELEASE&lt;/spring.version&gt;\n    &lt;hibernate.version&gt;3.6.1.Final&lt;/hibernate.version&gt;\n    &lt;hibernate-cglig-repack.version&gt;2.1_3&lt;/hibernate-cglig-repack.version&gt;\n    &lt;log4j.version&gt;1.2.14&lt;/log4j.version&gt;\n    &lt;javax-servlet-api.version&gt;2.5&lt;/javax-servlet-api.version&gt;\n    &lt;hsqldb.version&gt;1.8.0.10&lt;/hsqldb.version&gt;\n    &lt;mysql-connector.version&gt;5.1.6&lt;/mysql-connector.version&gt;\n    &lt;slf4j-log4j12.version&gt;1.5.2&lt;/slf4j-log4j12.version&gt;\n    &lt;slf4j-api.version&gt;1.5.8&lt;/slf4j-api.version&gt;\n    &lt;javaassist.version&gt;3.7.ga&lt;/javaassist.version&gt;\n</code></pre>\n\n<p>here is my applicationContext :</p>\n\n<pre><code>    &lt;context:component-scan base-package=\"com.project.personal.admin.model\"/&gt;\n&lt;context:annotation-config /&gt;\n\n&lt;bean id=\"propertyconfigurer\" class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n    &lt;property name=\"locations\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;classpath:mysql.hibernate.properties&lt;/value&gt;\n            &lt;value&gt;classpath:mysql.jdbc.properties&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n&lt;context:annotation-config/&gt;\n\n&lt;bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${jdbc.driverClassName}\" /&gt;\n    &lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${jdbc.password}\"  /&gt;\n&lt;/bean&gt;\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n\n            &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.show_sql\"&gt;${hibernate.show_sql}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.format_sql\"&gt;${hibernate.format_sql}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;${hibernate.hbm2ddl.auto}&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n    &lt;property name=\"packagesToScan\" value=\"com.project.personal.admin.model.domain\" /&gt;\n&lt;/bean&gt;\n&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>mysql.hibernate.properties</p>\n\n<pre><code>hibernate.dialect=org.hibernate.dialect.MySQLDialect\nhibernate.show_sql=true\nhibernate.format_sql=true\nhibernate.hbm2ddl.auto=create\n</code></pre>\n\n<p>here is a small test class </p>\n\n<pre><code>@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations={\"classpath:META-INF/test-project-admin-config.xml\"})\n@TransactionConfiguration(defaultRollback=true)\n@Transactional\npublic class UserDAOImplTest {\n\n  @Resource(name=\"manager\")\n  Manager manager;\n\n  @Autowired\n  UserDAO userDAO;\n\n  public UserDAOImplTest() {\n  }\n\n\n\n@Test\npublic void testSave() {\n    User u1 = manager.CreateUser();\n   //.....\n    userDAO.save(u1);\n    User expResult = u1;\n\n    User result = (User)userDAO.getById(u1.getId());\n\n    Assert.assertEquals(expResult, result);\n    Assert.assertEquals(expResult.getId(), result.getId());\n\n}\n\n@Test\npublic void testUpdate(){\n\n    User u2 = manager.CreateUser();\n    //....\n    u2.setPassword(\"mypassword\");\n    userDAO.save(u2);\n\n    User fromdb =(User) userDAO.getById(u2.getId());\n\n    fromdb.setEmail(\"claud@somemail.com\");\n    userDAO.save(fromdb);\n\n    User result = (User) userDAO.getById(fromdb.getId());\n\n    Assert.assertNotNull(result);\n    Assert.assertEquals(fromdb.getEmail(), result.getEmail());\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>So far everything runs file test are successfull, but just that there is not sql output, i'm wondering what might have caused that.Since this is the first time i'm relying on trasactionConfiguration i thought it's might be the cause of sql not showing other than that other previous project show the sql.</p>\n\n<p>How can i address it as in forcing the show of the sql scripts(not using log4j yet)\nthanks for reading.</p>\n"},{"tags":["hibernate","exception"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5328,"score":0,"question_id":1118767,"title":"Hibernate exception :org.hibernate.exception.SQLGrammarException: could not execute query","body":"<p>I am getting the following error. Not getting clue why is it happening. Also I checked DB it looks fine.</p>\n\n<pre><code>Hibernate: select customer0_.CustomerId as CustomerId0_, customer0_.CustomerAlias as Customer2_0_ from FF_REFERENCE.dbo.Customer customer0_ where customer0_.CustomerId=?\n\norg.hibernate.exception.SQLGrammarException: could not execute query\n   Caused by: java.sql.SQLException: [Macromedia][Sybase JDBC Driver]**Invalid column name: CustomerId0_**\n</code></pre>\n\n<p>My pojo is:</p>\n\n<pre><code>public class Customer implements java.io.Serializable {\n\n// Fields\n\nprivate String customerId;\nprivate String customerAlias;\n</code></pre>\n\n<p>}</p>\n\n<p>hbm is:</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n&lt;class name=\"com.pojo.reference.Customer\" table=\"Customer\" &gt;\n    &lt;id name=\"customerId\" column =\"CustomerId\" length=\"18\" /&gt;\n        &lt;property name=\"customerAlias\" type=\"java.lang.String\"&gt;\n            &lt;column name=\"CustomerAlias\" length=\"18\" /&gt;\n        &lt;/property&gt;\n</code></pre>\n\n<p></p>\n\n<p>The query I am using is:</p>\n\n<pre><code>public List findByProperty(String propertyName, Object value,String region) {\n    try {\n        String queryString = \"from Customer as model where model.\"\n                + propertyName + \"= ?\";\n        Query queryObject = getSession().createQuery(queryString);\n        queryObject.setParameter(0, value);\n        return queryObject.list();\n    } catch (RuntimeException re) {\n            }\n}\n</code></pre>\n\n<p>I am calling using:</p>\n\n<pre><code>custDao.findByProperty(\"customerId\", custName, region);\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12749784,"title":"Mapping a java.util.Map with key as Integer and sorted","body":"<p>Continuing with <a href=\"http://stackoverflow.com/questions/12676842/how-to-order-objects-in-hibernate-and-or-distributed-enviroment\">this</a> I decided to take an approach of making a different entity and make a OneToOne relationship (I hope this is OK). Bet let me explain what I have been doing:</p>\n\n<p>I have a Juez (judge) entity with these relevant fields:</p>\n\n<pre><code>@Entity\n@Table(name = \"jueces\")\npublic class Juez implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.TABLE)\n    @Column(name = \"id\")\n    private Integer id;\n\n    @Version\n    @Column(name = \"opt_lock\")\n    private Integer version;\n\n    @Basic\n    @Column(name = \"nombres\")\n    private String nombres;\n\n    // Getters, setters, other properties, etc.\n\n}\n</code></pre>\n\n<p>And I want another entity called RolDeJueces (judge roll) to hold a <code>java.util.Map&lt;Integer, Juez&gt;</code> in which I want the keys to be sorted (1,2,3...) and mapped to a judge so I can have a roll to make some calculations. Here is what I have until now:</p>\n\n<pre><code>@Entity\n@Table(name = \"rol_jueces\")\npublic class RolDeJueces {\n\n     @Id\n     private Integer id;\n\n     @Version\n     @Column(name = \"opt_lock\")\n     Integer version;\n\n     @OneToMany //Is this ok?\n     @MapKeyColumn(name = \"orden_juez\", updatable = true)\n     private Map&lt;Integer, Juez&gt; rol;\n\n     // Getters, setters, other properties, etc.\n\n}\n</code></pre>\n\n<p>How can I sort the map key and hold a reference to all my judges but only one time (a la @OneToOne)?</p>\n\n<p>Also, I must be capable of reordering my judges and make the changes persistent e.g.</p>\n\n<pre><code>rolDeJueces.getRol().clear(); // Delete current order\nint order = 0;\n// Add judges according to new order to the roll\nfor(Juez juez : getNewOrder()){\n    RolDeJueces.getRol().put(++order, juez);\n}\n\n// save my new roll and stuff...\n</code></pre>\n\n<p>Is this possible?</p>\n"},{"tags":["java","sql","oracle","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":12896439,"title":"Doing like search in oracle?","body":"<p>I have below code now.\nI am getting list of strings from the UI as below. the list has 3 strings as shown below.</p>\n\n<pre><code>happy%\n%hai\n%hello%\n</code></pre>\n\n<p>now i am looping through all 3 strings and getting matching strings and adding them to final list as below.</p>\n\n<pre><code>for(int i=0;i&lt;list.size;i++){\n//query to perform like search...\n}\n</code></pre>\n\n<p>My question is , instead of firing a separate query, how can i include them in a single query?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","spring","hibernate","jpa","spring-aop"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12896501,"title":"log domain object changes","body":"<p>I`m looking for an elegant way to achieve the next task: \nI have one entity called Ticket which has some fields like : owner, createdTs,body.... , and also a List entity which will keep track of all changes performed on a ticket.<br>\nMy app is build with Strus2, Spring 3, Jpa + Hibernate, and i have a service class TicketService which has the method save/updateTicket(Ticket ticket).<br>\nI have tried to to implement an aspect @Before save/update method but my problem is that i cannot access the old value of ticket in order to detect changes and create TicketHistory object according to these changes.<br>\nI tried the aspect approach because i access this method from many other methods and right now these objects (Ticket and TicketHistory) are tight coupled.</p>\n\n<p>any idea ?\nThanks,<br>\nAdrian</p>\n"},{"tags":["java","hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12895915,"title":"How do I write the HQL to query the many to many?","body":"<p>I have the User model and the the system allows users to follow each other.\nSo I put two lists in the User model as below：</p>\n\n<pre><code>@ManyToMany(fetch = FetchType.LAZY)\n@JoinTable(name = \"t_user_t_followingUser\", joinColumns = { @JoinColumn(name = \"user_id\") }, inverseJoinColumns = { @JoinColumn(name = \"followingUser_id\") })\npublic List&lt;User&gt; getFollowingUsers() {\n    return followingUsers;\n}\n\npublic void setFollowingUsers(List&lt;User&gt; followingUsers) {\n    this.followingUsers = followingUsers;\n}\n\n@ManyToMany(fetch = FetchType.LAZY)\n@JoinTable(name = \"t_user_t_followedUser\", joinColumns = { @JoinColumn(name = \"user_id\") }, inverseJoinColumns = { @JoinColumn(name = \"followedUser_id\") })\npublic List&lt;User&gt; getFollowedUsers() {\n    return followedUsers;\n}\n\npublic void setFollowedUsers(List&lt;User&gt; followedUsers) {\n    this.followedUsers = followedUsers;\n}\n</code></pre>\n\n<p>And now I want to get the total followers of the user u.\nHow to write the HQL?</p>\n\n<p>ps: The many2many may be not proper.And any suggestion to the design?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","collections"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":12896458,"title":"Not commiting after swap within a Collection with hibernate","body":"<p>Working with hibernate 4.1.7, I have a class with a Collection (attachments), defined in the mapping file as:</p>\n\n<pre><code>&lt;list lazy=\"false\" table=\"news_attachment\" name=\"attachments\"&gt;\n      &lt;cache usage=\"nonstrict-read-write\"/&gt;\n      &lt;key column=\"news\"/&gt;\n      &lt;index column=\"index_attachment\"/&gt;\n      &lt;many-to-many class=\"mypackage.Archive\" column=\"attachment\" unique=\"true\"/&gt;\n&lt;/list&gt;\n</code></pre>\n\n<p>I am trying to swap two elements with:</p>\n\n<pre><code>   Archive archive0 = news.getAttachments().get(0);\n   Archive archive1 = news.getAttachments().get(1);\n   news.getAttachments().set(0, archive1);\n   news.getAttachments().set(1, archive0);\n</code></pre>\n\n<p>But, in commit time, I get an awful</p>\n\n<pre><code>org.hibernate.exception.ConstraintViolationException: Duplicate entry '163703' for key 'attachment'\n</code></pre>\n\n<p>And, for my surprise, mysql updates are:</p>\n\n<pre><code>          479 Query     update news_attachment set attachment=163703 where news=53306 and index_attachment=0\n          479 Query     update news_attachment set attachment=163703 where news=53306 and index_attachment=0\n</code></pre>\n\n<p>(the surprise is id and index are always the same).</p>\n\n<p>But, if I create a new List, set the objects in the new order and execute the setter, everything works fine. </p>\n\n<pre><code>List&lt;Archive&gt; list = new ArrayList&lt;Archive&gt;();\nlist.add(news.getAttachments().get(1));\nlist.add(news.getAttachments().get(0));\nnews.setAttachments(list);\n</code></pre>\n\n<p>mysql.log outputs the inserts as I expected, different ids and indexes.</p>\n\n<p>Are operations on the original list, not recommended?</p>\n"},{"tags":["java","database","spring","hibernate","struts2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12896028,"title":"What should i know when Developing Web Application","body":"<p>Sorry for this Basic question. I want to develop Web Application which consists of.</p>\n\n<ul>\n<li>Login form</li>\n<li>Three Different forms for 3 Department (CRUD)</li>\n<li>Reports</li>\n</ul>\n\n<p>I am confused with what should be my Frontend.(whether <strong>HTML pages  or JSP pages</strong> ). which technology will be best and easy to develop this Application.</p>\n"},{"tags":["java","hibernate","session"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2268,"score":3,"question_id":3553200,"title":"Hibernate: different object with the same identifier value was already associated with the session","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1074081/hibernate-error-org-hibernate-nonuniqueobjectexception-a-different-object-with\">Hibernate Error: org.hibernate.NonUniqueObjectException: a different object with the same identifier value was already associated with the session</a>  </p>\n</blockquote>\n\n\n\n<p>when I use the DAO.update(userbean), <code>session.SaveOrUpdate(e);</code>throw the Exception:different object with the same identifier value was already associated with the session</p>\n\n<p>the function is like next:</p>\n\n<pre><code>    public E save(E e) {\n    Session session = null;\n    try {\n        session = sessionFactory.openSession();\n        log.debug(\"session=\"+session.hashCode()+\" save \"+e);\n        session.SaveOrUpdate(e);  //here throws exception \n        session.flush();\n    }\n    catch (Exception e1) {\n        log.err(\"Cannot open hibernate session \"+ e1.getMessage()+\" cause : \"+e1.getCause());\n        e1.printStackTrace();\n    }\n    finally { if ( session != null ) session.close(); session = null;}\n    return e ;\n}\n</code></pre>\n\n<p>the userbean is an instance of class UserBean</p>\n\n<pre><code>public class UserBean{\n   private List&lt;GroupBean&gt; groups = new ArrayList&lt;GroupBean&gt; ();\n   private List&lt;RoleBean&gt; roles = new ArrayList&lt;RoleBean&gt; ();\n}\n\npublic class GroupBean{\nprivate List&lt;RoleBean&gt; roles = new ArrayList&lt;RoleBean&gt; ();\n}\n</code></pre>\n\n<p>every groupbean has a list of roles, which are not changed.</p>\n\n<p>in database, group and role is many-to-many mapping, </p>\n\n<p>for example, </p>\n\n<p>we have a groupbean#1, it's roles:  rolebean#1, rolebean#2;</p>\n\n<p>groupbean#2, which roles are rolebean#1.</p>\n\n<p>now I create a new userbean#1, it's groups is groupbean#1\nand if I want to add the rolebean#1 to userbean#1, it will throws the exception like the title descript</p>\n\n<p>I look the server.log, and find that when I user DAO.save, the saveOrUpdate order is:</p>\n\n<pre><code>userbean#1\n|---|-----------***userbean.groups\n|     |     groupbean#1\n|     |         groupbean.roles\n|     |             rolebean#1  # save relebean#1 the first time\n|     |             ---done rolebean#1\n|     |         ------done all rolebeans of group.roles\n|     |     ---done groupbean#1\n|     |-----------done all groupbeans of userbean.groups\n|---|-----------***userbean.roles\n     |      rolebean#1          # save rolebean#1 the second time, and throws exception here!\n     |      ----done rolebean#1\n     |      .....\n     |-----------done all rolebeans of userbean.roles\n</code></pre>\n\n<p>the cause of the exception is rolebean#1 has been saved twice in a session, and their identity is the same.</p>\n\n<p>In the function save(E e), If I use</p>\n\n<pre><code>session.merge(e);\n</code></pre>\n\n<p>replace</p>\n\n<pre><code>session.SaveOrUpdate(e);\n</code></pre>\n\n<p>will not throw exception, but the rolebean#1 is not assocaited to userbean#1</p>\n\n<p>anyone can give some suggestions about this? </p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12895335,"title":"Adding extra fields in hibernate beans that are not fields in db table","body":"<p>Is it possible to add extra member variables in hibernate beans that are not fields in the actual database?</p>\n\n<p>eg. I need to add hasComments a member variable in MyEntity, and has comments is not an actual field in the db.</p>\n"},{"tags":["hibernate","coldfusion"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12889232,"title":"CF ORM ormExecuteQuery(), What format should dates be?","body":"<p>I have the following method:</p>\n\n<pre><code>public function listPublished(){\n        var today = createODBCDate(now());\n        return ormExecuteQuery(\"FROM Employment WHERE publishdate &lt;= #today# and expirydate &gt;= #today# ORDER BY tstamp desc\");\n}\n</code></pre>\n\n<p>When I run it I am getting the following error:</p>\n\n<pre><code>org.hibernate.QueryException: unexpected char: '{' [FROM EmploymentFindSonographer WHERE publishdate &lt;= {d '2012-10-15'} and expirydate &gt;= {d '2012-10-15'} ORDER BY tstamp desc]\n</code></pre>\n\n<p>My guess is that HQL requires the format in something other than ODBC date?  I also tried passing in a standard CF Date but same error.</p>\n\n<p>Can anyone tell me what format my dates should be in when passing HQL into ormExecuteQuery?</p>\n\n<p>Many Thanks</p>\n"},{"tags":["java","sql","hibernate","jpa"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":2737,"score":4,"question_id":3055407,"title":"How do I delete orphan entities using hibernate and JPA on a many-to-many relationship?","body":"<p>I want to delete orphan entities using hibernate and JPA on a many-to-many relationship but all that I found was this atibute the attribute. org.hibernate.annotations.CascadeType.DELETE_ORPHAN ( i.e. @Cascade(value={org.hibernate.annotations.CascadeType.DELETE_ORPHAN) ), which works only for one-to-many relationships.</p>\n\n<p>I want to know if I can delete the orphan ones on my many-to-many relationship.</p>\n\n<p>I´d be happy if anyone could help me...</p>\n\n<p>Thanks in advance !</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12775719,"title":"How to get the records based on date using Hibernate Criteria","body":"<p>The following post told you that how to get the records based on given date.</p>\n"},{"tags":["hibernate","oop","database-design","rdf","system-integration"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":687,"score":3,"question_id":231325,"title":"Blending RDF and ORM approaches","body":"<p>I'm working on a team investigating a technology stack for a green-field systems integration project. Part of our favored technology stack use Hibernate to persist its internal state and exposes hooks into the Hibernate transactions, so that business entities stay synchronized with the state of this utility. Great, except we need to maintain information about entities of an unknown type and link that data to the predefined types. We need a scalable data store that does not require the schema to be defined upfront. The sweet spot would be to blend RDF data and Hibernate managed entities.</p>\n\n<p>Have you faced a similar requirement and what approaches can you recommend?<br>\nAny RDF/ORM blend would need to support infrequent large-scale queries for reporting and data exploration and also frequent focused read and write operations in support of transactions.</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12893196,"title":"Possible chances of getting org.hibernate.exception.GenericJDBCException: could not execute query\"","body":"<p>I am using hibernate 3.6 in my project since last 6 months, but some time i am getting \"org.hibernate.exception.GenericJDBCException: could not execute query\" error. i don't know the exact reason.\ni am getting confused from different answers from diff sites  :-( !!\nWhat might be possible scenario in which this error occurs?</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12888451,"title":"name attribute doesn't seem to work in Field","body":"<p>As I am trying to map Entity to tables using JPA (Hibernate implementation) I found something confusing</p>\n\n<p>when i use annotation on getter, things are OK</p>\n\n<pre><code>@Column(name = \"main_battery_voltage\", precision = 2)\npublic float getMainBatteryVoltage() {\n    return mainBatteryVoltage;\n}\n</code></pre>\n\n<p>but When I try the same thing on field, field name is used and attribute </p>\n\n<pre><code>@Column(name = \"main_battery_voltage\", precision = 2)\nprivate float mainBatteryVoltage;\n</code></pre>\n\n<p>System ignores name attribute, runs with column name mainBatteryVoltage in DB and consequently failed task.</p>\n\n<p>I am using MySQL and this is the persistence.xml</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" version=\"2.0\"&gt;\n    &lt;persistence-unit name=\"SolarPersistenceUnit\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;class&gt;com.cs.solar.db.entity.User&lt;/class&gt;\n        &lt;class&gt;com.cs.solar.db.entity.Lamp&lt;/class&gt;\n        &lt;class&gt;com.cs.solar.db.entity.Project&lt;/class&gt;\n        &lt;properties&gt;\n            &lt;property name=\"hibernate.dialect\"     value=\"org.hibernate.dialect.MySQL5Dialect\"/&gt;\n            &lt;!--&lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.HSQLDialect\"/&gt;--&gt;\n            &lt;property name=\"hibernate.connection.driver_class\" value=\"com.mysql.jdbc.Driver\"/&gt;\n            &lt;property name=\"hibernate.connection.url\" value=\"jdbc:mysql://localhost:3306/SOLAR\"/&gt;\n            &lt;property name=\"hibernate.connection.username\" value=\"root\" /&gt;\n            &lt;property name=\"hibernate.connection.password\" value=\"admin\" /&gt;\n            &lt;property name=\"hibernate.connection.autocommit\" value=\"false\"/&gt;\n            &lt;property name=\"hibernate.show_sql\" value=\"true\" /&gt;\n            &lt;property name=\"hibernate.format_sql\" value=\"true\" /&gt;\n            &lt;property name=\"hibernate.max_fetch_depth\" value=\"3\"/&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n     &lt;persistence-unit name=\"TestSolar\" /&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>Although it works now, I am curious what cause this problem, thank</p>\n"},{"tags":["java","hibernate","orm"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":12785222,"title":"ORM - Mixing hibernate with in-memory data","body":"<p>I have two java classes, A &amp; B, with A holding a reference to B:</p>\n\n<pre><code>public class A {\n   private long id;\n   private B b;\n   ...\n}\n\npublic class B {\n   private long id;\n   ...\n}\n</code></pre>\n\n<p>In my database only instances of A are stored, alongside with the ID of the referenced B's:</p>\n\n<pre><code>$ select * from tableA;\nid  | bid | ...\n---------------\n1   | 42  |\n2   | 42  |\n3   | 43  |\n...\n</code></pre>\n\n<p>However, B are <em>not</em> stored in the database, but accessible through some implementation of a service layer ServiceB:</p>\n\n<pre><code>public interface ServiceB {\n   public B getB(long bid);\n}\n</code></pre>\n\n<p>How can I model that using Hibernate? I'd preferably use an XML-based HBM configuration. I also would like to avoid adding a transient field in A holding bid (if it is possible).</p>\n"},{"tags":["java","hibernate","jpa","composite-key"],"answer_count":4,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":5633,"score":8,"question_id":242914,"title":"JPA Composite Key + Sequence","body":"<p>Is it possible in plain JPA or JPA+Hibernate extensions to declare a composite key, where an element of the composite key is a sequence?</p>\n\n<p>This is my composite class:</p>\n\n<pre><code>@Embeddable\npublic class IntegrationEJBPk implements Serializable {\n\n    //...\n\n\n    @ManyToOne(cascade = {}, fetch = FetchType.EAGER)\n    @JoinColumn(name = \"APPLICATION\")\n    public ApplicationEJB getApplication() {\n        return application;\n    }\n\n\n    @Column(name = \"ENTITY\", unique = false, nullable = false, insertable = true, updatable = true)\n    public String getEntity() {\n        return entity;\n    }\n\n    @GeneratedValue(strategy = GenerationType.AUTO, generator = \"INTEGRATION_ID_GEN\")\n    @SequenceGenerator(name = \"INTEGRATION_ID_GEN\", sequenceName = \"OMP_INTEGRATION_CANONICAL_SEQ\")\n    @Column(name = \"CANONICAL_ID\", unique = false, nullable = false, insertable = true, updatable = true)\n    public String getCanonicalId() {\n        return canonicalId;\n    }\n\n    @Column(name = \"NATIVE_ID\", unique = false, nullable = false, insertable = true, updatable = true)\n    public String getNativeId() {\n        return nativeId;\n    }\n\n    @Column(name = \"NATIVE_KEY\", unique = false, nullable = false, insertable = true, updatable = true)\n    public String getNativeKey() {\n        return nativeKey;\n    }\n\n    //...\n}\n</code></pre>\n\n<p>I already supply the values for <code>application</code>, <code>entity</code>, <code>nativeId</code> and <code>nativeKey</code>. I want to construct an entity like the one below:</p>\n\n<pre><code>IntegrationEJB i1 = new IntegrationEJB();\ni1.setIntegrationId(new IntegrationEJBPk());\ni1.getIntegrationId().setApplication(app1);\ni1.getIntegrationId().setEntity(\"Entity\");\ni1.getIntegrationId().setNativeId(\"Nid\");\ni1.getIntegrationId().setNativeKey(\"NK\");\n</code></pre>\n\n<p>And when I call <code>em.persist(i1</code>), I want that the <code>canonicalId</code> is generated and the integration is inserted.</p>\n\n<p>Is this possible? If so, what's the simple way? (I prefer not to use application-provided keys or native sql).</p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12883959,"title":"JPA primary key on 2 referenced fields","body":"<p>OK, I've tried everything, just can't make this to work:</p>\n\n<p>I have the following table:</p>\n\n<ul>\n<li>user_id int , references users.id</li>\n<li>platform_id int , references platforms.id</li>\n<li>field1</li>\n<li>field2</li>\n<li>...</li>\n</ul>\n\n<p>My primary key (in th DB and logically) is the combination of <code>user_id</code> and <code>platform_id</code>.</p>\n\n<p>I want to create a composite key that will have the User and Platform classes as members (like I would do with a regular OneToOne or OneToMany relations).</p>\n\n<p>I want the composite key to have the actual classes references and not only the ids (much easier for me later when I need the actual reference for some calculations).</p>\n\n<p>Furthermore, I need the User class to have a OneToMany relation with this UserPlatformData class.</p>\n\n<p>I was able to create an Embeddable class with User and Platform but JPA always does insert and never updates the existing records even when the pk is the same (that leads to <code>duplicate entry for key primary...</code>).</p>\n\n<p>How do I create a class with a primary key that consists of two other references (not primitives)?</p>\n"},{"tags":["spring","hibernate","java-ee","orm","annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1325,"score":1,"question_id":9815756,"title":"Injection of autowired dependencies failed while using @Transactional","body":"<p>I testing my DAO, but it didn't work. The following error occurs:</p>\n\n<pre><code>Tests in error: \n  testAccountOperations(com.tsekhan.rssreader.dao.HibernateControllerTest): Error creating bean with name 'com.tsekhan.rssreader.dao.HibernateControllerTest': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: com.tsekhan.rssreader.dao.HibernateController com.tsekhan.rssreader.dao.HibernateControllerTest.hibernateController; nested exception is java.lang.IllegalArgumentException: Can not set com.tsekhan.rssreader.dao.HibernateController field com.tsekhan.rssreader.dao.HibernateControllerTest.hibernateController to $Proxy25\n</code></pre>\n\n<p>My DAO:</p>\n\n<pre><code>@Service\n@Scope(\"singleton\")\npublic class HibernateController extends HibernateDaoSupport {\n\n    @Autowired\n    public SessionFactory sessionFactory;\n\n    @Transactional\n    public void addAcount(Account account) {\n        sessionFactory.getCurrentSession().saveOrUpdate(account);\n    }\n}\n</code></pre>\n\n<p>My test for this DAO:</p>\n\n<pre><code>@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(\"classpath:/applicationContext.xml\")\npublic class HibernateControllerTest {\n\n    @Autowired\n    HibernateController hibernateController;\n\n    private Set&lt;Channel&gt; getTestChannelList(String channelLink) {\n        Channel testChannel = new Channel();\n        testChannel.setSourceLink(channelLink);\n        Set&lt;Channel&gt; testChannelList = new HashSet&lt;Channel&gt;();\n        testChannelList.add(testChannel);\n        return testChannelList;\n    }\n\n    private Account getTestAccount(String accountLogin, String channelLink) {\n        Account testAccount = new Account();\n        testAccount.setAccountLogin(accountLogin);\n        testAccount.setChannelList(getTestChannelList(channelLink));\n        return testAccount;\n    }\n\n    @Test\n    public void testAccountOperations() {\n        hibernateController\n                .addAcount(getTestAccount(\"test_login\", \"test_link\"));\n    }\n}\n</code></pre>\n\n<p>My <em>applicationContext.xml</em>:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n        http://www.springframework.org/schema/tx\n        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context-3.1.xsd\"\n        default-autowire=\"byName\"&gt;\n\n    &lt;!-- Enabling spring-transaction annotations --&gt;\n    &lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt;\n\n    &lt;!-- Enabling annotation-driven configurating --&gt;\n    &lt;context:annotation-config /&gt;\n\n    &lt;!-- Creation of transaction manager --&gt;\n\n    &lt;bean id=\"transactionManager\" scope=\"singleton\" \n        class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n        &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"sessionFactory\" scope=\"singleton\"\n        class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n        &lt;property name=\"configLocation\" value=\"classpath:/hibernate.cfg.xml\"/&gt;\n        &lt;property name=\"configurationClass\"&gt;\n            &lt;value&gt;org.hibernate.cfg.AnnotationConfiguration&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n    &lt;!--\n    A Spring interceptor that takes care of Hibernate session lifecycle.\n    --&gt;\n    &lt;bean id=\"hibernateInterceptor\" \n            class=\"org.springframework.orm.hibernate3.HibernateInterceptor\"&gt;\n        &lt;property name=\"sessionFactory\"&gt;\n            &lt;ref bean=\"sessionFactory\"/&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean name=\"employeeDAO\" scope=\"prototype\" \n        class=\"com.tsekhan.rssreader.dao.HibernateController\" /&gt;\n\n    &lt;!-- Searching for hibernate POJO files in package com.tsekhan.rssreader.web --&gt;\n    &lt;context:component-scan base-package=\"com.tsekhan.rssreader.web\" /&gt;\n    &lt;bean class=\"org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping\" /&gt;\n    &lt;bean class=\"org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter\" /&gt;\n\n&lt;/beans&gt;\n</code></pre>\n\n<p>I note, that if you comment @Transactional in DAO, bean is created correctly. What happens?</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3096,"score":1,"question_id":2952766,"title":"Help with Hibernate mapping","body":"<p>i have the following classes</p>\n\n<pre><code>public class RSS \n{\n    private Integer id;\n    private String title;\n    private String description;\n    private String link;\n    private Date dateCreated;\n    private Collection rssItems;\n    private String  url;\n    private String language;\n    private String rating;\n    private Date pubDate;\n    private Date lastBuildDate;\n    private User user;\n    private Date dateModified;\n\n    public RSS() {\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public void setDescription(String description){\n        this.description = description;\n    }\n\n    public String getDescription(){\n        return this.description;\n    }\n\n    public void setLink(String link){\n        this.link = link;\n    }\n\n    public String getLink(){\n        return this.link;\n    }\n\n    public void setUrl(String url){\n        this.url = url;\n    }\n\n    public String getUrl(){\n        return this.url;\n    }\n\n    public void setLanguage(String language){\n        this.language = language;\n    }\n\n    public String getLanguage(){\n        return this.language;\n    }\n\n    public void setRating(String rating){\n        this.rating = rating;\n    }\n\n    public String getRating(){\n        return this.rating;\n    }\n\n    public Date getPubDate() {\n        return pubDate;\n    }\n\n    public void setPubDate(Date pubDate) {\n        this.pubDate = pubDate;\n    }\n\n    public Date getLastBuildDate() {\n        return lastBuildDate;\n    }\n\n    public void setLastBuildDate(Date lastBuildDate) {\n        this.lastBuildDate = lastBuildDate;\n    }\n\n    public Date getDateModified() {\n        return dateModified;\n    }\n\n    public void setDateModified(Date dateModified) {\n        this.dateModified = dateModified;\n    }\n\n    public Date getDateCreated() {\n        return dateCreated;\n    }\n\n    public void setDateCreated(Date dateCreated) {\n        this.dateCreated = dateCreated;\n    }\n\n    public Collection getRssItems() {\n        return rssItems;\n    }\n\n    public void setRssItems(Collection rssItems) {\n        this.rssItems = rssItems;\n    }\n}\n\npublic class RSSItem {\n\n    private RSS rss;\n\n    private Integer id;\n    private String title;\n    private String description;\n    private String link;\n    private Date dateCreated;\n    private Date dateModified;\n    private int rss_id;\n\n    public RSSItem() {}\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    public String getLink() {\n        return link;\n    }\n\n    public void setLink(String link) {\n        this.link = link;\n    }\n\n    public Date getDateCreated() {\n        return dateCreated;\n    }\n\n    public void setDateCreated(Date dateCreated) {\n        this.dateCreated = dateCreated;\n    }\n\n    public Date getDateModified() {\n        return dateModified;\n    }\n\n    public void setDateModified(Date dateModified) {\n        this.dateModified = dateModified;\n    }\n\n    public RSS getRss() {\n        return rss;\n    }\n\n    public void setRss(RSS rss) {\n        this.rss = rss;\n    }\n}\n</code></pre>\n\n<p>that i mapped as </p>\n\n<pre><code>    &lt;hibernate-mapping&gt;\n  &lt;class name=\"com.rssFeed.domain.RSS\"  schema=\"PUBLIC\" table=\"RSS\"&gt;\n    &lt;id name=\"id\" type=\"int\"&gt;\n      &lt;column name=\"ID\"/&gt;\n      &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"title\" type=\"string\"&gt;\n      &lt;column name=\"TITLE\" not-null=\"true\"/&gt;\n    &lt;/property&gt;        \n    &lt;property name=\"lastBuildDate\" type=\"java.util.Date\"&gt;\n      &lt;column name=\"LASTBUILDDATE\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"pubDate\" type=\"java.util.Date\"&gt;\n      &lt;column name=\"PUBDATE\" /&gt;\n    &lt;/property&gt;\n    &lt;property name=\"dateCreated\" type=\"java.util.Date\"&gt;\n      &lt;column name=\"DATECREATED\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"dateModified\" type=\"java.util.Date\"&gt;\n      &lt;column name=\"DATEMODIFIED\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"description\" type=\"string\"&gt;\n      &lt;column name=\"DESCRIPTION\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"link\" type=\"string\"&gt;\n      &lt;column name=\"LINK\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"url\" type=\"string\"&gt;\n      &lt;column name=\"URL\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"language\" type=\"string\"&gt;\n      &lt;column name=\"LANGUAGE\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"rating\" type=\"string\"&gt;\n      &lt;column name=\"RATING\"/&gt;\n    &lt;/property&gt;\n     &lt;set inverse=\"true\" lazy=\"false\" name=\"rssItems\"&gt;\n      &lt;key&gt;\n        &lt;column name=\"RSS_ID\"/&gt;\n      &lt;/key&gt;\n      &lt;one-to-many class=\"com.rssFeed.domain.RSSItem\"/&gt;\n    &lt;/set&gt;\n  &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n\n\n&lt;hibernate-mapping&gt;\n  &lt;class name=\"com.rssFeed.domain.RSSItem\" schema=\"PUBLIC\" table=\"RSSItem\"&gt;\n    &lt;id name=\"id\" type=\"int\"&gt;\n      &lt;column name=\"ID\"/&gt;\n      &lt;generator class=\"native\"/&gt;\n    &lt;/id&gt;\n    &lt;property name=\"title\" type=\"string\"&gt;\n      &lt;column name=\"TITLE\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"description\" type=\"string\"&gt;\n      &lt;column name=\"DESCRIPTION\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"link\" type=\"string\"&gt;\n      &lt;column name=\"LINK\" not-null=\"true\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"dateCreated\" type=\"java.util.Date\"&gt;\n      &lt;column name=\"DATECREATED\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"dateModified\" type=\"java.util.Date\"&gt;\n      &lt;column name=\"DATEMODIFIED\"/&gt;\n    &lt;/property&gt;\n    &lt;many-to-one class=\"com.rssFeed.domain.RSS\" fetch=\"select\" name=\"rss\"&gt;\n      &lt;column name=\"RSS_ID\"/&gt;\n    &lt;/many-to-one&gt;\n  &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>But when i try to fetch an RSS I get the following error</p>\n\n<blockquote>\n  <p>Exception occurred in target VM: failed to lazily initialize a collection of role: com.rssFeed.domain.RSS.rssItems, no session or session was closed \n  org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.rssFeed.domain.RSS.rssItems, no session or session was closed\n      at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)\n      at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)\n      at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:97)\n      at org.hibernate.collection.PersistentSet.size(PersistentSet.java:139)\n      at com.rssFeed.dao.hibernate.HibernateRssDao.get(HibernateRssDao.java:47)\n      at com.rssFeed.ServiceImplementation.RssServiceImplementation.get(RssServiceImplementation.java:46)\n      at com.rssFeed.mvc.ViewRssController.handleRequest(ViewRssController.java:20)\n      at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)\n      at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)\n      at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:809)\n      at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:476)\n      at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:431)\n      at javax.servlet.http.HttpServlet.service(HttpServlet.java:734)\n      at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n      at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1523)\n      at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)\n      at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)\n      at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)\n      at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)\n      at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)\n      at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)\n      at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:332)\n      at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:233)\n      at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:165)\n      at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)\n      at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)\n      at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)\n      at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)\n      at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)\n      at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)\n      at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)\n      at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)\n      at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)\n      at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)\n      at com.sun.grizzly.ContextTask.run(ContextTask.java:69)\n      at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)\n      at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)\n      at java.lang.Thread.run(Thread.java:619)\n  &lt;</p>\n</blockquote>\n\n<p>what does it mean?</p>\n\n<p>Thanks</p>\n\n<p>i have modified my code according to the suggestion from Pascal Thivent</p>\n\n<p>and now i get the following exception</p>\n\n<pre><code>type Exception report\n\nmessage\n\ndescriptionThe server encountered an internal error () that prevented it from fulfilling this request.\n\nexception\n\norg.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.springframework.dao.InvalidDataAccessResourceUsageException: could not initialize a collection: [com.rssFeed.domain.RSS.rssItems#3]; nested exception is org.hibernate.exception.SQLGrammarException: could not initialize a collection: [com.rssFeed.domain.RSS.rssItems#3]\n\nroot cause\n\norg.springframework.dao.InvalidDataAccessResourceUsageException: could not initialize a collection: [com.rssFeed.domain.RSS.rssItems#3]; nested exception is org.hibernate.exception.SQLGrammarException: could not initialize a collection: [com.rssFeed.domain.RSS.rssItems#3]\n\nroot cause\n\norg.hibernate.exception.SQLGrammarException: could not initialize a collection: [com.rssFeed.domain.RSS.rssItems#3]\n\nroot cause\n\njava.sql.SQLException: Table not found in statement [select rssitems0_.RSS_ID as RSS7_1_, rssitems0_.ID as ID1_, rssitems0_.ID as ID2_0_, rssitems0_.TITLE as TITLE2_0_, rssitems0_.DESCRIPTION as DESCRIPT3_2_0_, rssitems0_.LINK as LINK2_0_, rssitems0_.DATECREATED as DATECREA5_2_0_, rssitems0_.DATEMODIFIED as DATEMODI6_2_0_, rssitems0_.RSS_ID as RSS7_2_0_ from PUBLIC.RSSItem rssitems0_ where rssitems0_.RSS_ID=?]\n\nnote The full stack traces of the exception and its root causes are available in the GlassFish v3 logs.\n</code></pre>\n\n<p>only if i remove the lazyLoad=\"false\" i get the previous error</p>\n\n<p>by the way this is my table definitions</p>\n\n<pre><code>drop table RSS_ITEM if exists\ndrop table RSS if exists\n\ncreate table RSS (\n   id integer identity primary key,\n   title varchar(128) not null, \n   description varchar(2048) not null,\n   link varchar(1024) not null,\n   url varchar(1024) not null,\n   language  varchar(63) not null,\n   rating  varchar(63),\n   pubDate date,\n   lastBuildDate date,\n   user_id integer,\n   dateCreated date not null,\n   dateModified date not null   \n);\n\n\ncreate table RSS_ITEM (\n   id integer identity primary key,\n   title varchar(128) not null,\n   description varchar(2048) not null,\n   link varchar(1024) not null,\n   rss_id integer not null,\n   dateCreated date not null,\n   dateModified date not null   \n);\n\n\nalter table RSS_ITEM add constraint item_rss foreign key (rss_id) references RSS;\nalter table RSS add constraint rss_user foreign key (user_id) references RSS_USER;\n</code></pre>\n"},{"tags":["java","spring","hibernate","alfresco"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":140,"score":0,"question_id":12835305,"title":"how to resolve exception on creating the Spring context?","body":"<p>i'm use sdk alfresco 4.0d ,eclipse ide juno ,</p>\n\n<pre><code>Exception in thread \"main\" org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'encryptionKeysRegistry' defined in class path resource [alfresco/encryption-context.xml]: Cannot resolve reference to bean 'transactionService' while setting bean property 'transactionService'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionService' defined in class path resource [alfresco/core-services-context.xml]: Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in class path resource [alfresco/hibernate-context.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [alfresco/hibernate-context.xml]: Invocation of init method failed; nested exception is org.hibernate.HibernateException: Hibernate Dialect must be explicitly set\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:580)\n        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)\n        at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:139)\n        at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:93)\n        at org.alfresco.util.BaseApplicationContextHelper.getApplicationContext(BaseApplicationContextHelper.java:67)\n        at org.alfresco.util.ApplicationContextHelper.getApplicationContext(ApplicationContextHelper.java:46)\n        at org.alfresco.sample.FirstFoundationClient.main(FirstFoundationClient.java:63)\n    Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionService' defined in class path resource [alfresco/core-services-context.xml]: Cannot resolve reference to bean 'transactionManager' while setting bean property 'transactionManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in class path resource [alfresco/hibernate-context.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [alfresco/hibernate-context.xml]: Invocation of init method failed; nested exception is org.hibernate.HibernateException: Hibernate Dialect must be explicitly set\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)\n        ... 17 more\n    Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'transactionManager' defined in class path resource [alfresco/hibernate-context.xml]: Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [alfresco/hibernate-context.xml]: Invocation of init method failed; nested exception is org.hibernate.HibernateException: Hibernate Dialect must be explicitly set\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1325)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)\n        ... 27 more\n    Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in class path resource [alfresco/hibernate-context.xml]: Invocation of init method failed; nested exception is org.hibernate.HibernateException: Hibernate Dialect must be explicitly set\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1420)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)\n        at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)\n        ... 37 more\n    Caused by: org.hibernate.HibernateException: Hibernate Dialect must be explicitly set\n        at org.hibernate.dialect.DialectFactory.determineDialect(DialectFactory.java:59)\n        at org.hibernate.dialect.DialectFactory.buildDialect(DialectFactory.java:39)\n        at org.hibernate.cfg.SettingsFactory.determineDialect(SettingsFactory.java:426)\n        at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:128)\n        at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2073)\n        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1298)\n        at org.springframework.orm.hibernate3.LocalSessionFactoryBean.newSessionFactory(LocalSessionFactoryBean.java:860)\n        at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:779)\n        at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1477)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1417)\n        ... 44 more\n</code></pre>\n\n<p>i'm try to run firstFoundationClient but it have exception above</p>\n\n<pre><code>// locate the company home node\n//\nSearchService searchService = serviceRegistry.getSearchService();\nStoreRef storeRef = new StoreRef(StoreRef.PROTOCOL_WORKSPACE, \"SpacesStore\");\nResultSet resultSet = searchService.query(storeRef, SearchService.LANGUAGE_LUCENE,                   \"PATH:\\\"/app:company_home\\\"\");\nNodeRef companyHome = resultSet.getNodeRef(0);\nresultSet.close();\n</code></pre>\n\n<p>i want to use above code to search node in repository to show on alfresco page ,i'm  right?</p>\n\n<p>sorry in my English</p>\n\n<p>thank in advance</p>\n\n<p>and this is my Hibernate configuration</p>\n\n<pre><code>#\n# Hibernate configuration\n#\n\n# The Hibernate Dialect:\n#    As of V3.1, the dialect is automatically detected.\n#    It is still possible to set the dialect explicitly, for example:\n#       hibernate.dialect=org.hibernate.dialect.MySQLInnoDBDialect\n\nhibernate.jdbc.use_streams_for_binary=true\nhibernate.show_sql=false\nhibernate.cache.use_query_cache=false\nhibernate.max_fetch_depth=10\nhibernate.cache.provider_class=org.alfresco.repo.cache.InternalEhCacheManagerFactoryBean\nhibernate.cache.use_second_level_cache=true\nhibernate.default_batch_fetch_size=1\nhibernate.jdbc.batch_size=32\nhibernate.connection.release_mode=auto\nhibernate.connection.isolation=2\n\n#hibernate.query.substitutions=\n#hibernate.jdbc.use_get_generated_keys=false\n\n# Oracle Schema Distinction:\n#    See https://issues.alfresco.com/jira/browse/ETHREEOH-680\n#    Metadata queries to Oracle have to be limited by schema name\n#    when multiple instances of Alfresco are installed on an Oracle server.\n#hibernate.default_schema=\n</code></pre>\n"},{"tags":["java","hibernate","annotations","sql-server-2008-r2"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":107,"score":0,"question_id":12855810,"title":"Hibernate Criteria creates a '?' in the generated HSQL","body":"<p>I have created a sample web application. I am using MS SQL Server 2008 as database and hibernate + annotations to access the database. My hibernate configuration xml is as below.\nThe problem is, the Criteria.list() returns an empty list, and also I am seeing a '?' in the generated HSQL instead of the parameter I am passing in the Criteria.</p>\n\n<pre><code>&lt;session-factory name=\"\"&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;sun.jdbc.odbc.JdbcOdbcDriver&lt;/property&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServerDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:odbc:dbname&lt;/property&gt;\n\n    &lt;property name=\"connection.pool_size\"&gt;10&lt;/property&gt;\n    &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n\n    &lt;!-- Disable the second-level cache --&gt;\n    &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;       \n\n     &lt;!-- Echo all executed SQL to stdout --&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;       \n    &lt;property name=\"hibernate.connection.username\"&gt;&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;&lt;/property&gt;\n\n&lt;mapping class=\"com.demo.Person\" /&gt;\n&lt;/session-factory&gt;\n</code></pre>\n\n<p>This is my annotated bean</p>\n\n<pre><code>    @Entity\n    @Table(name = \"person\")\n    public class Person implements Serializable {\n\n        public Person(){\n\n        }\n        private static final long serialVersionUID = 1L;\n        @Id\n        @GeneratedValue(strategy=GenerationType.AUTO) \n        @Basic(optional = false)\n        @Column(name = \"personid\")\n        private Integer personid;\n\n        @Basic(optional = false)\n        @Column(name = \"firstname\")\n        private String firstname;\n\n        @Column(name = \"lastname\")\n        private String lastname;\n\n        @Basic(optional = false)\n        @Column(name = \"phone\")\n        private String phone;\n\n        @Column(name = \"mobile\")\n        private String mobile;\n\n        @Column(name = \"street\")\n        private String street;\n\n        @Basic(optional = false)\n        @Column(name = \"city\")\n        private String city;\n\n        @Basic(optional = false)\n        @Column(name = \"country\")\n        private String country;\n\n        @Basic(optional = false)\n        @Column(name = \"bussinessowner\")\n        private int bussinessowner;\n\n        @OneToMany(cascade = CascadeType.ALL, mappedBy = \"resultid1\")\n        private Collection&lt;Recent&gt; recentCollection;\n\n//setters &amp; getters\n}\n</code></pre>\n\n<p><strong>And the code I am running is</strong> </p>\n\n<pre><code>Session session;\n        List list = new ArrayList();\n        try{\n        session = HibernateUtil.getSessionFactory().openSession();\n        Criteria criteria = session.createCriteria(Person.class);\n        criteria.add(Restrictions.like(\"firstname\", name, MatchMode.START));\n        list= criteria.list();\n        System.out.println(list.size());\n\n        }catch (Exception e) {\n            e.printStackTrace();\n        }\n</code></pre>\n\n<p><strong>Generated HSQL :</strong> </p>\n\n<pre><code>Hibernate: select this_.personid as personid2_0_,  this_.city as city2_0_, this_.country as country2_0_, this_.firstname as firstname2_0_, this_.lastname as lastname2_0_ from person this_ where this_.firstname like ?\n</code></pre>\n\n<p>Other than this I am not getting any exception either. Can you please help me out with this.\nThanks !</p>\n"},{"tags":["java","mysql","hibernate","jaxbelement"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12888301,"title":"Exception: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Column 'dog_id' cannot be null","body":"<p>I have two entities with a parent-child relationship. Dog is the parent obviously and the Puppy is the child. How do I persist Dog-and-puppies without error?</p>\n\n<pre><code>@XmlRootElement(name = \"dog\")\n@Entity\n@Table(name = \"dog\", catalog = \"zoo\")\npublic class Dog{\n   @Id\n   @GeneratedValue(strategy = GenerationType.IDENTITY)\n   private Integer id;\n\n   @Column(name = \"dogname\")\n   private String dogName;\n\n   @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = \"Dog\")\n   private Set&lt;Puppy&gt; puppies;\n\n   ...// getters and setters\n\n   @XmlElementWrapper(name = \"puppies\")\n   @XmlElement(name = \"puppy\")\n   public Set&lt;Puppy&gt; getPuppy() {\n      return this.puppies;\n   }\n}\n\n@Entity\n@Table(name = \"puppy\", catalog = \"zoo\")\npublic class Puppy{\n   @Id\n   @GeneratedValue(strategy = GenerationType.IDENTITY)\n   private Integer id;\n\n   @Column(name = \"puppyname\")\n   private String puppyName;\n\n   @ManyToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = \"dog_id\", nullable = false)\n   private Dog dog;\n\n       ...// getters and setters\n}\n</code></pre>\n\n<p>Basically a user passes in a Dog -- with it's puppies -- as a jaxbElement.</p>\n\n<pre><code>@POST\n@Consumes({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})\n@Produces({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})\npublic Response createDog(JAXBElement&lt;Dog&gt; jaxbDog) {\n    Dog dog = jaxbDog.getValue();\n   dogDao.save(dog);\n    return Response.status(Response.Status.OK).build();\n}\n</code></pre>\n\n<p>My question, again, is how do I get the puppies to see the dog_id of the parent dog?</p>\n"},{"tags":["java","hibernate","java-ee","jboss","jboss7.x"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":204,"score":1,"question_id":12871901,"title":"javax.naming.NamingException: JBAS011843: Failed instantiate InitialContextFactory org.jnp.interfaces.NamingContextFactory from classloader","body":"<p>Hi every one i face some problem in Jboss-as-7.1.1.\nI properly deploy but when i send the request from client side i am getting error.\nI am using Jboss-7.1.1, deployment folder is standalone/deployment (<code>axis2.war,response.war,SpSpecific.ear,responsecomponet.ear</code>)</p>\n\n<p><strong>Deployment log:-</strong></p>\n\n<pre><code>13:00:51,457 INFO  [org.jboss.modules] JBoss Modules version 1.1.1.GA\n13:00:52,261 INFO  [org.jboss.msc] JBoss MSC version 1.0.2.GA\n13:00:52,381 INFO  [org.jboss.as] JBAS015899: JBoss AS 7.1.1.Final \"Brontes\" starting\n13:00:55,285 INFO  [org.jboss.as.server] JBAS015888: Creating http management service using socket-binding (management-http)\n13:00:55,288 INFO  [org.xnio] XNIO Version 3.0.3.GA\n13:00:55,362 INFO  [org.xnio.nio] XNIO NIO Implementation Version 3.0.3.GA\n13:00:55,416 INFO  [org.jboss.remoting] JBoss Remoting version 3.2.3.GA\n13:00:55,521 INFO  [org.jboss.as.logging] JBAS011502: Removing bootstrap log handlers\n13:00:55,595 INFO  [org.jboss.as.configadmin] (ServerService Thread Pool -- 26) JBAS016200: Activating ConfigAdmin Subsystem\n13:00:55,714 INFO  [org.jboss.as.osgi] (ServerService Thread Pool -- 39) JBAS011940: Activating OSGi Subsystem\n13:00:55,780 INFO  [org.jboss.as.webservices] (ServerService Thread Pool -- 48) JBAS015537: Activating WebServices Extension\n13:00:55,721 INFO  [org.jboss.as.security] (ServerService Thread Pool -- 44) JBAS013101: Activating Security Subsystem\n13:00:55,699 INFO  [org.jboss.as.naming] (ServerService Thread Pool -- 38) JBAS011800: Activating Naming Subsystem\n13:00:55,637 INFO  [org.jboss.as.clustering.infinispan] (ServerService Thread Pool -- 31) JBAS010280: Activating Infinispan subsystem.\n13:00:55,951 INFO  [org.jboss.as.security] (MSC service thread 1-3) JBAS013100: Current PicketBox version=4.0.7.Final\n13:00:56,121 INFO  [org.jboss.as.connector] (MSC service thread 1-1) JBAS010408: Starting JCA Subsystem (JBoss IronJacamar 1.0.9.Final)\n13:00:56,134 INFO  [org.jboss.as.connector.subsystems.datasources] (ServerService Thread Pool -- 27) JBAS010403: Deploying JDBC-compliant driver class org.h2.Driver (version 1.3)\n13:00:56,236 INFO  [org.jboss.as.naming] (MSC service thread 1-3) JBAS011802: Starting Naming Service\n13:00:56,301 INFO  [org.jboss.as.mail.extension] (MSC service thread 1-1) JBAS015400: Bound mail session [java:jboss/mail/Default]\n13:00:56,672 INFO  [org.jboss.ws.common.management.AbstractServerConfig] (MSC service thread 1-4) JBoss Web Services - Stack CXF Server 4.0.2.GA\n13:00:57,092 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-3) Starting Coyote HTTP/1.1 on http--127.0.0.1-8080\n13:00:57,940 WARN  [com.arjuna.ats.arjuna] (Transaction Expired Entry Monitor) ARJUNA012210: Unable to use InetAddress.getLocalHost() to resolve address.\n13:00:58,202 INFO  [org.jboss.as.remoting] (MSC service thread 1-2) JBAS017100: Listening on /127.0.0.1:9999\n13:00:58,209 INFO  [org.jboss.as.remoting] (MSC service thread 1-1) JBAS017100: Listening on /127.0.0.1:4447\n13:00:58,309 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-2) JBAS015012: Started FileSystemDeploymentService for directory /home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/deployments\n13:00:58,580 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-4) JBAS010400: Bound data source [java:jboss/datasources/ExampleDS]\n13:00:58,676 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015876: Starting deployment of \"SPAppSpecific.ear\"\n13:00:58,679 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015876: Starting deployment of \"response.war\"\n13:00:58,682 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015876: Starting deployment of \"responsecomponent.ear\"\n13:00:58,685 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015876: Starting deployment of \"axis2.war\"\n13:01:00,257 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015876: Starting deployment of \"SPAppSpecific.jar\"\n13:01:01,040 INFO  [org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor] (MSC service thread 1-4) JNDI bindings for session bean named SPConnectorClient in deployment unit subdeployment \"SPAppSpecific.jar\" of deployment \"SPAppSpecific.ear\" are as follows:\n\n    java:global/SPAppSpecific/SPAppSpecific/SPConnectorClient!com.cdac.sp.SPConnectorClientRemote\n    java:app/SPAppSpecific/SPConnectorClient!com.cdac.sp.SPConnectorClientRemote\n    java:module/SPConnectorClient!com.cdac.sp.SPConnectorClientRemote\n    java:jboss/exported/SPAppSpecific/SPAppSpecific/SPConnectorClient!com.cdac.sp.SPConnectorClientRemote\n    java:global/SPAppSpecific/SPAppSpecific/SPConnectorClient!com.cdac.sp.SPConnectorClientHome\n    java:app/SPAppSpecific/SPConnectorClient!com.cdac.sp.SPConnectorClientHome\n    java:module/SPConnectorClient!com.cdac.sp.SPConnectorClientHome\n    java:jboss/exported/SPAppSpecific/SPAppSpecific/SPConnectorClient!com.cdac.sp.SPConnectorClientHome\n\n13:01:03,587 INFO  [org.jboss.web] (MSC service thread 1-2) JBAS018210: Registering web context: /response\n13:01:06,298 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry xpp3.jar in \"/content/axis2.war/WEB-INF/lib/jibx-run-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,302 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry stax-api.jar in \"/content/axis2.war/WEB-INF/lib/jibx-run-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,304 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry wstx-asl.jar in \"/content/axis2.war/WEB-INF/lib/jibx-run-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,307 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry jaxws-rt.jar in \"/content/axis2.war/WEB-INF/lib/jaxws-tools-2.1.3.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,311 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry jaxb-xjc.jar in \"/content/axis2.war/WEB-INF/lib/jaxws-tools-2.1.3.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,314 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry relaxngDatatype.jar in \"/content/axis2.war/WEB-INF/lib/jaxws-tools-2.1.3.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,323 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry bcel.jar in \"/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,325 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry jibx-run.jar in \"/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,332 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry xpp3.jar in \"/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,339 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry stax-api.jar in \"/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,342 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry wstx-asl.jar in \"/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,354 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry jaxb-api.jar in \"/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,358 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry activation.jar in \"/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,362 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry jsr173_1.0_api.jar in \"/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,365 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry jaxb1-impl.jar in \"/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,370 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry activation.jar in \"/content/axis2.war/WEB-INF/lib/mail-1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,373 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry xercesImpl.jar in \"/content/axis2.war/WEB-INF/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,376 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry xml-apis.jar in \"/content/axis2.war/WEB-INF/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:06,379 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-3) Class Path entry serializer.jar in \"/content/axis2.war/WEB-INF/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:07,151 WARN  [org.apache.axiom.util.stax.dialect.StAXDialectDetector] (MSC service thread 1-3) Unable to determine dialect of the StAX implementation at jar:file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/jboss-modules.jar!/\n13:01:07,588 INFO  [org.apache.axis2.deployment.ClusterBuilder] (MSC service thread 1-3) Clustering has been disabled\n13:01:08,140 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: metadataExchange-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/mex-1.6.1.mar\n13:01:08,343 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: addressing-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/addressing-1.6.1.mar\n13:01:08,383 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: ping-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/ping-1.6.1.mar\n13:01:08,434 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: mtompolicy-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/mtompolicy-1.6.1.mar\n13:01:08,460 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: soapmonitor-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/soapmonitor-1.6.1.mar\n13:01:08,489 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: script-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/scripting-1.6.1.mar\n13:01:08,518 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-3) Deploying module: jaxws-1.6.1 - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/modules/axis2-jaxws-mar-1.6.1.mar\n13:01:08,541 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb-api.jar in \"/content/responsecomponent.ear/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,543 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb-impl.jar in \"/content/responsecomponent.ear/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,549 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jsr173_1.0_api.jar in \"/content/responsecomponent.ear/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,561 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry activation.jar in \"/content/responsecomponent.ear/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,584 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb-api.jar in \"/content/responsecomponent.ear/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,586 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry activation.jar in \"/content/responsecomponent.ear/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,591 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jsr173_1.0_api.jar in \"/content/responsecomponent.ear/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,594 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb1-impl.jar in \"/content/responsecomponent.ear/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,605 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry bcel.jar in \"/content/responsecomponent.ear/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,609 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jibx-run.jar in \"/content/responsecomponent.ear/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,615 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xpp3.jar in \"/content/responsecomponent.ear/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,618 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry stax-api.jar in \"/content/responsecomponent.ear/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,626 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry wstx-asl.jar in \"/content/responsecomponent.ear/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,629 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xercesImpl.jar in \"/content/responsecomponent.ear/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,636 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xml-apis.jar in \"/content/responsecomponent.ear/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,638 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry serializer.jar in \"/content/responsecomponent.ear/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,644 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry activation.jar in \"/content/responsecomponent.ear/lib/mail-1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,653 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xpp3.jar in \"/content/responsecomponent.ear/lib/jibx-run-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,664 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry stax-api.jar in \"/content/responsecomponent.ear/lib/jibx-run-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,666 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry wstx-asl.jar in \"/content/responsecomponent.ear/lib/jibx-run-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n13:01:08,682 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015876: Starting deployment of \"AsyncResponseComponentVer2.jar\"\n13:01:09,008 INFO  [org.apache.axis2.deployment.DeploymentEngine] (MSC service thread 1-3) Deploying Web service: version-1.6.1.aar - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/services/version-1.6.1.aar\n13:01:09,017 INFO  [org.jboss.as.ejb3.deployment.processors.EjbJndiBindingsDeploymentUnitProcessor] (MSC service thread 1-1) JNDI bindings for session bean named SPConnectorResponseComponent in deployment unit subdeployment \"AsyncResponseComponentVer2.jar\" of deployment \"responsecomponent.ear\" are as follows:\n\n    java:global/responsecomponent/AsyncResponseComponentVer2/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBHome\n    java:app/AsyncResponseComponentVer2/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBHome\n    java:module/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBHome\n    java:jboss/exported/responsecomponent/AsyncResponseComponentVer2/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBHome\n    java:global/responsecomponent/AsyncResponseComponentVer2/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBRemote\n    java:app/AsyncResponseComponentVer2/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBRemote\n    java:module/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBRemote\n    java:jboss/exported/responsecomponent/AsyncResponseComponentVer2/SPConnectorResponseComponent!com.cdac.AsyncSPResponse.SPResponseEJBRemote\n\n13:01:10,743 INFO  [org.apache.axis2.deployment.DeploymentEngine] (MSC service thread 1-3) Deploying Web service: SPGenericConnectorVer2.aar - file:/home/vivekray/Desktop/vivek/jboss-as-7.1.1.Final/standalone/tmp/vfs/tempdbc1c5c22e866d3/axis2.war-82ac321f1e9789b1/WEB-INF/services/SPGenericConnectorVer2.aar\n13:01:10,784 INFO  [org.jboss.web] (MSC service thread 1-3) JBAS018210: Registering web context: /axis2\n13:01:10,800 INFO  [org.jboss.as] (MSC service thread 1-2) JBAS015951: Admin console listening on http://127.0.0.1:9990\n13:01:10,802 INFO  [org.jboss.as] (MSC service thread 1-2) JBAS015874: JBoss AS 7.1.1.Final \"Brontes\" started in 20009ms - Started 323 of 410 services (86 services are passive or on-demand)\n13:01:10,981 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS018559: Deployed \"SPAppSpecific.ear\"\n13:01:10,984 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS018559: Deployed \"response.war\"\n13:01:10,986 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS018559: Deployed \"responsecomponent.ear\"\n13:01:10,989 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS018559: Deployed \"axis2.war\"\n</code></pre>\n\n<p><strong>Error Log is:-</strong> </p>\n\n<pre><code>13:01:57,692 INFO  [stdout] (http--127.0.0.1-8080-1) BusinessClass::sendResponse Starts...\n13:01:57,712 ERROR [stderr] (http--127.0.0.1-8080-1) javax.naming.NamingException: JBAS011843: Failed instantiate InitialContextFactory org.jnp.interfaces.NamingContextFactory from classloader ModuleClassLoader for Module \"deployment.response.war:main\" from Service Module Loader\n13:01:57,735 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.jboss.as.naming.InitialContextFactoryBuilder.createInitialContextFactory(InitialContextFactoryBuilder.java:64)\n13:01:57,737 ERROR [stderr] (http--127.0.0.1-8080-1)    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:664)\n13:01:57,739 ERROR [stderr] (http--127.0.0.1-8080-1)    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)\n13:01:57,744 ERROR [stderr] (http--127.0.0.1-8080-1)    at javax.naming.InitialContext.init(InitialContext.java:223)\n13:01:57,746 ERROR [stderr] (http--127.0.0.1-8080-1)    at javax.naming.InitialContext.&lt;init&gt;(InitialContext.java:197)\n13:01:57,747 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.jsp.response_jsp._jspService(response_jsp.java:116)\n13:01:57,749 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n13:01:57,763 ERROR [stderr] (http--127.0.0.1-8080-1)    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n13:01:57,772 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369)\n13:01:57,774 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:326)\n13:01:57,775 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:253)\n13:01:57,777 ERROR [stderr] (http--127.0.0.1-8080-1)    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)\n13:01:57,778 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329)\n13:01:57,793 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248)\n13:01:57,794 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275)\n13:01:57,808 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)\n13:01:57,815 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153)\n13:01:57,817 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)\n13:01:57,822 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n13:01:57,829 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n13:01:57,831 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368)\n13:01:57,832 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877)\n13:01:57,833 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671)\n13:01:57,838 ERROR [stderr] (http--127.0.0.1-8080-1)    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930)\n13:01:57,839 ERROR [stderr] (http--127.0.0.1-8080-1)    at java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n<p><strong>Here  is my Code:-</strong></p>\n\n<pre><code>System.out.println(\"BusinessClass::sendResponse Starts...\");\n    HashMap ack_gateway=null;\n    try {\n        p.setProperty(\"java.naming.factory.initial\",\n                    \"org.jnp.interfaces.NamingContextFactory\");\n        p.setProperty(\"java.naming.factory.url.pkgs\",\n                    \"org.jboss.naming:org.jnp.interfaces\");\n        p.setProperty(\"java.naming.provider.url\", \"localhost:1099\");\n        Context ctx = new InitialContext(p);\n        System.out.println(\"Got Initial Context\");\n        SPResponseEJBHome home = (SPResponseEJBHome)\n            PortableRemoteObject.narrow(ctx.lookup\n                       \"SPConnectorResponseComponent\"),SPResponseEJBHome.class);\n        //SPResponseEJBHome home = (SPResponseEJBHome) \n              ctx.lookup(\"SPConnectorResponseComponent\");\n        System.out.println(\"BusinessClass::sendResponse Starts...\");\n\n        System.out.println(\"Got Home object\");\n        SPResponseEJBRemote remote = home.create();\n        System.out.println(\"Got Remote object\");\n\n        //process\n            System.out.println(\"Hi 1\");\n        String targetEndPoint=(String)request.getParameter(\"targetEndPoint\");\n\n        String classid=(String)request.getParameter(\"classid\");\n\n        String corelationid=(String)request.getParameter(\"corelationid\");\n\n        String transactionID=(String)request.getParameter(\"TransactionID\");\n\n        String result=(String)request.getParameter(\"result\");\n            Object resxml = null;\n        resxml = XmlObject.Factory.parse(result.toString().trim());\n            System.out.println(\"Hi 2\");\n        CommitResponse commitResponse=new CommitResponse();\n        commitResponse.setTargetEndPointURL(targetEndPoint);\n        commitResponse.setTransactionId(transactionID);\n        commitResponse.setCorrelationId(corelationid);\n        commitResponse.setClassId(classid);\n        commitResponse.setResponseType(ResponseType.RESPONSE);\n        commitResponse.setMessageBody(resxml);\n        System.out.println(\"calling EJB\");\n        System.out.println(\"Hi 3\");\n        ReturnResponse returnResponse = new ReturnResponse();\n        returnResponse=remote.makeSubmitResponse(commitResponse);\n        System.out.println(\"Hi 4\");\n        //STATUS=RESUBMIT\n        if (returnResponse.getStatus().equals(RequestStatus.RESUBMIT))\n        {\n        System.out.println(\"status: \"+returnResponse.getStatus());\n        System.out.println(\"Reason:\"+returnResponse.getReason());\n        }\n        //STATUS=FAILED\n        else if (returnResponse.getStatus().equals(RequestStatus.FAILED))\n        {\n        System.out.println(\"i am end of exec\"+ returnResponse.getStatus());\n        String[] erorResponse= returnResponse.getErrors();\n        for(int i=0;i&lt;erorResponse.length;i++)\n        {\n        System.out.println(\"printing error  :\"+erorResponse[i] );\n        }\n        }\n\n        // Status =SUCESS\n        else if (returnResponse.getStatus().equals(RequestStatus.SUCCESS))\n        {\n        out.println(\"status    :\"+ returnResponse.getStatus());\n        out.println(\"correlationId    :\"+ returnResponse.getCorrelationId());\n        out.println(\"TransactionID    :\"+ returnResponse.getTransactionId());\n        out.println(\"AuditID   :\"+ eturnResponse.getAuditId());         \n        }               \n\n\n} catch (Exception e) {\n        e.printStackTrace();\n    }\n</code></pre>\n\n<p>Any one have idea what is the problem please help me.</p>\n\n<p>Thanx</p>\n"},{"tags":["java","spring","hibernate","jpa"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":12850986,"title":"Getting parent from child using JPA","body":"<p>I have a phone object and a phone history object. I'd like to be able to retrieve a phone history object and then get its parent (phone), but for some reason, when I attempt to do this and then persist the child, I get an exception saying that phone_id isn't populated. Not sure how to fix this, although I suspect it has something to do with my mapping annotations. </p>\n\n<p>Below are my entity classes. I've tried changing the annotations to match the suggestion in the bidirectional relationships section here: <a href=\"http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html#entity-mapping-association\" rel=\"nofollow\">http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/entity.html#entity-mapping-association</a> but this didn't seem to do the trick. I'm new to JPA, so this is probably simple for someone with more experience, but I'm stumped. TIA.</p>\n\n<p>Phone entity:</p>\n\n<pre><code>package com.blah.model;\n\nimport java.util.ArrayList;\nimport java.util.Calendar;\nimport java.util.List;\n\nimport javax.persistence.CascadeType;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.FetchType;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.ManyToOne;\nimport javax.persistence.OneToMany;\nimport javax.persistence.Table;\nimport javax.persistence.Temporal;\nimport javax.persistence.TemporalType;\n\n@Entity\n@Table(name = \"phones\")\npublic class EPhone implements BaseModel {\n\n    private static final long serialVersionUID = 3497994786207995664L;\n\n    @Id\n    @GeneratedValue\n    @Column(name = \"id\")\n    private Long id;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"account_id\",\n            nullable = false)\n    private EAccount account;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    private Calendar created;\n\n    @Column(name = \"value\",\n        nullable = false)\n        private Long value;\n\n    @OneToMany(fetch = FetchType.LAZY,\n            mappedBy = \"phone\",\n            cascade = CascadeType.ALL)\n    private final List&lt;EPhoneHistory&gt; history;\n\n    public EPhone() {\n        this(Calendar.getInstance());\n    }\n\n    public EPhone(final Calendar createdDate) {\n        setCreated(createdDate);\n        history = new ArrayList&lt;EPhoneHistory&gt;();\n    }\n\n    public void add(EPhoneHistory phoneHistoryItem) {\n        history.add(phoneHistoryItem);\n    }\n\n    public EAccount getAccount() {\n        return account;\n    }\n\n    public Calendar getCreated() {\n        return created;\n    }\n\n    @OneToMany(fetch = FetchType.LAZY,\n            mappedBy = \"phone\",\n            cascade = CascadeType.ALL)\n    public List&lt;EPhoneHistory&gt; getHistory() {\n        return history;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public Long getValue() {\n        return value;\n    }\n\n    public void setAccount(EAccount account) {\n        this.account = account;\n    }\n\n    public void setCreated(Calendar created) {\n        this.created = created;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public void setValue(Long value) {\n        this.value = value;\n    }\n\n}\n</code></pre>\n\n<p>Phone History entity:</p>\n\n<pre><code>package com.blah.model;\n\nimport java.util.Calendar;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.EnumType;\nimport javax.persistence.Enumerated;\nimport javax.persistence.FetchType;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.ManyToOne;\nimport javax.persistence.Table;\nimport javax.persistence.Temporal;\nimport javax.persistence.TemporalType;\n\n@Entity\n@Table(name = \"phone_history\")\npublic class EPhoneHistory implements BaseModel {\n\n    private static final long serialVersionUID = 4591314258588732076L;\n\n    @Id\n    @GeneratedValue\n    @Column(name = \"id\")\n    private Long Id;\n\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"phone_id\",\n            nullable = false)\n    private EPhone phone;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    private Calendar created;\n\n    @Enumerated(EnumType.ORDINAL)\n    @Column(name = \"type_id\")\n    private PhoneHistoryType type;\n\n    public Calendar getCreated() {\n        return created;\n    }\n\n    public Long getId() {\n        return Id;\n    }\n\n    public EPhone getPhone() {\n        return phone;\n    }\n\n    public PhoneHistoryType getType() {\n        return type;\n    }\n\n    public void setCreated(Calendar created) {\n        this.created = created;\n    }\n\n    public void setId(Long id) {\n        Id = id;\n    }\n\n    public void setPhone(EPhone phone) {\n        this.phone = phone;\n    }\n\n    public void setType(PhoneHistoryType type) {\n        this.type = type;\n    }\n\n}\n</code></pre>\n\n<p><strong>UPDATE for clarification (this is a test that fails):</strong></p>\n\n<pre><code>package com.blah.model.repository;\n\nimport org.junit.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.transaction.annotation.Transactional;\n\nimport com.blah.AbstractBaseDbTestCase;\nimport com.blah.model.EPhoneHistory;\nimport com.blah.model.PhoneHistoryType;\n\npublic class PhoneHistoryRepositoryTest extends AbstractBaseDbTestCase {\n\n    @Autowired\n    PhoneHistoryRepository phoneHistoryRepo;\n\n    @Test\n    @Transactional\n    public void testCreateAndSavePhoneHistory() {\n\n        EPhoneHistory existingPhoneHistory = phoneHistoryRepo.find(1L);\n\n        EPhoneHistory newPhoneHistory = new EPhoneHistory();\n        newPhoneHistory.setType(PhoneHistoryType.VOICE);\n\n        // I assume this is where I would\n        // set the phone, but I don't have it.\n        // existingPhoneHistory.setPhone(phone);\n\n        // This is what I'm having trouble with. getPhone() doesn't populate the\n        // phone field with the parent phone object.\n        existingPhoneHistory.getPhone().add(newPhoneHistory);\n\n        phoneHistoryRepo.persist(existingPhoneHistory);\n        phoneHistoryRepo.flush();\n    }\n}\n</code></pre>\n\n<p>And the failure stack trace:</p>\n\n<pre><code>org.springframework.dao.DataIntegrityViolationException: NULL not allowed for column \"PHONE_ID\"; SQL statement:\ninsert into phone_history (id, created, phone_id, type_id) values (null, ?, ?, ?) [23502-168]; SQL [n/a]; constraint [null]; nested exception is org.hibernate.exception.ConstraintViolationException: NULL not allowed for column \"PHONE_ID\"; SQL statement:\ninsert into phone_history (id, created, phone_id, type_id) values (null, ?, ?, ?) [23502-168]\n    at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:643)\n    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:104)\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:403)\n    at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:58)\n    at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:213)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:163)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)\n    at com.blah.model.repository.PhoneHistoryRepository$$EnhancerByCGLIB$$4f90cdde.flush(&lt;generated&gt;)\n    at com.blah.model.repository.PhoneHistoryRepositoryTest.testCreateAndSavePhoneHistory(PhoneHistoryRepositoryTest.java:29)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)\n    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)\n    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)\n    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: org.hibernate.exception.ConstraintViolationException: NULL not allowed for column \"PHONE_ID\"; SQL statement:\ninsert into phone_history (id, created, phone_id, type_id) values (null, ?, ?, ?) [23502-168]\n    at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:128)\n    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:129)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81)\n    at $Proxy37.executeUpdate(Unknown Source)\n    at org.hibernate.id.IdentityGenerator$GetGeneratedKeysDelegate.executeAndExtract(IdentityGenerator.java:96)\n    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:58)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2870)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3381)\n    at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:81)\n    at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362)\n    at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:203)\n    at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:183)\n    at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:167)\n    at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:320)\n    at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:287)\n    at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193)\n    at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126)\n    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:78)\n    at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:208)\n    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:151)\n    at org.hibernate.internal.SessionImpl.firePersistOnFlush(SessionImpl.java:870)\n    at org.hibernate.internal.SessionImpl.persistOnFlush(SessionImpl.java:863)\n    at org.hibernate.engine.spi.CascadingAction$8.cascade(CascadingAction.java:346)\n    at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:380)\n    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:323)\n    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)\n    at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:409)\n    at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:350)\n    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326)\n    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)\n    at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165)\n    at org.hibernate.event.internal.AbstractFlushingEventListener.cascadeOnFlush(AbstractFlushingEventListener.java:160)\n    at org.hibernate.event.internal.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:151)\n    at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:88)\n    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)\n    at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1214)\n    at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:986)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)\n    at $Proxy32.flush(Unknown Source)\n    at com.blah.model.repository.AbstractRepository.flush(AbstractRepository.java:41)\n    at com.blah.model.repository.AbstractRepository$$FastClassByCGLIB$$1ba8d45c.invoke(&lt;generated&gt;)\n    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)\n    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)\n    ... 36 more\nCaused by: org.h2.jdbc.JdbcSQLException: NULL not allowed for column \"PHONE_ID\"; SQL statement:\ninsert into phone_history (id, created, phone_id, type_id) values (null, ?, ?, ?) [23502-168]\n    at org.h2.message.DbException.getJdbcSQLException(DbException.java:329)\n    at org.h2.message.DbException.get(DbException.java:169)\n    at org.h2.message.DbException.get(DbException.java:146)\n    at org.h2.table.Column.validateConvertUpdateSequence(Column.java:293)\n    at org.h2.table.Table.validateConvertUpdateSequence(Table.java:689)\n    at org.h2.command.dml.Insert.insertRows(Insert.java:120)\n    at org.h2.command.dml.Insert.update(Insert.java:84)\n    at org.h2.command.CommandContainer.update(CommandContainer.java:75)\n    at org.h2.command.Command.executeUpdate(Command.java:230)\n    at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:156)\n    at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:142)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122)\n    ... 83 more\n</code></pre>\n"},{"tags":["java","hibernate","cascade"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2972,"score":0,"question_id":5157853,"title":"Hibernate: How use cascade in annotation?","body":"<h2>How can I use cascade and annotations in hibernate ?</h2>\n\n<p>But I stay with a doubt:</p>\n\n<p>I have this situation:</p>\n\n<pre><code>public class Package(){\n  @OneToOne(cascade=CascadeType.PERSIST)\n  private Product product;\n\n  @OneToOne(cascade=CascadeType.PERSIST)\n  private User user;\n  ..\n}\n</code></pre>\n\n<p>When I try to <code>session.save(package)</code>, an error occurs.\nI don't want to save product and package, just initialize then and set them into my package object.</p>\n\n<p>Is that possible ?</p>\n"},{"tags":["java","hibernate","session","orm","criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12863410,"title":"Do you need to commit/close a session after doing a Criteria query in Hibernate?","body":"<p>I have a code that looks like this:</p>\n\n<pre><code>Session session = MySessionFactory.createSession();\nsession.beginTransaction();\nCriteria cq = session.createCriteria(clazz);\n// Do stuff.\nList list = cq.list();\nsession.getTransaction().commit();\nsession.close();\n</code></pre>\n\n<p>Do I actually need the beginTransaction(), commit(), and close()?</p>\n\n<p>I heard in JPA, CriteriaQuery (as opposed to Criteria) does not require active transaction management.</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":12730554,"title":"Updating hibernate associations","body":"<p>I am creating RESTful Web Service. Client is allowed to register <code>Company</code> and then update it if needed. <code>Company</code> has <code>Address</code> association. When user request <code>Company</code> update it sends <code>Company</code> object id and <code>Company</code> involving <code>Address</code> object without <code>Address</code>es id. To update <code>Company</code> object I use hibernate <code>merge</code> method. It sets correctly new <code>Company</code> data but it creates new <code>Address</code> row instead of updating it. </p>\n\n<p>How can I solve this problem?</p>\n\n<p>I could fetch <code>Address</code> by <code>company.getAddress()</code> get it's id and merge new <code>Address</code> but when I do that all <code>Company</code> data is being fetched, which I think is not good. </p>\n\n<pre><code>    public class Company implements Serializable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private Long id;\n    @OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)\n    @JoinColumn(name = \"address_id\")\n    private Address address;\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I could also write a custom query</p>\n\n<pre><code>UPDATE address SET city='NEW YORK' FROM companies WHERE address.id = companies.address_id\n</code></pre>\n\n<p>but I want it to be a default action. If you see any association without id use the above query.</p>\n"},{"tags":["java","hibernate","orm","tree","hbm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12886389,"title":"Hibernate: shuffling child nodes in a bidirectional ordered tree","body":"<p>I have a basic tree structure composed of a simple <code>Node</code> class, linking bidirectionally to it's single parent <em>(can be null for root nodes)</em> and an ordered list of children:</p>\n\n<pre><code>public class Node {\n    private Integer xid;\n    private Node parent;\n    private List&lt;Node&gt; children;\n    // getters and setters...\n}\n</code></pre>\n\n<p>I map this using hibernate to the following simple database table:</p>\n\n<pre><code> &gt; select * from node;\n xid | parent | xorder \n-----+--------+--------\n   1 |   NULL |      0\n   2 |      1 |      0\n   3 |      1 |      1\n   4 |      1 |      2\n(4 rows)\n</code></pre>\n\n<p>Using the following <code>.hbm</code> hibernate mapping file:</p>\n\n<pre><code>&lt;class name=\"Node\" table=\"node\"&gt;\n    &lt;id name=\"xid\" type=\"int\"&gt;\n        &lt;generator class=\"native\" /&gt;\n    &lt;/id&gt;\n    &lt;many-to-one name=\"parent\" /&gt;\n    &lt;list name=\"children\" table=\"node\"&gt;\n        &lt;key column=\"parent\" /&gt;\n        &lt;list-index column=\"xorder\" /&gt;\n        &lt;one-to-many class=\"Node\" /&gt;\n    &lt;/list&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>However, when I try to shuffle elements order within one parent using the following code:</p>\n\n<pre><code>@Transactional\npublic void testNode() {\n    Node parent = (Node) getSession().get(Node.class, 1);\n    Node child0 = parent.getChildren().remove(0);\n    parent.getChildren().add(1, child0); // Swap first and second child\n    getSession().update(parent);\n}\n</code></pre>\n\n<p>I get an exception when hibernate flush the transaction: (<code>org.hibernate.exception.ConstraintViolationException ... set parent=null, xorder=null where parent='1' and xid='2'</code>): basically the update try to set <code>xorder</code> to <code>null</code>, which is obviously forbidden by the database schema. </p>\n\n<p>I tried many combination on the hbm mapping, with no success. When I set the <code>&lt;list&gt;</code> to <code>inverse=\"true\"</code> hibernate does not do any update, setting <code>insert=\"false\" update=\"false\"</code> on the <code>&lt;many-to-one&gt;</code> element does not help neither.</p>\n\n<p>I probably miss something here, either in the <code>hbm</code> mapping or in my code, my feeling is that it should be pretty obvious... Any idea?</p>\n"},{"tags":["database","oracle","hibernate","jdbc","websphere-6.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3071,"score":0,"question_id":1677722,"title":"Websphere Application Server Data Source","body":"<p>We are facing a strange problem with Websphere Application Server Data Source.</p>\n\n<p><strong>Environment:</strong></p>\n\n<ul>\n<li>Websphere Application Server (6.1)</li>\n<li>Linux</li>\n<li>Liferay Portal (5.2)</li>\n<li>Oracle 9i</li>\n<li>Hibernate 3.0</li>\n</ul>\n\n<p>We have datasource deployed in Application server referencing <code>ODBC14.jar</code></p>\n\n<p>Hibernate Configuration for Datasource:</p>\n\n<pre><code>&lt;property name=\"connection.datasource\"&gt;jdbc/appDB&lt;/property&gt;\n&lt;property name=\"jndi.class\"&gt;com.ibm.websphere.naming.WsnInitialContextFactory&lt;/property&gt;\n&lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.Oracle9Dialect&lt;/property&gt;\n&lt;property name=\"connection.autocommit\"&gt;false&lt;/property&gt;\n</code></pre>\n\n<p>We are getting following exception:</p>\n\n<blockquote>\n  <p>Caused by: java.sql.SQLException:\n  DSRA8101E: DataSource class cannot be\n  used as one-phase: ClassCastException:\n  oracle.jdbc.pool.OracleConnectionPoolDataSource\n  incompatible with\n  javax.sql.ConnectionPoolDataSource  at\n  com.ibm.ws.rsadapter.AdapterUtil.toSQLException(AdapterUtil.java:1375)\n  at\n  com.ibm.ws.rsadapter.jdbc.WSJdbcDataSource.getConnection(WSJdbcDataSource.java:462)\n  at\n  com.ibm.ws.rsadapter.jdbc.WSJdbcDataSource.getConnection(WSJdbcDataSource.java:418)\n  at\n  org.hibernate.connection.DatasourceConnectionProvider.getConnection(DatasourceConnectionProvider.java:69)\n  at\n  org.hibernate.jdbc.ConnectionManager.openConnection</p>\n</blockquote>\n\n<p>We've tried the following workaround\nCame to know <strong>classes12.jar was there in WEB-INF/lib</strong> \nWhich has ORACLE Driver which can cause Class Loading conflict with Shared/apps/lib ODBC14.jar</p>\n\n<p>So removed classes12.jar from Web application Lib and redeployed application and restarted, but got same error again. Any idea on how to resolve this?</p>\n"},{"tags":["java","spring","hibernate","junit4"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12886401,"title":"Testing Spring 3.0.1 with JUnit throws Error during test","body":"<p>I would like to test my <strong>Spring MVC 3.0.1</strong> application using *<em>junit-4.10.</em>*jar\nI am also using Hibernate(I dont know if it is relevant)</p>\n\n<p>here is the test class:</p>\n\n<pre><code>package net.controller;\nimport static org.junit.Assert.assertNotNull;\nimport net.service.WordService;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\nimport org.springframework.transaction.annotation.Transactional;\n\n@Transactional\n@ContextConfiguration(locations = { \"/spring-servlet.xml\" })\n@RunWith(SpringJUnit4ClassRunner.class)\npublic class NewWordControllerTest {\n\n    @Autowired\n    private WordService wordService;\n\n    @Test\n    public void testController() {\n        assertNotNull(wordService);\n    }\n\n}\n</code></pre>\n\n<p>But it gives me the following error:</p>\n\n<pre><code>java.lang.NoSuchMethodError: org.junit.runner.notification.RunNotifier.testAborted(Lorg/junit/runner/Description;Ljava/lang/Throwable;)V\n</code></pre>\n\n<p>After quite a long googling I'm still have no idea how to solve the issue.\nhere is spring-servlet.xml</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:mvc=\"http://www.springframework.org/schema/mvc\"\n    xsi:schemaLocation=\"\nhttp://www.springframework.org/schema/beans\nhttp://www.springframework.org/schema/beans/spring-beans-3.0.xsd\nhttp://www.springframework.org/schema/context\nhttp://www.springframework.org/schema/context/spring-context-3.0.xsd\nhttp://www.springframework.org/schema/tx\nhttp://www.springframework.org/schema/tx/spring-tx-3.0.xsd\nhttp://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd\"&gt;\n\n    &lt;context:property-placeholder location=\"classpath:jdbc.properties\" /&gt;\n    &lt;context:component-scan base-package=\"net\" /&gt;\n\n    &lt;tx:annotation-driven transaction-manager=\"hibernateTransactionManager\" /&gt;\n\n\n    &lt;bean id=\"jspViewResolver\"\n        class=\"org.springframework.web.servlet.view.UrlBasedViewResolver\"&gt;\n        &lt;property name=\"viewClass\"\n            value=\"org.springframework.web.servlet.view.JstlView\" /&gt;\n        &lt;property name=\"prefix\" value=\"/WEB-INF/jsp/\" /&gt;\n        &lt;property name=\"suffix\" value=\".jsp\" /&gt;\n\n    &lt;/bean&gt;\n\n\n    &lt;bean id=\"dataSource\"\n        class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n        &lt;property name=\"driverClassName\" value=\"${database.driver}\" /&gt;\n        &lt;property name=\"url\" value=\"${database.url}\" /&gt;\n        &lt;property name=\"username\" value=\"${database.user}\" /&gt;\n        &lt;property name=\"password\" value=\"${database.password}\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"annotatedClasses\"&gt;\n            &lt;list&gt;\n                &lt;value&gt;net.model.Word&lt;/value&gt;\n                &lt;value&gt;net.model.Category&lt;/value&gt;\n                &lt;value&gt;net.model.Challenge&lt;/value&gt;\n                &lt;value&gt;net.model.User&lt;/value&gt;\n\n            &lt;/list&gt;\n        &lt;/property&gt;\n        &lt;property name=\"hibernateProperties\"&gt;\n            &lt;props&gt;\n                &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n                &lt;prop key=\"hibernate.show_sql\"&gt;${hibernate.show_sql}&lt;/prop&gt;\n                &lt;prop key=\"hibernate.connection.autocommit\"&gt;false&lt;/prop&gt;\n            &lt;/props&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"hibernateTransactionManager\"\n        class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n        &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"messageSource\"\n        class=\"org.springframework.context.support.ReloadableResourceBundleMessageSource\"&gt;\n        &lt;property name=\"basename\" value=\"classpath:messages\" /&gt;\n        &lt;property name=\"defaultEncoding\" value=\"UTF-8\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"localeChangeInterceptor\"\n        class=\"org.springframework.web.servlet.i18n.LocaleChangeInterceptor\"&gt;\n        &lt;property name=\"paramName\" value=\"lang\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"localeResolver\"\n        class=\"org.springframework.web.servlet.i18n.CookieLocaleResolver\"&gt;\n        &lt;property name=\"defaultLocale\" value=\"en\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"handlerMapping\"\n        class=\"org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping\"&gt;\n        &lt;property name=\"interceptors\"&gt;\n            &lt;ref bean=\"localeChangeInterceptor\" /&gt;\n\n        &lt;/property&gt;\n\n    &lt;/bean&gt;\n\n    &lt;bean id=\"multipartResolver\"\n        class=\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"&gt;\n        &lt;property name=\"defaultEncoding\" value=\"UTF-8\" /&gt;\n        &lt;property name=\"maxUploadSize\" value=\"10000000\" /&gt;\n    &lt;/bean&gt;\n\n\n&lt;/beans&gt;\n</code></pre>\n"},{"tags":["eclipse","hibernate","jpa","junit","jpa-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":12885295,"title":"How to use persistence.xml and hibernate.cfg.xml in JUnit tests via eclipse?","body":"<p>I have been searching for an answer during quite a long time before coming here and ask this question.\nMy problem is very simple : I cannot run any JUnit test when using the JPA Entity Manager API. It seems that my test is not reading the <code>persistence.xml</code> file.</p>\n\n<p>When I call <code>new Configuration().configure().buildSessionFactory()</code>, it works like a charm but an exception is thrown when calling <code>Persistence.createEntityManagerFactory(\"myapp\")</code> is:</p>\n\n<blockquote>\n  <p>javax.persistence.PersistenceException: No Persistence provider for\n  EntityManager named myapp at\n  javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:69)\n    at\n  javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)\n    at com.myapp.Test01.setUpBeforeClass(Test01.java:22)</p>\n</blockquote>\n\n<p>My JavaSE  project has the following structure :</p>\n\n<pre><code>myapp\n++src/main/java\n   ++com.myapp.model\n      ++// My entity classes are here\n++src/test/java\n   ++com.myapp\n      ++Test01.java\n++src/main/resources\n  ++hibernate.cfg.xml\n  ++META-INF \n    ++persistence.xml\n</code></pre>\n\n<p>and <code>persistence.xml</code> looks like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n    version=\"2.0\"&gt;\n    &lt;persistence-unit name=\"myapp\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;properties&gt;\n            &lt;property name=\"hibernate.ejb.cfgfile\" value=\"hibernate.cfg.xml\"&gt;&lt;/property&gt; \n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>Do you have any idea how to solve this issue ?</p>\n\n<p>Thank you very much for your help.</p>\n"},{"tags":["mysql","hibernate","c3p0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":35,"score":-2,"question_id":12886014,"title":"Hibernate with mysql","body":"<p>I an trying to create a very basic program for learning hibernate and I am getting the below error:-(\nFull stack trace is given below.Could anyone please help me?</p>\n\n<pre><code>SLF4J: Failed to load class \"org.slf4j.impl.StaticLoggerBinder\".\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\nException in thread \"main\" java.lang.ExceptionInInitializerError\n    at com.persistance.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:16)\n    at com.hiber.HelloWorld.main(HelloWorld.java:10)\nCaused by: java.lang.AbstractMethodError: com.mchange.v2.c3p0.impl.SetManagedDatabaseMetaData.getJDBCMajorVersion()I\n    at org.hibernate.engine.jdbc.JdbcSupportLoader.useContextualLobCreation(JdbcSupportLoader.java:78)\n    at org.hibernate.engine.jdbc.JdbcSupportLoader.loadJdbcSupport(JdbcSupportLoader.java:52)\n    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:118)\n    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2863)\n    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2859)\n    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1870)\n    at com.persistance.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:11)\n    ... 1 more\n</code></pre>\n"},{"tags":["spring","hibernate","jpa","spring-batch"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12877029,"title":"ItemProcessor needs to both modify the working entity but also create new referenced ones","body":"<p>Using spring-batch and JPA (provided by hibernate).</p>\n\n<p>I have a step that does the following:</p>\n\n<ul>\n<li>reads all clients from DB (Client entity)</li>\n<li>enhances them with data from 3rd party. The ItemProcessor goes to the 3rd party data source, fetches some data that it stores in the Client entity itself (its fields) but also brings more data that is stored as different entities (ClientSale) and Client has a property of List which is mapped by ManyToOne.</li>\n<li>The modified entity (Client) and the new ones (ClientSale) need to be stored in DB.</li>\n</ul>\n\n<p>The reader part is straight forward, and for the writer I used JPAItemWriter. At the processing stage I tried to update the fields, create the new ones and add them to the client's list and return the client, hoping that the writer will write both the referenced objects and the client itself to the DB. </p>\n\n<p>Instead, I got an error saying that ClientSale with id #123213213 doesn't exist in the DB.</p>\n\n<p>How to I overcome this? Should I return a list of objects (different types) from my processor (the client + all ClientSale)? Can JPAItemWriter handle a list of objects? Another problem with that is that I'll have to manually update the client_id in the ClientSale entities instead of adding them to the list and having hibernate to understand the relation between them and who points where..</p>\n\n<p>What's the best practice here?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","eclipse","hibernate","gwt","ubuntu-12.04"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":141,"score":0,"question_id":12883665,"title":"Hibernate Classes Not Importing with Eclipse Juno and GWT: LockMode, SessionFactory, Criterion","body":"<h2>Environment</h2>\n\n<ul>\n<li>Ubuntu 12.04 LTS</li>\n<li>Eclipse Juno 4.2 Build id: 20120614-1722</li>\n<li>GWT SDK - 2.4.0</li>\n<li>App Engine SDK - 1.7.2</li>\n<li>Hibernate Version 3.5</li>\n<li>JRE: java-7-openjdk-amd64</li>\n</ul>\n\n<p>In reference to @mael comment, Hibernate Tools was installed from the following Eclipse repo:\n<a href=\"http://download.jboss.org/jbosstools/updates/stable/indigo/\" rel=\"nofollow\">http://download.jboss.org/jbosstools/updates/stable/indigo/</a></p>\n\n<h2>Problem</h2>\n\n<p>The project is a GWT Web Application that uses Hibernate as the entity/persistence manager.  I have successfully configured Hibernate to connect to the database, and it pulls in all the tables and associated columns I am interested in.  I use Hibernate to reverse engineer the entity/persistence classes; it runs successfully, but I get the import errors in the newly generated classes:</p>\n\n<ul>\n<li>The import org.hibernate.LockMode cannot be resolved.</li>\n<li>The import org.hibernate.SessionFactory cannot be resolved.</li>\n<li>The import org.hibernate.criterion.Example cannot be resolved.</li>\n</ul>\n\n<h2>Research/Troubleshooting</h2>\n\n<p>There was similar problem I found <a href=\"http://stackoverflow.com/questions/2122545/eclipse-the-import-cannot-be-resolved-after-java-update\">here</a>.  I performed the search for the aforementioned classes, and did not find them.  I then readded <b>java-7-openjdk-amd64 JRE</b> under <b>Windows > Preferences > Installed JREs</b>.  This did not resolve the problem.</p>\n\n<p>Also, there does not seem to be very much out there for this problem.  So I am assuming there is something I have not understood in the setup of Hibernate and reverse engineering.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4322893/eclipse-error-the-import-xxx-cannot-be-resolved\">Another Similar Problem - Same Solution</a></p>\n\n<h2>Update: Solution</h2>\n\n<ol>\n<li>Following @mael's solution, I confirmed that Hibernate Tools does not automatically include the Hibernate jar files required for the auto-generated entity/persistence classes.</li>\n<li>Downloaded the Hibernate4 jar files from the following <a href=\"http://sourceforge.net/projects/hibernate/files/hibernate4/4.1.7.Final/\" rel=\"nofollow\">location</a>.</li>\n<li>Extracted files to the Eclipse workspace.</li>\n<li>In Eclipse, right-click on {Project} and go to <b>Build Path > Configure Build Path... > Java Build Path.</b></li>\n<li>Click on the Libraries tab.</li>\n<li>Click on Add External JARs...</li>\n<li>Go to directory where Hibernate4 JAR files were extracted, and follow the path to <b>lib > required</b>.</li>\n<li>Select all JAR files in the folder and confirm.</li>\n</ol>\n"},{"tags":["json","hibernate","serialization","spring-roo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":420,"score":0,"question_id":7402324,"title":"FlexJson deserialize object reference","body":"<p>I'm using Spring Roo which generated set of hibernate and <strong>FlexJSON</strong> classes.</p>\n\n<p>I have entity called <strong>Location</strong> and entity called <strong>Comment</strong>.\nLocation has many comments (1:M).</p>\n\n<p>I'm trying to generate JSON object, which will, when <strong>deserialized</strong> and inserted reference existing Location object.</p>\n\n<p>When I omit location field, everything is working fine, for example:</p>\n\n<pre><code>{ \n   \"date\": 1315918228639, \n   \"comment\": \"Bosnia is very nice country\" \n}\n</code></pre>\n\n<p>I don't know how to reference location field. \nI've tried following, but with little success:</p>\n\n<pre><code>{\n   \"location\": 10,  \n   \"date\": 1315918228639, \n   \"comment\": \"Bosnia is very nice country\" \n}\n</code></pre>\n\n<p>where location id is 10.</p>\n\n<p>How can I reference location field in the JSON?</p>\n\n<p>Edit: Added Comment entity:</p>\n\n<pre><code>@RooJavaBean\n@RooToString\n@RooJson\n@RooEntity\npublic class Komentar {\n\n    private String comment;\n\n    @ManyToOne\n    private Location location;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    @DateTimeFormat(style = \"M-\")\n    private Date date;\n\n}\n</code></pre>\n"},{"tags":["hibernate","auto-increment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12882153,"title":"Change the value of autoincrement in Hibernate","body":"<p>I have developed the application using hsqldb and JPA/Hibernate. As per the client's request they wanted us to do some basic data entry (via file upload) so that they have the data till date when the start the application. And we did that as well.</p>\n\n<p>Now the problem is that when I installed the application on the client end, they were not able to add any of the master data (neither the transaction data). I found that while adding the data hibernate gives org.hibernate.exception.ConstraintViolationException, which is because it starts inserting the values from 1.</p>\n\n<p>So, I have set the GeneratorValue field with Auto. (@GeneratedValue(strategy = GenerationType.AUTO)). </p>\n\n<p>Should you need more information, please let me know. Any help will be highly appreciated.\n(I have googled but did not find any specific answer so far)</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","lucene","hibernate-search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12829663,"title":"Can Hibernate Search implement a Lucene FullTextFilter using embedded collection fields?","body":"<p>I have a Hibernate Search entity class that looks something like this:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Indexed\n@FullTextFilterDefs({\n   @FullTextFilterDef(name=\"myFilter\", impl=MyFilterFactory.class)\n})\npublic class Parent {\n   ...\n   @Column\n   @Field\n   private String name;\n\n   @ManyToMany\n   @IndexedEmbedded\n   private Set&lt;Child&gt; children;\n   ...\n}\n</code></pre>\n\n<p>The associated enity is likewise straightforward:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Indexed\npublic class Child {\n   ...\n   @Column\n   @Field\n   private String name;\n\n   @ManyToMany(mappedBy=\"children\")\n   @ContainedIn\n   private Set&lt;Parent&gt; parents;\n   ...\n}\n</code></pre>\n\n<p>If the <code>MyFilterFactory.getFilter()</code> method is working with a simple field of <code>Parent</code> like this (hardcoded for easier illustration):</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>...\nTerm term = new Term(\"name\", \"daddy\");\nQuery query = new TermQuery(term);\nreturn new CachingWrapperFilter( new QueryWrapperFilter(query) );\n...\n</code></pre>\n\n<p>... then <code>FullTextQuery</code>'s with this filter enabled work as expected.</p>\n\n<p>However, if I change the filter to use a field <strong>of an embedded field</strong>:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>...\nTerm term = new Term(\"children.name\", \"Junior\");\nQuery query = new TermQuery(term);\nreturn new CachingWrapperFilter( new QueryWrapperFilter(query) );\n...\n</code></pre>\n\n<p>... then I get 0 hits every time, despite the fact that the search expression <code>children.name:parent=junior</code> works just fine in Luke.</p>\n\n<p>Is there something I am missing here?  Obviously the information is there since I can search it in Luke.  Is there something special you have to do with Hibernate Search to implement a <code>FullTextFilter</code> against an embedded field like this, rather than a simple field?</p>\n"},{"tags":["hibernate","postgresql","heroku","playframework","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":86,"score":0,"question_id":12881528,"title":"Hibernate/PostgreSQL JPAQueryException when trying to use GROUP BY","body":"<p>I'm getting the following Exception using Hibernate:</p>\n\n<blockquote>\n  <blockquote>\n    <p>JPAQueryException occured : Error while executing query select f from Flyer as f join f.events as e where e.start > ? and e.start &lt; ? and f.popularityTag > 1 group by f order by sqrt((-118.39419-f.venue.lng) * (-118.39419-f.venue.lng)+(34.024353-f.venue.lat)*(34.024353-f.venue.lat)) asc: ERROR: column \"venue2_.lng\" must appear in the GROUP BY clause or be used in an aggregate function</p>\n  </blockquote>\n</blockquote>\n\n<p>The above shows the HQL for the query. The SQL that that HQL generates is as follows:</p>\n\n<blockquote>\n  <blockquote>\n    <p>select flyer0_.id as id345_, flyer0_.venue_id as venue77_345_ from flyer flyer0_ inner join event events1_ on flyer0_.id=events1_.flyer_id cross join venue venue2_ where flyer0_.venue_id=venue2_.id and events1_.start>? and events1_.start1 group by flyer0_.id order by sqrt((-118.39419-venue2_.lng)*(-118.39419-venue2_.lng)+(34.024353-venue2_.lat)*(34.024353-venue2_.lat)) asc limit ?</p>\n  </blockquote>\n</blockquote>\n\n<p>The Tables are Flyer, Event, and Venue.</p>\n\n<p>The Event table keeps track of the start and stop time of the Flyer... with a Flyer being able to be repeated on multiple days... thus having multiple events.</p>\n\n<p>Each Flyer has a single Venue, where what is advertised on the Flyer will take place.</p>\n\n<p>In terms of my database, I'm using Heroku PostgreSQL Crane, as described in the following URLs. I believe it uses PostgreSQL 9.1:</p>\n\n<ul>\n<li><a href=\"https://postgres.heroku.com/blog/past/2012/5/3/crane_the_new_50_per_month_production_database_/\" rel=\"nofollow\">https://postgres.heroku.com/blog/past/2012/5/3/crane_the_new_50_per_month_production_database_/</a></li>\n<li><a href=\"https://addons.heroku.com/heroku-postgresql\" rel=\"nofollow\">https://addons.heroku.com/heroku-postgresql</a></li>\n<li><a href=\"https://devcenter.heroku.com/articles/heroku-postgresql\" rel=\"nofollow\">https://devcenter.heroku.com/articles/heroku-postgresql</a></li>\n</ul>\n\n<p>In terms of hibernate, Play Framework 1.2.5 which I'm using seems to use:</p>\n\n<pre><code>- org.hibernate -&gt; hibernate-core 3.6.10.Final\n- org.hibernate -&gt; hibernate-commons-annotations 3.2.0.Final\n- org.hibernate -&gt; hibernate-entitymanager 3.6.10.Final\n- org.hibernate -&gt; hibernate-validator 4.1.0.Final\n</code></pre>\n\n<p>MY QUESTION is what is causing that JPAQueryException, and how can I fix it?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":12881855,"title":"Hibernate change property instance by id","body":"<p>Say we have a User class with UserType property defined:</p>\n\n<pre><code>private UserType userType;\n</code></pre>\n\n<p>Is it possible to set this property using only ID of needed UserType?  Something like</p>\n\n<pre><code>public void setUserTypeById(Long id){\n   this.userType.setId(id); \n}\n</code></pre>\n\n<p>But this one will only change the <code>id</code> property of assigned UserType instance, while I need to change it to another one.</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12881902,"title":"Hibernate update all columns from object","body":"<p>I have the following method to update a row in database using hibernate. I want to update all the columns in the table using the new object. So I get the existing object and set all of its properties to the new object's properties.</p>\n\n<pre><code>public void updatePlace(Place newPlace) {\n    Session session = factory.openSession();\n    Transaction tx = null;\n    try {\n        tx = session.beginTransaction();\n        Place place = (Place)session.createQuery(\"FROM Place AS plc WHERE plc.Id = \" + newPlace.getId()).list().get(0);\n        place.setPhone(newPlace.getPhone());\n        place.setPKey(newPlace.getPKey());\n        place.setName(newPlace.getName());\n        place.setDetails(newPlace.getDetails());\n        session.update(place);\n        tx.commit();\n    } catch (HibernateException e) {\n        if (tx != null) {\n            tx.rollback();\n        }\n        e.printStackTrace();\n    } finally {\n        session.close();\n    }\n}\n</code></pre>\n\n<p>In this method I update all the columns one by one, and if I add a new column one day I have to remember to change this method.</p>\n\n<pre><code>place.setPhone(newPlace.getPhone());\nplace.setPKey(newPlace.getPKey()); \nplace.setName(newPlace.getName());\nplace.setDetails(newPlace.getDetails());\n</code></pre>\n\n<p>Is there a shorter way to update the columns using the newPlace object?</p>\n"},{"tags":["java","hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":12881250,"title":"Can't insert into database using hibernate","body":"<p>I am using hibernate to implement a register function and I encountered the following problems...</p>\n\n<pre><code>Hibernate: insert into Customer (address, isMember, mobile, name, password, rank, reward, title, id) values (?, ?, ?, ?, ?, ?, ?, ?, ?)\norg.hibernate.exception.ConstraintViolationException: could not insert: [com.POJO.Customer]\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:94)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2285)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2678)\n    at org.hibernate.action.EntityInsertAction.execute(EntityInsertAction.java:79)\n    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:167)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1028)\n    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:366)\n    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)\n    at com.dao.impl.CustomerDAOImpl.addCustomer(CustomerDAOImpl.java:34)\n    at com.service.CustomerService.doRegister(CustomerService.java:12)\n    at com.action.RegisterAction.execute(RegisterAction.java:23)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:441)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:280)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:243)\n    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:165)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:252)\n    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:179)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:94)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:130)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:165)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:179)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:488)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.sql.SQLIntegrityConstraintViolationException: The statement was aborted because it would have caused a duplicate key value in a unique or primary key constraint or unique index identified by 'SQL121014203335200' defined on 'CUSTOMER'.\n    at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)\n    at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)\n    at org.hibernate.jdbc.NonBatchingBatcher.addToBatch(NonBatchingBatcher.java:46)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2265)\n    ... 81 more\nCaused by: org.apache.derby.client.am.SqlException: The statement was aborted because it would have caused a duplicate key value in a unique or primary key constraint or unique index identified by 'SQL121014203335200' defined on 'CUSTOMER'.\n    at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)\n    at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)\n    at org.apache.derby.client.net.NetStatementReply.readExecute(Unknown Source)\n    at org.apache.derby.client.net.StatementReply.readExecute(Unknown Source)\n    at org.apache.derby.client.net.NetPreparedStatement.readExecute_(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.readExecute(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)\n    ... 84 more\n</code></pre>\n\n<p>Here is how I configure the hibernate.cfg.xml</p>\n\n<pre><code>  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;org.apache.derby.jdbc.ClientDriver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:derby://localhost:1527/orderonline;create=true&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;user&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;user&lt;/property&gt;\n\n    &lt;!-- JDBC connection pool (use the built-in) --&gt;\n    &lt;property name=\"connection.pool_size\"&gt;2&lt;/property&gt;\n\n    &lt;!-- SQL dialect --&gt;\n    &lt;property name=\"dialect\"&gt;org.hibernate.dialect.DerbyDialect&lt;/property&gt;\n\n    &lt;!-- Enable Hibernate’s current session context --&gt;\n    &lt;property name=\"current_session_context_class\"&gt;thread&lt;/property&gt;\n\n    &lt;!-- Disable the second-level cache --&gt;\n    &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.NoCacheProvider&lt;/property&gt;\n\n    &lt;!-- Echo all executed SQL to stdout --&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n\n  &lt;/session-factory&gt;\n</code></pre>\n\n<p>I also created a HibernateUtil.java</p>\n\n<pre><code>    public static final SessionFactory sessionFactory;\n    public static final AnnotationConfiguration config;\n\n    static {\n        try {\n            config = new AnnotationConfiguration();\n            config.addAnnotatedClass(Customer.class);\n            config.configure(\"hibernate.cfg.xml\");\n\n            // Create the SessionFactory from hibernate.cfg.xml\n            sessionFactory = config.buildSessionFactory();\n        } catch (Throwable ex) {\n            // Make sure you log the exception, as it might be swallowed\n            System.err.println(\"Initial SessionFactory creation failed.\" + ex);\n            throw new ExceptionInInitializerError(ex);\n        }\n    }\n</code></pre>\n\n<p>Here comes the Entity class</p>\n\n<pre><code>package com.POJO;\n\nimport javax.persistence.Entity;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name=\"Customer\")\npublic class Customer {\n\n    private int id;\n    private String title;\n    private String name;\n    private String password;\n    private String mobile;\n    private String address;\n    private int isMember;\n    private int rank;\n    private double reward;\n\n    @Id\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public String getAddress() {\n        return address;\n    }\n\n    public void setAddress(String address) {\n        this.address = address;\n    }\n\n    public String getMobile() {\n        return mobile;\n    }\n\n    public void setMobile(String mobile) {\n        this.mobile = mobile;\n    }\n\n    public int getIsMember() {\n        return isMember;\n    }\n\n    public void setIsMember(int isMember) {\n        this.isMember = isMember;\n    }\n\n    public int getRank() {\n        return rank;\n    }\n\n    public void setRank(int rank) {\n        this.rank = rank;\n    }\n\n    public double getReward() {\n        return reward;\n    }\n\n    public void setReward(double reward) {\n        this.reward = reward;\n    }\n\n}\n</code></pre>\n\n<p>Here is how I create the table</p>\n\n<pre><code>create table app.customer\n(\n  ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1) primary key, \n  title varchar(10),\n  name varchar(20),\n  password varchar(10),\n  mobile varchar(10),\n  address varchar(50),\n  isMember int,\n  rank int,\n  reward double\n)\n</code></pre>\n\n<p>and I have added the <code>@GeneratedValue(strategy=GenerationType.AUTO)</code> next to <code>@Id</code></p>\n\n<p>but there comes another problem</p>\n\n<pre><code>org.hibernate.exception.SQLGrammarException: could not get or update next value\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:90)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.engine.TransactionHelper$1Work.doWork(TransactionHelper.java:64)\n    at org.hibernate.engine.transaction.Isolater$JdbcDelegate.delegateWork(Isolater.java:211)\n    at org.hibernate.engine.transaction.Isolater.doIsolatedWork(Isolater.java:67)\n    at org.hibernate.engine.TransactionHelper.doWorkInNewTransaction(TransactionHelper.java:74)\n    at org.hibernate.id.TableGenerator.generate(TableGenerator.java:118)\n    at org.hibernate.id.TableHiLoGenerator.generate(TableHiLoGenerator.java:84)\n    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:122)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:210)\n    at org.hibernate.event.def.DefaultSaveEventListener.saveWithGeneratedOrRequestedId(DefaultSaveEventListener.java:56)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:195)\n    at org.hibernate.event.def.DefaultSaveEventListener.performSaveOrUpdate(DefaultSaveEventListener.java:50)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)\n    at org.hibernate.impl.SessionImpl.fireSave(SessionImpl.java:563)\n    at org.hibernate.impl.SessionImpl.save(SessionImpl.java:551)\n    at org.hibernate.impl.SessionImpl.save(SessionImpl.java:547)\n    at com.dao.impl.CustomerDAOImpl.addCustomer(CustomerDAOImpl.java:33)\n    at com.service.CustomerService.doRegister(CustomerService.java:12)\n    at com.action.RegisterAction.execute(RegisterAction.java:23)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeAction(DefaultActionInvocation.java:441)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invokeActionOnly(DefaultActionInvocation.java:280)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:243)\n    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:165)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:252)\n    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:179)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:94)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ScopedModelDrivenInterceptor.intercept(ScopedModelDrivenInterceptor.java:130)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.debugging.DebuggingInterceptor.intercept(DebuggingInterceptor.java:267)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)\n    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:165)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:179)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)\n    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)\n    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)\n    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:488)\n    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)\n    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\n    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\n    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n    at java.lang.Thread.run(Unknown Source)\nCaused by: java.sql.SQLSyntaxErrorException: Table/View 'HIBERNATE_UNIQUE_KEY' does not exist.\n    at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)\n    at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)\n    at org.apache.derby.client.am.Connection.prepareStatement(Unknown Source)\n    at org.hibernate.id.TableGenerator.doWorkInCurrentTransaction(TableGenerator.java:156)\n    at org.hibernate.engine.TransactionHelper$1Work.doWork(TransactionHelper.java:61)\n    ... 85 more\nCaused by: org.apache.derby.client.am.SqlException: Table/View 'HIBERNATE_UNIQUE_KEY' does not exist.\n    at org.apache.derby.client.am.Statement.completeSqlca(Unknown Source)\n    at org.apache.derby.client.net.NetStatementReply.parsePrepareError(Unknown Source)\n    at org.apache.derby.client.net.NetStatementReply.parsePRPSQLSTTreply(Unknown Source)\n    at org.apache.derby.client.net.NetStatementReply.readPrepareDescribeOutput(Unknown Source)\n    at org.apache.derby.client.net.StatementReply.readPrepareDescribeOutput(Unknown Source)\n    at org.apache.derby.client.net.NetStatement.readPrepareDescribeOutput_(Unknown Source)\n    at org.apache.derby.client.am.Statement.readPrepareDescribeOutput(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.readPrepareDescribeInputOutput(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.flowPrepareDescribeInputOutput(Unknown Source)\n    at org.apache.derby.client.am.PreparedStatement.prepare(Unknown Source)\n    at org.apache.derby.client.am.Connection.prepareStatementX(Unknown Source)\n    ... 88 more\n</code></pre>\n\n<p>How can I solve this problem...? I have tried many ways... Could any one give a hint on this ?</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":12880905,"title":"getting object from HQL query","body":"<p>I am working on a project involving struts2 and hibernate.Actually I want to execute the select query below and store the values into a object of type Users.i tried using tostring(),querystring() methods all return only the query asa  string.I tried googling it said \"HQL returns result in the form of objects\" but i cant get the members of the class using query.how to get it please help thanks in advance</p>\n\n<pre><code>Query query=session.createQuery(\" from Users where userid=:temp\");\nquery.setParameter(\"temp\", \"kumar\");\n</code></pre>\n"},{"tags":["hibernate","grails","gorm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":12821997,"title":"GORM - modifying object in the beforeDelete event doesn't work","body":"<p>I have these two domain classes:</p>\n\n<pre><code>class User {\n    String username\n    String password\n\n    static hasMany = [organizations: Organization]\n    static belongsTo = Organization\n\n    static constraints = {\n        username blank: false, unique: true\n        password blank: false\n    }\n\n    static mapping = {\n        password column: '`password`'\n        organizations fetch: 'join'\n    }\n\n    def beforeDelete() {\n        User.withNewSession {\n            this.organizations.each {\n                it.removeFromMembers(this)\n            }\n            this.save()\n        }\n    }\n}\n\nclass Organization {\n    String name;\n\n    static hasMany = [members: User]\n}\n</code></pre>\n\n<p>What I'm trying to achieve is I think pretty clear -- I want to be able to delete a user but before that, I have to delete the user from all organizations that he is assigned to. GORM obviously doesn't support this so I tried it to write the beforeDelete event on class User that would delete the user from all organizations just before the delete. The problem is that the above code doesn't work, this is the exception it throws:</p>\n\n<pre><code>| Error 2012-10-10 16:27:56,898 [http-bio-8080-exec-2] ERROR errors.GrailsExceptionResolver  - NonUniqueObjectException occurred when processing request: [POST] /theses-management/user/index - parameters:\nid: 1\n_action_delete: Delete\na different object with the same identifier value was already associated with the session: [com.redhat.theses.auth.User#1]. Stacktrace follows:\nMessage: a different object with the same identifier value was already associated with the session: [com.redhat.theses.auth.User#1]\n    Line | Method\n-&gt;&gt;   36 | doCall             in com.redhat.theses.auth.User$_beforeDelete_closure1$$ENlS7bOi\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n|     32 | beforeDelete       in com.redhat.theses.auth.User$$ENlS7bOi\n|     46 | onApplicationEvent in org.grails.datastore.mapping.engine.event.AbstractPersistenceEventListener\n|     93 | delete             in com.redhat.theses.auth.UserController$$ENlS7klM\n|    195 | doFilter . . . . . in grails.plugin.cache.web.filter.PageFragmentCachingFilter\n|     63 | doFilter           in grails.plugin.cache.web.filter.AbstractFilter\n|   1110 | runWorker . . . .  in java.util.concurrent.ThreadPoolExecutor\n|    603 | run                in java.util.concurrent.ThreadPoolExecutor$Worker\n^    722 | run . . . . . . .  in java.lang.Thread\n</code></pre>\n\n<p>So I tired to change the beforeDelete event like this:</p>\n\n<pre><code>def beforeDelete() {\n    User.withNewSession {\n        this.organizations.each {\n            it.removeFromMembers(this)\n        }\n        this.merge()\n        this.save()\n    }\n}\n</code></pre>\n\n<p>But then the same exception is being thrown...</p>\n\n<p>Another attempt was this:</p>\n\n<pre><code>def beforeDelete() {\n    User.withNewSession {\n        this.organizations.each {\n            it.removeFromMembers(this)\n        }\n        def user = this.merge()\n        user.save()\n    }\n}\n</code></pre>\n\n<p>Result is this exception:</p>\n\n<pre><code>| Error 2012-10-10 16:33:22,669 [http-bio-8080-exec-7] ERROR util.JDBCExceptionReporter  - Referential integrity constraint violation: \"FK6BC87A0D3E1F37F9: PUBLIC.ORGANIZATION_MEMBERS FOREIGN KEY(USER_ID) REFERENCES PUBLIC.USER(ID)\"; SQL statement:\ndelete from user where id=? and version=? [23503-164]\n| Error 2012-10-10 16:33:22,673 [http-bio-8080-exec-7] ERROR events.PatchedDefaultFlushEventListener  - Could not synchronize database state with session\nMessage: could not delete: [com.redhat.theses.auth.User#1]\n    Line | Method\n-&gt;&gt;   93 | delete    in com.redhat.theses.auth.UserController$$ENlS7klM\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n|    195 | doFilter  in grails.plugin.cache.web.filter.PageFragmentCachingFilter\n|     63 | doFilter  in grails.plugin.cache.web.filter.AbstractFilter\n|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor\n|    603 | run . . . in java.util.concurrent.ThreadPoolExecutor$Worker\n^    722 | run       in java.lang.Thread\n\nCaused by JdbcSQLException: Referential integrity constraint violation: \"FK6BC87A0D3E1F37F9: PUBLIC.ORGANIZATION_MEMBERS FOREIGN KEY(USER_ID) REFERENCES PUBLIC.USER(ID)\"; SQL statement:\ndelete from user where id=? and version=? [23503-164]\n-&gt;&gt;  329 | getJdbcSQLException in org.h2.message.DbException\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n|    169 | get       in     ''\n|    146 | get . . . in     ''\n|    398 | checkRow  in org.h2.constraint.ConstraintReferential\n|    415 | checkRowRefTable in     ''\n|    291 | checkRow  in     ''\n|    862 | fireConstraints in org.h2.table.Table\n|    879 | fireAfterRow in     ''\n|     99 | update .  in org.h2.command.dml.Delete\n|     73 | update    in org.h2.command.CommandContainer\n|    226 | executeUpdate in org.h2.command.Command\n|    143 | executeUpdateInternal in org.h2.jdbc.JdbcPreparedStatement\n|    129 | executeUpdate in     ''\n|    105 | executeUpdate in org.apache.commons.dbcp.DelegatingPreparedStatement\n|     93 | delete .  in com.redhat.theses.auth.UserController$$ENlS7klM\n|    195 | doFilter  in grails.plugin.cache.web.filter.PageFragmentCachingFilter\n|     63 | doFilter  in grails.plugin.cache.web.filter.AbstractFilter\n|   1110 | runWorker in java.util.concurrent.ThreadPoolExecutor\n|    603 | run . . . in java.util.concurrent.ThreadPoolExecutor$Worker\n^    722 | run       in java.lang.Thread\n| Error 2012-10-10 16:33:22,680 [http-bio-8080-exec-7] ERROR errors.GrailsExceptionResolver  - JdbcSQLException occurred when processing request: [POST] /theses-management/user/index - parameters:\nid: 1\n_action_delete: Delete\nReferential integrity constraint violation: \"FK6BC87A0D3E1F37F9: PUBLIC.ORGANIZATION_MEMBERS FOREIGN KEY(USER_ID) REFERENCES PUBLIC.USER(ID)\"; SQL statement:\ndelete from user where id=? and version=? [23503-164]. Stacktrace follows:\nMessage: Referential integrity constraint violation: \"FK6BC87A0D3E1F37F9: PUBLIC.ORGANIZATION_MEMBERS FOREIGN KEY(USER_ID) REFERENCES PUBLIC.USER(ID)\"; SQL statement:\ndelete from user where id=? and version=? [23503-164]\n    Line | Method\n-&gt;&gt;  329 | getJdbcSQLException   in org.h2.message.DbException\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n|    169 | get                   in     ''\n|    146 | get . . . . . . . . . in     ''\n|    398 | checkRow              in org.h2.constraint.ConstraintReferential\n|    415 | checkRowRefTable . .  in     ''\n|    291 | checkRow              in     ''\n|    862 | fireConstraints . . . in org.h2.table.Table\n|    879 | fireAfterRow          in     ''\n|     99 | update . . . . . . .  in org.h2.command.dml.Delete\n|     73 | update                in org.h2.command.CommandContainer\n|    226 | executeUpdate . . . . in org.h2.command.Command\n|    143 | executeUpdateInternal in org.h2.jdbc.JdbcPreparedStatement\n|    129 | executeUpdate . . . . in     ''\n|    105 | executeUpdate         in org.apache.commons.dbcp.DelegatingPreparedStatement\n|     93 | delete . . . . . . .  in com.redhat.theses.auth.UserController$$ENlS7klM\n|    195 | doFilter              in grails.plugin.cache.web.filter.PageFragmentCachingFilter\n|     63 | doFilter . . . . . .  in grails.plugin.cache.web.filter.AbstractFilter\n|   1110 | runWorker             in java.util.concurrent.ThreadPoolExecutor\n|    603 | run . . . . . . . . . in java.util.concurrent.ThreadPoolExecutor$Worker\n^    722 | run                   in java.lang.Thread\n</code></pre>\n\n<p>Do you have any idea what I might be doing wrong?</p>\n\n<p>Thanks for your answers in advance.</p>\n"},{"tags":["java","oracle","hibernate","hsqldb"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":94,"score":1,"question_id":12879649,"title":"How to detect Database from Hibernate user type?","body":"<p>Is there a way to deterministically determine the database that is being used from a user type ? My user type needs to pass different object to preparedStatement.setObject depending on the database (whether it is HSQL or Oracle). I was planning to use DataBaseMetaData from preparedStatement  as </p>\n\n<pre><code>preparedStatement.getConnection().getMetaData().getDatabaseProductName()\n</code></pre>\n\n<p>but I'm not sure if there is a well defined set of strings that I can compare the above with to determine the database.</p>\n\n<p>The larger problem that I'm trying to solve is , we use DATE column in Oracle, whereas hibernate maps JodaDateTime to TIMESTAMP(which is the only type that can hold date and time). So Oracle promotes DATE value in the DB to timestamp before performing date comparisons. This results in poor performance because database indexes are skipped. The option of changing column type from DATE to TIMESTAMP is ruled out because it requires more space and our application does not require precision beyond seconds. Thus I plan to write a userType that converts DateTime to oracle.sql.DATE and set the parameter in preparedStatement so that there is no index mismatch. (snippet shown below):</p>\n\n<pre><code>    public void nullSafeSet(PreparedStatement preparedStatement, Object value, int index) throws HibernateException, SQLException {\n    if (value == null) {\n        Hibernate.TIMESTAMP.nullSafeSet(preparedStatement, null, index);\n    } else {\n        preparedStatement.setObject(index, new oracle.sql.DATE(new Timestamp(((DateTime) value).getMillis())), Types.DATE);\n    }\n}\n</code></pre>\n\n<p>The problem with the above approach is that , If I use a different database for unit testing (HSQLDB), it won't work because HSQLDialect does not understand \"oracle.sql.DATE\". This is where I need to know the DB from userType and set different objects in preparedStatement. </p>\n\n<p>So, I would like to know </p>\n\n<ul>\n<li>If there is a better way to solve the DATE-TIMESTAMP mismatch problem</li>\n<li>If not, how to identify DB from a usertype correctly.</li>\n</ul>\n\n<p>Thanks.</p>\n"},{"tags":["java","hibernate","jpa","orm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":135,"score":1,"question_id":12861187,"title":"Hibernate native query : Invalid Column Name Error SQL-17006","body":"<pre><code>package com.abc.def.model;\n\nimport javax.persistence.Column;\nimport javax.persistence.Id;\nimport javax.persistence.Entity;\nimport javax.persistence.Embeddable;\nimport javax.persistence.IdClass;\nimport java.util.Date;\nimport java.io.Serializable;\n\n\n\n@NamedNativeQuery(name=\"getMetadata\",query=\"\n                  select a.name alias1,a.fullname alias2,\n                         b.name alias3,b.age alias4,\n                         c.height alias5,c.something alias6,\n                         d.otherthing alias7\n                  from lame_table_name a,\n                       lame_table_name_2 b\n                  where a.id = b.id\n                     and b.id = c.id \n                     and c.id = d.id \n                     and d.id = :namedparameter\n                  order by a.index,b.index\n               \",\n            resultClass=MetadataModel.class)\n\n\n  @Entity\n  @IdClass(SomeIdClass.class)\n\n  public class MetadataModel{\n\n  @Id @Column(\"alias1\")\n  private Type alias1property;\n\n  @Id @Column(\"alias2\")\n  private Type2 alias2property;\n\n  @Column(\"alias3\")\n  private Type3 alias3property;\n\n  //getters and setters\n  }\n\n  @Embeddable\n  class SomeIdClass implements Serializable{\n\n  //serialVersionUID line\n\n  @Id @Column(\"alias1\")\n  private Type alias1property;\n\n  @Id @Column(\"alias2\")\n  private Type2 alias2property;\n\n  //getter and setters\n  }\n</code></pre>\n\n<p>The error is SQL-17006, Invalid Column Name, have been trying out variations of this setup the whole day\nShould I try putting Column(\"lame_table_name.name\")</p>\n\n<p>I also tried using SqlResultSetMapping (and removed @Column from fields of POJO) (and specifying all the column aliases in the columns attribute of SqlResultSetMapping) (are we supposed to specify the resultsetmapping again when executing the query via the setResultSetMapping method of the SQLQuery interface?)</p>\n\n<pre><code>package com.abc.def.model;\n\nimport javax.persistence.Column;\nimport javax.persistence.Id;\nimport javax.persistence.Entity;\nimport javax.persistence.Embeddable;\nimport javax.persistence.IdClass;\nimport java.util.Date;\nimport java.io.Serializable;\n//other imports for the SqlResultSetMapping\n\n\n\n@NamedNativeQuery(name=\"getMetadata\",query=\"\n                  select a.name alias1,a.fullname alias2,\n                         b.name alias3,b.age alias4,\n                         c.height alias5,c.something alias6,\n                         d.otherthing alias7\n                  from lame_table_name a,\n                       lame_table_name_2 b\n                  where a.id = b.id\n                     and b.id = c.id \n                     and c.id = d.id \n                     and d.id = :namedparameter\n                  order by a.index,b.index\n               \",\n            resultSetMapping=\"metaDataMapping\")\n\n\n@SqlResultSetMapping(name=\"metaDataMapping\",\n              entities=@EntityResult(entityClass=MetadataModel.class,\n                fields = {@FieldResult(name=\"alias1Property\",column=\"alias1\")\n                           //so on\n                      }\n\n                 )\n            )\n\n  @Entity\n  @IdClass(SomeIdClass.class)\n\n  public class MetadataModel{\n\n\n  private Type alias1property;\n\n\n  private Type2 alias2property;\n\n\n  private Type3 alias3property;\n\n  //getters and setters\n  }\n\n  //composite class, exactly as above\n</code></pre>\n"},{"tags":["java","hibernate","unit-testing","hsqldb","schemaexport"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":97,"score":0,"question_id":12867383,"title":"Hsqldb errors during SchemaExport using Hibernate 4.1","body":"<p>How do I get rid of these errors below when running Hibernate's SchemaExport? It doesn't seem to cause a problem actually - my tests still run just fine - but I don't like seeing the errors and having to scroll down a lot just to see what went wrong with a test.</p>\n\n<p>Is there any way to get rid of them - by either solving the error or just making it quiet?</p>\n\n<pre><code>17:28:19 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table click drop constraint FK5A5C588CBB8DB5\n17:28:19 ERROR SchemaExport:426 - user lacks privilege or object not found: PUBLIC.CLICK\n17:28:19 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table click drop constraint FK5A5C5885AC11C60\n17:28:19 ERROR SchemaExport:426 - user lacks privilege or object not found: PUBLIC.CLICK\n17:28:19 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table click drop constraint FK5A5C58841979673\n17:28:19 ERROR SchemaExport:426 - user lacks privilege or object not found: PUBLIC.CLICK\n17:28:19 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table click drop constraint FK5A5C588430DFF29\n17:28:19 ERROR SchemaExport:426 - user lacks privilege or object not found: PUBLIC.CLICK\n17:28:19 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table click drop constraint FK5A5C588B6909BE1\n17:28:19 ERROR SchemaExport:426 - user lacks privilege or object not found: PUBLIC.CLICK\n17:28:19 ERROR SchemaExport:425 - HHH000389: Unsuccessful: alter table comment drop constraint FK38A5EE5FCBB8DB5\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12878619,"title":"checking uniq constraints without using primary key","body":"<p>I am using hibernate only with Annotations. My table looks something like this:</p>\n\n<pre><code>@Entity\n@Table(name = \"NetworkType\",\n    uniqueConstraints = {@UniqueConstraint(columnNames = {\"network_id\", \"type\"})})\n\npublic class NetworkType implements Serializable {\n\n    @Id\n    private long id;\n\n    @Column(name = \"network_id\", nullable = false)\n    private long networkId;\n\n    @Column(name = \"type\", nullable = false)\n    private String type;\n    ...\n</code></pre>\n\n<p>Currently when I write the same NetworkType twice, it throws an exception due to the UniqueConstraint (which is expected).</p>\n\n<p>My thoughts are to just read the item first before checking. The problem is, my primary key is the Id, which I need because other tables references this table. </p>\n\n<p><strong>What's the best way to query for item for the \"network_id\" and \"type\" to verify the combination doesn't already exist?</strong></p>\n\n<p>I know I can do this with a Query manually, but is there a more Hibernate-y way of doing it?</p>\n\n<p><strong>In general, what's the proper way to \"get\" an object without using the PK?</strong> Are Criteria or Query the best way?</p>\n"},{"tags":["java","hibernate","sql-update","relations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12878610,"title":"Update table with FK column values from related table","body":"<p>Hibernate entities used.\nThere are <code>Address</code> and <code>Room</code> entities and apropriate tables in DB.<br>\n<code>Address</code> can have multiple <code>Room</code>s.<br></p>\n\n<p>Both tables have <code>address_Id</code> and <code>customerEmailAddress</code><br>\nThese columns are <code>FK</code> in <code>Room</code> table,that references to <code>Address</code> table.</p>\n\n<p>There is already <code>Address</code> record in DB.<br>\nIt's needed to add several Rooms to <code>this</code> Address.</p>\n\n<p>How to organize Hibernate relation with annotations between <code>Address</code> and <code>Room</code>, so <code>Room</code> table to be updated with appropriate attributes from Address:<br>\n<code>address_Id</code> and <code>customerEmailAddress</code></p>\n\n<p>Java part looks like:</p>\n\n<pre><code>    Room room = new Room();\n    Address addr  = someService.getAddressFromSession();\n    room.add(addr);\n    entityManager.persist(room);\n    Room room2 = new Room();\n    room2.add(addr);\n    entityManager.persist(room2);\n</code></pre>\n\n<p>DB outcome (Room table) should be following:<br>\n<strong>id</strong>||<strong>addressId</strong>|| <strong>customerEmailAddress</strong> <br>\n1 || 3    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   || mail3@a.com<br>\n2 || 3    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   || mail3@a.com</p>\n"},{"tags":["java","hibernate","one-to-many","cascade","orphan"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3729,"score":3,"question_id":3204252,"title":"Hibernate - One to many relationship and orphanRemoval cascade","body":"<p>I have a basic one to many relation parent / child like in the chapter 21 of Hibernate references book.<br>\nThe cascade is only from child to parent (persist cascade only because I don't want to delete the parent if I delete a child).<br>\nWhen I add a child to the parent and I save the child, I have a TransientObjectException...</p>\n\n<pre><code>@Entity\npublic class Parent implements Serializable {\n\n  @Id\n  @GeneratedValue(strategy = GenerationType.AUTO)\n  private Long id;\n\n  @OneToMany(mappedBy = \"parent\", orphanRemoval = true)\n  private List&lt;Child&gt; childs;\n\n  public List&lt;Child&gt; getChilds() {\n    return childs;\n  }\n\n  public void setChilds(List&lt;Child&gt; childs) {\n    this.childs = childs;\n  }\n\n  public void addChild(Child child) {\n    if (childs == null) childs = new ArrayList&lt;Child&gt;();\n    if (childs.add(child)) child.setParent(this);\n  }\n\n  public Long getId() {\n    return id;\n  }\n\n  public void setId(Long id) {\n    this.id = id;\n  }\n}\n\n@Entity\npublic class Child implements Serializable {\n\n  @Id\n  @GeneratedValue(strategy = GenerationType.AUTO)\n  private Long id;\n\n  @ManyToOne(optional = false)\n  @Cascade( { PERSIST, MERGE, REFRESH, SAVE_UPDATE, REPLICATE, LOCK, DETACH })\n  private Parent parent;\n\n  public Parent getParent() {\n    return parent;\n  }\n\n  public void setParent(Parent parent) {\n    this.parent = parent;\n  }\n\n  public Long getId() {\n    return id;\n  }\n\n  public void setId(Long id) {\n    this.id = id;\n  }\n}\n\n\n@Test\npublic void test() {\n  Parent parent = new Parent();\n  Child child = new Child();\n  parent.addChild(child);\n  genericDao.saveOrUpdate(child);\n}\n</code></pre>\n\n<p>But on the saveOrUpdate, I have this exception:</p>\n\n<pre><code>org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: Child\n  at org.hibernate.engine.ForeignKeys.getEntityIdentifierIfNotUnsaved(ForeignKeys.java:244)\n  at org.hibernate.collection.AbstractPersistentCollection.getOrphans(AbstractPersistentCollection.java:911)\n  at org.hibernate.collection.PersistentBag.getOrphans(PersistentBag.java:143)\n  at org.hibernate.engine.CollectionEntry.getOrphans(CollectionEntry.java:373)\n  at org.hibernate.engine.Cascade.deleteOrphans(Cascade.java:471)\n  at org.hibernate.engine.Cascade.cascadeCollectionElements(Cascade.java:455)\n  at org.hibernate.engine.Cascade.cascadeCollection(Cascade.java:362)\n  at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:338)\n  at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:204)\n  at org.hibernate.engine.Cascade.cascade(Cascade.java:161)\n  at org.hibernate.event.def.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:476)\n  at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:354)\n  at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:204)\n  at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:130)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:210)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:195)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:117)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)\n  at org.hibernate.impl.SessionImpl.fireSaveOrUpdate(SessionImpl.java:677)\n  at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:669)\n  at org.hibernate.engine.CascadingAction$5.cascade(CascadingAction.java:252)\n  at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:392)\n  at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:335)\n  at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:204)\n  at org.hibernate.engine.Cascade.cascade(Cascade.java:161)\n  at org.hibernate.event.def.AbstractSaveEventListener.cascadeBeforeSave(AbstractSaveEventListener.java:451)\n  at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:288)\n  at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:204)\n  at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:130)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:210)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:195)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:117)\n  at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:93)\n  at org.hibernate.impl.SessionImpl.fireSaveOrUpdate(SessionImpl.java:677)\n  at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:669)\n  at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:665)\n</code></pre>\n\n<p>I really don't understand because saving the Child should save the Parent via the cascade...\nAny ideas ?</p>\n\n<p><strong>UPDATE 1</strong><br>\nThe problem seems to be related to \"orphanRemoval\" because if I comment it on the parent:</p>\n\n<pre><code>@OneToMany(mappedBy = \"parent\" /*, orphanRemoval = true */)\nprivate List&lt;Child&gt; childs;\n</code></pre>\n\n<p>It works!<br>\nIt save the child, then the parent.<br>\nBut I really need the orphan to be deleted via the cascade when I remove a child from its parent. </p>\n\n<p><strong>UPDATE 2</strong><br>\nI've created a JIRA issue:<br>\n<a href=\"http://opensource.atlassian.com/projects/hibernate/browse/HHH-5364\" rel=\"nofollow\">http://opensource.atlassian.com/projects/hibernate/browse/HHH-5364</a></p>\n\n<p><strong>UPDATE 3</strong><br>\nIt seems to be fixed :-)<br>\n<a href=\"http://opensource.atlassian.com/projects/hibernate/browse/HHH-2269\" rel=\"nofollow\">http://opensource.atlassian.com/projects/hibernate/browse/HHH-2269</a></p>\n"},{"tags":["java","hibernate","spring-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12874264,"title":"I'm Trying to map 1:M Employees can Assign many Task using Spring MVC and Hibernate I am stuck in Persisting Data To Java DB Any Idea?","body":"<p>I'm Trying to map 1:M Employees can Assign many Task using Spring MVC and Hibernate I am stuck in Persisting Data To Java DB Any Idea? </p>\n\n<p>Employee.java  </p>\n\n<pre><code> public class Employee  implements java.io.Serializable {\n\n\n private int empid;\n private String name;\n private int salary;\n private int roleid;\n private Set tasks;\n\npublic Set getTasks() {\n    return tasks;\n}\n\npublic void setTasks(Set tasks) {\n    this.tasks = tasks;\n}\npublic Employee() {\n    tasks = new HashSet();\n}\n\n public void addTask(Task task) {\n    this.tasks.add(task);\n}\n\npublic void removeTask(Task task) {\n    this.tasks.remove(task);\n}\n\npublic Employee(int empid, String name, int salary, int roleid) {\n   this.empid = empid;\n   this.name = name;\n   this.salary = salary;\n   this.roleid = roleid;\n}\n\npublic int getEmpid() {\n    return this.empid;\n}\n\npublic void setEmpid(int empid) {\n    this.empid = empid;\n}\npublic String getName() {\n    return this.name;\n}\n\npublic void setName(String name) {\n    this.name = name;\n}\npublic int getSalary() {\n    return this.salary;\n}\n\npublic void setSalary(int salary) {\n    this.salary = salary;\n}\npublic int getRoleid() {\n    return this.roleid;\n}\n\npublic void setRoleid(int roleid) {\n    this.roleid = roleid;\n}\n}\n</code></pre>\n\n<p>Task.java</p>\n\n<pre><code>public class Task implements java.io.Serializable {\n\nprivate int taskid;\nprivate String title;\nprivate String description;\nprivate int empid;\n\npublic Task() {\n}\n\npublic Task(int taskid, String title, String description, int empid) {\n    this.taskid = taskid;\n    this.title = title;\n    this.description = description;\n    this.empid = empid;\n}\n\npublic int getTaskid() {\n    return this.taskid;\n}\n\npublic void setTaskid(int taskid) {\n    this.taskid = taskid;\n}\n\npublic String getTitle() {\n    return this.title;\n}\n\npublic void setTitle(String title) {\n    this.title = title;\n}\n\npublic String getDescription() {\n    return this.description;\n}\n\npublic void setDescription(String description) {\n    this.description = description;\n}\n\npublic int getEmpid() {\n    return this.empid;\n}\n\npublic void setEmpid(int empid) {\n    this.empid = empid;\n}}\n</code></pre>\n\n<p>Employee.hbm</p>\n\n<pre><code>  &lt;hibernate-mapping&gt;\n    &lt;class name=\"Models.Employee\" table=\"EMPLOYEE\" schema=\"APP\"&gt;\n        &lt;id name=\"empid\" type=\"int\"&gt;\n            &lt;column name=\"EMPID\" /&gt;\n            &lt;generator class=\"increment\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"name\" type=\"string\"&gt;\n            &lt;column name=\"NAME\" length=\"30\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"salary\" type=\"int\"&gt;\n            &lt;column name=\"SALARY\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"roleid\" type=\"int\"&gt;\n            &lt;column name=\"ROLEID\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;set cascade=\"all\" name=\"tasks\" table=\"TASK\"&gt;\n            &lt;key column=\"EMPID\"/&gt;\n            &lt;one-to-many class=\"Models.Task\"/&gt;\n        &lt;/set&gt;\n\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Task.hbm</p>\n\n<pre><code>&lt;hibernate-mapping&gt;\n    &lt;class name=\"Models.Task\" table=\"TASK\" schema=\"APP\"&gt;\n        &lt;id name=\"taskid\" type=\"int\"&gt;\n            &lt;column name=\"TASKID\" /&gt;\n            &lt;generator class=\"increment\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"title\" type=\"string\"&gt;\n            &lt;column name=\"TITLE\" length=\"30\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"description\" type=\"string\"&gt;\n            &lt;column name=\"DESCRIPTION\" length=\"50\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n        &lt;property name=\"empid\" type=\"int\"&gt;\n            &lt;column name=\"EMPID\" not-null=\"true\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>EmployeeAssignTaskController.java</p>\n\n<pre><code>public class EmployeeAssignTaskController extends SimpleFormController {\n\n    public EmployeeAssignTaskController() {\n        setCommandClass(Employee.class);\n    }\n\n    @Override\n    public void doSubmitAction(Object command) {\n//        Employee employee = (Employee) command;\n//        try {\n//            Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n//            session.beginTransaction();\n//            session.save(employee);\n//            session.getTransaction().commit();\n//        } catch (Exception e) {\n//            e.printStackTrace();\n//        }\n    }\n}\n</code></pre>\n"},{"tags":["java","hibernate","spring"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3687,"score":0,"question_id":3288838,"title":"remove object from session in hibernate?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2144697/spring-hibernate-a-different-object-with-the-same-identifier-value-was-alrea\">Spring + Hibernate : a different object with the same identifier value was already associated with the session</a>  </p>\n</blockquote>\n\n\n\n<p>I've loaded an object X from DB using hibernateTemplate find by id, then I get some attributes from that object and added it to another object Y from the same type which was also loaded by the same X id. Then when I tried to <code>saveOrUpdate</code> object Y, hibernate throws exception <em>a different object with the same identifier value was already associated with the session</em>, which I think means that object X is associated with that attribute in the same session, so Y can't be saved or updated and affect also that attribute.</p>\n\n<p>How can I remove object X from session so it's no longer associated with that attribute</p>\n\n<p>I tried to use merge instead of <code>saveOrUpdate</code> and it's working fine, but is it the same as <code>saveOrUpdate</code>? I mean can I depend on it to add new records or update them?</p>\n"},{"tags":["performance","spring","hibernate","unit-testing","dbunit"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":143,"score":2,"question_id":12876278,"title":"Improving performance of database tests using Spring 3.1, Hibernate 4.1, Dbunit, etc","body":"<p>I'm currently starting a new project, and I've got around 190 repository tests. One thing I've noticed - and I am not entirely sure why this happening - is that the integration tests against HSQLDB (2.2.8) are running a lot slower than I think they should be.</p>\n\n<p>I think I've tracked the bottleneck to the insertion of data before each test. For most tests, it ranges from .15 to .38 seconds just to setup the database. This is unacceptable. I would have imagined that an in-memory database would be much faster :(</p>\n\n<p>Here is the database test class that all of my repository tests extend from:</p>\n\n<pre><code>@ContextConfiguration(locations = {\"classpath:applicationContext.xml\"})\n@RunWith(SpringJUnit4ClassRunner.class)\n@TransactionConfiguration(defaultRollback=true)\n@Transactional\npublic abstract class DatabaseTest {\n\n    public static final String TEST_RESOURCES = \"src/test/resources/\";\n\n    @Autowired\n    protected SessionFactory sessionFactory;\n\n    @Autowired\n    protected UserRepository userRepository;\n\n    @Autowired\n    protected DataSource dataSource;\n\n    protected IDatabaseTester databaseTester;\n\n    protected Map&lt;String, Object&gt; jdbcMap;\n    protected JdbcTemplate jdbcTemplate;\n\n    @PostConstruct\n    public void initialize() throws SQLException, IOException, DataSetException {\n        jdbcTemplate = new JdbcTemplate(dataSource);\n\n        setupHsqlDb();\n\n        databaseTester = new DataSourceDatabaseTester(dataSource);\n        databaseTester.setSetUpOperation(DatabaseOperation.CLEAN_INSERT);\n        databaseTester.setTearDownOperation(DatabaseOperation.NONE);\n        databaseTester.setDataSet(getDataSet());\n    }\n\n    @Before\n    public void insertDbUnitData() throws Exception {\n        long time = System.currentTimeMillis();\n\n        databaseTester.onSetup();\n\n        long elapsed = System.currentTimeMillis() - time;\n        System.out.println(getClass() + \" Insert DB Unit Data took: \" + elapsed);\n    }\n\n    @After\n    public void cleanDbUnitData() throws Exception {\n        databaseTester.onTearDown();\n    }\n\n    public IDataSet getDataSet() throws IOException, DataSetException {\n        Set&lt;String&gt; filenames = getDataSets().getFilenames();\n\n        IDataSet[] dataSets = new IDataSet[filenames.size()];\n        Iterator&lt;String&gt; iterator = filenames.iterator();\n        for(int i = 0; iterator.hasNext(); i++) {\n            dataSets[i] = new FlatXmlDataSet(\n                new FlatXmlProducer(\n                    new InputSource(TEST_RESOURCES + iterator.next()), false, true\n                )\n            );\n        }\n\n        return new CompositeDataSet(dataSets);\n    }\n\n    public void setupHsqlDb() throws SQLException {\n        Connection sqlConnection = DataSourceUtils.getConnection(dataSource);\n        String databaseName = sqlConnection.getMetaData().getDatabaseProductName();\n        sqlConnection.close();\n\n        if(\"HSQL Database Engine\".equals(databaseName)) {\n            jdbcTemplate.update(\"SET DATABASE REFERENTIAL INTEGRITY FALSE;\");\n\n            // MD5\n            jdbcTemplate.update(\"DROP FUNCTION MD5 IF EXISTS;\");\n            jdbcTemplate.update(\n                \"CREATE FUNCTION MD5(VARCHAR(226)) \" +\n                    \"RETURNS VARCHAR(226) \" +\n                    \"LANGUAGE JAVA \" +\n                    \"DETERMINISTIC \" +\n                    \"NO SQL \" +\n                    \"EXTERNAL NAME 'CLASSPATH:org.apache.commons.codec.digest.DigestUtils.md5Hex';\"\n            );\n        } else {\n            jdbcTemplate.update(\"SET foreign_key_checks = 0;\");\n        }\n    }\n\n    protected abstract DataSet getDataSets();\n\n    protected void flush() {\n        sessionFactory.getCurrentSession().flush();\n    }\n\n    protected void clear() {\n        sessionFactory.getCurrentSession().clear();\n    }\n\n    protected void setCurrentUser(User user) {\n        if(user != null) {\n            Authentication authentication = new UsernamePasswordAuthenticationToken(user,\n                user, user.getAuthorities());\n\n            SecurityContextHolder.getContext().setAuthentication(authentication);\n        }\n    }\n\n    protected void setNoCurrentUser() {\n        SecurityContextHolder.getContext().setAuthentication(null);\n    }\n\n    protected User setCurrentUser(long userId) {\n        User user = userRepository.find(userId);\n\n        if(user.getId() != userId) {\n            throw new IllegalArgumentException(\"There is no user with id: \" + userId);\n        }\n\n        setCurrentUser(user);\n\n        return user;\n    }\n\n    protected User getCurrentUser() {\n        return (User) SecurityContextHolder.getContext().getAuthentication().getPrincipal();\n    }\n\n}\n</code></pre>\n\n<p>Here is the relevant beans on my application context:</p>\n\n<pre><code>&lt;bean class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt;\n    &lt;property name=\"locations\" value=\"classpath:applicationContext.properties\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\n      destroy-method=\"close\"&gt;\n    &lt;property name=\"driverClass\" value=\"${database.driver}\"/&gt;\n    &lt;property name=\"jdbcUrl\" value=\"${database.url}\"/&gt;\n    &lt;property name=\"user\" value=\"${database.username}\"/&gt;\n    &lt;property name=\"password\" value=\"${database.password}\"/&gt;\n    &lt;property name=\"initialPoolSize\" value=\"10\"/&gt;\n    &lt;property name=\"minPoolSize\" value=\"10\"/&gt;\n    &lt;property name=\"maxPoolSize\" value=\"50\"/&gt;\n    &lt;property name=\"idleConnectionTestPeriod\" value=\"100\"/&gt;\n    &lt;property name=\"acquireIncrement\" value=\"2\"/&gt;\n    &lt;property name=\"maxStatements\" value=\"0\"/&gt;\n    &lt;property name=\"maxIdleTime\" value=\"1800\"/&gt;\n    &lt;property name=\"numHelperThreads\" value=\"3\"/&gt;\n    &lt;property name=\"acquireRetryAttempts\" value=\"2\"/&gt;\n    &lt;property name=\"acquireRetryDelay\" value=\"1000\"/&gt;\n    &lt;property name=\"checkoutTimeout\" value=\"5000\"/&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\"\n      class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\"/&gt;\n    &lt;property name=\"mappingResources\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;...&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n    &lt;property name=\"namingStrategy\"&gt;\n        &lt;bean class=\"org.hibernate.cfg.ImprovedNamingStrategy\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"javax.persistence.validation.mode\"&gt;none&lt;/prop&gt;\n\n            &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;${hibernate.hbm2ddl.auto}\n            &lt;/prop&gt;\n            &lt;prop key=\"hibernate.generate_statistics\"&gt;false&lt;/prop&gt;\n\n            &lt;prop key=\"hibernate.show_sql\"&gt;false&lt;/prop&gt;\n            &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n\n            &lt;prop key=\"hibernate.cache.use_second_level_cache\"&gt;false&lt;/prop&gt;\n            &lt;prop key=\"hibernate.cache.provider_class\"&gt;\n\n            &lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean class=\"org.springframework.orm.hibernate4.HibernateExceptionTranslator\"/&gt;\n\n&lt;bean id=\"transactionManager\"\n      class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>In order to try and insert less data, I allow each test class to pick a DataSet enum that only loads the data it needs. It's specified like this:</p>\n\n<pre><code>public enum DataSet {\n    NONE(create()),\n    CORE(create(\"core.xml\")),\n    USERS(combine(create(\"users.xml\"), CORE)),\n    TAGS(combine(create(\"tags.xml\"), USERS)),\n</code></pre>\n\n<p>Could this be causing it to run slower rather than faster? The idea is that if I only want the core xml (languages, provinces, etc.), I only have to load those records. I thought this would make the test suite faster, but it's still too slow.</p>\n\n<p><strong>I can save some time by creating a separate xml dataset specifically designed for each test class. This chops out some of the insert statements. But even when I have 20 insert statements in a single xml dataset (thus, the minimum I/O loss other than in-lining the dataset right into java code directly), each test still takes .1 to .15 seconds during the initialization of the database data!</strong> I am in disbelief that it takes .15 seconds to insert 20 records into memory.</p>\n\n<p>In my other project using Spring 3.0 and Hibernate 3.x, it takes 30 milliseconds to insert everything before each test, but it's actually inserting 100 or more rows per test. For the tests that only have 20 inserts, they are flying as if there was no delay at all. This is what I expected. I'm starting to think the problem is with Spring's annotations - or the way I have them setup in my <code>DatabaseTest</code> class. This is basically the only thing different now.</p>\n\n<p>Also, my repositories are using the sessionFactory.getCurrentSession() instead of the HibernateTemplate. This is the first time I started using the annotation-based unit test stuff from Spring, since the Spring test classes are deprecated. Could that be the reason they are going slow?</p>\n\n<p>If there's anything else you need to know to help figure it out, please let me know. I am sort of stumped.</p>\n\n<p>EDIT: I put in the answer. The problem was hsqldb 2.2.x. Reverting to 2.0.0 fixes the problem.</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":11206731,"title":"How to inject a Spring bean into a hibernate custom type?","body":"<p>We have many Hibernate Entities with a @JoinColumn field of type Location. The location data are basically static, so we decided to cache them completely in memory.</p>\n\n<p>The original plan was to replace all Location fields with a locationId field. However, we soon realized this is too much work, especially since there are Criteria queries referencing the location fields that can't be easily picked up by existing tools.</p>\n\n<p>The alternative is to implement a custom Hibernate type that maps the locationIds from the database to Location objects, but there doesn't seem to be any easy way to inject the cache bean into the custom type instance.</p>\n\n<p>(Our version of Hibernate does not provide the Configuration.registerTypeOverride() call, so we cannot control the instantiation of the Type instance and thus no way to inject.)</p>\n"},{"tags":["hibernate","lazy-initialization","any"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":12875387,"title":"Cannot fetch @Any related entity due to LazyInitializationException","body":"<p>Could anyone help me how to deal with <code>@Any</code> relationship?</p>\n\n<p>I have an interface <code>InteractionParticipate</code> which is implemented by everyone who wants to take a part in some kind of messaging interaction. A message is represented by <code>InteractionMessage</code> which has a transmitter and a receiver. Since we don't know which entity implementing <code>InteractionParticipate</code> will be the receiver (or transmitter) of the message we have to use <code>@Any</code> relationship.</p>\n\n<p>I have read <a href=\"http://stackoverflow.com/questions/217831/how-to-use-hibernate-any-related-annotations\">this one</a> which inspired me and wrote in <code>InteractionMessage</code> something like that:</p>\n\n<pre><code>@Any(metaColumn = @Column(name = \"Transmitter_Type\"))\n@AnyMetaDef(\n        idType = \"long\",\n        metaType = \"string\",\n        metaValues = {\n                @MetaValue(value = \"Applicant\", targetEntity = Applicant.class),\n                @MetaValue(value = \"Vacancy\", targetEntity = Vacancy.class)\n        })\n@JoinColumn(name = \"Transmitter_Id\")\n@LazyToOne(LazyToOneOption.FALSE)\nprivate InteractionParticipate transmitter;\n\n@Any(metaColumn = @Column(name = \"Receiver_Type\"))\n@AnyMetaDef(idType = \"long\", metaType = \"string\",\n        metaValues = {\n                @MetaValue(targetEntity = Applicant.class, value = \"Applicant\"),\n                @MetaValue(targetEntity = Vacancy.class, value = \"Vacancy\")\n        })\n@JoinColumn(name = \"Receiver_Id\")\n@LazyToOne(LazyToOneOption.FALSE)\nprivate InteractionParticipate receiver;\n</code></pre>\n\n<p>Database is created well and I can see entities save correctly. But when I try to get an <code>InteractionMessage</code> from database</p>\n\n<pre>InteractionMessage message = (InteractionMessage) session.get(InteractionMessage.class, id);</pre>\n\n<p>I face I cannot get neither <code>receiver</code> nor <code>transmitter</code> because <strong>Method threw 'org.hibernate.LazyInitializationException' exception. Cannot evaluate ... Vacancy_$$_javassist_49.toString()</strong>. (Vacancy class is implementing <code>InteractionParticipate</code>.)</p>\n\n<p>I tried to play with <code>@LazyToOne</code> and even <code>@LazyCollection</code> but failed.</p>\n\n<p>Please help me to figure it out. Thanks in advance!</p>\n"},{"tags":["spring","hibernate","jpa","hsqldb","c3p0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":201,"score":0,"question_id":12876551,"title":"Hibernate 4.1 with HSQLDB gives 'data exception: string data, right truncation'","body":"<p>I have a very strange problem, got it when I upgraded som deps to the project. </p>\n\n<p>I'm now using following versions:</p>\n\n<ul>\n<li>Spring: 3.1.0.RELEASE</li>\n<li>Hibernate: 4.1.7.Final</li>\n<li>Hsqldb: 2.2.8 (org.hsqldb)</li>\n</ul>\n\n<p>I THINK the problem has to do something with the file field. (Dbfile.content)</p>\n\n<p><strong>Stacktrace:</strong></p>\n\n<pre><code>javax.persistence.PersistenceException: org.hibernate.exception.DataException: could not insert: [org.project.model.Cv]\n    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1387)\n    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1315)\n    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1321)\n    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:843)\n    at sun.reflect.GeneratedMethodAccessor11.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)\n    at $Proxy36.persist(Unknown Source)\n    at org.project.dao.jpa.GenericDaoJpa.save(GenericDaoJpa.java:49)\n    at sun.reflect.GeneratedMethodAccessor10.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\n    at $Proxy40.save(Unknown Source)\n    at org.project.dao.CvDaoTest.updateTest(CvDaoTest.java:77)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)\n    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)\n    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: org.hibernate.exception.DataException: could not insert: [org.project.model.Cv]\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:102)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:64)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2345)\n    at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2852)\n    at org.hibernate.action.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:71)\n    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)\n    at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:320)\n    at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:203)\n    at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:129)\n    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:69)\n    at org.hibernate.event.def.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:179)\n    at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:135)\n    at org.hibernate.event.def.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:61)\n    at org.hibernate.impl.SessionImpl.firePersist(SessionImpl.java:808)\n    at org.hibernate.impl.SessionImpl.persist(SessionImpl.java:782)\n    at org.hibernate.impl.SessionImpl.persist(SessionImpl.java:786)\n    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:837)\n    ... 45 more\nCaused by: java.sql.SQLDataException: data exception: string data, right truncation\n    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)\n    at org.hsqldb.jdbc.Util.sqlException(Unknown Source)\n    at org.hsqldb.jdbc.JDBCPreparedStatement.fetchResult(Unknown Source)\n    at org.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate(Unknown Source)\n    at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)\n    at org.hibernate.id.IdentityGenerator$GetGeneratedKeysDelegate.executeAndExtract(IdentityGenerator.java:94)\n    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:57)\n    ... 60 more\nCaused by: org.hsqldb.HsqlException: data exception: string data, right truncation\n    at org.hsqldb.error.Error.error(Unknown Source)\n    at org.hsqldb.error.Error.error(Unknown Source)\n    at org.hsqldb.types.BinaryType.castOrConvertToType(Unknown Source)\n    at org.hsqldb.types.BinaryType.convertToType(Unknown Source)\n    at org.hsqldb.StatementDML.getInsertData(Unknown Source)\n    at org.hsqldb.StatementInsert.getInsertValuesNavigator(Unknown Source)\n    at org.hsqldb.StatementInsert.getResult(Unknown Source)\n    at org.hsqldb.StatementDMQL.execute(Unknown Source)\n    at org.hsqldb.Session.executeCompiledStatement(Unknown Source)\n    at org.hsqldb.Session.execute(Unknown Source)\n    ... 65 more\n</code></pre>\n\n<p><strong>Console:</strong></p>\n\n<pre><code>INFO : org.hibernate.engine.jdbc.JdbcSupportLoader - Disabling contextual LOB creation as createClob() method threw error : java.lang.reflect.InvocationTargetException\nHibernate: insert into Nationality (id, countryCode) values (default, ?)\nHibernate: insert into Language (id, countryCode, languageCode) values (default, ?, ?)\nHibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\nHibernate: insert into Nationality (id, countryCode) values (default, ?)\nHibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\nHibernate: insert into Company (id, name) values (default, ?)\nHibernate: insert into Language (id, countryCode, languageCode) values (default, ?, ?)\nHibernate: insert into Company (id, name) values (default, ?)\nHibernate: insert into Skill (id, company_id, created, isCategory, lastUpdate, skill_fk) values (default, ?, ?, ?, ?, ?)\nHibernate: insert into Company (id, name) values (default, ?)\nHibernate: insert into Skill (id, company_id, created, isCategory, lastUpdate, skill_fk) values (default, ?, ?, ?, ?, ?)\nHibernate: insert into Nationality (id, countryCode) values (default, ?)\nHibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\nHibernate: insert into CourseExperience (created, lastUpdate, lastUpdatePerson_id, person_fk, endDate, startDate, id) values (?, ?, ?, ?, ?, ?, ?)\nHibernate: insert into Nationality (id, countryCode) values (default, ?)\nHibernate: insert into Person (id, birthdate, created, email, enabled, firstName, image, lastName, lastUpdate, nationality_id, password, role, salt) values (default, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\nHibernate: insert into CourseExperience (created, lastUpdate, lastUpdatePerson_id, person_fk, endDate, startDate, id) values (?, ?, ?, ?, ?, ?, ?)\nHibernate: insert into Cv (id, company, created, language, lastUpdate, lastUpdatePerson_id, name, person_fk, summary_id) values (default, ?, ?, ?, ?, ?, ?, ?, ?)\nWARN : org.hibernate.util.JDBCExceptionReporter - SQL Error: -3401, SQLState: 22001\nERROR: org.hibernate.util.JDBCExceptionReporter - data exception: string data, right truncation\n</code></pre>\n\n<p><strong>Cv.java:</strong></p>\n\n<pre><code>package org.project.model;\n\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.List;\n\nimport javax.persistence.CascadeType;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.ManyToMany;\nimport javax.persistence.ManyToOne;\nimport javax.persistence.OneToMany;\nimport javax.persistence.OrderBy;\nimport javax.persistence.OrderColumn;\nimport javax.persistence.PrePersist;\nimport javax.persistence.PreUpdate;\nimport javax.persistence.Temporal;\nimport javax.persistence.TemporalType;\n\nimport org.project.model.interfaces.DomainObject;\n\n@Entity\npublic class Cv implements DomainObject {\n\n    private static final long serialVersionUID = -9111485038728016755L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    @Column(nullable = false)\n    private String name;\n\n    @ManyToOne\n    @JoinColumn(name = \"person_fk\")\n    private Person person;\n\n    @ManyToMany\n    private List&lt;Skill&gt; skills = new ArrayList&lt;Skill&gt;();\n\n    @ManyToOne\n    private Summary summary;\n\n    @ManyToMany(targetEntity = Experience.class)\n    @OrderColumn(name = \"index\")\n    private List&lt;Experience&gt; experiences = new ArrayList&lt;Experience&gt;();\n\n    @Temporal(TemporalType.TIMESTAMP)\n    @Column(updatable = false, insertable = true)\n    private Date created;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    private Date lastUpdate;\n\n    @ManyToOne(optional = false)\n    private Person lastUpdatePerson;\n\n    @Column(nullable = false)\n    private Language language;\n\n    @Column(nullable = false)\n    private Company company;\n\n    @OneToMany(orphanRemoval = true, cascade = CascadeType.ALL, targetEntity = DbFile.class)\n    @OrderBy(\"created DESC\")\n    private List&lt;DbFile&gt; files = new ArrayList&lt;DbFile&gt;();\n\n    @PrePersist\n    @PreUpdate\n    protected void updateDates() {\n        Date now = new Date();\n        if (this.created == null) {\n            this.created = new Date(now.getTime());\n        }\n        this.lastUpdate = now;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public Person getPerson() {\n        return person;\n    }\n\n    public void setPerson(Person person) {\n        this.person = person;\n    }\n\n    public List&lt;Skill&gt; getSkills() {\n        return skills;\n    }\n\n    public void setSkills(List&lt;Skill&gt; skills) {\n        this.skills = skills;\n    }\n\n    public List&lt;Experience&gt; getExperiences() {\n        return experiences;\n    }\n\n    public void setExperiences(List&lt;Experience&gt; experiences) {\n        this.experiences = experiences;\n    }\n\n    public Date getCreated() {\n        return created;\n    }\n\n    public void setCreated(Date created) {\n        this.created = created;\n    }\n\n    public Date getLastUpdate() {\n        return lastUpdate;\n    }\n\n    public void setLastUpdate(Date lastUpdate) {\n        this.lastUpdate = lastUpdate;\n    }\n\n    public Person getLastUpdatePerson() {\n        return lastUpdatePerson;\n    }\n\n    public void setLastUpdatePerson(Person lastUpdatePerson) {\n        this.lastUpdatePerson = lastUpdatePerson;\n    }\n\n    public void addSkill(Skill skill) {\n        this.skills.add(skill);\n    }\n\n    public void addExperience(Experience experience) {\n        this.experiences.add(experience);\n    }\n\n    public Summary getSummary() {\n        return summary;\n    }\n\n    public void setSummary(Summary summary) {\n        this.summary = summary;\n    }\n\n    public List&lt;DbFile&gt; getFiles() {\n        return files;\n    }\n\n    public void setFiles(List&lt;DbFile&gt; files) {\n        this.files = files;\n    }\n\n    public void addFile(DbFile file) {\n        this.files.add(file);\n    }\n\n    public Company getCompany() {\n        return company;\n    }\n\n    public void setCompany(Company company) {\n        this.company = company;\n    }\n\n    public Language getLanguage() {\n        return language;\n    }\n\n    public void setLanguage(Language language) {\n        this.language = language;\n    }\n\n    @Override\n    public int hashCode() {\n        final int prime = 31;\n        int result = 1;\n        result = prime * result + ((id == null) ? 0 : id.hashCode());\n        return result;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        Cv other = (Cv) obj;\n        if (id == null) {\n            if (other.id != null)\n                return false;\n        } else if (!id.equals(other.id))\n            return false;\n        return true;\n    }\n}\n</code></pre>\n\n<p><strong>DbFile.java:</strong></p>\n\n<pre><code>package org.project.model;\n\nimport java.util.Date;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.Lob;\nimport javax.persistence.PrePersist;\nimport javax.persistence.Temporal;\nimport javax.persistence.TemporalType;\n\nimport org.hibernate.annotations.Type;\n\nimport org.project.model.interfaces.DomainObject;\n\n@Entity\npublic class DbFile implements DomainObject {\n\n    private static final long serialVersionUID = 1974800702358176016L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String filename;\n\n    @Column(nullable = false)\n    @Lob\n    @Type(type = \"org.hibernate.type.MaterializedClobType\")\n    private byte[] content;\n\n    private String contentType;\n\n    @Temporal(TemporalType.TIMESTAMP)\n    @Column(updatable = false)\n    private Date created;\n\n    @PrePersist\n    protected void updateDates() {\n        if (this.created == null) {\n            this.created = new Date();\n        }\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getFilename() {\n        return filename;\n    }\n\n    public void setFilename(String filename) {\n        this.filename = filename;\n    }\n\n    public byte[] getContent() {\n        return content;\n    }\n\n    public void setContent(byte[] content) {\n        this.content = content;\n    }\n\n    public String getContentType() {\n        return contentType;\n    }\n\n    public void setContentType(String contentType) {\n        this.contentType = contentType;\n    }\n\n    public Date getCreated() {\n        return created;\n    }\n\n    @Override\n    public int hashCode() {\n        final int prime = 31;\n        int result = 1;\n        result = prime * result + ((id == null) ? 0 : id.hashCode());\n        return result;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        DbFile other = (DbFile) obj;\n        if (id == null) {\n            if (other.id != null)\n                return false;\n        } else if (!id.equals(other.id))\n            return false;\n        return true;\n    }\n}\n</code></pre>\n\n<p><strong>Test:</strong></p>\n\n<pre><code>@Transactional\n@RunWith(SpringJUnit4ClassRunner.class)\n...\n@TransactionConfiguration(transactionManager = \"transactionManager\", defaultRollback = true)\npublic class CvDaoTest extends AbstractTest {\n\n    @Autowired\n    private CvDao cvDao;\n\n    @Test\n    public void updateTest() {\n        Cv cv = new Cv();\n        cv.setName(\"test\");\n\n        ...\n        cv.setLastUpdatePerson(lastUpdatePerson);\n\n        ...\n        cv.setPerson(person);\n        cv.setCreated(new Date());\n        cv.setLastUpdate(new Date());\n\n        cv.setCompany(getCompany());\n        cv.setLanguage(getLanguage());\n\n        ...\n        cv.addSkill(skill1);\n        cv.addSkill(skill2);\n\n        ...\n        cv.addExperience(experience1);\n        cv.addExperience(experience2);\n\n        cvDao.save(cv).getId();\n    }\n}\n</code></pre>\n\n<p><strong>GenericDaoJpa.java</strong></p>\n\n<pre><code>public class GenericDaoJpa&lt;T extends DomainObject&gt; implements GenericDao&lt;T&gt; {\n\n    private Class&lt;T&gt; type;\n//  @PersistenceContext\n    protected EntityManager entityManager;\n\n    @PersistenceContext\n    public void setEntityManager(EntityManager entityManager) {\n        this.entityManager = entityManager;\n    }\n\n    public GenericDaoJpa(Class&lt;T&gt; type) {\n        super();\n        this.type = type;\n    }\n\n    @Transactional(readOnly = true)\n    public T get(Long id) {\n        if (id == null) {\n            return null;\n        } else {\n            return entityManager.find(type, id);\n        }\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    @Transactional(readOnly = true)\n    public List&lt;T&gt; getAll() {\n        return entityManager.createQuery(\"select o from \" + type.getName() + \" o\").getResultList();\n    }\n\n    @Transactional(readOnly = false)\n    public T save(T object) {\n        if (object.getId() != null) {\n            return entityManager.merge(object);\n        } else {\n            entityManager.persist(object);\n        }\n        entityManager.flush();\n        return object;\n    }\n\n    public T delete(T object) {\n        entityManager.remove(object);\n        return object;\n    }\n}\n</code></pre>\n\n<p>It fails on: 'cvDao.save(cv).getId();'</p>\n\n<p>Datasource using class 'com.mchange.v2.c3p0.ComboPooledDataSource' with driver 'org.hsqldb.jdbcDriver' at url 'jdbc:hsqldb:mem:data'</p>\n\n<p>What have I done wrong?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12876726,"title":"Persisted date not equal to retreived date (Hibernate)","body":"<p>I have a simple entity class that has a Date property. This property corresponds to a MySQL datetime column.</p>\n\n<pre><code>public class Entity {\n\n    @Column(name = \"start_date\")\n    @Temporal(TemporalType.TIMESTAMP)\n    private java.util.Date startDate;\n\n}\n</code></pre>\n\n<p>This is what an integration test I wrote looks like :</p>\n\n<pre><code>java.util.Date now = new java.util.Date();\nEntity entity = new Entity();\nentity.setStartDate(now);\nentityService.save(entity);\nentity = entityService.get(entity.getId());\nAssert.assertEquals(entity.getStartDate(), now);\n</code></pre>\n\n<p>I would expect those two dates to be equal but they are not ! Actually, I have :</p>\n\n<pre><code>now.getTime() = 1350160029831\nentity.getStartDate().getTime() = 1350160029000\n</code></pre>\n\n<p>so there is a small gap between the two dates. I am really wondering where this gap could come from. It is not always the same and varies each time I start the testing process.\nIn my database, the date stored is 2012-10-13 22:15:38.0.</p>\n\n<p>Do I really need to clear milliseconds somewhere ?</p>\n"},{"tags":["hibernate","transactions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12859305,"title":"Hibernate: how to disable automatic saving of dirty objects?","body":"<p>I was quite surprised to find out that Hibernate automatically saves dirty objects at the end of transaction, without explicit calls to something like</p>\n\n<pre><code>dao.save(object)\n</code></pre>\n\n<p>I have in mind the situation described by <a href=\"http://stackoverflow.com/questions/8190926/transactional-saves-without-calling-update-method\">this thread</a></p>\n\n<p>My question is: is there a way to disable this behaviour? At first glance this automatic saving seems rather dangerous because you need to know which objects are connected to the session and which not and it seems pretty easy to save something by mistake. Can you tell me what the benefits of this automatic-saving approach are? I hardly see any.\nI'd like to always explicitly call dao.save(object) to update anything.</p>\n\n<p>I heard of one possible workaround to this, which is using an entityInterceptor on your sessionFactory. This custom entityInterceptor would override the findDirty method to never find anything dirty, but in such case I suppose dao.save won't also work. Any ideas?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12876512,"title":"Looping through hibernate data source issue","body":"<p>I have implemented HibernateLoopDataSource in which I have constructor, one without applied criteria and one with. It looks like following</p>\n\n<pre><code>HibernateLoopDataSource.java\n\n//code trimmed\nHibernateLoopDataSource(Session hibernate, Class&lt;?&gt; typeOfClass){\n  this.hibernate = hibernate;\n  this.typeOfClass = typeOfClass;\n}\n\nHibernateLoopDataSource(Session hibernate, Class&lt;?&gt; typeOfClass, AppliedCriteria appliedCriteria){\n  this.hibernate = hibernate;\n  this.typeOfClass = typeOfClass;\n\n}\n\n\n\nAppliedCriteria.java //looks like following \n</code></pre>\n\n<p>it is an interface and contains only one method</p>\n\n<pre><code>applyingCriteria(Criteria criteria);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>GettingArticles.java\n\n// code trimmed\n\npublic LoopDataSource getArticles(){\nreturn new HibernateLoopDataSource(hibernate, Article.class, new AppliedCriteria(){\n public void applyingCriteria(Criteria criteria){\n   criteria.add(Restrictions.eq(\"article.id\", fullCommentPageListing.getArticle().getId()));}});}\n</code></pre>\n\n<p>However, when I try to initialize it doesn't report anything, however it loops without applying criteria. What may be the cause of this issue, I am stuck on it 2 hours, it may be some trivial, and I can't see it, 'cause I am working on this for 8 hours. Any help is appreciated.</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":105,"score":2,"question_id":12873570,"title":"Difference between spring tx:advice and spring aop pointcut","body":"<p>I am new to spring, with working knowledge of hibernate.\nMy job was to implement transaction by using spring declarative approach.And successfully i did with the help of Google, thanks to Google. But not able to understand clearly about the terms I used in application-context.xml.</p>\n\n<p>1.</p>\n\n<pre><code> &lt;tx-advice&gt;\n\n&lt;/tx-advice&gt;\n</code></pre>\n\n<ol>\n<li><pre><code>&lt;aop-config&gt;\n    // here is point cut were declared\n&lt;/aop-config&gt;\n</code></pre></li>\n</ol>\n\n<p>can somebody explain me about above point, Meanwhile I am trying to understand it from the google also.</p>\n"},{"tags":["hibernate","jpa","sybase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12865732,"title":"Hibernate Sybase doesn't support Date with @Version","body":"<p>I seem to be getting a compiling error in my IDE, \"netbeans\" that says; </p>\n\n<p>Create @Temporal annotation</p>\n\n<p>So then I add @Temporal(TemporalType.TIMESTAMP)</p>\n\n<p>and I get another error that says;</p>\n\n<p>The Version field or property is not one of the supported types. Make sure that it is one of the following types: int, Integer, short, Short, long, Long, java.sql.Timestamp.</p>\n\n<p>I'm using the following code, </p>\n\n<pre><code>@Version\n@org.hibernate.annotations.Source(SourceType.DB)\n@org.hibernate.annotations.Generated(GenerationTime.ALWAYS)\nprivate Date rowVersion;\n</code></pre>\n\n<p>I'm starting to believe it might be related to the SybaseDialect, however I'm not very knowledgeable in this area, so I may be completely wrong. </p>\n"},{"tags":["java","hibernate","criteria-api","projection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":12859306,"title":"Hibernate with ProjectionList error: cannot be cast to [Ljava.lang.Object;","body":"<p>I have problem with returnig list of my objects. I am working with entity class which has <code>@EmbeddedId</code> as you can see in my code below, ther are two lines with similar text: <code>id.*</code>.</p>\n\n<pre><code>Criteria cr = createCriteria(true);\ncr.add(Restrictions.eq(\"id.qwerty\", \"QWERTY\"));\n\nProjectionList projectionList = Projections.projectionList();\nprojectionList.add(Projections.property(\"id.qwerty\"));\nprojectionList.add(Projections.property(\"text\"));\nprojectionList.add(Projections.property(\"id.property\"));\ncr.setProjection(projectionList);\ncr.setResultTransformer(Transformers.aliasToBean(My.class));\n\nList&lt;My&gt; myList = (List&lt;My&gt;) cr.list();\n\nreturn myList;\n</code></pre>\n\n<p>At line <code>List&lt;My&gt; messagesList = (List&lt;My&gt;) cr.list();</code> the below error has occured.</p>\n\n<pre><code>java.lang.ClassCastException: my.package.dao.domain.My cannot be cast to [Ljava.lang.Object;\nat org.hibernate.cache.StandardQueryCache.put(StandardQueryCache.java:104)\nat org.hibernate.loader.Loader.putResultInQueryCache(Loader.java:2274)\nat org.hibernate.loader.Loader.listUsingQueryCache(Loader.java:2206)\nat org.hibernate.loader.Loader.list(Loader.java:2164)\nat org.hibernate.loader.criteria.CriteriaLoader.list(CriteriaLoader.java:119)\nat org.hibernate.impl.SessionImpl.list(SessionImpl.java:1706)\nat org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:347)\n</code></pre>\n\n<p>How can I defined <code>Criteria</code> or <code>ProjectionList</code> in this case?</p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>@javax.persistence.Entity\n@Table(name = \"my_table\")\npublic class My extends MyEntity&lt;MyPK&gt; {\n\n   @EmbeddedId\n   private MyPK id;\n\n   @Column(name = \"text\", nullable = false)\n   protected String text;\n\n   @ManyToOne\n   @JoinColumn(name = \"property\", nullable = false, insertable = false, updatable = false)\n   protected Option option;\n\n   @Override\n   public MyPK getId() {\n       return id;\n   }\n\n   @Override\n   public void setId(MyPK id) {\n       this.id = id;\n   }\n\n   //getters and setter\n   //equlas and hashCode\n}\n</code></pre>\n\n<p>And <code>MyPK</code> class:</p>\n\n<pre><code>@Embeddable\npublic class MyPK implements Serializable {\n\n   @Column(name = \"qwerty\")\n   protected String qwerty;\n\n   @Column(name = \"property\")\n   protected String property;\n\n   //constructors, getters and setters\n}\n</code></pre>\n"},{"tags":["hibernate","session"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":175,"score":1,"question_id":4066052,"title":"session in hibernate(save two object once)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3553200/hibernate-different-object-with-the-same-identifier-value-was-already-associate\">Hibernate: different object with the same identifier value was already associated with the session</a>  </p>\n</blockquote>\n\n\n\n<p>I tried to save two entity once:</p>\n\n<pre><code>session=....getCurrentSession();\n\nBook bo1=new Book();\nbo1.setName(\"name1\");\nsession.save(bo1);\n\nBook bo2=new Book();\nbo2.setName(\"name2\");\nsession.save(bo2);\n</code></pre>\n\n<p>Then I get a exception:</p>\n\n<blockquote>\n  <p>a different object with the same identifier value was already associated with the session.</p>\n</blockquote>\n\n<p>Seems that the bo2' identifier exist (the bo1's identifier), I wonder why?</p>\n\n<p>BTW, I really want to know more about the session in hibernate, any docs? I have read the tutorial of hibernate, but it is not detailed enough.</p>\n"},{"tags":["hibernate","exception"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12741500,"title":"HibernateSystemException when retrieving objects (different object with the same identifier value was already associated with the session)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3553200/hibernate-different-object-with-the-same-identifier-value-was-already-associate\">Hibernate: different object with the same identifier value was already associated with the session</a>  </p>\n</blockquote>\n\n\n\n<p>I saw that in my code (Spring + Hibernate web application) I was getting the following exception:</p>\n\n<pre><code> HibernateSystemException: a different object with the same identifier value was already associated with the session\n</code></pre>\n\n<p>I checked my code and realized that the problem was caused by the fact that I was getting the same object twice. I modified it to the simplest possible case:</p>\n\n<pre><code>customerDao.getById(customerId);\ncustomerDao.getById(customerId);\n</code></pre>\n\n<p>The above code causes the mentioned exception, but I don't understand why it's wrong to get the same object twice from Hibernate. It seems like a normal use case. The same object could be retrieved i.e. by running two different queries. Why should I worry about whether one query will return the same objects as the second query or not? Can anybody explain or point me to some source of information on this topic?</p>\n\n<p>P.S. <strong><em>The Hibernate second-level cache is disabled in the application.</em></strong></p>\n\n<hr>\n\n<h3>UPDATE:</h3>\n\n<p>When I changed the contents of customerDao.getById(customerId) from:</p>\n\n<pre><code>Customer result = new Customer();\ngetHibernateTemplate().load(result, customerId);\nreturn result;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>return getHibernateTemplate().get(Customer.class, customerId);\n</code></pre>\n\n<p>the exception was no longer thrown. There are a lot of articles on the Internet on the differences of load and get but none that I found mentioned this case. Can anyone shed some light upon the topic?</p>\n"},{"tags":["hibernate","grails","groovy","grails-searchable"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":121,"score":1,"question_id":12808800,"title":"Grails \"a different object with the same identifier value was already associated with the session\" error","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3553200/hibernate-different-object-with-the-same-identifier-value-was-already-associate\">Hibernate: different object with the same identifier value was already associated with the session</a>  </p>\n</blockquote>\n\n\n\n<p>I have the following code in my controller in Grails that is failing with <code>\"a different object with the same identifier value was already associated with the session\"</code> error message.\nI have already visited few pages where it says that I must call <code>\"merge\"</code> before calling save which ends up with this error <code>Provided id of the wrong type for class com.easytha.QuizTag. Expected: class java.lang.Long, got class org.hibernate.action.DelayedPostInsertIdentifier</code></p>\n\n<p>Someone has suggested that grails searchable plugin might be causing this and I should remove searchable = true form my domain class which is not an option (refer to the previous post here <a href=\"http://stackoverflow.com/questions/12650402/grails-searcheable-plugin-search-in-inner-hasmany-class/12655877#12655877\">grails searcheable plugin search in inner hasMany class</a>)</p>\n\n<p>One thing to point is that error is not thrown at the time of calling q.save() rather it's thrown while calling redirect redirect(action:\"show\",id:id)!!</p>\n\n<p>Any suggestions?</p>\n\n<pre><code>def addTags(String tags,Long id){\n        if(tags){\n            String[] strTags = tags.split(\",\");\n            Quiz q = Quiz.get(id)           \n            for(String t in strTags){\n                Tag tagToAdd = Tag.findByTag(t)\n\n                if(!tagToAdd){\n                    tagToAdd = new Tag(tag:t)\n                    tagToAdd.save()\n                }\n\n                println \"---&gt; \"+tagToAdd +\" Quiz\"+q?.id\n                def qt = QuizTag.findByQuizAndTag(q,tagToAdd)\n                if(!qt){\n                    qt = new QuizTag(quiz:q,tag:tagToAdd);\n                    q.addToTags(qt)\n                }\n\n            }           \n            q.save()        \n            redirect(action:\"show\",id:id)\n        }\n    }\n</code></pre>\n\n<p>-----------EDIT---------------</p>\n\n<pre><code>Final code that worked with searchable plugin\n        def addTags(String tags,Long id){\n        if(tags){\n            String[] strTags = tags.split(\",\");\n            Quiz q = Quiz.get(id)           \n            for(String t in strTags){\n                if (q.tags.any { QuizTag qt -&gt; qt.tag.tag == t }) { continue; }\n                    Tag tagToAdd = Tag.findOrSaveByTag(t);\n                    QuizTag qt = new QuizTag(quiz:q,tag:tagToAdd)\n                    q.addToTags(qt)\n                }           \n            q.save(flush:true)      \n            redirect(action:\"show\",id:id)\n        }\n    }\n</code></pre>\n"},{"tags":["hibernate","inner-join"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":2,"view_count":47,"score":-1,"question_id":12346362,"title":"Hibernate innner query","body":"<p>Can anyone please provide to me an example query for inner join in hibernate query language.</p>\n\n<p>I mean make a inner join for more than two tables using hibernate pojo.</p>\n"},{"tags":["hibernate","postgresql","grails","gorm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12850955,"title":"Configuring Postgres in Grails","body":"<p>I have an application in migrating to MySQL and PostgreSQL and I both have different behaviors in the allocation of data.</p>\n\n<p>By analyzing the database created in Postgres, I realized that the numbering of ID's created in each table are not being reset in change for another table. For example, it was set in the registers 3 'Table1' and counting the ID 1 to 3. When inserted into an object of another class in another table, the ID should be started for that table, but it follows the sequence of previous and when the object is persisted in 'table2' instead his first start with the ID continues to count from 4. I also noticed some changes in Mysql as the 'false' field 'boolean' is preenchdio with '0 'in Postgres is filled with' false '.</p>\n\n<p>I updated the JDBC but the problem continues. I think maybe there should be some configuration of 'mapping' in the field, but not sure.</p>\n\n<p>My DataSource is thus:</p>\n\n<pre><code>environments {\ndevelopment {\n    dataSource {\n\n        dbCreate = \"update\" // one of 'create', 'create-drop', 'update', 'validate', ''\n\n    url = \"jdbc:postgresql://localhost:5432/app\"\n        driverClassName = \"org.postgresql.Driver\"\n        dialect = org.hibernate.dialect.PostgreSQLDialect\n        //url = \"jdbc:mysql://localhost:3306/app\"\n        username = \"app\"\n        password = \"app123\"\n\n    }\n}\ntest {\n    dataSource {\n        dbCreate = \"update\"\n        url = \"jdbc:h2:mem:testDb;MVCC=TRUE;LOCK_TIMEOUT=10000\"\n        username = \"sa\"\n        password = \"\"\n    }\n}\nproduction {\n    dataSource {\n        dbCreate = \"update\"\n        url = \"jdbc:postgresql://localhost:5432/app\"\n        driverClassName = \"org.postgresql.Driver\"\n        username = \"postgres\"\n\n\n        pooled = true\n        properties {\n           maxActive = -1\n           minEvictableIdleTimeMillis=1800000\n           timeBetweenEvictionRunsMillis=1800000\n           numTestsPerEvictionRun=3\n           testOnBorrow=true\n           testWhileIdle=true\n           testOnReturn=true\n           validationQuery=\"SELECT 1\"\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>You can follow the same pattern as in Mysql Postgres?</p>\n"},{"tags":["java","hibernate","persistence","criteria"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":257,"score":4,"question_id":12795921,"title":"Hibernate: getting too many rows","body":"<p>I have problem with getting rows from my database using Hibernate. When I would like to get only one row, I am receiving 20. When I would like to get all of rows from table with about 1.5k rows, I am receiving exactly 15.2k rows.\nEntity class of this table has composite primary key.</p>\n\n<p>This is my code for getting all rows:</p>\n\n<pre><code>Criteria criteria = getSession().createCriteria(type);\ncriteria.setCacheable(true).setCacheRegion(BaseEntity.PACKAGE);\ncriteria.list();\n</code></pre>\n\n<p>And this is my Entity class:</p>\n\n<pre><code>@javax.persistence.Entity\n@Table(name = \"my_table\")\npublic class My extends MyEntity&lt;MyPK&gt; {\n\n    @EmbeddedId\n    private MyPK id;\n\n    @Column(name = \"text\", nullable = false)\n    protected String text;\n\n    @ManyToOne\n    @JoinColumn(name = \"property\", nullable = false, insertable = false, updatable = false)\n    protected Option option;\n\n    @Override\n    public MyPK getId() {\n        return id;\n    }\n\n    @Override\n    public void setId(MyPK id) {\n        this.id = id;\n    }\n\n    //getters and setter\n}\n</code></pre>\n\n<p>And this is <code>MyPK</code> class:</p>\n\n<pre><code>@Embeddable\npublic class MyPK implements Serializable {\n\n   @Column(name = \"qwerty\")\n   protected String qwerty;\n\n   @Column(name = \"property\")\n   protected String property;\n\n   //constructors, getters and setters\n}\n</code></pre>\n\n<p><code>MyEntity</code> class is abstract class with <code>@MappedSuperclass</code> annotation. This is this class header:    </p>\n\n<pre><code>@MappedSuperclass\npublic abstract class MyEntity&lt;T extends Serializable&gt;\n</code></pre>\n\n<p>What am I doing wrong? Is this problem with <code>EmbeddedId</code>?</p>\n\n<p><strong>EDIT #1</strong>\nAs I have realized this is problem with this: </p>\n\n<pre><code>@ManyToOne\n@JoinColumn(name = \"property\", nullable = false, insertable = false, updatable = false)\nprotected Option option;\n</code></pre>\n\n<p>This object contains foreign key to another table. And this another table has reference to another. And this last table has 10 rows for previous table. In the result I am getting rows amount * 10. The problem is probably with Hibernate annotation in my entities.</p>\n"},{"tags":["java","hibernate","lucene","hibernate-search"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":362,"score":0,"question_id":2651646,"title":"Reverse search in Hibernate Search","body":"<p>I'm using Hibernate Search (which uses Lucene) for searching some Data I have indexed in a directory. It works fine but I need to do a reverse search. By reverse search I mean that I have a list of queries stored in my database I  need to check which one of these queries match with a Data object each time Data Object is created. I need it to alert the user when a Data Object matches with a Query he has created. So I need to index this single Data Object which has just been created and see which queries of my list has this object as a result.</p>\n\n<p>I've seen Lucene MemoryIndex Class to create an index in memory so I can do something like this example for every query in a list (though iterating in a Java list of queries would not be very efficient):</p>\n\n<pre><code>//Iterating over my list&lt;Query&gt;\nMemoryIndex index = new MemoryIndex();\n//Add all fields\nindex.addField(\"myField\", \"myFieldData\", analyzer);\n...\nQueryParser parser = new QueryParser(\"myField\", analyzer);\nfloat score = index.search(query);\nif (score &gt; 0.0f) {\n    System.out.println(\"it's a match\");\n} else {\n    System.out.println(\"no match found\");\n}\n</code></pre>\n\n<p>The problem here is that this Data Class has several Hibernate Search Annotations @Field,@IndexedEmbedded,... which indicated how fields should be indexed, so when I invoke index() method on the FullTextEntityManager instance it uses this information to index the object in the directory. Is there a similar way to index it in memory using this information?</p>\n\n<p>Is there a more efficient way of doing this reverse search?</p>\n"},{"tags":["java","hibernate","jpql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12866874,"title":"Java Hibernate DataException: cannot be converted to BIGINT","body":"<p>I'm trying to join one table, with two other tables, using a single column in Java using Hibernate and JPQL.</p>\n\n<p>For example, I have <code>table A</code> with an <code>id</code> column. I want to join <code>table B</code> and <code>table C</code> with <code>table A</code> on the <code>id</code> column. </p>\n\n<p>However, when I try to do that I get the following error:\n<code>org.hibernate.exception.DataException: The value supplied cannot be converted to BIGINT</code>. I have seen some answer say that there may be null values, but these id columns are primary id columns, and contain no nulls.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>@OneToOne(fetch = fetchType.LAZY)\n@JoinColumn(name=\"id\", insertable=false, updatable=false)\nprivate TableB tableB\n\n@OneToOne(fetch = fetchType.LAZY)\n@JoinColumn(name=\"id\", insertable=false, updatable=false)\nprivate TableC tableC\n</code></pre>\n\n<p>When I remove one of the two joins everything works fine again.</p>\n\n<p>What am I doing wrong that's causing this issue?</p>\n"},{"tags":["spring","hibernate","maven","junit","liquibase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12859432,"title":"ApplicationContext created in multiple threads when running tests with Maven","body":"<p>I have two <code>persistence-unit</code>s, which are identical except other uses Hibernate's hbm2ddl <code>create-drop</code> and the other uses <code>validate</code> and there the database is created by liquiBase.</p>\n\n<p>Now running any of the tests (HSQLDB named in-mem db) from eclipse, they work fine. But running all of them from maven, they brake with strange foreign key violations.</p>\n\n<p>What I think is strange is that I get messages from 4 different threads and for example closing one of the Persistence Units happens while table drops are still written to console.</p>\n\n<p>Why do I get four threads, all with their own ApplicationContexts? I have no <code>parallel</code> parameters set for surefire and I'm not using -T switch for maven either.</p>\n\n<p>Edit:</p>\n\n<p>Here's a snippet from the commandline output of Maven</p>\n\n<pre><code>Hibernate: drop table PostalCodeDistribution if exists\nHibernate: drop table PublicationAudit if exists\n15:21:13.672 [Thread-2] INFO  org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'TestPU-nocreate'\nHibernate: drop table PostalCodeDistributionAudit if exists\nHibernate: drop table PublicationInvoicing if exists\nHibernate: drop table PostalCodeSubscriberCountAudit if exists\n15:21:13.672 [Thread-2] INFO  org.hibernate.service.jdbc.connections.internal.DriverManagerConnectionProviderImpl - HHH000030: Cleaning up connection pool [jdbc:hsqldb:mem:ptptest]\nHibernate: drop table Revision if exists\nHibernate: drop table PriceDate if exists\n</code></pre>\n"},{"tags":["hibernate","extjs4","lazy-loading"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":97,"score":-1,"question_id":12866029,"title":"Extjs + hibernate :Unable to load tree with child data(lazy load) Dynamically..!!","body":"<p>Problem :\nI have a tree of objects called POS(as main nodes) and Expansion of them i have different objects(MIDS). POS tree is getting displayed but when i expand it (MID) node specific children are not coming(MIDs or children shold only load on click of the nodes):</p>\n\n<pre><code> var loadedMid = false;\n    //-----------------***Start Models***------------------------\n        Ext.define('mid', {  //----***child of model (pos) defined below***\n            extend : 'Ext.data.Model',\n            fields : [  {\n                name : 'midId',\n                type : 'int'\n            }],\n            });\n\n        Ext.define('pos', { //---------***parent of mid defined above***----------\n            extend : 'Ext.data.Model',\n            fields : [  {\n                name : 'posId',\n                type : 'int'\n            },{\n                name : 'posNumber',\n                type : 'string'\n            }, {\n                 name : 'checked',\n                 type : 'checkBox',\n                     defaultValue: false,\n                }, {\n                    name : 'iconCls',\n                    type : 'string',\n                    defaultValue : 'treenode-no-icon'\n                }],\n            hasMany : [ {\n                name : 'mid',\n                model : 'mid',\n                associationKey : 'mid'\n            } ],\n        proxy : {\n            type : 'ajax',\n            url : 'loadPOSTree.htm?zoneId='+${zoneId},\n\n            reader : {\n                type : 'json',\n                root : 'posList'\n            }\n        },}\n        );\n        //-----------------***End Models***------------------------\n        var loaded =false;\n\n        var posTreeStore = Ext.create('Ext.data.TreeStore', { //------***Load Parent store***----------\n            model : 'pos',\n            autoLoad : false,\n            root : {\n                expanded : true,\n                iconCls : 'no-icon'\n            } ,initComponent: function() { //***Load only parent nodes(POS)***\nthis.posTreeStore = Ext.data.StoreManager.lookup(this.posTreeStore);\nthis.posTreeStore.getProxy().url = 'loadPOSTree.htm?zoneId='+${zoneId}; // &lt;-- init loading\nthis.posTreeStore.load();\nloaded = true;\nthis.callParent(arguments);\n},\n\n            listeners : {//***Load Child(Mid) on click of + sign***\n                                beforeload : function(posTreeStore,operation, options){\n                            if(operation.node !=posTreeStore.getRootNode()){\n                                posTreeStore.getProxy().url = 'loadPOSMIDTree.htm?posNumber='+operation.node.get('posNumber');\n                                posTreeStore.getProxy().reader\n                                loadedMid = true;\n\n                                }\n                                }\n                            }\n        });\n\n // ----------***POS - Mid Tree***------------------//\n\n        posTree = Ext\n        .create(\n                'Ext.tree.Panel',\n                {\n                    width : 700,\n                    height : 500,\n                    title : '&lt;spring:message code=\"label.posTree\" /&gt;',\n                    store : posTreeStore,\n                    columnLines: true,\n                    frame: true,\n                    iconCls: 'no-icon',\n                    renderTo : 'pos-tree-div',\n                    header : true,\n                    rootVisible:false,\n                    columns : [{\n                        xtype : 'treecolumn',\n                        menuDisabled : true,\n                        flex : 1,\n                        sortable : false,\n                        id : 'posNumber',\n                        dataIndex : 'posNumber',\n                                renderer : function(value,\n                                                    metaData, record, row,\n                                                    col, posTreeStore, gridView) {\n                                            return 'POS'+record.get('posNumber')\n                                }\n\n                    },{\n                          id : 'posId',\n                          menuDisabled : true,\n                          flex : 1,\n                          sortable : false,\n                          hidden: true,\n                          dataIndex : 'posId'\n                            }],\n                    tools : [\n                                {\n                                    icon : 'images/exportPdf.png',\n                                    xtype : 'button',\n                                    text : '&lt;spring:message code=\"label.exportPdf\"/&gt;',\n                                    handler : function(event,\n                                            toolEl, panel) {\n                                document.getElementById('zoneIdHidden').value = '${zoneId}';\n                                Ext.get('exportPOSPDFForm').dom.submit();\n                                    },\n                                },\n                                {\n                                    icon : 'images/exportXls.png',\n                                    xtype : 'button',\n                                    text : '&lt;spring:message code=\"label.exportCsv\"/&gt;',\n                                    handler : function(event,\n                                            toolEl, panel) {\n                                        document.getElementById('zoneIdhide').value = '${zoneId}';\n                                        Ext.get('exportPOSCSVForm').dom.submit();\n                                    }\n                                }, ],\n                                listeners : {\n                                    checkChange : function() {\n                                        toggleButton();\n                                        }\n                                }\n                });\n});\n</code></pre>\n\n<p>1)Data: for url POS parent:</p>\n\n<pre><code>[{\"posId\":507,\"posNumber\":\"1212454-455445\",\"zone\":{\"zoneId\":91,\"name\":\"3Level\",\"levelInfo\":{\"levelInfoId\":3,\"name\":\"L3\",\"level\":3},\"parentZoneId\":87,\"currency\":\"AFN\",\"checked\":false}},{\"posId\":905,\"posNumber\":\"12345678-12345678\",\"zone\":{\"zoneId\":91,\"name\":\"3Level\",\"levelInfo\":{\"levelInfoId\":3,\"name\":\"L3\",\"level\":3},\"parentZoneId\":87,\"currency\":\"AFN\",\"checked\":false}},{\"posId\":1249,\"posNumber\":\"1212454-455445\",\"zone\":{\"zoneId\":91,\"name\":\"3Level\",\"levelInfo\":{\"levelInfoId\":3,\"name\":\"L3\",\"level\":3},\"parentZoneId\":87,\"currency\":\"AFN\",\"checked\":false}}]\n</code></pre>\n\n<p>2)Data to load Childs(MID) on click of 1st node\n{\"posList\":[{\"midId\":571,\"application\":{\"id\":1,\"name\":\"EM\"}}]}</p>\n\n<p>*<em>Goal :</em>*on click of POS its child MIDs shold be displayed</p>\n"},{"tags":["java","hibernate","persistence","hql","case"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":6021,"score":0,"question_id":1502536,"title":"How can I use the sql case clause in HQL?","body":"<p>I really need help regarding this one. </p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>  hSql=\" select case \n      when min(start_day_plan) is not NULL then min(start_day_plan)\n      else to_date((min(insertDate)) - cast('1 month' as interval),'yyyy-MM-dd' )\n      end \n      from Project\"\n\n    getHibernateTemplate().find(hSql);\n</code></pre>\n\n<p>But this generates the error below:</p>\n\n<hr>\n\n<pre><code>java.lang.IllegalStateException: No data type for node: org.hibernate.hql.ast.tree.CaseNode \n \\-[CASE] CaseNode: 'case'\n    +-[WHEN] SqlNode: 'when'\n    |  +-[IS_NOT_NULL] UnaryLogicOperatorNode: 'is not null'\n    |  |  \\-[AGGREGATE] AggregateNode: 'min'\n    |  |     \\-[IDENT] IdentNode: 'start_day_plan' {originalText=start_day_plan}\n    |  \\-[AGGREGATE] AggregateNode: 'min'\n    |     \\-[IDENT] IdentNode: 'start_day_plan' {originalText=start_day_plan}\n    \\-[ELSE] SqlNode: 'else'\n       \\-[METHOD_CALL] MethodNode: '('\n          +-[METHOD_NAME] IdentNode: 'to_date' {originalText=to_date}\n          \\-[EXPR_LIST] SqlNode: 'exprList'\n             +-[MINUS] BinaryArithmeticOperatorNode: '-' {dataType=org.hibernate.type.DoubleType@bb21ab}\n             |  +-[AGGREGATE] AggregateNode: 'min'\n             |  |  \\-[IDENT] IdentNode: 'insertDate' {originalText=insertDate}\n             |  \\-[METHOD_CALL] MethodNode: '('\n             |     +-[METHOD_NAME] IdentNode: 'cast' {originalText=cast}\n             |     \\-[EXPR_LIST] SqlNode: 'exprList'\n             |        +-[QUOTED_STRING] LiteralNode: ''1 month''\n             |        \\-[IDENT] IdentNode: 'interval' {originalText=interval}\n             \\-[QUOTED_STRING] LiteralNode: ''yyyy-MM-dd''\n</code></pre>\n\n<p>what will be the correct query for this? im just trying to subtract 1 month from the insertdate.</p>\n\n<p>If you could help, please do so..thanks :)</p>\n\n<p></p>\n"},{"tags":["java","spring","hibernate","aop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12859960,"title":"How to add depth to spring's transaction manager","body":"<p>Spring 2.5, Hibernate.</p>\n\n<p>Our application is architected to have a services layer and a manager layer. The services layer provides all read only services and communicates to the UI the results. For services requiring changes to the database, the services layer performs all initial read-only functions, then calls the manager layer.</p>\n\n<p>We have set up a transaction advice around our manager layer to catch all exceptions coming out of the manager layer and rollback those transactions. This works pretty well for the most part.</p>\n\n<p>The problem is in situations where we have one manager call another manager to perform some functionality. This functionality throws an exception, which is a real exception when called from the UI, but is handled internally in the client manager and a successful result is returned. The transaction manager sees that an exception was thrown and rolls back the transaction anyway, even though the exception was handled successfully.</p>\n\n<p>Here is the transaction attribute that's causing us grief.</p>\n\n<pre><code>&lt;tx:method name=\"*\" propagation=\"REQUIRED\" rollback-for=\"Throwable\" no-rollback-for=\"OverridableException\"/&gt;\n</code></pre>\n\n<p>Is there a way that I can specifiy depth on this? I would like to say, only rollback for exceptions in the highest manager layer call and not for the exceptions in subsequent calls on the same transaction.</p>\n\n<p>Thanks!</p>\n"},{"tags":["hibernate","jpa","nhibernate-mapping","lazy-loading","jpa-2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":780,"score":1,"question_id":7902250,"title":"JPA lazy at simple byte[] filed level","body":"<p>Unfortunately the code below does not work. Image is always retrieved!</p>\n\n<pre><code>@Entity\npublic Car implements Serializable {\n    ...\n    @Basic(fetch = FetchType.LAZY) //Neither with @Lob\n    private byte[] image;\n    ...\n}\n</code></pre>\n\n<blockquote>\n  <p><strong>SETUP</strong>:   JPA 2.0 / Hibernate 3.5 / MySQL 5.5</p>\n</blockquote>\n"},{"tags":["hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12765638,"title":"How to make hibernate.cfg.xml to a datasource bean","body":"<p>I have a hibernate.cfg.xml file, but I'd like to reference it as a dataSource bean. Is there any way to do this? All I have is :</p>\n\n<pre><code>&lt;beans:bean id=\"foo\" class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n        &lt;beans:property name=\"configLocation\" value=\"classpath:hibernate.cfg.xml\"/&gt;\n</code></pre>\n\n<p>but its not a dataSource. Any help would be greatly appreciated.</p>\n\n<p>To add a bit of context, I'd like to integrate Spring Security in my app and one of the ways to provide a database as a source for the authentication manager is as follows (taken from <a href=\"http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#what-is-acegi-security\" rel=\"nofollow\">here</a>):</p>\n\n<pre><code>   &lt;authentication-manager&gt;\n        &lt;authentication-provider&gt;\n            &lt;jdbc-user-service data-source-ref=\"securityDataSource\"/&gt;\n        &lt;/authentication-provider&gt;\n    &lt;/authentication-manager&gt;\n</code></pre>\n\n<p>Where “securityDataSource” is the name of a DataSource bean in the application context, pointing at a database.</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12862496,"title":"Assigned value of embdded Hibernate Entity coming back null","body":"<p>I have a Hibernate <code>@Embeddable</code> annotated class like so</p>\n\n\n\n<pre class=\"lang-java prettyprint-override\"><code>@Embeddable\npublic class DataWrapper {\n    private DataWrapperType wrapperType;\n\n    @ManyToOne\n    private DataFactorX xFactor;\n    @ManyToOne\n    private DataFactorY yFactor;\n    @ManyToOne\n    private DataFactorZ zFactor;\n\n    // Getters and Setters\n}\n</code></pre>\n\n<p>and it's pretty simply used in another entity</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\npublic class DataManager {\n    private DataWrapper dataWrapper;\n\n    public DataManager() {\n        this.dataWrapper = new DataWrapper();\n    }\n}\n</code></pre>\n\n<p>but when I later retrieve a <code>DataManager</code> instance from Hibernate, the <code>dataWrapper</code> field comes back null.</p>\n\n<p>Any explanation?</p>\n"},{"tags":["hibernate","caching","ejb-3.0","ehcache","java-ee-5"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":4368,"score":6,"question_id":1613952,"title":"@Cache annotation usage error","body":"<p>I added the following annotation to enable cache to one of my EJB3 entities, to test caching with ehCache, where I use Hibernate as the persistence provider:</p>\n\n<pre><code>....\nimport org.hibernate.annotations.Cache;\nimport org.hibernate.annotations.CacheConcurrencyStrategy;\n\n@Entity\n@Table(name = \"F\")\n@Cache(usage=CacheConcurrencyStrategy.READ_WRITE)\n@NamedQueries({ @NamedQuery(name = \"F.findAll\", query = \"SELECT f FROM F f\")})\npublic class F implements Serializable {\n   .....\n}\n</code></pre>\n\n<p>I added the following to persistence.xml:</p>\n\n<pre><code>&lt;property name=\"hibernate.cache.provider_class\" value=\"org.hibernate.cache.EhCacheProvider\"/&gt;\n&lt;property name=\"hibernate.cache.provider_configuration_file_resource_path\" value=\"/ehcache.xml\"/&gt;\n&lt;property name=\"hibernate.cache.use_second_level_cache\" value=\"true\"/&gt;\n</code></pre>\n\n<p>And when I try to compile I get the following error: </p>\n\n<blockquote>\n  <p>/persistence/F.class): warning: Cannot\n  find annotation method 'usage()' in\n  type\n  'org.hibernate.annotations.Cache':\n  class file for\n  org.hibernate.annotations.Cache not\n  found An exception has occurred in the\n  compiler (1.6.0_16). Please file a bug\n  at the Java Developer Connection\n  (<a href=\"http://java.sun.com/webapps/bugreport\">http://java.sun.com/webapps/bugreport</a>)\n  after checking the Bug Parade for\n  duplicates. Include your program and\n  the following diagnostic in your\n  report. Thank you.\n  com.sun.tools.javac.code.Symbol$CompletionFailure:\n  class file for\n  org.hibernate.annotations.CacheConcurrencyStrategy\n  not found</p>\n</blockquote>\n\n<p>Can anyone help me out here and let me know what I need to do or am doing wrong currently ? </p>\n"},{"tags":["java","hibernate","jpa","hql","jpql"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":80,"score":0,"question_id":12746954,"title":"Hibernate Beginner Doubts","body":"<p>Hi I am new to hibernate. I read a lot of threads and discussions about which book and what specification to read. But the problem is some threads are so old that I don't understand where to start from. I started with Hibernate specification in Developer Guide which I think is too complicated. So I read some small tutorials. \nActually I am assigned to some project where I was told that Hibernate is used. But because of little knowledge about Hibernate I am totally lost.  In the code I can see that in Maven pom Hibernate is used. I found META-INF/Persistence.xml which contains: </p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt; \n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\" version=\"1.0\"&gt;\n &lt;persistence-unit name=\"EmployeeDatabase\" transaction-type=\"JTA\"&gt;\n    &lt;jta-data-source&gt;java:EmpDS&lt;/jta-data-source&gt;   \n&lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt; \n&lt;class&gt;entity.Employee&lt;/class&gt; \n&lt;properties&gt;\n  &lt;property name=\"hibernate.connection.password\" value=\"Usha\" /&gt; \n  &lt;property name=\"hibernate.archive.autodetection\" value=\"class\" /&gt; \n  &lt;property name=\"hibernate.connection.driver_class\" value=\"com.mysql.jdbc.Driver\" /&gt; \n  &lt;property name=\"hibernate.connection.url\" value=\"jdbc:mysql://localhost:3306/Employee\" /&gt; \n  &lt;property name=\"hibernate.connection.username\" value=\"Usha\" /&gt; \n  &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"update\" /&gt; \n  &lt;property name=\"hibernate.show_sql\" value=\"false\" /&gt; \n    &lt;/properties&gt;\n &lt;/persistence-unit&gt;\n</code></pre>\n\n<p></p>\n\n<p>I thought for hibernate configuration has to be done through hibernate.cfg.xml. But I coulnt find it anywhere. And in the code while doing queries there was no reference to hibernate. All the queries were done using import javax.persistence.Query. So I guess JPQL is used for doing the queries. </p>\n\n<p><strong>So my question is : Is this really Hibernate or JPA or what??</strong> </p>\n\n<p>When can i say this is using Hibernate for persistence. </p>\n\n<p>When to use JPQL and when to use HQL?</p>\n\n<p>Please please can anyone guide me through this. Just be clear I want to learn Hibernate first and then dig further into my assignment. But I do not know where to start from. Which book  or tutorial is best .</p>\n\n<p>Best Regards,\nJeena</p>\n"},{"tags":["hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12854015,"title":"Does hibernate (and JPA) treat @OneToOne and @ManyToOne differently?","body":"<p>I've always used the <code>@OneToOne</code> and <code>@ManyToOne</code> relations based on the logic behind the relation - if it is only one entity on each end, then it's one-to-one. If the entity on the other side may have more than one corresponding entities on this side, then it's many-to-one. i.e. a student has exactly one student book, and each student book belongs to exactly one student (one-to-one)</p>\n\n<p>However, I just saw a couple of <code>@OneToOne</code> annotation in our codebase that are not actually one-to-one. Somehow, this has worked for quite some time, and I wonder whether hibernate treats these annotations differently?</p>\n\n<p>Probably it won't allow a <code>@OneToMany</code> mapping on the other side, if there's <code>@OneToOne</code> on an entity, but apart from that?</p>\n"},{"tags":["mysql","hibernate","jpa-2.0","ddl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12833424,"title":"Generate schema from entities using JPA2 + Hibernate + Eclipse 4.2 + MySQL 5.5","body":"<p>I am new to Hibernate/JPA and I am stuck at what I think is the last step.\nI have created a schema in my MySQL instance and want to generate the tables for the schema from the JPA entities I have created. \nI get an option in JPA Tools in eclipse \"Generate Tables from Entities\" but that gives me a message \"Generate Tables from Entities is not supported by the Generic Platform. \nIs there a plugin or tool I need to use to make this work ?</p>\n"},{"tags":["java","hibernate","jpa","persistence"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12849545,"title":"Is this correct (better) object relational mapping?","body":"<p>I have really got stuck with using Hibernate in my project. Some issues I have described here:  <a href=\"http://stackoverflow.com/q/12795921/845220\">Hibernate: getting too many rows</a> I have started wondering if my code is correct. I am working on a huge project and I have had to define mapping classes with annotations on my own. But when the problems have began to occur I have decided to recreate part of database separate to the project and try to generate entities in IDE.</p>\n\n<p>I have two tables: <code>My</code> and <code>Option</code>. <code>My</code> has primary key: column <code>qwerty</code> and <code>property</code>. <code>Property</code>is the foreign key from <code>Option</code> table. And of course <code>Option</code> has <code>property</code> as a primary key.</p>\n\n<p>In my solution I have created <code>@Embeddable</code> <code>MyPK</code> class with two properties: <code>String qwerty</code> and <code>String property</code>. In my <code>My</code> entity I have of course <code>@EmbeddedId</code> <code>MyPK</code> and also <code>property</code> (the same column name as in the <code>MyPK</code>) but is this <code>Option</code> object, not String as in the <code>MyPK</code>.</p>\n\n<pre><code>@ManyToOne\n@JoinColumn(name = \"property\", nullable = false, insertable = false, updatable = false)\nprotected Option option;\n</code></pre>\n\n<p>This is entity generated by Hibernate Tools in Intellij Idea. There isn't <code>EmbeddedId</code>, but there is <code>@IdClass</code>. I have thought that <code>@IdClass</code> is only for basic types. But I have a object as a part of my primary key. However there is also <code>OptionEntity</code> object here. Is this correct to keep basic type and object type for one column?</p>\n\n<pre><code>@javax.persistence.IdClass(test.go.MyEntityPK.class)\n@javax.persistence.Table(name = \"MY\", schema = \"PUBLIC\", catalog = \"PUBLIC\")\n@Entity\npublic class MyEntity {\n    private String qwerty;\n\n    @javax.persistence.Column(name = \"QWERTY\")\n    @Id\n    public String getQwerty() {\n        return qwerty;\n    }\n\n    public void setQwerty(String qwerty) {\n        this.qwerty = qwerty;\n    }\n\n    private String text;\n\n    @javax.persistence.Column(name = \"TEXT\")\n    @Basic\n    public String getText() {\n        return text;\n    }\n\n    public void setText(String text) {\n        this.text = text;\n    }\n\n    private String lang;\n\n    @javax.persistence.Column(name = \"PROPERTY\")\n    @Id\n    public String getProperty() {\n        return property;\n    }\n\n    public void setProperty(String property) {\n        this.property= property;\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        //equals\n    }\n\n    @Override\n    public int hashCode() {\n        //hashCode\n    }\n\n    private OptionEntity optionByProperty;\n\n    @ManyToOne\n    @javax.persistence.JoinColumn(name = \"PROPERTY\", referencedColumnName = \"PROPERTY\", nullable = false)\n    public OptionEntity getOptionByProperty() {\n        return optionByProperty;\n    }\n\n    public void setOptionByProperty(OptionEntity optionByProperty) {\n        this.optionByProperty = optionByProperty;\n    }\n}\n</code></pre>\n\n<p>This is <code>MyEntityPK</code> generated class:</p>\n\n<pre><code>public class MyEntityPK implements Serializable {\n    private String qwerty;\n\n    @Id\n    @Column(name = \"qwerty\")\n    public String getQwerty() {\n        return qwerty;\n    }\n\n    public void setQwerty(String qwerty) {\n        this.qwerty = qwerty;\n    }\n\n    private String property;\n\n    @Id\n    @Column(name = \"PROPERTY\")\n    public String getProperty() {\n        return property;\n    }\n\n    public void setProperty(String property) {\n        this.property = property;\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        //equals\n    }\n\n    @Override\n    public int hashCode() {\n        //hashCode\n    }\n}\n</code></pre>\n\n<p><code>OptionEntity</code> below. No special points aren't in this entity. I would like only <code>@Version</code> annotation on <code>version</code> property and also <code>List&lt;MyEntity&gt;</code> instead of <code>Collection&lt;MyEntity&gt;</code>.</p>\n\n<pre><code>@javax.persistence.Table(name = \"OPTION\", schema = \"PUBLIC\", catalog = \"PUBLIC\")\n@Entity\npublic class OptionEntity {\n    private Long version;\n\n    @javax.persistence.Column(name = \"VERSION\")\n    @Basic\n    public Long getVersion() {\n        return version;\n    }\n\n    public void setVersion(Long version) {\n        this.version = version;\n    }\n\n    private String property;\n\n    @javax.persistence.Column(name = \"PROPERTY\")\n    @Id\n    public String getProperty() {\n        return property;\n    }\n\n    public void setProperty(String property) {\n        this.property = property;\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        //equals\n    }\n\n    @Override\n    public int hashCode() {\n        //hashcode\n    }\n\n    private Collection&lt;MyEntity&gt; myByProperty;\n\n    @OneToMany(mappedBy = \"optionByProperty\")\n    public Collection&lt;MyEntity&gt; getMyByProperty() {\n        return myByProperty;\n    }\n\n    public void setMyByProperty(Collection&lt;MyEntity&gt; myByProperty) {\n        this.myByProperty = myByProperty;\n    }\n}\n</code></pre>\n\n<p>What option is the most proper and less problematic? The one that I have described or the one that pasted?</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12860347,"title":"How to specify data type when using native SQL query?","body":"<p>I am using hibernate. I have written native SQL query and I would like to specify data type of one of the column as below.</p>\n\n<pre><code>sqlQuery.addScalar(\"NAME\", STRING);\n</code></pre>\n\n<p>I am querying 5 columns and <code>ID</code> is one of the column among them. But if I use <code>addScalar</code>, it is not returning all the columns and is returning only <code>NAME</code>. the reason why I am specifying the column type is <code>NAME</code> column is of <code>CHAR(10)</code> in table but I want <code>String</code> type. How can I specify the datatype and get all the columns?</p>\n"},{"tags":["hibernate","jpa","longtext"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":223,"score":2,"question_id":12400825,"title":"JPA: \"Data too long for column\" does not change","body":"<p>Here's a strange problem.</p>\n\n<p>One of my entities \"Machinery\" has got a <em>String</em> property called \"notes\". </p>\n\n<p>Jpa2+Hibernate generates the schema for me, in my case the rdbms is a MySQL.</p>\n\n<p>\"notes\" is created as a VARCHAR(255) column, it's right.</p>\n\n<p>Users begin creating records and all works perfectly but then.... dumb me! \nSome users got the infamous <em>Data too long for column \"notes\"</em> error.</p>\n\n<p>That field hasn't enough room for user's machinery notes! Ok, no problem. Let's change the schema!</p>\n\n<p>So I open my entity class and change my property to:</p>\n\n<pre><code>@Column(length=1000000)\n@Lob\nprivate String notes;\n</code></pre>\n\n<p>By the way, my <em>persistence.xml</em> declares:</p>\n\n<pre><code>&lt;property name=\"hibernate.hbm2ddl.auto\" value=\"update\" /&gt;\n</code></pre>\n\n<p>After an application restart, I'm glad to Hibernate-JPA for altering my \"notes\" column to a LONGTEXT (it's enough for me).</p>\n\n<p>So I first try using my application to create a new \"long-noted\" record  and..... I STILL GET THE ERROR?!? (Data too long?!? But it's a long text now).</p>\n\n<p>Then I try doing a raw INSERT from the mysql command line and.... it works! I can insert long notes in that field! </p>\n\n<p>Finally, I DROP my local/staging DB schema and change persistence.xml to \"create\" and... it works.</p>\n\n<p>Does JPA still thinks that it's a VARCHAR? Does it have some sort of cache or some place in which it stores schema's information?</p>\n\n<p>I can't drop my production db, obviously. So, what can I do to reset or change the column type?</p>\n\n<p>I am using JBossAS7+JPA2(Hibernate)</p>\n"},{"tags":["java","hibernate","jodatime","usertype"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12658521,"title":"Mapping Exception with Hibernate 4.0, UserType 3.0.0.CR4 and Joda Time 2.1","body":"<p>I am currently trying to persist Joda Time in Hibernate using <a href=\"http://usertype.sourceforge.net/\" rel=\"nofollow\">usertype</a>, but I keep on getting the following error in eclipse.</p>\n\n<p><img src=\"http://i.stack.imgur.com/vAqAL.png\" alt=\"Error Message\"></p>\n\n<p>(failed.org.hibernate.MappingException: Could not determine type for: org.jadira.usertype.dateandtime.jsr310.PersistentLocalDateTime, at table: MODEL_OBJECT, for columns: [org.hibernate.mapping.Column(MODIFIED_DATE_TIME)])</p>\n\n<p>my xml file looks like this</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE ibernate-mapping PUBLIC \n\"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping package=\"model\" &gt;\n    &lt;class name=\"ModelObject\" table=\"MODEL_OBJECT\"&gt;\n        &lt;id name=\"id\" column=\"MODEL_ID\" &gt;\n            &lt;generator class=\"native\"&gt;&lt;/generator&gt;\n    &lt;/id&gt;\n    &lt;property name=\"modifiedDateTime\"             \n            type=\"org.jadira.usertype.dateandtime.jsr310.PersistentLocalDateTime\"\n            column=\"MODIFIED_DATE_TIME\"/&gt;\n        &lt;property name=\"creationDateTime\"\n            type=\"org.jadira.usertype.dateandtime.jsr310.PersistentLocalDateTime\"\n            column=\"CREATION_DATE_TIME\"/&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;`\n</code></pre>\n\n<p>and my java file looks like this</p>\n\n<pre><code>package model;\nimport java.beans.PropertyChangeListener;\nimport java.beans.PropertyChangeSupport;\nimport org.joda.time.LocalDateTime;\n\npublic abstract class ModelObject  {\n\nprivate PropertyChangeSupport changeSupport = new PropertyChangeSupport(this);\n\nprivate long id;\nprivate LocalDateTime  modifiedDateTime = new LocalDateTime ();\nprivate LocalDateTime  creationDateTime = new LocalDateTime ();\n\npublic Long getId(){\n    return id;\n}\n\npublic void setId(Long id){\n    firePropertyChange(\"id\", this.id, this.id = id);\n}\n\npublic LocalDateTime  getModifiedDateTime(){\n    return modifiedDateTime;\n}\n\npublic void setModifiedDateTime(LocalDateTime  modifiedDateTime) {\n    firePropertyChange(\"modifiedDateTime\", \n                this.modifiedDateTime, \n                this.modifiedDateTime = modifiedDateTime);\n}\n\npublic LocalDateTime  getCreationDateTime(){\n    return creationDateTime;\n}\n\npublic void setCreationDateTime(LocalDateTime  creationDateTime){\n    firePropertyChange(\"creationDateTime\", \n                this.creationDateTime, \n                this.creationDateTime = creationDateTime);\n}\n\npublic void addPropertyChangeSupportListener(PropertyChangeListener listener){\n    changeSupport.addPropertyChangeListener(listener);\n}\n\npublic void removePropertyChangeListener(PropertyChangeListener listener){\n    changeSupport.removePropertyChangeListener(listener);\n}\n\npublic void addPropertyChangeListener(String propertyName, PropertyChangeListener listener){\n    changeSupport.addPropertyChangeListener(propertyName, listener);\n}\n\npublic void removePropertyChangeListener(String propertyName, \n                                             PropertyChangeListener listener){\n    changeSupport.addPropertyChangeListener(propertyName, listener);\n}\n\nprotected void firePropertyChange(String propertyName, Object oldValue, Object newValue){\n    changeSupport.firePropertyChange(propertyName, oldValue, newValue);\n}\n\n}\n</code></pre>\n\n<p>I have added usertype.spi-3.0.0.jar and usertype.core.3.0.0.CR3.jar to my class path.</p>\n\n<p>I have no idea what is going on here so help would be greatly appreciated</p>\n"},{"tags":["java","oracle","hibernate","spring","blob"],"answer_count":5,"favorite_count":6,"up_vote_count":19,"down_vote_count":0,"view_count":2324,"score":19,"question_id":9253323,"title":"How to persist LARGE BLOBs (>100MB) in Oracle using Hibernate","body":"<p>I'm struggling to find a way to insert LARGE images (>100MB, mostly TIFF format) in my Oracle database, using BLOB columns.</p>\n\n<p>I've searched thoroughly across the web and even in StackOverflow, without being able to find an answer to this problem.<br/> \nFirst of all, the problem...then a short section on the relevant code (java classes/configuration), finally a <em>third section</em> where i show the junit test i've written to test image persistence (i receive the error during my junit test execution)</p>\n\n<h3>Edit: i've added a section, at the end of the question, where i describe some tests and analysis using JConsole</h3>\n\n<h1>The problem</h1>\n\n<p>I receive an <code>java.lang.OutOfMemoryError: Java heap space</code> error using hibernate and trying to persist very large images/documents:</p>\n\n<pre><code>java.lang.OutOfMemoryError: Java heap space\nat java.util.Arrays.copyOf(Arrays.java:2786)\nat java.io.ByteArrayOutputStream.toByteArray(ByteArrayOutputStream.java:133)\nat org.hibernate.type.descriptor.java.DataHelper.extractBytes(DataHelper.java:190)\nat org.hibernate.type.descriptor.java.BlobTypeDescriptor.unwrap(BlobTypeDescriptor.java:123)\nat org.hibernate.type.descriptor.java.BlobTypeDescriptor.unwrap(BlobTypeDescriptor.java:47)\nat org.hibernate.type.descriptor.sql.BlobTypeDescriptor$4$1.doBind(BlobTypeDescriptor.java:101)\nat org.hibernate.type.descriptor.sql.BasicBinder.bind(BasicBinder.java:91)\nat org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:283)\nat org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:278)\nat org.hibernate.type.AbstractSingleColumnStandardBasicType.nullSafeSet(AbstractSingleColumnStandardBasicType.java:89)\nat org.hibernate.persister.entity.AbstractEntityPersister.dehydrate(AbstractEntityPersister.java:2184)\nat org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2430)\nat org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2874)\nat org.hibernate.action.EntityInsertAction.execute(EntityInsertAction.java:79)\nat org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)\nat org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:265)\nat org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:184)\nat org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\nat org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)\nat org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1216)\nat it.paoloyx.blobcrud.manager.DocumentManagerTest.testInsertDocumentVersion(DocumentManagerTest.java:929)\n</code></pre>\n\n<h1>The code (domain objects, repository classes, configuration)</h1>\n\n<p>Here is the stack of technologies i'm using (from DB to business logic tier). I use JDK6.</p>\n\n<ul>\n<li>Oracle Database 10g Enterprise Edition Release 10.2.0.4.0 - Prod</li>\n<li>ojdbc6.jar (for 11.2.0.3 release)</li>\n<li>Hibernate 4.0.1 Final</li>\n<li>Spring 3.1.GA RELEASE</li>\n</ul>\n\n<p>I've two domain classes, mapped in a one-to-many fashion. A <code>DocumentVersion</code> has many <code>DocumentData</code>, each of one can represent different binary content for the same <code>DocumentVersion</code>.</p>\n\n<p>Relevant extract from <code>DocumentVersion</code> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"DOCUMENT_VERSION\")\npublic class DocumentVersion implements Serializable {\n\nprivate static final long serialVersionUID = 1L;\nprivate Long id;\nprivate Set&lt;DocumentData&gt; otherDocumentContents = new HashSet&lt;DocumentData&gt;(0);\n\n\n@Id\n@GeneratedValue(strategy = GenerationType.TABLE)\n@Column(name = \"DOV_ID\", nullable = false)\npublic Long getId() {\n    return id;\n}\n\n@OneToMany\n@Cascade({ CascadeType.SAVE_UPDATE })\n@JoinColumn(name = \"DOD_DOCUMENT_VERSION\")\npublic Set&lt;DocumentData&gt; getOtherDocumentContents() {\n    return otherDocumentContents;\n}\n</code></pre>\n\n<p>Relevant extract from <code>DocumentData</code> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"DOCUMENT_DATA\")\npublic class DocumentData {\n\nprivate Long id;\n\n/**\n * The binary content (java.sql.Blob)\n */\nprivate Blob binaryContent;\n\n@Id\n@GeneratedValue(strategy = GenerationType.TABLE)\n@Column(name = \"DOD_ID\", nullable = false)\npublic Long getId() {\n    return id;\n}\n\n@Lob\n@Column(name = \"DOD_CONTENT\")\npublic Blob getBinaryContent() {\n    return binaryContent;\n}\n</code></pre>\n\n<p>Here are my Spring and Hibernate configuration main parameters:</p>\n\n<pre><code>&lt;bean id=\"sessionFactory\"\n    class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n    &lt;property name=\"packagesToScan\" value=\"it.paoloyx.blobcrud.model\" /&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.Oracle10gDialect&lt;/prop&gt;\n            &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;create&lt;/prop&gt;\n            &lt;prop key=\"hibernate.jdbc.batch_size\"&gt;0&lt;/prop&gt;\n            &lt;prop key=\"hibernate.jdbc.use_streams_for_binary\"&gt;true&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n&lt;bean class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"\n    id=\"transactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n&lt;tx:annotation-driven transaction-manager=\"transactionManager\" /&gt;\n</code></pre>\n\n<p>My datasource definition:</p>\n\n<pre><code>&lt;bean class=\"org.apache.commons.dbcp.BasicDataSource\"\n    destroy-method=\"close\" id=\"dataSource\"&gt;\n    &lt;property name=\"driverClassName\" value=\"${database.driverClassName}\" /&gt;\n    &lt;property name=\"url\" value=\"${database.url}\" /&gt;\n    &lt;property name=\"username\" value=\"${database.username}\" /&gt;\n    &lt;property name=\"password\" value=\"${database.password}\" /&gt;\n    &lt;property name=\"testOnBorrow\" value=\"true\" /&gt;\n    &lt;property name=\"testOnReturn\" value=\"true\" /&gt;\n    &lt;property name=\"testWhileIdle\" value=\"true\" /&gt;\n    &lt;property name=\"timeBetweenEvictionRunsMillis\" value=\"1800000\" /&gt;\n    &lt;property name=\"numTestsPerEvictionRun\" value=\"3\" /&gt;\n    &lt;property name=\"minEvictableIdleTimeMillis\" value=\"1800000\" /&gt;\n    &lt;property name=\"validationQuery\" value=\"${database.validationQuery}\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>where properties are taken from here:</p>\n\n<pre><code>database.driverClassName=oracle.jdbc.OracleDriver\ndatabase.url=jdbc:oracle:thin:@localhost:1521:devdb\ndatabase.username=blobcrud\ndatabase.password=blobcrud\ndatabase.validationQuery=SELECT 1 from dual\n</code></pre>\n\n<p>I've got a service class, that delegates to a repository class:</p>\n\n<pre><code>@Transactional\npublic class DocumentManagerImpl implements DocumentManager {\n\nDocumentVersionDao documentVersionDao;\n\npublic void setDocumentVersionDao(DocumentVersionDao documentVersionDao) {\n    this.documentVersionDao = documentVersionDao;\n}\n</code></pre>\n\n<p>and now the relevant extracts from repository classes:</p>\n\n<pre><code>public class DocumentVersionDaoHibernate implements DocumentVersionDao {\n\n@Autowired\nprivate SessionFactory sessionFactory;\n\n@Override\npublic DocumentVersion saveOrUpdate(DocumentVersion record) {\n    this.sessionFactory.getCurrentSession().saveOrUpdate(record);\n    return record;\n}\n</code></pre>\n\n<h1>The JUnit test that causes the error</h1>\n\n<p>If i run the following unit test i've got the aforementioned error (<code>java.lang.OutOfMemoryError: Java heap space</code>):</p>\n\n<pre><code>@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = { \"classpath*:META-INF/spring/applicationContext*.xml\" })\n@Transactional\npublic class DocumentManagerTest {\n\n@Autowired\nprotected DocumentVersionDao documentVersionDao;\n\n@Autowired\nprotected SessionFactory sessionFactory;\n\n@Test\npublic void testInsertDocumentVersion() throws SQLException {\n\n    // Original mock document content\n    DocumentData dod = new DocumentData();\n    // image.tiff is approx. 120MB\n    File veryBigFile = new File(\"/Users/paoloyx/Desktop/image.tiff\");\n    try {\n        Session session = this.sessionFactory.getCurrentSession();\n        InputStream inStream = FileUtils.openInputStream(veryBigFile);\n        Blob blob = Hibernate.getLobCreator(session).createBlob(inStream, veryBigFile.length());\n        dod.setBinaryContent(blob);\n    } catch (IOException e) {\n        e.printStackTrace();\n        dod.setBinaryContent(null);\n    }\n\n    // Save a document version linked to previous document contents\n    DocumentVersion dov = new DocumentVersion();\n    dov.getOtherDocumentContents().add(dod);\n    documentVersionDao.saveOrUpdate(dov);\n    this.sessionFactory.getCurrentSession().flush();\n\n    // Clear session, then try retrieval\n    this.sessionFactory.getCurrentSession().clear();\n    DocumentVersion dbDov = documentVersionDao.findByPK(insertedId);\n    Assert.assertNotNull(\"Il document version ritornato per l'id \" + insertedId + \" è nullo\", dbDov);\n    Assert.assertNotNull(\"Il document version recuperato non ha associato contenuti aggiuntivi\", dbDov.getOtherDocumentContents());\n    Assert.assertEquals(\"Il numero di contenuti secondari non corrisponde con quello salvato\", 1, dbDov.getOtherDocumentContents().size());\n}\n</code></pre>\n\n<p>The <strong><em>same code</em></strong> works against a PostreSQL 9 installation. The images is being written in the database. \nDebugging my code, i've been able to find that the PostgreSQL jdbc drivers writes on the database using a buffered output stream....while the Oracle OJDBC driver tries to allocate all at once all the <code>byte[]</code>representing the image.</p>\n\n<p>From the error stack:</p>\n\n<pre><code>java.lang.OutOfMemoryError: Java heap space\nat java.util.Arrays.copyOf(Arrays.java:2786)\nat java.io.ByteArrayOutputStream.toByteArray(ByteArrayOutputStream.java:133)\n</code></pre>\n\n<p>Is the error due to this behavior?\nCan anyone give me some insights on this problem?</p>\n\n<p>Thanks everyone.</p>\n\n<h1>Memory Tests with JConsole</h1>\n\n<p>Thanks to the suggestions received for my question, i've tried to do some simple tests to show memory usage of my code using two different jdbc drivers, one for PostgreSQL and one for Oracle.\nTest setup:</p>\n\n<ol>\n<li>The test has been conducted using the JUnit test described in the previous section.</li>\n<li>JVM Heap Size has been set to 512MB, using parameter <em>-Xmx512MB</em></li>\n<li>For Oracle database, I've used <em>ojdbc6.jar</em> driver</li>\n<li>For Postgres database, I've used <em>9.0-801.jdbc3 driver</em> (via Maven)</li>\n</ol>\n\n<h3>First test, with a file of approx 150MB</h3>\n\n<p>In this first test, both Oracle and Postgres <strong><em>passed</em></strong> the test (this is BIG news).\nThe file is sized 1/3 of available JVM heap size.\nHere the picture of JVM memory consumption:</p>\n\n<p>Testing Oracle, 512MB Heap Size, 150MB file\n<img src=\"http://i.stack.imgur.com/xUvA1.png\" alt=\"Testing Oracle, 512MB Heap Size, 150MB file\"></p>\n\n<p>Testing PostgreSQL, 512MB Heap Size, 150MB file\n<img src=\"http://i.stack.imgur.com/wXS76.png\" alt=\"Testing PostgreSQL, 512MB Heap Size, 150MB file\"></p>\n\n<h3>Second test, with a file of approx 485MB</h3>\n\n<p>In this second test, only Postgres passed the test and Oracle <strong><em>failed</em></strong> it .\nThe file is sized very near the size of the available JVM heap space.\nHere the picture of JVM memory consumption:</p>\n\n<p>Testing Oracle, 512MB Heap Size, 485MB file\n<img src=\"http://i.stack.imgur.com/81FMO.png\" alt=\"Testing Oracle, 512MB Heap Size, 485MB file\"></p>\n\n<p>Testing PostgreSQL, 512MB Heap Size, 485MB file\n<img src=\"http://i.stack.imgur.com/U9uKb.png\" alt=\"Testing PostgreSQL, 512MB Heap Size, 485MB file\"></p>\n\n<h3>Analysis of the tests:</h3>\n\n<p>It seems that PostgreSQL driver handles memory without surpassing a certain threshold, while Oracle driver behaves very differently.</p>\n\n<p>I can't honestly explain why Oracle jdbc driver leads me to error (the same <code>java.lang.OutOfMemoryError: Java heap space</code>) when using file sized near the available heap space.</p>\n\n<p>Is there anyone that can give me more insights?\nThanks a lot for you help :)</p>\n"},{"tags":["hibernate","nhibernate-mapping","composite-key"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12859472,"title":"Hibernate Count query with composite key","body":"<p>I have one Table : Module\nwith primery key (ModuleId + ProjectId)\nProjectId is foreign key to Project Table.</p>\n\n<p>Please help me to write the query to get \n1) All Modules in the Table.\n2) All Modules Under A given Project.\n3) select count() for the above two queries.</p>\n\n<pre><code>//ModuleDo Class\npublic class ModuleDo implements RFDDo {\n\nprivate static final long serialVersionUID = 1L;\n@EmbeddedId\nprotected ModuleDoPK moduleDoPK;\n@Basic(optional = false)\n@NotNull\n@Column(name = \"DATE_CREATED\", nullable = false)\n@Temporal(TemporalType.TIMESTAMP)\nprivate Date dateCreated;\n@Basic(optional = false)\n@NotNull\n@Column(name = \"DATE_MODIFIED\", nullable = false)\n@Temporal(TemporalType.TIMESTAMP)\nprivate Date dateModified;\n@Size(max = 100)\n@Column(name = \"MODULE_DETAILS\", length = 100)\nprivate String moduleDetails;\n@Basic(optional = false)\n@NotNull\n@Size(min = 1, max = 50)\n@Column(name = \"MODULE_NAME\", nullable = false, length = 50)\nprivate String moduleName;\n@JoinColumn(name = \"USER_CREATED\", referencedColumnName = \"USER_ID\", nullable = false)\n@ManyToOne(optional = false)\nprivate UserDo userCreatedDo;\n@JoinColumn(name = \"USER_MODIFIED\", referencedColumnName = \"USER_ID\", nullable = false)\n@ManyToOne(optional = false)\nprivate UserDo userModifiedDo;\n@JoinColumn(name = \"PROJECT_ID\", referencedColumnName = \"PROJECT_ID\", nullable = false, insertable = false, updatable = false)\n@ManyToOne(optional = false)\nprivate ProjectDo projectDo;\n}\n\n//ModuleDoPK Class\n@Embeddable\npublic class ModuleDoPK implements Serializable {\n@Basic(optional = false)\n@NotNull\n@Size(min = 1, max = 50)\n@Column(name = \"MODULE_ID\", nullable = false, length = 50)\nprivate String moduleId;\n@Basic(optional = false)\n@NotNull\n@Size(min = 1, max = 50)\n@Column(name = \"PROJECT_ID\", nullable = false, length = 50)\nprivate String projectId;\n}\n\nI tried this :\nem.createQuery(\"SELECT COUNT(p) FROM ModuleDO p WHERE p.moduleDoPK.moduleId =:moduleDoPK.moduleId AND p.moduleDoPK.projectId =:moduleDoPK.projectId\")\n\nIts Returning Error:\nCaused by: java.sql.SQLException: Operand should contain 1 column(s)\n</code></pre>\n"},{"tags":["sql","oracle","hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12858542,"title":"SQL delete query with foreign key constraint","body":"<p>I know that this question belongs to the very early stages of the database theory, but I have not encountered such a problem since several months. If someone has a database with some tables associated together as \"chain\" with foreign keys and they want to delete a record from a table which has some \"dependent\" tables, what obstacles arise? In particular, in a database with tables: Person, Profile, Preference, Filter exist the associations as <code>Person.id</code> is foreign key in <code>Profile</code> and <code>Profile.id</code> is foreign key in <code>Preference</code> and <code>Filter.id</code> is foreign key in <code>Preference</code>, so as that all the associations<code>enter code here</code> are <code>OneToMany</code>. Is it possible to delete a Person with a simple query:</p>\n\n<pre><code>Delete from Person p where p.id= 34;\n</code></pre>\n\n<p>If no, how should look like the query in order to perform the delete successfully? \nIf the database in the application is managed by hibernate, what constraints (<code>annotations</code>) should I apply to the associated fields of each entity, so as to be able with the above simple query to perform the delete?       </p>\n"},{"tags":["java","hibernate","class","multiple","criteria"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12858893,"title":"multiple classes in Criteria class","body":"<p>I have two class <code>AcctMast</code>  and <code>DealerDtls</code> which are linked to their <code>resp.tables</code> <code>acctMast</code> and <code>dealerDtls</code>.</p>\n\n<p>I want to use <code>Criteria</code> class in order to find out \nAll dealer details whose <code>acctNo=XXX</code>,<code>dealerCode=XXX</code>,<code>CustCode=XXX</code>(Getting these three as input from my API).</p>\n\n<p>But the problem is <code>custCode</code> column is present in <code>AcctMast</code> and <code>dealerCode</code> and <code>acctno</code> are the column of <code>DealerDtls</code>.\nThe conflict is that how to use multiple class using <code>Criteria</code> so that I can get  all the required details .</p>\n\n<p>One more thing,everytime I got <code>custCode</code> and <code>Acctno</code> as input but <code>dealercode</code> is depend on user.It may be given as input or it may not means sometimes I got <code>dealerCode</code> as NULL also.</p>\n"},{"tags":["java","mysql","hibernate","annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":139,"score":1,"question_id":12110037,"title":"Hibernate ConstraintViolationException maybe due to cyclic scheme","body":"<p>I have three entities A, B, C.</p>\n\n<p>A has many Bs and a C, B has many Cs. I'd like to have bidirectional relationships.</p>\n\n<p>I mapped all of this in Hibernate:</p>\n\n<pre><code>@Entity\n    @Table(name=\"TABLE_A\")\n    class A{\n\n        @Id\n        @GeneratedValue\n        private Integer a_id;\n\n        @ManyToOne\n        C c; \n\n        @OneToMany\n        List&lt;B&gt; bs;\n    }\n\n    @Entity\n    @Table(name=\"TABLE_B\")\n    class B{\n\n        @Id\n        @GeneratedValue\n        private Integer b_id;\n\n        @ManyToOne\n        A a; // inverse\n\n        @ManyToOne\n        C c;\n    }\n\n    @Entity\n    @Table(name=\"TABLE_C\")\n    class C{\n\n        @Id\n        @GeneratedValue\n        private Integer c_id;\n\n        @ManyToMany(mappedBy=\"c\")\n        List&lt;B&gt; b; // inverse\n\n        @ManyToMany(mappedBy=\"c\")\n        List&lt;A&gt; a; //inverse\n\n    }\n</code></pre>\n\n<p>I use the SchemaUpdate to get the tables generated in MySQL.\nThe problem is the following:</p>\n\n<pre><code>2012-08-24 14:57:15,437 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_A add index FKCE3C1BF0B8CF4F47 (a_id), add constraint FKCE3C1BF0B8CF4F47 foreign key (a_id) references TABLE_A (a_id)\n</code></pre>\n\n<p>A constraint is added to A to itself - This is probably due to the C->A relationship. What is wrong with the mapping?</p>\n\n<p>I created a simple test file:</p>\n\n<pre><code>    @Test\n        public void tests() throws Exception {\n            Logger l = Logger.getLogger(\"org.hibernate.tool.hbm2ddl\");\n            l.\n\nsetLevel(Level.DEBUG);\n\n        //Hibernate.enableCreationDebug();\n        A a = new A();\n\n        SessionFactory sf = configureSessionFactory();\n        Session session = sf.openSession();\n        Transaction tx = session.beginTransaction();\n        try{\n\n            session.save(a);\n            tx.commit();\n        }catch(Exception e){\n            tx.rollback();\n            throw e;\n        }finally{\n            session.close();\n        }\n\n        session = sf.openSession();\n        tx = session.beginTransaction();\n        try{\n\n            session.delete(a);\n            tx.commit();\n        }catch(Exception e){\n            tx.rollback();\n            throw e;\n        }finally{\n            session.close();\n        }\n\n    }\n\nprivate static SessionFactory configureSessionFactory() throws HibernateException {\n        Configuration configuration = new Configuration();\n\n        String DB_USER_NAME = \"kiri\";\n        String DB_USER_PWD = \"kiri\";\n        String JDBC_CONNECTION_STRING = \"jdbc:mysql://localhost/kiri\";\n\n        configuration\n                .addAnnotatedClass(HibernateCyclicTest.A.class)\n                .addAnnotatedClass(HibernateCyclicTest.B.class)\n                .addAnnotatedClass(HibernateCyclicTest.C.class)\n\n                .setProperty(\"hibernate.dialect\", \"org.hibernate.dialect.MySQL5InnoDBDialect\")\n                .setProperty(\"hibernate.connection.driver_class\", \"com.mysql.jdbc.Driver\")\n                .setProperty(\"hibernate.connection.url\", JDBC_CONNECTION_STRING)\n                .setProperty(\"hibernate.connection.username\", DB_USER_NAME)\n                .setProperty(\"hibernate.connection.password\", DB_USER_PWD);\n\n\n        // Create or update the schema to match our objects\n        org.hibernate.tool.hbm2ddl.SchemaUpdate schemaUpdate = new SchemaUpdate(configuration);\n        schemaUpdate.execute(false,/* update schema */true);\n        ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(configuration.getProperties())\n                .buildServiceRegistry();\n        SessionFactory sessionFactory = configuration.buildSessionFactory(serviceRegistry);\n        return sessionFactory;\n    }\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code>    2012-08-24 15:03:01,719 [main] INFO  org.hibernate.tool.hbm2ddl.SchemaUpdate - HHH000228: Running hbm2ddl schema update\n2012-08-24 15:03:01,719 [main] INFO  org.hibernate.tool.hbm2ddl.SchemaUpdate - HHH000102: Fetching database metadata\n2012-08-24 15:03:01,923 [main] INFO  org.hibernate.tool.hbm2ddl.SchemaUpdate - HHH000396: Updating schema\n2012-08-24 15:03:02,025 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_A\n2012-08-24 15:03:02,025 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_A_TABLE_B\n2012-08-24 15:03:02,026 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_B\n2012-08-24 15:03:02,026 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_C\n2012-08-24 15:03:02,027 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_A\n2012-08-24 15:03:02,027 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_A_TABLE_B\n2012-08-24 15:03:02,028 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_B\n2012-08-24 15:03:02,029 [main] INFO  java.sql.DatabaseMetaData - HHH000262: Table not found: TABLE_C\n2012-08-24 15:03:02,030 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - create table TABLE_A (a_id integer not null auto_increment, c_c_id integer, primary key (a_id)) ENGINE=InnoDB\n2012-08-24 15:03:02,051 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - create table TABLE_A_TABLE_B (TABLE_A_a_id integer not null, bs_b_id integer not null, unique (bs_b_id)) ENGINE=InnoDB\n2012-08-24 15:03:02,062 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - create table TABLE_B (b_id integer not null auto_increment, a_a_id integer, c_c_id integer, primary key (b_id)) ENGINE=InnoDB\n2012-08-24 15:03:02,070 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - create table TABLE_C (c_id integer not null auto_increment, primary key (c_id)) ENGINE=InnoDB\n2012-08-24 15:03:02,078 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_A add index FKCE3C1BF0B8CF4F47 (a_id), add constraint FKCE3C1BF0B8CF4F47 foreign key (a_id) references TABLE_A (a_id)\n2012-08-24 15:03:02,087 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_A add index FKCE3C1BF066FAB663 (c_c_id), add constraint FKCE3C1BF066FAB663 foreign key (c_c_id) references TABLE_C (c_id)\n2012-08-24 15:03:02,097 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_A_TABLE_B add index FK64E4EEA2F8F999F6 (TABLE_A_a_id), add constraint FK64E4EEA2F8F999F6 foreign key (TABLE_A_a_id) references TABLE_A (a_id)\n2012-08-24 15:03:02,107 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_A_TABLE_B add index FK64E4EEA2C26A7AD5 (bs_b_id), add constraint FK64E4EEA2C26A7AD5 foreign key (bs_b_id) references TABLE_B (b_id)\n2012-08-24 15:03:02,123 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_B add index FKCE3C1BF1B8CFC3A7 (b_id), add constraint FKCE3C1BF1B8CFC3A7 foreign key (b_id) references TABLE_B (b_id)\n2012-08-24 15:03:02,141 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_B add index FKCE3C1BF163901C65 (a_a_id), add constraint FKCE3C1BF163901C65 foreign key (a_a_id) references TABLE_A (a_id)\n2012-08-24 15:03:02,151 [main] DEBUG org.hibernate.tool.hbm2ddl.SchemaUpdate - alter table TABLE_B add index FKCE3C1BF166FAB663 (c_c_id), add constraint FKCE3C1BF166FAB663 foreign key (c_c_id) references TABLE_C (c_id)\n2012-08-24 15:03:02,161 [main] INFO  org.hibernate.tool.hbm2ddl.SchemaUpdate - HHH000232: Schema update complete\n2012-08-24 15:03:02,583 [main] WARN  org.hibernate.engine.jdbc.spi.SqlExceptionHelper - SQL Error: 1451, SQLState: 23000\n2012-08-24 15:03:02,583 [main] ERROR org.hibernate.engine.jdbc.spi.SqlExceptionHelper - Cannot delete or update a parent row: a foreign key constraint fails (`kiri`.`table_a`, CONSTRAINT `FKCE3C1BF0B8CF4F47` FOREIGN KEY (`a_id`) REFERENCES `TABLE_A` (`a_id`))\n</code></pre>\n\n<p>Here is the stack:</p>\n\n<pre><code>    org.hibernate.exception.ConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (`kiri`.`table_a`, CONSTRAINT `FKCE3C1BF0B8CF4F47` FOREIGN KEY (`a_id`) REFERENCES `TABLE_A` (`a_id`))\n    at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:74)\n    at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:49)\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:125)\n    at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:110)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:129)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81)\n    at $Proxy13.executeUpdate(Unknown Source)\n    at org.hibernate.engine.jdbc.batch.internal.NonBatchingBatch.addToBatch(NonBatchingBatch.java:56)\n    at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:3134)\n    at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:3337)\n    at org.hibernate.action.internal.EntityDeleteAction.execute(EntityDeleteAction.java:100)\n    at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362)\n    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:354)\n    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:280)\n    at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:326)\n    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52)\n    at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1214)\n    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:403)\n    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:101)\n    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175)\n    at com.kireego.tests.HibernateCyclicTest.tests(HibernateCyclicTest.java:59)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Cannot delete or update a parent row: a foreign key constraint fails (`kiri`.`table_a`, CONSTRAINT `FKCE3C1BF0B8CF4F47` FOREIGN KEY (`a_id`) REFERENCES `TABLE_A` (`a_id`))\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\n    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\n    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)\n    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n    at com.mysql.jdbc.Util.getInstance(Util.java:386)\n    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1040)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4074)\n    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4006)\n    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2468)\n    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2629)\n    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2719)\n    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)\n    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2450)\n    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2371)\n    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2355)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.hibernate.engine.jdbc.internal.proxy.AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122)\n    ... 39 more\n</code></pre>\n\n<p>Thank you for the help.</p>\n"},{"tags":["database","hibernate","transactions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12858470,"title":"Hibernate transaction and physical transactions starts and close at the same time?","body":"<p>When I start a hibernate transaction does it open a connection to database and start a physical connection there? The question is the same for closing a hibernate transaction so does it close the physical transaction immediately?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","hibernate","db2","export"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":12858227,"title":"Export large data from DB to CSV","body":"<p>I need to export a Table into a CSV File and serve it to download via my JSF/Icefaces Webapplication.</p>\n\n<p>How can I do that? I have a Table with 20+ Columns and over 10 MIO rows.</p>\n\n<p>At the moment, I use a Java Thread, loading all data into ram. Then I create a new File and iterate the Collection writing row for row into the file. If the Thread is done, the user can download the large file via Servlet.</p>\n\n<p>But I dont want to write so many GB into ram. I cant secure, not to get a memory problem..</p>\n\n<p>Is it possible that hibernate does it for me? Or does somebody has an other idea?</p>\n\n<p>Im connected to a DB2 Datebase. The table I want to export is connected to a hibernate bean but it is also possible to write native sql.</p>\n\n<p>Thank you for response!</p>\n"},{"tags":["hibernate","spring-mvc","jpa-2.0","maven-3","tomcat7"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":134,"score":2,"question_id":12025956,"title":"Running JPA on Tomcat","body":"<p>I am building a maven test project which runs with:\nSpring MVC 3.1.1\nJPA, with Hibernate 4.1.4 as jpa provider\nMYSQL 5.5.x\nTOMCAT 7</p>\n\n<p>I'm trying to create a simple end-end basic use case which involves reading from DB and update.\nSince I like to stick with pure JPA I'm using spring's LocalContainerEntityManagerFactoryBean, injected to my dao using @PersistenceContext annotation.</p>\n\n<p>The problems I had at this point:</p>\n\n<ol>\n<li>I could not persist to DB (no exception thrown but no db reflection as well).</li>\n<li>I could not delete form DB (no exception thrown but no db reflection as well).</li>\n</ol>\n\n<p>I could although read from the DB.</p>\n\n<p>After going over the documentation I saw that I might missing some JPA support since TOMCAT does not include this out of the box.</p>\n\n<p>I went through <a href=\"http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch14s06.html#orm-jpa-setup-lcemfb-tomcat\" rel=\"nofollow\">this</a> and <a href=\"http://rockhoppertech.com/blog/spring-3-hibernate-jpa-tomcat-transactions/\" rel=\"nofollow\">this</a> and <a href=\"http://www.abcseo.com/tech/java/running-spring-jpa-under-tomcat\" rel=\"nofollow\">that</a> (and a few more..) and applied the following:</p>\n\n<ul>\n<li>Added the spring-instrument-tomcat dependency to my pom.xml (just to retrieve the jar).</li>\n<li>I copied that jar to my tomcat's lib directory</li>\n<li><p>Under META-INF directory, I created  a context.xml file with the following content:</p>\n\n<pre><code>&lt;Context docBase=\"SpringTest\" path=\"/SpringTest\" reloadable=\"true\"\n    source=\"org.eclipse.jst.jee.server:SpringTest\"&gt;\n    &lt;Loader\n        loaderClass=\"org.springframework.instrument.classloading.tomcat.TomcatInstrumentableClassLoader\"\n        useSystemClassLoaderAsParent=\"false\" /&gt;\n&lt;/Context&gt;\n</code></pre></li>\n<li><p>I added InstrumentationLoadTimeWeaver to my entity-manager definition</p></li>\n</ul>\n\n<p>And that was supposed to do the trick - but it didn't. I experienced the same behaviour.</p>\n\n<p>Then I encountered <a href=\"http://stackoverflow.com/questions/9420750/spring-3-1-jpa-not-inserting-data-while-running-in-tomcat\">this</a> question from stackoverflow. One of the answers suggested to add the transactions definition: <code>&lt;tx:annotation-driven proxy-target-class=\"true\" /&gt;</code> to the DispatcherServlet context (so far I had it only in my root application context). After doing that things started to work out, the transactions got committed to the DB.</p>\n\n<p>At this point I started wondering if all the rest of the stuff are still required, so I rolled back everything I did beside the addition to the DispatcherServlet and it still works perfectly!</p>\n\n<p>SO, my questions: How does it work? Do I really need all those to support JPA in tomcat? And finally, why do I need to copy the  declaration to the DispatcherServlet in order to resolve this?</p>\n\n<p>Thanks in advance,\nYogi</p>\n"},{"tags":["java","hibernate","search","lucene","hibernate-search"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":12852557,"title":"How to search in related entity (Hibernate search)","body":"<p>I am getting no where trying this thing .My requirement is to search records by their name</p>\n\n<p>Following are my related classes:</p>\n\n<p><strong>RecordFolderAnalysis.java</strong></p>\n\n<pre><code>@Indexed\npublic class RecordFolderAnalysis extends AuditableEntity implements Serializable {\n\n    @ManyToOne\n    @JoinColumn(name = \"arrivalId\", nullable = false)\n    @ContainedIn\n    private RecordFolderArrival recordFolderArrival;\n\n}\n</code></pre>\n\n<p><strong>RecordFolderArrival.java</strong></p>\n\n<pre><code>@Indexed\npublic class RecordFolderArrival extends BaseEntity implements Serializable\n  {\n\n    @Column(name=\"recordName\", unique = true, nullable = false)\n    @Field(index = Index.UN_TOKENIZED)\n    private String recordName;\n\n    @OneToMany(cascade = CascadeType.ALL, mappedBy = \"recordFolderArrival\", fetch = FetchType.LAZY, targetEntity = RecordFolderAnalysis.class)\n    @IndexedEmbedded\n    private List&lt;RecordFolderAnalysis&gt; recordFolderAnalysis=new ArrayList&lt;&gt;();\n\n  }\n</code></pre>\n\n<p><strong>Follwing is my DAO class method:</strong></p>\n\n<pre><code>@Override\n    public List&lt;T&gt; search(final String queryString, final String... fields) {\n        List searchResult = hibernateTemplate.executeFind(new HibernateCallback&lt;Object&gt;() {\n            org.hibernate.Query fullTextQuery1 = null;\n\n            @Override\n            public Object doInHibernate(Session session) throws HibernateException, SQLException {\n                try {\n                    System.out.println(\"in do in hibernate\");\n                    FullTextSession fullTextSession = Search.getFullTextSession(session);\n                    Transaction tx = fullTextSession.beginTransaction();\n                    QueryBuilder builder=fullTextSession.getSearchFactory().buildQueryBuilder().forEntity(persistentClass).get();\n                    Query luceneQuery=builder.keyword().onField(\"recordFolderArrival.recordName\").matching(queryString).createQuery();\n                    fullTextQuery1 = fullTextSession.createFullTextQuery(luceneQuery);\n\n\n                    for (Object o : fullTextQuery1.list()) {\n                        System.out.println(\"Values\" + o);\n                    }\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n                return fullTextQuery1.list();\n\n            }\n        });\n\n        return searchResult;\n    }\n</code></pre>\n\n<p>So I am searching by Record-Name by setting field name as recordFolderArrival.recordName.\nBut It is throwing an exception saying</p>\n\n<blockquote>\n  <p>recordFolderArrival.recordName field does'nt exist in\n  RecordFolderAnalysis.</p>\n</blockquote>\n\n<p>I am very new to Hibernate Search so if anyone can help me working this thing out.\nThanks and Don't worry about @Entity and other annotation they are placed where they have to be its just I have not included them in snippet.</p>\n"},{"tags":["java","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12857640,"title":"Hibernate hbm.xml files to annotated Java objects","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1496135/convert-xml-based-configuration-to-annotations\">Convert XML based configuration to Annotations</a>  </p>\n</blockquote>\n\n\n\n<p>Is there an automated way to generate annotated Hibernate Java objects from existing Hibernate hbm.xml files?</p>\n"},{"tags":["hibernate","many-to-many","cascade"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12857259,"title":"Many-to-many relationship - hibernate","body":"<p>I am using hibernate-jpa-2.0-api 1.0.0.Final and hibernate 3.5.5-Final.</p>\n\n<p>I have User and Role entities each having many-to-many relationships to each other(bidirectional). I have the following requirements below:  </p>\n\n<p><strong>1-</strong> If the deleteRole(role) method is called and this role having users then hibernate should throw exception otherwise the role can be deleted successfully.<br>\n<strong>2-</strong> If the deleteUser(user) method is called user can be deleted successfully, and related records deleted from the relationship table automatically but its role should not be deleted.<br>\n<strong>3-</strong> Furhermore; if I create new Role and add some users into its set and finally persist the Role, its users should be persisted without an extra persist operations.  </p>\n\n<p>Let's say <strong>Role</strong> is <strong>Test1</strong> and the <strong>User</strong> is <strong>Test2</strong>. The entities:</p>\n\n<p><em><strong>Test1(Role)</em></strong>  </p>\n\n<pre><code>import java.util.HashSet;\nimport java.util.Set;\n\nimport javax.persistence.CascadeType;\nimport javax.persistence.Entity;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.JoinTable;\nimport javax.persistence.ManyToMany;\n\nimport com.ttnet.model.BaseModel;\n\n@Entity\npublic class Test1 extends BaseModel {\n\n    @ManyToMany(targetEntity = Test2.class, cascade = { CascadeType.ALL })\n    @JoinTable(name = \"test1_test2\", joinColumns = { @JoinColumn(name = \"id1\", nullable = false, updatable = false) }, inverseJoinColumns = { @JoinColumn(name = \"id2\", nullable = false, updatable = false) })\n    private Set&lt;Test2&gt; test2s = new HashSet&lt;Test2&gt;(0);\n\n    public Set&lt;Test2&gt; getTest2s() {\n        return test2s;\n    }\n\n    public void setTest2s(Set&lt;Test2&gt; test2s) {\n        this.test2s = test2s;\n    }\n}  \n</code></pre>\n\n<p><em><strong>Test2(User)</em></strong>  </p>\n\n<pre><code>import java.util.HashSet;\nimport java.util.Set;\n\nimport javax.persistence.Entity;\nimport javax.persistence.ManyToMany;\n\nimport com.ttnet.model.BaseModel;\n\n@Entity\npublic class Test2 extends BaseModel {\n\n    @ManyToMany(targetEntity=Test1.class, mappedBy = \"test2s\")\n    private Set&lt;Test1&gt; test1s = new HashSet&lt;Test1&gt;(0);\n\n    public Set&lt;Test1&gt; getTest1s() {\n        return test1s;\n    }\n\n    public void setTest1s(Set&lt;Test1&gt; test1s) {\n        this.test1s = test1s;\n    }\n}\n</code></pre>\n\n<p>TestCode  </p>\n\n<pre><code>    Test1Bo test1Bo = (Test1Bo) context.getBean(\"test1Bo\");\n    Test2Bo test2Bo = (Test2Bo) context.getBean(\"test2Bo\");\n\n    Test1 t1 = new Test1();\n    Test2 t21 = new Test2();\n    Test2 t22 = new Test2();\n\n    Set&lt;Test2&gt; t2Set = t1.getTest2s();\n    t2Set.add(t21);\n    t2Set.add(t22);\n\n\n    test1Bo.addTest1(t1);  \n</code></pre>\n\n<p>This code successfully adds expected entires to all 3 tables. However, at first I tried only the Cascade.PERSIST, and Cascade.MERGE and it gives unsaved object exception. Then I tried ALL, and it completed with a success. Interesting thing is that, I added all javax Cascade operations I mean individualy but no success same exception thrown(unsaved obj...). Now, the problem is that whenever I delete the t1 it deletes t21 and t22 also and this violates the req.1. </p>\n"},{"tags":["java","hibernate","struts2","struts2-jquery"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":120,"score":0,"question_id":12812642,"title":"Java, Struts2 and AJAX. Need some directions","body":"<p>Here is the summary: I need to build a simple java web app that, among other things, will let the user create, update, delete, and view records from a few tables.</p>\n\n<p>My app is required to use Struts2 and the <a href=\"http://struts.jgeppert.com/struts2-jquery-showcase/index.action\" rel=\"nofollow\">struts2-jquery-plugin</a> to implement AJAX functionality (grid).</p>\n\n<p>However, I'm new to Struts2 (and Java in general), so I've being trying to follow tutorials all over the globe. And the more I search, the more I find different solutions and plugin dependencies which means more tutorials to read. I've written everything from business, dao, and beans but the .jsp's and actions. I'm now short on time and can't spend another week on wrong directions. Hope this thread can save someone else time too.</p>\n\n<p>Questions:</p>\n\n<p>1- I've downloaded the showcase examples and they all seem to use hibernate plugin. Is it a MUST or can I use grid without it? Because it's too much info for a single human head at this point.</p>\n\n<p>2- Related to sessions. Do I need to configure an interceptor to be loaded at every action call to check if user is logged in, or is there anything taking care of this by default in Struts2? I'm trying to avoid struts.xml, so I'm using convention. How can I achieve this session check without xml configs?</p>\n\n<p>3- If anyone can provide some short and fast examples of using struts2 and grid, it'd be really appreciated. </p>\n\n<p>More questions should come shortly.. thanks for reading.</p>\n"},{"tags":["java","hibernate","java-ee","jboss","jboss7.x"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":199,"score":1,"question_id":12855209,"title":"ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC00001: Failed to start service","body":"<p>Hi every one i have some problem with Jboss-7-as.1.1 when i deploy i am getting <code>ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC00001: Failed to start service</code> error.</p>\n\n<pre><code>10:44:30,343 INFO  [org.jboss.as.connector] (MSC service thread 1-1) JBAS010408: Starting JCA Subsystem (JBoss IronJacamar 1.0.7.Final)\n10:44:30,765 INFO  [org.jboss.as.naming] (MSC service thread 1-2) JBAS011802: Starting Naming Service\n10:44:31,750 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-2) Starting Coyote HTTP/1.1 on http--127.0.0.1-8080\n10:44:32,031 INFO  [org.jboss.as.mail.extension] (MSC service thread 1-2) JBAS015400: Bound mail session [java:jboss/mail/Default]\n10:44:34,062 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-2) JBAS010400: Bound data source [java:jboss/datasources/ExampleDS]\n10:44:34,984 INFO  [org.jboss.ws.common.management.AbstractServerConfig] (MSC service thread 1-1) JBoss Web Services - Stack CXF Server 4.0.1.GA\n10:44:35,656 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-3) JBAS015012: Started FileSystemDeploymentService for directory D:\\jboss-as-7.1.0.Final\\standalone\\deployments\n10:44:35,703 INFO  [org.jboss.as.remoting] (MSC service thread 1-2) JBAS017100: Listening on /127.0.0.1:9999\n10:44:35,703 INFO  [org.jboss.as.remoting] (MSC service thread 1-1) JBAS017100: Listening on /127.0.0.1:4447\n10:44:36,296 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015876: Starting deployment of \"axis2.war\"\n10:44:36,296 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015876: Starting deployment of \"responsecomponent.ear\"\n10:44:50,296 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xercesImpl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,312 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xml-apis.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,328 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry serializer.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,343 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry activation.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/mail-1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,359 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry bcel.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jibx-bind-1.1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,375 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jibx-run.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jibx-bind-1.1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,375 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry xpp3.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jibx-bind-1.1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,390 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry stax-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jibx-bind-1.1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,406 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry wstx-asl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jibx-bind-1.1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,421 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-xjc-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,421 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb-impl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-xjc-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,437 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jsr173_1.0_api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-xjc-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,453 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry activation.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-xjc-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,468 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-impl-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,468 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry activation.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-impl-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,484 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jsr173_1.0_api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-impl-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,500 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-1) Class Path entry jaxb1-impl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/lib/jaxb-impl-2.0.2.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:50,515 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015876: Starting deployment of \"responsecomponent.jar\"\n10:44:50,953 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC00001: Failed to start service jboss.deployment.unit.\"responsecomponent.ear\".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit.\"responsecomponent.ear\".PARSE: Failed to process phase PARSE of deployment \"responsecomponent.ear\"\n    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119) [jboss-as-server-7.1.0.Final.jar:7.1.0.Final]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_11]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_11]\n    at java.lang.Thread.run(Thread.java:619) [rt.jar:1.6.0_11]\nCaused by: org.jboss.as.server.deployment.DeploymentUnitProcessingException: JBAS017224: Failed to parse service xml [\"/D:/jboss-as-7.1.0.Final/bin/content/responsecomponent.ear/META-INF/jboss-service.xml\"]\n    at org.jboss.as.service.ServiceDeploymentParsingProcessor.deploy(ServiceDeploymentParsingProcessor.java:95)\n    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.0.Final.jar:7.1.0.Final]\n    ... 5 more\nCaused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[1,1]\nMessage: Unexpected element 'jboss-app'\n    at org.jboss.staxmapper.XMLMapperImpl.processNested(XMLMapperImpl.java:108)\n    at org.jboss.staxmapper.XMLMapperImpl.parseDocument(XMLMapperImpl.java:69)\n    at org.jboss.as.service.ServiceDeploymentParsingProcessor.deploy(ServiceDeploymentParsingProcessor.java:88)\n    ... 6 more\n\n10:44:58,953 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jaxb-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:58,968 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry activation.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:58,968 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jsr173_1.0_api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:58,984 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jaxb1-impl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-impl-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,000 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jaxb-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,015 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jaxb-impl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,031 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jsr173_1.0_api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,031 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry activation.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jaxb-xjc-2.1.7.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,046 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry bcel.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,062 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry jibx-run.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,078 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry xpp3.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,093 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry stax-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,093 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry wstx-asl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-bind-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,109 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry xpp3.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-run-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,125 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry stax-api.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-run-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,140 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry wstx-asl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/jibx-run-1.2.1.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,156 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry activation.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/mail-1.4.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,171 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry xercesImpl.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,171 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry xml-apis.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n10:44:59,187 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) Class Path entry serializer.jar in \"/D:/jboss-as-7.1.0.Final/bin/content/axis2.war/WEB-INF/lib/xalan-2.7.0.jar\"  does not point to a valid jar for a Class-Path reference.\n10:45:00,796 WARN  [org.apache.axiom.util.stax.dialect.StAXDialectDetector] (MSC service thread 1-2) Unable to determine dialect of the StAX implementation at jar:file:/D:/jboss-as-7.1.0.Final/jboss-modules.jar!/\n10:45:01,046 INFO  [org.apache.axis2.deployment.ClusterBuilder] (MSC service thread 1-2) Clustering has been disabled\n10:45:03,296 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: addressing-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/addressing-1.5.mar\n10:45:03,343 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: jaxws-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/axis2-jaxws-mar-1.5.mar\n10:45:04,218 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: script-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/axis2-scripting-1.5.mar\n10:45:04,281 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: metadataExchange-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/mex-1.5.mar\n10:45:04,343 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: mtompolicy-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/mtompolicy-1.5.mar\n10:45:04,406 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: ping-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/ping-1.5.mar\n10:45:05,375 INFO  [org.apache.axis2.deployment.ModuleDeployer] (MSC service thread 1-2) Deploying module: soapmonitor-1.5 - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/modules/soapmonitor-1.5.mar\n10:45:06,546 INFO  [org.apache.axis2.deployment.ServiceDeployer] (MSC service thread 1-2) Deploying Web service: SPGenericConnectorVer2.aar - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/services/SPGenericConnectorVer2.aar\n10:45:06,656 INFO  [org.apache.axis2.deployment.ServiceDeployer] (MSC service thread 1-2) Deploying Web service: version-1.5.aar - file:/D:/jboss-as-7.1.0.Final/standalone/tmp/vfs/tempcb22ca251f6318fa/axis2.war-dcd99ebb654bec5f/WEB-INF/services/version-1.5.aar\n10:45:06,687 WARN  [org.apache.axis2.transport.http.AxisServlet] (MSC service thread 1-2) No transportReceiver for org.apache.axis2.transport.http.AxisServletListener found. An instance for HTTP will be configured automatically. Please update your axis2.xml file!\n10:45:06,765 INFO  [org.jboss.web] (MSC service thread 1-2) JBAS018210: Registering web context: /axis2\n10:45:06,796 ERROR [org.jboss.as] (MSC service thread 1-3) JBAS015875: JBoss AS 7.1.0.Final \"Thunder\" started (with errors) in 55796ms - Started 181 of 256 services (2 services failed or missing dependencies, 72 services are passive or on-demand)\n10:45:07,015 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015870: Deploy of deployment \"responsecomponent.ear\" was rolled back with failure message {\"JBAS014671: Failed services\" =&gt; {\"jboss.deployment.unit.\\\"responsecomponent.ear\\\".PARSE\" =&gt; \"org.jboss.msc.service.StartException in service jboss.deployment.unit.\\\"responsecomponent.ear\\\".PARSE: Failed to process phase PARSE of deployment \\\"responsecomponent.ear\\\"\"}}\n10:45:07,031 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015871: Deploy of deployment \"axis2.war\" was rolled back with no failure message\n10:45:07,500 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015877: Stopped deployment responsecomponent.jar in 482ms\n10:45:11,468 INFO  [org.apache.catalina.core.StandardContext] (MSC service thread 1-4) Container org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/] has not been started\n10:45:11,703 INFO  [org.jboss.as.osgi] (MSC service thread 1-4) JBAS011942: Stopping OSGi Framework\n10:45:11,734 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-3) Pausing Coyote HTTP/1.1 on http--127.0.0.1-8080\n10:45:11,734 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-3) Stopping Coyote HTTP/1.1 on http--127.0.0.1-8080\n</code></pre>\n"},{"tags":["hibernate","search","solr","filter","lucene"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":10714720,"title":"Multiword synonyms with solr and hibernate search","body":"<p>I have a synonyms.txt file with content as below</p>\n\n<pre><code>car accessories, gadi marmat\n</code></pre>\n\n<p>and I am indexing <strong>car accessories</strong> as a single token so that it will expand to <strong>car accessories</strong> and <strong>gadi marmat</strong>.</p>\n\n<p>i want the whole synonyms to match so that when query for <strong>gadi marmat</strong>, the record with <strong>car accessories</strong> to be returned.</p>\n\n<p>I am using shingle filter factory to expand query so that when searching for <strong>gadi marmat</strong>, it will be expanded to <strong>gadi</strong>, <strong>gadi marmat</strong> and <strong>marmat</strong>, and since <strong>gadi marmat</strong> is queried as a single token, it should have matched <strong>car accessories</strong> and returned result but this is not the case, but when i search for <strong>car accessories</strong>, it is returning result. So must be prblm with indexing synonyms that have multiple words.</p>\n\n<p>Please suggest.</p>\n"},{"tags":["hibernate","postgresql","select","count","resultset"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":156,"score":3,"question_id":12854210,"title":"getting count(*) using createSQLQuery in hibernate with regular expression statement","body":"<p>I'm trying to count columns with hibernate 3.2.5</p>\n\n<p>createSQLQuery,</p>\n\n<p>because I use where statement, </p>\n\n<p>which use regular expression(it doesn't work in HQL).</p>\n\n<p>The database is Postgre.</p>\n\n<p>This is my query:</p>\n\n<pre><code>@Override\npublic Long CountFilterListOrder(Integer idUser) {\n\n\n    return (Long)sessionFactory.getCurrentSession()\n            .createSQLQuery(\"select COUNT(*) from ipony.orders where entryuser_id = :idUser and lastname ~* '^(John)$'\")\n                            .addEntity(Orders.class)\n            .setInteger(\"idUser\", idUser)\n            .uniqueResult();\n}\n</code></pre>\n\n<p>My Entity:</p>\n\n<pre><code>@Entity\n@Table(name = \"orders\")\n@NamedQueries({\n@NamedQuery(name = \"Orders.findAll\", query = \"SELECT o FROM Orders o\"),\n\n })\npublic class Orders implements Serializable {\n// COLUMNS-------------\nprivate final static  SimpleDateFormat ft =new SimpleDateFormat (\"yyyy-MM-dd H:mm:ss\");\nprivate static final long serialVersionUID = 1L;\n@Id\n@GeneratedValue(strategy = GenerationType.IDENTITY)\nprivate Integer id;\n\n// ЗАКАЗ\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String numberOrder;\n\n// ПОЛУЧАТЕЛЬ\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerFname;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerLname;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerMname;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerPhone;\n\n@ManyToOne\nprivate StreetType streettype;\n\n\n//private Region region;\n// ЗАКАЗ\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String numberOrder;\n    // ПОЛУЧАТЕЛЬ\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerFname;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerLname;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerMname;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String consumerPhone;\n\n@ManyToOne\nprivate StreetType streettype;\n\n\n//private Region region;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String street;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String house;\n\n@NotEmpty(message = \"Поле не может быть пустым\")\nprivate String houseroom;\n\nprivate String consumerDescr;\n\nprivate Integer confirmOrder = 0; //     \nprivate Boolean isDeleted = false;\n\n@Basic(optional = true)\n@ManyToOne(fetch= FetchType.LAZY,  cascade = CascadeType.MERGE)\nprivate City orderCity;\n\n@Basic(optional = true)\n@Temporal(javax.persistence.TemporalType.TIMESTAMP)\nprivate Date entryDate = Calendar.getInstance().getTime();\n\n@Basic(optional=true)\n@Temporal(javax.persistence.TemporalType.TIMESTAMP)\nprivate Date onDate;\n\n@Basic(optional = true)\n@ManyToOne(cascade= CascadeType.MERGE)\nprivate Puser entryUser;\n\n@OneToMany(mappedBy = \"orderId\", fetch= FetchType.LAZY,  cascade= CascadeType.MERGE )\nprivate List&lt;OrderItem&gt; orderItems;\n\n\n@ManyToOne(fetch= FetchType.LAZY,   cascade= CascadeType.MERGE)\nprivate PaymentMethods paymentMethodItem;\n\n\n\n@ManyToOne(fetch= FetchType.LAZY,   cascade= CascadeType.MERGE)\nprivate DeliveryMethods deliveryMethods;\n\n\n//---------------------- GETSET\n\n\n@DateTimeFormat(pattern=\"yyyy-MM-dd\")\npublic Date getOnDate() {\n    return onDate;\n}\n\npublic Boolean getIsDeleted() {\n    return isDeleted;\n}\n\npublic void setIsDeleted(Boolean isDeleted) {\n    this.isDeleted = isDeleted;\n}\n\npublic void setOnDate(Date onDate) {\n    this.onDate = onDate;\n}\n\n\npublic DeliveryMethods getDeliveryMethods() {\n    return deliveryMethods;\n}\n\npublic void setDeliveryMethods(DeliveryMethods deliveryMethods) {\n    this.deliveryMethods = deliveryMethods;\n}\n\n\npublic Orders(Integer id) {\n    this.id = id;\n}\n\n\npublic Orders() {\n\n}\n\npublic boolean addItems(OrderItem i) {\n    if (orderItems == null) {\n        orderItems = new ArrayList&lt;OrderItem&gt;();\n    }\n    if (i != null &amp;&amp; !orderItems.contains(i)) {\n        orderItems.add(i);\n        i.setOrderId(this);\n        return true;\n    }\n    return false;\n}\n\npublic String getHouse() {\n    return house;\n}\n\npublic void setHouse(String house) {\n    this.house = house;\n}\n\npublic String getHouseroom() {\n    return houseroom;\n}\n\npublic void setHouseroom(String houseroom) {\n    this.houseroom = houseroom;\n}\n\npublic String getStreet() {\n    return street;\n}\n\npublic void setStreet(String street) {\n    this.street = street;\n}\n\npublic StreetType getStreettype() {\n    return streettype;\n}\n\npublic void setStreettype(StreetType streettype) {\n    this.streettype = streettype;\n}\n\n// GET SET :::::::::::::::::::::::::::::::::::::::::\npublic PaymentMethods getPaymentMethodItem() {\n    return paymentMethodItem;\n}\n\npublic void setPaymentMethodItem(PaymentMethods paymentMethodItem) {\n    this.paymentMethodItem = paymentMethodItem;\n}\n\npublic Integer getConfirmOrder() {\n    return confirmOrder;\n}\n\npublic void setConfirmOrder(Integer confirmOrder) {\n    this.confirmOrder = confirmOrder;\n}\n\n\n\npublic List&lt;OrderItem&gt; getOrderItems() {\n    return (orderItems != null) ? Collections.unmodifiableList(orderItems) : Collections.EMPTY_LIST;\n}\n\npublic void setOrderItems(List&lt;OrderItem&gt; orderItems) {\n    this.orderItems = orderItems;\n}\n\npublic Integer getId() {\n    return id;\n}\n\npublic void setId(Integer id) {\n    this.id = id;\n}\n\npublic String getNumberOrder() {\n    return numberOrder;\n}\n\npublic void setNumberOrder(String numberOrder) {\n    this.numberOrder = numberOrder;\n}\n\npublic City getOrderCity() {\n    return orderCity;\n}\n\npublic void setOrderCity(City orderCity) {\n    this.orderCity = orderCity;\n}\n\npublic String getConsumerDescr() {\n    return consumerDescr;\n}\n\npublic void setConsumerDescr(String consumerDescr) {\n    this.consumerDescr = consumerDescr;\n}\n\npublic String getConsumerFname() {\n    return consumerFname;\n}\n\npublic void setConsumerFname(String consumerFname) {\n    this.consumerFname = consumerFname;\n}\n\npublic String getConsumerLname() {\n    return consumerLname;\n}\n\npublic void setConsumerLname(String consumerLname) {\n    this.consumerLname = consumerLname;\n}\n\npublic String getConsumerMname() {\n    return consumerMname;\n}\n\npublic void setConsumerMname(String consumerMname) {\n    this.consumerMname = consumerMname;\n}\n\npublic String getConsumerPhone() {\n    return consumerPhone;\n}\n\npublic void setConsumerPhone(String consumerPhone) {\n    this.consumerPhone = consumerPhone;\n}\n\npublic String getEntryDate() {\n\n    return ft.format(entryDate);\n}\n\npublic void setEntryDate(Date entryDate) {\n    this.entryDate = entryDate;\n}\n\npublic Puser getEntryUser() {\n    return entryUser;\n}\n\npublic void setEntryUser(Puser entryUser) {\n    this.entryUser = entryUser;\n}\n@Override\npublic boolean equals(Object object) {\n    // TODO: Warning - this method won't work in the case the id fields are not set\n    if (!(object instanceof Orders)) {\n        return false;\n    }\n    Orders other = (Orders) object;\n    if((this.id == null &amp;&amp; other.id != null) || (this.id != null &amp;&amp;  \n\n\n      this.id.equals(other.id))) {\n        return false;\n    }\n    return true;\n}\n\n@Override\npublic String toString() {\n    return \"org.ironlizard.domain.MasterTarif[ id=\" + id + \" ]\";\n}\n}\n</code></pre>\n\n<p>But it returns an error like\n<b>The column id does not exist in this ResultSet</b></p>\n\n<pre><code>окт 12, 2012 1:40:11 PM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet [app] in context with path [] threw exception  \n[Request processing failed; nested exception is \n\n rg.hibernate.exception.SQLGrammarException: could not execute query] with root cause\n org.postgresql.util.PSQLException: Имя колонки id не найдено в этом ResultSet'е.\natorg.postgresql.jdbc2.AbstractJdbc2ResultSet.findColumn(AbstractJdbc2ResultSet.java:2562)\nat org.postgresql.jdbc2.AbstractJdbc2ResultSet.getInt(AbstractJdbc2ResultSet.java:2426)\nat org.hibernate.type.IntegerType.get(IntegerType.java:28)\nat org.hibernate.type.NullableType.nullSafeGet(NullableType.java:163)\nat org.hibernate.type.NullableType.nullSafeGet(NullableType.java:154)\nat org.hibernate.loader.Loader.getKeyFromResultSet(Loader.java:1097)\nat org.hibernate.loader.Loader.getRowFromResultSet(Loader.java:565)\nat org.hibernate.loader.Loader.doQuery(Loader.java:701)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:236)\nat org.hibernate.loader.Loader.doList(Loader.java:2220)\nat org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2104)\nat org.hibernate.loader.Loader.list(Loader.java:2099)\nat org.hibernate.loader.custom.CustomLoader.list(CustomLoader.java:289)\nat org.hibernate.impl.SessionImpl.listCustomQuery(SessionImpl.java:1695)\nat org.hibernate.impl.AbstractSessionImpl.list(AbstractSessionImpl.java:142)\nat org.hibernate.impl.SQLQueryImpl.list(SQLQueryImpl.java:152)\nat org.hibernate.impl.AbstractQueryImpl.uniqueResult(AbstractQueryImpl.java:811)\nat dao.OrderDAOImpl.CountFilterListOrder(OrderDAOImpl.java:75)\nat service.OrderServiceImpl.FilterOrderAllCount(OrderServiceImpl.java:352)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:601)\nat org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)\nat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)\nat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)\nat org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)\nat $Proxy324.FilterOrderAllCount(Unknown Source)\nat web.OrderController.serverSideOrderlist(OrderController.java:631)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:601)\nat org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)\nat org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)\nat org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:669)\nat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:585)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)\nat org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)\nat org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:119)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)\nat org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)\nat org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)\nat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)\nat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\nat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)\nat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\nat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\nat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\nat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)\nat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\nat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\nat java.lang.Thread.run(Thread.java:722)\n</code></pre>\n\n<p>How i can solve this error?</p>\n"},{"tags":["hibernate","jdbc"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":12855536,"title":"Moving from hibernate to plain jdbc","body":"<p>I have recently started working in Java and J2EE and have theoritical knowledge of concepts related to JDBC and hibernate. I am given a task at my work to convert the existing hibernate connectivity to plain JDBC. Can anybody suggest the simplest way to do it.Actually all tables that i have to work on are created. But I am not able to locate them.Please help.</p>\n"},{"tags":["java","spring","hibernate","jpa-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12854913,"title":"Is there a way to give persistenceUnitName for Spring's LocalContainerEntityManagerFactoryBean without persistence.xml?","body":"<p>I have multiple datasources and multiple EntityManagerFactories to be defined in my spring context. </p>\n\n<p>If there is only on EntityManagerFactory we don't need to give persistenceUnitName. But to associate EntityManager to correct EntityManagerFactory with @PersistenceContext I should give unitName=\"somePU\" attribute. </p>\n\n<p>But if we give name for persistenceUnitName attribute then Spring is expecting these persistenceUnitName declarations in persistence.xml file.</p>\n\n<p>Is there a way to give persistenceUnitName for Spring's LocalContainerEntityManagerFactoryBean without persistence.xml?</p>\n\n<p>Also I found another issue when I used persistence.xml with Spring's LocalContainerEntityManagerFactoryBean. The packagesToScan property is not working. I need to list down all the Entity classes in persistence.xml.</p>\n\n<p>Any idea why it is happening?</p>\n\n<p>-siva</p>\n"},{"tags":["hibernate","jboss","naming","jboss7.x"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":323,"score":0,"question_id":10811966,"title":"JBoss 7.1.1 + Hibernate 3.6.9","body":"<p>I'm migrating an app from JBoss 5.1.0 to JBoss 7.1.1 . In the old JBoss I was using \nthe <code>org.hibernate.jmx.HibernateService</code> on startup to create and expose via JMX a HibernateSessionFactory.</p>\n\n<p>It seems that in JBoss 7.1.1 I can't go with the same approach as it gives me the following error : </p>\n\n<pre><code>07:18:17,371 INFO  [org.hibernate.util.NamingHelper] (MSC service thread 1-16) JNDI InitialContext properties:{}\n07:18:17,374 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-16) MSC00001: Failed to start service jboss.mbean.service.\"jboss.jca:service=HibernateFactory,name=HibernateFactory\".start: org.jboss.msc.service.StartException in service jboss.mbean.service.\"jboss.jca:service=HibernateFactory,name=HibernateFactory\".start: JBAS017222: Failed to execute legacy service start() method\n        at org.jboss.as.service.StartStopService.start(StartStopService.java:56)\n        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_25-ea]\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_25-ea]\n        at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_25-ea]\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_25-ea]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_25-ea]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_25-ea]\n        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_25-ea]\n        at org.jboss.as.service.AbstractService.invokeLifecycleMethod(AbstractService.java:52)\n        at org.jboss.as.service.StartStopService.start(StartStopService.java:54)\n        ... 5 more\nCaused by: java.lang.UnsupportedOperationException: JBAS011859: Naming context is read-only\n        at org.jboss.as.naming.WritableServiceBasedNamingStore.requireOwner(WritableServiceBasedNamingStore.java:126)\n        at org.jboss.as.naming.WritableServiceBasedNamingStore.unbind(WritableServiceBasedNamingStore.java:98)\n        at org.jboss.as.naming.WritableServiceBasedNamingStore.rebind(WritableServiceBasedNamingStore.java:85)\n        at org.jboss.as.naming.NamingContext.rebind(NamingContext.java:237)\n        at org.hibernate.util.NamingHelper.bind(NamingHelper.java:97)\n        at org.hibernate.impl.SessionFactoryObjectFactory.addInstance(SessionFactoryObjectFactory.java:113)\n        at org.hibernate.impl.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:367)\n        at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1872)\n        at com.viagents.persistence.ViHibernateService.start(ViHibernateService.java:29)\n        ... 11 more\n</code></pre>\n"},{"tags":["java","eclipse","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12852486,"title":"Eclipse debugger shows Hibernate-managed object has not been lazily-initialized","body":"<p>I gather that Hibernate uses the javassist library to handle lazy initialization of objects. Say I have the following entities (getters/setters/annotations are truncated):</p>\n\n<pre><code>@Entity\npublic class MainEntity {\n    private ComponentEntity comp;\n}\n\n@Entity\npublic class ComponentEntity {\n    private Integer id;\n    private String name;\n}\n</code></pre>\n\n<p>Now I call the following method:</p>\n\n<pre><code>@Transactional\npublic void doSomething() {\n    MainEntity main = this.dao.find(1);\n\n    // Case A\n    main.getComp().getName();\n    // Case B\n    String localVariableName = main.getComp().getName();\n}\n</code></pre>\n\n<p>When the DAO retrieves main, the <code>comp</code> object is not yet initialized due to lazy initialization. I expect that after calling <code>Case A</code>, the <code>comp</code> object will have been retrieved from the database, but based on the debugger, all the comp object properties appear as null.</p>\n\n<p>It's only when after <code>Case B</code> where I save the <code>name</code> value into a <code>localVariableName</code> that I can see localVariableName get a non-null value.</p>\n\n<p>Why is Eclipse showing my object properties as null?</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":325,"score":2,"question_id":11087159,"title":"Own Hibernate DefaultSaveOrUpdateEventListener is not getting fired when using .save() or .update() instead of .saveOrUpdate()","body":"<p>im trying to build a spring (3.1) &amp; hibernate (3.6.10) web application and having a problem with the hibernate events.\nI implemented my own DefaultSaveOrUpdateEventListener for updating/creating a dateCreated and lastUpdated date which is called on every .saveOrUpdate() event. So far so good.</p>\n\n<p>Shouldn't this listener be called also on .save() or .update() events?\nOr am i missing something here?</p>\n\n<p>Listener:</p>\n\n<pre><code>public class SaveOrUpdateDateListener extends DefaultSaveOrUpdateEventListener {\n\n    private static final long serialVersionUID = 1L;\n\n    private static Logger log = Logger.getLogger(SaveOrUpdateDateListener.class);\n\n\n    @Override\n    public void onSaveOrUpdate(SaveOrUpdateEvent event) {\n        log.debug(\"Entered onSaveOrUpdate()\");\n\n        if (event.getObject() instanceof BaseDomain) {\n            BaseDomain record = (BaseDomain) event.getObject();\n\n            record.setDateUpdated(new Date());\n\n            if (record.getDateCreated() == null) {\n                record.setDateCreated(new Date());\n            }\n        }\n\n        super.onSaveOrUpdate(event);\n    }\n}\n</code></pre>\n\n<p>Hibernate config (partially):</p>\n\n<pre><code>&lt;sesssion-factory&gt;\n\n&lt;event type=\"save-update\"&gt;\n            &lt;listener class=\"net.test.listener.hibernate.SaveOrUpdateDateListener\"/&gt;\n            &lt;listener class=\"org.hibernate.event.def.DefaultSaveOrUpdateEventListener\"/&gt;\n        &lt;/event&gt;    \n&lt;/session-factory&gt;\n</code></pre>\n\n<p>example dao methods (<strong>doesn't work</strong>):</p>\n\n<pre><code>@Autowired\nprivate SessionFactory sessionFactory;\n\n\n@Override\npublic void add(Registration registration) {\n    sessionFactory.getCurrentSession().save(registration);\n}\n\n@Override\npublic void update(Registration registration) {\n    sessionFactory.getCurrentSession().update(registration);\n}\n</code></pre>\n\n<p>example dao methods (<strong>works</strong>):</p>\n\n<pre><code>@Autowired\nprivate SessionFactory sessionFactory;\n\n\n@Override\npublic void add(Registration registration) {\n    sessionFactory.getCurrentSession().saveOrUpdate(registration);\n}\n\n@Override\npublic void update(Registration registration) {\n    sessionFactory.getCurrentSession().saveOrUpdate(registration);\n}\n</code></pre>\n\n<p><br>\n<br>\n<strong>Edit</strong></p>\n\n<p>After i dedcided not to use saveOrUpdate in general i hopefully solved my problem with using a base class like the following:</p>\n\n<pre><code>@MappedSuperclass\npublic class BaseDomain {\n\n    @Id\n    @GeneratedValue\n    protected Integer id;\n\n    @Column(nullable=false)\n    protected Timestamp dateCreated;\n\n    @Column(updatable = false, insertable = false, columnDefinition = \"timestamp default current_timestamp on update current_timestamp\")\n    @Generated(GenerationTime.ALWAYS)\n    protected Timestamp dateUpdated;\n\n\n    protected BaseDomain() {\n        this.dateCreated = new Timestamp(System.currentTimeMillis());\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    protected void setId(Integer id) {\n        this.id = id;\n    }\n\n    public Timestamp getDateCreated() {\n        return dateCreated;\n    }\n\n    public Date getDateUpdated() {\n        return dateUpdated;\n    }\n}\n</code></pre>\n\n<p>As the current_timestamp can be used only once per table (mysql restriction) i tried to build the dateCreated via constructor.</p>\n"},{"tags":["hibernate","postgresql","crosstab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12852251,"title":"using cross tab and pivot table function","body":"<p>Possibility of using cross tab and pivot table function in postgres 8.3 version</p>\n\n<p>I know it is possible with postgres 9.x version, but wanted to know by any chance we can use it with the older versions of postgres.</p>\n\n<p>I am using hibernate for the database connectivity.</p>\n"},{"tags":["java","spring","hibernate","struts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12851582,"title":"How can I load two data tables in one page using struts?","body":"<p>Im using struts 1.3 + spring 2.5 + hibernate 3.</p>\n\n<p>I have two tables: category and product.</p>\n\n<p>Im using tags-logic to load data from category.</p>\n\n<pre><code>&lt;logic:iterate id=\"cat\" name=\"catList\"&gt;\n    &lt;bean:write name=\"cat\" property=\"catName\" /&gt;\n&lt;/logic:iterate&gt;\n</code></pre>\n\n<p>But when I use tags-logic again to load data from product in same page</p>\n\n<pre><code>&lt;logic:iterate id=\"pro\" name=\"proList\"&gt;\n    &lt;bean:write name=\"pro\" property=\"proName\" /&gt;\n&lt;/logic:iterate&gt;\n</code></pre>\n\n<p>it errors, and throw Exception: &lt;&lt; Cannot find bean: \"proList\" in any scope >></p>\n\n<p>How can I resolve it? I want to load two data table from database in one page. Please help me.</p>\n"},{"tags":["spring","hibernate","jsp","jstl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12851252,"title":"how to set default values in spring form input tags","body":"<p>I am using spring form input tags in my JSP page. Properties are mapped using hibernate mapping file</p>\n\n<pre><code>&lt;td&gt;Package&lt;form:input path=\"commandObject[${loop.index}].name\"/&gt;&lt;/td&gt;\n</code></pre>\n\n<p>I have some default values in my database. I want to show the default values when user renders the form. And the modifications to those values should be saved as a new row in the DB.</p>\n\n<p>How can I achieve this! Thanks in advance!</p>\n"},{"tags":["spring","hibernate","jbpm"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12851284,"title":"Example projects for jbpm integration with spring and hibernate","body":"<p>Could anybody suggest me some example application of jbpm that uses spring and hibernate.I am new to jbpm.I need to get some reference application about it.</p>\n"},{"tags":["java","spring","hibernate","struts"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12836980,"title":"load content when click on menu","body":"<p>Im using struts 1.3 + spring 2.5 + hibernate 3.</p>\n\n<p>I have 2 table Category and Product.</p>\n\n<pre><code>---------CATEGORY--------- \n- cat_id(varchar)\n- cat_name(varchar)\n---------PRODUCT---------\n- pro_id(int)\n- cat_id(varchar)\n- pro_name(varchar)\n</code></pre>\n\n<p>I load name of category from database as menu at top site using tags-logic</p>\n\n<pre><code>&lt;logic:iterate id=\"cat\" name=\"catList\"&gt;\n&lt;bean:define id=\"ID\" name=\"cat\" property=\"catId\" /&gt;\n    &lt;a href=\"/ListProduct.do?catId=&lt;%=ID %&gt;\"&gt;\n        &lt;bean:write name=\"cat\" property=\"catName\" /&gt;\n    &lt;/a&gt; |\n&lt;/logic:iterate&gt;\n</code></pre>\n\n<p>Its will be display like this:</p>\n\n<pre><code>CAT1 | CAT2 | CAT3 | CAT4 |\n</code></pre>\n\n<p>I want when I click on CAT1 or CAT2..., its will be show product name of that category at below the menu. How can I do that?</p>\n"},{"tags":["database","hibernate","datetime","java-ee"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2105,"score":1,"question_id":6121863,"title":"How to get sysdate, time and timestamp from database using hibernate","body":"<p>In my application I need to get database date(<code>sysdate</code> in case of Oracle DB) and compare it with user input date (<em><code>String</code> converted to <code>java.util.Date</code></em>). From <a href=\"https://forum.hibernate.org/viewtopic.php?f=1&amp;t=961789\" rel=\"nofollow\">this forum</a> I got the following code which helps in the case of <strong>Oracle</strong> dialect.</p>\n\n<pre><code>public Date getDate() {\n        Session session = getHibernateTemplate().getSessionFactory().openSession();\n        SQLQuery query = session.createSQLQuery(\"select sysdate as mydate from dual\");\n        query.addScalar(\"mydate\", Hibernate.TIMESTAMP);\n        return (Date) query.uniqueResult();\n    }\n</code></pre>\n\n<p>And from <a href=\"https://forum.hibernate.org/viewtopic.php?f=1&amp;t=974212&amp;view=previous\" rel=\"nofollow\">this link</a> got the following method which uses mapping file with formula.</p>\n\n<pre><code>&lt;property name=\"currentDate\" formula=\"(select sysdate from dual)\"/&gt;\n</code></pre>\n\n<p>Again this is specific to Oracle. I think using later method is more performance friendly, because we can get it from the same session, i.e no need of opening another session just for getting date.</p>\n\n<p>I am looking for a generic solution to get date, time and timestamp from any DBMS using Hibernate. Using HQL is the preferred. Hope such a solution is available.</p>\n"},{"tags":["java","hibernate","jdbc","orm","hibernate-mapping"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12841855,"title":"session.connection( ) deprecated","body":"<p>We moved to hibernate 4 recently. Our application has many files which has session.connection () which is deprecated. I have replaced with session.doWork() by calling like this :</p>\n\n<pre><code>session.doWork(new Work() {\n\n    @Override\n    public void execute(Connection conn) throws SQLException {\n        wasAuto = conn.getAutoCommit();\n        if(!wasAuto) {\n            conn.rollback(); // in case there is existing transaction\n            conn.setAutoCommit(true);\n        }\n\n    }\n});\ntry {\n    return mainCallback.doInHibernate(session);\n} finally {\n    session.doWork(new Work() {\n\n        @Override\n        public void execute(Connection conn) throws SQLException {\n            if(!wasAuto)\n                conn.setAutoCommit(wasAuto);\n        }\n    });\n\n}\n</code></pre>\n\n<p>But as I said we have many files having the same error. Is it a best practise to write like above.</p>\n\n<p>For better understanding I'm adding one file with an error. Can someone help me in clearing the errors.</p>\n\n<pre><code>Session session = repo.getSessionFactory().openSession();\n    Connection connection = null;\n    PreparedStatement ps = null;\n    int recordCount = 0;\n    try {\n        connection = session.connection();\n        ps = connection.prepareStatement(masterSql);\n        ps.setDate(1,acctPeriod);\n        ps.setLong(2,geoScheme.getId());\n\n        recordCount = ps.executeUpdate();\n\n        long millis = System.currentTimeMillis() - start;\n        logger.info(\"END --&gt; Generating/Running Dynamic SQL for Aggregation took \"+(millis / 60000.0)+\" min\" );\n        run.addRollupMessage(\"Generating/Running Dynamic SQL for Aggregation took \"+(millis / 60000.0)+\" min\" );\n\n        run.setEndDate(DateUtils.currentTimestamp());\n        logger.info(\"No of Loan groups inserted = \" +  recordCount);\n        run.addRollupMessage(\"No of Loan groups inserted = \" +  recordCount);\n\n    } catch (Exception err) {\n        throw new RuntimeException(\" **ERROR** DURING AGGREGATION: \" + err.getMessage(),err);\n    }\n    finally\n    {\n        if (ps != null) ps.close();\n        if (connection != null) connection.close();\n        if (session != null) session.close();\n    }\n</code></pre>\n"},{"tags":["java","hibernate","postgresql","jpa-2.0"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":5043,"score":1,"question_id":4705088,"title":"JPA 2: multiple column usage in foreign keys","body":"<p>I am using Hibernate as persistence provider and modelling my entities with JPA 2.</p>\n\n<p>Now a question came up and i hope you can help me. </p>\n\n<p>In my application you can open up a Game, create groups of players in it and walk around on the map (tiles (2d)). </p>\n\n<p>First my entity definitions:\nGame:</p>\n\n<pre><code>@Entity\npublic class Game implements Serializable {\n@Id\n@SequenceGenerator(name = \"gen_gameid\", sequenceName = \"seq_gameid\")\n@GeneratedValue(generator=\"gen_gameid\")\nprivate long gameid;\n\n/**\n * Playing Characters.\n */\n@OneToMany(mappedBy = \"game\")\nprivate List&lt;Character&gt; characters;\nprivate int round = 0;\n\n@OneToMany(mappedBy=\"game\")\nprivate List&lt;Tile&gt; tiles;\n\n@OneToMany(mappedBy=\"game\")\nprivate List&lt;Group&gt; group;\n</code></pre>\n\n<p>Tile (a tile will be created from a template and belongs to just one game): </p>\n\n<pre><code>@Entity @IdClass(TileId.class)\npublic class Tile implements Serializable{\n    private static final long serialVersionUID = 2039974286110729270L;\n\n    @Id\n    private int x;\n\n    @Id\n    private int y;\n\n    @Id @ManyToOne @JoinColumn(name=\"gameid\")\n    private Game game;\n\n    @OneToOne(mappedBy=\"tile\")\n    private Character character;\n}\n</code></pre>\n\n<p>Character:</p>\n\n<pre><code>@ManyToOne\n@JoinColumn(name=\"gameid\", referencedColumnName = \"gameid\")\nprivate Game game;\n\n@ManyToOne\n@JoinColumns({\n    @JoinColumn(name=\"groupgameid\", referencedColumnName = \"gameid\"),\n    @JoinColumn(name=\"groupTag\", referencedColumnName = \"grouptag\")\n})\nprivate Group group;\n\n    @OneToOne\n    @JoinColumns({    \n      @JoinColumn(name = \"x\", referencedColumnName = \"x\"),\n      @JoinColumn(name = \"y\", referencedColumnName = \"y\"),\n      @JoinColumn(name = \"tilegameid\", referencedColumnName = \"gameid\")\n    })\n    private Tile tile;\n</code></pre>\n\n<p>As you can see i had to rename the gameid column to groupgameid and tilegameid. This is not very pretty because i would need the gameid in character just once. \nTo mark the fk columns in character from tile and group with insertable=false, updateable=false will allow the sql generation, but i can't change/set this values. </p>\n\n<p>Sure i could introduce an artificial pk in group and tile, but i would need more joins. </p>\n\n<p>Is JPA just limited that i have to allow the gameid column more than once with other names? Or is my design not optimal? </p>\n\n<p>Looking forward to your feedback and thanks in advance.\ngreetings\nMarkus</p>\n\n<p>PS (edit):\nAt Moment i let the shema generate by hibernate at startup till my model is complete. But here is the generated shema (bit simplified and cutted out some unimportant fields):</p>\n\n<pre><code>CREATE TABLE Character\n(\n  charid bigint NOT NULL,\n  gameid bigint,\n  grouptag character varying(255),\n  x integer,\n  y integer,\n  CONSTRAINT hero_pkey PRIMARY KEY (charid),\n  CONSTRAINT fkd4addb09308bc3b822441a FOREIGN KEY (gameid)\n  REFERENCES game (gameid) MATCH SIMPLE\n  ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT fkd4addb093091cb6522441a FOREIGN KEY (gameid, x, y)\n  REFERENCES tile (gameid, x, y) MATCH SIMPLE\n  ON UPDATE NO ACTION ON DELETE NO ACTION,\n  CONSTRAINT fkd4addb09c018f3ae22441a FOREIGN KEY (gameid, grouptag)\n  REFERENCES gamegroup (gameid, grouptag) MATCH SIMPLE\n  ON UPDATE NO ACTION ON DELETE NO ACTION\n) \n\nCREATE TABLE tile (\n  x integer NOT NULL,\n  y integer NOT NULL,\n  gameid bigint NOT NULL,\n  CONSTRAINT tile_pkey PRIMARY KEY (gameid, x, y),\n  CONSTRAINT fk27c6ce308bc3b8 FOREIGN KEY (gameid)\n  REFERENCES game (gameid) MATCH SIMPLE\n  ON UPDATE NO ACTION ON DELETE NO ACTION)\n\nCREATE TABLE gamegroup\n(\n  grouptag character varying(255) NOT NULL,\n  gameid bigint NOT NULL,\n     CONSTRAINT gamegroup_pkey PRIMARY KEY (gameid, grouptag),\n  CONSTRAINT fk3c1c51cd308bc3b8 FOREIGN KEY (gameid)\n  REFERENCES game (gameid) MATCH SIMPLE\n  ON UPDATE NO ACTION ON DELETE NO ACTION\n)\n</code></pre>\n\n<p>PS 2: I already played around with <code>, insertable = false, updatable = false</code>.\nFor example when i change the group JoinColumns to:</p>\n\n<pre><code>@ManyToOne\n@JoinColumns({\n    @JoinColumn(name=\"gameid\", referencedColumnName = \"gameid\", insertable = false, updatable = false ),\n    @JoinColumn(name=\"groupTag\", referencedColumnName = \"grouptag\")\n})\nprivate Group group;\n</code></pre>\n\n<p>I get an Error that mixing is not allowed: \n    Caused by: org.hibernate.AnnotationException: Mixing insertable and non insertable columns in a property is not allowed: net.hq.model.Charactergroup</p>\n\n<p>When i make both insertable=false i am not able to set the group tag anymore. It groupTag stays empty after insertion and gameid is set. :-/</p>\n\n<p>The way i add a Character to a group:</p>\n\n<pre><code>// Create game\nGame game = new Game();\ngame.addCharacter(max);\nem.persist(game);\n\n// Group\nGroup heroGroup = new Group(game, \"HEROES\");\nheroGroup.addCharacter(max);\nem.persist(game);\n</code></pre>\n\n<p>Method in Group Class:</p>\n\n<pre><code>public void addCharacter(Character character){\n    if(this.characters == null)\n        this.characters = new ArrayList&lt;Character&gt;();\n\n    this.characters.add(character);\n    character.setGroup(this);\n}\n</code></pre>\n"},{"tags":["hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1287,"score":3,"question_id":619010,"title":"Hibernate SQL Audit Logging","body":"<p>I want to do audit logging generated SQL statements in Hibernate. I wrote Custom Interceptor that extents EmptyInterceptor. I overrided <strong>onPrepareStatement</strong> method to get generated SQL. But When I debug this code I am only getting generated SQL without parameters like this.</p>\n\n<pre><code>INSERT INTO TableA(Col1,Col2,Col3) VALUES(?,?,?)\n</code></pre>\n\n<p>How can I get full SQL statement that contains parameter values like this from Hibernate</p>\n\n<pre><code>INSERT INTO TableA(Col1,Col2,Col3) VALUES(\"Value1\",\"Value2\",\"Value3\")\n</code></pre>\n"},{"tags":["hibernate","jboss","c3p0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":87,"score":0,"question_id":12848559,"title":"Are c3p0 settings used by Hibernate when using JBoss data source?","body":"<p>Recently, I configured pooledDataSource in my Jboss AS 7.11 Data source for Hibernate, within my Spring MVC app like this:</p>\n\n<p><strong>standalone.xml</strong></p>\n\n<pre><code>&lt;datasources&gt;\n   &lt;datasource jta=\"true\" jndi-name=\"java:/AppAdm\" pool-name=\"AppAdm\" enabled=\"true\" use-java-context=\"true\" use-ccm=\"true\"&gt;\n        &lt;connection-url&gt;jdbc:oracle:thin:@localhost:1521:orcl&lt;/connection-url&gt;\n        &lt;driver&gt;OracleJDBCDriver&lt;/driver&gt;\n        &lt;security&gt;\n            &lt;user-name&gt;xxx&lt;/user-name&gt;\n            &lt;password&gt;xxx&lt;/password&gt;\n        &lt;/security&gt;\n    &lt;/datasource&gt;\n    &lt;drivers&gt;\n        &lt;driver name=\"OracleJDBCDriver\" module=\"oracle.jdbc\"/&gt;\n    &lt;/drivers&gt;\n&lt;/datasources&gt;\n</code></pre>\n\n<p><strong>Connection within root-context.xml</strong></p>\n\n<pre><code>&lt;bean id=\"namingStrategy\" class=\"com.execon.utils.OracleNamingStrategy\"/&gt;\n\n&lt;bean id=\"dataSource\" class=\"com.mchange.v2.c3p0.DataSources\" factory-method=\"pooledDataSource\"&gt;\n    &lt;constructor-arg&gt;\n        &lt;jee:jndi-lookup jndi-name=\"java:/AppAdm\"/&gt;\n    &lt;/constructor-arg&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"namingStrategy\" ref=\"namingStrategy\"/&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\"/&gt;\n    &lt;property name=\"configLocation\" value=\"classpath:hibernate.cfg.xml\"/&gt;\n    &lt;property name=\"packagesToScan\" value=\"my.models\"/&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>And finnally <strong>hibernate.cfg.xml</strong></p>\n\n<pre><code>&lt;hibernate-configuration&gt;\n    &lt;session-factory&gt;\n        &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"format_sql\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.cache.region.factory_class\"&gt;org.hibernate.cache.ehcache.EhCacheRegionFactory\n        &lt;/property&gt;\n        &lt;property name=\"hibernate.cache.use_query_cache\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.cache.use_second_level_cache\"&gt;true&lt;/property&gt;\n        &lt;property name=\"hibernate.cache.provider_configuration_file_resource_path\"&gt;ehcache.xml&lt;/property&gt;\n\n        &lt;property name=\"hibernate.c3p0.acquire_increment\"&gt;1&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.idle_test_period\"&gt;30&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.max_size\"&gt;5&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.max_statements\"&gt;0&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.min_size\"&gt;1&lt;/property&gt;\n        &lt;property name=\"hibernate.c3p0.timeout\"&gt;50&lt;/property&gt;\n    &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>Everything looks fine until very last moment of deployment, when this appears in my logs:</p>\n\n<pre><code>    22:52:24,520 INFO  [org.springframework.orm.hibernate4.HibernateTransactionManager] (MSC service thread 1-1) \n    Using DataSource [com.mchange.v2.c3p0.PoolBackedDataSource@824853c0 \n    [ connectionPoolDataSource -&gt; com.mchange.v2.c3p0.WrapperConnectionPoolDataSource@6134c031 \n    [ acquireIncrement -&gt; 3, \n    acquireRetryAttempts -&gt; 30, \n    acquireRetryDelay -&gt; 1000, \n    autoCommitOnClose -&gt; false, \n    automaticTestTable -&gt; null, \n    breakAfterAcquireFailure -&gt; false, \n    checkoutTimeout -&gt; 0, \n    connectionCustomizerClassName -&gt; null, \n    connectionTesterClassName -&gt; com.mchange.v2.c3p0.impl.DefaultConnectionTester, \n    debugUnreturnedConnectionStackTraces -&gt; false, \n    factoryClassLocation -&gt; null, \n    forceIgnoreUnresolvedTransactions -&gt; false, \n    identityToken -&gt; 1hge0wa8qmn1sjtu9mwhi|39d9d8da, \n    idleConnectionTestPeriod -&gt; 0, \n    initialPoolSize -&gt; 3, \n    maxAdministrativeTaskTime -&gt; 0, \n    maxConnectionAge -&gt; 0, \n    maxIdleTime -&gt; 0, \n    maxIdleTimeExcessConnections -&gt; 0,\n    maxPoolSize -&gt; 15, \n    maxStatements -&gt; 0, \n    maxStatementsPerConnection -&gt; 0, \n    minPoolSize -&gt; 3, \n    nestedDataSource -&gt; org.jboss.jca.adapters.jdbc.WrapperDataSource@1d9fc24c, \n    preferredTestQuery -&gt; null, \n    propertyCycle -&gt; 0, \n    testConnectionOnCheckin -&gt; false, \n    testConnectionOnCheckout -&gt; false, \n    unreturnedConnectionTimeout -&gt; 0, \n    usesTraditionalReflectiveProxies -&gt; false; \n    userOverrides: {} ], \n    dataSourceName -&gt; null, \n    factoryClassLocation -&gt; null, \n    identityToken -&gt; 1hge0wa8qmn1sjtu9mwhi|2af01ea1, numHelperThreads -&gt; 3 ]] \n    of Hibernate SessionFactory for HibernateTransactionManager\n</code></pre>\n\n<p>As you can see, settings are not override and some kid of defaults are used. What seems to be the problem?</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12848538,"title":"Hibernate Native SQL query - encoutered an error with setFirstResult & setMaxResults","body":"<p>I am having a problem with Hibernate Native SQL query.</p>\n\n<pre><code>        StringBuilder query = new StringBuilder();\n        query.append(\"select name as \\\"name\\\" from \");\n        query.append(\" from\");\n        query.append(\" {h-schema}names \"); \n        query.append(\" order by \\\"name\\\"\");\n\n        Query q = sessionFactory.getCurrentSession().createSQLQuery(query.toString());\n        if (start &gt;= 0 &amp;&amp; limit &gt; 0) {\n            q.setFirstResult(start);\n            q.setMaxResults(limit);\n        }\n        q.setResultTransformer(Transformers.aliasToBean(Test.class));\n</code></pre>\n\n<p>Test.java</p>\n\n<pre><code>   public class Test {\n\n       private String name;\n\n       public String getname() {\n          return name;\n       } \n\n       public void setName(String name) {\n          name = name;\n       }\n\n   }\n</code></pre>\n\n<p>I set the MaxResults to '40' and FirstResult is getting its value when user clicks on Next button. When I tried to run this query, I am getting following error \n\"org.hibernate.PropertyNotFoundException: Could not find setter for ROWNUM_\"</p>\n\n<p>The generate query looks like</p>\n\n<p>\"select * from ( select row_.*, rownum rownum_ from ( select name as \"name\" from test_schema.names order by \"name\" ) row_ where rownum &lt;= ?) where rownum_ > ? \"</p>\n\n<p>I understand the reason for this error i.e. generated sql has rownum_ in select statement. </p>\n\n<p>But when I created a criteria and set criteria.setFirstResult(start) and criteria.setMaxResults(limit), I didn't encounter this error. </p>\n\n<p>How come this is happening with SQL query but not with criteria. Can anyone help me to resolve this error as I don't want to add rownum_ as a new field in Test.java class.</p>\n\n<p>I trimmed down most of the query for easy read. I can't use criteria to achieve my goal, I need to go for SQL query. Can someone help me to resolve this error.</p>\n"},{"tags":["java","hibernate","javabeans","pojo","oo"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12827458,"title":"Looking for the best way to make a web framework more OO on the server side","body":"<p>Web frameworks seem to always wander away from good OO code (Where you group code and data together in an object, think in terms of sending messages to that object, etc)</p>\n\n<p>The main problem seems to be the existence of the bean pattern.  You use a bean pattern (often called POJOs these days because people don't seem to understand the difference) to interact with the database, web services and most other things.</p>\n\n<p>So no you are stuck with this ball of setters and getters with no code--so you tend to add a bunch of--well essentially static functions to manipulate these things.  Nearly all the advantages of OO code are gone.</p>\n\n<p>I see three solutions I'm considering, but wanted to hear if there were any serious disadvantages to any of them.</p>\n\n<p>1) use a POJO pattern instead of a bean pattern.  This would mean eliminating setters and getters from your POJOs (so you can have encapsulation/data safety) and instead adding business logic methods.  This seems to make the most sense--in fact I think it's why libraries like hibernate switched away from requiring Beans to allowing POJOs, yet everyone still seems to use a bean pattern instead.</p>\n\n<p>2) extend your Bean with a business logic class that uses the bean's fields as storage.  This seems flakey and problematic, but would be very easy to drop into an existing codebase as a way to migrate...</p>\n\n<p>3) Wrap a Bean pattern object with a business-logic object.  Mostly I think this might be necessary if #1 is really problematic.</p>\n\n<p>What I'm mostly wondering is why I've never seen #1 used.  I'd really love to hear from anyone who used the Pojo pattern (With business logic and without setters and getters) for hibernate objects and had problems with it (or had it work really well)...</p>\n"},{"tags":["hibernate","jboss"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12847329,"title":"Hibernate using JBossCache","body":"<p>I would like to use JBossCache (Core: 3.2.8.GA, POJO:3.0.0.GA) for caching\nin my Hibernate (Core: 3.3.2.GA_CP04, JBossCache2.x:3.3.2.GA_CP04) persistence\nmanager in JBoss 5. The caches are configured, deployed and are visible and\nusable in the JMX console. But no objects in them.</p>\n\n<p>Would somebody send me a complete persistence configuration example? I mean \na persistence.xml file, containing all the settings for entity cache,\nsecond level cache. Here are my configuration files for both caches, Core and\nPOJO:</p>\n\n<h2>my-cache-jboss-beans.xml</h2>\n\n<p>\n</p>\n\n<pre><code>&lt;bean name=\"MyCacheConfig\" class=\"org.jboss.cache.config.Configuration\"&gt;\n    &lt;property name=\"runtimeConfig\"&gt;\n        &lt;bean class=\"org.jboss.cache.config.RuntimeConfig\"&gt;\n            &lt;property name=\"transactionManager\"&gt;\n                &lt;inject bean=\"jboss:service=TransactionManager\" property=\"TransactionManager\"/&gt;\n            &lt;/property&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n    &lt;property name=\"lockParentForChildInsertRemove\"&gt;false&lt;/property&gt;\n    &lt;property name=\"lockAcquisitionTimeout\"&gt;15000&lt;/property&gt;\n    &lt;property name=\"isolationLevel\"&gt;REPEATABLE_READ&lt;/property&gt;\n    &lt;property name=\"concurrencyLevel\"&gt;500&lt;/property&gt;\n    &lt;property name=\"useLockStriping\"&gt;true&lt;/property&gt;\n    &lt;property name=\"writeSkewCheck\"&gt;false&lt;/property&gt;\n    &lt;property name=\"exposeManagementStatistics\"&gt;true&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean name=\"MyCacheFactory\" class=\"org.jboss.cache.DefaultCacheFactory\"&gt;\n    &lt;constructor factoryClass=\"org.jboss.cache.DefaultCacheFactory\" factoryMethod=\"getInstance\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean name=\"MyCache\" class=\"org.jboss.cache.Cache\"&gt;\n    &lt;constructor factoryMethod=\"createCache\"&gt;\n        &lt;factory bean=\"MyCacheFactory\"/&gt;\n        &lt;parameter class=\"org.jboss.cache.config.Configuration\"&gt;\n            &lt;inject bean=\"MyCacheConfig\"/&gt;\n        &lt;/parameter&gt;\n        &lt;parameter class=\"boolean\"&gt;false&lt;/parameter&gt;\n    &lt;/constructor&gt;\n&lt;/bean&gt;\n\n&lt;bean name=\"MyCacheJmxWrapper\" class=\"org.jboss.cache.jmx.CacheJmxWrapper\"&gt;\n    &lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(name=\"jboss.cache:service=MyCache\", \n                exposedInterface=org.jboss.cache.jmx.CacheJmxWrapperMBean.class, \n                registerDirectly=true)&lt;/annotation&gt;\n    &lt;constructor&gt;\n        &lt;parameter&gt;\n            &lt;inject bean=\"MyCache\"/&gt;\n        &lt;/parameter&gt;\n    &lt;/constructor&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p></p>\n\n<h2>my-pojo-cache-jboss-beans.xml</h2>\n\n<p>\n</p>\n\n<pre><code>&lt;bean name=\"MyPojoCacheConfig\" class=\"org.jboss.cache.config.Configuration\"&gt;\n    &lt;property name=\"runtimeConfig\"&gt;\n        &lt;bean class=\"org.jboss.cache.config.RuntimeConfig\"&gt;\n            &lt;property name=\"transactionManager\"&gt;\n                &lt;inject bean=\"jboss:service=TransactionManager\" property=\"TransactionManager\"/&gt;\n            &lt;/property&gt;\n        &lt;/bean&gt;\n    &lt;/property&gt;\n    &lt;property name=\"lockParentForChildInsertRemove\"&gt;false&lt;/property&gt;\n    &lt;property name=\"lockAcquisitionTimeout\"&gt;15000&lt;/property&gt;\n    &lt;property name=\"isolationLevel\"&gt;REPEATABLE_READ&lt;/property&gt;\n    &lt;property name=\"concurrencyLevel\"&gt;500&lt;/property&gt;\n    &lt;property name=\"useLockStriping\"&gt;true&lt;/property&gt;\n    &lt;property name=\"writeSkewCheck\"&gt;false&lt;/property&gt;\n    &lt;property name=\"exposeManagementStatistics\"&gt;true&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean name=\"MyPojoCache\" class=\"org.jboss.cache.pojo.impl.PojoCacheImpl\"&gt;\n    &lt;constructor factoryClass=\"org.jboss.cache.pojo.PojoCacheFactory\" factoryMethod=\"createCache\"&gt;\n        &lt;parameter class=\"org.jboss.cache.config.Configuration\"&gt;\n            &lt;inject bean=\"MyPojoCacheConfig\"/&gt;\n        &lt;/parameter&gt;\n        &lt;parameter class=\"boolean\"&gt;false&lt;/parameter&gt;\n    &lt;/constructor&gt;\n&lt;/bean&gt;\n\n&lt;bean name=\"MyPojoCacheJmxWrapper\" class=\"org.jboss.cache.pojo.jmx.PojoCacheJmxWrapper\"&gt;\n    &lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(name=\"jboss.cache:service=MyPojoCache\", \n                exposedInterface=org.jboss.cache.pojo.jmx.PojoCacheJmxWrapperMBean.class, \n                registerDirectly=true)&lt;/annotation&gt;\n    &lt;constructor&gt;\n        &lt;parameter&gt;\n            &lt;inject bean=\"MyPojoCache\"/&gt;\n        &lt;/parameter&gt;\n    &lt;/constructor&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p></p>\n\n<p>Thank you.\nAbitfarago</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12798686,"title":"Hibernate hangs at session.createQuery.list","body":"<p>Below is my code \n<code></p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\nprotected List&lt;String&gt; executeTestQuery(final String query)\n{\n    List&lt;String&gt; ret;\n\n    Session session = factory.openSession();\n       try\n    {\n          ret = session.createQuery(query).list();//HANGS\n     }\n    finally\n    {\n\n        session.flush();\n\n       session.close();\n\n    }\n    return ret;\n}\n</code></pre>\n\n<p></code></p>\n\n<p>Above method is common method which is getting called from every method and also  recursively in some cases.  <br>Hibernate hangs at mentioned point after few run. <br> I even added<br>  <code>config.setProperty(Environment.C3P0_MAX_SIZE, \"100\");</code><br> \n<code> session.clear(), SessionFactoryUtils.releaseSession(session, factory);</code>\n<br>Still no use.<br>\nAny suggestion for above problem would be a great help.</p>\n"},{"tags":["spring","hibernate","datasource","apache-commons-dbcp","password-encryption"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":139,"score":3,"question_id":12834604,"title":"Using encrypted password for the datasource used in spring applicationContext.xml","body":"<p>I want to keep encrypted password in my below mentioned springApplicationContext.xml</p>\n\n<p>Is there any way to achieve this? </p>\n\n<p>presently I have configured all properties using property-placeholder\nas shown below but the raw password is still open in my database.properties</p>\n\n<h2>springApplicationContext.xml</h2>\n\n<pre><code>&lt;beans:bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n        &lt;beans:property name=\"driverClassName\"&gt;&lt;beans:value&gt;${db.driverClassName}&lt;/beans:value&gt;&lt;/beans:property&gt;\n        &lt;beans:property name=\"url\"&gt;&lt;beans:value&gt;${db.url}&lt;/beans:value&gt;&lt;/beans:property&gt;\n        &lt;beans:property name=\"username\"&gt;&lt;beans:value&gt;${db.username}&lt;/beans:value&gt;&lt;/beans:property&gt;\n        &lt;beans:property name=\"password\"&gt;&lt;beans:value&gt;${db.password}&lt;/beans:value&gt;&lt;/beans:property&gt;\n&lt;/beans:bean&gt;\n</code></pre>\n\n<p>but actual values are present in my <code>database.properties</code></p>\n\n<pre><code>db.driverClassName=com.mysql.jdbc.Driver\ndb.url=jdbc:mysql://localhost/myDB\ndb.username=root\ndb.password=root\n</code></pre>\n\n<p>I want something like below:</p>\n\n<h2>springApplicationContext.xml (same as above)</h2>\n\n<pre><code>&lt;beans:bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n        &lt;beans:property name=\"driverClassName\"&gt;&lt;beans:value&gt;${db.driverClassName}&lt;/beans:value&gt;&lt;/beans:property&gt;\n        &lt;beans:property name=\"url\"&gt;&lt;beans:value&gt;${db.url}&lt;/beans:value&gt;&lt;/beans:property&gt;\n        &lt;beans:property name=\"username\"&gt;&lt;beans:value&gt;${db.username}&lt;/beans:value&gt;&lt;/beans:property&gt;\n        &lt;beans:property name=\"password\"&gt;&lt;beans:value&gt;${db.password}&lt;/beans:value&gt;&lt;/beans:property&gt;\n&lt;/beans:bean&gt;\n</code></pre>\n\n<p>But password property value should be in encripted format in my <code>database.properties</code></p>\n\n<pre><code>db.driverClassName=com.mysql.jdbc.Driver\ndb.url=jdbc:mysql://localhost/myDB\ndb.username=root\ndb.password=3g6n72ef8x (using any encription method).\n</code></pre>\n\n<p>and my dataSource internally decrypt the password before making new DB connection.</p>\n\n<p>Highly appreciate for any help/suggestion in this.</p>\n"},{"tags":["java","mysql","hibernate","netbeans-7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12774679,"title":"How to update POJO set using hibernate","body":"<p>Being new to hibernate, I am using netbeans 7.2, Glassfish 3.x, and mysql. From my database schema I use hibernate.cfg.xml and hibernate.reveng.xml to create the POJOs. The option in Netbeans is <code>Hibernate Mapping files and POJOs</code>.</p>\n\n<p>My question is this: Having added a new table to the data, how do I bring it in as a POJO?  I try updating both hibernate.cfg.xml and hibernate.reveng.xml by hand and do <code>clean and build</code> and then <code>run</code> but that does not work.</p>\n\n<p>EDIT TO ADD HIBERNATE.CFG.XML</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n&lt;session-factory&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql://localhost:3306/anims&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;mouser&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.password\"&gt;my password&lt;/property&gt;\n    &lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"hibernate.current_session_context_class\"&gt;thread&lt;/property&gt;\n    &lt;property name=\"hibernate.query.factory_class\"&gt;org.hibernate.hql.classic.ClassicQueryTranslatorFactory&lt;/property&gt;\n    &lt;!-- Names the annotated entity class --&gt;\n    &lt;mapping class=\"ccvd.Photo\"/&gt;\n    &lt;mapping class=\"ccvd.Dogs\"/&gt;\n    &lt;mapping class=\"ccvd.Cats\"/&gt;\n    &lt;mapping class=\"ccvd.Birds\"/&gt;\n      &lt;/session-factory&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["java","spring","hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":247,"score":1,"question_id":10859128,"title":"Hibernate integration on a Spring web application","body":"<p>I have been following <a href=\"http://static.springsource.org/docs/Spring-MVC-step-by-step/index.html\" rel=\"nofollow\">this tutorial</a> on the Springsource website in order to have basic knowledge of Spring. Everything went good.</p>\n\n<p>Now, I would like to integrate Hibernate to this little application I wrote following this tutorial. I found documentation on different websites (including hibernate's website) but I still have a few questions before starting.</p>\n\n<p>I read some stuff about JPA and I can use it as an abstraction layer on top of hibernate but I don't really understand what for.</p>\n\n<p>In addition, I read somewhere that there is two ways to use hibernate, the first one is annotations and the second one is using javax.persistance, I am right?</p>\n\n<p>Is there some recent documentation about how to use hibernate in an existing spring web application, as well as the different ways to implement it?</p>\n"},{"tags":["spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12831096,"title":"Spring+Hibernate+MS SQL: object references an unsaved transient instance child object id(primary key) cannot be zero","body":"<p>I'm developing a web application using Spring+Hibernate+MS SQL and encountered a weird symptom:</p>\n\n<p>I have parent object <code>A</code> that has a field reference (<code>FK</code>) another child object <code>B</code>. In <code>A</code>, I have annotation</p>\n\n<pre><code>@ManyToOne(cascade={CascadeType.PERSIST, CascadeType.MERGE}, fetch=FetchType.EAGER)\n</code></pre>\n\n<p>When I call <code>Session.SaveOrUpdate</code> for <code>A</code>. Everything works fine and <code>B</code> is persisted as well except one case: </p>\n\n<p>When <code>id field</code> (which is the primary key) of table B is 0, it gives exception:</p>\n\n<blockquote>\n  <p>object references an unsaved transient instance...</p>\n</blockquote>\n\n<p>If it is non-zero, everything is fine.</p>\n\n<p>As most people suggested for the exception \"object references an unsaved transient instance...\", I also tried change annotation to </p>\n\n<pre><code>@ManyToOne(cascade={CascadeType.ALL}, fetch=FetchType.EAGER). \n</code></pre>\n\n<p>Then it gives me another error saying <code>Primary key cannot be NULL</code>...</p>\n\n<p>Does anybody have any comments or explanation on this problem? Your help is highly appreciated!!</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3823,"score":2,"question_id":3117666,"title":"Hibernate custom SQL query with join - avoiding returning a list of arrays","body":"<p>I have a custom SQL query in Hibernate (3.5.2) in which I want to return a mapped object, and an associated (joined) object. However, Hibernate seems to be giving me a list of arrays rather than a list of objects.</p>\n\n<p>To simplify my situation a bit :-</p>\n\n<p>Entity1 contains a foreign key to Entity2, and the mapped objects are set up so that Entity1 has an object property referencing Entity2. I want to retrieve a list of Entity1 objects, but with the associated object reference already initialised (so that the associated object has been loaded).</p>\n\n<p>Now, I can do this with a custom SQL query like this:</p>\n\n<pre><code>final SQLQuery qry = hibernateSession.createSQLQuery(\n    \"select {entity1.*}, {entity2.*} from entity1 inner join entity2 on entity1.fk = entity2.id \");\n\nqry.setReadOnly(true);\nqry.addEntity(\"entity1\", Entity1.class);\nqry.addJoin(\"entity2\", \"entity1.entity2\");\n\nList list = qry.list();  // Returns list of arrays!!\n</code></pre>\n\n<p>This works, in that all the Entity1 objects are correctly initialised. However, the list that I get back IS NOT a plain list of Entity1 objects. It is in fact a list of arrays, where each array contains 2 elements - Entity1 and Entity2.  I'm assuming this is because I've put two alias entries in the SELECT clause.</p>\n\n<p>If I remove the second alias (for Entity2), I just get \"column not found\" errors - presumably because Hibernate can't find the fields to initialise entity2 from.</p>\n\n<p>Any ideas? I have a query that can return the fields for the primary and associated object, but I want the List returned to just be a list of Entity1 objects. </p>\n\n<p>Pre-emptive comment: Yes, I know I could probably re-structure this and do the query a different way (criteria API etc). But this is what I'm stuck with at the moment. In this particular situation I'm constrained by some other factors, so was hoping there was just some way of telling Hibernate what I want!</p>\n\n<p>Thanks.</p>\n"},{"tags":["java","hibernate","jsf","primefaces","tomcat7"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12751490,"title":"when I refresh the page that contains a datatable I lose the new data added Primefaces JSF","body":"<p>When I refresh the page that contains a datatable I lose the new data added to the datatable I refresh it almost 5 times or I restart the tomcat application server to get the data I posted . im using Primefaces3.4  Hibernate 3 Jsf 2 Tomcat 7.\nthis is an extract of ManagedBean :</p>\n\n<pre><code>import java.util.ArrayList;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.TimeZone;\n\nimport javax.enterprise.inject.New;\nimport javax.faces.application.FacesMessage;\nimport javax.faces.bean.ManagedProperty;\nimport javax.faces.context.FacesContext;\nimport javax.faces.event.ValueChangeEvent;\nimport javax.faces.model.SelectItem;\n\nimport org.primefaces.event.FlowEvent;\nimport org.primefaces.event.RowEditEvent;\n\nimport com.oxynord.dao.RetourDao;\nimport com.oxynord.dao.BonbonneDao;\nimport com.oxynord.dao.BonbonneDataModel;\nimport com.oxynord.dao.ChargementDao;\nimport com.oxynord.dao.ChauffeurDao;\nimport com.oxynord.dao.EnvoiDao;\nimport com.oxynord.dao.UtilisateurDao;\nimport com.oxynord.dao.VenteDao;\nimport com.oxynord.data.*;\npublic class BonBonneManagedBean {\n//test test\n//private BonbonneDao BDAO=new BonbonneDao();\nprivate Bonbonne bonbonne=new Bonbonne();\nprivate Bonbonne selectedBonbonne;\nprivate Chauffeur chauffeur=new Chauffeur();\nprivate Chargement chargement=new Chargement();\nprivate Chargement selectedChargement;\nprivate Envoi envoi=new Envoi();\nprivate Envoi selectedEnvoi;\nprivate Client client=new Client();\nprivate Vente vente=new Vente();\nprivate Retour retour=new Retour();\nprivate Client selectedClient;\nprivate List&lt;Client&gt; listClients;\nprivate List&lt;Historiquebonbonne&gt; listhistorique;\n\n// Test Vente\nList&lt;Bonbonne&gt; bs=new ArrayList&lt;Bonbonne&gt;();\nList&lt;Bonbonne&gt; bs2=new ArrayList&lt;Bonbonne&gt;();\n\n// get user connecté from session\nprivate AuthenticationController authen = (AuthenticationController)FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get(\"authenticationController\");\n\n\nprivate Date date=new Date();\n\n// -- Table à cocher des bonbonnes --\nprivate BonbonneDataModel bonbonneDataModel;\nprivate Bonbonne[] selectedBonbonnes;\n\nboolean next=false;\n\npublic boolean isNext() {\n    return next;\n}\n\npublic void setNext(boolean next) {\n    this.next = next;\n}\n\n\n// -------------------------------- edit -----------------------------------------------\n\n// modifier une bonbonne\npublic void onEdit(RowEditEvent event) throws Exception {  \n        BonbonneDao.ModifierBonbonne(((Bonbonne) event.getObject()));   \n} \n// modifier un chauffeur\npublic void onEditChauffeur(RowEditEvent event) throws Exception {  \n    BonbonneDao.ModifierChauffeur(((Chauffeur) event.getObject())); \n } \n</code></pre>\n\n<p>and this is BonbonneDAO : </p>\n\n<pre><code> import java.util.ArrayList;\n     import java.util.Date;\n     import java.util.List;\n\n     import javax.faces.application.FacesMessage;\n     import javax.faces.context.FacesContext;\n\n     import org.hibernate.Session;\n\n     import com.oxynord.data.Bonbonne;\n     import com.oxynord.data.Chauffeur;\n     import com.oxynord.data.Client;\n     import com.oxynord.data.Domaine;\n     import com.oxynord.data.Etatactuelle;\n     import com.oxynord.data.Historiquebonbonne;\n     import com.oxynord.data.Produit;\n     import com.oxynord.data.Stock;\n     import com.oxynord.data.Utilisateur;\n     import com.oxynord.data.Ville;\n     import com.oxynord.data.Volume;\n     import com.oxynord.utile.HibernateUtil;\n\n     public class BonbonneDao {\nDate date=new Date();\n\n//----------List Historiquebonbonne--------------------------\n\n    @SuppressWarnings(\"unchecked\")\n    public static List&lt;Historiquebonbonne&gt; HistoriqueBonbonne(Bonbonne bonbonne) {\n        Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n        session.beginTransaction();\n        List&lt;Historiquebonbonne&gt; listHistoriquebonbonne= new ArrayList&lt;Historiquebonbonne&gt;();\n        listHistoriquebonbonne= session.createQuery(\"from Historiquebonbonne as h where h.bonbonne.idBonbonne='\"+bonbonne.getIdBonbonne()+\"' order by h.idHistorique desc \").list();\n        return listHistoriquebonbonne;\n    }\n\n//----------List des bonbonnes qui ont dépasser la date de 3 mois--------------------------\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Bonbonne&gt; BonbonnesVendu() {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Bonbonne&gt; listBonbonnesVente= new ArrayList&lt;Bonbonne&gt;();\n    listBonbonnesVente = session.createQuery(\"from Etatactuelle where libelle= 'Vendu' \").list();\n    return listBonbonnesVente;\n}\n\n//--------------------------------------------------------------------------\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Bonbonne&gt; ListBonbonnesVide() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Bonbonne&gt; listBonbonnes= new ArrayList&lt;Bonbonne&gt;();\n    listBonbonnes = session.createQuery(\"from Bonbonne where etatactuelle.idEtat=1 and stock.idStock=1\").list();\n    return listBonbonnes;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static  List&lt;Bonbonne&gt; AllBonbonnes() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Bonbonne&gt; listBonbonnes= new ArrayList&lt;Bonbonne&gt;();\n    listBonbonnes = session.createQuery(\"from Bonbonne\").list();\n    return listBonbonnes;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Produit&gt; AllProduits() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Produit&gt; listProduit= new ArrayList&lt;Produit&gt;();\n    listProduit = session.createQuery(\"from Produit\").list();\n    return listProduit;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Ville&gt; AllVille() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Ville&gt; listVille= new ArrayList&lt;Ville&gt;();\n    listVille = session.createQuery(\"from Ville\").list();\n    return listVille;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Domaine&gt; AllDomaine() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Domaine&gt; listDomaine= new ArrayList&lt;Domaine&gt;();\n    listDomaine = session.createQuery(\"from Domaine\").list();\n    return listDomaine;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Volume&gt; AllVolumes() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Volume&gt; listVolume= new ArrayList&lt;Volume&gt;();\n    listVolume = session.createQuery(\"from Volume\").list();\n    return listVolume;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Etatactuelle&gt; AllEtatsActuelleBonbonne() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Etatactuelle&gt; listEtatactuelle= new ArrayList&lt;Etatactuelle&gt;();\n    listEtatactuelle = session.createQuery(\"from Etatactuelle\").list();\n    return listEtatactuelle;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n@SuppressWarnings(\"unchecked\")\npublic static List&lt;Stock&gt; AllStocks() {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    session.beginTransaction();\n    List&lt;Stock&gt; listStock= new ArrayList&lt;Stock&gt;();\n    listStock = session.createQuery(\"from Stock\").list();\n    return listStock;\n    } catch (Exception e) {\n        System.out.println(e);\n    }\n    return null;\n}\n\n// ---------------------------- Ajouter Bonbonne -----------------------------------------------\n\n@SuppressWarnings(\"unchecked\")\npublic static boolean addBonbonne(Bonbonne bonbonne) throws Exception {\n    try {\n    Session session = HibernateUtil.getSessionFactory().getCurrentSession();\n    org.hibernate.Transaction tx = session.beginTransaction();\n    List&lt;Bonbonne&gt; b=session.createQuery(\"from Bonbonne where codebare='\"+bonbonne.getCodebare()+\"' or numeroSerie='\"+bonbonne.getNumeroSerie()+\"'\").list();\n\n    /* Test si le bonbonne est deja enregistrer\n     si oui --&gt; afficher que le bobonne est deja enregistrer\n     si non --&gt; enregistrer le bonbonne */\n\n    if(b.size()==0) {\n    //Utilisateur u=(Utilisateur) session.createQuery(\"from Utilisateur\").list().get(0);    \n    //bonbonne.setUtilisateur(u);\n    session.save(bonbonne); \n    tx.commit();\n    FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(\"une bonbonne a été enregister avec succes\"));\n    return true;\n    } else {\n    FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_WARN,\"Il existe déjà un Code barre:\"+b.get(0).getCodebare()+\" avec un numero de série:\"+b.get(0).getNumeroSerie()+\"\", \"Code barre ou numero de série déjà enregistrer\"));  \n    return false;\n    }\n\n    } catch (Exception e) {\n    FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR,\"Erreur d'enregistrement\", \"Erreur d'enregistrement\"));  \n    System.out.println(e);\n    return false;\n    }\n}\n</code></pre>\n"},{"tags":["string","hibernate","integer","like","criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12841531,"title":"Hibernate Criteria API condition \"like\" with integer","body":"<p>In my database I have a column \"year\" which is an integer.</p>\n\n<p>How can I search by using Criteria API (not by HQL) which records contain, for example \"196...\" in the year column?</p>\n\n<p>I think it should be Restrictions.like, but I got exception:</p>\n\n<pre><code>SEVERE: java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer\n</code></pre>\n"},{"tags":["java","ajax","hibernate","mvc","jsp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":12816687,"title":"Sample Ajax program for JSP+Servlets+Hibernate","body":"<p>In my app im using JSP as view,servlet as controller,hibernate as model..</p>\n\n<p>in that app jsp pages im have to fill form while creating new user with fields like username and all.</p>\n\n<p>now i want to use AJAX code to check if username name with entered name in form is already there in the database or not...</p>\n\n<p>can any1 guide me how to write coding for this as well as the control flow..</p>\n\n<p>i have googled but didnt got any idea how to do this requirement..</p>\n\n<p>thanks in advance</p>\n"},{"tags":["hibernate","hibernate-annotations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4050,"score":1,"question_id":9104221,"title":"Hibernate buildSessionFactory() Exception","body":"<p>I have a serious problem with hibernate. I followed various books und online tutorials, but I ever get the same Exception \"ExceptionInInitializerError\" obviously thrown by the HibernateUtil.java Line</p>\n\n<pre><code>SessionFactory sf = cfg.configure().buildSessionFactory();\n</code></pre>\n\n<p>My Tomcat log says the following:</p>\n\n<pre><code>Caused by: java.lang.ExceptionInInitializerError\nat de.marcelstuht.nerven2.server.HibernateUtil.buildSessionFactory(HibernateUtil.java:23)\nat de.marcelstuht.nerven2.server.HibernateUtil.&lt;clinit&gt;(HibernateUtil.java:8)\nat de.marcelstuht.nerven2.shared.model.Account.&lt;init&gt;(Account.java:52)\nat de.marcelstuht.nerven2.server.GreetingServiceImpl.loginServer(GreetingServiceImpl.java:39)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\nat java.lang.reflect.Method.invoke(Method.java:597)\nat com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)\n... 21 more\n\nCaused by: org.hibernate.MappingException: Could not get constructor for org.hibernate.persister.entity.SingleTableEntityPersister\nat org.hibernate.persister.internal.PersisterFactoryImpl.create(PersisterFactoryImpl.java:180)\nat org.hibernate.persister.internal.PersisterFactoryImpl.createEntityPersister(PersisterFactoryImpl.java:131)\nat org.hibernate.internal.SessionFactoryImpl.&lt;init&gt;(SessionFactoryImpl.java:345)\nat org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1737)\nat org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1775)\nat de.marcelstuht.nerven2.server.HibernateUtil.buildSessionFactory(HibernateUtil.java:18)\n... 29 more\n\nCaused by: org.hibernate.InstantiationException: could not instantiate test objectde.marcelstuht.nerven2.shared.model.Account\nat org.hibernate.engine.internal.UnsavedValueFactory.instantiate(UnsavedValueFactory.java:49)\nat org.hibernate.engine.internal.UnsavedValueFactory.getUnsavedIdentifierValue(UnsavedValueFactory.java:68)\nat org.hibernate.tuple.PropertyFactory.buildIdentifierProperty(PropertyFactory.java:75)\nat org.hibernate.tuple.entity.EntityMetamodel.&lt;init&gt;(EntityMetamodel.java:143)\nat org.hibernate.persister.entity.AbstractEntityPersister.&lt;init&gt;(AbstractEntityPersister.java:498)\nat org.hibernate.persister.entity.SingleTableEntityPersister.&lt;init&gt;(SingleTableEntityPersister.java:142)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\nat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\nat org.hibernate.persister.internal.PersisterFactoryImpl.create(PersisterFactoryImpl.java:158)\n... 34 more\n\nCaused by: java.lang.reflect.InvocationTargetException\nat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\nat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)\nat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\nat java.lang.reflect.Constructor.newInstance(Constructor.java:513)\nat org.hibernate.engine.internal.UnsavedValueFactory.instantiate(UnsavedValueFactory.java:46)\n... 44 more\n\nCaused by: java.lang.NullPointerException\nat de.marcelstuht.nerven2.shared.model.Account.&lt;init&gt;(Account.java:52)\n... 49 more\n</code></pre>\n\n<p>Account.java</p>\n\n<pre><code>package de.marcelstuht.nerven2.shared.model;\n\nimport java.io.Serializable;\nimport java.util.List;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\nimport javax.validation.constraints.NotNull;\n\nimport org.apache.commons.codec.digest.DigestUtils;\nimport org.hibernate.Session;\nimport org.hibernate.criterion.*;\n\nimport de.marcelstuht.nerven2.server.HibernateUtil;\n\n@Entity\n@Table(name = \"account\")\npublic class Account implements Serializable {\n\nprivate static final long serialVersionUID = 2675108132819989138L;\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Column(name = \"id\")\nLong id;\n\n@NotNull\n    @Column(name = \"username\", unique = true)\nString username;\n\n@Column(name = \"password\")\nString password;\n\n@Column(name = \"email\")\nString email;\n\nprotected Session session;\n\n\npublic Account() {\n    session = HibernateUtil.getSessionFactory().openSession();\n}\n\npublic Account(Long id) {\n    this.id = id;\n    session = HibernateUtil.getSessionFactory().openSession();\n}\n\npublic Account(Long id, String username, String password, String email) {\n    this.id = id;\n    this.username = username;\n    this.password = password;\n    this.email = email;\n    session = HibernateUtil.getSessionFactory().openSession();\n\n}\n\npublic void setId(Long newid) {\n    id = newid;\n}\n\npublic Long getId() {\n    return id;\n}\n\npublic void setUsername(String user) {\n    username = user;\n}\n\npublic String getUsername() {\n    return username;\n}\n\npublic void setEmail(String mail) {\n    email = mail;\n}\n\npublic String getEmail() {\n    return email;\n}\n\npublic void setPassword(String newPass) {\n    password = newPass;\n}\n\npublic void setNewPassword(String newPass) {\n    password = hashPassword(newPass);\n}\n\npublic boolean checkPassword(String pass) {\n    pass = hashPassword(pass);\n    if (password.equals(pass)) return true;\n    else return false;\n}\n\nprivate String hashPassword(String password) {\n    return DigestUtils.shaHex(\"wudu390909dfh\"+password);\n}\n\npublic Account get(Long id) {\n    session.beginTransaction();\n    Account result = (Account) session.get(\"account\", id);\n    session.getTransaction().commit();\n    return result;\n}\n\npublic Long saveOrUpdate(Account account) {\n    if (account == null) {\n        return null;\n    }\n\n    session.beginTransaction();\n\n    session.saveOrUpdate(account);\n    Long id = (Long) session.getIdentifier(account);\n\n    session.getTransaction().commit();\n    return id;\n}\n\npublic void delete(Account account) {\n    if (account == null) {\n        return;\n    }\n    session.beginTransaction();\n    session.delete(account);\n    session.getTransaction().commit();\n}\n\npublic List&lt;Account&gt; getAccountByUsername(String user) {\n    session.beginTransaction();\n\n    @SuppressWarnings(\"unchecked\")\n    List&lt;Account&gt; result = session\n            .createCriteria(Account.class)\n            .add(Restrictions.eq(\"username\", user))\n            .list();\n    session.getTransaction().commit();\n\n    return result;\n}\n\n}\n</code></pre>\n\n<p>HibernateUtil.java</p>\n\n<pre><code>package de.marcelstuht.nerven2.server;\n\nimport org.hibernate.SessionFactory;\nimport org.hibernate.cfg.Configuration;\nimport org.jboss.logging.Logger;\n\npublic class HibernateUtil {\nprivate static final SessionFactory sessionFactory = buildSessionFactory();\n\nprotected HibernateUtil() {\n\n}\n\nprivate static SessionFactory buildSessionFactory() {\n    try {\n        // Create the SessionFactory from hibernate.cfg.xml\n        Configuration cfg = new Configuration();\n        SessionFactory sf = cfg.configure().buildSessionFactory();\n        return sf;\n    } catch (Exception ex) {\n        // Make sure you log the exception, as it might be swallowed\n        Logger.getLogger(HibernateUtil.class).error(\"Initial SessionFactory creation failed.\", ex);\n        throw new ExceptionInInitializerError(ex);\n    }\n}\n\npublic static SessionFactory getSessionFactory() {\n    return sessionFactory;\n}\n}\n</code></pre>\n\n<p>hibernate.cfg.xml</p>\n\n<pre><code>&lt;!DOCTYPE hibernate-configuration PUBLIC\n    \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n    \"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd\"&gt;\n\n&lt;hibernate-configuration&gt;\n\n&lt;session-factory&gt;\n\n    &lt;!-- Database connection settings --&gt;\n    &lt;property name=\"connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n    &lt;property name=\"connection.url\"&gt;jdbc:mysql://127.0.0.1:3306/ba&lt;/property&gt;\n    &lt;property name=\"connection.username\"&gt;*myuser*&lt;/property&gt;\n    &lt;property name=\"connection.password\"&gt;*mypassword*&lt;/property&gt;\n\n    &lt;!-- JDBC connection pool (use the built-in) --&gt;\n    &lt;property name=\"connection.pool_size\"&gt;1&lt;/property&gt;\n\n    &lt;!-- SQL dialect --&gt;\n    &lt;property name=\"dialect\"&gt;org.hibernate.dialect.MySQL5InnoDBDialect&lt;/property&gt;\n\n    &lt;!-- Disable the second-level cache  --&gt;\n    &lt;!-- &lt;property name=\"cache.provider_class\"&gt;org.hibernate.cache.internal.NoCacheProvider&lt;/property&gt;--&gt;\n\n    &lt;!-- Echo all executed SQL to stdout --&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n\n    &lt;!-- Drop and re-create the database schema on startup --&gt;        \n    &lt;property name=\"hibernate.bytecode.provider\"&gt;javassist&lt;/property&gt;\n\n    &lt;!-- Names the annotated entity class --&gt;\n    &lt;mapping class=\"de.marcelstuht.nerven2.shared.model.Account\"/&gt;\n\n&lt;/session-factory&gt;\n</code></pre>\n\n<p></p>\n\n<p>I tried both Hibernate 3.6.9 as well as 4.0.1 (in different Eclipse Projects).\nA screenshot of the JARs I added to the project is available on Skitch: <a href=\"https://skitch.com/marcelstuht/g7h8h/properties-for-nerven2\" rel=\"nofollow\">https://skitch.com/marcelstuht/g7h8h/properties-for-nerven2</a></p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12827866,"title":"Hibernate entity does not update in application, it does in database","body":"<p>I'm asking for your kind answer to the following: What would be the reason for an entity state not getting updated in the Application BUT it does in the database.</p>\n\n<p>A simple example.</p>\n\n<pre><code>System.print.out.println(patio.getName()); // = \"HisYard\"\npatio.setName(\"MyYard\");\nsession.saveOrUpdate(patio);\nsession.persists(patio);\nsession.flush();\nsession.commit();\nsession.disconnect();\n\n------MySql Database-------\nid_patio = 3\nname = \"MyYard\"\n------Database-------\n\nLater on the same application...\n\nSession session = HibernateUtil.getSessionFactory().openSession();\nint niceNeigborhood = 3;\nNeighborhood neighborhood = (Neighborhood)session.load(Neighborhood.class, niceNeigborhood);\nsession.refresh(neighborhood);\nString whosYardIsThis = neighborhood.getHouse().getPatio().getName();\nSystem.print.out.println(whosYardIsThis); // = \"HisYard\" !!!!!!!\n</code></pre>\n\n<p>As you can see, nothing, flush, commit, refresh, save, nothing works. BUT my database IS updated, the entity is NOT.</p>\n\n<p>Help, please.</p>\n"},{"tags":["spring","hibernate","jackson"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":475,"score":0,"question_id":9594834,"title":"Internal server error on Jackson @ResponseBody","body":"<p>I just want to return my user object as JSON for use by an ajax call on the client-side.  </p>\n\n<p>This was working at one point, and after some updates (namely, changing the application to deploy to / in Jetty), now it's not. </p>\n\n<p>I'm not throwing an exception from the code, it is returning just fine, but seems to blow up somewhere in the root code in Jackson when trying to convert the object to JSON.  </p>\n\n<p>Like I said, I'm not getting an exception, my ajax call just blows up saying error code \"500, Internal Server Error\".  </p>\n\n<pre><code>/* User contains information about a user of this site, that exists only\n * in the context of this site (no names, addresses).\n */\n@Entity(name=\"User\")\n@Table(name=\"USER\")\n@NamedQuery(\n    name=\"findUserByName\",\n    query=\"SELECT OBJECT(u) FROM User u WHERE u.name = :name\"\n)\npublic class User extends AuditableEntity implements Serializable {\n\nprivate static final long serialVersionUID = -1308795024222223320L;\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Column(name=\"id\")\nprivate Long id;\n\n\n@NotEmpty\n@MinSkipEmpty(value=6)\n@MaxSkipEmpty(value=32)\n@Column(name=\"name\", length=32)\nprivate String name;\n\n@NotEmpty\n@MinSkipEmpty(value=4)\n@MaxSkipEmpty(value=40)\n@Column(name=\"password\", length=40)\nprivate String password;\n\n@Column(name=\"salt\", length=40)\nprivate String salt;\n\n\n@ManyToOne(fetch=FetchType.LAZY, cascade={CascadeType.PERSIST})\n@JoinColumn(name=\"person_id\")\nprivate Person person;\n\n@Column(name=\"last_login\")\nprivate Date lastLogin;\n\n@ElementCollection(fetch=FetchType.EAGER)\n@CollectionTable(name =\"USER_AUTHORITY\")\n@Column(name=\"authority\")\nprivate List&lt;Integer&gt; authorities;\n\n\npublic Long getId() {\n    return id;\n}\n\npublic void setId(Long id) {\n    this.id = id;\n}\n\npublic String getName() {\n    return name;\n}\n\npublic void setName(String name) {\n    this.name = (name == null ? name : name.trim());\n\n}\n\npublic String getPassword() {\n    return password;\n}\n\npublic void setPassword(String password) {\n    this.password = (password == null ? password : password.trim());\n}\n\npublic String getSalt() {\n    return salt;\n}\n\npublic void setSalt(String salt) {\n    this.salt = salt;\n}\n\npublic Person getPerson() {\n    return person;\n}\n\npublic void setPerson(Person person) {\n    this.person = person;\n}\n\npublic Date getLastLogin() {\n    return lastLogin;\n}\n\npublic void setLastLogin(Date lastLogin) {\n    this.lastLogin = lastLogin;\n}\n\npublic List&lt;Integer&gt; getAuthorities() {\n    return authorities;\n}\n\npublic void setAuthorities(List&lt;Integer&gt; authorities) {\n    this.authorities = authorities;\n}\n\n}\n</code></pre>\n\n<p>This is the Person Entity</p>\n\n<pre><code>@Entity(name = \"Person\")\n@Table(name = \"PERSON\")\npublic class Person extends AuditableEntity implements Serializable {\n\n    private static final long serialVersionUID = -1308795024262635690L;\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"id\")\n    private Long id;\n\n    @NotEmpty\n    @MaxSkipEmpty(value=64)\n    @Column(name = \"firstName\", length=64)\n    private String firstName;\n\n    @NotEmpty\n    @MaxSkipEmpty(value=64)\n    @Column(name = \"lastName\", length=64)\n    private String lastName;\n\n    @NotEmpty\n    @Email\n    @MaxSkipEmpty(value=256,  message=\"\")\n    @Column(name = \"email\", length=256)\n    private String email;\n\n    @DateTimeFormat(pattern=\"MM/dd/yyyy\")\n    @NotNull(message = \"Required field\")\n    @Column(name = \"date\")\n    private Date birthday;\n\n    @ManyToOne(fetch = FetchType.LAZY, cascade = { CascadeType.PERSIST })\n    @JoinColumn(name = \"location_id\")\n    private Location location;\n\n\n    public Person() {\n\n    }\n\n    public Person(String firstName, String lastName) {\n        super();\n        this.firstName = firstName;\n        this.lastName = lastName;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getFirstName() {\n        return firstName;\n    }\n\n    public void setFirstName(String firstName) {\n        this.firstName = firstName;\n    }\n\n    public String getLastName() {\n        return lastName;\n    }\n\n    public void setLastName(String lastName) {\n        this.lastName = lastName;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public Location getLocation() {\n        return location;\n    }\n\n    public void setLocation(Location location) {\n        this.location = location;\n    }\n\n    public Date getBirthday() {\n        return birthday;\n    }\n\n    public void setBirthday(Date birthday) {\n        this.birthday = birthday;\n    }\n\n    @Override\n    public String toString() {\n\n        return super.toString() + \" name = \" + firstName + \" \" + lastName\n                + \" id = \" + id;\n    }\n\n    @Override\n    public int hashCode() {\n        final int prime = 31;\n        int result = 1;\n        result = prime * result\n                + ((firstName == null) ? 0 : firstName.hashCode());\n        result = prime * result + ((id == null) ? 0 : id.hashCode());\n        result = prime * result\n                + ((lastName == null) ? 0 : lastName.hashCode());\n        return result;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        Person other = (Person) obj;\n        if (firstName == null) {\n            if (other.firstName != null)\n                return false;\n        } else if (!firstName.equals(other.firstName))\n            return false;\n        if (id == null) {\n            if (other.id != null)\n                return false;\n        } else if (!id.equals(other.id))\n            return false;\n        if (lastName == null) {\n            if (other.lastName != null)\n                return false;\n        } else if (!lastName.equals(other.lastName))\n            return false;\n        return true;\n    }\n\n}\n</code></pre>\n\n<hr>\n\n<pre><code>@Entity(name = \"Location\")\n@Table(name = \"LOCATION\")\npublic class Location extends AuditableEntity implements Serializable {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = \"id\")\n    private Long id;\n\n    //name of person/place/thing\n\n    @Column(name = \"name\", length=128)\n    String name;\n\n    //street address, p.o. box, company name, c/o\n    @NotEmpty\n    @MaxSkipEmpty(value=128)\n    @Column(name = \"line_1\", length=128)\n    String line1;\n\n    // apt., suite, building, floor, entrance, etc.\n    @Column(name = \"line_2\", length=128)\n    String line2;\n\n    @NotEmpty\n    @MaxSkipEmpty(value=64)\n    @Column(name = \"city\", length=64)\n    String city;\n\n    // state, providence, region\n    @NotEmpty\n    @MaxSkipEmpty(value=40)\n    @Column(name = \"state\", length=40)\n    String state;\n\n    // postal code\n    @NotEmpty\n    @MaxSkipEmpty(value=16)\n    @Column(name = \"zip\", length=16)\n    String zip;\n\n    @Column(name = \"country\")\n    String country;\n\n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getLine1() {\n        return line1;\n    }\n\n    public void setLine1(String line1) {\n        this.line1 = line1;\n    }\n\n    public String getLine2() {\n        return line2;\n    }\n\n    public void setLine2(String line2) {\n        this.line2 = line2;\n    }\n\n    public String getCity() {\n        return city;\n    }\n\n    public void setCity(String city) {\n        this.city = city;\n    }\n\n    public String getState() {\n        return state;\n    }\n\n    public void setState(String state) {\n        this.state = state;\n    }\n\n    public String getZip() {\n        return zip;\n    }\n\n    public void setZip(String zip) {\n        this.zip = zip;\n    }\n\n    public String getCountry() {\n        return country;\n    }\n\n    public void setCountry(String country) {\n        this.country = country;\n    }\n\n    private static final long serialVersionUID = -178898928354655555L;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>@RequestMapping(value=\"user/{documentId}\", method=RequestMethod.GET)\npublic @ResponseBody User getUserForDocument( Model model,     @PathVariable(\"documentId\") Long docId){\n\n    Document doc = null;\n    try{\n        doc = dService.find(docId);\n    }catch(Exception e){\n        Logger logger = Logger.getLogger(DocumentController.class);\n        logger.error(e.getMessage());\n    }\n    User user = doc.getUser();\n\n    user.getPerson();\n    user.getPerson().getLocation();\n    return user;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>@Repository()\npublic class DocumentDaoImpl implements DocumentDao {\n\n    @PersistenceContext\n    private EntityManager entityManager;\n\n    @Transactional\n    public Document find(Long id) {\n\n        Document doc = entityManager.find(Document.class, id);\n\n        Hibernate.initialize(doc.getUser());\n        Hibernate.initialize(doc.getUser().getPerson());\n        Hibernate.initialize(doc.getUser().getPerson().getLocation());\n\n        return doc;\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    @Transactional\n    public List&lt;Document&gt; getUnassignedDocumentsForUser(User user) {\n\n        Query query = entityManager.createQuery(new StringBuffer()\n                .append(\"select d from Document d WHERE d.user = :user \")\n                .append(\"AND NOT d IN( SELECT d from Book b, IN(b.docs) bd WHERE bd.id = d.id )\")\n                .append(\"\").toString());\n        query.setParameter(\"user\", user);\n        List&lt;Document&gt; tmp = (ArrayList&lt;Document&gt;) query.getResultList();\n        for(Document doc : tmp){\n            Hibernate.initialize(doc);\n            Hibernate.initialize(doc.getUser());\n            Hibernate.initialize(doc.getUser().getPerson());\n            Hibernate.initialize(doc.getUser().getPerson().getLocation());\n            entityManager.detach(doc);\n            entityManager.detach(doc.getUser());\n            entityManager.detach(doc.getUser().getPerson());\n            entityManager.detach(doc.getUser().getPerson().getLocation());\n        }\n        return tmp;\n    }\n\n    @Transactional\n    public Document save(Document doc) {\n\n        if (doc.getId() == null) {\n            entityManager.persist(doc);\n            return doc;\n        } else {\n            return entityManager.merge(doc);\n        }\n    }\n\n    public EntityManager getEntityManager() {\n        return entityManager;\n    }\n\n    public void setEntityManager(EntityManager entityManager) {\n        this.entityManager = entityManager;\n    }\n\n}\n</code></pre>\n\n<p>ErrorExceptionResolver:</p>\n\n<pre><code>@Component\npublic class BWHandlerExceptionResolver extends SimpleMappingExceptionResolver implements InitializingBean{\n\n    public void afterPropertiesSet() throws Exception {\n        Properties props = new Properties();\n        props.put(Exception.class.getName(),\"error\");\n        this.setExceptionMappings(props);\n\n    }\n</code></pre>\n"},{"tags":["java","hibernate","orm"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":1,"view_count":11371,"score":3,"question_id":3220336,"title":"What's the use of session.flush() in Hibernate","body":"<p>When we are updating a record, we can use <code>session.flush()</code> with Hibernate. What's the need for <code>flush()</code>?</p>\n"},{"tags":["java","hibernate","orm","caching","ehcache"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":954,"score":1,"question_id":3613692,"title":"Hibernate loading all entities utilizing 1st or 2nd level cache","body":"<p>We have an entire table of entities that we need to load during a hibernate session and the only way I know to load all entities is through an HQL query:</p>\n\n<pre><code>public &lt;T&gt; List&lt;T&gt; getAllEntities(final Class&lt;T&gt; entityClass) {\n    if (null == entityClass)\n        throw new IllegalArgumentException(\"entityClass can't be null\");\n\n    List&lt;T&gt; list = castResultList(createQuery(\n            \"select e from \" + entityClass.getSimpleName() + \" e \").list());\n\n\n    return list;\n}\n</code></pre>\n\n<p>We use EHcache for 2nd level caching.</p>\n\n<p>The problem is this gets called 100's of times in a given transaction session and takes up a considerable portion of the total time. Is there any way to load all entities of a given type (load an entire table) and still benefit from 1st level session cache or 2nd level ehcache.</p>\n\n<p>We've been told to stay away from query caching because of their potential performance penalties relative to their gains.\n * <a href=\"http://tech.puredanger.com/2009/07/10/hibernate-query-cache/\" rel=\"nofollow\">Hibernate Query Cache considered harmful</a></p>\n\n<p>Although we're doing performance profiling right now so it might be time to try turning on query cache.</p>\n"},{"tags":["java","hibernate","db2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12813858,"title":"IBM DB2 9.7 Error code 840, select statement list is too large","body":"<p>We are using Hibernate with IBM DB2 9.7. The database gives error about Hibernate generated too large select statement list (including a lot of joins). The error code is 840. Can something be done to fix this? I know the generated select list is very long, but can Hibernate be set to split it into parts or something?</p>\n\n<p>Edit: I reopened this since the problem seems to be a bit larger. So there is a JIRA issue (now rejected) at <a href=\"https://hibernate.onjira.com/browse/ANN-140\" rel=\"nofollow\">https://hibernate.onjira.com/browse/ANN-140</a>.</p>\n\n<p>So the problem is that with Hibernate Annotations, it is not possible to add discriminator with Join strategy. XML configuration however does support this.</p>\n\n<p>Pavel nicely states the problem in the above link discussion like this:</p>\n\n<pre><code>\"It would be nice to see how the problem with the multiple joins is faced when the\n underlying DB has restriction on the number of joins one can execute in a single SQL?\nFor instance MySQL seems to allow only 31 joins. What happens if the class hierarchy\nhas more     than 31 sub-classes?\"\n</code></pre>\n\n<p>An the above is the very problem I am having. We are using annotations and the subclasses are quite a few, creating massive amounts of joins, breaking the DB2 statement.</p>\n\n<p>Any comments on this? I could not find a direct solution either.</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12838588,"title":"Hibernate mapping locations specifiying?","body":"<p>I am using spring and hibernate. i have mapping locations specified as :</p>\n\n<p>My folder structure is as follows:</p>\n\n<pre><code>src/main/resources\n.\n...hibernate\n    .\n    .....hibernate2\n\n\n&lt;property name=\"mappingLocations\" value=\"classpath:hibernate/*.hbm.xml\" /&gt;\n</code></pre>\n\n<p>above property is looking into only hibernate folder and is not looking into subfoders. how can i force to find hbm files in sub folders as well?</p>\n\n<p>Thanks!</p>\n"},{"tags":["java","mysql","spring","hibernate","spring-transactions"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":197,"score":4,"question_id":10833325,"title":"TransactionManager read-only=true does not work with mysql ReplicationDriver","body":"<p>We are using com.mysql.jdbc.ReplicationDriver to connect Master/Slave. We configure the transactionManager as follow.  </p>\n\n<pre><code>&lt;bean id=\"transactionManager\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n\n&lt;tx:advice id=\"txHbAdvice\" transaction-manager=\"transactionManager\"&gt;\n    &lt;tx:attributes&gt;\n        &lt;tx:method name=\"get*\" read-only=\"true\" /&gt;\n    &lt;/tx:attributes&gt;\n&lt;/tx:advice&gt;\n</code></pre>\n\n<p>I set the read-only parameter to true but it doesn't set <code>java.sql.Connection.setReadonly()</code> method to true. All the read queries are still come to master server.</p>\n\n<p>There is an open issue for similar problem <a href=\"https://jira.springsource.org/browse/SPR-8303\" rel=\"nofollow\">here</a> . Is there anyone having a solution to this problem?</p>\n"},{"tags":["hibernate","jpa","jboss","persistence"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":96,"score":1,"question_id":12817672,"title":"@OneToOne mapping does not work with @Inheritance","body":"<p>I have problem with mapping @OneToOne and deployment under jboss.</p>\n\n<p>I have hierarchy of classes:</p>\n\n<pre><code>@Entity\n@Table(name = \"SEED\")\n@Inheritance\n@DiscriminatorColumn(name = \"ENTITY_TYPE\")\n@ForceDiscriminator\npublic class Parent implements Serializable\n{\n   @Id\n   @SequenceGenerator(name = \"SEED_SEQ\", sequenceName = \"SEED_SEQ\")\n   @GeneratedValue(generator = \"SEED_SEQ\")\n   @Column(name = \"AA_ID\")\n   protected Long aaId;\n\n   @Column(name = \"SECRET_SEED\")\n   protected String seed;\n\n   @Column(name = \"ENTITY_ID\") \n   protected String entityId; \n\n   //getters and setters\n}\n\n@Entity\n@DiscriminatorValue(value = \"c1\")\npublic class Child1 extends Parent\n{\n}\n\n@Entity\n@DiscriminatorValue(value = \"c2\")\npublic class Child2 extends Parent\n{\n}\n</code></pre>\n\n<p>I have tried to map child class this way:</p>\n\n<pre><code>@Entity\n@Table(name = \"CLINIC\")\npublic class Clinic implements Serializable\n{\n   @Id\n   @GeneratedValue(generator = \"SEQ_CLINIC_RECID\")\n   @SequenceGenerator(name = \"SEQ_CLINIC_RECID\", sequenceName = \"SEQ_CLINIC_RECID\")\n   @Column(name = \"ID\")\n   private Long id;\n\n   @Column(name = \"CODE\")\n   private String code;\n\n   @OneToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = \"CODE\", referencedColumnName = \"ENTITY_ID\", insertable = false, updatable = false)\n   private Child1 child1;\n\n   //getters and setters\n}\n</code></pre>\n\n<p>When I deploy this on jboss-4.2.3.GA I have following exception:</p>\n\n<pre><code>org.hibernate.AnnotationException: referencedColumnNames(ENTITY_ID) of setup.entities.Clinic.child1 referencing setup.entities.Child1 not mapped to a single property\nat org.hibernate.cfg.BinderHelper.createSyntheticPropertyReference(BinderHelper.java:16\n5)\n        at org.hibernate.cfg.FkSecondPass.doSecondPass(FkSecondPass.java:63)\n        at org.hibernate.cfg.AnnotationConfiguration.processFkSecondPassInOrder(AnnotationConfiguration.java:428)\n        at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.\njava:286)\n        at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1115)\n        at org.hibernate.ejb.Ejb3Configuration.buildMappings(Ejb3Configuration.java:1233)\n        at org.hibernate.ejb.EventListenerConfigurator.configure(EventListenerConfigurator.java\n:154)\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:869)\n        at org.hibernate.ejb.Ejb3Configuration.configure(Ejb3Configuration.java:407)\n        at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:126)\n</code></pre>\n\n<p>I use hibernate 3.2.6.ga, hibernate-entitymanager 3.3.1.ga.</p>\n\n<p>Why do I get this error? Is my mapping is correct?</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":539,"score":1,"question_id":6917755,"title":"Trouble with hibernate optimistic lock and collections","body":"<p>I have a trouble in using optimistic locking. I have a persistent object, with a version number. I want this version number to be increased only when my persistent object is 'really' updated, meaning when one or more fields have been modified or when a collection mapped in my entity with a <code>@ManyToOne</code> or <code>@OneToMany</code> annotation is modified in the database.\nWhat happens is that the version is increased only when a field contained directly in my entity has changed, and <strong>not when a collection has changed</strong>.</p>\n\n<p>Note : I put <strong>select-before-update</strong> in my Entity annotation. Don't know if it might changed the behaviour of the versioning on the collections!\nI also have a field which should not influence the version in my entity, on which I put the <code>@OptimisticLock(exclude=true)</code> annotation.</p>\n\n<p>Does anyone know how I may try to make my versioning work? According to what I've read on several forums, the version number should be automatically increased when a collection changed. Why wouldn't it be the case in my case? Any idea?</p>\n"},{"tags":["java","hibernate"],"answer_count":3,"favorite_count":1,"up_vote_count":15,"down_vote_count":0,"view_count":12830,"score":15,"question_id":624604,"title":"Case-insensitive equals using Hibernate Criteria","body":"<p>I've seen Restrictions.ilike('property', '%value%'), but would like to generate SQL like:  lower(property) = 'value'.  Any ideas?</p>\n\n<p>I used:  </p>\n\n<pre><code>Restrictions.eq(\"email\", email).ignoreCase()\n</code></pre>\n\n<p>since Expression is deprecated.  The SimpleExpression will call toLowerCase() on the value, so it is not necessary to do it beforehand.</p>\n\n<p>See:  <a href=\"http://viewvc.jboss.org/cgi-bin/viewvc.cgi/hibernate/core/trunk/core/src/main/java/org/hibernate/criterion/SimpleExpression.java?view=markup\" rel=\"nofollow\">SimpleExpression source</a></p>\n"},{"tags":["hibernate","jsp","servlets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":27,"score":-1,"question_id":12814582,"title":"Error on using the hibernate session and httpsession in a servlet","body":"<p>This is my Login  Servlet Coding...when i try to use this servlet class it does not works...</p>\n\n<pre><code>@Override\n protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        response.setContentType(\"text/html\");\n    PrintWriter out = response.getWriter();\n        HttpSession session = request.getSession(true); \n        String user_name=request.getParameter(\"user_name\");\n        String user_password=request.getParameter(\"user_password\");\n        try\n               {\n                   SessionFactory factory = new Configuration().configure().buildSessionFactory();\n  Session session1 = factory.getCurrentSession();\n\n                    Query query=session1.createQuery(\"from AdmUsersMstT as A where A.userCode='\"+user_name+\"' and A.userPassword='\"+user_password+\"'\");\n                    List&lt;AdmUsersMstT&gt; list = query.list();\n\n\n\n\n                    if(list.size()&gt;0){\n   request.setAttribute(\"loginstatus\", \"Login Successful.\");\n   session.setAttribute(\"username\", user_name);\n   String url = response.encodeRedirectURL(\"modules/welcome/welcome_page.jsp\");\n                        response.sendRedirect(url);\n\n  }else{\n   request.setAttribute(\"login_status\",\"fail\");\n   getServletContext().getRequestDispatcher(\"/index.jsp\").forward(request, response);\n }\n\n                    session1.flush();\n                   session1.close();\n\n               }\n\n          catch (Exception e) \n          {\n            e.printStackTrace();\n      }\n\n    }\n</code></pre>\n\n<p>The browser does not points any error but it giving blank page with <code>/Login</code> at URL end <code>Login</code> is the servlet name which jsp refers on action...</p>\n\n<p>But if i deletes the session Factory and writes the code as....it forwards to welcome page</p>\n\n<pre><code>@Override\n protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        response.setContentType(\"text/html\");\n    PrintWriter out = response.getWriter();\n        HttpSession session = request.getSession(true); \n        String user_name=request.getParameter(\"user_name\");\n        String user_password=request.getParameter(\"user_password\");\n        try\n               {\n\n   session.setAttribute(\"username\", user_name);\n   String url = response.encodeRedirectURL(\"modules/welcome/welcome_page.jsp\");\n                        response.sendRedirect(url);\n\n\n\n               }\n\n          catch (Exception e) \n          {\n            e.printStackTrace();\n      }\n\n    }\n</code></pre>\n\n<p>Please state the error in my codes....</p>\n"},{"tags":["java","spring","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12836504,"title":"Bean is not instantiating while using hibernate interceptor","body":"<p>I am using hibernate interceptor with spring framework,but when i pass a bean reference of DAO class its not instantiating the bean.\n<em>My interceptor class has:</em>\n     <pre> <code>private IMyService myService;\n       // and getters and setters</code> </pre></p>\n\n<p><em>while application-context.xml having entries</em>:\n    <pre><code>&lt;bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n        &lt;property name=\"entityInterceptor\" ref=\"logInterceptor\"&gt;&lt;/property&gt;\n&lt;/bean&gt; \n&lt;bean name=\"logInterceptor\" class=\"com.amit.project.Utility.TableLogInterceptor\" &gt;\n&lt;property name=\"myService\" ref=\"myService\"/&gt; &lt;/bean&gt;\n&lt;bean name=\"myService\" class=\"com.amit.project.service.impl.MyService\"&gt;</code></pre></p>\n\n<p>But my bean is not instantiating in class, showing null.\n entityInterceptor is not allowing to do that or anything else?\nplz suggest a way if anybody knows.</p>\n"},{"tags":["java","eclipse","hibernate","spring","javadoc"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2330,"score":0,"question_id":7043489,"title":"Eclipse: add javadoc","body":"<p>How can I generally add javadoc in eclipse for different packages.</p>\n\n<p>As an example:<br>\nI want to add all the javadoc for hibernate in eclipse, but I don't know how.\nI've read this article <a href=\"http://stackoverflow.com/questions/3815619/how-to-add-hibernate-javadocs-in-eclipse\">How to add hibernate javadocs in Eclipse?</a> but I don't want to get hibernate tools because I already use STS and I don't understand the other comment.</p>\n\n<p>I'm using eclipse on Ubuntu.</p>\n"},{"tags":["spring","hibernate","unit-testing","cucumber","hibernate-4.x"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":12836548,"title":"How to exposeTransactionAware on a 2nd sessionFactory in hibernate4 + spring?","body":"<p>The test below was working in my application with Hibernate3. When I upgraded it to hibernate4, it started failing.</p>\n\n<pre><code>@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(inheritLocations=false,locations={\n\"/hibernate/spring-SF-tests.xml\",\n\"/hibernate/spring-transaction.xml\",\n\"/hibernate/testBeans.xml\"\n,\"/hibernate/spring-audit.xml\",\n\"/hibernate/iwrs-mail-beans-test.xml\",\n\"/hibernate/fake-audit-meaning.xml\"\n})\n@TransactionConfiguration(transactionManager=\"txManager\", defaultRollback=true)\npublic class CodeAuditIntegrationTest extends CodeIntegrationTest {\n\n@Autowired\nprivate SessionFactory auditFactory;\n\n\n@Before\npublic void cleanAudit(){\nauditFactory.getCurrentSession().createQuery(\"delete from AuditLogRecord\").executeUpdate();\n}\n\n@Test\npublic void clinicalTrialAssociationTest() {\nsuper.clinicalTrialAssociationTest();\n}\n\n}\n</code></pre>\n\n<p>Which is failing with:</p>\n\n<blockquote>\n  <p>org.hibernate.HibernateException: No Session found for current thread\n    at\n  org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)\n    at\n  org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:881)</p>\n</blockquote>\n\n<p>I have 2 different session factories in my app: sessionFactory and auditFactory. Both are configured in spring (see [1]).</p>\n\n<p>The problem is that in an hibernate4 configuration <strong>the property exposeTransactionAwareSessionFactory was removed</strong>. I had that set to true for my auditFactory. I believe removing this property makes the injected auditFactory not being able to pick up the session in the transaction (as txManger is configured for sessionFactory), therefore yielding the error.</p>\n\n<p>Questions:</p>\n\n<ol>\n<li><strong>how can I make the auditFactory have transactions managed by spring on this test?</strong></li>\n<li><strong>Is that what was happening with the exposeTransactionAwareSessionFactory property in hibernate 3?</strong></li>\n</ol>\n\n<p>The only alternative I see is to wrap all the code that uses auditFactory in a Helper class annotated with @Transactional(otherTxManager). I did try that, but I got a couple of additional problems there:</p>\n\n<ol>\n<li>I needed to use a separate DataSource (else I'd get [2])</li>\n<li>Using 2 separate datasources I'll get a similar error on my Cucumber tests, now related with the transactionManager [3]</li>\n</ol>\n\n<p>[1] The relavant XML configuration:</p>\n\n<pre><code>&lt;bean id=\"txManager\"\nclass=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n&lt;property name=\"sessionFactory\" ref=\"sessionFactory\" /&gt;\n&lt;/bean&gt;\n\n&lt;tx:annotation-driven transaction-manager=\"txManager\" /&gt;\n\n        &lt;bean id=\"sessionFactory\" scope=\"singleton\"\nclass=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n&lt;property name=\"hibernateProperties\"&gt;\n&lt;props&gt;\n&lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;${hibernate.hbm2dll}&lt;/prop&gt;\n&lt;prop key=\"hibernate.hbm2ddl.import_files\"&gt;${hibernate.sql_scripts}&lt;/prop&gt;\n&lt;/props&gt;\n&lt;/property&gt;\n&lt;property name=\"packagesToScan\"&gt;...&lt;/property&gt;\n&lt;property name=\"annotatedPackages\"&gt;...&lt;/property&gt;\n&lt;property name=\"mappingLocations\"&gt;...&lt;/property&gt;\n\n&lt;property name=\"dataSource\" ref=\"c3p0DataSource\" /&gt;\n&lt;property name=\"entityInterceptor\" ref=\"auditInterceptor\" /&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"auditFactory\" scope=\"singleton\"\nclass=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n&lt;property name=\"exposeTransactionAwareSessionFactory\"&gt; --&gt;needs to be removed in hibernate4!\n&lt;value&gt;true&lt;/value&gt;\n&lt;/property&gt;\n&lt;property name=\"mappingLocations\"&gt;...&lt;/property&gt;\n&lt;property name=\"packagesToScan\"&gt;...&lt;/property&gt;\n&lt;property name=\"hibernateProperties\"&gt;\n&lt;props&gt;\n&lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;${hibernate.hbm2dll}&lt;/prop&gt;\n&lt;/props&gt;\n&lt;/property&gt;\n&lt;property name=\"dataSource\" ref=\"c3p0DataSource\" /&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p>[2] Problem with using the same dataSource for the two factories:</p>\n\n<blockquote>\n  <p>org.springframework.transaction.IllegalTransactionStateException: Pre-bound JDBC Connection found! HibernateTransactionManager does not support running within DataSourceTransactionManager if told to manage the DataSource itself. It is recommended to use a single HibernateTransactionManager for all transactions on a single DataSource, no matter whether Hibernate or JDBC access.\n      at org.springframework.orm.hibernate4.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:329)</p>\n</blockquote>\n\n<p>[3] Problem in cucumber tests due to declaring 2 transaction managers:</p>\n\n<blockquote>\n  <p>org.springframework.beans.factory.NoSuchBeanDefinitionException: No unique bean of type [org.springframework.transaction.PlatformTransactionManager] is defined: expected single bean but found 2: txAudit,txManager</p>\n</blockquote>\n"},{"tags":["java","hibernate","hql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2041,"score":1,"question_id":2312124,"title":"Query syntax error when bulk-deleting in Hibernate","body":"<p>I try to executer bulk delete using Hibernate HQL query, following <a href=\"http://docs.jboss.org/hibernate/stable/core/reference/en/html/batch.html#batch-direct\" rel=\"nofollow\">reference manunal</a> but I get a query syntax error. This line</p>\n\n<pre><code>final Query qry = getSession(false).createQuery(\" delete from NewCalendarDay\");\n</code></pre>\n\n<p>causes exception:</p>\n\n<blockquote>\n  <p>org.hibernate.QueryException: query must begin with SELECT or FROM: delete [ delete from pl.com.bms.avaro.staticData.model.NewCalendarDay ]</p>\n</blockquote>\n\n<p>Class in which the code is executed extends <code>org.springframework.orm.hibernate3.support.HibernateDaoSupport</code>, so <code>getSession()</code> method should return <code>org.hibernate.Session</code>.\nI use spring v. 2.5.5 and Hibernate v. 3.2.6.ga</p>\n\n<p>Should I configure something to be able to bulk-delete or what?</p>\n\n<p><strong>EDIT</strong><br>\nBozho asked for complete stack trace, so here it goes:</p>\n\n<pre><code>org.hibernate.QueryException: query must begin with SELECT or FROM: delete [ delete from pl.com.bms.avaro.staticData.model.NewCalendarDay ]\n    at org.hibernate.hql.classic.ClauseParser.token(ClauseParser.java:83)\n    at org.hibernate.hql.classic.PreprocessingParser.token(PreprocessingParser.java:108)\n    at org.hibernate.hql.classic.ParserHelper.parse(ParserHelper.java:28)\n    at org.hibernate.hql.classic.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:216)\n    at org.hibernate.hql.classic.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:185)\n    at org.hibernate.engine.query.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:77)\n    at org.hibernate.engine.query.HQLQueryPlan.&lt;init&gt;(HQLQueryPlan.java:56)\n    at org.hibernate.engine.query.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:72)\n    at org.hibernate.impl.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:133)\n    at org.hibernate.impl.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:112)\n    at org.hibernate.impl.SessionImpl.createQuery(SessionImpl.java:1623)\n    at pl.com.bms.avaro.staticData.dao.implementations.NewCalendarDayDaoImpl.deleteCalendarDaysForYear(NewCalendarDayDaoImpl.java:41)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:310)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:106)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)\n    at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:89)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)\n    at $Proxy43.deleteCalendarDaysForYear(Unknown Source)\n    at pl.com.bms.avaro.staticData.dao.tests.TestCalendarDayDaoImpl.testFindByDateCal(TestCalendarDayDaoImpl.java:60)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n    at java.lang.reflect.Method.invoke(Unknown Source)\n    at junit.framework.TestCase.runTest(TestCase.java:168)\n    at junit.framework.TestCase.runBare(TestCase.java:134)\n    at org.springframework.test.ConditionalTestCase.runBare(ConditionalTestCase.java:76)\n    at junit.framework.TestResult$1.protect(TestResult.java:110)\n    at junit.framework.TestResult.runProtected(TestResult.java:128)\n    at junit.framework.TestResult.run(TestResult.java:113)\n    at junit.framework.TestCase.run(TestCase.java:124)\n    at junit.framework.TestSuite.runTest(TestSuite.java:232)\n    at junit.framework.TestSuite.run(TestSuite.java:227)\n    at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:91)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:46)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\n</code></pre>\n"},{"tags":["java","hibernate","exception"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12823874,"title":"SOLVED - hibernate.objectdeletedexception","body":"<p>I was developing some code for a portal, and I encountered this problem:\nif an admin changes an item on the portal while an user is using it, when the user tries to save that item, the following instructions produces the Hibernate Exception:</p>\n\n<pre><code>ordineSpec.eliminaSpec(theOrdineDettaglio);  //this deletes the object ordineSpec from the object OrdineDettaglio\n</code></pre>\n\n<p>Now, ordineSpec is a children of OrdineDettaglio entity, with cascade set to \"all\". I did a lot of troubleshooting, and I tried several solutions such as:</p>\n\n<pre><code>theOrdineDettaglio.getTheOrdineArticoloValore().remove(ordineSpec);\n</code></pre>\n\n<p>but none of them worked, and the exception keeps presenting.</p>\n\n<p>Can someone help me? Thanks!</p>\n\n<p>Following, the stacktrace of the exception:</p>\n\n<p>Caused by: org.hibernate.ObjectDeletedException: deleted object would be re-saved by cascade (remove deleted object from associations): [it.mef.transazioni.entity.OrdineArticoloValore#OrdineArticoloValore{idOrdineAcquisto='32840',idProgressivoArticolo='0',idCopiaArticolo='20803716',idAttributo='1',valoreAttributo='ss',labelAttributo='MARCA',valoreBlob='null',contentType='null',nomeFile='null'}]\n    at org.hibernate.impl.SessionImpl.forceFlush(SessionImpl.java:1014)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:165)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:94)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:70)\n    at com.eds.adf.domainstore.listeners.SaveOrUpdateEventListener.onSaveOrUpdate(SaveOrUpdateEventListener.java:105)\n    at org.hibernate.impl.SessionImpl.fireSaveOrUpdate(SessionImpl.java:507)\n    at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:499)\n    at org.hibernate.engine.CascadingAction$1.cascade(CascadingAction.java:218)\n    at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:268)\n    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:216)\n    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)\n    at org.hibernate.engine.Cascade.cascadeCollectionElements(Cascade.java:296)\n    at org.hibernate.engine.Cascade.cascadeCollection(Cascade.java:242)\n    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:219)\n    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)\n    at org.hibernate.engine.Cascade.cascade(Cascade.java:130)\n    at org.hibernate.engine.Cascade.cascade(Cascade.java:97)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.cascadeOnUpdate(DefaultSaveOrUpdateEventListener.java:357)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performUpdate(DefaultSaveOrUpdateEventListener.java:329)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsDetached(DefaultSaveOrUpdateEventListener.java:223)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:89)\n    at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:70)\n    at com.eds.adf.domainstore.listeners.SaveOrUpdateEventListener.onSaveOrUpdate(SaveOrUpdateEventListener.java:105)\n    at org.hibernate.impl.SessionImpl.fireSaveOrUpdate(SessionImpl.java:507)\n    at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:499)\n    at org.hibernate.engine.CascadingAction$1.cascade(CascadingAction.java:218)\n    at org.hibernate.engine.Cascade.cascadeToOne(Cascade.java:268)\n    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:216)\n    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)\n    at org.hibernate.engine.Cascade.cascadeCollectionElements(Cascade.java:296)\n    at org.hibernate.engine.Cascade.cascadeCollection(Cascade.java:242)\n    at org.hibernate.engine.Cascade.cascadeAssociation(Cascade.java:219)\n    at org.hibernate.engine.Cascade.cascadeProperty(Cascade.java:169)\n    at org.hibernate.engine.Cascade.cascade(Cascade.java:130)\n    at org.hibernate.event.def.AbstractFlushingEventListener.cascadeOnFlush(AbstractFlushingEventListener.java:131)\n    at org.hibernate.event.def.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:122)\n    at org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:65)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:26)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)\n    at com.eds.adf.domainstore.dao.impl.DaoHbmGeneric.flushIfNecessary(DaoHbmGeneric.java:218)\n    at com.eds.adf.domainstore.dao.impl.DaoHbmGeneric.delete(DaoHbmGeneric.java:184)\n    at it.mef.transazioni.dataaccess.impl.DAOOrdineArticoloValoreImpl.delete(DAOOrdineArticoloValoreImpl.java:255)\n    at it.mef.transazioni.service.impl.OrdineArticoloValoreServiceImpl.deleteOrdineArticoloValore(OrdineArticoloValoreServiceImpl.java:355)\n    at it.mef.transazioni.service.impl.OrdineArticoloValoreServiceImpl.eliminaSpec(OrdineArticoloValoreServiceImpl.java:578)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:335)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:181)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:148)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:170)\n    at com.eds.adf.security.CheckServiceUserDetailsParameterInterceptor.invoke(CheckServiceUserDetailsParameterInterceptor.java:53)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:170)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:176)\n    at $Proxy746.eliminaSpec(Unknown Source)\n    at it.mef.transazioni.action.ManageOrdineAcquistoAction.aggiornaDettaglioOrdine(ManageOrdineAcquistoAction.java:6462)\n    at it.mef.transazioni.action.ManageOrdineAcquistoAction.manageOrdini(ManageOrdineAcquistoAction.java:2770)\n    at it.mef.transazioni.action.ManageOrdineAcquistoAction.salvaInBozza(ManageOrdineAcquistoAction.java:4527)\n    at it.mef.transazioni.action.ManageOrdineAcquistoAction$$FastClassByCGLIB$$89946dce.invoke()\n    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:149)\n    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:698)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:148)\n    at org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:51)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:170)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:170)\n    at org.acegisecurity.intercept.method.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:66)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:170)\n    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:643)\n    at it.mef.transazioni.action.ManageOrdineAcquistoAction$$EnhancerByCGLIB$$bf309c1b.salvaInBozza()</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":279,"score":0,"question_id":10203918,"title":"Hibernate org.hibernate.hql.ast.QuerySyntaxException error","body":"<p>I have seen a few questions about this but I am unable to derive a solution to my problem.</p>\n\n<p>I have the following <code>PositionHistory</code> entity declared...</p>\n\n<pre><code>@Entity\n@Table(name = \"position_history\")\n@Cache (usage=CacheConcurrencyStrategy.READ_WRITE)\n@AttributeOverride (name=\"id\", column = @Column(name=PositionHistory.PRIMARY_KEY))\npublic class PositionHistory extends AbstractPersistable {\n\n    public static final String PRIMARY_KEY = \"s_posn_history_id\";\n    public static final String KEY = \"positionHistory\";\n    public static final String KEY_DATE = \"date\";\n    public static final String KEY_COMMENT = \"comment\";\n\n    // String field length definitions\n    public static final int LENGTH_COMMENTS = 1000;\n\n    // Instance Variables\n    private Date date;\n    private String comment;\n\n    @Column(name = \"d_date\", nullable = false)\n    public Date getDate() {\n    return date;\n    }\n\n    public void setDate(Date date) {\n    this.date = date;\n    }\n\n    @Column(name = \"t_comment\", length = LENGTH_COMMENTS)\n    public String getComment() {\n    return comment;\n    }\n\n    public void setComment(String comment) {\n    this.comment = comment;\n    }\n\n    // hashCode()\n    // equals()\n    // toString()\n}\n</code></pre>\n\n<p>And in the <code>PositionHistoryDaoImp</code> I am trying to delete some rows...</p>\n\n<pre><code>public void deletePositionHistory(Long positionId) {\n    getSession().createQuery(\"delete from position_history a where a.position_id=:id\")\n        .setParameter(\"id\", positionId).executeUpdate();\n}\n</code></pre>\n\n<p>When I call <code>deletePositionHistory</code> I get the following error...</p>\n\n<pre><code>ERROR a.g.q.d.v.s.c.CommandProcessorImpl:75 - org.hibernate.hql.ast.QuerySyntaxException: position_history is not mapped \n</code></pre>\n\n<p>As you can see, the table is already mapped in the <code>PositionHisotry</code> Entity and the <code>PositionHistoryDaoImp</code> extends the entity.</p>\n\n<p>What am I missing or doing wrong? </p>\n\n<p>Your help is very much appreciated.</p>\n\n<p>Thank you.</p>\n\n<hr>\n\n<p><code>Position</code> Entity...</p>\n\n<pre><code>@Entity\n@Table(name = \"position\")\n@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)\n@AttributeOverride(name = \"id\", column = @Column(name = Position.PRIMARY_KEY))\npublic class Position extends AbstractPersistableEffective {\n    ...\n    public static final String PRIMARY_KEY = \"s_posn_id\";\n    public static final String KEY_ID = \"positionId\";\n    private List&lt;PositionHistory&gt; history = new ArrayList&lt;PositionHistory&gt;();\n\n    ...\n\n    @OneToMany(fetch = FetchType.LAZY)\n    @Cascade({CascadeType.ALL, CascadeType.DELETE_ORPHAN})\n    @JoinColumn(name = Position.PRIMARY_KEY)\n    @IndexColumn(name = AbstractPersistable.INDEX_COLUMN)\n    public List&lt;PositionHistory&gt; getHistory() {\n        return history;\n    }\n\n    public void setHistory(List&lt;PositionHistory&gt; history) {\n        this.history = history;\n    }\n}\n</code></pre>\n"},{"tags":["hibernate","criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12834268,"title":"Hibernate criteria : the origin class","body":"<p>I was wondering if there was a way to get the name of the class that was used to create the criteria.</p>\n\n<p>Example :</p>\n\n<pre><code>Criteria c = session.createCriteria(MyClasse.class)\n</code></pre>\n\n<p>So I would like to know, when I have the criteria c, that MyClasse was used to make it</p>\n\n<p>thank you</p>\n"},{"tags":["hibernate","jboss","seam","stack-trace"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":260,"score":0,"question_id":11304416,"title":"Error using hibernate in seam 2.2.2 in Jboss as 7.1.1","body":"<p>Please I deployed my seam2.2.2 Application to Jboss As 7.1.1.  The app deployed successfully. But when I try to use a database resource in the app. I get the following Error in the stack trace Below</p>\n\n<pre><code>04:57:48,722 WARN  [org.jboss.seam.security.jaas.SeamLoginModule] (http--127.0.0.1-           8080-2) Error invoking login method: org.jboss.seam.InstantiationException: Could not     instantiate Seam component: authenti\ncator\n            at org.jboss.seam.Component.newInstance(Component.java:2170) [jboss-seam.jar:2.2.2.Final]\n            at org.jboss.seam.Component.getInstance(Component.java:2024) [jboss-seam.jar:2.2.2.Final]\n                    at org.jboss.seam.Component.getInstance(Component.java:1986) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.getInstance(Component.java:1980) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Namespace.getComponentInstance(Namespace.java:55) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Namespace.getComponentInstance(Namespace.java:50) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.el.SeamELResolver.resolveBase(SeamELResolver.java:148) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.el.SeamELResolver.getValue(SeamELResolver.java:51) [jboss-seam.jar:2.2.2.Final]\n        at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:173) [jsf-impl-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:200) [jsf-impl-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at org.jboss.el.parser.AstIdentifier.getValue(AstIdentifier.java:44) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.parser.AstValue.getTarget(AstValue.java:34) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.parser.AstValue.invoke(AstValue.java:95) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:276) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.seam.core.Expressions$2.invoke(Expressions.java:221) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.security.jaas.SeamLoginModule.login(SeamLoginModule.java:109) [jboss-seam.jar:2.2.2.Final]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_04]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) [rt.jar:1.7.0_04]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.7.0_04]\n        at java.lang.reflect.Method.invoke(Method.java:601) [rt.jar:1.7.0_04]\n        at javax.security.auth.login.LoginContext.invoke(LoginContext.java:784) [rt.jar:1.7.0_04]\n        at javax.security.auth.login.LoginContext.access$000(LoginContext.java:203) [rt.jar:1.7.0_04]\n        at javax.security.auth.login.LoginContext$5.run(LoginContext.java:721) [rt.jar:1.7.0_04]\n        at javax.security.auth.login.LoginContext$5.run(LoginContext.java:719) [rt.jar:1.7.0_04]\n        at java.security.AccessController.doPrivileged(Native Method) [rt.jar:1.7.0_04]\n        at javax.security.auth.login.LoginContext.invokeCreatorPriv(LoginContext.java:718) [rt.jar:1.7.0_04]\n        at javax.security.auth.login.LoginContext.login(LoginContext.java:590) [rt.jar:1.7.0_04]\n        at org.jboss.seam.security.Identity.authenticate(Identity.java:344) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.security.Identity.authenticate(Identity.java:332) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.security.Identity.login(Identity.java:259) [jboss-seam.jar:2.2.2.Final]\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_04]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) [rt.jar:1.7.0_04]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.7.0_04]\n        at java.lang.reflect.Method.invoke(Method.java:601) [rt.jar:1.7.0_04]\n        at org.jboss.el.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:335) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.util.ReflectionUtil.invokeMethod(ReflectionUtil.java:348) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.parser.AstPropertySuffix.invoke(AstPropertySuffix.java:58) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.parser.AstValue.invoke(AstValue.java:96) [jboss-el.jar:1.0_02.CR5]\n        at org.jboss.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:276) [jboss-el.jar:1.0_02.CR5]\n        at com.sun.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:68) [jsf-facelets.jar:1.1.15.B1]\n        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88) [jsf-api-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102) [jsf-impl-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at javax.faces.component.UICommand.broadcast(UICommand.java:387) [jsf-api-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at org.ajax4jsf.component.AjaxViewRoot.processEvents(AjaxViewRoot.java:329) [richfaces-impl.jar:3.3.3.Final]\n        at org.ajax4jsf.component.AjaxViewRoot.broadcastEventsForPhase(AjaxViewRoot.java:304) [richfaces-impl.jar:3.3.3.Final]\n        at org.ajax4jsf.component.AjaxViewRoot.processPhase(AjaxViewRoot.java:261) [richfaces-impl.jar:3.3.3.Final]\n        at org.ajax4jsf.component.AjaxViewRoot.processApplication(AjaxViewRoot.java:474) [richfaces-impl.jar:3.3.3.Final]\n        at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:82) [jsf-impl-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:100) [jsf-impl-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118) [jsf-impl-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:265) [jsf-api-1.2_15-jbossorg-2.jar:1.2_15.jbossorg-1-20111019-SNAPSHOT]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:83) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.web.IdentityFilter.doFilter(IdentityFilter.java:40) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.web.MultipartFilter.doFilter(MultipartFilter.java:90) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.web.ExceptionFilter.doFilter(ExceptionFilter.java:64) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.web.RedirectFilter.doFilter(RedirectFilter.java:45) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:206) [richfaces-impl.jar:3.3.3.Final]\n        at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290) [richfaces-impl.jar:3.3.3.Final]\n        at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:388) [richfaces-impl.jar:3.3.3.Final]\n        at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:515) [richfaces-impl.jar:3.3.3.Final]\n        at org.jboss.seam.web.Ajax4jsfFilter.doFilter(Ajax4jsfFilter.java:56) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.web.LoggingFilter.doFilter(LoggingFilter.java:60) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.web.HotDeployFilter.doFilter(HotDeployFilter.java:53) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter$FilterChainImpl.doFilter(SeamFilter.java:69) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.servlet.SeamFilter.doFilter(SeamFilter.java:158) [jboss-seam.jar:2.2.2.Final]\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:280) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:397) [jbossweb-7.0.13.Final.jar:]\n        at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50) [jboss-as-jpa-7.1.1.Final.jar:7.1.1.Final]\n        at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]\n        at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_04]\nCaused by: java.lang.RuntimeException: exception invoking: getSession\n        at org.jboss.seam.util.Reflections.invokeAndWrap(Reflections.java:154) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.callComponentMethod(Component.java:2275) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.unwrap(Component.java:2301) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.getInstance(Component.java:2044) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.getInstance(Component.java:1986) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.getInstance(Component.java:1980) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.getInstanceInAllNamespaces(Component.java:2375) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.getValueToInject(Component.java:2327) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.injectAttributes(Component.java:1739) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.inject(Component.java:1557) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.core.BijectionInterceptor.aroundInvoke(BijectionInterceptor.java:61) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:68) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.core.MethodContextInterceptor.aroundInvoke(MethodContextInterceptor.java:44) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.intercept.SeamInvocationContext.proceed(SeamInvocationContext.java:68) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.intercept.RootInterceptor.invoke(RootInterceptor.java:107) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.intercept.JavaBeanInterceptor.interceptInvocation(JavaBeanInterceptor.java:185) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.intercept.JavaBeanInterceptor.invoke(JavaBeanInterceptor.java:103) [jboss-seam.jar:2.2.2.Final]\n        at org.domain.lifeplus1.session.Authenticator_$$_javassist_seam_5.init(Authenticator_$$_javassist_seam_5.java)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_04]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) [rt.jar:1.7.0_04]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.7.0_04]\n        at java.lang.reflect.Method.invoke(Method.java:601) [rt.jar:1.7.0_04]\n        at org.jboss.seam.util.Reflections.invoke(Reflections.java:22) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.util.Reflections.invokeAndWrap(Reflections.java:144) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.callComponentMethod(Component.java:2275) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.callCreateMethod(Component.java:2198) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.Component.newInstance(Component.java:2158) [jboss-seam.jar:2.2.2.Final]\n        ... 87 more\nCaused by: java.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_04]\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) [rt.jar:1.7.0_04]\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.7.0_04]\n        at java.lang.reflect.Method.invoke(Method.java:601) [rt.jar:1.7.0_04]\n        at org.jboss.seam.util.Reflections.invoke(Reflections.java:22) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.util.Reflections.invokeAndWrap(Reflections.java:144) [jboss-seam.jar:2.2.2.Final]\n        ... 113 more\nCaused by: java.lang.NoSuchMethodError: org.hibernate.SessionFactory.openSession()Lorg/hibernate/classic/Session;\n        at org.jboss.seam.persistence.ManagedHibernateSession.initSession(ManagedHibernateSession.java:82) [jboss-seam.jar:2.2.2.Final]\n        at org.jboss.seam.persistence.ManagedHibernateSession.getSession(ManagedHibernateSession.java:118) [jboss-seam.jar:2.2.2.Final]\n        ... 119 more\n</code></pre>\n\n<p>Please is there something I am doing wrong??</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12834172,"title":"unable to store data into child table through parent table in hibernate one to many Bi-directional Process","body":"<p>I am trying to store the data into EMPLOYEE(child) table through DEPARTMENT(parent) table and dispaly it using the hibernate one to many bi-directional process.</p>\n\n<p>After the transaction i am able to diaply the data in employee including the data what i want to enter but i am not able to see that data in database(POSTGRES). Please help us and thanks in advance.</p>\n\n<p>I have to two tables Department(Parent) and employee(child refferring dep_id in department).</p>\n\n<pre><code>CREATE TABLE department\n(\ndepartment_id character varying(10) NOT NULL,\ndepartment_name character varying(20),\nCONSTRAINT \"pk_departmentId\" PRIMARY KEY (department_id)\n) \n\nCREATE TABLE employee\n(\nemp_id character varying(10) NOT NULL,\nemp_name character varying(20),\ndepartment_id character varying(10),\nCONSTRAINT \"pk_empId\" PRIMARY KEY (emp_id),\nCONSTRAINT \"fk_empDept\" FOREIGN KEY (department_id) REFERENCES department (department_id) MATCH SIMPLE ON UPDATE NO ACTION ON DELETE NO ACTION\n)\n</code></pre>\n\n<p>The respective hbm files are:</p>\n\n<p><strong>*<em>DEPARTMENT</em>*</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Oct 9, 2012 3:01:23 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"tablebeans.Department\" table=\"department\" schema=\"public\"&gt;\n        &lt;id name=\"departmentId\" type=\"string\"&gt;\n            &lt;column name=\"department_id\" length=\"10\" /&gt;\n            &lt;generator class=\"assigned\" /&gt;\n        &lt;/id&gt;\n        &lt;property name=\"departmentName\" type=\"string\"&gt;\n            &lt;column name=\"department_name\" length=\"20\" /&gt;\n        &lt;/property&gt;\n        &lt;set name=\"employees\" table=\"employee\" inverse=\"true\" lazy=\"true\" fetch=\"select\"&gt;\n            &lt;key&gt;\n                &lt;column name=\"department_id\" length=\"10\" /&gt;\n            &lt;/key&gt;\n            &lt;one-to-many class=\"tablebeans.Employee\" /&gt;\n        &lt;/set&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>*<strong><em>EMPLOYEE</em>*</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- Generated Oct 9, 2012 3:01:23 PM by Hibernate Tools 3.2.1.GA --&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"tablebeans.Employee\" table=\"employee\" schema=\"public\"&gt;\n        &lt;id name=\"empId\" type=\"string\"&gt;\n            &lt;column name=\"emp_id\" length=\"10\" /&gt;\n            &lt;generator class=\"assigned\" /&gt;\n        &lt;/id&gt;\n        &lt;many-to-one name=\"department\" class=\"tablebeans.Department\" fetch=\"select\"&gt;\n            &lt;column name=\"department_id\" length=\"10\" /&gt;\n        &lt;/many-to-one&gt;\n        &lt;property name=\"empName\" type=\"string\"&gt;\n            &lt;column name=\"emp_name\" length=\"20\" /&gt;\n        &lt;/property&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>The POJO classes are :</p>\n\n<pre><code>package tablebeans;\n// Generated Oct 9, 2012 3:01:23 PM by Hibernate Tools 3.2.1.GA\n\n\n\n\nimport java.util.HashSet;\nimport java.util.Set;\n\n/**\n * Department generated by hbm2java\n */\npublic class Department  implements java.io.Serializable {\n\n     private String departmentId;\n     private String departmentName;\n     private Set employees = new HashSet(0);\n\n    public Department() {\n    }\n\n    public Department(String departmentId) {\n        this.departmentId = departmentId;\n    }\n    public Department(String departmentId, String departmentName, Set employees) {\n       this.departmentId = departmentId;\n       this.departmentName = departmentName;\n       this.employees = employees;\n    }\n\n    public String getDepartmentId() {\n        return this.departmentId;\n    }\n\n    public void setDepartmentId(String departmentId) {\n        this.departmentId = departmentId;\n    }\n    public String getDepartmentName() {\n        return this.departmentName;\n    }\n\n    public void setDepartmentName(String departmentName) {\n        this.departmentName = departmentName;\n    }\n    public Set getEmployees() {\n        return this.employees;\n    }\n\n    public void setEmployees(Set employees) {\n        this.employees = employees;\n    }\n}\n\n\npackage tablebeans;\n// Generated Oct 9, 2012 3:01:23 PM by Hibernate Tools 3.2.1.GA\n\n\n\n\n\n/**\n * Employee generated by hbm2java\n */\npublic class Employee  implements java.io.Serializable {\n\n     private String empId;\n     private Department department;\n     private String empName;\n\n    public Employee() {\n    }\n\n    public Employee(String empId) {\n        this.empId = empId;\n    }\n    public Employee(String empId, Department department, String empName) {\n       this.empId = empId;\n       this.department = department;\n       this.empName = empName;\n    }\n\n    public String getEmpId() {\n        return this.empId;\n    }\n\n    public void setEmpId(String empId) {\n        this.empId = empId;\n    }\n    public Department getDepartment() {\n        return this.department;\n    }\n\n    public void setDepartment(Department department) {\n        this.department = department;\n    }\n    public String getEmpName() {\n        return this.empName;\n    }\n\n    public void setEmpName(String empName) {\n        this.empName = empName;\n    }\n}\n</code></pre>\n\n<p>And the code from which i am trying to store the data into the EMPLOYEE table through DEPARTMENT table and displaying it.  </p>\n\n<pre><code> tx = session.beginTransaction();\n\n            Department department=new Department();\n            department.setDepartmentId(\"5\");\n            department.setDepartmentName(\"Nielson\");\n\n            Employee employee = new Employee();\n            employee.setEmpId(\"4\");\n            employee.setEmpName(\"phani\");\n            employee.setDepartment(department);\n\n            Set empset = new HashSet();\n            empset.add(employee);\n            department.setEmployees(empset);\n\n            session.save(department);\n            tx.commit();\n\n            //Query query = session.createQuery(\"insert into Department(departmentId,departmentName)\"+\"select departmentId,departmentName from Employee where departmentId = 5\");\n            //int update = query.executeUpdate();\n\n            Query query1=session.createQuery(\"from Department\");\n            List list1=query1.list();\n            for(int i=0;i&lt;list1.size();i++)\n               {\n                System.out.println(\"In for\");\n                Department department1 =(Department) list1.get(i);\n                System.out.println(\"the ID is \"+department1.getDepartmentId());\n                System.out.println(\"the dept name is \"+department1.getDepartmentName());\n                Set st = (Set) department1.getEmployees();\n                Iterator ite = st.iterator();\n                while(ite.hasNext())\n                {\n                    employee = (Employee) ite.next();\n                    System.out.println(\"the emp name is \"+employee.getEmpName());\n                }\n\n              }\n</code></pre>\n\n<p>Here i am able to display the newly entered record into the employee table but that data is not resembling in the database table. I am using the Postgres.</p>\n"},{"tags":["java","mysql","spring","hibernate","multi-tenant"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":12834469,"title":"Connecting two datasources to the same database","body":"<p>I am working on an application where we have decided to go for a multi-tenant architecture using <a href=\"http://blog.springsource.com/2007/01/23/dynamic-datasource-routing/\" rel=\"nofollow\">the solution provided by Spring</a>, so we route the data to each datasource depending on the value of a parameter. Let's say this parameter is a number from 1 to 10, depending on our clients id.</p>\n\n<p>However, this requires altering the application-context each time we add a new datasource, so to start we have thought on the following solution:</p>\n\n<ul>\n<li>Start with 10 datasources (or more) pointing to different IPs and the same schema, but in the end all routed to the same physical database. No matter the datasource we use, the data will be sent to the same schema in this first scenario.</li>\n<li>The data would be in the same schema, so the same table would be shared among datasources, but each row would only be visible to each datasource (using a fixed where clause in every CRUD operation)</li>\n<li>When we have performance problems, we will create another database, migrate some clients to the new schema, and reroute the IP of one of the datasources to the new database, so this new database gets part of the load of the old one</li>\n</ul>\n\n<p>Are there any drawbacks with this approach? I am concerned about:</p>\n\n<ul>\n<li>ACID properties lost</li>\n<li>Problems with hibernate sessionFactory and second level cache</li>\n<li>Table locking issues</li>\n</ul>\n\n<p>We are using Spring 3.1, Hibernate 4.1 and MySQL 5.5</p>\n"},{"tags":["java","hibernate","spring","javassist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":914,"score":0,"question_id":8412334,"title":"Getting Javassist types instead of actual Hibernate entity types","body":"<p>I have stumbled upon a really annoying situation: I am using Hibernate &amp; Spring as backend for my app and it seems that in some cases, the entities that are in a relationship with a particular entity are not fetched as normal entity objects from the DB, but as Javassist types. E.g.:</p>\n\n<p>I have the Campaign entity with the following relationships:</p>\n\n<pre><code>@Entity\n@Table(name = \"campaign\")\npublic class Campaign implements Serializable {\n  [..]\n  @ManyToMany(fetch = FetchType.LAZY)\n  @JoinTable(uniqueConstraints = @UniqueConstraint(columnNames = {\n        \"campaign_id\", \"dealer_id\" }), name = \"campaign_has_dealer\", joinColumns = { @JoinColumn(name = \"campaign_id\", nullable = false) }, inverseJoinColumns = { @JoinColumn(name = \"dealer_id\", nullable = false) })\n  private List&lt;Dealer&gt; dealers = new ArrayList&lt;Dealer&gt;();\n\n@ManyToMany\n// (fetch = FetchType.LAZY)\n@JoinTable(uniqueConstraints = @UniqueConstraint(columnNames = {\n        \"campaign_id\", \"sales_area_id\" }), name = \"campaign_has_sales_area\", joinColumns = { @JoinColumn(name = \"campaign_id\", nullable = false) }, inverseJoinColumns = { @JoinColumn(name = \"sales_area_id\", nullable = false) })\nprivate List&lt;SalesArea&gt; salesAreas = new ArrayList&lt;SalesArea&gt;();\n}\n</code></pre>\n\n<p>Upon retrieving the salesAreas connected to this Campaign, I get a list of SalesArea_$$_javassist_56, while for the dealers, I get normal Hibernate entities. Since the client part is based on GWT, we use RequestFactory for retrieving stuff. I initially thought it was a problem with the proxies, locators and so on but I have set a breakpoint in the service where these are retrieved and they are Javassist objects directly after selecting them. It seems that even removing the FetchType.LAZY annotation (although definitely not a desirable solution), the same thing happens. This happened also with other types of relationships, not only @ManyToMany.</p>\n\n<p>We are using GWT 2.3, Spring 3, Hibernate 3.6.3 and JPA 2.0 for annotations. </p>\n\n<p>Any suggestions would be appreciated. </p>\n\n<p>Thanks in advance</p>\n"},{"tags":["java","mysql","hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":295,"score":-1,"question_id":10944733,"title":"How to solve \"org.hibernate.QueryException: Not all named parameters have been set\" error?","body":"<p>I am using java-hibernate-mysql combination</p>\n\n<p>When i m doing update query i m getting following error. I don't understand what is wrong with hibernate. \nFollowing i have posted the error which i m getting :</p>\n\n<pre><code>org.hibernate.QueryException: Not all named parameters have been set: [0] [update       sequence s set s.cmd_output='neox     tty1         2012-06-08 09:40 (:0)\nneox     pts/1        2012-06-08 09:41 (:0)\nneox     pts/0        2012-06-08 09:41 (:0)\nneox     pts/2        2012-06-08 09:41 (:0)\nneox     pts/3        2012-06-08 12:48 (deval-PC.local.lan)\n[neox@localhost ~]$ ', s.cmd_output_time='2012-06-08 12:48:58' where s.id=43]\nat org.hibernate.impl.AbstractQueryImpl.verifyParameters(AbstractQueryImpl.java:106)\nat org.hibernate.impl.QueryImpl.executeUpate(QueryImpl.java:85)\nat db_model.sequence_db.insert_Sequence_new(sequence_db.java:242)\nat views.CaptureNavigationView$10.widgetSelected(CaptureNavigationView.java:555)\nat org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:240)\nat org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)\nat org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)\nat org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4165)\nat org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3754)\nat org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2696)\nat org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2660)\nat org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2494)\nat org.eclipse.ui.internal.Workbench$7.run(Workbench.java:674)\nat org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)\nat org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:667)\nat org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)\nat nspl.test.ui.Application.start(Application.java:43)\nat org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)\nat    org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLaunch    er.java:110)\nat     org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)\nat org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)\nat org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)\nat org.eclipse.equinox.launcher.Main.run(Main.java:1410)\nat org.eclipse.equinox.launcher.Main.main(Main.java:1386)\n</code></pre>\n\n<p>Can anybody tell me why i m getting this error?</p>\n"},{"tags":["sql","sql-server","hibernate","jdbc"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":5254,"score":3,"question_id":452238,"title":"Hiberate problems, jdbc IDENTITY_INSERT is set to OFF","body":"<p>I am getting JDBC error when I attempt a commit through hibernate to SQL Server</p>\n\n<blockquote>\n  <p>Cannot insert explicit value for identity column in table 'Report' when IDENTITY_INSERT is set to OFF</p>\n</blockquote>\n\n<p>I am using mappings generated by netbeans that contain,</p>\n\n<pre><code>&lt;class name=\"orm.generated.Report\" table=\"Report\" schema=\"dbo\" catalog=\"DatabaseName\"&gt;\n    &lt;id name=\"id\" type=\"int\"&gt;\n        &lt;column name=\"ID\" /&gt;\n        &lt;generator class=\"assigned\" /&gt;\n    &lt;/id&gt;\n</code></pre>\n\n<p>Which looks to me like it should be doing the identity insert properly.</p>\n\n<p>Any idea on how to fix this?</p>\n\n<p>EDIT:<br/>\nSome links to documentation, for posterity,<br/>\n<a href=\"http://www.hibernate.org/hib_docs/v3/reference/en-US/html/mapping.html#mapping-declaration-id-generator\" rel=\"nofollow\">http://www.hibernate.org/hib_docs/v3/reference/en-US/html/mapping.html#mapping-declaration-id-generator</a><br/>\n<a href=\"http://www.roseindia.net/hibernate/hibernateidgeneratorelement.shtml\" rel=\"nofollow\">http://www.roseindia.net/hibernate/hibernateidgeneratorelement.shtml</a></p>\n"},{"tags":["hibernate","spring","jpa","wicket"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1503,"score":5,"question_id":2085613,"title":"How to get rid of LazyInitializationException with Wicket JPA/Hibernate integration (with Spring)","body":"<p>i'm developing an application using Wicket as the view layer and JPA(Hibernate) as ORM. building the UI has been fun (even with ajax) using Wicket. My problem comes from integrating the persistent objects on edit pages (readonly pages are no problem using a LoadadableDetachableModel).</p>\n\n<p>I'm using the OSIV filter from spring to provide an open session for the view. But, as i keep the domain objects (the @Entity mapped classes) in the edit pages, i get the dreaded Lazy loading excetion when i access properties of them in ajax callbacks.</p>\n\n<p>i don't really want to go down the DTO / VO road, as i think it would only bloat the code and requires me to write lots of boiler-plate code.</p>\n\n<p>One idea was to use the model objects in the view, merge the passed in object with the current hibernate session and access all getters to fully initialize the object. after this, the object would be stored in the view (seesion) and become detached. Upon save, i would re-merge it and commit the change.</p>\n\n<p>Would this be an recommended way? Are there better solutions? Strange enough, most books / blogs / howtos completely ignore such issue. </p>\n\n<p>What transaction management would you suggest? Right now i use @Transaction at the service layer. How would that change if i use other ways of accessing storing the data across hibernate sessions?</p>\n\n<p>Any pointers / Links are welcomed as i'm kind of lost here.. </p>\n\n<p>thanks in advance</p>\n"},{"tags":["spring","hibernate","maven","wicket","maven-archetype"],"answer_count":1,"favorite_count":4,"up_vote_count":2,"down_vote_count":0,"view_count":150,"score":2,"question_id":12665532,"title":"wicket spring hibernate getting started","body":"<p>I am looking for an archtype to create a Maven project based on </p>\n\n<ul>\n<li>Wicket 6.0.0</li>\n<li>Spring 3.2</li>\n<li>Hibernate 4 (annotation based)</li>\n</ul>\n\n<p>All the examples I have seen (I have been looking for the last 4 hr) are with different versions and when I have tried to change versions step by step after the 4th bug I start using another archetype cause the time spent was significant.</p>\n\n<p>If anyone got a base \"getting stated \" project using the last I would like you to show me how to do it please.</p>\n"},{"tags":["java","hibernate","maven-2","persistence","jpa-2.0"],"answer_count":1,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":11102,"score":8,"question_id":3905738,"title":"How to get Hibernate + javax.persistence via Maven2 pom.xml","body":"<p>I am a newbie with Maven2 and I write a pom.xml.\nNow I want to get Hibernate and javax.persistence to resolve this:</p>\n\n<pre><code>import javax.persistence.Entity;\n...\nimport org.hibernate.annotations.Fetch;\n...\n</code></pre>\n\n<p>What needed to be done? I wrote in my pom.xml:</p>\n\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.hibernate&lt;/groupId&gt;\n    &lt;artifactId&gt;hibernate&lt;/artifactId&gt;\n    &lt;version&gt;3.5.6-Final&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n\n<p>But I get an error (I already get some other dependencies, but Hibernate does not work):</p>\n\n<pre><code>11.10.10 13:19:53 MESZ: Refreshing [/testProject/pom.xml]\n11.10.10 13:19:54 MESZ: Missing artifact org.hibernate:hibernate:jar:3.5.6-Final:compile\n11.10.10 13:19:54 MESZ: Maven Builder: AUTO_BUILD \n11.10.10 13:19:55 MESZ: Maven Builder: AUTO_BUILD\n</code></pre>\n\n<p>So, what's wrong here? Why it does not know the artifact?</p>\n\n<p>Thank you in advance &amp; Best Regards.</p>\n"},{"tags":["eclipse","oracle","hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12832163,"title":"Eclipse -hibernate plugin for generating oracle-table","body":"<p>i have been working on the  eclipse project that use hibernate and oracle for the database. And this project have some domain objects as below :\nMy question is : which tool do they use to generate the domain object code like below? :\nThanks.</p>\n\n<pre><code>**@IdClass(com.*********.domain.ApplicationPermission.class)\n@Entity\n@NamedQueries({\n        @NamedQuery(name = \"findAllApplication*****\", query = \"select myApplication***** from Application****** myApplicationPermission\"),\n        @NamedQuery(name = \"findApplication****ByApplicationId\", query = \"select myApplication***** from Application***** myApplication***** where myApplicationPermission.applicationId = ?1\"),) })\n@Table(schema = \"*****\", name = \"APPLICATION_PERMISSION\")\n@XmlAccessorType(XmlAccessType.FIELD)\n@XmlType(namespace = \"****/com/*****/cas/*****/domain\", name = \"ApplicationPermission\")\npublic class ApplicationPermission implements Serializable {\n    private static final long serialVersionUID = 1L;\n    /**\n     */\n    @Column(name = \"APPLICATION_ID\", scale = 2, nullable = false)\n    @Basic(fetch = FetchType.EAGER)\n    @Id\n    @XmlElement\n    BigDecimal applicationId;\n    /**\n     */\n    @Column(name = \"PERMISSION_GROUP_ID\", scale = 2, nullable = false)\n    @Basic(fetch = FetchType.EAGER) \n    @XmlElement\n    BigDecimal permissionGroupId;\n    /**\n     */**\n</code></pre>\n"},{"tags":["java","hibernate","seam","informix","java-ee-5"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":329,"score":1,"question_id":2873352,"title":"Generated queries contain schema and catalog name","body":"<p>I've the same problem as described <a href=\"https://forum.hibernate.org/viewtopic.php?f=1&amp;t=997341&amp;start=0\" rel=\"nofollow\">here</a></p>\n\n<p>In the generated SQL Informix expects <code>catalog:schema.table</code> but what's actually generated is</p>\n\n<pre><code>catalog.schema.table\n</code></pre>\n\n<p>which leads to a syntax error.\nSetting:</p>\n\n<pre><code>hibernate.default_catalog=\nhibernate.default_schema=\n</code></pre>\n\n<p>had no effect. \nI even removed schema and catalog from the table annotation, this caused a different issues : the query looked like that <code>..table</code> same for setting catalog and schema to an empty string.</p>\n\n<p>Versions </p>\n\n<ul>\n<li>seam 2.1.2 </li>\n<li>Hibernate Annotations 3.3.1.GA.CP01</li>\n<li>Hibernate 3.2.4.sp1.cp08</li>\n<li>Hibernate EntityManager 3.3.2.GAhibernate </li>\n<li>Jboss 4.3 (similar to 4.2.3)</li>\n</ul>\n"},{"tags":["oracle","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":247,"score":0,"question_id":10902381,"title":"Hibernate configuration for oracle issue :ORA-12516, TNS:listener could not find available handler with matching","body":"<p>I set the connection pool, changed the job processes for oracle. But still getting this error :\nORA-12516, TNS:listener could not find available handler with matching protocol stack\nThe Connection descriptor used by the client was</p>\n\n<p>Is there any specific configuration other than connection pool or oracle job process setting that needs to be done for resolving this error</p>\n"},{"tags":["java","sql","hibernate","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12830288,"title":"Updating data in subquery","body":"<p>I have two tables:</p>\n\n<ul>\n<li><code>PERSON</code> with columns <code>person_id</code> and <code>total</code></li>\n<li><code>DATA</code> with columns <code>data_a</code>, <code>data_b</code>, <code>data_c</code>, and <code>data_person_id</code></li>\n</ul>\n\n<p>Each \"person\" can have zero or more entries in <code>DATA</code> - your standard one-to-many relationship. <code>PERSON</code> has a <code>total</code> column that is the sum of values in <code>DATA</code>. There are currently some discrepancies between <code>total</code> and the actual entries in <code>DATA</code> where <code>DATA</code> is correct but <code>total</code> is wrong.</p>\n\n<p>This is the query I'm using to find the discrepancies:</p>\n\n<pre><code>SELECT\n  person_id\nFROM PERSON JOIN (\n  SELECT\n    data_person_id,\n    SUM( data_a + data_b + data_c ) as data_total\n  FROM\n    DATA\n  GROUP BY\n    data_person_id\n  ) x ON data_person_id = person_id\nWHERE\n  person_total != data_total\n</code></pre>\n\n<p>I plan on doing this through Hibernate as a query where the backend will be Postgres 9.x.</p>\n\n<p>The incorrect query that I'm trying to understand/fix is:</p>\n\n<pre><code>UPDATE\n  ONLY PERSON\nSET\n  total = data_info.calc_total\nFROM (\n  SELECT\n    SUM( data_a + data_b + data_c ) as calc_total\n  FROM\n    DATA\n  WHERE\n    DATA.data_person_id = person_id\n  GROUP BY\n    DATA.data_person_id\n) as data_info\nWHERE\n  PERSON.person_id IN (\n    SELECT\n      data_person_id\n    FROM PERSON JOIN (\n      SELECT\n        data_person_id,\n        SUM( data_a + data_b + data_c ) as data_total\n      FROM\n        DATA\n      GROUP BY\n        data_person_id\n      ) x ON person_id = data_person_id\n    WHERE\n      total != data_total\n  )\n</code></pre>\n\n<p>Right now, it won't run because of <code>WHERE DATA.data_person_id = person_id</code>. But if I take that out, the wrong values get used.</p>\n\n<p>The following seems to work but I'm confused as to why:</p>\n\n<pre><code>UPDATE\n  ONLY PERSON\nSET\n  total = data_info.calc_total\nFROM \n  PERSON P JOIN (\n    SELECT\n      data_person_id,\n      SUM( data_a + data_b + data_c ) as calc_total\n    FROM\n      DATA\n    WHERE\n      DATA.data_person_id = person_id\n    GROUP BY\n      DATA.data_person_id\n  ) as data_info ON P.person_id = data_person_id\nWHERE\n  PERSON.person_id IN (\n    SELECT\n      data_person_id\n    FROM PERSON JOIN (\n      SELECT\n        data_person_id,\n        SUM( data_a + data_b + data_c ) as data_total\n      FROM\n        DATA\n      GROUP BY\n        data_person_id\n      ) x ON person_id = data_person_id\n    WHERE\n      total != data_total\n  )\n</code></pre>\n\n<p>I believe my problem lies in my misunderstanding of the <a href=\"http://www.postgresql.org/docs/9.0/static/sql-update.html\" rel=\"nofollow\">doc</a> (I'm guessing the part about the self-join).</p>\n\n<p>Also, any ways to improve this query is appreciated!</p>\n"},{"tags":["hibernate","many-to-many","criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12480854,"title":"How do I use hibernate to query for a list of some entity based on its many-to-many property without filtering out items on the many-to-many property?","body":"<p>I have an entity class <code>Foo</code> that has a many-to-many relationship with <code>Bar</code></p>\n\n<pre><code>...\n&lt;class name=\"Foo\"&gt;\n    ...\n    &lt;set name=\"bars\" table=\"FooBar\" lazy=\"true\" batch-size=\"100\" fetch=\"select\"&gt;\n        &lt;key column=\"FooID\" /&gt;\n        &lt;many-to-many column=\"BarID\" class=\"Bar\" /&gt;\n    &lt;/set&gt;\n    ...\n&lt;/class&gt;\n...\n</code></pre>\n\n<p>I am trying to make a search screen that allows users to search for all <code>Foo</code>s that are attached to a specific <code>Bar</code>.  All <code>Bar</code>s attached to each <code>Foo</code> should be shown in the search result.</p>\n\n<p>So I tried this code:</p>\n\n<pre><code>criteria.createAlias(\"bars\", \"bar\", CriteriaSpecification.LEFT_JOIN);\ncriteria.add(Restrictions.eq(\"bar.id\", barID));\n</code></pre>\n\n<p>This filters the <code>Foo</code> records just fine.  But it also filters the <code>bars</code> property.  So I added this line:</p>\n\n<pre><code>criteria.setFetchMode(\"bars\", FetchMode.SELECT)\n</code></pre>\n\n<p>But that didn't do anything.</p>\n\n<p>I don't have any hibernate filters on Bar on the hibernate session.  Can anyone help me?</p>\n"},{"tags":["flex","hibernate","spring","intellij-idea","jstl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":891,"score":0,"question_id":4180162,"title":"spring+jstl+hibernate lazy initialization exception, how ever works find on flex front end","body":"<p>I'm working on particular application, a spring+hibernate setup. I have one front end in flex, and now I'm trying to add a jstl front end. The lazy initialization exception I get is when I try to call a a method from the jstl model and view controller, which I call from my flex fronend without any trouble.</p>\n\n<p>Here is my web.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n</code></pre>\n\n<p>http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\"\n     version=\"2.4\"></p>\n\n<pre><code>&lt;display-name&gt;HTML test project&lt;/display-name&gt;\n\n&lt;context-param&gt;\n    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;applicationContext.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;com.bamboo.common.factory.Log4JContextListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;!--&lt;context-param&gt;\n    &lt;param-name&gt;webAppRootKey&lt;/param-name&gt;\n    &lt;param-value&gt;app.root&lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;context-param&gt;\n    &lt;param-name&gt;log4jConfigLocation&lt;/param-name&gt;\n    &lt;param-value&gt;/WEB-INF/log4j.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.util.Log4jConfigListener&lt;/listener-class&gt;\n&lt;/listener&gt;--&gt;\n\n&lt;listener&gt;\n    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;!-- Http Flex Session attribute and binding listener support --&gt;\n&lt;listener&gt;\n    &lt;listener-class&gt;flex.messaging.HttpFlexSession&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;servlet&gt;\n    &lt;servlet-name&gt;ApplicationContextFactory&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;com.bamboo.common.factory.ApplicationContextFactory&lt;/servlet-class&gt;\n    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n\n&lt;servlet&gt;\n    &lt;servlet-name&gt;MessageBrokerServlet&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;flex.messaging.MessageBrokerServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;param-name&gt;services.configuration.file&lt;/param-name&gt;\n        &lt;param-value&gt;/WEB-INF/flex/services-config.xml&lt;/param-value&gt;\n    &lt;/init-param&gt;\n    &lt;load-on-startup&gt;2&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;MessageBrokerServlet&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;/messagebroker/*&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n\n&lt;!-- JSTL dispatcher-servlet --&gt;\n\n&lt;servlet&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;\n        org.springframework.web.servlet.DispatcherServlet\n    &lt;/servlet-class&gt;\n    &lt;load-on-startup&gt;2&lt;/load-on-startup&gt;\n&lt;/servlet&gt;\n\n&lt;servlet-mapping&gt;\n    &lt;servlet-name&gt;dispatcher&lt;/servlet-name&gt;\n    &lt;url-pattern&gt;*.htm&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n</code></pre>\n\n<p></p>\n\n<p>Here I load my <strong>application context</strong>, which I understand loads the beans from the back end which I will use, set my hibernate configuration and aspect configurations. Afterward I load the flex-messaging servlet, which I understand allows the flex and spring to communicate, and finally the dispatcher-servlet, which will map all the .htm requests to the jstl controllers and views.</p>\n\n<p>Here is my application context:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n</code></pre>\n\n<p>http://www.springframework.org/schema/beans/spring-beans-2.0.xsd\"></p>\n\n<pre><code>&lt;!-- ========================= GENERAL DEFINITIONS ========================= --&gt;\n\n&lt;!-- ========================= DATA ACCESS OBJECT DEFINITIONS ======================== --&gt;\n\n&lt;bean id=\"dataSource\"\n      class=\"org.springframework.jndi.JndiObjectFactoryBean\"&gt;\n    &lt;property name=\"jndiName\"&gt;\n        &lt;value&gt;java:comp/env/jdbc/catWDB&lt;/value&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"sessionFactory\" class=\"org.springframework.orm.hibernate3.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\"&gt;&lt;ref local=\"dataSource\"/&gt;&lt;/property&gt;\n    &lt;property name=\"mappingResources\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;/com/bamboo/catW3/catW3.hbm.xml&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/prop&gt;\n            &lt;prop key=\"hibernate.connection.pool_size\"&gt;3&lt;/prop&gt;\n            &lt;prop key=\"hibernate.show_sql\"&gt;true&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"transactionManager\" lazy-init=\"true\" class=\"org.springframework.orm.hibernate3.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"categoryDAOTarget\" class=\"com.bamboo.catW3.DAO.impl.CategoryDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"containerDAOTarget\" class=\"com.bamboo.catW3.DAO.impl.ContainerDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"productDAOTarget\" class=\"com.bamboo.catW3.DAO.impl.ProductDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"productOptionDAOTarget\" class=\"com.bamboo.catW3.DAO.impl.ProductOptionDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"productStatusDAOTarget\" class=\"com.bamboo.catW3.DAO.impl.ProductStatusDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"userDAOTarget\" class=\"com.bamboo.catW3.DAO.impl.UserDAOImpl\"&gt;\n    &lt;property name=\"sessionFactory\"&gt;&lt;ref local=\"sessionFactory\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean id=\"velocityEngine\" class=\"org.springframework.ui.velocity.VelocityEngineFactoryBean\"&gt;\n    &lt;property name=\"velocityProperties\"&gt;\n        &lt;value&gt;\n            resource.loader=class\n            class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\n        &lt;/value&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;!-- ========================= BUSINESS OBJECT DEFINITIONS ======================== --&gt;\n\n&lt;bean id=\"catalogFacadeTarget\" class=\"com.bamboo.catW3.business.impl.CatalogFacadeImpl\"&gt;\n    &lt;property name=\"categoryDAO\"&gt;&lt;ref local=\"categoryDAOTarget\"/&gt;&lt;/property&gt;\n    &lt;property name=\"containerDAO\"&gt;&lt;ref local=\"containerDAOTarget\"/&gt;&lt;/property&gt;\n    &lt;property name=\"productDAO\"&gt;&lt;ref local=\"productDAOTarget\"/&gt;&lt;/property&gt;\n    &lt;property name=\"productOptionDAO\"&gt;&lt;ref local=\"productOptionDAOTarget\"/&gt;&lt;/property&gt;\n    &lt;property name=\"productStatusDAO\"&gt;&lt;ref local=\"productStatusDAOTarget\"/&gt;&lt;/property&gt;\n    &lt;property name=\"userDAO\"&gt;&lt;ref local=\"userDAOTarget\"/&gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n\n\n\n  &lt;!-- ================================ VIEW RESOLVER ===================================== --&gt;\n\n      &lt;bean id=\"viewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n      &lt;property name=\"viewClass\"&gt;\n          &lt;value&gt;org.springframework.web.servlet.view.JstlView&lt;/value&gt;\n          &lt;/property&gt;\n      &lt;property name=\"prefix\"&gt;\n          &lt;value&gt;/WEB-INF/jsp/&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property name=\"suffix\"&gt;\n          &lt;value&gt;.jsp&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;/bean&gt;\n\n\n&lt;!-- ========================= ASPECT CONFIGURATION ======================== --&gt;\n\n&lt;bean id=\"catalogFacade\" class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt;\n    &lt;property name=\"transactionManager\"&gt;\n        &lt;ref local=\"transactionManager\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"target\"&gt;\n        &lt;ref local=\"catalogFacadeTarget\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"transactionAttributes\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"add*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"save*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"update*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"delete*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"remove*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt;\n            &lt;prop key=\"get*\"&gt;PROPAGATION_SUPPORTS,readOnly&lt;/prop&gt;\n            &lt;prop key=\"contains*\"&gt;PROPAGATION_SUPPORTS,readOnly&lt;/prop&gt;\n            &lt;prop key=\"login*\"&gt;PROPAGATION_SUPPORTS,readOnly&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p></p>\n\n<p>So what I'm trying to do, and assumed I was doing up until now, is share the catalogFacadeTarget bean with Flex, and with the controllers from the jstl setup. So I can call the same methods I call from flex, now from the controllers with the model and view methods. I thought that this way I would not encounter any problems. Here is my dispatcher-servlet:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n</code></pre>\n\n<p>http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\"></p>\n\n<pre><code>&lt;!-- URL mapping --&gt;\n&lt;bean id=\"urlMap\"\n    class=\"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping\"&gt;\n    &lt;property name=\"urlMap\"&gt;\n        &lt;props&gt;\n        &lt;prop key=\"/welcome.htm\"&gt;welcome&lt;/prop&gt;\n        &lt;prop key=\"/welcome\"&gt;welcome&lt;/prop&gt;\n        &lt;prop key=\"/catalog.htm\"&gt;catalog&lt;/prop&gt;\n        &lt;prop key=\"/catalog\"&gt;catalog&lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n\n\n&lt;!-- Controllers --&gt;\n&lt;bean name=\"welcome\"\n    class=\"com.bamboo.catW3.business.impl.Welcome\"&gt;\n    &lt;property name=\"successView\"&gt;\n        &lt;value&gt;welcome&lt;/value&gt;\n    &lt;/property&gt;\n     &lt;property name=\"catalogFacadeImpl\" ref=\"catalogFacadeTarget\"/&gt;\n&lt;/bean&gt;\n&lt;bean name=\"catalog\"\n        class=\"com.bamboo.catW3.business.impl.Catalog\"&gt;\n        &lt;property name=\"successView\"&gt;\n            &lt;value&gt;catalog&lt;/value&gt;\n        &lt;/property&gt;\n         &lt;property name=\"catalogFacadeImpl\" ref=\"catalogFacadeTarget\"/&gt;\n &lt;/bean&gt;\n</code></pre>\n\n\n\n<pre><code>&lt;bean id=\"viewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n&lt;property name=\"viewClass\"&gt;\n    &lt;value&gt;org.springframework.web.servlet.view.JstlView&lt;/value&gt;\n    &lt;/property&gt;\n&lt;property name=\"prefix\"&gt;\n    &lt;value&gt;/WEB-INF/jsp/&lt;/value&gt;\n&lt;/property&gt;\n&lt;property name=\"suffix\"&gt;\n    &lt;value&gt;.jsp&lt;/value&gt;\n&lt;/property&gt;\n&lt;/bean&gt;\n</code></pre>\n\n<p></p>\n\n<p>Now this was working fine, even though my intellij ide highlights catalogFacadeTarget reference and says that I can't resolve the bean, which would be great: if anyone knows how to make him understand, or maybe make me understand:</p>\n\n<pre><code>&lt;property name=\"catalogFacadeImpl\" ref=\"*catalogFacadeTarget*\"/&gt;\n</code></pre>\n\n<p>This was working fine for simple objects that do not have complicate relationships, for example I have a table USER that does not relate to anyone, and I can do this from the model and view method on the jstl controller:</p>\n\n<pre><code>List users = catalogFacadeImpl.getUserList();\n</code></pre>\n\n<p>No problem, I get the list of users and print it. However if I try to make this on a more complicated object, that has relationships with itself and stuff, like with the Object CATEGORY:</p>\n\n<pre><code>List categories = catalogFacadeImpl.getCategoryList();\n</code></pre>\n\n<p>I get the exceptcion:</p>\n\n<pre><code>org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.bamboo.catW3.domain.Category.categories, no session or session was closed\norg.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:488)\norg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:431)\njavax.servlet.http.HttpServlet.service(HttpServlet.java:690)\njavax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n</code></pre>\n\n<p>This would usually be a problem with the hbm and the way relationships are configured, however, this can't be the case, because from flex I call this very same method and have no trouble. So what I guess is that I'm not sharing the bean as I though i was. Not that would not give me this error either.</p>\n\n<p>I'm really confused now, any suggestion on where to look would be deeply appreciated. Thank you very much, tried to post the hbm just in case it helps somehow, but was to long for this post.</p>\n"},{"tags":["spring","hibernate","java-ee","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12826772,"title":"1 to1 relationship causing , Exception :org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update","body":"<p>Technologies used: Spring MVC , Hibernate , MySQL DB, Windows 7, NetBeans IDE</p>\n\n<p>My create,read,update operations, work however Im getting an Exception when trying to <strong>delete UserAccount &amp; associated password record:</strong></p>\n\n<p>SEVERE: Cannot delete or update a parent row: a foreign key constraint fails (<code>profiler</code>.<code>password</code>, CONSTRAINT <code>FK4C641EBBCF6D23F4</code> FOREIGN KEY (<code>user_id</code>) REFERENCES <code>user_account</code> (<code>user_id</code>))\nOct 10, 2012 11:52:22 AM org.hibernate.event.def.AbstractFlushingEventListener performExecutions\nSEVERE: Could not synchronize database state with session\norg.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update</p>\n\n<p>Caused by: java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (<code>profiler</code>.<code>password</code>, CONSTRAINT <code>FK4C641EBBCF6D23F4</code> FOREIGN KEY (<code>user_id</code>) REFERENCES <code>user_account</code> (<code>user_id</code>))</p>\n\n<p>UserAccount &amp; Password relationship: </p>\n\n<p><img src=\"http://i.stack.imgur.com/IsCdC.png\" alt=\"enter image description here\"></p>\n\n<p>UserAccount class:</p>\n\n<pre><code>package com.profile.beans;\n\nimport java.io.Serializable;\nimport java.util.List;\nimport java.util.Set;\nimport javax.persistence.*;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\n\n@Entity\n@Table(name = \"user_account\")\npublic class UserAccount implements Serializable {\n\n    @Autowired\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY, generator = \"user_account_seq\")\n    @SequenceGenerator(name = \"user_account_seq\", sequenceName = \"user_account_seq\")\n    @Column(name = \"user_id\")\n    private Long userId ;\n    //\n    @Autowired\n    @Column(name = \"user_name\")\n    private String userName;\n    //\n    @Autowired\n    @Column(name = \"user_type\")\n    private String userType;\n    //\n    @Autowired\n    @Column(name = \"first_name\")\n    private String firstName;\n    //\n    @Autowired\n    @Column(name = \"last_name\")\n    private String lastName;\n    //\n    @Autowired\n    @Column(name = \"email\")\n    private String email;\n    //\n    @Autowired\n    @Column(name = \"phone_contact\")\n    private String phoneContact; \n\n    //\n    @Autowired\n    @Column(name = \"address\")\n    private String address;\n    //\n    @Autowired\n    @Column(name = \"city\")\n    private String city ; \n     //\n    @Autowired\n    @Column(name = \"state\")\n    private String state; \n     //\n    @Autowired\n    @Column(name = \"country\")\n    private String country;\n     //\n    @Autowired\n    @Column(name = \"zipcode\")\n    private Integer zipcode = 0;\n\n    //is the user account Active either due to user deactivation,admin deactivation, or nonpayment\n    @Autowired\n    @Column(name = \"active\")\n    private boolean active = false;\n\n    @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = \"UserAccount\")  \n    @JoinColumn(name=\"user_id\")\n    private Password Password = null; \n\n\n    @OneToMany(mappedBy=\"UserAccount\",cascade={CascadeType.ALL})    \n    @JoinColumn(name=\"doc_id\")      \n    private List&lt;Document&gt; documents = null; \n\n    @Autowired(required = false)\n    public UserAccount() {\n    } \n\n\n  @Autowired(required = true)\n    public UserAccount(Long userId, String userName, String userType, String firstName, String lastName, String email, String phoneContact, String address, String city, String state, String country, Integer zipcode) {\n        this.userId = userId;\n        this.userName = userName;\n        this.userType = userType;\n        this.firstName = firstName;\n        this.lastName = lastName;\n        this.email = email;\n        this.phoneContact = phoneContact;\n        this.address = address;\n        this.city = city;\n        this.state = state;\n        this.country = country;\n        this.zipcode = zipcode;\n    }\n\n    public com.profile.beans.Password getPassword() {\n        return Password;\n    }\n\n    public void setPassword(com.profile.beans.Password Password) {\n        this.Password = Password;\n    }\n    public boolean isActive() {\n        return active;\n    }\n    public void setActive(boolean active) {\n        this.active = active;\n    }\n\n    public String getAddress() {\n        return address;\n    }\n\n    public void setAddress(String address) {\n        this.address = address;\n    }\n\n    public String getCity() {\n        return city;\n    }\n\n    public void setCity(String city) {\n        this.city = city;\n    }\n\n    public String getCountry() {\n        return country;\n    }\n\n    public void setCountry(String country) {\n        this.country = country;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n\n    public void setEmail(String email) {\n        this.email = email;\n    }\n\n    public List&lt;Document&gt; getDocuments() {\n        return documents;\n    }\n\n    public void setDocuments(List&lt;Document&gt; documents) {\n        this.documents = documents;\n    }\n\n    public Integer getZipcode() {\n        return zipcode;\n    }\n\n\n\n    public String getFirstName() {\n        return firstName;\n    }\n\n    public void setFirstName(String firstName) {\n        this.firstName = firstName;\n    }\n\n\n    public String getLastName() {\n        return lastName;\n    }\n\n    public void setLastName(String lastName) {\n        this.lastName = lastName;\n    }\n\n    public String getPhoneContact() {\n        return phoneContact;\n    }\n\n    public void setPhoneContact(String phoneContact) {\n        this.phoneContact = phoneContact;\n    }\n\n    public String getState() {\n        return state;\n    }\n\n    public void setState(String state) {\n        this.state = state;\n    }\n\n    public Long getUserId() {\n        return userId;\n    }\n\n    public void setUserId(Long userId) {\n        this.userId = userId;\n    }\n\n    public String getUserName() {\n        return userName;\n    }\n\n    public void setUserName(String userName) {\n        this.userName = userName;\n    }\n\n    public String getUserType() {\n        return userType;\n    }\n\n    public void setUserType(String userType) {\n        this.userType = userType;\n    }\n\n    public void setZipcode(Integer zipcode) {\n        try\n        {\n        this.zipcode = zipcode;\n        }\n        catch (NumberFormatException exc)\n        {\n            exc.printStackTrace();\n        }\n    }\n\n\n\n\n    @Override\n    public boolean equals(Object obj) {\n        if (obj == null) {\n            return false;\n        }\n        if (getClass() != obj.getClass()) {\n            return false;\n        }\n        final UserAccount other = (UserAccount) obj;\n        if ((this.userId == null) ? (other.userId != null) : !this.userId.equals(other.userId)) {\n            return false;\n        }\n        return true;\n    }\n\n    @Override\n    public int hashCode() {\n        int hash = 3;\n        hash = 73 * hash + (this.userId != null ? this.userId.hashCode() : 0);\n        return hash;\n    }\n\n    @Override\n    public String toString() {\n        return \"UserAccount{\" + \"userId=\" + userId + \", userName=\" + userName + \", userType=\" + userType + \", firstName=\" + firstName + \", lastName=\" + lastName + \", email=\" + email + \", phoneContact=\" + phoneContact + \", address=\" + address + \", city=\" + city + \", state=\" + state + \", country=\" + country + \", zipcode=\" + zipcode + \", active=\" + active + \", documents=\" + documents + '}';\n    }\n\n\n}\n</code></pre>\n\n<p>Password class :</p>\n\n<pre><code>package com.profile.beans;\n\nimport java.io.Serializable;\nimport javax.persistence.*;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.hibernate.annotations.Cascade;\n\n@Entity\n@Table(name = \"Password\")\npublic class Password implements Serializable {\n\n    @Autowired(required = false)\n    public Password() {\n    }\n\n    @Autowired(required = true)\n    public Password(UserAccount UserAccount) {\n       this.UserAccount = UserAccount;\n    }\n    @Autowired\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY, generator = \"password_seq\")\n    @SequenceGenerator(name = \"password_seq\", sequenceName = \"password_seq\")\n    @Column(name = \"password_id\")\n    private Long passwordId;\n    @Autowired\n    @Column(name = \"password\")\n    private String password = null;  \n     //1 to 1 relation with UserAccounts\n       //1 to 1 relation with UserAccounts\n    @Autowired\n    @Qualifier(\"UserAccount\")\n    @OneToOne(fetch = FetchType.EAGER)\n    @JoinColumn(name = \"user_id\", referencedColumnName=\"user_id\",nullable = false)\n    private UserAccount UserAccount;\n\n@Autowired(required = true)\n        public Password(UserAccount UserAccount, String password) {\n            this.UserAccount = UserAccount;\n            this.password = password;\n        }\n\n    public UserAccount getUserAccount() {\n        return UserAccount;\n    }\n\n    public void setUserAccount(UserAccount UserAccount) {\n        this.UserAccount = UserAccount;\n    }\n\n    public Long getPasswordId() {\n        return passwordId;\n    }\n\n    public void setPasswordId(Long passwordId) {\n        this.passwordId = passwordId;\n    }\n\n        public String getPassword() {\n            return password;\n        }\n    }\n</code></pre>\n\n<p>My database DDL (MySQL syntax):</p>\n\n<pre><code>SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;\nSET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;\nSET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';\n\nDROP SCHEMA IF EXISTS `profiler`;\nCREATE SCHEMA IF NOT EXISTS `profiler` DEFAULT CHARACTER SET latin1 COLLATE latin1_swedish_ci ;\nDROP SCHEMA IF EXISTS `profiler` ;\nCREATE SCHEMA IF NOT EXISTS `profiler` DEFAULT CHARACTER SET latin1 ;\nUSE `profiler` ;\n\n-- -----------------------------------------------------\n-- Table `profiler`.`user_account`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `profiler`.`user_account` ;\n\nCREATE  TABLE IF NOT EXISTS `profiler`.`user_account` (\n  `user_id` BIGINT(20) NOT NULL ,\n  `user_name` VARCHAR(45) NULL DEFAULT NULL ,\n  `user_type` VARCHAR(45) NULL DEFAULT NULL ,\n  `first_name` VARCHAR(45) NULL DEFAULT NULL ,\n  `last_name` VARCHAR(45) NULL DEFAULT NULL ,\n  `email` VARCHAR(45) NULL DEFAULT NULL ,\n  `phone_contact` VARCHAR(45) NULL DEFAULT NULL ,\n  `address` VARCHAR(45) NULL DEFAULT NULL ,\n  `city` VARCHAR(45) NULL DEFAULT NULL ,\n  `state` VARCHAR(45) NULL DEFAULT NULL ,\n  `country` VARCHAR(45) NULL DEFAULT NULL ,\n  `zipcode` VARCHAR(45) NULL DEFAULT NULL ,\n  `active` TINYINT(1) NULL DEFAULT NULL ,\n  PRIMARY KEY (`user_id`) )\nENGINE = InnoDB\nDEFAULT CHARACTER SET = latin1;\n\n\n-- -----------------------------------------------------\n-- Table `profiler`.`document`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `profiler`.`document` ;\n\nCREATE  TABLE IF NOT EXISTS `profiler`.`document` (\n  `doc_id` BIGINT(20) NOT NULL ,\n  `title` VARCHAR(45) NULL DEFAULT NULL ,\n  `format` VARCHAR(45) NULL DEFAULT NULL ,\n  `url_string` VARCHAR(45) NULL DEFAULT NULL ,\n  `size_in_bytes` INT(11) NULL DEFAULT NULL ,\n  `created_on` TIMESTAMP NULL DEFAULT NULL ,\n  `bytes` BLOB NULL DEFAULT NULL ,\n  `height` INT(11) NULL DEFAULT NULL ,\n  `width` INT(11) NULL DEFAULT NULL ,\n  `user_id` BIGINT(20) NOT NULL ,\n  PRIMARY KEY (`doc_id`) ,\n  CONSTRAINT `user_id_fk`\n    FOREIGN KEY (`user_id` )\n    REFERENCES `profiler`.`user_account` (`user_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE)\nENGINE = InnoDB\nDEFAULT CHARACTER SET = latin1;\n\n\n-- -----------------------------------------------------\n-- Table `profiler`.`password`\n-- -----------------------------------------------------\nDROP TABLE IF EXISTS `profiler`.`password` ;\n\nCREATE  TABLE IF NOT EXISTS `profiler`.`password` (\n`password_id` BIGINT(20) NOT NULL ,\n  `password` VARCHAR(45) NOT NULL ,\n`user_id` BIGINT(20) NOT NULL ,\n  PRIMARY KEY (`password_id`) ,\n  CONSTRAINT `user_id_fk_1`\n    FOREIGN KEY (`user_id` )\n    REFERENCES `profiler`.`user_account` (`user_id` )\n    ON DELETE CASCADE\n    ON UPDATE CASCADE)\nENGINE = InnoDB\nDEFAULT CHARACTER SET = latin1;\n\nCREATE INDEX `user_id_fk_idx` ON `profiler`.`password` (`user_id` ASC) ;\n\n\n\nSET SQL_MODE=@OLD_SQL_MODE;\nSET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;\nSET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;\nSET foreign_key_checks = 1;\n</code></pre>\n\n<p>UserAccount controller class:</p>\n\n<pre><code>@Controller\n@RequestMapping(\"/UserAccount\")\npublic class UserAccountController {\n      @Autowired\n    private UserAccountDao userAccountDao;\n     @Autowired\n     private PasswordDao passwordDao;\n\n    public UserAccountController() {\n    }\n\n    public UserAccountController(UserAccountDao userAccountDao, PasswordDao passwordDao) {\n        this.userAccountDao = userAccountDao;\n        this.passwordDao = passwordDao;\n    }\n@RequestMapping(value=\"/Register\")\n    public String RegisterationView()\n{\n    return \"UserAccount/Register\";\n}\n@RequestMapping(value=\"/Login\")\n    public String LoginView()\n{\n    return \"UserAccount/Login\";\n}\n@RequestMapping(value=\"/Update\")\n    public String UpdateView()\n{\n    return \"UserAccount/Update\";\n}\n    //create\n    @RequestMapping(value=\"/create\",method = RequestMethod.POST)\n    public String create(\n            @RequestParam(\"username\") String username,\n            @RequestParam(\"email\") String email,\n            @RequestParam(\"firstname\") String firstName,\n            @RequestParam(\"lastname\") String lastName,\n            @RequestParam(\"phonecontact\") String phonecontact,\n            @RequestParam(\"address\") String address,\n             @RequestParam(\"state\") String state,\n             @RequestParam(\"city\") String city,\n             @RequestParam(\"country\") String country,\n             @RequestParam(\"password\") String password,\n             @RequestParam(\"zipcode\") Integer zipcode,\n             HttpSession session,HttpServletRequest request, Model model)\n    {\n        String view = null ; \n        //*check if username exists\n        //*if email exists\n\n         UserAccount userAccount = new UserAccount(); \n\n        userAccount.setAddress(address);\n        userAccount.setCity(city);\n        userAccount.setCountry(country);\n        userAccount.setState(state);\n        userAccount.setPhoneContact(phonecontact);\n        userAccount.setEmail(email);\n        userAccount.setZipcode(zipcode);\n        userAccount.setFirstName(firstName);\n        userAccount.setLastName(lastName);\n        userAccount.setUserName(username);\n        userAccount.setUserType(utility.UserTypes.REGULAR);\n        //instatiate password \n        //**password not exist before &amp; must be at least characters long \n\n        Password userPassword = new Password(userAccount,password);\n        userAccountDao.create(userAccount);\n        passwordDao.create(userPassword);\n        //add userAccount to model \n        model.addAttribute(\"userAccount\", userAccount);\n        session.setAttribute(\"userAccount\", userAccount);\n         view =  \"UserAccount/UserMainMenu\";\n\n\n\n        return view;\n    }\n    //update\n   @RequestMapping(value=\"/update\",method = RequestMethod.GET)\n    public String update( @RequestParam(value=\"username\", required=false) String username,\n            @RequestParam(value=\"email\",required=false) String email,\n            @RequestParam(value=\"firstname\",required=false) String firstName,\n            @RequestParam(value=\"lastname\",required=false) String lastName,\n            @RequestParam(value=\"phonecontact\",required=false) String phonecontact,\n            @RequestParam(value=\"address\",required=false) String address,\n            @RequestParam(value=\"state\",required=false) String state,\n            @RequestParam(value=\"city\",required=false) String city,\n            @RequestParam(value=\"country\",required=false) String country,\n            @RequestParam(value=\"zipcode\",required=false) Integer zipcode,@RequestParam(value=\"update\",required=false) String update,HttpSession session,HttpServletRequest request)\n    {\n         String view = null ; \n          UserAccount userAccount = (UserAccount)session.getAttribute(\"userAccount\");\n         //*check if username exists\n        //*if email exists\n          try\n          {\n              System.out.println(\"Class  UserAccountController, update:\" + update); \n     if (update.equalsIgnoreCase(\"update\"))\n             {\n        //reset values in case updated info \n        userAccount.setAddress(address);\n        userAccount.setCity(city);\n        userAccount.setCountry(country);\n        userAccount.setState(state);\n        userAccount.setPhoneContact(phonecontact);\n        userAccount.setEmail(email);\n        userAccount.setZipcode(zipcode);\n        userAccount.setFirstName(firstName);\n        userAccount.setLastName(lastName);\n        userAccount.setUserName(username);\n        userAccount.setUserType(utility.UserTypes.REGULAR);\n        //instatiate password \n        userAccountDao.update(userAccount);\n        //add userAccount to model \n        session.setAttribute(\"userAccount\", userAccount);\n        view =  \"UserAccount/UserMainMenu\";\n             }\n      if (update.equalsIgnoreCase(\"delete\"))\n             {\n\n      System.out.println(\"Class  UserAccountController, userAccount: \"+userAccount);\n      //query for password that corresponds to particular user \n      Password password = (Password)passwordDao.getByUserAccount(userAccount);\n      System.out.println(\"Class  UserAccountController, password: \"+password );\n     password.setUserAccount(null);\n      //delete password \n      passwordDao.delete(password);\n      //delete user account \n      userAccountDao.delete(userAccount);\n      session.removeAttribute(\"userAccount\");\n      view =  \"UserAccount/UserMainMenu\";\n\n             }\n          }\n          catch (Exception exc)\n          {\n              //forward to error page \n              exc.getMessage();\n              view = \"error\";\n          }\n        return view;\n    }\n    //delete\n    @RequestMapping(value=\"/delete\",method = RequestMethod.DELETE)\n    public String delete( @RequestParam(\"id\")Long id,HttpSession session,HttpServletRequest request)\n    {\n        String view = null ; \n        UserAccount newUserAccount = userAccountDao.getById(id);\n        userAccountDao.delete(newUserAccount);\n        view =  \"UserAccount/UserMainMenu\";\n        return view;\n    }\n    //read\n    @RequestMapping(value=\"/read\",method = RequestMethod.GET)\n    public void read(Long id)\n    {\n        userAccountDao.getById(id);\n    }\n\n    public UserAccountDao getUserAccountDao() {\n        return userAccountDao;\n    }\n\n    public void setUserAccountDao(UserAccountDao userAccountDao) {\n        this.userAccountDao = userAccountDao;\n    }\n\n    public PasswordDao getPasswordDaoImpl() {\n        return passwordDao;\n    }\n\n    public void setPasswordDaoImpl(PasswordDaoImpl passwordDao) {\n        this.passwordDao = passwordDao;\n    }\n\n}\n</code></pre>\n\n<p>PasswordDaoImpl class:</p>\n\n<pre><code>@Repository\n@Transactional\npublic class PasswordDaoImpl implements PasswordDao{\n   @Autowired\n    private SessionFactory sessionFactory;\n\n    private Session currentSession()\n    {\n        return sessionFactory.getCurrentSession();\n    }\n\n    @Override\n    public Password getByUserAccount(UserAccount UserAccount) { \n    String hql = \"FROM com.profile.beans.Password WHERE Password.UserAccount.UserId =:id\";\n    Long id = UserAccount.getUserId();\n    Query q = currentSession().createQuery(hql);\n    return (Password)q.setParameter(\"id\",id).list().get(0);\n    }\n\n    @Override\n    public void create(Password Password) {\n        currentSession().save(Password);\n    }\n\n    @Override\n    public void delete(Password Password) {\n        currentSession().delete(Password);\n    }\n\n    @Override\n    public void update(Password Password) {\n        currentSession().update(Password);\n    }\n       public SessionFactory getSessionFactory() {\n        return sessionFactory;\n    }\n\n    public void setSessionFactory(SessionFactory sessionFactory) {\n        this.sessionFactory = sessionFactory;\n    }\n\n}\n</code></pre>\n"},{"tags":["hibernate","ejb","ejbql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12827479,"title":"Hibernate 3.2.1 and EJBQL query within query","body":"<p>I'm trying to make sure the following is supported with the EJBQL capabilities in hibernate 3.2.1, but my google-fu has failed me.\nAll I found was that nested queries aren't supported in EJB 2.x</p>\n\n<p>Can I put a query within a query like this:</p>\n\n<pre><code>select count(*) from \n    (select myField from myTable group by myField having sum(case.....) ....... )\n</code></pre>\n"},{"tags":["java","hibernate","session"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2010,"score":2,"question_id":8985031,"title":"Hibernate, Java : no session or session was closed","body":"<p>I already saw this kind of problem on Stackoverflow but nothing could help me to resolve my problem.</p>\n\n<p>I am novice in Hibernate and have a project to be made in Java and MySQL, and thus use hibernate. I managed to reach my data, to modify them, to deletethem, but I block on a method because I have one exception which arrives.. And seen that I understand still not all the threads I manage not to remove this bug:</p>\n\n<p>Here is my error : </p>\n\n<blockquote>\n  <p>org.hibernate.LazyInitializationException\n   Grave: failed to lazily initialize a collection of role:\n  DAO.User.files, no session or session was closed\n  org.hibernate.LazyInitializationException: failed to lazily initialize\n  a collection of role: DAO.User.files, no session or session was closed\n    at\n  org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)\n    at\n  org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)\n    at\n  org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:343)\n    at org.hibernate.collection.PersistentSet.add(PersistentSet.java:189)\n    at DAO.UserDAO.removeGroupAddUserFiles(UserDAO.java:252)    at\n  javaapplication5.JavaApplication5.main(JavaApplication5.java:37)</p>\n</blockquote>\n\n<p>And Here are my Java classes : </p>\n\n<pre><code>public static void main(String[] args) {\n        GroupDAO grDAO = new GroupDAO();\n        List[] lists = grDAO.removeGroup(grDAO.getGroupById(1));\n\n        FileDAO fiDAO = new FileDAO();\n        fiDAO.removeGroupAddFiles(lists);\n\n        UserDAO usDAO = new UserDAO();\n        usDAO.removeGroupAddUserFiles(lists);\n    }\n</code></pre>\n\n<p>GroupDAO.java : </p>\n\n<pre><code>public List[] removeGroup(Group group) {\n        Set&lt;File&gt; setFiles = group.getFiles();\n        Set&lt;User&gt; setUsers = group.getUsers_1();\n        List[] lists = new List[2];\n\n        Iterator&lt;File&gt; itFiles = setFiles.iterator();\n        Iterator&lt;User&gt; itUsers = setUsers.iterator();\n        List&lt;File&gt; listFiles = new ArrayList&lt;File&gt;();\n        List&lt;User&gt; listUsers = new ArrayList&lt;User&gt;();\n        while (itFiles.hasNext()) {\n            listFiles.add(itFiles.next());\n        }\n        while (itUsers.hasNext()) {\n            listUsers.add(itUsers.next());\n        }\n\n        lists[0] = listUsers;\n        lists[1] = listFiles;\n\n        org.hibernate.Transaction tx = session.beginTransaction();\n        session.delete(group);\n        tx.commit();\n\n        return lists;\n    }\n</code></pre>\n\n<p>FileDAO.java : </p>\n\n<pre><code>public List[] removeGroupAddFiles(List[] lists) {\n        System.out.println(\"5 : \" + session.isOpen());\n        System.out.println(\"6 : \" + session.isOpen());\n        Iterator&lt;File&gt; itFile = lists[1].iterator();\n        System.out.println(\"7 : \" + session.isOpen());\n\n        org.hibernate.Transaction tx = session.beginTransaction();\n        while (itFile.hasNext()) {\n            System.out.println(\"8 : \" + session.isOpen());\n            Iterator&lt;User&gt; itUser = lists[0].iterator();\n            System.out.println(\"9 : \" + session.isOpen());\n            File f = itFile.next();\n            while (itUser.hasNext()) {\n                System.out.println(\"10 : \" + session.isOpen());\n                System.out.println(\"11 : \" + session.isOpen());\n                User u = itUser.next();\n                System.out.println(\"12 : \" + session.isOpen());\n                File fCopie = new File(u, f.getName() + \"_\" + u.getFirstName() + \"_\" + u.getLastName(), f.getExtension(), f.getSize(), f.getCreatedAt(), f.getUpdateAt());\n                System.out.println(\"13 : \" + session.isOpen());\n                session.save(fCopie);\n                System.out.println(\"14 : \" + session.isOpen());\n            }\n        }\n        tx.commit();\n        return lists;\n    }\n</code></pre>\n\n<p>UserDAO.java : </p>\n\n<pre><code>public List[] removeGroupAddUserFiles(List[] lists) {\n        System.out.println(\"15 : \" + session.isOpen());\n        Iterator&lt;User&gt; itUser = lists[0].iterator();\n        System.out.println(\"16 : \" + session.isOpen());\n\n        org.hibernate.Transaction tx = session.beginTransaction();\n\n        while (itUser.hasNext()) {\n            System.out.println(\"17 : \" + session.isOpen());\n            Iterator&lt;File&gt; itFile = lists[1].iterator();\n            System.out.println(\"18 : \" + session.isOpen());\n            User u = itUser.next();\n            while (itFile.hasNext()) {\n                System.out.println(\"19 : \" + session.isOpen());\n                File f = itFile.next();\n                System.out.println(\"20 : \" + session.isOpen());\n                try {\n                    u.getFiles().add(f);\n                } catch (LazyInitializationException e) {\n                    e.printStackTrace();\n                }\n                System.out.println(\"21 : \" + session.isOpen());\n            }\n            try {\n                session.update(u);\n            } catch (ConstraintViolationException e) {\n                e.printStackTrace();\n            }\n            System.out.println(\"22 : \" + session.isOpen());\n        }\n        tx.commit();\n        return lists;\n    }\n</code></pre>\n\n<p>My code is redundant, I know him(it), it was exactly to try to avoid the problem of session that closed.</p>\n\n<p>The session closes in the line:</p>\n\n<p>U.getFiles () .add (f);</p>\n\n<p>And HibernateUtil.java : </p>\n\n<pre><code>public class HibernateUtil {\n\n    private static final SessionFactory sessionFactory = buildSessionFactory();\n\n    private static SessionFactory buildSessionFactory() {\n        try {\n// load from different directory\n            SessionFactory sessionFactory = new Configuration().configure(\"/hibernate.cfg.xml\").buildSessionFactory();\n\n            return sessionFactory;\n\n        } catch (Throwable ex) {\n// Make sure you log the exception, as it might be swallowed\n            System.err.println(\"Initial SessionFactory creation failed.\" + ex);\n            throw new ExceptionInInitializerError(ex);\n        }\n    }\n\n    public static SessionFactory getSessionFactory() {\n        return sessionFactory;\n    }\n\n    public static void shutdown() {\n// Close caches and connection pools\n        getSessionFactory().close();\n    }\n}\n</code></pre>\n\n<p>If somebody had an idea that would help me largely:p.</p>\n\n<p>Thank you in advance!</p>\n\n<p>I put a display of session.isOpen() everywhere in my code as well as a try wrestling syr the error. The program thus continues, and shows me systematically true, whether it is before or after the exception! I does not really understand...</p>\n"},{"tags":["java","hibernate","hibernate-criteria"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12813075,"title":"Using Hibernate setFirstResult without any ordering","body":"<p>I am new to hibernate. I am confused with criteria's <code>setFirstResult</code> method. \nFrom the documentation it seems hibernate returns rows from the the given number. </p>\n\n<p>Since SQL query does not guarantee the ordering of rows without order by clause, \nhow <code>setFirstQuery</code> works in this case(without orderBy clause)? \nDoes hibernate read index information from the database? </p>\n\n<p>If I execute same SQL query multiple times, ordering might change, in this case how <code>setFirstResult</code> work?</p>\n"},{"tags":["hibernate","serialization"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":12825051,"title":"could not deserialize eof Exception","body":"<p>My application is using hsql as database. It was working fine till now. In the production I got the exception org.hibernate.SerializationException could not deserialize EOF exception. I couldn't get the complete stack trace because the exception is not caught properly in my code.</p>\n\n<p>I also don't have the exact sequence of events that caused this exception. After I restarted the tomcat and hql the problem disappeared. </p>\n\n<p>Sorry to be vague, but please I need some help with root cause analysis. What could have been the issue here?</p>\n\n<pre><code>validateSession();\n        Session session = SessionFactory.getInstance(SessionContext.DISTRIBUTED).getSession();\n        session.beginTransaction();\n        List results;\n        try {\n            Criteria cri = session.createCriteria(Filter.class);\n            cri.add(Restrictions.eq( \"user\", userVO.user() ));\n            setLazyMode(cri);\n            results = cri.list();\n            session.getTransaction().commit();\n        } finally {\n            rollbackIfStillOpen(session);\n        }\n</code></pre>\n"},{"tags":["java","hibernate","postgresql","jpa","uuid"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":327,"score":1,"question_id":11284359,"title":"Persisting UUID in PostgreSQL using JPA","body":"<p>I'm trying to persist an entity in PostgreSQL that uses UUID as primary key. I've tried persisting it as a plain UUID:</p>\n\n<pre><code>@Id\n@Column(name = \"customer_id\")\nprivate UUID id;\n</code></pre>\n\n<p>With the above, I get this error: </p>\n\n<pre><code>ERROR: column \"customer_id\" is of type uuid but expression is of type bytea\nHint: You will need to rewrite or cast the expression.\nPosition: 137\n</code></pre>\n\n<p>I also tried persisting the UUID as byte[] to no avail:</p>\n\n<pre><code>@Transient\nprivate UUID id;\n\n@Id\n@Column(name = \"customer_id\")\n@Access(AccessType.PROPERTY)\n@Lob\nprotected byte[] getRowId() {\n    return id.toString().getBytes();\n}\n\nprotected void setRowId(byte[] rowId) {\n    id = UUID.fromString(new String(rowId));\n}\n</code></pre>\n\n<p>If I remove @Lob, the error I get is the same as the one posted above. But with @Lob applied, the error changes slightly to:</p>\n\n<pre><code>ERROR: column \"customer_id\" is of type uuid but expression is of type bigint\nHint: You will need to rewrite or cast the expression.\nPosition: 137\n</code></pre>\n\n<p>I'm feeling extremely bad being unable to do something as simple as this! </p>\n\n<p>I'm using Hibernate 4.1.3.Final with PostgreSQL 9.1. </p>\n\n<p>I've seen numerous questions on SO more or less with the same issue but they are all old and none seems to have a straight forward answer. </p>\n\n<p>I'd like to achieve this in a standard way without resorting to ugly hacks. But if this can be achieved only though (ugly) hacks, then may be that's what I'll do. However, I don't want to store the UUID as a varchar in the database as that's not good for performance. Also, I'd want to not introduce a Hibernate dependency in my code if possible.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p><em>UPDATE 1</em> (2012-07-03 12:15 pm)</p>\n\n<p>Well, well, well... It's kinda interesting that I tested the exact same code (plain UUID, no conversion -- the first version of the code posted above) with SQL server 2008 R2 using the JTDS driver (v1.2.5) and, guess what, it worked as a charm (of course I had to change connection-related info in persistence.xml). </p>\n\n<p>Now, is it a PostgreSQL-specific issue or what?</p>\n"},{"tags":["java","hibernate","jpa","orm"],"answer_count":4,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":840,"score":6,"question_id":2177991,"title":"Modelling a Two to Many Relationship in JPA/Hibernate","body":"<p>I have the following entity relationship problem. A \"Game\" must have two (and only two) \"Team\" objects. A \"Team\" can have many \"Games\"</p>\n\n<p>This, as far as I can see is a Two-to-Many relationship. However...I don't know how to model this in JPA. Eg, I was going to do something like this...</p>\n\n<pre><code>@Entity\npublic class Team extends BaseObject {\n  private Long id;\n  private Set&lt;Game&gt; games;\n\n  @Id\n  @GeneratedValue(strategy = GenerationType.AUTO) \n  public Long getId() {return id;}\n  public void setId(Long id) {this.id = id;}\n\n  @OneToMany(mappedBy = \"game\")\n  public Set&lt;Game&gt; getGames() {return games;}\n  public void setGames(Set&lt;Game&gt; games) {this.games = games;}\n}\n\n@Entity\npublic class Game extends BaseObject {\n  private Long id;\n  private Team team1;\n  private Team team2;\n\n  @Id\n  @GeneratedValue(strategy = GenerationType.AUTO) \n  public Long getId() {return id;}\n  public void setId(Long id) {this.id = id;}\n\n  @ HERE IS THE PROBLEM - WHAT ANNOTATION DO I USE?\n  public Team getTeam1() {return team1;}\n  public void setTeam1(Team team1) {this.team1 = team1;}\n\n  @ HERE IS THE PROBLEM - WHAT ANNOTATION DO I USE?\n  public Team getTeam2() {return team2;}\n  public void setTeam2(Team team1) {this.team2 = team2;}\n}\n</code></pre>\n\n<p>But, as you can see, I'm not sure how to link the tables together from an annotation side. Has anyone ever done something like this before? Any ideas, help?</p>\n\n<p>thanks very much!</p>\n"},{"tags":["hibernate","many-to-many","criteria"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":12824079,"title":"hibernate search criteria for many to many relationship","body":"<p>I am very new to Hibernate criteria. Currently i hv some requirements that need to create hibernate search criteria for the two entities with many to many relationship between them.</p>\n\n<p>For instance, I have Student and Course objects. A Student can take more than one Course and a course can be taken by more than one Student. The Student and Course classes looks like the following</p>\n\n<pre><code>public class Student {\n   private String name ;\n\n   private Set&lt;Course&gt; courses = new HashSet&lt;Course&gt;();\n\n   // setter and getters following\n}\n\npublic class Course{\n  private String courseName ;\n  // setter and getter following\n}\n</code></pre>\n\n<p>I configured uni-directional relationship from Student to Course. </p>\n\n<p>My requirement is to select all the Students based on the course name. For example to select Students who take course name \"Math101\". As i am very new to hibernate, i am not sure how to do it. can u please show me sample criteria for such requirements? Many thanks.</p>\n\n<p>Best regards.</p>\n"},{"tags":["java","hibernate","spring-mvc","spring-data","spring-data-jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":499,"score":1,"question_id":11467443,"title":"Spring MVC pagination using Spring Data and Hibernate","body":"<p>I need to paginate table which displays filtered data from one DB table. For example, I have a CARS table, and I need to paginate only <code>... WHERE CAR = \"BMW\"</code>. So far, I used JPA <code>repository.findAll(Pageable pageable)</code> method, if I paged data from one table only. </p>\n\n<p>Is there any standard way to achieve this using standard epository methods, or do I have to write my own implementation? Thanks.</p>\n"},{"tags":["hibernate","jpa","jboss","ejb-3.0","jta"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3841,"score":2,"question_id":5373598,"title":"How to use Container Managed Transaction (CMT) with JBoss AS 6, Hibernate 3.6, JPA, JTA and EJB3","body":"<p>I'm attempting to setup a web app using CMT. I've got it running standalone within Eclipse ok, and now I'm trying to get it working within Jboss AS 6, using Struts 1.0. I've chosen CMT because the doco I've read hints that it's the best and \"least verbose to use\". So seems like contempory/good-practice use of Hibernate 3.6. </p>\n\n<p>I can load objects from a MySQL database with the following code extracts, but persisted objects are not being flushed/synchronised/saved to the database:</p>\n\n<p>From within Struts 1.0 Action class:</p>\n\n<pre><code>InitialContext ctx = new InitialContext();   \nEntityManagerFactory emf = (EntityManagerFactory)ctx.lookup(\"java:/MyEntityManagerFactory\");\n</code></pre>\n\n<p>'emf' is then passed to a method with my DAO class that is summarised below:</p>\n\n<pre><code>@PersistenceContext(unitName=\"purejetJPA\") EntityManager em;\n@TransactionAttribute(TransactionAttributeType.REQUIRED)\nexampleMethodInMyCustomDAOClass() {\nEntityManager em = emf.createEntityManager();\nem.find(MyCustomEntity.class, 542);  // works successfully\nem.persist(newInstanceOfMyCustomEntity);          // this executes ok and generates an ID\n                                                  // however the entity is not saved to database upon completion \n}\n</code></pre>\n\n<p>Contents of persistence.xml:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"1.0\" xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\"&gt;\n    &lt;persistence-unit name=\"myPersistanceUnitName\" transaction-type=\"JTA\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;jta-data-source&gt;java:/MySqlDS&lt;/jta-data-source&gt;\n                &lt;class&gt;my.custom.entity.Classes&lt;/class&gt;\n                &lt;properties&gt;\n            &lt;property name=\"jboss.entity.manager.factory.jndi.name\" value=\"java:/MyEntityManagerFactory\"/&gt;\n            &lt;property name=\"hibernate.transaction.factory_class\" value=\"org.hibernate.transaction.CMTTransactionFactory\"/&gt;\n            &lt;property name=\"hibernate.transaction.manager_lookup_class\" value=\"org.hibernate.transaction.JBossTransactionManagerLookup\"/&gt;\n            &lt;property name=\"hibernate.connection.autocommit\" value=\"false\"/&gt;\n            &lt;property name=\"hibernate.current_session_context_class\" value=\"jta\"/&gt;\n        &lt;/properties&gt;   \n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>The Hibernate EntityManager documentation has a very limited description of how to achieve CMT:</p>\n\n<hr>\n\n<p>Our entity manager/transaction management idiom for CMT and EJB3 container-use is reduced to this:\n    //CMT idiom through injection\n    @PersistenceContext(name=\"sample\") EntityManager em;</p>\n\n<hr>\n\n<p>And this <a href=\"http://community.jboss.org/wiki/sessionsandtransactions#Transaction_demarcation_with_EJBCMT\" rel=\"nofollow\">jboss.org article</a> says:</p>\n\n<hr>\n\n<p><strong>Transaction demarcation with EJB/CMT</strong></p>\n\n<p>Our goal really is to remove any transaction demarcation code from the data access code:</p>\n\n<pre><code>@TransactionAttribute(TransactionAttributeType.REQUIRED)\npublic void doSomeWork() {\n\n// Do some work\nfactory.getCurrentSession().load(...);\nfactory.getCurrentSession().persist(...);\n}\n</code></pre>\n\n<hr>\n\n<p>My questions:</p>\n\n<ol>\n<li><p>In the line \"actory.getCurrentSession().load(...);\", what type is \"factory\", and how do I create it? Is it Hibernate.SessionFactory? Or a Jboss or HTTP session?</p></li>\n<li><p>In the line \"@PersistenceContext(name=\"sample\") EntityManager em;\" what is \"name\" referring to? I found an example on a forum of something using \"unitName\" instead of \"name\".   Is this line how I first declare the EntityManager object that I use to call .persist() .find() etc? (and therefore my code that creates an EntityManagerFactory is not needed)</p></li>\n<li><p>Should I consider researching and using \"Java Context and Dependency Injection\" (CDI)?</p></li>\n</ol>\n\n<p>Any help much appreciated. Please let me know what other bits of code or config files I should supply</p>\n\n<hr>\n\n<p><strong>Update:</strong> </p>\n\n<p>If I don't use EntityManagerFactory, and retrieve an EntityManager instead using @PersistenceContext, then should something like this code for my \"session bean\" (the class retriving+saving entities on a per-user-session basis) be the way to do it?</p>\n\n<pre><code>@Stateful\n@TransactionManagement(value=TransactionManagementType.BEAN)\npublic class X implements IX {\n\n@PersistenceContext(unitName=\"MySQL\", type=PersistenceContextType.EXTENDED)\nprivate EntityManager em;\n\n@Resourceprivate\nUserTransaction tx;\n\n@PersistenceContext(unitName=\"MySQL\", type=PersistenceContextType.EXTENDED)\nprivate EntityManager em;\n\n@Resource\nprivate UserTransaction tx;\n\npublic void doStuff() {\n   tx.begin();\n   em.joinTransaction();\n   em.find(myEntity);\n   em.perrsist(myEntity);\n   tx.commit();\n}\n</code></pre>\n\n<p>If this is on the right track, what is needed in persistence.xml? From all my reading of doco and the web I'm not sure which of these might be required:</p>\n\n<pre><code>&lt;property name=\"jboss.entity.manager.factory.jndi.name\" value=\"java:/MyEntityManagerFactory\"/&gt;\n&lt;property name=\"hibernate.transaction.factory_class\" value=\"org.hibernate.transaction.CMTTransactionFactory\"/&gt;\n&lt;property name=\"hibernate.transaction.manager_lookup_class\" value=\"org.hibernate.transaction.JBossTransactionManagerLookup\"/&gt;\n&lt;property name=\"hibernate.connection.autocommit\" value=\"false\"/&gt;\n&lt;property name=\"hibernate.current_session_context_class\" value=\"jta\"/&gt; \n</code></pre>\n"},{"tags":["java","hibernate","jdbc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12815254,"title":"ConstraintViolationException, should I expect it to be thrown then handle it? or should I prevent it from being thrown?","body":"<p>When writing database code, I usually prevent a ConstraintViolationException to be thrown by checking the records before updating or inserting.</p>\n\n<p>I do not wait for a ContraintViolationException's to take place then handle it. This is because a database administrator once told me that this is a bad practice.</p>\n\n<p>But I'm seeing many developers handling the ContraintViolationException and Foreign Key exception, rather than manually checking for the violations using sql code.</p>\n\n<p><b>The question is? Which is better? Should I just handle such exceptions when they come up, or should I query the objects before insert/update operations and prevent these errors from being thrown?</b></p>\n"},{"tags":["spring","hibernate","jsf-2","jpa-2.0","jboss7.x"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":282,"score":0,"question_id":12815336,"title":"Error deploying JSF 2, Spring 3.1 app on JBoss 7.1.1 >  java.lang.NoClassDefFoundError: javax/servlet/ServletOutputStream","body":"<p>Trying to deploy a JSF 2 app with Spring 3.1 + JPA 2 (Hibernte 3.6.8) into JBoss 7.1.1 AS. The app was working fine on tomcat 7. Now, I have already added and changed some configurations. </p>\n\n<ol>\n<li>Added jboss-deployment-structure.xml ></li>\n</ol>\n\n<blockquote>\n<pre><code> &lt;jboss-deployment-structure xmlns=\"urn:jboss:deployment-structure:1.1\"&gt;\n      &lt;deployment&gt;  \n        &lt;exclusions&gt;\n        &lt;module name=\"org.apache.log4j\" /&gt;\n          &lt;module name=\"javax.faces.api\" slot=\"main\"/&gt;\n          &lt;module name=\"com.sun.jsf-impl\" slot=\"main\"/&gt;\n          &lt;module name=\"org.hibernate\"/&gt;       \n          &lt;module name=\"org.javassist\" /&gt;\n          &lt;module name=\"javaee.api\" /&gt;\n          &lt;module name=\"org.hibernate.validator\" /&gt;\n          &lt;module name=\"org.jboss.as.web\" /&gt;\n          &lt;module name=\"org.jboss.logging\" /&gt;\n          &lt;module name=\"javax.persistence.api\" /&gt;\n          &lt;module name=\"org.jboss.interceptor\" /&gt;      \n         &lt;/exclusions&gt;    \n      &lt;/deployment&gt;\n    &lt;/jboss-deployment-structure&gt;\n</code></pre>\n</blockquote>\n\n<p><em>2.</em> Inside web.xml added these lines:</p>\n\n<blockquote>\n<pre><code>&lt;persistence-unit-ref&gt;\n  &lt;persistence-unit-ref-name&gt;persistence/persistenceUnit&lt;/persistence-unit-ref-name&gt;\n  &lt;persistence-unit-name&gt;persistenceUnit&lt;/persistence-unit-name&gt;      \n&lt;/persistence-unit-ref&gt;\n</code></pre>\n</blockquote>\n\n<p><em>3</em>. Inside applicationContext.xml, changed bean definition for entityManagerFactory by adding this property></p>\n\n<blockquote>\n<pre><code>&lt;property name=\"persistenceXmlLocation\"\nvalue=\"classpath*:META-INF/persistence.xml\"/&gt;\n</code></pre>\n</blockquote>\n\n<p>Now, do I still need to do something more than these which is obvious to you?\nBecause, while I am trying to deploy it from eclipse indigo SR2,\ngetting this ></p>\n\n<pre><code>14:10:32,046 INFO  [org.jboss.modules] JBoss Modules version 1.1.1.GA\n14:10:33,054 INFO  [org.jboss.msc] JBoss MSC version 1.0.2.GA\n14:10:33,200 INFO  [org.jboss.as] JBAS015899: JBoss AS 7.1.1.Final \"Brontes\" starting\n14:10:36,375 INFO  [org.xnio] XNIO Version 3.0.3.GA\n14:10:36,384 INFO  [org.jboss.as.server] JBAS015888: Creating http management service using socket-binding (management-http)\n14:10:36,432 INFO  [org.xnio.nio] XNIO NIO Implementation Version 3.0.3.GA\n14:10:36,462 INFO  [org.jboss.remoting] JBoss Remoting version 3.2.3.GA\n14:10:36,587 INFO  [org.jboss.as.logging] JBAS011502: Removing bootstrap log handlers\n14:10:36,714 INFO  [org.jboss.as.security] (ServerService Thread Pool -- 44) JBAS013101: Activating Security Subsystem\n14:10:36,735 INFO  [org.jboss.as.naming] (MSC service thread 1-2) JBAS011802: Starting Naming Service\n14:10:37,043 INFO  [org.jboss.as.mail.extension] (MSC service thread 1-6) JBAS015400: Bound mail session [java:jboss/mail/Default]\n14:10:37,208 INFO  [org.jboss.as.connector] (MSC service thread 1-7) JBAS010408: Starting JCA Subsystem (JBoss IronJacamar 1.0.9.Final)\n14:10:37,295 INFO  [org.jboss.as.security] (MSC service thread 1-7) JBAS013100: Current PicketBox version=4.0.7.Final\n14:10:37,740 INFO  [org.jboss.as.connector.subsystems.datasources] (ServerService Thread Pool -- 27) JBAS010403: Deploying JDBC-compliant driver class org.h2.Driver (version 1.3)\n14:10:38,792 INFO  [org.jboss.ws.common.management.AbstractServerConfig] (MSC service thread 1-3) JBoss Web Services - Stack CXF Server 4.0.2.GA\n14:10:38,833 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-2) Starting Coyote HTTP/1.1 on http-localhost-127.0.0.1-8080\n14:10:39,534 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-1) JBAS015012: Started FileSystemDeploymentService for directory F:\\work\\softwares\\Application Servers\\JBoss\\jboss-as-7.1.1.Final\\jboss-as-7.1.1.Final\\standalone\\deployments\n14:10:39,618 INFO  [org.jboss.as.remoting] (MSC service thread 1-3) JBAS017100: Listening on localhost/127.0.0.1:4447\n14:10:39,623 INFO  [org.jboss.as.remoting] (MSC service thread 1-2) JBAS017100: Listening on /127.0.0.1:9999\n14:10:39,698 INFO  [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS015014: Re-attempting failed deployment treasury.war\n14:10:39,706 INFO  [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS015003: Found com.misl.treasury.ui.war in deployment directory. To trigger deployment create a file called com.misl.treasury.ui.war.dodeploy\n14:10:40,105 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-2) JBAS010400: Bound data source [java:jboss/datasources/ExampleDS]\n14:10:40,399 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-1) JBAS015876: Starting deployment of \"com.misl.treasury.ui.war\"\n14:10:40,405 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-7) JBAS015876: Starting deployment of \"treasury.war\"\n14:10:55,283 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-7) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Tomcat6InjectionProvider:org.apache.catalina.util.DefaultAnnotationProcessor' for service type 'com.sun.faces.spi.injectionprovider'\n14:10:55,289 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-7) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Jetty6InjectionProvider:org.mortbay.jetty.plus.annotation.InjectionCollection' for service type 'com.sun.faces.spi.injectionprovider'\n14:10:55,428 INFO  [org.jboss.as.jpa] (MSC service thread 1-7) JBAS011401: Read persistence.xml for persistenceUnit\n14:10:55,843 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Tomcat6InjectionProvider:org.apache.catalina.util.DefaultAnnotationProcessor' for service type 'com.sun.faces.spi.injectionprovider'\n14:10:55,849 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015893: Encountered invalid class name 'com.sun.faces.vendor.Jetty6InjectionProvider:org.mortbay.jetty.plus.annotation.InjectionCollection' for service type 'com.sun.faces.spi.injectionprovider'\n14:10:56,010 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-2) MSC00001: Failed to start service jboss.deployment.unit.\"com.misl.treasury.ui.war\".POST_MODULE: org.jboss.msc.service.StartException in service jboss.deployment.unit.\"com.misl.treasury.ui.war\".POST_MODULE: Failed to process phase POST_MODULE of deployment \"com.misl.treasury.ui.war\"\n    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_23]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_23]\n    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_23]\nCaused by: java.lang.NoClassDefFoundError: javax/servlet/ServletOutputStream\n    at java.lang.Class.getDeclaredConstructors0(Native Method) [rt.jar:1.6.0_23]\n    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2389) [rt.jar:1.6.0_23]\n    at java.lang.Class.getConstructor0(Class.java:2699) [rt.jar:1.6.0_23]\n    at java.lang.Class.getConstructor(Class.java:1657) [rt.jar:1.6.0_23]\n    at org.jboss.as.web.deployment.jsf.JsfManagedBeanProcessor.deploy(JsfManagedBeanProcessor.java:108)\n    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]\n    ... 5 more\nCaused by: java.lang.ClassNotFoundException: javax.servlet.ServletOutputStream from [Module \"deployment.com.misl.treasury.ui.war:main\" from Service Module Loader]\n    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)\n    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)\n    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)\n    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)\n    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)\n    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)\n    ... 11 more\n\n14:10:56,628 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-4) MSC00001: Failed to start service jboss.deployment.unit.\"treasury.war\".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit.\"treasury.war\".PARSE: Failed to process phase PARSE of deployment \"treasury.war\"\n    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_23]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_23]\n    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_23]\nCaused by: org.jboss.as.server.deployment.DeploymentUnitProcessingException: SAXException parsing vfs:/F:/work/softwares/Application Servers/JBoss/jboss-as-7.1.1.Final/jboss-as-7.1.1.Final/bin/content/treasury.war/WEB-INF/beans.xml\n    at org.jboss.as.weld.deployment.BeansXmlParser.parse(BeansXmlParser.java:100)\n    at org.jboss.as.weld.deployment.processors.BeansXmlProcessor.parseBeansXml(BeansXmlProcessor.java:133)\n    at org.jboss.as.weld.deployment.processors.BeansXmlProcessor.deploy(BeansXmlProcessor.java:97)\n    at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]\n    ... 5 more\nCaused by: org.xml.sax.SAXParseException: Premature end of file.\n    at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:196)\n    at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:175)\n    at org.apache.xerces.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:394)\n    at org.apache.xerces.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:322)\n    at org.apache.xerces.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:281)\n    at org.apache.xerces.impl.XMLScanner.reportFatalError(XMLScanner.java:1459)\n    at org.apache.xerces.impl.XMLDocumentScannerImpl$PrologDispatcher.dispatch(XMLDocumentScannerImpl.java:903)\n    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:324)\n    at org.apache.xerces.parsers.XML11Configuration.parse(XML11Configuration.java:845)\n    at org.apache.xerces.parsers.XML11Configuration.parse(XML11Configuration.java:768)\n    at org.apache.xerces.parsers.XMLParser.parse(XMLParser.java:108)\n    at org.apache.xerces.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1196)\n    at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:555)\n    at org.apache.xerces.jaxp.SAXParserImpl.parse(SAXParserImpl.java:289)\n    at org.jboss.as.weld.deployment.BeansXmlParser.parse(BeansXmlParser.java:94)\n    ... 8 more\n\n14:10:56,670 INFO  [org.jboss.as] (MSC service thread 1-1) JBAS015951: Admin console listening on http://127.0.0.1:9990\n14:10:56,672 ERROR [org.jboss.as] (MSC service thread 1-1) JBAS015875: JBoss AS 7.1.1.Final \"Brontes\" started (with errors) in 25527ms - Started 143 of 222 services (2 services failed or missing dependencies, 76 services are passive or on-demand)\n14:10:56,671 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015871: Deploy of deployment \"treasury.war\" was rolled back with no failure message\n14:10:56,679 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015870: Deploy of deployment \"com.misl.treasury.ui.war\" was rolled back with failure message {\"JBAS014671: Failed services\" =&gt; {\"jboss.deployment.unit.\\\"com.misl.treasury.ui.war\\\".POST_MODULE\" =&gt; \"org.jboss.msc.service.StartException in service jboss.deployment.unit.\\\"com.misl.treasury.ui.war\\\".POST_MODULE: Failed to process phase POST_MODULE of deployment \\\"com.misl.treasury.ui.war\\\"\"}}\n14:10:56,851 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-8) JBAS015877: Stopped deployment com.misl.treasury.ui.war in 172ms\n14:10:57,068 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-7) JBAS015877: Stopped deployment treasury.war in 395ms\n14:10:57,070 INFO  [org.jboss.as.controller] (DeploymentScanner-threads - 2) JBAS014774: Service status report\nJBAS014777:   Services which failed to start:      service jboss.deployment.unit.\"treasury.war\".PARSE: org.jboss.msc.service.StartException in service jboss.deployment.unit.\"treasury.war\".PARSE: Failed to process phase PARSE of deployment \"treasury.war\"\n      service jboss.deployment.unit.\"com.misl.treasury.ui.war\".POST_MODULE: org.jboss.msc.service.StartException in service jboss.deployment.unit.\"com.misl.treasury.ui.war\".POST_MODULE: Failed to process phase POST_MODULE of deployment \"com.misl.treasury.ui.war\"\n\n14:10:57,079 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {\"JBAS014653: Composite operation failed and was rolled back. Steps that failed:\" =&gt; {\"Operation step-2\" =&gt; {\"JBAS014671: Failed services\" =&gt; {\"jboss.deployment.unit.\\\"com.misl.treasury.ui.war\\\".POST_MODULE\" =&gt; \"org.jboss.msc.service.StartException in service jboss.deployment.unit.\\\"com.misl.treasury.ui.war\\\".POST_MODULE: Failed to process phase POST_MODULE of deployment \\\"com.misl.treasury.ui.war\\\"\"}}}}\n14:10:57,087 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS014654: Composite operation was rolled back\n</code></pre>\n\n<p>I have never tried JBoss before. Any help would be highly appreciated.</p>\n"},{"tags":["hibernate","query","table","jpa","join"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3020,"score":1,"question_id":2228513,"title":"JPA : optimize EJB-QL query involving large many-to-many join table","body":"<p>I'm using Hibernate Entity Manager 3.4.0.GA with Spring 2.5.6 and MySql 5.1.\nI have a use case where an entity called Artifact has a reflexive many-to-many relation with itself, and the join table is quite large (1 million lines). As a result, the HQL query performed by one of the methods in my DAO takes a long time.\nAny advice on how to optimize this and still use HQL ? Or do I have no choice but to switch to a native SQL query that would perform a join between the table ARTIFACT and the join table ARTIFACT_DEPENDENCIES ?</p>\n\n<p>Here is the problematic query performed in the DAO :</p>\n\n<pre><code>@SuppressWarnings(\"unchecked\")\n   public List&lt;Artifact&gt; findDependentArtifacts(Artifact artifact) {\n      Query query = em.createQuery(\"select a from Artifact a where :artifact in elements(a.dependencies)\");\n      query.setParameter(\"artifact\", artifact);\n      List&lt;Artifact&gt; list = query.getResultList();\n      return list;\n   }\n</code></pre>\n\n<p>And the code for the Artifact entity :</p>\n\n<pre><code>package com.acme.dependencytool.persistence.model;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport javax.persistence.CascadeType;\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.FetchType;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.Id;\nimport javax.persistence.JoinColumn;\nimport javax.persistence.JoinTable;\nimport javax.persistence.ManyToMany;\nimport javax.persistence.Table;\nimport javax.persistence.UniqueConstraint;\n\n@Entity\n@Table(name = \"ARTIFACT\", uniqueConstraints={@UniqueConstraint(columnNames={\"GROUP_ID\", \"ARTIFACT_ID\", \"VERSION\"})})\npublic class Artifact {\n\n   @Id\n   @GeneratedValue\n   @Column(name = \"ID\")\n   private Long id = null;\n\n   @Column(name = \"GROUP_ID\", length = 255, nullable = false)\n   private String groupId;\n\n   @Column(name = \"ARTIFACT_ID\", length = 255, nullable = false)\n   private String artifactId;\n\n   @Column(name = \"VERSION\", length = 255, nullable = false)\n   private String version;\n\n   @ManyToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)\n   @JoinTable(\n         name=\"ARTIFACT_DEPENDENCIES\",\n         joinColumns = @JoinColumn(name=\"ARTIFACT_ID\", referencedColumnName=\"ID\"),\n         inverseJoinColumns = @JoinColumn(name=\"DEPENDENCY_ID\", referencedColumnName=\"ID\")\n   )\n   private List&lt;Artifact&gt; dependencies = new ArrayList&lt;Artifact&gt;();\n\n   public Long getId() {\n      return id;\n   }\n\n   public void setId(Long id) {\n      this.id = id;\n   }\n\n   public String getGroupId() {\n      return groupId;\n   }\n\n   public void setGroupId(String groupId) {\n      this.groupId = groupId;\n   }\n\n   public String getArtifactId() {\n      return artifactId;\n   }\n\n   public void setArtifactId(String artifactId) {\n      this.artifactId = artifactId;\n   }\n\n   public String getVersion() {\n      return version;\n   }\n\n   public void setVersion(String version) {\n      this.version = version;\n   }\n\n   public List&lt;Artifact&gt; getDependencies() {\n      return dependencies;\n   }\n\n   public void setDependencies(List&lt;Artifact&gt; dependencies) {\n      this.dependencies = dependencies;\n   }\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT 1 :\nThe DDLs are generated automatically by Hibernate EntityMananger based on the JPA annotations in the Artifact entity. I have no explicit control on the automaticaly-generated join table, and the JPA annotations don't let me explicitly set an index on a column of a table that does not correspond to an actual Entity (in the JPA sense). So I guess the indexing of table ARTIFACT_DEPENDENCIES is left to the DB, MySQL in my case, which apparently uses a composite index based on both clumns but doesn't index the column that is most relevant in my query (DEPENDENCY_ID).</p>\n\n<pre>\nmysql> describe ARTIFACT_DEPENDENCIES;\n+---------------+------------+------+-----+---------+-------+\n| Field         | Type       | Null | Key | Default | Extra |\n+---------------+------------+------+-----+---------+-------+\n| ARTIFACT_ID   | bigint(20) | NO   | MUL | NULL    |       |\n| DEPENDENCY_ID | bigint(20) | NO   | MUL | NULL    |       |\n+---------------+------------+------+-----+---------+-------+\n</pre>\n\n<p>EDIT 2 :\nWhen turning on showSql in the Hibernate session, I see many occurences of the same type of SQL query, as below :</p>\n\n<pre>\nselect dependenci0_.ARTIFACT_ID as ARTIFACT1_1_, dependenci0_.DEPENDENCY_ID as DEPENDENCY2_1_, artifact1_.ID as ID1_0_, artifact1_.ARTIFACT_ID as ARTIFACT2_1_0_, artifact1_.GROUP_ID as GROUP3_1_0_, artifact1_.VERSION as VERSION1_0_ from ARTIFACT_DEPENDENCIES dependenci0_ left outer join ARTIFACT artifact1_ on dependenci0_.DEPENDENCY_ID=artifact1_.ID where dependenci0_.ARTIFACT_ID=?\n</pre>\n\n<p>Here's what EXPLAIN in MySql says about this type of query :</p>\n\n<pre>\nmysql> explain select dependenci0_.ARTIFACT_ID as ARTIFACT1_1_, dependenci0_.DEPENDENCY_ID as DEPENDENCY2_1_, artifact1_.ID as ID1_0_, artifact1_.ARTIFACT_ID as ARTIFACT2_1_0_, artifact1_.GROUP_ID as GROUP3_1_0_, artifact1_.VERSION as VERSION1_0_ from ARTIFACT_DEPENDENCIES dependenci0_ left outer join ARTIFACT artifact1_ on dependenci0_.DEPENDENCY_ID=artifact1_.ID where dependenci0_.ARTIFACT_ID=1;\n+----+-------------+--------------+--------+-------------------+-------------------+---------+---------------------------------------------+------+-------+\n| id | select_type | table        | type   | possible_keys     | key               | key_len | ref                                         | rows | Extra |\n+----+-------------+--------------+--------+-------------------+-------------------+---------+---------------------------------------------+------+-------+\n|  1 | SIMPLE      | dependenci0_ | ref    | FKEA2DE763364D466 | FKEA2DE763364D466 | 8       | const                                       |  159 |       |\n|  1 | SIMPLE      | artifact1_   | eq_ref | PRIMARY           | PRIMARY           | 8       | dependencytooldb.dependenci0_.DEPENDENCY_ID |    1 |       |\n+----+-------------+--------------+--------+-------------------+-------------------+---------+---------------------------------------------+------+-------+\n</pre>\n\n<p>EDIT 3 :\nI tried setting the FetchType to LAZY in the JoinTable annotation, but I then get the following exception :</p>\n\n<pre><code>Hibernate: select artifact0_.ID as ID1_, artifact0_.ARTIFACT_ID as ARTIFACT2_1_, artifact0_.GROUP_ID as GROUP3_1_, artifact0_.VERSION as VERSION1_ from ARTIFACT artifact0_ where artifact0_.GROUP_ID=? and artifact0_.ARTIFACT_ID=?\n51545 [btpool0-2] ERROR org.hibernate.LazyInitializationException - failed to lazily initialize a collection of role: com.acme.dependencytool.persistence.model.Artifact.dependencies, no session or session was closed\norg.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.acme.dependencytool.persistence.model.Artifact.dependencies, no session or session was closed\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:380)\n    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:372)\n    at org.hibernate.collection.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:119)\n    at org.hibernate.collection.PersistentBag.size(PersistentBag.java:248)\n    at com.acme.dependencytool.server.DependencyToolServiceImpl.createArtifactViewBean(DependencyToolServiceImpl.java:93)\n    at com.acme.dependencytool.server.DependencyToolServiceImpl.createArtifactViewBean(DependencyToolServiceImpl.java:109)\n    at com.acme.dependencytool.server.DependencyToolServiceImpl.search(DependencyToolServiceImpl.java:48)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:527)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:166)\n    at com.google.gwt.user.server.rpc.RemoteServiceServlet.doPost(RemoteServiceServlet.java:86)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)\n    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362)\n    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\n    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)\n    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729)\n    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)\n    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.handler.RequestLogHandler.handle(RequestLogHandler.java:49)\n    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\n    at org.mortbay.jetty.Server.handle(Server.java:324)\n    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)\n    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843)\n    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647)\n    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:205)\n    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)\n    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)\n    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)\n</code></pre>\n"},{"tags":["java","hibernate","jpa","map","key"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12820477,"title":"SortedMap Key Persistance in Hibernate","body":"<p>I'm hoping someone can help me with my hibernate issue as I've been banging my head against Google for around an hour without result.</p>\n\n<p>So the issue is that I have a SortedMap in a class, using Integer as the Key (and its natural built-in compareTo method) and another class as the value type. I'm using the key to keep the user-defined order of the value type and trying to get Hibernate to persist this. </p>\n\n<p>For whatever reason, Hibernate has defaulted to disregarding the key I have inputted and instead using the value type's primary key as the key instead. When I load my Map back out of the database all of my keys have been changed in this way.</p>\n\n<p>Definition of the Map is shown below (I'm using annotation-style Hibernate);</p>\n\n<pre><code>@ManyToMany(cascade = CascadeType.ALL)\n@MapKey\n@Sort(type = SortType.NATURAL)\nprivate SortedMap&lt;Integer, Column&gt; columnOrder;\n</code></pre>\n\n<p>I can't use the Column type to store the order itself as the Column may be used in many instances of the containing type, with a different key value each time. Any guidance would be most appreciated.</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12821000,"title":"create hibernate controller class by netbeans IDE","body":"<p>Is there way to generate hibernate controller class(which is included persist,update,delete methods)like jpacontrollers by netbeans IDE?</p>\n"},{"tags":["spring","hibernate","jstl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12810038,"title":"how to split a double and show it in 2 fields","body":"<p>In my JSP, I am using a list to iterate the values and show them in JSP. Some of my values are double like </p>\n\n<pre><code>&lt;td&gt;Length &lt;form:input path=\"rr.length\"/&gt; &lt;/td&gt;\n</code></pre>\n\n<p>which will show <code>123.45</code> in the filed.</p>\n\n<p>But, in my jsp I want to show them as </p>\n\n<p>integer part in one filed and decimal part in another field with a dot in between the fields.</p>\n\n<p><code>123</code> . <code>45</code></p>\n\n<p>when user edits the data, it should save as one field in DB. I am using spring form tags in my jsp. Using spring MVC, Hibernate, JSP and JSTL.</p>\n\n<p>Any suggestions are greatly appreciated. Thanks in Advance!</p>\n"},{"tags":["hibernate","postgresql-8.4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12817960,"title":"Query Execution Timeout with Postgres 8.4","body":"<p>I want to implement, query time out. Application framework consists, <strong>Spring MVC and hibernate</strong>.</p>\n\n<p>If I am specifying <strong>timeout in session factory</strong>. it gives error Timeout is <strong>not implemented in Postgresql driver</strong>.</p>\n\n<p>I am using postgres <strong>8.4</strong></p>\n\n<p>Code is:</p>\n\n<pre><code>@Override\n@Transactional(timeout=20)\npublic List&lt;MasterBooking&gt; searchMasterBookings(---){//some more code}\n</code></pre>\n\n<p>error stack trace is:</p>\n\n<pre><code>SQL state [0A000]; error code [0];Method org.postgresql.jdbc4.Jdbc4PreparedStatement.setQueryTimeout(int) is not yet implemented.; nested exception is org.postgresql.util.PSQLException: Method org.postgresql.jdbc4.Jdbc4PreparedStatement.setQueryTimeout(int) is not yet implemented.\n</code></pre>\n\n<p>How can I implement this ?</p>\n"},{"tags":["java","hibernate","lucene","hibernate-search"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":12812093,"title":"How to search between dates (Hibernate Search)?","body":"<p>I am wondering how I can search between by dates in Hibernate Search using Range-Query or is there any filter I have to implement.Following is my field in Record Entity</p>\n\n<pre><code>    /**\n     * When the analysis started.\n     */\n    @Temporal(TemporalType.TIMESTAMP)\n    @Field(index = Index.UN_TOKENIZED)\n    @DateBridge(resolution = Resolution.MILLISECOND)\n    private Date startTS;\n</code></pre>\n\n<p>My requirment is to find the records analysed between a two dates eg. 11/11/2011 to 11/11/2012.I am confused how to do this.</p>\n"},{"tags":["hibernate","lucene","hibernate-search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12804543,"title":"Indexing and quering many to many associations using hibernate search","body":"<p>I am having users and contacts and a m-m between user and contacts showing which user is following which contact</p>\n\n<p>I want to index contacts and query them as follows</p>\n\n<p>List all contacts a user is following. List all contacts a user is following created by another user.</p>\n\n<pre><code>UserContacts have the following fields\nid\nUser user;\nContact contact;\n\nUser\nid\nname\nemailid\nSet&lt;UserContacts&gt; userContacts;\n\nContacts\nid\nAddress address;\nUser createdBy;\nSet&lt;UserContacts&gt; userContacts;\n</code></pre>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12817698,"title":"Hibernate SessionFactory getCurrentSession is not valid without active transaction","body":"<p>I am facing one problem in Hibernate. Here is the code.</p>\n\n<pre><code>    Configuration cfg = new Configuration().configure();\n    SessionFactory factory = cfg.buildSessionFactory();\n    Session session = factory.openSession();\n\n    Transaction trans = session.beginTransaction();\n    trans.begin();\n    Session session2 = factory.getCurrentSession();\n    System.out.println(session2.isConnected());\n\n    trans.commit();\n</code></pre>\n\n<p>And in my cfg file </p>\n\n<pre><code>  &lt;session-factory&gt;\n    &lt;property name=\"hibernate.connection.driver_class\"&gt;com.microsoft.sqlserver.jdbc.SQLServerDriver&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:sqlserver://localhost:1433&lt;/property&gt;\n    &lt;property name=\"hibernate.connection.username\"&gt;username&lt;/property&gt;\n    &lt;property name=\"connection.password\"&gt;password&lt;/property&gt;\n    &lt;property name=\"connection.pool_size\"&gt;5&lt;/property&gt;\n    &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.SQLServerDialect&lt;/property&gt;\n    &lt;property name=\"hibernate.current_session_context_class\"&gt;thread&lt;/property&gt;\n    &lt;property name=\"show_sql\"&gt;true&lt;/property&gt;\n    &lt;property name=\"hbm2ddl.auto\"&gt;false&lt;/property&gt;\n    &lt;mapping resource=\"Test.hbm.xml\"/&gt;\n&lt;/session-factory&gt;\n</code></pre>\n\n<p>when i run the application with above code it is giving me an Exception saying \"org.hibernate.HibernateException: isConnected is not valid without active transaction\"</p>\n\n<p>I don't know what behavior its performing internally. Any idea's please. </p>\n"},{"tags":["hibernate","spring","java-ee"],"answer_count":15,"favorite_count":13,"up_vote_count":25,"down_vote_count":0,"view_count":9025,"score":25,"question_id":722121,"title":"What should I learn first, Spring or Hibernate?","body":"<p>I've just started learning Struts and I'm trying to be marketable for a good job as a Java programmer. My next decision would be choosing which to learn next, Spring or Hibernate?</p>\n\n<p>Also do you guys have any suggestions or tips for me to be good? Thanks in advance!</p>\n"},{"tags":["hibernate","jpa","datasource","jndi","jta"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":438,"score":1,"question_id":9323339,"title":"How to correctly use LocalContainerEntityManagerFactoryBean with JPA","body":"<p>I downloaded a sample app which uses Hibernate and JPA the issue is the persistence unit. It seems I can use either <code>&lt;persistence-unit name=\"hibernatePersistenceUnit\" transaction-type=\"RESOURCE_LOCAL\"&gt;</code> or <code>&lt;persistence-unit name=\"hibernatePersistenceUnit\" transaction-type=\"JTA\"&gt;</code>\nfrom my research I found that if I use the first I also have to specify <code>&lt;non-jta-data-source&gt;</code> and with the second <code>&lt;jta-data-source&gt;</code> (I think that is right but correct me if I am wrong)</p>\n\n<p>I think the first one implies that the url,driver,user, pwd will be configured within the web-app. And the second one will look for the source via JNDI in the container (Again correct me if I wrong)\nBut the value which I need to specify for that property is my stumbling block.\nI have seen jdbc:sampleDS, java:sampleDS. (Are these also jndi lookups? Haven't seen jndi:sampleDS) So should it be jdbc: or java: or jndi: and are these all \"JNDI\"? </p>\n\n<p>And the \"sampleDS\" what does that name actually refer to? In other words does it refer to a bean name (I am using spring and my bean which configures the datasource information is called jpaDataSource) if I use resource_local or does it refer to a jndi resource somewhere on the application server, JBOSS for instance, or something else I am not aware of?</p>\n"},{"tags":["java","hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12494543,"title":"Using print statement while lazily loading childs in hibernate","body":"<p>I have a Customer and Phone class with one to many association with lazy set to true.  </p>\n\n<p>I load the Customer object with id as <strong>'101'</strong> using</p>\n\n<pre><code>Customer cust = (Customer) session.get(Customer.class, 1); -- (1)\ncust.getPhoneList();                                       -- (2)\nSystem.out.println(cust.getPhoneList());                   -- (3)\n</code></pre>\n\n<p>At point (1), I don't have List of phones since they are lazily loaded.</p>\n\n<p>At point (2), I don't have List of phones and no database call is made.  </p>\n\n<p>At point (3) or if point (2) is replaced with point (3),database call is made that returns list of phone numbers.I always thought that database call is made to return phone numbers only if i do some operation with the list. For e.g., <code>cust.getPhoneList().size()</code> or iterating over it.</p>\n\n<p>I didn't get why using print statement made the database call?</p>\n"},{"tags":["hibernate","ejb-3.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12811268,"title":"How to get Hibernate to ignore @OneToMany on merge?","body":"<pre><code>public class Application{\n   @Id\n   private Long id;\n\n   @OneToMany(mappedBy = \"application\")\n   private List&lt;Licence&gt; licences = new ArrayList&lt;Licence&gt;();\n   ...\n}\n\npublic class Licence{\n   @Id\n   private Long id;\n\n   @ManyToOne(fetch = FetchType.LAZY)\n   @JoinColumn(name = \"ID\", nullable = false)\n   private Application application;\n   ...\n}\n</code></pre>\n\n<p>How do I get hibernate to leave licences in application object readonly and not try to persist Licence when I go em.merge(application);</p>\n\n<p>I'm not trying to save Licence with Cascade in Application. Licences have a lot business rules to run before they actually get persisted so I will be calling persist on each licence individually. How do I do this ? This works fine on persist but not on merge. </p>\n\n<p>On merge I keep getting </p>\n\n<pre><code>org.hibernate.TransientObjectException: object is an unsaved transient \n     instance - save the transient instance before merging: com.cmr.Licence\n</code></pre>\n"},{"tags":["hibernate","playframework","ddl","playframework-1.x"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":10935432,"title":"Can I log hibernate's DDL code on Play! startup?","body":"<p>Our application is developed on Java over Play! 1.2.4. We're using JPA over Hibernate for our ORM.</p>\n\n<p>As per Play!'s default configuration, our dev environment has DDL set to false, and prod environments have it set to true.</p>\n\n<p>Up until now, changes in the DB require us to write SQL scripts to be run on production, by either a) knowing what changed, and adding it to script files, or b) examining the DB manually to code the deltas.</p>\n\n<p>It would be nice if we could get a log of all the DDL operations that were executed by Hibernate, saving us the typing and manual verification.</p>\n\n<p>I cannot find any information about this on the Play! or Hibernate documentation.</p>\n\n<p>I've tried setting this on the application.conf with no luck:</p>\n\n<pre><code>jpa.debugSQL=true \n</code></pre>\n\n<p>I can see the Select operations, but no DDL.</p>\n"},{"tags":["java","sql","hibernate"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12812708,"title":"How to extract data from object?","body":"<pre><code>[56, SensIOP, 9, Open Point] - Index 0\n[562, SensIOP, 92, Open Point2] - Index 1\n</code></pre>\n\n<p>This is my object I am getting from the database call.I am iterating over the list to get this ,now my question here is 1st and 3rd field are long and others are string , how can I extract this from the object , to assign it to some variable.</p>\n\n<p>Update :</p>\n\n<pre><code> Object object = (Object) iterator.next(); \n</code></pre>\n\n<p>This object has the value set one (Index 0 )(It's in for loop)</p>\n\n<p>Update 2 :</p>\n\n<pre><code>  for (Iterator iterator = List2.iterator(); iterator.hasNext();) {\n        Object object = (Object) iterator.next();\n</code></pre>\n"},{"tags":["hibernate","caching","ehcache"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12815822,"title":"hibernate and ehcache","body":"<p>I am using ehcache with hibernate in my application.</p>\n\n<p>I am able to cache using ehcache but I am trying to achieve something like this:</p>\n\n<ol>\n<li><p>I want to cache database tables which are frequently using in my application at first only.</p></li>\n<li><p>After caching tables, how can i use it in my hql query.\nlike in my hql query i use Pojo class name for respective db table. In this case how can i use my hql query.</p></li>\n</ol>\n\n<p>Please provide some documentation or support for above.</p>\n"},{"tags":["java","hibernate","c3p0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12808731,"title":"what does 'testConnectionOnCheckin' in c3p0 mean?","body":"<p>I have been trying to go through the c3p0 documentation but not able to understand 'testConnectionOnCheckin' property.</p>\n\n<p>Docs says - \"Connections are tested before they are included in pool\".</p>\n\n<p>Does this property apply to only new connections that c3p0 creates are tested before they are included in pool? What is point of checking new connections? Wouldn't they generally be valid?</p>\n\n<p>Also couple of days my application logs were showing following:</p>\n\n<pre><code>[managed:2 unused:2 excluded:1]\n</code></pre>\n\n<p>And my application was throwing exception for one particular connection which I assume is 'excluded' one. Is 'excluded' connection counted in pool and can c3p0 hand it over to application without checking validity? If not, then would setting 'testConnectionOnCheckin' test this excluded connection for validity before it is used by my application?</p>\n\n<p>I apologize for too many questions but it's just that I am confused.</p>\n\n<p>Thanks\nJitendra</p>\n"},{"tags":["spring","hibernate","lucene","hibernate-search"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":120,"score":3,"question_id":12402696,"title":"@IndexedEmbedded on a list of lazily-loaded entities, does not get into the search index automatically","body":"<p>I have an issue, which I think should be easily solved.</p>\n\n<p>I use Hibernate Search to index @Entitiy classes which have relations to other entities. </p>\n\n<p>Whenever an entity points to another entity that should be indexed as well, say the User who uploaded a particular Photo, I use @IndexedEmbedded, which has worked absolutely fine with HSearch's automatic indexing.</p>\n\n<p>However, I also have some @IndexedEmbeded annotations set on @ManyToOne relations. Imagine a photo having a list of related comments. These ones are by default lazily-loaded, i.e. not fetched from the DB, until actually needed. I noticed that when I add a comment, no matter how much time passes, it does not get indexed, until I do a manual reindexing. Then everything works fine. I have not observed this with any of the other IndexedEmbedded relations that i have, for instance, if I change the location of a photo, in a few minutes, it gets into the index and is perfectly searcheable. </p>\n\n<p>Any explanation? Solution?</p>\n"},{"tags":["java","spring","hibernate","jpa","spring-data-jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":158,"score":1,"question_id":12790853,"title":"Use Spring Data JPA for large projects, or regular Hibernate?","body":"<p>I am having a hard time deciding if I should stick with Hibernate for a new project, or get my feet wet with JPA and the new Spring Data implementation.</p>\n\n<p>Is the Spring Data framework intended for large projects or small projects with modest query requirements? </p>\n\n<p>While I certainly see the advantage in code reduction by using the @Query annotation, what do you do for dynamic queries? What about when you want to implement a save() method that's quite complex? </p>\n\n<p>The documentation says to make a Custom interface and implementation that your main repository implements, but what if you need to access any super methods on the crud repository itself? The crud repository implements the custom one - not the other way around. It seems like an odd design.</p>\n\n<p>I am very uncertain whether this framework will meet the challenges of complex and large applications. I've never ran into many problems with Hibernate, and I'm considering sticking with the good old reliable rather than go with Spring Data JPA. </p>\n\n<p>What should I do? What unforeseen complications and costs will I encounter if I go with Spring Data JPA?</p>\n"},{"tags":["java","spring","hibernate","jpa","jpa-2.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":149,"score":1,"question_id":12812544,"title":"JPA 2.0 & Hibernate 4.0.1 & Spring 3.1.1 Compatibility","body":"<p>I am using Spring 3.1.1 in my application.\nI have integrated JPA and Hibernate 4.0.1 into it.</p>\n\n<p>My entityManagerFactory and few more beans are not getting instantiated.</p>\n\n<pre><code>java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V\n    at org.hibernate.service.ServiceRegistryBuilder.buildServiceRegistry(ServiceRegistryBuilder.java:244)\n    at org.hibernate.ejb.Ejb3Configuration.buildLifecycleControledServiceRegistry(Ejb3Configuration.java:930)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:903)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:889)\n    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:268)\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:310)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeansOfType(DefaultListableBeanFactory.java:400)\n    at org.springframework.beans.factory.BeanFactoryUtils.beansOfTypeIncludingAncestors(BeanFactoryUtils.java:275)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.detectPersistenceExceptionTranslators(PersistenceExceptionTranslationInterceptor.java:139)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.&lt;init&gt;(PersistenceExceptionTranslationInterceptor.java:79)\n    at org.springframework.dao.annotation.PersistenceExceptionTranslationAdvisor.&lt;init&gt;(PersistenceExceptionTranslationAdvisor.java:70)\n    at org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor.setBeanFactory(PersistenceExceptionTranslationPostProcessor.java:103)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeAwareMethods(AbstractAutowireCapableBeanFactory.java:1475)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1443)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:728)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)\n    at org.mule.config.spring.SpringRegistry.doInitialise(SpringRegistry.java:89)\n    at org.mule.registry.AbstractRegistry.initialise(AbstractRegistry.java:109)\n    at org.mule.config.spring.SpringXmlConfigurationBuilder.createSpringRegistry(SpringXmlConfigurationBuilder.java:116)\n    at org.mule.config.spring.SpringXmlConfigurationBuilder.doConfigure(SpringXmlConfigurationBuilder.java:73)\n    at org.mule.config.builders.AbstractConfigurationBuilder.configure(AbstractConfigurationBuilder.java:46)\n    at org.mule.config.builders.AbstractResourceConfigurationBuilder.configure(AbstractResourceConfigurationBuilder.java:78)\n    at org.mule.config.builders.AutoConfigurationBuilder.autoConfigure(AutoConfigurationBuilder.java:101)\n    at org.mule.config.builders.AutoConfigurationBuilder.doConfigure(AutoConfigurationBuilder.java:57)\n    at org.mule.config.builders.AbstractConfigurationBuilder.configure(AbstractConfigurationBuilder.java:46)\n    at org.mule.config.builders.AbstractResourceConfigurationBuilder.configure(AbstractResourceConfigurationBuilder.java:78)\n    at org.mule.context.DefaultMuleContextFactory.createMuleContext(DefaultMuleContextFactory.java:80)\n    at org.mule.module.launcher.application.DefaultMuleApplication.init(DefaultMuleApplication.java:208)\n    at org.mule.module.launcher.application.ApplicationWrapper.init(ApplicationWrapper.java:64)\n    at org.mule.module.launcher.DefaultMuleDeployer.deploy(DefaultMuleDeployer.java:46)\n    at org.mule.tooling.server.application.ApplicationDeployer.run(ApplicationDeployer.java:56)\n    at org.mule.tooling.server.application.ApplicationDeployer.main(ApplicationDeployer.java:88)\nException in thread \"main\" org.mule.module.launcher.DeploymentInitException: NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V\n    at org.mule.module.launcher.application.DefaultMuleApplication.init(DefaultMuleApplication.java:220)\n    at org.mule.module.launcher.application.ApplicationWrapper.init(ApplicationWrapper.java:64)\n    at org.mule.module.launcher.DefaultMuleDeployer.deploy(DefaultMuleDeployer.java:46)\n    at org.mule.tooling.server.application.ApplicationDeployer.run(ApplicationDeployer.java:56)\n    at org.mule.tooling.server.application.ApplicationDeployer.main(ApplicationDeployer.java:88)\nCaused by: org.mule.api.config.ConfigurationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V (org.mule.api.lifecycle.InitialisationException) (org.mule.api.config.ConfigurationException)\n    at org.mule.config.builders.AbstractConfigurationBuilder.configure(AbstractConfigurationBuilder.java:52)\n    at org.mule.config.builders.AbstractResourceConfigurationBuilder.configure(AbstractResourceConfigurationBuilder.java:78)\n    at org.mule.context.DefaultMuleContextFactory.createMuleContext(DefaultMuleContextFactory.java:80)\n    at org.mule.module.launcher.application.DefaultMuleApplication.init(DefaultMuleApplication.java:208)\n    ... 4 more\nCaused by: org.mule.api.config.ConfigurationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V (org.mule.api.lifecycle.InitialisationException)\n    at org.mule.config.builders.AbstractConfigurationBuilder.configure(AbstractConfigurationBuilder.java:52)\n    at org.mule.config.builders.AbstractResourceConfigurationBuilder.configure(AbstractResourceConfigurationBuilder.java:78)\n    at org.mule.config.builders.AutoConfigurationBuilder.autoConfigure(AutoConfigurationBuilder.java:101)\n    at org.mule.config.builders.AutoConfigurationBuilder.doConfigure(AutoConfigurationBuilder.java:57)\n    at org.mule.config.builders.AbstractConfigurationBuilder.configure(AbstractConfigurationBuilder.java:46)\n    ... 7 more\nCaused by: org.mule.api.lifecycle.InitialisationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V\n    at org.mule.registry.AbstractRegistry.initialise(AbstractRegistry.java:117)\n    at org.mule.config.spring.SpringXmlConfigurationBuilder.createSpringRegistry(SpringXmlConfigurationBuilder.java:116)\n    at org.mule.config.spring.SpringXmlConfigurationBuilder.doConfigure(SpringXmlConfigurationBuilder.java:73)\n    at org.mule.config.builders.AbstractConfigurationBuilder.configure(AbstractConfigurationBuilder.java:46)\n    ... 11 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:728)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)\n    at org.mule.config.spring.SpringRegistry.doInitialise(SpringRegistry.java:89)\n    at org.mule.registry.AbstractRegistry.initialise(AbstractRegistry.java:109)\n    ... 14 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in URL [file:/C:/Users/User-1/MuleStudio/workspace/.mule/apps/eigSourceCode/appendContext.xml]: Invocation of init method failed; nested exception is java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)\n    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeansOfType(DefaultListableBeanFactory.java:400)\n    at org.springframework.beans.factory.BeanFactoryUtils.beansOfTypeIncludingAncestors(BeanFactoryUtils.java:275)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.detectPersistenceExceptionTranslators(PersistenceExceptionTranslationInterceptor.java:139)\n    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.&lt;init&gt;(PersistenceExceptionTranslationInterceptor.java:79)\n    at org.springframework.dao.annotation.PersistenceExceptionTranslationAdvisor.&lt;init&gt;(PersistenceExceptionTranslationAdvisor.java:70)\n    at org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor.setBeanFactory(PersistenceExceptionTranslationPostProcessor.java:103)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeAwareMethods(AbstractAutowireCapableBeanFactory.java:1475)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1443)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)\n    ... 23 more\nCaused by: java.lang.NoSuchMethodError: org.hibernate.cfg.Environment.verifyProperties(Ljava/util/Map;)V\n    at org.hibernate.service.ServiceRegistryBuilder.buildServiceRegistry(ServiceRegistryBuilder.java:244)\n    at org.hibernate.ejb.Ejb3Configuration.buildLifecycleControledServiceRegistry(Ejb3Configuration.java:930)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:903)\n    at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:889)\n    at org.hibernate.ejb.HibernatePersistence.createContainerEntityManagerFactory(HibernatePersistence.java:73)\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:268)\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:310)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    ... 38 more\n</code></pre>\n\n<p>I am not supposed to use Maven, so i am adding jars directly to class path.</p>\n\n<p>The Jars inside class path are:</p>\n\n<p><img src=\"http://i.stack.imgur.com/y2aVD.jpg\" alt=\"Referenced Libraries\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/ExM3i.jpg\" alt=\"Spring Jars inside mule studio\"></p>\n\n<p>My persistance.xml is inside META-INF, and the code inside is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"2.0\" xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"&gt;\n    &lt;persistence-unit name=\"03offileLogger\"&gt;\n    &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;class&gt;com.comviva.mfs.eig.persistance.jpa.entities.TransactionLog&lt;/class&gt;\n\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>The <code>appendContext.xml</code> is my application Context file used for configuring spring beans which contains the following code:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:p=\"http://www.springframework.org/schema/p\" xmlns:context=\"http://www.springframework.org/schema/context\"\n    xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:jdbc=\"http://www.springframework.org/schema/jdbc\"\n    xsi:schemaLocation=\"\n            http://www.springframework.org/schema/beans\n            http://www.springframework.org/schema/beans/spring-beans.xsd\n            http://www.springframework.org/schema/tx\n            http://www.springframework.org/schema/tx/spring-tx-3.1.xsd\n            http://www.springframework.org/schema/context\n            http://www.springframework.org/schema/context/spring-context-3.1.xsd\"&gt;\n\n\n    &lt;!-- scans the classpath for annotated components (including @Repostory \n        and @Service that will be auto-registered as Spring beans --&gt;\n    &lt;context:component-scan\n        base-package=\"com.comviva.mfs.eig.logging.dataAccess, com.comviva.mfs.eig.logging.service\" /&gt;\n\n    &lt;!-- methods or classes needing to run in a complete transaction will be \n        annotated with Transactional --&gt;\n    &lt;tx:annotation-driven /&gt;\n\n    &lt;bean\n        class=\"org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor\" /&gt;\n\n    &lt;bean\n        class=\"org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor\" /&gt;\n\n    &lt;bean id=\"dataSource\"\n        class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt;\n        &lt;property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\" /&gt;\n        &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/eigDB\" /&gt;\n        &lt;property name=\"username\" value=\"root\" /&gt;\n        &lt;property name=\"password\" value=\"tiger\" /&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"entityManagerFactory\"\n        class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\"&gt;\n        &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n        &lt;property name=\"persistenceUnitName\" value=\"03offileLogger\" /&gt;\n        &lt;property name=\"jpaVendorAdapter\"&gt;\n            &lt;bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\"&gt;\n                &lt;property name=\"databasePlatform\" value=\"org.hibernate.dialect.MySQLDialect\" /&gt;\n                &lt;property name=\"showSql\" value=\"true\" /&gt;\n                &lt;property name=\"generateDdl\" value=\"true\" /&gt;\n            &lt;/bean&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n    &lt;bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\"&gt;\n        &lt;property name=\"entityManagerFactory\" ref=\"entityManagerFactory\" /&gt;\n    &lt;/bean&gt;\n&lt;/beans&gt;\n</code></pre>\n\n<p>The errors pasted above are cut to fit the size,\nBut after each error it is saying </p>\n\n<pre><code>Invocation of init method failed;\n Initialization of bean failed;\n</code></pre>\n\n<p>I read it somewhere that there is some version conflict, so the entityManagerFactory is not being instantiated.</p>\n\n<p><strong>Update:</strong>\nThe code below shows my entity (only one table).</p>\n\n<pre><code>package com.comviva.mfs.eig.persistance.jpa.entities;\n\nimport java.io.Serializable;\nimport java.sql.Timestamp;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n\n/**\n * The persistent class for the transaction_logs database table.\n * \n */\n@Entity\n@Table(name=\"transaction_logs\")\npublic class TransactionLog implements Serializable {\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @Column(name=\"TRANSACTION_ID\")\n    private Long transaction_id; \n\n    @Column(name=\"INTERFACE_ID\")\n    private String interfaceId;\n\n    @Column(name=\"FROM_ACCOUNT\")\n    private String from_account;\n\n\n    @Column(name=\"SERVICE_TYPE\")\n    private String serviceType;\n\n    @Column(name = \"MSISDN\")\n    private String msisdn;\n\n\n    @Column(name=\"TRANSACTION_TIME\")\n    private Timestamp transactionTime;\n\n\n    @Column(name = \"TRANSACTION_DATE\")\n    private Timestamp transactionDate;\n\n\n    @Column(name=\"FROM_ACCOUNT_TYPE\")\n    private Integer fromAccountType;\n\n\n    @Column(name=\"TRANSMISSION_DATE_TIME\")\n    private Timestamp transmissionDateTime;\n\n\n    @Column(name=\"INTERFACE_TXN_ID\")\n    private Long interfaceTxnId;\n\n    @Column(name=\"AVILABLE_BALANCE\")\n    private Double avilableBalance;\n\n    @Column(name=\"TOTAL_BALANCE\")\n    private Double totalBalance;\n\n    @Column(name=\"TXN_STATUS\")\n    private String txnStatus;\n\n    @Column(name=\"MESSAGE\")\n    private String message;\n\n    public TransactionLog() {\n    }\n\n    public Long getTransaction_id() {\n        return transaction_id;\n    }\n\n    public void setTransaction_id(Long transaction_id) {\n        this.transaction_id = transaction_id;\n    }\n\n    public String getInterfaceId() {\n        return interfaceId;\n    }\n\n    public void setInterfaceId(String interfaceId) {\n        this.interfaceId = interfaceId;\n    }\n\n    public String getFrom_account() {\n        return from_account;\n    }\n\n    public void setFrom_account(String from_account) {\n        this.from_account = from_account;\n    }\n\n    public String getServiceType() {\n        return serviceType;\n    }\n\n    public void setServiceType(String serviceType) {\n        this.serviceType = serviceType;\n    }\n\n    public String getMsisdn() {\n        return msisdn;\n    }\n\n    public void setMsisdn(String msisdn) {\n        this.msisdn = msisdn;\n    }\n\n    public Timestamp getTransactionTime() {\n        return transactionTime;\n    }\n\n    public void setTransactionTime(Timestamp transactionTime) {\n        this.transactionTime = transactionTime;\n    }\n\n    public Timestamp getTransactionDate() {\n        return transactionDate;\n    }\n\n    public void setTransactionDate(Timestamp transactionDate) {\n        this.transactionDate = transactionDate;\n    }\n\n    public Integer getFromAccountType() {\n        return fromAccountType;\n    }\n\n    public void setFromAccountType(Integer fromAccountType) {\n        this.fromAccountType = fromAccountType;\n    }\n\n    public Timestamp getTransmissionDateTime() {\n        return transmissionDateTime;\n    }\n\n    public void setTransmissionDateTime(Timestamp transmissionDateTime) {\n        this.transmissionDateTime = transmissionDateTime;\n    }\n\n    public Long getInterfaceTxnId() {\n        return interfaceTxnId;\n    }\n\n    public void setInterfaceTxnId(Long interfaceTxnId) {\n        this.interfaceTxnId = interfaceTxnId;\n    }\n\n    public Double getAvilableBalance() {\n        return avilableBalance;\n    }\n\n    public void setAvilableBalance(Double avilableBalance) {\n        this.avilableBalance = avilableBalance;\n    }\n\n    public Double getTotalBalance() {\n        return totalBalance;\n    }\n\n    public void setTotalBalance(Double totalBalance) {\n        this.totalBalance = totalBalance;\n    }\n\n    public String getTxnStatus() {\n        return txnStatus;\n    }\n\n    public void setTxnStatus(String txnStatus) {\n        this.txnStatus = txnStatus;\n    }\n\n    public String getMessage() {\n        return message;\n    }\n\n    public void setMessage(String message) {\n        this.message = message;\n    }\n\n\n}\n</code></pre>\n\n<p>Please help me Resolve my Problem. </p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":7,"favorite_count":13,"up_vote_count":18,"down_vote_count":0,"view_count":29725,"score":18,"question_id":787698,"title":"JPA Hibernate One-to-One relationship","body":"<p>I have a one-to-one relationship but hibernatetool complains when generating the schema. Here's an example that shows the problem:</p>\n\n<pre><code>@Entity\npublic class Person {\n    @Id\n    public int id;\n\n    @OneToOne\n    public OtherInfo otherInfo;\n\n    rest of attributes ...\n}\n</code></pre>\n\n<p>Person has a one-to-one relationship with OtherInfo:</p>\n\n<pre><code>@Entity\npublic class OtherInfo {\n    @Id\n    @OneToOne(mappedBy=\"otherInfo\")\n    public Person person;\n\n    rest of attributes ...\n}\n</code></pre>\n\n<p>Person is owning side of OtherInfo. OtherInfo is the owned side so person uses <code>mappedBy</code> to specify the attribute name \"otherInfo\" in Person.</p>\n\n<p>I get the following error when using hibernatetool to generate the database schema:</p>\n\n<pre><code>org.hibernate.MappingException: Could not determine type for: Person, at table: OtherInfo, for columns: [org.hibernate.mapping.Column(person)]\n        at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:292)\n        at org.hibernate.mapping.SimpleValue.createIdentifierGenerator(SimpleValue.java:175)\n        at org.hibernate.cfg.Configuration.iterateGenerators(Configuration.java:743)\n        at org.hibernate.cfg.Configuration.generateDropSchemaScript(Configuration.java:854)\n        at org.hibernate.tool.hbm2ddl.SchemaExport.&lt;init&gt;(SchemaExport.java:128)\n        ...\n</code></pre>\n\n<p>Any idea why? Am I a doing something wrong or is this a Hibernate bug?</p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":12795407,"title":"JPA how to select objects wich has no multiple attributes","body":"<p>I use hibernate 3.5.4-final. I have two JPA classes. </p>\n\n<pre><code>    @Entity\n    @Table(name = \"SPI_V_OP_OBJ_SUBJECT_VR\")\n    public class OpSubject_vr extends PersistenceEntity implements Serializable {\n\n        private static final long serialVersionUID = 1858749317461707015L;\n        /** id */\n        @Id\n        @GeneratedValue(strategy = GenerationType.AUTO)\n        @Column(name = \"ID\",\n                nullable = false)\n        private Long id;\n\n        /** name */\n        @Column(name = \"F_NAME\")\n        private String f_name;\n\n\n        /** type */\n        @Column(name = \"SUBJECT_TYPE\")\n        private String subject_type;\n\n\n        /** okved */\n        @ManyToMany\n        @JoinTable(name = \"SPI_V_OP_OBJ_SUBJECT_VR_OKVED\",\n                   joinColumns = {@JoinColumn(name = \"OBJECT_ID\",\n                                              referencedColumnName = \"ID\",\n                                              nullable = false)},\n                   inverseJoinColumns = {@JoinColumn(name = \"SPR_ID\",\n                                                     referencedColumnName = \"ID\",\n                                                     nullable = false)})\n        private List&lt;OpSprOkved&gt; okved_id_mult = new ArrayList&lt;&gt;();\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>@Entity\n@Table(name = \"SPI_V_OP_SPR_OKVED\")\npublic class OpSprOkved extends PersistenceEntity implements Serializable {\n\n    /** id */\n    @Id\n    @Column(name = \"ID\", nullable = false)\n    private Long id;\n\n    /** code*/\n    @Column(name = \"CODE\")\n    private String code;\n\n    /** name*/\n    @Column(name = \"name\")\n    private String name;\n}\n</code></pre>\n\n<p>Attribute okved_id_mult is multiple. I want to select objects OpSubject_vr with empty attribute okved_id_mult.  </p>\n\n<p>I tryed</p>\n\n<p>select ent from OpSubject_vr ent where okved_id_mult is empty; (hibernate error)</p>\n\n<p>select ent from OpSubject_vr ent where okved_id_mult is null; (hibernate error)</p>\n\n<p>select distinct ent from OpSubject_vr ent join ent.okved_id_mult i1 where i1.code is null;(return 0 objects)</p>\n"},{"tags":["hibernate","maven","hbm2ddl","mojo","hbm2java"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12813142,"title":"What exactly are the hibernate mojo plugins like hbm2ddl, hbm2cfgxml, etc","body":"<p>I am new to Hibernate. I wish to define a database property file like database.properties and a single persistence.xml that would define the entity/table structure. And then I wish Maven and Hibernate work together to generate the necessary Model, Persistence and Service Layer for me.</p>\n\n<p>Now firstly, many friends have suggested tools like AndroMDA and spring-roo which are brilliant, but I need to understand things at a deeper level and I am looking for raw hibernate and maven operations.</p>\n\n<p>Secondly, I have been referring codehause mojo website and trying with stuffs like hbm2ddl, hbm2cfgxml, hbm2java, hbm2dao and I am not able to understand the concepts clearly.</p>\n\n<p>So, can anyone please explain me what the mojo plugins exactly do and when to use them.\nAny reference to a good guide book or website will also be very helpful.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2803,"score":1,"question_id":5715184,"title":"JPA Bidirectional One to Many Foreign Key Issues","body":"<p>I have two entitys Person and Order being managed by JPA/Hibernate Entity Manager.  I have attempted to create a Bidirectional one to many relationship between the two entitys by annotating them as follows:</p>\n\n<p>Person: </p>\n\n<pre><code>@Id\n@Column(name=\"PERSON_ID\")\n@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = \"PERSON_SEQ\")\n@SequenceGenerator(name = \"PERSON_SEQ\", sequenceName = \"PERSON_SEQ\")\nprivate Integer personId;\n\n@OneToMany(mappedBy=\"person\", cascade=CascadeType.ALL)\nprivate List&lt;Order&gt; orders = new ArrayList&lt;Order&gt;();\n\npublic void addOrder(Order o)\n{\n    getOrders().add(o);\n    o.setPerson(this);\n}\n</code></pre>\n\n<p>Order:</p>\n\n<pre><code>@ManyToOne\n@JoinColumn(name=\"PERSON_ID\")\nprivate Person person;\n</code></pre>\n\n<p>I then test the code:</p>\n\n<pre><code>@Test\n@Transactional\n@Rollback(value=false)\npublic void populateTable() {\n    WatchUtil.startTask(\"Persist Person\");\n\n    for (int i = 0; i &lt; 25; i++) {\n        Person tmpPerson= new Person();\n        tmpPerson.setName(\"Person1\");\n        Order order = new Order();\n        order.setOrderNumber(\"Order1\");\n        tmpPerson.addOrder(order);\n        dao.persist(tmpPerson); //calls entitymanager.persist(); does not call flush\n    }\n    WatchUtil.endTask();\n}\n</code></pre>\n\n<p>This gives me a constraint exception:</p>\n\n<pre><code>2011-04-19 06:25:12,713 INFO [org.springframework.test.context.transaction.TransactionalTestExecutionListener] - &lt;Began transaction (9): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1f488f1]; rollback [false]&gt;\n2011-04-19 06:25:12,713 DEBUG [org.hibernate.SQL] - &lt;insert into PERSON (PERSON_ID, NAME) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)&gt;\n2011-04-19 06:25:12,775 DEBUG [org.hibernate.SQL] - &lt;insert into ORDER (ORDER_NUMBER PERSON_ID, ORDER_ID) values (?, ?, ?, ?, ?, ?)&gt;\n2011-04-19 06:25:12,947 WARN [org.hibernate.util.JDBCExceptionReporter] - &lt;SQL Error: 2291, SQLState: 23000&gt;\n2011-04-19 06:25:12,947 ERROR [org.hibernate.util.JDBCExceptionReporter] - &lt;ORA-02291: integrity constraint (BLUE_SITE.FKE2BCFD5374D88D96) violated - parent key not found&gt;\n2011-04-19 06:25:12,947 WARN [org.hibernate.util.JDBCExceptionReporter] - &lt;SQL Error: 2291, SQLState: 23000&gt;\n2011-04-19 06:25:12,947 ERROR [org.hibernate.util.JDBCExceptionReporter] - &lt;ORA-02291: integrity constraint (BLUE_SITE.FKE2BCFD5374D88D96) violated - parent key not found&gt;\n2011-04-19 06:25:12,947 ERROR [org.hibernate.event.def.AbstractFlushingEventListener] - &lt;Could not synchronize database state with session&gt;\norg.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update\n    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:94)\n    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:275)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:266)\n    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:167)\n    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)\n    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)\n    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)\n    at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:304)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)\n    at $Proxy32.flush(Unknown Source)\n    at test.JpaDao.persist(JpaDao.java:37)\n    at test.PersonJpaDaoTests.populateTable(MemberJpaDaoTests.java:156)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)\n    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)\n    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)\n    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)\n    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:82)\n    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:240)\n    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)\n    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)\n    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)\n    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)\n    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)\n    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)\n    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)\n    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)\n    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)\n    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:180)\n    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:49)\n    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: java.sql.BatchUpdateException: ORA-02291: integrity constraint (BLUE_SITE.FKE2BCFD5374D88D96) violated - parent key not found\n    at oracle.jdbc.driver.DatabaseError.throwBatchUpdateException(DatabaseError.java:367)\n    at oracle.jdbc.driver.OraclePreparedStatement.executeBatch(OraclePreparedStatement.java:9119)\n    at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)\n    at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)\n    ... 44 more\nStopWatch '-- DEBUGGING --': running time (millis) = 0\n</code></pre>\n\n<p>After receiving this error I removed the constraint from the database.  Both tables populated however the keys between the parent and the child were misaligned.  Can anyone steer me in the right direction?  I've looked over a bunch of posts and they claim that creating a method like my Person.addOrder(Order o) should handle things.</p>\n\n<p>It may also be important to note that I am using an Oracle Sequence to generate my Ids.\nI have also created hashCode and Equals Methods for each class.</p>\n"},{"tags":["spring","hibernate","transactions"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":129,"score":5,"question_id":12800531,"title":"@Transactional(readOnly = true) leads to LazyInitializationException","body":"<p>I have a many-to-many relation with an additional column in the link table. I've configured it in a way that the owning side fetches children eager (so I don't get <code>LazyInitializationException</code>) and in the opposite direction it is lazy. This works.</p>\n\n<p>I now wanted to fine-tune the transactions (before there was just <code>@Transactional</code> on class level of DAO and Service classes. I set method <code>getById</code> to <code>readOnly = true</code>:</p>\n\n<pre><code>@Transactional(readOnly  = true)\npublic Compound getById(Long id) {\n    return compoundDAO.getById(id);\n}\n</code></pre>\n\n<p>After this change I get a <code>LazyInitializationException</code> in following snippet:</p>\n\n<pre><code>Compound compound = compoundService.getById(6L);        \nStructure structure = compound.getComposition().get(0).getStructure();\nSystem.out.println(\"StructureId: \"+ structure.getId()); // LazyInitializationException\n</code></pre>\n\n<p>If I remove <code>(readOnly = true)</code> this works! Can anyone explain this behavior? I use Spring + Hibernate. Kind of confusing as I don't see any reason why this should affect which data is loaded?</p>\n\n<hr/>\n\n<p>EDIT:</p>\n\n<p>Snippets of relationship definitions. This is a many-to-many with a column in the link table.</p>\n\n<p>Owning side (eg Compound contains Structures):</p>\n\n<pre><code>@OneToMany(fetch = FetchType.EAGER, mappedBy = \"pk.compound\",\n    cascade = CascadeType.ALL, orphanRemoval = true)\n@OrderBy(\"pk.structure.id ASC\")\nprivate List&lt;CompoundComposition&gt; composition = new ArrayList&lt;&gt;();\n</code></pre>\n\n<p>Belongs to side:</p>\n\n<pre><code>@OneToMany(fetch = FetchType.LAZY, mappedBy = \"pk.structure\",\ncascade = CascadeType.ALL)\n@OrderBy(\"pk.compound.id ASC\")\nprivate List&lt;CompoundComposition&gt; occurence;\n</code></pre>\n\n<p>Many-To-One in @Embeddable ID class</p>\n\n<pre><code>@ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)\npublic Compound getCompound() {\n    return compound;\n}\n\n@ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)\npublic Structure getStructure() {\n    return structure;\n}\n</code></pre>\n\n<p>EDIT 2:</p>\n\n<p>Stack Trace</p>\n\n<pre><code>org.hibernate.LazyInitializationException: could not initialize proxy - no Session\n    at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:165) ~[hibernate-core-4.1.7.Final.jar:4.1.7.Final]\n    at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:272) ~[hibernate-core-4.1.7.Final.jar:4.1.7.Final]\n    at org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:185) ~[hibernate-core-4.1.7.Final.jar:4.1.7.Final]\n    at org.bitbucket.myName.myApp.entity.Structure_$$_javassist_0.getId(Structure_$$_javassist_0.java) ~[classes/:na]\n    at org.bitbucket.myName.myApp.App.main(App.java:31) ~[classes/:na]\n</code></pre>\n\n<p>EDIT 3:</p>\n\n<p>Also see my comment:</p>\n\n<p>Log is very different with readOnly and it is missing the part were the relations are loaded, eg. some selects are missing in the log.</p>\n\n<p>EDIT 4:</p>\n\n<p>So I tired with a basic DriverManagerDataSource and no Connection pool. The issue is exactly the same. For me looks like an issue in Hibernate.</p>\n"},{"tags":["java","hibernate","jasypt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":10685093,"title":"Jasypt with Hibernate - Registering the Encryptor in HibernateUtil","body":"<p>I am trying to encrypt the passwords using jasypt and Hibernate. I am using hibernate3 in my code. \nHere's my Hibernate Config file.</p>\n\n<pre><code> &lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n &lt;property name=\"hibernate.connection.provider_class\"&gt;org.jasypt.hibernate3.connectionprovider.EncryptedPasswordDriverManagerConnectionProvider&lt;/property&gt;\n &lt;property name=\"hibernate.connection.encryptor_registered_name\"&gt;configurationHibernateEncryptor&lt;/property&gt;\n &lt;property name=\"hibernate.connection.password\"&gt;ENC(ztZXKVf5rEbaUBHiaATUnA==)&lt;/property&gt;\n</code></pre>\n\n<p>My hibernate Utility class where session is built is like this</p>\n\n<pre><code>private static final SessionFactory sessionFactory;\nstatic \n{\n    try \n    {\n        StandardPBEStringEncryptor encryptor = new StandardPBEStringEncryptor();\n        HibernatePBEEncryptorRegistry registry = HibernatePBEEncryptorRegistry.getInstance();\n        registry.registerPBEStringEncryptor(\"configurationHibernateEncryptor\", encryptor);\n        encryptor.setPassword(\"root\");\n        Configuration config = new Configuration().configure();\n        sessionFactory = config.buildSessionFactory();\n    } \n    catch (Throwable ex) \n    {\n        System.err.println(\"Initial SessionFactory creation failed.\" + ex);\n        throw new ExceptionInInitializerError(ex);\n    }\n}\n</code></pre>\n\n<p>The problem is when I try to run a web application using this, it gives me an error\norg.jasypt.exceptions.EncryptionInitializationException: No string encryptor registered for hibernate with name \"configurationHibernateEncryptor\"</p>\n\n<p>I am sure that this means Hibernate cannot find the configurationHibernateEncryptor, which I have coded in the HibernateUtil. Probably this must not be the place to code this. </p>\n"},{"tags":["java","spring","hibernate","unit-testing","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":12808388,"title":"Spring 3.1 and Hibernate 4: \"HibernateException: No Session found for current thread\" When calling DAO method from unit test","body":"<p>I'm using Spring 3.1 and Hibernate 4.1, and I'm currently getting the following exception when I run a repository test:</p>\n\n<pre><code>Caused by: org.hibernate.HibernateException: No Session found for current thread\n    at org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)\n    at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:1041)\n</code></pre>\n\n<p>Here's what a DAO looks like. It uses the same generics dao pattern that basically everyone else is using:</p>\n\n<pre><code>@Repository\npublic class UserRepository extends RepositorySupport&lt;User&gt; {\n\n    public UserRepository() {\n        super(User.class);\n    }\n\n    public User findByUsername(final String username) {\n        Query query = getCurrentSession().createQuery(\n            \"from User user \" +\n            \"where user.username = :username\"\n        );\n\n        return (User) query.setParameter(\"username\", username)\n            .uniqueResult();\n    }\n</code></pre>\n\n<p>The only thing different here that I normally wouldn't do is that I am not using <code>getHibernateTemplate()</code> anymore - and that's why I suspect things aren't working. I'd rather not use this method if I can avoid it, as the resultant code looks horrible.</p>\n\n<p>My hibernate beans look like this:</p>\n\n<pre><code>&lt;bean id=\"sessionFactory\"\n      class=\"org.springframework.orm.hibernate4.LocalSessionFactoryBean\"&gt;\n    &lt;property name=\"dataSource\" ref=\"dataSource\"/&gt;\n    &lt;property name=\"mappingResources\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;hibernate/tag.hbm.xml&lt;/value&gt;\n            &lt;value&gt;hibernate/address.hbm.xml&lt;/value&gt;\n            &lt;value&gt;hibernate/user.hbm.xml&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n    &lt;property name=\"namingStrategy\"&gt;\n        &lt;bean class=\"org.hibernate.cfg.ImprovedNamingStrategy\"/&gt;\n    &lt;/property&gt;\n    &lt;property name=\"hibernateProperties\"&gt;\n        &lt;props&gt;\n            &lt;prop key=\"javax.persistence.validation.mode\"&gt;none&lt;/prop&gt;\n\n            &lt;prop key=\"hibernate.dialect\"&gt;${hibernate.dialect}&lt;/prop&gt;\n            &lt;prop key=\"hibernate.hbm2ddl.auto\"&gt;${hibernate.hbm2ddl.auto}\n            &lt;/prop&gt;\n            &lt;prop key=\"hibernate.generate_statistics\"&gt;false&lt;/prop&gt;\n\n            &lt;prop key=\"hibernate.show_sql\"&gt;false&lt;/prop&gt;\n            &lt;prop key=\"hibernate.format_sql\"&gt;true&lt;/prop&gt;\n\n            &lt;prop key=\"hibernate.cache.use_second_level_cache\"&gt;false&lt;/prop&gt;\n            &lt;prop key=\"hibernate.cache.provider_class\"&gt;\n\n            &lt;/prop&gt;\n        &lt;/props&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;bean class=\"org.springframework.orm.hibernate4.HibernateExceptionTranslator\"/&gt;\n\n&lt;bean id=\"transactionManager\"\n      class=\"org.springframework.orm.hibernate4.HibernateTransactionManager\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n\n&lt;!--\n&lt;bean id=\"hibernateInterceptor\"\n      class=\"org.springframework.orm.hibernate4.HibernateInterceptor\"&gt;\n    &lt;property name=\"sessionFactory\" ref=\"sessionFactory\"/&gt;\n&lt;/bean&gt;\n--&gt;\n\n&lt;tx:advice id=\"transactionAdvice\" transaction-manager=\"transactionManager\"&gt;\n    &lt;tx:attributes&gt;\n        &lt;tx:method name=\"find*\" read-only=\"true\" propagation=\"REQUIRED\"/&gt;\n        &lt;tx:method name=\"get*\" read-only=\"true\" propagation=\"REQUIRED\"/&gt;\n        &lt;tx:method name=\"*\" propagation=\"REQUIRED\"/&gt;\n    &lt;/tx:attributes&gt;\n&lt;/tx:advice&gt;\n\n&lt;aop:config&gt;\n    &lt;aop:advisor advice-ref=\"transactionAdvice\"\n                 pointcut=\"execution(* *..service.*.*(..))\" order=\"1\"/&gt;\n    &lt;!-- gets sub packages like service.user --&gt;\n    &lt;aop:advisor advice-ref=\"transactionAdvice\"\n                 pointcut=\"execution(* *..service.*.*.*(..))\" order=\"2\"/&gt;\n&lt;/aop:config&gt;\n\n&lt;bean id=\"validator\"\n      class=\"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean\"/&gt;\n\n&lt;context:annotation-config/&gt;\n&lt;context:spring-configured/&gt;\n&lt;context:component-scan base-package=\"com.realtywebsite.repositories,com.realtywebsite.service\"/&gt;\n\n&lt;task:annotation-driven /&gt;\n</code></pre>\n\n<p>My test code looks something like this (I have to flatten it because my tests extend from a common parent test class):</p>\n\n<pre><code>@ContextConfiguration(locations = {\n    ObjectMother.APPLICATION_CONTEXT,\n    ObjectMother.WEB_CONTEXT\n})\npublic abstract class DatabaseTest extends AbstractTransactionalJUnit4SpringContextTests {\n\n\n    @Test\n    public void delete() {\n        userRepository.delete(1);\n        flush();\n\n        assertFalse(userRepository.exists(1));\n    }\n\n    ...\n</code></pre>\n\n<p>Thanks for the help!</p>\n"},{"tags":["java","hibernate","exception","configuration","hibernate-mapping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":9108082,"title":"Place Hibernate configuration in different location","body":"<p>As the ideal place for hibernate configuration files (.hbm.xml) is </p>\n\n<pre><code>.../tomcat/webapps/projectName/WEB-INF/classes/hbm\n</code></pre>\n\n<p>but I want to place that configurations in different location say </p>\n\n<pre><code>/usr/local/properties/hibernate\n</code></pre>\n\n<p>How can I do that ?\nIf I place that configurations files in that location and if I start tomcat then it gives me error on loading that configurations says <code>hibernate.cfg.xml</code> not found</p>\n"},{"tags":["java","hibernate","spring-mvc"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12760349,"title":"derby + hibernate +Spring MVC","body":"<p>Netbeans fails to create <code>hibernate.reveng.xml</code> with error </p>\n\n<blockquote>\n  <p>Cannot establish database connection with selected Hibernate Configuration file. Please verify the database connection details in hibernate.cfg.xml</p>\n</blockquote>\n\n<p>My <code>hibernate.cfg.xml</code> looks like this</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC \"-//Hibernate/Hibernate Configuration DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n  &lt;session-factory&gt;\n  &lt;property name=\"hibernate.connection.driver_class\"&gt;org.apache.derby.jdbc.ClientDriver&lt;/property&gt;\n      &lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.DerbyDialect&lt;/property&gt;\n\n    &lt;property name=\"hibernate.connection.url\"&gt;jdbc:derby://localhost:1527/User&lt;/property&gt;\n  &lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n</code></pre>\n\n<p>What is the problem? I am working with the Java DB (Derby) Database. I haven't this problem not when I use MySQL </p>\n"},{"tags":["java","hibernate","list","interface","annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12810676,"title":"Is it possible to persist a List<E> with hibernate annotations, where E is an interface?","body":"<p>This seems like it should be fairly straightforward, but I'm having trouble coming up with an elegant solution.</p>\n\n<p>Let's use the example of a basic file system, comprised of two hibernate-annotated classes, <strong>File</strong> and <strong>Folder</strong>.</p>\n\n<p>We'll abstract out the common properties of the two classes into a <strong>FileSystemObject</strong> interface:</p>\n\n<pre><code>public interface FileSystemObject {\n    public String getName();\n    public URI getWhere();\n}\n</code></pre>\n\n<p>And the two classes:</p>\n\n<p><strong>File</strong>:</p>\n\n<pre><code>@Entity\n@Table(name = \"FILE\")\npublic class File implements FileSystemObject, Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    @Id\n    @Column(name = \"FILE_ID\")\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private long id;\n\n    @Column(name = \"NAME\", nullable = false)\n    @Index(name = \"FILE_NAME\", columnNames={\"NAME\"})\n    private String name;\n\n    @Column(nullable = false)\n    private URI where;\n\n    public File() {}\n\n    public File(String name, URI where) {\n        this.name = name;\n        this.where = where;\n    }\n\n    public long getId() {\n        return id;\n    }\n\n    public void setId(long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public URI getWhere() {\n        return where;\n    }\n\n    public void setWhere(URI where) {\n        this.where = where;\n    }\n}\n</code></pre>\n\n<p><strong>Folder</strong>:</p>\n\n<pre><code>@Entity\n@Table(name = \"FOLDER\")\npublic class Folder implements FileSystemObject, Serializable {\n\n    private static final long serialVersionUID = 2L;\n\n    @Id\n    @Column(name = \"FOLDER_ID\")\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    private long id;\n\n    @Column(name = \"NAME\", nullable = false)\n    @Index(name = \"FOLDER_NAME\", columnNames={\"NAME\"})\n    private String name;\n\n    @Column(nullable = false)\n    private URI where;\n\n    @CollectionOfElements\n    @JoinTable(name = \"FOLDER_CONTENTS\",\n               joinColumns = @JoinColumn(name = \"FOLDER_ID\"))\n    private List&lt;FileSystemObject&gt; contents;\n\n    public Folder() {}\n\n    public Folder(String name, URI where, List&lt;FileSystemObject&gt; contents) {\n        this.name = name;\n        this.where = where;\n        this.contents = contents;\n    }\n\n    public long getId() {\n        return id;\n    }\n\n    public void setId(long id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public URI getWhere() {\n        return where;\n    }\n\n    public void setWhere(URI where) {\n        this.where = where;\n    }\n\n    public List&lt;FileSystemObject&gt; getContents() {\n        return contents;\n    }\n\n    public void setContents(List&lt;FileSystemObject&gt; contents) {\n        this.contents = contents;\n    }\n}\n</code></pre>\n\n<p>Logically, the contents of a <strong>Folder</strong> could be <strong>File</strong> or <strong>Folder</strong>, so it makes sense for the contents List to be of type <strong>FileSystemObject</strong>.</p>\n\n<p>Now, assuming everything is set up correctly within pom.xml, when I try to generate some schema:</p>\n\n<pre><code>mvn hibernate3:hbm2ddl\n</code></pre>\n\n<p>It throws the following error:</p>\n\n<pre><code>Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:2.0:hbm2ddl (generate-ddl) on\nproject foo: Execution generate-ddl of goal org.codehaus.mojo:hibernate3-maven\nplugin:2.0:hbm2ddl failed: Could not determine type for: com.foo.data.FileSystemObject, for\ncolumns: [org.hibernate.mapping.Column(element)] -&gt; [Help 1]\n</code></pre>\n\n<p>Hopefully someone can shed some light on this!</p>\n"},{"tags":["java","hibernate","jpa"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12809307,"title":"Mapping multiple rows from the same database into a single entity","body":"<p>I am looking for the best way to map multiple rows in one table into a single entity. The database table I have is shown below:</p>\n\n<pre><code>principal_id    permission    target\n12312313        PERM1         1000\n12312313        PERM2         1000\n12312313        PERM2         1002\n</code></pre>\n\n<p>Ideally I would like to map the contents of this table into my Principal @Entity as a field as follows:</p>\n\n<pre><code>@Entity\n...\npublic class Principal {\n    @Id\n    private long principalId;\n\n    ...\n\n    private Map&lt;String, List&lt;Long&gt;&gt; permissionMap;\n\n}\n</code></pre>\n\n<p>What is the best way to do so?</p>\n"},{"tags":["spring","hibernate","jsp","jstl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12809459,"title":"Spring and Hibernate with radiobuttons","body":"<p>I have two radiobuttons in my JSP page.</p>\n\n<p>I have show/hide functionality on each radiobutton. Using spring form tags for the fields. </p>\n\n<p>User entered some values for radiobutton1 and then selected radiobutton2 and entered values for this. When user clicks submit, is it going to save values for both the radiobuttons or not? If not, How can I save both?</p>\n\n<p>Any help is appreciated! Thanks in Advance!</p>\n"},{"tags":["eclipse","hibernate","continuous-integration","m2eclipse","hbm2java"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":493,"score":2,"question_id":8685301,"title":"What are best practices for using Hibernate's hbm2java?","body":"<p>I am using Hibernate, Maven, and Eclipse (STS build) to build a project.  I'm using hbm.xml files to specify my schema.  I want to use Hibernate's hbm2java to generate my model classes.  I have it working well and generating the kind of code I want.</p>\n\n<p>It runs perfectly from the command line, generating the model code and then building and testing as expected.</p>\n\n<p>However, Eclipse seems unable to handle it.  It will periodically \"lose its mind\" and be unable to resolve very simple imports and classes referenced in my DAO classes, which are hand-coded.  The things it can't find are classes like HibernateUtil.  Ironically, it appears to not have any trouble finding the model classes.</p>\n\n<p>The unresolved classes are in target/classes/blah-blah folder at the end of the run.  So they're apparently getting copied to the right place.</p>\n\n<p>In a \"continuous integration\" environment, is it best to generate the sources once, commit them to my version control, and then disable code gen?  Or is it possible to have the code generated each time, thus ensuring I pick up any database changes without human intervention?</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12807511,"title":"Hibernate collection not updated on child move","body":"<p>I'm inherited a hibernate mapping and am having trouble moving a child node from one parent node to another. Either I get a duplicate reference, or I get an error.</p>\n\n<p>I have locations in a tree. I want to move one leaf node to another leaf position. In code I'm trying to do this:</p>\n\n<pre><code>GeographicLocation oldParent = location.getParent();\nlocation.setParent(newParent);\nnewParent.getChildren().add(location);\noldParent.getChildren().remove(location);\n</code></pre>\n\n<p>Causes:</p>\n\n<pre><code>org.hibernate.ObjectDeletedException: deleted object would be re-saved by cascade (remove deleted object from associations): [com.test.GeographicLocation#11]\n</code></pre>\n\n<p>If I remove the line <code>oldParent.getChildren().remove(location)</code>, the <code>newParent</code> node correctly points to the child, but the <code>oldParent</code> still has a reference to the child as well(!).</p>\n\n<p>Snippets from hibernate config file:</p>\n\n<pre><code>&lt;class name=\"GeographicLocation\" table=\"GeographicLocation\"&gt;\n  &lt;id column=\"GeographicLocationId\" name=\"geographicLocationId\" type=\"java.lang.Long\"&gt;\n    &lt;generator class=\"native\"&gt;\n      &lt;param name=\"sequence\"&gt;GeographicLocationId&lt;/param&gt;\n    &lt;/generator&gt;\n  &lt;/id&gt;\n\n&lt;many-to-one class=\"com.test.GeographicLocation\"\n   foreign-key=\"ParentFK\" name=\"parent\"&gt;\n  &lt;column name=\"parent\"/&gt;\n&lt;/many-to-one&gt;\n\n&lt;bag cascade=\"all,delete-orphan\" inverse=\"true\" lazy=\"false\" name=\"children\"&gt;\n  &lt;key column=\"parent\" not-null=\"true\"/&gt;\n  &lt;one-to-many class=\"com.test.GeographicLocation\"/&gt;\n&lt;/bag&gt;\n</code></pre>\n\n<p>I haven't been using Hibernate very long. My understanding is that the <code>location</code> node, being a managed object, will save itself when modified. Since the hibernate config file specifies <code>cascade=all</code> changes to the collection will also save changes to the child. However, I can't seem to find a legal way to remove the old reference. Any help?</p>\n"},{"tags":["java","hibernate","jpa","jpa-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":12788808,"title":"Changing JPA entity after persist() but before flush() does not work","body":"<p>I'm using JPA 2 with the Hibernate ver. 4.1.7.Final as JPA implementation. I'm also using Spring framework v. 3.1.2.RELEASE to be clear. And here is my problem.</p>\n\n<p>I have written a method to add/update my User entity.</p>\n\n<pre><code>@Override\n@Transactional\npublic void saveUser(UserForm userForm) {\n    User user;\n\n    if (userForm.getId() == null) { // new user\n        user = new User();\n        user.setCreationDate(new Date());\n        entityManager.persist(user); // !!!\n    } else {\n        user = entityManager.find(User.class, userForm.getId());\n    }\n\n    user.setFirstName(userForm.getFirstName());\n    user.setLastName(userForm.getLastName());\n    user.setMiddleName(userForm.getMiddleName());\n\n    user.setEmail(userForm.getEmail());\n\n    user.setRole(entityManager.find(Role.class, 1));//TODO\n\n    user.setLogin(userForm.getLogin());\n    user.setPassword(userForm.getPassword1());\n\n    entityManager.flush();\n}\n</code></pre>\n\n<p>I'm testing addition of user (userForm.getId() == null). And the above code doesn't work, giving error:</p>\n\n<pre><code>javax.persistence.PersistenceException: org.hibernate.exception.ConstraintViolationException: Column 'first_name' cannot be null\nat org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1377)\nat org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1300)\nat org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1306)\nat org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:989)\n...\n</code></pre>\n\n<p><strong>But.</strong> If I move call to persist() to the end before flush() all works fine:</p>\n\n<pre><code>@Override\n@Transactional\npublic void saveUser(UserForm userForm) {\n    User user;\n\n    if (userForm.getId() == null) { // new user\n        user = new User();\n        user.setCreationDate(new Date());\n    } else {\n        user = entityManager.find(User.class, userForm.getId());\n    }\n\n    user.setFirstName(userForm.getFirstName());\n    user.setLastName(userForm.getLastName());\n    user.setMiddleName(userForm.getMiddleName());\n\n    user.setEmail(userForm.getEmail());\n\n    user.setRole(entityManager.find(Role.class, 1));//TODO\n\n    user.setLogin(userForm.getLogin());\n    user.setPassword(userForm.getPassword1());\n\n    entityManager.persist(user);// !!!\n    entityManager.flush();\n}\n</code></pre>\n\n<p>I think what happens is in first (problem) case it tries to store the User object data existed at time of persist call, although the actual save executed during flush() (<strong>upd.</strong> Wrong. It tries to issue sql insert exactly at persist() call). What make me think this way is when I tried to debug I have found that it still tries to insert correct creation_date somewhere inside, but other values are nulls.</p>\n\n<p>But I swear that in my other project I've been working on some years ago this worked just fine, though then I used Oracle instead of MySQL (I don't think this is the reason) and older versions of frameworks.</p>\n\n<p>What could be the problem here? Maybe there is some configuration option for Hibernate affecting this? </p>\n\n<p>Or this is the correct behaviour and my misunderstanding of JPA API?</p>\n\n<p><strong>UPD.</strong> I'm using </p>\n\n<pre><code>@Id\n@GeneratedValue\n@Column(columnDefinition=\"INT\")\nprivate int id;\n</code></pre>\n\n<p>for id field in User entiry. I believe it means generation strategy = AUTO, which is appropriate for mysql auto_increment key.</p>\n"},{"tags":["java","hibernate","gwt","gwt-rpc","c3p0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":12804312,"title":"Java.sql.SQLEXception: Closed Connection Hibernate gets duplicate entities, when reconnected","body":"<p>I am using GWT-RPC to communicate between client and server, and Hibernate and C3P0 for connection pooling. To give an overview of my application, I store data locally on the browser as most of the time the user using the application does not have access to internet. Once the user has access to internet, they click a button to sync to the database. </p>\n\n<p>Sometimes, when the user is inactive for quite some time, I see Closed connection exception, saying could not load an entity. But, once the user refreshes the page and gets a new connection, I see duplicate values in database. Following is the error log:</p>\n\n<pre><code>SEVERE: Exception while dispatching incoming RPC call\ncom.google.gwt.user.server.rpc.UnexpectedException: Service method 'public abstract boolean update(abc.deg.xyzDTO)' threw an unexpected exception: org.hibernate.exception.GenericJDBCException: could not load an entity: [domain.xyz#12147494]\nat com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:378)\nat com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:581)\nat com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:188)\nat com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:224)\nat com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:641)\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)\nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)\nat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\nat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)\nat org.apache.coyote.ajp.AjpAprProcessor.process(AjpAprProcessor.java:197)\nat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\nat org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1824)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\nat java.lang.Thread.run(Unknown Source)\nCaused by: org.hibernate.exception.GenericJDBCException: could not load an entity: [domain.xyz#12147494]\nat org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:103)\nat org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:91)\nat org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1865)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:48)\nat org.hibernate.loader.entity.AbstractEntityLoader.load(AbstractEntityLoader.java:42)\nat org.hibernate.persister.entity.AbstractEntityPersister.load(AbstractEntityPersister.java:2992)\nat org.hibernate.event.def.DefaultLoadEventListener.loadFromDatasource(DefaultLoadEventListener.java:395)\nat org.hibernate.event.def.DefaultLoadEventListener.doLoad(DefaultLoadEventListener.java:375)\nat org.hibernate.event.def.DefaultLoadEventListener.load(DefaultLoadEventListener.java:139)\nat org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:195)\nat org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:103)\nat org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:878)\nat org.hibernate.impl.SessionImpl.get(SessionImpl.java:815)\nat org.hibernate.event.def.DefaultMergeEventListener.entityIsDetached(DefaultMergeEventListener.java:229)\nat org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:120)\nat org.hibernate.event.def.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:53)\nat org.hibernate.impl.SessionImpl.fireMerge(SessionImpl.java:677)\nat org.hibernate.impl.SessionImpl.merge(SessionImpl.java:661)\nat org.hibernate.impl.SessionImpl.merge(SessionImpl.java:665)\nat dao.impl.update(DaoImpl.java:47)\nat server.update(RPCImpl.java:59)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\nat java.lang.reflect.Method.invoke(Unknown Source)\nat com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:562)\n... 21 more\nCaused by: java.sql.SQLException: Closed Connection\nat oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134)\nat oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:179)\nat oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:269)\nat oracle.jdbc.driver.OracleConnection.privatePrepareStatement(OracleConnection.java:982)\nat oracle.jdbc.driver.OracleConnection.prepareStatement(OracleConnection.java:889)\nat com.mchange.v2.c3p0.impl.NewProxyConnection.prepareStatement(NewProxyConnection.java:213)\nat org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:497)\nat org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:415)\nat org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:139)\nat org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1538)\nat org.hibernate.loader.Loader.doQuery(Loader.java:661)\nat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:224)\nat org.hibernate.loader.Loader.loadEntity(Loader.java:1851)\n... 44 more\n</code></pre>\n\n<p>Why do I see the duplicate values, is it because hibernate stores the un-updated values in the cache or something else?   </p>\n\n<p>UPDATE:     </p>\n\n<pre><code>@Override\npublic boolean update(Domain xyz) {\n    Session session = HibernateSessionFactory.getSessionFactory().getCurrentSession(); \n    Transaction tx = session.beginTransaction();\n    Domain instance = (Domain) session.get(Domain.class, xyz.getId());\n    tx.commit();\n    if(instance !=null) {\n        if (instance.getXYZ().equalsIgnoreCase(\"abc\")) {\n            instance.setXYZ(\"abc\");\n        }\n    }           \n    Transaction t = null;\n    Session ses = getSession();\n    try {            \n        t= ses.beginTransaction();\n        ses.merge(instance);\n        t.commit();\n    } catch(HibernateException e) {\n         e.printStackTrace();\n            }\n    return t.wasCommitted();        \n\n}\n</code></pre>\n"},{"tags":["java","hibernate","java-ee","criteria","criteria-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":125,"score":0,"question_id":12804401,"title":"Hibernate Criteria Query ...Adding a new condition","body":"<p>I have a criteria query that works just fine.</p>\n\n<pre><code>Criteria criteria = getSession().createCriteria(getPersistentClass());\ncriteria.add(Restrictions.eq(\"employerId\",employerId))\n        .setFetchMode(\"card\", FetchMode.JOIN)\n        .createCriteria(\"card\")\n        .addOrder(Order.desc(\"cardId\"))\n        .createCriteria(\"salary\")\n        .add(Restrictions.eq(\"salaryType\",SalaryIdentifierType.CONTRACTOR))\n        .add(Restrictions.eq(\"active\",\"YES\"));\n</code></pre>\n\n<p>Now, i need to add another filter(condition) to this criteria. The new filter is joinDate. If the joinDate value has been passed from the Frontend, i will have to add it to this query or else, the filter joinDate should not be added.</p>\n\n<p>I have managed to do this using a disjunction(I know, its weird...but AFAIK, only disjunction gives the the facility to add the filter runtime, only it if is present). I did it like this, but i do not want to use a disjunction here and am looking for anyother options.</p>\n\n<pre><code>Criteria criteria = getSession().createCriteria(getPersistentClass());\n-------------------------------------------------------------------------\nDisjunction disjunctionDate = Restrictions.disjunction(); \n  if(utilDate!=null){\n    disjunctionDate = (Disjunction) disjunctionDate.add(Restrictions.ge(\"startDate\",  utilDate));\n    } \n-----------------------------------------------------------------------\n    criteria.add(Restrictions.eq(\"employerId\",employerId))\n            .setFetchMode(\"card\", FetchMode.JOIN)\n            .createCriteria(\"card\")\n            .addOrder(Order.desc(\"cardId\"))\n            .createCriteria(\"salary\")\n            .add(Restrictions.eq(\"salaryType\",SalaryIdentifierType.CONTRACTOR))\n            .add(Restrictions.eq(\"active\",\"YES\"))\n                .add(disjunctionDate);\n</code></pre>\n\n<p>I have tried just using if condition, like this but does not work(To even make this compile, i had to modify the query format from above to having criteria in every line and semicolon in every line).</p>\n\n<pre><code>Criteria criteria = getSession().createCriteria(getPersistentClass());\n    criteria.add(Restrictions.eq(\"employerId\",employerId));\n    criteria.setFetchMode(\"card\", FetchMode.JOIN);\n    criteria.createCriteria(\"card\");\n    criteria.addOrder(Order.desc(\"cardId\"));\n    criteria.createCriteria(\"salary\");\n    criteria.add(Restrictions.eq(\"salaryType\",SalaryIdentifierType.CONTRACTOR));\n    criteria.add(Restrictions.eq(\"active\",\"YES\"));\n    if(startDate!=null){\n       criteria.add(Restrictions.ge(\"startDate\",startDate));\n     }\n</code></pre>\n\n<p>Any ideas on how to make this work with better options than using disjunction?</p>\n"},{"tags":["java","hibernate","hibernate-criteria"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":94,"score":2,"question_id":12790080,"title":"Criteria eager fetch-joined collection","body":"<p>Let's say Item and Bid are entities: an Item has many Bids. They are mapped in <strong>Hibernate 3.6.10</strong> in a  typical parent/child relationship:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;class name=\"Item\" table=\"ITEM\"&gt;\n  ...\n  &lt;set name=\"bids\" inverse=\"true\"&gt;\n    &lt;key column=\"ITEM_ID\"/&gt;\n    &lt;one-to-many class=\"Bid\"/&gt;\n  &lt;/set&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>How can I avoid n+1 selects when trying to access the bids of each Item after this query is executed?</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;Item&gt; items = session.createCriteria(Item.class)\n                        .createAlias(\"bids\", \"b\").\n                        .add(Restrictions.gt(\"b.amount\", 100)).\n                        .list();\n</code></pre>\n\n<p><strong>Note</strong> I need an <em>eager fetching</em> for bids but <strong><em>with a further restriction on the collection</em></strong> (b.amount > 100)</p>\n\n<p>I've tried the following unsuccessfully:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>List&lt;Item&gt; items = session.createCriteria(Item.class)\n                        .setFetchMode(\"bids\", FetchMode.JOIN).\n                        .createAlias(\"bids\", \"b\").\n                        .add(Restrictions.gt(\"b.amount\", 100)).\n                        .list();                        \n\nList&lt;Item&gt; items = session.createCriteria(Item.class)\n                        .createCriteria(\"bids\")\n                        .add(Restrictions.gt(\"amount\", 100)).\n                        .list();                        \n</code></pre>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12607841,"title":"JPQL and Inheritance","body":"<p>Lets supose that I have 3 abstract super classes: <code>SuperA</code>, <code>SuperB</code> and <code>SuperC</code>.\nLets supose that each of theses super classes had a lot of more specific implementations, and all the superclasses are annotated with <code>@Inheritance(strategy = InheritanceType.JOINED)</code>.</p>\n\n<p>More specific: </p>\n\n<ul>\n<li><code>Aa</code> &lt;- <code>SuperA</code> and has a List of <code>SuperB</code> (the <code>bbs</code> property); </li>\n<li><code>Bb</code> &lt;- <code>SuperB</code> and has a List of <code>SuperC</code> (the <code>ccs</code> property); </li>\n<li><code>Cc</code> &lt;- <code>SuperC</code> and has a <code>foo</code> property. </li>\n</ul>\n\n<p>Then, when I try a query like the following, I got an error saying that it could not find the property <code>foo</code> in the type <code>SuperC</code>. <code>Bb</code> has a list of the abstract type, and I can't change that. So, I do not know how to make the query works.</p>\n\n<pre><code>select a from Aa a left outer join a.bbs b where b.ccs.foo = :foo\n</code></pre>\n\n<p>Any tip will help. Thanks in advance.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>BTW: the exception: </p>\n\n<p><code>org.hibernate.exception.SQLGrammarException: Unknown column 'cc3_1_.foo' in 'where clause'</code> </p>\n\n<hr>\n\n<p>Edit 2:</p>\n\n<p>I look for JPA docs, and found <a href=\"http://wiki.eclipse.org/EclipseLink/Development/JPA/QueryDownCast\" rel=\"nofollow\">something</a> that could work, if I'm not using Hibernate. </p>\n\n<hr>\n\n<p>Edit 3:</p>\n\n<p>I change it to use two SQL's. First, I find the id of the C based on the <code>foo</code> property, then I just do the query comparing with the id.</p>\n\n<p>The problem here, is that I have to do 2 SQL's for every time I want this... but, at least it works.</p>\n"},{"tags":["java","hibernate","foreign-keys"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12795641,"title":"Hibernate query one-to-one relationship","body":"<p>I am new to hibernate I created the tables and mappings and I am listing all the rows in my table using the following code. </p>\n\n<pre><code>List places = session.createQuery(\"FROM Place\").list();\nfor (Iterator iterator = places.iterator(); iterator.hasNext();) {\n   Place place = (Place) iterator.next();\n   System.out.println(\"-\" + place.getName());\n}\n</code></pre>\n\n<p>This code works fine however, the PLACE table has a one-to-one relationship with ADDRESS table, and this code returns null values for all the rows in the ADDRESS table and prints out:</p>\n\n<pre><code>-null\n-null\n-null\n-343\n-223\n-122\n</code></pre>\n\n<p>I only want the rows from the PLACES table. How can I manage this?</p>\n\n<p>Important Note: After Pierre-Henri Toussaint's answer I noticed the generated sql. Hibernate first generates a select query from address, then a select query from place.(When I change the constraint value to false it generates a query for each row for the address table)</p>\n\n<p>Address.hbm.xml:</p>\n\n<pre><code>&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.places.general.Address\" table=\"ADDRESS\" schema=\"dbo\"&gt;\n        &lt;id name=\"placeId\" type=\"java.lang.Integer\"&gt;\n            &lt;column name=\"PLACE_ID\" /&gt;\n            &lt;generator class=\"foreign\"&gt;\n                &lt;param name=\"property\"&gt;place&lt;/param&gt;\n            &lt;/generator&gt;\n        &lt;/id&gt;\n        &lt;one-to-one name=\"place\" class=\"com.places.general.Place\"\n                    constrained=\"true\"&gt;\n        &lt;/one-to-one&gt;\n        &lt;property column=\"PLACE_ADDRESS\" length=\"250\" name=\"placeAddress\" type=\"java.lang.String\"/&gt;\n        &lt;property column=\"PHONE\" length=\"50\" name=\"phone\" type=\"java.lang.String\"/&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Place.hbm.xml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \"-//Hibernate/Hibernate Mapping DTD 3.0//EN\" \"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping&gt;\n    &lt;class name=\"com.places.general.Place\" table=\"PLACES\" schema=\"dbo\"&gt;\n        &lt;id column=\"ID\" name=\"id\" type=\"java.lang.Integer\"&gt;\n            &lt;generator class=\"identity\"/&gt;\n        &lt;/id&gt;        \n        &lt;property column=\"NAME\" length=\"100\" name=\"name\" not-null=\"true\" type=\"java.lang.String\"/&gt;\n        &lt;property column=\"DETAILS\" length=\"200\" name=\"details\" type=\"java.lang.String\"/&gt;\n    &lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n</code></pre>\n\n<p>Place.java:</p>\n\n<pre><code>import java.io.Serializable;\n\npublic class Place implements Serializable{\n    private Integer id;\n    private String name;\n    private String details;\n\n    public Place() {\n    }\n\n    public Place(String name, String details) {\n        this.name = name;\n        this. details = details;\n    }\n\n    public Integer getId() {\n        return id;\n    }\n\n    public void setId(Integer id) {\n        this.id = id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getDetails() {\n        return details;\n    }\n\n    public void setDetails(String details) {\n        this. details = details;\n    }\n}\n</code></pre>\n"},{"tags":["spring","hibernate","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12725104,"title":"Spring + Hibernate: How to implement Entites and DAOs","body":"<p>I'm new both to spring and hibernate so take that into consideration in your answer.</p>\n\n<p>I have a many-to-many relationship were the link-table must also contain information. I will try to solve this according to:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/10294338/many-to-many-hibernate-mapping-for-additional-property-in-the-join-table\">Many to Many Hibernate Mapping for additional property in the join table</a></p>\n\n<p>My Question is related to:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/12685653/hibernate-custom-code-on-insert-update\">hibernate: Custom code on insert / update</a></p>\n\n<p>But I just repeat it here so no clicking on link is required:</p>\n\n<p>Lets say we have colors. A user can create a Mixture of n colors and store that mixture in the database. Later if a user searches for color \"blue\" all Mixtures containing blue should be displayed.</p>\n\n<p>Business rule is that any color should only be in the database once. So if a new mixture is inserted, it must first be checked if all the colors are already in the database and if yes that color should be reused (referenced) and if not a new one should be created.</p>\n\n<p>If a mixture is changed say \"blue\" is replaced with \"red\", the behavior must be that the initial \"blue\" remains untouched and the system checks if \"red\" exists and either reuses it or creates it and then adds it to the mixture.</p>\n\n<p>The important part is that \"Colors\" are managed by the system and an existing color must never change.\"red\" will always be \"red\" and should never be changed to \"blue\". Since I'm new to Hibernate and Spring I'm kind of lost on how to implement this rule and at what level.IMHO I would put that logic at the lowest level possible so that it doesn't break if you (the developer) forgets to check it. does that make sense? Better ideas or suggestions?</p>\n"},{"tags":["java","hibernate","spring","jpa","java-ee"],"answer_count":2,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":26824,"score":10,"question_id":474159,"title":"Hibernate second level cache with Spring","body":"<p>I'm using Spring + JPA + Hibernate. I'm trying to enable Hibernate's second level cache. In my Spring's <code>applicationContext.xml</code> I have:</p>\n\n<pre><code>&lt;prop key=\"hibernate.cache.provider_class\"&gt;net.sf.ehcache.hibernate.SingletonEhCacheProvider&lt;/prop&gt;\n&lt;prop key=\"hibernate.cache.provider_configuration_file_resource_path\"&gt;/ehcache.xml&lt;/prop&gt;\n</code></pre>\n\n<p>When I run I get the error:</p>\n\n<pre><code>Caused by: org.hibernate.HibernateException: Could not instantiate cache implementation\n     at org.hibernate.cache.CacheFactory.createCache(CacheFactory.java:64)\n\nCaused by: org.hibernate.cache.NoCachingEnabledException: Second-level cache is not enabled for usage [hibernate.cache.use_second_level_cache | hibernate.cache.use_query_cache]\n     at org.hibernate.cache.NoCacheProvider.buildCache(NoCacheProvider.java:21) \n</code></pre>\n\n<p>So it's complain I don't have second level cache enabled. I attempt to enable it by adding to my <code>applicationContext.xml</code>:</p>\n\n<pre><code>&lt;prop key=\"hibernate.cache.use_second_level_cache\"&gt;true&lt;/prop&gt;\n</code></pre>\n\n<p>But still no joy. I also tried adding this to my ehcache.xml:</p>\n\n<pre><code>&lt;property name=\"hibernate.cache.use_second_level_cache\"&gt;true&lt;/property&gt;\n</code></pre>\n\n<p>But it still doesn't work. Changing the <code>provider_class</code> to <code>org.hibernate.cache.EhCacheProvider</code> doesn't help either:</p>\n\n<pre><code>&lt;prop key=\"hibernate.cache.provider_class\"&gt;org.hibernate.cache.EhCacheProvider&lt;/prop&gt;\n</code></pre>\n\n<p>My entity classes are annotated to use caching</p>\n\n<pre><code>@Cache(usage=CacheConcurrencyStrategy.READ_ONLY)\n</code></pre>\n\n<p>So, how do I enable second level cache?</p>\n\n<p><strong>Edit:</strong>  This is under the bean:</p>\n\n<pre><code>&lt;bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalEntityManagerFactoryBean\"&gt;\n</code></pre>\n\n<p><strong>Resolved:</strong> Since I'm using <code>LocalEntityManagerFactoryBean</code> it gets its settings from <code>META-INF/persistence.xml</code>. My settings in <code>applicationContext.xml</code> weren't even being read.</p>\n"},{"tags":["java","spring","hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12805285,"title":"Spring Hibernate error","body":"<p>I have the following code that works fine in my spring.xml...</p>\n\n<pre><code>&lt;beans:bean id=\"sessionFactory\"\n        class=\"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean\"&gt;\n        &lt;beans:property name=\"annotatedClasses\"&gt;\n            &lt;beans:list&gt;\n                &lt;beans:value&gt;org.assessme.com.entity.User&lt;/beans:value&gt;\n            &lt;/beans:list&gt;\n        &lt;/beans:property&gt;\n        &lt;beans:property name=\"dataSource\" ref=\"dataSource\" /&gt;\n                &lt;beans:property name=\"packagesToScan\"\n        value=\"org.assessme.com.entity.*\" /&gt;\n        &lt;beans:property name=\"hibernateProperties\"&gt;\n            &lt;beans:props&gt;\n                &lt;beans:prop key=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect\n                &lt;/beans:prop&gt;\n                &lt;beans:prop key=\"hibernate.transaction.factory_class\"&gt;org.hibernate.transaction.JDBCTransactionFactory\n                &lt;/beans:prop&gt;\n                &lt;beans:prop key=\"hibernate.show_sql\"&gt;true&lt;/beans:prop&gt;\n                &lt;beans:prop key=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/beans:prop&gt;\n            &lt;/beans:props&gt;\n        &lt;/beans:property&gt;\n    &lt;/beans:bean&gt;\n</code></pre>\n\n<p>I only got the User object working first as you can see from the beans:list.</p>\n\n<p>All my entities are in the same folder, as shown below </p>\n\n<p><img src=\"http://i.stack.imgur.com/ccbwA.png\" alt=\"entities\"></p>\n\n<p>The problem is, when I add another class to this list, such as...</p>\n\n<p>org.assessme.com.entity.Campaign</p>\n\n<p>I get the following exception when I start Tomcat...</p>\n\n<pre><code> Caused by: org.hibernate.AnnotationException: No identifier specified for entity: org.assessme.com.entity.Campaign\n    at org.hibernate.cfg.InheritanceState.determineDefaultAccessType(InheritanceState.java:272)\n    at org.hibernate.cfg.InheritanceState.getElementsToProcess(InheritanceState.java:227)\n    at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:712)\n    at org.hibernate.cfg.AnnotationConfiguration.processArtifactsOfType(AnnotationConfiguration.java:636)\n    at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:359)\n    at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1206)\n    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:717)\n    at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)\n    ... 132 more\n</code></pre>\n\n<p>Entity code below if required...</p>\n\n<p>Campaign.java</p>\n\n<pre><code>package org.assessme.com.entity;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name = \"campaigns\")\npublic class Campaign {\n\n    @Column(name = \"name\")\n    private String name;\n\n    @Column(name = \"id\")\n    private String id;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getId() {\n        return id;\n    }\n\n    public void setId(String id) {\n        this.id = id;\n    }\n}\n</code></pre>\n\n<p>User.java</p>\n\n<pre><code>package org.assessme.com.entity;\n\nimport javax.persistence.Column;\nimport javax.persistence.Entity;\nimport javax.persistence.GeneratedValue;\nimport javax.persistence.GenerationType;\nimport javax.persistence.Id;\nimport javax.persistence.Table;\n\n@Entity\n@Table(name = \"users\")\npublic class User {\n\n    @Column(name = \"firstName\")\n    private String firstName;\n\n    @Column(name = \"lastName\")\n    private String lastName;\n\n    @Column(name = \"email\")\n    private String email;\n\n    @Column(name = \"password\")\n    private String password;\n\n    @Column(name = \"username\")\n    private String username;\n\n    @Column(name = \"access\")\n    private Integer access;\n\n    @Id\n    @GeneratedValue(strategy=GenerationType.AUTO)\n    @Column(name = \"id\")\n    private long id;\n\n\n    public String getFirstName() {\n        return firstName;\n    }\n    public void setFirstName(String firstName) {\n        this.firstName = firstName;\n    }\n    public String getLastName() {\n        return lastName;\n    }\n    public void setLastName(String lastName) {\n        this.lastName = lastName;\n    }\n    public String getEmail() {\n        return email;\n    }\n    public void setEmail(String email) {\n        this.email = email;\n    }\n    public long getId() {\n        return id;\n    }\n    public void setId(long id) {\n        this.id = id;\n    }\n    public String getPassword() {\n        return password;\n    }\n    public void setPassword(String password) {\n        this.password = password;\n    }\n    public String getUsername() {\n        return username;\n    }\n    public void setUsername(String username) {\n        this.username = username;\n    }\n    public Integer getAccess() {\n        return access;\n    }\n    public void setAccess(Integer access) {\n        this.access = access;\n    }\n}\n</code></pre>\n"},{"tags":["java","sql","spring","hibernate"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12800503,"title":"Fail silently on constraint violation","body":"<p>I have entity <code>Foo</code>, which maps to sql table with some unique constraints. Thus saving <code>Foo</code> may fail. I am using <code>FooDao</code> to save <code>Foo</code>:</p>\n\n<pre><code>@Repository\npublic class FooDao\n{\n  @Autowired\n  private SessionFactory sessionFactory;\n\n  @Transactional\n  @Override\n   public void add(Foo item) {\n    sessionFactory.save(item);\n   }\n}\n</code></pre>\n\n<p>when I call method <code>FooDao#add(Foo)</code> it may fail for two reasons: either because of unique constraint violation (in this case, I know how to handle the problem) or because of some other problem (in this I probably should propagate the exception). How do I distinguish between those two situations?</p>\n\n<p>I could add method <code>find(Foo item)</code> to <code>FooDao</code> and check, whether something like item, which I was trying to add is database. But this would require additional select from database and I am a bit worried about this.</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12805172,"title":"Issue in hibernate objects","body":"<p>I need your help to solve the below issue.</p>\n\n<p>I am running j2ee application and I have two tables, let say table1(ID,col1-default value is -2) and table2(ID,col2), the value of col1 in table will be ID of table2. which means col1(table1) is table2 reference. with these i have 3 methods will use above tables,</p>\n\n<p>In Method 1 : we are updating \"col1\" with table2 ID and committing the object(at least 10 records per transcation) like below</p>\n\n<pre><code>session.connection.commitI();\n</code></pre>\n\n<p>In Method 2 : I am doing some read operations(No save process)</p>\n\n<p>In Method 3 : Same reading process like Method 2(No save process)</p>\n\n<p>Actual Issue is :</p>\n\n<p>When i try to access the col1 via hibernate pojo objects(i.e. table1) like <code>table1.getCol1()</code>; i am getting default value as \"-2\".</p>\n\n<p>This issue is not occuring for all times. I am getting as intermittent issue.  Actually i am not able to reproduce but some times i am able to.</p>\n\n<p>I kept debug logs in each methods and  i watched closely in server, then i found the below one,</p>\n\n<pre><code>&lt;Stdout&gt; &lt;BEA-000000&gt; &lt;2012-10-08 02:14:08,433  WARN [[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'] (com.test) - Method name : Method 2 : checking table1.getCol1() value for ID 4 : 100001\n\n&lt;Stdout&gt; &lt;BEA-000000&gt; &lt;2012-10-08 02:14:08,433  WARN [[ACTIVE] ExecuteThread: '7' for queue: 'weblogic.kernel.Default (self-tuning)'] (com.test) - Method name : Method 3 : checking table1.getCol1() for ID 4 value : -2\n</code></pre>\n\n<p>Value of col1 in table1 records will restored to old value for only one record. I am not fix this intermiddate issue. Please help me.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["java","hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12805090,"title":"Hibernate max() query","body":"<p>I need to select a records where extId == parameter i give and from those records i want the latest by date (<code>createDate</code> property). Im trying this : </p>\n\n<pre><code>select r from Record r where r.extId=:eid and r.createDate=(select max(r.createDate) from r where r.id=r.id)\n</code></pre>\n\n<p>simply returns latest record. Help me please.</p>\n"},{"tags":["spring","hibernate","jpa","spring-mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":140,"score":0,"question_id":12493780,"title":"How to insert form inputs into multiple tables using Spring MVC and JPA?","body":"<p>I have to insert product details. I have multiple bean classes which are generated from tables but all the fields are in a single html form. How could I map those form elements to different bean classes and how could I get those form elements in controller?.</p>\n\n<p>My Bean classes are </p>\n\n<pre><code>Category\n    private Long id;\n    private String description;\n    private String name;\n\nProductAttribute \n    private String description;\n    private String name;\n\nCategoryAttributeMapping\n    private Category category;\n    private ProductAttribute productAttribute ;\n</code></pre>\n\n<p>Could any one help me?</p>\n"},{"tags":["hibernate","caching","lazy-loading","second-level-cache","hazelcast"],"answer_count":1,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1047,"score":3,"question_id":5474776,"title":"Hibernate lazy loading and Hazelcast","body":"<p>we are using Hazelcast as Hibernate 2nd level cache now for a while but are recognizing long delays in storing and reading data when using more than one node. </p>\n\n<p>We make intensive use of composed objects and @OneToMany relations, and to increase  performance we decided to load these composed objects or collections via Hibernate lazy loading. We also implemented DataSerializable to speed up Hazelcast serialization, as it is stated in the Hazelcast documentation. But logging the use of the writeData/readData methods showed us that they were not used actually!</p>\n\n<p>It is unclear for us now, if the Hibernate Proxy (which is used via lazy loading) prevents the use of DataSerializable methods (because the proxy itself might (?) not implement the interface) and - even more important - if Hazelcast supports lazy loading  at all - and how!</p>\n"},{"tags":["spring","hibernate","jsp","jstl"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12803674,"title":"Spring form tags for Radio button and Text fields","body":"<p>I have a jsp where I am using the follwoing code:</p>\n\n<pre><code>&lt;c:forEach items=\"${location.revRecov}\" var=\"item\" varStatus=\"loop\"&gt;    \n&lt;tr&gt; &lt;td&gt;Package&lt;form:radiobutton path=\"revRecov[loop.index].trkType\" /&gt;&lt;/td&gt;\n     &lt;td&gt;Pallet&lt;form:radiobutton path=\"revRecov[loop.index].trkType\" /&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;\n    &lt;td&gt;Max Length: \n    &lt;form:input path=\"revRecov[loop.index].maxLength\" size=\"15\" maxlength=\"14\" /&gt;inches&lt;/td&gt;\n    &lt;td&gt;Min Length: \n    &lt;form:input path=\"revRecov[loop.index].minLength\" size=\"15\" maxlength=\"14\" /&gt;inches&lt;/td&gt;    \n&lt;/tr&gt;&lt;tr&gt;\n    &lt;td&gt;Max Width: \n    &lt;form:input path=\"revRecov[loop.index].maxWidth\" size=\"15\" maxlength=\"14\" /&gt;inches&lt;/td&gt;\n    &lt;td&gt;Min Width: \n    &lt;form:input path=\"revRecov[loop.index].minWidth\" size=\"15\" maxlength=\"14\" /&gt;inches&lt;/td&gt;\n&lt;/tr&gt;&lt;tr&gt;\n    &lt;td&gt;Max Height: \n    &lt;form:input path=\"revRecov[loop.index].maxHeight\" size=\"15\" maxlength=\"14\" /&gt;inches&lt;/td&gt;    \n    &lt;td&gt;Min Height: \n    &lt;form:input path=\"revRecov[loop.index].minHeight\" size=\"15\" maxlength=\"14\" /&gt;inches&lt;/td&gt;\n&lt;/tr&gt;&lt;tr&gt;\n    &lt;td&gt;Max Weight: \n    &lt;form:input path=\"revRecov[loop.index].maxWeight\" size=\"15\" maxlength=\"14\" /&gt;lb&lt;/td&gt;    \n    &lt;td&gt;Min Weight: \n    &lt;form:input path=\"revRecov[loop.index].minWeight\" size=\"15\" maxlength=\"14\" /&gt;lb&lt;/td&gt;    \n&lt;/tr&gt;\n&lt;/c:foreach&gt;\n</code></pre>\n\n<p>but, the above code doesn't work as I wish to have them.</p>\n\n<p>whatever the index is I want to show both the radio buttons. if first is selected show the rows belongs to that index and so on. How can I achieve it? Any suggestion is appreciated!</p>\n"},{"tags":["hibernate","jboss","hibernate-envers"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":114,"score":0,"question_id":12802800,"title":"How to configure JBoss 7.1.1 with hibernate 4.1 and Envers 4.1?","body":"<p>I'm having a problem in my project. We are using JBoss7.1.1 and we want to use envers in version 4.1. Envers in version 4.1 requires Hibernate in version 4.1. Unfortunately jboss 7.1.1 contains older hibernate and Envers modules. </p>\n\n<p>I have 2 options:</p>\n\n<p>Change modules in JBoss (put there new envers &amp; hibernate). The problem is every jboss that will run this application will have to be \"tuned\" for that project (a bit painfull).</p>\n\n<p>Or:</p>\n\n<p>Exclude JBoss modules and use libs from WEB-INF/lib inside war. \nI excluded the modules using:</p>\n\n<pre><code>&lt;jboss-deployment-structure&gt;\n    &lt;ear-subdeployments-isolated&gt;true&lt;/ear-subdeployments-isolated&gt;\n    &lt;deployment&gt;\n        &lt;!-- Exclusions allow you to prevent the server from automatically adding some dependencies     --&gt;\n        &lt;exclusions&gt;\n            &lt;module name=\"org.hibernate\"/&gt;\n            &lt;module name=\"org.hibernate.envers\"/&gt;\n        &lt;/exclusions&gt;\n    &lt;/deployment&gt;\n&lt;/jboss-deployment-structure&gt;\n</code></pre>\n\n<p>I've changed dependencies in maven from provided to compile and it should work, right?</p>\n\n<p>But now I'm getting this exception:</p>\n\n<pre><code>Caused by: java.lang.IllegalArgumentException: interface org.hibernate.annotations.Columns is not visible from class loader\n    at java.lang.reflect.Proxy.getProxyClass(Proxy.java:353) [classes.jar:1.6.0_35]\n    at org.hibernate.annotations.common.annotationfactory.AnnotationFactory.create(AnnotationFactory.java:46)\n    at org.hibernate.cfg.annotations.reflection.JPAOverridenAnnotationReader.buildColumns(JPAOverridenAnnotationReader.java:1383)\n</code></pre>\n\n<p>Any ideas on how to fix it?</p>\n"},{"tags":["hibernate"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12803575,"title":"Hibernate issues with Postgres and MySql","body":"<p>Is there any issues with Hibernate's save method which saved object in java for Postgres DB but not for MySql DB</p>\n"},{"tags":["java","performance","hibernate","java-ee","glassfish"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":262,"score":4,"question_id":12661103,"title":"Very low performance with Glassfish 3.1.2 and Java EE + Hibernate","body":"<p>I faced with very very low performance of Java EE (EJB + JSF) application and Hibernate(3.6.8.Final and 4.1.7.Final) on Glassfish 3.1.2. Sending about 300 select queries takes about 20 seconds. This is unacceptable.</p>\n\n<p>I have exactly the same application deployed on JBoss and TomEE. There, the same 300 select queries takes about 1,5 second.</p>\n\n<p>I found in google some answers that maybe <code>hibernate.show_sql</code> is <code>true</code> or <code>hibernate.hbm2ddl</code> make application soo slow. But it is not true. I turned off <code>hibernate.show_sql</code> but is doesn't matter. Moreover, these options are true in the JBoss and TomEE versions and it works over 10 times faster!\nI thought that this is the issue between Glasfish and Hibernate. But I have the next application with the same business logic, the same DAO with EntityManager provided by Hibernate but configurated with Spring. And the performance is great. It is weird, isn't it?</p>\n\n<p><code>persistence.xml</code> from the defect version:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence xmlns=\"http://java.sun.com/xml/ns/persistence\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.0\"\n  xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence\n  http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd\"&gt;\n\n   &lt;persistence-unit name=\"jee_project\" transaction-type=\"JTA\"&gt;\n      &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n      &lt;jta-data-source&gt;jdbc/PostgreSQL&lt;/jta-data-source&gt;\n      &lt;properties&gt;\n         &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.PostgreSQLDialect\"/&gt;\n         &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"update\"/&gt;\n         &lt;property name=\"hibernate.show_sql\" value=\"false\"/&gt;\n         &lt;property name=\"current_session_context_class\" value=\"thread\"/&gt;\n      &lt;/properties&gt;\n   &lt;/persistence-unit&gt;\n\n&lt;/persistence&gt;\n</code></pre>\n\n<p>Glassfish JDBC configuration</p>\n\n<pre><code>&lt;jdbc-connection-pool driver-classname=\"\" datasource-classname=\"org.postgresql.ds.PGConnectionPoolDataSource\" res-type=\"javax.sql.ConnectionPoolDataSource\" description=\"\" name=\"PostgreSQLPool\"&gt;\n      &lt;property name=\"User\" value=\"postgresql\"&gt;&lt;/property&gt;\n      &lt;property name=\"DatabaseName\" value=\"qazxsw\"&gt;&lt;/property&gt;\n      &lt;property name=\"LogLevel\" value=\"0\"&gt;&lt;/property&gt;\n      &lt;property name=\"Password\" value=\"1234\"&gt;&lt;/property&gt;\n      &lt;property name=\"ServerName\" value=\"localhost\"&gt;&lt;/property&gt;\n      &lt;property name=\"Ssl\" value=\"false\"&gt;&lt;/property&gt;\n      &lt;property name=\"ProtocolVersion\" value=\"0\"&gt;&lt;/property&gt;\n      &lt;property name=\"TcpKeepAlive\" value=\"false\"&gt;&lt;/property&gt;\n      &lt;property name=\"SocketTimeout\" value=\"0\"&gt;&lt;/property&gt;\n      &lt;property name=\"PortNumber\" value=\"5432\"&gt;&lt;/property&gt;\n      &lt;property name=\"LoginTimeout\" value=\"0\"&gt;&lt;/property&gt;\n      &lt;property name=\"UnknownLength\" value=\"2147483647\"&gt;&lt;/property&gt;\n      &lt;property name=\"PrepareThreshold\" value=\"5\"&gt;&lt;/property&gt;\n    &lt;/jdbc-connection-pool&gt;\n    &lt;jdbc-resource pool-name=\"PostgreSQLPool\" description=\"\" jndi-name=\"jdbc/PostgreSQL__pm\"&gt;&lt;/jdbc-resource&gt;\n    &lt;jdbc-resource pool-name=\"PostgreSQLPool\" description=\"\" jndi-name=\"jdbc/PostgreSQL__nontx\"&gt;&lt;/jdbc-resource&gt;\n</code></pre>\n"},{"tags":["hibernate","jpa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":380,"score":0,"question_id":11107208,"title":"No Persistence provider for EntityManager Hibernate","body":"<p>I know this was asked many times before but it's the first time I can't resolve this exception</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;persistence version=\"2.0\"\n    xmlns=\"http://java.sun.com/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd\"&gt;\n    &lt;persistence-unit name=\"HatifimJPA\" transaction-type=\"RESOURCE_LOCAL\"&gt;\n        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;\n        &lt;class&gt;entities.HatUser&lt;/class&gt;\n        &lt;properties&gt;\n            &lt;property name=\"hibernate.connection.driver_class\" value=\"oracle.jdbc.driver.OracleDriver\" /&gt;\n            &lt;property name=\"hibernate.connection.username\" value=\"Benny\" /&gt;\n            &lt;property name=\"hibernate.connection.password\" value=\"oracle\" /&gt;\n            &lt;property name=\"hibernate.connection.url\" value=\"jdbc:oracle:thin:@localhost:1521:xe\" /&gt;\n            &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.OracleDialect\" /&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n\n<p>Exception:</p>\n\n<pre><code>Exception in thread \"main\" javax.persistence.PersistenceException: No Persistence provider for EntityManager named HatifimJPA\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:69)\n    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)\n    at testing.TestClass.main(TestClass.java:16)\n</code></pre>\n\n<p>That was my persistence.xml which resides in src/META-INF.\nThe only difference is I'm trying to get the EntityManager in a public void main(...) { ... }, but I don't recall having a problem doing that as well. \nI have no idea what could be the problem.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["hibernate","hibernate-envers","post-update"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12800540,"title":"Hibernate envers - How to store only updated values","body":"<p>I am using Hibernate Envers for my Auditing. Post-update and post-insert works fine.</p>\n\n<p>I have a requirement where I need to audit only the updated columns in the audit table (e.g. employee_aud).\nBy default envers will insert the entire persisted entity in to the audit table.</p>\n\n<p>I need to insert values only which are updated.</p>\n\n<p>Is there any possibility to do this ?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Cheers !</p>\n"},{"tags":["hibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12763378,"title":"Creating hibernate mappings- beginner qn","body":"<p>I have the following tables, taken from <a href=\"http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#db_schema_users_authorities\" rel=\"nofollow\">here</a> (as part of the Spring Security model):</p>\n\n<pre><code>  create table users(\n      username varchar_ignorecase(50) not null primary key,\n      password varchar_ignorecase(50) not null,\n      enabled boolean not null);\n\n  create table authorities (\n      username varchar_ignorecase(50) not null,\n      authority varchar_ignorecase(50) not null,\n      constraint fk_authorities_users foreign key(username) references users(username));\n\n  create unique index ix_auth_username on authorities (username,authority);\n</code></pre>\n\n<p>I'm really new to hiberanate and am not sure how to map these tables to hibernate mappings in the xml file. How to map foreign keys? How to map indexes? I'm aware that every table has a primary key, but in this case, the authorities table doesn't. So that means that there is no <code>&lt;id&gt;</code> colum in the hibernate mappings?</p>\n\n<p>Here's what I've got so far:</p>\n\n<pre><code>&lt;class name=\"com.foo.beans.User\" table=\"users\"&gt;\n    &lt;id name=\"username\" column=\"username\"/&gt;\n    &lt;property name=\"password\" column=\"password\"/&gt;\n    &lt;property name=\"enabled\" column=\"enabled\"/&gt;\n&lt;/class&gt;\n\n&lt;class name=\"com.foo.beans.Authority\" table=\"authorities\"&gt;\n    &lt;composite-id name=\"ix_auth_username\"&gt;\n        &lt;key-property name=\"username\" column=\"username\" /&gt;\n        &lt;key-property name=\"authority\" column=\"authority\" /&gt;\n    &lt;/composite-id&gt;\n&lt;/class&gt;\n</code></pre>\n\n<p>Any idea what I'm doing wrong? Thanks!</p>\n"},{"tags":["java","spring","hibernate","merge","many-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12776262,"title":"Hibernate: merge with many-to-many results in StackOverflowError","body":"<p>I have a many-to-many relationship were the link table has an additional field. Hence the relationship is done with 2 one-to-many relations according to below tutorial:</p>\n\n<p><a href=\"http://www.mkyong.com/hibernate/hibernate-many-to-many-example-join-table-extra-column-annotation/comment-page-1/#comment-122181\" rel=\"nofollow\">http://www.mkyong.com/hibernate/hibernate-many-to-many-example-join-table-extra-column-annotation/comment-page-1/#comment-122181</a></p>\n\n<p>I have the 2 entities, a third entity which defined the link table and consist of an @Embeddable ID field.</p>\n\n<p>The relationship is defined as:</p>\n\n<pre><code>@OneToMany(fetch = FetchType.LAZY, mappedBy = \"pk.compound\", cascade = CascadeType.ALL)\n\n@OneToMany(fetch = FetchType.LAZY, mappedBy = \"pk.structure\", cascade = CascadeType.ALL)\n</code></pre>\n\n<p>were pk = the @Embeddable ID field. Insert and deleting works fine however when I call</p>\n\n<pre><code>session.merge(compound);\n</code></pre>\n\n<p>I get a StackOverflowError and log shows that hibernate is making tons of select statements. Note that database contains exactly 1 association, eg. 1 compound containing 2 structures. It looks like hibernate gets into a endless loop.</p>\n\n<p>I've seen this solution also on <a href=\"http://giannigar.wordpress.com/2009/09/04/mapping-a-many-to-many-join-table-with-extra-column-using-jpa/\" rel=\"nofollow\">http://giannigar.wordpress.com/2009/09/04/mapping-a-many-to-many-join-table-with-extra-column-using-jpa/</a> but how do you do updated with this?</p>\n"},{"tags":["java","hibernate","hibernate-mapping","hibernate-annotations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12796459,"title":"Hibernate OneToOne relationship","body":"<p>I have two persistence entity: <code>User</code> and <code>UserDetail</code>. They have one-to-one relationship. I use hibernate annotations. But I am getting in my database several objects of user information for one same user. Apparently my knowledge of Hibernate annotations are not so good to solve this problem.</p>\n\n<p><strong>User</strong> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"USER\")\npublic class User {\n\n   @Id\n   @GeneratedValue\n   @Column(name = \"ID\")\n   private Long id; \n\n   @Column(name = \"NAME\")\n   private String name; \n\n   @Column(name = \"PASSWORD\")\n   private String password;\n\n   @OneToOne(mappedBy = \"user\", cascade = CascadeType.ALL)\n   private UserDetail userDetail;\n\n   // setters and getters\n\n}\n</code></pre>\n\n<p><strong>UserDetail</strong> class:</p>\n\n<pre><code>@Entity\n@Table(name = \"USER_DETAIL\")\npublic class UserDetail {  \n\n   @OneToOne\n   @JoinColumn(name = \"USER_ID\")\n   private User user;\n\n   // other fields\n\n}\n</code></pre>\n\n<p>I use this in my code as follows:</p>\n\n<pre><code>UserDetail userDetail = new UserDetail();\nuserDetail.setInfo(info);\nuserDetail.setUser(seventhUser);\nhibernateTemplate.saveOrUpdate(userDetail);\n</code></pre>\n\n<p>And everything works properly. Here's what my table <code>USER_DETAIL</code>:\n<img src=\"http://i.stack.imgur.com/0ogvm.jpg\" alt=\"USER_DETAIL table\"></p>\n\n<p>But when I try to change user information, I get an incorrect behavior. I get following table after I again set user information:    </p>\n\n<pre><code>UserDetail newUserDetail = new UserDetail();\nnewUserDetail.setInfo(newInfo);\nnewUserDetail.setUser(seventhUser);\nhibernateTemplate.saveOrUpdate(newUserDetail);\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/6gUhU.jpg\" alt=\"enter image description here\"></p>\n\n<p>Why the same two objects of information correspond to one user?? I have One-To-One relationship. How can I avoid this? What am I doing wrong?</p>\n"},{"tags":["java","eclipse","hibernate","java-ee","eclipse-plugin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":426,"score":0,"question_id":10414841,"title":"install hibernate tools in eclipse helios","body":"<p>i want to install hibernate in eclipse helios via <a href=\"http://download.jboss.org/jbosstools/updates/stable/helios/\" rel=\"nofollow\">http://download.jboss.org/jbosstools/updates/stable/helios/</a>\nduring the installation of software i have this error:</p>\n\n<pre><code>An error occurred while collecting items to be installed\nsession context was:(profile=epp.package.jee, phase=org.eclipse.equinox.internal.p2.engine.phases.Collect, operand=, action=).\nProblems downloading artifact: osgi.bundle,org.hibernate.eclipse.console,3.4.1.v20111025-0625-H210-Final.\nMD5 hash is not as expected. Expected: fea0d20b63dde5eea8ac9441a7ffbd8d and found 22313e1a2eb7899f86b378b058007522.\nUnable to read repository at http://download.jboss.org/jbosstools/updates/JBossTools-3.2.2.Final/plugins/org.hibernate.eclipse.mapper_3.4.1.v20111025-0625-H210-Final.jar.\nRead timed out\n</code></pre>\n\n<p>what is wrong?</p>\n"},{"tags":["hibernate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12797810,"title":"Hibernate Session and Criteria","body":"<p>org.hibernate.Criteria is an interface.</p>\n\n<p>How is following possible then? </p>\n\n<pre><code>Criteria crit = sess.createCriteria(Cat.class);  \ncrit.setMaxResults(50);\nList cats = crit.list();\n</code></pre>\n\n<p>How can anyone invoke methods on criteria interface without implementing the interface in first place? </p>\n\n<p>e.g. </p>\n\n<pre><code>crit.setMaxResults\ncrit.list();\n</code></pre>\n\n<p>something fundamental I dont get here. help me out</p>\n"}]}
