{"count":135297,"tag":".net","questions":[{"tags":["c#",".net","msdeploy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13281587,"title":"WebDeploy API for .NET","body":"<p>I've installed MSDeploy on my machine.  I am using Visual Studio 2010 and C#.  Trying to load 'Microsoft.Web.*' to code some sexy msdeploy functionality.  Perhaps I'm a level 3 tard (highly probable) but the documentation for getting this absolutely blow as@.</p>\n\n<p>The error I get is:\n\"The type or namespace name 'Web' does not exist in the namespace 'Microsoft' (are you missing an assembly reference?)\"</p>\n\n<p>So -- of course I try to load it via References, but it aint there.  I then Google like a mf for \"webdeploy api C#\" and the such and cannot for the love of the giant spaghetti monster find anything on how to install / download the msdeploy (\"microsoft.web.*) .dlls, apis.</p>\n\n<p>Anyone can point a brother to a link?  </p>\n\n<p>I did download and install \"WebDeploymentSetup.msi\", but nope.  I did install \"webdeploy_en.msi\" but nope.  Then I found this craaaazy thing called \"AzurePack.exe\" -- didn't even try to install that.  But, will if someone says that's it.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#","asp.net",".net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13263751,"title":"Сhanging read-only field value with method","body":"<p>I have a working GridView in an ASP.Net webapp which tracks DNS records I have requested. It's defined as follows:</p>\n\n<pre><code>&lt;asp:GridView ID=\"gvExistingEntries\" runat=\"server\" AutoGenerateColumns=\"False\" \n    DataKeyNames=\"DNSId\" DataSourceID=\"dsDNS\" Width=\"100%\" \n    BackColor=\"White\" BorderColor=\"#DEDFDE\" BorderStyle=\"None\" BorderWidth=\"1px\" \n    CellPadding=\"4\" ForeColor=\"Black\" GridLines=\"Vertical\" AllowSorting=\"True\" ShowFooter=\"true\"&gt;\n    &lt;AlternatingRowStyle BackColor=\"White\" /&gt;\n    &lt;Columns&gt;\n        &lt;asp:BoundField DataField=\"DNSId\" Visible=\"false\" ReadOnly=\"true\" /&gt;\n        &lt;asp:BoundField DataField=\"DNSName\" HeaderText=\"DNS Name\" SortExpression=\"DNSName\" /&gt;\n        &lt;asp:BoundField DataField=\"IPAddress\" HeaderText=\"IP Address\" ReadOnly=\"True\" SortExpression=\"IPAddress\" /&gt;\n        &lt;asp:BoundField DataField=\"RecordType\" HeaderText=\"Record Type\" SortExpression=\"RecordType\" /&gt;\n        &lt;asp:BoundField DataField=\"RequestTicket\" HeaderText=\"Request Ticket\" SortExpression=\"RequestTicket\" /&gt;\n        &lt;asp:BoundField DataField=\"LastUpdateBy\" HeaderText=\"Updated By\" ReadOnly=\"True\" SortExpression=\"LastUpdateBy\" /&gt;\n\n        &lt;asp:TemplateField ShowHeader=\"false\" ItemStyle-HorizontalAlign=\"Center\"&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"updateButton\" runat=\"server\" CommandName=\"Edit\" Text=\"Update\" /&gt;\n                &lt;asp:LinkButton ID=\"deleteButton\" runat=\"server\" CommandName=\"Delete\" Text=\"Delete\" onClientClick=\"return confirm('Are you sure you want to delete this entry?');\" /&gt;\n            &lt;/ItemTemplate&gt;\n\n            &lt;EditItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"saveUpdate\" runat=\"server\" CommandName=\"Update\" Text=\"Save\" onClientClick=\"return confirm('Are you sure you want to save these changes?');\" /&gt;\n                &lt;asp:LinkButton ID=\"cancelUpdate\" runat=\"server\" CommandName=\"Cancel\" Text=\"Cancel\" /&gt;\n            &lt;/EditItemTemplate&gt;\n        &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n    &lt;FooterStyle BackColor=\"#CCCC99\" /&gt;\n    &lt;HeaderStyle BackColor=\"#6B696B\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n    &lt;PagerStyle BackColor=\"#F7F7DE\" ForeColor=\"Black\" HorizontalAlign=\"Right\" /&gt;\n    &lt;RowStyle BackColor=\"#F7F7DE\" /&gt;\n    &lt;SelectedRowStyle BackColor=\"#CE5D5A\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n    &lt;SortedAscendingCellStyle BackColor=\"#FBFBF2\" /&gt;\n    &lt;SortedAscendingHeaderStyle BackColor=\"#848384\" /&gt;\n    &lt;SortedDescendingCellStyle BackColor=\"#EAEAD3\" /&gt;\n    &lt;SortedDescendingHeaderStyle BackColor=\"#575357\" /&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>The datasource is defined as follows:</p>\n\n<pre><code>&lt;asp:SqlDataSource ID=\"dsDNS\" runat=\"server\" \n    ConnectionString=\"&lt;%$ ConnectionStrings:DNSMonConnectionString %&gt;\" \n    SelectCommand=\"SELECT [DNSId], [DNSName], [RecordType], [StartValidityDate], [EndValidityDate], [IPAddress], [LastUpdate], [RequestTicket], (select [FirstName] + ' ' + [LastName] + ' (' + [Login] + ')' FROM [User] where [User].[UserID] = [DomainName].[LastUpdateBy]) AS [LastUpdateBy] FROM [DomainName] ORDER BY [DNSName]\"\n\n    UpdateCommandType=\"StoredProcedure\"\n    UpdateCommand=\"sp_update_DNSEntry\" OnUpdating\n    DeleteCommandType=\"StoredProcedure\"\n    DeleteCommand=\"sp_drop_DNSEntry\"&gt;\n    &lt;DeleteParameters&gt;\n        &lt;asp:Parameter Name=\"DNSId\" Type=\"Int32\" /&gt;\n    &lt;/DeleteParameters&gt;\n    &lt;UpdateParameters&gt;\n        &lt;asp:Parameter Name=\"DNSId\" /&gt;\n        &lt;asp:Parameter Name=\"DNSName\" /&gt;\n        &lt;asp:Parameter Name=\"RecordType\" /&gt;\n        &lt;asp:Parameter Name=\"IPAddress\" /&gt;\n        &lt;asp:Parameter Name=\"RequestTicket\" /&gt;\n    &lt;/UpdateParameters&gt;\n&lt;/asp:SqlDataSource&gt;\n</code></pre>\n\n<p>Whenever the user uses the update feature this works and saves it to the database, but I want the code to resolve the IP address before it saves it. I have the method ready to go for this, but I do not know how to incorporate that into the code.</p>\n\n<p>Any ideas? I'd rather avoid having the code on the database if possible.</p>\n"},{"tags":["c#",".net","entity-framework","oop","generics"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13279018,"title":"How to avoid the need to reference Entity Framework on my service layer?","body":"<p>While trying to create a data access layer for a new project, I ran into what I can only imagine as an OOP/Design/Generics problem (using EF 4.3 to access the database).</p>\n\n<p>Mainly I wanted to achieve two things with this data layer:</p>\n\n<ul>\n<li>Different Context objects I have on my project should share the same connection string.</li>\n<li>Abstract repository class with common implementation.</li>\n</ul>\n\n<p>For some reason, I cannot compile my solution without referencing EntityFramework on the service layer. What I'm looking for is a way to fix this. Here's what I have:</p>\n\n<pre><code>//Project/Namespace BusinessLogicLayer.DomainClasses\n//POCO classes mapped on Entity Framework.\n\n//Project/Namespace DataAccessLayer.Base\n//Base classes and interfaces for all data access layer, such as:\n\npublic abstract class BaseContext&lt;TContext&gt; : DbContext where TContext : DbContext\n{\n  //To allow multiple contexts sharing the same connection string\n  protected BaseContext(): base(\"name=MyConnectionString\") {}\n}\n\n//Generic interface for a read-only repository\npublic interface IReadOnlyRepository&lt;T&gt; : IDisposable where T : class\n\n//Generic interface for a read/write repository\npublic interface IRepository&lt;T&gt; : IReadOnlyRepository&lt;T&gt; where T : class\n\n//Basic implementation for a read-only repository\npublic abstract class BaseReadOnlyRepository&lt;C, T&gt; : IReadOnlyRepository&lt;T&gt;\n    where T : class\n    where C : BaseContext&lt;C&gt;, new()\n{\n}\n\n//Basic implementation for a read/write repository\npublic abstract class BaseRepository&lt;C, T&gt; : IRepository&lt;T&gt;\n    where T : class\n    where C : BaseContext&lt;C&gt;, new()\n{\n}\n\n//Project DataAccessLayer.AccountContext/ Namespace DataAccessLayer\n//Context class:\n\npublic class AccountContext : BaseContext&lt;AccountContext&gt; {}\n\n//With this, I can have simple repositories:\n\npublic class UserRepository : BaseRepository&lt;AccountContext, User&gt;\n{ //All implementation comes from the base abstract class, unless I need to change it (override methods)\n}\n</code></pre>\n\n<p>I have a service layer between data access and the application (Windows Forms). Because I have a generic repository, it seemed a good and logic idea to have generic services. In the end, very similar to the repository structure:</p>\n\n<pre><code>//Project/Namespace BusinessLogicLayer.Services\n//Service layer supposed to reference only the repository project and not Entity Framework.\n\n//Generic interface for a read-only service working with a read-only repository\npublic interface IReadOnlyService&lt;T&gt; where T : class {}\n\n//Generic interface for a read/write service working with a read/write repository\npublic interface IService&lt;T&gt; : IReadOnlyService&lt;T&gt; where T : class\n\n//Base implementation for a read-only service\npublic abstract class BaseReadOnlyService&lt;T, R&gt; : IReadOnlyService&lt;T&gt;\n    where T : class\n    where R : IReadOnlyRepository&lt;T&gt;, new()\n{\n}\n\n//Base implementation for a read/write service\npublic abstract class BaseService&lt;T, R&gt; : IService&lt;T&gt;\n    where T : class\n    where R : IRepository&lt;T&gt;, new()\n{\n}\n\n//Concrete sample service\npublic class UserService : BaseService&lt;User, UserRepository&gt;\n{ //As with the repository I can change the default behavior of implementation overriding methods\n}\n</code></pre>\n\n<p>With this setup, the only way to compile is to reference Entity Framework on the service layer project.\nHow can I avoid the need to reference Entity Framework there?</p>\n\n<p>At this point, I'm willing to even throw it all out and rebuild everything but this is the only way I found to make it work given my needs (DbContext sharing connection strings, generic repository to avoid replication of code).</p>\n\n<p>Appreciate any help. Thanks.</p>\n\n<p><em>--Edit--Including here some extra steps I did 3 hours after I posted the question--</em></p>\n\n<p>In order to figure this out, I started to create a sample project with the same code above plus some implementation to mimic the results on the original project as much as possible.</p>\n\n<p>I created the domain classes project, the whole base data layer project and then the context project. I noticed I need to reference Entity Framework on the context project even though the context class does not derive directly from DbContext. Instead, it derives from an abstract class that derives from DbContext. This is ok though since my context will have DbSets and any other implementation related to DbContext.</p>\n\n<p>Next is the repository project. Needs to reference all other three (domain, base data layer and context). My repository has no code. All funcionality lies on the ancestor. I try to compile the repository project and VS requires me to referente Entity Framework. I wonder if it's really just a matter of embedding libraries. If this is confirmed, it's going to be a surprise. Entity Framework library is present on the output of the other projects. Why would I need to reference it here too? What's making VS require this?</p>\n\n<p>Anyway, for testing purposes, I added the reference. After all, I'm inside the data layer. I can live with that. Moving on to the service layer. For the sake of simplicity, I put all of the service classes into the same project.</p>\n\n<p>One possible flaw is that one of the constraints for the service abstract classes is the repository interface. That requires me to add a reference to the base data layer on my service layer. Perhaps already here there is something I can do that allows me to use only the repository reference. I have no option but to reference base data layer.</p>\n\n<p>Lastly, my concrete service is created and VS gives me the following error message: The type 'System.Data.Entity.DbContext' is defined in an assembly that is not referenced. You must add a reference to assembly 'EntityFramework, Version=4.3.1.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</p>\n\n<p>So, in the end, the only way to keep going is to reference Entity Framework on the service layer. And at some point, when building the Windows Forms App, I will also have to reference Entity Framework.</p>\n\n<p>What should I do to avoid having these references? What improvements can I have on this structure?</p>\n\n<p>What I know is that my app certainly doesn't have to know that Entity Framework is involved anywhere on the other layers. Neither does the service layer. Services will only consume repositories. Repositories can even be providing fake data for tests.</p>\n\n<p>In case anyone is interested, I uploaded the project I created while writing this. It's a 1,17Mb zip file with no binaries whatsoever (except the Entity Framework 4.3.1 dll that I got through Nuget). Link: <a href=\"http://www.mediafire.com/?b45zkedy2j7eocc\" rel=\"nofollow\">http://www.mediafire.com/?b45zkedy2j7eocc</a>.</p>\n\n<p>Again, thanks for helping.</p>\n"},{"tags":["c#",".net","xml","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":11572981,"title":"How to XML serialize polymorphic array without wrapping element","body":"<p>Want to serialise my data into this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ibm850\"?&gt;\n&lt;Batch Name=\"Test batch\"&gt;\n   &lt;ExecuteCommand Command=\"...\" /&gt;\n   &lt;WaitCommand Seconds=\"5\" /&gt;\n&lt;/Batch&gt;\n</code></pre>\n\n<p>But instead I'm getting this (note the wrapping Commands element)</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ibm850\"?&gt;\n&lt;Batch Name=\"Test batch\"&gt;\n  &lt;Commands&gt;&lt;!-- I want to get rid of thiw wrapper Commands element and just  --&gt;\n    &lt;ExecuteCommand Command=\"...\" /&gt;\n    &lt;WaitCommand Seconds=\"5\" /&gt;\n  &lt;/Commands&gt;\n&lt;/Batch&gt;\n</code></pre>\n\n<p>Here's the sample code used to produce this:</p>\n\n<pre><code>public class BaseCommand //base class\n{\n    [XmlAttribute]\n    public string Result { get; set; }\n}\n\npublic class ExecuteCommand : BaseCommand\n{\n    [XmlAttribute]\n    public string Command { get; set; }\n}\n\npublic class WaitCommand : BaseCommand\n{\n    [XmlAttribute]\n    public int Seconds { get; set; }\n}\n\npublic class Batch\n{\n    [XmlAttribute]\n    public string Name { get; set; }\n\n    private List&lt;BaseCommand&gt; _commands = new List&lt;BaseCommand&gt;();\n    [XmlArrayItem(typeof(ExecuteCommand))]\n    [XmlArrayItem(typeof(WaitCommand))]\n    public List&lt;BaseCommand&gt; Commands\n    {\n        get\n        {\n            return _commands;\n        }\n        set\n        {\n            _commands = value;\n        }\n    }\n\n    public static void Main()\n    {\n        XmlSerializer serializer = new XmlSerializer(typeof(Batch));\n\n        Batch b = new Batch();\n        b.Name = \"Test batch\";\n        b.Commands.Add(new ExecuteCommand() { Command = \"...\" });\n        b.Commands.Add(new WaitCommand() { Seconds = 5 });\n\n        serializer.Serialize(Console.Out, b);\n        Console.Read();\n    }\n}\n</code></pre>\n\n<p>I searched and read heaps of articles on this topic. They all seem to provide solution for serializing collections with a single class type (no inheritance used). I use inheritance and nothing seems to work. Unfortunately I have to output precise XML document due to legacy support</p>\n"},{"tags":["c#",".net","xml","linq","xpath"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13280719,"title":"How do I read all XML nodes of a specific name and put them into an array (or list)?","body":"<p>I have an XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;ticket&gt;\n    &lt;comments type=\"array\"&gt;\n         &lt;comment&gt; \n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;/comment&gt;\n         &lt;comment&gt;\n               &lt;attachments type=\"array\"&gt;\n                     &lt;attachment&gt;\n                          &lt;url&gt;I NEED WHATEVER IS IN HERE&lt;/url&gt;\n                     &lt;/attachment&gt;\n               &lt;/attachments&gt;\n         &lt;comment&gt;\n     &lt;/comments&gt;\n&lt;/ticket&gt;\n</code></pre>\n\n<p>How would I go about getting whatever is inside the URL tag and add it to a <code>&lt;List&gt;</code>? I'm using C#.</p>\n"},{"tags":[".net","vb.net","visual-studio","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13279538,"title":"Html.BeginForm - HTTP POST method - VB.NET 2012 MVC 4 Visual Studio","body":"<p>The focus is on the <strong><em>\"controllerName As String\"</em></strong> - part - of the <strong>Html.BeginForm</strong> function.</p>\n\n<h1>The HTML:</h1>\n\n<h3>root/Views/Home/Therequestform.vbhtml</h3>\n\n<pre><code>    &lt;h2&gt;Therequestform&lt;/h2&gt;\n\n@Html.BeginForm(\"Therequest\", \"Home\", method:= FormMethod.Post)\n\n    &lt;fieldset&gt;\n        &lt;input type=\"text\" name=\"ColorName\" /&gt;\n        &lt;input type=\"submit\" name=\"ColorName_SubmitButton\" /&gt;\n    &lt;/fieldset&gt;\n</code></pre>\n\n<h1>The Controller:</h1>\n\n<h3>root/Controllers/HomeController.vb</h3>\n\n<pre><code>Function Therequestform() As ActionResult\n\n    Return View()\n\nEnd Function\n\n\n    &lt;HttpPost()&gt;\n    Function Therequest() As ActionResult\n\n        Response.Write(\"The color you have submitted: \" &amp; Request.Form(\"ColorName\"))\n\n        Return View()\n    End Function\n\n\nEnd Class\n</code></pre>\n\n<h1>The Question:</h1>\n\n<p><strong>EDIT:</strong> The call to the View is done above the request call to the HTTP POST method with the function \"Therequest\" - in the Controller.</p>\n\n<p>The reference to the <code>ControllerName</code> has been done in the second part of the <code>Html.BeginForm</code>, whereas in the first part of <code>Html.BeginForm</code> the reference to the function to call a <code>request</code> to the <code>HTTP POST method</code> is done.</p>\n\n<p>The problem I am having is, that after pressing the <code>submit button</code>, the call to the function (in the controller) is not done in the set location. Where the following error message comes up, after the ´submit button´ is pressed:</p>\n\n<hr />\n\n<blockquote>\n  <p><strong>Server Error in Application.</strong>\n  The view 'Therequest' or its master was not found or no view engine supports the searched locations. The following locations were searched:</p>\n  \n  <p><strong>Description:</strong> An unhandled exception occurred during the execution of\n  the current web request. Please review the stack trace for more\n  information about the error and where it originated in the code.</p>\n  \n  <p><strong>Exception Details:</strong> System.InvalidOperationException: The view\n  'Therequest' or its master was not found or no view engine supports\n  the searched locations. The following locations were searched:</p>\n  \n  <p>~/Views/Home/Therequest.aspx </p>\n</blockquote>\n\n<p>~/Views/Home/Therequest.ascx</p>\n\n<blockquote>\n  <p>~/Views/Shared/Therequest.aspx </p>\n</blockquote>\n\n<p>~/Views/Shared/Therequest.ascx</p>\n\n<blockquote>\n  <p>~/Views/Home/Therequest.cshtml </p>\n</blockquote>\n\n<p>~/Views/Home/Therequest.vbhtml</p>\n\n<blockquote>\n  <p>~/Views/Shared/Therequest.cshtml </p>\n</blockquote>\n\n<p>~/Views/Shared/Therequest.vbhtml</p>\n\n<blockquote>\n  <p><strong>Source Error:</strong> An unhandled exception was generated during the execution of the\n  current web request. Information regarding the origin and location of\n  the exception can be identified using the exception stack trace below.</p>\n</blockquote>\n\n<hr />\n\n<p>The \"search\", or also the \"call\" is <strong>not</strong> done in the <code>set</code> location. Where by the parameter array of the <em>Html.BeginForm</em>, the to be <code>executed</code> function name is set, and also, the <code>controllerName</code> is set - which is set to (<strong>root/Controllers/HomeController.vb</strong>) - and in the third part the method is set to <code>POST</code>.</p>\n\n<p>The question is, what is causing <strong>it</strong> to not do the call in the set location?\n<hr />\n<strong>The Tools Used:</strong> VB.NET 2012, MVC 4, Visual Studio 2012, Microsoft SQL Server 2012</p>\n"},{"tags":["c#",".net","proxy","fiddler"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":108,"score":1,"question_id":12772332,"title":"C# FiddlerCore API to capture data","body":"<p>I am successfully using the FiddlerCore API in C# to intercept web responses from a particular web host and capture JSON data.</p>\n\n<p>The FiddlerCore API seems to block any other web browsing in Chrome, IE, etc whilst my application is running and capturing data.  I understand that FiddlerCore creates a proxy to catch the traffic but wondered if it was possible to stop FiddlerCore from changing the LAN settings in my browser to direct traffic through a proxy?</p>\n\n<p>I am currently Starting my Fiddler instance using the code below:</p>\n\n<pre><code>         Fiddler.FiddlerApplication.Startup(8877, true, true);\n</code></pre>\n\n<p>And I intercept the data packets in my winforms app in the following event</p>\n\n<pre><code>         FiddlerApplication.AfterSessionComplete\n</code></pre>\n"},{"tags":["c#",".net","multithreading","parallel-processing"],"answer_count":5,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":6301,"score":11,"question_id":3780870,"title":"Using AsParallel()/Parellel.ForEach() guidelines?","body":"<p>Looking for a little advice on leveraging <code>AsParallel()</code> or <code>Parallel.ForEach()</code> to speed this up.</p>\n\n<p>See the method I've got (simplified/bastardized for this example) below.</p>\n\n<p>It takes a list like \"US, FR, APAC\", where \"APAC\" is an alias for maybe 50 other \"US, FR, JP, IT, GB\" etc. countires. The method should take \"US, FR, APAC\", and convert it to a list of \"US\", \"FR\", plus all the countries that are in \"APAC\".</p>\n\n<pre><code>private IEnumerable&lt;string&gt; Countries (string[] countriesAndAliases)\n{\n    var countries = new List&lt;string&gt;();\n\n    foreach (var countryOrAlias in countriesAndAliases)\n    {\n        if (IsCountryNotAlias(countryOrAlias))\n        {\n            countries.Add(countryOrAlias);\n        }\n        else \n        {\n            foreach (var aliasCountry in AliasCountryLists[countryOrAlias]) \n            {\n                countries.Add(aliasCountry);\n            }\n        }\n    }\n\n    return countries.Distinct();\n}\n</code></pre>\n\n<p>Is making this parallelized as simple as changing it to what's below? Is there more nuance to using <code>AsParallel()</code> than this? Should I be using <code>Parallel.ForEach()</code> instead of <code>foreach</code>? What rules of thumb should I use when parallelizing <code>foreach</code> loops?</p>\n\n<pre><code>private IEnumerable&lt;string&gt; Countries (string[] countriesAndAliases)\n{\n    var countries = new List&lt;string&gt;();\n\n    foreach (var countryOrAlias in countriesAndAliases.AsParallel())\n    {\n        if (IsCountryNotAlias(countryOrAlias))\n        {\n            countries.Add(countryOrAlias);\n        }\n        else \n        {\n            foreach (var aliasCountry in AliasCountryLists[countryOrAlias].AsParallel()) \n            {\n                countries.Add(aliasCountry);\n            }\n        }\n    }\n\n    return countries.Distinct();\n}\n</code></pre>\n"},{"tags":["c#",".net","google-api","google-analytics-api"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1316,"score":3,"question_id":9100770,"title":"Difference between Google API libraries: google-api-dotnet-client vs. google-gdata","body":"<p>What is the difference between the <a href=\"http://code.google.com/p/google-api-dotnet-client/\" rel=\"nofollow\">Google APIs Client Library for .NET</a> (google-api-dotnet-client) and <a href=\"http://code.google.com/p/google-gdata/\" rel=\"nofollow\">.NET library for the Google Data API </a> (google-gdata) as they pertain to the <a href=\"http://code.google.com/apis/analytics/\" rel=\"nofollow\">Google Analytics API</a>?</p>\n"},{"tags":["c#",".net","https"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13277657,"title":"How do I download the contents of a HTTPS web page?","body":"<p>To get to the page, I need a password. I have the password and I can get to the page.</p>\n\n<p>The DownloadString(URL) function is downloading the contents of the LOG-IN page and not the actual page I want. Why?</p>\n\n<pre><code>using (var client = new WebClient())\n            {\n                var credentials = new NetworkCredential { UserName = \"username\", Password = \"password\" };\n                client.Credentials = credentials;\n\n                string pageContents = client.DownloadString(url);\n\n                if (pageContents.Contains(\"cheetah\"))\n                {\n                    MessageBox.Show(\"yes!\");\n                }\n                else\n                {\n                    MessageBox.Show(\"No\");\n                }\n            }\n</code></pre>\n\n<p>The above is getting the contents of the LOG-IN page as opposed to the page I really want. How do I get passed this?</p>\n"},{"tags":["c#","jquery","asp.net",".net","sql-server-2005"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":10489740,"title":"Good way to determine if someone left a webpage","body":"<p>I am trying to code an app for work where our clients can edit certain fields. When they click edit, the code will lock the data to be editted. And when they click save the data will unlock. But I am having trouble deciding if I can unlock the data when they click elsewhere, go to another page or site, or even close the browser.</p>\n\n<p>What's a good way to decide if the user has left the edit page?</p>\n\n<p>(We are using C# .NET 3.5 and JQuery and a SQL Server 2005 DB).</p>\n"},{"tags":["c#",".net","wmi","sysadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":182,"score":0,"question_id":11508844,"title":"Mount Network Drive with WMI","body":"<p>Trying to write a WMI class function to mount a network drive on any computer (remote or local) using the credentials of the logged in computer. </p>\n\n<p>This is a class for a larger project that I wrote for help desk staff to do first line fixes on remote PC's. The tech types in the the machine name or ip address and the app connects to it and allows to tech to click a couple of buttons and fix some basic items without having to remote(VNC) into the PC. </p>\n\n<p>I've read all over the internet that it is much easier ways than WMI, but due to the remote nature of the app I would rather not use local API calls, nor do I want to worry about uploading script and executing it though a process start. Also other functions are already in WMI so I'd like to keep the code base the same. </p>\n\n<p>The basic idea is to mount <code>H:</code> to <code>//fileserver.example.com/$username</code></p>\n\n<p>NetFixer is already in production use so I'm trying to keep my code nice and neat </p>\n\n<p><img src=\"http://i.stack.imgur.com/2yDn5.png\" alt=\"enter image description here\"></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Management;\n\nnamespace WMIcontrols\n{\n  public class Remote\n  {\n\n   public string target;\n\n   //Some code skipped here for simplicity sake... \n\n   public bool MountNetDrive(string DriveLetter, string MountLocation)\n    {\n      try\n      {\n          //Mount the network drive\n          return true;\n      }\n      catch\n      {\n          //Mount Failed\n          return false;\n      }\n    }\n  }\n}\n</code></pre>\n"},{"tags":[".net","f#","clr","sandbox","appdomain"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13280251,"title":"Should ApplicationBase be different for the sandbox AppDomain?","body":"<p>What are the exact security implications of setting ApplicationBase of a slave sandbox domain to the same path as the hosting domain?</p>\n\n<p>I found MSDN guidelines that state that ApplicationBase should be different for the slave domain \"If the ApplicationBase settings are the same, the partial-trust application can get the hosting application to load (as fully trusted) an exception it defines, thus exploiting it\" (p. 3):</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/bb763046.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/bb763046.aspx</a></p>\n\n<p>How exactly would this exploit work?</p>\n\n<p>In my scenario I am willing to run all assemblies located under the ApplicationBase in full trust. I am sandboxing the slave AppDomain exclusively to limit the rights of dynamically generated assemblies within that domain.  I tried following the guidelines but changing the ApplicationBase property seems to break a bi-directional communication bridge I have between the domains, due to an assembly loading into LoadFrom context, so I would like to avoid it.</p>\n\n<p>Sample F# code demonstrating the problem with distinct ApplicationBase values:</p>\n\n<pre><code>module Main =\n\n    open System\n    open System.Diagnostics\n    open System.IO\n    open System.Reflection\n    open System.Security\n    open System.Security.Permissions\n    open System.Security.Policy\n\n    /// Change this switch to observe the problem.\n    let useSameApplicationBase = true\n\n    let getStrongName (a: Assembly) =\n        match a.Evidence.GetHostEvidence&lt;StrongName&gt;() with\n        | null -&gt; None\n        | sn -&gt; Some sn\n\n    let getAssemblies () =\n        [|\n            Assembly.GetExecutingAssembly()\n        |]\n\n    let buildAppDomain () =\n        let fullTrust =\n            getAssemblies ()\n            |&gt; Array.choose getStrongName\n        let evidence = null\n        let appBase =\n            if useSameApplicationBase then\n                AppDomain.CurrentDomain.BaseDirectory\n            else\n                Path.Combine(AppDomain.CurrentDomain.BaseDirectory, \"Untrusted\")\n        let setup = AppDomainSetup(ApplicationBase = appBase)\n        let perms = PermissionSet(PermissionState.None)\n        AppDomain.CreateDomain(\"SLAVE\", null, setup, perms, fullTrust)\n\n    [&lt;Sealed&gt;]\n    type Backer() =\n        inherit MarshalByRefObject()\n        member this.Pong() =\n            Console.WriteLine(\"PONG IN DOMAIN = {0}\", AppDomain.CurrentDomain.FriendlyName)\n\n    [&lt;Sealed&gt;]\n    type Sandbox() =\n        inherit MarshalByRefObject()\n        member this.Start(backer: obj) =\n            Console.WriteLine(\"RUN IN SLAVE DOMAIN = {0}\", AppDomain.CurrentDomain.FriendlyName)\n            (backer :?&gt; Backer).Pong()\n\n    let test () =\n        let dom = buildAppDomain ()\n        try\n            let handle =\n                Activator.CreateInstanceFrom(dom,\n                    typeof&lt;Sandbox&gt;.Assembly.Location,\n                    typeof&lt;Sandbox&gt;.FullName)\n            let sandbox = handle.Unwrap() :?&gt; Sandbox\n            sandbox.Start(Backer())\n        finally\n            AppDomain.Unload(dom)\n\n    test ()\n</code></pre>\n"},{"tags":[".net","pdf","printing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13255770,"title":"Controlling the print options of a pdf","body":"<p>I am producing a number of PDFs using either SSRS or using an HTML to PDF component. What I want to do for each document is to set the first page to print to tray 1 and subsequent pages.</p>\n\n<p>Is there anyway to do this? System.Drawing.Printing and System.Printing seem like good candidates but they don't seem to be useful for PDFs (i may be wrong). The Adobe sdk doesn't at first glance seem to have that level of granularity either.</p>\n"},{"tags":["c#",".net","windows","windows-8","winrt"],"answer_count":5,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":2470,"score":12,"question_id":7426492,"title":"Can old native applications run on Windows8 tablet version?","body":"<p><img src=\"http://i.stack.imgur.com/5TCIt.png\" alt=\"enter image description here\"></p>\n\n<p>I don't understand this picture well.\nIn the Metro style Apps, what does C/C++ mean? Native C/C++? or is it managed C++? They(Metro style apps) don't even have Win32 layer!</p>\n\n<p>To make an application which compatible with both Metro style and Desktop, should we only use .NET code? The old native applications can run on Windows8 Tablet?</p>\n"},{"tags":["c#","asp.net",".net","c#-4.0","iis-7.5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13280347,"title":"FormsAuthentication.RedirectToLoginPage Not Working When Application at Root of Site","body":"<p>The application (ASP.Net 4 / C#) I've been developing uses FormsAuthentication.RedirectToLoginPage() to send the user back to the login page after he/she has clicked on a Logout button. </p>\n\n<p>I'm finding that when the application is deployed at the root of a IIS Site, the redirect does not work. Clicking on the logout button simply reloads the page.</p>\n\n<p>When the application is deployed to an Application virtual folder within the site, the redirect works property.</p>\n\n<p>I've also tried using Respond.Redirect(), which also does not work. I've tried recreating the site from scratch (no luck). </p>\n\n<p>The code for the logout button:</p>\n\n<pre><code>    protected void lbLogout_Click(object sender, EventArgs e)\n    {\n        FormsAuthentication.SignOut();\n        Session.Abandon();\n\n        // clear authentication cookie\n        HttpCookie cookie1 = new HttpCookie(FormsAuthentication.FormsCookieName, \"\");\n        cookie1.Expires = DateTime.Now.AddYears(-1);\n        cookie1.Path = FormsAuthentication.FormsCookiePath;\n        cookie1.HttpOnly = true;\n        Response.Cookies.Add(cookie1);\n\n        // clear session cookie \n        HttpCookie cookie2 = new HttpCookie(\"ASP.NET_SessionId\", \"\");\n        cookie2.Expires = DateTime.Now.AddYears(-1);\n        Response.Cookies.Add(cookie2);\n\n        FormsAuthentication.RedirectToLoginPage();\n        //Response.Redirect(\"~/login.aspx\");\n        Response.End();\n    }\n</code></pre>\n\n<p>Thanks for the help!</p>\n"},{"tags":["c#",".net","cluster-analysis","levenshtein-distance","string-similarity"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":69,"score":2,"question_id":13275408,"title":"String similar to a set of strings","body":"<p>I need to compare a set of strings to another set of strings and find which strings are similar (fuzzy-string matching). \nFor example: </p>\n\n<pre><code>{ \"A.B. Mann Incorporated\", \"Mr. Enrique Bellini\", \"Park Management Systems\" } \nand\n{ \"Park\", \"AB Mann Inc.\", \"E. Bellini\" }\n</code></pre>\n\n<p>Assuming a zero-based index, the matches would be 0-1, 1-2, 2-0. Obviously, no algorithm can be perfect at this type of thing.</p>\n\n<p>I have a working implementation of the Levenshtein-distance algorithm, but using it to find similar strings from each set necessitates looping through both sets of strings to do the comparison, resulting in an O(n^2) algorithm. This runs unacceptably slow even with modestly sized sets.</p>\n\n<p>I've also tried a <a href=\"http://matpalm.com/resemblance/jaccard_coeff/\" rel=\"nofollow\">clustering algorithm</a> that uses shingling and the Jaccard coefficient. Unfortunately, this too runs in O(n^2), which ends up being too slow, even with bit-level optimizations. </p>\n\n<p>Does anyone know of a more efficient algorithm (faster than O(n^2)), or better yet, a library already written in C#, for accomplishing this? </p>\n"},{"tags":["c#",".net","process","shellexecute"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13279403,"title":"Launch Shell but not in focus?","body":"<p>I have a simple app that repeatably uses <code>Process.Start</code> to launch one of my console applications. Unfortunately everytime it does this my window loses focus. Since it does this over 100 and takes about an hour to run through my window loses focus more then once per minute.</p>\n\n<p>Is there a way I can launch the process it w/o having the window hidden? but not setting focus to it? Although the app is more like something i would want running in the background i do need to see the console output which is why i require it not to be hidden</p>\n"},{"tags":["c#",".net","c#-4.0","sift"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13279613,"title":"I couldnt use the library that I have already imported as references in my project","body":"<p>I am writing a program for computer vision in c# that part of project SIFT is needed; I downloaded the MEMO library for SIFT :  </p>\n\n<p><a href=\"http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/\" rel=\"nofollow\">http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/</a></p>\n\n<p>In my project I added the two libraries <strong>*<em>libsift.dll &amp; ICSharpCode.SharpZipLib.dll</strong> *</em> as references in to my projects.</p>\n\n<p><img src=\"http://i.stack.imgur.com/86hzx.png\" alt=\"enter image description here\"></p>\n\n<p>Now that I want to mention libsift on top of the code \" USING libsift\" it doesnt recognize it;   </p>\n\n<p><img src=\"http://i.stack.imgur.com/2A24Y.png\" alt=\"enter image description here\"></p>\n\n<p>even more if I wanna make a instance of such class atuo detect doesn't recognize it.</p>\n\n<p><img src=\"http://i.stack.imgur.com/Spmts.png\" alt=\"enter image description here\"></p>\n\n<p>It is weird because I could see the functions of this library in object browser.  </p>\n\n<p><img src=\"http://i.stack.imgur.com/kfmuX.png\" alt=\"enter image description here\">  </p>\n\n<p>I couldnt use the library that I have already imported as references in my project although I could see the functions in object browser? What could be the problem? </p>\n\n<p>(I have c# .Net VS2010 in windows.)</p>\n"},{"tags":["asp.net",".net","asp.net-mvc","mobile","jquery-mobile"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13273851,"title":"ASP.net: Using .NET Technologies to develop robust web applications, what tools do I need?","body":"<p>Looking for a rundown of all the tools available that will allow me to develop mobile websites using the .NET stack. I'm likely going to be using MVC 4 and jQuery Mobile, but what else do I need to be thinking about as far as getting all devices compatible. Keep in mind, I'm talking about web sites, not native apps right now.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":[".net","soap","wsdl","xmlserializer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13279731,"title":"Differing .NET XML serializer behavior when deserializing missing integers","body":"<p>I recently hit a problem with a SOAP web service where the WSDL specifies an integer for a particular field, but the XML comes in with an empty element which causes the .NET deserialization logic to throw a FormatException.</p>\n\n<p>The WSDL looks like this:</p>\n\n<pre><code>&lt;xsd:element minOccurs=\"0\" maxOccurs=\"1\" name=\"TransID\" type=\"xsd:int\" /&gt;\n</code></pre>\n\n<p>And the SOAP looks like this:</p>\n\n<pre><code>&lt;TransID&gt;&lt;/TransID&gt;\n</code></pre>\n\n<p>This causes the exception when parsing the response.  The server I'm talking to belongs to a vendor so I don't have the option to change it.  I'm hacking around this in the short term by redefining the field as a string.</p>\n\n<p>My question is this: In trying to diagnose this problem, I pulled out the XML into a file and created my own XmlSerializer to test deserializing using the POCO's generated by the WSDL import.  The XmlSerializer I created parses this XML just fine and produces the parent type as expected.  No exception.  The field value is zero which would be expected.  Why does the SOAP deserializer puke and the plain deserializer I created works fine?</p>\n"},{"tags":["c#",".net","infragistics","tablelayout","noise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13279895,"title":"Noise box, when a table layout is scrolling, without 'AutoScroll' property enabled","body":"<p>I have a big problem, when I doing a scrolling without 'Autoscrool' property enabled on a table layout, I get a noise box, seems that the layout continue scrolling (see attached image). I have tried update/refresh/invalidate... its container layouts, but I could not get success for my problem.</p>\n\n<p>Other weird behavior that I have is, once have the noise box on the screen, and launched any dialog, the full layout is fixed.</p>\n\n<p>Has anyone had a similar problem before?</p>\n\n<p>see below the code that I'm using to scrool the table layout:</p>\n\n<pre><code>    private void panelSelectorTrackBar_ValueChanged(object sender, EventArgs e)\n    {\n        galleryTableLayoutPanel.Top = panelSelectorTrackBar.Value;\n        dashboardPanelDetails.Hide();\n    }\n</code></pre>\n\n<p>On where <strong>galleryTableLayoutPanel</strong> is a <em>TableLayout</em> instance, <em>panelSelectorTrackBar</em> is an <em>UltraTrackBar</em> instance.</p>\n\n<p><img src=\"http://i.stack.imgur.com/831Yb.png\" alt=\"Noise Box\"></p>\n"},{"tags":["c#",".net","asp.net-mvc","dependency-injection","asp.net-web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12320846,"title":"Some questions about webapi ActionFilterAttribtes, FilterProvider, and Dependency Injection","body":"<p>I see that by default, an MVC4 WebApi project has 2 <code>IFilterProviders</code>: The <code>ConfigurationFilterProvider</code>, and the <code>ActionDescriptorFilterProvider</code>. When setting up a custom <code>IFilterProvider</code> to do property depenency injection, is it appropriate to remove both of these from the Filters collection first? Or is it more appropriate to just remove the <code>ActionDescriptorFilterProvider</code>, and leave the <code>ConfigurationFilterProvider</code> in the collection?</p>\n\n<p>Secondly, I see that after a WebApi Http <code>ActionFilterAttribute</code> is constructed for a particular action, it seems to stay around. For example when I put a custom action filter on an ApiController Get method, it is only constructed the first time that method is called. Subsequent calls to the api method seem to reuse the same filter (constructor breakpoints are only hit during the first invocation). Is this right? Why is it different than an MVC actionfilter, where a new instance is created for each method invocation?</p>\n"},{"tags":["c#",".net","winforms","krypton-toolkit"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1112,"score":2,"question_id":7916607,"title":"How to deselect the text of a combobox","body":"<p>I have a krypton combo box which I data bind with a list of key-value pairs. What's happening is that when i set the selected item in code, it is highlighting the text. How can i prevent this or deselect the text?</p>\n\n<p>I've tried </p>\n\n<pre><code>// 1\ncombo.Select(0,0);\n// 2\ncombo.Focus();\nanotherControl.Focus();\n// 3\ncombo.SelectionStart = 0;\ncombo.SelectionLength = combo.Text.Length;\n// 4 \ncombo.SelectionStart = combo.Text.Length;\ncombo.SelectionLength = 0;\n</code></pre>\n\n<p>Nothing wants to work.\nAny help appreciated.</p>\n"},{"tags":["c#",".net","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13279489,"title":"Copy/Clone Stream in a loop...","body":"<p>I am fundamentally doing something wrong here within this loop. The first time through the loop, the Stream works fine, but subsequent times through the loop fail with the Stream being corrupted. I know am probably doing something silly. I tried to set the updateTemplate to 0 each time but the InputStream doesn't support the seek. I am basically appending multiple forms that are filled in onto a List here. Any suggestions would be appreciated, especially ones that would result in better performance.</p>\n\n<pre><code>...\nfiles.Add(PDFhelper.fillTemplate(template, mappings));\n\nforeach (Update u in myObject.Updates)\n{\n    mappings = this.GenerateFieldMappings(u);\n    Stream output = new MemoryStream();\n    template.CopyTo(output);\n    files.Add(PDFhelper.fillTemplate(output, mappings)); //First time stream is good  \n\n}\n\nreturn PDFhelper.MergeFiles(files);\n\n...\n</code></pre>\n"},{"tags":[".net","wcf","exception-handling","faultexception","faultcontract"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13279736,"title":"Handling managed fault from nested WCF service call","body":"<p>I've got a WCF service (Service1) that itself calls another WCF service (Service2). Service1 is called from a silverlight client. On the silverlight side I've got an postsharp aspect to handle managed (i.e. typed) fault exceptions in a consistent way. Unmanaged faults (i.e. not typed) are not handled in the same way by the postsharp aspect.</p>\n\n<p>If I throw a managed fault directly from Service1 the postsharp aspect handles everything appopriately as the typed fault contract is known on the silverlight side. Both Service1 and Service2 operation is decorated with the FaultContractAttribute such as follows:</p>\n\n<pre><code>[FaultContract(typeof(SimpleMessageFault))]\nvoid Operation(string arg);\n</code></pre>\n\n<p>If I throw a managed FaultException from Service2 (using the same fault contract type i.e. SimpleMessageFault), I can catch this in Service1 as a managed fault, but it doesnt get handled correctly on the silverlight side where it comes through as an UNmanaged fault exception. </p>\n\n<p>I believe this has something to do with the <em>Action</em> of the managed fault exception coming from Service2. I dont specify an <em>Action</em> when I throw the fault in Service2:</p>\n\n<pre><code>throw new FaultException&lt;SimpleMessageFault&gt;(new SimpleMessageFault(\"bad Bad BAD!!!\"));\n</code></pre>\n\n<p>but if I catch the exception in the Service1 operation that calls the Service2 operation there IS an action on the managed fault exception that is caught. The action is something like <pre>http://tempuri.org/IService2/Service2OperationSimpleMessageFaultFault</pre>, which appears to have been automatically generated.</p>\n\n<p>As shown below if I create a <em>new</em> fault exception in Service1 and throw this, this gets passed correctly back to the silverlight side as a managed exception. If I rethrow the managed fault from Service2 (which specifies an action ) it gets back to the silverlight side as an UNmanaged fault:</p>\n\n<pre><code>catch (FaultException&lt;SimpleMessageFault&gt; fex)\n{\n    //this works\n    throw new FaultException&lt;SimpleMessageFault&gt;(fex.Detail);\n\n    //this does not work\n    throw fex;\n}\n</code></pre>\n\n<p>Has anyone come across this sort of behaviour, or does anyone know how to resolve this...</p>\n"},{"tags":["c#",".net","arrays"],"answer_count":1,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":122,"score":8,"question_id":10465099,"title":"Create an array populated with a range of values x through y","body":"<p>Let's say I have integer variables x and y, and I want an array populated with values x through y.  Is there a nice way to do this inline, using C#?</p>\n\n<p>I know I can achieve this using an extension method:</p>\n\n<pre><code>public static int[] ExpandToArray(this int x, int y)\n{\n    var arr = int[y - x + 1];\n    for (int i = x; i &lt;= y; i++) \n    {\n        arr[i-x] = i;\n    }\n    return arr;\n}\n</code></pre>\n\n<p>And then use it to write:</p>\n\n<pre><code>x.ExpandToArray(y);\n</code></pre>\n\n<p>Is there a built-in way (without creating an extension method) in .NET to write something like <code>x.ExpandToArray(y)</code>?</p>\n"},{"tags":[".net","winforms","text","drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":8232954,"title":"What TextFormatFlags.TextBoxControl flag exactly does","body":"<p>I would like to understand what effect has enablig the flag <a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.textformatflags%28v=vs.80%29.aspx\" rel=\"nofollow\">TextFormatFlags.TextBoxControl</a> when using the <a href=\"http://msdn.microsoft.com/en-us/library/w3cdh3zw.aspx\" rel=\"nofollow\">TextRenderer.DrawText</a> method is called.</p>\n\n<p>I have written an small program and I can't see difference between using it and don't using it.</p>\n\n<p>Also, I inpected the code with the .NET reflector and the flag is passed directly to the native method so I could see what is the effect.</p>\n"},{"tags":[".net","wpf","animated-gif"],"answer_count":9,"favorite_count":20,"up_vote_count":41,"down_vote_count":0,"view_count":34390,"score":41,"question_id":210922,"title":"How do I get an animated gif to work in WPF?","body":"<p>What control type should I use - Image, MediaElement, etc??</p>\n"},{"tags":["c#",".net","impersonation","dcom"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13278831,"title":"How to impersonate another user for a DCOM connection in C#?","body":"<p>I am trying to connect to a DCOM object on a remote machine which is logged in as a different user from a C# application. I have gotten my code working to connect to the same DCOM object while it is running on the same computer, like so:</p>\n\n<pre><code>MyDCOMType dcomObject;\nType remoteSessionContextType = Type.GetTypeFromProgID(\"ServerApp.MyDCOMType\");\ndcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);\nstring version = dcomObject.GetVersion();\n</code></pre>\n\n<p>MyDCOMType is a type implemented in the DCOM application (a VB6 app) that I added as a reference in my project. I have been able to create an instance of it in the C# code and call all of the methods with the expected results. Now I am trying to get it to connect to the same object on the remote machine. I am attempting to impersonate the user on the remote system like so (variable definitions and error handling omitted):</p>\n\n<pre><code>if (LogonUser(\n       userName,\n       domain,\n       password,\n       LOGON32_LOGON_NEW_CREDENTIALS,\n       LOGON32_PROVIDER_WINNT50,\n       out token) != false)\n{\n      if (DuplicateToken(token, (int)_SECURITY_IMPERSONATION_LEVEL.SecurityDelegation, out tokenDuplicate) != false)\n      {\n            impersonationContext = WindowsIdentity.Impersonate(tokenDuplicate.DangerousGetHandle());\n      }\n }\n</code></pre>\n\n<p>Which is then followed by similar code to create the object:</p>\n\n<pre><code>MyDCOMType dcomObject;\nType remoteSessionContextType = Type.GetTypeFromProgID(\"ServerApp.MyDCOMType\", ipAddress);\ndcomObject = (MyDCOMType)Activator.CreateInstance(remoteSessionContextType);\nstring version = dcomObject.GetVersion();\n</code></pre>\n\n<p>Except that the CreateInstance call throws an UnauthorizedAccessException error with error code 80070005 for unauthorized access.</p>\n\n<p>The other thing is that I have C++ code that does the same thing that works perfectly. That code goes like so:</p>\n\n<pre><code>COAUTHINFO      AuthInfo;\nCOAUTHIDENTITY  AuthIdentity;\nCOSERVERINFO    ServerInfo;\nMULTI_QI        Results;\nHRESULT     hr;\nBSTR        version;\n_MyDCOMType     *pSession = NULL;\n\nAuthIdentity.Domain             = (unsigned short *) w_domain;\nAuthIdentity.DomainLength       = wcslen( w_domain);\nAuthIdentity.Flags              = SEC_WINNT_AUTH_IDENTITY_UNICODE;\nAuthIdentity.Password           = (unsigned short *) w_password;\nAuthIdentity.PasswordLength     = wcslen(w_password);\nAuthIdentity.User               = (unsigned short *) w_username;\nAuthIdentity.UserLength         = wcslen(w_username);\n\nAuthInfo.dwAuthnLevel           = RPC_C_AUTHN_LEVEL_CALL;\nAuthInfo.dwAuthnSvc             = RPC_C_AUTHN_WINNT;\nAuthInfo.dwAuthzSvc             = RPC_C_AUTHZ_NONE;\nAuthInfo.dwCapabilities         = EOAC_NONE;\nAuthInfo.dwImpersonationLevel   = RPC_C_IMP_LEVEL_IMPERSONATE;\nAuthInfo.pAuthIdentityData      = &amp;AuthIdentity;\nAuthInfo.pwszServerPrincName    = NULL;\n\nServerInfo.dwReserved1  = 0;\nServerInfo.dwReserved2  = 0;\nServerInfo.pAuthInfo    = &amp;AuthInfo;\nServerInfo.pwszName     = w_nodename;\n\nhr = CoCreateInstanceEx(clsid, NULL, CLSCTX_ALL, &amp;ServerInfo, (ULONG) 1, &amp;Results);\nhr = CoSetProxyBlanket(Results.pItf, RPC_C_AUTHN_WINNT, RPC_C_AUTHZ_NONE, NULL,\n    RPC_C_AUTHN_LEVEL_CALL, RPC_C_IMP_LEVEL_IMPERSONATE, &amp;AuthIdentity, EOAC_NONE);\npSession = (_MyDCOMType *)Results.pItf;\n\nhr = pSession-&gt;raw_GetVersion(&amp;version);\n</code></pre>\n\n<p>It connects to the remote server, creates the DCOM object, and gets data from it just fine. I'd like to figure out how to get my C# code to do the same. Any ideas? Did I mess up one of the enums going to the functions? Am I missing some critical call or doing something all wrong? As background, my computer and the computer I am trying to connect to are both logged in under domain accounts, but neither has permissions on the other. The C++ code impersonates the remote user for the purpose of the DCOM connection. I am trying to do a .NET impersonation in such a way that it will be valid for the network connection given a manually entered username and password.</p>\n\n<p>Alternatively, if it just isn't possible, I suppose I could write a small C++/CLR DLL with the same C++ code to handle the DCOM connection part and reference it from the C# code, but I'm hoping to avoid the extra complexity.</p>\n"},{"tags":["c#",".net","mef"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13078821,"title":"MEF Composition ImportMany yield two versions of same class","body":"<p>I haven't been able to find an answer for my problem. I'm using MEF to find and create my classes that implement IPlugIn, but I end up with two versions of each PlugIn class. I have determined that the AggregateCatalog only contains one Assembly that contains only 1 type of each class as a Part, but I am still getting two instances of each as the end result. I'm probably just doing something stupid, but I haven't found it yet. I'd appreciate any help...</p>\n\n<pre>\n\n...\n\n    [ImportMany(typeof(IPlugIn))]\n     public System.Lazy>[] Plugins { get; set; }\n\n...\n    //aggregatecatalog only contains one dll containing plugin classes, 4 of them\n    container = new CompositionContainer(aggregateCatalog,\n                                         CompositionOptions.DisableSilentRejection \n                                         | CompositionOptions.IsThreadSafe);\\\n\n    container.SatisfyImportsOnce(this);\n\n    ...\n    public void StartAll()\n    {\n    //We have 8 PlugIns here?? How? \n    if (Plugins == null || Plugins.Count() == 0)\n    {\n\n       log.Warn(\"No PlugIns Available to Start!\");\n       return;\n    }\n\n        foreach (var plug in Plugins)\n        {\n            log.Info(\"Starting PlugIn: \" + plug.Value.GetName());\n            plug.Value.Start();\n        }\n    }\n\n   ...\n\n    [Export(typeof(IPlugIn))]\n    public class MyPlugIn : BasePlugIn, IPlugIn\n\n    ...\n\n</pre>\n\n<p>I'm debugging in Visual Studio. I clearly see only one Assembly loading. The CompositionContainer has only 1 of each. After SatisfyImportOnce in StartAll(), I have two instances of each IPlugIn classes. Is this something with the way I am using ImportMany? I am open to any ideas. </p>\n"},{"tags":["c#",".net","sift"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":8444503,"title":"Scale-invariant feature transform C#","body":"<p>Do you know if there is any implementation of Scale-invariant feature transform available in C# .NET? </p>\n\n<p>There is one available in <a href=\"http://www.nowozin.net/sebastian/tu-berlin-2006/libsift/\" rel=\"nofollow\">MONO</a>, but Im having many problems trying to run it.</p>\n"},{"tags":["c#",".net","windows","environment-variables","class-library"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13275338,"title":"How to resolve environment variables programatically in C# without using Environment Enum?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4726818/expand-environment-variable-for-my-documents\">Expand environment variable for My Documents</a>  </p>\n</blockquote>\n\n\n\n<p>We often use %% delimited environment variables in Command prompt in Windows Xp, 7, Vista, Server 2003-2008R2 and possibly in future windows versions. Examples are:</p>\n\n<pre><code>%windir%\n%systemroot%\n%temp%\n</code></pre>\n\n<p>I need to be able to programatically resolve these environment variables using C#.</p>\n\n<p>Please do not suggest <code>Environmen.SpecialFolder</code> , because i am getting values from a webservice in the above formats and i need to able to programmatically resolve them and determine physical location of these paths on server. My scenario is a class libarary project and i may <strong>NOT</strong> require/be able to use <code>Server.MapPath</code></p>\n\n<p>I am looking for a generic method builtin or custom that can help me resolve all environment variables pro grammatically and calculate local physical paths from these variables just Command Prompt or Windows Explorer or Run Command does !</p>\n\n<p>I have seen questions similar to these on StackOverFlow but couldn't find any marked answers. Please note that <code>Environment.Xxxxx Enum</code> doesnt cater for the scenario i am working through.</p>\n\n<p>Any help is appreciated. I am using .NET 4.0 Complete Framework Profile with C#.</p>\n"},{"tags":[".net","system.reactive"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":271,"score":2,"question_id":10818214,"title":"Is Reactive Extensions open-source?","body":"<p>Is Reactive Extensions open-source? Will Microsoft open-source it?</p>\n\n<p>I'm looking to read the source code to better understand how it's implemented. I'd like to see the unit tests, so I can run them against some of my own code reimplementing some of <code>Reactive.Linq</code>.</p>\n\n<p>I know Microsoft open-sourced F# which is handy for developers <a href=\"https://github.com/fsharp/fsharp\" rel=\"nofollow\">https://github.com/fsharp/fsharp</a></p>\n"},{"tags":["c#",".net","linq","extension-methods"],"answer_count":1,"favorite_count":6,"up_vote_count":5,"down_vote_count":0,"view_count":45,"score":5,"question_id":13279215,"title":"Wrap a Linq query in a try/catch block using a method declaration","body":"<p>So here is what I would like to be able to do.</p>\n\n<pre><code>var a = Item.CatchLog().Where(x=&gt;x.Property==\"value\").Take(10);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().FirstOrDefault(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var a = Item.CatchLog().Any(x=&gt;x.Property==\"value\");\n</code></pre>\n\n<p>Essentially, I would like is for <code>CatchLog()</code> to basically wrap the execution of the query in a try catch, and <code>Debug.WriteLine()</code> the <code>Exception</code> and then <code>throw</code> it. </p>\n\n<p>Any ideas on how I could implement something like this?</p>\n"},{"tags":[".net","string","parameterized"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13279065,"title":"How to implement parameterised string?","body":"<p>My app needs to allow the user to input and save a generic parameterised string.  </p>\n\n<p>What is the best way to do this in .NET?</p>\n\n<p>Currently I allow the user to input a string with pre-defined \"parameters\" into a textbox.</p>\n\n<blockquote>\n  <p>eg. \"Hi %%Name%%, please pick up your order number %%Order%%.\"</p>\n</blockquote>\n\n<p>This generic string is then stored and then populated with real data as and when needed.  The population is done simply by a series of these type of statements:</p>\n\n<pre><code>Str1.Replace(\"%%Name%%\", data.Name)\nStr1.Replace(\"%%Order%%\", data.Order)\n</code></pre>\n"},{"tags":["c#",".net","pdf","epub"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13279243,"title":"Validation for epub file and convert epub file to pdf","body":"<p>I have <strong>large</strong> volumes of epub files coming to my server. I have to validate epub file. I am not sure what should I do to validate for valid epub files. </p>\n\n<p>1.Anything specifically I should be validating for checking valid epub files.<br>\n2. What is the best way to convert epub to pdf files.</p>\n\n<p>I am using C# for coding. </p>\n"},{"tags":["c#","asp.net",".net"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13279200,"title":"Session becomes null?","body":"<p>When operating on a HttpSessionStateWrapper object, sometimes it becomes null in the middle of an operation.  In the following code sample, otherSession is NOT the current session. It's the session of a different user:</p>\n\n<pre><code>string id = otherSession == null ? \"\" : otherSession.SessionID; \n</code></pre>\n\n<p>The above line will occasionally fail with a NullReferenceException.  My guess is that after otherSession is checked for null but before the SessionID property is accessed, otherSession is set to null in another thread (not my own thread, but elsewhere in asp.net) so that when the SessionID property is accessed the NullReferenceException occurs. </p>\n\n<p>I am wondering </p>\n\n<ol>\n<li>What causes otherSession to be set to null?</li>\n<li>How can I replicate the circumstances that result in otherSession becoming null so I can ensure my handling of that scenario is adequate?</li>\n</ol>\n"},{"tags":["c#",".net","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13278793,"title":"Regex end-of-line anchor doesn't always work","body":"<p>I'm working on an ASP .NET (C#) project that makes use of regular expressions and I'm having trouble with the end-of-line anchors! I'm looking for some text and I want to make sure it only occurs at the end of a string.</p>\n\n<p>Here's some sample input that demonstrates my problem. For this case I'm trying to match the word \"text\" at the end.</p>\n\n<blockquote>\n  <p>This text is my sample text</p>\n</blockquote>\n\n<p>And here are the expressions I've tried (with the IgnoreCase option):</p>\n\n<pre><code>text\\z\ntext\\Z\ntext$\n</code></pre>\n\n<p>Now here's the crazy part. None of these regular expressions work on my system (Windows 8 Pro 64-bit, VS2010, .NET 4.0). I've debugged in my project and I've also tried the \"Regex Tester\" app from the Windows 8 store. It will not match!</p>\n\n<p>However, if I use an online regex tester, for example Derek Slager's at <a href=\"http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx\" rel=\"nofollow\">http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx</a> which runs on .NET, or this Silverlight one at <a href=\"http://regexhero.net/tester/\" rel=\"nofollow\">http://regexhero.net/tester/</a>, using the exact same patterns and inputs, it matches the final instance of \"text\" with no problem.</p>\n\n<p>I'm confused. I really need reliable end-of-string matching and I don't know what I'm doing wrong.</p>\n\n<p>EDIT: Apparently I can't used compiled regex's. Here's an example using the data the project actually runs on:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        string url = \"http://192.168.0.113/MidlandGIS/rest/services/Osceola_Assessor_Data/MapServer/?f=pjson\";\n        string pattern = @\"mapserver/\\?f=(json|pjson)$\";\n\n        Regex myRegex = new Regex(pattern, RegexOptions.IgnoreCase &amp; RegexOptions.Compiled);\n        Console.Write(\"Trying compiled regex: \");\n        if (myRegex.IsMatch(url))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match.\");\n\n        myRegex = new Regex(pattern, RegexOptions.IgnoreCase);\n        Console.Write(\"Trying non-compiled regex: \");\n        if (myRegex.IsMatch(url))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match.\");\n\n        Console.Write(\"Trying inline regex: \");\n        if (Regex.IsMatch(url, pattern, RegexOptions.IgnoreCase))\n            Console.WriteLine(\"Match\");\n        else\n            Console.WriteLine(\"No match\");\n\n        Console.Write(\"Press any key to terminate.\");\n        Console.ReadKey();\n    }\n}\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>Trying compiled regex: No match\nTrying non-compiled regex: Match\nTrying inline regex: Match\nPress any key to terminate.\n</code></pre>\n\n<p>Edit again: OK I'm a complete idiot. I was using bitwise AND when I should be using bitwise OR to combine the regex options. Compiled regex's work just fine now.</p>\n"},{"tags":["c#",".net","xml","linq","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13278778,"title":"How to use XElement.Parse and then find the value of a specific element?","body":"<p>I've got some XML that is returned from a REST call that looks like this:</p>\n\n<pre><code>&lt;ArrayOfProperty xmlns=\\\"http://schemas.microsoft.com/HPCS2008R2/common\\\" xmlns:i=\\\"http://www.w3.org/2001/XMLSchema-instance\\\"&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;Id&lt;/Name&gt;\n    &lt;Value&gt;17&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;StartTime&lt;/Name&gt;\n    &lt;Value&gt;11/7/2012 9:13:50 PM&lt;/Value&gt;\n  &lt;/Property&gt;\n  &lt;Property&gt;\n    &lt;Name&gt;State&lt;/Name&gt;\n    &lt;Value&gt;Failed&lt;/Value&gt;\n  &lt;/Property&gt;\n</code></pre>\n\n<p>I'm using the RestSharp API to assist in executing the API calls and trying to use the linq-to-xml XElement.Parse to parse the results.  I'm not sure how to get the value of the state such that from within this document I want to do something like :</p>\n\n<p><code>XElement.Parse(XMLstring).Elements???</code> to get the text \"Failed\" from the set of elements that contains the element State but I want the text \"Failed\" from the <code>&lt;Value&gt;Failed&lt;/Value&gt;</code> element.  That value element can have multiple values but I always want the value that is associated with the state.</p>\n\n<p>Any ideas?</p>\n"},{"tags":[".net","xml"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13278861,"title":"How can I preserve XML character classes when using the .NET XmlDocument class?","body":"<p>I'm loading a string containing some html into an XmlDocument class, in order to do some manipulation on it, before converting it back into a string again.</p>\n\n<p>The following code demonstrates what I'm doing;</p>\n\n<pre><code>    // Example of the HTML I am working with\n    var documentTypeDeclaration = \"&lt;!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Transitional//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\\\"&gt;\";\n    var html = documentTypeDeclaration + \"&lt;html&gt;&lt;body&gt;&lt;div&gt;&amp;#163;300&amp;#160;&amp;#169;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;\";\n\n    // Load the HTML into an XmlDocument\n    var xmlDocument = new XmlDocument();\n    xmlDocument.XmlResolver = null;\n    xmlDocument.LoadXml(html);\n\n    // Manipulate the HTML...\n\n    // Get the HTML back out\n    var savedHtml = xmlDocument.OuterXml;\n    Console.WriteLine(html);\n    Console.WriteLine(savedHtml);\n</code></pre>\n\n<p>I would expect the two lines output to the Console to match, but instead I get this-</p>\n\n<pre><code>    &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;&lt;html&gt;&lt;body&gt;&lt;div&gt;&amp;#163;300&amp;#160;&amp;#169;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;\n    &lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"[]&gt;&lt;html&gt;&lt;body&gt;&lt;div&gt;£300 ©&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>So it looks like [] has been added to the doc type declaration, and all the HTML character classes have been converted to their actual characters. This is particularly annoying as the HTML is now no longer standards compliant.</p>\n\n<p>Does anyone know how I can stop the XmlDocument class from doing this?</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13278522,"title":"How to add a context menu for only one level in a TreeView","body":"<p>I've got a TreeView, containing a number of levels of <code>TreeViewItems</code>.</p>\n\n<p>I would like to add a context menu to only one level of items in the TreeView. However, my code produces a result whereby every single item in the TreeView has a context menu.</p>\n\n<p>This is my code:    </p>\n\n<pre><code>//.... foreach item in this level.... \n\n{\nContextMenu cmDatabase = new ContextMenu();\nMenuItem menuItem = new MenuItem();\nmenuItem.Header = \"Close Connection\";\nImage imgMenuIcon = new Image();\nimgMenuIcon.Source = new BitmapImage(new Uri(\"icon.png\"));\nmenuItem.Icon = imgMenuIcon;\ncmDatabase.Items.Add(menuItem);\ntreeViewItem.ContextMenu = cmDatabase;\n}\n</code></pre>\n\n<p>I've also tried manually setting all the other TreeViewItems' contextMenu property to null.  No luck though.  Any ideas?</p>\n"},{"tags":[".net","sql-server","wpf","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":10,"score":3,"question_id":13278889,"title":"How to add data to SQL Server Express database using Entity Framework","body":"<p>I'm writing simple program for my university. I created an Entity Framework model, draw diagrams, created database from model, applied SQL file on my database and now I'm trying to add some items to the DB. </p>\n\n<p>I'm doing it this way:</p>\n\n<pre><code>using (NewsletterEntities context = new NewsletterEntities())\n{\n   Sender newSender = new Sender();\n   newSender.Login = Login.Text;\n   newSender.Password = Password.Text;\n   newSender.Port = 23;\n   newSender.SMTP = SMTP.Text;\n   newSender.Email = Email.Text;\n   newSender.SenderID = 0;\n\n   context.Senders.AddObject(newSender);\n   context.SaveChanges();\n}\n</code></pre>\n\n<p>When I try to execute it it pops up with inner exception: </p>\n\n<blockquote>\n  <p>Cannot insert explicit value for identity column in table 'Senders' when IDENTITY_INSERT is set to OFF.</p>\n</blockquote>\n\n<p>I was trying to look for the error, but I don't know much about entity framework and couldn't find anything specific.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":[".net","authentication","iis-7.5","webdav","mapped-drive"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":111,"score":1,"question_id":13128341,"title":"Custom authentication when mapping network drive - is this possible?","body":"<p>I've got a virtual directory set up in my web site in IIS 7.5 that users can map a network drive to. What I'd like to do is set up some sort of custom authentication where the user chooses \"connect with different credentials\" when they map the drive, and then I can use those credentials to log them into my website before letting them view the contents of the virtual directory. Is this possible?</p>\n\n<p>I can't seem to find a way to (programatically) get the credentials used when mapping the drive. Right now I've got an <code>HttpModule</code> and <code>HttpHandler</code> executing on each request to the virtual directory, but I'm not seeing a way to detect credentials. Has anyone ever done anything like this?</p>\n\n<p>If this isn't possible, can someone explain what the purpose is then for choosing to connect with different credentials? Where are those credentials used, is it used by a certain form of Authentication in IIS? Surely there has to be some sort of setup for <em>using</em> the different credentials?</p>\n\n<p><strong>UPDATE:</strong> </p>\n\n<p>Using Digest Authentication, I can now see the Authorization header showing up in Fiddler, but I'm not yet sure if it is possible to parse the password out somehow. I've also seen some articles online that suggest Digest Authentication is fundamentally flawed, but according to <a href=\"http://msdn.microsoft.com/en-us/library/ee817643.aspx\" rel=\"nofollow\">Authentication in ASP.NET: .NET Security Guidance</a>, I shouldn't use Basic Authentication if my users are stored in a custom database. </p>\n\n<p><strong>So let me lay out a simpler scenario that will hopefully be easier to answer:</strong></p>\n\n<p>I'm trying to implement custom authentication used when mapping a network drive to a virtual directory in my site. I'm using IIS 7.5. I need to parse out the username and password to handle the custom log-in, either in an <code>HttpModule</code> or a Global.asax event. Has anyone ever done anything like this or have any advice/suggestions?</p>\n\n<p>I've found <a href=\"http://blog.smithfamily.dk/2008/08/27/ImplementingBasicAuthenticationInASPNET20.aspx\" rel=\"nofollow\">this example which seems like it could work</a> - but it's meant for a browser. I've got it implemented now on my test site but the problem is when mapping the drive, the 401 challenge is returned (which is supposed to prompt for a log-in) but Windows instead displays an error that says:</p>\n\n<blockquote>\n  <p>Windows cannot access <code>Http://myServer/mySite/myFolder</code></p>\n  \n  <p>Check the spelling of the name. Otherwise, there might be a problem with your\n  network.</p>\n  \n  <p>Error code: 0x80070043 The network name cannot be found</p>\n</blockquote>\n\n<p>I'm wondering if I can format/build a Basic/Digest Authentication-style challenge response so that Windows will prompt for a log-in rather than displaying the network can't be found? Does anyone know if this is possible?</p>\n\n<p><strong>UPDATE 2:</strong></p>\n\n<p>I saw using Fiddler, that Windows Authentication includes a <code>Negotiate</code> header. So I tried including that header in my challenge response in addition to the <code>WWW-Authenticate: Basic</code> header. This seems to have fixed my problem with the \"network name cannot be found\" error described above, but unfortunately now there is no Authorization header included in the subsequent request (after I provide my credentials) so I can't pull out the username and password.</p>\n\n<p>I'm running out of ideas here, and while there seems to be a lot of documentation on Authentication, there doesn't seem to be much on WebDAV Authentication (or how to use it), or custom authentication when mapping drives. </p>\n\n<p>Does anyone have any insight or ideas?</p>\n"},{"tags":["c#",".net","itextsharp","pdfsharp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2466,"score":0,"question_id":6363135,"title":"adding new pages to existing pdf using iTextSharp","body":"<p>I have a pdf file with 1 page.Now I want to add two more pages to it with some data or image.\nI tried this but it doesnot adding new pages :</p>\n\n<pre><code>private void addPage()\n   {\n     Document document = new Document();\n     writer = PdfWriter\n        .GetInstance(document, new FileStream(outputFileName, FileMode.Create));\n\n        document.Open();\n\n        PdfContentByte cb = writer.DirectContent;\n\n\n     for (int pageNumber = 1;pageNumber &lt; reader.NumberOfPages + 2;pageNumber++)\n        {\n            document.SetPageSize(reader.GetPageSizeWithRotation(1));\n            document.NewPage();\n\n            if (pageNumber == 1)\n            {\n                Chunk fileRef = new Chunk(\" \");\n                fileRef.SetLocalDestination(newPdf);\n                document.Add(fileRef);\n            }\n\n            PdfImportedPage page = writer.GetImportedPage(reader, pageNumber);\n            int rotation = reader.GetPageRotation(pageNumber);\n            if (rotation == 90 || rotation == 270)\n            {\n                cb.AddTemplate(\n                    page, 0, -1f, 1f, 0, 0,\n                    reader.GetPageSizeWithRotation(pageNumber).Height\n                );\n            }\n            else\n            {\n                cb.AddTemplate(page, 1f, 0, 0, 1f, 0, 0);\n            }\n        }\n        document.NewPage();\n\n        Paragraph paragraph = new Paragraph();\n        iTextSharp.text.Font titleFont =\n            new iTextSharp.text.Font(\n                iTextSharp.text.Font.FontFamily.HELVETICA\n                , 15\n                , iTextSharp.text.Font.BOLD\n                , BaseColor.BLACK\n            );\n        Chunk titleChunk = new Chunk(\"Comments\", titleFont);\n        paragraph.Add(titleChunk);\n        document.Add(paragraph);\n\n        paragraph = new Paragraph();\n        iTextSharp.text.Font textFont =\n            new iTextSharp.text.Font(\n                iTextSharp.text.Font.FontFamily.HELVETICA\n                , 12\n                , iTextSharp.text.Font.NORMAL\n                , BaseColor.BLACK\n            );\n        Chunk textChunk = new Chunk(\"\", textFont);\n        paragraph.Add(textChunk);\n\n        document.Add(paragraph);\n        }\n\n        document.Close();\n\n  }\n</code></pre>\n"},{"tags":[".net","winforms","tabs","tabcontrol","delphi-prism"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13278682,"title":"How to display only tabs control header using Tabcontrol?","body":"<p>I only want tabs not the tabpages. So, how do you hide or delete tabpages but not the tab control headers? I just need tabs only.</p>\n\n<p>I am working with Framework 3.5.</p>\n"},{"tags":["c#",".net","multithreading","system.reactive"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13270559,"title":"ReplaySubject.First() blocks unexpectedly","body":"<p>I am encountering an absolutely bizarre behaviour in a Silverlight application on which I am working. Please see the following code:</p>\n\n<pre><code>var replaySubject = new ReplaySubject&lt;string&gt;(1);\n    replaySubject.OnNext(\"This can never block... surely?\");\n\nvar s = replaySubject.First();\nDebug.WriteLine(s);\n</code></pre>\n\n<p>Basically, my app comes through this piece of code repeated and it always prints out the message... except for in one particular scenario in which the thread blocks on the <code>First()</code> line.</p>\n\n<p>It's always on the UI thread. If I set a break point on the line with <code>First()</code>, and drill into the <code>replaySubject</code> with the debugger, I can see the string in its queue.</p>\n\n<p>Can anyone think of any scenario that would cause the <code>First()</code> call to block here?</p>\n\n<p>BTW: It's RX version 1.1.11111</p>\n"},{"tags":["c#",".net","visual-studio-2010","properties","designer"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1791,"score":3,"question_id":7437004,"title":"How to make a User control property of type Collection<MyClass> editable in Form Designer?","body":"<p>Today at work, I stumbled upon a problem that was driving me nuts.</p>\n\n<p>Basically my goal is this:</p>\n\n<p>I have a <code>UserControl1</code>, with a field of the type <code>Collection&lt;Class1&gt;</code> and a corresponding property <code>Collection&lt;Class1&gt; Prop</code>. Like this:</p>\n\n<pre><code>public class UserControl1 : UserControl\n{\n    private Collection&lt;Class1> field = null;\n    // later changed to:\n    //private Collection&lt;Class1> field = new Collection&lt;Class1>();\n    [Category(\"Data\")]\n    [DefaultValue(null)]\n    [Description(\"asdf\")]\n    public Collection&lt;Class1> prop\n    {\n        get { return field; }\n        set { field = value; }\n    }\n}</code></pre>\n\n<pre><code>// later added:\n//[Serializable]\npublic class Class1\n{\n    private bool booltest; public bool Booltest { get...set...}\n    private int inttest; public int Inttest { get...set...}\n}</code></pre>\n\n<p><b>If you already know what I screwed up: no need to read the rest.</b> I am going to describe what exactly I did.</p>\n\n<p>Now I put the <code>UserControl</code> onto a random Form and change the <code>Prop</code> property. A generic \"Collection Editor\" appears, like the one used for the columns and groups in a listview control. I can enter data as expected. However, when I click OK, the data is gone.</p>\n\n<p>It took me over hour to figure out that I actually have to instantiate my field: <code>private Collection&lt;MyClass&gt; field = new Collection&lt;MyClass&gt;();</code>. Very good, only that the designer entered superspazzing mode. Cascading nightmare error message that can be reduced to: \"You must put <code>[Serializable]</code> before your <code>Class1</code>.\" After doing that I could actually put my <code>UserControl1</code> on the Form again.</p>\n\n<p>But that only works once. When opening the designer of the Form where I use the <code>UserControl1</code> after editing something, it gives me an error:</p>\n\n<p><code>Object of type 'userctltest.Class1[]' cannot be converted to type 'userctltest.Class1[]'.</code></p>\n\n<p>Well. The Error List says:</p>\n\n<p><code>Warning: ResX file Object of type 'userctltest.Class1[]' cannot be converted to type 'userctltest.Class1[]'. Line 134, position 5. cannot be parsed.</code></p>\n\n<p>The designer tries to fetch the Property's data from the resx file. Removing the resx file \"solves\" that exactly once.</p>\n\n<p>The Form can now be displayed again, with my <code>UserControl1</code>. The Collection property <em>is</em> editable, and it is being saved. It actually works. Once. Whenever I change something and then try to open the Form's designer again, the above error occurs again. I can delete the resx file, but that will of course also delete my data.</p>\n\n<p>Relevant resources that helped me so far (among a ton of not so helpful search results):</p>\n\n<p><a href=\"http://www.codeproject.com/Answers/190675/Usercontrol-with-custom-class-property#answer1\" rel=\"nofollow\">http://www.codeproject.com/Answers/190675/Usercontrol-with-custom-class-property#answer1</a><br>\n<a href=\"http://www.codeproject.com/KB/cs/propertyeditor.aspx\" rel=\"nofollow\">http://www.codeproject.com/KB/cs/propertyeditor.aspx</a><br>\n<a href=\"http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=94\" rel=\"nofollow\">http://www.csharpfriends.com/Articles/getArticle.aspx?articleID=94</a><br>\n<a href=\"http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx</a><br></p>\n\n<p>(I also tried implementing ISerializable and overriding GetObjectData with</p>\n\n<p><code>{ info.AddValue(\"testbool\", testbool); info.AddValue(\"testint\", testint); }</code></p>\n\n<p>didn't help either (I also tried the property names instead of the field names))</p>\n\n<p>Sorry for writing this like a bad horror novel btw.</p>\n"},{"tags":[".net","html","internet-explorer","webbrowser-control"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13278717,"title":"WebBrowser control screws up HTML","body":"<p>I know several posts have talked around this but I want to know if anyone out there has gotten an XP version of the .net WebBrowser control to NOT screw up the HTML of the document.  I am using the WebBrowser control in a Winforms program as an HTML editor.  I auto-generate some standards compliant html but as soon as I view it in the WebBrowser control it completely reformats the HTML.  My users may be on XP so I must support the IE8 version of WebBrowser control.</p>\n\n<p>I'm using the following code to create an html editor:</p>\n\n<pre><code>Me.WebBrowser1.Navigate(\"about:blank\")  ' this initializes the control\n' This creates a new htmldocument, also disables undo, the meta tag and doctype help with formatting\nMe.WebBrowser1.Document.Write(\"&lt;!DOCTYPE HTML&gt;\" + _\n    \"&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\"\"X-UA-Compatible\"\" content=\"\"IE=8\"\" /&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;\")\n' Enables edit mode and undo, requires that Option Explicit be set to off\nMe.WebBrowser1.ActiveXInstance.Document.DesignMode = \"On\"\nMe.WebBrowser1.Document.Body.InnerHtml = \"some standard compliant HTML\"\n</code></pre>\n\n<p>I have tried different combinations or DocType and X-UA-Compatible and have not found any IE8 compatible combination that works.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#",".net","asp.net-mvc","architecture","n-tier"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13278329,"title":"Business Layer Facade vs Mingled Business Components","body":"<p>I'm currently designing the foundation for a large application.  We are going with the traditional 3 tier system using EF in the data layer, plain jane c# classes in the business layer and MVC / WCF for the ui layer.  We have prototyped enough of the application to realize that this will work for us, however due to the complexity of the business requirements <strong>it will be common for some of the business components interact with one another.</strong></p>\n\n<p>Consider the following two business components:</p>\n\n<ul>\n<li>RetailManager - Deal with everything related to retail in the system</li>\n<li>CartManager - Deals with everything related to the shopping cart experience</li>\n</ul>\n\n<p>The two interact, for instance, during the checkout process when an item is purchased.  The inventory for the purchased item needs to be reduced.</p>\n\n<p>Here is my thought process so far:</p>\n\n<ol>\n<li><p>Let business components reference each other and ensure cyclical references never happen (CartManager references RetailManager, but never the other way).  \"Checkout\" would be a method on the CartManager class, and it would call a method on the RetailManager to adjust inventory.  While this will work, I'm not sure how well it will scale, and what the maintenance cost will be over time.  It doesn't feel 100% \"right\" to me.</p></li>\n<li><p>Create a Facade between the business components and the UI tier.  In this example, the Facade would have the checkout method and a reference to both managers.  I like this approach more than the first, however I know that not all of my business objects will need a Facade, and I don't want to create a ton of Facade classes just to have empty pass through methods.</p></li>\n</ol>\n\n<p>I'm leaning towards 2, with the caveat that I will only create facade classes where needed.  The UI tier will have access to both the Facade and the business layer components and will have to know when to use which (the only part I don't like about this solution).</p>\n\n<p>I've done a lot of research but haven't been able to come to come up with a solution that feels completely right.</p>\n\n<p>Any thoughts on using the facade pattern in this way, or other ideas to solve the problem are welcome.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":[".net","vb.net","visual-studio-2010","process"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13277622,"title":"Having issue with displaying processes in combobox","body":"<p>In my application a user clicks a button then a form loads and in this form there is a combobox that generates a window process list and displays the window names.</p>\n\n<p>It always works fine in visual studio, although when I launch a compiled version I always get this error \"Process {0} not found.</p>\n\n<p>I thought this meant it had no processes to read so I added some code to only display if the amount is greater than or equal to 1 and it didn't help. </p>\n\n<p>Does anyone see my issue?</p>\n\n<pre><code>     Dim ProcessList() As Process = Process.GetProcesses\n    If ProcessList.Count() &gt;= 1 Then\n        For I = 0 To UBound(ProcessList)\n            If ProcessList(I).MainWindowTitle.ToString = \"\" = False Then\n                ComboBox1.Items.Add(ProcessList(I).MainWindowTitle.ToString)\n            End If\n\n\n        Next\n    Else\n        ComboBox1.Items.Add(\"No windows found\")\n    End If\n</code></pre>\n"},{"tags":["c#",".net","wpf","mvvm","avalonedit"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":288,"score":2,"question_id":12344367,"title":"Making AvalonEdit MVVM compatible","body":"<p>I'm trying to make Avalon MVVM compatible in my WPF application. From googling, I found out that <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">AvalonEdit is not MVVM friendly</a> and I need to export the state of AvalonEdit by making a class derived from TextEditor then adding the necessary dependency properties. I'm afraid that I'm quite lost in Herr Grunwald's answer <a href=\"http://community.sharpdevelop.net/forums/t/11587.aspx\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>If you really need to export the state of the editor using MVVM, then I suggest you create a class deriving from TextEditor which adds the necessary dependency properties and synchronizes them with the actual properties in AvalonEdit.</p>\n</blockquote>\n\n<p>Does anyone have an example or have good suggestions on how to achieve this?</p>\n"},{"tags":[".net",".net-4.0",".net-3.5","app-config","infopath"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":11870716,"title":"Opening InfoPath forms in .Net 4.0","body":"<p>I'm working on upgrading an older application from .Net 2 to .Net 4. The program utilizes infopath forms, and they are causing a fair amount of annoyance to get working. First, it was throwing a FileLoadException, with the message \"Mixed mode assembly is built against version 'v2.0.50727' of the runtime and cannot be loaded in the 4.0 runtime without additional configuration information.\" I did some research and added the following to my app.config file:</p>\n\n<pre><code>&lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;\n&lt;/startup&gt;\n</code></pre>\n\n<p>I then re-ran the application out of Visual Studio, and when it just tries to open a form, it now throws a COMException, and that \"This method explicitly uses CAS policy, which has been obsoleted by the .NET Framework. In order to enable CAS policy for compatibility reasons, please use the NetFx40_LegacySecurityPolicy configuration switch.\" So I do. I added the following to my app.config file:</p>\n\n<pre><code>&lt;runtime&gt;\n    &lt;NetFx40_LegacySecurityPolicy enabled=\"true\"/&gt;\n&lt;/runtime&gt;\n</code></pre>\n\n<p>Now when it tries to open an InfoPath form, it tells me that I need to install .Net 3.5 onto my computer. I guess my question from all of this is, do I really have to install the .Net 3.5 framework onto a computer to get this application running, even though it is in .Net 4.0? The compact version of .Net 3.5 doesn't work, and I'm assuming this is all over the CAS changes from 3.5 to 4.0, but I'm hoping there's a programmatic way to rememdy this and open/save InfoPath forms without having to make the user install another Framework onto their computer.</p>\n"},{"tags":[".net","sql"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13278234,"title":"How to do a SQL with an IF condition on one column","body":"<p>I got a quick question about if this is possible within a SQL statement for an ASPX page. </p>\n\n<p>Let's say there are three columns, <code>USER</code>, <code>Password</code>, and <code>permission</code>. </p>\n\n<p>If within my <code>SELECT</code> statement I want to only select <code>USER</code> and <code>PASSWORD</code> only when <code>Permission</code> is <code>&gt; 2</code>, and if it is less than 2 I only want to show <code>USER</code>. </p>\n\n<p>Is this possible? Or will I have to do this within my presentation layer?</p>\n"},{"tags":["c#",".net","office-automation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":27,"score":1,"question_id":13172108,"title":"Loading an excel application with a file opened inside a windows .NET client app","body":"<p>How to load an Excel application inside an .NET Windows client application?</p>\n\n<p>The excel application should be hosted in windows form just a like any windows user control.</p>\n\n<p>The loaded excel application will open a excel file created already.</p>\n\n<p>Thanks</p>\n"},{"tags":["asp.net",".net","wcf","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13276846,"title":"How to get the binding address from a WSDL file","body":"<p>I generated a proxy class given a URL to a WSDL.</p>\n\n<p>I need to let the end-user change the service's URL to his specific URL, like this:</p>\n\n<pre><code>ServiceProxy.Url = [URL set by end-user];\n</code></pre>\n\n<p>The issue is that this URL should not point to the WSDL, it should be the binding address which is found within the WSDL (wsdl:service -> wsdl:port -> wsdl:address) (this is a SAP web service, I understand that is why I must use the binding address).</p>\n\n<p>I am thinking of using the XDocument class to get that value, but I am wondering if there is any \"built-in\" functionality in WCF or web services to get the binding address. Thank you.</p>\n"},{"tags":[".net","asp.net-mvc-3","web-config","nuget"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13274580,"title":"Nuget web.config.transform oddly merges dependentAssembly section","body":"<p>I just created a custom nuget package with the goal of packaging our Devart dlls s.t. we have a proper versioning and updating mechanism in place throughout all of our projects.</p>\n\n<p>The structure of the Nuget package is according to the instructions on the <a href=\"http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package\" rel=\"nofollow\">offical wiki</a> and looks as follows:</p>\n\n<ul>\n<li>DevartOracle\n<ul>\n<li>content\n<ul>\n<li>web.config.transform</li>\n</ul></li>\n<li>lib\n<ul>\n<li>Devart.Data.Oracle.dll</li>\n<li>...</li>\n</ul></li>\n<li>DevartOracle.nuspec</li>\n</ul></li>\n</ul>\n\n<p>The content of the nuspec file is more or less the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;package &gt;\n  &lt;metadata&gt;\n    &lt;id&gt;DevartOracle&lt;/id&gt;\n    &lt;version&gt;6.70.311-pre6&lt;/version&gt;\n    &lt;title&gt;Devart Oracle dotConnect&lt;/title&gt;\n    ...\n    &lt;requireLicenseAcceptance&gt;false&lt;/requireLicenseAcceptance&gt;\n    &lt;description&gt;Drivers from Devart for Oracle and Entity Framework&lt;/description&gt;\n    &lt;releaseNotes&gt;&lt;/releaseNotes&gt;\n    &lt;copyright&gt;Copyright 2012&lt;/copyright&gt;\n    &lt;tags&gt;&lt;/tags&gt;\n    &lt;dependencies&gt;\n    &lt;/dependencies&gt;\n  &lt;/metadata&gt;\n&lt;/package&gt;\n</code></pre>\n\n<p>Nothing special actually. I publish the nuget package to our <a href=\"http://juristr.com/blog/2012/04/using-nuget-to-distribute-our-company/\" rel=\"nofollow\">local repository</a> using the following command:</p>\n\n<pre><code>nuget pack DevartOracle.nuspec\n</code></pre>\n\n<p>The dll's install just fine, however I also wanted to create a web.config merge. So I added a web.config.transform file as specified in the docs...again with the following content:</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n  &lt;configuration&gt;\n    &lt;runtime&gt;\n      &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n        &lt;dependentAssembly&gt;\n          &lt;assemblyIdentity name=\"Devart.Data.Oracle\" publicKeyToken=\"09af7300eec23701\" culture=\"neutral\" /&gt;\n          &lt;bindingRedirect oldVersion=\"0.0.0.0-6.70.311.0\" newVersion=\"6.70.311.0\" /&gt;\n        &lt;/dependentAssembly&gt;\n      &lt;/assemblyBinding&gt;\n    &lt;/runtime&gt;\n    &lt;system.data&gt;\n      &lt;DbProviderFactories&gt;\n        &lt;remove invariant=\"Devart.Data.Oracle\" /&gt;\n        &lt;add name=\"dotConnect for Oracle\" invariant=\"Devart.Data.Oracle\" description=\"Devart dotConnect for Oracle\" type=\"Devart.Data.Oracle.OracleProviderFactory, Devart.Data.Oracle, Version=6.70.311.0, Culture=neutral, PublicKeyToken=09af7300eec23701\" /&gt;\n      &lt;/DbProviderFactories&gt;\n    &lt;/system.data&gt;\n  &lt;/configuration&gt;\n</code></pre>\n\n<h2>The Problem</h2>\n\n<p>When I execute the merge into a web.config with a non-existent or empty <code>&lt;assemblyBinding&gt;</code> section everything works as expected, however when I have - say - the follwing content already there:</p>\n\n<pre><code>&lt;runtime&gt;\n  &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n    &lt;dependentAssembly&gt;\n      &lt;assemblyIdentity name=\"EntityFramework\" publicKeyToken=\"b77a5c561934e089\" culture=\"neutral\" /&gt;\n      &lt;bindingRedirect oldVersion=\"0.0.0.0-4.3.0.0\" newVersion=\"4.3.0.0\" /&gt;\n    &lt;/dependentAssembly&gt;\n  &lt;/assemblyBinding&gt;\n&lt;/runtime&gt;\n</code></pre>\n\n<p>then the result of the merge is this odd one:</p>\n\n<pre><code>&lt;runtime&gt;\n  &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n    &lt;dependentAssembly&gt;\n      &lt;assemblyIdentity name=\"EntityFramework\" publicKeyToken=\"b77a5c561934e089\" culture=\"neutral\" /&gt;\n      &lt;bindingRedirect oldVersion=\"0.0.0.0-4.3.0.0\" newVersion=\"4.3.0.0\" /&gt;\n      &lt;assemblyIdentity name=\"Devart.Data.Oracle\" publicKeyToken=\"09af7300eec23701\" culture=\"neutral\" /&gt;\n      &lt;bindingRedirect oldVersion=\"0.0.0.0-6.70.311.0\" newVersion=\"6.70.311.0\" /&gt;\n    &lt;/dependentAssembly&gt;\n  &lt;/assemblyBinding&gt;\n&lt;/runtime&gt;\n</code></pre>\n\n<p>Any ideas??</p>\n"},{"tags":["c#",".net","iis","application","application-pool"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13278110,"title":"Log Every File Access Attempt on a System and Sort it by User/System Account","body":"<p>I have a strange issue where I need to see why my application pool is crashing due to a permissions issue and no logs are helpful. Is there any way to log every file access attempt on a system and sort it by the user/system account that tried to access it, especially if it fails in accessing the desired file? Even if there are third party applications for this, it would be very helpful.</p>\n"},{"tags":[".net","vsto","ms-office","add-in"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13278195,"title":"Prevent Office \"Add Comment\" button in Review ribbon","body":"<p>We have a custom add-in ribbon that I maintain (that's not a COM shared 'extensibility' add-in) that is using comments and track changes functionality (e.g. there are several buttons related to insert, find, edit and remove), but we recently have had some users that are incorrectly using the \"Review\" ribbon's comment buttons.</p>\n\n<p>As such, I've been requested to block this when users' have a document loaded through the add-in. At this time, I'm just trying to figure out how to either:</p>\n\n<p>a) handle the Review ribbon's add comment button click event to my existing event handler, or</p>\n\n<p>b) disable the Review ribbon's add comment button</p>\n\n<p>I can't seem to find that either of those are possible <em>except</em> I may be able to <a href=\"http://msdn.microsoft.com/en-us/library/bb462633.aspx\" rel=\"nofollow\">\"repurpose commands on the Office fluent button\"</a>, but the methodology described involves creating a new COM add-in-based \"extensibility\" project; I already have one deployed and don't want to have to go about creating a second one just for this small need. Any ideas?</p>\n"},{"tags":["c#",".net","compiler","clr"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":439,"score":1,"question_id":554405,"title":"Stipulating that a property is required in a class - compile time","body":"<p>Is there a way to stipulate  that the clients of a class should specify a value for a set of properties in a class.  For example (see below code), Can i stipulate that \"EmploymentType\" property in Employment class should be specified at compile time?  I know i can use parametrized constructor and such.  I am specifically looking for outputting  a custom warning or error during compile time.   Is that possible?</p>\n\n<pre><code>public class Employment\n{\n   public EmploymentType EmploymentType {get; set;}\n}\n\npublic enum EmploymentType\n{\n    FullTime = 1,\n    PartTime= 2\n}\n\npublic class Client\n{\n    Employment e = new Employment();\n// if i build the above code, i should get a error or warning saying you should specify value for EmploymentType\n}\n</code></pre>\n"},{"tags":["c#",".net","asp.net-mvc","asp.net-web-api","serializable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13263988,"title":"ASP.NET Web API and [Serializable] class","body":"<p>I have a class that is marked with [Serializable]. When i return it from the Web API the field names are all funky.</p>\n\n<p>Normally the JSON returned is</p>\n\n<pre><code>[{\"OrderId\":797 ...\n</code></pre>\n\n<p>JSON returned when using [Serializable]</p>\n\n<pre><code>[{\"&lt;OrderId&gt;k__BackingField\":797 ...\n</code></pre>\n\n<p>I wan't to mark it serializable to use a BinaryFormatter for caching. Is there any other way than to write a custom serializer or to make a twin class that is not serializable and write monkey code to \"cast\" between the two?</p>\n"},{"tags":[".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13277070,"title":"How can I prevent my disabled winform from losing focus when returning from a dialog","body":"<p>I have a .net winforms application, where multiple forms are displayed at one time. One form is routinley disabled (this.enabled = false;). During this time, the form creates and shows a custom modal dialog. When the dialog is closed, the original form, the one that is disabled, loses focus. I removed the code that set the form as disabled, and when I tested that, the form kept the focus after returning from the dialog. Is there any way to have a disabled form open up a modal custom dialog, and then stay focused and on top of the other forms when the dialog is closed? </p>\n"},{"tags":["c#",".net","asynchronous","windows-services","parallels"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":47,"score":0,"question_id":13277742,"title":"C# Console Application using Parallels or Async","body":"<p>There is a lot of examples and talk out there about parallels, concurrency and now asynchronous calls with .NET 4.5. We are looking for the best solution for our application as a lot of this talk is confusing to us. </p>\n\n<p>We have a console application which needs to run every minute, it currently checks for XML files in a directory and then if any exist, it loops through each one synchronously, loading each as an XMLDocument, parsing it using LINQ and List objects and then saving it to the database. The XML files are relatively small, the biggest ones are maybe 400kb with most in that 20-85kb range.  </p>\n\n<p>We are trying to determine the best route performance wise as there are sometimes 30-50 files and it takes more than a minute to run, pushing it into the time where it needs to run again. With the files currently being processed synchronously, there seems to be an opportunity to process them more quickly since each one is independent of the others, but aren't sure the best approach here in regards to thread safety and performance.</p>\n\n<p>Here is our code, I took a bunch of stuff out to keep just the main components to keep it simple. The Engine.ProcessXML is the call to another method which determines the type of document, then calls the appropriate LINQ parsing method and database layer method for saving.</p>\n\n<pre><code>string feedsDir = ConfigHelper.FeedsDirectory;\n\nif (Directory.Exists(feedsDir))\n{\n    //get full xml file paths\n    string[] filePaths = Directory.GetFiles(feedsDir, \"*.xml\");\n\n    //get total number of files to be processed\n    int fileCount = filePaths.Length;\n\n    if (fileCount &gt; 0)\n    {\n        //loop through each file to process\n        foreach (string file in filePaths)\n        {\n            if (File.Exists(file))\n            {\n                //load the file into xml document object\n                XDocument xmlDoc = XDocument.Load(file);\n\n                //if xml document not empty, process\n                if (xmlDoc != null)\n                {\n                    //parse and save document data\n                    Engine.ProcessXML(xmlDoc);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Side Note:  We have looked into creating a windows service and some FileSystemWatcher class, but we are currently wanting to keep the complexity down. The console app is easier to debug right now and want to address this first performance issue. We can always go back and wrap our console application in a service once it is performing at maximum speed, per-say. And getting this app on parallels or some type of multi-threading, if possible, would make a service easier to convert to since that would probable be needed. </p>\n"},{"tags":["c#",".net","embedded","netduino"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":21,"score":-2,"question_id":13277992,"title":"C# WPF to Embedded programming transition","body":"<p>I've been learning C# .NET Framework for around 4-6 months (still starting) using some books, and have currently made my way up to Collections and Generics. I'll probably spend the next two months covering the rest up to LINQ and/or Garbage Collections.</p>\n\n<p>The thing is, I started to become interested in embedded systems and found out that you can use C# to code it through .NET MF, which mean I wouldn't have to learn C or C++.\nSo, I would like to know if the knowledge I'll have by that time (2 months) will be enough to start working on Embedded (using C# .NET Micro Framework and Netduino) or I should probably see more about plain C# like Multithreading, async and other advanced features ?</p>\n\n<p>I want use embedded just as a hobby, at least by now, as I'll still have a long way through university. Although, I'll probably pick it as a career then.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","amazon-web-services","amazon-cloudsearch"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12051613,"title":"Are there libraries to search Amazon CloudSearch from .NET?","body":"<p>What libraries are out there to perform searches in AWS' CloudSearch domains? The AWS SDK is virtually devoid of search capabilities.</p>\n\n<hr>\n\n<p>I would like to use Amazon CloudSearch for a project to search in pre-existing databases for certain customer-related data for billing purposes.</p>\n\n<p>We already have extensive experience with Solr-based search services, but in this particular instance we do not want to host the search service in-house and already have experience with AWS.</p>\n\n<p>The Amazon SDK provides a decent .NET-based approach to administer search domains. But: Apparrently it lacks any capability whatsoever to actually <strong>search</strong> for things.</p>\n\n<p>I have found <a href=\"https://github.com/Bigjono/AWS-CloudSearch\" rel=\"nofollow\">a few</a> <a href=\"https://github.com/breaker05/Amazon-CloudSearch\" rel=\"nofollow\">attempts</a> to provide a search API, but nothing that works OOTB. Any suggestions or experience with CloudSearch from within .NET?</p>\n\n<p>(Yes, I know it is easy to just chug parameters in a web service call and deal with the JSON reply; a wrapper / library just would deal better with the messy details of parsing etc.)</p>\n"},{"tags":[".net","wpf","parsing","xaml","converter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274250,"title":"WPF - Strange XAML parsing error on XP...typeConverter? - Cannot convert string '0' in attribute 'Row'","body":"<p>Have a client running XP.  They have a little bit of \"weirdness\" going on with a very simple XAML control once it's instantiated.</p>\n\n<p>NO issues on non-XP machines.  Sporadic issues on a specific customer machines.</p>\n\n<p>Unable to reproduce locally.  Anyone experience this?  It seems like the default type converter is failing for the attached property...but I'm assuming it's a side effect to something else.</p>\n\n<p>ERROR:\n\"Cannot convert string '0' in attribute 'Row' to object of type 'System.Int32'.  0 is not a valid value for Int32\"</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n      &lt;RowDefinition Height=\"Auto\"/&gt;\n      &lt;RowDefinition Height=\"Auto\"/&gt;\n      &lt;RowDefinition Height=\"*\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n      &lt;ColumnDefinition Width=\"*\"/&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n\n    &lt;Menu Grid.Row=\"0\" Grid.Column=\"0\"&gt;\n       :\n       :\n    &lt;/Menu&gt;\n&lt;/Grid&gt;\n</code></pre>\n"},{"tags":["c#",".net","permissions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3456,"score":2,"question_id":1475964,"title":"writing files to Common Application Data folder denied","body":"<p>i have used the follwing function to write data to user application folder</p>\n\n<pre><code>private void WriteToLog(string source, string method, string msg)\n{\n\n string LogFile =Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) + \"\\\\test\";            \n LogFile = LogFile + \"\\\\Log.txt\";\n StreamWriter sw = new StreamWriter(LogFile, true );\n string str = DateTime.Now.ToString() + \"source=\" + source + \"\\t Method=\" + method + \"\\t\" + msg;\nsw.WriteLine(str);\nsw.Flush();\nsw.Close();\n}\n</code></pre>\n\n<p>the above code working perfectly in administrator accounts, but failed in limited user accounts</p>\n"},{"tags":["c#",".net","iis","crystal-reports","application-pool"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13277769,"title":"Application Pool Crashes when Web Site is Not Running as Network Service","body":"<p>I have a site running Crystal Reports Viewer in IIS 7 but for security reasons we want it to run the application pool under the ApplicationPoolIdentity. We noticed the application pool keeps crashing when we switched it from Network Service to ApplicationPoolIdentity and we want to give extra permissions to the ApplicationPoolIdentity on certain folders on the drive in order to remedy this situation. The problem is, we gave a ton of permissions to different folders, but as far as we can tell we cannot pinpoint why the application pool keeps crashing and what file it cannot access. We checked a lot of different log files, but maybe we skipped over some that could be of more importance. Is there anything out there to show us where the problem is, whether it be a certain log I haven't come across or some sort of tracing I can use to get to the files that I need to give this identity permissions? The pool crashes when trying to load Crystal Reports Viewer and gives no errors, just says it is unreachable.</p>\n"},{"tags":[".net","svm","libsvm","support-vector-machines"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":11,"score":-1,"question_id":13258762,"title":"how to get the margin from libSVM","body":"<p>I'm using the libSVM for .net.\nAfter running the SVM training i get a vector of alphas.\nAs i understand, the margin is the minimum distance\nbetween any point and the decision hyperplane.</p>\n\n<p>I'm not sure how to do that using the alphas.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","xml","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13260131,"title":"How to parse XML header and nested sections using LINQ","body":"<pre><code>XElement documentRoot = XElement.Parse(@\"&lt;OrdersReport Date='2012-08-01'&gt;\n                &lt;SettingHeader&gt;\n                  &lt;SettingId&gt;1&lt;/SettingId&gt;\n                &lt;/SettingHeader&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;1&lt;/ClientId&gt;\n                    &lt;Orders&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;1&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;123 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;MyCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AZ&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;Order&gt;\n                        &lt;OrderNumber&gt;2&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;111 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;OtherCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/Order&gt;\n                      &lt;OrderCancelled&gt;\n                        &lt;OrderNumber&gt;3&lt;/OrderNumber&gt;\n                        &lt;ShipAddress&gt;222 Main St.&lt;/ShipAddress&gt;\n                        &lt;ShipCity&gt;CancelledCity&lt;/ShipCity&gt;\n                        &lt;ShipState&gt;AL&lt;/ShipState&gt;\n                      &lt;/OrderCancelled&gt;\n                    &lt;/Orders&gt;\n                    &lt;Returns&gt;\n                      &lt;Amount&gt;\n                        &lt;OrderId&gt;2&lt;/OrderId&gt;\n                        &lt;OrderId&gt;3&lt;/OrderId&gt;\n                        &lt;OrderId&gt;21&lt;/OrderId&gt;       \n                      &lt;/Amount&gt;\n                    &lt;/Returns&gt;\n                  &lt;/Client&gt;\n                  &lt;Client&gt;\n                    &lt;ClientId&gt;2&lt;/ClientId&gt;    \n                  &lt;/Client&gt;\n                &lt;/OrdersReport&gt;\");\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>        var orders = documentRoot.Descendants(\"Order\")\n                       .Concat(documentRoot.Descendants(\"OrderCancelled\"))\n                       .Select(x =&gt; new\n                       {\n                           OrderNumber = (int)x.Element(\"OrderNumber\"),\n                           ShipAddress = (string)x.Element(\"ShipAddress\"),\n                           ShipCity = (string)x.Element(\"ShipCity\"),\n                           ShipState = (string)x.Element(\"ShipState\")\n                       });\n\n        foreach (var o in orders)\n        {\n            Console.WriteLine(o.OrderNumber + \" \" + o.ShipAddress + \" \" \n                + o.ShipCity);\n        }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 123 Main St. MyCity\n2 111 Main St. OtherCity\n3 222 Main St. CancelledCity\n3 222 Main St. CancelledCity\n</code></pre>\n\n<p>How do I append <em>ClientId</em> and <em>SettingId</em> like the below output?</p>\n\n<p>Target output:</p>\n\n<pre><code>1 123 Main St. MyCity ClientId 1 SettingId 1\n2 111 Main St. OtherCity ClientId 1 SettingId 1\n...\n</code></pre>\n"},{"tags":["c#",".net","xml","xml-serialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13262551,"title":"Generic type serialization with two similarly named generic arguments","body":"<p>I would like to be able to serialize a generic type against several different entities using the C# XmlSerializer. For example i want to serialize:</p>\n\n<pre><code>GenericThing&lt;MyApp.A&gt; and GenericThing&lt;MyApp.B&gt;\n</code></pre>\n\n<p>This all works well until i have something like the following:</p>\n\n<pre><code>GenericThing&lt;MyApp.A.Entity&gt; and GenericThing&lt;MyApp.B.Entity&gt;\n</code></pre>\n\n<p>Because these two classes have the same name the serializer cant differentiate between the two entities and attempts to serialize both to <code>GenericThingOfEnitity</code>.</p>\n\n<p>Is there a way of decorating <code>GenericThing</code> so that it is more specific about its generic argument during serialization (ie serializes to <code>GenericThingOfMyApp.B.Enitity</code> or similar)? I unfortunately don't have control over either <code>MyApp.A</code> or <code>MyApp.B</code></p>\n"},{"tags":["c#",".net","sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":63,"score":0,"question_id":13266324,"title":"accessing database","body":"<p>Here is my problem; I have a hosted and published database on godaddy servers. I have also published my website. However, when I tried to use one of visual studio's tools such as chart, or data view or any tool that wants me to specify a data source, I get the </p>\n\n<pre><code>\"error 40: could not open a connection to sql server\".\n</code></pre>\n\n<p>In most cases, I have worked around this issue by writing the code instead of using these tools on the \".cs\" sections, but now I need to update my database model and I really would prefer not to write that amount of code. The connection string I choose works perfectly, it can update and gather values from database on the published website. But when I Right click on the models section and select \"update model from database\" the update wizard cannot access the database with the very same connection string. Like I said, this problem occurs on every tool that wants me to select a data source.</p>\n\n<p>Is this a permission issue regarding visual studio or something else? \nThanks in advance.</p>\n"},{"tags":["c#",".net","string","script#"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13260153,"title":"Using Script# code with string operations in standart C# .NET project","body":"<p>I added reference of Script# to my standart console application. After that I was trying to invoke some method from there but was getting the following error:</p>\n\n<p><img src=\"http://i.stack.imgur.com/uSDdc.png\" alt=\"MissingMethodException\"></p>\n\n<p>I suppose it happened on the following line:</p>\n\n<pre><code>string[] lines = s.Split(';');\n</code></pre>\n\n<p>My assumption is that usual <strong>mscorlib</strong> library has not method <code>public string[] Split(char separator)</code>, but has <code>public string[] Split(params char[] separator)</code></p>\n\n<p>Is it possible to write valid code with such string operations both for a Script# project and for a standart C# .NET project? Due to this problem I have to write duplicate code for both projects with minimal difference.</p>\n\n<p><strong>P.S.</strong> I tried to use assemblty binding redirects, as discussed in <a href=\"http://stackoverflow.com/q/8104853/1046374\">this SO</a> question, but it didn't help me.</p>\n"},{"tags":[".net","iis7",".net-3.5","application-pool","applicationpoolidentity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13274964,"title":"How can I restart Application Pool's from a website without setting app pool identity to local system","body":"<p>I have an application in .Net that does various admin/config for other applications. I need to be able to stop and start the app pool. I've achieved this, but only if I run the app pool as local system (which is generally accepted as a bad idea).</p>\n\n<p>Initially I started appcmd.exe with Process.Start (using appropriate ProcessStartInfo object), but this eventually lead me to an Exit Code of -1073741502, further research suggests that I need to debug using the windows SDK as it has something to do with an assembly not loading, so I found what seems like a simpler solution in the <code>Microsoft.Web.Administration</code> namespace:</p>\n\n<p>I use the below code, but it seems to require the AppPool running it has an identity of local system (otherwise I get System.UnauthorizedAccessException) - is there a way to start/stop with a less privileged account (I would prefer using Application Identity) - although temporarily elevating permissions is also acceptable.</p>\n\n<pre><code>    Dim serverManager As New ServerManager()\n    Dim applicationPoolCollection As ApplicationPoolCollection = serverManager.ApplicationPools\n\n    For Each applicationPool As ApplicationPool In applicationPoolCollection\n\n        If applicationPool.Name = appPoolName Then\n            applicationPool.Stop()\n            applicationPool.Start()\n        End If\n\n    Next\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13276944,"title":"System.Web.Helpers can't be loaded on one server, works everywhere else, what could be wrong?","body":"<h2>Exception</h2>\n\n<pre><code>Exception: Could not load file or assembly 'System.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) \n</code></pre>\n\n<h2>Stack Trace</h2>\n\n<pre><code>at MyWebApp.Logic.Managers.ImagesManager.SaveImage(Stream imageFileStream, Site site)\nat MyWebApp.WebSite.Controllers.ImageController.AddGalleryImage(String qqfile, HttpPostedFileBase uploadFile) in \nC:\\Users\\jhr\\Documents\\subversion\\MyProject\\trunk\\MyWebApp.WebSite\\Controllers\\ImageController.cs:line 67\n</code></pre>\n\n<p>Line #67 of <code>ImageController.cs</code></p>\n\n<pre><code>Image image = _imagesManager.SaveImage(fileStream, site);\n</code></pre>\n\n<p><code>ImagesManager</code> is using the class <code>WebImage</code> out of <code>System.Web.Helpers</code>. This works on multiple laptops and a development server, but I can't get it to work on our QA server.</p>\n\n<p><code>System.Web.Helpers.dll</code> with the correct version is the <code>bin</code> directory of my application <strong>just like on the machines where it works</strong>. I am using the same <code>web.config</code> on all the machines as well. </p>\n\n<p>I am copying a working application from one machine to the other, which is supposed to be configured exactly the same, but I get this exception only on one machine.</p>\n\n<h3>What am I missing?</h3>\n"},{"tags":["c#",".net","expression-blend","blend","expression-blend-4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13277135,"title":"Sort Properties of my Control in Expression Blend designer","body":"<p>I created my new Category \"MyCategory\" to store all my Properties of my Control, in design mode (Expression Blend 4), like theses categories:</p>\n\n<p><img src=\"http://i.stack.imgur.com/J4Jsd.png\" alt=\"enter image description here\"></p>\n\n<p>By default, all my properties under my Category are sorted alphabetically. </p>\n\n<p>Is it possible to choose the order ?</p>\n\n<p>Thank you.</p>\n"},{"tags":[".net","datediff"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13275886,"title":"How do I detect the Daylight Savings Time 25 hour day","body":"<p>I am running a process at a given clock time each day (in the United States--that is significant).  I have been trying to calculate how to do that correctly for the 25 hour day.  Consider the following C# code:</p>\n\n<pre><code>var referenceDate = new DateTime(2012, 11, 3);\nvar referenceTime = new TimeSpan(0, 19, 30, 0);\nvar originalTime = referenceDate.Add(referenceTime);\nvar tomorrow = referenceDate.AddDays(1);\nvar nextTimestamp = string.Format(\n            \"{0} {1:00}:{2:00}\", \n            tomorrow.ToShortDateString(), \n            referenceTime.Hours, \n            referenceTime.Minutes);\nvar nextRunTimestamp = DateTime.Parse(nextTimestamp);\n</code></pre>\n\n<p>I used the format/parse sequence to make sure that we can avoid time spans when crossing the DST transition time.  Now what should be the result of the following expression?</p>\n\n<pre><code>nextRunTimestamp.Subtract(originalTime).TotalHours\n</code></pre>\n\n<p>Well, it turns out to be 24 but I think it should be 25 since November 4, 2012 is a 25-hour day (transitioning at 2 AM) so the difference between 19:30 on November 3 and 19:30 on November 4 should be 25 hours.  </p>\n\n<p>How do I get to the right answer for each date in the year?       </p>\n"},{"tags":["c#",".net","linq","linq-to-entities"],"answer_count":6,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":666,"score":4,"question_id":1689199,"title":"C# - code against a property using the property name as a string","body":"<p>What's the simplest way to code against a property in C# when I have the property name as a string?  For example, I want to allow the user to order some search results by a property of their choice (using LINQ).  They will choose the \"order by\" property in the UI - as a string value of course.  Is there a way to use that string directly as a property of the linq query, without having to use conditional logic (if/else, switch) to map the strings to properties.  Reflection?</p>\n\n<p>Logically, this is what I'd like to do:</p>\n\n<pre><code>query = query.OrderBy(x =&gt; x.\"ProductId\");\n</code></pre>\n\n<p>Update:\nI did not originally specify that I'm using Linq to Entities - it appears that reflection (at least the GetProperty, GetValue approach) does not translate to L2E.</p>\n"},{"tags":[".net","pdf","svg","pdf-generation"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":94,"score":0,"question_id":12647502,"title":"Which C# library allows reliable SVG to PDF conversion?","body":"<p>I'm looking for a (not necessarily free) .Net library which is:</p>\n\n<ul>\n<li>Maintained</li>\n<li>Reliable</li>\n<li>Production ready</li>\n</ul>\n\n<p>I can't use a rasterized image format because I don't want to lose the benefit of having a graphic vector on the output media.</p>\n\n<p>I'm currently using Aspose.Pdf's as the general answer to PDF-related questions, and I would like to change because:</p>\n\n<ul>\n<li>The API changes without backward compatibility too often.</li>\n<li>There are way too many bugs that are painful to work around</li>\n</ul>\n"},{"tags":["c#",".net","winapi","cracking","detours"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13276741,"title":"Prevent detouring functions. Avoid cracking","body":"<p>There is an application that checks for activation using DLL <code>Check</code> function. <code>Check</code> returns 1 if application is activated and 0 otherwise. I create simple application and DLL containing function <code>MyCheck</code> (which always returns 1) with the same signature and detoured <code>Check</code> function with my version using MS detours lib for function hooking. Obviously it works and the application is successfully cracked, so I need to avoid it.</p>\n\n<ol>\n<li><p>I tried to call <code>Check</code> function directly (by specifying exact address), without even using <code>GetProcAddress</code>, but looks like detours lib is modifying the function body itself, not export table.</p>\n\n<pre><code>[UnmanagedFunctionPointer(CallingConvention.StdCall)]\nprivate delegate bool CheckFunctionDelegate();\n\nstatic void Main(string[] args)\n{\n    ProcessModule module = Process.GetCurrentProcess().Modules\n        .Cast&lt;ProcessModule&gt;()\n        .First(m =&gt; m.ModuleName == \"licensing_check.dll\");\n\n\n    IntPtr procedurePtr = IntPtr.Add(module.BaseAddress, 0x00003FF0);\n\n    // Calling validation function by pointer\n    CheckFunctionDelegate checkFunction = (CheckFunctionDelegate)\n        Marshal.GetDelegateForFunctionPointer(procedurePtr, typeof(CheckFunctionDelegate));\n\n    if (checkFunction())\n    {\n        // do some stuff\n    }\n}\n</code></pre>\n\n<p>}</p></li>\n<li><p>Then I tried to read function body and I see that after detour MD5 checksum differs from the original one. So I'm trying to read entire contents of DLL in memory and check it to confirm that DLL contents are not changed, but it doesn't work either. It throws <code>AccessViolationException</code>.</p>\n\n<p>Process.EnterDebugMode();</p>\n\n<p>ProcessModule module = Process.GetCurrentProcess().MainModule;\nbyte[] data = new byte[module.ModuleMemorySize];\nMarshal.Copy(module.BaseAddress, data, 0, module.ModuleMemorySize);</p></li>\n</ol>\n\n<p>I used MainModule here, but it gives the same error for each module in <code>Process.GetCurrentProcess().Modules</code> collection.</p>\n\n<p>I would appreciate any help on this, I'm not necessarily expecting to solve it in one of the ways I describe, any good solution is acceptable.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","vb.net","winforms","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13276201,"title":"PDB file and error handling?","body":"<p>We have a windows form application running across different customers, when they get errors we log into a database &amp; using that stack information that is logged, we correct the issue.</p>\n\n<p>However there are issues that occur only in production, the stack shows for example</p>\n\n<blockquote>\n  <p>CalculateTotals(method name) :NullReferenceException: Object reference not set to instance of an object.</p>\n</blockquote>\n\n<p>The CalculateTotals is a method name, that has lots of sub-method calls &amp; more lines, i am not able to get the exact line # of the code where it fails.</p>\n\n<p>My application's PDB file is not sent to customers (when they do installation),</p>\n\n<p>how do i keep a copy of that .PDB file (may be in a remote location and \nnot make it part of installation) and use that to \ndebug the errors &amp; get the exact line?</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","linq","entity"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13276745,"title":"Creating Navigation Property without foreign key?","body":"<p>I am trying to create a navigation property for my data model using an existing database.  The data has a shared key (like a foreign key) however it is not specified that way in the database.  Here is what it looks like:</p>\n\n<pre><code> [Table(\"Alpha\")]\n    public class Alpha\n    {\n        public int AlphaID { get; set; }\n\n        public int AlphaGroupID { get; set; }\n\n        public int? ParentAlphaID { get; set; }\n\n        public int? CodeID { get; set; }\n\n        public int? BracketCodeID { get; set; }\n\n        public string Title { get; set; }\n    }\n\n\n\n\n\n[Table(\"AlphaGroup\")]\n    public class AlphaGroup\n    {\n        [Column(\"AlphaGroupID\")]\n        public int AlphaGroupID { get; set; }\n\n        public string Title { get; set; }\n\n        public string TitleAddon { get; set; }\n\n    }\n</code></pre>\n\n<p>AlphaGroupID needs to be a navigation property to AlphaGroupID but is not a foreign key.  Is there a way to accomplish this?</p>\n"},{"tags":[".net","wcf","serialization","json.net","deserialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13273033,"title":"Json.net loose vs strict type deserialization","body":"<p>At the project I am working on, we started to use the Json.Net library.</p>\n\n<p>However, I just found out that json.net is 'loose' on string type.</p>\n\n<p>Here's an example:</p>\n\n<p>The DTO class</p>\n\n<pre><code>[JsonObject]\npublic class DTO\n{\n    [JsonProperty]\n    public string type;\n}\n</code></pre>\n\n<p>The deserialization</p>\n\n<pre><code>byte[] rawBody = GetBytes(@\"{\"\"type\"\":true}\");\nusing (MemoryStream ms = new MemoryStream(rawBody))\n{\n    using (StreamReader sr = new StreamReader(ms))\n    {\n        var serializer = new JsonSerializer();\n\n        return serializer.Deserialize(sr, typeof(DTO));\n     }\n }\n</code></pre>\n\n<p>This will deserialize the 'type' attribute as \"True\". However, I would expect it to fail and throw an exception as there's a type mismatch.\nIt does the same if I replace true by 1 in the json. The property 'type' value will be \"1\".</p>\n\n<p>questions:</p>\n\n<ol>\n<li><p>Is there a way to enforce strict serialization?</p></li>\n<li><p>Is there other types than string that have implicit conversion like what we see here?</p></li>\n</ol>\n\n<p>Thank you.</p>\n\n<p>JF</p>\n"},{"tags":["c#",".net","datetime","timespan"],"answer_count":15,"favorite_count":6,"up_vote_count":24,"down_vote_count":0,"view_count":10005,"score":24,"question_id":1525990,"title":"Difference in months","body":"<p>In C#/.NET <code>TimeSpan</code> has <code>TotalDays</code>, <code>TotalMinutes</code>, etc. but I can't figure out a formula for total months difference. Variable days per month and leap years keep throwing me off. How can I get <strong>TotalMonths</strong>?</p>\n\n<p><strong>Edit</strong> Sorry for not being more clear: I know I can't actually get this from <code>TimeSpan</code> but I thought using <code>TotalDays</code> and <code>TotalMinutes</code> would be a good example to express what I was looking for ... except I'm trying to get Total Months.</p>\n\n<p>Example: Dec 25, 2009 - Oct 6, 2009 = 2 TotalMonths. Oct 6th to Nov 5th equals 0 months. On Nov 6th, 1 month. On Dec 6th, 2 months</p>\n"},{"tags":["c#",".net","string.format"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":13276418,"title":"How string.Format handles null values?","body":"<p>In the following code below, why the two string.Format behave the same way? In the first one, no exception is thrown and in the second one an ArgumentNullException is thrown.</p>\n\n<pre><code>static void Main(string[] args)\n{\n    Exception e = null;\n    string msgOne = string.Format(\"An exception occurred: {0}\", e);\n    string msgTwo = string.Format(\"Another exception occurred: {0}\", null);\n}\n</code></pre>\n\n<p>Could someone please help me understand the difference between the two?</p>\n"},{"tags":["c#",".net","generics"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13257835,"title":"How can I run Generic Find method from a List on the Visual Studio Immediate Window?","body":"<p>I just want to debug calling Find from Immediate Window, is it possible?</p>\n\n<pre><code>            Customer found = listOfCustomers.Find(\n                delegate(Customer cu)\n                {\n                    return cu.Name.ToLower().Contains(\"adam\");\n                }\n            );\n</code></pre>\n"},{"tags":[".net","sql","vb.net","cryptography","sha1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":163,"score":1,"question_id":11233394,"title":".Net SHA1CryptoServiceProvider not matching SQL Hashbytes","body":"<p>After converting some plaintext passwords stored in SQL using Hashbytes can't seem to get .Net to generate a proper matching hash.</p>\n\n<p>SQL used to convert the passwords:</p>\n\n<pre><code>UPDATE Users\nSET UserPassword = HASHBYTES('SHA1', UserPassword + CAST(Salt AS VARCHAR(36)))\n</code></pre>\n\n<p>Now the .Net code used to generate the hash:</p>\n\n<pre><code>Dim oSHA1 As New System.Security.Cryptography.SHA1CryptoServiceProvider\nDim bValue() As Byte\nDim bHash() As Byte\n\nbValue = System.Text.Encoding.UTF8.GetBytes(sPlainTextPass)\nbHash = oSHA1.ComputeHash(bValue)\noSHA1.Clear()\n\nDim sEncryptPass As String = String.Empty\nFor i As Integer = 0 To bHash.Length - 1\n    sEncryptPass = sEncryptPass + bHash(i).ToString(\"x2\").ToLower()\nNext\n</code></pre>\n\n<p>A few added notes: The salt is stored in the database. sPlainTextPass contains the password+salt in plain text. I tried several different encodings including ASCII, UTF7, and UTF8. The database field is a varchar which is supposed to match to UTF8 from what I understand.</p>\n\n<p>Help?</p>\n"},{"tags":[".net","moq"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13178388,"title":"Is it possible to Give to Moq (or any other mocking api) a default implementation?","body":"<p>This is the scenario:</p>\n\n<pre><code>interface IFather\n{\n    void A();\n}\n\ninterface ISonA : IFather\n{\n    void B();\n}\n</code></pre>\n\n<p>and I have a default implementation for IFather</p>\n\n<pre><code>private class Father : IFather\n{\n    public void A()\n    {\n        //default behaviour\n    }\n}\n</code></pre>\n\n<p>Is it possible to mock ISonA (or any other ISon that implements IFather) with default behaviour provided by Father? I would like to do something like this:</p>\n\n<pre><code>    var mock = new Mock&lt;ISonA&gt;(typeof(Father));\n    //with A nothing, use default behaviour\n    //mock.Setup(x =&gt; x.A()).Callback(() =&gt;  /*something*/);\n    mock.Setup(x =&gt; x.B()).Callback(() =&gt;  /*something*/);\n</code></pre>\n\n<p>Where typeof(Father) is the way to tell Mock to internally implement ISonA extending Father. Currently the only way to achieve this is by using my own SonA class instead of mocking it</p>\n"},{"tags":[".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13274105,"title":"Multiple dispatcher threads in WPF, but will only render when first thread is unblocked?","body":"<p>I have a plugin to my application, which does an awful lot on the GUI thread.  We want to isolate the work of the host and the plugin.  We've done this successfully by starting a new thread for the plugin, and starting a dispatcher there.</p>\n\n<p>However, when the main thread blocks, the plugin never redraws.  Is there any way around this?  My suspicion is this is something to do with the WPF render thread?  </p>\n"},{"tags":[".net","messaging","ibm","websphere-mq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1629,"score":1,"question_id":5018451,"title":"MQ Series Messages get read more than once","body":"<p>I've a problem whereby a message occasionally gets read from the Q more than once. I'm using .NET wrapper for MQSeries (amqmdnet.dll) and read messages, using Win Service.</p>\n\n<pre><code>Here's how I do it with VB.NET:\n\n'QManager\n Dim properties As Hashtable = New Hashtable(4)\n\n        properties.Add(MQC.TRANSPORT_PROPERTY, MQC.TRANSPORT_MQSERIES_CLIENT)\n        properties.Add(MQC.CHANNEL_PROPERTY, channelName)\n        properties.Add(MQC.HOST_NAME_PROPERTY, iPAddress)\n        properties.Add(MQC.PORT_PROPERTY, port)\n\n        QManager = New MQQueueManager(queueManagerName, _\n                                              properties)\n\n\n'Q itself\ngetMessageOptions.Options = _\n            MQC.MQGMO_FAIL_IF_QUIESCING Or _\n            MQC.MQGMO_WAIT Or _\n            MQC.MQGMO_SYNCPOINT\n\ngetMessageOptions.WaitInterval = 1000 ' read from config\n\nDim locker As New Object\n\nSystem.Threading.Monitor.Enter(locker)\n\nQ.Get(message, getMessageOptions)\n\nQManager.Commit()\n\nSystem.Threading.Monitor.Exit(locker)\n</code></pre>\n\n<hr>\n\n<p>I heard that Q.Get(message, getMessageOptions) makes the message unavailable for other readers, QManager.Commit in turn just removes the message from the Q (by analogy with .NET Peek &amp; Dequeue). That on its own should eliminate need for Monitor.</p>\n\n<p>In my Win Service multiple threads read the Q and we suspect that due to a low polling interval (100ms and less) the wrapper doesn't get enough time to update 'Read' flag of the message, so it get's picked up more than once by overlapping threads. Historically the same message gets read up to four times.</p>\n\n<p>Before increasing the polling interval, I wanted to make sure if I'm doing things the right way. Could anyone suggest on any problmes with my approach?</p>\n\n<p>Thanks.</p>\n"},{"tags":[".net","c++","exception-handling","c++-cli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":8015844,"title":"Getting sensible info from CLR-to-SEH exceptions in a mixed mode C++ project","body":"<p>Mixed mode C++ project. Native code is calling managed code. Managed code might throw an exception. I can catch said exception in native mode using a vectored exception handler; I can see its <code>PEXCEPTION_POINTERS</code>. The telling code 0xE0434F4D, meaning it's a CLR exception, is there.</p>\n\n<p>Question: is there any way to get any sensible information (exception class, message, stack trace etc.) from the attendant data? There's one parameter in the <code>ExceptionInformation</code>, and it looks like a pointer to something...</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage","azure-storage-blobs"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":31,"score":0,"question_id":13270873,"title":"loading lots of Azure blob data in a WPF app","body":"<p>I've been given a task to build a prototype for an app. I don't have any code yet, as the solution concepts that I've come up with seem stinky at best... </p>\n\n<p><strong>The problem:</strong></p>\n\n<p>the solution consist of various Azure projects which do stuff to lots of data stored in Azure SQL db-s. Almost every action that happens creates a gzipped log file in blob storage. So that's one .gz file per log entry.</p>\n\n<p>We should also have a small desktop (WPF) app that should be able to read, filter and sort these log files.</p>\n\n<p>I have absolutely 0 influence on how the logging is done, so this is something that can not be changed to solve this problem.</p>\n\n<p><strong>Possible solutions that I've come up with (conceptually):</strong></p>\n\n<p><strong>1:</strong></p>\n\n<ul>\n<li>connect to the blob storage</li>\n<li>open the container</li>\n<li>read/download blobs (with applied filter)</li>\n<li>decompress the .gz files</li>\n<li>read and display</li>\n</ul>\n\n<p>The problem with this is that, depending on the filter, this could mean a whole lot of data to download (which is slow), and process (which will also not be very snappy). I really can't see this as a usable application.</p>\n\n<p><strong>2:</strong></p>\n\n<ul>\n<li>create a web role which will run a WCF or REST service</li>\n<li>the service will take the filter params and other stuff and return a single xml/json file with the data, the processing will be done on the cloud</li>\n</ul>\n\n<p>With this approach, will I run into problems with decompressing these files if there's a lot of them (will it take up extra space on the storage/compute instance where the service is running).</p>\n\n<p><strong>EDIT:</strong> what I mean by filter is limit the results by date and severity (info, warning, error). The .gz files are saved in a structure that makes this quite easy, and I will not be filtering by looking into the files themselves.</p>\n\n<p><strong>3:</strong></p>\n\n<ul>\n<li>some other elegant and simple solution that I don't know of</li>\n</ul>\n\n<p>I'd also need some way of making the app update the displayed logs in real time, which i suppose would need to be done with repeated requests to the blob storage/service.</p>\n\n<hr>\n\n<p>This is not one of those \"give me code\" questions. I am looking for advice on best practices, or similar solutions that worked for similar problems. I also know this could be one of those \"no one right answer\" questions, as people have different approaches to problems, but I have some time to build a prototype, so I will be trying out different things, and I will select the right answer, which will be the one that showed a solution that worked, or the one that steered me in the right direction, even if it does take some time before I actually build something and test it out.</p>\n"},{"tags":[".net","arrays"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1316,"score":4,"question_id":56446,"title":".Net arrays with lower bound > 0","body":"<p>Although perhaps a bizare thing to want to do, I need to create an Array in .Net with a lower bound > 0. This at first seems to be possible, using:</p>\n\n<pre><code>Array.CreateInstance(typeof(Object), new int[] {2}, new int[] {9});\n</code></pre>\n\n<p>Produces the desired results (an array of objects with a lower bound set to 9). However the created array instance can no longer be passed to other methods expecting <code>Object[]</code> giving me an error saying that:</p>\n\n<p><code>System.Object[*]</code> can not be cast into a <code>System.Object[]</code>. What is this difference in array types and how can I overcome this?</p>\n\n<p>Edit: test code = </p>\n\n<pre><code>Object x = Array.CreateInstance(typeof(Object), new int[] {2}, new int[] {9});\nObject[] y = (Object[])x;\n</code></pre>\n\n<p>Which fails with: \"Unable to cast object of type 'System.Object[*]' to type 'System.Object[]'.\"</p>\n\n<p>I would also like to note that this approach <strong>DOES</strong> work when using multiple dimensions:</p>\n\n<pre><code>Object x = Array.CreateInstance(typeof(Object), new int[] {2,2}, new int[] {9,9});\nObject[,] y = (Object[,])x;\n</code></pre>\n\n<p>Which works fine.</p>\n"},{"tags":["c#",".net","winrt","microsoft-metro"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1019,"score":0,"question_id":8300197,"title":"How to download a webpage in MetroStyle app (WinRT) and C#","body":"<p>I'm creating a MetroStyle app and I want to use a website API that is based on the HTTP Get methods. For instance to login I should download the XML returned by this URL:</p>\n\n<p><code>websitehost.com/api/login.php?u=username&amp;p=password</code></p>\n\n<p>The problem is that the new MetroStyle apps won't let me to use many of the methods I've been using for years in .Net so how can I download the returned XML document and parse it?</p>\n"},{"tags":[".net","web-services","windows-authentication","wso2","esb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13275401,"title":"WSO2 ESB pass through proxy for .NET web service with windows authentication","body":"<p>I have WSO2 ESB 4.0.3. I am trying to create a pass through proxy for a .Net web service that has windows authentication enabled. I am getting an error </p>\n\n<blockquote>\n  <p>\"Error trying to add the proxy service to the ESB configuration :\n  TESTPROXY :: Error reading from wsdl URI\".</p>\n</blockquote>\n\n<p>The wsdl URL works fine in the browser though. I am able to create the pass through proxy for this web service successfully if I enable anonymous authentication, but I do not want to do that though. </p>\n\n<p>How can I create a pass through proxy for a .Net web service with windows authentication enabled? Any information that would help me figure out the solution would be appreciated. Thanks.</p>\n"},{"tags":["c#",".net","sql-server"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":12964757,"title":"Pass sysname in datatable TVP","body":"<p>I have a stored procedure using the type below as a param</p>\n\n<pre><code>    CREATE TYPE [dbo].[columnOrderTableType] AS TABLE\n     ([id]                     [int]        IDENTITY(1,1) NOT NULL\n     ,[columnName]             [sysname]                  NOT NULL\n</code></pre>\n\n<p>I need to pass a datatable from my api as TVP to this sproc</p>\n\n<p>When I use string as value for the columnName I get an error saying that type doesnt match the types reqd for columnOrderTableType</p>\n\n<p>How do I pass a sysname in datatable?</p>\n"},{"tags":[".net","wpf","binding","menu"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1949,"score":3,"question_id":700681,"title":"WPF - Binding to a Menu Icon","body":"<p>I've got a UserControl that contains a menu.  I need to bind the Menu.Icon to a property of the UserControl but it's not working.</p>\n\n<p>The code starts like this - </p>\n\n<pre><code>        &lt;Border Grid.Row=\"0\"&gt;            \n        &lt;DockPanel&gt;\n            &lt;Image x:Name=\"testImage\" Height=\"16\" Width=\"16\" Source=\"{Binding ElementName=UC,Path=AddImage}\"/&gt;\n            &lt;Menu DockPanel.Dock=\"Left\" Height=\"20\"\n              VerticalAlignment=\"Center\"&gt;\n                &lt;MenuItem Header=\"{Binding ElementName=UC,Path=AddText}\"&gt;\n                    &lt;MenuItem.Icon&gt;\n                        &lt;!--&lt;Image x:Name=\"workswhenin\" Height=\"16\" Width=\"16\" Source=\"pack://application:,,/Kowdox;component/Images/UserIcons/user_add.png\"/&gt;--&gt;\n\n                        &lt;Image x:Name=\"realImage\" Height=\"16\" Width=\"16\"\n                        Source=\"{Binding ElementName=UC,Path=AddImage}\"/&gt;\n                    &lt;/MenuItem.Icon&gt;\n                &lt;/MenuItem&gt;\n</code></pre>\n\n<p>The first Image you see declared (testImage) works perfectly so I'm happy that the binding is correct.  The second Image (commented out and named 'workswhenin') contains the pack URI that I'm passing to the UserControls bound property and that works too but the third one (realImage) doesn't appear at all!  </p>\n\n<p>I can't see ANY reason why it shouldn't work; i know the binding is good and i know that the image's placement in the markup is good so what's going on?</p>\n\n<p>Any help will be greatly appreciated.\nThanks in advance.</p>\n"},{"tags":["c#",".net","windows","semaphore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13275439,"title":"What is the maximum length of a named Semaphore's name?","body":"<p>What is the maximum length of a <a href=\"http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx\" rel=\"nofollow\">Semaphore</a>'s name?  It makes sense that there would be one, as it maps to an underlying kernel semaphore, but the documentation does not seem to specify it precisely.</p>\n"},{"tags":[".net","xml"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3333,"score":2,"question_id":1039476,"title":"Reference to undeclared entity 'nbsp' - why?","body":"<p>I have the following line of code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>XDocument formConfiguration = XDocument.Load(ConfigurationManager.AppSettings[\"XMLFileURL\"]);\n</code></pre>\n\n<p>I get the following exception message:</p>\n\n<blockquote>\n  <p>Reference to undeclared entity 'nbsp'</p>\n</blockquote>\n\n<p>There are no <code>&amp;nbsp;</code> sequences in the XML.  There are no <code>&amp;</code> characters in the XML. Where could this be coming from?</p>\n\n<p>Thanks,\nCharles</p>\n"},{"tags":["c#",".net","winforms","keyevent"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13274936,"title":"A Form's key events go missing","body":"<p>I have a bug in my application that I don't know how to how to attack. Basically, key events \"go missing\" after some time. I have added event handlers to KeyDown, KeyPressed and KeyUp that write to the console (both for the Form and one of its TextBoxes). Here's the correct order of things:</p>\n\n<pre><code>control_PreviewKeyDown\nShellForm_KeyDown\ncontrol_KeyDown\nShellForm_KeyPress\ncontrol_KeyPress\nShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>In the failed state (which I can't reproduce consistently), I get these events when pressing a key (TextBox has focus):</p>\n\n<pre><code>ShellForm_KeyUp\ncontrol_KeyUp\n</code></pre>\n\n<p>Form.KeyPreview is true.</p>\n\n<p>It's the same for all TextBoxes in the Form; they are not disabled and not set to readonly, but it's no longer possible to write text.</p>\n\n<p>Problem is, I don't really know where to begin.</p>\n"},{"tags":["c#",".net","visual-studio-2010","visual-studio","visual-studio-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13273842,"title":"Code Contracts + Code Analysis","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2950081/can-one-make-code-analysis-understand-code-contracts\">Can one make Code Analysis understand Code Contracts?</a>  </p>\n</blockquote>\n\n\n\n<p>I think about starting to use <a href=\"http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx\" rel=\"nofollow\">Code Contracts</a> in my code base.</p>\n\n<p>I already use Code Analysis with all rules enabled and a goal of zero warnings.</p>\n\n<p>However, when using <code>Contract.Requires(parameter != null)</code> I get a warning from Code Analysis, namely CA1062:</p>\n\n<blockquote>\n  <p>CA1062 : Microsoft.Design : In externally visible method 'Foo', validate parameter 'parameter' before using it.</p>\n</blockquote>\n\n<p>That's unfortunate, I don't want to disable that rule as I find it useful. But I also don't want to suppress every false occurrence of it.</p>\n\n<p>Is there a solution?</p>\n"},{"tags":["c#","asp.net",".net","network-share"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":505,"score":0,"question_id":10684879,"title":"Reading File From Network Location","body":"<p>I am having Bunch of Files in A folder which is shared on Network Drive . I am trying to Access those Files into my Code . But It is giving an error:</p>\n\n<blockquote>\n  <p>System.IO.DirectoryNotFoundException was unhandled by user code</p>\n</blockquote>\n\n<pre><code>Fname = txtwbs.Text;\nDirectoryInfo objDir = new DirectoryInfo(\"Y:\\\\\");\n_xmlpath = objDir + \"\\\\\" + Fname + \"\\\\\" + Fname + \".xml\";\nif (File.Exists(_xmlpath ))\n{\n    reader(_xmlpath);\n}\n</code></pre>\n\n<p>I have Also used:</p>\n\n<pre><code>file = fopen(\"\\\\\\\\10.0.2.20\\\\smartjobs\\\\Eto\\\\\"+Fname);   \n</code></pre>\n\n<p>I am Able to Read File from My Local PC But it is giving Exception Only for Network Location .Please let me know how can I read File From Network Shared Location .</p>\n\n<p>And Also How Can I Make A tree view of Folders into Asp.net Web Application . </p>\n\n<p>Directory Structure is Like that </p>\n\n<pre><code>\\\\10.0.2.20\\Smartjobs\\Eto\\\n</code></pre>\n\n<p>this is Parent Directory It is congaing Nos of Folder having XML Documents.</p>\n"},{"tags":[".net","verification","il","peverify"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":13274384,"title":"Why is this .Net IL not verifiable?","body":"<p>I have a bit of custom IL I wrote and it won't pass PEVerify. The error I get is</p>\n\n<pre>\n$ peverify foo.exe\n\nMicrosoft (R) .NET Framework PE Verifier.  Version  4.0.30319.17929\nCopyright (c) Microsoft Corporation.  All rights reserved.\n\n[IL]: Error: [Z:\\virtualbox_shared\\foo.exe : HelloWorld.Program::Main][offset 0x00000021] Stack height at all points must be determinable in a single forward scan of IL.\n1 Error(s) Verifying foo.exe\n</pre>\n\n<p>The program however will run fine without any exceptions. Here is the IL of the relevant method:</p>\n\n<pre><code>.method private static hidebysig\n  default void Main (string[] args)  cil managed\n{\n// Method begins at RVA 0x2050\n.entrypoint\n// Code size 54 (0x36)\n.maxstack 2\n\n//custom IL\nldc.i4 1\nldc.i4 1\nceq\nswitch(first, second)\n\nfirst:\nldc.i4 1\nbr.s temp\npopit: pop\nbr.s second\n\ntemp: ldc.i4 1\nbrfalse temp2\ntemp2: br.s popit\n\nsecond:\nldc.i4 2\npop\n\nret\n\n} // end of method Program::Main\n</code></pre>\n\n<p>The full source code is at <a href=\"http://pastebin.com/TMEGuZFk\" rel=\"nofollow\">pastebin</a></p>\n\n<p>Why am I getting this error?</p>\n"},{"tags":[".net","reflection","class","properties"],"answer_count":5,"favorite_count":14,"up_vote_count":26,"down_vote_count":0,"view_count":12084,"score":26,"question_id":531384,"title":"How to loop through all the properties of a class?","body":"<p>I have a class.</p>\n\n<pre><code>Public Class Foo\n    Private _Name As String\n    Public Property Name() As String\n        Get\n            Return _Name\n        End Get\n        Set(ByVal value As String)\n            _Name = value\n        End Set\n    End Property\n\n    Private _Age As String\n    Public Property Age() As String\n        Get\n            Return _Age\n        End Get\n        Set(ByVal value As String)\n            _Age = value\n        End Set\n    End Property\n\n    Private _ContactNumber As String\n    Public Property ContactNumber() As String\n        Get\n            Return _ContactNumber\n        End Get\n        Set(ByVal value As String)\n            _ContactNumber = value\n        End Set\n    End Property\n\n\nEnd Class\n</code></pre>\n\n<p>I want to loop through the properties of the above class.\neg;</p>\n\n<pre><code>Public Sub DisplayAll(ByVal Someobject As Foo)\n    For Each _Property As something In Someobject.Properties\n        Console.WriteLine(_Property.Name &amp; \"=\" &amp; _Property.value)\n    Next\nEnd Sub\n</code></pre>\n"},{"tags":[".net","mvvm"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13269037,"title":"ViewModel and endless collection","body":"<p>I need to implement endless listbox (the one that is loading chunks of data when user scroll to the end) and I am using ViewModel.</p>\n\n<p>I have ListBox bound to ObservableCollection, but I don't known how to get notified about reaching the end of it and yet not to break the MVVM paradigm.\nHow can I achieve this?</p>\n\n<p>The only thing I need to know is how to retain MVVM features and constraints and yet to get notified when the collection has been enumerated to it's end.</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have been digging around a little and I am afraid that this is not an easy solution. I think the only possibility is to implement custom collection which will implement ICollection and INotifyCollectionChanged. But I don't know how the internal mechanisms of ListBox and other ItemsSource enabled controls work so I don't know how to implement lazy loading.</p>\n\n<p>Is the primary fetching mechanism of WP controls which utilize ItemsSource the IEnumerable interface? Or does it use indexer methods? How does it call count? Does it depend on count or can it be changed during it's lifecicle (and in which calls? I think that not all calls can change the Count and then call NotifyCollectionChanged).</p>\n\n<p>Is there any documentation? Or is there any implementation available?</p>\n"},{"tags":["c#",".net","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":59,"score":-1,"question_id":13274651,"title":"C# .net 4 dependency","body":"<p>I have a standalone tool developed in C# Visual Studio Express 2010.\nMy problem is that this tool will fail to start on machines having no .NET installed, and asking for .NET 4 on machines has .NET under 3.5 or lower. \nWhat I basically want to do is to install .NET 4 from my application before the main script runs. I can write a program to download it from an official webpage, also to run the installer etc. But the main problem still exists, the app won't even reach the download part as it won't run on machines...\nI've googled around and found that you can include dll-s etc., but I still doubt I can proceed without a proper .NET installation. So how can run dotnetfx.exe with my .NET dependent application?\nYour attention and ideas are much appreciated.\nCs.</p>\n"},{"tags":[".net","umbraco"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13274981,"title":"How to speed up node iteration in Umbraco?","body":"<p>I've written a search for a website that iterates through all nodes under a certain folder and then filters out nodes based on certain criteria. The site itself is used to search apartments. Here is the function I have for building the collection:</p>\n\n<pre><code>private static List&lt;Apartment&gt; GetApartmentsCollection()\n        {\n            List&lt;Apartment&gt; apartmentsCollection = new List&lt;Apartment&gt;();\n\n            Document apartmentsContainer = new Document(Convert.ToInt32(ConfigurationManager.AppSettings[\"apartmentsContainerNodeId\"]));\n\n            if (apartmentsContainer.HasChildren)\n            {\n                Document[] buildings = apartmentsContainer.Children;\n                foreach (Document building in buildings)\n                {\n                    if (building.Published)\n                    {\n                        // Store building id for apartment\n                        int buildingId = building.Id;\n                        if (building.HasChildren)\n                        {\n                            Document[] apartments = building.Children;\n                            foreach (Document apartment in apartments)\n                            {\n                                if (apartment.Published)\n                                {\n                                    apartmentsCollection.Add(new Apartment(apartment.Id,\n                                                                           buildingId,\n                                                                           Convert.ToInt32(apartment.Text),\n                                                                           (int)apartment.getProperty(\"apartmentType\").Value,\n                                                                           (int)apartment.getProperty(\"floor\").Value,\n                                                                           (int)apartment.getProperty(\"status\").Value,\n                                                                           (int)apartment.getProperty(\"bedrooms\").Value,\n                                                                           Convert.ToInt32(apartment.getProperty(\"price\").Value),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room1\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room1\").Value.ToString()),\n                                                                           apartment.getProperty(\"room1Dimensions\").Value.ToString(),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room2\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room2\").Value.ToString()),\n                                                                           apartment.getProperty(\"room2Dimensions\").Value.ToString(),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room3\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room3\").Value.ToString()),\n                                                                           apartment.getProperty(\"room3Dimensions\").Value.ToString(),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room4\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room4\").Value.ToString()),\n                                                                           apartment.getProperty(\"room4Dimensions\").Value.ToString(),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room5\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room5\").Value.ToString()),\n                                                                           apartment.getProperty(\"room5Dimensions\").Value.ToString(),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room6\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room6\").Value.ToString()),\n                                                                           apartment.getProperty(\"room6Dimensions\").Value.ToString(),\n                                                                           string.IsNullOrEmpty(apartment.getProperty(\"room7\").Value.ToString()) == true ? -1 : Convert.ToInt32(apartment.getProperty(\"room7\").Value.ToString()),\n                                                                           apartment.getProperty(\"room7Dimensions\").Value.ToString(),\n                                                                           apartment.getProperty(\"totalArea\").Value.ToString(),\n                                                                           apartment.getProperty(\"projectArea\").Value.ToString()));\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            return apartmentsCollection;\n        }\n</code></pre>\n\n<p>The only problem is that this takes a good 8-10 seconds or so (even though there are only ~150 nodes tops) which is too long.</p>\n\n<p>Bear in mind this is just for retrieving the raw collection. I then filter out out results using a handful of linq statements which takes a further few seconds. Ultimately this leads to a search of ~150 nodes taking around 15 seconds which is far too long.</p>\n\n<p>How can I speed this up?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","serialization"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13274421,"title":"Change object at runtime to serializable .NET","body":"<p>I would like change object to ISerializable at runtime. Something like</p>\n\n<pre><code>&lt;!-- language: c# --&gt;\nvar nonSerializeObject = new NonSerialize();\nISerializable mySerializeObject = \n      somethingforserializable.serialize(nonSerializeObject,TypeOfObject);\n</code></pre>\n"},{"tags":[".net","vb.net","soap","vb.net-2010"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":13201230,"title":"How can i change a list of string name In vb.net","body":"<p>i have a <code>WebMethod</code> that you pass a SQL Query for execution and return a list of string </p>\n\n<ul>\n<li>The query comes from the client side so i don't know what it is </li>\n</ul>\n\n<p>Here is the <code>webMethod</code></p>\n\n<pre><code>&lt;WebMethod()&gt; _\nPublic Function ExecQuery() As List(Of String)\n\n    Dim result As New List(Of String)\n    Dim sqlConn As New sqlConn........\n    Dim queryString As String = 'SELECT * FROM tbl_name'\n    Dim command As New SqlCommand(queryString, sqlConn)\n    sqlConn.Open()\n    Dim reader As SqlDataReader = command.ExecuteReader()\n    While reader.Read()\n        For i As Integer = 0 To reader.FieldCount - 1\n            result.Add(reader.Item(reader.GetName(i)))\n        Next\n\n    End While\n    Return result\n\nEnd Function\n</code></pre>\n\n<p><em>This code return a list of string as follow</em> </p>\n\n<p><img src=\"http://i.stack.imgur.com/krRIx.png\" alt=\"enter image description here\"></p>\n\n<p><em>i don't have enough experience doing this</em></p>\n\n<p><strong>QUESTION</strong> </p>\n\n<p>What is the best way of organizing this </p>\n\n<ul>\n<li><p>How can i change <code>&lt;string&gt;</code> To <code>&lt;column_name&gt;</code> and wrap them with <code>Unique Name</code> </p>\n\n<p>i used to create a <code>Class</code> and instead of <code>list (of string)</code> i used the class reference </p></li>\n</ul>\n\n<p>and i get a list as follow </p>\n\n<pre><code> &lt;className&gt;\n     &lt;col1&gt;val1&lt;col1&gt;\n     &lt;col2&gt;val1&lt;col1&gt;\n &lt;/className&gt;\n &lt;className&gt;\n     &lt;col1&gt;val2&lt;col1&gt;\n     &lt;col2&gt;val2&lt;col1&gt;\n &lt;/className&gt;\n</code></pre>\n\n<p>and then i loop in javascript using this class name </p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":3,"favorite_count":0,"up_vote_count":22,"down_vote_count":1,"view_count":4645,"score":21,"question_id":6089403,"title":"Delete all entities in Entity Framework","body":"<p>I want to delete content of all tables (all entities using Entity Framework 4+).\nHow can this be done?</p>\n\n<p>Thanks, James</p>\n"},{"tags":["c#",".net","dynamic","assemblies","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13272877,"title":"CSharpCodeProvider and resolution of dynamic assemblies","body":"<p>I have an application where I'm using CSharpCodeProvider to allow for integrated scripting via C# code.  The scripts can refer to dynamically emitted assemblies (these are created via IL Emit); to allow this reference, I save the dynamically generated assembly to a file on disk, then add this location to the CompilerParameters.ReferencedAssemblies collection.</p>\n\n<p>This works fine for the first compilation and execution of the script.  I have code that instantiates a class generated from the script, which has a constructor taking parameters, of which some are types from the dynamically emitted assembly.  It looks like this:</p>\n\n<pre><code>        var hostType = _compilerResults.CompiledAssembly.GetType(\"ExMod.Engine.ScriptHost\");\n\n        var parameters = new List&lt;object&gt;();\n        parameters.Add(simulation);\n\n        var extraParameters =\n            simulation.Environment.Controllers.\n            Select(c =&gt; c.GetPrecompiledContext()).\n            Where(c =&gt; c != null);\n        parameters.AddRange(extraParameters);\n\n        _scriptHost = (ScriptHostBase)Activator.CreateInstance(hostType, parameters.ToArray());\n</code></pre>\n\n<p>The extraParameters expression is where the references to the external dynamically generated types get added.</p>\n\n<p>The problem occurs when I attempt to compile and run the script a second time.  It only occurs if I've also re-emitted a new version of my IL Emit assembly.  The Exception occurs on the Activator.CreateInstance call and is:</p>\n\n<p><code>MissingMethodException: Constructor on type 'ExMod.Engine.ScriptHost' not found.</code></p>\n\n<p>Observations:</p>\n\n<ol>\n<li>I've confirmed via the Debugger that a constructor does exist with the correct parameters.</li>\n<li>I've also confirmed (using the Make Object ID in the Debugger) that the issue is caused because the 'Controller' parameter in the constructor (referenced type from the dynamically emitted assembly) is referring to the original dynamic assembly, rather than the most recently emitted dynamic assembly, which is why the types don't match and the constructor does not resolve.</li>\n<li>When I run the CSharpCodeProvider compiler and then try to run the script, it never calls my AppDomain AssemblyResolve event, which is where I have special logic to always resolve to the 'most recent' dynamic assembly.</li>\n</ol>\n\n<p>My theory is that somehow the CSharpCodeProvider is resolving the 'earliest' dynamic assembly rather than the 'latest'. This occurs because they both have the same name and location.  The question: how do I get the CSharpCodeProvider to resolve to the latest version of the dynamic assembly?</p>\n\n<p>I've considered changing the location for each dynamically emitted assembly, but I'd prefer not to create a bunch of copies on disk for each script iteration.</p>\n"},{"tags":["c#",".net","code-contracts"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":40,"score":6,"question_id":13274102,"title":"CodeContracts: false warning \"Possibly unboxing a null reference\"","body":"<p><img src=\"http://i.stack.imgur.com/dyPL2.png\" alt=\"enter image description here\"></p>\n\n<p>In the image above, you can see a warning from Code Contracts. I don't think this is legit, as <code>this</code> can never be <code>null</code>.</p>\n\n<p>Is this a bug or am I missing something?</p>\n\n<hr>\n\n<p>This property is a member of the following class:</p>\n\n<pre><code>public class NHibernateIQueryableQueryBase&lt;TEntity, TQuery, TQueryInterface&gt;\n    : IQuery&lt;TEntity&gt;, IFluentQueryInterface&lt;TEntity, TQueryInterface&gt;\n    where TQuery : NHibernateIQueryableQueryBase&lt;TEntity, TQuery,\n                                                 TQueryInterface&gt;,\n                   TQueryInterface\n    where TQueryInterface : IQuery&lt;TEntity&gt;\n</code></pre>\n\n<hr>\n\n<p>Update:<br>\nChanging the property to the following still shows the warning - on the line <code>return result;</code>:</p>\n\n<pre><code>public TQueryInterface And\n{\n    get\n    {\n        var result = this as TQuery;\n        return result;\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13274113,"title":"Variables that accept values with pipe | as separator","body":"<p>I have six variables of type <code>String</code>, they contain 0/1 value retrieved from a DB field bit.</p>\n\n<p>So,these variables are value of radio boxes, that have Y=1 | N=0. </p>\n\n<p>Now,  I have a Varilable,  that accept one or more enumerator values, they are separated by pipe \"|\".</p>\n\n<pre><code>if (bool.Parse(mht_ReadAccess) &amp;&amp; bool.Parse(mht_WriteAccess))\n{\n  var grantAccessRequest = new GrantAccessRequest\n  {\n    PrincipalAccess = new PrincipalAccess\n    {\n      AccessMask = AccessRights.WriteAccess | AccessRights.ReadAccess,\n      Principal = userreference\n    },\n    Target = recordentityreference\n  };\n}\n</code></pre>\n\n<p>Now, this is a static way to solve this problem.  If I have 6 variables like \"mht_WriteAccess\" , how can I check how many of them are set on  true, and automatically change the situation for the \"AccessMask\" variable, and so pass all the right enum values with pipe.</p>\n\n<p>I want to know if there's a way to do this automatically, maybe with any cycle?</p>\n"},{"tags":[".net","c#-4.0","ado.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13274382,"title":"SetOrdinal() not working","body":"<p>I have a complex dynamic query which is returning me records with Column Names as long type values.</p>\n\n<p>Before showing them in grid, I want to re-order/sort columns names.</p>\n\n<p>So I am using bubble sort to sort the columns:</p>\n\n<pre><code>long nextValue = 0;\nlong currentValue = 0;\n\n// Sorting columns\nfor (int i = 3; i &lt; MeasurementData.Tables[0].Columns.Count; i++)         \n{\n   long.TryParse(MeasurementData.Tables[0].Columns[i].ColumnName, out currentValue);\n\n   for (int j = 3; j &lt; columnCollection.Count; j++)    \n   {\n       long.TryParse(MeasurementData.Tables[0].Columns[j].ColumnName, out nextValue);\n\n       if (currentValue &gt; nextValue)       \n       {\n          int currentOrdinal = MeasurementData.Tables[0].Columns[i].Ordinal;\n          int nextOrdinal = MeasurementData.Tables[0].Columns[j].Ordinal;\n\n          MeasurementData.Tables[0].Columns[i].SetOrdinal(nextOrdinal);\n          MeasurementData.Tables[0].Columns[j].SetOrdinal(currentOrdinal);            \n        }            \n    }         \n} \n</code></pre>\n\n<p>But the ordinals are not getting set. I tried setting manually ordinall to some value, that didn't work either.</p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["c#",".net","linq","extension-methods","ienumerable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":67,"score":0,"question_id":13270063,"title":"Is there any built-in .NET Framework alternative for my extension method?","body":"<p>I got this nice method which I use in many cases.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    using (IEnumerator&lt;TSource&gt; enumer = e.GetEnumerator())\n    {\n        if (!enumer.MoveNext())\n            yield break;\n\n        bool flag = true;\n        TSource first = enumer.Current;\n\n        do\n        {\n            TSource current = enumer.Current;\n            TSource next = (flag = enumer.MoveNext()) ? enumer.Current : first;\n            yield return currentNextAction(current, next);\n        } while (flag);\n    }\n}\n</code></pre>\n\n<p>I have looked <a href=\"http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx\" rel=\"nofollow\">MSDN</a> for some built-in alternatives, but could not find them. Is there any?</p>\n\n<p>And, is there anything I could improve in this code?</p>\n\n<p><strong>EDIT</strong>: New code for non-enumeratorable method.</p>\n\n<pre><code>internal static IEnumerable&lt;TResult&gt; RoundTrip&lt;TSource, TResult&gt;\n (this IEnumerable&lt;TSource&gt; e, Func&lt;TSource, TSource, TResult&gt; currentNextAction)\n{\n    bool flag = false;\n    TSource first = default(TSource);\n    TSource previous = default(TSource);\n\n    foreach (TSource item in e)\n    {\n        if (!flag)\n        {\n            flag = true;\n            first = previous = item;\n            continue;\n        }\n\n        yield return currentNextAction(item, previous);\n        previous = item;\n    }\n\n    if (flag)\n        yield return currentNextAction(previous, first);\n    else\n        yield break;\n}\n</code></pre>\n\n<p>(I like the first one by the way)</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":32,"score":-4,"question_id":13273796,"title":"Working Lyrics Service?","body":"<p>I need a Lyrics provider for my media player.\nSearched the web and found alot of samples. None of them work now, either the service is down or service has changed the API :S</p>\n\n<p>Can someone direct me to a working API Service for a lyrics providing app??</p>\n\n<p>According to my knowledge these sites don't supply their services for developers anymore\nLyricsPlugin : Not Working\nLyricWiki : Not Working\nLeosLyrics\nLyrDB(worked sometime back though)</p>\n\n<p>.Net 4, C#, WPF</p>\n\n<p>Thanks in advance.\nHave a nice day! :)</p>\n"},{"tags":["c#",".net","wpf","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13274253,"title":"WPF ,Window AllowTransparency , Poor Performance Fix","body":"<p>Performance for a Windows Presentation Foundation (WPF)-based program may be less than expected. For example, you may experience jittery animation, a low frame rate, or high CPU usage. This problem occurs if the program uses the layered windows feature. This feature is enabled if the value of the Windows.AllowsTransparency property is set to TRUE.</p>\n"},{"tags":["c#",".net","windows-8"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13274145,"title":"using .net 4 projects with 4.5 target?","body":"<p>I am new to .NET and c#.</p>\n\n<p>There are so many good examples out there made for .NET 4.0, but when I do NUGET it complains that the target .net version mismatches.</p>\n\n<p>I am developing for Windows 8 and Windows Phone 8, so they use .NET 4.5.</p>\n\n<p>Is there any way to just convert the old projects and force them to use .NET 4.5? \nOr do I need to wait for the author to update his project?</p>\n"},{"tags":["c#",".net","isolatedstorage"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":7089,"score":6,"question_id":1112681,"title":"Can I get a path for a IsolatedStorage file and read it from external applications?","body":"<p>I want to write a file where an external application can read it, but I want also some of the IsolatedStorage advantages, basically insurance against unexpected exceptions. Can I have it?</p>\n"},{"tags":["c#",".net","sqlite3","compact-framework","system.data.sqlite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13249669,"title":"Updating Multiple Tables using single connection object in System.Data.SQLite","body":"<p>I am using Compact Framework <code>SQLite ADO adapter(System.Data.SQLite)</code> to update the database on my device. I am storing my <code>DB</code> in file. The DB contains 3-4 table which may get access concurrently. My query is, can I execute insert, update, read on these tables using single <code>SQLiteConnection</code> object?  </p>\n\n<p>Thanks,\nOmky</p>\n"},{"tags":["javascript","asp.net",".net","json","extjs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13274003,"title":"Convert a list of file paths to a JSON tree in ASP.NET","body":"<p>I have a NET back-end interacting with Amazon S3 web services. I am using a Javascript library (ExtJs) on the front end to try and create a file-browser. In order to do that I have to convert all the file paths in Amazon like</p>\n\n<p>Directory1/SubDirectory1/File.txt</p>\n\n<p>Directory1/SubDirectory2/File2.txt</p>\n\n<p>Directory2/SubDirectory3/File3.txt</p>\n\n<p>To a JSON tree which would something like this:</p>\n\n<pre><code> root: {\n        expanded: true,\n        children: [\n            { text: \"Directory1\", expanded: true, children: [\n                { text: \"SubDirectory1\", children: [\n                  {text:\"File.txt\", leaf: true }\n                  ]\n                },\n                { text: \"SubDirectory2\",children: [\n                  {text: \"File2.txt\"\",leaf: true}\n                 ]\n               } \n            ] },\n            { text: \"Director2\", expanded: true, children:[\n                 {text:\"SubDirectory3\",children: [\n                   {text:\"File3.txt\",leaf: true}\n                     ]\n                  }\n             ]\n             }\n    }\n</code></pre>\n\n<p>Anyone know a good way to do this in .NET? Anyway I can think of seems very error prone or heavy on really inefficient.</p>\n"},{"tags":["c#",".net","outlook"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13274078,"title":"Outlook 2003+ Embedding signatures with images to all sent emails","body":"<p>I have a Win Form application that does some boring accounting stuff and then sends it's data to some lucky recipients. I am using the Outlook 12.0 Interop objects and my applications environment ranges from office 2003 on XP to office 2007 on Win 7.</p>\n\n<p>My issue lies with sending the corporate signature with the sent emails.\nIt contains two images and I would like to embed these images so they appear to be part of the body (assuming the receiving mail client supports that).</p>\n\n<p>I have tried a few different methods of accomplishing this; but still no luck!</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li><p>Extracting the html data from the signatures folder, changing the\nhtml img tags src attribute to include 'file///'. This causes Outlook\nto replace the 'file///' with 'CID' and I assumed it would also embed\nthe image... we should never assume :|. This is the method I found\nworked best for getting the rest of the signature.</p></li>\n<li><p>(After creating a new MailItem) - Grabbing the HTMLBody of the MailItem\nand extracting the relevant part including the signature... This\ndidnt work due to the new MailItem object being very inconsistent\nwith it's signature. By that I mean sometimes the new item would\ninclude the signature and sometimes it wouldn't! :s I cannot figure out why it is not    always there, no other part of my code has changed!</p></li>\n</ul>\n\n<p>I read on another post here about the GetInspector property... Apparently just calling this will do 'Some stuff' and the signature will magically appear in your mail item... NO!</p>\n\n<p>Things I can't do:</p>\n\n<ul>\n<li>I cannot (as much as i would like to) shove the images online\nsomewhere and point to them in the emails html.</li>\n<li>I cannot use SMTP(It has to be through Outlook... sigh).</li>\n</ul>\n\n<p>I am thinking that the best way seems to be my original method of messing about with the CID, but I do not really know much about what Outlook is doing in the background so I am having trouble figuring out what else I need to do to get the images sent along with the email.</p>\n\n<p>Hoping someone out there has some idea about what I am doing wrong or what else I could try.</p>\n\n<p>Please let me know if code would be helpful and I will post, (Most of the code tried is from this site... I just cannot find the links again and am trying to avoid making this question tooooo long).</p>\n\n<p>Many thanks</p>\n"},{"tags":[".net","smtpclient","resolve","mailmessage","email-address"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13274005,"title":".NET SmtpClient: Is there a way to make sure that all emails resolve prior to sending MailMessage?","body":"<p>I am using SmtpClient to send an email to multiple recipients.  As employees leave the company, their email addresses become invalid.  Since their email addresses remain in our database until deleted manually, trying to send an email to them causes our application to throw an exception during <code>SmtpClient.Send(MailMessage)</code>.  However, in spite of the exception being thrown, it still sends the email.  This is a problem because we want to handle this error by blocking the user's attempt to save the record and display a friendly message advising to delete any invalid associates from the database.</p>\n\n<p>If there were a way to iterate through all the recipeients to make sure they're all valid, we can keep all emails from being sent until the user satisifes a set of conditions.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1624,"score":6,"question_id":4809520,"title":"How to allow copying message on MessageBox","body":"<p>How can I allow selecting and copying of text from MessageBox in WPF?</p>\n"},{"tags":[".net","visual-studio"],"answer_count":5,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":4169,"score":7,"question_id":10113532,"title":"How do I fix the .NET C++/C# error, \"mismatch between processor architecture\"?","body":"<p>I'm new to project configuration in Visual Studio 2010 but, I've done some <a href=\"http://visualstudiohacks.com/articles/visual-studio-net-platform-target-explained/\" rel=\"nofollow\">research</a> and still can't quite figure it out. I have a Visual Studio solution with a C++ DLL referencing the C# DLL. The C# DLL references a few other DLLs, some within my project and some external. When I try to compile the C++ DLL, I get this warning:</p>\n\n<blockquote>\n  <p>warning MSB3270: There was a mismatch between the processor architecture of the project being build \"MSIL\" and the processor architecture of the reference \"[internal C# dll]\", \"x86\".</p>\n</blockquote>\n\n<p>It tells me to go to Configuration Manager to align my architectures. The C# DLL is set up with platform target x86. If I try to change this to something else, like Any CPU, it complains because one of the external DLLs <em>it</em> depends on has platform target x86.</p>\n\n<p>When I look at Configuration Manager it shows the Platform for my C# DLL as x86 and for my C++ project as Win32. This seems like the right setup; surely I don't want the project for my C++ project to have platform set to x64, which is the only other option presented.</p>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["c#",".net","ado.net","edmx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":17,"score":-2,"question_id":13273720,"title":"Edmx Entity model inheritance","body":"<p>I want to create a generic Entity Model, with some classes and logics above, to put into a DLL and reuse that in various projects. I keep in mind the possibility to extend the generic ModelContainer in another in every project and use the extended ModelContainer to access database. I ask you if it is possible to do so in a \"clean way\" or I need some work around or \"bad stuff\".\nThank you all.</p>\n"},{"tags":["c#",".net","asp.net","web-config","settings"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1684,"score":3,"question_id":6289388,"title":"Custom type application settings in ASP.NET","body":"<p>Just now I came across ApplicationSettings in .NET WinForms that could handle complex types.<br>\nCurrently I am using AppSettings in my ASP.NET WebForms which can handle only string.<br>\nCan I use ApplicationSettings in Webforms? If so how?</p>\n"},{"tags":["c#",".net","image","web","download"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13273697,"title":"How do I download pictures from a webpage based on their LINKS on this page?","body":"<p>This is what I have so far but I'm running into an issue.</p>\n\n<p>The page <a href=\"https://xxxxxxxx.zendesk.com/tickets/33126\" rel=\"nofollow\">https://xxxxxxxx.zendesk.com/tickets/33126</a> contains a link to a .jpg image. I want to download this image. The page could have several images so I need to scan the page to find all the .jpg, .gif, etc.</p>\n\n<pre><code>I'm having an issue with my code at the end. I'll explain there.\n\n    public static void GetTicketAttachments(string url)\n    {   \n        GetImages(\"https://xxxxxxxx.zendesk.com/tickets/33126\");   \n    }\n\nstatic void GetImages(string url)\n    {\n        string responseString;\n        HttpWebRequest initialRequest = (HttpWebRequest)WebRequest.Create(url);\n        using (HttpWebResponse initialResponse = (HttpWebResponse)initialRequest.GetResponse())\n        {\n            using (StreamReader reader = new StreamReader(initialResponse.GetResponseStream()))\n            {\n                responseString = reader.ReadToEnd();\n            }\n\n            List&lt;string&gt; imageset = new List&lt;string&gt;();\n            Regex regex = new Regex(@\"f=\"\"[^\"\"]*jpg|bmp|tif|gif|png\", RegexOptions.IgnoreCase);\n            foreach (Match m in regex.Matches(responseString))\n            {\n                if (!imageset.Contains(m.Value))\n                    imageset.Add(m.Value);\n            }\n            for (int i = 0; i &lt; imageset.Count; i++)\n                imageset[i] = imageset[i].Remove(0, 3);\n            totalFiles = imageset.Count;\n            currentFiles = totalFiles;\n\n            foreach (string f in imageset)\n            {\n                ThreadPool.QueueUserWorkItem(new WaitCallback(DownloadImage), f);\n            }\n        }\n    }\n</code></pre>\n\n<p>The issue happens here. The object \"path\" is always null for some reason. Therefore I cannot download the picture.</p>\n\n<pre><code>static void DownloadImage(object path)\n    {\n        currentFiles--;\n        path = Path.GetFileName(path.ToString());\n        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(path.ToString());\n        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())\n        {\n            Image image = Image.FromStream(response.GetResponseStream());\n            image.Save(@\"C:\\\" + Path.GetFileName(path.ToString()));\n        }\n    }\n</code></pre>\n\n<p>Anyone know what could be the issue? The \"picture count\" is indeed counting 1 (one link TO a picture on the page). </p>\n"},{"tags":["c#","asp.net",".net","vb.net","usercontrols"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13249082,"title":"When does usercontrol visible property affect its children?","body":"<p>I have a <strong>ASP.NET userControl</strong> that contains other controls. \nSometimes, when changing the visible property of the usercontrol, it does change the visible value of its children, but sometimes it doesn't. </p>\n\n<p>I thought it depended on the moment the property was changed during the page life cycle, cause it seemed to work well when changed in the <code>Page_PreRender</code> event, but I got a case when it didn't work.</p>\n\n<p>Any idea, on how I could affect the visibility of all the controls of the user control just through the visible property of this one? I don't want to make a loop through all the children to set their visbile property.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13273601,"title":"Right Data Structure for Cascading Controls","body":"<p>Suppose I had a series of tables in a database with (for example purposes) information about the menu items in a series of restaurants. \nSo, for example, we have, say 10 tables:</p>\n\n<pre><code>Rest_1, Rest_2, Rest_3, .... Rest_10 \n(Names being more complex, though, in the real situation)\n</code></pre>\n\n<p>And every table has the EXACT SAME column structure, say (Just making this up for illustration purposes, so forgive the weakness of the example):</p>\n\n<pre><code>Col1 (Primary Key) = Menu_Item\nCol2               = Menu_Category  (Desert, Appetizer, ...)\nCol3               = Item_Cost\nCol4               = Item_SalePrice\nCol5               = Item_Popularity\nCol6               = Seasonal_Item  (Boolean - Is it seasonal)\nCol7               = Min_Order      (Boolean - Is there a minimum order from the vendor)  \nCol8               = In_Stock       (Boolean - Is it in stock now)  \n....\n</code></pre>\n\n<p>Now, I have a Windows Form with, say, 3 comboBoxes and a checkbox:</p>\n\n<pre><code>cboRestaurant\ncboMenuCategory\ncboPopularity\nckInStock\n</code></pre>\n\n<p>And a DataView which, based upon what the user chooses above, shows the correct (filtered) information which can then be used for processing something.</p>\n\n<p>So, my situation is that we would:</p>\n\n<ol>\n<li>Populate the Restaurant combobox</li>\n<li>Based upon the user's selection of cboRestaurant &amp; the ckInStock.checked status, populate the cboMenuCategory combobox</li>\n<li>Based upon 1 &amp; 2, populate the cboPopularity combobox</li>\n<li>Based upon what user chose for all the comboboxes / checkbox, populate the dataview.</li>\n</ol>\n\n<p>... Again, I know this is a weak example, but I'm trying to convey the concept.</p>\n\n<hr>\n\n<p>So... Based upon what I've picked up online, what I'm seeing as being the best case to accomplish this would be to:</p>\n\n<ol>\n<li>Query each Table and store the results in a DataTable  (This I can do)</li>\n<li>Store those datatables in a Dataset                    (This I can do)</li>\n</ol>\n\n<p>What I don't know how to do is to let the dataset know how all the datatables are related (All have the same column names) <strong>AND</strong> bind the comboboxes to the dataset such as to filter the information based upon what was selected in the previous combobox.</p>\n\n<h2>OR</h2>\n\n<p>Create a list(of custom object) that will hold all these variables from all the tables and then Linq-Query that list based upon the <code>combobox.SelectedIndexChanged</code> \\ <code>ckInStock.CheckedChanged</code> events - this seems much worse since we're constantly querying and re-querying.</p>\n\n<hr>\n\n<h2>So, my first question is:</h2>\n\n<p>If solution #1 is right, how do I create the conglomerated dataset and have the comboboxes have the correct filtered data based upon the preceding comboboxes and checkbox value?</p>\n\n<h2>My Second question is:</h2>\n\n<p>Is there just a better way to accomplish this IN TOTAL that I just don't know about - A built in better object that does the cascading filtering for you, or how best to accomlish this otherwise?</p>\n"},{"tags":["c#",".net","encoding","character-encoding","special-characters"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13272149,"title":"Encoding special characters into Byte array","body":"<p>Few days ago I've asked a question about german special characters.\nI can encode and decode characters like ö, ä or ü now. But.. some characters left and I need to encode/decode them too. </p>\n\n<p>For example, characters that fails: ² ³ € µ Ü Ö Ä ~ ´ §</p>\n\n<p>Here is code: </p>\n\n<pre><code>    private static byte[] MyGetBytesArray(string data)\n    {\n        Encoding enc = new UTF8Encoding(true, true);\n        return enc.GetBytes(data);\n    }\n\n    private static string MyGetString(byte[] data)\n    {\n        Encoding enc = new UTF8Encoding(true, true);\n        return enc.GetString(data);\n    }\n</code></pre>\n\n<p>I'm looking for a solution to encode/decode all characters. I'm writing an encrypt/decrypt algorythm, and I don't know what user will paste into program. I need to give back exactly the same. </p>\n\n<p>Thanks for help, again.. </p>\n\n<p>EDIT:\nOk, UnicodeEncoding works (I think). It is my encrypt/decrypt algoryth now:/ I'm still not sure what is going on (I thnik it is sth with zeros. During encoding by Unicode zero is after every character), but encoding special characters wokrs. At least that test was successfull: </p>\n\n<pre><code>string text = File.ReadAllText(opd.FileName, Encoding.Default);\nbyte[] byt = getBytesArray(text);\nstring text2 = getString(byt);\n\nif (text2 == text)\n{\n    MessageBox.Show(\"OK\");\n}\nelse\n{\n    MessageBox.Show(\"FAIL\");\n}\n</code></pre>\n\n<p>BTW. Encoding.Default is correct right ? </p>\n"},{"tags":["c#",".net","sql-server","stream"],"answer_count":4,"favorite_count":38,"up_vote_count":123,"down_vote_count":0,"view_count":106685,"score":123,"question_id":411592,"title":"How do I save a stream to a file?","body":"<p>I have a <code>StreamReader</code> object that I initialized with a stream, now I want to save this stream to disk (the stream may be a <code>.gif</code> or <code>.jpg</code> or <code>.pdf</code>).</p>\n\n<p>Existing Code:</p>\n\n<pre><code>StreamReader sr = new StreamReader(myOtherObject.InputStream);\n</code></pre>\n\n<ol>\n<li>I need to save this to disk (I have the filename).</li>\n<li>In the future I may want to store this to SQL Server.</li>\n</ol>\n\n<p>I have the encoding type also, which I will need if I store it to SQL Server, correct?</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13272091,"title":"Transfer Cookie from WebBrowser to Webrequest","body":"<p>I get the cookies from InternetGetCookieEx and then pass it to WebRequest however this won't work for Hotmail. The result is </p>\n\n<blockquote>\n  <p><strong>Cookies must be allowed</strong>  Your browser is currently set to block cookies. Your browser must allow cookies before you can use Windows\n  Live ID.</p>\n</blockquote>\n\n<pre><code>[DllImport(\"wininet.dll\", CharSet = CharSet.Auto, SetLastError = true)]\nstatic extern bool InternetGetCookieEx(string pchURL, string pchCookieName, StringBuilder pchCookieData, ref uint pcchCookieData, int dwFlags, IntPtr lpReserved);\nconst int INTERNET_COOKIE_HTTPONLY = 0x00002000;\n\npublic static string GetGlobalCookies(string uri)\n{\n    uint datasize = 1024;\n    StringBuilder cookieData = new StringBuilder((int)datasize);\n    if (InternetGetCookieEx(uri, null, cookieData, ref datasize, INTERNET_COOKIE_HTTPONLY, IntPtr.Zero)\n        &amp;&amp; cookieData.Length &gt; 0)\n    {\n        return cookieData.ToString().Replace(';', ',');\n    }\n    else\n    {\n        return null;\n    }\n}\n\nhttpWebRequest.CookieContainer.SetCookies(\n    webBrowser.Document.Url, \n    GetGlobalCookies(webBrowser.Document.Url.AbsoluteUri)\n    );\n</code></pre>\n"},{"tags":["c#",".net","obfuscation"],"answer_count":6,"favorite_count":7,"up_vote_count":6,"down_vote_count":3,"view_count":3222,"score":3,"question_id":1857685,"title":"How to create own dotnet obfuscator","body":"<p>I know that dot net dlls and exe contain their assemblies with them so every body can extract code from it. So please tell me how can i create my own .net obfuscator and if there exist any other way to protect my application to deassemble. and plez dont give me link of any paid obfuscator. i would prefer code sample in c# or vb.net</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":4,"view_count":56,"score":-3,"question_id":13273205,"title":"Need advice on program logic","body":"<p>The program comes to the page and makes pressing buttons</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\n\nnamespace Bot\n{\n    public partial class FormWindow : Form\n    {\n        Random rnd;\n        Settings settingsForm;\n        Timer tm;\n        CallTimers callTimers;\n\n        public FormWindow()\n        {\n            rnd = new Random();\n            settingsForm = new Settings();\n            tm = new Timer();\n            tm.Tick += new EventHandler(tm_Tick);\n            wb = new WebBrowser();\n            InitializeComponent();\n        }\n\n        private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n        {\n            if (wb.Document.GetElementById(\"login-email\") != null)\n            {\n                wb.Document.GetElementById(\"login-email\").InnerText = settingsForm.tEmail.Text;\n                wb.Document.GetElementById(\"login-password\").InnerText = settingsForm.tPassword.Text;\n                Method_1(\"button luxury\")[0].InvokeMember(\"click\");\n            }\n\n               CallMethodAfterDelay(KrysomahHunting, 5000, tm);\n\n                if (wb.Url.AbsoluteUri == \"http://www.moswar.ru/metro/\" &amp;&amp; wb.ReadyState == WebBrowserReadyState.Complete)\n                {\n                    wb.Stop();\n                    method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n                    Method_1(new string[] { \"button\" })[0].InvokeMember(\"click\");\n                }\n        }\n\n        //go to page \n        public void GoPage(string string_9, string string_10)\n        {\n            this.wb.Stop();\n            string additionalHeaders = \"Content-Type: application/x-www-form-urlencoded\" + Environment.NewLine;\n            this.wb.Navigate(string_9, \"\", Encoding.UTF8.GetBytes(string_10), additionalHeaders);\n        }\n\n\n        public List&lt;HtmlElement&gt; Method_1(params string[] ClassNames)\n        {\n            List&lt;HtmlElement&gt; list = new List&lt;HtmlElement&gt;();\n            foreach (HtmlElement htmlElement in wb.Document.All)\n            {\n                for (int i = 0; i &lt; ClassNames.Length; i++)\n                {\n                    string b = ClassNames[i];\n                    if (htmlElement.GetAttribute(\"className\") == b)\n                    {\n                        list.Add(htmlElement);\n                        break;\n                    }\n                }\n            }\n            return list;\n        }\n\n\n        private void ButtonStart_Click(object sender, EventArgs e)\n        {\n            if (this.settingsForm.tEmail.Text == \"\" || this.settingsForm.tPassword.Text == \"\")\n            {\n                MessageBox.Show(\"Отсутствует логин и\\\\или пароль для входа на сервер МосВара.\\nВвести их можно, нажав на кнопку \\\"Настройки\\\".\", \"Ошибка\", MessageBoxButtons.OK, MessageBoxIcon.Hand);\n                return;\n            }\n            wb.Navigate(\"http://www.moswar.ru\");\n        }\n\n        private void tm_Tick(object sender, EventArgs e)\n        {\n            ((MethodInvoker)tm.Tag).Invoke();\n            tm.Stop();\n        }\n\n        //go to page through time \n         public void CallMethodAfterDelay(MethodInvoker MethodToCall, int Delay,Timer tm)\n       {\n           tm.Interval = Delay;\n           tm.Tag = MethodToCall;\n           tm.Start();\n       }\n        public void KrysomahHunting()\n        {\n            GoPage(\"http://www.moswar.ru/metro/\", \"\");\n        }\n\n        private List&lt;HtmlElement&gt; method_2(string string_9, string string_10)\n        {\n            List&lt;HtmlElement&gt; list = new List&lt;HtmlElement&gt;();\n            foreach (HtmlElement htmlElement in this.wb.Document.All)\n            {\n                if (htmlElement.GetAttribute(\"className\") == string_9 &amp;&amp; htmlElement.InnerText != null &amp;&amp; htmlElement.InnerText.IndexOf(string_10) != -1)\n                {\n                    list.Add(htmlElement);\n                }\n            }\n            return list;\n        }\n\n    }\n}\n</code></pre>\n\n<p>Help how to articulate the logic</p>\n\n<p>In this piece of code</p>\n\n<pre><code>private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n        {\n            if (wb.Document.GetElementById(\"login-email\") != null)\n            {\n                wb.Document.GetElementById(\"login-email\").InnerText = settingsForm.tEmail.Text;\n                wb.Document.GetElementById(\"login-password\").InnerText = settingsForm.tPassword.Text;\n                Method_1(\"button luxury\")[0].InvokeMember(\"click\");\n            }\n\n               CallMethodAfterDelay(KrysomahHunting, 5000, tm);\n\n                if (wb.Url.AbsoluteUri == \"http://www.moswar.ru/metro/\" &amp;&amp; wb.ReadyState == WebBrowserReadyState.Complete)\n                {\n                    wb.Stop();\n                    method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n                    Method_1(new string[] { \"button\" })[0].InvokeMember(\"click\");\n                }\n\n        }\n</code></pre>\n\n<p>When the program comes to the method </p>\n\n<pre><code>method_2(\"c\", \"Выследить Крысомаху\")[0].InvokeMember(\"click\");\n</code></pre>\n\n<p>throws Exception ArgumentOutRangeException</p>\n\n<p>I supposethat this couldbe caused by </p>\n\n<pre><code>private void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n</code></pre>\n\n<p>Heconstantly checks.Ifapagethatexecute methods .And because the method once already done its job, there is no longer the values</p>\n\n<p>And so we get an exception ArgumentOutRangeException. Help how to make the logic for this case!</p>\n"},{"tags":["c#",".net","c#-4.0","sso","saml-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13273256,"title":"Error while deserializing SAML2 response to Saml2SecurityToken","body":"<p>I have a SAML Reponse which I want to convert to a Saml2SecurityToken.\nThis is what I do:</p>\n\n<pre><code>// SAMLResponseString is a base64 encode SAML2 XML string\nstring SAMLResponse = SamlHelper.DecodeFrom64(SAMLResponseString);\nXmlReader reader = new XmlTextReader(new StringReader(SAMLResponse));\n\nvar certificate = new X509Certificate2(\"[path]\", \"[password]\");\nList&lt;SecurityToken&gt; tokens = new List&lt;SecurityToken&gt;();\ntokens.Add(new X509SecurityToken(certificate));\n\nSecurityTokenResolver outOfBandTokenResolver =\n  SecurityTokenResolver.CreateDefaultSecurityTokenResolver(new \n  ReadOnlyCollection&lt;SecurityToken&gt;(tokens), true);\nvar securityToken = (Saml2SecurityToken) WSSecurityTokenSerializer.DefaultInstance.ReadToken(reader, null);\n</code></pre>\n\n<p>On the last line (of the WSSecurityTokenSerializer), I get the following error:</p>\n\n<pre><code>Cannot read the token from the 'Response' element with the 'urn:oasis:names:tc:SAML:2.0:protocol' namespace for BinarySecretSecurityToken, with a '' ValueType. If this element is expected to be valid, ensure that security is configured to consume tokens with the name, namespace and value type specified.\n</code></pre>\n\n<p>My Response is starting with: (without the space between &lt; and samlp:Response):</p>\n\n<pre><code>&lt; samlp:Response xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" xmlns:saml=\"urn:oasis:names:tc:SAML:2.0:assertion\" Version=\"2.0\"&gt;\n</code></pre>\n\n<p>Does anyone know what is going wrong here?</p>\n"},{"tags":["c#",".net","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13273180,"title":"c# Reflection of a nested struct property","body":"<p>I'm trying to do some dynamic text to object parsing, however, I have run into a snag when creating and setting nested property values for structs.</p>\n\n<p>If I have a property in an object that is a struct, whenever I use reflection to obtain the struct object and set any of it's properties/fields, the value on the object is not changed.  Take the object graph below.</p>\n\n<pre><code>public struct MyStruct\n{\n    public int MyIntProp {get;set;}\n}\n\npublic class MyObj\n{\n    public MyStruct NestedStruct {get;set;}\n}\n\nPropertyInfo pInfo = (myObj.GetType()).GetProperty(\"NestedStruct\");\nobject nestedStruct = pInfo.GetValue(myObj); // This is the nested struct however it is only a copy not the actual object\nPropertyInfo intInfo = (pInfo.PropertyType).GetProperty(\"MyIntProp\");\nintInfo.SetValue(nestedStruct, 23); // this sets the MyIntProp on the nestedStruct, but it is not set on the myObj.NestedStruct.  My goal is to set object on that NestedStruct via reflection.\n</code></pre>\n\n<p>When I use reflection to obtain the NestedStruct property and then set the MyIntProp on that struct, the original MyObj.NestedStruct.MyIntProp doesn't change.  Naturally I attribute this to the fact that the struct is a value type and not a reference type.  </p>\n\n<p>So the real question is how I can use reflection to obtain the reference to a value type.</p>\n"},{"tags":[".net","excel","oledb","conditional-formatting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13273168,"title":"Import data with OleDb from Excel turns negative number to positive","body":"<p>My problem is needing to take a column of dollar amounts both positive and negative to insert into a database.  I've had issues with mixed data types previously, but finally got everything working using the following connection string,</p>\n\n<p>\"Provider=Microsoft.ACE.OLEDB.12.0; Data Source={some_filepath}; Extended Properties=Excel 12.0; Xml; IMEX=1; HDR=NO\"</p>\n\n<p>Now the only issue I have is when the Excel spreadsheet has conditional formatting that displays negative numbers as red and positive numbers as black.  A user will enter '-100' for instance, but Excel will only display a red '100' and OleDb doesn't read the minus sign.  When I switch Excel's conditional formatting to one that displays a minus sign everything works fine.</p>\n\n<p>Is there any way I can disable the conditional formatting to read the value exactly as the user entered it?</p>\n\n<p>Regards,\nMatt</p>\n"},{"tags":[".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13268345,"title":"Changing the location of a child user control dynamically","body":"<p>I have created an user control which have another user control as child inside it. I have tried moving  the child user control bu issuing the following statement</p>\n\n<p><code>this.versionDisplay.SetValue(Canvas.TopProperty,10.0);</code></p>\n\n<p>But VS2010 is showing an error as follows</p>\n\n<blockquote>\n  <p>Error 23  'MainApp.MainGui.MainControls.MainTitleControl' does not\n  contain a definition for 'versionDisplay' and no extension method\n  'versionDisplay' accepting a first argument of type\n  'MainApp.MainGui.MainControls.MainTitleControl' could be found (are\n  you missing a using directive or an assembly reference?)</p>\n</blockquote>\n\n<p>I am sure that name of the child control is versionDisplay.</p>\n\n<p>Code for MainTitleControl</p>\n\n<pre><code>&lt;UserControl x:Class=\"Main.MainGui.MainControls.MainTitleControl\"\n     xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n     xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n     xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n     xmlns:wcontrols=\"clr-namespace:WEPA.MainGui.MainControls\"\n     Height=\"80\" Width=\"395\" Loaded=\"UserControl_Loaded\" &gt;\n\n     &lt;Grid Background=\"Transparent\"  &gt;\n         &lt;Image  HorizontalAlignment=\"Left\"  Name=\"image1\" Stretch=\"Fill\" VerticalAlignment=\"Top\"  Width=\"635\" Height=\"120\" Source=\"/MainApplication;component/images/UnCategorized/Wireless.png\" Margin=\"12,0,0,0\" / &gt;\n         &lt;wcontrols:supportInfoControl Name=\"versionDisplay\" Height=\"20\" Canvas.Left=\"185\" Canvas.Top=\"70\" Margin=\"200,95,-114,-35\" /&gt;\n    &lt;/Grid&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>Please advice.</p>\n"},{"tags":[".net","multithreading","locking","interlocked","synclock"],"answer_count":5,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":5061,"score":8,"question_id":2534547,"title":"Why use SyncLocks in .NET for simple operations when Interlocked class is available?","body":"<p>I've been doing simple multi-threading in VB.NET for a while, and have just gotten into my first large multi-threaded project. I've always done everything using the <code>Synclock</code> statement because I didn't think there was a better way.</p>\n\n<p>I just learned about the <code>Interlocked</code> Class - it makes it look as though all this:</p>\n\n<pre><code>Private SomeInt as Integer\nPrivate SomeInt_LockObject as New Object\n\nPublic Sub IntrementSomeInt\n    Synclock SomeInt_LockObject\n        SomeInt += 1\n    End Synclock\nEnd Sub\n</code></pre>\n\n<p>Can be replaced with a single statement:</p>\n\n<pre><code>Interlocked.Increment(SomeInt)\n</code></pre>\n\n<p>This handles all the locking internally and modifies the number. This would be much simpler than writing my own locks for simple operations (longer-running or more complicated operations obviously still need their own locking).</p>\n\n<p>Is there a reason why I'd rolling my own locking, using dedicated locking objects, when I can accomplish the same thing using the <code>Interlocked</code> methods?</p>\n"},{"tags":[".net","datetime","tick"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13272928,"title":"Why is DateTime.Ticks a signed integer?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3658560/why-is-count-not-an-unsigned-integer\">Why is Count not an unsigned integer?</a>  </p>\n</blockquote>\n\n\n\n<p>The <a href=\"http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx\" rel=\"nofollow\">Ticks property of the DateTime</a> class is defined as \"the number of ticks that represent the date and time of this instance\".</p>\n\n<p>It is implemented as a signed long integer.</p>\n\n<p>Shouldn't it be unsigned?</p>\n\n<p>I can't think of any reason to make it signed other than possibly compatibility constraints. The CLR itself certainly does handle unsigned 64 bit ints very well.</p>\n"},{"tags":["c#",".net","entity-framework",".net-assembly"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13271262,"title":"Entity Framework meta data","body":"<p>I have a piece of code</p>\n\n<pre><code> using (InContext inContext = new InContext())\n</code></pre>\n\n<p>When I right click the definition, it points to <code>C:\\Users\\me\\AppData\\Local\\Temp\\....</code></p>\n\n<p>What is that? A defined dll?</p>\n\n<pre><code>    #region Assembly SharedObjects.dll, v4.0.30319\n   // C:\\source\\blah\\blah\\packages\\SharedObjects.1.0.4659.22817\\lib\\net40\\SharedObjects.dll\n    #endregion\n\n   using blahSharedObjects;\n   using System;\n   using System.Data.Entity;\n\n   namespace something\n   {\n       public class InContext : DbContext\n   {\n       public InContext();\n       public InContext(string connectionString);\n\n\n        public DbSet&lt;InDetails&gt; InDetailRecords { get; set; }\n        public string IPAddress { get; set; }\n\n        public string UserName { get; set; }\n\n   }\n</code></pre>\n\n<p>}</p>\n"},{"tags":[".net","ravendb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":10573615,"title":"Coping with denormalization using Includes() in RavenDB, to retrieve up-to-date data","body":"<p>I have such entities persisted in RavenDB:</p>\n\n<pre><code>public class Project: RootAggregate\n{        \n    public string Name { get; set; }        \n}\n\npublic class Profile: RootAggregate\n{\n    public string User { get; set; }\n    public IList&lt;Project&gt; FavoriteProjects { get; set; }\n}\n</code></pre>\n\n<p>Since, it is document database, not relational one, it is denormalized and it supposed to be ok. Anyway, I didn't designed it this way:</p>\n\n<pre><code>public class Profile: RootAggregate\n{\n    public string User { get; set; }\n    public IList&lt;string&gt; FavoriteProjectsIds { get; set; }\n}\n</code></pre>\n\n<p>But sometimes I have to load up-to-dated projects (for this case with up-to-dated names). I've read on <a href=\"http://ayende.com/blog/4584/ravendb-includes\" rel=\"nofollow\">Ayende blog</a> that can use <code>Include()</code>, like below:</p>\n\n<pre><code>var profile = session.Include&lt;Project&gt;(x =&gt; x.Id)\n                     .Load&lt;Profile&gt;(Id);\n</code></pre>\n\n<p>firstly I thought that the statement:</p>\n\n<pre><code>var projects = profile.FavouriteProjects;\n</code></pre>\n\n<p>will give me merged up-to-dated results, but no. I was confused, but then I've read further, and realized that it is ok, but the query below is supposed not to reach the database second time (as far as I understand Ayende's post):</p>\n\n<pre><code>var projectsIds = profile.FavoriteProjects.Select(x =&gt; x.Id).ToList();\nvar projects = session.Load&lt;Project&gt;(projectsIds);\n</code></pre>\n\n<p>Am I right? I'm asking because in the blog there was speech about single entity (<code>Customer</code>), while I want to retrieve whole up-to-dated collection (<code>IList&lt;Project&gt;</code>). </p>\n\n<p>Next, what if while getting fresh projects connected with the profile, I want to search the same time along indexed profiles (because I have no theirs IDs), for example like below (such construction is not allowed):</p>\n\n<pre><code>var profile = session.Include&lt;Project&gt;(x =&gt; x.Id)\n                     .Query&lt;Profile&gt;()\n                     .Single(x =&gt; x.User == \"jwa\");   \n</code></pre>\n\n<p>Can it be done some way, or need I to retrieve up-to-dated projects \"by myself\" like below ?</p>\n\n<pre><code>var profile = session.Query&lt;Profile&gt;().Single(x = x.User == \"jwa\");\nvar projectsIds = profile.FavoriteProjects.Select(x =&gt; x.Id).ToList();\nvar projects = session.Load&lt;Project&gt;(projectsIds);\n</code></pre>\n\n<p>Shall it be redesigned to be more relational ?</p>\n"},{"tags":["c#",".net","diagram","system.drawing"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1793,"score":3,"question_id":1993468,"title":"Creating Visio look-a-like diagrams programatically","body":"<p>I need to programatically create Visio look-a-like diagrams as a drawing. Mostly we are going to create network layout diagrams similar to this <a href=\"http://i.msdn.microsoft.com/Bb232815.a27c390d-e9d7-4b2d-97ef-ced4fa09856c%28ja-jp,office.12%29.gif\" rel=\"nofollow\">one</a>. </p>\n\n<p>Is there a component that could speed-up the development or some technique we could use? Generally we could do this on our own via System.Drawing, but this might get tricky for more complex network diagrams as we would have to ensure there are no visual overlappings. </p>\n\n<p><strong>UPDATE:</strong> No Visio available.\n<strong>UPDATE 2:</strong> I would love if these could be eye candy</p>\n"},{"tags":["c#",".net","membership-provider","sqlmembershipprovider"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13271544,"title":"writing custom membership provider","body":"<p>i am writing the custom membership provider class by implementing System.Web.Security.membershipprovider.</p>\n\n<p>now my problem is while accessing the class i am getting error as</p>\n\n<p>error code :</p>\n\n<pre><code>String reference not set to an instance of a String.\nParameter name: s\n</code></pre>\n\n<p>Stack trace:</p>\n\n<pre><code>   at System.Text.Encoding.GetBytes(String s)\n   at ss.Provider.EncodePassword(String password) \n   at ss.Provider.CreateUser(String username, String password, String email, String passwordQuestion, String passwordAnswer, Boolean isApproved, Object providerUserKey, MembershipCreateStatus&amp; status) \n   at System.Web.UI.WebControls.CreateUserWizard.AttemptCreateUser()\n   at System.Web.UI.WebControls.CreateUserWizard.OnNextButtonClick(WizardNavigationEventArgs e)\n   at System.Web.UI.WebControls.Wizard.OnBubbleEvent(Object source, EventArgs e)\n   at System.Web.UI.WebControls.CreateUserWizard.OnBubbleEvent(Object source, EventArgs e)\n   at System.Web.UI.WebControls.Wizard.WizardChildTable.OnBubbleEvent(Object source, EventArgs args)\n   at System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args)\n   at System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e)\n   at System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)\n   at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)\n   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)\n</code></pre>\n\n<p>and my class as</p>\n\n<p>create user:</p>\n\n<pre><code> public override MembershipUser GetUser(object userID,bool userIsOnline)\n        {\n            SqlConnection sqlConnection = new SqlConnection(connectionString);\n            SqlCommand sqlCommand = new SqlCommand(\"User_SelByUserID\", sqlConnection);\n\n            sqlCommand.CommandType = CommandType.StoredProcedure;\n            sqlCommand.Parameters.Add(\"@userID\", SqlDbType.UniqueIdentifier).Value = userID;\n\n            MembershipUser membershipUser = null;\n            SqlDataReader sqlDataReader = null;\n\n            try\n            {\n                sqlConnection.Open();\n\n                sqlDataReader = sqlCommand.ExecuteReader(CommandBehavior.CloseConnection);\n\n                if (sqlDataReader.HasRows)\n                {\n                    sqlDataReader.Read();\n                    membershipUser = GetUserFromReader(sqlDataReader);\n\n                    if (userIsOnline)\n                    {\n                        SqlCommand sqlUpdateCommand = new SqlCommand(\"User_UpdateActivityDate_ByUserID\", sqlConnection);\n\n                        sqlUpdateCommand.CommandType = CommandType.StoredProcedure;\n                        sqlUpdateCommand.Parameters.Add(\"@userID\", SqlDbType.NVarChar, 255).Value = userID;\n                        sqlUpdateCommand.Parameters.Add(\"@applicationName\", SqlDbType.NVarChar, 255).Value = applicationName;\n                        sqlUpdateCommand.ExecuteNonQuery();\n                    }\n                }\n            }\n            catch (SqlException e)\n            {\n                //Add exception handling here.\n            }\n            finally\n            {\n                if (sqlDataReader != null) { sqlDataReader.Close(); }\n            }\n\n            return membershipUser;\n\n        }\n</code></pre>\n\n<p>Encode password:</p>\n\n<pre><code>private string EncodePassword(string password)\n        {\n            string encodedPassword = password;\n\n            switch (PasswordFormat)\n            {\n                case MembershipPasswordFormat.Clear:\n                    break;\n                case MembershipPasswordFormat.Encrypted:\n                    encodedPassword = Convert.ToBase64String(EncryptPassword(Encoding.Unicode.GetBytes(password)));\n                    break;\n                case MembershipPasswordFormat.Hashed:\n                    HMACSHA1 hash = new HMACSHA1();\n                    hash.Key = HexToByte(machineKey.ValidationKey);\n                    encodedPassword = Convert.ToBase64String(hash.ComputeHash(Encoding.Unicode.GetBytes(password)));\n                    break;\n                default:\n                    throw new ProviderException(\"Unsupported password format.\");\n            }\n\n            return encodedPassword;\n        }\n</code></pre>\n\n<p>the password given string is Gowtham!1</p>\n\n<p>Updated:</p>\n\n<pre><code>  public override MembershipUser CreateUser(string username, string password, string email, string passwordQuestion, string passwordAnswer, bool isApproved, object providerUserKey, out MembershipCreateStatus status)\n        {\n\n            ValidatePasswordEventArgs args = new ValidatePasswordEventArgs(username, password, true);\n\n            OnValidatingPassword(args);\n\n            if (args.Cancel)\n            {\n                status = MembershipCreateStatus.InvalidPassword;\n                return null;\n            }\n\n            if ((RequiresUniqueEmail &amp;&amp; (GetUserNameByEmail(email) != String.Empty)))\n            {\n                status = MembershipCreateStatus.DuplicateEmail;\n                return null;\n            }\n\n            MembershipUser membershipUser = GetUser(username, false);\n\n            if (membershipUser == null)\n            {\n                System.DateTime createDate = DateTime.Now;\n\n                SqlConnection sqlConnection = new SqlConnection(connectionString);\n                SqlCommand sqlCommand = new SqlCommand(\"User_Ins\", sqlConnection);\n\n                sqlCommand.CommandType = CommandType.StoredProcedure;\n                sqlCommand.Parameters.Add(\"@returnValue\", SqlDbType.Int, 0).Direction = ParameterDirection.ReturnValue;\n                sqlCommand.Parameters.Add(\"@username\", SqlDbType.NVarChar, 255).Value = username; ;\n                sqlCommand.Parameters.Add(\"@applicationName\", SqlDbType.NVarChar, 255).Value = applicationName;\n                sqlCommand.Parameters.Add(\"@password\", SqlDbType.NVarChar, 255).Value = EncodePassword(password);\n                sqlCommand.Parameters.Add(\"@email\", SqlDbType.NVarChar, 128).Value = email;\n                sqlCommand.Parameters.Add(\"@passwordQuestion\", SqlDbType.NVarChar, 255).Value = passwordQuestion;\n                sqlCommand.Parameters.Add(\"@passwordAnswer\", SqlDbType.NVarChar, 255).Value = EncodePassword(passwordAnswer);\n                sqlCommand.Parameters.Add(\"@isApproved\", SqlDbType.Bit).Value = isApproved;\n                sqlCommand.Parameters.Add(\"@comment\", SqlDbType.NVarChar, 255).Value = String.Empty;\n\n                try\n                {\n                    sqlConnection.Open();\n\n                    sqlCommand.ExecuteNonQuery();\n                    if ((int)sqlCommand.Parameters[\"@returnValue\"].Value == 0)\n                    {\n\n                        status = MembershipCreateStatus.Success;\n                    }\n                    else\n                    {\n                        status = MembershipCreateStatus.UserRejected;\n                    }\n                }\n                catch (SqlException e)\n                {\n                    //Add exception handling here.\n\n                    status = MembershipCreateStatus.ProviderError;\n                }\n                finally\n                {\n                    sqlConnection.Close();\n                }\n\n                return GetUser(username, false);\n            }\n            else\n            {\n                status = MembershipCreateStatus.DuplicateUserName;\n            }\n\n            return null;\n        }\n</code></pre>\n"},{"tags":[".net","sql-server","linq-to-sql","stored-procedures","executequery"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":360,"score":4,"question_id":3284747,"title":"Is it possible to return multiple result sets using ExecuteQuery in Linq to Sql?","body":"<p>I know that you can return multiple results from a stored procedure and through the method generated by the designer.</p>\n\n<p>However, I'm trying to do the same using ExecuteQuery but it doesn't seem like it's possible.\nHas anyone tried or know whether this is possible?</p>\n\n<p>Basically I'm trying to run an ad-hoc stored procedure.  By ad-hoc, I mean a stored procedure that wasn't available during design-time.</p>\n"},{"tags":["c#",".net","excel","usercontrols","vsto"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":199,"score":3,"question_id":12270735,"title":"Getting a handle to a NamedRange control in C#","body":"<p>I'm developing an application-level AddIn for Excel 2007 using C# (.NET 4.0). Questions similar to this one have been previously asked >></p>\n\n<p><a href=\"http://stackoverflow.com/questions/11374023/resizing-namedrange-throws-a-controlnotfoundexception\">Resizing NamedRange throws a ControlNotFoundException</a></p>\n\n<p><a href=\"http://stackoverflow.com/questions/7152020/c-sharp-excel-addin-accessing-controls\">C# excel addin - Accessing Controls</a></p>\n\n<p>but the responses to them (where there were any) did not work for me. So I would like to give a detailed description of what I'm trying to do, and what happens when I try to do it.</p>\n\n<p>Very briefly, my problem is that I'm not able to get hold of NamedRange control objects for modifying them, after they have been instantiated and initialized elsewhere in the code.</p>\n\n<p>Please read on for a more complete description.</p>\n\n<p>When the AddIn starts, it creates a NamedRange control and attaches it to some cells on a particular worksheet >></p>\n\n<pre><code>Worksheet worksheet = Globals.Factory.GetVstoObject(\n                Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nExcel.Range cell = worksheet.Range[\"A1\"];\n_configParams.HeaderNamedRange = worksheet.Controls.AddNamedRange(cell, \"HeaderCells\");\n_configParams.HeaderNamedRange.RefersTo = \"=\" + worksheet.Name + \"!$A$1:$A$5\";\n</code></pre>\n\n<p>After the AddIn has started, I want to allow the User to re-specify the cells to which this NamedRange control can point. In order to do so, I'm getting the User to select a range of cells and then get hold of the selected cells' location (as a String) in a suitable event-handler method.</p>\n\n<p>I then intend to programmatically re-specify the cells that the above NamedRange control points to. I have tried the following approaches, but neither of them work.</p>\n\n<p>[Approach 1]</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\n((NamedRange)(controlWorksheet.Controls[\"HeaderCells\"])).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, it throws a ControlNotFoundException, and I get the following message:</p>\n\n<pre><code>Microsoft.VisualStudio.Tools.Applications.Runtime.ControlNotFoundException was unhandled by user code\n  Message=This document might not function as expected because the following control is missing: PortfolioHeaderCells. Data that relies on this control will not be automatically displayed or updated, and other custom functionality will not be available. Contact your administrator or the author of this document for further assistance.\n  Source=Microsoft.Office.Tools.Excel.Implementation\n  StackTrace:\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.EnsureProxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.get_Proxy()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.AttachSupport()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.ResetControl()\n       at Microsoft.Office.Tools.Excel.NamedRangeImpl.set_RefersTo(String value)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException: System.Runtime.InteropServices.COMException\n       Message=Exception from HRESULT: 0x800A03EC\n       Source=Microsoft.VisualStudio.Tools.Office.Runtime\n       ErrorCode=-2146827284\n       StackTrace:\n            at Microsoft.VisualStudio.Tools.Office.Runtime.Interop.IHostItemProvider.GetHostObject(String primaryType, String primaryCookie, IntPtr&amp; hostObject)\n            at Microsoft.VisualStudio.Tools.Office.Runtime.DomainCreator.ExecuteCustomization.Microsoft.Office.Tools.IHostItemProvider.GetHostObject(Type primaryType, String primaryCookie)\n            at Microsoft.Office.Tools.Excel.NamedRangeImpl.GetObjects()\n       InnerException:\n</code></pre>\n\n<p>[Approach 2]</p>\n\n<p>I then saw <a href=\"http://stackoverflow.com/questions/2416727/set-excel-named-ranges-via-c\">Set Excel Named Ranges via C#?</a> and so tried to use the approach described in the answer there:</p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\ncontrolWorksheet.Names.Item(\"HeaderCells\", Type.Missing, Type.Missing).RefersTo = newHeaderCellsLocation;\n</code></pre>\n\n<p>On running the above code, I get the following exception and message:</p>\n\n<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code\n  Message=Exception from HRESULT: 0x800A03EC\n  Source=\"\"\n  ErrorCode=-2146827284\n  StackTrace:\n       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)\n       at Microsoft.Office.Interop.Excel.Names.Item(Object Index, Object IndexLocal, Object RefersTo)\n       at ExcelListenerAddIn.Configuration.ListenerConfigManager.ActivateListenerConfiguration(ListenerConfigParams newConfiguration, Boolean cameFromConfigFile) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\Configuration\\ListenerConfigManager.cs:line 97\n       at ExcelListenerAddIn.TaskPanes.ListenerConfigurator._activateNewConfigButton_Click(Object sender, EventArgs e) in C:\\Users\\jag201\\Documents\\Visual Studio 2010\\Projects\\PoC\\ExcelListenerAddIn\\TaskPanes\\ListenerConfigurator.cs:line 131\n       at System.EventHandler.Invoke(Object sender, EventArgs e)\n       at System.Windows.Forms.Control.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnClick(EventArgs e)\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException:\n</code></pre>\n\n<p>So, in both approaches, the exception from HRESULT is the same: 0x800A03EC. Also, the exception is being thrown in the line where I try to get hold of the NamedRange control and re-specify the cells it points to.</p>\n\n<p>I have stepped through my code, and a NamedRange control does indeed exist where/when I try to modify the NamedRange object.</p>\n\n<p>I then checked the type of the <code>controlWorksheet.Controls[\"HeaderCells\"]</code> object using the following code >></p>\n\n<pre><code>Worksheet controlWorksheet = Globals.Factory.GetVstoObject(Globals.ThisAddIn.Application.ActiveWorkbook.ActiveSheet);\nSystem.Windows.Forms.MessageBox.Show((controlWorksheet.Controls[\"HeaderCells\"]).ToString());\n</code></pre>\n\n<p>This results in a MessageBox containing \"Microsoft.Office.Tools.Excel.NamedRangeImpl\". If I'm not mistaken, this Type is not exposed by the Excel Object Model, and so I wonder if the problem is being caused by my casting a NamedRangeImpl object to a NamedRange control object.</p>\n\n<p>Your help is much appreciated. If there is any further information that I can provide, please let me know. Thanks in advance!</p>\n"},{"tags":[".net","vb.net","serial-port"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":861,"score":1,"question_id":3453979,"title":"Recommendation for 3rd Party .NET Serial Port Class/Component","body":"<p>I am looking for a serial port component for .NET that overcomes the issues with the built-in Serial Port component related to sudden unplugging of USB-to-RS232 adapters, and suspension of the computer while the port is open.  (Untrappable errors occurring after the the device is unplugged or the computer comes back after being suspended.)</p>\n\n<p>I have been using <a href=\"http://home.comcast.net/~hardandsoftware/enhanced_serial_port_object_for.htm\" rel=\"nofollow\">Richard Grier's solution</a>, but I still have problems when resuming from suspend.</p>\n\n<p>Is there a 3rd party component that you would recommend?  I have tried several, and each have their shortcomings.  Ideally I'd like a drop-in replacement for the standard serial port, but I'll take whatever I can get.</p>\n\n<p>(Note:  I apologize if you find this post a bit vague.  This question is targeted to those familiar with my problem... it is a very common issue.)</p>\n\n<p>Thank you for your time.</p>\n\n<p><strong>Edit:</strong> It turns out that upgrading to .NET 4 and using the serial class works fine on XP, but does <em>not</em> work on Windows 7.</p>\n"},{"tags":["c#",".net","winrt",".net-4.5"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1889,"score":7,"question_id":7596919,"title":"WinRT - TCP clients?","body":"<p>I am building an IRC client in the new WinRT <code>(.NET 4.5</code>) framework for Windows 8 Metro applications.</p>\n\n<p>However, I have some issues. I've already figured out that I need to use a <code>StreamSocket</code> to read TCP data, but I may be doing something wrong.</p>\n\n<p>The reason I believe this is because I am not receiving any data.</p>\n\n<p>Below you see my code. I haven't been able to find any code samples on the web regarding this.</p>\n\n<pre><code>class IRCClient\n{\n    private StreamSocket tcpClient;\n    public string Server = \"holmes.freenode.net\";\n    public int Port = 6665;\n\n    public IRCClient()\n    {\n        tcpClient = new StreamSocket();\n    }\n\n    public async void Connect()\n    {\n        await tcpClient.ConnectAsync(\n                         new Windows.Networking.HostName(Server), \n                         Port.ToString(), \n                         SocketProtectionLevel.PlainSocket);\n\n        DataReader reader = new DataReader(tcpClient.InputStream);\n        string data = reader.ReadString(reader.UnconsumedBufferLength);\n\n        MessageDialog dialog = new MessageDialog(data);            \n    }\n}\n</code></pre>\n\n<p>Data is always an empty string following that code. Furthermore, UnconsumedBufferLength always returns 0.</p>\n\n<p>How come?</p>\n"},{"tags":["c#","asp.net",".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13271611,"title":"What are the things that i have to Do and Don't when an application to be Globalized and Localized?","body":"<p><strong>What are the areas we needed to change in the code when an application to be Globalized and Localized?</strong></p>\n\n<p>For example</p>\n\n<p><strong>Do</strong></p>\n\n<pre><code>string datenew = Convert.ToDateTime(\"10/31/2012\", CultureInfo.InvariantCulture)\n                        .ToString();\n</code></pre>\n\n<p><strong>Don't</strong></p>\n\n<pre><code>string datenew = Convert.ToDateTime(\"10/31/2012\").ToString();\n</code></pre>\n"},{"tags":["c#",".net","vb.net"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":13272056,"title":"FormatNumber for c#","body":"<p>Im struggling to get the right syntax to use in c# for the vb function FormatNumber...i will say that 'iPremium' is an object as it returns data from a tableadapter.</p>\n\n<p>the value that 'ipremium' holds is 943.4000 and the idea is to only have two decimal places after the '.', i would hope this is acheivable using the right syntax but unfortunately not being a c# expert, it could take a while to figure this out.</p>\n\n<p>here's the vb code:</p>\n\n<pre><code>  iPremium = FormatNumber(iPremium, 2, TriState.True)\n</code></pre>\n\n<p>any idea's on how this is acheivable? </p>\n\n<p>thanks for any idea's and suggestions and excuse the ignorance if this is not worded correctly</p>\n"},{"tags":["c#",".net","excel","sharepoint","pia"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1853,"score":4,"question_id":6960693,"title":"Excel process doesn't get closed","body":"<p>I know similar questions have been asked before but I still need to ask this question as I am not able to get my EXCEL (32) process closed once I am done using it.</p>\n\n<p>As you can see in the code below, once <code>ProcessRFAFData</code> function finishes its execution, the EXCEL process doesn't get closed (I can still see <code>EXCEL.EXE*32</code> in the task manager).</p>\n\n<p>For this reason, when <code>SaveErrors</code> starts its execution, I get the following exception:</p>\n\n<p><code>System.Runtime.InteropServices.COMException (0x800A03EC):<br>\nMicrosoft Office Excel cannot open or save any more documents because there is not enough available memory or disk space.<br>\n• To make more memory available, close workbooks or programs you no longer need.<br>\n• To free disk space, delete files you no longer need from the disk you are saving to.<br>\nat Microsoft.Office.Interop.Excel.Workbooks.Add(Object Template)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.&lt;&gt;c__DisplayClass9.b__6()<br>\nat Microsoft.SharePoint.SPSecurity.&lt;&gt;c__DisplayClass4.b__2()<br>\nat Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess(CodeToRunElevated secureCode)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(WaitCallback secureCode, Object param)<br>\nat Microsoft.SharePoint.SPSecurity.RunWithElevatedPrivileges(CodeToRunElevated secureCode)<br>\nat NextG.RFAFImport.Layouts.NextG.RFAFImport.RFAFDataImporter.SaveErrors()</code></p>\n\n<p>Here is the code that executes the Excel processes:</p>\n\n<pre><code>try {\n    ProcessRFAFData(FileName);\n} catch (Exception ex) {\n    Status = \"ERROR: \" + ex.ToString();\n}\n\nif (Errors.Count() &gt; 0) {\n    SaveErrors();\n}\n</code></pre>\n\n<p>Here are all the functions interacting with Excel:</p>\n\n<pre><code>private void ReleaseObject(object obj) {\n    try {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n        obj = null;\n    } catch (Exception) { } finally {\n        GC.Collect();\n    }\n}\n\nprivate void ProcessRFAFData(string FileName) {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    bool error = false;\n\n    try {\n        SPSecurity.RunWithElevatedPrivileges(delegate() {\n            XLA = new Microsoft.Office.Interop.Excel.Application();\n            XLW = XLA.Workbooks.Open(FileName, 0, true,\n                Type.Missing, null, null, true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows,\n                Type.Missing, false, false, Type.Missing, false, Type.Missing, Type.Missing);\n\n            int index = RFAFTabExists(ref XLW);\n            if (index == 0) return;\n\n            XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(index);\n\n            if (!ValidProjectID(ref XLS)) return;\n\n            ParseData(ref XLS);\n\n            XLW.Close(true, Type.Missing, Type.Missing);\n            XLA.Quit();\n\n            ReleaseObject(XLS);\n            ReleaseObject(XLW);\n            ReleaseObject(XLA);\n        });\n    } catch (SP.ServerException ex) {\n        // output error\n    } catch (Exception ex) {\n        // output error\n    }\n}\n\nprivate int RFAFTabExists(ref Microsoft.Office.Interop.Excel.Workbook XLW) {\n    int index = 0;\n    foreach (Microsoft.Office.Interop.Excel.Worksheet w in XLW.Worksheets) {\n        if (w.Name.Equals(settings.Collection[\"RFAFTabName\"])) index++;\n    }\n\n    return index;\n}\n\nprivate bool ValidProjectID(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    using (SP.ClientContext CTX = new SP.ClientContext(SiteURL)) {\n        var projectId = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n\n        var project = // getting list of projects from SharePoint\n\n        if (project.Count() &gt; 0) {\n            ProjectID = XLS.Cells.get_Range(settings.Collection[\"ProjectIDCell\"], Type.Missing).Text.ToString();\n            return true;\n        }\n    }\n\n    return false;\n}\n\nprivate void ParseData(ref Microsoft.Office.Interop.Excel.Worksheet XLS) {\n    ListData.Add(\"HID\", GetHID(XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString()));\n\n    if (ListData[\"HID\"].Equals(\"0\")) Errors.Add(new ImportError {\n        Reason = \"Hub ID does not exist in this project workspace.\",\n        Reference = string.Format(\"Hub ID: {0}\", XLS.Cells.get_Range(settings.Collection[\"HIDCell\"],\n        Type.Missing).Text.ToString())\n    });\n\n    int row = Int32.Parse(settings.Collection[\"StartRow\"]);\n    while (!NoMoreData(ref XLS, row)) {\n        string PRSIN = XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"PRSIN\"], row), Type.Missing).Text.ToString();\n\n        string NOC = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"NOC\"], row), Type.Missing).Text.ToString());\n\n        string UEIRP = ValidateNumber(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"UEIRP\"], row), Type.Missing).Text.ToString());\n\n        string LAT = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LAT\"], row), Type.Missing).Text.ToString());\n\n        string LON = ValidateLatLon(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"LON\"], row), Type.Missing).Text.ToString());\n\n        string PJ = GetPJ(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        string ST = GetState(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n            settings.Collection[\"JurisdictionCol\"], row), Type.Missing).Text.ToString(),\n            XLS.Cells.get_Range(string.Format(\"{0}{1}\", settings.Collection[\"StateCol\"], row),\n            Type.Missing).Text.ToString());\n\n        ListItemData.Add(new ListItem {\n            ProposedRemoteSiteItemNumber = PRSIN,\n            NumberOfCarriers = NOC,\n            UsableEIRP = UEIRP,\n            Latitude = LAT,\n            Longitude = LON,\n            PrimaryJurisdiction = PJ,\n            State = ST\n        });\n\n        row++;\n    }\n}\n\nprivate bool NoMoreData(ref Microsoft.Office.Interop.Excel.Worksheet XLS, int row) {\n    return string.IsNullOrEmpty(XLS.Cells.get_Range(string.Format(\"{0}{1}\",\n        settings.Collection[\"ProposedRemoteSiteItemNumberCol\"], row), Type.Missing).Text.ToString());\n}\n\nprivate void SaveErrors() {\n    Microsoft.Office.Interop.Excel.Application XLA = null;\n    Microsoft.Office.Interop.Excel.Workbook XLW = null;\n    Microsoft.Office.Interop.Excel.Worksheet XLS = null;\n\n    object MissingValue = System.Reflection.Missing.Value;\n\n    try {\n        try {\n            SPSecurity.RunWithElevatedPrivileges(delegate() {\n                XLA = new Microsoft.Office.Interop.Excel.Application();\n                XLW = XLA.Workbooks.Add(MissingValue);\n                XLS = (Microsoft.Office.Interop.Excel.Worksheet)XLW.Worksheets.get_Item(1);\n\n                XLS.Cells[1, 1] = \"Reason for error\";\n                XLS.Cells[1, 2] = \"Reference\";\n\n                XLS.get_Range(\"A1\").Font.Bold = true;\n                XLS.get_Range(\"B1\").Font.Bold = true;\n\n                int row = 2;\n                foreach (ImportError e in Errors) {\n                    XLS.Cells[row, 1] = e.Reason;\n                    XLS.Cells[row, 2] = e.Reference;\n\n                    row++;\n                }\n\n                XLW.SaveAs(ErrorLogFileName, Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookNormal,\n                    MissingValue, MissingValue, MissingValue, MissingValue,\n                    Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlExclusive, MissingValue,\n                    MissingValue, MissingValue, MissingValue, MissingValue);\n\n                XLW.Close(true, MissingValue, MissingValue);\n                XLA.Quit();\n\n                ReleaseObject(XLS);\n                ReleaseObject(XLW);\n                ReleaseObject(XLA);\n            });\n        } catch (Exception ex) {\n            Status = \"ERROR: \" + ex.ToString();\n        }\n\n        // Uploading excel file to SharePoint document library\n\n    } catch (Exception) { }\n}\n</code></pre>\n\n<p>I would really appreciate any help you can provide me in this.</p>\n"},{"tags":[".net"],"answer_count":0,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":33,"score":6,"question_id":13272323,"title":"How to completely avoid localized .NET exception messages","body":"<p>When an error occurs in my .NET applications, i get an exception message in (in my case) swedish. This is useless for most purposes because. </p>\n\n<ul>\n<li><p>The message is often just a poorly translated version of the original (english) exception message [1]</p></li>\n<li><p>Exception messages are mosly used to diagnose problems, and that usually includes googling for the error messages. This means guessing or using a web service to find the original english message. </p></li>\n</ul>\n\n<p>[1] I'm not joking. Example: \"Calling assembly\" in the context of a binding failure is completely obfuscated. It is translated to \"called assembly\" because of how english uses the same word for the one that is <em>calling</em> as for the one it <em>is calling</em>. Almost as if someone used a dictionary to translate it word by word.</p>\n\n<p>So what I want: I want to be able to get english exception messages, consistently, on a non-english windows install (I <em>do not</em> want to change the thread culture of the application). </p>\n\n<p>There is a similar question ( <a href=\"http://stackoverflow.com/questions/209133/c-sharp-exception-messages-in-english\">C# - Exception messages in English?</a> ) , but that is in the concept of logging. On that level I could just change the thread culture. </p>\n\n<p>But I want the change to be global, and include \"not my code\" exceptions as well.</p>\n\n<p>Is there any way this can be configured or \"hacked\" (e.g. by replacing resource files)?\nAm I the only person thinking that translating exception messages to begin with, is a horrible design flaw in .NET?</p>\n\n<p>I'm sorry if this was part rant and part question.</p>\n"},{"tags":[".net","wcf","web-services","wif","sts-securitytokenservice"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13177307,"title":"Validating Security Token issued by STS while calling WCF services","body":"<p>We have extended <code>SecurityTokenService</code> provided by <code>Windows Identity Foundation</code> (WIF). It issues token as expected and the SAML token is added in the SOAP header while calling every other WCF service we have.</p>\n\n<p>I can see correct values in the <code>NotBefore</code> and <code>NotOnOrAfter</code> Saml Conditions present in the security token.</p>\n\n<p>But surprisingly every call to other WCF services succeeds even when service is called after the time stamp present in <code>NotOnOrAfter</code> Saml condition that's present in the security token in the SOAP header.</p>\n\n<ol>\n<li>I do not understand why it happens. Do I need to write some code to reject the call having expired security token?</li>\n<li>Do I need to create custom binding or behavior for  it?</li>\n<li>Does not WIF or WCF take care of this basic thing automatically?</li>\n<li>Great if you could point me to some good documentation that explains things happening under the hood !</li>\n</ol>\n\n<p>I am using .NET 4.0</p>\n"},{"tags":[".net","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13269816,"title":"join more than 2 tables using SWQL(SolarWinds Query Language) when there is no common field?","body":"<p>I am monitoring my node using SolarWinds Orion NPM (network performance monitoring). And I am using Orion SDK for getting alert information from SWIS (SolarWinds informarion Service) into vb.net console application. </p>\n\n<p>I am using some vb.net code:</p>\n\n<pre><code>Function GetOneAlert(ByVal swis As InformationServiceClient) As AlertInfo\n    Dim query As String, result As XElement\n    query = \"SELECT TOP 1 A.AlertDefID, A.ActiveObject, A.ObjectType FROM Orion.AlertStatus A WHERE A.Acknowledged=0 ORDER BY A.TriggerTimeStamp DESC\"\n    result = swis.QueryXml(query)\n</code></pre>\n\n<p>The problem is, I want to get <code>alertinforamtion</code> from three tables named <code>Orion.AlertDefinitions</code>, <code>Orion.AlertStatus</code> and<code>Orion.Nodes</code> in <code>swis</code> (SolarWinds Information Service) and I need to join these 3 tables but I can able to join 2 of them (<code>Orion.AlertDefinitions</code>, <code>Orion.AlertStatus</code>) using <code>swql</code> (SolarWinds Query Language) query shown below</p>\n\n<pre><code>query = \"SELECT AlertStatus.AlertDefID, AlertDefinitions.AlertDefID, AlertDefinitions.Name, AlertStatus.State, AlertStatus.ObjectName, \nAlertStatus.TriggerTimeStamp, AlertDefinitions.Description FROM Orion.AlertStatus INNER JOIN Orion.AlertDefinitions\nON AlertStatus.AlertDefID=AlertDefinitions.AlertDefID WHERE AlertStatus.Acknowledged=0\"\n</code></pre>\n\n<p>I know the alert details but i don't know the alert belongs to which node. For this purpose i need to join \"orion.node\" table with the remaining tables. But 3rd table (<code>Orion.Nodes</code>) has no common field(s) in anyone of other two tables to join.\nI need to get three field values named as <code>DNS</code>, <code>IPAddress</code>, <code>NodeDescription</code> from <code>Orion.Nodes</code> table.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13268634,"title":"Web data scrapper without httpwebrequest in .net","body":"<p>In .net there are some .net classes which uses IE component.By them we can read htmldom and do login and data scrapping.\nKindly can any body give me the name of those classes /assemblies where it is present.I myself used it to login and data scrapping quite a way back</p>\n"},{"tags":[".net","vb.net","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13271536,"title":"How to handle DataGridView event CollectionChanged in VB.NET?","body":"<p>I want to handle the CollectionChanged event of a simple DataGridView in my winforms application.\nI can handle it with C# using the following code:</p>\n\n<pre><code>this.datagridview.DataBindings.CollectionChanged += DataBindings_CollectionChanged;\n</code></pre>\n\n<p>But how can i handle the event using VB.NET?\nI can't access the DataBindings property inside my code the following way:</p>\n\n<pre><code>Private Sub handleCollectionChanged(sender As Object, e As EventArgs) Handles datagridview.DataBinding.CollectionChanged\n    ' do something\nEnd Sub\n</code></pre>\n\n<p>I tried it with</p>\n\n<pre><code>Private WithEvents dataBinding As System.Windows.Forms.ControlBindingsCollection\nPublic Sub New()\n    InitializeComponent()\n    dataBinding = RadGridView1.DataBindings\nEnd Sub\n</code></pre>\n\n<p>but that also doens't works.</p>\n"},{"tags":["android",".net","web-services","datatable","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13271614,"title":"How to pass datatable to .Net webservice from Android","body":"<p>I am making some DB backup App, </p>\n\n<p>In which i am passing multiple rows of data to server </p>\n\n<p>so how can i send the datatable / Dataset to .Net webservice ???</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","naudio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13266904,"title":"NAudio WaveOut Device ID","body":"<p>I need select waveout device, to play sound. But I cant do that. </p>\n\n<pre><code>void Initialize()\n{\n_WaveOut = new WaveOut();\nvar reader = new WaveFileReader(FileName);\n_WaveOut.Init(new WaveChannel32(reader));\n}\n</code></pre>\n\n<p>This function starts, then the form start. After this on my form, I select waveout device with combobox. Combobox is filles with this code:</p>\n\n<pre><code>for (int i = 0; i &lt; WaveOut.DeviceCount; i++)\n{\n     WaveOutCapabilities WOC = WaveOut.GetCapabilities(i);\n     comboBox2.Items.Add(WOC.ProductName);\n\n}\n</code></pre>\n\n<p>After this, I select my device.</p>\n\n<pre><code>int WaveOutDeviceId = comboBox2.SelectedIndex;\n</code></pre>\n\n<p>And start Play function:</p>\n\n<pre><code>void Play()\n{\n_WaveOut.DeviceNumber = WaveOutDeviceId;\n_WaveOut.Play();\n}\n</code></pre>\n\n<p>But my sound always play on default device (With number = 0). If I do this for microphone, this code works correctly.</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":23,"score":1,"question_id":13271673,"title":"install voice for C# SpeechSynthesizer class","body":"<p>How can I add voice for <code>SpeechSynthesizer</code> to use for \"text to speech\" in C#</p>\n"},{"tags":["c#",".net","visual-studio-2010","unit-testing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":534,"score":1,"question_id":8921064,"title":"Unit test project not building from build server","body":"<p>My VS2010 solution has a test project in it.  The unit tests themselves reference the following namespace:</p>\n\n<pre><code>using Microsoft.VisualStudio.TestTools.UnitTesting;\n</code></pre>\n\n<p>which is accessed via the following assembly on my PC:</p>\n\n<pre><code>Assembly Microsoft.VisualStudio.QualityTools.UnitTestFramework\n    C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\\n    PublicAssemblies\\Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll\n</code></pre>\n\n<p>When I build the solution on my PC I have no issues; the tests will build and run okay.</p>\n\n<p>We have an intranet page which we can use to kick off builds on a build server.  When I build via this page, the build fails with the following errors:</p>\n\n<pre><code>Generator.cs(3,17): error CS0234: The type or namespace name 'VisualStudio' \ndoes not exist in the namespace 'Microsoft' (are you missing an assembly\nreference?)\n</code></pre>\n\n<p>The obvious problem would be that the <code>Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll</code> mentioned above is not present on the build server.  I thought this was would be installed with VS2010, and since the projects in my solution build .NET 4.0 targets, I would expect this to be installed on the build server.</p>\n\n<p>What is the easiest way to resolve this?  The build server is out of my jurisdiction and I don't particular want to log a job to get new libraries installed on to it.</p>\n"},{"tags":[".net","orm","petapoco","micro-orm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13224925,"title":"Petapoco - Can't auto join","body":"<p>I have an object call Country and another call CounytryRegions as express below </p>\n\n<pre><code>[TableName(\"Countries\"),\nPrimaryKey(\"Code\", autoIncrement = false)]\npublic class Country\n{\n    public Country()\n    {\n        this.CountryRegions = new List&lt;CountryRegion&gt;();\n    }\n\n    public string Code { get; set; }\n    public string Name { get; set; }\n\n    [Foliaco.DataAccess.ResultColumn()]\n    public List&lt;CountryRegion&gt; CountryRegions { get; set; }\n\n}\n\n[TableName(\"CountryRegions\"),\nPrimaryKey(\"Code\", autoIncrement = false)]\npublic class CountryRegion \n{\n    public CountryRegion()\n    {\n        this.Country = new Country();\n    }\n\n    public string Code { get; set; }\n    public string Name { get; set; }\n\n    public string CountryCode { get; set; }\n\n    [Foliaco.DataAccess.ResultColumn()]\n    public Country Country { get; set; }\n\n}\n</code></pre>\n\n<p>If I execute the sql below </p>\n\n<pre><code> Country country = this.DB.Fetch&lt;Country,CountryRegion&gt;(\"select * from dbo.countries c join dbo.countryregions cr on c.Code = cr.CountryCode where c.Code = @0\",\"US\").FirstOrDefault();\n</code></pre>\n\n<p>I'm expecting to get on the CountryRegions property of the Country class all the associated records to that country, but instead I getting the get following Error</p>\n\n<p>Can't auto join CountryRegion</p>\n\n<p>Thanks for the help</p>\n"},{"tags":["c#",".net","sorting","string-comparison","bug"],"answer_count":1,"favorite_count":8,"up_vote_count":21,"down_vote_count":0,"view_count":249,"score":21,"question_id":13254153,"title":"Bug in the string comparing of the .NET Framework","body":"<p>It's a requirement for any <a href=\"http://en.wikipedia.org/wiki/Comparison_sort\" rel=\"nofollow\">comparison sort</a> to work that the underlying order operator is <a href=\"http://en.wikipedia.org/wiki/Partially_ordered_set\" rel=\"nofollow\"><em>transitive</em> and <em>antisymmetric</em></a>.</p>\n\n<p>In .NET, that's not true for some strings:</p>\n\n<pre><code>static void CompareBug()\n{\n  string x = \"\\u002D\\u30A2\";  // or just \"-ア\" if charset allows\n  string y = \"\\u3042\";        // or just \"あ\" if charset allows\n\n  Console.WriteLine(x.CompareTo(y));  // positive one\n  Console.WriteLine(y.CompareTo(x));  // positive one\n  Console.WriteLine(StringComparer.InvariantCulture.Compare(x, y));  // positive one\n  Console.WriteLine(StringComparer.InvariantCulture.Compare(y, x));  // positive one\n\n  var ja = StringComparer.Create(new CultureInfo(\"ja-JP\", false), false);\n  Console.WriteLine(ja.Compare(x, y));  // positive one\n  Console.WriteLine(ja.Compare(y, x));  // positive one\n}\n</code></pre>\n\n<p>You see that <code>x</code> is strictly greater than <code>y</code>, and <code>y</code> is strictly greater than <code>x</code>.</p>\n\n<p>Because <code>x.CompareTo(x)</code> and so on all give zero (<code>0</code>), it is clear that this is not an order. Not surprisingly, I get unpredictable results when I <code>Sort</code> arrays or lists containing strings like <code>x</code> and <code>y</code>. Though I haven't tested this, I'm sure <code>SortedDictionary&lt;string, WhatEver&gt;</code> will have problems keeping itself in sorted order and/or locating items if strings like <code>x</code> and <code>y</code> are used for keys.</p>\n\n<p><strong>Is this bug well-known?</strong> What versions of the framework are affected (I'm trying this with .NET 4.0)?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Here's an example where the sign is negative either way:</p>\n\n<pre><code>x = \"\\u4E00\\u30A0\";         // equiv: \"一゠\"\ny = \"\\u4E00\\u002D\\u0041\";   // equiv: \"一-A\"\n</code></pre>\n"},{"tags":["c#",".net","shopify","hmac","sha256"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13254907,"title":"How can I create a matching HMAC value to verify a Shopify WebHook in .NET?","body":"<p>I have set up an endpoint to receive webhook requests from Shopify.</p>\n\n<p>The requests from Shopify include an HMAC header that is created from a shared secret key and the body of the request.</p>\n\n<p>I need to calculate the HMAC on my server and match it to the value in the request header to ensure that the request is authentic.</p>\n\n<p>I can't seem to create the appropriate mechanism in .NET to create a matching HMAC value.</p>\n\n<p>My algorithm at this point is as follows:</p>\n\n<pre><code>public static string CreateHash(string data)\n    {\n        string sharedSecretKey = \"MY_KEY\";\n\n        byte[] keyBytes = Encoding.UTF8.GetBytes(sharedSecretKey);\n        byte[] dataBytes = Encoding.UTF8.GetBytes(data);\n\n        //use the SHA256Managed Class to compute the hash\n        System.Security.Cryptography.HMACSHA256 hmac = new HMACSHA256(keyBytes);\n        byte[] hmacBytes = hmac.ComputeHash(dataBytes);\n\n        //retun as base64 string. Compared with the signature passed in the header of the post request from Shopify. If they match, the call is verified.\n        return System.Convert.ToBase64String(hmacBytes);\n    }\n</code></pre>\n\n<p>The Shopify docs for verifying their webhooks can be found <a href=\"http://wiki.shopify.com/Verifying_Webhooks\" rel=\"nofollow\">HERE</a> but only PHP and Ruby samples are included.</p>\n\n<p>Can anyone see what I might be doing wrong? Should I be just passing the entire JSON request body as a string into this method?</p>\n"},{"tags":[".net","mocking",".net-client-profile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13269498,"title":"Is there a mocking framework that works with the .NET Client Profile?","body":"<p>I have a somewhat exotic use case for a mocking framework. I would like to generate stub objects to be used by the WinForms designer in my client application. The point is to enable dependency injection using a static service locator, while retaining drag-and-drop designer functionality.</p>\n\n<p>Unfortunately, all of the mocking frameworks I've tried require me to switch my application to use the full .NET framework profile. </p>\n\n<p>I'm wondering if there's any that work with the Client Profile. Something tells me that there might not be any - is there any inherent limitation to the Client Profile that makes it impossible to generate classes?</p>\n"},{"tags":["c#",".net","matlab","process","filesystemwatcher"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":845,"score":1,"question_id":1115028,"title":"How to use command line Matlab from .NET without linking?","body":"<p>I finally discovered a way to use command line Matlab from .NET without linking:</p>\n\n<ol>\n<li><p>Write variables from .NET to a MAT file using David A. Zier's \"csmatio\" dll.</p></li>\n<li><p>Read the file from Matlab, process it and save the results to a MAT file:</p>\n\n<pre><code>var process = new Process()\n{\n    StartInfo = new ProcessStartInfo()\n    {\n        FileName = MatlabExecutableFileName,\n        Arguments = \"-nodisplay \" + \n           \"-nojvm \" +\n           \" -r \\\"somecommands; \" + \n           \"save FILENAME OUTPUTVARIABLES; \" +\n           \"exit;\\\"\"\n    }\n};\nprocess.Start();\n</code></pre></li>\n<li><p><strong>The worst part:</strong> Wait until the process finishes. </p>\n\n<p>The naive approach:</p>\n\n<pre><code>process.WaitForExit();\n</code></pre>\n\n<p>Doesn't work because matlab spawns the main application in a new thread</p>\n\n<p>Watching for the output file for changes is tricky:</p>\n\n<pre><code>new FileSystemWatcher(MatlabPath, fileName)\n    .WaitForChanged(WatcherChangeTypes.All)\n</code></pre>\n\n<p>Was not working because of a bug on this class.</p>\n\n<p>The currently working code is longer:</p>\n\n<pre><code>using (var watcher = new FileSystemWatcher(MatlabPath, fileName))\n{\n    var wait = new EventWaitHandle(false, EventResetMode.AutoReset);\n    watcher.EnableRaisingEvents = true;\n    watcher.Changed += delegate(object sender, FileSystemEventArgs e)\n    {\n       wait.Set();\n    };\n    foreach(var i in Enumerable.Range(0, 2))\n    {\n        if (!wait.WaitOne(MillissecondsTimeout))\n        {\n            throw new TimeoutException();\n        }\n    }\n    Thread.Sleep(1000);\n}\n</code></pre>\n\n<p>But I am concerned about the last line of code. The code block above was written with the intent of avoiding it, but I don't know what else to do. This amount of time will be too much on some computers and too little on others.</p></li>\n</ol>\n\n<p><strong>SOLUTION</strong></p>\n\n<pre><code>var previousProcesses = Process\n    .GetProcessesByName(\"Matlab\")\n    .Select(a =&gt; a.Id)\n    .ToArray();\nprocess.Start();\nprocess.WaitForExit();\nvar currentProcess = Process\n    .GetProcessesByName(\"Matlab\")\n    .Where(a =&gt; !previousProcesses.Contains(a.Id))\n    .First();\ncurrentProcess.WaitForExit();\n</code></pre>\n"},{"tags":[".net","apache","http-headers","webclient","http-status-code-403"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1349,"score":1,"question_id":2316111,"title":"System.Net.WebClient request gets 403 Forbidden but browsers do not with Apache servers","body":"<p>An odd one, I'm trying to read the &lt;Head&gt; section of a lot of different websites out there, and one particular type of server, Apache, sometimes gives the code 403 forbidden. Not all apache servers do this, so it may be a config setting or a particular version of the server.</p>\n\n<p>When I then check the url with a web browser (Firefox, for example) the page loads fine.  The code sorta looks like this:</p>\n\n<pre><code>var client = new WebClient();\nvar stream = client.OpenRead(new Uri(\"http://en.wikipedia.org/wiki/Barack_Obama\"));\n</code></pre>\n\n<p>Normally, a 403 is a access permission failed sort of thing, but these are normally unsecure pages.  I'm thinking that Apache is filtering on something in the request headers since I'm not bothering to create any. </p>\n\n<p>Maybe someone who knows more about Apache can give me some ideas of what's missing in the headers.  I'd like to keep the headers as small as possible to minimize bandwidth.  </p>\n\n<p>Thanks </p>\n"},{"tags":["c#",".net","compact-framework","windows-ce"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":526,"score":1,"question_id":7252606,"title":"Changing TimeZone does not reflect change in Time in .NET Compact Framework","body":"<p>I am working on .Net Compact Frmework(CF) application. I this application the requirement is that I should be able to change the TimeZone. However, when I changed the TimeZone the current time does not changed to that particular TimeZone. From, web I came to know that DateTime.Now can not work in this case.</p>\n\n<p>I am using following Win API:</p>\n\n<ol>\n<li><code>SetTimeZoneInformation(...)</code> - To set the time zone at Runtime.</li>\n<li><code>GetLocalTime(...)</code> - To get the Local time w.r.t current time\nzone.</li>\n</ol>\n\n<p>Can anybody tell me what might be wrong?</p>\n"},{"tags":["c#",".net","expression"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":50,"score":5,"question_id":13270230,"title":"How to convert a string into a BinaryExpression object?","body":"<p>Say we have strings like:</p>\n\n<pre><code>string s1 = \"a &lt; 5\";\nstring s2 = \"b &gt;= 7\";\nstring s3 = \"c &lt;= 8\";\n...\n</code></pre>\n\n<p>I want to convert such strings into BinaryExpression objects similar to what we get by using:</p>\n\n<pre><code>  BinaryExpression b1 = Expression.MakeBinary( ExpressionType.LessThan, Expression.Parameter( typeof( int ), \"a\" ), Expression.Constant( 5, typeof( int ) ) );\n  BinaryExpression b2 = Expression.MakeBinary( ExpressionType.GreaterThanOrEqual, Expression.Parameter( typeof( int ), \"b\" ), Expression.Constant( 7, typeof( int ) ) );\n  BinaryExpression b3 = Expression.MakeBinary( ExpressionType.LessThanOrEqual, Expression.Parameter( typeof( int ), \"c\" ), Expression.Constant( 8, typeof( int ) ) );\n</code></pre>\n\n<p>I have created the method below:</p>\n\n<pre><code>BinaryExpression ConvertStringToBinaryExpression( string exp )\n{\n  string[] s = exp.Split( ' ' );\n  string param = s[ 0 ];\n  string comparison = s[ 1 ];\n  int constant = int.Parse( s[ 2 ] );\n  if ( comparison == \"&lt;\" )\n    return Expression.MakeBinary( ExpressionType.LessThan, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&lt;=\" )\n    return Expression.MakeBinary( ExpressionType.LessThanOrEqual, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&gt;\" )\n    return Expression.MakeBinary( ExpressionType.GreaterThan, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else if ( comparison == \"&gt;=\" )\n    return Expression.MakeBinary( ExpressionType.GreaterThanOrEqual, Expression.Parameter( typeof ( int ), param ), Expression.Constant( constant, typeof ( int ) ) );\n  else\n    throw new ArgumentException( \"Invalid expression.\", \"exp\" );\n}\n</code></pre>\n\n<p>However, the above method does not work properly if, for example, we have strings like:</p>\n\n<pre><code>string s4 = \"a&lt; 5\"  // no space between 'a' and '&lt;'\nstring s5 = \"b&gt;=9\"  // no space at all\nstring s6 = \"c &lt;=7\"  // no space betwen '&lt;=' and '7'\n</code></pre>\n\n<p>What is the easiest way to make it more robust and reliable?</p>\n"},{"tags":[".net","exception-handling","asp.net-web-api","task-parallel-library"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13269267,"title":"How to translate exceptions from Tasks returned by asynchronous ASP.NET Web API methods?","body":"<p>When Tasks returned by (asynchronous) ASP.NET Web API controller methods throw exceptions, I would like to translate known exceptions to <code>HttpResponseException</code>. Is there some way to intercept these exceptions, and throw <code>HttpResponseException</code> instead?</p>\n\n<p>The following code snippet should demonstrate the type of asynchronous API controller method I'm talking about.</p>\n\n<pre><code>class ObjectApiController : ApiController\n{\n    public Task&lt;Object&gt; GetObjectByIdAsync(string id)\n    [...]\n}\n</code></pre>\n\n<p>Let me know if I need to provide more information about what I'm trying to do.</p>\n\n<p><strong>EDIT:</strong>\nSpecifically I'd like to know if there's some kind of hook with which I can intercept exceptions from Tasks returned by ApiController methods, and translate said exceptions to HttpResponseException.</p>\n"},{"tags":[".net","winrt","x509","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13270988,"title":"How do I create a self-signed certificate in a WinRT application?","body":"<p>I'm trying to write a WinRT application which communicates with Windows Azure's management APIs. In order to do this, a certificate has to be uploaded which meets certain requirements and is then used by the application to authenticate requests.</p>\n\n<p>To make for a better user experience, I want to be able to generate the certificate for them and configure the application to use the certificate. Normally, I would reach for the <code>System.Security.Cryptography</code> namespace, but it would appear to be unavailable from the \".NET for Windows Store app\" subset of the full framework.</p>\n\n<p>Any ideas how I could go about creating this self-signed certificate without calling out to an external service?</p>\n"},{"tags":["c#","javascript",".net","asp.net","json"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":1484,"score":0,"question_id":7559676,"title":"How to correctly deserialize a JSON string into the class that contains a nested List of another class","body":"<p>I have the following object graph and I'm using Jquery's $.Ajax() to send this identical \"View\" object in JSON (stringified) from the browser to a Page Method on ASP.Net. The JAvascript deserialization works for all of the strings and int's in the View class but My <code>List&lt;DataItem&gt;</code> is empty. </p>\n\n<p>What I tried: Using chrome dev tools, I took the stringified JSON, created a unit test and used both the <code>DataContractJsonSerializer</code> and the <code>JavaScriptSerializer</code>. The <code>DataContractJsonSerializer</code> object deserialized my object graph correctly but the <code>JavaScriptSerializer</code> dumped my List. How can I get the correct deserialization on my page method ?</p>\n\n<pre><code>public class View\n{\n    public string Text { get; set; }\n    public string AnotherText { get; set; }\n    public Int SomeInt { get; set; }\n    public List&lt;DataItem&gt; { get; set; }\n}\n\npublic class DataItem\n{\n    public Person person {get;set}\n}\n\npublic class Person\n{\n    public int Age {get;set}\n}\n\n   var dataa = {mqvm: mqvmJSON };\n    $.ajax({\n        type: \"POST\",\n        dataType: \"json\",\n        contentType: \"application/json; charset=utf-8\",\n        data: JSON.stringify( dataa ),\n        url: \"GoHere.aspx/WebMethodName\",\n        success: function(data) {\n            alert(data.d);\n        },\n        error: function(jqXHR, textStatus, errorThrown) {\n            alert(jqXHR.responseText + ' ' + errorThrown);\n        }\n    });\n</code></pre>\n\n<p>Instead of this (the view obj as a param).</p>\n\n<pre><code>    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n    [WebMethod]\n    public static string CreateResponseReview(View mqvm)\n    { \n        return \"Success\";\n    }\n</code></pre>\n\n<p>how can I get this? (the string param)</p>\n\n<pre><code>    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n    [WebMethod]\n    public static string CreateResponseReview(string mqvm)\n    { \n        //do manual JSON deserialization here.\n\n        return \"Success\";\n    }\n</code></pre>\n\n<p>My JSON looks like this.</p>\n\n<pre><code>    {\n    \"Text\": \"6\",\n    \"AnotherText\":\"wow\"\n    \"SomeInt\": 5,\n    \"DataItem\":[\n        {\n            \"person\":{\n                \"Age\":23\n            }\n        },\n        {\n            \"person\":{\n                \"Age\":42\n            }\n        }\n    ]\n}\n</code></pre>\n"},{"tags":["c#",".net","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13253315,"title":"Entity Framework does not generate association property","body":"<p>So.</p>\n\n<p>I'm having trouble fixing this little problem.</p>\n\n<p>I have several classes, and it's all nice and good. Right up until now. I have now added another class (MatchResult), and it works. \n<img src=\"http://i.stack.imgur.com/QYrFi.png\" alt=\"Before\"></p>\n\n<p>But when I try to make the correct association: </p>\n\n<p><img src=\"http://i.stack.imgur.com/ojGaq.png\" alt=\"enter image description here\"></p>\n\n<p>It fails with a runtime exception.</p>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Schema specified is not valid. Errors: </p>\n  \n  <p>The relationship 'DbModel.FK_ProductPrice' was not loaded\n  because the type 'DbModel.Product' is not available.</p>\n  \n  <p>The following information may be useful in resolving the previous\n  error:</p>\n  \n  <p>The required property 'MatchResults' does not exist on the type\n  'PriceMonitor.Model.Product'.</p>\n  \n  <p>The relationship 'DbModel.FK_WebshopProduct' was not loaded\n  because the type 'DbModel.Product' is not available.</p>\n  \n  <p>The following information may be useful in resolving the previous\n  error:</p>\n  \n  <p>The required property 'MatchResults' does not exist on the type\n  'PriceMonitor.Model.Product'.</p>\n</blockquote>\n\n<p>It seems - for some reason - that EF does not create the MatchResults property on the Product class.</p>\n\n<p>This approach has worked on every single class I've ever made using EF. Up until now.</p>\n"},{"tags":["c#",".net","windows","vb.net","networking"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":8560,"score":2,"question_id":5570004,"title":"How to change LAN Settings (proxy configuration) programmatically","body":"<p>I am writing a program to automatically switch my proxy address based on the network I am connected to.</p>\n\n<p>I have so far got everything to work except the part that I have highlighted below.  </p>\n\n<p><img src=\"http://imgur.com/FZFS8.png\" alt=\"LAN Settings Dialog\"></p>\n\n<p>Is there any way to change the automatic configuration script and the automatically detect settings in code?</p>\n\n<p>The solution can be either P/Invoke registry editing. I just need something that works.</p>\n"},{"tags":["c#",".net","drivers","umdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":11924740,"title":"UMDF Development in .NET","body":"<p>Does anyone know if the current state of Microsoft's UMDF allows for driver development in .NET?</p>\n"},{"tags":[".net","c#-4.0","charts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13270716,"title":"Trigger PIE Chart Click Event","body":"<p>I am working in .Net PIE Charts. In that, when i click a piece in the PIE, i need the show another chart. For that i am trying to raise the click event of the chart. </p>\n\n<pre><code>&lt;asp:Chart ID=\"Chart1\" runat=\"server\" Width=\"1300px\" Height=\"530px\" OnCustomize=\"Chart1_Customize\" OnClick=\"Chart1_Click\"&gt;\n                &lt;Titles&gt;\n                &lt;/Titles&gt;\n                &lt;Series&gt;\n                    &lt;asp:Series Name=\"Series1\" PostBackValue=\"#VALX\"&gt;\n                    &lt;/asp:Series&gt;\n                &lt;/Series&gt;\n                &lt;ChartAreas&gt;\n                    &lt;asp:ChartArea Name=\"ChartArea1\" BackColor=\"Transparent\" BorderWidth=\"0\"&gt;\n                        &lt;AxisX LineWidth=\"0\" IsMarginVisible=\"false\"&gt;\n                        &lt;/AxisX&gt;\n                        &lt;Position Height=\"80\" Width=\"100\" X=\"0\" Y=\"6\" /&gt;\n                    &lt;/asp:ChartArea&gt;\n                &lt;/ChartAreas&gt;\n            &lt;/asp:Chart&gt;\n</code></pre>\n\n<p>Code Behind...</p>\n\n<pre><code>    private void Chart1_Click(object sender, System.Web.UI.WebControls.ImageMapEventArgs e)\n    {\n        string dd = e.PostBackValue;\n    }\n</code></pre>\n\n<p>But i am getting the error like this..</p>\n\n<pre><code> 'ASP.analytics_chartviewrollupnew_aspx' does not contain a definition for 'Chart1_Click' and no extension method 'Chart1_Click' accepting a first argument of type 'ASP.analytics_chartviewrollupnew_aspx' could be found (are you missing a using directive or an assembly reference?)\n</code></pre>\n\n<p>Whether i need to add anything special for click event in web.config.?</p>\n"},{"tags":[".net","com","umdf"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":347,"score":5,"question_id":3483452,"title":"Is it worth to learn COM?","body":"<p>I am thinking to learn COM.But I heard that Microsoft launched .NET as an alternative to COM.\nSo is it worth to learn COM?\nactually I started learning COM for UMDF device driver.\nIs there any alternate way to work on UMDF except COM?</p>\n"},{"tags":["c#",".net","drawing","system.drawing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13269145,"title":"Get System.Drawing.Font width?","body":"<p>I'm using .Net tools to do some 2D drawing. <code>System.Drawing.Font</code> uses a <code>GetHeight()</code> that returns the height in pixels. I'm missing a <code>GetWidth()</code> to retrieve the width! What should I use?</p>\n"},{"tags":["c#",".net","wpf","serialization","application-settings"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":492,"score":2,"question_id":6309026,"title":"ApplicationSettingsBase writes empty tag for custom collection","body":"<p>I have been fighting with this off and on for several days now.  I need to store a collection of custom objects as part of the user's settings.  Based on lots of google work it seems that building a preferences class off of <code>ApplicationSettingsBase</code> is an appropriate way to do so.  The problem I run into is as soon as I try to store a collection of a custom type no data gets saved for that property.  If I keep to collections of base types, such as string, things work.  I have a separate proof of concept project I have been working with for the past day to isolate down to just this issue.</p>\n\n<p>This project consists of a WPF window with a listbox and two buttons, “+” and “-“.  I have a Prefs class with three properties defining different types of collections.  In my window code I bind the listbox to one of these lists and the buttons either add or remove an item to/from the list.  Closing the window should save the contents of the list to the users.config file for the current user.  Reopening it should display the saved contents of the list.</p>\n\n<p>If I use List1 (<code>ObservableCollection&lt;string&gt;</code>) and click the + button a few times then close the window the data is correctly saved to user.config.  However if I change and use List2(<code>ObservableCollection&lt;Foo&gt;</code>) or List3(<code>FooCollection</code>) I just end up with an empty value tag.  I have tried to implement <code>ISerializable</code> and <code>IXmlSerializable</code> in attempts to get this working with no change in behavior.  In fact running in debug mode with break points shows that the collection contains data when the save method is called but the serialization interface methods are never being called.</p>\n\n<p>What am I missing?  </p>\n\n<p>UPDATE: I have changed my approach and written the data off to another file alongside of user.config for the time being so that I can make some progress on other portions of the app.  But I would still like to know why application settings base was failing to record my collection data.</p>\n\n<p>Here is all of the relevent code, if someone thinks an ommitted section is important I will add it back into the post.</p>\n\n<p>user.config after adding a couple of elements to each list property</p>\n\n<pre><code>&lt;setting name=\"List1\" serializeAs=\"Xml\"&gt;\n    &lt;value&gt;\n        &lt;ArrayOfString xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n            xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n            &lt;string&gt;0&lt;/string&gt;\n            &lt;string&gt;1&lt;/string&gt;\n            &lt;string&gt;2&lt;/string&gt;\n        &lt;/ArrayOfString&gt;\n    &lt;/value&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List2\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n&lt;setting name=\"List3\" serializeAs=\"Xml\"&gt;\n    &lt;value /&gt;\n&lt;/setting&gt;\n</code></pre>\n\n<p>Window XAML</p>\n\n<pre><code>&lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;ListBox Name=\"l1\" Grid.Column=\"0\" Grid.Row=\"0\" ItemsSource=\"{Binding}\"&gt;&lt;/ListBox&gt;\n    &lt;StackPanel Grid.Column=\"1\" Grid.Row=\"0\"&gt;\n        &lt;Button Name=\"bP\" Margin=\"5\" Padding=\"5\" Click=\"bP_Click\"&gt;+&lt;/Button&gt;\n        &lt;Button Name=\"bM\" Margin=\"5\" Padding=\"5\" Click=\"bM_Click\"&gt;-&lt;/Button&gt;\n    &lt;/StackPanel&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Code Behind for Window</p>\n\n<pre><code>public partial class Window1 : Window\n{\n    Prefs Prefs = new Prefs();\n\n    public Window1()\n    {\n        InitializeComponent();\n\n        //l1.DataContext = Prefs.List1;\n        //l1.DataContext = Prefs.List2;\n        l1.DataContext = Prefs.List3;\n    }\n\n    private void Window_Closed(object sender, EventArgs e)\n    {\n        Prefs.Save();\n    }\n\n    private void bP_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.Add(Prefs.List1.Count.ToString());\n        //Prefs.List2.Add(new Foo(Prefs.List2.Count.ToString()));\n        Prefs.List3.Add(new Foo(Prefs.List3.Count.ToString()));\n    }\n\n    private void bM_Click(object sender, RoutedEventArgs e)\n    {\n        //Prefs.List1.RemoveAt(Prefs.List1.Count - 1);\n        //Prefs.List2.RemoveAt(Prefs.List2.Count - 1);\n        Prefs.List3.RemoveAt(Prefs.List3.Count - 1);\n    }\n}\n</code></pre>\n\n<p>Prefs class</p>\n\n<pre><code>class Prefs : ApplicationSettingsBase\n{\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;string&gt; List1\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;string&gt; Value = this[\"List1\"] as System.Collections.ObjectModel.ObservableCollection&lt;string&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;string&gt;();\n                this[\"List1\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; List2\n    {\n        get\n        {\n            System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt; Value = this[\"List2\"] as System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;;\n            if (Value == null)\n            {\n                Value = new System.Collections.ObjectModel.ObservableCollection&lt;Foo&gt;();\n                this[\"List2\"] = Value;\n            }\n            return Value;\n        }\n    }\n\n    [UserScopedSettingAttribute()]\n    [DefaultSettingValueAttribute(null)]\n    public FooCollection List3\n    {\n        get\n        {\n            FooCollection Value = this[\"List3\"] as FooCollection;\n            if (Value == null)\n            {\n                Value = new FooCollection();\n                this[\"List3\"] = Value;\n            }\n            return Value;\n        }\n    }\n}\n</code></pre>\n\n<p>Foo Class</p>\n\n<pre><code>[Serializable()]\nclass Foo : System.ComponentModel.INotifyPropertyChanged, ISerializable, IXmlSerializable\n{\n    private string _Name;\n    private const string PropName_Name = \"Name\";\n    public string Name\n    {\n        get { return this._Name; }\n        set\n        {\n            if (value != this._Name)\n            {\n                this._Name = value;\n                RaisePropertyChanged(Foo.PropName_Name);\n            }\n        }\n    }\n    public override string ToString()\n    {\n        return Name;\n    }\n\n    public Foo() { }\n    public Foo(string name)\n    {\n        this._Name = name;\n    }\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public Foo(SerializationInfo info, StreamingContext context)\n    {\n        this._Name = (string)info.GetValue(Foo.PropName_Name, typeof(string));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(Foo.PropName_Name, this._Name);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        reader.MoveToContent();\n        _Name = reader.GetAttribute(Foo.PropName_Name);\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        writer.WriteAttributeString(Foo.PropName_Name, _Name);\n    }\n    #endregion\n}\n</code></pre>\n\n<p>and FooCollection class</p>\n\n<pre><code>[Serializable()]\nclass FooCollection : ICollection&lt;Foo&gt;, System.ComponentModel.INotifyPropertyChanged, INotifyCollectionChanged, ISerializable, IXmlSerializable\n{\n    List&lt;Foo&gt; Items;\n    private const string PropName_Items = \"Items\";\n\n    public FooCollection()\n    {\n        Items = new List&lt;Foo&gt;();\n    }\n\n    public Foo this[int index]\n    {\n/***Omitted for space***/\n    }\n\n    #region ICollection&lt;Foo&gt; Members\n/***Omitted for space***/\n    #endregion\n\n    public void RemoveAt(int index)\n    {\n/***Omitted for space***/\n    }\n\n    #region IEnumerable Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyCollectionChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region INotifyPropertyChanged Members\n/***Omitted for space***/\n    #endregion\n\n    #region ISerializable Members\n    public FooCollection(SerializationInfo info, StreamingContext context)\n    {\n        this.Items = (List&lt;Foo&gt;)info.GetValue(FooCollection.PropName_Items, typeof(List&lt;Foo&gt;));\n    }\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(FooCollection.PropName_Items, this.Items);\n    }\n    #endregion\n\n    #region IXmlSerializable Members\n    public System.Xml.Schema.XmlSchema GetSchema()\n    {\n        return null;\n    }\n\n    public void ReadXml(System.Xml.XmlReader reader)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        reader.MoveToContent();\n        bool Empty = reader.IsEmptyElement;\n        reader.ReadStartElement();\n        if (!Empty)\n        {\n            if (reader.IsStartElement(FooCollection.PropName_Items))\n            {\n                reader.ReadStartElement();\n\n                while (reader.IsStartElement(\"Foo\"))\n                {\n                    this.Items.Add((Foo)FooSerializer.Deserialize(reader));\n                }\n\n                reader.ReadEndElement();\n            }\n\n            reader.ReadEndElement();\n        }\n    }\n\n    public void WriteXml(System.Xml.XmlWriter writer)\n    {\n        XmlSerializer FooSerializer = new XmlSerializer(typeof(Foo));\n\n        writer.WriteStartElement(FooCollection.PropName_Items);\n\n        foreach (Foo Item in Items)\n        {\n            writer.WriteStartElement(\"Foo\");\n            FooSerializer.Serialize(writer, Item);\n            writer.WriteEndElement();//\"Foo\"\n        }\n\n        writer.WriteEndElement(); //FooCollection.PropName_Items\n    }\n    #endregion\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","image-processing"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":26,"score":2,"question_id":13270031,"title":"Looking for high-level Instagram/Microsoft Word like image processing library","body":"<p>Currently, I am looking for a (commercial or free) .NET/C# image processing library for a WinForms project to apply customizable effects like Instagram or Microsoft Office Word does, e.g.:</p>\n\n<p><img src=\"http://i.stack.imgur.com/tg7VY.png\" alt=\"enter image description here\"></p>\n\n<p>I found plenty of image libraries like:</p>\n\n<ul>\n<li><a href=\"http://www.imagemagick.org/script/index.php\" rel=\"nofollow\">ImageMagick</a></li>\n<li><a href=\"http://www.leadtools.com/\" rel=\"nofollow\">Lead Tools</a></li>\n<li><a href=\"http://freeimage.sourceforge.net/\" rel=\"nofollow\">Free Image</a></li>\n<li><a href=\"https://www.atalasoft.com/products/dotimage-sdk-1\" rel=\"nofollow\">DotImage</a></li>\n<li>...</li>\n</ul>\n\n<p>Unfortunately, all these libraries seem to provide a rather low-level way of manipulating images. When it comes to high-level effects like borders, rotation, vintage filters like Instagram, etc., I found zero libraries.</p>\n\n<p>(Ironically, for JavaScript, <a href=\"http://stackoverflow.com/questions/8192317/create-instagram-esque-filters-with-javascript\">there are quite a few libraries out there</a>)</p>\n\n<p>Maybe there is no market for such a library, still I would love to have this function in my application without doing everything on my own.</p>\n\n<p><strong>Therefore my question is:</strong></p>\n\n<p>Is there a .NET library available to have a customizable and extendable way of applying various high-level filters to images?</p>\n"},{"tags":["c#",".net","visual-studio-2010","silverlight",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13229923,"title":"NullReferenceException on Fresh Silverlight Project - Designer","body":"<p>I just created a new Silverlight project along side an existing web project. (Visual Studio 2010)</p>\n\n<p>The designer window is now showing \"An unhandled exception has occured\". </p>\n\n<p><strong>Note: The project has no additional code added, it has only the default code.</strong></p>\n\n<p><em>Part of the stacktrace is below.</em></p>\n\n<p>System.NullReferenceException</p>\n\n<p>Object reference not set to an instance of an object.\n     at   </p>\n\n<p>Microsoft.Windows.Design.Platform.SilverlightMetadataContext.SilverlightXamlExtensionImplementations.d__8.MoveNext()</p>\n\n<p>at MS.Internal.Design.Metadata.ReflectionProjectNode.BuildSubsumption()</p>\n\n<p>at MS.Internal.Design.Metadata.ReflectionProjectNode.SubsumingNamespace(Identifier identifier)</p>\n"},{"tags":[".net","ocr"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13066237,"title":"OmniPage Pro automation interface Version 18","body":"<p>I am looking for an cheap ocr with the abbility in using an api.\nI think the only one with an good recognition and a good price is the Pro version of Omnipage.\nYou can use the Pro version with a COM interface in .net. In the past there were the development guide on the cd. I am using the Version 18 but I cant find the documentation for this Version.</p>\n\n<p>Did anyone know where to find this documentation? Or is this only missing in the trial?</p>\n\n<p>Regards\nIngo</p>\n"},{"tags":[".net"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":495,"score":4,"question_id":6020117,"title":".NET SqlDataReader Item[] vs. GetString(GetOrdinal())?","body":"<p>Using the <code>SqlDataReader</code> class, what, if any, are the functional differences between:</p>\n\n<pre><code>(string) dataReader[\"MyFieldName\"];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>dataReader.GetString(dataReader.GetOrdinal(\"MyFieldName\"));\n</code></pre>\n"},{"tags":["c#",".net","mp3"],"answer_count":6,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":5458,"score":7,"question_id":1214040,"title":"How to get the length of a MP3 in C#","body":"<p>Yes this is an exact duplicate of <a href=\"http://stackoverflow.com/questions/1007547/finding-mp3-length-in-c\">this question</a>, but the link given and accepted as answer is not working for me. It is returning incorrect values (a 2 minutes mp3 will be listed as 1'30, 3 minutes as 2'20) with no obvious pattern.</p>\n\n<p>So here it is again: how can I get the length of a MP3 using C# ? </p>\n\n<p><em>or</em></p>\n\n<p>What am I doing wrong with the <a href=\"http://www.devhood.com/tutorials/tutorial%5Fdetails.aspx?tutorial%5Fid=79\">MP3Header class</a>:</p>\n\n<pre><code>MP3Header mp3hdr = new MP3Header();\nbool boolIsMP3 = mp3hdr.ReadMP3Information(\"1.mp3\");\nif(boolIsMP3)\n  Response.Write(mp3hdr.intLength);\n</code></pre>\n"},{"tags":["c#",".net","mp3"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":605,"score":3,"question_id":4499470,"title":"Is there a C# library that allows you to query mp3 duration and bitrate","body":"<p>I'm looking for an open source library (BSD/MIT style license) that allows me to extract the bitrate and duration of a MP3 audio file in dot net. </p>\n\n<p>Any takers?</p>\n"},{"tags":["c#",".net","directx","mp3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":266,"score":2,"question_id":11127092,"title":"How to retrieve the correct Duration of an mp3 audio file in C#/.NET/DirectX?","body":"<p>I am writing a media presentation program, and I am nearly complete, but for some reason I am getting incorrect durations of mp3 files. I use the Microsoft.DirectX.AudioVideoPlayback.Audio class to play audio files, and it works well for wav files. From google search, I can tell that it seems to be a problem when the mp3s are encoded using a variable bit rate, however I need my program to report accurately regardless of the bit rate settings of the media. Here is the code:</p>\n\n<pre><code>Media_Audio aud = (Media_Audio)item.MediaFile;\nTimeSpan total = aud.EndTime - aud.StartTime;\nif (aud.EndTime.TotalSeconds == 0)\n{\n    total = TimeSpan.FromSeconds(aud.Player.Duration)-aud.StartTime;\n}\nTimeSpan now = TimeSpan.FromSeconds(aud.Player.CurrentPosition) - aud.StartTime;\nstring nows = now.Hours.ToString() + \":\" + now.Minutes.ToString() + \":\" + now.Seconds.ToString();\nstring tots = total.Hours.ToString() + \":\" + total.Minutes.ToString() + \":\" + total.Seconds.ToString();\nitem.currentPosition.Text = nows + \"/\" + tots;\n</code></pre>\n\n<p>The key line being:</p>\n\n<pre><code>total = TimeSpan.FromSeconds(aud.Player.Duration)-aud.StartTime;\n</code></pre>\n\n<p>aud.Player is an instance of Microsoft.DirectX.AudioVideoPlayback.Audio.</p>\n\n<p>For a song that is, in fact, 5:49 seconds long, it reports 39:13 as the duration. The same length as Windows Explorer and VLC Player. Also, have the K-Lite Mega Codec pack installed. so it could be interfering. I am aware of this question: <a href=\"http://stackoverflow.com/questions/383164/how-to-retrieve-duration-of-mp3-in-net\">How to retrieve duration of MP3 in .NET?</a>\nHowever, at this stage in my program I do not have the time to switch from my current method of playing audio files to a new one, so do I have any other options to determine the duration using DirectX only? Or Will I have to resort to BASS.NET or TagLib Sharp? (And does meta-data even contain accurate information for VBR-encoded mp3s?)</p>\n"},{"tags":[".net","audio","mp3"],"answer_count":5,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":1545,"score":5,"question_id":383164,"title":"How to retrieve duration of MP3 in .NET?","body":"<p>I have build a WPF application where users can drag and drop MP3 files onto a listbox. I need a way to calculate the total duration of the playlist.</p>\n\n<p>Any libraries I should use? Or is it possible using only the .NET framework?</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13265833,"title":"How to move from directory to directory?","body":"<p>I am using <code>Directory.GetCurrentDirectory()</code> function. After I get current directory path I need to move two directories up and to get the path of this derictory to the path variable.</p>\n\n<p>Any idea how I can do that?</p>\n"},{"tags":[".net","ibm","websphere-mq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13251947,"title":"How to remove the message header informations in WebSphere MQ grouped message while receving in .Net client","body":"<p>I am trying to recevie logically grouped messages from an remote MQ using .Net client using native api [amqmdnet - WebSphere MQ Classes for .NET], which was put by java client using native api.       </p>\n\n<p>While we are getting the logically grouped messages we are seeing some header information in all the messages in that group which will be showing differently in each editors, [notepad++, editplus etc.]</p>\n\n<p>The below specified header information's is appended in every logical message in that group something like \"MDE \"</p>\n\n<p>We are using the <code>getmessageoptions</code>, <code>openoptions</code> as below,</p>\n\n<pre><code>mintMQQueueOpenOptions = IBM.WMQ.MQC.MQOO_INPUT_SHARED + IBM.WMQ.MQC.MQOO_FAIL_IF_QUIESCING\nmobjMQGetMessageOptions = New MQGetMessageOptions\nmobjMQGetMessageOptions.Options = IBM.WMQ.MQC.MQGMO_NO_SYNCPOINT +  IBM.WMQ.MQC.MQGMO_FAIL_IF_QUIESCING\n'mobjMQGetMessageOptions.Options = mobjMQGetMessageOptions.Options + MQC.MQGMO_LOGICAL_ORDER  'Or MQC.MQGMO_ALL_MSGS_AVAILABLE\n</code></pre>\n\n<p>Code snippet to read the all the logical message in that group,</p>\n\n<pre><code>            '=================================\n            ' INTANTIATE THE MQ MESSAGE OBJECT\n            objMQMessage = New MQMessage\n            objMQMessage.Format = MQC.MQFMT_STRING\n            '=================================\n            ' CLEAR THE MESSAGE VARIABLE\n            strMQMessage = \"\"\n\n            Do\n                '============================\n                ' GET THE MESSAGE FROM THE MQ\n                mobjMQQueue.Get(objMQMessage, mobjMQGetMessageOptions)\n\n                '============================\n                ' READ THROUGH THE MESSAGE\n                strMQMessage += objMQMessage.ReadString(objMQMessage.MessageLength)\n\n                '============================\n                ' SET GMO.MATCHOPTIONS TO GROUP ID, INITIALLY IT WAS SET TO \"MQC.MQMO_NONE\"                            \n                mobjMQGetMessageOptions.MatchOptions = MQC.MQMO_MATCH_GROUP_ID\n\n                '============================\n                ' DO UNTIL - MESSAGE IS THE LAST IN THE GROUP OR THE GROUP CONSISTS OF ONLY ONE MESSAGE.\n            Loop While (mobjMQGetMessageOptions.GroupStatus &lt;&gt; MQC.MQGS_LAST_MSG_IN_GROUP)\n\n            '====================================\n            ' COLLECT THE MESSAGE IN AN ARRAYLIST\n            If Not String.IsNullOrEmpty(strMQMessage) Then objMQMessageList.Add(strMQMessage)\n\n            '============================\n            ' COMMIT THE FETCH OPERATION\n            mobjMQQueueManager.Commit()\n</code></pre>\n\n<p>How we can remove this header information from each message? </p>\n"},{"tags":["c#",".net","code-contracts"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":162,"score":4,"question_id":9316847,"title":"Using Code Contracts to specify a return value may be null","body":"<p>Is there a way of explicitly specifying that a return value <em>can</em> be null using Code Contracts?</p>\n\n<p>My worry is that methods without a <code>Contract.Ensures(Contract.Result&lt;object&gt;() != null)</code> may be incorrectly 'fixed' in the future to include the post-condition, even though the original intention may have been to allow null results.</p>\n"},{"tags":["c#","asp.net",".net","ado.net"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13268287,"title":"Transactions in .net using c#","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/224689/transactions-in-net\">Transactions in .net</a>  </p>\n</blockquote>\n\n\n\n<p>I just wanted to know about Transaction in .net using c# language. I have gone through different articles on the net. However, I came to know about transaction theoretically but I wanted to know the exact use of it in real time. For example when exactly should I use transactions in real time. Let's suppose, I am writing code where I am doing some action on the click event of a link. Lets say, I am hitting the SQL connection to get some values. Should I use transaction there? If I am writing simple code, where I fetch values without using sql connection, should I use transactions there? What are the pros and cons of using Transactions. Getting theoritical knowledge is different, but I want to know the exact use of it. When to use when not to use. Can transactions be used in simple code? Any responses or links for even basic stuff about transactions are welcome.</p>\n"},{"tags":["c#",".net","encryption"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1280,"score":1,"question_id":4756046,"title":"How secure is ProtectedData.Protect (DPAPI)?","body":"<p>Suppose someone gets access all of my hard disk, I guess the weak spot would be my windows password. Without knowing/being able to retrieve that, the data should be pretty much safe, shouldn't it?</p>\n\n<p>I'm asking specifically because of the <a href=\"http://en.wikipedia.org/wiki/Encrypting_File_System#Decrypting_files_using_the_local_Administrator_account\" rel=\"nofollow\">EFS entry</a> in wikipedia which states that</p>\n\n<blockquote>\n  <p>In Windows 2000, the local administrator is the default Data Recovery Agent, capable of decrypting all files encrypted with EFS by any local user.</p>\n</blockquote>\n\n<p>and EFS happens to use DPAPI. So does the same apply to my own data protected using this:</p>\n\n<pre><code>ProtectedData.Protect(plain, null, DataProtectionScope.CurrentUser);\n</code></pre>\n\n<p>And if that is indeed the case, how could I prevent it?</p>\n\n<p><strong>[Edit]</strong> N.B. I'm trying to store credentials for a winforms app so that the user does not have to enter their password every time they login. In other words, if someone is able to login as that user (i.e. know the user password), then they might as well be able read the encrypted data.</p>\n\n<p>Which - not coming from a windows background - now makes me wonder - can't the local admin login as any local user anyway? In that case I shouldn't be concerned about the admin being able to retrieve passwords anyway...</p>\n\n<p><strong>[Edit2]</strong> As google reveals, it looks like an Administrator <strong>cannot</strong> just login as any user without resetting/changing their password first. So my question still seems relevant...</p>\n"},{"tags":["c#",".net","static","webclient","void"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13268529,"title":"C# How to transfer reference void within main void","body":"<p>This is likely to be a(nother) noob question, but I'm not sure how to do this.</p>\n\n<p>I have piece of code within a private method which refers to a static method.</p>\n\n<pre><code>using (WebClient wc = new WebClient())\n{\n    wc.DownloadStringCompleted += new DownloadStringCompletedEventHandler(wc_DownloadStringCompleted);\n    wc.DownloadStringAsync(new Uri(requestUri));\n}\n</code></pre>\n\n<p>The static method it refers to:</p>\n\n<pre><code>static void wc_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)\n{\n\n    var xmlElm = XElement.Parse(e.Result);\n\n    var status = (from elm in xmlElm.Descendants()\n                  where elm.Name == \"status\"\n                  select elm).FirstOrDefault();\n    if (status.Value.ToLower() == \"ok\")\n    {\n        var res = (from elm in xmlElm.Descendants()\n                   where elm.Name == \"formatted_address\"\n                   select elm).FirstOrDefault();\n        formatted = res.Value;\n\n    }          \n}\n</code></pre>\n\n<p>Now I need the content of the static method to replace the content of the WebClient. \nLike:</p>\n\n<pre><code>using (WebClient wc = new WebClient())\n{\n    var xmlElm = XElement.Parse(e.Result);\n\n    var status = (from elm in xmlElm.Descendants()\n                  where elm.Name == \"status\"\n                  select elm).FirstOrDefault();\n    if (status.Value.ToLower() == \"ok\")\n    {\n        var res = (from elm in xmlElm.Descendants()\n                   where elm.Name == \"formatted_address\"\n                   select elm).FirstOrDefault();\n        formatted = res.Value;\n\n    }\n}\n</code></pre>\n\n<p>Since I'm not sure where \"e\" originates from, I do not know how to get it working.</p>\n"},{"tags":[".net","design-patterns","dependency-injection","inversion-of-control","ioc-container"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13235154,"title":"Is IoC typically implemented as a singleton? How is IoC implemented?","body":"<p>I plan on digging into one of the open source IoC containers to really figure this out 100%, but I figured I would ask the general community also (after not being able to find a direct answer in any of the closely related questions). </p>\n\n<p>As far as I understand the typical IoC implementation, it seems that it is a global class that acts as a singleton with a knowledge of all dependencies. It then uses that knowledge to supply constructor or property  parameters where it knows how to fill them in? Maybe I am missing something, thus the question. </p>\n\n<p>Can somebody definitively tell me how IoC works and/or if it is a singleton at its root?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I guess my question would be how do \"magic\" IoC things work like Ninject.MVC? Where the injection \"just works\"?</p>\n"},{"tags":["c#",".net","winforms","usercontrols","flowlayoutpanel"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":26,"score":5,"question_id":13265635,"title":"insert Usercontrol in FlowLayoutPanel","body":"<p>I have a <code>FlowLayoutPanel</code> and several <code>UserControl</code>s. Now I want one controll to be always at the bottom of my <code>FlowLayoutPanel</code>. So I want to add my UserControl just above the lowest controll. Is there an easy way to insert user controls in a <code>FlowLayoutPanel</code>?</p>\n\n<p>I'm currently thinking about removing the control at the bottom, and adding the control I want to add and  add the bottom control again. But this I do not think this is really the best way. Is there anyone here who could help me with some information on how to do this ?</p>\n"},{"tags":["c#",".net","asp.net-mvc","razor"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":38,"score":2,"question_id":13268203,"title":"Can we do the DBContext in MVC3 with Razor?","body":"<p>Can I connect to the DB using <code>DBContext</code> in MVC3 by defining the <code>ConnectionString</code> in Web.config?</p>\n\n<p>If possible can anyone provide me some links too?</p>\n"},{"tags":[".net","wpf","winforms","telerik","windowsformshost"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13196454,"title":"Telerik RadPanorama control in a WindowsFormsHost control","body":"<p>I am building a WPF app where I work and I want to use the RadPanorama for the Start Screen or \"Launching Pad\" for the App.  I understand, and have seen the numerous threads, that there is no RadPanorama for WPF.  </p>\n\n<p>However, is there any reason I cannot embed one in a WindowsFormsHost?  </p>\n\n<p>Seems to work after a VERY quick little test but I am wondering if anyone has any feedback on doing it this way?  Somethings are very 'messy' to get at with out the Design Time support.  Is there a way around that? </p>\n"},{"tags":["c#",".net","delegates","event-handling","event-bubbling"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13268251,"title":"How to bubble an event up multiple levels?","body":"<p>I'm struggling to bubble an event correctly.</p>\n\n<p>I have a master page with a user control, and a page that is a child of the master page.</p>\n\n<p>The user control and the page share common data, so when the user control updates, it updates the apage and vice versa.</p>\n\n<p>The user control exposed an event to the master page. This is the format I use.</p>\n\n<p>outside of class:</p>\n\n<pre><code>public delegate void OfferBookmarkRemoved(int OfferID);\n</code></pre>\n\n<p>inside class:</p>\n\n<pre><code>public event OfferBookmarkRemoved OfferBookmarkRemoved;\n\nprotected void LV_Bookmarks_ItemCommand(object source, ListViewCommandEventArgs e)\n{\n    if (e.CommandName == \"RemoveOffer\")\n    {\n        var offerId = (int)e.CommandArgument;\n\n        OnOfferBookmarkRemoved(offerId);\n    }\n\n}\n\nvoid OnOfferBookmarkRemoved(int offerId)\n{\n    offerId.ThrowDefault(\"offerId\");\n\n    if (OfferBookmarkRemoved != null)\n    {\n        OfferBookmarkRemoved(offerId);\n    }\n}\n</code></pre>\n\n<p>Now this can be used in the master page ok. I don't do anything in the master page and want to expose the event so that the aspx page can use it, like this:</p>\n\n<pre><code>Master.OfferBookmarkRemoved += OnBookmarkRemoved;\n\nvoid OnBookmarkRemoved(int offerId)\n{\n    offerId.ThrowDefault(\"offerId\");\n\n    OfferList1.UpdateBookmark(offerId);\n}\n</code></pre>\n\n<p>So the missing bit is to listen for the event in the master and make it available to the page.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["c#",".net","xml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13268851,"title":"Merge missing XML records based on Empty XML example","body":"<p>I have an XML template file and a previously saved XML database record:</p>\n\n<ul>\n<li>XML file - contains all the current fields I want for an object - This may change over time with items added</li>\n<li>XML database record - this is the saved XML.  It may be different from the XML in point one because the \"template\" xml may have been updated to contain more fields, etc.</li>\n</ul>\n\n<p>An example will clear this up..</p>\n\n<p>I have a \"template\" xml that looks like this:</p>\n\n<pre>\n&lt;dvd displayText=\"\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\" /&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\" /&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>This tells the UI to collect a Title and Description when creating a new record.  This works perfectly.</p>\n\n<p>So when I create a new DVD record it will display these 2 fields to the user and collect the \"Title\" and \"Description\" values and save the value into an XML field in a SQL Server table.</p>\n\n<p>But what I want to do now is add a new \"field\" definition to the template xml.  I've done this.. for the purposes of this example, lets have a \"PurchasedDate\" field definition added to the template XML.</p>\n\n<pre>\n&lt;dvd displayText=\"\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\" /&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\" /&gt;\n  &lt;field id=\"txtPurchaseDate\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Purchase Date\" /&gt;\n&lt;/dvd&gt;\n\n</pre>\n\n<p>If I'm creating a new DVD record, I get prompted for the 3 values; Title, Description, Purchased Date, because that's whats in the template XML..  But if I'm recalling a previously saved DVD record, it doesn't have the new \"Purchased Date\" field in the XML..</p>\n\n<pre>\n&lt;dvd displayText=\"My DVD\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\"&gt;My Movie DVD&lt;/field&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\"&gt;This movie is awesome&lt;/field&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>So what I want to do is take the XML saved in the database (shown above), compare or merge any missing \"field\" definitions from the template XML file.. and end up with this below:</p>\n\n<pre>\n&lt;dvd displayText=\"My DVD\"&gt;\n  &lt;field id=\"txtTitle\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"100\" label=\"DVD Title\"&gt;My Movie DVD&lt;/field&gt;\n  &lt;field id=\"txtDescription\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Your Description\"&gt;This movie is awesome&lt;/field&gt;\n  &lt;field id=\"txtPurchaseDate\" displayText=\"true\" required=\"true\" type=\"textbox\" width=\"50\" label=\"Purchase Date\" /&gt;\n&lt;/dvd&gt;\n</pre>\n\n<p>I'm using Linq to get the value from the existing record from the database if one exists.\nand I'm currently doing a XmlDocument.LoadXml(xmlstring) or XmlDocument.Load(filename) depending on whether its new or existing record.</p>\n\n<p>I'd then like to take the XmlDocument and merge the template into this to produce the above XML output for displaying on screen.</p>\n\n<p>If there is a better way than using XmlDocuments, can you please let me know..  I'll happily go and research it and then use it..</p>\n\n<p>I'm using C#...</p>\n\n<p>Many thanks..</p>\n"},{"tags":[".net","orm","entity-framework-4","many-to-many","ef-code-first"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":162,"score":0,"question_id":9378859,"title":"EF 4.3 code first mapping N:M on same type","body":"<p>I am trying to map a many to many scenario with objects of the same type.</p>\n\n<p>So i have a parent object of MyType with many children of the same type. Also an object of MyType can have many parents. How do you do this?</p>\n\n<p>I looked at <a href=\"http://stackoverflow.com/questions/6351381/mapping-child-items-of-same-class-with-entity-framework-code-first\">Mapping child items of same class with Entity Framework Code First</a> but it is not the same issue (child has only one parent)</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":7,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":732,"score":2,"question_id":7093861,"title":"Filter items of a ListBox based on the text of a TextBox using only XAML in WPF","body":"<p>I currently have a ListBox binded to a collection of items. As the collection is big we want to filter the items being shown based on the text entered on a TextBox. </p>\n\n<p>What I'm asking is if this is possible to implement using only XAML, I don't want to modify the collection of items, I would like to modify the Visibility of each of the items based on the filter.</p>\n\n<p>Hope its clear,</p>\n\n<p>thanks!</p>\n"},{"tags":["c#",".net","svn","version-control","project-management"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13268532,"title":"Share a file for C# project at home and at office","body":"<p>I have formed a number of source code files as my library. For example, I wrote <em>LinqExtension.cs</em> providing <em>Median()</em> function.</p>\n\n<p>Now I'm working on a project which needs LinqExtension.cs. As usually, I link the file to the project. As introduced <a href=\"http://greenicicleblog.com/2010/12/01/link-whole-directories-into-visual-studio-projects/\" rel=\"nofollow\">here</a>. The reason that I link files rather than copying them is to keep the files at a single location. If I modify a file, all dependent projects get affected. </p>\n\n<p>I also add the project to Subversion and upload to and download from Google Code. The linked file is not under version control.</p>\n\n<p>I work on the project at home as well as at office. I hate copying the linked file to my office, which makes the file not single. </p>\n\n<p>I figure out a solution that add <code>&lt;Compile Include=\"http://www.example.com/LinqExtension.cs\"/&gt;</code> to csproj file so that the file only exists on the Internet. Once I upload a new verison of the file, all dependent projects get affected.  Unfortunately the solution doesn't work.</p>\n\n<p>Any other suggesions or better practice?</p>\n"},{"tags":[".net","hl7","nhapi"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":833,"score":4,"question_id":4891592,"title":"considering using NHapi","body":"<p>I am considering using NHapi in some HL7 related projects. Usually when I decide to use any open source library in a project, I have two criteria:</p>\n\n<ol>\n<li>the broadness of the user base.</li>\n<li>the quality of support.</li>\n</ol>\n\n<p>Looking at the <a href=\"http://sourceforge.net/projects/nhapi/forums\" rel=\"nofollow\">NHapi forum on SourceForge</a>, it does not seem to fulfill any of the above two criteria. </p>\n\n<p>The other options are either to buy a commercial product or to write a parser. </p>\n\n<p>Anyone has any suggestion or thoughts of using NHapi ?</p>\n"},{"tags":["c#",".net","asynchronous","exception-handling","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13267029,"title":"How do I catch in C# an exception from an asynchronous method that is awaited?","body":"<p>I'm basically wondering how I should, in C#, catch exceptions from asynchronous methods that are waited on through the <code>await</code> keyword. Consider for example the following small console program, which most importantly contains a method called <code>AwaitSync</code>. <code>AwaitSync</code> calls <code>TestAsync</code>, which returns a Task that when executed throws an exception. I try to catch the exception in <code>AwaitAsync</code>, <em>but it goes unhandled</em>.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        AwaitAsync();\n        Console.ReadKey();\n    }\n\n    static async Task AwaitAsync()\n    {\n        try\n        {\n            await TestAsync();\n        }\n        catch (Exception)\n        {\n            Console.WriteLine(\"Exception caught\");\n        }\n    }\n\n    static Task TestAsync()\n    {\n        return Task.Factory.StartNew(() =&gt; { throw new Exception(\"Test\"); });\n    }\n}\n</code></pre>\n\n<p>How am I supposed to go about catching the exception from the Task returned by <code>TestAsync</code>? While this example is a console program, my real life problem is within the context of of ASP.NET MVC / Web API.</p>\n\n<p><strong>EDIT:</strong>\nTurns out the exception is getting caught, for technical reasons I just didn't notice the 'Exception caught' message before the terminal closed. In any case, Jon Skeet's answer was very valuable to my understanding of <code>await</code> and exception handling.</p>\n"},{"tags":["c#",".net","hl7","object-model"],"answer_count":5,"favorite_count":10,"up_vote_count":12,"down_vote_count":0,"view_count":6196,"score":12,"question_id":777933,"title":"HL7 object model for .NET","body":"<p>Searching for a library or framework that would provide an object model, parsing, validating, etc</p>\n\n<p>The idea would be to be able to spin up a new object of type hl7 v2 or v3. Then perhaps call it message type ORU_R01 or ADT, or ORM.</p>\n\n<p>Wouldn't life be great if we were able to do something like this:</p>\n\n<pre><code>HL7V2 myMessage = new HL7V2();\nmyMessage.Type = V2MsgTypes.ORU_R01;\nmyMessage.TryParse(someHL7_string);\n\nif (myMessage.IsValid)\n{\n  //do some work\n  //maybe access the PID segment\n  if (myMessage.Patient.Names.FamilyName ==\"Johnson\")\n  {\n    //do more work\n  }\n}\n</code></pre>\n"},{"tags":[".net","security"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":850,"score":7,"question_id":1326001,"title":"Windows DPAPI - what to do with entropy?","body":"<p>I'm using the Windows DPAPI to encrypt some sensitive data for me. The cipher is stored in the registry. This all works well, but I was wondering if someone could clarify my understanding of the 'entropy' bytes that are (optionally) supplied to ProtectedData.Protect() in .NET.</p>\n\n<p>The 'entropy' byte array appears to be analogous to an initialization vector or salt used with other cryptography schemes, but I could not see a good description of the entropy bytes in MSDN. The code samples I've seen just hard code in the entropy bytes!</p>\n\n<p>Are the entropy bytes supplied to ProtectedData.Protect() &amp; ProtectedData.Unprotect analogous to an IV or salt? Can the entropy bytes therefore be stored safely alongside the cipher, or would that compromise security?</p>\n"},{"tags":["c#",".net","oop","hl7"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3360,"score":5,"question_id":1999159,"title":"dotnet HL7 integration library","body":"<p>I have a medical health database that a 3rd party needs to connect to.</p>\n\n<p>We need to look at using the HL7 standards.</p>\n\n<p>I am looking for a good library to make using HL7 easier in a dotnet enviroment.</p>\n\n<p>I will need a comprehensive 2.x and 3.x lib that can do most of the heavy lifting.</p>\n\n<p>I want to try and avoid using message parsing and would rather use an object model as much as possible.</p>\n\n<p>I have seen <a href=\"http://nhapi.sourceforge.net/\">http://nhapi.sourceforge.net/</a> but this only seems to go to v2.x and not 3.x.</p>\n\n<p>Has any one used this library adn what was your feelings about this? was it useful adn productive?</p>\n\n<p>Any suggestions are welcome.</p>\n\n<p>Opensource or comercial are both good.</p>\n\n<p>thanks</p>\n"},{"tags":["c#",".net","winforms","validation","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13262097,"title":"Validate cell's value on a custom datagridviewCell","body":"<p>I have a <code>DataGridView</code> with a custom <code>DataGridViewColumn</code>. The column is hosting a third-party component. I enter edit mode in the cell and modify its value and then I press enter key to validate the value. The problem is that I have to press enter key twice to validate the value. It seems like first enter key is to validate the value in the third-party's editor hosted in the cell, and second one to validate the <code>DataGridView</code>'s cell... So how to validate cell's value with only pressing enter key one time? </p>\n\n<p>Also I have seen strange behaviour, for example, the last <code>DataGridView</code>'s row does not behaves as the rest of the <code>DataGridView</code>'s cells. For last row, if I edit the value of a cell and then press enter key to validate, after validating value, it always remains in the same cell and in edit mode and cell's value gets selected so user can think that cell value is invalid when in fact it isn't. This does not happen with the rest of the rows. They need to press enter key twice to validate and cells do not remain in edit mode after validating.</p>\n"},{"tags":[".net","asp.net","memory-leaks"],"answer_count":9,"favorite_count":5,"up_vote_count":7,"down_vote_count":0,"view_count":8698,"score":7,"question_id":473760,"title":"Tool for diagnosing memory leaks in .NET (ASP.NET Application)","body":"<p>we need a tool to detect easily memory leaks in an ASP.NET Application. We have an application, which consumes lot of memory.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","visual-studio","ms-word","rtf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13266926,"title":"Print an RTF containing headers and footers on a server","body":"<p>I have been looking for a way of printing an RTF file containing headers and footers to a named printer from a server, and would appreciate any pointers in where I should look next.</p>\n\n<p>I have looked at a couple of ways of handling this:</p>\n\n<p>First I looked into using a ShellExecute \"PrintTo\" call, which works exactly how I want it as long as either Word or OpenOffice is installed to correctly 'render' the RTF. However, the limitation of needing to install either of these applications is undesirable.</p>\n\n<p>The other option I have looked into is using a RichEditBox to load the RTF into and print from there, but header and footer information is then ignored.</p>\n\n<p>Is it possible to open an RTF file on the server, in the same format as it would be opened in Word, using just .net?</p>\n"},{"tags":["c#",".net","winforms","buttonclick","axwindowsmediaplayer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13268219,"title":"Accessing windows media player component on a form from another form","body":"<p>I'm making a C# application in which I have 2 forms: Form1 &amp; Form2. Form1 contains a windows media player COM component(axwindowsmediaplayer1), which I'm using to play songs on button click. \nNow, I want to invoke axwindowsmediaplayer1  from button click on Form2. I tried to make a static function(so that I can use it as Form1.function_name), but it gives error since axwindowsmediaplayer1 isn't static. </p>\n\n<p>How I can do this ? Please help. </p>\n"},{"tags":["c#",".net","encryption","yahoo-messenger"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":3,"view_count":307,"score":0,"question_id":5565150,"title":"What encryption generates this type of text?","body":"<p>I'm trying to decode a DAT file produced by Yahoo Messenger, which looks similar to the text below which I generated by opening an exe in Notepad:</p>\n\n<pre><code>‹\n‹N€9 tè…ÀtäÿFöt‹FŠ ‹V‹NˆÿFÿNëÿFH‰F3À9Ft9Ft  ö…³   ;Øtsj÷ël;Øt%‹F‹N¶Dÿj Pÿ5@aÐMè5  …À„þÿÿ…Ûuƒ} tÇEø   jEPÿvÿvÿuøÿ5DaÐMÿÐM…Àu,ÿÐM=Y  tjðë…ÛtjöXë&lt;3Àf‹F,ÇF.   ‰Eë‹E‹N…Étÿv2PÿÑëƒ~$ t\n‹N(f‰ƒF(ÿF 3À‰F_[ÉÂ ÌÌÌÌÌƒù\nu&lt;r&lt;Ÿ\n</code></pre>\n\n<p>I have tried few online tools that has various encryption algorithm like Blow-fish, DES, MD5 1-Way and other normal encryption like leet speak, rot-13 etc, but i found the generated text is normal readable but not the original one. I think its AES or RSA or Triple DES. Actually i am working on a utility that will read the Yahoo Messengers archive of the local. But when i open the local , I found a DAT file, with encrypted text as above. </p>\n\n<p><strong>(UPDATE)</strong> </p>\n\n<p>As per venkyduded article \"yahoo uses a simple XOR algorithm to encode the messages (so much for security !!) \". Any good link on XOR rversing.</p>\n\n<p>Any help would be highly appreciated.</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage","azure-storage-tables"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13256059,"title":"Azure october 2012 sdk - how to delete a table entity without retrieving it first?","body":"<p>In the previous version we could do this to delete an entity without knowing whether it exists.</p>\n\n<pre><code>svc = new TestContext();\nitem = new TestEntity(\"item2pk\", \"item2rk\");\nsvc.AttachTo(\"TestTable\", item, \"*\");\nsvc.DeleteObject(item);\nsvc.SaveChanges();\n</code></pre>\n\n<p><a href=\"http://blog.smarx.com/posts/deleting-entities-from-windows-azure-without-querying-first\" rel=\"nofollow\">(source)</a></p>\n\n<p>The new TableOperations doesn't have this syntax. Do I have to use this old method or is there a way? I'd like to be consistent because now all my code use the new classes for version 2.</p>\n\n<p>edit: the title was misleading</p>\n"},{"tags":[".net","sql","crystal-reports"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12929992,"title":"Crystal report 10 Error : Failed to open a rowset","body":"<p>I am using Crystal Reports 10, running on SQL Server 2008 R2. The backend is in the server. When I run a report, it is working fine with my Admin userid and password but if I login with the client userid and password, I get the</p>\n\n<p><img src=\"http://i.stack.imgur.com/CQUHB.png\" alt=\"Error Message\"></p>\n\n<p>Error Message :Failed to open a rowset. 42000:[Microsoft][ODBC SQL Server Driver][SQL Server]</p>\n\n<p>It sound like \"Access Violation or syntax error\".How to run the report in the client PC ?</p>\n"},{"tags":["c#",".net","xmltextwriter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13264853,"title":"xmlTextWriter does not save the XML file to bin folder","body":"<p>I am trying to create an XML file for storing some info from  a class. I gave the path as a const set to <code>Info.xml</code>. but the <code>XMLTextWriter</code> is not saving the XML file to bin(debug/release) folder, rather it is saving it to MyDocuments folder. When i tried to check if the file exists with <code>File.Exists(path)</code>, its returning false. Could somebody please guide me here.</p>\n\n<p>My code looks as below...</p>\n\n<pre><code>string BookName = \"Book1\" \nstring AuthorName= \"Author1\" \nXmlTextWriter writer = new XmlTextWriter(\"Info.xml\", Encoding.UTF8);    writer.WriteStartDocument(); \nwriter.WriteStartElement(\"Title\"); \nwriter.WriteString(BookName); \nwriter.WriteStartElement(\"Author\"); \nwriter.WriteString(AuthorName); \nwriter.WriteEndElement(); \nwriter.WriteEndElement(); \nwriter.WriteEndDocument(); \nwriter.Close();\n</code></pre>\n"},{"tags":[".net","asp.net-mvc","asp.net-mvc-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13267343,"title":"ASP.NET MVC form engine for an intranet solution?","body":"<p>Is there one that's worth looking into as an intranet solution ? The only one i've found that's even half decent is \n<a href=\"http://survey.codeplex.com/\" rel=\"nofollow\">Survey</a>.</p>\n\n<p>Reasons i don't want to use it is i would prefer ASP.NET MVC over Webforms and the project above has given me many headaches starting from security issues (for example last time i checked, HTML injection was allowed by default) and ending with the usability of the solution from an end user perspective. \nThe form engine's user interface and usability is just not acceptable for the problem i'm trying to solve.</p>\n\n<p>I was very impressed with the Java based form engine called <a href=\"http://www.orbeon.com/orbeon/fr/orbeon/builder/new\" rel=\"nofollow\">Orbeon</a>. Is there anything like that for ASP.NET MVC ?</p>\n"},{"tags":[".net","wpf","image","3d"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":800,"score":1,"question_id":2681112,"title":"How to make non-blurry image in WPF 3d","body":"<p>I used <code>Viewport3D</code> and <code>ModelVisual3D</code> to create a simple ImageBrush with an image (I tried it with JPG, PNG), but it shows the image blurry, but the original image is very sharp and clear.</p>\n\n<p>I don't know how to make it with the original quality in 3D...</p>\n\n<p>I also tried some 2D solutions like <code>RenderOptions.BitmapScalingMode</code> and <code>SnapsToDevicePixels</code> but seem not fix the problem in the 3D case.</p>\n\n<p>Has anyone encountered this problem or know the solution?</p>\n\n<p>below is sample code:</p>\n\n<pre><code>&lt;Window\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"    \nTitle=\"Window6\" Height=\"600\" Width=\"600\"&gt;\n\n&lt;Window.Resources&gt;\n    &lt;MeshGeometry3D x:Key=\"Card1\" Positions=\"-0.67,1,0 -0.67,-1,0 0.67,-1,0 0.67,1,0\"\n        TextureCoordinates=\"0,0 0,1 1,1 1,0\" TriangleIndices=\"0 1 2 0 2 3\" /&gt;\n&lt;/Window.Resources&gt;\n&lt;DockPanel Height=\"600\" Width=\"600\"&gt;\n    &lt;Viewport3D Width=\"415.67\" x:Name=\"viewport\" Margin=\"0,23.363,0,64.363\" DockPanel.Dock=\"Left\"&gt;\n        &lt;Viewport3D.Camera&gt;\n            &lt;PerspectiveCamera x:Name=\"perCamera\" x:Uid=\"perCamera\" FieldOfView=\"60\" Position=\"0,0,5\" /&gt;\n        &lt;/Viewport3D.Camera&gt;\n        &lt;ModelVisual3D&gt;\n            &lt;ModelVisual3D.Content&gt;\n            &lt;Model3DGroup &gt;\n                &lt;GeometryModel3D Geometry=\"{StaticResource Card1}\"&gt;\n                    &lt;GeometryModel3D.Material&gt;\n                        &lt;DiffuseMaterial&gt;\n                            &lt;DiffuseMaterial.Brush&gt;\n                                &lt;ImageBrush ImageSource=\"images\\card.png\"/&gt;\n                            &lt;/DiffuseMaterial.Brush&gt;\n                        &lt;/DiffuseMaterial&gt;\n                    &lt;/GeometryModel3D.Material&gt;\n                &lt;/GeometryModel3D&gt;\n                &lt;/Model3DGroup&gt;\n            &lt;/ModelVisual3D.Content&gt;\n        &lt;/ModelVisual3D&gt;\n        &lt;!-- light --&gt;\n        &lt;ModelVisual3D&gt;\n            &lt;ModelVisual3D.Content&gt;\n                &lt;DirectionalLight Color=\"#FFFFFFFF\" Direction=\"0,0,-1\"/&gt;\n            &lt;/ModelVisual3D.Content&gt;\n        &lt;/ModelVisual3D&gt;\n\n    &lt;/Viewport3D&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["asp.net",".net","asp.net-mvc"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12936546,"title":"File upload - video validation","body":"<p>how can I check if a file uploaded to my server by a standard html upload is a video file?</p>\n\n<p>I think file extension and mime checks are not useful as these could be faked. I tried using this script and it partially works, but for some reason it doesn't seem to validate wmv and mp4 formats.</p>\n\n<p><a href=\"http://mynkow.blogspot.co.uk/2010/05/how-to-validate-video-file.html\" rel=\"nofollow\">http://mynkow.blogspot.co.uk/2010/05/how-to-validate-video-file.html</a></p>\n\n<p>any help would be much appreciated.</p>\n\n<p>thanks</p>\n"},{"tags":[".net","source","hl7","mirth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13267932,"title":"Mirth Connect return the transformed message to the source service","body":"<p>I have a channel with a  Web service as the source and File writer as the destination.\nAs I am using .Net, I have created the service Web reference in my project. </p>\n\n<p>The complete scenario is like :</p>\n\n<pre><code>1. Required DataSet is converted to XML.\n2. The XML is sent to Mirth Connect Web service in a string format.\n3. Mirth Connect generates the HL7 format in the directory. \n4. Then .Net gets the generated file name in response, and from the location it fetches the file and allows the user to downloaded on the browser.\n</code></pre>\n\n<p>The optimization needed in this scenario is : </p>\n\n<pre><code> Mirth Connect should pass the generated HL7 to .Net and that should be given for the download. \n</code></pre>\n\n<p>Please assist to implement it.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":11784,"score":17,"question_id":388937,"title":"Determine Label Size based upon amount of text and font size in Winforms/C#","body":"<p>I'd like to know if there's a better approach to this problem. I want to resize a label (vertically) to accomodate certain amount of text. My label has a fixed width (about 60 chars wide before it must wrap), about 495 pixels. The font is also a fixed size (12points afaik), but the text is not. </p>\n\n<p>What I want to do is increase the Label Height when there's a \"NewLine\" or the text must wrap; the idea is that the text is fully visible in the label. The AutoSize doesn't work because it will grow in width, not in height. </p>\n\n<p>Of course I could count the number of NewLines and add:  Newlines * LineHeight, and then -given that I manage to put 60 chars per line, just divide the number of chars and add as many LineHeight pixels as needed.</p>\n\n<p>I was wondering if there was a more professional way to do it. Is my approach too \"lame\" ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["asp.net",".net","wcf","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13267630,"title":"Add reference to service within same project","body":"<p>I'm wondering if it is okay to add a reference to a web service within the same project (web application), i.e. I'm adding a reference in the same project where the service is defined.</p>\n\n<p>The reason for doing so is because  </p>\n\n<ul>\n<li>Hosting the service becomes easier (gets automatically hosted when hosting the web app).</li>\n<li>Invoking the service is done dynamically, i.e. the service url is fetched (from db) at run time and methods on that particular service are invoked. (this is a web app which is hosted on many domains. each app knows the service url of other apps (urls stored in db). since I have a reference to the service, I can change the url at runtime by updating the <code>Url</code> of the proxy and invoke it.)</li>\n</ul>\n\n<p>Also, I'm not sure if this is the way to go about it. I have seen a lot of people suggest using WCF instead of a web service, but I don't see how I could accomplish the same thing with WCF.</p>\n\n<p>There is already a question regarding this on SO - <a href=\"http://stackoverflow.com/questions/2135954/add-service-reference-to-wcf-service-within-same-project\">Add Service Reference to WCF Service within Same Project</a>, but i don't think it is valid for my situation.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":265,"score":1,"question_id":11580128,"title":"How to convert SID to String in .net","body":"<p>I would like to convert the SID's System.Byte[] type to a String.</p>\n\n<p>My code:</p>\n\n<pre><code>string path = \"LDAP://DC=abc,DC=contoso,DC=com\";\nDirectoryEntry entry = new DirectoryEntry(path);\nDirectorySearcher mySearcher = new DirectorySearcher(entry);\n\nmySearcher.Filter = \"(&amp;(objectClass=user)(samaccountname=user1))\";\nresults = mySearcher.FindAll();\nforeach (SearchResult searchResult in results)\n{\n    Console.WriteLine(searchResult.Properties[\"ObjectSID\"][0].ToString());\n}\n</code></pre>\n\n<p>I tried with this but it gets the values from the domain I'm currently logged in, and i need from a given domain.</p>\n\n<pre><code>System.Security.Principal.NTAccount(user1)\n    .Translate([System.Security.Principal.SecurityIdentifier]).value\n</code></pre>\n"},{"tags":[".net","xml","unit-testing","nunit","xmlunit"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":362,"score":3,"question_id":5897481,"title":".net Xml comparer for UnitTesting","body":"<p>I have a few unit tests where I need to make sure that XML generated by a method contains the same elements/values as an expected Xml document.</p>\n\n<p>I used <a href=\"http://xmlunit.sourceforge.net/\" rel=\"nofollow\">xmlunit</a> in Java, and although they have a .net version it doesn't seem to support namespaces. Are there any alternatives within .net for doing this?</p>\n\n<p>As long as I can just compare 2 Xml strings and get a true/false result to tell me if they match as far as the data contained is concerned I am happy...</p>\n"},{"tags":["c#",".net","multithreading","timer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":62,"score":-2,"question_id":13153245,"title":"How to excecute method after a delay in threading .timer?","body":"<p>I have a class that created a <strong>threading .timer</strong>.</p>\n\n<pre><code>  System.Threading.Timer timer;\n  TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n    timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n}\n\nprivate void ProcessTimerEvent(object obj)\n{\n    if (Tick != null)\n        Tick(this, EventArgs.Empty);\n}\n</code></pre>\n\n<p>I want dispose Timer inside of this and then timer work.</p>\n\n<p>in my TickEvent i excecute a method but don't complate this.</p>\n\n<pre><code> void MyTimer_Tick(object sender, EventArgs e)\n{\n if(value)\n   MyFunction();\n}\n</code></pre>\n\n<p>Timer must be taken to stop until MyFunction complete.</p>\n"},{"tags":["c#",".net","date","strtotime"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":43,"score":-1,"question_id":13267618,"title":"strtotime for C# (.NET)","body":"<p>Do you know of a strtotime equivalent in C#(.NET) even for other languages than English (i.e. Slovak version of 25th January is 25 Január).</p>\n"},{"tags":[".net","copy-protection"],"answer_count":10,"favorite_count":5,"up_vote_count":2,"down_vote_count":0,"view_count":1971,"score":2,"question_id":1142217,"title":".NET copy protection","body":"<p>Is it possible to restrict a .NET executable to a specific machine somehow so that it can only be run on that machine.</p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13266624,"title":"How to retrieve a control's container when clicked","body":"<p>I've got a <code>TreeView</code> which contains a number of <code>TreeViewItems</code>.  Each <code>TreeViewItem</code> contains a horizontally-oriented <code>StackPanel</code> which in turn contains an image and a label.</p>\n\n<p>When the user clicks on the TreeViewItem, I would like to get a reference for that <code>TreeViewItem</code>.  Instead, the source is returning as either label or image, depending on which part of the <code>TreeViewItem</code> the user clicks on.</p>\n\n<p>I cannot use the selectedItemChanged event, as this is strictly an operation which must occur every time a TreeViewItem is clicked.</p>\n\n<p>Here is my XAML:</p>\n\n<pre><code>&lt;TreeView DockPanel.Dock=\"Left\" \n          Name=\"tvSchema\" \n          AllowDrop=\"True\"\n          TreeViewItem.PreviewMouseLeftButtonDown=\"tvSchema_PreviewMouseLeftButtonDown\"&gt;\n&lt;/TreeView&gt;\n</code></pre>\n\n<p>And here is the code which attempts to retrieve the selected TreeViewItem when the user clicks on one:</p>\n\n<pre><code>private void tvSchema_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)\n{\n     object x = e.OriginalSource; //Returns TextBlock\n     object y = e.Source; //Returns Label\n     object z = sender; //Returns TreeView\n}\n</code></pre>\n\n<p>What can be done to get the actual TreeViewItem?</p>\n"},{"tags":[".net","garbage-collection"],"answer_count":12,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":2628,"score":9,"question_id":590623,"title":"Garbage Collection every 100 seconds","body":"<p>Did any one encountered a scenario where application under high memory allocation load performed second generation collection every 100 seconds ? </p>\n\n<p>We using 64-bit server with 8-16 GB of physical memory.</p>\n\n<p>Application has several GB of data what is stored in cache and can't be cleaned from it because it's actually used by application. In addition it receives a lot of request that allocate GEN 0 object during processing.</p>\n\n<p>What it's odd to me is the fact what GEN 2 collection performed evey 100 seconds like a clock. I was thinking it shuld be less predictable</p>\n"},{"tags":[".net","remote-debugging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13267423,"title":".Net remote debugging Win2003 website with VS 2012","body":"<p>I am trying to install the VS2012 remote debugger X86 version on a Windows 2003 in order to debug a web app from a computer that only has VS2012 installed. \nI am getting Newer Windows version required for this program message.<br/>\nDoes VS2012 remote debugger still supports Windows 2003?<br/>\nIs there another way to debug the app using VS2012? I've tried to connect the VS2010 remote debugger with VS2012 but it didn't work.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13266916,"title":"How to pause a Threading.timer to complete a function","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/684200/synchronizing-a-timer-to-prevent-overlap\">Synchronizing a timer to prevent overlap</a>  </p>\n</blockquote>\n\n\n\n<p>I have a <code>Threading.Timer</code> in my class.</p>\n\n<pre><code> System.Threading.Timer timer;\n TimerCallback cb = new TimerCallback(ProcessTimerEvent);\n timer = new Timer(cb, reset, 1000, Convert.ToInt64(this.Interval.TotalSeconds));\n</code></pre>\n\n<p>and defined a callback for it.</p>\n\n<pre><code>private void ProcessTimerEvent(object obj)\n{\n  if(value)\n    MyFunction();\n}\n</code></pre>\n\n<p>When run it, re-running callback before <code>myfunction</code> to complete.</p>\n\n<p>How to pause <code>Threading.Timer</code> to complete <code>myfunction</code>?</p>\n"},{"tags":[".net","dll","c++-cli"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13267062,"title":"Unmanaged DLL loading path","body":"<p>I have a managed c++/cli project that wraps an unmanaged dll. </p>\n\n<p>I load the unmanaged dll with <code>LoadLibrary</code>, but the <code>LoadLibrary</code> call can't find my dll. </p>\n\n<pre><code>  HMODULE theDllHell = LoadLibrary(L\"mylib.dll\");\n</code></pre>\n\n<p>What do I have to do, so that my dll gets copied to the output directory and what path do I have to supply to <code>LoadLibrary</code>?</p>\n"},{"tags":["c#",".net","xml","comments"],"answer_count":6,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2964,"score":5,"question_id":2875674,"title":"How to ignore comments when reading a XML file into a XmlDocument?","body":"<blockquote>\n  <p>Possible duplicate: <a href=\"http://stackoverflow.com/questions/1874132/how-to-remove-all-comment-tags-from-xmldocument\">How to remove all comment tags from XmlDocument</a></p>\n</blockquote>\n\n<p>Hello, I am trying to read a XML document with C#, I am doing it this way:</p>\n\n<pre><code>XmlDocument myData = new XmlDocument();\nmyData.Load(\"datafile.xml\");\n</code></pre>\n\n<p>anyway, I sometimes get comments when reading XmlNode.ChildNodes.</p>\n\n<p>For the benefit of who's experiencing the same requirement, here's how I did it at the end:</p>\n\n<pre><code>/** Validate a file, return a XmlDocument, exclude comments */\nprivate XmlDocument LoadAndValidate( String fileName )\n{\n    // Create XML reader settings\n    XmlReaderSettings settings = new XmlReaderSettings();\n    settings.IgnoreComments = true;                         // Exclude comments\n    settings.ProhibitDtd = false;                           \n    settings.ValidationType = ValidationType.DTD;           // Validation\n\n    // Create reader based on settings\n    XmlReader reader = XmlReader.Create(fileName, settings);\n\n    try {\n        // Will throw exception if document is invalid\n        XmlDocument document = new XmlDocument();\n        document.Load(reader);\n        return document;\n    } catch (XmlSchemaException) {\n        return null;\n    }\n}\n</code></pre>\n\n<p>Thank you<br />\nTommaso</p>\n"},{"tags":["c#",".net","pre-buildevent","app-globalresources"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13267077,"title":"Copy resx files to App_GlobalResources","body":"<p>I have two projects, first is MyPackag.Language project that holds all my resx files and some supporting classes. My other project is a web project that holds a Reference to MyPackage.Language project. When I build my web project I use the following Pre-Build event on my MyPackage.Language project:</p>\n\n<pre><code>mkdir \"$(ProjectDir)..\\..\\WebProj\\App_GlobalResources\\\" \ncopy \"$(ProjectDir)Resources\\*.resx\" \"$(ProjectDir)..\\..\\WebProj\\App_GlobalResources\\\"\n</code></pre>\n\n<p>All the resx files are copied into the App_GlobalResources folder in the web.\nMy problem: The web project cant find the resources files using:</p>\n\n<pre><code>&lt;asp:Label runat=\"server\" Text=\"&lt;%$ Resources: MyResourceFile, KeyName%&gt;\"&gt;&lt;/asp:Label&gt;\n</code></pre>\n\n<p>All the files are copied correctly and if i manuelly copy them before into VS2010 to the web project everything works as intended.</p>\n"},{"tags":["c#",".net","aop"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":220,"score":0,"question_id":4760055,"title":"Dynamically building method/property bodies","body":"<p>So I've got this boilerplate code that I want to apply to a bunch of properties of certain classes, that is essentially identical for each one. Rather than have to type this same code out again and again for all of these properties, I was wondering if there was any way I could dynamically build these property methods either post-compile or at runtime, by assigning a C# attribute to the property that includes the slight difference for each method (a string) and then finding these properties by reflection.</p>\n\n<p>I'm aware of PostSharp, but I'm looking for something free or open source.</p>\n\n<p>For example, instead of having to do this:</p>\n\n<pre><code>public string Name {\n    get { return _member.GetValue( \"othername\" ); }\n    set { _member.SetValue( \"othername\", value ); }\n}\n</code></pre>\n\n<p>...for each property I have, I just want to say this:</p>\n\n<pre><code>[MapTo( \"othername\" )]\npublic string Name { get; set; }\n</code></pre>\n\n<p>Any thoughts?</p>\n"},{"tags":["c#",".net","rest","asp.net-web-api"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":73,"score":3,"question_id":13223470,"title":"Backward compatibility in a RESTful API","body":"<p>I am currently designing an RESTful API implemented using the ASP.NET Web API.<br>\nOne very important point is backward compatibility.<br>\nI would like to keep the actual API code free of any thoughts about backward compatibility, to ensure clean and up-to-date design.<br>\nI thought about solving this by having a layer of version translators.<br>\nEach of these translators knows how to transform the requests and responses of one specific version (vPrevious) into those of another specific version (vCurrent).<br>\nThese translators could easily be stacked to ensure backward compatibility with an arbitrary number of old versions.<br>\nEach of these translators would be responsible for doing all kinds of stuff, like setting default values for new properties or even performing an array of different operations.</p>\n\n<p>I thought about implementing a <code>DelegatingHandler</code> that examines the version number of the API the client wants to use and based on that knows which translators to use.<br>\nHowever, I fail to see how I would actually go about implementing this.\nAs I see it, each translator actually needs to be a full blown ASP.NET Web API of its own, along with a routing table and controllers. That actually would be acceptable, but how would that translator controller route the data to the next one in the chain?</p>\n"},{"tags":["c#",".net","wpf","winapi"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2951,"score":0,"question_id":1776382,"title":"How do I remove the icon and title from a WPF Window but display it in the taskbar?","body":"<p>I'm trying to create a WPF window, which has no icon and no title displayed in the titlebar.</p>\n\n<p>I already found some examples how the icon can be removed (for example <a href=\"http://www.danrigsby.com/blog/index.php/2008/05/26/remove-icon-from-wpf-window/\" rel=\"nofollow\">here</a>), but all these solutions work if I'm debugging the application in Visual Studio but they don't work when I'm just running the executable.</p>\n\n<p>I would also like the title not to be shown. Of course I could leave the title blank, but I would like the title to be disyplayed in the taskbar (similiar to what Windows Explorer does in Vista/7)</p>\n"},{"tags":["c#",".net","sql-server","subtract"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13266422,"title":"Mssql Subtract certain percent","body":"<p>Im trying to subtract a certain percent of my price, into a AS columm.</p>\n\n<pre><code>SELECT TOP 2 *, price - (price * (discount/100)) AS discountedPrice FROM products WHERE discount != 0\n</code></pre>\n\n<p>But this seems not to work. What have i done wrong?</p>\n\n<p>I want it like this, let's say price is 500 and discount is 20. Then it'll have to subtract those 20 as percent of the 500.</p>\n\n<p>So 500 - 20%, just in Mssql format.</p>\n"},{"tags":["c#",".net","web-config","membership-provider"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13263450,"title":"altering the type field in sqlmembership provider","body":"<p>Let us  consider the following web.config file </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\"&gt;\n  &lt;connectionStrings&gt;\n\n  &lt;/connectionStrings&gt;\n  &lt;system.web&gt;\n    &lt;pages theme=\"PetShop\" styleSheetTheme=\"PetShop\" controlRenderingCompatibilityVersion=\"3.5\" clientIDMode=\"AutoID\"&gt;\n      &lt;controls&gt;\n        &lt;add tagPrefix=\"blt\" namespace=\"BLToolkit.Web.UI\" assembly=\"BLToolkit.4\" /&gt;\n      &lt;/controls&gt;\n    &lt;/pages&gt;\n    &lt;!--\n            Set compilation debug=\"true\" to insert debugging \n            symbols into the compiled page. Because this \n            affects performance, set this value to true only \n            during development.\n        --&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.0\"&gt;\n      &lt;assemblies&gt;\n        &lt;add assembly=\"System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" /&gt;\n      &lt;/assemblies&gt;\n    &lt;/compilation&gt;\n    &lt;!--\n            The &lt;authentication&gt; section enables configuration \n            of the security authentication mode used by \n            ASP.NET to identify an incoming user. \n         --&gt;\n    &lt;authentication mode=\"Forms\"&gt;\n      &lt;forms name=\"PetShopAuth\" loginUrl=\"SignIn.aspx\" protection=\"None\" timeout=\"60\" /&gt;\n    &lt;/authentication&gt;\n    &lt;!--\n            The &lt;customErrors&gt; section enables configuration \n            of what to do if/when an unhandled error occurs \n            during the execution of a request. Specifically, \n            it enables developers to configure html error pages \n            to be displayed in place of a error stack trace.\n        --&gt;\n    &lt;customErrors defaultRedirect=\"Error.aspx\" mode=\"RemoteOnly\" /&gt;\n    &lt;sessionState mode=\"Off\" /&gt;\n    &lt;anonymousIdentification enabled=\"true\" /&gt;\n    &lt;profile automaticSaveEnabled=\"false\" defaultProvider=\"ShoppingCartProvider\"&gt;\n      &lt;providers&gt;\n        &lt;add name=\"ShoppingCartProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n        &lt;add name=\"WishListProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n        &lt;add name=\"AccountInfoProvider\" connectionStringName=\"ProfileDB\" type=\"PetShop.BusinessLogic.ProfileProvider\" applicationName=\".NET Pet Shop 4.0\" /&gt;\n      &lt;/providers&gt;\n      &lt;properties&gt;\n        &lt;add name=\"ShoppingCart\" type=\"PetShop.BusinessLogic.Cart\" allowAnonymous=\"true\" provider=\"ShoppingCartProvider\" /&gt;\n        &lt;add name=\"WishList\" type=\"PetShop.BusinessLogic.Cart\" allowAnonymous=\"true\" provider=\"WishListProvider\" /&gt;\n        &lt;add name=\"AccountInfo\" type=\"PetShop.ObjectModel.Address\" allowAnonymous=\"false\" provider=\"AccountInfoProvider\" /&gt;\n      &lt;/properties&gt;\n    &lt;/profile&gt;\n    &lt;!-- Membership Provider for SqlServer --&gt;\n    &lt;membership defaultProvider=\"SQLMembershipProvider\"&gt;\n      &lt;providers&gt;\n        &lt;add name=\"SQLMembershipProvider\" type=\"System.Web.Security.SqlMembershipProvider\" connectionStringName=\"MembershipDB\" applicationName=\".NET Pet Shop 4.0\" enablePasswordRetrieval=\"false\" enablePasswordReset=\"true\" requiresQuestionAndAnswer=\"false\" requiresUniqueEmail=\"false\" passwordFormat=\"Hashed\" /&gt;\n      &lt;/providers&gt;\n    &lt;/membership&gt;\n    &lt;caching&gt;\n      &lt;sqlCacheDependency enabled=\"true\" pollTime=\"10000\"&gt;\n        &lt;databases&gt;\n          &lt;add name=\"MSPetShop4\" connectionStringName=\"SQLConnString1\" pollTime=\"10000\" /&gt;\n        &lt;/databases&gt;\n      &lt;/sqlCacheDependency&gt;\n    &lt;/caching&gt;\n  &lt;/system.web&gt;\n  &lt;location path=\"UserProfile.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;deny users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n  &lt;location path=\"CheckOut.aspx\"&gt;\n    &lt;system.web&gt;\n      &lt;authorization&gt;\n        &lt;deny users=\"?\" /&gt;\n      &lt;/authorization&gt;\n    &lt;/system.web&gt;\n  &lt;/location&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>by reading the above config file i need to change the attribute value of type field in membership providers nodes. </p>\n\n<pre><code>    type=\"System.Web.Security.SqlMembershipProvider\" \n</code></pre>\n\n<p>to new value </p>\n\n<p>type=\"sample.SqlMembershipProvider\"</p>\n\n<p>through c#.net lamda expressions</p>\n\n<p>waiting for your responses</p>\n"},{"tags":["c#",".net","winforms","performance","logging"],"answer_count":7,"favorite_count":4,"up_vote_count":1,"down_vote_count":0,"view_count":6020,"score":1,"question_id":5057567,"title":"How to do logging in c#?","body":"<p>I would like to implement logging in my application but would rather not use any outside frameworks like log4net.</p>\n\n<p>So I would like to do something like Dos's echo to file. What is the most effective way to do it?</p>\n\n<p>Is there a way to log unhandled exceptions logged without using an outside framework?</p>\n"},{"tags":[".net","git","msbuild","build-process","nant"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13129565,"title":".NET Building Process - Github/Git and Dependent Projects","body":"<p>I'm currently using Github/Git for two .NET solutions. The first solution is a library of common .NET code for all projects at my company, the second solution is a ASP.NET MVC Web Application.</p>\n\n<p>What does a proper Nant or MSBuild file look like for cloning first repo, build it, clone second repo, add assemblies from first solution to the second? I plan on using Jenkins as my build server. I'm unclear of which parts are handled by the build server and which by the build file. I don't want to reinvent the wheel. Thanks.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":30,"score":-1,"question_id":13265883,"title":"non closable window in windows form using c#?","body":"<p>When I click a submit button on the windows form, it should throw up a popup window (asking for yes or no) which doesn't have a close (X) button even if we click wherever that popup window should blink for that response.</p>\n\n<p>So how to do it?</p>\n"},{"tags":[".net","vb.net","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13264652,"title":"HTTP POST Method - Invoking of Class","body":"<h2>The Controller:</h2>\n\n<pre><code>Public Class TheColorNameRequestClass\n    Inherits System.Web.Mvc.Controller\n\n    ' This method will handle GET'\n    Function TheGET() As ActionResult\n        Return View()\n    End Function\n\n    ' This method will handle POST'\n    &lt;HttpPost()&gt; _\n    Function TheRequest(ByVal ColorName As String) As ActionResult\n        ' Do something'\n        Response.Write(\"The color name submitted is:, \" &amp; Request.Form(\"ColorName\"))\n        Return View()\n    End Function\n\nEnd Class\n</code></pre>\n\n<h2>The HTML, (The View):</h2>\n\n<pre><code>&lt;form action=\"\" method=\"post\"&gt;\n    &lt;input type=\"text\" name=\"UserName\" id=\"UserName\" /&gt;\n    &lt;input type=\"submit\" name=\"UserName_submit\" value=\"Print It Out!\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<h2>The Question:</h2>\n\n<p>After pressing the <code>Submit Button</code>, how is the <code>Class</code> in the <code>Controller</code> - including the function called <code>TheRequest</code> - <em>invoked</em>?</p>\n\n<p>In this case, I am directing the question to the process, of having the <code>Controller</code> scanned for the <em>Class</em> and the <em>Functions</em>, - <strong><em>after</em></strong> - the <em>submit button</em> is pressed, so that the <code>request</code> can be done correctly to the <code>HTTP POST method</code>.</p>\n\n<hr />\n\n<p>The given is the <code>current HTTP request</code>, after pressing the <code>Submit Button</code>. Where the <code>Request.Form</code> method does do the request specifically for the \"ColorName\", submitted through the form.</p>\n\n<p>By my PHP experience, I am thinking of having the <strong><em>\"action attribute of the form\"</em></strong> contain the name of the controller, so it can start scanning each line, after the <em>submit button</em> is pressed. This is said as an example.</p>\n\n<p><em>The question has been modified.</em></p>\n\n<hr />\n\n<p><em><strong>Invoked</em></strong> = to put into effect or operation <em>(Source: The Merriam-Webster Dictionary)</em></p>\n"},{"tags":[".net","msbuild"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":186,"score":0,"question_id":3492501,"title":"Remove unused classes and resources during build","body":"<blockquote>\n  <p><em>This question is more of theoretical nature than of practical use.</em></p>\n</blockquote>\n\n<p>I know that there are several programs to find unused code, but this question is a little bit different then that.</p>\n\n<p>Would it be possible to find unused code and resources during or after the build and remove it? I've several 'generic' libraries which are shared across many projects, and each project is only using a part of those libraries (overlapping and may change in the future, so no direct refactoring possible and I don't feel like breaking those further down). My idea was to remove these unused parts to keep the resulting files small.</p>\n\n<p>So, what are my odds to accomplish this?</p>\n"},{"tags":["c#",".net","string"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13246313,"title":"Format a String literal","body":"<p>I want to format a string value by a certain format that the <code>first letter</code> of it be in <code>Uppercase</code>.<br>\ne.g:  </p>\n\n<pre><code>string.Format(\"{0}\", \"myName\"); //Output must be : \"MyName\"\n</code></pre>\n\n<p>How can I do it?</p>\n"},{"tags":["c#",".net","database","asp.net-membership","membership-provider"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13265957,"title":"Setting Membership provider's database at runtime...?","body":"<p>We're using ASP.Net membership providers (the SQL Server provider), and I want to be able to change only the database name in the class . To do this, I need the ASP.Net membership provider configured so that my installer can use it </p>\n\n<p>i used code as</p>\n\n<pre><code>public class CodeFirstMembershipProvider : SqlMembershipProvider\n    {    \n      public override void Initialize(string name, System.Collections.Specialized.NameValueCollection config)  \n      { \n          base.Initialize(name, config);  \n\n          // hard coded for testing  \n          string connectionString = @\"server=localhost;database=masterdb;uid=master;pwd=password\";\n\n          // Set private property of Membership provider.  \n          FieldInfo connectionStringField = GetType().BaseType.GetField(\"_sqlConnectionString\", BindingFlags.Instance | BindingFlags.NonPublic);  \n          if(connectionStringField != null)\n            connectionStringField.SetValue(this, connectionString);  \n      }\n}\n</code></pre>\n\n<p>in above code i need to enter and change the full connection string values..</p>\n\n<p>it too works fine .....</p>\n\n<p>but my query is to change only the database name only of the current connection string mentioned in web.config file..</p>\n\n<p>So is there a way to switch the databse name through an ASP.Net membership through code ?</p>\n"},{"tags":["c#",".net","design-patterns","data-access-layer"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13265445,"title":"Should my DAL return Person or Datatable?","body":"<p><em>After reading <a href=\"http://stackoverflow.com/questions/836621/should-my-dal-return-datatables-or-i-whatever\">this</a>  , I still have a question :</em> </p>\n\n<p>I use this code to query the db : </p>\n\n<p><kbd>c# : </kbd></p>\n\n<pre><code>new BLL().GetPersonById(1)\n</code></pre>\n\n<p><kbd>BLL : </kbd></p>\n\n<pre><code>public Person GetPersonById(int id)\n{\n  return new DAL ().GetPersonById(1);\n}\n</code></pre>\n\n<p><kbd>DAL : </kbd></p>\n\n<pre><code>public Person  GetPersonById(int id)\n{\n   // goto db and create instance of Person and fill its data...\n}\n</code></pre>\n\n<p>However , am I doing it wrong , </p>\n\n<p>Should my DAL return <code>DataTable</code> <strong>instead</strong> ?  ( so the BLL will create Person .... ?)</p>\n\n<p><kbd>DAL : </kbd></p>\n\n<pre><code>public DataTable  GetPersonById(int id)\n{\n   // goto db ...\n}\n</code></pre>\n\n<p>Thank you.</p>\n\n<p>Edit : </p>\n\n<p>the Person object is defined in <strong>BE</strong> dll ( business entity).</p>\n"},{"tags":["c#",".net","class"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":50,"score":-2,"question_id":13123061,"title":"Updating GUI components in class B from class A in c#","body":"<p>EDIT: I see I'm getting a lot of downvotes on this post. I've tried to explain what I try to do, where my errors and in which direction want to go. I'm asking for insight in what I'm doing wrong. If you downvote; pleas tell me why, so I can improve the question. Thanks.</p>\n\n<p>I'm creating an application where I have one main form, and several different User Controls which the user works on. This helps me splitting the code, managing the different parts of the program. And it would be easy to expand the application later on.</p>\n\n<p>I'm trying to create a class where I manage the active controls I want to call one function in that class with as argument the form that should become active.</p>\n\n<p>An image can illustrate how I try to setup this application. <img src=\"http://i.stack.imgur.com/Jwimk.png\" alt=\"Illustration\"> Note that the control manager class is not a seperate class in the code i show below, but a partial class of the mainform. Any tips on how to get it like in the image are very welcome :)</p>\n\n<p>The class to manage all active forms looks like this: Please note that all user controls are just a user control with some buttons/textboxes etc on it. No code is added at all yet.</p>\n\n<pre><code>    public partial class STP2Main \n        {\n// I make each UserControl accessable for the whole class\n            SetupDeviceControl.SetupDevice SetupDev = new SetupDeviceControl.SetupDevice();\n            GenConfigFileControl.GenConfigFileControl GenConfFile = new GenConfigFileControl.GenConfigFileControl();\n            Monitoring.MonitoringControl Monitor = new Monitoring.MonitoringControl();\n            GenEncKeyControl.GenEncKeyControl GenEncKey = new GenEncKeyControl.GenEncKeyControl();\n            MenuControl.MenuControl MenuControl = new MenuControl.MenuControl();        \n\n            public void SelectActiveWindow()\n            {\n                // Any active control should be hidden thats what this function does:\n                HideCurrentActiveControl();\n                // Check whether the window is already created\n                if (!WindowExists())\n                { // if not created; create the windows: \n                    switch (STP_Design.ProgramParameters.C.NextActiveControl)\n                    {\n                        case STP_Data.Data.SetupDeviceControl: // control 1:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.SetupDeviceControl;\n                            STP_Design.ProgramParameters.C.SetupDeviceControlIsCreated = true;\n                            SetupDev.Parent = this;\n                            SetupDev.Location = new Point(3, 30);\n                            SetupDev.Show();\n                            SetupDev.BringToFront();\n                            break;\n                        case STP_Data.Data.MonitoringControl: //control 2:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MonitoringControl;\n                            STP_Design.ProgramParameters.C.MonitoringControlIsCreated = true;\n                            Monitor.Parent = this;\n                            Monitor.Location = new Point(3, 125);\n                            Monitor.Show();\n                            Monitor.BringToFront();\n                            break;\n                        case STP_Data.Data.MenuControl: // control 3\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MenuControl;\n                            STP_Design.ProgramParameters.C.MenuControlIsCreated = true;  \n                            MenuControl.Location = new Point(3, 30);\n                            MenuControl.Parent = this;\n                            MenuControl.Show();\n                            MenuControl.BringToFront();\n                            break;\n                    }\n                }\n                else\n                { // window is already created so needs to be called to front again:\n                    switch (STP_Design.ProgramParameters.C.NextActiveControl)\n                    {\n                        case STP_Data.Data.SetupDeviceControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.SetupDeviceControl;\n                            SetupDev.BringToFront();\n                            break;\n                        case STP_Data.Data.MonitoringControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MonitoringControl;\n                            Monitor.Visible = true;\n                            Monitor.BringToFront();\n                            break;\n                        case STP_Data.Data.AdvancedMenu:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.AdvancedMenu;\n                            tabControl1.Visible = true;\n                            tabControl1.BringToFront();\n                            break;\n\n                        case STP_Data.Data.MenuControl:\n                            STP_Design.ProgramParameters.C.CurrentActiveControl = STP_Data.Data.MenuControl;\n                            MenuControl.Visible = true;\n                            MenuControl.BringToFront();\n                            break;\n                    }\n\n                }\n                btnMenu.BringToFront();\n\n            }\n    // some functions which are called above are not shown; not relevant for this question\n    }\n</code></pre>\n\n<p>What I experience is the following: I get no errors at all. But the controls simply not change at all. If I call a window, it is created only once, because I did make it as partial class of my Mainform. (I've tried a complete seperate class, which did result in errors with threading, As I am not an experienced c# programmer, I tried to avoid that using a partial class.)</p>\n\n<p>I'll add another function; which does not do anything at all: </p>\n\n<pre><code>    private void HideCurrentActiveControl()\n    {\n        switch (STP_Design.ProgramParameters.C.CurrentActiveControl)\n        {\n            case STP_Data.Data.SetupDeviceControl:\n                SetupDev.Visible = false;\n                break;\n            case STP_Data.Data.MonitoringControl:\n                tabControl1.Visible = false;\n                Monitor.Visible = false;\n                break;\n            case STP_Data.Data.GenConfFileControl:\n                GenConfFile.Visible = false;\n                break;\n            case STP_Data.Data.GenEncKeyControl:\n                GenEncKey.Visible = false;\n                break;\n            case STP_Data.Data.MenuControl:\n                MenuControl.Visible = false;\n                break;\n            case STP_Data.Data.AdvancedMenu:\n                tabControl1.Visible = false;\n                break;\n            default:\n                tabControl1.Visible = false;\n                break;\n\n        }\n    }\n</code></pre>\n\n<p>I've tried debugging this part of code and it executes the statements, but I see no changes at all.</p>\n\n<p>I think I've shown what I am trying to do; and how I try to do that. My question is: How do I acces those forms so I can manage them from a seperate class (or in this case partial class of the main form).</p>\n\n<p>Then I have this last function, which does some wierd things. Before I call the SelectActiveWindow() function I update the variable STP_Design.ProgramParameters.C.NextActiveControl to for example:  ...AdvancedMenu. (this was before that ...MenuControl) But it does always show that it is still MenuControl. Nowhere in my code is something where I change that value besides right before I start the function. (I've also tried to make the nextcontrol as an argument of the function SelectActiveWindow() but this did the same)</p>\n\n<pre><code>    private bool WindowExists()\n    {\n        switch (STP_Design.ProgramParameters.C.NextActiveControl)\n        {\n            case STP_Data.Data.SetupDeviceControl:\n                if (STP_Design.ProgramParameters.C.SetupDeviceControlIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.MonitoringControl:\n                if (STP_Design.ProgramParameters.C.MonitoringControlIsCreated)\n                    return true;\n                else\n                return false;\n            case STP_Data.Data.GenConfFileControl:\n                if (STP_Design.ProgramParameters.C.GenConfFileIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.GenEncKeyControl:\n                if (STP_Design.ProgramParameters.C.GenEncKeyControlIsCreated)\n                    return true;\n                else\n                    return false;\n            case STP_Data.Data.AdvancedMenu:\n                return true;\n            case STP_Data.Data.MenuControl:\n                if (STP_Design.ProgramParameters.C.MenuControlIsCreated)\n                    return true;\n                else\n                    return false;\n\n            default:\n                return false;\n        }\n    }\n</code></pre>\n\n<p>Summery of what I am looking for: \nI am having a main form where display different user controlls in. I am trying to create a seperate class which is accessable from each control/form in my project. This class should manage the controls which are shown. In the code above I illustrated how I tried to do this, but this does not result in the expected result.</p>\n"},{"tags":["c#",".net","winforms","datagridview","editmode"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13261895,"title":"Exit edit mode from a control hosted in a cell","body":"<p>I have a custom datagridviewcolumn, a custom control hosted in a cell. I want to programmatically exit edit mode and validate the current value in the cell (this value is correct). I have checked below ways but without success:</p>\n\n<pre><code>this.datagridview.currentCell.datagridview.endEdit()\nthis.EditingControlDataGridView.endEdit()\nthis.datagridview.endEdit();\n</code></pre>\n\n<p>also by forcing the current cell to change:</p>\n\n<pre><code>this.datagridview.currentCell = this.datagridview.Rows[rowIndex].Cells[columnIndex]\n</code></pre>\n\n<p>I need to programmatically force the commit of the pending value in the cell because for example, there are cases that I need to delete a row of datagridview but as cell (in the same row being deleted) is in edit mode, I cannot do it if I do not commit changes for the cell and exit edit mode before.</p>\n\n<p>Also, I have similar strange behaviour when I want to exit edit mode but, in this case, discarding the changes in the cell: depending on the state of my application, sometimes doing this.datagridview.CancelEdit() works and sometimes not.</p>\n\n<p>Using C#, .NET Framework 4.0, WinForms.</p>\n"},{"tags":["c#",".net","winforms","picturebox","imagelist"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263608,"title":"populate PictureBox with Images using Foreach loop","body":"<p>In my project I have collection of PictureBoxes and a filled ImageList. I want to populate each pictureBox with the each Image in ImageList using <code>foreach</code> Loop. I know how to do using For loop but I dont know how to do it using foreach loop. I am asking this just for knowledge purpose. I think this can be achieved using Linq inside foreach loop but I am a beginner so I have no Idea how to do it.</p>\n\n<p>I tried the below code in for loop:</p>\n\n<pre><code>        for (intimgcount = 0; intimgcount &lt; intMaxPics; intimgcount++)\n        {                \n            pbxCollection[intimgcount].Image = imglst.Images[intimgcount];          \n        }     \n</code></pre>\n\n<p>the code which  I want to use in <code>foreach</code> loop is:</p>\n\n<pre><code>        var pbxCollection = new List&lt;PictureBox&gt;();  //PictureBox collection\n</code></pre>\n\n<p>EDIT:  How to set the positions of Picture Box collection in the form?</p>\n\n<p>I tried:</p>\n\n<pre><code>        var i = 0;\n        foreach (var pbx in pbxCollection)\n        {\n            pbx.Image = imglst.Images[i++];\n            //set location:\n            pbx.Width = 100;\n            pbx.Height = 100;\n            pbx.Location = new Point(0, pbx.Height * i);\n            //add to form:\n            this.Controls.Add(pbx);\n        }  \n</code></pre>\n"},{"tags":[".net","wcf","iis","configuration","self-hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13265432,"title":"Max amount of sessions on my WCF service?","body":"<p>I have a WCF service running InstanceContextMode = PerCall, ConcurrencyMode = Multiple, TCP and is hosted in Selfhost(Windows Service) and IIS7/IIS8.</p>\n\n<p>The throttling is set to this : </p>\n\n<pre><code>&lt;serviceThrottling maxConcurrentCalls=\"2000\" maxConcurrentSessions=\"2147483647\" maxConcurrentInstances=\"2000\"/&gt;\n</code></pre>\n\n<p>And the binding looks like this : </p>\n\n<pre><code>&lt;binding name=\"netTcpRegular\" closeTimeout=\"00:01:00\" openTimeout=\"00:01:00\" receiveTimeout=\"infinite\" sendTimeout=\"01:00:00\" transactionFlow=\"false\" transferMode=\"Buffered\" transactionProtocol=\"OleTransactions\" hostNameComparisonMode=\"StrongWildcard\" listenBacklog=\"1000\" maxBufferPoolSize=\"2147483647\" maxBufferSize=\"2147483647\" maxConnections=\"200\" maxReceivedMessageSize=\"2147483647\"&gt;\n          &lt;readerQuotas maxDepth=\"2147483647\" maxStringContentLength=\"2147483647\" maxArrayLength=\"2147483647\" maxBytesPerRead=\"2147483647\" maxNameTableCharCount=\"2147483647\"/&gt;\n          &lt;reliableSession ordered=\"true\" inactivityTimeout=\"infinite\" enabled=\"false\"/&gt;\n          &lt;security mode=\"None\"&gt;\n            &lt;transport clientCredentialType=\"None\"/&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n</code></pre>\n\n<p>We are keeping state at the serivce so every user will have there own objects that is fetched on every call.</p>\n\n<p><strong>The question is how many concurrent users (sessions) can we have with these settings and what settings is affecting this?</strong></p>\n"},{"tags":["c#",".net","vb.net","richtextbox","rtf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13265762,"title":"How to add a rtf formatting in the text string for a Richt Text Box?","body":"<p>In a .NET project I have a long plain text build as concatenation of several strings</p>\n\n<pre><code>StringLongText = text1 + text2 + ... + textN\n</code></pre>\n\n<p>each string \"textX\" is the result of an evaluation. \nAt the end of a started process, I show the result in a RichTextBox doing simply:</p>\n\n<pre><code>rtfTxt.Text = StringLongText\n</code></pre>\n\n<p>All works fine, but I am not able to add any text formatting in the previous text1, text2, textN blocks.</p>\n\n<p>For example I would like to write some words in bold or italic including the formatting directly in the strings before concatenating them.</p>\n\n<p>Doing</p>\n\n<pre><code>text1 = \"This is some {\\b bold} text\"\nrtfTxt.Text = text1\n</code></pre>\n\n<p>did not work.</p>\n\n<p>Any suggestion? Thank you for your help.</p>\n"},{"tags":["c#",".net","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13265704,"title":"Conversion error from database smallint into C# nullable int","body":"<p>I have a security_role_cd column in database of <code>smallint</code> datatype. I am selecting this column using following code into a <code>nullable int</code> variable. </p>\n\n<p>I am getting following error: </p>\n\n<blockquote>\n  <p>Error     3       Type of conditional expression cannot be determined because there is no implicit conversion between 'null' and 'short'        </p>\n</blockquote>\n\n<p>What is the correct code to overcome this error?</p>\n\n<pre><code>SELECT R.security_role_cd  FROM Security_Role R WHERE security_role_name = 'Admin'\n</code></pre>\n\n<p>C# </p>\n\n<pre><code>        int? roleID = null;\n        string commandText = \"SELECT R.security_role_cd  FROM Security_Role R WHERE security_role_name = @roleName\";\n        SqlCommand command = new SqlCommand(commandText, connection);\n        command.CommandType = System.Data.CommandType.Text;\n        command.Parameters.AddWithValue(\"@roleName\",roleName);\n        SqlDataReader readerRole = command.ExecuteReader();\n        if (readerRole.HasRows)\n        {\n            while (readerRole.Read())\n            {\n                roleID = readerRole.GetInt16(0) == 0 ? null : readerRole.GetInt16(0) ;\n\n            }\n        }\n        readerRole.Close();\n</code></pre>\n"},{"tags":[".net","windows-services"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1954,"score":1,"question_id":3615367,"title":"Windows Service : error 5 :Access Denied","body":"<p>I am trying to create a simple Windows Service. The User Account for the service is <code>NetworkService</code> Then i ran <code>installUtil</code> from command prompt and i got this :-</p>\n\n<blockquote>\n  <p>The Commit phase completed\n  successfully.</p>\n  \n  <p>The transacted install has completed.</p>\n</blockquote>\n\n<p>which means the service got installed successfully. But when i try to run it from the <code>Service applet</code> i get this error :-</p>\n\n<p><code>Windows cannot the CustomersService service on Local Computer. Error 5 : Access is denied.</code> </p>\n\n<p>What am i doing wrong?</p>\n\n<p>I am using 64bit Windows 7.</p>\n"},{"tags":[".net","razor","servicestack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13264349,"title":"Interface as ServiceStack Razor Model","body":"<p>I am relatively new to ServiceStack, but I love what I see so far. However I've come up against a wall on this one - </p>\n\n<p>This is what my razor template looks like - </p>\n\n<pre><code>@inherits ViewPage&lt;IChallenge&gt;\n\n@{\n    foreach (var codeFile in Model.CodeFiles)\n    {\n//do something here\n    }\n}\n</code></pre>\n\n<p>here, IChallenge is an interface, and the service dynamically selects a given implementation of this interface while returning. The service is wired to return Interface itself as so - </p>\n\n<pre><code>public class WebChallenge : IReturn&lt;IChallenge&gt; { /* properties */ }\n</code></pre>\n\n<p>However I get the following error when I run the code - </p>\n\n<p><em>Cannot implicitly convert type 'ServiceStack.Razor.Compilation.RazorDynamicObject' to 'IChallenge'. An explicit conversion exists (are you missing a cast?)</em></p>\n\n<p>with this as the response with the full stack - </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Challenge1Response xmlns=\"\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n&lt;ResponseStatus&gt; \n&lt;ErrorCode&gt;RuntimeBinderException&lt;/ErrorCode&gt; \n&lt;Message&gt;Cannot implicitly convert type 'ServiceStack.Razor.Compilation.RazorDynamicObject' to 'CodeGuru.Exercises.IChallenge'. An explicit conversion exists (are you missing a cast?)&lt;/Message&gt; \n&lt;StackTrace&gt; at CallSite.Target(Closure , CallSite , Object ) \nat System.Dynamic.UpdateDelegates.UpdateAndExecute1[T0,TRet](CallSite site, T0 arg0) \nat ServiceStack.Razor.Templating.TemplateBase`1.get_Model() \nat CompiledRazorTemplates.Dynamic.faaccadc.Execute() \nat ServiceStack.Razor.Templating.TemplateService.ExecuteTemplate[T](T model, String name, String defaultTemplatePath, IHttpRequest httpReq, IHttpResponse httpRes) \nat ServiceStack.Razor.RazorFormat.ExecuteTemplate[T](T model, String name, String templatePath, IHttpRequest httpReq, IHttpResponse httpRes) \nat ServiceStack.Razor.RazorFormat.ProcessRazorPage(IHttpRequest httpReq, ViewPageRef razorPage, Object dto, IHttpResponse httpRes) \nat ServiceStack.Razor.RazorFormat.ProcessRequest(IHttpRequest httpReq, IHttpResponse httpRes, Object dto) \nat ServiceStack.WebHost.Endpoints.Formats.HtmlFormat.&amp;lt;&amp;gt;c__DisplayClass1.&amp;lt;SerializeToStream&amp;gt;b__0(IViewEngine x) \nat System.Linq.Enumerable.Any[TSource](IEnumerable`1 source, Func`2 predicate) \nat ServiceStack.WebHost.Endpoints.Formats.HtmlFormat.SerializeToStream(IRequestContext requestContext, Object response, IHttpResponse httpRes) \nat ServiceStack.WebHost.Endpoints.Extensions.HttpResponseExtensions.WriteToResponse(IHttpResponse response, Object result, ResponseSerializerDelegate defaultAction, IRequestContext serializerCtx, Byte[] bodyPrefix, Byte[] bodySuffix)\n&lt;/StackTrace&gt; \n&lt;/ResponseStatus&gt; \n&lt;/Challenge1Response&gt;\n</code></pre>\n\n<p>This error disappears if I use a specific implementation - however I need to be able to send any implementation selected at runtime. Any ideas?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I noticed that if the Interface is wrapped as a property of another strongly typed object, and that object is used as the model in the view, it works fine and I can access the Interface properties as well. This could be a work-around but I'd like to know if someone knows a better answer, since this feels like jumping through hoops. </p>\n"},{"tags":["c#",".net","asp.net-mvc-3","svn","ssl"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1020,"score":5,"question_id":8121189,"title":"Ignoring invalid SSL certificate","body":"<p>I`m trying to print out log messages from our sub version. But I'm struggling with bypassing the invalid SSL certificate. This is the error:</p>\n\n<blockquote>\n  <p>OPTIONS of\n  'https://xxxxx/svn/SiteFabrics/trunk/AppLaunch/Bloc/Frontend': Server\n  certificate verification failed: certificate issued for a different\n  hostname, issuer is not trusted (https://xxxx)</p>\n</blockquote>\n\n<p>My attempt of ignoring the certificate error was to add this line:</p>\n\n<pre><code>ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n</code></pre>\n\n<p>However that didn't make any difference as the .net error is still the same. Below is the code, can anyone see what I am doing wrong?</p>\n\n<pre><code>        using (SvnClient client = new SvnClient())\n        {\n            Collection&lt;SvnLogEventArgs&gt; list;\n            client.Authentication.DefaultCredentials = new NetworkCredential(\"user\", \"pass\");\n\n            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n\n            SvnLogArgs la = new SvnLogArgs(); //{ Start=128; End=132; };\n            client.LoadConfiguration(Path.Combine(Path.GetTempPath(), \"Svn\"), true);\n            client.GetLog(new Uri(\"https://[svnurl]\"), la, out list);\n            ViewBag.SVNLog = list;\n        }\n</code></pre>\n\n<p>FOUND THE SOLUTION TO THIS PROBLEM:</p>\n\n<p>First add this:</p>\n\n<pre><code>        static void SVN_SSL_Override(object sender, SharpSvn.Security.SvnSslServerTrustEventArgs e)\n    {\n        e.AcceptedFailures = e.Failures;\n        e.Save = true;\n    }\n</code></pre>\n\n<p>and then replace my original magic line:</p>\n\n<pre><code>            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) =&gt; true;\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>client.Authentication.SslServerTrustHandlers += new EventHandler&lt;SharpSvn.Security.SvnSslServerTrustEventArgs&gt;(SVN_SSL_Override);\n</code></pre>\n"},{"tags":["c#","jquery",".net","infragistics","ignite-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1282,"score":1,"question_id":734312,"title":"jQuery Modal Example with .Net 2.0 Infragistics Grid","body":"<p>I'm new to jQuery (I must have had my head buried in sand for the last few years!) and I'm wondering if I could use it with an Infragistics grid for updating and inserting instead of the edit row template. We're currently constrained to using the 2.0 framework, and I'm stuck with the infra grids as well.</p>\n\n<ul>\n<li><p>Does anyone know if this is possible?</p></li>\n<li><p>Do you think this is a bad/good idea?</p></li>\n<li><p>Any good sample/walk-throughs out<br />\nthere?</p></li>\n</ul>\n\n<p>Any, and all, advice/opinions appreciated! </p>\n"},{"tags":["c#",".net","eval","repeater"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13255146,"title":"Can I manage variables on #Eval inside a repeater?","body":"<p>Tried :</p>\n\n<pre><code>string immagine = (Eval(\"Immagine\").ToString());\n</code></pre>\n\n<p>inside a C# repeater .ascx, but seems that I can't? <em>System.InvalidOperationException: Databinding methods such as Eval(), XPath(), and Bind() can only be used in the context of a databound control.</em></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The only way I found is to write :</p>\n\n<pre><code>&lt;%#(Eval(\"Immagine\").ToString() != Eval(\"Immagine\").ToString() ? \"\" : \"\")%&gt;\n</code></pre>\n\n<p>Dunno why it doesnt works with an if/else statement...</p>\n"},{"tags":["java","php",".net","mysql","jsf"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":42,"score":-3,"question_id":13265458,"title":"How to build a standalone application for a dynamic PHP website","body":"<p>Is it possible to build a standalone desktop application to perform the administrator operations of a dynamic website programmed in PHP and uses MySql database. The desktop app should have access to the contents of the database over internet and allow read and write operations. Which platform is better to do this, PHP or .net or Java ?</p>\n"},{"tags":[".net","asp.net-mvc","websync"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13198021,"title":"Websync 4.0 PublisherNotAllowed","body":"<p>I'm having a weird problem with websync 4.0: it works fine on my local machine, but when I deploy to a test server I get this error </p>\n\n<pre><code>System.Exception: Publication failed. result : {\"channel\":\"\\/n\\/95e4d313-27eb-441b-966d-c8630f80ec9a\",\"error\":\"606::Publisher access is disabled. Publisher access can be enabled by setting server[allowPublishers] to true in web.config.\",\"ext\":{\"fm.meta\":{\"ticketID\":\"\"}}}\n</code></pre>\n\n<p>The thing is that I have 2 web applications developed on .net:</p>\n\n<ul>\n<li>one for the website</li>\n<li>one for the websync server</li>\n</ul>\n\n<p>In both web.config files I've added </p>\n\n<pre><code>  &lt;WebSync&gt;\n    &lt;server providerType=\"FM.WebSync.Server.Providers.Sticky.InProcProvider\" httpDirectPublish=\"true\"/&gt;\n  &lt;/WebSync&gt;\n</code></pre>\n\n<p>On localhost (where it works just fine) both IIS applications point to localhost.</p>\n\n<p>From the website project I make a call via javascript to subscribe to a channel, and it works fine on both my machine and the test machine.</p>\n\n<p>But when I try to send a message (and invite both parties to join a private channel) it only works on my local machine (this message sending is done via a http post to a method from the web site server which makes a publish to the websync server thus resulting in that error.)</p>\n\n<p>Any ideas?\nAny help would be much appreciated.</p>\n\n<p>Mihai</p>\n"},{"tags":["c#",".net","image","bitmap"],"answer_count":3,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":12139,"score":13,"question_id":946926,"title":"Image vs Bitmap class","body":"<p>As this is my first post, let me introduce myself, I am Kadrin. I'm a developer at a large corporation in the central United States and have been out of college for about 1 year. </p>\n\n<p>Anyway, I've been reading up on my C# a lot lately (my team is slowly moving over to C#) and am having trouble understanding the differences between the <code>Image</code> class and the <code>Bitmap</code> class. Now I know <code>Bitmap</code> inherits the Image class but from what I understand both are very similar. Can anyone shed some light on this please? </p>\n"},{"tags":[".net","sql-server","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13262277,"title":"How to update central SQL Server database from several local SQL Server databases?","body":"<p>I currently have a central SQL server database that will maintain all records from the growing number of local client SQL server databases. This central server will be used to generate reports etc.</p>\n\n<p>The clients are running a local installation of a .NET web application where they can register and watch videos etc (all stored locally on the client). The web application stores registrations and viewing data in the local SQL server database.</p>\n\n<p>It is not feasible for me to have a full web application which all of these clients can access as we are streaming HD video content to the clients who are concerned about bandwidth. I wish this were possible as it would make my life 10x easier.</p>\n\n<p>I was thinking a windows service which will run on the clients and somehow connect to the central server database and insert all new registrations every hour or so. Or the local web application could insert directly into the central server database. My boss would prefer the local database setup though, which gives us a reliable backup as we can remotely access these databases and manually pull data if we need.</p>\n\n<p>Is this possible? I've read of web services which I think may satisfy my needs.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":[".net","vb.net","literals"],"answer_count":7,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":7065,"score":4,"question_id":799226,"title":"Insert a <br /> tag programmatically (VB.NET)","body":"<p>I'm trying to dynamically add results to this display and I simply want to put a break tag after a label to start putting information on the next line.  For some reason, Using a literal isn't working for me.  Is there a better way to do this or should I just use tables?</p>\n\n<pre><code>Dim break As LiteralControl\nbreak = New LiteralControl(\"&lt;br /&gt;\")\ndivListenerInfo.Controls.Add(break)\n</code></pre>\n\n<p>That's part of the code that I'm attempting to use.\n<hr>\nLet me clarify what I said:</p>\n\n<p>It's not working as in the line break isn't showing up on the webpage.  It's compiling fine and there is nothing wrong with the code.  It just doesn't show up in the html for some odd reason.</p>\n"},{"tags":["c#","asp.net",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":11502803,"title":"Gridview not showing records?","body":"<p>I just attached linq data to gridview it is not showing row ?<br></p>\n\n<blockquote>\n<pre><code>    DataDataContext db = new DataDataContext();\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n            BindData();\n    }\n\n    private void BindData()\n    {\n\n        var source = from n in db.Names\n                     select n;\n\n        gridSample.DataSource = source.ToList&lt;Name&gt;();\n        gridSample.DataBind();'\n    }\n\n\n\n\n    &lt;asp:UpdatePanel ID=\"panelGrid\" runat=\"server\"&gt;\n                        &lt;ContentTemplate&gt;\n                            &lt;asp:GridView runat=\"server\" ID=\"gridSample\" AutoGenerateColumns=\"false\"&gt;\n                                &lt;Columns&gt;\n                                    &lt;asp:TemplateField HeaderText=\"First Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtFirstName\" runat=\"server\" Text='&lt;%Bind(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblFirstName\" Text='&lt;%Eval(\"FirstName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Last Name\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtLastName\" runat=\"server\" Text='&lt;%Bind(\"LastName\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblLastName\" Text='&lt;%Eval(\"LastName\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                                    &lt;asp:TemplateField HeaderText=\"Date of Birth\"&gt;\n                                        &lt;EditItemTemplate&gt;\n                                            &lt;asp:TextBox ID=\"txtDOB\" runat=\"server\" Text='&lt;%Bind(\"DOB\") %&gt;' /&gt;\n                                        &lt;/EditItemTemplate&gt;\n                                        &lt;ItemTemplate&gt;\n                                            &lt;asp:Label runat=\"server\" ID=\"lblDOB\" Text='&lt;%Eval(\"DOB\") %&gt;' /&gt;\n                                        &lt;/ItemTemplate&gt;\n                                    &lt;/asp:TemplateField&gt;\n                             &lt;/Columns&gt;\n                   &lt;/asp:GridView&gt;\n           &lt;/ContentTemplate&gt;\n       &lt;/asp:UpdatePanel&gt;\n</code></pre>\n</blockquote>\n"},{"tags":[".net","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13264489,"title":"Interop.Modi File Not Found Exception","body":"<p>I'am using MODI to get the numbers from captcha picture. The program is running fine on my computer. But in another computer it gives file.not.found exception for interop.modi.</p>\n\n<p>What should I do ?</p>\n"},{"tags":["c#","asp.net",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13264149,"title":"Dll changes or not if i do change in my web.config file","body":"<p>I have UPDATED my web.config code , now i have to send patch for the changed code to be deployed on the production.\nI am not sure that .dll file should be send along with web.config file or not?</p>\n\n<p>if yes then why?\nif not then why?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":13264057,"title":"is there is any globalization issues using '==' operator and string.Equals() method for comparing a string?","body":"<p>Are there any globalization issues using '<code>==</code>' operator and <code>string.Equals()</code> method for comparing a string? If yes what is the solution to avoid this?</p>\n"},{"tags":[".net","crystal-reports"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1676,"score":1,"question_id":903538,"title":"How can show amount in words in crystal report !","body":"<p>I m working on windows form application. I need to show amount in words in crystal report.\nHow can show amount in words in crystal report ?</p>\n"},{"tags":["c#",".net","wpf","xaml","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13263917,"title":"WPF Binding how to get object reference","body":"<p>I have a ListView showing a list of Accounts using MVVM &amp; a custom template and working fine\nNow on clicking the Acct Name, we need to execute a custom action which requires the current Acct object</p>\n\n<p>Is there a way to set the Label.Tag property to the Acct object ?</p>\n\n<p>the xaml def is below\nenv is vs2010 .net 4.0 c#</p>\n\n<pre><code>&lt;ListView Name=\"lv1\" Grid.Column=\"1\" Grid.Row=\"4\"\n    ItemsSource=\"{Binding AccountsList}\"\n    Background=\"Transparent\" BorderThickness=\"0\"&gt;\n    &lt;ItemsControl.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Image Source=\"/asm1;component/Images/Icons/pdf1.png\" Width=\"12\" Height=\"12\" /&gt;\n                &lt;Label Content=\"{Binding Name}\" Margin=\"0,0,25,0\" \n                    ContextMenu=\"{x:Null}\" Name=\"lblacctItem\" \n                    MouseDoubleClick=\"lbl_MouseDoubleClick\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ItemsControl.ItemTemplate&gt;\n    &lt;ListView.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;WrapPanel Background=\"Transparent\" \n                Width=\"{Binding (FrameworkElement.ActualWidth), RelativeSource={RelativeSource AncestorType=ScrollContentPresenter}}\" \n                ItemWidth=\"{Binding (ListView.View).ItemWidth, RelativeSource={RelativeSource AncestorType=ListView}}\" \n                MinWidth=\"{Binding ItemWidth, RelativeSource={RelativeSource Self}}\" \n                ItemHeight=\"{Binding (ListView.View).ItemHeight, RelativeSource={RelativeSource AncestorType=ListView}}\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ListView.ItemsPanel&gt;\n&lt;/ListView&gt;\n</code></pre>\n"},{"tags":["c#",".net","pcap.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13117290,"title":"How to get audio data from rtp packet...?","body":"<p>I'm using .net to do call recroding with pcap.net.</p>\n\n<p>till now I have got the rtp packet. And its length is 32 bytes.</p>\n\n<p>The codec used is G729 and payload type is 18.</p>\n\n<pre><code>byte[] bytes = HexString2Bytes(udp.Payload.ToHexadecimalString());          \nstring rtppayload = ASCIIEncoding.ASCII.GetString(bytes);\n</code></pre>\n\n<p>I need to get the actual rtp payload.\n Plz help me...</p>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc-4","iis-7.5"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13263002,"title":"Is there a way to change .net mvc bin dir location?","body":"<p>I have a fairly standard and simple MVC4 website.</p>\n\n<p>In root dir we have: bin, content, scripts, views. Using default settings the project's DLL, let's call it \"web.dll\" and all the necessary extras go in the bin dir.</p>\n\n<p>Somehow, ASP.NET dev server and IIS7.5 both know to look for \"web.dll\" in the bin folder when hosting the site, and if it's not there they throw error: \"Could not load type 'CVD.Web.MvcApplication'\". The standard solution for that error is to build directly into bin folder, which doesn't work for me because...</p>\n\n<p>For debugging purposes, I'd like to be able to build Debug &amp; Release configurations into into bin/Debug and bin/Release respectively and then deploy both dirs, then change a setting either in IIS, web.config, global.asax, or anywhere else to pick whether Debug or Release build should be loaded and executed by the server.</p>\n\n<p>I haven't been able to find if that's possible or if .net webapps have a silly hard-coded rule saying all code must live in the bin dir.</p>\n"},{"tags":[".net","bulkinsert","dynamic-sql","sql-server-openxml"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13263956,"title":"Bulk insert using sql server openxml with dynamic sql from .Net","body":"<p>I wrote the following procedure to do bulk insert using openxml. The table name and column names are dynamic in my case as they will be created from .Net application just before this below insert. The stored procedure is running successfully but not inserting any data into the table.</p>\n\n<p>Please help me</p>\n\n<p>Thanks in advace.</p>\n\n<pre><code>CREATE PROCEDURE [dbo].[BulkUpdate]\n@XmlDoc text,\n@TableName nvarchar(50),\n@ColumnNames nvarchar(4000),\n@ColumnDefinition nvarchar(4000)\nAS\nBEGIN\n-- SET NOCOUNT ON added to prevent extra result sets from\n-- interfering with SELECT statements.\nSET NOCOUNT ON;\nDeclare @Idoc int;\nDeclare @Sql nvarchar(4000);\nBEGIN TRANSACTION\nBegin Try\nExec sp_xml_preparedocument @Idoc output, @XmlDoc;\n\nSet @Sql = 'Insert into '+@TableName+'('+@ColumnNames+')\n\nSelect '+@ColumnNames+' From OpenXML(@Idoc,''/NewDataSet/Data'', 2)\n\nWith('+@ColumnDefinition+')';\n\nPrint @sql;\nExec @Sql;\n\nExec sp_xml_removedocument @Idoc;\nCommit Transaction\nEnd Try\nBegin Catch\nRollBack Transaction\nEnd Catch\n\nEND\n</code></pre>\n"},{"tags":[".net","webdriver"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3422,"score":0,"question_id":6048276,"title":"How to set Firefox profile using RemoteWebDriver(.Net)","body":"<p>Has the ability to set Firefox profile with RemoteWebDriver (.Net) been deprecated?  Perhaps it was never implemented for .Net.  I've found samples for Java, but I'm not sure how current they are, and there doesn't appear to be method to apply a profile to a remote FirefoxDriver.  Any assistance would be appreciated.</p>\n"},{"tags":["c#",".net","collections","concurrency","thread-safety"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":13096519,"title":"Making a \"modify-while-enumerating\" collection thread-safe","body":"<p>I want to create a thread-safe collection that can be modified while being enumerated.</p>\n\n<p>The sample <code>ActionSet</code> class stores <code>Action</code> handlers. It has the <code>Add</code> method that adds a new handler to the list and the <code>Invoke</code> method that enumerates and invokes all of the collected action handlers. The intended working scenarios include very frequent enumerations with occasional modifications while enumerating.</p>\n\n<p>Normal collections throw exception if you modify them using the <code>Add</code> method while the enumeration is not over. I've created a sample \"recursion-safe\" collection that allows adding new values even while enumerating. If you add new values while the main <code>_actions</code> collection is being enumerated, the values are added to the temporary <code>_delta</code> collection instead of the main one. After all enumerations are finished, the <code>_delta</code> values are added to the <code>_actions</code> collection. If you add some new values while the main <code>_actions</code> collection is being enumerated (creating the <code>_delta</code> collection) and then re-enter the Invoke method again we have to create a new merged collection (<code>_actions</code> + <code>_delta</code>) and replace <code>_actions</code> with it.</p>\n\n<p>So, this collection looks \"recursion-safe\", but I want to make it thread-safe. I think that I need to use the <code>Interlocked.*</code> constructs, classes from <code>System.Threading</code> and other synchronization primitives to make this collection thread-safe, but I don't have a good idea on how to do that.</p>\n\n<p>How to make this collection thread-safe?</p>\n\n<pre><code>class ActionSet {\n    List&lt;Action&gt; _actions = new List&lt;Action&gt;(); //The main store\n    List&lt;Action&gt; _delta; //Temporary buffer for storing added values while the main store is being enumerated\n    int _lock = 0; //The number of concurrent Invoke enumerations\n\n    public void Add(Action action) {\n        if (_lock == 0) { //_actions list is not being enumerated and can be modified\n            _actions.Add(action);\n        } else { //_actions list is being enumerated and cannot be modified\n            if (_delta == null) {\n                _delta = new List&lt;Action&gt;();\n            }\n            _delta.Add(action); //Storing the new values in the _delta buffer\n        }\n    }\n\n    public void Invoke() {\n        if (_delta != null) { //Re-entering Invoke after calling Add:  Invoke-&gt;Add,Invoke\n            Debug.Assert(_lock &gt; 0);\n            var newActions = new List&lt;Action&gt;(_actions); //Creating a new list for merging delta\n            newActions.AddRange(_delta); //Merging the delta\n            _delta = null;\n            _actions = newActions; //Replacing the original list (which is still being iterated)\n        }\n        _lock++;\n        foreach (var action in _actions) {\n            action();\n        }\n        _lock--;\n        if (_lock == 0 &amp;&amp; _delta != null) {\n            _actions.AddRange(_delta); //Merging the delta\n            _delta = null;\n        }\n    }\n}\n</code></pre>\n"},{"tags":[".net","singleton","design-patterns"],"answer_count":9,"favorite_count":0,"up_vote_count":12,"down_vote_count":9,"view_count":1632,"score":3,"question_id":1460907,"title":"Singleton Pattern in .Net is not possible?","body":"<p>I have a  very interesting situation , i have figured out that Singleton pattern is not all possible with .net framework (Any version)</p>\n\n<p>look at this code below</p>\n\n<pre><code>namespace SingletonPattern\n{\n    class Singleton\n    {\n    private static readonly Singleton instance = new Singleton();\n    private static int mcount = 0;\n\n    private Singleton() {\n\n        mcount += 1;\n        Console.WriteLine(\"Creating {0} instances of Singleton Class\", mcount.ToString());\n    }\n\n    public static Singleton Instance\n    {\n        get\n        {\n            return instance;\n        }\n    }\n}\n\nclass program\n{\n    static void Main()\n    {\n        for (int i = 0; i &lt; 1000; i++)\n        {\n            System.Activator.CreateInstance(Type.GetType(\"SingletonPattern.Singleton\"), true);\n        }\n\n        Console.ReadLine();\n\n\n        }\n    }\n}\n</code></pre>\n\n<p>with the help of System.activator any buddy can break singleton pattern. </p>\n\n<p>so who's at risk ?</p>\n\n<p>any guy who wrote some licensing component where license is implemented as a singleton pattern.</p>\n\n<p>Any server based code which makes use of Singleton pattern.</p>\n\n<p>Maybe I am wrong or my discovery does not make sense but i just wanna share and want to know your views?</p>\n"},{"tags":[".net","windows-8","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":520,"score":0,"question_id":10634012,"title":"Quickstart on Windows 8 tablet","body":"<p>I want to develop application for windows 8 tablet. I now have:</p>\n\n<ol>\n<li>Windows 8 consumer preview machine</li>\n<li>VS studio 2011</li>\n</ol>\n\n<p>And I'd like to know:</p>\n\n<ul>\n<li>Where do I start?</li>\n<li>Do the applications developed for windows 8 desktop will be used as it is in windows 8 tablets?</li>\n<li>Where can I get emulater kind of thing to test them?</li>\n<li>Can I have some hello world sample for windows 8 tablet application. I did it for windows 8 desktop but will it work as it is on tab?</li>\n<li>What is the difference in development environment I need to use WInRT where this WINRT comes in picture? </li>\n<li>When I select new metrostyle application, will it automatically switch to winrt instead of .net?</li>\n</ul>\n\n<p>There is lot of confusion for winrt vs .net (when we actually start working on VS 2011 on consumer preview)</p>\n"},{"tags":[".net","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":345,"score":2,"question_id":5652622,"title":"Using reflection to get a nested property value","body":"<p>I have the following scenario:</p>\n\n<pre><code>class A\n{\n   string Foo;\n}\n\nClass B\n{\n   A PropertyA;\n}\n\nClass C\n{\n   B PropertyB;\n}\n</code></pre>\n\n<p>Is it possible using .NET reflection to get the value of A.Foo if I start with object C? The problem I am running into is this:\nI get to A through PropertyInfo objects. However, they don't have the instance information stored with them. Therefore, I can't do GetProperty(\"Foo\").GetValue(....) since I only have object of type C passed in.</p>\n"},{"tags":["c#",".net","silverlight","xaml","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12812670,"title":"Critical Viewer Error - Cannot Load XAML Resource","body":"<p>I have a silverlight application and it works completely fine in VS2010 then when I upload it to IIS7 and try to browse it I get an error saying</p>\n\n<p>\"An error occurred during initialization and the Viewer could not be started. This may be due to network connectivity problems, viewer configuration problems, or site configuration problems\" </p>\n\n<p>Further details of the error are:</p>\n\n<p>\"Cannot load Xaml resource from /config/themes/map/map.xaml.\"</p>\n\n<p>If I navigate to the folder where it says that it cannot load it I can see that it is there and that it looks to be in the correct formatting(as it should be if it was working on my local machine). So I thought maybe permissions were stopping it so I checked that and there are sufficint permissions to access the file. </p>\n\n<p>Does anyone know what might be causing this error and how to fix it?</p>\n"},{"tags":[".net","azure","continuous-integration","sql-azure"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13257602,"title":"Azure continuous integration with SQL migrations","body":"<p>There is a nice article <a href=\"http://www.windowsazure.com/en-us/develop/net/common-tasks/continuous-delivery/\" rel=\"nofollow\">here</a> describing how to implement continuous integration on Azure.</p>\n\n<p>But what if we have to update SQL schema of an SQL Azure instance that is used by multiple service roles as a part of deployment?</p>\n\n<p>What is the best approach for managing this?\nShould the service be stopped while migration is in progress? How to implement it with cmdlets?</p>\n\n<p>P.S. for SQL migrations we prefer to use FluentMigrator.</p>\n"},{"tags":["c++",".net","c","winapi","browser"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13098801,"title":"browser helper object in c++","body":"<p>i am new to win api ,this is what i was using in my code </p>\n\n<p><code>SINK_ENTRY_EX(1, DIID_DWebBrowserEvents2, DISPID_DOCUMENTCOMPLETE, OnDocumentComplete)</code></p>\n\n<p>this is perfectly working</p>\n\n<p><strong>note</strong> :</p>\n\n<p><code>OnDocumentComplete</code>-function pointer </p>\n\n<p><code>DISPID_DOCUMENTCOMPLETE</code> --display id (call the function pointed by function pointer when this event occur)</p>\n\n<p>i just tried the below one which will call the event on changing status bar of browser hide or appear but its not working .</p>\n\n<p><code>SINK_ENTRY_EX(1, DIID_DWebBrowserEvents2, DISPID_ONSTATUSBAR,OnDocumentComplete)</code></p>\n\n<p>can any body tell me what's wrong with this?</p>\n"},{"tags":["c#",".net","templates","ms-word","template-engine"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13195973,"title":"What template engines are there that allow creating templates in Microsoft Word?","body":"<p>In a project I'm working on we will (most likely) need the following feature: the user uploads a word document (can be limited to DOCX, I believe), that is a template with placeholders. The system then takes this document, fills in the placeholders with data, and produces a final word document (and optionally also converts it to a PDF).</p>\n\n<p>In the worst case I can dig through the bowels of DOCX myself, we did this with XLSX in another project (using the low-level library Microsoft provides), but it was quite painful, and I wonder if there is something premade.</p>\n\n<p><strong>Added:</strong> Completely forgot - we're working in Visual Studio 2012, C# 4.5.</p>\n"},{"tags":[".net","vb.net","asp.net-mvc-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13263112,"title":"Debugging and Models in VB.NET 2012 MVC 4","body":"<p>In the following example, the <code>request</code> for the <code>\"color name\"</code> is done to a <code>POST method</code> - where after the successful <code>request,</code> the color name should get <code>printed out</code>. </p>\n\n<pre><code>Public Class ColorPrintOutSubmitClassController\n            Inherits System.Web.Mvc.Controller\n\n            ' This method will handle GET\n            Function PrintOutPage() As ActionResult\n                Return View(\"PrintOutPage\")\n            End Function\n\n            ' This method will handle POST\n            &lt;HttpPost&gt;\n            Function ColorPrintOut() As ActionResult\n                ' Do something\n                Response.Write(\"You submitted the color: \" &amp; Request.QueryString(\"ColorName\") &amp; \"&lt;br /&gt;\")\n                Return View()\n            End Function\n        End Class\n</code></pre>\n\n<h2>The First Question:</h2>\n\n<p>It is common in PHP to check the \"methods\" individually by giving the method a value, and have it return.</p>\n\n<ul>\n<li>How can the same be done in the scenario above, so that there's no uncertainty, if the methods are working, as applied?</li>\n</ul>\n\n<h2>The Second Question:</h2>\n\n<ul>\n<li>How can I have the <code>class</code> be <code>invoked</code>, by the <code>models</code> part of the MVC system, after the submit button is pressed?</li>\n</ul>\n\n<p>With my PHP experience, I tend to think of - <em>one, single page</em> - being scanned with each line.</p>\n"},{"tags":["c#",".net","smtp","smtpclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13260772,"title":"SmtpException: The client or server is only configured for e-mail addresses with ASCII local-parts","body":"<p>The <a href=\"http://msdn.microsoft.com/en-us/library/swas0fwc.aspx\" rel=\"nofollow\">SmtpClient.Send()</a> method is throwing this exception when I try to send an email to an address containing an accentuated character (é):</p>\n\n<blockquote>\n  <p>System.Net.Mail.SmtpException: The client or server is only configured\n  for e-mail addresses with ASCII local-parts: léo.xxx@xxx.com.<br>\n    at System.Net.Mail.MailAddress.GetAddress(Boolean allowUnicode)<br>\n    at System.Net.Mail.SmtpClient.ValidateUnicodeRequirement(MailMessage...)<br>\n    at System.Net.Mail.SmtpClient.Send(MailMessage message)  </p>\n</blockquote>\n\n<p>The formulation of the message makes me thing there might be a setting that I can activate to make this work, though I haven't found anything on this subject.</p>\n\n<p>I have tried several SMTP servers, including Gmail. Here are the relevant bits for a repro:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>var msg = new MailMessage();\nmsg.Subject = \"Test\";\nmsg.From = new MailAddress(\"xxx@gmail.com\");\nmsg.To.Add(new MailAddress(\"léo.yyy@gmail.com\"));\n\nnew SmtpClient().Send(msg);\n</code></pre>\n\n<p><strong>app.config</strong></p>\n\n<pre><code>&lt;system.net&gt;\n    &lt;mailSettings&gt;\n        &lt;smtp from=\"xxx@gmail.com\"&gt;\n            &lt;network host=\"smtp.gmail.com\" port=\"587\" userName=\"xxx@gmail.com\" password=\"password\" enableSsl=\"true\" /&gt;\n        &lt;/smtp&gt;\n    &lt;/mailSettings&gt;\n&lt;/system.net&gt;\n</code></pre>\n\n<p>Would appreciate any pointers. Thanks.</p>\n"},{"tags":["c#",".net","spellchecking","stylecop"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":114,"score":2,"question_id":12682642,"title":"Specify path to CustomDictionary file for StyleCop spellchecking","body":"<p>Spell checking of the comments was added to the recent versions of StyleCop. It seems I can reuse my existing CustomDictionary file (that I created for FxCop) with StyleCop. SA1650 rule <a href=\"http://www.stylecop.com/docs/SA1650.html\" rel=\"nofollow\">documentation</a> does not say that it is possible. But in <a href=\"http://stylecop.codeplex.com/downloads/get/386813\" rel=\"nofollow\">release notes</a> for version 4.7.39 I see </p>\n\n<blockquote>\n  <p>Add support for specifying dictionary folders in the settings.StyleCop\n  file.</p>\n</blockquote>\n\n<p>How do I configure StyleCop to search for this file in the root folder of my solution?</p>\n"},{"tags":["c#",".net","multithreading","architecture","software-engineering"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13261769,"title":"Best architecture to set a realtime logging window to write from different threads like output window in visualstudio","body":"<p>I am designing an application and it runs different components each on a different thread. I need a way to report back to the user interface the state of those components and the tasks they complete and if any errors occurred. My first approach was to write from all the different components to a log file. And then I monitored that file for changes, to reload the changes in a text box (my output window). However I noticed that using file monitor does not perform very well, and it slows downs the component threads and their tasks. So I was thinking to create something like the output windows in vs2010, where they can log any data while debugging, it seems to be very efficient, and can hold a lot of data. Any ideas what would be the best approach? One important fact, is that there should be a way to communicate all the component threads with the logging output window, to display results, avoid collisions, etc. I am using .NET 4.0</p>\n"},{"tags":[".net","c#-4.0","design","linq-to-sql"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12135895,"title":"Is it worth putting a business logic layer on top of Linq to SQL?","body":"<p>I feel like I may be doing something dumb.</p>\n\n<p>I've had a Linq to SQL library running for years, and used it in several applications that use the same database.  There are a bunch of things I'm not terribly happy with though, and I just got a new project.  I was thinking that it would be helpful to put a business logic layer between the application and the Linq to SQL library.  The problem is the more I design it out, the more it looks like I'm just trying to implement something that looks just like  Linq to SQL.</p>\n\n<p>For instance, I decided that the application should have a single entry point to the business logic.  So that entry point (I called it MCP) has a property for class in the system, and this property has a \"list\" (probably IQueryable) that contains all the objects from the corresponding table.  Which starts sounding, and looking, a lot like a Linq to SQL data context...plus I feel like having an extra object/accessor wrapped around every existing object is a ton of extra typing just to hide the \"real\" objects.</p>\n\n<p>So because of that I'm a little afraid I'm just doing a bad re-implementation of what I already have.</p>\n\n<p>On the flip-side, I am hopefully improving on how everything works.  For instance ensuring that an object has one logical responsibility, rather than it being a way of accessing anything else in the system.  (For instance a CarCP might have a method for AddDriver(Person p) but Person wouldn't necessarily have methods to go back to CarCP.)</p>\n\n<p>So maybe it is better to have this middle layer, but I'm just designing it badly?  </p>\n"},{"tags":["c#",".net","reference-type","idictionary"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":99,"score":4,"question_id":13262106,"title":"Dictionary.ContainsKey() - How does it work?","body":"<p>I've read the MSDN documentation on how <code>Dictionary.ContainsKey()</code> works, but I was wondering how it actually makes the equality comparison? Basically, I have a dictionary keyed to a reference type* and I want the <code>ContainsKey()</code> method to check a certain property of that reference type as its basis for determining if the key exists or not. For example, if I had a <code>Dictionary(MyObject, int)</code> and <code>MyObject</code> has a public property (of <code>int</code>) called \"TypeID\", could I get <code>ContainsKey(MyObject myObject)</code> to check to see if one of the keys has a <code>TypeID</code> that is equal to <code>myObject</code>? Could I just overload the <code>==</code> operator?</p>\n\n<ul>\n<li>The reference type is an object called \"Duration\" which holds a value (<code>double Length</code>); \"Duration\" is a base type used in my music program to denote how long a particular sound lasts. I derive classes from it which incorporate more sophisticated timing concepts, like Western musical time signatures, but want all of them to be comparable in terms of their length.</li>\n</ul>\n\n<p>EDIT: As suggested, I implemented IEquitable on my object like so:</p>\n\n<pre><code> public class Duration : IEquatable&lt;Duration&gt;\n {\n    protected double _length;\n\n    /// &lt;summary&gt;\n    /// Gets or Sets the duration in Miliseconds.\n    /// &lt;/summary&gt;\n    public virtual double Length\n{\n        get\n        {\n            return _length;\n        }\n        set\n        {\n            _length = value;\n        }\n    }\n\n// removed all the other code that as it was irrelevant\n\n    public override bool Equals(object obj)\n    {\n        Duration otherDuration = (Duration)obj;\n        if (otherDuration._length == _length)\n        {\n            return true;\n        }\n        else\n        {\n            return false\n        }\n    }\n\n}\n</code></pre>\n\n<p>Is this all I need to do?</p>\n"},{"tags":["asp.net",".net","exception-handling","scriptmanager"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1245,"score":3,"question_id":8517136,"title":"Script control is not a registered script control","body":"<p>I have a page that uses <code>CustomerDetails.ascx</code>. It uses <code>CM.ascx</code>. Inside <code>CM.ascx</code> I use <a href=\"http://ajaxdatacontrols.codeplex.com/\" rel=\"nofollow\">AJAX Data Controls</a> GridView with <code>ID=\"gdvRecommendation\"</code>.</p>\n\n<p>Sometimes when I browse to the page I get the following exception:</p>\n\n<blockquote>\n  <p>Script control 'gdvRecommendation' is not a registered script control. Script controls must be registered using RegisterScriptControl() before calling RegisterScriptDescriptors().</p>\n  \n  <p>Parameter name: scriptControl</p>\n</blockquote>\n\n<ol>\n<li>My ScriptManager defined in the master page before the content place holder.</li>\n<li>This exception doesn't happened always.</li>\n<li>I use <code>CustomerDetails.ascx</code> user controls in other pages and it works great.</li>\n</ol>\n\n<p>Can anyone explain me the problem and what can be the solution?</p>\n\n<p><strong>Edit:</strong><br>\nHere is the GridView usage in <code>CM.ascx</code>:</p>\n\n<pre><code>&lt;td valign=\"top\" style=\"height: 150px;\"&gt;\n            &lt;div id=\"divCMMessage\"&gt;&lt;/div&gt;\n            &lt;div id='divRecommendation' style=\"width: 100%; display: inline; overflow: auto;\"&gt;\n                &lt;ADC:GridView ID=\"gdvRecommendation\" Width=\"100%\" runat=\"server\" CellSpacing=\"0\" CellPadding=\"3\" HorizontalAlign=\"Right\" ShowHeader=\"false\" RowDataBoundEvent=\"onRowDataBound_gdvRecommendation\"&gt;\n                    &lt;RowStyle Height=\"20px\" /&gt;\n                    &lt;EmptyDataTemplate&gt;no recommendations&lt;/EmptyDataTemplate&gt;\n                    &lt;EmptyDataRowStyle HorizontalAlign=\"Right\" BorderWidth=\"0\" /&gt;\n                    &lt;Columns&gt;\n                        &lt;ADC:GridViewImageColumn DataImageUrlField=\"IndImageUrl\" HeaderText=\"\" ItemStyle-Width=\"25px\" ItemStyle-HorizontalAlign=\"Center\"&gt;&lt;/ADC:GridViewImageColumn&gt;\n                        &lt;ADC:GridViewTemplateColumn HeaderText=\"\"&gt;\n                            &lt;ItemTemplate&gt;\n                                &lt;asp:Label ID=\"TreatName\" runat=\"server\" Text=\"\"&gt;&lt;/asp:Label&gt;\n                            &lt;/ItemTemplate&gt;\n                        &lt;/ADC:GridViewTemplateColumn&gt;\n                        &lt;ADC:GridViewTemplateColumn HeaderText=\"\"&gt;\n                            &lt;ItemTemplate&gt;\n                                &lt;asp:Label ID=\"TreatType\" runat=\"server\" Text=\"\"&gt;&lt;/asp:Label&gt;\n                            &lt;/ItemTemplate&gt;\n                        &lt;/ADC:GridViewTemplateColumn&gt;\n                    &lt;/Columns&gt;\n                &lt;/ADC:GridView&gt;\n            &lt;/div&gt;\n        &lt;/td&gt;\n</code></pre>\n\n<p>The <code>CustomerDetails.ascx</code> is inside a MultiView (on MyPage.aspx).</p>\n"},{"tags":[".net","mysql","sql-server-2008"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":11840161,"title":"Efficient way to calculate value mathematical functions on DB data","body":"<p>In .net application, either window or web application, </p>\n\n<p>To perform different mathematical functions like sqrt, maximum,minimum,avg,count on larger amount of data. \nUsing stored procedures or normal program logic using iteration. which is the best way for doing this?</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":1100,"score":-1,"question_id":9096078,"title":"How to download a file to a specific path in from a given url in a windows form?","body":"<p>I need to download pdf files from a specified links(url) to a specific folder in a windows application using winforms please any one can suggest me with a solution.</p>\n"},{"tags":["c#",".net","httpwebrequest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13261046,"title":"Executing web requests inside of a loop only works on the first pass","body":"<p>I am taking a string message and breaking it up into chunks so that I can send it to an sms service (that consequently doesn't break it up for you). I after I do my work for break those messages up, I try loop through the resulting array and execute a web request. The problem is that it only works for the first message, and then hangs after that. After a short time, I get an error message saying \"The connection was closed unexpectedly.\" This occurs at the second time it attempts GetResponse(); I've seen a few other posts on here that were simply saying to close and dispose the response and request streams. This isn't working for me at all. This is where my code is currently:</p>\n\n<pre><code>private static void Main(string[] args)\n{\n    var oldMessage = GetFileString();\n    Console.WriteLine(string.Format(\"Old message: {0}\", oldMessage.Length));\n\n    var newMessage = UrlPathEncodeString(oldMessage);\n    Console.WriteLine(string.Format(\"New message: {0}\", newMessage.Length));\n\n    var brokenUp = SplitByLength(newMessage, 145).ToArray();\n    for(var i = 0; i &lt; brokenUp.Count(); i++)\n    {\n        brokenUp[i] = brokenUp[i].Insert(0, UrlPathEncodeString(string.Format(\"({0:D2} of {1:D2})\", i + 1, brokenUp.Count())));\n        Console.WriteLine(string.Format(\"Appended length: {0}\", brokenUp[i].Length));\n    }\n\n    System.Net.ServicePointManager.DefaultConnectionLimit = 100;\n    foreach (var block in brokenUp)\n    {\n        Thread.Sleep(1500);\n        SendSms((HttpWebRequest)WebRequest.Create(\"http://172.20.5.214:90/method/sendsms\"), block);\n    }\n    Console.ReadKey();\n}\n\npublic static void SendSms(HttpWebRequest request, string message)\n{\n    //build the request\n    var url = \"http://ipaddress/method/sendsms\";\n    //var request = (HttpWebRequest)WebRequest.Create(url);\n    request.Method = \"POST\";\n    request.ContentType = \"application/x-www-form-urlencoded\";\n\n    var fields = \"CellNumber={0}&amp;Message={1}\";\n    fields = string.Format(fields, \"16021234567\", message);\n\n    var fieldsBytes = Encoding.UTF8.GetBytes(fields);\n    request.ContentLength = fieldsBytes.Length;\n    var length = fieldsBytes.Length;\n\n    using (var requestStream = request.GetRequestStream())\n    {\n        requestStream.Write(fieldsBytes, 0, length);\n\n        using (var response = request.GetResponse())\n        {\n            using (var responseStream = response.GetResponseStream())\n            {\n                responseStream.Close();\n            }\n        }\n        requestStream.Close();\n    }\n}\n\npublic static byte[] ReadFully(Stream stream)\n{\n    var buffer = new byte[32768];\n    using (var ms = new MemoryStream())\n    {\n        while (true)\n        {\n            int read = stream.Read(buffer, 0, buffer.Length);\n            if (read &lt;= 0)\n                return ms.ToArray();\n            ms.Write(buffer, 0, read);\n        }\n    }\n}\n</code></pre>\n"},{"tags":[".net","json","wcf","frameworks","aspnet-regiis.exe"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":36,"score":4,"question_id":13261887,"title":"Invalid JSON being randomly returned by WCF","body":"<p>I am running an ASP.Net app on Windows Server 2008 R2. I have up to .NET Framework 4.5 installed. Upon migrating from .NET Framework v2.0 to v4.0 I began to experience random behavior from WCF. </p>\n\n<p>My web service returns JSON. Upon restarting IIS the service will return perfectly valid JSON about 3 to 5 times. After that, the JSON becomes invalid. I have inspected what is coming across the wire via Fiddler and also my own logs on both client app (an Adobe AIR app that calls the service) and on the server itself. </p>\n\n<p>Fiddler shows that the raw response does in fact contain invalid JSON. It appears very much that a some random point in the JSON the response JSON begins to get written out again!, overwriting what should be there and producing mangled JSON in the process. </p>\n\n<p>See this concatenated example:</p>\n\n<pre><code>{\"responseCode\":0,\"actionCode\":\"OK\",\"cdn{\"responseCode\":0, \"actionCode\".....\n</code></pre>\n\n<p>Note how \"responseCode\" (which should only appear at the beginning of the JSON response) suddenly appears again in the JSON further on. <code>\"cdn{\"responseCode\":0</code> is of course invalid JSON.</p>\n\n<p>I have tried numerous patches. I've tried running <em><code>ServiceModelReg.exe</code></em> and <em><code>aspnet_regiis.exe</code></em> from under different frameworks and in different combinations. Same behavior. If I revert to previous code under v2.0 and switch the App Pool back to v2.0 then everything works fine.  </p>\n\n<p>I believe this to be a bug deep in WCF. Any ideas? </p>\n\n<p>The only recourse I have at this point is to rip out WCF and switch to something like ServiceStack where I can debug into all the code if necessary.   </p>\n"},{"tags":[".net","com","unmanaged","typelib","clsid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13254013,"title":"Create .NET project references to two COM components when only the CLSIDs differ?","body":"<p>Brief:</p>\n\n<p>How can I create two references in a .NET project to two ummanaged COM components that are identical except for their CLSID? They have the same ProgID, and the same Type Lib. </p>\n\n<p>The Type Lib is what Visual Studio complains about when I attempt to create the second reference:</p>\n\n<blockquote>\n  <p><em>A reference to 'XXX Type Library' could not be added. A reference to this type library already exists.  You must remove the reference 'XXX'\n  before adding this one.</em></p>\n</blockquote>\n\n<p>Thanks in advance.</p>\n\n<hr>\n\n<p>Detailed:</p>\n\n<p>I am creating a WPF application that provides integration with another application. The other application is a bit unusual in that its versions install as separate applications. Users can have multiple versions of the application running side by side on their computer.  </p>\n\n<p>My single WPF application is supposed to allow users to select the version of this other application they would like to work with. The other application has an unmanaged COM DLL for each version installed that I use to create the integration between my WPF app and this other application.</p>\n\n<p>My WPF application has been working fine with the first version of the other application using a reference to the unmanaged COM component of version 1. The trouble starts when I try to reference the COM component of the second version. </p>\n\n<p>I get the following error when I use “Add Reference” on the WPF project:\n<em>A reference to 'XXX Type Library' could not be added. A reference to this type library already exists.  You must remove the reference 'XXX' before adding this one.</em></p>\n\n<p>An examination of the registry indicates that the only differences in the registry information for the two versions of the COM component are the CLSD and the path to the actual DLL. The ProgID and the TypeLib values are the same across both components.  </p>\n\n<p>As the versions of the other application are really treated as separate applications I would prefer the COM components to be installed as different applications and I’m working with company on the next release.</p>\n\n<p>For now I’m stuck trying to get version 2 integrated into my WPF application. I’ve seen many posts about  <em>extern alias</em> and how to manually edit the project file to introduce aliases, but they all seem to start with managed assemblies and not unmanaged COM components. The contents of the project file are different for referenced unmanaged COM components and as I can’t create the second reference, adding an <em>aliases</em> tag to the references in the project files doesn’t help me. </p>\n\n<p>I’ve seen people talking about using System.Addin and reflection but I wanted to confirm there isn’t a more straightforward approach before investigating more complex approaches.</p>\n\n<p>Thanks for reading this far!</p>\n\n<hr>\n\n<p>Following CasperOne's advise I did the following:</p>\n\n<ol>\n<li>Ran the following using Visual Studio Command Prompt: <em>tlbimp \"c:\\xxx1.dll\" /out:\"c:\\NETxxx1.dll\"</em></li>\n<li>Ran the following using Visual Studio Command Prompt: <em>tlbimp \"c:\\xxx2.dll\" /out:\"c:\\NETxxx2.dll\"</em></li>\n<li>Added both newly created DLLs (Interop's I guess) as references to my test project. I used the 'Browse\" tab to find them.</li>\n<li>I added code that pretty much followed casperOne's code sample.</li>\n</ol>\n\n<p>I had a bit of a panic about what name to use for my COM interface. In the case of the COM object I'm using, there is one main interface object, and all other objects that I use from that COM object are instantiated from within that main interface object (I.E. I make calls like: Foo x = y.GetNewFoo();).</p>\n\n<p><pre></p>\n\n<code>using X1 = NETXXX1; \nusing X2 = NETXXX2;\n\nGuid clsid1 = new Guid(\"xxx...\"); \nType type1 = Type.GetTypeFromCLSID(clsid1); \nX1.IApplication a1 = (X1.IApplication)Activator.CreateInstance(type1); \nX1.FooList f1 =a1.GetFooList();\n\nGuid clsid2 = new Guid(\"yyy...\"); \nType type2 = Type.GetTypeFromCLSID(clsid2); \nX2.IApplication a2 = (X2.IApplication)Activator.CreateInstance(type2); \nX2.FooList f2 = a2.GetFooList();\n\nforeach(X1.Foo f in f1) Console.WriteLine(f.Name);\nConsole.WriteLine(\"*****\"); \nforeach(X2.Foo f in f2) Console.WriteLine(f.Name);\n</code></pre>\n\n<p></p>\n"},{"tags":["c#",".net","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13261314,"title":"Windows Forms controls decoration","body":"<p>I am new to C# and I am trying to build my own simplified Windows Explorer. I want to apply Windows theme to decorate treeview and listview. I cam accross this great <a href=\"http://stackoverflow.com/questions/3014816/visualstylerenderer-and-themes-winforms\">link</a>, but have no idea how to attach these to my treeview. I am looking for detailed answer. As far, I understood only that I need to set DrawMode to OwnerDrawAll. What is next?</p>\n"},{"tags":["c#",".net","sockets"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13261625,"title":"One server many clients: Threads or classes","body":"<p>I'm doing an application in C#, with a server and some clients (not more than 60), and I would like to be able to deal with each client independently. The communication between server and client is simple but I have to wait for some ack's and I don't want to block any query.</p>\n\n<p>So far, I've done two versions of the server side, one it's based on this:</p>\n\n<p><a href=\"http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html\" rel=\"nofollow\">http://aviadezra.blogspot.com.es/2008/07/code-sample-net-sockets-multiple.html</a></p>\n\n<p>and in the other one, I basically create a new thread for each client. Both versions work fine...but I would like to know pros and cons of the two methods.</p>\n\n<p>Any programming pattern to follow in this sort of situation?</p>\n"},{"tags":["c#","asp.net",".net","wcf","iis7"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13261184,"title":"How to open service port?","body":"<p>I'm getting an error code 10061 when calling a WCF service.  The error is </p>\n\n<blockquote>\n  <p>Could not connect to <code>&lt;service uri</code>>.  The connection attempt lasted for a time span of   xxxx.  TCP error code 10061.  No connection could be made because the target machine actively refused it.</p>\n</blockquote>\n\n<p>When I do a </p>\n\n<pre><code>netstat -a\n</code></pre>\n\n<p>I don't see that the port this net.tcp service address should be on is listening.  In IIS, the website this service is under has started.  Any ideas why the port isn't listed in TCP as listening or how I can get it to listen?</p>\n"},{"tags":["c#",".net","httpwebresponse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13261209,"title":"POST format in C#","body":"<p>I have just tried to use post method to send data by HTTPWebresponse but failed. And after I capture the packet, I see lots of data and I totally have no idea which data should be put into POST method. Thank you if anyone could help.</p>\n\n<pre><code>//The following is the packet\n//POST\n   //forum.php?mod=post&amp;action=reply&amp;fid=830&amp;tid=28827301&amp;extra=&amp;replysubmit=yes&amp;infloat=yes&amp;handlekey=fastpost&amp;inajax=1\n  //HTTP/1.1\n  //Accept: text/html, application/xhtml+xml,*/*\n  /*DNT: 1w\n    Referer:http://bbs.down.com/forum.php?mod=viewthread&amp;tid=28827301&amp;page=6\n    Accept-Language: en-US\n    User-Agent: Mozilla/5.0 (compatible; MSIE9.0; Windows NT 6.1; WOW64; Trident/5.0)\n    Content-Type:application/x-www-form-urlencoded\n    Accept-Encoding: gzip, deflate\n    Host: bbs.down.com\n    Content-Length: 59\n    Connection: Keep-Alive\n    Cache-Control: no-cache\n    Cookie: bbs_4477_sid=M1hwrW;\n    bbs_4477_saltkey=1mpZc0Gt; bbs_4477_lastvisit=1351433237;\n    bbs_4477_lastact=1352031022%09forum.php%09viewthread; bbs_4477_forum_lastvisit=D_830_1352030887;\n    bbs_4477_visitedfid=830; bbs_4477_cookietime=1;\n    bbs_4477_auth=3ef7t9KNHlw%2FlGabIXi8MPMY1w5V9EnFvg6jP%2B%2Braqfkg2jvHw;\n    bbs_4477_ulastactivity=f0afkWeLyCDn8PKlB9iw%2FP3PfnFF%2FgqqZ%2BVmQ5a%2FJBkQccZl5eF8;\n    bbs_4477_smile=1D1; bbs_4477_forum_lastpage=830_1; bbs_4477_sendmail=1;\n    bbs_4477_noticeTitle=1; hiido_ui=0.7695972212533371;\n    bbs_4477_fid830=1351953302;\n    Hm_lvt_0475e9919a7ba48887772bb84a8dd9e9=1325583818951;\n    Hm_lvt_899fe607527b6d40d67e743dc3f660e0=1351913248569,1351932413330,1351950688149,1352030891869;\n    Hm_lpvt_899fe607527b6d40d67e743dc3f660e0=1352031022847\n\n    message=test&amp;posttime=1352031022&amp;formhash=ca66c950&amp;subject=*/\n//the following is the code\n        private void button1_Click(object sender, EventArgs e)\n        {\n            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(\"http://bbs.down.com/forum.php?mod=post&amp;action=reply&amp;fid=830&amp;tid=28827301&amp;extra=&amp;replysubmit=yes&amp;infloat=yes&amp;handlekey=fastpost&amp;inajax=1\");  \n            request.CookieContainer = new CookieContainer();  \n            CookieContainer cookie = request.CookieContainer;\n            request.Referer = \"http://bbs.down.com/forum.php?mod=viewthread&amp;tid=28827301&amp;page=6\";\n            request.Accept = \"Accept:text/html, application/xhtml+xml, */*\";  \n            request.Headers[\"Accept-Language\"] = \"en-US\";\n            request.UserAgent = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\";  \n            request.KeepAlive = true;  \n            request.ContentType = \"application/x-www-form-urlencoded\";  \n            request.Method = \"POST\";\n            request.Host = \"bbs.down.com\";\n            Encoding encoding = Encoding.UTF8; \n            byte[] postData = encoding.GetBytes(\"message=test&amp;posttime=1351953229&amp;formhash=ca66c950&amp;subject=\");\n            request.ContentLength = postData.Length;  \n            Stream requestStream = request.GetRequestStream();  \n            requestStream.Write(postData, 0, postData.Length);  \n            HttpWebResponse response = (HttpWebResponse)request.GetResponse();  \n            Stream responseStream = response.GetResponseStream();  \n            if (response.Headers[\"Content-Encoding\"] != null &amp;&amp; response.Headers[\"Content-Encoding\"].ToLower().Contains(\"gzip\"))  \n            {  \n                responseStream = new GZipStream(responseStream, CompressionMode.Decompress);  \n            }  \n\n            StreamReader streamReader = new StreamReader(responseStream, encoding);  \n            string retString = streamReader.ReadToEnd();  \n            streamReader.Close();  \n            responseStream.Close();  \n\n            //return retString;  \n</code></pre>\n"},{"tags":[".net","vb.net","asp.net-mvc-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13260929,"title":"$_POST['color'] for VB.NET 2012 MVC 4?","body":"<p>Through an input field the color \"green\" is submitted.</p>\n\n<p>Now, it takes requesting <strong>it</strong>.</p>\n\n<p>In PHP it would be <code>$_POST['color']</code>.</p>\n\n<p>I have thought it through, and have gotten it to this code:</p>\n\n<p><hr /></p>\n\n<h2>The Example:</h2>\n\n<p><strong>The Request for the ColorName - with VB.NET 2012 MVC 4:</strong></p>\n\n<pre><code>    Public Class ColorPrintOutSubmitClassController\n        Inherits System.Web.Mvc.Controller\n\n        ' This method will handle GET\n        Function PrintOutPage() As ActionResult\n            Return View(\"PrintOutPage\")\n        End Function\n\n        ' This method will handle POST\n        &lt;HttpPost&gt;\n        Function ColorPrintOut() As ActionResult\n            ' Do something\n            Response.Write(\"You submitted the color: \" &amp; Request.QueryString(\"ColorName\") &amp; \"&lt;br /&gt;\")\n            Return View()\n        End Function\n    End Class\n</code></pre>\n\n<p><strong>The HTML:</strong></p>\n\n<pre><code>    &lt;form action=\"\" method=\"post\"&gt;\n    &lt;input type=\"text\" name=\"ColorName\" /&gt;\n    &lt;input type=\"submit\" name=\"ColorName_SubmitButton\" value=\"Print It Out!\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p><hr /></p>\n\n<h2>The Questions:</h2>\n\n<p>The problem in this attempt is that the color name does not get <code>printed out</code>, as wanted.</p>\n\n<ol>\n<li>Could the problem be rather on <code>Reponse.Write</code>, or <code>Request.QueryString</code>?</li>\n<li>How does get the part which is to handle the <code>GET</code> - <code>\"invoked\"</code>?</li>\n</ol>\n\n<hr/>\n\n<p><em><strong><code>Invoked</code></em></strong> = to put into effect or operation\n<em>(Source: The Merriam-Webster Dictionary)</em></p>\n"},{"tags":["c#",".net","wpf"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13259816,"title":"Editable combobox with valid selection","body":"<p>I have a editable combobox in WPF (IsEditable=True). I would also like to ensure that the values which the user enters are in the list only. I don't want user to add their own values to the combo. I cannot make IsReadonly=true as that will not allow users to type. So is validation the only option in SelectionChange event? or is there a better way to do the same?</p>\n\n<p>Thanks\nShankara Narayanan.</p>\n"},{"tags":["c#",".net","linq","collections"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":47,"score":-2,"question_id":13261060,"title":"Condition in the LINQ","body":"<p>I have collection (list) of strings and I want to write LINQ lambda expression in C#.\nIf I have only one element in the List, return only that element, but if I have more than one element, return me all other elements except that one which is equals to \"Blue\").\nThanks for your help.</p>\n"},{"tags":["c#",".net","c#-4.0","json.net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":117,"score":2,"question_id":12381636,"title":"Why is JSON.NET is not working with inheritance while deserializing","body":"<p>I am deserializing the JSON string to root object by using the following class which works fine .</p>\n\n<pre><code>[Serializable]\n    public class MoviesListRootObject\n    {\n        public int count { get; set; }\n        public Pagination pagination { get; set; }\n        public List&lt;Response&gt; response { get; set; }\n    }\n</code></pre>\n\n<p>...................................  </p>\n\n<pre><code>var json = wc.DownloadString(jsonRequestURL);\nvar rootObj = JsonConvert.DeserializeObject&lt;MoviesListRootObject&gt;(json);\n</code></pre>\n\n<p>But if I am generalizng the root object bt creating parent class and then inheriting from it , then I get null after deserialization!!!!</p>\n\n<pre><code>[Serializable]\n    public class RootObject\n    {\n        public int count { get; set; }\n        public Pagination pagination { get; set; }\n    }\n\n[Serializable]\n    public class MoviesListRootObject:RootObject\n    {\n        public List&lt;MovieResponse&gt; movieResponse { get; set; }\n\n    }\n</code></pre>\n\n<p>..............................................</p>\n\n<pre><code> var json = wc.DownloadString(jsonRequestURL);\n var rootObj = JsonConvert.DeserializeObject&lt;MoviesListRootObject&gt;(json);\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13260951,"title":"How to proxy a REST API with .NET 4","body":"<p>I'm trying to write a simple, pass-through proxy in .NET.</p>\n\n<p>I have a REST api hosted at some external domain (http://exampleapi.com),</p>\n\n<p>And I want to pass through all requests sent to my application (get, post, etc). JSONP isn't an option.</p>\n\n<p>So if I ask for  <code>GET localhost:1234/api/pages</code>  =>  <code>GET http://exampleapi.com/pages</code>\nLikewise if I <code>POST localhost:1234/api/pages</code>  =>  <code>POST http://exampleapi.com/pages</code></p>\n\n<p>The big problem I have, and what I can't seem to find elsewhere - is that I <em>don't</em> want to parse this JSON. Everything I've searched through seems to center around <code>HttpClient</code>, but I can't seem to figure out how to use it correctly.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>public ContentResult Proxy()\n{\n    // Grab the path from /api/*\n    var path = Request.RawUrl.ToString().Substring(4);\n    var target = new UriBuilder(\"http\", \"exampleapi.com\", 25001);\n    var method = Request.HttpMethod;\n\n    var client = new HttpClient();\n    client.BaseAddress = target.Uri;\n\n    // Needs to get filled with response.\n    string content;\n\n    HttpResponseMessage response;\n    switch (method)\n    {\n        case \"POST\":\n        case \"PUT\":\n            StreamReader reader = new StreamReader(Request.InputStream);\n            var jsonInput = reader.ReadToEnd();\n\n            // Totally lost here.\n            client.PostAsync(path, jsonInput);\n\n            break;\n        case \"DELETE\":\n            client.DeleteAsync(path);\n            break;\n        case \"GET\":\n        default:\n            // need to capture client data\n            client.GetAsync(path);\n            break;\n    }\n\n    return Content(content, \"application/json\");\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":78,"score":0,"question_id":13242945,"title":"converting textbox string to int","body":"<p>I'm trying to compare and multiply 2 random number variables with the int value entered in textboxes. If it is the correct increment the correct answers it does not increase the number although it increment works alone but it does not work with the textbox.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    int x = Randomnumber.Next(12);\n    int z = Randomnumber.Next(12);\n\n    //int cv = +correct;\n    textBox2.Text = x.ToString();\n    textBox3.Text = z.ToString();\n\n    int s = x * z;\n    if (s == int.Parse(textBox4.Text))\n    {\n        correct++;\n        numbercorrect.Text = correct.ToString();\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","wcf","wcf-client","wcf-hosting"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1493,"score":1,"question_id":1959383,"title":"Hosting and Consuming WCF Service from Same Process","body":"<p>Can you become a client of a WCF Service from with the Process that is hosting the WCF Service?  I have tried creating seperate App Domains within the same process and still no success.  The service is confirmed to be available on Http, Net.TCP and Net.Pipe.</p>\n\n<p>Thank you for any help!</p>\n\n<p>Nat</p>\n"},{"tags":[".net","windows","c#-4.0","scheduled-tasks"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13260600,"title":"Create win task to run once and delete immediately using C#","body":"<p>Here is the use case:\n- Create a new win task, run immediately and once complete, delete the task.</p>\n\n<p>Here is basic code to create a task using C#. </p>\n\n<pre><code>    using (TaskService ts = new TaskService(null))\n    {\n        string projectName = \"runnowtest\" + Guid.NewGuid().ToString();\n\n        //create new task\n        TaskDefinition td = ts.NewTask();\n        Trigger mt = null;\n\n        //setup task as Registration trigger\n        mt = td.Triggers.AddNew(TaskTriggerType.Registration);\n        mt.StartBoundary = DateTime.Now;\n\n        //delete the task 1 minute after the program ends\n        td.Settings.DeleteExpiredTaskAfter = new TimeSpan(0, 1, 0); \n\n        //run the notepad++ in the task\n        td.Actions.Add(new ExecAction(\"notepad.exe\"));\n\n        //register task\n        Task output = ts.RootFolder.RegisterTaskDefinition(projectName, td);\n\n        //check output\n        Console.WriteLine(output != null ? \"Task created\" : \"Task not created\");\n    }\n</code></pre>\n\n<p>The API doesn't seem to have a property/flag to mark task as run once. I am trying to ensure the above task runs only once and deletes immediately after that. Any thoughts are much appreciated!</p>\n"},{"tags":[".net","oracle","authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13260751,"title":"Passing database credentials between applications","body":"<p>I'm developing a lightweight .NET framework (for internal purposes) with single sign functionality. A primary application is first launched, which asks the user to log in. After that, the user is shown a list of applications to launch.</p>\n\n<p>These secondary applications are standalone applications, but they need to use the same credentials to log in to the database (Oracle) as to those that were passed to the primary application.</p>\n\n<p>Is there a secure way of implementing this? Either through passing information on the command line encrypted in some way, or the two applications communicating in one way or another (the primary application has access to the Process that the secondary applications are executed in).</p>\n\n<p>Launching these applications differently would also be possible, if that offered more functionality (i.e. load the executable into the App domain and run it that way).</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260688,"title":"how to remove the default control buttons from a windows form","body":"<p>The image describes what I am trying to do.</p>\n\n<p>I have a \"connect four\" game which works perfectly well but I want to remove the default buttons provided at the top right hand corner of the window. Any quick help on this?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ws3ss.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","dynamic","expression","iqueryable"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13252206,"title":"Dynamic IQueryable order by using string","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/41244/dynamic-linq-orderby\">Dynamic LINQ OrderBy</a>  </p>\n</blockquote>\n\n\n\n<p>I'm trying to create a dynamic sorting to Iqueryable.<br>\nSo bellow you can see that I am following some examples I see here in stackoverflow.</p>\n\n<pre><code> var query = dalSession.Query&lt;T&gt;();\n            var res = (from x in query orderby Extensions.Sort&lt;T&gt;(query, \"FirstName\") select x).Skip((paging.CurrentPageRecord)).Take(paging.PageSize);\n\n\npublic static class Extensions\n{\n    public static IQueryable&lt;T&gt; Sort&lt;T&gt;(this IQueryable&lt;T&gt; query,\n                                             string sortField)\n    {\n        return query.OrderByDescending(s =&gt; s.GetType()\n                                             .GetProperty(sortField));\n\n    }\n} \n</code></pre>\n\n<p>This is the exception that I get:</p>\n\n<blockquote>\n  <p>System.Linq.IQueryable<code>1[Partners.BusinessObjects.Affiliate] Sort[Affiliate](System.Linq.IQueryable</code>1[Partners.BusinessObjects.Affiliate], System.String)</p>\n</blockquote>\n\n<pre><code>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \n\nException Details: System.NotSupportedException: System.Linq.IQueryable`1[Partners.BusinessObjects.Affiliate] Sort[Affiliate](System.Linq.IQueryable`1[Partners.BusinessObjects.Affiliate], System.String)\n</code></pre>\n"},{"tags":["c#",".net","flash","youtube","youtube-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13260361,"title":"How to control the youtube flash player with c#?","body":"<p>So far this is what I have:</p>\n\n<pre><code>private AxShockwaveFlashObjects.AxShockwaveFlash player;\nplayer.movie = \"http://youtube.googleapis.com/v/9bZkp7q19f0\"\n...\nprivate void playBtn_Click(object sender, EventArgs e)\n{\n    player.CallFunction(\"&lt;invoke name=\\\"playVideo\\\" returntype=\\\"xml\\\"&gt;&lt;/invoke&gt;\");\n}\n</code></pre>\n\n<p>Unfortunately this returns: </p>\n\n<pre><code>\"Error HRESULT E_FAIL has been returned from a call to a COM component.\"\n</code></pre>\n\n<p>What am I missing? Should I load a different URL? <a href=\"https://developers.google.com/youtube/articles/youtube_as3_chromeless\" rel=\"nofollow\">The documentation</a> states that YouTube player uses <strong>ExternalInterface class</strong> to control it from JavaScript or AS3 so <a href=\"http://bojolais.livejournal.com/251383.html\" rel=\"nofollow\">it should work with c#</a>.</p>\n"},{"tags":[".net","linux","mono","delphi-prism","singleinstance"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13253939,"title":"How to enforce single instance of an application under mono?","body":"<p>So, I am able to enforce single instance of my application on Windows as follows.</p>\n\n<pre><code>[STAThread]\nclass method Program.Main(args: array of string);\nbegin\n  var mutex := new Mutex(true, \"{8F6F0AC4-B9A1-45fd-A8CF-72F04E6BDE8F}\");\n  if mutex.WaitOne(Timespan.Zero, true) then\n  begin\n    Application.EnableVisualStyles();\n    Application.SetCompatibleTextRenderingDefault(false);\n    Application.ThreadException += OnThreadException;\n    lMainForm := new MainForm;\n    lMainForm.ShowInTaskbar := true;\n    lMainForm.Visible := false;\n\n    Application.Run(lMainForm);\n  end\n  else\n    MessageBox.Show(\"Another copy running!!!\");\nend;\n</code></pre>\n\n<p>However, running the same application on Linux under mono this code does NOT work at all. I am able to run multiple copies. I don't know if it has to do with the fact that I am starting the application on the Terminal like <code>mono MyPro.exe</code>. If this is the problem, do you need to pass some values before you execute the command line.</p>\n\n<p>Thanks in advance,</p>\n"},{"tags":[".net","plinq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13256102,"title":"plinq select count where all functions evaluate true","body":"<p>I have a set of data all doubles:\n100 rows 20 columns</p>\n\n<p>I’m pulling the data into a IEnumerable list with:</p>\n\n<pre><code>var RowsOfData = File.ReadLines(dll.Globals.OutputDir +     dll.Globals.filename).Select(a =&gt; a.Split(',').ToList());\n\nvar FilteredRowsToday = (from n in RowsOfData\n       where n[1] == 1\n       orderby n[0] descending\n       select n);\n</code></pre>\n\n<p>I then have a set of functions, which do simple check on each the data rows and each returns a Bool.\nWhat I want is a count of the number of rows for which each of the functions evaluated true.\nAnd then when I scale my project up I want this processed asap in parallel if possible, I’ve tried:</p>\n\n<pre><code>foreach (var row in FilteredRowsToday) {  \nis f1() true, is f2() true \netc\n}\n</code></pre>\n\n<p>Seems slow\nI’ve tried to do in parallel</p>\n\n<pre><code>foreach (var row in FilteredRowsToday.AsParallel())\n</code></pre>\n\n<p>no faster</p>\n\n<p>I’m now thinking something like:</p>\n\n<pre><code>var TotalTrue = FilteredRowsToday.Select(item =&gt; f1() &amp; f2() &amp; f3()).Count();\n</code></pre>\n\n<p>I can pre-process the data to provide the results of the evaluations of each function as a sort of binary grid if that’s a better stating point?</p>\n\n<pre><code>F1, f2, f3 etc\n1, 0, 0 row 1\n1, 1, 1 row 2 etc\n</code></pre>\n\n<p>suggestions welcome!</p>\n"},{"tags":[".net","tfs","assemblies","versioning","tfsbuild"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":562,"score":4,"question_id":4742404,"title":"TFS Build: include branch name in \"build number\" field of assemblies","body":"<p>I'd like to be able to look at an assembly and quickly identify which branch it was built out of.  </p>\n\n<p>What's the best way to cofigure TFS Build to include the name of the current branch in the Build Number field (or a more appropriate field) of the assemblies it creates?</p>\n"},{"tags":[".net","system.reactive","reactiveui"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13260420,"title":"Updating items of ReactiveCollection<MyRecordType> right before adding new items to the collection","body":"<p>I am evaluating ReactiveExtensions and ReactiveUI for my current project. Both look very promising. However, I just ran into following problem. I have a type called RecordSet that defines a read only property of ReactiveCollection&lt;MyRecordType&gt; called Records. I need to manipulate some properties of every record item to be added to the collection as well as other items that are already in the collection right before the new item is added to the collection. Some of the manipulations are based on total count of the items that are already in the collection but not including the item to be added. I was trying observing _records.BeforeItemsAdded but for some reason OnNext() callbacks invoked \"too late\" (after items count in the collection already equals to the total number or items that are eventually added to the collection). What is recommended Rx pattern for attacking problem like this? </p>\n"},{"tags":["c#",".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13260315,"title":"LINQ query for the following","body":"<p>Could someone help formulate a LINQ query for the following problem.\nI have the following list of Key-Value number sets (mind that Duplicate Keys are allowed). There are thousands of such sets.</p>\n\n<pre><code>{4,3}, {4,1}, {4,8}, {4,9}, {2,3}, {4,9}, {3,1} , {3,4}\n</code></pre>\n\n<p>What data structure would suit me best.\nAlso, I want to group the above list of key-pairs, and OrderByDescending() so that i can extract the highest Key-Value pair of a Key-group.</p>\n\n<p>For example in the above case, expected output:</p>\n\n<pre><code>{4,9}, {4,9}, {4, 8}, {4, 3}, {4, 1}, {2, 3}, {3, 4}, {3, 1}\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":[".net","winapi","rdp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1893,"score":0,"question_id":579209,"title":"How can I initiate a Remote Assistance session in .NET?","body":"<p>I'm writing a help desk application and would like to allow my users to initiate a Remote Assistance session on a remote PC.  This can be done via Help in Windows XP, but I haven't been able to find any code sample in .NET.   Thanks!</p>\n"},{"tags":[".net","wpf","browser","webbrowser"],"answer_count":3,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1649,"score":6,"question_id":1140363,"title":"Hosting browser in WPF","body":"<p>Is it possible to host any other web browser <strong>beside IE</strong> in WPF desktop application?</p>\n\n<p>Edit:</p>\n\n<p>If yes, how?</p>\n"},{"tags":["javascript",".net","ajax","div"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13260107,"title":"Change 2 Divs Content via Ajax/XML","body":"<p>I'm making an employee directory page for a website. The page will have about 2 dozen thumbnail photos of employees, and when clicked, 2 divs below the thumbs will change to show a larger photo, and the bio of the employee. I was told to look into using AJAX for this, since I don't want the page to refresh/change from one employee to another. The site is being built in .net using C#, and as of now, we haven't used JQuery or Mootools on this site, so we'd be open to using either one.</p>\n\n<p>So here's a snippet of my XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;employees&gt;\n    &lt;employee_01&gt;\n        &lt;name&gt;Employee J. Name&lt;/name&gt;\n        &lt;title&gt;Big Cheese&lt;/title&gt;\n        &lt;email&gt;email@email.com&lt;/email&gt;\n        &lt;phone&gt;(555) 333-4444&lt;/phone&gt;\n        &lt;bio&gt;&lt;p&gt;This is paragraph one of the bio. This could be several sentences long.&lt;/p&gt;\n\n&lt;p&gt;This is paragraph 2 for this bio. It may or may not be as long as the first one.&lt;/p&gt;&lt;/bio&gt;\n        &lt;photo_url&gt;employee_photo01.jpg&lt;/photo_url&gt;\n    &lt;/employee_01&gt;\n    &lt;employee_02&gt;\n        &lt;name&gt;&lt;/name&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;email&gt;&lt;/email&gt;\n        &lt;phone&gt;&lt;/phone&gt;\n        &lt;bio&gt;&lt;/bio&gt;\n        &lt;photo_url&gt;&lt;/photo_url&gt;\n    &lt;/employee_02&gt;\n&lt;/employees&gt;\n</code></pre>\n\n<p>Here is the Div structure that needs to be replaced with the xml data.</p>\n\n<pre><code> &lt;div id=\"employee_bio_container\"&gt;\n    &lt;div id=\"employee_photo\"&gt;&lt;img src=\"images/employee_photo01.jpg\" alt=\"Employee Name\" /&gt;&lt;/div&gt;\n    &lt;div id=\"employee_bio\"&gt;\n        &lt;h1&gt;Name&lt;/h1&gt;\n        &lt;h5&gt;title&lt;/h5&gt;\n        &lt;h5&gt;&lt;a href=\"mailto:email\"&gt;email&lt;/a&gt;&lt;br /&gt;\n        phone goes here&lt;/h5&gt;\n        &lt;hr /&gt;\n&lt;p&gt;This is the bio that will be replaced&lt;/p&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>So I need to change the src for the image in the \"employee_photo\" div, along with the alt text for it, and display the name, title, email address, phone, and bio in the \"employee_bio\" div, along with changing the URL of the mailto link.</p>\n\n<p>I've never touched AJAX before, and I'm having a hard time making sense of the tutorials I've found so far. Any tips or directions to point me?</p>\n\n<p>Thanks.</p>\n"},{"tags":[".net","json","serialization","formatting","javascriptserializer"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":928,"score":4,"question_id":5881204,"title":"How to set formatting with JavaScriptSerializer when JSON serializing?","body":"<p>I am using JavaScriptSerializer for serializing objects to the file to the JSON format. But the result file has no readable formatting. How can I allow formating to get a readable file? </p>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13260084,"title":"Route URLs from a web client back to the web client","body":"<p>I have an ASP.NET Controller, that has a function, that simply returns a ContentResult of a WebClient.</p>\n\n<p>In this case, CNN is my testbed, my WebClient, downloads CNN as a string, into it's content, and returns the result as an ActionResult/ContentResult on a controller.</p>\n\n<p>I'm calling a RenderPartial on this action, to get CNN to display \"below\" and to the right of my current content, in its own box.</p>\n\n<p>The problem I'm running into, is when you click a link on CNN, it redirects to a \"relative\" url sometimes, and that relative url, doesn't exist in my localhost, and won't exist on my web server, thus the link fails.</p>\n\n<p>When it does redirect to an absolute url, that's also a problem, as the resulting page \"replaces\" my .NET shell.</p>\n\n<p>What I need it to do, is take any URLs that are inside that ContentResult I returned, and if any of those URLs are clicked, pass them back to my .NET application, to be downloaded by the WebClient, and rendered back in that shell.</p>\n\n<p>I'm aware I could use an IFRAME to do this instead of WebClient, but an IFRAME is impossible in my case, as its restricted by the public API we're consuming, its restricted/has flaws in the framework that API is servicing, and its blocked on some of our client machines, which we have no control over.</p>\n\n<p>Also, the client machines will be off our network, so I can't use an AJAX load, as that'd be XSS.</p>\n\n<p>One idea that I can think of, is basically to create custom routes, with filters/rules, that look for \"CNN\" like links, and pass them to my controller, as a parameter; then have my controller render my page, and pass those links to the web client.</p>\n\n<p>This would obviously be a lot of work, and not even really sure where to start with it in the routing engine.</p>\n\n<p>The only other thing I can think of that might work, is checking the validity of the URL, by attempting to see if it points to a valid link. If it doesn't point to a valid link, adding CNN's url prefix to it, and seeing if that is then a valid link. But that seems like a lot of work, for a solution that would be a heavy hit on performance, as checking each link on a page like CNN, could be very costly. Also, since I'd be running each link twice, that'd be a problem where POST operations were required, as it'd essentially run each operation twice, and being that this is a public API I'm consuming off a public framework, I wouldn't have control of the source code to safeguard against that.</p>\n\n<p>Any other suggestions?\nIs there any way to accomplish what I'm trying to do easily?</p>\n"},{"tags":[".net","ajax","modalpopupextender","asyncfileupload"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":6328,"score":2,"question_id":1812251,"title":"how to clear the textbox value of asyncfileupload ..?","body":"<p>There is one button(MyButton).\nOnClick of this button a modalpopup(MyPopup) appears with one asyncfileupload ajax control, Ok button and Cancel button.</p>\n\n<p>The browse functionality of the asyncfileupload functionality is working fine, No problem.\nBut after postback, if I click the MyButton again, the popup appearing with the previous path in the asyncfileupload control's textbox.</p>\n\n<p>How to clear it ... !</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":[".net","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13114772,"title":"S3 .NET SDK Hash before upload?","body":"<p>When I upload a file using S3, does the SDK hash the file and make sure the current version isn't the same before it uploads? I would like to use an MD5 function in my code but if it's already being done I don't want to waste time hashing large files twice but I also don't want to waste the time uploading a file that is already there.</p>\n"},{"tags":["python",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13259617,"title":"Python for .NET \"unable to find assembly\" error","body":"<p>I'm using CPython and I have a C# dll.  I'm trying to use Python for .NET to make them talk.  I can't use IronPython because I need to integrate this into an existing CPython system.</p>\n\n<p>I'm completely new to Python for .NET, and I actually have very little experience with Python and no experience with C#.  So please forgive me if my question seems very basic.</p>\n\n<p>I'm using Python 2.7.3, and I downloaded\npythonnet-2.0-alpha2-clr2.0_131_py27_UCS2 and unzipped it into a folder named pyfornet_test, which also contains the dll I'm trying to use (called DotNet4Class.dll)</p>\n\n<p>Then I run this:</p>\n\n<pre><code>import sys\n\nimport os\n\nimport clr\n\nsys.path.append(r\"C:\\pyfornet_test\")\n\nclr.AddReference(\"DotNet4Class.dll\")\n</code></pre>\n\n<p>Which gives me this error:</p>\n\n<pre><code>System.IO.FileNotFoundException: Unable to find assembly 'DotNet4Class.dll'.\n   at Python.Runtime.CLRModule.AddReference(String name) in C:\\Users\\Barton\\Documents\\Visual Studio 2008\\Projects\\PyShar\np\\trunk\\pythonnet\\src\\runtime\\moduleobject.cs:line 375\n</code></pre>\n\n<p>Any advice would be much appreciated. Thank you!</p>\n"},{"tags":["c#",".net","uri"],"answer_count":4,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":8084,"score":14,"question_id":2884551,"title":"Get individual query parameters from Uri","body":"<p>I have a uri string like: <a href=\"http://example.com/file?a=1&amp;b=2&amp;c=string%20param\">http://example.com/file?a=1&amp;b=2&amp;c=string%20param</a></p>\n\n<p>Is there an existing function that would convert query parameter string into a dictionary same way as ASP.NET Context.Request does it.</p>\n\n<p>I'm writing a console app and not a web-service so there is no Context.Request to parse the URL for me.</p>\n\n<p>I know that it's pretty easy to crack the query string myself but I'd rather use a FCL function is if exists.</p>\n"},{"tags":[".net","visual-studio-2010","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13259784,"title":"Visual Studio gets filled with black color forcing restart","body":"<p>Visual studio 2010 gets filled with black color wherever the mouse moves and restarting VS is the only option to get out of it.Has anyone encountered this problem ? This occurs at random and this irritating bug is quite frequent for me. </p>\n\n<p>Any help to fix this will be much appreciated. </p>\n\n<p><img src=\"http://i.stack.imgur.com/hu9VK.png\" alt=\"enter image description here\"></p>\n"},{"tags":[".net","text","overlay","social-networking","uploading"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13259557,"title":"Text overlay on video using .NET framewrok","body":"<p>We are trying to find library/components available in .Net framework stack that will help in developing application which can</p>\n\n<ol>\n<li>Process any format (wmv,mp4, h264) video as an input</li>\n<li>Overlay text on the video (overlaid text varies from frame to frame)</li>\n<li>Save the video file along with overlaid text</li>\n<li>Provide option to upload video file to social networking site.</li>\n</ol>\n"},{"tags":["c#","javascript",".net","signalr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13258362,"title":"SignalR doesn't work with custom serializer","body":"<p>I'm trying to configure signalr to send JSON object with lower case members. Currently I'm configuring with a custom ContractResolver, and have put this in my startup code:</p>\n\n<pre><code>var serializer = new JsonNetSerializer(new JsonSerializerSettings\n{\n    ContractResolver = new CamelCasePropertyNamesContractResolver()\n});\nGlobalHost.DependencyResolver.Register(typeof (IJsonSerializer), () =&gt; serializer);\n</code></pre>\n\n<p>However, no javascript calls are received when it is configured like this. Any ideas what's wrong? Thanks</p>\n"},{"tags":[".net","wpf","memory-leaks"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":623,"score":1,"question_id":1925052,"title":"Do I have a memory leak in my WPF Navigation?","body":"<p>I'm looking through a WPF application looking for a memory leak (using ANTS Memory Profiler 5.1) and I keep seeing some pages and controls taking up memory when they shouldn't be.</p>\n\n<p>So I go to the Object Retention Graph and to see what is keeping them around, and I keep seeing this for every page:</p>\n\n<p><img src=\"http://img683.imageshack.us/img683/3013/ants.jpg\" alt=\"Object Retention Graph\"></p>\n\n<p>The thing is, I have KeepAlive set to false on every page, and I don't think such a property exists on the user controls.</p>\n\n<p>Can anyone tell me what I should be looking for? Is this even a memory leak or is this normal behaviour for a WPF application?</p>\n"},{"tags":["c#",".net","restsharp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13258279,"title":"Rest client response always null","body":"<p>I create a GUI application to retrieve issue's data from redmine using RestSharp. I followed exactly what is supposed to be done from their documentation, but I keep on receiving a null response. Why is it always null, is there a connection issue?</p>\n\n<p>The <code>var response = client.Execute&lt;T&gt;(request)</code> is always null when <code>request.RootElement = \"issue\"</code> is commented out. When I <em>do</em> use it, I get an exception of \"Object was not instantiated\".</p>\n\n<p>The RestSharp recommended code --> <a href=\"https://github.com/restsharp/RestSharp/wiki/Recommended-Usage\" rel=\"nofollow\">Click here</a></p>\n\n<p>EDIT: I tried it on another server and I get the error <code>Invalid JSON string</code></p>\n\n<p><strong>Manager.cs</strong></p>\n\n<pre><code>public class Manager\n{\n    private string _baseUrl;\n    private string _user;\n    private string _password;\n\n    public Manager(string user, string password, string baseUrl)\n    {\n        _user = user;\n        _password = password;\n        _baseUrl = baseUrl;\n    }\n\n    private T Execute&lt;T&gt;(RestRequest request) where T : new()\n    {\n        var client = new RestClient();\n\n        client.BaseUrl = _baseUrl;\n\n        client.Authenticator = new HttpBasicAuthenticator(_user, _password);\n\n        //TODO: replace string 4110 with a passed ticket # as parameter\n        //request.AddParameter(\"issueId\", \"4110\", ParameterType.UrlSegment); // used on every request\n        var response = client.Execute&lt;T&gt;(request);\n\n        if (response.ErrorException != null)\n        {\n            throw response.ErrorException;\n        }\n\n        return response.Data;\n    }\n\n    public Issue GetIssue(int issueId)\n    {\n        var request = new RestRequest();\n        request.Resource = \"issues/{id}\";\n        //request.RootElement = \"issue\";\n\n        request.AddParameter(\"id\", issueId, ParameterType.UrlSegment);\n\n        return Execute&lt;Issue&gt;(request);\n    }\n</code></pre>\n\n<p><strong>Form1.cs</strong></p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Manager manager = new Manager(\"user\", \"password\", \"http://website/redmine\");\n\n    Issue issue = manager.GetIssue(4110);\n}\n</code></pre>\n\n<p><strong>Issue</strong></p>\n\n<pre><code>public class Issue\n{\n    //public List&lt;Custom_field&gt; Custom_fields { get; set; }\n\n    public int Id { get; set; }\n\n    public Element Project { get; set; }\n\n    public Element Author { get; set; }\n\n    public Element Tracker { get; set; }\n\n    public Element Status { get; set; }\n\n    public Element Priority { get; set; }\n\n    public Element Assigned_to { get; set; }\n\n    public Element Category { get; set; }\n\n    public string Subject { get; set; }\n\n    public string Description { get; set; }\n\n    public string Start_date { get; set; }\n\n    public int Done_ratio { get; set; }\n\n    public double Estimated_hours { get; set; }\n\n    public DateTime Due_date { get; set; }\n\n    public string Created_on { get; set; }\n\n    public string Updated_on { get; set; }\n\n}\n</code></pre>\n"},{"tags":["c#",".net","gui","user-interface"],"answer_count":4,"favorite_count":6,"up_vote_count":10,"down_vote_count":0,"view_count":4131,"score":10,"question_id":2841180,"title":"How to add an extra button to the window's title bar?","body":"<p>I've seen that some apps (maybe not .NET apps) that have an extra button on the left from the minimize button on the form's title bar? How can I achieve this in C#?</p>\n"},{"tags":["c#",".net"],"answer_count":5,"favorite_count":0,"up_vote_count":10,"down_vote_count":0,"view_count":1839,"score":10,"question_id":4364665,"title":"static destructor","body":"<p>c# has static constructor which do some initialization. (Likely Do some unmanaged resource initialization) I am wondering if there is static destuctor?</p>\n"},{"tags":[".net","tfs","nuget","nuget-package"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":16,"score":0,"question_id":13258736,"title":"How can i make sure installed packages get to team members through TFS?","body":"<p>On my dev team we have had a few issues with Nuget packages not getting through TFS to team members. Is there anyway to guarantee this?</p>\n"},{"tags":["c#",".net","wpf","entity-framework"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13256246,"title":"linq to entity framework with join","body":"<p>I have in my DB 2 tables: </p>\n\n<ol>\n<li><p>Documents (Document_Id ,document_Name) </p></li>\n<li><p>Person_Documents (person_ID ,Documet_Id document_Done)</p></li>\n</ol>\n\n<p>I use entity framework and ,and I want to fill <code>DataGrid</code> with the data <code>document_Name</code> and <code>document_Done</code>,</p>\n\n<p>I have tried the following with no results:</p>\n\n<pre><code>      vagEntities projectE = new vagEntities();\n      var doc = from c in projectE.Person_Documents                   \n          join cw in projectE.Documents on c.Document_Id equals cw.Document_Id\n          where c.Person_Id == 150\n          select c;\n\n      DocGrid.ItemsSource = doc;\n</code></pre>\n\n<p>Please, where am I wrong?\nun the xaml i write this</p>\n\n<pre><code>                &lt;DataGridTextColumn Binding=\"{Binding Path=Document_Name}\" MinWidth=\"100\"   Header=\"document\"  /&gt;\n\n            &lt;DataGridCheckBoxColumn  Binding=\"{Binding Path=Document_done}\" Header=\"Do\" /&gt;\n</code></pre>\n"},{"tags":["c#",".net","nlog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13258094,"title":"How to log Exceptions in Nlog2?","body":"<p>I am a bit confused what way is the right way to log exceptions</p>\n\n<pre><code> Log.Fatal(exception format, args);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>  logger.FatalException(\"Got exception.\", ex);\n</code></pre>\n"},{"tags":["c#",".net","vb.net","json","json.net"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":71,"score":2,"question_id":13258163,"title":"JSON Deserialization in .NET","body":"<p>I've had a look at a few threads but what I'm aiming for I can't seem to find.<br>\nI have the following JSON strings returned:</p>\n\n<p>On success:</p>\n\n<pre><code>{\"success\":{\"username\":\"key\"}}\n</code></pre>\n\n<p>On Error: </p>\n\n<pre><code>{\"error\":{\"type\":101,\"address\":\"/\",\"description\":\"link button not pressed\"}}\n</code></pre>\n\n<p>I need to be able to de-serialize these into a class and determine whether I've got an error or a success message to carry on doing it. Any ideas on how to achieve this?</p>\n\n<p>thanks,</p>\n\n<p>Adam</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13258453,"title":"Running a Windows application as a Command Line application","body":"<p>I am working on a migration tool that is primarily a Windows Forms application. What I want to do is provide the ability to run the application as a sort of command line utility where parameters can be passed in and the migration occurs completely void of the GUI.  This seems straight forward enough and the entry point for my application looks like this:</p>\n\n<pre><code>    [STAThread]\n    static void Main(string[] args)\n    {\n        if (args.Length == 0)\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n            Application.Run(new MainWindow());\n        }\n        else\n        {\n            //Command Line Mode\n            Console.WriteLine(\"In Command Line Mode\");\n            Console.ReadLine();\n        }\n    }\n</code></pre>\n\n<p>The problem I am running into is that when execution passes into the else block the text is not wrote back to the user at the command prompt which is problematic as I want to update the user at the command prompt as various executions complete.  I could easily write a standalone console application but I was hoping to provide a single tool that allowed to different types of entries for a given scenario.  Is what I am looking to do possible and, if so, how is it achieved? </p>\n\n<p>Thanks!</p>\n"},{"tags":[".net","datetime","rss","rfc822"],"answer_count":6,"favorite_count":9,"up_vote_count":20,"down_vote_count":0,"view_count":17044,"score":20,"question_id":284775,"title":"How do I parse and convert DateTime’s to the RFC 822 date-time format?","body":"<p>How do I convert a DateTime structure to its equivalent <a href=\"http://www.w3.org/Protocols/rfc822/#z28\" rel=\"nofollow\">RFC 822 date-time</a> formatted string representation <strong>and</strong> parse this string representation back to a DateTime structure? The RFC-822 date-time format is used in a number of specifications such as the <a href=\"http://www.rssboard.org/rss-specification\" rel=\"nofollow\">RSS Syndication Format</a>.</p>\n"},{"tags":["c#",".net","sorting","observablecollection"],"answer_count":8,"favorite_count":2,"up_vote_count":15,"down_vote_count":0,"view_count":24847,"score":15,"question_id":1945461,"title":"How do I sort an observable collection?","body":"<p>I have a following class :</p>\n\n<pre><code>[DataContract]\npublic class Pair&lt;TKey, TValue&gt; : INotifyPropertyChanged, IDisposable\n{\n    public Pair(TKey key, TValue value)\n    {\n        Key = key;\n        Value = value;\n    }\n\n    #region Properties\n    [DataMember]\n    public TKey Key\n    {\n        get\n        { return m_key; }\n        set\n        {\n            m_key = value;\n            OnPropertyChanged(\"Key\");\n        }\n    }\n    [DataMember]\n    public TValue Value\n    {\n        get { return m_value; }\n        set\n        {\n            m_value = value;\n            OnPropertyChanged(\"Value\");\n        }\n    }\n    #endregion\n\n    #region Fields\n    private TKey m_key;\n    private TValue m_value;\n    #endregion\n\n    #region INotifyPropertyChanged Members\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    protected void OnPropertyChanged(string name)\n    {\n        PropertyChangedEventHandler handler = PropertyChanged;\n        if (handler != null)\n        {\n            handler(this, new PropertyChangedEventArgs(name));\n        }\n    }\n\n    #endregion\n\n    #region IDisposable Members\n\n    public void Dispose()\n    { }\n\n    #endregion\n}\n</code></pre>\n\n<p>Which I've put in an ObservableCollection :</p>\n\n<pre><code>ObservableCollection&lt;Pair&lt;ushort, string&gt;&gt; my_collection = \n    new ObservableCollection&lt;Pair&lt;ushort, string&gt;&gt;();\n\nmy_collection.Add(new Pair(7, \"aaa\"));\nmy_collection.Add(new Pair(3, \"xey\"));\nmy_collection.Add(new Pair(6, \"fty\"));\n</code></pre>\n\n<p>Q : How do I sort it by key ?</p>\n"},{"tags":[".net","asp.net-mvc"],"answer_count":6,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":2909,"score":6,"question_id":495124,"title":"How do you redirect to the calling page in ASP.NET MVC?","body":"<p>Let's say I have a controller action that deletes an item out of a user's shopping basket.  This controller action is triggered by performing a POST to the url ~/delete/{id}.  If I have several pages on my application that will post to this url, how do I construct the controller action to redirect back to the page that posted to it?</p>\n"},{"tags":["c#",".net","ado.net","odbc","prepared-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13257401,"title":"C# Prepared Statement and multiple queries","body":"<p>Is it possible to execute multiple queries with the same prepared statement (same <code>OdbcCommand</code> object)?</p>\n\n<p>Below is the code I have and is throwing the following exception: <code>System.Data.Odbc.OdbcException was caught\n  Message=ERROR [07006] [IBM][CLI Driver] CLI0102E  Invalid conversion. SQLSTATE=07006</code></p>\n\n<pre><code> ...\n        odbcConnection = myConnection.getOdbcConnection();\n        odbcConnection.Open();\n        odbcCommand = odbcConnection.CreateCommand();\n        odbcTrans = odbcConnection.BeginTransaction(IsolationLevel.ReadCommitted);\n        odbcCommand.Transaction = odbcTrans;\ntry{\n    odbcCommand.CommandText = queryStatement1();\n            odbcCommand.Parameters.AddWithValue(\"?ID1\", parameter1);\n            odbcCommand.Parameters.AddWithValue(\"?ID2\", parameter2);\n    ...\n    odbcCommand.Parameters.AddWithValue(\"?ID11\", parameter3);\n    odbcCommand.Prepare();\n            odbcCommand.ExecuteNonQuery();\n\n\n    odbcCommand.CommandText = queryStatement2();\n    odbcCommand.Parameters.AddWithValue(\"?ID1\", parameter4);\n            odbcCommand.Parameters.AddWithValue(\"?ID2\", parameter5);\n    ...\n    odbcCommand.Parameters.AddWithValue(\"?ID13\", parameter6);\n    odbcCommand.Prepare();\n            odbcCommand.ExecuteNonQuery();\n    odbcTrans.Commit();\n} catch(Exception e){ ... }\n...\n</code></pre>\n\n<p>Same <code>OdbcCommand</code> object, two different queries...</p>\n"},{"tags":["c#",".net","itextsharp","syntax-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13238708,"title":"Trying to debug some iTextSharp code that is designed to convert an web page into a PDF document via a string variable","body":"<p>I am stuck trying to debug some code that is designed to convert an web page into a PDF document via a string variable.  It uses the iTextSharp c# tool (xmlworker) and is a modification of the example code that comes with the sourceforge source code called html2pdf.csproj.  This example code converts an existing html file into a PDF file and saves it in the same directory as the file that was converted.  I have a string variable containing html formatted text and I am trying to make it able to be returned as a byte array that will be passed to the client side in a web environment for printing purposes.  The problem is that I get an \"IOException was unhandled by user code\" message that states \"The document has no pages.\"  I'm a little unsure what this is suppose to mean, nor how to go about diagnosing the problem.  The example code using the file based system works and I have successfully converted a static version of the html string to PDF.  Below is the modified code:</p>\n\n<pre><code>       private byte[] createPDF(string html, string filename) {\n            MemoryStream msOutput = new MemoryStream();\n            string printPDFCSS = Server.MapPath(\"/content/printPDF.css\");\n            Document doc = new Document(PageSize.LETTER);\n            doc.SetMargins(doc.LeftMargin, doc.RightMargin, 35, 0);\n            PdfWriter pdfWriter = PdfWriter.GetInstance(doc, msOutput);\n\n            doc.Open();\n            Dictionary&lt;String, String&gt; substFonts = new Dictionary&lt;String, String&gt;();\n            substFonts[\"Arial Unicode MS\"] = \"Helvetica\";\n            CssFilesImpl cssFiles = new CssFilesImpl();\n            cssFiles.Add(XMLWorkerHelper.GetCSS(new FileStream(printPDFCSS, FileMode.Open)));\n            StyleAttrCSSResolver cssResolver = new StyleAttrCSSResolver(cssFiles);\n            HtmlPipelineContext hpc = new HtmlPipelineContext(new CssAppliersImpl(new UnembedFontProvider(XMLWorkerFontProvider.DONTLOOKFORFONTS, substFonts)));\n            hpc.SetImageProvider(new ImageProvider(filename));\n            hpc.SetAcceptUnknown(true).AutoBookmark(true).SetTagFactory(Tags.GetHtmlTagProcessorFactory());\n            HtmlPipeline htmlPipeline = new HtmlPipeline(hpc, new PdfWriterPipeline(doc, pdfWriter));\n            IPipeline pipeline = new CssResolverPipeline(cssResolver, htmlPipeline);\n            XMLWorker worker = new XMLWorker(pipeline, true);\n            XMLParser xmlParse = new XMLParser(true, worker);\n            xmlParse.Parse(msOutput);\n            doc.Close();\n            return msOutput.ToArray();\n        }\n</code></pre>\n"},{"tags":[".net","linq","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":6212038,"title":"\"Member AutoSync Failure\" using TPT, view and instead of insert trigger","body":"<p>Trying to use Linq2SQL with class inheritance using TPT pattern like this http://blogs.msdn.com/sbajaj/archive/2008/04/02/tpt-with-linq-to-sql.aspx</p>\n\n<p>Sample application works fine. Here is my code:</p>\n\n<p>Tables and views:</p>\n\n<p>&nbsp;</p>\n\n\n<pre>CREATE TABLE [dbo].[social_event](\n    [Id] [int] IDENTITY(1,1) NOT NULL PRIMARY KEY,\n    [Creator] [uniqueidentifier] NOT NULL FOREIGN KEY REFERENCES [dbo].[aspnet_Users](UserId),\n    [EventDate] [datetime] NOT NULL)\nGO\n\nCREATE TABLE [dbo].[social_addfriendevent](\n    [ID] [int] NOT NULL PRIMARY KEY FOREIGN KEY REFERENCES [dbo].[social_event](Id),\n    [Friend] [uniqueidentifier] NOT NULL FOREIGN KEY REFERENCES [dbo].[aspnet_Users](UserId),\n    [Added] [bit] NOT NULL DEFAULT((0)))\nGO\n\nCREATE VIEW [dbo].[event]\nAS\nSELECT t0.Id, t0.Creator, t0.EventDate, t1.Friend, t1.Added, 'AddFriendEvent' AS EventType\nFROM  dbo.social_event AS t0 INNER JOIN\n   dbo.social_addfriendevent AS t1 ON t0.Id = t1.Id\nGO\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>&nbsp;My \"Instead of insert\" trigger:</p>\n\n<p>&nbsp;</p>\n\n\n<pre>CREATE TRIGGER [dbo].[trigger_update_event] ON [dbo].[event] INSTEAD OF INSERT\nAS\n    DECLARE @rc AS INT;\n    SET @rc = @@ROWCOUNT;\n    IF @rc = 0 RETURN;\n\n    DECLARE @Id AS INT\n    DECLARE @EventType AS NVARCHAR(50)\n    DECLARE @Creator AS uniqueidentifier\n    DECLARE @EventDate AS datetime\n    DECLARE @Friend AS uniqueidentifier\n    DECLARE @Added AS bit \n\n    IF @rc = 1\n        BEGIN\n            SELECT @Id=Id,\n   @EventType=EventType,\n                 @Creator=Creator,\n                 @EventDate = getdate(),\n                 @Friend=Friend,\n                 @Added=Added\n            FROM INSERTED\n\n            INSERT INTO dbo.social_event VALUES(@Creator, @EventDate)\n            SELECT @Id = SCOPE_IDENTITY()\n            IF @EventType = 'AddFriendEvent'\n                INSERT INTO dbo.social_addfriendevent VALUES(@Id, @Friend, @Added)                            \n        END\n    ELSE\n        BEGIN\n            DECLARE cursor_inserted CURSOR FAST_FORWARD FOR\n                SELECT EventType,\n                     Creator,\n                     EventDate,\n                     Friend,\n                     Added\n                FROM INSERTED\n            OPEN cursor_inserted;\n\n            FETCH NEXT FROM cursor_inserted INTO @EventType,\n                                             @Creator,\n                                             @EventDate,\n                                             @Friend,\n                                             @Added;\n            WHILE @@FETCH_STATUS = 0\n            BEGIN\n                INSERT INTO dbo.social_event VALUES(@Creator, @EventDate)\n                SELECT @Id = SCOPE_IDENTITY()                \n                IF @EventType = 'AddFriendEvent'\n                INSERT INTO dbo.social_addfriendevent VALUES(@Id, @Friend, @Added)\n            END\n            CLOSE cursor_inserted;\n            DEALLOCATE cursor_inserted;\n        END\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>My data classes with mappings:</p>\n\n<p>&nbsp;</p>\n\n\n<pre>[InheritanceMapping(Code = \"AddFriendEvent\", Type = typeof(AddFriendEvent), IsDefault = true)]\n [Table(Name = \"dbo.event\")]\n public abstract class Event\n {\n private static int s_id;\n\n public Event()\n {\n  this.Id = --Event.s_id;\n }\n\n public Event(string eventType)\n  : this()\n {\n  EventType = eventType;\n }\n\n [Column(IsPrimaryKey = true)]\n public int Id;\n\n [Column(Name = \"Creator\")]\n public Guid CreatorId;\n\n [Column(Name = \"EventDate\", DbType = \"datetime\")] \n public DateTime Date;\n\n [Column(IsDiscriminator = true, Name = \"EventType\")]\n public string EventType;\n }\n\n public class AddFriendEvent : Event\n {\n [Column(Name = \"Added\", CanBeNull = false)]\n public bool Added;\n\n [Column(Name = \"Friend\", CanBeNull = false)]\n public Guid Friend;\n\n public AddFriendEvent()\n  : base(\"AddFriendEvent\")\n {\n }\n }\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>When I try to create new \"AddFriendEvent\" and save it to database like here:</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n\n<pre>DataContext dc = new DataContext(connectionString);\n   Table&lt;Event&gt; allEvents = dc.GetTable&lt;Event&gt;();\n   AddFriendEvent ev = new AddFriendEvent()\n   {\n    Added = true,\n    CreatorId = Guid.Parse(\"379959D-58FE-4A57-BB02-559E3E855B8F\"),\n    Date = DateTime.Now,\n    Friend = Guid.Parse(\"379959D-58FE-4A57-BB02-559E3E855B8F\")\n   };\n   allEvents.InsertOnSubmit(ev);\n   dc.SubmitChanges();\n</pre>\n\n\n<p>&nbsp;</p>\n\n<p>I got&nbsp;<strong>\"Member AutoSync Failure\"</strong>. What's wrong?</p>\n\n<p><br /></p>\n"},{"tags":[".net","autostart","setup-kit"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13255123,"title":"How to start an application when user logon","body":"<p>I have an .net application which I would like to start automaticallly  when a user log into a computer. Now this application needs to be started when the user log on. I know I can put this into the startup folder, but this is not an option as the user will be able to 'easily' prevent that by removing the application. </p>\n\n<p>Is there any way to start an application when user log on that is 'hard enough' for a 'normal user' to prevent. I get the point where a power user might be able to edit the registry for example, but I want to prevent most people from doing it.</p>\n\n<p>I see applications like Steam who start at logon and that are not in the startup forlder, so I guess it's not too hard to do when you know how to. I guess it's al part of the install kit I will make somehow.</p>\n\n<p>Edit : Let me clear something up. The thing with this application is that some institution are by-law required to provided some information some user actions so this application will log those actions. They must also provide best-effort to prevent user from bypasing the data from being logged. By best-effort, it means that it must prevent users with little knowledge of computer. I can't really go into the specifics as it is highly confidential, but the application that will be started will not be visible to the user, yet it cannot be a service because of some of the service's limitations. All of those issues have already been taken care of as of now. </p>\n\n<p>The only thing that we need to adress is the fact that this application may have to be installed on business server, which really isn't that much of a problem since we have control over those servers, but also home computers, for users that will request the access to certain ressource outside their workplace. They will have to install some kits in order to access the said ressource, and one of those kits will be the application that logs. </p>\n\n<p>I am fully aware that a power user will be able to bypass it and that some people will go into the task manager to stop the process, but we are providing best-effort and they will be the one with problems if this is noticed.</p>\n\n<p>Thanks,</p>\n"},{"tags":["android",".net"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13257579,"title":"Cant get ResourceID Mono-Android","body":"<p>I have a spinner that sets an image view resource based on the selected item from the list. The problem is when I go to retrieve the resource ID, I always get back a 0, or unknown member. </p>\n\n<p>Spinner item selected()</p>\n\n<pre><code>    private void spinner_ItemSelected(object sender, AdapterView.ItemSelectedEventArgs e) {\n        Spinner spinner = (Spinner)sender;\n        string toast = string.Format(\"{0}\", spinner.GetItemAtPosition(e.Position));\n        var imageView = FindViewById&lt;ImageView&gt;(Resource.Id.stateView);\n        var resourceId = 0;\n\n        resourceId = Resources.GetIdentifier(toast, \"drawable\", PackageName);\n        imageView.SetImageResource(resourceId);\n        Toast.MakeText(this, toast, ToastLength.Long).Show();\n    }\n</code></pre>\n\n<p>I have tried every combination of Resource.GetIdentifier(string, string, string), but I am not having any luck. </p>\n\n<p>The resource is located in Resource.Designer.cs, and when debugging if I edit value of resource id to one of the ID of items in Resource.Designer.Drawable the function works as expected. </p>\n\n<p>Does any one know what I'm doing wrong?</p>\n"},{"tags":[".net","asp.net","deployment","web-config"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":4261,"score":2,"question_id":1830824,"title":"Instance Failure in asp.net","body":"<p>I have a web application that is working perfectly in my system.  However, when I copied it to another system, I couldn't login to the application.  There is an error:</p>\n\n<pre><code>Server Error in '/' Application.\n--------------------------------------------------------------------------------\n\nInstance failure. \nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \n\nException Details: System.InvalidOperationException: Instance failure.\n\nSource Error: \n\nAn unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  \n\nStack Trace: \n\n\n[InvalidOperationException: Instance failure.]\n   System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, SqlConnection owningObject) +4858423\n   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnection owningObject) +90\n   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(String host, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, Int64 timerStart) +257\n   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +221\n   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) +189\n   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +4859187\n   System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +31\n   System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +433\n   System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +66\n   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +499\n   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +65\n   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +117\n   System.Data.SqlClient.SqlConnection.Open() +122\n   System.Web.DataAccess.SqlConnectionHolder.Open(HttpContext context, Boolean revertImpersonate) +87\n   System.Web.DataAccess.SqlConnectionHelper.GetConnection(String connectionString, Boolean revertImpersonation) +221\n   System.Web.Security.SqlMembershipProvider.GetPasswordWithFormat(String username, Boolean updateLastLoginActivityDate, Int32&amp; status, String&amp; password, Int32&amp; passwordFormat, String&amp; passwordSalt, Int32&amp; failedPasswordAttemptCount, Int32&amp; failedPasswordAnswerAttemptCount, Boolean&amp; isApproved, DateTime&amp; lastLoginDate, DateTime&amp; lastActivityDate) +815\n   System.Web.Security.SqlMembershipProvider.CheckPassword(String username, String password, Boolean updateLastLoginActivityDate, Boolean failIfNotApproved, String&amp; salt, Int32&amp; passwordFormat) +105\n   System.Web.Security.SqlMembershipProvider.CheckPassword(String username, String password, Boolean updateLastLoginActivityDate, Boolean failIfNotApproved) +42\n   System.Web.Security.SqlMembershipProvider.ValidateUser(String username, String password) +78\n   System.Web.UI.WebControls.Login.AuthenticateUsingMembershipProvider(AuthenticateEventArgs e) +60\n   System.Web.UI.WebControls.Login.OnAuthenticate(AuthenticateEventArgs e) +119\n   System.Web.UI.WebControls.Login.AttemptLogin() +115\n   System.Web.UI.WebControls.Login.OnBubbleEvent(Object source, EventArgs e) +101\n   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +37\n   System.Web.UI.WebControls.Button.OnCommand(CommandEventArgs e) +118\n   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +166\n   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10\n   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13\n   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +36\n   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1565\n\n\n\n\n--------------------------------------------------------------------------------\nVersion Information: Microsoft .NET Framework Version:2.0.50727.3053; ASP.NET Version:2.0.50727.3053\n</code></pre>\n\n<p>What could be the reason for such an error?  How could I solve this?</p>\n"},{"tags":["c#",".net","visual-studio","debugging","breakpoints"],"answer_count":6,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":2503,"score":15,"question_id":5744506,"title":"A curious case of Visual Studio 2010 debugger(it can not hit a break point)","body":"<p>A curious case of Visual Studio 2010 debugger(it can not hit a break point)</p>\n\n<p>This is the code that reproduces the problem:</p>\n\n<pre><code>class Program {\n  static void Main(string[] args) {\n    bool b = false;\n\n    if (b) {\n        List&lt;string&gt; list = new List&lt;string&gt;();\n        foreach (var item in list) {\n\n        }\n    } else {\n        Console.WriteLine(\"1\");\n    }\n    Console.WriteLine(\"2\");//add a break point here in VS2010\n  }\n  //1. configuration: release\n  //2. platform target: x64 or Any Cpu\n  //3. debug info: pdb only or full\n  //4. OS: Win7 x64\n  //5. optimize code: enabled\n}\n</code></pre>\n\n<p>Add a break point to the last statement of the code, then debug it in vs2010, you'll see that the break point can not be hit.</p>\n\n<p>To reproduce this curious case, you'll need to meet the following conditions:</p>\n\n<ol>\n<li>Operation system: windows 7 x64;</li>\n<li>VS build configuration: release;</li>\n<li>VS build platform target: x64 or Any Cpu;</li>\n<li>VS build debug info: pdb only or full;</li>\n<li>VS build optimize code: enabled;</li>\n</ol>\n\n<p>I am not sure those conditions are sufficient to reproduce it, but it's how my machine was configured when I found this issue.</p>\n\n<p>Why is the debugger not able to hit the break point?</p>\n\n<p>Thanks in advance!</p>\n\n<p>And if you can reproduce this issue, please consider voting on <a href=\"http://connect.microsoft.com/VisualStudio/feedback/details/664400/a-curious-case-of-visual-studio-2010-debugger-it-can-not-hit-a-break-point#tabs\" rel=\"nofollow\">this post.</a></p>\n"},{"tags":["c#",".net","wpf","draggable","attachedbehaviors"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":2,"view_count":112,"score":1,"question_id":13076056,"title":"Is there a good solution for a ItemsControl in WPF that can have its elements reordered by vertical drag and drop?","body":"<p>So here's the scenario I'm working with:</p>\n\n<p>I've got a priority list currently represented as an ItemsControl/ListView, bound to an observable collection of priority items.  I want to provide tightly visually constrained vertical dragging for element reordering.</p>\n\n<p>So, no drag adorners, no horizontal movement, only vertical movement.  When a list item moves past the midpoint of another item, it should \"swap positions\" through animation.  I am sure this can be done by working with mousedown/mousemove on the containers themselves, and I'm sure render transforms can be applied to do this, but my ideal solution would have two components to it:</p>\n\n<ol>\n<li><p>The functionality could be attached as a WPF interactions <a href=\"http://wpftutorial.net/Behaviors.html\" rel=\"nofollow\">behavior</a>.</p></li>\n<li><p>The system would be MVVM friendly and not require any significant code behind.</p></li>\n</ol>\n\n<p>Has this been done? Where can I find it?  If it hasn't how could I go about putting all the bits together in order to do this?</p>\n\n<p>EDIT: <strong>Bounty opened. Please direct questions to me via comments and I will reply as fast as possible.</strong></p>\n"},{"tags":["c#",".net","reflection"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13257208,"title":"Create class instance with activationCustomData parameter","body":"<p>Want to create instance of a class with activation custom data. Like following:</p>\n\n<pre><code>var repo = Activator.CreateInstance(Type.GetType(repoFullName),\n                new string[] { connectionString }) as IRepository;\n</code></pre>\n\n<p>If I don't pass second parameter which is string array in CreateInstance method everything works fine, but with custom data parameter method throws the exception</p>\n\n<p>System.MissingMethodException: Constructor on type 'Namespase.MockRepository' not found.</p>\n\n<p>Public constructors of instantiated type </p>\n\n<pre><code>public MockRepository(string[] customData) {...}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>public MockRepository(Object[] customData) {...}\n</code></pre>\n\n<p>didn't change the effect. What do I do wrong?</p>\n"},{"tags":["c#",".net","c#-4.0","task-parallel-library"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13240024,"title":"Long running Process using Task objects and a Monitor Thread","body":"<p>I am attempting to monitor a long running process. Right now the process created new Task objects for all the small pieces, but I need some way to monitor their progress to send status to a UI.</p>\n\n<pre><code>ExecutionContext ctx = new ExecutionContext()\n        {\n            Result = result,\n            LastCount = result.Values.Count\n        };\n\n        Task t = Task.Factory.StartNew(() =&gt;\n            {\n                foreach (var dataSlice in dataObjects)\n                {\n                   Task.Factory.StartNew(() =&gt;\n                   {\n                       // Do Some Work\n                   }, TaskCreationOptions.AttachedToParent);\n                }\n            });\n\n        ctx.ParentTask = t;\n\n\n        Task monitor = Task.Factory.StartNew( () =&gt;\n            {\n                ctx.LastCount = ctx.Result.Values.Count;\n\n            }, TaskCreationOptions.LongRunning);\n</code></pre>\n\n<p>My problem, or perhaps question is, if I force my monitor task to wait (via a SpinWait or Sleep) will it possibly lock part of the Tasks created above it? I need the monitor to check status every now and then, but I don't want it's wait condition to kill another task that needs to run.</p>\n"},{"tags":["c#",".net","webclient","socks","webclient-download"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13122369,"title":"Use WebClient with socks proxy","body":"<p>Is there any way to use a socks proxy with <code>WebClient</code>? Specifically with the <code>DownloadString</code> method that it provides?<br>\nI don't want to use any third party stuff like privoxy,freecap whatever and I can't use commercial libraries like those from Chilkat. I tried using stuff from <a href=\"http://www.mentalis.org/\" rel=\"nofollow\">http://www.mentalis.org/</a> in fact I used their <code>WebRequest</code> implementation but they don't seem to have something similar for WebClient.</p>\n\n<p>Thank you.</p>\n"},{"tags":[".net","axapta","x++","dynamics-ax-2009"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1155,"score":0,"question_id":4667013,"title":"Fetching data from dynamics ax 2009 using Ax webservices and C#","body":"<p>I am trying to fetch the list of vendors from the AX database.</p>\n\n<p>I want to show a list of vendors in my aspx page.How can i achieve this?</p>\n\n<p>here is what i have done so far</p>\n\n<p>1-Deployed the Ax webservices.\n2-Created a client class to call the service.</p>\n\n<p>i am stuck here and not sure how to fetch the data.</p>\n\n<p>Please advice.</p>\n"},{"tags":[".net","winforms","icons","color-depth"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":132,"score":7,"question_id":12826990,"title":"WinForms app uses low-quality title bar icon on 16-bit display","body":"<p>On displays with 16-bit color depth (including Remote Desktop sessions set to 16-bit color), Windows Forms applications use a low-color-depth version of the assigned title-bar icon (<code>Form.Icon</code>). WPF applications and Windows Explorer, however, use the 24-bit color depth, if it exists.</p>\n\n<p>I first saw this in a Windows Forms application I'm currently working on. The icon I was using had 4-bit, 24-bit, and 32-bit variants defined.  On 16-bit displays, Windows Forms was using the ugly 4-bit version in the title bar instead of the nice-looking 24- or 32-bit version.</p>\n\n<p>To test and illustrate the behavior, I created a test icon with obviously different designs for each size and color format. I included 4-bit, 8-bit, 24-bit, and 32-bit variants.</p>\n\n<p>Here are the results on both 32-bit and 16-bit displays:</p>\n\n<h2>On 32-bit displays, all is well:</h2>\n\n<p><strong>Windows Explorer:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/eDurb.png\" alt=\"Windows Explorer, 32-bit display\"></p>\n\n<p><strong>WPF Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/VEush.png\" alt=\"WPF Application, 32-bit display\"></p>\n\n<p><strong>Windows Forms Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/yAMSR.png\" alt=\"Windows Forms Application, 32-bit display\"></p>\n\n<h2>On 16-bit displays, Windows Forms displays a lower-color-depth variant of the icon than does WPF or Windows Explorer:</h2>\n\n<p><strong>Windows Explorer:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/dVVmx.png\" alt=\"Windows Explorer, 16-bit display\"></p>\n\n<p><strong>WPF Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/pU7gz.png\" alt=\"WPF Application, 16-bit display\"></p>\n\n<p><strong>Windows Forms Application:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/wDIZO.png\" alt=\"Windows Forms Application, 16-bit display\"></p>\n\n<p>On 16-bit displays, Windows Explorer and WPF use the 24-bit format, but Windows Forms does not.  In this case, it used the 8-bit format. My real application icon did not have an 8-bit variant (but I'm going to make one now!), so Windows Forms used the 4-bit variant.</p>\n\n<p><strong>How can I make my Windows Forms application display the 24-bit version of an icon in its title bar on a 16-bit display?</strong></p>\n"},{"tags":[".net","windows-8","licensing","winrt","windows-store-apps"],"answer_count":2,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":197,"score":8,"question_id":13033026,"title":"Programmatically renew Windows 8 developer license?","body":"<p>I'm trying to set up some automated testing against a Windows Store application. The big problem I see is that this will be setup a server we'd rather not touch and it just magically keep on building and running tests. This is a problem because Windows Store apps require a developer license to build or do anything with(like side-loading). And developer licenses must be renewed every 30 days. </p>\n\n<p>Is there a programmatic way of renewing a developer license or some way to side-step this issue? I'd really rather not have to worry about logging into the build server every 30 days to renew the license</p>\n"},{"tags":["c#",".net","xml","linq","nhibernate"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13253395,"title":"Altering NHibernate config file using c# linq","body":"<p>let us consider the following web.config file </p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;section name=\"hibernate-configuration\" type=\"NHibernate.Cfg.ConfigurationSectionHandler, NHibernate\"/&gt;\n  &lt;/configSections&gt;\n  &lt;hibernate-configuration xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n    &lt;session-factory&gt;\n      &lt;property name='proxyfactory.factory_class'&gt;NHibernate.ByteCode.Castle.ProxyFactoryFactory, NHibernate.ByteCode.Castle\n      &lt;/property&gt;\n      &lt;property name=\"connection.provider\"&gt;\n       NHibernate.Connection.DriverConnectionProvider\n      &lt;/property&gt;\n\n     &lt;property name=\"connection.connection_string\"&gt;\n         Server=myServerAddress;Port=1234;Database=myDataBase;Uid=myUsername;Pwd=myPassword;\n      &lt;/property&gt;\n      &lt;property name=\"dialect\"&gt;\n        NHibernate.Dialect.MySQLDialect\n      &lt;/property&gt;\n      &lt;property name=\"show_sql\"&gt;\n        false\n      &lt;/property&gt;\n      &lt;property name=\"hbm2ddl.keywords\"&gt;none&lt;/property&gt;\n    &lt;/session-factory&gt;\n  &lt;/hibernate-configuration&gt;\n   &lt;startup&gt;\n  &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;&lt;/startup&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;qualifyAssembly partialName=\"MySql.Data\" fullName=\"MySql.Data, Version=5.1.7.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d\" /&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<p>My query is to change the value in the <strong></strong> tag</p>\n\n<p><strong>old value:</strong></p>\n\n<pre><code>&lt;property name=\"connection.provider\"&gt;\n       NHibernate.Connection.DriverConnectionProvider\n      &lt;/property&gt;\n</code></pre>\n\n<p><strong>new value</strong></p>\n\n<pre><code>&lt;property name=\"connection.provider\"&gt;\n      Sample.DriverConnectionProvider\n      &lt;/property&gt;\n</code></pre>\n\n<p>For that I used:</p>\n\n<pre><code> XDocument doc = XDocument.Load(\"path to webconfig\");\n\n var xElems = from x in doc.Descendants()\n            where x.Name.LocalName == \"property name=\\\"connection.provider\\\"\"\n                  select x;\n\n                foreach (var xElem in xElems)\n                {\n                    Console.WriteLine(xElem.Attribute(\"name\"));\n                }\n</code></pre>\n\n<p>But while I view the document I get the view in xdoc as:</p>\n\n<pre><code>//&lt;property name=\"connection.provider\" xmlns=\"urn:nhibernate-configuration-2.2\"&gt;\n</code></pre>\n\n<p>How can I solve this issue?</p>\n"},{"tags":["c#","java",".net","dependency-injection","inversion-of-control"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":55,"score":-2,"question_id":13256826,"title":"IoC/DI in world of .NET/Java","body":"<p>I`am a professional .NET developer and i know a lot of places, where IoC and in particular DI can improve application architecture (modularity, different interfaces abstractions, design-time proxies, advanced unit-testing, etc).\nI know a lot of different frameworks for building loose-couple application design, such as Prism, MEF, Castle, ets., and every one implement/support IoC(DI) principles. </p>\n\n<p>But i also interested in Java development, and i want to know:\n<em>is IoC/DI are popular in world of Java and if it so, i want to figure out the most used area of this concepts and the most popular frameworks which can provide best facilities of using it?</em></p>\n"},{"tags":[".net","mvc","routing","webforms"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1503,"score":1,"question_id":1470997,"title":"Html.ActionLink construct wrong link when a non-mvc route is added","body":"<p>I have an application here with a mix of webform and mvc. I specify the routing as below</p>\n\n<pre><code>        routes.Add(\"AspxRoute\", new Route(\"Upload/New\", new WebFormRouteHandler&lt;Page&gt;(\"~/Uploads.aspx\")));\n\n        routes.MapRoute(\n            \"Default\",                                              // Route name\n            \"{controller}/{action}/{id}\",                           // URL with parameters\n            new { controller = \"Home\", action = \"Index\", id = \"\" }  // Parameter defaults\n        );\n</code></pre>\n\n<p>So that virtual path to \"Upload/New\" actually maps to an aspx webform page.</p>\n\n<p>But my problem is that Html.ActionLink(\"Test\", \"Controller\", \"Action\") now renders </p>\n\n<blockquote>\n  <p>/Upload/New?Controller=Controller&amp;Action=Action</p>\n</blockquote>\n\n<p>Having looked at the MVC source code, I understand that it is because ActionLink calls to <em>RouteCollection.GetVirtualPath(requestContext, routeName, mergedRouteValues)</em>, where routeName is left to null. And somehow this defaults to use the AspxRoute route to construct the url. I tried to added another route before \"AspxRoute\", but it seems it always defaults to the non-mvc routehandler one.</p>\n\n<p>How does <em>RouteCollection.GetVirtualPath</em> behave when routeName is null? And why is it behaving this way for my case?</p>\n\n<p>How do I construct a correct url? Do I need to write a new Htmlhelper extension?</p>\n\n<p>Cheers</p>\n"},{"tags":["c#","c++",".net","com-interop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13256440,"title":"What is the equivalent of _bstr_t in C#","body":"<p>I am working on a project where I need to convert C++ code to C#.</p>\n\n<p>I came across <code>_bstr_t</code> in the code I would like to know how the equivalent in C#.</p>\n"},{"tags":[".net","msbuild","automation","nant"],"answer_count":12,"favorite_count":63,"up_vote_count":105,"down_vote_count":0,"view_count":11756,"score":105,"question_id":476163,"title":"Nant or MSBuild, which one to choose and when?","body":"<p>I am aware there are other nant and msbuild related questions on stack overflow, but I could not find a direct comparison between the two and so here is the question.</p>\n\n<p>When should one choose Nant over MSBuild? Which one is better for what?\nIs Nant more suitable for home/open source projects and MSBuild for work projects?\nWhat is your experience with any of the two?</p>\n"},{"tags":[".net","session","authentication"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256308,"title":"Check Session Variables in each HTTP Request with .NET","body":"<p>Is there a way in .NET to check the existence of certain Session variables upon each HTTP request, without having to include this check in each page's code behind?</p>\n"},{"tags":[".net","timeout","internet-explorer-9","watin"],"answer_count":0,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":42,"score":7,"question_id":13250532,"title":"Browser.AttachTo<T>() causes intermittent exception \"Timeout while Internet Explorer busy\"","body":"<p>A WatiN step that runs as part of a continuous integration build process is failing while attempting to attach to a browser instance intermittently. Currently about 1 in 5 times.</p>\n\n<pre><code>Browser.AttachTo&lt;IE&gt;(Find.ByTitle(\"Title of Popup\"));\n</code></pre>\n\n<p>With the following error:</p>\n\n<pre><code>WatiN.Core.Exceptions.TimeoutException: Timeout while Internet Explorer busy\n   at WatiN.Core.UtilityClasses.TryFuncUntilTimeOut.ThrowTimeOutException(Exception lastException, String message)\n   at WatiN.Core.UtilityClasses.TryFuncUntilTimeOut.HandleTimeOut()\n   at WatiN.Core.UtilityClasses.TryFuncUntilTimeOut.Try[T](DoFunc`1 func)\n   at WatiN.Core.WaitForCompleteBase.WaitUntil(DoFunc`1 waitWhile, BuildTimeOutExceptionMessage exceptionMessage)\n   at WatiN.Core.Native.InternetExplorer.IEWaitForComplete.WaitUntilNotNull(DoFunc`1 func, BuildTimeOutExceptionMessage exceptionMessage)\n   at WatiN.Core.Native.InternetExplorer.IEWaitForComplete.WaitWhileIEBusy(IWebBrowser2 ie)\n   at WatiN.Core.Native.InternetExplorer.IEWaitForComplete.WaitForCompleteOrTimeout()\n   at WatiN.Core.WaitForCompleteBase.DoWait()\n   at WatiN.Core.Native.InternetExplorer.AttachToIeHelper.FinishInitializationAndWaitForComplete(IE ie, SimpleTimer timer, Boolean waitForComplete)\n   at WatiN.Core.Native.InternetExplorer.AttachToIeHelper.Find(Constraint findBy, Int32 timeout, Boolean waitForComplete)\n   at WatiN.Core.Browser.AttachTo[T](Constraint constraint)\n</code></pre>\n\n<p>I've done all the obvious things which have been suggested in previous posts:</p>\n\n<p>I.e. Kill all internet explorer processes before running a WatiN step:</p>\n\n<pre><code>Process.GetProcessesByName(\"IEXPLORE\").ToList().ForEach(p =&gt; p.Kill());\n</code></pre>\n\n<p>Increase the timeouts before running any WatiN steps:</p>\n\n<pre><code>var timeout = 60;\nSettings.AttachToBrowserTimeOut = timeout;\nSettings.WaitForCompleteTimeOut = timeout;\nSettings.WaitUntilExistsTimeOut = timeout;\n</code></pre>\n\n<p>Each WatiN step is passed in as an action in the following code block:</p>\n\n<pre><code>public void UseAndCloseBrowser(Action&lt;Browser&gt; action, Browser browser)\n{\n    try\n    {\n        action(browser);\n        browser.WaitForComplete();\n    }\n    finally\n    {\n        Log(Level.Info, \"Attempting to close browser {0}\", browser.Title);\n        browser.Close();\n        browser.Dispose();\n    }\n\n}\n</code></pre>\n\n<p>Does anyone know of something else I can do/check to get to the bottom of this annoying error message?</p>\n"},{"tags":[".net","soap","wsdl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13256221,"title":"Parsing s-gensym3 from .NET Soap Client","body":"<p>I was given a WSDL from a client that contains a different response on a method then the actual response from the API.  I used the WSDL and created a .NET client service to consume their API.  The response contains this weird xml node, <code>s-gensym3</code>, instead of the actual part name <code>getUserIdReturn</code>.  I tried to mess with the WSDL and update this but I still can't seem to get it to return the correct value.  The raw response in Fiddler is correct, just the strongly typed .NET code isnt returning that value to me.  Any suggestions?</p>\n"},{"tags":[".net","winforms","deployment"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256095,"title":"Deployment solution for Windows Applications","body":"<p>I have a tool that allows developers to deploy their applications in our environments in here and, when it comes to ASP.NET Applications they publish their entire application with a <strong>transformed web.config</strong>, for instance, a file without connection strings settings.</p>\n\n<p>This is done because we have one DEVELOPMENT ENVIRONMENT with a \"parent-level\" web.config which has the defined connectionstring pointing to the development database. Later on, when the developer wants to deploy his solution in the PRODUCTION ENVIRONMENT, because of the parent-level web.config, it point to the proper Production database.</p>\n\n<p>I'd like this behavior to be similar to Windows Applications. I know that probably I could put the connectionstrings in the machine.config file, but that file is a little too big and too critical to be touched. I'd like something like this:</p>\n\n<pre><code>|_PARENT FOLDER\n|---parent.app.config (with connectionstring)\n|___EXECUTABLE FOLDER\n|------MyExe.exe\n|------samelevel.app.config (without connectionstrings)\n</code></pre>\n\n<p>When the MyExe.exe executable tries to retrieve the connectionstring and finds out that there is none in the <strong>samelevel.app.config</strong> file, then it would automatically go into the parent level (or any other configured folder) and get it from the <strong>parent.app.config</strong> file.</p>\n\n<p>Is it possible to be done?</p>\n"},{"tags":[".net","propertygrid","collectioneditor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13255947,"title":"Is it possible to embed the Collection Editor of a Property Grid inside a panel?","body":"<p>the standard behaviour is to launch it in a new window.</p>\n\n<p><img src=\"http://i.stack.imgur.com/2IvAp.jpg\" alt=\"enter image description here\"></p>\n\n<p>is there any way that form could be embedded inside another form's panel? Basically to have the PropertyGrid and the Colelction Editor standing side by side in a form?</p>\n"},{"tags":[".net","accordion","objectdatasource"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13166941,"title":"Objectdatasource","body":"<p>Good people\ni appologize in advance for my basic english.\nMy problem is as follows\nI've place a gridview inside an accordion, inside another accordion.\nEachone asociated to an objectdatasource.\nNow, each objectdatasource have an onselecting event for writing a e.InputParameters.\nThe problem is that one of the parameters i want to write is in the dataitem of the item that contains the objectdatasource.</p>\n\n<p>The args of the obselected function are:\nByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs</p>\n\n<p>The firstone is a ObjectDataSourceView wich has not a namingcontainer. And i can't get any reference of de dataitem from the ObjectDataSourceSelectingEventArgs.</p>\n\n<p>So, my question here is how can y get the reference of the objectdatasource, the item who containit or the dataitem asociated to that particular item into my \"onselecting\" function.</p>\n\n<p>thanks in advance.</p>\n\n<p>The vb is</p>\n\n<pre><code>Imports System.Data.SqlClient\n\nPublic Class WebForm2\n    Inherits System.Web.UI.Page\n\n    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load\n\n    End Sub\n\n    Protected Sub Page_lala(ByVal sender As Object, ByVal e As EventArgs) Handles Me.InitComplete\n        Accordion1.DataSourceID = ObjectDataSource1.UniqueID\n        Accordion1.DataBind()\n    End Sub\n\n    Protected Sub Accordion1_OnItemCommand(ByVal sender As Object, ByVal e As AjaxControlToolkit.AccordionCommandEventArgs) Handles Accordion1.ItemCommand\n        Dim Accordion2 As Control = e.Container.FindControl(\"Accordion2\")\n        Dim objectDataSource As Control = e.Container.FindControl(\"ObjectDataSource2\")\n        If Accordion1 IsNot Nothing And objectDataSource IsNot Nothing Then\n            AddHandler DirectCast(objectDataSource, ObjectDataSource).Selecting, AddressOf ObjectDataSource2_selecting\n            AddHandler DirectCast(Accordion2, AjaxControlToolkit.Accordion).ItemCommand, AddressOf Accordion2_ItemCommand\n            DirectCast(Accordion2, AjaxControlToolkit.Accordion).DataSourceID = DirectCast(objectDataSource, ObjectDataSource).ID\n            DirectCast(Accordion2, AjaxControlToolkit.Accordion).DataBind()\n        End If\n    End Sub\n\n    Protected Sub ObjectDataSource2_selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs)\n        Dim parameters(0) As SqlParameter\n        Dim dsv As ObjectDataSourceView = DirectCast(sender, ObjectDataSourceView)\n        parameters(0) = New SqlParameter(\"@cliente\", \"30697269610\")\n        e.InputParameters(\"param\") = parameters\n    End Sub\n\n    Protected Sub ObjectDataSource3_selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.ObjectDataSourceSelectingEventArgs)\n        Dim parameters(0) As SqlParameter\n        Dim dsv As ObjectDataSourceView = DirectCast(sender, ObjectDataSourceView)\n        parameters(0) = New SqlParameter(\"@documento\", \"FC0030-00040199\")\n        e.InputParameters(\"param\") = parameters\n    End Sub\n\n    Protected Sub Accordion2_ItemCommand(ByVal sender As Object, ByVal e As AjaxControlToolkit.AccordionCommandEventArgs) 'Handles Accordion2.ItemCommand\n        Dim gridview As Control = e.Container.FindControl(\"gridviewAplicaciones\")\n        Dim objectDataSource As Control = e.Container.FindControl(\"ObjectDataSource3\")\n        If gridview IsNot Nothing And objectDataSource IsNot Nothing Then\n            AddHandler DirectCast(objectDataSource, ObjectDataSource).Selecting, AddressOf ObjectDataSource3_selecting\n            DirectCast(gridview, GridView).DataSourceID = DirectCast(objectDataSource, ObjectDataSource).ID\n            DirectCast(gridview, GridView).DataBind()\n        End If\n    End Sub\n\nEnd Class\n</code></pre>\n\n<p>the asp is</p>\n\n<pre><code>&lt;%@ Page Language=\"vb\" AutoEventWireup=\"false\" CodeBehind=\"WebForm2.aspx.vb\" Inherits=\"WebApplication4.WebForm2\" %&gt;\n\n&lt;%@ Register Assembly=\"AjaxControlToolkit\" Namespace=\"AjaxControlToolkit\" TagPrefix=\"asp\" %&gt;\n\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=\"form1\" runat=\"server\"&gt;\n    &lt;div&gt;\n        &lt;asp:UpdatePanel ID=\"UpdatePanel1\" runat=\"server\"&gt;\n        &lt;ContentTemplate&gt;\n        &lt;asp:ScriptManager ID=\"ScriptManager1\" runat=\"server\" &gt;\n        &lt;/asp:ScriptManager&gt;\n            &lt;asp:Accordion id=\"Accordion1\" runat=\"server\" \n             SelectedIndex=\"-1\" RequireOpenedPane=\"false\"  ClientIDMode=\"Static\"&gt;\n            &lt;HeaderTemplate&gt;&lt;%# Container.DataItem(\"CUSTNMBR\")%&gt; / &lt;%# Container.DataItem(\"CUSTNAME\")%&gt;&lt;/HeaderTemplate&gt;\n            &lt;ContentTemplate&gt;\n                &lt;asp:LinkButton runat=\"server\" ID=\"LinkButton1\" Text=\"ver mas 1\"&gt;&lt;/asp:LinkButton&gt;\n                &lt;asp:Accordion id=\"Accordion2\" runat=\"server\" OnItemCommand=\"Accordion2_ItemCommand\"\n                 SelectedIndex=\"-1\" RequireOpenedPane=\"false\"&gt;\n                    &lt;HeaderTemplate&gt;&lt;%# Container.DataItem(\"DOCNUMBR\")%&gt;&lt;/HeaderTemplate&gt;\n                    &lt;ContentTemplate&gt;\n                    &lt;asp:LinkButton runat=\"server\" ID=\"LinkButton2\" Text=\"Ver mas2\" \n                    &gt;&lt;/asp:LinkButton&gt;\n                    &lt;asp:GridView runat=\"server\" ID=\"gridviewAplicaciones\" AutoGenerateColumns=\"true\"&gt;\n                    &lt;/asp:GridView&gt;\n                    &lt;asp:ObjectDataSource ID=\"ObjectDataSource3\" runat=\"server\"\n                        SelectMethod=\"ExecuteDataset\" TypeName=\"WebApplication4.DbHelper\"&gt;\n                        &lt;SelectParameters&gt;\n                            &lt;asp:Parameter DefaultValue=\"multiconex_aplicaciones\" Name=\"nombreSP\" \n                                Type=\"String\"  /&gt;\n                            &lt;asp:Parameter Name=\"param\" Type=\"Object\" /&gt;\n                        &lt;/SelectParameters&gt;\n                        &lt;/asp:ObjectDataSource&gt;\n                    &lt;/ContentTemplate&gt;\n\n                &lt;/asp:Accordion&gt;\n                &lt;asp:ObjectDataSource ID=\"ObjectDataSource2\" runat=\"server\"\n                     SelectMethod=\"ExecuteDataset\" TypeName=\"WebApplication4.DbHelper\" &gt;\n                        &lt;SelectParameters&gt;\n                            &lt;asp:Parameter DefaultValue=\"multiconex_aging\" Name=\"nombreSP\" \n                                Type=\"String\" /&gt;\n                            &lt;asp:Parameter Name=\"param\" Type=\"Object\"  /&gt;\n                        &lt;/SelectParameters&gt;\n                     &lt;/asp:ObjectDataSource&gt;\n                &lt;/ContentTemplate&gt;\n\n            &lt;/asp:Accordion&gt;\n           &lt;asp:ObjectDataSource ID=\"ObjectDataSource1\" runat=\"server\"\n                SelectMethod=\"ExecuteDataset\" TypeName=\"WebApplication4.DbHelper\"&gt;\n                &lt;SelectParameters&gt;\n                    &lt;asp:Parameter DefaultValue=\"multiconex_rm00101\" Name=\"nombreSP\" \n                        Type=\"String\" /&gt;\n                    &lt;asp:Parameter Name=\"param\" Type=\"Object\" /&gt;\n                &lt;/SelectParameters&gt;\n           &lt;/asp:ObjectDataSource&gt;\n        &lt;/ContentTemplate&gt;\n        &lt;/asp:UpdatePanel&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["c#",".net","environment-variables"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13255745,"title":"pass custom environment variables to System.Diagnostics.Process","body":"<p>I'm working on an app that invokes external processes like so:</p>\n\n<pre><code>ProcessStartInfo startInfo = new ProcessStartInfo(PathToExecutable, Arguments){\n     ErrorDialog = false,\n     RedirectStandardError = true,\n     RedirectStandardOutput = true,\n     UseShellExecute = false,\n     CreateNoWindow = true,\n     WorkingDirectory = WorkingDirectory\n };\n\nusing (Process process = new Process()) {\n    process.StartInfo = startInfo;\n\n    process.Start();\n    process.BeginErrorReadLine();\n    process.BeginOutputReadLine();\n    process.WaitForExit();\n\n    return process.ExitCode;\n}\n</code></pre>\n\n<p>One of the processes I'm calling depends on an environment variable that I'd rather not require my users to set.  Is there any way to modify the environment variables that get sent to the external process?  Ideally I'd be able to make them visible only to the process that's running, but if I have to programmatically set them system-wide, I'll settle for that (but, would UAC force me to run as administrator to do that?)</p>\n\n<p>ProcessStartInfo.EnvironmentVariables is read only, so a lot of help that is...</p>\n"},{"tags":["c#",".net","mvc","partial-views"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":499,"score":0,"question_id":4432856,"title":"Passing correct model to partial view","body":"<p>I have been looking at this error for quite some time, and can't seem to figure out what I might have done wrong.</p>\n\n<p>I have a partial view which is added like this:</p>\n\n<pre><code>        &lt;% Html.RenderPartial(\"~/Views/ForumPosts/ForumPostCreateForm.ascx\", ViewData.Model); %&gt;\n</code></pre>\n\n<p>And the top of the partial view looks like this:</p>\n\n<pre><code>&lt;%@ Control Language=\"C#\" AutoEventWireup=\"true\" Inherits=\"System.Web.Mvc.ViewUserControl&lt;xxxx.Web.Controllers.ForumThreadsController.ForumThreadFormViewModel&gt;\" %&gt;\n</code></pre>\n\n<p>The error I receive is the following:</p>\n\n<p><em>The model item passed into the dictionary is of type 'xxx.Core.ForumThread', but this dictionary requires a model item of type 'xxx.Web.Controllers.ForumThreadsController+ForumThreadFormViewModel'.</em></p>\n\n<p>If am not mistaken both takes the model called ForumThread, but apparently I must have missed something.</p>\n"},{"tags":["asp.net",".net","nhibernate","memory-management","iis-7.5"],"answer_count":3,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":158,"score":8,"question_id":13197455,"title":"Memory usage between 32-bit pool and 64-bit pool","body":"<p>We have an ASP.NET application, built around MonoRail and NHibernate, and I have noticed a strange behavior between if running it with 64-bit mode or 32-bit mode. Everything is compiled as AnyCPU, and runs fine with both modes, but the memory usage differs dramatically.</p>\n\n<p>Look at the following snapshots from ANTS:</p>\n\n<p><a href=\"http://upload.grabbarna.se/files/32bit_snapshot.png\" rel=\"nofollow\">http://upload.grabbarna.se/files/32bit_snapshot.png</a></p>\n\n<p>vs</p>\n\n<p><a href=\"http://upload.grabbarna.se/files/64bit_snapshot.png\" rel=\"nofollow\">http://upload.grabbarna.se/files/64bit_snapshot.png</a></p>\n\n<p>The usage scenario for both snapshots are pretty much equivalent (I have hit the same pages on both runs).</p>\n\n<p>Firstly, why is the Unused memory so high in 64-bit mode? And why would unmanaged memory be 4 times the size on 64-bit mode?</p>\n\n<p>Any insight on this would be really helpful.</p>\n"},{"tags":[".net","wcf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13253552,"title":"disconnecting issues in wcf clients","body":"<p>i have a WCF multiple game service.the clients connect to server and call some methods.\nif one client lost connection,how to reconnect to the server?is there any event for connection lost?\nhow server resume its session and return result of method call that was called before disconnection?\ncan anyone give me some posts or articles about this issues.\nsorry for bad English.\nthanks for help</p>\n"},{"tags":["c#",".net","visual-studio","generics","visual-studio-2012"],"answer_count":3,"favorite_count":2,"up_vote_count":21,"down_vote_count":1,"view_count":553,"score":20,"question_id":12426851,"title":"Visual Studio 2012 - Self Referencing Generics Parsing Errors","body":"<p>I'm having a bit of trouble here, in our company we have a self rolled DA layer which uses self referencing generics. In Visual Studio 2010, the IDE was perfectly happy with this, however 2012 seems to be having difficulty, even though when we build, it succeeds.</p>\n\n<p>Here is an example:</p>\n\n<p><img src=\"http://i.stack.imgur.com/h7LCq.png\" alt=\"Example of parsing error\"></p>\n\n<p>The DataObject definition is as follows:</p>\n\n<pre><code>[TypeDescriptionProvider(typeof(HyperTypeDescriptor.HyperTypeDescriptionProvider))]\npublic class DataObject&lt;T&gt; : \n    INotifyPropertyChanged, \n    IDataErrorInfo, \n    IEditableObject, \n    IDataObject \n    where T : \n        DataObject&lt;T&gt;, \n        new()\n</code></pre>\n\n<p>I realise it isn't the simplest of definitions, but its legal, and it builds perfectly fine. </p>\n\n<p>However, this 'issue' causes intellisense to fail, as well as the 'Go To Definition' function, which needless to say is frustrating. </p>\n\n<p>I've tried removing and re-adding the references, but the issue persists. </p>\n\n<p>VS2010 is perfectly happy and is what I have gone back to using, VS2012 is very nice and responsive but if this issue persists its a deal breaker. </p>\n\n<p>Anyone got any ideas?</p>\n\n<hr>\n\n<p>Want to make a couple of things clear, this issue is an intermittent one (which is a pain as its really hard to track the root cause).</p>\n\n<p>It breaks intellisense and 'go to definition' everywhere, not just for the class with the error.</p>\n\n<p>I'll have a go at building a example solution to submit to connect, but time isn't on my side lately.  </p>\n"},{"tags":["c#",".net","wpf","input","focus"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13241437,"title":"WPF application with several windows including a non active: focus issue","body":"<p>I have a .Net 4 application with two windows in WPF 4:</p>\n\n<ul>\n<li>One uses the WS_EX_NOACTIVATE style to prevent gaining focus. </li>\n<li>The other is a basic Window.</li>\n</ul>\n\n<p>The \"no-activate\" window behavior is appropriate as soon as I do not select the basic window (it doesn't gains the focus). But when the basic window is selected, the \"no-activate\" window can be focused... and gains it when the user clicked on it.</p>\n\n<p>It is as if WPF considered two windows of the same application had the right to give focus even if they are not supposed to.\nThis behavior does not happen if both windows are WS_EX_NOACTIVATE.</p>\n\n<p>Have you ever been faced with this problem?\nI have read this: <a href=\"http://blogs.msdn.com/b/visualstudio/archive/2010/03/09/wpf-in-visual-studio-2010-part-3-focus-and-activation.aspx\" rel=\"nofollow\">WPF in Visual Studio 2010 – Part 3 : Focus and Activation</a>, but does not solve it.</p>\n\n<p><strong>Edit:</strong> I have been able to get around by using a Popup as a base class for my no-active Window. However, I don't want to have a Popup. Why !? The popup never receives the focus: does someone know why / how ? How can I reproduce this behavior to a Window ? \nI try to step into Popup / Window code, but it is not very clear !</p>\n\n<p>Thanks !</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","wcf","web-api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13254185,"title":"Web Api call not returning __type in JSON response","body":"<p>We have an MVC website that was calling through to WCF Restful services but we are now replacing them with Web Api calls.  The problem is that existing code in some of the MVC controllers is relying on the \"__type\" attribute being returned for each object in the JSON so it can do different things depending on the type of the object.</p>\n\n<p>However, in the new Web Api responses, each of the objects returned don't have the \"__type\" entries in the JSON so the code is failing.</p>\n\n<p>Does anyone know how this is done?  I've found plenty about removing the __type entries for WCF services but nothing yet for making sure they're in for Web Api.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":116,"score":1,"question_id":9024967,"title":"Adjust DataGridView's columns to fill available space if the grid is smaller and use scroll in case the grid bigger than the space available","body":"<p>I want to adjust all columns of a DataGridView according to the required space to show all its data completely. If the space required is smaller than the available space i want the grid to fill this exceeding space, but if the available is space is not enough to display properly all columns i want to DataGridView create automatically a scroll. Is there an easy way to do this?</p>\n"},{"tags":["c#",".net","ajax","gridview","modalpopupextender"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13241705,"title":"Open an ajax modalpopup with details from gridview cells","body":"<p>I've got a gridview with a appointment information in.  What I want to do is have a linkbutton in each cell (which will be created at runtime) and open a modal popup showing the details of the appointment. Any help would be greatly appreciated.</p>\n\n<p>So far I've got, but it won't fire the linkbutton</p>\n\n<pre><code>&lt;asp:GridView ID=\"Grd\" runat=\"server\" AutoGenerateColumns=\"true\" onrowdatabound=\"Grd_RowDataBound\"&gt;&lt;/asp:GridView&gt;&lt;asp:Button ID=\"btnShowPopup\" style=\"display:none\" runat=\"server\"  /&gt;\n&lt;ajaxToolkit:ModalPopupExtender\nID=\"ModalPopupExtender1\" runat=\"server\" TargetControlID=\"btnShowPopup\" PopupControlID=\"pnlpopup\" CancelControlID=\"ImgCancel\" &gt;&lt;/ajaxToolkit:ModalPopupExtender&gt;\n&lt;asp:Panel ID=\"pnlpopup\" runat=\"server\" Width=\"400px\" &gt;&lt;!--Show Details--!&gt;\n &lt;asp:ImageButton ID=\"imgCancel\"  AlternateText=\"cancel\"  Height=\"25\" Width=\"25\" runat=\"server\" ImageAlign=\"Right\" /&gt;\n&lt;/asp:Panel&gt;\n</code></pre>\n\n<p>code behind</p>\n\n<pre><code>protected void Grd_RowDataBound(object sender, GridViewRowEventArgs e)\n    {\n        if (e.Row.RowType == DataControlRowType.DataRow)\n        {\n            //Split out the visit details &amp; format\n            for (int i = 0; i &lt;= e.Row.Cells.Count - 1; i++)\n            {\n\n                LinkButton lnk = new LinkButton();\n                lnk.Text = \"Details for:\" + \"&lt;br /&gt;\" + e.Row.Cells[i].Text; \n\n                lnk.CommandName = \"ShowDetails\";\n                lnk.Command += LinkButton_Command;\n                e.Row.Cells[i].Controls.Add(lnk);\n\n\n            }\n\n\n\n        }\n    }\n    protected void LinkButton_Command(object sender, CommandEventArgs e)\n    {\n        if (e.CommandName == \"ShowDetails\")\n        {\n\n            LinkButton btndetails = sender as LinkButton;\n\n            GridViewRow gvrow = (GridViewRow)btndetails.NamingContainer;\n\n            this.ModalPopupExtender1.Show();\n\n\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","vb.net","visual-studio-2010","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":68,"score":-3,"question_id":13254686,"title":"Trying to compile to release mode for the first time and it bring up errors","body":"<p>Can anyone tell me why when I try and build my solution in debug it works fine but then when I try to do it in release I get a wack of errors, especially with some referenced .dlls not being referenced anymore.</p>\n\n<p>I have been working on this project for a while it is very big, and has alot of dependencies. I am now ready for it's first release copy and I cant get it going, I feel like I am missing something. Is there any flaws to distributing a debug copy of the software?</p>\n\n<p>My next question is should I try and compile to any CPU or just compile to x86. I would like for everyone to be able to use the software? What is the norm?</p>\n\n<p>Software is in vb.net using visual studio 2010.</p>\n"},{"tags":["c#",".net","stream"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13241894,"title":"Access TextReader as a Stream","body":"<p>I would like to have similar functionality for a TextReader that a Stream has.  Specifically the ability to set position in the stream.  Is there any way to change a TextReader into a stream?</p>\n\n<p>I would like to accept a TextReader but access it like a Stream.</p>\n"},{"tags":[".net","directshow","reverse-engineering","directshow.net","graphedit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13254440,"title":"How to find the IMoniker used to create a source filter?","body":"<p>Currently I'm writing a DirectShow based application that should help users configuring their TV capture cards, since GraphEdit seems to be too difficult for most to understand. The idea is that this application exports the generated Graph to a <a href=\"http://msdn.microsoft.com/en-us/library/aa451348.aspx\" rel=\"nofollow\">.GRF file</a>, that will be used in another application.</p>\n\n<p>Users can select which device (<a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms679705%28v=vs.85%29.aspx\" rel=\"nofollow\">IMoniker</a>) should be used to create a source filter, and can change some settings regarding video / audio.</p>\n\n<p>Next to exporting .GRF files, my application should also have the feature to import such files. My question is: how do I find what moniker / device was used to create the source filter in the imported graph?</p>\n\n<p>I tried creating a list of source filters for all connected devices, and comparing those to the source filter in the imported graph, but that did not seem to work.</p>\n"},{"tags":["c#",".net","data-binding","collections","expression-blend"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13251571,"title":"Bind Collections to an other Collection in Blend","body":"<p>Is it possible to bind a Collection to an other one?</p>\n\n<p>Let say I have MyButton control (a button with a collection of string), x:Name=\"MyButton1\"</p>\n\n<p>In his template, I have another MyButton control, x:Name=\"MyButton2\". </p>\n\n<p>I want to bind MyButton2.Collection to MyButton.Collection.</p>\n\n<p>I tried these:</p>\n\n<pre><code>1) {Binding MyCollection, RelativeSource={RelativeSource Self}}\n2) {Binding MyCollection, RelativeSource={RelativeSource TemplatedParent}}\n3) {Binding MyCollection, RelativeSource={RelativeSource AncestorType={x:Type MyButton}}}\n</code></pre>\n\n<p>But it seems that it's not possible... always have error \"The property value is not valid.\"</p>\n"},{"tags":[".net","windows","winforms","datagrid","compact-framework"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12143734,"title":"Make DataGrid cells readonly","body":"<p>There is DataGrid (WinForms / .NET CF 3.5) bounded with DataSource to list object.\nHow to disable data editing in cells?</p>\n"},{"tags":[".net","tcpclient"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13254785,"title":"Too much writing on a socket?","body":"<p>I am getting an IOException when I write to a TCP socket. This doesn't happen on lan. Am i writing too much to quickly? Does w which is a BinaryWriter to the TcpClient NetworkStream not block? How do i push out data on a tcpclient connection?</p>\n\n<pre><code>w.Write((byte)Commands.update);\nw.Write(filelen);\nvar amount=0;\nvar b = new byte[1024 * 16];\nwhile (amount &lt; filelen)\n{\n    var l = f.Read(b, 0, b.Length);\n    w.Write(b, 0, l);\n    amount += l;\n}\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":11,"favorite_count":25,"up_vote_count":103,"down_vote_count":1,"view_count":82457,"score":102,"question_id":105770,"title":".NET String.Format() to add commas in thousands place for a number","body":"<p>I want to add a comma in the thousands place for a number. String.Format()?</p>\n"},{"tags":["c#",".net","entity-framework-4","composite-key"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13249438,"title":"Entity Framework Code First One to One relationship on composite key","body":"<p>Basically what I am trying to achieve is I have three tables, one parent will always have an entry in it and only one of the other two tables will be populated. The complexity that I am dealing with is that the primary key for the tables is the combination of two fields</p>\n\n<pre><code>ParentTable\n-----------\nUniqueID\nOwnerID\n[Some more fields]\n\n\nChildTable1\n-----------\nUniqueID\nOwnerID\n[Some more fields]\n\n\nChildTable2\n-----------\nUniqueID\nOwnerID\n[Some more fields]\n</code></pre>\n\n<p>I was wondering if anyone has any suggestions on how best to do this through EF Code First preferably using the Fluent API.</p>\n"},{"tags":[".net","styles","mschart","axes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13231052,"title":"How to style markers on .NET Chart axes","body":"<p>I need to indicate points on the X and Y axes of a .NET Chart(class System.Web.UI.DataVisualization.Charting.Chart) as hyphen-style markers. Right now the X and Y axes are completely plain. </p>\n\n<p>Below is a picture of how I'd like to style my chart axes (screenshot taken from another charting tool):\n<img src=\"http://i.stack.imgur.com/aRkJy.png\" alt=\"enter image description here\"></p>\n\n<p>How can I do this? </p>\n"},{"tags":[".net","vb.net","linq","visual-studio-2008",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13254064,"title":"first issue with first linq","body":"<p>I'm using vs2008 framework 3.5 and i'm looking about linq for first time, following these <a href=\"http://msdn.microsoft.com/it-it/library/bb385164(v=vs.90).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/it-it/library/bb385164(v=vs.90).aspx</a></p>\n\n<p>Creating data source like this <a href=\"http://msdn.microsoft.com/it-it/library/bb385204(VS.90).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/it-it/library/bb385204(VS.90).aspx</a></p>\n\n<p>But i can't import/use linq.  Making a consoleApplication System.Core.dll reference and imports System.Linq should be automatic right?!</p>\n\n<p>writing in main:</p>\n\n<pre><code>Dim students = GetStudents()\n'Dim students As List(Of Student) = GetStudents() 'the same thing with this one\nDim studentQuery = From currentStudent In students _\n                   Where currentStudent.Rank &lt;= 10 _\n                   Select currejt\n</code></pre>\n\n<p>The IDE doesn't like students in the query and says:</p>\n\n<pre><code>Error   1   Expression of type 'System.Collections.Generic.IEnumerable(Of ConsoleApplication1.Module1.Student)' \nis not queryable. Make sure you are not missing an assembly reference and/or namespace \nimport for the LINQ provider. ConsoleApplication1 \n</code></pre>\n\n<p>where i'm wrong!?</p>\n\n<p>If i try 'Imports System.Linq' it says </p>\n\n<blockquote>\n  <p>Warning   1   Namespace or type specified in the Imports 'System.Linq'\n  doesn't contain any public member or cannot be found. Make sure the\n  namespace or the type is defined and contains at least one public\n  member. Make sure the imported element name doesn't use any aliases.</p>\n</blockquote>\n"},{"tags":[".net","xml","xmldocument"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":370,"score":1,"question_id":4925676,"title":"XmlDocument don't save white spaces between tags","body":"<p>Part of XML:</p>\n\n<pre><code>&lt;text:p&gt;text1 &lt;text:span&gt;text2&lt;/text:span&gt; &lt;text:span&gt;text3&lt;/text:span&gt;text4&lt;/text:p&gt;\n</code></pre>\n\n<p>You can see a space between text:span tags with text2 and text3. When I call XmlDocument.Load method I have this picture:</p>\n\n<pre><code>&lt;text:p&gt;text1 &lt;text:span&gt;text2&lt;/text:span&gt;&lt;text:span&gt;text3&lt;/text:span&gt;text4&lt;/text:p&gt;\n</code></pre>\n\n<p>White space was removed, but I need this space in this place.\nSet  property \"PreserveWhitespace = true\" don't help</p>\n"},{"tags":["c#",".net","entity-framework","linq-to-entities","garbage-collection"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":13207390,"title":"How to update an existing object's properties using LINQ to Entities?","body":"<p>LINQ to Entities allows this:</p>\n\n<pre><code>context.User.Select(u =&gt; new Person\n{\n    Name = u.Name,\n    Parent = u.Parent.Name\n});\n</code></pre>\n\n<p>I need only two properties of a big <code>User</code> table and I get them using the <code>Select</code> method to create a <code>Person</code> object so I can do some processing with it. The thing is that I do this a lot (like twice a second) and it hurts the <code>GC</code>.</p>\n\n<p>So I decided to pool the <code>Person</code> objects but I have no idea how to update an existing object using LINQ to Entities. I can get it as an anonymous method like above and then assign its properties to the depooled object I guess, then I can return the depooled instance, this would at least make the anonymous instance go away in a lower generation of <code>GC</code> but...</p>\n\n<p>I'd really prefer something like this:</p>\n\n<pre><code>context.User.Select(u =&gt; People.Take(u.Name, u.Parent.Name))\n</code></pre>\n\n<p>Which throws a <code>NotSupportedException</code>.</p>\n\n<ul>\n<li>Can I use Entity Framework to update the values of an existing object?</li>\n<li>If so, how?</li>\n<li>If not, what alternatives do I have?</li>\n</ul>\n"},{"tags":["c#",".net","reflection"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":1,"view_count":74,"score":6,"question_id":13254032,"title":"Determine what class called a method?","body":"<p>This is a little hypothetical so bear with me. I have an application in mind, but not sure how to do this. Say I have some publically accessible method in a DLL that takes no parameters. Is it possible for this method to know what called it? Can it tell if it were called from a static or instantiated context? From a specific class? What can a method know about how it's being called?</p>\n"},{"tags":["c#",".net","visual-studio-2010"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13240501,"title":"saving form attributes","body":"<p>I wrote .net code and  want anyone to help me and tell if this is right or not :). I made a form with two checkboxes and two picture boxes and a button and want to save values of the checkbox and the picture box when I close the form and reload these values again after rerun.</p>\n\n<p>The code I wrote: </p>\n\n<pre><code>public partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();\n        //this.BackColor = Properties.Settings.Default.UserBackColor;\n\n        Properties.Settings.Default.Reload();\n\n    }\n\n    private void checkBox1_CheckedChanged(object sender, EventArgs e)\n    {\n        if (checkBox1.Checked == true)\n        {\n            pictureBox1.Image = Image.FromFile(\"C:\\\\red.jpg\");\n            Properties.Settings.Default.Upgrade();\n\n        }\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        Properties.Settings.Default.Save();\n        Application.Exit();\n    }\n</code></pre>\n"},{"tags":["c#",".net","colors"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13252838,"title":"Get colors between two color HEX refs or RGB","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1236683/color-interpolation-between-3-colors-in-net\">Color Interpolation Between 3 Colors in .NET</a>  </p>\n</blockquote>\n\n\n\n<p>I have been trying to get a categories list of colors using C#:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Red:\n255, 69, 0\n255, 99, 71\netc.. \n\nGreen:\n0, 250, 154\n143, 188, 139\netc...\n</code></pre>\n\n<p>So far I have been pretty unsuccessful. Ideally, what I'd like is a way to supply two HEX refs or RGB refs and get a list back of say 10 colors between those two references. Is this possible in C#?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Found this... <a href=\"http://meyerweb.com/eric/tools/color-blend/\" rel=\"nofollow\">http://meyerweb.com/eric/tools/color-blend/</a> just converting the js to c# now. Will post when its done.</p>\n"},{"tags":["c#",".net","xml","app-config"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13254078,"title":"Stop dll from using the exe.config file","body":"<p>I have a C#.NET dll which gets plugged into the main executable which is built from VC++ code(not targetting .NET).This main exe has an exe.config file which is just used as normal xml file(using non validating parser).But problem comes when some internal code(oledbconnection) in dll tries to load the config file and because it finds this config file as invalid , it crashes. I dont even need any of the values in exe.config file, so i can safely ignore that. \nSo what i need to do here is either stop dll from using the exe.config or tell dll that its valid config file(even if its not). How can i do this? or is there any other way?</p>\n\n<p>PS : I cant change the exe.config file and make it as valid file</p>\n"},{"tags":[".net","asp.net-mvc-3","caching"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13254061,"title":"MVC3 Global.asax Setting private cache","body":"<p>Is there any security or other implications when setting the Response cache to private\nint the global.asax</p>\n\n<p>Response.Cache.SetCacheability(HttpCacheability.Private);</p>\n\n<p>Can somebody explain the difference between nocache and private?</p>\n"},{"tags":[".net","firefox","google-chrome","powerbuilder","datawindow"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13240196,"title":"PowerBuilder .net Web Forms on Chrome, FireFox, Opera","body":"<p>I am using PowerBuilder 12.5 to develop a .net Web Forms\nI managed to get work on IE, but it did not work on Chrome, FireFox or Opera</p>\n\n<p>the problem is with Drop Down Data Window \n* In Chrome it does not show the list when click on the arrow\n* In FireFox ItemChanged Event does not fire!</p>\n\n<p>Is there any way or tool that allows PowerBuilder .net Web Forms work on Chrome, FireFox, Opera ?</p>\n"},{"tags":["c#",".net","httpwebrequest","console-application"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13251825,"title":"Downloading file from website","body":"<p>I have to download a file from a website. I got the authentication part done. For the file download I do not have a link to a file like <code>http://whatever.com/file.xlsx</code></p>\n\n<p>i have a url like this:</p>\n\n<pre><code>http://whatever.com?b_action=cognosViewer&amp;ui.action=view&amp;ui.object=defaultOutput(CAMID(%22eBO%3au%3a11842%22)%2ffolder%5b%40name%3d%27My%20Folders%27%5d%2freport%5b%40name%3d%27AppointmentFacility%27%5d)&amp;ui.name=AppointmentFacility&amp;ui.format=spreadsheetML\n</code></pre>\n\n<p>this is the code i am using to downoald the file </p>\n\n<pre><code>public void downloadFile(string url, string fileName)\n{\n    // Create a request using a URL that can receive a post. \n    request = (HttpWebRequest)HttpWebRequest.Create(url);\n    request.CookieContainer = cookieContainer;\n    // Set the Method property of the request to GET.\n    request.Method = \"GET\";\n    // Get the response.\n    using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())\n    {\n        using (Stream responseStream = response.GetResponseStream())\n        {\n            using (StreamReader reader = new StreamReader(responseStream))\n            {\n                using (StreamWriter writer = new StreamWriter(fileName, false))\n                {\n                    writer.Write(reader.ReadToEnd());\n                    writer.Flush();\n                    writer.Close();\n                }\n            }\n            responseStream.Close();\n        }\n        response.Close();\n    }\n}\n</code></pre>\n\n<p>but the downloaded file only contains:</p>\n\n<blockquote>\n  <p>Your report is ready and will download to your Web browser in a few moments.</p>\n</blockquote>\n\n<p>if I paste the link in chrome, it shows me a web page with : Your report.... and then starts the download.</p>\n\n<p>Thank you so much for all the help!</p>\n\n<p>Update:\ni did the Chrome crtl+shift+i -> network</p>\n\n<p>the url of the reports is :\nwhatever.com/p2pd/servlet/dispatch/gd/CAFS3c00000054FAAAACBugIFfTwbt-vZG2RFR7xOa6-wlAebBE523zHThH-tlqz0TrwhgYlE_H4sIAAAAAAAAALMODfLxdNFQ8svyNPXNyq-wrQqt9A2JLPcNcaz0q-Kt8s*KNPGtcrRV0gQAGDKw6yoAAAA_/</p>\n\n<p>if i log in on ie and paste the url, it shows me a firewall error.. \nwas looking at the session info's to see it it puts them in the link which it does not.</p>\n\n<p>This is the heaeder Information:</p>\n\n<p>GET /p2pd/servlet/dispatch/gd/CAFS3c00000054FAAAACBugIFfTwbt-vZG2RFR7xOa6-wlAebBE523zHThH-tlqz0TrwhgYlE_H4sIAAAAAAAAALMODfLxdNFQ8svyNPXNyq-wrQqt9A2JLPcNcaz0q-Kt8s*KNPGtcrRV0gQAGDKw6yoAAAA_/ HTTP/1.1</p>\n\n<p>Host: whatever.com</p>\n\n<p>Connection: keep-alive</p>\n\n<p>User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4</p>\n\n<p>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,<em>/</em>;q=0.8</p>\n\n<p>Referer: <a href=\"https://whatever.com/p2pd/servlet/dispatch\" rel=\"nofollow\">https://whatever.com/p2pd/servlet/dispatch</a></p>\n\n<p>Accept-Encoding: gzip,deflate,sdch</p>\n\n<p>Accept-Language: en-US,en;q=0.8</p>\n\n<p>Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3</p>\n\n<p>Cookie: cam_passport=101:1212028e-a300-b0b0-9a59-6b86b56842dd:2388506829; cea-ssa=false; usersessionid=AQgAAAAZQaJQGUGiUAoAAADgMgQRkOeDfHCJFAAAACBugIFfTwbt/vZG2RFR7xOa6/wlFAAAAAhIMT47wEMbibXlyTAd0JuxNeln; CRN=listViewSeparator%3Dnone%26displayMode%3Dlist%26timeZoneID%3DCST%26format%3DHTML%26automaticPageRefresh%3D30%26columnsPerPage%3D3%26productLocale%3Den%26useAccessibilityFeatures%3Dfalse%26showWelcomePage%3Dtrue%26showOptionSummary%3Dfalse%26showHiddenObjects%3Dfalse%26contentLocale%3Den%26skin%3Dcorporate%26linesPerPage%3D15%26; userCapabilities=7c6d%3B6f%3Bff071efa%26ARQAAAAgboCBX08G7f72RtkRUe8Tmuv8JQBBkqOE98nKAPC1mu7HFx2kwsKb; caf=CAFW000000b0Q0FGQTNjMDAwMDAwM2FGQUFBQUNCdWdJRmZUd2J0LXZaRzJSRlI3eE9hNi13bFRtOGJUc0pHalZqSW1mSWZ0VHg3emhkKnpMOF8zNzU2MTJ8MTAxOjEyMTIwMjhlLWEzMDAtYjBiMC05YTU5LTZiODZiNTY4NDJkZDoyMzg4NTA2ODI5; cc_session=s_cc:|s_conf:na|s_sch:td|s_hd:sa|s_serv:na|s_disp:na|s_set:|s_dep:na|s_dir:na|s_sms:dd|s_ct:sa|s_cs:sa|s_so:sa|e_hp:CAMID(*22eBO*3au*3a11842*22)|e_proot:Public*20Folders|prootid:i9E956E6B64DA4217A97F144A433887C1|e_mroot:My*20Folders|mrootid:iD973C48427A94A9AAFB17F9016C8A62A|e_mrootpath:CAMID(*22eBO*3au*3a11842*22)*2ffolder*5b*40name*3d*27My*20Folders*27*5d|e_user:FirstName*20LastName|cl:en|dcid:i9E956E6B64DA4217A97F144A433887C1|show_logon:false|uig:|ui:|write:true|eom:0|pp:2388506829|cachestamp:2012-11-06T07:46:19; ARAHHC-eBO=ARAHHC-Arka-eBO2</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13252941,"title":"Displaying a large collection of large images","body":"<p>OK, I thought this was a fairly simple task, but apparently it isn't ...</p>\n\n<p>I have a folder with +1000 photos in it. These are all photos taken with a camera, each about 3 MB. Users need to be able to view these pictures (as a list), rename or delete them. That's it.</p>\n\n<p>A possible solution would be this control : <a href=\"http://www.codeproject.com/Articles/43265/ImageListView\" rel=\"nofollow\">ImageListView - CodeProject</a>\n<br>but because it has an Apache license, we can't use it.</p>\n\n<p>So how to do it? Any ideas or suggestions? I'm using .NET 2.0</p>\n\n<p>.... EDIT : .....................................</p>\n\n<p>OK, apparently we CAN use the Apache license. (Also see: <a href=\"http://stackoverflow.com/questions/1007338/can-i-use-a-library-under-the-apache-software-license-2-0-in-a-commercial-applic\">Can I use a library under the Apache Software License 2.0 in a commercial application?</a>) However, using the license is very confusing for me. I read the following guide but still don't exactly know how to apply it to  our project : <a href=\"http://blog.maestropublishing.com/how-to-apply-the-apache-20-license-to-your-pr\" rel=\"nofollow\">http://blog.maestropublishing.com/how-to-apply-the-apache-20-license-to-your-pr</a></p>\n\n<p>it says: </p>\n\n<blockquote>\n  <p>you need two files in the root or top directory of your distribution.  </p>\n</blockquote>\n\n<p>What's exactly meant by 'distribution'? Is that our installed application, and top directory meaning Program files/OurApp/ ?</p>\n\n<p>It also says:</p>\n\n<blockquote>\n  <p>Replace all [bracketed] items in the above notice statement. There are only two of these items so should not be hard for you to do.</p>\n</blockquote>\n\n<p>But that would give me a notice file, reading :</p>\n\n<blockquote>\n  <p>Copyright 2012 OUR_COMPANY</p>\n  \n  <p>Licensed under the Apache License, etc...</p>\n</blockquote>\n\n<p>But our app isn't licensed under the Apache license?</p>\n\n<p>I'm sorry but I'm very confused and don't want to make any mistakes with this legal stuff...\nWhat would I need to do exactly to be able to use this control?</p>\n"},{"tags":[".net","configuration","system.configuration"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":10958054,"title":"How to Create a Configuration Section That Contains a Collection of Collections?","body":"<p>I need a configuration section something like this:</p>\n\n<pre><code>&lt;myConfig&gt;\n    &lt;mySubConfig1&gt;\n        &lt;mySubSubConfig1 keyAttribute=\"value1\"&gt;\n            &lt;mySubSubConfig1Element keyAttribute=\"value1\"/&gt;\n            &lt;mySubSubConfig1Element keyAttribute=\"value2\"/&gt;\n        &lt;/mySubSubConfig1&gt;\n        &lt;mySubSubConfig1 keyAttribute=\"value2\"&gt;\n            &lt;mySubSubConfig1Element keyAttribute=\"value1\"/&gt;\n        &lt;/mySubSubConfig1&gt;\n    &lt;/mySubConfig1&gt;\n    &lt;mySubConfig2&gt;\n        &lt;mySubSubConfig2 keyAttribute=\"value1\"&gt;\n            &lt;mySubSubConfig2Element keyAttribute=\"value1\"/&gt;\n            &lt;mySubSubConfig2Element keyAttribute=\"value2\"/&gt;\n        &lt;/mySubSubConfig2&gt;\n        &lt;mySubSubConfig2 keyAttribute=\"value2\"&gt;\n            &lt;mySubSubConfig2Element keyAttribute=\"value1\"/&gt;\n        &lt;/mySubSubConfig2&gt;\n    &lt;/mySubConfig2&gt;\n    &lt;mySubConfig3&gt;\n        &lt;mySubSubConfig3 keyAttribute=\"value1\"&gt;\n            &lt;mySubSubConfig3Element keyAttribute=\"value1\"/&gt;\n            &lt;mySubSubConfig3Element keyAttribute=\"value2\"/&gt;\n        &lt;/mySubSubConfig3&gt;\n        &lt;mySubSubConfig3 keyAttribute=\"value2\"&gt;\n            &lt;mySubSubConfig3Element keyAttribute=\"value1\"/&gt;\n        &lt;/mySubSubConfig3&gt;\n    &lt;/mySubConfig3&gt;\n&lt;/myConfig&gt;\n</code></pre>\n\n<p>I haven't yet found the magic that would permit this withoug using the old <code>IConfigurationSectionHandler</code> interface. Does anyone know how to do it?</p>\n\n<p>It's ok with me if <code>myConfig</code> and the <code>mySubConfign</code> are <code>ConfigurationSectionGroup</code> or <code>ConfigurationSection</code>.</p>\n\n<p>Also, if it matters, this will be used from web.config.</p>\n"},{"tags":["asp.net",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13250142,"title":"Displaying formatted text (from database) in HTML using ASP.Net","body":"<p>I have a  formatted text stored in a database column as listed below. This formatting is preserved when an email is sent using SSIS. However when I display it using a a web page, the formatting is not preserved – it comes in single line.</p>\n\n<p>What is the best way to display it in HTML by preserving format? </p>\n\n<p>Note: We need to achieve this without any third party control. But we can use standard ASP.Net controls</p>\n\n<pre><code>UPDATE Report_Type SET report_template_txt = \n\n'Updates:   \n-----------------\n        Transactions Received for 10 \n\n\nAdjustments :  \n---------------------------\n\n\nAdjustment holds \n\n        Holds past 1 month – 5'\n</code></pre>\n\n<p>HTML Source and Rendering:</p>\n\n<p><img src=\"http://i.stack.imgur.com/9laUK.jpg\" alt=\"enter image description here\"></p>\n\n<p>REFERENCE:</p>\n\n<ol>\n<li><p><a href=\"http://stackoverflow.com/questions/4577904/save-html-formatted-text-to-database\">save html-formatted text to database</a></p></li>\n<li><p><a href=\"http://stackoverflow.com/questions/4760788/database-text-with-html-formatting-how-to-pull-it-into-my-asp-net-page\">database text with html formatting, how to pull it into my asp.net page</a></p></li>\n<li><p><a href=\"http://stackoverflow.com/questions/2921559/net-how-to-display-string-as-a-formatted-html\">.NET: How to display string as a formatted HTML?</a></p></li>\n<li><p><a href=\"http://stackoverflow.com/questions/9879933/html-decoding-within-textarea\">HTML Decoding within textarea</a></p></li>\n</ol>\n"},{"tags":[".net","log4j","log4net","nlog","viewer"],"answer_count":4,"favorite_count":4,"up_vote_count":8,"down_vote_count":0,"view_count":896,"score":8,"question_id":6700161,"title":"decent log viewer that works with NLog","body":"<p>What would be a the best viewer that works well with NLog when I have the following requirements:</p>\n\n<ul>\n<li>I need to view logs offline (files) and online (live)</li>\n<li>for offline I need to be able to select and view multiple files that are then all displayed in one view where all entries are serialized chronologically</li>\n<li>for online I need to be able to view multiple log sources (i.e. applications) at once </li>\n<li>for online I need to get the data through for a local network (TCP, UDP, Chainsaw maybe?) and through the internet (http, Webservice?)</li>\n<li>the viewer should have \"good\" filtering and view configuration support (e.g. regexp/grep based highlighting and fitering, loglevel filtering, highlighting, list or tree of all available loggers)</li>\n<li>the viewer should be capable of processing large amount of data</li>\n<li>the viewer should preferably be xcopy deployable (standalone binary that can be .NET based but not java)</li>\n<li>the license should preferably allow me to deploy without <strong>additional</strong> fees or at least these additional fees should be \"reasonable\" (all free of course would be the best)</li>\n</ul>\n\n<p>As a last resort, if there isn't one that can do both offline and online viewing equally well, it would also be feasible to use separate viewers for this with separate configurations.</p>\n\n<p>Correct me if I am wrong, but since NLog seems to have a lot of ways to spit out log4j/log4net comatible logs, I guess a log4j/log4net viewer might do the trick as well.</p>\n"},{"tags":[".net","graphics","coordinates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13253881,"title":"Graphics Co-ordinates Problems","body":"<p>We have some legacy hardware/software that displays graphics through a Matrox card out to a TV. The graphics are composites of files (bmp, tga) and text elements. The layout of the graphics is in an XML file. I am trying to render these graphics in a window for previewing without access to the special hardware. I'm using basic .NET gfx classes: Bitmap and Graphics.</p>\n\n<p>The problem is I can't get the co-ordinates in the XML file to match where the objects should be displayed in the window. For example, the XML says render \"test.bmp\" at 13,159 but in the example graphic it should be at 94, 24. Another is XML co-ord is 232,-48 but real co-ord is 530, 138.</p>\n\n<p>I know that's not a lot of info to go on but if anyone has any input on how to map these co-ordinates I'd appreciate it. The full graphic size is 720x486.</p>\n\n<p>To composite the images I do:</p>\n\n<pre><code>// Target bitmap all others get composited into\nBitmap bmp = new Bitmap(720, 486);\nGraphics g = Graphics.FromImage(bmp);\n// Load a new bitmap\nstring file_name;         // Path to image from XML file\nfloat x, y;               // Position. Pulled from the XML\nfloat w, h;               // Width and height. Also from the XML. Seems always to be Bitmap w,h\nfloat scale_x, scale_y;   // Scaling. Also from the XML\n// Parse XML file....\nBitmap bmp_new = new Bitmap(file_name);\nRectangleF r = new RectangleF(x, y, w * scale_x, h * scale_y);\ng.DrawImage(bmp_new, r);\npixPreview.Image = bmp;    // PictureBox control for veiwing\n</code></pre>\n"},{"tags":["c#",".net","database","oracle","stored-procedures"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13253000,"title":"ORA-06550 wrong number or types of arguments when calling Oracle stored procedure","body":"<pre><code>procedure select_card_transaction(trans_id   nvarchar2,\n                                    usr_id    number,\n                                    Quantity out number) is\n  begin\n    select count(*)\n      into Quantity\n      from user_cards u\n     where u.transaction_id = trans_id\n       and u.user_id = usr_id;\n  end;\n</code></pre>\n\n<p><strong>and Consuming it:</strong></p>\n\n<pre><code>using(var conn = new OracleConnection(Settings.Default.OraWUConnString))\n            { \n                var cmd = conn.CreateCommand();\n                cmd.CommandText = \"for_temporary_testing.select_card_transaction\";\n                cmd.CommandType = CommandType.StoredProcedure;\n\n\n\n                cmd.Parameters.AddWithValue(\"trans_id\", TransactionID);\n                cmd.Parameters.AddWithValue(\"usr_id\", UserID);\n\n                var q = new OracleParameter(\"Quantity\", OracleType.Number);\n                q.Direction = ParameterDirection.Output;\n                cmd.Parameters.Add(q);\n                //cmd.Parameters[0].OracleType = OracleType.NVarChar;\n                //cmd.Parameters[1].OracleType = OracleType.Number; \n\n                conn.Open();\n                var obj = cmd.ExecuteNonQuery();\n\n                conn.Close();\n                return (int)q.Value == 1;\n            }\n</code></pre>\n\n<p>It returns the following error.\nORA-06550 wrong number or types of arguments when calling Oracle stored procedure...\n<strong>ANY IDEA?</strong></p>\n"},{"tags":["c#",".net","security","service","windows-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13253166,"title":"How to start a windows service from other machines?","body":"<p>I have some windows services writtin with C# language that is running on my machine. I also created a WPF Application to my customer start and stop theses services. When I run it on the same machine, it works fine, but when I try to run on other machines it does not work, and I got an exception with the message: <em>Cannot open Service Control Manager on compupter 'NAME-PC'. This operation might require other privileges.</em></p>\n\n<p>My Windows Service has a Project Installer that has a ProcessInstaller with the Account property setted to <em>LocalSystem</em>.  I'm not sure if that influence.</p>\n\n<p>How could I set the right privileges to other machines can start this service on a specific machine?</p>\n\n<p>Thank you.</p>\n"},{"tags":["c#",".net","linq","linq-to-sql","inner-join"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13226996,"title":"Linq to Sql Inner Join","body":"<p>I am writing a linq to sql statement using the join. By searching I reached the the link below : \n<a href=\"http://stackoverflow.com/questions/37324/what-is-the-syntax-for-an-inner-join-in-linq-to-sql\">What is the syntax for an inner join in linq to sql?</a>\nin this question the answer is like : </p>\n\n<pre><code>var dealercontacts = from contact in DealerContact\n                     join dealer in Dealer on contact.DealerId equals dealer.ID\n                     select contact;\n</code></pre>\n\n<p>in this statement, inner join is used on single comparison statement i.e. <code>on contact.DealerId equals dealer.ID</code> But when I tried to do <code>on contact.DealerId equals dealer.ID &amp;&amp; contact.Branch equals dealer.Branch</code>, It does not accept the second comparison statement.\nPlease guide me how can I have this?</p>\n"},{"tags":["c#",".net","parsing","midi"],"answer_count":2,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13242646,"title":"Parsing a MIDI file for Note On only","body":"<p>I've been trying to figure out the mystical realm of MIDI parsing, and I'm having no luck.  All I'm trying to do is get the note value (<code>60</code> = C4, <code>72</code> = C5, etc), in order of when they occur.</p>\n\n<p>My code is as follows.  All it does is very simply open a file as a byte array and read everything out as hex:</p>\n\n<pre><code>byte[] MIDI = File.ReadAllBytes(\"TestMIDI.mid\");\nforeach (var element in MIDI) {\n    string b = Convert.ToString(element,16);\n    Debug.WriteLine(b);\n}\n</code></pre>\n\n<p>All TestMIDI.mid contains is one note on C5.  <a href=\"http://pastebin.com/yVcNACGw\" rel=\"nofollow\">Here's a hex dump</a> of it.  Using <a href=\"http://www.sonicspot.com/guide/midifiles.html\" rel=\"nofollow\">this info</a>, I'm trying to find the simple hex value for Note On (<code>0x9</code>, or just <code>9</code> in the dump), but there aren't any.  I can find a few <code>72</code>'s, but there are 3, which doesn't make any sense to me (note on, note off, then what?).</p>\n\n<p>This is my first attempt at parsing MIDI as a file and using hex dumps (are they even called that?), so I'm sorry if I'm heading in the complete wrong direction.  <strong>All I need is to get the note that plays, and in what order.  I don't need timing or anything fancy at all.</strong>  The reason behind this, if it matters - is to then generate new code in a different language to be played out of a speaker, very similar to the <code>beep</code> command on *nix.  Because of this, I don't want to use any frameworks that 1) I didn't program, and really didn't learn anything and 2) do far more than what I need, making the framework heavier than the actual code by me.</p>\n"},{"tags":["c#",".net","winforms","embedded-resource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13252565,"title":"When setting Build Action = Embedded resources in a resource file, \"Insufficient system resources\" error","body":"<p>VS:2008 C# Winforms project, I am working on.</p>\n\n<p>I added a file in resources and set its build action = Embedded Resources, then after I compiled the project, and an error occurred that insufficient system resources exist to complete the requested service.</p>\n\n<p>full description of Error:</p>\n\n<blockquote>\n  <p>Could not write to output file '&lt;>' -- 'Insufficient system resources exist to complete the requested service. '</p>\n</blockquote>\n\n<p>Can anybody tell me why this error occured and how to resolve this issue?</p>\n"},{"tags":["c#",".net","attributes"],"answer_count":32,"favorite_count":291,"up_vote_count":302,"down_vote_count":2,"view_count":25237,"score":300,"question_id":144833,"title":"Most Useful Attributes","body":"<p>I know that attributes are extremely useful. There are some predefined ones such as <code>[Browsable(false)]</code> which allows you to hide properties in the properties tab. Here is a good question explaining attributes: <a href=\"http://stackoverflow.com/questions/20346/c-what-are-attributes\">.NET: What are attributes?</a></p>\n\n<p><strong>What are the predefined attributes (and their namespace) you actually use in your projects?</strong> </p>\n"},{"tags":["c#",".net","sql","performance","ado.net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13252966,"title":"Fastest Get data from remote server","body":"<p>I'm creating a windows application in which I need to get data using ado.net/(Or any other way using C# if any ). From one table. The database table apparently has around <code>100000</code> records and it takes forever to download.</p>\n\n<p>Is there any faster way where I could get data into faster? </p>\n\n<p>I tried the <code>DataReader</code> but still isn't fast enough. </p>\n"},{"tags":["c#",".net","propertygrid","collectioneditor"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13252774,"title":"PropertyGrid how to show a Collection as a property?","body":"<p>For a class that has a collection as one of its fields <code>List&lt;Object&gt; myList</code>, the <code>PropertyGrid</code> would show the value as <code>Collection</code> and launch the Collection Editor when clicked. Is it possible to make that instead an expandable property where each entry would be another expandable property according to whatever fields <code>Object</code> has? Kind of like:</p>\n\n<p><img src=\"http://i.stack.imgur.com/niddz.gif\" alt=\"enter image description here\"></p>\n\n<p>EDIT:\nThe screen is from the project on\n<a href=\"http://www.codeproject.com/Articles/4448/Customized-display-of-collection-data-in-a-Propert\" rel=\"nofollow\">http://www.codeproject.com/Articles/4448/Customized-display-of-collection-data-in-a-Propert</a></p>\n\n<p>is there a way I could obtain that \"expandable behaviour for a Collection object? </p>\n"},{"tags":[".net","ios","monotouch"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":54,"score":2,"question_id":13245646,"title":"Can we develop iOS applications using MonoTouch in a Windows environment","body":"<p>I’m planning to do an iPhone application on MonoTouch. I’m using Windows 7 and VS 2010. My problem is I did not find any installer or anything that installs MonoTouch for Windows.</p>\n\n<p>My question is can we develop iOS applications using MonoTouch in a Windows environment? </p>\n\n<p>Or does Monotouch only support developing IOS allocation in an MAC environment using C# code?</p>\n\n<p>I do not want to run a VM on Windows and run MAC on top of it and do the coding.\nThanks.</p>\n"},{"tags":["c#","asp.net",".net","webforms","listbox"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13252361,"title":"getting selected index of listbox(c#)","body":"<p>I have a <code>ListBox</code> with SelectionMode set to multiple. When I check the selected index using <code>ListBox1.SelectedIndex</code> I always get -1 even if I click on a item?? I would like to be able to get index of multiple selected items in the listbox.</p>\n"},{"tags":[".net","silverlight-5.0","async-await"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13187792,"title":"using async await to listen for messages","body":"<p>I want to implement silverlight's localmessaging using async await.</p>\n\n<p>Lets say I created a method, <code>ListenTask()</code>, that returns a message wrapped in a Task using LocalMessageReceiver's <code>Listen</code> method and Message Received event.\nHow can I use async await and process messages as I receive them?</p>\n"},{"tags":["c#",".net","windows","icons","file-type"],"answer_count":7,"favorite_count":5,"up_vote_count":13,"down_vote_count":0,"view_count":18241,"score":13,"question_id":616718,"title":"How do I get common file type icons in C#?","body":"<p>As seen in <a href=\"http://stackoverflow.com/questions/524137/get-icons-for-common-file-types\">This SO question on getting icons</a> for common file types, it's quite possible for a windows program to get the icons for a registered file type using the C++ Shell API.  These icons may or may not exist on disk - for example, we wanted to make our own custom file browser and want to display the system-associated icon with the file.</p>\n\n<p>Is there a native C# way to get the icons for various file types (and if so, how) or must it be done through PInvoke with shell API?</p>\n\n<p>And as a follow up, if there is a native .NET way of doing it, is there a cross-platform way of doing it?</p>\n"},{"tags":["c#",".net","random"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":51,"score":3,"question_id":13252520,"title":"System.Random default constructor system clock resolution?","body":"<p>I have several processes in which I use System.Random's default constructor to generate random numbers.\nI read about it on MSDN but it dosn't say the specific system clock resolution it uses, for example does System.Random get the system clock seed in ms or seconds? Is it safe to use the default constructor across several process to get random values between them?</p>\n\n<p>Cheers</p>\n"},{"tags":[".net","windows","powershell","shared-folders","net-use"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":24,"score":-1,"question_id":13252885,"title":"Why \"net use\" shows one LESS connection when I run it within PowerShell?","body":"<p>I am puzzled!</p>\n\n<p>When I run Net USe within Command Prompt I see one extra connection to a shared folder whereas I cannot see it when I run the Net Use within a Powershell Session.</p>\n\n<p>What can be the reason?</p>\n"},{"tags":[".net","search","filter","storefront"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13197523,"title":"Sorting search results and item lists on a .Net StoreFront hybrid","body":"<p>I'm a front-end guy hoping to find a front-end solution for this, or at least something I can handle on my own if need be. We have recently moved over to a complete ERP solution on the cloud. In working with the e-commerce solution they provide, I found out that it is basically a hybrid of an older version of .Net StoreFront (skins &amp; templates, XML Packages, etc.). What it DOESN'T provide out of the box, is any way at the user level to sort the product search results and item lists. I'm looking to basically allow the user to sort by the following criteria: Lowest Price to Highest Price, Highest Price to Lowest Price, Alpha-numeric a-z, Alpha-numeric z-a. These would be available in a pulldown menu and would default on Lowest Price to Highest Price.</p>\n\n<p>Does anyone know if this is something I can accomplish from my seat given the environment? Possibly jQuery even? I dont readily have the ability to start cracking into DLL files so I'm hoping for some ray of light.</p>\n"},{"tags":["c#",".net","dictionary","equality"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":3467,"score":4,"question_id":2219047,"title":".NET Dictionaries have same keys and values, but aren't \"equal\"","body":"<p>This test fails:</p>\n\n<pre><code>using Microsoft.VisualStudio.TestTools.UnitTesting;        \n\n[TestMethod()]\n        public void dictEqualTest() {\n            IDictionary&lt;string, int&gt; dict = new Dictionary&lt;string, int&gt;();\n            IDictionary&lt;string, int&gt; dictClone = new Dictionary&lt;string, int&gt;();\n\n        for (int x = 0; x &lt; 3; x++) {\n            dict[x.ToString()] = x;\n            dictClone[x.ToString()] = x;\n        }\n\n        Assert.AreEqual(dict, dictClone); // fails here\n        Assert.IsTrue(dict.Equals(dictClone)); // and here, if the first is commented out\n        Assert.AreSame(dict, dictClone); // also fails\n    }\n</code></pre>\n\n<p>Am I misunderstanding something about how a <code>Dictionary</code> works?</p>\n\n<p>I'm looking for the Java equivalent of <code>.equals()</code>, not trying to check referential equality.</p>\n"},{"tags":["c#",".net","xml-serialization","webservice-client"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":7674275,"title":"I thought Object was a unknown typed object? Not in XmlSerializationWriter","body":"<p>I have a webservice that always returns a ReturnObject that is a class I have written like this:</p>\n\n<pre><code>public class ReturnObject\n{\n    public Status Status { get; set; }\n    public Object Data { get; set; }\n}\n</code></pre>\n\n<p>When I return a single object like an int or string etc in Data it is OK but when I want to return a list of typed objects the client that running the webservice as a WebReference getting this exception:</p>\n\n<blockquote>\n  <p>System.Web.Services.Protocols.SoapException: Server was unable to process request.\n  ---> System.InvalidOperationException: There was an error generating the XML document\n   ---> System.InvalidOperationException:\n  Typen\n  System.Collections.Generic.List`1[[Transticket.Domain.Models.ApsisMailingList,\n  Transticket.Domain, Version=1.0.0.0, Culture=neutral,\n  PublicKeyToken=null]] kan inte användas i den här kontexten.    vid\n  System.Xml.Serialization.XmlSerializationWriter.WriteTypedPrimitive(String\n  name, String ns, Object o, Boolean xsiType)    vid\n  Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write1_Object(String\n  n, String ns, Object o, Boolean isNullable, Boolean needType)    vid\n  Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write3_ReturnObject(String\n  n, String ns, ReturnObject o, Boolean isNullable, Boolean needType)<br>\n  vid\n  Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write6_GetListsResponse(Object[]\n  p)    vid\n  Microsoft.Xml.Serialization.GeneratedAssembly.ArrayOfObjectSerializer5.Serialize(Object\n  objectToSerialize, XmlSerializationWriter writer)    vid\n  System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter,\n  Object o, XmlSerializerNamespaces namespaces, String encodingStyle,\n  String id)    --- Slut på stackspårning för interna undantag ---<br>\n  vid System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter\n  xmlWriter, Object o, XmlSerializerNamespaces namespaces, String\n  encodingStyle, String id)    vid\n  System.Web.Services.Protocols.SoapServerProtocol.WriteReturns(Object[]\n  returnValues, Stream outputStream)    vid\n  System.Web.Services.Protocols.WebServiceHandler.WriteReturns(Object[]\n  returnValues)    vid\n  System.Web.Services.Protocols.WebServiceHandler.Invoke()    --- Slut\n  på stackspårning för interna undantag ---</p>\n</blockquote>\n\n<p>This exception is not in the webservice, it's in the client call to the webservice after returning the data.</p>\n\n<p>If I do another ReturnObject there and I specify a list of typed objects as data, it works well.</p>\n\n<p>Someone have an idea how I generalize this? I have always thought that List is a type of Object but looks like a .NET bug, or I have missed something?</p>\n"},{"tags":["c#",".net","datetime"],"answer_count":33,"favorite_count":164,"up_vote_count":401,"down_vote_count":12,"view_count":96964,"score":389,"question_id":9,"title":"How do I calculate someone's age","body":"<p>Given a <code>DateTime</code> representing a person's birthday, how do I calculate their age?  </p>\n"},{"tags":[".net","linq","views"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13251170,"title":"Linq on Table View","body":"<p>I have following type </p>\n\n<pre><code>  public class TransactionDetails\n  { \n        public int TransID {get; set;}\n        public List&lt;string&gt; OrderID { get; set; }\n  }\n</code></pre>\n\n<p>what should be the Linq query on the following table View (say Trans_View) to fill this TransactionDetails custome type with follwing data from view. </p>\n\n<p>View record in following row format:</p>\n\n<pre><code>         TransID     OrderID      \n            1           ABC\n            1           DEF\n            1           IJK\n            2           XYZ\n            2           PQR\n</code></pre>\n"},{"tags":["c#",".net","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":13251554,"title":"Parse date string .net","body":"<p>What's the best way to convert a string such as:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Mon Nov 05 2012 21:27:58 GMT+0000 (GMT Standard Time)\n</code></pre>\n\n<p>in to a <code>DateTime</code> in .NET? I want to retain as much of the date as possible, i.e the TimeZone.</p>\n\n<p>I'm trying this but it loses the <code>GMT</code>:</p>\n\n<pre><code>DateTime.ParseExact(date.Substring(0, 24),\n                             \"ddd MMM d yyyy HH:mm:ss\",\n                             CultureInfo.InvariantCulture);\n</code></pre>\n"},{"tags":[".net","nhibernate"],"answer_count":5,"favorite_count":90,"up_vote_count":118,"down_vote_count":0,"view_count":32753,"score":118,"question_id":43320,"title":"NHibernate ISession Flush: Where and when to use it, and why?","body":"<p>One of the things that get me thoroughly confused is the use of session.Flush,in conjunction with session.Commit, and session.Close.</p>\n\n<p>Sometimes session.Close works, e.g., it commits all the changes that I need. I know I need to use commit when I have a transaction, or a unit of work with several creates/updates/deletes, so that I can choose to rollback if an error occurs.</p>\n\n<p>But sometimes I really get stymied by the logic behind session.Flush. I have seen examples where you have a session.SaveOrUpdate() followed by a flush, but when I remove Flush it works fine anyway. Sometimes I run into errors on the Flush statement saying that the session timed out, and removing it made sure that I didn't run into that error.</p>\n\n<p>Does anyone have a good guideline as to where or when to use a Flush? I've checked out the NHibernate documentation for this, but I still can't find a straightforward answer.</p>\n"},{"tags":[".net","wcf","wcf-security"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13251988,"title":"Unable to find x509 Cert WCF error","body":"<p>I created a wcf and deployed it ssl enabled on server. I am able to access service by using url in browser and can see meta data but unable to access it from client. I am getting error as X509 cert cannot be found. Please find the config files i am using on client and service end. I have the wcf installed on a server along with certificate and trying to access it from my local machine. Do i need to do anything on my local machine to be able to access cert.</p>\n\n<p>Service:</p>\n\n<pre><code>&lt;system.serviceModel&gt;    \n    &lt;bindings&gt;\n      &lt;wsHttpBinding&gt;\n        &lt;binding name=\"wsHttpBinding\"&gt;         \n          &lt;security mode=\"Transport\"&gt;\n            &lt;transport clientCredentialType=\"Basic\"/&gt;\n            &lt;message clientCredentialType=\"None\"/&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/wsHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;services&gt;\n      &lt;service behaviorConfiguration=\"testBehavior\" name=\"TestService\"&gt;\n        &lt;endpoint address=\"wsHttpBinding\"\n          binding=\"wsHttpBinding\" bindingConfiguration=\"wsHttpBinding\" name=\"sWsHttpBinding\"\n          contract=\"ITestContract\" &gt;\n        &lt;/endpoint&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;      \n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"testBehavior\"&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;                 \n          &lt;serviceCredentials&gt;\n            &lt;clientCertificate&gt;\n              &lt;authentication certificateValidationMode=\"None\" revocationMode=\"NoCheck\"/&gt;\n            &lt;/clientCertificate&gt;\n            &lt;serviceCertificate findValue=\"112337B641609C08C6AEAA01FDFDFDFDFASF2334\"\n              storeLocation=\"LocalMachine\" storeName=\"My\" x509FindType=\"FindByThumbprint\"/&gt;\n          &lt;/serviceCredentials&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"True\"&gt;&lt;/serviceHostingEnvironment&gt;\n  &lt;/system.serviceModel&gt;\n\nClient:\n&lt;system.serviceModel&gt;\n  &lt;bindings&gt;\n    &lt;wsHttpBinding&gt;\n      &lt;binding name=\"wsHttpBinding\"&gt;\n        &lt;security mode=\"Transport\"&gt;\n          &lt;transport clientCredentialType=\"Basic\" /&gt;\n        &lt;/security&gt;\n      &lt;/binding&gt;\n    &lt;/wsHttpBinding&gt;\n  &lt;/bindings&gt;\n  &lt;client&gt;   \n    &lt;endpoint address=\"http://myserver/sWsHttpBinding\"\n         behaviorConfiguration=\"endpointBehavior\" binding=\"wsHttpBinding\" bindingConfiguration=\"wsHttpBinding\"\n        contract=\"ITestContract\" name=\"sWsHttpBinding\"&gt;\n    &lt;/endpoint&gt;\n  &lt;/client&gt;\n  &lt;behaviors&gt;\n    &lt;endpointBehaviors&gt;\n      &lt;behavior name=\"endpointBehavior\"&gt;\n        &lt;clientCredentials&gt;\n          &lt;serviceCertificate&gt;\n            &lt;authentication certificateValidationMode=\"PeerTrust\" revocationMode=\"NoCheck\"/&gt;\n          &lt;/serviceCertificate&gt;\n          &lt;clientCertificate storeLocation=\"LocalMachine\" storeName=\"My\" findValue=\"112337B641609C08C6AEAA01FDFDFDFDFASF2334\" x509FindType=\"FindByThumbprint\"/&gt;\n        &lt;/clientCredentials&gt;\n      &lt;/behavior&gt;\n    &lt;/endpointBehaviors&gt;\n  &lt;/behaviors&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n"},{"tags":[".net","visual-studio-2010","entity-framework","visual-studio-2012"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13251958,"title":"Entity Framework update schema without dropping / loosing data","body":"<p>I'm searching if there is a better way than <a href=\"http://stackoverflow.com/questions/3144117/entity-framework-4-update-database-schema-from-model-without-wiping-the-table\">\"Database Generation Power Pack\"</a> to update automatically the Database Schema from an Entity Framework design (Visual Studio 2010) to an MS-SQL Database without dropping any data. In fact, for example, we can't rename or delete a propriety with \"Database Generation Power Pack\".</p>\n\n<p>But, perhaps, it's integrated in Visual Studio 2012?</p>\n"},{"tags":[".net","openfiledialog"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":344,"score":2,"question_id":2060552,"title":"Reusing OpenFileDialog","body":"<p>I have 2 textboxes and 2 button [...] next to each textbox. Is it possible to use one OpenFileDialog and pass the FilePath to the respective textbox, based on which button is clicked? i.e...if I click buttton one and laod the dialog, when I click open on the dialog, it passes the fileName to the first textbox.</p>\n"},{"tags":[".net","vb.net","vsto"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13251782,"title":"data validation dropdown only shown when msgbox appeared","body":"<p>This might sound weird</p>\n\n<p>I just made a data validation in Excel,which I know is working. The incelldropdown not showing by default. But if I create a msgbox before the line, then the incelldropdown shown.</p>\n\n<p>This is where the incelldropdown shown:</p>\n\n<pre><code>MsgBox(\"hello\")\nMe.Range(\"A6:A20\").Validation.Add(Type:=Excel.XlDVType.xlValidateList, _\n   AlertStyle:=Excel.XlDVAlertStyle.xlValidAlertStop, _\n   [Operator]:=Excel.XlFormatConditionOperator.xlBetween, Formula1:=\"=named_range1\")\nMe.Range(\"A6:A20\").Validation.InCellDropdown = True\n</code></pre>\n\n<p>But if I remove the MsgBox, the incelldropdown not showing:</p>\n\n<pre><code>Me.Range(\"A6:A20\").Validation.Add(Type:=Excel.XlDVType.xlValidateList, _\nAlertStyle:=Excel.XlDVAlertStyle.xlValidAlertStop, _\n   [Operator]:=Excel.XlFormatConditionOperator.xlBetween, Formula1:=\"=named_range1\")\nMe.Range(\"A6:A20\").Validation.InCellDropdown = True\n</code></pre>\n\n<p>Any comment will be appreciated. Thanks!</p>\n"},{"tags":["c#",".net","silverlight"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13251595,"title":"How does CheckAndDownloadUpdateAsync actually work behind the scenes?","body":"<p>Does it download all of the binaries or only a part of it in order to evaluate if the binaries are of new version?</p>\n"},{"tags":["c#",".net","wpf","oop","mvvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13251081,"title":"how to use 2 constructor in MVVM in wpf?","body":"<p>I want to use a different constructor in a WPF MVVM project. First one is used in MDI form. But second constructor usage is over another form which have been sending a parameter to second one. How can I use it? </p>\n\n<pre><code>public MyModelView()\n{\n    InitializeComponent();\n    tlb.SelectVisibility = System.Windows.Visibility.Visible;\n}\n\npublic MyModelView(MyViewModel test)\n{\n    InitializeComponent();\n    DataContext = test;\n    tlb.SelectVisibility = test.Visibility;\n}\n</code></pre>\n\n<p>I have two constructors. But I have a datacontext in xaml side. The error is</p>\n\n<p><code>Xaml parse exception: 'The invocation of the constructor on type 'XYZ.AP.UI.ViewModel.MyViewModel' that matches the specified binding constraints threw an exception.' Line number '15' and line position '6'.</code></p>\n\n<pre><code>&lt;Windows:TransactionWindow.DataContext&gt;\n    &lt;ViewModel:MyViewModel /&gt;\n&lt;/Windows:TransactionWindow.DataContext&gt;\n</code></pre>\n"},{"tags":[".net","winforms","skinning","winforms-interop","wndproc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13251027,"title":"Changing border of the main form of the WinForm application","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2575216/resize-winform-with-no-border\">Resize WinForm, with no border?</a>  </p>\n</blockquote>\n\n\n\n<p>I want my WinForm application to NOT have any border. <strong>But still I want to be able to move the application using mouse, resize the application.</strong> </p>\n\n<p>How can I achieve this? </p>\n\n<p>I have gone through some blogs and questions on the Stackoverflow which talk about applying various themes to the WinForm by overriding <code>WndProc</code> method of the Windows <code>Form</code> class. E.g. <a href=\"http://customerborderform.codeplex.com/\" rel=\"nofollow\">http://customerborderform.codeplex.com/</a></p>\n\n<p>Note that I don't want to apply various skins or themes. I just want to make border disappear (or make thickness of the border as small as possible, as if there is just thin border around the main client area of the form). Please note that I do NOT want the title bar at all.</p>\n\n<p>I am using .NET 4.0.</p>\n"},{"tags":[".net","vb.net","usercontrols","dynamic-controls","flowlayoutpanel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13250879,"title":"search a dynamically created object in flowlayoutpanel vb .net","body":"<p>I need to create a flowlayout panel.\nthen create some controlls programmatically ( label , textbox ,button...)\nthen add these controls to the flowlayoutpanel.\nfinally i want to add this panel to a bigger flowlayoutpanel.</p>\n\n<p>my problem is that i dont know how to search the control i have created.</p>\n\n<p>for example : </p>\n\n<pre><code>  'create label\n    Dim dynamiclabel As New Label\n                dynamiclabel.Name = custom_name\n                dynamiclabel.Text = parameter_text\n\n   'create FlowLayoutPanel\n\n   ' search for my label\n\n     Dim tempflowlayout As New FlowLayoutPanel\n     tempflowlayout.Controls.Add(dynamiclabel)\n\n' THIS PART DOESNT WORK\n   ' I want search for this FlowLayoutPanel and assign a new control on it\n   Dim C() As FlowLayoutPanel\n   C(0) = Me.Controls.Find(current_panel_name, True)\n   c(0).controls.add(mylabel)\n</code></pre>\n\n<p>thank you \n-Agisilaos</p>\n\n<p>-ps im new in both vb .net and stackoverflow !</p>\n"},{"tags":[".net","sql-server","architecture","polling"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13251365,"title":"Can I poll a database every 3 seconds","body":"<p>I am building a system to asynchronously send mails after processing data (could take up to 10 sec the processing).</p>\n\n<p>My initial idea was to have a windows service poll the database with data processing requests every 3 seconds for the first record to be processed. When done, poll and get the new first record to be processed. </p>\n\n<p>When there are no records left wait 3 seconds and poll again to check for records.</p>\n\n<p>I'm not sure if this is a good idea. The use of a timer is not a great way to program in my opinion. Also the performance and the use of the database even when not needed is a concern.</p>\n\n<p>What is the best practice in this case?</p>\n\n<p>Technologies used: .net 3.5, SQL Server, servers are in farm.</p>\n"},{"tags":[".net","persistence","configuration-files","user-settings"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":6462,"score":5,"question_id":2389290,"title":"How to load a separate Application Settings file dynamically and merge with current settings?","body":"<p>There are questions pertaining to <a href=\"http://stackoverflow.com/questions/2232059/reading-settings-from-separate-config-file\">reading settings from a separate config file</a> and others similar to it, but my question is specific to application property settings (i.e. <code>&lt;MyApplication.Properties.Settings&gt;</code> - see XML file below) and how to load them dynamically. I tried the method in <a href=\"http://stackoverflow.com/questions/531859/net-own-configuration-file\">this post</a>, which involved refreshing the entire appSettings section of the main config file, but my adaptation threw exceptions because I wasn't replacing the appSettings section:</p>\n\n<pre><code>var config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.PerUserRoamingAndLocal);\n// Have tried the other ConfigurationUserLevels to no avail\nconfig.AppSettings.File = myRuntimeConfigFilePath;\nconfig.Save(ConfigurationSaveMode.Modified); // throws ConfigurationErrorsException\nConfigurationManager.RefreshSection(\"userSettings\");\n</code></pre>\n\n<p>The ConfigurationErrorsException.Message is \"The root element must match the name of the section referencing the file, 'appSettings' (C:\\myFile.xml line 2).\" The file is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration&gt;\n    &lt;userSettings&gt;\n        &lt;MyApplication.Properties.Settings&gt;\n            &lt;setting name=\"SineWaveFrequency\" serializeAs=\"String\"&gt;\n                &lt;value&gt;6&lt;/value&gt;\n            &lt;/setting&gt;\n            &lt;setting name=\"SineWaveAmplitude\" serializeAs=\"String\"&gt;\n                &lt;value&gt;6&lt;/value&gt;\n            &lt;/setting&gt;\n        &lt;/MyApplication.Properties.Settings&gt;\n    &lt;/userSettings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Is there a way to import the values from this file into the <code>MyApplication.Properties.Settings.Default</code> class, with the framework handling all XML deserialization like it does when the config file is loaded on application startup?</p>\n"},{"tags":[".net","rest","web"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":20,"score":-2,"question_id":13250833,"title":"How to intercept rest calls from web application using .NET","body":"<p>I need to intercept rest calls made from a web application, to add http headers to it. How can this be done</p>\n"},{"tags":["c#",".net","entity-framework","entity-framework-4.3"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":332,"score":5,"question_id":10623260,"title":"How can I disable model compatibility checking in Entity Framework 4.3?","body":"<p>I'm working with EF 4.3 and have a context which needs to talk to a database which was generated by another library using EF Code First 4.3.  The context is throwing an exception stating </p>\n\n<pre><code>The model backing the 'Context' context has changed since the\ndatabase was created. Consider using Code First Migrations to update \nthe database\n</code></pre>\n\n<p>In EF 4.1 this could be diabled by removing the <code>IncludeMetadataConvention</code> from the ModelBuilder.  However, in 4.3 this convention has been deprecated and no longer has an effect.</p>\n\n<p>How can I have an EF 4.3 context talk to an EF 4.3-generated database <em>built by a different context</em>?  The only option I've found (which is far from ideal) is to delete the metadata table, thereby causing <em>both</em> contexts to assume the database was not build by EF.</p>\n\n<p><strong>PS:</strong> I know this scenario is likely to raise questions about <em>why</em> I need to do this; I know it's far from ideal, but rest assured it's a problem I need to solve and have limited options to work with laterally.</p>\n"},{"tags":["c#",".net","winforms","c#-4.0","combobox"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":95,"score":1,"question_id":12872488,"title":"show date in three combo boxes","body":"<p>I am beginner in .net. I need to show <code>day</code>, <code>month</code> and <code>year</code> in three different comboboxes. To make them fill i was trying hardcoded values from 1950 to present year. which i later realized that i need to check for also ferbruary(28 days), leap year and other issues. Is there any other way to do this without hardcoding the values.</p>\n\n<p>while searching for answer on internet i came across datepicker and monthcalendar which i dont want to use(because my project should be unique from my other friends who are using datepicker and monthcalendar). or else if you have any other suggestions instead of comboboxes please share.</p>\n\n<p><img src=\"http://i.stack.imgur.com/g4Fy5.png\" alt=\"enter image description here\"></p>\n\n<p>I am sure someone has asked this question before. I dont mind if you direct the link.</p>\n\n<p>EDITED after <em>nikhil agrawal's</em> answer:</p>\n\n<p><strong>Working Code:</strong> </p>\n\n<pre><code>cmbDay    ---&gt;  combobox\ncmbMonth  ---&gt;  combobox\ncmbYear   ---&gt;  combobox\n</code></pre>\n\n<p><em>FormLoad event</em></p>\n\n<pre><code>        this.cmbYear.Leave+=new EventHandler(cmbYear_Leave);\n        this.cmbDay.Leave += new EventHandler(cmbYear_Leave);\n        this.cmbMonth.Leave += new EventHandler(cmbYear_Leave);\n        //\n        for (int i = 1950; i &lt; 2012; i++)\n        {\n            cmbYear.Items.Add(i.ToString());\n        }\n        for (int i = 1; i &lt; 32; i++)\n        {\n            cmbDay.Items.Add(i.ToString());\n        }\n        //\n        cmbDay.SelectedIndex = 0;\n        cmbMonth.SelectedIndex = 0;\n        cmbYear.SelectedIndex = 0;\n</code></pre>\n\n<p><em>OnLeave Event</em></p>\n\n<pre><code>private void cmbYear_Leave(object sender, EventArgs e)\n    {\n        int day = DateTime.DaysInMonth(Convert.ToInt32(cmbYear.Text), cmbMonth.SelectedIndex+1);                       \n        if (day &lt;= cmbDay.SelectedIndex)\n        {\n            //alert message or your managing code.\n        }\n    }             \n</code></pre>\n\n<p>PS: <code>cmbMonth</code> is in string format (\"Jan\",\"Feb\",\"Mar\",...)</p>\n"},{"tags":[".net","performance","optimization","logging"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":254,"score":1,"question_id":2684961,"title":"Minimize performance impact of event logging?","body":"<p>I have a static logging function that uses StringBuilder to concatenate a bunch of query parameters before sending the string to a log.  This process can get moderately long, as we may have ~10 parameters (.Append calls) and end up being ~200 chars long.</p>\n\n<p>I want to minimize the performance impact of the logging function. (This logging function may be called multiple times per web request, and we measure the processing time for each web request)</p>\n\n<p>How/Should/Can I build a \"pool\" of StringBuilders to improve performance?</p>\n\n<p>I can also do all this logging asynchronously, right?  How should I do that?</p>\n"},{"tags":["c#","asp.net",".net","wcf"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":13218777,"title":"Can I edit Resource file at runtime","body":"<p>I have a WCF service, it response with JSON.  I need to create a language file, which I can edit on production server.  no problem if I will need to recycle App pool.</p>\n\n<p>I was about to use Resource file, but I was worry that it is not editable by end user.\nI don't need to edit it pragmatically, the end user will edit it by opening the file in notepad without recompiling the application.  </p>\n\n<p>What do you suggest? </p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","wpf","resources","expression-blend"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13235655,"title":"Modify Resource in Design Time, with code behind in WPF project","body":"<p><strong>What I'm trying to do right now:</strong> Modify the Expression Blend UI / Visual Studio, to add a button on one of my dependency properties, and when I click on it, it creates a new trigger.</p>\n\n<p><strong>What is working</strong>: I created the button, it appears in the UI, that's fine.</p>\n\n<p><strong>What is not working</strong>: I cannot modify the Resource to add a trigger (if I step in, it works but it does not modify on the global resource, only on the instance I think).</p>\n\n<p>I have my main project in Visual Studio, and a property with a button like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/hCSbB.png\" alt=\"Visual Studio UI\"></p>\n\n<p>When the button is pressed this is what happens:</p>\n\n<ul>\n<li>I get my Control that contains that dependency property (Ok). </li>\n<li>I searched for the Resource file that contains the Resource I want to modify (Ok).</li>\n<li>I update the Resource, but it does not replace the Resource on disk.</li>\n</ul>\n\n<p>I think that it's because I only modify it on memory, so it's in the \"air\"</p>\n\n<p>I don't know where to go now... I need help</p>\n\n<p>The code behind where I modify the Resource is in an other DLL, the MyLibrary.<strong>Design</strong>.cs</p>\n\n<p>I'm using Visual Studio 2010 / Blend 4 / .NET 4.0</p>\n"},{"tags":["c#",".net","wcf","wsdl","wcf-client"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13229929,"title":"Importing WSDL into a .NET project only creates an empty namespace","body":"<p>I'm trying to use WCF for the first time. Here's what I did:</p>\n\n<ol>\n<li>Created a console .NET 4 project in VS 2010</li>\n<li>Added a WSDL file as a service reference.</li>\n</ol>\n\n<p>However, I can't seem to be able to use the service, because no classes were created. The service reference is just an empty namespace.</p>\n\n<p>What am I missing?</p>\n\n<p>Here is the WSDL:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!-- edited with XMLSPY v2004 rel. 3 U (http://www.xmlspy.com) by Christophe Duquesne (DRYADE SA) --&gt;\n&lt;!-- edited with XMLSpy v2007 rel. 3 U (http://www.altova.com) by Nick js Knowles (Kizoom) --&gt;\n&lt;definitions xmlns=\"http://schemas.xmlsoap.org/wsdl/\" xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" xmlns:http=\"http://schemas.xmlsoap.org/wsdl/http/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:mime=\"http://schemas.xmlsoap.org/wsdl/mime/\" xmlns:siriWS=\"http://new.webservice.namespace\" xmlns:siri=\"http://www.siri.org.uk/siri\" xmlns:ns=\"http://datex2.eu/schema/1_0/1_0\" xmlns:ns1=\"http://www.ifopt.org.uk/acsb\" xmlns:ns2=\"http://www.ifopt.org.uk/ifopt\" targetNamespace=\"http://new.webservice.namespace\"&gt;\n  &lt;types&gt;\n        &lt;xsd:schema targetNamespace=\"http://new.webservice.namespace\"&gt;\n            &lt;xsd:import schemaLocation=\"siri.xsd\" namespace=\"http://www.siri.org.uk/siri\"/&gt;\n        &lt;/xsd:schema&gt;\n    &lt;/types&gt;\n    &lt;message name=\"StopMonitoringServiceRequest\"&gt;\n        &lt;part name=\"Request\" type=\"siri:ServiceRequestStructure\"/&gt;\n    &lt;/message&gt;\n    &lt;message name=\"StopMonitoringServiceDelivery\"&gt;\n        &lt;part name=\"Answer\" type=\"siri:ServiceDeliveryStructure\"/&gt;\n    &lt;/message&gt;\n    &lt;portType name=\"SOAP-Port\"&gt;\n        &lt;operation name=\"GetStopMonitoringService\"&gt;\n            &lt;input message=\"siriWS:StopMonitoringServiceRequest\"/&gt;\n            &lt;output message=\"siriWS:StopMonitoringServiceDelivery\"/&gt;\n        &lt;/operation&gt;\n    &lt;/portType&gt;\n    &lt;binding name=\"SiriSOAPBinding\" type=\"siriWS:SOAP-Port\"&gt;\n        &lt;soap:binding style=\"rpc\" transport=\"http://schemas.xmlsoap.org/soap/http\"/&gt;\n        &lt;!-- ====general  services ===== --&gt;\n        &lt;!-- ====SIRI services ===== --&gt;\n        &lt;operation name=\"GetStopMonitoringService\"&gt;\n            &lt;soap:operation soapAction=\"GetStopMonitoringService\"/&gt;\n            &lt;input&gt;\n                &lt;soap:body use=\"literal\"/&gt;\n            &lt;/input&gt;\n            &lt;output&gt;\n                &lt;soap:body use=\"literal\"/&gt;\n            &lt;/output&gt;\n        &lt;/operation&gt;\n    &lt;/binding&gt;\n    &lt;service name=\"SiriServices\"&gt;\n        &lt;port name=\"SiriWSPort\" binding=\"siriWS:SiriSOAPBinding\"&gt;\n            &lt;soap:address location=\"http://www.siri-service-location.com\"/&gt;\n        &lt;/port&gt;\n    &lt;/service&gt;\n    &lt;!--General messages--&gt;\n    &lt;!--SIRI Functional services--&gt;\n    &lt;!--Capabilities--&gt;\n    &lt;xsd:annotation&gt;\n        &lt;xsd:appinfo xmlns:gms=\"http://www.govtalk.gov.uk/CM/gms\"&gt;\n            &lt;Metadata xmlns=\"http://www.govtalk.gov.uk/CM/gms-xs\"&gt;\n                &lt;Aggregation&gt;main schema&lt;/Aggregation&gt;\n                &lt;Audience&gt;e-service developers&lt;/Audience&gt;\n                &lt;Contributor&gt;Nicholas Knowles, KIZOOM LTD., London EC4A 1LT&lt;/Contributor&gt;\n                &lt;Coverage&gt;Europe&lt;/Coverage&gt;\n                &lt;Creator&gt;&gt;Drafted for version 1.0, by  Cen TC278 WG3 SG7 Christophe Duquesne DRYADE SA mailto:schemer@siri.org.uk&lt;/Creator&gt;\n                &lt;Date&gt;\n                    &lt;Created&gt;2005-03-01&lt;/Created&gt;\n                &lt;/Date&gt;\n                &lt;Date&gt;\n                    &lt;Modified&gt;2005-05-11&lt;/Modified&gt;\n                &lt;/Date&gt;\n                &lt;Date&gt;\n                    &lt;Modified&gt;2007-01-30&lt;/Modified&gt;\n                &lt;/Date&gt;\n                &lt;Date&gt;\n                    &lt;Modified&gt;2007-04-17&lt;/Modified&gt;\n                    &lt;!-- Name Space changes --&gt;\n                &lt;/Date&gt;\n                &lt;Date&gt;\n                    &lt;Modified&gt;2008-02-12&lt;/Modified&gt;\n                    &lt;!-- Situation  Exchnages --&gt;\n                &lt;/Date&gt;\n                &lt;Date&gt;\n                    &lt;Modified&gt;2007-04-17&lt;/Modified&gt;\n                    &lt;!-- Name Space correction  --&gt;\n                    &lt;!-- Add  StopMonitoringMultipleRequest  --&gt;\n                &lt;/Date&gt;\n                &lt;Description&gt;\n                    &lt;p&gt;SIRI is a European CEN standard for the exchange of real time information. This describes WSDL Server binding&lt;/p&gt;\n                &lt;/Description&gt;\n                &lt;Format&gt;\n                    &lt;MediaType&gt;text/xml&lt;/MediaType&gt;\n                    &lt;Syntax&gt;http://www.w3.org/2001/XMLSchema&lt;/Syntax&gt;\n                    &lt;Description&gt;XML schema, W3C Recommendation 2001&lt;/Description&gt;\n                &lt;/Format&gt;\n                &lt;Identifier&gt;{http://www.siri.org.uk/schemas/1.3/siri}siri_wsProducer.wsdl&lt;/Identifier&gt;\n                &lt;Language&gt;[ISO 639-2/B] ENG&lt;/Language&gt;\n                &lt;Publisher&gt;Kizoom, 109-123 Clifton Street, London EC4A 4LD &lt;/Publisher&gt;\n                &lt;Rights&gt;Unclassified\n                             &lt;Copyright&gt;CEN, VDV, RTIG 2005-2008&lt;/Copyright&gt;\n                &lt;/Rights&gt;\n                &lt;Source&gt;\n                    &lt;ul&gt;\n                        &lt;li&gt;SIRI is derived from the VDV, RTIGXML and Trident standards.&lt;/li&gt;\n                    &lt;/ul&gt;\n                &lt;/Source&gt;\n                &lt;Status&gt;Version 1.0 Draft for approval&lt;/Status&gt;\n                &lt;Subject&gt;\n                    &lt;Category&gt;Arts, recreation and travel, Tourism, Travel (tourism), Transport,\n Air transport, Airports,\n Ports and maritime transport, Ferries (marine),\n Public transport, Bus services, Coach services, Bus stops and stations,\n Rail transport, Railway stations and track, Train services, Underground trains,\n Business and industry, Transport, Air transport , Ports and maritime transport, Public transport,\n Rail transport, Roads and road transport\n &lt;/Category&gt;\n                    &lt;Project&gt;Cen TC278 WG3 SG7&lt;/Project&gt;\n                &lt;/Subject&gt;\n                &lt;Title&gt;SIRI XML schema. WSDL Server binding. &lt;/Title&gt;\n                &lt;Type&gt;Standard&lt;/Type&gt;\n            &lt;/Metadata&gt;\n        &lt;/xsd:appinfo&gt;\n    &lt;/xsd:annotation&gt;\n    &lt;!-- ======== All the structures are comming from siri.xsd ========= --&gt;\n    &lt;!-- ======== Descritions of request parameters (requests and answers) ========= --&gt;\n    &lt;!-- ========Service Requests ========= --&gt;\n    &lt;!-- ====StopMonitoring== --&gt;\n    &lt;!-- ====PORTS ================ --&gt;\n    &lt;!-- ====BINDINGS  ================ --&gt;\n&lt;/definitions&gt;\n</code></pre>\n"},{"tags":["javascript","asp.net",".net","alert"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":4,"view_count":43,"score":-4,"question_id":13250742,"title":"javascript works fine with IE but not with firefox and Chrome","body":"<p>I am having two different functions in my javascript one which will be called on successfull execution of the function\nsuppose if my function name is <code>mymethodname1()</code>\nso if the function executes properly then it will call the success methid which is my javascript method as <code>successmethod()</code> which will give me an alert suppose as </p>\n\n<pre><code>\"Execution Completed successfully\"\n</code></pre>\n\n<p>and if the function <code>mymethodename1()</code> fails to execute then it will call my another javascript method <code>failuremethod()</code> which will give me an alert suppose as</p>\n\n<pre><code>\"Failure!\"\n</code></pre>\n\n<p>This case works fine with IE v8 but when I try it on the Chrome and Firefox same scenerio which I used for IE fails and provides me the failure alert even though the function gets executed successfully</p>\n"},{"tags":[".net","powershell","powershell-v3.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13239377,"title":"How can I copy from local to a remote location with credentials in PowerShell?","body":"<p>I am a fressh beginner to Powershell.</p>\n\n<p>I have username and password to reach a shared folder in a remote location.</p>\n\n<p>I need <strong>to copy the file foo.txt from the current location to</strong>  </p>\n\n<p>\\Bar.foo.myCOmpany.com\\logs</p>\n\n<p>within a PS1 script that is written for <strong>Powershell v3.0</strong>.</p>\n\n<p>How can I achieve this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":118,"score":1,"question_id":13167800,"title":"Split over-tall WPF RichTextBox into multiple controls","body":"<p>I'm trying to get the content height of a RichTextBox and if it exceeds 500px, split it into multiple RichTextBoxes with the maximum height of 500px.</p>\n\n<p>Anyone know how to do this? Thanks.</p>\n\n<p>EDITED:</p>\n\n<p>by \"split\" I mean put the content that exceeds the height limit in another RichTextBox, the solution can't just change the appearence of the current RichTextBox due to project specificities.</p>\n"},{"tags":[".net","visual-studio"],"answer_count":9,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":69432,"score":8,"question_id":1391503,"title":"A network-related or instance-specific error occurred while establishing a connection to SQL Server","body":"<p>I'm very frustrated. I have a website running on Visual Web Developper 2008 Express with my local database, everything works great. I also have the same web site running on a production server. Everything was working great but tonight I did a \"reset\" on production.</p>\n\n<p>1) I deleted a couple of table, recreate them and insert data. Everything is ok at this time.</p>\n\n<p>2) I delete ALL the file connected on the FTP.</p>\n\n<p>3) I used the module called \"Copy website\" in visual studio and copy the site to the website via FTP.</p>\n\n<p>When I log on my website, here is the error I got:\nServer Error in '/' Application.</p>\n\n<p>A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)</p>\n\n<p>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. </p>\n\n<p>Exception Details: System.Data.SqlClient.SqlException: A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)</p>\n\n<hr>\n\n<p>Nothing has changed related to SQL connection, this is OLD code that I always used.\nMy website is completly paralysed because of this and I feel sick inside because I feel there is nothing I can do.</p>\n\n<p>Can someone help me please?</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","excel"],"answer_count":19,"favorite_count":17,"up_vote_count":22,"down_vote_count":1,"view_count":18856,"score":21,"question_id":170652,"title":"What's the best .NET library for parsing and generating Excel spreadsheets?","body":"<p>Open-source or not. What's your experience using it? How's the learning curve?</p>\n"},{"tags":[".net","r","interop","statistics","compatibility"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":1285,"score":7,"question_id":5025340,"title":"Call R (programming language) from .net","body":"<p>I'm working on an application that requires a great deal of stastical processing and output as images in a .net desktop application. The problems, including generating the output images, seem like a natural fit for R <a href=\"http://www.r-project.org/\">http://www.r-project.org/</a> </p>\n\n<p>Is there a wrapper, API, SDK, or port that will allow me to call R from .net?</p>\n"},{"tags":[".net","entity-framework","collections","poco","automapper"],"answer_count":3,"favorite_count":8,"up_vote_count":16,"down_vote_count":0,"view_count":3510,"score":16,"question_id":3441916,"title":"Automapper : mapping issue with inheritance and abstract base class on collections with Entity Framework 4 Proxy Pocos","body":"<p>I am having an issue using AutoMapper (which is an excellent technology) to map a business object to a DTO where I have inheritance off of an abstract base class within a collection.</p>\n\n<p>Here are my objects:</p>\n\n<pre><code>abstract class Payment\nclass CashPayment : Payment\nclass CreditCardPayment : Payment\n</code></pre>\n\n<p>I also have an invoice object which contains a collection of payments like so:</p>\n\n<pre><code>    public class Invoice\n    {\n       ... properties...\n\n       public ICollection&lt;Payment&gt; Payments { get; set; }\n    }\n</code></pre>\n\n<p>I also have corresponding DTO versions of each of these objects.</p>\n\n<p>The DtoInvoice object is defined as:</p>\n\n<pre><code>[DataContract]\npublic class DtoInvoice\n{\n   ...properties...\n\n   [DataMember]\n   public List&lt;DtoPayment&gt; Payments { get; set; }\n}\n</code></pre>\n\n<p>This is what my Mapper definitions look like:</p>\n\n<pre><code>Mapper.CreateMap&lt;Invoice, DtoInvoice&gt;();\n\nMapper.CreateMap&lt;Payment, DtoPayment&gt;()\n  .Include&lt;CashPayment, DtoCashPayment&gt;()\n  .Include&lt;CreditCardPayment, DtoCreditCardPayment&gt;();\n\nMapper.CreateMap&lt;CashPayment, DtoCashPayment&gt;();\nMapper.CreateMap&lt;CreditCardPayment, DtoCreditCardPayment&gt;();\n</code></pre>\n\n<p>The code to perform the mapping looks like this:</p>\n\n<pre><code>var invoice = repo.GetInvoice(invoiceId);\n\nvar dtoInvoice = Mapper.Map&lt;Invoice, DtoInvoice&gt;(invoice);\n</code></pre>\n\n<p>So for example if my invoice object contains a collection of specific payments (say 1 cash and 1 credit card) when mapper tries to map them I get an error that the abstract class Payment cannot be created. If I remove the abstract keyword from the Payment object then the code works but I only get a collection of Payment object, I do not get their specific objects (Cash &amp; Credit Card payments).</p>\n\n<p>So the question is: How can I get AutoMapper to map the specific payment types and not the base class?</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>I did some more digging and think I see a problem but am not sure how I can solve this with AutoMapper. I think this is more of an EF thing and not AutoMapper's fault. :-)</p>\n\n<p>In my code I am using Entity Framework 4 Proxy POCOs with lazy loading.</p>\n\n<p>So when I try to map an entity returned from EF that is a proxy POCO it gets that funny looking type like:</p>\n\n<pre><code>System.Data.Entity.DynamicProxies.CashPayment_86783D165755C316A2F58A4343EEC4842907C5539AF24F0E64AEF498B15105C2\n</code></pre>\n\n<p>So my theory is that when AutoMapper tries to map CashPayment to DtoCashPayment and the payment passed in is of the proxy type AutoMapper sees it as a \"non match\" and then maps the generic Payment type. But since Payment is an abstract class AutoMapper bombs with a \"System.InvalidOperationException: Instances of abstract classes cannot be created.\" exception.</p>\n\n<p>So the question is: Is there a way for me to use AutoMapper to map EF POCO proxy objects to Dtos.</p>\n"},{"tags":["c#",".net","datetime"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":91,"score":7,"question_id":13249688,"title":"DateTime precision?","body":"<p><em>(ignoring the optimized compiler flag )</em></p>\n\n<p>can it be that this code will enter the block on some systems ? </p>\n\n<pre><code>if (Datetime.Now!=Datetime.Now)\n{\n ...\n}\n</code></pre>\n\n<p>I mean , how does it evaluate the values here ? (is it by order) ?</p>\n\n<p>Is there any situations where the condition <em>might</em> be true ?</p>\n\n<p>again , <em>ignore</em> the optimized flag.</p>\n"},{"tags":["c#",".net","datetime"],"answer_count":12,"favorite_count":1,"up_vote_count":20,"down_vote_count":0,"view_count":6504,"score":20,"question_id":1601609,"title":"How to check if two DateTime's occur on the same day","body":"<p>Is there a better .net way to check if a DateTime has occured 'today' then the code below?</p>\n\n<pre><code>if ( newsStory.WhenAdded.Day == DateTime.Now.Day &amp;&amp; newsStory.WhenAdded.Month == DateTime.Now.Month &amp;&amp; newsStory.WhenAdded.Year == DateTime.Now.Year )\n{ // Story happened today\n}\nelse\n{ // Story didn't happen today\n}\n</code></pre>\n"},{"tags":[".net","visual-studio-2010","clickonce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13249898,"title":"ClickOnce Deployment Of .Net 4.0.3 In Visual Studio 2010","body":"<p>I have installed the update for .Net 4.0.3 into Visual Studio 2010 ( <a href=\"http://support.microsoft.com/kb/2600214\" rel=\"nofollow\">http://support.microsoft.com/kb/2600214</a> ) and can now target framework 4.0.3 but it is not available as a prerequisite when I look at the options within ClickOnce.</p>\n\n<p>Would anyone know how to deploy this via ClickOnce?</p>\n"},{"tags":["c#",".net","entity-framework","ef-code-first","ef-migrations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13155292,"title":"Ignore pending migrations after database recreation","body":"<p>We am using code first EF 4.3.1 with database migrations. Sometimes we drop the database and let EF recreate it, mainly for local development purposes. </p>\n\n<p>There is a procedure which applies pending migrations and when the database is recreated the pending migrations aren't necessary and error is thrown when EF tries to apply them.</p>\n\n<p>I check the migration date from the string and if this is before the database creation date then I manually add it to the __migrationHistory table and don't apply the migration.</p>\n\n<p>This covers most of the scenarios except when someone recreates the database, updates from source control and retrieves oustanding migrations which are before the database creation date.</p>\n\n<p>I have also tried using a try catch around the dbMigrator.Update(migration) method call but if one migrations fails, further ones won't be applied as it remembers the exceptions.</p>\n\n<p>Has anyone found a way to get around this issue?</p>\n\n<p>This is the method I have written:</p>\n\n<pre><code>private static void ApplyMigration&lt;T, TU&gt;()\nwhere T : DbContext, new()\nwhere TU : DbMigrationsConfiguration, new()\n{\n    var migrationsAlreadyApplied = new List&lt;string&gt;();\n    var dbMigrator = new DbMigrator(new TU());\n\n    var creationMigrationId = dbMigrator.GetDatabaseMigrations().Single(m =&gt; m.Contains(\"InitialCreate\"));\n    var dbDateCreated = DateTime.ParseExact(creationMigrationId.Substring(0, 12), Constants.MigrationDateFormat, CultureInfo.InvariantCulture);\n\n    dbMigrator.GetPendingMigrations().ToList()\n                                    .ForEach(migration =&gt;\n                                    {\n                                        var migrationDate = DateTime.ParseExact(migration.Substring(0, 12), Constants.MigrationDateFormat, CultureInfo.InvariantCulture);\n\n                                        if (migrationDate &gt; dbDateCreated)\n                                            dbMigrator.Update(migration);\n                                        else\n                                            migrationsAlreadyApplied.Add(migration);\n                                    });\n\n    using (var dbContext = new T())\n    {\n        foreach(var migration in migrationsAlreadyApplied)\n            dbContext.Database.ExecuteSqlCommand(\"insert into __MigrationHistory \"\n                      + \"select '\" + migration + \"', Model, ProductVersion \"\n                      + \"from __MigrationHistory \"\n                      + \"where MigrationId = '\" + migration + \"'\");\n    }\n}\n</code></pre>\n"},{"tags":[".net","azure","windows-azure-storage","azure-storage-tables"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":41,"score":4,"question_id":13246720,"title":"Is Azure CloudTable thread-safe?","body":"<p>I'm writing to Azure Table storage using Storage SDK 2.0 from different threads (ASP.NET application).</p>\n\n<p>Is <strong>CloudTable</strong> object <strong>thread-safe</strong>? Can I initialize CloudStorageAccount, CloudTableClient and CloudTable only once (for example, in static constuctor) and then use them in different threads?</p>\n\n<p>Or is it better to create all CloudStorageAccount, CloudTableClient and CloudTable objects each time from a blank (like it's shown in <a href=\"https://www.windowsazure.com/en-us/develop/net/how-to-guides/table-services/\" rel=\"nofollow\">this article</a>)? Does it affect the performance in any way?</p>\n\n<p><em>What is a prefered way of getting instance of CloudTable each time executing an operation against the table?</em></p>\n"},{"tags":[".net","winforms","data-binding","nullable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13247240,"title":"Windows Forms databinding and nullable types","body":"<p>I know I'm using sunset technology here, but I'd like to find a solution to my problem nonetheless. </p>\n\n<p>I have an entity with some simple fields. I can bind textboxes on a form like this</p>\n\n<pre><code>nameTextBox.DataBindings.Add(new Binding(\"Text\", entity, \"Name\"));\n</code></pre>\n\n<p>I did the same for a date field,</p>\n\n<pre><code>evaluationDatePicker.DataBindings.Add(new Binding(\"Value\", entity, \"EvaluationDate\"));\n</code></pre>\n\n<p>and this too works fine as long as the EvaluationDate property is of type DateTime.</p>\n\n<p>However, if I now modify the entity and make EvaluationDate nullable, the binding becomes one-way. That is, the control reflects the property value (as long as it's not null), but it doesn't update the entity when I pick another date in the UI.</p>\n\n<p>In line with the recent Windows Forms policy of not throwing exceptions but rather pretend all is well even when things fail (a major annoyance in my book; Form_Load too now just swallows exceptions, though in this case of course we're way past Form_Load before the error occurs). So in fact I can't even tell if it's <em>trying</em> to do anything, but I have to assume it is, given that the two-way binding is working perfectly fine as long as the property isn't nullable.</p>\n\n<p>How can I overcome this?</p>\n\n<p>What I'm trying to do is write a base class for presenters in the application which has the ability to databind controls based on a simple naming convention. The presenter knows that for TextBox it should bind the Text property, for CheckBox it should bind \"Checked\", and so on. The mapping between properties and controls is done by convention - controls presenting a field should have the same name as the field plus the control type. Hence \"Name\" presented in a TextBox maps to \"NameTextBox\" (which is the convention I like to use anyway - I have never understood why people are still fond of prefixes specifically with GUI controls, but no other kind of code!?) and \"IsMarried\" in a checkbox would become \"IsMarriedCheckBox\". </p>\n\n<p>All of this allows the presenter to offer a method that accepts an object, \"datasource\", and a container where the controls to be bound are living. This makes for very rapid work adding a bunch of fields to a screen compared to having to use a bindingsource and write code, a solution which like mine does not give any compiler checks and does mean it's easy to break things by mistypes and property renames. </p>\n\n<p>But to make my little PoC I want to know what I can handle with this, and what sorts of things will still require other solutions. The whole thing would be considerably more valuable if it could support properties of nullable types, since we use them a lot. (Nor do I want to stop using them; bundling together the concept of \"has a value\" and if so \"which value\" is elegant and makes for less code, as well as more compiler help.) </p>\n\n<p>Is there a way? Anything I can hook into? Or possible to make a generic type of my own to replace Nullable&lt;T&gt;? Since I don't understand why it doesn't work without me having to do anything, it's difficult to imagine what might be worth trying to work around it.</p>\n"},{"tags":["c#",".net","taskbar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13249511,"title":"showing the autohiding windows taskbar","body":"<p>I have defined the windows taskbar as auto-hiding. Now I am showing for a way to show the taskbar from C#-code. Can somebody help me perhaps with a little code-snipped?</p>\n"},{"tags":["c#",".net","wpf","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13249356,"title":"Exists any way (or advice) to speed-up c#/WPF projects build?","body":"<p>I have the application (solution in VS2010) with +-10 projects. Some of these projects are quite large (dozens of folders and hundreds of files).</p>\n\n<p>When I make a change in project on lower level and I want to run my tests (+-10 seconds) then I have to wait 2 minutes for projects build.\nThis is very inefficient.</p>\n\n<p>Is there any way to speed-up build? For example, split current projects into multiple projects or something else?</p>\n\n<p>Or are there some general advice and recommendations to speed-up building projects in Visual Studio?</p>\n"},{"tags":[".net","asp.net","viewstate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":483,"score":0,"question_id":4400758,"title":"Failed to load viewstate","body":"<p>I have an interesting viewstate problem here that I'm having trouble ironing out.  Granted I'm not an expert at dealing with the viewstate, it is probably one of the most confusing theings about .NEt but that is neither here no there.  Here is the error I'm getting.</p>\n\n<blockquote>\n  <p>Failed to load viewstate.  The control tree into which viewstate is being loaded must match the control tree that was used to save viewstate during the previous request.</p>\n</blockquote>\n\n<p>What is weird about this is that it only happens on the homepage of the site (code is located in footer of master page). Every other page on the site it works fine.  Here is the aspx code. Note this is in the footer of the master file.</p>\n\n<pre><code>&lt;asp:UpdatePanel ID=\"upEmail\" runat=\"server\" &gt;\n  &lt;ContentTemplate&gt;\n    &lt;asp:MultiView ID=\"mview\" runat=\"Server\" ActiveViewIndex=\"0\"&gt;\n\n      &lt;asp:View ID=\"viewInput\" runat=\"Server\"&gt;\n        &lt;div&gt;\n          &lt;asp:Panel ID=\"pnlEmail\" runat=\"server\" DefaultButton=\"btnSubscribe\" Width=\"100%\" EnableViewState=\"False\"&gt;\n            &lt;asp:TextBox ID=\"tbEmail\" runat=\"server\" Width=\"125px\" CssClass=\"someClass\" title=\"Enter Your Email Address\" /&gt;\n            &lt;ajaxToolkit:TextBoxWatermarkExtender ID=\"TextBoxWatermarkExtender1\" TargetControlID=\"tbEmail\" WatermarkText=\"Email Address\" runat=\"server\" /&gt;\n            &lt;asp:RequiredFieldValidator ID=\"rfEmail\" runat=\"Server\" ControlToValidate=\"tbEmail\" ValidationGroup=\"submit\"&gt;*&lt;/asp:RequiredFieldValidator&gt;\n            &lt;asp:ImageButton ID=\"btnSubscribe\" ImageUrl=\"/Images/social/signup.gif\" Imagealign=\"absmiddle\" runat=\"server\" OnClick=\"BtnSubscribe_Clicked\" ValidationGroup=\"submit\" /&gt;\n            &lt;br /&gt;\n            &lt;asp:RegularExpressionValidator ID=\"regEmail\" runat=\"server\" ControlToValidate=\"tbEmail\" ErrorMessage=\"Please enter a valid email.\" ValidationExpression=\"\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*\" ValidationGroup=\"submit\" Display=\"dynamic\" ForeColor=\"\" CssClass=\"error_font_no_hover\" /&gt;\n          &lt;/asp:Panel&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n          &lt;asp:Label ID=\"lblMessage\" runat=\"server\" Visible=\"false\" /&gt;\n        &lt;/div&gt;\n      &lt;/asp:View&gt;\n\n      &lt;asp:View ID=\"viewSuccess\" runat=\"server\"&gt;\n        Thank You! You will now\n        &lt;br /&gt;\n        receive e-mails!\n      &lt;/asp:View&gt;\n\n    &lt;/asp:MultiView&gt;\n  &lt;/ContentTemplate&gt;\n&lt;/asp:UpdatePanel&gt;\n</code></pre>\n\n<p>I've tried disabling the viewstate on the panel and the error still occurs. Can anyone tell me what is going on?</p>\n\n<p>Thank You in advance</p>\n"},{"tags":["c#",".net","linq","lambda"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":13249515,"title":"Linq: Getting missing records","body":"<p>So heres my case i got 2 tables one with Languages one with Resources and what i want to do is to find all Resources that is missing on each language...</p>\n\n<p>The default language i wanna go after is languageId = 1</p>\n\n<p><strong>Table \"Resources\"</strong></p>\n\n<pre><code>Id    Key    Value    LanguageId\n1     k1     test     1\n2     k1     test     2\n3     k1     test     3\n</code></pre>\n\n<p><strong>Table \"Languages\"</strong></p>\n\n<pre><code>Id   \n1\n2\n3\n4\n5\n6\n7\n</code></pre>\n\n<p>language contains about 10 rows of languages.</p>\n\n<p>Now what i wanna do is to take out those resources that dosent exists \n<strong>(ex results)</strong></p>\n\n<pre><code>Key   Value   LanguageId\nk1    test    1\nk1    test    2\nk1    test    3\nk1    null    4\nk1    null    5\nk1    null    6\nk1    null    7\n</code></pre>\n\n<p>Any suggestions how to solve this problem, ive tried with GroupJoin And SelectMany but no good results.</p>\n"},{"tags":["c#",".net","silverlight","wcf-ria-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13249634,"title":"RiaServices. Silverlight. Error after adding new method","body":"<p>So.. \nAfter I added new method to RiaService and succesfully tested it and pushes the build to testers i recieved strange feedback from them. </p>\n\n<p>One of them said that she recieved an error:</p>\n\n<pre><code>Message: Invoke operation 'SomeMethodName' failed. \n[HttpWebRequest_WebException_RemoteServer]\nArguments: NotFound\n</code></pre>\n\n<p>The second one says that all works great. </p>\n\n<p>What can be the problem? Maybe some cache on IIS or something else?</p>\n"},{"tags":["c#",".net","visual-studio","msbuild","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13247409,"title":"Reference another project with Copy Local on it's reference","body":"<p>I have a project \"ProjA\" which wraps up references to several other projects and some 'plugin' assemblies.  All of those references have Copy Local set to 'True'.  Note that the code in the plugin assemblies (which are project references) is not referred to in \"ProjA\" directly, but is loaded and located through DI/Ninject.  (So I'm using these project references as a way of getting the plugin assemblies into the output folder, see below for why)</p>\n\n<p>I also have project \"ProjB\", which references ProjA.  It invokes ProjA code which should do it's thing, using the referenced plugin assemblies.</p>\n\n<p>The problem is, it doesn't work.  The plugin assemblies are not copied down from the ProjA output folder (which they are 'copied local'-into) into the ProjB output folder.  So Ninject doesn't load them, and the thing fails.</p>\n\n<p>So my two questions:</p>\n\n<ul>\n<li>If I have dictated to VS/msbuild that ProjA refers to projects P1, P2, P3, P4, and set copy local to true - why then would it assume only the main output assembly is required to make ProjA work?  Can I make it think any differently?</li>\n<li>I'm guessing that adding a Copy Local reference to the plugin assemblies as a way of having VS recognise a build dependency between the plugins and the project using them (currently a fixed set of plugins, hence this route) - is not ideal.  I then think that adding the plugin assemblies as 'Content' to the project would work, but then I have two issues: 1) TFS source control; the plugin projects need a writable target to build to, presumably - content files would be 'checked in' and 2) some of the plugins have Content of their own: with references I don't need to worry about missing something.  Going the Content route I need to refer to another project's build output folder, include all of it's content, but not the PDBs.. seems even more hacky!</li>\n</ul>\n\n<p>I have also considered and played with post-build steps for either the plugin projects (not ideal: I am pulling them into this new solution from another, if I add post-build steps it will likely screw up the other solution) or the project which depends on them (which is OK, but an XCopy with relative paths, and having to manually set up Project Dependencies.. seems more hacky again).</p>\n\n<p>Is there something I'm missing, any ideas at all?  If Copy Local chained across project references it would fit perfectly..</p>\n"},{"tags":["c#",".net","naudio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13248500,"title":"Microphone buffer in NAudio C#","body":"<p>I set sample rate on microphone(NAudio.WaveIn) 44100Hz. But when I use WaveInDataAvailible(object sender, WaveInEventArgs e). In e.Buffer I have 4410, instead of 44100 elements. Why this take me 10 times less measurement?</p>\n"},{"tags":["c#",".net","linq","generics","lambda"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13249206,"title":"Check property type at runtime and give the same type to Generic lamda expression parameter T","body":"<p>I have some code snippet given as below:</p>\n\n<p>Want to resolve this conditation by checking the type at runtime.</p>\n\n<pre><code>PropertyInfo pi = type.GetProperty(\"propertyName\");\n\nvar expression = new Object(); // this give me error after expression runs!\n\n    // Want to resolve this conditation by checking the type at runtime.\n    if (pi.PropertyType == typeof(DateTime))\n            {\n               // Want to pass the generic type parameter which has a same type created at runtime by identifying the property type.\n                expression = BuildExpression&lt;T, DateTime&gt;(data, group.Member);\n            }\n\nprivate Func&lt;T, V&gt; BuildExpression&lt;T, V&gt;(IEnumerable&lt;T&gt; items, string propertyName)\n    {\n      Type type = typeof(T);\n      PropertyInfo pi = type.GetProperty(propertyName);\n      Type PropertyType = pi.DeclaringType;\n      var parameter = Expression.Parameter(typeof(T), propertyName);\n      var cast = Expression.TypeAs(parameter, pi.DeclaringType);\n      var getterBody = Expression.Property(cast, pi);\n      var exp = Expression.Lambda&lt;Func&lt;T, V&gt;&gt;(getterBody, parameter);\n      return exp.Compile();\n    }\n</code></pre>\n\n<p><strong>Problem:</strong>\nI have to write condition on type  I have to check the type of property by reflection and then have to build the expression.</p>\n\n<p><strong>What I want:</strong>\nI want to check the runtime time the Type of property and want to build runtime Generic paramter of that type which is same as a property type.</p>\n\n<p>Basically I want to remove the <code>If</code> condition <em>on type checking</em> and What I want is, the code should <code>automatically detect the property type</code> and pass the same type in <code>Generic parameter argument</code>, so that I don't have to check with all the types with <code>If</code> condition. Like for <code>string, decimal, double etc..</code></p>\n\n<p>Could you please do let me know that resolution as I want to check the <code>property</code> type at runtime and want to create <code>Generic parameter type</code> with the <em>same type as property has</em>.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["c#",".net","reflection","properties"],"answer_count":2,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":86,"score":5,"question_id":13248199,"title":"How to create properties automatically?","body":"<p>I have a \"settings\" class, which has some properties for usability and to restrict set accessor. It seems easy while i had within ten items, but then their count was increased. I need some way to create these properties automatically, something like that:</p>\n\n<pre><code>foreach(var property in SettingsList)\n{\n    _settings.AddAutoProperty(property);\n}\n</code></pre>\n\n<p>It may have deal with reflection, but i can't get to efficient solution.</p>\n\n<p>The properties definition:</p>\n\n<pre><code>public bool cbNextExcCount\n{\n    get { return (bool)this.GetValueById(\"cbNextExcCount\"); }\n}\n\npublic bool cbSaveOnChangeExc\n{\n    get { return (bool)this.GetValueById(\"cbSaveOnChangeExc\"); }\n}\n\npublic bool cbAutoIncrement\n{\n    get { return (bool)this.GetValueById(\"cbAutoIncrement\"); }\n}\n\npublic bool cbRememberOnExit\n{\n    get { return (bool)this.GetValueById(\"cbRememberOnExit\"); }\n}\n\n...etc.\n</code></pre>\n\n<p><strong>UPDATE</strong>\nTo summ up, i wrote the next code:</p>\n\n<pre><code>public IDictionary&lt;string, object&gt; Properties = new ExpandoObject();\nprivate List&lt;string&gt; SettingsList = new List&lt;string&gt; \n{ \n    \"cbNextExcCount\",\n    \"cbSaveOnChangeExc\",\n    \"cbAutoIncrement\",\n    \"cbRememberOnExit\"\n};\n\npublic void CreateProperties()\n{\n    foreach (string SettingName in SettingsList)\n    {\n        Properties.Add(SettingName, () =&gt; this.GetValueById(SettingName));\n    }\n}\n</code></pre>\n\n<p>But i have an error on <code>() =&gt; this.GetValueById(\"cbNextExcCount\"))</code>:</p>\n\n<p>argument type 'lambda expression' is not assignable to parameter type 'object'.</p>\n\n<p>I can store <code>Func&lt;bool&gt;</code>, but settings may have other type than bool and if i use Func, it's get a bit more complicate to call.</p>\n"},{"tags":["c#",".net","asp.net"],"answer_count":5,"favorite_count":11,"up_vote_count":10,"down_vote_count":1,"view_count":2385,"score":9,"question_id":1907195,"title":"How to Get IP Address?","body":"<p>I want to get the ip address whoever is registering in my site. How to do this in ASPNET. I used the following code, but, it is not getting the proper IP Address</p>\n\n<pre><code>string ipaddress = Request.UserHostAddress;\n</code></pre>\n"},{"tags":["c#",".net","image-processing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13248897,"title":"Merge an array of Bitmaps into a single Bitmap","body":"<p>I'm trying to merge an array of <code>Bitmap</code>s into a single <code>Bitmap</code>. Given a <code>Bitmap[,]</code> array <code>b</code> like the following (assume these are images that look like characters):</p>\n\n<pre><code>b[0,0] = 1\nb[1,0] = 2\nb[0,1] = 3\nb[1,1] = 4\n</code></pre>\n\n<p>I want to generate</p>\n\n<pre><code>result = 12\n         34\n</code></pre>\n\n<p>For example, given the following four <code>Bitmap</code>s:</p>\n\n<p><code>b[0,0] =</code><img src=\"http://i.imgur.com/SG5XA.png\" alt=\"Image 0,0\" title=\"Example Image 1\"><code>;</code></p>\n\n<p><code>b[1,0] =</code><img src=\"http://i.imgur.com/xy7YQ.png\" alt=\"Image 1,1\" title=\"Example Image 2\"><code>;</code></p>\n\n<p><code>b[0,1] =</code><img src=\"http://i.imgur.com/bPB1N.png\" alt=\"Image 0,1\" title=\"Example Image 3\"><code>;</code></p>\n\n<p><code>b[1,1] =</code><img src=\"http://i.imgur.com/YO5QE.png\" alt=\"Image 1,1\" title=\"Example Image 4\"><code>;</code></p>\n\n<p>I want to generate\n<code>result =</code><img src=\"http://i.imgur.com/E2hY9.png\" alt=\"result\" title=\"Result Image\"><code>;</code></p>\n\n<p>Here's my code so far:</p>\n\n<pre><code>    public static Bitmap Moisac(ref Bitmap[,] b)\n    {\n        BitmapData[,] bmData = new BitmapData[b.GetUpperBound(0) + 1, b.GetUpperBound(1) + 1];\n        IntPtr[,] scan0 = new IntPtr[b.GetUpperBound(0) + 1, b.GetUpperBound(1) + 1];\n        unsafe\n        {\n            byte*[,] p = new byte*[b.GetUpperBound(0) + 1,b.GetUpperBound(1) + 1];\n            for (int i = 0; i &lt;= b.GetUpperBound(0); i++)\n                for (int j = 0; j &lt;= b.GetUpperBound(1); j++)\n                    if (b[i, j].Width != b[0, 0].Width | b[i, j].Height != b[0, 0].Height)\n                        throw new ArgumentException(\n                            \"Width and Height properties of all elements of b must be equal.\",\n                            \"b\");\n\n            int oneW = b[0, 0].Width;\n            int oneH = b[0, 0].Height;\n            int overallWidth = oneW * (b.GetUpperBound(0) + 1);\n            int overallHeight = oneH * (b.GetUpperBound(1) + 1);\n            Bitmap result = new Bitmap(b[0, 0], overallWidth, overallHeight);\n\n            for (int i = 0; i &lt;= b.GetUpperBound(0); i++)\n                for (int j = 0; j &lt;= b.GetUpperBound(1); j++)\n                {\n                    bmData[i, j] = b[i, j].LockBits(new Rectangle(0, 0, oneW, oneH),\n                                                    ImageLockMode.ReadOnly, PixelFormat.Format24bppRgb);\n                    scan0[i, j] = bmData[i, j].Scan0;\n                    p[i, j] = (byte*)(void*)scan0[i, j];\n                }\n\n            BitmapData rbmData = result.LockBits(new Rectangle(0, 0, overallWidth, overallHeight),\n                                                 ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);\n\n            int stride = bmData[0, 0].Stride;\n            int nOffset = stride - 3*b[0, 0].Width;\n\n            int rStride = rbmData.Stride;\n            IntPtr rScan0 = rbmData.Scan0;\n            byte* rp = (byte*) (void*) rScan0;\n\n            for (int imgY = 0; imgY &lt; b.GetUpperBound(1); ++imgY)\n            {\n                for (int imgX = 0; imgX &lt;= b.GetUpperBound(0); ++imgX)\n                {\n                    byte* currp = p[imgX, imgY];\n                    for (int y = 0; y &lt; oneH; ++y)\n                    {\n                        for (int x = 0; x &lt; 3*oneW; ++x)\n                        {\n                            rp[rStride*(imgY*oneH + y) + 3*imgX*oneW + x] = currp[0];\n                            ++currp;\n                        }\n                        currp += nOffset;\n                    }\n                }\n            }\n\n            for (int i = 0; i &lt;= b.GetUpperBound(0); i++)\n                for (int j = 0; j &lt;= b.GetUpperBound(1); j++)\n                    b[i, j].UnlockBits(bmData[i,j]);\n\n\n            result.UnlockBits(rbmData);\n            return result;\n        }\n    }\n</code></pre>\n\n<p>See the images in the album <a href=\"http://imgur.com/a/MA1q2\" rel=\"nofollow\">here</a>. All of them won't display here.</p>\n"},{"tags":["asp.net",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13248885,"title":"Eval with cast in aspx","body":"<p>I have an eval in an aspx page that has an eval in the template of a gridview. My problem is that that eval calls a method with parameters that are object. Can I change the method to accept the proper parameters and use cast with the eval stament.</p>\n\n<p>I need something like this:</p>\n\n<p><code>&lt;%# MyClas.MyMethod((string)Eval(\"Param1\"),(int)Eval(\"Param2\"), (string)Eval(\"Param3\"))%&gt;</code></p>\n"},{"tags":[".net","entity-framework","enterprise-library"],"answer_count":4,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":176,"score":2,"question_id":12282427,"title":"Transient Fault Handling with SQL Azure using Entity Framework","body":"<p>I currently use SQL Azure and Entity SQL in my application.</p>\n\n<p>e.g.</p>\n\n<pre><code>Entities model = new Entities();\ndb_Item item = model.db_Item.First();\n</code></pre>\n\n<p>Now I want to use the Transient Fault Handling out of the Enterprise Library but there are no examples or solutions that I can find that would allow me to do something like override the Entities class, so I don't have to update my code in hundreds of places.</p>\n\n<p>Could someone please provide more information on how this could be done?</p>\n"},{"tags":["c#",".net","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13248412,"title":"Match the pattern TEXT[0,0]","body":"<p>I have a lot of source codes with SQL queries like below:</p>\n\n<pre><code>c_query := \"SELECT * FROM TABLE WHERE FIELD_NAME_ONE[2] = 'AB' AND FIELD_NAME_TWO[1,8] = 'ABCDEFGH'\"\n</code></pre>\n\n<p>I would like to match these: <code>FIELD_NAME_ONE[2]</code> and <code>FIELD_NAME_TWO[1,8]</code> and these patterns must be found between double quotes (<code>\"</code>).</p>\n\n<p>Edit</p>\n\n<p>c_query := \"SELECT * FROM TABLE WHERE FIELD_NAME_ONE[2] = 'AB' AND FIELD_NAME_TWO[1,8] = 'ABCDEFGH' AND TESTE[9] = 'XXXXXXXXX' AND FOO = '\" + is_an_array[2] + \"'\"</p>\n\n<p>It shouldn´t match is_an_array[2] because is not inside the double quotes.</p>\n"},{"tags":["c#",".net","math","regression","linear-regression"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13231068,"title":"Applying mathematical expressions on time series data","body":"<p>I have parsed HL7 file and have generated some values. So that now, I have series of values over time for different identifiers of OBX segment of HL7 file.</p>\n\n<p>Now, as per requirement I want to apply following expressions over this timely generated data:</p>\n\n<p><code>dv/dt (Slope)</code></p>\n\n<p><code>d2v/dt2 (Acceleration</code></p>\n\n<p><code>Integration</code></p>\n\n<p><code>Bandpass</code></p>\n\n<p>For slope calculation I have referred <a href=\"http://dynamicnotions.blogspot.in/2009/05/linear-regression-in-c.html\" rel=\"nofollow\">http://dynamicnotions.blogspot.in/2009/05/linear-regression-in-c.html</a>. My small code will simply calculate slope of graph generated for values of one object identifier of HL7 file(like HR, PVC). I just want to know how can I apply all remaining expressions. Please tell me if there are any libraries I can refer for this. </p>\n"},{"tags":[".net","dll","reference","namespaces",".net-assembly"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13245784,"title":"MagicLibrary Assembly Reference Not Found in .Net 4.0 Project","body":"<p>For a migrating <code>C#</code> Project in .Net 4.0  I am using <code>magiclibrary.dll</code>, I can add this dll as reference to my project, and also I am able to get NameSpaces and Classes inside this Assembly. Till now there is no error with assembly or namespace references. But when I build the project it shows </p>\n\n<blockquote>\n  <p>Error 1  The type or namespace name 'Crownwood' could not be found (are you missing a using directive or an assembly reference?)<br>\n      \\CMT\\CMTCSCODE\\CMT\\TestForm.Designer.cs  57 17 CAStoSTR</p>\n</blockquote>\n\n<p>But when I create a sample C# project in .NET 4.0, and add the same <code>MagicLibrary.dll</code> there is no build Error. </p>\n\n<p>Why does it happens only in the existing project?</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13247326,"title":"Issue serializing / deserializing a custom object with double values","body":"<p>Trying to deserialize an instance of this class</p>\n\n<pre><code>[Serializable]\npublic class InstalledMeter : ISerializable \n{\n    public string Description { get; set; }\n\n    public double Latitude { get; set; }\n    public double Longitude { get; set; }\n\n    public void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        info.AddValue(\"Description\", Description);\n        info.AddValue(\"Latitude\", Latitude);\n        info.AddValue(\"Longitude\", Longitude);\n    }\n}\n</code></pre>\n\n<p>The instance:</p>\n\n<pre><code>new InstalledMeter {Description = \"Something\", Latitude = 0.0, Longitude = 0.0};\n</code></pre>\n\n<p>My Serialization methods</p>\n\n<pre><code>public static class SerializeString\n{\n    public static string SerializeObject&lt;T&gt;(this T toSerialize)\n    {\n        var xmlSerializer = new XmlSerializer(toSerialize.GetType());\n        var textWriter = new StringWriter();\n\n        xmlSerializer.Serialize(textWriter, toSerialize);\n        return textWriter.ToString();\n    }\n\n    public static T XmlDeserializeFromString&lt;T&gt;(this string objectData)\n    {\n        return (T)XmlDeserializeFromString(objectData, typeof(T));\n    }\n\n    public static object XmlDeserializeFromString(string objectData, Type type)\n    {\n        var serializer = new XmlSerializer(type);\n        object result;\n\n        using (TextReader reader = new StringReader(objectData))\n        {\n            result = serializer.Deserialize(reader);\n        }\n\n        return result;\n    }\n}\n</code></pre>\n\n<p>But when I serialize the object it has these values\n<img src=\"http://i.stack.imgur.com/C8z2A.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","fft","aforge"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13247904,"title":"Sound volume on defined frequency (C#)","body":"<p>I do not understand why the volume defined frequency is not as expected.</p>\n\n<p>I send sounds to my microphone with a few specified frequencies in turn. I then do FFT of my microphone buffer. On exit of FFT, I have an array of complex numbers. To know the volume of sound on the defined frequency, I look at my array, the number of element in this array I get this way:</p>\n\n<pre><code>MyFrequency = n*SamplingRate/SizeOfArray.\n</code></pre>\n\n<p>Next, I get the magnitude of complex number </p>\n\n<pre><code>(sqrt(Re^2+Im^2)\n</code></pre>\n\n<p>If I'm right, this shows me the volume of sound on this frequency. But this value changes strongly, depending on the frequency. If I'm wrong, please explain to me what I need to do in order to correct my mistake. If I'm right, please explain me why this values change so much.</p>\n"},{"tags":["c#",".net","linq","entity-framework","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13248360,"title":"Retrieving Data from database within the last 7 days using linq","body":"<p>I have a <code>view</code> with data and I need to retrieve data only from the last 7 days. I know there is a function for this if I was using sql query. but I'm using Linq. </p>\n\n<p>here is my code:</p>\n\n<pre><code>                try\n                {\n                var query = (from bwl in mg.BarcodeWithLocation\n                             select new\n                             {\n                                 RequestID = bwl.RequestID,\n                                 Barcode = bwl.Barcode,\n                                 adrid = bwl.AdrID,\n                                 name = bwl.Name,\n                                 street = bwl.Street,\n                                 houseno = bwl.HouseNo,\n                                 postal = bwl.Postal,\n                                 city = bwl.City,\n                                 country = bwl.Country,\n                                 latitudetxt = bwl.Latitude == \"\" ? \"Location Unknown\" : \"View Map Location\",\n                                 latitude = bwl.Latitude,\n                                 longitude = bwl.Longitude,\n                                 date = bwl.ReceivedDate\n                             });\n\n                this.Grid.DataSource = query;\n                this.Grid.DataBind();\n                }\n                catch (Exception exception)\n                {\n                      Console.WriteLine(\"ERROR in GetNoLocationScan() method. Error Message : \" + exception.Message);\n                }\n</code></pre>\n\n<p>can anyone tell me how I do this in Linq ?</p>\n"},{"tags":["c#",".net","deployment"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":208,"score":4,"question_id":3335361,"title":"Smart deployment of dll's in .net","body":"<p>We currently have an application that is roughly 22 megs total.  Our current deployment methodology is deploying the application to each of our clients servers and using a small update program go and copy all of the files to the local pcs if a new version is available.  The issue is that 22 megs is taking a bit more time than we would like to push updates.  Especially since we do an update every 2 weeks.  We are looking for a way to cut that time down.</p>\n\n<p>Our initial thought was for the local pcs to only copy the dlls that have been changed since the last time we deployed.  We are having some trouble with this as timestamps make it difficult to take accurate hashes of the file for comparisons.  Versions numbers could possibly work ok, but we would have to find a way to only version a file if it's code has changed.</p>\n\n<p>Just wondering if anybody has had success or recommendations for handling a similar process.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13247001,"title":"Better code for avoiding one dictionary - Case Sensitivity Issue","body":"<p>I have following method to fill a dictionary with values from a data reader.  There can be case mismatches between the data-reader fields and properties passed to the method. In the following method I  am converting the properties to lowercase first to address this issue. This causes two dictionaries. Is there a better way to achieve this with one dictionary?</p>\n\n<pre><code>private Dictionary&lt;string, object&gt; FillDictionaryWithReaderValues(List&lt;string&gt; propertiesOfAllEntities, IDataReader reader)\n{\n   Dictionary&lt;string, object&gt; lowerCaseDictionary = new Dictionary&lt;string, object&gt;();\n   Dictionary&lt;string, object&gt; propertyResultList = new Dictionary&lt;string, object&gt;();\n\n   foreach (var item in propertiesOfAllEntities)\n   {\n      lowerCaseDictionary.Add(item.ToLower(), null);\n   }\n\n   for (int i = 0; i &lt; reader.FieldCount; i++)\n   {\n      lowerCaseDictionary[reader.GetName(i).ToLower()] = reader[i];\n   }\n\n   foreach (var item in propertiesOfAllEntities)\n   {\n      propertyResultList.Add(item, lowerCaseDictionary[item.ToLower()]);\n   }\n\n   return propertyResultList;\n}\n</code></pre>\n"},{"tags":[".net","web-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13226817,"title":"Getting raw POST data from Web API method","body":"<p>I have the following Web API method in an ApiController class:</p>\n\n<pre><code>public HttpResponseMessage Post ([FromBody]byte[] incomingData)\n{\n  ...\n}\n</code></pre>\n\n<p>I want incomingData to be the raw content of the POST. But it seems that the Web API stack attempts to parse the incoming data with the JSON formatter, and this causes the following code on the client side to fail:</p>\n\n<pre><code>new WebClient().UploadData (\"http://localhost:15134/api/Foo\", new byte[] { 1, 2, 3 });\n</code></pre>\n\n<p>Is there a simple workaround for this?</p>\n"},{"tags":[".net","vb.net","user-interface","charts","rgb"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":728,"score":2,"question_id":8435409,"title":"how can i find the names and RGB values of colors in a .net Palette","body":"<p>I've got a chart showing data as a part of a vb.net forms application. The Chart object makes a really pretty picture, but I need it to match the color scheme on the rest of the UI. How do I get the RGB values for the palette? </p>\n\n<pre><code>Debug.Print(Chart1.Palette.Chocolate.WHAT ARE THE RGB COLORS??!)\n</code></pre>\n\n<p><strong>Edit 1</strong></p>\n\n<p>Note: Chocolate is both the name of a color and the name of a .net Palette   The post above refers to Chocolate the Palette, which contains multiple colors.</p>\n"},{"tags":["c#",".net","static-constructor","private-constructor"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":13248320,"title":"Private vs Static constructors in .Net","body":"<p>I searched for this a lot, but none of the answers are clear (at-least for me!). Now I'm putting this question in SO, as I believe I can't get a more clarified answer anywhere else.</p>\n\n<p>When should I use a private/static constructor in my class? </p>\n\n<p>I'm fed up of usual answers, so please help me with some real-time examples and advantages/disadvantages of using these constructors.</p>\n"},{"tags":["c#","asp.net",".net","asp.net-mvc-3","encryption"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13196837,"title":"Conditional encryption of file configuration file ASP.NET","body":"<p>I have a question.\nI have a solution with MVC3 progect. I need some configuration of my project for conditional encryption of config files.\nConditions:\nIf I build a debug version - file is not encrypted.\nIf I build a release version - file is encrypted.</p>\n\n<p>I find this <a href=\"http://weblogs.asp.net/scottgu/archive/2006/01/09/434893.aspx\" rel=\"nofollow\">article</a>  but I don't know how it can be automated.\nIs there some adjustments of solution properties in VS2010 needed or other?</p>\n\n<p>I want to have 2 related configs. If I made changes in non encrypted config, then after release build I receive new encrypted config with all applied changes.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":[".net","windows","graphics"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13248235,"title":"2d graphics speed, old / new methods, etc","body":"<p>We've been experimenting with different graphics approaches for a new app, speed is important. We have an old app that uses GDI which is great - it can refresh 10,000 rounds with no apparent delay at all. For the new app, we would like to use C# or VB, with WPF, no problem I thought, Direct 2d will give us the same performance. But having tried many examples, we can't get anything anywhere near as fast. The same amount of drawing might take 300mS, it must be 10 or 100 times slower. </p>\n\n<p>Is it really the case that if we want good graphics performance we have to stay with c++ / gdi, or are we missing something?</p>\n\n<p>Is there a sample project in c# or vb which demonstrates the best graphics performance achievable? </p>\n\n<p>Thanks</p>\n"},{"tags":["python",".net","qt","pyqt"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13246470,"title":"Is it possible to prevent .NET runtime from unloading DLLs on exit?","body":"<p>We're writing a mixed mode application in Python, Qt4 (4.6.1 at the moment) and .NET (for integration reasons).</p>\n\n<p>Now, when the app exists normally, the .NET runtime is unloaded, which sens PROCESS_DETACH to all DLLs. This seem to cause a crash when QHostInfoLookupManager' destriuctor estrys the threadpool.</p>\n\n<p>Is there some way to prevent this, besides:</p>\n\n<ul>\n<li>TerminateProcess?</li>\n<li>Move .NET code to separate process to avoid Qt issues.</li>\n</ul>\n\n<p>The call stack is as follows, when I get a crash:</p>\n\n<pre><code>python26.dll!1e02edbf()     \n[Frames below may be incorrect and/or missing, no symbols loaded for python26.dll]  \npython26.dll!1e078aba()     \nQtCore.pyd!01971058()   \nQtCore4.dll!qt_message_output(QtMsgType msgType=QtWarningMsg, const char * buf=0x077526a8)  Line 2223 + 0x1c bytes  C++\nQtCore4.dll!qt_message(QtMsgType msgType=QtWarningMsg, const char * msg=0x671b8464, char * ap=0x0012f1d4)  Line 2297    C++\nQtCore4.dll!qWarning(const char * msg=0x671b8464, ...)  Line 2378 + 0x11 bytes  C++\nQtCore4.dll!QWaitCondition::~QWaitCondition()  Line 156 C++\nQtCore4.dll!QThreadPoolPrivate::~QThreadPoolPrivate()  + 0xa2 bytes C++\nQtCore4.dll!QThreadPoolPrivate::`scalar deleting destructor'()  + 0x8 bytes C++\nQtCore4.dll!QObject::~QObject()  Line 992 + 0x16 bytes  C++\nQtCore4.dll!QThreadPool::~QThreadPool()  Line 430 + 0xf bytes   C++\nQtNetwork4.dll!QHostInfoLookupManager::~QHostInfoLookupManager()  Line 454 + 0x23 bytes C++\nQtNetwork4.dll!QHostInfoLookupManager::`scalar deleting destructor'()  + 0x8 bytes  C++\nQtNetwork4.dll!`theHostInfoLookupManager'::`8'::`dynamic atexit destructor for 'cleanup''()  + 0x14 bytes   C++\nQtNetwork4.dll!_CRT_INIT(void * hDllHandle=0x00385f30, unsigned long dwReason=3694344, void * lpreserved=0x00385f08)  Line 449  C\nQtNetwork4.dll!__DllMainCRTStartup(void * hDllHandle=0x64000000, unsigned long dwReason=0, void * lpreserved=0x00000000)  Line 560 + 0x8 bytes  C\nQtNetwork4.dll!_DllMainCRTStartup(void * hDllHandle=0x64000000, unsigned long dwReason=0, void * lpreserved=0x00000001)  Line 510 + 0xe bytes   C\nntdll.dll!_LdrpCallInitRoutine@16()  + 0x14 bytes   \nntdll.dll!_LdrShutdownProcess@0()  - 0xfe bytes \nkernel32.dll!__ExitProcess@4()  + 0x42 bytes    \nkernel32.dll!7c81cb26()     \nmscorwks.dll!SafeExitProcess()  + 0xb7 bytes    \nmscorwks.dll!DisableRuntime()  - 0x199708 bytes \nmscoreei.dll!RuntimeDesc::ShutdownAllActiveRuntimes()  + 0x873e bytes   \nmscoreei.dll!_CorExitProcess@4()  + 0x26 bytes  \nmscoree.dll!_ShellShim_CorExitProcess@4()  + 0x94 bytes \nmsvcr90.dll!__crtCorExitProcess(int status=0)  Line 716 C\nmsvcr90.dll!__crtExitProcess(int status=0)  Line 722 + 0x8 bytes    C\nmsvcr90.dll!doexit(int code=0, int quick=0, int retcaller=0)  Line 632  C\nmsvcr90.dll!exit(int code=0)  Line 412 + 0xc bytes  C\npython26.dll!1e030405()     \npython26.dll!1e02cd93()     \npython26.dll!1e02e887()     \npython26.dll!1e02ccba()     \nMyApp.exe!orz::runPythonFile(const char * file=0x00a203f0, QDir pydir={...}, QString pypath={...})  Line 66 + 0x3e bytes    C++\nMyApp.exe!orz::the_main(int argc=2, char * * argv=0x003860e0)  Line 132 + 0x50 bytes    C++\nMyApp.exe!main(int argc=2, char * * argv=0x003860e0)  Line 152 + 0xd bytes  C++\nMyApp.exe!_WinMain@16()  + 0xb8 bytes   \nkernel32.dll!_BaseProcessStart@4()  + 0x23 bytes    \n</code></pre>\n\n<p>Maybe there's something my message handling, but I don't want the dll unload from .net anyway. I tried altering the my logging a bit to avoid the python call, but then I  get stuck \"no usermode threads running, app is deadlocked\",  seems related to <a href=\"http://qt-project.org/forums/viewthread/20462\" rel=\"nofollow\">http://qt-project.org/forums/viewthread/20462</a>.</p>\n\n<pre><code>ntdll.dll!_KiFastSystemCallRet@0()  \nntdll.dll!_NtWaitForSingleObject@12()  + 0xc bytes  \nkernel32.dll!_WaitForSingleObjectEx@12()  + 0x8b bytes  \nkernel32.dll!_WaitForSingleObject@8()  + 0x12 bytes \nQtCore4.dll!QWaitCondition::wait(QMutex * mutex=0x07ccf200, unsigned long time=4294967295)  Line 175 + 0x15 bytes   C++\nQtCore4.dll!QThreadPoolPrivate::waitForDone()  Line 295 + 0x10 bytes    C++\nQtCore4.dll!QThreadPool::~QThreadPool()  Line 429   C++\n</code></pre>\n\n<p>Qt does not support dll unloading, as quoted from the above post</p>\n\n<blockquote>\n  <p>“To be perfectly honest, I don’t know what to do with this task. I\n  seem to recall seeing cases where Windows threads would disappear at\n  application exit, yet the HANDLE to those threads would not be\n  signaled (meaning your app would deadlock if waiting on the handle).</p>\n  \n  <p>I am tempted to simply mark this as “Out of Scope”, since, as Thiago\n  says, we do not test nor really support unloading the Qt libraries\n  from the application once they have been loaded.”</p>\n</blockquote>\n"},{"tags":[".net","drawing","2d"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13237752,"title":"Drawing a network of nodes in .NET, screen refreshing too slow","body":"<p>I am trying to create a .NET application for a visual representation of a network of nodes. The nodes are Drawing.Rectangle instances that can be dragged with the mouse and connections are made with Graphics.DrawLine. Like below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/mU4Ej.png\" alt=\"network\"></p>\n\n<p>To avoid that the rectangles are redrawn leaving an ugly train when they are dragged, I am calling Graphics.Clear on the component and redrawing each rectangle and line at each call of Mouse_Move. But this results in a very ugly, flashing effect as I am thinking that it is being called not to quick enough...</p>\n\n<p>Is there some .NET function or a better method of redrawing this scene so that the refreshing looks smoother?</p>\n\n<p>My Code:</p>\n\n<pre><code>    private void NodesPanel_MouseMove(object sender, MouseEventArgs e)\n    {\n        if (MouseButtons.Left == e.Button)\n        {\n\n            if (currentlyClickedNode != null)\n            {\n                surface.Clear(Color.White);\n                drawUnselectedNodes();\n                drawConnections();\n\n                if (!ClickedNodeGate) // Clicked on the node\n                {\n                    currentlyClickedNode.setPosition(e.X - QuestNode.NODE_WIDTH / 2, e.Y - QuestNode.NODE_HEIGHT / 2);\n                    currentlyClickedNode.drawMe(surface, penl);\n                }\n                else // clicked on the gate\n                {\n                    drawingLine = true;\n                    currentlyClickedNode.drawMe(surface, penl);\n                    DrawingHelper.DrawLine(surface, penl, currentlyClickedNode.getGatePosition(), new Vector2D(e.X, e.Y));\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>Thanks for any help you may be able to give.</p>\n"},{"tags":["c#",".net","lambda","locking"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13248032,"title":"Will a lock be persisted when control flows to a lambda function outside that lock?","body":"<p>Suppose I have the following code:</p>\n\n<pre><code>void DoStuff( SomeClass withObject )\n{\n    Action helper = () =&gt;\n    {\n        withObject.RunHelper();\n    }\n    lock( withObject ) {\n       actuallyDoStuff( helper );\n    }\n}\n\nvoid actuallyDoStuff( Action action )\n{\n    action();\n}\n</code></pre>\n\n<p>you see, the <code>Action helper</code> code is outside the <code>lock</code>. I'd expect that <code>Action</code> is just an unnamed function so calling it would not get control outside the <code>lock</code> and the <code>lock</code> would persists.</p>\n\n<p>Yet I'm not sure.</p>\n\n<p>Will the <code>lock</code> be released or persisted while control is inside <code>Action helper</code>?</p>\n"},{"tags":["c#",".net","excel","csv","pdf-generation"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":78,"score":0,"question_id":13239913,"title":"Free for commercial use tools for .NET that can convert csv to excel and export excel to pdf?","body":"<p>I've got a report being exported as <code>.csv</code>, and I need to offer two more formats of the report - <code>.xlsx</code> and <code>.pdf</code>, with added headers/footers/images.</p>\n\n<p>Originally, my plan was to use <code>Microsoft.Office.Interop.Excel</code> to open the <code>.csv</code>, modify it with <a href=\"http://epplus.codeplex.com/\" rel=\"nofollow\"><code>EPPlus</code></a> to add the header/footer/logo, and save it as an <code>.xlsx</code> file, then export it as a <code>.pdf</code> but the application is running within IIS, and <strong>automating office server-side is not recommended or supported</strong>.</p>\n\n<p><strong>1)</strong> Are there any free for commercial use tools for opening .CSV files and saving them as .XLSX?</p>\n\n<ul>\n<li><strong>EPPlus is the best option</strong> for this, as I can open CSV files, edit them, and save as Excel, which meets my requirement.</li>\n</ul>\n\n<p><strong>2)</strong> Are there any free for commercial use tools for exporting an <strong>Excel .XLSX file to .PDF</strong>?</p>\n\n<p><strong>3)</strong> Is there a tool that can do both?</p>\n"},{"tags":[".net","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":187,"score":0,"question_id":11269822,"title":"The type initializer for threw an exception in entity framework model?","body":"<p>I have 2 projects A and B<br>\neach project has its own database and connect to it using entity framework and each project is working well alone<br>\nMy problem is that when I use the project B as a library inside the project A It gives me \"The type initializer for (MYCLASS) threw an exception\"<br>\nyou should know that (MYCLASS): is an Entity inside the project B</p>\n"},{"tags":["c#",".net","visual-studio-2010","visual-studio","deployment-project"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13247710,"title":"Unload .vdproj (visual studio deployment project) from visual studio 2010 solution","body":"<p>I have a solution under source control, one of the projects in it is vdproj (Visual Studio Deployment Project) or setup project, this project gives me very annoying tens of messages every time i try to build the solution</p>\n\n<pre><code>---------------------------\nMicrosoft Visual Studio\n---------------------------\nThe command you are attempting cannot be completed because the file 'XXXXInstaller.vdproj' is under source code control and is not checked out.\n---------------------------\nOK   Help   \n---------------------------\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/BFbL1.png\" alt=\"Visual Studio Error Message - VDProj Error\"></p>\n\n<p>The question is: How to unload this project from the solution, when i try to unload it, there are no such option in the right-click context menu!</p>\n\n<p><img src=\"http://i.stack.imgur.com/ECc0Y.png\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","string","optimization"],"answer_count":10,"favorite_count":22,"up_vote_count":58,"down_vote_count":0,"view_count":27181,"score":58,"question_id":21078,"title":"What's the best string concatenation method using C#?","body":"<p>What's the most efficient way to concatenate strings?</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13238728,"title":"Mnemonic for ComboBox","body":"<p>How can we add <a href=\"http://msdn.microsoft.com/en-us/library/190kw3at%28v=vs.80%29.aspx\" rel=\"nofollow\">mnemonics</a> for <code>ComboBox</code>?</p>\n\n<p>For example, in a <code>CheckBox</code>, in the caption we can say '<code>Check&amp;BoxCaption</code>', notice the '&amp;' before 'B'. In the form, this 'B' gets underlined and we can access it by pressing Alt+B (as a keyboard shortcut).</p>\n\n<p>But how do we do this in case of <code>ComboBox</code>?</p>\n\n<p><img src=\"http://i.stack.imgur.com/zfxqL.png\" alt=\"Check mnemonic implemented on Visual Studio Options page in a label against a ComboBox\">\nCheck mnemonic implemented on Visual Studio Options page in a label against a <code>ComboBox</code></p>\n\n<p>I am guessing (checking the screenshot above), we create a mnemonic in the label against the <code>ComboBox</code>.\nHow do we link it to the <code>ComboBox</code>, in that case?</p>\n"},{"tags":["c#",".net","design","interface","compilation"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":13247670,"title":"Implementing interfaces in C# .NET","body":"<p>Consider the following interface</p>\n\n<pre><code>public interface ICustomData\n{\n    String CustomData { set; get; }\n}\n</code></pre>\n\n<p>According to MSDN documentation, interfaces members are automatically public.</p>\n\n<p>Lets say I now want to implement my interface:</p>\n\n<pre><code>public class CustomDataHandler : ICustomData\n{\n}\n</code></pre>\n\n<p>This would break at compile time, telling me that I have not implemented \"CustomData\"</p>\n\n<p>This on the otherhand would work:</p>\n\n<pre><code>public class CustomDataHandler : ICustomData\n{\n    public String CustomData { set; get; }\n}\n</code></pre>\n\n<p>My question is: If the member of the interface is automatically public, why MUST I declare the implementation in the class? If the interface declaration is syntactically identical to the class declaration, why can the compiler not infer this automatically from my interface?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>My reason for asking. Imagine a scenario where you are building data models, entities etc. I might code some interfaces to these models like so:</p>\n\n<pre><code>public interface IUserAccount\n{\n    Guid Identity { set; get; }\n    String FirstName { set; get; }\n    String LastName { set; get; }\n    String EmailAddress { set; get; }\n    String Password { set; get; }\n}\n\npublic interface IUserDataEntry\n{\n    Guid DataIdentity { set; get; }\n    String DataName { set; get; }\n    String Data { set; get; }\n}\n</code></pre>\n\n<p>It would be far simpler to construct the models like so:</p>\n\n<pre><code>public class UserAccount : IUserAccount\n{\n}\n\npublic class UserDataEntry : IUserDataEntry\n{\n}\n\npublic class Combined : IUserAccount, IUserDataEntry\n{\n}\n</code></pre>\n"},{"tags":[".net","cron","crontab"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13247652,"title":"Scheduling in MVC Application","body":"<p>I would like to add scheduling of reminders to my MVC Application, we will need options like </p>\n\n<ol>\n<li>daily reminders at 15:00</li>\n<li>weekly every thuesday, </li>\n<li>Yearly</li>\n<li>And so on....</li>\n</ol>\n\n<p>Basically we would like to imitate the recurring reminders as they work in Outlook. </p>\n\n<p>I have done a bit of research, but not sure if this is the way to go. I saw that CRON expressions could be used for this kind of scheduling.</p>\n\n<p>What is the best library / tutorial to implement this in a C# MVC4 application, i saw a few, but would like to know if anyone has experience with any of these.</p>\n\n<p><a href=\"http://www.geekytidbits.com/cron-expression-descriptor/\" rel=\"nofollow\">Cron Expression Descriptor</a></p>\n\n<p><a href=\"http://www.raboof.com/projects/ncrontab/\" rel=\"nofollow\">NCrontab (Crontab for .NET)</a></p>\n\n<p>Thanks in advance</p>\n"},{"tags":["asp.net",".net","asp.net-mvc","asp.net-mvc-3"],"answer_count":4,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":951,"score":17,"question_id":10498135,"title":"Last-Modified Header in MVC","body":"<p>I have recently come across the Last-Modified Header.  </p>\n\n<ul>\n<li>How and where can I include it in MVC? </li>\n<li>What are the advantages of including it?</li>\n</ul>\n\n<p>I want an example how last modified header can be included in an mvc project, for static pages and database queries as well?</p>\n\n<p>Is it different from outputcache, if yes how? </p>\n\n<p>Basically, I want the browser to clear the cache and display the latest data or pages automatically, without the need for the user to do a refresh or clearing the cache.</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","button"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13241832,"title":"Comparing Winform Button Colors","body":"<p>I have got four buttons in my form among four three buttons (btn2 btn3 btn4) have same color.</p>\n\n<p>when btn1 is clicked it will check if btn2 btn3 and btn4 are of same color without explicitly stating what color to compare. but my condition does not seem to be right\nshould i state this</p>\n\n<p>the code I'm using is:</p>\n\n<pre><code>private void btn1_Click(object sender, EventArgs e)\n{\n    if (btn2.BackColor.Equals((btn3.BackColor) &amp;&amp; (btn4.BackColor)))\n       {\n         MessageBox.Show(\"ALL BUTTONS ARE OF SAME COLOR\");\n       } \n}\n</code></pre>\n"},{"tags":[".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13134065,"title":"Hitting F5 after submit the page in asp.net?","body":"<p>I have web page with submit button, after submit the page when the user press F5 to refresh the page it'll do the thing which was done by last request.</p>\n\n<p>I have omit this by redirecting again the same page in submit_click function in C# Code behind itself.</p>\n\n<p>but i feel it'll create some performance problem when number of user's hit is increase.</p>\n\n<p>I have tried Server.Transfer also. but both of them is not right solution to protect against the problem.</p>\n\n<p>Is there any solution to over come from this problem?</p>\n\n<p>Thanks to all. </p>\n"},{"tags":["c#",".net","winforms","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13246492,"title":"interopservices v/s normal coding","body":"<p>I am trying to make a form borderless which can be resized and dragged.\n<br>Well I got two tutorials to do so <a href=\"http://www.codeproject.com/Articles/11114/Move-window-form-without-Titlebar-in-C\" rel=\"nofollow\"><strong>link1</strong></a> and <a href=\"http://www.codeproject.com/Articles/13571/Draggable-Form-Drag-a-Borderless-Form-by-Clicking\" rel=\"nofollow\"><strong>link2</strong></a> (and many more).\n<br>The first link has simple reference to <code>System.Runtime.InteropServices</code> with small code and <br> the second one is calling events like <code>MouseUp</code>,<code>MouseDown</code> and <code>MouseMove</code> with big code. </p>\n\n<p>I tried the two codes which are OK to me. As I am not good in C#, I cant determine which one is good based on performance. please suggest me with which I should go..</p>\n\n<p>Personally, I doubt using Interopservices (because I dont know anything about it).</p>\n"},{"tags":[".net","winforms","excel","clipboard","rtf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13089299,"title":"How to copy RTF text to clipboard for use in excel","body":"<p>Is it possible to copy a rtf string to the clipboard for excel. The formatting should be preserved as much as possible (e.g. text-color).</p>\n\n<p>The following .Net code is used to fill the clipboard</p>\n\n<pre><code>var dataObject = new DataObject();\ndataObject.SetData(DataFormats.Rtf, rtf);\nClipboard.SetDataObject(data_object);\n</code></pre>\n\n<ol>\n<li>Excel refuses the rtf clipboard content</li>\n<li>MS Word accepts the rtf content.</li>\n<li>When i paste into MSWord and copy from MSWord into Excel it works.</li>\n</ol>\n\n<p>What's the best way to convert the rtf to a format that excel accepts ?</p>\n\n<p>Remarks:\n  As @KreepN has suggested, System.Windows.Documents.TextRange can be used to convert RTF to HTML and vice versa. HTML is recognized by Excel.</p>\n"},{"tags":["c#",".net","sqlite","corruption"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":658,"score":1,"question_id":5835070,"title":"Programatically Repair SQLite Database","body":"<p>So I have a need to try and repair a SQLite database from a .NET program if the database file gets corrupted. I have found several sites such as <a href=\"http://community.spiceworks.com/how_to/show/1468\" rel=\"nofollow\">Fix SQLite</a> and in the <a href=\"http://www.sqlite.org/faq.html#q21\" rel=\"nofollow\">FAQ</a> it describes that you can:</p>\n\n<blockquote>\n  <p>Depending how badly your database is corrupted, you may be able to recover some of the data by using the CLI to dump the schema and contents to a file and then recreate.</p>\n</blockquote>\n\n<p>Does anyone know of a way to repair a SQLite database programatically in .NET?</p>\n"},{"tags":[".net","visual-studio-2010","c#-4.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13247325,"title":"Adding compile parameters in Visual Studio","body":"<p>I need to use .Net remoting.</p>\n\n<p>One of the requirements from:</p>\n\n<pre><code>http://msdn.microsoft.com/en-us/library/txct33xt%28v=vs.71%29.aspx\n</code></pre>\n\n<p>is to compile the code using:</p>\n\n<pre><code>csc /noconfig /t:library RemotableType.cs\n</code></pre>\n\n<p>how can I add the /noconfig and /t:library compilation flags in Visual Studio?</p>\n\n<p>Another command that I need to use then is:</p>\n\n<pre><code>csc /noconfig /r:RemotableType.dll Listener.cs\n</code></pre>\n"},{"tags":["c#","asp.net",".net",".net-4.0","server.mappath"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13247123,"title":"Server.MapPath issue?","body":"<p>So I am reading a book about asp.net security. and one of the sections there was : \nhow to prevent directory traversal filename ( hacked filenames).</p>\n\n<p>so the line of code was : </p>\n\n<p><code>string fullPath = Server.MapPath(System.IO.Path.Combine(@\"d:\\inetpub\\inbound\\\",filename));</code></p>\n\n<p>but then I noticed the  result of the combine which will be : </p>\n\n<pre><code>d:\\inetpub\\inbound\\myfile.txt\n</code></pre>\n\n<p>But I remember that the parameter type should be <strong>virtual</strong> path  and not filesystem path !</p>\n\n<p><img src=\"http://i.stack.imgur.com/BgUqx.jpg\" alt=\"enter image description here\"></p>\n\n<p><code>d:\\inetpub\\inbound\\myfile.txt</code> is not a virtual path!</p>\n\n<p>what am I missing ?</p>\n\n<p><img src=\"http://i.stack.imgur.com/DMOnW.jpg\" alt=\"enter image description here\"></p>\n\n<p>p.s. this is the book : (wrox)</p>\n\n<p><img src=\"http://i.stack.imgur.com/CT7Tp.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["c#",".net","dropbox","dropbox-api","dropnet"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":547,"score":0,"question_id":11494989,"title":"DropNet DropBox login, how to do it programmatically in a console application?","body":"<p>Question:</p>\n\n<p>I'm using a DropBox csharp API from here:<br />\n<a href=\"https://github.com/dkarzon/DropNet\" rel=\"nofollow\">https://github.com/dkarzon/DropNet</a></p>\n\n<p>From the Unit tests, and the only working sample from here\n<a href=\"https://github.com/dkarzon/DropNet/blob/master/DropNet.Samples/DropNet.Samples.Web/Default.aspx.cs\" rel=\"nofollow\">https://github.com/dkarzon/DropNet/blob/master/DropNet.Samples/DropNet.Samples.Web/Default.aspx.cs</a></p>\n\n<p>I figured that it works like this:</p>\n\n<pre><code>DropNet.DropNetClient client = new DropNet.DropNetClient(strApiKey, strAppSecret);\n\nDropNet.Models.UserLogin login = client.GetToken();\nclient.UserLogin = login;\n\nvar accountInfo = client.AccountInfo();\nstr = accountInfo.quota_info.quota.ToString();\n</code></pre>\n\n<p>The probem is, it throws an exception on accountinfo. (System.Net.HttpStatusCode.Unauthorized)\nEverything before works fine, I get the login (usertoken &amp; usersecret) .</p>\n\n<p>I think my problem is this part of the sample application:</p>\n\n<pre><code>var url = _client.BuildAuthorizeUrl(Request.Url.ToString() + \"?dropboxcallback=1\");\nResponse.Redirect(url);\n</code></pre>\n\n<p>Where it redirects to dropbox for a login...\nI don't have a web application, so I have no URL...</p>\n\n<p>What I have is a console application, that should make a backup of my database every evening automatically as a service, for which it certainly is very bad requiring a webbrowser and a user which has to type in email/username + password.</p>\n\n<p>How can I do a login by directly supplying the hardcoded username and password ?</p>\n\n<p>If I use the sample application, then it works, but that requires typing in the username and password on the web, and that sucks big time for a console application...</p>\n"},{"tags":[".net","asp.net-mvc","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13243727,"title":"Print Text on Submit - VB.NET 2012, MVC 4, Visual Studio 2012","body":"<p><strong>The Tools Used:</strong> VB.NET 2012, MVC 4, Visual Studio 2012</p>\n\n<h2>The Controller: SubmitFormController.vb</h2>\n\n<pre><code>Namespace MvcApplication19\n    Public Class UserNamePrintOutSubmitClassController\n        Inherits System.Web.Mvc.Controller\n\n        ' This method will handle GET\n        Function Technology() As ActionResult\n            Return View(\"Technology\")\n        End Function\n\n        ' This method will handle POST\n        &lt;HttpPost&gt;\n        Function UserNamePrintOut() As ActionResult\n            ' Do something\n            Response.Write(\"Hello \" &amp; Request.QueryString(\"UserName\") &amp; \"&lt;br /&gt;\")\n            Return View()\n        End Function\n    End Class\nEnd Namespace\n</code></pre>\n\n<h2>The View: Technology.vbhtml</h2>\n\n<p><strong>The URL:</strong> <code>http://localhost/Home/Technology/</code></p>\n\n<pre><code>&lt;form action=\"\" method=\"post\"&gt;\n    &lt;input type=\"text\" name=\"UserName\" /&gt;\n    &lt;input type=\"submit\" name=\"UserName_submit\" value=\"Print It Out!\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<h2>The Question</h2>\n\n<p>I do not have a model in this example. The intention is to have the <code>UserName</code> submitted with the submit button and have it printed on the screen, <code>on page load</code>. Which means, the <code>UserName</code> should get passed to the <code>action method</code> and get printed on the screen.</p>\n\n<p>I am having no error messages, nevertheless, the <code>UserName</code> does not get printed on the screen, perhaps, somebody, can have look at the code above.</p>\n\n<p>I have been trying this with tutorials, which are often in C#. My background has been PHP, and I still tend to think in terms of \"echo\" - yet, I am getting used to MVC 4.</p>\n"},{"tags":[".net","web-services"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13246982,"title":"Where to place init code in a Web Service Project?","body":"<p>I have to do some stuff when the server start. This a web service. I've put the calls in the Global_asax, but it seems that it isn't execute every time...</p>\n\n<p>Is this the right place to put initilazation? If not, where can I put them?</p>\n"},{"tags":[".net","wcf","architecture","windows-services","cloud"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13244604,"title":"Architecture to manage multiple instances of a worker?","body":"<p>What architecture should I go for? There is a worker process which takes messages off a queue and does processing one by one. Now I can have many windows service instances do this job, or I can have one WCF service hosted as a windows service to act as some sort of a server on which I can start a thread for each instance.</p>\n\n<p>Which approach would scale better? I want viewpoints when we are talking about cloud like infrastructure where scaling is very quick, as well as, non-cloud based infrastructure.</p>\n"},{"tags":[".net","compilation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":12911222,"title":"Service/scheduler to compile and deploy a .net project","body":"<p>I need to create Service/scheduler to compile and deploy a different .net projects.\nI have been looking at various tools like Cruisecontrol, Octopus, Puppet etc.\nCan somebody please suggest which one is the best and easy to user with multiple .net projects of possibly different version with minimal change in the projects itself.\nThanks .</p>\n"},{"tags":["asp.net",".net","sockets","signalr","polling"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":26,"score":-1,"question_id":13235035,"title":"Using signalr in stock trading website in asp.net","body":"<p>I am building a stock market site with trading in asp.net. I have two server</p>\n\n<p>Server1: I have a windows form application which is running on it. This form application broadcast data for particular client and does login validation.</p>\n\n<p>Server2: Where my website is hosted.Here with the help of tcp ip socket connection with the server1 windows application it sends the stock ticker according to the user subscribed for the stock code for particular client.</p>\n\n<p>Problems Faced:</p>\n\n<p>1) Connection with windows application on per client base from the website for getting data.</p>\n\n<p>2) polling option to update particular ticker in the browser with the data fetched from windows application</p>\n\n<p>Please provide a correct way out to implement the things. If possible using signalr.\nPlease do provide solution with some sample example.</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":7,"view_count":52,"score":-6,"question_id":13245845,"title":"Is it possible to assign a list/objectlist to other list in C#","body":"<p>I would like to assign  a list/objectlist to another list in C# for e.g.:</p>\n\n<pre><code> //first variable \n List&lt;KeyValuePair&lt;int, double&gt;&gt; debitpointList=new List&lt;KeyValuePair&lt;int,double&gt;&gt;(); \n\n //second variable\n List&lt;KeyValuePair&lt;int, double&gt;&gt; cashpointList = new List&lt;KeyValuePair&lt;int, double&gt;&gt;(); \n</code></pre>\n\n<p>Here <code>debitpointList</code> and <code>cashpointList</code> need to be passed by appending these to a list.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["c#",".net","multithreading"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":51,"score":4,"question_id":13246401,"title":"Should my field be volatile when initializing on a background thread?","body":"<p>On application startup, I am instantiating a class on a background thread, then assigning it to a variable.  I later access that variable from my main thread.  This variable is only assigned once.</p>\n\n<p>My understanding is that I don't need to use the volatile keyword here, because the reference could not be cached until it is first accessed in the UI thread. Am I correct in my thinking, or am I missing something?</p>\n"},{"tags":["c#",".net","wpf","installer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":13245119,"title":"C# - Make custom installer for wpf application","body":"<p>I want to make a custom application installer for my wpf application. I want to show licence agreement which user will need to accept to proceed then he needs to enter key. then installation bar will begin.</p>\n\n<p>how to do that?Is there any link which can help me?</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":52,"score":-2,"question_id":13245357,"title":"Adding items to existing list","body":"<p>I have a list as below:</p>\n\n<pre><code>List&lt;Teacher&gt; _teacher= new List&lt;Teacher&gt;();\n</code></pre>\n\n<p>Teacher has below fields :</p>\n\n<pre><code>public class Teacher\n{\n    public string name{ get; set; }\n    public string age{ get; set; }\n    public string basic{ get; set; }\n    public string hra{ get; set; }\n\n   }  \n</code></pre>\n\n<p>Another list as below:</p>\n\n<pre><code>List&lt;Salary&gt; _salary= new List&lt;Salary&gt;();\n</code></pre>\n\n<p>Salary has below fields :</p>\n\n<pre><code>public class Salary\n{\n    public string basic{ get; set; }\n    public string hra{ get; set; }\n} \n</code></pre>\n\n<p>In a particular condition ,List Teacher is being populated with name and age only.I need to populate the basic and hra in teacher list from the salary list.\nHow can I do this? </p>\n"},{"tags":["c#",".net","properties","microsoft","word"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":783,"score":2,"question_id":1527204,"title":"Saving Word 2007 Document Properties in C# 2.0","body":"<p>I'm trying to modify some CustomDocumentProperties for a .docx document.  So far I've been able to read the current value and modify it, but, for whatever reason, whenever I save the document the changes to the custom fields are lost.</p>\n\n<p>I have the following method within a DocAccessor class (which serves as an interface for my doc files):</p>\n\n<pre><code>void SetInfo(string key, string val) {\n    object custom_properties = current_doc.CustomDocumentProperties;\n    Type custom_properties_type = custom_properties.GetType();\n    custom_properties_type.InvokeMember(\"Item\", BindingFlags.Default | BindingFlags.SetProperty, null, custom_properties, new object[] { key, val });\n}\n</code></pre>\n\n<p>elsewhere I call:</p>\n\n<pre><code>doc_accessor.GetInfo(\"Number\") //returns 5\ndoc_accessor.SetInfo(\"Number\", \"6\");\ndoc_accessor.GetInfo(\"Number\") //returns 6\ndoc_accessor.SaveAndClose();\ndoc_accessor.Open(); //it retains the path, so I don't need to respecify\ndoc_accessor.GetInfo(\"Number\") //returns 5\n</code></pre>\n\n<p>My doc_accessor.SaveAndClose() function is working correctly as I modified the path to save to a different location and it did... but without writing the modified CustomDocumentProperties.  This makes it seem as if there's a commit step of sorts that I'm missing, but shouldn't current_doc.Save() handle that?</p>\n\n<p>Any help, advice or corrections are welcome!</p>\n"},{"tags":[".net","workflow-foundation","bug"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13245939,"title":"Workflow foundation 4.5 build error","body":"<p>As a preparing to migrate to .NET 4.5 I tryed to use WWF 4.5 and found really strange blocking issue:</p>\n\n<p>1) Open VS 2012.\n2) Create new \"Workflow Console Application\" Targeted to .NET 4.5\n3) Try to build:</p>\n\n<p>The result is following build error:</p>\n\n<p>.... error XC1000: XC1020: Build error occurred in the XAML MSBuild task: 'Could not load file or assembly 'file:///full path to\\WorkflowConsoleApplication2\\obj\\x86\\Debug\\WorkflowConsoleApplication2.dll' or one of its dependencies. The system cannot find the file specified.'</p>\n\n<p>On all our dev boxes we have the same issue.\nBTW I see the it is looking for .dll (but we build .exe) and I try to create Activity Library project.\nBut see error again.</p>\n\n<p>WTF?</p>\n\n<p>Could anybody tell me what is it and how to fix it?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","tfs","basic-authentication"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13245776,"title":"How to authentication in tfspreview.com with the new basic authentication from .net service?","body":"<p>I am trying to access <a href=\"https://tfspreview.com\" rel=\"nofollow\">https://tfspreview.com</a> from my windows service written on .NET. I want to use the new basic authentication but I couldn't find a way to do it. \nI found a lot of links to the blog post <a href=\"http://tfspreview.com/en-us/home/news/2012/aug-27/\" rel=\"nofollow\">Team Foundation Service updates - Aug 27</a> but it is using the tfs everywhere. Is there a new version of the .net library to support the basic authentication?</p>\n\n<p>By the way I've successively logged in with the service account. <a href=\"http://stackoverflow.com/questions/11560568/how-to-authenticate-to-https-tfspreview-com-microsoft-hosted-tfs-using-java\">This answer</a> was very useful.</p>\n\n<p>Any suggestions how to accomplish the basic authentication?</p>\n"},{"tags":[".net","elasticsearch","nest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":12698178,"title":"Usage of SearchBuilder in NEST ElasticSearch client","body":"<p>I was wondering if anyone had any tips or examples for using the SearchBuilder API in NEST. The docs are still kinda sparse.</p>\n\n<p>I am looking to dynamically construct queries/filters based on criteria sent in URL parameters. An example:</p>\n\n<p>www.mydomain.com/things/search?prop1=3&amp;prop2=foo&amp;prop3=bar</p>\n\n<p>And once I extract those I want to build an exact-match query based on the criteria that are present.</p>\n"},{"tags":[".net","regex","string","parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13245529,"title":"Regex to remove string in between delimiters","body":"<p>I am trying to get rid of the delimited text.</p>\n\n<p>For Example:  \"this#101# is#102# a#103# test#104#\"</p>\n\n<p>Result : \"this is a test\"</p>\n\n<p>Tried the Following which didn;t Work</p>\n\n<pre><code>string Pattern = @\"(?&lt;=#).*(?=#;)\";\nstring text = \"this#101# is#102# a#103# test#104#\";\ntext = Regex.Replace(text, Pattern, string.Empty);\n</code></pre>\n"},{"tags":["c#",".net","xaml","windows-phone","windows-phone-8"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":82,"score":0,"question_id":13236798,"title":"Memory overflow on Windows Phone 8","body":"\n\n<p>I have an app which runs ok on <strong>Windows Phone 7</strong>, but the same XAP on <strong>Windows Phone 8</strong> (<em>Nokia Lumia 920</em>) device crashes due to memory overflow. This happens because <em>Lumia 920</em> has higher resolution and pixel density, so bitmap cache for the same control is much bigger in size, also it seems that WP8 uses better scaling algorithm for bitmap cache which requires more memory.</p>\n\n<p>In more detail, in the app there are 5 big <strong><em>independent</em></strong> controls with size of 1000x1000 each. Let’s call them layers of a map. Each layer of the map is entirely drawn in XAML and cannot be cut or sliced. The map can be dragged or scaled by user. To make these operations smooth I need to set for each layer CacheMode property to BitmapCache with RenderAtScale = 2 to keep text clear when scaling.</p>\n\n<p>Setting bitmap cache increases memory consumption on <strong><em>76 Mb</em></strong> (= (2 * 1000)<sup>2</sup> pixels * 4 bytes per pixel) on <strong>WP7</strong> which is ok for the OS and on <strong><em>~ 195 Mb</em></strong> (experimental) on <strong>WP8</strong> which leads to app crash on a real device!</p>\n\n<p>Here is sample code which crashes on the <em>Lumia 920</em> and works ok on the <em>7.1 or WXGA emulators</em>:</p>\n\n<pre><code>&lt;Rectangle Fill=\"Red\" Width=\"1000\" Height=\"1000\"&gt;\n    &lt;Rectangle.CacheMode&gt;\n        &lt;BitmapCache RenderAtScale=\"2\"/&gt;\n    &lt;/Rectangle.CacheMode&gt;\n&lt;/Rectangle&gt;\n&lt;Rectangle Fill=\"Red\" Width=\"1000\" Height=\"1000\"&gt;\n    &lt;Rectangle.CacheMode&gt;\n        &lt;BitmapCache RenderAtScale=\"2\"/&gt;\n    &lt;/Rectangle.CacheMode&gt;\n&lt;/Rectangle&gt;\n&lt;Rectangle Fill=\"Red\" Width=\"1000\" Height=\"1000\"&gt;\n    &lt;Rectangle.CacheMode&gt;\n        &lt;BitmapCache RenderAtScale=\"2\"/&gt;\n    &lt;/Rectangle.CacheMode&gt;\n&lt;/Rectangle&gt;\n&lt;Rectangle Fill=\"Red\" Width=\"1000\" Height=\"1000\"&gt;\n    &lt;Rectangle.CacheMode&gt;\n        &lt;BitmapCache RenderAtScale=\"2\"/&gt;\n    &lt;/Rectangle.CacheMode&gt;\n&lt;/Rectangle&gt;\n&lt;Rectangle Fill=\"Red\" Width=\"1000\" Height=\"1000\"&gt;\n    &lt;Rectangle.CacheMode&gt;\n        &lt;BitmapCache RenderAtScale=\"2\"/&gt;\n    &lt;/Rectangle.CacheMode&gt;\n&lt;/Rectangle&gt;\n</code></pre>\n\n<p>How to deal with this problem? What would you suggest?</p>\n\n<p>Setting <strong>ID_FUNCCAP_EXTEND_MEM</strong> does not help at all.</p>\n"},{"tags":["c#",".net","excel","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13245252,"title":"Get Range in Excel 2007","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13231608/excel-data-coloring-via-oledb\">Excel data coloring via OLEDB</a>  </p>\n</blockquote>\n\n\n\n<p>Pls find the below coding</p>\n\n<pre><code>OleDbCommand cmd = new OleDbCommand(\"Select * from [\" + txtsheet.Text + \"] WHERE [ASSET    NUM] = \" + asset + \"\", con);\n OleDbDataReader rdr = cmd.ExecuteReader();\n OleDbDataAdapter da = new OleDbDataAdapter(cmd);\n int x = cmd.ExecuteNonQuery();\n</code></pre>\n\n<p>after this i need to get the range of the selected cells in excel</p>\n\n<p>please help me for this with the coding</p>\n\n<p>thanks in advance</p>\n\n<p>Regards</p>\n\n<p>Mahendran</p>\n"},{"tags":["c#",".net","cross-threading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13244955,"title":"Show form in main thread from another thread","body":"<p>I developing multithreading application with main form and another form in which progress is shown.\nAt first: I create ProgressForm in MainForm</p>\n\n<pre><code>Progress p=new Progress();\n</code></pre>\n\n<p>Second: I create new instance of class Model (whith all data in my app). </p>\n\n<pre><code>Model m = new Model();\n</code></pre>\n\n<p>And subscribe for event:</p>\n\n<pre><code> m.OperationStarted += new EventHandler(OnCopyStarted);\n\nprivate void OnCopyStarted(object sender, EventArgs e)\n{\n  p.Show();\n}\n</code></pre>\n\n<p>Third: I run some operation in another thread where I change property in another Model </p>\n\n<pre><code> private bool isStarted;\n            public bool IsStarted\n            {\n                get{return isStarted;}\n                set \n                {\n                    isStarted = value;\n                    if (isStarted &amp;&amp; OperationStarted != null)\n                    { \n                        OperationStarted(this, EventArgs.Empty);\n                    }\n                }\n            }\n</code></pre>\n\n<p>My questoin is: Why Progress form is show not in Main Thread? How can I run it without lockups?</p>\n"},{"tags":["c#",".net","sql","datatable"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":75,"score":2,"question_id":12947872,"title":"Quickest way to create DataTable from query?","body":"<p>What is the code with the smallest number of lines that will generate a <code>DataTable</code> from this SQL query?</p>\n\n<pre><code>SELECT * \nFROM [Table1] \nWHERE ([Date] BETWEEN @Date1 AND @Date2) AND \n      ([Field1] IS NULL OR [Field2] IS NULL)\n</code></pre>\n"},{"tags":["c#","asp.net",".net","xml","xmlhttprequest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12805083,"title":"How to write data to xml from database using aspx pages?","body":"<p>I have some stored proc.s that get data from DB.\nI made some data access layers classes to get the data from the sql db\nI have some Xml files that should be filled with this data. \nI'm supposed to link between them using aspx pages. \nNow, I want to know how can I read data at the aspx page from the xml file to send it to the server, and how can I write data from the db to the xml files. </p>\n\n<p>I used to use json, but is there a method in which I can send and receive data without using json &amp; just using XML ? </p>\n\n<p>This is my XML File: </p>\n\n<pre><code>&lt;allNews&gt;\n&lt;news&gt;\n    &lt;gNews&gt;\n        &lt;flag&gt;List of categories IDs this article linked to&lt;/flag&gt;\n        &lt;title&gt;news title goes here&lt;/title&gt;\n        &lt;description&gt;news description goes here&lt;/description&gt;\n        &lt;date&gt;news date goes here&lt;/date&gt;\n    &lt;/gNews&gt;\n&lt;/news&gt; \n</code></pre>\n\n<p>This is the function that retrieves a list from the database: </p>\n\n<pre><code>XDataContext XDB = new XDataContext();\n\n    public getCategoryContentListResult GetCategoryContentList(int contentID)\n    {\n        return XDB.getCategoryContentList(contentID).SingleOrDefault&lt;getCategoryContentListResult&gt;();\n    }\n</code></pre>\n\n<p>I want to know how can I connect these two files using aspx. </p>\n\n<p>When I used Json I used to do this: [I read data from an ajax call at the javascript file)</p>\n\n<pre><code>        private getCategoryContentListResult GetCategoryList()\n        {     \n              int ContentID = int.parse(Request.QueryString[\"country\"]);     \n              int res = getCategoryContentListResult(ContentID);\n              JsonResponse = JsonConvert.SerializeObject(res);\n        }\n        Response.Clear();\n        Response.ContentType = \"application/json\";\n        Response.ContentEncoding = System.Text.Encoding.UTF8;\n        Response.Write(Request.QueryString[\"jsoncallback\"] + \"(\" + JsonResponse + \");\");\n        Response.End(); \n</code></pre>\n\n<p>Now I can't use Json, I just have to use XML. SO is there some method to do it ?</p>\n"},{"tags":[".net","winforms","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":70,"score":3,"question_id":13214503,"title":"Target .NET 4.0 but .NET 4.5 is required","body":"<p>We recently moved to VS 2012, but we are required to keep on using .NET 4.0. A large part of our customer base is still using XP and .NET 4.5 is not supported on Windows XP.</p>\n\n<p>Now, all projects in the solution are targeting .NET 4.0 or lower. When we run the application it tells us to install the .NET 4.5 Framework, while only the .NET 4.0 is used?</p>\n\n<p>In the generated config file I see:</p>\n\n<pre><code>&lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\" /&gt;\n&lt;/startup&gt;\n</code></pre>\n\n<p>If I change <code>Version=v4.5</code> to <code>Version=v4.0</code> manually in the config file, everything works fine and we can run the application, however it seems weird to have to do this? Can somebody explain to me what is causing the solution to ask for 4.5 while we develop for 4.0?</p>\n"},{"tags":["c#",".net","excel","pdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13244674,"title":"PDF to excel conversion .net library","body":"<p>I am evaluating option for any open source library integration or commercial library which i can integrate in my application so that I can generate Excel document from my pdf.</p>\n\n<p>I have checked pdfsharp and itextsharp but doesn't find any working sample to do it.  In commercial i have checked investintech solution <a href=\"http://www.investintech.com/downloads/developer/developertools/pdftoexcel/\" rel=\"nofollow\">Link</a> but some pdf failed to convert to excel.</p>\n\n<p>Kindly help me in selecting the best available option\nthanks</p>\n"},{"tags":["c#","asp.net",".net","linq"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13211348,"title":"InsertOnSubmit - NullReferenceException","body":"<p>I have 2 models.</p>\n\n<p>AccountEntity</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Table(Name = \"Account\")]\n    public class AccountEntity\n    {\n        [Column(IsPrimaryKey = true, IsDbGenerated = true, AutoSync = AutoSync.OnInsert)]\n        public int id { get; set; }\n        [Column(CanBeNull = false, Name = \"email\")]\n        public string email { get; set; }\n        [Column(CanBeNull = false, Name = \"pwd\")]\n        public string pwd { get; set; }\n        [Column(CanBeNull = false, Name = \"row_guid\")]\n        public Guid guid { get; set; }\n\n        private EntitySet&lt;DetailsEntity&gt; details_id { get; set; }\n        [Association(Storage = \"details_id\", OtherKey = \"id\", ThisKey = \"id\")]\n        public ICollection&lt;DetailsEntity&gt; detailsCollection { get; set; }\n    }\n</code></pre>\n\n<p>DetailsEntity</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Table(Name = \"Details\")]\n\n    public class DetailsEntity\n    {\n    public DetailsEntity(AccountEntity a) {\n        this.Account = a;\n    }\n\n    [Column(IsPrimaryKey = true, IsDbGenerated = true, DbType = \"int\")]\n    public int id { get; set; }\n\n    private EntityRef&lt;AccountEntity&gt; _account = new EntityRef&lt;AccountEntity&gt;();\n    [Association(IsForeignKey = true, Storage = \"_account\", ThisKey = \"id\")]\n    public AccountEntity Account { get; set; }\n}\n</code></pre>\n\n<p>Main</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code> using (Database db = new Database())\n {\n     AccountEntity a = new AccountEntity();\n     a.email = \"hahaha\";\n     a.pwd = \"13212312\";\n     a.guid = Guid.NewGuid();\n     db.Account.InsertOnSubmit(a);\n     db.SubmitChanges();\n }\n</code></pre>\n\n<p>that has relationhip AccountEntity &lt;- DetailsEntity (1-n)</p>\n\n<p>when I'm trying to insert a record an exception is thrown(NullReferenceException)</p>\n\n<p>cause: by EntitySet null</p>\n\n<p>please help me make it insert</p>\n\n<hr>\n\n<p>I have found problem at</p>\n\n<p>private EntitySet details_id { get; set; } this is properties </p>\n\n<p>this must be new instance if has no ref</p>\n\n<p>private EntitySet details_id = new EntitySet();</p>\n"},{"tags":["c#",".net","pca"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":521,"score":3,"question_id":6844564,"title":"Principal Component Analysis in C#","body":"<p>It's pretty much all in the title: what library would you recommend to perform principal component analysis? I'm looking for free and simple to use - performance is not necessarily a criterion so far as I just want to play around with the concept and see what I get. Google got me this:</p>\n\n<p><a href=\"http://crsouza.blogspot.com/2009/09/principal-component-analysis-in-c.html\" rel=\"nofollow\">http://crsouza.blogspot.com/2009/09/principal-component-analysis-in-c.html</a></p>\n\n<p>Anyone tried this? How good is it? Would you have any other recommendation?</p>\n"},{"tags":[".net","c","winapi"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":31,"score":2,"question_id":13244584,"title":"Adding a new network interface tab/adapter?","body":"<p>How to add a new network interface adapter/tab via coding?\nlike VPN clients do...</p>\n"},{"tags":["c#",".net","iequalitycomparer"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":49,"score":3,"question_id":13244253,"title":"GetHashCode() for long primitive","body":"<p>I am writing a EqualityComparer for a LINQ distinct expression and I am not too sure about the GetHashCode overload method. Would the below code be correct? The Id property is a long primitive. </p>\n\n<pre><code>public int GetHashCode(Deal obj)\n{\n   return ((int)obj.Id) ^ ((int)(obj.Id &gt;&gt; 32)); ;\n}\n</code></pre>\n"},{"tags":["c#",".net","performance","linq"],"answer_count":5,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":229,"score":7,"question_id":8595258,"title":"Why the order of LINQ to objects methods counts","body":"<p>I read <a href=\"http://stackoverflow.com/questions/7499384/does-the-order-of-linq-functions-matter\">this</a> question's answers that explain the order of the LINQ to objects methods makes a difference. My question is why?</p>\n\n<p>If I write a LINQ to SQL query, it doesn't matter the order of the LINQ methods-<code>projections</code> for example:</p>\n\n<pre><code>session.Query&lt;Person&gt;().OrderBy(x =&gt; x.Id)\n                       .Where(x =&gt; x.Name == \"gdoron\")\n                       .ToList();\n</code></pre>\n\n<p>The expression tree will be transformed to a rational SQL like this:</p>\n\n<pre><code>  SELECT   * \n  FROM     Persons\n  WHERE    Name = 'gdoron'\n  ORDER BY Id; \n</code></pre>\n\n<p>When I Run the query, SQL query will built according to the expression tree no matter how weird the order of the methods.<br>\nWhy it doesn't work the same with <code>LINQ to objects</code>?<br>\nwhen I enumerate an <em>IQueryable</em> all the projections can be placed in a rational order(e.g. Order By after Where) just like the Data Base optimizer does.</p>\n"},{"tags":["c#",".net","multithreading"],"answer_count":8,"favorite_count":4,"up_vote_count":17,"down_vote_count":0,"view_count":284,"score":17,"question_id":13050695,"title":"guarantee that up-to-date value of variable is always visible to several threads on multi-processor system","body":"<p>I'm using such configuration:</p>\n\n<ul>\n<li>.NET framework 4.5</li>\n<li>Windows Server 2008 R2</li>\n<li>HP DL360p Gen8 (2 * Xeon E5-2640, x64)</li>\n</ul>\n\n<p>I have such field somewhere in my program:</p>\n\n<pre><code>protected int HedgeVolume;\n</code></pre>\n\n<p>I access this field from several threads. I assume that as I have multi-processor system it's possible that this threads are executing on different processors.</p>\n\n<p>What should I do to guarantee that any time I use this field the most recent value is \"read\"? And to make sure that when I \"write\" value it become available to all other threads immediately?</p>\n\n<p>What should I do?</p>\n\n<ul>\n<li>just leave field as is.</li>\n<li>declare it <code>volatile</code></li>\n<li>use <code>Interlocked</code> class to access the field</li>\n<li>use .NET 4.5 <code>Volatile.Read</code>, <code>Volatile.Write</code> methods to access the field</li>\n<li>use <code>lock</code></li>\n</ul>\n\n<p>I only need simplest way to make my program work on <strong>this configuration</strong> I don't need my program to work on another computers or servers or operation systems. Also I want <strong>minimal</strong> latency so I'm looking for <strong>fastest</strong> solution that will always work on <strong>this</strong> standard configuration (multiprocessor intel x64, .net 4.5).</p>\n"},{"tags":[".net","asp.net"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":335,"score":0,"question_id":2575127,"title":"simple blog engine for website","body":"<p>I know that there's a lot of free open source blog engine out there such as BlogEngine.NET. However that's an overkill for my purpose... I so far has created my own simple one by storing posts in a .xml file and so every time the main page loads it reads from all those xml files and displays it as posts.</p>\n\n<p>Now my problem is when a user clicks on a post title I want it to show on a new page(.aspx), so if the title is X then I want a new page called X.aspx when the user clicks on the title on the homepage. I hope this makes sense.</p>\n\n<p>My question is how do I create such thing?</p>\n"},{"tags":["c#",".net","datacontractserializer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13242825,"title":"DataContract deserializer with Dictionary","body":"<p>If i have an xml like:</p>\n\n<pre><code>&lt;Foo&gt;\n&lt;Bar&gt;\n    &lt;A&gt;aaaa&lt;/A&gt;\n    &lt;B&gt;bbb&lt;/B&gt;\n&lt;/Bar&gt;\n&lt;C&gt;ccc&lt;/C&gt;&lt;/Foo&gt;\n</code></pre>\n\n<p>Can I deserialize it into a Foo class with a dictionary structure and a string property like following  using the same DataContract Deserializer? With A and B as the keys and the \"aaaa\" and \"bbb\" as the Values in the dictionary? </p>\n\n<pre><code>[DataContract]\nclass Foo\n{\n\n  [DataMember]\n  public Dictionary&lt;string, string&gt; Bar\n  { get; set; }\n\n  [DataMember]\n  public string C { get; set; }\n}\n</code></pre>\n\n<p>I know there is an example using CollectionDataContract on MSDN site but it only uses the A as the key and B as the value.</p>\n"},{"tags":["c#",".net","wpf","prism"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13243572,"title":"Why does the following WPF Command not fire?","body":"<p>C# file:</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public DelegateCommand&lt;ICollection&lt;string&gt;&gt; TestCommand { get; set; }\n\n    public ICollection&lt;string&gt; TestParameter\n    {\n        get\n        {\n            List&lt;string&gt; lstParams = new List&lt;string&gt;() { \"test\", \"test2\", \"test3\" };\n            return lstParams;\n        }\n    }\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        TestCommand = new DelegateCommand&lt;ICollection&lt;string&gt;&gt;(TestMethod);\n    }\n\n    private void TestMethod(ICollection&lt;string&gt; param)\n    {\n        if (param != null)\n        {\n            lblTest.Content = \"Hit\";\n        }\n    }\n}\n</code></pre>\n\n<p>.XAML file</p>\n\n<pre><code>&lt;Window x:Class=\"WPFAttachedBehaviorTest.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:i=\"http://schemas.microsoft.com/expression/2010/interactivity\"\n    xmlns:local=\"clr-namespace:WPFAttachedBehaviorTest\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\" DataContext=\"{Binding RelativeSource={RelativeSource Mode=Self}}\"&gt;\n\n&lt;i:Interaction.Triggers&gt;\n    &lt;i:EventTrigger EventName=\"Loaded\"&gt;\n        &lt;i:InvokeCommandAction CommandParameter=\"{Binding Path=TestParameter}\" Command=\"{Binding Path=TestCommand}\" /&gt;\n    &lt;/i:EventTrigger&gt;\n&lt;/i:Interaction.Triggers&gt;\n&lt;Label x:Name=\"lblTest\"&gt;&lt;/Label&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>A break point on the TestParameter getter fires but TestMethod never fires. </p>\n\n<p>I don't see any binding errors in the Output window (on the contrary, if I deliberately mis-spell TestCommand2 it'll complain - so I guess this is correct)</p>\n\n<p>This is using the Prism DelegateCommand and the Expression Blend InvokeCommandAction behavior</p>\n"},{"tags":[".net","sql-server","sqlbulkcopy"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":954,"score":1,"question_id":4431273,"title":"SqlBulkCopy with different collations","body":"<p>I need to migrate data from one DB to another. I choosed to use SqlBulkCopy, but have a problem with it, because source database has different collation than destination, so, I've got an exception:</p>\n\n<pre><code>System.InvalidOperationException: The locale id '1049' of the source column 'Id' and the locale id '1033' of the destination column 'Id' do not match.\n   at System.Data.SqlClient.SqlBulkCopy.AnalyzeTargetAndCreateUpdateBulkCommand(BulkCopySimpleResultSet internalResults)\n   at System.Data.SqlClient.SqlBulkCopy.WriteToServerInternal()\n   at System.Data.SqlClient.SqlBulkCopy.WriteRowSourceToServer(Int32 columnCount)\n   at System.Data.SqlClient.SqlBulkCopy.WriteToServer(IDataReader reader)\n   at MigrateToNormalized.DirectMapCommand.Migrate(SqlConnection source, SqlConnection destination, SqlTransaction transaction) in D:\\Projects\\APS\\DTE\\MigrateTo\nNormalized\\MigrateToNormalized\\MigrateToNormalized\\DirectMapCommand.cs:line 53\n   at MigrateToNormalized.Program.Main(String[] args) in D:\\Projects\\APS\\DTE\\MigrateToNormalized\\MigrateToNormalized\\MigrateToNormalized\\Program.cs:line 32\n</code></pre>\n\n<p>Can anyone tell me, how to resolve this issue without direct usage of COLLATE statements in SQL query? Is there some easy way to change collation for all columns in source database?</p>\n"},{"tags":["c#","c++",".net","dll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13239246,"title":"System.DllNotFoundException in .NET DLL","body":"<p>I took a program written in C/C++ and modified it's main function to accept some arguments as input and return a variable as output and created a Win32 DLL out of it. I then created a .NET DLL which uses InterOp to access the first DLL. Now when I load the .NET DLL in my C# app I get a System.DllNotFoundException from the DLL which is really baffling me as there were never memory issues with the program and both Win32/.NET dlls are located in the same directory (apart from modifying the main function, the code has not really changed).\nThe solution was provided in <a href=\"http://stackoverflow.com/questions/9849278/create-mfc-dll-from-c-c-vs-2010-code-to-be-used-by-c-sharp-wcf-web-service\">this</a> thread, which was my original question some time ago. I'm pretty sure that answer is correct but I'm just missing something.</p>\n\n<p>You can download my VS solution <a href=\"https://dl.dropbox.com/u/3425260/LibClose.rar\" rel=\"nofollow\">Here</a>. The solution contains three projects: the Win32 DLL, the .NET DLL, and a winform app that references the .NET DLL (but when trying to test gives the DLL exception). Any help or debugging guidance would be greatly appreciated.</p>\n\n<ul>\n<li>UPDATE: I have tried all the tips/suggestions below but I still get the exact same error. If it makes things easier, my VS solution is available to download in the hyperlink above.</li>\n</ul>\n"},{"tags":["c#",".net","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":47,"score":-1,"question_id":13243060,"title":"Why is this RegEx.Replace failing, even though I'm matching the string?","body":"<p>Am I understanding how RegEx.Replace works in C#/.NET? I want this:</p>\n\n<blockquote>\n  <p>Test: String</p>\n</blockquote>\n\n<p>To become this:</p>\n\n<blockquote>\n  <p>Test String</p>\n</blockquote>\n\n<pre><code>var cleanString = Regex.Replace(\"Test: String\", @\"^[\\w\\*\\$][\\w\\s\\-\\$]*(\\(\\d{1,}\\)){0,1}$\", \"\");\n</code></pre>\n\n<p>Yet it cleanString evaluates to:</p>\n\n<blockquote>\n  <p>Test: String</p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n\n<p>EDIT: I'm getting a regex validation string from a third party source, so I can either use that regex validation string or somehow figure out the valid characters in the regex validation string, and loop through an invalid character array. This is why I chose to do regex, which I never usually use.</p>\n"},{"tags":[".net","windows-phone-7","audio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13157992,"title":"Audio distored and incomprehensible using Windows Phone MediaElement?","body":"<p>Incredibly strange one this evening, I am attempting to play an audio snippet in my Windows Phone game (Silverlight, not XNA), and the MP3 in question plays completely fine and clear through Windows Media Player or VLC, yet when I use the <code>MediaElement</code> (Silverlight) or <code>Song</code> or <code>SoundEffect</code> even using XNA it is garbled, quiet and incomprehensible? What could be the cause of this?</p>\n\n<p>I even tried re-saving it with Adobe Audition using a different bitrate, and a bunch of other variations, but to no avail.</p>\n\n<p>Here is the culprit MP3 in question: <a href=\"http://goneale.com/files/SO/YouDidIt.mp3\" rel=\"nofollow\">http://goneale.com/files/SO/YouDidIt.mp3</a></p>\n\n<p>If you could try using my mp3 with below code snippet and could determine what might be going on, that would be fantastic!</p>\n\n<pre><code>SoundTrigger.Source = new Uri(\"YouDidIt.mp3\", UriKind.Relative);\nSoundTrigger.Play();\n</code></pre>\n\n<p>then on the XAML surface:</p>\n\n<pre><code>&lt;MediaElement x:Name=\"SoundTrigger\" /&gt;\n</code></pre>\n\n<p>If it helps, this vocal snippet was recorded at home with Garage Band for mac.</p>\n\n<p>Something astonishing, and I just cannot believe it, is if I take a snippet of a music mp3 and insert it directly in the middle, the start of my voice on the mp3 is garbled, then the half second of perfect music plays, then resumes the garbled voice, how could this be?!</p>\n\n<p><strong>Update 2012-11-1: Ok, new very strange finding, when I plug the headphones into my Lumia 710 the sound plays perfectly fine?! But not through the speaker? The speaker is just hiss with a distored voice in the distance, this is a brand new phone, not even 2 weeks old, as I said it plays everything else perfectly fine and crystal clear. What could be going on?</strong></p>\n"},{"tags":["c#","asp.net",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13242808,"title":"Double an array size by altering its values in C#","body":"<p>I have a sting like so:</p>\n\n<pre><code>string searches = \"my test\";\n</code></pre>\n\n<p>And then I can break them into individual terms like so:</p>\n\n<pre><code>string[] split = searches.Split(new Char[] { ' ' });\n</code></pre>\n\n<p>This gives me:</p>\n\n<pre><code>[0] = \"my\"\n[1] = \"test\"\n</code></pre>\n\n<p>Is there any quick way to make the following:</p>\n\n<pre><code>[0] = \"my\"\n[1] = \"test\"\n[2] = \"my:\"\n[3] = \"test:\"\n[4] = \"my,\"\n[5] = \"test,\"\n</code></pre>\n\n<p>I need to double the search terms and append a \":\" to the end of the doubled set. What's the easiest and efficient way to do this?</p>\n"},{"tags":[".net","mysql","crystal-reports"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13242848,"title":"How To Connect Crystal Reports To MySQL via .NET","body":"<p>Okay, I've been pulling my hair out over this for several days now. I've got Crystal Reports going in both the Visual studio integrated solution and the stand alone version. I've got three different versions of MySQL's ODBC drivers installed. I've gone into the Administrator Tools >> Data Sources and added the connection details I don't know how many times. </p>\n\n<p>I've tried both the ODBC and ODE ADO methods in the wizard. In the options where it allows me to pick a data source, it doesn't show anything, even though I've triple-checked that I have in fact registered them. On the options that have me input credential info, I've used the exact info I've used previously in other programs, and it always says that it's unable to connect.</p>\n\n<p>I am using the root user in the connection credentials, and I have checked and double-checked that the user has every action possible allowed, and that the allowed hosts are set to wild card. I copy/pasted the connection string into another program and tried a generic query and it worked. I've looked at a bunch of different tutorials and none of them have worked (although I have noticed a trend on how they are all using outdated versions of Crystal Reports or the MySQL ODBC driver). </p>\n\n<p>I know that the generic question of \"What am I doing wrong\" is heavily discouraged here, but I'm at a point where I don't even know what the right questions are.</p>\n"},{"tags":["c#",".net","security","aes","rijndael"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13079150,"title":"Encrypt and Decrypt with Rijndael data too long","body":"<p>I'm trying to get this code to encrypt and decrypt but I keep getting data length too long when decrypting during the <code>.FlushFinalBlock()</code>.</p>\n\n<p>I'm not sure what I'm doing wrong here because I'm out of my element on this issue.</p>\n\n<p>Can anyone tell me what I'm doing wrong here? Encryption is OK, but it cannot decrypt its encryption.</p>\n\n<pre><code>   static byte[] u8_Salt = new byte[] { 0x26, 0x19, 0x81, 0x4E, 0xA0, 0x6D, 0x95, 0x34, 0x26, 0x75, 0x64, 0x05, 0xF6 };\n\n   public static string Encrypt(string data, string password)\n    {\n        //\n        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(password, u8_Salt);\n        //\n        Rijndael i_Alg = Rijndael.Create();\n        i_Alg.Padding = PaddingMode.None;\n        i_Alg.Key = pdb.GetBytes(32);\n        i_Alg.IV = pdb.GetBytes(16);\n        //\n        using (var cryptoProvider = new DESCryptoServiceProvider())\n        using (var memoryStream = new MemoryStream())\n        using (var cryptoStream = new CryptoStream(memoryStream, cryptoProvider.CreateEncryptor(), CryptoStreamMode.Write))\n        using (var writer = new StreamWriter(cryptoStream))\n        {\n            writer.Write(data);\n            writer.Flush();\n            cryptoStream.FlushFinalBlock();\n            writer.Flush();\n            return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n    public static string Decrypt(string data, string password)\n    {\n        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(password, u8_Salt);\n        //\n        Rijndael i_Alg = Rijndael.Create();\n        i_Alg.Padding = PaddingMode.None;\n        i_Alg.Key = pdb.GetBytes(32);\n        i_Alg.IV = pdb.GetBytes(16);\n        //\n        using (var cryptoProvider = new DESCryptoServiceProvider())\n        using (var memoryStream = new MemoryStream())\n        using (var cryptoStream = new CryptoStream(memoryStream, cryptoProvider.CreateDecryptor(), CryptoStreamMode.Write))\n        using (var writer = new StreamWriter(cryptoStream))\n        {\n            writer.Write(data);\n            writer.Flush();\n            cryptoStream.FlushFinalBlock();\n            writer.Flush();\n            return Convert.ToBase64String(memoryStream.GetBuffer(), 0, (int)memoryStream.Length);\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net","regex"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":92,"score":3,"question_id":13242328,"title":"Counting number of words in a text file","body":"<p>I'm trying to count the number of words from a text file, namely this, to start.</p>\n\n<blockquote>\n  <p>This is a test of the word count program. This is only a test. If your\n  program works successfully, you should calculate that there are 30\n  words in this file.</p>\n</blockquote>\n\n<p>I am using StreamReader to put everything from the file into a string, and then use the .Split method to get the number of individual words, but I keep getting the wrong value when I compile and run the program. </p>\n\n<pre><code>using System;\nusing System.IO;\n\nclass WordCounter\n{\n    static void Main()\n    {\n        string inFileName = null;\n\n        Console.WriteLine(\"Enter the name of the file to process:\");\n        inFileName = Console.ReadLine();\n\n        StreamReader sr = new StreamReader(inFileName);\n\n        int counter = 0;\n        string delim = \" ,.\";\n        string[] fields = null;\n        string line = null;\n\n        while(!sr.EndOfStream)\n        {\n            line = sr.ReadLine();\n        }\n\n\n\n        fields = line.Split(delim.ToCharArray());\n        for(int i = 0; i &lt; fields.Length; i++)\n        {\n            counter++;\n        }\n        sr.Close();\n        Console.WriteLine(\"The word count is {0}\", counter);\n    }\n} \n</code></pre>\n"},{"tags":[".net","webclient"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":10581595,"title":"How to ensure that webclient process error like they process 200","body":"<p>I asked a similar question there but for curl and webclient.</p>\n\n<p>I found the answer for curl:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/9062089/how-to-ensure-that-webclient-curl-process-503-error-like-they-process-200\">How to ensure that webclient/curl process 503 error like they process 200</a></p>\n\n<p>CURLOPT_FAILONERROR</p>\n\n<p>I want something like that but for webclient rather than for curl</p>\n"},{"tags":[".net","vb.net","ssrs-2008","ssrs-reports"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":63,"score":-1,"question_id":13241181,"title":"detect and Sum Year,Months and Days","body":"<p>i have my code below which works fine before,to display as years,months and days.so as the one below i sum it up to display as days only that i do some conversions.i face some minor problems in my code. my year display 330 instead of 365.if i type in 1 year it should display 365, 1 month should be 30..but if 34 days it should be display as 34, instead it display as 60days.anyone can figure it out how come i got this error im my code below.this my code in my report properties in ssrs 2008</p>\n\n<pre><code>Public Function ILength(length  As Integer ) As String\n\n           dim year As Integer=0\n           dim month As Integer=0\n           dim day  As Integer=0\n           dim sum  as integer\n\n\nif(length =0)\nReturn String.Empty\nend if\n\nif length &gt;= 366 then\nyear=cstr(Math.Floor (length/ 365.25)) \nlength =(length  Mod 365.25)\nlength =(year * 365)\nyear =cstr(length)\n\nend if\n\nif length&gt;31 Andalso length&lt;366  then\n\nmonth=cstr (Math.Floor(length/30.4375))\nlength=(length  Mod 30.4375)\nlength=(month * 30)\nmonth=cstr(length)\n\nend if\n\nif length&lt;31 Then\nday =cstr(length) \nend if\n\nif length = 0 then\nReturn String.Empty\nend if\n\nsum= ((year)+(month)+(day))\n\nreturn(sum)\n\nEnd Function\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","asp.net-mvc"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13242114,"title":"Cannot access to User.Identity under OnActionExecuting(ActionExecutingContext filterContext)","body":"<p>I am not sure what do I am missing but I really cannot refer to \n <code>User.Identity</code> under <code>OnActionExecuting(ActionExecutingContext filterContext)</code></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.Mvc;\nusing System.Web.Security;\nusing System.Web.Routing;\n\n.....\n\n    public class RealUserAttribute : ActionFilterAttribute\n    {\n            public override void OnActionExecuting(ActionExecutingContext filterContext)\n            {\n                 /// if (User.Identity.IsAuthenticated)\n</code></pre>\n\n<p>Any clue how to fix it?</p>\n\n<p>Thank you!</p>\n"},{"tags":[".net","vb.net",".net-1.1"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":211,"score":1,"question_id":1827999,"title":"How do I access a string(index) in .Net 1.1?","body":"<p>I have converted this existing C# .NET 2.0 code (which appears to take in a string with any characters and return only the numbers in that string):</p>\n\n<pre><code>    private static string StripMIN(string min)\n    {\n        string result = string.Empty;\n        int digit = 0;\n        for (int i = 0; i &lt; min.Length; i++)\n        {\n            if (int.TryParse(min[i].ToString(), out digit) == true)\n            {\n                result += min[i];\n            }\n        }\n        return result;\n    }\n</code></pre>\n\n<p>to this VB.Net .Net 1.1 code:</p>\n\n<pre><code>    Private Function StripMIN(ByVal min As String) As String\n        Dim result As String = String.Empty\n        Dim digit As Integer = 0\n        Dim i As Integer = 0\n        While i &lt; min.Length\n            Me.SystemMessages.Text = \"Char at \" + i + \" : \" + min(i)\n            If TryParseInteger(min(i).ToString(), digit) = True Then\n                result += min(i)\n            End If\n            System.Math.Max(System.Threading.Interlocked.Increment(i), i - 1)\n        End While\n        Return result\n    End Function\n</code></pre>\n\n<p>I am getting an error message on line 6 of the VB.Net code at <code>min(i)</code>.  The error message reads:</p>\n\n<pre><code>\"Expression is not an array or a method, and cannot have an argument list\"\n</code></pre>\n\n<p>I am not very well versed in .Net 1.1 and cannot find an alternative solution to solving this error.  Does anybody have any suggestions on how I can access each character of this string and verify that its a number and return only the numbers of the string in .Net 1.1?</p>\n"},{"tags":["c#",".net","linq","linq-to-sql","ado.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":13087823,"title":"Attach newly created element in LINQ for deleting","body":"<p>I have a grid and dataset object connected with it.\nAnd datalayer working with LINQ. So I need to delete elements that was deleted in grid from LINQ data source.</p>\n\n<p>I have a method that convert my DataRow item to LINQ item. For example:</p>\n\n<pre><code>DataRow forDelete = ...;\nLinqItem itemForDelete = ConvertFromDataRow(forDelete);\ndataContext.DeleteOnSubmit(itemForDelete);\n</code></pre>\n\n<p>this code throw an exception, that imposible to delete item who is not attached to table.\nBut if I change it to</p>\n\n<pre><code>DataRow forDelete = ...;\nLinqItem itemForDelete = ConvertFromDataRow(forDelete);\ndataContext.Attach(itemForDelete)\ndataContext.DeleteOnSubmit(itemForDelete);\n</code></pre>\n\n<p>than it will throw exception that it's impossible to attach item, which already exist.</p>\n\n<p><strong>Question will be how to attach an item properly in that case. That should solve the problem.</strong></p>\n"},{"tags":[".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":22,"score":-1,"question_id":13240448,"title":"The Equivalent Control to \"asp:label\" in Current VB.NET 2012 MVC4?","body":"<p>My background has been PHP with MySQL - and I do think I may be looking for an \"echo\" equivalent.</p>\n\n<p>The intention is to have a <code>text field</code>, and then have the <code>submitted text</code> printed on the screen with e.g. <code>IsPostBack</code> and <code>on page load</code>.</p>\n\n<p>The question is directed at the control <code>asp:label</code> to know what is used to have the equivalent function in VB.NET 2012.</p>\n\n<p><strong>Differently formulated to specify what is intended:</strong></p>\n\n<p>Basically, have the text submitted through the \"textbox\" and have it printed on the screen after \"page load\", perhaps \"on page load\". And then continue you further, by having the text saved in the database. (The first steps of a blog application.)</p>\n"},{"tags":[".net","sql","frameworks"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":56,"score":0,"question_id":13240513,"title":"Value of Developing a SQL Framework Similar to .NET","body":"<p>With the widespread support of Microsoft's .NET Framework for C#, Visual Basic, F#, PowerShell, etc.., I've been wondering why there hasn't been any similar database development frameworks created (I haven't been able to find any at least).</p>\n\n<p>This lead me to consider developing my own framework, but I can't help but think that if it there was a significant need for something like this, that surely someone would have started a project like this already, either commercially or as an open source project.</p>\n\n<p>My preliminary thoughts about the technical aspects are:</p>\n\n<ul>\n<li>The framework would be modeled after the Microsoft .NET Framework as much as possible. Personally, I'm somewhat biased towards .NET &amp; T-SQL, but I think that by providing similar functionality to .NET would help ease the learning curve for new developers too.</li>\n<li>There would be an installer of some type with the option to deploy the framework objects in a separate, dedicated database, or include the objects in another database's schema. Also, with an option to simply generate the scripts to create the objects.</li>\n<li>Ability to select which objects to install (similar to how jQuery UI lets you choose which components you want in your <a href=\"http://jqueryui.com/download/\" rel=\"nofollow\">custom download package</a>) to keep databases from becoming bloated.</li>\n<li>Support for strict ANSI SQL, as well as vendor-specific versions (e.g. SQL Server, Oracle, MySQL).</li>\n</ul>\n\n<p>I guess what I'm really looking for is:</p>\n\n<ol>\n<li>Has anyone has come across anything like this that has already been developed?  </li>\n<li>Do you have any pertinent insight as to why this would be good or bad idea, either generally speaking or in regards to the things I mentioned here?</li>\n</ol>\n\n<p><strong>Edit</strong></p>\n\n<p>Basically, I'm envisioning the framework as providing a common set of helper functions/procedures, tally/number tables, etc...</p>\n\n<p>A prime example would be a function to format a date into a string that could be used with SQL Server pre-2012 versions (SQL Server 2012 introduced this as a built-in function).</p>\n\n<p>And, by framework, I'm thinking along the lines of development within the database (i.e. programming functions, stored procedures, ad-hoc scripts, etc...) vs. interacting with or connecting to the database externally (e.g. Ling2Sql, ORM's).</p>\n"},{"tags":[".net","vb.net","multithreading","gui","controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13237811,"title":"Control as parameter on delegate method","body":"<p>I wasn't sure on how to approach the title for this question, so I'll describe my situation hoping I'm being clear about my doubts. (If there's a better suggestion for the title, I'll change it)</p>\n\n<p>For the last few days I've reading around about multithreading and GUI controls modification using that scenario.\nMy question concerns with passing the control to be changed as a parameter of my delegate and method.\nLet's say I have a ListView1 and I want to add a group to it (it's a simple experience and has few code)</p>\n\n<p>According to examples I've seen, the way to do it would be</p>\n\n<pre><code>Private Delegate Sub ResultsAddGroup_Delegate(ByVal FondsGroup As ListViewGroup)\n\nPrivate Sub ResultsAddGroup(ByVal FondsGroup As ListViewGroup)\n    If Me.ListView1.InvokeRequired Then\n        Dim d As New ResultsAddGroup_Delegate(AddressOf ResultsAddGroup)\n        Dim ParamArgs() As Object = New Object() {FondsGroup}\n        Me.ListView1.BeginInvoke(d, ParamArgs)\n    Else\n        Me.ListView1.Groups.Add(FondsGroup)\n    End If\nEnd Sub\n</code></pre>\n\n<p>I usually like to pass the control as a parameter in order to keep the code clear and the methods or functions away from the specific control objects.\nIf I wanted to pass the ListView as a parameter for the above case, like this:</p>\n\n<pre><code>Private Delegate Sub ResultsAddGroup_Delegate(ByVal LView As ListView, ByVal FondsGroup As ListViewGroup)\n\nPrivate Sub ResultsAddGroup(ByVal LView As ListView, ByVal FondsGroup As ListViewGroup)\n    If LView.InvokeRequired Then\n        Dim d As New ResultsAddGroup_Delegate(AddressOf ResultsAddGroup)\n        Dim ParamArgs() As Object = New Object() {LView, FondsGroup}\n        LView.BeginInvoke(d, ParamArgs)\n    Else\n        LView.Groups.Add(FondsGroup)\n    End If\nEnd Sub\n</code></pre>\n\n<p>Would that represent any kind of problem for multithreading and control changing purposes?\nIf so, is there another way to do this without specifying the control?</p>\n\n<p>On another note, is there any problem with the way I usually do my methods (as described above, with passing the control as parameter)?</p>\n\n<p>Thanks </p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13237563,"title":"How to databind the tooltip to part of a user control?","body":"<p>I know this question has been asked many times before, I have found a few solutions here on line, but I could not make any of them work. I have a few elements on a custom control I have, and I want to put a bound tool tip on one of them. This is what I have so far.</p>\n\n<pre><code>&lt;UserControl x:Class=\"DirectGraphicsControl.ColorBarView\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" \n         xmlns:DirectGraphicsControl=\"clr-namespace:Windows.DirectGraphicsControl\" mc:Ignorable=\"d\" \n         SizeChanged=\"UserControlSizeChanged\" MinWidth=\"95\"&gt;\n&lt;DockPanel LastChildFill=\"True\" Width=\"80\" x:Name=\"_mainDockPanel\"&gt;\n    &lt;TextBlock DockPanel.Dock=\"Top\" x:Name=\"_title\" x:FieldModifier=\"public\" HorizontalAlignment=\"Center\" Margin=\"0,2,0,2\"/&gt;\n    &lt;StackPanel Orientation=\"Vertical\" DockPanel.Dock=\"Bottom\" Margin=\"0,2,0,2\"\n                    x:Name=\"_bottomLabelsRegion\" x:FieldModifier=\"public\"&gt;\n        &lt;TextBlock x:Name=\"_unitName\" x:FieldModifier=\"public\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Bottom\"/&gt;\n    &lt;/StackPanel&gt;\n    &lt;Grid DataContext=\"{Binding ElementName=_mainDockPanel.Parent, Path=MyTooltip}\" &gt;\n        &lt;DirectGraphicsControl:DirectGraphicsControl x:Name=\"_directGraphicsControl\"\n                                                     MouseDoubleClick=\"HandleColorBarMouseDoubleClick\" x:FieldModifier=\"public\"&gt;\n            &lt;DirectGraphicsControl:DirectGraphicsControl.ToolTip&gt;\n                &lt;ToolTip Content=\"{Binding Path=PlacementTarget.DataContext, \n                                   RelativeSource={RelativeSource Self}}\"/&gt;\n            &lt;/DirectGraphicsControl:DirectGraphicsControl.ToolTip&gt;\n        &lt;/DirectGraphicsControl:DirectGraphicsControl&gt;\n    &lt;/Grid&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p></p>\n\n<p>and this is the code behind.</p>\n\n<pre><code>/// &lt;summary&gt;\n    /// The tool tip text\n    /// &lt;/summary&gt;\n    public static readonly DependencyProperty TooltipProperty =\n        DependencyProperty.Register(Reflection.GetPropertyName&lt;ColorBarView&gt;(m =&gt; m.MyTooltip),\n                                    typeof(string), typeof(ColorBarView));\n\n    /// &lt;summary&gt;\n    /// The tool tip text\n    /// &lt;/summary&gt;\n    public string MyTooltip\n    {\n        get { return \"Test from binding\"; }\n    }\n</code></pre>\n\n<p>The code behind property is only returning a hard coded string for now until I can actually get it working and then it will return the calculated value I would like it to. Currently on mouse over an empty box appears. When I add the text for the tooltip straight to the xaml it shows fine. This makes me think it cannot find the location of the binding.</p>\n\n<p>I am very new to wpf so any suggestions would be great.</p>\n\n<p>Thank you,</p>\n"},{"tags":[".net","debugging","windows-services","structuremap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":391,"score":1,"question_id":9623409,"title":"What is Win32 error 0n2 and why is it preventing my app from running?","body":"<p>I have a Windows service written in C#/.NET, compiled to AnyCPU, that dies on startup apparently while trying to initialize StructureMap.  I've used Debug Diagnostics v1.2 to get the following stacktrace out of the memory dump:</p>\n\n<pre><code>System.RuntimeTypeHandle.CreateInstance(System.RuntimeType, Boolean, Boolean, Boolean ByRef, System.RuntimeMethodHandleInternal ByRef, Boolean ByRef) \nSystem.RuntimeType.CreateInstanceSlow(Boolean, Boolean, Boolean)Unable to load image C:\\Windows\\assembly\\NativeImages_v4.0.30319_64\\mscorlib\\b10e2a4a87b27f241113ead9433e25da\\mscorlib.ni.dll, Win32 error 0n2 \nSystem.RuntimeType.CreateInstanceDefaultCtor(Boolean, Boolean, Boolean, Boolean) \nSystem.Activator.CreateInstance[[System.__Canon, mscorlib]]() \nStructureMap.ConfigurationExpression.AddRegistry[[System.__Canon, mscorlib]]()*** ERROR: Module load completed but symbols could not be loaded for StructureMap.dll \nStructureMap.ObjectFactory.Initialize(System.Action`1) \n</code></pre>\n\n<p>The second line is actually the one of interest to me.  That file is present on my machine.  Where should I look next for how to debug this service and get it running?</p>\n\n<p>For what it's worth, I've got a unit test that validates that the StructureMap configuration is correct, and it successfully passes.</p>\n"},{"tags":["c#","asp.net",".net","entity-framework-4"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13240242,"title":"How to dispose object context in repository pattern","body":"<p>I implemented a repository pattern to my application dat .</p>\n\n<p>I have :</p>\n\n<pre><code>public class EFRepository\n{\n    DbContext // My db context\n\n    public IQureable&lt;T&gt; GetQuery()\n    {\n        // Get IQuearable\n    }\n}\n</code></pre>\n\n<p>my problem is how to release the <code>DbContext</code> when I use the EF repository in derived repositories. \nLets say : <code>OrdersRepositories : EFRepository</code> , and it uses the <code>GetQuery</code> then I have to dispose the context.</p>\n\n<p>Any good idea how to make this in generic repository?</p>\n"},{"tags":[".net","entity-framework","postgresql","ado.net"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":5721,"score":3,"question_id":1576067,"title":"Entity Framework ObjectContext -> raw SQL calls to native DBMS","body":"<p>I have an app using the ADO.NET entity framework (the VS2008 version, not the newer, cooler one) and I need to be able to make a call down to the underlying DBMS (it's postgres) in order to call some SQL that Entity Framework doesn't support. </p>\n\n<p>Is there a way to go from an Entity Framework ObjectContext to something that will let me execute raw SQL? (I need to run a TRUNCATE TABLE before inserting)  I'm OK with a hacky solution (e.g. pull out the DBMS's connection string info from EF, and use that to create a connection using the postgres ADO.NET provider) but don't want to manage two sets of connection strings (one for entity framework, one for ADO.NET).</p>\n\n<p>I'm aware of the limitatons of Entity Framework's first version, but it's not worth the investment required to switch this app to another ORM, and using EF 4.0 isn't an option either.</p>\n\n<p>Any ideas?</p>\n\n<p>BTW, this is the same question as <a href=\"http://stackoverflow.com/questions/915329/is-it-possible-to-run-native-sql-with-entity-framework\">http://stackoverflow.com/questions/915329/is-it-possible-to-run-native-sql-with-entity-framework</a>, but the workaround described in that answer won't work for me since I really do need to execute raw SQL.</p>\n"},{"tags":[".net","python"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":335,"score":3,"question_id":6333044,"title":"Using C# Assemblies from Python via pythonnet","body":"<p>I am using Windows 7, 64-bit. I have managed to download and install pythonnet, so</p>\n\n<pre><code>import clr\nclr.AddReference(\"System.Windows.Forms\")\nfrom System.Windows.Forms import Form\n</code></pre>\n\n<p>works fine. I have also downloaded and compiled/run a C# application which creates lots of assemblies. The application in question is ARDrone-Control-.NET.</p>\n\n<p>How can I use the generated DLL files from Python (and not just the built-in C# classes).</p>\n\n<p>Since I have never used C# (which is why I want to use the library from Python), I'd be happy to clarify the question.</p>\n"},{"tags":[".net","configuration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12771928,"title":"App config different project best practice","body":"<p>By default the app.config that gets loaded is the one in the project that contains the entry point to the application. </p>\n\n<p>Now the data access code cares about the RDBMS (Oracle, SQL etc). If I store the connection string in the DAL project instead of the start up project, it would remove the dependency between the DAL and the start up project. But from experience I know that the connection string is always stored in the start up project.</p>\n\n<p>Whats the recommended project (start up of data access layer) to store the connection string? If it is the start up project, is the resulting dependency between the start up and DAL acceptable?</p>\n"},{"tags":["c#",".net","datetime","const","immutable"],"answer_count":1,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":71,"score":7,"question_id":13239668,"title":"How to make a DateTime object immutable (declare as const) in C#?","body":"<p>I have attempted the following code which will not work</p>\n\n<pre><code>private const DateTime newDateTime = new DateTime(1,1,1,1,1,1);\n</code></pre>\n\n<p>to which the compiler states \"DateTime variable cannot be declared as const\".</p>\n\n<p>I am wondering how to make this object immutable, as i do not want to be able to change it anywhere by mistake.  This value will be used as a check value to compare other DateTime objects to.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["c#",".net","sql","c#-4.0","ado.net"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13240854,"title":"SCOPE_INDENTITY() not working is it returning null?","body":"<p>Having read around this site I thought the following code would return the ID of the item  I add to my database but the int value I am trying to fill isn't showing up in scope. Here is the code for my insert statement:</p>\n\n<pre><code>  foreach (ExOb exc in exobject)\n            {\n\n                Type type = exc.GetType();\n                //Add a weight exercise\n                if (type == typeof(Weights))\n                {\n\n                    Weights thisweight = (Weights)exc;\n                    string InsertWeight = (\"INSERT INTO WeightExercise (ExcerciseName, Duration, Sets, DiaryId) VALUES (@name, @time, @sets, @DiaryId) SET @ID = SCOPE_IDENTITY();\");\n\n                        com = new SqlCommand(InsertWeight, con);\n                        com.Parameters.AddWithValue(\"@name\", thisweight.ExcerciseName);\n                        com.Parameters.AddWithValue(\"@time\", thisweight.WeightDuration);\n                        com.Parameters.AddWithValue(\"@sets\", thisweight.TotalSets);\n                        com.Parameters.AddWithValue(\"@DiaryId\", results[0]);\n                        com.Parameters.Add(\"@ID\", SqlDbType.Int, 4).Direction = ParameterDirection.Output;\n                        con.Open();\n                        com.ExecuteNonQuery();\n                        int ID = (int)com.Parameters[\"@ID\"].Value;\n\n                        con.Close();\n\n\n                }\n                else if (type == typeof(Cardio))\n                {\n                    Cardio thiscardio = (Cardio)exc;\n\n\n                }\n\n            }\n        }\n</code></pre>\n\n<p>The database is updated with the Weight Exercise details. I have checked when debugging and the command parameter @ID holds the ID of the latest entry. Int ID does not show up in locals when debugging and if I Watch it I get:</p>\n\n<pre><code>    ID  The name 'ID' does not exist in the current context \n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":[".net","sql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13240728,"title":"JS to SQL datetime","body":"<p>I am passing from the client a date time that looks something like this...</p>\n\n<p>\"Mon Nov 05 2012 21:27:58 GMT+0000 (GMT Standard Time)\"</p>\n\n<p>I want to save this into a sql datetime field while retaining as much of the date data as possible.</p>\n\n<p>At the moment I'm doing a conversion like this in the .net backend before I save the datetime to the database....</p>\n\n<pre><code>DateTime.ParseExact(date.Substring(0, 24),\n                             \"ddd MMM d yyyy HH:mm:ss\",\n                             CultureInfo.InvariantCulture);\n</code></pre>\n\n<p>This loses the GMT part. </p>\n\n<p>Is there a way that I can keep it in a ParseExact that will be suitable for SQL?</p>\n"},{"tags":["c#",".net","asp.net","culture"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1722,"score":3,"question_id":480425,"title":"ASP.Net Validating Culture Names","body":"<p>We have a multilingual site that utilizes asp.net 2.0 cultures.  The current culture is set through the url rewritten as a query string.  (~/es/blah.aspx is the spanish version of ~/blah.aspx - rewritten as ~/blah.aspx?lang=es)</p>\n\n<p>The code that tests the culture is as follows:</p>\n\n<pre><code>    System.Globalization.CultureInfo ci;\n    try\n    {\n        ci = new System.Globalization.CultureInfo(Request.QueryString[\"lang\"] ?? string.Empty);\n    }\n    catch\n    {\n        ci = new System.Globalization.CultureInfo(string.Empty);\n    }\n</code></pre>\n\n<p>If there is no culture set, it defaults to english, 127.  When there is a culture, all links on that page are then pre-pended with the correct culture name.</p>\n\n<p>Some how or another a spider got a hold of a few links in the form of ~/www.test.com/blah.aspx and is hammering our site with a culture of www.test.com which and flooding our error logging.</p>\n\n<p>Is there any way to test whether a culture name is valid besides catching an exception?</p>\n"},{"tags":[".net","powershell","environment","windows-explorer"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":31,"score":4,"question_id":13240672,"title":"How to choose the right \"network place\" icon?","body":"<p>I've got a PowerShell script that creates shortcuts to network locations at login. Unfortunately, it's using an old low-res icon. It's not a big deal by any means, but I'd like to use the updated icons in later versions of Windows.</p>\n\n<p>Here's the relevant portion of the function that creates the shortcut:</p>\n\n<pre><code># Create the shortcut file\n\n$shortcut = (New-Object -ComObject WScript.Shell).Createshortcut(\"$shortcutFolder\\target.lnk\")\n\n$shortcut.TargetPath = $targetPath\nif (\n$shortcut.IconLocation = \"%SystemRoot%\\system32\\SHELL32.DLL, 275\"\n$shortcut.Description = $targetPath\n$shortcut.WorkingDirectory = $targetPath\n$shortcut.Save()\n\n# Set attributes on the files &amp; folders\n$desktopIni | Set-ItemProperty -Name Attributes -Value ([IO.FileAttributes]::System -bxor [IO.FileAttributes]::Hidden)\n$shortcutFolder | Set-ItemProperty -Name Attributes -Value ([IO.FileAttributes]::ReadOnly)\n</code></pre>\n\n<p>As you can see, it's currently using Icon #275 in the SHELL32.DLL library. In Windows 7, the \"proper\" icon would be Icon #143 in imageres.dll. Is there any way to get the icon details from the OS like getting a reference to a Special folder in the Explorer namespace?</p>\n"},{"tags":[".net","visual-studio"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":90,"score":3,"question_id":13153262,"title":"Visual Studio 2012 Express and .NET 2.0","body":"<p>My installation of VS 2012 Express doesn't show .NET Framework 2.0 when I create a new project. I know that 2.0 is supported on VS 2012 but it doesn't show up in the menu as shown below.</p>\n\n<p><img src=\"http://i.stack.imgur.com/9dcEe.png\" alt=\"New Project Screenshot\"> </p>\n\n<p>When I create a project with one of the available options (4.0/4.5) and then change it back to 2.0, it gives loads of errors on build.</p>\n\n<p>Is there any way to make VS 2012 to show older versions in the menu?</p>\n"},{"tags":["c#",".net","silverlight"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":822,"score":2,"question_id":4024267,"title":"Saving Files in silverlight and asynchronous call backs","body":"<p>In Silverlight you have to save a file using the save file dialog.</p>\n\n<p>You can only open this dialog from a user event aka a button click</p>\n\n<p>I’m returning the data of a file from a web service call asynchronously</p>\n\n<p>How do i save this to file?</p>\n\n<p>If i ask them before the service call i can’t use the stream after the data comes back.</p>\n\n<p>If i ask them after i can’t open the save file dialogue.</p>\n\n<p>It’s a bit of chicken and the egg situation.</p>\n\n<p>Thanks.</p>\n\n<p><strong>update</strong></p>\n\n<p>i want to be able to save the users computer where they spectifiy not the silverlight isolated storage.</p>\n"},{"tags":[".net","visual-studio-2010","app-config"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":11684940,"title":"Is it possible for <appSettings /> to contain settings AND refer to another <appSettings /> section in a different file?","body":"<p>Is it possible for me to have an <code>&lt;appSettings /&gt;</code> section in my app.config which contains a number of settings, but which also references an <code>&lt;appSettings /&gt;</code> section in a different file?</p>\n\n<p>This would allow me to keep config options that only the developer should be interested in, e.g. options to show debug output on the main window (very messy but useful to me) or to save certain files to specific locations.</p>\n\n<p>Specifically, this is what I'm trying to achieve:</p>\n\n<pre><code>&lt;!-- this is the appSettings section of the normal app.config file,\n     which also contains everything else that app.config would --&gt;\n&lt;appSettings configSource=\"AppSettings.config\"&gt; &lt;!-- references another file --&gt;\n  &lt;add key=\"deployment_config_option1\" value=\"1\"/&gt;\n  &lt;add key=\"deployment_config_option2\" value=\"2\"/&gt;\n&lt;/appSettings&gt;\n\n&lt;!-- this a new appSettings section of another file called DevSettings.Config\n     which only contains settings us developers are interested in\n     by keeping these settings in a different file, \n     I can ensure it's never deployed --&gt;\n&lt;appSettings&gt; &lt;!-- references another file --&gt;\n  &lt;add key=\"show_debug_on_screen\" value=\"true\"/&gt;\n  &lt;add key=\"save_copy_to_desktop\" value=\"false\"/&gt;\n&lt;/appSettings&gt;\n</code></pre>\n"},{"tags":["c#",".net","silverlight-3.0"],"answer_count":7,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":19268,"score":12,"question_id":1355078,"title":"\"Dialogs must be user-initiated.\" with SaveFileDialog in Silverlight 3","body":"<p>I am working on a Silverlight 3 app with C#. I would like to allow the user to download an image from the Silverlight app. I am using SaveFileDialog to perform the file download task. The flow goes this way:</p>\n\n<ol>\n<li>User clicks on Download button in the SL app.  </li>\n<li>Web service call invoked to get the image from server  </li>\n<li>OnCompleted async event handler of the web method call get invoked and receives the binary image from the server  </li>\n<li>Within the OnCompleted event handler, SaveFileDialog prompted to user for saving the image to computer.  </li>\n<li>Stream the image to the file on user's harddrive.  </li>\n</ol>\n\n<p>I am using the following code in a function which is called from the OnCompleted event handler to accomplish SaveFileDialog prompt and then streaming to file.</p>\n\n<pre><code>            SaveFileDialog dialog = new SaveFileDialog();\n            dialog.Filter = \"JPG Files|*.jpg\" + \"|All Files|*.*\";\n            bool? dialogResult = dialog.ShowDialog();\n\n            if (dialogResult == true)\n            {\n                using (Stream fs = (Stream)dialog.OpenFile())\n                {\n                    fs.Write(e.Result, 0, e.Result.Length);\n                    fs.Close();\n                }\n            }\n</code></pre>\n\n<p>The SaveFileDialog would throw the error \"Dialogs must be user-initiated.\" when invoking ShowDialog method in the above code. What could i be missing here? How to overcome this?</p>\n"},{"tags":[".net","saml","saml-2.0"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":12626548,"title":"Building a SAML IdP","body":"<p>I've been tasked with building out a SSO solution based on SAML 2.0.  In this scenario we will be the IdP.  Having no prior experience with SAML, I've been reading up on it a bit.  What are my available options for building the IdP functionality in a .NET environment?  Would a simple WCF service suffice?  Are there good solutions pre-built?</p>\n\n<p><strong>Note:</strong> Our user store is <strong>not</strong> Active Directory.  It's a home-grown database solution.   So I'll need to be able to integrate my own authentication logic.  Also, our current environment is .NET 2 through 4, 4.5 may be available by the time this rolls if that changes anything.</p>\n\n<p>Any pointers would be appreciated.</p>\n\n<p><strong>EDIT:</strong> While I look into ComponentSpace, would Microsoft's Geneva framework be appropriate? Is it even still alive (most references I see to it are from 2008-09)?</p>\n"},{"tags":["c#",".net","datagridview"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1033,"score":1,"question_id":6092463,"title":"How can I manually add data to a dataGridView?","body":"<p>I'm trying to run this code, and I get an exception:</p>\n\n<blockquote>\n  <p>Index was out of range. Must be\n  non-negative and less than the size of\n  the collection. Parameter name: index</p>\n</blockquote>\n\n<pre><code>private void LoadStudentGrades(int gradeParaleloId, int subjectId)\n{\n    GradeStudentRepository gradeStudentRepo = new GradeStudentRepository();\n    students = gradeStudentRepo.FindAllGradeStudents().Where(g =&gt; g.GradeParaleloId == gradeParaleloId)\n                .Select(g =&gt; g.Student);\n\n    int i = 1;\n    foreach (var student in students)\n    {\n        DataGridViewRow row = new DataGridViewRow();\n\n        row.Cells[0].Value = i.ToString();\n        row.Cells[1].Value = student.LastNameFather + \" \" + student.LastNameMother + \", \" + student.Name;\n\n        dataGridView1.Rows.Add(row);\n        i++;\n    }\n}\n</code></pre>\n\n<p>I manually created the columns in the datagridview, and now I would like to populate the fields using this small method.</p>\n"},{"tags":[".net","c#-4.0","maf","system.addin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13202164,"title":"MAF (System.AddIn) Property which is a Collection","body":"<p>I am attempting to write a MAF AddIn using the .NET4 System.AddIn namespaces.  The AddIn has a property that is a collection of a custom type called 'ReportParameters'; there are other properties on the AddIn which are native types contained in mscorlib (ie: ints, bools, strings, etc) that I have ommited from the code snippets below because they work fine. I am struggling with the Host and AddIn side adapters that convert ReportParameters IListContract to an IList and vice versa. Any help would be appreciated.  My pipeline is currently defined as follows (see comments in Host Adapter): </p>\n\n<p><strong>Contract Assembly</strong></p>\n\n<pre><code>[AddInContract]\npublic interface IReportComponentContract: IContract\n{\n    IListContract&lt;IReportParameterContract&gt; ReportParameters { get; set; }\n    bool GenerateReport();\n}\n\npublic interface IReportParameterContract: IContract\n{\n    string Name { get; set; }\n    string Value { get; set; }\n}\n</code></pre>\n\n<p><strong>AddIn View Assembly</strong></p>\n\n<pre><code>[AddInBase]\npublic interface IReportComponent\n{\n    IList&lt;IReportParameter&gt; ReportParameters { get; set;}\n    bool GenerateReport();\n}\n\npublic interface IReportParameter\n{\n    string Name { get; set; }\n    string Value { get; set; }\n}\n\npublic class ReportParameter : IReportParameter\n{\n    public string Name\n    {\n        get;\n        set;\n    }\n\n    public string Value\n    {\n        get;\n        set;\n    }\n}\n</code></pre>\n\n<p><strong>AddIn Host Adapter Assembly</strong></p>\n\n<pre><code>[AddInAdapter]\npublic class ReportComponentViewToContractAddInAdapter: ContractBase, IReportComponentContract\n{\n    IReportComponent_view;\n\n    public ReportComponentViewToContractAddInAdapter(IReportComponent view)\n    { \n        _view = view;\n    }\n\n    public IListContract&lt;IReportParameterContract&gt; ReportParameters\n    {\n        get\n        {\n            return CollectionAdapters.ToIListContract&lt;IReportParameter, IReportParameterContract&gt;(_view.ReportParameters, ReportParameterAddInAdapter.ViewToContractAdapter, ReportParameterAddInAdapter.ContractToViewAdapter); \n        }\n        set\n        {\n            _view.ReportParameters = CollectionAdapters.ToIList&lt;IReportParameterContract, IReportParameter&gt;(value, ReportParameterAddInAdapter.ContractToViewAdapter, ReportParameterAddInAdapter.ViewToContractAdapter); \n        }\n    }\n\n    public bool GenerateReport()\n    {\n        return _view.GenerateReport();\n    }\n\n    internal IReportComponent GetSourceView()\n    {\n        return _view;\n    }\n}\n\npublic class ReportParameterAddInAdapter\n{\n    internal static IReportParameter ContractToViewAdapter(IReportParameterContract contract)\n    {\n        if (!System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(contract) &amp;&amp;\n            (contract.GetType().Equals(typeof(ReportParameterViewToContractAddInAdapter))))\n        {\n            return ((ReportParameterViewToContractAddInAdapter)(contract)).GetSourceView();\n        }\n        else\n        {\n            return new ReportParameterContractToViewAddInAdapter(contract);\n        }\n    }\n\n    internal static IReportParameterContract ViewToContractAdapter(IReportParameter view)\n    {\n        if (!System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(view) &amp;&amp;\n            (view.GetType().Equals(typeof(ReportParameterContractToViewAddInAdapter))))\n        {\n            return ((ReportParameterContractToViewAddInAdapter)(view)).GetSourceContract();\n        }\n        else\n        {\n            return new ReportParameterViewToContractAddInAdapter(view);\n        }\n    }\n}\n\npublic class ReportParameterContractToViewAddInAdapter : IReportParameter\n{\n    private IReportParameterContract _contract;\n    private ContractHandle _handle;\n\n    public ReportParameterContractToViewAddInAdapter(IReportParameterContract contract)\n    {\n        _contract = contract;\n        _handle = new ContractHandle(contract);\n    }\n\n    public string Name \n    { \n        get { return _contract.Name; }\n        set { _contract.Name = value; }\n    }\n\n    public string Value \n    { \n        get { return _contract.Value;}\n        set { _contract.Value = value; } \n    }\n\n    internal IReportParameterContract GetSourceContract()\n    {\n        return _contract;\n    }\n}\n\npublic class ReportParameterViewToContractAddInAdapter : ContractBase, IReportParameterContract\n{\n    IReportParameter _view;\n\n    public ReportParameterViewToContractAddInAdapter(IReportParameter view)\n    {\n        _view = view;\n    }\n\n    public virtual string Name\n    { \n        get { return _view.Name; }\n        set { _view.Name = value; }\n    }\n\n    public virtual string Value\n    { \n        get { return _view.Value; }\n        set { _view.Name = value; }\n    }\n\n    internal IReportParameter GetSourceView()\n    {\n        return _view;\n    }\n}\n</code></pre>\n\n<p><strong>Host View Assembly</strong></p>\n\n<pre><code>public interface IReportComponent\n{\n    IList&lt;IReportParameter&gt; ReportParameters { get; set; }\n    bool GenerateReport();\n}\n\npublic interface IReportParameter\n{\n    string Name { get; set; }\n    string Value { get; set; }\n}\n\npublic class ReportParameter : IReportParameter\n{\n    public string Name\n    {\n        get;\n        set;\n    }\n\n    public string Value\n    {\n        get;\n        set;\n    }\n}\n</code></pre>\n\n<p><strong>Host Adapter Assembly</strong></p>\n\n<pre><code>[HostAdapter]\npublic class ReportComponentContractToViewHostAdapter: IReportComponent\n{\n    IReportComponentContract _contract;\n    ContractHandle _lifetime;\n\n    public ReportComponentContractToViewHostAdapter(IReportComponent contract)\n    {\n        _contract = contract;\n        _lifetime = new ContractHandle(contract);\n    }\n\n    public IList&lt;IReportParameter&gt; ReportParameters\n    {\n        get \n        {\n            return CollectionAdapters.ToIList&lt;IReportParameterContract, IReportParameter&gt;(_contract.ReportParameters, ReportParameterHostAdapter.ContractToViewAdapter, ReportParameterHostAdapter.ViewToContractAdapter); \n        }\n        set \n        {\n            _contract.ReportParameters = CollectionAdapters.ToIListContract&lt;IReportParameter, IReportParameterContract&gt;(value, ReportParameterHostAdapter.ViewToContractAdapter, ReportParameterHostAdapter.ContractToViewAdapter); \n        }\n    }\n\n    public  bool GenerateReport()\n    {\n        return _contract.GenerateReport();\n    }\n\n}\n\ninternal class ReportParameterContractToViewHostAdapter : IReportParameter\n{\n    private ContractHandle _handle;\n    private IReportParameterContract _contract;\n\n    public ReportParameterContractToViewHostAdapter(IReportParameterContract contract)\n    {\n        _contract = contract;\n        _handle = new ContractHandle(contract);\n    }\n\n    public string Name\n    {\n        get { return _contract.Name; }\n        set { _contract.Name = value; }\n    }\n\n    public string Value\n    {\n        get { return _contract.Value; }\n        set { _contract.Value = value; }\n    }\n\n    internal IReportParameterContract GetSourceContract()\n    {\n        return _contract;\n    }\n}\n\npublic class ReportParameterHostAdapter\n{\n    internal static IReportParameter ContractToViewAdapter(IReportParameterContract contract)\n    {\n        if (!System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(contract) &amp;&amp;\n            (contract.GetType().Equals(typeof(ReportParameterViewToContractHostAdapter))))\n        {\n            return ((ReportParameterViewToContractHostAdapter)(contract)).GetSourceView();\n        }\n        else\n        {\n            return new ReportParameterContractToViewHostAdapter(contract);\n        }\n    }\n\n    internal static IReportParameterContract ViewToContractAdapter(IReportParameter view)\n    {\n        if (!System.Runtime.Remoting.RemotingServices.IsObjectOutOfAppDomain(view) &amp;&amp;\n            (view.GetType().Equals(typeof(ReportParameterContractToViewHostAdapter))))\n        {\n            return ((ReportParameterContractToViewHostAdapter)(view)).GetSourceContract();\n        }\n        else\n        {\n            return new ReportParameterViewToContractHostAdapter(view);\n        }\n\n    }\n}\n\npublic class ReportParameterViewToContractHostAdapter: ContractBase, IReportParameterContract\n{\n    private IReportParameter _view;\n\n    public ReportParameterViewToContractHostAdapter(IReportParameter view)\n    {\n        _view = view;\n    }\n\n    public virtual string Name\n    {\n        get { return _view.Name; }\n        set { _view.Name = value; }\n    }\n\n    public virtual string Value\n    {\n        get { return _view.Value; }\n        set { _view.Value = value; }\n    }\n\n    internal IReportParameter GetSourceView()\n    {\n        return _view;\n    }\n}\n</code></pre>\n"},{"tags":[".net","wcf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13239556,"title":"Windows Communication Foundation (WCF) can be assumed as Middlware Technology","body":"<p>I have know that Windows Communication Foundation (WCF) is a code library to connect between different applications. I have once used Inter-Process Communication technology to connect two different applications written in two different languages (vb.net and C#.net). Therefore, I want to know that </p>\n\n<p>Windows Communication Foundation (WCF) of .Net Framework can be assumed as Middleware Technology for .Net Applications?</p>\n"},{"tags":["c#",".net","regex","streamreader"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":13239539,"title":"Read in a file using a regular expression?","body":"<p>This is tangentially related to <a href=\"http://stackoverflow.com/questions/12939597/returning-the-regular-expression-match-as-part-of-a-split-or-equivalent-functio\">an earlier question of mine.</a></p>\n\n<p>Essentially, the solution in that question worked great, but now I need to adapt it to work in a much larger analysis application.  Simply using <code>StreamReader.ReadToEnd()</code> is not acceptable, since some of the files I will be reading in are very, very large.  If there's been a mistake and someone forgot to clean up, they can theoretically be gigabytes big.  Obviously I can't just read to the end of that.</p>\n\n<p>Unfortunately, the normal read lines is also not acceptable, because some of the rows of data I am reading in contain stack traces - they obviously use <code>/r/n</code> in their formatting.  Ideally, I would like to tell the program to read forward until it hits a match for a regex, which it then returns.  Is there any functionality to do this in .net?  If not, can I get some suggestions for how I'd go about writing it?</p>\n\n<p>Edit: To make it a bit easier to follow my question, here's a paste of some of the important parts of the adapted code:</p>\n\n<pre><code>        foreach (var fileString in logpath.Select(log =&gt; new StreamReader(log)).Select(fileStream =&gt; fileStream.ReadToEnd()))\n        {\n            const string junkPattern = @\"\\[(?&lt;junk&gt;[0-9]*)\\] \\((?&lt;userid&gt;.{0,32})\\)\";\n            const string severityPattern = @\"INFO|ERROR|FATAL\";\n            const string datePattern = \"^(?=[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2},[0-9]{3})\";\n            var records = Regex.Split(fileString, datePattern, RegexOptions.Multiline);\n            foreach (var record in records.Where(x =&gt; string.IsNullOrEmpty(x) == false))\n            ......\n</code></pre>\n\n<p>The problem lies in the Foreach.  <code>.Select(fileStream =&gt; fileStream.ReadToEnd())</code> is gonna blow up memory badly, I just know it.</p>\n"},{"tags":["c#",".net","linq","linq-to-objects"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13169951,"title":"Extension to choose which extension to use in Linq","body":"<p>Is it possible to choose which function to apply in Linq?<br>\nExample of what I now have:  </p>\n\n<pre><code>List&lt;int&gt; list = new List&lt;int&gt;();\nbool bDescend = false;\nvar listOrdered = bDescend ? list.OrderByDescending(it =&gt; it) : \n                             list.OrderBy(it =&gt; it);\n</code></pre>\n\n<p>You see that I choose which function to apply depending on bDescend value - so there is actually two Linq queries, not one.<br>\nIs it possible to avoid it by putting condition inside one query?\nMaybe something like  </p>\n\n<pre><code>list.ChooseFunction(bDescend ? OrderBy : OrderByDescending)...\n</code></pre>\n\n<p>Real code is more compliated and if such trick possible it would make code much more readable.<br>Looks like kind of metaprogramming..</p>\n"},{"tags":["c#",".net","linq","entity-framework","dynamic"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13233461,"title":"Dynamic conditions in Linq-to-Entities query","body":"<p>I'm trying to convert some old code that directly builds SQL queries to Entity Framework, and came across a problem that many seem to have (judging from the large number of questions surround that topic): how to express dynamic where conditions in linq.</p>\n\n<p>How could I express the following code with a linq query:</p>\n\n<pre><code>    switch (status) {\n        case \"0\":\n            sqlwhere = \" WHERE status &lt; 0 \";\n            break;\n        case \"-1\":\n            sqlwhere = \" WHERE status = -1 \";\n            break;\n        case \"-100\":\n            sqlwhere = \" WHERE status = -100 \";\n            break;\n        case \"1\":\n        default:\n            sqlwhere = \" WHERE status &gt;= 0 \";\n            break;\n    }\n\n    if (strsearch != \"\")\n        sqlwhere += \" AND desc LIKE '%\" + strsearch + \"%' \";\n\n    string sqlc = \"SELECT top 10 * FROM c \" + sqlwhere + \" order by date desc\";\n</code></pre>\n\n<p>I've read about <code>PredicateBuilder</code> and the dynamic Linq extensions in other posts, but I think that a simple case like could be solvable without external libraries.</p>\n\n<p>Using .net 4.5, EF 5.0, C#, can this be done in a \"dynamic\" way without building the complete linq statement for each single case?</p>\n"},{"tags":[".net","wpf","flowdocument","tableofcontents"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13228869,"title":"How to create flowdocument table of contents","body":"<p>I have created a flow document. In case the document is printed or saved to a file I would like to add a TOC to the start of the document.</p>\n\n<p>What is the correct way of creating a TOC in a flowdocument? Can it be created automatically or should I add the TOC as the last thing looping through all the Paragraphs/Sections and manually add them to a table? If the manual creation is the way to go the next question that appears is how to determine the page number a Paragraph/Section is located on?</p>\n"},{"tags":["c#",".net","interface"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":51,"score":-1,"question_id":13238881,"title":"how to initiate a class with an interface inside an interface","body":"<p>If I have an interface <code>MyInterface1</code></p>\n\n<pre><code>interface MyInterface1\n{\n    ImyGod myproperty { get; set; }\n}\n</code></pre>\n\n<p>If I have a class do the following, it complains</p>\n\n<pre><code>class myClass : IMyInterface1\n{\n    myGod myproperty { get; set; }\n}\n</code></pre>\n\n<p>What should I iniatiate myClass with myGod here? \nThanks.</p>\n"},{"tags":[".net","class","struct","polymorphism","instance"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":81,"score":1,"question_id":8780662,"title":"How to check both in C++ and C#, if I'm inside the instance of class/struct?","body":"<p>I wonder, how can I check both in C++ and C# , if my code is executing inside the instance of class/struct?</p>\n\n<p>I need such option to make some members of class/struct be visible only if I have created the instance of class and no other way, and only in this instance (even for class functions they aren't visible only if I have created the instance of it).</p>\n"},{"tags":[".net","design","domain-driven-design","code-smell"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13238954,"title":"Adding dependency to class only because another [child] dependency needs it - Design Smell?","body":"<p>I am noticing occasions where I need to add dependencies to parent classes, and their parents and so on, only because a child class needs it. Is this a code smell? Is it reasonable for a parent class to need information only because a child class needs it?</p>\n\n<p>In particular in our [slightly anemic] flavor of DDD this seems to occur with Application Services (Domain boundary) needing information from our application layer to pass on to Domain Services. It is quite painful to add dependencies to app services calling a particular domain service and all of the associated tests when a domain service needs a new dependency.</p>\n"},{"tags":[".net"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":8209,"score":3,"question_id":84995,"title":"How to stream a PDF file as binary to the browser using .NET 2.0","body":"<p>I'm looking for a way to stream a PDF file from my server to the browser using .NET 2.0 (in binary).</p>\n\n<p>I'm trying to grab an existing PDF file from a server path and push that up as binary to the browser.</p>\n"},{"tags":["c#",".net","string","null"],"answer_count":10,"favorite_count":8,"up_vote_count":109,"down_vote_count":15,"view_count":4881,"score":94,"question_id":10814282,"title":"Why is this valid C# code?","body":"<p>This is valid C# code</p>\n\n<pre><code>var bob = \"abc\" + null + null + null + \"123\";  // abc123\n</code></pre>\n\n<p>This is not valid C# code</p>\n\n<pre><code>var wtf = null.ToString(); // compiler error\n</code></pre>\n\n<p>Why is the first statement valid?</p>\n"},{"tags":["c#","asp.net",".net","razor"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13238688,"title":"How to get the product version from a Razor View","body":"<p>I am trying to display my product version in a Razor view (<code>_Layout.cshtml</code>). I´m doing somethink like this:</p>\n\n<pre><code>&lt;script&gt;\nalert('@FileVersionInfo.GetVersionInfo(Assembly.GetExecutingAssembly().Location).ProductVersion');\nalert('@Assembly.GetExecutingAssembly().Location');\n&lt;/script&gt;\n</code></pre>\n\n<p>The problem is that the first alert showed me 0.0.0.0 then, I introduced the second alert and it shows me the following location:</p>\n\n<blockquote>\n  <p>C:WindowsMicrosoft.NETFramework644.0.30319Temporary ASP.NET Filesoot#35f35b93778aeaApp_Web_ztow0zpu.dll</p>\n</blockquote>\n\n<p>Obviously this is not my assembly file. Is there any easy and clean way to get the assembly version from a Razor view?</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13235279,"title":"protobuf-net and de/serializing objects","body":"<p>I am checking if protobuf-net can be an in place replacement for DataContracts. Besides the excellent performance it is really a neat library. The only issue I have is that the .NET serializers do not make any assumptions what they are currently de/serializing. Especially objects which do contain reference to the typed object are a problem. </p>\n\n<pre><code>[DataMember(Order = 3)]\npublic object Tag1 // The DataContract did contain a object which becomes now a SimulatedObject\n{\n    get;\n    set;\n}\n</code></pre>\n\n<p>I tried to mimic object with protocol buffers with a little generic helper which does store for each possible type in a different strongly typed field. </p>\n\n<p>Is this an recommended approach to deal with fields which de/serialize into a number of different not related types? </p>\n\n<p>Below is the sample code for a SimulatedObject which can hold up to 10 different types. </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Runtime.Serialization;\nusing ProtoBuf;\nusing System.Diagnostics;\n\n[DataContract]\npublic class SimulatedObject&lt;T1,T2,T3,T4,T5,T6,T7,T8,T9,T10&gt;\n{\n    [DataMember(Order = 20)]\n    byte FieldHasValue; // the number indicates which field actually has a value\n\n    [DataMember(Order = 1)]\n    T1 I1;\n\n    [DataMember(Order = 2)]\n    T2 I2;\n\n    [DataMember(Order = 3)]\n    T3 I3;\n\n    [DataMember(Order = 4)]\n    T4 I4;\n\n    [DataMember(Order = 5)]\n    T5 I5;\n\n    [DataMember(Order = 6)]\n    T6 I6;\n\n    [DataMember(Order = 7)]\n    T7 I7;\n\n    [DataMember(Order = 8)]\n    T8 I8;\n\n    [DataMember(Order = 9)]\n    T9 I9;\n\n    [DataMember(Order = 10)]\n    T10 I10;\n\n    public object Data\n    {\n        get\n        {\n            switch(FieldHasValue)\n            {\n                case 0: return null;\n                case 1: return I1;\n                case 2: return I2;\n                case 3: return I3;\n                case 4: return I4;\n                case 5: return I5;\n                case 6: return I6;\n                case 7: return I7;\n                case 8: return I8;\n                case 9: return I9;\n                case 10: return I10;\n                default:\n                    throw new NotSupportedException(String.Format(\"The FieldHasValue field has an invlaid value {0}. This indicates corrupt data or incompatible data layout chagnes\", FieldHasValue));\n            }\n        }\n        set\n        {\n            I1 = default(T1);\n            I2 = default(T2);\n            I3 = default(T3);\n            I4 = default(T4);\n            I5 = default(T5);\n            I6 = default(T6);\n            I7 = default(T7);\n            I8 = default(T8);\n            I9 = default(T9);\n            I10 = default(T10);\n\n\n            if (value != null)\n            {\n                Type t = value.GetType();\n                if (t == typeof(T1))\n                {\n                    FieldHasValue = 1;\n                    I1 = (T1) value;\n                }\n                else if (t == typeof(T2))\n                {\n                    FieldHasValue = 2;\n                    I2 = (T2) value;\n                }\n                else if (t == typeof(T3))\n                {\n                    FieldHasValue = 3;\n                    I3 = (T3) value;\n                }\n                else if (t == typeof(T4))\n                {\n                    FieldHasValue = 4;\n                    I4 = (T4) value;\n                }\n                else if (t == typeof(T5))\n                {\n                    FieldHasValue = 5;\n                    I5 = (T5) value;\n                }\n                else if (t == typeof(T6))\n                {\n                    FieldHasValue = 6;\n                    I6 = (T6) value;\n                }\n                else if (t == typeof(T7))\n                {\n                    FieldHasValue = 7;\n                    I7 = (T7) value;\n                }\n                else if (t == typeof(T8))\n                {\n                    FieldHasValue = 8;\n                    I8 = (T8) value;\n                }\n                else if (t == typeof(T9))\n                {\n                    FieldHasValue = 9;\n                    I9 = (T9) value;\n                }\n                else if (t == typeof(T10))\n                {\n                    FieldHasValue = 10;\n                    I10 = (T10) value;\n                }\n                else\n                {\n                    throw new NotSupportedException(String.Format(\"The type {0} is not supported for serialization. Please add the type to the SimulatedObject generic argument list.\", t.FullName));\n                }\n            }\n        }\n    }\n}\n\n[DataContract]\nclass Customer\n{\n    /* \n    [DataMember(Order = 3)]\n    public object Tag1 // The DataContract did contain a object which becomes now a SimulatedObject\n    {\n        get;\n        set;\n    }\n    */\n\n    [DataMember(Order = 3)]\n    public SimulatedObject&lt;bool, Other, Other, Other, Other, Other, Other, Other, Other, SomethingDifferent&gt; Tag1 // Can contain up to 10 different types\n    {\n        get;\n        set;\n    }\n\n\n\n    [DataMember(Order = 4)]\n    public List&lt;string&gt; Strings\n    {\n        get;\n        set;\n    }\n}\n\n[DataContract]\npublic class Other\n{\n    [DataMember(Order = 1)]\n    public string OtherData\n    {\n        get;\n        set;\n    }\n}\n\n[DataContract]\npublic class SomethingDifferent\n{\n    [DataMember(Order = 1)]\n    public string OtherData\n    {\n        get;\n        set;\n    }\n\n}\n\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        Customer c = new Customer\n        {\n            Strings = new List&lt;string&gt; { \"First\", \"Second\", \"Third\" },\n            Tag1 = new SimulatedObject&lt;bool, Other, Other, Other, Other, Other, Other, Other, Other, SomethingDifferent&gt;\n                    {\n                        Data = new Other {  OtherData = \"String value \"}\n                    }\n        };\n\n        const int Runs = 1000 * 1000;\n        var stream = new MemoryStream();\n\n        var sw = Stopwatch.StartNew();\n\n        Serializer.Serialize&lt;Customer&gt;(stream, c);\n        sw = Stopwatch.StartNew();\n        for (int i = 0; i &lt; Runs; i++)\n        {\n            stream.Position = 0;\n            stream.SetLength(0);\n            Serializer.Serialize&lt;Customer&gt;(stream, c);\n        }\n        sw.Stop();\n        Console.WriteLine(\"Data Size with Protocol buffer Serializer: {0}, {1} objects did take {2}s\", stream.ToArray().Length, Runs, sw.Elapsed.TotalSeconds);\n\n        stream.Position = 0;\n        var newCustw = Serializer.Deserialize&lt;Customer&gt;(stream);\n\n        sw = Stopwatch.StartNew();\n        for (int i = 0; i &lt; Runs; i++)\n        {\n            stream.Position = 0;\n            var newCust = Serializer.Deserialize&lt;Customer&gt;(stream);\n        }\n        sw.Stop();\n        Console.WriteLine(\"Read object with Protocol buffer deserializer: {0} objects did take {1}s\", Runs, sw.Elapsed.TotalSeconds);\n\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","optimization",".net-3.5"],"answer_count":8,"favorite_count":5,"up_vote_count":26,"down_vote_count":0,"view_count":6028,"score":26,"question_id":1709471,"title":"best way to clear contents of .NET's StringBuilder","body":"<p>I would like to ask what you think is the best way (lasts less / consumes less resources) to clear the contents in order to reuse a StringBuilder. Imagine the following scenario:</p>\n\n<pre><code>StringBuilder sb = new StringBuilder();\nforeach(var whatever in whateverlist)\n{\n  sb.Append(\"{0}\", whatever);\n}\n\n//Perform some stuff with sb\n\n//Clear stringbuilder here\n\n//Populate stringbuilder again to perform more actions\nforeach(var whatever2 in whateverlist2)\n{\n  sb.Append(\"{0}\", whatever2);\n}\n</code></pre>\n\n<p>And when clearing StringBuilder I can think of two possibilities:</p>\n\n<pre><code>sb = new StringBuilder();\n</code></pre>\n\n<p>or</p>\n\n<pre><code>sb.Length = 0;\n</code></pre>\n\n<p>What is the best way to clear it and why? </p>\n\n<p>Thank you.</p>\n\n<p>EDIT: I ment with current .NET 3.5 version.</p>\n"},{"tags":["c#",".net","system.io"],"answer_count":5,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":4373,"score":5,"question_id":6817639,"title":"Get filenames without path of a specific directory","body":"<p>How can I get all filenames of a directory (and its subdirectorys) without the full path? \n<strong>Directory.GetFiles(...)</strong> returns always the full path! </p>\n"},{"tags":[".net"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":778,"score":2,"question_id":2787547,"title":"Edit and save the word file online on web in .NET","body":"<p>The requirement is as follows</p>\n\n<p>1.) Upload the word file on website</p>\n\n<p>2.) Display word file on website with the same  formatting as we upload</p>\n\n<p>3.) Edit and save the word file online on web</p>\n\n<p>4.) Download the changed Wrod file from website (word file Format should not changed)</p>\n\n<p>How to achieve this requirement.</p>\n"},{"tags":["c#",".net","sql","regex","vb.net"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":540,"score":1,"question_id":9842991,"title":"Regex to remove single-line SQL comments (--)","body":"<p>Question:</p>\n\n<p>Can anybody give me a working regex expression (C#/VB.NET) that can remove single line comments from a SQL statement ?</p>\n\n<p>I mean these comments:</p>\n\n<pre><code>-- This is a comment\n</code></pre>\n\n<p>not those</p>\n\n<pre><code>/* this is a comment */\n</code></pre>\n\n<p>because I already can handle the star comments.</p>\n\n<p>I have a made a little parser that removes those comments when they are at the start of the line, but they can also be somewhere after code or worse, in a SQL-string <code>'hello --Test -- World'</code> \nThose comments should also be removed (except those in a SQL string of course - if possible).</p>\n\n<p>Surprisingly I didn't got the regex working. I would have assumed the star comments to be more difficult, but actually, they aren't.</p>\n\n<p>As per request, here my code to remove /**/-style comments\n(In order to have it ignore SQL-Style strings, you have to subsitute strings with a uniqueidentifier (i used 4 concated), then apply the comment-removal, then apply string-backsubstitution.</p>\n\n<pre><code>    static string RemoveCstyleComments(string strInput) \n    { \n        string strPattern = @\"/[*][\\w\\d\\s]+[*]/\"; \n        //strPattern = @\"/\\*.*?\\*/\"; // Doesn't work \n        //strPattern = \"/\\\\*.*?\\\\*/\"; // Doesn't work \n        //strPattern = @\"/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/ \"; // Doesn't work \n        //strPattern = @\"/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/ \"; // Doesn't work \n\n        // http://stackoverflow.com/questions/462843/improving-fixing-a-regex-for-c-style-block-comments \n        strPattern = @\"/\\*(?&gt;(?:(?&gt;[^*]+)|\\*(?!/))*)\\*/\";  // Works ! \n\n        string strOutput = System.Text.RegularExpressions.Regex.Replace(strInput, strPattern, string.Empty, System.Text.RegularExpressions.RegexOptions.Multiline); \n        Console.WriteLine(strOutput); \n        return strOutput; \n    } // End Function RemoveCstyleComments \n</code></pre>\n"},{"tags":["c#",".net","ajax","formview","scriptmanager"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10344,"score":1,"question_id":127283,"title":"ScriptManager.RegisterClientScript in a UserControl within a FormView inside an Async Panel","body":"<p>I'm having an annoying problem registering a javascript event from inside a user control within a formview in an Async panel. I go to my formview, and press a button to switch into insert mode. This doesn't do a full page postback. Within insert mode, my user control's page_load event  should then register a javascript event using ScriptManager.RegisterStartupScript:</p>\n\n<pre><code>ScriptManager.RegisterStartupScript(base.Page, this.GetType(), (\"dialogJavascript\" + this.ID), \"alert(\\\"Registered\\\");\", true);\n</code></pre>\n\n<p>However when I look at my HTML source, the event isn't there. Hence the alert box is never shown. This is the setup of my actual aspx file:</p>\n\n<pre><code>&lt;igmisc:WebAsyncRefreshPanel ID=\"WebAsyncRefreshPanel1\" runat=\"server\"&gt;\n    &lt;asp:FormView ID=\"FormView1\" runat=\"server\" DataSourceID=\"odsCurrentIncident\"&gt;\n        &lt;EditItemTemplate&gt;\n            &lt;uc1:SearchSEDUsers ID=\"SearchSEDUsers1\" runat=\"server\" /&gt;\n        &lt;/EditItemTemplate&gt;\n        &lt;ItemTemplate&gt;\n            Hello\n            &lt;asp:Button ID=\"Button1\" runat=\"server\" CommandName=\"Edit\" Text=\"Button\" /&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:FormView&gt;\n&lt;/igmisc:WebAsyncRefreshPanel&gt;\n</code></pre>\n\n<p>Does anyone have any idea what I might be missing here?</p>\n"},{"tags":["c#",".net","vb.net","converter"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":76,"score":-1,"question_id":13237646,"title":"vb.net to c# conversion","body":"<p>I am trying to convert a piece of code to c# but cannot get my head around it:</p>\n\n<pre><code> For iItem = LBound(arrItems) To UBound(arrItems)\n            If InStr(arrItems(iItem), strFieldName &amp; \"=\") = 1 Then\n                strFindField = Mid(arrItems(iItem), Len(strFieldName) + 2)\n                Exit For\n            End If\n        Next\n</code></pre>\n\n<p>Can someone help please with if statement.</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","multithreading","task-parallel-library"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13197144,"title":"How to cancel a bunch of tasks when any of these tasks throws an exception?","body":"<p>I create and start many tasks. \nOne of the task can throw an exception. If this happens I need to stop all the tasks.</p>\n\n<p>Now I just see the only way to do this is to pass CancellationTokenSource to each task and call Cancel() in catch block.</p>\n\n<p>Does TPL support the required feature in a more generic way?</p>\n\n<p>Something like:</p>\n\n<pre><code>Action&lt;Task&gt; onExceptionAction = t =&gt; cancellationTokenSource.Cancel();\nvar task = Task.WhenAnyThrows&lt;MyException&gt;(tasks, onExceptionAction);\n</code></pre>\n\n<p>And task is considered to be completed (or cancelled) if no exception is thrown</p>\n"},{"tags":["c#",".net","c#-4.0","web-config","app-config"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1784,"score":5,"question_id":4464148,"title":"Can we have multiple App.Config files in .NET console application?","body":"<p>I have a <strong>console application</strong> that has App.Confile file.\nNow the parameters that are environment specific are maintained here.</p>\n\n<p>Now I am thinking to have <strong>multiple app.config files</strong> (like <strong>app.dev.config, app.test.config and app.prod.config</strong>) the way how we can have multiple Web.Config files. </p>\n\n<p>In case of Web application, we can handle this and ConfigurationManager would pick respective Web.Config file.</p>\n\n<p>In case of Console application, I am not sure. If Yes, how can we have multiple app.config files? </p>\n\n<p>Appreciate your help.</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","excel","datetime"],"answer_count":4,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":9433,"score":8,"question_id":727466,"title":"How do I convert an Excel serial date number to a .NET DateTime?","body":"<p>How do I convert from excel serial date to a .NET date time?</p>\n\n<p>For example  39938 is 05/05/2009.</p>\n"},{"tags":[".net","winforms","controls"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":670,"score":0,"question_id":2598956,"title":"A free WYSIWYG control for DotNet","body":"<p>I search a free and easy to drag&amp;drop in my winform WYSIWYG-Control.</p>\n\n<p>The background is, I don't have time I can spend on the control, it must be there and ready.</p>\n\n<p>DotNet.2 C#\nNO ASP!\nWinForm!</p>\n"},{"tags":[".net","msmq"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":1198,"score":8,"question_id":4044365,"title":"MSMQ Messages Are Stuck In The Outgoing Queue","body":"<p>Although my question looks similar to some already found on SO, those post did not help me, so here it is:</p>\n\n<p>Given:</p>\n\n<ul>\n<li>Two machines on the same segment (naturally in the same domain, actually on the same desk)</li>\n<li>Both machines are Windows 7 workstations</li>\n<li>Both machines have disabled firewall</li>\n<li>Both machines see each other (ping works)</li>\n<li>There is a private non transactional message queue <strong>test</strong> on one of them.</li>\n<li>The sender machine has <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSMQ\\SimpleClient\\@BinaryEnabled = 'Yes'</code></li>\n<li>The queue owner sends a message from another machine</li>\n<li>The message is stuck on the outgoing queue, never reaching the target.</li>\n<li>When sent from the same machine (i.e. locally) the message arrives OK.</li>\n</ul>\n\n<p>The message is sent using the following code:</p>\n\n<pre><code>var q = new MessageQueue(@\"FormatName:Direct=OS:il-mark-lap\\private$\\test\");\nq.Send(string.Format(\"Test message sent at {0} from {1}\", DateTime.Now, Environment.MachineName));\n</code></pre>\n\n<p>Where <strong>il-mark-lap</strong> is the address of the machine with the queue.</p>\n\n<p>What on earth do I have to do to make the thing work?</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["c#",".net"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13237336,"title":"textbox text remove last character","body":"<p>If the string is > 8, I need to remove the last character</p>\n\n<p>How is this possible?</p>\n\n<pre><code>private void textBoxNewPassword_TextChanged(object sender, EventArgs e)\n{\n    if (textBoxNewPassword.TextLength == 9)\n        textBoxNewPassword.Text = textBoxNewPassword.Text.Remove((textBoxNewPassword.Text.Length - 1), 1);\n}\n</code></pre>\n\n<p>The code appears to do nothing.</p>\n"},{"tags":[".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13237662,"title":"A good terminal based app framwork for .net?","body":"<p>I am looking to develop an application that is going to be more keyboard orientated. I am looking to create like a \"older\" style DOS application. Here is the screenshot </p>\n\n<p><a href=\"http://www.mono-project.com/File:Screenshot1.png\" rel=\"nofollow\">http://www.mono-project.com/File:Screenshot1.png</a></p>\n\n<p>Now I think what I am looking for is \"Curses Sharp\" but I don't know how to get started on it.</p>\n\n<p>Edit: This would work too if someone can point me to how to work it with .net\n<a href=\"http://code.google.com/p/shellinabox/\" rel=\"nofollow\">http://code.google.com/p/shellinabox/</a></p>\n"},{"tags":[".net","dll","diff"],"answer_count":6,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":554,"score":5,"question_id":2735643,"title":"How can I tell whether two .NET DLLs are the same?","body":"<p>I have the source for a DLL and I have a compiled version of it lying around somewhere.</p>\n\n<p>If I compile the source it will have a different date to the already-compiled version.</p>\n\n<p>How can I tell whether they are in fact the same and have merely been compiled at different times?</p>\n"},{"tags":["c#",".net","sql","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13236919,"title":"Querying highest value by keys from database","body":"<p>With the following table:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    1    |\n|      1      |     1     |    5    |\n|      1      |     1     |    4    |\n|      1      |     2     |    7    |\n|      1      |     2     |    2    |\n|      2      |     1     |    2    |\n|      2      |     1     |    3    |\n|      2      |     2     |    2    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p>I would like to get the highest available count for given <code>Parent_ID</code> and <code>Item_ID</code>, like the following:</p>\n\n<pre><code>+-------------+-----------+---------+\n|  Parent_ID  |  Item_ID  |  Count  |\n+-------------+-----------+---------+\n|      1      |     1     |    5    |\n|      1      |     2     |    7    |\n|      2      |     1     |    3    |\n|      2      |     2     |    4    |\n+-------------+-----------+---------+\n</code></pre>\n\n<p><strong>How would I go about doing this using LINQ/SQL in C#?</strong> For example, I would like the highest item counts for parent id 1.  This would be something like:</p>\n\n<pre><code>int parentId = 1;\nvar counts = from c in database.Items where parentId == c.parentId \n//this gets all counts from items for parent id 1, but I am just looking\n//for the highest count per item for parent id 1\n</code></pre>\n"},{"tags":["c#",".net","encryption"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":35,"score":-4,"question_id":13233902,"title":"How to do encryption of AES key based on RSA public key using AES algorithm","body":"<p>Here I have a RSA public key (<code>rsapublickey</code>) and I have created a AES key based as follows:</p>\n\n<pre><code>AesManaged SenderAes = new AesManaged();\nSenderAes.GenerateKey();\nSenderAes.GenerateIV();\nbyte[] TestAesKey = SenderAes.Key;\n</code></pre>\n\n<p>Now I want to encrypt this <code>TestAesKey</code> key based on <code>rsapublickey</code> using the same <code>AesManaged</code> algorithm (AES algorithm).</p>\n\n<p>How can I do it?</p>\n"},{"tags":["c#",".net","colors"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13200751,"title":"Color Mixing for more than 2 colors","body":"<p>I'm trying to find an algorithm that will mix colors, based on a % amount.  I'm working on an election project, and want to be able to assign each candidate in a race a different color, and then create a \"resulting\" color based on how much of the vote that candidate has gotten.</p>\n\n<p>This question:</p>\n\n<p><a href=\"http://stackoverflow.com/q/1351442/1518211\">Is there an algorithm for color mixing that works like mixing real colors?</a></p>\n\n<p>is close the question I'm asking - but potentially I need to be able to mix 3 or 4 or 5 colors together.  I understand that this ultimately an incredibly complicated question - but I'm curious what the suggested method is for doing this on more than 2 colors.  So, I might have:</p>\n\n<p>Red (40%), Green(10%), Blue (50%)</p>\n\n<p>OR</p>\n\n<p>Red (40%), Yellow (5%), Blue (10%), Orange (45%)</p>\n\n<p>Once again, I know that the last example would probably produce some sort of Gray or Brown or Black - and that's fine.  My problem is that I don't even have an algorithm that attempts to solve this problem.</p>\n\n<hr>\n\n<p>Edit:\nSo - after posting this message, I realized that what I was really trying to accomplish was basically PAINT color mixing.  IN other words, I don't want LIGHT color mixing, I want to simulate what would happen with PAINT mixing - as that is the \"predictable\" result that I kept 'expecting' - and was having trouble getting.</p>\n\n<p>I found this link: <a href=\"http://painting.about.com/library/blpaint/blcolormixingpalette1.htm\" rel=\"nofollow\">http://painting.about.com/library/blpaint/blcolormixingpalette1.htm</a></p>\n\n<p>which behaves VERY closely to what I'm trying to accomplish - and exposes a small \"flaw\" in my original idea.  What is demonstrates is that even though I can mix up to 6 colors using this algorithm, the actual \"data\" is always broken down into the 3 primary colors.</p>\n\n<p>Even so - this is very close.</p>\n\n<p>Thank you to everyone who has contributed to this thread - all of these suggestions have been very helpful in the exploration of this surprising complex question/field.</p>\n"},{"tags":["c#",".net","winforms","printing","crystal-reports"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3816,"score":0,"question_id":6362230,"title":"Crystal Report | Printing | Default Printer","body":"<p>I am making one application where user will print invoices which I am displaying using Crystal Report.</p>\n\n<p>The user showed me his current application made using ForPro. In that application, under Printer Options form, one can see all the printers currently installed and the user could select default printer. When the invoice is made, the user presses the print button, then there is one dialog asking for no. of copies. When it's entered, the invoice gets printed directly, without any Print Dialog Box. If the user wants to change the printer again he/she will change it in the Printer Option form.</p>\n\n<p>I want to know if similar thing is possible in Crystal Report and need guidance on how to approach for it.</p>\n"},{"tags":["c#",".net","sql-server","smo"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13233982,"title":"Get Sql server's data using smo","body":"<p>I'm using Sql Server Smo to create the scheme of database by C# application. However, I need a bit more, I also need to get data from each table as a <strong>script</strong> like below:</p>\n\n<pre><code>--........................................\nINSERT INTO Table123 (...) VALUES (....)\nINSERT INTO Table456 (...) VALUES (....)\n--........................................\n</code></pre>\n\n<p>How can I do that and is it possible? Notice please that I need to create exactly a script using smo and not *.bak of a database, etc.</p>\n"},{"tags":["asp.net",".net","sql","sql-server","vb.net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13235490,"title":"Archive checked records in grid view (Change 0 to 1 in database)","body":"<p>I have a grid view which pulls through data dictated by a stored procedure.</p>\n\n<p><img src=\"http://i.stack.imgur.com/S89rn.png\" alt=\"screen shot 1\"></p>\n\n<p>The stored procedure is called GetEverything.\nThe statement is made up of information from 2 tables, one with person detail, and one with vessel detail. The stored procedure select statement contains the following Where clause:</p>\n\n<pre><code>WHERE Vessel.ArchiveStatus = 0\n</code></pre>\n\n<p>By default, every new record that is created using the front end application is given a '0' for ArchiveStatus in the db.</p>\n\n<p>So, the gridview will only show me the records where the ArchiveStatus is 0, which by default is evertything.</p>\n\n<p>The 2 boxes, Check All and Uncheck All are working fully.</p>\n\n<p>What I need now is when a REF or REF(s) are selected and the button 'Archive Records' is clicked, for the 0 in the database to be updated to a 1 for that VesselREF.</p>\n\n<p>Can anoyone advise how to do this and give me some example code to put in the Default.aspx.vb file/ Event Handler for the archive records button.</p>\n\n<p>With this is place, the grid view will only display the non-archived records, and I can create a seperate grid view with its own SQL to bring through the archived records.</p>\n\n<pre><code>GridView.aspx\n\n    &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"False\" \n        DataKeyNames=\"REF,VesselREF\" DataSourceID=\"SqlDataSource1\" Height=\"132px\" \n        style=\"text-align: center; font-family: Calibri; font-size: medium\" \n        Width=\"508px\" BackColor=\"#C4FFC4\"&gt;\n        &lt;AlternatingRowStyle BackColor=\"White\" /&gt;\n        &lt;Columns&gt;\n            &lt;asp:TemplateField HeaderText=\"REF\" InsertVisible=\"False\" SortExpression=\"REF\"&gt;\n\n                &lt;ItemTemplate&gt;\n                    &lt;a href=\"Details.aspx?REF=&lt;%# Eval(\"REF\")%&gt;\"&gt;&lt;%# Eval(\"REF\")%&gt;&lt;/a&gt;\n                    &lt;asp:CheckBox ID=\"RecordSelector\" runat=\"server\" /&gt;\n                &lt;/ItemTemplate&gt;\n            &lt;/asp:TemplateField&gt;\n            &lt;asp:BoundField DataField=\"Title\" HeaderText=\"Title\" SortExpression=\"Title\" /&gt;\n            &lt;asp:BoundField DataField=\"FirstName\" HeaderText=\"FirstName\" \n                SortExpression=\"FirstName\" /&gt;\n            &lt;asp:BoundField DataField=\"Surname\" HeaderText=\"Surname\" \n                SortExpression=\"Surname\" /&gt;\n            &lt;asp:BoundField DataField=\"VesselName\" HeaderText=\"VesselName\" \n                SortExpression=\"VesselName\" /&gt;\n            &lt;asp:BoundField DataField=\"VesselREF\" HeaderText=\"VesselREF\" \n                InsertVisible=\"False\" ReadOnly=\"True\" SortExpression=\"VesselREF\" /&gt;\n\n        &lt;/Columns&gt;\n    &lt;/asp:GridView&gt;\n</code></pre>\n"},{"tags":["c#",".net","wmi","hardware","bios"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13233656,"title":"What it the BIOS Serial Number Maximum length?","body":"<p>I am developing an activation application, which I need to collect the BIOS serial number to identify the PC,\nthe Application combine the BIOS serial Number to other data, which will be encrypted,\nI need my data not to exceed the block size of the encryption to prevent building another block which means a longer activation string.\nI need to make sure that the BIOS serial number's length will not exceed a certain value, if it is less, I can add some data, but if it exceeds I cannot trim it since I need to make sure there is no activation key works for two PCs.</p>\n\n<p>My question simply is: What is the maximum length of the BIOS Serial number ?\nand how I can get these standards?</p>\n\n<p>P.S. doing trim made us a great problem since there are some serials are too longer than the requested value, so there exists a key running more than one PC.</p>\n\n<p>Regards,</p>\n"},{"tags":["c#",".net","xml","xml-serialization","xsd.exe"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13236252,"title":"How to manage changes for the ItemChoiceType enum when revising XML schemas?","body":"<p>We are using XSD.EXE to generate runtime classes from an XSD schema for XML serialization. The schema is large and contains many complex types and choice elements. As described in <a href=\"http://msdn.microsoft.com/en-us/magazine/cc164135.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/magazine/cc164135.aspx</a>, choice elements generate two fields: an Item field to hold the value and an ItemChoiceType field which holds a generated enum defining which named element is in the Item field.</p>\n\n<p>XSD creates a unique enum for each of these element name fields named ItemChoiceTypeXX, where XX is an integer. XSD creates as many of these ItemChoiceTypes as it needs and names them with incremented number.</p>\n\n<p>So, a small piece of my schema looks like:</p>\n\n<pre><code>&lt;xsd:choice&gt;\n  &lt;xsd:element ref = \"Sequence\"/&gt;\n  &lt;xsd:element ref = \"HandshakeId\"/&gt;\n&lt;/xsd:choice&gt;\n</code></pre>\n\n<p>and I can code to it like using the generated classes like:</p>\n\n<pre><code>job.Item = \"123\";        \njob.ItemElementName = ItemChoiceType26.Sequence;\n</code></pre>\n\n<p>The problem is that in the originally generated classes, the ItemChoiceType for this element was ItemChoiceType26. After updating the schema and regenerating the classes, the name is now ItemChoiceType27.</p>\n\n<p>My question is how do I manage this as the schema is updated and revised over time? I don't control the XSD schema, it is provided by a vendor. However, I do have to update my code to match changes they make. This seems like I'm facing a maintenance nightmare over time and would like any suggestions to better manage this.</p>\n"},{"tags":["c#",".net","web-services","soap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13236171,"title":"Set or change service endpoints in WSDL programmatically in .NET","body":"<p>We have a .NET SOAP service that's accessed via a load balancer which performs SSL termination. So, a request coming into <a href=\"https://mysite.com/service.asmx?WSDL\" rel=\"nofollow\">https://mysite.com/service.asmx?WSDL</a> is seen as <a href=\"http://mysite.com/service.asmx?WSDL\" rel=\"nofollow\">http://mysite.com/service.asmx?WSDL</a> in the application. Thus, the generated WSDL shows non-SSL endpoints. And that's causing some flash apps to throw a fit.</p>\n\n<p>Is there a way (on the server side) to change/rewrite the endpoint at runtime? (The application also runs from many non-SSL development/testing locations.)</p>\n"},{"tags":["c#",".net","compact-framework","wlan"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":32,"score":-2,"question_id":13236032,"title":"Get Host-IPs of wireless network","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13233808/get-all-ip-hosts-in-lan-from-mobile-device\">Get all IP-Hosts in Lan from mobile device</a>  </p>\n</blockquote>\n\n\n\n<p>How can I get programmaticaly all the hosts in a wireless network?</p>\n\n<p>I know the wlan I'm working in and I am connected to it. Now I want to show a list of the hosts (or at least their IP-Addresses).</p>\n\n<p>How can I accomplish this, and are there special points if I work on windows mobile with compact framework and want to do that?</p>\n"},{"tags":["c#",".net","algorithm","3d","physics"],"answer_count":5,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":1287,"score":5,"question_id":4362498,"title":"Curve fitting points in 3D space","body":"<p>Trying to find functions that will assist us to draw a 3D line through a series of points.</p>\n\n<p>For each point we know: Date&amp;Time, Latitude, Longitude, Altitude, Speed and Heading.\nData might be recorded every 10 seconds and we would like to be able to guestimate the points in between and increase granularity to 1 second. Thus creating a virtual flight path in 3D space.</p>\n\n<p>I have found a number of curve fitting algorithms that will approximate a line through a series of points but they do not guarantee that the points are intersected. They also do not take into account speed and heading to determine the most likely path taken by the object to reach the next point.</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2336,"score":1,"question_id":287685,"title":"Raise LostFocus event on a control manually","body":"<p>Hi<br />\n  I have a bunch of controls (textbox and combobox) on a form with toolstripcontainer and toolstripbuttons for save, cancel etc for edits. We are using .Net 3.5 SP1<br />\n  There is bunch of logic written in control.lostfocus and control.leave events. These events are not being called when clicked on the toolstrip buttons. Is there a way to call these events manually when any of these buttons are pressed.</p>\n\n<p>Thanks.<br />\nKishore</p>\n\n<p>[Edit]</p>\n\n<p>This is how I solved the problem. Thanks <em><a href=\"http://stackoverflow.com/questions/287685/raise-lostfocus-event-on-a-control-manually-c#287740\">Chris Marasti-Georg</a></em> for the pointer. In the button click event I calling focus on the toolstrip instead of the button as the toolstripbutton does not have a focus event. We can access the toolstrip on which the button is placed using</p>\n\n<p>((ToolStripButton)sender).Owner.Focus()</p>\n\n<p>-Kishore</p>\n"},{"tags":["asp.net",".net","encryption","azure","connection-string"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13027381,"title":"Encrypt the connectionstring for Azure with VS2012","body":"<p>I want to encrypt the connectionstring for my Azure ASP.Net Website.</p>\n\n<p>I found the following article on the Windows Azure Blog: <a href=\"http://blogs.msdn.com/b/windowsazure/archive/2010/09/09/securing-your-connection-string-in-windows-azure-part-3.aspx\" rel=\"nofollow\">Securing your connection string in Windows Azure - Part 3</a></p>\n\n<p>Unfortunately, the article seems to be outdated.</p>\n\n<ul>\n<li>Azure now works with the <em>.cer</em> file instead of <em>.pfx</em>, as the article states. (not a problem though)</li>\n<li>The linked <a href=\"http://archive.msdn.microsoft.com/pkcs12protectedconfg\" rel=\"nofollow\">PKCS12 Provider</a> cannot be built with Visual Studio 2012</li>\n</ul>\n\n<p>When I try to open it in VS2012, I get the error that Installer.vdproj is incompatible and I therefor am unable to build the installer for the provider.</p>\n\n<p>Is there an updated version of the provider somewhere?</p>\n\n<p>Or is there another updated article on how to encrypt connection strings for Azure?</p>\n\n<p>Any help appreciated.</p>\n"},{"tags":[".net",".net-2.0","visual-studio-2012"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13198629,"title":"Visual Studio 2012 .NET Framework 2.0 missing","body":"<p>Very strange one.  </p>\n\n<p>I have a Windows 8 dev machine which has .NET 3.5 enabled in Windows features but after installing Visual Studio 2012 I can not see .NET Framework 2.0 in the New Project list. I can see 3.0 - 4.5 but nothing below it.  Problem is I need to support some specific .NET 2 apps.</p>\n\n<p>I've tried:</p>\n\n<ol>\n<li>Reinstalling Visual Studio completely.</li>\n<li>Turning .net 3.5 support off and on in Windows features</li>\n<li>Restarting several times during the above points</li>\n<li>Checking using the Setup Verification tool mentioned here (<a href=\"http://blogs.msdn.com/b/astebner/archive/2008/10/13/8999004.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/astebner/archive/2008/10/13/8999004.aspx</a>.  It returned that Framework 2.0 is installed and is valid.</li>\n</ol>\n\n<p>I'm stumped.  Any ideas what be greatly appreciated.  Likewise, if anyone knows how to force install .NET 2 from the .NET 3.5 runtime SP1 installer I may give that a go.</p>\n"},{"tags":["c#",".net",".net-3.5"],"answer_count":5,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1136,"score":7,"question_id":2389041,"title":"Dash (-) in anonymous class member","body":"<p>is it possible to use dash (-) in a member name of an anonymous class? I'm mainly interested in this to use with asp.net mvc to pass custom attributes to html-helpers, since I want my html to pass html5-validation, this starting with data-.</p>\n\n<p>Exemple that doesn't work:</p>\n\n<pre><code>&lt;%=Html.TextBoxFor(x =&gt; x.Something, new {data-animal = \"pony\"})%&gt;\n</code></pre>\n\n<p>Putting a @ in front of the member name doesn't do the trick either.</p>\n\n<p>Update: If this isn't possible, is there a recommended way todo what I want? My current temporary solution is to add a replace to the whole thing like this:</p>\n\n<pre><code>&lt;%=Html.TextBoxFor(x =&gt; x.Something, new {data___animal = \"pony\"}).Replace(\"___\", \"-\")%&gt;\n</code></pre>\n\n<p>But that sucks, because it's ugly and will break when <code>Model.Something</code> contains three underscores. Buhu.</p>\n"},{"tags":[".net","visual-studio-2010","c#-4.0","crystal-reports-server"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13193746,"title":"Crystal Server .NET integration Enterprise ReportDocument.Load Exception","body":"<p>I'm using Visual Studio 2010 with the various required plugins installed to communicate with SAP Crystal Server 2011.  Everything is working fine and I can query data (e.g. return a list of folders within a folder) with no problems.</p>\n\n<p>I'm trying to integrate this with the CrystalReportViewer component which appears to be working until I attempt to load the returned InfoObject into ReportDocument.Load.  It always returns:</p>\n\n<p><em>Unknown error 0x80040200.</em></p>\n\n<p>Any ideas would be greatly appreciated.  I'm at a bit of a loss.  Other suggestions for how to do this I'll take on board as well.</p>\n\n<p>Just to clarify.  The Logon works fine, InfoObject is valid (the Response.Write returns the correct ID and Title of the Report).</p>\n\n<pre><code>SessionMgr ceSessionMgr = new SessionMgr();\nEnterpriseSession ceSession = ceSessionMgr.Logon(ConfigurationManager.AppSettings[\"CrystalUser\"].ToString(), ConfigurationManager.AppSettings[\"CrystalPassword\"].ToString(), ConfigurationManager.AppSettings[\"CrystalServer\"].ToString(), \"Enterprise\");\nEnterpriseService ceEnterpriseService = ceSession.GetService(\"\", \"InfoStore\");\nInfoStore ceInfoStore = new InfoStore(ceEnterpriseService);\n\nPluginManager cePluginMgr = ceInfoStore.PluginManager;\nPluginInfo ceReportPlugin = cePluginMgr.GetPlugins(\"Desktop\")[\"CrystalEnterprise.Report\"];\n\nInfoObjects ceInfoObjects = ceInfoStore.Query(\"SELECT * FROM CI_INFOOBJECTS WHERE SI_PROGID='CrystalEnterprise.Report' AND SI_ID=\" + Convert.ToInt32(Request[\"ReportID\"]));\n\nInfoObject ceInfoObject = ceInfoObjects[1];\n\nResponse.Write(ceInfoObject.ID.ToString() + \" = \" + ceInfoObject.Title + \"&lt;br/&gt;\");\n\nCrystalDecisions.CrystalReports.Engine.ReportDocument ceReportDocument = new CrystalDecisions.CrystalReports.Engine.ReportDocument();\nceReportDocument.Load(ceInfoObject, ceSession);\n\nCrystalReportViewer1.Visible = true;\nCrystalReportViewer1.EnterpriseLogon = ceSession;\nCrystalReportViewer1.ReportSource = ceReportDocument;\n</code></pre>\n"},{"tags":["c#",".net","oracle","sqlcommand"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13235392,"title":"Optional sql command parameters with Oracle Client","body":"<p>I'm trying to feed sqlcommand with more parameters than it uses. Because of that I'm getting exception ORA 01036. The description leads me to a fact that I can only pass parameters that will actually be used in the query.</p>\n\n<p>I cannot find it anywhere - is it really true? It seems pretty stupid and limited to me...</p>\n"},{"tags":["c#",".net","asp.net","vb.net","iis"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":729,"score":1,"question_id":3738439,"title":"ASP.NET Development Server permissions and Network Resources","body":"<p>My ASP.NET 4.0 Web App is unable to access Network Printers, while debugging on VS 2010.  It can access local printers.  Seems like it may be a permissions issue.  Since VS2010 Debugging runs on ASP.NET Development Server, it must be running under the account I used to log into Windows, right?  Does that user need to be added as an Admin in that printers users? Is there any account that I can impersonate to get this working? </p>\n"},{"tags":[".net","sql","intersect"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13234872,"title":"Intersect between some DbGeography elements doesn´t work with Entity Framework 5","body":"<p>What is wrong with that?</p>\n\n<pre><code>const string lonMin=\"-19\";      \nconst string latMin = \"25\";\nconst string lonMax = \"-24\";\nconst string latMax = \"25.6\";\n\n//Create a polygon\nvar geoEncuadre = DbGeography.FromText(\"POLYGON ((\" + lonMin + \" \" + latMin + \",\" +\n            lonMax + \" \" + latMin + \",\"+ lonMax + \" \"+ latMax +\",\"+lonMin+\" \" + latMax +\",\"+lonMin + \" \"+latMin +  \"))\", 4326);\n//Check for every node if intersects with the polygon\nvar nodos = (from n in _bd.Nodo\n             where n.Geo.Intersects(geoEncuadre)\n             select n).ToList();\n</code></pre>\n\n<p>This throws an <code>EntityCommandExecutionException</code>. It´s weird because if I use <em>DbGeometry</em> instead <em>DbGeography</em> it works fine. \nWhat happen with the <em>DbGeography</em> and the <em>Intersect</em> operation?</p>\n"},{"tags":["c#",".net","list","collections"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1445,"score":2,"question_id":7340757,"title":"C# List - Removing items while looping / iterating","body":"<p>Suppose that I have the following code snippet:</p>\n\n<pre><code>var data=new List&lt;string&gt;(){\"One\",\"Two\",\"Three\"};\nfor(int i=0 ; i&lt;data.Count ; i++){\n  if(data[i]==\"One\"){\n    data.RemoveAt(i);\n  }\n}\n</code></pre>\n\n<p>The following code throws exception.</p>\n\n<p>My question is what is the best way to avoid this exception and to remove the element while looping?</p>\n"},{"tags":["c#",".net","web-services","cassini"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1776,"score":2,"question_id":1164356,"title":"How can I configure Cassini web server to accept requests to different hosts?","body":"<p>See duplicate: <a href=\"http://stackoverflow.com/questions/1133615/customizing-the-cassini-webserver\">Customizing the cassini webserver</a> </p>\n\n<p><hr /></p>\n\n<p>I have a web service hosted using Cassini web server. It works fine if I reference it by localhost, but when I use my machine's name (even using the browser locally), I get:</p>\n\n<pre><code>Server Error in '/' Application.\nHTTP Error 403 - Forbidden.\nVersion Information: Cassini Web Server 1.0.40305.0\n</code></pre>\n\n<p>How can I configure it to accept all requests?</p>\n"},{"tags":["c#","asp.net",".net","database","razor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12799339,"title":"A form for each WebGrid row","body":"<p>I have a WebGrid. Now, I would like to let the user edit a quantity in each Column row.</p>\n\n<p>Sine I have little experience with jQuery and AJAX, I would like to do this with just HTML/C#. So I was thinking, the simplest way would be to have a form for each row.</p>\n\n<p>The WebGrid may have hundreds, if not thousands of rows.</p>\n\n<p>Is this common practice? Is there a better way?</p>\n"},{"tags":["c#",".net","wcf","compression"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":54,"score":2,"question_id":13230910,"title":"Compress all traffic to WCF","body":"<p>We have a couple of WCF (data) services. Because few of our clients are connecting to those services via a terrible network connection, we would like to assure that <strong>ALL</strong> traffic is compressed. So, we would like to compress each request and response to the server <strong>automatically</strong>.</p>\n\n<p>We use IIS 8 right now and <strong>.NET 4+</strong>.</p>\n\n<p>How can we do that in the most natural way? (Via XML configs etc.)</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010","class"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13233431,"title":"how to access winform components from another class?","body":"<p>i have a form with one button and two labels</p>\n\n<p>and i have a separate class called myCounter</p>\n\n<p>i want the myCounter class to be able to access the labels in the form \nthrough a method called changeColor..</p>\n\n<p>how can make the labels available in this class</p>\n\n<p>the form </p>\n\n<pre><code>public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        public Color colTurn\n        {\n            get { return lblp1Turn.BackColor; }\n            set { lblp1Turn.BackColor = value; }\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n        }\n    }\n</code></pre>\n\n<p>the class </p>\n\n<pre><code>class myCounter\n{\n    private readonly Form1 Board;\n    public myCounter(Form1 Board)\n    {\n        this.Board = Board;\n    }\n\n    public int turn = 0;\n\n\n    public void changeColor()\n    {\n\n        if (turn == 0)\n        {\n            turn = 1;\n            lbl\n\n           //change color code here\n        }\n    }\n}\n</code></pre>\n"},{"tags":["asp.net",".net","session","httpcontext"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13161335,"title":"In what situations the HttpContext.Current.Session can be null?","body":"<p>In what situations the HttpContext.Current.Session can be null?</p>\n\n<p>I'm having some asp.net pages.</p>\n\n<p>I'm just wondering why I should be checking the Session object against null always?</p>\n\n<p>e.g.</p>\n\n<pre><code>public static object GetSession(string key)\n{\n\nif (HttpContext.Current.Session != null)\n{\n\nreturn HttpContext.Current.Session[key];\n\n}\n\nreturn null;\n\n}\n</code></pre>\n\n<p>Many thanks,</p>\n"},{"tags":["c#",".net","windows-phone-7","application-settings"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13234131,"title":"Do I need to call IsolatedStorageSettings.Save method in windows phone application?","body":"<p>From the remarks section of <a href=\"http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragesettings.save%28v=vs.95%29.aspx\" rel=\"nofollow\">IsolatedStorageSettings.Save Method</a> page:</p>\n\n<blockquote>\n  <p>Data written to the IsolatedStorageSettings object is saved when the\n  application that uses the class is closed. This can occur when the\n  user closes the Web browser, refreshes a page, or browses away from\n  the page. If you want your application to write to isolated storage\n  immediately, you can call the Save method in application code.</p>\n</blockquote>\n\n<p>So, I can never call the <code>Save</code> method and every setting will be in safety. I'm just curious in what usecases should I use the <code>Save</code> method?</p>\n"},{"tags":[".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13233520,"title":"SubmitChanges() immediately followed by a stored procedure","body":"<p>When I'm executing a stored procedure after a <code>SubmitChanges()</code>, the stored procedure is executed before the <code>SubmitChanges()</code> is completed.</p>\n\n<p>The function is supposed to migrate data from another server (so there are a lot of inserts going on). First, I call a stored procedure that disables the triggers on the given tables, then I do the inserts, then I enable the triggers again.</p>\n\n<p>The code looks like:</p>\n\n<pre><code>dc.DisableTriggers();    //Stored procedure (works fine)\n//... Procedure to insert all the data in the DataContext\ndc.MyClass.InsertOnSubmit(myClass);\n//...\ndc.SubmitChanges();      //All the data is inserted into tables.\ndc.EnableTriggers();     //Stored procedure (triggers are enabled before the end of all inserts)).\n</code></pre>\n\n<p><br />\nStored procedure:<br /></p>\n\n<pre><code>//DisableTriggers\nDisable trigger [triggerName] on tableName;    //Disabling on 5 tables\n\n//EnableTriggers\nEnable trigger [triggerName] on tableName;     //same tables as DisableTriggers\n</code></pre>\n\n<p><br />\nIf I put a breakpoint after <code>SubmitChanges()</code> and wait a second before restarting, everything works fine.</p>\n\n<p>If I set a timer after <code>SubmitChanges()</code>, triggers are enabled before the end of all inserts.</p>\n\n<p>I did some testing and if I bind the <code>SubmitChanges()</code> on a button and the <code>dc.EnableTriggers()</code> on another button, everything works fine.</p>\n\n<p>Unfortunately, I would need it to be all automated.</p>\n\n<p>I am using C# .net 4.0.</p>\n"},{"tags":[".net","frameworks","serial-port","delphi-prism","winmm"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13234420,"title":"Are there any .NET replacement for timeBeginPeriod and timeEndPeriod methods?","body":"<p>I've been working on a program that communicates on SerialPort and having problem with it. It's communication is below 50% or less. If not, it times out most of the time. </p>\n\n<p>From my research into this issue, I found out that global or system timer resolution by default is minimum 10ms or greater. </p>\n\n<p><a href=\"http://stackoverflow.com/questions/6139026/serial-communication-rts-and-windows-7\">Serial Communication (RTS) and Windows 7</a></p>\n\n<p>So, if you are using Thread.Sleep in your communication to pause for X number of milliseconds, the best it can do is 10ms or greater for a no-op or pause. </p>\n\n<p>In my case, that is too long for my program to communicate with an external device. The device replies back within 10ms as soon as it gets a request from my program. If my program is not ready to receive the answer back, then my program will time out.</p>\n\n<p>The only way to solve this issue is to adjust or alter the system timer resolution. To do that I was told to use Windows methods timeBeginPeriod and timeEndPeriod from winmm.dll. Although I am able to import these methods for my Windows .NET version of my program, I would like to know if there is any replacement for these methods in .NET frameworks.</p>\n\n<p>Thanks in advance,</p>\n"},{"tags":[".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13234045,"title":"How to open xps document by clicking to link in another xps document","body":"<p>I'm writing a help system for some application. This help system works with xps document. My program shows xps document with <code>documentviewer</code>. Xps document should link to another xps. When user will press to link <code>documentviewer</code> should show another xps document. I tried to use Google but I didn't find anything. Have you any idea how I can do that?</p>\n"},{"tags":["c#",".net","winforms","events"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13233253,"title":"Load like event in Windows Forms for any control like textbox, checkbox?","body":"<p>In Windows Forms when a UserControl or Form first time becomes visible the Load event is fired.</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.load.aspx\" rel=\"nofollow\">http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.load.aspx</a></p>\n\n<p>Is there any such event for controls like Checkbox, TextBox, Label ?</p>\n"},{"tags":["c#",".net","sql-server","sql-server-2008-r2","clr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13066021,"title":"What .Net assemblies are integrated into the SQL Server 2008 R2 CLR as standard?","body":"<p>I have an existing assembly that has been used within SQL Server for some time. Today I added some experimental code that references <code>System.Data.Linq</code>. Creating the assembly within <strong>SQL 2008 R2</strong> resulted in this error:</p>\n\n<blockquote>\n  <p><em>Assembly 'system.data.linq, version=3.5.0.0, culture=neutral, publickeytoken=b77a5c561934e089.' was not found in the SQL catalog.</em></p>\n</blockquote>\n\n<p>This is not entirely unexpected, but I was wondering how to determine what the full set of standard '<strong>core</strong>' assembles is within 2008 R2. Presumably <code>System.Data.Linq</code> isn't one of them - but I would like to confirm this and also confirm what assemblies are provided as standard.</p>\n"},{"tags":[".net","networking","stream"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":391,"score":1,"question_id":450816,"title":"Testing if NetworkStream is closed","body":"<p>I have a class, that wrapps a Stream instance, so I can use it for wrapping FileStreams and NetworkStreams. Now, I want to test if the stream is still delivering any data, in other words, I want to test the NetworkStream if it is still connected or the FileStream if it reached its end.</p>\n\n<p>Is there any function whose return value I can use to determine if the next Stream.Read() will cause an exception?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":[".net","teamcity"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13221340,"title":"How to include dependencies outside solution directory in .NET project for TeamCity","body":"<p>I have class library outside my solution directory, so I have reference like this in *.sln file \"../SomeDependency.csproj\"\nIn VS everything is ok, but TeamCity failed when try to build my solution. I guess it copy all solution directory so relation doesn't exists any more.</p>\n\n<p>This is error I had\nC:\\TeamCity\\buildAgent\\work\\799db5684a98650b\\blablabla.sln.metaproj error MSB3202: The project file \"C:\\TeamCity\\buildAgent\\work\\799db5684a98650b....\\Shared\\Libraries\\mysecretlib‌​rary\\mysecretlibrary.csproj\" was not found.</p>\n"},{"tags":[".net","active-directory"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13234506,"title":"How to find out a user's previous Active Directory usernames?","body":"<p>I'm working on a user permissions system for an internal admin webapp. I had the idea to use user's ActiveDirectory guids to match permissions with users instead of using their usernames. This is done in case they change their username - I've been assured this will happen often enough.</p>\n\n<p>Then I started to wonder: instead of worrying about the guid and using it to resolve their username, does ActiveDirectory keep a record of previous usernames?</p>\n\n<p>If it did, when an unknown user tries to connect, we can check if their previous username has permissions set up and update the database with their username automatically.</p>\n"},{"tags":[".net","dll","wix","dtf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":747,"score":1,"question_id":3887964,"title":"MakeSfxCA.exe and DLL compiled with Framework 4.0","body":"<p>I have a dll file compiled with Microsoft .NET Framework 4.0</p>\n\n<p>When I am using MakeSfxCA.exe file and passing the dll as one of the parameter to command line it gives me following error message:</p>\n\n<pre>\nD:\\SetupManager\\test>D:\\SetupManager\\SetupBuilding\\Wix\\bin\\sdk\\makesfxca.exe Fil\ne2.dll D:\\SetupManager\\SetupBuilding\\Wix\\bin\\sdk\\x86\\sfxCA.dll File1.dll CustomA\nction.config\nSearching for custom action entry points in File1.dll\nError: System.BadImageFormatException: Could not load file or assembly 'file:///\nD:\\SetupManager\\test\\File1.dll' or one of its dependencies. **This assembly is bui\nlt by a runtime newer than the currently loaded runtime and cannot be loaded.**\nFile name: 'file:///D:\\SetupManager\\test\\File1.dll'\n   at System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase,\nEvidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boo\nlean throwOnFileNotFound, Boolean forIntrospection)\n   at System.Reflection.Assembly.nLoad(AssemblyName fileName, String codeBase, E\nvidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Bool\nean throwOnFileNotFound, Boolean forIntrospection)\n   at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence\n assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)\n   at System.Reflection.Assembly.InternalLoadFrom(String assemblyFile, Evidence\nsecurityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean\n forIntrospection, StackCrawlMark& stackMark)\n   at System.Reflection.Assembly.ReflectionOnlyLoadFrom(String assemblyFile)\n   at Microsoft.Deployment.Tools.MakeSfxCA.MakeSfxCA.FindEntryPoints(String modu\nle)\n   at Microsoft.Deployment.Tools.MakeSfxCA.MakeSfxCA.Build(String output, String\n sfxdll, IList`1 inputs, TextWriter log)\n   at Microsoft.Deployment.Tools.MakeSfxCA.MakeSfxCA.Main(String[] args)\n\n=== Pre-bind state information ===\nLOG: User = DSDMAIN\\Rajesh\nLOG: Where-ref bind. Location = D:\\SetupManager\\test\\File1.dll\nLOG: Appbase = file:///D:/SetupManager/SetupBuilding/Wix/bin/sdk/\nLOG: Initial PrivatePath = NULL\nCalling assembly : (Unknown).\n===\nLOG: This is an inspection only bind.\nLOG: No application configuration file found.\nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework\\v2\n.0.50727\\config\\machine.config.\nLOG: Attempting download of new URL file:///D:/SetupManager/test/File1.dll.\nERR: Failed to complete setup of assembly (hr = 0x8013101b). Probing terminated.\n</pre>\n\n<p>Any help is appreciated.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":455,"score":7,"question_id":4553234,"title":"sending ping with specific bytes amount using c#","body":"<p>how can i send a ping request with a specific size of bytes, the same as determining the\n-l when sending ping through the command line.\ncan you give me an example?</p>\n\n<p>also can i determine the amount of packets that the ping sends? like the -n on the command line.</p>\n\n<p>thanks :)</p>\n"},{"tags":["c#",".net","silverlight","web-applications"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13234500,"title":"How to load fonts dynamically?","body":"<p>In Silverlight 4, I have the following (list of fonts is actually much shorter for the purpose of this post):</p>\n\n<pre><code>private static ObservableCollection&lt;FontFamily&gt; colFontFamilies = new ObservableCollection&lt;FontFamily&gt;()\n{\n     new FontFamily(\"/PrintVites;component/Fonts/Fonts.zip#Trajan Pro\"),\n     new FontFamily(\"/PrintVites;component/Fonts/Fonts.zip#Futura Std Light\"),\n     new FontFamily(\"/PrintVites;component/Fonts/Fonts.zip#GeosansLight\")\n};\n</code></pre>\n\n<p>These are currently embedded fonts. How can I use the WebClient object to load these asynchronously after the application loads? Do I have to put them in a zip file, or can I load each font file separately?</p>\n"},{"tags":["c#",".net","linq","include"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13233924,"title":"How to include sorted navigation properties with Entity Framework","body":"<p>I have an entity <code>A</code> with a collection of <code>B</code> inside. I load them with a <code>_entity.A.Include(a =&gt; a.B)</code></p>\n\n<p>Now I want to have the B's into A sorted by a custom OrderBy. I tried <code>_entity.A.Include(a =&gt; a.B.OrderBy(o =&gt; o.Version)</code> but I get a :</p>\n\n<blockquote>\n  <p>The Include path expression must refer to a navigation property defined on the type. Use dotted paths for reference navigation properties and the Select operator for collection navigation properties.</p>\n</blockquote>\n\n<p>Any ideas on how to accomplish this?</p>\n\n<p>Thanks.</p>\n\n<p>Version is an integer.</p>\n"},{"tags":["c#",".net","visual-studio-2010","c#-4.0","dataset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13160794,"title":"how to use IN clause in visual c# 2010 dataset?","body":"<p>i have made a dataset and need to use <strong>IN</strong> clause like the below example  </p>\n\n<p>here is my query:</p>\n\n<pre><code>select field1,field2 from tablename where id **IN** (@ids)  \n</code></pre>\n\n<p>the number of id parameter is not fixed and changes every time for the above query</p>\n\n<p>now i want to use it in dataset.</p>\n\n<p>i don't know how to use it</p>\n\n<p>i need to use IN in Visual Studio 2010 Dataset Environment.</p>\n\n<p>i want to know how can i replace @ids with 1,2,3,4,...?</p>\n"},{"tags":["c#",".net","ocr"],"answer_count":6,"favorite_count":4,"up_vote_count":11,"down_vote_count":0,"view_count":6632,"score":11,"question_id":870280,"title":"OCR for .NET","body":"<p>I need an OCR component for .NET.I read all questions about it at SO,but I couldn't find what I needed.</p>\n\n<p>The MODI function from MS Office 2007 OCR makes the deployment of my program impossible,because all of my users must have MS Office 2007 on their computers.</p>\n\n<p>Is there a way to use the OCR from MS Office without the requirement to have Office installed?</p>\n\n<p>If there is not then I'm asking for another OCR component.</p>\n"},{"tags":[".net","iis","load-balancing","windows-server-2008-r2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13234381,"title":"Add Machine Key to machine.config in Load Balancing environment to multiple versions of .net framework","body":"<p>I have two web servers behind a F5 load balancer. Each web server has identical applications to the other. There was no issue until the config of the load balancer changed from source address persistence to least connections.</p>\n\n<p>Now in some applications I receieve this error</p>\n\n<blockquote>\n  <h2>    Server Error in '/' Application.</h2>\n  \n  <p>Validation of viewstate MAC failed. If this application is hosted by a\n  Web Farm or cluster, ensure that  configuration specifies\n  the same validationKey and validation algorithm. AutoGenerate cannot\n  be used in a cluster.  Description: An unhandled exception occurred\n  during the execution of the current web request. Please review the\n  stack trace for more information about the error and where it\n  originated in the code. </p>\n  \n  <p>Exception Details: System.Web.HttpException: Validation of viewstate\n  MAC failed. If this application is hosted by a Web Farm or cluster,\n  ensure that  configuration specifies the same\n  validationKey and validation algorithm. AutoGenerate cannot be used in\n  a cluster.</p>\n  \n  <p>Source Error: </p>\n  \n  <p>The source code that generated this unhandled exception can only be\n  shown when compiled in debug mode. To enable this, please follow one\n  of the below steps, then request the URL:</p>\n  \n  <ol>\n  <li><p>Add a \"Debug=true\" directive at the top of the file that generated the error. Example:</p>\n  \n  </li>\n  </ol>\n  \n  <p>or:</p>\n  \n  <p>2) Add the following section to the configuration file of your\n  application:</p>\n  \n  <p>    \n              </p>\n  \n  <p>Note that this second technique will cause all files within a given\n  application to be compiled in debug mode. The first technique will\n  cause only that particular file to be compiled in debug mode.</p>\n  \n  <p>Important: Running applications in debug mode does incur a\n  memory/performance overhead. You should make sure that an application\n  has debugging disabled before deploying into production scenario.</p>\n</blockquote>\n\n<p>How do I add a machine key to the machine.config file? Do I do it at server level in IIS or at website/application level for each site? Does the validation and decryption keys have to be the same across both web servers or are they different? Should they be different for each machine.config version of .net?</p>\n\n<p>I cannot find any documentation of this scenario.</p>\n"},{"tags":["c#",".net","compact-framework","ping","lan"],"answer_count":0,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13233808,"title":"Get all IP-Hosts in Lan from mobile device","body":"<p>I want to get a list with all ip-addresses in my network, on a mobile device (C#.net compact framework).</p>\n\n<p>I read through several articles like <a href=\"http://stackoverflow.com/questions/4042789/how-to-get-ip-all-hosts-in-lan\">this</a> one. The problem is, that on my mobile device I can't ping them async cause I only have opennetcf which doesn't support it. And pinging it synchron takes too long.</p>\n\n<p>Do you know a library which does this or do you know, how I can find out all hosts in my network, maybe even without pings (which is quite slow)</p>\n\n<p>The port doesn't matter, I just want to know, which IPs are used...</p>\n\n<p>Thank you, Karl</p>\n"},{"tags":["c#",".net","wcf","azure","wif"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13226508,"title":"Error while accessing Custom STS(WCF Service) on Azure","body":"<p>I've a custom STS having active federation endpoint that works well on local box. \nLocal Url is \"https://localhost/CustomIDP/Service.svc\"</p>\n\n<p>After hosting on Azure on the final step of acquiring SAML token I am getting the following error:</p>\n\n<p>[System.ServiceModel.CommunicationException] \n{\"An error occurred while receiving the HTTP response to \"https://<em>mysts</em>.cloudapp.net/Service.svc\". This could be due to the service endpoint binding not using the HTTP protocol. This could also be due to an HTTP request context being aborted by the server (possibly due to the service shutting down). See server logs for more details.\"}</p>\n\n<p>InnerException:\n[System.Net.WebException]: {\"The underlying connection was closed: An unexpected error occurred on a receive.\"}</p>\n\n<p>InnerException:\n[System.IO.IOException]:{\"Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.\"}</p>\n\n<p>InnerException:\n[System.Net.Sockets.SocketException]: {\"An existing connection was forcibly closed by the remote host\"}:    at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)\n   at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)    </p>\n\n<p>Appreciate any inputs. Please find below the code snippet used. The error occurs at channel.Issue statement.</p>\n\n<pre><code>        using (var factory = new WSTrustChannelFactory(\n            new UserNameWSTrustBinding(SecurityMode.TransportWithMessageCredential),\n            new EndpointAddress(new Uri(stsEndpoint))))\n        {\n            factory.Credentials.UserName.UserName = username;\n            factory.Credentials.UserName.Password = password;\n            factory.TrustVersion = TrustVersion.WSTrust13;\n\n            WSTrustChannel channel = null;\n\n            try\n            {\n                var rst = new RequestSecurityToken\n                              {\n                                  RequestType = WSTrust13Constants.RequestTypes.Issue,\n                                  AppliesTo = new EndpointAddress(realm),\n                                  KeyType = KeyTypes.Bearer,\n                              };\n\n                channel = (WSTrustChannel)factory.CreateChannel();\n\n                return channel.Issue(rst);\n            }\n            finally\n            {\n                if (channel != null)\n                {\n                    channel.Abort();\n                }\n\n                factory.Abort();\n            }\n        }\n</code></pre>\n\n<p>Service Configuration:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service name=\"Microsoft.IdentityModel.Protocols.WSTrust.WSTrustServiceContract\" behaviorConfiguration=\"ServiceBehavior\"&gt;\n        &lt;endpoint address=\"\" binding=\"ws2007HttpBinding\" contract=\"Microsoft.IdentityModel.Protocols.WSTrust.IWSTrust13SyncContract\"  bindingConfiguration=\"ws2007HttpBindingConfiguration\"/&gt;\n        &lt;endpoint address=\"mex\" binding=\"mexHttpsBinding\" contract=\"IMetadataExchange\" /&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;bindings&gt;\n      &lt;ws2007HttpBinding&gt;\n        &lt;binding name=\"ws2007HttpBindingConfiguration\"&gt;\n          &lt;security mode=\"TransportWithMessageCredential\"&gt;\n            &lt;message clientCredentialType=\"UserName\" establishSecurityContext=\"false\" /&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/ws2007HttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"ServiceBehavior\"&gt;\n          &lt;serviceMetadata httpsGetEnabled=\"true\" /&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"false\" /&gt;\n          &lt;serviceCredentials&gt;\n            &lt;serviceCertificate x509FindType=\"FindByThumbprint\" findValue=\"[thumbprint]\" storeLocation=\"LocalMachine\" storeName=\"My\" /&gt;\n          &lt;/serviceCredentials&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n  &lt;/system.serviceModel&gt;\n\n  &lt;microsoft.identityModel&gt;\n    &lt;service&gt;\n      &lt;!-- User name and password are not authenticated by windows authentication but a custom verification is done --&gt;\n      &lt;securityTokenHandlers&gt;\n        &lt;remove type=\"Microsoft.IdentityModel.Tokens.WindowsUserNameSecurityTokenHandler, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n        &lt;add type=\"ActiveIdPSite.CustomUserNameSecurityTokenHandler, ActiveIdPSite\" /&gt;\n      &lt;/securityTokenHandlers&gt;\n      &lt;serviceCertificate&gt;\n        &lt;certificateReference x509FindType=\"FindByThumbprint\" findValue=\"[thumbprint]\" storeLocation=\"LocalMachine\" storeName=\"My\" /&gt;\n      &lt;/serviceCertificate&gt;\n      &lt;certificateValidation certificateValidationMode=\"None\" /&gt;\n    &lt;/service&gt;\n  &lt;/microsoft.identityModel&gt;\n</code></pre>\n"},{"tags":["c#",".net","microsoft","enterprise-library"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":151,"score":1,"question_id":6979659,"title":"Enterprise Library Section Error","body":"<p>Everytime when I open my Solution that is using the Enterprise Library from Microsoft I get this error after building or opening my app.config.</p>\n\n<p><img src=\"http://i.stack.imgur.com/VYoqy.png\" alt=\"enter image description here\"></p>\n\n<p>After this Message my Visual Studio is shutting down ! My Configuration hasn't changed for a year and I only got this error just since a few days. I don't know where it comes from and why VS is shutting down after this Message ...</p>\n\n<p>Anyone knows this error maybe ?</p>\n\n<p>My Config looks like this :</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;section name=\"enterpriselibrary.configurationSettings\" type=\"System.Configuration.IgnoreSectionHandler, System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=.....\" /&gt;\n&lt;/configSections&gt;\n&lt;enterpriselibrary.configurationSettings xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" applicationName=\"....\" xmlns=\"http://www.microsoft.com/practices/enterpriselibrary/08-31-2004/configuration\"&gt;\n  &lt;configurationSections&gt;\n    &lt;configurationSection xsi:type=\"ReadOnlyConfigurationSectionData\" name=\"dataConfiguration\" encrypt=\"true\"&gt;\n      &lt;storageProvider xsi:type=\"XmlFileStorageProviderData\" name=\"XML File Storage Provider\" path=\"......\" /&gt;\n      &lt;dataTransformer xsi:type=\"XmlSerializerTransformerData\" name=\"Xml Serializer Transformer\"&gt;\n        &lt;includeTypes /&gt;\n      &lt;/dataTransformer&gt;\n    &lt;/configurationSection&gt;\n  &lt;/configurationSections&gt;\n  &lt;keyAlgorithmStorageProvider xsi:type=\"FileKeyAlgorithmPairStorageProviderData\" name=\"File Key Algorithm Storage Provider\" path=\"....\"&gt;\n    &lt;dpapiSettings xsi:nil=\"true\" /&gt;\n  &lt;/keyAlgorithmStorageProvider&gt;\n  &lt;includeTypes /&gt;\n&lt;/enterpriselibrary.configurationSettings&gt;\n</code></pre>\n"},{"tags":["c#",".net","formatting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13234040,"title":"reusing code that Formats Objects for display","body":"<p>I have a list of objects that are instances of a class.\nI want to format them for display and i want the code that formats the display to be reusable.\nSo it can be used in a .aspx page and when exporting the data to excel.</p>\n\n<p>I started off creating a function that returns an anonymous class object with all the fields of the class formatted.</p>\n\n<pre><code>public Object GetForDisplay()\n        {\n            return new\n            {\n                RecordNum,\n                ID,\n                Value = Value.HasValue?  Value.Value.ToString(\"0.##\"): \"-\",\n                ...\n            };\n        }\n</code></pre>\n\n<p>But this did not allow me to access the properties when i needed slight changes in them.</p>\n\n<p>My next try was to return a <code>Dictionary&lt;String,Object&gt;</code> with all the fields (The string being the field name).</p>\n\n<pre><code>public Dictionary&lt;String, Object&gt; GetForDisplay()\n        {\n            return new Dictionary&lt;String, Object&gt;\n            {\n                {\"RecordNum\", RecordNum},\n                { \"ID\", ID },\n                { \"Value \",  Value.HasValue?  Value.Value.ToString(\"0.##\"): \"-\"},\n             }\n}\n</code></pre>\n\n<p>I was wondering if there is a better way of doing this? would you create a new class just to hold the formatted data?</p>\n"},{"tags":[".net","windows-8","visual-studio-2012","resharper-7.0"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13232770,"title":"ReSharper wont function properly in Visual Studio 2012 running on Windows 8","body":"<p>I installed Visual Studio 8 on Windows 8 with Resharper 7.0.1, and I have some problems getting Resharper to function properly. It seems most of ReSharper does not work, but here is some of the strange behaviour I have noticed:</p>\n\n<ul>\n<li>Clicking <code>Ctrl-Shift+T</code> opens up the select file or folder dialog, but when I select a file from here and click enter the dialog closes, but the file is not opened up</li>\n<li><code>Ctrl+R+R</code> (rename) gives the message that the key is bound to Resharper Rename, but that it is not currently available, even when the cursor is inside a variable in a standard .cs file, and the program is not debugging.</li>\n<li>Alt+Enter does nothing, so the context menu does not pop up at all anywhere.</li>\n</ul>\n\n<p>Does anyone know if ReSharper is not supposed to work under Win 8, or is it something that is messed up on my machine? In that case what?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Notices that code analysis isn't working either. So that \"bar\" on the right hand side of the code windows that displays the green. yellow and red lines to indicate problems is not there.</p>\n"},{"tags":[".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":12,"score":-1,"question_id":13233362,"title":"How to disable/customize the Visual Studio Conversion Wizard window","body":"<p>Regarding : Want to implement my own tool same as \"Microsoft Visual studio conversion wizard 2010\"</p>\n\n<p>So please share experience with me below:</p>\n\n<ol>\n<li>Any way to customize Microsoft visual studio conversion wizard 2010</li>\n<li>Where are API's for implement the same tool \"Microsoft visual studio conversion wizard\" (It is more beneficial to me if provide)</li>\n<li>how can Hide wizard and run process internally in background.</li>\n</ol>\n"},{"tags":["c#",".net","winforms","datagridview","combobox"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2485,"score":1,"question_id":6799296,"title":"Set default value in DataGridView combo box","body":"<p>I'm using <code>DataGridView</code> in windows form to allow the user to add n numbers of rows with values enter by the user. One of the column of <code>DataGridView</code> contains combo box, which is displaying its items by using database.</p>\n\n<p>I'm using the following code in Load event to connect <code>DataGridViewComboBox</code> with database :</p>\n\n<pre><code>private void PurchaseMaster_Load(object sender, EventArgs e)\n{\n    DataTable dt = itemBAL.GetTable();\n    bindingSource1.DataSource = dt;\n    ItemName.DataSource = bindingSource1;\n    ItemName.DisplayMember = \"Name\";\n    ItemName.ValueMember = \"ItemId\";\n    ItemName.DataPropertyName = \"ItemId\";\n    ItemName.AutoComplete = true;\n    ItemName.DefaultCellStyle.NullValue = dt.Rows[0][1].ToString();\n    ItemName.DefaultCellStyle.DataSourceNullValue = dt.Rows[0][0].ToString();\n}\n</code></pre>\n\n<p>But whenever I not select any value from <code>DataGridViewComboBox</code> and click on save button I find <code>null</code> value in the table corresponding to <code>DataGridViewComboBox</code> value. </p>\n\n<pre><code>foreach (DataGridViewRow row in dataGridView1.Rows)\n{\n    if (row.IsNewRow)\n        continue;\n\n    DataRow dtRow = dt.NewRow();\n    for (int i = 0; i &lt; dataGridView1.Columns.Count; i++)\n        dtRow[i] = row.Cells[i].Value == null ? DBNull.Value : row.Cell[i].Value;\n    dt.Rows.Add(dtRow);\n}\n</code></pre>\n\n<p>Could anyone please tell me why I'm getting null value in database for <code>DataGridViewcombobox</code> defult value, despite of using <code>DataSourceNullValue</code> property?</p>\n"},{"tags":["c#",".net","silverlight","windows-phone-7"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":675,"score":2,"question_id":7792620,"title":"Message box with Image in WP7","body":"<p>Hi at present I am using a grid with Image and two Buttons for showing a custom message box in my WP7 application whose visibility is collapsed at first. All is working fine but I have to disable all the controls behind on the page when its visibility is visible. So its quite a overhead to enable/disable lots of control behind.</p>\n\n<p>Is there a better solution for my requirement which are :(1) To show a message box having image and two button or textbox and (2) It should appear in the middle of page.</p>\n\n<p>Thanks in advance!!</p>\n"},{"tags":["c#",".net","enums"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13203454,"title":"What can a person use instead of enum for an intellisense aware collection of strings?","body":"<p>Currently using an enum for a list of filenames in an application for the ability to use intellisense and to make sure the filename is one of the existing files (the enum prevents typos and having to remember each filename verbatim). There are currently 107 files in the enum. In order to get an audio file name the enum value ToString() method is used.</p>\n\n<p>Now there is a situation where there needs to be some filenames added based on the result of a database call. This isn't possible with an enum and will require a lot of application restructuring to implement (changing all methods that take an enum to take a string).</p>\n\n<p>What should have been done in the first place or is an enum the best option for this use case?</p>\n"},{"tags":[".net","microsoft","erp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13230968,"title":"Quickest and Easiest way to create ERP System","body":"<p>My organization needs to create an ERP system in 3 weeks. I came to know that such system can be created in ASP.NET, Microsoft Dynamics, PHP, JAVA based and a lot more system. I am really confused with so many options and there differences as which way to follow. Please tell me that what would be the best tool in which I an create this system as quickly and as easily as possible. All positive help is welcomed and thanks for your time.</p>\n"},{"tags":["c#",".net","json","json.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13232939,"title":"Conditional output processing in JSON.NET","body":"<p>Having the following class:</p>\n\n<pre><code>class Test {\n  [MyAttr]\n  public string Name;\n}\n</code></pre>\n\n<p>How can I extend <a href=\"http://json.codeplex.com/\" rel=\"nofollow\">JSON.NET</a> if I need to trim values of all properties marked with <code>MyAttr</code> to specific length? Seems I can't do that in custom <code>JsonConverter</code> as I need access to <code>MemberInfo</code> representing the origin property.</p>\n"},{"tags":["c#",".net","image"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":5,"view_count":44,"score":-4,"question_id":13233170,"title":"image cropping c#","body":"<p>I want to do image cropping.\nI saw following link.</p>\n\n<p><a href=\"http://www.switchonthecode.com/tutorials/csharp-tutorial-image-editing-saving-cropping-and-resizing\" rel=\"nofollow\">Image cropping</a></p>\n\n<p>But what i want to do is as follows.\nI want to crop the image calculating dimension from its centre.\nSo for example if my image is 100 px and cropping i want result to be 50 px.\ni want to leave 25 px each on left and right hand side and make the width 50 px.</p>\n\n<p>Has anyone done it before?</p>\n"},{"tags":["c#",".net","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13232589,"title":"Need some change on this regex","body":"<p>Im checking some strings with my regex and somehow its not perfect. Im not sure why. I would like to allow string with only these characters:</p>\n\n<ul>\n<li>A to Z </li>\n<li>0 to 9</li>\n<li>. </li>\n<li>%</li>\n<li>/</li>\n<li>{space}</li>\n<li>+</li>\n<li>$</li>\n</ul>\n\n<p>So I thought this regex should be enough:</p>\n\n<pre><code>Regex(\"[^A-Z0-9.$/+%\\\\- ]$\")\n</code></pre>\n\n<p>But with some string its not really working. I made a small example:</p>\n\n<pre><code>    static Regex regex = new Regex(\"[^A-Z0-9.$/+%\\\\- ]$\");\n\n    static void Main()\n    {\n        string s;\n\n        Console.WriteLine(\"check: \\n\");\n\n        s = \"?~=) 2313\";\n        Console.WriteLine(s + \": \" +IsValid(s));\n\n        s = \"ÄÜÖ\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        s = \"Ü~=) 2313\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        s = \"Ü 2313\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        s = \"~=) 2313 Ü\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        s = \"ÜÜÜ\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        s = \"~=)\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        s = \"THIS--STRING $1234567890$ SHOULD BE VALID.%/ +\";\n        Console.WriteLine(s + \": \" + IsValid(s));\n\n        Console.ReadKey();\n    }\n\n    public static bool IsValid(string input)\n    {\n        if (regex.IsMatch(input)) return false;\n        return true;\n    }\n</code></pre>\n\n<p>As output I get:</p>\n\n<p><img src=\"http://i.stack.imgur.com/sjAxS.jpg\" alt=\"enter image description here\"></p>\n\n<p>The 1.,3. and 4. are True, but this is wrong. What is wrong with my regex? Any ideas? Thank you</p>\n"},{"tags":["c#",".net","sql-server","smo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13229602,"title":"Using Smo in C# - skip constraint generating instructions at the beginning","body":"<p>I have to create a full copy of a remote db. I have only one useful and easy way to do it: by generating scripts. I am aware about other ways (create backup, for instance) but I can't use them for some reason.</p>\n\n<p>Since one table might be depend on another (has a foreign key, etc...) and because of this it's pretty difficult to figure out the valid order of creating tables, I decide to generate these \"dependable\" script instructions at the very end. </p>\n\n<p>Well, I know how to generate that \"dependable\" script instructions within (close to) table creation. But what should I do to skip them first only to generate them at the end?</p>\n\n<p>For instance:</p>\n\n<pre><code>--How I do NOT want\n--.........................\nCREATE TABLE Table1(....)\nALTER TABLE Table1 ADD CONSTRAINT ...\n\nCREATE TABLE Table2(....)\nALTER TABLE Table2 ADD CONSTRAINT ...\n\n\n\n--How I would like\n--.........................\nCREATE TABLE Table1(....)\nCREATE TABLE Table2(....)\n--.........................\nCREATE TABLE TableN(....)\n--.........................\n--the end of a script\nALTER TABLE Table1 ADD CONSTRAINT .....\n</code></pre>\n"},{"tags":["c#","asp.net",".net","vb.net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":38,"score":0,"question_id":13233022,"title":"asp.net error on remote server only","body":"<p>I get this error on my windows server 2003 server(64 bit).</p>\n\n<p>An unhandled exception occurred and the process was terminated. Event ID:1334</p>\n\n<p>While, application runs smoothly on my development machine(windows XP / Visual Studio 2008).</p>\n\n<p>Can anyone give me idea that can cause issue?</p>\n\n<p>Additional:\nI have used threads like below:</p>\n\n<pre><code> Dim thread1 As New Thread(New ThreadStart(AddressOf myProcess))\n                thread1.IsBackground = True\n                thread1.Start()\n</code></pre>\n\n<p>If I remove threads &amp; just execute </p>\n\n<pre><code>myProcess()\n</code></pre>\n\n<p>then it works fine.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","carriage-return","linefeed"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":167,"score":0,"question_id":11752272,"title":"Replace line feed (lf) with empty string without replacing lf in crlf C#","body":"<p>I wanted to replace any line feed (Lf) in a file with an empty string \"\". However, I don't want it to also replace the Lf in the CrLf one (end of line flag).</p>\n\n<p>I was thinking something like this:</p>\n\n<pre><code>fileContent.Replace(\"\\n\",\"\");\n</code></pre>\n\n<p>The line of code above will replace the Lf in CrLf to Cr, so I don't want that. Please give me some suggestion for a regular expression, which ignore the Lf in CrLf.</p>\n\n<p>Thanks a lot.</p>\n\n<p>PS: The logic changed. I used this:</p>\n\n<pre><code>fileContent = Regex.Replace(fileContent, @\"\\r\\n(?=&gt;)|(?&lt;!\\\"\"\\r)\\n\", \"\"); \n</code></pre>\n\n<p>to replace all the CrLf that appear after > with empty string (\"\") and replace all the line feeds (Lf) that not followed by \"Cr with empty string (\"\"). Is that correct? Thanks</p>\n"},{"tags":["c#",".net","64bit","registry","32bit"],"answer_count":4,"favorite_count":5,"up_vote_count":20,"down_vote_count":0,"view_count":5275,"score":20,"question_id":974038,"title":"Reading 64bit Registry from a 32bit application","body":"<p>I have a c# unit test project that is compiled for AnyCPU. Our build server is a 64bit machine, and has a 64bit SQL Express instance installed.</p>\n\n<p>The test project uses code similar to the following to identify the path to the .MDF files:</p>\n\n<pre><code>    private string GetExpressPath()\n    {\n        RegistryKey sqlServerKey = Registry.LocalMachine.OpenSubKey( @\"SOFTWARE\\Microsoft\\Microsoft SQL Server\\Instance Names\\SQL\" );\n        string sqlExpressKeyName = (string) sqlServerKey.GetValue( \"SQLEXPRESS\" );\n        RegistryKey sqlInstanceSetupKey = sqlServerKey.OpenSubKey( sqlExpressKeyName + @\"\\Setup\" );\n        return sqlInstanceSetupKey.GetValue( \"SQLDataRoot\" ).ToString();\n    }\n</code></pre>\n\n<p>This code works fine on our 32bit workstations, and did work ok on the build server until I recently enabled code coverage analysis with NCover. Because NCover uses a 32bit COM component, the test runner (Gallio) runs as a 32bit process.</p>\n\n<p>Checking the registry, there is no \"Instance Names\" key under HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Microsoft SQL Server</p>\n\n<p>Is there a way for an application running in 32bit mode to access the registry outside  Wow6432Node?</p>\n"},{"tags":[".net","sql","linq"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":155,"score":5,"question_id":5226928,"title":"Is it possible to see the SQL query of a LINQ command?","body":"<p>It would help me understand LINQ a little bit better that's all.</p>\n\n<p>I tried using the SQL Profiler but I'm not sure how I can get it to show the actual SQL commands.</p>\n"},{"tags":[".net","wpf",".net-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":44,"score":-2,"question_id":13232258,"title":"WPF application initialization status","body":"<p>Is it possible to know what application is currently doing during loading (initialization)? Similar to what we get in the output window.</p>\n"},{"tags":["c#",".net","sql","asp.net-mvc","asp.net-membership"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13224405,"title":"Update custom user profile fields with SimpleMembershipProvider?","body":"<p>I added a custom field to the <code>UserProfile</code> table named <code>ClassOfYear</code> and I'm able to get the data into the profile during registration like this:</p>\n\n<pre><code>var confirmationToken = WebSecurity.CreateUserAndAccount(model.UserName,\n    model.Password,\n    propertyValues: new { ClassOfYear = model.ClassOfYear },\n    requireConfirmationToken: true);\n</code></pre>\n\n<p>However, now I want to be able to update the profile when I manage it but I can't seem to find a method to do so. <strong>Do I need to simply update the <code>UserProfile</code> table myself? If not, what is the appropriate way of doing this?</strong></p>\n\n<p>FYI, I'm using Dapper as my data access layer, just in case it matters. But, like stated, I can just update the <code>UserProfile</code> table via Dapper if that's what I'm supposed to do, I just figured that the <code>WebSecurity</code> class, or something similar, had a way already since the custom user profile fields are integrated with the <code>CreateUserAndAccount</code> method.</p>\n\n<p>Thanks all!</p>\n"},{"tags":["c#",".net","linux","mono","dlopen"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":219,"score":2,"question_id":9954548,"title":"SIGSEGV when P/Invoking dlopen","body":"<p>I'm trying to write an abstraction to load dynamic libraries on Windows and Linux. While on Windows platform everything goes fine, I get a SIGSEGV when I call <code>dlopen</code>:</p>\n\n<pre><code>    // File: Main.cs\nusing System;\nusing System.Runtime.InteropServices;\n\nnamespace DlopenTest\n{\n    class MainClass\n    {\n        const int RTLD_NOW = 2;\n\n        [DllImport(\"dl\")]\n        static extern IntPtr dlopen([MarshalAs(UnmanagedType.LPTStr)] string filename, int flags);\n\n        [DllImport(\"dl\")]\n        static extern IntPtr dlsym(IntPtr handle, [MarshalAs(UnmanagedType.LPTStr)] string symbol);\n\n        public static void Main (string[] args)\n        {\n            IntPtr libraryHandle = dlopen(\"libc.so.6\", RTLD_NOW);\n\n            Console.WriteLine (\"Success!\");\n        }\n    }\n}\n</code></pre>\n\n<p>The output is the following:</p>\n\n<pre><code>Stacktrace:\n\n  at (wrapper managed-to-native) DlopenTest.MainClass.dlopen (string,int) &lt;0x00004&gt;\n  at (wrapper managed-to-native) DlopenTest.MainClass.dlopen (string,int) &lt;0x00004&gt;\n  at DlopenTest.MainClass.Main (string[]) [0x00000] in     /home/luca/Projects/DlopenTest/DlopenTest/Main.cs:18\n  at (wrapper runtime-invoke) &lt;Module&gt;.runtime_invoke_void_object     (object,intptr,intptr,intptr) &lt;IL 0x0001d, 0x00043&gt;\n\nNative stacktrace:\n\n    /usr/bin/mono() [0x80d5b19]\n    /usr/bin/mono() [0x810f7ab]\n    [0xb771940c]\n    /lib/ld-linux.so.2(+0x119a8) [0xb772b9a8]\n/usr/lib/libdl.so(+0xc0b) [0xb536dc0b]\n/lib/ld-linux.so.2(+0xdb36) [0xb7727b36]\n/usr/lib/libdl.so(+0x109c) [0xb536e09c]\n/usr/lib/libdl.so(dlopen+0x41) [0xb536db41]\n[0xb58672f1]\n[0xb58671bd]\n[0xb5867234]\n/usr/bin/mono() [0x8064428]\n/usr/bin/mono(mono_runtime_invoke+0x40) [0x812d4e0]\n/usr/bin/mono(mono_runtime_exec_main+0xde) [0x8130f8e]\n/usr/bin/mono(mono_runtime_run_main+0x112) [0x8131292]\n/usr/bin/mono(mono_main+0x15ec) [0x80b3bdc]\n/usr/bin/mono() [0x805b675]\n/lib/i686/cmov/libc.so.6(__libc_start_main+0xe6) [0xb74b8ca6]\n/usr/bin/mono() [0x805b5b1]\n\nDebug info from gdb:\n\n=================================================================\nGot a SIGSEGV while executing native code. This usually indicates\na fatal error in the mono runtime or one of the native libraries \nused by your application.\n=================================================================\n</code></pre>\n\n<p>What's going on?</p>\n\n<p>My glibc version is 2.11.3, and the mono runtime is 2.6.3.</p>\n\n<p>To compile the program:  <code>mono-csc Main.cs</code>\nTo run the program: <code>./Main.exe</code></p>\n\n<hr>\n\n<p>I've just straced the execution of the test application. Here is the system calls before the SIGSGV:</p>\n\n<pre><code>...\nopen(\"/usr/lib/libdl.so\", O_RDONLY)     = 3\nread(3, \"\\177ELF\\1\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0\\3\\0\\1\\0\\0\\0@\\n\\0\\0004\\0\\0\\0\"..., 512) = 512\nfstat64(3, {st_mode=S_IFREG|0644, st_size=9736, ...}) = 0\nmmap2(NULL, 12408, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb598b000\nmmap2(0xb598d000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3,     0x1) = 0xb598d000\nclose(3)                                = 0\nmprotect(0xb598d000, 4096, PROT_READ)   = 0\nmunmap(0xb598f000, 76774)               = 0\ngettimeofday({1333269422, 515602}, NULL) = 0\ngettimeofday({1333269422, 515653}, NULL) = 0\ngettimeofday({1333269422, 515828}, NULL) = 0\ngettimeofday({1333269422, 515884}, NULL) = 0\ngettimeofday({1333269422, 515986}, NULL) = 0\ngettimeofday({1333269422, 516059}, NULL) = 0\ngettimeofday({1333269422, 516613}, NULL) = 0\ngettimeofday({1333269422, 516670}, NULL) = 0\nbrk(0x98e3000)                          = 0x98e3000\nbrk(0x98e1000)                          = 0x98e1000\ngettimeofday({1333269422, 516916}, NULL) = 0\nbrk(0x98de000)                          = 0x98de000\nbrk(0x98dc000)                          = 0x98dc000\nbrk(0x98db000)                          = 0x98db000\ngettimeofday({1333269422, 517092}, NULL) = 0\ngettimeofday({1333269422, 517200}, NULL) = 0\ngettimeofday({1333269422, 517261}, NULL) = 0\ngettimeofday({1333269422, 517368}, NULL) = 0\ngettimeofday({1333269422, 517525}, NULL) = 0\ngettimeofday({1333269422, 517762}, NULL) = 0\ngettimeofday({1333269422, 517823}, NULL) = 0\ngettimeofday({1333269422, 518007}, NULL) = 0\ngettimeofday({1333269422, 518074}, NULL) = 0\ngettimeofday({1333269422, 518435}, NULL) = 0\ngettimeofday({1333269422, 518486}, NULL) = 0\ngettimeofday({1333269422, 518648}, NULL) = 0\ngettimeofday({1333269422, 518699}, NULL) = 0\ngettimeofday({1333269422, 518803}, NULL) = 0\nfutex(0xb598e06c, FUTEX_WAKE_PRIVATE, 2147483647) = 0\n--- SIGSEGV (Segmentation fault) @ 0 (0) ---\n</code></pre>\n\n<p>This trace is generated by invoking \"<code>strace /opt/mono-2.10/bin/mono ./DlopenTest.exe 2&gt; strace</code>\"</p>\n\n<p>The strace of default mono installation (2.6) it almost similar, and it always crashing at the same point.</p>\n\n<p>How to debug this condition? I'm out of ideas... Maybe <em>dlopen</em> is just a wrapper, so I can call an alternative function? Maybe I execute mono 2.10 in a wrong environement (maybe I have to specify some environment variable to get this work)?</p>\n"},{"tags":["c#",".net","x509certificate",".net-security"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":13221612,"title":"Store and Import x509 Public Key using C#","body":"<p>i try to implement a PGP like solution using x509 certificates to secure credit card transfers from machine a to machine b</p>\n\n<p>I created a test cert using makecert like described in the msdn:\n<a href=\"http://msdn.microsoft.com/de-de/library/bfsktky3(v=vs.80).aspx\" rel=\"nofollow\">http://msdn.microsoft.com/de-de/library/bfsktky3(v=vs.80).aspx</a></p>\n\n<p>Now i want to transfer the public key to another computer which should of course not get a copy of the private key.</p>\n\n<p>I tried to use the System.Security.Cryptography.X509Certificates.X509Certificate class with the GetPublicKey or GetPublicKeyString method.</p>\n\n<p>Unfortunately i dont find a way to pass it back to the x509 class, so that i can encrypt data and send it from computer a to b. I wish a base64 approach to store the public keys into a sql database.</p>\n\n<p>i dont want to use any third party library and directly use the .net framework 4.0.</p>\n\n<p>i found also this way, but i cannot create a .cer file using the GetPublicKey methods... \nstring Certificate = \"Certificate.cer\";\nX509Certificate cert = X509Certificate.CreateFromCertFile(Certificate);</p>\n"},{"tags":[".net","api","rest","authorization","restsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13230883,"title":"Get request: multiple header options with same key?","body":"<p>i am working with API, which expects the header like this:</p>\n\n<blockquote>\n  <p>Authorization: ClientKey keyhere<br>\n  Authorization: UserKey key2here</p>\n</blockquote>\n\n<p>when i am adding this params to RestSharp's request like this:</p>\n\n<pre><code>request.AddHeader(\"Authorization\", \"ClientKey 111111\");\nrequest.AddHeader(\"Authorization\", \"UserKey 222222\");\n</code></pre>\n\n<p>i see, that only last one is written.\nIt's because of they have the same key.\nBut how can i avoid it?</p>\n\n<p>I understand, that it is wrong behavior on the server side, but this code is already using in production for other platforms.</p>\n\n<p><strong>Updated</strong></p>\n\n<p>I found solution: </p>\n\n<pre><code>request.AddHeader(\"Authorization\", \"ClientKey 111111, UserKey 222222\");\n</code></pre>\n"},{"tags":["c#",".net","google-drive-sdk","google-drive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13231963,"title":"checking status of an uploading file using google drive api .net","body":"<p>I am writing an application to check the status of an uploading file. The file wont be upload by the application but will be uploaded by <code>google drive</code> itself. This is my question - is there any way to <code>monitor</code> the status of a <code>file</code> uploaded by <code>google drive</code> desktop application using <code>google drive api</code> or by any other means. By any other means I meant that, maybe <code>google drive</code> application might be creating a file for writing <code>upload status</code> in the computer itself. If there is a <code>file</code> like that please tell me how to access that file.</p>\n"},{"tags":["c#",".net","string","datetime"],"answer_count":4,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":444,"score":5,"question_id":3999013,"title":"Convert string to Date - C#","body":"<p>How would I be able to convert a string like \"On Monday 25th March 2010...\" to 25/03/10?\nAlso, is this possible?</p>\n"},{"tags":[".net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13229048,"title":"Cross Type LINQ","body":"<p>I have the following code</p>\n\n<pre><code>    [Microsoft.VisualStudio.TestTools.UnitTesting.TestMethod]\n    public void TestEnumOfMaybe()\n    {\n        List&lt;Maybe&lt;int&gt;&gt; l = new List&lt;Maybe&lt;int&gt;&gt;();\n        l.Add(1.ToMaybe());\n        l.Add(Maybe.None&lt;int&gt;());\n        l.Add(3.ToMaybe());\n\n        var y = from x in l\n                from y in x\n                select y;\n\n    }\n</code></pre>\n\n<p>My Maybe type accepts all the Select and SelectMany methods to make it Linq compatible and I have tests to prove it so. However I can't seem to figure out a way to do cross type LINQ composition as in the above test case. The error I get is</p>\n\n<pre><code>expression of type 'FunctionalExtensions.Maybe&lt;int&gt;' is not allowed in\na subsequent from clause in a query expression with source type\n'System.Collections.Generic.List&lt;FunctionalExtensions.Maybe&lt;int&gt;&gt;'.  \n\nType inference failed in the call to 'SelectMany'.\nFunctionalExtensions*\n</code></pre>\n\n<p>Is there a way to combine the two LINQ types or am I out of luck here? The complete Maybe.cs implementation is at</p>\n\n<p><a href=\"https://gist.github.com/4016243\" rel=\"nofollow\">https://gist.github.com/4016243</a></p>\n"},{"tags":[".net","mysql"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5975,"score":2,"question_id":1102281,"title":"How do I add a reference to the MySQL connector for .NET?","body":"<p>what dows this mean: Next add reference to: MySql.Data </p>\n\n<p>actually i have downloaded mysql connector/net.\nby following these instructions:</p>\n\n<p>First, you need to install the mysql connector/net, it is located at: <a href=\"http://dev.mysql.com/downloads/connector/net/1.0.html\" rel=\"nofollow\">http://dev.mysql.com/downloads/connector/net/1.0.html</a> </p>\n\n<p>Next create a new project</p>\n\n<p>Next add reference to: MySql.Data</p>\n\n<p>Next add \"using MySql.Data.MySqlClient;\"\n but im not able to install the connector.</p>\n\n<p>website:<a href=\"http://bitdaddys.com/MySQL-ConnectorNet.html\" rel=\"nofollow\">http://bitdaddys.com/MySQL-ConnectorNet.html</a></p>\n"},{"tags":["c#",".net","operating-system"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13231323,"title":"how to run .net code into mac?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7145814/can-a-net-program-written-for-windows-work-on-osx\">Can a .net program written for windows work on osx?</a>  </p>\n</blockquote>\n\n\n\n<p>I would like to ask you that is there a way to run my .net c# windows application run in to mac OS?\nI searched and found about mono.Do you guys have any idea how to do that?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","mef",".net-assembly"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13231883,"title":"MEF plugin dependency not loading as plugins directory is not checked","body":"<p>I'm having problems with MEF not picking up dependencies for loaded components. We have a directory structure that looks like:</p>\n\n<p>C:/MSMQ/DistributionService/[Main application]</p>\n\n<p>C:/MSMQ/Providers/[plugin components]</p>\n\n<p>Of course, we are using a DirectoryCatalog, the plugin is picked up, but one of its' dependencies is not. The error message is:</p>\n\n<pre><code>2012-11-02 10:46:59,379 [1] FATAL - Assemblies required by Provider are not found\nSystem.IO.FileNotFoundException: Could not load file or assembly 'BusinessObjects, Version=1.5.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.\nFile name: 'BusinessObjects, Version=1.5.0.0, Culture=neutral, PublicKeyToken=null'\n\n=== Pre-bind state information ===\nLOG: User = &lt;redacted&gt;\nLOG: DisplayName = BusinessObjects, Version=1.5.0.0, Culture=neutral, Public\nKeyToken=null\n (Fully-specified)\nLOG: Appbase = file:///C:/MSMQ/DistributionService/\nLOG: Initial PrivatePath = NULL\nCalling assembly : DistributedServicePropertyComponents, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.\n===\nLOG: This bind starts in default load context.\nLOG: Using application configuration file: C:\\MSMQ\\DistributionService\\Distr\nibutionService.exe.Config\nLOG: Using host configuration file:\nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework64\\\nv4.0.30319\\config\\machine.config.\nLOG: Policy not being applied to reference at this time (private, custom, partia\nl, or location-based assembly bind).\nLOG: The same bind was seen before, and was failed with hr = 0x80070002.\n\n2012-11-02 10:46:59,401 [1] FATAL - Assemblies required by Provider are not found\nSystem.IO.FileNotFoundException: Could not load file or assembly 'BusinessObjects, Version=1.5.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.\nFile name: 'BusinessObjects, Version=1.5.0.0, Culture=neutral, PublicKeyToken=null'\n\n=== Pre-bind state information ===\nLOG: User = B2B\\addisona\nLOG: DisplayName = BusinessObjects, Version=1.5.0.0, Culture=neutral, Public\nKeyToken=null\n (Fully-specified)\nLOG: Appbase = file:///C:/MSMQ/DistributionService/\nLOG: Initial PrivatePath = NULL\nCalling assembly : DistributedServicePropertyComponents, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.\n===\nLOG: This bind starts in default load context.\nLOG: Using application configuration file: C:\\MSMQ\\DistributionService\\DistributionService.exe.Config\nLOG: Using host configuration file:\nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework64\\\nv4.0.30319\\config\\machine.config.\nLOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).\nLOG: The same bind was seen before, and was failed with hr = 0x80070002.\n</code></pre>\n\n<p>I believe this is similar to a question on MSDN: <a href=\"http://social.msdn.microsoft.com/Forums/en-US/MEFramework/thread/b34ef4f4-e1f1-4f06-bd42-d7b3d5060f6f/\" rel=\"nofollow\">http://social.msdn.microsoft.com/Forums/en-US/MEFramework/thread/b34ef4f4-e1f1-4f06-bd42-d7b3d5060f6f/</a> - but I don't understand the answer.</p>\n\n<p>Is there any way to provide a path to pick the problem assembly up from, or any other suggested solution?</p>\n\n<p>We have only started having this problem recently, but I can't see any changes I'd expect to cause that in our source control history.</p>\n"},{"tags":[".net","wpf","performance",".net-3.5","measureoverride"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":684,"score":0,"question_id":6959012,"title":"WPF MeasureOverride called multiple times after multiple PropertyChanged notifications","body":"<p>In my application, I have a graph (Custom Wpf Panel) with Wpf controls as elements. The elements are custom controls derived from Wpf Control. DataTemplates associate the controls to their view models.\nThe view models collection, \"GraphElements\" is binded to the itemsControl as shown below.</p>\n\n<pre><code>&lt;ItemsControl x:Name=\"PART_GraphItemsControl\" Grid.Column=\"1\"\n              VerticalAlignment=\"Stretch\" \n              HorizontalAlignment=\"Left\"\n              ItemsSource=\"{Binding Path=GraphElements}\"\n              VirtualizingStackPanel.IsVirtualizing=\"True\"\n              VirtualizingStackPanel.VirtualizationMode=\"Recycling\"&gt;\n    &lt;ItemsControl.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;local:GraphDesignerPanel HorizontalAlignment=\"Stretch\"\n                                      VerticalAlignment=\"Top\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/ItemsControl.ItemsPanel&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n\n<p>The elements in the graph can vary from 2 to 500. Under certain mode of the application, the elements display their value. To display the value, the ViewModel for the element fires the <code>INotifyPropertyChanged.PropertyChanged(\"VariableValue\")</code></p>\n\n<p><strong>Issue:</strong>\nWhen i have 100+ elements in the graph, each elements view model fires INotifyPropertyChanged.PropertyChanged to have the elements value displayed. This calls MeasureOverride 100+ times leading to memory and peformance issues.</p>\n\n<p>How can I reduce the number of MeasureOverride calls?</p>\n\n<h2>XAML for Value display for the graph element:</h2>\n\n<pre><code> &lt;TextBlock  \n    Text=\"{Binding Path=VariableValue, StringFormat={}({0})}\" Width=\"60\"\n    FontSize=\"11\" Name=\"txtBlk\"&gt;\n&lt;/TextBlock&gt;\n</code></pre>\n\n<p>The TextBlock above is collapsed if VariableValue is null</p>\n\n<pre><code>&lt;DataTrigger Binding=\"{Binding Path=VariableValue}\" Value=\"{x:Null}\"&gt;\n    &lt;Setter TargetName=\"txtBlk\"  Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n&lt;/DataTrigger&gt;\n</code></pre>\n\n<p><strong>UPDATE:</strong> The issue is reproducible in the sample at the link given below. Download, build, debug. Once App is opened, set a breakpoint in Window.xaml.cs MeasureOverride. Come back to the App and hit the \"Click Me\" button. The breakpoint is hit 11 times !.</p>\n\n<p><a href=\"http://sivainfotech.co.uk/measureoverrideissue.zip\" rel=\"nofollow\">http://sivainfotech.co.uk/measureoverrideissue.zip</a></p>\n\n<p>Any ideas greatly appreciated.</p>\n"},{"tags":["javascript",".net","visual-studio-2010","internet-explorer-9"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":4136,"score":5,"question_id":5381334,"title":"Disable IE9 Javascript debugger when using Visual Studio 2010","body":"<p>Is there a way to disable javascript debugging when using Visual Studio with IE9? </p>\n"},{"tags":["php",".net","image-processing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":38,"score":-3,"question_id":13231667,"title":"Should I use .NET or PHP for large image manipulation?","body":"<p>I am beginning a new project that will require the manipulation of large images (hundreds of Mbs).</p>\n\n<p>Would PHP or .NET have the best libraries for handling this?</p>\n\n<p>I am looking at using ImageMagick and am aware of issues with allocating extra memory for ImageMagick to handle very large files.</p>\n\n<p>Does .NET handle large images better natively and/or does it have better libraries?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13231500,"title":"LINQ query optimization: specifically, does position of let clauses matter?","body":"<p>I'm interested in the compilation and optimization LINQ expressions and whether or not I need to carefull consider the order of let and where clauses in my expression.</p>\n\n<p>Here is example:</p>\n\n<pre><code>var query = \n    from record in Database.Table\n    let recordName = record.GetName()\n    let notUsed = UselessData()\n    let stuff = DoSomethingIntensiveWith(record)\n    where recordName == \"foobar\"\n    select stuff;\n\nforeach (string item in query) {\n    Console.WriteLine(\"item =&gt; '{0}'\", item);\n}\n</code></pre>\n\n<p>Questions/assumptions:</p>\n\n<ul>\n<li><code>record.GetName()</code> must be resolved in order to execute the <code>where</code>\nclause.</li>\n<li><code>notUsed</code> is never used in the expression, so will <code>UselessData()</code> get called\nat all?</li>\n<li><code>stuff</code> is only needed if <code>recordName</code> equals \"foobar\". Will\n<code>DoSomethingIntensiveWith()</code> be executed for every record or just records\nwhere <code>recordName</code> equals \"foobar\"?</li>\n</ul>\n\n<p>If I want to ensure <code>DoSomethingIntensiveWith()</code> is only called when \n<code>recordName</code> equals \"foobar\", do I need to position the <code>let</code> caluse after the\n<code>where</code> clause, as follows:</p>\n\n<pre><code>var query = \n    from record in Database.Table\n    let recordName = record.GetName()\n    let notUsed = UselessData()\n    where recordName == \"foobar\"\n    let stuff = DoSomethingIntensiveWith(record)\n    select stuff;\n\nforeach (string item in query) {\n    Console.WriteLine(\"item =&gt; '{0}'\", item);\n}\n</code></pre>\n\n<p>In the meantime, I'm going to play with some real code and the debugger. I'll\nreport back what I find.</p>\n"},{"tags":["c#",".net","excel","oledb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":34,"score":-1,"question_id":13231608,"title":"Excel data coloring via OLEDB","body":"<pre><code>OleDbCommand cmd = new OleDbCommand(\"Select * from [\" + txtsheet.Text + \"] WHERE [ASSET NUM] = \" + asset + \"\", con);    \n\nOleDbDataReader rdr = cmd.ExecuteReader();    \n\nOleDbDataAdapter da = new OleDbDataAdapter(cmd);    \n\nint x = cmd.ExecuteNonQuery();    \n</code></pre>\n\n<p>and after this the selected asset num row has to be marked in red color</p>\n\n<p>Please help me for this</p>\n\n<p>Thanks in advance</p>\n\n<p>Regards\nMahendran</p>\n"},{"tags":[".net","c#-4.0","google-bigquery","google-storage"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13231158,"title":"Uploading CSV files to Google Cloud Storage Using .Net Libraries","body":"<p>I need help on writing a code for uploading locally stored CSV files to Google cloud storage and then storing data from storage to the respective Big Query tables, using .Net client libraries. </p>\n\n<p>I searched for hours, but didn't get relevant solution.</p>\n\n<p>Thanks.  </p>\n"},{"tags":["c#",".net","silverlight"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13231575,"title":"DomainDataSourceView MoveCurrentTo... keeps looping","body":"<p>When </p>\n\n<p>DomainDataSourceView.MoveCurrentToNext() </p>\n\n<p>and</p>\n\n<p>DomainDataSourceView.MoveCurrentToPrevious()</p>\n\n<p>are called several times in a non specific order the DomainDataSourceView gets caught in some sort of loop where the CurrentItem changes to a random item from the collection constantly.\nThe only way to stop is to close the Silverlight application. \nIs this a known issue?</p>\n\n<p>This is the order of calls in the silverlight mvvm application:</p>\n\n<ul>\n<li>Button is clicked </li>\n<li>The RelayCommand bound to the button fires a canexecute method (returns true)</li>\n<li>the method for the command is executed and calls DataView.MoveCurrentToNext()</li>\n<li>The RaiseCanExecuteChanged method is called for the first - back -\nnext - last button Commands (all return false)</li>\n<li>the CurrentEntity Property on the viewmodel is changed to the current\nitem from the domain data source</li>\n<li>Some data is loaded asynchonously for the current entity</li>\n</ul>\n\n<p>When the next button is quickly clicked on several times it starts looping.\nWhen the interval between clicks is somewhat bigger, no issue.</p>\n\n<p>It almost seams like MoveCurrentToNext executes again while it's still processing the first click.\nWhen debugging with breakpoints this never happens. Breakpoints added in all the methods\nwhile looping never get hit.\nHas anyone got an idea how to fix this or what might cause this?</p>\n"},{"tags":["c#",".net","wcf","app-config","service-reference"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13231086,"title":"Why is the <system.serviceModel> section missing from app.config?","body":"<p>I'm trying to consume a WCF service. I added a Service Reference, and now I'm trying to call it:</p>\n\n<pre><code>BusStopServiceBinding.BusStopPortTypeClient client = new BusStopServiceBinding.BusStopPortTypeClient();\n</code></pre>\n\n<p>However, I'm getting this error:</p>\n\n<blockquote>\n  <p>Could not find default endpoint element that references contract\n  'BusStopServiceBinding.BusStopPortType' in the ServiceModel client\n  configuration section. This might be because no configuration file was\n  found for your application, or because no endpoint element matching\n  this contract could be found in the client element.</p>\n</blockquote>\n\n<p>My <code>app.config</code> file looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n&lt;configSections&gt;\n&lt;/configSections&gt;\n&lt;startup&gt;&lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.0\"/&gt;&lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>No <code>serviceModel</code> section, as you can see. Should I add it manually, and if so, what should I put in it?</p>\n"},{"tags":[".net","memory-dump","postmortem-debugging"],"answer_count":5,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":2905,"score":12,"question_id":48148,"title":"Tool for analyzing .Net app memory dumps","body":"<p>Can somebody suggest a good <strong>free</strong> tool for analyzing .Net memory dumps other than Adplus/windbg/sos ?</p>\n"},{"tags":[".net","entity-framework","entity-framework-5"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":85,"score":6,"question_id":13223353,"title":"Regarding the new EF5 auto-compiled queries feature","body":"<p>I've made few tests regarding the new EF5 auto-compiled queries feature. The problem is that I don't see any difference in the performance. </p>\n\n<p>I've made one project with .NET 4.0 and EF4.0 without using compiled queries. \nI've made another project with .NET 4.0 and EF4.0 with compiled queries - there was 50% improvement in performance. </p>\n\n<p>And then I tried to create a project with EF 5.0, in which there was basically no difference in performance. </p>\n\n<p>All the projects were asp.net mvc (first two were version 3, the last one - version 4). </p>\n\n<p>Am I missing something here ? Is there something special I need to do to enable the auto-compile feature ? I just created MVC 4 project with pre-build EF5 inside. </p>\n\n<p>The query I am testing with is rather verbose, three joins and multiple filters inside. </p>\n\n<p>Thank you</p>\n"},{"tags":["c#",".net","com","remoting","com+"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":165,"score":6,"question_id":12242671,"title":"COM+ remoting error code 8000401a because password of This User under Identity tab getting resetted","body":"<p>I am an admin in my COM+ server machine, my COM+ server component identity set to \"This User\" and provided my credentials there. I could invoke my component from client machine. But client app will stop working after some time with errorcode 8000401a. So I shutdown my server app and when I start the app back it shows an error username and password incorrect with error code 8000401a. When I re-entery my password again and strat it back. it works fine. Seems my password entered in identity tab is being resetted? Any idea why?</p>\n"},{"tags":["c#",".net","bltoolkit"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13230922,"title":"Accessing mysql odbc datasource via bltoolkit","body":"<p>I am trying to create a odbc datasource for MySQL from within my asp.net web project.</p>\n\n<p>It runs successfully with the MySQL-odbc driver 5.1</p>\n\n<p>Now my problem is to connect that database through <strong>bltoolkit</strong> rather than the above driver just by placing the dll in bin folder of that application</p>\n\n<p>my sample web config file</p>\n\n<pre><code>&lt;configSections&gt;\n    &lt;section name=\"bltoolkit\" type=\"BLToolkit.Configuration.BLToolkitSection, BLToolkit.4\"/&gt;\n  &lt;/configSections&gt;\n  &lt;bltoolkit&gt;\n    &lt;dataProviders&gt;\n      &lt;add type=\"BLToolkit.Data.DataProvider.MySqlDataProvider,      UnitTests.Linq\" /&gt;\n    &lt;/dataProviders&gt;\n  &lt;/bltoolkit&gt;\n  &lt;connectionStrings&gt;\n     &lt;add name=\"Test\" connectionString=\"Server=****;Port=****;Database=***;Uid=***;Pwd=****;\" providerName=\"MySql.Data.MySqlClient\"/&gt;\n  &lt;/connectionStrings&gt;\n  &lt;appSettings&gt;\n    &lt;add\n        key   = \"BLToolkit.DataProviders\"\n        value = \"BLToolkit.Data.DataProvider.MySqlDataProvider, SomeAssembly\"/&gt;\n  &lt;/appSettings&gt;\n</code></pre>\n\n<p>Waiting for your valuable responses </p>\n"},{"tags":[".net","wcf","web-services","soap","certificate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13161218,"title":"WCF: Consume WebService using both certificate and username authentication","body":"<p>I've been struggling for a while trying to consume a web-service hosted in a server <strong>which I do not have control</strong> (so I can't really do any configuration on the server part).</p>\n\n<p>I've been using WCF to try to consume a web-service that has both Username/Password and Certificate authentication requirements (as well as a HTTPS connection).</p>\n\n<p>The code that I have is this:</p>\n\n<pre><code>        EndpointAddress ea = new\n                EndpointAddress(\"https://the.server.address\");\n\n        BasicHttpBinding bs = new BasicHttpBinding();\n\n        bs.Security.Mode = BasicHttpSecurityMode.TransportWithMessageCredential;\n        bs.Security.Transport.ClientCredentialType =\n            HttpClientCredentialType.Certificate;\n\n        //here if I put username I get a 'message is not signed' error. \n           If I put credentials I get an 'invalid username/password'.\n        bs.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.Certificate;\n\n        var svc = new myWebServiceClient(bs, ea);\n\n        var request = new ObjectWS();\n\n        svc.ClientCredentials.ClientCertificate.SetCertificate(\n                                        StoreLocation.CurrentUser,\n                                                 StoreName.Root,\n                                X509FindType.FindBySerialNumber,\n                                \"the serial\");\n\n        svc.ClientCredentials.UserName.UserName = \"user\";\n        svc.ClientCredentials.UserName.Password = \"pass\";\n\n        //the call to the method in the WS\n        request= svc.getValue(\"param\");\n</code></pre>\n\n<p>The problem is that, as I'm a newbie in WCF (and in WebServices in general), I don't actually know how to consume the web-service using both username and certificate authentication, nor do I know if that makes any sense at all.</p>\n\n<p>In the line:</p>\n\n<pre><code>bs.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.Certificate;\n</code></pre>\n\n<p>if I set the credential type to Certificate I get an Invalid Username/Password. in the other hand if I set it to Username I'll get a 'Message not signed error'.</p>\n\n<p>I would really appreciate some feedback/help in this issue. Regards!</p>\n"},{"tags":["c#",".net","microsoft-chart-controls"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":269,"score":0,"question_id":8209268,"title":".NET Charting Controls: Label values from data source","body":"<p>I know that you can use keywords with labels, but is there any way to use a specific value from my data set as a label? What I would like to do is have a column of my data table contain a custom label string, so that each X-axis value graphed would have a unique label, but it seems there is no way to connect a series to an element from my data source. Is there a workaround to this, or will I just have to manually add labels over the chart?</p>\n"},{"tags":[".net","sms","hardware","sms-gateway"],"answer_count":5,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":742,"score":6,"question_id":4604242,"title":"SMS Gateway Devices","body":"<p>Can anyone recommend a good SMS Gateway device that sends and receives messages and has a reasonable API. We are looking for a hardware device that a Sim Card and works with Windows / .Net.</p>\n\n<p>I am working with about 50 different countries (Right now 50 will only become more in the future) and dealing with that many SMS suppliers and their various methods for billing and sending / responding to messages is proving unmanageable. It may be much easier to have a single method and call it by country. </p>\n\n<p>We do bulk send messages but from the logs this is at most 500 messages at a time (though it could be up-to about 1500 at a time) - mostly its small numbers far less than 500 messages.</p>\n\n<p>Ideally would like to get message delivery data and error handling type messages back from the device. I am not interested in a hosted solution unless it has the ability to receive a message to a local number in EVERY country.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13230220,"title":"Can't modify properties of ToolStripMenuItems in their onClick events","body":"<p>On my onClick event handler, i'm doing something like:</p>\n\n<pre><code>private void myToolStripItem_Click(object sender, EventArgs e)\n    {\n        Form form = (Form)(((taskBarToolStripMenuItem)sender).formReference);\n\n        if (form != this.ActiveMdiChild)\n        {\n            if (!form.Visible)\n                form.Show();\n            form.Activate();\n\n            ((taskBarToolStripMenuItem)sender).isSelected = true; //set it to true, so the renderer will draw them differently\n        }\n    }\n</code></pre>\n\n<p>taskBarToolStripMenuItem is a subclass of ToolStripMenuItem. When i get to my custom ToolStripSystemRenderer, items that i'm sure got its \"isSelected\" property changed to true remain with it as false. This happens to other properties, i tried Tag, Text, etc... Why? Thanks</p>\n"},{"tags":["c#",".net","design-patterns","anti-patterns"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":52,"score":-2,"question_id":13229729,"title":"Is this BaseBeen anti-pattern?","body":"<p>I have an utility library with the class ConsoleApp, which has only static method like GetIntValue(string name) to ask user to enter the integer value of the parameter with specified name, or functions to parse command line parameters.</p>\n\n<p>As for me ConsoleApp is an utility class, and inheriting it just to get avoid \"ConsoleApp.\" in the code looks like BaseBeen anti-pattern.</p>\n\n<p>But on the other side, ConsoleApp will be inherited only by the classes that is really Console applications, in this way, it's not a BaseBeen.</p>\n\n<p>So, is it really BaseBeen?</p>\n"},{"tags":[".net","windows","configuration","proxy"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2065,"score":0,"question_id":2873292,"title":"Enable Proxy Authentication for normal windows application","body":"<p>my company's internet works on proxy server with Authentication(i.e. Browser prompts with window for username/password everytime i tried to access any web page).</p>\n\n<p>Now i have some windows application which tries to access internet(like WebPI/Visual Studio 2008 for rss feeds), but as they are unable to popup the the authentication window, they are unable to connect with internet with error: </p>\n\n<blockquote>\n  <p>(407) Proxy Authentication Required</p>\n</blockquote>\n\n<p>.\nHere the exception is VS2008, first time it always fails to load rss feeds on startup page, but when i click on the link, it shows authentication window and everything works fine after that.</p>\n\n<blockquote>\n  <p>my question is: How can i configure normal windows application(through app.config/app.manifest file) accessing web to able to show the authentication window or provide default credentials.</p>\n</blockquote>\n\n<p>For explore this furthor, i have created one console application on VS2008 which tries to serach something on google and display the result on console. Code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Net;\nusing System.IO;\n\nnamespace WebAccess.Test\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Console.WriteLine(\"Enter Serach Criteria:\");\n            string criteria = Console.ReadLine();\n            string baseAddress = \"http://www.google.com/search?q=\";\n            string output = \"\";\n\n            try\n            {\n\n                // Create the web request   \n                HttpWebRequest request = WebRequest.Create(baseAddress + criteria) as HttpWebRequest;\n\n                // Get response   \n                using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)\n                {\n                    // Get the response stream   \n                    StreamReader reader = new StreamReader(response.GetResponseStream());\n\n                    // Console application output   \n                    output = reader.ReadToEnd();\n                }\n\n                Console.WriteLine(\"\\nResponse : \\n\\n{0}\", output);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine(\"\\nError : \\n\\n{0}\", ex.ToString());\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>When running this, It gives error</p>\n\n<pre><code>Enter Serach Criteria:\nLalit\n\nError :\n\nSystem.Net.WebException: The remote server returned an error: (407) Proxy Authen\ntication Required.\n   at System.Net.HttpWebRequest.GetResponse()\n   at WebAccess.Test.Program.Main(String[] args) in D:\\LK\\Docs\\VS.NET\\WebAccess.\nTest\\WebAccess.Test\\Program.cs:line 26\nPress any key to continue . . .\n</code></pre>\n"},{"tags":["c#",".net","loops","windows-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":19,"score":0,"question_id":13230009,"title":"Search the process from list box (displaying current process running in system)","body":"<pre><code>private void btnsearch_Click(object sender, EventArgs e)\n{\n      int itr = lstProcesses.Items.Count;\n      string str=txtSearchProcess.Text;\n      string[] str1 = new string[lstProcesses.Text.ToString()];// Getting error here\n      if (txtSearchProcess.Text == \"\")\n      {\n         errorProvider1.SetError(txtSearchProcess, \"Enter the name of the process\");\n         MessageBox.Show(\"enter the value\", \"error\", MessageBoxButtons.OK, MessageBoxIcon.Asterisk);\n      }\n      else\n      {\n          for (int i = 0; i &lt;= itr; i++)\n          {\n              if (str == str1[itr])\n              {\n                    //MessageBox.Show(\"process found\",\"process\",MessageBoxButtons.OK,MessageBoxIcon.Information);\n                    b_test();\n              }\n              else\n              {\n                   MessageBox.Show(\"process not found\", \"error\", MessageBoxButtons.OKCancel, MessageBoxIcon.Information);\n\n              }\n          }\n\n       }\n\n    }\n</code></pre>\n\n<p>Please make any correction, I need to successfully find/not find the process from list box</p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2886,"score":0,"question_id":969269,"title":"How do you check if the mouse click position was only inside an item in Column[0] in a listview under virtualmode?","body":"<p>C#: How do you check if the mouse click position was only inside an item in Column[0] in a listview under virtualmode?</p>\n\n<p>I can get the the Item object the mouse just clicked using ListView.GetItemAt, but after that, how could I check if it was clicked within column[0]?</p>\n"},{"tags":["c#",".net","osx","mono","monodevelop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13230612,"title":"Problems with EMF files and Mono","body":"<p>I need to port my VS2010 code to Mono (MacOS 10.8 Mountain Lion, MonoDevelop 3.0.4.7)\nMy code draws some things on the Graphics object and this needs to be saved to emf file.</p>\n\n<p>3 quiestions.</p>\n\n<p>1) Real code didnt work so i tried to create simple console application to draw smth and save to file.</p>\n\n<pre><code>MemoryStream ms = new MemoryStream();\nBitmap bmp = new Bitmap(500,500);\nGraphics g = Graphics.FromImage(bmp);\nIntPtr ip = g.GetHdc ();\nMetafile mf = new Metafile(ms, ip);\ng.ReleaseHdc ();\ng.Dispose ();\ng = Graphics.FromImage(mf);\ng.FillEllipse(new SolidBrush(Color.Red), 20, 20, 20, 40);\ng.DrawEllipse(new Pen(new SolidBrush(Color.Green), 10), 50,50,60,60);\ng.Dispose();\nmf.Save(\"draw.emf\", ImageFormat.Emf);\n</code></pre>\n\n<p>I got an exception with the last line - A null reference or invalid value was found(GDI+ status: Invalid Parameter) Why ??</p>\n\n<p>2) Part of the real code:</p>\n\n<pre><code>int w = 500; // any value already calculated\nint h = 500;\nIntPtr deviceContextHandle;\nGraphics offScreenBufferGraphics;\nGraphics graphics = null;\nMetafile currentMetafile;\nBitmap bmp = new Bitmap(w,h);\noffScreenBufferGraphics = Graphics.FromImage(bmp);\n//offScreenBufferGraphics = Graphics.FromHwndInternal(IntPtr.Zero);\n{\ndeviceContextHandle = offScreenBufferGraphics.GetHdc();\ncurrentMetafile = new Metafile(currentStream, deviceContextHandle, new RectangleF(0, 0, w, h), MetafileFrameUnit.Pixel, EmfType.EmfOnly);\n\noffScreenBufferGraphics.ReleaseHdc();\noffScreenBufferGraphics.Dispose ();\ngraphics = Graphics.FromImage(currentMetafile);\ngraphics.PageUnit = GraphicsUnit.Inch;\ngraphics.SetClip(new RectangleF(0, 0, w, h));\n}\n\n//offScreenBufferGraphics.Dispose ();\ngraphics.PageUnit = GraphicsUnit.Pixel;\n\n// Here i draw smth on graphics, lines, squares etc\n// at the end i do\ngraphics.Flush();\ngraphics.Dispose();\n</code></pre>\n\n<p>At this moment currentStream must have bytes which i want to save to file with FileStream but it always have 0 bytes. Why ??</p>\n\n<p>3) How to save image to EMF with Mono at all ??</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","unit-testing","nunit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13230375,"title":"SetUp is not working for NUnit","body":"<p>I have following NUnit code. I am using a switch case statement inside [SetUp]</p>\n\n<p>Before the test is run it is expected to insert data into database; but it is not inserting data. What need to be corrected here?</p>\n\n<p>REFERENCE:</p>\n\n<ol>\n<li><a href=\"http://programmers.stackexchange.com/questions/173651/nunit-setup-and-teardown\">http://programmers.stackexchange.com/questions/173651/nunit-setup-and-teardown</a></li>\n</ol>\n\n<p>CODE</p>\n\n<pre><code>     [SetUp]\n    public void TestSetUp()\n    {\n        switch (TestContext.CurrentContext.Test.FullName)\n        {\n            case \"GetApplicationsTest\":\n                GetApplicationsTestSETUPHElper();\n                break;\n\n            case \"DeleteApplicationTest\":\n                GetApplicationsTestSETUPHElper();\n                break;\n\n        }\n\n\n    }\n\n    private void GetApplicationsTestSETUPHElper()\n    {\n        SqlConnection connection = new SqlConnection(connectionString);\n        using (connection)\n        {\n            string commandText = \"INSERT INTO Status_Type VALUES (889,'s2','UT s2')\";\n            SqlCommand command = new SqlCommand(commandText, connection);\n            command.CommandType = System.Data.CommandType.Text;\n            connection.Open();\n            command.ExecuteNonQuery();\n        }\n    }\n\n    private void DeleteApplicationTestSETUPHElper()\n    {\n        SqlConnection connection = new SqlConnection(connectionString);\n        using (connection)\n        {\n            string commandText = \"INSERT INTO Status_Type VALUES (890,'s3','UT s3')\";\n            SqlCommand command = new SqlCommand(commandText, connection);\n            command.CommandType = System.Data.CommandType.Text;\n            connection.Open();\n            command.ExecuteNonQuery();\n        }\n    }\n\n    [Test]\n    public void GetApplicationsTest()\n    {\n\n        ApplicationBL application = new ApplicationBL(connectionString);\n        ApplicationSearch applicationSearch = new ApplicationSearch();\n        applicationSearch.ApplicationID = 1;\n        //applicationSearch.ApplicationName = \"Test1\";\n        //applicationSearch.ApplicationURL = \"Test1\";\n        //applicationSearch.StatusCode = 1;\n        Collection&lt;Application&gt; applications =  application.GetApplications(applicationSearch);\n    }\n\n    [Test]\n    public void DeleteApplicationTest()\n    {\n\n        ApplicationBL application = new ApplicationBL(connectionString);\n        ApplicationSearch applicationSearch = new ApplicationSearch();\n        applicationSearch.ApplicationID = 1;\n        //applicationSearch.ApplicationName = \"Test1\";\n        //applicationSearch.ApplicationURL = \"Test1\";\n        //applicationSearch.StatusCode = 1;\n        Collection&lt;Application&gt; applications = application.GetApplications(applicationSearch);\n    }\n</code></pre>\n"},{"tags":[".net","remoting","msdtc","distributed-transactions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13228194,"title":"Distributed Transaction with .Net Remoting","body":"<p>As far as i know, (distributed) transactions are not supported by .net remoting. Unfortunately it is not possible for me to use WCF.</p>\n\n<p>Is it complex to achieve this manually (e.g. by talking to msdtc and enlist MSSQL transactions) ? What API methods or libraries should i use to get this done ?</p>\n\n<p>Background:</p>\n\n<p>At present, we execute some BL Logic from a method inside SQLServer via SQLCLR. This works but has some drawbacks. We have a lot of dependency problems and version conflicts because we must support MSSQL from 2005 to 2012. We have a lot of configuration and update problems because we are using unsupported system assemblies in SQLCLR. This is really a pain and have to get rid of it.</p>\n\n<p>My goal is to move the BL logic to an application server and only use the supported .Net subset for SQLCLR inside MSSQL Server to make the call. The remote method on application service MUST join the existing transaction.</p>\n\n<p>Because WCF is not supported by MS for SQLCLR i have to find an alternative. This are the supported Assemblies (for SQL2012):</p>\n\n<ul>\n<li>CustomMarshalers</li>\n<li>Microsoft.VisualBasic</li>\n<li>Microsoft.VisualC</li>\n<li>mscorlib</li>\n<li>System</li>\n<li>System.Configuration</li>\n<li>System.Data</li>\n<li>System.Data.OracleClient</li>\n<li>System.Data.SqlXml</li>\n<li>System.Deployment</li>\n<li>System.Security</li>\n<li>System.Transactions</li>\n<li>System.Web.Services</li>\n<li>System.Xml</li>\n<li>System.Core.dll</li>\n<li>System.Xml.Linq.dll</li>\n</ul>\n"},{"tags":["c#",".net","winforms","encoding","special-characters"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":40,"score":3,"question_id":13230259,"title":"German special characters put into Byte array","body":"<p>I'm doing encrypt algotythm right now and I need to encrypt german words also. So I have to encrypt for example characters like: ü,ä or ö. </p>\n\n<p>Inside I've got a function: </p>\n\n<pre><code>private static byte[] getBytesArray(string data)\n{\n    byte[] array;\n    System.Text.ASCIIEncoding asciiEncoding = new System.Text.ASCIIEncoding();\n    array = asciiEncoding.GetBytes(data);            \n    return array;\n}\n</code></pre>\n\n<p>But when data is \"ü\", byte returned in array is 63 (so \"?\"). How can I return ü byte? </p>\n\n<p>I also tried: </p>\n\n<pre><code>private static byte[] MyGetBytesArray(string data)\n{\n    byte[] array;\n    System.Text.ASCIIEncoding asciiEncoding = new System.Text.ASCIIEncoding();\n\n    Encoding enc = new UTF8Encoding(true, true);\n    array = enc.GetBytes(data);\n\n    return array;\n}\n</code></pre>\n\n<p>but in this case I get 2 bytes in array: 195 and 188.</p>\n"},{"tags":["c#",".net","asp.net"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":440,"score":0,"question_id":5375851,"title":"Good book for web programming with C#","body":"<p>I want to start web programming with C#. I know C, C++ and Java languages. I just want a source to teach me practically how to make a website. Not a book that says what the basic things are. A practical book. Do you know any good book?</p>\n"},{"tags":["c#",".net","concurrency","mocking","moq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13194680,"title":"Inherit or wrap a class that deals with concurrency","body":"<p>In trying to provide a unit-testable (using Moq) abstraction of <code>ConcurrentQueue&lt;T&gt;</code> I am debating whether I lose the benefits of using the framework's <code>ConcurrentQueue&lt;T&gt;</code> implementation depending on how I author the abstraction.</p>\n\n<p>What are the implications of doing one or the other in the following code listing:</p>\n\n<pre><code>public abstract class MyMessageQueue1&lt;T&gt; : ConcurrentQueue&lt;T&gt;\n{\n    public new virtual void Enqueue(T item)\n    {\n        base.Enqueue(item);\n    }\n}\n\npublic class MyMessageQueue2&lt;T&gt;\n{\n    private readonly ConcurrentQueue&lt;T&gt; _concurrentQueue = \n        new ConcurrentQueue&lt;T&gt;();\n\n    public virtual void Enqueue(T item)\n    {\n        _concurrentQueue.Enqueue(item);\n    }\n}\n</code></pre>\n\n<p>In the first implementation (<code>MyMessageQueue1</code>), I hide any of the base class methods as to provide my implementation before passing the call to the base class.</p>\n\n<p>In the second implementation, I wrap the <code>ConcurrentQueue&lt;T&gt;</code>inside and pass calls to it when I need to.</p>\n\n<p>Does <code>MyMessageQueue2</code> have to manually handle concurrency or does it not matter as all calls are passed to the wrapped <code>ConcurrentQueue&lt;T&gt;</code>.</p>\n"},{"tags":["c#",".net","wcf","design-patterns",".net-4.0"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":13222144,"title":"Wcf services and Db settings?","body":"<p>I was asked to build different <code>WCF</code> services where each do other work against sql.</p>\n\n<p>We have <em>5</em> db's. All db's+connection string are in <em>1</em> xml file. ( file-system file)</p>\n\n<p>The services are hosted under <code>WAS</code> iis 7.5.</p>\n\n<p>since each service should read from db , each service references a <code>DAL dll</code> file.</p>\n\n<p>So here are our components : </p>\n\n<p><img src=\"http://i.stack.imgur.com/Ww7rC.jpg\" alt=\"enter image description here\"></p>\n\n<p>I would like to read the xml data to <code>CACHE</code> ( at the first request) and from now on - read from cache. (reading the file each reqeust is <em>out of the question</em>). </p>\n\n<ul>\n<li>idea #1  = the dll , in his ctor   , at first request will read the xml file and load it to <strong>its</strong> cache.</li>\n</ul>\n\n<p>so the <code>dal</code> will look like this :</p>\n\n<p><img src=\"http://i.stack.imgur.com/Fz0Pc.jpg\" alt=\"enter image description here\"></p>\n\n<p>so now each service can access the DLL's cache object via property. ( one advantage is when dealing with <code>cache dependency</code> on a single file - so when it is changing    , we should reload only to <em>one</em> location).</p>\n\n<ul>\n<li>idea #2 = when service is up , load the xml into <strong>its</strong> <code>cache</code>.</li>\n</ul>\n\n<p>so now , each service will look like this : </p>\n\n<p>Service #1  : </p>\n\n<p><img src=\"http://i.stack.imgur.com/iRHhv.jpg\" alt=\"enter image description here\"></p>\n\n<p>Service #2  : </p>\n\n<p><img src=\"http://i.stack.imgur.com/iRHhv.jpg\" alt=\"enter image description here\"></p>\n\n<p>..</p>\n\n<p>the downside is many cache dependencies on the same file</p>\n\n<p><kbd>Question : </kbd></p>\n\n<p>By the best practice experience and by design pattern <em>POV</em> : which is the preferred way ? </p>\n\n<p><em>p.s. the xml file change frequency 1/(1 month)</em></p>\n"},{"tags":["c#",".net","reflection","reflection.emit"],"answer_count":12,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":1394,"score":12,"question_id":2312623,"title":"Real world uses of Reflection.Emit","body":"<p>In all the books I've read on reflection they often say that there aren't many cases where you want to generate IL on the fly, but they don't give any examples of where it does make sense.  </p>\n\n<p>After seeing Reflection.Emit as a job requirement for a gaming company I was curious where else it's being used.</p>\n\n<p>I'm now wondering if there are any situations you've seen in the real world were it was the best solution to the problem.  Perhaps it is used as an implementation to a design pattern?</p>\n\n<p><strong>Note</strong>\nI imagine <a href=\"http://www.sharpcrafters.com/\" rel=\"nofollow\">PostSharp</a> / AOP uses it.</p>\n"},{"tags":["c#",".net","unit-testing","garbage-collection"],"answer_count":4,"favorite_count":11,"up_vote_count":16,"down_vote_count":1,"view_count":1654,"score":15,"question_id":578967,"title":"How can I write a unit test to determine whether an object can be garbage collected?","body":"<p>In relation to <a href=\"http://stackoverflow.com/questions/578593/castle-windsor-will-my-transient-component-be-garbage-collected\">my previous question</a>, I need to check whether a component that will be instantiated by Castle Windsor, can be garbage collected after my code has finished using it. I have tried the suggestion in the answers from the previous question, but it does not seem to work as expected, at least for my code. So I would like to write a unit test that tests whether a specific object instance can be garbage collected after some of my code has run.</p>\n\n<p>Is that possible to do in a reliable way ? </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I currently have the following test based on Paul Stovell's answer, which succeeds:</p>\n\n<pre><code>     [TestMethod]\n    public void ReleaseTest()\n    {\n        WindsorContainer container = new WindsorContainer();\n        container.Kernel.ReleasePolicy = new NoTrackingReleasePolicy();\n        container.AddComponentWithLifestyle&lt;ReleaseTester&gt;(LifestyleType.Transient);\n        Assert.AreEqual(0, ReleaseTester.refCount);\n        var weakRef = new WeakReference(container.Resolve&lt;ReleaseTester&gt;());\n        Assert.AreEqual(1, ReleaseTester.refCount);\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        Assert.AreEqual(0, ReleaseTester.refCount, \"Component not released\");\n    }\n\n    private class ReleaseTester\n    {\n        public static int refCount = 0;\n\n        public ReleaseTester()\n        {\n            refCount++;\n        }\n\n        ~ReleaseTester()\n        {\n            refCount--;\n        }\n    }\n</code></pre>\n\n<p>Am I right assuming that, based on the test above, I can conclude that Windsor will not leak memory when using the NoTrackingReleasePolicy ?</p>\n"},{"tags":["asp.net",".net","iis6"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13159761,"title":"IIS cannot load global type despite of existing dll","body":"<p>I'm trying to get an application to run on an IIS 6.0 that I was assigned to support.</p>\n\n<p>I copied all the source and binaries to the Inetput folder. The WebApp is running, but I get the error that tells me that the global type of the application could not be loaded.</p>\n\n<p>How can I debug this? The namespace is correct, the DLL is present in the /bin/ folder of the application, and still the app cannot load it.</p>\n\n<p>After turning on Fusion logging, I found this error file that concerns my global class;</p>\n\n<pre><code>*** Assembly Binder Log Entry  (05.11.2012 @ 08:45:30) ***\n\nThe operation failed.\nBind result: hr = 0x80131107. No description available.\n\nAssembly manager loaded from:  C:\\WINDOWS\\Microsoft.NET\\Framework\\v1.1.4322\\fusion.dll\nRunning under executable  c:\\windows\\system32\\inetsrv\\w3wp.exe\n--- A detailed error log follows. \n\n=== Pre-bind state information ===\nLOG: DisplayName = MyApplication\n (Partial)\nLOG: Appbase = file:///c:/inetpub/wwwroot/MyApplication\nLOG: Initial PrivatePath = bin\nLOG: Dynamic Base = C:\\WINDOWS\\Microsoft.NET\\Framework\\v1.1.4322\\Temporary ASP.NET Files\\MyApplication\\a1144233\nLOG: Cache Base = C:\\WINDOWS\\Microsoft.NET\\Framework\\v1.1.4322\\Temporary ASP.NET Files\\MyApplication\\a1144233\nLOG: AppName = 1ec25e47\nCalling assembly : (Unknown).\n===\n\nLOG: Processing DEVPATH.\nLOG: DEVPATH is not set. Falling through to regular bind.\nLOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).\nLOG: Post-policy reference: MyApplication\nLOG: Attempting download of new URL file:///C:/WINDOWS/Microsoft.NET/Framework/v1.1.4322/Temporary ASP.NET Files/MyApplication/a1144233/1ec25e47/MyApplication.DLL.\nLOG: Attempting download of new URL file:///C:/WINDOWS/Microsoft.NET/Framework/v1.1.4322/Temporary ASP.NET Files/MyApplication/a1144233/1ec25e47/MyApplication/MyApplication.DLL.\nLOG: Attempting download of new URL file:///c:/inetpub/wwwroot/MyApplication/bin/MyApplication.DLL.\nLOG: Assembly download was successful. Attempting setup of file: c:\\inetpub\\wwwroot\\MyApplication\\bin\\MyApplication.DLL\nLOG: Entering download cache setup phase.\nERR: Error extracting manifest import from file (hr = 0x80131107).\nERR: Setup failed with hr = 0x80131107.\nERR: Failed to complete setup of assembly (hr = 0x80131107). Probing terminated.\n</code></pre>\n\n<p>What's going wrong there? The <code>bin\\MyApplication.DLL</code> exists and is compiled correctly, so I don't see the problem...</p>\n"},{"tags":["c#",".net","visual-studio","windows-8","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13220837,"title":"Add entire folder to packaging Winrt in Visual Studio 2012","body":"<p>I have a folder <code>Assets/source</code>. It has a lot of files (.png,.xml ...) and also divided with sub folders inside. Is it possible to have them all copy to the output directory without manually setting them one by one? or to copying this folder to  <code>/LocalState</code> at runtime?\n<img src=\"http://i.stack.imgur.com/CwCNX.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried adding it to paths, I cant seem to find it in the installation folder after install. Thanks for any advice.</p>\n"},{"tags":[".net","vb.net","office-interop","excel-interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13015799,"title":"System.Runtime.InteropServices.COMException (0x80010108) when creating an instance of Excel in vb.net 3.5","body":"<p>So, I have a program that launches an instance of Excel. It works on my machine as well as the machines of 2 others, but when my project leader tries it, he gets the following error:</p>\n\n<pre><code>    System.Runtime.InteropServices.COMException (0x80010108): Creating an instance of the COM component with CLSID {00024500-0000-0000-C000-000000000046} from the IClassFactory failed due to the following error: 80010108.\n</code></pre>\n\n<p>The code below is where I'm creating the excel instance and launching it.</p>\n\n<pre><code>    Dim xlsApp As New Excel.Application\n    Dim xlsWB As Excel.Workbook\n    Dim xlsWS As Excel.Worksheet\n\n    Try\n        If ugLoadDeviationsDetails.DataSource IsNot Nothing Then\n\n            'Creates a temporary excel file with data located in the grid\n            UltraGridExcelExporter1.Export(ugLoadDeviationsDetails, \"C:\\ProgramData\\Data-Tronics\\ShellFiles\\LoadDeviations\\tempExcel\")\n\n            xlsWB = xlsApp.Workbooks.Open(\"C:\\ProgramData\\Data-Tronics\\ShellFiles\\LoadDeviations\\tempExcel\")\n\n            xlsWS = DirectCast(xlsWB.Sheets(\"Sheet1\"), Excel.Worksheet)\n            DirectCast(xlsWS.Cells.EntireRow, Excel.Range).ClearFormats()\n            DirectCast(DirectCast(xlsWS.Cells(\"1\", \"A\"), Excel.Range).EntireRow().Cells, Excel.Range).Interior.Color = Color.LightGray.ToArgb\n\n            DirectCast(xlsWS, Excel.Worksheet).Copy()\n\n            xlsWB.Close(False)\n\n            xlsApp.Visible = True\n            xlsApp.UserControl = True\n\n        Else\n            RaiseEvent ShowError(\"Cannot write file when grid is empty.\")\n        End If \n    Catch ex As Exception\n\n        For Each wb As Excel.Workbook In xlsApp.Workbooks\n            wb.Close(False)\n        Next\n        xlsApp.Quit()\n    Finally\n        xlsApp = Nothing\n        xlsWB = Nothing\n        xlsWS = Nothing\n    End Try\n</code></pre>\n\n<p>According to the stacktrace it breaks on the following line:</p>\n\n<pre><code>    Dim xlsApp As New Excel.Application\n</code></pre>\n\n<p>The project lead uses the exact same version of Excel as I do (2010), can anyone think of any reason as to why this may occur, and how I may fix it?</p>\n"},{"tags":["c#",".net","join","ienumerable","expressions"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13229179,"title":"Compiling a lambda expression with multiple input parameters on two IEnumerables","body":"<p>I have two <code>IEnumerables</code> called <code>IEnumerable&lt;TBL_Country&gt;</code> and <code>IEnumberable&lt;TBL_City&gt;</code> which their table definitions came from my ORM and I would like to execute the following Expression Function in order to join the IEnumerables but it's not possible. \nAny Idea!</p>\n\n<pre><code>IEnumerable&lt;TBL_COUNTRY&gt; country = new IEnumerable&lt;TBL_Country&gt;();\nIEnumerable&lt;TBL_COUNTRY&gt; city = new IEnumerable&lt;TBL_CITY&gt;();\nExpression&lt;Func&lt;TBL_COUNTRY,TBL_CITY,bool&gt;&gt; func =\n    (p,q) =&gt; p.fk_city_id = q.pk_city_id &amp; p.name = \"SomeName\";\n</code></pre>\n"},{"tags":["c#",".net","audio"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1042,"score":3,"question_id":2266246,"title":"Mixing multiple audio samples into single file with C#","body":"<p>I'm looking for a library capable of creating an audio file (mp3 or wav).<br>\n<a href=\"http://www.codeplex.com/naudio\" rel=\"nofollow\">NAudio</a> stands out as a good candidate, but not sure if and how it can do specifically what I need.</p>\n\n<p>I want to mix a number of audio samples into a single file, have them play simultaneously with control over each sample's start and end timing when \"rendering\" the audio file.</p>\n\n<p>Is this possible with NAudio? If so, how? Can you point out a good tutorial?<br>\nAlso, are there any other recommended .net audio libraries?</p>\n\n<p>Thanks!</p>\n"},{"tags":[".net","visual-studio","xsd.exe"],"answer_count":7,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":3283,"score":3,"question_id":2142197,"title":".Net xsd.exe tool doesn't generate all types","body":"<p>For some reason, MS .Net (v3.5) tool - xsd.exe doesn't generate types when they are not used inside any element.</p>\n\n<p>e.g.</p>\n\n<p>XSD File (I threw in the complex element to avoid this warning - \"Warning: cannot generate classes because no top-level elements with complex type were found.\"):</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;xs:schema targetNamespace=\"http://tempuri.org/XMLSchema.xsd\"\n    elementFormDefault=\"qualified\"\n    xmlns=\"http://tempuri.org/XMLSchema.xsd\"\n    xmlns:mstns=\"http://tempuri.org/XMLSchema.xsd\"\n    xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\n&gt;\n  &lt;xs:simpleType name=\"EnumTest\"&gt;\n    &lt;xs:restriction base=\"xs:string\"&gt;\n      &lt;xs:enumeration value=\"item1\" /&gt;\n      &lt;xs:enumeration value=\"item2\" /&gt;\n      &lt;xs:enumeration value=\"item3\" /&gt;\n    &lt;/xs:restriction&gt;\n  &lt;/xs:simpleType&gt;\n  &lt;xs:complexType name=\"myComplexType\"&gt;\n    &lt;xs:attribute name=\"Name\" use=\"required\" type=\"xs:string\"/&gt;\n  &lt;/xs:complexType&gt;\n  &lt;xs:element name=\"myElem\" type=\"myComplexType\"&gt;&lt;/xs:element&gt;\n&lt;/xs:schema&gt;\n</code></pre>\n\n<p>When i run this thru xsd.exe using</p>\n\n<blockquote>\n  <p>xsd /c xsdfile.xsd</p>\n</blockquote>\n\n<p>I don't see EnumTest in the generated cs file. </p>\n\n<p>Note; Even though I don't use the enum here, but in my actual project, I have cases like this where we send enum's string value as output.</p>\n\n<p>How can I force the xsd tool to include these? Or should I switch to some other tool? </p>\n\n<p>I work in Visual Studio 2008.</p>\n"},{"tags":[".net","sql-server","logging","microsoft","sqlclr"],"answer_count":5,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":1393,"score":8,"question_id":7034969,"title":"SQL Server stops loading assembly","body":"<p>We have developed an assembly for the SQL Server 2008 R2.</p>\n\n<p>The assembly has been working for a week.  The managed stored proc inside the assembly was working fine for the whole week and then it stops working.  We have been seeing this problem couple times.  The way to make it work again is to restart the SQL Server.</p>\n\n<pre><code>Msg 10314, Level 16, State 11, Line 4\nAn error occurred in the Microsoft .NET Framework while trying to load assembly id 65536. The server may be running out of resources, or the assembly may not be trusted with PERMISSION_SET = EXTERNAL_ACCESS or UNSAFE. Run the query again, or check documentation to see how to solve the assembly trust issues. For more information about this error: \n  System.IO.FileLoadException: Could not load file or assembly 'myAssembly, Version=2.0.0.490, Culture=neutral, PublicKeyToken=5963130873dd3a75' or one of its dependencies. Exception from HRESULT: 0x80FC0E21 System.IO.FileLoadException:\n  at System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection)\n  at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection)\n  at System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection)\n  at System.Reflection.Assembly.Load(String assemblyString)\n</code></pre>\n\n<p>I have found different articles on the web.  </p>\n\n<p><a href=\"http://support.microsoft.com/kb/918040\">This KB</a> suggested that I might have restored the database from another SQL Server, which I swear I didn't.  </p>\n\n<p><a href=\"http://www.sqlskills.com/BLOGS/BOBB/category/SQLCLR.aspx\">This blog</a> said I might run into this if I installed .NET 3.5 on SQL Server 2005 but mine was SQL Server 2008 R2 and I did not install anything when this problem occurs.</p>\n\n<p>The main point is that it can keep going for a period of time.  It just stops working randomly.  Then, if we restart the SQL Server, it will start working again.  I have thought of my server was really running out of memory but now, I just see the problem again.  SQL Server is using 300MB RAM only and my server has 16GB RAM.  This sounds impossible that it's because I am running out of memory.</p>\n\n<p>Now, I want to collect more information on this problem.  Any log that I can turn on and look at?  Any suggestion that help troubleshooting this problem is welcome.</p>\n\n<p>I have run some SQL queries.</p>\n\n<pre><code>SELECT * from sys.dm_clr_properties\n=============================================\ndirectory   C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\\nversion v2.0.50727\nstate   CLR is initialized\n</code></pre>\n\n<p>.</p>\n\n<pre><code>SELECT * from sys.dm_clr_appdomains\n======================================================\n0x0000000087160240  3   mydatabase.dbo[runtime].2   2011-08-12 08:44:08.940 10  1   E_APPDOMAIN_SHARED  1   1\n</code></pre>\n\n<p>.</p>\n\n<pre><code>SELECT * from sys.dm_clr_tasks\n======================================================\n0x000000008185A080  0x00000000818562C8  0x0000000000000000  E_TASK_ATTACHED_TO_CLR  E_ABORT_NONE    E_TYPE_ADUNLOAD 0   0\n0x00000000818CE080  0x00000000818CA2C8  0x0000000000000000  E_TASK_ATTACHED_TO_CLR  E_ABORT_NONE    E_TYPE_FINALIZER    0   0\n0x0000000081AD4C30  0x000000000400D048  0x0000000000000000  E_TASK_ATTACHED_TO_CLR  E_ABORT_NONE    E_TYPE_USER 0   0\n</code></pre>\n\n<p>.</p>\n\n<pre><code>SELECT * from sys.dm_clr_loaded_assemblies\n&lt;returns nothing&gt;\n</code></pre>\n\n<p><strong>* UPDATE *</strong></p>\n\n<p>On my SQL Server, I have created four databases.  Each of them with the same assembly attached to it.  Now, SQL Server refused to load the assembly and gave me the above error.</p>\n\n<p><code>SELECT * from sys.dm_clr_appdomains</code> shows me at that point there was only one appdomain loaded and <code>SELECT * from sys.dm_clr_loaded_assemblies</code> showed me there were no assemblies loaded at all.</p>\n\n<p>Then, I ran the same stored proc on the other three databases.  It worked and successfully loaded up the assemblies and successfully ran the stored proc.  After executing the stored proc.  <code>SELECT * from sys.dm_clr_appdomains</code> now shows me there are only four appdomain loaded and <code>SELECT * from sys.dm_clr_loaded_assemblies</code> showed me there are now three assemblies loaded.</p>\n\n<p>This makes sense.  Now, I hope if I run the stored proc again in the original database, it should get the assembly loaded as it were.  Guess what.  No, it doesn't.  It still gives me the same error.  It looks like this database is completely stuck.  The only way to fix it is to reboot the SQL Server.  I am hoping there is a flag/lock somewhere in the system table holding up this.  I cannot find it.  Any idea is welcome.</p>\n\n<p>Now, my SQL Server is in the state that requiring me to reboot to make it work again.  </p>\n\n<p><strong>* UPDATE (8/31/2011) *</strong></p>\n\n<p>It sounds like it's related to the database owner of the database.  This is kind of complicated.  We have two sites and two AD forests.  The SQL Server machine is joined to forest A but the database owner is from forest B.  The connection between forest A and forest B is not that stable since they are in two different sites physically connected by WAN.</p>\n\n<p>Once I change the database owner to a SQL Login (Non-Windows account), my stored proc is up running for couple weeks so far with no interruption.</p>\n\n<p>I will accept the answer if anybody can explain it.</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13229386,"title":"how to make an updating datagridview freely scrollable","body":"<p>I've a <code>databound datagridiew</code> that I've implemented to update periodically. The problem is that when the <code>datagridviews</code> contents are updated the <code>datagridview</code> automatically jumps to display the last selected item.</p>\n\n<p>I've implemented the following code so the top row is always displayed:</p>\n\n<pre><code>dataGridView1.ClearSelection();\ndataGridView1.CurrentCell = null;\ndataGridView1.FirstDisplayedScrollingRowIndex = 0;\n</code></pre>\n\n<p>But it would be preferable if the entries in the <code>datagridview</code> could be scrolled freely whilst new entries are being added.</p>\n\n<p>N.B. if I remove the line:</p>\n\n<pre><code>dataGridView1.FirstDisplayedScrollingRowIndex = 0;\n</code></pre>\n\n<p>The <code>datagridview</code> will still jump to display the last selected row so I'm guessing there is another property I need to set but it can't find it!</p>\n"},{"tags":["c#",".net","sql-server"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1568,"score":1,"question_id":5899358,"title":"Addslashes / escape single quote in .NET","body":"<p>I'm maintaining a piece of code that concatenates SQL queries like:</p>\n\n<pre><code>string sql = \"SELECT* FROM table WHERE column = '\" + value + \"'\";\n</code></pre>\n\n<p>Now it turned out that if <strong>value</strong> contains <strong>'</strong> characted it will break SQL Server text statement. I searched a bit for method similar to PHP addslashes, but without success. There's <strong>Regex.Escape</strong> but it didn't do the trick. Is there any other way to address that issue except calling <strong>Replace</strong> method on string?:</p>\n\n<pre><code>string sql = \"SELECT* FROM table WHERE column = '\" + value.Replace(\"'\", \"''\") + \"'\";\n</code></pre>\n\n<p>Thanks,\nPaweł</p>\n"},{"tags":[".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":23,"score":-4,"question_id":13228784,"title":"Can .Net framework technology make a web application for virtual class?","body":"<p>I want to build a web application for the purpose:</p>\n\n<p>It is a VIRTUAL CLASSROOM SOFTWARE for ONLINE TEACHING AND TRAINING SOLUTIONS, for live classes</p>\n\n<p>This web like some product of <a href=\"http://www.e-lecta.com\" rel=\"nofollow\">http://www.e-lecta.com</a> or <a href=\"http://www.wiziq.com/\" rel=\"nofollow\">http://www.wiziq.com/</a> but my product is smaller</p>\n\n<ul>\n<li>It's can run online presentations. </li>\n<li>Share screen, files and web cam.</li>\n<li>Our teacher teach over the Internet with Shared Whiteboards(can write, draw on it), Audio, Video. Set up limited students.</li>\n</ul>\n\n<p>So I want to ask: can I use .Net Framework to do this requirement above and can you show me some way for this problem?</p>\n\n<p>Thank you!</p>\n"},{"tags":[".net","wcf","web-config","iis-7.5"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1487,"score":0,"question_id":6645842,"title":"WCF and windows authentication not working","body":"<p>I cant get my WCF serve to windows authenticate</p>\n\n<p>If I allow anonymous everything works, no errors.</p>\n\n<p>I'm running .Net 3.5 on windows  2008 r2 standard SP1\nIIS 7.5, if it matters VS 2010</p>\n\n<p>I have used the WCF Service configuration editor to try and validate what I am doing, still no luck</p>\n\n<p>I get the error after a decent wait 20-30 seconds</p>\n\n<pre><code>Security settings for this service require 'Anonymous' Authentication but it is not enabled for the IIS application that hosts this service. \nDescription: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. \n\nException Details: System.NotSupportedException: Security settings for this service require 'Anonymous' Authentication but it is not enabled for the IIS application that hosts this service.\n</code></pre>\n\n<p>my web.config is</p>\n\n<pre><code>  &lt;system.serviceModel&gt;\n    &lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\"/&gt;\n\n    &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n        &lt;binding name=\"AmjBasicHttpEndpointBinding\"&gt;\n          &lt;security mode=\"None\"&gt;\n            &lt;transport clientCredentialType=\"Windows\" /&gt;\n          &lt;/security&gt;\n        &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n\n    &lt;/bindings&gt;\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"SMS.Services.BEIMBehavior\"&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;services&gt;\n      &lt;service behaviorConfiguration=\"SMS.Services.BEIMBehavior\" name=\"SMS.Services.BEIM\"&gt;\n        &lt;endpoint address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"AmjBasicHttpEndpointBinding\"\n          name=\"BeimServices\" contract=\"SMS.Services.IBEIM\"&gt;\n          &lt;identity&gt;\n            &lt;dns value=\"localhost\" /&gt;\n          &lt;/identity&gt;\n        &lt;/endpoint&gt;\n        &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\" /&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>EDIT\nthe error message is on the web page. <a href=\"http://Servername/Directory/pageName.svc\" rel=\"nofollow\">http://Servername/Directory/pageName.svc</a></p>\n"},{"tags":["c#",".net","telerik","telerik-reporting"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":964,"score":1,"question_id":5556926,"title":"Telerik Reporting - Subreport - reportsource","body":"<p>I have been working with reports for the past one month or so. I am presently working with subreports.\nSay I have a telerik reporting file (report_1) which has a subreport element in it. In the same project as report_1 is, I have couple of other telerik reporting files. Cant I refer these reporting files as report source of the subreport in report_1?\nIf yes, I am not able to see them in the dropdown of the reportsource property.\nIf no, why?\nOr is there anything that I am missing? or, is there anything that I need to do to get the reporting files on to the dropdown.\nI have seen your previous postings, which said about re-building the project. But, I am  not building the project through visual studio. So, please suggest what can be done. </p>\n"},{"tags":["c#",".net","excel","list","generic-list"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":12602,"score":2,"question_id":1059951,"title":"Export a C# List of Lists to Excel","body":"<p>Using C#, is there a direct way to export a List of Lists (i.e., <code>List&lt;List&lt;T&gt;&gt;</code>) to Excel 2003?</p>\n\n<p>I am parsing out large text files and exporting to Excel. Writing one cell at a time creates way too much overhead. I chose to use <code>List&lt;T&gt;</code> so that I would not have to worry about specifying the number of rows or columns.</p>\n\n<p>Currently, I wait until end of file, then put the contents of my <code>List&lt;List&lt;object&gt;&gt;</code> into a 2-dimensional array. Then the array can be set as the value of an Excel.Range object. It works, but it seems like I should be able to take my List of Lists, without worrying about the number of rows or columns, and just dump it into a worksheet from A1 to wherever.</p>\n\n<p>Here's a snippet of the code I'd like to replace or improve on:</p>\n\n<pre><code>object oOpt = System.Reflection.Missing.Value; //for optional arguments\nExcel.Application oXL = new Excel.Application();\nExcel.Workbooks oWBs = oXL.Workbooks;\nExcel._Workbook oWB = oWBs.Add(Excel.XlWBATemplate.xlWBATWorksheet);\nExcel._Worksheet oSheet = (Excel._Worksheet)oWB.ActiveSheet;\n\nint numberOfRows = outputRows.Count;\nint numberOfColumns = int.MinValue;\n\n//outputRows is a List&lt;List&lt;object&gt;&gt;\nforeach (List&lt;object&gt; outputColumns in outputRows)\n{\n        if (numberOfColumns &lt; outputColumns.Count)\n        { numberOfColumns = outputColumns.Count; }\n}\n\nExcel.Range oRng = oSheet.get_Range(\"A1\", oSheet.Cells[numberOfRows,numberOfColumns]);\n\nobject[,] outputArray = new object[numberOfRows,numberOfColumns];\n\nfor (int row = 0; row &lt; numberOfRows; row++)\n{\n        for (int col = 0; col &lt; outputRows[row].Count; col++)\n        {\n                outputArray[row, col] = outputRows[row][col];\n        }\n}\n\noRng.set_Value(oOpt, outputArray);\n\noXL.Visible = true;\noXL.UserControl = true;\n</code></pre>\n\n<p>This works, but I'd rather use the List directly to Excel than having the intermediary step of creating an array just for the sake of Excel. Any ideas?</p>\n"},{"tags":["c#",".net","json","formatting","json.net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":13219486,"title":"Remove Unneeded Spaces from JSON Output","body":"<p>I am sterilizing a JSON.Net object, and it contains many arrays. Here is the output I currently get:</p>\n\n<pre><code>\"children\": [ \n{ \n      \"children\": [ \n      {\n      },\n      {\n      }\n}\n</code></pre>\n\n<p>However, just for the ease of reading and comparing, I would like to remove the line breaks between each brace and bracket and between the comma and next brace, so it looks like this:</p>\n\n<pre><code>\"children\": [ { \n      \"children\": [ {\n\n      }, {\n      }\n}\n</code></pre>\n\n<p>I am already sterilizing my JSON with the <code>Formatting.Indented</code> argument, so I would like to know if there is another setting I can change so that JSON.Net sterilizes without the extra line brakes, but retaining the indented formatting.</p>\n"},{"tags":["c#",".net","wpf","asynchronous","task-parallel-library"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":558,"score":3,"question_id":8594975,"title":"Why will an empty .NET Task not complete if started and waited for from a static constructor?","body":"<p>I cannot understand why the following code will not work:</p>\n\n<pre><code>var task = new Task(() =&gt; { });\ntask.Start();\nif (task.Wait(10000))\n{\n   logger.Info(\"Works\");\n}\nelse\n{  \n   logger.Info(\"Doesn't work\");\n}\n</code></pre>\n\n<p>The task status is stuck on \"Running\" after the timeout expires, although there is nothing to be done. Replacing <code>task.Start()</code> with <code>task.RunSynchronously()</code> will work however.</p>\n\n<p>Does anyone have an idea of what I may be doing wrong? </p>\n\n<p>A test project to replicate the issue is available here: <a href=\"http://erwinmayer.com/dl/TaskTestProject.zip\" rel=\"nofollow\">http://erwinmayer.com/dl/TaskTestProject.zip</a>. As far as I can see, it doesn't work if the method with the above code runs within the static constructor. But it works if called directly as a static class method.</p>\n\n<p>This recent MSDN blog post seems to highlight related issues with static constructors: <a href=\"http://blogs.msdn.com/b/pfxteam/archive/2011/05/03/10159682.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/pfxteam/archive/2011/05/03/10159682.aspx</a></p>\n"},{"tags":["c#",".net","powershell"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13228142,"title":"What is the correct way of doing: $attachment = $logdir +'\\'+ $logFileName in PowerShell?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/495618/how-to-normalize-a-path-in-powershell\">How to normalize a path in PowerShell?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to get rid of +'\\'+ in this file name construction :</p>\n\n<pre><code>$attachment = $logdir +'\\'+ $logFileName\n</code></pre>\n\n<p>in PowerShell script.</p>\n\n<p>What is the correct way of combining directory name and file name in PS?</p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":6,"view_count":26,"score":-6,"question_id":13228388,"title":"quickest way to check video recording","body":"<p>we have a dvr video recording system.we want to record our company advertisment.for example if a tv channel runing our company add 10 times a day..we need to record 24 hours channel recording and after 24 hours recording.we need  to check all 24 hours recording to verify this is realy time consuming.is it possilbe to direct jump our comany add or any other short method to check our company add in recorded video clips\nthanks regards</p>\n"},{"tags":[".net","memory-management","memory-leaks","windbg","unmanaged-memory"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13174923,"title":"Analysis of extreme private bytes usage in .Net application, native memory leak?","body":"<p>We have a .Net website running, which is using an extreme amount of private bytes: 4,45 GBytes and up.\nThis has occurred on multiple webservers, but there does not seem to be a pattern.</p>\n\n<p>With the help of some other answers and of course <a href=\"http://blogs.msdn.com/b/tess/\" rel=\"nofollow\">the blog of Tess Ferrandez</a>, we got a lot of information already, using <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=26798\" rel=\"nofollow\">DebugDiag</a> and WinDbg (part of <a href=\"http://msdn.microsoft.com/en-US/windows/hardware/hh852363\" rel=\"nofollow\">Win8 SDK</a>):</p>\n\n<ul>\n<li><p>We know there's only a single allocation that is consuming over 3 GBytes:\n<img src=\"http://i.stack.imgur.com/TeV8D.png\" alt=\"enter image description here\"></p></li>\n<li><p>We know it's native memory:\n<img src=\"http://i.stack.imgur.com/D3M3j.png\" alt=\"enter image description here\"></p></li>\n<li><p>We know it's allocated on Heap 1:\n<img src=\"http://i.stack.imgur.com/NtjoZ.png\" alt=\"enter image description here\"></p></li>\n</ul>\n\n<p>From here on we are stuck.\nThe suggested commands (!heap -stat -h, !heap -flt s and !heap -p -a), that can also be found <a href=\"http://windbg.info/doc/1-common-cmds.html\" rel=\"nofollow\">here</a>, do not provide us with information on the cause of this behavior.</p>\n\n<p>Has anyone seen this before?  Are there other ways or commands to see what is causing nativerd (Native Code Configuration Reader of IIS) to go berserk?</p>\n"},{"tags":["c#",".net","transactions"],"answer_count":6,"favorite_count":35,"up_vote_count":41,"down_vote_count":0,"view_count":11502,"score":41,"question_id":224689,"title":"Transactions in .net","body":"<p>What are the best practices to do transactions in C# .Net 2.0. What are the classes that should be used? What are the pitfalls to look out for etc. All that commit and rollback stuff. I'm just starting a project where I might need to do some transactions while inserting data into the DB. Any responses or links for even basic stuff about transactions are welcome. </p>\n"},{"tags":["c#",".net","design","design-patterns","modeling"],"answer_count":23,"favorite_count":65,"up_vote_count":120,"down_vote_count":1,"view_count":4060,"score":119,"question_id":750112,"title":"Overengineering - How to avoid it","body":"<p>Sometimes I find myself designing my classes for a certain project. I start with some entities, some interfaces, but after some time I think:</p>\n\n<p>Hey what about creating a handler for the classes using a Factory Method, Strategy, Using Generics, etc, etc, etc.</p>\n\n<p>At some point when I look to my classes I have a lot of generics, small objects, everything turn so complicated that I feel demotivated. I turn a simple project into a NOT COMPLETED PSEUDO FRAMEWORK. And I've never created a framework before.</p>\n\n<p>How do you battle the impulse to complicate things? How do yo recognise the point where you should stop the utopic design and start doing working things?</p>\n"},{"tags":["c#","java",".net","virtual-functions"],"answer_count":10,"favorite_count":15,"up_vote_count":39,"down_vote_count":0,"view_count":3787,"score":39,"question_id":814934,"title":"Why C# implements methods as non-virtual by default?","body":"<p>Unlike Java, why does C# treat methods as non-virtual functions by default?  Is it more likely to be a performance issue rather than other possible outcomes?</p>\n\n<p>I am reminded of reading a paragraph from Anders Hejlsberg about several advantages the existing architecture is bringing out. But, what about side effects? Is it really a good trade-off to have non-virtual methods by default?</p>\n"},{"tags":["c#",".net","azure","windows-azure-storage"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13176920,"title":"Azure Blob Lease and release","body":"<pre><code>string uri = \"myurl\";\nstring blobstatus = GetBlobStatus(uri);\nif (blobstatus != LeaseStatus.Locked.ToString())\n{\n    string response = AquireBlob(uri);\n    //process data.\n    string abc = \":em\";\n    ReleaseBlob(response, uri);\n}\n</code></pre>\n\n<p>Above is my code for leasing and releasing locks on blob. I'm looking at this method to use for multi-instance worker role where I want to run a specific code after <code>x</code> interval of time, as multiple instances could execute the code at same time.</p>\n\n<p>The problem is that I manage to get the <code>LeaseId</code> properly but when the second instance checks blob lease status it is always unspecified. Why it is so? any clues?</p>\n\n<p>I followed the following link for getting a head start.</p>\n\n<p><a href=\"http://blog.smarx.com/posts/leasing-windows-azure-blobs-using-the-storage-client-library\" rel=\"nofollow\">Leasing Windows Azure Blobs Using the Storage Client Library - blog.smarx.com</a></p>\n"},{"tags":["c#",".net","excel","datetime","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":12858310,"title":"reading excel fetching date in general format","body":"<p>In the application we have a wizard with multiple tabs. On the first tab we can select a excel sheet path using a browse button. The moment you select the excel, excel file contents are loaded in a dataset (everything in correct format including DATE fields). Then click Next to go to the next wizard tab.</p>\n\n<p>But if the file is open program loads the excel and this time with all the date fields in General format.\neg: 6/22/2006 as 38890</p>\n\n<p>We are trying to find if the excel is open or being used by another format as:</p>\n\n<pre><code>    bool IsFilebeingUsed(FileInfo file)\n    {\n        FileStream stream = null;\n\n        try\n        {\n            stream = file.Open(FileMode.Open, FileAccess.Read, FileShare.None);\n        }\n        catch (IOException)\n        {\n            return true;\n        }\n        finally\n        {\n            if (stream != null)\n                stream.Close();\n        }\n        return false;\n    }\n</code></pre>\n\n<p>The way we are trying to read the excel is as follows:</p>\n\n<pre><code>string sql = string.Format(\"SELECT * FROM [{0}]\", excelSheetName);\ninternal OleDbCommand command = new OleDbCommand();\ncommand.CommandText = sql;\nOleDbDataReader oleRdr = command.ExecuteReader();\n\nDataTable dataTable = new DataTable();\ndatatable.TableName = excelSheetName;\ndataTable.Load(oleRdr);\n</code></pre>\n\n<p>Can anyone tell whats wrong with the application or code?</p>\n"},{"tags":["c#",".net","excel","connection-string","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":101,"score":0,"question_id":12893284,"title":"Reading excel data when the file is open","body":"<p>Few days back I asked a <a href=\"http://stackoverflow.com/questions/12858310/reading-excel-fetchig-date-in-general-format#comment17403185_12858310\">question</a> but could not find enough answers. I analyzed the problem a bit more and decided to create a new thread. If I should have not, let me know or close the question.</p>\n\n<p>I have an <strong>OPEN</strong> excel file with a column in Date format with some values like 6/22/2006, 6/22/2006. I am trying to read the excel using OleDbDataReader. The code is like this:</p>\n\n<pre><code>string sql = string.Format(\"SELECT * FROM [{0}]\", excelSheetName);\ninternal OleDbCommand command = new OleDbCommand();\ncommand.CommandText = sql;\nOleDbDataReader oleRdr = command.ExecuteReader();\n\nDataTable dataTable = new DataTable();\ndatatable.TableName = excelSheetName;\ndataTable.Load(oleRdr);\n</code></pre>\n\n<p>I am using the connection string as:</p>\n\n<pre><code>string connectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\\ExcelData\\sample.xls;Extended Properties='Excel 8.0;HDR=No;IMEX=1'\";\n</code></pre>\n\n<p>The problem is I am not able to read the date values in correct (<code>DateTime</code>) format. I believe everything is treated as numeric format. So my result is</p>\n\n<p><code>6/22/2006 as 38890</code></p>\n\n<p>After reading some articles on internet, I understood my column is having multiple datatypes and then I changed my connection string as:</p>\n\n<pre><code>string connectionString = @\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\\ExcelData\\sample.xls;Extended Properties=\"Excel 8.0;HDR=No;IMEX=1;ImportMixedTypes=Text;TypeGuessRows=0\"\";\n</code></pre>\n\n<p>But still I am not able to read the excel in correct format. Any suggestions on this. It looks a weird problem to me. Please let me know if I to need to provide some more information.</p>\n\n<p>Note: Also make a note that when my excel file is closed both the connection strings give me the correct data. Also for new doc formats<code>.xlsx</code> we are using <code>Microsoft.ACE.OLEDB.12.0</code>.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I tried editing the registry as well....but no relief.\nBut when I changed the value <code>IMEX = 0</code> or <code>IMEX = 1</code> it is working fine again. Can any one tell the exactly what is happening?</p>\n\n<p><strong>EDIT 2</strong>\nWhen I changed <code>HDR=Yes</code> still everything worked good. Any help please? I could not find enough help on internet.</p>\n"},{"tags":["c#",".net","nfc","mifare","windows-phone-8"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":162,"score":2,"question_id":13207401,"title":"Reading a Mifare tag using Windows Phone 8 NFC?","body":"\n\n<p>Does Windows Phone 8 NFC support Mifare Ultralight/Classic based tags?\nI use this code to access NFC device on Nokia Lumia 920 (code example was taken from <a href=\"https://projects.developer.nokia.com/nfctagreader\" rel=\"nofollow\">NDEF Tag Reader – NFC NDEF Tag Reader</a>)</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public partial class MainPage : PhoneApplicationPage\n{\n    public MainPage()\n    {\n        InitializeComponent();\n        ProximityDevice device = ProximityDevice.GetDefault();\n        device.DeviceArrived += DeviceArrived;\n        device.DeviceDeparted += DeviceDeparted;\n        device.SubscribeForMessage(\"NDEF\", MessageReceived);\n    }\n\n    private void DeviceArrived(ProximityDevice sender)\n    {\n        // this event occurs when I am tapping any of my tags (tried 5 different Mifare Ultralight/Classic)\n    }\n\n    private void DeviceDeparted(ProximityDevice sender)\n    {\n        // this event occurs when I am moving away any tag\n    }\n\n    private void MessageReceived(ProximityDevice sender, ProximityMessage message)\n    {\n        // this event is never fired!!! :(\n    }\n}\n</code></pre>\n\n<p>Is NFC on WP8 defective or is this code wrong?</p>\n\n<p><strong>Update:</strong>\nFrom this document <a href=\"http://www.nfc-forum.org/resources/white_papers/NXP_BV_Type_Tags_White_Paper-Apr_09.pdf\" rel=\"nofollow\">NFC Forum Type Tags</a> you can find that Mifare Ultralight is compatible with NDEF. Android devices can read tags of this type easily.</p>\n"},{"tags":["c#",".net","asp.net-mvc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":56,"score":-5,"question_id":13227988,"title":"Html.DisplayFor() result","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6365633/what-is-the-html-displayfor-syntax-for\">What is the @Html.DisplayFor syntax for?</a>  </p>\n</blockquote>\n\n\n\n<p>Is it possible to get the result of the function Html.DisplayFor() out of a view, for example in a View Model ?</p>\n\n<p>Thank you for your answers.</p>\n"},{"tags":["c#",".net","winforms"],"answer_count":6,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13158226,"title":"Allow only numbers and negative values","body":"<p>I have a <code>textbox</code> which needs only accept numbers (can be decimal values) and negative values.</p>\n\n<p>Currently I have something like this in <code>KeyPress</code> event</p>\n\n<pre><code>   if (!char.IsControl(e.KeyChar) &amp;&amp; !char.IsDigit(e.KeyChar) &amp;&amp; e.KeyChar != '.')\n    {\n        e.Handled = true;                \n    }\n</code></pre>\n\n<p>What else I should do in order to allow negative values?</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","windows-8","winrt-xaml","windows-store-apps"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13168460,"title":"Issues changing itemTemplateSelector for Listbox when snapped","body":"<p>I'm using the default Windows Store templates with an application I am writing.</p>\n\n<p>I want the first item in a listview highlighted; I have achieved this using a custom itemtemplateSelector.</p>\n\n<p>The problem that I have is that I need to modify the style when the page is snapped.</p>\n\n<p>The 'default' templates don't use a template selector so simply change the itemTemplate in the visualstate storyboard. </p>\n\n<p>If I amend this code to change itemTemlateSelector (storyboard.TargetProperty=\"itemTemplateSelector\") I get a runtime error. </p>\n\n<p>I then tried amending my DatatemplateSelector class to take account of ApplicationViewState: This works if the page loads into the snapped / full screen state but does not change the templates used when the application view state changes.</p>\n\n<p>Is there a way of 'refreshing' the Listview so that it re-applies the templates?</p>\n\n<p>Is there an alternative way of doing this?</p>\n\n<p>Thanks for any help/advice.</p>\n"},{"tags":[".net","visual-c++","windows-phone-8"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13227836,"title":"Unable to add reference to Native Dll in Windows Phone","body":"<p>I tried to compile a C++ code in Windows Phone 8 as \"Windows Runtime Component\". But when i tried to add the output dll into my main windows phone 8 project, i get an error message box as \"A reference to higher version or incompatible library cannot be added to the project\". When i see the properties of dll in Windows Explorer, i See its version as 255.255.255.255, which i also the same as in my dll project and i cannot change it.</p>\n\n<p>Can somebody tell how do i use this dll in my WinPhone8 project?</p>\n\n<p>Thanx\nUday Gupta</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13227600,"title":"(type)(object)Variable the only way to use an overload inside a generic class?","body":"<p>Wondering if using \"dynamic\" is the only way to use an overload from within a generic type.  The (int)(object) prefix is a little cumbersome.</p>\n\n<pre><code>public class TOfTestCase&lt;T&gt; {\n    public void otherMethod(int arg1) {\n\n    }\n\n    public void method(T arg1) {\n        if (typeof(T) == typeof(int)) {\n            otherMethod((int)(object)arg1);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","string","date","type-conversion"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1013,"score":0,"question_id":3407676,"title":"Convert string to Date format","body":"<p>my string is as follows:</p>\n\n<pre><code>string s =\"20000101\";\n</code></pre>\n\n<p>I would like to convert it to Date format. How can I do it?</p>\n"},{"tags":["c#",".net","task-parallel-library","async-await","c#-4.5"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13214373,"title":"Await not freeing up the calling thread in async method","body":"<p>I'm printing out the Messages property string list in AsyncDemoViewModel.</p>\n\n<p>If i use Thread.Sleep(1000) in GetVideosSlowlyAsync() the output is</p>\n\n<pre><code>Time spent: 4001 milliseconds \n\n - Started on thread 18, finished on thread 18  \n - Started on thread 18, finished on thread 18  \n - Started on thread 18, finished on thread 18 \n - Started on thread 18, finished on thread 18\n</code></pre>\n\n<p>If i use await Task.Delay(1000) in GetVideosSlowlyAsync() the output is</p>\n\n<pre><code>Time spent: 4053 milliseconds \n\n\n - Started on thread 12, finished on thread 19 \n - Started on thread 19, finished on thread 16 \n - Started on thread 16, finished on thread 19 \n - Started on thread 19, finished on thread 9\n</code></pre>\n\n<p><strong>Why is the await call not freeing up the calling thread ?</strong> I was expecting the await version to be about 4x faster in completion time.</p>\n\n<p>Controller code:</p>\n\n<pre><code>public class AsyncDemoController : Controller\n{\n    private DepartmentDb _db;\n\n    public AsyncDemoController(DepartmentDb db)\n    {\n        _db = db; \n    }\n\n    public async Task&lt;ActionResult&gt; Index()\n    {\n\n        var sw = Stopwatch.StartNew();\n        var v1 = await GetVideosSlowlyAsync();\n        var v2 = await GetVideosSlowlyAsync();\n        var v3 = await GetVideosSlowlyAsync();\n        var v4 = await GetVideosSlowlyAsync();\n\n        var vm = new AsyncDemoViewModel() {Videos = v1.Item2, Messages = new List&lt;string&gt;()};\n        sw.Stop();\n        vm.Messages.Add(string.Format(\"Time spent: {0} milliseconds\", sw.ElapsedMilliseconds));\n        vm.Messages.Add(v1.Item1);\n        vm.Messages.Add(v2.Item1);\n        vm.Messages.Add(v3.Item1);\n        vm.Messages.Add(v4.Item1);\n\n        return View(vm);\n    }\n\n    private async Task&lt;Tuple&lt;string, IEnumerable&lt;Video&gt;&gt;&gt; GetVideosSlowlyAsync()\n    {\n        var t1 = Thread.CurrentThread.ManagedThreadId;\n        await Task.Delay(1000); // Thread.Sleep(1000);\n        var t2 = Thread.CurrentThread.ManagedThreadId;\n        return Tuple.Create(string.Format(\"Started on thread {0}, finished on thread {1}\", t1, t2), _db.Videos.AsEnumerable());\n    }\n\n}\n</code></pre>\n"},{"tags":["c#",".net","log4net","string-formatting"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13227249,"title":"Why \\n does not work in Log.Info method?","body":"<p>The \\n in the String.Format method below within the Log.Info prints \"\\n\" as a text instead of starting a new line; why it does not work? Any idea? How can I make it work?</p>\n\n<pre><code>Log.Info(String.Format(\"Some arguments : \\n Since : {0}\\nBefore: {1}\\nLog file name : {2}\", since, before,logFileName));\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["c#","c++",".net","database","odbc"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13226920,"title":"generic odbc class support for all database","body":"<p>For the past few days i was working with various database with odbc connector based on my previous question on...</p>\n\n<p><a href=\"http://stackoverflow.com/questions/13133804/writing-driver-class-generic-for-any-database-support\">writing driver class generic for any database support</a> </p>\n\n<p>i have found that all the driver class has implemented the <strong>IDBDriver.cpp</strong> and wrote their own connection class to support through odbc</p>\n\n<p>my question is ...</p>\n\n<p>1) Is it possible for me to write my own class;\n2) If it succeed den just by changing the name in web.config file and placing the dll to that project can i able to handle the various connections.\n3) Is there any other way...?\n4) Am i proceeding in right way? </p>\n\n<p>Waiting for your valuable responses </p>\n"},{"tags":["c#",".net","wpf","xaml","mvvm"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":13139615,"title":"DataGrid column headers not aligned with data","body":"<p>I've got a DataGrid, which is quite simple as far as DataGrids go.  For some reason or other, the headers are not aligned with the rest of the data, as shown in the screenshot below:</p>\n\n<p><img src=\"http://i.stack.imgur.com/0Neao.png\" alt=\"enter image description here\"></p>\n\n<p>I've searched the internet but cannot seem to find a solution for it.  Here is my DataGrid code:</p>\n\n<pre><code>Grid&gt;\n        &lt;DataGrid Name=\"dgAttributes\" \n                  ItemsSource=\"{Binding itemsSource}\" \n                  AutoGenerateColumns=\"False\" \n                  CanUserAddRows=\"False\" \n                  CanUserDeleteRows=\"False\" \n                  CanUserReorderColumns=\"False\" \n                  CanUserResizeColumns=\"False\" \n                  CanUserResizeRows=\"False\"\n                  CanUserSortColumns=\"False\"\n                  &gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"True\" Binding=\"{Binding Field}\" Header=\"Fields\"/&gt;\n                &lt;DataGridComboBoxColumn  Width=\"95\" IsReadOnly=\"False\" Header=\"Order\" ItemsSource=\"{Binding Source={StaticResource SortOrderProvider}}\" SelectedItemBinding=\"{Binding SortBy, Mode=TwoWay}\"/&gt;\n                &lt;DataGridCheckBoxColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding GroupBy}\" Header=\"Group By\"/&gt;\n                &lt;DataGridComboBoxColumn Width=\"85\" IsReadOnly=\"False\" Header=\"Aggregate\" ItemsSource=\"{Binding Source={StaticResource AggregateProvider}}\" SelectedItemBinding=\"{Binding AggregateBy, Mode=TwoWay}\"/&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding Having}\" Header=\"Having\"/&gt;\n                &lt;DataGridTextColumn Width=\"Auto\" IsReadOnly=\"False\" Binding=\"{Binding DisplayOrder}\" Header=\"Display Order\"/&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>It may also be worth mentioning that when I click on one of the Combobox cells, the headers align themselves properly.</p>\n"},{"tags":["c#",".net","asp.net-mvc-4","asp.net-mvc-routing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13225786,"title":"Passing multiple parameters from url to html.actionlink","body":"<p>I'm fairly new to MVC and am struggling with routing when I try to pass multiple parameters via the URL.</p>\n\n<p>From a page with the URL: <code>/PersonCAFDetail/Index/3?memberid=4</code></p>\n\n<p>...I'm trying to get an Html.ActionLink set to point to the Create action such that the id=3 and the memberid=4.</p>\n\n<p>Having read a number of similar posts it seems that the following should work:</p>\n\n<pre><code>@Html.ActionLink(\"Create New\", \"Create\", null, new { memberid = \"memberid\" })\n</code></pre>\n\n<p>However, this results in a URL being created as follows:</p>\n\n<pre><code>&lt;a href=\"/PersonCAFDetail/Create/3\" memberid=\"memberid\"&gt;Create New&lt;/a&gt;\n</code></pre>\n\n<p>I have a route set up as:</p>\n\n<pre><code>    routes.MapRoute(\n        name: \"PersonCAFDetail\",\n        url: \"PersonCAFDetail/Create/{id}/{memberid}\",\n        defaults: new { controller = \"PersonCAFDetail\", action = \"Create\", id = \"@\\d+\", memberid = @\"\\d+\" }                        \n        );\n</code></pre>\n\n<p>The controller accepts two parameters as follows:</p>\n\n<pre><code> public ActionResult Create(int id, int memberid)\n        {\n            int cafID = id;\n            int personID = memberid;\n            ViewBag.detailTypeID = new SelectList(db.tCAFDetailTypes, \"detailTypeID\", \"detailType\");\n            ViewBag.cafID = new SelectList(db.tFamilyCAFs, \"cafID\", \"issues\");\n            ViewBag.personID = new SelectList(db.tPersons, \"personID\", \"forename\");\n            return View();\n        }\n</code></pre>\n\n<p>Any help appreciated.</p>\n\n<p>-------edit for model----------</p>\n\n<pre><code>namespace WhatWorks.Models\n{\n    using System;\n    using System.Collections.Generic;\n    using System.Linq;\n    using System.Web;\n    using System.Web.Mvc;\n    using System.ComponentModel.DataAnnotations;\n\n    public partial class tPersonCAFDetail\n    {\n        [Key, HiddenInput(DisplayValue=false)]\n        public int cafID { get; set; }\n\n        [Key, HiddenInput(DisplayValue = false)]\n        public int personID { get; set; }\n\n        [Key, HiddenInput(DisplayValue = false)]\n        public int detailTypeID { get; set; }\n\n        [Required, DataType(DataType.MultilineText)]\n        public string notes { get; set; }\n\n\n        public string FullName\n        {\n            get\n            {\n                return tPerson.forename + \" \" + tPerson.surname;\n            }\n        }\n\n        public virtual tCAFDetailType tCAFDetailType { get; set; }\n        public virtual tFamilyCAF tFamilyCAF { get; set; }\n        public virtual tPerson tPerson { get; set; }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","azure","azure-web-sites"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":531,"score":1,"question_id":11909120,"title":"Missing Microsoft.WindowsAzure.Diagnostics during Web Role deployment","body":"<p>Using Visual Studio 2012 RC, from the page, I started an Azure Cloud Service. I selected MVC 4, included a test project, and enabled NuGet package restores on build.</p>\n\n<p>When I deployed this to an Azure Web Site, using git, it seems that the target box does not include either the <code>WindowsAzure.Diagnostics</code> <em>or</em> the <code>WindowsAzure.ServiceRuntime</code> libraries. I'm new to .NET in general, but I can't imagine what I'm missing here. Furthermore, while I can trivially remove Diagnostics from the references (no diagnostics, no problem), it doesn't seem that I can do the same with ServiceRuntime.</p>\n\n<p><strong>Am I doing something wrong, or is this a bug in Azure Web Sites? Is it fixable?</strong></p>\n\n<pre><code>C:\\... [master]&gt; git push azure master\nCounting objects: 17, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (11/11), done.\nWriting objects: 100% (12/12), 216.47 KiB, done.\nTotal 12 (delta 5), reused 0 (delta 0)\nremote: New deployment received.\nremote: Updating branch 'master'.\nremote: Preparing deployment for commit id '2cb9c59bd0'.\nremote: Building web project 'MvcWebRole1.csproj'.\nremote: ..\nremote:   Successfully installed 'Microsoft.AspNet.WebApi 4.0.20505.0'.\nremote:   Successfully installed 'Microsoft.AspNet.Web.Optimization 1.0.0-beta2'.\nremote:   Successfully installed 'jQuery.Validation 1.8.1'.\nremote:   Successfully installed 'Microsoft.AspNet.Razor 2.0.20505.0'.\nremote:   Successfully installed 'Microsoft.AspNet.Providers.Core 1.0'.\nremote:   Successfully installed 'Microsoft.AspNet.Providers.LocalDb 1.0'.\nremote:   Successfully installed 'jQuery.UI.Combined 1.8.11'.\nremote:   Successfully installed 'jQuery 1.6.2'.\nremote:   Successfully installed 'Microsoft.AspNet.WebApi.Client 4.0.20505.0'.\nremote:   Successfully installed 'Microsoft.AspNet.Mvc 4.0.20505.0'.\nremote:   Successfully installed 'Microsoft.AspNet.WebApi.Core 4.0.20505.0'.\nremote:   Successfully installed 'Microsoft.AspNet.WebApi.WebHost 4.0.20505.0'.\nremote:   Successfully installed 'Microsoft.jQuery.Unobtrusive.Ajax 2.0.20505.0'.\nremote:   Successfully installed 'Microsoft.jQuery.Unobtrusive.Validation 2.0.20505.0'.\nremote:   Successfully installed 'Microsoft.Web.Infrastructure 1.0.0.0'.\nremote:   Successfully installed 'Microsoft.AspNet.WebPages 2.0.20505.0'.\nremote:   Successfully installed 'Modernizr 2.0.6'.\nremote:   Successfully installed 'Microsoft.WindowsAzure.ConfigurationManager 1.7.0.0'.\nremote:   Successfully installed 'Microsoft.Net.Http 2.0.20505.0'.\nremote:   Successfully installed 'WebGrease 1.0.0'.\nremote:   Successfully installed 'EntityFramework 5.0.0-rc'.\nremote:   Successfully installed 'WindowsAzure.Storage 1.7.0.0'.\nremote:   Successfully installed 'knockoutjs 2.0.0'.\nremote:   Successfully installed 'Newtonsoft.Json 4.5.1'.\nremote: D:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Common.targets(1360,9): warning MSB3245: Could not resol\nve this reference. Could not locate the assembly \"Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral,\nPublicKeyToken=31bf3856ad364e35\". Check to make sure the assembly exists on disk. If this reference is required by your\ncode, you may get compilation errors. [C:\\DWASFiles\\Sites\\barf\\VirtualDirectory0\\site\\repository\\MvcWebRole1\\MvcWebRole1\n.csproj]\nremote: D:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.Common.targets(1360,9): warning MSB3245: Could not resol\nve this reference. Could not locate the assembly \"Microsoft.WindowsAzure.ServiceRuntime, Version=1.7.0.0, Culture=neutra\nl, PublicKeyToken=31bf3856ad364e35\". Check to make sure the assembly exists on disk. If this reference is required by yo\nur code, you may get compilation errors. [C:\\DWASFiles\\Sites\\barf\\VirtualDirectory0\\site\\repository\\MvcWebRole1\\MvcWebRo\nle1.csproj]\nremote: WebRole.cs(5,30): error CS0234: The type or namespace name 'Diagnostics' does not exist in the namespace 'Microsoft.WindowsAzure' (are you missing an assembly reference?) [C:\\DWASFiles\\Sites\\barf\\VirtualDirectory0\\site\\repository\\Mv\ncWebRole1\\MvcWebRole1.csproj]\nremote: WebRole.cs(6,30): error CS0234: The type or namespace name 'ServiceRuntime' does not exist in the namespace 'Microsoft.WindowsAzure' (are you missing an assembly reference?) [C:\\DWASFiles\\Sites\\barf\\VirtualDirectory0\\site\\repository\\MvcWebRole1\\MvcWebRole1.csproj]\nremote: WebRole.cs(10,28): error CS0246: The type or namespace name 'RoleEntryPoint' could not be found (are you missing a using directive or an assembly reference?) [C:\\DWASFiles\\Sites\\barf\\VirtualDirectory0\\site\\repository\\MvcWebRole1\\Mvc\nWebRole1.csproj]\nremote:\nremote: Error - Changes committed to remote repository but your website not updated.\n</code></pre>\n"},{"tags":["c#",".net","c#-4.0","datagridview","datatable"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13222141,"title":"How to update Database Table when multiple rows are edited in Gridview","body":"<p>I have inserted the screenshot of my Windows Form which pulls up information from a Product Table:</p>\n\n<p><img src=\"http://i.stack.imgur.com/e0ezN.jpg\" alt=\"Windows Form\"></p>\n\n<p>Now as you can see i have allowed the option to <code>Modify</code> and then <code>Save</code> the modifications in the Database Table. So the issue i am facing is in updating the data in the Database Table. Since the user can update more than 1 row at a time in the <code>GridView</code>, how do i update the Database table?</p>\n\n<p>I can either do a row-wise update, or i can loop through the <code>GridView</code> and update my table and then use a Command Builder.</p>\n\n<p>I want know how do i achieve the solution in both scenarios.</p>\n"},{"tags":[".net","wcf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13195092,"title":"WCF unable to handle custom thrown exception","body":"<p>I have created a WCF service and deployed it on the server. It works fine until I throw a custom exception (when data returned from the database is invalid). </p>\n\n<p>I need to catch the exception, and want to capture the message in the exception on the client end and show it to him. However, it shows the exception as:</p>\n\n<blockquote>\n  <p>service endpoint binding not using the HTTP protocol</p>\n</blockquote>\n\n<p>This is the code I'm currently using.</p>\n\n<p><strong>Contract:</strong></p>\n\n<pre><code>[FaultContract(typeof(DefinedException))]\n[OperationContract]\nMyData GetData(TestValues values);\n</code></pre>\n\n<p><strong>Business Layer:</strong></p>\n\n<pre><code>public MyData GetData (TestValues values)\n{\n    try\n    {\n        data = db.GetData (values);\n\n        if (data == null)\n        {\n            throw new DefinedException();\n        }               \n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n    return data;\n}\n</code></pre>\n\n<p><strong>SVC File:</strong></p>\n\n<pre><code>public MyData GetData (TestValues values)\n{\n    try\n    {\n        Bo.GetData(values);\n    }\n    catch (DefinedException exp)\n    {\n        throw new FaultException&lt; DefinedException &gt;( exp);\n    }\n    catch (Exception ex)\n    {\n        throw new FaultException(ex.Message.ToString());\n    }\n    return data;\n}\n</code></pre>\n\n<p><strong>Defined Exception:</strong></p>\n\n<pre><code>public class DefinedException: System.ApplicationException\n{ }\n</code></pre>\n\n<p><strong>Config:</strong></p>\n\n<pre><code>&lt;system.serviceModel&gt;   \n    &lt;diagnostics wmiProviderEnabled=\"false\" performanceCounters=\"Off\"&gt;\n      &lt;messageLogging logEntireMessage=\"true\"\n        logMalformedMessages=\"true\" logMessagesAtServiceLevel=\"true\"\n        logMessagesAtTransportLevel=\"true\" maxMessagesToLog=\"100\" /&gt;\n      &lt;endToEndTracing propagateActivity=\"true\" activityTracing=\"true\" messageFlowTracing=\"true\" /&gt;\n    &lt;/diagnostics&gt;\n    &lt;bindings&gt;\n      &lt;wsHttpBinding&gt;\n        &lt;binding name=\"wsHttpBinding\" openTimeout=\"00:01:00\" receiveTimeout=\"00:10:00\" sendTimeout=\"00:01:00\"\n          transactionFlow=\"false\"  hostNameComparisonMode=\"StrongWildcard\"  maxBufferPoolSize=\"2147483647\"\n           maxReceivedMessageSize=\"2147483647\"&gt;\n          &lt;readerQuotas maxDepth=\"128\" maxStringContentLength=\"2147483647\"\n            maxArrayLength=\"16384\" maxBytesPerRead=\"16384\" maxNameTableCharCount=\"2147483647\" /&gt;\n          &lt;reliableSession ordered=\"true\" inactivityTimeout=\"00:10:00\"\n            enabled=\"false\" /&gt; \n        &lt;/binding&gt;\n      &lt;/wsHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;services&gt;\n      &lt;service behaviorConfiguration=\"sb \" name=\"DataService \"&gt;\n        &lt;endpoint address=\"wsHttpBinding\"\n          binding=\"wsHttpBinding\" bindingConfiguration=\"wsHttpBinding\" name=\" wsHttpBinding\" contract=\"IData\" &gt;\n        &lt;/endpoint&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;endpointBehaviors&gt;\n        &lt;behavior name=\"NewBehavior\"&gt;\n          &lt;dataContractSerializer maxItemsInObjectGraph=\"2147483647\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/endpointBehaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\" sb \"&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n          &lt;dataContractSerializer maxItemsInObjectGraph=\"2147483647\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Please advise me what I need to change to fix this.</p>\n"},{"tags":[".net","httpwebrequest","client-side","confirmation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13226309,"title":"Get client confirmation during loop","body":"<p>I am developing an application for my client which will place orders on the web automatically using server side HttpWebRequest/Response. The client wants to review the final step (checkout) of each order in the queue  so that he can decide whether or not the order be placed. </p>\n\n<p>Note: Some one might think</p>\n\n<blockquote>\n  <p>why not the client decide which order be processed\n       before putting in the queue?</p>\n</blockquote>\n\n<p>But there are many operations associated with\n     the order during placement, so the client left with the only choice in the\n     final step.</p>\n\n<p>The flow of operation is as under:</p>\n\n<p>The client selects orders from gridview and press purchase button this call a function which place orders automatically.</p>\n\n<p>Steps:</p>\n\n<ol>\n<li>The application gets authenticated to the website where the client wants the order be placed.</li>\n<li>Finding the item and filling the delivery Form.</li>\n<li>Proceeding with billing information and finalizing the order.</li>\n</ol>\n\n<p>All the above is going automatically through HttpWebRequest/Response so client doesn't have any control over the order process to stop if there is any problem during operation. For this purpose, the client wants to have a confirmation at Step 3 so that he can choose whether or not this particular order be processed?</p>\n\n<p><strong>The rest of the things done. My problem is how to show confirmation\n    box and if the client click yes/no how to proceed next.</strong></p>\n\n<p>Pseudo code may as under:</p>\n\n<pre><code>Dim orderArray(5) as string \n\norderArray(0) = \"Order 1\" \norderArray(1) = \"Order 2\" \norderArray(2) = \"Order 3\" \norderArray(3) = \"Order 4\" \norderArray(4) = \"Order 5\" \n\n\n    Step 1: Get Authenticated.\n\n    For i=0 to orderArray.Length -1 \n\n       'Step 2: Item Found for orderArray(i) and form filled\n\n       Get confirmation from client ( a client side msg box etc)\n\n       if client-confirmed then \n\n         'Step 3: Billing Info and place Order\n\n       else\n\n           'Cancel this order and proceed for next order \n        end if \n\n   Next\n</code></pre>\n\n<p><strong>I am tired of googling for my problem but I left with the only hope to post here.</strong></p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","task-parallel-library"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":136,"score":5,"question_id":13211334,"title":"How do I wait until Task is finished in C#?","body":"<p>I want to send a request to a server and process the returned value:</p>\n\n<pre><code>private static string Send(int id)\n    {\n        Task&lt;HttpResponseMessage&gt; responseTask = client.GetAsync(\"aaaaa\");\n        string result = string.Empty;\n        responseTask.ContinueWith(x =&gt; result = Print(x));\n        responseTask.Wait(); // it doesn't wait for the completion of the response task\n        return result;\n    }\n\n    private static string Print(Task&lt;HttpResponseMessage&gt; httpTask)\n    {\n        Task&lt;string&gt; task = httpTask.Result.Content.ReadAsStringAsync();\n        string result = string.Empty;\n        task.ContinueWith(t =&gt;\n        {\n            Console.WriteLine(\"Result: \" + t.Result);\n            result = t.Result;\n        });\n        task.Wait();  // it does wait\n        return result;\n    }\n</code></pre>\n\n<p>Am I using <code>Task</code> correctly? I don't think so because the <code>Send()</code> method returns <code>string.Empty</code> every time, while <code>Print</code> returns the correct value.</p>\n\n<p>What am I doing wrong? How do I get the correct result from a server?</p>\n"},{"tags":[".net","sql","sql-server","sql-server-2005"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":3450,"score":0,"question_id":4941489,"title":"Query vs Stored procedure; difference between two approaches","body":"<p>I am developing a web page for search. I have two options to build this page</p>\n\n<ol>\n<li><p>To build the query on page according to parameter enter by the user and send it to server.</p></li>\n<li><p>To send parameters to stored procedure and build query there and get it executed.</p></li>\n</ol>\n\n<p>I want to know that which approach I should adopt and why. </p>\n\n<p>I want to know the advantages or disadvantages of both approaches. </p>\n"},{"tags":["c#",".net","algorithm","notepad++","string-comparison"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":13226002,"title":"Notepad++'s Compare plugin algorithm","body":"<p>I need to create a tool in C#.Net that have the exactly same functions like Notepad++ Compare plugin, do you have any idea how can I do this? </p>\n\n<p>Right now I am using this algo:\n<a href=\"http://www.codeproject.com/Articles/6943/A-Generic-Reusable-Diff-Algorithm-in-C-II\" rel=\"nofollow\">http://www.codeproject.com/Articles/6943/A-Generic-Reusable-Diff-Algorithm-in-C-II</a></p>\n\n<p>But my client wants to highlight the difference like in the Notepad++ Compare plugin. </p>\n\n<p>Thanks for any idea! </p>\n\n<p>-JRC</p>\n"},{"tags":["c#","asp.net",".net","getter-setter"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13223053,"title":"ASP.NET C# Application Object Getters and Setters","body":"<p>I have had a hard time finiding a newbie friendly example of accessing Application Object. I have few things ( arrays ) i would like to store in Application Object to keep as persistant data for about 2h till AppRecycle</p>\n\n<p>Anyhow i know how to set an Application Object variable this way:</p>\n\n<pre><code>// One way\nString[] users = new String[1000];\nApplication[\"users\"] = users;\n\n// Another way\nApplication.Add(\"users\", users);\n</code></pre>\n\n<p>However i do not know how to access these variables once in Application Object there is a Getter method <code>Get</code> however it requires <code>int index</code> and other one <code>Contents</code> which get's everything.</p>\n\n<p>Here i try to retrive my String[] array but gives me a error that i am trying to convert Object to String.</p>\n\n<pre><code>String[] usersTable = Application[\"users\"];\n// Since this is an object i also tried Application.users but gives error\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13225594,"title":"Copying directories to JDrive / USB","body":"<p>I can do this so simply with files, like so: </p>\n\n<pre><code>public static void MoveAllFilesFromDesktopToJDrive()\n        {\n            DirectoryInfo di = new DirectoryInfo(@\"C:\\Users\\Tafe\\Desktop\\\");\n            DirectoryInfo Jdrive = new DirectoryInfo(@\"J:\\\");\n\n            foreach (FileInfo fi in di.GetFiles())\n            {\n                if (Path.GetFileName(fi.FullName) != \"desktop.ini\")\n                {                      \n                    fi.MoveTo(Jdrive.FullName + Path.GetFileName(fi.FullName));\n                }    \n            }\n        }\n</code></pre>\n\n<p>But trying the same operation on directories tells me I can't move directories accross volumes. OK then, so this is what I've tried: </p>\n\n<pre><code> public static void MoveAllDirsFromDeskTopToJDrive()\n        {\n            DirectoryInfo di = new DirectoryInfo(@\"C:\\Users\\Tafe\\Desktop\\\");\n            DirectoryInfo Jdrive = new DirectoryInfo(@\"J:\\\");\n\n            foreach (DirectoryInfo dirs in di.GetDirectories())\n            {\n               Directory.CreateDirectory(Jdrive + Path.GetFileName(dirs.FullName)); \n\n            }\n        }\n</code></pre>\n\n<p>This copies the names of the files, but not the contents, I would just move the contents like I did with my <code>MoveAllFilesFromDesktopToJDrive()</code> method, but the directories contain subdirectories and subdirectories and such, so I can't figure it out. I know a TINY bit about recursion, but not enough to even attempt this. Also, It can't be that hard can it? There has to be something better in the API to facilitate this? If not, any help to complete this method <code>MoveAllFilesFromDesktopToJDrive()</code> would be a lifesaver! </p>\n"},{"tags":["c#",".net","wcf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13222551,"title":"WCF DataSources folder","body":"<p>I have a solution with a WCF service, and a few projects with a reference to it.\nFor some reason, 1 of the projects has a DataSources folder within its Properties folder, in which all my entities are present under the form of files named MyNamespace.MyEntity.datasource.</p>\n\n<p>How come the other projects don't have that and still work fine?\nOr how come this one has it?\nIs there a specific condition that must be met for the folder and entities to be created?</p>\n"},{"tags":["c#",".net","linq","sorting","collections"],"answer_count":3,"favorite_count":1,"up_vote_count":13,"down_vote_count":0,"view_count":312,"score":13,"question_id":13181498,"title":"Why is OrderBy which returns IOrderedEnumerable<T> much faster than Sort?","body":"<p>This is a follow up of this excellent question <a href=\"http://stackoverflow.com/questions/1832684/c-sharp-sort-and-orderby-comparison\">C# Sort and OrderBy comparison</a>. I will use the same example: </p>\n\n<pre><code>List&lt;Person&gt; persons = new List&lt;Person&gt;();\npersons.Add(new Person(\"P005\", \"Janson\"));\npersons.Add(new Person(\"P002\", \"Aravind\"));\npersons.Add(new Person(\"P007\", \"Kazhal\"));\n</code></pre>\n\n<p>The methods in contention are:</p>\n\n<pre><code>persons.Sort((p1, p2) =&gt; string.Compare(p1.Name, p2.Name, true));\n//and\npersons.OrderBy(n =&gt; n.Name);\n</code></pre>\n\n<p>Let me start by saying that I understand there isn't any significant performance difference to worry about. But I would love to know why does <code>OrderBy</code> perform so much better than <code>Sort</code>. I'm using the answer posted by @phoog in the original question.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    IEnumerable&lt;Person&gt; people;\n\n    BenchMark(persons =&gt; persons.Sort((p1, p2) =&gt; string.Compare(p1.Name, p2.Name, true)));\n\n    BenchMark(persons =&gt; people = persons.OrderBy(n =&gt; n.Name));\n}\n\nprivate static Random randomSeed = new Random();\npublic static string RandomString(int size, bool lowerCase)\n{\n    var sb = new StringBuilder(size);\n    int start = (lowerCase) ? 97 : 65;\n    for (int i = 0; i &lt; size; i++)\n    {\n        sb.Append((char)(26 * randomSeed.NextDouble() + start));\n    }\n    return sb.ToString();\n}\n\nprivate static void BenchMark(Action&lt;List&lt;Person&gt;&gt; action)\n{\n    List&lt;Person&gt; persons = new List&lt;Person&gt;();\n    for (int i = 0; i &lt; 10000; i++)\n    {\n        persons.Add(new Person(\"P\" + i.ToString(), RandomString(5, true)));\n    }\n    List&lt;Person&gt; unsortedPersons = new List&lt;Person&gt;(persons);\n\n    Stopwatch watch = new Stopwatch();\n    for (int i = 0; i &lt; 100; i++)\n    {\n        watch.Start();\n\n        action(persons);\n\n        watch.Stop();\n        persons.Clear();\n        persons.AddRange(unsortedPersons);\n    }\n\n    MessageBox.Show(watch.Elapsed.TotalMilliseconds.ToString());\n}\n</code></pre>\n\n<p><strong>Result:</strong> </p>\n\n<pre><code>Sort() =&gt; 3500 ~ 5000 ms\nOrderBy() =&gt; 0.2 ~ 1.5 ms\n</code></pre>\n\n<p>Though differences were profound even with smaller lists I tested initially, it became more and more glaring once the size of the collection went up. May be I'm missing something key to understanding .NET collections, but my thinking is since <code>Sort</code> acts on an existing <code>List&lt;T&gt;</code>, it should have lesser overhead (if every any) in processing when compared to <code>OrderBy</code> which acts on the same <code>List&lt;T&gt;</code> (in our case <code>persons</code>) but have to return another collection <a href=\"http://msdn.microsoft.com/en-us/library/bb534852.aspx\" rel=\"nofollow\"><code>IOrderedEnumerable&lt;T&gt;</code></a>. But still <code>OrderBy</code> performs far far better. <code>List&lt;T&gt;</code> might have certain overhead compared to <code>IEnumerable&lt;T&gt;</code> type, but <code>Sort</code> anyway acts on the existing list! Furthermore, I'm little amused to see a <code>Linq</code> method working faster than existing .NET method. </p>\n\n<p>All the answers in the original question compare <code>Sort</code> against <code>OrderBy.ToList</code> which I believe will have some overhead and therefore performs more or less equally. </p>\n\n<p>What could be the implementation differences?</p>\n\n<hr>\n\n<p><strong>Edit:</strong> Ok I learned something new. Here is how I confirmed about deferred execution.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    BenchMark(persons =&gt;\n    {\n        persons.Sort((p1, p2) =&gt; string.Compare(p1.Name, p2.Name, true));\n        foreach (var item in persons)\n        {\n            break;\n        }\n    });\n\n    BenchMark(persons =&gt;\n    {\n        IEnumerable&lt;Person&gt; people = persons.OrderBy(n =&gt; n.Name);\n        foreach (var item in people)\n        {\n            break;\n        }\n    });\n}\n</code></pre>\n\n<p><code>Sort</code> ran in 4000 - 5000ms while <code>OrderBy</code> ran just above 5000ms. So indeed my conclusion was wrong. Both of them performed on equal terms once I started to enumerate the collections. I prefer the syntax of <code>OrderBy</code> anyday :)</p>\n\n<p><strong>Edit 2:</strong> I just found that this is exact duplicate of <a href=\"http://stackoverflow.com/questions/10299464/why-is-array-sort-so-slow-compared-to-linq?lq=1\">this one</a>. But here is a <a href=\"http://stackoverflow.com/questions/10110013/order-of-linq-extension-methods-does-not-affect-performance\">more interesting question about deferred execution in general</a> though not about ordering altogether. </p>\n"},{"tags":[".net","html","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":57,"score":1,"question_id":13225085,"title":"How can I render HTML file using VB.NET?","body":"<p>Is there a namespace to have an <code>HTML</code> file rendered?</p>\n\n<p>The intention is to have it rendered in a VBHTML file e.g.:</p>\n\n<p><code>@RenderPage(\"page-name.htm\")</code></p>\n\n<p>I am using:</p>\n\n<ul>\n<li>Visual Studio 2012</li>\n<li>ASP.NET MVC 4</li>\n<li>VB.NET</li>\n</ul>\n"},{"tags":[".net","windows-phone-7","webbrowser-control"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":12264221,"title":"Windows phone WebBrowser control embed fonts","body":"<p>It's pretty easy to embed font to windows phone application, but I cannot find way to use my fonts in WebBrowser control, that is showing static html file. Is there any way to do it? </p>\n\n<p>I'm using code below to show my html file: </p>\n\n<pre><code>        Uri uri = new Uri(AppResources.red_termsOfUse_URI, UriKind.Relative);\n        Stream stream = Application.GetResourceStream(uri).Stream;\n        using (StreamReader reader = new StreamReader(stream, new System.Text.UnicodeEncoding()))\n        {\n            string htmlDocument = reader.ReadToEnd();\n            this.webBrowser.NavigateToString(htmlDocument);\n        }\n</code></pre>\n"},{"tags":["c#",".net","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13225200,"title":"collision detection of controls and inner boundary of screen (view)","body":"<p>I am making a simple application for win 8, In which user can move controls (BUTTONS etc), How to detect when buttons collide each other and how to detect that button is colliding with inner boundary of screen?  Kindly Help me with this !</p>\n"},{"tags":[".net","language-agnostic","licensing","ribbon","fluent"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":29,"score":-1,"question_id":13218403,"title":"Using fluent ribbon in commercial applications","body":"<p>Has anybody used, or can we use the Fluent ribbon library in our commercial apps?</p>\n\n<p>I cannot find a straightforward answer to this question, and the one on the project's discussion page was, at the time of reading it, very vague.</p>\n\n<p>Also, I've read on some sites that you must obtain a license from Microsoft if you plan on charging for an app that uses the Microsoft Ribbon - if that's true, is it the case for libraries that wrap the ribbon, or do they mean specifially, the <em>Microsoft</em> ribbon?</p>\n"},{"tags":["c#",".net","async-ctp","async-await"],"answer_count":4,"favorite_count":1,"up_vote_count":11,"down_vote_count":0,"view_count":841,"score":11,"question_id":9846615,"title":"Async Task.WhenAll with timeout","body":"<p>Is there a way in the new async dotnet 4.5 library to set a timeout on the <code>Task.WhenAll</code> method. I want to fetch several sources and stop after say 5 seconds and skip the sources that weren't finished.</p>\n"},{"tags":["c#",".net"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":259,"score":0,"question_id":7522228,"title":"saving state between program restarts","body":"<p>How can I declare a variable which would save sting forever?</p>\n\n<p>I mean if the user closes and restarts the program, this string value is not lost.</p>\n\n<p>How can this be done?</p>\n"},{"tags":[".net","wpf","itemscontrol"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13224987,"title":"WPF ItemContainerGenerator One-to-Many Mapping","body":"<p>Is it possible to create an <a href=\"http://msdn.microsoft.com/en-us/library/ms611040.aspx\" rel=\"nofollow\">ItemContainerGenerator</a> that generates more than one visual item from each data item? I have a collection of custom objects that have two independent visuals that I would like to be added to the same ItemsControl. It is not desirable to display them as their original pairs so it will not be much use to create a template with a panel for each data item that contains the two visuals. However, the two visuals must remain linked to each other, as they respond to each other's events.</p>\n"},{"tags":[".net","wpf"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13214749,"title":"Entering date in d/mm format in TextBox","body":"<p>I've got a TextBox bound to a nullable DateTime property.</p>\n\n<p>I'm in Australia, so I want dates presented in the d/mm/yyyy format.</p>\n\n<p>On my Windows 7 box, I can enter the date in d/mm format, and it's converted correctly (eg. 1/11 converts to November 1st, 13/1 converts to January 13th etc.)</p>\n\n<p>On my Windows 8 box, the same input is interpreted as if it was in the US format, so 1/11 converts to January 11th, and 13/1 fails (since there is no 13th month). </p>\n\n<p>Both computers are set to use the Australian formats, and I have this code in the Application.StartUp event:</p>\n\n<pre><code>FrameworkElement.LanguageProperty.OverrideMetadata(GetType(FrameworkElement), New FrameworkPropertyMetadata(XmlLanguage.GetLanguage(CultureInfo.CurrentCulture.IetfLanguageTag)))\n</code></pre>\n\n<p>The Binding's StringFormat is set to d/MM/yyyy, and I've checked that this is correct by also binding a TextBlock to the same property that has its StringFormat set to D (the long date format, which gives values like 'Wednesday, 11 January, 2012').</p>\n\n<p>Does anyone have any ideas?</p>\n"},{"tags":["c#",".net","winforms","listview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":820,"score":0,"question_id":7620120,"title":"ListView subitems font not working","body":"<p>I have a listview in which I want to apply different font in different cells according to some condition. But I'm unable to do this. I tried these types of codes to add item.</p>\n\n<pre><code>ListViewItem entryListItem = listView_Standard.Items.Add(\"Items\");\n\n            // Set UseItemStyleForSubItems property to false to change \n            // look of subitems.\n            entryListItem.UseItemStyleForSubItems = false;\n\n            // Add the expense subitem.\n            ListViewItem.ListViewSubItem expenseItem =\n                entryListItem.SubItems.Add(\"Expense\");\n\n            // Change the expenseItem object's color and font.\n            expenseItem.ForeColor = System.Drawing.Color.Red;\n            expenseItem.Font = new System.Drawing.Font(\n                \"Arial\", 10, System.Drawing.FontStyle.Italic);\n\n            // Add a subitem called revenueItem \n            ListViewItem.ListViewSubItem revenueItem =\n                entryListItem.SubItems.Add(\"Revenue\");\n            revenueItem.BackColor = System.Drawing.Color.Red;\n\n            // Change the revenueItem object's color and font.\n            revenueItem.ForeColor = System.Drawing.Color.Blue;\n            revenueItem.Font = new System.Drawing.Font(\n                \"KF-Kiran\", 25, System.Drawing.FontStyle.Bold);\n</code></pre>\n\n<p>and </p>\n\n<pre><code>ListViewItem NewItem = new ListViewItem();\n             NewItem.UseItemStyleForSubItems = false;\n             NewItem.Text = \"foo\";\n             NewItem.SubItems.Add(\"bar\");\n             NewItem.SubItems.Add(\"1111111\");\n             NewItem.SubItems[1].Font = new Font(\"KF-Kiran\", 20);\nlistView_Standard.Items.Add(NewItem);\n</code></pre>\n\n<p>When I use 0th subitem to change font, new font is applied to whole row. But I want only particluarl cells to apply font.</p>\n"},{"tags":["c#",".net","winforms","gui","windows-7"],"answer_count":1,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":1825,"score":4,"question_id":8793445,"title":"Windows 7 style Dropshadow in borderless form","body":"<blockquote>\n  <p><em><strong>Short Version:</em></strong></p>\n</blockquote>\n\n<p><strong>Goal:</strong> A deep, dark, Windows 7 dropshadow in borderless WinForm in C#</p>\n\n<hr>\n\n<p><strong>Known existing solutions 1:</strong> Simple XP-style dropshadow using CreateParams.</p>\n\n<p><strong>Problem:</strong> To weak, to light, to ugly.</p>\n\n<hr>\n\n<p><strong>Known existing solutions 2:</strong> Replace GDI of form with bitmap.</p>\n\n<p><strong>Problem:</strong> Lose the ability to use controls, only functional as a splash screen.</p>\n\n<hr>\n\n<p><strong>Objective by this post:</strong> Find a median solution to this problem or an all together better one. </p>\n\n<p>.\n.\n.</p>\n\n<blockquote>\n  <p><em><strong>Long Version:</em></strong></p>\n</blockquote>\n\n<p>(Edit: I am referring to the drop-shadow going along the border of any windows form, if that wasn't clear.)\nI understand that there is a way to make XP style dropshadows in C# using: </p>\n\n<p><strong>C# Code 1 - Simple XP-style dropshadow (Problem: to light, to weak, to ugly)</strong></p>\n\n<pre><code>// Define the CS_DROPSHADOW constant\nprivate const int CS_DROPSHADOW = 0x00020000;\n\n// Override the CreateParams property\nprotected override CreateParams CreateParams\n{\n    get\n    {\n        CreateParams cp = base.CreateParams;\n        cp.ClassStyle |= CS_DROPSHADOW;\n        return cp;\n    }\n}\n</code></pre>\n\n<p>However, I am trying to figure out how to make them appear like the do in Windows 7 (deeper and larger shadows) and can't figure out the best way of doing this. </p>\n\n<p>I have a method now created that will let me override the entire form GDI and appear like a splash screen would (credit not mine):</p>\n\n<p><strong>C# Code 2: Replace form GDI with Bitmap (Problem: can't use form controls, hard to maintain GUI)</strong> </p>\n\n<pre><code>    public void SetBitmap(Bitmap bitmap, byte opacity)\n    {\n        if (bitmap.PixelFormat != PixelFormat.Format32bppArgb)\n            throw new ApplicationException(\"The bitmap must be 32ppp with alpha-channel.\");\n\n        // 1. Create a compatible DC with screen;\n        // 2. Select the bitmap with 32bpp with alpha-channel in the compatible DC;\n        // 3. Call the UpdateLayeredWindow.\n\n        IntPtr screenDc = Win32.GetDC(IntPtr.Zero);\n        IntPtr memDc = Win32.CreateCompatibleDC(screenDc);\n        IntPtr hBitmap = IntPtr.Zero;\n        IntPtr oldBitmap = IntPtr.Zero;\n\n        try\n        {\n            hBitmap = bitmap.GetHbitmap(Color.FromArgb(0));  // grab a GDI handle from this GDI+ bitmap\n            oldBitmap = Win32.SelectObject(memDc, hBitmap);\n\n            Win32.Size size = new Win32.Size(bitmap.Width, bitmap.Height);\n            Win32.Point pointSource = new Win32.Point(0, 0);\n            Win32.Point topPos = new Win32.Point(Left, Top);\n            Win32.BLENDFUNCTION blend = new Win32.BLENDFUNCTION();\n            blend.BlendOp = Win32.AC_SRC_OVER;\n            blend.BlendFlags = 0;\n            blend.SourceConstantAlpha = opacity;\n            blend.AlphaFormat = Win32.AC_SRC_ALPHA;\n\n            Win32.UpdateLayeredWindow(this.Handle, screenDc, ref topPos, ref size, memDc, ref pointSource, 0, ref blend, Win32.ULW_ALPHA);\n        }\n        finally\n        {\n            Win32.ReleaseDC(IntPtr.Zero, screenDc);\n            if (hBitmap != IntPtr.Zero)\n            {\n                Win32.SelectObject(memDc, oldBitmap);\n                Win32.DeleteObject(hBitmap);\n            }\n            Win32.DeleteDC(memDc);\n        }\n    }\n\n\n    protected override CreateParams CreateParams\n    {\n        get\n        {\n            CreateParams cp = base.CreateParams;\n            cp.ExStyle |= 0x00080000; // This form has to have the WS_EX_LAYERED extended style\n            return cp;\n        }\n    }\n</code></pre>\n\n<p>However, this does give me a full 32-bit background (as I require to add the dropshadow manually), but I lose the ability to create form elements that are visible. </p>\n\n<p>So basically, I am trying to figure out a median between these two methods. Something that will give me deep and dark drop shadows without losing other functionality / causing excessive repainting requirements. </p>\n"},{"tags":[".net","gmail"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":4421048,"title":"Forward mails to mobile as an SMS","body":"<p>I am trying to create an application, which send out an SMS as soon as you receive a mail in your email account. I have an SMS API, which will take care of sending the SMS to a particular mobile number. What I am now concerned is, how do I let my application know that a mail has been received. For simplicity sake I will be using the Gmail account. So as soon as I receive a mail on my Gmail id I want a sms to be sent to my mobile, which has the senders address as well as the subject.</p>\n\n<p>Any suggestions as to how can i let my application know about it? </p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":434,"score":1,"question_id":6764206,"title":"How to set custom text when copying BlockUIContainer from FlowDocument to clipboard?","body":"<p>I have flow document with embedded BlockUIContainers. I want to replace them with appropriate text when users copies text containing them to clipboard.</p>\n\n<p><strong>Upadate:</strong>\nI have following chat interface:\n<img src=\"http://i.stack.imgur.com/6WdNI.png\" alt=\"Chat\"></p>\n\n<p>Captions with time and username are done with <code>BlockUIContainer</code>s (I don't know how to do it using FlowDocument elements). When users selects some messages and copies them to clipboard, username and time are not copiet because they are TextBlocks. I want to intercept copy command and format chat text appropriately.</p>\n"},{"tags":["c#",".net","triangulation","delaunay"],"answer_count":5,"favorite_count":3,"up_vote_count":15,"down_vote_count":0,"view_count":2091,"score":15,"question_id":7309538,"title":"Efficient Delaunay triangulation","body":"<p>I'm looking for a .NET implementation which builds Delaunay triangulation from set of points.</p>\n\n<p>I have already tested couple of implementations but they all worked only for small amount of points (up to 20,000).</p>\n\n<p>I need something that can handle 500,000 points in reasonable time.</p>\n"},{"tags":["c#",".net"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":578,"score":2,"question_id":34809,"title":"What is the best way to tell if an object is modified?","body":"<p>I have an object that is mapped to a cookie as a serialized base-64 string. I only want to write out a new cookie if there are changes made to the object stored in the cookie on server-side.</p>\n\n<p>What I want to do is get a hash code when the object is pulled from the cookie/initialized and compare the original hash code to the hash code that exists just before I send the cookie header off to the client to ensure I don't have to re-serialize/send the cookie unless changes were made.</p>\n\n<p>I was going to override the .NET's <code>Object.GetHashCode()</code> method, but I wasn't sure that this is the best way to go about checking if an object is modified.</p>\n\n<p>Are there any other ways I can check if an object is modified, or should I override the <code>GetHashCode()</code> method.</p>\n\n<p><strong>Update</strong> I decided to accept @<a href=\"#34882\" rel=\"nofollow\">rmbarnes</a>'s answer as it had an interesting solution to the problem, and because I decided to use his advice at the end of his post and not check for modification. I'd still be interested to hear any other solutions anyone may have to my scenario however.</p>\n"},{"tags":["c#",".net"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":207,"score":1,"question_id":10454519,"title":"Best way to compare two complex object","body":"<p>I have two complex objects like <strong>Object1</strong> and <strong>Object2</strong>. <strong><em>They have around 5 levels of child's others objects.</em></strong></p>\n\n<p>I need the fastest method to say if are the same or not.</p>\n\n<p>How it could be done in C# 4.0?</p>\n\n<p>Thank you!</p>\n"},{"tags":[".net","oracle","ldap","oid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13223881,"title":".net integration with OVD\\OID","body":"<p>I need to integrate with Oracle Internet Directory and Oracle Virtual Directory from .net.\nI believe this is done using the System.DirectoryServices.Protocols library.\nUnfortunately I am having some difficulty understanding how to authenticate via this protocol and perform functions such as create user, delete user, reset password, unlock account, validate current password. </p>\n\n<p>I would really appreciate if someone can post some examples on how to do the above with clear instructions.</p>\n"},{"tags":[".net","asp.net","asp.net-mvc","asp.net-mvc-3","orchardcms"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":893,"score":6,"question_id":5693794,"title":"Render image from a theme inside Orchard","body":"<p>I've just picked up Orchard for building my blog. As part of my endeavour to create this new weblog I'm creating a custom theme. This custom theme features both CSS and images. </p>\n\n<p><strong>My question</strong></p>\n\n<p>My question basically comes down to this: How do I render an image that is part of the theme? </p>\n\n<p><strong>What I have tried so far</strong></p>\n\n<p>I have tried to use the following:</p>\n\n<pre><code>&lt;img src=\"@Html.ThemePath(\"/Content/Header.jpg\")\" alt=\"Logo\"/&gt;\n</code></pre>\n\n<p>But that doesn't work to great. It returns the following HTML markup:</p>\n\n<pre><code>&lt;img src=\"~/Themes/FizzyLogic/Content/Header.jpg\" alt=\"Logo\"/&gt;\n</code></pre>\n\n<p>Which is not exactly what it should be returning. I expected it to return the absolute path to the image inside my website.</p>\n"},{"tags":[".net","vb.net","batch","vbscript"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13222899,"title":"Convert Batch to VBS","body":"<p>Hey I been trying to make a batch script to implement into my VB.NET application. What my application does is check if a new version is available, if it is it will download it into the app data file. Then it creates a Batch script, runs it and closes itself.</p>\n\n<p>From here the batch script takes the updated version, takes it and replaces the outdated version. The batch script will run the updated version (it will be in the same directory as the outdated version since it has been moved) and run it. The batch file will then self destruct. I tried doing this but all it did was run the new version and that is it. It did not even self destruct? Here is my batch script:</p>\n\n<pre><code>@echo off\nType \"file\"\nping -n 10 localhost &gt;nul 2&gt;&amp;1\nxcopy /y \"C:\\Documents and Settings\\Mumit\\Application Data\\Icarus\" \"C:\\Documents and           Settings\\Mumit\\Desktop\\Icarus\\Icarus\\Icarus\\bin\\Debug\\Icarus\"\nstart /d \"C:\\Documents and Settings\\Mumit\\Desktop\\Icarus\\Icarus\\Icarus\\bin\\Debug\" Icarus\nDEL\"file\"\nDEL %0\nEXIT\n</code></pre>\n\n<p>As you can see it is only a couple of lines. Can anyone help me port it into a VBS? I would appreciate it.</p>\n\n<p>This is how I wrote it in .NET:</p>\n\n<pre><code> Dim s As New Text.StringBuilder\n            s.Append(\"@echo off\" + Environment.NewLine + \"Type \" + ChrW(34) + \"file\" + ChrW(34) +\n                  Environment.NewLine + \"ping -n 10 localhost &gt;nul 2&gt;&amp;1\" +\n                  Environment.NewLine + \"xcopy /y \" + File2 + \" \" + File1 +\n                  Environment.NewLine + \"start /d \" + ChrW(34) + Splitter(IO.Path.GetDirectoryName(CStr(Splitter(File1)))) + ChrW(34) + \" \" + IO.Path.GetFileName(CStr(Splitter(File1))) +\n                  Environment.NewLine + \"DEL\" + ChrW(34) + \"file\" + ChrW(34) +\n                  Environment.NewLine + \"DEL %0\" +\n                  Environment.NewLine + \"EXIT\")\n</code></pre>\n"},{"tags":[".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":5,"view_count":61,"score":-5,"question_id":13220398,"title":"FOR Loop closest number - Self resolved","body":"<p>I have the following FOR loop which compares the difference between a selected zone number to the elements within the array i.e:</p>\n\n<p>Select zone = 4\nSelected zones available = 1,5,6</p>\n\n<p>so the nearest zone to 4 is 5.</p>\n\n<p>The issue im having is that is I cannot get my 'indexx' value to change it dosent matter if the logic in the if statment is met, it will not change, therefore all i get as a closet answer is the element stored as 'arrayNum(0)' i.e 1.</p>\n\n<p>Can anyone point me in the right direction?</p>\n\n<p>Heres the code:</p>\n\n<pre><code>Dim indexx As Integer = 0\n\nIf rows = True Then\n        rowsNum = ds.Tables(\"Auto\").Rows.Count\n        numm = rowsNum - 1\n        MsgBox(rowsNum)\n\n        Dim arrayNums(numm) As Integer\n\n        Array.Sort(arrayNums)\n        For value As Integer = 0 To numm\n\n            arrayNums(value) = ds.Tables(\"Auto\").Rows(value).Item(6)\n\n            MsgBox(arrayNums(value))\n\n\n            If Math.Abs(arrayNums(value)) - zone &lt; Math.Abs(arrayNums(indexx)) - zone Then\n                indexx = arrayNums(value)\n\n            End If\n\n\n        Next\n        MsgBox(\"zone = : \" &amp; arrayNums(indexx) &amp; \"\")\n\n\n    Else\n        MsgBox(\"No techs avaliable\")\n    End If\n</code></pre>\n"},{"tags":["c#",".net","audio","directsound"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":730,"score":2,"question_id":2195271,"title":"Is it possible to transcode audio in C# using DirectSound?","body":"<p>I want to transcode a lot of audio from its source format to PCM without resampling or messing with the sample size. I figure if Windows Media Player can play the file and it doesn't use a legacy ACM codecs it must be using DirectSound to do so (this is on Windows XP and Windows Server 2k3). So is it possible to access DirectSound from C# and do so? I've tried searching the web but all the examples have been about playback which I have no interest in doing.</p>\n"},{"tags":["c#",".net","xml","xml-parsing","linq-to-xml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13222746,"title":"Comparing and matching XML nodes in C#","body":"<p>I am trying to parse this XML document and match the guid with the link nodes. I have a GUI built in C# that will allow the user to input the guid, and I am trying to spit out the corresponding link node that corresponds with it. </p>\n\n<p>For example. A user enters ID: 8385522 and the program would spit out: </p>\n\n<p><a href=\"http://once.www.example.com\" rel=\"nofollow\">http://once.www.example.com</a></p>\n\n<p>The XML is as follows:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?&gt;\n&lt;rss version=\"2.0\" xmlns:media=\"http://search.yahoo.com/mrss/\"&gt;\n  &lt;channel&gt;\n    &lt;title&gt;\n    &lt;/title&gt;\n    &lt;link&gt;\n    &lt;/link&gt;\n    &lt;description&gt;\n    &lt;/description&gt;\n    &lt;language&gt;\n    &lt;/language&gt;\n    &lt;lastBuildDate&gt;\n    &lt;/lastBuildDate&gt;\n    &lt;item&gt;\n      &lt;title&gt;Parsing Example&lt;/title&gt;\n      &lt;link&gt;http://once.www.example.com&lt;/link&gt;\n      &lt;pubDate&gt;Sun, 16 Sep 2012 02:44:02 &lt;/pubDate&gt;\n      &lt;guid&gt;8385522&lt;/guid&gt;\n    &lt;/item&gt;\n    &lt;item&gt;\n      &lt;title&gt;Parsing Example 2&lt;/title&gt;\n      &lt;link&gt;http://once.once.www.example2.com&lt;/link&gt;\n      &lt;pubDate&gt;Sat, 29 Sep 2012 18:29:13 &lt;/pubDate&gt;\n      &lt;guid&gt;8439191&lt;/guid&gt;\n    &lt;/item&gt;\n  &lt;/channel&gt;\n&lt;/rss&gt;\n</code></pre>\n\n<p>I don't have any code written for the text box that the ID is being entered in. All I have in that field is:</p>\n\n<pre><code>void TextBox1TextChanged(object sender, EventArgs e)\n{\n\n}\n</code></pre>\n\n<p>Do I need put the function inside the text box field? Any help is appreciated.</p>\n\n<p>Edit: Here is what I have so far:</p>\n\n<pre><code> private void button2_Click_1(object sender, EventArgs e)\n        {\n            Clipboard.Clear();\n\n\n            if (Directory.Exists(@\"c:\\text\"))    \n            { \n\n\n            XmlDocument xDoc = new XmlDocument();\n            xDoc.Load(@\"c:\\text\\text.xml\");\n\n            XmlDocument lDoc = new XmlDocument();\n            lDoc.Load(@\"c:\\text\\text.xml\");\n\n\n\n            XmlNodeList ctextbox = xDoc.GetElementsByTagName(\"guid\");\n            XmlNodeList link = lDoc.GetElementsByTagName(\"link\");\n</code></pre>\n\n<p>I'm not sure exactly where the parsing function needs to be.</p>\n"},{"tags":[".net","wcf","performance","serialization",".net-4.5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13223062,"title":"direct project reference or communication via wcf","body":"<p>I am currently architecting my .net 4.5 applications. At present I have web layer and a wcf services layer. They communicate to each other over soap.</p>\n\n<p>Both layers are co located on the one server.</p>\n\n<p>I am considering moving from communicating over soap to direct project references. So that it moves from one application from two. Main motivation behind this is to improve performance of not having to undergo serializing and deserializing of communication between web and services.</p>\n\n<p>What I lose from this change, is scalability of moving my services layer to a separate tier in the future, ie a different server.</p>\n\n<p>I am looking for feedback on this, is there a major performance hit from the serialization. Thoughts on the above? Anything that I should consider that I have omitted.</p>\n"},{"tags":[".net","asp.net","gridview","drop-down-menu","ascx"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2512,"score":0,"question_id":2758302,"title":"Adding Event Handler to DropDownList inside GridView - how to?","body":"<p>I have DropDownList inside GridView. Now I would like to add event handler for dropdownlist which would react on SelectedIndexChanged.\nI'm nesting DropDownList inside GridView by using RowDataBound event for GridView.\n(http://www.highoncoding.com/Articles/169_DropDownList_Inside_GridView__Method_1_.aspx)\nCan anybody help me, and tell me how to add event handling for dropdownlist, please?</p>\n"},{"tags":[".net","diagram"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13223140,"title":"What is the best way to generate diagram with editing capabilities","body":"<p>We developed .net app to generate diagram of specified set of types. \nInitially there was only one requirement - diagram should be rendered on web.\nSo we choose to generate diagram in svg format (it's very easy to show on web site).</p>\n\n<p>A recent requirement was to generate more complex diagram. And these diagrams cannot really be structured automatically - user should have a way to edit result. </p>\n\n<p>So we decided to use Microsoft Visio api to generate diagrams. After generating process user should open any diagrams to edit and than save it as svg.\nThis process i think isn't simple - and i think maybe there is a better solution?</p>\n"},{"tags":["c#",".net","dynamics-crm","dynamics-crm-2011"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":267,"score":1,"question_id":8619325,"title":"Deep cloning entity from one org to another","body":"<p>So, yet another fun task at hand.</p>\n\n<p>We have created a windows service to keep some records in sync between 2 CRM 2011 orgs in production.</p>\n\n<p>We have looked into deep cloning which is what we want, but it appears that it's deep cloning the EntityReference, not the actual Entity.</p>\n\n<p>Any ideas, advice, etc would be awesome.</p>\n"},{"tags":[".net","wpf","silverlight","xaml"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2078,"score":3,"question_id":1821238,"title":"Embed a System.String in XAML","body":"<p>Is there a way to embed a string in XAML, give it and ID and refer to it later.</p>\n\n<p>I have tried:</p>\n\n<pre><code>    &lt;Window x:Class=\"WpfApp1.Window1\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:System=\"clr-namespace:System;assembly=mscorlib\"\n        Title=\"Window1\" Height=\"300\" Width=\"500\"&gt;\n        &lt;Grid&gt;\n            &lt;System:String&gt;Test&lt;/System:String&gt;\n        &lt;/Grid&gt;\n    &lt;/Window&gt;\n</code></pre>\n\n<p>And get error:<br>\nCannot add instance of type 'String' to a collection of type 'UIElementCollection'. Only items of type 'UIElement' are allowed.</p>\n\n<p>Could I do this if I nested the String somewhere else in the XAML? or inside a non UI element? Then do I just give it a Name attribute?</p>\n"},{"tags":["c#",".net","enums","enum-flags"],"answer_count":3,"favorite_count":2,"up_vote_count":37,"down_vote_count":0,"view_count":787,"score":37,"question_id":13222671,"title":"Why are flag enums usually defined with hexadecimal values","body":"<p>A lot of times I see flag enum declarations that use hexadecimal values. For example:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Flags]\npublic enum MyEnum\n{\n    None  = 0x0,\n    Flag1 = 0x1,\n    Flag2 = 0x2,\n    Flag3 = 0x4,\n    Flag4 = 0x8,\n    Flag5 = 0x10\n}\n</code></pre>\n\n<p>When I declare an enum, I usually declare it like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Flags]\npublic enum MyEnum\n{\n    None  = 0,\n    Flag1 = 1,\n    Flag2 = 2,\n    Flag3 = 4,\n    Flag4 = 8,\n    Flag5 = 16\n}\n</code></pre>\n\n<p>Is there a reason or rationale to why some people choose to write the value in hexadecimal rather than decimal? The way I see it, it's easier to get confused when using hex values and accidentally write <code>Flag5 = 0x16</code> instead of <code>Flag5 = 0x10</code>.</p>\n"},{"tags":["c#",".net","vb.net","frameworks"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13222796,"title":"Using Try Catch or check value first","body":"<p>I need to know what is better (for performance and else), Using Try Catch when expecting error and there is no alternate scenario when error hapened or check the value first ?</p>\n\n<p>For Example (VB.net):\n If I need to fill text box by value from database (from Data Reader for example), and I expecting some null values, and if value is null I will leave textbox empty.</p>\n\n<p>now I have to ways to do this:</p>\n\n<pre><code>try\n  textbox1.text = DR(\"Name\")\ncatch\nend try\n</code></pre>\n\n<p>now if column Name contain null value the error will raise and textbox1 still empty.</p>\n\n<pre><code>If Not IsDBNull(DR(\"Name\")) Then textbox1.Text = DR(\"Name\")\n</code></pre>\n\n<p>what is better ?</p>\n\n<p>Thank you so much.</p>\n"},{"tags":["c#",".net","zip"],"answer_count":3,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":4361,"score":7,"question_id":5945209,"title":"Handling Zip Files Without Third Party Lib in .NET 4.0?","body":"<p>There is a similar question for 3.5 here:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/593026/is-there-a-built-in-zip-library-in-net-3-5\">Is there a built-in zip library in .NET 3.5?</a></p>\n\n<p>that speculated that 4.0 would have it, but I can't find any info about it.  If not, does anyone know why not?  Seems like it would be fairly high on the list of things to include support for.</p>\n"},{"tags":[".net","exception","outofmemoryexception","stackoverflowexception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":12774975,"title":"What kind of Exceptions cannot be handled?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7392783/list-of-exceptions-that-cant-be-caught-in-net\">List of exceptions that CAN&#39;T be caught in .NET</a>  </p>\n</blockquote>\n\n\n\n<p>As is documented, try/catch blocks can't handle StackOverflowException and OutOfMemoryException. </p>\n\n<p>Are there any other Exceptions that also suffer from this limitation?</p>\n"},{"tags":[".net","tcl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13222722,"title":"Is there a way to integrate .NET with an existing custom TCL interpreter?","body":"<p>I am trying to write scripts that use TCL interpreter that implements core TCL commands and a few additional ones - tcscid (as documented <a href=\"http://scid.sourceforge.net/doc/progref.html\" rel=\"nofollow\">here</a>). I am able to write tcl scripts against it, but want to have it also integrated it with .NET. </p>\n\n<p>I know that there are .NET implementations of TCL interpreters (such as <a href=\"http://sourceforge.net/projects/tclcsharp/\" rel=\"nofollow\">tclSharp</a> ), which is not what I am looking for since I already have a specific interpreter that is distributed as binary (I have access to source code, but have a hard time re-compiling - although that still remains an option). </p>\n\n<p>So I am looking for something along the lines of:</p>\n\n<ol>\n<li><p>invoking .NET from my TCL scripts (given that interpreter itself is locked and does not know anything about .NET). or</p></li>\n<li><p>writing a C# program that uses an API that wraps launching tcscid as a separate process and sends command to it (does such an API exist?) </p></li>\n</ol>\n\n<p>Something else?</p>\n"},{"tags":["c#",".net","memory-management","garbage-collection"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":13222145,"title":"is clearing lists before returning good?","body":"<p>I'm working with C# and in some methods I use several lists for database results. These can be quite large (10 lists of about 1,000 objects each).\nFor the moment, I just return from these methods and let the garbage collector clear it. If just before returning I write <code>TheList.Clear();</code> is this going to be of any benefit?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","xml","windows-mobile","compact-framework"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":844,"score":4,"question_id":2989536,"title":".NET compact framework - where to put files so that they are accessible to emulator","body":"<p>I have a .NET CF project. In the project directory I put a simple xml file (<em>users.xml</em>) which has to be read by the device. When I debug the application on device emulator and try to load the file from code, the Exception is thrown (<code>FileNotFoundException \"Could not find file '\\\\users.xml'.\"</code>).  </p>\n\n<p>Is there a mechanism to automatically deploy also configuration files to a device emulator?</p>\n"},{"tags":[".net","listview","vb6","thumbnails","imagelist"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13206339,"title":"listview with multiple imagelist and icons/image","body":"<p>i need a way to use two imagelist on a listview. one of the image list if for header icons which contain 16x16 icons, and another will contains 32x32 thumbnail pictures within the sub items. </p>\n\n<p>The image below shows what am trying to do</p>\n\n<p><img src=\"http://i.stack.imgur.com/Bjnbk.png\" alt=\"listview with hearder icons and thumbnail \"></p>\n"},{"tags":["c#",".net","shuffle","playing-cards"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":2,"view_count":8185,"score":3,"question_id":1150646,"title":"Card Shuffling in C#","body":"<p>I am trying to write a code for a project that lists the contents of a deck of cards, asks how much times the person wants to shuffle the deck, and then shuffles them. It has to use a method to create two random integers using the System.Random class. </p>\n\n<p>These are my classes:</p>\n\n<p>Program.cs:</p>\n\n<pre><code>namespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Deck mydeck = new Deck();\n            foreach (Card c in mydeck.Cards)\n            {\n                Console.WriteLine(c);\n            }\n            Console.WriteLine(\"How Many Times Do You Want To Shuffle?\");\n\n        }\n    }\n}\n</code></pre>\n\n<p>Deck.cs:</p>\n\n<pre><code>namespace ConsoleApplication1\n{\n    class Deck\n    {    \n        Card[] cards = new Card[52];\n        string[] numbers = new string[] { \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"J\", \"Q\", \"K\" };\n        public Deck()\n        {\n            int i = 0;\n            foreach(string s in numbers)\n            {\n                cards[i] = new Card(Suits.Clubs, s);\n                i++;\n\n            }\n            foreach (string s in numbers)\n            {\n                cards[i] = new Card(Suits.Spades, s);\n                i++;\n\n            }\n            foreach (string s in numbers)\n            {\n                cards[i] = new Card(Suits.Hearts, s);\n                i++;\n\n            }\n            foreach (string s in numbers)\n            {\n                cards[i] = new Card(Suits.Diamonds, s);\n                i++;\n\n            }\n        }\n\n        public Card[] Cards\n        {\n            get\n            {\n                return cards;\n\n\n            }\n        }\n    }  \n}\n</code></pre>\n\n<p>Enums.cs:</p>\n\n<pre><code>namespace ConsoleApplication1\n{        \n    enum Suits \n    {\n        Hearts,\n        Diamonds,\n        Spades,\n        Clubs\n    }\n}\n</code></pre>\n\n<p>Card.cs:</p>\n\n<pre><code>namespace ConsoleApplication1\n{\n    class Card\n    {\n        protected Suits suit;\n        protected string cardvalue;\n        public Card()\n        {\n        }\n        public Card(Suits suit2, string cardvalue2)\n        {\n            suit = suit2;\n            cardvalue = cardvalue2;\n        }\n        public override string ToString()\n        {\n            return string.Format(\"{0} of {1}\", cardvalue, suit);\n        }\n    }\n }\n</code></pre>\n\n<p>Please tell me how to make the cards shuffle as much as the person wants and then list the shuffled cards.</p>\n"},{"tags":[".net","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13222104,"title":"Entity Framework: EF gets related objects of an entity in different order","body":"<p>I'm working with MVC3 and Entity Framework 4.0. The situation is the following: I have an entity called \"Topics\" and a related entity called \"Questions\". To visualize the questions I have a Topics view and then in a foreach sentence inside the view, show the Questions related to that topic: </p>\n\n<p><code>\n<code>foreach(Questions Question in Topic.Questions)\n{\n//Show question info\n}</code>\n</code></p>\n\n<p>But anytime a question is updated in another view, when I go to the Topic view, the questions appear in a diferent order, most specifically, the question that was updated appears first.</p>\n\n<p>Anyone knows why is this behavior?. And how to stop it?</p>\n"},{"tags":[".net","visual-studio-2010","permissions","setup-deployment"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13222045,"title":".NET setup files on client environment doesn't work as expected","body":"<p>I have developed a simple application in Visual Studio 2010 to be used on the client's environment.\nTo distribute it I have created a deployment package using Visual Studio's Setup Project wizard.  It automatically included the .NET framework 4.0 client and Windows Installer 3.1 as dependencies.</p>\n\n<p>The install files are kept on a server where only admin users are able to access.</p>\n\n<p>When I test the deployment within our business environment the install works fine as long as the installing user has admin privileges as expected.</p>\n\n<p>In the client environment, an admin user logged in to test the install.  Install worked as expected.  But when a normal user logs in to the PC the install stated again and trying to access the install files.  of course they are not allowed to access the install source, so the PC hangs looking to access something.</p>\n\n<p>What I'm struggling to understand is why the install is starting again when the normal users login and what it might be looking for.<br>\nAny pointers would be helpful.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","windows-8","windows-store-apps"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13221721,"title":"Detect edges of screen","body":"<p>I am using following code to drag a rectangular in windows 8 app using c#</p>\n\n<pre><code>void Drag_ManipulationDelta(object sender,ManipulationDeltaRoutedEventArgs e)\n{\n   // Move the rectangle.   \n   dragTranslation.X += e.Delta.Translation.X;\n   dragTranslation.Y += e.Delta.Translation.Y; \n}\n</code></pre>\n\n<p>But when I throw the rectangle it disappears from screen, I want to keep rectangle within the screen, how to detect the edges of screen? </p>\n"},{"tags":["c#",".net","linq-to-xml"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13221676,"title":"list of node that there attribute","body":"<p>I need a list of all the Attribute <strong>ID</strong>(the value) of Descendants(Frame) that have an Attribute <strong>SecondFeature</strong> (Descendants-ObjectClass) that equal <strong>Vehicle</strong>.\n(there is node that have 1 \"object\", other 2/3 time and other not at all)\nthis is a part of the code:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt; \n- &lt;Frame ID=\"120\"&gt;\n&lt;PTZData Zoom=\"1.000\" /&gt;\n- &lt;Object ID=\"5\"&gt;\n &lt;ObjectClass SecondFeature=\"vehicle\" /&gt; \n&lt;/Object&gt;\n&lt;/Frame&gt;\n</code></pre>\n"},{"tags":[".net","c","webkit","webbrowser","chromium"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":4,"view_count":27,"score":-2,"question_id":13221687,"title":"Chromium webbrowser","body":"<p>I want to make a really advanced browser even with page source wiewer. </p>\n\n<p>I did everything in code but i don't think that ie engine is good for me. So i want to use chromium or webkit. I prefer chromium. </p>\n\n<p>I saw hot to make a chrome browser in developer site and how to make a safari in webkit site but i want smt. diffrent. </p>\n\n<p>Can anyone give me some example codes or tell me how to replace it with ie? I'm waiting your answers. </p>\n\n<p>[Note: It should be .net, c++ or C#)</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":62,"score":0,"question_id":13221610,"title":"get returns null","body":"<p>I have got some class</p>\n\n<pre><code>public static class SessionManager\n{\n    public static UserSession UserSession\n    {\n        set\n        {                \n           HttpContext.Current.Session[\"USER_SESSION\"] = value;\n        }\n        get\n        {\n           UserSession userSession = new UserSession();\n\n           try\n           {\n              userSession = (UserSession)HttpContext.Current.Session[\"USER_SESSION\"];\n           }\n           catch (Exception)\n           {\n           }\n\n           return userSession;\n       }\n   }\n}\n</code></pre>\n\n<p>And I am trying  to use it </p>\n\n<pre><code>var userSession = SessionManager.UserSession;\n</code></pre>\n\n<p>And the <code>userSesssion</code> is always <code>null</code>.</p>\n\n<p>Any clue how it can be fixed?</p>\n"},{"tags":["asp.net",".net","xml","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13221753,"title":"Reading XML file in ASP.NET Website - Operating Efficiency","body":"<p>Project type: ASP.NET Website</p>\n\n<p>Currently we are employing a set of lookup data stored as an XML file inside the project to fill data on a certain ASPX page. </p>\n\n<p>We're looking at changing this approach to the one below citing efficiency:</p>\n\n<p>Store the XML file values in Database. Fetch the values from Database on application start (Global.asax). Store in an in-memory object like LIST or HASHTABLE and Use this further.</p>\n\n<p>Is this a valid approach? Is there something that could be done better?</p>\n\n<p>If you need any more details, please leave a comment below. I'll be happy to share.</p>\n"},{"tags":["c#","c++",".net","3d","ogre"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":19,"score":-1,"question_id":13221718,"title":"Disable Mouse in Mogre","body":"<p>How can I disable mouse movement in Mogere? I'd like to do it in c# or c++.</p>\n"},{"tags":[".net","vb.net","visual-studio","visual-studio-2010","windows-forms-designer"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":227,"score":4,"question_id":9392908,"title":"Visual Studio Designer message","body":"<p>When try to open in design mode a form (VB.NET), in which I have a custom UserControl, I see the message from Visual Studio: </p>\n\n<pre><code>---------------------------\nMicrosoft Visual Studio\n---------------------------\nThe control MyNamespace.MyUserControl has thrown an unhandled exception \nin the designer and has been disabled.  \n\nException:\nCannot access a disposed object.\nObject name: 'SplitterPanel'.\n\nStack trace:\n---------------------------\nOK   \n---------------------------\n</code></pre>\n\n<p>And the form is not displayed in designer. What to do?</p>\n"},{"tags":["c#",".net","regex"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13221048,"title":"RegEx port enumeration validation","body":"<p>I'm new to Regular Expressions, please help me to write a new Regex. It should be working for these: </p>\n\n<pre><code>28\n28,57,130\n13-18\n13,18-57,65\n44-56,50-130,150,180-213\n12-25,28\n1024-8000,27000-30000\n1024-65535\n</code></pre>\n\n<p>It shoudn't work for </p>\n\n<pre><code>15,13 // 13 is less than 15\n15-11 // 11 is less than 15\n15-18,10\n15-18,20,11-130 // because of 11\n0 // port number 0 is reserved and can't be used \n11-180,250,65536 // it should be less than 65535\n</code></pre>\n"},{"tags":["c#","c++",".net","windows-8","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":99,"score":4,"question_id":13144479,"title":"How do you access a Metro app's local storage in a desktop application in Windows 8?","body":"<p>Is there an API available for this in .Net?  What about in the Windows API?  If not, has anyone come up with some hackish-way to do this yet?</p>\n"},{"tags":[".net","sql-server-express","sqldatatypes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13220079,"title":"How to store a long text in SQL Server Express and how to use it in .NET?","body":"<p>I need to store email messages in my SQL Server Express database instance. Considering this could be a very long string, I decided to use <code>Text</code> data type in the DB. However, there is no equivalent to this in .NET. Is that a good choice for this type of object to store?</p>\n\n<p>I found out that <code>text</code> is going to be deprecated and developers should use <code>varchar(max)</code> instead. What <code>max</code> value would I have to set then?</p>\n\n<p>What should I use in my WPF application to take that objects? By default, Visual Studio uses <code>string</code> in the code generated by Entity Data Model but is it enough?</p>\n"},{"tags":["c#",".net","richtextbox"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13220856,"title":"How to use multi color in richtextbox","body":"<p>I using C# windows forms and I have richtextbox and I want to color some text in red, some in green and some in black.</p>\n\n<p>How to do so? Image attached. </p>\n\n<p><img src=\"http://i.stack.imgur.com/IFa5T.png\" alt=\"enter image description here\"></p>\n"},{"tags":[".net","iis","memory-management","clr","vmware"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":118,"score":4,"question_id":12707970,"title":"MemoryFailPoint throws InsufficientMemoryException unconditional","body":"<p>I have a very strange issue; in our REST application we have introduced an option for upload of a WebPackage. Since these can be rather large when unpacked, we wanted to assure a successful experience with memory check by MemoryFailPoint.</p>\n\n<p>On my local IIS 7.5 this works flawlessly - even up to a max. expected value of 2GB.\nOn our virtual Windows Server 2008R2 x64 with IIS 7.5 this fails unconditionally - even if only trying 1MB.</p>\n\n<p>The virtual server is hosted on VMWare ESXi 4.1.0, 348481.</p>\n\n<p>Here is the sample code that fails on the virtual machine:</p>\n\n<pre><code>using (MemoryFailPoint failPoint = new MemoryFailPoint(1))\n{\n   ... // deliberately excluded webpackage code\n}\n</code></pre>\n\n<p>And the exception (in XML):</p>\n\n<pre><code>&lt;InsufficientMemoryException&gt;\n    &lt;Message&gt;Insufficient memory to meet the expected demands of an operation, and this system is likely to never satisfy this request.  If this is a 32 bit system, consider booting in 3 GB mode.&lt;/Message&gt;\n    &lt;StackTrace&gt;\n        &lt;Line&gt;at System.Runtime.MemoryFailPoint..ctor(Int32 sizeInMegabytes)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]&amp;amp; outputs)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc&amp;amp; rpc)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc&amp;amp; rpc)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc&amp;amp; rpc)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)&lt;/Line&gt;\n    &lt;/StackTrace&gt;\n    &lt;UserDefinedInformation&gt;\n        &lt;failpointSizeInMegaBytes&gt;1.00&lt;/failpointSizeInMegaBytes&gt;\n        &lt;gcTotalMemoryBeforeInMegaBytes&gt;153.34&lt;/gcTotalMemoryBeforeInMegaBytes&gt;\n    &lt;/UserDefinedInformation&gt;\n&lt;/InsufficientMemoryException&gt;\n</code></pre>\n\n<p>And a similiar exception from my machine - take note that i needed to allocate <strong>64GB</strong> <em>BEFORE</em> i could trigger the exception:</p>\n\n<pre><code>&lt;InsufficientMemoryException&gt;\n    &lt;Message&gt;Insufficient available memory to meet the expected demands of an operation at this time.  Please try again later.&lt;/Message&gt;\n    &lt;StackTrace&gt;\n        &lt;Line&gt;at System.Runtime.MemoryFailPoint..ctor(Int32 sizeInMegabytes)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object instance, Object[] inputs, Object[]&amp;amp; outputs)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc&amp;amp; rpc)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc&amp;amp; rpc)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc&amp;amp; rpc)&lt;/Line&gt;\n        &lt;Line&gt;at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean isOperationContextSet)&lt;/Line&gt;\n    &lt;/StackTrace&gt;\n    &lt;UserDefinedInformation&gt;\n        &lt;failpointSizeInMegaBytes&gt;65536.00&lt;/failpointSizeInMegaBytes&gt;\n        &lt;gcTotalMemoryBeforeInMegaBytes&gt;150.63&lt;/gcTotalMemoryBeforeInMegaBytes&gt;\n    &lt;/UserDefinedInformation&gt;\n&lt;/InsufficientMemoryException&gt;\n</code></pre>\n\n<p>This is driving me nuts .. for real .. but hey; take note of the two (very) different exceptions:</p>\n\n<p><strong>Server</strong>: <em>Insufficient memory to meet the expected demands of an operation, and this system is likely to never satisfy this request.  If this is a 32 bit system, consider booting in 3 GB mode.</em></p>\n\n<p>Using dotPeek from Jetbrains and this website, <a href=\"http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/ndp/clr/src/BCL/System/Runtime/MemoryFailPoint@cs/1305376/MemoryFailPoint@cs\" rel=\"nofollow\">http://reflector.webtropy.com/default.aspx/4@0/4@0/untmp/DEVDIV_TFS/Dev10/Releases/RTMRel/ndp/clr/src/BCL/System/Runtime/MemoryFailPoint@cs/1305376/MemoryFailPoint@cs</a>, we can see what might be the issue (although I am still clueless):</p>\n\n<pre><code>        // Check to see that we both have enough memory on the system\n        // and that we have enough room within the user section of the\n        // process's address space.  Also, we need to use the GC segment\n        // size, not the amount of memory the user wants to allocate.\n        // Consider correcting this to reflect free memory within the GC\n        // heap, and to check both the normal &amp; large object heaps.\n        ulong num1 = (ulong) sizeInMegabytes &lt;&lt; 20;\n        this._reservedMemory = num1;\n        ulong size = (ulong)(Math.Ceiling((double)num1 / (double)MemoryFailPoint.GCSegmentSize) * (double)MemoryFailPoint.GCSegmentSize);\n        if (size &gt;= MemoryFailPoint.TopOfMemory)\n            throw new InsufficientMemoryException(Environment.GetResourceString(\"InsufficientMemory_MemFailPoint_TooBig\"));\n</code></pre>\n\n<p><strong>Local</strong>: <em>Insufficient available memory to meet the expected demands of an operation at this time.  Please try again later.</em></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Hans and I had a discussion about VM Size but since I have now concluded that it is more or less equal on the development server and my machine, I will rule this part out for now. Any hints, suggestions etc. is more than welcome.</p>\n\n<p><strong>Process Info</strong></p>\n\n<pre><code>Process Name: w3wp\nPID: 5716\nUser Name: NT AUTHORITY\\NETWORK SERVICE\nWorking Set: 376.456 K\nPeak Working Set: 432.400 K\nPrivate Working Set: 320.684 K\nCommit Size: 538.552 K\nHandles: 919\nThreads: 39\n</code></pre>\n\n<p><strong>Operating System (WMI)</strong></p>\n\n<pre><code>BootDevice: \\Device\\HarddiskVolume1\nBuildNumber: 7601\nBuildType: Multiprocessor Free\nCaption: Microsoft Windows Server 2008 R2 Standard \nCodeSet: 1252\nCountryCode: 45\nCreationClassName: Win32_OperatingSystem\nCSCreationClassName: Win32_ComputerSystem\nCSDVersion: Service Pack 1\nCSName: SOME_NAME [MODIFIED]\nCurrentTimeZone: 120\nDataExecutionPrevention_32BitApplications: True\nDataExecutionPrevention_Available: True\nDataExecutionPrevention_Drivers: True\nDataExecutionPrevention_SupportPolicy: 3\nDebug: False\nDescription: Development Server\nDistributed: False\nEncryptionLevel: 256\nForegroundApplicationBoost: 2\nFreePhysicalMemory: 5.366.516 K\nFreeSpaceInPagingFiles: 8.368.456 K\nFreeVirtualMemory: 12.985.412 K\nInstallDate: 17-01-2011 15:01:55\nLargeSystemCache: null\nLastBootUpTime: 11-09-2012 14:44:33\nLocalDateTime: 03-10-2012 14:13:47\nLocale: 0406\nManufacturer: Microsoft Corporation\nMaxNumberOfProcesses: 4294967295\nMaxProcessMemorySize: 8.589.934.464 K\nMUILanguages: System.Object[]\nName: Microsoft Windows Server 2008 R2 Standard |C:\\Windows|\\Device\\Harddisk0\\Partition2\nNumberOfLicensedUsers: null\nNumberOfProcesses: 70\nNumberOfUsers: 7\nOperatingSystemSKU: 7\nOrganization: \nOSArchitecture: 64-bit\nOSLanguage: 1033\nOSProductSuite: 272\nOSType: 18\nOtherTypeDescription: null\nPAEEnabled: null\nPlusProductID: null\nPlusVersionNumber: null\nPrimary: True\nProductType: 3\nRegisteredUser: Windows User\nSerialNumber: 11111-111-1111111-11111 [MODIFIED]\nServicePackMajorVersion: 1\nServicePackMinorVersion: 0\nSizeStoredInPagingFiles: 8.388.152 K\nStatus: OK\nSuiteMask: 272\nSystemDevice: \\Device\\HarddiskVolume2\nSystemDirectory: C:\\Windows\\system32\nSystemDrive: C:\nTotalSwapSpaceSize: null\nTotalVirtualMemorySize: 16.774.452 K\nTotalVisibleMemorySize: 8.388.152 K\nVersion: 6.1.7601\nWindowsDirectory: C:\\Windows\n</code></pre>\n\n<p><strong>VMMap Screenshot from Development Server</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/5s2yi.png\" alt=\"VMMap\"></p>\n\n<p>Being curious about the Virtual Size, I download VMMap from Sysinternals: <a href=\"http://technet.microsoft.com/en-us/sysinternals/dd535533\" rel=\"nofollow\">http://technet.microsoft.com/en-us/sysinternals/dd535533</a></p>\n\n<p><strong>VMMap Screenshot from My Local Machine (where MemoryFailPoint works as expected)</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/prreJ.png\" alt=\"VMMap 2\"></p>\n\n<p>It is still not clear to me why the MemoryFailPoint fails - and it is important (especially when talking Windows Azure or other cloud providers) to make sure there is enough memory for the operation. To take an example, then an ExtraSmall instance will fail (even it's x64 architecture) somewhere in the process because of the very limited resources - this could be prevented by the MemoryFailPoint, hence assuring a valid state of data.</p>\n\n<p>Any help is most appreciated.</p>\n"},{"tags":[".net","vb.net","streamwriter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13221447,"title":"Exception in StreamWriter and writing to a text file","body":"<p>I'm trying to write a simple text file writer.</p>\n\n<p>If I throw an exception in the using of the writer does it automatically close?</p>\n\n<p>Is it OK to write it like this as it works and its only three lines. If the file is not there then it adds it and writes text into it; if it does exist then it appends text to it?</p>\n\n<p>All the other example I have found online are way too long and complicated?</p>\n\n<pre><code>Try\n    For index = 1 To 100 Step 1\n\n        Dim filePath As String = \"c:\\TextFile2.txt\"\n\n        Using writer As New StreamWriter(filePath, True)\n            writer.WriteLine(\"Important data line\" &amp; index)\n\n            ''Throw New ArgumentException(\"Exception Occured\")\n\n        End Using\n    Next\n\nCatch ex As Exception\n\n    Console.WriteLine(ex.Message)\n    Console.ReadLine()\nEnd Try\n</code></pre>\n"},{"tags":[".net","f#","llvm","dllimport","llvm-fs"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":205,"score":3,"question_id":12191702,"title":"DllImport can't find dll even though dll is in same folder as executable","body":"<p>I'm trying to use the <a href=\"https://github.com/keithshep/llvm-fs\" rel=\"nofollow\">llvm-fs</a> project, which provides llvm bindings for F#. I have compiled the <code>LLVM-3.1.dll</code> file with <code>--enable-shared</code> and it now resides in same directory as my compiled executable (I checked with <code>Environment.CurrentDirectory</code>). The <code>DllImport</code> in llvm-fs looks like:</p>\n\n<pre><code>[&lt;DllImport(\n    \"LLVM-3.1.dll\",\n    EntryPoint=\"LLVMModuleCreateWithName\",\n    CallingConvention=CallingConvention.Cdecl,\n    CharSet=CharSet.Ansi)&gt;]\nextern void* (* LLVMModuleRef *) moduleCreateWithNameNative(string ModuleID)\n</code></pre>\n\n<p>Yet when I run my application it errors with:</p>\n\n<pre><code>Unable to load DLL 'LLVM-3.1.dll': The specified module could not be found.\n(Exception from HRESULT: 0x8007007E)\n</code></pre>\n\n<p>How do I get the DLL to be loaded? For reference, <a href=\"https://github.com/CRogers/BasicCompiler/blob/05e0c6dce687f58b925e9e4425ec019bff2ad88a/lib/llvm-3.1/LLVM-3.1.dll\" rel=\"nofollow\">here's the exact DLL I'm trying to load</a>.</p>\n"},{"tags":["c#",".net","multithreading","scheduled-tasks"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":58,"score":1,"question_id":13219996,"title":"Custom multi-threaded Http Server isn't a thread safe","body":"<p>There is a simple multi-threaded web server I wrote in C# (the part of the code):</p>\n\n<pre><code>  public class MyServer\n    {\n        private readonly HttpListener _listener = new HttpListener();\n        private int  _dataId;\n        public HttpServer(string prefix, string folder)\n        {\n            System.Threading.ThreadPool.SetMaxThreads(50, 1000);\n            System.Threading.ThreadPool.SetMinThreads(50, 50);\n            //........\n        }\n\n        public void Start()\n        {\n            _listener.Start();\n            while (true)\n             ThreadPool.QueueUserWorkItem(ProcessRequest, _listener.GetContext());\n        }\n\n\n        private void ProcessRequest(object obj)\n        {\n           //.....\n        }\n\n\n}\n</code></pre>\n\n<p>If a send the requests by browser (or whatever using only one main thread) then everything is OK. But if do it by the code below, then the server usually receives the same values for different requests:</p>\n\n<p>Your thought?</p>\n\n<p>--<strong>EDIT</strong>--:</p>\n\n<p>The simple question is, does using only local variables make me sure that my code is thread safe? And vise versa: if I'm using instance variables (not static, <strong>that's _dataId in my case</strong>), must I \"look after\" them to make them thread safe (for instance, by <code>lock</code> keyword)?</p>\n"},{"tags":["c#",".net","list"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13220889,"title":".Net: How can I display full 7 days of the week if my data only represents some days of the week?","body":"<p>I am working with an application written in C# which handles an agenda where every day can have some related information. For simplicity reasons, let's define a Day object like the following:</p>\n\n<pre><code>public class Day\n{\n    public DateTime date { get; set; }\n    public List&lt;string&gt; info { get; set; }\n}\n</code></pre>\n\n<p>There's a function that, given a starting date, will return a list containing all Days in the next week which have some information. Days in the next week that have info.Count = 0 are not in the returned list. Therefore, we can expect to obtain a List object with size 7 or less. Now, I have the following problem:</p>\n\n<p>I want to show all seven days, whether or not they are on the obtained list.</p>\n\n<p>The easy (and inefficient) solution I came up with is to code a function that takes the obtained List, reads it and adds the missing days (if any) into it. This way we always have a list with size 7 and can happily populate an asp:Repeater with it. But I think there is a better way to do this:</p>\n\n<p>It is known in advance that the system has to display the next consecutive seven days starting from the given date. It shouldn't be necessary to have the complete List to display the data. My question is, how can this be done? Am I going into the bad direction by doing this with a repeater?</p>\n"},{"tags":[".net","visual-studio","debugging"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":583,"score":2,"question_id":3836269,"title":"debugging VS 2005 prompts an \"Operation not supported\"","body":"<p>I've been debbugging VS 2005 and set the 'Start external program' to C:\\Program Files\\Microsoft Visual Studio 10.0\\Common7\\IDE\\devenv.exe </p>\n\n<p>But after hitting F5 I got this error:</p>\n\n<p>Error while trying to run project: Unable to start program 'C:\\Program Files\\Microsoft Visual Studio 10.0\\Common7\\IDE\\devenv.exe</p>\n\n<p>Operation not supported. Unknown error: 0x8013134b.</p>\n\n<p>I can debug successfully if I set it to C:\\Program Files\\Microsoft Visual Studio 9.0\\Common7\\IDE\\devenv.exe</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","garbage-collection","idisposable"],"answer_count":14,"favorite_count":154,"up_vote_count":162,"down_vote_count":0,"view_count":25158,"score":162,"question_id":538060,"title":"Proper use of the IDisposable interface","body":"<p>I know from reading <a href=\"http://msdn.microsoft.com/en-us/library/system.idisposable.aspx\" rel=\"nofollow\">the MSDN documentation</a> that the \"primary\" use of the IDisposable interface is to clean up unmanaged resources.</p>\n\n<p>To me, \"unmanaged\" means things like database connections, sockets, window handles, etc.  But, I've seen code where the Dispose method is implemented to free <em>managed</em> resources, which seems redundant to me, since the garbage collector should take care of that for you.</p>\n\n<p>For example:</p>\n\n<pre><code>public class MyCollection : IDisposable\n{\n    private List&lt;String&gt; _theList = new List&lt;String&gt;();\n    private Dictionary&lt;String, Point&gt; _theDict = new Dictionary&lt;String, Point&gt;();\n\n    // Die, you gravy sucking pig dog!\n    public void Dispose()\n    {\n        _theList.clear();\n        _theDict.clear();\n        _theList = null;\n        _theDict = null;\n    }\n</code></pre>\n\n<p>My question is, does this make the garbage collector free memory used by MyCollection any faster than it normally would?</p>\n\n<p><strong>edit</strong>:  So far people have posted some good examples of using IDisposable to clean up unmanaged resources such as database connections and bitmaps.  But suppose that _theList in the above code contained a million strings, and you wanted to free that memory <em>now</em>, rather than waiting for the garbage collector.  Would the above code accomplish that?</p>\n"},{"tags":["c#",".net","algorithm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":69,"score":-1,"question_id":13218985,"title":"Alphametic/Cryptarithm solver with n based number system","body":"<p><a href=\"http://www.cryptarithms.com/\" rel=\"nofollow\">Cryptarithm</a> solving is a nice programming contest, but I can only solve base-10 <code>Alphametics</code>. Is there any good algorithm or code snippet that can solve base-N encoded cryptarithms? I created a brute-force algorithm, but with a high <code>N</code> value, it does not finish in normal time. </p>\n"},{"tags":["c#",".net","wpf","mef","caliburn.micro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13214429,"title":"ImportMany of MEF loading Contracts twice","body":"<p>I have two classes which Exports <code>IScreen</code>, but when I import the same using </p>\n\n<pre><code>[ImportMany(typeof(IScreen))]\nprivate IEnumerable&lt;Lazy&lt;IScreen,IJIMSMetadata&gt;&gt; _modules;\npublic IEnumerable&lt;Lazy&lt;IScreen, IJIMSMetadata&gt;&gt; Modules\n{\n        get { return _modules; }\n}\n</code></pre>\n\n<p>The Modules contain four instance of IScreen, but I have Exported only two.</p>\n\n<p>This is Container</p>\n\n<pre><code>container = new CompositionContainer(\n                new AggregateCatalog(AssemblySource.Instance.Select(x =&gt; new AssemblyCatalog(x)))                \n                );\n\n\nprotected override IEnumerable&lt;Assembly&gt; SelectAssemblies()\n{\n    string _modulePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location), \"Modules\");\n    var files = Directory.GetFiles(_modulePath, \"*.dll\", SearchOption.AllDirectories);\n\n    List&lt;Assembly&gt; assemblies = new List&lt;Assembly&gt;();\n    assemblies.Add(Assembly.GetExecutingAssembly());\n    foreach (var file in files)\n    {\n        assemblies.Add(Assembly.LoadFrom(file));\n    }\n    return assemblies;\n}\n</code></pre>\n"},{"tags":[".net","wcf","monotouch","slsvcutil"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13214286,"title":"Monotouch: WCF Client Example Needed","body":"<p>I am trying to create a WCF client to connect to my server using MonoTouch. Since Monotouch doesn't support dynamic code generation I tired using slscvutil.exe to generate the client code. The output I get from that does not compile. It tries to use <code>ChannelBase</code> as a generic class <code>ChannelBase&lt;T&gt;</code>, but it is not generic. Additionally all examples I can find use <code>ChannelBase</code> as a generic class. Does anyone have a sample of a MonoTouch WCF client in .net 4.0? Thanks!</p>\n"},{"tags":["c#",".net","database","dll"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13133804,"title":"writing driver class generic for any database support","body":"<p>for the past few days i was working with various database such as MySQL,oracle,Ibmdb2 etc... which connect with dot net through  odbc providers..</p>\n\n<p>for example:</p>\n\n<pre><code>1)MySQL:\n\nDriver={MySQL ODBC 5.1 Driver};server=**********;uid=**;database=**;port=***;pwd=***;\"\n\n2)oracle:\n\nDriver={Microsoft ODBC for Oracle};server=**********;uid=**;database=**;port=***;pwd=***;\"\n\n3)Db2:\n\nDriver={IBM DB2 ODBC DRIVER};server=**********;uid=**;database=**;port=***;pwd=***;\"\n</code></pre>\n\n<p>now my question? is </p>\n\n<p>is it possible to write generic class for any database provider </p>\n\n<p>as </p>\n\n<pre><code>Driver={My own driver};server=**********;uid=**;database=**;port=***;pwd=***;\"\n</code></pre>\n\n<p>which connects every databases just by changing driver name in web.config and placing that dll file in bin folder of my published web application or website project.    </p>\n"},{"tags":[".net","powershell","console-application"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13218231,"title":"How can I call a console app requiring a parameter that needs double-quotes from PowerShell script?","body":"<p>How can I construct this call below:</p>\n\n<blockquote>\n  <p>C:> ExecuteFoo \"2012-10-21 00:00:00\" \"2012-10-21 00:00:00\"</p>\n</blockquote>\n\n<p>from the PowerShell Script below:</p>\n\n<pre><code>param(\n   [string] $ReportStart = (get-date -format \"yyyy-MM-dd 00:00;00\"),\n   [string] $ReportEnd = (get-date -format \"yyyy-MM-dd 23:59:59\")\n)\n# ............ Some stuff here\n$Process = [diagnostics.process]::Start(\"$cmdline\", \"$ReportStart, $ReportEnd\") \n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13219164,"title":"changing a typed dataset field type","body":"<p>I have a project, within which I have two classes, one is an enumeration, that descends from Byte.This class is called Status. The other class , is a TypedDataSet. It is in the same namespace of the enumeration class. I try to change the type of one field of this typed dataset, that by now is Byte, to Status. But I get the following error from VIsual Studio( 2008):\" Field type changing Column requires a valid DataType\". I have done this operation in other project, so I don't understand this error, besides Status enumeration members are byte too.. this is the code:\n@Hogan. Here is the enumeration Status:</p>\n\n<pre><code>namespace LinQToDataset\n{\n    public enum Status : byte\n    {\n       Created,\n       Accepted,\n       Fixed,\n       Reopened,\n       Closed,\n    }\n}\n</code></pre>\n\n<p>And here is the field of the typed dataset whose type I want to change to Status(instead of byte). The field is called Status as well: </p>\n\n<pre><code>[global::System.Diagnostics.DebuggerNonUserCodeAttribute()]\npublic byte Status {\n    get {\n       return ((byte)[this.tableDefect.StatusColumn]));\n    }\n    set {\n       this[this.tableDefect.StatusColumn] = value;\n    }\n}\n</code></pre>\n\n<p>an anyone help me please?</p>\n"},{"tags":[".net","sockets","tcp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13220434,"title":"TCP override timeouts?","body":"<p>Short Version: I wrote .ReadTimeout = 10mins but the timeouts seem to be 30sec-1min. Can i override system/user timeouts or something?</p>\n\n<p>I gave a client an app which connects to our servers. It appears that if the connection is idle for 30sec or a minute their tcp connection timeout. The client app is written .NET</p>\n\n<p>Is there a way to override the timeouts? I haven't seen the problem on any of our computers. I don't want to ask the client to change their settings if i dont have to. How might i override timeouts?</p>\n\n<p>I wrote NetworkStream (from TcpClient) .ReadTimeout = 10mins but obviously it is waiting much less so i guess its system timeouts? I cant override those can I?</p>\n"},{"tags":["c#","asp.net",".net","vb.net","events"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13217704,"title":"What are scenarios that trigger Application_End event?","body":"<p>Asp.net has an <code>Application_End</code> event which occurs when the application comes to end, like this<br/></p>\n\n<pre><code>void Application_End(object sender, EventArgs e)\n{\n}\n</code></pre>\n\n<p>My question is the following: when does this event occurs in real, i.e. what kind of situations trigger it?<br/></p>\n\n<p>Suppose I have a banking web application running <code>24x7x365</code>, which executes continuously &amp; accesses from thousands of places at a time, then when would this <code>Application_End</code> event occur? What kinds of situations are responsible for this?</p>\n"},{"tags":["c#",".net","nas","cifs"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":182,"score":4,"question_id":11871737,"title":"Safely copy files on NAS Filer","body":"<p>we have a NetApp NAS filer which from time to time seems to fail, not sure if this depends on network issues, heavy load or the Filer itself; the thing is that the usual <code>System.IO.File.Copy(...)</code> command fails sometimes unexpectedly while it worked a minute before and works again a minute after... filer is working with the CIFS file system.</p>\n\n<p>in my Log4Net logfiles I see the exception:</p>\n\n<blockquote>\n  <p>System.IO.IOException: The specified network name is no longer\n  available.    at System.IO.__Error.WinIOError(Int32 errorCode, String\n  maybeFullPath) ...</p>\n</blockquote>\n\n<p>network team is unsure what happens and why, I am now thinking if I can implement a simple try/retry system to copy the file and retry the copy in case of failure, it could possibly be that System.IO.File.Copy was not designed for CIFS storages but for normal NTFS drives or stable network storage.</p>\n\n<p>Are there common patterns or .NET classes suitable to do this <em>copy and retry</em> or should I simply use an approach like in the following pseudo-code?</p>\n\n<pre><code>while(!copied &amp;&amp; count &lt;5)\n{\n  count++;\n\n  try\n  {\n    //here copy the file\n    ...\n\n    //if no exception copy was ok\n    copied = true;\n  }\n  catch\n  {\n    if(count &gt;= 5)\n    {\n      // Log that retry limit has been reached...\n    }\n    else\n    {\n      // make thread to wait for some time,\n      // waiting time can be in function of count or fixed...\n    }\n  }\n} \n</code></pre>\n"},{"tags":[".net","tpl-dataflow"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13202328,"title":"How can I get an IPropagatorBlock<TInput, TOutput> that feeds itself to stop?","body":"<p>Let's assume that I start with a <a href=\"http://msdn.microsoft.com/en-us/library/hh194782.aspx\" rel=\"nofollow\"><code>TransformBlock&lt;Uri, string&gt;</code></a> (which in itself is an implementation of <a href=\"http://msdn.microsoft.com/en-us/library/hh194827.aspx\" rel=\"nofollow\"><code>IPropagatorBlock&lt;Uri, string&gt;</code></a>) that takes the <code>Uri</code> and then gets the content in a <code>string</code> (this is a web crawler):</p>\n\n<pre><code>var downloader = new TransformBlock&lt;Uri, string&gt;(async uri =&gt; {\n    // Download and return string asynchronously...\n});\n</code></pre>\n\n<p>Once I have the content in a string, I parse it for links.  Since a page can have multiple links, I use a <a href=\"http://msdn.microsoft.com/en-us/library/hh194784.aspx\" rel=\"nofollow\"><code>TransformManyBlock&lt;string, Uri&gt;</code></a> to map the singular result (the content) to many links:</p>\n\n<pre><code>// The discovered item block.\nvar parser = new TransformManyBlock&lt;string, Uri&gt;(s =&gt; {\n    // Parse the content here, return an IEnumerable&lt;Uri&gt;.\n});\n</code></pre>\n\n<p>The key to the parser is that it can pass back an empty sequence, indicating that there are no more items that it should parse.</p>\n\n<p>However, that's only for a branch of the tree (or section of the web).</p>\n\n<p>I then link the downloader to the parser, and then back to the downloader, like so:</p>\n\n<pre><code>downloader.LinkTo(parser);\nparser.LinkTo(downloader);\n</code></pre>\n\n<p>Now, I know I can get everything to stop <em>outside</em> of the blocks (by calling <a href=\"http://msdn.microsoft.com/en-us/library/system.threading.tasks.dataflow.idataflowblock.complete.aspx\" rel=\"nofollow\"><code>Complete</code></a> on one of them) but how can I signal that it's complete from <em>inside</em> the blocks?</p>\n\n<p>Or do I have to somehow manage this state myself?</p>\n\n<p>Right now, it just hangs, because the downloader block is starved after all the content has been downloaded and parsed.</p>\n\n<p>Here's a fully contained test method which hangs on the call to <code>Wait</code>:</p>\n\n<pre><code>[TestMethod]\npublic void TestSpider()\n{\n    // The list of numbers.\n    var numbers = new[] { 1, 2 };\n\n    // Transforms from an int to a string.\n    var downloader = new TransformBlock&lt;Tuple&lt;int, string&gt;, string&gt;(\n        t =&gt; t.Item2 + t.Item1.ToString(CultureInfo.InvariantCulture),\n\n        // Let's assume four downloads to a domain at a time.\n        new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 4 }\n    );\n\n    // Gets the next set of strings.\n    var parser = new TransformManyBlock&lt;string, Tuple&lt;int, string&gt;&gt;(s =&gt; {\n        // If the string length is greater than three, return an\n        // empty sequence.\n        // This is the signal for this branch to stop.\n        if (s.Length &gt; 3) return Enumerable.Empty&lt;Tuple&lt;int, string&gt;&gt;();\n\n        // Branch out.\n        return numbers.Select(n =&gt; new Tuple&lt;int, string&gt;(n, s));\n    }, \n    // These are simple transformations/parsing, no need to not parallelize.\n    // The dataflow blocks will handle the task allocation.\n    new ExecutionDataflowBlockOptions {\n        MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded\n    });\n\n    // For broadcasting to an action.\n    var parserBroadcaster = new BroadcastBlock&lt;Tuple&lt;int, string&gt;&gt;(\n        // Clone.\n        t =&gt; new Tuple&lt;int, string&gt;(t.Item1, t.Item2));\n\n    // Indicate what was parsed.\n    var parserConsumer = new ActionBlock&lt;Tuple&lt;int, string&gt;&gt;(\n        t =&gt; Debug.WriteLine(\n            string.Format(CultureInfo.InvariantCulture, \n                \"Consumed - Item1: {0}, Item2: \\\"{1}\\\"\",\n            t.Item1, t.Item2)));\n\n    // Link downloader to parser.\n    downloader.LinkTo(parser);\n\n    // Parser to broadcaster.\n    parser.LinkTo(parserBroadcaster);\n\n    // Broadcaster to consumer.\n    parserBroadcaster.LinkTo(parserConsumer);\n\n    // Broadcaster back to the downloader.\n    parserBroadcaster.LinkTo(downloader);\n\n    // Start the downloader.\n    downloader.Post(new Tuple&lt;int, string&gt;(1, \"\"));\n\n    // Wait on the consumer to finish.\n    parserConsumer.Completion.Wait();\n}\n</code></pre>\n\n<p>The output of which (as expected, before it hangs) is:</p>\n\n<pre><code>Consumed - Item1: 1, Item2: \"1\"\nConsumed - Item1: 2, Item2: \"1\"\nConsumed - Item1: 1, Item2: \"11\"\nConsumed - Item1: 2, Item2: \"11\"\nConsumed - Item1: 1, Item2: \"12\"\nConsumed - Item1: 2, Item2: \"12\"\nConsumed - Item1: 1, Item2: \"111\"\nConsumed - Item1: 2, Item2: \"111\"\nConsumed - Item1: 1, Item2: \"112\"\nConsumed - Item1: 2, Item2: \"112\"\nConsumed - Item1: 1, Item2: \"121\"\nConsumed - Item1: 2, Item2: \"121\"\nConsumed - Item1: 1, Item2: \"122\"\nConsumed - Item1: 2, Item2: \"122\"\n</code></pre>\n"},{"tags":["c#",".net","generics"],"answer_count":9,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":625,"score":8,"question_id":3215402,"title":"Collection of generic types","body":"<p>If I have a generic class:</p>\n\n<pre><code>public class MyClass&lt;T&gt; \n{\n  public T Value;\n}\n</code></pre>\n\n<p>I want to instantiate several items such as...</p>\n\n<pre><code>new MyClass&lt;string&gt;\nnew MyClass&lt;int&gt;\n</code></pre>\n\n<p>...and add them to a collection. How do I define the collection so that it can hold a list of generic types? I then want to iterate through the collection at some point, and use the Value property.  Possible? </p>\n"},{"tags":[".net","windows-8","assemblies","winrt",".net-4.5"],"answer_count":1,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":213,"score":12,"question_id":12789191,"title":"Why do WinRT framework assemblies have the same fully qualified name as their (different) non-WinRT counterparts?","body":"<p>This is really just more of a curiosity type question. I deal with looking up types across assemblies and raw IL. Windows 8 really puts a kink in something I'm implementing though. I've found that WinRT and non-WinRT framework assemblies share the same fully qualified name.</p>\n\n<p>So, it's impossible to objectively tell if an assembly is relying on WinRT or non-WinRT versions of the framework assemblies(and yes, it's possible to use both). These assemblies are vastly different however in layout and in types implemented. </p>\n\n<p>Why did they not change the public key token or version number in building the WinRT assemblies? </p>\n"},{"tags":[".net","json","email","serialization","format"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13204739,"title":"JSON Serialized Email Format","body":"<p>I am going to store emails in a document store that works with JSON.  Initially the emails I deal with are in MS System.Net.Mail.MailMessage format however in the future I might be grabbing emails from various different email servers and perhaps not even using .NET to put them into the store.  </p>\n\n<p>I want a comprehensive format that I can use and stick to that will record every piece of information I can get from an email.  Also, MailMessage does not jsonSerialize easily so I will have some sort of DTO anyway.  </p>\n\n<p>My question is, has anyone here had to store emails in a general format and if so what did they find most effective?  Are there any particular classes that they have come across that will store as much info as possible in an easy to serialize way?  And has anyone made some mistakes in the format they chose that I can avoid?</p>\n"},{"tags":[".net","powershell","shared-folders"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13219155,"title":"What is the simplest way to copy a file from local to a shared folder by a PowerShell script?","body":"<p>(I am asking this question as a developer without having not very deep system admin knowledge.)</p>\n\n<p>I need to copy one file that I generate -which is a csv- to a Shared Folder in the network.</p>\n\n<p><strong>What is the simplest, safest and warrantied way to achieve this within my PS Script</strong>?</p>\n\n<p>(Is it the same way to copy a file from one directory to another one -or there are things to be aware of in order to accomplish this without any problems?)</p>\n"},{"tags":["c#",".net","windows-8","winrt","async-await"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13214757,"title":"How to find the reason for intermittent failing unit test containing await/async code?","body":"<p>I'm using <a href=\"http://xunit.codeplex.com/\" rel=\"nofollow\">xUnit</a> for my unit tests in a Windows Store application built with WinRT C#. The code under test has calls to awaited async methods and the problem is that some of the sometime fail and sometime succeed. My guess is that some continuations of awaited code are executed on a different synchronization context than the captured ones and then there is some <code>Task</code> somewhere in the call chain that isn't awaited. However I can't find any such place.\nHow can I find the reason for the bug?</p>\n"},{"tags":["c#",".net","wpf","canvas","geometry"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1037,"score":2,"question_id":3682111,"title":"WPF element positioning on a Canvas","body":"<p>I have a point on a canvas that I want to place an ellipse. I want the centre of the ellipse to be over this point. At the moment the top left most edge of the ellipse is over this point.</p>\n\n<p>I know I can shift the ellipse programmatically on the canvas but I was wondering if there is a way to tell WPF to centre the element over the point instead of sizing it from the top left???</p>\n"},{"tags":["asp.net",".net","google-analytics"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":151,"score":3,"question_id":13066597,"title":"Detect unique users with simultaneous visits","body":"<p>Imagine a simple html page with 3 iframes pointing to the same url:</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;iframe src=\"http://www.mydom.com/mypage.aspx\"&gt;&lt;/iframe&gt;\n    &lt;iframe src=\"http://www.mydom.com/mypage.aspx\"&gt;&lt;/iframe&gt;\n    &lt;iframe src=\"http://www.mydom.com/mypage.aspx\"&gt;&lt;/iframe&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>My goal is to track unique visitors in mypage.aspx code behind. Sounds simple but the following:</p>\n\n<pre><code>if (Request.Cookies[\"myc\"] == null)\n{\n    // New visitor!\n    Response.Cookies[\"myc\"].Value = myval;\n    Response.Cookies[\"myc\"].Expires = DateTime.Now.AddYears(10);\n}\nelse\n{\n    // Returning visitor\n}\n</code></pre>\n\n<p>has a problem. Visiting the html page with the 3 iframes I get three simultaneous hits to mypage.aspx and Request.Cookies[\"myc\"] is null all three times while I should understand that it is the same user (1st hit: new visitor, 2nd and 3rd hits: returning visitor for a total of one visitor/user). Any ideas how to fix this?</p>\n"},{"tags":["c#",".net","task-parallel-library"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":13046232,"title":"Create a Task with an Action<T>","body":"<p>I somehow feel I am missing something basic. Here's my problem.</p>\n\n<p>I am trying to create a System.Threading.Tasks.Task instance to execute an action that accepts a parameter of a certain type. I thought I could do something like</p>\n\n<pre><code>void DoWork(MyClass obj) {} //My action that accepts a parameter of type 'MyClass'\n\nMyClass obj = new MyClass(); \nAction&lt;MyClass&gt; action = DoWork; //action that points to the method\nTask task = new Task(action,obj); //task that would execute 'DoWork' with 'obj' as the parameter when I call Start.\n</code></pre>\n\n<p>Obviously this does not compile. It seems I can only use an <code>Action&lt;object&gt;</code> and not an <code>Action&lt;T&gt;</code> for a task and then cast the 'object' to T inside my method.</p>\n\n<p>How can I achieve what I want most effectively and efficiently?</p>\n"},{"tags":["javascript",".net","json"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":11417284,"title":".NET Dates and JSON","body":"<p>I want to use this <a href=\"https://gist.github.com/1868478\" rel=\"nofollow\">gist</a> to override JQuery's parseJSON to take into account .NET's dates.  </p>\n\n<p>The problem is that it does not replace a date in this format:</p>\n\n<pre><code>\"ReviewDate\":\"\\/Date(1404946800000+0100)\\/\"\n</code></pre>\n\n<p>This regular expression does not seem to be taking into account the timezone:</p>\n\n<pre><code>var replaceNet = /\"\\\\\\/Date\\((\\d+)(?:-\\d+)?\\)\\\\\\/\"/i;\n</code></pre>\n\n<p>Can anybody else suggest how I might fix this?</p>\n"},{"tags":["c#",".net","sql","entity-framework","entity-framework-4.1"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":13122940,"title":"String preparation when calling stored procedure in Entity Framework","body":"<p>Actually, I have code that uses Entity Framework 4.1 in Visual Studio 2010. Everything is working fine except for one thing : it doesn't seem to \"prepare\" the parameters like a good old <code>[parameters.Add]</code> habitually did.</p>\n\n<p>Here's my code : </p>\n\n<pre><code>using (MyEnterprisesEntities dataContext = new \n                             MyEnterprisesEntities(entityBuilder.ToString()))\n{\n         dataContext.CompanyInitializer(connection.Catalog,\n                                        args.CompanyId,\n                                        args.CompanyName);\n}\n</code></pre>\n\n<p>So, if my company's name is <code>O'Brian and sons</code> (actually it passed before through a WCF web service so it's more in this form: <code>O\\'Brian and sons</code>), it's seem to break my stored procedure (including the possibility of allowing SQL injection).</p>\n\n<p>Is there a way to avoid this situation with EDMX or the old way is more reliable ? </p>\n"},{"tags":[".net","mongodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":272,"score":0,"question_id":8878957,"title":"MongoDB query child collection's embedded object","body":"<p>I'm scratching my head for several hours and can't figure out how can I query the following document by price.amount</p>\n\n<pre><code>{\n  \"_id\" : ObjectId(\"4f148bb56858c43428f0666b\"),\n  \"Date\" : new Date(\"Sat, 13 Sep 2014 00:42:29 GMT +04:00\"),\n  \"Items\" : [{\n      \"ProductId\" : ObjectId(\"4f14873f6858c42ce82968e6\"),\n      \"Quantity\" : 5,\n      \"Price\" : {\n        \"Amount\" : \"4929\",\n        \"Currency\" : \"USD\"\n      }\n    },     }, {\n      \"ProductId\" : ObjectId(\"4f14873f6858c42ce829692b\"),\n      \"Quantity\" : 10,\n      \"Price\" : {\n        \"Amount\" : \"140\",\n        \"Currency\" : \"USD\"\n      }\n    }],\n  \"CustomerId\" : ObjectId(\"4f1487f16858c419c04ec2e2\")\n}\n</code></pre>\n\n<p>I want to select all objects which has min 1 Price item with amount > 10 for example.</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","json","multidimensional-array","json.net"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":235,"score":4,"question_id":13110222,"title":"Issue serializing JSON Multidimensional List","body":"<p>I am serializing a Multidimensional list using JSON.Net, and I am having problems making it serialize correctly.</p>\n\n<p>Here is the result I expected from this:</p>\n\n<pre><code>     \"children\": [ {\n        \"children\": [ {\n           \"children\": [ {\n              \"date_added\": \"12995911618983970\",\n              \"id\": \"8\",\n              \"name\": \"NestedNestedURL\",\n              \"type\": \"url\",\n              \"url\": \"http://url.com/\"\n           } ],\n           \"date_added\": \"12995911579845538\",\n           \"date_modified\": \"12995911618983970\",\n           \"id\": \"5\",\n           \"name\": \"NestedNestedFolder\",\n           \"type\": \"folder\"\n        }, {\n           \"date_added\": \"12995911609609970\",\n           \"id\": \"7\",\n           \"name\": \"NestedURL\",\n           \"type\": \"url\",\n           \"url\": \"http://url.com/\"\n        } ],\n        \"date_added\": \"12995911570603538\",\n        \"date_modified\": \"12995911609609970\",\n        \"id\": \"4\",\n        \"name\": \"NestedFolder\",\n        \"type\": \"folder\"\n     }, {\n        \"children\": [ {\n           \"date_added\": \"12995911631570970\",\n           \"id\": \"9\",\n           \"name\": \"NestedURL2\",\n           \"type\": \"url\",\n           \"url\": \"http://url.com/\"\n        } ],\n        \"date_added\": \"12995911589790970\",\n        \"date_modified\": \"12995911631570970\",\n        \"id\": \"6\",\n        \"name\": \"NestedFolder2\",\n        \"type\": \"folder\"\n     }\n</code></pre>\n\n<p>However, this is very different than the result I actually get. The issue here, I believe, is that multiple URL's can belong to a single folder, and multiple folders to one folder, but I am unsure of how to implement this. Here is the code I currently use:</p>\n\n<pre><code>public void Sync()\n{\n    Browser browser = new Chrome();\n    SortableBindingList&lt;Bookmark&gt; marks = browser.ReturnBookmarks();\n    SortableBindingList&lt;object&gt; newmarks = new SortableBindingList&lt;object&gt;();\n    int count = 0;\n   newmarks.Add(new json_top());\n    json_top top = newmarks[0] as json_top;\n\n    top.roots = new json_root();\n    List&lt;object&gt; roots = new List&lt;object&gt;();\n\n    Folder bookmarks_bar = new Folder();\n    Folder other = new Folder();\n    List&lt;Object&gt; barlist = new List&lt;Object&gt;();\n    List&lt;object&gt; otherlist = new List&lt;object&gt;();\n    List&lt;object&gt; children = new List&lt;object&gt;();\n    List&lt;string&gt; existingFolders = new List&lt;string&gt;();\n\n    bookmarks_bar.date_added = ToChromeTime(marks[0].added);\n    bookmarks_bar.name = \"Bookmarks bar\";\n    other.date_added = ToChromeTime(marks[0].added);\n    other.name = \"Other bookmarks\";\n\n    bool isBookmarkBar = true;\n\n    Folder folder = new Folder();\n    foreach (Bookmark mark in ordered)\n    {\n        List&lt;string&gt; fullpathlist = mark.fullPath.Split('\\\\').ToList();\n        int count1 = 0;\n        if (currentPath != mark.fullPath)\n        {\n            folder = (createFolder(fullpathlist, fullpathlist[0], mark));\n            folder.children.Add(setChild(fullpathlist, folder, mark, 1));\n            count++;\n        }\n        json_URL u = new json_URL();\n        u.date_added = ToChromeTime(mark.added);\n        u.id = id;\n        u.name = mark.title;\n        u.url = mark.url;\n        folder.children.Add(u);\n        if(isBookmarkBar)\n            barlist.Add(folder);\n        else\n        {\n            otherlist.Add(folder);\n        }\n    }\n    bookmarks_bar.children = barlist;\n    other.children = otherlist;\n    top.roots.bookmark_bar = (bookmarks_bar);\n    top.roots.other = other;\n    string json = JsonConvert.SerializeObject(newmarks, Formatting.Indented);\n    File.WriteAllText(@\"c:\\person.json\", json);\n}\n\n    Folder setChild(List&lt;string&gt; fullPathList, Folder parent, Bookmark mark, int count )\n    {\n        if (count &lt; fullPathList.Count)\n        {\n            Folder child = new Folder();\n            child.date_added = ToChromeTime(mark.added);\n            child.id = id;\n            child.name = fullPathList[count];\n            Folder LIST = setChild(fullPathList, child, mark, count + 1);\n            child.children= LIST;\n            return child;\n        }            \n    }\n\n    public class Folder\n    {\n        public List&lt;folderAndURL&gt; children { get; set; }\n        public long date_added { get; set; }\n        public long date_modified\n        {\n            get { return 0; }\n        }\n        public int id { get; set; }\n        public string name { get; set; }\n        public string type\n        {\n            get { return \"folder\"; }\n        }\n    }\n</code></pre>\n\n<p>And here is the output I get from that code:</p>\n\n<pre><code>    \"children\": [\n      {\n        \"children\": {\n          \"date_added\": 12995893609609970,\n          \"id\": 0,\n          \"name\": \"NestedURL\",\n          \"type\": \"url\",\n          \"url\": \"http://url.com/\"\n        },\n        \"date_added\": 12995893609609970,\n        \"date_modified\": 0,\n        \"id\": 0,\n        \"name\": \"NestedFolder\",\n        \"type\": \"folder\"\n      },\n      {\n        \"children\": {\n          \"date_added\": 12995893618983970,\n          \"id\": 1,\n          \"name\": \"NestedNestedURL\",\n          \"type\": \"url\",\n          \"url\": \"http://url.com/\"\n        },\n        \"date_added\": 12995893618983970,\n        \"date_modified\": 0,\n        \"id\": 1,\n        \"name\": \"NestedFolder\",\n        \"type\": \"folder\"\n      },\n      {\n        \"children\": {\n          \"date_added\": 12995893631570970,\n          \"id\": 2,\n          \"name\": \"NestedURL2\",\n          \"type\": \"url\",\n          \"url\": \"http://url.com/\"\n        },\n        \"date_added\": 12995893631570970,\n        \"date_modified\": 0,\n        \"id\": 2,\n        \"name\": \"NestedFolder2\",\n        \"type\": \"folder\"\n      }\n</code></pre>\n\n<p>So, how can I change my code to match the input and the output? Like I said, it seems to be something about multiple folders not being applied to one parent folder.</p>\n\n<p>Edit: I have uploaded a full version of the code <a href=\"http://pastebin.com/sn7YPYPC\" rel=\"nofollow\">here</a>, because I cut out some parts due to space.</p>\n"},{"tags":["c#",".net","rss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":511,"score":0,"question_id":5221791,"title":"SyndicationFeed & SyndicationItem LastUpdatedTime","body":"<p>I'm trying to use the SyndicationFeed class to get content from a feed, but for some feeds it works ok but for others it doesn't.<br/></p>\n\n<p>For example, when I want to get feeds from <a href=\"http://www.alistapart.com/site/rss\" rel=\"nofollow\">http://www.alistapart.com/site/rss</a> , the LastUpdatedTime has a value of 01-01-0001 for all feed items and the feed itself.<br/>\nIs there something that i need to do? or is it maybe that SyndicationFeed doesn't support all websites to read from them all the information?<br/></p>\n\n<p>some sample code that i'm using : </p>\n\n<pre><code>var feed = SyndicationFeed.Load(XmlReader.Create(\"http://www.alistapart.com/site/rss\"));\nvar feedPosts = feed.Items; // here all feedPosts have the invalid LastUpdatedTime, but if i go to the website i can see that there is actually one\n</code></pre>\n"},{"tags":[".net","web-services","xsd","wsdl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2529,"score":0,"question_id":3961112,"title":"How to make a dotnet webservice set minOccurs=\"1\" on a string value","body":"<p>I have an XSD:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\n     xmlns=\"http://a.com/a.xsd\"\n     targetNamespace=\"http://a.com/a.xsd\"\n     elementFormDefault=\"qualified\"\n     attributeFormDefault=\"unqualified\"&gt;\n    &lt;xs:element name=\"A\"&gt;\n        &lt;xs:complexType&gt;\n            &lt;xs:sequence&gt;\n                &lt;xs:element name=\"Item\"  minOccurs=\"1\" maxOccurs=\"1\"&gt;\n                    &lt;xs:simpleType&gt;\n                        &lt;xs:restriction base=\"xs:string\"&gt;\n                            &lt;xs:minLength value=\"1\"/&gt;                                       \n                            &lt;xs:whiteSpace value=\"collapse\"/&gt;\n                        &lt;/xs:restriction&gt;\n                    &lt;/xs:simpleType&gt;\n                &lt;/xs:element&gt;\n            &lt;/xs:sequence&gt;\n        &lt;/xs:complexType&gt;\n    &lt;/xs:element&gt;\n&lt;/xs:schema&gt;\n</code></pre>\n\n<p>Which I have converted into a C# class using XSD.exe v2.0.50727.3615 which generates code as follows</p>\n\n<pre><code>namespace A {\n    using System.Xml.Serialization;\n    /// &lt;remarks/&gt;\n    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"xsd\", \"2.0.50727.42\")]\n    [System.SerializableAttribute()]\n    [System.Diagnostics.DebuggerStepThroughAttribute()]\n    [System.ComponentModel.DesignerCategoryAttribute(\"code\")]\n    [System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true, Namespace=\"http://a.com/a.xsd\")]\n    [System.Xml.Serialization.XmlRootAttribute(Namespace=\"http://a.com/a.xsd\", IsNullable=false)]\n    public partial class A {\n        private string itemField;\n        /// &lt;remarks/&gt;\n        public string Item {\n            get {\n                return this.itemField;\n            }\n            set {\n                this.itemField = value;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I am returning an A.A object in my webservice, which produces this snippet in the service description</p>\n\n<pre><code>&lt;s:schema elementFormDefault=\"qualified\" targetNamespace=\"http://a.com/a.xsd\"&gt; \n  &lt;s:element name=\"Test2Result\"&gt; \n    &lt;s:complexType&gt; \n      &lt;s:sequence&gt; \n        &lt;s:element minOccurs=\"0\" maxOccurs=\"1\" name=\"Item\" type=\"s:string\" /&gt; \n      &lt;/s:sequence&gt; \n    &lt;/s:complexType&gt; \n  &lt;/s:element&gt; \n&lt;/s:schema&gt; \n</code></pre>\n\n<p>The change from minOccrus=\"1\" in the XSD to minOccurs=\"0\" on the auto-generated WSDL is causing grief to the machine on the other end of the system.</p>\n\n<p>I could of course provide a hand edited WSDL for them to use, but I would like the auto-generated one to suit their needs.</p>\n\n<p>Any suggestions on how to convince dotnet to output minOccurs=\"1\" for a string type in its autogenerated WSDLs without also adding nillable=\"true\"?</p>\n"},{"tags":["c#",".net","operators","tricks"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":13217032,"title":"?: Operator return void","body":"<p>I want to use the <code>?:</code> operator intstead of <code>if else</code></p>\n\n<p>e.g.</p>\n\n<pre><code>var directory = new DirectoryInfo(path);\nif (!directory.Exist())\n{\n    directory.Create();\n}\nelse \n{\n    // do nothing\n}\n</code></pre>\n\n<p>I tried to use <code>?:</code> like this: </p>\n\n<pre><code>var directory = new DirectoryInfo(path);\n!directory.Exist() ? directory.Create() : void;\n</code></pre>\n\n<p>but it says \"Invalid expression term <strong>'void'</strong>\", <strong>null</strong> also isn't working.</p>\n\n<p>Can anyone tell me a solution? Thanks.</p>\n"},{"tags":["asp.net",".net","google-provisioning-api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13125724,"title":"Is it possible to get the user suspension status based on an organization?","body":"<p>I have a need to look up the suspension status of all users within an organization. Unfortunately, OrganizationService.RetrieveAllOrganizationUsers() does not provide us with the suspension information.</p>\n\n<p>I can get a collection of AppsExtendedEntry based on the results of the above method, and iterate through it calling AppService.RetrieveUser(), but that is very slow and extremely inefficient.</p>\n"},{"tags":[".net","remoting"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13218249,"title":"Memory Leak due to Exception in End Invoke","body":"<p>I am using .Net Remoting for sending objects between two servers.\nThe objects are sent by \"Begin Invoke\" mechanism as required in such case I use EndInvoke, but the following exception consistently thrown during the End Invoke: \n</p>\n\n<pre><code>System.Net.WebExceptionSystem.Net.WebException: Unable to connect to the remote server ---&gt; System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond …\n   at System.Net.Sockets.Socket.EndConnect(IAsyncResult asyncResult)\n   at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket&amp; socket, IPAddress&amp; address, ConnectSocketState state, IAsyncResult asyncResult, Int32 timeout, Exception&amp; exception)\n   --- End of inner exception stack trace ---\n\nServer stack trace: \n   at System.Net.HttpWebRequest.EndGetRequestStream(IAsyncResult asyncResult, TransportContext&amp; context)\n   at System.Net.HttpWebRequest.EndGetRequestStream(IAsyncResult asyncResult)\n   at System.Runtime.Remoting.Channels.Http.HttpClientTransportSink.AsyncHttpClientRequestState.ProcessGetRequestStreamCompletion(IAsyncResult iar)\n\nException rethrown at [0]: \n   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)\n   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type)\n   at Core.Common.CLSAPI.EventArrivedHandler.EndInvoke(IAsyncResult result)\n</code></pre>\n\n<p>After some hours my application crashes due to \"Out Of Memory Exception\" and from the dump file I can see that all the objects that I tried to send still be referenced by one of the remoting objects therefore still not collected by the GC.\nWhat is the right way to handle exception in EndInvoke to avoid memory leak?</p>\n\n<p>I understand that this problem might be caused/fixed by some changes on the client side, nevertheless it is important for me to understand which changes can I do on the server side to assure robustness of my server.</p>\n"},{"tags":[".net",".net-2.0","iesi-collections"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":9612493,"title":"Iesi.Collections (nuget package) is not supported for .NET 2.0 ? Huh?","body":"<p>I've just tried adding Iesi.Collections to a .NET 2.0 project and it failed :-</p>\n\n<pre><code>PM&gt; Install-Package Iesi.Collections\nSuccessfully installed 'Iesi.Collections 3.2.0.4000'.\nSuccessfully uninstalled 'Iesi.Collections 3.2.0.4000'.\nInstall failed. Rolling back...\nInstall-Package : Could not install package 'Iesi.Collections 3.2.0.4000'. You are trying to install this package into a project that target\ns '.NETFramework,Version=v2.0', but the package does not contain any assembly references that are compatible with that framework. For more i\nnformation, contact the package author.\nAt line:1 char:16\n+ Install-Package &lt;&lt;&lt;&lt;  Iesi.Collections\n    + CategoryInfo          : NotSpecified: (:) [Install-Package], InvalidOperationException\n    + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand\n</code></pre>\n\n<p>Um, Huh???</p>\n\n<p>I thought the whole idea of Iesi.Collections was to get support for collections that existed in .NET 3.5+++ but not in .NET 2.0 .. so this package is -made- for a .NET 2.0 project? Waaa??</p>\n\n<p><img src=\"http://i.stack.imgur.com/YyMOc.jpg\" alt=\"enter image description here\"></p>\n\n<h2>Update</h2>\n\n<p>I have to target a .NET 2.0 project so I can't update to a 3.5 project. (and if i did that I wouldn't need to use this package...)</p>\n"},{"tags":[".net","nhibernate","iesi-collections"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":9870000,"title":"Iesi.Collections official page","body":"<p>Iesi.Collections.dll is shipped with nHibernate and has some good collections worth reusing. However I cannot find any official documentation page for them, and it might be dangerous to use unversioned undocumented library in the production, especially when a new nHibernate gets released breaking undocumented API.</p>\n\n<p>Where do I find the official page?</p>\n"},{"tags":[".net","wcf","msbuild","msdeploy","msbuild-task"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13217249,"title":"multiple build profiles utilizing csproj files in Visual Studio 2010","body":"<p>I am creating a WCF service that will be deployed to more than on place for a single build.</p>\n\n<ul>\n<li>I want to deploy to an IIS location with one web.config, and on another IIS for debug on local machine.</li>\n<li>Deploy on same machine on another IIS with another web.config for Live version on local</li>\n<li>Deploy on another machine using a set of credentials from the domain on that IIS, another web.config for other cases.</li>\n</ul>\n\n<p>Can you please point me to some existing working examples for these cases?</p>\n\n<p>p.s. I managed to manipulate the csproj files to customize my build. Because that is usually done with MSBUILD it would be great if you have examples with this dll it's very good.</p>\n"},{"tags":["c#",".net","cookies","html-agility-pack"],"answer_count":5,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":2903,"score":2,"question_id":3471893,"title":"Using BrowserSession and HtmlAgilityPack to login to Facebook through .NET","body":"<p>I'm trying to use Rohit Agarwal's <a href=\"http://refactoringaspnet.blogspot.com/2010/04/using-htmlagilitypack-to-get-and-post.html\" rel=\"nofollow\">BrowserSession</a> class together with HtmlAgilityPack to login to and subsequently navigate around Facebook.</p>\n\n<p>I've previously managed doing the same by writing my own HttpWebRequest's. However, it then only works when I manually fetch the cookie from my browser and insert a fresh cookie-string to the request each time I'm doing a new \"session\". Now I'm trying to use BrowserSession to get smarter navigation.</p>\n\n<p>Here's the current code:</p>\n\n<pre><code>BrowserSession b = new BrowserSession();\n\nb.Get(@\"http://www.facebook.com/login.php\");\nb.FormElements[\"email\"] = \"some@email.com\";\nb.FormElements[\"pass\"] = \"xxxxxxxx\";\nb.FormElements[\"lsd\"] = \"qDhIH\";\nb.FormElements[\"trynum\"] = \"1\";\nb.FormElements[\"persistent_inputcheckbox\"] = \"1\";\n\nvar response = b.Post(@\"https://login.facebook.com/login.php?login_attempt=1\");\n</code></pre>\n\n<p>The above works fine. Trouble comes when I try to use this BrowserSession again to fetch another page. I'm doing it this way since BrowserSession saves the cookies from the last response and inserts them into the next request, thus I should not have to manually inser cookiedata fetched from my browser anymore.</p>\n\n<p>However, when I try to do something like this:</p>\n\n<pre><code>var profilePage = b.Get(@\"https://m.facebook.com/profile.php?id=1111111111\");\n</code></pre>\n\n<p>the doc I get back is empty. I would appreciate any input on what I'm doing wrong.</p>\n"},{"tags":["c#",".net","datetimeoffset","tryparse"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":66,"score":3,"question_id":13217763,"title":"Why TryParseExact does not work in this example?","body":"<p>I cannot make this work -it always returns False.</p>\n\n<p>What do I miss here?</p>\n\n<pre><code>DateTimeOffset parsedDate;\n\nif ( DateTimeOffset.TryParseExact(\"2012-10-31 23:59:59\", \"YYYY-MM-dd HH:mm:ss\"\n                      , CultureInfo.InvariantCulture\n                      , DateTimeStyles.None, out parsedDate) == false)\n{\n   throw new ArgumentException(\"dateToPare\", dateToParse);\n}\n</code></pre>\n"},{"tags":["c#",".net","deployment","wix","windows-installer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13206410,"title":"Any editors to visually modify Wix templates?","body":"<p>I have tried wixedit and sharp develop and from what I can tell they do not allow you to visually modify the premade templates with a designer. They only allow you to create your own customized dialogs that you can design yourself. </p>\n\n<p>So I am wondering if there is any editors that you can visually modify the design of these templates, especially the mondo template with a point and click editor.</p>\n\n<p>I have also tried SharpSetup and it looks promising how you can design the interface in visual studio, although since I don't know much about editing wix I am having  a hard time comming up with the wix code to make it work.</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":31,"score":-2,"question_id":13181146,"title":"Debug.Fail does not work when platform is x64 or x86","body":"<p>How can I make the Debug.Fail and another methods of the Debug class and Trace class work appropriately when my application compiled for x64 or x86 and not for Any CPU?  </p>\n"},{"tags":["c#",".net","serialization","wsdl"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":773,"score":3,"question_id":2462361,"title":"Issue generating correct proxy objects from WSDL","body":"<p>I'm having an issue with the WSDL generator in .NET. It is missing out on complex types in one specific method.</p>\n\n<p><strong>Response from web service</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;SOAP-ENV:Envelope SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:tns=\"http://www.x.com/2.6.0\"&gt;\n&lt;SOAP-ENV:Body&gt;\n &lt;ns1:Export.GetData xmlns:ns1=\"http://www.x.com/\"&gt;\n  &lt;return xsi:type=\"tns:data_warehouse_report\"&gt;\n   &lt;start_row xsi:type=\"xsd:int\"&gt;1&lt;/start_row&gt;\n   &lt;end_row xsi:type=\"xsd:int\"&gt;2&lt;/end_row&gt;\n   &lt;finished xsi:type=\"xsd:boolean\"&gt;true&lt;/finished&gt;\n   &lt;rows xsi:type=\"SOAP-ENC:Array\" SOAP-ENC:arrayType=\"tns:data_warehouse_report_row[2]\"&gt;\n    &lt;item xsi:type=\"SOAP-ENC:Array\" SOAP-ENC:arrayType=\"xsd:string[3]\"&gt;\n     &lt;item xsi:type=\"xsd:string\"&gt;March 12, 2010&lt;/item&gt;\n     &lt;item xsi:type=\"xsd:string\"&gt;recipient3&lt;/item&gt;\n     &lt;item xsi:type=\"xsd:string\"&gt;sample product1&lt;/item&gt;\n    &lt;/item&gt;\n    &lt;item xsi:type=\"SOAP-ENC:Array\" SOAP-ENC:arrayType=\"xsd:string[0]\"&gt;&lt;/item&gt;\n   &lt;/rows&gt;\n  &lt;/return&gt;\n &lt;/ns1:Export.GetData&gt;\n&lt;/SOAP-ENV:Body&gt;\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n\n<p><strong>Notice the lines:</strong></p>\n\n<pre><code>&lt;rows xsi:type=\"SOAP-ENC:Array\" SOAP-ENC:arrayType=\"tns:data_warehouse_report_row[2]\"&gt;\n&lt;item xsi:type=\"SOAP-ENC:Array\" SOAP-ENC:arrayType=\"xsd:string[3]\"&gt;\n</code></pre>\n\n<p><strong>WSDL:</strong></p>\n\n<pre><code>&lt;xsd:complexType name=\"data_warehouse_report\"&gt;\n  &lt;xsd:all&gt;\n    &lt;xsd:element name=\"start_row\" type=\"xsd:int\"/&gt;\n    &lt;xsd:element name=\"end_row\" type=\"xsd:int\"/&gt;\n    &lt;xsd:element name=\"finished\" type=\"xsd:boolean\"/&gt;\n    &lt;xsd:element name=\"rows\" type=\"tns:data_warehouse_report_row_list\"/&gt;\n  &lt;/xsd:all&gt;\n&lt;/xsd:complexType&gt;\n</code></pre>\n\n<p>What is odd is that the type data_warehouse_report specifies the type rows as a \"data_warehouse_report_list\" which is not even used in the response.</p>\n\n<p>My big question is.. According to the web service response, how would you create the proxy object data_warehouse_report_row?</p>\n\n<p><strong>I've translated it to:</strong></p>\n\n<pre><code>[System.CodeDom.Compiler.GeneratedCodeAttribute(\"wsdl\", \"2.0.50727.3038\")]\n[System.SerializableAttribute()]\n[System.Diagnostics.DebuggerStepThroughAttribute()]\n[System.ComponentModel.DesignerCategoryAttribute(\"code\")]\n[System.Xml.Serialization.SoapTypeAttribute(Namespace = \"http://www.x.com/\")]\npublic partial class data_warehouse_report_row\n{\n    private string[] itemField;\n\n    public string[] item\n    {\n        get\n        {\n            return this.itemField;\n        }\n        set\n        {\n            this.itemField = value;\n        }\n    }\n}\n</code></pre>\n\n<p>But it still complaints about incorrect data type when deserializing..</p>\n\n<p><strong>Exception:</strong></p>\n\n<pre><code>InvalidCastException: \"Object cannot be stored in an array of this type.\"\n</code></pre>\n\n<p>I've tried using .NET reflector to debug the compiled assemblies (mainly System.Xml.Serialization), but the trace ends at the generated assembly created reader created by the serializer... So I haven't been able to figure out exactly what data it is trying to cast from.</p>\n\n<p>Any ideas?</p>\n"},{"tags":[".net","wcf","web-services","c#-4.0","wsdl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13216526,"title":"Expose different WSDL for different clients","body":"<p>I have developed a WCF application which is being consumed by three .NET web service clients. So far so good.</p>\n\n<p>But now I should change the WCF application in such a way that a different schema is published to different clients.</p>\n\n<p>For example:</p>\n\n<pre><code>class A : IMyServices\n{\n    public string GetName() {}\n\n    public Order GetOrderInfo(string orderId) {}\n\n    public Payment GetPaymentDetails(Order order) {}\n}\n</code></pre>\n\n<p>One of my clients should not see <code>GetPaymentDetails</code> (I should basically hide this GetPaymentDetails and Payment class schema from the WSDL that is being created by that one client). Other clients will have restrictions on other methods.</p>\n\n<p>In some scenarios some of the <code>Payment</code> class's properties should not be exposed to a client even it has access to the <code>GetPaymentDetails</code> operation.</p>\n\n<p>Is there any way to expose different schemas for different clients and that requires minimum changes at my end?</p>\n\n<p>One thing to keep in mind: my service is developed using WCF, and clients consuming my services use traditional .NET web service.</p>\n"},{"tags":["c#","asp.net",".net","vb.net","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13208939,"title":"cross page posting","body":"<p>i am just trying the example of cross page posting.\ni have added 1 textbox &amp; 1 button to default.aspx page</p>\n\n<pre><code>&lt;asp:TextBox ID=\"TextBox1\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n &lt;asp:Button ID=\"Button2\" runat=\"server\" Text=\"Button\"  PostBackUrl=\"~/About.aspx\"/&gt;\n</code></pre>\n\n<p>i have added following code to code-behind file of about.aspx page</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        if (Page.PreviousPage != null)\n        {\n            TextBox SourceTextBox =\n                (TextBox)Page.PreviousPage.FindControl(\"TextBox1\");\n            if (SourceTextBox != null)\n            {\n                Label1.Text = SourceTextBox.Text;\n            }\n            else\n                Label1.Text = \"no value\";\n        }\n        else\n            Label1.Text = \"no value from previous page\";\n    }\n</code></pre>\n\n<p>when i enters some text in textbox1 &amp; clicks button, it goes to about.aspx but label shows value \"no value\", its not showing textbox1's text value, why this is not working properly?</p>\n"},{"tags":["c#",".net","asp.net","sorting","gridview"],"answer_count":14,"favorite_count":7,"up_vote_count":28,"down_vote_count":0,"view_count":49030,"score":28,"question_id":250037,"title":"GridView sorting: SortDirection always Ascending","body":"<p>I have a gridview and I need to sort its elements when the user clicks on the header.<br>\nIts datasource is a List object.</p>\n\n<p>The aspx is defined this way :</p>\n\n<pre><code>&lt;asp:GridView ID=\"grdHeader\" AllowSorting=\"true\" AllowPaging=\"false\" \n    AutoGenerateColumns=\"false\" Width=\"780\" runat=\"server\"  OnSorting=\"grdHeader_OnSorting\" EnableViewState=\"true\"&gt;\n    &lt;Columns&gt;\n        &lt;asp:BoundField DataField=\"Entitycode\" HeaderText=\"Entity\" SortExpression=\"Entitycode\" /&gt;\n        &lt;asp:BoundField DataField=\"Statusname\" HeaderText=\"Status\" SortExpression=\"Statusname\" /&gt;\n        &lt;asp:BoundField DataField=\"Username\" HeaderText=\"User\" SortExpression=\"Username\" /&gt;\n    &lt;/Columns&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>The code behind is defined this way :<br>\nFirst load :</p>\n\n<pre><code>protected void btnSearch_Click(object sender, EventArgs e)\n{\n    List&lt;V_ReportPeriodStatusEntity&gt; items = GetPeriodStatusesForScreenSelection();\n    this.grdHeader.DataSource = items;\n    this.grdHeader.DataBind();\n}\n</code></pre>\n\n<p>when the user clicks on headers :</p>\n\n<pre><code>protected void grdHeader_OnSorting(object sender, GridViewSortEventArgs e)\n{\n    List&lt;V_ReportPeriodStatusEntity&gt; items = GetPeriodStatusesForScreenSelection();\n    items.Sort(new Helpers.GenericComparer&lt;V_ReportPeriodStatusEntity&gt;(e.SortExpression, e.SortDirection));\n    grdHeader.DataSource = items;\n    grdHeader.DataBind();\n}\n</code></pre>\n\n<p>My problem is that e.SortDirection is always set to Ascending.<br>\nI have webpage with a similar code and it works well, e.SortDirection alternates between Ascending and Descending.</p>\n\n<p>What did I do wrong ?</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13208140,"title":"Is installing .NET Framework needed?","body":"<p>I made a Windows Application in C#. Now, I have this question :</p>\n\n<p>Is installing .NET Framework required for installing the Windows Application in other computers? Because it's gonna take a bit long time to install .NET Framework.  </p>\n"},{"tags":["c#",".net","aspnet-regiis.exe"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13215941,"title":"Error in encrypting Application Settings","body":"<p>I have been using the Settings.settings file for storing application data. </p>\n\n<pre><code>&lt;applicationSettings&gt;\n    &lt;SLA_TestService.Properties.Settings&gt;\n      &lt;setting name=\"AuthenticationName\" serializeAs=\"String\"&gt;\n        &lt;value&gt;IBR&lt;/value&gt;\n      &lt;/setting&gt;\n      &lt;setting name=\"AuthenticationPassowrd\" serializeAs=\"String\"&gt;\n        &lt;value&gt;IBR&lt;/value&gt;\n      &lt;/setting&gt;\n    &lt;/SLA_TestService.Properties.Settings&gt;\n&lt;/applicationSettings&gt;\n</code></pre>\n\n<p>I encrypt the applicationSettings using </p>\n\n<pre><code>aspnet_regiis -pe \"applicationSettings/SLA_TestService.Properties.Settings\" -app     \"/SLAMobility\"\n</code></pre>\n\n<p>And I access the settings using;</p>\n\n<pre><code>string pword = Properties.Settings.Default.AuthenticationPassowrd\n</code></pre>\n\n<p>However it throws the following error; </p>\n\n<pre><code>ExceptionType=System.Configuration.ConfigurationErrorsException\nStackTrace=\n  at System.Configuration.BaseConfigurationRecord.EvaluateOne(String[] keys, SectionInput input, Boolean isTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentResult)\n  at System.Configuration.BaseConfigurationRecord.Evaluate(FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentResult, Boolean getLkg, Boolean getRuntimeObject, Object&amp; result, Object&amp; resultRuntimeObject)\n  at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object&amp; result, Object&amp; resultRuntimeObject)\n  at System.Configuration.BaseConfigurationRecord.GetSection(String configKey)\n  at System.Configuration.ConfigurationManager.GetSection(String sectionName)\n  at System.Configuration.ClientSettingsStore.ReadSettings(String sectionName, Boolean isUserScoped)\n  at System.Configuration.LocalFileSettingsProvider.GetPropertyValues(SettingsContext context, SettingsPropertyCollection properties)\n  at System.Configuration.SettingsBase.GetPropertiesFromProvider(SettingsProvider provider)\n  at System.Configuration.SettingsBase.GetPropertyValueByName(String propertyName)\n  at System.Configuration.SettingsBase.get_Item(String propertyName)\n  at System.Configuration.ApplicationSettingsBase.GetPropertyValue(String propertyName)\n  at System.Configuration.ApplicationSettingsBase.get_Item(String propertyName)\n  at SLA_TestService.Properties.Settings.get_AuthenticationName() in C:\\Users\\Mananu\\documents\\visual studio 2010\\Projects\\SLA_TestService\\SLA_TestService\\Properties\\Settings.Designer.cs:line 31\n  at SLA_TestService.Controllers.ValuesController.GetValues() in C:\\Users\\Mananu\\documents\\visual studio 2010\\Projects\\SLA_TestService\\SLA_TestService\\Controllers\\ValuesController.cs:line 15\n  at lambda_method(Closure , Object , Object[] )\n  at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.&lt;&gt;c__DisplayClass13.&lt;GetExecutor&gt;b__c(Object instance, Object[] methodParameters)\n  at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)\n  at System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)\n</code></pre>\n\n<p>What am I doing wrong? \nThanks in Advance!!</p>\n"},{"tags":["c#",".net","asp.net"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3435,"score":2,"question_id":4714634,"title":"Inline Editing GridView ASP.NET 4.0 C#","body":"<p>I have a grid view that I have populated in the code behind. I have enabled the AutoGenerateEditButton on this GridView but now cannot work out how to enable inline editing.</p>\n\n<p>I have looked for samples, and haven't found anything useful. Below is a copy of my ASPX page and then the code behind.</p>\n\n<p><strong>ProjectDetails.aspx</strong></p>\n\n<pre><code>&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeBehind=\"ProjectDetails.aspx.cs\" Inherits=\"ProjectActions.ProjectDetails\" %&gt;\n\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;form id=\"form1\" runat=\"server\"&gt;\n    &lt;div&gt;      \n         &lt;asp:GridView ID=\"ProjectDetailsGrid\" \n             runat=\"server\" \n             AutoGenerateColumns=\"False\" \n             AutoGenerateEditButton=\"True\" CellPadding=\"3\" \n             GridLines=\"Horizontal\" BackColor=\"White\" BorderColor=\"Black\" \n             BorderStyle=\"Solid\" BorderWidth=\"6px\"&gt;\n             &lt;AlternatingRowStyle BackColor=\"#F7F7F7\" /&gt;\n            &lt;Columns&gt;\n            &lt;asp:BoundField HeaderText =\"ID\" DataField=\"ActionID\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Summary\" DataField=\"ActionSummary\" /&gt;\n\n            &lt;asp:BoundField HeaderText =\"Description\" DataField=\"ActionDescription\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Start Date\" DataField=\"ActionStartDate\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Target Close Date\" DataField=\"ActionTargetCloseDate\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Actual Close Date\" DataField=\"ActionActualCloseDate\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Status\" DataField=\"ActionStatus\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Owner\" DataField=\"ActionOwner\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Last Modified\" DataField=\"ActionLastModified\" /&gt;\n            &lt;asp:BoundField HeaderText =\"Action Update\" DataField=\"ActionUpdate\" /&gt;\n            &lt;/Columns&gt;\n             &lt;FooterStyle BackColor=\"#B5C7DE\" ForeColor=\"#4A3C8C\" /&gt;\n             &lt;HeaderStyle BackColor=\"#4A3C8C\" Font-Bold=\"True\" ForeColor=\"#F7F7F7\" /&gt;\n             &lt;PagerStyle BackColor=\"#E7E7FF\" ForeColor=\"#4A3C8C\" HorizontalAlign=\"Right\" /&gt;\n             &lt;RowStyle BackColor=\"#E7E7FF\" ForeColor=\"#4A3C8C\" /&gt;\n             &lt;SelectedRowStyle BackColor=\"#738A9C\" Font-Bold=\"True\" ForeColor=\"#F7F7F7\" /&gt;\n             &lt;SortedAscendingCellStyle BackColor=\"#F4F4FD\" /&gt;\n             &lt;SortedAscendingHeaderStyle BackColor=\"#5A4C9D\" /&gt;\n             &lt;SortedDescendingCellStyle BackColor=\"#D8D8F0\" /&gt;\n             &lt;SortedDescendingHeaderStyle BackColor=\"#3E3277\" /&gt;\n         &lt;/asp:GridView&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n    &lt;asp:Label ID=\"ErrorMessage\" runat=\"server\" Text=\"\"&gt;&lt;/asp:Label&gt;\n    &lt;br /&gt;\n    &lt;br /&gt;\n     &lt;asp:Label ID=\"SQLStatement\" runat=\"server\" Text=\"\"&gt;&lt;/asp:Label&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>ProjectDetails.aspx.cs</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.HtmlControls;\nusing System.Data.SqlClient;\nusing System.Web.Configuration;\nusing System.Text;\nusing System.Data;\n\nnamespace ProjectActions\n{\n    public partial class ProjectDetails : System.Web.UI.Page\n    {\n        protected void Page_Load(object sender, EventArgs e)\n        {\n\n            if (!Page.IsPostBack)\n            {\n                BindProjectDetails();\n            }\n        }\n\n\n        public void BindProjectDetails()\n        {\n\n            string QueryStringID = Request.QueryString[\"id\"];\n\n            if (QueryStringID == \"\")\n            {\n                QueryStringID = \"0\";\n            }\n\n\n            string mySQLstring = \"Select \";\n            mySQLstring = mySQLstring + \"Actions.ActionID, \";\n            mySQLstring = mySQLstring + \"Actions.ActionSummary, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionDescription, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionStartDate, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionTargetCloseDate, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionActualCloseDate, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionStatus, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionOwner, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionLastModified, \";\n            mySQLstring = mySQLstring + \"ActionDetails.ActionUpdate \";\n            mySQLstring = mySQLstring + \"FROM ActionDetails \";\n            mySQLstring = mySQLstring + \"INNER JOIN Actions ON ActionDetails.ActionID = Actions.ActionID \";\n            mySQLstring = mySQLstring + \"INNER JOIN Projects ON ActionDetails.ProjectID = Projects.ProjectID \";\n            mySQLstring = mySQLstring + \"AND ActionDetails.ProjectID = \" + QueryStringID + \" \";\n            mySQLstring = mySQLstring + \"ORDER BY ActionID ASC\";\n\n            string champeryConnection = WebConfigurationManager.ConnectionStrings[\"TheDatebase\"].ConnectionString;\n\n            //Error Handling for SQL Connection\n            try\n            {\n                using (SqlConnection myConnection = new SqlConnection(champeryConnection))\n                {\n\n                    SqlCommand myCommand = new SqlCommand(mySQLstring, myConnection);\n                    // opens the connection to the database\n                    myConnection.Open();\n\n                    DataTable projectData = new DataTable(\"ActionDetails\");\n                    SqlDataAdapter DataAdapter = new SqlDataAdapter();\n\n                    DataAdapter.SelectCommand = myCommand;\n\n\n                    DataAdapter.Fill(projectData);\n\n\n                    ProjectDetailsGrid.DataSource = projectData;\n                    ProjectDetailsGrid.DataBind();\n\n                    if(ProjectDetailsGrid.Rows.Count == 0){\n                        Response.Redirect(\"\\\\ProjectActionsDetails/AddProjectActionsDetails.aspx?id=\" + Request.QueryString[\"id\"] + \"&amp;name=\" + Request.QueryString[\"name\"] + \"\");\n                    }\n\n                }\n\n            }\n            //Write errors to Label 'Error'\n            catch (Exception Err)\n            {\n                ErrorMessage.Text = Err.ToString();\n                SQLStatement.Text = mySQLstring;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Hope someone can help.</p>\n"},{"tags":[".net","vb.net","winforms","picturebox"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2495,"score":0,"question_id":9113954,"title":"How to save PictureBox Image to SQL in VB.NET ( Windows Form )","body":"<p>I need to save a form in it user browse image &amp; set it to a  PictureBox But on another button I need save that image to SQL Server .I have a stored procedure with Insert Command (with Image Datatype)</p>\n\n<p><strong>Browser Image from Desktop, PictureBox Code</strong> :-</p>\n\n<pre><code>   Public Sub SelectImage()\n\n        With OpenFileDialog1\n            '.InitialDirectory = \"C:\\\"\n            .Filter = \"All Files|*.*|Bitmaps|*.bmp|GIFs|*.gif|JPEGs|*.jpg\"\n            .FilterIndex = 4\n        End With\n\n        If OpenFileDialog1.ShowDialog() = DialogResult.OK Then\n            PictureBox1.Image = Image.FromFile(OpenFileDialog1.FileName)\n            PictureBox1.SizeMode = PictureBoxSizeMode.StretchImage\n            PictureBox1.BorderStyle = BorderStyle.Fixed3D\n\n        End If\n    End Sub\n</code></pre>\n\n<p><strong>Save Button Code</strong> </p>\n\n<pre><code>Public Sub Insert_Update_Personal()\n        Dim UploadImage As Bitmap = PictureBox1.Image\n\n        Dim ds As DataSet = New DataSet()\n        Dim cmd As SqlCommand = New SqlCommand(\"sp_Insert_Update_Personal\", con)\n        con.Open()\n        cmd.CommandType = CommandType.StoredProcedure\n\n        cmd.Parameters.AddWithValue(\"@childrenage\", TextBox10.Text)\n        cmd.Parameters.AddWithValue(\"@picture\", UploadImage)\n        cmd.Parameters.AddWithValue(\"@hrcomments\", TextBox5.Text)\n\n        cmd.ExecuteNonQuery()\n        con.Close()\n        cmd.Dispose()\n    End Sub\n</code></pre>\n\n<p><strong>But When I run the form it gives me error  \"No mapping exists from object type System.Drawing.Bitmap to a known managed provider native type.\"</strong></p>\n"},{"tags":[".net","asp.net","page-title"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1083,"score":4,"question_id":7167546,"title":"Setting Page title doesn't work","body":"<p>I've got a strange problem that setting the <code>Title</code> property of my ASP.NET page does not have any effect, in code level. It doesn't throw an exception either. My class is a derived class of <code>Page</code> class but I am not overriding anything about title.</p>\n\n<p>In the code I have this line:</p>\n\n<pre><code>Title = \"About\";\n</code></pre>\n\n<p>While debugging, I'm at that line, I put my cursor over Title as regular, and it displays <code>\"\"</code> an empty string, which is expected, I step down that line, expecting (obviously) <code>Title</code> to have the value <code>\"About\"</code> but when I hover, I still get an empty string. Property setting doesn't work. And yes, it is empty in output page too. Well, am I missing something there?</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13216602,"title":"Compare class's field with it's name","body":"<p>I whould like to have a Dictionary, where value is field of type myClass, and key is this field's name. I tried FieldInfo:</p>\n\n<pre><code>actions = new Dictionary&lt;string, myClass&gt; ();\nFieldInfo[] fields = triggerScript.GetType().GetFields(BindingFlags.Public | BindingFlags.Instance);\nint iterator = 0;\n\nfor (int i = 0; i &lt; fields.Length; i++) \n{\n    var field = fields[i];\n    if (field.FieldType == typeof(myClass))\n    {\n        actions.Add (fields[i].Name, fields[i].GetValueDirect());\n    }\n}\n</code></pre>\n\n<p>But FieldInfo doesn't contains reference to the field it discribes. How can I do this?</p>\n\n<hr>\n\n<h2>Example:</h2>\n\n<pre><code>public SimpleAction OnClick;\n</code></pre>\n\n<p>In Dictionary:</p>\n\n<blockquote>\n  <p>key - <code>OnClick</code>;</p>\n  \n  <p>value - <code>(SimpleAction)OnClick</code>;</p>\n</blockquote>\n\n<h2>UPDATE</h2>\n\n<p>I have an assigned object of tyte SimpleAction, and whant to store it's reference and name in dictionary.</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13216890,"title":"WPF event that triggers after the mouse stops moving","body":"<p>I am writing a WPF application.\nI want to trigger an event once the mouse stops moving.</p>\n\n<p>This is how I tried to do it. I created a timer which counts down to 5 seconds. This timer is \"reset\" every time the mouse moves.\nThis idea is that the moment the mouse stops moving, the timer stops being reset, and counts down from 5 to zero, and then calls the tick event handler, which displays a message box.</p>\n\n<p>Well, it doesn't work as expected, and it floods me with alert messages. What am I doing wrong?</p>\n\n<pre><code>DispatcherTimer timer;\n\nprivate void Window_MouseMove(object sender, MouseEventArgs e)\n{\n    timer = new DispatcherTimer();\n    timer.Interval = new TimeSpan(0, 0, 5);\n    timer.Tick += new EventHandler(timer_Tick);\n    timer.Start();\n}\n\nvoid timer_Tick(object sender, EventArgs e)\n{\n    MessageBox.Show(\"Mouse stopped moving\");\n}\n</code></pre>\n"},{"tags":["c#",".net","reflection"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":13212498,"title":"loop through an object and find the not null properties","body":"<p>I have 2 instances of the same objects, o1, and o2. If I am doing things like</p>\n\n<pre><code> if (o1.property1 != null) o1.property1 = o2.property1 \n</code></pre>\n\n<p>for all the properties in the object. What would be the most efficient way to loop through all properties in an Object and do that? I saw people using PropertyInfo to check nulll of the properties but it seems like they could only get through the PropertyInfo collection but not link the operation of the properties.</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","asp.net-mvc-3","unit-testing","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":72,"score":0,"question_id":13213507,"title":"Unit testing a controller in ASP.NET MVC 3","body":"<pre><code>public Double Invert(Double? id)\n{\n    return (Double)(id / id);\n}\n</code></pre>\n\n<p>I have done this for this test but fails please can anyone help with this cos just started with unit testing</p>\n\n<pre><code>/* HINT:  Remember that you are passing Invert an *integer* so\n * the value of 1 / input is calculated using integer arithmetic. \n * */\n//Arrange\nvar controller = new UrlParameterController();\nint input = 7;\nDouble expected = 0.143d;\nDouble marginOfError = 0.001d;\n\n//Act\nvar result = controller.Invert(input);\n\n//Assert\nAssert.AreEqual(expected, result, marginOfError);\n\n/* NOTE  This time we use a different Assert.AreEqual() method, which\n * checks whether or not two Double values are within a specified\n * distance of one another.  This is a good way to deal with rounding\n * errors from floating point arithmetic.  Without the marginOfError \n * parameter the assertion fails.\n * */  \n</code></pre>\n"},{"tags":["c#",".net",".net-4.0","task-parallel-library","blockingcollection"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":644,"score":4,"question_id":10208330,"title":"Why does iterating over GetConsumingEnumerable() not fully empty the underlying blocking collection","body":"<p>I have a quantifiable &amp; repeatable problem using the Task Parallel Library, <code>BlockingCollection&lt;T&gt;</code>, <code>ConcurrentQueue&lt;T&gt;</code> &amp; <code>GetConsumingEnumerable</code> while trying to create a simple pipeline.</p>\n\n<p>In a nutshell, adding entries to a default <code>BlockingCollection&lt;T&gt;</code> (which under the hood is relying on a <code>ConcurrentQueue&lt;T&gt;</code>) from one thread, does not guarantee that they will be popped off the <code>BlockingCollection&lt;T&gt;</code> from another thread calling the <code>GetConsumingEnumerable()</code> Method.</p>\n\n<p>I've created a very simple Winforms Application to reproduce/simulate this which just prints integers to the screen.</p>\n\n<ul>\n<li><code>Timer1</code> is responsible for queueing up the work items... It uses a concurrent dictionary called <code>_tracker</code> so that it knows what it has already added to the blocking collection.</li>\n<li><code>Timer2</code> is just logging the count state of both the <code>BlockingCollection</code> &amp; of the <code>_tracker</code></li>\n<li>The START button kicks off a <code>Paralell.ForEach</code> which simply iterates over the blocking collections <code>GetConsumingEnumerable()</code> and starts printing them to the second list box.</li>\n<li>The STOP button stops <code>Timer1</code> preventing more entries from being added to the blocking collection.</li>\n</ul>\n\n\n\n<pre><code>public partial class Form1 : Form\n{\n    private int Counter = 0;\n    private BlockingCollection&lt;int&gt; _entries;\n    private ConcurrentDictionary&lt;int, int&gt; _tracker;\n    private CancellationTokenSource _tokenSource;\n    private TaskFactory _factory;\n\n    public Form1()\n    {\n        _entries = new BlockingCollection&lt;int&gt;();\n        _tracker = new ConcurrentDictionary&lt;int, int&gt;();\n        _tokenSource = new CancellationTokenSource();\n        _factory = new TaskFactory(); \n        InitializeComponent();\n    }\n\n    private void timer1_Tick(object sender, EventArgs e)\n    { //ADDING TIMER -&gt; LISTBOX 1\n        for(var i = 0; i &lt; 3; i++,Counter++)\n        {\n            if (_tracker.TryAdd(Counter, Counter))\n            _entries.Add(Counter);\n            listBox1.Items.Add(string.Format(\"Adding {0}\", Counter));\n        }\n    }\n\n    private void timer2_Tick_1(object sender, EventArgs e)\n    { //LOGGING TIMER -&gt; LIST BOX 3\n        listBox3.Items.Add(string.Format(\"Tracker Count : {0} / Entries Count : {1}\", _tracker.Count, _entries.Count));\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    { //START BUTTON -&gt; LOGS TO LIST BOX 2\n\n        var options = new ParallelOptions {\n                                CancellationToken = _tokenSource.Token,\n                                MaxDegreeOfParallelism = 1\n                            };\n\n        _factory.StartNew(() =&gt; { Parallel.ForEach(_entries.GetConsumingEnumerable(), options, DoWork); });\n\n        timer1.Enabled = timer2.Enabled = true;\n        timer1.Start();\n        timer2.Start();\n    }\n\n    private void DoWork(int entry)\n    {\n        Thread.Sleep(1000); //Sleep for 1 second to simulate work being done.\n        Invoke((MethodInvoker)(() =&gt; listBox2.Items.Add(string.Format(\"Processed {0}\", entry))));\n        int oldEntry;\n        _tracker.TryRemove(entry, out oldEntry);\n    }\n\n    private void button2_Click(object sender, EventArgs e)\n    { //STOP BUTTON\n        timer1.Stop();\n        timer1.Enabled = false;\n    }\n</code></pre>\n\n<p>Here's the sequence of events:</p>\n\n<ul>\n<li>Press Start</li>\n<li>Timer1 ticks &amp; ListBox1 is immediately updated with 3 messages (Adding 0, 1, 2)</li>\n<li>ListBox2 is subsequent updated with 3 messages, 1 second apart\n<ul>\n<li>Processing 0</li>\n<li>Processing 1</li>\n<li>Processing 2</li>\n</ul></li>\n<li>Timer1 ticks &amp; ListBox1 is immediately updated with 3 messages (Adding 3, 4, 5)</li>\n<li>ListBox2 is sbsequent updated with 2 messages, 1 second apart\n<ul>\n<li>Processing 3</li>\n<li>Processing 4</li>\n<li><strong>Processing 5</strong> is not printed... would appear to have gone \"missing\"</li>\n</ul></li>\n<li>Press STOP to prevent more messages being added by timer 1</li>\n<li>Wait... \"Processing 5\" still does not appear</li>\n</ul>\n\n<p><img src=\"http://i.stack.imgur.com/vud45.png\" alt=\"Missing Entry\"></p>\n\n<p>You can see that the concurrent dictionary is still tracking that 1 item has not yet been processed &amp; subsequently removed from <code>_tracker</code></p>\n\n<p>If I Press Start again, then timer1 begins adding more 3 more entries and the Parallel loop comes back to life printing 5, 6, 7 &amp; 8. </p>\n\n<p><img src=\"http://i.stack.imgur.com/o4VVC.png\" alt=\"Entry returned after subsequent items shoved in behind it\"></p>\n\n<p>I'm at a complete loss as to why this occurs. Calling start again obviously calls a newtask, which calls a Paralell foreach, and re-executes GetConsumingEnumerable() which magically finds the missing entry... I</p>\n\n<p><strong>Why is the <code>BlockingCollection.GetConsumingEnumerable()</code> not guaranteeing to iterate over every item that's added to the collection.</strong></p>\n\n<p><strong>Why does the addition of more entries subsequently cause it to get \"unstuck\" and continue with it's processing?</strong></p>\n"},{"tags":["c#",".net","wpf","xaml","data-binding"],"answer_count":5,"favorite_count":5,"up_vote_count":10,"down_vote_count":1,"view_count":5956,"score":9,"question_id":6145888,"title":"How to bind an enum to a combobox control in WPF?","body":"<p>I am trying to find a simple example where the enums are shown as is. All examples I have seen tries to add nice looking display strings but I don't want that complexity.</p>\n\n<p>Basically I have a class that holds all the properties that I bind, by first setting the DataContext to this class, and then specifying the binding like this in the xaml file:</p>\n\n<pre><code>&lt;ComboBox ItemsSource=\"{Binding Path=EffectStyle}\"/&gt;\n</code></pre>\n\n<p>But this doesn't show the enum values in the <code>ComboBox</code> as items.</p>\n"},{"tags":[".net","ruby","cucumber","bdd","specflow"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":440,"score":3,"question_id":5671421,"title":"BDD testing framework","body":"<p>We are a Microsoft shop, have a reasonably mature technology stack and have very skilled .net resources.  We have been using TDD since we started and now are venturing into the BDD space. Our work is delivered by agile teams, using strong agile practices.</p>\n\n<p>Our end testable product is web, wpf and windows forms.</p>\n\n<p>The testing resources have introduced BDD and would like to learn and use Ruby and Cucumber to perform the testing.  There has been some resistance from the developers, as we would prefer to stick with the same technology stack and use Specflow (or similar).  The argument from the testers is that it is simpler to learn.</p>\n\n<p>I want to be sure that the developers and testers are not being biased, and that it is worthwhile introducing another technology.</p>\n"},{"tags":["c#",".net","winforms","optimization","invoke"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13215946,"title":"Simplify winforms code cross thread calls","body":"<p>I'm developing a cross-thread application which have some methods within <code>Invoke</code>:</p>\n\n<pre><code>if (this.InvokeRequired)\n{\n    this.Invoke((Action)(() =&gt;\n    {\n        pbTotalProgress.Value = progress;\n        labe1.Text=\"SomeText\";\n    }));\n}\nelse\n{\n    pbTotalProgress.Value = progress;\n    labe1.Text=\"SomeText\";\n}\n</code></pre>\n\n<p>How can I write the code below a bit shorter?</p>\n"},{"tags":[".net","winforms","xna","window","location"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1109,"score":1,"question_id":3552707,"title":"Xna - get window location?","body":"<p>I'm trying to rig an XNA WinForms system so I can have a game editor, and I need to use the mouse for it. Since the XNA Mouse input class reports mouse position based off of the window's location, I need to place the form I have in the same spot. How can i get the location of the window that my XNA game uses?</p>\n"},{"tags":[".net","dependency-injection","mvp"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13203385,"title":"How do I best implement dependency injection when many similar but distinct classes need many similar but distinct dependencies?","body":"<p>I'm developing a Windows application in Visual Studio .NET 4.0 where I'm using the MVP pattern and I'm trying to learn and apply dependency injection principles throughout the application.  But I'm having trouble understanding how to best handle a particular situation.  And I apologize in advance for the long explanation, but I don't know if I could be specific enough otherwise.</p>\n\n<p>The application is a general purpose record-keeping app for many different types of records, some of which are related to each other and some of which are unrelated to other records.  Each different record type we work with constitutes a distinct \"feature\" in the application.  So the startup screen for the application is essentially a switchboard from which they can select the feature they want to navigate to.  </p>\n\n<p>When they make a selection, the window (view) for that feature opens and it's from this window they can perform various operations relating to that feature.  Most of the features (e.g. Customers, Orders) have some common operations the user can perform (Creating new records, opening existing records, saving changes, printing, etc.).  Some however have operations that are specific to that one feature (e.g. a validation operation specific to the Orders feature).  My problem lies in figuring out how to perform the operations within each feature.</p>\n\n<p>Since I'm using MVP the feature window has a presenter that would respond when the user initiates any of the operations for that feature.  But since I want to follow the Single Responsibility principle I don't want the presenter to become a God class and actually know how to create records, save, print, etc.  So my thought was to define separate classes to handle each operation, as in having an ICreateOrders implementation with a .Create() method, an ISaveOrders implementation with a .Save() method, etc.  Just for the sake of having a name for them I'll call them \"resolvers\" since they actually resolve the request for that operation to happen.  Some of these common resolvers would probably have base implementations (e.g. a base FeatureSave class) because much of the code would be similar across features, but each feature needs to be able to have a specific implementation if required. This approach raises a couple of questions.</p>\n\n<p>First I want these actions to be able to be initiated from other places in the app besides just the window for that feature.  For example instead of only being able to open order records from within the Orders feature window, I'd also like to be able from the Customers feature to select \"View Orders\" and have that customer's order records opened and displayed automatically.  And to achieve code re-use I'd want to use the same IOpenOrders implementation to do the job regardless of where in the app the request was initiated from.  So simply embedding the needed resolvers in the Orders window's presenter doesn't seem like an option.</p>\n\n<p>So my thought was to create a FeatureService class that would hold a collection of Feature objects.  At app startup I'd get from the database a list of all the features that are valid for the logged-in user and I'd then iterate over that list and create a Feature object for each one and add it to the FeatureService's collection.  Then when I need to initiate an operation in one feature from another I could achieve that by just injecting the FeatureService object into the source class, getting the target feature from it, and then using that to perform the operation.  But I don't want the Feature class to be a God class either, so this would simply amount to moving all the individual resolvers from the Orders presenter to the Feature class.</p>\n\n<p>But for this to happen, the Feature object must be injected with all the resolvers it MIGHT need, without knowing if the user will perform those operations or not.  For some of the more complex features this could be 20 or 30 distinct resolvers being injected, which certainly seems like constructor injection abuse.  And while this keeps the Feature object from becoming a God class, as it's simply passing off each operation to its injected resolver, this seems wrong.  Is this correct usage when an object becomes a \"God-coordinator\" like this?</p>\n\n<p>My other question is about the volume of these objects.  For some customers there might be 50 or more separate features available (with more to follow over time no doubt).  So as I'm creating these Feature objects at startup and my container is injecting all these resolver dependencies into each one, I'm creating hundreds of objects (e.g. 40 features X 20 resolvers per feature) whether I ever access some of those features or not.  A typical user session will probably only involve going into a few features, so it seems wasteful to create so many objects at startup like this.  I could give up and just have the Feature object do ServiceLocation internally to get its resolvers, but if there's a better way, I'd like to use it.</p>\n\n<p>I can't figure out where to go from here.  I've tried to look and find examples and information on this, but I don't know if I even know enough to know what to search for.  Any guidance or insight anyone could provide would be greatly appreciated.</p>\n"},{"tags":[".net","wcf","c#-4.0","versioning"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13073339,"title":"WCF 4.5 Versioning","body":"<p>I have a WCF service with a data contract and etc...</p>\n\n<p>I need to make some changes in the contract, because some customers I had to change the business logic and add two data members in the data contract. The catch is, the Java client is breaking, even with <code>IsRequired = false</code>, only he don't accept this change, clients in PHP, Ruby and Python accepts the change.</p>\n\n<p>How can I solve this? There's some way to fix this on .NET side or another way to version the service?</p>\n"},{"tags":["c#",".net","c#-4.0","wmi"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":12846541,"title":"C# WMI remote process execution","body":"<p>I am trying to run a command which invokes a batch file on Win 2008 box. (The commands runs successfully when I log in to Win 2008 and click).</p>\n\n<p>But when I call this batch file via WMI using same user credentials the batch does not execute. </p>\n\n<p>My code to connect is:</p>\n\n<pre><code>ConnectionOptions connOptions = new ConnectionOptions();\nconnOptions.Impersonation = ImpersonationLevel.Impersonate;\nconnOptions.EnablePrivileges = true;\nconnOptions.Username = UserName;\nconnOptions.Password = Password;\n\nManagementScope manScope = new ManagementScope(\n    String.Format(@\"\\\\{0}\\ROOT\\CIMV2\", ComputerName), connOptions);\nmanScope.Connect();\n\nObjectGetOptions objectGetOptions = new ObjectGetOptions();\nManagementPath managementPath = new ManagementPath(\"Win32_Process\");\nManagementClass processClass = new ManagementClass(\n    manScope, managementPath, objectGetOptions);\n\nManagementBaseObject inParams = processClass.GetMethodParameters(\"Create\");\n\ninParams[\"CommandLine\"] = command;\nManagementBaseObject outParams = processClass.InvokeMethod(\"Create\", inParams, null);\nObject returnValue = outParams[\"ReturnValue\"];\n</code></pre>\n\n<p>Any help is appreciated...</p>\n"},{"tags":["c#",".net","webkit","screenshot"],"answer_count":3,"favorite_count":2,"up_vote_count":8,"down_vote_count":0,"view_count":266,"score":8,"question_id":13048213,"title":"How to capture a full website screenshot with C# and WebKit.NET?","body":"<p>I am using <a href=\"http://webkitdotnet.sourceforge.net/\">WebKit.NET</a> to integrate a browser component in my C# application. The problem is I can only capture the visible part in the browser window with a screenshot. Is there a way to capture the screenshot of the whole page? </p>\n"},{"tags":[".net","vb.net","winforms","charts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13215641,"title":"VB.Net Microsoft Chart - create multiple charts without displaying on form","body":"<p>I need to create a set of chart images to be imported into a PDF file. My program will display the first chart on a winform using MS Chart. I can save that using the SaveImage method.</p>\n\n<p>What I want to do is use the settings of the on-screen chart to generate and save images of related charts. I want to do this without displaying every chart as I create and save the image. I was hoping to be able to clone the displayed chart and then simply change the data source (I am using a datatable) and the legends/titles.</p>\n\n<p>Is there a way to do this?</p>\n\n<p>TIA,\nJohn</p>\n"},{"tags":["c#",".net","data-structures","collections"],"answer_count":5,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":474,"score":14,"question_id":13211277,"title":"Performance differences... so dramatic?","body":"<p>Just now I read <a href=\"http://stackoverflow.com/questions/169973/when-should-i-use-a-list-vs-a-linkedlist\">some posts about <code>List&lt;T&gt;</code> vs <code>LinkedList&lt;T&gt;</code></a>, so I decided to benchmark some structures myself. I benchmarked <code>Stack&lt;T&gt;</code>, <code>Queue&lt;T&gt;</code>, <code>List&lt;T&gt;</code> and <code>LinkedList&lt;T&gt;</code> by adding data and removing data to/from the front/end. Here's the benchmark result:</p>\n\n<pre><code>               Pushing to Stack...  Time used:      7067 ticks\n              Poping from Stack...  Time used:      2508 ticks\n\n               Enqueue to Queue...  Time used:      7509 ticks\n             Dequeue from Queue...  Time used:      2973 ticks\n\n    Insert to List at the front...  Time used:   5211897 ticks\nRemoveAt from List at the front...  Time used:   5198380 ticks\n\n         Add to List at the end...  Time used:      5691 ticks\n  RemoveAt from List at the end...  Time used:      3484 ticks\n\n         AddFirst to LinkedList...  Time used:     14057 ticks\n    RemoveFirst from LinkedList...  Time used:      5132 ticks\n\n          AddLast to LinkedList...  Time used:      9294 ticks\n     RemoveLast from LinkedList...  Time used:      4414 ticks\n</code></pre>\n\n<p>Code: <s><a href=\"http://pastebin.com/k3SWx9kF\" rel=\"nofollow\">http://pastebin.com/k3SWx9kF</a></s> <a href=\"http://pastebin.com/5Qe22dmK\" rel=\"nofollow\">http://pastebin.com/5Qe22dmK</a>\n(The code is too long so I put it there instead of here.)</p>\n\n<p>The differences are <strong>so</strong> dramatic!</p>\n\n<p>As you can see, the performance of <code>Stack&lt;T&gt;</code> and <code>Queue&lt;T&gt;</code> are fast and comparable, that's expected.</p>\n\n<p>For <code>List&lt;T&gt;</code>, using the front and the end has so much differences! And to my surprise, performance of adding/removing from the end is actually comparable to the performance of <code>Stack&lt;T&gt;</code>.</p>\n\n<p>For <code>LinkedList&lt;T&gt;</code>, manipulating with the front is fast (-er than <code>List&lt;T&gt;</code>)<s>, but for the end, it is incredibly slow for removing</s> manipulating with the end is too.</p>\n\n<hr>\n\n<p>So... can any experts account on:</p>\n\n<ol>\n<li>the similarity in performance of using <code>Stack&lt;T&gt;</code> and the end of <code>List&lt;T&gt;</code>,</li>\n<li>the differences in using the front and the end of <code>List&lt;T&gt;</code>, and<s></li>\n<li>the reason that using the end of <code>LinkedList&lt;T&gt;</code> is <em>so</em> slow</s> (not applicable as that is a coding error due to the use of Linq's <code>Last()</code>, <strong>thanks to CodesInChaos</strong>)?</li>\n</ol>\n\n<p>I think I know why <code>List&lt;T&gt;</code> doesn't handle the front so well... because <code>List&lt;T&gt;</code>needs to move the whole list back and fro when doing that. Correct me if I am wrong.</p>\n\n<p>P.S. My <code>System.Diagnostics.Stopwatch.Frequency</code> is <code>2435947</code>, and the program is targeted to .NET 4 Client Profile and compiled with C# 4.0, on Windows 7 Visual Studio 2010.</p>\n"},{"tags":[".net","nhibernate","fluent-nhibernate-mapping","mapping-by-code"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":548,"score":3,"question_id":679279,"title":"NHibernate - Force escaping on Table Names","body":"<p>Are there any good examples of how to use this (NHibernate.Criterion.IdentifierEqExpression) online? I couldn't find any.\nI'm a little confused about what you are supposed to pass into the constructor.</p>\n\n<p>I pass in an int32 of 1 and I keep thinking my test should basically do a \n\"where id = 1\" type of query and instead it blows up with \"where id = ?\" and something about positional parameters. If that's not what is supposed to be passed into the constructor ... what is?</p>\n\n<p><strong>Real Issue</strong><br />\nWhen I look at SQL output it seems to be working correctly except for the fact my table is named User and NHibernate isn't enclosing it like [User]. Any way to force this?</p>\n"},{"tags":["c#",".net","amazon-mws"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12972305,"title":"Amazon MWS Get Product Price .NET Library C#","body":"<p>I was wondering if anyone had a working example of the Amazon MWS .NET Library. The one Amazon only point to local XML files and doesn't really provide too much detail in their documentation. The following is what I am trying to retrieve from the MWS service.</p>\n\n<p>Lowest used price, lowest new price, sales rank, any sales ranks of other categories, title, image url, amazon buyback price, amount of third party sellers, weight of item.</p>\n\n<p>Any help would be nice at this point. I have been working on this for two days and haven't gotten any where.</p>\n"},{"tags":["c#",".net","audio","wav","pcm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":36,"score":-1,"question_id":13215236,"title":"Process pcm wav streams in .net","body":"<p>I need process wave (wav) files uncompressed (pcm). As input i receive a wav in a stream (System.IO.Stream). I need do a few things:</p>\n\n<ul>\n <li>Get a new sound (wav) from a snippet of a other sound (wav) (by snippet i mean fragment of time)</li>\n<li>Join few fragments of sound (short wav) in one.</li>\n<li>speed up or slow a wav.</li>\n</ul>\n\n<p>Anyone know a api, toolkit, library, dll, or anything capable to do that in .net (preference in C#)?</p>\n"},{"tags":["c#",".net","winforms","inotifypropertychanged"],"answer_count":10,"favorite_count":44,"up_vote_count":66,"down_vote_count":0,"view_count":10484,"score":66,"question_id":1315621,"title":"Implementing INotifyPropertyChanged - does a better way exist?","body":"<p>Microsoft should have implemented something snappy for INotifyPropertyChanged, like in the automatic properties, just specify {get;set;notify;}\nI think it makes a lot of sense to do it. Or are there any complications to do it? </p>\n\n<p>Can we ourselves implement something like 'notify' in our properties. Is there a graceful solution for implementing <strong>INotifyPropertyChanged</strong> in your class or the only way to do it is by raising the PropertyChanged event in each property.</p>\n\n<p>If not can we write something to autogenerate the peice of code to raise PropertyChanged  event?</p>\n"},{"tags":["javascript",".net","json","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13205381,"title":".net webservice json modification help object wihing obect","body":"<p>Hello guys i have been able to figure out how to simple send a class from a .net webservice.</p>\n\n<p>here is my class</p>\n\n<pre><code>Imports Microsoft.VisualBasic\n\nPublic Class TestClass\n\n    Public Class Person\n\n        Public Class Names\n            'Public Property Firsname As String\n            Public Property ID As Integer\n            Public Property LastName As String\n            Shared Property FirstName As String\n\n        End Class\n    End Class\nEnd Class\n</code></pre>\n\n<p>here is how im using it in my code,</p>\n\n<pre><code>&lt;WebMethod()&gt; _\n    Public Function PersonList(ID As Integer) As List(Of Person.Names)\n        'Dim p As New Person With {.ID = ID, .FirstName = \"Kenneth\"}\n        Try\n\n\n\n\n            Dim ListPerson As New List(Of Person.Names)\n\n\n\n            For startNumber = 1 To 4\n                Dim Per As New Person.Names\n\n                Per.ID = startNumber\n                ListPerson.Add(Per)\n            Next\n\n            Return ListPerson\n\n\n\n        Catch ex As Exception\n\n            Dim Per As New Person.Names\n\n            Per.ID = ex.Message\n\n            Dim ListPerson As New List(Of Person.Names)\n\n            ListPerson.Add(Per)\n\n\n\n        End Try\n\n    End Function\n</code></pre>\n\n<p>This works well when i return JSON but now i like to push a little further.\nI would like to have lists withing lists. Is this possible.</p>\n\n<p>look at this image.<img src=\"http://i.stack.imgur.com/cxvz2.png\" alt=\"enter image description here\"></p>\n\n<p>i would like to return an array below id not just a value for id.\nHow would i do that?</p>\n"},{"tags":[".net","file","exists","createobject"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13179427,"title":"Determining whether a dll is present or not","body":"<p>I want to use DotNet-dlls within VBA code. But I want to be able to determine whether a dll is present or not before I declare the object with CreateObject. </p>\n\n<p>Is it possible to use a dotnet dll without using Regasm?</p>\n\n<p>I have a MS Access database and I simply want to put the dll into the same directory as the mdb file.</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":[".net","mono.cecil"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13190427,"title":"Mono.Cecil get/resolve RVA of method after method insertion","body":"<p>How do i resolve the RVA of the method i have injected without reloading the entire module? <br> I am always getting 0 as the RVA of the added method. Is there anyway to retrieve the RVA without writing and reloading the assembly? Thanks!</p>\n\n<pre><code>AssemblyDefinition asm = AssemblyDefinition.ReadAssembly(\"hello.exe\"); \nModuleDefinition mod = asm.MainModule;\nTypeDefinition modType= mod.GetType(\"PrintClass\"); //get class found in hello.exe\nMethodDefinition MethodToInject= new MethodDefinition(\"PrintMethod\", ..., ...); //filled\nmodType.Methods.Add(MethodToInject);\n\nint InjectedRVA = MethodToInject.RVA; //Always get 0\nInjectedRVA = modType.Methods.FirstOrDefault(mtd =&gt; mtd.Name == \"PrintMethod\").RVA; //Also get 0\n\nasm.MainModule.Write(\"output.exe\"); //write output\n</code></pre>\n"},{"tags":[".net","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13214897,"title":"What is the lowest overhead way to limit executing one section of code to 4 threads","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2552192/limiting-the-number-of-threads-executing-a-method-at-a-single-time\">Limiting the number of threads executing a method at a single time</a>  </p>\n</blockquote>\n\n\n\n<p>In a single app we need to limit executing a section of code to 4 threads. This section is not the start/end of the thread, it is a section of code inside the thread.</p>\n\n<p>How to do this with one is easy - create an EventWaitHandle and wait/signal on it. But every way I've thought of to do 4 leaves the possibility of determining I need to wait, another thread exists the section and signals, and I then wait - forever.</p>\n\n<p>So what is the most light-weight way to do this when all threads are in a single app?</p>\n\n<p>Background: We are changing our licensing model to allow a maximum of N (4 in this example) threads calling our library consecutively. Because we're a library, not a server, we don't control the thread usage (like databases can). In the case of a web app, the calling app also doesn't control the number of threads and so we need to pause thread 5 calling us until one the first 4 exit that code.</p>\n"},{"tags":[".net","smo"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13206062,"title":"When attaching database with SMO, the database is readonly","body":"<p>I'm just trying to detach a database and reattach it using a different pair of mdf/ldf files using code like this:</p>\n\n<pre><code>Server server = GetMyServer();\nserver.AttachDatabase(myDatabaseName, new StringCollection { mdfFile, ldfFile }, AttachOptions.None);\n</code></pre>\n\n<p>When I check out the results of the above code in management studio, though, the database I've attached is read-only. Any ideas as to why and how to fix this? Thanks. </p>\n"},{"tags":["c#",".net","winforms"],"answer_count":13,"favorite_count":1,"up_vote_count":12,"down_vote_count":0,"view_count":15274,"score":12,"question_id":392098,"title":"How to make Combobox in winforms readonly","body":"<p>I do not want the user to be able to change the value displayed in the combobox. I have been using Enabled = false; but it is not very readable like when setting a Textbox.ReadOnly = true;</p>\n\n<p>Is there is a way of accomplishing this?</p>\n\n<p>Thanks,</p>\n\n<p>Kishore.</p>\n"},{"tags":["c#",".net","data-structures","hashset"],"answer_count":9,"favorite_count":5,"up_vote_count":25,"down_vote_count":0,"view_count":8803,"score":25,"question_id":1247442,"title":"When should I use the HashSet<T> type?","body":"<p>I am exploring the <code>HashSet&lt;T&gt;</code> type, but I don't understand where it stands in collections.</p>\n\n<p>Can one use it to replace a <code>List&lt;T&gt;</code>? I imagine the performance of a <code>HashSet&lt;T&gt;</code> to be better, but I couldn't see individual access to its elements.</p>\n\n<p>Is it only for enumeration?</p>\n"},{"tags":[".net","wpf","listview","listbox","wpf-controls"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1251,"score":3,"question_id":4704009,"title":"Gaps between items in my ListBox","body":"<p>When I create <code>ListBox</code> with horizontal items ordering for example like this:</p>\n\n<pre><code>&lt;DockPanel&gt;\n    &lt;ListBox&gt;\n        &lt;ListBox.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;VirtualizingStackPanel Orientation=\"Horizontal\" /&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListBox.ItemsPanel&gt;\n        &lt;ListBoxItem&gt;\n            &lt;Button Content=\"Hello\" /&gt;\n        &lt;/ListBoxItem&gt;\n        &lt;ListBoxItem&gt;\n            &lt;Button Content=\"Hello\" /&gt;\n        &lt;/ListBoxItem&gt;\n    &lt;/ListBox&gt;\n&lt;/DockPanel&gt;\n</code></pre>\n\n<p>I have small gaps between buttons in the list as indicated by the arrows on following picture:</p>\n\n<p><img src=\"http://i.stack.imgur.com/9vO81.jpg\" alt=\"Picture showing gaps\"></p>\n\n<p>How can I get rid of those gaps please ? I need to have items in <code>ListBox</code> just next to each other. I have tried changing <code>ItemTemplate</code> of the <code>ListBox</code> but it did not help.</p>\n"},{"tags":["c#",".net","interface","implicit","explicit"],"answer_count":10,"favorite_count":56,"up_vote_count":161,"down_vote_count":0,"view_count":31607,"score":161,"question_id":143405,"title":"C#: Interfaces - Implicit and Explicit implementation","body":"<p>What are the differences in implementing interfaces <strong>implicitly</strong> and <strong>explicitly</strong> in C#?</p>\n\n<p>When should you use implicit and when should you use explicit?</p>\n\n<p>Are there any pros and/or cons to one or the other?</p>\n"},{"tags":[".net","objective-c","ios","xcode","usercontrols"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":276,"score":2,"question_id":7699384,"title":".Net UserControl XCode equivalent","body":"<p>I'm used to create \"user controls\" in Visual Studio... and i was wondering if there is a way to do that in XCode...</p>\n\n<p>I've been looking around and some people was telling me to build a plugin... that sound rather too complicated to build a simple reusable \"text box -> button -> label\"... In VS i can just create -> User Control, program and drag/drop the control as if it was a simple button... and it really is as simple as that...</p>\n\n<p>Any ideas?</p>\n"},{"tags":["c#",".net","winforms","speech"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13213652,"title":"Add another voice into .NET Speech","body":"<p>How can I add another voice into .NET Speech? I'd like to use Czech voice. I've found some <code>*.sis</code> files <code>Eliska22k.sis</code> but I don't know how to use it.</p>\n\n<pre><code>SpeechSynthesizer synth = new SpeechSynthesizer();\nforeach (var voice in synth.GetInstalledVoices())\n    Console.WriteLine(voice.VoiceInfo.Name);\n</code></pre>\n\n<p>Gives me only <code>Microsoft Anna</code>.</p>\n"},{"tags":[".net","visual-studio-2010","project-management"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":5274,"score":4,"question_id":3941444,"title":"Count Code Lines Number in Visual Studio","body":"<p>One team will analyze our .NET project(solution) code, so, before, they asked about how many lines of code contains our project.</p>\n\n<p>Is there some statistical data, some code metrics in VS 2010?</p>\n"},{"tags":["c#",".net","multithreading","timer","instance"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13213406,"title":"Creating instance in multi threaded environment","body":"<p>I am using threaded timer which is creating new instance and call a method like below,            </p>\n\n<pre><code>Timer_tick()\n{\n   Car C;\n   C=new Car();\n   C.Start()      ///  this will take time to complete\n}\n</code></pre>\n\n<p>My question is, there is another thread coming with next timer tick and perform same operation.\nThen the second thread remove the reference from first Car instance &amp; it will call the start method on new Car instance, since first object does not finished his start method (still in progress) but it doesn't have the “C” variable reference anymore.\nWill this create any problem to first instance <code>Start()</code> method completeness or execution. \nCan it be collected by GC?</p>\n"},{"tags":[".net","winrt","c++-cx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13213309,"title":"Are the .Net Action<T> and Func<T> delegate generics available in C++/CX for Windows Store Apps","body":"<p>I want to use Action and Func delegate generics from .Net for a C++/CX Windows Store App. Are they part of WinRT, too?</p>\n\n<pre><code>delegate void f( int );\n\nref class Sample\n{\n   ...\n   event f^ Rendered; // this works\n   event Action&lt;int&gt;^ Rendered; // ??? I want something like this using existing lib without creating templates on my own (which Namespace/Header) ???\n   ...\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","data-binding"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":245,"score":1,"question_id":7905651,"title":"How to DataBind a TextBox to a particular index in a List<>","body":"<p>I have standard databindings setup for all my TextBoxes to an Object like this:</p>\n\n<pre><code>TextBoxMenuID.DataBindings.Add(\"Text\", _selectedObject, \"ID\");\n</code></pre>\n\n<p>And I want to bind some of my TextBoxes to a List&lt;> index within that Object like this:</p>\n\n<pre><code>TextBoxQ1.DataBindings.Add(\"Text\", _selectedObject._qList[0].QuestionString, null);\n</code></pre>\n\n<p>The binding isn't working this way. Any ideas how to go about this kind of binding?</p>\n\n<p>Thanks,\nSleffTheRed</p>\n"},{"tags":["c#",".net","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":20,"score":-1,"question_id":13213540,"title":"Regex : argument in javascript function","body":"<p>I'm not very good for regex and this is why I need your help.</p>\n\n<p>I have this style of javascript functions :</p>\n\n<pre><code>javascript:Ouvre('/ade/custom/modules/plannings/eventInfo.jsp',-1,-1,28890,-1,-1,-1,-1,-1,'','yes','no','no','yes','no','1','1','790','480')\n</code></pre>\n\n<p>or </p>\n\n<pre><code>javascript:Ouvre('/ade/custom/modules/plannings/eventInfo.jsp',-1,-1,28746,-1,-1,-1,-1,-1,'','yes','no','no','yes','no','1','1','790','480')\n</code></pre>\n\n<p>and I need to recover one argument (28890 or 28746 in these cases). How do I get the fourth argument using regex?</p>\n\n<p>I would like, if possible, give it a name and then use it easily in C #. Like this :</p>\n\n<pre><code>var reg = new Regex(\"REGEX\");\nvar match = reg.Match((string)value);\nif (match.Success)\n{\n    return match.Groups[\"FourthArgument\"].Value;\n}\n</code></pre>\n\n<p>Thank you</p>\n"},{"tags":["c#",".net","ide","editor"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":3006,"score":4,"question_id":3778063,"title":"Online c sharp/.net IDE (.net based)","body":"<p>Some time ago  I came across an online .NET(C#) IDE.</p>\n\n<p>I remember it was .NET based because the site required that i have .NET framework installed so i can run it, compiling and viewing the application took place inside the browser window, i could actually view my newly created application inside the browser window.</p>\n\n<p>Can't seem to find it anywhere anymore.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","oledb","text-files"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2555,"score":4,"question_id":4063685,"title":"Using OleDbConnection to Read Tab-Seperated File","body":"<p>My tab-delimited file is something like this:</p>\n\n<pre><code>ISO ISO3    ISO-Numeric\nAD  AND 20\n</code></pre>\n\n<p>I've been trying the following code with no luck.</p>\n\n<pre><code>OleDbConnection cn = new  OleDbConnection(@\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source= |DataDirectory|;Extended Properties='text;HDR=Yes;FMT=TabDelimited'\");\nOleDbCommand cmd = new OleDbCommand(@\"SELECT * FROM countryInfo.txt\", cn);\nOleDbDataAdapter da = new OleDbDataAdapter(cmd);\n\ncn.Open();\n\nDataTable dt = new DataTable();\nda.Fill(dt);\n</code></pre>\n\n<p>Here's a screenshot of the Dataset Visualizer. Its obviously not the output i'm after.\n<img src=\"http://i.stack.imgur.com/ZCSPP.jpg\" alt=\"alt text\"></p>\n\n<p>Any suggestions? Here's my Schema.ini file. Its in the same directory as the text file.</p>\n\n<pre><code>[countryInfo.txt]\nFormat=TabDelimited\nColNameHeader=True\nCharacterSet=ANSI\n</code></pre>\n\n<p>Should i just use something like <a href=\"http://www.filehelpers.com/\" rel=\"nofollow\">FileHelpers</a> instead?</p>\n\n<hr>\n\n<p>@Hans Passant Here's a screenshot.\n<img src=\"http://i.stack.imgur.com/5C3aK.jpg\" alt=\"alt text\"></p>\n"},{"tags":[".net","static-analysis","ndepend"],"answer_count":3,"favorite_count":7,"up_vote_count":16,"down_vote_count":0,"view_count":941,"score":16,"question_id":44637,"title":"How to start using ndepend?","body":"<p>I recently downloaded ndepend and ran an analysis on an open source project I participate in.</p>\n\n<p>I did not now where to look next - a bit of visual and information overload and it turned out I don't even know where to start.</p>\n\n<p>Can anyone suggest starting points?</p>\n\n<ul>\n<li>What information should I look for first?</li>\n<li>What points out problems in the code (in a BIG way)?</li>\n<li>What would the low hanging fruit that can immediately seen?</li>\n</ul>\n"},{"tags":[".net","visual-studio","winforms","datagridview","scrollbar"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":5853,"score":1,"question_id":472563,"title":"ScrollBar in DataGridView","body":"<p>I have a winform in vs2008 that contains a DataGridView. The datagrid contains a list with several columns. These are fixed width, exept one that I have set up to take whatever space is left and fill the width of the view. The winform is resizeable in all directions.</p>\n\n<p>The issue I am trying to solve is that when I increase the vertical size of the window the scrollbar disappears and the columns snap to the right to fill the extra space. What I would like to happen is that the vertical scrollBar never disappears. Setting ScrollBars to vertical in the properties of the DataGridView does not do this.</p>\n\n<p>Is this at all possible to achieve? And, if so, how do I get the vertical scrollbar to always be visible?</p>\n"},{"tags":["c#",".net","domain-driven-design"],"answer_count":1,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":574,"score":7,"question_id":5107062,"title":"If repositories are for aggregate roots, where should data access logic for other entities go?","body":"<p>I have a few objects that represent a web application.  Currently I have a cluster object to represent a specific deployment of the app.  Within a cluster object I have the following objects:  Server, Customer, User.  None of these objects can exist without being part of a cluster, so I created a ClusterRepository to retrieve the clusters from the database.  Now, from the cluster I need to get a list of Customers, presumably by using a method in the Cluster object like GetCustomers().  Now, my initial thought was to then offload the work of this operation to a CustomerRepository, but since repositories are only for aggregate roots, where should the data access logic go?  Does this belong in a service class?</p>\n"},{"tags":["c#",".net","machine-learning","neural-network","bayesian"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":35,"score":1,"question_id":13213204,"title":"Looking for open source Probabilistic Neural Network implementation in Visual C#","body":"<p>Has anybody seen an open source neural network library that implements Donald Specht's Probabilistic Neural Network (PNN) architecture? I've looked at several of the most popular open source neural network libraries out there but they are either lacking in C# support or they don't have the PNN in their family of neural network architectures:</p>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Probabilistic_neural_network\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Probabilistic_neural_network</a></p>\n\n<p>Preferably a library/module not using the GPL or LGPL license since I am building an open source package that will be BSD or Apache licensed.</p>\n"},{"tags":["c#",".net","entity-framework-4"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1087,"score":2,"question_id":10007351,"title":"Entity Framework Code First AddOrUpdate method insert Duplicate values","body":"<p>I have simple entity:</p>\n\n<pre><code>public class Hall\n{\n    [Key]\n    public int Id {get; set;}\n\n    public string Name [get; set;}\n}\n</code></pre>\n\n<p>Then in the <code>Seed</code> method I use <code>AddOrUpdate</code> to populate table:</p>\n\n<pre><code>var hall1 = new Hall { Name = \"French\" };\nvar hall2 = new Hall { Name = \"German\" };\nvar hall3 = new Hall { Name = \"Japanese\" };\n\ncontext.Halls.AddOrUpdate(\n    h =&gt; h.Name,\n    hall1,\n    hall2,\n    hall3\n);\n</code></pre>\n\n<p>Then I run in the Package Management Console:</p>\n\n<pre><code>Add-Migration Current\nUpdate-Database\n</code></pre>\n\n<p>It's all fine: I have three rows in the table \"Hall\". But if I run in the Package Management Console <code>Update-Database</code> again I have already five rows:</p>\n\n<pre><code>Id  Name\n1   French\n2   Japaneese\n3   German\n4   French\n5   Japanese\n</code></pre>\n\n<p>Why? I think it is should be three rows again, not five. I tried to use <code>Id</code> property instead of <code>Name</code> but it does not make the difference.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>This code produces the same result:</p>\n\n<pre><code>var hall1 = new Hall { Id = 1, Name = \"French\" };\nvar hall2 = new Hall { Id = 2, Name = \"German\" };\nvar hall3 = new Hall { Id = 3, Name = \"Japanese\" };\n\ncontext.Halls.AddOrUpdate(\n                h =&gt; h.Id,\n                hall1);\n\ncontext.Halls.AddOrUpdate(\n                h =&gt; h.Id,\n                hall2);\n\ncontext.Halls.AddOrUpdate(\n                h =&gt; h.Id,\n                hall3);\n</code></pre>\n\n<p>Also I have the latest EntityFramework installed via nuget.</p>\n"},{"tags":["c#",".net","asynchronous","command-pattern"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13212376,"title":"2 kind of command in Command Pattern","body":"<p>I'm developing application using Command Pattern. I have two kind of operations in my programm: \n 1. Long time operations (copy/delete files), which should be run asynchronously\n 2. Simple operations (refresh panels)</p>\n\n<p>My question is: Can I implement 2 kind of commands in this Pattern (AsyncCmd and SimpleCmd)? And before Executing in Command Manager check type of command:</p>\n\n<pre><code>public void Execute()\n   {\n     if(cmd is AsyncCmd)\n        {\n         RunAsyncOperation();\n        }\n     else if(cmd is SimpleCmd)\n        {\n         RunOperation();\n        }\n   }\n</code></pre>\n"},{"tags":[".net","vb.net","invalidoperationexception"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":13668,"score":0,"question_id":5701767,"title":"Windows Application has stopped working :: Problem Event Name CLR20r3","body":"<p>I developed an applicatin using Visual Studio.Net 2008  Team System with Infragistics Net Advantage Tools 2010.3 and made a Setup Exe file for my application and installed on client machines where they have\nboth Windows7 32 bit and WindowsXP Service Pack 2. ( I have also tried both way by Setup Property TargetPlatform x86 and x64)</p>\n\n<p>But when i install and run this application (exe) file in development machine its installed and run correctly.\nOnly on Client's machine its installed correctly but not running, giving the error when double clicking on the exe file.<img src=\"http://i.stack.imgur.com/IKXGD.png\" alt=\"enter image description here\"></p>\n\n<p>The Complete Error is following:</p>\n\n<p>Description:\n  Stopped working</p>\n\n<p>Problem signature:\n  Problem Event Name:   CLR20r3\n  Problem Signature 01: al-deihani.exe\n  Problem Signature 02: 1.0.0.0\n  Problem Signature 03: 4dac0949\n  Problem Signature 04: Al-Deihani\n  Problem Signature 05: 1.0.0.0\n  Problem Signature 06: 4dac0949\n  Problem Signature 07: 47\n  Problem Signature 08: c6\n  Problem Signature 09: System.InvalidOperationException\n  OS Version:   6.1.7600.2.0.0.256.1\n  Locale ID:    1033</p>\n\n<p>Read our privacy statement online:\n  <a href=\"http://go.microsoft.com/fwlink/?linkid=104288&amp;clcid=0x0409\" rel=\"nofollow\">http://go.microsoft.com/fwlink/?linkid=104288&amp;clcid=0x0409</a></p>\n\n<p>If the online privacy statement is not available, please read our privacy statement offline:\n  C:\\Windows\\system32\\en-US\\erofflps.txt</p>\n"},{"tags":[".net","scintilla"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":10371965,"title":"How to start a project with Scintilla?","body":"<p>I have been trying to do a project based on the Scintilla editor and since I'm a newbie I don't know how to actually start a project. I followed the steps on the Readme and was able to build Scintilla on Windows and now trying to figure out what I should do next.</p>\n\n<p>Any sort of answer/suggestion/advice is highly appreciated. Thanks.</p>\n"},{"tags":[".net","desktop-application","facebook-login"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13212583,"title":"Login error in desktop application using Facebook Developer Toolkit","body":"<p>I'am developing .NET desktop application using Facebook Developer Toolkit from <a href=\"http://facebooktoolkit.codeplex.com/releases/view/39727\" rel=\"nofollow\">http://facebooktoolkit.codeplex.com/releases/view/39727</a>. Everything worked fine until end of previous month. Login to Facebook stopped working. After you enter credentials and hit the login button, System.Collections.Generic.KeyNotFoundException is raised inside API I'am using:</p>\n\n<pre><code>at System.Collections.Generic.Dictionary`2.get_Item(TKey key)\nat Facebook.Session.DesktopSession.CompleteLogin(Dictionary`2 sessionProperties)\nat Facebook.Session.DesktopSession.Login()\nat Facebook.Winforms.Components.FacebookService.ConnectToFacebook(List`1 permissions)\n</code></pre>\n\n<p>To me, it looks like there were some changes in Facebook API, maybe in some URL, whose parts are used as keys for dictionary. I'am desperate, because I invested huge amount of time for developing that desktop application. Any ideas?</p>\n"},{"tags":["c#",".net","api","dll","google-drive-sdk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13211406,"title":"Error, missing TClient parameter","body":"<p>I am following the google QuickStart google Drive .NET api video and I get an error at this point. I followed everything they said, I added all the required dlls. I am running windows 7 on a virutal machine, with Visual Studio 2012, could this be the issue?</p>\n\n<p>After copy pasting their code, I cannot build it.\nI get this error :</p>\n\n<p><code>OAuth2.OAuth2Authenticator&lt;TClient&gt;' requires 1 type arguments</code></p>\n\n<p>I could not find any info on google about this error , nor about the TClient</p>\n\n<p>What is my missing TClient parameter?</p>\n\n<p><strong>The code</strong></p>\n\n<pre><code>using System;\nusing System.Diagnostics;\nusing DotNetOpenAuth.OAuth2;\nusing Google.Apis.Authentication.OAuth2;\nusing Google.Apis.Authentication.OAuth2.DotNetOpenAuth;\nusing Google.Apis.Drive.v2;\nusing Google.Apis.Drive.v2.Data;\nusing Google.Apis.Util;\n\nnamespace GoogleDriveSamples\n{\n    class DriveCommandLineSample\n    {\n        static void Main(string[] args)\n        {\n            String CLIENT_ID = \"YOUR_CLIENT_ID\";\n            String CLIENT_SECRET = \"YOUR_CLIENT_SECRET\";\n\n            // Register the authenticator and create the service\n            var provider = new NativeApplicationClient(GoogleAuthenticationServer.Description, CLIENT_ID, CLIENT_SECRET);\n            var auth = new OAuth2Authenticator(provider, GetAuthorization);\n            var service = new DriveService(auth);\n\n            File body = new File();\n            body.Title = \"My document\";\n            body.Description = \"A test document\";\n            body.MimeType = \"text/plain\";\n\n            byte[] byteArray = System.IO.File.ReadAllBytes(\"document.txt\");\n            System.IO.MemoryStream stream = new System.IO.MemoryStream(byteArray);\n\n            FilesResource.InsertMediaUpload request = service.Files.Insert(body, stream, \"text/plain\");\n            request.Upload();\n\n            File file = request.ResponseBody;\n            Console.WriteLine(\"File id: \" + file.Id);\n            Console.WriteLine(\"Press Enter to end this process.\");\n            Console.ReadLine();\n        }\n\n        private static IAuthorizationState GetAuthorization(NativeApplicationClient arg)\n        {\n            // Get the auth URL:\n            IAuthorizationState state = new AuthorizationState(new[] { DriveService.Scopes.Drive.GetStringValue() });\n            state.Callback = new Uri(NativeApplicationClient.OutOfBandCallbackUrl);\n            Uri authUri = arg.RequestUserAuthorization(state);\n\n            // Request authorization from the user (by opening a browser window):\n            Process.Start(authUri.ToString());\n            Console.Write(\"  Authorization Code: \");\n            string authCode = Console.ReadLine();\n            Console.WriteLine();\n\n            // Retrieve the access token by using the authorization code:\n            return arg.ProcessUserAuthorization(authCode, state);\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","regex","delimiter","replacement"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":13210939,"title":"RegEx replacement between \"arbitrary\" delimiters","body":"<p>I am having a bit of an issue regarding replacing parts of a text file between \"arbitrary\" delimiters.</p>\n\n<p>Here is what I want to do: I have mark-up like the following:</p>\n\n<pre><code>//   [ADX START] ANYTHING //   [ADX END] \n\n&lt;!--    [ADX START] --&gt; ANYTHING &lt;!-- [ADX END]  --&gt;\n\n/*   \n [ADX START] */  ANYTHING /*  [ADX END]        */\n</code></pre>\n\n<p>So, these are different commenting styles and I want to grab the opening [ADX START] (including the surrounding comment), then the text in between and finally, the final [ADX END].</p>\n\n<p>Hence, I give it a text file like this:</p>\n\n<pre><code>test.php:\n&lt;?php\nBEFORE    \n// [ADX START]\nREMOVEME\n// [ADX END]\nAFTER\n\ntest.css:\nBEFORE    \n/* [ADX START]*/\nREMOVEME\n/*[ADX END] */\nAFTER\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>test.php:\n&lt;?php\nBEFORE    \nAFTER\n\ntest.css:\nBEFORE    \nAFTER\n</code></pre>\n\n<p>And so on. As you can see, there can be any number of whitespaces (or none) between the commenting-style and the delimiters.</p>\n\n<p>So, what I came-up with so far is the following:</p>\n\n<pre><code>string newFileContent = Regex.Matches(fileContent, \"(\\\\[ADX START\\\\].*\\\\[ADX END\\\\])\", RegexOptions.IgnoreCase);\n</code></pre>\n\n<p>However, that doesn't do anything. I think what trips me up is the brackets etc.; furthermore, I would like to simply be able to drop-in different commenting styles such as #, //, /**/, etc;</p>\n\n<p>Any pointer in the right direction would be appreciated.</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13211714,"title":"CSharpCodeProvider Output console app as windows form app","body":"<p>I have some code to create an exe from c# source on-the-fly using the CSharpCodeProvider, here it is:</p>\n\n<pre><code>public static void BuildAssembly(string code)\n{\n    Microsoft.CSharp.CSharpCodeProvider provider =\n    new CSharpCodeProvider();\n    ICodeCompiler compiler = provider.CreateCompiler();\n    CompilerParameters compilerparams = new CompilerParameters();\n\n    compilerparams.ReferencedAssemblies.Add(\"System.dll\");\n    compilerparams.GenerateExecutable = true;\n    compilerparams.GenerateInMemory = false;\n    compilerparams.OutputAssembly = @\"C:\\Users\\me\\AppData\\Roaming\\test.exe\";\n    CompilerResults results =\n       compiler.CompileAssemblyFromSource(compilerparams, code);\n    if (results.Errors.HasErrors)\n    {\n        StringBuilder errors = new StringBuilder(\"Compiler Errors :\\r\\n\");\n        foreach (CompilerError error in results.Errors)\n        {\n            errors.AppendFormat(\"Line {0},{1}\\t: {2}\\n\",\n                   error.Line, error.Column, error.ErrorText);\n        }\n        throw new Exception(errors.ToString());\n    }\n    else\n    {\n\n    }\n}\n</code></pre>\n\n<p>all works fine, it compiles my console application c# code. But when I'm writing a console app and i requires that the console not be visible I simply go to the application properties and change output type from console to Windows Application. So how would I do this via the function I pasted above? I've looked through all the options but .. no idea :(</p>\n\n<p>thanks.</p>\n"},{"tags":[".net","data-structures","case-insensitive"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13148939,"title":"Retreive the correct casing from a case-insensitive lookup","body":"<p>In .net, what would be the best data structure to store a reference casing?</p>\n\n<p>I'm searching for a data structure which could return the casing with which an entry was originally inserted. Something like this:</p>\n\n<pre><code>Store.Add(\"HeLLo\") //Adds a key\n\nif (Store.Contains(\"hEllO\")) //returns true (case-insensitive lookup)\n    Store.Retreive(\"hEllO\")) //return HeLLo, as initially inserted.\n</code></pre>\n\n<p>I currently use a case-insensitive dictionary with keys equal to the values, but this feels ugly.</p>\n\n<pre><code>Dictionary&lt;string, string&gt; dic = \n    new Dictionary&lt;string, string&gt;(StringComparer.InvariantCultureIgnoreCase)\n\ndic.Add(\"HeLLo\", \"HeLLo\")\nif (dic.ContainsKey(\"hEllO\"))\n    dic[\"hEllO\"]\n</code></pre>\n"},{"tags":["c#",".net","windows-8","windows-store-apps"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":88,"score":1,"question_id":13212259,"title":"Why is List<T>.ForEach extension missing from .NET Core?","body":"<p>I was porting some code over to work with a Windows 8 Store App and noticed that the List.ForEach extension isn't included in the .NET Core framework (the framework referenced by Windows 8 Store Apps).</p>\n\n<p>MSDN confirms that it is not supported for Store Apps.</p>\n\n<p>I can easily get around the missing extension, but at this point I'm just curious why it's missing.</p>\n"},{"tags":["php",".net","database","entity-framework","orm"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":2601,"score":3,"question_id":5532688,"title":"ORM for PHP like .NET Entity Framework","body":"<p>I'm a .NET developer and new in PHP. I want to know, is there a ORM for PHP like the Entity Framework in the Microsoft .NET Framework? </p>\n\n<p>Are there any utility applications to make working with data faster and easier?</p>\n"},{"tags":[".net","entity-framework","optimistic-concurrency"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13173415,"title":"Update properties of attached entity with databasevalue on query","body":"<p>I have entity classes that have an integer property (named ROW_VERSION) with ConcurrencyMode set to \"Fixed\" for optimistic concurrency checking. I increment the value of this column in my application code before saving an entity of this type (so StoreGeneratedPattern is set to None). This works well when saving changes.</p>\n\n<p>Now I also would like to detect a concurrency error when I have a previously loaded entity (with ROW_VERSION = x) and I create a new DbContext, attach this entity and issue a query involving this entity. The problem there is that if the ROW_VERSION was incremented by another client application (ROW_VERSION = x + 1), this isn't detected during my query, because the value of the attached entity has obviously priority (which totally makes sense for common column values).</p>\n\n<p>For my concurrency checking column on the other hand it would be nice, if the EF updates the value with the current databasevalue, so I can compare it with the expected value. Alternatively an exception thrown from the query execution would be acceptable.</p>\n\n<p>I'm using entity framework 4.3 with .NET 4.0.</p>\n\n<p>Edit (in response to the comment from Gert Arnold):</p>\n\n<p>I try to clarify my problem a little more ...</p>\n\n<p>Notes of how my application works generally:</p>\n\n<ul>\n<li><p>There is a treeview showing my available entity objects and on selecting one, the full entity is loaded from DB to be displayed in a detail view, where it can be edited</p></li>\n<li><p>Modifications to an entity object are not saved immediately but are cached in memory, so modifications of different entity objects can pile up and are saved all together, when the user hits the save button.</p></li>\n<li><p>DbContexts are created separately for queries and saving changes (i.e. I don't have the same DbContext all the time, but they are instantiated as needed).</p></li>\n<li><p>When an entity object is loaded to be display in the detail view, all previously modified entity objects (that are cached) are attached to the DbContext that is used for the query first. Then the actual query is issued. <strong>So if i query an entity object, that was modified before I will get the modified version as result and not the version from database (which could have changed in the meantime).</strong></p></li>\n</ul>\n\n<p>So here is an example that shows my problem:</p>\n\n<ol>\n<li><p>Client App 1 loads an entity object with ROW_VERSION = 1, disposes the DbContext and keeps the reference to this entity object for further editing.</p></li>\n<li><p>Client App 2 loads the same entity object mentioned in step 1, changes a property and saves the changes. This causes the ROW_VERSION in the DB to be incremented (it is 2 now).</p></li>\n<li><p>The user of Client App 1 now changes some properties of entity object (which is still in memory with a ROW_VERSION of 1).</p></li>\n<li><p>Before Client App 1 saves the changes, it loads some other entity objects for display, and eventually selects the entity object in question again (e.g. to review the changes made). This causes a query where the result will contain the already changed entity object (because it is attached to the DbContext before the actual query is sent to the database).</p>\n\n<p><strong>And here is my problem: At this point the entity framework could compare the ROW_VERSION of the attached object with that of the object in the actual query result, detect a mismatch and e.g. throw an exception.</strong></p>\n\n<p><strong>But instead the EF treats the ROW_VERSION property like all other properties which could just have been changed by the client.</strong></p></li>\n</ol>\n\n<p>So I wish the EF to treat the ROW_VERSION property specially and compare its values on every query to detect changes by other clients. This way I would detect concurrency situations earlier than when waiting for the SaveChanges call.</p>\n"},{"tags":["asp.net",".net","unit-testing","user","identity"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":61,"score":4,"question_id":12780185,"title":"Writing Unit Test for methods that use User.Identity.Name in ASP.NET MVC","body":"<p>I am writing test cases using the Unit Test for ASP.NET MVC 4 with Web Api.</p>\n\n<p>Now I have an action which makes a call to some method I have defined in the service layer, where I have used the following line of code.</p>\n\n<pre><code>string username = User.Identity.Name;\n// do something with username\n// return something\n</code></pre>\n\n<p>Now how to I create unit test method for this, I am getting null reference exceptions. I am kinda new to writing unit test and stuff.</p>\n\n<p>And I want to use Unit Test only for this.</p>\n\n<p>Please help me out on this. Thanks.</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":31,"score":-3,"question_id":13205927,"title":"Developing a remote appllication like ammyy in C#","body":"<p>I want to design an C# application Like Ammyy. Which will control the machine remotely over internet also. Basically default RDP only for the LAN env. But I want it for the internet scenario also. Please help and provide the code for the same.</p>\n"},{"tags":["c#",".net","datatable"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3369,"score":2,"question_id":4184698,"title":"Unable to Copy datacolumn from one data table to another","body":"<p>How can I copy 1 data column from 1 data table to a new datatable. When  I try to do it, I get the error Column 'XXX' already belongs to another DataTable.? </p>\n\n<pre><code>dataColumn = datatable1.Columns[1];\ndatatable2 = new DataTable();\ndatatable2.Columns.Add(dataColumn);\n</code></pre>\n\n<p>Thanks in Advance</p>\n"},{"tags":[".net","reflection","nunit"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13207289,"title":"NUnit API And Running Tests Programmatically","body":"<p>This is the first time I'm trying to hack into the NUnit Interface, and am facing some issues. </p>\n\n<p>This is what I am trying to achieve - </p>\n\n<ul>\n<li>Take a set of string inputs as code files and compile them into an assembly</li>\n<li>take the in-memory assembly and pass it to NUnit for identifying and running the tests in this code</li>\n</ul>\n\n<p>This is what I have so far</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// Validates whether the code files are valid\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"codefiles\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public string Validate(string[] codefiles)\n    {\n        //to avoid NullReferenceException within NUnit - don't know why this is needed!\n        TestExecutionContext.CurrentContext.TestPackage = new TestPackage(\"PersonTest\");\n\n        var assembly = BuildAssembly(codefiles);\n        TestSuite suite = new TestAssembly(assembly, \"PersonTest\");\n        var result = suite.Run(new NullListener(), TestFilter.Empty);\n        return result.IsSuccess ? string.Empty : result.Message;\n    }\n\n    /// &lt;summary&gt;\n    /// Builds an assembly\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"code\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    private static Assembly BuildAssembly(string[] code)\n    {\n        var compilerparams = new CompilerParameters(new[] {\"nunit.framework.dll\"})\n            {\n                GenerateExecutable = false,\n                GenerateInMemory = true\n            };\n\n        var results = new CSharpCodeProvider()\n            .CompileAssemblyFromSource(compilerparams, code);\n\n        if (!results.Errors.HasErrors) return results.CompiledAssembly;\n\n        throw new Exception(GetErrors(results));\n    }\n</code></pre>\n\n<p>These are the two strings I am trying to compile (by sending as string array with two elements into the validate method above)</p>\n\n<pre><code>       private const string File1 = @\"\n    public class Person \n    {\n        public string Name {get;set;}\n\n        public Person(string name)\n        {\n            Name = name;\n        }\n    }\";\n\n    private const string ProperInput = @\"\n        using NUnit.Framework;\n\n        [TestFixture]\n        public class PersonTest\n        {\n            [Test]\n            public void CheckConstructor()\n            {\n                var me = new Person(\"\"Roopesh Shenoy\"\");\n                Assert.AreEqual(\"\"Roopesh Shenoy\"\", me.Name);\n            }\n        }\";\n</code></pre>\n\n<p>Problem - </p>\n\n<p>The compilation happens fine - the assembly generated even has these two types. Also not passing the nunit.framework.dll into referenced assemblies gives compilation exception (when dynamically compining), so it means that the TestFixture/Test addributes are recognized as well. </p>\n\n<p>However, when I debug the TestAssembly just shows test count as zero. So instead of showing test success or failure, it shows inconclusive and basically just doesn't do anything. </p>\n\n<p>I tried going through the NUnit codebase, but haven't reached any good conclusion yet - most of their convenient methods expect the assembly to be on the file system, so I'm trying to figure out exactly how to do this. Any ideas?</p>\n"},{"tags":["android",".net","ios","networking","discovery"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13211632,"title":"Discover mobile devices (Android and IOS) using .NET","body":"<p>I am working on an ASP.NET (VB.NET) application which will discover devices connected on network. Is there a way through which i can discover IOS devices (iphone, ipad, ipod) and android devices (phones, tablets) connected to my network?</p>\n\n<p>Please assist.</p>\n\n<p>Thanks.</p>\n\n<p>Umer</p>\n"},{"tags":["c#",".net","app-config","system.net"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":13240,"score":6,"question_id":980440,"title":"Update app.config system.net setting at runtime","body":"<p>I need to update a setting in the system.net SectionGroup of a .Net exe app.config file at runtime. I don't have write access to the original config file at runtime (I am developing a .Net dll add-in which is hosted in an exe provided by the app which I have no control over) so I was hoping to save a copy of the file and replace the config in the exe with the modified version at runtime. I've tried the following but it's not working.  Any suggestions?</p>\n\n<pre><code>    Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);\n    NetSectionGroup netSectionGroup = config.GetSectionGroup(\"system.net\") as NetSectionGroup;\n    netSectionGroup.Settings.HttpWebRequest.UseUnsafeHeaderParsing = true;                      \n    config.SaveAs(@\"C:\\ProgramData\\test.config\", ConfigurationSaveMode.Full);\n\n    AppDomain.CurrentDomain.SetData(\"APP_CONFIG_FILE\", @\"C:\\ProgramData\\test.config\");\n</code></pre>\n"},{"tags":["c#",".net","microsoft-metro"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13211585,"title":"Metro App page navigation animation","body":"<p>I'm playing with Metro Style Apps for a few days and trying everything what's possible in new UI. I spent few hours looking for some article or manual page explaining <strong>how to change animation that occours when frame is navigating from one page to another</strong>. I had no luck, can you please help me?</p>\n"},{"tags":["c#",".net","json.net","deserialization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":13211012,"title":"getting a \"default\" concrete class that implements an interface","body":"<p>I am implementing a custom (and generic) Json.net serializer and hit a bump in the road that I could use some help on.</p>\n\n<p>When the deserializer is mapping to a property that is an interface, how can I best determine what sort of object to construct to deserialize to to place into the interface property.</p>\n\n<p>I have the following:</p>\n\n<pre><code>[JsonConverter(typeof(MyCustomSerializer&lt;foo&gt;))]\nclass foo \n{\n    int Int1 { get; set; }\n    IList&lt;string&gt; StringList {get; set; }\n}\n</code></pre>\n\n<p>My serializer properly serializes this object, and but when it comes back in, and I try to map the json parts to to object, I have a JArray and an interface.</p>\n\n<p>I am currently instantiating anything enumerable like List as</p>\n\n<pre><code> theList = Activator.CreateInstance(property.PropertyType);\n</code></pre>\n\n<p>This works create to work with in the deserialization process, but when the property is IList, I get runtime complaints (obviously) about not being able to instantiate an interface. </p>\n\n<p>So how would I know what type of concrete class to create in a case like this?</p>\n\n<p>Thank you</p>\n"},{"tags":["c#",".net","windows","winforms","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13209146,"title":"Shifting values ​​between Data Grid View","body":"<p>I have a problem. I create tabs in the newly created objects Data Grid (each has different information, which also calculate the average). The data in the Data Grid are written to the SQLite database. After reading the DGV creates a dynamic column from the arithmetic mean, I want to move without having to write to the database to another column. Is a good way would be to store data in an array? Please understand I am a beginner ...</p>\n"},{"tags":[".net","mvc","nhibernate","caching","evict"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13131796,"title":"NHibernate caching issue - When to call Evict?","body":"<p>I've run into an apparent caching issue where what's being returned by NHibernate is not matching up with what's in the DB.</p>\n\n<p>I believe this is level2 cache data.  It looks like I can use the Evict to do this, but <strong>when should the Evict method actually be called?</strong>  For my particular application, the data is going to be unique to the user and chances are the data provided will only be used once*.  </p>\n\n<p><strong>Can I disable Level2 caching for these sets of objects completely?</strong></p>\n\n<p><em>UPDATE 10/31</em></p>\n\n<p>My scenario is this: I have a shopping cart where the customer is going to be adding and removing items.  What I am doing is the following: before the updates to the cart are processed, I evict the <code>Cart</code> and <code>CartProduct</code> entities. Once this is done, I retrieve the list of <code>CartProducts</code> from the provider and return the view (this is happening in a .NET MVC Controller).  </p>\n\n<p><em>UPDATE 11/3</em></p>\n\n<p>The shopping cart has since been finished, and I ran into an issue that appeared to be related to the same NHibernate issue, but in fact was an MVC issue.  Deeper digging revealed that the HTML Helper extensions were overriding the value I supposed and replacing with what was in the Model state.  So a double whammy on this one.  Hope this helps someone.</p>\n"},{"tags":["c++",".net","excel","cli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13170609,"title":"Open and read Excel file with C++/CLI","body":"<p>I am trying to create a program with C++/CLI that reads some data from Excel workbooks using Visual Studio.\nI have added Microsoft.Office.Interop.Excel (v12) to the references in the project properties.\nMy basic goal would be only to get a cell's value as a string (the workbook contains only text values).\nMy current code is the following (only the main part is included of course):</p>\n\n<pre><code>using namespace System;\nusing namespace System::ComponentModel;\nusing namespace System::Collections;\nusing namespace System::Windows::Forms;\nusing namespace System::Data;\nusing namespace System::Drawing;\nusing namespace Microsoft::Office::Interop::Excel;\n\nstart(void){\n        Microsoft::Office::Interop::Excel::Application^ exApp= gcnew Microsoft::Office::Interop::Excel::ApplicationClass();\n        String^ filename=\"e:\\\\test.xls\";\n        Workbook^ wb = exApp-&gt;Workbooks-&gt;Open(filename, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing, Type::Missing);\n        Worksheet^  exWs  = safe_cast&lt;Worksheet^&gt;(exApp-&gt;ActiveSheet);\n        int row=1;\n        int col=1;\n        String^ tmp=((Microsoft::Office::Interop::Excel::Range^)exWs-&gt;Cells[(System::Object^)row, (System::Object^)col])-&gt;Value2-&gt;ToString();\n        MessageBox::Show(tmp);\n}\n</code></pre>\n\n<p>When I run it, it crashes with the following error:</p>\n\n<pre><code>An unhandled exception of type 'System.Runtime.InteropServices.COMException' occurred in exc2.exe\n\nAdditional information: Old format or invalid type library. (Exception from HRESULT: 0x80028018 (TYPE_E_INVDATAREAD))\n</code></pre>\n\n<p>It happens with both xls and xlsx files, when I try to open the workbook (at the line that starts with \"Workbook^ wb = exApp->Workbooks->Open\" - so I could not even check if the rest is working).\nCould some help please, what do i miss/do wrong?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":[".net","vb.net","winforms","mshtml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13210584,"title":"Unable to cast COM object of type 'System.__ComObject' to interface type 'mshtml.HTMLElementCollection","body":"<p>Am trying to use mshtml to fill a form on vb.net through the webbrowser control,</p>\n\n<pre><code>Dim doc As MSH.IHTMLDocument2 = DirectCast(wbMain.Document.DomDocument, MSH.IHTMLDocument2)\nDim buttons As MSH.HTMLElementCollection = doc.getElementsByTagName(\"button\")\nDim Inputs As MSH.HTMLElementCollection = doc.getElementsByTagName(\"input\")\n</code></pre>\n\n<p>but i get the following error</p>\n\n<blockquote>\n  <p>Unable to cast COM object of type 'System.__ComObject' to interface\n  type 'mshtml.HTMLElementCollection'. This operation failed because the\n  QueryInterface call on the COM component for the interface with IID\n  '{3050F56B-98B5-11CF-BB82-00AA00BDCE0B}' failed due to the following\n  error: No such interface supported (Exception from HRESULT: 0x80004002\n  (E_NOINTERFACE)).</p>\n</blockquote>\n\n<p>can anyone help me out with the possible solution?</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":58,"score":-1,"question_id":13210142,"title":"How do I determine idle time in my C# application?","body":"<p>I want to get the Windows Idle Time from my application. I am using exactly this code:</p>\n\n<p><a href=\"http://dataerror.blogspot.de/2005/02/detect-windows-idle-time.html\" rel=\"nofollow\">http://dataerror.blogspot.de/2005/02/detect-windows-idle-time.html</a></p>\n\n<p>I have tested this on Windows 7 and it is working properly, but I am getting only a zero on Windows 8.</p>\n\n<p>Any ideas how to fix this?</p>\n"},{"tags":[".net","postgresql","mono","orm"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":774,"score":4,"question_id":3384366,"title":"Mono ORM that works with PostgreSQL?","body":"<p>I've been trying to find a decent ORM that works with both Mono and PosgreSQL. </p>\n\n<p>Does anyone know of such an ORM?</p>\n"},{"tags":[".net","wpf","vb.net","exception-handling","dependency-properties"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13206673,"title":"Dependency property value not assigned while setting value through Styles using dynamic resource","body":"<pre><code>Public Class UITreeview\n    Inherits System.Windows.Controls.TreeView\n\nPublic Shared ExpandAllproperty As DependencyProperty\nShared Sub New()\n        DefaultStyleKeyProperty.OverrideMetadata(GetType(UITreeview), New FrameworkPropertyMetadata(GetType(UITreeview)))\n        UITreeview.ExpandAllproperty = UITreeViewItem.IsExpandedProperty.AddOwner(GetType(UITreeview), New FrameworkPropertyMetadata(True, FrameworkPropertyMetadataOptions.Inherits))\n    End Sub\nPublic Property ExpandAll As Boolean\n        Get\n            Return Me.GetValue(ExpandAllproperty)\n        End Get\n        Set(value As Boolean)\n            Me.SetValue(ExpandAllproperty, value)\n        End Set\n    End Property \n....\nEnd Class\n</code></pre>\n\n<p>i have created my own dependency property,which i set using style</p>\n\n<pre><code>&lt;Style  TargetType=\"{x:Type UINat:UITreeview}\"&gt;\n    &lt;Setter Property=\"ExpandAll\" Value=\"False\" /&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>but unfortunately I'm getting an error:</p>\n\n<blockquote>\n  <p>System.ArgumentNullException: Value cannot be null. Parameter name: property.</p>\n</blockquote>\n\n<p>My objective is to control TreeviewItem.IsExpanded property from Resource XAML.</p>\n"},{"tags":[".net","wpf","validation","mvvm"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13209959,"title":"WPF how to filter data-binded element? MVVM related","body":"<p>I've got a textbox and it's Text property bound to a string(in the view model)</p>\n\n<p>Question: How do I make it so whatever is written in that textbox is exactly 10 characters long (or only in English letters, just an example).</p>\n\n<p>Problem is it is directly written to the viewModel's string variable. So my only idea is having a converter for this. But even if the converter returns nothing, how do I inform the user that something's wrong? (\"error - length != 10\" as an example)</p>\n"},{"tags":[".net","vb.net",".net-3.5"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12948228,"title":"Pin to/Unpin from Taskbar and Start Menu","body":"<p>I need to provide “Pin to Taskbar”, “Pin to Start Menu”, “Unpin from Taskbar” and “Unpin from Start Menu” functionality in my application (developed in .Net framework 3.5). Currently I have achieved the functionality using the code snippet below:</p>\n\n<pre><code>Dim verbs As FolderItemVerbs = link.Verbs()\nFor i As Integer = 0 To verbs.Count - 1\n  Dim verb As FolderItemVerb = verbs.Item(i)\n  Dim verbName As String = verb.Name.Replace(\"&amp;\", String.Empty)\n  If (verbName.Equals(\"pin to taskbar\")) Or (verbName.Equals(\"unpin from taskbar\")) Then\n  ‘If (verbName.Equals(\"Pin to Start Menu\")) Or (verbName.Equals(\"Unpin from Start Menu\")) Then\n    verb.DoIt()\n  End If\nNext\n</code></pre>\n\n<p>The code is working fine, but in my case my application is widely distributed all over the world so running the application with different locale setting (different languages) is very common. The above code has this limitation that it would not work for all different languages (e.g. French, german etc). can you please help me how would I implement pinning and unpinning functionality that is language independent.</p>\n"},{"tags":["c#",".net","microsoft-metro"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13209917,"title":"C# with metro, is the sealed keyword an absolute requirement?","body":"<p>I know that you can write metro applications in c#. My question is if the sealed keyword is required for every class. I tried to compile a metro application and I removed the sealed keyword from the class. It still compiled.</p>\n\n<p>So how is the sealed keyword exactly used in metro applications and C#. What's the reason behind it. Is it only required if you want the classes to be visible in another language other than a .net language?</p>\n"},{"tags":[".net","vb.net","multithreading","web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13019135,"title":"InvalidOperationException when invoking web service using threads VB. Net","body":"<p>I added a web reference to my project.</p>\n\n<p>I'm using threads, they call to web service of this way:</p>\n\n<pre><code>Private Sub principal()\n    Dim arrayH As New ArrayList\n    Dim h As Thread\n    Dim z As Integer = 150\n\n    For i As Integer = 1 To Z\n        h= New Thread(AddressOf doWork)\n        arrayH.Add(h)\n    Next\n\n\n    For Each _h As Thread In arrayH\n        _h.Start()\n    Next\nEnd Sub\n\nPrivate Sub doWork()\n    Dim service As webService.Query\n    Dim parameter, response As String\n\n    parameter = \"...\"'The parameter is a xml\n\n    Try\n        service = New Query\n        response = service.Report(parameter)\n\n    Catch ex As Exception\n        'do something\n    End Try\n\nEnd Sub\n</code></pre>\n\n<p>When there are many threads (Z = 150) it throws:</p>\n\n<pre><code>System.InvalidOperationException\n\nThere is an error in XML document (1, 279).\n\nUnable to read data from the transport connection: The connection was closed. \n</code></pre>\n\n<p>In case that Z is small no problem. How do I avoid this?</p>\n"},{"tags":["c#",".net","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":87,"score":3,"question_id":13209691,"title":"Static method, static field and multitheading in C#","body":"<p>I have 1 static class and 1 field and 2 methods within it:</p>\n\n<pre><code> static class MyClass{\n\n       private static HttpClient client = new HttpClient();\n       private static string SendRequestToServer(int id)\n       {\n          Task&lt;HttpResponseMessage&gt; response = client.GetAsync(\"some string\");\n          responseTask.ContinueWith(x =&gt; PrintResult(x));\n          return \"some new value\";\n        }\n\n        private static void Print(Task&lt;HttpResponseMessage&gt; task)\n        {\n            Task&lt;string&gt; r = task.Result.Content.ReadAsStringAsync();\n            r.ContinueWith(resultTask =&gt; Console.WriteLine(\"result is: \" + resultTask.Result));\n        }\n }\n</code></pre>\n\n<p>The question is, if many threads start using <code>MyClass</code> and its methods, would it cause some problems?</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":90,"score":2,"question_id":13208690,"title":"File.Delete fails on attempting to delete an opened file but deletes on process exit?","body":"<p>While calling <code>File.Delete(file_path)</code> for a file which is opened in another process, the attempt fails with cannot access error, but on exiting the app (from where the attempt was made) the file gets deleted automatically. After <code>File.Delete</code> attempt, the path gets inaccessible for any other operation.</p>\n\n<p>I need to either fail on delete and let the path be accessible through the app or delete the file completely, not on app exit.</p>\n\n<p>Well my code is this :</p>\n\n<pre><code> private bool DeleteFilesAsync(string FileToDelete)\n {\n    try\n    {\n            //Set file's attribute to normal if it is ReadOnly file\n            File.SetAttributes(FileToDelete, FileAttributes.Normal);\n\n            File.Delete(FileToDelete);\n           //Some bussiness logic to update file's status in database\n\n        return true;\n    }\n    catch (Exception ex)\n    {\n        //log the error\n         return false;\n    }\n}\n</code></pre>\n\n<p>Something wrong here?</p>\n"},{"tags":["c#",".net","types","runtime"],"answer_count":8,"favorite_count":4,"up_vote_count":8,"down_vote_count":1,"view_count":5147,"score":7,"question_id":1722491,"title":"How to generate an instance of an unknown type at runtime?","body":"<p>i've got the following in C#:</p>\n\n<pre><code>string typename = \"System.Int32\";\nstring value = \"4\";\n</code></pre>\n\n<p>theses two strings should be taken to generate an object of the specified type with the specified value...</p>\n\n<p>result should be:</p>\n\n<pre><code>object o = CreateUnknownType(typename, value);\n...\nInt32 test = (Int32)o;\n</code></pre>\n"},{"tags":["c#","java","python",".net","pdf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13202555,"title":"how can you create a signature field for a PDF template?","body":"<p>I have been searching through <a href=\"http://itextpdf.com/\" rel=\"nofollow\">itextsharp</a> classes:</p>\n\n<p><a href=\"http://api.itextpdf.com/itext/\" rel=\"nofollow\">http://api.itextpdf.com/itext/</a></p>\n\n<p>And I found that you can create buttons, checkboxes, radio buttons, textboxes:</p>\n\n<p><img src=\"http://i.stack.imgur.com/K8xzP.png\" alt=\"enter image description here\"></p>\n\n<p>But I do not understand why you cannot create a signature box? <strong>Or can you?</strong> It is part of the standard library of objects for a PDF template. You can create this object using adobe acrobat itself. </p>\n\n<p><strong>Is there a library/tool out there that will create a signature box for a PDF?</strong></p>\n\n<p>When I say signature, I mean I need the user to be able to sign their name on the resulting PDF.</p>\n"},{"tags":["c#",".net","datatable","c#-2.0"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":6511,"score":5,"question_id":2714171,"title":"Accessing deleted rows from a DataTable","body":"<p>I have a parent WinForm that has a MyDataTable <code>_dt</code> as a member.  The MyDataTable type was created in the \"typed dataset\" designer tool in Visual Studio 2005 (MyDataTable inherits from DataTable)  <code>_dt</code> gets populated from a db via ADO.NET.  Based on changes from user interaction in the form, I delete a row from the table like so:</p>\n\n<p><code>_dt.FindBySomeKey(_someKey).Delete();</code></p>\n\n<p>Later on, <code>_dt</code> is passed by value to a dialog form.  From there, I need to scan through all the rows to build a string:</p>\n\n<pre><code>           foreach (myDataTableRow row in _dt)\n            {\n                sbFilter.Append(\"'\" + row.info + \"',\");\n            }\n</code></pre>\n\n<p>The problem is that upon doing this after a delete, the following exception is thrown:\n<code>DeletedRowInaccessibleException: Deleted row information cannot be accessed through the row.</code></p>\n\n<p>The work around that I am currently using (which feels like a hack) is the following:</p>\n\n<pre><code>           foreach (myDataTableRow  row in _dt)\n            {\n                if (row.RowState != DataRowState.Deleted &amp;&amp;\n                    row.RowState != DataRowState.Detached)\n                {\n                    sbFilter.Append(\"'\" + row.info + \"',\");\n                }\n            }\n</code></pre>\n\n<p>My question:  Is this the proper way to do this?  Why would the foreach loop access rows that have been tagged via the <code>Delete()</code> method??</p>\n"},{"tags":["c#",".net","visual-studio-2010","c#-4.0"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13209125,"title":"what is use of base.OnManipulationStarted(e) in OnManipulationStarted(ManipulationStartedEventArgs e) in C# .Net?","body":"<p>I created a program which uses  </p>\n\n<pre><code>OnManipulationStarted(ManipulationStartedEventArgs e) \n</code></pre>\n\n<p>then I found </p>\n\n<pre><code>base.OnManipulationStarted(e) \n</code></pre>\n\n<p>which was automatically inserted in the code....I have commented that line and checked the program which gave no change in output of program..For what reason does this code exist in the default method ??</p>\n\n<pre><code>OnManipulationStarted(ManipulationStartedEventArgs e) \n</code></pre>\n\n<p>Any help please...Thanks in Advance.. </p>\n"},{"tags":["c#",".net","magento","shopping-cart"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":723,"score":3,"question_id":8531659,"title":"best .net solution for ecommerce compared to Magento CE","body":"<p>I am in the need of looking for a .net shopping cart, I am a .net developer not PHP and I need that the shopping cart solution be extendible.</p>\n\n<p>In the past I have used Magento, and its probably the best solution out there, but I dont want just to learn another programming language.</p>\n\n<p>Is there any as good as magento but done in .NET??</p>\n\n<p>Some requirements I need:</p>\n\n<ul>\n<li>MultiStore in one single database.</li>\n<li>Ability to create themes.</li>\n<li>Complex shopping cart discount rules as in Magento</li>\n</ul>\n"},{"tags":["c#",".net","wpf","observablecollection","inotifypropertychanged"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13203795,"title":"Binding multiple ObservableCollections to One ObservableCollection","body":"<p>Have a bunch of <code>ObservableCollection&lt;MeClass&gt; Result</code> and require to combine them all into another <code>ObservableCollection&lt;MeClass&gt; AllResults</code> so I can display it in a <code>listview</code>.</p>\n\n<p>Just not sure how to combine them all in one.</p>\n\n<p>I Created a new class to combine them all but not sure how they will get updated after I got the list once... So not really sure which direction to take.</p>\n\n<p>I know about <code>INotifyPropertyChanged</code> I'm just not sure how to combine them all and keep updating as everything changes.</p>\n"},{"tags":["asp.net",".net","deployment","assemblies","publish"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":100,"score":1,"question_id":12476000,"title":"Could not load file or assembly 'mydllfile.dll' or one of its dependencies. The module was expected to contain an assembly manifest","body":"<p>Whenever i add new dll in my application in bin folder and access that dll it gives me following error:</p>\n\n<blockquote>\n  <p>Could not load file or assembly '~\\bin\\mydll.dll' or one of its dependencies. The module was expected to contain an assembly manifest.</p>\n</blockquote>\n\n<p>What causes this problem and how can I fix it?</p>\n"},{"tags":["jquery",".net","sharepoint"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":10347367,"title":"Function to be called after dom is loaded / ready - activate the right accordion tab","body":"<p>I'm trying to run a script from server-side, but the DOM isn't ready. </p>\n\n<p>I want to activate the right accordion \"tab\"</p>\n\n<pre><code>function ValidateTermStoreProperties(index){\n    $('#myProfileSettings').accordion('activate', index);\n}\n</code></pre>\n\n<p>I've tried to use .ready() without any luck! What am I doing wrong?</p>\n"},{"tags":["c#",".net","winforms","c#-4.0","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13208996,"title":"evade deleted row of dataset in database table","body":"<p>I dont know what to keep the heading (still confused, sorry for that). In my project, I am trying to update the database table through <code>DataSet</code>. Well I achieved this but when I delete any row in my <code>DataSet</code> and try to update the Database table then VS is showing error --> \"Deleted row information cannot be accessed through the row\". Then I searched in Internet I got the solution in this <a href=\"http://stackoverflow.com/q/4321840\">answer</a>. Now my code is not showing any error but to my exclamation the database is being updated with new values of <code>DataSet</code> both existing and <strong>deleted too</strong>. I dont want to add the deleted rows of <code>Dataset</code> to database table. How to solve this?</p>\n\n<p>In my code I am using <code>DataRowVersion.Original</code>, should I change it? I also tried other values of <code>DataRowVersion</code> but no result.</p>\n"},{"tags":[".net","asp.net-mvc","visual-studio-2010","t4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13208768,"title":"T4MVC Error - T4 file is blocked or in a non trusted zone","body":"<p>I am running Visual Studio 2010 on a Windows 7 virtual machine inside of Parallels Desktop 8 on a Mac Book Pro.</p>\n\n<p>I'm trying to incorporate T4MVC into a new MVC4 project.  I installed the T4MVC package from Nuget and immediately started getting this error...</p>\n\n<p><strong>Failed to resolve include text for file:The path '\\psf\\Home...\\T4MVC.tt.hooks.t4' must be either local to this computer or part of your trusted zone. If you have downloaded this template, you may need to 'Unblock' it using the properties page for the template file in Windows Explorer.</strong></p>\n\n<p>I went into the \"Properties\" menu for the T4MVC.tt.hooks.t4 file, but I could not find any option or button to unblock it.</p>\n\n<p>My assumption is that this problem has something to do with the fact that I'm running on a virtual machine and therefore My project files are not in a trusted location.  But I'm not sure how to fix that.</p>\n\n<p>I've been searching around but can't seem to find any answers.  Any help would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":[".net","vb.net","datetime","compare"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":44,"score":-1,"question_id":13208404,"title":"Determine whether Date is in the past?","body":"<p>What is the best way to determine whether a <code>Date</code> is in the past?</p>\n\n<p>Currently I have:</p>\n\n<pre><code>If MyDate &lt; Date.Now\n</code></pre>\n"},{"tags":["c#",".net","matlab","dll"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13208750,"title":"How to Invoke C# dll from Matlab?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/434331/interoperating-between-matlab-and-c-sharp\">Interoperating between Matlab and C#</a>  </p>\n</blockquote>\n\n\n\n<p>I need to use some functionality from a Dot Net C# managed-dll How can I call this Dot Net C# dll in matlab ?</p>\n"},{"tags":["c#",".net","windows"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":13192956,"title":"How does Read-Only affect a Directory when using C#/.Net?","body":"<p>I've found that I can write (say, copy a file into) a Read-Only directory. That is, a Directory with <code>...Attributes = FileAttributes.ReadOnly</code>.I can even change its name. The only thing I've found that can't be done is to delete it. Is that really the only thing that <code>ReadOnly</code> prevents?</p>\n\n<p>EDIT:</p>\n\n<p>Here's the code: (The Directory is empty.)</p>\n\n<pre><code>(new DirectoryInfo(path)).Attributes = FileAttributes.ReadOnly;\nDirectory.Delete(path);\n</code></pre>\n\n<p>It throws an <code>Access to the path 'c:\\... is denied.</code> exception.</p>\n\n<p>But after changing <code>ReadOnly</code> to <code>Normal</code> it works fine.</p>\n\n<p>So what <em>does</em> a <code>ReadOnly</code> prevent, and what doesn't it prevent? (Programmatically, of course. <em>Not</em>: through Windows Explorer.)</p>\n\n<p>EDIT 2:</p>\n\n<p>I have received answers linking to the documentation saying that <code>ReadOnly</code> is not honored on directories, and that it's probably <code>.Net</code> that's responsible for the delete's failure. So I'll rephrase the question: \"How does Read-Only affect a Directory <em>when using C#/.Net</em> ?\".</p>\n"},{"tags":[".net","web-services","delphi","winapi","com"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":592,"score":4,"question_id":5881070,"title":"How to access a .Net web service from a Delphi Win32 application?","body":"<p>What options do I have if I want to enable a Delphi Win32 application to consume a .Net webservice?</p>\n\n<p>Is it possible to interact directly? Or do I have to resort to a middleman-software communicating to the Delphi application per COM for instance?</p>\n\n<p>The Delphi application in question is written in Delphi 2006 but is planned to be updated to Delphi XE soon.</p>\n"},{"tags":["javascript","asp.net",".net","html","umbraco"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13149181,"title":"Inserting iFrame in Umbraco template","body":"<p>I'm trying to add a iFrame to a template using the Umbraco CMS. </p>\n\n<p>The problem I have is I can add the iFrame fine, with the width at 100% but cannot get the height to go to 100%. Basically i'm adding a website to an iFrame, so I need the height to be 100% of whatever the page framing in.</p>\n\n<p>I've tried using this code:</p>\n\n<p>JS</p>\n\n<pre><code>function calcHeight()\n{\n//find the height of the internal page\nvar the_height=\ndocument.getElementById('the_iframe').contentWindow.\ndocument.body.scrollHeight;\n\n//change the height of the iframe\ndocument.getElementById('the_iframe').height=\nthe_height;\n}\n</code></pre>\n\n<p>HTML</p>\n\n<p><code>&lt;iframe width=\"100%\" src=\"http://google.com\" scrolling=\"no\" id=\"the_iframe\" onLoad=\"calcHeight();\" height=\"1px\" frameborder=\"0\" &gt;&lt;/iframe&gt;</code></p>\n\n<p>Obviously called the js file in the template but the js does not seem to be read, however works outside Umbraco.</p>\n\n<p>Does anyone have any alternatives to get this working?</p>\n"},{"tags":["c#",".net","puzzle"],"answer_count":17,"favorite_count":9,"up_vote_count":16,"down_vote_count":6,"view_count":7989,"score":10,"question_id":154112,"title":"C# Potential Interview Question…Too hard?","body":"<p>Without running this code, identify which <code>Foo</code> method will be called:</p>\n\n<pre><code>class A\n{\n   public void Foo( int n )\n   {\n      Console.WriteLine( \"A::Foo\" );\n   }\n}\n\nclass B : A\n{\n   /* note that A::Foo and B::Foo are not related at all */\n   public void Foo( double n )\n   {\n      Console.WriteLine( \"B::Foo\" );\n   }\n}\n\nstatic void Main( string[] args )\n{\n   B b = new B();\n   /* which Foo is chosen? */\n   b.Foo( 5 );\n}\n</code></pre>\n\n<p>Which method? And why? No cheating by running the code.</p>\n\n<p>I found this puzzle on the web; I like it and I think I'm going to use it as an interview question...Opinions?</p>\n\n<p>EDIT: I wouldn't judge a candidate on getting this wrong, I'd use it as a way to open a fuller discussion about the C# and CLR itself, so I can get a good understanding of the candidates abilities.</p>\n\n<p><strong>Source:</strong> <a href=\"http://netpl.blogspot.com/2008/06/c-puzzle-no8-beginner.html\" rel=\"nofollow\">http://netpl.blogspot.com/2008/06/c-puzzle-no8-beginner.html</a></p>\n"},{"tags":["c#",".net","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13208632,"title":"find user identity","body":"<p>Is it possible to detect user identity from browser using asp.net/vb.net/c# except IP address. My aim is to detect user visit count regardless of IP address; may be Mac address or etc?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#","c++",".net","clr","clr-hosting"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":150,"score":3,"question_id":9758404,"title":"Is there a common way for C# and unmanaged native C++ to determine installed CLR versions?","body":"<p>As the title says: Is there a <strong>common way</strong> in C# and especially unmanaged native C++ to determine installed CLR versions? This means not just checking whether the Framework is installed according <a href=\"http://msdn.microsoft.com/en-us/kb/kbarticle.aspx?id=318785\" rel=\"nofollow\">this KB article</a>. I want to do it by using the CLR interface, as done <a href=\"http://blogs.msdn.com/b/junfeng/archive/2005/07/07/436755.aspx\" rel=\"nofollow\">here</a> for CLR1, CLR1.1 and CLR2. In this way I can make sure that they are really installed. But this doesn't apply to CLR4. Any Ideas?</p>\n\n<p>My goal is to create an enumeration of available CLR versions like <a href=\"http://msdn.microsoft.com/library/ff427522.aspx\" rel=\"nofollow\">Clrver</a> (regardless the process list functionallity) does.</p>\n"},{"tags":["c#",".net","performance","sockets"],"answer_count":11,"favorite_count":20,"up_vote_count":17,"down_vote_count":0,"view_count":15590,"score":17,"question_id":319732,"title":"Tips / techniques for high-performance C# server sockets","body":"<p>I have a .NET 2.0 server that seems to be running into scaling problems, probably due to poor design of the socket-handling code, and I am looking for guidance on how I might redesign it to improve performance.</p>\n\n<p><strong>Usage scenario:</strong> 50 - 150 clients, high rate (up to 100s / second) of small messages (10s of bytes each) to / from each client. Client connections are long-lived - typically hours. (The server is part of a trading system. The client messages are aggregated into groups to send to an exchange over a smaller number of 'outbound' socket connections, and acknowledgment messages are sent back to the clients as each group is processed by the exchange.) OS is Windows Server 2003, hardware is 2 x 4-core X5355. </p>\n\n<p><strong>Current client socket design:</strong> A <code>TcpListener</code> spawns a thread to read each client socket as clients connect. The threads block on <code>Socket.Receive</code>, parsing incoming messages and inserting them into a set of queues for processing by the core server logic. Acknowledgment messages are sent back out over the client sockets using async <code>Socket.BeginSend</code> calls from the threads that talk to the exchange side.</p>\n\n<p><strong>Observed problems:</strong> As the client count has grown (now 60-70), we have started to see intermittent delays of up to 100s of milliseconds while sending and receiving data to/from the clients. (We log timestamps for each acknowledgment message, and we can see occasional long gaps in the timestamp sequence for bunches of acks from the same group that normally go out in a few ms total.) </p>\n\n<p>Overall system CPU usage is low (&lt; 10%), there is plenty of free RAM, and the core logic and the outbound (exchange-facing) side are performing fine, so the problem seems to be isolated to the client-facing socket code. There is ample network bandwidth between the server and clients (gigabit LAN), and we have ruled out network or hardware-layer problems.</p>\n\n<p>Any suggestions or pointers to useful resources would be greatly appreciated. If anyone has any diagnostic or debugging tips for figuring out exactly what is going wrong, those would be great as well.</p>\n\n<p><em>Note: I have the MSDN Magazine article <a href=\"http://msdn2.microsoft.com/en-us/magazine/cc300760.aspx\" rel=\"nofollow\">Winsock: Get Closer to the Wire with High-Performance Sockets in .NET</a>, and I have glanced at the Kodart \"XF.Server\" component - it looks sketchy at best.</em></p>\n"},{"tags":["c#",".net","security","certificate","x509certificate"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":13206654,"title":"Certificates - More than 1 serial number?","body":"<p>weird : </p>\n\n<p>I use this code to find certificate via c# by this code : </p>\n\n<pre><code> X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);\n store.Open(OpenFlags.ReadOnly | OpenFlags.OpenExistingOnly);\n var certificates = store.Certificates;\n X509Certificate2Collection certificateCollection = store.Certificates.Find(X509FindType.FindBySerialNumber, \"the Serial Number\", false);\n</code></pre>\n\n<p>So I tested to see by an existing certificate : </p>\n\n<p><img src=\"http://i.stack.imgur.com/b2upF.jpg\" alt=\"enter image description here\"></p>\n\n<p>but it didn't worked (as mentioned in the linked question). ( Also tried  , remove spaces , capital etc... - non worked).</p>\n\n<p>But when I played with it a bit I found <strong>another serial location</strong> : </p>\n\n<p><img src=\"http://i.stack.imgur.com/WS4TB.jpg\" alt=\"enter image description here\"></p>\n\n<p>this time just pasted the exact phrase  <code>\"4e a1 ae 96 ec 1a b6 82 4e f6 23 9a 16 04 1a 51\"</code> and it <strong>worked</strong> .</p>\n\n<p>What is going on here ? </p>\n\n<p>why there are 2 different serial numbers and what are the differences between them  ? </p>\n\n<p><em>p.s. , However , not all certificates has the \"Authority Key Identifier \" , so there's still a problem finding by other properties...</em></p>\n"},{"tags":[".net","xaml","binding","windows-8","winrt"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13208240,"title":"Dictionary<String, String> not binding in xaml (Metro App)","body":"<p>I've got a problem get binding working in an DataTemplate of a ListView. My binding target is a KeyValuePair. (I work with Metro App for Windows 8)</p>\n\n<p>I have an Dictionary</p>\n\n<pre><code>Params = new Dictionary&lt;string, string&gt;();\nParams.Add(\"Key1\", \"Value1\");\nParams.Add(\"Key1\", \"Value2\");\n</code></pre>\n\n<p>I try bind it:</p>\n\n<pre><code>&lt;ListView ItemsSource=\"{Binding Params}\"&gt;\n    &lt;ListView.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n           &lt;TextBlock Text=\"{Binding Key}\"&gt;&lt;/TextBlock&gt;\n           &lt;TextBlock Text=\"{Binding Value}\"&gt;&lt;/TextBlock&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListView.ItemTemplate&gt;\n&lt;/ListView&gt;\n</code></pre>\n\n<p>But KeyPairValue dont react on this (nothing bind). But if i do that binding:</p>\n\n<pre><code>&lt;ListView ItemsSource=\"{Binding Params}\"&gt;\n    &lt;ListView.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n           &lt;TextBlock Text=\"{Binding}\"&gt;&lt;/TextBlock&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListView.ItemTemplate&gt;\n&lt;/ListView&gt;\n</code></pre>\n\n<p>I see:\n<img src=\"http://i.stack.imgur.com/UBfOb.png\" alt=\"enter screenshot xaml binding\"></p>\n\n<p>Early this binding work correctly in app for Windows Phone 7. What happened in Windows 8?</p>\n"},{"tags":["c#","javascript",".net","date"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":61,"score":-2,"question_id":13207887,"title":"Date format issue in C#","body":"<p>I get a date in C# from javascript in this format:</p>\n\n<p><code>\"Tue Jan 15 00:00:00 UTC+0530 2008\"</code>. </p>\n\n<p>How can I convert this to <code>\"dd/MMM/yyyy\"</code> format?</p>\n"},{"tags":[".net","api","gtalk","messenger"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":6,"score":1,"question_id":13208168,"title":"GTalk API in asp,net","body":"<p>I would like to build an asp.net web application that uses GTalk / Yahoo messenger api that sends a predefined message to a server and receive back confirmation message from the other end. I want to implement it without using any gui(messenger/gtalk ), but want to implement it through api calls only.</p>\n\n<p>Your help is much appreciated</p>\n"},{"tags":[".net","vb.net","linq","system.reactive"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":60,"score":4,"question_id":13196159,"title":"LINQ with RX Extensions","body":"<p>I was under the impression that the LINQ query language worked for IObservable as it does for IEnumerable with the ReactiveExtensions. I have the following code</p>\n\n<pre><code>Public Sub Foo(source As IObservable(Of Tuple(Of Integer, Integer)))\n  Dim filtered = source.Where(Function(x) x.Item1 &gt; 10).Select(Function(x) x.Item1 + x.Item2)\n  Dim filtered2 = From x In source Where x.Item1 &gt; 10 Select x.Item1 + x.Item2\nEnd Sub\n\nPublic Sub Bar(source As IEnumerable(Of Tuple(Of Integer, Integer)))\n  Dim filtered = source.Where(Function(x) x.Item1 &gt; 10).Select(Function(x) x.Item1 + x.Item2)\n  Dim filtered2 = From x In source Where x.Item1 &gt; 10 Select x.Item1 + x.Item2\nEnd Sub\n</code></pre>\n\n<p>The code for the IEnumerable version is OK. However for the LINQ version of Foo ( second line )\nI get a late binding disallowed error on</p>\n\n<pre><code>x.Item1\n</code></pre>\n\n<p>When I hover over <strong>x</strong> the Intellisense says it is of type object instead of\ntype tuple. However the object query version of the same operation ( first line )\ncompiles ok. I've imported</p>\n\n<pre><code>Imports system.reactive.linq\n</code></pre>\n\n<p>Am I missing another reference?</p>\n"},{"tags":[".net","wpf",".net-assembly"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13199498,"title":"Access resources of different assembly","body":"<p>My program has the following structure where the boxes represent assemblies and the arrows represent references:</p>\n\n<p><img src=\"http://i.stack.imgur.com/BGddE.png\" alt=\"Assembly structure\"></p>\n\n<p>The <code>WpfElements</code> assembly contains a resource dictionary in its Resources.xaml, which contains some styles:</p>\n\n<pre><code>&lt;ResourceDictionary x:Key=\"DialogDockStyle\"&gt;\n    ...\n&lt;/ResourceDictionary&gt;\n</code></pre>\n\n<p>The <code>WpfControls</code> assembly contains a window, which references these styles:</p>\n\n<pre><code>&lt;StackPanel ... Resources=\"{StaticResource DialogDockStyle}\"&gt;\n</code></pre>\n\n<p>The <code>Server</code> and <code>Client</code> assemblies are executables that instantiate this window and display it.</p>\n\n<p>This works great for the <code>Server</code>. The window is displayed and can be used. However, when the same code is run from the <code>Client</code>, an error occures instantiating the window:</p>\n\n<blockquote>\n  <p>The resource with the name \"DialogDockStyle\" cannot be found.</p>\n</blockquote>\n\n<p>It is a bit weird that is works from one assembly and not from the other. Is there anything I might have overseen to make it work from both assemblies?</p>\n"},{"tags":["c#",".net","visual-studio","visual-studio-2012"],"answer_count":8,"favorite_count":8,"up_vote_count":34,"down_vote_count":0,"view_count":3717,"score":34,"question_id":11988077,"title":"Plain C# Editor in Visual Studio 2012 (No intellisense, no indentation, no code highlighting)","body":"<p>I just installed visual studio 2012 in my machine, I previously had visual studio 2012 RC which I uninstalled before. The installation was successful, but after I open a project the C# editor is not working, is just like a plain text editor like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/qOX52.png\" alt=\"C# editor\"></p>\n\n<p>I've tried repairing it, uninstalling it completely and then installing again, but no success.</p>\n\n<p>Anyone have an idea?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I don't know if it is related, but I'm also getting this error <strong>sometimes</strong> when creating a new project or when opening an existing one:</p>\n\n<pre><code>Project 'ConsoleApplication3' could not be opened because the Visual C# 2012 compiler could not be created. Error creating instance of managed object 'Microsoft.VisualStudio.CSharp.Services.Language.ManagedObjectFactory' (Error code is 0x80131513)\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/bwx2d.png\" alt=\"Vs error\"></p>\n\n<p>Thanks in advance</p>\n"},{"tags":["c#",".net","winforms","c#-4.0","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13207303,"title":"filter dataset based on the selected values in ComboBox","body":"<p>In my application I am trying to use <code>RowFilter</code> or <code>Select</code> methods of <code>DataSet</code> to show the values selected by the User in <code>ComboBox</code>. The <code>DataSet</code> has five columns hence my project has five <code>ComboBoxes</code> populated with same values of columns of <code>DataSet</code> respectively. Now I am trying to search the user selected values in the DataSet and populate in DataGridView. I have tried the below: (<em>not working</em>)</p>\n\n<pre><code>dgvMain.DataSource = null;\ndgvMain.DataSource = dsMainDoctors.Tables[0].Select(\"Name = '\" + cmbDoctorName.Text +\"'\");\n</code></pre>\n\n<p><strong>or</strong>                </p>\n\n<pre><code>dgvMain.DataSource = null;\ndgvMain.DataSource = dsMainDoctors.Tables[0].DefaultView.RowFilter = \"Name = '\" + cmbDoctorName.Text + \"'\";\n</code></pre>\n\n<p>The first attempt is not showing anything but the second one is showing something like the below image instead of showing columns. Here I am trying to search with only one column value, but I need to search with three different columns of <code>DataSet</code> how to do that?</p>\n\n<p><img src=\"http://i.stack.imgur.com/IFIRa.png\" alt=\"enter image description here\"></p>\n\n<p>I know I am doing something wrong in my code. please suggest what should I do to correct my code. Please no linq because it is restricted by my head members. but all type of anwswers are welcome.</p>\n"},{"tags":[".net","session","web-security","session-cookies"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":13144125,"title":"Terminate session identifier on server","body":"<p>We have had a security test against our site, and a vulnerability has been identified.</p>\n\n<p><strong>Issue</strong></p>\n\n<blockquote>\n  <p>If the session identifier were known by an attacker who had access to\n  the user's workstation, the logged out session could be accessed using\n  the session cookie after the user had terminated their session. </p>\n</blockquote>\n\n<p><strong>Recommendation</strong></p>\n\n<blockquote>\n  <p>Ensure that session identifiers are correctly terminated on the server\n  side when the logout function is invoked.</p>\n</blockquote>\n\n<p><strong>Code</strong></p>\n\n<p>The code currently does this (if a user clicks the \"logout button\")</p>\n\n<pre><code>        FormsAuthentication.SignOut();\n        Roles.DeleteCookie();\n        Session.Clear();\n</code></pre>\n\n<p>I'm not sure how to check \"ensure that session identifiers are correctly terminated on the server side when the logout function is invoked.\" </p>\n\n<p>I've done some research and think I should I be doing this instead?</p>\n\n<pre><code>        Session.Abandon();\n</code></pre>\n\n<p>If not, what should I be doing? (I'm not entirely sure how to test this...)</p>\n"},{"tags":["c#",".net","sql-server-2008","ado.net","vsts2008"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":1726,"score":1,"question_id":1587036,"title":"SQL Server communication protocol issue","body":"<p>I am using VSTS 2008 + C# + ADO.Net + SQL Server 2008. My questions about what kinds of communication protocols SQL Server 2008 will be using, more details of my questions,</p>\n\n<ol>\n<li><p>If the connection string looks like this, whether Named Pipe or TCP/IP is used? Will different communication protocol being used dependent on whether client and SQL Server on the same machine?</p>\n\n<p>Data Source=labtest1;Initial Catalog=CustomerDB;Trusted_Connection=true;Asynchronous</p></li>\n<li><p>In SQL Server Configuration Manager, there are items called \"SQL Server Network Configuration\" and \"SQL Native Client 10.0 Configuration\". I find both of them has configuration options (for communication protocols) of Named Pipe or TCP/IP, what are the differences between \"SQL Server Network Configuration\" and \"SQL Native Client 10.0 Configuration\"?</p></li>\n</ol>\n\n<p>thanks in advance,\nGeorge</p>\n"},{"tags":[".net","vb.net","parsing","csv"],"answer_count":12,"favorite_count":9,"up_vote_count":18,"down_vote_count":0,"view_count":21830,"score":18,"question_id":736629,"title":"Parse Delimited CSV in .NET","body":"<p>I have a text file that is in a comma separated format, delimited by <code>\"</code> on most fields.  I am trying to get that into something I can enumerate through (Generic Collection, for example).  I don't have control over how the file is output nor the character it uses for the delimiter.</p>\n\n<p>In this case, the fields are separated by a comma and text fields are enclosed in <code>\"</code> marks.  The problem I am running into is that some fields have quotation marks in them (i.e. 8<code>\"</code> Tray) and are accidentally being picked up as the next field.  In the case of numeric fields, they don't have quotes around them, but they do start with a + or a - sign (depicting a positive/negative number).  </p>\n\n<p>I was thinking of a RegEx, but my skills aren't that great so hopefully someone can come up with some ideas I can try.  There are about 19,000 records in this file, so I am trying to do it as efficiently as possible.  Here are a couple of example rows of data:</p>\n\n<p>\"00\",\"000000112260   \",\"Pie Pumpkin                             \",\"RET\",\"6.99 \",\"     \",\"ea \",+0000000006.99000\n\"00\",\"000000304078   \",\"Pie Apple caramel                       \",\"RET\",\"9.99 \",\"     \",\"ea \",+0000000009.99000\n\"00\",\"StringValue here\",\"8\" Tray of Food                             \",\"RET\",\"6.99 \",\"     \",\"ea \",-00000000005.3200</p>\n\n<p>There are a lot more fields, but you can get the picture....  </p>\n\n<p>I am using VB.NET and I have a generic List setup to accept the data.  I have tried using <a href=\"http://www.codeproject.com/KB/database/CsvReader.aspx\" rel=\"nofollow\">CSVReader</a> and it seems to work well until you hit a record like the 3rd one (with a quote in the text field).  If I could somehow get it to handle the additional quotes, than the CSVReader option will work great.  </p>\n\n<p>Thanks!</p>\n"},{"tags":[".net","visual-studio-2010","ms-access","dataset"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13205248,"title":"Why will not my child record relate to my parent record in dataset saved to Access?","body":"<p>So I have an MS Access DB with a parent table:</p>\n\n<pre><code>ID Autonumber\nDescription Text\n</code></pre>\n\n<p>A child table:</p>\n\n<pre><code>ID AutoNumber \nDescription Text \nParentID Number\n</code></pre>\n\n<p>I have created relationships:</p>\n\n<pre><code>Parent column: ID\nChild column: ParentID\nEnforce Ref Integrity, Cascade Update and Cascade Delete\n</code></pre>\n\n<p>I have dropped this into Visual Studio 2010, and the  wizard has created DataSets and Adapters.\nI have modified the xsd to set the relationsship to <code>Both Relation and Foreign Key Constraint</code> and <code>Update/Delete</code> rules to <code>Cascade</code>.</p>\n\n<p>So I try to add a parent record with an associated child record:</p>\n\n<pre><code>var taParent = new TestDataSetTableAdapters.ParentTableAdapter();\nvar taChild = new TestDataSetTableAdapters.ChildTableAdapter();\nvar ds = new TestDataSet();\ntaParent.Fill(ds.Parent);\ntaChild.Fill(ds.Child);\n\nvar rowParent = ds.Parent.NewParentRow();\nrowParent.Description = DateTime.Now.ToString();\nds.Parent.AddParentRow(rowParent);\n\nvar rowChild = ds.Child.NewChildRow();\nrowChild.ChildText = DateTime.Now.ToString();\nds.Child.AddChildRow(rowChild);\n\ntaParent.Update(ds);\nvar parentId = rowParent.ID;  // &lt;-- This is still -1\n// taParent.Fill(ds.Parent);  // &lt;-- Doing this hoping to reload the parent record gives:  Cannot clear table Parent because ForeignKeyConstraint ParentChild enforces constraints and there are child rows in Child.\n\ntaChild.Update(ds.Child);\n</code></pre>\n\n<p>but the child records ParentID is null.  </p>\n\n<p>If I try to:</p>\n\n<pre><code>rowChild.SetParentRow(rowParent);\n</code></pre>\n\n<p>I'll get<br>\n<code>You cannot add or change a record because a related record is required in table 'Parent'.</code></p>\n\n<p>What am I missing?</p>\n"},{"tags":["c#",".net","sockets","serialization","response"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13206892,"title":"Is it possible to communicate with streams and sockets?","body":"<p>I have a small question. Is it possible to serialize Stream(NetworkStream) or Socket and send it to another computer?\nI have this situation: </p>\n\n<p>There are two applications. First listens on specified port and reads the request. After that, the second should receive the request, process it and send the response. The problem is that connection shouldn't be closed. Alternative is to send request to second application and wait for response without closing the connection.</p>\n\n<p>How can I solve this problem? My first solutions was to serialize stream or socket, but it doesn't look good.\nPlease help</p>\n"},{"tags":[".net","c#-4.0"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13177292,"title":".net: dynamically generate table in SQL database from Excel sheet","body":"<p>In my project I have to create a database table based on an uploaded Excel sheet. So can anyone tell me how to dynamically generate a table in SQL database from the Excel sheet, once that file has been uploaded using the file upload control of asp.net?</p>\n\n<p>For example, I have an Excel sheet <code>sheet1.xlsx</code> like this</p>\n\n<pre><code>ID   Name  MoblieNO\n1    xyz   1234\n2    zxy   5678\n3    abc   9012\n</code></pre>\n\n<p>after uploading the file, it should create a table in sql database with same no of columns and same datatypes.</p>\n"},{"tags":["c#",".net","dotnetzip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":447,"score":0,"question_id":2665644,"title":"DotNetZip trouble with russian encoding","body":"<p>i use DotNetZip in my project. </p>\n\n<pre><code>using (var zip = new ZipFile()) \n{ \n   zip.ProvisionalAlternateEncoding = System.Text.Encoding.GetEncoding(866); \n   zip.AddFile(filename, \"directory\\\\in\\\\archive\"); \n   zip.Save(\"archive.zip\"); \n} \n</code></pre>\n\n<p>all ok but when i use method AddDirectoryByName i have a bad directory names.</p>\n"},{"tags":[".net","vb.net","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13203106,"title":"Selecting the Hello World Message By Its HTML Tags with the URL Request?","body":"<p>The URL Request:</p>\n\n<pre><code>http://localhost:1430/Home/TheMessageView\n</code></pre>\n\n<p>Also:</p>\n\n<pre><code>http://localhost:1430/Home/TheMessageView/{Parameter}\n</code></pre>\n\n<p>Home is the controller.\nTheMessageView is the view (as a VBHTML file type).</p>\n\n<p>The HTML Tags with Its Content:</p>\n\n<p>The to be called up messages are held in a View as follows:</p>\n\n<pre><code>&lt;h2&gt;The Hello World Message Headline&lt;/h2&gt;    \n&lt;p&gt;This Hello World message in the paragraph here.&lt;/p&gt;\n</code></pre>\n\n<p>The Question:</p>\n\n<p><strong>Reformulated:</strong>\nThe intention is to narrow it down till to the preferred HelloWorld message by selecting the HTML tag. Where the message is to be printed on the screen.</p>\n"},{"tags":["c#","asp.net",".net","timer"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13206581,"title":"Click button automatically at regular intervals","body":"<p>I have a web application that generates enlarged images of smaller images uploaded by other team and stops if no image is left in uploaded folder.</p>\n\n<p>A button needs to be clicked to start generating image and restart every time it finishes.</p>\n\n<p>Can this click event be fired automatically at regular interval say at 15 minutes or better still just as the application stops.</p>\n\n<p>A similar question was asked on earlier thread <a href=\"http://stackoverflow.com/questions/7764812/how-to-write-c-sharp-scheduler\">How to write C# Scheduler</a> . </p>\n\n<pre><code>private void OnTimerTick()\n{\n    if (DateTime.Now.Minutes % 15 == 0)\n    {\n        // Do something\n    }\n}\n</code></pre>\n\n<p>Where should I place timer to call below code ?</p>\n\n<pre><code>protected void btnImgGenerate_click()\n{\n    // Application code\n}\n</code></pre>\n\n<p>Is there a way to check whether a web application in asp.net has stopped executing and then restart it automatically? </p>\n\n<p>Using timer, I can schedule application to start and stop at specific time of day and keep application running throughout specified duration of day using second method.</p>\n"},{"tags":["c#",".net","wpf","performance"],"answer_count":3,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":3683,"score":10,"question_id":3022921,"title":"WPF DataGrid performance concerns","body":"<p>I am testing WPF DataGrid in hopes of replacing some winforms controls, and so far have been very pleased with the development process. Performance seems to be my biggest concern right now. My development workstation has just about the best cpu on the market running windows 7, with 6 gigs of DDR3 memory. The windows control i am replacing is considerably more responsive which is worrisome.</p>\n\n<p>My test is a basic implementation of DataGrid bound to ObservableCollection which gets updated once per second. It also includes Details area which is expandable to reveal more info about each row. Details area is just a stackpanel with a ItemsControl wrapping TextBlock (which repeats 6 times)</p>\n\n<p>My complaint is that if i try to scroll this collection, it is often jerky with lag, and if i try to expand each row as they come in, about 15% of clicks do not trigger buttons click event (DataGridTmplateColumn > CellTemplate > DataTemplate > Button)\nAlso scrolling is more jittery if some rows detail is expanded (with scroll bar that resizes it self as it goes up/down)</p>\n\n<p>what are some things to look for / optimize / avoid ? </p>\n\n<p><strong>update</strong></p>\n\n<p>here are some points i found helpful so far: </p>\n\n<ul>\n<li><p>rely as little as possible on dynamic layout. as each component contains many subcomponents and in dynamic layout world, all of them have to call Measure and Layout methods which can be cpu intensive. so instead of column width Auto (or no width specified), use fixed widths</p></li>\n<li><p>install <a href=\"http://msdn.microsoft.com/en-us/library/aa969767.aspx#installing_the_wpf_performance_suite\" rel=\"nofollow\">WPF Performance Suite</a> and get in touch with how your app is rendered. trully awesome app</p></li>\n<li><p>as Andrew pointed out ListView is a great alternative, for when you don't need advanced DataGrid features, such as updating the data back, or possibly Details View (which i am still hoping to reproduce)</p></li>\n<li><p>also <a href=\"http://stackoverflow.com/questions/2460557/itemscontrol-itemssource-mvvm-performance\">SuspendableObservableCollection</a> is ideal for when you're adding multiple items in very short period of time (i.e. 100 items in 0.01 second etc) </p></li>\n<li><p>after lots of testing, i found that BindingList is much faster than ObservableCollection . I posted performance profiler snapshots <a href=\"http://stackoverflow.com/questions/3305383/wpf-whats-the-most-efficient-fast-way-of-adding-items-to-a-listview\">here</a> of the same load handled by BindingList vs Observable collection, and the former takes less than half cpu time. (keep in mind that this is not just collection performance, but when paired with a ListView)</p></li>\n</ul>\n\n<p>my search still continues as something appears to be leaking memory in my app and slows it down to a halt after couple hours.</p>\n"},{"tags":["c#",".net","wpf","testing","ui-automation"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1602,"score":1,"question_id":6554494,"title":"How can I send a right-click event to an AutomationElement using WPF's UI automation?","body":"<p>Using WPF's built-in UI automation, it's easy (though pretty verbose) to send a left-click event to an AutomationElement (such as a Button):</p>\n\n<pre><code>InvokePattern invokePattern = (InvokePattern) element.GetCurrentPattern(InvokePattern.Pattern);\ninvokePattern.Invoke();\n</code></pre>\n\n<p>However, there seems to be no built-in way to send right-clicks to the same element. I've resigned myself to using P/Invoke to call <a href=\"http://msdn.microsoft.com/en-us/library/ms646310%28v=vs.85%29.aspx\" rel=\"nofollow\">SendInput</a>, but I can't get it to work. With the code below, when I call RightClick(), a context menu pops up right where the cursor is, rather than at the element I expect to be right-clicked. So it seems like it's ignoring the coordinates I hand in and just using the current cursor location.</p>\n\n<pre><code>public static void RightClick(this AutomationElement element)\n{\n    Point p = element.GetClickablePoint();\n\n    NativeStructs.Input input = new NativeStructs.Input\n    {\n        type = NativeEnums.SendInputEventType.Mouse,\n        mouseInput = new NativeStructs.MouseInput\n        {\n            dx = (int) p.X,\n            dy = (int) p.Y,\n            mouseData = 0,\n            dwFlags = NativeEnums.MouseEventFlags.Absolute | NativeEnums.MouseEventFlags.RightDown,\n            time = 0,\n            dwExtraInfo = IntPtr.Zero,\n        },\n    };\n\n    NativeMethods.SendInput(1, ref input, Marshal.SizeOf(input));\n\n    input.mouseInput.dwFlags = NativeEnums.MouseEventFlags.Absolute | NativeEnums.MouseEventFlags.RightUp;\n\n    NativeMethods.SendInput(1, ref input, Marshal.SizeOf(input));\n}\n\ninternal static class NativeMethods\n{\n    [DllImport(\"user32.dll\", SetLastError = true)]\n    internal static extern uint SendInput(uint nInputs, ref NativeStructs.Input pInputs, int cbSize);\n}\n\ninternal static class NativeStructs\n{\n    [StructLayout(LayoutKind.Sequential)]\n    internal struct Input\n    {\n        public NativeEnums.SendInputEventType type;\n        public MouseInput mouseInput;\n    }\n\n    [StructLayout(LayoutKind.Sequential)]\n    internal struct MouseInput\n    {\n        public int dx;\n        public int dy;\n        public uint mouseData;\n        public NativeEnums.MouseEventFlags dwFlags;\n        public uint time;\n        public IntPtr dwExtraInfo;\n    }\n}\n\ninternal static class NativeEnums\n{\n    internal enum SendInputEventType : int\n    {\n        Mouse = 0,\n        Keyboard = 1,\n        Hardware = 2,\n    }\n\n    [Flags]\n    internal enum MouseEventFlags : uint\n    {\n        Move = 0x0001,\n        LeftDown = 0x0002,\n        LeftUp = 0x0004,\n        RightDown = 0x0008,\n        RightUp = 0x0010,\n        MiddleDown = 0x0020,\n        MiddleUp = 0x0040,\n        XDown = 0x0080,\n        XUp = 0x0100,\n        Wheel = 0x0800,\n        Absolute = 0x8000,\n    }\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","gridview"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13206160,"title":"Is it possible to edit a GridView cell without an edititemtemplate?","body":"<pre class=\"lang-xml prettyprint-override\"><code>&lt;asp:GridView ID=\"GridView1\" runat=\"server\"&gt;\n    &lt;Columns&gt;\n        &lt;asp:TemplateField&gt;\n            &lt;ItemTemplate&gt;\n                &lt;asp:LinkButton ID=\"LinkButton1\" runat=\"server\" OnClick=\"lclick\"&gt;Buy&lt;/asp:LinkButton&gt;\n            &lt;/ItemTemplate&gt;\n    &lt;edititemtemplate&gt;\n        &lt;asp:Textbox runat=\"server\" id=\"txt\"/&gt;\n    &lt;edititemtemplate&gt;\n        &lt;/asp:TemplateField&gt;\n    &lt;/Columns&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>Is it possible to edit the <code>GridView</code> without the <code>edititem</code> Template?</p>\n"},{"tags":["c#",".net","mvvm","visual-studio-extensions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13206492,"title":"Any Extension to jump from View to ViewModel and vice-versa in MVVM (WPF)","body":"<p>I am using MVVM Pattern (in WPF with C# and VB.Net) for quite some time but is there a way to jump to view from viewmodel or vice-versa in Visual Studio without using Solution Explorer/Navigator.</p>\n\n<p>In its extension dialog we can link up the two. It can be used like we jump from view to codebehind/designer and viceversa like as shown in image</p>\n\n<p><img src=\"http://i.stack.imgur.com/Ecbdq.jpg\" alt=\"enter image description here\"></p>\n\n<p>Is there any visual studio extension like this out there?</p>\n"},{"tags":[".net","workflow-foundation-4","statemachine"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":72,"score":3,"question_id":13108099,"title":"WF4: Validate that all exit statuses of activity has transitions to other activities","body":"<p>We are trying to change our business process so that it is implemented via WF4.\nOur business process looks like this:</p>\n\n<ul>\n<li>There are a number of handlers. </li>\n<li>Each handler has a number of output statuses.</li>\n<li>Handlers are implemented as Activities</li>\n<li>Designers will support output statuses of these activities so that\n<ul>\n<li>we can easily see what statuses cause what next activities</li>\n<li>we can validate at compile time that all statuses of each activity are connected with some other activity.</li>\n</ul></li>\n</ul>\n\n<p>How can we achieve this in WF4?</p>\n"},{"tags":["c#",".net","json","wcf","wcf-ria-services"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13206079,"title":"How to get the response and request in JSON format?","body":"<p>I'm not getting the output in JSON Format. Here is the code</p>\n\n<p>---- <strong>IService1.cs</strong> ----</p>\n\n<pre><code>[ServiceContract]\npublic interface IService1\n{\n    [OperationContract]\n    [WebInvoke(Method = \"GET\", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Bare, UriTemplate = \"currency\")]\n    List&lt;Employee&gt; GetAllEmployeesMethod();\n\n     [OperationContract]\n     string TestMethod();\n\n     [OperationContract]\n     [WebInvoke(Method = \"GET\", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json, UriTemplate = \"players\")]\n     List&lt;Person&gt; GetPlayers();\n\n}\n</code></pre>\n\n<p>---- <strong>Service1.svc.cs</strong> ----</p>\n\n<pre><code>public List&lt;Employee&gt; GetAllEmployeesMethod()\n{\n    List&lt;Employee&gt; mylist = new List&lt;Employee&gt;();\n\n    using (SqlConnection conn = new SqlConnection(\"--connection string--\"))\n    {\n        conn.Open();\n\n        string cmdStr = String.Format(\"Select customercode,CurrencyCode,CurrencyDesc from Currency\");\n        SqlCommand cmd = new SqlCommand(cmdStr, conn);\n        SqlDataReader rd = cmd.ExecuteReader();\n\n        if (rd.HasRows)\n        {\n            while (rd.Read())\n                mylist.Add(new Employee(rd.GetInt32(0), rd.GetString(1), rd.GetString(2)));\n        }\n        conn.Close();\n    }\n\n\n    return mylist;\n}\n</code></pre>\n\n<p>---- <strong>web.config</strong> ----</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>  &lt;?xml version=\"1.0\"?&gt;\n  &lt;configuration&gt;\n &lt;appSettings/&gt;\n &lt;connectionStrings/&gt;\n &lt;system.web&gt;\n&lt;compilation debug=\"true\" targetFramework=\"4.0\"/&gt;   \n&lt;authentication mode=\"Windows\"/&gt;    \n\n&lt;pages controlRenderingCompatibilityVersion=\"3.5\" clientIDMode=\"AutoID\"/&gt;\n&lt;/system.web&gt;\n &lt;system.webServer&gt;\n&lt;directoryBrowse enabled=\"true\"/&gt;\n&lt;/system.webServer&gt;\n &lt;system.serviceModel&gt;\n&lt;services&gt;\n  &lt;service name=\"JSONSerialization.Service1\" behaviorConfiguration=\"EmpServiceBehaviour\"&gt;\n    &lt;!-- Service Endpoints --&gt;\n    &lt;endpoint address=\"\" binding=\"webHttpBinding\" contract=\"JSONSerialization.IService1\" behaviorConfiguration=\"web\" &gt;\n    &lt;/endpoint&gt;\n    &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\"/&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"EmpServiceBehaviour\"&gt;        \n      &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;          \n      &lt;serviceDebug includeExceptionDetailInFaults=\"false\"/&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n  &lt;endpointBehaviors&gt;\n    &lt;behavior name=\"web\"&gt;\n      &lt;webHttp automaticFormatSelectionEnabled=\"true\" defaultOutgoingResponseFormat=\"Json\" helpEnabled=\"true\" defaultBodyStyle=\"Bare\"/&gt;          \n    &lt;/behavior&gt;\n  &lt;/endpointBehaviors&gt;\n  &lt;/behaviors&gt;   \n  &lt;/system.serviceModel&gt;  \n  &lt;/configuration&gt;\n</code></pre>\n\n<p>and when I run this service, I get the data in \n<img src=\"http://i.stack.imgur.com/Bt4Pq.jpg\" alt=\"out put\"></p>\n\n<p>but I want the result to be in JSON format \n<br><strong>Example:</strong> <code>{\"currencycode\":\"INR\",\"DESCRIPTION\":\"Indian Rupees\",\"customercode\" : \"1001\"},....</code></p>\n"},{"tags":["c#",".net","excel","date","format"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":746,"score":4,"question_id":5386488,"title":"Read data from Excel","body":"<p>I have been trying to read data from an excel file. It has been successful, but I enountered a problem. Whenever the format of the cell and the data entered in the cell is not matching then I get empty data</p>\n\n<p><strong><br>e.g<br></strong></p>\n\n<p>If the data cell is formatted as Date - <code>dd/mm/yyyy</code>, and the user enters <code>13/17/2011</code>, the as the date format and the date entered is contradictory so the excel gives me entirely empty cell. Only if the cell format is text I get the data as entered.</p>\n\n<p>Why is the excel file giving me empty cell in case the entered date format is not complying with the cell format set?</p>\n\n<p>This is the code that reads the excel data</p>\n\n<pre><code>if(fileEXT.Equals(\".xls\"))\n{\n   oledbConn = new OleDbConnection(\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"+Server.MapPath(\"../Portal_Docs/UploadDocs/\"+filename+\"\")+\";Extended Properties=Excel 8.0\");\n}\nelse if(fileEXT.Equals(\".xlsx\"))\n{\n   oledbConn = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"+Server.MapPath(\"../Portal_Docs/UploadDocs/\"+filename+\"\")+\";Extended Properties=\\\"Excel 12.0;HDR=YES;\\\"\");\n}\nelse if(fileEXT.Equals(\".xlsm\"))\n{\n   oledbConn = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"+Server.MapPath(\"../Portal_Docs/UploadDocs/\"+filename+\"\")+\";Extended Properties=Excel 12.0 Macro\");\n}\n\noledbConn.Open();\nOleDbCommand cmd = new OleDbCommand(\"SELECT * FROM [Sheet1$]\", oledbConn);\nOleDbDataAdapter oleda = new OleDbDataAdapter();\noleda.SelectCommand = cmd;\nDataSet ds = new DataSet();\noleda.Fill(ds,\"LocationDetails\");\n</code></pre>\n"},{"tags":["c#",".net","winforms","scrolling","flowlayoutpanel"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":887,"score":1,"question_id":2245012,"title":"How to scroll a flowlayoutpanel while dragging?","body":"<p>In my Windows Forms application, I'm using a FlowLayoutPanel control to display a list of items to users.  I've been able to successfully implement reordering the items in the FlowLayoutPanel by having the user drag the control to the desired position within the FlowLayoutPanel.  </p>\n\n<p>But I don't know how to scroll the FlowLayoutPanel when the user drags an item past the boundaries of the panel.  I've seen examples for ListView controls but those techniques don't seem to apply to the FlowLayoutPanel.</p>\n\n<p>Can someone provide sample code, preferably in c#, on how to implement this functionality?</p>\n\n<p>I can provide code examples of my current reordering methodology if desired.</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","multithreading","timer"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":79,"score":4,"question_id":13205024,"title":"Memory leak around timer delegate","body":"<p>Sometimes users wants to schedule a large set of timers and don't want to manage the references to those timers.\n<br>In case the user does not reference a timer, the timer may be collected by the GC before it was executed.\n<br>I created the class Timers to serve as a place holder for newly created timers:</p>\n\n<pre><code>static class Timers\n{\n    private static readonly ILog _logger = LogManager.GetLogger(typeof(Timers));\n\n    private static readonly ConcurrentDictionary&lt;Object, Timer&gt; _timers = new ConcurrentDictionary&lt;Object, Timer&gt;();\n\n    /// &lt;summary&gt;\n    /// Use this class in case you want someone to hold a reference to the timer.\n    /// Timer without someone referencing it will be collected by the GC even before execution.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"dueTime\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"action\"&gt;&lt;/param&gt;\n    internal static void ScheduleOnce(TimeSpan dueTime, Action action)\n    {\n        if (dueTime &lt;= TimeSpan.Zero)\n        {\n            throw new ArgumentOutOfRangeException(\"dueTime\", dueTime, \"DueTime can only be greater than zero.\");\n        }\n        Object obj = new Object();\n\n        Timer timer = new Timer(state =&gt;\n        {\n            try\n            {\n                action();\n            }\n            catch (Exception ex)\n            {\n                _logger.ErrorFormat(\"Exception while executing timer. ex: {0}\", ex);\n            }\n            finally\n            {\n                Timer removedTimer;\n                if (!_timers.TryRemove(obj, out removedTimer))\n                {\n                    _logger.Error(\"Failed to remove timer from timers\");\n                }\n                else\n                {\n                    removedTimer.Dispose();\n                }\n            }\n        });\n        if (!_timers.TryAdd(obj, timer))\n        {\n            _logger.Error(\"Failed to add timer to timers\");\n        }\n        timer.Change(dueTime, TimeSpan.FromMilliseconds(-1));\n    }\n}\n</code></pre>\n\n<p>If I don't dispose the removed timer, it results with a memory leak.\n<br>Seems like someone is holding a reference to the Timer's delegate after the timer was removed from the <code>_timers</code> collection.</p>\n\n<p>The question is, why do I get a memory leak if I don't dispose the timer?</p>\n"},{"tags":["c#",".net","powershell","dns"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":44,"score":1,"question_id":13205463,"title":".NET GetHostByAddress aliases only showing up 8 entries","body":"<p>I need to get every CNAME record out from a single IP address input from our DNS server.\n<br>When I lookup:</p>\n\n<pre><code>[System.Net.Dns]::GetHostByAddress(\"81.95.243.81\").Aliases\n</code></pre>\n\n<p>It only gives me the same 8 aliases in return:</p>\n\n<pre><code>botexshop.dk\nbisamba.dk\nnordsoenoceanarium.dk\nwww.brandingcommunity.com\nbotexhome.dk\nbotexudstyr.dk\nbotexjylland.dk\nmarineacademy.dk\n</code></pre>\n\n<p>but I know that the IP address has over 69 CNAME records (please look here: <a href=\"http://www.dnsstuff.com/tools#reverseDns/type=ipv4&amp;&amp;value=81.95.243.81&amp;&amp;\" rel=\"nofollow\">Toolbox | DNSstuff | Reverse DNS Lookup Results for 81.95.243.81</a> )</p>\n\n<p>Why does the <code>GetHostByAddress</code> only return the same 8 aliases all the time? And how do I get all the CNAMEs ?</p>\n"},{"tags":["c#",".net","generics","reflection","parameters"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":30,"score":4,"question_id":13204901,"title":"How to reflect Generic Type Parameters in C# .NET","body":"<p>Consider the following generic classes</p>\n\n<pre><code>Dictionary&lt;TKey, TValue&gt;\n\nList&lt;T&gt;\n\nCustomHashMap&lt;K, V&gt;\n</code></pre>\n\n<p>Is it possible to reflect back the names given to the generic type parameters?</p>\n\n<p>For Example</p>\n\n<pre><code>\"TKey\", \"TValue\"\n\n\"T\"\n\n\"K\", \"V\"\n</code></pre>\n"},{"tags":["asp.net",".net","css","createuserwizard"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13205346,"title":"How can you remove the table-tags in CreateUserWizard control","body":"<p>I've customised the layout of the CreateUserWizard and I'm using css to style it.\nMy button is too far away from my form (as you can is).\nIt's because of the table-tags asp.net is displaying by default. Is there anyway to have a CreateUserWizard without tables?</p>\n\n<pre><code>&lt;table cellspacing=\"0\" cellpadding=\"0\" id=\"cphContent_CreateUserWizard1\" style=\"border-collapse: collapse; \"&gt;\n&lt;tbody&gt;\n&lt;tr style=\"height: 100%; \"&gt;\n&lt;td&gt;\n&lt;table cellspacing=\"0\" cellpadding=\"0\" style=\"height: 100%; width: 100%; border-collapse: collapse; \"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td style=\"height: 100%; width: 100%; \"&gt;\n&lt;fieldset&gt;\n...\n&lt;/fieldset&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["php",".net","xml","post","httpwebrequest"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":13205332,"title":"How to pass large amount of data to PHP page?","body":"<p>I have a <code>PHP</code> page which will accept about 5 strings as <code>POST</code> parameters.  This <code>PHP</code> page will be requested by a desktop app which will send the <code>POST</code> parameters each time.</p>\n\n<p>The desktop app may need to make this request about 10 times in succession, thereby sending 10 lots of the 5 strings in succession.</p>\n\n<p>Rather than having 10 <code>POST</code> requests in succession, is there a way to send this amount of data in one <code>HTTP</code> request?</p>\n\n<p>Could <code>XML</code> be used?  How would this be done in <code>.NET</code> and <code>PHP</code>?</p>\n\n<p>What are the pros and cons of putting it all in <code>XML</code>?</p>\n"},{"tags":["c#",".net","caching","temporary-files"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13101714,"title":"How can I create a temporary file to cache startup work for a library?","body":"<p>I am working on a C# library that performs some expensive computation on startup. I would like to cache this computation so that the cost isn't paid each time the application restarts (think EF and pre-compiled views). </p>\n\n<p>The information I would like to cache is easily writable to a file in text format. Thus, I would like to do the following when the library is invoked:</p>\n\n<ol>\n<li>Generate a unique hash of the configuration parameters.</li>\n<li>Check if there is a cache file for that hash. If so, read it in and use it to skip the setup computation. </li>\n<li>If not, perform the setup computation and generate an appropriate cache file named by a hash of the configuration parameters.</li>\n</ol>\n\n<p>Furthermore, I don't want to permanently litter the users' hard drive such files: I want them to be automatically cleaned up by the operating system (much like temporary files) to the extent that this is possible. </p>\n\n<p>Also, because this is a library I can't depend on other software being installed. Thus, I'd prefer a pure .NET solution.</p>\n\n<p>Can anyone point me to a good method/.NET APIs for doing something like this?</p>\n"},{"tags":[".net","visual-studio-2010","localization","ilmerge"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":48,"score":5,"question_id":12865931,"title":"Any way to get VS (2010) to accept PDBs after using ILMerge/Costura to combine assemblies?","body":"<p>This question has pertinence beyond my own case because anyone who has a localized application and has to deliver a standalone EXE has this problem-- they will want to use ILMerge (or Costura or some homebrew solution) to put localization DLLs (or any other assembly) into their EXE-- but once they do that, they can no longer debug their code.  The VS debugger will just refuse to accept the original PDB file generated for the original EXE, presumably because the ILMerge step either updates the checksum or changes the GUID.</p>\n\n<p>What I wonder is if there's any way around this.. like some little known ILMerge option, maybe?  It strikes me as a very common and unnecessary loss of debugging ability.</p>\n\n<p>I believe the only other way to debug such an app after localization is to maintain a parallel build option that uses the DLLs un-ILMerged, which is fine, unless you happen to want to debug the localization code itself (for example, me).. then you're really out of luck.  Can anyone think of other options?</p>\n\n<p>I also tried using Costura, but because localization DLLs all contain resources that are identically named (and are identical to the main resource AppName.resource), you can only add one such DLL to the References: subsequent ones are not allowed.  Is there some way to gimmick Costura into working? (if it could be made to work though, the PDB problem might not occur as the combination is part of the the visual studio build..?)</p>\n\n<p>Edit: I'm looking for ideas that result in a PDB/EXE match.  I realize you can hack the pdb in a hex editor.  The question specifically asks about ways to make the system work as intended, though.</p>\n"},{"tags":["c#",".net","drawing","paint"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13137587,"title":".NET control like Ms Paint with text effects","body":"<p>I'm trying to find a control (not necessarily free) that would allow my users to draw things. Something that has all the things Ms Paint has (pen, ellipse, rectangle, import image, add text, etc) with some additional photoshop effects for the text part at least.\nDo you know any available/easy to use ones?</p>\n\n<p>Thanks</p>\n"},{"tags":["c#",".net","deployment","ilmerge"],"answer_count":9,"favorite_count":15,"up_vote_count":27,"down_vote_count":0,"view_count":6750,"score":27,"question_id":9376,"title":"ILMerge Best Practices","body":"<p>Do you use ILMerge? Do you use ILMerge to merge multiple assemblies to ease deployment of dll's? Have you found problems with deployment/versioning in production after ILMerging assemblies together?</p>\n\n<p>I'm looking for some advice in regards to using ILMerge to reduce deployment friction, if that is even possible.</p>\n"},{"tags":["c#",".net","wpf","3d","render"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13203959,"title":"Nearest-neighbor image sampling in 3D WPF","body":"<p>I'm desperately trying to render images onto a 3D surface in WPF using nearest-neighbor sampling.  Below is an example of what I currently have, in all its blurriness.  The ImageBrush is given a 64x64 texture.</p>\n\n<p><img src=\"http://i.imgur.com/kFZ5s.png\" alt=\"Sample image.\"></p>\n\n<p>I've tried decorating the XAML with <code>RenderOptions.BitmapScalingMode=\"NearestNeighbor\"</code> everywhere from the <code>Window</code> to the <code>ImageBrush</code> without fortune.  I've tried writing a custom pixel shader, and couldn't get a satisfactory result.  It even appears that I cannot set the texture sampler's filtering mode from within the shader code.  I've considered work-arounds, such as scaling up the source texture myself, but this would still leave artifacts at two of the edges where it begins interpolating into the next pixel.</p>\n\n<p>Bottom line: Is there any way I can accomplish the effect of nearest neighbor image sampling on a 3D model in WPF?</p>\n"},{"tags":["c#",".net","asp.net-mvc-4","log4net"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13204720,"title":"Get the fully qualified name of a class?","body":"<p>All, I have a log4net implementation and I'm trying to use the <code>AdoNetAppender</code>, but one of the subelements for the <code>appender</code> configuration is <code>connectionType</code> and it requires a fully qualified class name like <code>System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</code> (got that from the documentation as an example).</p>\n\n<p>However, it can't load that one because this is a .NET4 MVC application. Can somebody tell me how I can get that fully qualified name so it will load the type and connect to the database? I've tried everything that I can honestly think of.</p>\n"},{"tags":[".net","debugging","powerbuilder","datastore","watch"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12510641,"title":"How to see data buffer in the PowerBuilder 12.5 Debugger?","body":"<p>As this option should be as new feature in PowerBuilder 12.5 .NET, but in Debugger I could not see any data in DataStore object. The object information shows in Debugger are only \"base\", \"DataObject\" and \"FlowDirection\", but nothing more. How to reach to see the data in DataStore object while debugging?</p>\n\n<p>In previous PowerBuilder versions I was able to do that by calling of SaveAs() method in Watch and DataStore data was saved in local file. But now, this option does not work (only in source code) it returns \") expected\".</p>\n"},{"tags":["c#",".net","tdd","bdd","specflow"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13066678,"title":"Testing all possible permutation of user interaction using SpecFlow or any other framework","body":"<p>My set up is following: </p>\n\n<ul>\n<li>WPF client writting using MVVM pattern</li>\n<li>A set of unit tests</li>\n<li>A set of SpecFlow scenarious</li>\n</ul>\n\n<p>When creating SpecFlow scenarios, I firstly draw a state machine diagram to see all the possible permutations of user interactions and the requirements to go from one state to another. Then I create a list of all possible scenarios.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>User presses Yes -> Uploads document -> Deletes document -> clicks\nsubmit </li>\n<li>User presses Yes -> Uploads document -> cliks submit </li>\n<li>User presses Yes -> clicks submit</li>\n</ul>\n\n<p>This allows to make sure that we test all possible scenarios and don't miss any. However this is a tedious process and it becomes quite problematic if the requirements changes.</p>\n\n<p>I wonder if there is a framework which could create your scenarios from your State machine, so if the step is deleted from the state machine it automatically recreates your scenarios.</p>\n"},{"tags":[".net","mvvm","microsoft-metro","mvvm-light"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":755,"score":6,"question_id":12438908,"title":"Is MVVM dead in Windows 8 Store Apps?","body":"<p>I have started learning about Windows 8 Store Apps.</p>\n\n<p>I recall from Silverlight and WPF programming earlier that people adapted the MVVM concept and  now I am not sure if I should use what i learned back then or not.</p>\n\n<p>I added a reference to the GalaSoft.MvvmLight and created a ViewModel and added it to my xaml as suggested by:</p>\n\n<pre><code>DataContext=\"{Binding Source={StaticResource Locator}, Path=Welcome}\"\n</code></pre>\n\n<p>It looks like Microsoft included some kind of ModelView implementation in the LayoutAwarePage:</p>\n\n<pre><code>protected override void LoadState(Object navigationParameter, Dictionary&lt;String, Object&gt; pageState)\n{\n    // TODO: Assign a bindable collection of items to this.DefaultViewModel[\"Items\"]\n    //  DefaultViewModel[\"WelcomeTiles\"] = WelcomeTiles;\n}\n</code></pre>\n\n<p>which can be accessed if following datacontext have been set.</p>\n\n<pre><code>&lt;DataContext=\"{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}\" /&gt;\n</code></pre>\n\n<p>So now I am unsure if I should create ModelViews as i remember them, by using MVVMLight or just add the data in code-behind files to the DefaultViewModel.</p>\n\n<p>What are peoples experience with both? I have just started and my next goal is to add handlers for when a item is clicked in the GridView - which of the above paths will let do so in a easy way?</p>\n"},{"tags":["c#",".net","variables","compiler","initialization"],"answer_count":5,"favorite_count":0,"up_vote_count":8,"down_vote_count":2,"view_count":389,"score":6,"question_id":7797424,"title":"Why aren't unassigned local variables automatically initialized?","body":"<p>It seems like there is no way to have unassigned local variables in your code or check for them, as the compiler spits out <code>Use of unassigned local variable</code> error.</p>\n\n<p>Why is the compiler not using <code>default(T)</code> on these variables at compile time?</p>\n\n<p>Even if it's harder to do for value types, references types could easily be initialized to <code>null</code> in this case, right?</p>\n\n<p>Here is some test code:</p>\n\n<pre><code>public void Test ( )\n{\n    int x;\n    string s;\n\n    if ( x == 5 )\n        Console.WriteLine ( 5 );\n\n    if ( s != null )\n        Console.WriteLine ( \"s\" );\n}\n</code></pre>\n\n<p>which returns:</p>\n\n<pre><code>Use of unassigned local variable 'x'\nUse of unassigned local variable 's'\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>For people who claims this is not allowed for a good reason, why is it allowed on a class level?</p>\n\n<pre><code>public class C\n{\n    public int X;\n    public string S;\n\n    public void Print ( )\n    {\n        Console.WriteLine ( X );\n        Console.WriteLine ( S );\n    }\n}\n</code></pre>\n\n<p>This code compiles perfectly fine.</p>\n\n<p>Why is it fine to have on a class level but not on a method level?</p>\n"},{"tags":["c#",".net","stream"],"answer_count":1,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":1767,"score":12,"question_id":7238929,"title":"Stream.Seek(0, SeekOrigin.Begin) or Position = 0","body":"<p>When you need to reset a stream to beginning (e.g. <code>MemoryStream</code>) is it best practice to use</p>\n\n<pre><code>stream.Seek(0, SeekOrigin.Begin);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>stream.Position = 0;\n</code></pre>\n\n<p>I've seen both work fine, but wondered if one was more correct than the other?</p>\n"},{"tags":[".net","linq","c#-4.0","lambda"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13203766,"title":"Get N max numbers and their corresponding position(index) from a 2D array double[,] using lambda expression","body":"<p>This is a question similar to [ <a href=\"http://stackoverflow.com/questions/9062155/get-n-max-numbers-from-a-listint-using-lambda-expression\">Get N max numbers from a List&lt;int&gt; using lambda expression</a> ]  </p>\n\n<p>But I want to learn if I want to keep the index of those N max numbers, how should I write it using lambda expression.  </p>\n\n<p>Example) <code>List&lt;int&gt; numbers = new List&lt;int&gt; { 12, 5, -8, 4, 7, 28, 3, 22 };</code></p>\n\n<p>How can we get 4 maximum numbers by lambda: <code>{28, 22, 12, 7}</code> plus indexes <code>{ 5, 7, 0, 4}</code></p>\n\n<p>as <a href=\"http://stackoverflow.com/users/787016/kirill-polishchuk\">kirill</a> suggested: <code>var result = numbers.OrderByDescending(n =&gt; n).Take(4);</code> but how can I get the <strong>index of those N max numbers</strong>? and it is a double[,] 2D array ( Not a list )</p>\n"},{"tags":[".net","wcf","wcf-4"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13204107,"title":"Can I have a WCF application that has two endpoints. One with Windows Security and one without?","body":"<p>I have read several posts (here on SO and on MSDN) that supposedly show how I can have two endpoints for my WCF service.  But and I can't seem to get this to work.  I tried what they show, but it still does not work.</p>\n\n<p>Here is what I have now:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n  &lt;services&gt;\n    &lt;service name=\"MyServiceProject.MyServiceClass\"&gt;\n      &lt;endpoint address=\"MyService.svc\"\n                  binding=\"basicHttpBinding\"\n                  bindingName=\"normalBasicHttpBinding\"\n                  contract=\"MyContractsProject.IMyServiceClass\" /&gt;\n\n        &lt;endpoint address=\"SecuredMyService.svc\"\n                  binding=\"basicHttpBinding\"\n                  bindingName=\"secureBasicHttpBinding\"\n                  contract=\"MyContractsProject.IMyServiceClass\" /&gt;\n    &lt;/service&gt;\n  &lt;/services&gt;\n  &lt;bindings&gt;\n      &lt;basicHttpBinding&gt;\n          &lt;binding name=\"normalBasicHttpBinding\" maxBufferSize=\"5242880\"\n                    maxBufferPoolSize=\"5242880\"\n                    maxReceivedMessageSize=\"5242880\"&gt;\n              &lt;readerQuotas maxArrayLength=\"16384\"\n                            maxStringContentLength=\"5242880\" /&gt;\n          &lt;/binding&gt;\n\n        &lt;binding name=\"secureBasicHttpBinding\" maxBufferSize=\"5242880\"\n                    maxBufferPoolSize=\"5242880\"\n                    maxReceivedMessageSize=\"5242880\"&gt;\n          &lt;security mode=\"Transport\"&gt;\n            &lt;transport clientCredentialType=\"Windows\" /&gt;\n          &lt;/security&gt;\n          &lt;readerQuotas maxArrayLength=\"16384\"\n                        maxStringContentLength=\"5242880\" /&gt;\n        &lt;/binding&gt;\n      &lt;/basicHttpBinding&gt;\n  &lt;/bindings&gt;\n  &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n          &lt;behavior&gt;\n              &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n              &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n          &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n  &lt;/behaviors&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Variations on this that I have tried:</p>\n\n<ul>\n<li>Taking out the security</li>\n<li>Having the first address be blank and the second just \"secure\" then going to <code>http://MyNormalEndpoint/MyService.svc/secure</code> (was blank and WCF Storm could not connect)</li>\n<li>Adding a &lt;<code>Host&gt;</code> section that is a hard reference to the deploy path.  (I don't want to do this as my service has to deploy to several different locations.  But it did not work anyway)</li>\n<li>Having just one endpoint (the secure one)</li>\n<li>Using two different binding types (wsHttpBinding).</li>\n</ul>\n\n<p>None of these has worked.</p>\n\n<p>And now calls to my normal service are returning 404.  (So I have messed something up).  If you want to see my original (working) config it can be found <a href=\"https://gist.github.com/4004836\" rel=\"nofollow\">here</a>.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["c#",".net","winforms","gui"],"answer_count":11,"favorite_count":6,"up_vote_count":8,"down_vote_count":0,"view_count":5491,"score":8,"question_id":907830,"title":"How do you prevent a windows form being moved?","body":"<p>How would i go about stopping a form from being moved. I have the form border style set as FixedSingle and would like to keep it this way because it looks good in vista :)</p>\n"},{"tags":["c#",".net","startup"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13181009,"title":"C# - Get list of application which runs on windows startup programatically","body":"<p>I want to get the list of application which runs on windows startup programatically.</p>\n\n<p>i see those application in msconfig->startup.</p>\n\n<p>but when i see it in C:\\User\\Appdata\\Microsoft\\windows\\start menu\\programs\\startup</p>\n\n<p>it shows folder is empty.</p>\n\n<p>How to get those list of startup applications programatically C#.</p>\n"},{"tags":["c#",".net","windows"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":43,"score":-2,"question_id":13203226,"title":"Cycle through all points of an image C#","body":"<p>I have a bitmap object, which is 40px by 40px. I would like to be able to loop through every single pixel in the image.</p>\n\n<pre><code>E.g. 1,1\n1,2\n1,3\n...\n2,1\n2,4\n...\n39,1\n39,2\nand so on\n</code></pre>\n\n<p>What would be the best way to achieve this?</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":38,"score":-2,"question_id":13203789,"title":"Iterate over collections union","body":"<p>I have 2 instances of <code>IEnumerable&lt;string&gt;</code> and need to iterate over both of them. Is it possible to iterate within single <code>foreach</code>?</p>\n"},{"tags":[".net","windows","gui","testing","automated-tests"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":791,"score":2,"question_id":2194887,"title":"Automated Windows UI Testing Approach","body":"<p>We are looking to set up automated UI tests and were wondering what the best approach is, what are the potential pitfalls, is it expensive to set up?</p>\n\n<p>Thanks in advance.</p>\n\n<p>B </p>\n"},{"tags":[".net","application","deployment","sybase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":10439250,"title":"deploying an .net application and use Sybase Adaptive Server ADO.NET Data Provider","body":"<p>I'm developing a windows service with the microsoft .net framework 3.5. The key feature of the service is a connection made to a sybase database and execute some store procedures. If I deploy my service on a machine where the sybase adaptive server enterprise is installed, it works fine. But, when I deploy my service on a client machine, I get this message in the event viewer \"Sybase.AdoNet2.AseClient : Could not load code page for requested charset\", then I install the adaptive server on the client and the service works. My question is if someone knows how to deploy the Adaptive Server ADO.NET Data Provider without using the GAC, it's explained here:\n<a href=\"http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc20066.0215/html/adonet2155/Registering_deploying_adodotnet_dev.htm\" rel=\"nofollow\">http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc20066.0215/html/adonet2155/Registering_deploying_adodotnet_dev.htm</a>,\nbut it's not clear what package I have to install, I'm installing this download: <a href=\"http://www.sybase.com/ase_1500devel\" rel=\"nofollow\">http://www.sybase.com/ase_1500devel</a>, but I'd just need only the client, not the entire package. If someone is experienced working with sybase, I will thank any help.</p>\n"},{"tags":[".net","xml","crystal-reports","oledb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4755,"score":0,"question_id":1099723,"title":"Crystal Reports -Invalid Argument provided. Failed to open a rowset. ADO.Net xml","body":"<p>Okay here is the scenario I have a VB6 application that is getting re-written for asp.net 3.5.  I have a grundle of Crystal Reports that are getting updated to Crystal Reports 10.5 (which is included in Visual Studio 2008).  All of the old reports used OLEDB.  What I am doing is taking the sql statements used in the reports and putting them in the database.  I next run an automated process to create a Dataset from those select statements and I serialize the DataSet and save the schema and data as an XML document.  I then go into the old report update it to Crystal Reports 10.5 and change the Data Source location so that it uses the XML document.</p>\n\n<p>When the report is run I create the same DataSet and instead of serializing it as XML I assign it to the report (see below)</p>\n\n<pre><code> rd.Database.Tables(0).SetDataSource(ds)\n</code></pre>\n\n<p>I have tested this and do not get any errors if I create the report new but if I take an existing report and change the database location I get the following error</p>\n\n<p>Invalid Argument provided. Failed to open a rowset. Error in File C:\\DOCUME~1\\username\\LOCALS~1\\Temp\\R-302 {D49E0C73-47AC-4363-AAD5-E925DFCF446E}.rpt: Invalid argument for database.\nat CrystalDecisions.ReportAppServer.ConvertDotNetToErom.ThrowDotNetException(Exception e) at CrystalDecisions.ReportSource.EromReportSourceBase.ExportToStream(ExportRequestContext reqContext) at CrystalDecisions.CrystalReports.Engine.FormatEngine.ExportToStream</p>\n\n<p>It seems as if the report is still trying to connect using OLEDB to the old database.  I have been able to get a report to work if I rewrite it using the exact same logic but the updated reports through the above error.  How do I fix it?</p>\n"},{"tags":[".net","sql-server-2008","ssms","sql-scripts"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13203420,"title":"executing script in code and management studio different results","body":"<p>I am using the Microsoft Application Block to execute the create db script below. When I execute the script, you can see at the end I also create a schema called sync in this new database(or try to).</p>\n\n<p>My issue is whenever I execute the code, the schema [sync] always gets created in master and <strong>NOT in the newly created database</strong>. However, if I execute the same script in the query editor of management studio the schema [sync] is created under the correct database [4177be6c-d7b4-459b-a87f-912fddfd4cc1].</p>\n\n<p>This is leading to table insertion issues into the new db where the schema [sync] does not exist. </p>\n\n<p><em>note I've removed most of the script for readability</em></p>\n\n<pre><code>USE [master]\nGO\n/****** Object:  Database [4177be6c-d7b4-459b-a87f-912fddfd4cc1]    Script Date:           01/19/2007 14:17:21 ******/\nCREATE DATABASE [4177be6c-d7b4-459b-a87f-912fddfd4cc1] \n//lots of other mumbojumbo\nGO\nUSE [4177be6c-d7b4-459b-a87f-912fddfd4cc1]\nGO\nCREATE SCHEMA [sync] AUTHORIZATION [dbo]\nGO\n</code></pre>\n\n<p>The problem is probably trivial, but I cannot see it.</p>\n"},{"tags":["c#",".net","logging","inversion-of-control","windows-phone-8"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13203204,"title":"Windows Phone 8 development - Logging & IOC Design Patterns","body":"<p>I am new to Windows Phone development, especially to WP8. I have some minor experience with developing with WPF and I tried some proof-of-concept solutions with WP7.</p>\n\n<p>So far I have been digging around the WP8 and didn't come to any answer that is targeting logging/tracing on WP8 and some usage of IOC. I have been developing for Android and been using Guice with RoboGuice. I have experience with both Windsor and Ninject, but it seems that WP8 isn't supported by any of those yet.</p>\n\n<ul>\n<li>What is the suggested way to perform logging/tracing on WP8?</li>\n<li>What are the best development and design patterns that should be used? </li>\n<li>Is there any IoC or Service locator or any library targeting those features? </li>\n</ul>\n\n<p>Can you suggest some good libraries/tools/frameworks?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","visual-studio-2010","entity-framework"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":11655912,"title":"Entity Framework does not read FK Relationships, LINQ To SQL Does","body":"<p>I am trying to create an Entity Model from a database.  When I add the tables EF does not read my existing FK constraints.  If I make a Linq to SQL file in the same project and add the same tables it reads the constraints without issue.</p>\n\n<p>Whats the deal?</p>\n"},{"tags":[".net","com","interop"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2813,"score":0,"question_id":437833,"title":"COM object in C# VS2008: Error loading type library/DLL","body":"<p>I am trying to reference a third party COM DLL from a Visual Studio 2008 project (.NET 3.5 SP1) on Vista Ultimate.</p>\n\n<p>I ran the setup for the COM component, and then discovered that it was not the right setup. So I uninstalled and ran the correct install. After adding the reference to a new C# project, not all the object methods are available that should be. </p>\n\n<p>One of the compiler errors is:</p>\n\n<blockquote>\n  <p>Could not determine the dependencies\n  of the COM reference \"APIV2_COMLib\".\n  Error loading type library/DLL.\n  (Exception from HRESULT: 0x80029C4A\n  (TYPE_E_CANTLOADLIBRARY))</p>\n</blockquote>\n\n<p>Thnking the registry might've retained incorrect values, I uninstalled the component and searched the registry for any sign of detritus, but found none. Still, reinstalling gives the same error. </p>\n\n<p>Searching online reveals that others have experienced the same problem <a href=\"http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/9e4be401-c56b-417c-8393-f7dbb64b1abe/\" rel=\"nofollow\">'Odd COM error when upgrading to 3.5' in MSDN forums</a> but I haven't found answers.</p>\n\n<p>My colleagues use the same COM object from .NET code (though not higher than .NET 2.0 or on Vista).</p>\n"},{"tags":[".net","collections","comparison","equality"],"answer_count":12,"favorite_count":21,"up_vote_count":44,"down_vote_count":0,"view_count":24407,"score":44,"question_id":50098,"title":"Comparing two collections for equality","body":"<p>I would like to compare two collections (in C#), but I'm not sure of the best way to implement this efficiently.</p>\n\n<p>I've read the other thread about <a href=\"http://stackoverflow.com/questions/43500/is-there-a-built-in-method-to-compare-collections-in-c\" rel=\"nofollow\">Enumerable.SequenceEqual</a>, but it's not exactly what I'm looking for.</p>\n\n<p>In my case, two collections would be equal if they both contain the same items (no matter the order).</p>\n\n<p>Example:</p>\n\n<pre><code>collection1 = {1, 2, 3, 4};\ncollection2 = {2, 4, 1, 3};\n\ncollection1 == collection2; // true\n</code></pre>\n\n<p>What I usually do is to loop through each item of one collection and see if it exists in the other collection, then loop through each item of the other collection and see if it exists in the first collection. (I start by comparing the lengths).</p>\n\n<pre><code>if (collection1.Count != collection2.Count)\n    return false; // the collections are not equal\n\nforeach (Item item in collection1)\n{\n    if (!collection2.Contains(item))\n        return false; // the collections are not equal\n}\n\nforeach (Item item in collection2)\n{\n    if (!collection1.Contains(item))\n        return false; // the collections are not equal\n}\n\nreturn true; // the collections are equal\n</code></pre>\n\n<p>However, this is not entirely correct, and it's probably not the most efficient way to do compare two collections for equality.</p>\n\n<p>An example I can think of that would be wrong is:</p>\n\n<pre><code>collection1 = {1, 2, 3, 3, 4}\ncollection2 = {1, 2, 2, 3, 4}\n</code></pre>\n\n<p>Which would be equal with my implementation. Should I just count the number of times each item is found and make sure the counts are equal in both collections?</p>\n\n<p><hr /></p>\n\n<p>The examples are in some sort of C# (let's call it pseudo-C#), but give your answer in whatever language you wish, it does not matter.</p>\n\n<p><strong>Note:</strong> I used integers in the examples for simplicity, but I want to be able to use reference-type objects too (they do not behave correctly as keys because only the reference of the object is compared, not the content).</p>\n"},{"tags":["c#",".net","wpf","xaml","dependency-properties"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13198263,"title":"Show/hide button with BooleanToVisibilityConverter does not work","body":"<p>In my application I want to show/hide a button according to the users authorization level.\nIf the user is a team leader the button should be shown. If the user is not a team leader it shouldn't be shown.</p>\n\n<p>I tried to resolve this issue using a <code>BooleanToVisibilityConverter</code> which is defined in my resource dictionary:\n</p>\n\n<pre><code>&lt;BooleanToVisibilityConverter x:Key=\"VisibilityConverter\" /&gt;\n</code></pre>\n\n<p>Implementation of the converter:</p>\n\n\n\n<pre><code>&lt;Button Grid.Row=\"1\" Grid.Column=\"5\"\nClick=\"TeamLeader_Click\" Visibility=\"{Binding IsTeamLeader, Converter={StaticResource\nVisibilityConverter}}\" Style=\"{StaticResource ButtonStyleMenu}\" /&gt;\n</code></pre>\n\n<p>In my code behind class I'm using a dependency property to change the visibility of the button.</p>\n\n\n\n<pre><code>public static readonly DependencyProperty IsTeamLeaderProperty =\nDependencyProperty.Register(\"IsTeamLeader\", typeof(bool),\ntypeof(MainMenu), new FrameworkPropertyMetadata(false));\n\npublic bool IsTeamLeader\n{\n    get { return (bool)GetValue(IsTeamLeaderProperty); }\n    set { SetValue(IsTeamLeaderProperty, value); }\n}\n</code></pre>\n\n<p>In the \"loaded event\" of my user control I initialize my property with <code>false</code> so the button should be collapsed.</p>\n\n\n\n<pre><code>private void ViewPage_Loaded(object sender, RoutedEventArgs e)\n{\n   this.IsTeamLeader = false;\n}\n</code></pre>\n\n<p>But this won't work. No matter which value the <code>IsTeamLeader</code> property has on startup the button is always visible.</p>\n\n<p>So can you please help me and give me a hint where I did the mistake? Is there a problem with the <code>BooleanToVisiblityConverter</code> or is there something wrong with my dependency property implementation? Or what?</p>\n\n<p>Thank you!</p>\n"},{"tags":["c#",".net","visual-studio-2010","azure"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13199568,"title":"Windows azure application developing step failed","body":"<p>This is my first time trying to develop a windows azure application on my visual studio 2010.\nwhat I have done so far is:</p>\n\n<ul>\n<li>Open new project > C# > Cloud.</li>\n<li>Downloaded the SDK.</li>\n<li>Add new class with code that only displays my name and age.</li>\n<li><p>try to run this code locally and failed!</p>\n\n<p><img src=\"http://i.stack.imgur.com/LHhvG.png\" alt=\"\"></p></li>\n</ul>\n\n<p>My questions is:</p>\n\n<ul>\n<li>am I able to run the application locally? if yes the how?</li>\n<li>How can I deploy the application? (I already have an account)</li>\n</ul>\n"},{"tags":["c#","python",".net","pdf","adobe"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13201449,"title":"converting csv file to a pdf template?","body":"<p>I am wondering if there was a library to convert a CSV file into an editable PDF?</p>\n\n<p>I have a simple data set in CSV or EXCEL, and I would like to convert it to a PDF, where depending on some logic, it creates check boxes or textboxes that can then be edited by anyone with adobe acrobat.</p>\n\n<p>I would like to also create a field on the pdf where the user can sign their name. </p>\n\n<p>Does such a thing already exist? If not, is there a library I can use in .NET or Python>?</p>\n"},{"tags":["c#",".net","linq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":72,"score":1,"question_id":13201045,"title":"Linq and work with Datetime?","body":"<p>I need to do this : </p>\n\n<pre><code>context.Ads.Where(c =&gt; c.PublishedDate.HasValue &amp;&amp;\n        c.EndDate.HasValue &amp;&amp;\n        c.EndDate.Value.AddTicks(c.PublishedDate.Value.Ticks) &gt; currentTime &amp;&amp;\n        c.AdStatusMail.Where(b =&gt; b.StatusKey != (int)AdStatusMailKey.EndedRemainder &amp;&amp; b.StatusKey != (int)AdStatusMailKey.MiddleRemainder).Count() &lt; 1)\n        .ToList();\n</code></pre>\n\n<p>The problem is that AddTicks can´t be used in Linq. I have looked at the EntityFunctions but can´t see how to use it to do what I need? </p>\n"},{"tags":["c#",".net","fluentvalidation"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13198471,"title":"fluentvalidation multiple validators","body":"<p>Can I add more than one validator to an object? For example:\n</p>\n\n<pre><code>public interface IFoo\n{\n    int Id { get; set; }\n    string Name { get; set; }\n}\n\npublic interface IBar\n{\n    string Stuff { get; set; }\n}\n\npublic class FooValidator : AbstractValidator&lt;IFoo&gt;\n{\n    public FooValidator ()\n    {\n        RuleFor(x =&gt; x.Id).NotEmpty().GreaterThan(0);\n    }\n}\n\npublic class BarValidator : AbstractValidator&lt;IBar&gt;\n{\n    public BarValidator()\n    {\n        RuleFor(x =&gt; x.Stuff).Length(5, 30);\n    }\n}\n\npublic class FooBar : IFoo, IBar\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n    public string Stuff { get; set; }\n}\n\npublic class FooBarValidator : AbstractValidator&lt;FooBar&gt;\n{\n    public FooBarValidator()\n    {\n        RuleFor(x =&gt; x)\n            .SetValidator(new FooValidator())\n            .SetValidator(new BarValidator());\n    }\n}\n</code></pre>\n\n<p>Running the test.</p>\n\n<pre><code>FooBarValidator validator = new FooBarValidator();\nvalidator.ShouldHaveValidationErrorFor(x =&gt; x.Id, 0);\n</code></pre>\n\n<p>I get an <code>InvalidOperationException</code> \nMessage: <code>Property name could not be automatically determined for expression x =&gt; x. Please specify either a custom property name by calling 'WithName'.</code></p>\n\n<p>Is there any way to implement this or am I trying to use FluentValidation in a way that it's not meant to be used?</p>\n"},{"tags":["c#",".net","image","svg"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13198008,"title":"Save string as svg image?","body":"<p>Any ideas how to save a string with any font as an svg image?</p>\n\n<p>I mean we can write a string to an image and save it, something like this:</p>\n\n<pre><code>Bitmap bitmap = new Bitmap(1, 1);\nGraphics graphics = Graphics.FromImage(bitmap);\n//..\ngraphics.DrawString(myString, myFont, /*...*/);\nbitmap.Save(@\"somewhere\");\n</code></pre>\n\n<p>Can I save a string with a font as svg image too?</p>\n"},{"tags":[".net","file","file-upload","dropbox"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13201797,"title":"Advice on properly handling the uploading of large files with .NET","body":"<p>I am working on a site where users may upload rather large files (up to 50MB). Several users could be uploading at the same time (most to be expected might be ~20, but usually would be 1-5).</p>\n\n<p>We would not like to have the server tied up accepting these large files, so we are considering using drop box as a storage device. For this to work, our solution would have to be on the client-side so that our servers are not tied-up by the file transfer. Does anyone have any thoughts on this solution, perhaps know of something that does this, or have an alternative solution that I should consider?</p>\n\n<p>I would be happy to provide any more info as is applicable.</p>\n"},{"tags":["c#",".net","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13201562,"title":"Capturing events whenever a new thread starts or ends in C#","body":"<p>I have a highly multithreaded application , where threads are started from multiple places and i would like to know if i can hook into the running process and just get alerted whenever a new Managed Thread is spawned. I should be able to get the following information</p>\n\n<ol>\n<li>The parent thread</li>\n<li>New thread</li>\n<li>the method from which the new thread is started like <code>&lt;className&gt;.&lt;methodName&gt;</code></li>\n</ol>\n\n<p>The application is in C# 3.5</p>\n"},{"tags":[".net","vb.net","visual-studio"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13201176,"title":"Printing Out a Message by Action with Mvc.Controller? VB.NET","body":"<h2>The Controller</h2>\n\n<hr />\n\n<pre><code>Public Class HelloWorldController\n    Inherits System.Web.Mvc.Controller\n\n    '\n    ' GET: /HelloWorldController\n\n    Function PrintMessage() As ActionResult\n\n\n    End Function\n\nEnd Class\n</code></pre>\n\n<h2>The URL Request</h2>\n\n<p><hr />\n<code>http:// localhost:1430 / HelloWorld / PrintMessage</code></p>\n\n<h2>The Question</h2>\n\n<p><hr />\nHow can one print out a message in the web browser on the localhost, with the above used \"Mvc.Controller\", the method and the corresponding URL request?</p>\n\n<p>The method (the action) is <code>intended</code> to become invoked by simply pressing a link or a button.</p>\n"},{"tags":[".net","wcf","silverlight","asynchronous",".net-4.5"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13200145,"title":"usage of async methods for webservice","body":"<p>I want to program a little Silverlight application where I have three DataGrids.\nEach Datagrid gets its data from a webservice using async methods. \nNow I want the first data grid to get the data from the webservice and than get the second datagrid the data from the webservice with parameters from the selected row in the first datagrid and the third datagrid with parameters from the first two datagrids.\nThe first datagrid gets the data in the MainPage method via registering the event handler and than use the async method.</p>\n\n<p>Now my problem is that I use the async methods for the other datagrids in the SelectionChanged (event handling) methods and I guess that the concept of this is wrong, because after selecting something in datagrid 2 and going back to datagrid 1 all datagrids dissapear.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Net;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Animation;\nusing System.Windows.Shapes;\nusing System.ServiceModel;\nusing Rebat.SymptomeService;\n\n\nnamespace Rebat\n{\n    public partial class MainPage : UserControl\n    {\n        ServiceClient client = new ServiceClient();\n\n        public MainPage()\n        {\n            InitializeComponent();\n            ServiceClient client = new ServiceClient();\n           client.SymptomeListCompleted += new EventHandler&lt;SymptomeListCompletedEventArgs&gt;(client_SymptomeListCompleted);\n            client.SymptomeListAsync();\n        }\n\n\n        void client_SymptomeListCompleted(object sender, SymptomeListCompletedEventArgs e)\n        {\n            CustomerGrid.ItemsSource = e.Result;\n        }\n        void client_CustomerListCompleted(object sender, CustomerListCompletedEventArgs e)\n        {\n           CustomerGrid2.ItemsSource = e.Result;\n        }\n        void client_SalzListCompleted(object sender, SalzListCompletedEventArgs e)\n        {\n            SalzGrid.ItemsSource = e.Result;\n        }\n\n        private void CustomerGrid_SelectionChanged(object sender, SelectionChangedEventArgs e)\n        {\n            Symptome sympt = CustomerGrid.SelectedItem as Symptome;\n            client.CustomerListCompleted += new EventHandler&lt;CustomerListCompletedEventArgs&gt;(client_CustomerListCompleted);\n            client.CustomerListAsync(sympt.sId.ToString());\n\n        }\n\n        private void CustomerGrid2_SelectionChanged(object sender, SelectionChangedEventArgs e)\n        {\n            Symptome2 sympt2 = CustomerGrid2.SelectedItem as Symptome2;\n            client.SalzListCompleted += new EventHandler&lt;SalzListCompletedEventArgs&gt;(client_SalzListCompleted);\n            //this is the PROBLEM:\n            client.SalzListAsync(sympt2.sy1.ToString(), sympt2.sy2.ToString());\n        }\n\n    }\n}\n</code></pre>\n\n<p>What do I have to change, or how do I have to use the async methods?\nCan you use an async method within an event handling method? Does this apply to the usage of consuming a webservice?</p>\n"},{"tags":["c#",".net","gzip","webclient"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":421,"score":2,"question_id":1436507,"title":"Prevent server from encoding in gzip when downloading with WebClient","body":"<p>I have a download manager of sorts that uses WebClient.DownloadFileAsync. Webclient doesn't seem to handle gzip encoding and some servers are insisting on using it. Since almost all of the files this will be downloading are already compressed, it would be nice just to be able to force it to stop.</p>\n\n<p>I've tried setting the Accept-Encoding to nothing but servers still keep sending gzip. Is it possible to disable or will I have to resort to checking responseheaders?</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13201085,"title":"GetWeekOfYear returns wrong result?","body":"<p>Week 1 of 2013 starts 31-12-2012 since it's a monday.</p>\n\n<p>A call to <code>GetWeekOfYear</code> with culture <code>nl-NL</code>, <code>FirstDayOfWeek.Monday</code> and <code>CalendarWeekRule.FirstFourDayWeek</code> returns week number 53 for monday 31-12-2012 and week 1 for tuesday 1-1-2013. How can that monday have a different week number than tuesday? </p>\n\n<p>Am i missing something?</p>\n"},{"tags":["c#",".net","wpf","dll"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13200880,"title":"Get actual dll path in .Net","body":"<p>I have a dll named JIMS.Printing.dll which is placed inside the Reporting folder of the main application JIMS.exe.</p>\n\n<p>But I am getting an error when calling some files inside the Templates folder inside JIMS.Printing.dll code inside of Reporting which running JIMS.exe</p>\n\n<pre><code>JIMS.exe\n---------&gt;Reporting\n-------------------&gt;JIMS.Printing.dll\n-------------------&gt;Templates\n-----------------------------&gt; Files\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>string _templatePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetAssembly(typeof(JIMS.Printing.PrintInvoice)).Location), \"Templates\");\n</code></pre>\n\n<p>Code from JIMS.Printing.dll</p>\n\n<p>JIMS.exe looking for Files inside JIMS.exe Path\\Templates\\file,\nBut actually the file is in JIMS.Printing.dll Path\\Templates\\files</p>\n"},{"tags":[".net","winforms","multithreading"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":12811924,"title":"Multithread control of .net winform app","body":"<p>I am working on a .net Windows form app using VS2010.\nIn this app, I need four background threads for underlying data transmission. When ALL the four threads finished,  another round of 4 underlying data transmissions will be started using the four threads again.   The form UI need to be responsive all the time.  My problem is: how can I control the running of the 4 threads? like: how do I know that all threads are finished?  using a volatile global counter ?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["c#",".net","linq"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13188172,"title":"How do I perform inline branching within a LINQ query assignment?","body":"<p>I have the following snippet from my LINQ statement, and it works fine but I was wondering if there is a more clever way. I don't want to manually \"new\" up a dummy object if the Fee collection is empty. (Fees is a collection of Fee objects.  You can call it Foo if that makes the question more generic.)</p>\n\n<p>My goal is simple: If <code>Fees</code> is empty, assign a default value of zero to <code>FeeValue</code> instead. What are some alternative ways to achieve this?  Thanks.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>from w in Widgets\nselect new {\n  FeeValue = w.Fees.DefaultIfEmpty(new Fee()).First().Value, // Value is a Double\n    ...\n</code></pre>\n"},{"tags":["c#",".net","winapi"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2993,"score":0,"question_id":4518397,"title":"Send Click Message to another application process","body":"<p>I have a scenario, i need to send click events to an independent application. I started that application with the following code.</p>\n\n<pre><code>private Process app;\napp = new Process();\napp.StartInfo.FileName = app_path;\napp.StartInfo.WorkingDirectory = dir_path;\napp.Start();\n</code></pre>\n\n<p>Now i want to send Mouse click message to that applicaiton, I have specific coordinates in relative to application window. How can i do it using Windows Messaging or any other technique.</p>\n\n<p>I used</p>\n\n<pre><code>[DllImport(\"user32.dll\")]\nprivate static extern void mouse_event(UInt32 dwFlags, UInt32 dx, UInt32 dy, UInt32 dwData, IntPtr dwExtraInfo);\n</code></pre>\n\n<p>It works well but cause the pointer to move as well. So not fit for my need.</p>\n\n<p>Then i use.</p>\n\n<pre><code>[DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = false)]\nstatic extern IntPtr SendMessage(IntPtr hWnd, int Msg, int wParam, int lParam);\n</code></pre>\n\n<p>It works well for minimize maximize, but do not work for mouse events.</p>\n\n<p>The codes for mousevents i am using are,</p>\n\n<pre><code>WM_LBUTTONDOWN = 0x201, //Left mousebutton down\nWM_LBUTTONUP = 0x202,   //Left mousebutton up\nWM_LBUTTONDBLCLK = 0x203, //Left mousebutton doubleclick\nWM_RBUTTONDOWN = 0x204, //Right mousebutton down\nWM_RBUTTONUP = 0x205,   //Right mousebutton up\nWM_RBUTTONDBLCLK = 0x206, //Right mousebutton do\n</code></pre>\n\n<p>Thanks for the help in advance, and waiting for feedback.</p>\n"},{"tags":["c#",".net","linq-to-sql"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":390,"score":3,"question_id":2960759,"title":"How do I tell if a linq to sql object is new, modified or unchanged?","body":"<p>I have a single linq to sql class.  I would like to detect if it is new (meaning an insert will be done) or if there are any pending changes (update will be done).  I realize that I can do this by using a <code>partial</code> class and hooking into the on change events for each property.  However that is a lot of maintenance for a class that is constantly changing.</p>\n\n<p>Is there a better way?</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":13199775,"title":"How to add System.Collections.Generic 3.5 to Asp.net 2.0?","body":"<p>I'm adding functionality to my existing Asp.net 2.0 application. I want to use some of the .net 3.5 features so I add some .net 3.5 assemblies to my web config. Which I added System.Core and System.Xml.Linq. </p>\n\n<p>I want to use IEnumerable version 3.5, what library should I need to add to the web config?</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":256,"score":0,"question_id":11085788,"title":"How to get selectedItem from ListView from a button click in the listView Item","body":"<p>I have a list view item which has a button and displays properties on an object. I have the command property set up for the button using the mvvm pattern which fires correctly. </p>\n\n<p>My issues is that when a press the button it does not also get the selected item, I am guessing that it has not fired the selectedItem event.</p>\n\n<p>Is it possible to force this event when the button is pressed?</p>\n\n<pre><code> &lt;Button \n         Height=\"20\"\n         Width=\"20\"\n         Grid.Column=\"3\"\n         Grid.Row=\"0\"\n         Command=\"{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.RemoveClick}\"\n         CommandParameter=\"{Binding SelectedItem, ElementName=serverListView, Mode=TwoWay}\"&gt;\n</code></pre>\n"},{"tags":["c#","asp.net",".net","visual-studio-2010"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13197850,"title":"How do completely disable signed assemblies?","body":"<p>I have a VS.NET 2010 solution with several projects.  I just added a new library project (the.library.assembly).  The startup project is a website.  When I run the website, I get this error:</p>\n\n<blockquote>\n  <p>Could not load file or assembly 'the.library.assembly' or one of its dependencies. Strong name signature could not be verified.  The assembly may have been tampered with, or it was delay signed but not fully signed with the correct private key. (Exception from HRESULT: 0x80131045)</p>\n</blockquote>\n\n<p>Where does this come from?  I haven't been using signed assemblies with other projects and they work fine. </p>\n\n<p>--- EDIT ---</p>\n\n<p>Actually, I did find that the.library.assembly was signed.  This was related to trouble shooting the signed issue. I have unchecked that in project properties and gone through all projects in the solution.  None are signed.  I get the build error now:</p>\n\n<pre><code>Assembly generation failed -- Referenced assembly 'the.library.assembly' does not have a strong name.\n</code></pre>\n\n<p>I thought maybe this was related to a WCF service the.library.assembly was referencing.  I removed the service and related code.  Everything built fine.  I added the service back.  Another good build.  I added service related code back to the.library.assembly.  Still builds.  Then I added the.library.assembly calls into the web app.  That's when I get the above build failure.</p>\n"},{"tags":[".net","sqlite"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13200216,"title":"SQLite .Net 3.5 Provider returns all DataColumn(s) as System.Object","body":"<p>I have a method that takes an SQL string and returns a DataTable object from a SQLite data base.  This works just fine, but when I look at the DataColumns in the DataTable the DataType returned is always \"System.Object\".  How do I get it to return the correlating DataType that matches up with SQLite (ex.  VARCHAR2 = System.String, BOOL = System.Boolean, ....).  Below is the code I have for creating the DataTable.  Is there some addition step that I can get without having to hard code the appropriate type cast?</p>\n\n<pre><code>public DataTable                GetDataTable\n(\nstring sql\n)\n{\n    DataTable dt = new DataTable();\n    try\n    {\n        openConnection();\n        SQLiteCommand mycommand = new SQLiteCommand(m_cnn);\n        mycommand.CommandText = sql;\n        SQLiteDataReader reader = mycommand.ExecuteReader();\n        dt.Load(reader);\n        reader.Close();\n        closeConnection();\n    }\n    catch (Exception e)\n    {\n        throw new DatabaseException(DatabaseException.DatabaseExceptionTypes.GetDataTable,e);\n    }\n    return dt;\n    enter code here\n</code></pre>\n"},{"tags":["c#",".net","windows","oracle"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":236,"score":1,"question_id":12903366,"title":"OraOLEDB.Oracle provider is not registered on the local machine","body":"<p>I just migrated from XP to Win 7. I am guessing this error has to do with switching operating systems. I wrote a .net application that basically massages a large amount of data and then connects to a database and inserts/updates a table.</p>\n\n<p>When I hit a button to connect to the database I run into the error regarding the oracle provider not being registered on my local machine.</p>\n\n<p>A clear, step by step outline of how I can fix this quickly would be much appreciated.</p>\n\n<p>The exact error message is:</p>\n\n<blockquote>\n  <p>'OraOLEDB.Oracle.1' provider is not registered on the local machine</p>\n</blockquote>\n"},{"tags":["c#",".net","wpf","xaml"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13144461,"title":"WPF textbox binding not working when using stringformat","body":"<p>Here is my problem:</p>\n\n<p>I had a textbox that was using textbox preview and doing some validation on the text entered. The textbox is bound to a double property. Originally when a user entered a number with a decimal it would crash because when it is updating after every key stroke when the number was 1. it was automatically changed to 1 (removing the decimal) and when adding the next number after the decimal it would think the position to insert the new character is position 3 but since the decimal was automatically removed there is no longer a position 3  it errors out. I fixed this by adding <code>StringFormat={}{0:d}</code> to the xaml. This worked fine except for the fact that when everything loads for the first time the original value no longer shows up (the value from the database). But if I remove only the StringFormat the value will load but then I have the crashing problem again. </p>\n\n<p>Any ideas?</p>\n\n<pre><code> &lt;TextBox Grid.Column=\"1\" Margin=\"0\" VerticalAlignment=\"Top\"\n                             Controls:TextBoxMask.NumericType=\"Double\"\n                             Text=\"{Binding Path=Model.Processor.BulkShiftInMilliseconds, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:d}}\"/&gt;\n</code></pre>\n"},{"tags":["c#",".net","monodevelop","webclient"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13200075,"title":"File Uploading from iPhone to MVC","body":"<p>I've recently run into this issue and can't seem to figure out what is going wrong. On my iPhone application (using MonoDevelop) I have a function to upload a file to my MVC client application, however I cannot seem to get the WebClient to upload the file.</p>\n\n<p>In other areas of the application I have used the WebClient may times and have had no issues, however when uploading an entire file, it doesn't seem to respond.</p>\n\n<p>The code isn't much, but basically resembles this:</p>\n\n<p><strong>iPhone Code</strong></p>\n\n<pre><code>using(var client = new CookieAwareWebClient())\n{\n     //Authentication Request\n\n     //Upload\n     client.UploadFile([URL],\"POST\", widget.FilePath);\n}\n</code></pre>\n\n<p><strong>Client Controller Code</strong></p>\n\n<pre><code>   [HttpPost]\n   [Authorize]\n   public void UploadFile(HttpPostedFileWrapper file)\n   {\n         //Do Work Here\n   }\n</code></pre>\n\n<p>I have tried several attempts such as adding additional headers to the Request (<em>such as ContentType, KeepAlive, etc</em>) I have also tried using some of the other methods like <code>client.UploadData()</code> and reading the file as a byte[] and passing it that way.</p>\n\n<p>Any suggestions would be more than welcome.</p>\n"},{"tags":[".net","wpf","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13125498,"title":"Ideas on how to implement bulk edit with the Wpf DataGrid?","body":"<p>(Major question update)</p>\n\n<p>Goal: the ability to select a range of cells (or rows). Update one cell and have that update cascade to all applicable cells (e.g. cells in the same column )</p>\n\n<p>Would also like the Excel behavior of using Enter to commit and move to next cell without losing the selected range.</p>\n\n<p>Tried doing this with the Wpf Datagrid control.. and the result is a kludge..</p>\n\n<ul>\n<li>The datagrid supports multi-selection using Ctrl / Shift.</li>\n<li>However on entering edit mode (irrespective of SelectionMode and Unit), all other rows are deselected leaving the one being edited as the sole selection. Worked around this by hooking into Mouse-Preview events and caching multiselection if any. Added an IsSelected property to my row ViewModels and used them to modify selected rows at will.</li>\n<li>Edits are committed only after the user tabs out. Used binding with UpdateSourceTrigger set to PropertyChanged. Applied current edit to cached multiselection using a ContainerVm which listened to PropertyChangeNotifications from the RowViewModels.</li>\n<li>DataGrid events were not helpful - by the time BeginningEdit is called, the selection was already modified by the MouseDown handler in DataGridCell.</li>\n</ul>\n\n<p>So Grid events and styling haven't helped. Nor has the ViewModel approach. Another option to try out is to write a derivation of DataGridCell and plug it in somehow.</p>\n\n<p>Ideas ?</p>\n"},{"tags":["c#",".net","stringbuilder"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":5,"view_count":90,"score":-3,"question_id":13199363,"title":"Stringbuilder ignores last space","body":"<p>I am initialising a <code>StringBuilder</code> as follows:</p>\n\n<pre><code>StringBuilder builder = new StringBuilder(\"Symptoms are \");\n</code></pre>\n\n<p>After this I loop through a list and add each string item to the end using</p>\n\n<pre><code>foreach(var item in list)\n{\n    builder.Append(item);\n}\n</code></pre>\n\n<p>An example <code>item</code> would be something like \"headache\" but once i've appended it to \"Symptoms are \" and called <code>builder.ToString()</code> it shows:</p>\n\n<pre><code>\"Symptoms areHeadache...etc\"\n</code></pre>\n\n<p>as opposed to </p>\n\n<pre><code>\"Symptoms are Headache...etc\"\n</code></pre>\n\n<p>Why is it ignoring the space?</p>\n"},{"tags":["c#",".net","vb.net","linq"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":13198355,"title":"Create Dictionary(of Dictionary) using Grouping in Linq","body":"<p>I know I could do this with loops (as a matter of fact, I currently am, but I am trying to learn / imporve my Linq skills and i also hope it will provide a more efficent solution. So, here's my scenario:</p>\n\n<p>Say I have the following 3 lists (I'm just making up a similar example, so forgive it's stupidity):</p>\n\n<pre><code>Dim lstTeachers as New List(of string)\nDim lstStudentsSex as New List(of string)\nDim lstStudentName as New List(of string)\n</code></pre>\n\n<p>And they are, for example, as follows:</p>\n\n<pre><code>lstTeachers:     lstStudentsSex:     lstStudentName:\nTeacher 1        Male                Whatever Name 1\nTeacher 2        Female              Whatever Name 2 \nTeacher 1        Female              Whatever Name 3\nTeacher 1        Female              Whatever Name 4\nTeacher 2        Male                Whatever Name 5\nTeacher 3        Male                Whatever Name 6\nTeacher 3        Female              Whatever Name 7\nTeacher 1        Male                Whatever Name 8\nTeacher 1        Female              Whatever Name 9\nTeacher 2        Male                Whatever Name 10\n</code></pre>\n\n<p>Where each entry in each list matches the other entries with the same index - Basically like a datatable, just stored in separate lists.</p>\n\n<p>Now, suppose I want to create the following structure with the following values:</p>\n\n<pre><code>Dim dictTeacherSexName as New Dictionary(Of String, Dictionary(Of String, List(of String)))\n\nDict1_Key:        Dict1_Value / Dict2_Key:         Dict2_Value:\nTeacher 1         Male                             Whatever Name 1\n                                                   Whatever Name 8\n                  Female                           Whatever Name 3\n                                                   Whatever Name 4\n                                                   Whatever Name 9\nTeacher 2 ...\n</code></pre>\n\n<p>... I hope this explains what I'm looking to accomplish.</p>\n\n<p>Now, again, I know this may be a stupid idea, but I'm also asking it because I want to improve my Linq skills - especially Group By and multiple Selects which still catches me, so please help.</p>\n\n<p>Thanks so much!</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13194252,"title":"Are a FileInfo's Properties saved in memory?","body":"<p>When doing something like <code>... = myFileInfo.FullName</code> - does it access the drive or is it loaded to memory with the creation of myFileInfo?</p>\n"},{"tags":["c#",".net"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":67,"score":3,"question_id":13199204,"title":"How to determine if an object implements IDictionary or IList of any type","body":"<p>Lets say I declare the following</p>\n\n<pre><code>Dictionary&lt;string, string&gt; strings = new Dictionary&lt;string, string&gt;();\nList&lt;string&gt; moreStrings = new List&lt;string&gt;();\n\npublic void DoSomething(object item)\n{\n   //here i need to know if item is IDictionary of any type or IList of any type.\n}\n</code></pre>\n\n<p>I have tried using:</p>\n\n<pre><code>item is IDictionary&lt;object, object&gt;\nitem is IDictionary&lt;dynamic, dynamic&gt;\n\nitem.GetType().IsAssignableFrom(typeof(IDictionary&lt;object, object&gt;))\nitem.GetType().IsAssignableFrom(typeof(IDictionary&lt;dynamic, dynamic&gt;))\n\nitem is IList&lt;object&gt;\nitem is IList&lt;dynamic&gt;\n\nitem.GetType().IsAssignableFrom(typeof(IList&lt;object&gt;))\nitem.GetType().IsAssignableFrom(typeof(IList&lt;dynamic&gt;))\n</code></pre>\n\n<p>All of which return false!</p>\n\n<p>So how do i determine that (in this context) item implements IDictionary or IList?</p>\n"},{"tags":["c#",".net","tfs2010","tfsbuild"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13197581,"title":"TFS 2010 Unit Test fails on build machine when calling System.Reflection.Assembly.Load","body":"<p>Using TFS 2010 and vs 2010:</p>\n\n<p>When kicking off a build on the build machine, Unit Tests failing are with a System.IO.FileNotFoundException when trying to do a System.Reflection.Assembly.Load.  </p>\n\n<p>If i run these tests locally they work fine.  Also, if i remote into the build machine and open the solution manually the unit tests will work fine.  </p>\n\n<p>The assembly that is being loaded is a project that is contained in the solution, and is referenced by the unit test project.  It is used for localization, that is why we are doing an assembly.load.</p>\n\n<p>Is there some temp location on the build machine that the Build Service uses that is causing this issue?  is there something i need to configure so that the Assembly can be found by the Build Service?</p>\n\n<p>thanks</p>\n"},{"tags":[".net","stack"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13153220,"title":"sampling .net 4/64 bit","body":"<p>so i tried below with rtllookupfunctionentry and unwind. this causes stack corruption. so anyone has this working</p>\n\n<pre><code>    GetThreadContext(hThread, &amp;context))\n    FunctionID Id = 0;\n            ip=(LPCBYTE)context.Rip;\n            HRESULT funcResult = info2-&gt;GetFunctionFromIP(iPointer, &amp;id);\n\n                ULONG64                       base = NULL;\n                PRUNTIME_FUNCTION             func;\n                func= RtlLookupFunctionEntry(context.Rip,               \n                      &amp;base, &amp;unwindtbl);\n\n                if (!func)\n                {\n                    // leaf\n                    context.Rip  = (ULONG64)(*(PULONG64)context.Rsp);\n                    context.Rsp += 8;\n                }\n                else\n                {\n                    ef = 0;\n                    hd = NULL;\n\n                    RtlVirtualUnwind(0, base, context.Rip, func,                    \n                        &amp;context, &amp;hd,&amp;ef,NULL);\n</code></pre>\n"},{"tags":["c#",".net","appdomain"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13199134,"title":"WCF Service. UnloadedAppDomain","body":"<p>When i debug my WCF service, i found the exception: <code>Attempted to access an unloaded AppDomain.</code>\nBut i dont know any case when this exception can be thrown, during service working (until manual unloading).</p>\n\n<p>Context.\nI have following class:</p>\n\n<pre><code>public class JobManager\n{\n    private const int CheckAsyncJobsTimeout = 4000;\n\n    private Thread _Thread = null;\n    private Dictionary&lt;string, JobInfo&gt; _allJob = new Dictionary&lt;string, JobInfo&gt;();\n    private List&lt;JobInfo&gt; _jobQueue = new List&lt;JobInfo&gt;();\n    private AsyncJobsExecuter _asyncJobsExecuter;\n        private void StartNextJob()\n    {\n        lock (this)\n        {\n            if (_Thread == null &amp;&amp; _jobQueue.Count &gt; 0)\n            {\n                _Thread = new Thread(DoNextJobInQueue);\n                _Thread.Start();\n            }\n        }\n    }\n\n    private void DoNextJobInQueue()\n    {\n        try\n        {\n            JobInfo job;\n            lock (this)\n            {\n                if (_jobQueue.Count &lt; 1)\n                    return;\n\n                job = _jobQueue[0];\n            }\n\n            if (job.IsAsync)\n                ExecuteAsyncJob();\n            else\n                ExecuteJobAndRemove(job);    \n        }\n        finally\n        {\n            lock (this)\n            {\n                _Thread = null;\n                StartNextJob();\n            }\n        }\n    }\n/...\n}\n</code></pre>\n\n<p>In my case exception throwed by method _Thread.Start();\nCan anyone describe cases in wich AppDomainUnloaded exception can be thrown.</p>\n"},{"tags":["c#",".net","pdf","printing"],"answer_count":6,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":5131,"score":6,"question_id":5566186,"title":"Print Pdf in C#","body":"<p>I'm new to c#. I was looking all over the net for tutorials on how to print pdf, but couldn't find one.</p>\n\n<p>Then I thought, is it possible to read it using itextpdf, like mentioned here</p>\n\n<p><a href=\"http://stackoverflow.com/questions/2550796/reading-pdf-content-with-itextsharp-dll-in-vb-net-or-c\">Reading PDF content with itextsharp dll in VB.NET or C#</a></p>\n\n<p>then print it. If so, how?</p>\n"},{"tags":[".net","logging","azure","exception-handling","newrelic-rpm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13189452,"title":"Can the .NET New Relic Agent be configured to log my application's log messages and caught exceptions?","body":"<p>I am currently using New Relic for my .NET application hosted in Azure and in the New Relic UI I can see all uncaught exceptions that occur in my web app. What I would like to be able to do is log ALL messages and caught exceptions as well so that I can see them in New relic UI alongside the uncaught exceptions (that I currently see now). Has anyone ever done this before and if so can you provide a how-to or maybe some code for how you got this working?</p>\n\n<p>I haven't been able to find much about this online except for making using the <a href=\"https://newrelic.com/docs/dotnet/AgentApi\" rel=\"nofollow\">'NoticeError' API call</a> somehow. Is this the right approach or is there another way to accomplish this?</p>\n"},{"tags":["c#","asp.net",".net","css"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":13183153,"title":"Setting SmartNavigation=True causes error with javascript offset.Width/offset.Height","body":"<p>I am using a popular css hack to enable border-radius in Internet Explorer 8 that is found here: (<a href=\"http://www.htmlremix.com/css/curved-corner-border-radius-cross-browser\" rel=\"nofollow\">Curved-corner-border-radius-cross-browser</a>).</p>\n\n<p>It works as expected in IE8, except on any .net page that has a post back and SmartNavigation=True.  On postback I get a javascript error Invalid Argument Line 87, this is in the htc file where the div with rounded corner's offsetHeight / offsetWidth are being retrieved. The css does not work properly and the layout is totally messed up. </p>\n\n<p>I put a javascript alert in this htc file just to show the value of the offsetWidth of the container that is supposed to have rounded corners.  When you first load the page you see the numeric value, click OK on the alert and the css displays as it should.  On post back, the alert will show a value -1.  Click OK  on the alert, and the css is broken.  Why is it unable to find offsetWidth / offsetHeight on post back when SmartNavigation=True?</p>\n\n<p>On postback the error occurs, invalid argument line 87 (actually 88 now with the alert) and the css does not render.  I suspect it has to do with the page initialization and when the javascript in this htc file is being called.  If this is the case, why is it working on the first page load, what makes how the htc file is called different during a post back when SmartNavigation=Ture.?  Any ideas what to do to get this IE hack working with SmartNavigation?</p>\n\n<p>Here is the page:\n<a href=\"http://innerworkingdesigns.com/demos/radius/test.aspx\" rel=\"nofollow\">http://innerworkingdesigns.com/demos/radius/test.aspx</a></p>\n\n<p>Click here to view the htc file\n<a href=\"http://innerworkingdesigns.com/demos/radius/styles/border-radius.htc\" rel=\"nofollow\">http://innerworkingdesigns.com/demos/radius/styles/border-radius.htc</a></p>\n"},{"tags":["c#",".net","visual-studio","nuget"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":304,"score":2,"question_id":6808868,"title":"Howto create a NuGet Package using NuGet.Core?","body":"<p>I would like to create a application which makes use of the NuGet Package NuGet.Core.\nIt has a class called PackageBuilder that makes it possible. Is there any sample / tutorial / documentation available?</p>\n"},{"tags":["c#",".net","sharepoint2010"],"answer_count":5,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":10274,"score":6,"question_id":4787349,"title":"SharePoint error: Web application at xxxx could not be found","body":"<p>When I try to execute this code:</p>\n\n<pre><code>SPSite siteCollection = new SPSite(@\"http://sp-devxxx:10000/\");\n</code></pre>\n\n<p>It throws the following error:</p>\n\n<blockquote>\n  <p>The Web application at\n  <a href=\"http://sp-devxxx:10000\">http://sp-devxxx:10000</a> could not be\n  found. Verify that you have typed the\n  URL correctly. If the URL should be\n  serving existing content, the system\n  administrator may need to add a new\n  request URL mapping to the intended\n  application.</p>\n</blockquote>\n\n<p>I can hit this site from my web browser, it is compiling in x64, my account has read/write access to the content db, the code is running on the server that the site is running on and there exists an access mapping for this site.  Why would it be throwing this error?</p>\n"},{"tags":["c#","asp.net",".net","pdf","itextsharp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13189310,"title":"Merge PDFs iTextSharp","body":"<p>I looked at a few examples online and came up with this code to merge pdfs using iTextSharp. But I am getting an error :.</p>\n\n<p><strong>{\"The document has no pages.\"}</strong></p>\n\n<p>It fails at <strong>Page = writer.GetImportedPage(reader, X);</strong></p>\n\n<p>Here is stack trace :</p>\n\n<pre><code> at iTextSharp.text.pdf.PdfPages.WritePageTree()\n at iTextSharp.text.pdf.PdfWriter.Close()\n at iTextSharp.text.pdf.PdfCopy.Close()\n at iTextSharp.text.Document.Close()\n</code></pre>\n\n<p>It has 3 pages when I debugged it. What is wrong here??</p>\n\n<p>Here is my code</p>\n\n<pre><code>public static MemoryStream MergePdfs(List&lt;MemoryStream&gt; pdfStreams)\n       {\n        //Create output stream\n           MemoryStream OutStream = new MemoryStream();\n           Document Document = null;\n\n           try\n           {\n                //Create Main reader\n                PdfReader Reader = new PdfReader(pdfStreams.ElementAt(0));\n                //Create Main Doc\n                Document = new Document(Reader.GetPageSizeWithRotation(1));\n                //Create main writer\n                PdfCopy Writer = new PdfCopy(Document, OutStream);\n                //Open document for writing\n                Document.Open();\n                //Add pages\n                AddPages(Reader.NumberOfPages, Reader, ref Writer);\n\n                //For each additional pdf after first combine them into main document\n                foreach (MemoryStream PdfStream in pdfStreams.Skip(1))\n                {\n                    PdfReader Reader2 = new PdfReader(PdfStream);\n                    // Add content\n                    AddPages(Reader2.NumberOfPages, Reader2, ref Writer);\n                }\n             }\n             finally\n             {\n                 // Step 5: Close the document\n                 if (Document != null)\n                     Document.Close();\n\n                foreach (var Strm in pdfStreams)\n                {\n                    try { if (null != Strm) Strm.Dispose(); } catch { }\n                }\n             }\n\n             return OutStream;\n         }\n\n        private static void AddPages(int Pages, PdfReader reader, ref PdfCopy writer)\n        {\n            PdfImportedPage Page = null;\n\n            for (int X = 0; X &lt; Pages; X++)\n            {\n                 Page = writer.GetImportedPage(reader, X);\n                 writer.AddPage(Page);\n            }\n\n            if (reader.AcroForm != null)\n                writer.CopyAcroForm(reader);\n        }\n</code></pre>\n"},{"tags":[".net","wpf","wpf-usercontrols"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13197528,"title":"Put a border on the grid in WPF","body":"<p>Is there a way to put a border on the grid without surrounding the grid the Border element?</p>\n\n<pre><code>&lt;Border Margin=\"{Binding ElementName=thisUserControl, Path=PrintMargin}\"\n        BorderThickness=\"{Binding ElementName=thisUserControl, \n                             Path=PrintMarginThickness}\"\n        BorderBrush=\"LightGray\"&gt;\n    &lt;Grid x:Name=\"mainGrid\"\n          Background=\"{Binding ElementName=thisUserControl, Path=Background}\" /&gt;\n&lt;/Border&gt;\n</code></pre>\n\n<p>Could I use something like \"BitmapEffect\" on the grid or stuff like this?\nI just need to display or not a border named \"PrintMargin\" on my WpfUserControl...</p>\n\n<p>This border should or not be visible and also perhaps I need to control its <strong>Thickness</strong> and maybe <strong>Color</strong>(Brush)...</p>\n"},{"tags":[".net","asp.net-mvc-3","templates","view","scaffolding"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":53,"score":3,"question_id":13198521,"title":"In MVC3 how to move all scripts to the bottom of the page before </body>?","body":"<p>In MVC3 I can easily move the jQuery script tag to the bottom of the page \"_Layout.vbhtml\"</p>\n\n<pre><code>&lt;script src=\"@Url.Content(\"~/Scripts/jquery-1.8.2.min.js\")\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>However in the ASP.NET MVC3 when you create a Controller with an editor template, the scaffolding mechanism does a good amount of work adding files to the Views folder like Create.cshtml, Delete.cshtml, Details.cshtml, Edit.cshtml, and Index.cshtml etc... and they are strongly typed.</p>\n\n<p>Inside those View files, script tags are inside the <code>&lt;body&gt;</code>, but how can I add those tags to the bottom of the page immediately before <code>&lt;/body&gt;</code> tag?</p>\n"},{"tags":[".net","dll","import","mono","delphi-prism"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13181124,"title":"Importing DLL and running application under mono","body":"<p>I import \"winmm.dll\" by using the following code.</p>\n\n<pre><code>  MyUtils = public static class\n  private\n  protected\n  public\n    [DllImport(\"winmm.dll\")]\n    class method timeBeginPeriod(period:Integer):Integer; external;\n    [DllImport(\"winmm.dll\")]\n    class method timeEndPeriod(period:Integer):Integer; external;\n  end;\n</code></pre>\n\n<p>Access the methods as follows.</p>\n\n<pre><code>MyUtils.timeBeginPeriod(1); //within winform load event\nMyUtils.timeEndPeriod(1);   //within winform formclosing event\n</code></pre>\n\n<p>Under Windows 7, it works great as expected. Under mono on Linux System, it works as well but with one exception. As soon as the program is started, it pops up with a message box with the name of the dll that is imported and OK button as shown below. When I click the OK button, my program continues and runs as expected without any errors.</p>\n\n<p><img src=\"http://i.stack.imgur.com/oxvx9.png\" alt=\"enter image description here\"> </p>\n\n<p>I've combed through my program to see if I am intentionally displaying the dll file name anywhere, but I simply can't find anything like that.</p>\n\n<p><strong>EDIT:</strong> Little bit more information, the reason I need to work with winmm.dll is I need to be able to adjust thread sleep granularity or default delay down to about 1 milliseconds or close to it - <strong>NOT to play movie or music file.</strong> The only way I able to adjust is through these methods <code>timeBeginPeriod</code> and <code>timeEndPeriod</code>. So that my program can successfully talk through serial port. My program is to be talking back and forth every few milliseconds nonstop 24/7/365 days. It is critical that its communication is 90% or more. After having imported the dll file, my programs communication is flawless on windows and linuxs except I am getting that annoying messagebox on Linux under mono.</p>\n\n<p>I've never seen or heard of such an issue before. Does anyone why?</p>\n\n<p>Thanks,</p>\n"},{"tags":["c#",".net","reflection","reflector"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13194584,"title":"How to enable .NET Reflector to pick the right version of .NET compiled assembly?","body":"<p>I am having a simple problem regarding .NET reflector. I have decompiled the assembly manually from .NET Reflector, exported its code and recompiled its code manually from Visual Studio and generated its assembly ( I want few code changes ). Now I want this assembly to be correctly referenced with another main project which have other assemblies decompiled. But problem is , It throws an exception of </p>\n\n<p>\"Unable to pick the assembly xxxx VERSION = 1.0.12.4\"</p>\n\n<p>Here is the problem. It goes and picks the older version somehow and do not picking the right version ( where I made changes, Even that project is referenced and it has the version now \"0.0.0.0\"). Basically before making changes in the code, it decompiles it self and generates the cache where it putting all source files. But now I want to make some code changing and seperately want to compile the whole project code and then to reference that project in the main project where other assemblies might be old.</p>\n\n<h2>Edit</h2>\n\n<p>Manually I don't see any place in Assembly.cs file where I can change the version of an assembly which is referenced inside the project. My problem is that I want to enable Visual Studio to LOAD the assembly version of which it referenced as project. Assembly compiles and drops in the same \"Debug\" directory. But when EXE Launches it throws exception.\nBECAUSE it has somewhere sees the assembly with an older version for which it was working previously.</p>\n\n<p>Regards\nUsman</p>\n"},{"tags":["asp.net",".net","redirect","asynchronous","async-await"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":119,"score":2,"question_id":13125361,"title":"ASP.NET 4.5 async-await and Response.Redirect","body":"<p>Is there any way to redirect from <code>Page_Load</code> (or any other ASP.NET event) when using <code>async</code>-<code>await</code>? Of course <code>Redirect</code> throws <code>ThreadAbortException</code> but even if I catch it with <code>try</code>-<code>catch</code> it ends up with an error page. If I call <code>Response(\"url\", false)</code> it doesn't crash but I need to stop execution of the page (rendering the page etc.) so it's not the solution. And as I noticed these two methods act differently:</p>\n\n<p>This ends up with ThreadAbortException (I assume the task ends synchronously):</p>\n\n<pre><code>protected async void Page_Load()\n{\n    await Task.Run(() =&gt; { });\n    Response.Redirect(\"http://www.google.com/\");\n}\n</code></pre>\n\n<p>This one continues after Response.Redirect:</p>\n\n<pre><code>protected async void Page_Load()\n{\n    await Task.Delay(1000);\n    Response.Redirect(\"http://www.google.com/\");\n}\n</code></pre>\n\n<p>I must wait for the response but I was experimenting and even if I remove the <code>await</code> keyword (so Task runs in background and the method continues) it ends up the same. Only thing that helps is to remove the <code>async</code> keyword - I thought <code>async</code> ONLY enables <code>await</code> and nothing more?!</p>\n"},{"tags":[".net","vb.net","wcf","soap","wcf-security"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13125367,"title":"Why is my client certificate not being included in the TLS handshake?","body":"<p>I wrote a Windows service a few years back that processed data from several sources, one of which was a third party SOAP Web Service. It authenticated with this Web Service using a client certificate provided by the third party. This worked fine at the time, and is still working fine on the original machine it was deployed to, but now they are migrating to a new machine where the connection attempt is throwing an exception with the message:</p>\n\n<blockquote>\n  <p>The HTTP request was forbidden with client authentication scheme\n  'Anonymous'</p>\n</blockquote>\n\n<p>The same thing is now also occurring on my development machine. This is the code that configures the connection to the web service:</p>\n\n<pre><code>Friend Shared Function GetProperlyConfiguredConnection() As SEMOService.MIWebServiceClient\n    ' Ensure that the settings are valid\n    ValidateSettings()\n\n    Dim destAddress As New System.ServiceModel.EndpointAddress(Url)\n    ' The service uses SOAP 1.1 which is what BasicHttpBinding uses. WSHttpBinding uses SOAP 1.2.\n    'Dim destBinding As New System.ServiceModel.WSHttpBinding\n    Dim destBinding As New System.ServiceModel.BasicHttpBinding\n    With destBinding\n        .CloseTimeout = New TimeSpan(0, 1, 0)\n        .OpenTimeout = New TimeSpan(0, 1, 0)\n        .ReceiveTimeout = New TimeSpan(0, 10, 0)\n        .SendTimeout = New TimeSpan(0, 1, 0)\n        .BypassProxyOnLocal = False\n        .HostNameComparisonMode = ServiceModel.HostNameComparisonMode.StrongWildcard\n        .MaxBufferPoolSize = 524288\n        .MaxReceivedMessageSize = 2147483647\n        .MessageEncoding = ServiceModel.WSMessageEncoding.Text\n        .TextEncoding = System.Text.Encoding.UTF8\n        .UseDefaultWebProxy = True\n        .AllowCookies = False\n\n        With .ReaderQuotas\n            .MaxDepth = 32\n            .MaxStringContentLength = 2147483647\n            .MaxArrayLength = 50000000\n            .MaxBytesPerRead = 4096\n            .MaxNameTableCharCount = 16384\n        End With\n\n        .Security.Mode = ServiceModel.BasicHttpSecurityMode.Transport\n        .Security.Transport.ClientCredentialType = ServiceModel.HttpClientCredentialType.Certificate\n    End With\n\n    Dim wcfService As New SEMOService.MIWebServiceClient(destBinding, destAddress)\n\n    ' Load the certificate from the specified file.\n    Dim keyData As Byte()\n    Dim keyFileInfo As New IO.FileInfo(SEMOServiceSettings.KeyFilePath)\n    Dim keyFileReader As New IO.BinaryReader(New IO.FileStream(SEMOServiceSettings.KeyFilePath, IO.FileMode.Open, IO.FileAccess.Read))\n    keyData = keyFileReader.ReadBytes(keyFileInfo.Length)\n    keyFileReader.Close()\n\n    Dim cert As New X509Certificates.X509Certificate2\n    cert = New X509Certificates.X509Certificate2(keyData, SEMOServiceSettings.KeyFilePassword)\n\n    wcfService.ClientCredentials.ClientCertificate.Certificate = cert\n\n    Return wcfService\nEnd Function\n</code></pre>\n\n<p>It is not actually a WCF web service, but Visual Studio didn't seem to mind when auto-generating the client code from the WSDL. The client certificate is loaded up from a file rather than from the certificate store. The same certificate file is in use on all the machines, and appears to be loaded up fine when stepping through the code.</p>\n\n<p>I compared the requests being made from the machine that works to one from my dev machine using WireShark, and it appears that the client certificate is not being included in the handshake when it should be:</p>\n\n<p><a href=\"http://i.imgur.com/meZa2.png\" rel=\"nofollow\">No client certificates</a></p>\n\n<p>This is the corresponding packet from a request on the machine that works:</p>\n\n<p><a href=\"http://i.imgur.com/zMchd.png\" rel=\"nofollow\">Full certificate chain</a></p>\n\n<p>There is much about WCF, SOAP and cryptography that I don't understand, so I am at a bit of a loss as to what could be different about the environments to result in this behaviour, and what needs to change to correct it.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4090975/how-to-force-wcf-client-to-send-client-certificate\">This question</a> seems to be related, but I can't seem to access any <code>RequireClientCertificate</code> property through code, and am not using an app.config to configure the binding.</p>\n\n<p>It is possible to add a callback to the ServicePointManager class for performing custom validation of the server certificate. Does the base client class or the binding perform some validation of the client certificate before sending it to the server? If so, is there a way I can intervene in that process in the same way that I can for the server certificate validation, so that I can see what is going on?</p>\n"},{"tags":["c#","asp.net",".net","enums"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13172809,"title":"Public Enum / class could not be accessed / found","body":"<p>In my ASP.NET project, I have an App_Code folder.</p>\n\n<p>In the folder are several classes that work perfectly fine. The classes can see each other without any problems.</p>\n\n<p>I have also added an Enums.cs file to the folder. The Enums.cs file contains the following code:</p>\n\n<pre><code>namespace xsite.App_Code\n{\n  public enum Bottle\n  {\n    Glass,\n    Plastic,\n    Paper\n  }\n}\n</code></pre>\n\n<p>Problem is that none of the classes in the folder can use the Bottle enum. When I try to use the enum, I get the following error:</p>\n\n<p><em>The type or namespace name 'Bottle' could not be found (are you missing a using directive or an assembly reference?)</em></p>\n\n<p>The namespace of the classes in the folder is the same as the enum.</p>\n\n<p>Any idea how I can fix this, so I can use the Bottle enum?</p>\n"},{"tags":[".net","wcf","proxy","fiddler"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13195265,"title":"WCF service only accessible when Fiddler is turned on","body":"<p>My client application which is on one machine is trying to access a WCF service which is on another machine. </p>\n\n<p>The client application can only access the web service when Fiddler,on the client machine, is switched on. When the latter is switched off, I get the following error:</p>\n\n<blockquote>\n  <p>System.ServiceModel.EndpointNotFoundException: There was no endpoint\n  listening at <a href=\"http://ourServer.com/ProductDataServiceV1.svc\" rel=\"nofollow\">http://ourServer.com/ProductDataServiceV1.svc</a> that could\n  accept the message. This is often caused by an incorrect address or\n  SOAP action. See InnerException, if present, for more details. --->\n  System.Net.WebException: Unable to connect to the remote server --->\n  System.Net.Sockets.SocketException: No connection could be made\n  because the target machine actively refused it 127.0.0.1:8888</p>\n</blockquote>\n\n<p>In the hosts file I've got </p>\n\n<blockquote>\n  <p>192.168.33.55   ourServer.com</p>\n</blockquote>\n\n<p>I've looked at the proxy settings in Windows explorer and all the checkboxes are turned off. I've also done a search for \"127.0.0.1:8888\" on the client machine but couldn't find anything of note. </p>\n\n<p>Moreover, I am able to \"see\" the service <a href=\"http://ourServer.com/ProductDataServiceV1.svc\" rel=\"nofollow\">http://ourServer.com/ProductDataServiceV1.svc</a> in a web browser.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":[".net","visual-studio-2010","dll","deployment","setup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13196723,"title":"Cannot configure Application to load external dll's from another folder","body":"<p>I am trying to move my external .dll's (like DevExpress and others) to another folder called \"lib\".</p>\n\n<p>I added following lines to my app.config file: </p>\n\n<pre><code>&lt;runtime&gt;\n&lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n  &lt;probing privatePath=\"lib\" /&gt;\n&lt;/assemblyBinding&gt;\n</code></pre>\n\n<p></p>\n\n<p>I output my .dll files to lib folder with my setup project. The application setup installs successfully but when I launch the application my splash screen (which is configured by VS2010) shows and disappears and that is all what happens. The directory structure is like this: </p>\n\n<pre><code>// FAILS\n..\\MyApp\\Application.exe\n..\\MyApp\\Application.exe.config // With assemblyBinding added\n..\\MyApp\\lib\\*.dll // All dll files are here\n</code></pre>\n\n<p>If I change the application.exe.config file to load from the base diretory and copy the .dll's back to the base directory, it runs fine.</p>\n\n<pre><code>// RUNS FINE\n..\\MyApp\\Application.exe\n..\\MyApp\\Application.exe.config // With assemblyBinding removed\n..\\MyApp\\*.dll // All dll files are here\n</code></pre>\n\n<p>What may be the problem?</p>\n\n<p>Thanks.</p>\n"},{"tags":["c#",".net","data-validation","multitrigger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13198454,"title":"MultiTrigger.Conditions for a TextBoxStyle that verifies NullOrWhiteSpace","body":"<p>I need to trigger a style for the NameTextBox, so that, when the input name is null or white space, the TextBox colours itself in red. The style is created, put how do I associate it with this condition?\nNow, this is the condition for it, but does not include whitespace:</p>\n\n<pre><code>    &lt;MultiTrigger.Conditions&gt;\n        &lt;Condition Property=\"Necessity\"\n                   Value=\"Mandatory\" /&gt;\n        &lt;Condition Property=\"Text\"\n                   Value=\"\" /&gt;\n    &lt;/MultiTrigger.Conditions&gt;\n</code></pre>\n"},{"tags":["asp.net",".net","gridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13191926,"title":"GridView automatically re-sizing itself","body":"<p>I have a GridView in asp that keeps re-sizing itself. Can i in some way fix the size of the GridView so it doesn't do that ? The GridView keeps shrinking itself although the data in it has the same length or is smaller</p>\n\n<p>my asp code:</p>\n\n<pre><code>    &lt;asp:GridView ID=\"Grid\" runat=\"server\" AllowPaging=\"True\" PageSize=\"18\" OnPageIndexChanging=\"Grid_PageIndexChanging\"\n            ForeColor=\"Black\" GridLines=\"Both\" Width=\"991px\" Height=\"600px\" RowStyle-HorizontalAlign=\"Center\"\n        BackColor=\"White\" BorderColor=\"#999999\" BorderWidth=\"1px\" \n            AutoGenerateColumns=\"False\" style=\"margin-left: 9px\"&gt;\n            &lt;Columns&gt;\n                &lt;asp:TemplateField HeaderText=\"RequestID\"&gt;\n                &lt;ItemTemplate&gt;\n                &lt;a target = \"_blank\" href=\"www.danx/default?request=&lt;%# Eval(\"request\")%&gt;\"&gt;&lt;%# Eval(\"request\")%&gt;&lt;/a&gt;\n                &lt;/ItemTemplate&gt;\n                &lt;/asp:TemplateField&gt;\n                &lt;asp:TemplateField HeaderText=\"Barcode\"&gt;\n                &lt;ItemTemplate&gt;\n                &lt;a target = \"_blank\" href=\"www.danx/default?barcode=&lt;%# Eval(\"barcode\")%&gt;\"&gt;&lt;%# Eval(\"barcode\")%&gt;&lt;/a&gt;\n                &lt;/ItemTemplate&gt;\n                &lt;/asp:TemplateField&gt;\n                &lt;asp:BoundField DataField=\"adrid\" HeaderText=\"AdrID\" SortExpression=\"AdrID\" /&gt;\n                &lt;asp:BoundField DataField=\"name\" HeaderText=\"Navn\" SortExpression=\"Name\" /&gt;\n                &lt;asp:BoundField DataField=\"street\" HeaderText=\"Vej\" SortExpression=\"Street\" /&gt;\n                &lt;asp:BoundField DataField=\"houseno\" HeaderText=\"Husnr\" \n                    SortExpression=\"HouseNo\" /&gt;\n                &lt;asp:BoundField DataField=\"postal\" HeaderText=\"Postnr\" \n                    SortExpression=\"Postal\" /&gt;\n                &lt;asp:BoundField DataField=\"city\" HeaderText=\"By\" SortExpression=\"City\" /&gt;\n                &lt;asp:BoundField DataField=\"country\" HeaderText=\"Land\" \n                    SortExpression=\"Country\" /&gt;\n                &lt;asp:TemplateField HeaderText=\"Lokation\"&gt;\n                &lt;ItemTemplate&gt;\n                &lt;a target = \"_blank\" href=\"https://maps.google.dk/maps?q=&lt;%# Eval(\"latitude\")%&gt;,&lt;%# Eval(\"longitude\")%&gt;\"&gt;&lt;%# Eval(\"latitudetxt\")%&gt;&lt;/a&gt;\n                &lt;/ItemTemplate&gt;\n                &lt;/asp:TemplateField&gt;\n                &lt;asp:BoundField DataField=\"date\" HeaderText=\"ReceivedDate\" \n                    SortExpression=\"ReceivedDate\" /&gt;\n\n            &lt;/Columns&gt;\n            &lt;FooterStyle BackColor=\"#CCCCCC\" /&gt;\n\n&lt;RowStyle HorizontalAlign=\"Center\"&gt;&lt;/RowStyle&gt;\n\n            &lt;SelectedRowStyle BackColor=\"#000099\" Font-Bold=\"True\" ForeColor=\"White\" /&gt;\n            &lt;PagerStyle BackColor=\"#999999\" ForeColor=\"Blue\" HorizontalAlign=\"Center\" /&gt;\n            &lt;HeaderStyle BackColor=\"DarkGray\" Font-Bold=\"True\" ForeColor=\"Black\" /&gt;\n            &lt;AlternatingRowStyle BackColor=\"LightGray\" /&gt;\n            &lt;SortedAscendingCellStyle BackColor=\"#F1F1F1\" /&gt;\n            &lt;SortedAscendingHeaderStyle BackColor=\"#808080\" /&gt;\n            &lt;SortedDescendingCellStyle BackColor=\"#CAC9C9\" /&gt;\n            &lt;SortedDescendingHeaderStyle BackColor=\"#383838\" /&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>Can you help me please?</p>\n"},{"tags":["c#",".net","entity-framework","lambda"],"answer_count":8,"favorite_count":0,"up_vote_count":26,"down_vote_count":0,"view_count":20774,"score":26,"question_id":2058487,"title":"Entity Framework - Cannot convert lambda expression to type 'string' because it is not a delegate type","body":"<p>I am using Entity Framework in my C# based code.  I am running into an unexpected weirdness and am looking for suggestions.</p>\n\n<p>Case 1, 2, 3, 4...\nProjects:<br>\nRivWorks.dll<br>\nRivWorks.Service.dll<br>\nRivWorks.Alpha.dll  </p>\n\n<p>Samples (all of these work):<br/>\n<strong>RivWorks.Alpha.dll:</strong></p>\n\n<pre><code>public static bool EndNegotitation(long ProductID)\n{\n    var product = (from a in _dbFeed.AutoWithImage \n                   where a.AutoID == ProductID select a).FirstOrDefault();\n...\n}\n</code></pre>\n\n<p><strong>RivWorks.Service.dll</strong></p>\n\n<pre><code>public static RivWorks.Model.NegotiationAutos.AutoWithImage \n    GetProductById(long productId)\n{\n    var myProduct = from a in _dbFeed.AutoWithImage \n                    where a.AutoID == productId select a;\n\n    return myProduct.FirstOrDefault();\n}\npublic static List&lt;RivWorks.Model.NegotiationAutos.AutoWithImage&gt; \n    GetProductByCompany(Guid companyId)\n{\n    var myProduct = from a in _dbFeed.AutoWithImage \n                    where a.CompanyID == companyId select a;\n\n    return myProduct.ToList();\n}\n</code></pre>\n\n<p>etc</p>\n\n<p>Case \"weirdness\":<br>\nRivWorks.Web.Service.dll (WCF project)<br>\nContains the same references as the other projects.</p>\n\n<pre><code>public NegotiateSetup GetSetup(string method, string jsonInput)\n{\n    ...\n    long.TryParse(ProductID, out result);\n    var product = (from a in _dbFeed.AutoWithImage \n                   where a.AutoID == result select a).FirstOrDefault();\n    ...\n}\n</code></pre>\n\n<p>I am getting this compile time error (the word \"where\" is highlighted in my editor):<br/>\n<em>Cannot convert lambda expression to type 'string' because it is not a delegate type</em><br/></p>\n\n<p>Any ideas what would cause this?</p>\n"},{"tags":["c#",".net","wcf",".net-4.0","request"],"answer_count":1,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13195959,"title":"Wcf - 3 retries before exception?","body":"<p>I was asked to build a mechanism for 3 retries before generating a request exception.</p>\n\n<p>We have this topology : </p>\n\n<p><img src=\"http://i.stack.imgur.com/mBGWv.jpg\" alt=\"enter image description here\"></p>\n\n<p><code>Service1</code> calls <code>Service2</code>.</p>\n\n<p>If 3 times in a row has failed - generate an excpetion.</p>\n\n<p>Is there any retry mechanism in <code>WCF</code> ?</p>\n"},{"tags":["c#",".net","oop","design-patterns","automapper"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13192959,"title":"Transforming/Mapping models","body":"<p>I have a generic model which is used to store all the data using an ORM technology. This model has to be occasionally transformed into another model to ‘do something’. At the moment I am using this (simplified)  approach where the generic model stores weight in kilogram and the target model stores it in pounds:</p>\n\n<pre><code>public class GenericModelClassA\n{\n    public virtual double Weight { get; set; } \n}\n\npublic interface IModelX\n{\n    double Weight { get; set; }\n}\n\npublic class ModelXClassA : GenericModelClassA, IModelX\n{\n    private const double WeightConversionFactor = 2.20462;\n\n    public override double Weight\n    {\n        set\n        {\n        base.Weight = value / WeightConversionFactor;\n        }\n        get\n        {\n        return base.Weight * WeightConversionFactor;\n        }\n    }\n}\n</code></pre>\n\n<p>Is this a decent approach to the problem? I have heard about model driven transformation (MDT) languages to query/view/transform/operational (QVTO). Is my approach too naive? Would you recommend MDT languages? Any feedback/opinions would be very much appreciated.</p>\n\n<p>Many thanks.</p>\n\n<p>Christian</p>\n"},{"tags":[".net","security","networking","distributed-computing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13198282,"title":"Safely executing .NET code on remote clients","body":"<p>I have a couple of students working on a volunteer computing project. Although is a school project for them, once finished and correctly tested we will begin the implantation in our faculty for real use. The idea is to create a platform for general purpose distributed computing in out faculty's internal network. But we are just starting. </p>\n\n<p>The first problem we need to solve is this: using an already implemented distributed system with automatic discovery, replication, and the other characteristics such a system needs, we want to take a user's code in .NET and run it in this distributed system. Since is a volunteer system, we need to respect every node's settings for maximum available memory and CPU use, and run in a safe environment where the user's code has no access to the client's file system, can't raise new processes, etc.</p>\n\n<p>So, the general question is: what is the best way to proceed, regarding both the sharing of the code and the security. </p>\n\n<p>We have discussed a few ideas, that I present now for your evaluation and comments. Any suggestion is greatly appreciated. </p>\n\n<ul>\n<li>Somehow serialize a .NET delegate together with its closure.</li>\n<li>Force the user to implement some interface and then upload his assembly and dependencies, find an implementation of this interface, instantiate it and run it. Maybe add some attributes.</li>\n<li>Expose the distributed system inner workings and let the user deal with the creation and synchronization of his distributed tasks.</li>\n</ul>\n\n<p>I would prefer the most transparent solution, as close to the Task Parallel Library interface as possible.</p>\n\n<p>Thanks in advance. </p>\n"},{"tags":["c#",".net","properties"],"answer_count":6,"favorite_count":2,"up_vote_count":21,"down_vote_count":0,"view_count":5256,"score":21,"question_id":411048,"title":"Differences between Private Fields and Private Properties","body":"<p>What is the difference between using Private Properties instead of Private Fields</p>\n\n<pre><code>private String MyValue { get; set; }\n\n// instead of\n\nprivate String _myValue;\n\npublic void DoSomething()\n{\n   MyValue = \"Test\";\n\n   // Instead of\n\n   _myValue = \"Test\";\n}\n</code></pre>\n\n<p>Is there any performance issue ? or just a naming convention ?</p>\n"},{"tags":["c#",".net","email","exchangewebservices","exchange2010"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198111,"title":"Can not programmatically send email using web service of MS Exchange Server 2010 SP2","body":"<p>I got an app (C#) that send email using web service of MS Exchange Server 2010 SP2. It works fine before. But, just 2 weeks ago, I got the problem with it. Sometime the code can send an email but sometime it's not. I got the error message as below (full error message shows at the end).</p>\n\n<pre><code>The request failed. Unable to connect to the remote server\n</code></pre>\n\n<p>My code is below.</p>\n\n<pre><code>string ewsUrl = \"https://xxxx.xxxx.com/ews/Exchange.asmx\";\nstring userName = \"xxxx\";\nstring password = \"xxxx\";\nstring to = \"xxxx@xxxx.com\";\nstring cc = \"xxxx@xxxx.com\";\n\nExchangeService service = new ExchangeService();\nservice.Url = new Uri(ewsUrl);\nservice.UseDefaultCredentials = true;\nservice.Credentials = new WebCredentials(userName, password);\n\nEmailMessage message = new EmailMessage(service);\nmessage.Subject = subject;\nmessage.Body = bodyHtml;\nmessage.ToRecipients.Add(to);\nmessage.CcRecipients.Add(cc);\n\nmessage.SendAndSaveCopy();\n</code></pre>\n\n<p>I don't know what went wrong. I believe that the URL is correct and it's work sometime and don't another time. I have search on the internet but don't found any solutions for this. <strong>Is this something about server configuration?</strong> I have talked to my IT guy but it seems that he got no idea about the web service. Please help me. The full error message is below.</p>\n\n<pre><code>The request failed. Unable to connect to the remote server\n    at Microsoft.Exchange.WebServices.Data.ServiceRequestBase.ValidateAndEmitRequest(HttpWebRequest&amp; request)\n    at Microsoft.Exchange.WebServices.Data.SimpleServiceRequestBase.InternalExecute()\n    at Microsoft.Exchange.WebServices.Data.MultiResponseServiceRequest`1.Execute()\n    at Microsoft.Exchange.WebServices.Data.ExchangeService.InternalCreateItems(IEnumerable`1 items, FolderId parentFolderId, Nullable`1 messageDisposition, Nullable`1 sendInvitationsMode, ServiceErrorHandling errorHandling)\n    at Microsoft.Exchange.WebServices.Data.ExchangeService.CreateItem(Item item, FolderId parentFolderId, Nullable`1 messageDisposition, Nullable`1 sendInvitationsMode)\n    at Microsoft.Exchange.WebServices.Data.Item.InternalCreate(FolderId parentFolderId, Nullable`1 messageDisposition, Nullable`1 sendInvitationsMode)\n    at Microsoft.Exchange.WebServices.Data.EmailMessage.InternalSend(FolderId parentFolderId, MessageDisposition messageDisposition)\n    at Microsoft.Exchange.WebServices.Data.EmailMessage.Send()\n</code></pre>\n"},{"tags":["c#",".net","debugging","windbg","sos"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":902,"score":3,"question_id":8417431,"title":"WinDbg : Copy of SOS.dl x86 4.0.30319.237","body":"<p>Am using WinDbg to look into a process dump. The dump has been taken on an x86 server with Dotnet 4 SP1 (4.0.30319.237).\nI'm attempting to debug on my x64 machine using the x86 version of WinDbg - but get the following issue.</p>\n\n<p>0:000> !EEVersion\nThe version of SOS does not match the version of CLR you are debugging.  Please\nload the matching version of SOS for the version of CLR you are debugging.\nCLR Version: 4.0.30319.237\nSOS Version: 4.0.30319.239\n4.0.30319.237 retail\nWorkstation mode\nSOS Version: 4.0.30319.239 retail build</p>\n\n<p>As my machine has taken a recent security patch the SOS dll is now at version 4.0.30319.239 so I am unable to use any of the CLR extensions in WinDbg.\nI have connected to MS symbol servers and got the correct version of mscordacwks.dll.</p>\n\n<p>Can anyone point me to where I can get a copy of SOS.dll version 4.0.30319.237?</p>\n\n<p>The best match I get online is via <a href=\"http://support.microsoft.com/kb/2533523/\" rel=\"nofollow\">http://support.microsoft.com/kb/2533523/</a>, however this cannot be installed on my machine (and I don't have a second one) as it's already superceeded.</p>\n\n<p>Nightmare!</p>\n\n<p>Cheers.\nGlendon</p>\n"},{"tags":[".net","wcf","web-services"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":2897,"score":7,"question_id":5807147,"title":"Web Service Configuration Problem","body":"<p>I host 2 WCF web services and 1 standard .NET web service from an application directory.  The .NET service and 1 of the WCF services works perfectly; however, the other WCF service is returning the following error:</p>\n\n<blockquote>\n  <p>The service cannot be activated because it does not support ASP.NET compatibility. ASP.NET compatibility is enabled for this application. Turn off ASP.NET compatibility mode in the web.config or add the AspNetCompatibilityRequirements attribute to the service type with RequirementsMode setting as 'Allowed' or 'Required'.</p>\n</blockquote>\n\n<p>Both WCF web services have the line</p>\n\n<pre><code>&lt;AspNetCompatibilityRequirements(RequirementsMode:=AspNetCompatibilityRequirementsMode.Allowed)&gt; _\n</code></pre>\n\n<p>and the web.config file has </p>\n\n<pre><code>&lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\" /&gt;\n</code></pre>\n\n<p>To add more confusion to the mix, when I change</p>\n\n<pre><code>AspNetCompatibilityRequirementsMode.Allowed\n</code></pre>\n\n<p>to</p>\n\n<pre><code>AspNetCompatibilityRequirementsMode.Required\n</code></pre>\n\n<p>the service works just fine.</p>\n\n<p>Also, changing</p>\n\n<pre><code>&lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\" /&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"false\" /&gt;\n</code></pre>\n\n<p>in the web.config also allows all web services to function.</p>\n\n<p>This problem is presenting on both IIS7 and our staging enviorment hosted on SBS2003 running IIS6.</p>\n\n<p>Thank you in advance for all of your help.<br>\nJake</p>\n\n<p><strong>UPDATE:</strong><br>\nI was able to get it to work by deleting the application on my development system; however, the problem still persists on our staging server, even after deleting the application and recreating it there.</p>\n\n<p><strong>WORK AROUND:</strong>  </p>\n\n<ol>\n<li>Delete the Application from IIS</li>\n<li>Recreate the direcotry</li>\n<li>Create a New Application Pool</li>\n<li>In the properties of the direcotry, create the Application and associate it to the new Application Pool.</li>\n</ol>\n\n<p>What a pain.</p>\n"},{"tags":["c#",".net","asp.net","sharepoint"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":3262690,"title":"what are wss and moss libraries available in .net framework","body":"<p>In .net framework. what are libraries available for working in sharepoint and their uses </p>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13195229,"title":"convert excelsheet field into datetime data type and insert into sql table","body":"<p>i have one excel file which contain one field name logingdate. \nnow i am transferring data from excel sheet to sql table but there is one problem .</p>\n\n<p>how to convert excel sheet's field of logingdate in sql table's datetime data type.</p>\n\n<p>i want to store that excel sheet data in sql table which has filed with data type datetime.\n   here is the code.</p>\n\n<pre><code>    string strFileName = Path.GetFileName(ddlExcelFile.SelectedValue);\n    OleDbConnection oconn = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + Server.MapPath(\"~/ExcelSheets/\" + strFileName) + \";Extended Properties='Excel 12.0;HDR=YES';\");\n    try\n    {\n        //After connecting to the Excel sheet here we are selecting the data\n        //using select statement from the Excel sheet\n        OleDbCommand ocmd = new OleDbCommand(\"select * from [System Users$]\", oconn);\n        oconn.Open(); //Here [Sheet1$] is the name of the sheet\n        //in the Excel file where the data is present\n        OleDbDataReader odr = ocmd.ExecuteReader();\n        string LoginID = \"\";\n        string FirstName = \"\";\n        string LastName = \"\";\n        string Email = \"\";\n        string IsActive=\"\";\n        string LastUpdateOn;\n        string ProjectAccess = \"\";\n        while (odr.Read())\n        {\n            LoginID = valid(odr, 0);//Here we are calling the valid method\n            FirstName = valid(odr, 1);\n            LastName = valid(odr, 2);\n            Email = valid(odr, 3);\n            IsActive = valid(odr, 4);\n            LastUpdateOn = valid(odr, 5);\n            ProjectAccess = valid(odr, 6);\n            //Here using this method we are inserting the data into the database\n            insertdataintosql(LoginID, FirstName, LastName, Email, IsActive, LastUpdateOn, ProjectAccess);\n        }\n        oconn.Close();\n    }\n    catch (DataException ee)\n    {\n        lblmsg.Text = ee.Message;\n        lblmsg.ForeColor = System.Drawing.Color.Red;\n    }\n    finally\n    {\n        lblmsg.Text = \"Data Inserted Sucessfully\";\n        lblmsg.ForeColor = System.Drawing.Color.Green;\n    }\n}\n\nprotected string valid(OleDbDataReader myreader, int stval)//if any columns are\n//found null then they are replaced by zero\n{\n    if(stval==4)\n    {\n        object val = myreader[stval];\n\n        if (Convert.ToInt32(val)==1)\n            return Convert.ToString(true);\n        else\n            return Convert.ToString(false);\n    }        \n    else\n    {\n        object val = myreader[stval];\n        if (val != DBNull.Value)\n            return val.ToString();\n        else\n            return Convert.ToString(0);\n    }\n}\n\npublic void insertdataintosql(string LoginID, string FirstName, string LastName, string Email, string IsActive, string LastUpdateOn, string ProjectAccess)\n{//inserting data into the Sql Server\n    SqlConnection conn = new SqlConnection(\"Data Source=NET07;Integrated Security=False;Initial Catalog=IrisDevon; User Id=sa; password=kk;\");\n    SqlCommand cmd = new SqlCommand();\n    cmd.Connection = conn;\n    cmd.CommandText = \"insert into ImportSystemUsers(UserName,FirstName,LastName,Email,IsActive,LastUpdateOn)values(@UserName,@FirstName,@LastName,@Email,@IsActive,@LastUpdateOn)\";\n    cmd.Parameters.Add(\"@UserName\", SqlDbType.NVarChar).Value = LoginID;\n    cmd.Parameters.Add(\"@FirstName\", SqlDbType.NVarChar).Value = FirstName;\n    cmd.Parameters.Add(\"@LastName\", SqlDbType.NVarChar).Value = LastName;\n    cmd.Parameters.Add(\"@Email\", SqlDbType.NVarChar).Value = Email;\n    cmd.Parameters.Add(\"@IsActive\", SqlDbType.Bit).Value =Convert.ToBoolean(IsActive);\n    string dt1 = Convert.ToDateTime(LastUpdateOn.Trim()).ToString();\n    cmd.Parameters.Add(\"@LastUpdateOn\", SqlDbType.DateTime).Value = dt1;//error here\n    cmd.Parameters.Add(\"@ProjectAccess\", SqlDbType.NVarChar).Value = ProjectAccess;\n    cmd.CommandType = CommandType.Text;\n    conn.Open();\n    cmd.ExecuteNonQuery();\n    conn.Close();\n}\n</code></pre>\n\n<p>as i mention in code where the error occurred.</p>\n"},{"tags":["c#",".net","wpf","app-config","enterprise-library"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13195135,"title":"App.Config Resolution Failure","body":"<p>I have a C# WPF application that is experiencing a weird issue.   The app uses the MS Enterprise Library (Logging) which is configured using the app.config.  My deployed files hence are: </p>\n\n<p>(names changed, filename lengths correct)</p>\n\n<p>XXXXXXXXXXX.EXE</p>\n\n<p>XXXXXXXXXXX.EXE.CONFIG</p>\n\n<p>Normally this works just fine.  However, in one bizarre situation the app is  launched by another program that calls the EXE based on it's shortname (XXXXXX~X.EXE).  The EXE starts but then proceeds to look for an app.config that doesn't exist (XXXXXX~X.EXE.CONFIG ) and the Logging class fails to initialize.</p>\n\n<p>I can't change the program that launches us so I'm trying to figure out ways guarding against this in my WPF code.  Thoughts are...</p>\n\n<p>1) Rename my EXE and create a man in the middle EXE.</p>\n\n<p>2) Detect how my EXE was launched and relaunch it correctly.</p>\n\n<p>3) Some kind of AppDomain / ConfigurationManager repointing  ( Is this possible? )</p>\n\n<p>4) Use the installer to clone the App.Config to the short file name version (confirmed works)</p>\n\n<p>Has anyone ever seen this before and have any suggestions / insight?</p>\n"},{"tags":["asp.net",".net","repeater","grouping"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13196686,"title":"Nested repeaters - grouping data","body":"<p>I'm beginning with ASP.NET and I'm wondering, if there is any \"smart\" way of displaying data from DataTable in groups?<br>\nImagine following example: I get data from SQL to datatable grouped and sorted alredy:</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n{\n    DataTable dt = new DataTable();\n    dt.Columns.Add(\"parent\", typeof(string));\n    dt.Columns.Add(\"child\", typeof(string));\n    dt.Rows.Add(\"AAA\", \"111\");\n    dt.Rows.Add(\"AAA\", \"222\");\n    dt.Rows.Add(\"AAA\", \"333\");\n    dt.Rows.Add(\"BBB\", \"444\");\n    dt.Rows.Add(\"BBB\", \"555\");\n    dt.Rows.Add(\"CCC\", \"666\");\n    dt.Rows.Add(\"CCC\", \"777\");\n    dt.Rows.Add(\"CCC\", \"888\");\n\n    repeaterParent.DataSource = dt;\n    repeaterParent.DataBind();\n}\n</code></pre>\n\n<p>and I want to display them  on page like below:<br>\n<img src=\"http://i.stack.imgur.com/xjlDl.png\" alt=\"enter image description here\"></p>\n\n<p>I've tried to use nested repeaters for that:</p>\n\n<pre><code>&lt;asp:Repeater ID=\"repeaterParent\" runat=\"server\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;b&gt;&lt;%# DataBinder.Eval(Container.DataItem, \"parent\") %&gt;&lt;/b&gt;\n        &lt;br /&gt; \n        &lt;asp:repeater id=\"repeaterChild\" runat=\"server\"&gt;\n            &lt;itemtemplate&gt;\n                    - &lt;%# DataBinder.Eval(Container.DataItem, \"child\") %&gt; &lt;br /&gt;\n            &lt;/itemtemplate&gt;\n        &lt;/asp:repeater&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:Repeater&gt;\n</code></pre>\n\n<p>Of course it doesn't work - the result is following - it's neither grouped nor a child is being displayed:<br>\n<img src=\"http://i.stack.imgur.com/yD1wb.png\" alt=\"enter image description here\"></p>\n\n<p>How can it be done - the control doesn't have to be repeater - it could be listview, bulleted list or something similar.  </p>\n\n<p>Best, if there's some \"smart\" way - so I just bind datatable to datasource, and the control makes the rest (grouping) for me. I would prefer to avoid splitting datasource table into two different sources or making SQL query for each parent item and playing with ItemDataBound event - as long as it's possible. If not - can you show me <strong>any</strong> way of doing that?  .NET version: 4.0</p>\n\n<p>Best regards,<br>\nMarcin</p>\n\n<p><strong>--Edit:</strong><br>\nI've found following solution, however, I don't really like it because costly filtering source table for each item, I'm not sure how it will behave with large source datatable. I'll gladly hear if there's a better solution:  </p>\n\n<pre><code>protected void repeaterParent_ItemDataBound(object sender, RepeaterItemEventArgs e)\n{\n    DataRowView drv = (DataRowView)e.Item.DataItem;\n    string parent = drv[\"parent\"].ToString();\n\n    dt.DefaultView.RowFilter = string.Format(\"[parent]='{0}'\", parent);\n    DataTable dtChild =  dt.DefaultView.ToTable(true, \"child\");\n\n    Repeater repeaterChild = (Repeater)e.Item.FindControl(\"repeaterChild\");\n    repeaterChild.DataSource = dtChild;\n    repeaterChild.DataBind();\n\n}\n</code></pre>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13194732,"title":"How to bind properly array to datagridview?","body":"<p>There are a Dependency class with some properties</p>\n\n<pre><code>class Dependency:\n{\n     public string ArtifactId { get; set; }\n     public string GroupId { get; set; }\n     public string Version { get; set; }\n\n     public Dependency() {}\n}\n</code></pre>\n\n<p>and ProjectView class:</p>\n\n<pre><code> class ProjectView:\n {\n     public string Dependency[] { get; set; }\n        ...\n }\n</code></pre>\n\n<p>I want to bind array of Dependencies from ProjectView class to DataGridView.</p>\n\n<pre><code> class Editor\n {\n     private readonly ProjectView _currentProjectView;\n\n     ... //I skipped constructor and other methods  \n\n     private void PopulateTabs()\n     {\n        BindingSource source = new BindingSource {DataSource = _currentProjectView.Dependencies, AllowNew = true};\n        dataGridViewDependencies.DataSource = source;\n     } \n  }\n</code></pre>\n\n<p>But when I'm binding like that, then exception occurs (AllowNew can only be set to true on an IBindingList or on a read-write list with a default public constructor.), because _currentProjectView.Dependencies is array, and it can't be able to add new items.\nThere is solution is convert to list, but it is not convenient, because it's just copy and lost reference to origin array. Is there solution of this problem? How to bind properly array to datagridview?\nThanks.</p>\n"},{"tags":[".net","wcf","nancy"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13182956,"title":"Nancy website and Nancy wcf host in different projects","body":"<p>I want to have Nancy powered website with <code>Nancy.Hosting.Aspnet</code> dependency in one VS project and dedicated project for WCF service hosting this web site. The idea behind to test performance and have ability to choose what to use IIS or my own service.</p>\n\n<p>To the references of WCF project I've added web site project. How it might become possible to host Nancy that way?</p>\n\n<p>How to tell Nancy to search Modules not in the current executable, but in DLL attached to it? What conditions should be met? The best guess for now is to make Namespaces agree, but no luck for now. If it helps here is the code I'm using to run Nancy from WCF executable (it's standard):</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>class Program\n{\n    private static readonly Uri BaseUri = new Uri(\"http://localhost:1234/\");\n\n    static void Main(string[] args)\n    {\n        AppDomainAssemblyTypeScanner.LoadAssemblies(\"Basta.dll\");\n\n        using (CreateAndOpenWebServiceHost())\n        {\n            Console.WriteLine(\"Service is now running on: {0}\", BaseUri);\n            Console.ReadLine();\n        }\n    }\n\n    private static WebServiceHost CreateAndOpenWebServiceHost()\n    {\n        var host = new WebServiceHost(\n            new NancyWcfGenericService(new Basta.Bootstrapper()),\n            BaseUri);\n\n        host.AddServiceEndpoint(typeof(NancyWcfGenericService), new WebHttpBinding(), \"\");\n        host.Open();\n\n        return host;\n    }\n}\n</code></pre>\n\n<p>I've used approach from <a href=\"http://stackoverflow.com/q/8139096/1047741\">this question</a> (by calling <code>AppDomainAssemblyTypeScanner.LoadAssemblies</code>), but didn't worked, unfortunately.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13197471,"title":"How to get installed image editors","body":"<p>Is there a code to get all the image editing software the user has installed?\nI would like to know how to list all the applications by going through registry, is there any way to then filter out only the apps that can edit images, like Paint, Photoshop, etc...?</p>\n\n<p>Thanks!</p>\n"},{"tags":["c#",".net","vb.net","visual-c++","text-to-speech"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":13102319,"title":"I need help creating a lexicon for SpeechSynthesizer. A template of some kind so i can know how to create one","body":"<p>More or less what the title says. I wish to create a lexicon of greek text to speech so I can make SpeechSynthesizer speak my language for SpeechSynthesizer. Where can I find a template of some kind?? Or some guidelines???? Or anything you can possibly offer is acceptable as there is no greek suppport in SpeechSynthesizer. But i need it to be my own creation. Not some third party app. SDKs, header files, libraries, all accepted. Just no ready apps that have greek text to speech</p>\n"},{"tags":[".net","merge","3-way-merge"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13127165,"title":"3way Merge lib for .NET","body":"<p>I have no idea how I would implement a DVCS style merge in .NET. From my understanding its a 3way diff using mine, theirs and origin. I did a google search and found <a href=\"http://razor.occams.info/code/diff/\" rel=\"nofollow\">http://razor.occams.info/code/diff/</a> which appears to be a patch kind of merge (mine/original, theirs) which isn't the merge type I want. I tried doing a search with nuget and didn' find a merge there</p>\n\n<p>Is there any 3 way merge libs for .NET?</p>\n"},{"tags":["c#",".net","struct","nullable"],"answer_count":3,"favorite_count":0,"up_vote_count":12,"down_vote_count":1,"view_count":139,"score":11,"question_id":12886429,"title":"Why does some methods work while some do not on null values of nullable structs?","body":"<p>Straight to the point:</p>\n\n<pre><code>int? i = null;\ni.ToString(); //happy\ni.GetType(); //not happy\n</code></pre>\n\n<p>I get a <a href=\"http://stackoverflow.com/questions/11446838/why-does-tostring-on-a-null-string-cause-a-null-error-when-tostring-works\">very related question</a> which actually deals on why does <code>i.ToString()</code> work fine.</p>\n\n<p><strong>Edit:</strong> Just found out this corner case has been <a href=\"http://stackoverflow.com/a/194671/661933\">the most voted one in this SO thread!</a></p>\n"},{"tags":["c#",".net","windows"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":129,"score":2,"question_id":12098164,"title":"What causes the \"Page Header plus Page Footer is too large for the page\" error in Crystal Reports?","body":"<p>I have used the following code for a print button:</p>\n\n<pre><code>Data.str = null;\n//Data.str = textBox24.Text.ToString();\nstring s = \"select * from temp_bond\";\ncn.ConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + Application.StartupPath + \"\\\\Real.mdb\";\ncn.Open();\n\nDataSet ds = new DataSet();\n\nOleDbDataAdapter da = new OleDbDataAdapter(s, cn);\nds.Clear();\nda.Fill(ds);\nBond rpt = new Bond();\nrpt.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, \"BOND_\" + Data.str + \".pdf\");\nSystem.Diagnostics.Process.Start(\"BOND_\" + Data.str + \".pdf\");\n//r.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, \"E:\\\\rep.pdf\");\n//crystalReportViewer1.ReportSource = r;\nOleDbCommand cm1 = new OleDbCommand(\"delete * from temp_bond\", cn);\ncm1.ExecuteNonQuery();\ncn.Close();\n</code></pre>\n\n<p>and I'm getting an error in this code:</p>\n\n<pre><code>rpt.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, \"BOND_\" + Data.str + \".pdf\");\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>Page Header plus Page Footer is too large for the page. Error in File\n  C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\temp_3f674868-8e5d-46ce-80eb-dce78bb2ba89\n  {17674136-B71E-4C6F-9E36-1CEB514B13BF}.rpt: Page header or footer\n  longer than a page.</p>\n</blockquote>\n\n<p>What can cause this and how can I fix it?</p>\n"},{"tags":[".net","multithreading","thread-safety",".net-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13197295,"title":"How do I elegantly finalize objects that own threads and raise events?","body":"<p>The question is about what to do when the caller <em>forgets</em> to dispose of my object. Thus I've skipped implementing <code>IDisposable</code> for brevity. My questions are: <strong>How dangerous is the last code sample?</strong> Can it be improved? Or maybe I'm obsessing over elegance too much? Or maybe there's another pattern to do this better already?</p>\n\n<p>The story begins with an attempt to wrap some long running process so it an be safely accessed from the main thread.</p>\n\n<pre><code>Public Class ThisCantRaiseEvents\n    Private client As UdpClient\n\n    Public Sub New(ByVal client As UdpClient)\n        Me.client = client\n        Dim thread As New Thread(AddressOf DoWork)\n        thread.IsBackground = True\n        thread.Start(client)\n    End Sub\n\n    Public Event PacketReceived As EventHandler\n\n    Protected Overrides Sub Finalize()\n        client.Close()\n    End Sub\n\n    Private Shared Sub DoWork(ByVal state As Object)\n        Dim client As UdpClient = DirectCast(state, UdpClient)\n        Try\n            While True\n                client.Receive(Nothing)\n            End While\n        Catch ex As Exception\n        End Try\n    End Sub\nEnd Class\n</code></pre>\n\n<p>The naive attempt at dispatching events to the main thread. Works well but never goes out of scope because its own thread keeps it alive. (Remember, threads don't die if their Thread object goes out of scope.)</p>\n\n<pre><code>Public Class ThisWillLeak\n    Private client As UdpClient\n    Private mainThread As Control\n\n    Public Sub New(ByVal client As UdpClient, ByVal control As Control)\n        Me.client = client\n        Me.mainThread = control\n        Dim thread As New Thread(AddressOf DoWork)\n        thread.IsBackground = True\n        thread.Start()\n    End Sub\n\n    Public Event PacketReceived As EventHandler\n\n    Protected Overrides Sub Finalize()\n        client.Close()\n    End Sub\n\n    Protected Overridable Sub OnPacketReceived(ByVal e As EventArgs)\n        RaiseEvent PacketReceived(Me, e)\n    End Sub\n\n    ' The worker thread has a pointer to ThisWillLeak\n    ' and so it will live forever!\n    Private Sub DoWork(ByVal state As Object)\n        Try\n            While True\n                client.Receive(Nothing)\n                mainThread.BeginInvoke(New Action(Of EventArgs) _\n                (AddressOf OnPacketReceived), EventArgs.Empty)\n            End While\n        Catch ex As Exception\n        End Try\n    End Sub\nEnd Class\n</code></pre>\n\n<p>' This was my first attempt at solving the problem in the previous sample. Alas, it get very ugly very quickly as the DoWork method becomes more complex.</p>\n\n<pre><code>Public Class ThisIsVeryUgly\n    Private client As UdpClient\n    Private mainThread As Control\n\n    Public Sub New(ByVal client As UdpClient, ByVal control As Control)\n        Me.client = client\n        Me.mainThread = control\n        Dim thread As New Thread(AddressOf DoWork)\n        thread.IsBackground = True\n        thread.Start(New WeakReference(Me))\n    End Sub\n\n    Public Event PacketReceived As EventHandler\n\n    Protected Overrides Sub Finalize()\n        client.Close()\n    End Sub\n\n    Protected Overridable Sub OnPacketReceived(ByVal e As EventArgs)\n        RaiseEvent PacketReceived(Me, e)\n    End Sub\n\n    Private Shared Sub DoWork(ByVal state As Object)\n        Dim weakThis As WeakReference = DirectCast(state, WeakReference)\n        Dim this As ThisIsVeryUgly = DirectCast(weakThis.Target, ThisIsVeryUgly)\n        Dim client As UdpClient = this.client\n        this = Nothing\n        Try\n            While True\n                client.Receive(Nothing)\n                this = DirectCast(weakThis.Target, ThisIsVeryUgly)\n                this.mainThread.BeginInvoke(New Action(Of EventArgs) _\n                (AddressOf this.OnPacketReceived), EventArgs.Empty)\n                this = Nothing\n                ' Repeat for every other place we need to raise an event! Ugh!\n            End While\n        Catch ex As Exception\n        End Try\n    End Sub\nEnd Class\n</code></pre>\n\n<p>This is my newest invention. It's elegant but has the potential to cause problems because the <code>sender</code> argument of the events it raises is not what the user would expect. <strong>Can this cause me any problems?</strong></p>\n\n<pre><code>Public Class ThisIsAlmostGood\n    Private client As UdpClient\n    Private worker As WorkThread\n\n    Public Sub New(ByVal client As UdpClient, ByVal mainThread As Control)\n        Me.client = client\n        worker = New WorkThread(client, mainThread)\n    End Sub\n\n    Public Custom Event PacketReceived As EventHandler\n        AddHandler(ByVal value As EventHandler)\n            AddHandler worker.PacketReceived\n        End AddHandler\n        RemoveHandler(ByVal value As EventHandler)\n            RemoveHandler worker.PacketReceived\n        End RemoveHandler\n        RaiseEvent(ByVal sender As Object, ByVal e As EventArgs)\n        End RaiseEvent\n    End Event\n\n    Protected Overrides Sub Finalize()\n        client.Close()\n    End Sub\n\n    Private Class WorkThread\n        Private client As UdpClient\n        Private mainThread As Control\n\n        Public Sub New(ByVal client As UdpClient, ByVal mainThread As Control)\n            Me.client = client\n            Me.mainThread = mainThread\n            Dim thread As New Thread(AddressOf DoWork)\n            thread.IsBackground = True\n            thread.Start()\n        End Sub\n\n        Public Event PacketReceived As EventHandler\n\n        Protected Overridable Sub OnPacketReceived(ByVal e As EventArgs)\n            ' But the user expects a pointer to ThisIsAlmostGood,\n            ' not WorkThread! Should I pass Nothing instead?\n            RaiseEvent PacketReceived(Me, e)\n        End Sub\n\n        Private Sub DoWork(ByVal state As Object)\n            Try\n                While True\n                    client.Receive(Nothing)\n                    mainThread.BeginInvoke(New Action(Of EventArgs) _\n                    (AddressOf OnPacketReceived), EventArgs.Empty)\n                End While\n            Catch ex As Exception\n            End Try\n        End Sub\n    End Class\nEnd Class\n</code></pre>\n"},{"tags":[".net","crystal-reports"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":32,"score":-1,"question_id":13194955,"title":"How to supress a string field in crystal report if text size exceeded field bounds?","body":"<p>I've a string field in my crystal report that show certain string data that must be shown as a whole from first char to last char and i can't predict maximum length of this string.Is there a way to suppress this field or to show warning message in this field if string in it exceeds the bounds ? Please notice that i don't want to use text wrapping in this field</p>\n"},{"tags":[".net","winforms","idisposable","generatedcode"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":446,"score":1,"question_id":450596,"title":"IDisposable Winform","body":"<p>What is the best practice for implementing IDisposable on a Winform?</p>\n\n<ul>\n<li>I have a dialog which extends System.Windows.Forms.Form</li>\n<li>The generated designer.cs already contains an implementation of the virtual Dispose(bool) method</li>\n<li>My form has a field added manually which implements IDisposable</li>\n</ul>\n\n<p>Ideally I would be able to hook into the Dispos(bool) override in the generated code to dispose the manually added IDisposable object. Any recommendations on how to do this properly?</p>\n\n<p>Thanks.</p>\n\n<p>Scott</p>\n"},{"tags":["c#",".net","security","zip","fips"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":298,"score":2,"question_id":8447367,"title":"FIPS 140-2 compliant .NET Zip Solution?","body":"<p>Other than Xceed, is there a Zip library for .NET that uses encryption algorithms that can be used in a FIPS 140-2 enabled environment?</p>\n\n<p>FYI I have read on DotNetZip but it uses WinZipAes, based on Rijndael which is not FIPS 140-2 compliant. Also I have checked Rebex but only their SFTP component is FIPS compliant.</p>\n\n<p>Edit: For the Zip solution I am looking for, the only FIPS requirement I have is that it uses compatible algorithms (such as CryptoServiceProvider or Cng classes in .NET).</p>\n"},{"tags":["c#",".net","xaml","button","click"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13195761,"title":"Which event can I use to trigger an update to a label before the click event is triggered by hitting enter on the keyboard?","body":"<p>I have an application that does some pretty complicated calculations when a button is clicked.   I'm still trying to get this code more efficient but in the meantime I want to give the user feedback to show that the button has been clicked and the calculations are in progress by updating a label on the UI.  </p>\n\n<p>The UI is not updated until the click event has been completed so I have to put the code into an event that is called just before the click event's code is triggered.</p>\n\n<p>So far I'm using the <code>PreviewMouseLeftButtonDown</code> event which is called before the click event is executed to update the label.  This works for a mouse click.<br>\n BUT if the user hits Enter while the button is in focus it appears as though the <code>PreviewKeyDown</code> AND <code>KeyDown</code> events are never triggered, or at least not triggered before the Click event is triggered.</p>\n\n<p>What event can I use to update the label when the enter key is hit OR do you know of another way I can get the label to update before the Click Event's Code is run?</p>\n\n<p>Update: I've noticed that the <code>PreviewKeyDown</code> event is triggered before the <code>click</code> event, but I don't see the label updating before the <code>click</code> event code is run.  I don't see anything wrong with my code.</p>\n\n<pre><code>    private void Button1_KeyDown(object sender, KeyEventArgs e)\n    {\n        try\n        {\n            if (e.Key == Key.Return || e.Key == Key.Enter)\n            {\n                lblMessage.Content = \"Loading...\";\n            }\n        }\n        catch (Exception)\n        {\n\n        }\n    }\n</code></pre>\n"},{"tags":["c#",".net"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13197149,"title":"Lower the privilege of an open process","body":"<p>Was wondering how i'd go about lowering a processes privileges ? I've seen how to elevate my own process using tokens but not how to lower some other process (not one that I started myself) lets say notepad for example.</p>\n\n<p>thanks</p>\n"},{"tags":["c#",".net","xml","visual-studio-2010","xsd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13197071,"title":"How to import XML data in using .NET and C#","body":"<p>I have a set of xsd files and xml data files. I need to import data from xml files to database. I have .NET 4.0 and Visual Studio 2010. </p>\n\n<p>Which tools can I use? Ideally it should be something, what helps me to read data as entities composed from xml structure.</p>\n"},{"tags":["asp.net",".net","webclient","webclient-download"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13192565,"title":"System.Net.WebClient returned not all data from file","body":"<p>I try <code>download file via WebClient</code>, but it returned not all bytes from file. <code>Original file has 45Kb</code>, It <code>download only 8kb</code> from total file. It happened after I added <em>user-agent</em> header.</p>\n\n<p>My code is:</p>\n\n<pre><code>using (ZipFile zip = new ZipFile())\n{\n     foreach (KeyValuePair&lt;string, string&gt; i in filesToInclude)\n     {\n         System.Net.WebClient wc = new System.Net.WebClient();\n         wc.Credentials = System.Net.CredentialCache.DefaultCredentials;\n         wc.UseDefaultCredentials = true;\n         wc.Headers.Add(\"user-agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)\");\n         string downloadUrl = SPContext.Current.Site.Url + i.Key;    \n         AppClass.WriteToLog(string.Format(\"downloadUrl: {0}\", downloadUrl));\n         byte[] img = wc.DownloadData(downloadUrl);\n         zip.AddEntry(i.Value, img);\n      }\n      zip.Save(Response.OutputStream);\n    }\n</code></pre>\n\n<p>Have you any ideas?</p>\n\n<p><strong>UPDATE:</strong> in the previous version <code>url</code> doesn't build correctly. I change my code to:</p>\n\n<pre><code>using (ZipFile zip = new ZipFile())\n{\n     foreach (KeyValuePair&lt;string, string&gt; i in filesToInclude)\n     {\n          System.Net.WebClient wc = new System.Net.WebClient();\n          wc.Credentials = System.Net.CredentialCache.DefaultCredentials;\n          wc.UseDefaultCredentials = true;\n          wc.Headers.Add(\"user-agent\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)\");\n          string downloadUrl = SPContext.Current.Site.Url + i.Key;\n          Uri uri = new Uri(downloadUrl);\n          AppClass.WriteToLog(string.Format(\"downloadUrl: {0}\\nUri.AbsoluteUri: {1}\", downloadUrl, uri.AbsoluteUri));\n          byte[] img = wc.DownloadData(uri.AbsoluteUri);\n\n          if (!wc.ResponseHeaders.Get(0).Contains(\"OK\"))\n          {\n               AppClass.WriteToLog(\"Unable to donwload the file\");\n          }\n          zip.AddEntry(i.Value, img);\n      }\n\n      zip.Save(Response.OutputStream);\n}\n</code></pre>\n\n<p>And now I have another problem. <code>The remote server returned an error: (403) Forbidden</code></p>\n"},{"tags":["c#",".net","visual-studio-2010",".net-4.0","bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":11476341,"title":"\"install location for prerequisites has not been set\" vs 2010 .net 4.0","body":"<p>This is not really a question anymore as I stumbled on the solution myself, but I thought it worth sharing as I could not find it after 20 google searches.</p>\n\n<p>When publishing a vs 2010 c# program with .net 4.0 framework dependencies, I wanted to \"download prerequisites from the same location as my application\".  Well, this failed like it has in the past for .net 3.5 (according to hundreds of forum posts).  The solution wound up being 100 times simpler than any post I found...</p>\n\n<p>So, all I had to do was download \"dotNetFx40_Client_x86_x64.exe\" from <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=24872\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=24872</a> and copy it into \"DotNetFX40Client\" in my bootstrapper folder.</p>\n\n<p>I'm running Windows 7 Pro x64, so the SDK bootstrappers were in</p>\n\n<pre><code>C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bootstrapper\\Packages\n</code></pre>\n\n<p>Likewise, I got the \"WindowsInstaller-KB893803-v2-x86\" from <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=25\" rel=\"nofollow\">http://www.microsoft.com/en-us/download/details.aspx?id=25</a> and put it in \"WindowsInstaller3_1\"</p>\n\n<p>Hope this helps, and I hope I didn't violate any Stack Overflow rules by posting a solution.  All the other questions here were related to .net 3.5</p>\n"},{"tags":["c#",".net","wpf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12975654,"title":"System.Windows.Application class instance won't show second window","body":"<p>I have a WPF desktop application where I want to check if I can connect to my database with EF before launching the main window. So I try to connect to database and if exception occurs, I simply show a window where I ask the user to enter correct database connection string.</p>\n\n<p>After user enters the connection string, I retry connecting to database and if it connects I want to launch my main window and let the application start.</p>\n\n<p>EDIT: I changed my code a liitle bit, but still doesn't work. I think it is about closing one window and then trying to show another window in Application class. <strong>It works if ServerConfigurationWin is not shown.</strong></p>\n\n<p>However what happens is, after I display the database configuration window to user, <strong>the application calls the StartupUri window's constructor declared in App.xaml file but nothing shows on screen.</strong></p>\n\n<p>Thanks.</p>\n\n<p>Here is my App code:</p>\n\n<pre><code>public partial class App : Application\n{\n    protected override void OnStartup(StartupEventArgs e)\n    {\n        base.OnStartup(e);\n\n        bool success = false;\n        while (!success)\n        {\n            try\n            {\n                DemirbasContext context = new DemirbasContext();\n                DbInitializer initializer = new DbInitializer();\n                Database.SetInitializer&lt;DemirbasContext&gt;(initializer);\n                context.Database.Initialize(false);\n                success = true;\n            }\n            catch (ProviderIncompatibleException)\n            {\n                ServerConfigurationWin configurationWin = new ServerConfigurationWin();\n                if (!configurationWin.ShowThemAll())\n                {\n                    // ShowThemAll() returns that operation is canceled.\n                    App.Current.Shutdown();\n                    return;\n                }\n                success = false;\n            }\n        }\n    }\n\n    public App()\n    {\n\n    }\n\n    void App_DispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)\n    {\n        // Process unhandled exception do stuff below\n        Console.WriteLine(\"***Message***\");\n        Console.WriteLine(e.Exception.Message);\n        Console.WriteLine(\"***Stack Trace***\");\n        Console.WriteLine(e.Exception.StackTrace);\n        Console.WriteLine(\"***Target Site***\");\n        Console.WriteLine(e.Exception.TargetSite);\n        // Prevent default unhandled exception processing\n        e.Handled = true;\n    }\n}\n</code></pre>\n\n<p>App.xaml:</p>\n\n<pre><code>&lt;Application x:Class=\"Demirbas.App\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         DispatcherUnhandledException=\"App_DispatcherUnhandledException\"\n         StartupUri=\"Enterance.xaml\"&gt;\n&lt;Application.Resources&gt;\n    &lt;Style TargetType=\"Button\"&gt;\n        &lt;Setter Property=\"Height\" Value=\"25\" /&gt;\n        &lt;Setter Property=\"Width\" Value=\"75\" /&gt;\n        &lt;Setter Property=\"MinWidth\" Value=\"25\" /&gt;\n        &lt;Setter Property=\"Margin\" Value=\"5,0\" /&gt;\n        &lt;Setter Property=\"Padding\" Value=\"0\" /&gt;\n    &lt;/Style&gt;\n    &lt;Style TargetType=\"Label\"&gt;\n        &lt;Setter Property=\"Margin\" Value=\"5,0\" /&gt;\n    &lt;/Style&gt;\n\n&lt;/Application.Resources&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["c#",".net","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13196665,"title":"MVC nullable + localization fail","body":"<p>In my country (Croatia), currency values are formatted like this:</p>\n\n<blockquote>\n  <p>123.456.789,00 kn</p>\n</blockquote>\n\n<p>I have MVC application that requires the user to enter a price of something. My model represents that field with <code>decimal?</code> variable. When user enters this number:</p>\n\n<blockquote>\n  <p>5.678,22</p>\n</blockquote>\n\n<p>MVC returns this error message:</p>\n\n<blockquote>\n  <p>The value xxx is not valid for the field.</p>\n</blockquote>\n\n<p>although that number is correctly formatted. After I've changed my variable data type from <code>decimal?</code> to just <code>decimal</code>, everything works (user can enter number 5.678,22 and MVC doesn't return an error).</p>\n\n<p>So my question is: what's going on? Is it possible that this is some kind of a bug in .NET framework? I'm using .NET framework 4.5.</p>\n"},{"tags":["c#",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13195954,"title":"Can we use List.Except to confirm a list is subset of another list","body":"<p>I have 2 lists of type long.</p>\n\n<p>List1 with values <code>{1,2,3,4,5}</code> and List2 with <code>{1,4,5,6}</code>.</p>\n\n<p>Can I use <code>List2.Except(List1)</code> to know whether List2 is a subset of List1.</p>\n"},{"tags":["c#",".net","winforms","visual-studio-2010"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":92,"score":-1,"question_id":13185416,"title":"2 in a row game","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13181258/c-sharp-using-2d-arrays-for-buttons\">c# using 2d arrays for buttons</a>  </p>\n</blockquote>\n\n\n\n<p>I'm working on a game using a 2x2 board that will be extended to a 7x6.</p>\n\n<p>I'm doing the winning detection at the moment, but I think I'm doing it the long way. There must be a much shorter way.</p>\n\n<p>The winn</p>\n\n<ol>\n<li>Horizontally</li>\n<li>Vertically</li>\n<li>Diagonally</li>\n</ol>\n\n<p>Here's a pic of game board:</p>\n\n<p><img src=\"http://i.stack.imgur.com/ZwZYd.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is how I'm currently detecting winner</p>\n\n<pre><code>if (btns[0, col].BackColor.Equals(Color.Red) &amp;&amp; btns[1, col].BackColor.Equals(Color.Red))\n{\n    MessageBox.Show(\"Red Win\");\n}\n\nif (btns[0, col].BackColor.Equals(Color.Blue) &amp;&amp; btns[1, col].BackColor.Equals(Color.Blue))\n{\n    MessageBox.Show(\"Blue Win\");\n}\n</code></pre>\n\n<p>This way seems like I have to list all combinations, and it would not be very ideal when I extend to 7x6.</p>\n\n<p>Here is the whole code of the program</p>\n\n<pre><code>namespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n\n        private Button[,] btns;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            btns = new Button[,] { { button2 , button1 },\n                                   { button4 , button3 }};\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            foreach (var btn in btns)\n            {\n                btn.Enabled = false;\n            }\n        }\n        int cc = 0;\n\n\n        private void button5_Click(object sender, EventArgs e)\n        {\n          // Button[] row1 = new Button[] {button2, button1};\n\n            for (int col = 0; col &lt; btns.GetLength(1); ++col)\n            {\n                var btn = btns[0, col];\n\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = Color.Red;\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = Color.Blue;\n                    }\n\n                    if (btns[0, col].BackColor.Equals(Color.Red) &amp;&amp; btns[1, col].BackColor.Equals(Color.Red))\n                    {\n                        MessageBox.Show(\"Red Win\");\n                    }\n\n                    if (btns[0, col].BackColor.Equals(Color.Blue) &amp;&amp; btns[1, col].BackColor.Equals(Color.Blue))\n                    {\n                        MessageBox.Show(\"Blue Win\");\n                    }\n\n                    return;\n                }\n            }\n        }\n\n\n        private void button6_Click(object sender, EventArgs e)\n        {\n           // Button[] row2 = new Button[] { button4, button3 };\n            for (int col = 0; col &lt; btns.GetLength(1); ++col)\n            {\n                var btn = btns[1, col];\n\n                if (!btn.Enabled)\n                {\n                    btn.Enabled = true;\n\n                    if (cc == 0)\n                    {\n                        cc = 1;\n                        btn.BackColor = Color.Red;\n                    }\n                    else\n                    {\n                        cc = 0;\n                        btn.BackColor = Color.Blue;\n                    }\n\n                    if (btns[1, col].BackColor.Equals(Color.Red) &amp;&amp; btns[0, col].BackColor.Equals(Color.Red))\n                    {\n                        MessageBox.Show(\"Red Win\");\n                    }\n\n                    if (btns[1, col].BackColor.Equals(Color.Blue) &amp;&amp; btns[0, col].BackColor.Equals(Color.Blue))\n                    {\n                        MessageBox.Show(\"Blue Win\");\n                    }\n                    return;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I have tried a lot of other ways but I can't seem to get it working.</p>\n"},{"tags":[".net","powershell","powershell-ise","verbose"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13196376,"title":"Why my Write-Verbose messages do not appear?","body":"<p>I have replaced some of th ecomments with:</p>\n\n<pre><code>Write-Verbose \"Doing somthing...\"\n</code></pre>\n\n<p>and I run my script via PS ISE like:</p>\n\n<pre><code>.\\FooScript.ps1 -verbose\n</code></pre>\n\n<p>But in the output window I do not see any of those messages.</p>\n\n<p>How can I make the write-Verbose messages displayed?</p>\n"},{"tags":["c#",".net","wcf","nettcpbinding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13196288,"title":"WCF InstanceContext Single or InstanceContext PerSession with static member","body":"<p>I am designing and PubSub system with WCF (for learning purposes) using netTcpBinding and Duplex Communication. In my publisher ServiceContract I have a dictionary that I need to share between all sesions, and list that I need to be session specific.</p>\n\n<p>What would be the best option for this case?</p>\n\n<ol>\n<li><strong>InstanceContext.PerSession</strong> -  with dictionary as static member, and\nlist as private member </li>\n<li><strong>InstanceContextMode.Single</strong> - dictionary as\nprivate, list will transfered to dictionary(key -user, value -\nuser's list)</li>\n</ol>\n\n<p>Another question I have, I am comming from NodeJS/EventMachine background, and I want to don't what will be more performance-wise for this kind of service - ConcurrenyMode.<strong><em>Multiple</em></strong> or ConcurrencyMode.<strong><em>Reentrant</em></strong>?</p>\n\n<p>Thanks in Advanced</p>\n"},{"tags":["c#",".net","stack-trace"],"answer_count":3,"favorite_count":7,"up_vote_count":34,"down_vote_count":0,"view_count":6394,"score":34,"question_id":531695,"title":"How to print the current Stack Trace in .NET without any exception?","body":"<p>I have a regular C# code. <strong><em>I have no exceptions</em></strong>. I want to programmatically log the current stack trace for debugging purpose. Example:</p>\n\n<pre><code>public void executeMethod() \n{\n    logStackTrace();\n    method();\n}\n</code></pre>\n"},{"tags":["c#","asp.net",".net","asp.net-1.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13190763,"title":"How to traverse this object","body":"<p>I am getting an object from a web service call and I am storing that in a hidden field by serializing the object.\nThen I am deserilizing the object and it is coming like the below screenshot :</p>\n\n<p><img src=\"http://i.stack.imgur.com/U5ixf.jpg\" alt=\"enter image description here\"></p>\n\n<p>My problem is when I am trying to access the below information by many ways, I an getting\n<strong><em>Invalid cast error</em></strong> OR <strong><em>System.InvalidCastException: Specified cast is not valid</em></strong></p>\n\n<pre><code>decodedValues[0][2].Value\ndecodedValues[1][2].Value\ndecodedValues[2][2].Value\n</code></pre>\n\n<p>--etc</p>\n\n<p>Any idea how can I get it in <strong>ASP.NET 1.1</strong>? </p>\n"},{"tags":["c#",".net","usercontrols"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13196163,"title":"How do I resolve an embedded reference when an assembly is loaded?","body":"<p>In a C# user control library project I have a reference to a DLL which instead of copying locally I include in the assembly as an embedded resource. I resolve this reference by attaching to the AppDomain.CurrentDomain.AssemblyResolve event in the constructor of the public control in my library and then loading the reference directly from the resource.</p>\n\n<p>At runtime this works fine, but if I try to add my control library to the Visual Studio (2010) Toolbox I get an error about an unresolved reference. Presumably because none of my constructors are being called.</p>\n\n<p>How can I resolve the embedded reference when the assembly is loaded?</p>\n"},{"tags":["c#",".net","windows-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":9,"view_count":65,"score":-9,"question_id":13195961,"title":"How to show my WiFi username or password in textbox?","body":"<p>I have created a simple form in c# windows form.</p>\n\n<p>in this form i took two textbox (textbox1 &amp; textbox2) &amp; a button.</p>\n\n<p>what i want is when i click on button, textbox1 should show my WiFi name or textbox2 should show my password.</p>\n"},{"tags":["c#",".net","pointers","intptr"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":102,"score":4,"question_id":13170801,"title":"Difference between IntPtr and UIntPtr","body":"<p>I was looking at the P/Invoke declaration of <a href=\"http://www.pinvoke.net/default.aspx/advapi32/RegOpenKeyEx.html\" rel=\"nofollow\"><code>RegOpenKeyEx</code></a> when I noticed this comment on the page:</p>\n\n<blockquote>\n  <p>Changed <code>IntPtr</code> to <code>UIntPtr</code>: When invoking with <code>IntPtr</code> for the handles, you will run into an Overflow. <code>UIntPtr</code> is the right choice if you wish this to work correctly on 32 and 64 bit platforms.</p>\n</blockquote>\n\n<p>This doesn't make much sense to me: both <code>IntPtr</code> and <code>UIntPtr</code> are supposed to represent pointers so their size should match the bitness of the OS - either 32 bits or 64 bits. Since these are not numbers but pointers, their signed numeric values shouldn't matter, only the bits that represent the address they point to. I cannot think of any reason why there would be a difference between these two but this comment made me uncertain.</p>\n\n<p>Is there a specific reason to use <code>UIntPtr</code> instead of <code>IntPtr</code>? According to the <a href=\"http://msdn.microsoft.com/en-us/library/system.uintptr%28v=vs.80%29.aspx\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>The <code>IntPtr</code> type is CLS-compliant, while the <code>UIntPtr</code> type is not. Only the <code>IntPtr</code> type is used in the common language runtime. The <code>UIntPtr</code> type is provided mostly to maintain architectural symmetry with the <code>IntPtr</code> type.</p>\n</blockquote>\n\n<p>This, of course, implies that there's no difference (as long as someone doesn't try to convert the values to integers). So is the above comment from pinvoke.net incorrect?</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p><strike>After reading <a href=\"http://stackoverflow.com/a/13171595/682404\">MarkH's answer</a>, I did a bit of checking and found out that .NET applications are not large address aware and can only handle a 2GB virtual address space when compiled in 32-bit mode. (One can use a <a href=\"http://stackoverflow.com/questions/1346480/how-to-make-a-net-application-large-address-aware\">hack</a> to turn on the large address aware flag but MarkH's answer shows that checks inside the .NET Framework will break things because the address space is assumed to be only 2GB, not 3GB.)</p>\n\n<p>This means that all correct virtual memory addresses a pointer can have (as far as the .NET Framework is concerned) will be between 0x00000000 and 0x7FFFFFFF. When this range is translated to signed <code>int</code>, no values would be negative because the highest bit is not set. This reinforces my belief that there's no difference in using IntPtr vs UIntPtr. Is my reasoning correct?</strike></p>\n\n<p>Fermat2357 pointed out that the above edit is wrong.</p>\n"},{"tags":["c#",".net","console-application","exit-code"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13195491,"title":"How do I make my console application return an integer?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/155610/how-do-i-specify-the-exit-code-of-a-console-application-in-net\">How do I specify the exit code of a console application in .net?</a>  </p>\n</blockquote>\n\n\n\n<p>I need to have a console app that returns a value to the caller (I will call it by a PowerShell script).</p>\n\n<p>How can I change the entry-point to the console app? (And would this be enough to be able to consume return values from the console app?)</p>\n"},{"tags":["c#","jquery",".net","asp.net-mvc-4","chosen"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":330,"score":6,"question_id":12926676,"title":"Two-Way Data Binding using jQuery Driven \"Chosen\" Drop Down","body":"<p>Alright, I have a jQuery version of Chosen applied to a <code>select</code> displaying properly on my page and I've done so with the following code. First I have a <code>BaseController</code> that sets a <code>ViewBag</code> property listing all of the possible categories:</p>\n\n<pre><code>protected override void OnActionExecuted(ActionExecutedContext filterContext)\n{\n    try\n    {\n        _connection.Open();\n        this.ViewBag.AvailableCategories = new MultiSelectList(_connection.Query&lt;Category&gt;(\"select * from Category\"), \"CategoryID\", \"Name\");\n    }\n    catch (Exception ex)\n    {\n        throw new HttpException(500, ex.Message);\n    }\n    finally\n    {\n        _connection.Close();\n    }\n\n    base.OnActionExecuted(filterContext);\n}\n</code></pre>\n\n<p>Next, when navigating to <code>/Event/View/1</code> I have the <code>EventController</code> setup (<strong>NOTE</strong> this controller bases the aforementioned controller) with the following <code>View</code> method.</p>\n\n<pre><code>public ActionResult View(int id)\n{\n    Event evt = null;\n\n    try\n    {\n        evt = Event.Where(_connection, id);\n        if (evt == null)\n        {\n            throw new HttpException(404, \"Oops! The event you're looking for does not exist.\");\n        }\n    }\n    catch (Exception ex)\n    {\n        throw new HttpException(500, ex.Message);\n    }\n\n    return View(evt);\n}\n</code></pre>\n\n<p>It sets the model, as you can see, to the following model.</p>\n\n<pre><code>public class Event\n{\n    public int EventID { get; set; }\n    public int BusinessID { get; set; }\n    public string Name { get; set; }\n    public string Description { get; set; }\n    public int NeighborhoodID { get; set; }\n\n    public IEnumerable&lt;int&gt; CategoryIds\n    {\n        get\n        {\n            if (Categories == null) { return new List&lt;int&gt;(); }\n            return Categories.Select(c =&gt; c.CategoryID).AsEnumerable();\n        }\n    }\n\n    public List&lt;EventCategory&gt; Categories { get; set; }\n    public List&lt;EventHours&gt; Hours { get; set; }\n\n    public static Event Where(IDbConnection connection, int id)\n    {\n        Event result = null;\n\n        try\n        {\n            connection.Open();\n\n            var sql =\n                @\"  select * from Event where EventID = @EventID\n                    select * from EventCategory where EventID = @EventID\n                    select * from EventHours where EventID = @EventID\";\n            using (var multiResult = connection.QueryMultiple(sql, new { EventID = id }))\n            {\n                result = multiResult.Read&lt;Event&gt;().FirstOrDefault();\n                if (result != null)\n                {\n                    result.Categories = multiResult.Read&lt;EventCategory&gt;().ToList();\n                    result.Hours = multiResult.Read&lt;EventHours&gt;().ToList();\n                }\n            }\n        }\n        finally\n        {\n            connection.Close();\n        }\n\n        return result;\n    }\n}\n</code></pre>\n\n<p>Finally I have the following markup in the view.</p>\n\n<pre><code>@Html.DropDownListFor(m =&gt; m.CategoryIds,\n    ViewBag.AvailableCategories as MultiSelectList,\n    new { multiple = \"multiple\", @class = \"chzn-container\" })\n</code></pre>\n\n<p>Now, as I stated at first, it's displaying properly and listing all of the categories as expected. However, even though the <code>CategoryIds</code> property does list in fact two selected categories, it's not setting them (or showing them for that matter) as selected in the Chosen drop down on load.</p>\n\n<p>I am forced to only further assume that if a user selected a value from the Chosen drop down that it would not bind properly on post either because it does not change the HTML when an item is selected.</p>\n\n<p>So, my question is this, how do I properly two-way data bind to a Chosen drop down in MVC?</p>\n"},{"tags":["c#",".net","unit-testing","naudio"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12803619,"title":"Unit Test NAudio using WaveInEvent and WaveOutEvent","body":"<h2>The Error</h2>\n\n<pre><code>The test adapter 'UnitTestAdapter' threw an exception while running test 'TestMP3CompressionFileNameMissingExtension'. Exception has been thrown by the target of an invocation.\nAttempted to read or write protected memory. This is often an indication that other memory is corrupt.\n</code></pre>\n\n<h2>Reproduction Steps</h2>\n\n<p>Simply run all tests in the solution and <strong><em>one</em></strong> of the test will fail with this error.</p>\n\n<h2>The Tests</h2>\n\n<p>Below is a couple of the tests. All of the tests kind of follow a similar pattern, sure they do differen things, but the test that it fails on is about as consistent as the weather so it doesn't really matter.</p>\n\n<pre><code>[TestClass]\npublic class Mp3CompressionTests\n{\n    [TestMethod]\n    public void TestMP3Compression()\n    {\n        var compressor = new Mp3Compressor();\n\n        var session = RecordingSessionHelper.Instance.GetRecordedSession(compressor: compressor);\n        var directoryBuilder = new Mp3TempFileNameBuilder();\n        var deploymentPath = Path.Combine(directoryBuilder.DirectoryPath, \"compressed\");\n\n        if (!Directory.Exists(deploymentPath))\n        {\n            Directory.CreateDirectory(deploymentPath);\n        }\n\n        session.CurrentRecording.Deploy(deploymentPath);\n\n        var filePath = Path.Combine(directoryBuilder.DirectoryPath, \"compressed\", session.CurrentRecording.DeployedFileName);\n\n        Assert.IsTrue(File.Exists(filePath));\n        Assert.IsTrue(File.Exists(Path.ChangeExtension(filePath, \"idx\")));\n    }\n\n    [TestMethod]\n    public void TestMP3CompressionFileNameMissingExtension()\n    {\n        var compressor = new Mp3Compressor();\n\n        var session = RecordingSessionHelper.Instance.GetRecordedSession(compressor: compressor);\n        var directoryBuilder = new Mp3TempFileNameBuilder();\n        var deploymentPath = Path.Combine(directoryBuilder.DirectoryPath, \"compressed\");\n\n        if (!Directory.Exists(deploymentPath))\n        {\n            Directory.CreateDirectory(deploymentPath);\n        }\n\n        compressor.CompressFile(session.CurrentRecording.TempFileName, Path.GetFileNameWithoutExtension(session.CurrentRecording.DeployedFileName));\n\n        var filePath = Path.Combine(Path.GetDirectoryName(session.CurrentRecording.TempFileName), session.CurrentRecording.DeployedFileName);\n\n        Assert.IsTrue(File.Exists(filePath));\n    }\n}\n</code></pre>\n\n<h2>The RecordingSessionHelper Class</h2>\n\n<p>I built this class just to make it easier to construct a recording session during unit testing.</p>\n\n<pre><code>internal class RecordingSessionHelper\n{\n    internal static RecordingSessionHelper Instance\n    {\n        get\n        {\n            return new RecordingSessionHelper();\n        }\n    }\n\n    internal IRecordingSession GetRecordingSession(\n        IAggregator aggregator = null,\n        ITempFileNameBuilder fileBuilder = null,\n        IRecordingDeployer deployer = null,\n        IRecordingCompressor compressor = null)\n    {\n        aggregator = aggregator ?? new SampleAggregator();\n        fileBuilder = fileBuilder ?? new WavTempFileNameBuilder();\n        deployer = deployer ?? new SharedDirectoryDeployer();\n        compressor = compressor ?? new GsmCompressor();\n\n        return new RecordingSession(aggregator, fileBuilder, deployer, compressor);\n    }\n\n    internal IRecordingSession GetRecordedSession(\n        IAggregator aggregator = null,\n        ITempFileNameBuilder fileBuilder = null,\n        IRecordingDeployer deployer = null,\n        IRecordingCompressor compressor = null)\n    {\n        aggregator = aggregator ?? new SampleAggregator();\n        fileBuilder = fileBuilder ?? new WavTempFileNameBuilder();\n        deployer = deployer ?? new SharedDirectoryDeployer();\n        compressor = compressor ?? new GsmCompressor();\n\n        ManualResetEvent eventRaised = new ManualResetEvent(false);\n\n        var session = GetRecordingSession(aggregator, fileBuilder, deployer, compressor);\n        session.RecordingStopped += (s, args) =&gt; { eventRaised.Set(); };\n\n        session.StartRecording(\"1\", \"01\", \"Test Name\", new WaveInEvent(), new WaveFileWriter(fileBuilder.FileName, compressor.RecordingFormat));\n        Thread.Sleep(1000);\n        session.StopRecording();\n\n        eventRaised.WaitOne();\n\n        return session;\n    }\n}\n</code></pre>\n\n<h2>The RecordingSession Class</h2>\n\n<p>This is where I'm obviously doing something wrong. In the tests I'm using the <code>WaveInEvent</code> class instead of the <code>WaveIn</code> because the <code>WaveInEvent</code> class doesn't use <code>windowed events</code>.</p>\n\n<pre><code>public class RecordingSession : IRecordingSession\n{\n    private IWaveIn _input;\n    private WaveFormat _waveFormat;\n    private Stream _writer;\n    private IAggregator _aggregator;\n    private ITempFileNameBuilder _tempFileNameBuilder;\n    private IRecordingDeployer _recordingDeployer;\n    private IRecordingCompressor _recordingCompressor;\n\n    public RecordingSession(\n        IAggregator aggregator,\n        ITempFileNameBuilder tempFileNameBuilder,\n        IRecordingDeployer recordingDeployer,\n        IRecordingCompressor recordingCompressor)\n    {\n        this.Recordings = new List&lt;RecordingTrack&gt;();\n\n        _aggregator = aggregator;\n        _tempFileNameBuilder = tempFileNameBuilder;\n        _recordingDeployer = recordingDeployer;\n        _recordingCompressor = recordingCompressor;\n\n        _waveFormat = _recordingCompressor.RecordingFormat;\n\n        _aggregator.NotificationCount = _waveFormat.SampleRate / 10;\n        _aggregator.MaximumCalculated += (s, args) =&gt; { OnMaximumCalculated(args); };\n    }\n\n    public event EventHandler&lt;WaveInEventArgs&gt; DataAvailable;\n\n    public event EventHandler RecordingStopped;\n\n    public event EventHandler&lt;MaxSampleEventArgs&gt; MaximumCalculated;\n\n    public RecordingTrack CurrentRecording\n    {\n        get\n        {\n            return this.Recordings.LastOrDefault();\n        }\n    }\n\n    public RecordingTrack LastRecording\n    {\n        get\n        {\n            if (this.Recordings.Count &lt;= 1)\n            {\n                return null;\n            }\n\n            return this.Recordings[this.Recordings.Count - 2];\n        }\n    }\n\n    public List&lt;RecordingTrack&gt; Recordings { get; private set; }\n\n    public bool IsRecording { get; private set; }\n\n    public float MicrophoneLevel { get; set; }\n\n    public WaveFormat RecordingFormat { get { return _waveFormat; } }\n\n    public void StartRecording(string claimNo, string ip_no, string ip_name, IWaveIn input, Stream writer)\n    {\n        if (this.IsRecording)\n        {\n            return;\n        }\n\n        if (_input != null)\n        {\n            _input.Dispose();\n            _input = null;\n        }\n        _input = input;\n\n        _input.WaveFormat = _waveFormat;\n        _input.DataAvailable += (s, args) =&gt;\n        {\n            _writer.Write(args.Buffer, 0, args.BytesRecorded);\n            byte[] buffer = args.Buffer;\n            for (int index = 0; index &lt; args.BytesRecorded; index += 2)\n            {\n                short sample = (short)((buffer[index + 1] &lt;&lt; 8) | buffer[index + 0]);\n                float sample32 = sample / 32768f;\n                _aggregator.Add(sample32);\n            }\n\n            OnDataAvailable(args);\n        };\n        _input.RecordingStopped += (s, args) =&gt;\n        {\n            _input.Dispose();\n            _input = null;\n\n            _writer.Dispose();\n            _writer = null;\n\n            OnRecordingStopped(args);\n        };\n\n        if (this.CurrentRecording != null)\n        {\n            _tempFileNameBuilder.GenerateNewFileName();\n        }\n\n        this.Recordings.Add(new RecordingTrack(claimNo, ip_no, ip_name,\n            _tempFileNameBuilder.FileName,\n            _recordingDeployer,\n            _recordingCompressor));\n        if (this.MicrophoneLevel == default(float))\n        {\n            this.MicrophoneLevel = .75f;\n        }\n\n        _aggregator.Reset();\n        _writer = writer;\n\n        _input.StartRecording();\n        this.IsRecording = true;\n    }\n\n    public void StopRecording()\n    {\n        if (!this.IsRecording)\n        {\n            return;\n        }\n\n        this.CurrentRecording.Stop();\n\n        _input.StopRecording();\n        this.IsRecording = false;\n    }\n\n    protected virtual void OnDataAvailable(WaveInEventArgs e)\n    {\n        // Make a temporary copy of the event to avoid possibility of \n        // a race condition if the last subscriber unsubscribes \n        // immediately after the null check and before the event is raised.\n        EventHandler&lt;WaveInEventArgs&gt; handler = DataAvailable;\n\n        // Event will be null if there are no subscribers \n        if (handler != null)\n        {\n            // Use the () operator to raise the event.\n            handler(this, e);\n        }\n    }\n\n    protected virtual void OnRecordingStopped(EventArgs e)\n    {\n        // Make a temporary copy of the event to avoid possibility of \n        // a race condition if the last subscriber unsubscribes \n        // immediately after the null check and before the event is raised.\n        EventHandler handler = RecordingStopped;\n\n        // Event will be null if there are no subscribers \n        if (handler != null)\n        {\n            // Use the () operator to raise the event.\n            handler(this, e);\n        }\n    }\n\n    protected virtual void OnMaximumCalculated(MaxSampleEventArgs e)\n    {\n        // Make a temporary copy of the event to avoid possibility of \n        // a race condition if the last subscriber unsubscribes \n        // immediately after the null check and before the event is raised.\n        EventHandler&lt;MaxSampleEventArgs&gt; handler = MaximumCalculated;\n\n        // Event will be null if there are no subscribers \n        if (handler != null)\n        {\n            // Use the () operator to raise the event.\n            handler(this, e);\n        }\n    }\n}\n</code></pre>\n"},{"tags":[".net","powershell","powershell-v3.0"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13195406,"title":"Is there a way to check if the script is running by PowerShell ISE?","body":"<p>I want to skip the Start-Transcript, Stop-Transcript lines if the PowerShell script is running by Powersehll ISE.</p>\n\n<p>Is this possible? And how can I achieve this?</p>\n"},{"tags":["c#",".net","winapi"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13195363,"title":"How can listen accesses to Windows APIs by proccesses","body":"<p>I want to make a simple program in <code>.Net</code> that it watches the accesses to the <code>Win API</code> functions (like <code>System.IO.FileSystemWatcher</code> for file system) and it let me know which proccess has access to which API.</p>\n\n<p>Is there any interrupt approach or per-build component in <code>.Net Framework</code> to do this?</p>\n\n<p>with many thanks.</p>\n"},{"tags":["c#",".net"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":67,"score":3,"question_id":13195171,"title":"attribute that will wrap all methods in class with try { } catch","body":"<p>I would like to create an attribute <code>HandleError</code> that I would put on a class like this:</p>\n\n<pre><code>[HandleError]\npublic class Foo\n{\n   public void Do(){}\n...\n   public void Don(){}\n}\n</code></pre>\n\n<p>and it will wrap all the methods in try catch, so I believe it should be something like this:</p>\n\n<pre><code>public class HandleErrorAttribute : Attribute\n{\n    public void Execute()\n    {    \n        try\n        {\n            method.Execute();\n        }\n        catch(Exception ex)\n        {\n            //log\n        }\n    }\n}\n</code></pre>\n\n<p>is this possible ?</p>\n"},{"tags":[".net","workflow-foundation-4"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13195403,"title":"WF4 - Exiting from a state without transition to follow","body":"<p>In WF4 we have a state machine with some state.\nThis state has a variable (enum) that is set inside of it and that is used later in transitions that come out from this state to decide what transition to execute.\nWhen we forget to set a value to this variable, none of transitions out of this state are executed and workflow simply closes without any exceptions.\nBut this is not behavior we need - we want machine to fail if it cannot move from current state to some other.\nHow can we archieve this?</p>\n"},{"tags":[".net","vb.net","csv","import","oledb"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13195043,"title":"Tableadaptor Fill Method Returns Blank Items","body":"<p>I Have a program for reading values from a csv file and processing/uploading to a table in SQL (via linq).</p>\n\n<p>The code sections below are how I am getting data and filling the <code>DataSet</code>:</p>\n\n<p><strong>Variables</strong></p>\n\n<pre><code>Private _data As New DataTable\nPrivate _excelconn As New OleDbConnection\nPrivate _reader As OleDbDataReader\nPrivate _excelcommand As New OleDbCommand\nPrivate _excelta As New OleDbDataAdapter\n</code></pre>\n\n<p><strong>Connection String</strong></p>\n\n<pre><code>_excelconn.ConnectionString = String.Format( _\n       \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0}\" &amp; _\n       \"; Extended Properties=\"\"text;HDR=No;FMT=Delimited\"\"\", _directory)\n</code></pre>\n\n<p><strong>Getting the data</strong></p>\n\n<pre><code>_excelcommand.CommandText = \"SELECT * FROM [\" &amp; _selsheet &amp; \"]\"\n\n_excelcommand.Connection = _excelconn\n_excelta.SelectCommand = _excelcommand\n\n_data = New DataTable\n_excelta.Fill(_skiprows, Int32.MaxValue, _data)\n</code></pre>\n\n<p>The file I am reading has row headers on the fifth row, therefor I am setting <code>_skiprows</code> to 4 to start on row 5.</p>\n\n<p>Now when I look at <code>_data.rows(0)</code> it contains only some of the values, the rest are zero length strings (not nulls).</p>\n\n<p>A copy of the data on that row is below:</p>\n\n<pre><code>Date,Slid No,Header,Parcel No,Product Code,Product Description,Service Code,Service Description,Depot No,Collection,Delivery... Continued \n</code></pre>\n\n<p>And the results I am getting:</p>\n\n<p><code>|       |      |         |            |Product Description|            |Service Description|        |Collection|Delivery... Continued</code></p>\n\n<p>I have tried changing columns names to <code>col1,col2,col3</code> etc but the same columns are still being missed, I can't understand why this is falling over, can anyone shed any light?</p>\n"},{"tags":["c#",".net","visual-studio","region"],"answer_count":3,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":694,"score":5,"question_id":6312255,"title":"How to configure Visual Studio to collapse all regions by default?","body":"<p>When I open a code file in a new code window, I press Ctrl+M,O to collapse everything there. As far as I know this can be done by default, without need to press anything every time. I think I did it once, but can't remember where was this option located. </p>\n"},{"tags":[".net","web-services","task-parallel-library"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13193002,"title":"How can I timeout a task, but log how long the task actually took?","body":"<p>I have a third party web service that I make requests against. If a request takes longer than 6 seconds I give up on the result.</p>\n\n<p>What I'd like to do is make the service call, if it takes more than 6 seconds timeout and return, but when the service call actually returns a result, or the underlying connection times out I'd like to log how long the call would have taken.</p>\n\n<p>The motivation is that I currently time out at 6 seconds and I know that a percentage of calls timeout. What I'd like to have is some data on how long calls typically take, even the ones past 6 seconds. It might be that if I increase my timeout to 7 seconds then I would timeout much less often, but without data I don't know.</p>\n\n<p>I'm working in C#, is there something that I can do with <code>Task&lt;T&gt;</code> or will I have to build something more bespoke?</p>\n"},{"tags":[".net","sqlite","compact-framework","windows-ce"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12542713,"title":"SQLite CE exception - Database is locked","body":"<p>I have a trouble with the following code. The program seems to stuck sometimes (apparently no pattern...often in the second query since the form containing this code run but not always) for 5-20 seconds in the row</p>\n\n<p>Dim rdr As SQLiteDataReader = cmd.ExecuteReader</p>\n\n<p>If the code doesn't stuck in second query since form started, it won't never stuck. If I close and reopen the form I have the same 50-60% chance to have same error mostly on 2nd query.</p>\n\n<p>Then it always restart from this point sometimes with no error...just big delay of 5-20 seconds and sometimes with error \"The database file is locked, database is locked\" at line</p>\n\n<p>cmd.ExecuteNonQuery() \n(2° time..not inside if block)</p>\n\n<p>This error will forbid the user to save its change and sometimes corrupt the data record and, of course, introduces a huge delay that I can't accept :(</p>\n\n<p>Any Idea of what I'm doing wrong?</p>\n\n<p>I'm developing with visual studio 2008 for a windows CE 6.0 device with 3.5 framework and </p>\n\n<p>ADO.NET 2.0/3.5 SQLite Data Provider\nVersion 1.0.66.0 April 18, 2010\nUsing SQLite 3.6.23.1\n<a href=\"http://sqlite.phxsoftware.com/\" rel=\"nofollow\">http://sqlite.phxsoftware.com/</a></p>\n\n<p>Thank you</p>\n\n<pre><code>'Update current program on database\nPublic Sub AggiornaUserOnDatabase(ByVal name As String, ByVal password As String, ByVal permission As String)\n    'No spaces\n    name = Trim(name)\n    'Database var\n    Dim ConString As String = \"Data Source = \" + DatabaseAccountPath + \";\"\n    Dim con As New SQLiteConnection\n    Dim cmd As SQLiteCommand\n    'Read from database\n    Try\n        con.ConnectionString = ConString\n        con.Open()\n        'Check if row is existing\n        cmd = con.CreateCommand\n        cmd.CommandText = \"SELECT \" + DBACCNAME + \" FROM \" + DatabaseAccountTableName + \" WHERE \" + DBACCNAME + \" = '\" + name + \"'\"\n        Dim rdr As SQLiteDataReader = cmd.ExecuteReader\n        'If empty...create the record\n        If Not rdr.Read Then\n            cmd = con.CreateCommand\n            cmd.CommandText = \"INSERT INTO \" + DatabaseAccountTableName + \" (\" + DBACCNAME + \") VALUES ('\" + name + \"')\"\n            cmd.ExecuteNonQuery()\n        End If\n        rdr.close()\n        'Update the values\n        cmd = con.CreateCommand\n        cmd.CommandText = \"UPDATE \" + DatabaseAccountTableName + \" SET \" _\n                        + DBACCPASSWORD + \" = '\" + password + \"', \" _\n                        + DBACCPERMISSION + \" = '\" + permission + \"' \" _\n                        + \"WHERE \" + DBACCNAME + \" = '\" + name + \"'\"\n        cmd.ExecuteNonQuery()\n        cmd.Dispose()\n        con.Close()\n    Catch ex As Exception\n        AggiungiRigaSuFile(ErroriPath, \"Editing users account database: \" + ex.Message, Configurazione.DiagnosticaOff, True)\n    End Try\nEnd Sub\n</code></pre>\n"},{"tags":["c#",".net","wcf","web-services"],"answer_count":7,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":29022,"score":8,"question_id":5243929,"title":"WCF Service Client: The content type text/html; charset=utf-8 of the response message does not match the content type of the binding","body":"<p>I've got a WCF Service running on my local IIS server. I've added it as a service reference to a C# Website Project and it adds fine and generates the proxy classes automatically.</p>\n\n<p>However, when I try and call any of the service contracts, I get the following error:</p>\n\n<blockquote>\n  <p><strong>Description:</strong> An unhandled exception occurred during the\n  execution of the current web  request.\n  Please review the stack trace for more\n  information about the error and where\n  it originated in the code.</p>\n  \n  <p><strong>Exception Details:</strong> System.ServiceModel.ProtocolException:\n  The content type text/html;\n  charset=utf-8 of the response message\n  does not match the content type of the\n  binding (application/soap+xml;\n  charset=utf-8). If using a custom\n  encoder, be sure that the\n  IsContentTypeSupported method is\n  implemented properly. The first 1024\n  bytes of the response were: '\n       function\n  bredir(d,u,r,v,c){var w,h,wd,hd,bi;var\n  b=false;var p=false;var\n  s=[[300,250,false],[250,250,false],[240,400,false],[336,280,false],[180,150,false],[468,60,false],[234,60,false],[88,31,false],[120,90,false],[120,60,false],[120,240,false],[125,125,false],[728,90,false],[160,600,false],[120,600,false],[300,600,false],[300,125,false],[530,300,false],[190,200,false],[470,250,false],[720,300,true],[500,350,true],[550,480,true]];if(typeof(window.innerHeight)=='number'){h=window.innerHeight;w=window.innerWidth;}else\n  if(typeof(document.body.offsetHeight)=='number'){h=document.body.offsetHeight;w=document.body.offsetWidth;}for(var\n  i=0;i  \n</blockquote>\n\n<p>I also have a console application which also communicates with the WCF Service and the console app is able to call methods fine without getting this error.</p>\n\n<p>Below are excerpts from my config files.</p>\n\n<p>WCF Service Web.Config:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n   &lt;services&gt;\n      &lt;service name=\"ScraperService\" behaviorConfiguration=\"ScraperServiceBehavior\"&gt;\n         &lt;endpoint address=\"\"\n                   binding=\"wsHttpBinding\" \n                   bindingConfiguration=\"WSHttpBinding_IScraperService\"\n                   contract=\"IScraperService\" /&gt;\n         &lt;endpoint address=\"mex\" \n                   binding=\"mexHttpBinding\" \n                   contract=\"IMetadataExchange\" /&gt;\n         &lt;host&gt;\n            &lt;baseAddresses&gt;\n                &lt;add baseAddress=\"http://example.com\" /&gt;\n            &lt;/baseAddresses&gt;\n         &lt;/host&gt;\n      &lt;/service&gt;\n   &lt;/services&gt;\n   &lt;bindings&gt;\n       &lt;wsHttpBinding&gt;\n           &lt;binding name=\"WSHttpBinding_IScraperService\"\n                    bypassProxyOnLocal=\"false\" transactionFlow=\"false\"\n                    hostNameComparisonMode=\"StrongWildcard\"\n                    maxBufferPoolSize=\"2000000\" maxReceivedMessageSize=\"2000000\"\n                    messageEncoding=\"Text\" textEncoding=\"utf-8\"\n                    useDefaultWebProxy=\"true\" allowCookies=\"false\"&gt;\n               &lt;readerQuotas \n                     maxDepth=\"2000000\" maxStringContentLength=\"2000000\" \n                     maxArrayLength=\"2000000\" maxBytesPerRead=\"2000000\"\n                     maxNameTableCharCount=\"2000000\" /&gt;\n               &lt;reliableSession \n                     enabled=\"false\" ordered=\"true\" inactivityTimeout=\"00:10:00\" /&gt;\n               &lt;security mode=\"Message\"&gt;\n                   &lt;message clientCredentialType=\"Windows\"\n                            negotiateServiceCredential=\"true\"\n                            algorithmSuite=\"Default\"\n                            establishSecurityContext=\"true\" /&gt;\n               &lt;/security&gt;\n            &lt;/binding&gt;\n          &lt;/wsHttpBinding&gt;\n      &lt;/bindings&gt;\n      &lt;behaviors&gt;\n          &lt;serviceBehaviors&gt;\n              &lt;behavior name=\"ScraperServiceBehavior\"&gt;\n                  &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n                  &lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;\n              &lt;/behavior&gt;\n          &lt;/serviceBehaviors&gt;\n     &lt;/behaviors&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Website Project Service Client <code>Web.Config</code>:</p>\n\n<pre><code>&lt;system.serviceModel&gt;\n   &lt;bindings&gt;\n      &lt;wsHttpBinding&gt;\n          &lt;binding name=\"WSHttpBinding_IScraperService\" \n              closeTimeout=\"00:01:00\" openTimeout=\"00:01:00\" \n              receiveTimeout=\"00:10:00\" sendTimeout=\"00:01:00\"\n              bypassProxyOnLocal=\"false\" transactionFlow=\"false\" \n              hostNameComparisonMode=\"StrongWildcard\"\n              maxBufferPoolSize=\"524288\" maxReceivedMessageSize=\"65536\" \n              messageEncoding=\"Text\" textEncoding=\"utf-8\"\n              useDefaultWebProxy=\"true\" allowCookies=\"false\"&gt;\n              &lt;readerQuotas \n                  maxDepth=\"32\" maxStringContentLength=\"8192\" \n                  maxArrayLength=\"16384\" maxBytesPerRead=\"4096\" \n                  maxNameTableCharCount=\"16384\" /&gt;\n              &lt;reliableSession enabled=\"false\"\n                  ordered=\"true\" inactivityTimeout=\"00:10:00\" /&gt;\n              &lt;security mode=\"Message\"&gt;\n                  &lt;transport clientCredentialType=\"Windows\" \n                       proxyCredentialType=\"None\" realm=\"\" /&gt;\n                  &lt;message clientCredentialType=\"Windows\" \n                       negotiateServiceCredential=\"true\"\n                       algorithmSuite=\"Default\" /&gt;\n              &lt;/security&gt;\n          &lt;/binding&gt;\n       &lt;/wsHttpBinding&gt;\n    &lt;/bindings&gt;\n&lt;client&gt;\n        &lt;endpoint name=\"WSHttpBinding_IScraperService\"\n            address=\"http://example.com/ScraperService.svc\"\n            binding=\"wsHttpBinding\" \n            bindingConfiguration=\"WSHttpBinding_IScraperService\"\n            contract=\"ScraperService.IScraperService\" &gt;\n           &lt;identity&gt;\n               &lt;servicePrincipalName value=\"host/FreshNET-II\" /&gt;\n           &lt;/identity&gt;\n        &lt;/endpoint&gt;\n     &lt;/client&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>This is my first attempt at creating a WCF so it's all very new. Any help is much appreciated.</p>\n\n<p>Thanks.</p>\n"},{"tags":[".net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":9,"score":-1,"question_id":13194844,"title":"Need Help about the microsoft Report Viewer","body":"<p>IN ASP.NET\nI used the  microsoft Report Viewer for the student registration form and it is running well but now i want to use a dropdownlist with various branches so that when the user select like First Year only the records of the first year should be shown \nso what should a i do \ni have just used the microsoft Report Viewer on the repost.aspx page what further should i do</p>\n"},{"tags":["c#",".net","asmx"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13193509,"title":"Parameter not being read from SOAP request","body":"<p>I'm having a problem with a web service that I'm writing (it's asmx).</p>\n\n<p>I have this method: </p>\n\n<pre><code>    [WebMethod()]\n    [SoapDocumentMethod(\n        RequestNamespace=\"http://bsp.XXX.org\",\n        ResponseNamespace=\"http://bsp.XXX.org\",\n        ResponseElementName=\"PaymentResults\",\n        RequestElementName=\"GetPaymentResult\",\n        Action = \"http://bsp.XXX.org/GetPaymentResult\")]\n    public PaymentResult[] GetPaymentResult(string MerchantRef)\n    {\n        try\n        {\n            if (!String.IsNullOrEmpty(MerchantRef))\n            {\n                return PaymentResultRepository.GetPaymentResults(MerchantRef).ToArray();\n            }\n            else\n            {\n                _errorLog.Error(\"MerchantRef is empty\");\n            }\n        }\n        catch (Exception ex)\n        {\n            _errorLog.Error(\"Failed to get payment details\", ex);\n        }\n        return new PaymentResult[0];\n    }\n}\n</code></pre>\n\n<p>And it's being called from an Oracle Forms application. The SOAP request received is:</p>\n\n<pre><code>&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"\n        xmlns:xsi=\"http://www.w3.org/1999/XMLSchema-instance\" \n        xmlns:xsd=\"http://www.w3.org/1999/XMLSchema\"&gt;\n    &lt;SOAP-ENV:Body&gt;\n        &lt;GetPaymentResult xmlns=\"http://bsp.XXX.org/\" \n                 SOAP-ENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"&gt;\n            &lt;MerchantRef xsi:type=\"xsd:string\"&gt;\n                 IP/58991/1\n            &lt;/MerchantRef&gt;\n        &lt;/GetPaymentResult&gt;\n    &lt;/SOAP-ENV:Body&gt;\n</code></pre>\n\n<p></p>\n\n<p>The problem is that \"MerchantRef\" is always an empty string in my method... Anyone have any idea about this? Is the SOAP request wrong? Am I missing something obvious?</p>\n"},{"tags":["c#",".net","dependency-injection","rabbitmq"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13181328,"title":"RabbitMQ: Injecting the connection factory","body":"<p>I am attempting to set up RabbitMQ for a pair of Windows Services I am writing, to facilitate communication between them in a quick and reliable way.  However, I'm running into a problem when trying to set up the main windows service engines, which need to establish connections to the RabbitMQ server to do their thing.</p>\n\n<p>Basically, the <code>ConnectionFactory</code> object in RabbitMQ's .NET client is not abstract and implements no interfaces.  I can't see an obvious way to inject this class using an IoC container like StructureMap.  Even the code examples in the documentation show just blatantly <code>new</code>ing it up, like so:</p>\n\n<pre><code> ConnectionFactory factory = new ConnectionFactory();\n factory.Uri = \"amqp://user:pass@hostName:port/vhost\";\n IConnection conn = factory.CreateConnection();\n</code></pre>\n\n<p>The solution that presents itself to me is to push up the entire factory into the service's main <code>OnStart</code> and <code>OnStop</code> functions, which are really difficult to test and not of huge interest anyway.  However, that leaves me with a single <code>IConnection</code> for the service, so if that connection is broken in any way, the service has no way to recover and must simply exit.  If the main engine had visibility to the factory, it could simply produce a new connection and continue.  But unless I inject that, there is no way to test the main engine without connecting to an existing server!</p>\n\n<p>Is there anything I am missing here?  Any other option I'm not considering?  How can I go about injecting this factory, and if I can't, how can I limit the damage?</p>\n\n<p>EDIT: Also, as an afterthought, I'm perfectly happy to make a change to RabbitMQ's .NET client to implement an interface on this if someone has a good idea of how receptive the main dev team would be to a change like this.  I'd be delighted to contribute, but the last thing I want to do is have my programs working on some custom version of RabbitMQ, thereby eliminating the main benefit of using a third party library in the first place.</p>\n"},{"tags":["c#",".net","mysql","vb.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13194056,"title":"Delegate Error when converting C# to VBNET","body":"<p>I have this code in c#</p>\n\n<pre><code>void Backup()\n{\n    string constr = \"server=localhost;user=root;pwd=qwerty;database=test;\";\n    string file = \"C:\\\\MyDumpFile.sql\";\n    MySqlBackup mb = new MySqlBackup(constr);\n    mb.ExportInfo.FileName = file;\n    mb.ExportProgressChanged += new MySqlBackup.exportProgressChange(mb_ExportProgressChanged);\n    mb.ExportCompleted += new MySqlBackup.exportComplete(mb_ExportCompleted);\n    timerRead.Start();\n    mb.Export();\n}\n</code></pre>\n\n<p>when converted to <code>VBNet</code></p>\n\n<pre><code>Private Sub Backup()\n    Dim constr As String = \"server=localhost;user=root;pwd=qwerty;database=test;\"\n    Dim file As String = \"C:\\MyDumpFile.sql\"\n    Dim mb As New MySqlBackup(constr)\n    mb.ExportInfo.FileName = file\n    mb.ExportProgressChanged = mb.ExportProgressChanged + New MySqlBackup.exportProgressChange(mb_ExportProgressChanged)\n    mb.ExportCompleted = mb.ExportCompleted + New MySqlBackup.exportComplete(mb_ExportCompleted)\n    timerRead.Start()\n    mb.Export()\nEnd Sub\n</code></pre>\n\n<p>I always get this error</p>\n\n<blockquote>\n  <p>'exportProgressChange' is a type in\n  'MySql.Data.MySqlClient.MySqlBackup' and cannot be used as an\n  expression.</p>\n</blockquote>\n\n<p>What am I missing here?</p>\n"},{"tags":[".net","configuration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13194039,"title":"How to test the transformed web.config on localhost?","body":"<p>I have a classic development architecture : </p>\n\n<ul>\n<li>3 different Server </li>\n<li>3 different DB :</li>\n</ul>\n\n<p>=> A distinct couple for each  Dev, Test &amp; Prod</p>\n\n<p>Each config has thus its own connection string.\nThe Web.config has 3 transformation available, one for each config.</p>\n\n<p>My problem is that the transformation of the web.config doesn't seems to occur on localhost...</p>\n\n<p>If it's true, How can I have the right (transformed) web.config corresponding to my chosen config on localhost?</p>\n"},{"tags":["c#",".net","localization","cultureinfo","culture"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13193603,"title":"culture locale make up","body":"<p>The following is the culture locale for Belgium with the french language: fr-BE</p>\n\n<p>fr is the Two Letter ISO Language Name</p>\n\n<p>But what is the correct term/name for the \"BE\" aspect of the culture local?</p>\n"},{"tags":["c#",".net","winforms","webbrowser-control"],"answer_count":4,"favorite_count":2,"up_vote_count":12,"down_vote_count":0,"view_count":9517,"score":12,"question_id":2476360,"title":"Disable JavaScript error in WebBrowser control","body":"<p>I am developing a windows application with a WebBrowser control that navigates to a sharepoint site.<br>\nMy problem is that i am getting JavaScript error.</p>\n\n<p>How can i disable the JavaScript error? I don't want them to pop up.</p>\n"},{"tags":[".net","xml","mono","porting"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":83,"score":1,"question_id":13048404,"title":"Use mono to improve performance of .Net XML Serializers","body":"<p>I tried Mono - it creates serializers in 1 millisecond vs 60 by .NET 4.0. May be somebody ported Mono serializers generator as reusable lib? Or can give me exact list of Mono assemblies to use if I will try to port?</p>\n\n<pre><code>\nusing System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Linq;\nusing System.Text;\nusing System.Xml;\nusing System.Xml.Serialization;\n\nnamespace serialization\n{\n    [Serializable]\n    public sealed class UserCredentials1\n    {\n        public string Username { get; set; }\n        public string Password { get; set; }\n\n        public override string ToString()\n        {\n            return string.Format(\"Username: {0}, Password: {1}\", Username, Password);\n        }\n    }\n\n    [Serializable]\n    public sealed class UserCredentials2\n    {\n        public string Username { get; set; }\n        public string Password { get; set; }\n\n        public override string ToString()\n        {\n            return string.Format(\"Username: {0}, Password: {1}\", Username, Password);\n        }\n    }\n\n    //.NET 4.0\n    //native=60.757\n    //compiled=2.2602\n    //Username: CTTTOM, Password: WoEIPX6Qqf11j9vKn01bAA==\n\n    //MONO:\n    //mono serialization.exe\n    //native=0.1589\n    //compiled=0.1337\n    //Username: CTTTOM, Password: WoEIPX6Qqf11j9vKn01bAA==\n\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string xml1 = @\"      \" +\n             @\" CTTTOM\" +\n        @\" WoEIPX6Qqf11j9vKn01bAA==\" +\n                 @\"\";\n\n            string xml2 = @\"\" +\n@\" CTTTOM\" +\n@\" WoEIPX6Qqf11j9vKn01bAA==\" +\n     @\"\";\n\n            //warm up\n            Type targetType1 = typeof(UserCredentials1);\n            XmlSerializer nativeSerializer1 = new XmlSerializer(targetType1);\n            Type targetType2 = typeof(UserCredentials2);\n            nativeSerializer1.Deserialize(new XmlTextReader(new StringReader(xml1)));\n\n            var native = new Stopwatch();\n            native.Start();\n            XmlSerializer nativeSerializer2 = new XmlSerializer(targetType2);\n            native.Stop();\n            Console.WriteLine(\"native=\" + native.Elapsed.TotalMilliseconds);\n\n            var compiled = new Stopwatch();\n            compiled.Start();\n            var de = nativeSerializer2.Deserialize(new XmlTextReader(new StringReader(xml2)));\n            compiled.Stop();\n            Console.WriteLine(\"compiled=\" + compiled.Elapsed.TotalMilliseconds);\n            Console.Write(de.ToString());\n            Console.ReadKey();\n        }\n    }\n}\n\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I made first step to migration, see <a href=\"https://github.com/asd-and-Rizzo/mono\" rel=\"nofollow\">https://github.com/asd-and-Rizzo/mono</a> .\nDone test with generic list of objects using \"mono serialization.exe\", mouse click run with .NET serialization and ported Mono serialization. Ported version gives ~10 times faster default serializers generation then .NET one.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Found in MSDN regarding XML serialization configuration .NET 4.5 (http://msdn.microsoft.com/en-us/library/ms229754.aspx):</p>\n\n<p>useLegacySerializationGeneration\nSpecifies whether the XmlSerializer uses legacy serialization generation which generates assemblies by writing C# code to a file and then compiling it to an assembly. The default is false.</p>\n"},{"tags":["c#",".net","performance","dynamic","compiler"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":99,"score":3,"question_id":13193799,"title":"Performance cost of using dynamic typing in .NET","body":"<p>What is the performance cost of using <code>dynamic</code> vs <code>object</code> in .NET? Say for example I have a method which accepts a parameter of any type. E.G.</p>\n\n<pre><code>public void Foo(object obj)\n{\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>public void Foo(dynamic obj)\n{\n}\n</code></pre>\n\n<p>ILSpy tells me that when using dynamic code, the compiler must insert a code block to handle dynamism. Therefore I want to know if using dynamic in place of object is advised and to what level this usage comes at the cost of performance?</p>\n"},{"tags":[".net","certificates","appsettings"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12609813,"title":".NET Find Certificate by thumbprint via AppSetting","body":"<p>This one is really weird and I can't figure out why one method works and one doesn't.</p>\n\n<p>I have a certificate in my local computer store and a thumbprint for it.  The app uses the cert when making HTTP web requests so I need to fetch it.  I want to store the thumbprint in the web.config as an AppSetting value.  Whenever I pull the AppSetting value and use it to Find the certificate, it doesn't find it.  However, if I make a local variable (class variable, readonly, const, whatever...) and search by it, it works.  I've done String.Compare() on both the value is <strong>exactly</strong>  the same.  What gives?  I tried to look at the IL to see if I can see something funky but nothing.</p>\n\n<pre><code>' This Works\n                Dim certificateThumbprint As String = \"D0650C9D31CF525D3C82153DCEBC3C3265D75FE3\"\n                Dim certCollection = certStore.Certificates.Find(X509FindType.FindByThumbprint, certificateThumbprint, False)\n\n                ' This doesn't\n                Dim appSettingcertificateThumbprint = System.Web.Configuration.WebConfigurationManager.AppSettings(\"CertificateThumbprint\")\n                Dim certCollection2 = certStore.Certificates.Find(X509FindType.FindByThumbprint, appSettingcertificateThumbprint, False)\n\n                ' Intermediate window shows that\n                'String.Compare(certificateThumbprint, appSettingcertificateThumbprint, True) = 0\n</code></pre>\n"},{"tags":[".net","video-streaming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13193946,"title":"Framework or thirdparty tool to Set up a video library .Net","body":"<p>I have a requirement where I need to setup a video library (similar to YouTube) and integrate with my existing .Net application. I don't have the option to use YouTube and hence need to build similar setup from scratch. </p>\n\n<p>I would like to know if there is any framework or third party tools that are available that can be integrated to my application which can handle all the video management (Add/Edit/Delete videos by Admin) and video management by user (View video/ creating playlist)</p>\n"},{"tags":[".net","vb.net","winforms"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13186753,"title":"Vb.net get integers only from string with integers","body":"<p>i have this string  <code>123abc123</code> how can i get only integers from this string?<br>\nconvert <code>123abc123</code> to <code>123123</code>.</p>\n\n<p>what i tried:</p>\n\n<pre><code>integer.prase(abc)\n</code></pre>\n"},{"tags":["c#",".net","xml-parsing","xml-namespaces","xmlexception"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13191871,"title":"XmlDocument from XML string that contains custom namespaces causes XmlException?","body":"<p>I need to create an XmlDocument partly by using old XML and partly by creating new. The problem is that the old XML contains custom namespaces and I can't seem to be able to use them as I get an XmlException. I've tried to add the namespace to many different places but I can't get over the Exception!</p>\n\n<p>The Exception</p>\n\n<pre><code>System.Xml.XmlException was unhandled by user code\n    Message='my' is an undeclared prefix. Line 1, position 42.\n    Source=System.Xml\n</code></pre>\n\n<p>My Code</p>\n\n<pre><code>XmlDocument doc = new XmlDocument();\nXmlSchema schema = new XmlSchema();\nschema.Namespaces.Add(\"my\", \"http://foobar.com/\");\ndoc.Schemas.Add(schema);\nXmlDeclaration dec = doc.CreateXmlDeclaration(\"1.0\", \"UTF-8\", null);\ndoc.AppendChild(dec);\n\nXmlElement root = doc.CreateElement(\"root\");\nroot.SetAttribute(\"xmlns:my\", \"http://foobar.com/\");\ndoc.AppendChild(root);\n\nforeach (var item in GetItems())\n{\n    XmlElement elem = doc.CreateElement(\"item\");\n    elem.SetAttribute(\"id\", item.id);\n\n    // Append body to elem\n    XmlElement body = doc.CreateElement(\"body\");\n    body.InnerXml = item.Body; // Here is where I get the exception\n\n    elem.AppendChild(body);\n\n    // Append elem to root\n    root.AppendChild(elem);\n}\n</code></pre>\n\n<p>Input from Item.Body is similar to</p>\n\n<pre><code>&lt;aaa&gt;&lt;bbb my:attr=\"55\"&gt;Foo&lt;/bbb&gt;&lt;/aaa&gt;\n</code></pre>\n\n<p>I expected the output to be similar to</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;root my:attr=\"http://foobar.com/\"&gt;\n  &lt;item id=\"12345\"&gt;\n    &lt;body&gt;\n        &lt;aaa&gt;\n            &lt;bbb my:attr=\"55\"&gt;Foo&lt;/bbb&gt;\n        &lt;/aaa&gt;\n    &lt;/body&gt;\n  &lt;/item&gt;\n&lt;/root&gt;\n</code></pre>\n\n<p>I'm open to alternatives to using this method. After I create the XmlDocument I prettyprint it, validate it against a schema and then push it out for the user to see.</p>\n"},{"tags":["c#","jquery",".net"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13192459,"title":"ProgressBar while transferring data from Excel sheet to SQL database table","body":"<p>Can anyone tell me how to show animated progress bar while the data from an Excel sheet to a SQL database table is being transfered?</p>\n\n<p>I have a form in <code>.aspx</code> page. In that form, there is one <code>FileUpload</code> control that uploads an Excel file. While uploading that file and saving it on the server at the same time I'm transferring the data from the Excel sheet to a SQL table. During this transfer, I want to show a <code>ProgressBar</code> and after transferring all data it will be removed automatically..</p>\n\n<p>Is there something I can do to achieve this?</p>\n"},{"tags":["c#",".net","nhibernate","orm","hql"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2513,"score":1,"question_id":2661792,"title":"Using NHibernate's HQL to make a query with multiple inner joins","body":"<p>The problem here consists of translating a statement written in LINQ to SQL syntax into the equivalent for NHibernate. The LINQ to SQL code looks like so:</p>\n\n<pre><code>var whatevervar = from threads in context.THREADs\n                          join threadposts in context.THREADPOSTs\n                            on threads.thread_id equals threadposts.thread_id\n                          join posts1 in context.POSTs\n                            on threadposts.post_id equals posts1.post_id\n                          join users in context.USERs\n                            on posts1.user_id equals users.user_id\n                          orderby posts1.post_time\n                          where threads.thread_id == int.Parse(id)\n                          select new\n                          {\n                              threads.thread_topic,\n                              posts1.post_time,\n                              users.user_display_name,\n                              users.user_signature,\n                              users.user_avatar,\n                              posts1.post_body,\n                              posts1.post_topic\n                          };\n</code></pre>\n\n<p>It's essentially trying to grab a list of posts within a given forum thread. The best I've been able to come up with (with the help of the helpful users of this site) for NHibernate is: </p>\n\n<pre><code>var whatevervar = session.CreateQuery(\"select t.Thread_topic, p.Post_time, \" +\n                                              \"u.User_display_name, u.User_signature, \" +\n                                              \"u.User_avatar, p.Post_body, p.Post_topic \" +\n                                              \"from THREADPOST tp \" +\n                                              \"inner join tp.Thread_ as t \" +\n                                              \"inner join tp.Post_ as p \" +\n                                              \"inner join p.User_ as u \" +\n                                              \"where tp.Thread_ = :what\")\n                                              .SetParameter&lt;THREAD&gt;(\"what\", threadid)\n                                              .SetResultTransformer(Transformers.AliasToBean(typeof(MyDTO)))\n                                              .List&lt;MyDTO&gt;();\n</code></pre>\n\n<p>But that doesn't parse well, complaining that the aliases for the joined tables are null references. MyDTO is a custom type for the output:</p>\n\n<pre><code>public class MyDTO\n{\n    public string thread_topic { get; set; }\n    public DateTime post_time { get; set; }\n    public string user_display_name { get; set; }\n    public string user_signature { get; set; }\n    public string user_avatar { get; set; }\n    public string post_topic { get; set; }\n    public string post_body { get; set; }\n}\n</code></pre>\n\n<p>I'm out of ideas, and while doing this by direct SQL query is possible, I'd like to do it properly, without defeating the purpose of using an ORM.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT:</p>\n\n<p>The database looks like this: <a href=\"http://i41.tinypic.com/5agciu.jpg\" rel=\"nofollow\">http://i41.tinypic.com/5agciu.jpg</a> (Can't post images yet.)</p>\n"},{"tags":["c#",".net","factory-pattern"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13193681,"title":"C# factory default return","body":"<p>I have created a simple factory and before I extend it to cover other implementations I was wondering what would be the correct/recommended behavior for returning from a switch/default.</p>\n\n<p>In the below case I am  using an enumeration(SerialisationTypes) to determine the required concrete implementation and by default I am planning to return a JSON serialiser implementation through the parameter less method but would this be correct behavior on the Default of the switch statement or should I throw an exception?</p>\n\n<pre><code>namespace Helper.Core.Serialisation\n{\n    internal class SerialisationFactory\n    {\n        internal ISerialiser Create()\n        {\n            return Create(SerialisationTypes.JsonSerialiser);\n        }\n\n        internal ISerialiser Create(SerialisationTypes type)\n        {\n            switch (type)\n            {\n                case SerialisationTypes.JsonSerialiser:\n                    return new JSonSerialiser();\n                    break;\n                default:\n                    return new JSonSerialiser();\n                    break;\n            }\n        }\n    }\n}\n</code></pre>\n"},{"tags":["c#",".net","image"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13193212,"title":"Using .DrawToBitmap - how to change resolution of image?","body":"<p>Im using <code>DrawToBitmap</code> to save some labels as image. I would like to know how to change the resolution of these images, is there a way? Say I have a label with a text and I want to render it to an image file (not posting the full code):</p>\n\n<pre><code>this.label1 = new System.Windows.Forms.Label();\nthis.label1.AutoSize = true;\nthis.label1.Font = new System.Drawing.Font(\"Baskerville Old Face\", 36F);\n//...\nthis.label1.Size = new System.Drawing.Size(161, 54);\nthis.label1.Text = \"Output\";\n//...\n\n//save image:\nBitmap image = new Bitmap(161, 54);\nthis.label1.DrawToBitmap(image, this.label1.ClientRectangle);\nimage.Save(@\"C:\\image.jpg\");\n</code></pre>\n\n<p>This is working fine, I will get something like this:</p>\n\n<p><img src=\"http://i.stack.imgur.com/T86OR.png\" alt=\"Resultant image\"></p>\n\n<p>The resolution is ok, but is it possible to increase it? When I zoom into this image a little, I can see the individual pixels as large blocks:</p>\n\n<p><img src=\"http://i.stack.imgur.com/66Yt0.jpg\" alt=\"Zoomed resultant image\"></p>\n\n<p>I know that's normal, because its not a vector graphic and that's fine. I just would like to change it somehow, so that you can zoom in further before seeing individual pixels as large blocks. Any ideas?</p>\n\n<p>Thank you.</p>\n\n<p>Edit: If Im using only black/white images - is it maybe better to save the image as png or gif?</p>\n"},{"tags":[".net","excel","excel-2007","openxml","openxml-sdk"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":301,"score":2,"question_id":6888290,"title":"How can I strip macros from an Excel workbook?","body":"<p>I am currently forced to use Office Live / Skydrive (whatever the proper name is) to edit Excel workbooks. Skydrive won't let me upload a workbook that contains macros, and I don't need the macros, so I would like to write a little cleansing app in C# that simply removes all macros. How can I go about this using Excel 2007 and above (.xlsm) documents?</p>\n\n<p><strong>EDIT:</strong>  Basically, I would like to open an xlsm document and save it as an xlsx document, without required Excel to be installed, i.e. via the OpenXML SDK or something.</p>\n"},{"tags":[".net","winforms","visual-studio","clickonce","full-trust"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13191984,"title":"Error starting Click-Once app. Application cannot be started. Contact the vendor","body":"<p>We are having a weird problem with on of our customer's clickonce installation. This is a full trust winforms application.</p>\n\n<p>Our application installs correctly on the Windows 7 computer and the user can use it. After a day or a few hours of use, the application exe goes missing from the clickonce deployment directory along with a few DLLs as well. </p>\n\n<p>The user can no longer run the application using the Desktop shortcut and he gets the \"Error starting Click-Once app. Application cannot be started. Contact the vendor.\"</p>\n\n<p>We tried uninstalling and reinstalling the application multiple times by clearing the Apps\\2.0 clickonce cache. However, everytime we have the same issue. </p>\n\n<p>We also tried creating a new user on the same machine and installing the software under the new user. However, the new user has the same problem as well.</p>\n\n<p>We suspected virus activity. Unfortunately, the Virus guard does not mention any suspicious activity. A scan from another virus guard showed no threats. </p>\n\n<p>Any clues as to what might be causing this behavior. The running exe just disappears from the install location. </p>\n\n<p>The application runs fine elsewhere, on other computers. </p>\n\n<p>Thank you,\nManish.</p>\n"},{"tags":[".net","vb.net","visual-studio"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13191275,"title":"How is the Sub or Set to Be Understood?","body":"<p>I am new to VB.NET 2012 (Visual Studio 2012).</p>\n\n<p>I am wondering how is the following error message to be understood?</p>\n\n<pre><code> 'Return' statement in a Sub or a Set cannot return a value.\n</code></pre>\n\n<p>The focus is on \"Sub or Set\".</p>\n\n<p>In case of interest, I am trying to have messages printed out through numerous ways.</p>\n"},{"tags":["c#",".net","sockets"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":196,"score":2,"question_id":13026666,"title":"sending a large amount of data throught TCP socket","body":"<p>This is my first question posted on this forum, and I'm a beginner in c# world , so this is kind of exciting for me, but I'm facing some issues with sending a large amount of data through sockets so this is more details about my problem:</p>\n\n<p>I'm sending a binary image of 5 Mo through a TCP socket, at the receiving part I'm saving the result(data received ) and getting only 1.5 Mo ==> data has been lost (I compared the original and the resulting file and it showed me the missed parts)\nthis is the code I use:</p>\n\n<pre><code>private void senduimage_Click(object sender, EventArgs e)\n{\n    if (!user.clientSocket_NewSocket.Connected)\n    {\n        Socket clientSocket_NewSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);\n        user.clientSocket_NewSocket = clientSocket_NewSocket;\n        System.IAsyncResult _NewSocket = user.clientSocket_NewSocket.BeginConnect(ip_address, NewSocket.Transceiver_TCP_Port, null, null);\n        bool successNewSocket = _NewSocket.AsyncWaitHandle.WaitOne(2000, true);\n     }\n     byte[] outStream = System.Text.Encoding.ASCII.GetBytes(Uimage_Data);\n     user.clientSocket_NewSocket.Send(outStream);\n }\n</code></pre>\n\n<p>In forums they say to divide data into chunks, is this a solution, if so how can I do this, I've tried but it didn't work!</p>\n"},{"tags":[".net","reflection","instance","generic-type-argument"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":3103,"score":3,"question_id":5909144,"title":"How to create List<T> instance in C# file using Reflection","body":"<p>HI,\nI have a requirement to create instance for list object at runtime using reflection. For example I have 2 classes like below,</p>\n\n<pre><code>class Class1\n{\n   List&lt;Class2&gt; class2List;\n   public List&lt;Class2&gt; Class2List\n   {\n        get;set;\n   }\n}\nclass Class2\n{\n    public string mem1;\n    public string mem2;\n}\n</code></pre>\n\n<p>After creating the instance of <code>Class1</code> at Runtime in another class <code>Class3</code>, I want to assign values to all the properties of the class. In this case, <code>Class2List</code> is a property of <code>List&lt;Class2&gt;</code>. <strong>At Runtime, I don't know the class type of <code>List&lt;Class2&gt;</code>. How can I initialize the property i.e. <code>List&lt;Class2&gt;</code> inside class3 at runtime.</strong></p>\n\n<p>Any suggestions are greatly appreciated...</p>\n"},{"tags":["c#",".net","winforms","devexpress"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13192080,"title":"Devexpress ListBoxControl Add Item with multiple Colors","body":"<p>I am looking for a solution to add an <code>Item</code> in a <code>ListBoxControl</code> with different colors in the same <code>Row</code><br>\nex: 'imported company [ XCompany ]' - i need 'imported company' with a gray color and the rest with black<br>\nalso i need in case I have errors (Red)</p>\n\n<p>I can't find (if exists) the method to add an <code>Html</code> text </p>\n\n<p>Thanks</p>\n"},{"tags":[".net","sql","sql-server","dataset"],"answer_count":7,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":11956,"score":7,"question_id":589976,"title":"How can you name the Dataset's Tables you return in a stored proc?","body":"<p>I've got the following stored procedure</p>\n\n<pre><code>Create procedure psfoo ()\nAS\nselect * from tbA\nselect * from tbB\n</code></pre>\n\n<p>I'm then accessing the data this way :</p>\n\n<pre><code>     Sql Command mySqlCommand = new SqlCommand(\"psfoo\" , DbConnection)\n     DataSet ds = new DataSet();\n     mySqlCommand.CommandType = CommandType.StoredProcedure;\n     SqlDataAdapter mySqlDataAdapter = new SqlDataAdapter();\n     mySqlDataAdapter.SelectCommand = mySqlCommand;\n     mySqlDataAdapter.Fill(ds);\n</code></pre>\n\n<p>Now, when I want to access my tables, I have to do this :</p>\n\n<pre><code>     DataTable datatableA = ds.Tables[0];\n     DataTable datatableB = ds.Tables[1];\n</code></pre>\n\n<p>the dataset Tables property also got an accessor by string (instead of int).</p>\n\n<p><strong>Is it possible so specify the name of the tables in the SQL code, so that I can instead write this :</strong></p>\n\n<pre><code>     DataTable datatableA = ds.Tables[\"NametbA\"];\n     DataTable datatableB = ds.Tables[\"NametbB\"];\n</code></pre>\n\n<p>I'm using SQL server 2008, if that makes a difference.</p>\n"},{"tags":["asp.net",".net","asp.net-mvc","asp.net-mvc-4"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13192932,"title":"ASP.NET MVC4 Layout pages with VirtualPathProvider","body":"<p>Since upgrading from ASP.NET MVC3 to MVC4 I have run into an issue. The application has a big portion of it's controllers and views embedded into a dll that the main project references and the solution relies on a standard VirtualPathProvider that checks if the requested view exists in the dll and if so returns it.</p>\n\n<p>After upgrading to MVC4 the request for the layout page doesn't go through the VirtualPathProvider anymore, causing the entire application to crash. All of the other views including partial views are handled correctly and are loaded from the assembly.</p>\n\n<p>Has anyone else run into any similar problems after upgrading to MVC4?</p>\n"},{"tags":["c#",".net","winforms","datagridview"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":70,"score":1,"question_id":13190590,"title":"Add link labels to DataGridView","body":"<p>In my project, I'm filling the <code>dataGridView</code> from <code>dataSet</code> (binding the <code>DataGridView</code> to <code>DataSet</code>). The first column in <code>dataGridView</code> must be <code>LinkLabels</code> which I'm trying to get in the below code.</p>\n\n<pre><code>dgvMain.DataSorce = ds.Tables[0];\n</code></pre>\n\n<p>I tried: (<em>not working</em>)  </p>\n\n<pre><code>DataGridViewLinkCell lnkCell = new DataGridViewLinkCell();\nforeach (DataGridViewRow row in dgvMain.Rows)\n{\n    row.Cells[0] = lnkCell; // (ERROR) Cell provided already belongs to a grid. This operation is not valid.\n}\n</code></pre>\n\n<p><strong>also tried</strong></p>\n\n<pre><code>for (int intCount = 0; intCount &lt; dgvMain.Rows.Count; intCount++)\n{\n    dgvMain.Rows[intCount].Cells[0] = lnkCell; // (ERROR) Cell provided already belongs to a grid. This operation is not valid.\n}\n</code></pre>\n\n<p>The above attempts are adding <code>linkLabel</code> to the first cell only not all the cells in that column<br>When I debugged my code, I concluded that after adding the <code>linkLabel</code> to the first cell exception error is coming which I mentioned in the above code, which is making the code not to run properly.</p>\n\n<p>Please give me any suggestions, what should I do?</p>\n"},{"tags":["c#",".net","xaml","windows-phone-8"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13184388,"title":"Windows Phone 8 Map control - how to get map bounds","body":"<p>I'm using the brand new Windows Phone 8 Map control, but have run into an issue:  I need to get the LocationRectangle of the map's bounds, in other words the Latitude span and Longitude span.</p>\n\n<p>With the Bing Maps control, you can just do:</p>\n\n<pre><code> LocationRect bounds = map.Bounds;\n</code></pre>\n\n<p>...however, there seems to be no relevant fields in this new control.  Can anyone help, or do I need to reverse engineer the various Zoom Levels and work it out based on the center point, Zoom Level and pixel height/width ?</p>\n"}]}
