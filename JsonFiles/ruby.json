{"count":58119,"tag":"ruby","questions":[{"tags":["ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13280949,"title":"Rails append type to join table with has_many :through and association extensions","body":"<p>I have an AR association with extensions in Rails similar to the example presented in this link:\n<a href=\"http://railsadventures.wordpress.com/2012/08/28/activerecord-association-extensions/\" rel=\"nofollow\">ActiveRecord Association Extensions</a></p>\n\n<pre><code>has_many :issues, :through =&gt; :qbert_issues do\n  def tracking\n    where(\"qbert_issues.kind = ?\", \"tracking\")\n  end\n\n  def blocking\n    where(\"qbert_issues.kind = ?\", \"blocking\")\n  end\nend\n</code></pre>\n\n<p>As shown above, mine is multi-typed... I need to populate a 'kind' column in my join table.  Ideally, this should just work:</p>\n\n<pre><code>q = QBert.find(123)\nq.issues.tracking &lt;&lt; Issue.find(234)\n</code></pre>\n\n<p>So, what the article suggests is overloading <code>&lt;&lt;</code> and doing something like this:</p>\n\n<pre><code>has_many :issues, ... do\n  ...\n  def &lt;&lt;(issue)\n    issue.kind = \"UserAccount\"\n    proxy_association.owner.issues += [issue]\n  end\nend\n</code></pre>\n\n<p>Which would be nice, if kind was static.</p>\n\n<p>It looks like I can do this...</p>\n\n<pre><code>has_many :issues, ... do\n  ...\n  def &lt;&lt;(*args)\n    issue, kind = args.flatten\n    issue.kind = kind\n    proxy_association.owner.issues += [issue]\n  end\nend\n</code></pre>\n\n<p>Which would allow me to do this at the very least:</p>\n\n<pre><code>q = QBert.find(123)\nq.issues.tracking &lt;&lt; [Issue.find(234), :tracking]\n</code></pre>\n\n<p>That doesn't seem very DRY to me...is there a better way?  Bonus points if you take into account that the kind accessor is off a join table <code>qbert_issues</code>.  I'm guessing I just have to add the association manually through the <code>QBertIssue</code> model directly. </p>\n"},{"tags":["ruby","postgresql","amazon-ec2","amazon-web-services"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13265938,"title":"\"could not receive data from server: Connection timed out\" or \"connection not open\" errors when connecting to PostGres DB on a separate AWS instance","body":"<p>I am using Ruby 1.9.3 in my app server that is running on an AWS EC2 instance. I have my Postgres DB running on a separate EC2 instance but both instances are in the same security group.  When m Ruby code connects to the DB, it uses the Sequel ORM gem ( <a href=\"http://sequel.rubyforge.org/\" rel=\"nofollow\">http://sequel.rubyforge.org/</a> )</p>\n\n<p>Now, I have configured that Postgres 9.1.4 DB to be able to accept connections properly from the app server instance.</p>\n\n<p>However, every now and then, I noticed on the app server's logs that it will have trouble connecting to the Postgres DB instance and I would see error messages like these :</p>\n\n<pre><code>PG::Error: could not receive data from server: Connection timed out\n</code></pre>\n\n<p>or</p>\n\n<pre><code>PG::Error: connection not open\n</code></pre>\n\n<p>So I went to the Postgres DB instance and looked in /var/log/postgresql/postgresql-9.1-main.log and I see a bunch of messages like these:</p>\n\n<pre><code>2012-11-07 08:15:17 UTC LOG:  could not receive data from client: Connection timed out\n2012-11-07 08:15:17 UTC LOG:  unexpected EOF on client connection\n</code></pre>\n\n<p>I did searching around the web including stack overflow, and have made sure that my PostgreSQL does not have SSL enabled ( I have \"ssl=off\" inside my postgresql.conf file )</p>\n\n<p>At this point, I am not exactly sure what exactly is the issue in the Postgres configuration. I do not what to mess with the maximum # of connections or maximum timeout values on my production server without a good proven reason.</p>\n\n<p>The app server can connect to the DB most of the time, and this problem only shows up intermittently. </p>\n\n<p>On the Ruby-side, this is the error trace for \"connection not open\" when making the Postgres call :</p>\n\n<pre><code>PG::Error: connection not open\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:145:in `async_exec'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:145:in `block in execute_query'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/database/logging.rb:33:in `log_yield'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:145:in `execute_query'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:132:in `block in execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:111:in `check_disconnect_errors'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:132:in `execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:372:in `_execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:234:in `block (2 levels) in execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:379:in `check_database_errors'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:234:in `block in execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/database/connecting.rb:229:in `block in synchronize'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/connection_pool/threaded.rb:105:in `hold'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/database/connecting.rb:229:in `synchronize'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:234:in `execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/dataset/actions.rb:744:in `execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:483:in `fetch_rows'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/model/base.rb:785:in `primary_key_lookup'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/model/base.rb:124:in `[]'\n</code></pre>\n\n<p>Similarly, this is the trace for \"could not receive data from server\" :</p>\n\n<pre><code>    PG::Error: could not receive data from server: Connection timed out\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:124:in `block'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:124:in `ensure in check_disconnect_errors'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:124:in `check_disconnect_errors'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:132:in `execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:372:in `_execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:234:in `block (2 levels) in execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:379:in `check_database_errors'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:234:in `block in execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/database/connecting.rb:229:in `block in synchronize'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/connection_pool/threaded.rb:105:in `hold'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/database/connecting.rb:229:in `synchronize'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:234:in `execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/dataset/actions.rb:744:in `execute'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/adapters/postgres.rb:483:in `fetch_rows'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/model/base.rb:785:in `primary_key_lookup'\n/var/lib/gems/1.9.1/gems/sequel-3.38.0/lib/sequel/model/base.rb:124:in `[]'\n</code></pre>\n\n<p>Please let me know what I might have missed, I appreciate it!</p>\n\n<p>IS</p>\n"},{"tags":["html","ruby-on-rails","ruby","watir"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13280947,"title":"How to get value of a hidden element? (Watir)","body":"<p>just wondering, how can I get the value of a hidden element using watir? This is the element:</p>\n\n<pre><code>&lt;input type=\"hidden\" value=\"randomstringhere\" id=\"elementid\" name=\"elementname\" /&gt;\n</code></pre>\n\n<p>And this is my code atm:</p>\n\n<pre><code>require \"rubygems\"\nrequire \"watir-webdriver\"\n$browser = Watir::Browser.new :ff\n$browser.goto(\"http://www.site.com\")\n$grabelement = $browser.hiddens(:id, \"elementid\")\n$blah = $grabelement.attribute_value(\"value\")\nputs $blah\n</code></pre>\n\n<p>This gets stuck at the last line, where it returns </p>\n\n<pre><code>code.rb:6:in `&lt;main&gt;': undefined method `attribute_value' for #&lt;Watir::HiddenCollection:0x8818adc&gt; (NoMethodError)\n</code></pre>\n\n<p>Sorry for the basic question, I've had a search and couldn't find anything.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby","testing","rspec"],"answer_count":11,"favorite_count":24,"up_vote_count":63,"down_vote_count":0,"view_count":32507,"score":63,"question_id":143925,"title":"How do you run a single test/spec file in RSpec?","body":"<p>I want to be able to run a single spec file's tests &mdash; for the one file I'm editing, for example.  <code>rake spec</code> executes all the specs.  My project is not a Rails project, so <code>rake spec:doc</code> doesn't work.</p>\n\n<p>Don't know if this matters, but here is my directory structure.</p>\n\n<pre>\n./Rakefile\n./lib\n./lib/cushion.rb\n./lib/cushion\n./lib/cushion/doc.rb\n./lib/cushion/db.rb\n./spec\n./spec/spec.opts\n./spec/spec_helper.rb\n./spec/db_spec.rb\n</pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13281114,"title":"Hashes and Curly Braces in Ruby Methods","body":"<p>I have this method in one of my view files:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, class: \"btn\", id: \"some_id\" %&gt;\n</code></pre>\n\n<p>Is this correct, or would I have to attach the curly braces around the two hashes like so:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, { class: \"btn\", id: \"some_id\" } %&gt;\n</code></pre>\n"},{"tags":["ruby","variable-assignment"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":83,"score":5,"question_id":13208729,"title":"Ruby: Assign output of a function only if it does not return nil","body":"<p>When programming in Ruby I quite often have assignments like the following</p>\n\n<pre><code>test = some_function if some_function\n</code></pre>\n\n<p>With that assignments I want to assign the output of a function, but if it returns <code>nil</code> I want to keep the content of the variable. I know there are conditional assignments, but neither <code>||=</code> nor <code>&amp;&amp;=</code> can be used here. The shortest way I found to describe the statement above is</p>\n\n<pre><code>test = (some_function or test)\n</code></pre>\n\n<p>Is there a better / shorter way to do this?</p>\n"},{"tags":["javascript","python","ruby","windows","lua"],"answer_count":12,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":1345,"score":12,"question_id":4756544,"title":"Which scripting language is better for embedding in multi-threaded C/C++ application","body":"<p>Considering the following requirementes:</p>\n\n<ul>\n<li>Must be supported on Windows.  Preferably works also on other platforms.</li>\n<li>Must support multi threading.  By that I mean that the engine can work in parallel in multiple threads.</li>\n<li>Readability is important.</li>\n<li>License must be compatible with closed-source projects.</li>\n</ul>\n\n<p>I like Python for its readablity.  I am also have more experience with Python than other scripting languages.  However CPython is not multi-threaded, and IronPython requires hosting the CLR and a compatible language (C++/CLI or C#). </p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13281108,"title":"Parsing structured and semi-structured text with hundreds of tags with Ruby","body":"<p>I will be processing batches of 10,000-50,000 records with roughly 200-400 characters in each record.  I expect the number of search terms I could have would be no more than 1500 (all related to local businesses).</p>\n\n<p>I want to create a function that compares the structured tags with a list of terms to tag the data.  </p>\n\n<p>These terms are based on business descriptions.  So, for example, a <code>[Jazz Bar]</code>, <code>[Nightclub]</code>, <code>[Sports Bar]</code>, or <code>[Wine Bar]</code> would all correspond to queries for <code>[Bar]</code>.</p>\n\n<p>Usually this data has some kind of existing tag, so I can also create a strict hierarchy for the first pass and then do a second pass if there is no definitive existing tag.</p>\n\n<p>What is the most performance sensitive way to implement this?  I could have a table with all the keywords and try to match them against each piece of data.  This is straightforward in the case where I am matching the existing tag, less straightforward when processing free text.</p>\n\n<p>I'm using Heroku/Postgresql</p>\n"},{"tags":["ruby","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13280686,"title":"ruby find and replace portion of string","body":"<p>I have a large file in a ruby variable, it follows a common pattern like so:</p>\n\n<pre><code>// ...\n\n// comment\n$myuser['bla'] = 'bla';\n\n// comment\n$myuser['bla2'] = 'bla2';\n\n// ...\n</code></pre>\n\n<p>I am trying to given a 'key' replace the 'value'</p>\n\n<p>This replaces the entire string how do I fix it? Another method I thought is to do it in two steps, step one would be to find the value within the quotes then to perform a string replace, what's best?</p>\n\n<pre><code>def keyvalr(content, key, value)\n    return content.gsub(/\\$bla\\[\\'#{key}\\'\\]\\s+\\=\\s+\\'(.*)\\'/) {|m| value }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","email","serialization","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13264424,"title":"How to serialize and deserialise mailers?","body":"<p>How can I serialise the mailer so that it can be stored for further use?</p>\n\n<p>The serialised data should be disconnected and self sufficient to be delivered on separate machine that should deliver that message (not knowing about database or anything else).</p>\n"},{"tags":["ruby","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":11085779,"title":"Ruby MiniTest: readable output from assert_equal","body":"<p>Is there a standard way to make failure output from <code>assert_equal</code> more readable?</p>\n\n<pre><code>test \"compare\" do\n  assert_equal \"some string\", \"some string that differs\"\nend\n</code></pre>\n\n<p>This produces:</p>\n\n<pre><code>MiniTest::Assertion: &lt;\"some string\"&gt; expected but was\n&lt;\"some string that differs\"&gt;.\n</code></pre>\n\n<p>Ideally the output would be aligned, and perhaps trimmed to show where they actually differ. The current output is fine for small strings, but it gets hard to discern where they differ when the strings are long.</p>\n"},{"tags":["ruby","testing","mocking","double","block"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":8,"score":1,"question_id":13281006,"title":"Ruby Double (RR) How do I set up expectations for a block of method calls passed to block argument method?","body":"<p>In my code I have code similar to the following contrived example.</p>\n\n<pre><code>class Excel\n  def self.do_tasks\n    with_excel do |excel|\n      delete_old_exports\n      export_images(excel)\n      export_documents(excel)\n    end\n  end\n\n  def with_excel\n    excel = WIN32OLE.connect('Excel.Application')\n    begin\n      yield excel\n    ensure\n      excel.close()\n    end\n  end\nend\n</code></pre>\n\n<p>Now, I want to write a test for the 'do_tasks' method, where I set up expectations for the method calls and see if those expectations are fulfilled.</p>\n\n<p>I tried the following approach (with shoulda-context and test-unit). However,the expectations fail for the three last mocks (the mocks do not get called).</p>\n\n<pre><code>class ExcelTest &lt; ActiveSupport::TestCase  \n  should \"call the expected methods\" do  \n    mock.proxy(Excel).with_excel\n    mock(Excel).delete_old_exports\n    mock(Excel).export_images.with_any_args\n    mock(Excel).export_documents.with_any_args\n\n    Excel.do_tasks\n  end\nend\n</code></pre>\n\n<p>Any pointers on how to test this sort of code would be much appreciated! </p>\n"},{"tags":["ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":10,"score":2,"question_id":13280806,"title":"MRI Internals: detailed explanation of rb_id2str","body":"<p>In MRI, it appears that <code>rb_id2str()</code> is responsible for doing all of the work when you call <code>Symbol#to_s</code>. I was surprised to discover this is an extremely cryptic function for something that I assumed would be a fairly straight forward operation.</p>\n\n<p>I'm looking for a detailed explanation of what this function is doing. For reference, here is a link to the source in 1.9.3:</p>\n\n<p><a href=\"http://rxr.whitequark.org/mri/source/parse.y?v=1.9.3-p195#9950\" rel=\"nofollow\">http://rxr.whitequark.org/mri/source/parse.y?v=1.9.3-p195#9950</a></p>\n\n<p>Some specific questions:</p>\n\n<p>What are the four major <code>if</code> blocks doing?</p>\n\n<ol>\n<li><code>if (id &lt; tLAST_TOKEN)</code></li>\n<li><code>if (id &lt; INT_MAX &amp;&amp; rb_ispunct((int)id))</code></li>\n<li><code>if (st_lookup(global_symbols.id_str, id, &amp;data))</code></li>\n<li><code>if (is_attrset_id(id))</code></li>\n</ol>\n\n<p>It would be great to get a generic overview of what each block of code inside the if statements does, but it doesn't need to be a line-by-line analysis.</p>\n\n<p>Finally, I'm curious about the memory/garbage collection implications of <code>to_s</code>: does calling <code>Symbol#to_s</code> create a new string that has to be garbage collected every time, or is there something like internal copy-on-write optimization that uses a reference to the interned representation of the symbol up until a mutation is made to the string?</p>\n"},{"tags":["ruby","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13280846,"title":"Using ActiveRecord with DelegateClass","body":"<p>Using rails 3.2.8 I have a model setup with a couple attributes</p>\n\n<pre><code>class MyModel &lt; ActiveRecord::Base\n  attr_accessible :foo, :bar\nend\n</code></pre>\n\n<p>I have another class setup using the above as a delegate class</p>\n\n<pre><code>class MyModelPresenter &lt; DelegateClass(MyModel)\n  def initialize(month, obj)\n    @month = month\n    super(obj)\n  end\n\n  def self.build(month, attributes = { })\n    new(month, MyModel.new).tap do |p|\n      p.attributes = attributes\n    end\n  end\n\n  def attributes=(attributes)\n    attributes.each { |k, v| send(\"#{k}=\", v) }\n  end\nend\n</code></pre>\n\n<p>When I create a new MyModelPresenter like so:</p>\n\n<pre><code>MyModelPresenter.build(Date.today, {:foo =&gt; 1})\n</code></pre>\n\n<p>I get the following back</p>\n\n<pre><code>NoMethodError: undefined method `foo=' for #&lt;MyModel:0x1098f31a8&gt;\n    from /Users/me/.rbenv/versions/ree-1.8.7-2011.03/lib/ruby/gems/1.8/gems/activemodel-3.2.8/lib/active_model/attribute_methods.rb:404:in `method_missing'\n    from /Users/me/.rbenv/versions/ree-1.8.7-2011.03/lib/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/attribute_methods.rb:149:in `method_missing'\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `send'\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `attributes='\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `each'\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `attributes='\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:17:in `build'\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:15:in `tap'\n    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:15:in `build'\n</code></pre>\n\n<p>For some reason the database attributes on the model aren't getting defined (setters or getters). Before upgrading to rails 3.2 this was all working in a rails 3.1 app. </p>\n\n<p>Does anyone have any idea why the model's attribute methods aren't getting defined?</p>\n"},{"tags":["ruby-on-rails","ruby","mongodb","nested-forms","nested-form-for"],"answer_count":0,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":73,"score":5,"question_id":13182651,"title":"Nested fields with mongodb","body":"<p>I'm trying to create nested fields using mongodb. For that I'm using the gem <a href=\"http://www.mongomodel.org/\" rel=\"nofollow\">mongomodel</a> which allows work with ruby and mongodb and I'm using the gem <a href=\"https://github.com/ryanb/nested_form\" rel=\"nofollow\">nested_form</a>, to create dynamics nested fields. I'm having the following trouble:</p>\n\n<p><code>undefined method</code>reflect_on_association' for #`</p>\n\n<p>Other errors like it, that I have found in the internet doesn't really match what I want to do here with mongodb. I'm new to RoR, and I don't know how to solve this. Can anyone help me?</p>\n\n<p>Here is my models:</p>\n\n<p>survey.rb</p>\n\n<pre><code>class Survey &lt; MongoModel::Document\n  property :name, String\n  property :questions, Collection[Question]\n  timestamps!\n\n  accepts_nested_attributes_for :questions, :reject_if =&gt; lambda { |a| a[:content].blank? }, :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p>questions.rb</p>\n\n<pre><code>class Question &lt; MongoModel::Document\n  property :content, String\n  timestamps!\nend\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>surveys_controller.rb\nclass SurveysController &lt; ApplicationController\n  # GET /surveys\n  # GET /surveys.json\n  def index\n    @surveys = Survey.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @surveys }\n    end\n  end\n\n  # GET /surveys/1\n  # GET /surveys/1.json\n  def show\n    @survey = Survey.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @survey }\n    end\n  end\n\n  # GET /surveys/new\n  # GET /surveys/new.json\n  def new\n    @survey = Survey.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @survey }\n    end\n  end\n\n  # GET /surveys/1/edit\n  def edit\n    @survey = Survey.find(params[:id])\n  end\n\n  # POST /surveys\n  # POST /surveys.json\n  def create\n    @survey = Survey.new(params[:survey])\n\n    respond_to do |format|\n      if @survey.save\n        format.html { redirect_to @survey, notice: 'Survey was successfully created.' }\n        format.json { render json: @survey, status: :created, location: @survey }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @survey.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /surveys/1\n  # PUT /surveys/1.json\n  def update\n    @survey = Survey.find(params[:id])\n\n    respond_to do |format|\n      if @survey.update_attributes(params[:survey])\n        format.html { redirect_to @survey, notice: 'Survey was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @survey.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /surveys/1\n  # DELETE /surveys/1.json\n  def destroy\n    @survey = Survey.find(params[:id])\n    @survey.destroy\n\n    respond_to do |format|\n      format.html { redirect_to surveys_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>My gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem \"mongomodel\"\ngem \"bson_ext\"\ngem \"nested_form\"\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n# To use ActiveModel has_secure_password\n# gem 'bcrypt-ruby', '~&gt; 3.0.0'\n\n# To use Jbuilder templates for JSON\n# gem 'jbuilder'\n\n# Use unicorn as the app server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# gem 'debugger'\n</code></pre>\n\n<p>My view of survey:</p>\n\n<pre><code>_form.html.erb\n&lt;%= nested_form_for(@survey) do |f| %&gt;\n  &lt;% if @survey.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@survey.errors.count, \"error\") %&gt; prohibited this survey from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @survey.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;p&gt;\n    &lt;%= f.fields_for :questions do |builder| %&gt;\n    &lt;p&gt;\n        &lt;%= builder.label :content, \"Question\" %&gt;\n    &lt;%= builder.text_area :content, :rows =&gt; 3 %&gt;\n    &lt;/p&gt;    \n    &lt;% end %&gt;\n    &lt;p&gt;&lt;%= f.link_to_add \"Add a Question\", :questions %&gt;&lt;/p&gt;\n  &lt;/p&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby","google-analytics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13279911,"title":"Send a 'click' to Google Analytics from ruby","body":"<p>I'm building an app with some 'mail tracking' feature and want to notify google analytics about a click in a link from ruby.</p>\n\n<p>I've already changed all external links from email to go to my server to be redirected, so I know what and when the user clicked.</p>\n\n<p>I want to send this click just knowing the 'UA-XXXXX' and the clicked url.</p>\n\n<p>Is there a way? Or the best solution is to render a html page and with JS send the click event?</p>\n"},{"tags":["ruby","datamapper","ruby-datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13280220,"title":"Attaching datamapper operator to ruby symbol and put into hash","body":"<p>A simple ruby trivia.</p>\n\n<p>I have </p>\n\n<pre><code>{xyz =&gt; [:abc, :klm, :nop]}\n</code></pre>\n\n<p>I want to have something like this dynamically (say, 22, 33, 44 are some random values)</p>\n\n<pre><code>{:abc.gte =&gt; 22, :klm.gte =&gt; 33, :nop.gte =&gt; 44}\n</code></pre>\n\n<p><code>gte</code> is Datamapper operators, as documented at <a href=\"http://datamapper.org/docs/find.html\" rel=\"nofollow\">http://datamapper.org/docs/find.html</a></p>\n\n<p>Anyone has idea how to build second hash?</p>\n"},{"tags":["ruby","closures","memoization"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13244879,"title":"Ruby Pascal's triangle generator with memoization","body":"<p>I am attempting to memoize my implementation of a Pascal's triangle generator, as a Ruby learning experiment.  I have the following working code:</p>\n\n<pre><code>module PascalMemo\n  @cache = {}\n  def PascalMemo::get(r,c)\n    if @cache[[r,c]].nil? then \n      if c == 0 || c == r then \n        @cache[[r,c]] = 1\n      else\n        @cache[[r,c]] = PascalMemo::get(r - 1, c) + PascalMemo::get(r - 1, c - 1)\n      end\n    end\n    @cache[[r,c]]\n  end\nend\n\ndef pascal_memo (r,c)\n  PascalMemo::get(r,c)\nend\n</code></pre>\n\n<p>Can this be made more concise?  Specifically, can I create a globally-scoped function with a local closure more simply than this?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13279784,"title":"install fusefs gem using bundle in Mac OS X Lion","body":"<p>I am new to RoR and I am trying to install an application that we have at work and i have to run bundle install to install some gems that are required for the application to work. One of them is fusefs v 0.7.0 but when I run bundle install it fails when it gets to try to install fusefs stating </p>\n\n<p>Error: Error installing fusefs:\n       Error: failed to build gem native extension</p>\n\n<pre><code>  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\n  checking for main() in -lfuse_ino64... no\n  checking for main() in -lfuse... no\n</code></pre>\n\n<p><strong>* extconf.rb failed *</strong>\nCould not create Makefile due to some reason, probably lack of necessary libraries and/or headers. Check the mkmf.log file for more details.</p>\n\n<p>So at this point I have spend several days trying to get ruby, rails, passenger, mysql and apache to play nice on 10.8 and I am stuck at this last little piece.</p>\n\n<p>Any help will be appreciated it.</p>\n\n<p><em><strong></em></strong> Update <strong><em>*</em>*</strong>\nWell I just found my answer. The fusefs is a build specifically for linux.</p>\n"},{"tags":["html","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":23,"score":-1,"question_id":13280501,"title":"Parsing raw HTML data from HTTP Request in Ruby","body":"<p>I am working on a project where I have to send an HTTP Request and then parse the response, which is in raw HTML. Is there any easy way to parse this data? The HTML response is a table that contains data and I'm not sure how to get the specific data that I need. I want to avoid using RegEx if possible, but I fear that this may be my only option. Any help or direction would be greatly appreciated. </p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13280055,"title":"ruby 1.9.3 can't use open3 (uninitialized constant ConfigureController::Open3)","body":"<p>The project works fine in Ruby 1.9.2, but I want to use 1.9.3. </p>\n\n<p>This line worked fine in 1.9.2:</p>\n\n<pre><code>    o, e, s = Open3.capture3(\"echo a; sort &gt;&amp;2\", :stdin_data=&gt;\"foo\\nbar\\nbaz\\n\")\n</code></pre>\n\n<p>However in 1.9.3, I get </p>\n\n<p><code>uninitialized constant ConfigureController::Open3</code></p>\n\n<p>Do I have to install the module, or something? thanks!</p>\n"},{"tags":["ruby","rake","yard"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":131,"score":3,"question_id":7116207,"title":"How to prevent [view source] link when creating documentation using yard?","body":"<p>I am using yard to generate project documentation, but i don't want to display the [view source] link in the documentation, i have dived into the yard official guides but still don't get the solution.</p>\n\n<p>Anything ideas? Thanks.</p>\n"},{"tags":["ruby","unit-testing","garbage-collection","jruby"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":5,"score":2,"question_id":13280233,"title":"JRuby Garbage Collection throws error when running Unit and Functional tests in Rails","body":"<p>I'm running into an issue with JRuby and Garbage Collection in my tests in a Rails app (3.2.8). When I run my unit tests, I'm just fine, but when I run both unit and functional or just functional, it tends to blow up with a strange stacktrace as below.</p>\n\n<p>I have no idea what is going on. This only started happening when I upgraded Rails and upgraded JRuby from 1.6.3 to 1.6.7.2.</p>\n\n<pre><code> /home/mbridges/.rbenv/versions/jruby-1.6.7.2/bin/jruby -I\"lib:test\" -I\"/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib\" \"/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb\" \"test/unit/**/*_test.rb\"\n   * WARNING: 'test: #channel_id should return the correct channel id. ' is already defined\n Loaded suite /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader\n Started\n ...............................................................................\n ...............................................................................\n ...............................................................................\n ...............................................................................\n ...............................................................................\n ...............................................................................\n ...........................................................\n\n Finished in 156.993 seconds.\n\n 533 tests, 1030 assertions, 0 failures, 0 errors, 0 pendings, 0 omissions, 0 notifications\n 0% passed\n\n 3.40 tests/s, 6.56 assertions/s\n /home/mbridges/.rbenv/versions/jruby-1.6.7.2/bin/jruby -I\"lib:test\" -I\"/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib\" \"/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb\" \"test/functional/**/*_test.rb\"\n LoadError: No such file to load -- java.lang.OutOfMemoryError: GC overhead limit exceeded\n            depend_on at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:317\n            depend_on at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313\n   require_dependency at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225\n          eager_load! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:439\n                 each at org/jruby/RubyArray.java:1615\n          eager_load! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:438\n                 each at org/jruby/RubyArray.java:1615\n          eager_load! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:436\n             Finisher at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/finisher.rb:53\n        instance_exec at org/jruby/RubyBasicObject.java:1757\n                  run at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30\n     run_initializers at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:55\n                 each at org/jruby/RubyArray.java:1615\n     run_initializers at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54\n          initialize! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application.rb:136\n             __send__ at org/jruby/RubyBasicObject.java:1698\n                 send at org/jruby/RubyKernel.java:2097\n       method_missing at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30\n               (root) at /home/mbridges/admin_tools/mbridges_dev/customer_service_tool/config/environment.rb:12\n              require at org/jruby/RubyKernel.java:1042\n               (root) at /home/mbridges/admin_tools/mbridges_dev/customer_service_tool/config/environment.rb:2\n              require at org/jruby/RubyKernel.java:1042\n               (root) at /home/mbridges/admin_tools/mbridges_dev/customer_service_tool/test/test_helper.rb:1\n              require at org/jruby/RubyKernel.java:1042\n             __file__ at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10\n                 each at org/jruby/RubyArray.java:1615\n             __file__ at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9\n               select at org/jruby/RubyArray.java:2395\n               (root) at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4\n rake aborted!\n Command failed with status (1): [/home/mbridges/.rbenv/versions/jruby-1.6.7...]\n\n Tasks: TOP =&gt; without_schema_dump:functionals\n (See full trace by running task with --trace)\n</code></pre>\n\n<p>The Rakefile is a bit different since we are not actually in control of the database. We have to skip migrations.</p>\n\n<p># Add your own tasks in files placed in lib/tasks ending in .rake,\n    # for example lib/tasks/capistrano.rake, and they will automatically be available to Rake.</p>\n\n<pre><code>require File.expand_path('../config/application', __FILE__)\nrequire 'rake'\n\nCustomerService::Application.load_tasks\n\nnamespace :without_schema_dump do\n  Rake::TestTask.new(:units) do |t|\n    t.libs &lt;&lt; \"test\"\n    t.pattern = 'test/unit/**/*_test.rb'\n    t.verbose = true\n  end\n  Rake::TestTask.new(:functionals) do |t|\n    t.libs &lt;&lt; \"test\"\n    t.pattern = 'test/functional/**/*_test.rb'\n    t.verbose = true\n  end\n  task :run_tests =&gt; :environment do\n    Rake::Task['without_schema_dump:units'].invoke\n    Rake::Task['without_schema_dump:functionals'].invoke\n  end\nend\n\nRake::Task[:default].prerequisites.clear\nRake::Task[:default].actions.clear\ntask :default do\n  puts 'WARNING: Default rake overwritten because of foreign key constraints (see Rakefile)'\n  Rake::Task['without_schema_dump:run_tests'].invoke\nend\n</code></pre>\n\n<p>Help? Any help would be appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":52,"score":5,"question_id":13277077,"title":"Is changing `require` to concatenate Ruby files brilliant or crazy?","body":"<p>When booting a Rails application with lots of dependencies, a lot of time is spent (I think) in <code>require</code>ing files.</p>\n\n<p>Suppose you were to create a deploy process that converted all <code>require</code> statements to file concatenations, using the same rules (don't get the same file twice, etc). Essentially, it would treat Ruby the way the asset pipeline treats javascript.</p>\n\n<p>Would this make a real speed difference? Would it create any issues - for instance, with variable scope - other than making it harder to trace errors to their original source files? </p>\n\n<p>In short, <strong>is this brilliant or crazy?</strong></p>\n\n<h2>Update</h2>\n\n<p>As pst points out, this would be pointless in production, where the server likely loads everything once, then forks to handle new requests.</p>\n\n<p>But consider the test environment, where you boot your Rails app every time you run your tests. Pre-concatenating all your gems could have an effect similar to the Spork gem.</p>\n\n<p>I suppose my real question is <strong>how much time is spent in <code>require</code> vs parsing the contents of the files</strong>.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":21,"score":2,"question_id":13280086,"title":"Open another terminal to display information","body":"<p>I was wondering if there were a simple way to open a second terminal to display data.  So I have a program running in a terminal, and I was wondering if it'd be possible for that program to open a second terminal to which I could output information for the user to read (leaving the other terminal alone).</p>\n"},{"tags":["ruby-on-rails","ruby","video-streaming","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13280044,"title":"Rails send_file don't play mp4","body":"<p>I have a Rails app that protects the uploaded videos putting them into a private folder.</p>\n\n<p>Now I need to play these videos, and when I do something like this in the controller:</p>\n\n<pre><code>  def show\n    video = Video.find(params[:id])\n    send_file(video.full_path, type: \"video/mp4\", disposition: \"inline\")\n  end\n</code></pre>\n\n<p>And open the browser(Chrome or FF) at /videos/:id it doesn't play the video.</p>\n\n<p>If I put the same video at the public folder, and access it like /video.mp4 it will play.</p>\n\n<p>If I remove the dispositon: \"inline\" it will download the video and I can play it from my computer. Samething happens with webm videos.</p>\n\n<p>What am I missing? Is this something possible to do?</p>\n"},{"tags":["ruby-on-rails","ruby","amazon-web-services","beanstalk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13276335,"title":"can't get past AWS Elastic Beanstalk \"Congratulations\" screen when launching Ruby on Rails app","body":"<p>I followed all the directions here:\n<a href=\"http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html\" rel=\"nofollow\">http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html</a></p>\n\n<p>and the screen I'm getting is this:\n<a href=\"http://passagebank-env-ky692euhv5.elasticbeanstalk.com\" rel=\"nofollow\">http://passagebank-env-ky692euhv5.elasticbeanstalk.com</a>\nhttp://snapplr.com/pph8</p>\n\n<p>I'm in the process of creating the .rvmrc file at my application root path as well as the setup_load_paths.rb file in my /config folder as described here: <a href=\"http://blog.ninjahideout.com/posts/the-path-to-better-rvm-and-passenger-integration\" rel=\"nofollow\">http://blog.ninjahideout.com/posts/the-path-to-better-rvm-and-passenger-integration</a> ...I did all that, and then i realized my computer is using ruby 1.9.3p194 while the EC instances is 1.9.3p286. So I'm in the process of matching them up and re-creating the .rvmrc file. </p>\n\n<p>While doing that, i noticed that the beanstalk ec2 server doesnt even have rails installed. I should be able to type <code>rails --version</code> i assume and see the version like i can on my computer and with <code>ruby --version</code> on the server. So I'm installing RVM, with and rails as I've done in the past here: <a href=\"https://rvm.io/rvm/install\" rel=\"nofollow\">https://rvm.io/rvm/install</a> on my new beanstalk ec2 server. ...But in general, it seems this all defeats the purpose. It's supposed to be somewhat automatic. Installing rails definitely doesn't sound right. Was it installed another way on the server? </p>\n\n<p>...any advice on how to get the new beanstalk support for ROR working? what am di doing wrong?</p>\n"},{"tags":["ruby","ruby-on-rails-3","imagemagick","rmagick"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3,"score":0,"question_id":13279985,"title":"how to force build vendored gems in rails 3.01 - rmagick issue when vendored","body":"<p>I have vendored rmagick and its not behaving. Works fine when not vendored, but when vendoring using:</p>\n\n<pre><code>gem unpack rmagick --target vendor/gems\n\nFetching: rmagick-2.13.1.gem (100%)\nUnpacked gem: '/Users/joelnylund/Projects/aras/vendor/gems/rmagick-2.13.1'\n</code></pre>\n\n<p>Then When I try to load my server I get:</p>\n\n<pre><code>/Users/joelnylund/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:242:in `require': no such file to load -- RMagick2.so (LoadError)\n</code></pre>\n\n<p>I used to do \"rake gems:build:force\" to fix this on rails 2.3.5, but this gives me the same error now. How do I tell rails 3 to native build the vendored gem?</p>\n\n<p>Similar question, but no answer here:\n<a href=\"http://stackoverflow.com/questions/7169178/no-such-file-to-load-rmagick2-so\">no such file to load -- RMagick2.so</a></p>\n"},{"tags":["ruby","testing","rspec","call","block"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13279966,"title":"RSpec -- test if block called with block defined in before","body":"<p>I <a href=\"http://stackoverflow.com/questions/13249177/rspec-test-if-method-called-its-block-parameter#comment18053559_13249177\">recently asked</a> how to test in RSpec if a block was called and the answers to that question seem to work in a simple case. The problem is when the initialization with the block is more complex. Then it is done in <code>before</code> and reused by a number of different tests in the context, among them the one testing if the block was evaluated. See the example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>context \"the node definition using block of code\" do\n  before do\n     @n=node do\n        # this block should be called\n     end\n     # some more complex setup concerning @n\n  end\n\n  it \"should call the block\" do\n     # how to test it?\n  end\n\n  # here a bunch of other tests using @n\n\nend\n</code></pre>\n\n<p>In this case the solution with side effect changing value of a local variable does not work. Raising an exception from the block is useless since the whole statement must be properly evaluated to be used by the other tests.</p>\n\n<p>Obviously I could do the tests separately, but it seems to stink, since I must copy-paste the initialization part and since the was-the-block-called test inherently belongs to this very context.</p>\n\n<p>How to test if the block was evaluated in such a case?</p>\n"},{"tags":["ruby-on-rails","ruby","xcode","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13279856,"title":"The compiler failed to generate an executable file. (RuntimeError)","body":"<p>I've checked a number of similar questions on stackoverflow but haven't found an answer yet.</p>\n\n<p>I recently upgraded to OS Mountain Lion. A project I'm working on requires gem sys-proctable as a dependency, but when I run <code>bundle install</code> I get:</p>\n\n<pre><code>Fetching gem metadata from https://rubygems.org/.........\n.\n.\n.\nInstalling sys-proctable (0.9.2) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb \nchecking for rb_pid_t in ruby.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1022:in `try_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1050:in `block in have_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1049:in `have_type'\n    from extconf.rb:3:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin for inspection.\nResults logged to /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin/ext/darwin/gem_make.out\nAn error occurred while installing sys-proctable (0.9.2), and Bundler cannot continue.\nMake sure that `gem install sys-proctable -v '0.9.2'` succeeds before bundling.\n</code></pre>\n\n<p>But I do have developer tools installed! Running <code>gem install sys-proctable -v '0.9.2'</code> gives me nearly the same error:</p>\n\n<pre><code>Building native extensions.  This could take a while...\nERROR:  Error installing sys-proctable:\n    ERROR: Failed to build gem native extension.\n\n        /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\nchecking for rb_pid_t in ruby.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1022:in `try_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1050:in `block in have_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1049:in `have_type'\n    from extconf.rb:3:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin for inspection.\nResults logged to /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin/ext/darwin/gem_make.out\n[sample_app(filling-in-layout)]$ /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n                                                                              A [sample_app(filling-in-layout)]$ gem install sys-proctable -v '0.9.2'\nBuilding native extensions.  This could take a while...\nERROR:  Error installing sys-proctable:\n    ERROR: Failed to build gem native extension.\n\n        /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\nchecking for rb_pid_t in ruby.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1022:in `try_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1050:in `block in have_type'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:1049:in `have_type'\n    from extconf.rb:3:in `&lt;main&gt;'\n\n\nGem files will remain installed in /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin for inspection.\nResults logged to /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/sys-proctable-0.9.2-universal-darwin/ext/darwin/gem_make.out\n</code></pre>\n\n<p>Here's the content of my <code>mkmf.log</code> file:</p>\n\n<pre><code>\"/usr/bin/gcc-4.2 -o conftest -I/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/x86_64-darwin11.4.0 -I/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby/backward -I/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1 -I. -I/Users/mgriffel/.rvm/usr/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -I/opt/sm/pkg/active/include -fno-common -pipe conftest.c  -L. -L/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/lib -L/Users/mgriffel/.rvm/usr/lib -L. -L/opt/sm/pkg/active/lib -L/usr/local/lib     -lruby.1.9.1  -lpthread -ldl -lobjc \"\nchecked program was:\n/* begin */\n1: #include \"ruby.h\"\n2: \n3: int main() {return 0;}\n/* end */\n</code></pre>\n\n<p>Now I recently reinstalled XCode and Command Line Tools, but I'm worried that I somehow fucked up my C compiler, because when I try to run <code>rvm --force install 1.9.3</code> I get the following errors:</p>\n\n<pre><code>No binary rubies available for: downloads/ruby-1.9.3-p194.\nContinuing with compilation. Please read 'rvm mount' to get more information on binary rubies.\nlipo: can't open input file:  (No such file or directory)\nFetching yaml-0.1.4.tar.gz to /Users/mgriffel/.rvm/archives\nExtracting yaml to /Users/mgriffel/.rvm/src/yaml-0.1.4\nConfiguring yaml in /Users/mgriffel/.rvm/src/yaml-0.1.4.\nError running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --prefix=/Users/mgriffel/.rvm/usr', please read /Users/mgriffel/.rvm/log/ruby-1.9.3-p194/yaml/configure.log\nCompiling yaml in /Users/mgriffel/.rvm/src/yaml-0.1.4.\nInstalling yaml to /Users/mgriffel/.rvm/usr\nInstalling Ruby from source to: /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194, this may take a while depending on your cpu(s)...\nruby-1.9.3-p194 - #downloading ruby-1.9.3-p194, this may take a while depending on your connection...\nruby-1.9.3-p194 - #extracted to /Users/mgriffel/.rvm/src/ruby-1.9.3-p194 (already extracted)\nPatch cflags was already applied.\nruby-1.9.3-p194 - #configuring\nError running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib ./configure --enable-shared --disable-install-doc --prefix=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194 --with-gcc=clang', please read /Users/mgriffel/.rvm/log/ruby-1.9.3-p194/configure.log\nThere has been an error while running configure. Halting the installation.\n</code></pre>\n\n<p>Contents of <code>configure.log</code></p>\n\n<pre><code>[2012-11-07 18:02:12] env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib ./configure --enable-shared --disable-install-doc --prefix=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194 --with-gcc=clang\nchecking build system type... x86_64-apple-darwin12.2.0\nchecking host system type... x86_64-apple-darwin12.2.0\nchecking target system type... x86_64-apple-darwin12.2.0\nchecking whether the C compiler works... no\nconfigure: error: in `/Users/mgriffel/.rvm/src/ruby-1.9.3-p194':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\n</code></pre>\n\n<p>Finally, contents of <code>config.log</code>:</p>\n\n<pre><code>This file contains any messages produced by compilers while\nrunning configure, to aid debugging if configure makes a mistake.\n\nIt was created by configure, which was\ngenerated by GNU Autoconf 2.69.  Invocation command line was\n\n  $ ./configure --enable-shared --disable-install-doc --prefix=/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194 --with-gcc=clang\n\n## --------- ##\n## Platform. ##\n## --------- ##\n\nhostname = Mattans-MacBook-Air.local\nuname -m = x86_64\nuname -r = 12.2.0\nuname -s = Darwin\nuname -v = Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64\n\n/usr/bin/uname -p = i386\n/bin/uname -X     = unknown\n\n/bin/arch              = unknown\n/usr/bin/arch -k       = unknown\n/usr/convex/getsysinfo = unknown\n/usr/bin/hostinfo      = Mach kernel version:\n     Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64\nKernel configured for up to 4 processors.\n2 processors are physically available.\n4 processors are logically available.\nProcessor type: i486 (Intel 80486)\nProcessors active: 0 1 2 3\nPrimary memory available: 4.00 gigabytes\nDefault processor set: 138 tasks, 703 threads, 4 processors\nLoad average: 3.07, Mach factor: 1.53\n/bin/machine           = unknown\n/usr/bin/oslevel       = unknown\n/bin/universe          = unknown\n\nPATH: /Users/mgriffel/.rvm/usr/bin\nPATH: /opt/local/bin\nPATH: /opt/local/sbin\nPATH: /usr/local/bin\nPATH: /usr/local/sbin\nPATH: /usr/local/mysql/bin\nPATH: /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin\nPATH: /Users/mgriffel/.rvm/gems/ruby-1.9.3-p194@global/bin\nPATH: /Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194/bin\nPATH: /Users/mgriffel/.rvm/bin\nPATH: /usr/bin\nPATH: /bin\nPATH: /usr/sbin\nPATH: /sbin\nPATH: /opt/sm/bin\nPATH: /opt/sm/pkg/active/bin\nPATH: /opt/sm/pkg/active/sbin\n\n\n## ----------- ##\n## Core tests. ##\n## ----------- ##\n\nconfigure:2788: checking build system type\nconfigure:2802: result: x86_64-apple-darwin12.2.0\nconfigure:2870: checking host system type\nconfigure:2883: result: x86_64-apple-darwin12.2.0\nconfigure:2903: checking target system type\nconfigure:2916: result: x86_64-apple-darwin12.2.0\nconfigure:3395: checking for C compiler version\nconfigure:3404: clang --version &gt;&amp;5\nApple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)\nTarget: x86_64-apple-darwin12.2.0\nThread model: posix\nconfigure:3415: $? = 0\nconfigure:3404: clang -v &gt;&amp;5\nApple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)\nTarget: x86_64-apple-darwin12.2.0\nThread model: posix\nconfigure:3415: $? = 0\nconfigure:3404: clang -V &gt;&amp;5\nclang: error: argument to '-V' is missing (expected 1 value)\nclang: error: no input files\nconfigure:3415: $? = 1\nconfigure:3404: clang -qversion &gt;&amp;5\nclang: error: no input files\nconfigure:3415: $? = 1\nconfigure:3435: checking whether the C compiler works\nconfigure:3457: clang   -L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib conftest.c  &gt;&amp;5\nclang: error: no such file or directory: 'CFLAGS=-I/opt/sm/pkg/active/include'\nclang: error: no such file or directory: 'CPATH=/opt/sm/pkg/active/include'\nconfigure:3461: $? = 1\nconfigure:3499: result: no\nconfigure: failed program was:\n| /* confdefs.h */\n| #define PACKAGE_NAME \"\"\n| #define PACKAGE_TARNAME \"\"\n| #define PACKAGE_VERSION \"\"\n| #define PACKAGE_STRING \"\"\n| #define PACKAGE_BUGREPORT \"\"\n| #define PACKAGE_URL \"\"\n| #define CANONICALIZATION_FOR_MATHN 1\n| /* end confdefs.h.  */\n| \n| int\n| main ()\n| {\n| \n|   ;\n|   return 0;\n| }\nconfigure:3504: error: in `/Users/mgriffel/.rvm/src/ruby-1.9.3-p194':\nconfigure:3506: error: C compiler cannot create executables\nSee `config.log' for more details\n\n## ---------------- ##\n## Cache variables. ##\n## ---------------- ##\n\nac_cv_build=x86_64-apple-darwin12.2.0\nac_cv_env_CCC_set=\nac_cv_env_CCC_value=\nac_cv_env_CC_set=\nac_cv_env_CC_value=\nac_cv_env_CFLAGS_set=\nac_cv_env_CFLAGS_value=\nac_cv_env_CPPFLAGS_set=\nac_cv_env_CPPFLAGS_value=\nac_cv_env_CPP_set=\nac_cv_env_CPP_value=\nac_cv_env_CXXFLAGS_set=\nac_cv_env_CXXFLAGS_value=\nac_cv_env_CXX_set=\nac_cv_env_CXX_value=\nac_cv_env_LDFLAGS_set=set\nac_cv_env_LDFLAGS_value='-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib'\nac_cv_env_LIBS_set=\nac_cv_env_LIBS_value=\nac_cv_env_build_alias_set=\nac_cv_env_build_alias_value=\nac_cv_env_host_alias_set=\nac_cv_env_host_alias_value=\nac_cv_env_target_alias_set=\nac_cv_env_target_alias_value=\nac_cv_host=x86_64-apple-darwin12.2.0\nac_cv_prog_CC=clang\nac_cv_target=x86_64-apple-darwin12.2.0\n\n## ----------------- ##\n## Output variables. ##\n## ----------------- ##\n\nALLOCA=''\nAR=''\nARCHFILE=''\nARCH_FLAG=''\nAS=''\nASFLAGS=''\nBASERUBY='ruby'\nBUILTIN_ENCOBJS=''\nBUILTIN_TRANSOBJS=''\nBUILTIN_TRANSSRCS=''\nCAPITARGET=''\nCC='clang'\nCCDLFLAGS=''\nCFLAGS=''\nCHDIR=''\nCOMMON_HEADERS=''\nCOMMON_LIBS=''\nCOMMON_MACROS=''\nCOUTFLAG=''\nCP=''\nCPP=''\nCPPFLAGS=''\nCPPOUTFILE=''\nCXX=''\nCXXFLAGS=''\nDEFS=''\nDLDFLAGS=''\nDLDLIBS=''\nDLEXT2=''\nDLEXT=''\nDLLWRAP=''\nDOT=''\nDOXYGEN=''\nECHO_C='\\c'\nECHO_N=''\nECHO_T=''\nEGREP=''\nENABLE_SHARED=''\nEXECUTABLE_EXTS=''\nEXEEXT=''\nEXPORT_PREFIX=''\nEXTOUT=''\nEXTSTATIC=''\nGCC=''\nGNU_LD=''\nGREP=''\nINSTALLDOC=''\nINSTALL_DATA=''\nINSTALL_PROGRAM=''\nINSTALL_SCRIPT=''\nLDFLAGS='-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include -L/Users/mgriffel/.rvm/usr/lib'\nLDSHARED=''\nLDSHAREDXX=''\nLIBEXT=''\nLIBOBJS=''\nLIBPATHENV=''\nLIBPATHFLAG=''\nLIBRUBY=''\nLIBRUBYARG=''\nLIBRUBYARG_SHARED=''\nLIBRUBYARG_STATIC=''\nLIBRUBY_A=''\nLIBRUBY_ALIASES=''\nLIBRUBY_DLDFLAGS=''\nLIBRUBY_LDSHARED=''\nLIBRUBY_RELATIVE=''\nLIBRUBY_SO=''\nLIBS=''\nLINK_SO=''\nLN_S=''\nLTLIBOBJS=''\nMAINLIBS=''\nMAJOR='1'\nMAKEDIRS=''\nMAKEFILES=''\nMANTYPE=''\nMINIOBJS=''\nMINIRUBY=''\nMINOR='9'\nMKDIR_P=''\nNM=''\nNROFF=''\nNULLCMD=''\nOBJCOPY=''\nOBJDUMP=''\nOBJEXT=''\nOUTFLAG=''\nPACKAGE=''\nPACKAGE_BUGREPORT=''\nPACKAGE_NAME=''\nPACKAGE_STRING=''\nPACKAGE_TARNAME=''\nPACKAGE_URL=''\nPACKAGE_VERSION=''\nPATH_SEPARATOR=':'\nPKG_CONFIG=''\nPREP=''\nRANLIB=''\nRDOCTARGET=''\nRI_BASE_NAME=''\nRM=''\nRMALL=''\nRMDIR=''\nRMDIRS=''\nRPATHFLAG=''\nRUBYW_BASE_NAME='rubyw'\nRUBYW_INSTALL_NAME=''\nRUBY_BASE_NAME='ruby'\nRUBY_INSTALL_NAME=''\nRUBY_PROGRAM_VERSION='1.9.3'\nRUBY_RELEASE_DATE='2012-04-20'\nRUBY_SO_NAME=''\nRUNRUBY=''\nSET_MAKE=''\nSHELL='/bin/sh'\nSOLIBS=''\nSTATIC=''\nSTRIP=''\nSYMBOL_PREFIX=''\nTEENY='1'\nTEST_RUNNABLE=''\nTHREAD_MODEL=''\nTRY_LINK=''\nUNIVERSAL_ARCHNAMES=''\nUNIVERSAL_INTS=''\nUSE_RUBYGEMS=''\nWERRORFLAG=''\nWINDRES=''\nXCFLAGS=''\nXLDFLAGS=''\nXRUBY=''\nXRUBY_LIBDIR=''\nXRUBY_RUBYHDRDIR=''\nXRUBY_RUBYLIBDIR=''\nac_ct_CC=''\nac_ct_CXX=''\nac_ct_OBJCOPY=''\nac_ct_OBJDUMP=''\narch=''\nbindir='${exec_prefix}/bin'\nbuild='x86_64-apple-darwin12.2.0'\nbuild_alias=''\nbuild_cpu='x86_64'\nbuild_os='darwin12.2.0'\nbuild_vendor='apple'\ncflags=' ${optflags} ${debugflags} ${warnflags}'\nconfigure_args=''\ncppflags=''\ncxxflags=' ${optflags} ${debugflags} ${warnflags}'\ndatadir='${datarootdir}'\ndatarootdir='${prefix}/share'\ndebugflags=''\ndocdir='${datarootdir}/doc/${PACKAGE}'\ndvidir='${docdir}'\nexec=''\nexec_prefix='NONE'\nhost='x86_64-apple-darwin12.2.0'\nhost_alias=''\nhost_cpu='x86_64'\nhost_os='darwin12.2.0'\nhost_vendor='apple'\nhtmldir='${docdir}'\nincludedir='${prefix}/include'\ninfodir='${datarootdir}/info'\nlibdir='${exec_prefix}/lib'\nlibexecdir='${exec_prefix}/libexec'\nlocaledir='${datarootdir}/locale'\nlocalstatedir='${prefix}/var'\nmandir='${datarootdir}/man'\noldincludedir='/usr/include'\noptflags=''\npdfdir='${docdir}'\nprefix='/Users/mgriffel/.rvm/rubies/ruby-1.9.3-p194'\nprogram_transform_name='s&amp;^&amp;&amp;'\npsdir='${docdir}'\nridir=''\nruby_pc=''\nruby_version=''\nrubyhdrdir=''\nrubylibprefix=''\nrubyw_install_name=''\nsbindir='${exec_prefix}/sbin'\nsetup=''\nsharedstatedir='${prefix}/com'\nsitearch=''\nsitedir=''\nsitehdrdir=''\nsysconfdir='${prefix}/etc'\ntarget='x86_64-apple-darwin12.2.0'\ntarget_alias=''\ntarget_cpu='x86_64'\ntarget_os='darwin12.2.0'\ntarget_vendor='apple'\ntry_header=''\nvendordir=''\nvendorhdrdir=''\nwarnflags=''\n\n## ----------- ##\n## confdefs.h. ##\n## ----------- ##\n\n/* confdefs.h */\n#define PACKAGE_NAME \"\"\n#define PACKAGE_TARNAME \"\"\n#define PACKAGE_VERSION \"\"\n#define PACKAGE_STRING \"\"\n#define PACKAGE_BUGREPORT \"\"\n#define PACKAGE_URL \"\"\n#define CANONICALIZATION_FOR_MATHN 1\n\nconfigure: exit 77\n</code></pre>\n\n<p>Please help, I've been stuck here for days.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13279730,"title":"Ruby Infinite Loop","body":"<p>I'm currently learning ruby, and I've gotten stuck on this problem: </p>\n\n<p>Write a Deaf Grandma program. Whatever you say to grandma (whatever you type in), she should respond with  HUH?!  SPEAK UP, SONNY!, unless you shout it (type in all capitals). If you shout, she can hear you and yells back, NO, NOT SINCE 1938! To make your program really believable, have grandma shout a different year each time; maybe any year at random between 1930 and 1950. You can't stop talking to grandma until you shout BYE.</p>\n\n<p>This is the code I tried: </p>\n\n<pre><code>puts \"Say something to Grandma!\"\nsomething = gets.chomp\nwhile something != \"BYE\"\n    if something == something.upcase\n      puts \"NO, NOT SINCE 19\" + (rand(30..50)).to_s + \"!\"\n    else\n      puts \"HUH? SPEAK UP SONNY!\"\n    end\nend\n</code></pre>\n\n<p>Whenever I execute this, the if and else strings just go on an infinite loop. What am I doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":10,"favorite_count":3,"up_vote_count":14,"down_vote_count":0,"view_count":4836,"score":14,"question_id":93853,"title":"How to fix / debug 'expected x.rb to define X.rb' in Rails","body":"<p>I have seen this problem arise in many different circumstances and would like to get the best practices for fixing / debugging it on StackOverflow.</p>\n\n<p>To use a real world example this occurred to me this morning:</p>\n\n<pre><code>expected announcement.rb to define Announcement\n</code></pre>\n\n<p>The class worked fine in development, testing <em>and</em> from a production console, but failed from in a production Mongrel. Here's the class:</p>\n\n<pre><code>class Announcement &lt; ActiveRecord::Base\n  has_attachment :content_type =&gt; 'audio/mp3', :storage =&gt; :s3\nend\n</code></pre>\n\n<p>The issue I would like addressed in the answers is not so much solving this specific problem, but how to properly debug to get Rails to give you a meaningful error as expected x.rb to define X.rb' is often a red herring...</p>\n\n<p><strong>Edit (3 great responses so far, each w/ a partial solution</strong>)</p>\n\n<p><strong>Debugging:</strong></p>\n\n<ol>\n<li><p>From Joe Van Dyk: Try accessing the model via a console on the environment / instance that is causing the error (in the case above: script/console production then type in 'Announcement'.</p></li>\n<li><p>From Otto: Try setting a minimal plugin set via an initializer, eg: config.plugins = [ :exception_notification, :ssl_requirement, :all ] then re-enable one at a time.</p></li>\n</ol>\n\n<p><strong>Specific causes:</strong></p>\n\n<ol>\n<li><p>From Ian Terrell: if you're using attachment_fu make sure you have the correct image processor installed. attachment_fu will require it even if you aren't attaching an image.</p></li>\n<li><p>From Otto: make sure you didn't name a model that conflicts with a built-in Rails class, eg: Request.</p></li>\n<li><p>From Josh Lewis: make sure you don't have duplicated class or module names somewhere in your application (or Gem list).</p></li>\n</ol>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":49,"score":2,"question_id":13279217,"title":"Are there unintended consequences of Ruby's `begin ... end` without `rescue` used as a code block?","body":"<p>I occasionally see <code>begin...end</code> blocks used in ruby without any <code>rescue</code>, <code>else</code>, <code>ensure</code>, etc. statements in between. For example:</p>\n\n<pre><code>foo = begin\n   whatever = 3\n   \"great\"\n   42\nend\n</code></pre>\n\n<p>The coder's intent, it seems, is to use the <code>begin...end</code> block just for its block-grouping quality (as if <code>begin</code> were <code>do</code>). Personally I think this usage kind of violates the principle of least surprise (<code>begin</code> implies exception-handling to me).</p>\n\n<p>Are there any unintended consequences of using <code>begin...end</code> in this way? Do <code>begin...end</code> blocks have any semantic differences (maybe in exception-handling?) that make this usage dangerous? </p>\n\n<p>Ruby's syntax is unbelievably subtle, and I wouldn't be surprised if there were weird gotchas lying in wait here.</p>\n"},{"tags":["ruby","arrays","ruby-on-rails-3","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13279312,"title":"Rails 3 Return Array From Collection.each Block","body":"<p>I'm trying to return some json to the calling action. One of the params I want to pass is an array of arrays built from looping through a collection as so: </p>\n\n<pre><code>render :json =&gt; {     \n:rows =&gt; @classrooms.each do |classroom|\n          [classroom.name, classroom.students.count]\n        end    \n}  \n</code></pre>\n\n<p>However, this sets :rows to the entire collection as opposed to what I want:</p>\n\n<blockquote>\n  <p>[[classroom, students],[classroom, students],[classroom, students]]</p>\n</blockquote>\n\n<p>Is there any way of looping through the collection and returning an array in a single block?</p>\n"},{"tags":["ruby","testing","minitest"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":912,"score":1,"question_id":7959523,"title":"Can minitest do something like \"rspec --color --format doc\"?","body":"<p>I want a pretty-printed summary of what tests are running, similar to</p>\n\n<pre><code>rspec --color --format doc\n</code></pre>\n\n<p>Can <a href=\"https://github.com/seattlerb/minitest\" rel=\"nofollow\">minitest</a> do that?</p>\n"},{"tags":["ruby-on-rails","ruby","oauth-2.0","keep-alive"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":112,"score":2,"question_id":12059704,"title":"Net HTTP Persistent / Keep Alive with Ruby OAuth2 gem","body":"<p>I'm trying to figure out how to enable HTTP keep alive using the <a href=\"https://github.com/intridea/oauth2\" rel=\"nofollow\">OAuth2 gem</a>. Oauth2 is built on Faraday, which does appear to have experimental <a href=\"https://github.com/technoweenie/faraday/blob/master/lib/faraday/adapter/net_http_persistent.rb\" rel=\"nofollow\">support using net-http-persistent</a>. The only way I can find to enable it in Faraday is to use:</p>\n\n<pre><code>Faraday.default_adapter = :net_http_persistent\n</code></pre>\n\n<p>I have a few questions:</p>\n\n<ol>\n<li>Is enabling it in Faraday in turn enabling it for Oauth2?</li>\n<li>Is there anyway to test whether HTTP keep alive is actually working and enabled?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13278710,"title":"has_many and belongs_to of the same model","body":"<p>I am pretty new to rails. I am trying to figure out the most efficient way to create a relationship between two models that states:</p>\n\n<ol>\n<li>A user can \"favorite\" many songs</li>\n<li>A song has an owner.</li>\n</ol>\n\n<p>This is what I am thinking of doing. Does it make sense ?</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :songs #songs this user has favorited\nend\n\nclass Song &lt; ActiveRecord::Base\n    belongs_to :user #the user whom submitted this song\nend\n</code></pre>\n\n<p>My concern about this method is that I'm unsure about the efficiency of doing query on every song in the database just to figure out which songs a particular user owns. Is there a different way I should be thinking about this ? </p>\n\n<p>By the way, is there a method by which I can call the attribute something different than it's model name. So rather than <code>User.find(1).songs[0]</code> I could say <code>User.find(1).favorites[0]</code> even though the model is still a \"Song\". </p>\n"},{"tags":["ruby","pik"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13278578,"title":"pik not listing ruby 1.9.3","body":"<p>I'm running win 7 and just installed pik via the installer. I listed the ruby versions and the most recent version is 1.9.2[-1.3.6]. I saw a post where someone mentioned to use \"pik list -r\" but pik tells me it's deprecated and then uses \"list known\" anyway. I want to install ruby 1.9.3 and do not currently have any ruby installed on this machine.</p>\n\n<p>Sorry in advance if this is a duplicate question, but I didn't see it.</p>\n\n<p>Thanks\nPatrick</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","meta-search"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":105,"score":3,"question_id":7893349,"title":"Avoiding select * queries in meta_search","body":"<p>I'm using meta_search gem on a rails 3 site and I'm finding some performance problems with the select * queries generated by meta_search fetching the BLOB fields in the DB schema. I am not willing to migrate the underlying schema to solve this problem. Is there a way to include/exclude certain fields from the search query that get generated by meta_search?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13279045,"title":"Whats the difference in Rails when a class is in quotes","body":"<p>I've noticed a couple examples in Rspec and FactoryGirl where some people put the class name in quotes, and some don't.</p>\n\n<p>Example rspec:</p>\n\n<pre><code>describe \"User\" do\n...specs...\nend\n\ndescribe User do\n...specs...\nend\n</code></pre>\n\n<p>Example FactoryGirl</p>\n\n<pre><code>factory :high_school_account, class: \"Account\" do\n  Name \"Test Account Name\"\n  AccountTypeId 1\nend\n\nfactory :high_school_account, class: Account do\n  Name \"Test Account Name\"\n  AccountTypeId 1\nend\n</code></pre>\n\n<p>I thought I read somewhere it had to do when the class is loaded into the ruby environment, but I might be completely making that up.</p>\n\n<p>Is there a difference between the quoted and non-quoted versions?</p>\n"},{"tags":["html","ruby","parsing"],"answer_count":5,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":3908,"score":4,"question_id":395261,"title":"Best Rails HTML Parser","body":"<p>I know that Hpricot is still a standard but I remember hearing about a faster more expressive HTML parser for Ruby.</p>\n\n<p>Does anybody know what it's called and if it is worth switching to from Hpricot??</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby","data-structures","sudoku"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13278833,"title":"Data structure design critique and analysis for characterizing sudoku as map-coloration","body":"<p>I designed and implemented a sudoku solver in ruby which is working well enough as is as a challenge based on user input from StackOverflow.  At the moment, it uses a hybrid of constraint propagation and search, at each step checking a box, and calling the solution method recursively for each valid option.  Most puzzles solve within seconds, even milliseconds, but I specifically had in mind to challenge the solver with the worst-case sort of puzzle for brute force, one I had found on Wikipedia.  Growing impatient at 45 mins of solve time, I timed the number of seconds per step each puzzle took and extrapolated that this puzzle would take 10 hours.\nTo make the time more reasonable I have some further optimizations in mind:</p>\n\n<ol>\n<li>I used some hashes for sloppy purposes and I'll clean my code up</li>\n<li>I'd like to try parrallelization even though my laptop only has 2 cores</li>\n<li>I'll use some actual logical strategies for the puzzle, such as naked pairs, X-wing, etc</li>\n</ol>\n\n<p>Furthermore, I'd like to generalize the solver's abilities to irregular sudokus, so I figured I'd move from a plain old 2D array to using nodes which link up with other nodes of their region.  This got me to thinking about the nature of the data structure I'll be designing as a whole.  I have a few options, and I'm in a data structures class right now, so bear with me if I don't fully wrap my head around the vagaries thereof, but mainly they are as follows:</p>\n\n<ol>\n<li>a 2d grid of nodes linked to each other by region, and columns and rows are still handled by the same array iteration code</li>\n<li>one 2d linked list characterized by a single head pointer, and each row and column is lumped together with the region data</li>\n</ol>\n\n<p>The gist of the node class is that it has the following data:</p>\n\n<ul>\n<li>value</li>\n<li>is mutable (i.e., is not a known initial value)</li>\n<li>unfilled neighbors</li>\n<li>filled neighbors (to memoize the available values somewhat instead of searching everywhere each time)</li>\n</ul>\n\n<p>and the following methods:</p>\n\n<ul>\n<li>get remaining values</li>\n<li>fill box</li>\n</ul>\n\n<p>Data structure option 1 allows for the duplication of the entire grid and passing a new copy of it amongst functions instead of altering state.  In the case of state alterations, I need to account for backtracking, which would mean an addition #empty_box method.</p>\n\n<p>Data structure option 2 necessitates a longer handshaking period setting up the node linkages to account for adding links to each element of a row, column or region to each of its neighbors once and once only.  I feel like the actual solution code would be simpler if all the boxes which need to be checked were in one list, though.  Strategies for sudoku are generally agnostic to their physical layout as much as their logical layout.</p>\n\n<p>Is there any sort of difference in performance to expect between the two options?  Am I on the right track, or perhaps overcomplicating the design?  I intuit the nodes are a good idea on all counts regarding the various optimizations and feature extensions I wish to implement, but I have doubts.  Critiques are welcome as well as answers to the specific question of which may be assumed to be faster.  Memory usage isn't really a concern.</p>\n\n<p>The code is rather involved for question answering purposes, but may be <a href=\"http://github.com/alexnye/sudoku_solver\" rel=\"nofollow\">perused at leisure</a>.</p>\n\n<p>Thank you.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13278806,"title":"Rails search in db with different fields","body":"<p>I have 5 select's in my html code. I send them to controller, but for example some of them could be empty (default value is 0), so for example in some case i need to search only via <code>params[:size]</code>  is some case only via <code>params[:capacity]</code> and in other <code>params[:size] and params[:capacity]</code> both as well... But how do to this? how to operate with find etc?\nnow i have something like this:</p>\n\n<pre><code>size = \"*\"+params[:akbsize]+\"*\"\n    @accums = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", size])\n    cap = \"*\"+params[:akbcapacity]+\"*\"\n    @accums2 = Accumulator.find(:all, :conditions =&gt; [\"MATCH(description) AGAINST (? in boolean mode)\", cap])\n</code></pre>\n\n<p>But how to do as i described? Is it good to do here with metasearch gem?</p>\n"},{"tags":["ruby","arrays","math","sum"],"answer_count":8,"favorite_count":23,"up_vote_count":87,"down_vote_count":0,"view_count":34874,"score":87,"question_id":1538789,"title":"How to sum array members in Ruby?","body":"<p>I have an array of integers.</p>\n\n<p>For example:</p>\n\n<pre><code>array = [123,321,12389]\n</code></pre>\n\n<p>Is there any nice way to get the sum of them?</p>\n\n<p>I know, that </p>\n\n<pre><code>sum = 0\narray.each { |a| sum+=a }\n</code></pre>\n\n<p>would work.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13278550,"title":"Update attribute on a has_many relationship","body":"<p>I am printing a list of user's contacts and want to give the user the ability to mark each contact as \"done\". (Essentially marking them off their to do list).</p>\n\n<p>How do I update the :done attribute for the specific contact? </p>\n\n<p>This is form with a hidden field is not working:</p>\n\n<pre><code>&lt;% if current_user.contacts.any? %&gt;\n&lt;% current_user.contacts.each do |c| %&gt; \n    &lt;li id=\"&lt;%= c.id %&gt;\"&gt;\n        &lt;%= c.name %&gt;&lt;br/&gt;\n\n        &lt;%= form_for(@contact) do |f| %&gt;\n            &lt;%= f.hidden_field :done, :value=&gt;true %&gt;\n            &lt;%= f.submit \"Mark as done\", class: \"btn btn-small btn-link\"%&gt;\n        &lt;% end %&gt;\n\n    &lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n\n\n<p>I get this error:</p>\n\n<pre><code>Template is missing Missing template contacts/create, application/create with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"C:/Sites/rails_projects/sample_app/app/views\"\n</code></pre>\n\n<p>This is my contacts controller:</p>\n\n<pre><code>def create\n  @contact = current_user.contacts.build(params[:contact])\n  if @contact.save\n    flash[:success] = \"Contact saved!\"\n    redirect_to root_url\n  else\n    flash[:error] = \"Something is wrong\"\n  end\nend\n</code></pre>\n"},{"tags":["ruby","testing","webdriver","watir"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13234145,"title":"Return elements that match as an array","body":"<p>I am new to the Watir world, having used webdriver and geb in a previous company.  I want to know if Watir offers any method that is analogous to the get_elements method from webdriver.  See below for an example.</p>\n\n<p>Imagine the following html exists within a larger page</p>\n\n<pre><code>&lt;div class=\"someClass\"&gt;someText&lt;/div&gt;\n&lt;div class=\"someClass\"&gt;someMoreText&lt;/div&gt;\n&lt;div class=\"someClass\"&gt;evenMoreText&lt;/div&gt;\n</code></pre>\n\n<p>I want make some assertion against each of the divs by locating all elements of the given class and iterating through them.  Using webdriver, I could do it like this:</p>\n\n<pre><code>elements = driver.get_elements(:css, \".someClass\")\nelements.each do |element|\n    //some assert on element\nend\n</code></pre>\n\n<p>Does Watir provide an equivalent construct?  I can't find anything useful in the Watir documentation.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","globalize3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13265384,"title":"Is it \"advisable\" / \"the right way\" to store all possible translations?","body":"<p>I am using Ruby on Rails v3.2.2 and the <a href=\"https://github.com/svenfuchs/globalize3\" rel=\"nofollow\">Globalize3 v0.2.0</a> gem. At this time I am using Globalize3 in order to translate country, region and city names in two languages but I plan to use it to internationalize my application in many more languages (ideally, all). So, I am populating the database with translation data, but I have some doubts on that: should I populate my <code>country_translations</code>, <code>region_translations</code> and <code>city_translations</code> database tables with <em>all</em> internationalized names (even if it may be that some names are the same as the default ones - in this case the internationalized name is <em>nil</em> or repeated)? that is, in translation tables should I create a translation record <em>for each</em> locale supported by my application (in my current case, two locales) and <em>for each</em> country, region and city?</p>\n\n<p>Making so, in a \"ideal\" scenario supporting all languages, mentioned tables (mostly those related to regions and cities) will be very large and probabily performance less. On the other hand, it makes sure that Globalize3 will properly work since it seems that in some cases when the internationalized record doesn't exist (I avoid to explain my specific case since it is \"hard\" to do, and maybe it'd need a book to be explained) that gem does <em>not</em> properly fallback to the current locale.</p>\n\n<p>How should I proceed?</p>\n"},{"tags":["ruby","heroku","amazon-s3","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13278133,"title":"Failing to catch Errno::ECONNRESET in Ruby code","body":"<p>In my Rails 3.1 project, deployed to Heroku, I have a rake task that generates a few hundred thousand small PNGs based on records in the database and uploads the results to S3 using <a href=\"http://fog.io/\" rel=\"nofollow\">fog</a>, one file at a time. (Before I was using heroku, the task saved the files locally and everything worked fine.) When I run the task using <code>heroku run:detached</code>, it runs for a while, and uploads a bunch of files, but eventually fails with <code>Connection reset by peer (Errno::ECONNRESET)</code>. What's weird about this is that I've modified the script to catch and retry that exception like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>file_exists = false\nretry_count = 10\nbegin\n  file_exists = directory.files.head(filekey)\nrescue Errno::ECONNRESET =&gt; e\n  if retry_count &gt; 0 then\n    logger.warning(\"Connection reset: #{e.inspect}\")\n    retry_count -= 1\n    sleep(1)\n    retry\n  else\n    raise\n  end\nend\n</code></pre>\n\n<p>According to the stack trace, <code>file_exists = directory.files.head(filekey)</code> is the line of my code that leads to the exception, so I feel like I'm missing something about Ruby exception handling. I'd love to know what I'm doing wrong, since I'm not 100% sure if this is a problem with my begin/rescue block, the way fog handles network errors, or what. </p>\n\n<p>Here's the complete stack trace:</p>\n\n<pre><code>Nov 07 12:08:01 ... app/run.1:  Connection reset by peer (Errno::ECONNRESET)\nNov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/openssl/buffering.rb:36:in `sysread'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/openssl/buffering.rb:36:in `fill_rbuff'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/openssl/buffering.rb:68:in `read'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/socket.rb:121:in `read'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/timeout.rb:67:in `timeout'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/socket.rb:120:in `read'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/ssl_socket.rb:79:in `read'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/response.rb:21:in `parse'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/connection.rb:275:in `request_kernel'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/excon-0.16.7/lib/excon/connection.rb:103:in `request'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/core/connection.rb:20:in `request'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/aws/storage.rb:392:in `request'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/aws/requests/storage/head_object.rb:53:in `head_object'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/fog-1.6.0/lib/fog/aws/models/storage/files.rb:98:in `head'\nNov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:45\nNov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:37:in `each'\nNov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:37\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:21:in `find_each'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:21:in `each'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:21:in `find_each'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:69:in `find_in_batches'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/activerecord-3.1.8/lib/active_record/relation/batches.rb:20:in `find_each'\nNov 07 12:08:01 ... app/run.1:  /app/lib/tasks/assets.rake:35\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/ruby-1.8.7/lib/ruby/1.8/monitor.rb:242:in `synchronize'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/bin/rake:33\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/bin/rake:23:in `load'\nNov 07 12:08:01 ... app/run.1:  /app/vendor/bundle/ruby/1.8/bin/rake:23\nNov 07 12:08:01 ... app/run.1:  Tasks: TOP =&gt; ...:make_outlines\nNov 07 12:08:02 ... heroku/run.1:  Process exited with status 1\nNov 07 12:08:02 ... heroku/run.1:  State changed from up to complete\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","arrays"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13276969,"title":"How to iterate via array in ruby and compare","body":"<p>I have for example such array:</p>\n\n<pre><code>40,42,45,49,50,52,54,55 etc\n</code></pre>\n\n<p>Via post-query i'm getting from select some value: for example 40-50, then i split this value for two numbers: <code>40 and 50</code> (but that's not the main problem, with split, question is in another).\nI need to compare this two values, so that array values must be in <code>[40...50)</code> values. So all what is in this interval i must select for my other calculations...\nHow to do this? aybe with map, but how?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13278096,"title":"User to User Messages in Rails","body":"<p>I've been building messaging in a rails app for users to be able to send each other messages. I've looked at a few gems such as mailboxer but ultimately decided to build my own.</p>\n\n<p>I'm hoping someone can help me put these pieces together. I've been following a similar question's answer <a href=\"http://stackoverflow.com/questions/5141564/model-users-message-in-rails-3\">here</a>.</p>\n\n<p>I'm testing in the rails console and I keep getting the following error: </p>\n\n<p>undefined method `send_message' for #</p>\n\n<p>How can I fix this?</p>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>class MessagesController &lt; ApplicationController\n    # create a comment and bind it to an article and a user  \n    def create\n      @user = User.find(params[:id])\n      @sender = current_user\n      @message = Message.send_message(@sender, @user)\n      flash[:success] = \"Message Sent.\"\n      flash[:failure] = \"There was an error saving your comment (empty comment or comment way to long)\"\n    end\nend\n</code></pre>\n\n<p><strong>Routes</strong></p>\n\n<pre><code>  resources :users, :except =&gt; [ :create, :new ] do\n     resources :store\n     resources :messages, :only =&gt; [:create, :destroy] \n  end\n</code></pre>\n\n<p><strong>Messages Model</strong></p>\n\n<pre><code>class Message &lt; ActiveRecord::Base\n  belongs_to :user\n\n  scope :sent, where(:sent =&gt; true)\n  scope :received, where(:sent =&gt; false)\n\n  def send_message(from, recipients)\n     recipients.each do |recipient|\n       msg = self.clone\n       msg.sent = false\n       msg.user_id = recipient\n       msg.save\n     end\n     self.update_attributes :user_id =&gt; from.id, :sent =&gt; true\n   end\nend\n</code></pre>\n"},{"tags":["c","ruby","stack","ulimit"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13245019,"title":"How to change the stack size using ulimit or per process on Mac OS X for a C or Ruby program?","body":"<p>It seems that the recommended way to set stack size for a C program or Ruby program (which uses the C stack), is by using <code>ulimit</code> in the Bash shell.  But</p>\n\n<pre><code>$ ulimit -s\n8192\n\n$ ulimit -s 16384\n-bash: ulimit: stack size: cannot modify limit: Operation not permitted\n</code></pre>\n\n<p>and <code>sudo</code> doesn't help either.  Is there a way to set it to 16MB, 32MB, or 64MB?  I thought there should be a way to set it per program invocation instead of setting a system wide parameter as well?</p>\n\n<p>Right now <code>8192</code> probably means 8MB which is quite small, if that is compared to how much a process can be using, sometimes as much as 2GB of RAM.</p>\n\n<p>(<strong>updated note:</strong> <code>ulimit -a</code> can show its current values).</p>\n\n<p>(<strong>update 2:</strong> it actually seems like <code>ulimit -s &lt;value&gt;</code> is per shell, and that if you set it the first time, it usually works.  The problem is when you set it the second time, then it may return an error)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13276783,"title":"get models name and count","body":"<p>I have this in <code>models_name</code>:</p>\n\n<pre><code>model_names = Object.constants.collect { |sym| Object.const_get(sym) }.select { |constant| constant.class == Class &amp;&amp; constant.include?(Mongoid::Document) }.collect { |klass| klass.name }\n</code></pre>\n\n<p>the result is:</p>\n\n<pre><code>[\"Model_name1\",\"Model_name2\",\"Model_name3\"]\n</code></pre>\n\n<p>I need something like:</p>\n\n<pre><code>[{\"Model1\":\"Count\"},{\"Model2\":\"Count\"},{\"Model3\":\"Count\"}]\n</code></pre>\n\n<p>I need show in a chart all models and object counter inside each model is working with <code>morris.js</code></p>\n\n<p>You can see the example:</p>\n\n<p><a href=\"http://jsbin.com/uzosiq/2/embed?javascript,live\" rel=\"nofollow\">http://jsbin.com/uzosiq/2/embed?javascript,live</a></p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13277751,"title":"Ruby code in yaml file?","body":"<p>I am using a gem that have this e-mail method:</p>\n\n<pre><code>  #Sends and email for indicating a reply in an already created conversation\n  def reply_message_email(message,receiver)\n    @message = message\n    @receiver = receiver\n    subject = message.subject.to_s\n    subject = strip_tags(subject) unless subject.html_safe?\n    mail(:to =&gt; receiver.send(Mailboxer.email_method,message), :subject =&gt; t('mailboxer.message_mailer.subject_reply', :subject =&gt; subject)) do |format|\n      format.text {render __method__}\n      format.html {render __method__}\n    end\n  end\nend\n</code></pre>\n\n<p>And I have this in my locale:</p>\n\n<pre><code>da:\n  mailboxer:\n    message_mailer:\n        subject_reply: You have got a new reply \"#{subject}\"\n</code></pre>\n\n<p>Instead of overwriting the email method. Is it not possible to do some ruby code in a YAML file? Now the subject of an e-mail is just You have got a new reply \"#{subject}\" as text and the ruby code is not active.</p>\n"},{"tags":["ruby","ruby-on-rails-3","jruby","jruby-openssl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13277774,"title":"OpenSSL::SSL::SSLError in jruby 1.6.7/1.7.0 1.9 mode","body":"<p>I'm running a rails 3 app with jruby 1.7.0 in 1.9 mode, and when one of my file uploading gems tries to make a https connection, it fails with the following exception:</p>\n\n<pre><code>Excon::Errors::SocketError: write would raise (OpenSSL::SSL::SSLError)\n    from org/jruby/ext/openssl/SSLSocket.java:626:in `syswrite_nonblock'\n    from /home/x/.rvm/gems/jruby-1.7.0@global/gems/jruby-openssl-0.7.7/lib/1.9/openssl/buffering.rb:375:in `write_nonblock'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/socket.rb:139:in `write'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/ssl_socket.rb:84:in `write'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/connection.rb:243:in `request_kernel'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/connection.rb:103:in `request'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/core/connection.rb:20:in `request'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace.rb:71:in `authenticate'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace/storage.rb:146:in `authenticate'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace/storage.rb:95:in `initialize'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/core/service.rb:68:in `new'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/storage.rb:34:in `new'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:106:in `connection'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:323:in `connection'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:335:in `directory'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:250:in `store'\n</code></pre>\n\n<p>I found a similar issue on stackoverflow here: <a href=\"http://stackoverflow.com/questions/11859549/jruby-heroku-gem\">JRuby Heroku Gem</a>, but the suggested answer is run jruby in 1.8 mode which I cannot do since our entire app uses 1.9 features and syntax. Does anybody have any ideas or suggesetions on how to fix or get around this exception?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby","image","colors"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":9074185,"title":"Automatically color balance images","body":"<p>Is there a way in Ruby to automatically color-balance images that are uploaded to my Ruby on Rails app? </p>\n\n<p>It seems like a lot of the images I'm uploading are too dark and I'd like to normalize all my images to be equally bright if possible, rather than simply making every image brighter. If some image is sufficiently bright, it should not be changed.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","psych"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":10,"score":3,"question_id":13277729,"title":"Ruby - gem psych serialize - LoadError enc/trans/single_byte","body":"<p>I encountered a weird problem while using ActiveRecord::Store module in my Ruby on Rails app. As I understand, this module use 'serialize' method under the hood so it just serialize your data to yaml format with ruby built-in psych gem.</p>\n\n<p>It works OK most of the time, but sometimes I get 500 error with the following message:</p>\n\n<pre><code>LoadError (cannot load such file -- enc/trans/single_byte):\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:27:in `write'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:27:in `end_document'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:27:in `visit_Psych_Nodes_Document'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:15:in `visit'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:5:in `accept'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:20:in `block in visit_Psych_Nodes_Stream'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:20:in `each'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/emitter.rb:20:in `visit_Psych_Nodes_Stream'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:15:in `visit'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/visitors/visitor.rb:5:in `accept'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych/nodes/node.rb:46:in `yaml'\n~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/psych.rb:243:in `dump'\n</code></pre>\n\n<p>As you can see, I use rbenv and ruby 1.9.3-p286. My system is Ubuntu 11.10. Required file exists <code>~/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/i686-linux/enc/trans/single_byte.so</code>. The same error I encountered with ruby 1.9.3-p194. And the most weird part  of this problem that this error occurs from time to time.</p>\n\n<p>So maybe someone encountered this problem too and has already found a solution? Or does it seem more like a bug in psych and I should file it to its maintainer?</p>\n\n<p>Thanks in advance for any help!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1106,"score":4,"question_id":9237201,"title":"Getting frequent Gem RemoteFetcher::FetchError. Any workarounds?","body":"<p>I've been getting this error frequently every day for the last few days...</p>\n\n<pre><code>$ gem install rails -v 3.2.1\nERROR:  While executing gem ... (Gem::RemoteFetcher::FetchError)\n    bad response Forbidden 403 (http://production.cf.rubygems.org/gems/rdoc-3.12.gem)\n</code></pre>\n\n<p>My understanding based on a <a href=\"http://stackoverflow.com/questions/8580753/gem-install-rails-failing-any-workaround\">previous question</a> is that this is due to a problem with the remote repository and the solution is to just wait a little while and try again. Indeed, sometimes when I wait a few hours or overnight the install command works.</p>\n\n<p>However, I'm hoping for a more reliable experience.</p>\n\n<p>I thought of downloading files such as <code>rails-3.2.1.gem</code> and then running...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem\n</code></pre>\n\n<p>But that gives me...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem \nERROR:  While executing gem ... (Gem::DependencyError)\n    Unable to resolve dependencies: rails requires railties (= 3.2.1)\n</code></pre>\n\n<p>I could try downloading railties. Maybe I will. But I sense a plunge down a rabbit hole there of searching out dependency after dependency all day long.</p>\n\n<p>Any alternate efficient ways to install gems? Is there something I could do through my repository specification that would allow gem installation to be more reliable?</p>\n\n<hr>\n\n<pre><code>$ gem environment\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.8.15\n  - RUBY VERSION: 1.9.2 (2011-07-09 patchlevel 290) [x86_64-darwin11.2.0]\n  - INSTALLATION DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n  - RUBY EXECUTABLE: /Users/ethan/.rvm/rubies/ruby-1.9.2-p290/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-11\n  - GEM PATHS:\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - :sources =&gt; [\"http://rubygems.org\"]\n     - \"gem\" =&gt; \"--no-rdoc --no-ri\"\n     - \"install\" =&gt; \"--no-rdoc --no-ri\"\n     - \"update\" =&gt; \"--no-rdoc --no-ri\"\n  - REMOTE SOURCES:\n     - http://rubygems.org\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","plugins","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13277514,"title":"When trying to run Rails server it crashes on Rake","body":"<p>I`ve just upgraded the apps rails version from 3.0.9 to 3.1.2 &amp; also switched from ruby 1.8.7 to 1.9.2.</p>\n\n<p>While trying to run the server after the updates I get the error message below:</p>\n\n<pre><code>rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/dsl_definition.rb:65:in `directory': wrong number of arguments (0 for 1) (ArgumentError)\n    from /Users/Big_Bird/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/dsl_definition.rb:165:in `directory'\n    from /Users/Big_Bird/apps/Example/vendor/plugins/calendar_date_select/init.rb:12:in `block (2 levels) in &lt;class:Plugin&gt;'\n    from /Users/Big_Bird/apps/Example/vendor/plugins/calendar_date_select/init.rb:11:in `each'\n    from /Users/Big_Bird/apps/Example/vendor/plugins/calendar_date_select/init.rb:11:in `block in &lt;class:Plugin&gt;'\n</code></pre>\n\n<p>Now the snippet where the error occurs for the plugin is:</p>\n\n<pre><code>%w[calendar_date_select includes_helper].each { |file| \n  require File.join( File.dirname(__FILE__), \"lib\",file) \n}\n\nActionView::Helpers::FormHelper.send(:include, CalendarDateSelect::FormHelper)\nActionView::Base.send(:include, CalendarDateSelect::FormHelper)\nActionView::Base.send(:include, CalendarDateSelect::IncludesHelper)\n\n# install files\nunless File.exists?(Rails.root + '/public/javascripts/calendar_date_select/calendar_date_select.js')\n  ['/public', '/public/javascripts/calendar_date_select', '/public/stylesheets/calendar_date_select', '/public/images/calendar_date_select', '/public/javascripts/calendar_date_select/locale'].each do |dir|\n    source = File.join(directory,dir)\n    dest = Rails.root + dir\n    FileUtils.mkdir_p(dest)\n    FileUtils.cp(Dir.glob(source+'/*.*'), dest)\n  end\nend\n</code></pre>\n\n<p>I`m not quite sure where the problem lies since all of the directories listed in the plugin are correct, while upgrading I had to switch from using RAILS_ROOT to Rails.root but thats about it.</p>\n\n<p>I would appreciate any guidance on how to fix this issue.</p>\n"},{"tags":["css","ruby-on-rails","ruby","views"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13276603,"title":"Rails: Stylesheet/view issue? Nothing is showing on the screen although there is source code when viewed in browser","body":"<p>I have a rails app with many partials for one view, each partial is a section in the view (one paged website).\nI have put all my assets in the correct places etc.\nbelow is a screenshot of how the actual page should look (outside of rails) (header, then section one which you can see, and there are sections below etc).</p>\n\n<p><img src=\"http://i.stack.imgur.com/KtVe5.jpg\" alt=\"enter image description here\"></p>\n\n<p>However this is how it is showing when done in rails\n<img src=\"http://i.stack.imgur.com/gOpwT.png\" alt=\"enter image description here\"></p>\n\n<p>No images are shown for some reason, nor any content. \nWhen I do not include the style sheet, all the content (writing) shows fine. When I include the stylesheet, everything disappears, its all white. However there are content there because I am able to scroll up/down.</p>\n\n<p>Below is a screenshot of the structure of my files \n<img src=\"http://i.stack.imgur.com/5cnSZ.png\" alt=\"enter image description here\"></p>\n\n<p>I basically have all my images inside the image folder, but there are subfolders inside the image folders.\nso:</p>\n\n<pre><code>assets (folder)\n images (folder)\n  section_1 (folder)\n   image.png (file)\n</code></pre>\n\n<p>in my css, because my css files are inside the stylesheets folder, I call my urls as follows:</p>\n\n<pre><code>background-image:url(\"../images/section_1/image.png\");\n</code></pre>\n\n<p>As for my views, it is basically one view which renders out each section (partial).</p>\n"},{"tags":["ruby","string","perl","split"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":1,"view_count":82,"score":5,"question_id":13273318,"title":"Empty strings at the beginning and end of split","body":"<p>In Ruby, when I split a string with a delimiter that matches the beginning of the string, it gives an empty string in the initial position of the array:</p>\n\n<pre><code>\"abc\".split(/a/) # =&gt; [\"\", \"bc\"]\n</code></pre>\n\n<p>but when I do a similar thing with a delimiter that matches the end of the string, it does not give an empty string:</p>\n\n<pre><code>\"abc\".split(/c/) # =&gt; [\"ab\"]\n</code></pre>\n\n<p>This looks inconsistent to me. Is there any rationale for such specification?</p>\n\n<p><strong>Edit</strong>\nIf it is to be compatible with Perl's specification as in muu is to short's answer, then the question remains the same: Why is it like that in Perl? And for this reason, now it also becomes a question about Perl.</p>\n"},{"tags":["ruby-on-rails","ruby","gem","rake","production"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":13252836,"title":"Could not find rake-0.9.2.2 in any of the sources (Bundler::GemNotFound) using windwos 7 (no rvm)","body":"<p>people,</p>\n\n<p>I'm new to ROR, not bloody new (anymore) but unexperienced with moving apps to production. To understand how the move-to-production-flow works I created a very simple rails project. Here are some basic infos about my system (running on windows 7):</p>\n\n<pre><code>Ruby version                1.9.3 (i386-mingw32)\nRubyGems version            1.8.24\nRack version                1.4\nRails version               3.2.8\nJavaScript Runtime          JScript\nActive Record version       3.2.8\nAction Pack version         3.2.8\nActive Resource version     3.2.8\nAction Mailer version       3.2.8\nActive Support version      3.2.8\nApplication root            C:/Sites/railstest\nEnvironment                 development\nDatabase adapter            sqlite3\nDatabase schema version     0\n</code></pre>\n\n<p>Middleware:</p>\n\n<pre><code>ActionDispatch::Static\nRack::Lock\n#&lt;ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x2a70f20&gt;\nRack::Runtime\nRack::MethodOverride\nActionDispatch::RequestId\nRails::Rack::Logger\nActionDispatch::ShowExceptions\nActionDispatch::DebugExceptions\nActionDispatch::RemoteIp\nActionDispatch::Reloader\nActionDispatch::Callbacks\nActiveRecord::ConnectionAdapters::ConnectionManagement\nActiveRecord::QueryCache\nActionDispatch::Cookies\nActionDispatch::Session::CookieStore\nActionDispatch::Flash\nActionDispatch::ParamsParser\nActionDispatch::Head\nRack::ConditionalGet\nRack::ETag\nActionDispatch::BestStandardsSupport\n</code></pre>\n\n<p>My webhost is webhostone.</p>\n\n<p><strong>And here is what I did:</strong></p>\n\n<ol>\n<li>Generate a new rails app called railstest using: rails new railstest</li>\n<li>Updated the gemfile with the versions used on my webhost</li>\n<li>run \"bundle install --deployment\" to have all the gems in vendor-directory.</li>\n<li>FTP'ed everything to the webhost</li>\n<li>successfully run bundle install via PuTTY</li>\n</ol>\n\n<p>But when I call the site I always get something like this:\n<a href=\"http://www.kernification.de/rails/info/properties\" rel=\"nofollow\">http://www.kernification.de/rails/info/properties</a>\n(I don't have enough reputations to post an image here...)</p>\n\n<p>I've tried a lot more (I'm fighting for ~1.5weeks now with this issue) but it seems to be the same issue all the time. The webhost support told me the gems are located in 1.9.1, not in 1.8 and I have some questions about this:</p>\n\n<ol>\n<li>What is 1.9.1 (or 1.8) the version of? Ruby? Gem?</li>\n<li>How do I force to look for the gems in 1.9.1 instead of 1.8?</li>\n</ol>\n\n<p>I also tried using pik as version manager but I will only use webhostone so far, so I happy if I have one version of ruby installed that is working. So far I don't need to switch between any versions. I also moved to xubuntu, created the same simple app there, same result.</p>\n\n<p>Would be great if you could share your experience, thanks a lot!</p>\n"},{"tags":["ruby-on-rails","ruby","associations","has-many","has-many-through"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":2900,"score":2,"question_id":428066,"title":"Elegantly selecting attributes from has_many :through join models in Rails","body":"<p>I'm wondering what the easiest/most elegant way of selecting attributes from join models in has_many :through associations is.</p>\n\n<p>Lets say we have Items, Catalogs, and CatalogItems with the following Item class:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n      has_many :catalog_items\n      has_many :catalogs, :through =&gt; :catalog_items\nend\n</code></pre>\n\n<p>Additionally, lets say that CatalogueItems has a position attribute and that there is only one CatalogueItem between any catalog and any item. </p>\n\n<p>The most obvious but slightly frustrating way to retrieve the position attribute is:</p>\n\n<pre><code>@item         = Item.find(4)\n@catalog      = @item.catalogs.first\n@cat_item     = @item.catalog_items.first(:conditions =&gt; {:catalog_id =&gt; @catalog.id})\nposition      = @cat_item.position\n</code></pre>\n\n<p>This is annoying because it seems that we should be able to do @item.catalogs.first.position since we have completely specified which position we want: the one that corresponds to the first of @item's catalogs. </p>\n\n<p>The only way I've found to get this is:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n      has_many :catalog_items\n      has_many :catalogs, :through =&gt; :catalog_items, :select =&gt; \"catalogue_items.position, catalogs.*\"\nend\n</code></pre>\n\n<p>Now I can do Item.catalogs.first.position. However, this seems like a bit of a hack - I'm adding an extra attribute onto a Catalog instance. It also opens up the possibility of trying to use a view in two different situations where I populate @catalogs with a Catalog.find or with a @item.catalogs. In one case, the position will be there, and in the other, it won't. </p>\n\n<p>Does anyone have a good solution to this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby","sinatra","docx","pandoc"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13277168,"title":"How can I directly use pandoc to generate docx files within a Sinatra app?","body":"<p>I have a Sinatra app which needs to provide downloadable reports in Microsoft Word format.  My approach to generating the reports is to generate the content using ERB, and then convert the resulting HTML into docx.  <a href=\"http://johnmacfarlane.net/pandoc/\" rel=\"nofollow\">Pandoc</a> seems to be the best tool for accomplishing this, but my implementation involves generating some temporary files which feels kludgy.</p>\n\n<p><em><strong>Is there a more direct way to generate the docx file and send it to the user?</em></strong>  </p>\n\n<p>I know that <a href=\"https://github.com/alphabetum/pandoc-ruby\" rel=\"nofollow\">PandocRuby</a> exists, but I couldn't quite get it working for my purposes.  Here is an example of my current implementation: </p>\n\n<pre><code>  #setting up the docx mime type    \n   configure do\n      mime_type :docx, 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n  end\n\n  # route to generate the report\n  get '/report/:name' do\n    content_type :docx\n\n    input = erb :report, :layout=&gt;false #get the HTML content for the input file\n    now = Time.now.to_i.to_s #create a unique file name\n    input_path = File.join('tmp', now+'.txt')\n    f = File.new(input_path, \"w+\") \n    f.write(input.to_s) #write HTML to the input to the file\n    f.close()\n\n    output_path = File.join('tmp', now+'.docx') # create a unique output file\n    system \"pandoc -f html -t docx -o #{output_path} #{input_path}\" # convert the input file to docs\n    send_file output_path\n  end\n</code></pre>\n"},{"tags":["ruby","xml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13274901,"title":"Getting the value of duplicate nodes in XML?","body":"<p>How can I get the values of two nodes if they have the same name, using LibXML for Ruby, or any other Ruby library? I have this XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;test&gt;\n  &lt;test1&gt;\n    &lt;foo&gt;534569&lt;/foo&gt;\n  &lt;/test1&gt;\n  &lt;test1&gt;\n    &lt;foo&gt;534570&lt;/foo&gt;\n  &lt;/test1&gt;\n&lt;/test&gt;\n</code></pre>\n\n<p>I want both values of <code>foo</code>.</p>\n"},{"tags":["css","ruby","watir"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13276302,"title":"Cannot click submit button if form information is inputted","body":"<p>I am using Ruby and Watir, trying to automate a page to click on a submit button after filling out the form.</p>\n\n<p>This is the HTML code for the button.</p>\n\n<pre><code>&lt;div class=\"btns_wr\"&gt;\n&lt;span class=\"small_green_btn input\" title=\"Submit\"&gt;\n&lt;span class=\"link_left\"&gt;&lt;/span&gt;\n&lt;span class=\"link_middle\"&gt;\n&lt;input id=\"submitEnrollmentCmdButtonId\" type=\"submit\" value=\"SUBMIT\"     name=\"submitEnrollmentCmdButtonId\"&gt;\n&lt;/span&gt;\n&lt;span class=\"link_right\"&gt;&lt;/span&gt;\n&lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have tried multiple variations of class, text, titles etc but it will click the button if I do not fill thr form fields out but when I do fill the form fields out it does not click the button but errors on the very next step of course because the expected result is false.</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>browser.span(:class =&gt; 'link_middle').button(:id =&gt; 'submitEnrollmentCmdButtonId').click\nbrowser.span(:class =&gt; 'link_middle').button(:title =&gt; 'Submit').click\n</code></pre>\n\n<p>With this, at least I got an error message:</p>\n\n<blockquote>\n  <p>Unable to locate element, using {:tag_name=>\"button\", :id=>\"submitEnrollmentCmdButtonId\"}</p>\n</blockquote>\n\n<pre><code>browser.span(:class =&gt; 'link_middle').span(:title =&gt; 'Submit').click\n</code></pre>\n\n<blockquote>\n  <p>Unable to locate element, using {:tag_name=>\"span\", :title => \"Submit\"}</p>\n</blockquote>\n\n<p>I am using Firefox; also this form page is opened after I click a button on a page, and this new browser window opens.</p>\n"},{"tags":["ruby","textmate","textmatebundles","textmate2"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13269541,"title":"TextMate's Execute and Update ‘# =>’ Markers evaluates with ruby 1.8 instead of 1.9","body":"<p>In TextMate 2, Execute and Update ‘# =>’ Markers menu action updates the markers in the following code as if I am running ruby 1.8 even though my TM_RUBY environment variable is set to ~/.rvm/rubies/ruby-1.9.3-p286/bin/ruby:</p>\n\n<pre><code>v = RUBY_VERSION # =&gt; \"1.8.7\"\nputs \"\".singleton_class\nputs v\n# ~&gt; -:2: undefined method `singleton_class' for \"\":String (NoMethodError)\n</code></pre>\n\n<p>Running the same code in TextMate 2, on the other hand, returns the expected command output:</p>\n\n<pre><code>#&lt;Class:#&lt;String:0x007fcf418941b8&gt;&gt;\n1.9.3\n</code></pre>\n\n<p>This is a wonderful feature and it would be a real shame if it is limited to ruby 1.8. I suspect, however, that this may be peculiar to my setup (I have actually seen it work with 1.9 code here: <a href=\"http://ruby-kickstart.com/\" rel=\"nofollow\">http://ruby-kickstart.com/</a>). Execute and Update ‘# =>’ Markers menu action is defined in the Ruby bundle where it calls xmpfilter from rcodetools:</p>\n\n<pre><code>#!/usr/bin/env bash\n\n[[ -f \"${TM_SUPPORT_PATH}/lib/bash_init.sh\" ]] &amp;&amp; . \"${TM_SUPPORT_PATH}/lib/bash_init.sh\"\n\nexport RUBYLIB=\"$TM_BUNDLE_SUPPORT/vendor/rcodetools/lib${RUBYLIB:+:$RUBYLIB}\"\nexport TM_RUBY=$(which \"${TM_RUBY:-ruby}\")\n\n\"${TM_RUBY}\" -r \"${TM_SUPPORT_PATH}/lib/ruby1.9/add_1.8_features.rb\" -- \"$TM_BUNDLE_SUPPORT/vendor/rcodetools/bin/xmpfilter\"\n</code></pre>\n\n<p>The file add_1.8_features.rb only adds a few legacy methods to the String and File classes (e.g. grep and remove). Indeed, this enables it to support ruby 1.9 (see <a href=\"https://github.com/textmate/ruby.tmbundle/blob/master/Support/vendor/rcodetools/CHANGES\" rel=\"nofollow\">https://github.com/textmate/ruby.tmbundle/blob/master/Support/vendor/rcodetools/CHANGES</a>).</p>\n\n<p>At this point I am not even quite sure where does ruby 1.8 come from in the first place. Even passing the explicit path to the latest ruby instead of \"${TM_RUBY}\" in the last line above does not change the output.</p>\n\n<p>I would be very grateful for any help that would allow me to use this (or equivalent) menu action in TextMate.</p>\n"},{"tags":["ruby-on-rails","ruby","flex","push"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":12146188,"title":"What's the preferred way of using Rails and Flex?","body":"<p>I'd like to create a service, similar to a chat application (realtime app). </p>\n\n<p>From what I can see from my research, <code>BlazeDS</code> is the preferred way, but it involves Java and Java EE. Also, the latest Ruby results seem to be from 2009-2010, so they are likely outdated.</p>\n\n<p>Are there any actively maintained Ruby/Rails solutions for integrating push notifications with Flex?</p>\n"},{"tags":["ruby","exception","dropbox","conditional-statements","rufus-scheduler"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13276453,"title":"Rufus Scheduler - Catch exception and perform conditional statement","body":"<p>I have the a rufus scheduler which executes a request to Dropbox to check if the access key and secret are authorised every 10 minutes.</p>\n\n<p>If it is unauthorised, the following exception is reported:</p>\n\n<pre><code>DropboxAuthError in GalleryController#index\n\n#&lt;Net::HTTPUnauthorized:0x7ef04c8&gt;\n</code></pre>\n\n<p>The code I have in my scheduler to detect this is from the rufus-scheduler documentation:</p>\n\n<pre><code>def scheduler.on_exception(job, exception)\n  puts \"job #{job.job_id} caught exception '#{exception}'\"\nend\n</code></pre>\n\n<p>Because I am only wanting to catch that exception above, I want to be able to perform a conditional statement which compares the exception with a value, something like:</p>\n\n<pre><code> def scheduler.on_exception(job, exception)\n  if exception == \"DropboxAuthError\"\n    puts \"job #{job.job_id} caught exception '#{exception}'\"\n  end\n end\n</code></pre>\n\n<p>But because the exception is an object, I cannot do that comparison.</p>\n\n<p>Has anyone got any idea's how I can do this?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["ruby","amazon-web-services","amazon-route53"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13255118,"title":"Getting error \"The security token included in the request is invalid\" when using AWS ruby sdk","body":"<p>I'm getting this error <strong>\"The security token included in the request is invalid\"</strong> when trying to get hosted zones list from Route53 using AWS Ruby SDK, eventhough I'm running my script from instance having \"full privileges\" IAM role. \nHere is the full trace :</p>\n\n<pre><code>/usr/lib/ruby/gems/1.8/gems/aws-sdk-1.6.9/lib/aws/core/client.rb:318:in `return_or_raise': The security token included in the request is invalid (AWS::Route53::Errors::InvalidClientTokenId)\n  from /usr/lib/ruby/gems/1.8/gems/aws-sdk-1.6.9/lib/aws/core/client.rb:419:in `client_request'\n  from (eval):3:in `list_hosted_zones'\n  from test.rb:7\n</code></pre>\n\n<p>And the test.rb file :</p>\n\n<pre><code>require 'rubygems'\nrequire 'aws-sdk'\n\nAWS.config()\n\nr53 = AWS::Route53.new\nresp = r53.client.list_hosted_zones\nresp[:hosted_zones].each do |zone|\n  puts zone\nend\n</code></pre>\n\n<p>It seems that the issue is related to Route53 sdk methods, because I've tested with another code to manage EC2 and Elastic Load Balancers with same SDK and it's working just fine.</p>\n\n<p>What do you think ? Did I missed something ? Thank you !</p>\n"},{"tags":["ruby","string","io","buffer"],"answer_count":5,"favorite_count":3,"up_vote_count":22,"down_vote_count":1,"view_count":8383,"score":21,"question_id":10323,"title":"Why doesn't Ruby have a real StringBuffer or StringIO?","body":"<p>I recently read a nice <a href=\"http://macdevelopertips.com/ruby/using-a-string-as-a-file-in-ruby.html\">post</a> on using <code>StringIO</code> in Ruby.  What the author doesn't mention, though, is that <code>StringIO</code> is just an \"I.\"  There's no \"O.\"  You <em>can't</em> do this, for example:</p>\n\n<pre><code>s = StringIO.new\ns &lt;&lt; 'foo'\ns &lt;&lt; 'bar'\ns.to_s\n# =&gt; should be \"foo\\nbar\"\n# =&gt; really is ''`\n</code></pre>\n\n<p>Ruby really needs a StringBuffer just like the one Java has. StringBuffers serve two important purposes. First, they let you test the output half of what Ruby's StringIO does. Second, they are useful for building up long strings from small parts -- something that Joel reminds us over and over again is otherwise very very slow.</p>\n\n<p>Is there a good replacement?</p>\n\n<p>@Mike Stone</p>\n\n<p>It's true that Strings in Ruby are mutable, but that doesn't mean we should always rely on that functionality.  If <code>stuff</code> is large, the performance and memory requirements of this, for example, is really bad.</p>\n\n<pre><code>result = stuff.map(&amp;:to_s).join(' ')\n</code></pre>\n\n<p>The \"correct\" way to do this in Java is:</p>\n\n<pre><code>result = StringBuffer.new(\"\")\nfor(String s : stuff) {\n  result.append(s);\n}\n</code></pre>\n\n<p>Though my Java is a bit rusty.</p>\n\n<p>@Mike Stone #2:\nWhoah!!!!! How did I miss that in the API?  I'm still not sure of the performance of StringIO, but at least it's now \"Ruby's\" problem, not mine :)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13275821,"title":"Override attributes keys in FactoryGirl","body":"<p>I have a model <code>Post</code> with an attribute <code>published_at</code>.\nHowever, in POST request API requires it to be assigned as <code>published</code>, not <code>published_at</code>.\nSo in my model I override setter method like so</p>\n\n<pre><code>def published=(value)\n  self.published_at = value\nend\n</code></pre>\n\n<p>The problem is, in my API tests, I use FactoryGirl's <code>attributes_for(:post)</code> method to generate attributes for POST request, and it uses old <code>published_at</code> name. How can I workaround this problem and generate attributes with <code>published</code> key instead of <code>published_at</code> without changing the name of this attribute in my model?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":202,"score":1,"question_id":11897269,"title":"Get own IP address","body":"<p>How to get my own IP address with Rails?</p>\n\n<p>When I do it like this I got: <code>127.0.0.1</code></p>\n\n<pre><code>@ip = request.remote_ip\n</code></pre>\n\n<p>Is there any way to get the Public IP?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13274708,"title":"How to format multiline RSpec expect {}.to change","body":"<p>Is there a better way to format this test to make it more readable?</p>\n\n<pre><code>expect { \n  within '.foo' do\n    click_link 'Delete'\n  end\n}.to change {Foo.count}.by 1\n</code></pre>\n\n<p>expect <code>do...end</code> works, but is even uglier...</p>\n"},{"tags":["ruby","deployment","capistrano","heroku","uptime"],"answer_count":6,"favorite_count":7,"up_vote_count":19,"down_vote_count":0,"view_count":3382,"score":19,"question_id":2560845,"title":"Hot deploy on Heroku with no downtime","body":"<p>A bad side of pushing to Heroku is that I must push the code (and the server restarts automatically) before running my db migrations.</p>\n\n<p>This can obviously cause some 500 errors on users navigating the website having the new code without the new tables/attributes: the solution proposed by Heroku is to use the maintenance mode, but I want a way with no downside letting my webapp running everytime!</p>\n\n<p>Is there a way? For example with Capistrano: </p>\n\n<ul>\n<li>I prepare the code to deploy in a new dir</li>\n<li>I run (backward) migrations and the old code continue to work perfectly</li>\n<li>I swith mongrel instance to the new dir and restart the server</li>\n</ul>\n\n<p>...and I have no downtime!</p>\n"},{"tags":["ruby","sinatra","haml","padrino"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":102,"score":-2,"question_id":12486892,"title":"HAML runs inline Ruby, but does not render anything","body":"<pre><code>-#encoding: utf-8\n:css\n .hidden{display:none;}\n%script{:src=&gt;\"/javascripts/jquery.js\"}\n%form{:action=&gt;\"https://get724.ccvb.com.tr/Get724/get724uye.aspx\",:method=&gt;\"post\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"uyeno\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"kkno\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"gectar\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"tutar\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"dcins\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"sipbil\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"sesbil\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"burl\",:value=&gt;\"\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"hurl\",:value=&gt;\"\"}\n - t = Time.now.strftime(\"%Y%m%d%H%M%S\")\n - puts t\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"zaman\",:value=&gt;\"#{t}\"}\n -puts \"adfasdf : \" + @asdf.to_s\n -puts \"asdf\"\n -puts \"asdf : \" + @asdf.to_s\n -puts session[:ewer]\n -puts session[:zxcv]\n -puts strtodigest\n -digest = Digest::SHA1.base64digest(strtodigest)\n -puts digest\n -#%input{:type=&gt;\"text\",:value=&gt;\"#{strtodigest}\"}\n -#%input{:type=&gt;\"text\",:value=&gt;\"#{digest}\"}\n %input.hidden{:type=&gt;\"text\",:name=&gt;\"ozet\",:value=&gt;\"#{digest}\"}\n:javascript\n  $('form').submit();\n-puts \"End Of Haml\"\n</code></pre>\n\n<p>I have a haml like above and i am using it in a Sinatra application. When i run my app</p>\n\n<pre><code>haml :problem_haml\n</code></pre>\n\n<p>Every single ruby command works perfectly, but haml does not render anything. Not even a single line, yet every ruby command starts with \"-\" works absolutely perfect? What could be the cause?\nPlease do not answer \"because hidden class hides everything\", it is not about css hiding, literally not even a single byte returns from server.</p>\n\n<p>Edit:</p>\n\n<p>I said the application is a sinatra application before, but it is actually a Padrino application. While padrino is only a few sinatra applications that run inside a main sinatra application and more people knows sinatra, i said sinatra to make the question simpler.</p>\n\n<p>Also here is the code that calls haml,</p>\n\n<pre><code>def get3DSecure(ccname,price,skul,ccno,cvc)\n    puts \"#############################################\"\n    puts \"get3DSecure function called\"\n    puts \"#############################################\"\n    @ccname = ccname\n    @price = price.to_s + \"00\"\n    @skul = skul\n    @ccno = ccno\n    @cvc = cvc\n    session[:name] = ccname\n    session[:xmltosend] = makeXmlFor3D\n    session[:sipbil] = UUIDTools::UUID.random_create.to_s.delete!(\"-\")\n    session[:sesbil] = UUIDTools::UUID.random_create.to_s.delete!(\"-\")\n    session[:skul] = skul\n    session[:price] = price\n    session[:ccno] = ccno\n    session[:cvc] = cvc\n    puts \"#############################################\"\n    puts \"get3DSecure function near end, render starts\"\n    puts \"#############################################\"\n    render :adsecure,:layout=&gt;:main\n  end\n</code></pre>\n\n<p>It also writes the puts commands to console without any problems.</p>\n"},{"tags":["ruby-on-rails","ruby","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":11686641,"title":"sort by association field in sunspot","body":"<p>In my app I am using Sunspot for a fulltext search. The problem is that I want to have sorting by association model field. In my case:</p>\n\n<pre><code>class Movie &lt; ActiveRecord::Base\n  attr_accessible :description, :genre, :name\n  has_many :premieres\nend\n</code></pre>\n\n<p>and my <code>Premier</code> model has:</p>\n\n<pre><code>belongs_to :movie\n</code></pre>\n\n<p>Searching by movie name is done by defining the method:</p>\n\n<pre><code>def movie_name\n  movie.name\nend\n</code></pre>\n\n<p>but when I try to do:</p>\n\n<pre><code>order_by :movie_name, :asc\n</code></pre>\n\n<p>It says:</p>\n\n<blockquote>\n  <p>No field configured for Premiere with name 'movie_name'</p>\n</blockquote>\n\n<p>How do I make this sorting available?</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":524,"score":1,"question_id":7960812,"title":"\"undefined method 'groups' for Rails:Module\" when running \"rails generate rspec:install\" on Mac","body":"<pre><code>$ rails generate rspec:install\n\n/Users/AlbertoRDZ/Desktop/rails_projects/sample_app/config/application.rb:7:in `&lt;top (required)&gt;': undefined method `groups' for Rails:Module (NoMethodError)\n    from /Users/AlbertoRDZ/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.9/lib/rails/commands.rb:15:in `require'\n    from /Users/AlbertoRDZ/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.9/lib/rails/commands.rb:15:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1346,"score":3,"question_id":283185,"title":"Retrieving client system information from a Rails application","body":"<p>Is it possible to retrieve the CPUID and MAC address of a client machine from a Ruby on Rails application?. Are there any plugins available for this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pusher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13267972,"title":"How do I include the users in the result set?","body":"<pre><code>comments = Song.find(65).comments.select('comments.*, users.*').includes(:user).limit(20) \n</code></pre>\n\n<p>How would I include the users in the result set?</p>\n\n<p>Im using the <a href=\"http://pusher.com/\" rel=\"nofollow\">PusherApp</a> and trying to do:</p>\n\n<pre><code>    Pusher[\"foo\"].trigger(\"bar\", { \n      :comments =&gt; comments\n    })\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","design","frameworks","controllers"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13274295,"title":"Rails: Single page website, How to organise controllers/views etc","body":"<p>I have a single page website using ruby on rails as the framework.\nOn the single page I have a </p>\n\n<p>header</p>\n\n<p>section 1</p>\n\n<p>section 2</p>\n\n<p>section 3 etc</p>\n\n<p>footer</p>\n\n<p>The problem I am having is this, how do I organise the layouts/views/controllers.\nOnly in one section I have a form which needs processing and is linked to a database table (model). Can anyone advise me on how I can organise my ROR application?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":34,"score":1,"question_id":13270672,"title":"Parse original email address of the sender of a forwarded email in Ruby","body":"<p>Let's say that below is a sample content of emails I am receiving.</p>\n\n<pre><code> ---------- Forwarded message ----------\n From: Original Sender &lt;original.sender@gmail.com&gt;\n Date: 2012/10/23\n Subject: Lorem Ipsum\n To: recipient@example.com\n</code></pre>\n"},{"tags":["ruby","rspec","rvm","osx-lion"],"answer_count":1,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":650,"score":9,"question_id":6875588,"title":"Problem installing rspec-1.3.2 on Lion using RVM and ruby 1.8.6","body":"<p>I'm trying to install rspec version 1.3.2 on OS X Lion using RVM and Ruby 1.8.6</p>\n\n<p>When I install, I get the following:</p>\n\n<pre><code>$ gem install rspec -v=1.3.2\nAbort trap: 6\n</code></pre>\n\n<p>I'm able to successfully install the same rspec version using the system ruby. I've tried to do some research into the problem, but it doesn't look like anybody has run into the same thing. Similar questions have suggested <code>export CC=gcc-4.2</code> before installing ruby. I tried that (after completely blowing away RVM and reinstalling the latest version, 1.6.31 right now) but it had no effect.</p>\n\n<p>Has anyone else else encountered this? Have you found a solution?</p>\n"},{"tags":["ruby","memory-management"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":62,"score":7,"question_id":13059552,"title":"Class#allocate and its uses","body":"<p>After having read <a href=\"http://www.seejohncode.com/2012/03/16/ruby-class-allocate/\">http://www.seejohncode.com/2012/03/16/ruby-class-allocate/</a> and looking more into the allocate method: <a href=\"http://www.ruby-doc.org/core-1.9.3/Class.html#method-i-allocate\">http://www.ruby-doc.org/core-1.9.3/Class.html#method-i-allocate</a> I became very curious.</p>\n\n<p>Ruby was built in a way that we did not have to manually allocate or free space for/with objects, but we are given the ability to do so. Why?</p>\n\n<p>What are the uses in Ruby of allocating Objects manually? The article I read showed a custom initialize method, but are the uses of it so limited?</p>\n"},{"tags":["ruby-on-rails","ruby","erb"],"answer_count":6,"favorite_count":1,"up_vote_count":15,"down_vote_count":0,"view_count":1141,"score":15,"question_id":4284421,"title":"What is the meaning of erb?","body":"<p>Why is the view of Rails application in the format <code>*.erb.html</code>? What does \"erb\" mean?</p>\n"},{"tags":["ruby","dll"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13272971,"title":"How can I \"natively\" use a DLL from Ruby","body":"<p>What is the easiest way to use a custom DLL from within Ruby ? </p>\n\n<p>In Python I would use <em>ctypes</em>, just as described as in this <a href=\"http://stackoverflow.com/a/3173926/740316\">example</a>. But now how should I do it in Ruby, preferably using native functionalities over third party libs ? Is there any way Ruby can be as simple as Python for manipulating a DLL ? </p>\n\n<p>Thank you o/</p>\n"},{"tags":["ruby","ruby-1.9.3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":13273773,"title":"Ruby 1.9.3 Teeny Version","body":"<p>When using RBConfig to determine my ruby version, I get the \"wrong\" teeny version when using ruby 1.9.3:</p>\n\n<pre><code># ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [i686-linux]\n# ruby -rrbconfig -e 'puts RbConfig::CONFIG.fetch(%q(MAJOR))'\n1\n# ruby -rrbconfig -e 'puts RbConfig::CONFIG.fetch(%q(MINOR))'\n9\n# ruby -rrbconfig -e 'puts RbConfig::CONFIG.fetch(%q(TEENY))'\n1\n</code></pre>\n\n<p>Using Ruby 1.8.7 - this works fine:</p>\n\n<pre><code>$ ruby -v\nruby 1.8.7 (2012-06-29 patchlevel 370) [x86_64-linux]\n$ ruby -rrbconfig -e 'puts Config::CONFIG.fetch(%q(MAJOR))'\n1\n$ ruby -rrbconfig -e 'puts Config::CONFIG.fetch(%q(MINOR))'\n8\n$ ruby -rrbconfig -e 'puts Config::CONFIG.fetch(%q(TEENY))'\n7\n</code></pre>\n\n<p>I know I can get patchlevel and use that a bit, but why is ruby 1.9.3 returning 1 as its teeny version?</p>\n"},{"tags":["ruby","arrays","hash","unique"],"answer_count":7,"favorite_count":3,"up_vote_count":16,"down_vote_count":0,"view_count":11918,"score":16,"question_id":181091,"title":"How do I get the unique elements from an array of hashes in Ruby?","body":"<p>I have an array of hashes, and I want the unique values out of it.  Calling <code>Array.uniq</code> doesn't give me what I expect.</p>\n\n<pre><code>a = [{:a =&gt; 1},{:a =&gt; 2}, {:a =&gt; 1}]\na.uniq # =&gt; [{:a =&gt; 1}, {:a =&gt; 2}, {:a =&gt; 1}]\n</code></pre>\n\n<p>Where I expected:</p>\n\n<pre><code>[{:a =&gt; 1}, {:a =&gt; 2}]\n</code></pre>\n\n<p>In searching around on the net, I didn't come up with a solution that I was happy with.  Folks recommended redefining <code>Hash.eql?</code> and <code>Hash.hash</code>, since that is what <code>Array.uniq</code> is querying.</p>\n\n<p>Edit:\nWhere I ran into this in the real world, the hashes were slightly more complex.  They were the result of parsed JSON that had multiple fields, some of which the values were hashes as well.  I had an array of those results that I wanted to filter out the unique values.</p>\n\n<p>I don't like the redefine <code>Hash.eql?</code> and <code>Hash.hash</code> solution, because I would either have to redefine <code>Hash</code> globally, or redefine it for each entry in my array. Changing the definition of <code>Hash</code> for each entry would be cumbersome, especially since there may be nested hashes inside of each entry.</p>\n\n<p>Changing <code>Hash</code> globally has some potential, especially if it were done temporarily. I'd want to build another class or helper function that wrapped saving off the old definitions, and restoring them, but I think this adds more complexity than is really needed.</p>\n\n<p>Using <code>inject</code> seems like a good alternative to redefining <code>Hash</code>.</p>\n"},{"tags":["ruby-on-rails","ruby","joosy"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13264394,"title":"Joosy tutorial ActionView::Template::Error","body":"<p>I was going through the <a href=\"http://guides.joosy.ws/guides/blog/rails-preparations.html\" rel=\"nofollow\">Joosy Guide</a> but at the end of \"Rails Preparation\" section instead of the landing page, I get the following error:</p>\n\n<pre><code>ActionView::Template::Error (Mixin grid-core-span is missing argument $gridColumnWidth.\n  (in /Users/scribe/Code/joosy-blog/app/assets/stylesheets/application.css.scss)):\n    10:       };\n    11:     &lt;/script&gt;\n    12: \n    13:     &lt;%= stylesheet_link_tag 'application' %&gt;\n    14:     &lt;%= csrf_meta_tags %&gt;\n    15:   &lt;/head&gt;\n    16: \n  app/assets/stylesheets/application.css.scss:1\n  app/views/layouts/blog.html.erb:13:in `_app_views_layouts_blog_html_erb___1369399347943123030_70192156915780'\n  app/controllers/blog_controller.rb:5:in `index'\n</code></pre>\n\n<p>As far as I can tell I my project matches the instructions, any ideas as to what I messed up?</p>\n"},{"tags":["ruby","xml","nokogiri","sax","large-files"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":357,"score":2,"question_id":9199859,"title":"Parsing large file with SaxMachine seems to be loading the whole file into memory","body":"<p>I have a 1.6gb xml file, and when I parse it with Sax Machine it does not seem to be streaming or eating the file in chunks - rather it appears to be loading the whole file into memory (or maybe there is a memory leak somewhere?) because my ruby process climbs upwards of 2.5gb of ram. I don't know where it stops growing because I ran out of memory.</p>\n\n<p>On a smaller file (50mb) it also appears to be loading the whole file. My task iterates over the records in the xml file and saves each record to a database. It takes about 30 seconds of \"idling\" and then all of a sudden the database queries start executing.</p>\n\n<p>I thought SAX was supposed to allow you to work with large files like this without loading the whole thing in memory.</p>\n\n<p>Is there something I am overlooking?</p>\n\n<p>Many thanks</p>\n\n<p><strong>Update to add code sample</strong></p>\n\n<pre><code>class FeedImporter\n\n  class FeedListing\n    include ::SAXMachine\n\n    element :id\n    element :title\n    element :description\n    element :url\n\n    def to_hash\n      {}.tap do |hash|\n        self.class.column_names.each do |key|\n          hash[key] = send(key)\n        end\n      end\n    end\n  end\n\n  class Feed\n    include ::SAXMachine\n    elements :listing, :as =&gt; :listings, :class =&gt; FeedListing\n  end\n\n  def perform\n    open('~/feeds/large_feed.xml') do |file|\n\n      # I think that SAXMachine is trying to load All of the listing elements into this one ruby object.\n      puts 'Parsing'\n      feed = Feed.parse(file)\n\n      # We are now iterating over each of the listing elements, but they have been \"parsed\" from the feed already.\n      puts 'Importing'\n      feed.listings.each do |listing|\n        Listing.import(listing.to_hash)\n      end\n\n    end\n  end\n\nend\n</code></pre>\n\n<p>As you can see, I don't care about the <code>&lt;listings&gt;</code> element in the feed. I just want the attributes of each <code>&lt;listing&gt;</code> element.</p>\n\n<p>The output looks like this:</p>\n\n<pre><code>Parsing\n... wait forever\nImporting (actually, I don't ever see this on the big file (1.6gb) because too much memory is used :(\n</code></pre>\n"},{"tags":["ruby","libxml2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13268489,"title":"Any string to XML in Ruby","body":"<p>I am trying to convert a random string (which is build in XML format) in to an xml, so I can apply the \"to_hash\" function to it.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>model = live_requests[3]\nparser = XML::Parser.string(model)\nmodel_xml = parser.parse\n\nputs model.to_hash\n</code></pre>\n\n<p>Now why am I getting an error when 'model_xml' should be an XML file?</p>\n\n<p>I am using LibXML by the way.\n<a href=\"http://libxml.rubyforge.org/rdoc/index.html\" rel=\"nofollow\">http://libxml.rubyforge.org/rdoc/index.html</a></p>\n"},{"tags":["ruby","amazon-web-services","elastic-beanstalk"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":19,"score":-2,"question_id":13273821,"title":"Anyone aware of AWS Elastic Bean Stalk support for native ruby?","body":"<p>any examples that I can try out ?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","command-line","rake"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":315,"score":0,"question_id":9586152,"title":"System command fails constantly with exit code 127","body":"<p>I have 2 methods within a rake script, both of which use <code>system \"&lt;SomeCommand&gt;\"</code>, one is for calling JSLint with a file, which works fine. One is for calling YUICompressor, which always fails with a 127 error code.</p>\n\n<p>The strange thing is I can call the EXACT command the ruby script is running and it works fine, I pass it a file, and it outputs a minified version. However when I run it thought the ruby script it always bombs...</p>\n\n<p>It basically looks like this:</p>\n\n<p><code>system java -jar c:/dump/tools/yuicompressor-2.7.4.jar c:/dump/src/input_file.js c:/dump/src/output_file.min.js</code></p>\n\n<p>I know it looks horrible with all the absolute paths but thats how the build script currently works off absolute paths, but that command works fine if I just invoke it on the command line, however when I run it through Rake/Ruby it just bombs... but the other system call to JSLint works fine, that however calls a batch file via an absolute path... </p>\n\n<p>Cannot find any information on this online, anyone see anything odd in the above?</p>\n\n<p>Just to confirm all the files exist in the relevant positions.</p>\n"},{"tags":["c#","ruby","mono","port"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":13246099,"title":"Using C# to reference a port number to service name","body":"<p>On Linux using MONO.</p>\n\n<p>How do I use C# to pair a port number to a service ? </p>\n\n<p>example:</p>\n\n<pre><code>port 80 = http\nport 443 = https\n</code></pre>\n\n<p>and output it to the console, I need this for a simple port scanner I built.</p>\n\n<p>I know this function exists in ruby:</p>\n\n<pre><code>Socket.getservbyport(80, \"tcp\")\n</code></pre>\n"},{"tags":["ruby","hash","hash-of-hashes"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13259181,"title":"What is the most ruby-ish way of accessing nested hash values at arbitrary depths?","body":"<p>Given a hash such as:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>AppConfig = {\n  'service' =&gt; {\n    'key' =&gt; 'abcdefg',\n    'secret' =&gt; 'secret_abcdefg'\n  },\n  'other' =&gt; {\n    'service' =&gt; {\n      'key' =&gt; 'cred_abcdefg',\n      'secret' =&gt; 'cred_secret_abcdefg'\n    }\n  }\n}\n</code></pre>\n\n<p>I need a function to return service/key in some cases and other/service/key in other cases.  A straightforward way is to pass in the hash and an array of keys, like so:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def val_for(hash, array_of_key_names)\n  h = hash\n  array_of_key_names.each { |k| h = h[k] }\n  h\nend\n</code></pre>\n\n<p>So that this call results in 'cred_secret_abcdefg':</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>val_for(AppConfig, %w[other service secret])\n</code></pre>\n\n<p>It seems like there should be a better way than what I've written in val_for().</p>\n"},{"tags":["ruby","unicode","encoding","utf-8"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13273084,"title":"What is the correct utf-8 encoding comment line for ruby?","body":"<p>I'm using UTF-8 all the way and want to help the ruby interpreter to read my files.\nTherefore I put <code># encoding=utf-8</code> at the start of my ruby code like this:</p>\n\n<pre><code>#!/usr/bin/env ruby\n# encoding=utf-8\n</code></pre>\n\n<p>But now and then, I see other variants:\n<code>bundle gem NAME</code> inserts <code># -*- encoding: utf-8 -*-</code> (into NAME.gemspec). The gem <a href=\"https://github.com/m-ryan/magic_encoding\" rel=\"nofollow\">magic_encoding</a> uses this line, too.</p>\n\n<p>What is the recommended way?</p>\n\n<ul>\n<li><code># encoding = utf-8</code></li>\n<li><code># encoding: utf-8</code></li>\n<li><code># -*- encoding: utf-8 -*-</code></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13230787,"title":"make variable available in all method of controller when passed in one method","body":"<p>Here i send the user.id as params dd</p>\n\n<pre><code>&lt;h3&gt;&lt;%= link_to(\"Lend Asset\", {:controller =&gt; 'empassets', :action=&gt; 'index', :dd =&gt; user.id})%&gt;&lt;/h3&gt;\n</code></pre>\n\n<p>In controller empassets i fetch it by </p>\n\n<pre><code>  def index\n     @id = params[:dd]\n     @empassets = Empasset.where(:ad =&gt; @id)\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @empassets }\n    end\n  end\n\n  def show\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def new\n     @id = params[:dd]\n    @empasset = Empasset.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def edit\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n  end\n</code></pre>\n\n<p>I need this @id in all new show edit method. But it takes in index only as i mention it in index. How can i make such that if Lend asset is click then @id= params[:id] have value in all methods. How can it is possible to make it available for another @id = params[:id] is not send in that controller?</p>\n"},{"tags":["ruby","irb","pry"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":11,"score":0,"question_id":13272933,"title":"how do I set the external encoding for pry","body":"<p>IRB has the -E flag for setting the external encoding but it doesn't work in pry:</p>\n\n<blockquote>\n  <p>/usr/local/lib/ruby/gems/1.9.1/gems/pry-0.9.10/lib/pry/repl_file_loader.rb:16:in\n  `initialize': No such file: /Volumes/fb1 store/fb1 10.5\n  user/Users/rashid/Ruby_Dev/MDBlib/src/MDB/-Eutf-8 (RuntimeError)</p>\n</blockquote>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby","mongodb","gem","sinatra"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13271365,"title":"MongoId - uninitialized constant App::Mongo (NameError)\"","body":"<p>In Sinatra app I have</p>\n\n<pre><code> #config.rb\n  require 'mongoid'\n\n  class App\n    configure do \n        Mongoid.configure do |config|\n          name = \"my_db\"\n          host = \"localhost\"\n          config.master = Mongo::Connection.new.db(name)\n          config.slaves = [Mongo::Connection.new(host, 27017, :slave_ok =&gt; true).db(name)]\n          config.persist_in_safe_mode = false\n        end\n      end\n    end\n\n    #Gemfile\n    gem \"mongoid\", \"~&gt; 3.0.0\"\n    gem \"bson_ext\"\n</code></pre>\n\n<p>and it gives me an error \"`const_missing': uninitialized constant App::Mongo (NameError)\"\nHow do I fix it?</p>\n"},{"tags":["ruby","activerecord","linked-list"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13272833,"title":"Linked list in Ruby","body":"<p>I have <code>Parent</code> and <code>Child</code> models. Parent <code>has_many :children</code>, which should be saved in database in correct order. I decided to save it like a linked list with field <code>next_id</code>. I know, that there is <code>acts_as_list</code> gem, but it saves <code>position</code> field. Isn't it more sql-heavy solution?</p>\n\n<p>Nevertheless, have you any ideas how can I architect it? I want to save <a href=\"http://en.wikipedia.org/wiki/Single_responsibility_principle\" rel=\"nofollow\">SRP</a>, so all manipulations with list should be in <code>Child</code> model. <code>Parent</code> should get already ordered <code>children</code>.</p>\n"},{"tags":["ruby-on-rails","ruby","rvm","redmine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13273014,"title":"How to use custom ruby and rails for different applications?","body":"<p>I am using Ubuntu 12.04. </p>\n\n<p>I also have ruby and rails installed on my system using the <strong>rvm</strong>. This is a custom installation and not the ubuntu package.</p>\n\n<p>I want to install Redmine on my system. However, when I install it using</p>\n\n<pre><code>aptitude install redmine redmine-mysql\n</code></pre>\n\n<p>it does not find ruby or rails as it is not installed via <code>aptitude</code>. Is it possible to make Redmine use my custom installation and not install the default ruby/rails.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270656,"title":"Mailbox not sending e-mails: wrong number of arguments (1 for 0)","body":"<p>When sending a message I can see this in my console:</p>\n\n<pre><code>Sent mail to You should add method :mail_email in your Messageable model (2093ms\n)\nDate: Wed, 07 Nov 2012 14:08:50 +0100\nFrom: mail@myemail.com\nto: You should add method :mail_email in your Messageable model\n</code></pre>\n\n<p>And the initializers for the Mailbox gem:</p>\n\n<pre><code>Mailboxer.setup do |config|\n\n  #Configures if you applications uses or no the email sending for Notifications and Messages\n  config.uses_emails = true\n\n  #Configures the default from for the email sent for Messages and Notifications of Mailboxer\n  config.default_from = \"mail@myemail.com\"\n\n  #Configures the methods needed by mailboxer\n  config.email_method = :mail_email\n  config.name_method = :name\n\n  #Configures if you use or not a search engine and wich one are you using\n  #Supported enignes: [:solr,:sphinx] \n  config.search_enabled = false\n  config.search_engine = :solr\nend\n</code></pre>\n\n<p>In my user model I have: </p>\n\n<pre><code>acts_as_messageable\n  def name\n    email\n  end\n\n def mail_email\n    @mail_email = self.email\n end\n</code></pre>\n\n<p>But I get this error in view when sending a message:</p>\n\n<pre><code> ArgumentError in ConversationsController#reply\n\nwrong number of arguments (1 for 0)\n\nRails.root: C:/rails/sitesale\nApplication Trace | Framework Trace | Full Trace\n\napp/models/user.rb:17:in `mail_email'\napp/controllers/conversations_controller.rb:22:in `reply'\n</code></pre>\n\n<p>And the controller method reply:</p>\n\n<pre><code>  def reply\n    current_user.reply_to_conversation(conversation, *message_params(:body, :subject))\n    redirect_to conversation\n  end\n</code></pre>\n"},{"tags":["ruby","autoload"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":838,"score":3,"question_id":2959990,"title":"autoload with namespaces/submodules","body":"<p>I'm using modules as namespaces in ruby. How would I go about autoloading...something like <code>autoload :\"App::ModuleA\", 'app/module_a</code> that doesn't throw a \"must be constant name\" error?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13266384,"title":"How do I number records returned from a database?","body":"<p>If I have records ordered by date from a database, I would like to add a number corresponding according to how the record is ordered. E.g, if a record was ordered by a given date I would like to add an incrementing number to it:</p>\n\n<pre><code>1). Me\n2). You\n3). Us\n</code></pre>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13266857,"title":"Getting rid of commonalities in array","body":"<p>I have these arrays:</p>\n\n<pre><code>x = ['a','b','c','d']\ny = ['b','c','e']\n</code></pre>\n\n<p>I'd like to get rid of the commonalities in <code>x</code> and <code>y</code> and ignore the non-commonalities in <code>y</code>.</p>\n\n<p>Ideally, when I do something to the two arrays, I would get <code>['a','d']</code>.</p>\n\n<p>Is there something that does this in Ruby?</p>\n"},{"tags":["ruby","ruby-on-rails-3","rest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13271690,"title":"Why does respond_with JSON not work?","body":"<p>I'm having a problem when trying to use the return to in a rails controller. This is not working:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\nrespond_to :json\n\n    def create\n        @user = User.create params[:user_info] \n        respond_with @user\n    end\nend\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\nrespond_to :json\n\n    def create \n        @user = User.create params[:user_info] \n        respond_with @user do |format|\n              format.json { render json: @user.to_json }\n        end\n    end\nend\n</code></pre>\n\n<p>Why? This is the error I have in the server's log when using the one that doesn't work:</p>\n\n<pre><code>NoMethodError (undefined method `user_url' for #&lt;UsersController:0x007fd44d83ea90&gt;):\napp/controllers/users_controller.rb:7:in `create'\n</code></pre>\n\n<p>My route is:    </p>\n\n<pre><code>resources :users, :only =&gt; [:create]\n</code></pre>\n"},{"tags":["ruby","monitoring","monit"],"answer_count":6,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":2530,"score":8,"question_id":4651449,"title":"Monitor ruby processes with Monit","body":"<p>I have a bunch of Ruby scripts which are long running, I'd like to ensure that every 30 seconds or so these are up. </p>\n\n<p>I normally start the commands by simply <code>ruby script-name.rb</code> </p>\n\n<p>How can I configure monit to look after these scripts?</p>\n\n<p><strong>Update:</strong> I tried to follow <a href=\"http://mmonit.com/wiki/Monit/FAQ#pidfile\">this method to create a wrapper script</a> which would then launch the ruby process but it did not seem to create the .pid file and typing './wrapper-script stop' did nothing :/</p>\n\n<p>Should I write the pid inside ruby or use a wrapper script to create the pid necessary for monit?</p>\n"},{"tags":["ruby","ubuntu","foreman","init.d"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13252439,"title":"init.d script generator for ruby processes?","body":"<p>I have some ruby processes, and for development I've been using foreman to manage the processes, now in production I want to export the processes and run it in /etc/init.d directory.</p>\n\n<p>Is there any tool that can help with that, by creating the scripts and the related PID to /var/run ? I tried to use foreman export feature to do so, but it didn't work to do that, since it can do something for inittab or upstart but not init.d. </p>\n\n<p>Any help would be highly appreciated </p>\n"},{"tags":["ruby-on-rails","ruby","menu","languages"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13255037,"title":"how would you provide menu written in different (locale) languages instead of repeating them in every page?","body":"<p>below is an example of menu in french, I will also have it in another five more languages:</p>\n\n<pre><code>&lt;a href=\"/&lt;%= @lang %&gt;/\"&gt;Jeux&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/get-the-player\"&gt;Obtenir le lecteur&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/about\"&gt;À propos&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/faq\"&gt;FAQ&lt;/a&gt;\n&lt;a href=\"/&lt;%= @lang %&gt;/contact\"&gt;Contact&lt;/a&gt;\n</code></pre>\n\n<p>at the moment the menu are in a relevant pages (.html.erb), by using the code listed below</p>\n\n<pre><code>&lt;%= content_for :menu do %&gt;    \n    &lt;a href=\"/&lt;%= @lang %&gt;/\"&gt;Jeux&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/get-the-player\"&gt;Obtenir le lecteur&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/about\"&gt;À propos&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/faq\"&gt;FAQ&lt;/a&gt;\n    &lt;a href=\"/&lt;%= @lang %&gt;/contact\"&gt;Contact&lt;/a&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>once I have done above I have got the reference on the application.html.erb</p>\n\n<pre><code>&lt;%= yield :menu %&gt;\n</code></pre>\n\n<p>it can be done exactly the same way for other languages, however, is there a way where I could avoid the repetition of the code. perhaps makes the controller to go and find for it and render it in exact place ? Help please,</p>\n\n<p>thanks in advance!</p>\n\n<p>===========================================================================</p>\n\n<pre><code>    **CHECK BELOW FOR SOLUTIONS THAT I HAVE PROVIDED**\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","gem","gemfile","debugger-linecache"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":553,"score":1,"question_id":11354768,"title":"An error occurred while installing debugger-linecache (1.1.1), and Bundler cannot continue","body":"<p>Any idea how to fix this?</p>\n\n<pre><code>Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n/home/durrantm/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb \nchecking for vm_core.h... no\nchecking for vm_core.h... no\nMakefile creation failed\n**************************************************************************\nNo source for ruby-1.9.3-p194 provided with debugger-ruby_core_source gem.\n**************************************************************************\n</code></pre>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":13270042,"title":"Ruby: Get public (remote) IP address","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/11897269/get-own-ip-address\">Get own IP address</a>  </p>\n</blockquote>\n\n\n\n<p>I was wondering if there was a simple way to get the public IP address of a computer using Ruby.</p>\n"},{"tags":["ruby-on-rails","ruby","views","route","subfolder"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13234576,"title":"how to route your sub-folder in views Ruby on Rails?","body":"<p>Can anyone please shed some light on how to route your sub-folder's .html.erb files?? which is placed like this:</p>\n\n<pre><code>view/pages/en/index.html.erb\n</code></pre>\n\n<p>and to route this i am doing following things on route.rb</p>\n\n<pre><code>match ':lang/index', :to =&gt; 'pages/en#index'\n</code></pre>\n\n<p>any to link them I have this on the header</p>\n\n<pre><code>&lt;%= link_to \"Home\", index_path %&gt;\n</code></pre>\n\n<p>The error i am getting is </p>\n\n<pre><code> Routing Error\n uninitialized constant Pages\n</code></pre>\n\n<p>routes:</p>\n\n<p><img src=\"http://i.stack.imgur.com/NXi02.png\" alt=\"enter image description here\"></p>\n\n<p>Any help would be much appreciated! Thanks in advance</p>\n\n<p>===========================================================================</p>\n\n<pre><code>    **CHECK BELOW FOR SOLUTIONS THAT I HAVE PROVIDED**\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","acts-as-taggable-on","posts"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":451,"score":1,"question_id":10274885,"title":"Acts_as_taggable_on implementation tutorial","body":"<p>I've been trying to allow for tags to be placed on posts so that I could partition them into different sections of my app. I've looked through various gems and have found that acts_as_taggable_on seems to be the most popular one. After various attempts of implementation from the examples in the github of the gem I have not been able to successfully use it. I've searched extensively for a tutorial on implementation but have found none and was hoping someone would have one for such a thing. I'm sorry for the simple question as I am still relatively new to programming. </p>\n"},{"tags":["jquery","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13247589,"title":"Rails Nested Resources - create and edit 2 levels away with form_for in partial","body":"<p>Really racking my brain on this one.  I'm relatively new to Rails and trying to do something that I'm sure is not too difficult.</p>\n\n<p>I have a model \"Trip\" which has many \"Days\" which has many \"Activities\"</p>\n\n<p>I am in the show.html.erb view of \"Trip\" and in this view, I am rendering a partial for a form that should allow me to create a new \"Activity\" to be associated with a \"Day\" or edit an existing \"Activity\" which already belongs to a \"Day\"</p>\n\n<p>How do I pass to the form_for in the form partial, the local variable of which \"Day\" I want to create the new \"Activity\" for.  And using that same form partial, how can I retrieve the \"Day\" that the \"Activity\" is associated with? Eventually these will be AJAX loaded objects.\nI've googled for the past several hours and can't find any examples similar to this.  I really appreciate the help.</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>  resources :trips do\n    resources :days    \n  end\n\n  resources :days do\n    resources :activities\n  end \n</code></pre>\n\n<p><strong>show.html.erb for the Trip</strong></p>\n\n<pre><code>&lt;div id=\"activities_list\"&gt;\n  &lt;%= render :partial =&gt; \"activities\" %&gt;\n&lt;/div&gt; \n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :locals =&gt; { :activity =&gt; @activity}  %&gt;\n&lt;/div&gt;\n\n&lt;div id=\"bottom\"&gt;\n&lt;%= link_to 'Edit', edit_trip_path(@trip) %&gt; |\n&lt;%= link_to 'Back', trips_path %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>_activities.html.erb partial</strong></p>\n\n<pre><code>&lt;h1&gt;&lt;%= @trip.title %&gt;&lt;/h1&gt;\n\n&lt;% @trip.days.each do |day| %&gt;\n&lt;div id=\"blech_&lt;%= day.id %&gt;\"&gt;\n  &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n      &lt;% day.activities.each do |activity| %&gt;\n            &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_day_activity_path(day, activity), :remote =&gt; true  %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;%= link_to 'New Activity', new_day_activity_path(day), :remote =&gt; true %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_form.html.erb partial</strong> I know that I need to be calling the day_activity_path with (@day,@activity) variables.  but I don't know how to get the @day variable in here</p>\n\n<pre><code>  &lt;%= form_for([@activity], :remote =&gt; true) do |f| %&gt;\n     &lt;fieldset&gt;\n       &lt;%= f.label :title, \"Activity\" %&gt;&lt;br /&gt;\n       &lt;%= f.text_field :title, :rows =&gt; 1 %&gt;&lt;br /&gt;\n     &lt;/fieldset&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby","inheritance","mixins","eigenclass"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13269271,"title":"Why a module's singleton method is not visible in downstream eigenclasses where it gets mixed?","body":"<p>I understand the regular method lookup path i.e. <code>class, superclass/module, all the way up to BasicObject</code>. I thought it was true for singleton version of the chain also but doesn't seem the case when you mixin a module in the meta-chain. I'd appreciate if someone can explain why in the following example <code>Automobile</code> module's <code>banner</code> method is called instead of its singleton version when I have included this module in Vehicle's eigenclass.</p>\n\n<pre><code>module Automobile\n  def banner\n    \"I am a regular method of Automobile\"\n  end\n\n  class &lt;&lt; self\n    def banner\n      \"I am a singleton method of Automobile\"\n    end\n  end\nend\n\nclass Vehicle \n  def banner\n    \"I am an instance method of Vehicle\"\n  end\n\n  class &lt;&lt; self\n    include Automobile\n    def banner\n      puts \"I am a singleton method of Vehicle\"\n      super\n    end\n  end\nend\n\nclass Car &lt; Vehicle\n  def banner\n    \"I am an instance method of Car\"\n  end\n\n  class &lt;&lt; self\n    def banner\n      puts \"I am a singleton method of Car\"\n      super\n    end\n  end\nend\n\nputs Car.banner\n\n# I am a singleton method of Car\n# I am a singleton method of Vehicle\n# I am a regular method of Automobile\n</code></pre>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13126490,"title":"Split a string by 2 various number of chars, skipping non alphanumerics","body":"<p>I have a string like:</p>\n\n<pre><code>hn$8m3kj4.23hs@8;\n</code></pre>\n\n<p>i need to split it as follow: first entry should be of one char length, second entry of 2 chars, third entry of one char, fourth - by 2 chars and so on.</p>\n\n<p>then concatenate one char with two chars entries by a semicolon <code>:</code></p>\n\n<p>if some chars at the end remains unpaired, they should be displayed as well.</p>\n\n<p>it is important to skip all non alphanumeric chars.</p>\n\n<p>so the final string should be:</p>\n\n<pre><code>h:n8 m:3k j:42 3:hs 8:\n</code></pre>\n\n<p>see, 8 has no 2 chars pair but it is displayed anyway.</p>\n\n<p>i have tried with a loop but i get huge code.\nalso tried regexs but it split by wrong number of chars.</p>\n"},{"tags":["javascript","jquery","ruby","ajax","sinatra"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13263756,"title":"Sinatra not recognising javascript for session","body":"<p>I'm trying to log into a Sinatra app with jQuery, but Sinatra is just not seeming to recognise it at all for some reason, here is my code to see if the user is logged in:</p>\n\n<p>Sinatra app:</p>\n\n<pre><code>get '/logged_in' do\n    if session[:logged_in] == true\n         status 200\n         \"OK\"\n    else\n        status 200\n        \"False\"\n    end\nend\n</code></pre>\n\n<p>When I browse to <code>/logged_in</code> in my browser, I see <code>OK</code>, but when I execute the following Javascript, I get <code>False</code> printed to the console - seems bizarre to me.</p>\n\n<pre><code>var r = $.ajax({\n  type: \"GET\",\n  url: \"http://xxx-xxx.com/logged_in\"\n});\nr.success(function(msg) {\n    console.log(msg);\n});\n</code></pre>\n\n<p>Any insight would be appreicated!</p>\n"},{"tags":["ruby-on-rails","ruby","debugging"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13271248,"title":"Debugger going to implicit.rb automatically","body":"<p>I installed debugger gem in my gemset</p>\n\n<pre><code>&lt;pre&gt;\nnikhil@nikhil-K54C:/media/media1/railscode/beasport$ bundle show debugger\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/debugger-1.2.0\n&lt;/pre&gt;\n</code></pre>\n\n<p>My intention is to use this gem to debug my application by placing \"debugger\" call in my code so that i can use it to debug application.\nHowever strangely even if i have not put \"debugger\" call anywhere in my code but still whenever i hit any url to my application (from localhost:3000), debugger starts debugging in file </p>\n\n<pre><code>&lt;pre&gt;\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb\n&lt;/pre&gt;\n</code></pre>\n\n<p>here is what i get when i do \"list\"</p>\n\n<pre><code>&lt;pre&gt;\n\n=&gt; Ctrl-C to shutdown server\n[2012-11-07 19:11:18] INFO  WEBrick 1.3.1\n[2012-11-07 19:11:18] INFO  ruby 1.9.3 (2012-04-20) [i686-linux]\n[2012-11-07 19:11:18] INFO  WEBrick::HTTPServer#start: pid=6602 port=3000\n/home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb:5\ndefault_render unless response_body\n(rdb:1) list\n[0, 9] in /home/nikhil/.rvm/gems/ruby-1.9.3-p194@beasport/gems/actionpack-3.2.8/lib/action_controller/metal/implicit_render.rb\n   1  module ActionController\n   2    module ImplicitRender\n   3      def send_action(method, *args)\n   4        ret = super\n=&gt; 5        default_render unless response_body\n   6        ret\n   7      end\n   8  \n   9      def default_render(*args)\n(rdb:1) \n&lt;/pre&gt;\n</code></pre>\n\n<p>I am using webrick. This is frustrating. When i remove debugger gem from gemfile and do \"bundle install\" then it works fine but i wont be able to debug my application then.\nAgain i checked with my other application and there debugger works just fine and do not go to implicit.rb unnecessarily.\nPlease help</p>\n"},{"tags":["ruby","function","expressions"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":84,"score":0,"question_id":12825835,"title":"Shorter way to say \"anwer=\"this\" or answer = \"that\"","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10260050/elegant-chained-ors-for-tests-on-same-variable-in-ruby\">Elegant chained &#39;or’s for tests on same variable in Ruby</a>  </p>\n</blockquote>\n\n\n\n<p><code>answer=\"this\" or answer = \"that\"</code> is wordy</p>\n\n<p>I would like to be able use an expression more like <code>answer =(\"this\" or that\")</code> but I know I can't use that expression as the <code>or</code> gets done and then the (true or false) result is compared to answer, so that is not what I want.  Something more like  a =~ [a/c] but I need interpolation.</p>\n"},{"tags":["ruby-on-rails","ruby","nokogiri"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13263955,"title":"Extract information from website using nokogiri","body":"<p>I'm trying to figure out how to extract the information on a file using nokogiri.</p>\n\n<p>The information generated isn't an xml or html file.. so not sure how to get this!</p>\n\n<pre><code>def get_summoner_account\n    url = \"http://elophant.com/api/v1/euw/getSummonerByName?summonerName=Heggom&amp;key=0r57xO0H2A7ukQi6gUbG \"\n    doc = Nokogiri::HTML(open(url))\n\n    name = doc.xpath(\"name\").collect(&amp;:text)\n    acctID = doc.xpath(\"acctID\").collect(&amp;:text)\n    summonerId = doc.xpath(\"summonerId\").collect(&amp;:text)\n\n    puts accID\n    puts name\n    puts summonerID\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","rdoc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13261994,"title":"RDoc just my own application?","body":"<p>Is there a way to stop RDoc from going higher than the current directory? i just tried</p>\n\n<pre><code>rdoc -O -x ../\n</code></pre>\n\n<p>but this also stopped it from parsing relative pathes in subdirectories; what I really need is something like:</p>\n\n<p>If absolute path of App is /foo/bar/MyAppDir/, just RDoc all sources inside and below /foo/bar/MyAppDir/ without parsing /foo/bar/OtherRepository/ from wich some classes derive and get functions I dont want to document.</p>\n"},{"tags":["ruby-on-rails","ruby","parsing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12802268,"title":"Ruby, fetch first image from a text","body":"<p>Within a Ruby class, I want to parse and fetch the first occurance of an image inside some text that is saved in a database. In particular, I want to collect all <code>src</code> attributes.</p>\n\n<p>Will Nokogiri help me? How can I do it?</p>\n\n<hr>\n\n<p>Edit1:</p>\n\n<p>I wrote:</p>\n\n<pre><code>// database stuff...\ndoc = Nokogiri::HTML(my_html)\n\ndoc.search('img') do |img_tag|\n  puts img_tag\nend\n</code></pre>\n\n<p>But I'm not able to collect the image tags.</p>\n\n<hr>\n\n<p>Edit2:</p>\n\n<p>I found the solution:</p>\n\n<pre><code>doc.search('img').each do |img_tag|\n  puts img_tag.attributes['src']\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13259763,"title":"Rails condition where association has_many has count more than one","body":"<p>Package.rb</p>\n\n<pre><code>has_many :deals\n</code></pre>\n\n<p>Deal.rb</p>\n\n<pre><code>belongs_to package\n</code></pre>\n\n<p>Now simple question is I want to get all packages where deals count is more than one.\nWhat is the best method to do it? <code>where(:available_for_purchase =&gt; true)</code>and <code>self.deals.count &gt; 0</code> </p>\n\n<p>(package.rb)</p>\n\n<pre><code>  class &lt;&lt; self\n    def available\n      where(:available_for_purchase =&gt; true)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby","linux","gem","rvm"],"answer_count":3,"favorite_count":4,"up_vote_count":36,"down_vote_count":1,"view_count":13133,"score":35,"question_id":9727908,"title":"cannot load such file -- zlib even after using rvm pkg install zlib","body":"<p>I installed zlib package and ruby 1.9.3 using rvm, but whenever I try to install gems it says \n<code>cannot load such file -- zlib</code>.</p>\n\n<p>The commands I used to install are:</p>\n\n<pre><code>$ rvm install 1.9.3\n</code></pre>\n\n<p>.</p>\n\n<pre><code>$ rvm pkg install zlib\n\n$ rvm reinstall 1.9.3 --with-readline-dir=/home/username/.rvm/usr --with-iconv-dir=/home/username/.rvm/usr --with-zlib-dir=/home/username/.rvm/usr --with-openssl-dir=/home/username/.rvm/usr\n\n$ rvm use 1.9.3\n\n$ gem install heroku\nERROR: Loading command: install (LoadError)\n    cannot load such file -- zlib\nERROR: While executing gem ... (NameError)\n    uninitialized constant Gem::Commands::InstallCommand\n</code></pre>\n\n<p>All the help on this subject tells me to do just do rvm pkg install zlib, and then reinstall the ruby with <code>--with-zlib-dir=/home/username/.rvm/usr</code>, but this didn't work. :(</p>\n"},{"tags":["ruby","ruby-on-rails-3","mvc","cells"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13270785,"title":"Accessing devise helpers from cell's controller and views","body":"<p>I'm using <a href=\"https://github.com/apotonick/cells\" rel=\"nofollow\">cells gem</a> and need access devise helpers from cell controller and view, for example current_user.</p>\n\n<p>In controller i'm done with</p>\n\n<pre><code>include Devise::Controllers::Helpers\nDevise::Controllers::Helpers.define_helpers(Devise::Mapping.new(:student, {}))\n</code></pre>\n\n<p>But in view i should create @variable that assign with devise helper from controller, i can't using current_user directly in my cells view. Is there any elegant solution for my problem ?</p>\n"},{"tags":["ruby","rvm","zsh","pow"],"answer_count":3,"favorite_count":6,"up_vote_count":6,"down_vote_count":0,"view_count":622,"score":6,"question_id":10154928,"title":"Pow, RVM and ZSH not working together","body":"<p>I'm trying to get Octopress (http://octopress.org/) working, but I'm having some issues.\nI'm using POW (http://pow.cx/) and it seems to not load the correct Ruby version for me (using RVM).</p>\n\n<p>It always uses the RVM default ruby version and not the one specified in .rvmrc. My default Ruby version in RVM is: ruby-1.9.3-p125.</p>\n\n<p>In my .rvmrc file I have this: <code>rvm use 1.9.2</code>\nI get this error in the browser when visiting my site:</p>\n\n<pre><code>LoadError: cannot load such file -- bundler/setup\n~/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n~/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n~/Sites/Lejnus/lejnus/config.ru:1:in `block in &lt;main&gt;'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/builder.rb:4:in `instance_eval'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/builder.rb:4:in `initialize'\n~/Sites/Lejnus/lejnus/config.ru:1:in `new'\n~/Sites/Lejnus/lejnus/config.ru:1:in `&lt;main&gt;'\n~/Library/Application     Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:50:in `eval'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:50:in `load_config'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:43:in `initialize'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:13:in `new'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/lib/nack/server.rb:13:in `run'\n~/Library/Application Support/Pow/Versions/0.3.2/node_modules/nack/bin/nack_worker:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>Why is it using 1.9.3-p125 when 1.9.2 is specified in my .rvmrc file? If I set 1.9.2 as default it works of course...</p>\n\n<p>Isn't it supposed to do this magic for me and use the correct ruby versions?</p>\n"},{"tags":["ruby-on-rails","ruby","list","view","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13269961,"title":"Ruby on Rails: re-order checkbox tag","body":"<p>I have an app where a user can enter projects into a database. One of the fields allows the user to pick multiple technologies. I want the list of technologies to appear in alphabetical order, because at the moment, they appear in the order they were entered into the database.</p>\n\n<p>Here is my new action in my project controller:</p>\n\n<pre><code>def new\n    @project = Project.new\n        @technol = Technol.new(params[:tech])\n\n        @all_technols = Technol.all\n        tech_ids = params[:technols][:id].reject(&amp;:blank?) unless params[:technols].nil?\n\n\n        @project_technol = @project.projecttechnols.build\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @project }\n    end\n  end\n</code></pre>\n\n<p>Here is part of my new view:</p>\n\n<pre><code>&lt;div class=\"tech\" STYLE=\"text-align: left;\"&gt;\n  &lt;b&gt;Technologies:&lt;/b&gt;\n  &lt;style&gt;\n    .split { text-align:left; }\n  &lt;/style&gt;\n\n\n  &lt;p&gt;&lt;ul&gt; \n\n  &lt;% for technol in Technol.all %&gt; \n   &lt;li class=\"split\"&gt; \n    &lt;%= check_box_tag \"project[technol_ids][]\", technol.id,  @project.technols.include?(technol) %&gt; \n    &lt;%= technol.tech %&gt; \n   &lt;/li&gt; \n\n  &lt;% end %&gt; \n &lt;/ul&gt; \n &lt;/p&gt; \n</code></pre>\n\n<p>Does anyone have any ideas? I am new to rails so please remember this when trying to answer. Thanks in advance.</p>\n"},{"tags":["ruby","marshalling","pipe","pipes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":11898528,"title":"Marshal (Ruby) pipes: sending serialized object to child processes","body":"<p>I need to serialize an object in Ruby with Marshal and send it to a sub-process via pipes. How can I do this?</p>\n\n<p>My code looks like the following, and my questions are in comments: </p>\n\n<pre><code>data = Marshal.dump(data)\n#call sub-process\n`ruby -r a_lib -e 'a_method'` #### how to send the stdout to the subprocess?\n</code></pre>\n\n<p>And the a_method looks like:</p>\n\n<pre><code>def a_method\n  ...\n  data = Marshal.load(data) #### how to load the stdout of the parent process?\n  ...\nend\n</code></pre>\n"},{"tags":["ruby","xcode","gcc","compiler","rvm"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":2823,"score":2,"question_id":9765211,"title":"checking whether the C compiler works... no","body":"<p>I recently uninstalled Xcode 4.2 and re-installed Xcode 4.3.1. Installed <code>Command Line Tools</code> also. The error says 'C compiler doesn't work`. On searching for this error, it said that it happens when Xcode is not installed. What am I missing?</p>\n\n<pre><code>rvm install 1.9.3 --with-gcc=clang\nInstalling Ruby from source to: /Users/ava/.rvm/rubies/ruby-1.9.3-preview1, this may take a while depending on your cpu(s)...\n\nruby-1.9.3-preview1 - #fetching \nruby-1.9.3-preview1 - #extracting ruby-1.9.3-preview1 to /Users/ava/.rvm/src/ruby-1.9.3-preview1\nruby-1.9.3-preview1 - #extracted to /Users/ava/.rvm/src/ruby-1.9.3-preview1\nFetching yaml-0.1.4.tar.gz to /Users/ava/.rvm/archives\nExtracting yaml-0.1.4.tar.gz to /Users/ava/.rvm/src\nConfiguring yaml in /Users/ava/.rvm/src/yaml-0.1.4.\nERROR: Error running ' ./configure --prefix=\"/Users/ava/.rvm/usr\"  --with-gcc=clang           --build=x86_64-apple-darwin11.3.0           --host=x86_64-apple-darwin11.3.0           --build=x86_64-apple-darwin11.3.0           --host=x86_64-apple-darwin11.3.0 ', please read /Users/ava/.rvm/log/ruby-1.9.3-preview1/yaml/configure.log\nCompiling yaml in /Users/ava/.rvm/src/yaml-0.1.4.\nERROR: Error running '/usr/bin/make ', please read /Users/ava/.rvm/log/ruby-1.9.3-preview1/yaml/make.log\nInstalling yaml to /Users/ava/.rvm/usr\nERROR: Error running '/usr/bin/make install', please read /Users/ava/.rvm/log/ruby-1.9.3-preview1/yaml/make.install.log\nruby-1.9.3-preview1 - #configuring \nERROR: Error running ' ./configure --prefix=/Users/ava/.rvm/rubies/ruby-1.9.3-preview1 --enable-shared --disable-install-doc  --with-gcc=clang           --build=x86_64-apple-darwin11.3.0           --host=x86_64-apple-darwin11.3.0           --build=x86_64-apple-darwin11.3.0           --host=x86_64-apple-darwin11.3.0 --with-libyaml-dir=/Users/ava/.rvm/usr ', please read /Users/ava/.rvm/log/ruby-1.9.3-preview1/configure.log\nERROR: There has been an error while running configure. Halting the installation.\n\n\n➜  yaml git:(master) ✗ vi configure.log \n\n[2012-03-18 21:03:00]  ./configure --prefix=\"/Users/ava/.rvm/usr\"  --with-gcc=clang           --build=x86_64-apple-darwin11.3.0           --host=x86_64-apple-darwin11.3.0           --build=x86_64-apple-darwin11.3.0           --host=x86_64-apple-darwin11.3.0\nconfigure: WARNING: unrecognized options: --with-gcc\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... config/install-sh -c -d\nchecking for gawk... no\nchecking for mawk... no\nchecking for nawk... no\nchecking for awk... awk\nchecking whether make sets $(MAKE)... yes\nchecking for x86_64-apple-darwin11.3.0-gcc... no\nchecking for gcc... gcc\nchecking whether the C compiler works... no\nconfigure: error: in `/Users/ava/.rvm/src/yaml-0.1.4':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\n\n\n➜  ~ git:(master) ✗ gcc -v   \nUsing built-in specs.\nTarget: i686-apple-darwin11\nConfigured with: /private/var/tmp/llvmgcc42/llvmgcc42-2336.9~22/src/configure --disable-checking --enable-werror --prefix=/Applications/Xcode.app/Contents/Developer/usr/llvm-gcc-4.2 --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-prefix=llvm- --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin11 --enable-llvm=/private/var/tmp/llvmgcc42/llvmgcc42-2336.9~22/dst-llvmCore/Developer/usr/local --program-prefix=i686-apple-darwin11- --host=x86_64-apple-darwin11 --target=i686-apple-darwin11 --with-gxx-include-dir=/usr/include/c++/4.2.1\nThread model: posix\ngcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.9.00)\n\n\n➜  ~ git:(master) ✗ which gcc\n/usr/bin/gcc\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13222236,"title":"bootstrap-sass display error","body":"<p>Trying to use bootstrap-sass</p>\n\n<p>It seems as if it is not compiling correctly of sorts </p>\n\n<p>calling bootstrap in custom.css.scss<br>\n@import \"bootstrap\";</p>\n\n<p>including the gem\ngem \"bootstrap-sass\", \"~> 2.1.1.0\"</p>\n\n<p>You can see the issue here, the nav is coming out white with the links off color as well.</p>\n\n<p><a href=\"http://learingisfun.herokuapp.com/pages/home\" rel=\"nofollow\">http://learingisfun.herokuapp.com/pages/home</a></p>\n\n<p>The repo for this as well is <a href=\"https://github.com/thebusiness11/appsample\" rel=\"nofollow\">https://github.com/thebusiness11/appsample</a></p>\n"},{"tags":["ruby","builder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13269669,"title":"Ruby Builder Gem - dynamically set node name","body":"<p>I'm currently using the Builder gem for Ruby to generate XML representations for resources in my application. The XML representation has multiple child nodes that are always structure the same, but the top-level node has a different name, depending on the value of a boolean property of the resource. Is there any way I can generate builder nodes dynamically? Something like this (tried this already, doesn't work):</p>\n\n<pre><code>if resource.attr\n  top_level_node = :ForFlowBased\nelse\n  top_level_node = :ForNonSeamlessOffload\nend\n\nbuilder = Builder::XmlMarkup.new\nbuilder.send(top_level_node). do |top_level_node|\n....\nend\n</code></pre>\n\n<p>That code will generate a node <code>&lt;send:ForFlowBased&gt;</code>. Similarly if I call <code>builder.(top_level_node)</code>, the xml generated is <code>&lt;call:ForFlowBased&gt;</code>. I'm looking to dynamically send builder the method I want to invoke on it, without adding send or call to the XML as well.</p>\n"},{"tags":["ruby","gem","sitemap"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13267751,"title":"Sitemap generator in text on Ruby","body":"<p>I have some site, for example <code>http://example.com</code><br>\nI want to generate a sitemap as a list of URIs, such as:</p>\n\n<ul>\n<li><code>http://example.com/main</code></li>\n<li><code>http://example.com/tags</code></li>\n<li><code>http://example.com/tags/foo</code></li>\n<li><code>http://example.com/tags/bar</code></li>\n</ul>\n\n<p>I have found a good application for it: <a href=\"http://www.pointworks.de/software/igoomap/index.php\" rel=\"nofollow\">iGooMap</a><br>\niGooMap can generate the needed URI list as a text file (not an XML File).<br>\nHere is a visual representation of what I am trying to achieve:</p>\n\n<p><img src=\"http://i.stack.imgur.com/1MoMM.png\" alt=\"Here is what I would like to have\">  </p>\n\n<p>I want to have this type of a sitemap generated in Ruby (<em>not</em> Rails).<br>\nI have found <a href=\"https://github.com/kjvarga/sitemap_generator\" rel=\"nofollow\">SiteMapGenerator</a>, but it only generates an .XML file, however as stated  I need a text file.  </p>\n\n<p>Is there a solution for Ruby to create a list of links for a given site?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13088392,"title":"Rails: error with pjax \"Uncaught TypeError: Object [object Object] has no method 'pjax' \"","body":"<p>Gemfile:</p>\n\n<blockquote>\n  <p>gem 'pjax_rails'</p>\n</blockquote>\n\n<p>app/assests/javascripts/application.js :</p>\n\n<pre><code>//= require jquery \n//= require jquery_ujs \n//= require_tree . \n//= require jquery.pjax\n\n\n$(function() {\n $('a').pjax('[data-pjax-container]');\n});\n</code></pre>\n\n<p>app/views/layouts/application.html.erb:</p>\n\n<pre><code>&lt;div id=\"data-pjax-container\" data-pjax-container&gt;\n        &lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The error i'm getting in chrome is:</p>\n\n<blockquote>\n  <p>Uncaught TypeError: Object [object Object] has no method 'pjax'</p>\n</blockquote>\n\n<p>And it refers to the application.js file. What is wrong here?</p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":196,"score":1,"question_id":6168434,"title":"Activerecord Where with a hash value","body":"<p>I have a City model with a cached_info field which is a serialized hash. </p>\n\n<pre><code>{:population=&gt;20000, :more_stuff =&gt;....}\n</code></pre>\n\n<p>If I make the following query in Activerecord.</p>\n\n<pre><code>City.where('cached_info[:population] &gt; 300').count\n</code></pre>\n\n<p>I get back...</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: \nYou have an error in your SQL syntax; \ncheck the manual that corresponds to your MySQL server version for the right syntax to use near '[:population] &gt; 300)' at line 1: SELECT COUNT(*) FROM `places` WHERE `places`.`type` = 'City' AND (cached_info[:population] &gt; 3)\n</code></pre>\n\n<p>Anybody have a workaround for this?</p>\n"},{"tags":["ruby","refactoring"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13268527,"title":"How can I refactor this code for Ruby?","body":"<p>I created the following helper method and it is working fine but I want to improve the way it is being called.</p>\n\n<pre><code>def display_if_present(attribute, i18key, hours=nil)\n  unless attribute.blank?\n    content_tag :li do\n\n      if hours.present?\n        concat content_tag :h2, get_translation_by_model_attr('achievment', i18key) + ' ('+t(:hours)+'): '\n      else\n        concat content_tag :h2, get_translation_by_model_attr('achievment', i18key)+': '\n      end\n\n      if i18key.include? 'date'\n        concat content_tag :p, attribute.strftime('%m/%Y')\n      elsif hours.present?\n        concat content_tag :p, h(attribute) + \"(\" + t(:hours) + \")\"\n      else\n        concat content_tag :p, h(attribute) \n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And on the <code>view</code> side I have the following:</p>\n\n<pre><code>&lt;%= display_if_present(academic_achievment.institution,'institution') %&gt;\n\n&lt;%= display_if_present(academic_achievment.ativs_description,'ativs_description') %&gt;\n\n&lt;%= display_if_present(academic_achievment.date_start,'date_start') %&gt;\n\n&lt;%= display_if_present(academic_achievment.date_finished,'date_finished') %&gt;\n\n&lt;%= display_if_present(academic_achievment.load, 'load', :hours) %&gt;\n\n&lt;%= display_if_present(academic_achievment.tags, 'tags') %&gt;\n</code></pre>\n\n<p>which I want to do some refactor. So I tried:</p>\n\n<pre><code>&lt;% elements = %w(institution ativs_description date_start date_finished load tags) %&gt;\n\n&lt;% elements.collect! do |item| %&gt;\n  &lt;% params = (item == \"load\") ? \"item, :hours\" : \"item\" %&gt;\n  &lt;%= display_if_present(\"academic_achievment.#{item}\".constantize, params.constantize) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>the above block of code returned the error:</p>\n\n<pre><code>wrong constant name academic_achievment.institution\nExtracted source (around line #15):\n\n12: \n13:         &lt;% elements.collect! do |item| %&gt;\n14:           &lt;% params = (item == \"load\") ? \"item, :hours\" : \"item\" %&gt;\n15:           &lt;%= display_if_present(\"academic_achievment.#{item}\".constantize, params.constantize) %&gt;\n16:         &lt;% end %&gt;\n17:  \n18:       &lt;/ul&gt;\n</code></pre>\n\n<p>I appreciate some help for a better piece of code.</p>\n"},{"tags":["ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":7,"view_count":70,"score":-5,"question_id":13268777,"title":"What are Dynamic classes and methods?","body":"<p>I am fairly new to programming and came across dynamic classes and methods in ruby. Before jumping into the topic I would like to have a general idea about them. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13268935,"title":"Monkey-patching database adapter in Rails app","body":"<p>I'm using PosgreSQL adapter to connect to Vertica database which is mostly compatible with PostgreSQL but doesn't support options like client_min_messages (which are still passed to <code>PGconn.connect</code> despite not being present in <code>database.yml</code>). I've made a quick and dirty monkey patch for <code>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</code> but the problem is that I guess everything in AR in lazy loaded and the original file is read after my patch. </p>\n\n<p>If I add <code>require 'active_record/connection_adapters/postgresql_adapter'</code> at the top of the monkey patch then ActiveRecord tries to establish connection and fails. Is it possible to alter this behavior to make the monkey patch work or should I just write a full-fledged connection adapter?</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","rvm"],"answer_count":6,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":2266,"score":-2,"question_id":6367286,"title":"Ubuntu + Install Ruby 1.9, Rails 3 Using RVM","body":"<p>Best way to Install <code>RUBY 1.9, Rails 3, Postgres, Heroku, GitHub,</code> Using RVM</p>\n\n<p>Can anyone suggest me the best way in which,I follow to install it properly, because previously I felt in various dependencies issues.</p>\n\n<p>Suggest something !!!</p>\n"},{"tags":["ruby","arrays","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13268531,"title":"Easy way to find all hashes with particular values","body":"<p>I have a following array of hashes </p>\n\n<pre><code>h = [{:foo=&gt;:bar}, {:qqq=&gt;:ppp}, {:xxx=&gt;123}]\n</code></pre>\n\n<p>I want to find all hashes which <code>Symbol</code> in values.</p>\n\n<p>Currently I use this approach, but I don't actually like it because I have to create array for each hash and extract the first element (<code>hash.values[0]</code>).</p>\n\n<pre><code>h.select { |hash| hash.values[0].is_a?(Symbol) }\n# =&gt; [{:foo=&gt;:bar}, {:qqq=&gt;:ppp}]\n</code></pre>\n\n<p>Maybe there is something more elegant to do this?</p>\n"},{"tags":["ruby","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12551564,"title":"How to write a diffable matcher with Rspec2","body":"<p>I'm trying to write a matcher which transforms object to a Hash before comparing to the expected value (let say that I want to compare 2 hashes without caring about the fact that keys are strings or symbols).</p>\n\n<p>I can easily define a matcher doing this</p>\n\n<pre><code>RSpec::Matchers.define :my_matcher do |content|\n    match { |to_match| my_hash_conversion(to_match) == my_hash_conversion(content)\n    diffable\nend\n</code></pre>\n\n<p>I add <code>diffable</code> so rspec displays the diff of the two objects when they don't match.\nHowever I want to display the diff of the converted objects not the the diff of the original object ?</p>\n\n<p>I saw they are somewhere in Rspec a Differ class and a diff_with_hash function, but I have no idea how to use it (as it's not really documented).</p>\n"},{"tags":["ruby","regex","scala"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":81,"score":2,"question_id":13268240,"title":"Neverending Regex : Regex couldn't terminate while matching a 69 character String (killed after a week)","body":"<p>Never thought it would be possible to write a Regex which never returns.</p>\n\n<p>The Regex</p>\n\n<pre><code>/^((?:\\d|\\w{1,2}[-\\d\\s])(?:[-\\s\\d]|\\w{1,2}[-\\d\\s])*\\d)$/\n</code></pre>\n\n<p>was built to match numbers which start with a digit or two letters followed by a dash a blank or digits and end with a number. In between the starting pattern could be repeated or a whitespace or dash could occur.</p>\n\n<p>Examples: 1234 , de-12943, EN - 12de -50</p>\n\n<p>Following example code will not terminate:</p>\n\n<p>ruby</p>\n\n<pre><code>#!/usr/bin/ruby\nstring = \"101000000750000000000000000000000001000038127OXMOO0OOOOO00000000000N9\"\nre = /^((?:\\d|\\w{1,2}[-\\d\\s])(?:[-\\s\\d]|\\w{1,2}[-\\d\\s])*\\d)$/\np re.match(\"101000000750000000000000000000000001000038127OXMOO0OOOOO00000000000N9\")\n</code></pre>\n\n<p>scala</p>\n\n<pre><code>\"\"\"^((?:\\d|\\w{1,2}[-\\d\\s])(?:[-\\s\\d]|\\w{1,2}[-\\d\\s])*\\d)$\"\"\".r findFirstIn \"101000000750000000000000000000000001000038127OXMOO0OOOOO00000000000N9\"\n</code></pre>\n\n<p>Removing the Anchors (^, $) lets the regex terminate quickly.</p>\n\n<p>Tried with Ruby and Scala.</p>\n\n<p>What's happening there?\nShould't the anchors lead to faster termination?</p>\n"},{"tags":["ruby","ruby-1.9","rubinius","yarv"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":3,"view_count":62,"score":2,"question_id":13205200,"title":"Rubinus or MRI 1.9.3 (YARV)?","body":"<p>So, I have a few questions that I have to ask, I did browse the internet, but there weren't too many reliable answers. Mostly blog posts that would cancel each-other out because they both praised different things and had benchmarks to \"prove their viewpoint\" (<del>I have never seen so many <em>contradicting</em> benchmarks in my life</del>).</p>\n\n<p>Anyway, my questions are:</p>\n\n<ul>\n<li><strong>Is Rubinius <em>really</em> faster?</strong> I was pretty impressed by this apparently honest <a href=\"http://hosiawak.github.com/rubinius_presentation/\" rel=\"nofollow\">pro-Rubinius presentation</a>. Another thing that confuses me a little is that a lot of Rubinius is written in Ruby itself, yet somehow it is faster than C-Ruby? It must be a pretty damn good implementation of the language, then!</li>\n<li><strong>Does EventMachine work with Ruinius?</strong> As far as I know, EventMachine partially relies on Fibers (correct me if I'm wrong) which weren't implemented until 1.9. I know Rubinius will eventually support 1.9, too; I don't mind waiting a little.</li>\n<li><strong>Do C extensions work in Rubinius?</strong> I have written a C extension which \"serializes\" binary messages received from a TCP stream into Ruby Objects and vice-versa (I suppose the details are not important, but if it helps answer this question I will update the post). This can be a <em>lot</em> of messages! I managed to write the same code in Ruby (although, it made little sense after a month), but it proved to be a real bottle-neck in the application. So, I had to use C as a \"solution\" to my problem.\n<strong>EDIT</strong>: I just remembered, I use C for another task, it is a hit-test method for Arrays. Basically it just checks if a \"point\" is inside an a polygon, it was impossibly slow in CRuby.</li>\n<li><strong>If the previous answer was a \"No,\" is there then an alternative for C extensions in Rubinus?</strong> I gather the VM is written in C++, so that then.</li>\n</ul>\n\n<p>A few \"bonus\" questions:</p>\n\n<ul>\n<li><strong>Will C-Ruby (2.0+, YARV) ever get rid of GIL? Or at least modify it so CRuby supports true parallelism?</strong></li>\n<li><strong>What is exactly <a href=\"https://github.com/mruby/mruby\" rel=\"nofollow\">mruby</a>?</strong> I see matz is working on it, and as far as the description goes it seems pretty awesome. How different is it from CRuby (performance-wise)?</li>\n</ul>\n\n<p>I apologize for this text-storm I unleashed upon you! ♥ </p>\n"},{"tags":["ruby-on-rails","ruby","arrays"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":438,"score":2,"question_id":8639857,"title":"Rails 3. How to get the difference between two arrays?","body":"<p>Let's say I have this array with shipments id's.</p>\n\n<p><code>s = Shipment.find(:all, :select =&gt; \"id\")</code></p>\n\n<p><code>[#&lt;Shipment id: 1&gt;, #&lt;Shipment id: 2&gt;, #&lt;Shipment id: 3&gt;, #&lt;Shipment id: 4&gt;, #&lt;Shipment id: 5&gt;]</code> </p>\n\n<p>Array of invoices with shipment id's</p>\n\n<p><code>i = Invoice.find(:all, :select =&gt; \"id, shipment_id\")</code></p>\n\n<p><code>[#&lt;Invoice id: 98, shipment_id: 2&gt;, #&lt;Invoice id: 99, shipment_id: 3&gt;]</code></p>\n\n<p>Invoices belongs to Shipment.<br />\nShipment has one Invoice.<br />\nSo the invoices table has a column of shipment_id.</p>\n\n<p>To create an invoice, I click on New Invoice, then there is a select menu with Shipments, so I can choose \"which shipment am i creating the invoice for\". So I only want to display a list of shipments that an invoice hasn't been created for.</p>\n\n<p>So I need an array of Shipments that don't have an Invoice yet. In the example above, the answer would be 1, 4, 5.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13266657,"title":"Rails nested_form_for not working when using file_field","body":"<p>When using <code>nested_form_for</code> and having a <code>file_field</code> in <code>fields_for</code> I get the following error from paperclip:</p>\n\n<p><strong>Paperclip::AdapterRegistry::NoHandlerError in ProjectsController#create</strong></p>\n\n<p><code>No handler found for \"scan.pdf\"</code></p>\n\n<p>This is correct, because the params don't show an <code>#&lt;ActionDispatch::Http::UploadedFile&gt;</code> object, but just the file name.</p>\n\n<p>Before using <code>nested_form_for</code> it worked, it works when I uncomment the <code>file_field</code> and it also works when I build the first object for <code>fields_for</code> but this shouldn't be necessary..</p>\n\n<p>My setup is as follows:</p>\n\n<ul>\n<li>ruby 1.9.3</li>\n<li>rails (3.2.8)</li>\n<li>paperclip (3.3.0)</li>\n<li>nested_form (0.3.0)</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code># @project.schemes.build\n= nested_form_for @project do |f|\n  = f.fields_for :schemes do |ff|\n    = ff.text_field :name\n    = ff.file_field :scan\n</code></pre>\n"},{"tags":["ruby","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13228797,"title":"How to run Capistrano task on failed deploy","body":"<p>Using Capistrano I'd like to run a cleanup/teardown task on failed deploy, such as when a shell command fails.</p>\n\n<p>I couldn't find anything after a fairly extensive search.</p>\n\n<p>Can anyone help? Thanks</p>\n"},{"tags":["ruby","capistrano","ubuntu-12.04","rbenv"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13260123,"title":"rbenv hanging while installing Ruby 1.9.3-p286 on Ubuntu 12.04","body":"<p>I'm having problems installing Ruby 1.9.3-p286 on a (blank) Ubuntu 12.04 box with Capistrano.</p>\n\n<p><strong>What happens is:</strong></p>\n\n<pre><code> * executing \"rbenv install 1.9.3-p286\"\n   servers: [\"178.48.132.196\"]\n   [178.48.132.196] executing command\n** [out :: 178.48.132.196] Downloading http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz...\n** [out :: 178.48.132.196] Installing yaml-0.1.4...\n** [out :: 178.48.132.196] Installed yaml-0.1.4 to /home/cphrb/.rbenv/versions/1.9.3-p286\n** [out :: 178.48.132.196] Downloading http://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p286.tar.gz...\n** [out :: 176.58.102.156] Installing ruby-1.9.3-p286...\n</code></pre>\n\n<p>(And here it hangs forever.)</p>\n\n<p><strong>To add to the mystery:</strong>\nThis works perfectly fine during office hours (GMT+1) but fails when running in the evening. It's been consistent three nights in a row. When I look at the running processes with <code>top</code>, it seems like the installation finishes as all processes related to the installation are gone. I'm quite curious how the time of day can influence the installation because once the installation is running on the box, it should not depend on any external services that could be down for e.g. maintenance. I've also tried to run the installation manually on the box but with the same result.</p>\n\n<p>Any ideas??</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","passenger","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":23,"score":0,"question_id":13265655,"title":"virtual hosting using phusion passenger","body":"<p>I wish to host two websites on same machine,both are in ruby on rails .\n<br/>I can't find where to write configuration for it and I need to host using standalone phusion passenger. I have followed <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_a_rack_based_ruby_application_including_rails_gt_3\" rel=\"nofollow\">passenger_guide</a> but still can't figure it out?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":8,"up_vote_count":28,"down_vote_count":0,"view_count":7968,"score":28,"question_id":3136420,"title":"Difference between attr_accessor and attr_accessible","body":"<p>In RoR, what is the difference between attr_accessor and attr_accessible. From my understanding, using attr_accessor is used to create getter and setter methods for that variable, so that we can access the variable like</p>\n\n<pre><code>`Object.variable`   or    `Object.variable = some_value`\n</code></pre>\n\n<p>I read that attr_accessible makes that specific variable accessible to the outside world.\nCan someone please tell me whats the difference</p>\n"},{"tags":["ruby","inheritance","rubygems"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13266982,"title":"Extending a gem file","body":"<p>I'm building an analysis tool and I'm using the Fnordmetric gem.</p>\n\n<p>Since I need to add and change the main dashboard, what should be the best way to do it?</p>\n\n<p>Should I unpack the gem to a regular application? can I use inheritance in an unintrusive way?</p>\n\n<p>What about pulling new updates from Github?</p>\n\n<p>Thank you </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","yaml","psych"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":4610,"score":6,"question_id":5843104,"title":"Rails 3 - 'Couldn't parse Yaml'","body":"<p>I don't know what I did wrong. I try to run 'rails c,' but it just gives me an error. It was working 10 minutes ago. :\\</p>\n\n<pre><code>C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse': couldn't parse YAML at line 2\n column 12 (Psych::SyntaxError)\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse_stream'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:119:in `parse'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:106:in `load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/configuration.rb:88:in `database_configuration'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:58:in `block (2 levels) in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `instance_eval'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `execute_hook'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:43:in `block in run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/base.rb:1904:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:32:in `block in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `call'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `block in load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `all'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:26:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:8:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds.rb:23:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","date","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":83,"score":1,"question_id":12405230,"title":"Active Admin date filter date format customisation","body":"<p>Is there simple way to change the ActiveAdmin date filter display format from the default ISO format (yyyy-mm-dd)? </p>\n"},{"tags":["ruby","error-handling","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13266533,"title":"How to rescue Aws::AwsError: NoSuchKey","body":"<p>I've been struggling with this for way to long - </p>\n\n<pre><code>def aws_file_exists? filename\n begin\n   @s3_interface.get('bucket', filename)\n   return true\n catch Aws::AwsError, Aws::AwsError2, NoSuchKey, RuntimeError, AmazonError, AWSError\n   return false\n end\nend\n</code></pre>\n\n<p>Only, it <em>doesn't catch the !(</em>@^%@&amp;$*%# <em>error</em>, which reports as:</p>\n\n<pre><code>Aws::AwsError: NoSuchKey: The specified key does not exist.\n</code></pre>\n\n<p>What am I doing wrong / what is the error type that I need to be catching?</p>\n"},{"tags":["ruby","curl","local","bin"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":19,"score":0,"question_id":13266370,"title":"export PATH=/usr/local/bin:$PATH curl failed","body":"<p>I am installing NetworkX and follow the article: <a href=\"http://www.thisisthegreenroom.com/2011/installing-python-numpy-scipy-matplotlib-and-ipython-on-lion/\" rel=\"nofollow\">http://www.thisisthegreenroom.com/2011/installing-python-numpy-scipy-matplotlib-and-ipython-on-lion/</a></p>\n\n<p>When I put: </p>\n\n<p><code>export PATH=/usr/local/bin:$PATH</code></p>\n\n<p>to .bash_profile</p>\n\n<p>Then I found out the curl command no longer works. it says:</p>\n\n<pre><code>/usr/local/bin/curl: line 61: X/usr/local/bin/curl: No such file or directory\n/usr/local/bin/curl: line 61: /usr/local/bin/sed: No such file or directory\n/usr/local/bin/curl: line 65: /usr/local/bin/sed: No such file or directory\n/usr/local/bin/curl: line 125: /usr/local/bin/curl: error: `/usr/local/bin/.libs\n</code></pre>\n\n<h2>Could anyone tell me how could I fix this?</h2>\n\n<p>I started with: <code>ruby &lt;(curl -fsSkL raw.github.com/mxcl/homebrew/go)</code>, it says, it seems homebrew has been installed, but it doesn't, because brew command does not find. </p>\n"},{"tags":["ruby","class","module","namespaces"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":51,"score":4,"question_id":13254443,"title":"What are the implications of A::B class name in ruby?","body":"<p>I have a class Entity and inside this class I used to have an inner class called Config.</p>\n\n\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Entity\n class Config\n end\nend\n</code></pre>\n\n<p>The Config class has grown quite big so I decided to take it out into its own file. However, I still wanted to retain the namespace so I prefixed the Config class with an Entity:: leaving me with two class in two different files like so.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code> #In entity.rb file\n class Entity\n   require 'entity_config.rb'\n end\n\n #In entity_config.rb file\n class Entity::Config\n end\n</code></pre>\n\n<p>Now I'm able to instantiate config with Entity::Config.new</p>\n\n<p>However, I don't understand the implications of namespacing the class name like that. Can somebody explain to me what really happens here?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13250607,"title":"Mobile Fu gem not working on ruby 1.8.7 / rails 2.3.14","body":"<p>Installing the gem following the instructions on <a href=\"http://rubygems.org/gems/mobile-fu\" rel=\"nofollow\">http://rubygems.org/gems/mobile-fu</a> (\"Simply add <code>gem 'mobile-fu'</code> to your Gemfile and run bundle install\") works OK, and the gem is listed as installed and all needed dependencies are also in place AFAIK, below is the relevant part of the projects Gemfile:</p>\n\n<pre><code>source :gemcutter\nsource 'http://gems.github.com'\n\ngem 'rails', '~&gt; 2.3.14'\ngem 'aslakjo-comatose', '2.0.5.12', :require =&gt; 'comatose'\ngem 'adamwiggins-rest-client', '1.0.4'\ngem 'ruby-hmac', '0.4', :require =&gt; 'hmac'\ngem 'ruby-net-ldap', '0.0.4', :require =&gt; 'net/ldap'\ngem 'will_paginate', '2.3.11'\ngem 'hpricot', '0.8.2'\ngem 'oauth', '0.3.6'\ngem 'sanitize', '1.1.0'\ngem 'sunspot_rails', '1.1.0', :require =&gt; 'sunspot/rails'\ngem 'htmlentities'\ngem 'rdoc', :require =&gt; 'rdoc'\ngem 'to_xls'\ngem 'pusher'\ngem 'jammit'\ngem 'rabl', '~&gt;0.6'\ngem 'paperclip', '~&gt; 2.7'\ngem 'aws-sdk', '~&gt; 1.3.4'\ngem 'mobile-fu', '~&gt; 1.1.0'\n...\n</code></pre>\n\n<p>Here is the resulting error message/log when starting the server: \"no such file to load -- mobile/fu (MissingSourceFile)\" being the main problem (IMHO):</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 2.3.14 application starting on http://0.0.0.0:3000\nNOTE: Gem.source_index is deprecated, use Specification. It will be removed on or after 2011-11-01.\nGem.source_index called from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/rails/gem_dependency.rb:21.\n/home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:74:in `require': no such file to load -- mobile/fu (MissingSourceFile)\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:74:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `each'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler.rb:128:in `require'\n    from /home/work/web/srv/config/boot.rb:116:in `load_gems'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:164:in `process'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `send'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `run'\n    from ./config/environment.rb:7\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:547:in `new_constants_in'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/web/srv/config.ru:1\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `instance_eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `initialize'\n    from /home/work/web/srv/config.ru:1:in `new'\n    from /home/work/web/srv/config.ru:1\n    from ./script/server:3:in `eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/commands/server.rb:78\n    from ./script/server:3:in `require'\n    from ./script/server:3\n</code></pre>\n\n<p><strong>Update 1</strong></p>\n\n<p>Using the solution described by Ben Langfeld (\"You can fix this using the following in your Gemfile: <code>gem 'mobile-fu', '~&gt; 1.1.0', :require =&gt; 'mobile-fu'</code>\") only produces a new error shown below:</p>\n\n<pre><code>=&gt; Booting WEBrick\n=&gt; Rails 2.3.14 application starting on http://0.0.0.0:3000\nNOTE: Gem.source_index is deprecated, use Specification. It will be removed on or after 2011-11-01.\nGem.source_index called from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/rails/gem_dependency.rb:21.\n/home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require': no such file to load -- rails (MissingSourceFile)\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:547:in `new_constants_in'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/mobile-fu-1.1.0/lib/mobile-fu.rb:1\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `each'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `each'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/bundler-1.2.1/lib/bundler.rb:128:in `require'\n    from /home/work/web/srv/config/boot.rb:116:in `load_gems'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:164:in `process'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `send'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/initializer.rb:113:in `run'\n    from ./config/environment.rb:7\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:547:in `new_constants_in'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/activesupport-2.3.14/lib/active_support/dependencies.rb:182:in `require'\n    from /home/work/web/srv/config.ru:1\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `instance_eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rack-1.1.3/lib/rack/builder.rb:46:in `initialize'\n    from /home/work/web/srv/config.ru:1:in `new'\n    from /home/work/web/srv/config.ru:1\n    from ./script/server:3:in `eval'\n    from /home/work/.rvm/gems/ruby-1.8.7-head@srv/gems/rails-2.3.14/lib/commands/server.rb:78\n    from ./script/server:3:in `require'\n    from ./script/server:3\n</code></pre>\n\n<p>There are no minimum versions of ruby or rails listed for this gem, but I suspect the problem is caused by the old versions we are running. However, upgrading ruby or rails is not an option, because this is a maintenance project.</p>\n\n<p>If any replacement gems for Mobile Fu with similar capabilities exists that is know to work on our ruby &amp; rails version/config, that is an alternate option we are willing to look into if this issue cannot be resolved.</p>\n"},{"tags":["ruby","rack","mysql2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13013748,"title":"How to persist mysql connection (mysql2 gem) with Ruby (no RoR)","body":"<p>I have a very simple web service using Rack, without Rails that I will contact MySQL on every valid connection. I want to persist the connection (for example in the constructor), so that on every request I reuse it. Lets say something like this:</p>\n\n<pre><code>  class Service\n\n    def initialize(dbhost, dbport, dbname, dbuser, dbpass)\n      @client = Mysql2::Client.new(\n          :host =&gt; dbhost, \n          :port =&gt; dbport, \n          :database =&gt; dbname,\n          :username =&gt; dbuser, \n          :password =&gt; dbpass)\n    end\n\n    def call(env)\n       # some logic that will call:\n       results = _query(sql)\n    end\n\n    def _query(sql)\n      results = @client.query(sql)\n    end\n\n  end\n\n  Rack::Handler::Mongrel.run Service.new(DB_HOST, DB_PORT, DB_NAME, DB_USER, DB_PASS), :Port =&gt; 8123  \n</code></pre>\n\n<p>With the code above, the service will obtain a MySQL connection and on every request it will do a query. But how do I make sure that if the connection drops, the <code>_query</code> method will reconnect?</p>\n"},{"tags":["ruby","vim"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":63,"score":3,"question_id":13259173,"title":"Vim taking really long time to open Ruby files","body":"<p>I've noticed that Vim is taking a really long time to open Ruby and ERB (Embedded Ruby) files. I profiled my startup time and these the interesting lines (the full profile is at the bottom if you want   to see it):</p>\n\n<pre><code>32980.181  32011.917  32011.917: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin/ruby.vim\n32980.516  32035.414  022.871: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin/eruby.vim\n</code></pre>\n\n<p>As you can see it takes a long time (times are in \"msec\" apparently) to load ftdetect for Ruby and ERuby. Compare this to ftdetect for HTML and the time it takes to load my .vimrc:</p>\n\n<pre><code>952.223  000.626  000.626: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin/html.vim\n738.536  612.248  534.785: sourcing $HOME/.vimrc\n</code></pre>\n\n<p>Is this normal and is there anything I can do about it? It's pretty infuriating to have to wait ~33 seconds to open a file.</p>\n\n<pre><code>times in msec\n clock   self+sourced   self:  sourced script\n clock   elapsed:              other lines\n\n000.022  000.022: --- VIM STARTING ---\n012.064  012.042: Allocated generic buffers\n012.910  000.846: locale set\n013.186  000.276: clipboard setup\n013.203  000.017: window checked\n033.918  020.715: inits 1\n034.697  000.779: parsing arguments\n034.716  000.019: expanding arguments\n077.784  043.068: shell init\n079.520  001.736: Termcap init\n079.562  000.042: inits 2\n080.186  000.624: init highlight\n179.889  001.991  001.991: sourcing /Users/davidtuite/.vim/autoload/pathogen.vim\n564.261  000.178  000.178: sourcing /Users/davidtuite/.vim/filetype.vim\n632.475  000.389  000.389: sourcing /Users/davidtuite/.vim/bundle/jst/ftdetect/jst.vim\n633.141  055.478  055.089: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/filetype.vim\n660.587  000.236  000.236: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin.vim\n661.081  000.247  000.247: sourcing /Users/davidtuite/.vim/filetype.vim\n661.408  000.041  000.041: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/filetype.vim\n673.005  000.208  000.208: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/indent.vim\n699.170  000.901  000.901: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/syncolor.vim\n699.550  007.236  006.335: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/synload.vim\n699.669  008.305  001.069: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/syntax.vim\n700.763  000.561  000.561: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/syncolor.vim\n715.774  000.497  000.497: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/syncolor.vim\n716.658  000.452  000.452: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/syncolor.vim\n722.467  010.218  009.269: sourcing /Users/davidtuite/.vim/bundle/solarized/colors/solarized.vim\n738.536  612.248  534.785: sourcing $HOME/.vimrc\n738.593  046.159: sourcing vimrc file(s)\n784.522  000.859  000.859: sourcing /Users/davidtuite/.vim/bundle/ctrlp/autoload/ctrlp/mrufiles.vim\n785.378  045.922  045.063: sourcing /Users/davidtuite/.vim/bundle/ctrlp/plugin/ctrlp.vim\n816.261  000.454  000.454: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/getscriptPlugin.vim\n818.593  000.792  000.792: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/gzip.vim\n820.050  000.921  000.921: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/matchparen.vim\n830.405  002.463  002.463: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/netrwPlugin.vim\n843.038  000.145  000.145: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/rrhelper.vim\n850.425  000.293  000.293: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/spellfile.vim\n851.617  000.671  000.671: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/tarPlugin.vim\n852.558  000.509  000.509: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/tohtml.vim\n853.470  000.599  000.599: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/vimballPlugin.vim\n854.255  000.463  000.463: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/plugin/zipPlugin.vim\n854.362  062.537: loading plugins\n854.375  000.013: inits 3\n875.931  021.556: reading viminfo\n875.995  000.064: setting raw mode\n876.010  000.015: start termcap\n876.062  000.052: clearing screen\n952.223  000.626  000.626: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin/html.vim\n32980.181  32011.917  32011.917: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin/ruby.vim\n32980.516  32035.414  022.871: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/ftplugin/eruby.vim\n33007.912  000.688  000.688: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/indent/ruby.vim\n33024.997  001.804  001.804: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/indent/html.vim\n33025.207  025.843  023.351: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/indent/eruby.vim\n33067.541  000.929  000.929: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/javascript.vim\n33085.205  004.486  004.486: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/vb.vim\n33088.445  002.575  002.575: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/css.vim\n33089.314  039.262  031.272: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/html.vim\n33106.920  003.463  003.463: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/ruby.vim\n33107.112  064.122  021.397: sourcing /usr/local/Cellar/vim/7.3.266/share/vim/vim73/syntax/eruby.vim\n33107.888  107.447: opening buffers\n33108.114  000.226: BufEnter autocommands\n33108.117  000.003: editing files in windows\n33108.319  000.202: VimEnter autocommands\n33108.320  000.001: before starting main loop\n33127.031  018.711: first screen update\n33127.033  000.002: --- VIM STARTED ---\n</code></pre>\n"},{"tags":["ruby","windows-7","v8","therubyracer","less-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13265504,"title":"Installing ruby gem less-rails on windows machine using therubyracer","body":"<p>since a while I am trying to install the less-rails gem on my windows7 machine.</p>\n\n<p>I already managed to install the needed therubyracer.gem using this binary file: \n<a href=\"https://github.com/stereobooster/therubyracer/downloads\" rel=\"nofollow\">https://github.com/stereobooster/therubyracer/downloads</a></p>\n\n<p>I also downloaded the v8.dll and put in my ruby/bin directory. So far everything works well, the bundle install is running and the server starting without any problems.</p>\n\n<p>But as soon as I request a page using a less file I get the following error message</p>\n\n<blockquote>\n  <p>undefined method `in_javascript?' for #\"&lt;\"V8::Error: [object Object]></p>\n</blockquote>\n\n<p>My css.file is alomst empty</p>\n\n<pre><code>/*\n*= require 'custom_less/custom'\n*= require 'jquery-ui-1.8.24.custom'\n*/\n</code></pre>\n\n<p>The custom.css.less looks like this</p>\n\n<pre><code>@import \"twitter/bootstrap/reset\";\n@import \"twitter/bootstrap/variables\";\n@import \"custom_less/variables\";                 // Your own variable overrides.\n@import \"twitter/bootstrap/mixins\";\n@import \"custom_less/mixins\";                    // Your own mixin.\n@import \"twitter/bootstrap/scaffolding\";\n@import \"twitter/bootstrap/grid\";\n@import \"twitter/bootstrap/layouts\";\n//import of further bootstrap components\n//but nothing else\n</code></pre>\n\n<p>I am using the rails installer with ruby 1.9.3.</p>\n\n<p>There are not many problem description like this. All I found was solved by updating to at least ruby 1.9.2. But that unfortunately is not the solution for me. Does somebody have an idea?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13261376,"title":"Include ERB delimiters inside of a string in an ERB block","body":"<p>I am working on a style guide which displays the code, as well as the output. It is currently structured so that the code only needs to be described once, and is displayed in both its raw and interpreted versions, like so:</p>\n\n<pre><code>&lt;% code = &lt;&lt;PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n&lt;div&gt;\n  #{ image_tag 'image.png' }\n&lt;/div&gt;  \nPLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n%&gt;\n\n&lt;%= raw code %&gt;\n&lt;%= content_tag :pre, code, class: \"prettyprint linenums\" %&gt;\n</code></pre>\n\n<p>This is great, and fairly easy to maintain. The problem comes in with the rails helpers, like <code>image_tag</code> in the above example. The view example correctly displays an image in a div, and the code example displays the relevant HTML. In this case, the relevant HTML includes an anchor tag - the results of the <code>image_tag</code> method, not the call itself.</p>\n\n<p>I would prefer the code examples to display the helper methods, rather that their results. I am able to make this work by specifying the example code in a file, and either rendering or reading the file. I would prefer to make this work by specifying the code in a variable, as above, but I can't seem to get an ERB delimiter to work inside of a string inside of an erb block. Even the simplest case of <code>&lt;% foo = '&lt;%= bar %&gt;' %&gt;</code> doesn't work at all. I've tried playing with the syntax (<code>&lt;%% %%&gt;</code> and <code>% %</code> for example), using details from the <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html\" rel=\"nofollow\">official documentation</a>, without much success.</p>\n\n<p>The only information I could find on the matter is <a href=\"http://markmail.org/message/gpz5bpqvbclogo7a\" rel=\"nofollow\">here</a>, using <code>&lt;%= \"&lt;\" + \"%=\" %&gt; link_to &lt;%= image.css_tag.humanize %&gt; &lt;%= \"%\" + \"&gt;\" %&gt; %&gt;</code>, which does not work in this use case (if at all).</p>\n\n<p>So, is there a way to specify a string that contains a ERB end-delimiter (<code>%&gt;</code>) in an ERB string, or am I stuck using the slightly clunkier file-read method? Thanks!</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>What I would like to end up with is a working version of this:</p>\n\n<pre><code>&lt;%# Idealized code - does not work %&gt;\n&lt;% code = &lt;&lt;PLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n&lt;div&gt;\n  &lt;% image_tag 'image.png' %&gt;\n&lt;/div&gt;  \nPLACE_THE_EXAMPLE_CODE_BETWEEN_THESE_TWO_LINES_EXACTLY_AS_YOU_WANT_IT_TO_APPEAR\n%&gt;\n</code></pre>\n\n<p>So that <code>&lt;%= raw code %&gt;</code> would (continue to) output:</p>\n\n<pre><code>&lt;div&gt;\n  &lt;img src=\"/images/image.png\" alt=\"Image\" /&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And <code>&lt;%= content_tag :pre, code, class: \"prettyprint linenums\" %&gt;</code> would output:</p>\n\n<pre><code>&lt;pre class=\"prettyprint linenums\"&gt;\n  &lt;div&gt;\n    &lt;% image_tag 'image.png' %&gt;\n  &lt;/div&gt;  \n&lt;/pre&gt;\n</code></pre>\n\n<p>Instead of what it currently does when using a variable, which is:</p>\n\n<pre><code>&lt;pre class=\"prettyprint linenums\"&gt;\n  &lt;div&gt;\n    &lt;img src=\"/images/image.png\" alt=\"Image\" /&gt;\n  &lt;/div&gt;\n&lt;/pre&gt;\n</code></pre>\n\n<p>I want users to be able to copy the code example and paste it into a new view, without having to translate HTML back into the helpers that produce them. I think what I basically need is an alternative ERB delimiter, in the same way that <code>'</code> and <code>\"</code> (or even <code>%q{}</code>) vary for strings. It seems that even though the final ERB delimiter is occurring inside of a string, it is being actually processed as the end of the block. The simplest case of <code>&lt;% foo = '&lt;%= bar %&gt;' %&gt;</code> demonstrates somewhat what I want to accomplish. In a generator, you might use <code>&lt;% foo = '&lt;%%= bar %&gt;' %&gt;</code> (or something similar), to tell it not to process as ERB right then and there. This all works fine when reading from a file, or even in a pure rb file (like a helper), but it makes the most sense to put it in the view, in this case, as it is intended to be easily manipulated by our designers.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13264208,"title":"group by in active records","body":"<p>I have one instance variable with two records. </p>\n\n<pre><code>           id   item_with_detail_id  quantity\n\n           100       205                3\n\n\n           101       205                5\n</code></pre>\n\n<p>Now, i want the result as follows using Active record group_by .</p>\n\n<pre><code>           100       205                8\n</code></pre>\n\n<p>i tried with </p>\n\n<pre><code>@bill_details=@bill_details.group_by{|bd| bd.item_with_detail_id}.values.map(&amp;:first)\n</code></pre>\n\n<p>but its not working. Please help me to achieve the result.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","html5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13264243,"title":"how to use Use images (html tag)in message body of net smtp in ruby on rails?","body":"<p>I m developing web application using Ruby on Rails. I want to display an image in mail using net/smtp..\nmy code is...</p>\n\n<pre><code>msgstr = &lt;&lt;END_OF_MESSAGE\nFrom: Your Name &lt;your@mail.address&gt;\nTo: Destination Address &lt;someone@example.com&gt;\nMIME-Version: 1.0\nContent-type: text/html\nSubject: test message\nDate: Sat, 23 Jun 2001 16:26:43 +0900\nMessage-Id: &lt;unique.message.id.string@example.com&gt;\n&lt;img src = \"/my_proj/public/images/logo.jpeg\" alt= \"logo\"&gt;\n&lt;b&gt;  This is a test message.&lt;/b&gt;\nEND_OF_MESSAGE\n\nrequire 'net/smtp'\nNet::SMTP.start('your.smtp.server', 25) do |smtp|\n  smtp.send_message msgstr,\n                    'your@mail.address',\n                    'his_addess@example.com'\nend\n</code></pre>\n\n<p>It is sending mail with all tags but not displaying th image while displaying alternate text. I hav put jpeg file every where n tested it.. but its not gettng the path of file and diplying the alternate text. Please anyone help me.. how to define path of file... or where to put this image file.\nI have changed</p>\n\n<pre><code>Content-type: text/html image/jpeg\n</code></pre>\n\n<p>but still its not working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13264111,"title":"Trying to validate a date","body":"<p>I have a form where i'm trying to validate that a field called \"birthday\" is not blank, and that the date is a valid date format that the Chronic gem can parse. I always get the error message \"Birthday is invalid\". I've been trying a simple format \"10/10/2010\".</p>\n\n<p>How can i validate that the birthday field is of a format that chronic can parse?</p>\n\n<p>User.rb model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  validates :birthday, :presence =&gt; true\n  validate :birthday_is_date\n  validate :position, :presence =&gt; true\n\n  # validate the birthday format\n  def birthday_is_date\n    errors.add(:birthday ,Chronic.parse(birthday)) # testing to see the value of :birthday\n    errors.add(:birthday, \"is invalid test message\") if ((Chronic.parse(:birthday) rescue ArgumentError) == ArgumentError)\n  end\nend\n</code></pre>\n\n<p>contacts_controller.rb </p>\n\n<pre><code># POST /contacts/1/edit\n    # actually updates the users data\n    def update_user\n        @userProfile = User.find(params[:id])\n\n        respond_to do |format|\n            if @userProfile.update_attributes(params[:user])\n                format.html {\n                    flash[:success] = \"Information updated successfully\"\n                    redirect_to(profile_path)\n                }\n            else \n                format.html {\n                    flash[:error] = resource.errors.full_messages\n\n                    render :edit\n                }\n            end\n        end\n    end\n</code></pre>\n"},{"tags":["ruby","index","iteration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13263354,"title":"Calculations on the iteration count in for loop","body":"<p>I was playing around with Ruby and Latex to create a color coding set for a registor. I have the following block of code. When attempting to run this, <code>band1</code> = <code>1e+02.</code></p>\n\n<p>I tried <code>band1</code> = <code>(BigDecimal(i) * 100).to_f</code>, thinking maybe there was some odd floating point issue.  An integer multiplied by an integer should create an integer.  I tried a variety of other things as well, but to no avail.</p>\n\n<pre><code>(1..9).each do |i|       #Band 1\n  (0..9).each do |j|     #Band 2\n    (0..11).each do |k|  #Band 3\n      #Band 3 Start\n      #these are the colors of the resistor bands\n      b1 = $c_band12[i]\n      b2 = $c_band12[j]\n      b3 = $c_band3[k]\n      b4 = \"Gold\"\n\n      oms = ((i*100) + (j*10)) * $mult[k]\n      band1 = i*100\n      band2 = j\n      band3 = $mult[k]\n    end\n  end\nend\n</code></pre>\n\n<p>Not sure what I'm missing.  Should I be using <code>each_with_index</code> through these iterations?  I  tried this:</p>\n\n<pre><code>(1..9).each_with_index {|i, indexi|       #Band 1\n  (0..9).each_with_index {|j, indexj|     #Band 2\n    (0..11).each_with_index {|k, indexk|  #Band 3\n      #Band 3 Start\n      #these are the colors of the resistor bands\n      b1 = $c_band12[i]\n      b2 = $c_band12[j]\n      b3 = $c_band3[k]\n      b4 = \"Gold\"\n\n      oms = ((i*100) + (j*10)) * $mult[k]\n      band1 = indexk * 100\n</code></pre>\n\n<p>and I got the same answer. I can't see why <code>1*100</code> should equate to such a large number.</p>\n\n<p>edit: Additional info:  If I have this: <code>band1=i*10</code> \nthen the calculation is correct. In fact, the calculation is correct up to 99.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","migration"],"answer_count":7,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":119,"score":6,"question_id":13168450,"title":"Rails creating migration to add columns to table causes error when running rake db:migrate","body":"<p>I have a model created called \"users\" and i created a new migration to add some columns to the  users table. Now when i run rake db:migrate, I get the error below b/c it's trying to create the users table again</p>\n\n<pre><code>$ rake db:migrate\n==  DeviseCreateUsers: migrating ==============================================\n-- create_table(:users)\nrake aborted!\nAn error has occurred, all later migrations canceled:\n\nMysql::Error: Table 'users' already exists: CREATE TABLE `users`.....\n</code></pre>\n\n<p>Why is it trying to create the table again?</p>\n\n<p>Here's the command i used to create the new migration</p>\n\n<pre><code>$ rails generate migration AddDetailsToUsers home_phone:decimal cell_phone:decimal work_phone:decimal birthday:date home_address:text work_address:text position:string company:string\n</code></pre>\n\n<p>The new migration looks like this:</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>20120511224920_devise_create_users</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Database authenticatable\n      t.string :email,              :null =&gt; false, :default =&gt; \"\"\n      t.string :username,           :null =&gt; false, :default =&gt; \"\"\n      t.string :encrypted_password, :null =&gt; false, :default =&gt; \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, :default =&gt; 0\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Encryptable\n      # t.string :password_salt\n\n      ## Confirmable\n      # t.string   :confirmation_token\n      # t.datetime :confirmed_at\n      # t.datetime :confirmation_sent_at\n      # t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, :default =&gt; 0 # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n      ## Token authenticatable\n      # t.string :authentication_token\n\n\n      t.timestamps\n    end\n\n    add_index :users, :email,                :unique =&gt; true\n    add_index :users, :reset_password_token, :unique =&gt; true\n    # add_index :users, :confirmation_token,   :unique =&gt; true\n    # add_index :users, :unlock_token,         :unique =&gt; true\n    # add_index :users, :authentication_token, :unique =&gt; true\n  end\nend\n</code></pre>\n\n<p>20120619023856_add_name_to_users</p>\n\n<pre><code>class AddNameToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :first_name, :string\n    add_column :users, :last_name, :string\n  end\nend\n</code></pre>\n\n<p>20121031174720_add_details_to_users.rb</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n"},{"tags":["ruby","rabbitmq","amqp"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13262738,"title":"redelivery after ACK","body":"<p>Why are my RabbitMQ messages being redelivered to my consumer after they have been ACKd? I'm new to RabbitMQ; I must be misusing it, or there's something wrong perhaps with the Ruby amqp gem.</p>\n\n<p>I have a ruby script that subscribes to a queue and acks each message. If I let it make it all the way through the messages, the messages really do disappear from the queue; they're not redelivered. But if I interrupt my script before they're all ACKd, and then start the script again, delivery starts anew from the first message. </p>\n\n<p>The behavior I'm seeing in code is reflected accurately by the RabbitMQ web management interface; the queue has messages, and despite the ACKs, they don't disappear.</p>\n\n<p>Clue: I put about 5000 messages in the queue. If I let the consumer ACK a significant amount, a few messages do actually appear to be removed from the queue (contrary to what I said above). I haven't been able to nail this phenomenon down.</p>\n\n<p>I'm using ruby 1.9.3, RabbitMQ 2.8.7, and the amqp ruby gem 0.9.8. It happens with producer and consumer on Ubuntu 12.0.4, or on Mac OS 10.7.4.</p>\n\n<p>What the heck??</p>\n\n<p>Here's the code for the consumer:</p>\n\n<pre><code># encoding: utf-8\nrequire \"rubygems\"\nrequire 'amqp'\nrequire 'aws-sdk'\n\nqueue_name = \"some.queue\"\nbegin\n  AMQP.start(\"amqp://localhost:5672\") do | connection |\n    channel  = AMQP::Channel.new(connection)\n    queue = channel.queue(queue_name, :durable =&gt; true)\n    queue.subscribe(:ack =&gt; true) do | metadata, payload |\n      metadata.ack\n    end\n  end\nend\n</code></pre>\n\n<p>and here's the producer:</p>\n\n<pre><code># encoding: utf-8\nrequire \"rubygems\"\nrequire 'amqp'\nrequire 'aws-sdk'\n\nmsg = ARGV[0]\nqueue_name = \"some.queue\"\nbegin\n  AMQP.start(\"amqp://localhost:5672\") do | connection |\n    channel  = AMQP::Channel.new(connection)\n    queue    = channel.queue(queue_name, :durable =&gt; true)\n    (1..5000).each do | x |\n      channel.default_exchange.publish x, :routing_key =&gt; queue_name, :persistent =&gt; true\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby","elasticsearch","tire"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13245807,"title":"Elasticsearch : How to match non existant tags","body":"<p>Lets say I have a set of document which have a-z as keys.\nAnd I am firing this term query:</p>\n\n<pre><code>curl -X GET localhost:9200/memphis/pincode/_search?pretty=json -d '{\"query\":{\"term\":{\"a\":\"abcd\", \"b\":\"wxyz\"}}}'\n</code></pre>\n\n<p>This will return me all the documents for which the value of 'a' is abcd and the value of 'b' is wxyz.\nBut, what if I want all the such documents in return for which (the value of 'a' is abcd and the value of 'b' is wxyz) or (the value of 'a' is abcd and tag 'b' doesn't exist) or (tag a doesn't exist and the value of 'b' is wxyz).</p>\n\n<p>Is this possible.</p>\n\n<p>I am working in ruby and am using 'Tire' gem to connect to elasticsearch. So would be more helpful if I get the corresponding syntax for tire as well.</p>\n\n<p>Thanks In Advance</p>\n\n<p>-Azitabh</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":20,"score":0,"question_id":13263305,"title":"ruby: execution order in block","body":"<p>I understand what is happening in this skip_tracks method, however, I never could have written it this way, because I don't understand the rule underlying the behavior in the block. This is the part that's puzzling me</p>\n\n<pre><code> skip.times { playlist.push playlist.shift}\n</code></pre>\n\n<p>Is there a rule that it executes right to left, so that the value that's shifted is returned and pushed onto playlist? How does one know the value that's shifted is going to be pushed onto playlist? What's happening inside the block to make this a rule?  Can you explain...Also, if this block had been written over multiple lines, playlist.push would have been above playlist.shift, and therefore executed first, but this code requires that the value be shifted before pushed</p>\n\n<hr>\n\n<pre><code>def skip_tracks(playlist, skip)\n  if skip &gt; 0\n    skip.times { playlist.push playlist.shift}\n  else\n    skip.abs.times { playlist.unshift playlist.pop }\n  end\n  puts playlist\nend\n\n\nplaylist = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l']\nskip_tracks(playlist, 2)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","associations"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13262543,"title":"Issue with association creates","body":"<p>Here are my associations...</p>\n\n<pre><code>Account has_many :credits\nCredit belongs_to :account\n</code></pre>\n\n<p>And I'm trying to run: <code>account.credits.current</code></p>\n\n<p>So, in that case, I've already got an <code>Account</code> object, and then I want to access a <code>current</code> method within the <code>Credit</code> model.</p>\n\n<p>Here is that method...</p>\n\n<pre><code>def self.current\n   # Find current credit line\n   current = self.where(:for_date =&gt; Time.now.strftime(\"%Y-%m-01\")).first\n\n   # If we couldn't find a credit line for this month, create one\n   current = Credit.create(:account_id =&gt; self.account.id, :for_date =&gt; Time.now.strftime(\"%Y-%m-01\")) if current.blank?\n\n   # Return the object\n   current\nend\n</code></pre>\n\n<p>The problem is on that second line...the one that should create a new credit entry if it can't find one. Specifically, I can't set what account it should be associated with. I just get an <code>undefined method 'account'</code> error.</p>\n"},{"tags":["ruby","rspec","erlang","bdd"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13263087,"title":"Any RSpec like tool for Erlang?","body":"<p>Is there something like RSpec <code>describe</code> <code>it</code> framework for Erlang?</p>\n"},{"tags":["c#","ruby","openssl","padding","ruby-1.9.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13241489,"title":"How to set Padding Mode with Ruby/OpenSSL decryption / encryption?","body":"<p>I am starting with the following <code>C#</code> encryption code, and want to decrypt with <code>Ruby</code>. My problem is that I don't know how to set the padding mode in <code>Ruby/OpenSSL</code>. I specifically need to use <code>PKCS7</code>.</p>\n\n<p><strong>C# encryption</strong></p>\n\n<pre><code>System.Security.Cryptography.Aes c = new System.Security.Cryptography.AesManaged();\nc.Mode = CipherMode.CBC;\nc.Padding = PaddingMode.PKCS7;   # &lt;-- how to set this in Ruby world?\nc.KeySize = 256;\nc.BlockSize = 128;\nc.Key = key;\nc.IV = iv;\n...\n</code></pre>\n\n<p><strong>Ruby decryption</strong></p>\n\n<pre><code>d = OpenSSL::Cipher.new('AES-128-CBC') # oops, this should have been AES-256-CBC\nd.decrypt\nd.key = key\nd.iv  = iv\n...\n</code></pre>\n\n<p>I am currently using <code>Ruby 1.9.2</code>, but can use whatever version necessary.</p>\n"},{"tags":["ruby","lua","converter"],"answer_count":2,"favorite_count":3,"up_vote_count":8,"down_vote_count":2,"view_count":87,"score":6,"question_id":13262319,"title":"How can I convert Ruby to Lua?","body":"<p>Is there any way to <strong>automatically</strong> convert Ruby code to Lua? My question is:</p>\n\n<ol>\n<li>What kinds of tools exist for this purpose?</li>\n<li>What are their limitations? </li>\n</ol>\n\n<p>One primary goal of this is to be able to bypass the Ruby interpreter when I execute the (converted to) Lua program. I don't mind if the Ruby interpreter needs to be invoked during the conversion process to Lua, but I don't want to have to rely on the Ruby interpreter when I run the newly generated Lua code.</p>\n\n<hr>\n\n<p>UPDATE:</p>\n\n<p>I've done quite a bit research into this topic and I <em>personally</em> am not finding a solution (which is why I'm asking the question here on StackOverflow).</p>\n\n<p>In case anyone is curious, I've looked deeply into:</p>\n\n<ul>\n<li><strong><a href=\"https://github.com/glejeune/ruby-lua\" rel=\"nofollow\">Ruby-Lua</a></strong>, though all this does is allow you to call Lua from Ruby</li>\n<li><strong><a href=\"https://github.com/whitequark/rlua\" rel=\"nofollow\">RLua</a></strong>, this allows you to run Ruby code from Lua and vise versa but it's not translating Ruby to Lua and it still invokes the Ruby interpreter on program run.</li>\n</ul>\n"},{"tags":["html","ruby","markdown"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13262456,"title":"html rendering in ruby","body":"<p>I am attempting to include a markdown file in my HTML.</p>\n\n<p>currently i have</p>\n\n<pre><code>Redcarpet::Markdown.new(Redcarpet::Render::HTML).render(\n  File.read(File.join(Dir.pwd, 'README.md'))\n)\n</code></pre>\n\n<p>Which brings in the contents just fine, aside from properly rendering the html.</p>\n\n<p>my source shows:</p>\n\n<p><code>&amp;lt;h1&amp;gt;Header&amp;lt;&amp;#47;h1&amp;gt;</code></p>\n\n<p>whcih shows the html markup in the browser:</p>\n\n<p><code>&lt;h1&gt;Header&lt;/h1&gt;</code></p>\n\n<p>I have been playing with this awhile.  Looking for answers always ends me up with rails html_safe helper, but i am not using rails.  I have tried CGI.unescapeHTML and HTMLEntities.  What am i missing here?</p>\n"},{"tags":["ruby","arrays"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":47,"score":1,"question_id":13262494,"title":"In Ruby how can I add a nested array to an array without creating an additional layer of nesting?","body":"<p>I'm trying to do something roughly analogous to this</p>\n\n<pre><code>collection = []\npair_one = [[:ae1,:be1],[:ae2,:be2]]\ncollection &lt;&lt; pair_one\npair_two = [[:ae3,:be3],[:ae4,:be4]]\ncollection &lt;&lt; pair_two\n</code></pre>\n\n<p>The problem is that <code>collection</code> is this:</p>\n\n<pre><code>[[[:ae1, :be1], [:ae2, :be2]], [[:ae3, :be3], [:ae4, :be4]]] \n</code></pre>\n\n<p>and I want it to be this:</p>\n\n<pre><code>[[:ae1, :be1], [:ae2, :be2], [:ae3, :be3], [:ae4, :be4]]\n</code></pre>\n\n<p>What method should I use instead of <code>&lt;&lt;</code>?</p>\n\n<p>Basically I want to add the <em>contents</em> of <code>pair_one</code> and <code>pair_two</code> to <code>collection</code>, rather than the arrays themselves.  What array method is escaping my memory?</p>\n"},{"tags":["ruby-on-rails","ruby","mongodb","callback","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13262269,"title":"Rails: How to implement this relation in Mongoid?","body":"<p>So I have 4 Models: <strong>Product, Sale, Ingredient &amp; Product_sale</strong></p>\n\n<p>The idea is to have a DB of different foods/dishes (the \"products\" model/DB) where I can store objects like hamburger, pizza and so on with their respective ingredients, and every time an order (sale) gets placed, a \"preparation\" (product_sale) should be created and this preparation should substract the respective ingredients from the ingredients \"inventory\" of the app, To be more clear:</p>\n\n<ul>\n<li>In the app, Users can create products such as Hamburger, Pizza and so\non</li>\n<li>We have an Ingredients inventory (DB/Model), where users capture ingredients\nquantities available</li>\n<li>A Hamburger has some ingredients such as pickles, patty, etc.</li>\n</ul>\n\n<p>Let's say we have 10 patties, I wanna substract 1 patty from the ingredients DB every time 1 normal burger is ordered and prepared. This is what I have so far:</p>\n\n<p><strong>Ingredient Model</strong></p>\n\n<pre><code>class Ingredient\n  include Mongoid::Document\n  belongs_to :product\n  has_many :product_sales\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :product_id, :type =&gt; String\n  field :ingredient_id, :type =&gt; String\nend\n</code></pre>\n\n<p><strong>Product Model:</strong></p>\n\n<pre><code>class Product\n  include Mongoid::Document\n  has_many :product_sales\n  has_many :ingredients\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :precio, :type =&gt; BigDecimal\n\n  validates_uniqueness_of :uniclave\nend\n</code></pre>\n\n<p><strong>ProductSale Model:</strong></p>\n\n<pre><code>class ProductSale\n  include Mongoid::Document\n\n  belongs_to :sale\n  belongs_to :product\n  belongs_to :ingredient\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :product_id, :type =&gt; String\n  field :sale_id, :type =&gt; String\n  field :ingredient_id, :type =&gt; String\n  field :precio, :type =&gt; BigDecimal\n\n\n  after_create :decrement_salchichapavo\n\n  def decrement_salchichapavo\n    self.ingredient.update_attribute(\"salchichapavo\", (ingredient.salchichapavo - self.salchichapavo))\n  end\n\nend\n</code></pre>\n\n<p><strong>Sale Model:</strong></p>\n\n<pre><code>class Sale\n  include Mongoid::Document\n  belongs_to :user\n  has_many :product_sales\n\n  field :salchichapavo, type: Integer\n  field :salsatomate, type: Integer\n  field :chipotle, type: Integer\n  field :mayonesa, type: Integer\n  field :salsatabasco, type: Integer\n  field :palillos, type: Integer\n  field :panbriosh, type: Integer\n  field :salchicha22cm, type: Integer\n  field :cebollacaramelizada, type: Integer\n  field :lechuga, type: Integer\n  field :pepino, type: Integer\n  field :vinagreta, type: Integer\n  field :tocino, type: Integer\n  field :queso, type: Integer\n  field :salsabbq, type: Integer\n  field :salchichares, type: Integer\n  field :panbaguette, type: Integer\n  field :jitomate, type: Integer\n  field :cerveza, type: Integer\n  field :pulque, type: Integer\n  field :qty, :type =&gt; Integer\n  field :type, :type =&gt; String\n  field :product_id, :type =&gt; String\n  field :sale_id, :type =&gt; String\n  field :ingredient_id, :type =&gt; String\n  field :precio, :type =&gt; BigDecimal\nend\n</code></pre>\n\n<p>But when I create a new productsale I get an </p>\n\n<pre><code>undefined method `salchichapavo' for nil:NilClass\n</code></pre>\n\n<p>Error, So I think something is wrong with the models... The idea is to have 1 after_create callback for each ingredient so everytime a product with X ingredients get prepared just those ingredients decrement.</p>\n\n<p>Can someone give me some advice?</p>\n\n<p>Thank you.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13262474,"title":"ruby file requires","body":"<p>Is it possible to require ruby files just in time?\nfor example you have a file following classes:</p>\n\n<pre><code>require \"bar\"\nclass Foo\nend\n\nrequire \"bar2\"\nclass Bar\nend\n\nrequire \"bar3\"\nclass Bar2\nend\n\nrequire \"foo\"\nclass Bar3\nend\n</code></pre>\n\n<p>Now I d like to just require the file \"bar\", if I call something in \"foo\", which needs stuff out of \"bar\". But if I require \"bar\" all the other files will be required also. Is there a way to require files just in time without Runtime Errors? Or is that already the way ruby does it? :)\nIn my case I have a lot of files, and these files all requires a lot of other stuff and sometimes each other. I want to reduce the load work.. Is there something like \"require only if\"?</p>\n"},{"tags":["ruby","liquid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13254613,"title":"How can I use Liquid without Rails?","body":"<p>How can I use <a href=\"https://github.com/Shopify/liquid\" rel=\"nofollow\" title=\"Liquid\">Liquid</a> without Rails? There is no information about this on <a href=\"https://github.com/Shopify/liquid/wiki/Using-liquid-without-rails\" rel=\"nofollow\" title=\"Using liquid without rails\">Liquid Wiki</a>.</p>\n"},{"tags":["javascript","ruby"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":527,"score":4,"question_id":6214610,"title":"Converting Ruby 1.9.2 code to JavaScript?","body":"<p>Is it possible to convert Ruby code to Javascript at all?\nI have heard of <a href=\"http://rubyforge.org/projects/rubyjs/\" rel=\"nofollow\">RubyJS</a> but this appears to not work with Ruby 1.9.2 - is this the case?</p>\n"},{"tags":["ruby-on-rails","ruby","mvc","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13262123,"title":"rails form_tag _path parameters","body":"<p>Although the question at '<a href=\"http://stackoverflow.com/questions/11762542/passing-multiple-parameters-in-a-form-tag\">Passing Multiple Parameters in a form_tag</a>' provides some information regarding how one can pass parameters within a form_tag the poster ultimately decided to pursue a different means of achieving said ends (specifically using hidden form fields).</p>\n\n<p>When attempting to use a line of code in a view like:</p>\n\n<pre><code>form_tag(movies_path({:foo = \"bar\"}), {:id =&gt; \"ratings_form\", :method =&gt; :get}) do\n</code></pre>\n\n<p>it seems as though RoR will not make the value of 'foo' available to the controller; is there another syntax which should be used to pass a parameter as part of the path in such a scenario?</p>\n\n<p>If one wishes to pass the parameter as part of the URL one would think such an approach would be correct (and, in fact, the HTML generated indicates as much since the resultant <code>&lt;form&gt;</code> tag contains an <code>action=\"/movies?foo=bar\"</code> statement)...  but the controller evaluates <code>params[:foo]</code> as <code>''</code> and not <code>bar</code>?)</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13261474,"title":"ruby modules and classes same name in structure","body":"<p>I have a folder structure like the following in one of my projects:</p>\n\n<ul>\n<li>lib\n<ul>\n<li>bar.rb</li>\n<li>bar\n<ul>\n<li>other_bar.rb</li>\n<li>another_bar.rb</li>\n<li>next_bar.rb</li>\n<li>...</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p><strong>bar.rb</strong></p>\n\n<pre><code>require File.expand_path(File.dirname(__FILE__) + \"/bar/other_bar.rb\")\n\nclass Bar\n  puts \"running BarBase\"\nend\n</code></pre>\n\n<p><strong>bar/other_bar.rb</strong></p>\n\n<pre><code>module Bar\n  class OtherBar\n    puts \"running module Bar with class OtherBar\"\n  end\nend\n</code></pre>\n\n<p>If I now run <code>ruby bar.rb</code> I get this:</p>\n\n<blockquote>\n  <p>running module Bar with class OtherBar<br>\n  bar.rb:3:in `': Bar is not a class (TypeError)</p>\n</blockquote>\n\n<p>I'd like to have a similar structure to a rails model inheritance structure. How can I fix this?  So far as I know ruby does not support this out of the box. Is there a workaround for such a situation?</p>\n"},{"tags":["ruby","mongodb","dynamic","mongoid"],"answer_count":5,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":196,"score":2,"question_id":11319867,"title":"List dynamic attributes in a Mongoid Model","body":"<p>I have gone over the documentation, and I can't find a specific way to go about this. I have already added some dynamic attributes to a model, and I would like to be able to iterate over all of them.</p>\n\n<p>So, for a concrete example:</p>\n\n<pre><code>class Order\n  include Mongoid::Document\n\n  field :status, type: String, default: \"pending\"\nend\n</code></pre>\n\n<p>And then I do the following:</p>\n\n<pre><code>Order.new(status: \"processed\", internal_id: \"1111\") \n</code></pre>\n\n<p>And later I want to come back and be able to get a list/array of all the dynamic attributes (in this case, \"internal_id\" is it).</p>\n\n<p>I'm still digging, but I'd love to hear if anyone else has solved this already.</p>\n"},{"tags":["ruby","emacs","refactoring"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":13254724,"title":"Is there some tool or mode for refactoring ruby code in emacs?","body":"<p>I am looking for some tool that supports me in refactoring ruby code.</p>\n\n<p>I know that it is very hard to implement these kind of tools for a dynamic language like ruby, but I also know there are different solutions for <a href=\"http://www.jetbrains.com/ruby/features/ruby_ide.html#Intelligent_Code_Improvement\" rel=\"nofollow\">RubyMine</a> and <a href=\"https://github.com/ecomba/vim-ruby-refactoring\" rel=\"nofollow\">Vim</a> to                              help with basic stuff like \"extract method\" and \"rename method\".</p>\n\n<p>It does not seem very practical to have multiple editors / IDEs open, so I am searching something specifically for emacs.</p>\n"},{"tags":["ruby","irb"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":58,"score":4,"question_id":13260905,"title":"How to get unstuck in Ruby irb?","body":"<p>I am using IRB. When I am coding I noticed that I get \"stuck\" when the line ends with \"<code>/</code>\":</p>\n\n<pre><code>irb(main):057:0/\n</code></pre>\n\n<p>When that happens I cannot do anything, I can't exit, define things, etc. It keeps looping back to lines that end in \"<code>/</code>\".</p>\n\n<p>But, when a line ends like this:</p>\n\n<pre><code>irb(main):056:0&gt;\n</code></pre>\n\n<p>everything seems to work fine. I can exit if needed, define anything, etc.</p>\n\n<p>How can I get unstuck when a line ends in \"<code>/</code>\"?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","bundle","mysql2"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4,"score":1,"question_id":13261360,"title":"Error with mysql2 gem loading Rails env on OSX: \"Symbol not found: _rb_prohibit_interrupt\"","body":"<ul>\n<li><p>I'm on OSX 10.7.5</p></li>\n<li><p>I'm setting up an existing Rails 3 app</p></li>\n<li><p>I've got the 64-bit dmg package of MySQL (v5.5.28) installed</p></li>\n<li><p>I've installed the mysql2 gem (v0.3.11) as part of the app bundle</p></li>\n</ul>\n\n<p>Whenever i try to load the rails env (raking, loading console, etc.), I get this:\nrake aborted!\ndlopen(/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle, 9): Symbol not found: _rb_prohibit_interrupt\n  Referenced from: /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle\n  Expected in: flat namespace\n in /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle - /Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2/mysql2.bundle\n/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2.rb:9:in <code>require'\n/Users/daretorant/.rvm/gems/ruby-1.9.3-p194@amp/bundler/gems/mysql2-f4d004ac5194/lib/mysql2.rb:9:in</code>'</p>\n\n<p>.........</p>\n\n<p>Things I've tried:</p>\n\n<ul>\n<li><p>other versions of mysql2</p></li>\n<li><p>fresh install of mysql itself</p></li>\n<li><p>cleaning my gemset</p></li>\n<li><p>cleaning rvm</p></li>\n<li><p>pulling hair out</p></li>\n</ul>\n\n<p>Help?</p>\n"},{"tags":["ruby","serialization"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13254312,"title":"Marshal class, is there a way to find whether a data is already serialized or not?","body":"<p>I am using <code>Marshal</code> class to serialize a Ruby object, using the functions: <code>dump()</code> and <code>load()</code> everything works well, but when a value not related to any serialized data is passed, the <code>load()</code> function returns the expected and logical error: </p>\n\n<pre><code>incompatible marshal file format (can't be read)\nformat version 4.8 required; 45.45 given\n</code></pre>\n\n<p>What I need is to check if this data had already been serialized or not before loading it. My goal is to avoid this error and do something else.</p>\n"},{"tags":["ruby","integer","puppet"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":30,"score":4,"question_id":13244792,"title":"convert ip address to 32 bit integer in ruby","body":"<p>I am trying to find a way to convert a ip address to a 32 bit integer in Ruby for a puppet template.</p>\n\n<p>This is how I did the conversion in bash.</p>\n\n<pre><code>root@ubuntu-server2:~# cat test.sh \n#!/bin/bash\n\n#eth0 address is 10.0.2.15\nprivip=`ifconfig eth0 | grep \"inet addr:\" | cut -d : -f 2 | cut -d \" \" -f 1` ;\n\necho \"Private IP: ${privip}\" ;\n\n# Turn it into unsigned 32-bit integer\n\nipiter=3 ;\n\nfor ipoctet in `echo ${privip} | tr . \" \"` ;\n    do\n    ipint=$(( ipint + ( ipoctet * 256 ** ipiter-- ) )) ;\n    done ;\n\necho \"Private IP int32: ${ipint}\" ;\n</code></pre>\n\n<p>.</p>\n\n<pre><code>root@ubuntu-server2:~# bash test.sh \nPrivate IP: 10.0.2.15\nPrivate IP int32: 167772687\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":12610726,"title":"How do I pass a text file or a string to a Ruby script and output the result in the command line?","body":"<p>As an exercise to learn Ruby, I would like to create a script that will be run from the terminal. It should accept as input either a string or a text file and it should output the result of various string parsing mechanisms that I will write myself.</p>\n\n<p>To get me started, would you please translate this pseudo-code into proper Ruby for me?</p>\n\n<ol>\n<li>In terminal: <code>ruby myscript.rb</code> (either a string or a text file).</li>\n<li>In myscript.rb: Retrieve input. Set <code>my_input</code> to the input.</li>\n<li>Set <code>my_output</code> to the result of <code>various_string_parsing_voodoo</code> (done to my_input).</li>\n<li><code>puts my_output</code></li>\n</ol>\n\n<p>I intend to actually write the code myself, but if someone could supply me with a skeleton .rb file to send in \"<code>Hello World</code>\" and get \"<code>[World] is pleased by your [hello]</code>\" or something equally inane that'd be a great help.</p>\n"},{"tags":["ruby-on-rails","ruby","unit-testing","testing","tdd"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13242587,"title":"Error between validate method in Model and Test:Unit assertion results","body":"<p>Ruby Noob - I've searched SO, read the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">Rails Guide on Testing</a>, and watched a <a href=\"http://railscasts.com/episodes/275-how-i-test\" rel=\"nofollow\">RailsCast</a> without luck. </p>\n\n<p>I'm unable to reconcile method associations with tests I've written. Currently (code below), both tests, one checking for presence of name and one checking for presence of email, pass without failure or error -- ok, seems good. </p>\n\n<p>If I remove both validates statements from the model, both tests fail -- also, makes sense. </p>\n\n<p>However, if I remove only <strong>ONE</strong> of either </p>\n\n<pre><code>validates :name, :presence =&gt; true\n</code></pre>\n\n<p><strong>OR</strong></p>\n\n<pre><code>validates :email, :presence =&gt; true\n</code></pre>\n\n<p>from the model, <strong>BOTH</strong> tests pass without failure. This result does not make sense to me. Have I created faulty tests? </p>\n\n<hr>\n\n<p>user.rb model:      </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :name \n\n  has_many :connections\n\n  validates :name, :presence =&gt; true\n  validates :email, :presence =&gt; true\nend\n</code></pre>\n\n<p>test/unit/user_test.rb</p>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n  test \"a user should have a name\" do\n    user = User.new\n    assert !user.save\n  end\n\n  test \"a user should have an email\" do\n    user = User.new\n    assert !user.save\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13259788,"title":"Creating a hierarchical, optgrouped, drop down list using Ruby on Rails","body":"<p>I am trying to create a drop down select list for a web application.\nThis list must have optgroups, must have indentation (using <code>--</code>), and the group names must be options themselves.  Since optgrouping is a requirement, I need to use one of the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html\" rel=\"nofollow\">group option helpers</a>.  Since everything is in one model, I chose <code>grouped_options_for_select</code>.</p>\n\n<p>I have a functional solution but it is messy.  Is there any way I can make this neater?  In particular, for the helper method <code>grouped_categories</code>, Is there a better way to create the nested array so that i do not need to call the database so many times?</p>\n\n<p>The View;</p>\n\n<pre><code>&lt;%= f.label :category_id %&gt;\n&lt;%= f.select :category_id, grouped_options_for_select(grouped_categories.map{ |group| [group.first.name, group.second.map{|c| [c.name, c.id]}]}) %&gt;\n</code></pre>\n\n<p>The Helper;</p>\n\n<pre><code>module CategoryHelper\n #building an array of elements (optgroup, members), where optgroup is one category object instance,\n # and members contains all category objects belonging to the optgroup, including the opt group object itself\n def grouped_categories\n   @grouped_array = []\n   Category.where(\"parent_id is null\").each do |g|\n     members = []\n     members &lt;&lt; g\n     Category.where(\"parent_id = ?\", g.id).each do |c|\n       indent_subcategory(c)\n       members &lt;&lt; c\n       Category.where(\"parent_id = ?\", c.id).each do |s|\n         indent_subsubcategory(s)\n         members &lt;&lt; s\n       end\n     end\n     group = [g, members]\n     @grouped_array &lt;&lt; group\n   end\n   @grouped_array\n end\n\n def indent_subcategory(cat)\n   cat.name = '--' + cat.name\n end\n\n  def indent_subsubcategory(cat)\n    cat.name = '----' + cat.name\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","exception-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13260609,"title":"Exception Handling: \"undefined method `____' for nil:NilClass\"","body":"<p>One of the most common reasons my web application fails is because a user sometimes lacks a certain attribute that a view expects it to have. For instance, most users in my application have an education (school, degree, etc.) entry in our system, but some users do not. Assuming my view looks something like this:</p>\n\n<pre><code>&lt;% @educations.each do |education| %&gt;\n  &lt;%= education.school %&gt;\n  &lt;%= education.degree %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to avoid \"Pokemon\" exception handling and feel that there has to be a better way around dealing with a \"undefined method `degree' for nil:NilClass\" error in the case that a user does not have an education entry in our database. This just seems like an ugly/tedious fix:</p>\n\n<pre><code>&lt;% @educations.each do |education| %&gt;\n  &lt;% if education.school %&gt;\n    &lt;%= education.school %&gt;\n  &lt;% end %&gt;\n  &lt;% if education.degree %&gt;\n   &lt;%= education.degree %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Any input is appreciated. Thank you!</p>\n"},{"tags":["ruby-on-rails","ruby","openssl","activemerchant"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13260720,"title":"openssl and ruby certificate verify failed (OpenSSL::SSL::SSLError)","body":"<p>I'm getting a certificate verify failed (OpenSSL::SSL::SSLError) error.</p>\n\n<ul>\n<li>ubuntu 12.04</li>\n<li>ruby 1.9.3</li>\n<li>openssl installed via rvm</li>\n</ul>\n\n<p>This command works ok</p>\n\n<blockquote>\n  <p>openssl s_client -CAfile ./ccapi.pem -connect ccapi.client.qvalent.com:443</p>\n</blockquote>\n\n<p>=>  <code>Verify return code: 0 (ok)</code></p>\n\n<p>Running a ruby script using activemerchant that calls out to the above site using same pem file</p>\n\n<pre><code>ruby pwtest.rb\n</code></pre>\n\n<p>=>  </p>\n\n<pre><code>credit card is valid!\n/home/rzolkos/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:799:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)\n</code></pre>\n\n<p>The script works fine on another server/local machine.</p>\n\n<p>Any tips on fixing or diagnosing appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","devise","gem","engine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":12913737,"title":"Rails mountable engine and devise","body":"<p>I have a mountable rails engine with Devise. When I copy my migrations and run rake db:migrate in the dummy app it works just fine. </p>\n\n<p>But when I use a new rails app, add my engine to the gem file, copy migrations and run rake db:migrate I get this error <code>\"uninitialized constant Devise\".</code> </p>\n\n<p>I have this in my routes file:</p>\n\n<pre><code>mount Cms::Engine, :at =&gt; '/', :as =&gt; 'cms'\n</code></pre>\n\n<p>What am I doing wrong ? </p>\n"},{"tags":["ruby-on-rails","ruby","cancan","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":335,"score":3,"question_id":8934892,"title":"Rails 3 ActiveAdmin. Hiding buttons according to CanCan permissions","body":"<p>I have ActiveAdmin and CanCan working together. I already set the administrator and customer permissions. </p>\n\n<p>Now I want to hide the New, Edit and Delete buttons according to the permissions set by CanCan but the following line gives me errors...</p>\n\n<pre><code>config.clear_action_items! :if =&gt; proc{can? (:destroy, Shipment)}\n</code></pre>\n\n<p>This one too</p>\n\n<pre><code>:if =&gt; proc{ can?(:destroy, Shipment)}, actions :all, :except =&gt; [:new, :create, :update, :edit, :destroy]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","console"],"answer_count":6,"favorite_count":12,"up_vote_count":23,"down_vote_count":0,"view_count":2746,"score":23,"question_id":4736546,"title":"Rails 3 OSX - Speed up Console Loading Time","body":"<p>I am wondering if there is any relatively easy way to speed up my console load time, which is starting to approach 30 seconds.  I have a lot of subclasses whose methods don't seem to be affected by <code>reload!</code> so I end up opening and closing the console a lot.  IRB loads lightning quick.  </p>\n\n<p>Do I have too many gems?  How do I go about timing the load tasks so I can see what is taking up the most time?  As you can see, I've already tried the dev-boost gem to no avail.  The app is fine in Passenger, it's just the console loading that bugs the crap out of me.  Running on MBP OSX 10.6.6 with 2.4GHz and 4GB RAM.  Not using RVM. </p>\n\n<p>Versions:</p>\n\n<pre><code>Ovid$ rails -v\nRails 3.0.3\nOvid$ ruby -v\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10]\n</code></pre>\n\n<p>Memory:</p>\n\n<pre><code>Ovid$ vm_stat\nMach Virtual Memory Statistics: (page size of 4096 bytes)\nPages free:                         118818.\nPages active:                       341320.\nPages inactive:                      99490.\nPages speculative:                  310576.\nPages wired down:                   112527.\n\"Translation faults\":             23097323.\nPages copy-on-write:               1270961.\nPages zero filled:                13836659.\nPages reactivated:                      36.\nPageins:                            165761.\nPageouts:                                0.\nObject cache: 28 hits of 760846 lookups (0% hit rate)\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.3'\ngem 'mysql2'\ngem 'foreigner'\ngem 'haml'\ngem 'capistrano'\ngem 'nokogiri'\n\n#web services\ngem 'yammer4r'\ngem 'ruby-freshbooks'\n\n#authentication gems from nifty generator\ngem \"bcrypt-ruby\", :require =&gt; \"bcrypt\"\ngem \"mocha\", :group =&gt; :test\ngem 'authlogic'\n\n#dev\ngroup :development do\n  gem 'rails-dev-boost', :git =&gt; 'git://github.com/thedarkone/rails-dev-boost.git', :require =&gt; 'rails_development_boost'\nend\n\n#testing\ngroup :test do\n  gem 'database_cleaner'\n  gem 'cucumber-rails'\n  gem 'cucumber'\n  gem 'rspec-rails'\n  gem 'spork'\n  gem 'launchy'\n  gem 'machinist'\n  gem 'faker'\n  gem 'capybara'\nend\n</code></pre>\n\n<p>Thank you very much!</p>\n"},{"tags":["java","ruby","hadoop","mapreduce","emr"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":249,"score":0,"question_id":9061120,"title":"EMR Streaming job using Java code for mapper and reducer","body":"<p>I currently have streaming jobs run with mapper and reducer code written in ruby. I want to convert these to java. I do not know how to run a streaming job with EMR hadoop using java. The sample given in amazon's EMR website of cloudburst is too complex. Following are the details of how I run the jobs currently.</p>\n\n<p>Code to start a job:</p>\n\n<pre><code>        elastic-mapreduce --create --alive --plain-output --master-instance-type m1.small \n--slave-instance-type m1.xlarge --num-instances 2  --name \"Job Name\" --bootstrap-action \n    s3://bucket-path/bootstrap.sh\n</code></pre>\n\n<p>Code to add a step:</p>\n\n<pre><code>    elastic-mapreduce -j &lt;job_id&gt; --stream --step-name \"my_step_name\" \n--jobconf mapred.task.timeout=0 --mapper s3://bucket-path/mapper.rb \n--reducer s3://bucket-path/reducerRules.rb --cache s3://bucket-path/cache/cache.txt \n--input s3://bucket-path/input --output s3://bucket-path/output\n</code></pre>\n\n<p>Mapper code reads from a csv file which is mentioned above as EMR's cache argument as well as it reads from the input s3 bucket which also has some csv files, does some calculations and prints a csv output lines to standard output.</p>\n\n<pre><code>//mapper.rb \nCSV_OPTIONS  = {\n  // some CSV options\n}\n\nbegin\n    file = File.open(\"cache.txt\")\n    while (line = file.gets)\n        // do something\n    end\n    file.close\nend\n\ninput  = FasterCSV.new(STDIN, CSV_OPTIONS)\ninput.each{ \n// do calculations and get result\nputs (result)\n}\n\n//reducer.rb\n\n$stdin.each_line do |line|\n// do some aggregations and get aggregation_result\nif(some_condition) puts(aggregation_result)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","rbenv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13259461,"title":"ruby / rails `rescue in debug=': (RuntimeError)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8251349/ruby-threadptr-data-type-error\">ruby_threadptr_data_type error</a>  </p>\n</blockquote>\n\n\n\n<p>I am new to Ruby / Rails, and having issues getting my environment setup on Ubuntu 12.04. I'm using rbenv (not rvm). Here is how i'm installing ruby:</p>\n\n<pre><code># clone rbenv and the ruby-build plugin\ngit clone git://github.com/sstephenson/rbenv.git .rbenv\ngit clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build\n\n# initialize rbenv\nexport PATH=~/.rbenv/bin:$PATH\nrbenv init -\n\n# install ruby 1.9.2\nrbenv install 1.9.2-p320\nrbenv rehash\n\n# change ruby version to 1.9.2\nrbenv global 1.9.2-p320\n</code></pre>\n\n<p>I am trying to run the following hello-world app:\n  <a href=\"https://github.com/renderedtext/base-app\" rel=\"nofollow\">https://github.com/renderedtext/base-app</a></p>\n\n<p>I am running the commands recommended on the website</p>\n\n<pre><code>bundle install\nbundle exec rake db:setup db:test:prepare\nbundle exec rake spec\nbundle exec rake cucumber\n</code></pre>\n\n<p>It fails at <code>bundle exec rake spec</code> with the following error:</p>\n\n<pre><code>NOTICE:  CREATE TABLE will create implicit sequence \"roles_id_seq\" for serial column \"roles.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"roles_pkey\" for table \"roles\"\nNOTICE:  CREATE TABLE will create implicit sequence \"users_id_seq\" for serial column \"users.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"users_pkey\" for table \"users\"\n/home/ubuntu/.rbenv/versions/1.9.2-p320/bin/ruby -S rspec ./spec/models/role_spec.rb ./spec/models/user_spec.rb ./spec/controllers/admin/base_controller_spec.rb ./spec/controllers/admin/users_controller_spec.rb ./spec/controllers/pages_controller_spec.rb ./spec/helpers/pages_helper_spec.rb\nNo DRb server is running. Running in local process instead ...\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:422:in `rescue in debug=':  (RuntimeError)\n**************************************************\n/var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.so: undefined symbol: ruby_threadptr_data_type - /var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.so\n\nIf you have it installed as a ruby gem, then you need to either require\n'rubygems' or configure the RUBYOPT environment variable with the value\n'rubygems'.\n\n/var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby-debug-base.rb:1:in `require'\n/var/lib/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby-debug-base.rb:1:in `&lt;top (required)&gt;'\n/var/lib/gems/1.9.1/gems/ruby-debug19-0.11.6/cli/ruby-debug.rb:5:in `require'\n/var/lib/gems/1.9.1/gems/ruby-debug19-0.11.6/cli/ruby-debug.rb:5:in `&lt;top (required)&gt;'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:408:in `require'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:408:in `debug='\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:20:in `block in configure'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `each'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `configure'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:21:in `run'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:66:in `rescue in run'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:62:in `run'\n/var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun'\n**************************************************\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:407:in `debug='\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:20:in `block in configure'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `each'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/configuration_options.rb:19:in `configure'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:21:in `run'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:66:in `rescue in run'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:62:in `run'\n    from /var/lib/gems/1.9.1/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun'\nrake aborted!\n/home/ubuntu/.rbenv/versions/1.9.2-p320/bin/ruby -S rspec ./spec/models/role_spec.rb ./spec/models/user_spec.rb ./spec/controllers/admin/base_controller_spec.rb ./spec/controllers/admin/users_controller_spec.rb ./spec/controllers/pages_controller_spec.rb ./spec/helpers/pages_helper_spec.rb failed\n\nTasks: TOP =&gt; spec\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>It is also important to note that the server seems to already have ruby 1.9.1 installed (presumably using apt-get) but I would like to use 1.9.2 which is why I installed rbenv.</p>\n\n<p>As a side note, I've also tried using rbenv with 1.9.3 and get the same error.</p>\n\n<p>I tried to research and apply answers from other stack overflow questions (like <a href=\"http://stackoverflow.com/questions/8251349/ruby-threadptr-data-type-error\">ruby_threadptr_data_type error</a>) but resulted in a segfault. Also, in my research most of the answers seemed to relate to rvm and 1.9.3 ... not rbenv and 1.9.2</p>\n\n<p>Please help!</p>\n"},{"tags":["ruby","sockets","udp","eventmachine"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":7,"score":1,"question_id":13260289,"title":"EventMachine RuntimeError in open_datagram_socket / open_udp_socket no datagram socket","body":"<p>The following error appears when I try to <code>open_datagram_socket</code> on port <code>1900</code>:</p>\n\n<pre><code>/Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:859:in `open_udp_socket': no datagram socket (RuntimeError)\nfrom /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:859:in `open_datagram_socket'\nfrom /Users/timbaas/Applications/ruby/upnp/ssdp.rb:36:in `block in initialize'\nfrom /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `call'\nfrom /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run_machine'\nfrom /Users/timbaas/.rvm/gems/ruby-1.9.3-p194/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run'\nfrom /Users/timbaas/Applications/ruby/upnp/ssdp.rb:35:in `initialize'\nfrom upnp.rb:4:in `new'\nfrom upnp.rb:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>I use the following code on Ruby 1.9.3:</p>\n\n<pre><code>module SSDP\n\n  IP = \"239.255.255.250\"\n  PORT = 1900\n\n  class Server &lt; EM::Connection\n    def receive_data(data)\n      p \"d\" + data\n    end\n  end\n\n  class Socket\n    attr_accessor :socket\n\n    def initialize\n      EventMachine::run do\n        @socket = EM::open_datagram_socket SSDP::IP, SSDP::PORT, SSDP::Server\n        p \"Started EchoServer on #{SSDP::IP}:#{SSDP::PORT}...\"\n      end\n    end\n  end\nend\n\nSocket.new\n</code></pre>\n\n<p>When I use port <code>1901</code> it works..</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13259910,"title":"Method for an item to reference its container","body":"<p>If I do the following, for example:</p>\n\n<pre><code>foo = [\"bar\"]\nfoo.keep_if {|n| foo.last.obect_id == n.object_id}\n</code></pre>\n\n<p>Is there another way I can refer to foo inside the block instead of naming it, something like \"n.container\"? </p>\n"},{"tags":["ruby","command-line"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2568,"score":1,"question_id":4244611,"title":"Pass variables to ruby script via command line","body":"<p>I've installed RubyInstaller on windows and I'm running this <a href=\"http://wonko.com/post/ruby_script_to_sync_email_from_any_imap_server_to_gmail\" rel=\"nofollow\">IMAP Sync</a> script but I need to use it to sync hundreds of accounts. If I could pass these vars to it via command line I could automate the whole process better.</p>\n\n<pre><code># Source server connection info.\nSOURCE_NAME = 'username@example.com'\nSOURCE_HOST = 'mail.example.com'\nSOURCE_PORT = 143\nSOURCE_SSL  = false\nSOURCE_USER = 'username'\nSOURCE_PASS = 'password'\n\n# Destination server connection info.\nDEST_NAME = 'username@gmail.com'\nDEST_HOST = 'imap.gmail.com'\nDEST_PORT = 993\nDEST_SSL  = true\nDEST_USER = 'username@gmail.com'\nDEST_PASS = 'password'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13258689,"title":"Define a '<<' method for an attribute on an ActiveRecord object","body":"<p>I've got an active record object that has custom accessors for storing arrays as comma separated text.</p>\n\n<pre><code>class Thing &lt; ActiveRecord::Base\n  attr_accessible :object_list\n\n  def objects\n    self.object_list.split(\",\") rescue []\n  end\n\n  def objects=(input)\n   self.object_list = input.join(',')\n  end\nend\n</code></pre>\n\n<p>I'd like to add the following</p>\n\n<pre><code>def objects&lt;&lt;(input)\n  unless self.object_list == nil\n    self.object_list &lt;&lt; \",#{input}\"\n  else\n    self.object_list = \"#{input}\"\n  end\nend\n</code></pre>\n\n<p>So that I can do things like</p>\n\n<pre><code>thing.objects &lt;&lt; 'this'\n</code></pre>\n\n<p>Is that possible?</p>\n"},{"tags":["ruby-on-rails","ruby","httparty","rest-client","faraday"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13258068,"title":"work around Ruby's broken URI.parse, follow redirects","body":"<p>I am using Ruby to scrape webpages that sometimes return redirects which I want to follow.\nThere is many Ruby gems that do that, but there is a problem:</p>\n\n<p>Ruby's <code>URI.parse</code> explodes on some URIs that are technically invalid but work in browsers like <code>\"http://www.google.com/?q=&lt;&gt;\"</code></p>\n\n<pre><code>URI.parse(\"http://www.google.com/?q=&lt;&gt;\")               #=&gt; error\n\nrequire 'addressable/uri'\nAddressable::URI.parse(\"http://www.google.com/?q=&lt;&gt;\")  #=&gt; works\n</code></pre>\n\n<p>All the HTTP client libraries I have tried (HttParty, Faraday, RestClient) break when they encounter such a URI in a redirect (this is on ruby 1.9.3)</p>\n\n<h3>rest-client:</h3>\n\n<pre><code>require 'rest-client'\nRestClient.get(\"http://bitly.com/ReeuYv\") #=&gt; explodes\n</code></pre>\n\n<h3>faraday:</h3>\n\n<pre><code>require 'faraday'\nrequire 'faraday_middleware'\nFaraday.use(FaradayMiddleware::FollowRedirects)\nFaraday.get(\"http://bitly.com/ReeuYv\")    #=&gt; explodes\n</code></pre>\n\n<h3>httparty:</h3>\n\n<pre><code>require 'httparty'\nHTTParty.get(\"http://bitly.com/ReeuYv\")   # =&gt; explodes\n</code></pre>\n\n<h3>open-uri:</h3>\n\n<pre><code>require 'open-uri'\nopen(\"http://bitly.com/ReeuYv\")           # =&gt; explodes\n</code></pre>\n\n<p>What can I do to make this work?</p>\n"},{"tags":["ruby","math","multiplication"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13258663,"title":"Multiplication in Ruby causing overflow?","body":"<p>So, I read that theoretically, there is no max value for integers in Ruby and that they can be as large as you want. However, when I multiply the following is resulting in a negative value (which I think is a sign of overflow?):</p>\n\n<blockquote>\n  <blockquote>\n    <p>44404051714 * 44404051714\n    => -2081807267335685116</p>\n  </blockquote>\n</blockquote>\n\n<p>Can someone explain this to me?</p>\n"},{"tags":["ruby-on-rails","ruby","forms","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":203,"score":1,"question_id":11349508,"title":"Rails Simpleform with non-model inputs","body":"<p>I have a normal form using simpleform. Now I'd like to add an input that does not have any corresponding field in the model, it will be processed by the controller. I tried</p>\n\n<pre><code>&lt;%= simple_form_for @obj do |f| %&gt;\n  &lt;%= f.input :name %&gt;\n  &lt;%= f.input :attr, as: :string %&gt;   &lt;-- should just send \"attr\" as post data\n&lt;% end %&gt;\n</code></pre>\n\n<p>but this gives a <code>Method not found: attr_not_in_obj</code> error. I could obviously use the standard rails helpers, but then I will miss all of the simpleform HTML around the input, and copying doesn't quite seem right.</p>\n\n<p>In short:\nI'm looking for something like simpleform version of rails tag helpers, without any connection to a model. How do I add inputs that do not correspond to model attributes? </p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":64,"score":1,"question_id":13238878,"title":"Look for help on Ruby on Rails","body":"<p>I am new with Ruby on Rails. I just build web application on the existing database. I use rails to generate 2 scaffolds for restaurant and location tables. After that I set relationship for these two tables:</p>\n\n<pre><code> class Restaurant &lt; ActiveRecord::Base\n  attr_accessible :created, :cuisine_fk, :dish_keywords, :dish_names, :factual_id, :first_name, :last_name, :name, :status\n\n\n  has_many :locations \nend\n\nclass Location &lt; ActiveRecord::Base\n  attr_accessible :address1, :address2, :city, :created, :latitude, :longitude, :phone, :restaurant_fk, :state, :status, :url, :zip\n\n  belongs_to :restaurant\n end\n</code></pre>\n\n<p>I didn't use \"rake db:migrate\" after I set up this relationship for these tables, because I was afraid that this action would make changes the existing tables.</p>\n\n<p>When I run this command line</p>\n\n<pre><code>&lt;%= restaurant.location.address1%&gt; \n</code></pre>\n\n<p>it shows error:</p>\n\n<pre><code>undefined method `location'\n\n\" NoMethodError in Restaurants#index\n\nShowing C:/Sites/Dishclips/app/views/restaurants/index.html.erb where line #52 raised:\n\nundefined method `location' for #&lt;Restaurant:0x5853bb8&gt; \"\n</code></pre>\n\n<p>After that I tried to set foreign key for the file:</p>\n\n<pre><code>class Location &lt; ActiveRecord::Base\n  attr_accessible :address1, :address2, :city, :created, :latitude, :longitude, :phone, :restaurant_fk, :state, :status, :url, :zip\n\n  belongs_to :restaurant, :class_name =&gt; \"Restaurant\", :foreign_key =&gt; 'restaurant_fk'\n end\n</code></pre>\n\n<p>but it still doen't work. </p>\n\n<p>Is there any way that we can set foreign keys in stead of using \"rails db:migrate\" after we set up the relationships for tables ?  I appreciate your help a lot.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","seeding"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3032,"score":4,"question_id":3476987,"title":"appending to rake db:seed in rails and running it without duplicating data","body":"<p>Rake db:seed populates your db with default database values for an app right? So what if you already have a seed and you need to add to it(you add a new feature that requires the seed). In my experience, when I ran rake db:seed again, it added the existing content already so existing content became double.</p>\n\n<p>What I need is to add some seeds and when ran, it should just add the newest ones, and ignore the existing seeds. How do I go about with this? (the dirty, noob way I usually do it is to truncate my whole db then run seed again, but that's not very smart to do in production, right?)</p>\n"},{"tags":["ruby-on-rails","ruby","jenkins","jenkins-plugins","engineyard"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":148,"score":0,"question_id":10986411,"title":"Jenkins Deployment to Staging","body":"<p>I'm trying to find a way for Jenkins to deploy to my staging server on Engine Yard when all all tests have passed? Are there any plugin for this post-build action from Jenkins?</p>\n"},{"tags":["ruby","ruby-on-rails-3","mailman-gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13259142,"title":"How should I test Mailman app","body":"<p>I'm trying to write some specs for my application aimed to process and resend incoming emails. It's built with Mailman App. I didn't find any good examples on how to do that. What am I actually trying is to create email (with Mail gem) and process it with Mailman. But there is only option of using stding for testing.</p>\n\n<p>So, are there any examples of specs written to test the mailman apps?</p>\n"},{"tags":["ruby-on-rails","ruby","phantomjs"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13197747,"title":"PhantomJS version 1.4.0 version issue","body":"<p>I installed PhantomJS today and got this error trying to use it:</p>\n\n<pre><code>PhantomJS version 1.4.0\nis too old. You must use at least version 1.7.0  \n(Capybara::Poltergeist::PhantomJSTooOld)\n</code></pre>\n\n<p>How can I install the newer version?</p>\n\n<p>I can <em>get</em> the newer version (1.7) at: <a href=\"http://phantomjs.org/download.html\" rel=\"nofollow\">http://phantomjs.org/download.html</a></p>\n\n<p>Once I've downloaded it though how do I actually install it?</p>\n"},{"tags":["ruby","beanstalkd","god"],"answer_count":3,"favorite_count":3,"up_vote_count":23,"down_vote_count":0,"view_count":488,"score":23,"question_id":13058952,"title":"God starts too many processes","body":"<p>I have a god script that is supposed to keep an eye on two stalker processes.\nThe problem is that <strong>after 24h it starts way too many processes.</strong></p>\n\n<p>This is the god script.</p>\n\n<pre><code>rails_root = File.expand_path(\"../..\", __FILE__)\n\n2.times do |n|\n  God.watch do |w|\n    w.group = \"app-scripts\"\n    w.name  = \"run-#{n}\"\n    w.interval = 30.seconds\n    w.dir      = File.dirname(__FILE__)\n\n    w.env = {\n      \"BUNDLE_GEMFILE\" =&gt; \"#{rails_root}/Gemfile\",\n      \"RAILS_ENV\" =&gt; \"production\",\n      \"BEANSTALK_URL\" =&gt; \"beanstalk://127.0.0.1:54132\"\n    }\n\n    w.start = \"bbundle exec stalk #{File.join(rails_root, \"config/jobs.rb\")}\"\n\n    w.start_grace = 5.seconds\n    w.stop_grace  = 5.seconds\n\n    w.start_if do |start|\n      start.condition(:process_running) { |c| c.running = false }\n    end\n\n    w.restart_if do |restart|\n      restart.condition(:memory_usage) do |c|\n        c.above = 200.megabytes\n        c.times = [3, 5]\n      end\n\n      restart.condition(:cpu_usage) do |c|\n        c.above = 95.percent\n        c.times = 5\n      end\n    end\n\n    w.lifecycle do |on|\n      on.condition(:flapping) do |c|\n        c.to_state = [:start, :restart]\n        c.times = 5\n        c.within = 5.minute\n        c.transition = :unmonitored\n        c.retry_in = 10.minutes\n        c.retry_times = 5\n        c.retry_within = 2.hours\n      end\n    end\n  end\nend\n</code></pre>\n\n<p><code>ps aux | grep stalk</code> returns the following.</p>\n\n<pre><code>root      3178  0.2  2.7 417580 117284 ?       Sl   Oct28   2:22 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot      3179  0.2  3.3 506068 138740 ?       Sl   Oct28   2:26 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot      4588  0.2  2.9 497932 121664 ?       Sl   Oct25  16:10 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot      4794  0.2  3.0 497792 128084 ?       Sl   Oct25  15:57 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     10391  0.2  2.8 496784 121388 ?       Sl   Oct25  15:44 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     10392  0.2  2.8 497624 121528 ?       Sl   Oct25  15:31 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     18874 75.0  2.0 214116 83948 ?        Rl   15:49   0:09 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     18875 75.0  2.0 214944 84868 ?        Rl   15:49   0:09 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     20649  0.2  2.6 410636 110012 ?       Sl   Oct28   2:44 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     20650  0.2  3.0 439284 128996 ?       Sl   Oct28   2:47 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     23272  0.2  2.7 414452 115772 ?       Sl   Oct28   2:44 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     23273  0.2  2.7 417728 117152 ?       Sl   Oct28   2:44 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     25919  0.2  3.1 436276 131876 ?       Sl   Oct28   2:28 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     25920  0.2  3.3 503236 138676 ?       Sl   Oct28   2:29 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     28782  0.2  2.8 431836 121108 ?       Sl   Oct25  16:58 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     30687  0.2  2.7 415908 117008 ?       Sl   Oct28   2:39 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\nroot     30688  0.2  2.6 476184 111844 ?       Sl   Oct28   2:37 ruby /opt/www/myapp/shared/bundle/ruby/1.9.1/bin/stalk /opt/www/myapp/current/config/jobs.rb\n</code></pre>\n\n<p>This is the <code>/usr/bin/bbundle</code> script.</p>\n\n<pre><code>#!/usr/bin/env bash\n\nif [[ -s \"/home/webmaster/.rvm/environments/ruby-1.9.2-p320@webmaster\" ]]\nthen\n  source \"/home/webmaster/.rvm/environments/ruby-1.9.2-p320@webmaster\"\n  bundle  \"$@\"\nelse\n  echo \"ERROR: Missing RVM environment file: '/home/webmaster/.rvm/environments/ruby-1.9.2-p320@webmaster'\" &gt;&amp;2\n  exit 1\nfi\n</code></pre>\n\n<ul>\n<li><p>Running <code>sudo god stop app-scripts</code> won't kill any processes.</p></li>\n<li><p>I've tried adding <code>w.uid = \"webmaster\"</code> to the god script, but the problem remains.</p></li>\n<li><p>I'm running god version <code>0.12.1</code>, ruby version <code>1.9.3p286</code> and stalker version <code>0.9.0</code>.</p></li>\n</ul>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["ruby","inheritance","module"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12800066,"title":"Execute methods with the same name of multiple modules included","body":"<p>I have two modules with the same method name. When I include both modules in some class, only the method of the last module is executed. I need instead both to be executed when I initialize the class:</p>\n\n<pre><code>class MyClass\n    include FirstModule\n    include SecondModule\n\n    def initialize\n        foo # foo is contained in both modules but only the one in SecondModules is executed\n    end\nend\n</code></pre>\n\n<p>Is it doable?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12787467,"title":"How to dynamically create a class inside another class and add inheritance to it?","body":"<p>other SO answers shows how to create classes with inheritance, yes,\nbut i also need it to be a subclass of another class.</p>\n\n<pre><code>class Wall\n  def initialize\n    # i need a Brick class here with inheritance from Stone\n  end\nend\n</code></pre>\n"},{"tags":["ruby","regex"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12757759,"title":"Using a regex to extract prefixed values from a string","body":"<p>I have a string of the form</p>\n\n<pre><code>s = \"something prefix1 value1 prefix2 value2 prefix1 value3 prefix2 value4\"\n</code></pre>\n\n<p>I want to extract the values (value1, value2 etc.) using a regular expression.  There can be any number of value/prefix pairs.  There are only two prefixes.  The values may have spaces.</p>\n\n<p>I've tried things like</p>\n\n<pre><code>/((prefix1|prefix2)(.*))+/\n</code></pre>\n\n<p>This doesn't work as the first .* match matches the rest of the string.</p>\n\n<p>I'm working in ruby.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby","file"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12737671,"title":"open a file - permission denied","body":"<p>I tried to open a file in this way</p>\n\n<pre><code>File.open(f_name, File::CREAT | File::RDWR) do |file|\n\nend\n</code></pre>\n\n<p>Absolute file path is passed in as filename, such as filename is</p>\n\n<pre><code>/mounts/dd670-6.chaos.local/cifs/tfile6\n</code></pre>\n\n<p>Get the error message</p>\n\n<pre><code>Permission denied - /mounts/dd670-6.chaos.local/cifs/tfile6 (Errno::EACCES)\n</code></pre>\n\n<p>And, if I go into that directory and open that file, operation can be done successfully.</p>\n\n<p>Anybody has any clue?</p>\n"},{"tags":["ruby","json"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":84,"score":1,"question_id":12723094,"title":"parse json to object ruby","body":"<p>I looked into different resources and still get confused on how to parse a json format to a custom object, for example</p>\n\n<pre><code>class Resident\n  attr_accessor :phone, :addr\n\n  def initialize(phone, addr)\n      @phone = phone\n      @addr = addr\n  end\nend    \n</code></pre>\n\n<p>and JSON file</p>\n\n<pre><code>{\n  \"Resident\": [\n    {\n      \"phone\": \"12345\",\n      \"addr\":  \"xxxxx\"\n    }, {\n      \"phone\": \"12345\",\n      \"addr\": \"xxxxx\"\n    }, {\n      \"phone\": \"12345\",\n      \"addr\": \"xxxxx\"\n    }\n  ]\n}\n</code></pre>\n\n<p>what's the correct way to parse the json file into a array of 3 Resident object?</p>\n"},{"tags":["ruby","arrays","module","initialization"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13257919,"title":"Ruby: Adding things to initialize method through modules","body":"<p>In Ruby I want to have a class include a series of modules and have these individual modules execute a block or method (or just find some way to edit an instance variable) when initializing that class.  I know I can do this by creating a method in the module and then calling it in the class' initialize method, but I want some way to do this by simply including the module and calling one method to execute any code the modules add to initialize, that way I can have a large amount of things included in a class without worrying about adding a line of code in the initialize method for every single module included.    I've checked out aliasing, super, and related things but haven't gotten anything... If it helps to understand what I'm hoping to accomplish here's some pseudocode:</p>\n\n<pre><code>module Mod1  \n    call_this_block_on_initialize { @a.push 4 }  \nend  \n\nmodule Mod2  \n    call_this_block_on_initialize { @a.push 5 }  \nend  \n\nclass Test  \n    attr_accessor :a  \n    include Mod1  \n    include Mod2  \n\n    def initialize  \n      @a = [1, 2, 3]  \n      call_those_blocks_set_by_mods  \n    end  \nend  \n\nt = Test.new\nt.a # returns [1, 2, 3, 4, 5]\n</code></pre>\n\n<p>This may be a bit wordy but I think the title sums up what I'm trying to do. Thanks for any help!</p>\n"},{"tags":["ruby","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13233154,"title":"ruby 1.9.3p286 and factory_girl_rails error on bundle install in application directory","body":"<p>I do have a problem with bundler install for the gem 'factory_girl_rails' and I don't know how to resolve.</p>\n\n<p>Each time I run bundle install in the application/project directory the following error is thrown:<br>\n(it doesn't matter if I create a new rails app and add factory_girl to the gemfile either)</p>\n\n<blockquote>\n  <p>Gem::InstallError: factory_girl requires Ruby version >= 1.9.2.</p>\n</blockquote>\n\n<p>An error occured while installing factory_girl (4.1.0), and Bundler cannot continue.</p>\n\n<p>Make sure that <code>gem install factory_girl -v '4.1.0'</code> succeeds before bundling.</p>\n\n<p>When I type 'gem intall factory_girl_rails' in the terminal it successfully installs.</p>\n\n<p>Would be glad if someone can help me out.\nThanks in advance</p>\n\n<p>Jan</p>\n\n<h1>My configuration:</h1>\n\n<pre><code>osx mountain lion\nruby 1.9.3p286\ngem 1.8.24\nrails 3.2.8\n\nwhich ruby:\n/usr/local/bin/ruby\n\nwhich gem:\n/usr/local/bin/gem\n\nwhich rails:\n/usr/local/bin/rails\n\ngem list:\n*** LOCAL GEMS ***\n\nactionmailer (3.2.8)\nactionpack (3.2.8)\nactivemodel (3.2.8)\nactiverecord (3.2.8)\nactiveresource (3.2.8)\nactivesupport (3.2.8)\naddressable (2.3.2)\narel (3.0.2)\nbcrypt-ruby (3.0.1)\nbest_in_place (1.1.2)\nbigdecimal (1.1.0)\nbuilder (3.1.4, 3.0.4)\nbundler (1.2.1)\ncancan (1.6.8)\ncapybara (1.1.2)\ncarrierwave (0.7.0)\nchildprocess (0.3.6)\nclient_side_validations (3.2.1)\ncoffee-rails (3.2.2)\ncoffee-script (2.2.0)\ncoffee-script-source (1.4.0, 1.3.3)\ncountry_select (1.0.1)\ndevise (2.1.2)\ndiff-lcs (1.1.3)\nerubis (2.7.0)\nevernote (1.2.1)\nevernote-thrift (1.22.1)\nexecjs (1.4.0)\nfactory_girl (4.1.0)\nfactory_girl_rails (4.1.0)\nfaraday (0.8.4)\nffi (1.1.5)\ngeocoder (1.1.4)\nguard (1.4.0)\nguard-rspec (2.1.0)\nhashie (1.2.0)\nhike (1.2.1)\nhttpauth (0.2.0)\ni18n (0.6.1)\nio-console (0.3)\njourney (1.0.4)\njquery-rails (2.1.3)\njson (1.7.5)\njwt (0.1.5)\nlibwebsocket (0.1.5)\nlisten (0.5.3)\nmail (2.4.4)\nmetaclass (0.0.1)\nmime-types (1.19)\nminitest (4.1.0)\nmocha (0.12.7)\nmulti_json (1.3.7, 1.3.6)\nmultipart-post (1.1.5)\nnested_form (0.2.3)\nnifty-generators (0.4.6)\nnokogiri (1.5.5)\noauth (0.4.7)\noauth2 (0.8.0)\nomniauth (1.1.1)\nomniauth-dropbox (0.2.0)\nomniauth-evernote (1.2.0)\nomniauth-facebook (1.4.1)\nomniauth-foursquare (0.0.8)\nomniauth-google (1.0.2)\nomniauth-google-oauth2 (0.1.13)\nomniauth-instagram (1.0.0)\nomniauth-linkedin (0.0.8)\nomniauth-oauth (1.0.1)\nomniauth-oauth2 (1.1.1)\nomniauth-salesforce (1.0.3)\nomniauth-twitter (0.0.13)\nomniauth-windowslive (0.0.8.1)\nomniauth-xing (0.1.3)\nomniauth-yahoo (0.0.4)\norm_adapter (0.4.0)\npolyglot (0.3.3)\nrack (1.4.1)\nrack-cache (1.2)\nrack-protection (1.2.0)\nrack-ssl (1.3.2)\nrack-test (0.6.2)\nrails (3.2.8)\nrailties (3.2.8)\nrake (0.9.2.2)\nrdoc (3.12)\nredis (3.0.2)\nrmagick (2.13.1)\nrspec (2.11.0)\nrspec-core (2.11.1)\nrspec-expectations (2.11.3)\nrspec-mocks (2.11.3)\nrspec-rails (2.11.4)\nrubygems-update (1.8.24)\nrubyzip (0.9.9)\nsass (3.2.2, 3.2.1)\nsass-rails (3.2.5)\nselenium-webdriver (2.25.0)\nsimple_form (2.0.4)\nsinatra (1.3.3)\nsprockets (2.8.0, 2.1.3)\nsqlite3 (1.3.6)\nthor (0.16.0)\nthrift (0.9.0)\nthrift_client (0.8.2)\ntilt (1.3.3)\ntreetop (1.4.12, 1.4.11)\ntzinfo (0.3.35, 0.3.34, 0.3.33)\nuglifier (1.3.0)\nwarden (1.2.1)\nxpath (0.1.4)\n</code></pre>\n\n<p><strong>Content of the Gemfile:</strong></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\n\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n\ngroup :test, :development do\n  gem 'aruba'\n  gem 'cucumber'\n  gem 'rspec-rails'\n  gem 'mongoid-rspec'\n  gem 'capybara'\n  gem 'database_cleaner'\n  gem 'jasmine'\n  gem 'factory_girl_rails'\nend\n\n\n# To use ActiveModel has_secure_password\n# gem 'bcrypt-ruby', '~&gt; 3.0.0'\n\n# To use Jbuilder templates for JSON\n# gem 'jbuilder'\n\n# Use unicorn as the app server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# gem 'debugger'\n\ngem 'devise'\ngem 'mongoid'\ngem 'mongoid_spacial'\ngem 'haml'\ngem 'bson_ext'\ngem 'rails-backbone'\n</code></pre>\n"},{"tags":["ruby","sinatra","httprequest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13256468,"title":"application error Errno::ECONNREFUSED in Ruby","body":"<p>I am getting an <code>application error Errno::ECONNREFUSED</code> error when I try and send an HTTP Request. I'm using <code>Sinatra</code>, and have it set up locally on my workstation. Here is the error:</p>\n\n<pre><code>Errno::ECONNREFUSED - Connection refused - Connection refused:\n    org/jruby/ext/socket/RubyTCPSocket.java:124:in `initialize'\n    org/jruby/RubyIO.java:876:in `new'\n    org/jruby/ext/socket/RubyTCPSocket.java:154:in `open'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:560:in `connect'\n    org/jruby/ext/Timeout.java:79:in `timeout'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:560:in `connect'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:553:in `do_start'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:542:in `start'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:1035:in `request'\n    ./ServiceRequest.rb:39:in `sendGetRequest'\n    ./fileParser.rb:148:in `parseUrls'\n    org/jruby/RubyHash.java:1181:in `each'\n    ./fileParser.rb:138:in `parseUrls'\n    org/jruby/RubyHash.java:1181:in `each'\n    ./fileParser.rb:73:in `parseUrls'\n    ./testmdxservices.rb:108:in `sendServiceRequest'\n    ./testmdxservices.rb:80:in `getFile'\n    TestServices.rb:71:in `TestServices'\n    org/jruby/RubyProc.java:270:in `call'\n    org/jruby/RubyMethod.java:117:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1264:in `compile!'\n    org/jruby/RubyProc.java:270:in `call'\n    org/jruby/RubyProc.java:220:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `route!'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:851:in `route_eval'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `route!'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:872:in `process_route'\n    org/jruby/RubyKernel.java:1212:in `catch'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:870:in `process_route'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:834:in `route!'\n    org/jruby/RubyArray.java:1620:in `each'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:833:in `route!'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:936:in `dispatch!'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `call!'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `invoke'\n    org/jruby/RubyKernel.java:1212:in `catch'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `invoke'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `call!'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:755:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/path_traversal.rb:16:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/json_csrf.rb:17:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/logger.rb:15:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/commonlogger.rb:20:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:136:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:129:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/head.rb:9:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/showexceptions.rb:21:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:99:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1389:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1471:in `synchronize'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1389:in `call'\n    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'\n    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'\n    org/jruby/RubyProc.java:270:in `call'\n    org/jruby/RubyProc.java:224:in `call'\n</code></pre>\n\n<p>Here is my <code>sendGetRequest</code>:</p>\n\n<pre><code>def sendGetRequest(url, mMethod, key, rHash, headers, publicToken)\n\n\n\n        mKey = String.new(key)\n        nMethod =String.new(mMethod)\n\n        nKey = mKey.concat(nMethod)\n\n        uri = URI.parse(URI.encode(url))\n        http = Net::HTTP.new(uri.host, uri.port)\n\n        request = Net::HTTP::Get.new(uri.request_uri)\n            headers.each do |hKey, hVal|\n                request[hKey] = hVal\n            end\n\n        request[\"Authorization\"] = publicToken\n\n        if uri.scheme == \"https\"\n            http.use_ssl = true \n            http.verify_mode = OpenSSL::SSL::VERIFY_NONE\n            response = http.request(request)\n\n\n        else\n\n            response = http.request(request)\n            response.body\n            #response = Net::HTTP.get_response(uri)\n        end\n\n\n        if response.code == '200'\n\n            code = response.code\n            puts \"#{mMethod}: - Test passed! Response code: #{response.code}\" \n            rHash[nKey] = code\n\n            #puts \"#{rHash}\"\n        else\n            code = response.code\n            puts \"#{mMethod}: - Test failed! Response code: #{response.code}\"\n            rHash[nKey] = code\n            #puts \"#{rHash}\"\n\n\n\n        end\n        return rHash\n    end\n</code></pre>\n\n<p>I'm not sure what I'm doing wrong to get this error. If anyone could help, that would be great. Please let me know if you need more code. </p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":9,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1096,"score":2,"question_id":502671,"title":"How to find a record created on the previous month?","body":"<p>I have a table where new records are added daily. How would I go about finding records created in the previous month?</p>\n"},{"tags":["ruby","rabbitmq","amqp","eventmachine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13203545,"title":"RPC using EventMachine & RabbitMQ","body":"<p>I've been starting to play around with RabbitMQ <a href=\"http://rubyamqp.info/articles/patterns_and_use_cases/#code_example\" rel=\"nofollow\">RPC sample code</a> provided in AMQP gem doc, trying to write very simple code performing <em>synchronous</em> remote calls:</p>\n\n<pre><code>require \"amqp\"\n\nmodule RPC\n  class Base\n    include EM::Deferrable\n\n    def rabbit(rabbit_callback)\n      rabbit_loop = Proc.new {\n        AMQP.connect do |connection|\n          AMQP::Channel.new(connection) do |channel|\n            channel.queue(\"rpc.queue\", :exclusive =&gt; false, :durable =&gt; true) do |requests_queue|\n              self.callback(&amp;rabbit_callback)\n              self.succeed(connection, channel, requests_queue)\n            end # requests_queue\n          end # AMQP.channel\n        end # AMQP.connect\n\n        Signal.trap(\"INT\")  { connection.close { EM.stop } }\n        Signal.trap(\"TERM\") { connection.close { EM.stop } }\n      }\n\n      if !EM.reactor_running?\n        EM.run do\n          rabbit_loop.call\n        end\n      else\n        rabbit_loop.call\n      end\n    end\n  end\n\n  class Server &lt; Base\n\n    def run\n      server_loop = Proc.new do |connection, channel, requests_queue|\n        consumer = AMQP::Consumer.new(channel, requests_queue).consume\n        consumer.on_delivery do |metadata, payload|\n          puts \"[requests] Got a request #{metadata.message_id}. Sending a reply to #{metadata.reply_to}...\"\n          channel.default_exchange.publish(Time.now.to_s,\n                                           :routing_key    =&gt; metadata.reply_to,\n                                           :correlation_id =&gt; metadata.message_id,\n                                           :mandatory      =&gt; true)\n          metadata.ack\n        end\n      end\n      rabbit(server_loop)\n    end\n\n  end\n\n  class Client &lt; Base\n\n    def sync_push(request)\n      result = nil\n      sync_request = Proc.new do |connection, channel, requests_queue|\n        message_id = Kernel.rand(10101010).to_s\n\n        response_queue = channel.queue(\"\", :exclusive =&gt; true, :auto_delete =&gt; true)\n        response_queue.subscribe do |headers, payload|\n          if headers.correlation_id == message_id\n            result = payload\n            connection.close { EM.stop }\n          end\n        end\n\n        EM.add_timer(0.1) do \n          puts \"[request] Sending a request...#{request} with id #{message_id}\"\n          channel.default_exchange.publish(request,\n                                           :routing_key =&gt; requests_queue.name,\n                                           :reply_to    =&gt; response_queue.name,\n                                           :message_id  =&gt; message_id)\n        end\n      end\n\n      rabbit(sync_request)\n      result\n    end\n  end\nend\n</code></pre>\n\n<p>The idea is pretty simple: I want to have a message queue always ready (this is handled by <code>rabbit</code> method). Whenever the client wants to send a request, it starts by creating a temporary queue for the response along with a message id; it then publishes the request to the main message queue and waits for a response with the same message id in the temporary queue in order to know when the answer for this specific request is ready. I guess that the <code>message_id</code> is somehow redundant with the temporary queue (as the queue should also be unique).</p>\n\n<p>I now run dummy script using this client/server code</p>\n\n<pre><code># server session\n&gt;&gt; server = RPC::Server.new\n=&gt; #&lt;RPC::Server:0x007faaa23bb5b0&gt;\n&gt;&gt; server.run\nUpdating client properties\n[requests] Got a request 3315740. Sending a reply to amq.gen-QCv8nP2dI5Qd6bg2Q1Xhk0...\n</code></pre>\n\n<p>and </p>\n\n<pre><code># client session\n&gt;&gt; client = RPC::Client.new\n=&gt; #&lt;RPC::Client:0x007ffb6be6aed8&gt;\n&gt;&gt; client.sync_push \"test 1\"\nUpdating client properties\n[request] Sending a request...test 1 with id 3315740\n=&gt; \"2012-11-02 21:58:45 +0100\"\n&gt;&gt; client.sync_push \"test 2\"\nAMQ::Client::ConnectionClosedError: Trying to send frame through a closed connection. Frame is #&lt;AMQ::Protocol::MethodFrame:0x007ffb6b9c83d0 @payload=\"\\x002\\x00\\n\\x00\\x00\\x00\\f\\x00\\x00\\x00\\x00\", @channel=1&gt;\n</code></pre>\n\n<p>There are two points I really don't understand:</p>\n\n<ol>\n<li>related to EventMachine: in the <code>Client</code> code, why do I have to call <code>EM.add_timer</code> if I want my message to actually be published? And why using <code>EM.next_tick</code> doesn't work? My understanding is that \"everything\" is supposed to be \"ready\" when publish is called here.</li>\n<li>related to AMQP: why does my client crash due a closed connection for the second request? A brand new EM/AMQP loop is supposed to be created each time a new request is pushed.</li>\n</ol>\n\n<p>There sadly is very few code available online dealing with EM/AMQP so any help will be deeply appreciated!\nAny comment regarding the efficiency of this would also be much appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13257344,"title":"Can you have a time without a date in rails?","body":"<p>I am trying to import some data in from a flat file and am getting some odd results. When importing a time that is unattached to a date, why do I get a date inserted into this time as well?</p>\n\n<pre><code>1.9.3-p286 :008 &gt; v.arrival_time = Time.parse(\"10:10\")\n =&gt; 2012-11-06 10:10:00 -0400\n</code></pre>\n\n<p>I'm guessing that there is only a way to keep the date by itself, but no way to keep the time by itself despite the active record column-type :time. Is there a way to keep them separate such as:</p>\n\n<pre><code>1.9.3-p286 :002 &gt; Date.parse(\"JAN 01 2000\")\n =&gt; Sat, 01 Jan 2000 \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","cron","whenever"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":687,"score":2,"question_id":7548730,"title":"Cron job not working in Whenever gem","body":"<p>I have an application that contains a bunch of tasks, and every day I want to run a cron job that creates a DayTask for each Task in the database. A Task has_many DayTasks and these daytasks are what users will be checking off every day. I'm using the whenever gem but it doesn't seem to be running at all. Any ideas?</p>\n\n<p>config/schedule.rb</p>\n\n<pre><code>every 1.day, :at =&gt; \"12:01am\" do\n  runner \"Task.generate_tasks_for_day\"  \nend\n</code></pre>\n\n<p>Task.rb</p>\n\n<pre><code>  def generate_tasks_for_day\n    Task.all.each do |task|\n      task.day_tasks.create(:target_date =&gt; Date.today)\n    end \n  end \n</code></pre>\n\n<p>result of running the 'whenever command'</p>\n\n<pre><code>1 0 * * * /bin/bash -l -c 'cd /home/grant/rails_projects/GoalTwist &amp;&amp; script/rails runner -e production '\\''Task.generate_tasks_for_day'\\'''\n</code></pre>\n\n<p>Note: I've been changing the times in config/schedule.rb every time I want to test run it.</p>\n"},{"tags":["ruby","gem","rvm","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13257191,"title":"Using rvm, rubygems and bundler","body":"<p>So, I've done a lot of Rails programming in the past and now I came to a point where I just want to use Ruby with RVM and Bundler and some other gems.. But after I got all set up I required the gem I wanted to use in this project and got the following LoadError:</p>\n\n<pre><code>.rvm/../custom_require.rb:36:in `require': cannot load such file -- upnp/ssdp (LoadError)\n</code></pre>\n\n<p>I'm using Ruby 1.9.3</p>\n\n<p>I've got the following files:</p>\n\n<pre><code>upnp\n- Gemfile\n- upnp.rb\n</code></pre>\n\n<p>Than in the Gemfile:</p>\n\n<pre><code># Gemfile\n\nsource \"http://rubygems.org\"\n\ngem \"upnp\", git: \"https://github.com/turboladen/upnp.git\"\n</code></pre>\n\n<p>And the project main file:</p>\n\n<pre><code># upnp.rb\nrequire 'rubygems'\nrequire 'upnp/ssdp'\n\n# Search for all devices (do an M-SEARCH with the ST header set to 'ssdp:all')\nall_devices = UPnP::SSDP.search\n\nputs all_devices\n</code></pre>\n\n<p>Now, after setting up RVM with a gemset, and bundled everything, when I run:</p>\n\n<pre><code>ruby upnp.rb\n</code></pre>\n\n<p>I get this error mentioned above..</p>\n\n<p>I've checked out the Github page of this gem and it has a <code>lib</code> folder with <code>upnp/ssdp.rb</code></p>\n\n<p>So should be good right? </p>\n\n<p>I really don't know how to debug such a thing!</p>\n\n<p>Can someone shine a light on this problem? </p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","rubygems","whenever"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":430,"score":0,"question_id":6784149,"title":"How to make 'whenever' gem work on Windows?","body":"<p>I wan to run \"simple\" cron using whenever on Windows XP. So I installed whenever <code>gem install whenever</code> and then ran my cron.rb </p>\n\n<pre><code>require 'rubygems' \nrequire 'whenever' \nevery 1.days, :at =&gt; '5:30am' do \n  command \"puts now\" \nend \n</code></pre>\n\n<p>but it complained that </p>\n\n<pre><code>You don't have i18n installed in your application. \nPlease add it to your Gemfile  and run bundle install\n</code></pre>\n\n<p>So I ran <code>gem install i18n</code> and now the same code gives me an error </p>\n\n<pre><code>C:\\whenever&gt;ruby cron.rb \ncron.rb:4: undefined method 'every' for main:Object (NoMethodError)\n</code></pre>\n\n<p>Any idea how I can make whenever gem work? </p>\n\n<ul>\n<li>ruby 1.8.7 (2010-08-16 patchlevel 302) [i386-mingw32]</li>\n<li>gem 1.3.7</li>\n</ul>\n\n<p>LOCAL GEMS</p>\n\n<pre><code>aaronh-chronic (0.3.9)\nactivesupport (3.0.9)\nbackports (1.18.2)\ndaemons (1.1.0)\ndelayed_job (2.0.3)\neventmachine (0.12.10 x86-mswin32-60)\nfastercsv (1.5.4)\nhaml (3.0.21)\ni18n (0.6.0)\njson (1.5.1)\nmechanize (1.0.0)\nmonkey-lib (0.5.4)\nnokogiri (1.5.0 x86-mingw32, 1.4.3.1 x86-mingw32)\nrack (1.2.1)\nrdiscount (1.6.8)\nruby-growl (3.0)\nsinatra (1.2.6, 1.0)\nsinatra-advanced-routes (0.5.1)\nsinatra-reloader (0.5.0)\nsinatra-sugar (0.5.1, 0.5.0)\nthin (1.2.7 x86-mswin32)\ntilt (1.3)\nwhenever (0.6.8)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","serialization","marshalling","deep-copy"],"answer_count":2,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":1114,"score":3,"question_id":5643432,"title":"What's the most efficient way to deep copy an object in Ruby?","body":"<p>I know that serializing an object is (to my knowledge) the only way to effectively deep-copy an object (as long as it isn't stateful like <code>IO</code> and whatnot), but is one way particularly more efficient than another?</p>\n\n<p>For example, since I'm using Rails, I could always use <code>ActiveSupport::JSON</code>, <code>to_xml</code> - and from what I can tell marshalling the object is one of the most accepted ways to do this.  I'd expect that marshalling is probably the most efficient of these since it's a Ruby internal, but am I missing anything?</p>\n\n<p><strong>Edit</strong>: note that its implementation is something I already have covered - I don't want to replace existing shallow copy methods (like <code>dup</code> and <code>clone</code>), so I'll just end up likely adding <code>Object::deep_copy</code>, the result of which being whichever of the above methods (or any suggestions you have :) that has the least overhead.</p>\n"},{"tags":["ruby","input","nonblocking"],"answer_count":4,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":5668,"score":6,"question_id":946738,"title":"Detect key press (non-blocking) w/o getc/gets in Ruby","body":"<p>I have a simple task that needs to wait for something to change on the filesystem (it's essentially a compiler for prototypes).  So I've a simple infinite loop with a 5 second sleep after the check for changed files.</p>\n\n<pre><code>loop do\n  # if files changed\n  #   process files\n  #   and puts result\n  sleep 5\nend\n</code></pre>\n\n<p>Instead of the <code>Ctrl+C</code> salute, I'd rather be able to test and see if a key has been pressed, without blocking the loop.  Essentially I just need a way to tell if there are incoming key presses, then a way to grab them until a Q is met, then exit out of the program.</p>\n\n<p>What I want is:</p>\n\n<pre><code>def wait_for_Q\n  key_is_pressed &amp;&amp; get_ch == 'Q'\nend\n\nloop do\n  # if files changed\n  #   process files\n  #   and puts result\n  wait_for_Q or sleep 5\nend\n</code></pre>\n\n<p>Or, is this something Ruby just doesn't do (well)?</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13240036,"title":"Why won't my textarea update through Ajax after entry has been re-saved to database?","body":"<p>I am updating a simple <code>text_area</code> in Rails using Ajax:</p>\n\n<p><strong>application.js</strong>:</p>\n\n<pre><code>$(\"#invoice_project_id\").change(function() {\n    var value=$(this).val();\n    $.get('/invoices/get_recipient', {project_id= : value}  function(response) {\n        $('#invoice_recipient').val(response);\n    })\n});​\n</code></pre>\n\n<p><strong>get_recipient.js</strong>:</p>\n\n<pre><code>$('#invoice_recipient').val(\"&lt;%= @recipient.to_s.gsub!(/\\n/, '\\n') %&gt;\");\n</code></pre>\n\n<p><strong>invoices_controller.rb</strong>:</p>\n\n<pre><code>def get_recipient\n  project = Project.find(params[:project_id])\n  @recipient = project.person.address\nend\n</code></pre>\n\n<p>The code works great and replaces the value of the <code>recipient</code> text_area with the correct address, depending on what <code>project</code> gets chosen in the select menu.</p>\n\n<p>The problem is that it works only with the <code>addresses</code> that already exist in the database. (I am using the <a href=\"http://faker.rubyforge.org\" rel=\"nofollow\"><strong>Rails Faker gem</strong></a> to populate my database.) The moment I <strong>re-save</strong> a <code>person</code>'s <code>address</code> manually in my Safari browser, the text_area won't get updated through Ajax anymore when I try to do so using the above code.</p>\n\n<p>How is this possible? </p>\n\n<p>I am already escaping the newline characters using the <code>gsub!</code> method above, so I can't think of anything else I could do.</p>\n\n<p>Can anybody help?</p>\n\n<p>Thanks...</p>\n"},{"tags":["ruby-on-rails","ruby","prawn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13256723,"title":"How to convert base64 string to PNG using Prawn without saving on server in Rails","body":"<p>So I am trying to embed a PNG image of canvas to PDF using Prawn gem. Base64 string is generated by using canvas' toDataURL() function. As the image is only needed in PDF I'm trying to avoid saving it on the server. Params[:base64string] is correctly passed to the server.</p>\n\n<p>However, I am trying to use </p>\n\n<pre><code>image = Prawn::Images::PNG.new(base64string)\n</code></pre>\n\n<p>to create the image but I get NoMethodError: undefined method `unpack' for nil:NilClass. </p>\n\n<p>Any ideas what I'm doing wrong or how this should be done correctly? </p>\n"},{"tags":["ruby-on-rails","ruby","thrift"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13248127,"title":"How do I use thrift_client library hook feature?","body":"<p>I'm using <a href=\"https://github.com/twitter/thrift_client/blob/master/lib/thrift_client/abstract_thrift_client.rb\" rel=\"nofollow\">thrift_client 0.8.1 library</a>. And it supports some hook interfaces.</p>\n\n<pre><code>client = ThriftClient.new(FooService, host)\n\nclient.add_callback :before_method do |*args|\n  ActionController::Base.logger.info instance_eval(\"@current_server\")\n  logger.info args.inspect\nend\n\nclient.add_callback :post_connect do |client|\n  logger.info \"A thrift server connection has been made&lt;#{client.current_server}&gt;\"\nend\n</code></pre>\n\n<p>Everytime calling a method, I would like to write log the information of thrift server.\nSo I installed a <code>:before method</code> hook but I think <code>instance_eval(\"@current_server\")</code> doesn't work as I expected. The <code>@current_server</code> is an instance variable in the <code>ThriftClient</code> class. What is the problem?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12865919,"title":"Get value in ruby","body":"<p>In ruby, I have </p>\n\n<pre><code>res = [[0, :product, \"client\"], [0, :os, \"windows\"], [0, :architecture, \"32rs\"]]\n</code></pre>\n\n<p>I want to get value of os. I can do it by res[1][2], but I don't want to rely on the index as it can change. What I have is the key i.e. :os, so what is the best way to find it?</p>\n"},{"tags":["ruby","xml-rpc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13256234,"title":"Error running xmlrpc/client in Ruby","body":"<p>When I run the following code from: <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/xmlrpc/rdoc/xmlrpc/README_txt.html\" rel=\"nofollow\">http://www.ruby-doc.org/stdlib-1.9.3/libdoc/xmlrpc/rdoc/xmlrpc/README_txt.html</a></p>\n\n<pre><code>require 'xmlrpc/client'\nrequire 'pp'\nserver = XMLRPC::Client.new2(\"http://xmlrpc-c.sourceforge.net/api/sample.php\")\nresult = server.call(\"sample.sumAndDifference\", 5, 3)\npp result\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>../ruby/1.9.1/xmlrpc/client.rb:555:in `do_rpc': Wrong content-type (received 'text/html' but expected 'text/xml'):  (RuntimeError)\n&lt;?xml version=\"1.0\"?&gt;\n&lt;!-- DEBUG INFO:\n\n0 - new xmlrpcval(5, 'i4') \n1 - new xmlrpcval(3, 'i4')\n\n--&gt;\n&lt;methodResponse&gt;\n&lt;params&gt;\n&lt;param&gt;\n&lt;value&gt;&lt;struct&gt;\n.\n.\n&lt;/methodResponse&gt;\n\nfrom ../lib/ruby/1.9.1/xmlrpc/client.rb:420:in `call2'\nfrom ../lib/ruby/1.9.1/xmlrpc/client.rb:410:in `call'\nfrom xmlrpc_test.rb:5:in `&lt;main&gt;'\n</code></pre>\n\n<p>I don't know it's the problem of the code or im missing some libraries?</p>\n"},{"tags":["python","c","ruby","math","swap"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":5,"view_count":103,"score":-1,"question_id":13256099,"title":"How does this code swap the two numbers?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1826159/swapping-two-variable-value-without-using-3rd-variable\">Swapping two variable value without using 3rd variable</a>  </p>\n</blockquote>\n\n\n\n<p>I came across this code on Quora.\nFor C:</p>\n\n<pre><code>a^=b^=a^=b;\n</code></pre>\n\n<p>For Ruby/Python:</p>\n\n<pre><code>a,b=b,a\n</code></pre>\n"},{"tags":["ruby","bindata"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13224535,"title":"Creating user defined primitive type from binary data with BinData?","body":"<p>I have a group of files which I have to download from a legacy Cobol system\neach night.  I convert these files from binary data files into\nMySql tables.</p>\n\n<p>I wrote a Ruby program to do this using BinData for the individual\nfile structures.  There are several fields in each of the files which contain\npacked decimal data (Cobol COMP-3).  The following code works in reading one\nof the binary files and I wrote code to convert the field <code>amt1</code> to\na floating point decimal field.</p>\n\n<p>The problem with this code is that for each packed field I must repeat the\ncode for field conversion and even worse hard code the number of decimal places\nfor each field into the code (see the commented code in program).  </p>\n\n<p>Example of code:</p>\n\n<pre><code>require 'bindata'\nrequire 'bigdecimal'\n\nclass WangRec &lt; BinData::Record\n  string  :cust_no,         :read_length =&gt; 6\n  string  :doc_date,        :read_length =&gt; 6\n  string  :doc_no,          :read_length =&gt; 6\n  string  :doc_type,        :read_length =&gt; 1\n  string  :apply_to_no,     :read_length =&gt; 6\n  string  :cust_no_alt,     :read_length =&gt; 6\n  string  :apply_to_no_alt, :read_length =&gt; 6\n  string  :doc_due_date,    :read_length =&gt; 6\n  string  :amt1,            :read_length =&gt; 6 \n  string  :amt2,            :read_length =&gt; 5\n  string  :ref,             :read_length =&gt; 30\n  string  :slsmn1,          :read_length =&gt; 3\n  string  :slsmn2,          :read_length =&gt; 3\n  string  :slsmn3,          :read_length =&gt; 3\n  string  :amt3,            :read_length =&gt; 5\nend\n\ndef packed(packed_field, dec_pos) \n  unpkd_field = packed_field.unpack('H12')\n  num, sign = unpkd_field[0][0..-2], unpkd_field[-1]\n  unless sign == 'f'\n    amt = num.insert(0, '-')\n  end\n\n  if dec_pos &gt; 0\n    dec_amt = amt.insert((dec_pos + 1) * -1, '.')\n  end\n\n  return dec_amt.to_f \n\nend\n\nwang_aropnfile = File.open('../data/wangdata/AROPNFIL.bin', 'rb')\n\ncount = 0\n\nwhile !wang_aropnfile.eof?\n  rec = WangRec.read(wang_aropnfile)\n\n# The following line of code would have to be repeated for each\n# packed field along with the decimal places\n  amt1 = packed(rec.amt1, 2)\n\n  puts \"#{rec.cust_no} #{rec.doc_type} #{rec.doc_date} #{amt1}\"\n\n  count += 1\nend\n\nputs count\n</code></pre>\n\n<p>How do I create my own data type primitive called <code>pkddec</code>, which takes a <code>read_length</code> and <code>dec_pos</code> parameter and create a <code>class PackedDecimal &lt;&lt; BinData ::Primitive</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","charts","google-charts","linechart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13255304,"title":"How to generate a line chart with too many data in ruby/ruby on rails?","body":"<p>I'm trying to generate a line chart with data I take from a database.</p>\n\n<p>The data basically have a date field, an estimated progress field and a real progress field.</p>\n\n<p>The progresses may be nil but the date is always there.</p>\n\n<p>Since I don't know what are the intervals of the date and I need the intervals of the date distributed uniformly , I want to make the data from the first date until the last date with steps of 1 day.</p>\n\n<p>For example, let's say I have this in the database:</p>\n\n<pre><code>| date        | estimated progress        | real progress        |\n| 2012-08-01  | 0.0                       |                      |\n| 2012-08-02  |                           | 0.15                 |\n| 2012-08-05  | 0.3                       |                      |\n</code></pre>\n\n<p>I would like to generate a line chart with this info:</p>\n\n<pre><code>x = [2012-08-01, 2012-08-02, 2012-08-03, 2012-08-04, 2012-08-05]\nep = [0.0 , 0.0, 0.0, 0.0, 0.3]\nrp = [nil , 0.15, 0.15, 0.15, 0.15 ]\n</code></pre>\n\n<p>But since the start date and the finish date can be way too separated, I'd like to show the x labels with a custom interval. It could be every 3, 5 or 7 days depending on the distance between those dates.</p>\n\n<p>I'm trying this with <code>gchartrb</code> which use the google chart api but I realized I can't have nil values inside my data. So I should replace it with 0.0 even though it's not 0. It's unknown.</p>\n\n<p>The other problem I found is that I don't know how to specify the labels to show those intervals I said before. It just show me every label and therefore, it's not readable.</p>\n\n<p>I'm looking for another gem, a solution for gchartrb or ideas to generate the data differently and make it understandable. </p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13255987,"title":"Ruby on Rails - How to migrate code from float to decimal?","body":"<p>So I've got a ruby on rails code which use float a lot (lots of \"to_f\"). It uses a database with some numbers also stored as \"float\" type.</p>\n\n<p>I would like to migrate this code and the database to decimal only. Is it as simple as migrating the database columns to decimal (adding a decimal column, copying float column to decimal one, deleting float column, renaming decimal column to old float column name), and replacing \"to_f\" with \"to_d\" in the code? Or do I need to do more than that?</p>\n\n<p>Thanks a lot everyone\nRaphael</p>\n"},{"tags":["ruby","methods","rspec","call","block"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13249177,"title":"RSpec -- test if method called its block parameter","body":"<p>I have a method that takes block of code as an argument. The problem is: how to test using RSpec if this method called the block? </p>\n\n<p>The block may be evaluated in any scope the method needs, not necessarily using a <code>yield</code> or <code>block.call</code>. It be passed to another class, or evaluated it in an anonymous class object or somewhere else. For the test to pass it is enough to evaluate the block somewhere as a result of the method call. </p>\n\n<p>Is there a way to test something like this using RSpec?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13254433,"title":"How do I set a catch-remaining default route to a directory?","body":"<p>Perhaps simply due to lack of good keywords, I wasnt able to find any useful solution for a problem that should be almost trivial…</p>\n\n<p>In my <em>routes.rb</em>, how do I tell: \"If no other route matches <strong>request</strong>, then deliver /foo/bar/<strong>request</strong>\"?</p>\n\n<p>(Note: <strong>request</strong> ≠ '/')</p>\n\n<p>To be more specific:</p>\n\n<p>If <em>http://example.com/somedir/test/1/2/3</em> is not matched, try <em>/for/bar/somedir/test/1/2/3</em>, just if that does not exist, deliver *APP_DIR/public/404.html*.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13255242,"title":"How to clean rails console output when using pry-rails?","body":"<p>I have in my Gemfile pry-rails gem. I would like to use pry as rails console but without that text below.</p>\n\n<p>How to clean my rails console output, now I receive a lot of unnecessary text:</p>\n\n<pre><code>&gt;&gt; Subscription.where(user_id: User.last.id)\n  User Load (1.8ms)  SELECT \"users\".* FROM \"users\" ORDER BY \"users\".\"id\" DESC LIMIT 1\n#&lt;ActiveRecord::Relation:0x7f7f9ad69c70\n  @implicit_readonly = nil,\n  @join_dependency = nil,\n  @order_clause = nil,\n  @records = [],\n  @should_eager_load = nil,\n  attr_accessor :bind_values = [],\n  attr_accessor :create_with_value = {},\n ...\n</code></pre>\n\n<p><a href=\"https://gist.github.com/4025796\" rel=\"nofollow\">https://gist.github.com/4025796</a></p>\n"},{"tags":["ruby-on-rails","ruby","rvm","sproutcore"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":30,"score":0,"question_id":13246429,"title":"I am getting rvm: command not found after installation of rvm","body":"<p>I know the above question is very common question. I have gone through multiple posts on this topic. But I didn't get any resolution.</p>\n\n<p>I have installed rvm locally. We already have the installation files. SO went into the folder and run the install command.</p>\n\n<pre><code>$ ./install \n</code></pre>\n\n<p>Then I checked ./rvm folder in the Users home folde</p>\n\n<pre><code>$ cd ~/.rvm \n</code></pre>\n\n<p>folder exists. Hence Installation is successful.</p>\n\n<p>Now I am typing rvm in the command line</p>\n\n<pre><code>$ rvm\n</code></pre>\n\n<p>I am getting below exception</p>\n\n<pre><code>$ rvm\n-sh: rvm: command not found\n</code></pre>\n\n<p>After reading the multiple articles in stackoverflow on this issue, I learned that I have to add the below lines in .bash_profile as I am using Mac OSX 10.7.3</p>\n\n<pre><code>[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\"\n</code></pre>\n\n<p>Even after I am getting same exception while typing rvm. Is there any thing extra I need to do? or Am I missing some thing? Please help</p>\n"},{"tags":["ruby","hash","ruby-1.9.3"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":500,"score":0,"question_id":9025277,"title":"How do I extract a sub-hash from a hash?","body":"<p>I have a hash:</p>\n\n<pre><code>h1 = {:a =&gt; :A, :b, =&gt; :B, :c =&gt; C, :d =&gt; :D}\n</code></pre>\n\n<p>What is the best way to extract a sub-hash like this?</p>\n\n<pre><code>h1.extract_subhash(:b, :d, :e, :f) # =&gt; {b =&gt; :B, :d =&gt; :D}\nh1 #=&gt; {:a =&gt; :A, :c =&gt; :C}\n</code></pre>\n"},{"tags":["c++","ruby","translate"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":13254978,"title":"Translating ruby to C++","body":"<p>I dont understand ruby am trying to translate ruby to c++. I rewrote the code 3 times and still its not giving the same output as the Ruby code.</p>\n\n<p>Here is the Ruby code:</p>\n\n<pre><code># O(n(log(n))^2) solution for http://opc.iarcs.org.in/index.php/problems/FINDPERM\n\n# Binary Indexed Tree (by Peter Fenwick)\n# http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=binaryIndexedTrees\nclass FenwickTree\n\n  # Initialize array 1..n with 0s\n  def initialize(n)\n    @n = n\n    @m = [0] * (n + 1)\n  end\n\n  # Add value v to cell i\n  def add(i, v)\n    while i &lt;= @n\n      @m[i] += v\n      i += i &amp; -i\n    end\n  end\n\n  # Get sum on 1..i\n  def sum(i)\n    s = 0\n    while i &gt; 0\n      s += @m[i]\n      i -= i &amp; -i\n    end\n    s\n  end\n\n  # Array size\n  def n\n    return @n\n  end\n\nend\n\n# Classical binary search\n# http://en.wikipedia.org/wiki/Binary_search_algorithm\nclass BinarySearch\n\n  # Find lower index i such that ft.sum(i) == s\n  def self.lower_bound(ft, s)\n    l, r = 1, ft.n\n    while l &lt; r\n      c = (l + r) / 2\n      if ft.sum(c) &lt; s\n        l = c + 1\n      else\n        r = c\n      end\n    end\n    l\n  end\n\nend\n\n# Read input data\nn = gets.to_i\nq = gets.split.map &amp;:to_i\n\n# Initialize Fenwick tree\nft = FenwickTree.new(n)\n1.upto(n) do |i|\n  ft.add i, 1\nend\n\n# Find the answer\nans = [0] * n\n(n - 1).downto(0) do |i|\n  k = BinarySearch.lower_bound(ft, q[i] + 1)\n  ans[n - k] = i + 1\n  ft.add k, -1\nend\nputs ans.join(' ')\n</code></pre>\n\n<p>Here is my attempt to rewrite it in C++:</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint n;\nint M[100];\n\nvoid add(int i,int v){\n  while(i &lt;= n){\n    M[i] = M[i] + v;\n    i++;\n  }\n}\n\nint sum(int i){\n  int s = 0;\n  while(i &gt; 0){\n    s = s+ M [i];\n    i--;\n  }\n  return s;\n} \n\nint lower_bound(int s){\n  int l  = 1, r = n;\n  while(l &lt; r){\n    int c = (l+r)/2;\n    if(sum(c) &lt; s){\n        l = c+1;\n    }else{\n        r = c;\n    }\n  }\n  return l;\n}\n\nint main(){\n  cin &gt;&gt; n;\n  for(int i = 0;i &lt;= n ;i ++){\n    M[i] = 0;\n  }\n\n  int Q[n];\n  for(int i = 0;i &lt; n; i++){\n    cin &gt;&gt; Q[i];\n  }\n\n  int ans[n];\n      for(int i = 0;i &lt;= n; i++){\n            add(i,1);\n      }\n\n\n\n  for(int i = n-1;i &gt;= 0;i --){\n    int k = lower_bound(Q[i]+1);\n    ans[n-k] = i+1;\n    add(k,-1);\n  }\n\n  for(int i = 0;i &lt; n; i++){\n    cout &lt;&lt; ans[i] &lt;&lt; \" \";\n  }\n}\n</code></pre>\n\n<p>I have named all the variables same as the ruby implementation and instead of making the initialize function, I just initialized everything in main. </p>\n\n<p>Is there anything I am doing wrong in my code? Is it necessary to make classes like the Ruby implementation and why is the initialize function in the Ruby code never called?.</p>\n\n<p>Input:\n8\n0 1 0 2 2 1 2 0</p>\n\n<p>Expected Output:\n2 4 5 1 7 6 3 8</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":2508,"score":11,"question_id":944126,"title":"Rails: HasManyThroughAssociationNotFoundError","body":"<p>I have problems with getting a has_many through association to work.\nI keep getting this exception:</p>\n\n<pre><code>Article.find(1).warehouses.build\nActiveRecord::HasManyThroughAssociationNotFoundError: Could not find the association :entries in model Article\n</code></pre>\n\n<p>These are the models involved:</p>\n\n<p><pre>\nclass Article &lt; ActiveRecord::Base\n  has_many :warehouses, :through => :entries\nend</p>\n\n<p>class Warehouse &lt; ActiveRecord::Base\n  has_many :articles, :through => :entries\nend</p>\n\n<p>class Entry &lt; ActiveRecord::Base\n  belongs_to :article\n  belongs_to :warehouse\nend\n</pre></p>\n\n<p>And this is my schema:</p>\n\n<pre>\n  create_table \"articles\", :force => true do |t|\n    t.string   \"article_nr\"\n    t.string   \"name\"\n    t.integer  \"amount\"\n    t.string   \"warehouse_nr\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\n    t.integer  \"unit\"\n  end\n\n  create_table \"entries\", :force => true do |t|\n    t.integer \"warehouse_id\"\n    t.integer \"article_id\"\n    t.integer \"amount\"\n  end\n\n  create_table \"warehouses\", :force => true do |t|\n    t.string   \"warehouse_nr\"\n    t.string   \"name\"\n    t.integer  \"utilization\"\n    t.datetime \"created_at\"\n    t.datetime \"updated_at\"\nend\n</pre>\n"},{"tags":["ruby","gem","debian","crontab","whenever"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":1,"view_count":36,"score":0,"question_id":13253118,"title":"Is it possible to use the 'whenever' ruby gem while not having permission to use crontab?","body":"<p>I'm about to write a script which execute some ruby scripts in a scheduled manner.\nProduction env: Enterprise's cluster running debian with restricted permissions for users so I don't have permissions to edit cron table files. can I use whenever ruby gem? \nruby 1.9.1\nThank you for your answers.</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":61,"score":0,"question_id":13118825,"title":"Return first 10 key values for hash","body":"<p>I am reading a JSON like this:</p>\n\n<pre><code>[\n  {\n    \"Low\": 8.63,\n    \"Volume\": 14211900,\n    \"Date\": \"2012-10-26\",\n    \"High\": 8.79,\n    \"Close\": 8.65,\n    \"Adj Close\": 8.65,\n    \"Open\": 8.7\n  },\n  {\n    \"Low\": 8.65,\n    \"Volume\": 12167500,\n    \"Date\": \"2012-10-25\",\n    \"High\": 8.81,\n    \"Close\": 8.73,\n    \"Adj Close\": 8.73,\n    \"Open\": 8.76\n  },\n  {\n    \"Low\": 8.68,\n    \"Volume\": 20239700,\n    \"Date\": \"2012-10-24\",\n    \"High\": 8.92,\n    \"Close\": 8.7,\n    \"Adj Close\": 8.7,\n    \"Open\": 8.85\n  },\n  {\n    \"Low\": 8.78,\n    \"Volume\": 23433900,\n    \"Date\": \"2012-10-23\",\n    \"High\": 8.94,\n    \"Close\": 8.78,\n    \"Adj Close\": 8.78,\n    \"Open\": 8.93\n  }\n]\n</code></pre>\n\n<p>Using this:</p>\n\n<pre><code>json = File.read(\"#{symbols[0]}.json\")\n</code></pre>\n\n<p>Then doing this:</p>\n\n<pre><code>result = JSON.parse(json)\n</code></pre>\n\n<p>Then, when I want to select the first value for the key value \"Low\", I did this:</p>\n\n<pre><code>puts result[0]['Low']\n</code></pre>\n\n<p>This returned 58.75 (correct).</p>\n\n<p><strong>But I want to get the first three values for \"Low\". I tried doing the following, but it doesn't work (says can't convert string to integer). Why?</strong></p>\n\n<pre><code>puts result[0..2]['Low']\n</code></pre>\n"},{"tags":["sql","ruby","activerecord","stored-procedures"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":13221902,"title":"Return rows where the count of a character is?","body":"<p>I'm developing a rudimentary word finder app with sql and ruby where I have an array of letters to find available words.  It's easier to make the query by narrowing down what alphabetic letters aren't in the array. For ex.</p>\n\n<pre><code>alphabet= %w{a b c d e f g h i j k l m n o p q r s t u v w x y z}\n\navailable_letters = %w{p k z l p m t l n g g r u a r t n d z w a l m n e}\n</code></pre>\n\n<p>I can then subtract from alphabet, letters to exclude from my search and end up with an sql query like the one below.</p>\n\n<pre><code>select * from words\nwhere word not like '%b%' and word not like '%c%' and word not like '%f%'.....\n</code></pre>\n\n<p>This gives me all the available words with a combination of all available letters.  It does not narrow them down by the number of times that letter occurs.  So if I only have one \"E\",  I would like the query to narrow down words that only contain one e.  I'm not sure if this can be done with an sql query or whether I will need to use a procedure.  Anyone know a good way of solving this?</p>\n"},{"tags":["ruby","regex","string","double-quotes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13252743,"title":"Create Regex from String stored in variable with escaped characters (Ruby)","body":"<p>I'm trying to build a regex from a string object, which happens to be stored in a variable.</p>\n\n<p>The problem I'm facing is that escaped sequences (in the string) such \"\\d\" doesn't make to the resulting regex.</p>\n\n<pre><code>Regexp.new(\"\\d\") =&gt; /d/\n</code></pre>\n\n<p>If I use single quotes, tough, it works flawless.</p>\n\n<pre><code>Regexp.new('\\d') =&gt; /\\d/\n</code></pre>\n\n<p>But, as my string is stored in a variable, I always get the double-quoted string. </p>\n\n<p>Is there a way to turn a double-quoted string to single-quoted string, so that I could use in the Regexp constructor ?</p>\n\n<p>(I'd like to use the string interpolation feature of the double quotes)</p>\n\n<p>ex.:</p>\n\n<pre><code>email_pattern = \"/[a-z]*\\.com\"\nwhole_pattern = \"to: #{email_pattern}\"\nRegexp.new(whole_pattern)\n</code></pre>\n\n<p>For better readability, I'd like to avoid escaping escape characters.</p>\n\n<pre><code>\"\\\\d\"\n</code></pre>\n"},{"tags":["ruby","github","compilation","coffeescript","pdfkit"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":32,"score":3,"question_id":13221185,"title":"how to build pdfkit with new afm from the github repository","body":"<p>pdfkit-www is a great library. It enable you to output a pdf directly from the browser.</p>\n\n<p>To see the demo : <a href=\"http://ef4.github.com/pdfkit-www/demo.html\" rel=\"nofollow\">http://ef4.github.com/pdfkit-www/demo.html</a></p>\n\n<p>From the demo, I took the pdfkit.min.js file ; and it works good. Except for the font ; the only embed font is Arial and font embeding from a directory is not yet supported. If you want to have more font, you have to build the pdfkit.min.js and add the font metrics you want to use in the directory ; as explained here : <a href=\"https://github.com/ef4/pdfkit-www#building\" rel=\"nofollow\">https://github.com/ef4/pdfkit-www#building</a></p>\n\n<p>The point is that I have no idea about how to do this. This is ruby and coffee script powered. But here, I feel like a baby monkey in front of a big equation.</p>\n\n<p>Where do I type stuff ? (I'm on windows 7) I tried to type that stuff in the basic windows command line, in the ruby.exe command line and in the command line that open when you click on \"open a shell here\" when you cloned the repository on the github client.</p>\n\n<p>/* ----- Edit ----- */</p>\n\n<p>Ok, it looks like I should do it with the \"Git Shell\" (did not see the icon on my desktop first). The first two line seems to work, but the \"bundle install\" throw an error. (no recognized).</p>\n\n<p>And the \"rake\" line abort because it \"cannot load such file -- bundler\".</p>\n\n<p>/* ----- Edit 2 after Duck Boyle answer ----- */ (ok, this is better with an edit)</p>\n\n<p>Ok, thanks a lots, this solved the first problem.</p>\n\n<p>Now the \"bundle install\" command threw :</p>\n\n<pre><code>Your Gemfile has no remote source. If you need gems that are not already on your machine, add a line like this to your Gemfile : source 'https://rubygems.org'\nCould not find rake-0.9.2 in any of the sources\n</code></pre>\n\n<p>And the \"rake\" command threw :</p>\n\n<pre><code>cannot load such file -- uglifier\n</code></pre>\n\n<p>So I tried \"gem install uglifier\" wich seemed to solve the error for the \"rake\" command by installing uglifier of course ; then i went in a few gem install for different version of json and execjs and other stuff, according to what the errors told me to do ; untill the \"bundle install\" command threw :</p>\n\n<pre><code>Using lib..\n...\nYour bundle is complete !\n</code></pre>\n\n<p>YOOHOO !</p>\n\n<p>But now, the \"rake\" command throw :</p>\n\n<pre><code>rake aborted!\nType Error : This objet cannot manage this property or method\n</code></pre>\n\n<p>I did run the command with --trace ; but I have absolutely no idea about what I have to watch here :</p>\n\n<p><img src=\"http://i.stack.imgur.com/VtrMZ.png\" alt=\"enter image description here\"></p>\n\n<p>/* ----- Edit 3 ----- */</p>\n\n<p>Yes, I did put the source 'https://rubygems.org' in my gem file, this is what gave me the clues to install all the gems I should install.</p>\n\n<p>(please don't moke me too much I'm only a designer that don't understand everything when it is question about more than the basic html / css stuff)</p>\n"},{"tags":["ruby","mixins"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13254207,"title":"Can I override AcitveRecord::Base#to_json on a model instance?","body":"<p>In Rails 2.3 I have a Rails engine which has its own namespaced controllers, but which will use the main app's models.</p>\n\n<p>However, I want to override the default behavior of ActiveRecord::Base#to_json method <em>but only when the model is being used from the Engine</em>.</p>\n\n<p>So in an Engine controller is it reasonable to do something like...</p>\n\n<pre><code>category.questions.each do |qst|\n  # override ActiveRecord::Base#to_json somehow on the qst instance \nend\n</code></pre>\n\n<p>...if it is reasonable conceptually, how would I actually go about such a thing?</p>\n\n<p>If it's not reasonable, what is the best way to override ActiveRecord::Base#to_json for the Engine only, and not the main app?</p>\n\n<p>Thanks,</p>\n\n<p>Paul </p>\n"},{"tags":["java","ruby","rest","jruby","client-library"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":10725318,"title":"Java compatible REST client in Ruby","body":"<p>I need to create a client library to access a REST-based web service via HTTPS.  </p>\n\n<p>Not being overly familiar with Java, I would like to do this in Ruby, and then compile to a jar.</p>\n\n<p>The payload I will send will be (in JSON) something like:</p>\n\n<pre><code>{\n  \"api-token\": \"12345\",\n  \"org_number\": 5,\n  \"name\": \"ABC corp\",\n  \"users\": {\n    \"employee_number\": 1,\n    \"name\": \"bob jones\",\n    \"email\": \"bob@abc.com\"\n  }\n}\n</code></pre>\n\n<p>I assume the client library will need to:</p>\n\n<ul>\n<li>Initialize a new API interface instance with API token</li>\n<li>Give the instance organization information and set of users</li>\n<li>Tell the instance to serialize the organization and users to JSON, and POST to the webservice /org/new</li>\n</ul>\n\n<p>So my question is:</p>\n\n<ul>\n<li>How do I structure my Ruby classes to produce an interface a Java programmer will be comfortable with (something like <a href=\"http://twitter4j.org/en/code-examples.html\" rel=\"nofollow\">http://twitter4j.org/en/code-examples.html</a> for example)</li>\n</ul>\n"},{"tags":["ruby","vim","macvim"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":10466106,"title":"Getting Rubytest to work with MacVim","body":"<p>I am trying to get Rubytest.vim to work with my Macvim installation.</p>\n\n<p>I have dropped the rubytest.vim script to ~/.vim/plugin folder.</p>\n\n<p>I had to remap the keys that rubytest uses from \\t to \\r due to conflicts with other mappings.</p>\n\n<p>On trying the run a single test with \\r, Macvim shows the text </p>\n\n<pre><code> :call SNR&lt;82&gt;_Run(1)\n</code></pre>\n\n<p>at the bottom and nothing else happens.</p>\n\n<p>Not sure what is going on.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","selenium","rspec","capybara","authlogic"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13253490,"title":"Authlogic Webapp does not work any more in selenium-Javascript tests","body":"<p>Testing a Ruby on Rails application, I have working tests (also asa logged in user), however as soon as I put the \"<code>:js=&gt;true</code>\" option behind a test </p>\n\n<pre><code>it \"does\", :js =&gt; true do\n    activate_authlogic \n    visit '/'\nend\n</code></pre>\n\n<p>a get the web page with an internal error back </p>\n\n<pre><code> You must activate the Authlogic::Session::Base.controller with a controller object before creating objects\n</code></pre>\n\n<p>How can I get this to work? How can I determine the error more closely?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems","passenger","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":460,"score":1,"question_id":5103044,"title":"Bundler in production not ignoring the development and test gems","body":"<p>I have a couple of rails websites in production on a ubuntu webserver of ours..</p>\n\n<p>We're running Ubuntu 10.10 + Passenger and Apache.. and ruby enterprise edition version 1.8.7 (No RVM),</p>\n\n<p>I've been having a problem with bundler on both the sites.. </p>\n\n<p>Whenever i restart the app by touching restart.txt or by rebooting the server, The user sees an error saying passenger could not be started because it couldn't find nokogiri (a requirement of one of the test gems) so i try and run 'bundle install' which fails cause it tries to install nokogiri..</p>\n\n<p>I've tried running </p>\n\n<pre><code>bundle install --without development:test\n</code></pre>\n\n<p>And various other variations.. </p>\n\n<p>I think one of them worked until i restarted the app and we were back to square one again..</p>\n\n<p>So for the moment i resigned myself to commenting out all gems in the development and test group..</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n\n<p>Daniel</p>\n\n<hr>\n\n<p>Oh i forgot to mention.. I'm deploying using capistrano :)</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":45,"score":3,"question_id":13088352,"title":"Ruby: Is it possible to redefine a method but leave subclasses unchanged?","body":"<p>Suppose you have the following Ruby classes:</p>\n\n<pre><code>class A\n  def self.greet\n    puts 'hi'\n  end\nend\n\nclass B &lt; A; end;\nclass C &lt; B; end;\n</code></pre>\n\n<p>Is it possible to redefine <code>greet</code> on <code>B</code> in such a way that <code>C</code> still uses the original definition without modifying <code>C</code>?</p>\n\n<p>(I understand that \"you're doing it wrong\" is a probable reaction, but please assume for a moment that there's a good reason for doing this.)</p>\n\n<h2>Update</h2>\n\n<p>It's good to see yet another demonstration that Ruby will let you do whatever you want. However, to anyone finding this question and thinking of doing likewise, I should say that <strong>I did eventually realize I was doing it wrong</strong>; C needed to subclass A directly.</p>\n\n<p>Read on to receive your shotgun, and watch where you're aiming it. :)</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":13252823,"title":"Print and display white spaces as characters","body":"<p>I've failed to work out how I can print and display white space characters as something that I can actually 'see'.  So for example,</p>\n\n<pre><code>x = \"123\\n\"\nprint x\n</code></pre>\n\n<p>I'd like the output to be</p>\n\n<pre><code>123\\n\n</code></pre>\n\n<p>rather than</p>\n\n<pre><code>123\n.\n</code></pre>\n\n<p>The above '.' represents the new line created by '\\n'.</p>\n"},{"tags":["ruby","amazon-ec2","amazon-web-services","sinatra"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13231443,"title":"Which EC2 plan to choose?","body":"<p>I wrote my first web app using Sinatra. It's pretty simple with a REST interface. I am running MySQL database and it connects to it using active record, very cool stuff. Also, I am running  another ruby program which basically queries the MySQL database every 30 seconds and does some work on the data and updates the db. \nRight now, I am running sinatra app on my laptop. I want to move this to a server because i can't keep my laptop on all the time.</p>\n\n<p>I checked out Amazon EC2 and there's so many options that I am over whelmed. Is Amazon EC2 even a good choice? Is so, what option is best for me? I am not expecting any bandwidth.</p>\n\n<p>Any pointers for someone starting with webservers/hosting would be great, Thanks!</p>\n"},{"tags":["ruby","mongodb","sinatra","mongomapper"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13252911,"title":"Mongomapper - embedded document or one-to-many or ...?","body":"<p>There is an user model and an account model. An user can have many accounts. Approximately an user has 5 accounts. </p>\n\n<p>What kind of associations should I use in this case: EmbeddedDocument or one-to-many? </p>\n"},{"tags":["ruby","memory-management","struct","callstack"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13251609,"title":"Are ruby structs stack allocated?","body":"<p>Ruby <a href=\"http://www.ruby-doc.org/core-1.9.3/Struct.html\" rel=\"nofollow\">structs</a> are a convenient way to define lightweight data containers. My question is if they are allocated on the heap just like normal objects or on the stack (as in, for instance, C# value types). If they are heap-allocated then are there any performance benefits - or pitfalls - for ruby structs.</p>\n"},{"tags":["ruby","date"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13249952,"title":"How to get leading 0 in seconds?","body":"<p>I'm trying to get hours, minutes and seconds from current time and print it into format \"hourminutesecond\". For example \"121103\". But there isn't printed leading zero when I try to do it with next code</p>\n\n<pre><code>irb(main):021:0&gt; ct = Time.now\n=&gt; 2012-11-06 12:11:03 +0100\nirb(main):022:0&gt; \"#{ct.hour}#{ct.min}#{ct.sec}\"\n=&gt; 12113\n</code></pre>\n\n<p>Output is \"12113\" but I want \"121103\".</p>\n\n<p>Is there method or option for that. I can extract it with regex but just wondering if there is easier way to do it.</p>\n"},{"tags":["ruby","interrupt","net-sftp"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":9894407,"title":"Ruby Net::SFTP transfer interrupt handling","body":"<p>How to handle Ruby Net::SFTP transfer interruption like network disconnection?</p>\n\n<p>When I run my example code and the network is disconnected during the transfer, application stays running.</p>\n\n<pre><code>require 'net/sftp'\n\nNet::SFTP.start(\"testing\",\"root\",:timeout=&gt;1) do |sftp|\n    begin\n        sftp.download!(\"testfile_100MB\", \"testfile_100MB\")\n    rescue RuntimeError =&gt;e\n        puts e.message\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","scopes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13251468,"title":"rails 3 scopes inherited from other models","body":"<p>is there any way to use one model scopes as part of another model scope?</p>\n\n<p>Example</p>\n\n<pre><code>class DocumentVersion &lt; ActiveRecord::Base\n  belongs_to :document\n  scope :are_latest, lambda{ where(latest: true)}\nend\n\nclass Document &lt; ActiveRecord::Base\n  has_many :document_versions\n  scope :are_latest, lambda { ...something... } # I want something that will get documents that have documnet_versions that are_latest\n\n  # I know I can do this \n  scope :are_latest,   lambda{ joins(:document_versions).where('document_versions.latest = true') }  # this works well\n\n  # but I would like to keep that condition its own model\n  scope :are_latest, lambda { joins(:document_versions).are_latest } # this wont obviously work, but something like that \n\nend\n</code></pre>\n"},{"tags":["ruby","http","post","binary-data","rest-client"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":213,"score":0,"question_id":11025839,"title":"How to POST binary data using Rest Client?","body":"<p>I am trying to read in an audio file of type wav or amr from a HTML form using Rest Client. I have the code to do this in PHP.</p>\n\n<pre><code>$filename = $_FILES['f1']['name'];\n\npublic function getFile($filename) {\n      if (file_exists($filename)) {\n          $file_binary = fread(fopen($filename, \"r\"), filesize($filename));\n          return $file_binary;\n       } else {\n          throw new Exception(\"File not found.\");\n       }\n  }\n</code></pre>\n\n<p>I need to convert this code to Ruby and I am having trouble doing so as I am a relative novice when it comes to Ruby.</p>\n"},{"tags":["ruby","arguments","ruby-2.0"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13250447,"title":"Can I have required named arguments in Ruby 2.x?","body":"<p>Ruby 2.0 is adding named arguments, like this:</p>\n\n<pre><code>def say(greeting: 'hi')\n  puts greeting\nend\n\nsay                     # =&gt; puts 'hi'\nsay(greeting: 'howdy')  # =&gt; puts 'howdy'\n</code></pre>\n\n<p>How can I use named arguments without giving a default value, so that they are required?</p>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":210,"score":1,"question_id":7286589,"title":"Heroku Rails app v 1.2.6 failed to push: unrecognized error","body":"<p>I get this error when trying to push a Rails app v. 1.2.6 to Heroku:</p>\n\n<pre><code> !     Heroku push rejected due to an unrecognized error.\n !     We've been notified, see http://support.heroku.com if the problem persist\ns.\n\n\nTo git@heroku.com:myproject.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'git@heroku.com:myproject.git'\n</code></pre>\n"},{"tags":["ruby","authentication","openssl","rsa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13251106,"title":"Ruby OpenSSL error when try to decrypt a key with a fake RSA private key","body":"<p>Have this Ruby code:</p>\n\n<pre><code>require 'openssl'\nrequire 'securerandom'\n\nclass AuthRsa\n\ndef initialize(public_key, private_key)\n\n  @public_key = OpenSSL::PKey::RSA.new(public_key)\n  @private_key = OpenSSL::PKey::RSA.new(private_key)\n  @key = SecureRandom.base64(16)\nend\n\ndef valid?\n  crypt_key = @public_key.public_encrypt(@key)\n  return @key == @private_key.private_decrypt(crypt_key)\nend\nend\n</code></pre>\n\n<p>When test the class with correct public and private keys is all ok, but when submit a fake certificate the test fail with this error: OpenSSL::PKey::RSA Error: padding check failed</p>\n\n<p>Is possible to set the method private_decrypt to return false instead of an error?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13251054,"title":"How do I include the user objects n the json result?","body":"<pre><code>@song.likes.select('likes.*, users.*').includes(:user).to_json \n</code></pre>\n\n<p>Only converts the like objects. Is there a way to include the user objects in the json result? Via Ruby or other.</p>\n"},{"tags":["ruby-on-rails","ruby","monitoring","foreman","monit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13250706,"title":"Monitoring rails and ruby processes with Monit?","body":"<p>I have a rails application with some independent ruby processes, I would like to monitore each process using Monit, now in usual cases I do that easily , like as for example if I wanna monitor memcahed server, I can create a conf file like : </p>\n\n<pre><code>check process memcached with pidfile /var/run/memcached.pid\n  start program = \"/etc/init.d/memcached start\"\n  stop program = \"/etc/init.d/memcached stop\"\n</code></pre>\n\n<p>But as for rails and ruby, it's different, I just don't know how to manage PIDs or even run the service in /etc/init.d. </p>\n\n<p>I tried to create it using foreman gem with export feature but it didn't work out for me . </p>\n\n<p>Please note , that I have 3 processes, one rails and two other ruby processes </p>\n\n<p>Any help would be highly appreciated </p>\n"},{"tags":["ruby","arrays"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":66,"score":3,"question_id":13236571,"title":"Alphabetical order in array with multiple defaults on top","body":"<p>I have an array with strings and i would like it on alphabetical order but with some defaults on top. For example:</p>\n\n<pre><code>[\"a\", \"b\", \"default1\", \"d\", \"default2\", \"c\", \"e\"]\n</code></pre>\n\n<p>and I would like the result to be:</p>\n\n<pre><code>[\"default1\", \"default2\", \"a\", \"b\", \"c\", \"d\", \"e\"]\n</code></pre>\n\n<p>somebody has an idea how I can accomplish this easy?</p>\n\n<p>UPDATE</p>\n\n<p>The defaults are also included in the array and the array is in alphabetical order.</p>\n"},{"tags":["php","python","ruby","server-side"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":51,"score":-3,"question_id":13250321,"title":"Third-party web developers. Should I care which server-side language they use (ie PHP, Ruby, Python, etc)?","body":"<p>I'm working a project where an external development team will be asked to build a beta of a new web service. Even though it's a beta as well as being functionally operable it also needs to demonstrate robustness in design; security; scalability and extensibility.</p>\n\n<p>I've personally hacked around in various languages (PHP, Javascript, C, J2ME, SQL, UNIX shells, etc), but I don't consider myself a professional programmer, so I'm interested in others opinions on whether I should even be concerned by the language chosen or if I should focus on the relevant management (PM approach, source code control, testing, etc)?</p>\n\n<p>Thanks,\nPeter</p>\n"},{"tags":["ruby","zlib"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13250401,"title":"Ruby: Lower Level Zlib","body":"<p>I was considering porting a .NET application that uses Zlib to Ruby. However I hit a snag. The implementation of the application (in .NET) has custom changes to the compression length (by adding a 13) to it (as below). Don't ask why :(</p>\n\n<p>However using Ruby and it's (stdlib) Zlib api, the ability to define compression length is not possible (coming down to byte level/streams). And so the question is, is there a way to get this functionality</p>\n\n<ol>\n<li>In Another Library?</li>\n<li>Alternatives?</li>\n<li>Perhaps there is something I am missing and it is possible (I Checked the rdocs)?</li>\n</ol>\n\n<p>Thanks </p>\n\n<p><img src=\"http://i.stack.imgur.com/onytv.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13250014,"title":"set up default routes to common dir","body":"<p>Assume you have a couple of ruby/rails apps running on a server</p>\n\n<p>APP ExmplA:\ndir: /foo/bar/ExmplA\nruns on <a href=\"http://example.com:4111/\" rel=\"nofollow\">http://example.com:4111/</a></p>\n\n<p>APP ExmplB:\ndir: /foo/bar/ExmplB\nruns on <a href=\"http://example.com:4112/\" rel=\"nofollow\">http://example.com:4112/</a></p>\n\n<p>APP ExmplC:\ndir: /foo/bar/ExmplC\nruns on <a href=\"http://example.com:4113/\" rel=\"nofollow\">http://example.com:4113/</a></p>\n\n<p>now i have a common dir\n/pool/common/http/\nwhere i want the default root-routes (\"/\") of the 3 apps to point to.</p>\n\n<p>…so \"http://example.com:4113/somedir/something.txt\" should map to \"/pool/common/http/somedir/something.txt\", if not specified otherwise.</p>\n\n<p>What should I enter in the routes.rb of the 3 Apps?</p>\n"},{"tags":["ruby-on-rails","ruby","enumeration"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":44,"score":2,"question_id":13249872,"title":"ruby's \"any?\" and \"all?\" methods behaviour on Empty Arrays and Hashes","body":"<p>First of all I found two useful articles in documentations about these methods:</p>\n\n<ul>\n<li><a href=\"http://www.ruby-doc.org/core-1.9.3/Enumerable.html\" rel=\"nofollow\">http://www.ruby-doc.org/core-1.9.3/Enumerable.html</a></li>\n<li><a href=\"http://www.globalnerdy.com/2008/01/29/enumerating-rubys-enumerable-module-part-1-all-and-any/\" rel=\"nofollow\">http://www.globalnerdy.com/2008/01/29/enumerating-rubys-enumerable-module-part-1-all-and-any/</a></li>\n</ul>\n\n<blockquote>\n  <p>all?: Passes each element of the collection to the given block. The method returns true if the block never returns false or nil.</p>\n  \n  <p>any?: Passes each element of the collection to the given block. The method returns true if the block ever returns a value other than false or nil. </p>\n</blockquote>\n\n<p>But in case of empty arrays and hashes I got:</p>\n\n<pre><code>irb(main):004:0&gt; [nil, \"car\", \"bus\"].all?\n=&gt; false\nirb(main):005:0&gt; [\"nil\", \"car\", \"bus\"].all?\n=&gt; true\nirb(main):006:0&gt; [].all?\n=&gt; true\nirb(main):007:0&gt; [\"nil\", \"car\", \"bus\"].any?\n=&gt; true\nirb(main):008:0&gt; [nil, \"car\", \"bus\"].any?\n=&gt; true\nirb(main):009:0&gt; [nil].any?\n=&gt; false\nirb(main):010:0&gt; [].any?\n=&gt; false\n</code></pre>\n\n<p>Can somebody explain to me why empty arrays give me <code>false</code> in case of the <code>any?</code> method and <code>true</code> in case of <code>all?</code>?</p>\n"},{"tags":["ruby","pdf","prawn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12284946,"title":"Group text and images as a block with Prawn?","body":"<p>I'm trying to build a PDF from user-generated content and I have a chunk of information that should be grouped together. I know of the <code>group</code> method to make sure text all gets rendered together, but this doesn't seem to work with a mix of text and images. Is there something that can do this with Prawn, or do I need to try to calculate cursor position and manually linebreak?</p>\n\n<p>Edit: For illustration of what I'm looking to do:</p>\n\n<pre><code>pdf = PDF::Document.new\n20.times do\n  pdf.group do\n    pdf.text \"Something\"\n    pdf.image \"path/to/image.jpg\"\n    pdf.text Time.now.to_s\n  end\nend\n</code></pre>\n\n<p>And I would expect to not ever have \"Something\" on one page and the image on the next, but that is what I see. Is there some way I can achieve what I want?</p>\n"},{"tags":["ruby-on-rails","ruby","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13241481,"title":"In form sorting using ransack gem not working","body":"<p>I've been trying (unsuccessfully so far) to use the out of the box in-form sorting provided by the ransack gem, and the result of it unfortunately is an empty form.</p>\n\n<p><strong>Here's what I've done so far:</strong></p>\n\n<pre><code>Controller:\n    class LandingController &lt; ApplicationController\n      layout \"landing2\"\n      def index\n        @zones = Zone.all\n        @zone_id ||= 1\n        @q = Property.search(params[:q])\n        @q.build_sort if @q.sorts.empty?\n      end\n    end\n</code></pre>\n\n<p><strong>View (partial):</strong></p>\n\n<pre><code>&lt;%= search_form_for @q, :url =&gt; home_path, :html =&gt; { :method =&gt; :get } do |f| %&gt;\n  &lt;%= f.sort_fields do |s| %&gt;\n    &lt;%= s.sort_select %&gt;\n  &lt;% end %&gt;\n  &lt;%= f.submit \"Sort\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>And the result is:</strong></p>\n\n<p><img src=\"http://i.stack.imgur.com/Ibnzg.jpg\" alt=\"Ransack sort form(empty)\"></p>\n\n<p>Does anybody know what could possibly be wrong?</p>\n\n<p>Thanks for all the help!</p>\n"},{"tags":["ruby-on-rails","ruby","twitter","hash","gem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13248874,"title":"Can't parse hash from twitter gem","body":"<p>I have the gem working: can tweet from it and pull in info. </p>\n\n<p>I can grab this hash and print out the .text part of it but I can't figure out how to get the id_str and screen_name - info I really need to parse out.</p>\n\n<p>Not sure what i'm doing wrong. </p>\n\n<pre><code>  &lt;% Twitter.mentions_timeline.each do |mention| %&gt;\n      &lt;%= mention.text %&gt; &lt;%# dies on some of em, like mention.id_str - not sure why %&gt;\n      &lt;br /&gt;&lt;hr /&gt;         \n  &lt;% end %&gt;\n</code></pre>\n\n<p>Below is Twitter.mentions_timeline hash:</p>\n\n<pre><code>[#&lt;Twitter::Tweet:0x007fd070de24a0 \n\n\n\n\n@attrs={\n    :in_reply_to_status_id_str=&gt;\"265276218855809024\", \n    :retweet_count=&gt;0, \n    :contributors=&gt;nil, \n    :truncated=&gt;false, \n    :text=&gt;\"@doodleboots http://t.co/VJOR0MgQ\", \n    :in_reply_to_user_id_str=&gt;\"119208666\", \n    :geo=&gt;nil, \n    :retweeted=&gt;false, \n    :possibly_sensitive=&gt;false, \n    :in_reply_to_screen_name=&gt;\"doodleboots\", \n    :id_str=&gt;\"265276345704124416\", \n    :entities=&gt;{:hashtags=&gt;[], \n        :urls=&gt;[{:display_url=&gt;\"is.gd/S3uOyu\", \n        :indices=&gt;[13, 33], \n        :expanded_url=&gt;\"http://is.gd/S3uOyu\", \n        :url=&gt;\"http://t.co/VJOR0MgQ\"}], \n        :user_mentions=&gt;[{:name=&gt;\"doodle\", \n        :indices=&gt;[0, 12], \n        :screen_name=&gt;\"doodleboots\", \n        :id_str=&gt;\"119208666\", \n        :id=&gt;119208666}]}, \n        :in_reply_to_user_id=&gt;119208666, \n        :in_reply_to_status_id=&gt;265276218855809024, \n        :created_at=&gt;\"Mon Nov 05 02:16:24 +0000 2012\", \n        :place=&gt;nil, \n        :user=&gt;{:profile_image_url_https=&gt;\"https://si0.twimg.com/profile_images/2808322935/d5da93a06dbd45959cb4dba0797689a5_normal.jpeg\", \n        :id=&gt;926557182, \n        :profile_background_image_url=&gt;\"http://a0.twimg.com/images/themes/theme1/bg.png\", \n        :entities=&gt;{:description=&gt;nil}, \n        :screen_name=&gt;\"Roslyn1bdzn\", \n        :profile_link_color=&gt;\"0084B4\", \n        :default_profile_image=&gt;false, \n        :created_at=&gt;\"Mon Nov 05 01:17:20 +0000 2012\", \n        :contributors_enabled=&gt;false, \n        :friends_count=&gt;0, \n        :time_zone=&gt;nil, \n        :favourites_count=&gt;0, \n        :utc_offset=&gt;nil, \n        :profile_use_background_image=&gt;true, \n        :url=&gt;nil, :geo_enabled=&gt;false, \n        :lang=&gt;\"en\", \n        :profile_image_url=&gt;\"http://a0.twimg.com/profile_images/2808322935/d5da93a06dbd45959cb4dba0797689a5_normal.jpeg\", \n        :profile_text_color=&gt;\"333333\", \n        :name=&gt;\"Roslyn Montalbo \", \n        :profile_background_image_url_https=&gt;\"https://si0.twimg.com/images/themes/theme1/bg.png\", \n        :description=&gt;\"Amateur social media scholar. Friend of animals everywhere. Explorer. Unapologetic twitter advocate. Incurable travel geek. Writer\", \n        :protected=&gt;false, \n        :profile_sidebar_border_color=&gt;\"C0DEED\", \n        :followers_count=&gt;0, \n        :default_profile=&gt;true, \n        :profile_background_tile=&gt;false, \n        :location=&gt;\"Dublin\", \n        :profile_sidebar_fill_color=&gt;\"DDEEF6\", \n        :following=&gt;false, \n        :statuses_count=&gt;3, \n        :follow_request_sent=&gt;false, \n        :listed_count=&gt;0, \n        :id_str=&gt;\"926557182\", \n        :profile_background_color=&gt;\"C0DEED\", \n        :notifications=&gt;false, \n        :verified=&gt;false, \n        :is_translator=&gt;false}, \n        :coordinates=&gt;nil, \n        :source=&gt;\"web\", \n        :favorited=&gt;false, \n        :id=&gt;265276345704124416}&gt;,\n\n\n\n#&lt;Twitter::Tweet:0x007fd070de2478 \n\n    @attrs={:in_reply_to_status_id_str=&gt;nil,\n    :retweet_count=&gt;0, \n    :contributors=&gt;nil, \n    :truncated=&gt;false, \n    :text=&gt;\"test post @doodleboots\", \n    :in_reply_to_user_id_str=&gt;nil, \n    :geo=&gt;nil, \n    :retweeted=&gt;false, \n    :in_reply_to_screen_name=&gt;nil,  \n    :id_str=&gt;\"247909685582233600\", \n    :entities=&gt;{:hashtags=&gt;[], \n        :urls=&gt;[], \n        :user_mentions=&gt;[{:name=&gt;\"doodle\", \n            :indices=&gt;[10, 22], \n            :screen_name=&gt;\"doodleboots\", \n            :id_str=&gt;\"119208666\", \n            :id=&gt;119208666}]}, \n            :in_reply_to_user_id=&gt;nil, \n            :in_reply_to_status_id=&gt;nil, \n            :created_at=&gt;\"Tue Sep 18 04:07:29 +0000 2012\", \n            :place=&gt;nil, \n            :user=&gt;{:profile_image_url_https=&gt;\"https://si0.twimg.com/profile_images/728693845/doodleBootsIcon_normal.png\", \n            :id=&gt;119208666, \n            :profile_background_image_url=&gt;\"http://a0.twimg.com/images/themes/theme1/bg.png\", \n            :entities=&gt;{:description=&gt;{\n                :urls=&gt;[]}, \n                :url=&gt;{:urls=&gt;[{\n                    :display_url=&gt;nil, \n                    :indices=&gt;[0, 22], \n                    :expanded_url=&gt;nil, \n                    :url=&gt;\"http://doodleboots.com\"}]}}, \n                    :screen_name=&gt;\"doodleboots\", \n                    :profile_link_color=&gt;\"0084B4\", \n                    :default_profile_image=&gt;false, \n                    :created_at=&gt;\"Wed Mar 03 00:09:50 +0000 2010\", \n                    :contributors_enabled=&gt;false, \n                    :friends_count=&gt;16, \n                    :time_zone=&gt;nil, \n                    :favourites_count=&gt;0, \n                    :utc_offset=&gt;nil, \n                    :profile_use_background_image=&gt;true, \n                    :url=&gt;\"http://doodleboots.com\", \n                    :geo_enabled=&gt;false, \n                    :lang=&gt;\"en\", \n                    :profile_image_url=&gt;\"http://a0.twimg.com/profile_images/728693845/doodleBootsIcon_normal.png\", \n                    :profile_text_color=&gt;\"333333\", \n                    :name=&gt;\"doodle\", \n                    :profile_background_image_url_https=&gt;\"https://si0.twimg.com/images/themes/theme1/bg.png\", \n                    :description=&gt;\"Take a pic of a drawing/doodle and tweet it @doodleboots! It will be re-tweeted and posted to the website for all to see.\", \n                    :protected=&gt;false, \n                    :profile_sidebar_border_color=&gt;\"C0DEED\", \n                    :followers_count=&gt;14, \n                    :default_profile=&gt;true, \n                    :profile_background_tile=&gt;false, \n                    :location=&gt;\"\", \n                    :profile_sidebar_fill_color=&gt;\"DDEEF6\", \n                    :following=&gt;false, \n                    :statuses_count=&gt;16, \n                    :follow_request_sent=&gt;false, \n                    :listed_count=&gt;1, \n                    :id_str=&gt;\"119208666\", \n                    :profile_background_color=&gt;\"C0DEED\", \n                    :notifications=&gt;false, \n                    :verified=&gt;false, \n                    :is_translator=&gt;false}, \n                    :coordinates=&gt;nil, \n                    :source=&gt;\"web\", \n                    :favorited=&gt;false, \n                    :id=&gt;247909685582233600}&gt;, \n</code></pre>\n"},{"tags":["ruby","ubuntu","ssl","sinatra","webrick"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13248771,"title":"Sinatra on Ubuntu 12 - SSL error","body":"<p>Sinatra application, Ubuntu 12</p>\n\n<pre><code>#config.ru\nrequire 'sinatra/base'\nrequire 'openssl'\nrequire 'webrick'\nrequire 'webrick/https'\n\nclass App1 &lt; Sinatra::Base\n  get '/' do\n    'app1'\n  end\nend\n\nclass App2 &lt; Sinatra::Base\n  get '/' do\n    'app2'\n  end\nend\n\napp = Rack::Builder.new do \n  map '/app1' do\n    run App1\n  end\n  map '/app2' do\n    run App2\n  end\nend\n\nwebrick_options = {\n  :Port               =&gt; 8443,\n  :Logger             =&gt; WEBrick::Log::new($stdout, WEBrick::Log::DEBUG),\n  :DocumentRoot       =&gt; \"./public\",\n  :SSLEnable          =&gt; true,\n  :SSLCertificate     =&gt; OpenSSL::X509::Certificate.new(  File.open(\"/etc/ssl/certs/ssl-cert-snakeoil.pem\").read),\n  :SSLPrivateKey      =&gt; OpenSSL::PKey::RSA.new(          File.open(\"/etc/ssl/private/ssl-cert-snakeoil.key\").read),\n  :SSLCertName        =&gt; [ [ \"CN\",WEBrick::Utils::getservername ] ]\n}\n\nRack::Handler::WEBrick.run app, webrick_options\n</code></pre>\n\n<p>Then I run it</p>\n\n<pre><code>sudo rackup\n</code></pre>\n\n<p>it runs and it seems to be ok:</p>\n\n<pre><code>[2012-11-06 16:10:14] INFO  WEBrick 1.3.1\n[2012-11-06 16:10:14] INFO  ruby 1.9.3 (2012-04-20) [x86_64-linux]\n[2012-11-06 16:10:14] DEBUG TCPServer.new(0.0.0.0, 8443)\n[2012-11-06 16:10:14] DEBUG TCPServer.new(::, 8443)\n.......\n</code></pre>\n\n<p>but when I go to <code>http://localhost:8443/app1</code> I get</p>\n\n<pre><code>[2012-11-06 17:07:25] ERROR OpenSSL::SSL::SSLError: SSL_accept returned=1 errno=0 state=unknown state: http request\n        /usr/lib/ruby/1.9.1/openssl/ssl-internal.rb:164:in `accept'\n[2012-11-06 17:07:25] ERROR OpenSSL::SSL::SSLError: SSL_accept returned=1 errno=0 state=unknown state: http request\n        /usr/lib/ruby/1.9.1/openssl/ssl-internal.rb:164:in `accept'\n[2012-11-06 17:07:25] ERROR OpenSSL::SSL::SSLError: SSL_accept returned=1 errno=0 state=unknown state: http request\n        /usr/lib/ruby/1.9.1/openssl/ssl-internal.rb:164:in `accept'\n</code></pre>\n\n<p>and the label \"This web page is not available\" in the page.</p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","railstutorial.org"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":379,"score":0,"question_id":10884313,"title":"Michael Hartl Rails Tutorial chapter 7 error Action not found in UsersController","body":"<p>I'm following Michael Hartl's Rails Tutorial at the moment and I've managed to 7.22 without any major hitches. However I'm stumped by the output from the testing which says:</p>\n\n<pre><code>Failures:\n\n  1) UserPages signup with invalid information should not create a user\n     Failure/Error: expect{click_button submit }.not_to change(User, :count)\n     AbstractController::ActionNotFound:\n       The action 'create' could not be found for UsersController\n     # (eval):2:in `click_button'\n     # ./spec/requests/user_pages_spec.rb:29:in `block (5 levels) in &lt;top (required)&gt;'\n     # ./spec/requests/user_pages_spec.rb:29:in `block (4 levels) in &lt;top (required)&gt;'\n\n  2) UserPages signup with valid information should create a user\n     Failure/Error: expect{click_button submit}.to change(User, :count).by(1)\n     AbstractController::ActionNotFound:\n       The action 'create' could not be found for UsersController\n     # (eval):2:in `click_button'\n     # ./spec/requests/user_pages_spec.rb:42:in `block (5 levels) in &lt;top (required)&gt;'\n     # ./spec/requests/user_pages_spec.rb:42:in `block (4 levels) in &lt;top (required)&gt;'\n\nFinished in 0.7718 seconds\n6 examples, 2 failures\n</code></pre>\n\n<p>I've added the following to my users controllers page as instructed by the tutorial:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def show\n    @user = User.find(params[:id])\n  end\n\n  def new\n    @user = User.new\n  end\n\nend\n</code></pre>\n\n<p>but it still doesn't seem to work. I've tried adding a create method but that just throws back a missing template error...</p>\n\n<p>In case it helps here's the output of the rake routes command:</p>\n\n<pre><code>~/dev/rails/sample_app$ rake routes\n    users GET    /users(.:format)          users#index\n          POST   /users(.:format)          users#create\n new_user GET    /users/new(.:format)      users#new\nedit_user GET    /users/:id/edit(.:format) users#edit\n     user GET    /users/:id(.:format)      users#show\n          PUT    /users/:id(.:format)      users#update\n          DELETE /users/:id(.:format)      users#destroy\n     root        /                         static_pages#home\n   signup        /signup(.:format)         users#new\n     help        /help(.:format)           static_pages#help\n    about        /about(.:format)          static_pages#about\n  contact        /contact(.:format)        static_pages#contact\n</code></pre>\n\n<p>In response to a comment, the tests which are failing are:</p>\n\n<pre><code>   describe \"signup\" do\n\n      before{ visit signup_path }\n      let(:submit) {\"Create my account\"}\n\n      describe \"with invalid information\" do\n        it \"should not create a user\" do\n          expect{click_button submit }.not_to change(User, :count)\n        end\n      end\n\n      describe \"with valid information\" do\n        before do\n          fill_in \"Name\", with: \"Example User\"\n          fill_in \"Email\", with: \"user@example.com\"\n          fill_in \"Password\", with: \"foobar\"\n          fill_in \"Confirmation\", with: \"foobar\"\n        end\n\n        it \"should create a user\" do\n          expect{click_button submit}.to change(User, :count).by(1)\n        end\n      end\n    end\n</code></pre>\n\n<p>Thanks in advance for any advice!</p>\n"},{"tags":["ruby","oop","class","object"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":4,"view_count":44,"score":1,"question_id":13248510,"title":"difference between declaring object with single '@' and double '@' in Ruby","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5890118/what-does-variable-mean-in-ruby\">What does @@variable mean in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>What is the difference when I declare an object with double '@'    </p>\n\n<pre><code>@@lexicon = Lexicon.new()\n</code></pre>\n\n<p>and declaring object with single '@' in Ruby?</p>\n\n<pre><code>@lexicon = Lexicon.new()\n</code></pre>\n"},{"tags":["ruby","multithreading","thread-safety"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13248031,"title":"Accessing IO (Serial port) simulatenously from two different threads","body":"<p>I'm writing a program which reads and writes from and to the serial port.  There are two threads; one thread reads and writes from/to the serial port every 500ms, and the other thread writes to the serial port every 3s.</p>\n\n<p>The issue I'm having is, since 500ms is a multiple of 3s, at 3s, 6s, 9s... the 500ms loop fails to read/write from/to the serial port.  Is there are way to check whether the serial port is in use?</p>\n\n<pre><code>    counter = 0\n    switchRelays = DoEvery([3], 20) do\n        sp.write \"@00 WR #{relays[counter]}\\r\"\n        counter = (counter + 1) % relays.length\n    end\n\n    # This thread samples every 500ms.\n    sp.write \"@00 AI 0\\r\"\n    sleep 0.2\n    sample500 = DoEvery([0.5], 1.0/0.0) do |timeStamp|\n        if switchRelays.alive? == false\n            csv.close\n            puts 'Done'\n            sample500.exit\n        else\n            sleep 0.1\n            analogueStatus = sp.readline\n            sp.write \"@00 AI 0\\r\"\n        end\n    end\n</code></pre>\n"},{"tags":["ruby","hpricot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":20,"score":0,"question_id":13246008,"title":"how to extract onclick in Hpricot ruby","body":"<p>i want to get the parentID from this.  </p>\n\n<pre><code>&lt;div class=\"module-head\" onclick=\"getURL('/DU/initAction.do?parentId=1063&amp;categoryType=6')\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>how can i achieve this?</p>\n"},{"tags":["ruby","guid"],"answer_count":6,"favorite_count":6,"up_vote_count":12,"down_vote_count":0,"view_count":5999,"score":12,"question_id":1117584,"title":"Guids in Ruby","body":"<p>I have problem that is really easily solved with Guids. </p>\n\n<p>In particular, for a password reset workflow I would like to send a Guid token to a users email and have them reset their password using the token. Since guids are unique this is pretty secure and saves me emailing people passwords which is risky. </p>\n\n<p>I noticed there is one <a href=\"http://rubyforge.org/projects/uuid\">Guid gem</a> for Ruby but it looks quite old and it writes stuff to the file system. </p>\n\n<p>Does anyone know of any other gems that can create a globally unique identifier? </p>\n\n<p>I know I can just fall back to: </p>\n\n<pre><code>(0..16).to_a.map{|a| rand(16).to_s(16)}.join\n</code></pre>\n\n<p>But it does not really seem like a proper GUID ... </p>\n"},{"tags":["ruby","geektool"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12679974,"title":"Geektool and nokogiri = No Output","body":"<p>I have written a ruby script to grab some weather info for my desktop, ot works well in terminal but added to Geektool, no output and if i turn on Status Image it is red as FAILURE, whats wrong?</p>\n\n<p>My Code is this:</p>\n\n<pre><code>require 'nokogiri'\nrequire 'open-uri'\n\nfmt = ARGV[0]\n\n# Get a Nokogiri::HTML::Document for the page we’re interested in...\n\n####\ndef desc\n    # Weather Description\n    doc = Nokogiri::HTML(open('http://www.wetter24.de/wetter/59846-sundern/49X16163159.html?sredirect=cmVpc2V3ZXR0ZXIvc3VjaGVyZ2Vibmlzc2UuaHRtbD8mYW1wO3N3b3JkPTU5ODQ2JmFtcDtvcHRfdHlwZT1jaXR5JmFtcDtzcmVkaXJlY3Q9LTE%253D'))\n    desc = doc.css('.head_ww img')[0][\"title\"]\n    desc2 = desc.split(\" \")\n    return desc2[0]\nend\n\n\ndef temp\n    # Weather Temp\n    doc = Nokogiri::HTML(open('http://www.wetter24.de/wetter/59846-sundern/49X16163159.html?sredirect=cmVpc2V3ZXR0ZXIvc3VjaGVyZ2Vibmlzc2UuaHRtbD8mYW1wO3N3b3JkPTU5ODQ2JmFtcDtvcHRfdHlwZT1jaXR5JmFtcDtzcmVkaXJlY3Q9LTE%253D'))\n    desc = doc.css('.head_tt2')[0].text\n    return desc\nend \n\ndef img\n    # Weather Image\n    doc = Nokogiri::HTML(open('http://www.wetter24.de/wetter/59846-sundern/49X16163159.html?sredirect=cmVpc2V3ZXR0ZXIvc3VjaGVyZ2Vibmlzc2UuaHRtbD8mYW1wO3N3b3JkPTU5ODQ2JmFtcDtvcHRfdHlwZT1jaXR5JmFtcDtzcmVkaXJlY3Q9LTE%253D'))\n\n    desc = doc.css('.head_ww img')[0][\"src\"]\n    return desc\nend\n\ndes = desc\ntmp = temp\nimage = img\n\nif fmt == \"desc\"\n    puts des\nelsif fmt == \"temp\"\n    puts tmp\nelsif fmt == \"img\"\n    puts image\nend\n</code></pre>\n\n<p>I cannot find any errors or similar stuff? May this regard to data caching by Ruby?</p>\n\n<p>thx for help</p>\n"},{"tags":["ruby","geektool"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13217025,"title":"Geektool and Color Gem","body":"<p>Hi today i created the following script which works well in Terminal on OS X:</p>\n\n<pre><code>ruby\n\nrequire '/term/ansicolor'\ninclude Term::ANSIColor\n\nclass String\n  # colorization\n  def colorize(color_code)\n    \"\\e[#{color_code}m#{self}\\e[0m\"\n  end\n\n  def red\n    colorize(31)\n  end\n\n  def green\n    colorize(32)\n  end\n\n  def yellow\n    colorize(33)\n  end\n\n  def pink\n    colorize(35)\n  end\nend\n\n\ndef test\n   command = \"pmset -g assertions|grep -i sleep\"\n   res = `pmset -g assertions|grep -i sleep`  # note: ` not\nreturn res\nend\nvar = test\n\ndef test2\n   command = \"pmset -g |grep -i displaysleep\"\n   res = `pmset -g |grep -i displaysleep`  # note: ` not\nreturn res\nend\n\ndef test3\n   command = \"pmset -g assertions|grep -i pid\"\n   res = `pmset -g assertions|grep -i pid`  # note: ` not\nreturn res\nend\n\ndef test4\n   res = `pmset -g |grep \"sleep                \"`  # note: ` not\nreturn res\nend\n\n\nvar3 = test3\n\narray = var3.split\n\nvar2 = test2\n\narray = var3.split\n\nmatch = var.rindex('PreventUserIdleSystemSleep     1')  \nmatch2 = var2.rindex('displaysleep         1')  \n\nmyString = var\nmyString2 = var2\n\nif match == nil\n    tmp = \"PreventUserIdleSystemSleep\".green\n    myString[\"PreventUserIdleSystemSleep\"]= \"\\e[1m\"+tmp+\"\\e[0m\"\nelse\n    tmp = \"PreventUserIdleSystemSleep\".red\n    myString[\"PreventUserIdleSystemSleep\"]= \"\\e[1m\"+tmp+\"\\e[0m\"\nend\n\nif match2 == nil\n    tmp = \"displaysleep\".red\n    myString2[\"displaysleep\"]= \"\\e[1m\"+tmp+\"\\e[0m\"\nelse\n    tmp = \"displaysleep\".green\n    myString2[\"displaysleep\"]= \"\\e[1m\"+tmp+\"\\e[0m\"\nend\n\n# Display Sleep\nds = test2\nds2 = ds.split(\" \")\n\nif ds2[1] != \"1\" || ds2[2] != nil\n    puts ds.strip!.red \nelse \n    puts ds.strip!.green\nend \n\n# Sleep Timer Check\nslp = test4\nsleeper = slp.split(\" \")\ntmp = sleeper[2]\nif sleeper[1] != \"1\" || sleeper[2] != nil\n    puts slp.strip!.red\nelse\n    puts slp.strip!.green\nend\nputs [\"2550\".hex].pack(\"U\") * 25\n\n\neles = Array.new\neles = var.split(\"\\n\")\nfor i in 0..2\n    puts eles[i].strip!\nend\nputs [\"2550\".hex].pack(\"U\") * 25\n\n\npid = eles.last\npid2 = pid.split(\")\")\n\npids = Array.new \n\nfor i in 0..pid2.length-1\n    tmp = pid2[i][0..4].strip!\n    if tmp == \"pid\"\n        pids.push pid2[i]\n    end\nend\n\ncleaner = Array.new\ncleaner = pids.uniq\n\nfor i in 0..cleaner.length-1\n    tmp3 = cleaner[i].split(\"(\")\n    tmp4 = tmp3[1].split(\")\")\n    tmp5 = tmp3[0].strip!.split(\" \")\n    puts tmp5[1] + \" \" +tmp4[0].bold\nend\n\n\n\nputs \"\\n Atxx-iMac:\" + [\"258B\".hex].pack(\"U\").blink\n</code></pre>\n\n<p>But unfortunately it doesn't work in Geektool. Well i guess it relates to the REQUIRE line and the path, but i cannot find the absolute path for this. Can someone please help?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","caching","rabl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13192550,"title":"Fragment caching in a rabl view?","body":"<p>I read <a href=\"https://github.com/nesquena/rabl/wiki/Caching-in-RABL\" rel=\"nofollow\">rabl caching doc</a> and I don't get how I can cache fragment of code.\nI have a view like this (there more code, but I removed it for simplicity's sake):</p>\n\n<pre><code>object @video\n\nattributes :id, :user_id, :event_id\n\nchild :event do\n  attributes :id\n  node(:name) { |event| event.name }\nend\n\nchild :user do\n  attributes :id\nend\n</code></pre>\n\n<p>And I want to cache :event child for two hours. How can I do that?</p>\n\n<p>I'm using rabl(0.7.6), rails(3.2.0), ruby(1.9.3p125)</p>\n"},{"tags":["ruby","date","datetime","iterator"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":71,"score":0,"question_id":13235605,"title":"What is a clean and idiomatic way to insert missing minutes in an array in Ruby?","body":"<p>Consider an array of datetimes:</p>\n\n<pre><code>2010-07-17 16:09:00 -0700\n2010-07-17 16:10:00 -0700\n2010-07-17 16:12:00 -0700\n2010-07-17 17:44:00 -0700\n2010-07-18 02:12:00 -0700\n</code></pre>\n\n<p>What is a clean and idiomatic way to iterate over the array and insert missing minutes, so that the output is:</p>\n\n<pre><code>2010-07-17 16:09:00 -0700\n2010-07-17 16:10:00 -0700\n2012-07-17 16:11:00 -0700\n2010-07-17 16:12:00 -0700\n2010-07-17 16:13:00 -0700\n...\n</code></pre>\n\n<p>Ruby 1.9.3</p>\n\n<p>EDIT: More info:</p>\n\n<p>It is actually an array of hashes, with datetimes as the key:</p>\n\n<pre><code>2010-07-17 16:09:00 -0700 =&gt; 5\n2010-07-17 16:10:00 -0700 =&gt; 22\n2010-07-17 16:12:00 -0700 =&gt; 3\n</code></pre>\n\n<p>So, each missing minute should have the value of the previous existing minute.</p>\n\n<p>Also, not using Rails.</p>\n"},{"tags":["ruby","time","iso"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13247288,"title":"converting Time class object to RFC3339 in Ruby","body":"<p><a href=\"https://developers.google.com/google-apps/calendar/v2/developers_guide_protocol\" rel=\"nofollow\">Google Calendar API(v2)</a>'s time-related query is required to be RFC3339-formatted. When I looked up Time class after 'require \"time\"', I could not see rfc3339 method.</p>\n"},{"tags":["ruby-on-rails","ruby","rvm","rmagick"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1274,"score":2,"question_id":10063051,"title":"Bundle can't install RMagick gem on Mac OSX 10.7","body":"<p>I've installed ImageMagick with ImageMagick installer script <a href=\"https://github.com/maddox/magick-installer\" rel=\"nofollow\">https://github.com/maddox/magick-installer</a>. I am on OSX Lion 10.7, using RVM, Ruby 1.9.3p125.</p>\n\n<p>The problem seems to be with MagickWand.h here is the complete log</p>\n\n<pre><code>/Users/pdjimeno/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb\nchecking for Ruby version &gt;= 1.8.5... yes\nextconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.\nchecking for /usr/bin/gcc... yes\nchecking for Magick-config... yes\nchecking for ImageMagick version &gt;= 6.4.9... yes\nchecking for HDRI disabled version of ImageMagick... yes\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nPackage MagickCore was not found in the pkg-config search path.\nPerhaps you should add the directory containing `MagickCore.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'MagickCore' found\nchecking for stdint.h... yes\nchecking for sys/types.h... yes\nchecking for wand/MagickWand.h... no\n\nCan't install RMagick 2.13.1. Can't find MagickWand.h.\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/pdjimeno/.rvm/rubies/ruby-1.9.3-p125/bin/ruby\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","capitalization","pluralize"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13246002,"title":"pluralize and decapitalize nouns in Ruby","body":"<p>I am implementing a view count feature for particular web pages in Ruby on Rails. I use haml lists to achieve my end. (The JavaScript library takes the list and render it as dropdowns.) </p>\n\n<p>Here is the code snippet:</p>\n\n<pre><code>%li.action\n  = link_to t(question.views_count.to_s + ' views')\n</code></pre>\n\n<p>My problem here is that the V in views is capitalized in the output and view is pluralized even for 0 and 1 number of views. Is there any way I can deal with these issues?</p>\n"},{"tags":["ruby-on-rails","ruby","aasm"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13235216,"title":"How to invoke Ruby gem AASM transition event given to and from states?","body":"<p>We have a Ruby on Rails application.</p>\n\n<p>We're using Ruby's aasm gem to manage states of objects.</p>\n\n<pre><code>&lt;pre&gt;\nhas_state\naasm do\n    state :created, :initial =&gt; true\n    state :submitted\n    state :rejected\n    state :approved\n\n    event :submit do\n        transitions :to =&gt; :submitted, :from =&gt; [:created]\n    end\n\n    event :mark_as_incomplete do\n        transitions :to =&gt; :created, :from =&gt; [:submitted]\n    end\n\n    event :approve do\n        transitions :to =&gt; :approved, :from =&gt; [:submitted]\n    end\n\n    event :reject do\n        transitions :to =&gt; :rejected, :from =&gt; [:submitted]\n    end\nend\n&lt;code&gt;\n</code></pre>\n\n<p>If we know an object's current state, which can be obtained using</p>\n\n<pre><code>&lt;pre&gt;\nobject.aasm_current_state\n&lt;code&gt;\n</code></pre>\n\n<p>and we also know the state to transition to, how can we invoke the event?</p>\n\n<p>Please note, the from-state and to-state are variables, so we need to do the above\ndynamically.  Of course, with certain to-state and from-state combination, the transition isn't available, in that case we should detect an error.</p>\n\n<p>We're also assuming between any two state combination (to-state and from-state), there's only 1 event, I think theoretically there can be more than 1.</p>\n\n<p>I think this can be achieved by delving into the innards of aasm source code,\nwhich, arguably, may not be a good practice.  Any thoughts?</p>\n\n<p>Just wonder if anyone has done this before.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":5,"favorite_count":11,"up_vote_count":22,"down_vote_count":0,"view_count":10952,"score":22,"question_id":3873190,"title":"f.error_messages in Rails 3.0","body":"<p>Rails 3.0 deprecated <code>f.error_messages</code> and now requires a plugin to work correctly - I however want to learn how to display error messages the (new) native way. I am following the <a href=\"http://edgeguides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">getting started guide</a>, which uses the deprecated method when implementing the comments form. For example:</p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n&lt;div class=\"field\"&gt;\n  &lt;% f.label :commenter  %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :commenter  %&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :body %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :body %&gt;\n&lt;/div&gt;\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the correct way to do it (as generated by the scaffold):</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n  &lt;% if @post.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt; prohibited this post from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @post.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n . . . \n</code></pre>\n\n<p>I understand that I use the <code>@post</code> variable in the latter example, but what variable do I reference in the former to get the error messages for comment creation?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13238616,"title":"Rails Override Save To Perform Selective Update","body":"<p>I am working on a Rails 3.2.8 application that uses a homegrown REST API to insert new data.  The insertion logic is generic for every endpoint and results quite simply in a call to Model.save.  </p>\n\n<p>For one of the model types I would like to first check if a pre-existing record exists and if so, update as opposed to insert.  If the code allowed me to interact at the Controller level this would be easy through the use of find_or_create_by, however (I think) my only option is to override the save method in the Model or use a before_save callback.</p>\n\n<p>I'm struggling to figure out a way to make this work, as any calls to save or update_attributes inside the Model simply results in an infinite loop (for obvious reasons).</p>\n\n<p>Is there a way to utilize either before_save or to override save in such a way that I can first check if a record exists with attributes x and y and if so retrieve that record and perform the update, otherwise move forward with a standard ActiveRecord save?</p>\n\n<p>Here is my code as it currently stands inside the Activity model, which does not work due to the infinite loop issue:</p>\n\n<pre><code>def save\n  a = UserActivity.find_or_initialize_by_user_id_and_activity_id(user_id: user_id,     activity_id: activity_id)\n  a.update_attributes start_at: start_at, end_at: end_at.....\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","devise","email-validation"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13227202,"title":"before_create in user model -- set integer based on email (RAILS)","body":"<p>I'm trying to assign a user to their companys group based on their email domain. I'm using devise + confirmation, so I avoided using regex (dont need to validate that its a valid email...), and am trying to do this in a simple way. So essentially, it would force the users company_id (which matches up with that table) to be assigned in sign up, and then not allow them to sign up if their company doesnt exist. So this will work for both test@company.com and test@recruiting.company.com</p>\n\n<p>In User model</p>\n\n<pre><code>before_create :company_placement\n</code></pre>\n\n<p>...</p>\n\n<pre><code>def company_placement\n  user_domain = (:email).split('@').last\n\n  while user_domain.split('.').count &gt; 2\n    user_domain = user_domain.split('.', 2).last\n  end\n\n  if Company.find_by_domain(user_domain) != nil\n    (:company_id) = Company.find_by_domain(user_domain).id\n  else\n    #error out\n  end\nend\n</code></pre>\n\n<p>When I do this in rails console step by step, it seems to work. But in console when i run,</p>\n\n<pre><code>&gt; user = User.create!(name: \"test\", email: \"test@example.com\", password: \"foobar\")\n</code></pre>\n\n<p>I get undefined local variable or method 'user' for #&lt;'User....</p>\n\n<p>Thanks for any help, still learning rails...</p>\n"},{"tags":["ruby","vimeo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":8,"score":-1,"question_id":13245913,"title":"Vimeo video Search Api (NoMethodError)","body":"<p>I am using Ruby gem vimeo (1.5.3) for vimeo video search api.</p>\n\n<pre><code>video=  Vimeo::Advanced::Video.new('consumer_key','consumer_secret',:token=&gt;'token',:secret=&gt;'secret')\n\nvideo.search(\"obama\", { \"page\"=&gt;\"1\",\"perpage\"=&gt; \"25\", \"full_response\" =&gt; \"1\",\"description\" =&gt;\"1\", \"sort\" =&gt; \"newest\", \"user_id\" =&gt; nil })\n</code></pre>\n\n<p>But i am getting error - </p>\n\n<pre><code>\"`&lt;=&gt;': undefined method `&lt;=&gt;' for :query:Symbol (NoMethodError)\"\n</code></pre>\n\n<p>what is going wrong? </p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":43,"score":0,"question_id":13245632,"title":"How do I sort through this array in the way I want?","body":"<p>Say I have an array like this:</p>\n\n<pre><code>[[\"bham\", \"php\"],\n [\"auburn\", \"php\"],\n [\"bham\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"mobile\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"tucson\", \"php\"],\n [\"tucson\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"],\n [\"phoenix\", \"php\"]]\n</code></pre>\n\n<p>I would like to do a few things:</p>\n\n<ol>\n<li>Count the number of arrays that have <code>php</code> as the 2nd element - so `[\"bham\", \"php\"] would count as 1.</li>\n<li>Count the number of times each of the first elements appear throughout the list. i.e. how many times does <code>bham</code> appear in the entire array, and how many times does <code>auburn</code> appear, etc. So basically, I want to cycle through this 2D array and for the first element of each child, I want to check to see if I have already recorded this string - if I have then I increment the value recorded and if I have not then I create a new entry for this new string.</li>\n</ol>\n\n<p>This particular array is relatively trivial and can be done visually relatively easily, but assume that I will have an array with hundreds/thousands of elements.</p>\n\n<p>It is also safe to assume that both elements of each child array will always be a single word - so it should be relatively easy to keep track of.</p>\n\n<p>How do I approach this?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13245346,"title":"How to convert string into a decimal?","body":"<p>I have two strings \"0.31\" and \"0.0076\" and they need to be stored in a decimal(10,2) column in MySQL. How do I do this conversion in ruby but not in mysql directly</p>\n"},{"tags":["ruby-on-rails","ruby","deployment","capistrano"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":353,"score":1,"question_id":5975798,"title":"Deploy Rails App","body":"<p>I have been asked to make a few cosmetic changes to our production deployment. I have access to our linux box where I can see the files I need to change. I only need to change html.erb files, but when I add, for instance a simple <code>&lt;p&gt;</code> tag, it does not show up live.</p>\n\n<p>I know I probably have to reset the server or redeploy the code, but I have no idea what to do.</p>\n\n<p>Our production deployment is not fully live, so I am making changes on the fly (I know that this is not the best practice). Our app is running in a shared hosting environment for the moment. </p>\n\n<p>I have seen threads where people use Capistrano to deploy but how? We do not currently use it.</p>\n\n<p>Can anyone help?</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13245270,"title":"Ruby way to do sum?","body":"<p>For me i could not think of better way but i believe there is one. Is there a ruby way (meaning: elegant way) to do the following method implementation?</p>\n\n<pre><code>def total(items)\n  sum = 0\n  items.each do |item|\n    sum += item.value\n  end\n  sum\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13245331,"title":"Collecting only a specific value and selecting as default","body":"<p>I have something like this as a select_tag :</p>\n\n<p><code>&lt;p&gt;&lt;%= setting_select :ui_theme, My::Themes.themes.collect {|t| [t.name, t.id]}, :blank =&gt; :label_default, :label =&gt; :label_theme %&gt;&lt;/p&gt;</code></p>\n\n<p>Rite now it is collecting all the values and displaying but I want to collect only a specific value and make it default. This value has name = \"Test\". </p>\n\n<p>Thus it should look like this and it should be default:</p>\n\n<p><code>&lt;option selected=\"selected\" value=\"Test\"&gt;Test&lt;/option&gt;</code></p>\n\n<p>Note : Here setting_select is a helper which is defined like this:</p>\n\n<pre><code>def setting_select(setting, choices, options={})\n    if blank_text = options.delete(:blank)\n      choices = [[blank_text.is_a?(Symbol) ? l(blank_text) : blank_text, '']] + choices\n    end\n    setting_label(setting, options).html_safe +\n      select_tag(\"settings[#{setting}]\",\n                 options_for_select(choices, Setting.send(setting).to_s),\n                 options).html_safe\nend\n</code></pre>\n"},{"tags":["php","python","ruby","speech-to-text","transcription"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":1849,"score":0,"question_id":4583306,"title":"Speech-to-Text API","body":"<p>Does a decent one exist? </p>\n\n<p>I have a bunch of short mp3/wav files, and I'd like to use the API to transcribe them (and future sound files). PHP is preferred, but whatever works.</p>\n"},{"tags":["ruby","serial"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":427,"score":3,"question_id":6356565,"title":"Reading from a Serial Port with Ruby","body":"<p>I'm trying to use ruby to do a simple read + write operation to a serial port. </p>\n\n<p>This is the code I've got so far. I'm using the <code>serialport</code> gem.</p>\n\n<pre><code>require 'rubygems'\nrequire 'serialport'\n\nser = SerialPort.new(\"/dev/ttyACM0\", 9600, 8, 1, SerialPort::NONE)\n\nser.write \"ab\\r\\n\"\nputs ser.read\n</code></pre>\n\n<p>But the script hangs when it is run.</p>\n"},{"tags":["ruby-on-rails","ruby","searchlogic"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":77,"score":3,"question_id":13220807,"title":"Rails: Stack level too deep error","body":"<p>My rails app has 3 models. Trail, Region and Feature. I am able to interact with these models fine in my lib/tasks directory. I used anemone to crawl and populate the database. Examples of calls I made on the models:</p>\n\n<pre><code>Trail.find_or_initialize_by_title(detail_title)\n</code></pre>\n\n<p>I am now trying to write a controller that uses the model. </p>\n\n<pre><code>class TrailController &lt; ApplicationController\n    def index\n        render :json =&gt; Trail.all\n    end\nend\n</code></pre>\n\n<p>Now if i open rails console and try <code>app.get('trail/index')</code> I get a 500 return code and I see the following in my <code>development.log</code></p>\n\n<blockquote>\n  <p>SystemStackError (stack level too deep):<br>\n  app/controllers/trail_controller.rb:23:in `index'</p>\n</blockquote>\n\n<p>So I'm obviously causing some infinite recursion. Line 23 corresponds to the body of the index method. I've tried the other models in my app: Feature and Region and the result is the same. Can someone tell me what I'm doing wrong here, or how I can get more tracing to figure out what exactly is recursing infinitely?</p>\n\n<p>My models are very simple:</p>\n\n<pre><code>class Feature &lt; ActiveRecord::Base \n  attr_accessible :name \n  has_and_belongs_to_many :trails \n  validates :name, :presence =&gt; true\nend \n\nclass Region &lt; ActiveRecord::Base \n  attr_accessible :hash_key, :name \n  has_many :trails \n  validates :hash_key, :name, :presence =&gt; true \nend \n\nclass Trail &lt; ActiveRecord::Base \n  # attr_accessible :title, :body \n  has_and_belongs_to_many :features \n  validates :title, :presence =&gt; true    \nend\n</code></pre>\n\n<p>It appears this is somehow being caused by the searchlogic gem. I have this in my Gemfile:</p>\n\n<pre><code>gem 'rd_searchlogic', :require =&gt; 'searchlogic', :git =&gt; 'git://github.com/railsdog/searchlogic.|~                                                                                                    \n</code></pre>\n\n<p>When i comment out that line, run bundle install and retry app.get things work fine. So searchlogic is somehow interfering with Trail.all. Why won't Trail.all work with searchlogic installed?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":50,"score":4,"question_id":13245001,"title":"Can't understand \"unless\" keyword in Ruby","body":"<p>I'm not a native English speaker. I know it sounds stupid nonetheless. I write in Python &amp; C. But I can't quite understand how <code>unless</code> works.</p>\n\n<p>Is it healthy to think of it from a logical standpoint? Eg, consider the <code>if</code> keyword: <code>if condition</code>. If <code>condition</code> is true, the code runs. What's the logical explanation for <code>unless</code>?</p>\n\n<p>Is there any other way to think of it?</p>\n"},{"tags":["mysql","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13245115,"title":"Non english characters getting messed up while saving in MySQL table","body":"<p>I am trying to save 'non english' characters in mysql table. But when I check the table data, it shows some junk characters.</p>\n\n<p>Text before save:</p>\n\n<p><code>КУЛИНАРНЫЕ ФЕСТИВАЛИ В ЕВРОПЕ Нужно Путешествовать ВКУСНО!...</code></p>\n\n<p>Text after save in mysql:</p>\n\n<p><code>ÐšÐ£Ð›Ð˜ÐÐÐ ÐÐ«Ð• Ð¤Ð•Ð¡Ð¢Ð˜Ð’ÐÐ›Ð˜ Ð’ Ð•Ð’Ð ÐžÐŸÐ• ÐÑƒÐ¶Ð½Ð¾ ÐŸÑƒÑ‚ÐµÑˆÐµÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ð’ÐšÐ£Ð¡ÐÐž!... http://t.co/JdXw8Od3</code></p>\n\n<p>Table column Settings:</p>\n\n<ul>\n<li>varchar(1024)</li>\n<li>utf-8 general-ci</li>\n</ul>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","if-statement","omniauth"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13244345,"title":"Checking if the email had been already taken in the following if statement (Rails)?","body":"<p>I have the following action:</p>\n\n<p><strong>users.rb:</strong></p>\n\n<pre><code>  def omniauth_create\n    auth = request.env[\"omniauth.auth\"]\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    unless user.email.blank?\n      if user.id.nil?\n        # Save the user since he hasn't been created yet\n        user.save!\n      end\n      sign_in user\n      redirect_back_or user\n    else\n      # Send user to a form to fill his email\n      #session[:omniauth] = request.env['omniauth.auth'].except('extra')\n      redirect_to(enter_email_path(oprovider: user.provider,\n                                   ouid: user.uid,\n                                   oname: user.name,\n                                   opassword: user.password,\n                                   opassword_confirmation: user.password))\n    end\n  end\n</code></pre>\n\n<p>It does the following: </p>\n\n<ul>\n<li>If the user's <code>email</code> is not blank, sign him in, and redirect him to his profile (and save him if his <code>id</code> is <code>nil</code>. In other words, if he hasn't been created yet).</li>\n<li>If the user's <code>email</code> is blank, send him to <code>enter_email_path</code> (where the user can enter his email).</li>\n</ul>\n\n<p>Now I want to add another if statement that flashes an error if the <code>email</code> had been already taken, and redirects the user to the <code>root_path</code></p>\n\n<p>I'm not very sure how to do this, Any suggestions? (and where to put that if statement?)</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Strange, got this instead of the redirect to the root path:</p>\n\n<pre><code>Validation failed: Email has already been taken\n</code></pre>\n\n<p>I don't know if this helps but here is the origin of <code>from_omniauth</code>:</p>\n\n<pre><code>  def self.from_omniauth(auth)\n    find_by_provider_and_uid(auth[\"provider\"], auth[\"uid\"]) || User.create_with_omniauth(auth)\n  end\n\n  def self.create_with_omniauth(auth)\n    new do |user|\n      user.provider = auth[\"provider\"]\n      user.uid = auth[\"uid\"]\n      user.name = auth[\"info\"][\"name\"]\n      user.email = auth[\"info\"][\"email\"]\n      user.password = user.password_confirmation = SecureRandom.urlsafe_base64(n=6) \n    end\n  end\n</code></pre>\n\n<p>The code as it is right now:</p>\n\n<p><strong>user.rb</strong>:</p>\n\n<pre><code># if user.email.present?\n  if user.id.nil?\n    # User.find_by_email(user.email).present?\n    if User.exists?(:email =&gt; user.email)\n      redirect_to root_path\n    end\n    user.save!\n  end\n  sign_in user\n  redirect_back_or user\nelse\n</code></pre>\n\n<p>(the rest didn't change).</p>\n\n<p>It seems like the code is ignoring the <code>if User.exists?(:email =&gt; user.email)</code> part?</p>\n"},{"tags":["ruby-on-rails","ruby","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13190042,"title":"Unicorn workers' first responses are slower by few seconds","body":"<p>I can't figure out how I can get my unicorn workers to only accept connections when they're really \"ready\" to process a request. I find that the first few requests are slow, then they speed up dramatically (from a few seconds down to a hundred or so ms). This problem seems to be compounded by the fact that unicorn seems to kill workers after a certain amount of time, meaning that I'm constantly facing the performance hit of the slow first request. Has anyone else seen this or have an idea of what I can do?</p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","login","spec"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13244925,"title":"How to log in as a user in user_controller_spec?","body":"<p>A person is not allowed to look at the users page unless they are an admin. Hence users cannot leave the home page if they aren't logged in. In the user_controller_spec we have several tests on editing personal info or passwords. But the tests will never pass because the user we created in the spec class is not logged in. Is there a way to log in the user in the user_controller_spec?</p>\n"},{"tags":["ruby","command-line-arguments"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":20,"score":2,"question_id":13244700,"title":"Ruby: File.open how to pass file as arguments","body":"<p>Sorry, this may be a bit of a noob question. This (economic.rb) is a script that parses some world economic data. I'm unsure how to pass the xml file to it. Normally, to run this I would do</p>\n\n<pre><code>ruby economic.rb\n</code></pre>\n\n<p>However, File.open is taking the ARGV[0] as a parameter. How do I pass the xml file (<strong>data.xml</strong>) into that when running the script. </p>\n\n<p><strong>economic.rb</strong></p>\n\n<pre><code>require 'rubygems'\nrequire 'nokogiri'\n\nFile.open(ARGV[0]) do |f|\n  xml_doc = Nokogiri::XML::Document.parse(f)\n  countries = xml_doc.css('country')\n  most_populous = countries.max_by {|node| node['population'].to_i}\n  puts \"The most populous country in 1996 was #{most_populous['name']} with a population of #{most_populous['population']}\"\n  puts\n  puts \"The five countries with the highest inflation rate in 1996 were:\"\n  countries.sort_by {|country| -(country['inflation']  || 0).to_f} [0..4].each do |country|\n    puts \"  #{country['name']} - #{country['inflation']}%\"\n  end\n\n  continent_info = countries.group_by {|country| country['continent']}\n  puts\n  puts \"The continents and their countries in 1996 were:\"\n  continent_info.keys.sort.each do |continent|\n    continent_info[continent].sort_by {|country|\n       country['name']}.each do |country|\n      puts \"  #{country['name']}\"\n    end\n  end\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","ruby","unit-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13240175,"title":"How to change test database schema (rails unit test)","body":"<p>I am running into a frustrating issue when trying to unit test a specific function of my app.</p>\n\n<p>The process is carried out as such:</p>\n\n<ol>\n<li>Create a temporary 'audience' table</li>\n<li>Call function foo, which inserts certain user data into the 'audience' table</li>\n<li>Drop the 'audience' table</li>\n</ol>\n\n<p>In order to test function foo, I need to create the temporary table within my unit test.  My plan is to create the table within the setup method, and drop it within the teardown method.  I'll call function foo, and depending on if data is inserted into 'audience', that will determine if my test passed or failed.  There's only one problem.  Changing the database schema within the unit test file seems to cause problems.  The error that I get is:</p>\n\n<pre><code>ActiveRecord::StatementInvalid: Mysql2::Error: SAVEPOINT active_record_1 does not exist: ROLLBACK TO SAVEPOINT active_record_1\n</code></pre>\n\n<p>It seems like changing the schema ruins the rollback feature that Rails implements in the unit tests.  Is there any way that I can create and drop this table outside of the rollback scope? One idea I had to get around this was to create a migration that added the 'audience' table to my test database, but I'd like to keep everything contained within the same unit test file.</p>\n"},{"tags":["ruby","zip","rexml","rubyzip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13244706,"title":"Zip file edited with rubyzip giving \"Unsupported or invalid Zip file structure\" error","body":"<p>I have a zip file which contains some xml files. I opened the zip file using <strong>ZipFile.open</strong> and one of the xml file entries was loaded as a document using REXML</p>\n\n<pre><code>Zip::ZipFile.open(isvPath) {|zipFile|\n    isvXml = REXML::Document.new(zipFile.read(\"isv.xml\"))\n}\n</code></pre>\n\n<p>I made some changes to this XML structure(deleted some nodes, added a few etc) and wrote it back to the zip file entry as follows</p>\n\n<pre><code>zipFile.get_output_stream(\"isv.xml\") {|outputStream|\n   outputStream &lt;&lt; isvXml.to_s\n}\n</code></pre>\n\n<p>Then I closed the zip file using <strong>zipFile.close</strong>. Later When I open the entry isv.xml manually in winzip, I can see that the changes I made to the zip file entry are in effect. Now I'm manually trying to make some changes and save. After I save it asks me \"An entry has been changed, do you want to update the archive with the changes?\". When I click yes, I get the error \"Unsupported or invalid Zip file structure\".</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13244182,"title":"To pass integer value in render partial form in ruby on rails","body":"<p>I got a task to pass one integer value to another partial form. My code was this</p>\n\n<pre><code>&lt;div class=\"fields\"&gt;\n  &lt;p&gt;\n    &lt;%= f.label :content, \"Student\" %&gt;&lt;br/&gt;\n    &lt;%= f.text_field :content %&gt;\n    &lt;%= link_to_remove_fields \"remove\", f %&gt;&lt;br /&gt;\n  &lt;/p&gt;\n  &lt;h4&gt;Address&lt;/h4&gt;\n  &lt;% i = 1 %&gt;\n  &lt;% f.fields_for :answers do |builder| %&gt;\n    &lt;%= render :partial =&gt; 'answer_fields', :locals =&gt; {:i =&gt; i, :f =&gt; builder} %&gt;\n    &lt;% i = i + 1 %&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= link_to_add_fields \"Add Address\", f, :answers %&gt;&lt;/p&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But in the partial form i got an error like </p>\n\n<pre><code>undefined local variable or method `i'\n</code></pre>\n\n<p>My partial form is </p>\n\n<pre><code>&lt;p class=\"fields\"&gt;\n  &lt;table&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;%= f.label :content, \"Address\"+i.to_s %&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= f.text_field :content %&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= link_to_remove_fields \"remove\", f %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>How can i pass the value of i to other partial form?</p>\n"},{"tags":["ruby","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13244511,"title":"How can i get the referrers of last 30 days from bitly api using bitly gem","body":"<p>I am using bitly gem to access the bitly api. While fetching the referrers using Bitly::V3::User i am getting only today's data..How can i get the last 30 day's referrers. My code is here.</p>\n\n<pre><code>    o = Bitly::V3::OAuth.new(configatron.bitly.client_id, configatron.bitly.client_secret)\n    @access_token = o.get_access_token_from_code(params[:code], configatron.bitly.redirect_url)\n    u=Bitly::V3::User.new(o.access_token)\n    @a = u.link_history\n    @r = u.referrers\n</code></pre>\n"},{"tags":["ruby","sinatra","rack","warden"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13242684,"title":"Unable to use Warden in Sinatra App: env['warden'] returns nil","body":"<p>I'm writing a Sinatra Rack App and I want to use Warden for authentication. I'm using heroku's toolbelt so I use foreman to run my app. I've found <a href=\"https://gist.github.com/557436\" rel=\"nofollow\">some code</a> that's presumably supposed to get this working. Unfortunately, when I attempt to actually access the Warden env object, it is nil.</p>\n\n<p>I've attempted to use the <a href=\"https://github.com/jsmestad/sinatra_warden\" rel=\"nofollow\">sinatra_warden</a> gem, but it also has its <a href=\"https://github.com/jsmestad/sinatra_warden/issues/3\" rel=\"nofollow\">own bugs</a> (might be related to this one).</p>\n\n<p>config.ru:</p>\n\n<pre><code>require './web.rb'\nuse Rack::Static, :urls =&gt; [\"/css\", \"/img\", \"/js\"], :root =&gt; \"public\"\nrun MyApp\n</code></pre>\n\n<p>web.rb:</p>\n\n<pre><code>require 'sinatra'\nrequire 'warden'\nrequire 'data_mapper'\n\nrequire './config/datamapper.rb'\nrequire './config/warden.rb' # I've tried this inside of MyApp, still didn't work\n\nclass MyApp &lt; Sinatra::Base\n\n  get '/test' do\n    env['warden'].authenticate! # env['warden'] is nil :(\n  end\n\nend\n</code></pre>\n\n<p>config/warden.rb:</p>\n\n<pre><code>use Rack::Session::Cookie, :secret =&gt; ENV['SESSION_SECRET']\n\nuse Warden::Manager do |manager|\n  manager.default_strategies :password\n  manager.failure_app = MyApp.new\nend\n\nWarden::Manager.serialize_into_session { |user| user.id }\nWarden::Manager.serialize_from_session { |id| User.get(id) }\n\nWarden::Manager.before_failure do |env,opts|\n  # Sinatra is very sensitive to the request method\n  # since authentication could fail on any type of method, we need\n  # to set it for the failure app so it is routed to the correct block\n  env['REQUEST_METHOD'] = \"POST\"\nend\n\nWarden::Strategies.add(:password) do\n  def valid?\n    params[\"email\"] || params[\"password\"]\n  end\n\n  def authenticate!\n    u = User.authenticate(params[\"email\"], params[\"password\"])\n    u.nil? ? fail!(\"Could not log in\") : success!(u)\n  end\nend\n</code></pre>\n\n<p>Versions:</p>\n\n<ul>\n<li>Sinatra: 1.1.0</li>\n<li>Warden: 1.2.1</li>\n<li>Rack: 1.4.1</li>\n<li>Ruby: 1.9.3p194</li>\n<li>Foreman: 0.60.0</li>\n</ul>\n\n<p>Any ideas how to use Warden the set up I've described?</p>\n\n<p>(P.S. Out of curiosity, what exactly is the env variable?) </p>\n"},{"tags":["ruby","url","dns","subdomain","uri"],"answer_count":5,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":4458,"score":3,"question_id":983158,"title":"Remove subdomain from string in ruby","body":"<p>I'm looping over a series of URLs and want to clean them up. I have the following code:</p>\n\n<pre><code># Parse url to remove http, path and check format\no_url = URI.parse(node.attributes['href'])\n\n# Remove www\nnew_url = o_url.host.gsub('www.', '').strip\n</code></pre>\n\n<p>How can I extend this to remove the subdomains that exist in some URLs?</p>\n"},{"tags":["ruby","class-method","activesupport"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13243788,"title":"Use ActiveSupport's number helper in a Class Method","body":"<p>I have an embarrassingly basic question:</p>\n\n<p>I'm working on a plain-old-ruby model that deals with money, and some of the class methods return prices which need to be formatted for display.</p>\n\n<p>In the past I've used <code>include ActionView::Helpers::NumberHelper</code> to stick the <code>number_to_currency</code> method in a model, but that only works for instance methods.</p>\n\n<p>How do you get that method to be accessible from a class method?</p>\n"},{"tags":["ruby","parsing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":13243195,"title":"How to parse a URL and extract the required substring","body":"<p>Say I have a string like this: <code>\"http://something.example.com/directory/\"</code></p>\n\n<p>What I want to do is to parse this string, and extract the <code>\"something\"</code> from the string.</p>\n\n<p>The first step, is to obviously check to make sure that the string contains <code>\"http://\"</code> - otherwise, it should ignore the string.</p>\n\n<p>But, how do I then just extract the <code>\"something\"</code> in that string? Assume that all the strings that this will be evaluating will have a similar structure (i.e. I am trying to extract the subdomain of the URL - if the string being examined is indeed a valid URL - where valid is starts with <code>\"http://\"</code>).</p>\n\n<p>Thanks.</p>\n\n<p>P.S. I know how to check the first part, i.e. I can just simply split the string at the <code>\"http://\"</code> but that doesn't solve the full problem because that will produce <code>\"http://something.example.com/directory/\"</code>. All I want is the <code>\"something\"</code>, nothing else.</p>\n"},{"tags":["ruby","routing","sinatra","rack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13243789,"title":"Sinatra gives me \"not found\" all the time instead of my page","body":"<p>Pretty simple Sinatra code</p>\n\n<pre><code>  get '/Accept/:value' do\n    \"Hello world\"\n  end\n\n   not_found do\n    \"not found\"\n   end\n</code></pre>\n\n<p>when I go to <code>http://localhost:9292/Accept/?SomeKey=somevalue&amp;Somekey2=someValue</code> Sinatra always returns \"not found\" back to me. </p>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13243385,"title":"Can't mass-assign protected attributes: _destroy - Ruby on Rails","body":"<p>I'm getting this error:</p>\n\n<p>\"ActiveModel::MassAssignmentSecurity::Error in DaysController#create</p>\n\n<p>Can't mass-assign protected attributes: _destroy\"</p>\n\n<p>I didn't even know that _destroy is an attribute!</p>\n\n<p>What I have going on:</p>\n\n<p>My model is that I have \"Trips\" which has many \"Days\"</p>\n\n<p>In the \"Show\" view of my Trips model, I'm rendering a partial for a Form to add a new \"Day\":</p>\n\n<pre><code>&lt;div id=\"day_form\"&gt;\n  &lt;%= render :partial =&gt; \"day_form\", :day =&gt; @day %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :title, :days_attributes\n  has_many :days\n  accepts_nested_attributes_for :days, allow_destroy: true\n\nend\n\n\n class Day &lt; ActiveRecord::Base\n  attr_accessible :activity_id, :order, :summary, :trip_id, :activities_attributes\n  belongs_to :trip\n  has_many :activities, :order =&gt; 'position'\n  accepts_nested_attributes_for :activities, allow_destroy: true \nend\n</code></pre>\n\n<p>When I submit the form, I am getting this Mass Assignment error.  Why?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The 'Day' Form looks like this:</p>\n\n<pre><code>    &lt;%= form_for(@day) do |f| %&gt;\n\n      &lt;ul&gt;\n      &lt;% @day.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n        &lt;fieldset&gt;\n          &lt;%= f.label :summary, \"Day Summary\" %&gt;&lt;br /&gt;\n          &lt;%= f.text_area :summary, :rows =&gt; 1 %&gt;&lt;br /&gt;\n          &lt;%= f.hidden_field :_destroy %&gt;\n              &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n        &lt;/fieldset&gt;\n        &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n        &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13237399,"title":"Rails simple_fields_for can't hide :id","body":"<p>I've been using simple_form for rails together with HAML</p>\n\n<p>I have a number of line_items they have a unique id which i retrieve from the Order object</p>\n\n<pre><code>    = f.simple_fields_for :line_items do |line_items|\n     .f.input :id unless @order.status?\n     .f.input :cost unless @order.status?\n</code></pre>\n\n<p>However, whenever i iterate through these list, i would like to hide (remove from the form) the line_items id, i try to put a unless statement to remove other parameters and it works (eg. :cost) but for the :id it appears to be a hidden fields </p>\n\n<pre><code>     &lt;input id=\"order_line_items_attributes_2_id\" name=\"order[line_items_attributes][2][id]\" type=\"hidden\" value=\"26\"&gt;\n</code></pre>\n\n<p>How can i successfully remove IDs from appearing in the fields just like how i did it for :cost?</p>\n"},{"tags":["java","python","ruby","email","clojure"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13243581,"title":"Customizable mail server - what are my options?","body":"<p>I am interested to build a mail service that allows you to incorporate custom logic in the your mail server.</p>\n\n<p>For example, user A can reply to helloworld@mysite.com once and subsequent emails from user A to helloworld@mysite.com will not go through until certain actions are taken. </p>\n\n<p>I am looking for something simple and customizable, preferably open-sourced. I am fluent in most modern languages. </p>\n\n<p>What email servers do you guys recommend for this? </p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13243634,"title":"How do I sort a collection / enum by a custom method in ruby/rails?","body":"<p>In Rails, let's I have a collection of Categories:</p>\n\n<pre><code>@categories = Category.order('name asc')\n</code></pre>\n\n<p>One of these categories has the name \"New\". I'd like to have the \"New\" category first in the collection, and the rest alphabetical. </p>\n\n<p>I'd like to only do one database query. I'd like this to be as concise as possible.</p>\n\n<p>If the one query limit was not in place, I know I could fetch the \"New\" category, and then fetch the rest of the categories in order by name, and then \"unshift\" the new category to the @categories collection, but there must be a better way!</p>\n\n<pre><code>@new = Category.where(name: 'name').first\n@categories = Category.where(\"name != ?\", 'Name').order('name asc')\n@categories.unshift(@new)\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","json","hash","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13235179,"title":"Compare json response with array of hashes","body":"<p>When I get an array of objects in JSON response, they might be represent in a different order.</p>\n\n<p>Sometimes I get this</p>\n\n<pre><code>JSON.parse(response.body) # =&gt; [{\"a\" =&gt; \"b\"}, {\"c\" =&gt; \"d\"}]\n</code></pre>\n\n<p>or this</p>\n\n<pre><code>JSON.parse(response.body) # =&gt; [{\"c\" =&gt; \"d\"}, {\"a\" =&gt; \"b\"}]\n</code></pre>\n\n<p>But for me both results are correct. What is the easiest way to test which objects I have in response regardless of their order?</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13189847,"title":"How do I initialize a class variable in Ruby?","body":"<p>For instance:</p>\n\n<pre><code>class MyClass\n    @@var1 = '123456'\n    def self.var1\n        @@var1\n    end\n\n    class &lt;&lt; self\n        attr_accessor :var2\n        def self.initialize\n          self.var2 = 7890\n        end\n    end\n\nend\n\n p MyClass.var1 # \"123456\"\n p MyClass.var2 # nil\n</code></pre>\n\n<p>Is there any way to initialize var2?</p>\n"},{"tags":["ruby","devise","capybara","warden","selenium-webdriver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":581,"score":0,"question_id":11677759,"title":"Errno::ECONNREFUSED: Connection refused - connect(2) test_helper.rb","body":"<p>I am new to Ruby and needed some assistance figuring something out:  I've been stuck on this error for 2 days.  I know if I figure out the connect issue everything is going to work perfectly.  Please help.</p>\n\n#test_helper.rb\n\n<pre><code>$LOAD_PATH&lt;&lt; File.expand_path(__FILE__)\nENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path('../../config/environment', __FILE__)\nRails.env='test'\nrequire 'rails/test_help'\nrequire 'action_view/test_case'\nrequire 'factory_girl'\nrequire 'capybara/rails'\nrequire 'capybara/dsl'\nrequire 'factories'\n\nDatabaseCleaner.strategy = :truncation\n\nclass ActiveSupport::TestCase\n  # Setup all fixtures in test/fixtures/*.(yml|csv) for all tests in alphabetical order.\n  #\n  # Note: You'll currently still have to declare fixtures explicitly in integration tests\n  # -- they do not yet inherit this setting\n  fixtures :all\n\n  include Devise::TestHelpers\n\n\nend\n\nclass  ActionController::TestCase\n  setup do\n    DatabaseCleaner.start  \n  end\n\n  teardown do\n    DatabaseCleaner.clean       # Truncate the database\n  end\nend\n\n\nclass ActionDispatch::IntegrationTest\n  # Make the Capybara DSL available in all integration tests\n  include Capybara::DSL\n  include Warden::Test::Helpers\n  include Capybara::RSpecMatchers\n  Warden.test_mode!\n  # Stop ActiveRecord from wrapping tests in transactions\n  self.use_transactional_fixtures = false\n\n  teardown do\n    DatabaseCleaner.clean       # Truncate the database\n    Capybara.reset_sessions!    # Forget the (simulated) browser state\n    Capybara.use_default_driver # Revert Capybara.current_driver to Capybara.default_driver\n  end\n\nend\n\nclass ActionController::TestCase\n  # include Devise::TestHelpers\nend\n\nrequire 'selenium-webdriver'\nmodule ::Selenium::WebDriver::Firefox\n  class Bridge\n    attr_accessor :speed\n\n    def execute(*args)\n      result = raw_execute(*args)['value']\n      case speed\n        when :slow\n          sleep 0.3\n        when :medium\n          sleep 0.1\n      end\n      result\n    end\n  end\nend\n\ndef set_speed(speed)\n  begin\n    page.driver.browser.send(:bridge).speed=speed\n  rescue\n  end\nend\n</code></pre>\n\n#test/unit/project_test.rb\n\n<pre><code>require 'test_helper'\n\nclass ProjectTest &lt; ActiveSupport::TestCase\n  # test \"the truth\" do\n  #   assert true\n  # end\n\n  setup do\n    DatabaseCleaner.start\n    @user = FactoryGirl.create(:user)\n    @company = FactoryGirl.create(:company, :name=&gt;'MegaTesters')\n    @project = FactoryGirl.create(:project, :name=&gt;'testProject', :budget=&gt;100000)\n    assert @project.valid?\n    @sow = @project.contracts.create :name=&gt;\"first\", :company=&gt;@company, :type=&gt;\"Sow\"\n    @invoice = @sow.invoices.create :amount=&gt;25000\n    @payment = @invoice.payments.create :amount=&gt;10000\n\n  end\n\n  teardown do\n    DatabaseCleaner.clean       # Truncate the database\n  end\n\n  test \"remaining funds\" do\n\n  end\nend\n</code></pre>\n\n#STACK TRACE:\n\n<pre><code>bundle exec rake test:units TEST=test/unit/project_test.rb --trace\n(in /Users/higgs001/Sandbox/att-innovate/foundry_ledger)\n** Invoke test:units (first_time)\n** Invoke test:prepare (first_time)\n** Invoke db:test:prepare (first_time)\n** Invoke db:abort_if_pending_migrations (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Execute db:abort_if_pending_migrations\n** Execute db:test:prepare\n** Invoke db:test:load (first_time)\n** Invoke db:test:purge (first_time)\n** Invoke environment \n** Execute db:test:purge\n** Execute db:test:load\n** Invoke db:test:load_schema (first_time)\n** Invoke db:test:purge \n** Execute db:test:load_schema\n** Invoke db:schema:load (first_time)\n** Invoke environment \n** Execute db:schema:load\nNOTICE:  CREATE TABLE will create implicit sequence \"assignments_id_seq\" for serial column \"assignments.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"assignments_pkey\" for table \"assignments\"\nNOTICE:  CREATE TABLE will create implicit sequence \"attachments_id_seq\" for serial column \"attachments.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"attachments_pkey\" for table \"attachments\"\nNOTICE:  CREATE TABLE will create implicit sequence \"companies_id_seq\" for serial column \"companies.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"companies_pkey\" for table \"companies\"\nNOTICE:  CREATE TABLE will create implicit sequence \"contracts_id_seq\" for serial column \"contracts.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"contracts_pkey\" for table \"contracts\"\nNOTICE:  CREATE TABLE will create implicit sequence \"fundings_id_seq\" for serial column \"fundings.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"fundings_pkey\" for table \"fundings\"\nNOTICE:  CREATE TABLE will create implicit sequence \"invoices_id_seq\" for serial column \"invoices.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"invoices_pkey\" for table \"invoices\"\nNOTICE:  CREATE TABLE will create implicit sequence \"lockers_id_seq\" for serial column \"lockers.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"lockers_pkey\" for table \"lockers\"\nNOTICE:  CREATE TABLE will create implicit sequence \"pages_id_seq\" for serial column \"pages.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"pages_pkey\" for table \"pages\"\nNOTICE:  CREATE TABLE will create implicit sequence \"payments_id_seq\" for serial column \"payments.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"payments_pkey\" for table \"payments\"\nNOTICE:  CREATE TABLE will create implicit sequence \"projects_id_seq\" for serial column \"projects.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"projects_pkey\" for table \"projects\"\nNOTICE:  CREATE TABLE will create implicit sequence \"queue_classic_jobs_id_seq\" for serial column \"queue_classic_jobs.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"queue_classic_jobs_pkey\" for table \"queue_classic_jobs\"\nNOTICE:  CREATE TABLE will create implicit sequence \"users_id_seq\" for serial column \"users.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"users_pkey\" for table \"users\"\nNOTICE:  CREATE TABLE will create implicit sequence \"versions_id_seq\" for serial column \"versions.id\"\nNOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index \"versions_pkey\" for table \"versions\"\n** Execute test:prepare\n** Execute test:units\nRun options: --seed 14051\n\n# Running tests:\n\nE\n\nFinished tests in 0.802822s, 1.2456 tests/s, 0.0000 assertions/s.\n\n  1) Error:\ntest_remaining_funds(ProjectTest):\nErrno::ECONNREFUSED: Connection refused - connect(2)\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `initialize'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `open'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `block in connect'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/timeout.rb:44:in `timeout'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/timeout.rb:89:in `timeout'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:644:in `connect'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:637:in `do_start'\n    /Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/http.rb:626:in `start'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient/request.rb:172:in `transmit'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient/request.rb:64:in `execute'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient/request.rb:33:in `execute'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/rest-client-1.6.7/lib/restclient.rb:72:in `post'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/http/client.rb:19:in `post'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/index.rb:80:in `store'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/model/search.rb:134:in `block in update_index'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:403:in `_run__2302947893627650000__update_elasticsearch_index__985824136385614657__callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_update_elasticsearch_index_callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/model/search.rb:130:in `update_index'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/tire-0.4.2/lib/tire/model/callbacks.rb:21:in `block in included'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:471:in `_run__2302947893627650000__save__985824136385614657__callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_save_callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `run_callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/callbacks.rb:264:in `create_or_update'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/persistence.rb:104:in `save!'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/validations.rb:56:in `save!'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/attribute_methods/dirty.rb:33:in `save!'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:246:in `block in save!'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:208:in `transaction'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activerecord-3.2.6/lib/active_record/transactions.rb:246:in `save!'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/configuration.rb:18:in `block in initialize'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/evaluation.rb:15:in `[]'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/evaluation.rb:15:in `create'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy/create.rb:12:in `block in result'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy/create.rb:9:in `tap'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy/create.rb:9:in `result'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/factory.rb:42:in `run'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/factory_runner.rb:23:in `block in run'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/notifications.rb:125:in `instrument'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/factory_runner.rb:22:in `run'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/factory_girl-3.5.0/lib/factory_girl/strategy_syntax_method_registrar.rb:19:in `block in define_singular_strategy_method'\n    /Users/higgs001/Sandbox/att-innovate/foundry_ledger/test/unit/project_test.rb:11:in `block in &lt;class:ProjectTest&gt;'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:429:in `_run__3361187329649106861__setup__985824136385614657__callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:405:in `__run_callback'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/callbacks.rb:81:in `run_callbacks'\n    /Users/higgs001/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.6/lib/active_support/testing/setup_and_teardown.rb:35:in `run'\n\n1 tests, 0 assertions, 0 failures, 1 errors, 0 skips\nrake aborted!\nCommand failed with status (1): [/Users/higgs001/.rvm/rubies/ruby-1.9.2-p32...]\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in `block in create_shell_runner'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:82:in `ruby'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/testtask.rb:99:in `block (2 levels) in define'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:60:in `verbose'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/testtask.rb:98:in `block in define'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/Users/higgs001/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/bin/rake:19:in `load'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320@global/bin/rake:19:in `&lt;main&gt;'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320/bin/ruby_noexec_wrapper:14:in `eval'\n/Users/higgs001/.rvm/gems/ruby-1.9.2-p320/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\nTasks: TOP =&gt; test:units    \n</code></pre>\n"},{"tags":["ruby","rake","jruby","gemfile","rakefile"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13242961,"title":"Rakefiles and Gemfiles","body":"<p>So I understand the basic concepts of a Rakefile and a Gemfile (rakefiles are basically just dependency lists and shell commands to compile and link the application while gemfiles specify gem version dependencies for an application), but how should I use these in unison? More specifically: I have a project for a project at my Uni that I am going to use Ruby 1.8.7 and JRuby 1.7 on with a set of gems I have installed through RVM on my local machine. </p>\n\n<p>The problem is is that my application must compile and run without error on the computer lab at my Uni and the Uni doesn't have JRuby on these machines. I can install onto my shell account, and I did that with JRuby to get my application to compile but now I am required to type in the full path to the jruby installation to compile my project (something like /usr/home/usrname/blah/jruby-1.7.0) and I feel that is annoying and I would like something simpler (and learn at the same time).</p>\n\n<p>The machines at my Uni have Rake installed and I was wondering if it would be possible for me to set up a rake file to do the call to JRuby and all the gems I need (specified in the gemfile with their respective installation paths). Is this possible? Or am I thinking of rakefiles and gemfiles in the wrong way?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","libxml2","homebrew","osx-mountain-lion"],"answer_count":7,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":2789,"score":11,"question_id":11668604,"title":"Mountain Lion - LibXML & Nokogiri","body":"<p>I've just updated to OS X Mountain Lion and I'm getting the following when working with rails and terminal.</p>\n\n<pre><code>WARNING: Nokogiri was built against LibXML version 2.8.0, but has dynamically loaded 2.7.8\n</code></pre>\n\n<p>I've had a look at other answers to a similar question, but they doesn't seem to stop the warning message from appearing.</p>\n"},{"tags":["sql","ruby","postgresql","timezone","dst"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":60,"score":6,"question_id":13239534,"title":"Accounting for DST in Postgres, when selecting scheduled items","body":"<p>I have a <strong>Postgres</strong> table of <strong>clock alarms</strong> (not really, but this is analogous, and easier to explain). Alarms are set by users with a 1 hour resolution, and users can be from many different timezones. The alarms are repeating daily. I want to reliably fetch the alarms that are supposed to go off at a particular hour of the day, and I am <strong>having problems with daylight saving time</strong>. How do I do this in the best way?</p>\n\n<h3>Example</h3>\n\n<blockquote>\n  <p>Alfred and Lotta both live in Stockholm (+1 hour from UTC, but +2h\n  when it's DST).<br> Sharon lives in Singapore (+8 hours from UTC, no\n  DST)</p>\n  \n  <p>During winter, Alfred sets an alarm for 4 AM. The alarm should go off\n  at 4 AM local time, all year.<br> During summer, Lotta sets an alarm\n  for 5 AM. Again, it should go off at 5 AM all year round.<br>\n  Meanwhile, Sharon has set an alarm for 11 AM.</p>\n  \n  <p>All of these can be stored in the database as 03:00 UTC.</p>\n  \n  <p>If I query the database in the winter for alarms that should go off at\n  03:00 UTC, I want Alfred's and Sharon's alarms. Singapore is now +7h\n  from Sweden, so 11 AM in Singapore is 4 AM in Sweden. Lotta's alarm\n  should not go off for another hour.</p>\n  \n  <p>Conversely, if I query the database in the summer for alarms that\n  should go off at 03:00 UTC, I want Lotta's and Sharon's alarms.\n  Singapore is +6h from Sweden now, so 11 AM in Singapore is 5 AM in\n  Sweden now. Sven's alarm went off an hour ago.</p>\n</blockquote>\n\n<p><strong>How do I store this, and query the database?</strong></p>\n\n<p>I can change the db schema if necessary. At the moment, we don't adjust for DST at all, and in fact just have an \"hour\" integer field (which seems dumb, a time field would be better).</p>\n\n<p>It seems I need to store both a UTC time and timezone information, but I don't know how to best achieve this in Postgres. I've found that Postgres has some sort of concept of timezones, but no timezone field type as far as I can tell. Also, I guess I need to do some calculations in SQL to determine how to offset the UTC time in the select, based on the timezone data and the creation date. I'm not great with SQL…</p>\n\n<p>I do want to solve this in Postgres, as there can be a lot of \"alarms\", and I want to avoid the performance issues that come with fetching all of them into Ruby and filter there. (Yes, this is a Rails app.)</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","benchmarking","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13234454,"title":"Test Speed: ActiveRecord use_transactional_fixtures vs. DatabaseCleaner.strategy = :transaction","body":"<p>Judging from the source(<a href=\"https://github.com/bmabey/database_cleaner/blob/master/lib/database_cleaner/active_record/transaction.rb\" rel=\"nofollow\">database_cleaner</a>, <a href=\"https://github.com/rails/rails/blob/master/activerecord/lib/active_record/fixtures.rb#L846\" rel=\"nofollow\">active_record</a>), it appears that they should be equally fast. But there are claims that using database_cleaner's transaction strategy slows down controller and model specs (<a href=\"http://stackoverflow.com/a/5435732/429288\">for example</a>). I don't have a large test suite in hand for benchmarking. Anyone has any insight or has compared the two? </p>\n"},{"tags":["ruby","eclipse","eclipse-plugin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13242408,"title":"eclipse plugin for ruby","body":"<p>I have installed</p>\n\n<p><a href=\"http://www.aptana.com/products/radrails\" rel=\"nofollow\">http://www.aptana.com/products/radrails</a></p>\n\n<p>and </p>\n\n<p><a href=\"http://download.eclipse.org/technology/dltk/updates/\" rel=\"nofollow\">http://download.eclipse.org/technology/dltk/updates/</a> based on this answer <a href=\"http://stackoverflow.com/questions/524021/preferred-ruby-plugin-for-eclipse\">Preferred ruby plugin for Eclipse?</a> </p>\n\n<p>But how come I still don't see source file structure hierarchy view  function/methods/classes like this (this is python in eclipse )</p>\n\n<p><img src=\"http://i.stack.imgur.com/lieLw.png\" alt=\"enter image description here\"></p>\n\n<p>All ruby files still don't have this kind of hierarchy. I still need to go into each ruby file to see what methods/classes in this ruby file.</p>\n\n<p>What am i missing?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","require"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13241817,"title":"Ruby load error cannt load such file","body":"<p>Testing my class source code with some require code and I keep getting the following error:</p>\n\n<blockquote>\n  <p>\"D:/ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in\n  'require':cannot load such file -- ./xxx.rb (LoadError) from\n  D:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in\n  'require' from xxx.rb:1:in ''</p>\n</blockquote>\n\n<p>Here is the code I'm using to test my code:</p>\n\n<pre><code>require \"./proj6colecio.rb.txt\"\nprint \" \"\nguitar = Guitar.new(\"Stratocaster\", \"Fender\", \"Solid Body\", 6, \"Black\")\nprint \"Guitar Name: #{guitar.name}\\n\"\nprint \"Guitar Brand: #{guitar.brand}\\n\"\nprint \"Guitar Type: #{guitar.type}\\n\"\nprint \"Number of Strings: #{guitar.strings}\\n\"\nprint \"Guitar Color: #{guitar.color}\\n\"\nprint guitar, \"\\n\"\n</code></pre>\n\n<p>Not really educated in ruby on rails errors yet as I'm a student still learning the basics of programming. </p>\n\n<p>Thanks alot for any feedback</p>\n\n<pre><code># Guitar class with instance variables @name, @brand, @type @strings @color and\n# method take_strings.\n\nclass Guitar\n\n  # initialize method is called when user invokes Guitar.new.\n  def initialize(the_name, the_brand, the_type, the_strings, the_color)\n    @name = the_name\n    @brand = the_brand\n    @type = the_type\n    @strings = the_strings\n    @color = the_color\n  end\n\n  # Define getters\n  def name\n    return @name\n  end\n\n  def brand\n    return @brand\n  end\n\n  def type\n    return @type\n  end\n  def strings\n    return @strings\n  end\n\n  def color\n    return @color\n  end\n# define setters\n\n  def strings=(value)\n    @strings = value\n  end\n\n  def to_s\n    return \"The Guitar is a #{name} made by #{brand}. It is a #{type} with #{strings} strings and is #{color}.\"\n  end\n\n  def change_color\n    @color = \"Blue\"\n  end\n\nend\n\nguitars = [ ]\n\nguitars &lt;&lt; Guitar.new(\"Stratocaster\", \"Fender\", \"Solid Body\", 6, \"Black\")\nguitars &lt;&lt; Guitar.new(\"Les Paul\", \"Gibson\", \"Solid Body\", 6, \"Yellow\")\nguitars &lt;&lt; Guitar.new(\"White Falcon\", \"Gretsch\", \"Semi-Hollow\", 6, \"White\")\n\n# Print all guitars\nguitars.each do |g|\n  print g, \"\\n\"\nend\n\n#Change color of guitar to blue\nguitars.each do |g|\n  g.change_color\nend\n\nguitars.each do |g|\n  print g, \"\\n\"\nend\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","associations"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13241834,"title":"Any techniques to better break down rails associations? (specific example given)","body":"<p>Thanks for taking a look!</p>\n\n<p>I'm building my first \"on my own\" app after reading the Depot book and the rails tutorial and working though both. I'm finding it difficult to get my associations worked out since there's so many of them in my current practice project. Here's the overview, it's basically a simple NFL pickem app:</p>\n\n<p>A \"User\" logs in (devise) and sees a list of \"Games\" for this week.    (let's say NFL games for example).<br>\nA \"User\" can make their \"Picks\" for    those games with that first screen mentioned and submit them for the    week.<br>\nA \"Game\" has 2 teams associated with it.<br>\nA \"Game\" has a    \"result\" (torn on having a Results model or just using a result    column in games table here). \nA \"Week\" has several \"Games\" in it which    are picked. </p>\n\n<p>After picks are made they are allowed to see everyone    elses picks also but that's not really relevant here.</p>\n\n<p>So as you can see above there are several relationships that I need to specify and I'm having a really difficult time working them all out. Also I found myself wanting to make scaffolds for each (I know right?) but I don't think that's the right answer here.</p>\n\n<p>Also, once worked out is there a good order to take with them? Like in this case I figure it's a good idea to start with the \"Teams\" so I can add \"Weeks\" and \"Games\" to each of those weeks. But I'm just really lost and overwhelmed I guess. Any tips on how to start tackling this problem? Thanks so much for the help all!</p>\n\n<p>(please let me know if you want to see code, but I figure this is more of a process / fundamental question than a \"give me a solution to my specific problem\" question. Thanks again.</p>\n"},{"tags":["ruby"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13240823,"title":"Remove nil items from end of array in Ruby","body":"<p>Given an array like:</p>\n\n<pre><code>[1, 2, nil, nil, 3, nil, 4, 5, 6, nil, nil, nil]\n</code></pre>\n\n<p>id like to remove the <code>nil</code>'s from the end of the array. Not hard to solve with some ugly loops, but I was hoping there was a Ruby way to do it.</p>\n\n<pre><code>Result: [1, 2, nil, nil, 3, nil, 4, 5, 6]\n</code></pre>\n"},{"tags":["ruby","node.js","zlib","inflate"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13241360,"title":"Read with Ruby a Zlib string created with Node.js","body":"<p>Some pieces of our app are written in Ruby and others are written using node.js.</p>\n\n<p>We share data among them using a redis store that stores zlib chunks.\nWe write to it with the following code using node:</p>\n\n<pre><code>zlib.deflate(xml.toString(), function(error, deflated) {\n  ...\n  deflated.toString('binary'); // That's the string we write in Redis\n  ...\n});\n</code></pre>\n\n<p>Now, we read this data in the redis store using Ruby (1.8.7) and I have to say I'm not sure how to do that.</p>\n\n<p>The typical string we get from the store looks like this:</p>\n\n<pre><code>=&gt; \"xuAo \\020ÿ\\ná.£v½\\030dÿCO½±:«¤(\\004Æªÿ¾¬®5MÚ\\003÷½IÞ q¤°²e°c¼òÈ×\\000ó&lt;ùM¸ÐAç\\025ÜÈ\\r|gê\\016Ý/.é\\020ãÆî×\\003Ôç&lt;Ýù2´F\\n¨Å\\020!zl \\0209\\034p|üÀqò\\030\\036m\\020\\e`\\031¼ÏütÓ=Ã¸¦U/ÔO±\\177zB{\\037½£-ðBu©ò¢X\\000kb­*Ó[V\\024Y^½EÎ¥üpúrò­¦\\177ÁÃdÈ¢j\\0353$a\\027²q#¥]*Ýi3J8¤´füd\\eså[³öÊµ%\\fcÇY\\037ð¬ÿg§í^¥8£Õ§a¶\\001=\\r;¡¾\\001\\020Pí\" \n</code></pre>\n\n<p>Of course, I tried using  <code>Zlib::Inflate.new.inflate(compressed)</code> but that fails with a <code>Zlib::DataError: incorrect header check</code>.</p>\n\n<p>Any idea on what kind of transformation we should do to that string to inflate it from Ruby?</p>\n\n<p>PS: inflating it from node is easy and works, so the problem is not how we compress it.</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13240754,"title":"How can I determine what scope a method is called in?","body":"<p>I'm writing something sort of like a kind of benchmarking utility, and I'm curious if there is an easy way to tell from what context a method is being called.  Let me explain by example:</p>\n\n<pre><code>module Foo\n  my_method\n  class Foo\n    my_method\n    def self.foo\n       my_method\n    end\n    def foo\n      my_method\n    end\n  end\nend\nFoo::Foo.foo\nFoo::Foo.new.foo\n</code></pre>\n\n<p>Ideally, for the above, the \"my_method\" would print something like the following:</p>\n\n<blockquote>\n  <p>Called in definition of Module \"Foo\"\n  Called in definition of Class \"Foo\"\n  Called during run of class method \"foo\"\n  Called during run of instance method \"foo\"</p>\n</blockquote>\n\n<p>If I could get some kind of reference to the current \"scope\" or context (or whatever ruby calls it) this would be easy, but I don't know if that's even possible, let alone how to do it.  Can anyone point me in the right direction?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13241978,"title":"Rails private messages how to create a conversation view?","body":"<p>I am using this gem for private messages: <a href=\"https://github.com/jongilbraith/simple-private-messages\" rel=\"nofollow\">https://github.com/jongilbraith/simple-private-messages</a></p>\n\n<p>I want to create a thread conversation instead of the e-mail conversation the scaffold have provided.</p>\n\n<p>Example, User A have sent 10 messages to User B. User A have also sent 10 messages to User C. </p>\n\n<p>Instead of looping through all the messages. (e-mail look) I want to create a threat like:</p>\n\n<p><strong>Inbox</strong></p>\n\n<pre><code>Conversation with User A (10 messages)\nConversation with User C (10 messages) \n</code></pre>\n\n<p>And when clicking on the conversation the messages should be ordered after date. So it would be like a conversation. </p>\n\n<p>The table for messages:</p>\n\n<pre><code>id\nsender_id\nrecipient_id\nsender_deleted\nrecipient_deleted\nsubject\nbody\nread_at\ncreated_at\nupdated_at\n</code></pre>\n\n<p>How do I create these views? How do I group the messages?</p>\n"},{"tags":["ruby","routing","sinatra","path","sass"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1941,"score":4,"question_id":2926036,"title":"How to specify custom Sass directory with Sinatra","body":"<p>Instead of serving my Sass files from the default 'views' directory I'd like to change this to <code>/assets/sass</code></p>\n\n<p>The following attempts are in my main ruby root file in the app:</p>\n\n<p>Attempt 1:</p>\n\n<pre><code>set :sass, Proc.new { File.join(root, \"assets/sass\") }\n\nget '/stylesheet.css' do\n    sass :core\nend\n</code></pre>\n\n<p>With this I get the following error:</p>\n\n<pre><code> myapp.rb:17 NoMethodError: undefined method `merge' for \"/Users/x/x/x/mysinatraapp/assets/sass\":String\n</code></pre>\n\n<p>Attempt 2:</p>\n\n<pre><code>get '/stylesheet.css' do\n    sass :'/assets/sass/core'\nend\n</code></pre>\n\n<p>Attempt 3:</p>\n\n<pre><code>get '/stylesheet.css' do\n    sass :'/assets/sass/core'\nend\n</code></pre>\n\n<p>Both return the following error:</p>\n\n<pre><code>Errno::ENOENT: No such file or directory - ./views/assets/sass/core.sass\n</code></pre>\n\n<p>Attempt 4:</p>\n\n<pre><code>get '/stylesheet.css' do\n    sass :'../assets/sass/core'\nend\n</code></pre>\n\n<p>This works! however, there must be something along the lines of <code>set :sass, Proc.new { File.join(root, \"assets/sass\") }</code> that sets this up for me?</p>\n"},{"tags":["ruby","magento"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13238453,"title":"How to use Magentor gem","body":"<p>I am trying to use the <a href=\"https://github.com/pstuteville/magentor\" rel=\"nofollow\">Magentor</a> gem. The documentation is very weak. I succeeded in calling <code>Magento::Category.info(1)</code>.</p>\n\n<p>But I failed to call <code>Magento::Category.create(args)</code>.</p>\n\n<p>The method definition is like the following.</p>\n\n<pre><code>  # catalog_category.create\n  # Create new category and return its id.\n  # \n  # Return: int\n  # \n  # Arguments:\n  # \n  # int $parentId - ID of parent category\n  # array $categoryData - category data ( array(’attribute_code’⇒‘attribute_value’ )\n  # mixed $storeView - store view ID or code (optional)\n  def create(attributes)\n    id = commit(\"create\", attributes)\n    record = new(attributes)\n    record.id = id\n    record\n  end\n</code></pre>\n\n<p>Here's what I tried.(parent id is 1)</p>\n\n<pre><code>args = [1, {:name =&gt; 'Cars', :description =&gt; 'Great Cars', :is_active =&gt; '1', :url_key =&gt; 'cars'}]\ncategory_id = Magento::Category.create(args)\n\nexception: 1 -&gt; SQLSTATE[21000]: Cardinality violation: 1241 Operand should contain 1 column(s)\n</code></pre>\n\n<p>Can anybody provide an example of calling the method?</p>\n"},{"tags":["ruby","bash","exec"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13241753,"title":"ruby exec use functions from my ~/.bashrc","body":"<p>In my <code>~/.bashrc</code>, I have a function:</p>\n\n<pre><code>function sayHi() {\n    echo \"hi, $@\"\n}\n</code></pre>\n\n<p>and in Ruby I want to:</p>\n\n<pre><code>`sayHi \"friend\"`\n</code></pre>\n\n<p>however, <code>sayHi</code> is \"not found\" in whatever context ruby runs <code>exec</code> or <code>system</code>.</p>\n\n<p>How could I get Ruby to use functions in my <code>.bashrc</code>?</p>\n"},{"tags":["ruby","testing","palindrome"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":532,"score":1,"question_id":10793234,"title":"Testing palindromes","body":"<p>I'm attempting to make a function in Ruby that tells if a string is a palindrome. I've checked over previous examples however I cannot find a solution that passes the tests that are ran on my code. The assignment starts us off with this bit of code.</p>\n\n<pre><code>def palindrome?(string)\n  # your code here\nend\n</code></pre>\n\n<p>And this is what I have made.</p>\n\n<pre><code>class String\n  def palindrome?(string)\n    y = string.downcase.scan(/\\w/)\n    if y == y.reverse\n      puts \"Palindrome\"\n    else\n      puts \"Not a palindrome\"\n    end\n  end\nend    \n</code></pre>\n\n<p>And this is the results of the test ran against it.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Failure/Error: palindrome?(\"A man, a plan, a canal -- Panama\").should be_true\nNoMethodError:\nundefined method `palindrome?' for \n#&lt;RSpec::Core::ExampleGroup::Nested_1:0x00000002c5e368&gt;\n # ./spec.rb:3:in `block (2 levels) in &lt;top (required)&gt;'\n # ./lib/rspec_runner.rb:36:in `block in run_rspec'\n # ./lib/rspec_runner.rb:32:in `run_rspec'\n # ./lib/rspec_runner.rb:23:in `run'\n # lib/graders/weighted_rspec_grader.rb:6:in `grade!'\n  # ./grade:32:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby","arrays","multidimensional-array"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":285,"score":0,"question_id":10862197,"title":"Ruby: how to know depth of multidemensional array","body":"<p>This is my problem I have met in my assignment.</p>\n\n<ul>\n<li>Array A has two elements: array B and array C.</li>\n<li>Array B has two elements: array D and array E</li>\n<li>At some point, array X just contains two elements: string a and string b.</li>\n</ul>\n\n<p>I don't know how to determine how deep array A is. For example:</p>\n\n<pre><code>arrA = [\n         [\n           [1,2]\n         ]\n       ]\n</code></pre>\n\n<p>I have tested by: <code>A[0][0][0] == nil</code> which returns <code>false</code>. Moreover, <code>A[0][0]..[0] == nil</code> always returns <code>false</code>. So, I cannot do this way to know how deep array A is.</p>\n"},{"tags":["ruby","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13241490,"title":"rvm ruby version and rails server different ruby version","body":"<p>it seams rails server uses different ruby then the one that is set up by rvm.</p>\n\n<p>How to make the rails server command use the same ruby as its set up in the rvm?</p>\n\n<p>when I start the rails server, (write rails server in console) it outputs \nruby 1.8.7 for ruby version. \nBut when I write</p>\n\n<pre><code> `ruby -v` \n</code></pre>\n\n<p>to see the ruby version, I get ruby 1.9.3p0 for ruby version.\nalso I have installed rvm and when I type </p>\n\n<pre><code>rvm list \n</code></pre>\n\n<p>it returns that I'm using ruby-1.9.3-p286, so rvm uses different ruby version than the rails server.\nI need to be able to start rails server with ruby-1.9.3.\nFirst I have installed ruby 1.8.7 that I installed rvm so I can use ruby-1.9.3.\nByt It seams that I I still can't use it with rails server.\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","gem","rvm","bundler"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13238119,"title":"Portable rails app with dependencies","body":"<p>Is there anything to make the rails development portable across operating systems (with prerequisite of ruby and rails installed in all OS)?</p>\n\n<p><strong>For example:</strong> </p>\n\n<p><ol>\n<li>I want to create an rails application named \"iApp\" in windows (Rails 3.2 installed already)</li>\n<li><p>Add necessary gems to \"Gemfile\" and run \"bundle install\"</p></p>\n\n<blockquote>\n  <p>Expectation: All dependencies must be installed within \"iApp\" folder</p>\n</blockquote></li>\n<li><p>Copy the iApp folder to a linux machine (Rails 3.2 installed already)</p></li>\n<li>run \"rake tests\" or run \"rails s\"\n\n<blockquote>\n  <p>Expectation: It should work outof the box without running \"bundle install\"</li>\n  </ol>\n  Should be possible to repeat steps 3 &amp; 4 in a Machintosh as well.</p>\n</blockquote>\n\n<p>Will RVM solve this problem? or is there any solution for this?</p>\n"},{"tags":["ruby-on-rails","ruby","facebook","authorization","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13209848,"title":"rails + omniauth: inspect basic info","body":"<p>this is my code to get the user's basic information after authorization:  </p>\n\n<pre><code>basic_info = request.env['omniauth.auth'].extra.raw_info\n\nfirst = basic_info.first_name\nlast = basic_info.last_name \nemail = basic_info.email \nid = basic_info.id\n</code></pre>\n\n<p>the four variables get the data, so it works.<br>\nbut when I'm trying <code>basic_info.inspect</code> command, I get:</p>\n\n<blockquote>\n  <p>\"#\"</p>\n</blockquote>\n\n<p>why is that? shouldn't it dump all the values?</p>\n"},{"tags":["ruby","ruby-c-extension"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13240425,"title":"Ruby C extension can't be 'require'd","body":"<p>I have a ruby extension that I'm building as a gem. It has this directory structure</p>\n\n<pre><code>|-ext\n  \\-cowboy\n    \\- extconf.rb\n    |- cowboy.c\n|-lib\n  \\- cowboy.rb\n  |- cowboy\n    \\- version.rb\n|- test\n  \\- test_cowboy.rb\n</code></pre>\n\n<p>When I build it and install it, there are no errors, and 'require'ing the gem (e.g.\n    require 'cowboy') works fine in irb.</p>\n\n<p>However, when I run \"ruby test/test_cowboy.rb\" I get a load error from the require (it actually is complaining about \"require 'cowboy/cowboy'\" that lives in lib/cowboy.rb.</p>\n\n<p>Does anyone know why???</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":50,"score":-1,"question_id":13241595,"title":"getting undefined method `id' when saving a document","body":"<p>When I try to save a document, I get this error:</p>\n\n<pre><code>undefined method `id' for \"504b6d66493f1b9c18000007\":String\n</code></pre>\n\n<p>with this parameter:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"VkES2ecwdT6dPg3DDPK+O4NRa0mZy7zKALnkBXJ1Hbs=\",\n \"document\"=&gt;{\"name\"=&gt;\"Hoje\",\n \"description\"=&gt;\"## que bla bla bla\",\n \"storage\"=&gt;\"504b6d66493f1b9c18000007\",\n \"pub\"=&gt;\"1\"},\n \"commit\"=&gt;\"Save document\",\n \"id\"=&gt;\"5096d0f2e667079c17000029\"}\n</code></pre>\n\n<p>as you can see, the Id which the error refers, belongs to <code>storage</code> and not to <code>document</code> itself...</p>\n\n<p>this is my relationship</p>\n\n<h1>document.rb</h1>\n\n<pre><code>class Document\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::Versioning\n  include Mongoid::FullTextSearch\n\n  #Fields\n  field :name, type: String\n  field :description, type: String\n  field :pub, type: Boolean, default: true\n  field :file_content, type: String\n\n  mount_uploader :file, FileUploader\n\n  #Validations\n  validates :name, presence: true;\n\n  #Relations\n  belongs_to :user\n  belongs_to :storage\n  belongs_to :organization\n\n  fulltext_search_in :file_content, \n    :index_name =&gt; 'fts_documento.content',\n    :filters =&gt; { \n      :pvt =&gt; lambda { |x| x.pub == true},\n      :org =&gt; lambda {|document| document.organization }\n    }\nend\n</code></pre>\n\n<h1>storage.rb</h1>\n\n<pre><code>class Storage\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  #Fields\n  field :path, type: String\n\n  #Validations\n  validates :path, presence: true\n\n  #Relations\n  belongs_to :user\n  belongs_to :organization\nend\n</code></pre>\n\n<p>and here is my <code>update</code> action</p>\n\n<pre><code>  def update\n    @document = Document.find params[:id]\n    if @document.update_attributes params[:document]\n\n      if params[:document][:file]\n        IndexerWorker.perform_async(@document.id)\n      end\n\n      redirect_to dashboard_path, notice: 'Document updated'\n    else\n      render 'document/edit'\n    end\n  end\n</code></pre>\n\n<p>I have no idea nor where to start...<br>\nIt was working a couple of weeks ago..  </p>\n"},{"tags":["ruby-on-rails","ruby","utf-8","character-encoding"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":12947910,"title":"Force strings to UTF-8 from any encoding","body":"<p>In my rails app I'm working with RSS feeds from all around the world, and some feeds have links that are not in UTF-8.  The original feed links are out of my control, and in order to use them in other parts of the app, they need to be in UTF-8.</p>\n\n<p>How can I detect encoding and convert to UTF-8?</p>\n"},{"tags":["ruby","ruby-c-extension"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13241547,"title":"Recommended way to build ruby c-extension for testing","body":"<p>I was building a rubygem by using </p>\n\n<pre><code>gem build $gemname.gemspec &amp;&amp; gem install $gemname-0.0.1.gem\n</code></pre>\n\n<p>However, this doesn't seem to be the best way to test the gem, since it moves it out of the local environment and into the rubygems paths. </p>\n\n<p>Is the recommendation to build the gem using </p>\n\n<pre><code>cd ext/$gemname &amp;&amp; ruby extconf.rb &amp;&amp; make\n</code></pre>\n\n<p>? Or is there a better practice?</p>\n"},{"tags":["ruby","jruby"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":95,"score":4,"question_id":13239338,"title":"Convert bloc to lambda in JRuby","body":"<p>How does one convert a bloc to a lambda in jruby? Basically what is the jruby answer for this: <a href=\"http://stackoverflow.com/questions/2946603/ruby-convert-proc-to-lambda\">Ruby: convert proc to lambda?</a>? </p>\n"},{"tags":["ruby","enumerator"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":35,"score":4,"question_id":13240104,"title":"infinite enumerator rewind","body":"<p>I have a function that generates an enumerator in the following manner:</p>\n\n<pre><code>def create_example_enumerator(starting_value)\n  current = starting_value\n  e = Enumerator.new do |y|\n    loop do\n      current += 1\n      y &lt;&lt; current\n    end\n  end\nend\n</code></pre>\n\n<p>The current behavior is pretty straightforward.</p>\n\n<pre><code>&gt; e = create_example_enumerator(0)\n#&lt;Enumerator: details&gt;\n&gt; e.next\n1\n&gt; e.next\n2\n&gt; e.rewind\n#&lt;Enumerator: details&gt;\n&gt; e.next\n3\n</code></pre>\n\n<p>I would like <code>e.rewind</code> to reset the enumerator back to it's starting value.\nIs there a nice way to do that while still using an infinite enumerator?</p>\n"},{"tags":["ruby","workaround","ruby-1.9","ruby-1.8"],"answer_count":8,"favorite_count":52,"up_vote_count":82,"down_vote_count":0,"view_count":18696,"score":82,"question_id":4333286,"title":"Ruby: require vs require_relative - best practice to workaround running in both Ruby <1.9.2 and >=1.9.2","body":"<p>What is the best practice if I want to <code>require</code> a relative file in Ruby <em>and</em> I want it to work in both 1.8.x and >=1.9.2?</p>\n\n<p>I see a few options:</p>\n\n<ul>\n<li>just do <code>$LOAD_PATH &lt;&lt; '.'</code> and forget everything</li>\n<li>do <code>$LOAD_PATH &lt;&lt; File.dirname(__FILE__)</code></li>\n<li><code>require './path/to/file'</code></li>\n<li>check if <code>RUBY_VERSION</code> &lt; 1.9.2, then define <code>require_relative</code> as <code>require</code>, use <code>require_relative</code> everywhere where it's needed afterwards</li>\n<li>check if <code>require_relative</code> already exists, if it does, try to proceed as in previous case</li>\n<li>use weird constructions such as <code><pre><code>require File.join(File.dirname(__FILE__), 'path/to/file')</code></pre></code> - alas they don't seem to work in Ruby 1.9 throughly, because, for example: <pre><code><code>$ cat caller.rb\nrequire File.join(File.dirname(__FILE__), 'path/to/file')\n$ cat path/to/file.rb\nputs 'Some testing'\n$ ruby caller\nSome testing\n$ pwd\n/tmp\n$ ruby /tmp/caller\nSome testing\n$ ruby tmp/caller\ntmp/caller.rb:1:in 'require': no such file to load -- tmp/path/to/file (LoadError)\n    from tmp/caller.rb:1:in '&lt;main&gt;'</code></code></pre></li>\n<li>Even weirder construction: <code><pre><code>require File.join(File.expand_path(File.dirname(__FILE__)), 'path/to/file')</code></pre></code> seems to work, but it's weird and not quite good looking.</li>\n<li>Use <a href=\"http://rubygems.org/gems/backports\" rel=\"nofollow\">backports</a> gem - it's kind of heavy, it requires rubygems infrastructure and includes tons of other workarounds, while I just want <code>require</code> to work with relative files.</li>\n</ul>\n\n<p>There's a <a href=\"http://stackoverflow.com/questions/4325759/is-require-file-expand-path-file-the-best-practice\">closely related question at StackOverflow</a> that gives some more examples, but it doesn't give a clear answer - which is a best practice.</p>\n\n<p>Is there are any decent, accepted-by-everyone universal solution to make my application run on both Ruby &lt;1.9.2 and >=1.9.2?</p>\n\n<h2>UPDATE</h2>\n\n<p>Clarification: I don't want just answers like \"you can do X\" - in fact, I've already mentioned most of choices in question. I want <em>rationale</em>, i.e. <em>why</em> it is a best practice, what are its pros and cons and why it should be chosen among the others.</p>\n"},{"tags":["ruby","hash"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":168,"score":2,"question_id":10198233,"title":"Do Ruby hashes have a method like `reject!` that returns matching items?","body":"<p>Do Ruby hashes have a method like <code>reject!</code> that returns matching items? For instance:</p>\n\n<pre><code>planets = {'Mars' =&gt; 2, 'Jupiter' =&gt; 63, 'Saturn' =&gt; 47}\n\nfew_moons = planets.some_method! do |planet, moon_count|\n  moon_count &lt; 50\nend\n\nfew_moons #=&gt; {'Mars'  =&gt; 2, 'Saturn' =&gt; 47}\nplanets   #=&gt; {'Jupiter' =&gt; 63}\n</code></pre>\n\n<p><code>reject!</code> returns the original hash, minus the rejected items. <code>partition</code> is close, but it returns arrays of tuples, not hashes, and doesn't modify the original hash.</p>\n\n<p>I don't see anything like this in the docs, and wanted to ask around before rolling my own.</p>\n"},{"tags":["ruby-on-rails","ruby","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13239469,"title":"How can I change Ruby to version 1.9.3 (again) with RVM?","body":"<p>I used to work with Ruby version 1.9.3 on Ubuntu and made an update that probably screwed my bash profile and I need help to turn it back rather than using version 1.8.7. Right now <code>rails s</code> opens the server with Ruby 1.8.7 and I get errors because of the newer syntax I use in my app.</p>\n\n<p><code>.bash_profile</code>:</p>\n\n<pre><code>cat ~/.bash_profile\n\n### Added by the Heroku Toolbelt\nexport PATH=\"/usr/local/heroku/bin:$PATH\"\n\n[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\" # Load RVM into a shell session *as a function*\n</code></pre>\n\n<p><code>which rails</code>:</p>\n\n<pre><code>/usr/local/bin/rails\n</code></pre>\n\n<p><code>which ruby</code>:</p>\n\n<pre><code>/usr/bin/ruby\n</code></pre>\n\n<p><code>ruby -v</code>:</p>\n\n<pre><code>ruby 1.8.7 (2011-06-30 patchlevel 352) [i686-linux]\n</code></pre>\n\n<p><code>rvm list</code>:</p>\n\n<pre><code>rvm rubies\n\n=* ruby-1.9.3-p194 [ i686 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p><code>rvm use 1.9.3</code>:</p>\n\n<pre><code>RVM is not a function, selecting rubies with 'rvm use ...' will not work.\n\nYou need to change your terminal emulator preferences to allow login shell.\nSometimes it is required to use `/bin/bash --login` as the command.\nPlease visit https://rvm.io/integration/gnome-terminal/ for a example.\n</code></pre>\n"},{"tags":["ruby","compass-css","scss","html5boilerplate"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13239992,"title":"run compass-h5bp project","body":"<p>I'm new to ruby, please forgive me for this silly question.</p>\n\n<p>I created a simple compass-h5bp project using the command below:</p>\n\n<pre><code>create my_project -r compass-h5bp -r html5-boilerplate -u html5-boilerplate --javascripts-dir js --css-dir css\n\ndirectory my_project/ \ndirectory my_project/css/ \ndirectory my_project/js/ \ndirectory my_project/sass/ \ndirectory my_project/sass/partials/ \n   create my_project/config.rb \n   create my_project/sass/style.scss \n   create my_project/sass/partials/_base.scss \n   create my_project/sass/partials/_overrides.scss \n   create my_project/sass/partials/_fonts.scss \n   create my_project/sass/partials/_media.scss \n   create my_project/sass/partials/_page.scss \n   create my_project/index.html \n   create my_project/index.html.haml \n   create my_project/js/jquery-1.6.2.js \n   create my_project/js/jquery-1.6.2.min.js \n   create my_project/js/modernizr-2.0.6.min.js \n   create my_project/js/plugins.js \n   create my_project/js/script.js \n   create my_project/404.html \n   create my_project/.htaccess \n   create my_project/crossdomain.xml \n   create my_project/robots.txt \n   create my_project/humans.txt \n   create my_project/apple-touch-icon.png \n   create my_project/apple-touch-icon-57x57-precomposed.png \n   create my_project/apple-touch-icon-72x72-precomposed.png \n   create my_project/apple-touch-icon-114x114-precomposed.png \n   create my_project/apple-touch-icon-precomposed.png \n   create my_project/favicon.ico \n   create my_project/css/style.css\n</code></pre>\n\n<p>now I wonder how to run this simple project via the browser, can some one help me with command?\nThanks.</p>\n"},{"tags":["ruby-on-rails","ruby","helpers"],"answer_count":4,"favorite_count":12,"up_vote_count":31,"down_vote_count":0,"view_count":12395,"score":31,"question_id":1179865,"title":"Why are all Rails helpers available to all views, all the time? Is there a way to disable this?","body":"<p>Why can I access helper methods for one controller in the views for a different controller? Is there a way to disable this without hacking/patching Rails?</p>\n"},{"tags":["html","ruby","selenium","selenium-webdriver"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13237374,"title":"Selenium + Ruby - Selecting Onclick in Outlook","body":"<p>I am trying to select this. </p>\n\n<pre><code>&lt;td colspan=2 align=\"right\" class=\"txtpad\"&gt;\n&lt;input type=\"submit\" class=\"btn\" value=\"Sign in\" onclick=\"clkLgn()\" \nonmouseover=\"this.className='btnOnMseOvr'\" onmouseout=\"this.className='btn'\"        \nonmousedown=\"this.className='btnOnMseDwn'\"&gt;\n&lt;input name=\"isUtf8\" type=\"hidden\" value=\"1\"&gt;\n&lt;/td&gt;\n</code></pre>\n\n<p>When I try this however,</p>\n\n<pre><code>element3 = driver.find_element(:value, \"Sign in\")\nelement3.click\n</code></pre>\n\n<p>It doesn't work. </p>\n\n<p>How can I click on the button to log in?</p>\n"},{"tags":["ruby-on-rails","ruby","haml"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":964,"score":7,"question_id":6244052,"title":"Empty attribute with Ruby HAML","body":"<p>I'm implementing Schema microformats on a Ruby project using HAML and can't figure out how to set an empty attribute on a tag. I tried nil and false, but they simply do not shown.</p>\n\n<p>Example: <code>&lt;div itemscope&gt;</code></p>\n\n<p>I'm tring to set an empty itemscope attribute.</p>\n\n<h3>Code added from comment by @StrangeElement:</h3>\n\n<p>My code: </p>\n\n<pre><code>.agency.premium{:itemscope =&gt; true, :itemtype =&gt; 'schema.org/ProfessionalService';} \n</code></pre>\n\n<p><code>:itemscope =&gt; true</code> seems to be the recommended approach from HAML's documentation. I get the same result as I would get with <code>:itemscope =&gt; ''</code>, a XHTML-valid attribute with an empty value (i.e. <code>&lt;div itemscope=\"\"&gt;</code>).</p>\n\n<p>Probably fine, but I'd rather have it empty as is documented in the Schema doc. </p>\n"},{"tags":["ruby-on-rails","ruby","rest","neo4j"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":770,"score":4,"question_id":8335136,"title":"Which Ruby REST API client for neo4j?","body":"<p>I wonder what the REST API clients are available for using from Ruby (not JRuby, so native bindings are not an option)?</p>\n\n<p>Ideally, I would want the API similar to the <code>neo4j</code> gem or <code>ActiveRecord</code> (validations, migrations, observers etc).</p>\n\n<p>Currently available (REST) tooling doesn't even come close to what we have, for example, in ActiveRecrod:</p>\n\n<ol>\n<li><a href=\"https://github.com/maxdemarzi/neography\" rel=\"nofollow\">neograhy</a> - just <strong>plain REST</strong> API. Nothing to do with models etc.</li>\n<li><a href=\"https://github.com/lordkada/neology\" rel=\"nofollow\">neology</a> - is just a <strong>wrapper over neography</strong> and isn't a full featured ActiveModel.</li>\n<li><a href=\"https://github.com/namxam/architect4r\" rel=\"nofollow\">architect4r</a> - <strong>conforms to ActiveModel</strong>, but provides only one way to query data (Gypher language), also no indexes support.</li>\n</ol>\n\n<p>I like the code of <code>architect4r</code> a little bit more (primarily because it uses ActiveModel).</p>\n\n<p>But <code>neology</code> seems to be much more pragmatic choice as it already is using <code>neography</code> under the hood.</p>\n\n<p>The choice is pretty small and tough.</p>\n\n<p>Could you please tell when one should be used rather than the other?<br>\nAlso any recommendations that would help me to decide on the gem are very welcome.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","json"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5054,"score":1,"question_id":4253238,"title":"Ruby array to JSON and Rails JSON rendering","body":"<p>I have a Ruby array, how can i render this as a JSON view in Rails 3.0?</p>\n\n<p>My Controller method is </p>\n\n<pre><code>def autocomplete\n     @question = Question.all\nend\n</code></pre>\n"},{"tags":["ruby","instance-method"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":27,"score":4,"question_id":13234284,"title":"Ruby Unbound Methods: Is it possible to force bind to instances of other classes?","body":"<p>I would like to know if I could force this to happen</p>\n\n<pre><code>class A\n  def bomb ; \"bomb\" ; end\nend\n\nclass B ; end\n\nbomb = A.instance_method(:bomb)\n\nb = B.new\nbomb.bind(b)\n</code></pre>\n\n<p>currently it throws the error TypeError: bind argument must be an instance of A</p>\n\n<p>I find this very limiting concerning what I can do with these unbound methods, the possibilities are a bit limiting. In cases like these (and I'm not referring only to idempotent functions) it would make sense right? And an execution error would have sufficed, In case I would be handling variables from A which are not replicated in B. I'd really like to know how to force this bind. </p>\n"},{"tags":["python","ruby","windows","cmd","system"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13237600,"title":"Ruby system call not observing path for python scripts","body":"<p>This works:</p>\n\n<pre><code>system \"python \\\"C:/Program Files (x86)/Google/google_appengine/someScript.py\\\"\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<pre><code>system \"python \\\"someScript.py\\\"\n</code></pre>\n\n<p>The directory containing <code>someScript.py</code> is added to my windows <code>PATH</code> variable, so if I open a CMD window and type:</p>\n\n<pre><code>someScript.py\n</code></pre>\n\n<p>it runs fine.</p>\n\n<p>How do I make is so that my ruby script is able to call <code>someScript.py</code> while observing the windows environment path variable so I don't have to specify an absolute path for the python script?</p>\n"},{"tags":["ruby","silverlight","actionscript-3","rtmp","rtmfp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13238085,"title":"Stream microphone to a server? Flash or Silverlight?","body":"<p>I'm looking to build an app, which will at least in part require audio streamed live from a client machine to a server.  I'd ideally like to run a linux server, the rest of my app is written in Ruby, so bonus points for a Ruby-centric set up, and I would like to avoid the Flash Media Server and/or Red5 if possible.  (It just seems like a lot of software that I'm not really going to use.)</p>\n\n<p>Bottom line -- can I stream from Flash without using RTMP/RTMFP?  If not, can I receive that in a Ruby-based app?  Is this worth even attempting in Silverlight?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":40,"score":4,"question_id":13182644,"title":"Rails Relation#update_all consumes more memory than Relation#update","body":"<p>The <code>Relation#update(id, attributes)</code> docs mentions that \"The resulting object is returned whether the object was saved successfully to the database or not.\", while the <code>Relation#update_all(updates, conditions = nil, options = {})</code> states that no instantiations, callbacks or validations are made (straight DB query).</p>\n\n<p>Running a simple performance test and replacing <code>Relation#update</code> with <code>Relation#update_all</code>, it looks like the memory consumption have increased.</p>\n\n<p>Any explanation?</p>\n\n<p>Excerpt:</p>\n\n<pre><code>#Before\nMyModel.update(my_hash['id'], special_attrs)\n\n#After (more memory consumed)\nMyModel.where(:id =&gt; my_hash['id']).update_all(special_attrs)\n\n#Update-2 (slightly more memory consumed than with update(id, attrs)\nMyModel.update_all(special_attrs, {:id =&gt; my_hash['id']})\n</code></pre>\n\n<ul>\n<li>Windows XP (yeh - I know)</li>\n<li>JRuby 1.6.8 (1.9)</li>\n<li>Rails 3.2.8</li>\n</ul>\n\n<p><strong>UPDATE</strong> - Some basic numbers for comparison: \nFor around 700 update statements fired, there's a difference of around 0.6MB (0.8kB per statement)</p>\n\n<p><strong>UPDATE 2</strong> - Removed AREL chaining as per @philip-hallstrom suggestion. Slight reduction in memory footprint but still <code>MyModel.update_all(attrs, conditions)</code> is consuming more memory than <code>MyModel.update(id, attrs)</code>.</p>\n"},{"tags":["ruby-on-rails","ruby","mongodb","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13197663,"title":"Order_by multiple fields, including a boolean","body":"<p>I'm trying to order my default_scope in a way that the itens with the boolean <code>important = true</code> show first, and all order by <code>created_at</code> desc.</p>\n\n<p>So, I have the following code:</p>\n\n<pre><code>default_scope order_by(:important =&gt; :desc, :created_at =&gt; :desc)\n</code></pre>\n\n<p>But, looks like <code>important</code> field order is ignored.</p>\n\n<p>How can I made it work?</p>\n\n<p>Thanks in advance</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I just shift the order of the order params and it works:</p>\n\n<pre><code>default_scope order_by(:created_at =&gt; :desc, :important =&gt; :desc)\n</code></pre>\n\n<p>Just that simple.</p>\n"},{"tags":["ruby","sass"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":463,"score":3,"question_id":8512802,"title":"Checking if a variable is defined in SASS","body":"<p>AS the title says I am trying to check whether a variable is defined in SASS. (I am using compass if that makes any different difference)</p>\n\n<p>I've found the Ruby equivalent which is:</p>\n\n<pre><code>defined? foo</code></pre>\n\n<p>Gave that a shot in the dark but it just gave me the error:</p>\n\n<p><code>defined\": expected \"{\", was \"?</code></p>\n\n<p>I've found a work around (which is obviously just to define the variable in all cases, which in this case it actually makes more sense) but I'd really like to know if this is possible for the future</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":13235283,"title":"Cloning Classes in Ruby","body":"<p>In my Ruby application, I want to clone a class so that I can make some slight changes to the clone without affecting the original class (see the note below for details). Unfortunately, the cloned class isn't behaving the way I would expect. Specifically, class methods of the cloned class seem to have trouble accessing constants and class variables. Observe:</p>\n\n<pre><code>irb(main):001:0&gt; class Foo\nirb(main):002:1&gt;   HELLO = \"Hello, world!\"\nirb(main):003:1&gt;   def self.say_hello\nirb(main):004:2&gt;     HELLO\nirb(main):005:2&gt;   end\nirb(main):006:1&gt;   def self.cls_var=(val)\nirb(main):007:2&gt;     @@cls_var = val\nirb(main):008:2&gt;   end\nirb(main):009:1&gt;   def self.cls_var\nirb(main):010:2&gt;     @@cls_var\nirb(main):011:2&gt;   end\nirb(main):012:1&gt; end\n=&gt; nil\nirb(main):013:0&gt; Foo.say_hello\n=&gt; \"Hello, world!\"\nirb(main):014:0&gt; Foo.cls_var = \"Test\"\n=&gt; \"Test\"\nirb(main):015:0&gt; Foo.cls_var\n=&gt; \"Test\"\nirb(main):016:0&gt; Bar = Foo.clone\n=&gt; Bar\nirb(main):017:0&gt; Bar.say_hello\nNameError: uninitialized constant Class::HELLO          # ???\n        from (irb):4:in `say_hello`\n        from (irb):17\n        from C:/Ruby193/bin/irb:12:in `&lt;main&gt;`\nirb(main):018:0&gt; Bar.cls_var = \"Another test\"\n(irb):7: warning: class variable access from toplevel   # Say what?\n=&gt; \"Another test\"\nirb(main):019:0&gt; Bar.cls_var\n(irb):10: warning: class variable access from toplevel\n=&gt; \"Another test\"\nirb(main):020:0&gt; Foo.cls_var\n=&gt; \"Another test\"                                       # Why???\n</code></pre>\n\n<p>What's going on here, and how do I fix this so that Bar works exactly the same as Foo does after I clone it?</p>\n\n<blockquote>\n  <p><em>Note: This question is a follow up to <a href=\"http://stackoverflow.com/q/13234384/1157054\">In Ruby, is there a way to 'override' a constant in a subclass so that inherited methods use the\n  new constant instead of the old?</a></em></p>\n</blockquote>\n\n<hr>\n\n<p><strong>Update:</strong> Sorry guys, I guess I wasn't very clear about why I want to do this. So in my case, <code>Foo</code> is a class in a gem which has functionality thats nearly identical to what I want for one of my classes. In fact, the only difference between <code>Foo</code> and what I want is that pesky <code>HELLO</code> constant. I want <code>MyClass.say_hello</code> to return \"Hello, Bob!\" instead of \"Hello, World!\". (And before you suggest just overriding <code>say_hello</code>, in my case Foo has lots of other methods that use <code>HELLO</code> and <code>say_hello</code> is much more complicated than it is in my example.)</p>\n\n<p>Now I could just change <code>Foo::HELLO</code> with <code>Foo::HELLO.slice!(0, 7) &lt;&lt; \"Bob!\"</code>, but that changes the behavior of the gem, which I don't want. So how would I create an exact duplicate of <code>Foo</code> that has a different value for <code>HELLO</code>?</p>\n\n<p><em><strong>TLDR:</strong> Foo is part of a gem so I don't want to edit the source. I want a class that behaves exactly the same way Foo does, except with <code>HELLO</code> set to a different value.</em></p>\n"},{"tags":["ruby","documentation","rdoc","ri"],"answer_count":2,"favorite_count":2,"up_vote_count":10,"down_vote_count":0,"view_count":3463,"score":10,"question_id":1575373,"title":"Why does my Ruby 'ri' tool not return results in command prompt?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1587354/ruby-1-9-ri-problem\">ruby 1.9 ri problem</a>  </p>\n</blockquote>\n\n\n\n<p>Greetings,</p>\n\n<p>When I try to use Ruby's <strong>ri</strong> tool in a command prompt window to acquire information about classes, methods, etc. it seems to always fail. For example if I type </p>\n\n<pre><code>ri Array\n</code></pre>\n\n<p>I get a message saying </p>\n\n<pre><code>Updating class cache with 0 classes... Nothing known about Array\n</code></pre>\n\n<p>What should I do to configure Ruby's <strong>ri</strong> tool to work?</p>\n\n<p>Thanks.</p>\n\n<p><em>NOTE: I am using Vista 64 with Ruby 1.9.1p243 (2009-07-16 revision 24175) [i386-mingw32] installed. (thanks MikeJ)</em></p>\n"},{"tags":["javascript","jquery","ruby","ajax","json"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":2,"view_count":54,"score":-2,"question_id":13224151,"title":"how to access from javascript, my_ruby_obj.price sent to browser as my_ruby_obj.to_json?","body":"<p><strong>In ruby:</strong></p>\n\n<pre><code>class Obj\n  attr_accessor :price\nend\n\nmy_ruby_obj = Obj.new\n</code></pre>\n\n<p>puts my_ruby_obj.to_json</p>\n\n<pre><code>\"\\\"#&lt;Obj:0x1c9b018&gt;\\\"\"\n</code></pre>\n\n<p><strong>Server sends my_ruby_obj.to_json to browser</strong> (sinatra, with content_type :json) in response to a jquery ajax request (with $.get), which correctly defines a return type of json, and launches a callback function(data) which does:</p>\n\n<p><code>console.log(data);</code> </p>\n\n<p>which returns:</p>\n\n<pre><code>#&lt;Obj:0x1c9b018&gt;\n</code></pre>\n\n<p><strong>Now how do I access \"data.price\" attribute in javascript/jquery</strong> as I would normally do on a ruby object to access its attribute? (\"my_ruby_obj.price\")</p>\n\n<p>I tried with console.log(data.price);</p>\n\n<pre><code>&gt; Undefined\n</code></pre>\n\n<p>I feel I am missing a big piece here.. and I guess it has to do with how json works with objects..</p>\n\n<p>Any help ?\n<em>If possible</em>, I'm looking for a correct way to do it with jquery.</p>\n\n<p>Thanks</p>\n\n<p><strong>edit:</strong> \ntrying to understand what is going on, I tried this in the callback:</p>\n\n<pre><code>newdata = $.parseJSON(data);\n</code></pre>\n\n<p>but debug console halts on it showing:</p>\n\n<pre><code>&gt; uncaught exception: Invalid JSON: #&lt;Obj:0x1c9b018&gt;\n</code></pre>\n\n<p>I did call .to_json on the ruby object, so why it says so? ...</p>\n\n<p>[[<strong>new_edit:</strong>]]</p>\n\n<p>Seems like ruby json serialization for objects from custom classes is not working as I supposed:</p>\n\n<p>Quoting from here: <a href=\"http://stackoverflow.com/a/4464721/988591\">http://stackoverflow.com/a/4464721/988591</a></p>\n\n<blockquote>\n  <p>It will be a bit more difficult for objects from your own classes. For\n  the following class, to_json will produce something like\n  <code>\"\\\"#&lt;A:0xb76e5728&gt;\\\"\"</code>. This probably isn't desirable. To effectively\n  serialise your object as JSON, you should create your own to_json\n  method.</p>\n</blockquote>\n\n<p>and examples are following... \nBut.. wow... isn't there an easier way ?</p>\n"},{"tags":["python","ruby","perl","security","penetration-testing"],"answer_count":13,"favorite_count":10,"up_vote_count":9,"down_vote_count":4,"view_count":2387,"score":5,"question_id":76408,"title":"Which of these scripting languages is more appropriate for pen-testing?","body":"<p>First of all, I want to avoid a flame-war on languages. The languages to choose from are Perl, Python and Ruby . I want to mention that I'm comfortable with all of them, but the problem is that I can't focus just on one. </p>\n\n<p>If, for example, I see a cool Perl module, I have to try it out. If I see a nice Python app, I have to know how it's made. If I see a Ruby DSL or some Ruby voodoo, I'm hooked on Ruby for a while.</p>\n\n<p>Right now I'm working as a Java developer, but plan on taking CEH in the near future. My question is: for tool writing and exploit development, which language do you find to be the most appropriate?</p>\n\n<p>Again, I don't want to cause a flame-war or any trouble, I just want honest opinions from scripters that know what they're doing.</p>\n\n<p>One more thing: maybe some of you will ask \"Why settle on one language?\". To answer this: I would like to choose only one language, in order to try to master it.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13234849,"title":"RoR - Time.strptime issues","body":"<p>Here is the method in question. </p>\n\n<pre><code>def published_at_setter\n    self.published_at = Time.strptime(\"#{@date} #{@time}\", \"%m/%d/%Y %I:%M %p\")\n    puts \" ~~~~~~~~~~~~~~~~~~~ #{@date} #{@time} ~~~~~~~~~~~~~~~~ #{self.published_at}\"\nend\n</code></pre>\n\n<p>With @date = \"09/11/2012\" and @time \"01:45 AM\" I get this in the webbrick console. WFT?</p>\n\n<pre><code>~~~~~~~~~~~~~~~~~~~ 09/11/2012 01:45 AM ~~~~~~~~~~~~~~~~ 2012-09-11 06:45:00 UTC\n</code></pre>\n\n<p>When in rails console I get the expected results. \"2012-09-11 01:45:00 -0500\"</p>\n"},{"tags":["ruby","ruby-on-rails-3","report"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":149,"score":4,"question_id":12889659,"title":"Ruby or Rails reporting tools?","body":"<p>I am looking for a report generation tool in ruby or rails which allows the user to define a template, then fetch data into the created template.</p>\n\n<p>I have been looking through \"<a href=\"https://www.ruby-toolbox.com/categories/reporting.html\" rel=\"nofollow\">The Ruby Box: reporting section.</a>\"</p>\n\n<p>There are two reporting tools I have looked at:</p>\n\n<ol>\n<li><p><strong><a href=\"http://www.thinreports.org/\" rel=\"nofollow\">Thin Reports</a>:</strong> It is really good. You can create your own report template with the template editor. Then you can produce PDF reports using <a href=\"http://rubygems.org/gems/thinreports/\" rel=\"nofollow\">thinreports</a> gems.</p></li>\n<li><p><strong><a href=\"https://github.com/sandrods/odf-report\" rel=\"nofollow\">ODF Report:</a></strong> You can create a template ODF file using Open Office and MS Word, and you can use that template to generate the report.</p></li>\n</ol>\n\n<p>Both of these solutions lack the ability to draw charts. Does anyone know of similar reporting tools that can draw charts within a given report?</p>\n\n<p>I have tried the <a href=\"http://ruby-rtf.rubyforge.org/\" rel=\"nofollow\">RTF Ruby Library</a>. It works, but shares the limitation that it cannot draw charts and graphs. </p>\n\n<p>The minimum requirements are:</p>\n\n<ol>\n<li><p>Able to create customizable templates. (e.g. design layout, set font size, color, embed images etc.)</p></li>\n<li><p>Able to draw tables and charts.</p></li>\n<li><p>Template could be in Docx or excel or xml or any other common file format.</p></li>\n<li><p>Report output report must be in Docx or RTF format.</p></li>\n</ol>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ubuntu","shopify"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13233938,"title":"shopify_app syntax error","body":"<p><strong>Edit: Debugging has got me further.  Question clarified.</strong></p>\n\n<p>We have installed Ruby, RubyGems and Rails and have forked the shopify_app project.  We have created a new rails applications and added three items to the Gemfile: <code>execjs</code>, <code>therubyracer</code> and <code>shopify_app</code>.</p>\n\n<p>Running <code>rails s</code> in order to start our rails application returns this trace:</p>\n\n<pre><code>root@ubuntu:/usr/local/pete-shopify/cart# rails s\nFaraday: you may want to install system_timer for reliable timeouts\n/var/lib/gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app.rb:15:in `require': /var/lib    /gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app/login_protection.rb:5: syntax error, unexpected ':', expecting kEND (SyntaxError)\n...rce::UnauthorizedAccess, with: :close_session\n                          ^\nfrom /var/lib/gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app.rb:15\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:68:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `each'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:66:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `each'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler/runtime.rb:55:in `require'\nfrom /var/lib/gems/1.8/gems/bundler-1.2.1/lib/bundler.rb:128:in `require'\nfrom /usr/local/pete-shopify/cart/config/application.rb:7\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:53:in `require'\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:53\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\nfrom /var/lib/gems/1.8/gems/railties-3.2.8/lib/rails/commands.rb:50\nfrom script/rails:6:in `require'\nfrom script/rails:6\n</code></pre>\n\n<p>I haven't modified any files since forking from Github.  Lines 1 - 6 of login_protection.rb are as follows:</p>\n\n<pre><code>module ShopifyApp::LoginProtection\n    extend ActiveSupport::Concern\n\n    included do\n        rescue from ActiveResource::UnauthorizedAccess, with: :close_session\n    end\n</code></pre>\n\n<p>I've looked into this and it <strong>seems</strong> that the error is caused by a new-style hash syntax between Ruby 1.8 and 1.9; <code>key : value</code> instead of <code>key =&gt; value</code>.</p>\n\n<p>Running <code>ruby -v</code> from the command line returns <code>ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-linux]</code>.  This would seem to be OK... but I did some debugging, and inside the file <code>/var/lib/gems/1.8/gems/shopify_app-4.1.0/lib/shopify_app.rb</code> (at the top) by putting this:</p>\n\n<p>puts RUBY_VERSION\nexit</p>\n\n<p>It printed <code>1.8.7</code>.  **Why are <code>ruby -v</code> and <code>RUBY_VERSION</code> giving me different results?  And am I correct in assuming this is the cause of my problems?</p>\n\n<p>Note: To upgrade Ruby I installed the later version with <code>apt-get</code> and then switched to it by using <code>update-alternatives --config ruby</code> and selecting option 2 like this:</p>\n\n<pre><code>root@ubuntu:/usr/local/pete-shopify/cart# update-alternatives --config ruby\nThere are 2 choices for the alternative ruby (providing /usr/bin/ruby).\n\n  Selection    Path                Priority   Status\n------------------------------------------------------------\n  0            /usr/bin/ruby1.8     50        auto mode\n  1            /usr/bin/ruby1.8     50        manual mode\n* 2            /usr/bin/ruby1.9.1   10        manual mode\n</code></pre>\n\n<p>Also note: We're PHP/Python developers so this is all new to us!</p>\n\n<p><strong>Summary:</strong></p>\n\n<p><strong>1 - Am I right in determining the cause of the syntax error?</strong></p>\n\n<p><strong>2 - Why does <code>RUBY_VERSION</code> and <code>ruby -v</code> give me different results?</strong></p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":11639141,"title":"putting a integer into a string in ruby","body":"<p>I want to send a file on a socket, and need to pass its length in the first four bytes. </p>\n\n<p>Here is what I want to do in C:</p>\n\n<pre><code>struct\n{\n  int lenght; //four bytes\n  char msg[40];\n}dataBuf;\n\nwrite(fd, &amp;databuf, sizeof(dataBuf))\n</code></pre>\n\n<p>How do I push an integer onto a socket, so it receives it as an integer at other end, not as an ASCII value?</p>\n\n<p>I don't want to hardcode it like \"<code>\\x04\\X03</code>\" and I tried to do it with <code>pack(L*)</code>. That only works with array and I don't have a way to break my four byte integer into a four byte array.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby","jquery-ui","jquery-ui-sortable"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13204628,"title":"jQuery-UI Sortable Connected-Lists save order and association to rails model","body":"<p>Let's say that I have:\na 'Survey' with many 'Questions' which has many 'Answers'</p>\n\n<p>If I had a 'Survey' that had 2 instances of a 'Question', let's call them: 'Good Question' and 'Bad Question'</p>\n\n<p>'Good Question' has 5 'Answers' and 'Bad Question' has 3 'Answers'</p>\n\n<p>If 'Good Question' and 'Bad Question' were connected sortable lists with this jQuery-UI interaction. <a href=\"http://jqueryui.com/sortable/#connect-lists\" rel=\"nofollow\">http://jqueryui.com/sortable/#connect-lists</a></p>\n\n<p>I know how to display them as 2 sortable lists using the jQuery-UI and I can also drop an 'Answer' from a 'Bad Question' to a 'Good Question'. But how would I save their new sorted positions and their newly sorted association to another 'Question' back to a Rails database?</p>\n\n<p>Railscasts has how to save position for a single sortable lists but not for lists that belong to different associated models.\n<a href=\"http://railscasts.com/episodes/147-sortable-lists-revised\" rel=\"nofollow\">http://railscasts.com/episodes/147-sortable-lists-revised</a></p>\n\n<p>I really appreciate the help here!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I realized that I just need to POST to the Rails controller, an element id of the list that I dropped the 'Answer' into (i.e <code>&lt;ol class = \"connectableSortable\" id = \"Good_Question\"&lt;/ol&gt;</code>) </p>\n\n<p>This is the syntax for how the Railscast does a POST to the Rails Controller to pass an array of object_id's in the sortable order.</p>\n\n<pre><code>jQuery -&gt;\n  $('#faqs').sortable(\n    axis: 'y'\n    update: -&gt;\n      $.post($(this).data('update-url'), $(this).sortable('serialize'))\n  )\n</code></pre>\n\n<p>How would I update this POST to pass the list ID to it, so I can just update the 'Question' foreign key for the 'Answer' to the list 'ID' that it fell into?</p>\n\n<p>This SO answer has a way to retrieve the list ID. <a href=\"http://stackoverflow.com/questions/9584816/jquery-sortable-get-the-item-object-where-the-element-is-dropped\">Jquery Sortable - get the item/object where the element is dropped</a></p>\n\n<p>So now, I really just need to know how to pass an extra parameter back to the rails controller. Any help?</p>\n"},{"tags":["ruby-on-rails","ruby","classloader"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13236083,"title":"Rails class loading skips namespaced class when another class of same name in root namespace is loaded","body":"<p>I have two namespaces, each with its own controller and presenter classes:\n<code>Member::DocumentsController</code>\n<code>Member::DocumentPresenter</code>\n<code>Guest::DocumentsController</code>\n<code>Guest::DocumentPresenter</code></p>\n\n<p>Both presenters inherit from <code>::DocumentPresenter</code>.</p>\n\n<p>Controllers access their respective presenters without namespace specified, e.g.:</p>\n\n<pre><code>class Guest::DocumentsController &lt; ActionController::Base\n    def show\n        DocumentPresenter.new(find_document)\n    end\nend\n</code></pre>\n\n<p>This usually calls presenter within same namespace. However sometimes in development environment I see base ::DocumentPresenter is being used.</p>\n\n<p>I suspect the cause is that base ::DocumentPresenter is already loaded, so Rails class auto-loading doesn't bother to look further. Is this likely the case? Can it happen in production environment too?</p>\n\n<p>I can think of two solutions:</p>\n\n<ul>\n<li>rename base class to DocumentPresenterBase</li>\n<li>explicitly require appropriate presenter files in controller files</li>\n</ul>\n\n<p>Is there a better solution?</p>\n"},{"tags":["ruby","binary-data","bindata"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":401,"score":4,"question_id":6324213,"title":"How do I start reading at an offset in binary data?","body":"<p>I have a C-like struct like this:</p>\n\n<pre><code>SomeStruct &lt;&lt; BinData::Record\nendian :little\n\nuint32 :offsetOfName\nuint32 :offsetOfLastname\n#...\nuint32 :lenVars\nstruct :Person, :length =&gt; :lenVars\n    string :name\n    string :lname\n    #...\nend\n</code></pre>\n\n<p>I have a bunch of offsets and lengths before <code>:Person</code>. All the offsets and lengths describe the data within the <code>:Person</code> struct. </p>\n\n<p>How can I start reading data at a specified offset, for the given length, or until the next offset?</p>\n"},{"tags":["ruby","bit-manipulation"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":359,"score":2,"question_id":7110374,"title":"extract bit in Ruby Integers","body":"<p>I need to get the n-th bit of an Integer, either signed or unsigned, in Ruby.</p>\n\n<pre><code>x = 123 # that is 1111011\nn = 2   # bit 2 is ...0 \n</code></pre>\n\n<p>The following piece of code doesn't work in the general case:</p>\n\n<pre><code>x.to_s(2)[-(n+1)] #0 good! but...\n</code></pre>\n\n<p>because of negative numbers not represented as 2-complement:</p>\n\n<pre><code>-123.to_s(2) # \"-1111011\"\n</code></pre>\n\n<p>So how to proceed?</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":12642,"score":10,"question_id":941856,"title":"Write binary file in Ruby","body":"<p>Is there a simple way to write binary data into binary file like we used to do in C/C++? For example, how can I create a 4-byte file with serialized 4-byte integer value without using fancy math?</p>\n"},{"tags":["ruby-on-rails","ruby","wcf","nokogiri"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":11521095,"title":"Nokogiri communication with Microsoft WCF (Binary)?","body":"<p>I am using Ruby (Nokogiri) to talk to a service written in Microsoft WCF.  Recently developers have changed this to use a binary representation instead of plain text. Does Nokogiri support this?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":965,"score":2,"question_id":4886994,"title":"Reading a binary 16-bit signed (big-endian) integer in Ruby","body":"<p>I tried to read from a file where numbers are stored as 16bit signed integers in big-endian format.</p>\n\n<p>I used unpack to read in the number, but there is no parameter for a 16bit signed integer in big-endian format only for an unsigned integer. Here is what I have so far:</p>\n\n<pre><code>number = f.read(2).unpack('s')[0]\n</code></pre>\n\n<p>Does anyone know a way how to interpret the number above as a signed integer or another way to achieve what I want?</p>\n"},{"tags":["ruby-on-rails","ruby","debugging","skip"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":166,"score":3,"question_id":9913010,"title":"Ruby Debug: Skip Rails Code","body":"<p>When stepping through the Ruby Debugger in Rails, how do I only have it stop only at code that I wrote, skipping over all the native Rails code?</p>\n\n<p>(ie skipping all the code that looks like this)</p>\n\n<pre><code>/Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/module/remove_method.rb:4\nremove_method(method)\n(rdb:1) s\n[76, 85] in /Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/class/attribute.rb\n   76          def self.#{name}?() !!#{name} end\n   77  \n   78          def self.#{name}=(val)\n   79            singleton_class.class_eval do\n   80              remove_possible_method(:#{name})\n=&gt; 81              define_method(:#{name}) { val }\n   82            end\n   83  \n   84            if singleton_class?\n   85              class_eval do\n/Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/class/attribute.rb:81\ndefine_method(:#{name}) { val }\n(rdb:1) s\n[79, 88] in /Users/jon/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.1/lib/active_support/core_ext/class/attribute.rb\n   79            singleton_class.class_eval do\n   80              remove_possible_method(:#{name})\n   81              define_method(:#{name}) { val }\n   82            end\n   83  \n=&gt; 84            if singleton_class?\n   85              class_eval do\n   86                remove_possible_method(:#{name})\n   87                def #{name}\n   88                  defined?(@#{name}) ? @#{name} : singleton_class.#{name}\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","string","class"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":12950861,"title":"How to convert a Ruby classname (\"NewUserBatch\") to string with underscores (\"new_user_batch\")","body":"<p>I need a generic way to convert classnames to lowercase with underscores. For example, I wish to convert the classname <code>NewUserBatch</code> to <code>new_user_batch</code>. How to do this?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":105,"score":0,"question_id":6836005,"title":"Best way to convert three bytes to an unsigned integer, from a binary file?","body":"<p>What is the best way to convert three bytes to an unsigned integer, from a binary file?</p>\n\n<p>This is my current solution, do you know a better one?</p>\n\n<pre><code>a, b, c = file.read(3).unpack(\"C*\")\na &lt;&lt; 16 | b &lt;&lt; 8 | c\n</code></pre>\n"},{"tags":["ruby","binary-data","choice","bindata"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":373,"score":1,"question_id":6314915,"title":"Using Ruby BinData gem to read choices","body":"<p>I am implementing a data structure using Ruby and the <a href=\"http://bindata.rubyforge.org/\" rel=\"nofollow\">BinData</a> gem. I need to implement a <code>Choice</code> value. According to the BinData documentation, a choice can be implemented as:</p>\n\n<pre><code>class MyData &lt; BinData::Record\n  uint8  :type\n  choice :data, :selection =&gt; :type do\n    type key #option 1\n    type key #option 2\n  end\nend\n</code></pre>\n\n<p>I need to have a default option in the choice:</p>\n\n<pre><code>class MyRecord &lt; BinData::Record\n    uint8 :type\n    choice :mydata, :selection =&gt; :type do\n            uint32 0\n            uint16 1\n    end\nend\n</code></pre>\n\n<p>How can that be handled if <code>type</code> is not <code>0</code> or <code>1</code> in the above code?</p>\n"},{"tags":["ruby","mongodb","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12927934,"title":"Mongo::ReplSetConnection authenticate fail","body":"<p>This is the simple script. </p>\n\n<pre><code>require 'mongo'\ndatabase=Mongo::ReplSetConnection.new([\"database1:9900\", \"database2:9900\",\"database3:9900\"]).db(\"project\")\ndatabase.authenticate(\"user\",\"passwd\")\n</code></pre>\n\n<p>I got the following error:</p>\n\n<pre><code>undefined local variable or method `pools' for # &lt;Mongo::ReplSetConnection:0x0000000441e610&gt;\nfrom /home/tommy/.rvm/gems/ruby-1.9.3-p194@myrails3/gems/mongo-1.7.0/lib/mongo/repl_set_connection.rb:309:in `authenticate_pools'\n</code></pre>\n\n<p>Has anyone encountered such problem before? Is there any suggestions?</p>\n"},{"tags":["ruby","bindata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":8152304,"title":"Ruby, BinData, boolean not recognized as object type","body":"<p>The code below doesn't work, yet the type boolean exists and I used it in another class the same way, why doesn't it work here?</p>\n\n<pre><code>require 'bindata'\nclass TESTSTUFF &lt; BinData::Record\n  array  :boolstuff, :type =&gt; :boolean, :initial_length =&gt; 8\nend\n</code></pre>\n\n<p>The error is: <code>unknown type 'boolean' in TESTSTUFF (TypeError)</code></p>\n"},{"tags":["ruby","bindata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":10849704,"title":"Validating a BinData::Record on initialization","body":"<p>Is there a way to validate the fields being set on a BinData::Record during initialization?  The check_value for each parameter appears to only be evaluated after reading from an input stream</p>\n\n<pre><code>class Foo &lt; BinData::Record\n   uint8 :bar,:check_value=&gt;lambda{raise 'Here is an error'}\nend\n\nFoo.new(:bar=&gt;5)  #Does not raise validation exception\n</code></pre>\n\n<p>I've tried adding an 'initialize_instance' where it does a read on 'to_binary_s' but it throws some other errors, presumably because the object isn't fully instantiated.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby","jquery-ui"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13234982,"title":"How to properly implement a form that is using the jQuery UI autocomplete widget?","body":"<p>I am using Ruby on Rails 3.2.2 and the <a href=\"https://github.com/rails/jquery-ujs\" rel=\"nofollow\">jquery-rails 2.1.3</a> (including jQuery UI). I am trying to implement a HTML form so to search, select and submit city data by using the <a href=\"http://jqueryui.com/autocomplete\" rel=\"nofollow\">Autocomplete</a> jQuery UI widget.</p>\n\n<p>At this time I am implementing my form with the following \"autocompletable\" field:</p>\n\n<pre><code>&lt;div class=\"ui-widget\"&gt;\n  &lt;label for=\"cities\"&gt;City: &lt;/label&gt;\n  &lt;input id=\"cities\" /&gt;\n&lt;/div&gt;\n\n&lt;script&gt;\n  $jQ(function() {\n    var cache = {};\n    $jQ( \"#cities\" ).autocomplete({\n      autoFocus: true,\n      minLength: 3,\n      source:    function( request, response ) {\n        $jQ.ajax({\n            url:      '&lt;SEARCH_PATH&gt;',\n            data:     { search: request.term },\n            dataType: 'json',\n            success:  function(data) {\n              var cities = new Array();\n\n              $jQ.each(data, function(arrayID, city) {\n                cities.push({ label: city.name, value: city.id })\n              });\n\n              response( cities ); \n            },\n            error:    function () {\n              response([]);\n            }\n        });\n      }\n    });\n  });\n&lt;/script&gt;\n</code></pre>\n\n<p>The above code works as expected for retrieving JSON data and displaying the list of retrieved cities. As you can see, the \"useful part\" of city data is the <code>id</code> of the city since I am using the <code>id</code> value in order to handle internally the submitted data. However, given the \"selectable\" list of cities is displayed, when I use keyboard UP and DOWN arrows in order to select one of those cities then the input field is populated with the city <code>id</code> (not with the city <code>name</code>).</p>\n\n<p>I would like to:</p>\n\n<ul>\n<li><em>display the city <code>name</code> instead of the <code>id</code> in the input field on selecting the city;</em></li>\n<li><em>find a way in order to submit the city <code>id</code> and not the city <code>name</code></em> (even if the city <code>name</code> is the only thing displayed in the front end content).</li>\n</ul>\n\n<p>How could / should I make to properly accomplish that?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":199,"score":1,"question_id":9762872,"title":"Ruby: define function prototypes?","body":"<p>It is possible to define a prototype of a function or in some way indicate to Ruby that a function exists even though it may not be defined yet? </p>\n\n<p>I have lots of classes like this:</p>\n\n<pre><code>class Program \n  FIRST  = Block.FIRST\n  FOLLOW = Set.new['$']\nend\n\nclass Block\n  FIRST  = Declaration.FIRST\n  FOLLOW = Set.new['.'] \nend\n\nclass Declaration\n  FIRST  = ConstDecl.FIRST + VarDecl.FIRST + ProcDecl.FIRST\nend\n\nclass ConstDecl\n  FIRST = Set.new['const'] + EMPTY_SET\nend\n</code></pre>\n\n<p>Which as you can see reference fields from classes that are defined below them, Is there a way to indicate to Ruby that these classes exist, and ask Ruby to look for them?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13235716,"title":"Not null fields for ActiveAttr","body":"<p>I'm having issues enforcing a field to not be nil within <code>ActiveAttr::Model</code>.</p>\n\n<p>Is there an elegant way of enforcing this constraint within the model instead of defining it in the controller? Or am I testing incorrectly for the scenario?</p>\n\n<p>Model:</p>\n\n<pre><code>class Message\n  include ActiveAttr::Model\n\n  attribute :name, :presence =&gt; true, :allow_nil =&gt; false, :allow_blank =&gt; false\n  attribute :email, :presence =&gt; true\n  attribute :content, :presence =&gt; true\n\n  validates_format_of :email, :with =&gt; /^[-a-z0-9_+\\.]+\\@([-a-z0-9]+\\.)+[a-z0-9]{2,4}$/i\n  validates_length_of :content, :maximum =&gt; 500\nend\n</code></pre>\n\n<p>RSpec:</p>\n\n<pre><code>module MessageSpecHelper\n  def valid_message_attributes\n    {\n       :name =&gt; \"Walter White\",\n       :email =&gt; \"walter@hailtheking.com\",\n       :content =&gt; \"I am the one who knocks\"\n   }\n  end\nend\n\nit \"should have error on name (alternate with nil)\" do \n  @message.attributes = valid_message_attributes.except(:name =&gt; nil)\n  @message.should have(1).error_on(:name)\nend\n</code></pre>\n"},{"tags":["ruby","bindata"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13197878,"title":"BinData: define structure based on first two bytes","body":"<p>I'm using Ruby and trying to read binary data from a TCP interface. The message received contains a header and a payload. The payload is determined by an id from the header.</p>\n\n<p>This is an example:</p>\n\n<pre><code>class TCPmessage &lt; BinData:: Record\n\n  class PayloadType_1 &lt; BinData::Record\n    uint8 :payloadType_1\n    # more payload data\n  end\n\n  class PayloadType_2 &lt; BinData::Record\n    uint8 :payloadType_2\n    # more payload data\n  end\n\n  uint8 :payload_id\n\n  array :payload, :type =&gt; &lt;&lt;Here I need to select \"PayloadType_1\" or \"PayloadType_2\" based on the \"payload_id\" from above&gt;&gt;, ...\n\nend\n</code></pre>\n\n<p>I tried a few variants but only came up with the following solution:</p>\n\n<pre><code>class TCPmessage &lt; BinData:: Record\n\n  class PayloadType_1 &lt; BinData::Record\n    uint8 :payload_id\n    uint8 :payloadType_1\n    # more payload data\n  end\n\n  class PayloadType_2 &lt; BinData::Record\n    uint8 :payload_id\n    uint8 :payloadType_2\n    # more payload data\n  end\n\n  uint8 :payload_id\nend\n</code></pre>\n\n<p>In the main program I first read <code>payload_id</code> and then use a <code>case</code> statement to choose which class to instantiate next:</p>\n\n<pre><code>x = TCPmessage.new\ncase x.read(\"TCPmessage\").payload_id.to_s\nwhen \"1\"\n  y = TCPmessage::PayloadType_1.new\nwhen \"2\"\n  y = TCPmessage::PayloadType_2.new\nend\ny.read(\"TCPmessage\")\n</code></pre>\n\n<p>I'm sure there is another solution using the compound types (arrays/choices) from BinData gem but I could not see it.</p>\n"},{"tags":["ruby","passenger","redmine"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13215707,"title":"Passenger: The application spawner server exited unexpectedly: Connection closed","body":"<p>I was trying to deploy Redmine to Apache with mod_passenger on CentOS 6.3 but having the error :</p>\n\n<blockquote>\n  <p>The application spawner server exited unexpectedly: Connection closed</p>\n</blockquote>\n\n<p>I installed the latest version (3.0.18) of passenger using gem.</p>\n\n<p>After various failed attempts I decided to delete passenger from \"gem uninstall passenger\" and install it again using \"yum install rubygem-passenger\" instead. The installed version was \"3.0.17\"</p>\n\n<p>Then it started working. Still don't know why exactly.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13235448,"title":"Pull specific methods from a module into the global namespace in ruby","body":"<p>Is it possible to pull in functions from a module to the global namespace in ruby with specifically naming the functions (aka not the entire module)?</p>\n\n<p>I have a module that didn't use a module originally, and I want to move the classes/methods into a module, but still keep around a module that will have everything at the global level for compatibility. So far I have this.</p>\n\n<pre><code># graph.rb\nrequire 'foo_graph'\ninclude foo\n\n# foo_graph.rb\nmodule foo\n    # contents of the old graph.rb\nend\n</code></pre>\n\n<p>But module <code>foo</code> is also in use in completely unrelated files and calling <code>include</code> could pull more stuff into the global namespace than I intend.</p>\n\n<p>Is there a way for me to specify which functions I want to pull in with <code>include</code> or is there an alternative to do what I want?</p>\n"},{"tags":["ruby","rubygems","watir","watir-webdriver"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13234347,"title":"while loop not stopping","body":"<p>I am trying to populate a text field but my while loop its not working its stuck i the loop. Can you please let me know what I doing wrong? Thanks in advance</p>\n\n<pre><code>mainStatus = ['vehicleList[0].mainStatus','vehicleList[1].mainStatus','vehicleList[2].mainStatus','vehicleList[3].mainStatus','vehicleList[4].mainStatus','vehicleList[5].mainStatus','vehicleList[6].mainStatus','vehicleList[7].mainStatus']\nsubStatus = ['vehicleList[0].subStatus','vehicleList[1].subStatus','vehicleList[2].subStatus','vehicleList[3].subStatus','vehicleList[4].subStatus','vehicleList[5].subStatus','vehicleList[6].subStatus','vehicleList[7].subStatus']\ni = 0\n\nwhile browser.text_field(:name =&gt; 'selection').value == ''\n    if browser.span(:name =&gt; mainStatus[i]).text == 'AVAILABLE' &amp;&amp; (browser.span(:name =&gt; subStatus[i]).exists?) == false\n        browser.text_field(:name =&gt; 'selection').set (i + 1).to_s\n        browser.button(:name =&gt; \"OpSelect\").click\n    else \n        i + 1   \n    end\n        if i == 8 &amp;&amp; browser.button(:name =&gt; \"OpSelect\").click.exists?\n            browser.button(:name =&gt; \"OpSelect\").click\n            i = 0\n        end\nend \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ffmpeg"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":49,"score":4,"question_id":13168866,"title":"What's the easiest way to merge video, audio and image files?","body":"<p>We are planning a Wep App for a Hackathon that's happening in about 2 weeks.\nThe app basic functions are:</p>\n\n<ul>\n<li>The users are guided step-by-step to upload a video, audio and image.</li>\n<li>The image is used as a cover for the audio. Making it into a video file.</li>\n<li>The two video files are <strong>merged</strong> thus creating a <strong>single</strong> video from the initial three files.</li>\n</ul>\n\n<p>So, my problem is:</p>\n\n<ol>\n<li>How do you create a video from an audio with an image as \"cover\".</li>\n<li>How do you merge this two videos.</li>\n</ol>\n\n<p>We are thinking of using Heroku for deployment. Is there a way to do it using something like <a href=\"https://github.com/streamio/streamio-ffmpeg\" rel=\"nofollow\">stremio</a>?</p>\n\n<p>What would be the best approach? A VPS running a C++ script? How's the easiest way to do it?</p>\n"},{"tags":["ruby","text","binary"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13228116,"title":"In Ruby, Whether I should treat a big file (made up of 4 characters) as Text or Binary?","body":"<p>I'm now going to manipulate large files in Ruby.</p>\n\n<p>What I'm going to do is to add a header line to a gigabyte size file containing a sequence of characters with no new-lines and output the result to a new file. (shown below in example). There can be one of four characters at each position in the sequence (a, c, g, t)</p>\n\n<p>My questions are</p>\n\n<ol>\n<li><p>Should I open gigabyte size file &amp; ouput file whether as Binary or as Text file?</p></li>\n<li><p>I'd like to know a sample code. (If possible, I don't want to load all the data of giga-byte size file at once on memory of my computer.)</p></li>\n</ol>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p>Example\nSuppose the program name is add-header-giga (The 1st argument is header-line and the 2nd argument specifies the input file name. Output file name is output-file)</p>\n\n<pre>\n>cat giga-byte-size-file.txt\ncctgcaggagcagagcaaagaggtggccatccgcatctttcgggctgccagtttcgctcctggaggctgtgcag....\n\n\n>add-header-giga DNA-sequence-from-Homo-Sapiens  giga-byte-size-file.txt\n\n\n>cat output-file\nDNA-sequence-from-Homo-Sapiens\ncctgcaggagcagagcaaagaggtggccatccgcatctttcgggctgccagtttcgctcctggaggctgtgcag....\n</pre>\n"},{"tags":["ruby","svn","binding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":11129119,"title":"Ruby 1.9 SVN Bindings in Ubuntu 12.04","body":"<p>I need some help getting the Ruby SVN bindings to work under Ubuntu 12.04<br></p>\n\n<p>We're using:</p>\n\n<ul>\n<li>Ruby 1.9.3</li>\n<li>Ubuntu 12.04</li>\n<li>SVN 1.6.17</li>\n</ul>\n\n<p>We are not using rvm.</p>\n\n<p>I tried an <code>apt-get install libsvn-ruby</code>, but it doesn't actually seem to install the bindings. When I try to require svn/core, Ruby complains that it does not exist. Looking at a description of the package, it says it's a dummy package.</p>\n\n<p>I have spent quite a lot of time trying to create the bindings manually by checking out <a href=\"http://svn.apache.org/repos/asf/subversion/tags/1.6.17\" rel=\"nofollow\">http://svn.apache.org/repos/asf/subversion/tags/1.6.17</a> and following the instructions in subversion/bindings/swig/INSTALL, but I always end up getting errors when I try to run <code>make swig-rb</code></p>\n\n<p>None of my Google searches return useful information about the errors, or about how I'm supposed to get the bindings to work. Can anyone give me some steps to get Ruby 1.9 talking to SVN?</p>\n"},{"tags":["ruby-on-rails","ruby","nginx","capistrano","railscasts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13235165,"title":"Nginx redirecting to IP","body":"<p>I recently used the Deploying to VPS Railscasts by Ryan Bates for one of my projects. Everything worked like a charm however there is one small issue which is bugging me regarding the nginx configuration. For some reason whenever I enter the staging enviornment domain it shows the right page but gets redirected to an IP instead of showing the domain. </p>\n\n<p>For example if the domain is example.com it gets redirected to xx.xx.xxx.xx which is the IP address of the server. </p>\n\n<p>Can anyone help me resolving this. I have tried several online sources but none of them seems to work. Most of the time I just end up having nginx in infinite loop creating redirects. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","redirect"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":383,"score":3,"question_id":5820901,"title":"Can we follow redirects with Typheous Ruby?","body":"<p>Is it possible to follow redirects with Typhoeus and how?</p>\n"},{"tags":["ruby","cli","thor"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13225275,"title":"Running command line commands from Thor executable","body":"<p>In my executable Ruby file I have the following:</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nrequire 'thor'\n\ninclude Thor::Actions\n\nclass UI &lt; Thor\n  # def self.source_root\n  #   File.dirname(__FILE__)\n  # end\n\n  desc \"makecal\", \"Generates postscript calendar to your desktop\"\n  def makecal\n    # puts `ls ~`\n    puts run('ls ~')\n    # puts run \"pcalmakecal -B -b all -d Helvetica/8 -t Helvetica/16 -S #{Time.now.month} #{Time.now.year} &gt; ~/Desktop/#{Time.now.month}-#{Time.now.year}\"\n  end\nend\n\nUI.start\n</code></pre>\n\n<p>In the terminal when I run the file as is I get an empty line as Thor's run command is returning a NilClass. </p>\n\n<p>However, when I un-comment the puts `ls ~` and comment out Thor's run method I get an output of my home directory as expected. </p>\n\n<p>I'm having trouble figuring out why I can't get Thor's run method to work like Ruby's ticks. </p>\n\n<p>Any ideas where I may have went wrong? </p>\n\n<p>Thanks for looking</p>\n"},{"tags":["ruby","osx-lion","rvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":13224930,"title":"rvm config: No such file or directory","body":"<p>When I run <code>rvm list</code>,it shows:</p>\n\n<pre><code>rvm rubies\n\n=&gt; /Users/ohho/.rvm/scripts/list: line 321: /Users/ohho/.rvm/rubies/ruby-1.8.7-p371/config: No such file or directory\nruby-1.8.7-p371 [  ]\n * ruby-1.9.3-p194 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p>Is it an error or can I just ignore it?</p>\n\n<p>UPDATE</p>\n\n<p>The error goes away after <code>rvm get stable</code> which updates <code>rvm 1.16.16</code> to <code>rvm 1.16.17</code>. A <code>config</code> file shows up in <code>~/.rvm/rubies/ruby-1.8.7-p371/</code> after the rvm upgrade. </p>\n"},{"tags":["ruby","rvm","ubuntu-12.04"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13229647,"title":"Missing lib 'libruby.so.1.9' error while ruby installation in Ubuntu 12.4 using rvm","body":"<p>I am trying to install ruby using rvm on a remote server through terminal. <br>\nI am following this link <br>\n<a href=\"http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/\" rel=\"nofollow\">http://ryanbigg.com/2010/12/ubuntu-ruby-rvm-rails-and-you/</a></p>\n\n<p>But at the install step I get the following error. I tried to look for the issue over net but couldn't resolve it. Please help me here. Thanks a lot in advance.</p>\n\n<p><strong>$ rvm install 1.9.3</strong></p>\n\n<p><a href=\"https://rvm.io/binaries/ubuntu/12.04/x86_64/ruby-1.9.3-p286.tar.bz2\" rel=\"nofollow\">https://rvm.io/binaries/ubuntu/12.04/x86_64/ruby-1.9.3-p286.tar.bz2</a> - #configure<br>\nruby-1.9.3-p286 - #download<br>\nruby-1.9.3-p286 - #extract<br>\nruby-1.9.3-p286 - #validate<br>\n<strong>Libraries missing for ruby-1.9.3-p286: libruby.so.1.9. Refer to your system manual for installing libraries</strong> <br>\nMounting remote ruby failed, trying to compile.<br>\nInstalling Ruby from source to: /home/ubuntu/.rvm/rubies/ruby-1.9.3-p286, this may take a while depending on your cpu(s)...<br>\nruby-1.9.3-p286 - #downloading ruby-1.9.3-p286, this may take a while depending on your connection...<br>\nruby-1.9.3-p286 - #extracted to /home/ubuntu/.rvm/src/ruby-1.9.3-p286 (already extracted)\nPatch cflags was already applied.<br>\nruby-1.9.3-p286 - #configuring<br>\nruby-1.9.3-p286 - #compiling<br>\nWrite failed: Broken pipe</p>\n"},{"tags":["php","python","ruby","jvm","scalability"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":10,"view_count":105,"score":-10,"question_id":13234946,"title":"Why All JVM languages are highly salable than other","body":"<p>I always heard that the JVM languages you can scale it as you want, and when people talk about performance the JVM languages come on top (scala, or even native java) rather than Ruby,PHP and python (am not sure regarding python maybe you can scale as you want).</p>\n\n<p>I think Native java code is faster than scala and other JVM language but scala become popular cause they combine(functional and Object Oriented) </p>\n"},{"tags":["ruby-on-rails","ruby","rake","ruby-on-rails-3.2","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13118905,"title":"500 error page with no information in production.log","body":"<p>I am currently encountering couple of issues with the a rails application deployed on Linode server. The gemfile looks like below :</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngroup :assets do\n    gem 'sass-rails',   '~&gt; 3.2.3'\n    gem 'coffee-rails', '~&gt; 3.2.1'\n    # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n     # gem 'therubyracer', :platforms =&gt; :ruby\n    gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'rails', '3.2.8'\ngem 'mysql2'\ngem 'activeadmin',:git =&gt; \"git@github.com:sadanmasroor/active_admin.git\"\ngem 'jquery-rails'\ngem 'roo'\n\ngroup :production do\n     gem 'unicorn'\nend\n\ngroup :development do \n    gem 'thin'\n    gem 'capistrano'\nend\n</code></pre>\n\n<p>Apparently there were list of issues with ActiveAdmin in the beginning mostly with activeadmin assets which I finally overcame by debugging the issues. Now the problem is that the assets precompile successfully in development and also in production ( Capistrano Assets Precompile Task) however I am getting a 500 error when accessing the index page even. </p>\n\n<p>The weird part is that there is no error in production log. It just shows that the assets precompiled successfully. I have no idea what exactly is causing this issue. I have been trying to figure this thing out for almost three days now. Have tried literally everything I could to resolve it from the ActiveAdmin issues to stackoverflow and everything but no result. If I revert the code to the last stable one and than deploy everything works perfectly. </p>\n\n<p>I would be very thankful to anybody who can point me to the right direction to fix this thing.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","database","heroku","pull"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":290,"score":6,"question_id":12580982,"title":"Unable to fetch tables information when running heroku db:pull","body":"<p>I have an application that uses postgres in development and production. I recently pushed to heroku and everything was working fine. I was able to pull the database from heroku and push back up with no problem. Today however, I tried to pull the DB down from heroku and I received this error</p>\n\n<pre><code>heroku db:pull\n\nLoaded Taps v0.3.24\n    Auto-detected local database: postgres://postgres:a@127.0.0.1/app_development?encoding=utf8\n    Warning: Data in the database 'postgres://postgres:a@127.0.0.1/app_development?encoding=utf8' will be overwritten and will not be recoverable.\n\n     !    WARNING: Destructive Action\n     !    This command will affect the app: app\n     !    To proceed, type \"app\" or re-run this command with --confirm app\n\n    &gt; app\nReceiving schema\nUnable to fetch tables information from http://heroku:osui59a24am79x@taps19.heroku.com. Please check the server log.\n</code></pre>\n\n<p>So I run <code>heroku logs</code> after:</p>\n\n<pre><code>james@james-Vostro-3550:~/Desktop/app$ heroku logs\n2012-09-25T10:08:32+00:00 app[web.1]: Started GET \"/users\" for X.X.X.X at 2012-09-25 10:08:32 +0000\n2012-09-25T10:08:32+00:00 heroku[router]: GET app.herokuapp.com/users? dyno=web.1 queue=0 wait=0ms service=38ms status=200 bytes=10727\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: Started GET \"/application.css\" for X.X.X.X at 2012-09-25 10:08:32 +0000\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] \"/application.css\"):\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n2012-09-25T10:08:32+00:00 heroku[router]: GET app.herokuapp.com/application.css dyno=web.1 queue=0 wait=0ms service=6ms status=404 bytes=728\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/static.rb:62:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `catch'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:53:in `process'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:86:in `start'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `&lt;top (required)&gt;'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'\n2012-09-25T10:08:32+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `&lt;main&gt;'\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 heroku[router]: GET app.herokuapp.com/assets/admin-e0756c8b3550bb800d5f58837c42ec80.css dyno=web.1 queue=0 wait=0ms service=7ms status=200 bytes=1941\n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: \n2012-09-25T10:08:32+00:00 app[web.1]: Started GET \"/assets/admin-e0756c8b3550bb800d5f58837c42ec80.css\" for X.X.X.X at 2012-09-25 10:08:32 +0000\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]: Started GET \"/projects\" for X.X.X.X at 2012-09-25 10:08:41 +0000\n2012-09-25T10:08:41+00:00 heroku[router]: GET app.herokuapp.com/projects dyno=web.1 queue=0 wait=0ms service=31ms status=304 bytes=0\n2012-09-25T10:08:41+00:00 app[web.1]: Started GET \"/application.css\" for X.X.X.X at 2012-09-25 10:08:41 +0000\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n2012-09-25T10:08\n:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] \"/application.css\"):\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:26:in `call_app'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/rack/logger.rb:16:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.6/lib/action_dispatch/middleware/static.rb:62:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:220:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/server.rb:159:in `start'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `catch'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.6/lib/rails/engine.rb:479:in `call'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:80:in `block in pre_process'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:53:in `process'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/backends/base.rb:63:in `start'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:78:in `pre_process'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/connection.rb:38:in `receive_data'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:151:in `run!'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/runner.rb:185:in `run_command'\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `&lt;main&gt;'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/lib/thin/controllers/controller.rb:86:in `start'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.4.1/bin/thin:6:in `&lt;top (required)&gt;'\n2012-09-25T10:08:41+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in `load'\n2012-09-25T10:08:41+00:00 app[web.1]: \n2012-09-25T10:08:41+00:00 heroku[router]: GET app.herokuapp.com/application.css dyno=web.1 queue=0 wait=0ms service=9ms status=404 bytes=728\n2012-09-25T10:11:00+00:00 heroku[run.1]: Awaiting client\n2012-09-25T10:11:00+00:00 heroku[run.1]: Starting process with command `bundle exec rake db:migrate`\n2012-09-25T10:11:00+00:00 heroku[run.1]: State changed from starting to up\n2012-09-25T10:11:06+00:00 heroku[run.1]: Client connection closed. Sending SIGHUP to all processes\n2012-09-25T10:11:07+00:00 heroku[run.1]: Process exited with status 1\n2012-09-25T10:11:07+00:00 heroku[run.1]: State changed from up to complete\n2012-09-25T10:08:23+00:00 heroku[web.1]: State changed from starting to up\n2012-09-25T10:08:01+00:00 heroku[web.1]: Unidling\n2012-09-25T10:08:01+00:00 heroku[web.1]: State changed from down to starting\n</code></pre>\n\n<p>I have no idea where to look for a solution, so hopefully someone can help. I've just started learning rails so please remember this when trying to help.</p>\n\n<p>Thanks in advance.</p>\n\n<p>EDIT:</p>\n\n<p>I have tried all sorts: \nreinstalling heroku, taps.\nremade my app and pushing to heroku.\nreinstalled postgres.</p>\n\n<p>Nothing seems to work. Driving me mad!</p>\n"},{"tags":["ruby","mechanize"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":802,"score":2,"question_id":10032494,"title":"mechanize how to get current url","body":"<p>I have this code</p>\n\n<pre><code>require 'mechanize'\n@agent = Mechanize.new\npage = @agent.get('http://something.com/?page=1')\nnext_page = page.link_with(:href=&gt;/^?page=2/).click\n</code></pre>\n\n<p>As you can see this code should go to the next page.</p>\n\n<p>The <code>next_page</code> should have url <code>http://something.com/?page=2</code></p>\n\n<p>How to get current url for <code>next_page</code>? </p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13234384,"title":"In Ruby, is there a way to 'override' a constant in a subclass so that inherited methods use the new constant instead of the old?","body":"<p>In Ruby, is there a way to 'override' a constant in a subclass in such a way that calling an inherited method from the subclass results in that method using the new constant instead of the old one? For example:</p>\n\n<pre><code>class SuperClass\n  CONST = \"Hello, world!\"\n  def self.say_hello\n    CONST\n  end\nend\n\nclass SubClass &lt; SuperClass\n  override_const :CONST, \"Hello, Bob!\"\nend\n\nSuperClass.say_hello # =&gt; \"Hello, world!\"\nSubClass.say_hello   # =&gt; \"Hello, Bob!\"\n</code></pre>\n\n<p>If not, is there perhaps a way to do something like this instead?</p>\n\n<pre><code>class SuperClass\n  CONST = \"Hello, world!\"\n  def self.say_hello\n    CONST\n  end\nend\n\nSubClass = SuperClass.clone\nSubClass.send(:remove_const, :CONST)\nSubClass.const_set(:CONST, \"Hello, Bob!\")\n\nSubClass.say_hello # =&gt; \"Hello, Bob!\"\n</code></pre>\n\n<hr>\n\n<p>Note: I tried my second example out in irb, and it seems to work except that class methods can't seem to access CONST after I clone the class:</p>\n\n<pre><code>irb(main):012:0&gt; SubClass.say_hello\nNameError: uninitialized constant Class::CONST\n        from (irb):4:in `say_hello'\n        from (irb):12\n        from C:/Ruby193/bin/irb:12:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby","functional-programming","currying"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13233875,"title":"Ruby Reverse Currying: Is this possible?","body":"<p>Concerning currying in Ruby 1.9.x, I've been using it in some places, and can be translated like basically supporting default parameters to the proc arguments:</p>\n\n<pre><code>p = proc {|x, y, z|x + y + z}\np.curry[1] #=&gt; returns a lambda\np.curry[1, 2] #=&gt; returns a lambda\np.curry[1, 2, 3] #=&gt; 6\np2 = p.curry[1, 2]\np2.(2) #=&gt; 5\np2.(4) #=&gt; 7\n</code></pre>\n\n<p>very handy, right? thing is, I would like to be able to curry in reverse, that means, fill the last argument of my proc with a random value. Like this:</p>\n\n<pre><code>p = proc{|x, y| x - y }.curry[1]\np.(4)\n</code></pre>\n\n<p>my desired result would be 3. this returns -3. </p>\n"},{"tags":["ruby","regex","ical","rfc2445"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":56,"score":3,"question_id":13095310,"title":"Regex parsing of iCalendar (Ruby regex)","body":"<p>I'm trying to parse iCalendar (RFC2445) input using a regex.</p>\n\n<p>Here's a [simplified] example of what the input looks like:</p>\n\n<pre><code>BEGIN:VEVENT\nabc:123\ndef:456\nEND:VEVENT\nBEGIN:VEVENT\nghi:789\nEND:VEVENT\n</code></pre>\n\n<p>I'd like to get an array of matches: the \"outer\" match is each VEVENT block and the inner matches are each of the field:value pairs.</p>\n\n<p>I've tried variants of this:</p>\n\n<pre><code>BEGIN:VEVENT\\n((?&lt;field&gt;(?&lt;name&gt;\\S+):\\s*(?&lt;value&gt;\\S+)\\n)+?)END:VEVENT\n</code></pre>\n\n<p>But given the input above, the result seems to have only ONE field for each matching VEVENT, despite the +? on the capture group:</p>\n\n<pre><code>**Match 1**\nfield   def:456\nname    def\nvalue   456\n\n**Match 2**\nfield   ghi:789\nname    ghi\nvalue   789\n</code></pre>\n\n<p>In the first match, I would have expected TWO fields: the abc:123 and the def:456 matches...</p>\n\n<p>I'm sure this is a newbie mistake (since I seem to perpetually be a newbie when it comes to regex's...) - but maybe you can point me in the right direction?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13231412,"title":"Error on install gem factory_girl and ruby version","body":"<p>I try to install <a href=\"http://www.skylinecms.nl/documentation/guides/getting_started\" rel=\"nofollow\">skylinecms</a> but I have a problem with installing the gem.<br>\nThe gem <a href=\"https://github.com/thoughtbot/factory_girl\" rel=\"nofollow\">factory_girl</a> asked me to use version> = 1.9.2  of Ruby</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ sudo gem install skylinecms\nERROR:  Error installing skylinecms:\n    factory_girl requires Ruby version &gt;= 1.9.2.\n</code></pre>\n\n<p>ruby -v</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\n</code></pre>\n\n<p>I have tried to change ruby version to 1.9.2</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ rvm use 1.9.2\nUsing /home/atmoner/.rvm/gems/ruby-1.9.2-p320\n</code></pre>\n\n<p>But still same problem</p>\n\n<pre><code>atmoner@atmoner:~/base_ror$ sudo gem install skylinecms\nERROR:  Error installing skylinecms:\n    factory_girl requires Ruby version &gt;= 1.9.2.\n</code></pre>\n\n<p>what's the source of this problem?<br>\nyou have an idea?</p>\n"},{"tags":["ruby-on-rails","ruby","regex","validation","url"],"answer_count":4,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":2655,"score":7,"question_id":7167895,"title":"What's a good way to validate links (urls) in rails 3?","body":"<p>I was wondering how I would best validate urls or links in rails 3. I was thinking of using a regular expression, but am not sure if this is the best practice.</p>\n\n<p>And, if I were to use a regex, could someone suggest one to me? I am still new to regex.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","rspec","hook"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13233661,"title":"Is it okay to have a method in the before block of a series of RSpec unit tests?","body":"<p>I have a pretty elaborate set-up to change the condition from passing to failing for four composing methods of a method called eligible?.</p>\n\n<pre><code>describe \"#participant_age_eligible?\" do\n        it \"returns whether participant is age-eligible\" do\n          @part.participant_age_eligible?(@pers).should == true\n        end\n\n        it \"returns false if participant is not age eligible\" do\n          q = @survey_section.questions.select { |q| q.data_export_identifier ==\n                                                 \"#{OperationalDataExtractor::PbsEligibilityScreener::\n                                                    INTERVIEW_PREFIX}.AGE_ELIG\" }.first\n          answer = q.answers.select { |a| a.response_class == \"answer\" &amp;&amp; a.reference_identifier == \"2\" }.first\n          Factory(:response, :survey_section_id =&gt; @survey_section.id, :question_id =&gt; q.id, :answer_id =&gt; answer.id, :response_set_id =&gt; @response_set.id)\n          @part.participant_age_eligible?(@pers).should == false\n        end\n      end\n\n      describe \"#participant_psu_county_eligible?\" do\n        it \"returns whether participant lives in eligible PSU\" do\n          @part.participant_psu_county_eligible?(@pers).should == true\n        end\n\n        it \"returns false if participant coes not live in an eligible PSU\" do\n          q = @survey_section.questions.select { |q| q.data_export_identifier ==\n                                                 \"#{OperationalDataExtractor::PbsEligibilityScreener::\n                                                    INTERVIEW_PREFIX}.PSU_ELIG_CONFIRM\" }.first\n          answer = q.answers.select { |a| a.response_class == \"answer\" &amp;&amp; a.reference_identifier == \"2\" }.first\n          Factory(:response, :survey_section_id =&gt; @survey_section.id, :question_id =&gt; q.id, :answer_id =&gt; answer.id, :response_set_id =&gt; @response_set.id)\n          @part.participant_psu_county_eligible?(@pers).should == false\n        end\n      end\n</code></pre>\n\n<p>There are two more methods just like those two. What I'd like to do is extract the</p>\n\n<pre><code> q = @survey_section.questions.select { |q| q.data_export_identifier ==\n                                                     \"#{OperationalDataExtractor::PbsEligibilityScreener::\n                                                        INTERVIEW_PREFIX}.AGE_ELIG\" }.first\n              answer = q.answers.select { |a| a.response_class == \"answer\" &amp;&amp; a.reference_identifier == \"2\" }.first\n              Factory(:response, :survey_section_id =&gt; @survey_section.id, :question_id =&gt; q.id, :answer_id =&gt; answer.id, :response_set_id =&gt; @response_set.id) \n</code></pre>\n\n<p>portion into a method in the before block and then pass the relevant parameters, but I hesitiate because I have never seen someone define a method in a before block, not even sure you can do it, further, I'm not sure if you even should do it even if you can, maybe it's pointing to a problem that I'm not seeing. So I though I'd ask the unfathomably enormous expertise of the SO community. Thanks.</p>\n"},{"tags":["ruby","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13232186,"title":"How to open new Rails window in sidebar","body":"<p>I am using Rails 3/Bootstrap/JQuery UI.\nI have a create action which requires the user to enter some parameters before submitting.\nI have tried a Javascript JQuery UI Dialog Modal Form, but that doesn't make use of the already-written action code.\nThe problem is that the user doesn't like having a completely new window open (and then having to hit Back)</p>\n\n<p>So I would like to open the action, but do so in a sidebar, rather than a new window.</p>\n\n<p>What is the best practice for this in Rails 3?</p>\n\n<p>Adding more clarification.\nThe \"action\" I meant is a modal dialog where I collect the parameters which are needed for the create.\nI would like to put that \"modal dialog\" into a sidebar.\nInstead, right now, I open the \"modal dialog\" as a completely new window, and then the user clicks Create, and the new object is created.</p>\n\n<p>I think my main question is - how do I open \"new window in a sidebar\"?</p>\n\n<p>Added edit:\nHere is the code for the button the user is going to push: (to add a Cat to an existing Client)</p>\n\n<pre><code>&lt;%= link_to \"New Cat\", new_client_cat_path(@client), :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>Now, here is cats/new.html.erb:</p>\n\n<pre><code>&lt;h2&gt;New Cat&lt;/h2&gt;\n&lt;%= render \"form\" %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>and then here is cats/_form.html.erb:</p>\n\n<pre><code>&lt;%= form_for [@client, @cat] do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n&lt;%= f.submit @submit_label, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I want is for \"new.html.erb\" - the form to get the user's OK - to pop up in a sidebar, as opposed to opening a brand new window. I want to be able to put the \"new.html.erb\" into a small box which is located on the main page.</p>\n"},{"tags":["ruby","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":10891275,"title":"Gem date_validator not working Ruby 1.9.3 Rails 3.2.1","body":"<p>I've just installed this gem with:</p>\n\n<pre><code>gem install 'date_validation'\n</code></pre>\n\n<p>And I can see it's properly installed, as it appears in the list when I use:</p>\n\n<pre><code>gem list\n</code></pre>\n\n<p>But when I try to validate the content of a field form as a date, I get this error:</p>\n\n<pre><code>ArgumentError in ProductesController#new\nUnknown validator: 'DateValidator'\n</code></pre>\n\n<p>I use this code to validate:</p>\n\n<pre><code>validates :data_caducitat, :date =&gt; { :after =&gt; Proc.new { Time.now } }\n</code></pre>\n\n<p>Any idea of what may be the problem?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby","block"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":58,"score":3,"question_id":12244709,"title":"Is there a way to avoid duplicated blocks in Ruby?","body":"<p>I have a block which I need to pass to <code>File.open</code> and another method <code>XXobject#read</code>. Since I passed the same block to those two methods, I would like to find a way to avoid duplicating the code of block. </p>\n\n<p>I tried to define a <code>Proc</code> object, but <code>File.open</code> seems not to accept a <code>Proc</code> object. I am wondering why. As far as I know, a block is stored as a <code>Proc</code> object.  </p>\n\n<p>Is there a way to avoid duplicated blocks in Ruby?</p>\n"},{"tags":["ruby-on-rails","ruby","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13232439,"title":"Validates Uniqueness getting called when field hasn't changed?","body":"<p>Does <code>validates :uniqueness</code> get called every time an object is saved even if a field has not changed? Isn't this a performance issue?</p>\n\n<pre><code>validates :name, :schedule_id, :uniqueness =&gt; true\n</code></pre>\n\n<p>It seems to be the case that it does. So isn't it almost always necessary to make sure a change has taken place before running the validation? As every field being checked for uniqueness requires a database hit.</p>\n\n<p>This would be better:</p>\n\n<pre><code>validates :name, :schedule_id, :uniqueness =&gt; true, :if =&gt; \"name_changed? || schedule_id_changed?\"\n</code></pre>\n\n<p>And this much better, if a bit more verbose:</p>\n\n<pre><code>validates :name, :uniqueness =&gt; true, :if =&gt; :name_changed?\nvalidates :schedule_id, :uniqueness =&gt; true, :if =&gt; schedule_id_changed?\n</code></pre>\n\n<p>Gist here: <a href=\"https://gist.github.com/4017019\" rel=\"nofollow\">https://gist.github.com/4017019</a></p>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13222622,"title":"Heroku launch application error Ruby on Rails","body":"<p>Trying to launch an app on Heroku, but it keeps getting an application error.  Here are the heroku logs, Please let me know what I can do to get it the application running.  We have implemented pusher and can get the website to work on local host (even the pusher features across different localhost machines) but other than that it does not work on heroku.</p>\n\n<pre><code>2012-11-04T19:57:31+00:00 app[web.1]: Connecting to database specified by DATABASE_URL\n2012-11-04T19:57:31+00:00 app[web.1]: /app/app/controllers/comments_controller.rb:2:in `&lt;class:CommentsController&gt;': undefined method `post' for CommentsController:Class (NoMethodError)\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/app/controllers/comments_controller.rb:1:in `&lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]: Exiting\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-04T19:57:31+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-04T19:57:31+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-04T19:57:31+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Booting WEBrick\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Rails 3.2.8 application starting in production on http://0.0.0.0:46992\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Call with -d to detach\n2012-11-04T19:57:32+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n2012-11-04T19:57:32+00:00 app[web.1]: Connecting to database specified by DATABASE_URL\n2012-11-04T19:57:32+00:00 app[web.1]: Exiting\n2012-11-04T19:57:32+00:00 app[web.1]: /app/app/controllers/comments_controller.rb:2:in `&lt;class:CommentsController&gt;': undefined method `post' for CommentsController:Class (NoMethodError)\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/app/controllers/comments_controller.rb:1:in `&lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-04T19:57:32+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-04T19:57:32+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-04T19:57:32+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n2012-11-04T19:57:33+00:00 heroku[web.1]: Process exited with status 1\n2012-11-04T19:57:33+00:00 heroku[web.1]: State changed from starting to crashed\n2012-11-04T19:57:33+00:00 heroku[web.1]: Process exited with status 1\n2012-11-04T20:07:27+00:00 heroku[web.1]: State changed from crashed to down\n2012-11-04T20:07:27+00:00 heroku[web.1]: State changed from down to starting\n2012-11-04T20:07:39+00:00 heroku[web.1]: State changed from starting to crashed\n2012-11-04T20:17:44+00:00 heroku[web.1]: State changed from crashed to down\n2012-11-04T20:17:44+00:00 heroku[web.1]: State changed from down to starting\n2012-11-04T20:17:56+00:00 heroku[web.1]: State changed from starting to crashed\n2012-11-04T20:22:51+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET followalong.herokuapp.com/ dyno= queue= wait= service= status=503 bytes=\n2012-11-04T20:22:52+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET followalong.herokuapp.com/favicon.ico dyno= queue= wait= service= status=503 bytes=\n</code></pre>\n"},{"tags":["ruby","datetime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13231647,"title":"How to check if the object was created within this month","body":"<p>I have a task to find out if an object is created within this month or not. I tried a lot to resolve this. I used <code>1.month</code>, <code>since(-1)</code>, etc. But still I am not on a right track to proceed with these solutions.</p>\n"},{"tags":["ruby-on-rails","ruby","delayed-job"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":100,"score":-1,"question_id":12005616,"title":"How do I run delayed job inserts in the backgroud without affecting page load - Rails ","body":"<p>I have an RoR application like posting answers to a question. If a user answers to a question, notification messages are sent to all the users, who watch-listed the question, who tracks the question and to the owner of the question. I am using delayed jobs for creating the notification messages. so, While creating answer, there are many inserts into delayed job table going on,which is slowing down the page load. It takes more time to redirect to the question show page after the answer is created. </p>\n\n<p>Currently I am inserting into answers table using AJAX request. Is there any way to insert into delayed jobs table in background after the AJAX request completes? </p>\n"},{"tags":["ruby","sinatra","less","sinatra-assetpack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13215922,"title":"Sinatra-assetpack not compiling Less files in Classic type Sinatra app","body":"<p>I cannot figure out how to do this. All my main .less files are in <code>/app/css/less</code>, with @import'ed files in <code>/app/css/less/bootstrap</code>. My main stylesheet is <code>/app/css/less/style.less</code> which should be compiled to '/public/css/style.css'.</p>\n\n<p>Using a classic Sinatra app structure (not base), I have the following in various files (unrelated code left out):\n<em>*</em>*Gemfile</p>\n\n<pre><code># encoding: utf-8\nsource :rubygems\n\ngem 'sinatra'\ngem 'thin'\ngem 'less'\ngem 'therubyracer'\ngem 'haml', '~&gt; 3.2.0.rc.1'\ngem 'sinatra-partial'\ngem 'sinatra-assetpack', :git =&gt; 'git://github.com/rupe/sinatra-assetpack.git', :require =&gt; 'sinatra/assetpack'\n</code></pre>\n\n<p><em>*</em>*myapp.rb</p>\n\n<pre><code># encoding: utf-8\n\nrequire 'rubygems'\nrequire 'bundler/setup'\n\nrequire 'sinatra'\nrequire 'haml'\nrequire 'sinatra/partial'\nrequire 'sinatra/assetpack'\nrequire 'less'\n\nassets do\n  Less.paths .lt.lt \"#{settings.root}/app/css/less\"\n  Less.paths .lt.lt \"#{settings.root}/app/css/less/bootstrap\"\n  serve '/css', from: '/app/css/less'\n  css :style, [\n    '/css/style.css'\n  ]\n  prebuild true\nend\n</code></pre>\n\n<p><em>*</em>*layout.haml</p>\n\n<pre><code>!= css :style, :media =&gt; 'screen'\n</code></pre>\n\n<p>Which produces this stylesheet related tag in the served up html:</p>\n\n<pre><code>link rel=\"stylesheet\" href=\"/css/style.496718.css\" media=\"screen\"\n</code></pre>\n\n<p>but does not actually compile the file <code>style.49718.css</code>. In fact, it doesn't compile any files at all.</p>\n\n<p>note: The git branch, referred to in Gemfile, is a copy of the 'pbaker' branch that fixed Less support (supposedly). I have tried the standard gem, and other versions, all without any luck.</p>\n\n<p>What could be the possible cause(s)?</p>\n"},{"tags":["ruby","loops","nested-loops"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1897,"score":3,"question_id":5286861,"title":"How to break from nested loops in Ruby?","body":"<p>assume the following ruby code:</p>\n\n<pre><code>bank.branches do |branch|\n  branch.employees.each do |employee|\n    NEXT BRANCH if employee.name = \"John Doe\"\n  end\nend\n</code></pre>\n\n<p>NEXT BRANCH is of course pseudocode.  is there a way that i can break out of a parent loop, the way one can do so in Perl, for example (by employing loop labels)?</p>\n\n<p>thanks in advance.</p>\n"},{"tags":["ruby","switch-statement"],"answer_count":5,"favorite_count":44,"up_vote_count":317,"down_vote_count":6,"view_count":54441,"score":311,"question_id":948135,"title":"How to write a switch statement in Ruby?","body":"<p>How do you write a switch statement in Ruby?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":3093,"score":2,"question_id":3243088,"title":"Installing RVM (Ruby Version Manager)","body":"<p>Can someone please translate this into manageable steps I need to take:</p>\n\n<pre><code>~ Wayne\n</code></pre>\n\n<p>You must now finish the install manually:\n1) Place the folowing line at the end of your shell's loading files(.bashrc or .bash_profile for bash and .zshrc for zsh), after all path/variable settings:\n     [[ -s $HOME/.rvm/scripts/rvm ]] &amp;&amp; source $HOME/.rvm/scripts/rvm\n   Please note that this must only occur once - so, you only need to add it the first time you install rvm.\n2) Ensure that there is no 'return' from inside the .bashrc file. (otherwise rvm will be prevented from working properly).\n   This means that if you see '[ -z  ] &amp;&amp; return' then you must change this line to:\n   if [[ ! -z  ]] ; then\n     ... original content that was below the &amp;&amp; return line ...\n   fi # &lt;= be sure to close the if.\n   #EOF .bashrc\n   Be absolutely <em>sure</em> to REMOVE the '&amp;&amp; return'.\n   If you wish to DRY up your config you can 'source ~/.bashrc' at the bottom of your .bash_profile.\n   placing all non-interactive items in the .bashrc, including the 'source' line above\n3) Then CLOSE THIS SHELL and open a new one in order to use rvm.\n[ -z \"$PS1\" ] &amp;&amp; return</p>\n\n<p>WARNING:  you have a 'return' statement in your .bashrc, likely this will cause untold havoc.\n   This means that if you see '[ -z $PS1 ] &amp;&amp; return' then you must change this line to:\n   if [[ -n $PS1 ]] ; then\n     ... original content that was below the &amp;&amp; return line ...\n   fi # &lt;= be sure to close the if.\n   #EOF .bashrc\nEven if you use zsh you should still adjust the .bashrc as above.\nIf you have any questions about this please visit #rvm on irc.freenode.net.</p>\n\n<p>Installation of RVM to /home/kapplej/.rvm/ is complete.</p>\n\n<p>I'm a complete newbie, so I am not even sure which one is shell's loading file, and how do I edit it? </p>\n"},{"tags":["ruby","ruby-on-rails-3","datetime","form-validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13223142,"title":"rails date_select title as a value","body":"<p>I am using date_select like so</p>\n\n<pre><code>&lt;%= f.label :birthday %&gt;\n&lt;%= f.date_select :birthday , :order =&gt; [:month, :day, :year] ,:start_year =&gt; 1900, :end_year =&gt; Time.now.year-10 %&gt;\n</code></pre>\n\n<p>I want to have the very first options in each field to be \"day\" \"month\" and \"year\" and which won't be valid</p>\n\n<p>How do I add these values?</p>\n"},{"tags":["ruby-on-rails","ruby","device","cancan","twitter-bootstrap-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13228938,"title":"Rails Tutorial for Devise with CanCan and Twitter Bootstrap","body":"<p>Can't run this open source project <a href=\"http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html.I\" rel=\"nofollow\">http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html.I</a>'m using Ruby version1.9.3p286 and Rails 3.2.8. \nI've installed all gems successfully, but when trying to run from RubyMine output \nthe following:</p>\n\n<pre><code>/Users/st/.rvm/rubies/ruby-1.9.3-p286/bin/ruby -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) /Users/st/projects/rails3-bootstrap-devise-cancan/script/rails server -b 0.0.0.0 -p 3000 -e development\n/Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/spec_set.rb:90:in `block in materialize': Could not find diff-lcs-1.1.3 in any of the sources (Bundler::GemNotFound)\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/spec_set.rb:83:in `map!'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/spec_set.rb:83:in `materialize'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/definition.rb:113:in `specs'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/definition.rb:158:in `specs_for'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/definition.rb:147:in `requested_specs'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/environment.rb:23:in `requested_specs'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/runtime.rb:11:in `setup'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler.rb:116:in `setup'\n    from /Users/st/.rvm/gems/ruby-1.9.3-p286@global/gems/bundler-1.2.1/lib/bundler/setup.rb:17:in `&lt;top (required)&gt;'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n    from /Users/st/projects/rails3-bootstrap-devise-cancan/config/boot.rb:6:in `&lt;top (required)&gt;'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/st/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/st/projects/rails3-bootstrap-devise-cancan/script/rails:5:in `&lt;top (required)&gt;'\n    from -e:1:in `load'\n    from -e:1:in `&lt;main&gt;'\nProcess finished with exit code 1\n</code></pre>\n\n<p>My gemfile:</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'rails', '3.2.8'\ngem 'sqlite3'\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\ngem 'jquery-rails'\ngem \"rspec-rails\", \"&gt;= 2.11.0\", :group =&gt; [:development, :test]\ngem \"email_spec\", \"&gt;= 1.2.1\", :group =&gt; :test\ngem \"cucumber-rails\", \"&gt;= 1.3.0\", :group =&gt; :test, :require =&gt; false\ngem \"database_cleaner\", \"&gt;= 0.8.0\", :group =&gt; :test\ngem \"launchy\", \"&gt;= 2.1.2\", :group =&gt; :test\ngem \"capybara\", \"&gt;= 1.1.2\", :group =&gt; :test\ngem \"factory_girl_rails\", \"&gt;= 4.1.0\", :group =&gt; [:development, :test]\ngem \"bootstrap-sass\", \"&gt;= 2.1.0.0\"\ngem \"devise\", \"&gt;= 2.1.2\"\ngem \"cancan\", \"&gt;= 1.6.8\"\ngem \"rolify\", \"&gt;= 3.2.0\"\ngem \"simple_form\", \"&gt;= 2.0.3\"\ngem \"quiet_assets\", \"&gt;= 1.0.1\", :group =&gt; :development\n</code></pre>\n"},{"tags":["ruby","multithreading","applescript","daemon","daemons"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13045780,"title":"Abort trap from AppleScript run from a Ruby script","body":"<p>I have a Ruby program that, amongst other things, executes user-defined blocks of code (the code is on Github, <a href=\"http://github.com/joonty/chain-reactor\" rel=\"nofollow\">here</a>). Many of these blocks contain system commands, and I'm trying to debug a very specific case of executing a piece of AppleScript within a bash script that I'm calling. The script in question is for controlling Spotify by the command line, and <a href=\"http://harishnarayanan.org/projects/shpotify/\" rel=\"nofollow\">this is the code</a>.</p>\n\n<p>The problem I'm getting is that an abort trap error is occurring every time the script is run:</p>\n\n<pre><code>spotify: line 57: 94108 Abort trap    osascript -e 'tell application \"Spotify\" to pause'\n</code></pre>\n\n<p>This must be related to the environment of the Ruby script where the call is made, but I'm having trouble seeing why. Here's the block of code calling it:</p>\n\n<pre><code># Ruby code\nreaction :hello do |event|\n  system \"spotify pause\"\n  system \"say 'Hello world'\"\n  system \"spotify play\"\nend\n</code></pre>\n\n<p>This block is run periodically via a <code>yield</code> statement, when a particular event is triggered through a socket connection. The script is also daemonized, using the ruby gem \"daemons\", to allow it to run in the background (but still as the current user, according to <code>ps</code> and the ruby environment variable). Not only this, but each socket connection starts a new thread, so the code is run in a separate thread from the main one.</p>\n\n<p>In my debugging I've tried running the line <code>system \"spotify pause\"</code> after the daemon starts up the script, without a problem. It also runs fine in the following script:</p>\n\n<pre><code>Thread.new do\n  system(\"spotify pause\")\nend\n</code></pre>\n\n<p>So it isn't starting a new thread or daemonizing in itself that causes the problem, but it seems to be a combination of these things and maybe the fact that the block is being yielded  that means that an abort trap is being raised by the AppleScript in the bash script.</p>\n\n<p>If you can drag yourself up the many, many layers of complication back into reality, I would appreciate any suggestions you have for solving or even debugging this weird case!</p>\n"},{"tags":["ruby-on-rails","ruby","erb","friendly-id"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13229354,"title":"Rails and Friendly ID gem path helper issue","body":"<p>I've posted this as an issue on the <a href=\"https://github.com/norman/friendly_id/issues/333\" rel=\"nofollow\">Github page for Friendly ID</a>, but haven't yet had any response. I'm completely blocked on it, so it would be great if someone has some insight!</p>\n\n<p>I have a Recipe model, and have added the lines as per the README (using Friendly ID v4):</p>\n\n<pre><code>class Recipe &lt; ActiveRecord::Base\n  extend FriendlyId\n  friendly_id :name, use: :slugged\n  #...\n</code></pre>\n\n<p>And have added the migration. All the records were updated successfully, and now have a slug. Not only that, but going to <code>/recipes/&lt;this-is-a-slug&gt;</code> works.</p>\n\n<p>However, I assumed (quite possibly incorrectly) that the path helper would then use the model's slug attribute rather than ID, so that all links to the recipes would go to <code>/recipes/&lt;slug&gt;</code> rather than <code>/recipes/&lt;id&gt;</code>. This isn't the case - they still all link to the ID.</p>\n\n<p>Not only that but I've searched in vain all over the Internets to try and find someone else with the same problem. I've tried all of the following paths in my view file:</p>\n\n<pre><code>&lt;%= link_to 'view recipe', recipe  # -&gt; links to /recipes/&lt;id&gt; %&gt;\n&lt;%= link_to 'view recipe', recipe_path(recipe) # -&gt; links to /recipes/id %&gt; \n&lt;%= link_to 'view recipe', recipe_path(recipe.slug) # -&gt; gives a routing error, \"No route matches {:action=&gt;\"show\", :controller=&gt;\"recipes\", :id=&gt;nil}\" %&gt; \n</code></pre>\n\n<p>Could anyone point me in the right direction? Thanks a lot!</p>\n"},{"tags":["ruby-on-rails","ruby","aptana"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13228996,"title":"Error dealing in aptana rad rails and ruby on rails","body":"<p>In aptana rad rails, I am getting an error <strong>after updating my mozilla firefox</strong> .... the error was <strong>\"An internal error has occurred. No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set]\"</strong> and also <strong>\"An SWT error has occurred. You are recommended to exit the workbench. Subsequent errors may happen and may terminate the workbench without warning.See the .log files for more details.\".</strong>........like this.</p>\n\n<p>So, Anyone Kindly help me to sort out this problem. \nThank You...</p>\n"},{"tags":["ruby-on-rails","ruby","achievements"],"answer_count":4,"favorite_count":11,"up_vote_count":7,"down_vote_count":1,"view_count":530,"score":6,"question_id":9608069,"title":"Modern tools for Ruby/Rails for building an achievement system","body":"<p>I am interested in building a robust achievement system for my Ruby on Rails application. </p>\n\n<p>The achievements can happen in a myriad of ways. Normally, we'd have some criteria that can happen to several models, some required, some optional (mix and match) that triggers an achievement. </p>\n\n<p>I would say this is similar to the achievement system on here or Foursquare badges. Ideally if there is a modern tool out there that can help abstract a lot of the work in some DSL, that would be fantastic. </p>\n\n<p>I'm interested in seeing how others solved this issue using Ruby or Ruby on Rails. Building this from scratch sounds unreasonable as I'm sure it's been solved many times repeatedly. </p>\n"},{"tags":["ruby","static","rack"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13206289,"title":"How to setup URLs for static site with Ruby Rack on Heroku","body":"<p>My site is <a href=\"http://designintellection.com/\" rel=\"nofollow\">here</a>.</p>\n\n<p>It used to be a Django-powered blog. However I no longer update it so I just wanted to make it a static HTML site. I wget'ed it and moved it to Heroku with Ruby Rack.</p>\n\n<p>However every URL resolves to the home page. This is because of my config.ru file:</p>\n\n<pre><code>use Rack::Static, \n  :urls =&gt; [\"/media/images\", \"/media/js\", \"/media/css\"],\n  :root =&gt; \"public\"\n\nrun lambda { |env|\n  [\n    200, \n    {\n      'Content-Type'  =&gt; 'text/html', \n      'Cache-Control' =&gt; 'public, max-age=86400' \n    },\n    File.open('public/index.html', File::RDONLY)\n  ]\n}\n</code></pre>\n\n<p><strong>Question:</strong> Is there a way to map multiple URLs? e.g. <code>foo.com/about</code> maps to <code>public/about/index.html</code>, <code>foo.com/posts/2012/oct/21/blog-post</code>maps to <code>public/posts/2012/oct/21/blog-post/index.html</code></p>\n\n<p>At this point I'd even be fine typing each one by hand.</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["ruby","syntax","programming-languages","timtowtdi"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":210,"score":0,"question_id":6401361,"title":"\"In Ruby there's more than one way of doing the same thing\" - what does this mean?","body":"<p>Feel free to delete this topic if it's discussed or quite obvious. I hail from C# background and I'm planning to learn Ruby. Everything I read about it seems quite intriguing. But I'm confused over this basic philosophy of Ruby that \"there's more than one way to do one thing\". Can someone provide 2 or 3 simple arithmetic or string examples to make this point clear, like if its about the syntaxes or logics etc.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","sinatra","passenger","rack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13228378,"title":"getting rack mapped directory inside app","body":"<p>Say I have a config.ru like:</p>\n\n<pre><code>map '/foo' do\n  run MyApp\nend\n</code></pre>\n\n<p>and a Sinatra app like:</p>\n\n<pre><code>class MyApp &lt; Sinatra::Base\n  use Rack::Session::File, key: 'rack.session', domain: 'my.domain.com', path: '/foo', expire_after: 86400 * 14, secret: 'mysecret'\nend\n</code></pre>\n\n<p>How can I make MyApp agnostic to which request directory (<code>/foo</code> in this case) is used to access it? I have found that <code>request.script_name</code> contains this directory, but I cannot use it for the <code>path:</code> parameter of the <code>use Rack::Session::File</code> statement since it is not defined yet when starting the app from passenger, but only when requests are sent to the application later.</p>\n"},{"tags":["ruby","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13226786,"title":"How to reference a class in a gem?","body":"<p>Really novice question ...</p>\n\n<p>The many apps in my project have a lot of shared code in a gem. I'm trying to add a routine in that gem that will be shared by rake tasks in several apps.</p>\n\n<p>So in the gem lib/utilities directory I have cleanup.rb:</p>\n\n<pre><code>module Utilities\n  class Cleanup\n\n    def self.perform\n      puts \"Performing cleanup\"\n    end\n\n  end\nend\n</code></pre>\n\n<p>Then in the app, in lib/tasks, I have cleanup.rake:</p>\n\n<pre><code>require \"utilities/cleanup\"\n\nnamespace :mynamespace do\n  task :do_cleanup =&gt; :environment do\n    Utilities::Cleanup.perform\n  end\nend\n</code></pre>\n\n<p>All I get from rake mynamespace:do_cleanup is \"uninitialized constant Utilities::Cleanup\".</p>\n\n<p>I've tried several variations of the above. My gems are managed with bundler, but \"bundle exec rake ...\" gives the same result. I tried using <code>gem \"utilities/cleanup\"</code> instead of require.</p>\n\n<p>(I swear, I tear my hair out trying to figure out how to communicate between modules and classes more than anything else in this language! It's always \"which code am I referencing here?\" and \"why can't it find that class I wrote?\")</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","whenever"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13227855,"title":"Using whenever gem to schedule a cron job","body":"<p>I'm testing whenever to figure out how to use it and am running into trouble even after reading the Github documentation.</p>\n\n<p>I simply want to update the attributes of my model like this (config/schedule.rb)</p>\n\n<p>set :output \"/log/today.log\"</p>\n\n<pre><code>every 10.seconds do\n  runner \"Example.update_all(sample: Time.now)\"\nend\n</code></pre>\n\n<p>I am neither seeing a log file nor seeing the model attributes updated.</p>\n\n<p>Is there anything I am not doing correctly?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13227611,"title":"Rails not showing error on form submit","body":"<p>I am working in rails 2, I have a form containing data of two models, In one model I am validating fields and entering error using <code>self.errors.add_to_base</code> , but this is not displaying error on form and submitting that request successfully.</p>\n\n<p>This is my Model validation\\</p>\n\n<pre><code>validate :checkPunchingEntries\n\n  def checkPunchingEntries\n    if self.punch_in_time.blank? &amp;&amp; self.punch_out_time.blank?\n      self.errors.add_to_base(\"Both 'Punch in' and 'Punch out' time can not be blank\")\n    end\n  end\n</code></pre>\n\n<p>This is my Form</p>\n\n<pre><code>&lt;% form_tag '/punching_requests/create', :method =&gt; :post, :class=&gt;\"punching_request_form\" do %&gt;\n    &lt;% @punching_request.errors.full_messages.each do |msg| %&gt;\n        &lt;p class=\"error\"&gt;&lt;%=msg%&gt;&lt;/p&gt;\n    &lt;% end %&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;Date &lt;/label&gt;\n      &lt;%= text_field_tag 'date'%&gt;  &lt;%= calendar_for(\"date\") %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;&amp;nbsp;&lt;/label&gt;\n      &lt;input type=\"checkbox\" onclick=\"punch_in_toggle()\"&gt;Punch In&lt;/input&gt;\n      &lt;input type=\"checkbox\" onclick=\"punch_out_toggle()\"&gt;Punch Out&lt;/input&gt;\n    &lt;/p&gt;\n\n    &lt;div id=\"punch_in\"&gt;\n      &lt;p&gt;\n        &lt;label&gt;Punch In Time &lt;/label&gt;\n        &lt;%= text_field_tag 'punch_in_time'%&gt;\n      &lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;div id=\"punch_out\"&gt;\n      &lt;p&gt;\n        &lt;label&gt;Punch Out Time &lt;/label&gt;\n        &lt;%= text_field_tag 'punch_out_time'%&gt;\n      &lt;/p&gt;\n    &lt;/div&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;Assign To&lt;/label&gt;\n      &lt;%= select_tag(:approved_by,  options_from_collection_for_select(@human_resource_persons, \"id\", \"login\")) %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;label&gt;Reason &lt;/label&gt;\n      &lt;%=text_area_tag 'reason'%&gt;\n    &lt;/p&gt;\n\n    &lt;p class=\"actions\"&gt;&lt;label&gt;&lt;/label&gt;&lt;%= submit_tag 'Save' %&gt;&lt;/p&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>It comes into validation, but error is not shown on validation fails.</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":71,"score":0,"question_id":12718982,"title":"Get all file names in a directory with ruby","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/1755665/get-names-of-all-files-from-a-folder-with-ruby\">Get names of all files from a folder with Ruby</a>  </p>\n</blockquote>\n\n\n\n<p>I'm new to <code>Ruby</code> and I'm trying to get all the file names from a specific directory. There is only one level, and just need to get the entire list of names. How do I do that? I've looked at some of the other posts on the subject, but none helped. </p>\n"},{"tags":["ruby","regex","syntax"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12696496,"title":"How to specify Regexp options using Regexp.union","body":"<p>In <a href=\"http://stackoverflow.com/questions/1243120/how-do-i-removing-urls-from-text\">this answer on SO</a> the following code is suggested:</p>\n\n<pre><code>require 'uri'\n#...\nschemes_regex = /^(?:#{ URI.scheme_list.keys.join('|') })/i\n#...\n</code></pre>\n\n<p>I tried to improve this to:</p>\n\n<pre><code>schemes_regex = Regexp.union(URI.scheme_list.keys)\n</code></pre>\n\n<p>but I can't figure out how the IGNORECASE option (i) should be specified.</p>\n"},{"tags":["ruby","multithreading","thread-safety"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":56,"score":4,"question_id":13225221,"title":"Ruby Pause thread","body":"<p>In ruby, is it possible to cause a thread to pause from a different concurrently running thread.</p>\n\n<p>Below is the code that I've written so far.  I want the user to be able to type 'pause thread' and the sample500 thread to pause.</p>\n\n<pre><code>#!/usr/bin/env ruby\n\n# Creates a new thread executes the block every intervalSec for durationSec.\ndef DoEvery(thread, intervalSec, durationSec)\n    thread = Thread.new do\n        start = Time.now\n\n        timeTakenToComplete = 0\n        loopCounter = 0\n        while(timeTakenToComplete &lt; durationSec &amp;&amp; loopCounter += 1)\n\n            yield\n\n            finish = Time.now\n\n            timeTakenToComplete = finish - start\n\n            sleep(intervalSec*loopCounter - timeTakenToComplete)    \n        end\n    end\nend\n\n# User input loop.\nexit = nil\nwhile(!exit)\n    userInput = gets\n    case userInput\n    when \"start thread\\n\"\n        sample500 = Thread\n        beginTime = Time.now\n        DoEvery(sample500, 0.5, 30) {File.open('abc', 'a') {|file| file.write(\"a\\n\")}}\n    when \"pause thread\\n\"\n        sample500.stop\n    when \"resume thread\"\n        sample500.run\n    when \"exit\\n\"\n        exit = TRUE\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","json"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12696290,"title":"how to group a json from a sql result","body":"<p>I have a JSON that's returned from my rails API like this\n<code>[{\"tipo\":\"1\",\"dia\":\"02/10/2012\",\"empresa_id\":\"17\",\"horas\":\"0:15\",\"tempo\":\"900\"},\n{\"tipo\":\"2\",\"dia\":\"02/10/2012\",\"empresa_id\":\"17\",\"horas\":\"0:12\",\"tempo\":\"720\"}]</code></p>\n\n<p>but I need it to be something like this</p>\n\n<p><code>`[empresa_id: 17, [{\"tipo\":\"1\",\"dia\":\"02/10/2012\",\"horas\":\"0:15\",\"tempo\":\"900\"},\n{\"tipo\":\"2\",\"dia\":\"02/10/2012\",\"horas\":\"0:12\",\"tempo\":\"720\"}]]</code></p>\n\n<p>I need to group the results within <code>empresa_id</code>...how do I do that?  </p>\n"},{"tags":["ruby","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12677462,"title":"Specialized ruby regular expression","body":"<p>I have a ruby script that has a reg ex, in order to exclude the text that is between []. For example the following:</p>\n\n<p><code>[29-5-10 : 10.05 | key=3.6]</code></p>\n\n<p>If in the file the preceding expression exists only once my reg ex works just fine. I need a reg ex that solves the following problem:</p>\n\n<p><code>[29-5-10 : 10.05 | key=3.6]</code></p>\n\n<p><code>[29-5-10 : 10.05 | key=3.6]</code></p>\n\n<p>... bla ..bla</p>\n\n<p><code>[29-5-10 : 10.05 | key=3.6]</code></p>\n\n<p>My reg ex now is <code>/\\[(.*)\\]/</code></p>\n"},{"tags":["ruby","syntax","return"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":73,"score":2,"question_id":12676397,"title":"Ruby return syntax","body":"<p>The code below returns <code>true</code> if <code>@var</code> is non-<code>nil</code>.</p>\n\n<pre><code>class MyClass\n    def a_simple_method\n        not @var.nil?\n    end\nend\n</code></pre>\n\n<p>When I use the keyword <code>return</code> like this:</p>\n\n<pre><code>class MyClass\n    def a_simple_method\n        return not @var.nil?\n    end\nend\n</code></pre>\n\n<p>it returns a syntax error:</p>\n\n<pre><code>syntax error, unexpected tIVAR, expecting '('\n        return not @var.nil?\n                       ^\n</code></pre>\n\n<p>What did I understand wrong about <code>return</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13114901,"title":"test popups with cucumber/capybara in Ruby on Rails","body":"<p>I am writing tests to test that both affirming and dismissing a conformation popup work. However, I get the error:</p>\n\n<pre><code>And I dismiss popup                                     # features/step_definitions/web_steps.rb:74\n  undefined method `switch_to' for #&lt;Capybara::RackTest::Browser:0xa6f0dec&gt; (NoMethodError)\n  ./features/step_definitions/web_steps.rb:75:in `/^I confirm popup$/'\n  features/add_session.feature:121:in `And I confirm popup'\n</code></pre>\n\n<p>when running my tests.</p>\n\n<p>The steps in my .features files look something like this:</p>\n\n<pre><code>And I press \"Delete\"\nAnd I confirm popup\n</code></pre>\n\n<p>Within web_steps.rb, I have the following defined:</p>\n\n<pre><code>When /^I confirm popup$/ do\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('OK')\n  page.driver.browser.switch_to.alert.accept\n  #popup.confirm \nend\n\nWhen /^I dismiss popup$/ do\n  page.driver.browser.switch_to.alert.dismiss\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('Cancel')\n  #popup.dismiss\nend\n</code></pre>\n\n<p>I am using the prickle gem which I have included as follows in my Gemfile:</p>\n\n<pre><code>group :test do\n  gem 'cucumber-rails'\n  gem 'prickle'\nend\n</code></pre>\n\n<p>And I added a couple lines to my Gemfile as outlined <a href=\"https://github.com/ExtractMethod/prickle#configuration\" rel=\"nofollow\">here</a> to include prickle. I initially had it as World do, like they show on the github page, but that was giving me errors since World was being used twice (the other time in the cucumber library). Here are the lines I added to my env.rb file:</p>\n\n<pre><code>require 'prickle/capybara'    # require\n\nmodule Prickle_helper\n  include Capybara::DSL\n  include Prickle::Capybara  # include  Prickle\nend\n\nWorld(Prickle_helper)\n</code></pre>\n\n<p>Any ideas as to what could be causing my errors? Thanks!</p>\n"},{"tags":["ruby","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13227121,"title":"JSON::ParserError (399: unexpected token at","body":"<p>when I'm going to parse this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Product=[{\"Productname\":\"Acer 18.5\" LED Monitor}]\n</code></pre>\n\n<p>with Ruby JSOn, its showing me the error <code>JSON::ParserError (399: unexpected token at</code>. I know this is for 18.5\" in the string. How can I parse this string?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":42,"score":-2,"question_id":13008140,"title":"How to select adjacent array value if adjacent is empty with ruby","body":"<p>I'm trying to figure out how to select an array value if it is adjacent to a filled array value and is empty.</p>\n\n<p>So let's say the grid the array references is laid out like so.</p>\n\n<pre><code> a1,a2,a3,\n b1,b2,b3,\n c1,c2,c3\n</code></pre>\n\n<p>If a1 holds an X the grid will now look like so.</p>\n\n<pre><code> X,a2,a3,\n b1,b2,b3,\n c1,c2,c3\n</code></pre>\n\n<p>I want the method to be able to find the adjacent array values, in this case, a2, b1 and b2.</p>\n\n<p>But in this next case where O holds the center value.</p>\n\n<pre><code> X,a2,a3,\n b1,O,b3,\n c1,c2,c3  \n</code></pre>\n\n<p>...the method would select a2, b1 </p>\n\n<p>Can anyone provide a solution or a tip?</p>\n\n<p>This is a simple tic-tac-toe grid</p>\n\n<p>Here is a look at the class where the grid lives.</p>\n\n<pre><code>class Board\nattr_reader :grid\n\ndef initialize(cell_value = \" \")\n  @grid = {\n    a1: cell_value, a2: cell_value, a3: cell_value,\n    b1: cell_value, b2: cell_value, b3: cell_value,\n    c1: cell_value, c2: cell_value, c3: cell_value\n  }\nend\n\ndef printgrid\n  board = \"\\n\"\n  board &lt;&lt; \"a #{@grid[:a1]}|#{@grid[:a2]}|#{@grid[:a3]} \\n\"\n  board &lt;&lt; \"----------\\n\"\n  board &lt;&lt; \"b #{@grid[:b1]}|#{@grid[:b2]}|#{@grid[:b3]} \\n\"\n  board &lt;&lt; \"----------\\n\"\n  board &lt;&lt; \"c #{@grid[:c1]}|#{@grid[:c2]}|#{@grid[:c3]} \\n\"\n  board &lt;&lt; \"----------\\n\"\n  board &lt;&lt; \"  1 2 3\\n\"\nend\n\ndef space_taken?(cell_location)\n  cell_value = cell_location\n  @grid[cell_value] != \" \"\nend\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","model","has-one"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13225002,"title":"Accessing a has_one associations' attributes","body":"<p>I'm still quite new to Rails so hopefully this isn't a silly question.</p>\n\n<p>I have two models: User and Chore. User has_one chore, and Chore belongs to User</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :chore_done, :email, :name, :phone\n  has_one :chore\n\nclass Chore &lt; ActiveRecord::Base\n  attr_accessible :name, :user_id\n  belongs_to :user\n</code></pre>\n\n<p>In my user index, I'm trying to show all users and display the chore that is associated with him or her. I'm doing this by passing User.all to the view and using a .each to iterate through each user:</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= user.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.chore.name %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= user.chore_done? %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Edit', edit_user_path(user) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Unfortunately, I cannot access the name attribute of the Chore. I get this error:</p>\n\n<blockquote>\n  <p>undefined method `name' for nil:NilClass</p>\n</blockquote>\n\n<p>If I remove the .name attribute, it just returns a pointer to the Chore object.</p>\n\n<p>I have a feeling this has something to do with passing the User.all object to the view and then iterating over that. Just accessing a specific User object (e.g. User.find(1)) in the console, and then accessing user.chore.name works fine.</p>\n\n<pre><code>1.9.3-p194 :045 &gt; user = User.find(4)\n  User Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 4]]\n =&gt; #&lt;User id: 4, name: \"Example User\", email: \"example@dot.com\", phone: 8675309, chore_done: false, created_at: \"2012-11-05 01:53:33\", updated_at: \"2012-11-05 01:53:33\"&gt; \n1.9.3-p194 :046 &gt; user.chore.name\n  Chore Load (0.3ms)  SELECT \"chores\".* FROM \"chores\" WHERE \"chores\".\"user_id\" = 4 LIMIT 1\n =&gt; \"Living room\" \n</code></pre>\n\n<p>I read a bit about AssociationProxy in the APIDock, but I don't think I understand it completely nor do I know how to work with it. From what I gathered, accessing all objects in a model returns an Array of objects but doesn't return a complete set of attributes for its dependencies? So, in this case, I get a pointer to the Chore object but no access to any of its attributes.</p>\n\n<p>I could certainly just add Chore as another column in my user table, but I may add to that model in the future + I just want to figure out how the has_one association works anyway. </p>\n\n<p>Any help is appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12969435,"title":"Ruby delete_if multiple values - only first value being deleted","body":"<pre><code>words.delete_if do |x|\n  x == (\"a\"||\"for\"||\"to\"||\"and\")\nend\n</code></pre>\n\n<p><code>words</code> is an array with many words. My code is deleting \"a\" but not deleting \"for\", \"to\" or \"and\".</p>\n"},{"tags":["ruby","nil","openstruct"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":33,"score":4,"question_id":13221163,"title":"OpenStruct.new stores attribute but doesn't retrieve it","body":"<p>After creating a new Ruby OpenStruct object, I am able to store attributes but not to retrieve them (I get a blank line and it returns <code>nil</code> instead):</p>\n\n<pre><code>obj = OpenStruct.new # =&gt; #&lt;OpenStruct&gt;\nobj.x = 10\nobj.y = 20\nobj                  # =&gt; #&lt;OpenStruct x=10, y=20&gt;\nobj.x                # =&gt; 10\nobj.y                #  \n                     # =&gt; nil\n</code></pre>\n\n<p>If I try to store other properties with different names, everything works as expected. This problem seems to happen only when I store a property named <code>y</code>. I'm using the following version:</p>\n\n<p><code>ruby 1.9.2p320 (2012-04-20 revision 35421) [i686-linux]</code></p>\n\n<p>Does anybody have an idea of what's going on?</p>\n"},{"tags":["ruby-on-rails","ruby","forms"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13225965,"title":"Rails fields_for inside fields_for","body":"<p>How can I achieve something like this?<br/>\nThe structure is => a test has many questions, and a question has many answers.</p>\n\n<p>I have <code>questions = @test.questions.build</code> and <code>questions.answers.build</code> in the controller. </p>\n\n<pre><code>form_for @test do |f|\n  f.fields_for :questions do |question_f|\n    question_f.fields_for :answers do |answer_f|\n      # answer form here\n</code></pre>\n\n<p>It works untill the fields_for :answers.</p>\n\n<p>What am I missing? Thanks!</p>\n"},{"tags":["ruby","sprockets"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13180417,"title":"Conditional require in Sprockets","body":"<p>How can I conditionally require assets using Sprockets?</p>\n\n<p>I've googled for solutions before asking and found this discussion in the Sprockets repository - <a href=\"https://github.com/sstephenson/sprockets/issues/90\" rel=\"nofollow\">Conditional require</a></p>\n\n<p>The solution discussed there is to use ERB: </p>\n\n<pre><code>&lt;% require_asset \"#{ActiveScaffold.js_framework}/my_test\" %&gt;\n</code></pre>\n\n<p>I've tried it this way:</p>\n\n<p><strong>app.js.erb</strong></p>\n\n<pre><code>&lt;% if debug == true %&gt;\n   &lt;% require_asset \"lib-debug\" %&gt;\n&lt;% else %&gt;\n   &lt;% require_asset \"lib-min\" %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p><strong>Rakefile</strong></p>\n\n<pre><code>def bundle_app(debug)\n  env = Sprockets::Environment.new\n  env.append_path \"app/\"\n  env.js_compressor = Uglifier.new\n  assets = env.find_asset(\"app.js.erb\")\n  return assets.to_s\nend\n</code></pre>\n\n<p>But it results in the following error:</p>\n\n<blockquote>\n  <p>undefined local variable or method `debug' for #&lt;#:0x00000001576d30></p>\n</blockquote>\n\n<p>Definitely there is some easy-to-fix error, but I'm new to Ruby and just can't spot it.</p>\n"},{"tags":["ruby-on-rails","ruby","osx","rjb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13225557,"title":"How to Install Ruby Java Bridge (RJB) on mac/ osx","body":"<p>Does anyone know how to install RJB on mac correctly, I already use RJB gem, but .jar file still can not loaded, always return \"nil\". thanks</p>\n"},{"tags":["c++","ruby","iterator"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":244,"score":3,"question_id":5375126,"title":"Ruby C++ style iterator","body":"<p>I would like to iterate through different ruby arrays (and possibly hashes). I don't really want to have to maintain an index to keep track the position I am in for each array. It's not because I'm lazy, but I am used to the C++ way of using iterator, which I think is less error prone.</p>\n\n<p>So is there a way to get an iterator in ruby, like we do in c++ (this example does not do much but it is just for the sake of the example):</p>\n\n<pre><code>std::set&lt; MyObject &gt;::iterator iter1 = set1.begin();\nstd::set&lt; MyObject &gt;::iterator iter2 = set2.begin();\n\nwhile(iter1 != set1.end() &amp;&amp; iter2 != set2.end()\n{\n  if (iter1-&gt;timestamp &gt; iter2-&gt;timestamp)\n    ++iter2;\n  else\n     ++iter1;\n}\n</code></pre>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13225762,"title":"Pass value with space to Ruby script","body":"<p>I've started to get the option parser within Ruby to work with a general amount of success.  Unfortunately ruby-docs isn't particularly helpful in what I'm looking to do.  is it possible to pass multiple values to one argument, or define an argument as an array and pass multiple values to it?</p>\n\n<pre><code>require 'optparse'\n\n@user_name = nil\n\nopts = OptionParser.new\nopts.on(\"-n name\", \"--name name\", \"Name Input\"){|n|\n@user_name = n\n}\nopts.parse!(ARGV)\n\nif @user_name.nil? == false\n  puts @user_name\nelse\n  puts \"Nil Value\"\nend\n</code></pre>\n\n<p>Right now if you run this:</p>\n\n<pre><code>ruby nametest.rb -n John Doe\n</code></pre>\n\n<p>You will get:</p>\n\n<pre><code>John\n</code></pre>\n\n<p>I'm looking to have both the first and last name printed on the screen.  </p>\n"},{"tags":["ruby","rubygems","installation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13223743,"title":"RubyGems Install Failed Ubuntu 11.04","body":"<p>I am trying to install rubygems1.8 in Ubuntu 11.04</p>\n\n<p>I did </p>\n\n<pre><code>sudo apt-get install rubygems1.8\n</code></pre>\n\n<p>Then when I do </p>\n\n<pre><code>gem install rubygems-update\n</code></pre>\n\n<p>I get</p>\n\n<blockquote>\n  <p>The program <code>gem</code> is currently not installed.  You can install it by typing:</p>\n\n<pre><code>sudo apt-get install rubygems1.8\n</code></pre>\n</blockquote>\n\n<p>I tried doing <code>sudo apt-get install rubygems1.8</code> again and I get</p>\n\n<blockquote>\n  <p>rubygems1.8 is already the newest version</p>\n</blockquote>\n\n<p>As far as I browsed the internet, this method seems to work for everyone. Any idea for troubleshooting?</p>\n"},{"tags":["ruby","rack"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13225343,"title":"Rack: How do you store the URL as a variable?","body":"<p>I am writing a simple static Rack app.  Check out the config.ru code below:</p>\n\n<pre><code>use Rack::Static, \n  :urls =&gt; [\"/elements\", \"/img\", \"/pages\", \"/users\", \"/css\", \"/js\"],\n  :root =&gt; \"archive\"\n\n\nmap '/' do\n  run Proc.new { |env|\n    [\n      200, \n      {\n        'Content-Type'  =&gt; 'text/html', \n        'Cache-Control' =&gt; 'public, max-age=6400' \n      },\n      File.open('archive/splash.html', File::RDONLY)\n    ]\n  }\nend\n\nmap '/pages/search.html' do\n  run Proc.new { |env|\n    [\n      200, \n      {\n        'Content-Type'  =&gt; 'text/html', \n        'Cache-Control' =&gt; 'public, max-age=6400' \n      },\n      File.open('archive/pages/search.html', File::RDONLY)\n    ]\n  }\nend\n\nmap '/pages/user.html' do\n  run Proc.new { |env|\n    [\n      200, \n      {\n        'Content-Type'  =&gt; 'text/html', \n        'Cache-Control' =&gt; 'public, max-age=6400' \n      },\n      File.open('archive/pages/user.html', File::RDONLY)\n    ]\n  }\nend\n\n# Each map section is repeated for each HTML page served\n</code></pre>\n\n<p>I'd like to simplify this by storing the URL as variable and creating one map section that says </p>\n\n<pre><code>map url do\n  run Proc.new { |env|\n    [\n      200, \n      {\n        'Content-Type'  =&gt; 'text/html', \n        'Cache-Control' =&gt; 'public, max-age=6400' \n      },\n      File.open('archive' + url, File::RDONLY)\n    ]\n  }\nend\n</code></pre>\n\n<p>How can I correctly set this url variable?</p>\n"},{"tags":["java","ruby-on-rails","ruby","file","jruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":11509373,"title":"JRuby - second call of method \"eval\" gives (Errno::EBADF) Bad file descriptor","body":"<p>I have a JRuby engine which calls a method \"run_code\" from a Ruby class. The \"run_code\" method calls an IRB command and capture its output. </p>\n\n<p>The <strong>first call</strong> of method \"run_code\" works fine everytime.</p>\n\n<p>The <strong>second call</strong> gives me these error : </p>\n\n<pre><code>(Errno::EBADF) Bad file descriptor \nCaused by: org.jruby.embed.InvokeFailedException: (Errno::EBADF) Bad file descriptor                                                  \n     at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.call(EmbedRubyObjectAdapterImpl.java:406)   \n     at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.callMethod(EmbedRubyObjectAdapterImpl.java:3\n    33)                                                                                                 \n     at org.jruby.embed.ScriptingContainer.callMethod(ScriptingContainer.java:1334)                     \n     at org.apache.hadoop.hbase.master.ShellEndPoint.commandResponse(ShellEndPoint.java:87)             \n     at org.apache.hadoop.hbase.master.ShellEndPoint.doGet(ShellEndPoint.java:114)                      \n     at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)                                    \n     at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)                                    \n     at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)                          \n     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)         \n     at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:835)              \n     at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)         \n     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)                        \n     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)                     \n     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)                        \n     at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)                        \n     at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)                           \n     at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)    \n     at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)                        \n     at org.mortbay.jetty.Server.handle(Server.java:326)                                                \n     at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)                         \n     at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)         \n     at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)                                     \n     at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)                                \n     at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)                                \n     at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)                    \n     at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)                   \n    Caused by: org.jruby.exceptions.RaiseException: (Errno::EBADF) Bad file descriptor                  \n    Caused by:org.jruby.exceptions.RaiseException: (Errno::EBADF) Bad file descriptor     \n     at org.jruby.RubyIO.initialize(org/jruby/RubyIO.java:981)                                          \n     at org.jruby.RubyIO.new(org/jruby/RubyIO.java:868)                                                 \n     at Engine.run_code(&amp;lt;script&amp;gt;:28) \n</code></pre>\n\n<p>The <strong>third call</strong> gives me these error :</p>\n\n<pre><code>(NoMethodError) undefined method `to_i' for #&amp;lt;StringIO:0x128ef465   \n\nProblem accessing /shell. Reason:                                                                \n(NoMethodError) undefined method `to_i' for #&amp;lt;StringIO:0x128ef465&amp;gt;\nCaused by: org.jruby.embed.InvokeFailedException: (NoMethodError) undefined method `to_i' for StringIO:0x128ef465;                                                                          \n at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.call(EmbedRubyObjectAdapterImpl.java:406)   \n at org.jruby.embed.internal.EmbedRubyObjectAdapterImpl.callMethod(EmbedRubyObjectAdapterImpl.java:3\n33)                                                                                                 \n at org.jruby.embed.ScriptingContainer.callMethod(ScriptingContainer.java:1334)                     \n at org.apache.hadoop.hbase.master.ShellEndPoint.commandResponse(ShellEndPoint.java:87)             \n at org.apache.hadoop.hbase.master.ShellEndPoint.doGet(ShellEndPoint.java:114)                      \n at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)                                    \n at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)                                    \n at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)                          \n at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1221)         \n at org.apache.hadoop.http.HttpServer$QuotingInputFilter.doFilter(HttpServer.java:835)              \n at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)         \n at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)                        \n at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)                     \n at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)                        \n at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)                        \n at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)                           \n at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)    \n at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)                        \n at org.mortbay.jetty.Server.handle(Server.java:326)                                                \n at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)                         \n at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)         \n at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)                                     \n at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)                                \n at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)                                \n at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:410)                    \n at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)                   \nCaused by: org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `to_i' for #&amp;lt;Str\ningIO:0x128ef465&amp;gt;                                                                                                                                                                              \nCaused by:org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `to_i'\n for #&amp;lt;StringIO:0x128ef465&amp;gt;                                                                   \n at Engine.run_code(&amp;lt;script&amp;gt;:12)                                       \n</code></pre>\n\n<p>My <strong>java code</strong> looks like this : </p>\n\n<pre><code>ScriptEngineManager manager = new ScriptEngineManager();\nScriptEngine engine = manager.getEngineByName(\"jruby\");\nScriptingContainer container = new ScriptingContainer();\n\nReader reader = new FileReader(myEngine);\n\ntry {\n  receiver = engine.eval(reader);\n  ob = container.callMethod(receiver,\"run_code\",command);\n  response = ob.toString();\n} catch(ScriptException e) {\n      LOG.debug(e.getMessage());\n      response =\"ERROR\";\n}\n</code></pre>\n\n<p>My <strong>ruby code</strong> looks like this:</p>\n\n<pre><code>require 'stringio'\nrequire 'irb'\nrequire 'hirb'\n\nclass Engine\n  extend Shell\n  def initialize()\n    @binding = Kernel.binding\n  end\n  def run_code(code)\n    # run something\n    stdout_id = $stdout.to_i\n    $stdout = StringIO.new\n    cmd = &lt;&lt;-EOF\n    $stdout = StringIO.new\n    begin\n      #{code}\n    end\n    EOF\n    begin\n      result = Thread.new { Kernel.eval(cmd, @binding) }.value\n    rescue SecurityError\n      return \"illegal\"\n    rescue Exception =&gt; e\n      return e\n    ensure\n      output = get_stdout\n      $stdout = IO.new(stdout_id)\n    end\n\n    return output\n  end\n\n   private\n   def get_stdout\n     raise TypeError, \"$stdout is a #{$stdout.class}\" unless $stdout.is_a? StringIO\n     $stdout.rewind\n     $stdout.read\n   end\n\nend\n\nmodule Kernel\n  @shell = Shell::Shell.new(@hbase, @formatter)\n\n  # Add commands to this namespace\n  @shell.export_commands(self)\n  @formatter = Shell::Formatter::Console.new\n\n  # Setup the HBase module.  Create a configuration.\n  @hbase = Hbase::Hbase.new\n\n  # Setup console\n  @shell = Shell::Shell.new(@hbase, @formatter)\n\n  # Add commands to this namespace\n  @shell.export_commands(self)\n\n  # Add help command\n  def help(command = nil)\n    @shell.help(command)\n  end\n\n# Backwards compatibility method\n  def tools\n    @shell.help_group('tools')\n  end\nend\n</code></pre>\n\n<p>Do you know what could be the problem?</p>\n\n<p>Instead of creating a new $stdout object I kept a reference to the old one. Now it gives me </p>\n\n<pre><code>    javax.script.ScriptException: org.jruby.exceptions.RaiseException: (Errno::\nEBADF) Bad file descriptor   \n</code></pre>\n\n<p>error. </p>\n"},{"tags":["ruby-on-rails","ruby","controller","associations","simple-form"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":278,"score":0,"question_id":5846240,"title":"How to create a parent model through a child controller in rails 3? (belongs_to association)","body":"<p>I have two resources: Topics and Posts.\nI am trying to figure out how I can create a Topic through the Post controller.\nThe models look like this:</p>\n\n<pre><code>class Topic &lt; ActiveRecord::Base\n  has_many :posts, :dependent =&gt; :destroy\n  validates :name, :presence =&gt; true,\n                   :length =&gt; { :maximum =&gt; 32 }\n  attr_accessible  :name\nend\n\nclass Post &lt; ActiveRecord::Base\n  belongs_to :topic,    :touch =&gt; true\n  has_many   :comments, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :topic\n  attr_accessible :name, :title, :content, :topic\nend\n</code></pre>\n\n<p>posts/_form.html.erb:</p>\n\n<pre><code>&lt;%= simple_form_for @post do |f| %&gt;\n  &lt;h1&gt;Create a Post&lt;/h1&gt;\n  &lt;%= f.input :name, :label =&gt; false, :placeholder =&gt; \"Name\" %&gt;\n  &lt;%= f.input :title, :label =&gt; false, :placeholder =&gt; \"Title\" %&gt;\n  &lt;%= f.input :content, :label =&gt; false, :placeholder =&gt; \"Content\" %&gt;\n  &lt;%= f.input :topic, :label =&gt; false, :placeholder =&gt; \"Topic\" %&gt;  \n  &lt;%= f.button :submit, \"Post\" %&gt;  \n&lt;% end %&gt;\n</code></pre>\n\n<p>posts_controller.rb#create:</p>\n\n<pre><code>def create\n  @post = Post.new(params[:topic])\n  respond_to do |format|\n    if @post.save\n      format.html { redirect_to(@post, :notice =&gt; 'Post was successfully created.') }\n    else\n      format.html { render :action =&gt; \"new\" }\n    end\n  end\nend\n</code></pre>\n\n<p>With posts/_form.html.erb I can create posts, but an associated topic is not created along with it. Can anyone tell me why I get this behavior and possibly how to correct it? I'm using Ruby 1.9.2, Rails 3.0.7 and the simple_form gem.</p>\n"},{"tags":["ruby-on-rails","ruby","loops","background"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":13205704,"title":"Run a method in loop","body":"<p>I have a project that needs to run a method in loop and in background.</p>\n\n<p>Basically I have a method that: call a web service -> read the data -> store into a database -> loop over and over.</p>\n\n<p>I found a gem called \"loops\" (https://github.com/kovyrin/loops) but maybe there are 2 problemas: a) I don't know if they support Rails 3 &amp; Ruby 1.9.3 and 2) it seem like there are no support on it (last commit was a half year ago).</p>\n\n<p>Suggestions? They are all very welcome.</p>\n\n<p>Thanks a lot, guys!</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13219189,"title":"ruby-How to use require 'active_support/all' in textmate?","body":"<p>like the title said.</p>\n\n<p>How can I use activesupport in ruby in textmate? I already install it in my mac terminal.</p>\n\n<p>edit: clarify\nWhen you use textmate, you can use cmd+R to execute your codes. However, gemset like activesupport is not compiled in the textmate interpreter. Say you want to use array = [0,1,2,3,4,5,6] and array.from(4) to get [4,5,6]. It gives you and error because activesupport gemset is not installed in textmate ruby. So my question is how do you include activesupport in textmate interpreter. Is there a bundle for it?</p>\n"},{"tags":["ruby","jekyll","octopress"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13217394,"title":"How to speed up Jekyll/Octopress generation?","body":"<p>I'm using Octopress as my blog engine. It's perfect. But if there are many posts, for example 400+ posts, the speed of generation is soooo slow.</p>\n\n<p>So, is there any way to speed up Jekyll/Octopress generation?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby","rack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13188899,"title":"Rack: Multiple session cookies for a single rack application","body":"<p>How can one interact with multiple sessions cookies (for different path or domains) in a single rack application?</p>\n\n<p>For example, considering the following application using 3 locations:</p>\n\n<ul>\n<li>www.my-app.net => main app</li>\n<li>www.my-app.net/app_a => sub app A</li>\n<li>app_b.my_app.net/ => sub app B</li>\n</ul>\n\n<p>Should be able to interact with 3 sessions cookies:</p>\n\n<ul>\n<li>domain=www.my-app.net; path=/;</li>\n<li>domain=www.my-app.net; path=/app_a;</li>\n<li>domain=app_b.my-app.net/; path=/;</li>\n</ul>\n\n<p>Rack::Session::Cookie seemed to be a good choice, but as a middleware the session cookie has to be set in config.ru and seems to be limited to one session cookie per rack application.</p>\n\n<p>In this special case, the main rack application point is to easily add sub applications, so dividing the application in multiple rack application to use Rack::Session::Cookie is not a viable solution.</p>\n\n<p>The ideal would be a way to interact freely with multiple session cookies from inside the rack application code.</p>\n\n<p>For now, I am considering:</p>\n\n<ul>\n<li>writing a middleware that allow interaction with multiple session cookies</li>\n<li>use CGI::Cookie to implement a custom session cookie management inside the application</li>\n</ul>\n\n<p>But both are quite tedious so I was wondering if there was a simpler way to achieve this functionality.</p>\n\n<p>Thanks in advance for any advice or suggestion.</p>\n"},{"tags":["ruby","timestamp","api-design"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13222584,"title":"Representing local timestamps in Ruby based REST API","body":"<p>Perhaps this question should be broken up into two posts, but I currently have an API for a few business customers. I am currently using ISO 8601 timestamps with a UTC time zone to represent times. However, I don't like the idea of these timestamps being attached to any timezone because the times should be the same no matter what timezone you are in. 5PM UTC should be 5PM CST, etc... </p>\n\n<p>I know that you can leave the Z off of an ISO timestamp, and it will be interpreted as whatever local time you are in. Is this ok practice? And if so, how do I do this in Ruby? I read the doc for the Time class and didn't see anything about this.</p>\n\n<p><strong>EDIT:</strong> Let me re-word this just a little bit, or atleast clarify something. The reason why I'm seeking timestamps that aren't attached to a timezone is exactly because I know that my client servers and API server will hardly ever match up. If a client is submitting an event with a time, that time needs to be ambiguously equal to the ambiguous locale specific to the event that the user is working on. </p>\n\n<p>That's a mouthful...assume that I'm working on an event scheduler. Each event belongs to a storefront or location of a company. When times are being shown for a location, it is assumed that the times shown are in the timezone of the location, and for clarity's sake should never be shown at a time formatted to a user's local timezone. If I'm looking at the scheduler on the East Coast, but looking at events for locations on the West Coast, the times I should see should be local to the locations on the West Coast, not adjusted for my timezone. </p>\n\n<p>I know a solution could be to simply store times with timezone information for the location its associated to. But the use case that a user would want to convert a time to their timezone is VERY rare, and I'd rather make implementing my API easier...this was actually my original implementation but implementing the API in many different environments and across multiple programming languages, it became clear that it is a hurdle to show times local to that timestamp's timezone for a lot of languages. If a user wanted to convert times to their local timezone I could easily store global timezone information for the location object itself. </p>\n"},{"tags":["ruby","command-line-arguments","optparse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13224386,"title":"Option With 2 Arguments in OptParse","body":"<p>I'm trying to do something that looks like this:</p>\n\n<pre><code>opt_parser = OptionParser.new do |opt|\n    opt.banner = \"Test\"\n    opt.separator \"\"\n    opt.on(\"-t\", \"--test arg1 arg2\", \"Test\") do |arg1, arg2|\n        puts arg1\n        puts arg2\n    end\nend\n</code></pre>\n\n<p>The problem is that it returns the <code>arg1</code>, but <code>arg2</code> returns <code>nil</code>. How to make this work?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13224248,"title":"How to use form builder to add attribute to form helpers in Rails?","body":"<p>I am trying to build a form builder in Rails that adds a <code>disabled</code> attribute to <code>text_field</code> and <code>select</code> helpers. This is the simplified version of my code:</p>\n\n<pre><code>class LabelFormBuilder &lt; ActionView::Helpers::FormBuilder  \n  %w[text_field select].each do |method_name|\n    define_method(method_name) do |name, *args|\n      super(name, :disabled =&gt; true, *args)\n    end  \n  end\nend\n</code></pre>\n\n<p>With <code>text_fields</code> the attribute gets added properly but with <code>selects</code> things get a bit trickier and I keep getting <code>undefined method merge for #&lt;Array:0x10b5229a0&gt;</code> errors.</p>\n\n<p>This is my view code (again simplified): </p>\n\n<pre><code>&lt;%= f.label :name %&gt;\n&lt;%= f.text_field :name %&gt;      # works!\n\n&lt;%= f.label :person %&gt;\n&lt;%= f.select(:person_id, current_user.person_names, :prompt =&gt; 'Please select...') %&gt;  # does not work!\n</code></pre>\n\n<p>How can I get line 4 of my class above to work on <code>select</code> helpers as well?</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":3401,"score":6,"question_id":3518329,"title":"Add a new line in file?","body":"<p>I want to add a new line after a string is inserted.</p>\n\n<p>My current code looks like this:</p>\n\n<pre><code>  File.open(filename, 'a') do |file|\n    file.write @string\n  end\n</code></pre>\n\n<p>How could I add a new line after the string is inserted?</p>\n"},{"tags":["ruby","learn"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13224256,"title":"Stuck on LearnStreet Ruby Training. Simple Ruby Code","body":"<p>Attempting to learn Ruby using the new LearnStreet online tutorials.</p>\n\n<p>Have attempted to get help via their Q&amp;A system but it seems nobody answers them.</p>\n\n<blockquote>\n  <p>\"Can you now implement the withdraw! method on account object, which\n  takes one parameter amount and reduces the balance by the specified\n  amount? After defining the method, go ahead and withdraw 100 dollars\n  from the account and check the balance.\"</p>\n</blockquote>\n\n<p>Is the question and I got the two hints of </p>\n\n<blockquote>\n  <p>\" Hint 1 The code @balance = @balance - amount reduces the amount from\n  @balance.</p>\n  \n  <p>Hint 2 Then call the method withdraw! on the account object -\n  account.withdraw!(100). \"</p>\n</blockquote>\n\n<p>My attempt was </p>\n\n<pre><code>def\n\naccount.widthdraw!\n\n@balance = @balance - amount\n\nend\n\naccount.withdraw!(100)\n</code></pre>\n\n<p>Any ideas what I'm missing?</p>\n"},{"tags":["ruby","rspec","rr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13224507,"title":"How to use custom RR wildcard matcher?","body":"<p>I have created a wildcard matcher for <a href=\"https://github.com/btakita/rr\" rel=\"nofollow\">RR</a> that matches JSON strings by parsing them into hashes. This is because JSON (de)serialization doesn't preserve order; if we have:</p>\n\n<pre><code>{ 'foo': 42, 'bar': 123 }\n</code></pre>\n\n<p>... then after (de)serialization, we might find that our update method is called with:</p>\n\n<pre><code>{ 'bar': 123, 'foo': 42 }\n</code></pre>\n\n<p>The wildcard matcher looks like this:</p>\n\n<pre><code>class RR::WildcardMatchers::MatchesJsonString\n\n  attr_reader :expected_json_hash\n\n  def initialize(expected_json_string)\n    @expected_json_hash = JSON.parse(expected_json_string)\n  end\n\n  def ==(other)\n    other.respond_to?(:expected_json_hash) &amp;&amp; other.expected_json_hash == self.expected_json_hash\n  end\n\n  def wildcard_matches?(actual_json_string)\n    actual_json_hash = JSON.parse(actual_json_string)\n    @expected_json_hash == actual_json_hash\n  end\nend\n\nmodule RR::Adapters::RRMethods\n  def matches_json(expected_json_string)\n    RR::WildcardMatchers::MatchesJsonString.new(expected_json_string)\n  end\nend\n</code></pre>\n\n<p>... and we're using it like:</p>\n\n<pre><code>describe 'saving manifests' do\n\n  before do\n    @manifests = [\n      { :sections =&gt; [], 'title' =&gt; 'manifest1' },\n      { :sections =&gt; [], 'title' =&gt; 'manifest2' }\n    ]\n\n    mock(manifest).create_or_update!(matches_json(@manifests[0].to_json)) { raise 'uh oh' }\n    mock(manifest).create_or_update!(matches_json(@manifests[1].to_json))\n\n    parser = ContentPack::ContentPackParser.new({\n                                                  'manifests' =&gt; @manifests\n                                                })\n    @errors = parser.save\n  end\n\n  it 'updates manifests' do\n    manifest.should have_received.create_or_update!(anything).twice\n  end\nend\n</code></pre>\n\n<p>This in accordance with the <a href=\"http://www.rubydoc.info/github/btakita/rr/master/RR/WildcardMatchers\" rel=\"nofollow\">RR documentation</a>.  However, instead of <code>mock()</code> expecting an argument that matches JSON, it expects the argument to be a <code>MatchesJsonString</code> object:</p>\n\n<pre><code> 1) ContentPack::ContentPackParser saving manifests updates manifests\n     Failure/Error: mock(Manifest).create_or_update!(matches_json(@manifests[0].to_json)) { raise 'uh oh' }\n     RR::Errors::TimesCalledError:\n       create_or_update!(#&lt;RR::WildcardMatchers::MatchesJsonString:0x13540def0 @expected_json_hash={\"title\"=&gt;\"manifest1\", \"sections\"=&gt;[]}&gt;)\n       Called 0 times.\n       Expected 1 times.\n     # ./spec/models/content_pack/content_pack_parser_spec.rb:196\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","version","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":40,"score":5,"question_id":13202992,"title":"CarrierWave with custom processor not registering","body":"<p>I am using <a href=\"https://github.com/jnicklas/carrierwave\" rel=\"nofollow\">carrierwave</a> to upload a video then have a version called thumb with a custom processor that takes the video and creates a screenshot using streamio-ffmpeg.  Both the video and the file are uploaded correctly but when calling uploader.url(:thumb) I get:</p>\n\n<blockquote>\n  <p>ArgumentError: Version thumb doesn't exist!</p>\n</blockquote>\n\n<h2>VideoUploader.rb</h2>\n\n<pre><code>require 'carrierwave/processing/mime_types'\nrequire 'streamio-ffmpeg'\n\nclass VideoUploader &lt; CarrierWave::Uploader::Base\n    include CarrierWave::VideoConverter\n    include CarrierWave::MimeTypes\n\n    process :set_content_type\n\n    storage :file\n\n    version :thumb do\n            process :create_thumb\n\n            #def full_filename(for_file)\n            #        \"thumb_#{File.basename(for_file, File.extname(for_file))}.png\"\n            #end\n    end\n\n    def create_thumb\n            cached_stored_file! if !cached?\n\n            movie = FFMPEG::Movie.new(current_path)\n\n            dirname = File.dirname(current_path)\n\n            thumb_path = \"#{File.join(dirname, File.basename(path, File.extname(path)))}.png\"\n\n            movie.screenshot(thumb_path, :seek_time =&gt; 5)\n            File.rename thumb_path, current_path\n    end\n\n    def file_identifier\n            model[:video]\n    end\n\n    # Override the directory where uploaded files will be stored.\n    # This is a sensible default for uploaders that are meant to be mounted:\n    def store_dir\n            return \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.user_id}/#{model.id}\"\n    end\nend\n</code></pre>\n\n<p>Then model.video_url(:thumb) returns the argument error.  I am not sure what to do or why the version isn't registered any help would be great, thanks.</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":1,"view_count":91,"score":4,"question_id":13210333,"title":"Equivalent for `break` in ruby's case / when statements?","body":"<p>I'm looking for a statement that skips the execution of the <code>when</code> block, similiar to <code>break</code> for loops. Is this possible?</p>\n\n<p>What I want to avoid is a construct like:</p>\n\n<pre><code>case n\n  when 1\n    if valid\n      foo.bar\n    end\n  when 2\n    if valid\n      foo.foo\n  end\n</code></pre>\n\n<p>The more desirable code block would look like:</p>\n\n<pre><code>case n\n  when 1\n    break unless valid\n    foo.bar\n  when 2\n    break unless valid\n    foo.foo\n  end\n</code></pre>\n\n<p>Obviously, <code>break</code> does not work. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13224176,"title":"Rails namespacing error?","body":"<p>I have this in my <code>config/routed.db</code>:</p>\n\n<pre><code>namespace :admin do\n  resources :users\n  resources :events\nend\n</code></pre>\n\n<p>I generated the <code>User</code> model by using the scaffolding Rails provides, then I simply generated a admin/admin controller by using Rails' <code>generate</code> and simply moved all the user-related stuff into the admin sub-directories inside the controllers/views/helpers. Yes, I did have to add <code>admin_</code> in a few places and inside the form partial I had to change the <code>form_for(@user)</code> to <code>form_for([:admin, @user])</code>. </p>\n\n<p>When I try to create a new user (this is when I <code>POST</code> the user data) I get the following error message:</p>\n\n<pre><code>undefined method `user_url' for #&lt;Admin::UsersController:0x13f408e0&gt;\n</code></pre>\n\n<p>The application-level trace shows that the error is raised here:</p>\n\n<pre><code>app/controllers/admin/users_controller.rb:47:in `create'\n</code></pre>\n\n<p>The line of code where this error is raised:</p>\n\n<pre><code>format.html { redirect_to @user, :notice =&gt; 'User was successfully created.' }\n</code></pre>\n\n<p>The above line is inside the <code>respond_to</code> block.</p>\n\n<p>So, I have two questions: </p>\n\n<ol>\n<li>How do I fix this issue?</li>\n<li>Is there a smarter, better, rails-way of doing this?</li>\n</ol>\n\n<hr>\n\n<p>Also, bonus points if you suggest I re-do this in the <em>smarter, better, rails-way</em>! Well, I will do that anyway! :D</p>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>Oh, I almost forgot something that might be relevant! I also made <code>Admin::UsersController</code> inherit from <code>Admin::AdminController</code> (which normally in turn inherits from <code>ApplicationController</code>):</p>\n\n<p><code>Admin::UsersController &lt; Admin::AdminController</code></p>\n"},{"tags":["c","ruby","sockets","select"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":2,"view_count":42,"score":-1,"question_id":13223736,"title":"is it possible to pause/resume part of a full-duplex connection?","body":"<p>Yes, no?<br/></p>\n\n<p>How can I achieve something like this:</p>\n\n<p><strong>In Client side</strong></p>\n\n<pre><code>loop do\n    socket.read(MAX_LEN)\n    socket.pause_read   # the client is busy, do not send any more data, similar to: C system call shutdown(sock, SHUT_RD)\n    # ... working\n\n    socket.resume_read  # the client is ready to work again. \nend\n</code></pre>\n\n<p><strong>In Server side</strong></p>\n\n<pre><code>loop do\n    rd, wr, _ = select(rdsockets, wrsockets)\n    # wr is an array fill of clients ready to work\n    wr.each {}\nend\n</code></pre>\n\n<p>PS: Help can be provided either with C or Ruby.\nThank you in advance.</p>\n\n<p>EDIT:\nThe incoming data has a predefined format and the length of the incoming data varies.</p>\n\n<p>EDIT2:\nOS: Linux</p>\n"},{"tags":["ruby-on-rails","ruby","imagemagick","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":74,"score":3,"question_id":13056932,"title":"Paperclip File Not Found Error","body":"<p>I just switched from a paperclip rails plugin to a paperclip gem. The project is a rails 2.3 application and I am using paperclip 2.7.2 gem.</p>\n\n<p>I am getting the following odd error:</p>\n\n<pre><code>identify: unable to open image `file': No such file or directory @ error/blob.c/OpenBlob/2617.\nidentify: no decode delegate for this image format `file' @ error/constitute.c/ReadImage/544.\n</code></pre>\n\n<p>Seems like paperclip is looking for a file called 'file' but I am not sure why. I didn't change any of the code we had before. It used to work, all I did was upgrade to a newer version and use a gem over a plugin.</p>\n\n<p>Any ideas?</p>\n\n<p><em><strong>Update</em></strong></p>\n\n<p>It to be a bug in paper clip where it does not parse the content of the command properly. I dug deep into the paperclip source to find:</p>\n\n<pre><code>def run(cmd, arguments = \"\", local_options = {})\n  if options[:image_magick_path]\n    Paperclip.log(\"[DEPRECATION] :image_magick_path is deprecated and will be removed. Use :command_path instead\")\n  end\n  command_path = options[:command_path] || options[:image_magick_path]\n  Cocaine::CommandLine.path = [Cocaine::CommandLine.path, command_path].flatten.compact.uniq\n  local_options = local_options.merge(:logger =&gt; logger) if logging? &amp;&amp; (options[:log_command] || local_options[:log_command])\n\n  Cocaine::CommandLine.new(cmd, arguments, local_options).run\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code># Uses ImageMagick to determing the dimensions of a file, passed in as either a\n# File or path.\n# NOTE: (race cond) Do not reassign the 'file' variable inside this method as it is likely to be\n# a Tempfile object, which would be eligible for file deletion when no longer referenced.\ndef self.from_file file\n  file_path = file.respond_to?(:path) ? file.path : file\n  raise(Paperclip::NotIdentifiedByImageMagickError.new(\"Cannot find the geometry of a file with a blank name\")) if file_path.blank?\n  geometry = begin\n               Paperclip.run(\"identify\", \"-format %wx%h :file\", :file =&gt; \"#{file_path}[0]\")\n             rescue Cocaine::ExitStatusError\n               \"\"\n             rescue Cocaine::CommandNotFoundError =&gt; e\n               raise Paperclip::CommandNotFoundError.new(\"Could not run the `identify` command. Please install ImageMagick.\")\n             end\n  parse(geometry) ||\n    raise(NotIdentifiedByImageMagickError.new(\"#{file_path} is not recognized by the 'identify' command.\"))\nend\n</code></pre>\n\n<p>The Paperclip.run command fails to replace the :file placeholder for some reason. I verified this by running the following on the commandline:</p>\n\n<pre><code>identify :file\n</code></pre>\n\n<p>Monkey patching the replacement by hand yields other errors where a similar thing happens.</p>\n"},{"tags":["mysql","ruby","devkit"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1121,"score":0,"question_id":8242565,"title":"Error installing mysql2 with windows","body":"<p>It's strange the I can install mysql2 with this command:\n<code>$ gem install mysql2 --platform=ruby -- '--with-mysql-lib=\"c:\\Program Files\\MySQL\\MySQL Server 5.5\\lib\" --with-mysql-include=\"c:\\Program Files\\MySQL\\MySQL Server 5.5\\include\"'</code> Following is the results:</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nSuccessfully installed mysql2-0.3.10\n1 gem installed\nInstalling ri documentation for mysql2-0.3.10...\nInstalling RDoc documentation for mysql2-0.3.10...\n</code></pre>\n\n<p>But when I'm running <code>bundle install</code> (apperently I have a lot of gems needs to install), it is failed to install mysql2, so <code>bundle install</code> stopped there, that really drives me crazy... anyone could help? a tons of thanks!\nBelow is the result from <code>bundle install</code>:</p>\n\n<pre><code>Installing mysql2 (0.3.8) with native extensions\nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension\n.\n\n        c:/Ruby192/bin/ruby.exe extconf.rb\nchecking for rb_thread_blocking_region()... yes\nchecking for rb_wait_for_single_fd()... no\nchecking for main() in -llibmysql... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=c:/Ruby192/bin/ruby\n        --with-mysql-dir\n        --without-mysql-dir\n        --with-mysql-include\n        --without-mysql-include=${mysql-dir}/include\n        --with-mysql-lib\n        --without-mysql-lib=${mysql-dir}/lib\n        --with-libmysqllib\n        --without-libmysqllib\n\n\nGem files will remain installed in G:/Desktop/20090319-/Rails Examples/ClockingI\nT/vendor/bundle/ruby/1.9.1/gems/mysql2-0.3.8 for inspection.\nResults logged to G:/Desktop/20090319-/Rails Examples/ClockingIT/vendor/bundle/r\nuby/1.9.1/gems/mysql2-0.3.8/ext/mysql2/gem_make.out\nAn error occured while installing mysql2 (0.3.8), and Bundler cannot continue.\nMake sure that `gem install mysql2 -v '0.3.8'` succeeds before bundling.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13223482,"title":"How to \"exploit\" relationship data already stored in the database?","body":"<p>I am using Ruby on Rails v3.2.2. I have following model classes</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  has_many :regions, :foreign_key =&gt; 'country_id'\nend\n\nclass Region &lt; ActiveRecord::Base\n  belongs_to :country, :foreign_key =&gt; 'country_id'\n  has_many :cities, :foreign_key =&gt; 'region_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  belongs_to :region, :foreign_key =&gt; 'region_id'\nend\n</code></pre>\n\n<p>and <em>I would like to make a <code>City</code> <code>belongs_to :country</code></em>.</p>\n\n<p>I know that the simplest way to make that is to add a <code>country_id</code> database table column to the <code>City</code> database table and to state related ActiveRecord Associations, this way:</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  # ...\n  has_many :cities, :foreign_key =&gt; 'country_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  # ...\n  belongs_to :country, :foreign_key =&gt; 'country_id'\nend\n</code></pre>\n\n<p>However, in order to store <em>less database data</em>, I think I may \"use\" the data already stored in the <code>Region</code> table <em>since a city belongs to a region which in turn belongs to a country (this implies that a city belongs to a country)</em> but, in this case, I have no idea on how to properly state ActiveRecord Associations for <code>City</code> and <code>Country</code> so to \"exploit\" mentioned relationship informations implicitly present \"through\" the <code>Region</code> model class.</p>\n\n<p>How should I proceed?</p>\n\n<hr>\n\n<p><em>Note</em>: I am \"forcing\" to state the <code>belongs_to :country</code> ActiveRecord Association in the <code>City</code> model class because I would like to use the RoR <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs_to-counter_cache\" rel=\"nofollow\"><code>:counter_cache</code></a> feature (available <em>only</em> for <code>belongs_to</code> associations) in order to count cities present in a country.</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","random"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":46,"score":2,"question_id":13223833,"title":"Using seeded random sequence instead of 100M row relations table","body":"<p>We are hosting the backend of a social game for iPhone on a Ruby on Rails/postgres server.</p>\n\n<p>Every game has 54 questions connected via a relation table in the database. Since we currently have about 2 Million ongoing games, the relation table contains about a 100M rows. This eats a lot of memory. We are now considering constructing an algorithm which generates 54 question ids using a pseudo-random sequence seeded by the game_id. The idea is to produce a seemingly random collection of question, without saving the explicit game-question-relations to the database. This way we can move load from the database to the application server. Is this a good idea?</p>\n\n<p><strong>Pseudo code:</strong></p>\n\n<pre><code>r = Random.new(game_id)\nq1_id = r.rand(n_questions)\nq2_id = r.rand(n_questions)\n... \n</code></pre>\n"},{"tags":["ruby","debugging","sinatra","aptana","padrino"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":564,"score":1,"question_id":5284336,"title":"How to attach aptana debugger to a Padrino or Sinatra app","body":"<p>I'm using Aptana for a Padrino app, but I don't know how to attach the debugger once the server is running.</p>\n\n<p>I've installed the ruby-debug-ide gem and the Aptana Firefox extenstion.</p>\n\n<p>What's the correct debug configuration for setting that up?</p>\n\n<p>Also, when I try to toggle a breakpoint in Aptana I don't get the standard eclipse marker to show that it's doing something.</p>\n"},{"tags":["ruby-on-rails","ruby","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13223549,"title":"Cannot get accepts_nested_attributes to work in rails 3","body":"<p>This might be a case of me being blind… \nSomehow I cannot get my layout_positions_attributes to arrive at layout_positions</p>\n\n<pre><code>l = Layout.new\n…\n[17] pry(main)&gt; l.layout_positions\n=&gt; []\n[18] pry(main)&gt; l.layout_positions_attributes=[{:name=&gt;'xxx'}]\n=&gt; [{:name=&gt;\"xxx\"}]\n[19] pry(main)&gt; l.layout_positions\n=&gt; [] # WTF!\n[20] pry(main)&gt; l.layout_positions.build({:name=&gt;'xxx'})\n=&gt; #&lt;LayoutPosition id: nil, name: \"xxx\", active: true, columns: nil, rows: nil, layout_id: nil, pos: -1&gt;\n[21] pry(main)&gt; l.layout_positions\n=&gt; [#&lt;LayoutPosition id: nil, name: \"xxx\", active: true, columns: nil, rows: nil, layout_id: nil, pos: −1&gt;]\n</code></pre>\n\n<p>The parent class:</p>\n\n<pre><code>class Layout &lt; ActiveRecord::Base\n  attr_accessible :name, :active, :layout_positions_attributes\n  has_many :layout_positions\n  accepts_nested_attributes_for :layout_positions,\n                                :reject_if =&gt; lambda { |a| a[:content].blank? },\n                                :allow_destroy =&gt; true\n  validates_presence_of :name\nend\n</code></pre>\n\n<p>And where the attributes should go…</p>\n\n<pre><code>class LayoutPosition &lt; ActiveRecord::Base\n  attr_accessible :name, :active, :columns, :rows, :pos\n  belongs_to :layout\n  validates_presence_of :name\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","profiling"],"answer_count":8,"favorite_count":18,"up_vote_count":31,"down_vote_count":0,"view_count":11138,"score":31,"question_id":350470,"title":"What tools do you recommend to profile Rails apps?","body":"<p>I've been looking for profiling tools for Rails for a while. I'm currently playing and testing ruby-prof and railsbench, but I kinda frustrated with the amount of tweaking and mangling required to make then work.</p>\n\n<p>Althought I don't mind (much) the tweaking, I'd like to know if is there any other, more straight-forward and easy to use, tools to profile a Rails app? Which tools you recommend?</p>\n"},{"tags":["python","ruby","rest","rally"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13223568,"title":"Rally APIs: How to copy Test Folder and member Test Cases","body":"<p>This question was asked by a different user earlier:</p>\n\n<p><a href=\"http://stackoverflow.com/questions/13036251/copying-test-cases-and-test-folder-using-rally-python-or-ruby-api\">Copying Test Cases and Test Folder using Rally Python or Ruby API [closed]</a></p>\n\n<p>but closed by moderators as being an overly broad question. However, given the inability to copy Test Folders and their member Test Cases within the <a href=\"https://rally1.rallydev.com\" rel=\"nofollow\">Rally UI</a>, this is a common need for Rally Users.</p>\n\n<p>Thus - I'll re-pose the question, hopefully with enough detail to stand as a valid question. I'll also re-post the answers that I developed for the original question.</p>\n\n<p>Question: As a <a href=\"https://www.rallydev.com\" rel=\"nofollow\">Rally</a> user and developer in the Rally Python and Ruby REST APIs: how can I leverage the <a href=\"http://developer.rallydev.com/help/rest-apis\" rel=\"nofollow\">Rally API toolkits</a> to accomplish this task?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13223170,"title":"Sending all regex matches as arguments","body":"<p>I have a \"table\" of substitution rules stored in a hash, where each key is the rule and each value is a method that will take matched text and send those as arguments. Each method will return a string. Except I don't know how to send all matches. How can I fill in the comment in the <code>send</code> call to accomplish this?</p>\n\n<pre><code>Sub_Rules = {\n   /N\\[(\\d+)\\]/i          =&gt; :do_something,\n   /N\\[(\\d+)\\]\\[(\\d+)\\]/i =&gt; :do_something_else\n}\n\ndef do_something(*args)\n  \"something based on the args\"\nend\n\ndef do_something_else(*args)\n  \"something else based on the args\"\nend\n\ntext = \"N[2]\"\nSub_Rules.each {|rule, method|\n  p text.gsub(rule) {send(method, #the matches?)}\n}\n</code></pre>\n\n<p>If I wanted to hardcode it, I might do something like this:</p>\n\n<pre><code>text.gsub(/N\\[(\\d+)\\]/i) { do_something($1) }\n</code></pre>\n"},{"tags":["ruby","memcached","amazon-elasticache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13212516,"title":"What does the memcached return code 44120 mean?","body":"<p>I am getting a return code from my memcached cluster of value 44120, which is breaking my memcached-northscale ruby client because it does not know what this return code value means. </p>\n\n<p>Can anyone shed light on what this code means and which ruby memcached clients are capable of handling it? </p>\n\n<p>I am using an AWS ElastiCache cluster that is returning this value.</p>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p><strong>Update</strong>: I just tried to substitute memcached for memcached-northscale, and just got this exception: </p>\n\n<pre><code>TypeError: can't convert Fixnum into String\n\nWhere:\n[GEM_ROOT]/gems/memcached-1.4.6/lib/memcached/memcached.rb, line 306\n</code></pre>\n\n<p>I don't know what the root is but my suspicion is that it's related to the earlier issue with memcached-northscale.</p>\n\n<p>I also got an exception: </p>\n\n<pre><code>Memcached::Error: Unknown return code: 4832\n\nWhere:\n[GEM_ROOT]/gems/memcached-1.4.6/lib/memcached/memcached.rb, line 631\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":207,"score":3,"question_id":11617217,"title":"Encoding Undefined Conversion Error - Ruby on Rails , Error on Write","body":"<p>So I am trying to download a zip file from a website and put that data into a table. The download has been working before, but suddenly, it's not anymore. I get a \"`write': \"\\xB6\" from ASCII-8BIT to UTF-8 (Encoding::UndefinedConversionError)\" problem. Very strange, nothing has changed since i last ran the script. Here is the part of the code that is having the problems. I am using a gem which allows me to parse the DBF file within the zip file.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>`write': \"\\xB6\" from ASCII-8BIT to UTF-8 (Encoding::UndefinedConversionError)\n</code></pre>\n\n<p>Thanks for the help</p>\n\n<p>UPDATE: I'm running within rails, obviously. I ran the script outside the rails environment, and it worked fine. So Rails is interfering somehow with the write process. </p>\n\n<p>UPDATE 2: SOLVED - I changed \"w\" to \"wb\" apparently this is caused by rails 3+. Didn't occur to me to try this before. Hopefully this helps other people. </p>\n"},{"tags":["ruby-on-rails","ruby","database","csv","import"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13222947,"title":"How to import data to the database from a CSV file?","body":"<p>I am using Ruby 1.9.2, the Ruby on Rails v3.2.2 gem and the MySQL database. I would like to import data to the database from a <a href=\"http://www.maxmind.com/download/worldcities/worldcitiespop.txt.gz\" rel=\"nofollow\">CSV file</a> containing world cities. I think this process should be made by running a RoR migration but I don't know how to properly proceed.</p>\n\n<p>In particular, I don't know <em>where</em> (that is, in which directory relating my RoR application) I should put the CSV file and <em>how to access</em> that file from my migration file in order to add data to the database.</p>\n"},{"tags":["ruby","activerecord","ruby-on-rails-3.2","sweeper"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13215863,"title":"Rails ModelSweeper.instance expires nothing","body":"<p>Rails 3.2.8, ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-linux]</p>\n\n<p>When I use a sweeper inside another sweeper with <code>instance</code> method, the sweeper function (like  <code>after_update</code>) is executed (I did a log and is executed) but expires nothing in my project. (or Task)</p>\n\n<p>My code is the next:</p>\n\n<pre><code>class WorkSweeper &lt; ActionController::Caching::Sweeper\n  # ...\n  def after_update(work)\n    expire work, \"/works/index\"\n    expire work, \"/tasks/#{work.task_id}/works/index\"\n\n    expire work, \"/works/#{work.id}/show\"\n\n    TaskSweeper.instance.after_update work.task\n  end\n  # ...\nend\n\nclass TaskSweeper &lt; ActionController::Caching::Sweeper\n  # ...\n  def after_update(task)\n    expire task, \"/tasks/index\"\n    expire task, \"/milestones/#{task.target_id}/tasks/index\"\n    expire task, \"/tasks/#{task.target_id}/tasks/index\"\n    expire task, \"/projects/#{task.target_id}/tasks/index\"\n\n    expire task, \"/tasks/#{task.id}/show\"\n\n    MilestoneSweeper.instance.after_update task.target if task.target.class == Milestone\n  end\n  # ...\nend\n\nclass MilestoneSweeper &lt; ActionController::Caching::Sweeper\n  # ...\n  def after_update(milestone)\n    expire milestone, \"/milestones/index\"\n    expire milestone, \"/projects/#{milestone.project_id}/milestones/index\"\n\n    expire milestone, \"/milestones/#{milestone.id}/show\"\n\n    ProjectSweeper.instance.after_update milestone.project\n  end\n  # ...\nend\n\nclass ProjectSweeper &lt; ActionController::Caching::Sweeper\n  # ...\n  def after_update(project)\n    expire project, \"/projects/index\"\n    expire project, \"/companies/#{project.company_id}/projects/index\"\n\n    expire project, \"/projects/#{project.id}/show\"\n  end\n  # ...\nend\n</code></pre>\n\n<p>Note: <code>expire</code> is the next function</p>\n\n<pre><code>def scope(project)\n  project.creator.try(:creator_id) || project.creator_id\nend\n\ndef expire(model, url)\n  expire_fragment(\"#{scope model}#{url}\")\nend\n</code></pre>\n\n<p>I need to execute each expire manually in each sweeper, like:</p>\n\n<pre><code>class WorkSweeper &lt; ActionController::Caching::Sweeper\n  # ...\n  def after_update(work)\n    expire work, \"/works/index\"\n    expire work, \"/tasks/#{work.task_id}/works/index\"\n\n    expire work, \"/works/#{work.id}/show\"\n\n    expire project, \"/projects/index\"\n    expire project, \"/companies/#{project.company_id}/projects/index\"\n\n    expire project, \"/projects/#{project.id}/show\"\n  end\n  # ...\nend\n</code></pre>\n\n<p>In this case, works, but it is not the best, I have lots of model and lots of sweepers.</p>\n\n<p>What is wrong? Is there another way to do the same?.</p>\n\n<p>Thanks.</p>\n\n<p><strong>Solved</strong></p>\n\n<p>Answer here <a href=\"https://github.com/rails/rails/issues/8096\" rel=\"nofollow\">https://github.com/rails/rails/issues/8096</a></p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13222859,"title":"Ruby sort array on condition in reverse order","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2642182/sorting-an-array-in-descending-order-in-ruby\">Sorting an array in descending order in Ruby</a>  </p>\n</blockquote>\n\n\n\n<p>I want to sort an array of elements based on some condition, except in reverse order. So basically whatever it would have done and then reversed.</p>\n\n<p>So for example I have an array of strings and I want to sort it by decreasing string length</p>\n\n<pre><code>a = [\"test\", \"test2\", \"s\"]\na.sort_by!{|str| str.length}.reverse!\n</code></pre>\n\n<p>While this does the job...is there a way to specify the condition such that the sorting algorithm will do it in reverse?</p>\n"},{"tags":["ruby","rubygems","require","wxruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13222124,"title":"Ruby not finding rubygems or wx modules","body":"<p>I'm running the default Ruby installation (ruby 1.8.7 (2010-01-10 patchlevel 249) [i686-darwin10]) on my Intel iMac. I updated RubyGems and installed the wxruby gem. I'm trying to run the following sample program:</p>\n\n<pre><code>#!/usr/bin/ruby\nrequire \"rubygems\"\nrequire \"wx\"\n\n\nclass MyApp &lt; Wx::App\n    def on_init\n        @frame = Wx::Frame.new(nil, -1, \"The Bare Minimum\")\n        @frame.show()\n    end\nend\n\napp = MyApp.new()\napp.main_loop()\n</code></pre>\n\n<p>And I get the following error:</p>\n\n<pre><code>==&gt; wxruby-test.rb\n/Library/Ruby/Gems/1.8/gems/wxruby-1.9.3-universal-darwin/lib/wxruby2.bundle: dlopen(/Library/Ruby/Gems/1.8/gems/wxruby-1.9.3-universal-darwin/lib/wxruby2.bundle, 9): no suitable image found.  Did find: (LoadError)\n    /Library/Ruby/Gems/1.8/gems/wxruby-1.9.3-universal-darwin/lib/wxruby2.bundle: no matching architecture in universal wrapper - /Library/Ruby/Gems/1.8/gems/wxruby-1.9.3-universal-darwin/lib/wxruby2.bundle\n    from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'\n    from /Library/Ruby/Gems/1.8/gems/wxruby-1.9.3-universal-darwin/lib/wx.rb:12\n    from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:60:in `gem_original_require'\n    from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:60:in `require'\n    from wxruby-test.rb:3\n</code></pre>\n\n<p>If I comment out the require rubygems statement, I get the following error:</p>\n\n<pre><code>==&gt; wxruby-test.rb\nwxruby-test.rb:3:in `require': no such file to load -- wx (LoadError)\n    from wxruby-test.rb:3\n</code></pre>\n\n<p>I'm new to Ruby on the Mac, and I'm sure this is some basic error probably related to paths, but most explanations about the environment variables are aimed at experienced users. If you need more output from other commands, please let me know. I'm running Ruby from the tcsh shell. I'm sure I'm doing something basic wrong, but I'm just stumped.</p>\n"},{"tags":["ruby-on-rails","ruby","devise","acl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13221785,"title":"Rails, devise, acl","body":"<p>I have followed this tut <a href=\"http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html\" rel=\"nofollow\">http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html</a> I want to do something like this:</p>\n\n<pre><code>before_filter :authenticate_user!\nbefore_filter :authenticate_VIP!\nbefore_filter :authenticate_admin!\nbefore_filter :authenticate_somerole!\n</code></pre>\n\n<p>I have tables: roles, users, user_roles and I don't want to create another table (rails g devise VIP create another table). </p>\n\n<p>I want to have methods authenticate_ROLE. How to do this ?</p>\n"},{"tags":["ruby","gd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13069686,"title":"Opening Remote Images to Use on GD2","body":"<p>Is there any way to \"open\" remote images to be used on <a href=\"http://gd2.rubyforge.org/\" rel=\"nofollow\"><code>GD2</code></a>?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13220514,"title":"how to get the id from an object stored in a database in Ruby?","body":"<p>I am new to Ruby on Rails, and I would like to create a very simple website where I can save some citations.\nI have several tables: Citation and Autor, here are the corresponding models.</p>\n\n<pre><code>class Citation &lt; ActiveRecord::Base\n  belongs_to :autor\n  attr_accessible :text, :autor_id\nend\n\n\nclass Autor &lt; ActiveRecord::Base\n  has_many :citations\n  attr_accessible :name\nend\n</code></pre>\n\n<p>I would like that when an user create a new citation that bellow to a new autor, the autor has to be automatically created. </p>\n\n<p>Here is a part of my citations_controller:</p>\n\n<pre><code>def create\n    # Here I check if the autor already exist or not, if not, I create him (The user gave me his name)\n    if !(Autor.exists?(:name =&gt; params[:citation][:autor_id]))\n      Autor.create(:name =&gt; params[:citation][:autor_id])\n    end\n\n    #As I only have the name of the autor, I try to retrieve his Id\n    params[:autor_id] = Autor.where(:name =&gt; params[:citation][:autor_id]).first.id\n\n    @citation = Citation.new(params[:citation])\n\n  end\n</code></pre>\n\n<p>The point is, when I create a new citation, the field autor_id is filled with a 0 not with the correct ID of the autor. I think the mistake is when I try to retrieve the Id from the name, but I don't know how to fix it, and perhaps there is a simpler solution !</p>\n\n<p>Thank you !</p>\n"},{"tags":["ruby","arrays","file","data","reading"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":38,"score":-1,"question_id":13217076,"title":"why does my array read from file contain bytes","body":"<p>im writting a little system that parses lines of data in a txt separated by commas,\nso to be basic about it i read the file lines into an array, then use .each on the array and split everything by \"'\" then push it into the holding array which is returned as the database made from the file, i have made two, the first works fine but its data is stored line by line with a keyword, this one works fine, acess and return all good</p>\n\n<p>im using a file containing text data like this</p>\n\n<hr>\n\n<pre><code>476,TACKLE,40,25,30,0,0,1,A3F,move description string with, punctuation and t's\n477,ANOTHERATTACK,BLAHBLAHBLAH,1,2,3,4\n</code></pre>\n\n<hr>\n\n<p>this would be data parsing kind of right, well </p>\n\n<p>so i go</p>\n\n<hr>\n\n<pre><code>$fs  = File_SYstem.new\n@path = Dir.getwd.to_S + \"/desktop/file.txt\"\n@data_lines = $fs.file_read_lines(@path)\n@data = []\n@data_lines.each do |line|\n  @data &gt;&gt; line.split(',')\nend\nreturn @data\n#this would make an array of the lines, each line being an array of its elements, right?\n\n@data = The_Code_Above_In_A_Class.new(@path)\n=&gt;@data\n\n@data[0]\n=&gt;\"354,FISSURE,10,40,50,blah blah blah, the second half of the text.\"\n\n#hmmmm\n\n@data[0][0]\n=&gt;\"354\"\n</code></pre>\n\n<p>so it seems to work fine, but some times, the numbers at the beginning come back as bytes :O</p>\n\n<p>and for example:</p>\n\n<pre><code>@data.each do |line|\n  puts line[1].to_S #return second element which is name of move\nend\n</code></pre>\n\n<p>this would print a list of the expected names, fine and dandy, but then i get the remaining data i didnt ask for returned below it in an unrecognizable pattern</p>\n\n<p>maybe i cand do this?</p>\n\n<pre><code>array = [1,2,3]\narray = [array,array,array]\narray[2][0] = \"Hello!\"\narray.each do |item|\n  puts item[2]\nend\n =&gt;\"3\"\n\"3\"\n\"Hello!\"\n=&gt;:\n</code></pre>\n\n<hr>\n\n<p>seems to me this should work since im already using close variations of this style somewhere else with succees</p>\n\n<p>now this is a sample of the real 580 line file</p>\n\n<hr>\n\n<pre><code>1,MEGAHORN,Megahorn,000,120,BUG,Physical,85,10,0,00,0,abef,Cool,\"Using its tough and  impressive horn, the user rams into the target with no letup.\"\n2,ATTACKORDER,Attack Order,000,90,BUG,Physical,100,15,0,00,0,befh,Smart,The user calls out its underlings to pummel the target. Critical hits land more easily.\n3,BUGBUZZ,Bug Buzz,046,90,BUG,Special,100,10,10,00,0,bek,Cute,The user vibrates its wings to generate a damaging sound wave. It may also lower the target's Sp. Def stat.\n</code></pre>\n\n<hr>\n\n<p>now this is the class i use to load it up</p>\n\n<pre><code>class Move_Data_Extracter\n  def initialize(path)\n        load $path.to_s + \"/source/string_helper.rb\"\n    #load \"/mnt/sdcard/pokemon/system/source/string_helper.rb\"\n        @path = path.to_s\n    @file_lines = $file_system.file_read_lines(@path.to_s)\n    $movedata = []\n    @file_lines.each do |line|\n      $movedata &lt;&lt; line.split(\",\")\n    end\n  end\n  def get_move_id(move_name)\n    $movedata.each do |move|\n      if move[1].upcase.to_s == move_name.upcase.to_s\n            return move[0].to_i\n      else\n        return \"Move Doesnt Exist In The System!\"\n      end\n    end\n  end\n end\n</code></pre>\n\n<hr>\n\n<p>this is the feedback i got when i accessing the first item in the returned array(s?)</p>\n\n<hr>\n\n<pre><code>irb(main):002:0&gt; $movedata[0]\n=&gt; [\"\\xEF\\xBB\\xBF1\", \"MEGAHORN\", \"Megahorn\", \"000\", \"120\", \"BUG\", \"Physical\", \"8\n5\", \"10\", \"0\", \"00\", \"0\", \"abef\", \"Cool\", \"\\\"Using its tough and impressive horn\n\", \" the user rams into the target with no letup.\\\"\\n\"]\nirb(main):003:0&gt; $movedata[0][0]\n=&gt; \"\\xEF\\xBB\\xBF1\"\nirb(main):004:0&gt;\n</code></pre>\n\n<p>access worked ok this time but the first element is bytes and that each method im trying is going so wrong</p>\n\n<p>can any one figure out whats wrong here?</p>\n"},{"tags":["ruby","xml","savon"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13221661,"title":"Savon seems to be reading only the first port of a multi port soap service","body":"<p>I am using Savon with the following WSDL</p>\n\n<pre><code>&lt;wsdl:definitions xmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\" xmlns:v2bind=\"urn:oasis:names:tc:wsrp:v2:bind\" xmlns=\"http://schemas.xmlsoap.org/wsdl/\" xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\" targetNamespace=\"urn:oasis:names:tc:wsrp:v2:wsdl\"&gt;\n&lt;import namespace=\"urn:oasis:names:tc:wsrp:v2:bind\" location=\"http://localhost:8080/wsrp-portlet/wsdl/wsrp-2.0-bindings.wsdl\"/&gt;\n&lt;wsdl:service name=\"WSRP_v2_Service\"&gt;\n    &lt;wsdl:port binding=\"v2bind:WSRP_v2_Markup_Binding_SOAP\" name=\"WSRP_v2_Markup_Service\"&gt;\n        &lt;soap:address location=\"http://localhost:8080/wsrp-portlet/services/WSRP_v2_Markup_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e\"/&gt;\n    &lt;/wsdl:port&gt;\n    &lt;wsdl:port binding=\"v2bind:WSRP_v2_ServiceDescription_Binding_SOAP\" name=\"WSRP_v2_ServiceDescription_Service\"&gt;\n        &lt;soap:address location=\"http://localhost:8080/wsrp-portlet/services/WSRP_v2_ServiceDescription_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e\"/&gt;\n    &lt;/wsdl:port&gt;\n    &lt;wsdl:port binding=\"v2bind:WSRP_v2_Registration_Binding_SOAP\" name=\"WSRP_v2_Registration_Service\"&gt;\n        &lt;soap:address location=\"http://localhost:8080/wsrp-portlet/services/WSRP_v2_Registration_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e\"/&gt;\n    &lt;/wsdl:port&gt;\n    &lt;wsdl:port binding=\"v2bind:WSRP_v2_PortletManagement_Binding_SOAP\" name=\"WSRP_v2_PortletManagement_Service\"&gt;\n        &lt;soap:address location=\"http://localhost:8080/wsrp-portlet/services/WSRP_v2_PortletManagement_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e\"/&gt;\n    &lt;/wsdl:port&gt;\n&lt;/wsdl:service&gt;\n</code></pre>\n\n<p></p>\n\n<p>When I inspect,</p>\n\n<pre><code>savon.wsdl.endpoint\n</code></pre>\n\n<p>I only get,</p>\n\n<pre><code>#&lt;URI::HTTP:0x00000101eea398 URL:http://localhost:8080/wsrp-portlet/services/WSRP_v2_Markup_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e&gt; \n</code></pre>\n\n<p>Can savon handle a wsdl with multiple port definitions? If not any suggestions on a ruby alternative that does support it?</p>\n"},{"tags":["ruby-on-rails","ruby","file-system"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13149159,"title":"special characters in path for rails send_file","body":"<p>I am using send_file in ROR to access files in my local file system, like this</p>\n\n<pre><code>send_file( path,\n  :disposition =&gt; 'inline',\n  :type =&gt; 'image/jpeg',\n  :x_sendfile =&gt; true )\n</code></pre>\n\n<p>Now for a path <code>/mnt/photos/myself.jpeg</code> this works fine, but then I have also downloads with ampersands in it, like <code>/mnt/photos/friends?firstname=john&amp;lastname=doe</code>. The filename will be cut after the first ampersand, and of course the file is not found.</p>\n\n<p>Is there a simple way to load the file with the ampersand in its name? Apart from renaming the file, of course.</p>\n\n<p>Hm no reply after 4 days... is the question too simple? Or too tough? I had hoped for something obvious...</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":36,"score":3,"question_id":13221597,"title":"Empty gem list, but can use rails --version","body":"<p>I understand that Rails is a gem. Which means when I run </p>\n\n<pre><code>gem list\n</code></pre>\n\n<p>the terminal should echo the name rails for me.</p>\n\n<p>My problem is that I can run</p>\n\n<pre><code>rails --version\n</code></pre>\n\n<p>but when it comes to <code>gem list</code> I only receive <code>*LOCAL GAME LIST*</code> without any text following.</p>\n\n<p>What could be wrong? Is it my understanding?</p>\n\n<p>Thank you and best regards</p>\n"},{"tags":["android","ruby","ios5","message-queue","multiplayer"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13208000,"title":"Backend Framework for Multiplayer Games like Draw something","body":"<p>I want to develop a multiplayer game like Draw something that support iOS and Android and want to know if there is a ready framework for server side that can handel communication (messages) between server and client, and would be great to have it handel game session so i'll only implement my game logic and some extra integration.</p>\n\n<p>I want the game to be scalable and support up to 10,000 concurrent users, so what are the recommendation for the hosting and server architecture?</p>\n\n<p>It would be perfect if there is a Ruby solution as that is what i have experience with it.</p>\n\n<p>Thanks, </p>\n"},{"tags":["ruby","file"],"answer_count":5,"favorite_count":0,"up_vote_count":47,"down_vote_count":0,"view_count":23229,"score":47,"question_id":403239,"title":"How do I move a file with Ruby?","body":"<p>I want to move a file with Ruby. How do I do that?</p>\n"},{"tags":["ruby","web-scraping","watir"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13220248,"title":"Accessing the attribute of a div element in an array of div elements","body":"<p>in the answer to this question <a href=\"http://stackoverflow.com/questions/10397787/accessing-a-div-element-in-an-array-of-li-elements?rq=1\">Accessing a div element in an array of li elements</a>\nand when i look here <a href=\"http://wiki.openqa.org/display/WTR/Collections+of+HTML+Elements\" rel=\"nofollow\">http://wiki.openqa.org/display/WTR/Collections+of+HTML+Elements</a></p>\n\n<p>I dont see or don't understand what i need to do</p>\n\n<p>what i am trying to do is make a spreadsheet with my guilds player_name, player_id and player_lvl.</p>\n\n<p>this is the page that has the guild members.                                              <a href=\"http://game.ageofchampions.com/aoc/?cmd%5B0%5D=112&amp;guild_id=138668\" rel=\"nofollow\">guild page</a> \nher is some sample of the html</p>\n\n<pre><code>&lt;div class=\"guild_board\"&gt;\n\n&lt;div class=\"item_box_guild\" data-playerid=\"1256824509\"&gt;\n   &lt;a onclick=\"doCmd(81,{'player_id':'1256824509'})\"&gt;&lt;div class=\"tile_50\"&gt;\n &lt;div class=\"avatar_container_50\"&gt;\n &lt;div class=\"avatar_image\" style=\"background-image:url(//assets.ageofchampions.com/avatar/09/45/82/56/12/avatar_1351896996145.png);\"&gt;\n &lt;/div&gt;\n&lt;/div&gt;\n &lt;div class=\"over\"&gt;\n   &lt;img src=\"http://profile.ak.fbcdn.net/hprofile-ak-ash4/187582_1256824509_1172546357_q.jpg\"&gt;\n &lt;/div&gt;\n&lt;div class=\"lock\"&gt;&lt;/div&gt;\n &lt;/div&gt;\n&lt;/a&gt;\n &lt;div class=\"content\"&gt;\n  &lt;div class=\"stat\" style=\"width:225px;\"&gt;\n    &lt;a onclick=\"doCmd(81,{'player_id':'1256824509'})\"&gt;~|SR|~ Kariselle&lt;/a&gt; |\n        Level 348 &lt;hr&gt;\n          Battle Score: 23,951,169\n</code></pre>\n\n<p>this code works to get the first member and i could do (=>index (2)) to get the next member and so on. at the momunt we only have 10 members but it could get alot bigger. and if i dont have to I dont want to have to write this for each member.</p>\n\n<pre><code>require 'rubygems'\nrequire 'watir-webdriver'\nrequire 'google_drive'\nb = Watir::Browser.new\nb.goto 'http://game.ageofchampions.com/aoc/?cmd%5B0%5D=112&amp;guild_id=138668'\nb.text_field(:id =&gt; 'email').set 'email'\nb.text_field(:id =&gt; 'pass').set 'psswd'\nb.button(:name =&gt; 'login').click\nsession = GoogleDrive.login('username', 'pass')\nws=session.spreadsheet_by_key('spreadsheethe').worksheets[0]\nb.goto 'game.ageofchampions.com/aoc/?cmd%5B0%5D=112&amp;guild_id=138668'\n#b.divs(:class =&gt; 'item_box_guild').each do |div|\nplayerid_1 = b.div(:class =&gt; 'item_box_guild').attribute_value(:'data-playerid')\n#playerid_1a = puts attribute_value(:'data-playerid')\n#end\nplayername_1 = b.div(:class =&gt; 'item_box_guild').div(:class =&gt; 'stat').a.text\n#playerlvl_1 = b.div(:class =&gt; 'item_box_guild').div(:class =&gt; 'stat').text\n#layerlvl_1a = playerlvl_1\\s+id=\"0\"\\s+value=\"(.+?)\"\n# Gets content of A2 cell.\np ws[2, 1]  #==&gt; \"hoge\"\n\n# Changes content of cells.\n# Changes are not sent to the server until you call ws.save().\nws[1, 1] = \"PLAYER ID\"\nws[1, 2] = \"CHAMPIONS NAME\"\nws[1, 3] = \"LEVEL\"\nws[2, 1] = playerid_1\nws[2, 2] = playername_1\nws[2, 3] = \"still working on lvl\"\nws[3, 1] = \"does this\"\nws[3, 2] = \"still\"\nws[3, 3] = \"work\"\n\nws.save()\n\n# Dumps all cells.\nfor row in 1..ws.num_rows\nfor col in 1..ws.num_cols\np ws[row, col]\nend\nend\n\n# Yet another way to do so.\n#p ws.rows  #==&gt; [[\"fuga\", \"\"], [\"foo\", \"bar]]\n\n# Reloads the worksheet to get changes by other clients.\nws.reload()\n</code></pre>\n"},{"tags":["ruby","ruby-koans"],"answer_count":25,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1204,"score":6,"question_id":4749973,"title":"Ruby Greed Koan - How can I improve my if/then soup?","body":"<p>I'm working my way through the Ruby Koans in order to try and learn Ruby, and so far, so good. I've gotten to the greed koan, which at the time of this writing is 183. I've got a working solution, but I feel like I've cobbled together just a bunch of if/then logic and that I'm not embracing Ruby patterns.</p>\n\n<p>In the following code, are there ways you would point me to more fully embracing Ruby patterns? (My code is wrapped in \"MY CODE [BEGINS|ENDS] HERE\" comments.</p>\n\n<pre><code># Greed is a dice game where you roll up to five dice to accumulate\n# points.  The following \"score\" function will be used calculate the\n# score of a single roll of the dice.\n#\n# A greed roll is scored as follows:\n#\n# * A set of three ones is 1000 points\n#\n# * A set of three numbers (other than ones) is worth 100 times the\n#   number. (e.g. three fives is 500 points).\n#\n# * A one (that is not part of a set of three) is worth 100 points.\n#\n# * A five (that is not part of a set of three) is worth 50 points.\n#\n# * Everything else is worth 0 points.\n#\n#\n# Examples:\n#\n# score([1,1,1,5,1]) =&gt; 1150 points\n# score([2,3,4,6,2]) =&gt; 0 points\n# score([3,4,5,3,3]) =&gt; 350 points\n# score([1,5,1,2,4]) =&gt; 250 points\n#\n# More scoring examples are given in the tests below:\n#\n# Your goal is to write the score method.\n\n# MY CODE BEGINS HERE\n\ndef score(dice)\n\n  # set up basic vars to handle total points and count of each number\n  total = 0\n  count = [0, 0, 0, 0, 0, 0]\n\n  # for each die, make sure we've counted how many occurrencess there are\n  dice.each do |die|\n    count[ die - 1 ] += 1\n  end\n\n  # iterate over each, and handle points for singles and triples\n  count.each_with_index do |count, index|\n    if count == 3\n      total = doTriples( index + 1, total )\n    elsif count &lt; 3\n      total = doSingles( index + 1, count, total )\n    elsif count &gt; 3\n      total = doTriples( index + 1, total )\n      total = doSingles( index + 1, count % 3, total )\n    end\n  end\n\n  # return the new point total\n  total\n\nend\n\ndef doTriples( number, total )\n  if number == 1\n    total += 1000\n  else\n    total += ( number ) * 100\n  end\n  total\nend\n\ndef doSingles( number, count, total )\n  if number == 1\n    total += ( 100 * count )\n  elsif number == 5\n    total += ( 50 * count )\n  end\n  total\nend\n\n# MY CODE ENDS HERE\n\nclass AboutScoringProject &lt; EdgeCase::Koan\n  def test_score_of_an_empty_list_is_zero\n    assert_equal 0, score([])\n  end\n\n  def test_score_of_a_single_roll_of_5_is_50\n    assert_equal 50, score([5])\n  end\n\n  def test_score_of_a_single_roll_of_1_is_100\n    assert_equal 100, score([1])\n  end\n\n  def test_score_of_multiple_1s_and_5s_is_the_sum_of_individual_scores\n    assert_equal 300, score([1,5,5,1])\n  end\n\n  def test_score_of_single_2s_3s_4s_and_6s_are_zero\n    assert_equal 0, score([2,3,4,6])\n  end\n\n  def test_score_of_a_triple_1_is_1000\n    assert_equal 1000, score([1,1,1])\n  end\n\n  def test_score_of_other_triples_is_100x\n    assert_equal 200, score([2,2,2])\n    assert_equal 300, score([3,3,3])\n    assert_equal 400, score([4,4,4])\n    assert_equal 500, score([5,5,5])\n    assert_equal 600, score([6,6,6])\n  end\n\n  def test_score_of_mixed_is_sum\n    assert_equal 250, score([2,5,2,2,3])\n    assert_equal 550, score([5,5,5,5])\n  end\n\nend\n</code></pre>\n\n<p>Thanks so much to any help you can give as I try to get my head around Ruby.</p>\n"},{"tags":["ruby","integer","exponentiation"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":57,"score":4,"question_id":13130557,"title":"Large multiplication output coming out negative in Ruby","body":"<p>I wrote some code that is supposed to sum n^n for 1 &lt;= n &lt;= 1000.\nHere's the code:</p>\n\n<pre><code>sum = 0\n(1..1000).each do |n|\n  sum += n**n\n  puts \"n = #{n}, sum = #{sum}\"\nend\n</code></pre>\n\n<p>For some reason, the output is coming out negative after number 28:</p>\n\n<pre><code>n = 29, sum = -2015400977700573523892329442490139437391867\n</code></pre>\n\n<p>Any idea why this is happening?</p>\n"},{"tags":["ruby","xml","nokogiri"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":8444495,"title":"Nokogiri::XML::SAX stops to invoke start_element","body":"<p>I'm parsing big (130mb now, can be 200+) XML files – exported demos from QLDT (<a href=\"http://sourceforge.net/projects/qldt/\" rel=\"nofollow\">Quake Live Demo Tools</a>). As they are so huge, I'm using <a href=\"http://nokogiri.org/Nokogiri/XML/SAX/Document.html\" rel=\"nofollow\">SAX</a>.<br>\nFor a start, I wanted to find a number of snapshots, which should be near several thousands. But my code shows <code>2</code>. So I've added <code>puts [name,attrs].inspect</code> and have found, that <code>start_element</code> doesn't work after certain line, but program still works several seconds and invokes <code>end_document</code>.</p>\n\n<pre><code>require \"nokogiri\"\ninclude Nokogiri\n\nSTDOUT.sync = true\n\nclass PostCallbacks &lt; XML::SAX::Document\n    def start_element name,attrs\n        @count = (@count||0)+1 if name == \"snapshot\"\n        puts [name,attrs].inspect\n    end\n    def end_document\n        p @count\n    end\nend\n\nparser = XML::SAX::Parser.new PostCallbacks.new\nparser.parse_file \"CTF-spacectf-2011_12_08-15_02_03_gg.dm_73.xml\"\n</code></pre>\n\n<p>Here are last lines of output:</p>\n\n<blockquote>\n  <p>[\"message\", [\"sequence\", \"227474\", \"acknowledge\", \"541\"]]<br>\n  [\"command\", [\"index\", \"8745\"]]</p>\n</blockquote>\n\n<p>And here is this part of XML:</p>\n\n<pre><code>&lt;message sequence=\"227474\" acknowledge=\"541\"&gt;\n    &lt;command index=\"8745\"&gt;chat &amp;quot;03 ^5danielmily^7^7&amp;EC;: ^2eno - we cool now?&amp;quot;&lt;/command&gt;\n    &lt;snapshot serverTime=\"600300\" deltaNum=\"2\" snapFlags=\"4\" areamaskLen=\"1\" areamaskData=\"0xfe\"&gt;\n</code></pre>\n\n<p>UPD: Here is an 8600kb zipped XML: <a href=\"http://dl.dropbox.com/u/13484239/CTF-spacectf-2011_12_08-15_02_03_gg.dm_73.zip\" rel=\"nofollow\">http://dl.dropbox.com/u/13484239/CTF-spacectf-2011_12_08-15_02_03_gg.dm_73.zip</a><br>\nUPD2: I'm going to parse with regexes.<br>\nUPD3: regexes won</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13213135,"title":"Find and delete oldest AVI file recursively","body":"<p>I've been trying to write a Ruby script to find and delete the oldest AVI file in a folder.  I found a <a href=\"http://stackoverflow.com/questions/837606/find-the-oldest-file-recursively-in-a-directory/837840#837840\">script in Python</a> that is very close, and I got a good start on the Ruby solution myself with:</p>\n\n<pre><code>require 'fileutils'\nstat = Sys::Filesystem.stat(\"/\")\nmb_available = stat.block_size * stat.blocks_available / 1024 / 1024\n#if there is less than 130MB free\nif mb_available &lt; 130000\n    require 'find'\n    movie_file_paths = []\n    #grab all the files in the folder\n    Find.find('/Users/jody/Movies') do |path|\n        movie_file_paths &lt;&lt; path if /.*\\.avi/.match(path) != nil\n    end\nend\n</code></pre>\n\n<p>But, I'm having a tough time with the rest.  Any help would be appreciated!</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>This was the solution:</p>\n\n<pre><code>movie_file_paths = []\nDir.glob(\"/Users/jody/Movies/**/*.avi\").each { |file| movie_file_paths &lt;&lt; file if File.file? file }\nmovie_file_paths.sort_by {|f| File.mtime(f)}\ndeleteme = movie_file_paths.first\n</code></pre>\n"},{"tags":["iphone","ios","ruby","uiviewcontroller","rubymotion"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13219433,"title":"How to load a controller when clicking a button with RubyMotion?","body":"<p>Let's say I have 2 controllers A and B. </p>\n\n<p>In A I have:</p>\n\n<pre><code>def viewDidLoad\n  super\n  button = UIButton.buttonWithType UIButtonTypeRoundedRect\n  button.setTitle \"Open B\", forState: UIControlStateNormal\n  button.addTarget(self, action: :open_b, forControlEvents: UIControlEventTouchUpInside)\n  self.view.addSubview button\nend\n\ndef open_b\n  # ?????\nend\n</code></pre>\n\n<p>In B I have another view with its own logic, which is not important.</p>\n\n<p><strong>I want to open B when clicking the button. How should I go and do this?</strong></p>\n\n<p>This must be dead obvious for anyone with some iOS experience, but I can't find how you're supposed to do it. Any pointers are appreciated. A solution in Objectve-C is acceptable and would get my upvote, even if I'd prefer it to be with RubyMotion.</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","erb"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13219475,"title":"Printing elements of array using ERB","body":"<p>I'm trying to print a simple array defined in my controller into my view with a new line for each element. But what it's doing is printing the whole array on one line.</p>\n\n<p>Here's my controller:</p>\n\n<pre><code>class TodosController &lt; ApplicationController\n  def index\n    @todo_array = [ \"Buy Milk\", \"Buy Soap\", \"Pay bill\", \"Draw Money\" ]\n  end\nend\n</code></pre>\n\n<p>Here's my view:</p>\n\n<pre><code>&lt;%= @todo_array.each do |t| %&gt;\n&lt;%= puts t %&gt;&lt;\\br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here's the result:</p>\n\n<pre><code>&lt;\\br&gt; &lt;\\br&gt; &lt;\\br&gt; &lt;\\br&gt; [\"Buy Milk\", \"Buy Soap\", \"Pay bill\", \"Draw Money\"]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":13220165,"title":"Eager loading of rails lib","body":"<p>It looks like this issue will be solved in Rails 4:\n<a href=\"http://blog.plataformatec.com.br/2012/08/eager-loading-for-greater-good/\" rel=\"nofollow\">http://blog.plataformatec.com.br/2012/08/eager-loading-for-greater-good/</a>\nbut until then, I'm wondering how to eager-load modules/classes in my <code>/lib</code>.</p>\n\n<p>In IRB it appears that they are loaded on-demand the first time I try to access:</p>\n\n<pre><code>Foo::Bar.constants\n=&gt; []\n\nFoo::Bar::Service\n=&gt; Foo::Bar::Service\n\nFoo::Bar.constants\n=&gt; [:ServiceBase, :Service]\n</code></pre>\n\n<p>I have several other classes in that module, and my code depends on being able to look them up using <code>Foo::Bar.const_defined?</code> at runtime - how do I ensure all <code>Foo::Bar</code>'s classes get loaded at startup?</p>\n\n<p>I'm already using <code>config.autoload_paths += %W(#{config.root}/lib)</code> in <code>application.rb</code>.</p>\n"},{"tags":["ruby","json"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":97,"score":1,"question_id":11743835,"title":"Force JSON serialization of numbers to specific precision","body":"<p>Consider the following code that is intended to round numbers to the nearest one-hundredth and serialize the result to JSON:</p>\n\n<pre><code>require 'json'\ndef round_to_nearest( value, precision )\n  (value/precision).round * precision\nend\na = [1.391332, 0.689993, 4.84678]\nputs a.map{ |n| round_to_nearest(n,0.01) }.to_json\n#=&gt; [1.3900000000000001,0.6900000000000001,4.8500000000000005]\n</code></pre>\n\n<p>Is there a way to use JSON to <strong>serialize all numbers with a specific level of precision</strong>?</p>\n\n<pre><code>a.map{ ... }.to_json( numeric_decimals:2 )\n#=&gt; [1.39,0.69,4.85]\n</code></pre>\n\n<p>This could be either with the Ruby built-in JSON library or another JSON gem.</p>\n\n<p><strong>Edit</strong>: As noted in comments to answers below, I'm looking for a general solution to all JSON serialization for arbitrary data that includes numbers, not specifically a flat array of numbers.</p>\n\n<hr>\n\n<p><em><sup>Note that the above problem can be fixed in this specific case by rewriting the method:</sup></em></p>\n\n<pre><code>def round_to_nearest( value, precision )\n  factor = 1/precision\n  (value*factor).round.to_f / factor\nend\n</code></pre>\n\n<p><em><sup>...but this does not solve the general desire to force a precision level during serialization.</sup></em></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13219315,"title":"How to disable all form_for input fields in Ruby on Rails app?","body":"<p>I am trying to DRY up my Rails application a bit, so I would like to render a form in my <code>show</code> view but <em>disable</em> all input fields.</p>\n\n<pre><code>// show.html.erb\n\n&lt;%= form_for(@project) do |f| %&gt;\n  &lt;%= render 'fields', :f =&gt; f %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What would be the best way to do that?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby","arrays","index","element","minimum"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2663,"score":4,"question_id":4964256,"title":"Ruby: How to find the index of the minimum array element?","body":"<p>Is there any way to rewrite this more elegant? I think, that it's a bad piece of code and should be refactored.</p>\n\n<pre><code>&gt;&gt; a = [2, 4, 10, 1, 13]\n=&gt; [2, 4, 10, 1, 13]\n&gt;&gt; index_of_minimal_value_in_array = a.index(a.min)\n=&gt; 3\n</code></pre>\n"},{"tags":["ruby","sinatra","haml","rack","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13182034,"title":"Sinatra haml page is called twice","body":"<pre><code>  get '/test' do\n     session[:my_session_id] = generate_random_id()\n     puts 'begin haml debug'\n     haml :\"static/haml_page\", :locals=&gt;{:session_id =&gt; session[:my_session_id]}\n  end\n</code></pre>\n\n<p>I see in a log that a page above is constantly called twice:</p>\n\n<pre><code>begin haml debug\n127.0.0.1 - - [02/Nov/2012 00:00:01] \"GET / HTTP/1.1\" 200 4317 1.5421\n127.0.0.1 - - [02/Nov/2012 00:00:01] \"GET /js/base/jquery.pjax.002902.js HTTP/1.1\" 304 - 0.0234\n[2012-11-02 00:00:01] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true\n127.0.0.1 - - [02/Nov/2012 00:00:01] \"GET /css/docs.002902.css HTTP/1.1\" 200 165 0.1086\n.................................\nbegin haml debug\n127.0.0.1 - - [02/Nov/2012 00:00:04] \"GET / HTTP/1.1\" 200 4317 1.9288\n</code></pre>\n\n<p>It makes me have some issues. Why is this happening?</p>\n"},{"tags":["ruby","mongodb","sorting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13214067,"title":"How to sort by two values in MongoDB-Ruby?","body":"<p>So I have a Ruby Script where I find all the documents with the type \"homework\" in the \"grades\" collection a \"students\" DB (MongoDB) The thing is, following these instructions:</p>\n\n<p><strong><a href=\"http://api.mongodb.org/ruby/current/file.TUTORIAL.html\" rel=\"nofollow\">http://api.mongodb.org/ruby/current/file.TUTORIAL.html</a></strong></p>\n\n<p>I try to sort by score and then by student id (or viceversa) with:</p>\n\n<pre><code>homeworks.sort(:score, 1).sort(:student_id, 1).to_a\n</code></pre>\n\n<p>And running the file (\"mongo.rb\") I get an output of homeworks sorted by score (ascending) but not by student ID... (They're scrambled) If I try to switch values, I get the array ordered by student_id (ascending) but not by score... (In that case, score values are scrambled)</p>\n\n<p>How can I Sort ascending by two arguments in mongo using ruby??</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":85,"score":1,"question_id":11189139,"title":"How to keep a transient variable as part of ActiveRecord","body":"<p>I would like to show a variable (which is actually a List) as part of f.select(..) function in Rails3.2, so that the selected value is stored in a different attribute in the ActiveRecord object. How do I declare the above List variable as a transient variable in ActiveRecord, so that ActiveRecord doesn't try to store this.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13219706,"title":"Split string to substring by N characters","body":"<p>I am just wondering if there is a better way to split string to substrings by N characters:</p>\n\n<pre><code>\"something\" (by 4 characters) -&gt; [\"some\", \"omet\", \"meth\", \"ethi\", \"thin\", \"hing\"]\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>n = 4\ns = \"something\"\nresult = []\n\n0.upto(s.size - n) do | idx |\n    result &lt;&lt; s[idx..idx+n-1]\nend\n\np result\n</code></pre>\n"},{"tags":["ruby","coercion","coerce","type-coercion"],"answer_count":1,"favorite_count":5,"up_vote_count":18,"down_vote_count":0,"view_count":1628,"score":18,"question_id":2799571,"title":"In Ruby, how does coerce() actually work?","body":"<p>It is said that when we have a class <code>Point</code> and knows how to perform <code>point * 3</code> like the following:</p>\n\n<pre><code>class Point\n  def initialize(x,y)\n    @x, @y = x, y\n  end\n\n  def *(c)\n    Point.new(@x * c, @y * c)\n  end\nend\n\npoint = Point.new(1,2)\np point\np point * 3\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>#&lt;Point:0x336094 @x=1, @y=2&gt;\n#&lt;Point:0x335fa4 @x=3, @y=6&gt;\n</code></pre>\n\n<p>but then, </p>\n\n<pre><code>3 * point\n</code></pre>\n\n<p>is not understood:</p>\n\n<blockquote>\n  <p><code>Point</code> can't be coerced into <code>Fixnum</code> (<code>TypeError</code>)</p>\n</blockquote>\n\n<p>So we need to further define an instance method <code>coerce</code>:</p>\n\n<pre><code>class Point\n  def coerce(something)\n    [self, something]\n  end\nend\n\np 3 * point\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>#&lt;Point:0x3c45a88 @x=3, @y=6&gt;\n</code></pre>\n\n<p>So it is said that <code>3 * point</code> is the same as <code>3.*(point)</code>. That is, the instance method <code>*</code> takes an argument <code>point</code> and invoke on the object <code>3</code>.</p>\n\n<p>Now, since this method <code>*</code> doesn't know how to multiply a point, so</p>\n\n<pre><code>point.coerce(3)\n</code></pre>\n\n<p>will be called, and get back an array:</p>\n\n<pre><code>[point, 3]\n</code></pre>\n\n<p>and then <code>*</code> is once again applied to it, is that true?</p>\n\n<p>Now, this is understood and we now have a new <code>Point</code> object, as performed by the instance method <code>*</code> of the <code>Point</code> class.</p>\n\n<p>The question is:</p>\n\n<ol>\n<li><p>Who invokes <code>point.coerce(3)</code>? Is it Ruby automatically, or is it some code inside of <code>*</code> method of <code>Fixnum</code> by catching an exception?  Or is it by <code>case</code> statement that when it doesn't know one of the known types, then call <code>coerce</code>?</p></li>\n<li><p>Does <code>coerce</code> always need to return an array of 2 elements?  Can it be no array?  Or can it be an array of 3 elements?</p></li>\n<li><p>And is the rule that, the original operator (or method) <code>*</code> will then be invoked on element 0, with the argument of element 1?  (Element 0 and element 1 are the two elements in that array returned by <code>coerce</code>.)   Who does it?  Is it done by Ruby or is it done by code in <code>Fixnum</code>?  If it is done by code in <code>Fixnum</code>, then it is a \"convention\" that everybody follows when doing a coercion?</p>\n\n<p>So could it be the code in <code>*</code> of <code>Fixnum</code> doing something like this:</p>\n\n<pre><code>class Fixnum\n  def *(something)\n    if (something.is_a? ...)\n    else if ...  # other type / class\n    else if ...  # other type / class\n    else\n    # it is not a type / class I know\n      array = something.coerce(self)\n      return array[0].*(array[1])   # or just return array[0] * array[1]\n    end\n  end\nend\n</code></pre></li>\n<li><p>So it is really hard to add something to <code>Fixnum</code>'s instance method <code>coerce</code>?  It already has a lot of code in it and we can't just add a few lines to enhance it (but will we ever want to?)</p></li>\n<li><p>The <code>coerce</code> in the <code>Point</code> class is quite generic and it works with <code>*</code> or <code>+</code> because they are transitive.  What if it is not transitive, such as if we define Point minus Fixnum to be:</p>\n\n<pre><code>point = Point.new(100,100)\npoint - 20  #=&gt; (80,80)\n80 - point  #=&gt; (-80,-80)\n</code></pre></li>\n</ol>\n"},{"tags":["ruby","eventmachine","em-proxy"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13219743,"title":"Forward requests to internal server","body":"<p>I want to forward requests based on their path, using em-proxy. Basically, what starts with <code>/stream</code> to a certain port, and the rest to another.</p>\n\n<p>This is what I got so far. </p>\n\n<pre><code>require \"em-proxy\"\n\nProxy.start(:host =&gt; \"0.0.0.0\", :port =&gt; 8080) do |conn|\n\n  conn.server :main, :host =&gt; \"127.0.0.1\", :port =&gt; 3000\n  conn.server :streaming, :host =&gt; \"127.0.0.1\", :port =&gt; 9292\n\n  conn.on_data do |data|\n    data\n  end\n\nend\n</code></pre>\n\n<p>What I can't figure out is how can I determine the current url from inside the \"on_*\" callbacks the gem provides.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activesupport"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13218123,"title":"Activesupport titlecase() with bang (.titlecase!)?","body":"<p>I currently have a string with customer names that I am titlecasing with:</p>\n\n<pre><code>@customer_name = @customer_name.titlecase\n</code></pre>\n\n<p>But this seems a bit long-winded. When I try to do:</p>\n\n<pre><code>@customer_name.titlecase!\n</code></pre>\n\n<p>I get a no method error. Does <code>titlecase!</code> exist? It seems odd that there wouldn't be a way to do this, since there is a <code>downcase!</code>, for example.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","relational-database"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13218814,"title":"Ruby on Rails has many relation table","body":"<p>I have a table <strong>rb</strong> wich has many <strong>interfaces</strong>, then each interface has many <strong>interface_graph_data</strong>. Now my rb interface has_many relation seems to work fine, my only problem is the interface interface_graph_data relation. Here are my models.</p>\n\n<pre><code>class Rb &lt; ActiveRecord::Base\n    validates_presence_of :name\n    validates_presence_of :ip\n    validates_uniqueness_of :ip\n    validates_presence_of :username\n    validates_presence_of :password\n\n    has_many :interfaces\n    has_many :interfacegraphdata, :through =&gt; :interfaces\nend\n</code></pre>\n\n<p><br /></p>\n\n<pre><code>class Interface &lt; ActiveRecord::Base\n    has_many :interfacegraphdata\nend\n</code></pre>\n\n<p><br /></p>\n\n<pre><code>class InterfaceGraphData &lt; ActiveRecord::Base\nend\n</code></pre>\n"},{"tags":["ruby","eigenclass"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13218723,"title":"Implicit context and eigenclasses","body":"<p>I recently found an <a href=\"http://yugui.jp/articles/846\" rel=\"nofollow\">interesting article</a> on implicit contexts in Ruby, and I found the experience quite mind opening.\nI understood that Ruby holds a reference not only to <code>self</code> (the <em>default method receiver</em>), but also to the <em>current class</em> (also known as <em>default definee</em> or <code>`klass'</code>).</p>\n\n<p>From the article, It should be correct to assume that <code>class</code> definition sets both <code>self</code> and the <em>current class</em> to the class that is being defined; as far as we consider <em>normal</em> method definition (i.e. not using the <em>dot syntax</em> to define singleton methods), in the context of method definition with <code>def</code>, <code>self</code> refers to the receiving object, and the <em>current class</em> isn't changed.</p>\n\n<p>The reason i find safe to not consider the <em>dot syntax</em> for defining is that Ruby also offers an explicit way to open the eigenclass of a class, and the very thing I'm interested is understanding how these two implicit contexts are managed when opening a eigenclass.</p>\n\n<p>Using <code>def</code> with the well known syntax for opening a eigenclass:</p>\n\n<pre><code>class &lt;&lt; A\n  p self\n\n  def foo\n    # ...\n  end\nend\n</code></pre>\n\n<p>defines foo as a <em>singleton method</em> of <code>A</code>, i.e. an <em>instance method</em> of its eigenclass (be it <code>A'</code>). This code also prints <code>#&lt;Class:A&gt;</code>, so is it correct to say that the <code>&lt;&lt;</code> syntax sets both <code>self</code> and the <em>current class</em> to <code>A'</code>?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13218613,"title":"in the initialize of a ruby class, what is the difference between @name or self.name?","body":"<p>I know it makes sense to use self.name, but what does @name mean in the following code?</p>\n\n<pre><code>class NewGame &lt; Game\n  attr_accessor :name\n  def initialize(name, options={})\n    super\n    self.name = name\n  end\n\n  def add_game(name)\n     @name = name\n  end\nend\n</code></pre>\n\n<p>Is that even legit? Did I made a mistake?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13179607,"title":"Spawning an array","body":"<p>Not sure that my question is correct, but in general I would do the following:</p>\n\n<p>Given a code snippet like:</p>\n\n<pre><code>[{ &lt;some events&gt;, \"close\"}, { &lt;some other events&gt;, \"close\"}].each do |events|\n    it \"should handle events\" do\n        ...\n    end\n    ...\nend\n</code></pre>\n\n<p>I would like to augment the events' array. Say there are 2 ways to <em>close</em>: <code>\"close\"</code> (same) and <code>\"stop\"</code>. Which means, I would like to write some code that will check 4 sequences: <code>[{&lt;some events&gt;, \"close\"}, {&lt;some other events&gt;, \"close\"}, {&lt;some events&gt;, \"stop\"}, {&lt;some other events&gt;, \"stop\"}]</code>.</p>\n\n<p>What would be the proper (well-styled in Ruby) way to code it?</p>\n\n<p><strong>Update</strong>: the <code>&lt;some events&gt;</code> and <code>&lt;some other events&gt;</code> are sequences of strings (this is just to clarify). </p>\n\n<p><strong>Update N2:</strong> <code>stop</code> and <code>close</code> in a more general case can appear in the middle of the sequence as well. </p>\n\n<p><strong>Update N3:</strong> it just <em>might</em> be that having a single final sequence at <code>do</code> will be more convenient. I might be wrong here.</p>\n\n<p><strong>Update N4:</strong> Example (just to make it all clear):</p>\n\n<blockquote>\n  <p>initial messages: \"open\", \"click_btn1\", \"click_btn2\", \n  \"open\", \"click_btn2\", \"click_btn3\", </p>\n  \n  <p>desired result: \"open\", \"click_btn1\", \"click_btn2\", \"close\" \"open\",\n  \"click_btn1\", \"click_btn2\", \"close\" \"open\", \"click_btn2\",\n  \"click_btn3\", \"stop\" \"open\", \"click_btn2\", \"click_btn3\", \"stop\"</p>\n</blockquote>\n"},{"tags":["ruby","xpath","nokogiri"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":31,"score":4,"question_id":13218239,"title":"Getting Data Between Elements in Nokogiri","body":"<p>I'm trying to get the text between two elements in nokogiri and pair the data with the text in the element in front of it.</p>\n\n<pre><code>html  = \n\"&lt;website&gt;\n    &lt;maindeck&gt;\n        1&lt;card&gt;Blood Crypt&lt;/card&gt;\n        2&lt;card&gt;Temple Garden&lt;/card&gt;\n    &lt;/maindeck&gt;\n    &lt;maindeck&gt;\n        3&lt;card&gt;Angel of Serenity&lt;/card&gt;\n        4&lt;card&gt;Forest&lt;/card&gt;\n    &lt;/maindeck&gt;\n&lt;/website&gt;\"\n</code></pre>\n\n<p>I want to end up with an array like this</p>\n\n<pre><code>#=&gt; [[1,\"Blood Crypt\"],[2,\"Temple Garden\"]]\n</code></pre>\n\n<p>A previous example provided this as an answer, but I'm unsure of what it does/ how to use it.</p>\n\n<pre><code>/*/div[1]/following-sibling::text()[1]\n</code></pre>\n\n<p>Original link : <a href=\"http://stackoverflow.com/questions/3911656/grabbing-text-between-two-elements-in-nokogiri\">grabbing text between two elements in nokogiri?</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13218378,"title":"Getting the contents of a hash","body":"<pre><code>{\"test_url\"=&gt;\"http://test.com/123.jpg\"} \n</code></pre>\n\n<p>is my output from</p>\n\n<pre><code>&lt;% @results.each do |t| %&gt;\n    &lt;%= t.image.extract!(\"test_url\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How can i just get the contents of test_url? so <a href=\"http://test.com/123.jpg\" rel=\"nofollow\">http://test.com/123.jpg</a></p>\n"},{"tags":["ruby-on-rails","ruby","windows","git-bash"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":376,"score":0,"question_id":9267420,"title":"Rails using gitbash and ruby installer. rails command not found","body":"<p>I am trying to get Ruby on Rails going on my Windows 7 machine. I am using gitbash and have install ruby using ruby installer. All my gems have installed successfully (Rails 3.0.7), but when I try to run a command like <code>rails s</code> I get <code>sh.exe\": rails: command not found</code></p>\n\n<p><code>echo $PATH</code> gives me:</p>\n\n<p><code>/c/Users/Dave/bin:.:/usr/local/bin:/mingw/bin:/bin:/c/Ruby192/bin:/c/Program Files/Common Files/Microsoft Shared/Windows Live:/c/Program Files/NVIDIA Corporation/PhysX/Common:/c/Windows/system32:/c/Windows:/c/Windows/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/c/Program Files/Common Files/Adobe/AGL:/c/Program Files/QuickTime/QTSystem/:/c/Program Files/Common Files/Microsoft Shared/Windows Live</code></p>\n\n<p>Since the path for Ruby is in there I am at a bit of a loss for how to be able to start the rails server.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":559,"score":1,"question_id":8047651,"title":"No Javascript runtime on windows when running rails server","body":"<p>I'm completely new to Ruby on Rails, and I'm having trouble setting it up on my <strong>Windows PC</strong>.  I have successfully followed the instructions on <a href=\"http://rubyonrails.org/download\" rel=\"nofollow\">http://rubyonrails.org/download</a>.  However, when I go to run the <code>rails server</code> command I come up with this output:</p>\n\n<pre><code>C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs/runtimes.rb:47:in `a\nutodetect': Could not find a JavaScript runtime. See https://github.com/sstephen\nson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:5:in\n `&lt;module:ExecJS&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:4:in\n `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `block (2 levels) in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `block in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler.rb:1\n22:in `require'\n        from C:/RoR/tickets/config/application.rb:7:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `block in &lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `tap'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>When i go to the website <a href=\"https://github.com/sstephenson/execjs\" rel=\"nofollow\">https://github.com/sstephenson/execjs</a> I'm still uncertain of how to proceed.  <strong>Can someone point me in the right direction (remember I'm a newbie)?</strong>  Thanks!</p>\n"},{"tags":["ruby","twitter","oauth-provider"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13188978,"title":"invalid_credentials with omniauth on heroku","body":"<p>I implemented a project configured with OmniAuth/Twitter and OmniAuth/Facebook. in development mode with any problem. </p>\n\n<p>But when i tried on heroku. it refused to work. </p>\n\n<pre><code> use Rack::Session::Cookie\n  use OmniAuth::Builder do\n    provider :twitter, ENV['TWITTER_APP_ID'], ENV['TWITTER_SECRET']\n    provider :facebook, ENV['FACEBOOK_APP_ID'], ENV['FACEBOOK_SECRET'], :scope =&gt; 'email'\n  end\n</code></pre>\n\n<p>Heroku logs</p>\n\n<pre><code>012-11-02T03:28:47+00:00 app[web.1]: E, [2012-11-02T03:28:47.339453 #58] ERROR -- omniauth: (twitter) Authentication failure! invalid_credentials: OAuth::Unauthorized, 401 Unauthorized\n2012-11-02T03:28:47+00:00 heroku[router]: GET p####.herokuapp.com/auth/twitter/callback?oauth_token=r6l3GpwmxH38W8Q9WltcWs9PqyyGxxiGAUqXGFhmKs&amp;oauth_verifier=O9HD6jLaEL1aRUcORIebGEZIQHbqtcgB012q5aZlCE dyno=web.1 queue=0 wait=0ms service=368ms status=302 bytes=9\n2012-11-02T03:28:47+00:00 app[web.1]: 92.160.179.137 - - [02/Nov/2012 03:28:47] \"GET /auth/failure?message=invalid_credentials&amp;origin=https%3A%2F%2F p####.herokuapp.com%2Flogin&amp;strategy=twitter HTTP/1.1\" 200 3160 0.0033\n2012-11-02T03:28:47+00:00 heroku[router]: GET  p####.herokuapp.com/auth/failure?message=invalid_credentials&amp;origin=https%3A%2F%2F p####.herokuapp.com%2Flogin&amp;strategy=twitter dyno=web.1 queue=0 wait=0ms service=8ms status=200 bytes=3160\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13216826,"title":"Can't run rails command when installing Rails without RVM","body":"<p>I can't get to install rails correctly, after doing \"sudo gem install rails\", all goes well, but if I try doing \"rails -v\", I get \"Rails is not currently installed on this system...\", I'm not using RVM, I installied Ruby through Homebrew.</p>\n\n<p>The rails executable is in \"/usr/local/Cellar/ruby/1.9.3-p286/bin/rails\", but even if I add that path to my $PATH it won't find it, or something else in RubyGems is going wrong...</p>\n"},{"tags":["ruby","selenium","webkit","capybara","capybara-webkit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13207201,"title":"Get image file using ruby & capybara","body":"<p>It is image tag on the page accessed by capybara via HTTPS protocol:</p>\n\n<pre><code>&lt;img src=\"path\"&gt;\n</code></pre>\n\n<p>Is it any way to get image file from the page using capybara with any kind of driver? </p>\n\n<p>I can not use something like File.read('path') because image is also accessible via HTTPS only. My latest researches brought me to such kind of solution:</p>\n\n<ol>\n<li>Visit page</li>\n<li>Save page to png (webkit driver has such useful ability)</li>\n<li>Crop image</li>\n</ol>\n\n<p>But I <strong>do believe</strong> that pretty solution exists.</p>\n\n<p><strong>Edited 1:</strong></p>\n\n<p>I've tried out padde's solution, but here is response body:</p>\n\n<pre><code>&lt;html&gt;&lt;head&gt;&lt;title&gt;Object moved&lt;/title&gt;&lt;/head&gt; \n    &lt;body&gt;\n        &lt;h2&gt;Object moved to &lt;a href=\\\"/Bledy/Blad404.aspx?aspxerrorpath=/CaptchaType.ashx\\\"&gt;here&lt;/a&gt;.&lt;/h2&gt; \n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>Edited 2:</strong></p>\n\n<pre><code>&gt; curl -I image_path\n\n5860cf30abf5d5480\nHTTP/1.1 302 Found\nCache-Control: private\nContent-Length: 168\nContent-Type: text/html; charset=utf-8\nLocation: /Bledy/Blad404.aspx?aspxerrorpath=/CaptchaType.ashx\nServer: Microsoft-IIS/7.5\nX-AspNet-Version: 4.0.30319\nX-Powered-By: ASP.NET\nDate: Sat, 03 Nov 2012 17:18:55 GMT\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13217336,"title":"Keeping object across controllers","body":"<p>I am playing with the heroku api in Rails and have come across a potential issue.</p>\n\n<p>After submitting a login form i am instantiating the heroku object.</p>\n\n<pre><code>heroku = Heroku::API.new(:username =&gt; USERNAME, :password =&gt; PASSWORD)\n</code></pre>\n\n<p>I would then like to use the heroku object in all controllers to further querying the api. I have tried @heroku, @@heroku and $heroku, but none work. Is this possible?</p>\n\n<p>The only solution i have found it to use the api to fetch the users api key, store this in a session then use it to re-instantiate the heroku object within each controller method. Is this the best / only solution?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13217058,"title":"what is the difference between gsub using / or \"?","body":"<p>I am trying to use gsub to replace <code>\"?\"</code> and <code>\".\"</code> with empty space.</p>\n\n<p>I realize that is a difference between <code>gsub(\".\", \"\")</code> and <code>gsub(/./, \"\")</code>, but I don't know what it is. Can Someone explain?</p>\n\n<p>Also, <code>gsub(\"?\",\"\")</code> seems to work, and <code>gsub(/?/,\"\")</code> doesn't work. \nHow can we make <code>gsub(/?/,\"\")</code> work?</p>\n"},{"tags":["ruby","condition"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13209414,"title":"Dynamic condition symbol in \"if\"","body":"<p>I want to create a dynamic condition. It will look like  </p>\n\n<pre><code>Model.send(\"attr_name\") &gt; 0 ? true : false\n</code></pre>\n\n<p>But how can I write symbol \">\" dynamically ?</p>\n"},{"tags":["ruby","file","chomp"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":38,"score":0,"question_id":13216158,"title":"Unchomping a file, then appending a string","body":"<p>I have a text file with path name <code>file</code>, and some content <code>string</code> that I want to append to it. I want to do something close to</p>\n\n<pre><code>File.open(file, \"a\"){|io| io.puts(string)}\n</code></pre>\n\n<p>but if the original content of the file does not end with an endline character <code>$/</code>, I want to insert one before <code>string</code>. What is the most effective way to do this?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13216378,"title":"How does ActiveRecord link records together?","body":"<p>So this has been surprisingly difficult to locate a quick answer to. I'm using ActiveRecord in a pure console app, and I have my classes set up like so:</p>\n\n<pre><code>class Owner &lt; ActiveRecord::Base\nhas_many :profiles\nend\n\nclass Profile &lt; ActiveRecord::Base\nhas_many :lines\nbelongs_to :owner\nend\n\nclass Line &lt; ActiveRecord::Base\nbelongs_to :profiles\nend\n</code></pre>\n\n<p>Now normally i'd do something like..</p>\n\n<pre><code>Profile.create( :thing =&gt; \"thing\", :otherthing =&gt; \"otherthing\" )\n</code></pre>\n\n<p>How does AR know to link this instance of profile to an owner? What about a specific owner already in the database? How do I tell it? How would I do all of the links at once? (line, to profile, to owner)?</p>\n"},{"tags":["ruby","sinatra","system"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13207009,"title":"passing arguaments to a system call in Rails, but not plain ruby program","body":"<p>Ubuntu 12.04</p>\n\n<p>Sinatra 1.3.3</p>\n\n<p>Why does passing an argument to a ruby system call (%x[] or ``) give me a 'not found' error in my sinatra app?  The same code works fine in a normal ruby script running from the same directory.</p>\n\n<p>I have a file test.rb like this</p>\n\n<pre><code>output = %x[\"ls\"] \np output\n</code></pre>\n\n<p>When I run it with \"ruby test.rb\" I get the contents of the current directory in the console, as expected.</p>\n\n<p>If I modify the program to give an argument to the system call like so:</p>\n\n<pre><code>output = %x[\"ls sub_dir/\"] \np output\n</code></pre>\n\n<p>I get the contents of sub_dir, which sits in the current directory, as expected.</p>\n\n<p>So far so good.</p>\n\n<p>Now if I make a Sintra app with a post method:</p>\n\n<pre><code>require 'rubygems'\nrequire 'bundler/setup'\nrequire 'sinatra'\n\npost \"/\" do\n output = x[\"ls\"]\n return output\nend\n</code></pre>\n\n<p>The response to a Post call to \"/\" returns the contents of the current directory, which includes 'sub_dir', as expected.</p>\n\n<p>If I try to add the argument to the system call to the sinatra app like so:</p>\n\n<pre><code>require 'rubygems'\nrequire 'bundler/setup'\nrequire 'sinatra'\n\npost \"/\" do\n output = x[\"ls sub_dir/\"]\n return output\nend\n</code></pre>\n\n<p>the response is nil and there is an error in the console:</p>\n\n<blockquote>\n  <p>sh: 1: ls sub_dir/: not found</p>\n</blockquote>\n\n<p>Why does adding a parameter to a system call in my sinatra app cause it to crash, when the same code called from a plain ruby script, run from the same location works perfectly.</p>\n\n<p>By the way, the 'ls' example shown here is not the command I really need to run, so please don't explain a different way to get this information. I have an executable file that takes a file name as a parameter that I need to run, which behaves exactly the same way.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":[".net","ruby","cucumber","bdd","specflow"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":440,"score":3,"question_id":5671421,"title":"BDD testing framework","body":"<p>We are a Microsoft shop, have a reasonably mature technology stack and have very skilled .net resources.  We have been using TDD since we started and now are venturing into the BDD space. Our work is delivered by agile teams, using strong agile practices.</p>\n\n<p>Our end testable product is web, wpf and windows forms.</p>\n\n<p>The testing resources have introduced BDD and would like to learn and use Ruby and Cucumber to perform the testing.  There has been some resistance from the developers, as we would prefer to stick with the same technology stack and use Specflow (or similar).  The argument from the testers is that it is simpler to learn.</p>\n\n<p>I want to be sure that the developers and testers are not being biased, and that it is worthwhile introducing another technology.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":69,"score":3,"question_id":13214846,"title":"Is there an Equivalent to `Enumerable` for defining mathematical operations in Ruby?","body":"<p>I am creating a wrapper class for Ruby's NArray (numeric array).  I would like my class to respond to all of the standard mathematical operators (+, +=, -, -=, *, *=, etc) in the same way that an instance of NArray does.  I know how to make wrappers for <code>Array</code>s and other <code>Enumerable</code> objects, include <code>Enumerable</code> in the wrapper, and define an <code>each</code> method that just redirects to the wrapped <code>Enumerable</code> object.  I would like something similar with the NArray.  Is there a single module to include/method I can define that will define the whole bevy of mathematical operators to target the wrapped NArray?  Or do I have to define them all manually?</p>\n"},{"tags":["ruby-on-rails","ruby","sorting","hash"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":60,"score":0,"question_id":13216092,"title":"How to sort a hash by value in descending order and output a hash in ruby?","body":"<pre><code>output.sort_by {|k, v| v}.reverse\n</code></pre>\n\n<p>and for keys</p>\n\n<pre><code>h = {\"a\"=&gt;1, \"c\"=&gt;3, \"b\"=&gt;2, \"d\"=&gt;4}\n=&gt; {\"a\"=&gt;1, \"c\"=&gt;3, \"b\"=&gt;2, \"d\"=&gt;4}\n\nHash[h.sort]\n</code></pre>\n\n<p>Right now I have these two. But I'm trying to sort hash in descending order by value so that it will return</p>\n\n<pre><code>=&gt; {\"d\"=&gt;4, \"c\"=&gt;3, \"b\"=&gt;2, \"a\"=&gt;1 }\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>Edit:\nlet me post the whole code.</p>\n\n<pre><code>def count_words(str)\n  output = Hash.new(0)\n  sentence = str.gsub(/,/, \"\").gsub(/'/,\"\").gsub(/-/, \"\").downcase\n  words = sentence.split()\n  words.each do |item|\n    output[item] += 1 \n  end\n  puts Hash[output.sort_by{ |_, v| -v }]\n  return Hash[output.sort_by{|k, v| v}.reverse]\nend\n</code></pre>\n"},{"tags":["ruby","methods","setter","indexer"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":582,"score":4,"question_id":2380796,"title":"Creating a setter method that takes extra arguments in Ruby","body":"<p>I'm trying to write a method that acts as a setter and takes some extra arguments besides the assigned value. Silly example:</p>\n\n<pre><code>class WordGenerator\n  def []=(letter, position, allowed)\n    puts \"#{letter}#{allowed ? ' now' : ' no longer'} allowed at #{position}\"\n  end\n\n  def allow=(letter, position, allowed)\n    # ...\n  end\nend\n</code></pre>\n\n<p>Writing it as an indexer works and I can call it like this:</p>\n\n<pre><code>gen = WordGenerator.new\n\ngen['a', 1] = true\n# or explicitly:\ngen.[]=('a', 1, true)\n</code></pre>\n\n<p>But when I try any of the following, the interpreter complains:</p>\n\n<pre><code>gen.allow('a', 1) = false # syntax error\ngen.allow=('a', 1, false) # syntax error\n</code></pre>\n\n<p>Why won't this work, am I missing the obvious?</p>\n"},{"tags":["ruby","ssl","openssl","ruby-enterprise-edition"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":980,"score":1,"question_id":6070881,"title":"Ruby Enterprise Edition + OpenSSL -> \"certificate verify failed\"","body":"<p>I'm having a bit of a nightmare trying to get REE playing nicely with SSL.</p>\n\n<p>Whenever I connect to an SSL site:</p>\n\n<pre><code>require 'open-uri'\nopen 'https://www.google.com'\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>/Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/net/http.rb:586:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/net/http.rb:586:in `connect'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/net/http.rb:553:in `do_start'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/net/http.rb:542:in `start'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:242:in `open_http'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:616:in `buffer_open'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:164:in `open_loop'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:162:in `catch'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:162:in `open_loop'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:132:in `open_uri'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:518:in `open'\nfrom /Users/jon/.rvm/rubies/ree-1.8.7-2011.03/lib/ruby/1.8/open-uri.rb:30:in `open'\n</code></pre>\n\n<p>It works fine under Ruby 1.9.2 or the regular 1.8.7.  I tried repackaging OpenSSL and installing ree to link against that, as mentioned <a href=\"http://beginrescueend.com/packages/openssl/\" rel=\"nofollow\">on the RVM OpenSSL page</a>, but it had no effect.  I'm on OS X 10.6.7, but I'm seeing the same problem with our OpenSolaris REE installation.</p>\n\n<p>Any suggestions would be massively appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","random"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":13204634,"title":"Freeze a random number in Ruby","body":"<p>I'm trying to build something that will randomly pick two objects from a list in Ruby (using Rails) and then perform basic operations on those objects. My current set up involves randomly picking numbers at the start - using these numbers to get objects from the database and then rendering those objects to index. However, now I'm trying to edit these objects using AJAX I'm running into a problem.</p>\n\n<p>It seems that, when I click on a link that the random number in being recalculated and is causing my AJAX function not to work.</p>\n\n<p>I've included (what I believe is) all relevant code below but let me know if you need to see anything else to get to the bottom of this. I'm looking to get the titles of the old animals and (ideally their previous ratings and) their new ratings to appear at the bottom of the page.</p>\n\n<p>Thanks,</p>\n\n<p>Matt</p>\n\n<p><code>controllers/static_pages.rb</code></p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\nrespond_to :html, :js\nbefore_filter :pickanimals\n\ndef pickanimals\n    @allAnimals = Animal.all\n    @random_no = rand(@allAnimals.length)\n    @animal = @allAnimals[@random_no]\n    @allAnimals.delete_at(@random_no)\n    @newRandom = rand(@allAnimals.length)\n    @animal2 = @allAnimals[@newRandom]\nend\n\n  def index\n    respond_to do |format|\n        format.html\n        format.js\n    end\nend\n\n  def help\n  end\n\n  def about\n  end\n\n  def contact\n  end\n\ndef league\nend\n\ndef voting\n    @votedAnimal = Animal.find(params[:id])\n    if @votedAnimal == @animal\n        @animal.rating += 1\n        @animal2.rating -= 1\n    else\n        @animal.rating -= 1\n        @animal2.rating += 1    \n    end\n    Animal.transaction do\n        @animal.save!\n        @animal2.save!\n    end\n    respond_to do |format|\n        format.html { redirect_to root_path }\n        format.js  \n    end\nend\nend\n</code></pre>\n\n<p><code>app/views/static_pages/index.html.erb</code></p>\n\n<pre><code>&lt;div class=\"center hero-unit\"&gt;\n&lt;h1&gt;Animal Attack&lt;/h1&gt;\n&lt;p&gt; Who will win when nature collides? &lt;/p&gt;\n&lt;div class=\"animalcontainerright\"&gt;\n&lt;h2&gt; &lt;%= @animal.name %&gt; &lt;/h2&gt; \n&lt;%= link_to image_tag(@animal.attachment.url(:large)), voting_path(@animal.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div class=\"animalcontainerleft\"&gt;\n&lt;h2&gt; &lt;%= @animal2.name %&gt; &lt;/h2&gt;\n&lt;%= link_to image_tag(@animal2.attachment.url(:large)), voting_path(@animal2.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal2.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div id=\"animalfacts\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><code>routes.rb</code></p>\n\n<pre><code>AnimalAttack::Application.routes.draw do\n\nresources :animals\n\nroot to: 'static_pages#index'\nmatch '/help' =&gt; 'static_pages#help'\nmatch '/about' =&gt; 'static_pages#about'\nmatch '/contact' =&gt; 'static_pages#contact'\nmatch '/league' =&gt; 'static_pages#league'\nmatch '/voting/:id' =&gt; 'static_pages#voting'\n\nend\n</code></pre>\n\n<p><code>rake routes</code></p>\n\n<pre><code>    animals GET    /animals(.:format)          animals#index\n        POST   /animals(.:format)          animals#create\n new_animal GET    /animals/new(.:format)      animals#new\nedit_animal GET    /animals/:id/edit(.:format) animals#edit\n animal GET    /animals/:id(.:format)      animals#show\n        PUT    /animals/:id(.:format)      animals#update\n        DELETE /animals/:id(.:format)      animals#destroy\n   root        /                           static_pages#index\n   help        /help(.:format)             static_pages#help\n  about        /about(.:format)            static_pages#about\ncontact        /contact(.:format)          static_pages#contact\n league        /league(.:format)           static_pages#league\n               /animals(.:format)          animals#new\n               /voting/:id(.:format)       static_pages#voting\n</code></pre>\n"},{"tags":["ruby","irc","bots"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2183,"score":2,"question_id":2356040,"title":"My Ruby IRC bot doesn't connect to the IRC server. What am I doing wrong?","body":"<pre><code>require \"socket\"\n\nserver = \"irc.rizon.net\"\nport = \"6667\"\nnick = \"Ruby IRC Bot\"\nchannel = \"#0x40\"\n\ns = TCPSocket.open(server, port)\ns.print(\"USER Testing\", 0)\ns.print(\"NICK #{nick}\", 0)\ns.print(\"JOIN #{channel}\", 0)\n</code></pre>\n\n<p>This IRC bot doesn't connect to the IRC server, What am I doing wrong?</p>\n"},{"tags":["ruby","nokogiri"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":44,"score":1,"question_id":13215159,"title":"Extracting values scoped inside a Nokogiri each block","body":"<p>I'm trying to create a function that will scrape the filmography of actors from wikipedia pages. This is an example of the code</p>\n\n<pre><code>doca = Nokogiri::HTML(open(\"http://en.wikipedia.org/wiki/Kevin_Bacon\"))\n\ngrandparent = doca.xpath('//div[@id=\"mw-content-text\"]').children() \nchild = []\n\ngrandparent.each {|node|\n  node.children.each{|x|\n    if x['id'] == \"Films\"\n      child = node.next_element.children\n      break\n    end\n  }\n}\n</code></pre>\n\n<p>Each element of the child array now contains one row of the filmography table. What i really want is to save the href link for each film into an array but am having trouble accessing them as they are well nested within each. Any help greatly appreciated</p>\n"},{"tags":["ruby","sidekiq"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13213499,"title":"Can multiple sidekiq instances process the same queue","body":"<p>I'm not familiar with the internals of Sidekiq and am wondering if it's okay to launch several Sidekiq instances with the same configuration (processing the same queues).</p>\n\n<p>Is it possible that 2 or more Sidekiq instances will process the same message from a queue?</p>\n\n<p>UPDATE:<br>\nI need to know if there is a possible conflict, when running Sidekiq on more than 1 machine</p>\n"},{"tags":["ruby","google-sketchup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13199920,"title":"Legible inspect from Sketchup Ruby API","body":"<p>Some of the objects I'm creating in my Sketchup Plugin contain nested array properties. They are difficult to read in Sketchup's Ruby Console when calling object.inspect.</p>\n\n<p>Is it possible to use <a href=\"https://github.com/michaeldv/awesome_print\" rel=\"nofollow\">Awesome Print</a> from within a Sketchup Plugin? I don't believe the Sketchup Ruby Console supports syntax highlighting - can I hack <code>ap</code> to write to a real console? Or write the output of <code>ap</code> to a file?</p>\n\n<p>I'm running Sketchup using Wine - so for all practical purposes... I'm on Windows.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2185,"score":1,"question_id":1996864,"title":"Generate n unique random integers in ruby / rails","body":"<p>Im trying to generate n unique random numbers between 1 and max </p>\n\n<p>I tried the following code but doesn't work (returns repeated numbers)</p>\n\n<pre><code>r = [ ]\nn.times { v = rand(max) while r.include? v ; r &lt;&lt; v}\n</code></pre>\n\n<p>Whats wrong with it? Thanks</p>\n\n<p>added:</p>\n\n<p>max is thousands</p>\n\n<p>n is 10</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","tdd"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13212410,"title":"RSpec with Ruby on Rails - Wrong number of arguments (1 for 0) when testing routes","body":"<p>I tried testing routes and just copied the example from the rspec-rails documentation.</p>\n\n<pre><code>describe \"routing to profiles\" do\n  it \"routes /profile/:username to profile#show for username\" do\n    expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n      :controller =&gt; \"profiles\",\n      :action =&gt; \"show\",\n      :username =&gt; \"jsmith\"\n    )\n  end\nend\n</code></pre>\n\n<p>I got the following error when running RSpec:</p>\n\n<pre><code>Failures:\n\n  1) routing to profiles routes /profile/:username to profile#show for username\n     Failure/Error: expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n     ArgumentError:\n       wrong number of arguments (1 for 0)\n     # ./spec/routing/test_spec.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 0.001 seconds\n1 example, 1 failure\n</code></pre>\n\n<p>What's going wrong here?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","ruby","faker"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":45,"score":0,"question_id":13214637,"title":"Generate unique integer in range using Faker gem","body":"<p>This seems like it should be simple but I can't find an answer anywhere!</p>\n\n<p>I'm building a sample_data rake file in Rails to populate my db using the Faker gem. (though I don't think I need that gem for just generating integers) </p>\n\n<p>Some of the fields need to be an integer within a set range but each must be unique.  For instance: </p>\n\n<pre><code>10.times do |a|\n  a.special_number = rand(1..10)\nend\n</code></pre>\n\n<p>works well except for the fact that the numbers aren't unique...  </p>\n"},{"tags":["ruby","email"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":52,"score":0,"question_id":12993578,"title":"Why am I getting =0A inside emails being sent, where there should be a line break?","body":"<p>I'm getting <code>=0A</code> inside my emails where there should be a line break.</p>\n\n<pre><code>@article = DB[:posts][:nodeview_id =&gt; view, :nodeview =&gt; 'article']    \nPony.mail(:html_body =&gt; @article[:content], :reply_to =&gt; @email, :subject =&gt; \"New article #{@article[:title]}\", :headers =&gt; { \"X-MC-Tags\" =&gt; \"feedback\" } )\n</code></pre>\n\n<p>And #@article[:content]} in this context, is </p>\n\n<blockquote>\n  <p>apples</p>\n  \n  <p>bananas</p>\n</blockquote>\n\n<p>inside the database, no <code>\\n</code> or <code>&lt;br&gt;</code> tags.</p>\n\n<p>Here's how Pony is configured.</p>\n\n<pre><code>Pony.options = { :from =&gt; 'Compesh &lt;donotreply@compesh.com&gt;', :to =&gt; 'blahblahblah@emails.com', \n                   :via =&gt; :smtp, :via_options =&gt; { \n                      :address =&gt; 'smtp.mandrillapp.com', :port =&gt; '587', \n                      :user_name =&gt; 'XXX', :password =&gt; 'XXXXXX'\n                      },\n                   :headers =&gt; { \"X-MC-AutoText\" =&gt; \"yes\" }, :charset =&gt; 'utf-8' \n\n                 }\n</code></pre>\n\n<p>But in my emails I get</p>\n\n<blockquote>\n  <p>apples=0Abananas</p>\n</blockquote>\n\n<p>Pony doesn't let me choose the content type, I don't think.</p>\n"},{"tags":["ruby","class"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13213939,"title":"User Defined Classes Ruby errors","body":"<p>In my ruby class I have to make a user defined class with many variables. SO far I've created a class relating to guitars and Ive looked over the code myself for a while and can't figure out why I am getting errors on line 52/when I try to print out the examples to test the class</p>\n\n<pre><code># Guitar\n# Source code in /classes/person.rb\n\n# Guitar class with instance variables @name, @brand, @type @strings and\n# method take_strings.\n\nclass Guitar\n\n  # initialize method is called when user invokes Guitar.new.\n  def initialize(the_name, the_brand, the_type, the_strings)\n    @name = the_name\n    @brand = the_brand\n    @type = the_type\n    @strings = the_strings\n  end\n\n  # Define getters.\n  def name\n    return @name\n  end\n\n  def brand\n    return @brand\n  end\n\n  def type\n    return @type\n\n  def strings\n    return @strings\n  end\n.\n  def strings=(value)\n    @strings = value\n  end\n\n  def to_s\n    return \"#{name}; #{brand}; #{type}; #{strings}.\"\n  end\n\nend\n\n\nguitars = [ ]\n\nguitars &lt;&lt; Guitar.new(\"Stratocaster\", \"Fender\", \"Solid Body\", 6)\nguitars &lt;&lt; Guitar.new(\"Les Paul\", \"Gibson\", \"Solid Body\", 6)\nguitars &lt;&lt; Guitar.new(\"White Falcon\", \"Gretsch\", \"Semi-Hollow, 6)\n\n# Print all guitars\nguitars.each do |g|\n  print g, \"\\n\"\nend\n</code></pre>\n"},{"tags":["ruby","rake"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":2995,"score":6,"question_id":7319262,"title":"Problem to run comand rake","body":"<p>Im trying run the comand rake but i not getting. When I run \"rake db:create:all\" of the following message:</p>\n\n<pre><code>/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/version.rb:4: warning: already initialized constant MAJOR\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/version.rb:5: warning: already initialized constant MINOR\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/version.rb:6: warning: already initialized constant BUILD\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/version.rb:3: warning: already initialized constant NUMBERS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/version.rb:9: warning: already initialized constant VERSION\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake.rb:26: warning: already initialized constant RAKEVERSION\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/early_time.rb:17: warning: already initialized constant EARLY\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/alt_system.rb:32: warning: already initialized constant WINDOWS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/application.rb:28: warning: already initialized constant DEFAULT_RAKEFILES\nWARNING: Possible conflict with Rake extension: String#ext already exists\nWARNING: Possible conflict with Rake extension: String#pathmap already exists\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/task_arguments.rb:73: warning: already initialized constant EMPTY_TASK_ARGS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/invocation_chain.rb:49: warning: already initialized constant EMPTY\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_utils.rb:10: warning: already initialized constant RUBY\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_utils.rb:84: warning: already initialized constant LN_SUPPORTED\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/dsl_definition.rb:143: warning: already initialized constant Commands\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:44: warning: already initialized constant ARRAY_METHODS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:47: warning: already initialized constant MUST_DEFINE\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:51: warning: already initialized constant MUST_NOT_DEFINE\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:55: warning: already initialized constant SPECIAL_RETURN\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:61: warning: already initialized constant DELEGATING_METHODS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:364: warning: already initialized constant DEFAULT_IGNORE_PATTERNS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake/file_list.rb:370: warning: already initialized constant DEFAULT_IGNORE_PROCS\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake.rb:64: warning: already initialized constant FileList\n/Users/junior/.rvm/gems/ruby-1.9.2-p290@global/gems/rake-0.9.2/lib/rake.rb:65: warning: already initialized constant RakeFileUtils\nrake aborted!\nstack level too deep\n</code></pre>\n\n<p>But no create of database.</p>\n\n<p>Some can help me ?</p>\n"},{"tags":["ruby","gcc","nginx","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13181990,"title":"Compiling passenger-install-nginx-module; \"C compiler gcc is not found\"","body":"<p>I am in the middle of a process of installing Redmine served with passenger and nginx with <a href=\"http://englebienne.be/install-redmine-on-ubuntu-11-04-vps-served-by-nginx-passenger/\" rel=\"nofollow\">this tutorial</a>. With the <code>passenger-install-nginx-module</code>, it works fine and during compiling it outputs an error with this,</p>\n\n<pre><code>Compiling and installing Nginx...\n# sh ./configure --prefix='/etc/nginx' --with-http_ssl_module --with-http_gzip_static_module --with-cc-opt='-Wno-error' --with-pcre='/tmp/root-passenger-3197/pcre-8.31' --add-module='/var/lib/gems/1.8/gems/passenger-3.0.18/ext/nginx'\nchecking for OS\n + Linux 3.2.0-32-generic-pae i686\nchecking for C compiler ... not found\n\n./configure: error: C compiler gcc is not found\n\n--------------------------------------------\n\nIt looks like something went wrong\n</code></pre>\n\n<p>I don't understand why it cannot find gcc, but in the precheck step it said that gcc is found,</p>\n\n<pre><code>Checking for required software...\n\n * GNU C++ compiler... found at /usr/bin/g++\n * The 'make' tool... found at /usr/bin/make\n * A download tool like 'wget' or 'curl'... found at /usr/bin/wget\n * Ruby development headers... found\n * OpenSSL support for Ruby... found\n * RubyGems... found\n * Rake... found at /usr/bin/rake\n * rack... found\n * Curl development headers with SSL support... found\n * OpenSSL development headers... found\n * Zlib development headers... found\n</code></pre>\n\n<p>I then <code>apt-get</code> the possible gcc packages, but none were installed/updated because I already have them.</p>\n\n<p>EDIT: </p>\n\n<p>Packages I've tried with gcc,</p>\n\n<pre><code>gcc-4.4 g++-4.4 libstdc++6-4.4-dev gcc\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>nginx block for the redmine,</p>\n\n<pre><code>server {\n\n    server_name         redmine.domain.com;\n\n    access_log          /var/www/redmine.access.log;\n    error_log           /var/www/redmine.error.log;\n\n    root                /var/www/domain.com/redmine/public;\n\n    passenger_enabled   on;\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Now it looks like the issue is something to do with <code>passenger_root</code> and <code>passenger_ruby</code>, although I have included it in the nginx.conf now, but I'm not certain if they are the correct paths (what could I do to find the correct ones?)</p>\n\n<p>My nginx.conf</p>\n\n<pre><code>user www-data;\nworker_processes 4;\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections 768;\n    # multi_accept on;\n}\n\nhttp {\n\n    ##\n    # Basic Settings\n    ##\n\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    keepalive_timeout 65;\n    types_hash_max_size 2048;\n    server_tokens off;\n\n    # server_names_hash_bucket_size 64;\n    # server_name_in_redirect off;\n\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    ##\n    # Logging Settings\n    ##\n\n    access_log /var/log/nginx/access.log;\n    error_log /var/log/nginx/error.log;\n\n    ##\n    # Gzip Settings\n    ##\n\n    gzip on;\n    gzip_disable \"msie6\";\n\n    # gzip_vary on;\n    # gzip_proxied any;\n    # gzip_comp_level 6;\n    # gzip_buffers 16 8k;\n    # gzip_http_version 1.1;\n    # gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;\n\n    ##\n    # nginx-naxsi config\n    ##\n    # Uncomment it if you installed nginx-naxsi\n    ##\n\n    #include /etc/nginx/naxsi_core.rules;\n\n    ##\n    # nginx-passenger config\n    ##\n    # Uncomment it if you installed nginx-passenger\n    ##\n\n    #passenger_root /usr;\n    #passenger_ruby /usr/bin/ruby;\n\n    passenger_root /var/lib/gems/1.8/gems/passenger-3.0.18;\n    passenger_ruby /usr/bin/ruby1.8;\n\n    ##\n    # Virtual Host Configs\n    ##\n\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n}\n\n\n#mail {\n#   # See sample authentication script at:\n#   # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript\n# \n#   # auth_http localhost/auth.php;\n#   # pop3_capabilities \"TOP\" \"USER\";\n#   # imap_capabilities \"IMAP4rev1\" \"UIDPLUS\";\n# \n#   server {\n#       listen     localhost:110;\n#       protocol   pop3;\n#       proxy      on;\n#   }\n# \n#   server {\n#       listen     localhost:143;\n#       protocol   imap;\n#       proxy      on;\n#   }\n#}\n</code></pre>\n\n<p>How would I fix this issue?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":2,"view_count":4766,"score":6,"question_id":1634913,"title":"goto command in ruby?","body":"<p>is there a way to start at a specified line ? like a goto command ?</p>\n"},{"tags":["ruby","mechanize","mechanize-ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13186289,"title":"getaddrinfo error with Mechanize","body":"<p>I wrote a script that will go through all of the customers in our database, verify that their website URL works, and try to find a twitter link on their homepage. We have a little over 10,000 URLs to verify. After a fraction of if the urls are verified, we start getting getaddrinfo errors for every URL.</p>\n\n<p>Here's a copy of the code that scrapes a single URL:</p>\n\n<pre><code>def scrape_url(url) \n  url_found = false \n  twitter_name = nil \n\n  begin \n    agent = Mechanize.new do |a| \n      a.follow_meta_refresh = true \n    end \n\n    agent.get(normalize_url(url)) do |page| \n      url_found = true \n      twitter_name = find_twitter_name(page) \n    end \n\n    @err &lt;&lt; \"[#{@current_record}] SUCCESS\\n\" \n  rescue Exception =&gt; e \n    @err &lt;&lt; \"[#{@current_record}] ERROR (#{url}): \" \n    @err &lt;&lt; e.message \n    @err &lt;&lt; \"\\n\" \n  end \n\n  [url_found, twitter_name] \nend\n</code></pre>\n\n<p>Note: I've also run a version of this code that creates a single Mechanize instance that gets shared across all calls to scrape_url. It failed in exactly the same fashion.</p>\n\n<p>When I run this on EC2, it gets through almost exactly 1,000 urls, then returns this error for the remaining 9,000+:</p>\n\n<pre><code>getaddrinfo: Temporary failure in name resolution\n</code></pre>\n\n<p>Note, I've tried using both Amazon's DNS servers and Google's DNS servers, thinking it might be a legitimate DNS issue. I got exactly the same result in both cases.</p>\n\n<p>Then, I tried running it on my local MacBook Pro. It only got through about 250 before returning this error for the remainder of the records:</p>\n\n<pre><code>getaddrinfo: nodename nor servname provided, or not known\n</code></pre>\n\n<p>Does anyone know how I can get the script to make it through all of the records?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":11667426,"title":"Rails: control ordering of query parameters in url_for?","body":"<p>I'd like to generate a URL where the \"p=1\" query param appears at the end of the URL, like:</p>\n\n<pre><code>/path?foo=X&amp;bar=Y&amp;p=1\n</code></pre>\n\n<p>Is it possible to control the ordering of query parameters when generating URLs via:</p>\n\n<pre><code>url_for(params.merge({ p: page_num }))\n</code></pre>\n\n<p>?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I tried <a href=\"http://stackoverflow.com/users/1396395/chucke\">ChuckE's</a> <a href=\"http://stackoverflow.com/a/11668620/93995\">suggestion below</a>. It turns out that in Ruby 1.9 Hashes are already ordered, so the code in <code>ActiveSupport::OrderedHash</code> is effectively no-op'd. You can verify with Ruby 1.9 that order is preserved:</p>\n\n<pre><code>&gt;&gt; h = {one: 1, two: 2, three: 3 }\n{:one=&gt;1, :two=&gt;2, :three=&gt;3}\n&gt;&gt; f = h.except(:one)\n{:two=&gt;2, :three=&gt;3}\n&gt;&gt; f[:one] = 1\n1\n&gt;&gt; f\n{:two=&gt;2, :three=&gt;3, :one=&gt;1}\n</code></pre>\n\n<p>However, <code>url_for</code> <em>still</em> puts the \"p\" param first. It seems that any potential solution will need to address how <code>url_for</code> iterates the hash.</p>\n"},{"tags":["ruby","dsl"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":50,"score":1,"question_id":13210291,"title":"block like parameter for Ruby DSL","body":"<p>I have a ruby code that currently look like this:</p>\n\n<pre><code>grades.sum{|g| g.grade * g.weight}\n</code></pre>\n\n<p>For a user maintained DSL, I would like to implement something like this:</p>\n\n<pre><code>grades.sum('grade' * 'weight')\n</code></pre>\n\n<p>Is this possible?</p>\n"},{"tags":["ruby-on-rails","ruby","erb","mailto"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13208482,"title":"Extracting Data from an Id tag (ruby)","body":"<p>I am still learning and been re-searching the topic for couple of hours.</p>\n\n<p>The following code in my views displays the email address in the forum</p>\n\n<pre><code>&lt;form id=\"user_details\" action=\"&lt;%= request.path %&gt;\" method=\"post\" &gt;\n&lt;output id=\"email\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>What I am trying to do is make the email text a hyperlink (just like mailto). I just have no idea what the right syntax for this would be.</p>\n\n<p>Thank you so much!</p>\n"},{"tags":["ruby","gem","rack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13212827,"title":"How can I make a ruby gem's binary file act as rackup?","body":"<p>I have a gem. It can optionally be run as a command line app <code>myapp_cli</code>, or as an app with a local web ui <code>myapp_web</code>.</p>\n\n<p>When working on my app, I can run <code>bundle exec myapp_cli</code> for the command line UI, or<br>\nI can run <code>bundle exec rackup</code> for the web UI.</p>\n\n<p>Now I'd like <code>bin/myapp_web</code> to essentially be a synonym for rackup. So when someone installs my gem, they can just run <code>myapp_cli</code> or <code>myapp_web</code>. </p>\n\n<p>Is there a nice way of doing that?</p>\n\n<p>I can make my <code>myapp_web</code> look like</p>\n\n<pre><code>Rack::Handler::WEBrick.run(\n      App.new,\n      :Port =&gt; 9000\n  )\n</code></pre>\n\n<p>but that doesn't give me all the goodies that rackup gives me.</p>\n"},{"tags":["javascript","jquery","ruby","ajax","sinatra"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13209548,"title":"Jquery Ajax request to Sinatra app","body":"<p>I've been at this for a while, but am missing something. I've just set up a simple Sinatra app returning JSON:</p>\n\n<pre><code>get '/json' do\n  content_type :json\n  $data.to_json\nend\n</code></pre>\n\n<p>This is working fine, and then the javascript I'm using to do a cross domain request is </p>\n\n<pre><code>$.getJSON(\"http://domain.com/json?callback=?\", function(data) {\n   console.log(data);\n});\n</code></pre>\n\n<p>Unfortunately with this I just keep getting the error in the console <code>Uncaught SyntaxError: Unexpected token :</code> and although I've tried a just using the <code>$.ajax</code> method instead, I still get the same result. </p>\n\n<p>Is this an error on my server or client side code? any help appreciated. </p>\n"},{"tags":["ruby","watir","watir-webdriver"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12189295,"title":"watir webdriver error resolving host","body":"<p>Just have a simple script to automate a firefox browser:\nJust have a simple script to automate a firefox browser:</p>\n\n<pre><code>require 'rubygems'\nrequire 'watir-webdriver'\n# Initialize watir firefox browser\n$browser = Watir::Browser.new :ff , :profile =&gt; 'default'\n</code></pre>\n\n<p>Leads to the following error which I havent been able to figure out. Is there a TCP port that is blocked or something?.I am using my office pc btw , the code works fine on my home pc.</p>\n\n<pre><code>C:/Ruby193/lib/ruby/1.9.1/net/http.rb:762:in `initialize': getaddrinfo: No such\nhost is known.  (SocketError)\n        from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:762:in `open'\n        from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:762:in `block in connect'\n        from C:/Ruby193/lib/ruby/1.9.1/timeout.rb:54:in `timeout'\n        from C:/Ruby193/lib/ruby/1.9.1/timeout.rb:99:in `timeout'\n        from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:762:in `connect'\n        from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:755:in `do_start'\n        from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:744:in `start'\n        from C:/Ruby193/lib/ruby/1.9.1/net/http.rb:1284:in `request'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/remote/http/default.rb:76:in `response_for'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/remote/http/default.rb:38:in `request'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/remote/http/common.rb:40:in `call'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/remote/bridge.rb:598:in `raw_execute'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/remote/bridge.rb:92:in `create_session'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/remote/bridge.rb:68:in `initialize'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/firefox/bridge.rb:28:in `initialize'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/common/driver.rb:31:in `new'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver/common/driver.rb:31:in `for'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.22.2/lib/s\nelenium/webdriver.rb:65:in `for'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/watir-webdriver-0.6.1/lib/watir\n-webdriver/browser.rb:35:in `initialize'\n        from sic_class.rb:8:in `new'\n        from sic_class.rb:8:in `&lt;main&gt;'\n</code></pre>\n\n<p>There is no proxy, I am using windows 7, watir webdriver 0.6.1 and firefox 13.01</p>\n"},{"tags":["ruby","couchdb","sinatra","couchrest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":11129046,"title":"CouchDB: weird query_parse_error with curl, not with Ruby","body":"<p>I'm hosting my Couch instance on iriscouch.com and doing some testing with a simple Sinatra app, using CouchRest Model.</p>\n\n<p>Here's a simple model I'm using:</p>\n\n<pre><code>class User &lt; CouchRest::Model::Base\n  property :first_name, String\n  property :last_name, String\n  timestamps!\n\n  design do\n    view :by_first_name\n  end\nend\n</code></pre>\n\n<p>I'm successfully creating new users with:</p>\n\n<pre><code>User.create(:first_name =&gt; \"Stonewall\", :last_name =&gt; \"Jackson\")\n</code></pre>\n\n<p>Executing <code>User.by_first_name.all</code> results in this HTTP request:</p>\n\n<pre><code>http://test_admin:pwd@testytest.iriscouch.com:80/blt/_design/User/_view/by_first_name?include_docs=true&amp;reduce=false\n\"Accept\"=&gt;\"application/json\"\n\"Accept-Encoding\"=&gt;\"gzip, deflate\"\n\"Content-Type\"=&gt;\"application/json\"\n</code></pre>\n\n<p>This is executed by RestClient, via CouchRest. No problems there.</p>\n\n<p>But when I try to <code>curl</code>this URL, I get complaints from Couch about the <code>include_docs</code> parameter:</p>\n\n<pre><code>{\"error\":\"query_parse_error\",\"reason\":\"Query parameter `include_docs` is invalid for reduce views.\"}\n</code></pre>\n\n<p>I'd like to understand what's going on here. Why is <code>include_docs</code>a problem only when using curl?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13206463,"title":"retrieving pdf(file) from database in ruby on rails","body":"<p>I am able to successfully store uploaded pdf in database using binary datatype in database. Now i want to retrieve that pdf and store in variable something like mypdf = xxx.pdf , so that i can pass that pdf in few of my methods. I want to do in ruby or rails.</p>\n\n<p>let me rephrase what i mean. i want to retrieve pdf file which is already stored in database. i know for eg this code in controller will render pdf locally.  send_data @attachment.data, :filename => @attachment.filename, :type => @attachment.content_type  but i don't want to show the pdf. i want to assign the pdf to variable and later on pass that pdf to my method </p>\n\n<p>Thanks for help </p>\n"},{"tags":["ruby","rake","version","redmine"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":169,"score":1,"question_id":11135084,"title":"Rake at wrong version despite fresh uninstall/install procedures","body":"<p>I am trying to install RedMine on a server.</p>\n\n<p>During the procedures <a href=\"http://www.redmine.org/projects/redmine/wiki/RedmineInstall\" rel=\"nofollow\">as explained here</a> i am supposed to run</p>\n\n<pre><code>rake generate_secret_token\n</code></pre>\n\n<p>However, i am getting this error:</p>\n\n<pre><code>(in /home/var/redmine)\nrake aborted!\nuninitialized constant Rake::DSL\n/home/var/redmine/Rakefile:7\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>After some research i discovered that rake 0.8.7 is supposedly having problems with this (that, at least, is how i understood it) and that i am supposed to use rake 0.9.2.2</p>\n\n<p>I tried adding </p>\n\n<pre><code>gem 'rake', '0.9.2.2'\n</code></pre>\n\n<p>to my Gemfile.</p>\n\n<p>I checked</p>\n\n<pre><code>rake --version\n</code></pre>\n\n<p>And get</p>\n\n<pre><code>rake, version 0.8.7\n</code></pre>\n\n<p>I ran</p>\n\n<pre><code>gem uninstall rake\n</code></pre>\n\n<p>Which succeeded, according to the output.</p>\n\n<p>Then i ran</p>\n\n<pre><code>gem install rake -v=0.9.2.2\n</code></pre>\n\n<p>And the output was</p>\n\n<pre><code>Successfully installed rake-0.9.2.2\n1 gem installed\nInstalling ri documentation for rake-0.9.2.2...\nInstalling RDoc documentation for rake-0.9.2.2...\n</code></pre>\n\n<p>However, when then calling</p>\n\n<pre><code>rake --version\n</code></pre>\n\n<p>I still get</p>\n\n<pre><code>rake, version 0.8.7\n</code></pre>\n\n<p>I also experimented with adding </p>\n\n<pre><code>gem 'rake', '0.8.7'\n</code></pre>\n\n<p>to my Gemfile for redmine. However, then i get this response when running rake</p>\n\n<pre><code>You have requested:\nrake = 0.8.7\n\nThe bundle currently has rake locked at 0.9.2.2.\nTry running `bundle update rake`\n</code></pre>\n\n<p>What am i doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ruby","authentication","oauth","single-sign-on"],"answer_count":2,"favorite_count":4,"up_vote_count":12,"down_vote_count":0,"view_count":228,"score":12,"question_id":10215831,"title":"Rails authentication across apps/servers","body":"<p>I've been developing my rails apps whilst keeping them as modular as possible. I'm trying to implement different parts underneath as services.</p>\n\n<p>Say an example of Facebook:<br>\na) A <strong>MainApp</strong> that allows the user to have a wall, posts, etc.<br>\nb) A <strong>PhotoApp</strong> that stores photos, allows the user to see his photos, etc. This is a standalone app that will have a REST API that can be used by MainApp as well.</p>\n\n<p>I was thinking of using OAuth as a Single Sign On solution (as in this tutorial <a href=\"http://blog.joshsoftware.com/2010/12/16/multiple-applications-with-devise-omniauth-and-single-sign-on/\">http://blog.joshsoftware.com/2010/12/16/multiple-applications-with-devise-omniauth-and-single-sign-on/</a>) where each app will be authorized via OAuth and will get access to the current user session based on the cookie.</p>\n\n<p><strong><em>First question:</em></strong> Is this a viable solution?</p>\n\n<p><strong><em>Second question:</em></strong> I want to be able to call the <strong>PhotoApp</strong> API from the <strong>MainApp</strong> server (not from the user's browser). How would authentication work in this situation?</p>\n\n<p><strong><em>Third question:</em></strong> How would this work if say I had a service that used node.js?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13193329,"title":"Ruby 1.9.3 Dir.glob not returning properly formatted UTF-8 strings","body":"<p>When reading file names from Ruby 1.9.3, I'm seeing some odd results. For example with the following test ruby script, running in a folder containing a file with the name 'Testé.txt'</p>\n\n<pre><code>#!encoding:UTF-8\ndef inspect_string s\n    puts \"Source encoding: #{\"\".encoding}\"\n    puts \"External encoding: #{Encoding.default_external}\"\n    puts \"Name: #{s.inspect}\"\n    puts \"Encoding: #{s.encoding}\"\n    puts \"Chars: #{s.chars.to_a.inspect}\"\n    puts \"Codepoints: #{s.codepoints.to_a.inspect}\"\n    puts \"Bytes: #{s.bytes.to_a.inspect}\"\nend\n\ndef transform_string s\n   puts \"Testing string #{s}\"\n   puts s.gsub(/é/u,'TEST')\nend\n\nDir.glob(\"./*.txt\").each do |f|  \n\n   puts RUBY_VERSION + RUBY_PLATFORM\n\n   puts \"Inline string works as expected\" \n   s = \"./Testé.txt\" \n   inspect_string s\n   puts transform_string s\n\n   puts \"File name from Dir.glob does not\" \n   inspect_string f\n   puts transform_string f\n\nend\n</code></pre>\n\n<p>On Mac OS X Lion, I see the following results:</p>\n\n<pre><code>1.9.3x86_64-darwin11.4.0\nInline string works as expected\nSource encoding: UTF-8\nExternal encoding: UTF-8\nName: \"./Testé.txt\"\nEncoding: UTF-8\nChars: [\".\", \"/\", \"T\", \"e\", \"s\", \"t\", \"é\", \".\", \"t\", \"x\", \"t\"]\nCodepoints: [46, 47, 84, 101, 115, 116, 233, 46, 116, 120, 116]\nBytes: [46, 47, 84, 101, 115, 116, 195, 169, 46, 116, 120, 116]\nTesting string ./Testé.txt\n./TestTEST.txt\n\nFile name from Dir.glob does not\nSource encoding: UTF-8\nExternal encoding: UTF-8\nName: \"./Testé.txt\"\nEncoding: UTF-8\nChars: [\".\", \"/\", \"T\", \"e\", \"s\", \"t\", \"e\", \"́\", \".\", \"t\", \"x\", \"t\"]\nCodepoints: [46, 47, 84, 101, 115, 116, 101, 769, 46, 116, 120, 116]\nBytes: [46, 47, 84, 101, 115, 116, 101, 204, 129, 46, 116, 120, 116]\nTesting string ./Testé.txt\n./Testé.txt\n</code></pre>\n\n<p>The expected last line is </p>\n\n<pre><code>./TestTEST.txt\n</code></pre>\n\n<p>the encodings returned indicate that this is a normal UTF-8 string and yet any regexp transformations involving unicode are not being applied properly. </p>\n"},{"tags":["ruby","arrays","ruby-on-rails-3","csv","export-to-csv"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13203470,"title":"Rails: CSV Array to string (convert)","body":"<p>I am new to rails and I would like to export a dictionary (of strings). \nAt the moment I am using this piece of code</p>\n\n<pre><code>    Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \")\n</code></pre>\n\n<p>To generate:</p>\n\n<pre><code>   Build a cage!, Build tha pizza, Demonstrated ability in flying, Demonstrated ability in pizza baking\n</code></pre>\n\n<p>I would like to export this to csv, however the problem is that it is one array. I would like to create separate strings (comma separated) and displaying each string on a different row. Currently everything is displayed on one row when exporting this to csv. </p>\n\n<p>Any clue how to do this? I created an array of the data because there is a lot of duplicate data and this piece of code is filtering all the duplicates out.</p>\n\n<p>In my controller:</p>\n\n<pre><code>   format.csv { render Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n</code></pre>\n\n<p>I hope anyone could help me, much appreciated.</p>\n\n<p>Edit:</p>\n\n<p>Ideally I would like to fetch all competencies and have an output without duplicates, this is my controller:</p>\n\n<pre><code>    def dictionary\n      @competencies = Competency.all\n\n        respond_to do |format|\n        format.html { render html: positions_dictionary_path }\n        format.csv { render Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n        format.xls { send_data Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n\n      end\n    end\n</code></pre>\n\n<p>Usually in a view file you would do:</p>\n\n<pre><code>      &lt;div&gt;\n        &lt;% @posts.each do |competency| %&gt;\n          &lt;%= competency.competencies %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>This generates a list of all the competencies, however also the duplicates. My solution was to create an array. However this creates problems when exporting to csv (because I need every output on a different line/row. So my question, how can I generate a list of all the \"competencies\" without duplicates?</p>\n"},{"tags":["ruby"],"answer_count":5,"favorite_count":7,"up_vote_count":11,"down_vote_count":0,"view_count":4943,"score":11,"question_id":1805761,"title":"check if url is valid ruby","body":"<p>How can i check if a variable is a valid url?\ne.g.</p>\n\n<p><a href=\"http://hello.it\" rel=\"nofollow\">http://hello.it</a> ok\nhttp:||bra.ziz, no</p>\n\n<p>and if this is a valid url how can i check if this is relative to a image file?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby","customclasses"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13211438,"title":"How do I make an Object accesible inside a class in ruby?","body":"<p>I tried the following:</p>\n\n<pre><code>require \"socket\"\n\nclass IRC\ndef initialize(server, port=6667, user='ruby-bot')\n    @server = server\n    @port = port\n    @user = user\nend\n\ndef connect!\n    @s = TCPSocket.open(@server, @port) #connect\n    raise \"Couldn't connect to #{@server}:#{@port}\" unless @s #error handling\n    @s.puts \"USER #{@user} +B :IRC Ruby Bot\" #set modes etc\nend \n\ndef nick(nick=nil)\n    @s.puts \"NICK #{@nick}\"\nend\n\ndef join(channel)\n    @s.puts \"JOIN #{channel}\"\nend\nend\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>#!/usr/bin/ruby\nrequire './irc.rb'\n\nprint 'Server: '\nserver = gets\nprint 'Port (6667): '\nport = gets\n\nif port.match(/^\\n/)\nport = '6667'\nend\n\nbot = IRC.new(server, port)\nbot.nick 'fbot1830'\nbot.join '#myowntestchannel'\n</code></pre>\n\n<p>And I get the following error:</p>\n\n<pre><code>./irc.rb:17:in `nick': private method `puts' called for nil:NilClass (NoMethodError) from ./bot.rb:14\n</code></pre>\n\n<p>It's my first attempt to write a custom class in ruby, please be patient, I hope my error isn't too trivial ;)</p>\n"},{"tags":["ruby-on-rails","ruby","testunit","minitest"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":459,"score":3,"question_id":10573923,"title":"minitest, test::unit, and rails","body":"<p>I read somewhere that 'minitest' is the \"new test::unit for ruby 1.9.2+\". </p>\n\n<p>But ruby 1.9.3 seems to include <em>both</em> <a href=\"http://ruby-doc.org/stdlib-1.9.3/libdoc/test/unit/rdoc/Test/Unit.html\" rel=\"nofollow\">test::unit</a> <em>and</em> <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/minitest/unit/rdoc/MiniTest.html\" rel=\"nofollow\">minitest</a>, is that true?</p>\n\n<p>In the default rails testing, as outlined in the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">Rails testing guide</a>....  things like <code>ActiveSupport::TestCase</code>, <code>ActionController::TestCase</code>, are these using <code>Test::Unit</code> or <code>Minitest</code>?</p>\n\n<p>In the rails guide, it shows examples with tests defined like this:</p>\n\n<pre><code>test \"should show post\" do\n  get :show, :id =&gt; @post.id\n  assert_response :success\nend\n</code></pre>\n\n<p>That syntax, <code>test string</code>, as opposed to defining methods with names like <code>test_something</code> --  isn't mentioned in the docs for <em>either</em> <code>Test::Unit</code> or Minitest.  Where's that coming from?  Is Rails adding it, or is it actually a part of... whatever testing lib rails is using?</p>\n\n<p>PS: Please don't tell me \"just use rspec\". I know about rspec. I am trying to explore the stdlib alternatives, in the context of rails. </p>\n"},{"tags":["ruby","api","http","netflix"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13211351,"title":"Accessing entire netflix catalog via API v1.5","body":"<p>Netflix recently updated their API methods for obtaining the full Netflix catalog. I'm curious if anyone has had any success accessing these new xml documents and downloading them via API v1.5 (9/2012). Previously, you could download the entire Netflix catalog via one API call (which I had working perfectly). Now, there are supposedly two calls to make: one for dvd's and one for streaming movies.</p>\n\n<p>I cannot make these calls return anything except for an empty array. Please don't offer an answer unless you have personally downloaded the entire catalog via these new API's.</p>\n\n<p>Bonus points if you can tell me how to do it in Ruby.</p>\n\n<p><a href=\"http://developer.netflix.com/blog/read/Update_Changes_for_the_Public_API\" rel=\"nofollow\">http://developer.netflix.com/blog/read/Update_Changes_for_the_Public_API</a></p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":12974917,"title":"Get the width and height of an image without downloading it","body":"<p>I need to get the size of an image in Ruby on Rails. The image is in a remote URL.\nI dont want to download the entire image.</p>\n\n<p>Any help?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":10,"score":-1,"question_id":13210815,"title":"ruby-jwt sample","body":"<p>Rails/Ruby noob here...</p>\n\n<p>Does anybody have a code sample of using ruby-jwt in Ruby on Rails?</p>\n\n<p>I'm struggling to get the correct require statement at the top of my code.</p>\n\n<p>Thanks</p>\n\n<p>Nick</p>\n"},{"tags":["ruby-on-rails","ruby","authentication","authorization","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13210240,"title":"Ruby on Rails Authorization isn't saved","body":"<p>I'm following this: <a href=\"http://net.tutsplus.com/tutorials/ruby/how-to-use-omniauth-to-authenticate-your-users/\" rel=\"nofollow\">tutorial</a>  </p>\n\n<pre><code>user = User.new :name =&gt; auth_hash[\"user_info\"][\"name\"], :email =&gt; auth_hash[\"user_info\"][\"email\"]\nuser.authorizations.build :provider =&gt; auth_hash[\"provider\"], :uid =&gt; auth_hash[\"uid\"]\nuser.save\nrender :text =&gt; \"Hi #{user.name}! You've signed up.\"\n</code></pre>\n\n<p>I was browsing the DB and inspecting table <code>authorization</code> and fount out the table is empty.<br>\nwhy is that?</p>\n\n<p><strong>EDIT:</strong>\nI get this error:</p>\n\n<blockquote>\n  <p>Oops, something went wrong: [\"Authorizations is invalid\"]</p>\n</blockquote>\n\n<p>this is user.rb:  </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :topics\n  has_many :authorizations\n\n  attr_accessible :email, :name\n  validates :name, :email, :presence =&gt; true\nend\n</code></pre>\n\n<p>this is authorization.rb:  </p>\n\n<pre><code>class Authorization &lt; ActiveRecord::Base\n\n  belongs_to :user\n  validates :provider, :uid, :presence =&gt; true\n\n  attr_accessible :provider, :uid\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13109068,"title":"How to display integers as 6-digit values in Ruby on Rails?","body":"<p>How can I format integers in a text_field so that they always consist of 6 digits?</p>\n\n<p>So for example when the integer is stored as <code>1</code> in the database, in the text_field it would say: <code>000001</code>. The user should also be able to edit these values, yet not reduce or exceed the number of digits.</p>\n\n<p>I tried something like this but it's not working for me:</p>\n\n<pre><code>def formatted_number(int)\n  int.to_s.rjust(6, '0')\nend\n</code></pre>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby","terminal","gem","datamapper"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13167609,"title":"gem install datamapper error","body":"<p>I'm trying to install datamapper and I'm getting this error: </p>\n\n<pre><code>Whirlwind:Desktop AGreen$ gem install data_mapper\nERROR:  While executing gem ... (Errno::EACCES)\n    Permission denied - /Users/AGreen/.rvm/gems/ruby-1.9.2-p320/gems/bcrypt-ruby-3.0.1/.gitignore\n</code></pre>\n\n<p>I also tried to install it this way: </p>\n\n<pre><code>Whirlwind:Desktop AGreen$ gem install datamapper\nERROR:  While executing gem ... (Errno::EACCES)\n    Permission denied - /Users/AGreen/.rvm/gems/ruby-1.9.2-p320/gems/bcrypt-ruby-3.0.1/.gitignore\n</code></pre>\n\n<p>Does anyone know how I can fix this?</p>\n"},{"tags":["ruby-on-rails","ruby","amazon-web-services","elastic-beanstalk"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":185,"score":1,"question_id":12710693,"title":"Deploying rails application on AWS Elastic Beanstalk","body":"<p>Hi do anyone of you know how to deploy Rails Application on AWS Elastic Beanstalk? Previously i had 2 PHP application runs on AWS which is easy to deploy. Also is there any specific EC2 server we need to choose in order to deploy rails application, how would we automate rails server command? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","rubygems"],"answer_count":7,"favorite_count":4,"up_vote_count":9,"down_vote_count":0,"view_count":8690,"score":9,"question_id":4393189,"title":"Failing installing pg gem, \"mkmf.rb can't find header files for ruby\" (Mac OSX 10.6.5)","body":"<p>I just upgraded to rails3 and had a bit of a mess with macports/gems/databases to sort out. So I threw out all gems to install them fresh. Everything seems to be ok except for the aquirement of the <em>pg gem</em>.</p>\n\n<p>After creating a new rails3 project, prepared for postgres, the server would not start, complaining about the missing pg gem. Ok, doing <code>bundle install</code> then. It chugs along for a while and, of course, fails on the pg gem!</p>\n\n<pre><code>Installing pg (0.10.0) with native extensions /Library/Ruby/Site/1.8/rubygems/installer.rb:483:in `build_extensions': ERROR: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)\n\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb \nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/pg-0.10.0 for inspection.\nResults logged to /Library/Ruby/Gems/1.8/gems/pg-0.10.0/ext/gem_make.out\n    from /Library/Ruby/Site/1.8/rubygems/installer.rb:446:in `each'\n    from /Library/Ruby/Site/1.8/rubygems/installer.rb:446:in `build_extensions'\n    from /Library/Ruby/Site/1.8/rubygems/installer.rb:198:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/source.rb:95:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/installer.rb:55:in `run'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/installer.rb:44:in `run'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/installer.rb:8:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/cli.rb:225:in `install'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `send'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `run'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor.rb:246:in `dispatch'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/lib/bundler/vendor/thor/base.rb:389:in `start'\n    from /Library/Ruby/Gems/1.8/gems/bundler-1.0.7/bin/bundle:13\n    from /usr/bin/bundle:19:in `load'\n    from /usr/bin/bundle:19\n</code></pre>\n\n<p>The most common suggestion I have found on forums and blogs is to (re)install the XCode developer tools. They were already there, but I reinstalled it anyway - with no better outcome than the above.</p>\n\n<p><code>which ruby</code> says <code>/usr/bin/ruby</code>, and <code>ruby -v</code> says <code>ruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]</code>, if there's any clue there.</p>\n\n<p>Any pointers welcome. Any missing information that would help figuring this out, I'll gladly and promptly provide! Thanks.</p>\n\n<p>/me</p>\n\n<p>EDIT:</p>\n\n<p>I downloaded xcode etc (since the dvd version is said to be broken) and things went better for a while. <code>bundle install</code> started talking about <em>archflags</em> instead. So i did: \n<code>sudo env ARCHFLAGS=\"-arch i386\" bundle install</code> and things seemed to go fine - until starting rails barfed, saying:  </p>\n\n<pre><code>/Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle: dlopen(/Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle, 9): no suitable image found.  Did find: (LoadError)\n    /Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle: mach-o, but wrong architecture - /Library/Ruby/Gems/1.8/gems/pg-0.10.0/lib/pg_ext.bundle\n</code></pre>\n\n<p>Grappling for anything, I tried  <code>bundle install</code> with archflags set to \"-arch x86_64\", but it  didn't go down well:</p>\n\n<pre><code>*** Your PostgreSQL installation doesn't seem to have an architecture in common with the running ruby interpreter ([] vs. [\"x86_64\"])\nI'll continue anyway, but if it fails, try setting ARCHFLAGS.\n[...]\nCan't find the PostgreSQL client library (libpq)\n*** extconf.rb failed ***\n</code></pre>\n\n<p>Is <em>libpq</em> something I now have to supply a path to via some flags? Or am I completely out to lunch? :)</p>\n\n<p>/me again</p>\n"},{"tags":["ruby","authentication","sinatra","omniauth","ebay"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":13070568,"title":"Ebay authentication with Ruby","body":"<p>I'm developing eBay Sinatra application and need to authenticate an user by their login and password to give them the ability to request their information from eBay by themself. By authentication I mean authentication by redirection (or something like) to eBay and entering their login and password. It's similar to Facebook authentication.</p>\n\n<p>I did a research but found almost zero. \nYour suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","activerecord","join"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13209384,"title":"Join between two tables fails in Activerecord with uninitialized constant error","body":"<p>Using Activerecord (on a postgresql database) this program should do a simple <strong>inner join between the tables</strong> \"cars\" and \"car_parts\". Both tables exist in the db, are filled with data, and, keys are named by activerecord convention (i.e., primary keys in both tables are named \"id\"; foreign key in \"car_parts\" linking to \"cars\" is named \"car_id\"). I tried two alternatives by using \"include\" and \"join\" in Activerecord - unfortunately both failed with the below message. Any help appreciated, thanks! My program:</p>\n\n<pre><code>require 'active_record'\n\nActiveRecord::Base.establish_connection(\n    # details left out\n)\n\nclass Car &lt; ActiveRecord::Base\n  has_many :car_parts\nend\n\nclass Car_Part &lt; ActiveRecord::Base\n  belongs_to :car\nend\n\nresults2 = Car.joins(:car_parts)\nresults2.each{|row|  puts row.id}\n\nresults3 = Car.find :all, :include =&gt; [:car_parts]\nresults3.each{|row|  puts row.id}\n</code></pre>\n\n<p>For both results2 and results3 I receive the error message: \"/home/myname/.rvm/gems/ruby-1.9.3-p194@global/gems/activerecord-3.2.8/lib/active_record/inheritance.rb:111:in `compute_type': uninitialized constant Car::CarPart (NameError)\"</p>\n"},{"tags":["ruby","json","http-status-code-404","appfog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13207645,"title":"Upload error to appfog: \"Error (JSON 404): not found\"","body":"<p>I'm using appfog service for my grails app. I used <code>af</code> ruby utility from them for couple weeks and it worked fine. Today I've tried to update my project by command as usally:</p>\n\n<pre><code>af update my_project\n</code></pre>\n\n<p>But recived an error:</p>\n\n<pre><code>Error (JSON 404): Not Found\n</code></pre>\n\n<p>I don't know what i broke, but at another computer i do the same and it works.</p>\n\n<p>How to fix it? And maybe you know what i broke?</p>\n"},{"tags":["ruby-on-rails","ruby","facebook","omniauth"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13207211,"title":"omniauth with rails: get facebook user's information","body":"<p>in the callback of the authentication process I do:<br>\n<code>auth_hash = request.env['omniauth.auth']</code> </p>\n\n<p>and then, I'm extracting the user id, but is it possible in the same time getting the user's name and email address? </p>\n"},{"tags":["ruby","ip-camera"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":45,"score":2,"question_id":13208541,"title":"Ruby: Grab a single JPG image from an authenticated IP CAM and save to a file","body":"<p>Using ruby, what is the easiest way to grab a single JPG image from an IP camera that requires authentication and write the image to a file?  For example an IP camera that has uses a URL:</p>\n\n<p><i>http://192.168.69.81/cgi/jpg/image.cgi</i> </p>\n\n<p>I don't need to perform any manipulation of the image.  </p>\n\n<p>Thanks in advance.  </p>\n"},{"tags":["ruby","windows-7"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13190579,"title":"Can I avoid writing 'ruby'?","body":"<p>Every time I run a program in ruby, I need to prepend the \"ruby\" command e.g. <code>ruby program_name.rb</code></p>\n\n<p>Are there any alternatives to avoid this? Like directly writing <code>program_name.rb</code> or just <code>program_name</code>?</p>\n\n<p>P.S. I am working on Windows(7)\nI have many files and want to run each file separately. Can't make a batch file for each ruby file.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13209378,"title":"Rails not using test.sqlite3 with \"-e test\"","body":"<p>If i run <code>rails console test</code>, and do <code>SomeTable.all</code> i can see all the fields in the test.sqlite3 database, but when i run <code>rails server -e test</code> it doesn't picks up any records. \nThe app is showing results just fine with the development database.\nWhat can be the problem ?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems","installation"],"answer_count":8,"favorite_count":7,"up_vote_count":17,"down_vote_count":0,"view_count":17377,"score":17,"question_id":4827092,"title":"unable to install pg gem","body":"<p>I tried using <code>gem install pg</code> but it doesn't seem to work.</p>\n\n<p><code>gem install pg</code> gives this error</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing pg:\n        ERROR: Failed to build gem native extension.\n\nC:/Ruby/bin/ruby.exe extconf.rb\nchecking for pg_config... no\nNo pg_config... trying anyway. If building fails, please try again with\n --with-pg-config=/path/to/pg_config\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/Ruby/bin/ruby\n        --with-pg\n        --without-pg\n        --with-pg-dir\n        --without-pg-dir\n        --with-pg-include\n        --without-pg-include=${pg-dir}/include\n        --with-pg-lib\n        --without-pg-lib=${pg-dir}/lib\n        --with-pg-config\n        --without-pg-config\n        --with-pg_config\n        --without-pg_config\n\n\nGem files will remain installed in C:/Ruby/lib/ruby/gems/1.8/gems/pg-0.10.1 for\ninspection.\nResults logged to C:/Ruby/lib/ruby/gems/1.8/gems/pg-0.10.1/ext/gem_make.out\n</code></pre>\n\n<p>Please Help. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","omniauth","shibboleth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13180023,"title":"OmniAuth Shibboleth strategy configuration not passed through","body":"<p>I'm trying to make use of <a href=\"https://github.com/toyokazu/omniauth-shibboleth\" rel=\"nofollow\">omniauth-shibboleth</a> strategy (with <a href=\"https://github.com/toyokazu/rack-saml\" rel=\"nofollow\">rack-saml</a>).</p>\n\n<p>My omniauth initializer looks like this:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :shibboleth, {\n    :info_fields =&gt; {\n      :email =&gt; 'mail',\n    },\n    :extra_fields =&gt; [:cn, :sn, :schacHomeOrganization],\n  }\nend\n</code></pre>\n\n<p>Everything is successful up to the point where omniauth-shibboleth should set up <code>omniauth.auth</code> ENV variable, but this ends up partial.</p>\n\n<p>Namely - it does detect <code>eduPersonPrincipalName</code> and passes it to <code>uid</code> filed correctly - I can see it.</p>\n\n<p><strong>But</strong> it fails to fill in <code>email</code>, and the extra parameters <code>cn, sn, schacHomeOrganization</code>.</p>\n\n<p>I have verified that the <code>request.env</code> <strong>does contain</strong> all of the required attributes, so the problem is not at Shibboleth side.</p>\n\n<p>For debugging, I hardcoded the options in Gem file <code>lib/omniauth/strategies/shibboleth.rb</code>:</p>\n\n<pre><code>  option :info_fields, {:email =&gt; 'mail'}\n  option :extra_fields, [:cn, :sn, :schacHomeOrganization]\n</code></pre>\n\n<p>Then everything works.</p>\n\n<p>So, there seems to be problem either with my <em>Omniauth</em> setup or with the way <em>omniauth-shibboleth</em> handles the options, so that my configuration does not end up merged with default values.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Versions:</p>\n\n<pre><code>omniauth - 1.1.1\nomniauth-shibboleth - 1.0.8\nrack-saml - 0.0.4\n\npow - 0.4.0\n</code></pre>\n"},{"tags":["ruby","terminal","eventmachine","curses","pty"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13149972,"title":"Synchronizing PTY output with Eventmachine","body":"<p>I'm trying to write an EventMachine server to run an nCurses application via telnet or ssh, using ruby 1.9.3's PTY and io/console modules:</p>\n\n<pre><code>require 'rubygems'\nrequire 'socket'\nrequire 'pty'\nrequire 'io/console'\nrequire 'eventmachine'\n\n module CursesServer\n   def post_init\n     puts \"-- someone connected to the server!\"\n     @reader, @writer, @pid = PTY.spawn('ruby ./ncurses_app_to_run.rb')\n     @reader.sync = true #No buffering stdout     \n  end\n\n   def receive_data(data)\n     screen = @reader.read(&lt;number_of_bytes&gt;)\n     puts \"received: \" + data # Log input on server side\n     send_data screen\n     close_connection if data =~ /quit/i\n   end\n\n   def unbind\n     puts \"-- someone disconnected from the server!\"\n  end\nend\n\n# Note that this will block current thread.\nEventMachine.run {\n  EventMachine.start_server \"127.0.0.1\", 8081, CursesServer\n}\n</code></pre>\n\n<p>If I play with the value of the argument passed to @reader.read, I can get portions of the screen to display on the client side, however I don't know how to determine the actual size of the client's terminal, either initally or after the client resizes the terminal.</p>\n\n<p>How can I synchronize the output with the size of the client's terminal? Is it possible with telnet/netcat or do I have to use a more robust protocol like ssh? </p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","algorithm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":71,"score":-1,"question_id":13208466,"title":"How to make it more faster to check if there are any same numbers between set A and B (half million numbers)","body":"<p>Hi I just wrote a code to calculate the lotteries.  I Think finally I manage the code to run, but the problem is it takes more than 100 seconds to run 5 times on scaperwiki.  Any ideas to make it faster?  That is, how to make it faster to compare if there are any same numbers exist in two sets of large numbers. </p>\n\n<p>Basically the algorithm is to pick n unique numbers from 0 to 45379620 into a hash, and anther set of unique numbers from 0 to 45379620 into a hash.   And then compare these two hashes if there are any same numbers.    So finally there are 7 hashes.\nHash A :  36450 keys stored.<br>\nHash division1: 1 key stored.\nHash divison2: 14 keys stored.\n.....\nHash division 6: 290000 keys stored.\nHash divison 7: 500000 keys stored.</p>\n\n<p>Every loop calculates Hash division1 to division 7  and then compare with Hash A.</p>\n\n<p>The result is here:</p>\n\n<pre><code>Starting run ...\n\"The possible each win: \"\n11509\n\"The possible each win: \"\n17213\n\"The possible each win: \"\n11101\n\"The possible each win: \"\n12251\n\"The possible each win: \"\n12337\nThe possible each division win money for N times, from division 1 to division 7\n[0, 0, 3829, 1765, 2436, 25256, 31125]\nThe possible total wining:\n12882.2\nFinished: 121.43 seconds elapsed\nrunfinished\n</code></pre>\n\n<p>The code is basically like this: </p>\n\n<pre><code>def hashgo(n, m)\n  hash = {}\n  i = 1\n  while i &lt;= n\n    a = Random.new.rand(0..45379620-m)\n    if !hash.has_key? (a)\n      hash[a] = i\n      i += 1\n    end\n  end\n  hash\nend \n\ndef compare(a,b)\n  c = Array.new(0)\n  a.each_key { |key| \n    if b.has_key?(key) \n      c &lt;&lt; key\n    end\n  }\n  return c.length\nend\n\n# more codes....\n\nn = 5\nwhile i &lt; n  \n  division = Array.new(0)\n  compare_result = [hashgo(1, 0), hashgo(14, 1), hashgo(252, 15), hashgo(1533, 267), hashgo(13230, 1800), hashgo(294672, 15030), hashgo(521604, 309702)]\n compare_result.each do |hash|\n   division &lt;&lt; compare(myLotto,hash)\n   #more codes\n end\n i++\nend\n</code></pre>\n\n<p>hashgo(n,m) is used to pick n numbers, it returns a hash table.  so for division 1 it's hashgo(1, 0)   division 2 is  hashgo(14, 1)  m=1, means get rid of the divison 1.   Division 3 is hashgo(252, 15)</p>\n\n<p>compare(a, b) is used to compare if there are any numbers same from two hash tables. and return the number of same numbers. </p>\n"},{"tags":["ruby","inheritance","attr-accessor"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13207839,"title":"ruby restrict attr_accessor in subclass","body":"<p>I want restrict the access of superclass's method in subclass</p>\n\n<pre><code>class Parent\n  attr_accessor :first_name, :last_name\n\n  def initialize(first_name, last_name)\n    @first_name, @last_name = first_name, last_name\n  end\n\n  def full_name\n  @first_name + \" \" + @last_name \n  end\n\nend\n\nclass Son &lt; Parent\n  attr_accessor :first_name\n\n  def initialize(parent, first_name)\n    @first_name = first_name \n    @last_name = parent.last_name\n  end\n\n  def full_name\n    @first_name + \"  \" + @last_name \n  end\nend\n\n\np = Parent.new(\"Bharat\", \"Chipli\")\nputs p.full_name\n\ns = Son.new(p, \"Harry\")\ns.last_name= \"Smith\"\nputs s.full_name\n</code></pre>\n\n<p>here i am getting son's full name as <strong>\"Harry Smith\"</strong>, but i want <strong>\"Harry Chipli\"</strong></p>\n"},{"tags":["ruby-on-rails","ruby","hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13207176,"title":"How to enable development mode or display errors in ruby on rails","body":"<p>When I browse the site I get:</p>\n\n<pre><code>We're sorry, but something went wrong.\n</code></pre>\n\n<p>as I've seen its a <code>500.html</code> file, so its some internal server error, but how can I make display those errors?</p>\n\n<p>I've tried this:</p>\n\n<p>1) putting <code>ENV['RAILS_ENV'] ||= 'development'</code>in environment.rb, but nothing happened</p>\n\n<p>2) <code>config.log_level = :any</code>, then looked at the production.log, but there is not 500 errors</p>\n\n<p>Or what I need to write in the 500.html to see errors?, or just display it no matter how.</p>\n"},{"tags":["ruby","unit-testing","api"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1415,"score":8,"question_id":4812132,"title":"Writing unit tests in Ruby for a REST API","body":"<p>I've written a basic REST API using sinatra.</p>\n\n<p>Does anyone know the best way to write tests for it? I would like to do so using Ruby.</p>\n\n<p>I've done my initial testing using curl. But I'd like to do something more robust. This is my first API - is there anything specific I should be testing?</p>\n"},{"tags":["ruby","rubygems","ocra"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13207301,"title":"OCRA throwing 'bad file descriptor' error during compile","body":"<p>Whenever I try and compile anything with OCRA, I get this error:</p>\n\n<p>=== Compressing 5914523 bytes\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/ocra-1.3.0/bin/ocra:1005:in\n'write': Bad file descriptor - RubyRPG1-6.exe (Errno::EBADF)\nfrom ocra:1005:in 'block in initialize'\nfrom ocra:983:in 'open'\nfrom ocra:983:in 'initialize'\nfrom ocra:822:in 'new'\nfrom ocra:822:in 'build_exe'\nfrom ocra:1138: in 'block in (top (required))'</p>\n\n<p>Then it creates a 34KB .exe with a bad file signature. This is\nhappening no matter where I try to compile, in Downloads or Desktop,\neven when I run it as administrator, even when I try and compile .rbs\nI have previously successfully compiled .exes of. Normally I recall\nthis error message popping up if there was already a .exe with that\nfile name in the directory, but I make sure to delete or rename any\nduplicate files before I run the compiler.</p>\n\n<p>I have successfully compiled things previously, it appears to have stopped working for basically no reason. Any help would be appreciated. I suspect it may be a problem with my computer, as I have found no similar complaints.</p>\n\n<p>NOTE:I am running Windows 7 Ultimate 64-bit with SP1.</p>\n"},{"tags":["ruby"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13202775,"title":"How might I match a string in ruby without using regular expressions?","body":"<p>Currently, I'm doing this:</p>\n\n<pre><code>(in initialize)\n @all = Stuff.all.each.map {|t| t.reference_date }\n @uniques = @all.uniq\n\n\n\nresults = []\n@uniques.each do |k|\n  i = 0\n  @all.each do |x|\n    i += 1 if x =~ %r{#{x}}\n  end\n  results &lt;&lt; [k, i]\nend\n</code></pre>\n\n<p>And that's fine. It's going to work. But I like to avoid regular expressions when I can. I think they are a bit feo. That's spanish for ugly.</p>\n\n<p>EDIT--\nactually, that's not working because ruby \"puts\" the date as a numbered format like <code>2012-03-31</code> when the date object is placed inside of a string (as a variable, here), but its really a date object, so this worked:</p>\n\n<pre><code>if x.month == k.month &amp;&amp; x.day == k.day\n  i += 1\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13205839,"title":"In Ruby on rails, how to show loading image till an action completes executing?","body":"<p>I have an application, where users will be redirected to our site from a parent website. We will be getting the user's details by SAML process. Based on the details received, if the user is new user,the user will be created. So the action sessions/consume takes some time to process.Is it possible to show a loading image or any image until the action completes? So that users will not see blank screen. </p>\n"},{"tags":["ruby-on-rails","ruby","hosting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":28,"score":-2,"question_id":13206660,"title":"how to use the files: start, restart, stop, serv. in Ruby on rails","body":"<p>What mean those files:</p>\n\n<p>start, restart, stop, serv. also file typescript</p>\n\n<p>they are in ruby on rails hosting, how to use them and for what purposes they exists?</p>\n"},{"tags":["ruby","shell","scripting","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13206516,"title":"Ruby Script - Surpress \"Ask\"","body":"<p>I am working with a 3rd party rake task that looks like this:</p>\n\n<p><code>abort(\"rake aborted!\") if ask(\"Are you sure?\", ['y', 'n']) == 'n'</code></p>\n\n<p>I am trying to write some additional rake tasks to automate this process.  Is there any way to surpress this question coming up? Or somehow feed it a <code>y</code> via the command line to make it happy?</p>\n\n<p>I can edit the <code>Rakefile</code> but that is a last resort.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":10,"favorite_count":23,"up_vote_count":51,"down_vote_count":0,"view_count":18796,"score":51,"question_id":5968131,"title":"Upgrading from Rails 3 to Rails 3.1","body":"<p>How do you upgrade from Rails 3 to Rails 3.1 beta?</p>\n"},{"tags":["ruby","multithreading","raise","rescue"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13203268,"title":"ruby can't rescue or see abort from Thread.abort_on_exception","body":"<p>I need to immediately catch exceptions in threads and stop all threads, so I'm using abort_on_exception in my script.  Unfortunately this means the exception is not raised to the parent thread - perhaps this is because the exception ends up happening in a global scope??</p>\n\n<p>Anyways, here's an example showing the issue:</p>\n\n<pre><code>Thread.abort_on_exception = true\n\nbegin\n  t = Thread.new {\n    puts \"Start thread\"\n    raise saveMe\n    puts \"Never here..\"\n  } \n  t.join\nrescue =&gt; e\n  puts \"RESCUE: #{e}\"\nensure\n  puts \"ENSURE\"\nend\n</code></pre>\n\n<p>How can I rescue that exception that's raised in the thread when using abort_on_exception?</p>\n\n<p>Here's a new example that shows something even more boggling.  The thread is able to kill execution inside the begin block, but it does it without raising any exceptions??</p>\n\n<pre><code>Thread.abort_on_exception = true\nbegin\n  t = Thread.new { raise saveMe }                     \n  sleep 1\n  puts \"This doesn't execute\"\nrescue =&gt; e \n  puts \"This also doesn't execute\"\nensure\n  puts \"But this does??\"\nend   \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","search","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13200501,"title":"Ruby Sunspot Keyword search with IDs","body":"<p>Simple question:</p>\n\n<p>I've got two models: <code>Show</code> and <code>Contact</code>.  What I'd like to do is search for either a <code>Show#id</code> or a <code>Contact#name</code>. So my models are set up as follows:</p>\n\n<pre><code>class Show &lt; ActiveRecord::Base\n\n  searchable do\n    text :id\n  end\nend\n\nclass Contact &lt; ActiveRecord::Base\n\n  searchable do\n    text :name\n  end\n end\n</code></pre>\n\n<p>Then I run searches as follows: </p>\n\n<pre><code>Sunspot.search(Contact, Show) do\n  keywords(MY_QUERY)\nend\n</code></pre>\n\n<p>This works great for finding Contacts by their name, but never works with the <code>Show#id</code> field.  Can anyone explain why this is?</p>\n\n<p>Joe</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13201522,"title":"Best way to duplicate parent and associated child records in Ruby on Rails?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6711956/activerecord-how-can-i-clone-nested-associations\">ActiveRecord: How can I clone nested associations?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a table with <code>invoices</code> which in turn can have many <code>items</code>.</p>\n\n<p>Now in my <code>invoices</code> index view I would like to place a link next to each <code>invoice</code> saying <em>Duplicate Invoice</em>.</p>\n\n<p>Without the child records this would be quite easy:</p>\n\n<pre><code>&lt;%= link_to \"Duplicate\", new_invoice_path(invoice.attributes) %&gt;\n</code></pre>\n\n<p>But how can this be done if the invoice's <code>items</code> should be duplicated as well?</p>\n\n<p>As a Rails newbie I can't get my head around this. Can all this be handled by the <code>new</code> action inside my controller?</p>\n\n<pre><code>def new\n  @invoice = current_user.invoices.build(:project_id =&gt; params[:project_id])\n  @title = \"New invoice\"\nend\n</code></pre>\n\n<p>Or do I need to create another function named e.g. <code>copy</code> inside my controller?</p>\n\n<p>What is the best practice?</p>\n\n<p>Thanks for any input...</p>\n"},{"tags":["ruby","zip"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":50,"score":3,"question_id":13205920,"title":"Zip ruby killing file content","body":"<p>I am working on zipping the file (Ruby 1.8.6 which can not change) from the folders. Now Earlier had less lines in the file which was zipping fine. But when I add more content to zip , It gives me file which looks like corrupt content. This is the sort view of the long file. Files having more the 5000 lines.</p>\n\n<p>Is there any way to zip the full content without corrupting . </p>\n\n<p>Content like </p>\n\n<pre><code>Family = 1,1,1\n</code></pre>\n\n<p>is now <code>Fam</code></p>\n\n<p>Here is a code with Class</p>\n\n<pre><code> def download\n    FileUtils.rm_rf Dir.glob(\"#{RAILS_ROOT}/#{params[:id]}/xx.zip\")\n    zip_them_all = ZipThemAll.new(\"#{RAILS_ROOT}/#{params[:id]}/xxx.zip\",\"#{RAILS_ROOT}/#{params[:id]}/\")\n    zip_them_all.zip\n end\n\nclass ZipThemAll\n    attr_accessor :list_of_file_paths, :zip_file_path\n    def initialize( zip_file_path, list_of_file_paths )\n        @zip_file_path = zip_file_path\n        list_of_file_paths = [list_of_file_paths] if list_of_file_paths.class == String\n        @list_of_file_paths = list_of_file_paths\n    end\n\n    def zip\n        zip_file = Zip::ZipFile.open(self.zip_file_path, Zip::ZipFile::CREATE)\n        self.zip_em_all( zip_file, @list_of_file_paths )\n        zip_file.close\n    end\n\n    def zip_em_all( zip_file, file_list, sub_directory=nil )\n        file_list.each do | file_path |\n            if File.exists?file_path\n                if File.directory?( file_path )\n                    file_directory_list = []\n                    # Find.find( file_path ) do | path |\n                    file_directory_list = Dir.entries( file_path )\n                    file_directory_list.delete(\".\")\n                    file_directory_list.delete(\"..\")\n                    file_directory_list = file_directory_list.inject([]) do | result, path |\n                        result &lt;&lt; file_path + \"/\" + path\n                        result\n                    end\n                    self.zip_em_all( zip_file, file_directory_list, (sub_directory == nil ? '.' : sub_directory) + \"/\" + File.basename(file_path) )\n                else\n                    file_name = File.basename( file_path )\n                    if sub_directory != nil\n                        if zip_file.find_entry( sub_directory ) == nil\n                            dir = zip_file.mkdir( sub_directory )\n                        end\n                        file_name = sub_directory + \"/\" + file_name\n                    end\n                    if zip_file.find_entry( file_name )\n                        zip_file.replace( file_name, file_path )\n                    else\n                        zip_file.add( file_name, file_path)\n                    end\n                end\n            else\n                puts \"Warning: file #{file_path} does not exist\"\n            end\n        end\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","json","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":337,"score":3,"question_id":6640076,"title":"ActiveRecord: Produce multi-line human-friendly json","body":"<p>Using ActiveRecord::Base.to_json I do:</p>\n\n<pre><code>user = User.find_by_name 'Mika'\n\n{\"created_at\":\"2011-07-10T11:30:49+03:00\",\"id\":5,\"is_deleted\":null,\"name\":\"Mika\"}\n</code></pre>\n\n<p>Now, what I would like to have is:</p>\n\n<pre><code>{\n    \"created_at\":\"2011-07-10T11:30:49+03:00\",\n    \"id\":5,\n    \"is_deleted\":null,\n    \"name\":\"Mika\"\n}\n</code></pre>\n\n<p>Is there an option to do this?</p>\n\n<p>It would be great to have a global option, so that the behaviour be set depending on dev/live environment.</p>\n"},{"tags":["ruby-on-rails","ruby","design","database-design","architecture"],"answer_count":3,"favorite_count":3,"up_vote_count":1,"down_vote_count":0,"view_count":664,"score":1,"question_id":5346839,"title":"Modelling indefinitely-recurring tasks in a schedule (calendar-like rails app)","body":"<p>This has been quite a stumbling block. Warning: the following is not a question, rather explanation of what I came up with. My question is — do you have a better way to do this? Is there some common technique for this that I'm not familiar with? Seems like this is a trivial problem.</p>\n\n<p>So you have Task model. You can create tasks, complete them, destroy them. Then you have recurring tasks. It's just like regular task, but it has a recurrence rule attached to it. However, tasks can recur indefinitely — you can go a year ahead in the schedule, and you should see the task show up.</p>\n\n<p>So when a user creates a recurring task, you don't want to build thousands of tasks for hundred years into the future, and save them to database, right? So I started thinking — how do you create them?</p>\n\n<p>One way would be to create them as you view your schedule. So, when the user is moving a month ahead, any recurring tasks will be created. Of course that means that you can't simply work with database records of tasks any longer. Every SELECT operation on tasks you ever do has to be in the context of a particular date range, in order to trigger recurring tasks in that date range to persist. This is a maintenance and performance burden, but doable.</p>\n\n<p>Alright, but how about the original task? Every recurrent task gets associated with the recurrence rule that created it, and every recurrence rule needs to know the original task that started the recurrence. The latter is important, because you need to clone the original task into new dates as the user browses their schedule. I guess doable too.</p>\n\n<p>But what happens if the original task is updated? It means that now as we browse the schedule, we will be creating recurring tasks cloned off of the modified task. That's undesirable. All the implicitly persisted recurring tasks should show up the way the original task looked like when recurrence was added. So we need to store a copy of the original task separately, and clone from that, in order for recurrence to work.</p>\n\n<p>However, when the user navigates the tasks in the schedule, how do we know if at a particular point a new recurrence task needs to be created? We ask recurrence rule: \"hey, should I persist a task for this day?\" and it says yes or no. If there is already a task for this recurrence for this day, we don't create one. All nice, except a user shall also be able to simply delete one of the recurring tasks that has been automatically persisted. In that case following our logic, the system will re-create the task that has been deleted. Not good. So it means we need to keep storing the task, but mark it as deleted task for this recurrence. Meh.</p>\n\n<p>As I said in the beginning, I want to know if somebody else tackled this problem and can provide architectural advice here. Does it have to be this messy? Is there anything more elegant I'm missing?</p>\n\n<p><strong>Update</strong>: Since this question is hard to answer perfectly, I will approve the most helpful insight into design/architecture, which has the best helpfulness/trade-offs ratio for this type of problem. It does not have to encompass all the details.</p>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":8263987,"title":"Different Webpage on Heroku and Local Host","body":"<p>So I have my local machine and it is configured to tell me which branch I'm working with on the terminal. It shows me working on the master branch. I then run the command <code>git push heroku master</code> and it runs through everything and it tells me that I've deployed to heroku, yet when I go and run <code>heroku open</code> it load the default rails page that says \"Ruby on Rails: Welcome Aboard\" Locally, I see the page I expect to see.</p>\n\n<p>I have removed the default index.html in the public folder and in my routes I have the following: <code>root :to =&gt; 'pages#home'</code> I've cleared my cache and reset my browser (safari) is there anything else I can do to try to make the webpage show up correctly?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":1,"view_count":2997,"score":4,"question_id":4387439,"title":"Is \"ruby script/plugin\" a command?","body":"<p>i was following an online tutorial to create an ruby on rail application on app engine.</p>\n\n<p>there is one command, other ppl can run, but it didnt run on my ubuntu 10.10</p>\n\n<pre><code>ruby script/plugin install http://svn.avdi.org/nulldb/trunk/\n</code></pre>\n\n<p>when i try to run it, it complain ruby1.8: No such file or directory script/plugin (LoadError)</p>\n\n<p>what is wrong with my computer?</p>\n\n<p>ruby -v   ==>  1.8.7\nrails -v  ==> 2.3.10\ngem   -v  ==> 1.3.7</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":43,"score":1,"question_id":13205574,"title":"Iterating over hash of arrays","body":"<p>I have the following:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>@products = {\n  2 =&gt; [\n    #&lt;Review id: 9, answer01: 3, score: 67, style_id: 2, consumer_id: 2,\n    branch_id: 2, business_id: 2&gt;\n  ],\n  15 =&gt; [\n    #&lt;Review id: 10, answer01: 3, score: 67, style_id: 2, consumer_id: 2,\n    branch_id: 2, business_id: 2&gt;,\n    #&lt;Review id: 11, answer01: 3, score: 67, style_id: 2, consumer_id: 2,\n    branch_id: 2, business_id: 2&gt;\n  ]\n}\n</code></pre>\n\n<p>I want to average the scores for all reviews associated with each product's hash key. How can I do this?</p>\n"},{"tags":["ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":74,"score":-3,"question_id":13205099,"title":"What I find not possible with Ruby's multiple inheritance","body":"<p>With the example below how would you properly compose class S without modifying class X and class Y (both needs to be inherited by S) and adding more modules? Ruby would have been a perfect language if this was possible just like in C++.</p>\n\n<pre><code>#!/usr/bin/env ruby\n\nmodule A\n    def a\n        puts :a\n    end\nend\n\nmodule B\n    def b\n        puts :b\n    end\nend\n\n# class X works well standalone and needs not to be changed (i.e. placing contents like method x to modules, etc.)\nclass X\n    include A\n    def x\n        puts :x\n    end\nend\n\n# class Y works well standalone and needs not to be changed (i.e. placing contents like method y to modules, etc.)\nclass Y\n    include B\n    def y\n        puts :y\n    end\nend\n\nclass S # can't do \"class S &lt; X, Y\"\n    include A\n    include B\n    # has to redefine function x since we can't inherit both X and Y.\n    # only inheriting one class as well would be ugly.\n    def x\n        puts :x\n    end\n    # has to redefine function y since we can't inherit both X and Y.\n    # only inheriting one class as well would be ugly.\n    def y\n        puts :y\n    end\n    def s\n        puts :s\n    end\nend\n\ns = S.new\ns.a\ns.b\ns.x\ns.y\ns.s\n</code></pre>\n\n<p>---- Edit ----</p>\n\n<p>With respect to the resulting discussion I would add certain points to clarify the post further hoping this would help lessen the possibility of it being misread by new readers.</p>\n\n<p>1.) The solution to this mostly is to:</p>\n\n<p>a. Use another two modules for class X and Y and insert them to the classes with the \"include\" directive, then let S include the module the new modules instead of inheriting X and Y.</p>\n\n<p>b. Just transform X and Y to a module instead and insert them to class S.</p>\n\n<p>The drawback here is that if class X and Y is already stable or at least needs to be unmodified, like</p>\n\n<p>a. In two projects with different function where both needs to be the same like for the sake of tracking the version well.</p>\n\n<p>b. Class X and Y is part of a library.</p>\n\n<p>you are forced to:</p>\n\n<p>a. Just modify the classes anyway.</p>\n\n<p>b. Create a new version of the library.</p>\n\n<p>c. Just literally add the functions inside the subclass and create a similar implementation based on the classes. You'll have to examine or study the whole classes for that.</p>\n\n<p>If classes could have been easily inherited (in a multiple manner) just like modules modifications and adjustments would have been unneeded and consistency among projects and modules (packages) or libraries would have been maintained.</p>\n\n<p>Creating abstract classes to be reused over many times is not easy since you'll never know what newer subclasses would need hence you'll have to revise them from time to time. Difficulty arises if classes are used by multiple projects. It's never easy to decide when to just write a class, just write a module, or always write a class the have contents written in a pair module e.g. A &lt;-> AMod, or A &lt;-> A::SelfMod.</p>\n\n<p>I made this post just to know just in case if there are better solutions (not just obvious and common workarounds) to this and not to complain. Perhaps I made a mistake in choosing the title and first descriptions but that actually depends on the tone you choose when you read it.</p>\n\n<p>I also made this post to see if my observation is correct, and so far it seems that I could verify that it's really just how it is.</p>\n"},{"tags":["ruby","mongodb","encoding","utf-8","gmail"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13203586,"title":"Encoding::UndefinedConversionError from email body","body":"<p>using <code>mail</code> for ruby I am getting this message:</p>\n\n<pre><code>mail.rb:22:in `encode': \"\\xC7\" from ASCII-8BIT to UTF-8 (Encoding::UndefinedConversionError)\n    from mail.rb:22:in `&lt;main&gt;'\n</code></pre>\n\n<p>If I remove encode I get a message ruby</p>\n\n<pre><code>/var/lib/gems/1.9.1/gems/bson-1.7.0/lib/bson/bson_ruby.rb:63:in `rescue in to_utf8_binary': String not valid utf-8: \"&lt;div dir=\\\"ltr\\\"&gt;&lt;div class=\\\"gmail_quote\\\"&gt;l&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div dir=\\\"ltr\\\"&gt;&lt;div class=\\\"gmail_quote\\\"&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div dir=\\\"ltr\\\"&gt;&lt;div class=\\\"gmail_quote\\\"&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div dir=\\\"ltr\\\"&gt;&lt;div dir=\\\"rtl\\\"&gt;\\xC7\\xE1\\xE4\\xD5 \\xC8\\xC7\\xE1\\xE1\\xDB\\xC9 \\xC7\\xE1\\xDA\\xD1\\xC8\\xED\\xC9&lt;/div&gt;&lt;/div&gt;\\r\\n&lt;/div&gt;&lt;br&gt;&lt;/div&gt;\\r\\n&lt;/div&gt;&lt;br&gt;&lt;/div&gt;\\r\\n&lt;/div&gt;&lt;br&gt;&lt;/div&gt;\" (BSON::InvalidStringEncoding)\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>require 'mail'\nrequire 'mongo'\n\nconnection = Mongo::Connection.new\ndb = connection.db(\"DB\")\ndb = Mongo::Connection.new.db(\"DB\")\nnewsCollection = db[\"news\"]\n\nMail.defaults do\n  retriever_method :pop3, :address    =&gt; \"pop.gmail.com\",\n                          :port       =&gt; 995,\n                          :user_name  =&gt; 'my_username',\n                          :password   =&gt; '*****',\n                          :enable_ssl =&gt; true\nend\nemails = Mail.last\n#Checks if email is multipart and decods accordingly. Put to extract UTF8 from body\nplain_part = emails.multipart? ? (emails.text_part ? emails.text_part.body.decoded : nil) : emails.body.decoded\n\nhtml_part = emails.html_part ? emails.html_part.body.decoded : nil\n\nmongoMessage = {\"date\" =&gt; emails.date.to_s , \"subject\" =&gt; emails.subject , \"body\" =&gt; plain_part.encode('UTF-8') }\nmsgID = newsCollection.insert(mongoMessage) #add the document to the database and returns it's ID\nputs msgID\n</code></pre>\n\n<p>For English and Hebrew it works perfectly but it seems gmail is sending arabic with different encoding.  Replacing <code>UTF-8</code> with <code>ASCII-8BIT</code> gives a similar error.</p>\n\n<p>I get the same result when using <code>plain_part</code> for plain email messages. I am handling emails from one specific source so I can put html_part with confidence it's not causing the error. \nTo make it extra weird Subject in Arabic is rendered perfectly.\nWhat encoding should I use?</p>\n"},{"tags":["ruby","gem","rvm","gemset"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":67,"score":-1,"question_id":13163814,"title":"Global gemset not visible after installing Ruby with RVM","body":"<p>I installed RVM the usual way:</p>\n\n<pre><code>curl -L https://get.rvm.io | bash -s stable --ruby\n</code></pre>\n\n<p>During installation these messages were displayed:</p>\n\n<pre><code>ruby-1.9.3-p286 - #configure\nruby-1.9.3-p286 - #download\n(...)\nruby-1.9.3-p286 - #extract\nruby-1.9.3-p286 - #validate\nruby-1.9.3-p286 - #setup\n'ruby' was not found, cannot install rubygems unless ruby is present (Do you have an RVM ruby installed &amp; selected?)\nSaving wrappers to '/home/rmaruszewski/.rvm/bin'.\nruby-1.9.3-p286 - #importing default gemsets (/home/rmaruszewski/.rvm/gemsets/)\nCreating alias default for ruby-1.9.3-p286.\nRecording alias default for ruby-1.9.3-p286.\nCreating default links/files\nSaving wrappers to '/home/rmaruszewski/.rvm/bin'.\n</code></pre>\n\n<p>The \"'ruby' was not found\" message is suspicious....</p>\n\n<p>And, when I call <code>gem list</code>, the list is empty.</p>\n\n<pre><code>*** LOCAL GEMS ***\n</code></pre>\n\n<p>But then I call <code>rvm use ruby@global</code> then <code>gem list</code>, I get:</p>\n\n<pre><code>*** LOCAL GEMS ***\n\nbundler (1.2.1)\nrake (0.9.2.2)\nrubygems-bundler (1.1.0)\nrvm (1.11.3.5)\n</code></pre>\n\n<p>So, apparently, my \"global\" gemset is not visible from the \"default\" gemset. Can you tell me why?</p>\n\n<p>Here is the output of <code>rvm info</code> for \"global\" gemset:</p>\n\n<pre><code>ruby-1.9.3-p286@global:\n\n  system:\n    uname:       \"Linux rmaruszewski 3.2.0-32-generic #51-Ubuntu SMP Wed Sep 26 21:33:09 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\"\n    system:      \"ubuntu/12.04/x86_64\"\n    bash:        \"/bin/bash =&gt; GNU bash, version 4.2.24(1)-release (x86_64-pc-linux-gnu)\"\n    zsh:         \" =&gt; not installed\"\n\n  rvm:\n    version:      \"rvm 1.16.17 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\n    updated:      \"12 minutes 37 seconds ago\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.3p286\"\n    date:         \"2012-10-12\"\n    platform:     \"x86_64-linux\"\n    patchlevel:   \"2012-10-12 revision 37165\"\n    full_version: \"ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\"\n\n  homes:\n    gem:          \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global\"\n    ruby:         \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286\"\n\n  binaries:\n    ruby:         \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\"\n    irb:          \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin/irb\"\n    gem:          \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin/gem\"\n    rake:         \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\"\n\n  environment:\n    PATH:         \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global/bin:/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin:/home/rmaruszewski/.rvm/bin:/home/rmaruszewski/bin:/home/rmaruszewski/bin/build:/usr/lib/lightdm/lightdm:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt:/opt/AccurevTools/bin:/opt/accurev/bin:/home/rmaruszewski/bin/gitscripts:/srv/git/development/tools/gts/bin:/srv/git/build/Build:/usr/lib/oracle/xe/app/oracle/product/10.2.0/server/bin:/opt/grails/bin:/opt/gradle/bin\"\n    GEM_HOME:     \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global\"\n    GEM_PATH:     \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global\"\n    MY_RUBY_HOME: \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286\"\n    IRBRC:        \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"global\"\n</code></pre>\n\n<p>And this is for the \"default\" gemset:</p>\n\n<pre><code>ruby-1.9.3-p286:\n\n  system:\n    uname:       \"Linux rmaruszewski 3.2.0-32-generic #51-Ubuntu SMP Wed Sep 26 21:33:09 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\"\n    system:      \"ubuntu/12.04/x86_64\"\n    bash:        \"/bin/bash =&gt; GNU bash, version 4.2.24(1)-release (x86_64-pc-linux-gnu)\"\n    zsh:         \" =&gt; not installed\"\n\n  rvm:\n    version:      \"rvm 1.16.17 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\n    updated:      \"18 minutes 26 seconds ago\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.3p286\"\n    date:         \"2012-10-12\"\n    platform:     \"x86_64-linux\"\n    patchlevel:   \"2012-10-12 revision 37165\"\n    full_version: \"ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\"\n\n  homes:\n    gem:          \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286\"\n    ruby:         \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286\"\n\n  binaries:\n    ruby:         \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\"\n    irb:          \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin/irb\"\n    gem:          \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin/gem\"\n    rake:         \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\"\n\n  environment:\n    PATH:         \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286/bin:/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global/bin:/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/bin:/home/rmaruszewski/.rvm/bin:/home/rmaruszewski/bin:/home/rmaruszewski/bin/build:/usr/lib/lightdm/lightdm:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt:/opt/AccurevTools/bin:/opt/accurev/bin:/home/rmaruszewski/bin/gitscripts:/srv/git/development/tools/gts/bin:/srv/git/build/Build:/usr/lib/oracle/xe/app/oracle/product/10.2.0/server/bin:/opt/grails/bin:/opt/gradle/bin\"\n    GEM_HOME:     \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286\"\n    GEM_PATH:     \"/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286:/home/rmaruszewski/.rvm/gems/ruby-1.9.3-p286@global\"\n    MY_RUBY_HOME: \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286\"\n    IRBRC:        \"/home/rmaruszewski/.rvm/rubies/ruby-1.9.3-p286/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"\"\n</code></pre>\n"},{"tags":["ruby","http"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13204655,"title":"login vk.com net::http.post_form","body":"<p>I want login to vk.com or m.vk.com without Ruby. But my code dosen't work. </p>\n\n<pre><code>require 'net/http'\n\nemail = \"qweqweqwe@gmail.com\"\npass = \"qeqqweqwe\"\n\nuserUri = URI('m.vk.com/index.html')\nNet::HTTP.get(userUri)\nres = Net::HTTP.post_form(userUri, 'email' =&gt; email, 'pass' =&gt; pass)\nputs res.body\n</code></pre>\n"},{"tags":["ruby","testunit"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":55,"score":2,"question_id":12317921,"title":"Why 'undefined method `assert_equal' ' is thrown even after requiring 'test/unit'","body":"<p>I opened irb &amp; entered:</p>\n\n<pre><code>require 'test/unit'\n</code></pre>\n\n<p>but when I used the <code>assert_equal</code> method, I got following error: <code>NoMethodError: undefined method 'assert_equal' for main:Object</code>. Why is this happening even after requiring 'test/unit' ?</p>\n"},{"tags":["ruby-on-rails","ruby","nokogiri","xfdf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13204964,"title":"How can I read the contents of an XFDF file in Nokogiri, enter values, and then save the output?","body":"<p>I have a set of XFDF files generated from PDF forms. What I'd like to do is populate these XFDF files (which have all empty values for the form fields) with data, and then save them to a new file. I am running a RoR app with the Nokogiri gem.</p>\n\n<p>I am new to using Nokogiri for parsing XML data and have never done this before. Can someone help me understand how to:</p>\n\n<ol>\n<li>load and parse an XFDF file's fields into a hash in ruby,</li>\n<li>populate the values of the fields with some data,</li>\n<li>save the completed data back into the XFDF file?</li>\n</ol>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","object","hash","instance-variables"],"answer_count":8,"favorite_count":9,"up_vote_count":6,"down_vote_count":0,"view_count":8447,"score":6,"question_id":5030553,"title":"Ruby convert Object to Hash","body":"<p>Let's say I have a <code>Gift</code> object with <code>@name = \"book\"</code> &amp; <code>@price = 15.95</code>. What's the best way to convert that to the Hash <code>{name: \"book\", price: 15.95}</code> in Ruby, not Rails (although feel free to give the Rails answer too)?</p>\n"},{"tags":["ruby","selenium","webdriver","watir"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13204528,"title":"Watir WebDriver Error Empty Body","body":"<p>I'm writing a watir script. It runs fine on OS X but when I run it on ubuntu, after the the first few watir commands, I get the following error:</p>\n\n<p><code>empty body: \"application/json\" (500)\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:58:in `create_response'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:65:in `request'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:40:in `call'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:576:in `execute'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:183:in `switchToDefaultContent'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/target_locator.rb:68:in `default_content'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/browser.rb:180:in `assert_exists'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/frame.rb:6:in `locate'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:362:in `assert_exists'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/frame.rb:30:in `assert_exists'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:383:in `locate'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:362:in `assert_exists'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/select.rb:125:in `select_by'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/select.rb:64:in `select'\n/home/gabe/CTEC-Scraper/lib/tasks/scrape.rake:212:in `block in &lt;top (required)&gt;'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/home/gabe/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/bin/rake:19:in `load'\n/home/gabe/.rvm/gems/ruby-1.9.3-p125/bin/rake:19:in `&lt;main&gt;'</code></p>\n\n<p>NOTE: the 1 line form my file in the stack trace is </p>\n\n<p><code>frame.select_list(:name =&gt; 'SOME_ID').select('SOMETHING')</code> </p>\n\n<p>and <code>frame</code> is <code>frame = @browser.frame(:id =&gt; 'SOME_FRAME')</code></p>\n\n<p>Again, this works in OS X. I am using Firefox as my browser. When I use Chrome, it gets passed this issue but breaks later on in a part of the site not compatible with Chrome (don't blame me, I didn't write it haha)</p>\n"},{"tags":["ruby","csv","character-encoding","non-ascii-chars"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":101,"score":1,"question_id":12906374,"title":"Desperately trying to remove this diabolical excel generated special character from csv in ruby","body":"<p>My computer has no idea what this character is. It came from Excel.</p>\n\n<p>In excel it was a weird space, now it is literally represented by several symbols viz. my computer has no idea what it is.</p>\n\n<p>This character is represented by a Ê in Excel (in csv, as xls it is a space of some kind), OS X's TextEdit treats it as a big space this long \"            \", which is, I think, what it is. Ruby's CSV parser blows up when it tries to parse it using normal utf-8, and I have to add <code>:encoding =&gt; \"windows-1251:utf-8\"</code> to parse it, in which case Ruby turns it into an \"K\". This K appears in groups of 9, 12, 15 and 18 (KKKKKKKKK, etc) in my CSV, and <strong>cannot</strong> be removed via <code>gsub(/K/)</code> (groups of K, /KKKKKKKKK/, etc, cannot be removed either)! I've also used the opensource tool <a href=\"https://code.google.com/p/csvfix/\" rel=\"nofollow\">CSVfix</a>, but its \"removing leading and trailing spaces\" command did not have an effect on the Ks.</p>\n\n<p>I've tried using <code>sed</code> as suggested in <a href=\"http://stackoverflow.com/questions/3337936/remove-non-ascii-characters-from-csv\">Remove non-ascii characters from csv</a>, but got errors like</p>\n\n<blockquote>\n  <p>sed: 1: \"output.csv\": invalid command code o</p>\n</blockquote>\n\n<p>when running something like <code>sed -i 's/[\\d128-\\d255]//' input.csv</code> on Mac.</p>\n"},{"tags":["python","ruby","war"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":7,"view_count":92,"score":-7,"question_id":13204338,"title":"What are the pros and cons of Python and Ruby for writing web applications?","body":"<p>I've written applications in PHP, but I really want to gain experience in other areas of web programming. I'm considering Ruby and Python. </p>\n\n<p>I've looked at some tutorials on Python, and I liked the language, but I've had Ruby recommended to me by friends. However, they haven't been able to provide any concrete arguments as to why Ruby would be better suited to web programming.</p>\n\n<p>What are some of the strengths and weaknesses of the two languages when it comes to writing web applications?</p>\n"},{"tags":["ruby","rubygems","gem","dependencies"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13203326,"title":"understanding gem spec versions","body":"<p>I'm using the compass ruby gem (version 0.7.11), and when I run <code>gem spec compass</code>, part of the output is:</p>\n\n<pre><code>dependencies:\n- !ruby/object:Gem::Dependency\n  name: sass\n  requirement: !ruby/object:Gem::Requirement\n    none: false\n    requirements:\n    - - ~&gt;\n      - !ruby/object:Gem::Version\n        version: '3.1'\n  type: :runtime\n  prerelease: false\n  version_requirements: !ruby/object:Gem::Requirement\n    none: false\n    requirements:\n    - - ~&gt;\n      - !ruby/object:Gem::Version\n        version: '3.1'\n</code></pre>\n\n<p>When I run <code>gem install compass -v 0.7.11</code> it does install the correct version of compass, but it's pulling in sass 3.2. I thought the <code>~&gt;</code> would keep it in the 3.1.x range. Can someone explain what is happening?</p>\n"},{"tags":["ruby","sinatra","rack","thin","rackup"],"answer_count":1,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":2654,"score":7,"question_id":4389181,"title":"Passing options to rackup via a Sinatra application","body":"<p>I'm new to ruby, learning Sinatra. While creating a Sinatra site by requiring <code>'sinatra'</code> and setting up the routes directly under is pretty easy and rather well documented, creating an application by requiring <code>'sinatra/base'</code> and writing a class that inherits from <code>'Sinatra::Base</code>', while still relatively easy, is very poorly documented (maybe because it's a pretty recent feature of Sinatra).</p>\n\n<p>And that's exactly what I am doing. I am not having too much trouble on the Sinatra part, however I am having a bit of trouble on the rackup/thin/server part. Apparently there are two ways to deploy the application: using Sinatra itself (using the <code>run!</code> method) and using a rackup file (typically <code>config.ru</code>).</p>\n\n<p>Using Sinatra's <code>run!</code> method is extremely intuitive and works like a charm, but apparently it doesn't work if I want to deploy my app on heroku. As a matter of fact, almost all the Sinatra apps that I have encountered on GitHub use a <code>config.ru</code> file.</p>\n\n<p>Using a rackup file might be equally intuitive, but I can't manage to understand how to pass options from the Sinatra app to the server (ir: the port). I tried to merge options to rackup's default options array:</p>\n\n<pre><code>MyApp::App.default_options.merge!(\n  :run  =&gt; false,\n  :env  =&gt; :production,\n  :port =&gt; 4567\n)\n\nrun MyApp::App\n</code></pre>\n\n<p>by adding options directly to the app:</p>\n\n<pre><code>MyApp::App.set :port, 4567\nMyApp::App.set :run, false\nMyApp::App.set :env, :production\n\nrun MyApp::App\n</code></pre>\n\n<p>by setting options from within the application class:</p>\n\n<pre><code>module MyApp\n  class App &lt; Sinatra::Base\n    set :port, 4567\n    set :run, false\n    set :env, :production\n\n    # ...\n\n  # config.ru\n  require 'app'\n\n  run MyApp::App\n</code></pre>\n\n<p>All the methods above failed, either by showing error messages or by just not taking any of the options into consideration. So is there any way to pass options to rackup/thin/the sever via a Sinatra app when using a rackup file? Or the options in questions should be passed directly to rackup/thin/the sever via command-line options?</p>\n\n<p>As a reference to the problem, here is the little Sinatra application I am building: <a href=\"https://github.com/AzizLight/Wiki/\">https://github.com/AzizLight/Wiki/</a></p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13204116,"title":"Clever Way To Get 2nd Item From Each Group In Array Of Hashes?","body":"<p>The problem would be easy to solve with a manual loop and a result array, which you add onto as you go.  But I'm looking for a more ruby-esque solution, probably something that uses inject or select. Here's the problem:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>arr_of_hashes = [\n  {id: 1, val: \"blah1\"},\n  {id: 1, val: \"blah2\"},\n  {id: 1, val: \"blah3\"},\n  {id: 2, val: \"blah4\"},\n  {id: 2, val: \"blah5\"},\n  {id: 3, val: \"blah6\"},\n  {id: 3, val: \"blah7\"},\n  {id: 3, val: \"blah8\"},\n  {id: 3, val: \"blah9\"}\n]\n</code></pre>\n\n<p>\"Groups\" are defined by the \"id\" field in the hashes.  We are guaranteed each group has at least two items.  We want to return an array containing the 2nd item of each group:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>output_should_be = [\n  {id: 1, val: \"blah2\"},\n  {id: 2, val: \"blah5\"},\n  {id: 3, val: \"blah7\"}\n]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","metaprogramming"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":309,"score":2,"question_id":7591370,"title":"how to eval / constantize a string to a method, then pass arguments to it","body":"<p>Given:</p>\n\n<pre><code>s = \"foo_bar_path\"\n</code></pre>\n\n<p>How can I eval or constantize s, and pass arguments to it, such as my final result would be the equivalent of:</p>\n\n<pre><code>foo_bar_path(@myvar, @foobar)\n</code></pre>\n\n<p>I was trying <code>eval(s).send</code> but that doesn't seem to work. And constantize seems to only work on Classes?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","typhoeus","hydra"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13203722,"title":"undefined method `cache_getter' for Typhoeus::Hydra","body":"<p>I don't know why I get this error. Both methods are corrects.</p>\n\n<pre><code>hydra = Typhoeus::Hydra.new\n\n             hydra.cache_getter do |request|\n                Rails.cache.read(request.cache_key) rescue nil\n             end\n             hydra.cache_setter do |request|\n               Rails.cache.write(request.cache_key,request.response, expires_in: request.cache_timeout)\n             end\n</code></pre>\n\n<p>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin11.4.2]</p>\n\n<p>Rails 3.2.8</p>\n"},{"tags":["jquery","ruby-on-rails","ruby","ember.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13203755,"title":"How do I create customization tools like on Goodsie/flavors.me?","body":"<p>Goodsie.com and flavors.me has an in-browser user-friendly design tool to allow users to customize the look and feel of the user's personal page.  How would I go about making the same tool for my website?</p>\n\n<ul>\n<li>Change text color/font/size</li>\n<li>Change layout with a single click</li>\n<li>preview the changes dynamically as the user changes the different fields.</li>\n</ul>\n\n<p>I use ruby on rails/jquery.  Someone told me I have to use Ember.js or something similar to achieve this result but I don't know how to exactly go about tackling this problem.</p>\n\n<p>Questions:</p>\n\n<ul>\n<li>What technologies/features can most easily create such a toolset?</li>\n<li>How do I save each user's different customizations? (through database fields?)</li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby","console","rubymine"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13201658,"title":"Rubymine using generator from rails console","body":"<p>I am currently using Rubymine for ruby on rails development. \nAfter enjoying the console for testing purposes, I want to use the console instead of the build-in Rails Generator for creating new models and such. </p>\n\n<p>But I can't figure out how to use the rails console (Tools | Run Rails Console) for generating -lets say- a new model \"user\".</p>\n\n<pre><code>rails generate model user name:string\n</code></pre>\n\n<p>gives me </p>\n\n<blockquote>\n  <p>NameError: undefined local variable or method `string' for main:Object</p>\n</blockquote>\n\n<p>I think I'm just missing something very basic here but I couldn't come up with a solution by myself after several tries :/\nI hope you can help me out.</p>\n\n<p>Greets</p>\n"},{"tags":["ruby-on-rails","ruby","gem","bundler"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2035,"score":2,"question_id":9038350,"title":"bundle install issue with libv8 and rails","body":"<p>I'm having issues with the <code>libv8</code> gem with ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-darwin10.8.0]. gem install libv8 works fine and I have</p>\n\n<pre><code>gem 'therubyracer'\n</code></pre>\n\n<p>in my <code>Gemfile</code> and this has a dependency on <code>libv8</code> which is installed when I do a <code>bundle install</code>:</p>\n\n<pre>\n$ bundle exec gem list\n\n*** LOCAL GEMS ***\n\nactionmailer (3.1.3)\nactionpack (3.1.3)\n...\nlibv8 (3.3.10.4 x86_64-darwin-10)\n...\n\n</pre>\n\n<p>but when I run:</p>\n\n<pre>\n$ rails s\nCould not find libv8-3.3.10.4 in any of the sources\nRun `bundle install` to install missing gems.\n</pre>\n\n<p>it can't find <code>libv8</code> - is this is a 32/64 bit issue?   If so, how do I solve it?</p>\n"},{"tags":["ruby","regex","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":4,"view_count":54,"score":-4,"question_id":13202282,"title":"Regex html help needed","body":"<p>I have an HTML response body/string. Part of that html content are these strings -</p>\n\n<pre><code>&lt;h2&gt;&lt;a href=\"javascript:;\" class=\"user-name-class\"&gt;MY_USER_NAME&lt;b&gt;&lt;/b&gt;&lt;/a&gt;&lt;/h2&gt;\n\n[\"media_detail\",\"init\",[false,\"\",null,true,1,4,\"99999_XXXXX_99999\",11836530,\"00076f7474727febc37a8825d373a5be\",\"\\/p\\/LdvJWSF-6b\\/\",\"\\/accounts\\/login\\/\"]],\n</code></pre>\n\n<p>From these I need to extract <code>MY_USER_NAME</code> and <code>99999_XXXXX_99999</code></p>\n\n<p>I would appreciate help from regex rockstars. This is in ruby 1.9.3. Thanks.</p>\n\n<p>UPDATE: We are using regex because this is not done in realtime, so performance is not a concern.</p>\n"},{"tags":["ruby","if-statement","switch-statement"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":152,"score":2,"question_id":8127151,"title":"Why does a switch statement perform equality testing differently from an if statement?","body":"<p>Why does the <code>if</code> statement work in the example below while the <a href=\"http://en.wikipedia.org/wiki/Switch_statement#Ruby\" rel=\"nofollow\">switch statement</a> does not.</p>\n\n<ul>\n<li><p>working:</p>\n\n<pre><code>if ''.class == String\n  puts \"yep, that's a string\"\nend\n</code></pre></li>\n<li><p>not working:</p>\n\n<pre><code>case ''.class\nwhen String\n  puts \"yep, that's a string, but this case is never triggered\"\nend\n</code></pre></li>\n</ul>\n\n<p>In the trivial example above, the switch statement is overkill, but there are obviously situations where a switch statement would be DRYer than chained <code>elsif</code>s</p>\n"},{"tags":["ruby-on-rails","ruby","ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13201351,"title":"Rails render javascript shows text","body":"<p>I'm not sure if this behavior is normal or not, but when I do:</p>\n\n<pre>\nrender js: \"window.location.pathname = '#{new_user_session_path}';\"\n</pre>\n\n<p>in my controller, it briefly displays the text <code>window.location.pathname = '/user/sign_in';</code> before executing the line and redirecting successfully.</p>\n\n<p>Here's the full controller action:</p>\n\n<pre>\ndef vote_down\n    if user_signed_in?\n      current_user.vote_exclusively_against(@deal = Deal.find(params[:id]))\n\n      render :partial => 'deals/partials/interaction', \n        :locals => {:deal => @deal, :votes_for => @deal.votes_for, :votes_against => @deal.votes_against}\n    else\n      render js: \"window.location.pathname = '#{new_user_session_path}';\"\n      flash[:error] = 'Please sign in to vote.'\n    end\n  end\n</pre>\n\n<p>How do I prevent this from happening and directly render that template?</p>\n"},{"tags":["ruby","path"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":198,"score":0,"question_id":3930184,"title":"A question about $LOAD_PATH in Ruby","body":"<pre><code>$: = '/users/joecool/rubylib'\n$: &lt;&lt; '/users/joecool/rubylib'\n$:.unshift('/users/joecool/rubylib')\nruby -c somescript.rb    \nruby -e \"puts 'Hello, world!'\n</code></pre>\n\n<p>Can someone direct me to some reading, so that I can figure out what this code does?</p>\n"},{"tags":["ruby","gem"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":23,"score":3,"question_id":13202150,"title":"Is there a Ruby gem or library that provides a way to parse ordinal numbers?","body":"<p>I'm looking for a way to parse ordinal numbers (first, second, third, etc) in Ruby and convert them to integers. Do you know of any libraries that do this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","module"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13202690,"title":"Rails doesn't load my module from lib","body":"<p>I have a bunch of custom classes in my Rails 3.2 app in lib folder: i.e. extending ActiveRecord, etc. It all works fine.</p>\n\n<p>However I'm trying to add a couple of custom methods to FileUtils, i.e.</p>\n\n<pre><code>module FileUtils\n  def last_modified_file(path='.')\n     # blah ...    \n  end\nend\n</code></pre>\n\n<p>I put it in lib/file_utils.rb\nIn my application.rb I have</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>My other custom classed are loaded but not the module.</p>\n\n<p>I read (<a href=\"http://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3\">Best way to load module/class from lib folder in Rails 3?</a> ) that I'm supposed to define a class inside module in order for Rails to pick it up and according to FileUtils.class  - it should be Object &lt; BasicObject.</p>\n\n<p>So I tried</p>\n\n<pre><code>module FileUtils\n  class Object \n    def last_modified_file(path='.')\n       # blah ...    \n    end\n  end\nend\n</code></pre>\n\n<p>But that doesn't work either.</p>\n\n<p>However when I fire up irb and just paste my code which effectivly puts my new code inside object and reinclude my module - it works fine.</p>\n\n<p>Whaat amd I missing here?</p>\n"},{"tags":["ruby-on-rails","ruby","hash","default-value"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":66,"score":-1,"question_id":12071653,"title":"Setting default values for a hash in ruby","body":"<p>I have a nested hash like :-</p>\n\n<pre><code>profile:\n  status:                               \n     nil: 3    \n     x: 2   \n\n  priority:\n     x: 2\n     y: 2\n</code></pre>\n\n<p>Is there a way of setting the default value for status like:-</p>\n\n<pre><code>profile:\n  status:\n    default:0\n    nil: 3\n    x:2\n</code></pre>\n\n<p>I dont want solutions like these or any other method :-</p>\n\n<pre><code>h = Hash.new(\"Go Fish\")\nh.default = \"Go fish\"\n</code></pre>\n\n<p>coz I have a yml file loaded with configs hash and other mapping hashes, like the status, priority mapping above. So my script extracts the configs as well as the other hash values from these yml and use them. Now for the status and priority mapping, I need this status and priority subhash to return a value if it doesnt find any matching symbol(i.e,. if no such mapping exists) inside this hash. I can set that default value in the code using the other methods. But the whole point is I want any layman to edit this yml and be able run my script. Hence I want the default values to be set here. </p>\n"},{"tags":["ruby"],"answer_count":7,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13196372,"title":"Every Other 2 Items in Array","body":"<p>I need a ruby formula to create an array of integers. The array must be every other 2 numbers as follows.</p>\n\n<pre><code>[2, 3, 6, 7, 10, 11, 14, 15, 18, 19...]\n</code></pre>\n\n<p>I have read a lot about how I can do every other number or multiples, but I am not sure of the best way to achieve what I need.</p>\n"},{"tags":["ruby-on-rails","ruby","cucumber","cardinality","ordinals"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":601,"score":1,"question_id":5907084,"title":"is there an ordinal to cardinal function in ruby or rails?","body":"<p>I'm trying to find a better way in expressing my cucumbers so I am looking for an ordinal to cardinal function that converts this:</p>\n\n<pre><code>When I fill up the first passenger field\nThen I should see the passenger list update with the first passenger details\nWhen I follow \"Add Another Passenger\"\nThen I should see a second passenger field\nWhen I fill up the second passenger field\nThen I should see the passenger list update with the second passenger details\n</code></pre>\n\n<p>into something more dynamic(instead of creating separate steps for each line)</p>\n\n<p>here's a sample of my web steps</p>\n\n<pre><code>When /^I fill up the first passenger field$/ do\n  fill_in(\"booking_passengers_attributes_0_first_name\", :with =&gt; \"Blah\")\n  fill_in(\"booking_passengers_attributes_0_last_name\", :with =&gt; \"blah\")\n  select(\"5' to 6'\", :from =&gt; \"booking_passengers_attributes_0_height\")\n  select(\"100 to 150lbs\", :from =&gt; \"booking_passengers_attributes_0_weight\")\nend\n\nWhen /^I fill up the second passenger field$/ do\n  fill_in(\"booking_passengers_attributes_1_first_name\", :with =&gt; \"Wee\")\n  fill_in(\"booking_passengers_attributes_1_last_name\", :with =&gt; \"Sir\")\n  select(\"5' to 6'\", :from =&gt; \"booking_passengers_attributes_1_height\")\n  select(\"150 to 200lbs\", :from =&gt; \"booking_passengers_attributes_1_weight\")\nend\n</code></pre>\n\n<p>See that 0 and 1? I wish to convert \"first\" to a cardinal number so i can just substitute. You can also just suggest a better way to declare the cukes :)</p>\n\n<p><strong>UPDATED ANSWER</strong>\nI am in the middle of refactoring but basically I used 1st instead of first and used to_i on that.</p>\n\n<pre><code>When /^I fill up the \"([^\"]*)\" passenger field$/ do |id|\n  input_id = id.to_i - 1\n  fill_in(\"booking_passengers_attributes_#{input_id}_first_name\", :with =&gt; id)\n  fill_in(\"booking_passengers_attributes_#{input_id}_last_name\", :with =&gt; \"Passenger\")\n  select(\"5' to 6'\", :from =&gt; \"booking_passengers_attributes_#{input_id}_height\")\n  select(\"100 to 150lbs\", :from =&gt; \"booking_passengers_attributes_#{input_id}_weight\")  \nend\n</code></pre>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":3,"up_vote_count":7,"down_vote_count":0,"view_count":1243,"score":7,"question_id":4467538,"title":"What does the \"===\" operator do in Ruby?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3422223/vs-in-ruby\">=== vs. == in Ruby</a>  </p>\n</blockquote>\n\n\n\n<p>I've seen it used a few times lately but can't figure out what it does. Can anyone illustrate how it works?</p>\n"},{"tags":["ruby","xml","rss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":36,"score":-3,"question_id":13168937,"title":"How to add extra data to tag","body":"<p>Ruby. I use standart builder to generate rss. My builder file is:</p>\n\n<pre><code>xml.instruct! :xml, :version =&gt; \"1.0\"\nxml.rss(:version =&gt; \"2.0\") {\nxml.channel {\n    xml.title(@digest.name)\n    xml.description(@digest.name)\n    xml.link(url_for(:only_path =&gt; false))\n    for post in @posts\n        xml.item do\n            xml.title(post.title || '')\n            xml.description(post.summary)\n            xml.link(post.url)\n            xml.source(post.feed.name)\n            xml.guid(post.url)\n            xml.pubDate(post.pub_date.to_s(:rfc822))\n        end\n     end\n    }\n}\n</code></pre>\n\n<p>To generate an rss feed(<code>require rss</code>) I use next code :</p>\n\n<pre><code>xml.source(post.feed.name)\n</code></pre>\n\n<p>and get:</p>\n\n<pre><code>&lt;source&gt;Cnn news&lt;/source&gt;\n</code></pre>\n\n<p>But I want something like that:</p>\n\n<pre><code>&lt;source url=\"http://news.cnn.com\"&gt;Cnn news&lt;/source&gt;\n</code></pre>\n\n<p>How can I add parameter <code>url</code> to xml source tag?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13201789,"title":"Rails where on query result","body":"<p>I have a model- <code>Link</code> - that has many hits. What I'm trying to do is aggregate data on hits per hour over time from a database table - <code>hits</code> - with columns <code>year</code>, <code>month</code>, <code>day</code>, and <code>hour</code>.</p>\n\n<p>Everything is working fine, but when I run the code below, I end up with almost <strong>1,000 queries on the database</strong>, which seems quite excessive.</p>\n\n<pre><code>#before iteration\n@hits = @link.hits.group('year, month, day, hour')\n  .order('year ASC, month ASC, day ASC, hour ASC')\n  .select('year, month, day, hour, count(*) as hits')\n\n\n#inside iteration\n\n#Line breaks are included here for easy reading\nhits_per_hour =\n  @hits.where(\n    :year =&gt; t.year, \n    :month =&gt; t.month,\n    :day =&gt; t.day,\n    :hour =&gt; t.hour\n  ).map(&amp;:hits).first || 0\n</code></pre>\n\n<p>Here <code>t</code> is a <code>Time</code> object that iterates in steps of 1 hour since the first hit a link received.</p>\n\n<p>I would think that rails would store the query result instead of re-querying every time. I also haven't been able to find anything about caching the query results or anything. Am I just missing something completely, or is this really the easiest way?</p>\n\n<p>Here is a sample of what the queries look like (this is what I see in my logs in blocks of a thousand):</p>\n\n<pre><code>SELECT year, month, day, hour, count(*) as hits\nFROM `hits`\nWHERE\n  `hits`.`link_id` = 1 AND\n  `hits`.`year` = 2012 AND\n  `hits`.`month` = 11 AND\n  `hits`.`day` = 2 AND\n  `hits`.`hour` = 14\nGROUP BY year, month, day, hour\nORDER BY year ASC, month ASC, day ASC, hour ASC\n</code></pre>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13201178,"title":"how to do polymorphism in Ruby","body":"<p>So here is a more java-esq approach (I think)...I have this code in Ruby</p>\n\n<pre><code>class Human\n  def move\n    p 'Human move: X'\n  end\nend\n\n\nclass Computer\n  def move\n    p'Computer move: O'\n  end\nend\n\nclass Player\n  def initialize(letter)\n    if letter == 'X'\n      return Human.new\n    else\n      return Computer.new\n    end\n  end\nend\n\nbob = Player.new('X')\nbob.move\n</code></pre>\n\n<p>I'm expecting to get back on cli 'Human move: X'\nI'm getting an error of the following...</p>\n\n<pre><code>undefined method `move' for #&lt;Player:0x007f8d930895a8&gt; (NoMethodError)\n</code></pre>\n\n<p>Can anybody help this Ruby noob?</p>\n\n<p>-------------------------discussion------------------------</p>\n\n<p>Now I've just figured a way of doing this in a more, I guess, 'classic' Ruby fashion using inheritance and overriding. Now, this just makes no sense to the sub processors in my mind.I mean, if I do it this way...I could have just required the class files in any other class file and instantiated a new object their. It does not feel truly polymorphic the way it does when you do it in Java....here's the code....</p>\n\n<pre><code>class Player\n  def move\n    return \"\"\n  end\nend\n\nclass Human &lt; Player\n  def move\n    return 'Human move: X'\n  end\nend\n\n\nclass Computer &lt; Player\n  def move\n    return'Computer move: O'\n  end\nend\n\n\n\nplayers = [Human.new, Computer.new]\nplayers.each {|player|\n  print player.move\n}\n</code></pre>\n"},{"tags":["php","ruby-on-rails","ruby","forms","zend-form"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":10460537,"title":"Zend_Form equivalent for ruby / rails","body":"<p>Does anyone know if it there exist any Ruby or rails equivalent of zend_form? </p>\n\n<p>I'm asking because I'm porting a project that I made in PHP with zend framework over to rails. This an event registration/form builder which basically means I need to generate forms from fields in a database. Zend_Form makes creating forms programmaticly very easy with validation and the works. Now I need to make this in rails but I can't see how it can be done any other way than making it all from scratch.\nAny ideas on the matter is very much appreciated. :)</p>\n\n<p>If there's nothing like zend_form for rails/ruby is anybody interested in making it with me? I'm very new to rails and Ruby so i could very much need the help. :)</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13201115,"title":"Ordering by complex structure in Rails","body":"<p>I have a model called Event that has many EventRegistrations, which belongs to a person.\nAlso the EventRegistration has many EventAtendees, which belongs to a person too.</p>\n\n<p>I want to order in Rails all the people related to a event, which means:\n - Person associated to an event registration\n - Person associated to an event atendee which is associated to a registration..</p>\n\n<p>Any help?</p>\n"},{"tags":["ruby-on-rails","ruby","nomethoderror"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":27,"score":0,"question_id":13198892,"title":"undefined method `model_name' for NilClass:Class Rails","body":"<p>I've got problem with NoMethodError in Rails.</p>\n\n<p><img src=\"http://i.stack.imgur.com/6wiuy.png\" alt=\"Error screen\"></p>\n\n<p>MODELS:\nissue:</p>\n\n<pre><code>class Issue &lt; ActiveRecord::Base\n   attr_accessible :description, :estimate, :label, :status, :title, :project_id\n   belongs_to :project\n   validates :title, :presence =&gt; true\n   validates :estimate, :numericality =&gt; {:greater_than_or_equal_to =&gt; 0.1}\n end\n</code></pre>\n\n<p>project:</p>\n\n<pre><code> class Project &lt; ActiveRecord::Base\n   attr_accessible :description, :title\n   has_many :issues, :dependent =&gt; :destroy\n   accepts_nested_attributes_for :issues, :allow_destroy =&gt; :true\n end\n</code></pre>\n\n<p>issue controller:</p>\n\n<pre><code> class IssuesController &lt; ApplicationController\n        # GET /issues\n        # GET /issues.json\n        def index\n          @issues = Issue.all\n\n          respond_to do |format|\n            format.html # index.html.erb\n            format.json { render :json =&gt; @issues }\n          end\n        end\n\n        # GET /issues/1\n        # GET /issues/1.json\n        def show\n          @issue = Issue.find(params[:id])\n\n          respond_to do |format|\n            format.html # show.html.erb\n            format.json { render :json =&gt; @issue }\n          end\n        end\n\n        # GET /issues/new\n        # GET /issues/new.json\n        def new\n          @issue = Issue.new\n          #@issue = @project.issues.new(params[:issue])\n\n          respond_to do |format|\n            format.html # new.html.erb\n            format.json { render :json =&gt; @issue }\n          end\n        end\n\n        # GET /issues/1/edit\n        def edit\n          @issue = Issue.find(params[:id])\n        end\n\n        # POST /issues\n        # POST /issues.json\n        def create\n          @project = Project.find(params[:project_id])\n          @issue = @project.issues.create(params[:issue])\n          redirect_to project_path(@project)\n          #@issue = @project.issues.new(params[:issue])\n          #@issue = Issue.new(params[:issue])\n\n          # respond_to do |format|\n          #   if @issue.save\n          #     format.html { redirect_to @issue, :notice =&gt; 'Issue was successfully created.' }\n          #     format.json { render :json =&gt; @issue, :status =&gt; :created, :location =&gt; @issue }\n          #   else\n          #     format.html { render :action =&gt; \"new\" }\n          #     format.json { render :json =&gt; @issue.errors, :status =&gt; :unprocessable_entity }\n          #   end\n          # end\n        end\n\n        # PUT /issues/1\n        # PUT /issues/1.json\n        def update\n          @issue = Issue.find(params[:id])\n\n          respond_to do |format|\n            if @issue.update_attributes(params[:issue])\n              format.html { redirect_to @issue, :notice =&gt; 'Issue was successfully updated.' }\n              format.json { head :no_content }\n            else\n              format.html { render :action =&gt; \"edit\" }\n              format.json { render :json =&gt; @issue.errors, :status =&gt; :unprocessable_entity }\n            end\n          end\n        end\n\n        # DELETE /issues/1\n        # DELETE /issues/1.json\n        def destroy\n          @project = Project.find(params[:project_id])\n          @issue = @project.issues.find(params[:id])\n          #@issue = Issue.find(params[:id])\n          @issue.destroy\n          redirect_to project_path(@project)\n\n          # respond_to do |format|\n          #   format.html { redirect_to issues_url }\n          #   format.json { head :no_content }\n          # end\n        end\n      end\n</code></pre>\n\n<p>project controller:</p>\n\n<pre><code> class ProjectsController &lt; ApplicationController\n    # GET /projects\n    # GET /projects.json\n    def index\n      @projects = Project.all\n\n      respond_to do |format|\n        format.html # index.html.erb\n        format.json { render :json =&gt; @projects }\n      end\n    end\n\n    # GET /projects/1\n    # GET /projects/1.json\n    def show\n      @project = Project.find(params[:id])\n\n      respond_to do |format|\n        format.html # show.html.erb\n        format.json { render :json =&gt; @project }\n      end\n    end\n\n    # GET /projects/new\n    # GET /projects/new.json\n    def new\n      @project = Project.new\n\n      respond_to do |format|\n        format.html # new.html.erb\n        format.json { render :json =&gt; @project }\n      end\n    end\n\n    # GET /projects/1/edit\n    def edit\n      @project = Project.find(params[:id])\n    end\n\n    # POST /projects\n    # POST /projects.json\n    def create\n      @project = Project.new(params[:project])\n\n      respond_to do |format|\n        if @project.save\n          format.html { redirect_to @project, :notice =&gt; 'Project was successfully created.' }\n          format.json { render :json =&gt; @project, :status =&gt; :created, :location =&gt; @project }\n        else\n          format.html { render :action =&gt; \"new\" }\n          format.json { render :json =&gt; @project.errors, :status =&gt; :unprocessable_entity }\n        end\n      end\n    end\n\n    # PUT /projects/1\n    # PUT /projects/1.json\n    def update\n      @project = Project.find(params[:id])\n\n      respond_to do |format|\n        if @project.update_attributes(params[:project])\n          format.html { redirect_to @project, :notice =&gt; 'Project was successfully updated.' }\n          format.json { head :no_content }\n        else\n          format.html { render :action =&gt; \"edit\" }\n          format.json { render :json =&gt; @project.errors, :status =&gt; :unprocessable_entity }\n        end\n      end\n    end\n\n    # DELETE /projects/1\n    # DELETE /projects/1.json\n    def destroy\n      @project = Project.find(params[:id])\n      @project.destroy\n\n      respond_to do |format|\n        format.html { redirect_to projects_url }\n        format.json { head :no_content }\n      end\n    end\n  end\n</code></pre>\n\n<p>And it writes undefined method `model_name' for NilClass:Class when I want to show some project. Please, can you help me? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","process"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13182571,"title":"How would I spawn Heroku workers to divide and conquer list of keywords?","body":"<p>My Heroku Rails app maintains a large frequently-changing list of keywords.</p>\n\n<p>I want to spawn up N amount of workers that will equally divide up this list of keywords and work on them until they are restarted (I restart them every time the list of keywords changes). Once restarted, they divide up the keywords again and churn away.</p>\n\n<p><strong>For example</strong>: Let's say I have 1,000 keywords.</p>\n\n<ul>\n<li>If I spawn up 1 worker, that worker will take 1,000 keywords.</li>\n<li>If I spawn up 10 workers, each worker will take 100 keywords.</li>\n<li>If I spawn up 1,000 workers, each worker will take 1 keyword.</li>\n</ul>\n\n<p>Workers basically just open a connection with Twitter for their set of keywords and process incoming tweets that match those keywords.</p>\n\n<p><strong>Any ideas on how to set up the Procfile and delegate X keywords between N workers?</strong></p>\n\n<hr>\n\n<p>Here's a naive/pseudo manual approach just for demonstration. However, I want to be able to spawn up an arbitrary amount of workers that will automatically split the keywords amongst themselves.</p>\n\n<p>Procfile:</p>\n\n<pre><code>keywordstreamer0: bundle exec ruby keyword_streamer.rb 0\nkeywordstreamer1: bundle exec ruby keyword_streamer.rb 1\n</code></pre>\n\n<p>keyword_streamer.rb</p>\n\n<pre><code>streamer_id = ARGV.shift # 0 or 1\n\n# Split all keywords into array of two groups and take the group\n# that matches this worker id (so the two workers take different groups)\nkeywords = Keyword.all.split_into_groups_of(2)[streamer_id]\n\n# Example work loop\nTwitterStream.track(keywords).each do |incoming_tweet|\n  process(incoming_tweet)\nend\n</code></pre>\n\n<p>Then, in my app, when I need to restart my keyword workers:</p>\n\n<pre><code>[\"keywordstreamer0\", \"keywordstreamer1\"].each do |streamer|\n  restart(streamer)\nend\n</code></pre>\n\n<p>I'd like to instead be able to spawn N amount of these workers but I'm am having trouble parceling out a solution. I'd appreciate any high-level overview suggestions!</p>\n"},{"tags":["ruby","nokogiri"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13200256,"title":"Nokogiri returning values as a string, not an array","body":"<p>I'm running a script using Nokogiri that returns multiple values. I was under the impression (and reassured by multiple sources) that the results should be in the form of an array. Instead I'm getting an ugly looking string. Here is the code</p>\n\n<pre><code>require 'nokogiri'\nrequire 'open-uri'\nrequire 'spreadsheet'\n\nprofile_page_scraper = Nokogiri::HTML(open('http://www.crunchbase.com/company/facebook'))       \nputs profile_page_scraper.css('div.col1_content td.td_left').text\n</code></pre>\n\n<p>RETURNS this:</p>\n\n<pre><code>PublicDateRaisedPost IPO ValuationWebsiteBlogTwitterCategoryEmployeesFoundedDescription\n</code></pre>\n\n<p>I know I can run a map function to fix this quickly, but I am confused as to why this isn't returning an array. It should, theoretically, return something like this:</p>\n\n<pre><code>[\"Public\", \"Date\", \"Raised\" ... \"Description\"]\n</code></pre>\n\n<p>Any ideas why this isn't working? Thanks in advance.</p>\n"},{"tags":["ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13197492,"title":"Access ExampleGroup scope outside \"it\" block","body":"<p>I'm trying to DRY my spec using RSpec's Macros, and I encountered a problem.</p>\n\n<pre><code>describe \"...\" do\n  let!(:blog) { create(:blog) }\n\n  post \"/blogs/#{blog.id}/posts\" do\n    # some macros\n  end\nend\n</code></pre>\n\n<p>I want to get access to <code>blog</code> variable but I don't want to do it inside <code>it { ... }</code> block so would be able to use my macros regardless of the resource (e.g. I want to apply it to <code>blogs</code>, <code>posts</code>, <code>comments</code>, etc).</p>\n\n<p>Is it possible?</p>\n"},{"tags":["ruby","sass","compass-css"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13160660,"title":"Compass mixins not found when using directly from ruby","body":"<p>I am building a new ruby script using GLI gem that uses Compass within. However, whenever I run the app using <code>bundle exec</code> SASS/Compass can never seem to find the mixins that I include in my .scss file. I get the following error... </p>\n\n<p><code>error: File to import not found or unreadable: compass/css3.</code></p>\n\n<p>I know the solution is to set an environment variable. However, I have no clue as to which variable needs to be set. </p>\n\n<p><strong>Update</strong>: </p>\n\n<p>I should have added that this is a follow up to another post that I had - <a href=\"http://stackoverflow.com/questions/13129789/using-compass-from-ruby-not-shell\">Using Compass from Ruby (not shell)</a></p>\n\n<p>Here is the code that I am using to invoke compass from my app. </p>\n\n<pre><code>require 'compass'\nrequire 'sass/plugin'\n\ncompiler = Compass::Compiler.new('.','.','.',{:style =&gt; :compact})\ncompiler.compile(sass_file,css_file)\n</code></pre>\n\n<p>Here is the error that is getting thrown</p>\n\n<blockquote>\n  <p>error: File to import not found or unreadable: compass/css3.</p>\n  \n  <p>Load path: /Volumes/MacRAID/joeworkman/Desktop/stake-test/Badges/Badges.source/Contents</p>\n</blockquote>\n\n<p>I originally thought that this only happened when I was running under <code>bundle exec</code>. However, its does happen every time even if I were to run in it normally.</p>\n\n<p><strong>Update #2</strong>: </p>\n\n<p>I am pretty certain that this is a SASS <code>:load_paths</code> issue. If I set my <code>SASS_PATH</code> environment variable to the below value everything works. I don't want to depend on environment variables though.</p>\n\n<p><code>~/.rvm/gems/ruby-1.9.3-p194/gems/compass-0.12.2/frameworks/compass/stylesheets</code></p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","anemone"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13178265,"title":"Rails Anemone and Postgres storing just the URL","body":"<p>I want to save the URL <code>on_pages_like</code> a certain match. Anemone is doing its thing, and records are being created that store the URLs, but:</p>\n\n<ol>\n<li>I want to use something like <code>find_or_create_by_url</code> instead of <code>create!</code>, so I'm not duplicating records each time.</li>\n<li><p>I want to save the URL. Currently the URL is being saved to the DB like:</p>\n\n<p>--- !ruby/object:URI::HTTP scheme: http user: password: host: www.a4apps.com port: 80 path: /Websites/SampleCalendar/tabid/89/Default.aspx query: opaque: registry: fragment: parser: </p></li>\n</ol>\n\n<p>I want it like:</p>\n\n<pre><code>http://www.a4apps.com//Websites/SampleCalendar/tabid/89/Default.aspx\n</code></pre>\n\n<p>The reason I'm saving to a Postgres table is I want another task to later modify that table using the URL of each record, and, I'm kind of new to this and was a little overwhelmed by the thought of adding a second DB suggested on the anemone site.</p>\n\n<p>I tried tweaking the basic code over the past few days but haven't found the solution yet. </p>\n\n<p>This is my Rake task:</p>\n\n<pre><code>namespace :db do\n  desc \"Fetch a4apps urls\"\n  task :fetch_a4apps =&gt; :environment do\n    require 'anemone'\n    Anemone.crawl(\"http://www.a4apps.com/\") do |anemone|\n      anemone.on_pages_like(/\\/SampleCalendar\\/[^?]*$/) do |page|\n        Calendarparts.create!(:url =&gt; page.url)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>My view does nothing other than to output the data onto a webpage:</p>\n\n<pre><code>&lt;% @calendar.each do |part| %&gt;\n    &lt;tr valign=\"top\"&gt;...\n             &lt;td&gt;&lt;%= part.url %&gt;&amp;nbsp;&lt;/td&gt;...\n    &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>class CalendarController &lt; ApplicationController\n  def cainventory\n    @calendar = Calendarparts.all\n  end\nend\n</code></pre>\n"},{"tags":["ruby","blocks","tree-traversal"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13199914,"title":"Ruby: Yielding from a method that takes arguments?","body":"<p>I've written a very simple, recursive, tree-traversal method in ruby. I want to yield the results of this traversal so that I can easily iterate through the nodes of the tree. </p>\n\n<pre><code>def bottom_up_traversal (node)\n    if(node.has_leaf_children?)\n        node.children.each{|i| yield i} \n    else\n        node.children.each{|i| bottom_up_traversal(i)}\n        yield node\n    end\n\nend\n</code></pre>\n\n<p>And when I attempt to call it, like:</p>\n\n<pre><code> bottom_up_traversal(@root){|this_node| puts this_node }\n</code></pre>\n\n<p>I get a 'Wrong number of arguments (0 for 1)'. I know this is probably just something silly i'm doing with syntax, but I cannot find any (even basic) examples of this being done....which leads me to believe that I'm misunderstanding how I should be using code-bocks (something which is admittedly new to me)  </p>\n\n<p>So, could you perhaps tell me how I'm supposed to call this method, or where I've gone wrong? </p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13200065,"title":"Rubygems - where are the package downloaded?","body":"<p>When you install a new package, for example, 'gem install fb-graph', where are the files downloaded?  </p>\n"},{"tags":["ruby-on-rails","ruby","sequel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13199680,"title":"Sequel -- How To Construct This Query?","body":"<p>I have a <code>users</code> table, which has a one-to-many relationship with a <code>user_purchases</code> table via the foreign key <code>user_id</code>.  That is, each user can make many purchases (or may have none, in which case he will have no entries in the user_purchases table).</p>\n\n<p><code>user_purchases</code> has only one other field that is of interest here, which is <code>purchase_date</code>.  </p>\n\n<p>I am trying to write a Sequel ORM statement that will return a dataset with the following columns:</p>\n\n<ul>\n<li>user_id</li>\n<li>date of the users SECOND purchase, if it exists</li>\n</ul>\n\n<p>So users who have not made at least 2 purchases will not appear in this dataset.  What is the best way to write this Sequel statement?</p>\n\n<p><strong>Please note I am looking for a dataset with ALL users returned who have >= 2 purchases</strong></p>\n\n<p>Thanks!</p>\n\n<h2>EDIT FOR CLARITY</h2>\n\n<p>Here is a similar statement I wrote to get users and their first purchase date (as opposed to 2nd purchase date, which I am asking for help with in the current post):</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>   DB[:users].join(:user_purchases, :user_id =&gt; :id)\n              .select{[:user_id, min(:purchase_date)]}\n              .group(:user_id)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12652540,"title":"Combine Show and Edit actions in Ruby on Rails?","body":"<p>I was just wondering if anybody has ever built a Rails application without any <em>Show</em> actions.</p>\n\n<p>In my application, if a user picks, say a Project, from the list he will <em>probably</em> want to not just <em>show</em> it but also <em>edit</em> it.</p>\n\n<p>So is it good practice to <strong>not</strong> implement any show actions and instead link all records to edit forms?</p>\n\n<p>The only caveat I see is that a user might accidentally edit a project. But this could be prevented by setting a default attribute <em>disabled</em> on all form fields using jQuery. That way, a user will have to click a button \"Edit\" in order to unlock the form fields for editing.</p>\n\n<p>Does that make sense or am I completely nuts?</p>\n\n<p>Who knows, maybe this causes conflicts with Rails' RESTful architecture?</p>\n"},{"tags":["ruby","deployment","capistrano","symlink"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13199745,"title":"Ruby application deployment symlink target location?","body":"<p>I'm attempting to deploy a very simple ruby (not rails) app using Capistrano on Site5 shared hosting, and so far my cap deploy:setup and cap deploy commands have succeeded so everything is deployed (I'm assuming) behind the public_html screen - so now I need a symlink to the relevant folder. I know this is the public folder of a deployed rails app, but what do I target for a deployed ruby app? </p>\n\n<p>Thanks so much,\nBecky</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13199613,"title":"match two or more object from differents models with mongoid","body":"<p>I have 2 model:</p>\n\n<pre><code>class User\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n\nclass Admin\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n</code></pre>\n\n<p>I want with a mongoid query find all users have a equal email in <code>Admin</code> model, something like:</p>\n\n<pre><code>User.where(:email =&gt; {exist_admin_class?})\n</code></pre>\n\n<p>This is possible? Or I have make a relationship between two model with a <code>has_one User</code> and <code>belongs_to Admin</code></p>\n\n<p>What is the best way to do this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby","facebook","google-app-engine","web-scraping","watir"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13170451,"title":"facebook data to spreadsheet","body":"<p>some of the questions i have read\n<a href=\"http://facebook.stackoverflow.com/questions/1927676/scraping-a-facebook-app-for-data\">Scraping a Facebook App for Data</a></p>\n\n<p><a href=\"http://facebook.stackoverflow.com/questions/2028940/access-to-facebook-data\">Access to facebook data</a></p>\n\n<p>I want to create a spreadsheet that will contain all the diff items that i have in a facebook game, i.e. weapons Armour. I thought this would be fairly easy. I have created a some experience with c++, javascript, php, and to a lesser extent python. I have been able to import the Items to an excel spreadsheet. but it imports every thing on the webpage. and i would like to be able to have seperate sprreadsheets for each type of item and have the spread sheet update automaticly. so i went to the google data api. an the problem there is that facebook wont let my google spreadsheet script access anything it redirects me to the login page(or atleast that is what i suspect because when i run the debug it shows the a redirected url). then i read about how javascript does not work coss domain.<a href=\"http://stackoverflow.com/questions/9284768/cross-domain-javascript\">cross domain javascript</a>. and sience google spript is java based i thought that that might be the problem. so I went to scraperwiki<a href=\"https://scraperwiki.com/\" rel=\"nofollow\">https://scraperwiki.com/</a> and created a spript there in php thinking that would solve the problem. Now i should mention that i have tested if i can access this page without being loged into facebook (meaning i logged out of facebook and called the site and i was able to pull the site up in the browser and use a java shell to get the data i wanted. then when i click another link that requirs me to belogged into facebook the login screen would show up i would click the bookmark to the page i want to get the data from and i can see it and get the data from javashell.) </p>\n\n<p>So after that long story my questions are\n1. will oauth solve this road block?</p>\n\n<ol>\n<li><p>if i created a FB app would i be able to get the data i wanted and then be able to get it to the google spreadsheet?</p></li>\n<li><p>would something like Watin <a href=\"http://stackoverflow.com/questions/tagged/watin\">http://stackoverflow.com/questions/tagged/watin</a> be a better way? (I have no idea what it is capable of)</p></li>\n</ol>\n"},{"tags":["ruby","selenium-webdriver"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13199098,"title":"How to detect flash content using selenium-wedriver?","body":"<p>I'm automating a web site; entire website is in html except few 'Copy' buttons are in flash. As there is no element for that button, I couldn't verify it's functionality (I have to check whether it's clickable &amp; clicking on it results into coping contents in clipboard). Is there any way, we can automate that button's functionality by adding java script snippet or something?<br>\nI'm using ruby api's for automating the site.</p>\n"},{"tags":["ruby","datetime","time"],"answer_count":4,"favorite_count":13,"up_vote_count":63,"down_vote_count":0,"view_count":7849,"score":63,"question_id":1261329,"title":"What's the difference between DateTime and Time in Ruby?","body":"<p>And what factors would cause me to choose one or the other?</p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","performance-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":10436808,"title":"Rails 3.0.12 Performance test issues","body":"<p>I'm trying to run benchmark and performance tests and I'm not getting the metrics displaying...</p>\n\n<p>ruby -v:</p>\n\n<p><code>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-linux]</code></p>\n\n<p>rvm list:</p>\n\n<p><code>=&gt; ruby-1.9.2-p320-perf [ x86_64 ]</code></p>\n\n<p>the result of running <code>rake test:profile</code>:</p>\n\n<pre><code>BrowsingTest#test_homepage (130 ms warmup)\n        process_time: 18446744073.71 sec\n              memory: unsupported\n             objects: unsupported\nBrowsingTest#test_intel_companies_newstats (34 ms warmup)\n        process_time: 26 ms\n              memory: unsupported\n             objects: unsupported\n</code></pre>\n\n<p>and running <code>rake test:benchmark</code></p>\n\n<pre><code>BrowsingTest#test_homepage (103 ms warmup)\n           wall_time: 23 ms\n              memory: 0.00 KB\n             objects: 0\n             gc_runs: 0\n             gc_time: 0.00 ms\nBrowsingTest#test_intel_companies_newstats (31 ms warmup)\n           wall_time: 9 ms\n              memory: 0.00 KB\n             objects: 0\n             gc_runs: 0\n             gc_time: 0.00 ms\n</code></pre>\n\n<p>my gem file</p>\n\n<pre><code>group :test do\n    gem 'capybara'\n\n    # for performance tests\n    gem 'ruby-prof', :git =&gt; 'git://github.com/wycats/ruby-prof.git'\n    gem 'test-unit'\nend\n</code></pre>\n\n<p>When I tried to run:</p>\n\n<p><code>rvm install 1.9.2 --patch gcdata --name perf</code></p>\n\n<p>I got:</p>\n\n<pre><code>Installing Ruby from source to: /home/victor/.rvm/rubies/ruby-1.9.2-p320-perf, this may take a while depending on your cpu(s)...\n\nruby-1.9.2-p320-perf - #fetching \nruby-1.9.2-p320-perf - #extracting ruby-1.9.2-p320 to /home/victor/.rvm/src/ruby-1.9.2-p320-perf\nruby-1.9.2-p320-perf - #extracted to /home/victor/.rvm/src/ruby-1.9.2-p320-perf\nPatch 'gcdata' not found.\n</code></pre>\n"},{"tags":["ruby","amazon-s3","amazon-ec2","amazon-web-services"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13049707,"title":"Any command line tool for mounting AWS S3 in Ruby?","body":"<p>I need a command line tool which mounts the S3 buckets to my EC2 file system.</p>\n\n<p>I know there are tools available, but we are looking for a tool that makes use of the IAM roles of the machine. That is: the tool doesn't expect the access and secret key, but rather get them from machine metadata.</p>\n\n<p>Does such a tool exist in Ruby? Or any other language for that matter? We'd prefer Ruby, since we can tweak it as per our need.</p>\n"},{"tags":["ruby","rhel"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13192717,"title":"How Can I install ruby on Redhat? ruby package not found","body":"<p>I dont' know why I cannot install ruby through yum in my RHEL6.2\nHow can I fix it. I don't wanna install through source. Any idea?</p>\n\n<pre><code>[root@kithost ~]# yum install ruby\nLoaded plugins: product-id, refresh-packagekit, security, subscription-manager\nUpdating certificate-based repositories.\nSetting up Install Process\nNo package ruby available.\nError: Nothing to do\n</code></pre>\n\n<p>RVM is a solution but it is not that I want.</p>\n\n<p>What I want to know is that once we can't find any package from yum, what kind of thing should we fix into order to let yum find it?</p>\n"},{"tags":["ruby","osx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13197022,"title":"How to make object persist in Ruby?","body":"<p>When running a ruby script, is it possible to have objects persist in memory over multiple invocations?</p>\n\n<pre><code>ruby run.rb\n</code></pre>\n\n<p>Working in OSX.</p>\n"},{"tags":["ruby","process","bluepill"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12634153,"title":"Kill all process of bluepill","body":"<p>I have set bluepill process on my live server and after few days I have killed all the commands and removed repo out of the server . Now since long I am getting logs related to bluepill like,</p>\n\n<pre><code>Sep 27 23:21:05 team bluepilld[26961]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/application.rb:36:in `mutex'\nSep 27 23:21:05 team bluepilld[26961]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/application.rb:137:in `run'\nSep 27 23:21:05 team bluepilld[26961]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/application.rb:131:in `start_server'\nSep 27 23:21:05 team bluepilld[26961]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/application.rb:41:in `load'\nSep 27 23:21:05 team bluepilld[26961]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/dsl.rb:6:in `application'\nSep 27 23:21:05 team bluepilld[26961]: [config:ibt_emw_config] /home/rails/applications/no_config/bluepill/config_git/run_emwebsocket.pill:1\nSep 27 23:21:05 team bluepilld[31026]: [config:ibt_emw_config] Going from down =&gt; starting\nSep 27 23:21:08 team bluepilld[31026]: [config:ibt_emw_config] pid_file /home/rails/applications/config/tmp/emw_pid.pid does not exist or cannot be read\nSep 27 23:21:08 team bluepilld[31026]: [config:ibt_emw_config] pid_file /home/rails/applications/config/tmp/emw_pid.pid does not exist or cannot be read\nSep 27 23:21:08 team bluepilld[31026]: [config:ibt_emw_config] Going from starting =&gt; down\nSep 27 23:21:09 team bluepilld[31026]: [config:ibt_emw_config] pid_file /home/rails/applications/config/tmp/emw_pid.pid does not exist or cannot be read\nSep 27 23:21:09 team bluepilld[31026]: [config:ibt_emw_config] pid_file /home/rails/applications/config/tmp/emw_pid.pid does not exist or cannot be read\nSep 27 23:21:09 team bluepilld[31026]: [config:ibt_emw_config] Executing start command: ruby server.rb\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] Errno::ENOENT - No such file or directory - /home/rails/applications/config/tmp/emw_pid.pid\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/rubies/ruby-1.8.6-p420/lib/ruby/1.8/fileutils.rb:1033:in `initialize'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/rubies/ruby-1.8.6-p420/lib/ruby/1.8/fileutils.rb:1033:in `open'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/rubies/ruby-1.8.6-p420/lib/ruby/1.8/fileutils.rb:1033:in `touch'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/rubies/ruby-1.8.6-p420/lib/ruby/1.8/fileutils.rb:1027:in `each'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/rubies/ruby-1.8.6-p420/lib/ruby/1.8/fileutils.rb:1027:in `touch'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/system.rb:208:in `can_write_pid_file'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/system.rb:68:in `daemonize'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/bluepill-0.0.47/lib/bluepill/process.rb:251:in `start_process'\nSep 27 23:21:09 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/eval_helpers.rb:56:in `send'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/eval_helpers.rb:56:in `evaluate_method'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/callback.rb:191:in `run_methods'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/callback.rb:190:in `each'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/callback.rb:190:in `run_methods'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/callback.rb:159:in `call'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/transition.rb:443:in `after'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/transition.rb:443:in `each'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/transition.rb:443:in `after'\nSep 27 23:21:10 team bluepilld[26962]: [config:ibt_emw_config] /home/rails/.rvm/gems/ruby-1.8.6-p420@config/gems/state_machine-1.1.2/lib/state_machine/transition.rb:441:in `catch'\n</code></pre>\n\n<p>I have tried finding process giving command <code>ps aux | grep bluepill</code></p>\n\n<p>And killed all processes . Will that do the job for me?</p>\n\n<p>I want to remove everything related to bluepill . Should i remove gem ? Will it help in removing background process ?</p>\n"},{"tags":["ruby","uri"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13197605,"title":"Alternative to URI.parse that allows hostnames to contain an underscore","body":"<p>I'm using <a href=\"http://rdf.dmoz.org\" rel=\"nofollow\">DMOZ</a>'s <a href=\"http://rdf.dmoz.org/rdf/content.rdf.u8.gz\" rel=\"nofollow\">list of url topics</a>, which contains some urls that have hostnames that contain an underscore.</p>\n\n<p>For example:</p>\n\n<pre><code>608  &lt;ExternalPage about=\"http://outer_heaven4.tripod.com/index2.htm\"&gt;\n609    &lt;d:Title&gt;The Outer Heaven&lt;/d:Title&gt;\n610    &lt;d:Description&gt;Information and image gallery of McFarlane's action figures for Trigun, Akira, Tenchi Muyo and other Japanese Sci-Fi animations.&lt;/d:Description&gt;\n611    &lt;topic&gt;Top/Arts/Animation/Anime/Collectibles/Models_and_Figures/Action_Figures&lt;/topic&gt;\n612  &lt;/ExternalPage&gt;\n</code></pre>\n\n<p>While this url will work in a web browser (or, at least, it does in mine :p), <a href=\"http://en.wikipedia.org/wiki/Hostname#Restrictions_on_valid_host_names\" rel=\"nofollow\">it's not legal according to the standard</a>:</p>\n\n<blockquote>\n  <p>a hostname may not contain other characters, such as the underscore character (_), </p>\n</blockquote>\n\n<p>which causes errors when trying to parse such URL with <code>URI.parse</code>:</p>\n\n<pre><code>[2] pry(main)&gt; require 'uri'\n=&gt; true\n[3] pry(main)&gt; URI.parse \"http://outer_heaven4.tripod.com/index2.htm\"\nURI::InvalidURIError: the scheme http does not accept registry part: outer_heaven4.tripod.com (or bad hostname?)\nfrom ~/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/generic.rb:213:in `initialize'\n</code></pre>\n\n<p>Is there an alternative to <code>URI.parse</code> I can use that has lower strictness without just rolling my own?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13196493,"title":"How should I refactor create_unique methods in Rails 3?","body":"<p>I have following ugly create_unique method in few models ex:</p>\n\n<pre><code>  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>And then in controllers #create actions I have</p>\n\n<pre><code>s = Subscription.create_unique({:user_id =&gt; current_user.id, :app_id =&gt; app.id})\nif s\n  raise Exceptions::NotAuthorized unless current_user == s.user\n  @app = s.app\n  s.destroy\n  flash[:notice] = 'You have been unsubscribed from '+@app.name+'.'\n  redirect_to '/'\nend\n</code></pre>\n"},{"tags":["ruby","sass","compass-css"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13129789,"title":"Using Compass from Ruby (not shell)","body":"<p>I am building a script in Ruby where I would like to compile a single SCSS file using Compass. I am trying to make this as simple as possible, and would like to avoid using a config.rb file. I just want to set a couple settings via straight Ruby and tell Compass to compile a single SCSS file into a CSS file. </p>\n\n<p>I know that this has to be possible but I have not been able to find any decent documentation on how to do it. Any help would be appreciated.</p>\n"},{"tags":["ruby","mongodb","sorting"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13196636,"title":"mongodb multifield sort","body":"<p>I wonder how to do multifield sorting in mongodb driver of ruby</p>\n\n<p><a href=\"http://api.mongodb.org/ruby/current/file.TUTORIAL.html#Sorting_Documents_in_a_Collection\" rel=\"nofollow\">Example of sorting from official site</a> where we can find the following example:</p>\n\n<pre><code># Sort in ascending order by :i\ncoll.find.sort(:i)\n\n# Sort in descending order by :i\ncoll.find.sort(:i =&gt; :desc)\n</code></pre>\n\n<p>According to these examples I tired to do something like this</p>\n\n<pre><code>coll.find.sort(:i,:j)\n</code></pre>\n\n<p>and this is didn't work</p>\n\n<p>Do you know the right way to do multifield sorting in ruby driver.</p>\n"},{"tags":["ruby-on-rails","ruby","mysql2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":691,"score":0,"question_id":6407429,"title":"Ruby on Rails mysql2 adapter problem","body":"<p>I have installed ruby and rails and my application gives me an error when I am trying to run </p>\n\n<p>rake db:migrate</p>\n\n<p>this is the result of the command rake db:migrate --trace</p>\n\n<pre><code>** Execute db:migrate\nrake aborted!\n!!! Missing the mysql2 gem. Add it to your Gemfile: gem 'mysql2'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/mysql_adapter.rb:22:in `rescue in mysql_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/mysql_adapter.rb:19:in `mysql_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:229:in `new_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:237:in `checkout_new_connection'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:191:in `block (2 levels) in checkout'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:187:in `loop'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:187:in `block in checkout'\n/usr/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:186:in `checkout'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:94:in `connection'\n/usr/lib/ruby/gems/1.9.1/gems/ar-octopus-0.3.4/lib/octopus/proxy.rb:83:in `select_connection'\n/usr/lib/ruby/gems/1.9.1/gems/ar-octopus-0.3.4/lib/octopus/proxy.rb:177:in `send_queries_to_selected_slave'\n/usr/lib/ruby/gems/1.9.1/gems/ar-octopus-0.3.4/lib/octopus/proxy.rb:140:in `method_missing'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:454:in `get_all_versions'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:583:in `migrated'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:492:in `current_version'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `block in migrate'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `each'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `detect'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:509:in `migrate'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:433:in `up'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/migration.rb:415:in `migrate'\n/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.0.6/lib/active_record/railties/databases.rake:142:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `call'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:636:in `block in execute'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `each'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:631:in `execute'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:597:in `block in invoke_with_call_chain'\n/usr/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block (2 levels) in top_level'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `each'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2029:in `block in top_level'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2001:in `block in run'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/lib/rake.rb:1998:in `run'\n/usr/lib/ruby/gems/1.9.1/gems/rake-0.8.7/bin/rake:31:in `&lt;top (required)&gt;'\n/usr/bin/rake:19:in `load'\n/usr/bin/rake:19:in `&lt;main&gt;'\nconfiz@confiz-desktop:~/mango_apps/rails_app_sms$ .\nbash: .: filename argument required\n.: usage: . filename [arguments]\n</code></pre>\n\n<p>I have already mentioned gem in my gemfile and already executed bundle install.</p>\n\n<p>My database.yml file already has the correct adapter i.e. adapter: mysql2</p>\n\n<p>Please help me resolve this problem.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13196881,"title":"Capybara::ElementNotFound: for jquery ui dialog box content","body":"<p>I have my Login form into the Jquery UI Dialog popup box. When I start doing RSpec test, I got an error with </p>\n\n<pre><code>Failure/Error: fill_in \"Username\", with: \"user@example.com\"\nCapybara::ElementNotFound\ncannot fill in, no text field, text area or password field with id, name, or label 'Username' found\n</code></pre>\n\n<p>Here is my spec/request page:</p>\n\n<pre><code>describe \"create user\", :js =&gt; true do\n\n  before { visit new_enr_rds_dea_path }\n\n  let(:submit) { \"Create Dea\" }\n\n  describe \"with invalid information\" do\n    it \"should not create a user\" do\n      expect { click_button submit }.not_to change(Enr::Rds::Dea, :count)\n    end\n  end\n\n  describe \"with valid information\" do\n    before do\n      fill_in \"Username\", with: \"user@example.com\"\n      fill_in \"Password\", with: \"foobar\"\n      fill_in \"Confirm password\", with: \"foobar\"\n      fill_in \"Organisation\", with: \"foobar\"\n    end\n\n    it \"should create a user\" do\n      expect { click_link_or_button submit }.to change(Enr::Rds::Dea, :count).by()\n    end\n  end\n</code></pre>\n\n<p>Factories.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :dea_user do |user|\n    user.dea_user             \"example@in4systems.com\"\n    user.dea_pwd              \"foobar\"\n    user.dea_pwd_confirmation \"foobar\"\n    user.pro_organisation_id  \"NHER\"\n  end\nend\n</code></pre>\n\n<p>I am rendering my new and edit page to the Form partial. Both <code>New</code> and <code>edit</code> button has <code>:remote =&gt; true</code> method to open the JqueryUI dialog box. Thanks..</p>\n"},{"tags":["ruby-on-rails","ruby","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13193794,"title":"Ruby on Rails - encoding issue","body":"<p>I am running a RoR app that pulls data from some event tables which are using utf8_general_ci as collation.</p>\n\n<p>The problem is that all my pages render stuff like this:</p>\n\n<p>Atat�rk Stadi Nov 02 20:00</p>\n\n<p>So far I have tried:\n- changing the encoding within application.rb</p>\n\n<ul>\n<li><p>adding</p>\n\n<pre><code>&lt;meta charset=\"utf-8\" /&gt;\n</code></pre></li>\n<li><p>adding </p>\n\n<pre><code>content=\"text/html;charset=utf-8\"\n</code></pre></li>\n<li><p>all combinations of above tags with all possible relevant encodings that may apply to our content.</p></li>\n</ul>\n\n<p>Document type is </p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n</code></pre>\n\n<p></p>\n\n<p>I have also tried HTML5 and other variations. </p>\n\n<p>I have not yet tried the iconv solution, would prefer not having to go down that road.</p>\n\n<p>Does anyone have any idea on how to resolve this?</p>\n\n<p>Thank you!\nN.</p>\n"},{"tags":["ruby-on-rails","ruby","datetime"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":287,"score":0,"question_id":10463400,"title":"Age calculation in Ruby","body":"<p>I'm trying to write a rails application but presently the display for the date of birth is shown like the normal date format, but I wouldl love to show in views the age instead</p>\n\n<p>The method I have in controller is below and I have a column DOb in my database for date of birthL</p>\n\n<pre><code>def age\n  @user = user\n  now = Time.now.utc.to_date\n  now.year - @user.dob.year - (@user.dob.to_date.change(:year =&gt; now.year) &gt; now ? 1 : 0)\nend\n</code></pre>\n\n<p>It shows like DOB: 23/5/2011, but I would like it to be age in years instead.</p>\n\n<p>How do I also put a validator that checks if age is below 18 years?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":11,"favorite_count":11,"up_vote_count":31,"down_vote_count":0,"view_count":7975,"score":31,"question_id":819263,"title":"Get person's age in Ruby","body":"<p>I'd like to get a person's age from its birthday. <code>now - birthday / 365</code> doesn't work, because some years have 366 days. I came up with the following code:</p>\n\n<pre><code>now = Date.today\nyear = now.year - birth_date.year\n\nif (date+year.year) &gt; now\n  year = year - 1\nend\n</code></pre>\n\n<p>Is there a more Ruby'ish way to calculate age?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13194406,"title":"how to remove single quotes(') in ruby on rails","body":"<pre><code>@content = \"&lt;p&gt;&lt;span style=\\\"font-family: 'trebuchet ms', 'geneva'; font-size: 'large';\\\"&gt;Helo's&lt;/span&gt;&lt;/p&gt;\"\n</code></pre>\n\n<p>I want to remove single quotes (<code>'</code>) from <code>&lt;style&gt;</code> but not from the <code>Helo's</code>. Right now I'm using this but this remove all the single quotes(<code>'</code>).</p>\n\n<pre><code>@content.gsub(/'/,\"\")\n</code></pre>\n"},{"tags":["ruby","selenium","selenium-webdriver"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13176963,"title":"Timeout::Error for selenium while loading heavy page","body":"<p>I'm facing a Timeout::Error issue while loading heavy web page. I observed that even if I added an implicit wait call <code>@driver.manage.timeouts.implicit_wait = 300</code>, a timeout error is thrown before 300 seconds - it's thrown in around 60-70 seconds.</p>\n\n<p>Error thrown is -</p>\n\n<pre><code>Timeout::Error\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:146:in `rescue in rbuf_fill'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:140:in `rbuf_fill'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:122:in `readuntil'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:132:in `readline'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:2562:in `read_status_line'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:2551:in `read_new'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1319:in `block in transport_request'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1316:in `catch'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1316:in `transport_request'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1293:in `request'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1286:in `block in request'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:745:in `start'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1284:in `request'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:82:in `response_for'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:38:in `request'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:40:in `call'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:576:in `execute'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:99:in `get'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/navigation.rb:14:in `to'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/driver.rb:108:in `get'\nbacklot.rb:17:in `test_backlot'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:949:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit/testcase.rb:17:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:787:in `block in _run_suite'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:780:in `map'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:780:in `_run_suite'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:565:in `block in _run_suites'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:563:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:563:in `_run_suites'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:746:in `_run_anything'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:909:in `run_tests'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:896:in `block in _run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:895:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:895:in `_run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/minitest/unit.rb:884:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:21:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:326:in `block (2 levels) in autorun'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:27:in `run_once'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/test/unit.rb:325:in `block in autorun'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","encoding","character-encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":258,"score":0,"question_id":7327461,"title":"Is there a solution to the character encoding problem (\"�\") for Rails 2 / Ruby 1.8.7?","body":"<p>From the <a href=\"http://weblog.rubyonrails.org/2010/8/29/rails-3-0-it-s-done\" rel=\"nofollow\">Rails 3 announcement</a> listing the major new features:</p>\n\n<blockquote>\n  <p>Say goodbye to encoding issues</p>\n  \n  <p>If you browse the Internet with any frequency, you will likely encounter the � character. This problem is extremely pervasive, and is caused by mixing and matching content with different encodings.</p>\n  \n  <p>In a system like Rails, content comes from the database, your templates, your source files, and from the user. Ruby 1.9 gives us the raw tools to eliminate these problems, and in combination with Rails 3, � should be a thing of the past in Rails applications. Never struggle with corrupted data pasted by a user from Microsoft Word again!</p>\n</blockquote>\n\n<p>I have an app where users often paste in text from MS Word and we encounter exactly this issue.</p>\n\n<p>However we're running Rails 2 and Ruby 1.8.7. There is no immediate prospect of changing this.</p>\n\n<p>I think the encoding problem usually manifests with typographer's quotes (\"curly quotes\"). Probably also things like em dashes and the elipses character.</p>\n\n<p>I'm wondering if there's routine I can run on the incoming data to overcome this problem.</p>\n\n<p>It's OK if the quotes get turned into straight quotes, elipses get turned into three periods, etc.</p>\n\n<p>It could even be a utility that runs on the system level that I could call from my app with </p>\n\n<pre><code>processed_data = `system_command #{params[:incoming_data]}`\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13184406,"title":"Can 'rake db:seed' tell you which record it is choking on?","body":"<p>When seeding data, I sometimes get an error like this:</p>\n\n<pre><code>Owner(#70279918514200) expected, got String(#70279913263500)\n</code></pre>\n\n<p>Would it be possible for Rake to tell me what record it is choking on?</p>\n\n<p>EDIT:</p>\n\n<p>This has a little more info on what I'm looking for:</p>\n\n<p>I have a flat file which indicates the data I need. This file was created from an unvalidated database that had many different spelling for things like Proctor (and|y|avec|gen) Gamble. I have been able to translate almost all of them, but there have been some that slip through the cracks and still give me trouble. Would it be possible to see from rake which line of the flat file when I run</p>\n\n<pre><code>flat_file.each_line\n</code></pre>\n\n<p>is causing trouble?</p>\n"},{"tags":["ruby","activerecord","squeel"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13182077,"title":"Squeel syntax for field = value OR field IS NULL in a loop","body":"<p>I'm trying to recreate the following syntax using squeel by using a loop:</p>\n\n<pre><code>WHERE season = \"value\" OR season IS NULL\n</code></pre>\n\n<p>I was able to get this far:</p>\n\n<pre><code>where do\n  ((season == entry[\"season\"]) | (season == nil)) &amp;\n  ((episode == entry[\"episode\"]) | (episode == nil)) &amp;\n  ((imdb == entry[\"imdb\"]) | (imdb == nil)) &amp;\n  (YEAR(theatrical) == year)\n</code></pre>\n\n<p>However, the problem is I want to do it <strong>in a loop</strong> so I don't have to do conditionals for when the values are empty (for example if imdb doesn't have a value I wouldn't even use that line).</p>\n\n<p>I have this:</p>\n\n<pre><code>entry = { \"imdb\"=&gt;\"0364725\", \"media\"=&gt;\"DVD\", \"season\"=&gt;\"1\", ...}\nentry.each do |k,v|\n    ((k == v) | (k == nil))\n  end\nend\n</code></pre>\n\n<p>But it does not put the <code>field IS NULL</code> bit in the SQL. </p>\n\n<p>If it's not possible with Squeel, might it be done with ActiveRecord?</p>\n\n<p>Ultimately, I'm looking for a way to avoid having conditionals for those fields in the SQL. As I said above, if the field is empty I don't list them at all, but if it has a value I need to do the whole <code>field = value OR field IS NULL</code> bit.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>The whole code I'm trying to use at the moment is this:</p>\n\n<pre><code>matches_found = \nincludes(:dvd_director, :dvd_upc, :dvd_series).limit(1).\nwhere do\n  (title == title_to_search) &amp;\n  entry.each { |k,v| ((k == v) | (k == nil)) }\nend\n</code></pre>\n\n<p>Note that everything after the <code>|</code> is getting ignored whether I use <code>__send__(k)</code> or not.</p>\n\n<p><strong>More info:</strong>\nOne very strange thing is that if I use anything other than the <code>k,v</code> it gets ignored. For example:</p>\n\n<pre><code>    entry.each { |k,v| ((k == \"bob\") | (k == v)) }\n</code></pre>\n\n<p>\"Bob\" gets ignored! and the value (v) gets put into the SQL without the <code>OR</code> statement.</p>\n"},{"tags":["ruby","soap","ssl","soapui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13179461,"title":"Soap SSL exception: unexpected message","body":"<p>I'm connecting to a web service using SoapUI just to try to make it work. It successfully reads the WSDL file and creates the methods, however, when I run a particular method, I get this error in the log:</p>\n\n<pre><code>\"ERROR:Exception in request: javax.net.ssl.SSLException: Received fatal alert: unexpected_message\"\n</code></pre>\n\n<p>and this error in the error log:</p>\n\n<pre><code>\"at sun.security.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source)\"\n</code></pre>\n\n<p>(I copied the most important part for breavity.)</p>\n\n<p>I'm also trying to integrate to that service with Ruby and this is what I get there:</p>\n\n<pre><code>\"SSL_connect returned=1 errno=0 state=SSLv2/v3 read server hello A:\nsslv3 alert unexpected message\"\n</code></pre>\n\n<p>I tried it under both Windows and Linux and get the same error.</p>\n\n<p>I talked to the server admin of the service and he told me the server is set to accept SSLv3. </p>\n\n<p>I tried using <code>\"-Dsun.security.ssl.allowUnsafeRenegotiation=true\"</code> in SoapUI, but to no avail.</p>\n"},{"tags":["ruby","rbenv"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":563,"score":4,"question_id":10940736,"title":"rbenv not changing ruby version","body":"<p>So i installed rbenv according to the github directions. I am running OSX but i have tried this on a Ubuntu 12.04 VM and got the same results. The following is what i get in my terminal when i try to change ruby versions:</p>\n\n<pre><code>rbenv versions\n* 1.9.3-p0 (set by /Users/user/.rbenv/version)\n1.9.3-p125\n\nrbenv global\n1.9.3-p0\n\nrbenv rehash\n\nruby -v\nruby 1.8.7 (2011-12-28 patchlevel 357) [universal-darwin11.0]\n\nwhich ruby\n/usr/bin/ruby\n</code></pre>\n\n<p>Anyone have any ideas as to why rbenv isnt actually switching the ruby version like it thinks it is? Aslo there is no .rbenv file in the local directory that would be causing the ruby version to default to 1.8.7</p>\n\n<pre><code>rbenv local\nrbenv: no local version configured for this directory\n</code></pre>\n"},{"tags":["ruby","video","markdown","highlight","jekyll"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":327,"score":2,"question_id":10529859,"title":"how to include video in jekyll markdown blog","body":"<p>I just started blogging using jekyll. I write my posts in markdown. Now,  I want to include a youtube video in my post. How can I do this?</p>\n\n<p>Also, I dont really like the pygments highlighting provided by jekyll by default. Is there anyway I can change  this to some other style? If yes, can you point me to some nice styles/plugins? </p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13193586,"title":"Ruby: how to get parent method that redefined in children class","body":"<p>How can i get Base's \"hello\" method from Up class in code below?</p>\n\n<pre><code>class Base\n  def hello\n    p 'hello from Base'\n  end\nend\n\nclass Up &lt; Base\n  def hello_orig\n    # how to call hello from Base class?\n  end\n\n  def hello\n    p 'hello from Up'\n  end\nend\n\nu = Up.new\nu.hello_orig # should return 'hello from Base' \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":46,"score":3,"question_id":13192265,"title":"Refactoring a switched block statement for group_by in Ruby on Rails","body":"<p>How can I rewrite this code so it's completely dynamic, and I don't have to use the <code>case</code> clause to manually list all possible values of <code>@group</code>?</p>\n\n<pre><code># Grouping\n@group = params[:group] if !params[:group].blank?\ncase @group\n  when 'category_id'\n    @ideas_grouped = @ideas.group_by { |i| i.category_id }\n  when 'status_id'\n    @ideas_grouped = @ideas.group_by { |i| i.status_id }\n  when 'personal_bias'\n    @ideas_grouped = @ideas.group_by { |i| i.personal_bias }\n  when 'business_value'\n    @ideas_grouped = @ideas.group_by { |i| i.business_value }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":29,"score":-2,"question_id":13193657,"title":"Rails - how to build PC configurator? Is there any appropriate gem?","body":"<p>My client require to his e-commerce PC configurator. In the database are stored CPUs, RAM memories, HDDs etc.</p>\n\n<p>How can I implement PC configurator according to data which are stored in the database?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","regex","ruby-on-rails-3","substring"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13192578,"title":"Fetching the substring contained between two specific words","body":"<p>I wanted to know how to proceed when I am interested in the text contained between particular words.\neg.</p>\n\n<pre><code>@var = \"Hi, I want to extract container_start ONLY THIS DYNAMIC CONTENT container_end from the message contained between the container_start and container_end \"\n</code></pre>\n\n<p>Now I want to extract the CAPITALIZED content from the string i.e. dynamic but always contained after the two containers (<code>container_start</code> and <code>container_end</code>)</p>\n"},{"tags":["ruby","read-eval-print-loop"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13190138,"title":"What command opens Ruby's REPL?","body":"<p>What command opens Ruby's REPL?</p>\n\n<p>In Python, you simply open <code>python</code> without any arguments.</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13145391,"title":"How to duplicate a File as a TempFile?","body":"<p>I am currently developing a script that look for files in a specific folder.\nI want to duplicate those files. Then I want to remove some useless lines from those duplicate files, parse them in YAML (this is the format of content in it). And finally make a diff of the files.</p>\n\n<p>I was firstly thinking to copy them in a <code>tmp</code> folder but I just discovered the existence of <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/tempfile/rdoc/Tempfile.html\" rel=\"nofollow\"><code>Tempfile</code></a> which seems to be exactly what I need since the temporary files have to be deleted after the script has done its job.</p>\n\n<p>What I have for now:</p>\n\n<pre><code>require 'Tempfile'\nrequire 'YAML'\n\nPWD = File.dirname(__FILE__)\nLOCALES_FOLDER_PATH = \"#{PWD}/../app/assets/javascripts/ayl/bo/config/locales\"\nLOCALES = ['en', 'fr']\n\nfiles_data = {}\nlocale_file_names = LOCALES.map{|locale| \"#{locale}.js.coffee\"}\nfiles = locale_file_names.map do |locale_file_name|\n  files_data[locale_file_name] = \"#{LOCALES_FOLDER_PATH}/#{locale_file_name}\"\nend\n\nlocale_files = []\nfiles.each do |file|\n\n  content = File.open(file).read\n  locale_file = Tempfile.open file.gsub(\"/\", \"_\") do |f|\n    f.write content\n    f.flush\n    puts f.read\n  end\n  locale_files &lt;&lt; locale_file\n\nend\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>± ruby diff_locales.rb\n/Users/adrien/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/YAML.rb:48: warning: already initialized constant ENGINE\n/Users/adrien/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/YAML.rb:69: warning: already initialized constant ENGINE\n/Users/adrien/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/YAML.rb:73: warning: already initialized constant ENGINE\n\n\n±\n</code></pre>\n\n<p>The content of my temporary files is empty.</p>\n\n<p>This seems weird to me. But I assume their is something I just do not know/understand.</p>\n\n<hr>\n\n<p><strong>OK!</strong> I'm really sorry. Inside the block, I had to move the cursor back to the beginning of the file before reading the content.</p>\n\n<p>So dummy…</p>\n"},{"tags":["ruby","nosql","couchbase"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13185851,"title":"How to query Couchbase 1.8 JSON?","body":"<p>I am new to couchbase.</p>\n\n<p>I am taking a look at the new Couchbase 2 beta version and the JSON docs, indexes, views, querys look just great.</p>\n\n<p>Thing is that I have to develop under version 1.8 and I can't get the way to query my JSON objects. I am the using ruby client.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":13191779,"title":"Theme support with assets pipeline","body":"<p>I have following project structure:</p>\n\n<pre><code>/app\n/config\n/db\n...\n/themes\n  /default\n    /assets\n      /images\n      /stylesheets\n      /...\n    /views\n      /...\n  /theme1\n   /assets\n     /...\n   /views\n     /...\n</code></pre>\n\n<p>'default' theme should be used by default :). 'theme1' - should override any, eg logo.png or view (application.erb).</p>\n\n<p>It should work in this way: try to get asset from 'theme1' if absent - use from 'default'.</p>\n\n<p>Pretty simple with views:</p>\n\n<pre><code>self.prepend_view_path ::ActionView::FileSystemResolver.new(theme_view_path_for(name))\nself.prepend_view_path ::ActionView::FileSystemResolver.new(default_theme_path)\n</code></pre>\n\n<p>But i cant resolve it with assets.</p>\n\n<pre><code>config.assets.paths &lt;&lt; \"#{Rails.root}/themes/default/assets/stylesheets\"\nconfig.assets.paths &lt;&lt; \"#{Rails.root}/themes/default/assets/images\"\nconfig.assets.paths &lt;&lt; \"#{Rails.root}/themes/default/assets/javascript\"\n</code></pre>\n\n<p>This adds assets as usual, eg asset can be accessed with url 'assets/logo.png', but i need prefixed one - \"assets/theme1/logo.png\".\nAlso if 'theme1' doesnt override logo.png by \"assets/theme1/logo.png\" url should 'default' theme logo returned. (Similar to above with views).</p>\n\n<p>I have tried themes_for_rails - but it doesnt fit, because they override whole assets structure (own controller for serving, etc).</p>\n\n<p>Also, it would be great to have ability to hook into assets resolve,\nwhen accessing logo1.png, it should be possible to serve it with my controller and return it from database, for example.</p>\n\n<p>Thanks for any advice, i'll share with results when finish.</p>\n\n<p>Kirill Salykin</p>\n"},{"tags":["ruby","ruby-on-rails-3","remedy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13192426,"title":"accessing a database from ruby using an odbc driver (Remedy)","body":"<p>I have the Remedy odbc driver installed on my machine. I am able to pull down data from Remedy via excel just fine specifying this driver in my connection.</p>\n\n<p>Is there any way I could use this driver from within Ruby / Ruby on rails to connect to and read from the DB? </p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13192008,"title":"When are class variables actually useful?","body":"<p>If you look around you'll <a href=\"http://stackoverflow.com/questions/7072269/should-i-use-class-variables-or-class-instance-variables-for-class-static-variab\">find some comparisons of class variables to class instance variables</a>, and the best I ever hear of class variables are \"that might be what you want\", but I've never heard anybody say that <em>is</em> what they want, or when the situation of sharing a variable across an entire inheritance tree might be more useful.</p>\n\n<p>So <strong>in practice</strong>, when is a class variable a better choice than a class instance variable?</p>\n"},{"tags":["javascript","ruby","regex"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13191736,"title":"Javascript Regular expressions bug","body":"<p>To start off, here's my regular expression:</p>\n\n<pre><code>&lt;span class=\"iteration\"&gt;\\d&lt;\\/span&gt;.*?&lt;span class=\"definition\"&gt;(.*?)[:|.]&lt;\\/span&gt;\n</code></pre>\n\n<p>so I'm curious as to what's going on here. \nRubular &amp;&amp; Scriptular are getting two different results.</p>\n\n<p>So, check these out, totally getting the same results:</p>\n\n<p><a href=\"http://rubular.com/r/L1uHDqLOF1\" rel=\"nofollow\"><strong>RUBULAR</strong> no bugs</a></p>\n\n<p><a href=\"http://scriptular.com/#%28%5Ba-zA-Z%5D+%29,%20%28%5Ba-zA-Z%5D+%29%7C%7C%7C%7C%7C%7C%7C%7C%5B%22Doug,%20bacon%22,%22Cole,%20eggs%22,%22Ellen,%20heroin%22%5D\" rel=\"nofollow\"><strong>SCRIPTULAR</strong> no bugs</a></p>\n\n<p>Now, scriptular is getting the wrong output in this next example, it's not just Scriptular, when I do this in Javascript it bugs out as well and doesn't get the right output.</p>\n\n<p><a href=\"http://rubular.com/r/Rsf1SZndmq\" rel=\"nofollow\"><strong>RUBULAR</strong> no bugs</a></p>\n\n<p><strong>SCRIPTULAR</strong> buggggggin like mad!!!!!</p>\n\n<p>So, I can't hyperlink this, you'll have to input the data yourself <a href=\"http://rubular.com/r/Rsf1SZndmq\" rel=\"nofollow\"><strong>from the 2nd Rubular link</strong></a>, because whoever made Scriptular done goofed and made it so that permalinks become as long as the (regular expression + string input) that you give to it.</p>\n\n<p>Whoever made Scriptular, <a href=\"http://www.splicd.com/bSuvOVH0aSQ/534/536\" rel=\"nofollow\"><strong>gooddddd dayyyum</strong></a>, please fix your permalink generator.\nThis thing was 7569 characters long...</p>\n\n<p>But seriously, any ideas as to what's up guys?</p>\n"},{"tags":["ruby-on-rails","ruby","internationalization","gem","translation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13162265,"title":"Rails-i18n would'nt load translations","body":"<p>I've added the gem \"rails-i18n\" but when I try to get the transaltion of \"date.order\". All fails, but when I write the translation in my own file app, it works ?</p>\n\n<p><strong>Update 10/31/2012</strong>\nMy gem file is :</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'rails', '3.2.8'\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\ngem 'jquery-rails'\ngem \"mysql2\", \"&gt;= 0.3.11\"\ngem \"haml\", \"&gt;= 3.1.7\"\ngem \"haml-rails\", \"&gt;= 0.3.5\", :group =&gt; :development\ngem \"hpricot\", \"&gt;= 0.8.6\", :group =&gt; :development\ngem \"ruby_parser\", \"&gt;= 2.3.1\", :group =&gt; :development\ngem \"rspec-rails\", \"&gt;= 2.11.4\", :group =&gt; [:development, :test]\ngem \"capybara\", \"&gt;= 1.1.2\", :group =&gt; :test\ngem \"email_spec\", \"&gt;= 1.2.1\", :group =&gt; :test\ngem \"factory_girl_rails\", \"&gt;= 4.1.0\", :group =&gt; [:development, :test]\ngem \"bootstrap-sass\", \"&gt;= 2.1.0.1\"\ngem \"devise\", \"&gt;= 2.1.2\"\ngem \"cancan\", \"&gt;= 1.6.8\"\ngem \"rolify\", \"&gt;= 3.2.0\"\ngem \"simple_form\", \"&gt;= 2.0.4\"\ngem \"quiet_assets\", \"&gt;= 1.0.1\", :group =&gt; :development\ngem \"therubyracer\", \"&gt;= 0.10.2\", :group =&gt; :assets, :platform =&gt; :ruby\ngem 'i18n'\ngem 'rails-i18n'\n</code></pre>\n\n<p>And my error is in a view : <a href=\"https://gist.github.com/3990266\" rel=\"nofollow\">https://gist.github.com/3990266</a></p>\n"},{"tags":["ruby","rspec"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13191953,"title":"Using RSpec internally","body":"<p>Another project I'm working on requires a particular folder structure, and I'd like to write a program which will test for the correct structure.</p>\n\n<p>I reckon the best way to do this is to write the specification for that structure in RSpec, then have the program run the tests but customise the output. My problem is, I have no idea where to start! How can I trigger RSpec tests from with another ruby application and capture the output?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13191576,"title":"How to validate presence of one field in another model from one model","body":"<p>I have one model PunchingRequest and one model PunchingInformation, In PunchingInformation i have two fields, punch_in_time and punch_out_time. I want to insert record in punching requests table if and only if atleast one out of punch_in_time or punch_out_time contains a value. I have a form containing fields related to both PunchingRequest and PunchingInformation. How can I impose this validation?</p>\n"},{"tags":["ruby-on-rails","ruby","rmagick"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2691,"score":1,"question_id":5415243,"title":"Why am I having a problem installing rmagick","body":"<p>On Ruby 1.8.7 and rails 2.3.5 I get:</p>\n\n<pre><code>gem install rmagick\n\nERROR:  Error installing rmagick:\n\nERROR: Failed to build gem native extension.\n\n\n    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\n    mkmf.rb can't find header files for ruby at       \n    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1 for inspection.\n\nResults logged to /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\n\nBuilding native extensions.  This could take a while...\n\nCynicalgrinch:levelous pawel$ gem install rmagick\n\nBuilding native extensions.  This could take a while...\n\nERROR:  Error installing rmagick:\n\n    ERROR: Failed to build gem native extension.\n\n\n        /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\n\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1 for inspection.\n\nResults logged to /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\n\n\nGem_make.out says this:\n\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","webserver","hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13190529,"title":"How do you know which domain owns the hosting?","body":"<p>For example if I have 1) host adress 2) login 3) password, I am entering by SSH on ruby on rails hosting, then how can i be sured that this hosting belongs to a specific domain? for example how  can I know if www.site.com - belongs to some specific hosting to which I have access.</p>\n\n<p>I am asking this because I have access to hosting of ruby on rails, and when i modify files, there is no changes, i've tried to use the files \"script\", \"serv\", \"restart.txt\" - by ssh:</p>\n\n<ol>\n<li><p><code>touch tmp/restart.txt</code></p></li>\n<li><p><code>./serv restart</code></p></li>\n<li><p><code>script restart</code></p></li>\n</ol>\n\n<p>nothing of the above helped...and I don't know what to do, any ideas?</p>\n"},{"tags":["ruby","singleton-methods"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":410,"score":2,"question_id":7573407,"title":"Ruby singleton class","body":"<p>I am unsure about the difference between this.</p>\n\n<pre><code>def String.hello  \n  puts \"hello there\"   \nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>x = Person.new    \ndef x.hello    \n  puts \"hello there\"    \nend\n</code></pre>\n\n<p>From my understanding the second code block will create an object of class Person. When I do the <em>def x.hello</em> it creates an anonymous class (singleton class) that will be checked first for methods when sending a message to the <em>x</em> object.</p>\n\n<p>Is this the same case for the <em>def String.hello</em>? String is just an instance of class Class correct? I have read that doing <em>def String.hello</em> will add the method as one of String's class methods.... this would be different than an anonymous class being created that sits in between the object and its class where it gets its instance methods.</p>\n\n<p>What happens with both blocks of code above?</p>\n"},{"tags":["ruby","intellij-idea","rubymine","ruby-debug"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":385,"score":2,"question_id":11732715,"title":"How do I install ruby-debug-base19x on Mountain Lion for IntelliJ?","body":"<p>I just upgraded to Mountain Lion and it appears that the IntelliJ 10 ruby-debugger no longer works.  I am getting the error below, but can't really interpret how to fix this, any idea?</p>\n\n<pre><code>/Users/kamilski81/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\nchecking for rb_method_entry_t.body in method.h... no\nchecking for vm_core.h... no\n/Users/kamilski81/.rvm/gems/ruby-1.9.3-p194@sc/gems/ruby_core_source-0.1.5/lib/ruby_core_source.rb:39: Use RbConfig instead of obsolete and deprecated Config.\nchecking for rb_method_entry_t.body in method.h... no\nchecking for vm_core.h... yes\nchecking for iseq.h... yes\nchecking for insns.inc... yes\nchecking for insns_info.inc... yes\nchecking for eval_intern.h... yes\ncreating Makefile\n\nmake\ncompiling breakpoint.c\ncompiling ruby_debug.c\nruby_debug.c:24:19: error: conflicting types for 'rb_iseq_compile_with_option'\nRUBY_EXTERN VALUE rb_iseq_compile_with_option(VALUE src, VALUE file, VALUE line, VALUE opt); /* from iseq.c */\n                  ^\n/Users/kamilski81/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby-1.9.3-p194/vm_core.h:505:7: note: previous declaration is here\nVALUE rb_iseq_compile_with_option(VALUE src, VALUE file, VALUE filepath, VALUE line, VALUE opt);\n      ^\nruby_debug.c:474:60: warning: implicit conversion loses integer precision: 'long' to 'int' [-Wshorten-64-to-32]\n    return rb_funcall2(context, idAtLine, RARRAY_LEN(args) - 1, RARRAY_PTR(args) + 1);\n           ~~~~~~~~~~~                    ~~~~~~~~~~~~~~~~~^~~\nruby_debug.c:538:13: warning: implicit conversion loses integer precision: 'long' to 'int' [-Wshorten-64-to-32]\n    s_len = RSTRING_LEN(source);\n            ^~~~~~~~~~~~~~~~~~~\n/Users/kamilski81/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:674:6: note: expanded from macro 'RSTRING_LEN'\n     RSTRING_EMBED_LEN(str) : \\\n     ^\n/Users/kamilski81/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:670:6: note: expanded from macro 'RSTRING_EMBED_LEN'\n     (long)((RBASIC(str)-&gt;flags &gt;&gt; RSTRING_EMBED_LEN_SHIFT) &amp; \\\n     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nruby_debug.c:538:13: warning: implicit conversion loses integer precision: 'long' to 'int' [-Wshorten-64-to-32]\n    s_len = RSTRING_LEN(source);\n            ^~~~~~~~~~~~~~~~~~~\n/Users/kamilski81/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby/ruby.h:675:28: note: expanded from macro 'RSTRING_LEN'\n     RSTRING(str)-&gt;as.heap.len)\n                           ^\nruby_debug.c:539:13: warning: implicit conversion loses integer precision: 'size_t' (aka 'unsigned long') to 'int' [-Wshorten-64-to-32]\n    f_len = strlen(file);\n          ~ ^~~~~~~~~~~~\nruby_debug.c:684:98: error: too few arguments to function call, expected 5, have 4\n        rb_str_new_cstr(\"begin\\nend\"), rb_str_new_cstr(\"(exception catcher)\"), INT2FIX(1), Qfalse);\n                                                                                                 ^\n/Users/kamilski81/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby-1.9.3-p194/vm_core.h:505:1: note: 'rb_iseq_compile_with_option' declared here\nVALUE rb_iseq_compile_with_option(VALUE src, VALUE file, VALUE filepath, VALUE line, VALUE opt);\n^\nruby_debug.c:1695:10: warning: implicit conversion loses integer precision: 'VALUE' (aka 'unsigned long') to 'int' [-Wshorten-64-to-32]\n  return level;\n  ~~~~~~ ^~~~~\nruby_debug.c:2310:37: warning: implicit conversion loses integer precision: 'long' to 'int' [-Wshorten-64-to-32]\n        int frames = jump_cfp - cfp + 2;\n            ~~~~~~   ~~~~~~~~~~~~~~~^~~\nruby_debug.c:2378:53: warning: comparison of integers of different signs: 'long' and 'unsigned long' [-Wsign-compare]\n            if ((cfp-&gt;pc - cfp-&gt;iseq-&gt;iseq_encoded) &gt;= (cfp-&gt;iseq-&gt;iseq_size - 1))\n                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  ^   ~~~~~~~~~~~~~~~~~~~~~~~~\nruby_debug.c:2392:27: warning: comparison of integers of different signs: 'int' and 'size_t' (aka 'unsigned long') [-Wsign-compare]\n            for (i = 0; i &lt; cfp-&gt;iseq-&gt;insn_info_size; i++)\n                        ~ ^ ~~~~~~~~~~~~~~~~~~~~~~~~~\n8 warnings and 2 errors generated.\nmake: *** [ruby_debug.o] Error 1\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","logging","threadpool","backgroundrb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":202,"score":1,"question_id":323463,"title":"backgroundrb thread_pool.defer method logger output goes to where?","body":"<p>It seems like due to the threading issue logger.warn (thats what I tested) doesn't generate any output? my code is similar to this:</p>\n\n<pre><code>def deliver(args)\n  logger.info \"delivery start\"\n  thread_pool.defer(:deliver_deferred, args)\n  logger.info \"delivery end\"\nend\n\ndef deliver_deferred(args)\n  logger.warn \"whatsoever\"\nend\n</code></pre>\n\n<p>Any idea?</p>\n"},{"tags":["ruby","rubygems","bundler"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":47,"score":4,"question_id":12989932,"title":"How to make a Ruby gem executable","body":"<p>I can use gems like RSpec or Rails or Pry by calling their respective gem names, e.g. <code>rspec</code>, <code>rails</code>, <code>pry</code> on the commandline. How can I achieve this with gems I create? I'm using bundler for the basic gem creation.</p>\n"},{"tags":["ruby","oop","singleton"],"answer_count":5,"favorite_count":7,"up_vote_count":10,"down_vote_count":0,"view_count":2678,"score":10,"question_id":212407,"title":"What exactly is the singleton class in ruby?","body":"<p>It seems as if I'm missing the point or misunderstanding the significance of the singleton class in Ruby. I've heard and read it in many ways—some more complicated than others—and left more confused as to what it is. Is it a class in and of itself? Is it the reason why all objects belong to \"class?\" The concept is <strong>fuzzy</strong>, but I believe it has something to do with why I can define a class method at all (class foo; def foo.bar ... ).</p>\n\n<p>So: What is the singleton class in Ruby?</p>\n"},{"tags":["css","ruby-on-rails","ruby","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13189689,"title":"Creating unique id for <fieldset> when using form_for Rails Nested Model Form","body":"<p>I have a nested model form in the style of this Railscast\n<a href=\"http://railscasts.com/episodes/196-nested-model-form-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/196-nested-model-form-revised?view=asciicast</a></p>\n\n<p>I need to give each  tag a unique ID.  Currently, each field generated has a unique ID and name given by a helper method that assigns a unique ID to every association record.  So that is taken cared of.  However, this form has \"fieldset\" tags which isn't assigned an ID.  I need a unique ID for each fieldset for jQuery manipulation purposes.</p>\n\n<p>Specifically, how do I do give each fieldset generated for an \"Activity\" record a unique CSS tag ID?\nPosted below is how my form is created. Thank you</p>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for(@trip) do |f| %&gt;\n\n&lt;%= f.fields_for :days do |builder| %&gt;\n  &lt;%= render 'day_fields', f: builder %&gt;\n&lt;% end %&gt;\n&lt;%= link_to_add_fields \"Add Day\", f, :days %&gt;\n</code></pre>\n\n<p><strong>_day_fields.html.erb partial</strong></p>\n\n<pre><code>&lt;fieldset&gt;\n  &lt;%= f.label :summary, \"Day Summary\" %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :summary, :rows =&gt; 1 %&gt;&lt;br /&gt;\n    &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n\n  &lt;%= f.fields_for :activities do |builder| %&gt;\n    &lt;%= render 'activity_fields', f: builder %&gt;\n  &lt;% end %&gt;\n  &lt;%= link_to_add_fields \"Add Activity\", f, :activities %&gt;\n&lt;/fieldset&gt;\n</code></pre>\n\n<p><strong>_activity_fields.html.erb</strong></p>\n\n<pre><code>&lt;fieldset&gt;\n  &lt;%= f.label :title, \"Activity\" %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :title, :rows =&gt; 1 %&gt;&lt;br /&gt;\n  &lt;%= f.hidden_field :_destroy %&gt;\n  &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n&lt;/fieldset&gt;\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","ruby","csv"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":13188832,"title":"Changing Date Format on Rails CSV Import to MYSQL","body":"<p>Not sure how to change a date in my csv file when importing into MySQL that is in <strong>12/1/2011</strong>(mm/dd/yyyy) format. MySQL is in yyyy/mm/dd. </p>\n\n<p>How can I do this?</p>\n\n<p>My rake file</p>\n\n<pre><code>require 'csv'\nrequire 'date'\n\ndesc \"Import gac from csv file\"\ntask :import =&gt; [:environment] do\n  Dir.chdir(\"#{Rails.root}/lib/assets\")\n  csv_file = \"file.csv\" \n  CSV.foreach(csv_file, :headers =&gt; true) do |row|\n    Institution.create({\n      :company =&gt; row[0],\n      :solveid =&gt; row[2],\n      :phone =&gt; row[5],\n      :other =&gt; row[6],\n      :clientdate =&gt; (DateTime.strptime row[7], \"%m/%d/%Y\").strftime \"%Y/%m/%d\", \n      :cunumber =&gt; row[1],\n      :street =&gt; row[8], \n      :city =&gt; row[9], \n      :state_id =&gt; row[4], \n      :zip =&gt; row[10],\n      :source =&gt; row[11], \n      :source2 =&gt; row[12],\n      :demodate1 =&gt; (DateTime.strptime row[13], \"%m/%d/%Y\").strftime \"%Y/%m/%d\",\n      :demodate2 =&gt; (DateTime.strptime row[14], \"%m/%d/%Y\").strftime \"%Y/%m/%d\",\n      :demodate3 =&gt; (DateTime.strptime row[15], \"%m/%d/%Y\").strftime \"%Y/%m/%d\",\n      :client =&gt; row[17],\n      :prospect =&gt; row[19], \n      :alliedlead =&gt; row[16], \n      :notcontacted =&gt; row[18]\n    })\n  end\nend\n</code></pre>\n\n<p><em>This is giving me an error.</em></p>\n\n<pre><code>rake import\nrake aborted!\n/Users/dave/rails_projects/allied_contest/lib/tasks/intitutions.rake:14: syntax error, unexpected tSTRING_BEG, expecting '}'\n... row[7], \"%m/%d/%Y\").strftime \"%Y/%m/%d\", \n...                               ^\n/Users/dave/rails_projects/allied_contest/lib/tasks/intitutions.rake:14: syntax error, unexpected ',', expecting keyword_end\n...%m/%d/%Y\").strftime \"%Y/%m/%d\", \n...                               ^\n</code></pre>\n"},{"tags":["ruby","rack","unicorn"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":13002102,"title":"How to run Rack-based application (not Rails) with Unicorn","body":"<p>How can I run a Rack-based application (not Rails) with unicorn? Let's assume I have a \"hello world\" response simple rack app with the name of <code>server.ru</code>, and config file at the same directory with the name of <code>unicorn.conf</code>, how am I supposed to run it? In Thin, for example, I would do something like:</p>\n\n<pre><code>bundle exec rackup server.ru -s thin -E production -p 4001\n</code></pre>\n\n<p>How would I do the same to run under Unicorn?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13189968,"title":"Display no of listings on a page in Ruby on Rails","body":"<p>I'm working with an RoR project where I've implemented a search page which is working fine, what I'm looking to achieve is <a href=\"http://screencast.com/t/Rp7Ytncbut\" rel=\"nofollow\">the number of listings</a>.</p>\n\n<p>Actually, what I've used here is hardcoded HTML since I don't know what code or gem to use. Any suggestions how I can achieve this?</p>\n"},{"tags":["ruby","amazon-s3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13190089,"title":"AWS-SDK S3 list big directories fail","body":"<p>AWS-SDK list ruby code:</p>\n\n<pre><code> s3 = AWS::S3.new\n bucket = s3.buckets[bucket_name]\n tree = bucket.as_tree(:prefix =&gt; 'myshop/products')\n directories = tree.children.select(&amp;:branch?).collect(&amp;:prefix)\n</code></pre>\n\n<p>fail error: \"Unable to find marker in S3 list objects response\"</p>\n\n<p>Structure of directory</p>\n\n<pre><code>/myshop/products/1474472/original.jpg\n/myshop/products/1474472/small.jpg\n/myshop/products/1474472/mini.jpg\n/myshop/products/1333333/original.jpg\n/myshop/products/1333333/small.jpg\n/myshop/products/1333333/mini.jpg\n</code></pre>\n\n<p>...</p>\n\n<p>more of 100 000 obj</p>\n\n<p>I want to verify that the directory(for example \"1474472\") was created</p>\n\n<p>my plan: aws-s3-list-> ruby-array->find in array (array.include?)</p>\n\n<p>!!!need very fast method - soon the end of the world :) </p>\n"},{"tags":["ruby","math","casting","division"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13190038,"title":"ruby math issue with division","body":"<p>I'm calculating Fibonacci numbers with binet's formula and I'm having trouble dividing in ruby.  I've tried casting numbers to_f etc with no avail.  I'll show you what works and what doesn't then maybe you can tell me why.</p>\n\n<p>The following doesn't work</p>\n\n<pre><code>n=5\nfib=(1 + sqrt(5))**n - (1-sqrt(5))**n / (2**n * sqrt(5))\nputs fib #outputs 354.9257634247335 which is a bunch of garbage\n</code></pre>\n\n<p>I've also tried</p>\n\n<pre><code>n=5\nfib=((1 + sqrt(5))**n).to_f - ((1-sqrt(5))**n).to_f / (2**n * sqrt(5)).to_f\nputs fib #outputs the exact same thing as above\n</code></pre>\n\n<p>BUT The following works</p>\n\n<pre><code>n=5\nfib1=(1 + sqrt(5))**n - (1-sqrt(5))**n\nfib2=(2**n * sqrt(5))\nfib = fib1/fib2\nputs fib.round(0) #outputs 5 which is correct\n</code></pre>\n\n<p>Why do the first 2 examples fail but the latter gives me what I want? This is infuriating!</p>\n"},{"tags":["ruby-on-rails","ruby","sqlite","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":381,"score":1,"question_id":5983699,"title":"ActiveRecord, Sqlite3, and BusyException","body":"<p>I have a rails app configured with mixed mysql and sqlite3 db connections, and to associate specific models with sqlite3, i add an \"establish_connection 'sqlite_db_config_name'\" line to each class definition. </p>\n\n<p>When I try to save any sqlite3-connected model object individually, the save is successful, but when I try to save an object that is composed of other objects (via has_many), I get a BusyException. I have a feeling it's because each object has its own connection to the db and the top-level object locks the database then calls the member objects' save methods and they can't acquire the lock. </p>\n\n<p>I'm assuming there's a way to make this work and I'm using establish_connection improperly. </p>\n\n<p>Anyone else encounter this? </p>\n\n<p>database.yml config:</p>\n\n<p>dev:</p>\n\n<pre><code>development:\n  adapter: mysql\n  database: maindb\n  username: root\n  password:\n  host: localhost\n\nsqlite:\n  adapter: sqlite3\n  database: db/db.sqlite3\n  timeout: 15000\n</code></pre>\n\n<p>model definitions:</p>\n\n<pre><code>class Foo &lt; ActiveRecord::Base\n  establish_connection 'sqlite'\n  belongs_to :bar\nend\n\nclass Bar &lt; ActiveRecord::Base\n  establish_connection 'sqlite'\n  has_many :foo  \n  def addFoo(item)\n    self.foos &lt;&lt; item\n  end\nend\n\nclass MysqlModel &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>Other:</p>\n\n<p>Ruby 1.8.7<br>\nRails 2.3.4<br>\nUbuntu 10.04</p>\n\n<h2>Update:</h2>\n\n<p>I tried using inheritance to isolate the establish_connection statement in a single class, based on the rails doc's explanation that \"This feature is implemented by keeping a connection pool in ActiveRecord::Base that is a Hash indexed by the class. If a connection is requested, the retrieve_connection method will go up the class-hierarchy until a connection is found in the connection pool.\". But for some reason rails associated the subclasses of the sqlite-connected class with the default mysql connection. So I've given up on attempting a has_many/belongs_to relationship with sqlite, and de-normalized my models.</p>\n"},{"tags":["ruby-on-rails","ruby","database","sqlite"],"answer_count":10,"favorite_count":9,"up_vote_count":18,"down_vote_count":0,"view_count":8684,"score":18,"question_id":78801,"title":"SQLite3::BusyException","body":"<p>Running a rails site right now using SQLite3.</p>\n\n<p>About once every 500 requests or so, I get a</p>\n\n<p>ActiveRecord::StatementInvalid (SQLite3::BusyException: database is locked:...</p>\n\n<p>What's the way to fix this that would be minimally invasive to my code?</p>\n\n<p>I'm using SQLLite at the moment because you can store the DB in source control which makes backing up natural and you can push changes out very quickly. However, it's obviously not really set up for concurrent access. I'll migrate over to MySQL tomorrow morning.</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":43,"score":0,"question_id":13189177,"title":"Trying to write simple DSL in Ruby","body":"<p>I want to be able to write a code like below:</p>\n\n<pre><code>MyModule::MyClass.configure do |item|\n  item.var1 = 'dsads'\n  item.var2 = 'dsadsa'\n  item.var3 = 'fdsfdsfd'\nend\n</code></pre>\n\n<p>Well, I define a module and a class within it:</p>\n\n<pre><code>module MyModule\n class MyClass\n end\nend\n</code></pre>\n\n<p>...and what should I do further?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12507323,"title":"ruby mysql connection error","body":"<p>I am using MySQL and ruby 1.8.6. I want to connect to MySQL so for that I am using active record gem. My code is </p>\n\n<pre><code>def initialize\n\n    @db_adapter  = \"mysql2\"\n    @db_host     = \"localhost\"\n    @db_database = \"database_name\"\n    @db_user     = \"root\"\n    @db_password = \"root123\"\n    con = nil\n\nend\n\ndef database_connection\n           con = ActiveRecord::Base.establish_connection(  \n              :adapter  =&gt; $db_adapter,  \n              :host     =&gt; $db_host,  \n              :database =&gt; $db_database,\n              :user     =&gt; $db_user,\n              :password =&gt; $db_password  \n           )\n\n           return con\nend\n</code></pre>\n\n<p>but when i am tring to connect it's giving me this error</p>\n\n<pre><code>/usr/lib/ruby/gems/1.8/gems/activerecord-2.3.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:76:in `establish_connection': Please install the  adapter: `gem install activerecord--adapter` (no such file to load -- active_record/connection_adapters/_adapter) (RuntimeError)\n    from /cmf/samnew/build/Controller/databaseConnection.rb:32:in `database_connection'\n    from controller.rb:23\n</code></pre>\n"},{"tags":["ruby","rvm","osx-mountain-lion","homebrew","ruby-1.8.7"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":537,"score":1,"question_id":12511717,"title":"Can't install ruby 1.8.7 on Mac 10.8 via RVM","body":"<p>I can't install ruby ree or ruby 1.8.7 on my Mac 10.8.2.</p>\n\n<p>I did that:</p>\n\n<pre><code>$ brew install libksba\n$ brew update\n$ brew install autoconf automake\n$ brew tap homebrew/dupes\n$ brew install autoconf automake apple-gcc42\n</code></pre>\n\n<p>Then i try to install ruby 1.8.7 and i can't</p>\n\n<pre><code>$ rvm install 1.8.7\nNo binary rubies available for: osx/10.8.2/x86_64/ruby-1.8.7-p370.\nContinuing with compilation. Please read 'rvm mount' to get more information on binary rubies.\nBuilding 'ruby-1.8.7-p370' using clang - but it's not (fully) supported, expect errors.\nInstalling Ruby from source to: /Users/serg/.rvm/rubies/ruby-1.8.7-p370, this may take a while depending on your cpu(s)...\nruby-1.8.7-p370 - #downloading ruby-1.8.7-p370, this may take a while depending on your connection...\nruby-1.8.7-p370 - #extracting ruby-1.8.7-p370 to /Users/serg/.rvm/src/ruby-1.8.7-p370\nruby-1.8.7-p370 - #extracted to /Users/serg/.rvm/src/ruby-1.8.7-p370\nApplying patch /Users/serg/.rvm/patches/ruby/1.8.7/stdout-rouge-fix.patch\nApplying patch /Users/serg/.rvm/patches/ruby/1.8.7/no_sslv2.diff\nruby-1.8.7-p370 - #configuring\nruby-1.8.7-p370 - #compiling\nError running 'make', please read /Users/serg/.rvm/log/ruby-1.8.7-p370/make.log\nThere has been an error while running make. Halting the installation.\nRuby 'ruby-1.8.7-p370' was built using clang - but it's not (fully) supported, expect errors.\nPlease be aware that you just installed a ruby that requires        2 patches just to be compiled on up to date linux system.\nThis may have known and unaccounted for security vulnerabilities.\nPlease consider upgrading to Ruby 1.9.3-194 which will have all of the latest security patches.\nMacBook-Pro-Serg-L-6:smartlearn serg$ rvm remove 1.8.7\nRemoving /Users/serg/.rvm/src/ruby-1.8.7-p370...\n/Users/serg/.rvm/rubies/ruby-1.8.7-p370 has already been removed.\nRemoving ruby-1.8.7-p370 aliases...\nRemoving ruby-1.8.7-p370 wrappers...\nRemoving ruby-1.8.7-p370 environments...\nRemoving ruby-1.8.7-p370 binaries...\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Error running 'make', please read /Users/serg/.rvm/log/ruby-1.8.7-p370/make.log\nThere has been an error while running make. Halting the installation.\n</code></pre>\n\n<p>Log from make.log is <a href=\"http://pastebin.com/gm3aRCmr\" rel=\"nofollow\">here</a></p>\n"},{"tags":["ruby","regex","capture","case-when"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":260,"score":2,"question_id":9642009,"title":"Using Named Captures with regex match in Ruby's case...when?","body":"<p>I want to parse user input using named captures for readability.</p>\n\n<p>When they type a command I want to capture some params and pass them. I'm using RegExps in a case statement and thus I can't assign the return of <code>/pattern/.named_captures</code>.</p>\n\n<p>Here is what I would like to be able to do (for example):</p>\n\n<pre><code>while command != \"quit\"\n  print \"Command: \"\n  command = gets.chomp\n  case command\n  when /load (?&lt;filename&gt;\\w+)/\n    load(filename)\n  end\nend\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails","ruby","osx","rake"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13025078,"title":"rake db:create giving error","body":"<p>When I run rake db:create I get following error </p>\n\n<pre><code>xyz-MacBook-Pro:ruby_project xyz$ rake db:create\nrake aborted!\ndlopen(/Users/xyz/.rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.2.7/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib\nReferenced from: /Users/xyz/.rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.2.7/lib/mysql2/mysql2.bundle\nReason: image not found - /Users/xyz/.rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.2.7/lib/mysql2/mysql2.bundle\n</code></pre>\n\n<p>I have mysql 5.1.66 installed in my system and my database.yml file structure is</p>\n\n<pre><code>adapter: mysql2\nencoding: utf8\nreconnect: false\ndatabase: ruby_test\npool: 5\nusername: root\npassword:\nhost: /tmp/mysql.sock\n</code></pre>\n\n<p>Below are contents of mysql folder in my system</p>\n\n<pre><code>libdbug.a           libmysqlclient_r.a\nlibheap.a           libmysqlclient_r.dylib\nlibmygcc.a          libmysqlclient_r.la\nlibmyisam.a         libmysqld.a\nlibmyisammrg.a          libmystrings.a\nlibmysqlclient.16.dylib libmysys.a\nlibmysqlclient.a        libvio.a\nlibmysqlclient.dylib    libz.a\nlibmysqlclient.la       libz.la\nlibmysqlclient_r.16.dylib   plugin\n</code></pre>\n\n<p>Can someone help me with this issue?</p>\n"},{"tags":["ruby-on-rails","ruby","web"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13188178,"title":"Ruby on rails: variable number of input boxes","body":"<p>I'm working on an application where the user needs to be able to upload multiple files at once in a submission form. Ideally I'd start with, say, three file upload fields with an 'add additional files' button that dynamically adds input fields. I can do the Javascript to handle this of course, but how would I access this \"array\" of files within my controller?</p>\n\n<p>I've looked at a few canned solutions, but they're much more flashy than what I need, and I don't need ajax uploading either - just a regular old submit is fine.</p>\n\n<p>So, to summarize: what's the best way to access zero or many uploaded files in a rails application?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13188322,"title":"Serializing a \"record\" with a variable set of fields in (non-Rails) Ruby ActiveRecord","body":"<p>The need:\n  I have an object with a highly variable set of attributes that I want to serialize into a database where I can easily search based on these attributes. Let's say Person (everyone says, \"Person\").  There are many different attributes of Persons that I might know, but in my application I am not guaranteed to know any of them.  Person attributes include Name, Height, Weight, ShoeSize, etc.  I may have dozens of attributes that I want to store.  The straightforward solution is to create a Person model that has all attributes defined with all of them being possible null valued.  With the list of attributes being so variable, and so numerous, I am wondering whether there might be a better way.</p>\n\n<p>The proposed solution:\n  A serialized hash class.  The class is implemented with</p>\n\n<ol>\n<li>A sequence to keep track of most recent recordID</li>\n<li>a table of acceptable attributes (to ensure some standardization of attributes)</li>\n<li>a table containing recordID, attributeID, value.</li>\n</ol>\n\n<p>The primary key is recordID+attributeID, and there is an index on attributeID.  So every non-null value of every attribute of every record ends up being one tuple in this relation. (This may well be how some databases are implemented internally for all I know).  The class would have the same features as a standard ActiveRecord class.  I'm not sure how I will want to deal with the problem of \"what datatype is your value attribute then?\".  I haven't given that a lot of thought yet.  Perhaps it's a standard serialized version of the value, or perhaps the attributes table will contain datatype information for each attribute as well, or...  But I am not concerned with that detail yet.</p>\n\n<p><strong>Questions</strong>:</p>\n\n<ol>\n<li>Is there something out there that already does this for Rubyists?</li>\n<li>Am I crazy for thinking this could be better than a mondo Person\nclass with every possible attribute and that there are probably\nother applications for storing a searchable list of hashes with\nvarying keys?</li>\n</ol>\n\n<p>Thank you for considering my problem.</p>\n"},{"tags":["ruby-on-rails","ruby","database","activerecord"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":1034,"score":6,"question_id":3609482,"title":"ActiveRecord talk to two databases?","body":"<p>We've recently revamped a project, and are looking to bring all our old data into the new system.  The problem is that the schema is marginally different, so a straight SQL import isn't possible.  Due to some denormalization and database changes, we'll need to do some massaging of the data before it's ready for import.  I was hoping for something like this:</p>\n\n<pre><code>OldUser.all.each do |ou|\n  NewUser.create({\n    :first_name   =&gt; ou.first_name\n    :last_name    =&gt; ou.last_name\n    :login        =&gt; ou.login\n    :company_name =&gt; ou.company.name\n  })\nend\n</code></pre>\n\n<p>In the example above, OldUser is reading from the old database, and NewUser is working on the new database.  I need both sets of models (new and old) to retain their associations to properly denormalize some of that data.</p>\n\n<p>Is there any project/library that can help me do this?</p>\n"},{"tags":["ruby-on-rails","ruby","unit-testing","inclusion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13181083,"title":"Rails unit testing model validation :inclusion fails","body":"<p>Model order.rb</p>\n\n<pre><code>class Order &lt; ActiveRecord::Base\n    attr_accessible :address, :email, :name, :payment_type_id\n    belongs_to :payment_type\n\n    PAYMENT_TYPES = PaymentType.pluck(:id)\n\n    validates :name, :address, :email, :payment_type_id, :presence =&gt; true\n    validates :payment_type_id, :inclusion =&gt; {:in =&gt; PAYMENT_TYPES}\nend\n</code></pre>\n\n<p>Model payment_type.rb</p>\n\n<pre><code>class PaymentType &lt; ActiveRecord::Base\n  attr_accessible :name, :id\n\n  has_many :order\nend\n</code></pre>\n\n<p>From browser, validation works fine, if it is wrong it give an error, else go forward.\nBut problem is when I run <code>rake test:functionals</code> from terminal. Test didn't pass the validation. If I comment this line:</p>\n\n<pre><code>validates :payment_type_id, :inclusion =&gt; {:in =&gt; PAYMENT_TYPES}\n</code></pre>\n\n<p>all is ok. I don't understand why it is working in one plase, but in tests not ? ... </p>\n\n<p>Fixtures are all ok.</p>\n\n<p>Please help.</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":7,"up_vote_count":18,"down_vote_count":0,"view_count":3099,"score":18,"question_id":2824126,"title":"What's the difference between URI.escape and CGI.escape?","body":"<p>What are the differences, and which one should I use?</p>\n"},{"tags":["ruby","facebook"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":760,"score":4,"question_id":5137356,"title":"Facebook chat with pure ruby","body":"<p>I was just wondering, if there's any gem I could use for facebook chat. I don't want to use Rails. I'm trying to build a command-line application to use on linux. </p>\n\n<p>Thanks. :)</p>\n"},{"tags":["ruby","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":173,"score":1,"question_id":5477512,"title":"Reducing code duplication in RSpec","body":"<p>I have a rspec test that contains about 20 ExampleGroups(defined by the 'describe' keyword). Every ExampleGroup contains an 'after' method to be called after each example.</p>\n\n<pre><code>describe \"grouping\" do\n  include Common\n  after do\n    after_example\n  end\nend\n</code></pre>\n\n<p>In this test, the 'after' method is identical across all 20 ExampleGroups. Currently, I just use a mixin to keep from duplicating the code but it seems redundant to always have to specify the 'after' clause and that it should call the mixin in every single ExampleGroup. </p>\n\n<p>Is there a way to do this so I don't have to specify the 'after' in every ExampleGroup? </p>\n"},{"tags":["ruby","formatting","scite"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":93,"score":1,"question_id":7866972,"title":"Make level the printed symbols in the ouput","body":"<p>Consider this Ruby code:</p>\n\n<pre><code>puts \"*****\"\nputs \"    *\"\nputs \"     \"\nputs \"*****\"\nputs \"       *\"\n</code></pre>\n\n<p>My Output is like this:</p>\n\n<pre><code>*****  \n  *\n\n*****\n    *\n</code></pre>\n\n<p>Why the heck a whitespace doesn't fill the same space as <strong>*</strong> character in <strong>Scite</strong>?\nI've tried it in Eclypse with Java and it works just fine.</p>\n"},{"tags":["ruby","alignment","shoes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13185366,"title":"Can't align middle a list_box","body":"<p>I can't align middle a list_box in ruby shoes. I have test a few things, including :right => \"50\" or :left => \"50\", but it still not work.</p>\n\n<pre><code>Shoes.app do \n  stack :width =&gt; \"100%\", :height =&gt; \"45%\" do\n    a = list_box :items =&gt; [\"lol\",\"b\"], :width =&gt; 50, :align =&gt; \"center\"\n  end\nend\n</code></pre>\n"},{"tags":["ruby","xml","rest"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13188101,"title":"Obtain XML element's value from REST server response using Ruby","body":"<p>n00b REST question. I'm making a GET request to an API's endpoint and getting the proper XML response. The question I have is, how do I get the value of a particular XML element in the servers REST response using Ruby?</p>\n\n<p>So let's say one of the elements is 'Body' and I want to assign its value 'Blah blah blah' to a variable</p>\n\n<p>Part of the XML response:</p>\n\n<pre><code>&lt;Body&gt;Blah blah blah&lt;/Body&gt;\n</code></pre>\n\n<p>How would I do that with the response? Basically I want to do something like this</p>\n\n<pre><code>variable = params[\"Body\"]\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":47,"score":-3,"question_id":13187760,"title":"Ruby how to assign array A's value to Array B? ArrayB[i] += ArrayA[i]","body":"<p>Sorry for my English, I will make the question more clear.  </p>\n\n<p>Hi I have a question about how to assign a value from Array A to Array B, the B's elements is sum of A's relevant element's.  The code below can't run, error message is : </p>\n\n<pre><code>i=0\nn = 4\nwhile i &lt;= n  \n   A = Array.new(0)\n   A &lt;&lt; some_random_arrays_with_length_5\n   end\n\n      j=0\n      for j in 0..4\n       B[j] += A[j]\n      end\n\n    i += 1\n\n    end\n</code></pre>\n\n<p>There's always error for the code:</p>\n\n<pre><code>          j=0\n          for j in 0..4\n           B[j] += A[j]\n          end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","postgresql","pg"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13186586,"title":"rails pg db migration undefined method `database_authenticatable' for Devise Users","body":"<p><code>undefined method database_authenticatable' for #&lt;ActiveRecord::ConnectionAdapters::PostgreSQLAdapter::TableDefinition:0xd715388&gt;</code></p>\n\n<p>The migration is:</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def self.up\n    create_table(:users) do |t|\n      t.database_authenticatable :null =&gt; false\n      t.recoverable\n      t.rememberable\n      t.trackable\n      t.timestamps\n    end\n    add_index :users, :email,                :unique =&gt; true\n    add_index :users, :reset_password_token, :unique =&gt; true\n  end\n  def self.down\n    drop_table :users\n  end\nend\n</code></pre>\n"},{"tags":["ruby","google-charts","gchart"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13186047,"title":"ruby googlecharts issue","body":"<p>I am following instructions in this page</p>\n\n<p><a href=\"http://googlecharts.rubyforge.org/\" rel=\"nofollow\">http://googlecharts.rubyforge.org/</a></p>\n\n<p>Here is my code </p>\n\n<pre><code>Gchart.line(:data =&gt; data,:axis_with_labels =&gt; [\"x\"],:axis_labels =&gt; [\"0\",\"15\",\"30\",\"45\",\"60\"], :format =&gt; 'file', :filename =&gt; \"/path/to/file/#{stamp}.png\")  \n</code></pre>\n\n<p>I expect a chart with labels in x axis but I got this chart </p>\n\n<p><img src=\"http://i.stack.imgur.com/IHHuC.png\" alt=\"enter image description here\"></p>\n\n<p>Something I am missing in here?</p>\n\n<p><strong>UPDATE</strong>: </p>\n\n<p>I fixed this issue with another extra pair of [] like this </p>\n\n<pre><code>Gchart.line(:data =&gt; data,:axis_with_labels =&gt; [\"x\"],:axis_labels =&gt; [[\"0\",\"15\",\"30\",\"45\",\"60\"]], :format =&gt; 'file', :filename =&gt; \"/path/to/file/#{stamp}.png\") \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187076,"title":"Paginating an Array in Ruby with will_paginate","body":"<p>I have an array @level1 which looks like this :</p>\n\n<pre><code>[[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4], ............]\n</code></pre>\n\n<p>I want to apply pagination on this array such each page displays only a few rows at once. I tried this:</p>\n\n<pre><code>@temp1 = @level1.paginate(:page =&gt; params[:page])\n</code></pre>\n\n<p>But it throws the following error: </p>\n\n<pre><code>undefined method `paginate' for [[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4]]:Array\n</code></pre>\n\n<p>How can I perform pagination on this using will_paginate?</p>\n"},{"tags":["ruby","function","variables"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13186964,"title":"Ruby - Undefined Local Variable or Method","body":"<p>I'm trying to run a code like this:</p>\n\n<pre><code>class Run_Fiction_Generator &lt; Fiction_Generator\n  def generate_story\n    puts \"Title: \\\"#{generator.title} #{generator.random_date}\\\"\"\n    puts \"---------\"\n    puts generator.story\n  end\nend\n\nprompt = '&gt;'\n\nputs \"Hello Welcome to Fiction Generator\"\nputs \"First a little about me: \"\nputs \"\"\n\ngenerator = Run_Fiction_Generator.new\n\nputs \"This amazing Fiction Generator was created by: #{generator.created_by}\"\nputs \"He's a student with ID number: #{generator.student_id} \"\nputs \"\"\nputs \"Okay now your story! Enter '1' if you want to generate a story now, or '2' if you don't want to\"\nprint prompt\nanswer = gets.chomp\n\nif answer == \"1\"\n  generate_story\nelse\n  puts \"It was nice meeting you, catch ya later!\"\nend\n</code></pre>\n\n<p>but the method <code>generator_story</code> in the <code>if</code> statement keeps throwing this error: </p>\n\n<blockquote>\n  <p>undefined local variable or method 'generate_story' for main:Object (NameError)</p>\n</blockquote>\n\n<p>I'm under the impression that I already defined the method in my code. Can anyone tell where I've gone wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13187116,"title":"rails 3 gmaps4rails to_gmaps4rails empty","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/13142085/gmaps4rails-json-is-being-returned-empty\">gmaps4Rails - json is being returned empty</a>  </p>\n</blockquote>\n\n\n\n<p>I have strange problem...\nI am trying to implement google maps with gmaps4rails, but I cant get it working...<br>\nthis is my <strong>model</strong>:</p>\n\n<pre><code>  acts_as_gmappable  \n\n  def gmaps4rails_address  \n    \"#{self.adresa}, Zagreb, Hrvatska\"\n  end\n</code></pre>\n\n<p>in my <strong>controller</strong> I got</p>\n\n<pre><code>  @json=Dvorane.all.to_gmaps4rails\n</code></pre>\n\n<p>In my <strong>view</strong> I got </p>\n\n<pre><code>  &lt;%= gmaps4rails(@json) %&gt;    \n  &lt;%= @json.inspect %&gt;\n</code></pre>\n\n<p>But I got empty map, and from inspecting <code>@json</code>, I got <code>[]</code>.</p>\n\n<p>What have I done wrong?\nOf course, Dvorane is not empty, and I have data in adresa field...\nthank you</p>\n"},{"tags":["ruby","mongodb","ruby-on-rails-3.2","mongomapper","nested-routes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13187188,"title":"MongoMapper and Embedded Documents as Nested Resources and default route helpers","body":"<p>I'm using Rails 3.2.8, MongoMapper and Simple Form (same behavior as the stock form_for).</p>\n\n<p>I'm finding the stock form helper for the show route of an embedded document / nested resource does not correctly provide the parent resource's id in the generated path.</p>\n\n<p>I have a top level document with many embedded documents. That is, a patient has many allergies. All of this is in a namespace called 'mock':</p>\n\n<p>Relevant excerpt from routes.rb:</p>\n\n<pre><code>namespace :mock do \n  resources :patients do\n    resources :allergies\n  end\nend\n</code></pre>\n\n<p>Here are my models:</p>\n\n<pre><code>class Mock::Patient\n  include MongoMapper::Document\n  # other Patient model keys here\n  many :allergies, :class =&gt; Mock::Patient::Allergy \nend\n\nclass Mock::Patient::Allergy\n  include MongoMapper::EmbeddedDocument\n  # other Allergy model keys here\n  embedded_in :patient\nend\n</code></pre>\n\n<p>In my _form.html.erb partial for the nested resource 'allergy', I setup the form like such:</p>\n\n<pre><code>&lt;%= simple_form_for @mock_allergy do |f| %&gt;\n</code></pre>\n\n<p>When this form is rendered because of the <em>new</em> action, it generates a form tag like such:</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/mock/patients/5092fe79fdb5420c45000002/allergies\" \nclass=\"simple_form form-horizontal\" id=\"new_mock_patient_allergy\" method=\"post\" \nnovalidate=\"novalidate\"&gt;\n</code></pre>\n\n<p>And my allergies_controller.rb create action receives this just fine.</p>\n\n<p>However, if that same partial is used in the context of an edit request, the rendered form tag has an action that incorrectly doubles up the nested object's ID with the parent resource's ID:</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" \naction=\"/mock/patients/5092fe79fdb5420c45000006/allergies/5092fe79fdb5420c45000006\" \nclass=\"simple_form form-horizontal\" \nid=\"edit_mock_patient_allergy_5092fe79fdb5420c45000006\" method=\"post\" \nnovalidate=\"novalidate\"&gt; \n</code></pre>\n\n<p>You'll notice here, the form's action follows the intended route template:</p>\n\n<pre><code>/mock/patients/:patient_id/allergies/:id\n</code></pre>\n\n<p>However, <code>:patient_id</code> and <code>:id</code> are <em>both</em> the <em>id</em> of the embedded Allergy object.</p>\n\n<p>Clearly there's an allergies_path() helper method generated that gets called on my existing <code>@mock_allergy</code> object, and generates the almost correct, but not quite, path.</p>\n\n<p>Is this a MongoMapper issue or am I just using it incorrectly?</p>\n\n<p>If it's a bug, what's the simplest workaround folks are using? I have to think this would be a pretty common problem.</p>\n"},{"tags":["ruby-on-rails","ruby","rest","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13186628,"title":"RESTful Rails 3 routing","body":"<p>I'm new to RESTful design and confused: if I make PUT, GET or POST to a same resource, say, /weblogs/myweblog, how should I write in the route.rb, and related controller?\nDoes the following works?\nIn route.rb</p>\n\n<pre><code>match 'weblogs/myweblog/new' =&gt; 'weblogs#create_new_blog'\nmatch 'weblogs/myweblog/edit/:id' =&gt; 'weblogs#edit_blog' \n.\n.\n</code></pre>\n\n<p>In weblogs_controller.rb</p>\n\n<pre><code>def create_new_blog\n   ...\nend\n\ndef edit_blog\n  params[:id]..\n  ....\nend\n</code></pre>\n\n<p>and confused if I want to do GET/PUT/POST on the same resource, if their URL is same but only HTTP request is different, how to write different operations in the controller? </p>\n"},{"tags":["ruby-on-rails","ruby","haml"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":68,"score":0,"question_id":12104195,"title":"How to add a function in haml file?","body":"<p>I have a haml file, which has many link_to buttons. I need to check a node within that haml file so that if that node has children, I can dynamically add a new button to show its children. I am using the_sortable _tree gem, Rails 3</p>\n\n<pre><code>-# COMP\n- comp= link_to(\"\", show_comp_admin_pages_path(@my_page, :node=&gt;node),\n    :title    =&gt;  \"Show Comp\",\n    :remote   =&gt;  true,\n    :class    =&gt;  \"button show-comp\")\n-# SUB\n- sub= link_to(\"\", show_sub_admin_pages_path(@my_page, :node=&gt;node),\n    :title    =&gt;  \"Show Sub\",\n    :remote   =&gt;  true,\n    :class    =&gt;  \"button show\")\n\n\n\n    -# OUTPUT\n- if (!node.root? )\n  = preview + edit + delete+**''''here i want to add new button if child exists''''**\n</code></pre>\n\n<p>I need to add one more button if node's child exists.</p>\n"},{"tags":["ruby","arrays","range"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":13185578,"title":"How to convert array with ranges in to alone array in ruby","body":"<p>I have some array</p>\n\n<pre><code>&gt;&gt; a = [\"a..c\", \"0..2\"]\n=&gt; [\"a..c\", \"0..2\"]\n</code></pre>\n\n<p>I need convert this array to another array</p>\n\n<pre><code>&gt;&gt; b = (\"a\"..\"c\").to_a + (0..2).to_a\n=&gt; [\"a\", \"b\", \"c\", 0, 1, 2]\n</code></pre>\n\n<p>How I can do it?    </p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":61,"score":2,"question_id":13186722,"title":"What is the difference between using .exists?, and .present? in Ruby?","body":"<p>I want to make sure I'm using them for the correct occasion and want to know of any subtleties.  They seem to function the same way, which is to check to see if a object field has been defined, when I use them via the console and there isn't a whole lot information online when I did a google search. Thanks!</p>\n"},{"tags":["ruby","rake","rdoc"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13186723,"title":"Rake task to generate Rdoc fails with error message 'uninitialized constant RDoc::Generator'","body":"<p>I want to have a task in my <code>Rakefile</code> to generate RDoc for my gem. I have the most recent versions of Ruby, Rake, and RDoc This is what is in my <code>Rakefile</code>:</p>\n\n<pre><code>require 'rubygems'\nrequire 'rake'\nrequire 'rdoc'\n\n# ...\n\nrequire 'rdoc/task'\nRDoc::Task.new do |rdoc|\n  rdoc.rdoc_dir = 'rdoc'\n  rdoc.title = \"jekyll-ebook\"\n  rdoc.main = \"README.md\"\n  rdoc.rdoc_files.include('README*')\n  rdoc.rdoc_files.include('lib/**/*.rb')\nend\n</code></pre>\n\n<p>When I run the command <code>rake rdoc</code>, I get this error message:</p>\n\n<pre><code>rake aborted!\nuninitialized constant RDoc::Generator\n\nTasks: TOP =&gt; rdoc =&gt; html/index.html\n</code></pre>\n\n<p>Running <code>rake rdoc --trace</code> returns:</p>\n\n<pre><code>** Invoke rdoc (first_time)\n** Invoke html/index.html (first_time)\n** Invoke Rakefile (first_time, not_needed)\n** Execute html/index.html\nrdoc -o html\nrake aborted!\nuninitialized constant RDoc::Generator\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/ext/module.rb:36:in `const_missing'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/rdoc.rb:101:in `const_missing'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rdoc-3.12/lib/rdoc/generator/markup.rb:8:in `&lt;top (required)&gt;'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rdoc-3.12/lib/rdoc/generator/darkfish.rb:6:in `&lt;top (required)&gt;'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rdoc-3.12/lib/rdoc/rdoc.rb:530:in `&lt;top (required)&gt;'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/rdoc/task.rb:244:in `block in define'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `block in invoke_prerequisites'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `block in invoke_with_call_chain'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/lib/ruby/gems/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/bin/rake:23:in `load'\n/Users/lmullen/.rbenv/versions/1.9.3-p286/bin/rake:23:in `&lt;main&gt;'\nTasks: TOP =&gt; rdoc =&gt; html/index.html\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"},{"tags":["ruby","ruby-on-rails-3.2","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13186714,"title":"Named scopes for Embedded Document type in MongoMapper?","body":"<p>I'm using Rails 3.2.8 with the latest MongoMapper, and I've switched a top level model from being a <code>MongoMapper::Document</code> to being a <code>MongoMapper::EmbeddedDocument</code>.</p>\n\n<p>Suddenly I got an error on the converted class:</p>\n\n<p><em>undefined method `scope'</em></p>\n\n<p>It seems like named scopes in MongoMapper are only available to top level documents.</p>\n\n<p>I was hoping to use them like such:</p>\n\n<pre><code>my_top_level_document.embedded_items.some_named_scope\n</code></pre>\n\n<p>Aside from writing my own block iterator methods, anything straightforward folks do to solve this limitation?</p>\n"},{"tags":["ruby","irb"],"answer_count":11,"favorite_count":9,"up_vote_count":37,"down_vote_count":0,"view_count":7865,"score":37,"question_id":116593,"title":"How Do You Clear The IRB Console?","body":"<p>How do you clear the IRB console screen?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13186142,"title":"Modifying a SQL query for use with 'will_paginate' in Ruby","body":"<p>I have the following SQL query which I use to fetch some rows from a mySQL database :</p>\n\n<pre><code>SELECT code_ver, result FROM mastertest WHERE date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\n</code></pre>\n\n<p>This query gives me data from the past 90 days. Now I want to display the data of 10 days at a time in my html.erb page (view). I am aware that pagination can be done using 'will_paginate' and 'kaminari' gems. But I am not sure how to query the database with certain conditions as shown above.</p>\n\n<p>Can someone help me with the code here?</p>\n"},{"tags":["ruby","templates","loops","erb","puppet"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13170457,"title":"Puppet 3 loop execution only if variable is defined within a template","body":"<p>I am trying to create a loop only if <code>index</code> is defined. But it looks like \nerb can't handle a loop within a if clause.</p>\n\n<pre><code>&lt;% if(@index) %&gt;\nindex &lt;% index_files.each do |i| %&gt; &lt;%= i %&gt; &lt;% end %&gt;;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Expected Result was:\n<code>index index.html index.php</code>\nor\n<code>\"\"</code></p>\n\n<p>Syntax error i got:</p>\n\n<p>My flat approach failed as expected:</p>\n\n<pre><code>&lt;% if(@index_files) %&gt; try_files &lt;% end %&gt;  &lt;% index_files.each do |i| %&gt; &lt;%= i %&gt; &lt;% end %&gt;\n</code></pre>\n\n<p>I defined <code>index_files</code> as <code>undef</code> => broke the each loop\nI defined an empty array => since an empty array is defined it didn't work.</p>\n\n<p>Maybe I can check the length of <code>index_files</code>?\nOr do I need a complete different way to solve the problem?</p>\n"},{"tags":["ruby","hash"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":99,"score":6,"question_id":13184752,"title":"in Ruby, how to extract a key from the Hash having the value","body":"<p>i thought i'm a Ruby giant when i wrote this oneliner:</p>\n\n<pre><code># having this hash\nhash = { 'Portugal' =&gt; 1, 'France' =&gt; 2, 'USA' =&gt; 3 }\n\n# country_id comes from input\ncountry_name = (hash.select { |k,v| v == country_id.to_i }.first || []).first\n</code></pre>\n\n<p>it does correctly extract the country name and does Not fail if country not found.</p>\n\n<p>i'm totally pleased with it.</p>\n\n<p>however my tutor says it can/should be optimized in terms of readability, length and performance!</p>\n\n<p>what can be clearer/faster than this?</p>\n\n<p>please advise</p>\n"},{"tags":["ruby","utf-8"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":2,"view_count":39,"score":0,"question_id":13174310,"title":"ubuntu and ruby, encoding issues","body":"<p>I have problems with Cyrillic letters in my ruby project. I use <a href=\"https://github.com/slivu/espresso\" rel=\"nofollow\">espresso framework</a> and use <a href=\"https://github.com/jnicklas/carrierwave\" rel=\"nofollow\">carrierwave</a> for file uploads. On my dev machine (MacBook Pro) and HTPC (Ubuntu server 12.04.1) everything work well, but on my \"production\" server I have problems with encodings.\nI think the problem maybe in system locales, but I'm not sure. Reinstalling ruby did not solve the problem.</p>\n\n<p>IMPORTANT: This problem invoke only on \"production\" server</p>\n\n<pre><code>str = \"Записати.PNG\"\nINSPECT (str.to_s.inspect): \"\\xD0\\x97\\xD0\\xB0\\xD0\\xBF\\xD0\\xB8\\xD1\\x81\\xD0\\xB0\\xD1\\x82\\xD0\\xB8.PNG\"\nWITHOUT INSPECT (str.to_s): Записати.PNG\n</code></pre>\n\n<p>I found this \"bug\" in <a href=\"https://github.com/minimagic/minimagick\" rel=\"nofollow\">gem mini_magick</a></p>\n\n<p>How do I reset my locale settings like a \"new install\"?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13186074,"title":"Can't mass-assign protected attributes: product, user","body":"<p>Hello I'm working in a application where you can vote for a product and from the New action of my vote view I get this error: </p>\n\n<blockquote>\n  <p>ActiveModel::MassAssignmentSecurity::Error in VotesController#create</p>\n  \n  <p>Can't mass-assign protected attributes: product, user</p>\n</blockquote>\n\n<p>I make a test on rails console and it works. So I don't know what it's going on.</p>\n\n<p>Here are the models:</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :title\n  has_many :votes\n  has_many :users, :through =&gt; :votes\n  has_attached_file :photo, :styles =&gt; { :medium =&gt; \"300x300\" }\n\n  before_save { |product| product.title = title.titlecase }\n\n  validates :title, presence: true, uniqueness: { case_sensitive: false }\n  validates :photo, :attachment_presence =&gt; true\n\nend\n\nclass User &lt; ActiveRecord::Base\n    has_many :votes\n    has_many :products, :through =&gt; :votes\n    def self.from_omniauth(auth)\n      where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|\n        user.provider = auth.provider\n        user.uid = auth.uid\n        user.name = auth.info.name\n        user.oauth_token = auth.credentials.token\n        user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n        user.save!\n      end\n    end\nend\n\nclass Vote &lt; ActiveRecord::Base\n  attr_accessible :product_id, :user_id\n  belongs_to :product\n  belongs_to :user\nend\n</code></pre>\n\n<p>Here is the vote controller</p>\n\n<pre><code>class VotesController &lt; ApplicationController\n  # GET /votes\n  # GET /votes.json\n  def index\n    @votes = Vote.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @votes }\n    end\n  end\n\n  # GET /votes/1\n  # GET /votes/1.json\n  def show\n    @vote = Vote.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @vote }\n    end\n  end\n\n  # GET /votes/new\n  # GET /votes/new.json\n  def new\n    @vote = Vote.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @vote }\n    end\n  end\n\n  # GET /votes/1/edit\n  def edit\n    @vote = Vote.find(params[:id])\n  end\n\n  # POST /votes\n  # POST /votes.json\n  def create\n    @vote = Vote.new(params[:vote])\n\n    respond_to do |format|\n      if @vote.save\n        format.html { redirect_to @vote, notice: 'Vote was successfully created.' }\n        format.json { render json: @vote, status: :created, location: @vote }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @vote.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /votes/1\n  # PUT /votes/1.json\n  def update\n    @vote = Vote.find(params[:id])\n\n    respond_to do |format|\n      if @vote.update_attributes(params[:vote])\n        format.html { redirect_to @vote, notice: 'Vote was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @vote.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /votes/1\n  # DELETE /votes/1.json\n  def destroy\n    @vote = Vote.find(params[:id])\n    @vote.destroy\n\n    respond_to do |format|\n      format.html { redirect_to votes_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>and here is the new vote view</p>\n\n<pre><code>&lt;%= form_for(@vote) do |f| %&gt;\n  &lt;% if @vote.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@vote.errors.count, \"error\") %&gt; prohibited this vote from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @vote.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :product %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :product %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :user %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please I really need your help to solve this issues, it was very difficult to find a tutorial with has_many :through that include the complete MVC example, I think my problem is on the view, but I don't know.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","aptana"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13186242,"title":"How do you use external libraries in an Aptana Studio Ruble?","body":"<p>I am trying to create a Ruble for use in my current project, but I need to use an external library. A Rails console can see that library fine, as can a running ruby process.  Yet I get this error from the Ruble</p>\n\n<pre><code>org.jruby.exceptions.RaiseException: (LoadError) no such file to load -- kode\nat org.jruby.RubyKernel.require(org/jruby/RubyKernel.java:1038)\nat #&lt;Class:0x10149fee8&gt;.(root)(/home/nekosune/Documents/Aptana Studio 3 Workspace/RubyIndentor/commands/commands.rb:2)\n</code></pre>\n\n<p>Does anyone know how to fix this?</p>\n"},{"tags":["ruby","github","gem","passenger","gemset"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13186264,"title":"deploying a specific git version of a gem into passenger via rvm global gemset","body":"<p>We've a deploy issue I'm having with passenger using a specific github\nversion of the handsoap gem, which is specified in the Gemfile.</p>\n\n<p>bundle states: </p>\n\n<pre><code>Using handsoap (1.1.8) from git://github.com/unwire/handsoap.git (at e6f79ec)\n\n[ rubyapp]$ bundle show handsoap\n /usr/local/rvm/gems/ruby-1.9.3-p286@global/bundler/gems/handsoap-e6f79ec9d6a3\n\n[ rubyapp]$ bundle show capybara\n/usr/local/rvm/gems/ruby-1.9.3-p286@global/gems/capybara-1.1.3\n</code></pre>\n\n<p>(There's many other gems but I thought I'd add capybara to show where they are. There's no other specific github versioned gems)</p>\n\n<p>Sadly we've not got root access to change to another gemset - i.e. not\nglobal and it was installed before the project was setup, so we were not able to specify a custom gemset before, as you would in the local development environment. This version of the gem is needed unfortunately.</p>\n\n<p>Passenger reports:</p>\n\n<blockquote>\n  <p>git://github.com/unwire/handsoap.git (at e6f79ec) is not checked out.\n  Please run <code>bundle install</code> (Bundler::GitError)</p>\n</blockquote>\n\n<p>I've tried a <code>gemset empty global</code> , and a following <code>bundle install</code>\nI've tried a <code>gemset empty global</code> , and a following <code>bundle install</code>\nI've tried\n<code>rm /usr/local/rvm/gems/ruby-1.9.3-p286@global/bundler/gems/handsoap-e6f79ec9d6a3</code>\nand a <code>bundle install</code></p>\n\n<p>all which give the same passenger error as specified above.</p>\n\n<p>Any help would be appreciated. The application has been working previously within the global gemset - but with a previous version of handsoap, but now it's time for a new deploy of the code.</p>\n\n<p>Spent a couple of hours now trying out different options.</p>\n\n<p>Cheers in advance,\nIan.</p>\n"},{"tags":["ruby","mongodb","sinatra"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13185451,"title":"MongoDB returns empty array","body":"<p>I have a MongoDB that spits record onto a webpage</p>\n\n<pre><code>require 'mongo'\nrequire 'json'\n\nconnection = Mongo::Connection.new\ndb = connection.db(\"salemDB\")\ndb = Mongo::Connection.new.db(\"salemDB\")\nnewsCollection = db[\"news\"]\n\nrequire 'sinatra'\nset:port, 2222\nget '/' do\n    redirect 'index.html'\nend\n\nget \"/checkMail\" do\n  newsCollection.find_one({}, {}).to_a.to_json\nend\n\nget \"/:id\" do\n newsCollection.find(\"_id\" =&gt; params[:id]).to_a.to_json\nend\n</code></pre>\n\n<p><strong>/checkmail outputs this</strong> </p>\n\n<p>(formatted for reading pleasure)</p>\n\n<pre><code>[\n   [\n      \"_id\",\n      {\n         \"$oid\":\"50880c8564a15e2631000001\"\n      }\n   ],\n   [\n      \"date\",\n      \"2012-10-24T17:42:54+02:00\"\n   ],\n   [\n      \"subject\",\n      \"This is a piece of news\"\n   ]\n]\n</code></pre>\n\n<p><strong>/50880c8564a15e2631000001 outputs this</strong></p>\n\n<pre><code>[]\n</code></pre>\n\n<p>Why won't it give my object back?</p>\n"},{"tags":["ruby","daemons","tweetstream"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":13132682,"title":"How do I loop the restart of a daemon?","body":"<p>I am trying to use Ruby's <code>daemon</code> gem and loop the restart of a daemon that has its own loop.  My code looks like this now:</p>\n\n<pre><code>require 'daemons'\n\nwhile true\n  listener = Daemons.call(:force =&gt; true) do\n    users = accounts.get_updated_user_list\n\n    TweetStream::Client.new.follow(users) do |status|\n      puts \"#{status.text}\"\n    end\n  end\n  sleep(60)\n  listener.restart\nend\n</code></pre>\n\n<p>Running this gives me the following error (after 60 seconds): </p>\n\n<pre><code>undefined method `restart' for #&lt;Daemons::Application:0x007fc5b29f5658&gt; (NoMethodError)\n</code></pre>\n\n<p>So obviously <code>Daemons.call</code> doesn't return a controllable daemon like I think it does.  What do I need to do to set this up correctly.  Is a daemon the right tool here?</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","loops","block"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13185304,"title":"Rails finding a value in a table","body":"<p>Is it possible to call the <em>include?</em> function on a whole table, like this?</p>\n\n<pre><code>&lt;% @user.games.each do |g|\n   @@latestround = g.rounds.order('created_at DESC').first\n%&gt;\n    &lt;% if @@latestround.submittedpictures.isFinalPicture.include?(true) %&gt;\n        &lt;p&gt;FinalPicture has been played!&lt;/p&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem i'm getting is that It only works when I put a block on submittedpictures and then loop through each record of this table. However I want to look through the whole table in one go and see if the column 'isFinalPicture' includes a value with 'false'.</p>\n\n<p>Any ideas?</p>\n\n<p>The following snippet works but its not the way i want it (I would get more lines if the round happens to have more 'true' FinalPictures)</p>\n\n<pre><code>&lt;% @@latestround.submittedpictures.each do |s| %&gt;\n    &lt;% if s.isFinalPicture == true %&gt;\n         &lt;p&gt;Final Picture has been played!&lt;/p&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby","soap","savon"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":19,"score":3,"question_id":13185697,"title":"Ruby Savon How to set verify_callback","body":"<p>I'm doing soap requests on devices that have self signed certs. I set verify_mode :none, but I still get \"at depth 0 - 18: self signed certificate\" warnings. I know if I can set the verify_callback, I can suppress these warnings.</p>\n\n<p>Can anyone tell me how to set the verify_callback in Savon? I have tried:</p>\n\n<pre><code>client.http.auth.ssl.verify_callback = lambda (|arg1, arg2| true)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>client.http.ssl_config.verify_callback = lambda (|arg1, arg2| true)\n</code></pre>\n\n<p>Both return no method errors.</p>\n\n<p>I have seen this option set in soap4r calls, so I know it works. I just want to know if I can set it in Savon as well.</p>\n"},{"tags":["ruby","rabbitmq","amqp"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":513,"score":2,"question_id":2840290,"title":"Is there an API for listing queues and exchanges on RabbitMQ?","body":"<p>I've looked quite a bit, but I haven't been able to find a good programmatic way to list the queues on a RabbitMQ server.</p>\n\n<p>This is important because I need to clean up my queues and exchanges when I'm done with them.  I don't always have a good \"done\" event that can be used to trigger a cleanup, so I'd like to do it with more of a garbage collection model.  If I can list the queues, I can verify that the objects that they're related to shouldn't be producing more entries and clean them up.</p>\n\n<p>I know I can use <code>rabbitmqctl</code> to do it, but that needs elevated privileges.</p>\n\n<p>Since I haven't been able to find a way to list the queues programmatically, I've been keeping a list of names in the database.  That works, but it's ugly.</p>\n"},{"tags":["ruby","xml","cucumber"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13185524,"title":"General Ruby issue about string conversion (possibly related to Cucumber)","body":"<p>So I'm new to Ruby and just need it to get some Cucumber Unit tests written up but I was curious as to why for a lot of comparison and hash accessing I need to convert values to strings? For those familiar with Cucumber steps I have a block of code like this:</p>\n\n<pre><code>@facets.each_key do |facetGroup|    \n  return_fields = docs.get_elements('searchResults/facet_counts/facet_fields/#{facetGroup}')\n\n  facetValue = \"\"\n  counter = 0\n\n  return_fields.each do |xml|\n    xml.each do |value|     \n      if(counter % 2 == 0)\n        facetValue = value\n      else          \n        @facets[facetGroup.to_s()][facetValue.to_s()].should eq value.to_s()\n      end\n      counter += 1\n    end\n  end  \nend\n</code></pre>\n\n<p>I feel like I'm doing something wrong to have to keep invoking \"to_s()\" on my variables, especially for hash key access.  </p>\n"},{"tags":["ruby","jekyll","jekyll-extensions"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":58,"score":5,"question_id":13076213,"title":"Jekyll: How to pass a Ruby object to a template?","body":"<p>For example, say I'd like to generate this array:</p>\n\n<pre><code>random_numbers = []\n1000.times { random_numbers &lt;&lt; rand(2) }\n</code></pre>\n\n<p>And pass it to a template, so that I can access it from Liquid:</p>\n\n<pre><code>{% for num in random_numbers %} \n  ... here I'd use logic around the number to generate something.\n{% endfor %}\n</code></pre>\n\n<p>Note: I want to generate the array dynamically in Ruby. And inside the template, I want an array that I can iterate with, I don't want a string.</p>\n\n<p>How can this be done in Jekyll?</p>\n"},{"tags":["ruby","jekyll","jekyll-extensions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12416841,"title":"Multiple Converters/Generators in Jekyll?","body":"<p>I would like to write a Jekyll plugin that makes all posts available in PDF format by utilizing Kramdown's <code>LaTeX</code> export capabilities.  For each post in Markdown format, I'd like to end up with the normal <code>.html</code> post along with a <code>.tex</code> file containing the <code>LaTeX</code> markup and finally a <code>.pdf</code>.</p>\n\n<p>Following the <a href=\"https://github.com/mojombo/jekyll/wiki/Plugins\" rel=\"nofollow\">documentation for creating plugins</a>, I see two ways of approaching the problem, either with a Converter or with a Generator.  </p>\n\n<p>Converter plugins seem to run after the built-in Converters, so the <code>.markdown</code> files have all been converted to <code>.html</code> by the time they reach the Converter.</p>\n\n<p>When I try to implement a Generator, I am able to use <code>fileutils</code> to write a file successfully, but by the end of Jekyll's cycle, that file has been removed.  It seems there's a <code>StaticFile</code> class which you can use to register new output files with Jekyll, but I cannot find any real guidance on how to use it.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":8848672,"title":"Is it possible to update from an action/method other than the update action/method in Ruby on rails?","body":"<p>Is it possible to update from an action/method other than the update action/method?\nFor example in my users controller I already have an update method for other parts of my users account.</p>\n\n<p>I need a separate one for changing my users password. Is it possible to have something like this:</p>\n\n<pre><code>def another_method_to_update\n  user = User.authenticate(current_user.email, params[:current_password])\n  if user.update_attributes(params[:user])\n    login user\n    format.js   { render :js =&gt; \"window.location = '#{settings_account_path}'\" } \n    flash[:success] = \"Password updated\" \n  else\n    format.js   { render :form_errors }\n\n  end\nend\n</code></pre>\n\n<p>Then have my change password form know to use that method to perform the update?</p>\n\n<p>It has 3 fields:\ncurrent password\nnew password\nconfirm new password</p>\n\n<p>and I use ajax to show the form errors.</p>\n\n<p>Kind regards</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":47,"score":3,"question_id":13171726,"title":"How do I test the behavior inside an ActiveRecord creation block?","body":"<p>How can I test code like this with rspec?</p>\n\n<pre><code>Foo.create! do |foo|\n  foo.description = \"thing\"\nend\n</code></pre>\n\n<p>I don't want to test of the object was created -- I want to test if the right methods were invoked with the right objects. Equivalent to testing this:</p>\n\n<pre><code>Foo.create!(description: \"thing\")\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Foo.should_receive(:create!).with(description: \"thing\")\n</code></pre>\n"},{"tags":["ruby","math","decimal"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":387,"score":2,"question_id":8106677,"title":"How to truncate a floating point number without rounding up in Ruby?","body":"<p>I have a floating point number that I want to truncate to 3 places but I don't want to round up. How would I go about doing this in Ruby? Any help would be much appreciated?</p>\n\n<p><code>Ex: 1.0155555555555555 =&gt; 1.015 not 1.016</code></p>\n"},{"tags":["ruby","bash","network-programming","port"],"answer_count":3,"favorite_count":4,"up_vote_count":10,"down_vote_count":0,"view_count":5079,"score":10,"question_id":517219,"title":"Ruby - See if a port is open","body":"<p>I need a quick way to find out if a given port is open with Ruby. I currently am fiddling around with this:</p>\n\n<pre><code>require 'socket'\n\ndef is_port_open?(ip, port)\n  begin\n    TCPSocket.new(ip, port)\n  rescue Errno::ECONNREFUSED\n    return false\n  end\n  return true\nend\n</code></pre>\n\n<p>It works great if the port is open, but the downside of this is that occasionally it will just sit and wait for 10-20 seconds and then eventually time out, throwing a <code>ETIMEOUT</code> exception (if the port is closed). My question is thus:</p>\n\n<p>Can this code be amended to only wait for a second (and return <code>false</code> if we get nothing back by then) or is there a better way to check if a given port is open on a given host?</p>\n\n<p><strong>Edit:</strong> Calling bash code is acceptable also as long as it works cross-platform (e.g., Mac OS X, *nix, and Cygwin), although I do prefer Ruby code.</p>\n"},{"tags":["html","ruby","jekyll"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":377,"score":1,"question_id":8664675,"title":"How to customize Jekyll's url?","body":"<p>I would like to use Jekyll to create a site. not a blog. Is there a way to avoid to have the creation date specified in the url and in the page's file name?</p>\n\n<p>I think that the idea behind Jekyll is brilliant, but it seems too tied to blog generation content while it could be useful also in a more general use case.</p>\n"},{"tags":["ruby","nokogiri"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13027409,"title":"How to get values in XML data using Nokogiri?","body":"<p>I'm using Nokogiri to parse XML data that I'm getting from the roar engine after I create a user. The XML looks like below:</p>\n\n<pre><code>&lt;roar tick=\"135098427907\"&gt;\n  &lt;facebook&gt;\n    &lt;create_oauth status=\"ok\"&gt;\n      &lt;auth_token&gt;14802206136746256007&lt;/auth_token&gt;\n      &lt;player_id&gt;8957881063899628798&lt;/player_id&gt;\n    &lt;/create_oauth&gt;\n   &lt;/facebook&gt;\n&lt;/roar&gt;\n</code></pre>\n\n<p>I'm totally new to Nokogiri. How do I get the value of <code>status</code>, the <code>auth_token</code> and <code>player_id</code>?</p>\n"},{"tags":["html","ruby","parsing","nokogiri"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13135851,"title":"Parsing HTML with a weird encoding with Nokogiri","body":"<p>I can't use XPath because the encoding gets weird. I hoped you could help me out of this trouble.</p>\n\n<pre><code>require \"Nokogiri\"\nrequire \"open-uri\"\nlink = \"http://www.arla.dk/Services/SearchService.asmx/RecipeResult?q=allRecipe&amp;paging=6&amp;include=&amp;exclude=&amp;area=recipeSearch&amp;languageBranch=da\"\ndoc = Nokogiri::HTML(open(link))\ndoc.xpath(\"//h2\")\n</code></pre>\n\n<p>The <code>xpath</code> method returns an empty array. It looks like the document has not been parsed correct. I think it is due to the file being parsed contains the encoded characters:</p>\n\n<pre><code>&amp;lt;strong&amp;gt;Frokost til 8&amp;lt;/strong&amp;gt;\n&amp;lt;ul&amp;gt;&amp;lt;li class='ingHeading'&amp;gt;&amp;lt;strong&amp;gt;&amp;lt;b&amp;gt;Flade\n</code></pre>\n"},{"tags":["ruby","xpath","nokogiri"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13170587,"title":"XPath for deeply nested elements?","body":"<p>I am using Nokogiri.</p>\n\n<p>Suppose I have a deeply nested path:</p>\n\n<pre><code>//h1/h2/h3/h4/h5\n</code></pre>\n\n<p>I think I can use the following path:</p>\n\n<pre><code>//h1/*/*/*/h5\n</code></pre>\n\n<p>Is there any way I can avoid using multiple asterisks?  Something like <code>//h1/.../h5</code>?</p>\n\n<p>I don't want to keep counting the levels of nesting.</p>\n"},{"tags":["ruby","variables","shoes"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13183002,"title":"Ruby shoes, communicating between stacks","body":"<p>I'm having a big issue here. I can't communicate between shoes stacks.\nHere is a resumed exemple, in order to show the problem:</p>\n\n<pre><code>Shoes.app do \n  stack :width =&gt; \"100%\", :height =&gt; \"25%\" do\n    button \"\" do\n      a.show\n    end\n  end\n  a = stack :width =&gt; \"100%\", :height =&gt; \"25%\", :hidden =&gt; true do\n    b = para \"lol\"\n  end\nend\n</code></pre>\n\n<p>As you have understood, it can't work because the variable a is declared before being able to be used. However, I have a lot of things I have to append to the second stack thanks to a button on the first stack, it is not possible at all. I don't know if there's a way.\nI have to keep the order of the stacks. I don't want the \"a.show\" be after the \"a\" stack.\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","backbone.js","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":13153610,"title":"Uploading files with Rails, Paperclip, and Backbone","body":"<p>I'm learning Rails by creating a simple imageboard. I want users to be able to upload images to the server and then I will be able to serve them.</p>\n\n<p>I'm using rails-backbone and paperclip.</p>\n\n<p>Here are the related portions:</p>\n\n<p>app/models/image.rb</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n  attr_accessible :url\n  attr_accessible :data\n  has_attached_file :data, :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\nend\n</code></pre>\n\n<p>app/assets/javascripts/backbone/templates/images/submit.jst.ejs</p>\n\n<pre><code>&lt;form id=\"new-image\" name=\"image\" data-remote=\"true\" enctype=\"multipart/form-data\"&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;label for=\"data\"&gt; image:&lt;/label&gt;\n    &lt;input type=\"file\" name=\"data\" id=\"data\"&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;input type=\"submit\" value=\"Create Image\" /&gt;\n  &lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>app/controllers/images_controller.rb</p>\n\n<pre><code>def create\n  @image = Image.new(params[:image])\n  respond_to do |format|\n    if @image.save\n      format.html { redirect_to @image, notice: 'Image was successfully created.' }\n      format.json { render json: @image, status: :created, location: @image }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @image.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>I also ran this migration:</p>\n\n<pre><code>class AddAttachmentDataToImages &lt; ActiveRecord::Migration\n  def self.up\n    add_attachment :images, :data \n  end\n\n  def self.down\n    remove_attachment :images, :data\n  end\nend\n</code></pre>\n\n<p>Upon attempting to save a file named \"fruits.png\", I get this output in the console:</p>\n\n<pre><code>Started POST \"/images\" for 127.0.0.1 at 2012-10-31 00:55:07 -0700\nProcessing by ImagesController#create as JSON\n  Parameters: {\"image\"=&gt;{\"url\"=&gt;nil, \"data\"=&gt;\"C:\\\\fakepath\\\\fruits.png\"}}\nCompleted 500 Internal Server Error in 2ms\n\nPaperclip::AdapterRegistry::NoHandlerError (No handler found for \"C:\\\\fakepath\\\\fruits.png\"):\n  app/controllers/images_controller.rb:16:in `new'\n  app/controllers/images_controller.rb:16:in `create'\n</code></pre>\n\n<p>Any help would be appreciated! Thanks!</p>\n"},{"tags":["ruby","exception","exception-handling"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":404,"score":6,"question_id":2823748,"title":"How do I add information to an exception message without changing its class in ruby?","body":"<p>How do I add information to an exception message without changing its class in ruby?</p>\n\n<p>The approach I'm currently using is</p>\n\n<pre><code>strings.each_with_index do |string, i|\n  begin\n    do_risky_operation(string)\n  rescue\n    raise $!.class, \"Problem with string number #{i}: #{$!}\"\n  end\nend\n</code></pre>\n\n<p>Is there a better way?</p>\n"},{"tags":["ruby","http"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":13132544,"title":"Ruby Equivalent of Python Requests Library (HTTP Client)","body":"<p>There is a library in Python that I love called \"Requests\". Requests is a HTTP client build on urllib3. \"<a href=\"http://docs.python-requests.org/en/latest/\" rel=\"nofollow\">requests doc</a>\". </p>\n\n<p>I am looking for something similar in Ruby. Basically what I need is:</p>\n\n<ul>\n<li>Upload files support (multipart/form-data).</li>\n<li>Easy get/post.</li>\n<li>Cookies can be passed from a response object to a request object (build manually login script).</li>\n<li>Stable and Flexible.</li>\n<li>Sessions support (to not have to handle cookies manually if we don't have too).</li>\n</ul>\n\n<p>I've looked at Typhoeus, but the code example in the home page doesn't work; they have moved code along and the <code>get</code> method is not longer directly accessible like that, so it's not starting well.  Curb seems nice and I like cURL, there is also rest-client, which seems popular, and em-http seems pretty fast according to benchmark. There is a also Patron and curb-fu, which I haven't have the time to try. And, of course, Net:HTTP. But, it doesn't seem to have a mainstream solution that everyone points to.</p>\n\n<p>I think a lot of people have been in my situation and I wonder what they have choosen and why?</p>\n"},{"tags":["ruby","ruby-on-rails-3","dojo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13179556,"title":"Dojo BorderContainer widget won't render","body":"<p>I've created a layout with Maqetta. Now I want to add the logic to the layout. Therefore I have downloaded the whole workspace from Maqetta and imported the files/libaries into a new Rails project. At first I had some problems, that Rails didn't loaded the dojo,js file, but I've solved that problem.<br>\nNow I have another problem. The page won't render. I've commented everything out except one widget (a button) and this works fine. But if I undo this, nothing happens. Unfortunately I also don't get any warnings/errors or anything like that from dojo.<br>\nAfter a little bit trying, I changed the parseOnLoad property and now I get a warning:</p>\n\n<blockquote>\n  <p>Unhandled Error: Tried to register widget with id==appLayout but that id is already registered  </p>\n</blockquote>\n\n<p>Here is the include tag:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"lib/dojo/dojo/dojo\", :'data-dojo-config' =&gt; \"'async':true,\n        'packages':[{'name':'maqetta','location':'../../maqetta'},{'name':'gridx','location':'../gridx'},{'name':'clipart','location':'../../clipart'},{'name':'shapes','location':'../../shapes'},\n        {'name':'maqettaSamples','location':'../../../samples'},{'name':'zazl','location':'../../zazl'},{'name':'widgets','location':'../../custom'}]\" %&gt;\n</code></pre>\n\n<p>Here is the HTML part (I have simplified it, and now I'm just useing the example from the tutorial):</p>\n\n<pre><code>&lt;body class=\"claro\" data-maq-flow-layout=\"true\" data-maq-ws=\"collapse\" id=\"myapp\" data-maq-appstates=\"{}\"&gt;\n\n&lt;input type=\"button\" data-dojo-type=\"dijit.form.Button\" intermediateChanges=\"false\" label=\"Search\" iconClass=\"dijitNoIcon\" onclick=\"alert('hi');\"&gt;&lt;/input&gt;\n&lt;div\nid=\"appLayout\" class=\"demoLayout\"\ndata-dojo-type=\"dijit/layout/BorderContainer\"\ndata-dojo-props=\"design: 'headline'\"&gt;\n    &lt;div\n    class=\"centerPanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'center'\"&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 1 Content&lt;/h4&gt;\n            &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 2 Content&lt;/h4&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 3 Content&lt;/h4&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div\n    class=\"edgePanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'top'\"&gt;Header content (top)&lt;/div&gt;\n    &lt;div\n    id=\"leftCol\" class=\"edgePanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'left', splitter: true\"&gt;Sidebar content (left)&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And here is the parser:</p>\n\n<pre><code>require([\"dojo/parser\",\"dojo/domReady!\"], function(parser){\n     parser.parse();\n});\n</code></pre>\n\n<p>I'm trying for hours now, and I'm still as clueless as at the beginning. Has somebody an idea what I can try?</p>\n"},{"tags":["ruby-on-rails","ruby","regex","vim","vimscript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":13181620,"title":"How to quick refactor to newer Ruby syntax using Vim script?","body":"<p>I would like to quick refactor current line ex:</p>\n\n<pre><code>Subscription.create(:user =&gt; @user, :app =&gt; this_app, :verified =&gt; true, :approved =&gt; true)\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Subscription.create(user: @user,app: this_app, verified: true, approved: true)\n</code></pre>\n\n<p>I would like to change that syntax only in line below cursor or in selected code.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13181597,"title":"can I use a has_many method in a class method?","body":"<p>I have a Payment Model which is polymorphic on activities</p>\n\n<pre><code>class Payment\n  belongs_to :activity, polymorphic: true\nend\n</code></pre>\n\n<p>one of the activities is referrals.</p>\n\n<pre><code>class Referral\n  has_many :payments, :as =&gt; :activity\n\n  def self.unpaid\n    where(payments.count == 0)\n  end\nend\n</code></pre>\n\n<p>I want to create a class method so I can get all of the referrals which are unpaid.  I was using this approach above, but getting a undefined_method error on payments.<br>\nReferral.first.payments.count   works fine.  </p>\n\n<p>what am I missing here?  </p>\n"},{"tags":["ruby-on-rails","ruby","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13181400,"title":".toggle! returning \"no route\" ruby","body":"<p>OK probably a newbie mistake but I hope someone can help me. Let me start off by apologizing for the nature of the example.\nMy app requires to know if a Dog is or isn't neutered and view this option in a list of dogs.</p>\n\n<p>Example...<br>\nDog1 | owner | Neutered\nDog2 | owner | Not neutered</p>\n\n<p>The view looks great and even returns the properties properly the problem is when I click on the Neutered/Not neutered link it does not toggle the field in the Database and I get a Routing Erro No route matches [POST] \"/dogs/3\". </p>\n\n<p>I have a database called Dog and it has a Boolean option :neutered \nI have in my dogs_controller.rb</p>\n\n<blockquote>\n  <p>...<br>\n      def neuter<br>\n        @dog = Dog.find(param[:id])<br>\n        @dog.toggle!(:admin)<br>\n        flash[:success] = \"Changed Dog's neutered status\"<br>\n        redirect_to dogs_url<br>\n      end<br>\n      ...</p>\n</blockquote>\n\n<p>In my routes.rb I have</p>\n\n<blockquote>\n  <p>...<br>\n      resources :dogs do<br>\n          member do<br>\n          get :watching, :watchers  (used else where in program)\n        end<br>\n      end<br>\n  ...  </p>\n</blockquote>\n\n<p>in the partial that lists the dogs I have</p>\n\n<blockquote>\n  <p>...<br>\n  &lt;%= link_to dog.name, dog %><br>\n  &lt;%= if dog.neutered? %><br>\n  &lt;%= link_to \"Neutered\", dog, method: :neuter, data: { confirm: \"This will mark the dog as neutered. Are you sure?\" } %><br>\n  &lt;% else %><br>\n  &lt;%= link_to \"Not Neutered\", dog, method: :neuter, data: { confirm: \"This will mark the dog as not neutered. Are you sure?\" } %><br>\n  ...</p>\n</blockquote>\n\n<p>So what am I missing? I'm sure it's something simple but I can't seem to find it. I've tried several other options but nothing seems to fix it.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13181902,"title":"Prevent sql update on existing Rails model when appending to has_many relationship","body":"<p>According to the present Rails documentation, regarding the <code>&lt;&lt;</code> operator on a has_many relationship on an <strong>existing object</strong>:</p>\n\n<pre><code>collection&lt;&lt;(object, …)\n\nAdds one or more objects to the collection by setting their foreign keys\nto the collection’s primary key. \n</code></pre>\n\n<p><em><strong>(This is the interesting bit)</em></strong></p>\n\n<pre><code>Note that this operation instantly fires update sql without waiting for \nthe save or update call on the parent object.\n</code></pre>\n\n<p>I didn't realize this would happen, I was quite surprised; I could have sworn this was not the case in the past, though I admit I could be wrong. </p>\n\n<p>In either case, I haven't been able to find any additional documentation regarding this, however I wonder if there is a way to prevent this update? </p>\n\n<p>My situation is simple, I merely have an object which exists in the database, which is being prepared for an \"edit\" page. I append one or multiple related objects before the page is render. C'est tout.</p>\n\n<p><strong>Update</strong>:\nApparently the same update-scenario also occurs if you set the has_many relationship directly from an array using the <code>=</code> operator.</p>\n"},{"tags":["ruby-on-rails","ruby","solr","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1502,"score":1,"question_id":3690921,"title":"RSolr RequestError Solr Response Severe errors in solr configuration","body":"<p>I was reindexing my model when I suddenly shutdown my mac,\nWhen I try to reindex again using (Model_name).reindex in script/console I encountered an error that I haven't encountered before.</p>\n\n<pre><code>RSolr::RequestError: Solr Response: Severe_errors_in_solr_configuration__Check_your_log_files_for_more_detailed_information_on_what_may_be_wrong__If_you_want_solr_to_continue_after_configuration_errors_change____abortOnConfigurationErrorfalseabortOnConfigurationError__in_null___javalangRuntimeException_javaioIOException_read_past_EOF__at_orgapachesolrcoreSolrCoregetSearcherSolrCorejava1068__at_orgapachesolrcoreSolrCoreinitSolrCorejava579__at_orgapachesolrcoreCoreContainer$InitializerinitializeCoreContainerjava137__at_orgapachesolrservletSolrDispatchFilterinitSolrDispatchFilterjava83__at_orgmortbayjettyservletFilterHolderdoStartFilterHolderjava99__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyservletServletHandlerinitializeServletHandlerjava594__at_orgmortbayjettyservletContextstartContextContextjava139__at_orgmortbayjettywebappWebAppContextstartContextWebAppContextjava1218__at_orgmortbayjettyhandlerContextHandlerdoStartContextHandlerjava500__at_orgmortbayjettywebappWebAppContextdoStartWebAppContextjava448__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyhandlerHandlerCollectiondoStartHandlerCollectionjava147__at_orgmortbayjettyhandlerContextHandlerCollectiondoStartContextHandlerCollectionjava161__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyhandlerHandlerCollectiondoStartHandlerCollectionjava147__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayjettyhandlerHandlerWrapperdoStartHandlerWrapperjava117__at_orgmortbayjettyServerdoStartServerjava210__at_orgmortbaycomponentAbstractLifeCyclestartAbstractLifeCyclejava40__at_orgmortbayxmlXmlConfigurationmainXmlConfigurationjava929__at_sunreflectNativeMethodAccessorImplinvoke0Native_Method__at_sun\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/connection/requestable.rb:39:in `request'\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/client.rb:34:in `request'\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/client.rb:22:in `update'\n        from /usr/local/lib/ruby/gems/1.8/gems/rsolr-0.12.1/lib/rsolr/client.rb:76:in `delete_by_query'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/indexer.rb:55:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session.rb:173:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session.rb:173:in `each'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session.rb:173:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot/session_proxy/abstract_session_proxy.rb:11:in `remove_all'\n        from /usr/local/lib/ruby/gems/1.8/gems/sunspot-1.1.0/lib/sunspot.rb:414:in `remove_all'\n        from /Users/cecilleann/Projects/dhire2/vendor/plugins/sunspot_rails-1.1.0/lib/sunspot/rails/searchable.rb:164:in `solr_remove_all_from_index'\n        from /Users/cecilleann/Projects/dhire2/vendor/plugins/sunspot_rails-1.1.0/lib/sunspot/rails/searchable.rb:183:in `reindex'\n        from (irb):6\n</code></pre>\n\n<p>Now I haven't been able to fix the error. Please help me. I can't move one.\nThanks a lot in advance</p>\n"},{"tags":["ruby-on-rails","ruby","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13180814,"title":"Rails linking to a nested resource from outside","body":"<p>I have a (simplified) routing like:</p>\n\n<pre><code>resources :users do\n    resources :messages\nend\n\nresources :searches\n</code></pre>\n\n<p>I have a Search model/resource, following Railscasts <a href=\"http://railscasts.com/episodes/111-advanced-search-form\" rel=\"nofollow\">http://railscasts.com/episodes/111-advanced-search-form</a></p>\n\n<p>Now when my search is complete, I'd like to have a link to the actual message which is under user_message_path, but I don't have access to it under the Search resource since it's not nested within.</p>\n\n<p>Is this a problem with the way I've routed/designed it or is there a Rails way of accessing this, like a helper method? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pdfkit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":459,"score":0,"question_id":8842284,"title":"Rails 3 and PDFKit, how can I convert an HTML file into a landscape orientation PDF?","body":"<p>I can convert HTML pages into PDF documents well. The problem is, I don't know how to convert the HTML file into a landscape orientation PDF. Is there a way to set that in the controller?</p>\n\n<p>From the controller...</p>\n\n<pre><code>def pdf_customer_shipments\n  @customer = Customer.find(params[:id])\n  @shipments = Shipment.where(\"customer_id = ? AND status = 'Open'\", @customer.id)\n  render :layout =&gt; 'pdf'\nend\n</code></pre>\n"},{"tags":["python","ruby","vbscript","benchmarking"],"answer_count":2,"favorite_count":8,"up_vote_count":21,"down_vote_count":0,"view_count":317,"score":21,"question_id":13138160,"title":"benchmarks: does python have a faster way of walking a network folder?","body":"<p>I need to walk through a folder with approximately ten thousand files.  My old vbscript is very slow in handling this. Since I've started using Ruby and Python since then, I made a benchmark between the three scripting languages to see which would be the best fit for this job.</p>\n\n<p>The results of the tests below on a subset of 4500 files on a shared network are</p>\n\n<pre><code>Python: 106 seconds\nRuby: 5 seconds\nVbscript: 124 seconds\n</code></pre>\n\n<p>That Vbscript would be slowest was no surprise but I can't explain the difference between Ruby and Python. Is my test for Python not optimal? Is there a faster way to do this in Python?</p>\n\n<p>The test for thumbs.db is just for the test, in reality there are more tests to do.</p>\n\n<p>I needed something that checks every file on the path and doesn't produce too much output to not disturb the timing. The results are a bit different each run but not by much.</p>\n\n\n\n<pre><code>#python2.7.0\nimport os\n\ndef recurse(path):\n  for (path, dirs, files) in os.walk(path):\n    for file in files:\n      if file.lower() == \"thumbs.db\":\n        print (path+'/'+file)\n\nif __name__ == '__main__':\n  import timeit\n  path = '//server/share/folder/'\n  print(timeit.timeit('recurse(\"'+path+'\")', setup=\"from __main__ import recurse\", number=1))\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'vbscript5.7\nset oFso = CreateObject(\"Scripting.FileSystemObject\")\nconst path = \"\\\\server\\share\\folder\"\nstart = Timer\n\nsub recurse(path)\n  set folder = oFso.getFolder(path)\n  for each file in folder.Files\n    if lCase(file.name) = \"thumbs.db\" then\n      wscript.echo file\n    end if\n  next\n  for each subfolder in folder.SubFolders\n    call Recurse(subfolder)\n  next\nend Sub\n\nrecurse(path)\nwscript.echo Timer-start\n</code></pre>\n\n\n\n<pre><code>#ruby1.9.3\nrequire 'benchmark'\n\ndef recursive(path, bench)\n  bench.report(path) do\n    Dir[\"#{path}/**/**\"].each{|file| puts file if File.basename(file).downcase == \"thumbs.db\"}\n  end\nend\n\npath = '//server/share/folder/'\nBenchmark.bm {|bench| recursive(path, bench)}\n</code></pre>\n\n<p>EDIT: since i suspected the print caused a delay i tested the scripts with printing all 4500 files and also printing none, the difference remains, R:5 P:107 in the first case and R:4.5 P:107 in the latter</p>\n\n<p>EDIT2: based on the answers and comments here a Python version that in some cases could run faster by skipping folders</p>\n\n<pre><code>import os\n\ndef recurse(path):\n  for (path, dirs, files) in os.walk(path):\n    for file in files:\n      if file.lower() == \"thumbs.db\":\n        print (path+'/'+file)\n\ndef recurse2(path):\n    for (path, dirs, files) in os.walk(path):\n        for dir in dirs:\n            if dir in ('comics'):\n                dirs.remove(dir)\n        for file in files:\n            if file.lower() == \"thumbs.db\":\n                print (path+'/'+file)\n\n\nif __name__ == '__main__':\n  import timeit\n  path = 'f:/'\n  print(timeit.timeit('recurse(\"'+path+'\")', setup=\"from __main__ import recurse\", number=1)) \n#6.20102692\n  print(timeit.timeit('recurse2(\"'+path+'\")', setup=\"from __main__ import recurse2\", number=1)) \n#2.73848228\n#ruby 5.7\n</code></pre>\n"},{"tags":["ruby","vim","plugins"],"answer_count":6,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":779,"score":3,"question_id":7923002,"title":"Vim Command-T plugin error: could not load the C extension","body":"<p>I'm trying to install the Command-T plugin.</p>\n\n<p>I compiled vim following the instructions in this comment: <a href=\"http://stackoverflow.com/questions/3794895/installing-vim-with-ruby-support-ruby/3851435#3851435\">Installing vim with ruby support (+ruby)</a></p>\n\n<p>So now there's the +ruby flag, but still when I try to use the plugin I get this error:</p>\n\n<pre><code>command-t.vim could not load the C extension\nPlease see INSTALLATION and TROUBLE-SHOOTING in the help              \nFor more information type:    :help command-t\n</code></pre>\n\n<p>I have ruby on my system:</p>\n\n<pre><code>&gt; ruby -v\n&gt; ruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]\n</code></pre>\n\n<p>suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":11,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":1554,"score":4,"question_id":6550538,"title":"What is the best Ruby on Rails training?","body":"<p>I'm looking to jump into Ruby on Rails development and was curious if anyone has taken any of the training options below.  I have looked at several online resources which are great:</p>\n\n<p><a href=\"http://railsforzombies.org/\" rel=\"nofollow\">http://railsforzombies.org/</a></p>\n\n<p><a href=\"http://railscasts.com/\" rel=\"nofollow\">http://railscasts.com/</a></p>\n\n<p><a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">http://ruby.railstutorial.org/ruby-on-rails-tutorial-book</a> - By Mike Hartl</p>\n\n<p>Mr. Hartl's online book and sample application is a awesome resource for newbies like myself.  I've been writing a small application on my own to learn, but I'm finding that most of the time I'm just copying something that Mr. Hartl has done, or randomly googling things without a clear cut understanding of Ruby and Rails from the ground up.</p>\n\n<p>I have located several training courses which look interesting:</p>\n\n<p>Engine Yard: Zero to Rails 3\n<a href=\"http://www.engineyard.com/ruby_on_rails_training/scheduled_classes\" rel=\"nofollow\">http://www.engineyard.com/ruby_on_rails_training/scheduled_classes</a></p>\n\n<p>Pragmatic Studio: Ruby on Rails\n<a href=\"http://pragmaticstudio.com/rails/\" rel=\"nofollow\">http://pragmaticstudio.com/rails/</a></p>\n\n<p>Marakana: Ruby and Rails Bootcamp\n<a href=\"http://marakana.com/training/ruby/ruby_on_rails.html\" rel=\"nofollow\">http://marakana.com/training/ruby/ruby_on_rails.html</a></p>\n\n<p>The training ranges anywhere from $900 to $2200.  Before I commit my hard earned cash to some intensive Rails training, I was wondering if the community had any comments on the classes above or any other ones I have missed.  Thanks!</p>\n\n<p>PS I've been a Java developer for over 10 years, so I have a solid understanding of OO principles and MVC.  Just looking for something more exciting!</p>\n"},{"tags":["ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13180710,"title":"Ruby on Rails - How to delegate to polymorphic associations?","body":"<p>Is it possible to use <code>delegate</code> with <code>has_many</code> or <code>has_one</code> association in a polymorphic model? How does that work?</p>\n\n<pre><code>class Generic &lt; ActiveRecord::Base\n    ...\n\n  belongs_to :generable, polymorphic: true\n\n  delegate :file_url, to: :image, allow_nil: true\n  delegate :type_cat, to: :cat, allow_nil: true\nend\n\nclass Image &lt; ActiveRecord::Base\n   ...\n  has_one :generic, as: generable, dependent: :destroy\nend\n\n\nclass Cat &lt; ActiveRecord::Base\n   ...\n  has_one :generic, as: generable, dependent: :destroy\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","random"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":52,"score":4,"question_id":13180379,"title":"Select a random number a random number of times but never the same random number twice","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/119107/how-do-i-generate-a-list-of-n-unique-random-numbers-in-ruby\">How do I generate a list of n unique random numbers in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I want to do:</p>\n\n<pre><code>Random.rand(0..10).times do\n  puts Random.rand(0..10)\nend\n</code></pre>\n\n<p>with the exception that if a random number has already been displayed it cannot be displayed again. How do I do this most easily?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13175425,"title":"whenever: command not found","body":"<p>I have RVM set up on my mahchine, and installed the \"whenever\" gem on my machine to run cron jobs. When I tried to execute the command:</p>\n\n<pre><code> whenever --update-crontab store\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>-bash: whenever: command not found\n</code></pre>\n\n<p>I think a path issue is there. Kindly help me out.</p>\n"},{"tags":["ruby","environment-variables","watir"],"answer_count":2,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13178322,"title":"Unable to send terminal commands using Ruby","body":"<p>I need to know how to send terminal commands through Ruby to execute another application. I would like to call the SIKULI script at a certain point within my Watir script to handle some steps that Watir can't.</p>\n\n<p>I am not sure how to do it. I read a few of the articles here at Stack Overflow, but can't get it to work.</p>\n\n<p>These are the steps to execute it manually:</p>\n\n<pre><code>jfleck-mbp:~ joe.fleck$ SIKULI_HOME=/Applications/Sikuli-IDE.app/Contents/Resources/Java\njfleck-mbp:~ joe.fleck$ java -jar $SIKULI_HOME/sikuli-script.jar '/Users/joe.fleck/Desktop/Save_File_Button.sikuli'\n</code></pre>\n\n<p>These are in a Ruby file I am trying to execute:</p>\n\n<pre><code>require 'rubygems'\nsystem('SIKULI_HOME=/Applications/Sikuli-IDE.app/Contents/Resources/Java')\nsystem (\"java -jar $SIKULI_HOME/sikuli-script.jar '/Users/joe.fleck/Desktop/Save_File_Button.sikuli'\")\n</code></pre>\n\n<p>The output I get is:</p>\n\n<pre><code>Unable to access jarfile /sikuli-script.jar\n</code></pre>\n\n<p>which tells me the first line in my script did not execute which allows the access.</p>\n\n<p>Any suggestions would be appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","cookies","session-cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13131036,"title":"Secure session cookie is not set","body":"<p>I'm trying to set the session cookie secure flag to true. I added the following to my environments/production.rb</p>\n\n<pre><code>ActionController::Base.session_options[:secure] = true\n</code></pre>\n\n<p>In the production mode I don't see the set-cookie header in the server response (I'm using the Tamper Data Firefox tool to view the traffic). I tried removing all cookies, manually setting the domain including the child domain(since domain is shared among many applications, the appache server forwards the requests to the right application and thus the request is always received by the application server as if it's coming from localhost).\nI also tried to test it in development mode, I assume the server should at least set the cookie even if the request is over http but the browser won't send the cookie over http but again the server does not send the set-cookie header. The session works just fine if I don't set the secure flag. Am I missing something here?</p>\n"},{"tags":["ruby-on-rails","ruby","refactoring","dry"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":39,"score":3,"question_id":13178505,"title":"How to refactor complex search logic in a Rails model","body":"<p>My search method is smelly and bloated, and I need some help refactoring it. I'm new to Ruby, and I haven't figured out how to leverage it effectively, which leads to bloated methods like this:</p>\n\n<pre><code>  # discussion.rb\n  def self.search(params)\n    # If there is a search query, use Tire gem for fulltext search\n    if params[:query].present?\n      tire.search(load: true) do\n        query { string params[:query] }\n      end\n\n    # Otherwise grab all discussions based on category and/or filter\n    else\n\n      # Grab all discussions and include the author\n      discussions = self.includes(:author)\n\n      # Filter by category if there is one specified\n      discussions = discussions.where(category: params[:category]) if params[:category]\n\n      # If params[:filter] is provided, user it\n      if params[:filter]\n        case params[:filter]\n        when 'hot'\n          discussions = discussions.open.order_by_hot\n        when 'new'\n          discussions = discussions.open.order_by_new\n        when 'top'\n          discussions = discussions.open.order_by_top\n        else\n          # If params[:filter] does not match the above three states, it's probably a status\n          discussions = discussions.order_by_new.where(status: params[:filter])\n        end\n      else\n\n        # If no filter is passed, just grab discussions by hot\n        discussions = discussions.open.order_by_hot\n      end\n    end\n  end\n\n  STATUSES   = {\n    question:   %w[answered],\n    suggestion: %w[started completed declined],\n    problem:    %w[solved]\n  }\n\n  scope :order_by_hot,  order('...') DESC, created_at DESC\")\n  scope :order_by_new,  order('created_at DESC')\n  scope :order_by_top,  order('votes_count DESC, created_at DESC')\n</code></pre>\n\n<p>This is a Discussion model that can be filtered (or not) by a category: <code>question</code>, <code>problem</code>, <code>suggestion</code>.</p>\n\n<p>All discussions or a single category can be filtered further by <code>hot</code>, <code>new</code>, <code>votes</code>, or <code>status</code>. Status is a hash in the model and it has several values depending on the category (status filter only appears if params[:category] is present).</p>\n\n<p>Complicating matters is a fulltext search feature using Tire</p>\n\n<p>But my controller looks nice and tidy:</p>\n\n<pre><code>  def index\n    @discussions = Discussion.search(params)\n  end\n</code></pre>\n\n<p>Can I dry this up/refactor it a little, maybe using meta programming or blocks? I managed to extract this out of the controller, but then ran out of ideas. I don't know Ruby well enough to take this further.</p>\n"},{"tags":["ruby","rvm","jruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13171355,"title":"Error installing JRuby with RVM on OS X 10.8","body":"<p>I'm running into an error when installing JRuby in RVM for OS X 10.8, terminal output is below when trying to install:</p>\n\n<pre><code>$ rvm install jruby --debug\njruby - install\njruby-1.7.0 - #downloading jruby-bin-1.7.0, this may take a while depending on your connection...\n[2012-11-01 00:09:16] /usr/local/rvm/scripts/fetch http://jruby.org.s3.amazonaws.com/downloads/1.7.0/jruby-bin-1.7.0.tar.gz\ncurrent path: /usr/local/rvm/src\ncommand(2): /usr/local/rvm/scripts/fetch http://jruby.org.s3.amazonaws.com/downloads/1.7.0/jruby-bin-1.7.0.tar.gz\njruby-1.7.0 - #extracting jruby-bin-1.7.0 to /usr/local/rvm/src/jruby-1.7.0\n[2012-11-01 00:09:17] tar xzf /usr/local/rvm/archives/jruby-bin-1.7.0.tar.gz -C /usr/local/rvm/tmp/rvm_src_80980\ncurrent path: /usr/local/rvm/src\ncommand(5): tar xzf /usr/local/rvm/archives/jruby-bin-1.7.0.tar.gz -C /usr/local/rvm/tmp/rvm_src_80980\njruby-1.7.0 - #extracted to /usr/local/rvm/src/jruby-1.7.0\njruby-1.7.0 - #nailgun\n[2012-11-01 00:09:18] jruby_install_build_nailgun\njruby_install_build_nailgun () \n{ \n    typeset _result;\n    set -x;\n    chpwd_functions=\"\" builtin cd \"${rvm_src_path}/$rvm_ruby_string/tool/nailgun\" &amp;&amp; case \"$rvm_ruby_version\" in \n        1.2* | 1.3*)\n            true\n        ;;\n        *)\n            env \"${rvm_configure_env[@]}\" ./configure --prefix=$rvm_ruby_home\n        ;;\n    esac &amp;&amp; make \"${rvm_make_flags[@]}\";\n    _result=$?;\n    set +x;\n    return $_result\n}\ncurrent path: /usr/local/rvm/src/jruby-1.7.0\ncommand(1): jruby_install_build_nailgun\nError running 'jruby_install_build_nailgun', please read /usr/local/rvm/log/jruby-1.7.0/nailgun.log\n</code></pre>\n\n<p>The nailgun.log looks like this:</p>\n\n<pre><code>[2012-11-01 00:09:18] jruby_install_build_nailgun\njruby_install_build_nailgun () \n{ \n    typeset _result;\n    set -x;\n    chpwd_functions=\"\" builtin cd \"${rvm_src_path}/$rvm_ruby_string/tool/nailgun\" &amp;&amp; case \"$rvm_ruby_version\" in \n        1.2* | 1.3*)\n            true\n        ;;\n        *)\n            env \"${rvm_configure_env[@]}\" ./configure --prefix=$rvm_ruby_home\n        ;;\n    esac &amp;&amp; make \"${rvm_make_flags[@]}\";\n    _result=$?;\n    set +x;\n    return $_result\n}\ncurrent path: /usr/local/rvm/src/jruby-1.7.0\ncommand(1): jruby_install_build_nailgun\n++ chpwd_functions=\n++ builtin cd /usr/local/rvm/src/jruby-1.7.0/tool/nailgun\n++ case \"$rvm_ruby_version\" in\n++ env 'LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include' ./configure --prefix=/usr/local/rvm/rubies/jruby-1.7.0\nchecking for gcc... gcc\nchecking for C compiler default output file name... \nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details.\n++ _result=77\n++ set +x\n</code></pre>\n\n<p>So it looks like there is a problem calling configure, config.log is below:</p>\n\n<pre><code>This file contains any messages produced by compilers while\nrunning configure, to aid debugging if configure makes a mistake.\n\nIt was created by ng configure 0.7.1, which was\ngenerated by GNU Autoconf 2.61.  Invocation command line was\n\n  $ ./configure --prefix=/usr/local/rvm/rubies/jruby-1.7.0\n\n## --------- ##\n## Platform. ##\n## --------- ##\n\nhostname = #####.local\nuname -m = x86_64\nuname -r = 12.2.0\nuname -s = Darwin\nuname -v = Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64\n\n/usr/bin/uname -p = i386\n/bin/uname -X     = unknown\n\n/bin/arch              = unknown\n/usr/bin/arch -k       = unknown\n/usr/convex/getsysinfo = unknown\n/usr/bin/hostinfo      = Mach kernel version:\n     Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64\nKernel configured for up to 2 processors.\n2 processors are physically available.\n2 processors are logically available.\nProcessor type: i486 (Intel 80486)\nProcessors active: 0 1\nPrimary memory available: 8.00 gigabytes\nDefault processor set: 146 tasks, 748 threads, 2 processors\nLoad average: 6.21, Mach factor: 0.29\n/bin/machine           = unknown\n/usr/bin/oslevel       = unknown\n/bin/universe          = unknown\n\nPATH: /usr/local/rvm/gems/ruby-1.9.3-p194/bin\nPATH: /usr/local/rvm/gems/ruby-1.9.3-p194@global/bin\nPATH: /usr/local/rvm/rubies/ruby-1.9.3-p194/bin\nPATH: /usr/local/rvm/bin\nPATH: /opt/local/bin\nPATH: /opt/local/sbin\nPATH: /usr/bin\nPATH: /bin\nPATH: /usr/sbin\nPATH: /sbin\nPATH: /usr/local/bin\nPATH: /opt/sm/bin\nPATH: /opt/sm/pkg/active/bin\nPATH: /opt/sm/pkg/active/sbin\n\n\n## ----------- ##\n## Core tests. ##\n## ----------- ##\n\nconfigure:1734: checking for gcc\nconfigure:1750: found /usr/bin/gcc\nconfigure:1761: result: gcc\nconfigure:1999: checking for C compiler version\nconfigure:2006: gcc --version &gt;&amp;5\ni686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)\nCopyright (C) 2007 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nconfigure:2009: $? = 0\nconfigure:2016: gcc -v &gt;&amp;5\nUsing built-in specs.\nTarget: i686-apple-darwin11\nConfigured with: /private/var/tmp/llvmgcc42/llvmgcc42-2336.11~67/src/configure --disable-checking --enable-werror --prefix=/Applications/Xcode.app/Contents/Developer/usr/llvm-gcc-4.2 --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-prefix=llvm- --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin11 --enable-llvm=/private/var/tmp/llvmgcc42/llvmgcc42-2336.11~67/dst-llvmCore/Developer/usr/local --program-prefix=i686-apple-darwin11- --host=x86_64-apple-darwin11 --target=i686-apple-darwin11 --with-gxx-include-dir=/usr/include/c++/4.2.1\nThread model: posix\ngcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)\nconfigure:2019: $? = 0\nconfigure:2026: gcc -V &gt;&amp;5\nllvm-gcc-4.2: argument to `-V' is missing\nconfigure:2029: $? = 1\nconfigure:2052: checking for C compiler default output file name\nconfigure:2079: gcc   -L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include conftest.c  &gt;&amp;5\ni686-apple-darwin11-llvm-gcc-4.2: CFLAGS=-I/opt/sm/pkg/active/include: No such file or directory\ni686-apple-darwin11-llvm-gcc-4.2: CPATH=/opt/sm/pkg/active/include: No such file or directory\nconfigure:2082: $? = 1\nconfigure:2120: result: \nconfigure: failed program was:\n| /* confdefs.h.  */\n| #define PACKAGE_NAME \"ng\"\n| #define PACKAGE_TARNAME \"ng\"\n| #define PACKAGE_VERSION \"0.7.1\"\n| #define PACKAGE_STRING \"ng 0.7.1\"\n| #define PACKAGE_BUGREPORT \"\"\n| /* end confdefs.h.  */\n| \n| int\n| main ()\n| {\n| \n|   ;\n|   return 0;\n| }\nconfigure:2127: error: C compiler cannot create executables\nSee `config.log' for more details.\n\n## ---------------- ##\n## Cache variables. ##\n## ---------------- ##\n\nac_cv_env_CC_set=\nac_cv_env_CC_value=\nac_cv_env_CFLAGS_set=\nac_cv_env_CFLAGS_value=\nac_cv_env_CPPFLAGS_set=\nac_cv_env_CPPFLAGS_value=\nac_cv_env_CPP_set=\nac_cv_env_CPP_value=\nac_cv_env_LDFLAGS_set=set\nac_cv_env_LDFLAGS_value='-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include'\nac_cv_env_LIBS_set=\nac_cv_env_LIBS_value=\nac_cv_env_build_alias_set=\nac_cv_env_build_alias_value=\nac_cv_env_host_alias_set=\nac_cv_env_host_alias_value=\nac_cv_env_target_alias_set=\nac_cv_env_target_alias_value=\nac_cv_prog_ac_ct_CC=gcc\n\n## ----------------- ##\n## Output variables. ##\n## ----------------- ##\n\nCC='gcc'\nCFLAGS=''\nCPP=''\nCPPFLAGS=''\nDEFS=''\nECHO_C='ECHO_N=''\nECHO_T=''\nEGREP=''\nEXEEXT=''\nGREP=''\nLDFLAGS='-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include'\nLIBOBJS=''\nLIBS=''\nLTLIBOBJS=''\nOBJEXT=''\nPACKAGE_BUGREPORT=''\nPACKAGE_NAME='ng'\nPACKAGE_STRING='ng 0.7.1'\nPACKAGE_TARNAME='ng'\nPACKAGE_VERSION='0.7.1'\nPATH_SEPARATOR=':'\nSHELL='/bin/sh'\nac_ct_CC='gcc'\nbindir='${exec_prefix}/bin'\nbuild_alias=''\ndatadir='${datarootdir}'\ndatarootdir='${prefix}/share'\ndocdir='${datarootdir}/doc/${PACKAGE_TARNAME}'\ndvidir='${docdir}'\nexec_prefix='NONE'\nhost_alias=''\nhtmldir='${docdir}'\nincludedir='${prefix}/include'\ninfodir='${datarootdir}/info'\nlibdir='${exec_prefix}/lib'\nlibexecdir='${exec_prefix}/libexec'\nlocaledir='${datarootdir}/locale'\nlocalstatedir='${prefix}/var'\nmandir='${datarootdir}/man'\noldincludedir='/usr/include'\npdfdir='${docdir}'\nprefix='/usr/local/rvm/rubies/jruby-1.7.0'\nprogram_transform_name='s,x,x,'\npsdir='${docdir}'\nsbindir='${exec_prefix}/sbin'\nsharedstatedir='${prefix}/com'\nsysconfdir='${prefix}/etc'\ntarget_alias=''\n\n## ----------- ##\n## confdefs.h. ##\n## ----------- ##\n\n#define PACKAGE_NAME \"ng\"\n#define PACKAGE_TARNAME \"ng\"\n#define PACKAGE_VERSION \"0.7.1\"\n#define PACKAGE_STRING \"ng 0.7.1\"\n#define PACKAGE_BUGREPORT \"\"\n\nconfigure: exit 77\n</code></pre>\n\n<p>Anyone have any idea what's going on? Tried for hours looking round different forums with no luck. Thanks.</p>\n"},{"tags":["ruby","sinatra"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":7303,"score":6,"question_id":2727979,"title":"How to do a Post/Redirect/Get using Sinatra?","body":"<p>What's Sinatra's equivalent of Rails' <code>redirect_to</code> method? I need to follow a Post/Redirect/Get flow for a form submission whilst preserving the instance variables that are passed to my view. The instance variables are lost when using the <code>redirect</code> method.</p>\n"},{"tags":["ruby-on-rails","ruby","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13177161,"title":"Rails - Add devise user info to post","body":"<p>I have a web app where users can sign up, via Devise, and post pictures for other people to vote on.</p>\n\n<p>I'm trying to attach the users username to the photo that they upload, but I can't for the life of me figure out how.</p>\n\n<p>I figured out how to get the devise user_id into the form through a hidden field, but the username just shows up in the database as a blank field (not <code>NULL</code>, just blank).</p>\n\n<p>How do I get the username from devise to post instead of the user_id?</p>\n\n<p>I have all of the appropriate <code>belongs_to</code> and <code>has_many</code> in the models.</p>\n\n<p><strong>The form.</strong><br>\n<code>&lt;% if current_user %&gt;<br>\n    &lt;%= simple_form_for Picture.new, :remote =&gt; true, :html =&gt; { :class =&gt; \"form-horizontal\" } do |f| %&gt;<br>\n      &lt;%= f.input :title %&gt;<br>\n      &lt;%= f.input :image, :as =&gt; :image_preview, :label =&gt; false, :input_html =&gt; {:preview_version =&gt; :thumb} %&gt;<br>\n      &lt;div class=\"control-group\"&gt;<br>\n        &lt;div class=\"controls\"&gt;<br>\n          &lt;a href=\"#\" class=\"btn\" id=\"file\"&gt;Choose a File&lt;/a&gt;<br>\n        &lt;/div&gt;<br>\n      &lt;/div&gt;<br>\n      &lt;%= f.input :desc, :as =&gt; :text, :input_html =&gt; { :cols =&gt; 20, :rows =&gt; 3 }, :label =&gt; 'Description' %&gt;<br>\n      &lt;%= f.hidden_field :user_id %&gt;<br>\n      &lt;%= f.hidden_field :username %&gt;<br>\n      &lt;div class=\"control-group\"&gt;<br>\n        &lt;div class=\"controls\"&gt;<br>\n          &lt;div class=\"btn-group\"&gt;<br>\n            &lt;%= f.submit \"Add Picture\", :class =&gt; 'btn btn-primary' %&gt;<br>\n            &lt;button class=\"btn btn-danger\" id=\"form-cancel\"&gt;Cancel&lt;/button&gt;<br>\n        &lt;/div&gt;<br>\n      &lt;/div&gt;<br>\n    &lt;% end %&gt;\n</code></p>\n\n<p><strong>pictures_controller.rb</strong><br>\n</p>\n\n<pre><code>def create  \n  #This line inserts the user_id into the database\n  @picture = current_user.pictures.create!(params[:picture])  \n  @picture.save  \n    respond_to do |format|  \n      format.html { redirect_to pictures_url, notice: 'Thanks for your picture!' }  \n      format.js  \n    end  \nend   \n</code></pre>\n"},{"tags":["ruby","boolean"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":19,"score":-2,"question_id":13179309,"title":"Why doesn't the value of is_prime change with every loop?","body":"<p>Below is some code from Codeacademy.com. There is something I don't understand: Why does the value of is_prime not change with every iteration of the loop? For example, testing the number 8, it may be that the loop results in is_prime being false for values 2 and 3, but then for 4 it becomes false (because you can divide by 4). However, for 5,6 and 7 its true again. So why at the end of the loop does the value stay false even after 5,6 and 7 would make it be true again?</p>\n\n<pre><code>def prime(n)\n  puts \"That's not an integer.\" unless n.is_a? Integer\n  is_prime = true\n  for i in 2..n-1\n    if n % i == 0\n      is_prime = false\n    end\n  end\n  if is_prime\n    puts \"#{n} is prime!\"\n  else\n    puts \"#{n} is not prime.\"\n  end\nend\n\nprime(2)\nprime(9)\nprime(11)\nprime(51)\nprime(97)\n</code></pre>\n"},{"tags":["ruby"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":418,"score":1,"question_id":9188360,"title":"Implementing the Luhn algorithm in Ruby","body":"<p>I've been trying to implement the Luhn algorithm in Ruby. I've been following these steps:</p>\n\n<ul>\n<li>The formula verifies a number against its included check digit, which is usually appended to a partial account number to generate the full account number. This account number must pass the following test:\n<ul>\n<li>Counting from the check digit, which is the rightmost, and moving left, double the value of every second digit.</li>\n<li>Sum the digits of the products (e.g., 10 = 1 + 0 = 1, 14 = 1 + 4 = 5) together with the undoubled digits from the original number.</li>\n<li>If the total modulo 10 is equal to 0 (if the total ends in zero) then the number is valid according to the Luhn formula; else it is not valid.</li>\n</ul></li>\n</ul>\n\n<p><a href=\"http://en.wikipedia.org/wiki/Luhn_algorithm\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Luhn_algorithm</a></p>\n\n<p>This is what I've came up with:</p>\n\n<pre><code> def validCreditCard(cardNumber)\n    sum = 0\n    nums = cardNumber.to_s.split(\"\")\n    nums.insert(nums.size, \"x\")\n    nums.reverse!\n    nums.each_with_index do |n, i|\n        if !n.eql?(\"x\")\n            sum += (i % 2 == 0) ? n.to_i : n.to_i * 2\n        end\n    end\n    if (sum % 10) == 0\n        return true\n    else\n        return false\n    end\nend\n</code></pre>\n\n<p>However, this returns <code>false</code> every time I test it. I am not sure what I am doing wrong.</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13168131,"title":"Save array of ActiveRecord objects?","body":"<p>In my view I do:</p>\n\n<pre><code>&lt;table border=\"1\"&gt;\n &lt;tr&gt;\n    &lt;th&gt;Question&lt;/th&gt;\n    &lt;th&gt;Counter&lt;/th&gt;\n    &lt;th&gt;Lastsent&lt;/th&gt;\n    &lt;th&gt;Email&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;% @email_stats.each do |email_stat| %&gt;\n&lt;% post = Post.find(email_stat.postId) %&gt;\n  &lt;% if post.posttype == 'Question' %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= post.question %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%=  email_stat.counter%&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= email_stat.lastsent %&gt;&lt;/t&gt;\n    &lt;td&gt;&lt;%=  text_field_tag 'email', email_stat.email%&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;%  end %&gt;\n &lt;/table&gt;\n</code></pre>\n\n<p>This is what I have: For some objects, the email will be \"blank\" so I want to display all the records in the table  and allow the moderator to enter an email and on click on save store it.</p>\n\n<p>I used <code>form_for</code> but it's used to save only a single object.</p>\n\n<p>What is the best way to send an array back to the server for saving?</p>\n"},{"tags":["ruby-on-rails","ruby","newrelic-rpm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13178507,"title":"newrelic: add method tracers to a class hierarchy","body":"<p>I have a Rails app where I want to instrument some methods with New Relic.</p>\n\n<pre><code>class Base         # in /lib/base.rb\n  def slow_method\n  end\nend\n\nclass Sub &lt; Base   # in /lib/sub.rb\n  def slow_method\n  end\nend\n</code></pre>\n\n<p>I instrumented that like so:</p>\n\n<pre><code># in /lib/base.rb\nclass Base\n  def self.inherited(other)\n    add_method_tracer :slow_method\n  end\nend\n</code></pre>\n\n<p>This looks good, but does not work. The tracer method is added before <code>slow_method</code> itself is defined.</p>\n\n<pre><code># in config/initializers/tracers.rb\n# attempt #1\n\nDir[\"lib/**/*.rb\"].each { |f| require f } # need to require everything\n\nBase.subclasses.each do |klass|\n  klass.class_eval do\n    add_method_tracer :slow_method\n  end\nend\n</code></pre>\n\n<p>This works. But it is ugly:</p>\n\n<ol>\n<li>I don't like to explicitly require everything.</li>\n<li>I should not need to iterate over subclasses.</li>\n</ol>\n\n<p>What's a good way to instrument methods in this kind of situation?</p>\n"},{"tags":["ruby","file","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13177454,"title":"Rspec with input and output file","body":"<p>I have a class that processes a file and generates an output file from the contents of that input file.</p>\n\n<p>My question is pretty straight: How should I test that out? </p>\n\n<p>Say in the input line I have a line like this:</p>\n\n<pre><code>\"I love pets 1\"\n</code></pre>\n\n<p>And I need to test that in the output file there is a line that is like this:</p>\n\n<pre><code>\"I love pets 2\"\n</code></pre>\n\n<p>THanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1088,"score":2,"question_id":4934194,"title":"\"Resulttype(#-614051528) expected, got String(#-608366078)\" with Many-to-Many association","body":"<p>Currently I'm creating something like a \"sports-managing-and-results-gathering-app\" in Rails 3. In this App I need to create several exercises which itself can have multiple 'resulttypes' (heartrate, distance in km, repititions, ...). And it should be possible to arrange the resulttypes in my prefered order. So, this is a classical many-to-many relationship.</p>\n\n<p>I came up with the following migrations:</p>\n\n<pre><code>    class CreateExercises &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises do |t|\n          t.integer :user_id\n          t.string :name\n          t.text :beschreibung\n          t.integer :resulttype_id\n          t.boolean :active, :default =&gt; true\n          t.timestamps\n        end\n      end\n      def self.down\n        drop_table :exercises\n      end\n    end\n\n    class CreateResulttypes &lt; ActiveRecord::Migration\n      def self.up\n        create_table :resulttypes do |t|\n          t.string :name\n          t.string :einheit\n          t.text :beschreibung\n\n          t.timestamps\n        end\n      end\n\n      def self.down\n        drop_table :resulttypes\n      end\n    end\n\n    class CreateExercisesResulttypesJoin &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises_resulttypes, :id =&gt; false do |t|\n          t.integer \"exercise_id\"\n          t.integer \"resulttype_id\"\n        end\n        add_index :exercises_resulttypes, [\"exercise_id\", \"resulttype_id\"]\n      end\n\n      def self.down\n        drop_table :exercises_resulttypes\n      end\n    end\n</code></pre>\n\n<p>which works nicely with this formtastic code:</p>\n\n<pre><code>    &lt;%= semantic_form_for(@exercise) do |f| %&gt;        \n      &lt;%= f.inputs do %&gt;\n        &lt;%= f.input :name %&gt;\n        &lt;%= f.input :beschreibung %&gt;\n        &lt;%= f.input :resulttype %&gt;\n        &lt;%= f.input :active %&gt;\n      &lt;% end %&gt;\n      &lt;%= f.buttons %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>The problem is here, that with this code I can not sort the resulttypes and each exercise can have each resulttype once only.\nSo I changed the formtastic :resulttype form code to this (except the jquery code):</p>\n\n<pre><code>    &lt;div id=\"conn_ctrl\" class=\"float_left center\"&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, @resall.collect{|d| [d.name,d.id]}.sort, {}, { :multiple =&gt; true, :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, '', {}, { :multiple =&gt; true, :id =&gt; \"exercise_resulttypes_save\", :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"remove\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&lt;&lt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"add\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&gt;&gt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"up\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Up\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"down\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Down\" }, false) %&gt;&lt;br&gt;\n        &lt;/div&gt;\n        &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Now I have a \"Dual Listbox\" and I can add exercises to this specific workout multiple times and order it how I like it.\nBUT, when I submit the form, I get this error and I have no idea what that means:</p>\n\n<blockquote>\n  <p>Resulttype(#-614051528) expected, got String(#-608366078)</p>\n</blockquote>\n\n<p>The submitted parameters are:</p>\n\n<pre><code>    {\"commit\"=&gt;\"Create Exercise\",\n     \"authenticity_token\"=&gt;\"v1l9zfxdxIJbdjZx6SsZ5tGuKMrlioBg+C9orSmVarA=\",\n     \"utf8\"=&gt;\"✓\",\n     \"exercise\"=&gt;{\"name\"=&gt;\"dddd\",\n     \"beschreibung\"=&gt;\"ddddd\",\n     \"resulttypes\"=&gt;[\"5\",\n     \"3\",\n     \"1\"],\n     \"active\"=&gt;\"1\"}}\n</code></pre>\n\n<p>This currently drives me crazy a little bit. I hope you know why this happens...</p>\n"},{"tags":["ruby","itunes","osx-mountain-lion","scripting-bridge"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13096723,"title":"How can I set iTunes album artwork via ScriptingBridge?","body":"<p>Today I discovered that when I added album artwork to iTunes, it had only actually added it to some of the tracks in each album. So I did what anyone would do and tried to write a script to rectify that.</p>\n\n<p>This is the first try, after about 3 hours of tinkering. It assumes that you have selected all the songs in an album.</p>\n\n<pre><code>#! /usr/local/bin/macruby\nframework 'Foundation'\nframework 'ScriptingBridge'\n\nitunes = SBApplication.applicationWithBundleIdentifier(\"com.apple.itunes\")\ntracks = itunes.selection.get\n\n# Find some track with artwork\nartwork = tracks.map { |track| track.artworks[0] }.find { |a| a }\nraise \"No selected song has artwork\" if artwork.nil?\n\n# I checked artwork.rawData and it is PNG wrapped in an NSConcreteData.\npngData = artwork.rawData\n\ntracks.each do |track|\n  if track.artworks[0]\n    puts \"[O] #{track.name}\"\n  else\n    puts \"[X] #{track.name}\"\n    # Adding the same artwork object is apparently NG so we get the data from it\n    # and make a copy.\n    # There is probably a more straight-forward way to clone an object but\n    # artwork.copy raises an exception.\n    # I have tried using the keys 'data' and 'raw data' instead - same results.\n    dict = {rawData: pngData}\n    artwork_copy = itunes.classForScriptingClass('artwork').alloc.initWithProperties(dict)\n\n    track.artworks.addObject(artwork_copy)\n\n    raise \"Didn't actually add the artwork\" if track.artworks.empty?\n  end\nend\n</code></pre>\n\n<p>The call to addObject does not raise an exception, but I noticed that it doesn't actually add the artwork to the track (hence the check on the next line to speed up testing the script.)</p>\n\n<p>I have been working mostly from Objective-C examples of ScriptingBridge and can't find any where other people have done this either. Lots of examples of <em>getting</em> the artwork but suprisingly few for <em>setting</em> it...</p>\n\n<p>I did find an interesting mailing list thread from four years ago where someone else had a similar issue, but they never came to a solution either (or found it and didn't post it to the thread, which is worse and if they did that, they're a bad person and should feel bad.)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","comments","posts"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":777,"score":0,"question_id":7000689,"title":"undefined method `comments' for nil:NilClass","body":"<p>I'm trying to create a way to have users comment on my posts. Currently I have All user posts showing up on my home page and then in the user profile only the current users posts. I would like to have it so that the comments appear only on the posts in the users profile. I tried to add a comment form in the user profile but I got an undefined method `comments' for nil:NilClass error. </p>\n\n<p>My comments_controller looks like </p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @post = Post.find(params[:post])\n    @comment = @post.comments.create(params[:comment])\n    redirect_to post_path(@post)\nend\n</code></pre>\n\n<p>I have a partial (_comment_form.html.erb) that I am rendering in the user profile which looks like </p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for ([@post, @post.comments.build]) do |f| %&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :commenter %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :commenter %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My Comment model looks like </p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  belongs_to :post\nend\n</code></pre>\n\n<p>My Post model looks like</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :content\n\n belongs_to :user\n\n validates :content, :presence =&gt; true\n validates :user_id, :presence =&gt; true\n validates :user, :presence =&gt; true\n validates :title, :presence =&gt; true\n\n has_many :comments\n\n default_scope :order =&gt; 'posts.created_at DESC'\nend\n</code></pre>\n\n<p>My User Profile Looks like show.html.erb</p>\n\n<pre><code>&lt;table class=\"profile\" summary=\"Profile information\"&gt;\n  &lt;tr&gt;\n    &lt;td class=\"main\"&gt;\n    &lt;h1&gt;\n        &lt;%= gravatar_for @user %&gt;\n        &lt;%= @user.name %&gt;\n    &lt;/h1&gt;\n    &lt;% unless @user.posts.empty? %&gt;\n        &lt;table class=\"posts\" summary=\"User posts\"&gt;\n            &lt;%= render @posts %&gt;\n            &lt;%= render 'comments/comment_form' %&gt;\n        &lt;/table&gt;    \n    &lt;% end %&gt;\n    &lt;/td&gt;\n    &lt;td class=\"sidebar round\"&gt;\n  &lt;strong&gt;Name&lt;/strong&gt; &lt;%= @user.name %&gt;&lt;br /&gt;\n  &lt;strong&gt;URL&lt;/strong&gt;  &lt;%= link_to user_path(@user), @user %&gt;&lt;br /&gt;\n  &lt;strong&gt;Tasks&lt;/strong&gt; &lt;%= @user.posts.count %&gt;\n    &lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":17,"score":3,"question_id":13176556,"title":"Test with input files in rspec. How to organize?","body":"<p>I have the following structure:</p>\n\n<pre><code>MyProject --&gt; Main folder of my project.\nMyProject/my_class.rb\nMyProject/inputs/input1.txt\nMyProject/inputs/input2.txt\nMyProject/rspec/spec_helper.rb\nMyProject/rspec/my_class_spec.rb\n</code></pre>\n\n<p>What is an elegant way or most common way that I can make it so that I can use the input1.txt and input2.txt in my_class_spec.rb?</p>\n"},{"tags":["ruby","file"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13176270,"title":"Ensure to close files in Ruby, with rescue and ensure","body":"<p>I have the following code:</p>\n\n<pre><code>begin\n   @output_file = File.open(\"output.txt\", \"w\")\n   File.read(@input_file).each_line do |line|\n   taxify_line(line)\nend\nrescue =&gt; e\n   p \"Smz went wrong...\"\nend\n@output_file.write(\"Last line of output\")\n@output_file.close unless @output_file.nil?\n</code></pre>\n\n<p>What is the correct way of ensuring that regardless of I catch an exception, both files (@input_file and @output_file) are closed?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-c-extension"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1055,"score":1,"question_id":11802918,"title":"error: failed to build gem native extension when installing rails on mac mountian lion os","body":"<p>I've recently updated to Mountain Lion and reinstalled Ruby, but when I try to run a test Rails app, I get an error message that says that \"Rails is not currently installed\" on my system. I do what it says, type sudo gem install rails and get:</p>\n\n<p>cleared faster_require caches due to new gem install...\nSuccessfully installed rails-3.2.7\n1 gem installed\nInstalling ri documentation for rails-3.2.7...\nInstalling RDoc documentation for rails-3.2.7...</p>\n\n<p>but when I check to see which rails version is install, here is what I get: </p>\n\n<p>Rails is not currently installed on this system. To get the latest version, simply type:</p>\n\n<pre><code>$ sudo gem install rails\n</code></pre>\n\n<p>You can then rerun your \"rails\" command.</p>\n\n<p>I've also tried gem install rails and get:\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.</p>\n\n<pre><code>    /Users/aileen/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\n</code></pre>\n\n<p>creating Makefile</p>\n\n<p>make\ncompiling generator.c\nmake: /usr/bin/gcc-4.2: No such file or directory\nmake: <em>*</em> [generator.o] Error 1</p>\n\n<p>Gem files will remain installed in /Users/aileen/.rvm/gems/ruby-1.9.3-p194@rails327/gems/json-1.7.4 for inspection.\nResults logged to /Users/aileen/.rvm/gems/ruby-1.9.3-p194@rails327/gems/json-1.7.4/ext/json/ext/generator/gem_make.out</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","gem","client-side"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13175919,"title":"Rails on heroku: \"cannot load such file\"","body":"<p>I keep having this error when I run rails s. It initially started when i tried pushing my app to heroku:</p>\n\n<pre><code>/var/lib/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:\n  in `require': cannot load such file -- \n  client_side_validations/formtastic (LoadError)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13175295,"title":"heroku and builder gem","body":"<p>When I push my app to heroku (cedar stack), it trow this error:</p>\n\n<pre><code>Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment\n       Some gems seem to be missing from your vendor/cache directory.\n       Could not find builder-3.0.4 in any of the sources\n</code></pre>\n\n<p>I tried:</p>\n\n<ul>\n<li>rm -rf Gemfile.lock and bundle again</li>\n<li>gem 'builder', '3.0.4' in the gemfile</li>\n<li>Repository url in the gemfile</li>\n</ul>\n\n<p>Whats wrong?</p>\n"},{"tags":["ruby","enumerable"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":940,"score":1,"question_id":5481009,"title":"Why is Enumerable#each_with_object deprecated?","body":"<p>According <a href=\"http://apidock.com/ruby/Enumerable/each_with_object\" rel=\"nofollow\">ApiDock</a>, the Ruby method <code>Enumerable#each_with_object</code> is deprecated. Unless it's mistaken (saying \"deprecated on the latest stable version of Rails\" makes me suspicious that maybe it's Rails' monkey-patching that's deprecated), why is it deprecated?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13168695,"title":"Ruby method overriding in rails app","body":"<p>I got a few Classes that include the same module, I want to override one of the methods of the module in one place in my code.\nHow to do this?</p>\n\n<p>I tried </p>\n\n<pre><code>module [Module_name]\n  def [method_to_override]\n</code></pre>\n\n<p>and add it to the autoload path of rails but no success</p>\n"},{"tags":["ruby","multithreading","threadpool","deadlock"],"answer_count":4,"favorite_count":3,"up_vote_count":8,"down_vote_count":0,"view_count":4345,"score":8,"question_id":81788,"title":"Deadlock in ThreadPool","body":"<p>I couldn't find a decent ThreadPool implementation for Ruby, so I wrote mine (based partly on code from here: <a href=\"http://snippets.dzone.com/posts/show/3276\">http://snippets.dzone.com/posts/show/3276</a> , but changed to wait/signal and other implementation for ThreadPool shutdown. However after some time of running (having 100 threads and handling about 1300 tasks), it dies with deadlock on line 25 - it waits for a new job there. Any ideas, why it might happen?</p>\n\n<pre><code>require 'thread'\nbegin\n  require 'fastthread'\nrescue LoadError\n  $stderr.puts \"Using the ruby-core thread implementation\"\nend \n\nclass ThreadPool\n  class Worker\n    def initialize(callback)\n      @mutex = Mutex.new\n      @cv = ConditionVariable.new\n      @callback = callback\n      @mutex.synchronize {@running = true}\n      @thread = Thread.new do\n        while @mutex.synchronize {@running}\n          block = get_block\n          if block\n            block.call\n            reset_block\n            # Signal the ThreadPool that this worker is ready for another job\n            @callback.signal\n          else\n            # Wait for a new job\n            @mutex.synchronize {@cv.wait(@mutex)} # &lt;=== Is this line 25?\n          end\n        end\n      end\n    end\n\n    def name\n      @thread.inspect\n    end\n\n    def get_block\n      @mutex.synchronize {@block}\n    end\n\n    def set_block(block)\n      @mutex.synchronize do\n        raise RuntimeError, \"Thread already busy.\" if @block\n        @block = block\n        # Signal the thread in this class, that there's a job to be done\n        @cv.signal\n      end\n    end\n\n    def reset_block\n      @mutex.synchronize {@block = nil}\n    end\n\n    def busy?\n      @mutex.synchronize {!@block.nil?}\n    end\n\n    def stop\n      @mutex.synchronize {@running = false}\n      # Signal the thread not to wait for a new job\n      @cv.signal\n      @thread.join\n    end\n  end\n\n  attr_accessor :max_size\n\n  def initialize(max_size = 10)\n    @max_size = max_size\n    @workers = []\n    @mutex = Mutex.new\n    @cv = ConditionVariable.new\n  end\n\n  def size\n    @mutex.synchronize {@workers.size}\n  end\n\n  def busy?\n    @mutex.synchronize {@workers.any? {|w| w.busy?}}\n  end\n\n  def shutdown\n    @mutex.synchronize {@workers.each {|w| w.stop}}\n  end\n  alias :join :shutdown\n\n  def process(block=nil,&amp;blk)\n    block = blk if block_given?\n    while true\n      @mutex.synchronize do\n         worker = get_worker \n         if worker\n           return worker.set_block(block)\n         else\n           # Wait for a free worker\n           @cv.wait(@mutex)\n         end\n      end\n    end\n  end\n\n  # Used by workers to report ready status\n  def signal\n    @cv.signal\n  end\n\n  private\n  def get_worker\n    free_worker || create_worker\n  end\n\n  def free_worker\n    @workers.each {|w| return w unless w.busy?}; nil\n  end\n\n  def create_worker\n    return nil if @workers.size &gt;= @max_size\n    worker = Worker.new(self)\n    @workers &lt;&lt; worker\n    worker\n  end\nend\n</code></pre>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13175519,"title":"Inheritance and modules in Ruby","body":"<p>I have this structure:</p>\n\n<pre><code>class1 &lt; class2\n</code></pre>\n\n<p>A simple child &lt; parent relationship. </p>\n\n<p>I got a module, module1.</p>\n\n<p>file CLASS_1.rb:</p>\n\n<pre><code>class1 &lt; class2\n\nend\n</code></pre>\n\n<p>file CLASS_2.rb:</p>\n\n<pre><code>class2\n  include module1\nend\n</code></pre>\n\n<p>file MODULE_1.rb:</p>\n\n<pre><code>module module1\n\nend\n</code></pre>\n\n<p>why do I get this:</p>\n\n<pre><code>'&lt;class:class2&gt;': uninitialized constant class2::module1 (NameError)\n</code></pre>\n"},{"tags":["ruby","reflection","yarv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13175070,"title":"Is the information displayed in ruby --dump available at runtime?","body":"<p>In <a href=\"https://speakerdeck.com/jeg2/10-things-you-didnt-know-ruby-could-do\" rel=\"nofollow\">10 Things You Didn't Know Ruby Could Do</a>, slide 30, James Edward Gray II mentions</p>\n\n<pre><code>ruby -e 'puts { is_this_a_block }' --dump parsetree\n</code></pre>\n\n<p>which produces</p>\n\n<pre><code>###########################################################\n## Do NOT use this node dump for any purpose other than  ##\n## debug and research.  Compatibility is not guaranteed. ##\n###########################################################\n\n# @ NODE_SCOPE (line: 1)\n# +- nd_tbl: (empty)\n# +- nd_args:\n# |   (null node)\n# +- nd_body:\n#     @ NODE_ITER (line: 1)\n#     +- nd_iter:\n#     |   @ NODE_FCALL (line: 1)\n#     |   +- nd_mid: :puts\n#     |   +- nd_args:\n#     |       (null node)\n#     +- nd_body:\n#         @ NODE_SCOPE (line: 1)\n#         +- nd_tbl: (empty)\n#         +- nd_args:\n#         |   (null node)\n#         +- nd_body:\n#             @ NODE_VCALL (line: 1)\n#             +- nd_mid: :is_this_a_block\n</code></pre>\n\n<p>Is the information outputted here available at runtime? If so, does the information represent merely what code has been written down, or does it also have the results of any metaprogramming that has been done?</p>\n"},{"tags":["ruby-on-rails","ruby","validation","nested"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13174435,"title":"Rails nested with_option :if used in validation","body":"<pre><code>validate :updatable?  # First validation there is\nwith_options :if =&gt; Proc.new { |object| object.errors.empty? } do |updatable|\n    updatable.with_options :if =&gt; \"self.current_step == basic\" do |step|\n        validates .... bla-bla bla\n</code></pre>\n\n<p>So, before any validations are made, the <em>updatable</em> subroutine is called and it populates the <code>errors[:base]</code> array with appropriate errors, meaning that object is not updatable. And I wanted it to skip the rest of the validations if any errors are found in this subroutine, but abovementioned example is <strong>NOT</strong> working - it performs all the validations.</p>\n\n<p>But, if I change <code>:if =&gt; \"self.current_step == basic\"</code> to <code>:if =&gt; \"self.errors.empty? &amp;&amp; self.current_step == basic\"</code> is works like a charm. </p>\n\n<p>What I'm doing wrong ? Examples show, that nested <code>with_option</code> should work. </p>\n\n<p>Can someone help me ? Thanks in advance.</p>\n"},{"tags":["ruby","string","image","fancybox","blob"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13168836,"title":"Fancybox shows blob as string not image (Ruby issue?)","body":"<p>I am displaying an image obtained from a database (stored as a long blob) in an <code>img</code> tag using the following method:</p>\n\n<pre><code>&lt;img src=\"http://localhost:3000/show_image/265\" /&gt;\n</code></pre>\n\n<p>The show_image function takes the image data from the database and renders it to the <code>img</code> tag   using the <code>send_data</code> method.</p>\n\n<p>When applying Fancybox onto the <code>img</code> tag, the data is displayed as BLOB data not the image..</p>\n\n<p>Can anyone suggest a reason why? Or how I can solve this?</p>\n"},{"tags":["ruby","ruby-datamapper"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13173853,"title":"How to write a (Ruby) DataMapper custom type based on MySQL VARBINARY","body":"<p>I want to use UUIDs as primary keys in my database and was recommended to use VARBINARY(16) as column type.</p>\n\n<p>I have the following so far:</p>\n\n<pre><code>module DataMapper\n  class Property\n      class UUIDKey &lt; String\n        key true\n\n        default proc { SecureRandom.uuid.delete('-') }\n\n        writer :private\n\n        def dump(value)\n          # add '0x' to save as hex number\n          # according to http://kekoav.com/posts/uuid-primary-key-mysql\n\n          '0x' + value unless value.nil?\n        end\n\n        def load(value)\n          value unless value.nil?\n        end\n\n        def typecast(value)\n          # how to convert binary value in db?\n          load(value)\n        end\n      end\n  end\nend\n</code></pre>\n\n<p>DataMapper will of course save a value as string based on above.</p>\n\n<p>How can I get DataMapper to save this as binary/hex and load as string?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","guard","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13170077,"title":"Why is guard stopping?","body":"<p>I have a rails application that I just threw guard and minitest and my gaurd file is </p>\n\n<pre><code>guard 'minitest', :cli =&gt; '--drb --format doc --color' do\n  # with Minitest::Unit\n  watch(%r|^test/(.*)\\/?test_(.*)\\.rb|)\n  watch(%r|^lib/(.*)([^/]+)\\.rb|)     { |m| \"test/#{m[1]}test_#{m[2]}.rb\" }\n  watch(%r|^test/test_helper\\.rb|)    { \"test\" }\n\n  # Rails\n  watch(%r|^app/controllers/(.*)\\.rb|) { |m| \"test/functional/#{m[1]}_test.rb\" }\n  watch(%r|^app/helpers/(.*)\\.rb|)     { |m| \"test/helpers/#{m[1]}_test.rb\" }\n  watch(%r|^app/models/(.*)\\.rb|)      { |m| \"test/unit/#{m[1]}_test.rb\" }  \nend\n</code></pre>\n\n<p>but when i run guard i get a command prompt</p>\n\n<pre><code>bundle exec guard\n22:14:12 - INFO - Guard uses TerminalTitle to send notifications.\n22:14:12 - INFO - Guard is now watching at '/Users/trace/Sites/application'\n1.9.3 (main):0 &gt; 2 + 2\n=&gt; 4\n</code></pre>\n\n<p>Why am i getting this prompt. Any ideas... here are some of the gems i am using</p>\n\n<p><strong>UPDATE...</strong></p>\n\n<p>when i run <code>all minitest</code> then the tests run...but why do i have to run that...any ideas</p>\n"},{"tags":["ruby","rspec","guard","fsevents"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13168725,"title":"OSX RoR Guard failing to auto run on file updates for certain files","body":"<p>I'm absolutely baffled.. (And quite frustrated too.. )</p>\n\n<p>For some reason guard isn't detecting file updates on osx, but only for certain files.  It's almost like the regexp defined in the watch function isn't working or something.. </p>\n\n<p>I have created a brand new rails app for fiddling around following Ryans guard railscast --\n<a href=\"http://railscasts.com/episodes/264-guard\" rel=\"nofollow\">http://railscasts.com/episodes/264-guard</a></p>\n\n<p>And have the default guardfile as generated by;</p>\n\n<pre><code>guard init spec\n</code></pre>\n\n<p>which looks like this; </p>\n\n<pre><code># A sample Guardfile\n# More info at https://github.com/guard/guard#readme\n\nguard 'rspec', :cli =&gt; \"--color --format nested --fail-fast\" do\n  watch(%r{^spec/.+_spec\\.rb$})\n  watch(%r{^lib/(.+)\\.rb$})     { |m| \"spec/lib/#{m[1]}_spec.rb\" }\n  watch('spec/spec_helper.rb')  { \"spec\" }\n\n  # Rails example\n  watch(%r{^app/(.+)\\.rb$})                           { |m| \"spec/#{m[1]}_spec.rb\" }\n  watch(%r{^app/(.*)(\\.erb|\\.haml)$})                 { |m| \"spec/#{m[1]}#    {m[2]}_spec.rb\" }\n  watch(%r{^app/controllers/(.+)_(controller)\\.rb$})  { |m| [\"spec/routing/#    {m[1]}_routing_spec.rb\", \"spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb\", \"spec/acceptance/#    {m[1]}_spec.rb\"] }\n  watch(%r{^spec/support/(.+)\\.rb$})                  { \"spec\" }\n  watch('config/routes.rb')                           { \"spec/routing\" }\n  watch('app/controllers/application_controller.rb')  { \"spec/controllers\" }\n\n  # Capybara request specs\n  watch(%r{^app/views/(.+)/.*\\.(erb|haml)$})          { |m| \"spec/requests/#{m[1]}_spec.rb\" }\n\n  # Turnip features and steps\n  watch(%r{^spec/acceptance/(.+)\\.feature$})\n  watch(%r{^spec/acceptance/steps/(.+)_steps\\.rb$})   { |m| Dir[File.join(\"**/#{m[1]}.feature\")][0] || 'spec/acceptance' }\nend\n</code></pre>\n\n<p>If I edit application_controller.rb or a spec file in the spec dir, guard will autorun just fine.</p>\n\n<p>But if I edit and save any other controller, nothing happens.</p>\n\n<p>I have run guard as both <code>guard</code> and <code>bundle exec guard</code> with no difference;  It just runs the full suite once then sits there at a prompt.</p>\n\n<p>macbook pro os v10.6.8.<br>\nRVM with Ruby-1.9.3-p286 and Rails 3.2.8\nrb-fsevent 0.9.2</p>\n\n<p>One of my coworkers is running the exact same thing directly pulled from git with the same system specs (company issued mbp's), and it works for him.</p>\n\n<p>When he edits <code>app/home_controller.rb</code> and just gives it an extra line or something, hits save.. the tests fire.</p>\n\n<p>When I edit the file and hit save, nothing happens but if I edit <code>app/application_controller.rb</code> it fires.. </p>\n\n<p>I'm confused.. I'm frustrated.. I need help as I'm at a loss.. </p>\n\n<p>Thoughts?</p>\n"},{"tags":["mysql","ruby","rubygems","chef","percona"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13167696,"title":"Dependencies for chef_gem","body":"<p>I am currently updating the <a href=\"http://community.opscode.com/cookbooks/mysql\" rel=\"nofollow\">community MySQL cookbook</a> so that it can be used to install Percona, which is a drop in replacement for stock MySQL but has some added functionality to easily enable HA and clustering.</p>\n\n<p>All my additions have worked well until I wanted to be able to use the 'ruby' recipe within the cookbook.  This uses the 'chef_gem' provider to install the 'mysql' rubygem.  As this is a native extension it needs to be compiled and, to do this, the development files for MySQL need to be installed.</p>\n\n<p>If I use the normal MySQL binaries everything works well as MySQL is already in the Centos repositories.  However, so that I can install the Percona packages, I need to ensure that the repo is in '/etc/yum.repos.d'.  The problem I am having is that I cannot get chef to do that work before attempting to install the mysql gem.</p>\n\n<p>So, what ends up happening is the system attempts to compile the mysql gem without the development header files for MySQL (Percona) being installed and, even if they are referenced correctly, they are not found as the repository has not been setup.</p>\n\n<p>I created a 'percona-repo' recipe that does this work using the 'yum' provider but it does not run before the 'chef_gem' does.  I know that chef has two phases for running and I am assuming that 'chef_gem' is gathering all gems up in the compile phase, regardless of where they are in the overall run list, and then installing all items requested at the beginning.  The repository recipe would then be run afterwards.</p>\n\n<p>I tried to play around with the Ruby recipe to do things like:</p>\n\n<pre><code>include_recipe \"mysql::percona_repo\"\n\nnode['mysql']['client']['packages'].each do |mysql_pack|\n    package mysql_pack do\n        action :nothing\n    end.run_action(:install)\nend\n\nchef_gem \"mysql\" do\n   action :nothing\nend.run_action(:install)\n</code></pre>\n\n<p>But this does not work.  The chef_gem always runs before my \"precona_repo\" recipe, so the the package installs fail which, if it got that far, would mean that the ruby gem installation would also fail.</p>\n\n<p>If anyone has any bright ideas on how I can solve this please let me know.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Thanks to the suggestion from Mark, I have now update the 'ruby' recipe so that I call the resources to add the new key and repo to the server:</p>\n\n<pre><code>resources(:yum_key =&gt; \"RPM-GPG-KEY-percona\").run_action(:add)\nresources(:yum_repository =&gt; \"Percona\").run_action(:add)\n</code></pre>\n\n<p>And now I can see these being activated in the chef run.  However when I look at the filesystem the files are not there so the installation of the mysql client packages fails.</p>\n\n<p>I have done some digging around in the yum cookbook and have found that the provider for the yum_key attempts to run 'remote_file' to download the key as you would expect.  However this 'remote_file' is not running.  So then I tried to run this as a resource like the above but it has a variable in the name so I cannot call it effectively, e.g.:</p>\n\n<pre><code>remote_file \"/etc/pki/rpm-gpg/#{new_resource.key}\" do\n    ...\nend\n</code></pre>\n\n<p>I think I am beginning to go down a bit of a rabbit warren here.  I will keep attempting to get the thing to work but any more ideas are most welcome.  I am trying not to go down the route of directly coding in the repo in this recipe as I prefer to reuse things that I know work.</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13173594,"title":"Rails 3 Speed up Active Record Callbacks after_commit to send notifications using Private_pub","body":"<p>I am using 3 callbacks after a post is created.</p>\n\n<p>1) Post created</p>\n\n<p>callback#1) <code>after_commit :do_notify, :on =&gt; :create</code>  for crating Notification</p>\n\n<p>2) Notification created</p>\n\n<p>callback#2) <code>after_commit :publish_to_all, :on =&gt; :create</code> for sending out messages/ to user using Private_pub</p>\n\n<p>It is taking more than a minute to complete whole flow.</p>\n\n<blockquote>\n  <p>Question#1: <em>Is the approach wrong</em></p>\n  \n  <p>Question#2: <em>is there a method to send rest of callbacks to background\n  and complete it there.</em></p>\n</blockquote>\n"},{"tags":["ruby","security","https","sinatra","rack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13173543,"title":"Using https in Sinarta (Rack) application","body":"<p>I develop   a Sinatra app which lets users to login through some external web sites. One of those sites requires having 2 https pages on my Sinatra web site: Accept and Reject:</p>\n\n<pre><code>https://my_sinatra_app.com/external_login/site1/accept  \nhttps://my_sinatra_app.com/external_login/site1/reject\n</code></pre>\n\n<p>If an user enters valid login and password and clicks \"Agree\" on site1, they are going to be redirected to accept page on my web site, otherwise -- to reject one.</p>\n\n<p>Well, it's not so important. The question is, what do I have to do to use https in a Sinatra application? I need a very solution which allows me to use https on localhost and on a web hosting. Just to make my application work especially on localhost.</p>\n\n<p>Your thoughts?</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1852,"score":0,"question_id":2699902,"title":"get next/previous month from a Time object","body":"<p>I have a Time object and would like to find the next/previous month. Adding subtracting days does not work as the days per month vary.</p>\n\n<pre><code>time = Time.parse('21-12-2008 10:51 UTC')\nnext_month = time + 31 * 24 * 60 * 60\n</code></pre>\n\n<p>Incrementing the month also falls down as one would have to take care of the rolling</p>\n\n<pre><code>time = Time.parse('21-12-2008 10:51 UTC')\nnext_month = Time.utc(time.year, time.month+1)\n\ntime = Time.parse('01-12-2008 10:51 UTC')\nprevious_month = Time.utc(time.year, time.month-1)\n</code></pre>\n\n<p>The only thing I found working was</p>\n\n<pre><code>time = Time.parse('21-12-2008 10:51 UTC')\nd = Date.new(time.year, time.month, time.day)\nd &gt;&gt;= 1\nnext_month = Time.utc(d.year, d.month, d.day, time.hour, time.min, time.sec, time.usec)\n</code></pre>\n\n<p>Is there a more elegant way of doing this that I am not seeing?\nHow would you do it?</p>\n"},{"tags":["ruby","ruby-cocoa"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13172407,"title":"cannot load such file -- osx/cocoa error on 1.9.3","body":"<p>I am encountering the following error with osx-trash. </p>\n\n<p>I am on ruby 1.9.3dev (2011-09-23 revision 33323) [x86_64-darwin12.2.0]</p>\n\n<pre><code>$ gem install osx-trash \nSuccessfully installed osx-trash-1.0.0\n1 gem installed\nInstalling ri documentation for osx-trash-1.0.0...\nInstalling RDoc documentation for osx-trash-1.0.0...\n\n$ touch foo \n\n$ trash foo \n/Users/vng/.rvm/rubies/ruby-1.9.3-rc1/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- osx/cocoa (LoadError)\n    from /Users/vng/.rvm/rubies/ruby-1.9.3-rc1/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/vng/.rvm/gems/ruby-1.9.3-rc1/gems/osx-trash-1.0.0/bin/trash:35:in `&lt;top (required)&gt;'\n    from /Users/vng/.rvm/gems/ruby-1.9.3-rc1/bin/trash:19:in `load'\n    from /Users/vng/.rvm/gems/ruby-1.9.3-rc1/bin/trash:19:in `&lt;main&gt;'\n    from /Users/vng/.rvm/gems/ruby-1.9.3-rc1/bin/ruby_noexec_wrapper:14:in `eval'\n    from /Users/vng/.rvm/gems/ruby-1.9.3-rc1/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>What is osx/cocoa? </p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":545,"score":2,"question_id":2800133,"title":"How to get today's day of previous month in ruby?","body":"<p>Is there a built-in function to get the day in last month,  same as today? Examples:</p>\n\n<pre><code>2010/05/02 -&gt; 2010/04/02\n2010/05/15 -&gt; 2010/04/15\n2010/05/31 -&gt; 2010/04/30\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","sinatra","irb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12890641,"title":"Accessing the irb in a modular Sinatra application","body":"<p>I am building an application which subclasses Sinatra like so:</p>\n\n<pre><code>require 'rubygems'\nrequire 'sinatra/base'\nrequire 'sinatra/assetpack'\n\nclass App &lt; Sinatra::Base\n  ...\n\n  run!\nend\n</code></pre>\n\n<p>How can I access irb? Options are not parsed when executing sinatra this way, how do I programmatically open an irb shell?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13168912,"title":"How to redirect non existing routes in rails","body":"<p>I have switched from an old site with a good page rank to RubyOnRails. </p>\n\n<p>Of course all links are broken now. When a user visits my site via a google link he will get:</p>\n\n<pre><code>Routing Error\n\nNo route matches [GET] \"/SOME_WRONG/URL/WITH/PARAMETERS\"\n</code></pre>\n\n<p>What is the best way to redirect the user on error like that to my root_url?</p>\n\n<p>And where I have to put this code?</p>\n\n<pre><code>.htaccess?\napplication_controller?\napplication.rb?\nroutes.rb?\n</code></pre>\n\n<p>many many thanks in advance :-)</p>\n"},{"tags":["ruby","eventmachine"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1519,"score":4,"question_id":4645761,"title":"How to write (large) files with Ruby Eventmachine","body":"<p>I've spent several days now finding some non-echo-server examples for eventmachine, but there just don't seem to be any. Let's say i want to write a server that accepts a file and writes it to a Tempfile:</p>\n\n<pre><code>require 'rubygems'\nrequire 'tempfile'\nrequire 'eventmachine'\n\nmodule ExampleServer\n\n  def receive_data(data)\n    f = Tempfile.new('random')\n    f.write(data)\n  ensure\n    f.close\n  end\n\nend\n\nEventMachine::run {\n  EventMachine::start_server \"127.0.0.1\", 8081, ExampleServer\n  puts 'running example server on 8081'\n}\n</code></pre>\n\n<p>Writing to the file would block the reactor, but i don't get how to do it 'Eventmachine style'. Would i have to read the data in chunks and write each chunk to disk within an Em.next_tick block?</p>\n\n<p>Thanks for any help\nAndreas</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":59,"score":4,"question_id":13172450,"title":"Shortest way to convert a Hash into String","body":"<p>there is a Hash like this:</p>\n\n<pre><code>params = { k1: :v1, k2: :v2, etc: :etc }\n</code></pre>\n\n<p>i need it converted to a string like this:</p>\n\n<pre><code>k1=\"v1\", k2=\"v2\", etc=\"etc\"\n</code></pre>\n\n<p>i have a working version:</p>\n\n<pre><code>str = \"\"\nparams.each_pair { |k,v| str &lt;&lt; \"#{k}=\\\"#{v}\\\", \" }\n</code></pre>\n\n<p>but it smells like ten PHP spirits ...</p>\n\n<p>what's the Ruby way to do this?</p>\n"},{"tags":["ruby-on-rails","ruby","pdf","itext","rjb"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":289,"score":0,"question_id":8734667,"title":"Ruby on Rails PDF Stamper / iText","body":"<p>I have done a lot of searching and cannot find a solution for getting PDF-stamper to work in my rails application. From the tutorials it appears that I write a method in the model? I wrote a simple app with two fields: nameLast and nameFirst. All I want to do is write these to a PDF I have that contains fields for user info. Two field happen to be FirstName and LastName so perfect time to use PDF-stamper right? I just want to take user data from the rails application and have then be able to push a button and generate a PDF. Here is the method I have in my model.</p>\n\n<pre><code>  def savePDF\n    pdf = PDF::Stamper.new(\"sample.pdf\") \n          pdf.text :nameFirst, \"Jason\"\n               pdf.text :nameLast, \"Yates\" \n               pdf.save_as \"my_output.pdf\"\n  end\n</code></pre>\n\n<p>That was clearly taken from a tutorial that I must not properly understand. I can actually get this working in java pretty easy, but I don't want to use jRuby. I am using rjb which is working fine. I just don't think I properly understand what needs to happen to get this working. Any help is greatly appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","rubygems","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":12966564,"title":"Can't make calls to heroku CLI from within a Rake task without the Heroku gem in the Gemfile","body":"<p>I've had an app running on Heroku for a while now and on a recent deployment saw the message that the Heroku gem was deprecated in favor of the Heroku Toolbelt.  With the toolbelt, all of my Heroku commands work fine from the command line but within a Rake task (which I have setup for deployments) I get the following errors:</p>\n\n<pre><code>$ rake deploy:staging\nEverything up-to-date\n\n/Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/gems/bundler-1.2.0/lib/bundler/rubygems_integration.rb:147:in `block in replace_gem': heroku is not part of the bundle. Add it to Gemfile. (Gem::LoadError)\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/heroku:18:in `&lt;main&gt;'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `eval'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n\n/Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/gems/bundler-1.2.0/lib/bundler/rubygems_integration.rb:147:in `block in replace_gem': heroku is not part of the bundle. Add it to Gemfile. (Gem::LoadError)\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/heroku:18:in `&lt;main&gt;'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `eval'\nfrom /Users/aramisbear/.rvm/gems/ruby-1.9.3-p194@myapp/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>The errors being shown are from this deployment rake task:</p>\n\n<pre><code>namespace :deploy do\n\n  desc \"deploys to Production after uploading assets to S3\"\n  task :production do\n    puts `git push heroku master`\n    puts `heroku run rake db:migrate --app myapp`\n    puts `heroku restart --app myapp`\n  end\n\n  desc \"deploys to Staging after uploading assets to S3\"\n  task :staging do\n    puts `git push staging staging:master`\n    puts `heroku run rake db:migrate --app myapp-staging`\n    puts `heroku restart --app myapp-staging`\n  end\nend\n</code></pre>\n\n<p>The two heroku commands in each task are where the problem comes from.  If I execute them from the command line, they work just fine though.  I doubt it matters but I'm running OSX with RVM as well.</p>\n\n<p>Any idea how to fix this? I realize it's not a huge deal since I can just run those additional command manually or alias them, but I'd just like to know why there's a problem in the first place.</p>\n"},{"tags":["ruby-on-rails","ruby","datetime","activesupport"],"answer_count":3,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":158,"score":7,"question_id":13129461,"title":"Ruby weirdness: x == y && [x, y].uniq == [x, y]","body":"<p>I have an two-element array of ActiveRecord objects, <code>slots_to_import</code>. These objects have <code>begin_at</code> columns, and thus attributes. I was trying to get objects that have unique <code>begin_at</code> values. Alas, <code>slots_to_import.uniq_by(&amp;:begin_at)</code> did not work. But the <code>begin_at</code> values are equal for the two objects:</p>\n\n<pre><code>(rdb:1) p slots_to_import.first.begin_at == slots_to_import.last.begin_at\ntrue\n(rdb:1) p slots_to_import.uniq_by(&amp;:begin_at).map(&amp;:begin_at)\n[Mon, 26 Nov 2012 19:00:00 UTC +00:00, Mon, 26 Nov 2012 19:00:00 UTC +00:00]\n(rdb:1) p [slots_to_import.first.begin_at, slots_to_import.last.begin_at].uniq\n[Mon, 26 Nov 2012 19:00:00 UTC +00:00, Mon, 26 Nov 2012 19:00:00 UTC +00:00]\n</code></pre>\n\n<p>Some more checking around:</p>\n\n<pre><code>(rdb:1) p [slots_to_import.first.begin_at.to_datetime, slots_to_import.last.begin_at.to_datetime].uniq\n[Mon, 26 Nov 2012 19:00:00 +0000]\n(rdb:1) p [slots_to_import.first.begin_at.usec, slots_to_import.last.begin_at.usec].uniq\n[0]\n(rdb:1) p [slots_to_import.first.begin_at.to_f, slots_to_import.last.begin_at.to_f].uniq\n[1353956400.0]\n(rdb:1) p [slots_to_import.first.begin_at.utc, slots_to_import.last.begin_at.utc].uniq\n[Mon, 26 Nov 2012 19:00:00 +0000]\n(rdb:1) p [slots_to_import.first.begin_at, slots_to_import.last.begin_at].uniq\n[Mon, 26 Nov 2012 19:00:00 UTC +00:00, Mon, 26 Nov 2012 19:00:00 UTC +00:00]\n</code></pre>\n\n<p>I thought perhaps that uniq was checking whether they were the same object (since they were not). But no, some noodling in my rails console showed me that it does not use an object id check:</p>\n\n<pre><code>1.8.7 :111 &gt; x = Time.zone.parse(\"Mon, 29 Oct 2012 19:29:17 UTC +00:00\")\n =&gt; Mon, 29 Oct 2012 19:29:17 UTC +00:00 \n1.8.7 :112 &gt; y = Time.zone.parse(\"Mon, 29 Oct 2012 19:29:17 UTC +00:00\")\n =&gt; Mon, 29 Oct 2012 19:29:17 UTC +00:00 \n1.8.7 :113 &gt; x == y\n =&gt; true \n1.8.7 :114 &gt; [x, y].uniq\n =&gt; [Mon, 29 Oct 2012 19:29:17 UTC +00:00] \n</code></pre>\n\n<p>I'm using Ruby 1.8.7p358 and ActiveSupport 3.2.0. BTW, I can solve my own issue by simply adding a <code>to_datetime</code>, but I'm really curious why this isn't working without a conversion.</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-api","oauth-2.0","google-calendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13165989,"title":"How do I fetch user's Google Calendar persistently with Ruby?","body":"<p>My app already fetches Google Calendar but users has to login every time to get the new calendar. The issue raises from token being expired after a while. </p>\n\n<p>I've already tried the following which is to include user.profile scope:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n    provider :google_oauth2, GOOGLE_APP_KEY, GOOGLE_APP_SECRET, {\n    scope: 'https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.profile',\nredirect_uri: GOOGLE_APP_CALLBACK_URL\n</code></pre>\n\n<p>}\n    end</p>\n\n<p>So, now the token persist so user doesn't have to login every single time to the app, but if the Google Calendar has new entry, my web app won't be able to fetch the new events because the token is expired.</p>\n\n<p>What's the way to solve this problem?</p>\n"},{"tags":["ruby","script","oauth","omniauth"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13171420,"title":"OmniAuth/OAuth Authentication from a ruby script","body":"<p>Is there a way I can test out the OmniAuth authentication from a standalone ruby script?\nEvery resource I could find on web lists its usage only in Rails project.This link too: <a href=\"http://www.omniauth.org/\" rel=\"nofollow\">http://www.omniauth.org/</a></p>\n\n<p>In other words I could not find any client like this <a href=\"https://github.com/whazzmaster/fitgem/wiki/The-OAuth-Process\" rel=\"nofollow\">FitGem</a>. The fitbit <a href=\"https://wiki.fitbit.com/display/API/OAuth+Authentication+in+the+Fitbit+API\" rel=\"nofollow\">API</a> uses Oauth authentication.FitGem is a client inteface to test out the authentication/authorization to FitBit using OAuth token.\nMore details here on FitGem: <a href=\"http://www.fitbitclient.com/guide/getting-started\" rel=\"nofollow\">http://www.fitbitclient.com/guide/getting-started</a></p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby","jekyll","maruku"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":179,"score":4,"question_id":11672025,"title":"Maruku tells you: what's wrong with me?","body":"<p>I use <code>jekyll --server</code> to test my site at localhost.\nBut there are a few lines of input, like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code> ___________________________________________________________________________\n | Maruku tells you:\n +---------------------------------------------------------------------------\n | String finished while reading (break on []) already read: \"$ git init\"\n | ---------------------------------------------------------------------------\n +---------------------------------------------------------------------------\n !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maru/errors_management.rb:49:in `maruku_error'\n !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/parse_span_better.rb:402:in `read_simple'\n !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/parse_span_better.rb:521:in `read_inline_code'\n !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/parse_span_better.rb:89:in `read_span'\n !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/    parse_span_better.rb:46:in    `parse_span_better'\n \\___________________________________________________________________________\n ___________________________________________________________________________\n | Maruku tells you:\n +---------------------------------------------------------------------------\n | Could not find ref_id = \"url\" for md_link([\"url\"],\"url\")\n | Available refs are []\n +---------------------------------------------------------------------------\n Not creating a link for ref_id = \"url\".\n</code></pre>\n\n<p>I don't know where is wrong, which file I should fix?\nThe site could still work.</p>\n"},{"tags":["ruby-on-rails","ruby","timezone"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":181,"score":0,"question_id":11833435,"title":"Convert local time to UTC in Rails","body":"<p>In my MySQL database the updated_at field is being stored as UTC.  Last week a record was entered at 7pm EDT and it's updated_at value is \"2012-08-01 23:00:00\".  I'm trying to convert local time for a web client to UTC that can be compared against the updated_at field in the database.</p>\n\n<p>As an example, I'd like to convert '08/01/2012 07:00 pm' to '2012-08-01 23:00:00' (accounting for me being in EDT) but I'm missing the time zone aspect to the conversion.  '7:00 pm' is local time and could be from any time zone.  My current code:</p>\n\n<pre><code>ruby-1.9.2-head :015 &gt; from_date = DateTime.strptime('08/01/2012 07:00 pm', '%m/%d/%Y %H:%M %p')\n=&gt; Wed, 01 Aug 2012 19:00:00 +0000 \nruby-1.9.2-head :016 &gt; from_date = Time.zone.parse(from_date.to_s).utc\n=&gt; 2012-08-01 19:00:00 UTC\n</code></pre>\n\n<p>Any thoughts?</p>\n\n<p>Edit: Also, I could use \"%Z\" in my strptime call but that's assuming I have the timezone in the value, which I currently do not. I guess I could use Javascript to send that along with the date/time value.</p>\n"},{"tags":["ruby","xcode","rvm","osx-mountain-lion"],"answer_count":2,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":3468,"score":7,"question_id":11660673,"title":"Install ree-1.8.7 with RVM on Mountain Lion","body":"<p>I had a fresh install of Mountain Lion and installed the <strong>Xcode Command Line Tools</strong>, .  I was able to get <strong>homebrew</strong> running and installed <strong>RVM</strong>.  Unfortunately, I can't get RVM to install <strong>ree-1.8.7-head</strong>.  It fails when compiling.  I thought it was related to X11, so I installed <strong>XQuartz</strong>.  Still no joy.  Then I went ahead and installed the full <strong>Xcode from the app store</strong>.  Still no joy.  Anyone gotten this going on a fresh Mountain Lion install?</p>\n\n<p>From the bottom of the <strong>.rvm/log/ree-1.8.7-head/make.log</strong>:</p>\n\n<pre><code>Find Tcl/Tk libraries. Make tcltklib.so which is required by Ruby/Tk.\ngcc -I. -I../.. -I../../. -I../.././ext/tk -DHAVE_RB_SAFE_LEVEL -DHAVE_RB_HASH_LOOKUP -DHAVE_RB_PROC_NEW -DHAVE_RB_OBJ_TAINT -DHAVE_ST_PTR -DHAVE_ST_LEN -DRUBY_VERSION=\\\"1.8.7\\\" -DRUBY_RELEASE_DATE=\\\"2012-02-08\\\"  -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -DWITH_TCL_ENABLE_THREAD=0 -fno-common -g -O2 -pipe -fno-common   -c stubs.c\nIn file included from stubs.c:10:\n/usr/include/tk.h:78:23: error: X11/Xlib.h: No such file or directory\nIn file included from stubs.c:10:\n/usr/include/tk.h:549: error: expected declaration specifiers or ‘...’ before ‘Window’\n/usr/include/tk.h:549: error: ‘Window’ declared as function returning a function\n</code></pre>\n\n<p>.\n.</p>\n\n<pre><code>/usr/include/tkDecls.h:1240: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute\n\n__’ before ‘Tk_GetBitmapFromObj’\n/usr/include/tkDecls.h:1245: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token\n/usr/include/tkDecls.h:1356: error: expected ‘)’ before ‘*’ token\n/usr/include/tkDecls.h:1362: error: expected ‘)’ before ‘*’ token\n/usr/include/tkDecls.h:1387: error: expected declaration specifiers or ‘...’ before ‘GC’\n/usr/include/tkDecls.h:1399: error: expected declaration specifiers or ‘...’ before ‘GC’\n/usr/include/tkDecls.h:1413: error: expected declaration specifiers or ‘...’ before ‘Pixmap’\n/usr/include/tkDecls.h:1420: error: expected declaration specifiers or ‘...’ before ‘XColor’\n/usr/include/tkDecls.h:1448: error: expected declaration specifiers or ‘...’ before ‘Pixmap’\n/usr/include/tkDecls.h:1524: error: expected ‘)’ before ‘*’ token\n/usr/include/tkDecls.h:1621: error: expected declaration specifiers or ‘...’ before ‘Drawable’\n/usr/include/tkDecls.h:1656: error: expected ‘)’ before ‘*’ token\n/usr/include/tkDecls.h:1661: error: expected ‘)’ before ‘*’ token\n/usr/include/tkDecls.h:1692: error: expected specifier-qualifier-list before ‘XColor’\nmake[1]: *** [stubs.o] Error 1\nmake: *** [all] Error 1\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":9674680,"title":"Rails PJAX not working","body":"<p>I have added the pjax javascript.</p>\n\n<p>In my view I have:</p>\n\n<pre><code>&lt;div data-pjax-container&gt;\n&lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But still onclick the hole page updates. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13170314,"title":"Better Rails code for update or create clause?","body":"<p>The code smells and i'm sure i'm missing a helper to do a simple \nupdate or create query like the below snippet :</p>\n\n<pre><code>  @user_answer = current_user.user_answers.find_by_question_id(params[:a_question])\n  if @user_answer.nil?\n    @user_answer = current_user.user_answers.build({ :answer_id =&gt; params[:an_answer] , :question_id =&gt; params[:a_question] })      \n    @user_answer.save  \n  else\n    @user_answer.update_attributes(:answer_id =&gt; params[:an_answer])\n    @user_answer.save \n  end\n</code></pre>\n"},{"tags":["ruby","http","http-headers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13152264,"title":"Sending http post request in Ruby by Net::HTTP","body":"<p>I'm sending a request with custom headers to a web service.</p>\n\n<pre><code>require 'uri'\nrequire 'net/http'\n\nuri = URI(\"https://api.site.com/api.dll\")\nhttps = Net::HTTP.new(uri.host, uri.port)\nhttps.use_ssl = true\nheaders = \n{\n    'HEADER1' =&gt; \"VALUE1\",\n    'HEADER2' =&gt; \"HEADER2\"\n}\n\nresponse = https.post(uri.path, headers) \nputs response\n</code></pre>\n\n<p>It's not working, I'm receiving an error of:</p>\n\n<pre><code>/usr/lib/ruby/1.9.1/net/http.rb:1932:in `send_request_with_body': undefined method `bytesize' for #&lt;Hash:0x00000001b93a10&gt; (NoMethodError)\n</code></pre>\n\n<p>How do I solve this?</p>\n\n<p>P.S. <code>Ruby 1.9.3</code></p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":125,"score":4,"question_id":11108942,"title":"Invalid Encoding Symbol with Classifier gem","body":"<p>Everything seemed to be working fine as I added items to my Postgres database. Without changing anything, my Rails app started failing whenever it started Madeleine anywhere in my app:</p>\n\n<pre><code>EncodingError in EventsController#update\n  invalid encoding symbol\n  app/controllers/events_controller.rb:137:in `update'\n</code></pre>\n\n<p>137 is the problem line:</p>\n\n<pre><code>135 def update\n136   @event = Event.find(params[:id])\n137   m = SnapshotMadeleine.new(\"bayes_data\")\n      ....\n    end\n</code></pre>\n\n<p>I'm able to classify things in the console, though, which is part of what's causing me confusion. In the console, this works fine:</p>\n\n<pre><code>m = SnapshotMadeleine.new(\"bayes_data\") {}\n   =&gt; #&lt;Madeleine::DefaultSnapshotMadeleine:0x000...\nm.system\n   =&gt; #&lt;Classifier::Bayes:0x000...\nm.system.classify \"test\"\n</code></pre>\n\n<p>I'm using the latest Classifier gem with Madeleine.</p>\n\n<p>I figured that something was corrupted in my snapshot that it attempted to load, so I removed it, but that didn't solve the problem. Here's my second-to-last snapshot (now the most recent one):</p>\n\n<pre><code>a = File.read('bayes_data/000000000000000000041.snapshot')\na.encoding\n   =&gt; #&lt;Encoding:UTF-8&gt;\na.valid_encoding?\n   =&gt; true\n</code></pre>\n\n<p>Not sure what's going on here. I saw some people with Ruby 1.9.3-p125 had similar problems, so I upgraded to the latest stable release, 1.9.3-p194, but that didn't help, either.</p>\n\n<p>Here's a link to the documentation for Classifier, which mentions how to use Madeleine as well: <a href=\"http://classifier.rubyforge.org/\" rel=\"nofollow\">http://classifier.rubyforge.org/</a></p>\n\n<p>I'd really appreciate any insight into what's going on here. Thanks!</p>\n"},{"tags":["asp.net",".net","ruby","ironruby"],"answer_count":4,"favorite_count":1,"up_vote_count":16,"down_vote_count":0,"view_count":1252,"score":16,"question_id":9230809,"title":"Is IronRuby Dead?","body":"<p>I am .Net programmer who is looking to branch out and possibly use some Ruby in my current and future web applications. Looking on the <a href=\"http://www.ironruby.net/\">Iron Ruby Website</a> the last release was nearly a year ago: March 13, 2011. No <a href=\"http://www.ironruby.net/announcements/\">announcements</a> have have been made on their website since that time either.</p>\n\n<p>With all of this, a several questions come to mind: </p>\n\n<ol>\n<li>Is IronRuby Dead?</li>\n<li>If the project is dead, are there any alternatives that are integrated in .Net? </li>\n<li>If it's alive, is it still an actively maintained project? Where can I find the most recent release?</li>\n<li>Am I barking up the wrong tree? Should I leave ruby as just ruby and .Net as .Net, two separate entities never to meet in the same project?</li>\n</ol>\n\n<p>I've seen questions regarding IronRuby on stackoverflow <a href=\"http://stackoverflow.com/search?tab=newest&amp;q=ironruby\">recently</a>, so obviously folks are using it. I'm not sure if they're supporting legacy applications or doing new development work.</p>\n"},{"tags":["ruby-on-rails","ruby","sqlite3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13170156,"title":"sqlite3_native.so: [BUG] Segmentation fault","body":"<p>I'm running into this sqlite3 issue and can't figure out why ; I browsed this forum for many hours and could not find a similar issue reported.\nI'm using ruby 1.9.3, but the error message seems to invoke ruby 1.8.7 ; I even uninstalled ruby 1.8.7 then sqlite3 and then reinstalled it but that did not solve the issue</p>\n\n<p>I'm running rails 3.2.8</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rails -v\nRails 3.2.8\n</code></pre>\n\n<p>and ruby 1.9.3</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\n</code></pre>\n\n<p>uninstalled ruby 1.8.7</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rvm uninstall 1.8.7\n/home3/user1/.rvm/src/ruby-1.8.7-p371 has already been removed.\n/home3/user1/.rvm/rubies/ruby-1.8.7-p371 has already been removed.\n</code></pre>\n\n<p>uninstalled sqlite3</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# gem uninstall sqlit3\nINFO:  gem \"sqlit3\" is not installed\nuser1@company.com [~/rails_apps/myapp]# gem uninstall sqlite3\n\nYou have requested to uninstall the gem:\n    sqlite3-1.3.6\ni18n-0.6.1 depends on [sqlite3 (&gt;= 0)]\nIf you remove this gems, one or more dependencies will not be met.\nContinue with Uninstall? [Yn]  Y\nSuccessfully uninstalled sqlite3-1.3.6\n</code></pre>\n\n<p>reinstalled sqlite3</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# gem install sqlite3 \nFetching: sqlite3-1.3.6.gem (100%)\nBuilding native extensions.  This could take a while...\nSuccessfully installed sqlite3-1.3.6\n1 gem installed\nInstalling ri documentation for sqlite3-1.3.6...\nunable to convert \"\\xC3\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.rdoc, skipping\nInstalling RDoc documentation for sqlite3-1.3.6...\nunable to convert \"\\xC3\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.rdoc, skipping\n</code></pre>\n\n<p>same error message again</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rails generate scaffold project customer:string \n/home3/user1/ruby/gems/gems/sqlite3-1.3.6/lib/sqlite3/sqlite3_native.so: [BUG] Segmentation fault\nruby 1.8.7 (2012-02-08 MBARI 8/0x6770 on patchlevel 358) [x86_64-linux], MBARI 0x6770, Ruby Enterprise Edition 2012.02\n\nAborted\nuser1@company.com [~/rails_apps/myapp]# \n</code></pre>\n\n<p>Anyone can please help?</p>\n"},{"tags":["ruby","bundler","foreman"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13168544,"title":"How can I run multiple apps of multiple bundle with foreman","body":"<p>I have a ruby app that depends of several web-services i've built.</p>\n\n<p>To start all together I've got the following Procfile:</p>\n\n<pre><code>mondodb: /home/dwaynemac/mongodb/bin/mongod \naccounts: ./script/start_accounts.sh\ncontacts: ./script/start_contacts.sh\nactivity: ./script/start_activity_stream.sh\nweb: ./script/start.sh\n</code></pre>\n\n<p>Each of this start_xxx.sh script do something like:</p>\n\n<pre><code>cd ../activity_stream; bundle exec unicorn -p 3003 -c ./config/unicorn.rb\n</code></pre>\n\n<p>If I manually run these previous line activity_stream runs ok. But when ran from foreman some gems are not recognized. As if the bundle was not correctly built.</p>\n\n<p>Example error:</p>\n\n<pre><code>activity_stream/config/boot.rb:2:in `require': no such file to load -- grape (LoadError)\n</code></pre>\n"},{"tags":["ruby","emacs","emacs24"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":40,"score":2,"question_id":13167506,"title":"Tab key not working in Emacs ruby-mode","body":"<p>Having an issue with Emacs 24.2.50.1 running on Debian. In ruby-mode whenever I hit tab key to edit indentation, I receive the error: \"Wrong-type-argument: number-or-marker-p, nil\"</p>\n\n<p>Further inspection reveals this about the error:</p>\n\n<pre><code>Debugger entered--Lisp error: (wrong-type-argument number-or-marker-p nil)\nruby-calculate-indent()\nruby-indent-line()\nindent-for-tab-command(nil)\ncall-interactively(indent-for-tab-command nil nil)\n</code></pre>\n\n<p>Note that tab key works as it should outside of ruby-mode (works fine in python-mode, etc), so I think it must be a bug within ruby-mode for indenting, but any help in diagnosing and fixing this issue would be appreciated.</p>\n"},{"tags":["ruby","file","recursion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13169364,"title":"Detecting if the current file is the main file","body":"<p>How can I detect if the current reading of a file is done directly from the command line, or is is done via loading/requiring?</p>\n\n<p>There is a well known way:</p>\n\n<pre><code>__FILE__ == $0\n</code></pre>\n\n<p>but this does not work correctly when there is a possibility that the main file loads itself.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13168854,"title":"How to return integer in ruby main method","body":"<p>Here is my code </p>\n\n<pre><code>if __FILE__ == $PROGRAM_NAME\n  puts \"tests\"\n  puts $PROGRAM_NAME\n  return 1\nend\n</code></pre>\n\n<p>I am trying to have a git pre-commit feature with ruby. And this pre-commit needs an integer return.</p>\n\n<p>When I run this piece ruby code I got an error</p>\n\n<pre><code>`&lt;main&gt;': unexpected return (LocalJumpError)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":6,"favorite_count":1,"up_vote_count":9,"down_vote_count":3,"view_count":5718,"score":6,"question_id":705729,"title":"How do I create a ruby Hello world?","body":"<p>I know in PHP you have to intrepret a page like index.php, but in Ruby how does it work? I don't know what is the Ruby extension like index.php for PHP. Could you help me?</p>\n"},{"tags":["ruby","xml","mongodb"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":49,"score":0,"question_id":7532421,"title":"Is there a natural way to map a hash or a XML file to a Mongo document?","body":"<p>Is there a way to take a hash of data (or even better an XML document) could be mapped straight to a mongo document.  So this hash:</p>\n\n<pre><code>@hash = {\n   \"doc_id\"       =&gt; 3928,\n   \"header\"       =&gt;[\n       {\"merchantId\"=&gt;[\"35701\"], \n        \"merchantName\" =&gt;[\"Lingerie.com\"], \n        \"createdOn\"    =&gt;[\"2011-09-23/00:33:35\"]}\n    ], \n   \"trailer\"      =&gt;[\n       {\"numberOfProducts\"=&gt;[\"0\"]}\n    ]\n}\n</code></pre>\n\n<p>Would become:</p>\n\n<pre><code>&gt; db.doc.first()\n{\n  _id : ObjectId(\"4e77bb3b8a3e000000004f7a\"),\n  doc_id : 3928\n  header : [{\n      merchantId : \"35701\", \n      merchantName : Lingerie.com \n  }],\n  trailer : [{\n    numberOfProducts : 0 \n  }]\n}\n</code></pre>\n"},{"tags":["ruby","csv","nokogiri"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13166666,"title":"How to scrape data from list of URLs and save data to CSV with nokogiri","body":"<p>I have a file called bontyurls.csv that looks like this:</p>\n\n<pre><code>http://bontrager.com/model/11383\nhttp://bontrager.com/model/01740\nhttp://bontrager.com/model/09595\n</code></pre>\n\n<p>I want my script to read that file and then spit out a file like this: bonty_test_urls_results.csv</p>\n\n<pre><code>url,model_names\nhttp://bontrager.com/model/11383,\"Road TLR Conversion Kit\"\nhttp://bontrager.com/model/01740,\"404 File Not Found\"\nhttp://bontrager.com/model/09595,\"RXL Road\"\n</code></pre>\n\n<p>Here's what I've got so far:</p>\n\n<pre><code># based on code from here: http://www.andrewsturges.com/2011/09/how-to-harvest-web-data-using-ruby-and.html\n\nrequire 'nokogiri'\nrequire 'open-uri'\nrequire 'csv'\n\n@urls = Array.new\n@model_names = Array.new\n\nurls = CSV.read(\"bontyurls.csv\")\n(0..urls.length - 1).each do |index|\n  puts urls[index][0]\n  doc = Nokogiri::HTML(open(urls[index][0]))\n  doc.xpath('//h1').each do |model_name|\n    @model_name &lt;&lt; model_name.content\n  end\nend\n\n# write results to file  \nCSV.open(\"bonty_test_urls_results.csv\", \"wb\") do |row|\n  row &lt;&lt; [\"url\", \"model_names\"]\n  (0..@urls.length - 1).each do |index|\n    row &lt;&lt; [\n      @urls[index], \n      @model_names[index]]\n  end\nend\n</code></pre>\n\n<p>That code isn't working. I'm getting this error:</p>\n\n<pre><code>$ ruby bonty_test_urls.rb \nhttp://bontrager.com/model/00310\nbonty_test_urls.rb:15:in `block (2 levels) in &lt;main&gt;': undefined method `&lt;&lt;' for nil:NilClass (NoMethodError)\n    from /home/simon/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:239:in `block in each'\n    from /home/simon/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `upto'\n    from /home/simon/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `each'\n    from bonty_test_urls.rb:14:in `block in &lt;main&gt;'\n    from bonty_test_urls.rb:11:in `each'\n    from bonty_test_urls.rb:11:in `&lt;main&gt;'\n</code></pre>\n\n<p>Here is some code that returns the model_name at least. I'm just having trouble getting it to work in the larger script:</p>\n\n<pre><code>require 'open-uri'\nrequire 'nokogiri'\n\ndoc = Nokogiri::HTML(open(\"http://bontrager.com/model/09124\"))\ndoc.xpath('//h1').each do |node|\n  puts node.text\nend\n</code></pre>\n\n<p>Also, I haven't figured out how to handle the URLs that return a 404.</p>\n"},{"tags":["ruby-on-rails","ruby","routing"],"answer_count":8,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1158,"score":0,"question_id":9991304,"title":"Routing Error during \"Ruby on Rails-Tutorial\"","body":"<p>It seems like some people here had this problem but I couldn't find any solution in another topic.</p>\n\n<p>I am doing Chapter 3 of the Ruby on Rails-Tutorial, working on the static pages. When I want to open them on the localhost it gives me a \"Routing Error\" in the Browser.</p>\n\n<p>My Ruby is currently on version 1.9.3.\nMy Rails is currently on version 3.2.</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li>restarting the server</li>\n<li>saving all the files again</li>\n<li>checking any issues in the static_pages_controller.rb</li>\n<li>checking any issues in the routes.rb</li>\n<li>checking any issues in the static_oages_spec.rb</li>\n</ul>\n\n<p>Also there are no bugs in the HTML code of the single static page. And I can't find any more help in the tutorial, neither in other questions here on StackOverflow.</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>This is the actual error message from the browser:</p>\n\n<blockquote>\n  <p>Routing Error </p>\n  \n  <p>No route matches [GET] \"/static_pages/home\" Try running\n  rake routes for more information on available routes.</p>\n</blockquote>\n\n<p>if I go to <code>http://localhost:3000/static_pages/home</code>, to one of three static pages I have.</p>\n\n<p>This is routes.rb:</p>\n\n<pre><code>SampleApp::Application.routes.draw do\n\nget \"static_pages/home\"\n\nget \"static_pages/help\"\n\nget \"static_pages/about\"\n\nend\n</code></pre>\n\n<p>Also, I tried \"<code>rake routes</code>\" in the terminal, too. This is the result:</p>\n\n<pre><code>home_static_pages GET    /static_pages/home(.:format)  static_pages#home\n help_static_pages GET    /static_pages/help(.:format)  static_pages#help\nabout_static_pages GET    /static_pages/about(.:format) static_pages#about\n      static_pages POST   /static_pages(.:format)       static_pages#create\n  new_static_pages GET    /static_pages/new(.:format)   static_pages#new\n edit_static_pages GET    /static_pages/edit(.:format)  static_pages#edit\n                   GET    /static_pages(.:format)       static_pages#show\n                   PUT    /static_pages(.:format)       static_pages#update\n                   DELETE /static_pages(.:format)       static_pages#destroy\n</code></pre>\n\n<p>And this is the error message the server is giving me:</p>\n\n<pre><code>Started GET \"/static_pages/home.html\" for 127.0.0.1 at 2012-04-03 13:23:54 +0200\n\nActionController::RoutingError (No route matches [GET] \"/static_pages/home.html\"):\n  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.3) lib/rails/engine.rb:479:in `call'\n  railties (3.2.3) lib/rails/application.rb:220:in `call'\n  rack (1.4.1) lib/rack/content_length.rb:14:in `call'\n  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /Network/Servers/pluto.kayoom.lan/Users/benediktkrebs/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /Network/Servers/pluto.kayoom.lan/Users/benediktkrebs/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /Network/Servers/pluto.kayoom.lan/Users/benediktkrebs/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n"},{"tags":["ruby","string","tree"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13168698,"title":"concatAll on a Ruby tree","body":"<p>I have two classes Leaf &amp; BinaryNode \n  Leaf contains one field that is a string\n  BinaryNode contains two children of which both are either a Leaf or a BinaryNode</p>\n\n<p>I am trying to write a concatAll method that will return a string of all the words in the tree from left to right...</p>\n\n<p>The following is what I have so far, but it is only returning the last string it finds not the  whole string that has been built... how come?</p>\n\n<pre><code>def concatAll\n final = \"\"\n\n if @lchild.respond_to?('string')   \n   final += @lchild.to_s\n else\n   @lchild.concatAll unless @lchild.nil?\n end\n\n if @rchild.respond_to?('string')   \n   final +=  @rchild.to_s\n else\n   @rchild.concatAll unless @rchild.nil?\n end\nend\n</code></pre>\n"},{"tags":["ruby","hash","constructor","initialization"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":775,"score":5,"question_id":1572660,"title":"Is there a way to initialize an object through a hash?","body":"<p>If I have this class:</p>\n\n<pre><code>class A\n  attr_accessor :b,:c,:d\nend\n</code></pre>\n\n<p>and this code:</p>\n\n<pre><code>a = A.new\nh = {\"b\"=&gt;10,\"c\"=&gt;20,\"d\"=&gt;30}\n</code></pre>\n\n<p>is it possible to initialize the object directly from the hash, without me needing to go over each pair and call <code>instance_variable_set</code>? Something like:</p>\n\n<pre><code>a = A.new(h)\n</code></pre>\n\n<p>which should cause each instance variable to be initialized to the one that has the same name in the hash.</p>\n"},{"tags":["ruby","metaprogramming"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13168009,"title":"Ruby define_method","body":"<p>I have the following test which I must pass:</p>\n\n<pre><code>def test_can_find_by_arbitrary_fields\n  assert @library.respond_to? :find_by_artist\n  assert !@library.respond_to?(:find_by_bitrate)\n  @library.add_song({ :artist =&gt; 'Green Day',\n                     :name =&gt; 'American Idiot',\n                     :bitrate =&gt; 192 })\n  assert @library.respond_to?(:find_by_bitrate)\nend\n</code></pre>\n\n<p>and I am not sure how I can do it.</p>\n\n<p>I tried doing:</p>\n\n<pre><code>def respond_to?(method)\n     if self.public_methods.include? method\n         true\n     elsif (method == :find_by_bitrate)\n         define_method :find_by_bitrate, -&gt;(default = nrb)  { @songs.select |a| a[:bitrate] == nrb }       \n         false\n     else\n         false\nend\n</code></pre>\n\n<p>but it says \"define_method is undefined\". Are there any ways I can define the <code>find_by_bitrate</code> method?</p>\n"},{"tags":["ruby","win32ole"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13168726,"title":"how to pass a binary blob to COM object through win32ole in ruby?","body":"<p>I am trying to put together a test script in ruby that needs to send messages to an MSMQ queue.</p>\n\n<p>I am able to create and send MSMQ messages via win32ole, however the body of the message needs to be a specific sequence of bytes, and I have found that the message that arrives has a null byte appended after each byte I set in the body.</p>\n\n<p>I suspect this is because my input data is being treated as an 8-bit ASCII string and is somehow being converted to unicode.</p>\n\n<p>Is there a way to tell win32ole to treat a string as a binary blob to which no conversion should be applied?</p>\n\n<p>Here is a simple script showing the problem:</p>\n\n<pre><code>FORMAT_NAME='DIRECT=OS:.\\private$\\test'\n\nMQ_NO_TRANSACTION=0\nMQ_SINGLE_MESSAGE=3\nMQ_SEND_ACCESS = 2\nMQ_DENY_NONE = 0\n\nrequire 'win32ole'\nmq_info = WIN32OLE.new('MSMQ.MSMQQueueInfo')\nmq_info.FormatName = FORMAT_NAME\n\ntransaction= (mq_info.IsTransactional2) ? MQ_SINGLE_MESSAGE : MQ_NO_TRANSACTION\n\nmq_message = WIN32OLE.new(\"MSMQ.MSMQMessage\")\nmq_queue = mq_info.Open(MQ_SEND_ACCESS, MQ_DENY_NONE)\n\nmq_message.Body = \"\\001\\002\\003\\666\\777\"\nmq_message.Label = \"SimpleRubyTest\"\nmq_message.Send mq_queue, transaction\n</code></pre>\n\n<p>Here is the body of the message when viewed through the MSMQ Admin console, showing a null byte (0x00) after each byte of data I set in the message body above.</p>\n\n<pre><code>01 00 02 00 03 00 B6 00 FF ......¶.ÿ\n00                         .\n</code></pre>\n\n<p>I am doing this on Windows XP, with ruby 1.9.3p194</p>\n"},{"tags":["ruby-on-rails","ruby","date"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13168342,"title":"Rails: Why, and how, does adding apparently equal values to equal dates give different results in this example?","body":"<p>I see that typing <code>100.days</code> gives me [edit: <em>seems</em> to give me] a Fixnum <code>8640000</code>:</p>\n\n<pre><code>&gt; 100.days.equal?(8640000)\n =&gt; true \n</code></pre>\n\n<p>I would have thought those two values were interchangable, until I tried this:</p>\n\n<pre><code>x = Time.now.to_date\n=&gt; Wed, 31 Oct 2012 \n&gt; [x + 100.days, x + 8640000]\n=&gt; [Fri, 08 Feb 2013, Mon, 07 May 25668] \n</code></pre>\n\n<p><strong>Why, and how, does adding apparently equal values to equal dates give different results?</strong></p>\n\n<p>The above results are from the Rails console, using Rails version 3.1.3 and Ruby version 1.9.2p320.  (I know, I should upgrade to the latest version...)</p>\n"},{"tags":["ruby-on-rails","ruby","model"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13168644,"title":"NoMethodError when using .where (eager fetching)","body":"<p>I have the following model classes...</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n  attr_accessible :description, :title\n  has_many :imageTags\n  has_many :tags, :through =&gt; :imageTags\nend\n\nclass Tag &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :imageTags\n  has_many :images, :through =&gt; :imageTags\nend\n\nclass ImageTag &lt; ActiveRecord::Base\n  attr_accessible :position\n  belongs_to :image\n  belongs_to :tag\nend\n</code></pre>\n\n<p>And when I use <code>find</code> for getting the Tag with the id 1 </p>\n\n<pre><code>t = Tag.find(1);\n@images = t.images;\n</code></pre>\n\n<p>But when I do the same with <code>where</code>, I get a <code>NoMethodError</code>, with the description <code>undefined method 'images'</code>:</p>\n\n<pre><code>t = Tag.where(:name =&gt; \"foo\");\n@images = t.images;\n</code></pre>\n\n<p>I also tried adding <code>.includes(:images)</code> before the <code>.where</code> statement, but that doesn't work too. <strong>So, how can I get all <code>Images</code> that belong to a <code>Tag</code>?</strong></p>\n"},{"tags":["ruby-on-rails","ruby","string"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":13149461,"title":"converting boolean values to string","body":"<p>Im trying to standardize data stored in my database. In the sense that I want everything stored as strings. Whats the best way to convert all datatypes into strings in rails?</p>\n\n<p>So if I have something like this in my database:</p>\n\n<pre><code> t.funny = no #(boolean)\n</code></pre>\n\n<p>if Im converting hundreds of these to strings in a loop, whats the best way to do this?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":3,"view_count":65,"score":0,"question_id":13165426,"title":"Using \"unless\" instead of \"if !\" in ruby","body":"<p>From what I understand using <code>unless</code> is more intuitive then using <code>if !</code> in ruby. </p>\n\n<p>But what makes <code>unless</code> more intuitive, when <code>if !</code> is technically less code?</p>\n\n<p>For Example:</p>\n\n<pre><code>if ! project.empty?\n  puts \"Project List:\"\nend\n</code></pre>\n\n<p>using <code>unless</code> evaluates the same.</p>\n\n<pre><code>unless project.empty?\n  puts \"Project List:\"\nend\n</code></pre>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":1,"up_vote_count":14,"down_vote_count":0,"view_count":7637,"score":14,"question_id":1085218,"title":"How to check if a given directory exists in Ruby","body":"<p>I am trying to write a script which automatically checks out or updates a subverion url based on whether a specified directory exists or not, but from some reason, my code isnt working and always returns 'true' even if its false.</p>\n\n<p>The code:</p>\n\n<pre><code>def directory_exists?(directory)\n  return false if Dir[directory] == nil\n  true\nend\n</code></pre>\n\n<p>Can someone help me?  What am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","form-helpers","select-tag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13166677,"title":"How to have a default select value that is NOT an option in drop down, using Ruby form select helper method","body":"<p>Ok so I am working on a project that was outsourced and now I get to jump in and fix everything before it gets pushed to production. I am currently trying to modify a line that creates a select form field. I read up on some of the different form helper methods to use in ruby, and over some of the available options for the method.</p>\n\n<p>My problem is I can't seem to figure out how to get a default value to be displayed inside the select element without having it show up in the drop down options. This is what the line currently looks like.</p>\n\n<pre><code>&lt;%= select :profile, :sexual_interest, SEXUAL_INTEREST_ARRAY, {:prompt =&gt; 'sexuality'}, {:class =&gt; 'selectFull'} %&gt;\n</code></pre>\n\n<p>I tried changing some of the options using :default => 'sexuality' and then tried :disabled => 'sexuality'. But I seem to only be able to remove the option entirely from the select element or have it as the first value in the drop down list and being displayed as the default value.</p>\n\n<p>If you are just having issues setting the default value of your select field using a ruby form helper, reference this post <a href=\"http://stackoverflow.com/questions/623458/rails-select-helper-default-selected-value-how\">selecting a default for option field</a></p>\n\n<p>If any one could give me some insight as to how to fix this issue I would greatly appreciate it. Any ideas would help, Thanks for reading.</p>\n\n<p>-Alan</p>\n"},{"tags":["mysql","ruby","ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13167743,"title":"Safe querying by find, sql, or where","body":"<p>I want to find all widgets with their common or internal names in a certain list <code>query_list</code>. I can do</p>\n\n<pre><code># Consider query_list = [\"a\",\"b\",\"c\"]\nqlist = '(' + query_list.join(\",\") + ')'\n# this makes \nwidgets = Widget.find_by_sql(\"SELECT * FROM widgets \n     WHERE common_name IN #{qlist} OR internal_name IN #{qlist}\")\n</code></pre>\n\n<p>Now I have a few questions:</p>\n\n<ol>\n<li>Is the above find_by_sql safe regarding SQL injection attacks? It seems like one could put in something dangerous in <code>query_list</code>.\n<ul>\n<li>How about writing <code>.find_by_sql([\"SELECT * FROM widgets\n     WHERE common_name IN ? OR internal_name IN ?\", [\"a\",\"b\",\"c\"], [\"a\",\"b\",\"c\"] ])</code></li>\n<li>If it isn't safe, can we make it safe?</li>\n</ul></li>\n<li>I prefer not to write raw sql if I don't have to. I know we can write <code>AND</code> conditions in <code>find</code>, as in <code>.find(:conditions=&gt;{:internal_name =&gt; ['a','b','c'], :common_name =&gt; ['a','b','c']})</code>. Can we also write <code>OR</code> conditions using find?</li>\n<li>How about using <code>where</code>? How is this different from using <code>find</code>?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13165588,"title":"Rails polymorphic views and actions based on STI type","body":"<p>This seems to be a similar question, but the answer may be different two years down the line: <a href=\"http://stackoverflow.com/questions/3542928/rails-way-to-render-different-actions-views-based-on-user-type\">Rails way to render different actions &amp; views based on user type?</a></p>\n\n<p>I have an STI model that can have many types. Often, but not always, the views will be different depending on the type. Equally the controller actions may differ in logic depending on the type. I want to avoid the high maintenance cost of having to change if/elsif conditionals based on the type.</p>\n\n<p>I can think of several ways that I could write some helper functions/modules to make this easier, but wonder if any gems built for this purpose already exist.</p>\n\n<p>Your thoughts appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","tdd","activesupport"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13167373,"title":"What should I do to make this rails app testable?","body":"<p>I have an up to date rails application, using rails 3.2 with mongoid 2. I was unable to start testing by typing rake. The exception thrown is (sanitized):</p>\n\n<pre><code>rake test                                                                                                                         \n/railsapp/app/models/image.rb:18:in `&lt;class:Image&gt;': undefined method `[]' for nil:NilClass (NoMethodError)\n    from /railsapp/app/models/image.rb:1:in `&lt;top (required)&gt;'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:359:in `require_or_load'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313:in `depend_on'\n    from /gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225:in `require_dependency'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:438:in `each'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:438:in `block in eager_load!'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:436:in `each'\n    from /gems/railties-3.2.8/lib/rails/engine.rb:436:in `eager_load!'\n    from /gems/railties-3.2.8/lib/rails/application/finisher.rb:53:in `block in &lt;module:Finisher&gt;'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n    from /gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n    from /gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n    from /gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /railsapp/config/environment.rb:7:in `&lt;top (required)&gt;'\n    from /railsapp/test/test_helper.rb:2:in `require'\n    from /railsapp/test/test_helper.rb:2:in `&lt;top (required)&gt;'\n    from /railsapp/test/unit/post_test.rb:1:in `require'\n    from /railsapp/test/unit/post_test.rb:1:in `&lt;top (required)&gt;'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10:in `require'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10:in `block (2 levels) in &lt;main&gt;'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `each'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `block in &lt;main&gt;'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `select'\n    from /gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `&lt;main&gt;'\nErrors running test:units! #&lt;RuntimeError: Command failed with status (1): [/Users/janlimpens/.rvm/rubies/ruby-1.9.3-p...]&gt;\n</code></pre>\n\n<p>I created a gist with the files that are of interest in the context:\n<a href=\"https://gist.github.com/3989760\" rel=\"nofollow\">https://gist.github.com/3989760</a></p>\n\n<p>There is no test concerning the image model at all, there are no fixtures and the only test I have got is included into the gist, but it is not to blame, the error is thrown upon including test_helper.rb.</p>\n\n<p>What are my options?</p>\n"},{"tags":["ruby","rspec","capybara","acceptance-testing"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13166980,"title":"Configure RSpec to use the Capybara.javascript_driver for all request specs","body":"<p>Is it possible globally configure RSpec to use Capybara's (default or custom) JavaScript driver for all request specs? We sometimes forget to manually add <code>js: true</code> to every request spec and it's kind of annoying.</p>\n"},{"tags":["ruby","django","inheritance","jekyll","liquid"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":13086569,"title":"Jekyll templates using django-like liquid blocks / inheritance","body":"<p>I'm getting into Jekyll in a big way and would like to use it as a general front-end development platform, but am running up against the limitations of the Liquid templating language, specifically its difference to Django templating.</p>\n\n<p>I discovered the liquid-inheritance gem, which adds the all-important Extends and Block syntax from Django. This blog post extends the gem further to suit Jekyll's file system:\n<a href=\"http://www.sameratiani.com/2011/10/22/get-jekyll-working-with-liquid-inheritance.html\" rel=\"nofollow\">http://www.sameratiani.com/2011/10/22/get-jekyll-working-with-liquid-inheritance.html</a></p>\n\n<p>The problem is that it doesn't appear to implement blocks in exactly the same way Django does, which essentially renders the gem useless.</p>\n\n<p>I have two jekyll \"layouts\" called - for the sake of understanding - parent.html and child.html. Neither of these contain YAML sections.</p>\n\n<p>Parent</p>\n\n<pre><code>&lt;html&gt;\n{% block foo %} {% endblock %}\n&lt;/html&gt;\n</code></pre>\n\n<p>Child</p>\n\n<pre><code>{% extends _layouts/parent.html %}\n{% block foo %}\n  &lt;div&gt;\n    Bar comes next:\n    {% block bar %} {% endblock %}\n  &lt;/div&gt;\n{% endblock %}\n</code></pre>\n\n<p>And then I have a jekyll page which includes a YAML section thus:</p>\n\n<pre><code>---\ntitle: test\n---\n\n{% extends _layouts/child.html %}\n{% block bar %}My title is {{ page.title }} {% endblock %}\n</code></pre>\n\n<p>What I'd expect:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;div&gt;\n    Bar comes next:\n    My title is test\n  &lt;/div&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>What I get:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;div&gt;\n    Bar comes next:\n  &lt;/div&gt;\n&lt;/html&gt;My title is test\n</code></pre>\n\n<p>It seems something is failing to treat the blocks in mypage.html as being eligible for insertion into the suitable places of parent/child, although it's clearly still doing something.</p>\n\n<p>I'm not a ruby developer and am reasonably new to Jekyll, so I need help identifying what part of this stack is failing. The liquid-inheritance issues on github suggest others are experiencing this block nesting problem: <a href=\"https://github.com/danwrong/liquid-inheritance/issues/3\" rel=\"nofollow\">https://github.com/danwrong/liquid-inheritance/issues/3</a></p>\n\n<p>I've tried several of the forks of liquid-inheritance, many of which apparently fix that problem regex, but none seem to solve this.</p>\n\n<p>Is what i'm tring to do fundamentally impossible? It seems like I'm at least 85% of the way there and the final bit needs fixing.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13165668,"title":"Discrepancies in function calls in ruby server and ruby console?","body":"<p>New to ruby, trying to figure out how to debug this problem - I've been working on a search method, and the search call returns correctly on the server, but not the console.</p>\n\n<pre><code>Item.where() { has_keyword \"phone\" }\n</code></pre>\n\n<p>returns [] on the server, returns a list with 15 objects on the console. What kinds of differences exist between the server and console? Where should I start looking?</p>\n"},{"tags":["ruby-on-rails","ruby","mvc","design"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13166587,"title":"How to have different controllers/actions for one view","body":"<p>What is the best method to have one single view (I have one html page with different sections () sort of like mini pages on one page) and have different sections call different controllers and actions through that one view?\nBecause in layouts only one &lt;%= yield %> is acceptable?</p>\n"},{"tags":["ruby","regex","gsub"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":49,"score":5,"question_id":13166112,"title":"ruby regexp to replace equations","body":"<p>I have a some HTML text in mathjax format:</p>\n\n<pre><code>text = \"an inline \\\\( f(x) = \\frac{a}{b} \\\\) equation, a display equation \\\\[ F = m a \\\\] \\n and another inline \\\\(y = x\\\\)\"\n</code></pre>\n\n<p>(Note: equations are delimited by single slashes, e.g. <code>\\(</code>, not <code>\\\\(</code>, the extra <code>\\</code> is just escaping the first one for ruby text).  </p>\n\n<p>I want to get the output that substitutes this into, say an image created by latex.codecogs, e.g. </p>\n\n<pre><code>desired_output = \"an inline &lt;img src=\"http://latex.codecogs.com/png.latex?f(x) = \\frac{a}{b}\\inline\"/&gt; equation, a display equation &lt;img src=\"http://latex.codecogs.com/png.latex?F = m a\"/&gt; \\n and another inline &lt;img src=\"http://latex.codecogs.com/png.latex?y = x\\inline\"/&gt; \"\n</code></pre>\n\n<p>Using Ruby.  I try:  </p>\n\n<pre><code>desired = text.gsub(\"(\\\\[)(.*?)(\\\\])\", \"&lt;img src=\\\"http://latex.codecogs.com/png.latex?\\2\\\" /&gt;\") \ndesired = desired.gsub(\"(\\\\()(.*?)(\\\\))\", \"&lt;img src=\\\"http://latex.codecogs.com/png.latex?\\2\\\\inline\\\")\ndesired\n</code></pre>\n\n<p>But this is unsuccessful, returning only the original input.  What did I miss?  How do I construct this query appropriately?  </p>\n"},{"tags":["ruby","ruby-1.9","fixnum"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13166312,"title":"Nil can't be coerced into Fixnum","body":"<p>I have the following function:</p>\n\n<pre><code>def valid_credit_card?(number)\n    digits = number.scan(/./).map(&amp;:to_i)\n    check = digits.pop\n\n    sum = digits.reverse.each_slice(2).map do |x, y|\n        [(x * 2).divmod(10), y]\n    end.flatten.inject(:+)\n\n    (10 - sum % 10) == check\nend\n</code></pre>\n\n<p>But for some reason I keep getting the following error message:\n<code>nil can't be coerced into Fixnum</code></p>\n\n<p>And for some reason I can't figure out why the error is being thrown. Any ideas why this might be happening?</p>\n"},{"tags":["ruby","data","finance"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13150474,"title":"Is there a good Ruby gem to fetch financial data from public companies?","body":"<p>I've search Google for ruby gems that fetches historical financial data but all of them are outdate. </p>\n\n<p>Is there a good gem that does that?</p>\n\n<p>Cheers.</p>\n"},{"tags":["php","ruby","g-wan"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":13103641,"title":"How to run PHP or ruby scripts using g-wan?","body":"<p>I have php5-cli and ruby installed but both don't work !</p>\n\n<p>In the log I have\n* bug in new /home/olivier/gwan/0.0.0.0_8080/#0.0.0.0/csp/php.php</p>\n\n<p>Where php.php is a simple :</p>\n\n<pre><code>&lt;?php\n  echo \"Hello World\";\n?&gt;\n</code></pre>\n\n<p>In gwan.log, I don't see anything about loading my php script !?</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby","scope","sinatra","settings"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13161219,"title":"Sinatra settings lost in class scope","body":"<p>For a Sinatra application config.ru invokes \"run\" in the following class:</p>\n\n<pre><code>class My_init &lt; Sinatra::Base\n    # Define all environments available in our app\n\n    # Set the applications root directory\n\n    # Define Root Path\n\n    # Require all files in the App directory\n\n    # Load database configuration\n\n    require './config/database'\n\n    ActiveRecord::Base.establish_connection(\n      :adapter  =&gt; \"mysql2\",\n      :host     =&gt; settings.db_host,\n      :database =&gt; settings.db_name,\n      :username =&gt; settings.db_username,\n      :password =&gt; settings.db_password\n    )\nend\n</code></pre>\n\n<p>For some reason, the settings load from ./config/database are not accessible from this scope. If I print the settings from the configuration file itself like \"p settings.db_host\" everything is ok, however, inside this class, settings.db_host is unknown.</p>\n\n<p>Does someone know what is happening?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby","regex","irb"],"answer_count":0,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":64,"score":4,"question_id":13161903,"title":"Regular expression \"empty range in char class error\"","body":"<p>I got a regex in my code, which is to match pattern of url and threw error:</p>\n\n<pre><code>/^(http|https):\\/\\/([\\w-]+\\.)+[\\w-]+([\\w- .\\/?%&amp;=]*)?$/\n</code></pre>\n\n<p>The error was \"empty range in char class error\". I found the cause of that is in <code>([\\w- .\\/?%&amp;=]*)?</code> part. Ruby seems to recognize <code>-</code> in <code>\\w- .</code> as an operator for range instead of a literal <code>-</code>. After adding escape to the dash, the problem was solved.</p>\n\n<p>But the original regular expression ran well on my co-workers' machines. We use the same version of osx, rails and ruby: Ruby version is ruby 1.9.3p194, rails is 3.1.6 and osx is 10.7.5. And after we deployed code to our Heroku server, everything worked fine too. Why did only my environment have error regarding this regex? What is the mechanism of Ruby regex interpreting?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13162607,"title":"Does `Object.const_get` work with strings? I get a \"wrong constant name\" Error","body":"<p>I have a dynamically generated nested namespace like this:</p>\n\n<pre><code>class A\n  class B\n    class C\n      ...\n    end\n  end\nend\n</code></pre>\n\n<p>I can access class <code>C</code> manually by <code>A::B::C</code>, so it exists, so my generator works. However <code>Object.const_get \"A::B::C\"</code> raises a \"wrong constant name\" error. Can I somehow access it dynamically without cumbersome loops?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","amazon-s3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13149240,"title":"Ruby aws-sdk - timeout error","body":"<p>I am trying to upload a file to S3 with the following simple code:</p>\n\n<pre><code>bucket.objects.create(\"sitemaps/event/#{file_name}\", open(file))\n</code></pre>\n\n<p>I get the following:</p>\n\n<p><strong>Your socket connection to the server was not read from or written to within the timeout period. Idle connections will be closed.</strong></p>\n\n<p>What could be going wrong?  Any tips will be appreciated.</p>\n"},{"tags":["ruby","dsl"],"answer_count":5,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":5691,"score":13,"question_id":899665,"title":"Ruby DSL (Domain Specific Language) repositories, examples","body":"<p>I am seeking excellent examples of Ruby DSLs (Domain Specific Languages).  Which repositories, projects do you know of that are worth a read?  Why is it (or: are they) great examples?</p>\n\n<p>I am particularly interested in more complex examples that are well thought-out and designed.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13119188,"title":"require 'debugger' => LoadError. Why?","body":"<p><strong>Context</strong></p>\n\n<pre><code>ruby 1.9.2p323 (2012-05-22 revision 35755) [x86_64-darwin11.4.0]\n\nrvm 1.16.6\n\ngemsets for ruby-1.9.2-head \n   (default)\n   global\n=&gt; rails321\n</code></pre>\n\n<hr>\n\n<p><strong>Trace</strong></p>\n\n<pre><code>$ gem install 'debugger'\nBuilding native extensions.  This could take a while...\nSuccessfully installed debugger-1.2.1\n\n$ bundle show debugger\n/Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1\n\n$ irb\n&gt; require 'debugger'\nLoadError: no such file to load -- trace_nums\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-linecache-1.1.2/lib/tracelines19.rb:3:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-linecache-1.1.2/lib/linecache19.rb:65:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1/lib/ruby-debug-base.rb:2:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1/lib/ruby-debug.rb:5:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/PH/.rvm/gems/ruby-1.9.2-head@rails321/gems/debugger-1.2.1/lib/debugger.rb:4:in `&lt;top (required)&gt;'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:in `rescue in require'\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:in `require'\n    from (irb):1\n    from /Users/PH/.rvm/rubies/ruby-1.9.2-head/bin/irb:16:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby","query","mongodb","mongoid3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13163897,"title":"How to find all and sort by count?","body":"<p>How to build a query that returns all entities sorted desc by count embedded post ids?</p>\n\n<p>Sample data:</p>\n\n<pre><code>{ \"_id\" : ObjectId( \"5090f8061e7bf28095000012\" ),\n  \"name\" : \"test\",\n  \"post_ids\" : \n    [ ObjectId( \"5090f8061e7bf28095000010\" ) ],\n    [ ObjectId( \"5090f8061e7bf28095000011\" ) ] },\n{ \"_id\" : ObjectId( \"5090f8061e7bf28095000012\" ),\n  \"name\" : \"test2\",\n  \"post_ids\" : [ \n    ObjectId( \"5090f8061e7bf28095000010\" ), \n    ObjectId( \"509104ec1e7bf2989b00000b\" ), \n    ObjectId( \"509105001e7bf2989b00000f\" ) ] }\n\n#my actual query returns only count:\ntags_by_count = Tag.desc(:post_ids).count\n</code></pre>\n"},{"tags":["ruby","xml","digital-signature","canonical","digest"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":67,"score":4,"question_id":13126977,"title":"How to do xml signing in ruby","body":"<p>I need sign xml with ruby, someone know any method or lib for that?</p>\n\n<p>My xml skeleton is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\n&lt;Message&gt;\n    &lt;MessageId&gt; \n        &lt;ServiceId&gt;service&lt;/ServiceId&gt; \n        &lt;Version&gt;1.0&lt;/Version&gt; \n        &lt;MsgDesc&gt;Service Description&lt;/MsgDesc&gt; \n        &lt;Code&gt;4&lt;/Code&gt; \n        &lt;FromAddress&gt;from&lt;/FromAddress&gt; \n        &lt;ToAddress&gt;to&lt;/ToAddress&gt; \n        &lt;Date&gt;2012-10-29&lt;/Date&gt; \n    &lt;/MessageId&gt; \n    &lt;MessageBody/&gt; \n\n&lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n  &lt;SignedInfo&gt;\n    &lt;CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/&gt;\n    &lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;\n    &lt;Reference URI=\"\"&gt;\n    &lt;Transforms&gt;\n      &lt;Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/&gt;\n    &lt;/Transforms&gt;\n    &lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;\n    &lt;DigestValue&gt;??????&lt;/DigestValue&gt;\n    &lt;/Reference&gt;\n  &lt;/SignedInfo&gt;\n\n  &lt;SignatureValue&gt;????????????&lt;/SignatureValue&gt;\n  &lt;KeyInfo&gt;\n    &lt;X509Data&gt;\n      &lt;X509Certificate&gt;????????&lt;/X509Certificate&gt;\n    &lt;/X509Data&gt;\n  &lt;/KeyInfo&gt;\n&lt;/Signature&gt;\n&lt;/message&gt;\n</code></pre>\n\n<p>I tried this code for DigestValue and I have tested comparing with my java example, \nbut DigestValue is not matching with response of my java example:</p>\n\n<pre><code>require 'base64'\nrequire 'openssl'\n\nto_sign_xml = File.read 'service.xml'\ndigest = OpenSSL::Digest::SHA1.digest(to_sign_xml)\n\ndigest = Base64.encode64(digest.to_s).gsub(/\\n/, '')\nraise digest.inspect\n</code></pre>\n\n<p>My file service.xml contain that:</p>\n\n<pre><code>&lt;Message&gt;\n    &lt;MessageId&gt; \n        &lt;ServiceId&gt;service&lt;/ServiceId&gt; \n        &lt;Version&gt;1.0&lt;/Version&gt; \n        &lt;MsgDesc&gt;Service Description&lt;/MsgDesc&gt; \n        &lt;Code&gt;4&lt;/Code&gt; \n        &lt;FromAddress&gt;from&lt;/FromAddress&gt; \n        &lt;ToAddress&gt;to&lt;/ToAddress&gt; \n        &lt;Date&gt;2012-10-29&lt;/Date&gt; \n    &lt;/MessageId&gt; \n    &lt;MessageBody/&gt;\n&lt;Message&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","rspec","spork","guard"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":227,"score":1,"question_id":10675295,"title":"Rails engine test/dummy with Spork, Guard, RSpec?","body":"<p>I have a Rails gem that I am testing with RSpec.\nMy gem's code is in lib/my_gem, and there is a test application that Rails generated for me when I created the gem, in the folder test/dummy. I have my specs in test/dummy/spec/models/task_spec.rb. I can run these specs fine with the rspec command.</p>\n\n<p>Now I wanted to use Spork and Guard for my testing. I followed RailsCasts <a href=\"http://railscasts.com/episodes/285-spork\" rel=\"nofollow\">http://railscasts.com/episodes/285-spork</a> to install spork in my test/dummy app. It does work but I have 2 issues:</p>\n\n<ul>\n<li>How to make spork reload my lib/my_gem/* files? I tried putting paths like ../../lib/my_gem/... in my Guardfile, but it does not watch/reload the files.</li>\n<li>For some reason, rspec is ignoring my options from spec_helper, for example the \"config.filter_run :focus => true\" line. I did properly put these into Spork.prefork. This setting is working when I run rspec manually with rspec spec/models/task_spec.rb, but it is being ignored when I use guard/spork.</li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","refactoring"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13146445,"title":"How to refactor complex method in Rails model with Rspec?","body":"<p>I have the following complex method. I'm trying to find and implement possible improvements. Right now I moved last if statement to <code>Access</code> class.</p>\n\n<pre><code>def add_access(access)\n   if access.instance_of?(Access)\n     up = UserAccess.find(:first, :conditions =&gt; ['user_id = ? AND access_id = ?', self.id, access.id])\n     if !up &amp;&amp; company\n       users = company.users.map{|u| u.id unless u.blank?}.compact\n       num_p = UserAccess.count(:conditions =&gt; ['user_id IN (?) AND access_id = ?', users, access.id])\n       if num_p &lt; access.limit\n         UserAccess.create(:user =&gt; self, :access =&gt; access)\n       else\n         return \"You have exceeded the maximum number of alotted permissions\"\n       end\n     end\n   end\n end\n</code></pre>\n\n<p>I would like to add also specs before refactoring. I added first one. How should looks like others?</p>\n\n<pre><code>  describe \"#add_permission\" do\n    before do\n      @permission = create(:permission)\n      @user = create(:user)\n    end\n\n    it \"allow create UserPermission\" do\n      expect {\n        @user.add_permission(@permission)\n      }.to change {\n        UserPermission.count\n      }.by(1)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","view","popup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13163064,"title":"Ruby on Rails: Alert button on submit press","body":"<p>I have a function where a user can reset their own password by entering their registered email and clicking a button. An email then gets sent to that address.</p>\n\n<pre><code>&lt;div class =\"title\"&gt;Reset your password&lt;/div&gt;\n\n\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; password_path(resource_name), :html =&gt; { :method =&gt; :post }) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n&lt;div class=\"signup\"&gt;\n  &lt;div class = \"field\"&gt;Email: \n  &lt;%= f.email_field :email, :class =&gt; \"email\" %&gt;&lt;/div&gt;\n\n&lt;/br&gt;\n\n  &lt;div&gt;&lt;%= f.submit \"Send me reset password instructions\", :class =&gt; \"button\", :confirm =&gt; \"An email to reset your password has been sent\" %&gt;&lt;/div&gt;\n&lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>I am wanting a pop up box to show up after they hit the submit button. I have a confirm pop up at the moment, but I am just wanting an alert popup, where the user only has the option to click \"OK\". Can this be done?</p>\n\n<p>I am new to rails, so please remember this when trying to help. Thanks in advance.</p>\n"},{"tags":["ruby","ruby-on-rails-3","routes","ip","firewall"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":9934545,"title":"Different Rails route if IP not in list?","body":"<p>I have a Rails 3.2.2 application which is a simple company intranet, however although there isn't any private information on there it's probably best if it was fairly secure from the outside world. </p>\n\n<p>We do however have people working from home on fairly regular occasions that don't have a VPN setup. </p>\n\n<p>Currently I have a firewall rule that blocks everyone except a list of our teams/branches static IP addresses. The problem with this is when a team member visits the site from home the site never loads because the firewall rejects them. What I would like to do is serve a simple page within the application explaining why they don't have \"full\" access. </p>\n\n<p>The firewall is serving multiple applications, so I can't put the access denied page on there </p>\n\n<p>I have read a few questions on SO such as <a href=\"http://stackoverflow.com/questions/3887943/ip-address-in-rails\">IP address in rails</a> which show how to get their IP address, but I'm unsure how to alter a default route based on that. </p>\n"},{"tags":["ruby-on-rails","ruby","sorting","filter"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":299,"score":0,"question_id":10952449,"title":"Filtering and sorting a rails app","body":"<p>I currently have a deployed app (fortworth.herokuapp.com) that I am attempting to sort movies by titles and release dates as well as filter by ratings.</p>\n\n<p>I solved the problem of being able to filter (click the checkboxes then hit refresh - the page starts out empty). However, I also want to sort these movies. Right now when you click on 'Title' or 'Release Date' all of the movies disappear. </p>\n\n<p>In <code>movies_controller#index</code> I believe I should set up the <code>session[]</code> hash to remember the settings. My <code>link_to</code> methods for the title and release dates are as follows: </p>\n\n<pre><code>link_to title, {:sort =&gt; column}\n</code></pre>\n\n<p>How do I go about implementing the session[] hash in order to remember the movies that were selected before I sort?</p>\n"},{"tags":["mysql","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13162968,"title":"Installed mysql gem file and received error 'wrong number of arguments (4 for 0) (ArgumentError)'","body":"<p>I am trying to run the following ruby program</p>\n\n<pre><code>require 'rubygems'\nrequire 'mysql'\ndb = Mysql.new('local','root','','')\nst_qry = db.query(\"SELECT * FROM `notification` ORDER BY notification_id DESC \")\nputs (\"There were #{st_qry.num_rows} rows returned.\")\n</code></pre>\n\n<p>When I execute this code through terminal I get the following error message:</p>\n\n<pre><code>joe.fleck$ ruby mysql_req.rb \nmysql_req.rb:4:in `initialize': wrong number of arguments (4 for 0) (ArgumentError)\nfrom mysql_req.rb:4:in `new'\nfrom mysql_req.rb:4\n</code></pre>\n\n<p>I have no idea how to fix this.  I had to install mysql by this command:</p>\n\n<pre><code>sudo env ARCHFLAGS=\"-arch x86_64\" gem install mysql -- \\\n--with-mysql-dir=/usr/local/mysql --with-mysql-lib=/usr/local/mysql/lib \\\n--with-mysql-include=/usr/local/mysql/include\n</code></pre>\n\n<p>because the ordinary command (sudo gem install mysql) would error and not install.</p>\n\n<p>I have also tried uninstall and install mysql.  I tried mysql2 and it errors out when I try to execute the program.</p>\n\n<p>Does anyone know how to solve this?</p>\n\n<p>MacBook Pro, OS X version 10.8.2</p>\n\n<pre><code>$ gem list\n*** LOCAL GEMS ***\naddressable (2.3.2)\nbuilder (3.1.3)\nchildprocess (0.3.5)\ncucumber (1.2.1)\ndiff-lcs (1.1.3)\nfastercsv (1.5.5)\nffi (1.1.5)\ngherkin (2.11.3)\njson (1.7.5)\nlibwebsocket (0.1.5)\nmulti_json (1.3.6)\nmysql (2.8.1)\npkg-config (1.1.4)\nrb-appscript (0.6.1)\nrubygems-update (1.8.24)\nrubyzip (0.9.9)\nsafariwatir (0.4.0)\nselenium-webdriver (2.25.0)\nshoes (3.0.1)\nwatir-webdriver (0.6.1)\n</code></pre>\n"},{"tags":["ruby","https","proxy","man-in-the-middle"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":505,"score":4,"question_id":8129260,"title":"Man in the Middle (MITM) proxy with HTTPS support","body":"<p>We seem to be going round in circles a bit at the moment. We are looking for simple light weight, preferably ruby based proxy that enables us to do the following.</p>\n\n<ul>\n<li>Proxy HTTPS requests between a browser and a Web app. e.g. GMail</li>\n<li>Intercept and modify the request/responses - Man in the Middle modification</li>\n<li>Generate on the fly SSL certs (or maybe us pre-configured) for use between the proxy and the browser</li>\n</ul>\n\n<p>Using Ruby, we've experimented with <a href=\"https://github.com/igrigorik/em-proxy\" rel=\"nofollow\">em-proxy</a> and <a href=\"http://postrank-labs.github.com/goliath/\" rel=\"nofollow\">Goliath</a> but I don't think these are quite the right fit.</p>\n\n<p>Any suggestions would be very much appreciated.</p>\n\n<p>Best Regards,</p>\n\n<p>Carlskii.</p>\n"},{"tags":["ruby","destructor","instantiation"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13162283,"title":"Is there a way to destroy *self* after a class is instantiated?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/156248/notification-of-object-destruction-in-ruby\">Notification of object destruction in Ruby</a><br>\n  <a href=\"http://stackoverflow.com/questions/5956067/ruby-destructors\">Ruby: Destructors?</a>  </p>\n</blockquote>\n\n\n\n<p><em>#initialize</em> starts functions when a class is instantiated. Just wondering if there's an <em>#uninitialize</em> function. For example:</p>\n\n<pre><code>class Something\n  def initialize\n    @browser = Watir::Browser.new :chrome #opens browser\n  end\n\n  def stuff(url)\n    @browser.goto url\n  end\n\n  def uninitalize\n    @browser.quit #close browser\n  end\nend\n\ns = Something.new\ns.stuff(\"google.ca\")\n</code></pre>\n\n<p>In this case, the browser will be opened by the initialize function. Is there a way to automatically quit it?</p>\n"},{"tags":["ruby","phusion-passenger","ruby-1.9.3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13161133,"title":"ruby 1.9 3 with passenger 3.0.12 No such file or directory - /tmp/RackRewindableInput20121031-8340-1qko694.lock","body":"<p>i think ruby 1.9.3 is unable to create tempfile in /tmp directory. Problem error message:</p>\n\n<blockquote>\n  <blockquote>\n    <p>Status: 500 Internal Server Error No such file or directory /tmp/RackRewindableInput20121031-8340-1qko694.lock<br>\n    /lib/ruby/1.9.1/tempfile.rb:346:in rmdir'<br>\n    /lib/ruby/1.9.1/tempfile.rb:346:in rmdir'<br>\n    /lib/ruby/1.9.1/tempfile.rb:338:in ensure in locking'<br>\n    /lib/ruby/1.9.1/tempfile.rb:338:in locking'<br>\n    /lib/ruby/1.9.1/tempfile.rb:144:in block in initialize'<br>\n    /lib/ruby/1.9.1/tmpdir.rb:133:in create'<br>\n    /lib/ruby/1.9.1/tempfile.rb:134:in initialize'<br>\n    /lib/ruby/gems/1.9.1/gems/passenger-3.0.12/lib/phusion_passenger/utils/rewindabl‌​e_input.rb:86:in new' </p>\n  </blockquote>\n</blockquote>\n"},{"tags":["ruby","websocket","jruby","eventmachine","em-websocket"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13161920,"title":"EventMachine and em-websocket - reading from a queue and pushing to a channel","body":"<p>I'm using eventmachine to read from a HornetQ topic, push to a Channel which is subscribed to by EM websocket connections. I need to prevent the @topic.receive loop from blocking, so have created a proc and am calling EventMachine.defer with no callback. This will run indefinitely. This works fine. I could also have just used Thread.new.</p>\n\n<p>My question is, is this the correct way to read from a stream/queue and pass the data to the channel and is there a better/any other way to do this?</p>\n\n<pre><code>require 'em-websocket'\nrequire 'torquebox-messaging'\n\nclass WebsocketServer\n\n  def initialize\n    @channel = EM::Channel.new\n\n    @topic = TorqueBox::Messaging::Topic.new('/topics/mytopic')\n  end \n\n  def start\n    EventMachine.run do\n\n      topic_to_channel = proc do\n        while true\n          msg = @topic.receive\n          @channel.push msg\n        end\n      end\n\n      EventMachine.defer(topic_to_channel)\n\n      EventMachine::WebSocket.start(:host =&gt; \"127.0.0.1\", :port =&gt; 8081, :debug =&gt; false) do |connection|\n        connection.onopen do\n\n          sid = @channel.subscribe { |msg| connection.send msg }\n\n          connection.onclose do            \n            @channel.unsubscribe(sid)\n          end\n        end\n      end                  \n    end\n  end\nend\n\nWebsocketServer.new.start\n</code></pre>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13161828,"title":"Faster / Cleaner way to split a string into path","body":"<p>i have a string like:</p>\n\n<pre><code>str = \"/some/path/to/some/file.ext\"\n</code></pre>\n\n<p>and the result should be like:</p>\n\n<pre><code>[path, dir, file]\n=&gt; [\"/some/path/to\", \"some\", \"file.ext\"]\n</code></pre>\n\n<p>my current code:</p>\n\n<pre><code>chunks = str.split '/'\n=&gt; [\"\", \"some\", \"path\", \"to\", \"some\", \"file.ext\"]\n\nfile = chunks.pop\n=&gt; \"file.ext\"\n\ndir = chunks.pop\n=&gt; \"some\"\n\npath = chunks.join '/'\n=&gt; \"/some/path/to\"\n</code></pre>\n\n<p>but it's ugly and slow.</p>\n\n<p>also tried regexes and <code>File.split</code> but got even uglier mess.</p>\n\n<p>please advise.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13161717,"title":"Do not run ruby code in render :file","body":"<p>I'm trying to render an HTML file using <code>render :file</code> in my view, but the problem is, if this .html file contains any ruby code, it'll end up being executed and that is something I'm trying to avoid.</p>\n\n<p>Is there a way to do that?</p>\n"},{"tags":["ruby-on-rails","ruby","statemachine"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13161802,"title":"get list of final state_machine states","body":"<p>There is a method in the StateMachine library <a href=\"http://stackoverflow.com/questions/4138437/get-list-of-state-machine-states\">to get the list of states</a>:</p>\n\n<pre><code>ModelName.state_machines[:name_of_state].states.map &amp;:name\n</code></pre>\n\n<p>or </p>\n\n<pre><code>ModelName.state_machines.states.map &amp;:name\n</code></pre>\n\n<p>when the name of the attribute containing state is the default \"state\".</p>\n\n<p>However, I was wondering whether there's a way to find the final statemachine, since if you draw them with </p>\n\n<pre><code>rake state_machine:draw FILE=model.rb CLASS=ModelName\n</code></pre>\n\n<p>the final states are double-circled.\nI was not able to get it from the rake task's source at first sight.</p>\n\n<p>Getting the initial states seems to be easy:</p>\n\n<pre><code>ModelName.state_machines[:name_of_state].states.select(&amp;:initial).map(&amp;:name)\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<p>Oh, drats!  It is as easy as:</p>\n\n<pre><code>ModelName.state_machines[:name_of_state].states.select(&amp;:final?).map(&amp;:name)\n</code></pre>\n\n<p>Left here for future Googlers!</p>\n"},{"tags":["ruby-on-rails","ruby","jruby","testunit","minitest"],"answer_count":0,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":13074099,"title":"Can't run Minitest/TestUnit tests in JRuby 1.7.0","body":"<p>We just switched our small project to <strong>JRuby 1.7.0</strong> and had a similar\nexperience under <strong>1.7.0.RC2</strong>. I'm trying to simply run <code>rake test</code> (as well\nas running my tests under guard) but my test files look to be never found. I\nonly get...</p>\n\n<pre><code>Loaded Suite test,test/factories,test/unit\n\nStarted at 2012-10-25 13:28:15 -0400 w/ seed 9431.\n\nFinished in 0.004000 seconds.\n\n0 tests, 0 passed, 0 failures, 0 errors, 0 skips, 0 assertions\n</code></pre>\n\n<p>Here is my <code>test/test_helper.rb</code> file.</p>\n\n<pre><code>ENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'rails/test_help'\n\nrequire 'minitest/autorun'\nrequire 'factory_girl_rails'\nrequire 'mocha'\n\nclass ActiveSupport::TestCase\n  fixtures :all\nend\n</code></pre>\n\n<p>Currently it doesn't matter what I put in my a <code>test/unit/random_test.rb</code> test\nfile. The files aren't being loaded by <code>rake</code>, so even putting invalid Ruby\nwon't result in an exception.</p>\n\n<p>Hopefully someone can point me in the right direction.</p>\n\n<p>Edit:</p>\n\n<p>The following is a trace of the <code>rake test:units</code> task being run from an app that is running tests under JRuby.</p>\n\n<pre><code>$ rake test:units --trace\nio/console not supported; tty will not be manipulated\n** Invoke test:prepare (first_time)\n** Invoke db:test:prepare (first_time)\n** Invoke db:abort_if_pending_migrations (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Invoke db:load_config (first_time)\n** Execute db:load_config\n** Execute db:abort_if_pending_migrations\n** Execute db:test:prepare\n** Invoke db:test:load (first_time)\n** Invoke db:test:purge (first_time)\n** Invoke environment \n** Invoke db:load_config \n** Execute db:test:purge\n** Execute db:test:load\n** Invoke db:test:load_schema (first_time)\n** Invoke db:test:purge \n** Execute db:test:load_schema\n** Invoke db:schema:load (first_time)\n** Invoke environment \n** Invoke db:load_config \n** Execute db:schema:load\n** Execute test:prepare\n** Execute test:units\nio/console not supported; tty will not be manipulated\nRun options: \n\n# Running tests:\n\n.\n\nFinished tests in 0.517000s, 1.9342 tests/s, 1.9342 assertions/s.\n\n1 tests, 1 assertions, 0 failures, 0 errors, 0 skips\n$ \n</code></pre>\n\n<p>For the app that's not working, I tried the same and received the following error.</p>\n\n<pre><code>rake aborted!\nDon't know how to build task 'test:units'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/task_manager.rb:49:in `[]'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:115:in `invoke_task'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\norg/jruby/RubyArray.java:1612:in `each'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/gems/rake-0.9.2.2/bin/rake:33:in `(root)'\norg/jruby/RubyKernel.java:1045:in `load'\n/Users/someone/.rvm/gems/jruby-1.7.0@global/bin/rake:1:in `(root)'\norg/jruby/RubyKernel.java:1065:in `eval'\n/Users/someone/.rvm/gems/jruby-1.7.0@rails-app/bin/ruby_noexec_wrapper:14:in `(root)'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13160324,"title":"How to stub after_create callback save! in model?","body":"<p>I receive following error:</p>\n\n<p>Output:</p>\n\n<pre><code>1) LabelsController#create label is new creates a new label\n   Failure/Error: post :create, attributes[:label], format: :json\n   NoMethodError:\n     undefined method `save!' for nil:NilClass\n   # ./app/models/labeling.rb:17:in `update_target'\n</code></pre>\n\n<p>In Labeling model:</p>\n\n<pre><code>after_create :update_target\n\ndef update_target\n   self.target.save!\nend\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>require 'spec_helper'\ndescribe LabelsController do\n  before(:each) do\n    controller.stub(:current_user).and_return(mock_model(User))\n    stub_request(:any, \"www.example.com\").to_return(status: 200)\n  end\n  describe \"#create\" do\n    context \"label is new\" do\n      it \"creates a new label\" do\n        attributes = {\n          label: {\n            name: \"test\",\n            labeling: {\n              target_type: \"Link\", target_id: 1\n            }\n          }\n        }\n        response.status.should == 200\n        post :create, attributes[:label], format: :json\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Labeling controller:</p>\n\n<pre><code>  def create\n    label = Label.find_by_name(params[:name])\n\n    labeling = label.labelings.build do |lb|\n      lb.user_id     = current_user.id\n      lb.target_type = params[:labeling][:target_type]\n      lb.target_id   = params[:labeling][:target_id]\n    end\n\n    if labeling.save\n      render json: {\n        name: label.name,\n        id: label.id,\n        labeling: {\n          id: labeling.id\n        }\n      }\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","postgresql","activerecord","rails-postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13160664,"title":"Patch ActiveRecord/postgres_ext to return upper case UUID","body":"<p>I'm using postgres_ext with Rails/ActiveRecord to be able to store UUID as the PostreSQL UUID datatype. But in my app I'm comparing uuids and would like the UUIDs returned from the models to be in uppercase instead of lowercase.</p>\n\n<p><strong>How do I patch ActiveRecord/postgres_ext to always return uppercase string representations of the UUIDs?</strong></p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13160773,"title":"When use \"find_all_by\", why use :order => :title rather than :order => title","body":"<p>In view haml file I have a link, when you click, you get all the movies sorted by title or release date. \nThe code in controller is:</p>\n\n<pre><code>def index\n    sort = params[:sort] || session[:sort]\n    case sort\n    when 'title'\n      ordering,@title_header = {:order =&gt; :title}, 'hilite'\n    when 'release_date'\n      ordering,@date_header = {:order =&gt; :release_date}, 'hilite'\n    end\n   # some more codes here\n@movies = Movie.find_all_by_rating(@selected_ratings.keys, ordering)\nend\n</code></pre>\n\n<p>if I change </p>\n\n<p><code>ordering,@title_header = {:order =&gt; :title}, 'hilite'</code><br>\nto </p>\n\n<pre><code> ordering,@title_header = {:order =&gt; title}, 'hilite'\n</code></pre>\n\n<p>It gives an error: </p>\n\n<pre><code>undefined local variable or method `title' for #&lt;MoviesController:0xb29a853c&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":70,"score":4,"question_id":13158715,"title":"Rails 3.0 with \"or\" statement in each loop","body":"<p>I am trying to build a query that compares two object, and if they have the same <code>id</code> the record is not fetched. What I have is this:</p>\n\n<pre><code>@channels.each do |channel|\n  unless @guide_channels.where(:id =&gt; channel.id).exists?\n    @dropdown_channels = @dropdown_channels.where(:id =&gt; channel.id)\n  end\nend\n</code></pre>\n\n<p>This creates the query, but puts a AND between every value which isn't what I have in mind. I want the \"or\" operator. Is there a 'orwhere' function I can use or is there a better way to do this with some compare function?</p>\n"},{"tags":["ruby","books"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":49,"score":-3,"question_id":13160265,"title":"What is the best Ruby Language book?","body":"<p>I want to learn Ruby to be a Advanced Ruby Developer and I'm thinking to buy a book.\nDo you know what's the best Ruby Language Book?</p>\n\n<p>I want a book that describe all of the language features.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","arel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":211,"score":0,"question_id":10149485,"title":"How can I build up an ActiveRecord query incrementally, line by line?","body":"<p>I'd like to piece together an ActiveRecord query using runtime data. What I have in mind is something like...</p>\n\n<pre><code>r = Person.where('last_name LIKE ?', foo)\nr.where('created_at &lt; ?', Time.now - 100.days)\nr.where( ...some other conditions... )\n</code></pre>\n\n<p>That doesn't work as intended though. To get it to work you have to chain them together all on one line...</p>\n\n<pre><code>Person.where('last_name LIKE ?', foo) \\\n  .where('created_at &lt; ?', Time.now - 100.days) \\\n  .where( ...some other conditions... )\n</code></pre>\n\n<p>I'm trying to figure out a way to spread it over separate operations on multiple lines.</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":132,"score":0,"question_id":9356240,"title":"MetaSearch Gem overrides the search method with the Tire Gem","body":"<p>I've added a fulltext searching database to my existing webapp that is built with Rails and uses the active_admin gem. The fulltext database is built on elastic search and uses the Tire gem. The active_admin gem has a dependency requirement of the metasearch gem which defines the Model.search method.</p>\n\n<p>The problem is that the metasearch gem overrides the search method for the tire search gem and I can't seem to alias the search method in the tire gem back into the model. Does anyone know how I can do this?</p>\n\n<p>-- Solution --</p>\n\n<p>Update: The solution is to setup an initializer to add the following method:</p>\n\n<pre><code>def search_for(*args,&amp;block)\n  tire.__send__(:search, *args, &amp;block)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13159660,"title":"Updating seed.rb when production is already released","body":"<p>The best solution I have right is like doing writing it like below.</p>\n\n<h2>Before release of production</h2>\n\n<p><code>\nif Category.count == 0\n  categories = Category.create([{ name: 'business' }, { name: 'sport' })\nend\n</code></p>\n\n<h2>After</h2>\n\n<pre><code>if Category.count == 0\n  categories = Category.create([{ name: 'business' }, { name: 'sport' })\nelsif Category.count == 2\n  Category.create([{ name: 'science' }])\n  categories = Category.all\nend\n</code></pre>\n\n<p>This is kinda fail since I have to write <code>[{ name: 'hoge' }]</code> everytime I add a data.\nAnd I might miss count the <code>Category.count === COUNT</code> which is in the <code>elsif</code> block.</p>\n\n<p>Any better solution?</p>\n\n<p>I think it'll be nice if its able to add/remove some value from a certain Array to update the master data.</p>\n"},{"tags":["ruby","osx-mountain-lion","homebrew","ruby-1.8.7"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":64,"score":0,"question_id":13115044,"title":"Best way to install Ruby 1.8.7 on OS X 10.8 Mountain Lion","body":"<p>I've been looking around for the best way to do this and found an easier way than to install both tcl and tk.</p>\n"},{"tags":["ruby-on-rails","ruby","amazon-s3","amazon-cloudfront","pandastream"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12879374,"title":"How to \"live stream\" video from central server to clients? In rails","body":"<p>Let's say that I have a video file on a central server and I want to stream it to my clients at a particular time. Think of this as playing a video file and then live streaming it to clients so that the clients act like cable television and cannot progress further into the file.</p>\n\n<p>I am trying to do this in Ruby on Rails which uses a service called Panda to handle the integration of rails, amazon s3 and cloudfront.</p>\n\n<p>The result is to go to a view that features a live stream, which doesn't consist of a live camera, but rather a playlist of videos stored in amazon s3.</p>\n"},{"tags":["ruby","osx","macruby","fsevents"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":38,"score":3,"question_id":13103341,"title":"FSEvents in MacRuby: wrong callback is executed","body":"<p>I'm working on GUI app in MacRuby and I need to use FSEvents. I'm registering a couple of streams for different directories. Changes in any of those directories result in running a callback, but there's a big issue: no matter which directory changes, the last registered callback is executed.</p>\n\n<p>Below is isolated test script:</p>\n\n<pre><code>framework 'Cocoa'\nframework 'CoreServices'\n\nclass Monitor\n  def initialize(dir)\n    @dir = dir\n  end\n\n  def start(&amp;block)\n    callback = Proc.new do |stream, context, count, paths, flags, ids|\n      p @dir\n      block.call\n    end\n\n    flags = KFSEventStreamCreateFlagUseCFTypes\n\n    @stream = FSEventStreamCreate(KCFAllocatorDefault, callback, nil, [@dir], KFSEventStreamEventIdSinceNow, 0.0, flags)\n    FSEventStreamScheduleWithRunLoop(@stream, CFRunLoopGetCurrent(), KCFRunLoopDefaultMode)\n    FSEventStreamStart(@stream)\n  end\nend\n\nMonitor.new(Dir.pwd + \"/dir1\").start { p \"dir1\" }\nMonitor.new(Dir.pwd + \"/dir2\").start { p \"dir2\" }\nMonitor.new(Dir.pwd + \"/dir3\").start { p \"dir3\" }\n\napp = NSApplication.sharedApplication\napp.run\n</code></pre>\n\n<p>When I run it and start modifying those directories:</p>\n\n<pre><code>~/tmp/fsevents $ touch dir1/test\n~/tmp/fsevents $ touch dir2/test\n~/tmp/fsevents $ touch dir3/test\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>\"/Users/janek/tmp/fsevents/dir3\"\n\"dir3\"\n\"/Users/janek/tmp/fsevents/dir3\"\n\"dir3\"\n\"/Users/janek/tmp/fsevents/dir3\"\n\"dir3\"\n</code></pre>\n\n<p>What I'd rather expect is:</p>\n\n<pre><code>\"/Users/janek/tmp/fsevents/dir1\"\n\"dir1\"\n\"/Users/janek/tmp/fsevents/dir2\"\n\"dir2\"\n\"/Users/janek/tmp/fsevents/dir3\"\n\"dir3\"\n</code></pre>\n\n<p>Maybe I could work around this issue by providing the data I need via context argument (because inspecting <code>paths</code> inside callback reveals directory that actually changed), but still, the current behaviour is totally unexpected to me.</p>\n\n<p>I'm using OS X 10.8.2 (12C60) and MacRuby 0.12 (ruby 1.9.2) [universal-darwin10.0, x86_64].</p>\n"},{"tags":["ruby","amazon-web-services","video-streaming","rtmp","amazon-cloudfront"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":278,"score":0,"question_id":10196288,"title":"Private video streaming for Amazon CloudFront in ruby","body":"<h2>How does signed URLs work for streamed videos in Amazon CloudFront?</h2>\n\n<p>I'm using <a href=\"https://github.com/stlondemand/aws_cf_signer\" rel=\"nofollow\">aws_cf_signer</a> gem, but can't get signed urls work for rtmp streamed mp4-file. For static files, like text.txt it works fine, but not when I have streaming distribution.</p>\n\n<h3>Example:</h3>\n\n<p>I have file named test.mp4 so how do I get signed url out of <code>signer.sign()</code>?</p>\n\n<p>E.g. <code>signed_url = signer.sign('rtmp://xyz.cloudfront.net/test', :ending =&gt; Time.now + 3600)</code> does not produce working url. I have tested URLs with VLC player and <code>rtmpdump</code></p>\n\n<p>The distribution itself is created with <a href=\"https://github.com/boto/boto\" rel=\"nofollow\">boto</a> like this:</p>\n\n<blockquote>\n  <p>stream_dist = cf.create_streaming_distribution(origin=origin,\n  enabled=True,\n              trusted_signers=[\"Self\"],\n              comment=\"test distribution\")</p>\n</blockquote>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13159166,"title":"Ruby - what's the difference between single and double quotes?","body":"<p>So I'm following this Ruby tutorial: <a href=\"http://ruby.learncodethehardway.org/book/ex16.html\" rel=\"nofollow\">Learn Ruby the Hard Way.</a> In exercise 16 (linked), you write a script that writes lines to a file. The relevant code is:</p>\n\n<pre><code>print \"line 1: \"; line1 = STDIN.gets.chomp()\nprint \"line 2: \"; line2 = STDIN.gets.chomp()\nprint \"line 3: \"; line3 = STDIN.gets.chomp()\n\nputs \"I'm going to write these to the file.\"\n\ntarget.write(line1)\ntarget.write(\"\\n\")\ntarget.write(line2)\ntarget.write(\"\\n\")\ntarget.write(line3)\ntarget.write(\"\\n\")\n</code></pre>\n\n<p>However, being the lazy bum that I am, I originally typed in the example using single quotes in the last six lines, instead of the double quotes the tutorial tells you to use.</p>\n\n<p>This had an effect on the file. When I used single quotes, the file looked like this:\n    this is line 1\\nthis is line 2\\nthis is line 3</p>\n\n<p>After switching those quotes to double-quotes, the file looked as expected:\n    this is line 1\n    this is line 2\n    this is line 3</p>\n\n<p>Can someone tell me exactly why that is? Do single-quoted strings just ignore escape characters like \\n or \\t?</p>\n"},{"tags":["ruby","amazon-cloudfront"],"answer_count":5,"favorite_count":4,"up_vote_count":2,"down_vote_count":0,"view_count":1893,"score":2,"question_id":2632457,"title":"Create signed urls for CloudFront with Ruby","body":"<p>History:</p>\n\n<ol>\n<li>I created a key and pem file on Amazon.</li>\n<li>I created a private bucket</li>\n<li>I created a public distribution and used origin id to connect to the private bucket: works</li>\n<li>I created a private distribution and connected it the same as #3 - now I get access denied: expected</li>\n</ol>\n\n<p>I'm having a really hard time generating a url that will work.  I've been trying to follow the directions described here: <a href=\"http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/index.html?PrivateContent.html\" rel=\"nofollow\">http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/index.html?PrivateContent.html</a></p>\n\n<p>This is what I've got so far... doesn't work though - still getting access denied:</p>\n\n<pre><code>def url_safe(s)\n  s.gsub('+','-').gsub('=','_').gsub('/','~').gsub(/\\n/,'').gsub(' ','')\nend\n\ndef policy_for_resource(resource, expires = Time.now + 1.hour)\n  %({\"Statement\":[{\"Resource\":\"#{resource}\",\"Condition\":{\"DateLessThan\":{\"AWS:EpochTime\":#{expires.to_i}}}}]})\nend\n\ndef signature_for_resource(resource, key_id, private_key_file_name, expires = Time.now + 1.hour)\n    policy = url_safe(policy_for_resource(resource, expires))\n    key = OpenSSL::PKey::RSA.new(File.readlines(private_key_file_name).join(\"\")) \n    url_safe(Base64.encode64(key.sign(OpenSSL::Digest::SHA1.new, (policy))))\nend\n\ndef expiring_url_for_private_resource(resource, key_id, private_key_file_name, expires = Time.now + 1.hour)\n  sig = signature_for_resource(resource, key_id, private_key_file_name, expires)\n  \"#{resource}?Expires=#{expires.to_i}&amp;Signature=#{sig}&amp;Key-Pair-Id=#{key_id}\"\nend\n\nresource = \"http://d27ss180g8tp83.cloudfront.net/iwantu.jpeg\"\nkey_id = \"APKAIS6OBYQ253QOURZA\"\npk_file = \"doc/pk-APKAIS6OBYQ253QOURZA.pem\"\nputs expiring_url_for_private_resource(resource, key_id, pk_file)\n</code></pre>\n\n<p>Can anyone tell me what I'm doing wrong here?</p>\n"},{"tags":["ruby","ruby-on-rails-3","dsl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":133,"score":0,"question_id":6813118,"title":"How to write a DSL that is not in isolation to the block's environment?","body":"<p>I am trying to write a small Ruby DSL and have stumbled upon an inconvenience. Right now my \"DSL\" code is <a href=\"https://gist.github.com/0379b07f516f4f322204\" rel=\"nofollow\">https://gist.github.com/0379b07f516f4f322204</a> and my implementation code (inside an .html.erb file) is:</p>\n\n<pre><code>html_table_for @users do |t, user|\n  t.field :username, link_to(user.username, :action =&gt; 'show', :id =&gt; user.id)\n  t.field :email\n  t.field :roles, user.roles.map(&amp;:code).join(', ')\nend\n</code></pre>\n\n<p>The implementation code does not look much like a DSL because of the <code>t.field</code> instead of simply <code>field</code>. By replacing <code>@block.call</code> in the DSL code (line 34) with <code>instance_exec(@block)</code> I almost get what I want but then I lose all the ActionView goodness (namely <code>link_to</code>).</p>\n\n<p><strong>Is there a way to make available in the block the instance methods of my little DSL class while at the same time keeping availability of the helper methods of ActionPack included in Rails?</strong></p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13158638,"title":"Running soffice (libreoffice or openoffice) from command line in ruby on rails","body":"<p>I have an application which I would like to use libreoffice to batch convert files to html. I have the following method:</p>\n\n<pre><code>def set_versioned_odt\n  condition = %x(soffice --invisible --convert-to html /path/to/file.odt --outdir /path/to/dir/)\n\n  if condition\n    Rails.logger.info \"This has been finished\"\n  else\n    Rails.logger.info \"This failed...\"\n  end\n</code></pre>\n\n<p>end</p>\n\n<p>When I run this method in the application. It will return a failing statement; however, if I run this command in the rails console, soffice will process correctly. Does anyone know what I am doing wrong in the rails app?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13158399,"title":"Error while starting ruby server","body":"<p>I am new to ruby. I am trying to start the ruby server using the command <code>bundle exec rails server -p 3018</code>. But I am getting the below error. I checked in the code, there is no <code>newrelic.yml</code> file.</p>\n\n<pre><code>Cannot find or read /Users/hjodiawalla/Downloads/TheGiftsProject-Plugin/config/newrelic.yml\nExiting\n/Library/Ruby/Gems/1.8/gems/activerecord-3.0.3/lib/active_record/connection_adapters/postgresql_adapter.rb:928:in 'initialize': could not connect to server: Connection refused (PG::Error)\nIs the server running on host \"localhost\" and accepting TCP/IP connections on port 5432? could not connect to server: Connection refused\nIs the server running on host \"localhost\" and accepting TCP/IP connections on port 5432? could not connect to server: Connection refused\nIs the server running on host \"localhost\" and accepting TCP/IP connections on port 5432?\n    from /Library/Ruby/Gems/1.8/gems/activerecord-3.0.3/lib/active_record/connection_adapters/postgresql_adapter.rb:928:in 'connect'\n    from /Library/Ruby/Gems/1.8/gems/activerecord-3.0.3/lib/active_record/connection_adapters/postgresql_adapter.rb:928:in 'connect'\n</code></pre>\n\n<p>How do I resolve the issue. The server was working before with the same configuration. So have I missed something here.</p>\n"},{"tags":["ruby","nginx","sinatra"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":205,"score":1,"question_id":6627136,"title":"Simplest way to add Ruby script to a static website for AJAX","body":"<p>I have a <strong>simple portfolio website, which is just a set of static HTML files and some jQuery.</strong> </p>\n\n<p>Right now I'm trying to add a simple contact form which is submitted via AJAX, so I need to somehow process the request on the server side.</p>\n\n<p>The whole thing is running on a VPS with many other Rails applications on nginx. If I had PHP installed, it would've been easy task of just adding one simple PHP file and call it directly via AJAX, but I don't really know how to do that in Ruby.</p>\n\n<p>I basically have</p>\n\n<pre><code>server {\n    listen 80;\n    server_name example.com;\n    root /var/apps/example/com;\n}\n</code></pre>\n\n<p>for the static website, and now I need to somehow say, that file <code>contact.rb</code> should be executed as a Ruby file. </p>\n\n<p><strong>I thought that maybe using Sinatra for this would be a good idea, but I don't know how to bind/route it to a specific location on the domain. For example, the form might submit the AJAX request to <em>example.com/contact</em>, which would then just send out the email.</strong> </p>\n\n<p><em>The problem is, that all of the other Rails applications, where I could process the request are running on a different domain, so I can't use AJAX call directly to some other app and I need to create a separate script on this domain.</em></p>\n\n<p>I know I could rewrite the whole static website to be running on Sinatra, which would eliminate this issue, but I'd rather prefer doing this with some simple approach, as it's all just for one simple contact form.</p>\n"},{"tags":["ruby-on-rails","ruby","xslt","gem","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":12690991,"title":"exslt features not working in ruby-xslt gem","body":"<p>I have a Rails app and use Bundler to manage gems.\nI use the ruby-xslt gem for XSLT transformations.\nThe gem is not recognizing exslt features like node-set().</p>\n\n<p>Here’s the stylesheet I’ve been testing with</p>\n\n<pre><code>&lt;xsl:stylesheet version=\"1.1\" \n        xmlns=\"http://max.gov\" \n        xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" \n        xmlns:pre=\"http://max.gov\"\n        xmlns:exslt=\"http://exslt.org/common\"&gt;\n        &lt;xsl:output method=\"xml\" version=\"1.0\" encoding=\"UTF-8\" indent=\"yes\"/&gt;\n\n        &lt;!--The fabricated xml I want to access with exslt:node-set()--&gt;\n        &lt;xsl:variable name=\"PRE\"&gt;\n                    &lt;root&gt;\n                                &lt;item/&gt;\n                                &lt;item/&gt;\n                    &lt;/root&gt;\n        &lt;/xsl:variable&gt;\n\n        &lt;xsl:template match=\"/\"&gt;\n                    &lt;results&gt;\n                                &lt;run1 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                            &lt;results&gt;\n                                            &lt;xsl:for-each select=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                                        &lt;success position=\"{position()}\"/&gt;\n                                            &lt;/xsl:for-each&gt;\n                                            &lt;/results&gt;\n                                &lt;/run1&gt;\n                                &lt;run2 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                            &lt;results&gt;\n                                            &lt;xsl:for-each select=\"exslt:node-set($PRE)//pre:item\"&gt;\n                                                        &lt;success position=\"{position()}\"/&gt;\n                                            &lt;/xsl:for-each&gt;\n                                            &lt;/results&gt;\n                                &lt;/run2&gt;\n                    &lt;/results&gt;\n        &lt;/xsl:template&gt;\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p>Here’s output I get when using XML::XSLT in our app:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;results xmlns=\"http://max.gov\" xmlns:pre=\"http://max.gov\" xmlns:exslt=\"http://exslt.org/common\"&gt;\n   &lt;run1 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n    &lt;results/&gt;\n  &lt;/run1&gt;\n&lt;/results&gt;\n</code></pre>\n\n<p>(Note that not only did the node-set function not work, the  element got skipped altogether.)\nThe code is basically this:</p>\n\n<pre><code>xslt = XML::XSLT.new()\nxslt.xml = @xml         # @xml string\nxslt.xsl = @record.xslt # xslt is stored in db\nresult = xslt.serve\nrender :xml =&gt; result\n</code></pre>\n\n<p>Here’s the expected output</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n    &lt;results xmlns=\"http://max.gov\" xmlns:pre=\"http://max.gov\" xmlns:exslt=\"http://exslt.org/common\"&gt;\n       &lt;run1 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n          &lt;results&gt;\n             &lt;success position=\"1\"/&gt;\n             &lt;success position=\"2\"/&gt;\n          &lt;/results&gt;\n       &lt;/run1&gt;\n       &lt;run2 name=\"exslt:node-set($PRE)//pre:item\"&gt;\n           &lt;results&gt;\n             &lt;success position=\"1\"/&gt;\n             &lt;success position=\"2\"/&gt;\n           &lt;/results&gt;\n       &lt;/run2&gt;\n&lt;/results&gt;\n</code></pre>\n\n<p>I get this correct result when doing any of the following…</p>\n\n<p><ul>\n<li>Run xsltproc from command line</li>\n<li>Run the following in the Rails console</p>\n\n<blockquote>\n  <blockquote>\n    <p>xslt = XML::XSLT.new\n    xslt.xml = File.read('data.xml')<br>\n    xslt.xsl = File.read('test.xsl')\n    xslt.serve</li>\n    </ul></p>\n  </blockquote>\n</blockquote>\n"},{"tags":["iphone","ruby","audio","ffmpeg"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13157991,"title":"How to programmatically concatenate two aac files","body":"<p>Does any one know how concatenate two aac audio files into one.  I can do this with mp3 using ffmpeg but no luck with files with an m4a extension.</p>\n\n<p>I tried the following with no luck:<code>ffmpeg -i concat:\"file1.m4a\\|file2.m4a\" -c copy output.m4a'\n</code></p>\n"},{"tags":["ruby","gem","ruby-1.9"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13156535,"title":"Ruby 1.9.3 - cannot load such file for some reason","body":"<p>Ruby 1.9.3\nVery simple code and very simple question I can't deal with:</p>\n\n<pre><code>gem list --local\nnokogiri (1.5.5)\n\ngem q --local\nnokogiri (1.5.5)\n</code></pre>\n\n<p>But  a ruby script (not Rails):</p>\n\n<pre><code>require 'nokogiri'\ndoc = Nokogiri.XML(\"some valid xml....\")\n</code></pre>\n\n<p>gives me</p>\n\n<pre><code>/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- nokogiri (LoadError)\n    from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /home/alex/test.rb:3:in `&lt;main&gt;'\n[Finished in 0.1s with exit code 1]\n</code></pre>\n\n<p>I'm aware that it's not necessary to use <code>require 'rubygems'</code>, but even when I do that, it does not work either.</p>\n\n<pre><code>gem environment\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.8.24\n  - RUBY VERSION: 1.9.3 (2012-04-20 patchlevel 194) [x86_64-linux]\n  - INSTALLATION DIRECTORY: /home/alex/.rvm/gems/ruby-1.9.3-p194\n  - RUBY EXECUTABLE: /home/alex/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\n  - EXECUTABLE DIRECTORY: /home/alex/.rvm/gems/ruby-1.9.3-p194/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-linux\n  - GEM PATHS:\n     - /home/alex/.rvm/gems/ruby-1.9.3-p194\n     - /home/alex/.rvm/gems/ruby-1.9.3-p194@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - http://rubygems.org/\n\n\ngem which nokogiri\n/home/alex/.rvm/gems/ruby-1.9.3-p194/gems/nokogiri-1.5.5/lib/nokogiri.rb\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","sms","payment-gateway","sms-gateway"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12083693,"title":"SMS payments platform for subscriptions?","body":"<p>On WhitePages.com they have a mechanism in place that facilitates payment by entering your telephone number.  After you enter your number, you get an SMS that instructs you to enter \"GO\" in order to complete the transaction.  Following that reply with the purchase you've made, you get another message suggesting that for a certain monthly fee you can use the service in an unlimited fashion.  I had not seen anything with quite those dynamics before and I'm curious of what service(s) one would use to construct a payment system like this for a Ruby on Rails app?</p>\n\n<p>I am particularly interested in a platform that allows this kind of payment from as many countries as possible as I currently use Twilio for SMS messaging on another app.</p>\n"},{"tags":["ruby","dependency-injection","aop","needle"],"answer_count":3,"favorite_count":6,"up_vote_count":19,"down_vote_count":1,"view_count":2915,"score":18,"question_id":283466,"title":"Ruby dependency injection libraries","body":"<p>I've been looking at some Ruby dependency injection libraries.  In particularly, I checked out  <a href=\"http://needle.rubyforge.org/\" rel=\"nofollow\">Needle</a> and <a href=\"http://copland.rubyforge.org/\" rel=\"nofollow\">Copland</a>.  They've been around for quite awhile, yet not a lot of usages.  </p>\n\n<p>What are some of the pros and cons of using these two libraries? It sure seems like a lot of libraries / frameworks out there could make good use of these two libraries, e.g. <a href=\"http://github.com/sam/extlib/tree/master/lib/extlib/hook.rb\" rel=\"nofollow\">Merb / Datamapper's Hook</a>.</p>\n"},{"tags":["ruby","node.js","raphael","jsdom","execjs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13157386,"title":"Running Raphaël and JSDom in jsexec environment","body":"<p>I'm trying to use Raphaël in jsexec environment (using NodeJS as external runtime). As I see, i need JSDom library to make Raphaël working. I have following code:</p>\n\n<pre><code>require 'execjs'\nlib_source = Dir['js/libs/*.js'].map { |f| File.open(f, \"r\") { |io|  io.read}  }.join(\"\\n\\n\\n\")\ncontext = ExecJS.compile(lib_source)\nputs context.eval(\"Raphael(10, 50, 320, 200)\")\n</code></pre>\n\n<p>and while i'm trying to run it, i receive following error:</p>\n\n<pre><code>/home/vadim/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:68:in `extract_result': ReferenceError: document is not defined (ExecJS::ProgramError)\nfrom /home/vadim/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:28:in `block in exec'\nfrom /home/vadim/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:41:in `compile_to_tempfile'\nfrom /home/vadim/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:27:in `exec'\nfrom /home/vadim/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs/external_runtime.rb:19:in `eval'\nfrom execjs-test.rb:8:in `&lt;main&gt;'\n</code></pre>\n\n<p>In js/libs folder i have raphael.js, jsdom.js and jsdom folder with all files required by jsdom.</p>\n"},{"tags":["ruby","sass","compass-css","zurb-foundation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13053707,"title":"Codekit throwing up error with zurb-foundation 3 installed","body":"<p>Having trouble with Codekit/Compass. Know lots of people have had issues with this but none of the solutions I've seen have worked and my problem seems a little different. I've installed the zurb-foundation gem and created a new project with it. This project is being watched by CodeKit. If I compile the project in the terminal it seems to do it fine, if I use CodeKit, I get this error:</p>\n\n<p><em><strong>\"LoadError on line 2 of /Library/Ruby/Gems/1.8/gems/zurb-foundation-3.1.1/lib/zurb-     foundation.rb: no such file to load -- foundation/version\"</em></strong></p>\n\n<p>Irritatingly, the file /foundation/version.rb does exist where it should! Is CodeKit looking in the wrong place somehow? (despite navigating to the zurb-foundation.rb file perfectly?).</p>\n\n<p>Anyone had this issue before? Please note this is not the same issue as CodeKit not being able to find the gem, as it is finding it but throwing up another error.</p>\n\n<p>Cheers!</p>\n"},{"tags":["ruby","class","dynamic","metaprogramming"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":2547,"score":6,"question_id":4113479,"title":"Ruby: Dynamic Class Definition WITH A Class Name","body":"<p><strong>How do I dynamically define a class in Ruby WITH a name?</strong></p>\n\n<p>I know how to create a class dynamically <strong>without</strong> a name using something like:</p>\n\n<pre><code>dynamic_class = Class.new do\n  def method1\n  end\nend\n</code></pre>\n\n<p>But you can't specify a class name. I want to create a class dynamically <strong>with</strong> a name. </p>\n\n<p>Here's an example of what I want to do but of course it doesn't actually work.<br>\n(Note that I am not creating an instance of a class but a class definition)</p>\n\n<pre><code>class TestEval\n  def method1\n    puts \"name: #{self.name}\"\n  end\nend\n\nclass_name = \"TestEval\"\ndummy = eval(\"#{class_name}\")\n\nputs \"dummy: #{dummy}\"\n\ndynamic_name = \"TestEval2\"\nclass_string = \"\"\"\nclass #{dynamic_name}\n  def method1\n  end\nend\n\"\"\"\ndummy2 = eval(class_string)\nputs \"dummy2: #{dummy2}\" # doesn't work\n</code></pre>\n\n<p>Actual output:  </p>\n\n<pre><code>dummy: TestEval\ndummy2: \n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>dummy: TestEval\ndummy2: TestEval2\n</code></pre>\n\n<p>======================================================</p>\n\n<p><strong>Answer: A totally dynamic solution using sepp2k's method</strong></p>\n\n<pre><code>dynamic_name = \"TestEval2\"\n\nObject.const_set(dynamic_name, Class.new)\ndummy2 = eval(\"#{dynamic_name}\")\nputs \"dummy2: #{dummy2}\"\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","hosting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13156150,"title":"How to execute restart.txt ruby on rails shared hosting","body":"<p>i've created restart.txt in the tmp folder, but when i upload some changes to the site, there's nothing changing, so how can i execute the restart.txt manually? or it should start automatically?</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13155927,"title":"Ctrl-C doesn't quit program when using sytem() in Ruby","body":"<p>I have this program:</p>\n\n<pre><code>5.times do |i|\n  puts \"Iteration #{i}\"\n  system(\"sleep 3\")\nend\n</code></pre>\n\n<p>I want to exit this program after, say 2 iterations, usin <code>Ctrl-C</code></p>\n\n<p>If I hit <code>Ctrl-C</code>, this happens:</p>\n\n<pre><code>➜  tmp  ruby system.rb \nIteration 0\n^CIteration 1\n^CIteration 2\n^CIteration 3\n^CIteration 4\n^C%\n</code></pre>\n\n<p>The <code>system()</code> command is run 5 times, no matter what.</p>\n\n<p>What can I do so that I'm able to quit the execution using <code>Ctrl-C</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","join","yaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13155548,"title":"Loading yaml from file and join fails","body":"<p>I try to load a yaml file into an array but it fails with undefined method `join' for \"a b c\":String</p>\n\n<pre><code># Check certain temporarily emails\n# Throw notice not accepted use other email\nrequire 'yaml'\nbad_hostnames = YAML::load(File.read(\"#{Rails.root}/config/bad_hosts.yml\"))\nif /^(#{bad_hostnames.join(\"|\")})$/.match(host)\n  errors.add(:email, \"Please not use a disposable mailbox\")\nend\n</code></pre>\n\n<p>So i required yaml <em>before and on top of the model, controller where I load the yml in</em>:</p>\n\n<pre><code>require 'yaml'\n</code></pre>\n\n<p>Still same result, in rails console this works flawlessly, what am I missing?\nThe above code is inside my user.rb model, in console it works</p>\n\n<p>EDIT:\nbad_hosts.yml looks like (shortened) 1 provider the line</p>\n\n<pre><code>0-mail.com\n10minutemail.com\n30minutemail.com\n4warding.net\n</code></pre>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":31,"score":3,"question_id":13155367,"title":"How to make sequence from specific number?","body":"<p>How to make sequence from the beginning of square number and then adding it to the previous result?</p>\n\n<pre><code>7 =&gt; 49, 56, 63, ...\n\ndef make_sequence(number)\n  lambda { number*number ??? }\nend\n\nnum = make_sequence(7)\nnum.call #=&gt; 49\nnum.call #=&gt; 56\n...\n</code></pre>\n"},{"tags":["ruby","json"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13134355,"title":"Hash to JSON then joining with another JSON in Ruby","body":"<p>I have a JSON like this:</p>\n\n<pre><code>[\n  {\n    \"Low\": 8.63,\n    \"Volume\": 14211900,\n    \"Date\": \"2012-10-26\",\n    \"High\": 8.79,\n    \"Close\": 8.65,\n    \"Adj Close\": 8.65,\n    \"Open\": 8.7\n  },\n  {\n    \"Low\": 8.65,\n    \"Volume\": 12167500,\n    \"Date\": \"2012-10-25\",\n    \"High\": 8.81,\n    \"Close\": 8.73,\n    \"Adj Close\": 8.73,\n    \"Open\": 8.76\n  },\n  {\n    \"Low\": 8.68,\n    \"Volume\": 20239700,\n    \"Date\": \"2012-10-24\",\n    \"High\": 8.92,\n    \"Close\": 8.7,\n    \"Adj Close\": 8.7,\n    \"Open\": 8.85\n  }\n]\n</code></pre>\n\n<p>And have calculated a simple moving average for each day of the closing prices and called it a variable <code>sma9day</code>.  I'd like to join the moving average values with the original JSON, so I get something like this for each day:</p>\n\n<pre><code>  {\n   \"Low\": 8.68,\n   \"Volume\": 20239700,\n   \"Date\": \"2012-10-24\",\n   \"High\": 8.92,\n   \"Close\": 8.7,\n   \"Adj Close\": 8.7,\n   \"Open\": 8.85,\n   \"SMA9\": 8.92\n  }\n</code></pre>\n\n<p>With the sma9day variable I did this:</p>\n\n<pre><code>h = { \"SMA9\" =&gt; sma9day }\nsma9json = h.to_json\nputs sma9json\n</code></pre>\n\n<p>which outputs this:</p>\n\n<pre><code>{\"SMA9\":[8.92,8.93,8.93]}\n</code></pre>\n\n<p>How do I put it in a compatible format with the JSON and join the two?  I'll need to \"match/join\" from the top down, as the last 8 records in the JSON will not have 9 day moving average values (in these cases I'd still like the key to be there (SMA9), but have nil or zero as the value.</p>\n\n<p>Thank you.</p>\n\n<h1>LATEST UPDATE:</h1>\n\n<p>I now have this, which gets me very close, however it returns the entire string in the SMA9 field in the JSON...</p>\n\n<pre><code>require json\nrequire simple_statistics\n\njson = File.read(\"test.json\")\nquotes = JSON.parse(json)\n\n# Calculations\ndef sma9day(quotes, i)\nclose = quotes.collect {|quote| quote['Close']}\nsma9day = close.each_cons(9).collect {|close| close.mean}\nend\n\nquotes = quotes.each_with_index do |day, i|\n  day['SMA9'] = sma9day(quotes, i)\nend\n\np quotes[0]\n\n =&gt; {\"Low\"=&gt;8.63, \"Volume\"=&gt;14211900, \"Date\"=&gt;\"2012-10-26\", \"High\"=&gt;8.79, \"Close\"=&gt;8.65, \"Adj Close\"=&gt;8.65, \"Open\"=&gt;8.7, \"SMA9\"=&gt;[8.922222222222222, 8.93888888888889, 8.934444444444445, 8.94222222222222, 8.934444444444445, 8.937777777777777, 8.95, 8.936666666666667, 8.924444444444443, 8.906666666666666, 8.912222222222221, 8.936666666666666, 8.946666666666665, 8.977777777777778, 8.95111111111111, 8.92, 8.916666666666666]}\n</code></pre>\n\n<p>When I try to do sma9day.round(2) before the end of the calculations, it gives a method error (presumably because of the array?), and when I did sma9day[0].round(2), it does correctly round, but every record has the same SMA of course.</p>\n\n<p>Any help is appreciated.  Thanks</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":520,"score":4,"question_id":10355477,"title":"Is there an opposite of include? for Ruby Arrays?","body":"<p>I've got the following logic in my code:</p>\n\n<pre><code>if !@players.include?(p.name) do\n  ...\nend\n</code></pre>\n\n<p><code>@players</code> is an array.  Is there a method so I can avoid the <code>!</code>?</p>\n\n<p>Ideally, this snippet would be:</p>\n\n<pre><code>if @players.does_not_include?(p.name)  do\n  ...\nend\n</code></pre>\n"},{"tags":["ruby","rack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13152968,"title":"Serving non-public binary files from a Rack application","body":"<p>I am making a simple rack application that grant access to secured files after an authentication.<br>\nAs the data in the files is sensible, they are located in a non-public folder of the application.</p>\n\n<p>For now, after checking the session data, I just open the file for read and send the content as the body of the response.<br>\nIt feels ugly and must be very ressource consuming for larger files.</p>\n\n<p>Example response:</p>\n\n<pre><code>[ \"200\", {\"Content-Type\"=&gt; MIME::Types.type_for(file).first.to_s }, File.open( file ).read() ]\n</code></pre>\n\n<p>I looked into <a href=\"http://rack.rubyforge.org/doc/Rack/Sendfile.html\" rel=\"nofollow\">Rack::Sendfile</a>, but as far as I understand it, it is a middleware and cannot send files from inside the application itself.</p>\n\n<p>What would the most efficient way to send non-public binary files from a Rack application?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":414,"score":2,"question_id":6318834,"title":"Map objects based on index value","body":"<p>Suppose that i have 2 objects, where each one has a particular slot numbered from 1-5 (unique). Say that object1 has slot = 3 and object2 slot = 5.\nWhat is an effective way to create a hash like :</p>\n\n<pre><code>{ 1 =&gt; nil, 2 =&gt; nil, 3 =&gt; object1, 4 =&gt; nil, 5 =&gt; object2}\n</code></pre>\n\n<p>I suppose map could be used, but what's the best way ?</p>\n\n<p>EDIT : 5 is just an example, please pretend that you do not know the number of slots.</p>\n"},{"tags":["ruby","unit-testing","class","instance-variables"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13152158,"title":"Unit testing sameness/equality of instances of the same class in Ruby","body":"<p>\nI'm trying to unit test sameness of two instances of one class in Ruby:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>def test_example\n    a = Object.new\n    b = Object.new\n\n    assert_equal a, b\nend\n</code></pre>\n\n<p>I understand that this fails because the instances are distinct variables each with its own memory pointer. What I'm after is to get this test to pass if the instances are identical in all respects but their reference pointers.</p>\n\n<p>Here's a more involved (if contrived) example:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># Let's stir up something...\nclass FooBar\n    attr_accessor :seed, :foo, :bar\n\n    def foo_the_bar()\n        @bar = @seed + @foo * 3\n    end\nend\n\nf = FooBar.new\nf.seed = \"Mountains \"\nf.foo  = \"are just mountains \"\nf.bar = \"obliterate me!\"\nf.foo_the_bar\np f.bar # \"Mountains are just mountains are just mountains are just mountains \"\n\n\n# So far so good, now let's test if one FooBar is same as another...\n\nrequire 'test/unit'\nclass FooBarTest &lt; Test::Unit::TestCase\n\n    # Test fails: &lt;#&lt;FooBar:0x9a40d18&gt;&gt; expected but was &lt;#&lt;FooBar:0x9a40d04&gt;&gt;.\n    # But what we really want is a way to make this pass\n    # since the objects are exactly the same in every respect,\n    # besides their pointers.\n    def test_foobar_1_init\n        f1 = FooBar.new\n        f2 = FooBar.new\n\n        assert_equal f1, f2\n    end\n\n    # Again, test fails, but we want it to pass,\n    # since the instance variables are the same.\n    def test_foobar_2_instance_var\n        f1 = FooBar.new\n        f2 = FooBar.new\n\n        f1.seed = \"Santa says \"\n        f1.foo = \"ho \"\n        f1.bar = \"something\"\n        f1.foo_the_bar\n\n        f2.seed = f1.seed\n        f2.foo = f1.foo\n        f2.foo_the_bar\n\n        assert_equal f1, f2\n    end\n\n    # This test fails for the wrong reason.\n    # We want this to fail because the instance variables are different.\n    # This test should also fail if we add a method to one of the instances,\n    # or make the instances differ from each some other way.\n    def test_foobar_3_diff\n        f1 = FooBar.new\n        f2 = FooBar.new\n\n        f1.seed = \"Kitty goes \"\n        f1.foo = \"meow \"\n        f1.foo_the_bar\n\n        f2.seed = \"Doggies goes \"\n        f2.foo = \"woof \"\n        f2.foo_the_bar\n\n        assert_equal f1, f2\n    end\nend\n</code></pre>\n"},{"tags":["ruby","daemon"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":1986,"score":3,"question_id":542877,"title":"Detect stop with Ruby Daemons gem","body":"<p>I'm using the ruby <a href=\"http://raa.ruby-lang.org/project/daemons/\" rel=\"nofollow\">daemon</a> gem. Wondering how I can add some extra steps to the stop action? Was hoping I could detect stop was called, and add some extra code to it. Anyone know how I can accomplish this?</p>\n"},{"tags":["ruby-on-rails","ruby","gem"],"answer_count":4,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1246,"score":1,"question_id":225637,"title":"Anyone using RailRoad diagrams generator?","body":"<p>I recently installed RailRoad gem to generate an .svg diagram of my app's models and controllers.</p>\n\n<p>The rake task keeps breaking with a similar error:</p>\n\n<pre><code>1.8/usr/lib/ruby/gems/1.8/gems/activesupport-1.4.4/lib/active_support/dependencies.rb:263:in `load_missing_constant': uninitialized constant\n</code></pre>\n\n<p>I tried the rake task on 2 seperate apps and the error keeps appearing with a different \"constant\" name.</p>\n\n<p>Anyone using it with similar problems?</p>\n"},{"tags":["ruby-on-rails","ruby","foreman"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":376,"score":0,"question_id":8587588,"title":"Restart single process with Foreman","body":"<p>I've been using foreman for a while now to scale my various ruby processes in a centralized manner, and it is working perfectly for me . </p>\n\n<p>Anyways I would like to have some feature to restart a process or even to give it more control like to kill a process and start it again, in the current implementation when I kill one process the whole process in the main foreman stop . any workaround or solution here  ?</p>\n\n<p>Thanks in advance </p>\n"},{"tags":["html","ruby","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13119640,"title":"Cucumber/Capybara testing with x-tag","body":"<p>I'm testing the app I'm creating with Cucumber/Capybara. It looks like it doesn't see the <a href=\"http://x-tags.org/\" rel=\"nofollow\">x-tag</a> I am using. It looks like Cucumber doesn't render the page properly with the x-tag. Is there a way to solve this? I think this is the problem because when I put the input field outside of the xlogin.js and into the body or the div with id=login it does work.</p>\n\n<p>Body:\n\n</p>\n\n<pre><code>&lt;head&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;link rel=\"stylesheet\" href=\"js/jquery/jqueryMobile/jquery.mobile-1.2.0.css\" /&gt;\n    &lt;link rel=\"stylesheet\" href=\"components/login/login.css\"/&gt;\n    &lt;link rel=\"stylesheet\" href=\"master.css\"/&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div id=\"login\" data-role=\"page\" class=\"ui-tass-page\"&gt;\n        &lt;x-login&gt;&lt;/x-login&gt;\n    &lt;/div&gt;\n\n    &lt;div id=\"main\" data-role=\"page\" class=\"ui-tass-page\"&gt;\n    &lt;/div&gt;\n\n\n    &lt;script src=\"js/x-tag.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"components/login/login.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/jquery/jquery-1.8.2.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/jquery/jqueryMobile/jquery.mobile-1.2.0.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p></p>\n\n<p>Feature:</p>\n\n<pre><code>Feature: log in\n    In order to get access to the app's functionality\n    As a user\n    I want to log in\n\nScenario: happy flow\n    Given I am on the index.html#login page\n    Then I should be on the index.html page\n    When I give my username\n    And I give my password\n    And I click on login\n    Then I should go to the main page\n    And the username and password are saved\n</code></pre>\n\n<p>steps:</p>\n\n<pre><code>When /^I give my username$/ do\n  fill_in 'username', :with =&gt; 'user@example.com'\nend\n\nGiven /^I am on the (.*?) page$/ do |uri|\n  visit uri\n  response = page.driver.response\n  response.status.should eql 200\n  response.status.should_not eql 401\nend \n\nThen /^I should be on the (.*?) page$/ do |uri|\n  current_url.include?( uri ).should be true\nend\n</code></pre>\n\n<p>output:</p>\n\n<pre><code> Scenario: happy flow                      # features/login.feature:6\n    Given I am on the index.html#login page # features/step_definitions/generic_steps.rb:1\n    Then I should be on the index.html page # features/step_definitions/generic_steps.rb:8\n    When I give my username                 # features/step_definitions/login_steps.rb:1\n      cannot fill in, no text field, text area or password field with id, name, or label 'username' found (Capybara::ElementNotFound)\n      (eval):2:in `fill_in'\n      ./features/step_definitions/login_steps.rb:2:in `/^I give my username$/'\n      features/login.feature:9:in `When I give my username'\n</code></pre>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13153780,"title":"how to modify the real or imaginary part of a complex number in Ruby?","body":"<p>I am not used to Complex class in Ruby. I read the <a href=\"http://www.ruby-doc.org/core-1.9.3/Complex.html\" rel=\"nofollow\">doc</a> but I cannot figure how to modify the real or imaginary part of such a complex number. The accessor to modify these fields is not provided. </p>\n\n<p>c=Complex(1,2)\nc.real= 4 # impossible as is</p>\n\n<p>So my question is : how to modify  the real or imaginary part of a complex number in Ruby ?</p>\n\n<p>I particulary think a solution based on open class should be possible ?  </p>\n"},{"tags":["ruby-on-rails","ruby","scaffolding"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":62,"score":4,"question_id":13151960,"title":"How to edit multiple models in one form?","body":"<p>I got a task from my trainer. I want to edit two models in one form. \nFor example, we have two entities student and address. In the new student part i want to add both student details and address. How can i achieve this through scaffolding in ruby on rails?</p>\n"},{"tags":["ruby-on-rails","ruby","linux","ruby-on-rails-3","rubygems"],"answer_count":6,"favorite_count":6,"up_vote_count":26,"down_vote_count":0,"view_count":10646,"score":26,"question_id":4922700,"title":"Ruby 1.9.2 and Rails 3 cannot open rails console","body":"<pre><code>[gkaykck@main myApplication]$ rails console\n/usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `require': no such file to load -- readline (LoadError)\n    from /usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have installed rails 3 on ruby 1.9.2p136, which is ok i guess. But i cannot start rails console and it gives me the error i copied. The apps worked great with ruby 1.8.7 and i never saw an error like this.</p>\n\n<p>Any ideas what it could be?</p>\n"},{"tags":["ruby","heroku","cgi","sinatra"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":13060914,"title":"How do I use CGI in a Heroku application written with Ruby and Sinatra?","body":"<p>I am trying to move information from a text form to a new web page using CGI. To do this, I set <code>action</code> to <code>action=\"new.html\"</code> in the form. Then, in the relevant part of my <code>.rb</code> file, I have:</p>\n\n<pre><code>get \"/new.html\" do\n  @graph  = Koala::Facebook::API.new(session[:access_token])\n  @app  =  @graph.get_object(ENV[\"FACEBOOK_APP_ID\"])\n\n  if session[:access_token]\n    @query=CGI.new()         # Line of interest\n    @input=@query[\"tool_1\"]  # Line of interest\n  end\n\n  erb :my_tools_F\nend\n\npost \"/new.html\" do\n  redirect \"/new.html\"\nend\n</code></pre>\n\n<p>The new web page loads, but <code>@input</code> is blank when I call it in the <code>.erb</code> file.  Prior to this part of the script, I did require CGI. My web host is Heroku, and both of the <code>.erb</code> files are in a directory called <code>views</code>. The application is built to be launched on Facebook.  </p>\n\n<p>The example code is <a href=\"https://github.com/runninggraeb/Toolshed\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["ruby","csv","utf-8"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12410645,"title":"Ruby CSV UTF-8 Encoding/Translation Issues","body":"<p>I'm having problems with Ruby 1.9 CSV and invalid UTF-8 characters in my data.</p>\n\n<p>My code looks something like this:</p>\n\n<pre><code>CSV.foreach(\"small-test2.csv\", options) do |row |\n\n    name, workgroup, address, actual, output = row\n    next if nbname == \"NBName\"\n    @ssl_info[name] = workgroup, address, actual, output\n\n   ic = Iconv.new('UTF-8//IGNORE', 'UTF-8')\n   clean = ic.iconv(output + ' ')[0..-2]\n\n   puts clean\n\nend\n</code></pre>\n\n<p>However I'm still getting the following:</p>\n\n<pre><code>ArgumentError: invalid byte sequence in UTF-8\n           =~ at org/jruby/RubyRegexp.java:1487\n           =~ at org/jruby/RubyString.java:1686\n</code></pre>\n\n<p>Is there anything I'm missing here?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":6,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":2350,"score":7,"question_id":180290,"title":"What are the limits of ruby on rails?","body":"<p>I have a memory of talking to people who have got so far in using Ruby on Rails and then had to abandon it when they have hit limits, or found it was ultimately too rigid.  I forget the details but it may have had to do with using more than one database.</p>\n\n<p>So what I'd like is to know is what features/requirements fall outside of Ruby on Rails, or at least requires such contortions that it is better to use another more flexible framework, even though you may have to lose some elegance or write extra boilerplate code.  </p>\n"},{"tags":["ruby","textmate","sublimetext2","execution"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13059700,"title":"Can Sublimetext2 execude ruby code and show the results within the document like Textmate?","body":"<p>Textmate allows to run code within the document and show the results irb-style:</p>\n\n<pre><code>1+1 # =&gt;\n</code></pre>\n\n<p>Run the code (and I don't remember the shortcut)</p>\n\n<pre><code>1+1 # =&gt; 2\n</code></pre>\n\n<p>The behavior is triggered by adding a comment of the format:</p>\n\n<pre><code># =&gt;\n</code></pre>\n\n<p>immediately after a ruby expression and then using the magic shortcut.</p>\n\n<p>My question is, 1, what is the Textmate shortcut and the 2, is there a way to achieve the same functionality in SublimeText2?</p>\n\n<p>EDIT: The TextMate shortcut is Ctrl+Shift+Apple+E (Execute and update \"#=>\" markers).</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13152592,"title":"Is there a way to force a \"before_destroy\" callback to be trigered first?","body":"<p>I have a model which specifies a before destroy callback. Something like:</p>\n\n<pre><code>Class User &lt; ActiveRecord::Base\n  before_destroy :do_destroy\n  acts_as_destroyable\n\n  private\n  def do_destroy\n    puts \"A\"\n  end\nend\n\nmodule ActsAsDestroyable\n  def self.included(base)\n    base.send(:extend, ActsMethods)\n  end\n\n  module ActsMethods\n    def acts_as_destroyable(options = {})\n      self.send(:include, InstanceMethods)\n    end\n\n    module InstanceMethods\n      def do_something\n        puts \"A0\"\n      end\n\n      def self.included(base)\n        base.before_destroy :do_something\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Now since the Destroyable module works with Users's assosiacions it needs to have its \"do_domething\" method executed before the \"do_destroy\" callback. Any ideas how can I move it up the callback queue?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13151665,"title":"how to use n value's n power in ruby 1.8.6","body":"<p>Is there any method available in ruby 1.8.6 for calculating n values n power?</p>\n\n<p>Like 2 has 5 power then answer is 32 and 5 has 3 power then answer is 125?</p>\n"},{"tags":["mysql","ruby","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13151710,"title":"Activerecord - how to made this?","body":"<p>Everyday, I need to run the a script and send all of my users an 'exam' or set of questions. I have modelled as class 'Exam' which subclasses ActiveRecord::Base. Now, how do I send user's instances of Exam?</p>\n\n<p>What I was thinking was create a new class called 'ExamInstance' which would have a reference to 'Exam' and the user. </p>\n\n<p>I am new to SQL and ActiveRecord so if someone can help me better model this so I can avoid problems later on or just give me some insight, that would be great.</p>\n\n<p>Thanks</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":170,"score":0,"question_id":12263762,"title":"how to convert doc, docx files to pdf in ruby/rails","body":"<p>I'm working on a web app in rails that uses document files, that I need to convert it to pdf in a place in the project! I wanna a ruby or javascript convert doc, docx, and plain text as well to pdf file.</p>\n\n<p>My search get me to a lot of pdf generators gems like <a href=\"https://github.com/prawnpdf/prawn\" rel=\"nofollow\">prawn</a>, <a href=\"http://railscasts.com/episodes/220-pdfkit\" rel=\"nofollow\">pdfkit</a>. they are generating pdf from templates (html and css or from a code!).</p>\n\n<p>If not, is there any api or a documentations to read doc/docx formats so that I can write the converter myself !?</p>\n"},{"tags":["ruby-on-rails","ruby","validation","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13137729,"title":"Ruby on Rails - Validating columns of a CSV file by calling validation methods with the inject method","body":"<p>Here is the RoR code which I want to use to validate columns in a csv file.\nBut the values from the \"rowdata\" array is not passed to the validation methods. Any help is greatly appreciated.</p>\n\n<pre><code>#Ruby on Rails code\ndef validate_rows\n    count_row=0\n    #@passed_file is a csv file which is read from a submitted html form.\n    @parsed_file=CSV::Reader.parse(params[:dump][:csvfile])\n    @parsed_file.each  do |row|\n        # Array of columns to be validated\n        validate_cols = [:admission_no, :class_roll_no]\n        rowdata={'admission_no'=&gt;row[0],'class_roll_no'=&gt;row[1]}\n\n\n        #validate colums by sending value from the array (rowdata)  to a method injected\n        #by the following code. However value from rowdata array is not passed\n        #to the method.\n        if count_row &gt;=1\n            valid = validate_cols.inject(true){|valid_sum, col|\n                valid_sum &amp;&amp; send(\"validate_#{col}\", rowdata[col])\n            }\n            #if validation fails return row number.\n            if not (valid)\n                return count_row\n            end\n        end\n        count_row=count_row+1\n    end \n    #if validation suceeds return 0\n    return 0\nend\n\n#The following methods are called by the inject funnction (valid)\ndef validate_admission_no(passed_value)\n    if(passed_value)\n        return true\n        else\n        return false\n    end\nend\n\ndef validate_class_roll_no(passed_value)\n    if(passed_value)\n        return true\n        else\n        return false\n    end\nend\n</code></pre>\n"},{"tags":["ruby","ssl","openssl","shopify"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":154,"score":1,"question_id":12443258,"title":"SSL_connect error when accessing Shopify API with rubygem","body":"<p>I'm having trouble accessing the Shopify API using the shopify_api gem.</p>\n\n<p>Here's what happens:</p>\n\n<pre><code>&gt;&gt; require \"shopify_api\" #=&gt; false\n&gt;&gt; ShopifyAPI::Base.site = \"https://username:secret@mysite.myshopify.com/admin\"\n=&gt; \"https://username:secret@mysite.myshopify.com/admin\"\n&gt;&gt; products = ShopifyAPI::Product.find(:all)\nErrno::ECONNRESET: Connection reset by peer - SSL_connect\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in `connect'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in `block in connect'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/timeout.rb:54:in `timeout'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/timeout.rb:99:in `timeout'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in `connect'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:755:in `do_start'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:744:in `start'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:1284:in `request'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:1026:in `get'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/connection.rb:113:in `block in request'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `block in instrument'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `instrument'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/connection.rb:110:in `request'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/shopify_api-3.0.1/lib/active_resource/connection_ext.rb:13:in `request_with_detailed_log_subscriber'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/connection.rb:80:in `block in get'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/connection.rb:218:in `with_auth'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/connection.rb:80:in `get'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/base.rb:901:in `find_every'\n    from /Users/zubin/.rvm/gems/ruby-1.9.3-p194/gems/activeresource-3.2.8/lib/active_resource/base.rb:813:in `find'\n    from (irb):21\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/bin/irb:16:in `&lt;main&gt;'\n</code></pre>\n\n<p>Thinking it was a problem with ruby's openssl bindings, I installed openssl with RVM and reinstalled ruby:</p>\n\n<pre><code>rvm pkg install openssl\nrvm reinstall 1.9.3-p194 --with-openssl-dir=~/.rvm/usr\n</code></pre>\n\n<p>But that didn't help.</p>\n\n<p>So I tried connecting with plain ol' <code>NET::HTTPS</code> and was able to connect to another site, but not shopify.</p>\n\n<pre><code>&gt;&gt; require \"net/https\" #=&gt; false\n&gt;&gt; require \"uri\" #=&gt; false\n&gt;&gt; uri = URI.parse(\"https://google.com/\") #=&gt; #&lt;URI::HTTPS:0x007fa27bb243f8 URL:https://google.com/&gt;\n&gt;&gt; http = Net::HTTP.new(uri.host, uri.port) #=&gt; #&lt;Net::HTTP google.com:443 open=false&gt;\n&gt;&gt; http.use_ssl = true #=&gt; true\n&gt;&gt; http.verify_mode = OpenSSL::SSL::VERIFY_NONE #=&gt; 0\n&gt;&gt; http.start { |agent| p agent.get(uri.path).read_body }\n\"&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=\\\"content-type\\\" content=\\\"text/html;charset=utf-8\\\"&gt;\\n&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;\\n&lt;H1&gt;301 Moved&lt;/H1&gt;\\nThe document has moved\\n&lt;A HREF=\\\"https://www.google.com/\\\"&gt;here&lt;/A&gt;.\\r\\n&lt;/BODY&gt;&lt;/HTML&gt;\\r\\n\"\n=&gt; \"&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=\\\"content-type\\\" content=\\\"text/html;charset=utf-8\\\"&gt;\\n&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;\\n&lt;H1&gt;301 Moved&lt;/H1&gt;\\nThe document has moved\\n&lt;A HREF=\\\"https://www.google.com/\\\"&gt;here&lt;/A&gt;.\\r\\n&lt;/BODY&gt;&lt;/HTML&gt;\\r\\n\"\n&gt;&gt; uri = URI.parse(\"https://mysite.myshopify.com/admin/\")\n=&gt; #&lt;URI::HTTPS:0x007fa27d1f5e38 URL:https://mysite.myshopify.com/admin/&gt;\n&gt;&gt; http = Net::HTTP.new(uri.host, uri.port) #=&gt; #&lt;Net::HTTP mysite.myshopify.com:443 open=false&gt;\n&gt;&gt; http.use_ssl = true #=&gt; true\n&gt;&gt; http.verify_mode = OpenSSL::SSL::VERIFY_NONE #=&gt; 0\n&gt;&gt; http.start { |agent| p agent.get(uri.path).read_body }\nErrno::ECONNRESET: Connection reset by peer - SSL_connect\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in `connect'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in `block in connect'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/timeout.rb:54:in `timeout'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/timeout.rb:99:in `timeout'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:799:in `connect'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:755:in `do_start'\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/net/http.rb:744:in `start'\n    from (irb):18\n    from /Users/zubin/.rvm/rubies/ruby-1.9.3-p194/bin/irb:16:in `&lt;main&gt;'\n</code></pre>\n\n<p>So that rules out my ruby/openssl setup. Any ideas what's causing the SSL_connect error?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13151598,"title":"Track the details of a repository or a application folder using Rails","body":"<p>Is there a way to get/track the details of a repository or a application folder in Rails.\nI mean that getting the list of --</p>\n\n<ul>\n<li>No of files</li>\n<li>No of classes</li>\n<li>No of folders</li>\n<li>No of tables in a database schema etc.</li>\n</ul>\n\n<p>I need the details of the folder given.</p>\n\n<p>Thank You</p>\n"},{"tags":["ruby-on-rails","ruby","xcode","rake","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":89,"score":-1,"question_id":13150693,"title":"\"Could not find Rake\" - Fresh Ruby on Rails install on OS X 10.8","body":"<pre>\nTrying to install RoR on OS X 10.8.  New to both Mac and RoR!\n\nFollowing directions here: \nhttp://www.justinball.com/2012/10/22/install-rvm-on-mac-osx-mountain-lion/\n\nInstalled XCode, Command Line Tools, XQuartz, Homebrew, gcc, latest RVM, executed \n\"rvm pkg install openssl\", and finally \"rvm install 1.9.3\"\n\nThere were some error messages along the way, which I will provide in a moment. \nHowever, the install seems successful based on the following:\n\n$ type rvm | head -n1\nrvm is a function\n$ rails -v\nRails 3.2.8\nruby --version\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0]\n\nErrors/warnings during install included:\nWarning: Could not tap homebrew/dupes/vim over mxcl/master/vim\nThere has been an error fetching the ruby interpreter. Halting the installation.\n\nCreated a new directory named \"agile\", changed to the directory and executed: \n\"rails new demo\"\nGot \"`mkdir': Permission denied\" in the first line of the output\n\nThen tried \"sudo rails new demo\"\nGot \"Could not find Rake\" in the first line of the output\n\n(Full output provided at the end of this post.)\n\nTried various things to see if there was something wrong with rake, rails, ruby, or rvm, but all seems to come back normal.\n\nMichaels-MacBook-Pro:agile mh$ rake --version\nrake, version 0.9.2.2\nMichaels-MacBook-Pro:agile mh$ whereis rake\n/usr/bin/rake\nMichaels-MacBook-Pro:agile mh$ which rake\n/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\nMichaels-MacBook-Pro:agile mh$ which gem\n/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/gem\nMichaels-MacBook-Pro:agile mh$ rvm info\n\nruby-1.9.3-p286:\n\n  system:\n    uname:       \"Darwin Michaels-MacBook-Pro.local 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64\"\n    system:      \"downloads\"\n    bash:        \"/bin/bash => GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin12)\"\n    zsh:         \"/bin/zsh => zsh 4.3.11 (i386-apple-darwin12.0)\"\n\n  rvm:\n    version:      \"rvm 1.16.17 () by Wayne E. Seguin , Michal Papis  [https://rvm.io/]\"\n    updated:      \"7 hours 52 minutes 30 seconds ago\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.3p286\"\n    date:         \"2012-10-12\"\n    platform:     \"x86_64-darwin12.2.0\"\n    patchlevel:   \"2012-10-12 revision 37165\"\n    full_version: \"ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0]\"\n\n  homes:\n    gem:          \"/Users/mh/.rvm/gems/ruby-1.9.3-p286\"\n    ruby:         \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286\"\n\n  binaries:\n    ruby:         \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\"\n    irb:          \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/irb\"\n    gem:          \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/gem\"\n    rake:         \"/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\"\n\n  environment:\n    PATH:         \"/Users/mh/.rvm/gems/ruby-1.9.3-p286/bin:/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin:/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin:/Users/mh/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/local/git/bin\"\n    GEM_HOME:     \"/Users/mh/.rvm/gems/ruby-1.9.3-p286\"\n    GEM_PATH:     \"/Users/mh/.rvm/gems/ruby-1.9.3-p286:/Users/mh/.rvm/gems/ruby-1.9.3-p286@global\"\n    MY_RUBY_HOME: \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286\"\n    IRBRC:        \"/Users/mh/.rvm/rubies/ruby-1.9.3-p286/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"\"\n\n\nMichaels-MacBook-Pro:agile mh$ type rvm | head -n1\nrvm is a function\n\n\n\n\n===================================================================\nMichaels-MacBook-Pro:agile mh$ rails new demo\n      create  \n/Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': Permission denied - /Users/mh/agile/demo (Errno::EACCES)\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:247:in `fu_mkdir'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:221:in `block (2 levels) in mkdir_p'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:219:in `reverse_each'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:219:in `block in mkdir_p'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:205:in `each'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:205:in `mkdir_p'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:51:in `block in invoke!'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:133:in `call'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:133:in `invoke_with_conflict_check'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:50:in `invoke!'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions.rb:95:in `action'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:15:in `empty_directory'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/generators/app_base.rb:103:in `create_root'\n    from (eval):1:in `create_root'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/task.rb:27:in `run'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:120:in `invoke_task'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `block in invoke_all'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `each'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `map'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `invoke_all'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/group.rb:238:in `dispatch'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/base.rb:425:in `start'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/commands/application.rb:38:in `'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/cli.rb:15:in `'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/bin/rails:7:in `'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:19:in `load'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:19:in `'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `'\nMichaels-MacBook-Pro:agile mh$ sudo rails new demo\n/Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find rake (>= 0.8.7) amongst [actionmailer-3.2.8, actionpack-3.2.8, activemodel-3.2.8, activerecord-3.2.8, activeresource-3.2.8, activesupport-3.2.8, arel-3.0.2, builder-3.0.4, erubis-2.7.0, hike-1.2.1, i18n-0.6.1, journey-1.0.4, json-1.7.5, mail-2.4.4, mime-types-1.19, multi_json-1.3.6, polyglot-0.3.3, rack-1.4.1, rack-cache-1.2, rack-ssl-1.3.2, rack-test-0.6.2, rails-3.2.8, railties-3.2.8, rdoc-3.12, sprockets-2.1.3, thor-0.16.0, tilt-1.3.3, treetop-1.4.12, tzinfo-0.3.34] (Gem::LoadError)\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:777:in `block in activate_dependencies'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:766:in `each'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:766:in `activate_dependencies'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:750:in `activate'\n    from /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems.rb:1232:in `gem'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:18:in `'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'\n    from /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `'\n</pre>\n"},{"tags":["mysql","ruby"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13151552,"title":"Import .sql file with mysql Ruby Gem","body":"<p>Using the mysql Ruby gem, is it possible to do something equivalent to the following?</p>\n\n<p><code>mysql -uroot -proot test &lt; test.sql</code></p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1170,"score":0,"question_id":10810311,"title":"NoMethodError (undefined method `[]' for nil:NilClass)","body":"<p>I have a very odd instance of this error:</p>\n\n<pre><code>NoMethodError (undefined method `[]' for nil:NilClass):\napp/controllers/main_controller.rb:150:in `block in find_data_label'\napp/controllers/main_controller.rb:149:in `each'\napp/controllers/main_controller.rb:149:in `find_data_label'\napp/controllers/main_controller.rb:125:in `data_string'\napp/controllers/main_controller.rb:35:in `catch'\n</code></pre>\n\n<p>Whats weird is that the line 150, where it says the error is, is inside a loop and executes perfectly 11 times before it decides to error out. I am out of ideas as to why it would work  fine but fail one line before what would effective be the loop where the if statement returns true.</p>\n\n<p>This is the code:</p>\n\n<pre><code>  def find_data_label(label)\n    @fields.each do |f|\n      puts \"f[:field_data]['Title'] = #{f[:field_data]['Title']}\" # &lt;--- line 150\n      if f[:field_data]['Title'] == label\n        return f\n      end\n    end\n  end\n</code></pre>\n\n<p>And this is the output before I get the error:</p>\n\n<pre><code>f[:field_data]['Title'] = Name\nf[:field_data]['Title'] = Name\nf[:field_data]['Title'] = Mobile number\nf[:field_data]['Title'] = Email\nf[:field_data]['Title'] = Date of birth\nf[:field_data]['Title'] = Gender\nf[:field_data]['Title'] = Street name\nf[:field_data]['Title'] = Street number\nf[:field_data]['Title'] = My local Puckles store is in\nf[:field_data]['Title'] = Suburb\nf[:field_data]['Title'] = Postcode\nCompleted 500 Internal Server Error in 2047ms\n</code></pre>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["ruby","nokogiri"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13142243,"title":"Get attribute value from XML","body":"<p>I have this chunk of XML:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;show name=\"Are We There Yet?\"&gt;\n  &lt;sid&gt;24588&lt;/sid&gt;\n  &lt;network&gt;TBS&lt;/network&gt;\n  &lt;title&gt;The Kwandanegaba Children's Fund Episode&lt;/title&gt;\n  &lt;ep&gt;03x31&lt;/ep&gt;\n  &lt;link&gt;\n    http://www.tvrage.com/shows/id-24588/episodes/1065228407\n  &lt;/link&gt;\n&lt;/show&gt;\n</code></pre>\n\n<p>I am trying to get \"Are we there yet?\" via <a href=\"http://nokogiri.org\" rel=\"nofollow\">Nokogiri</a>. It is effectively the 'name' attribute of 'show'. I'm struggling to figure out how to parse this. </p>\n\n<p><code>xml.at_css('show').value</code> was my best guess but doesn't work.</p>\n"},{"tags":["ruby","linux","ubuntu"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13151225,"title":"Installing Ruby 1.9.3 from source on Ubuntu","body":"<p>I just went through what looked like a pretty successful install of Ruby 1.9.3 on Ubuntu, but when I i do ruby -v, I still get the old Ruby. My install:</p>\n\n<pre><code>./configure\nmake \nmake install\n</code></pre>\n\n<p>Everything looks like it went off without a hitch, but still no Ruby 1.9.3. Do I need to do something extra. I couldn't find any Ruby configuration files in /etc to configure and could only find an old Ruby 1.9.1 in /usr/bin. I did the installation in my home directory.</p>\n"},{"tags":["ruby-on-rails","ruby","rake","rake-task"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13112703,"title":"syntax error when running rake task","body":"<p>I am new to ruby and rails, so I am still attempting to get a handle on the syntax and structure of ruby.  I am following <a href=\"http://dwradcliffe.com/2011/12/29/import-csv.html\" rel=\"nofollow\">a tutorial</a> to import a csv file using a task and rake. I keep getting a syntax error though. I am not sure what I am missing, I do not see any difference between the example and my code.</p>\n\n<pre><code>require 'csv'\n\n    desc \"Import Voters from CSV File\"\n\n    task :import =&gt; [:environment] do\n\n      file =\"db/my.csv\"\n\n      CSV.foreach(file, :headers =&gt; true) do |row|\n        Voter.create{\n          :last_name =&gt; row[0]\n        }  \n\n      end\n\n\n\n\n\n\n(See full trace by running task with --trace)\nErics-MacBook-Air:cloudvoters ecumbee$ rake db:import --trace\nrake aborted!\n/Users/ecumbee/Desktop/cloudvoters/lib/tasks/import.rake:11: syntax error, unexpected tASSOC, expecting '}'\n      :last_name =&gt; row[0], \n                   ^\n/Users/ecumbee/Desktop/cloudvoters/lib/tasks/import.rake:12: syntax error, unexpected '}', expecting '='\n    }  \n     ^\n</code></pre>\n"},{"tags":["ruby","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13151144,"title":"rake aborted! syntax error, unexpected tLSHFT","body":"<p>I use mountain lion, i install ruby-1.9.3-p125. And i use <code>rake new_post['test']</code>, \nthe terminal return the information:</p>\n\n<pre><code>rake aborted!\n/Users/John/octopress/Rakefile:10: syntax error, unexpected tLSHFT, expecting $end\n&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n  ^\n</code></pre>\n\n<p>how could i solve the problem, thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3.2","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13151147,"title":"Adding path to asset pipeline, add js file to manifest, wrong path generated by javascript_include_tag","body":"<p>So we use git submodules to link external javascript/css dependencies to our project and place them in /vendor/externals. In order to use these within Rails, I've added them to the asset pipeline in application.rb like this:</p>\n\n<pre><code>config.assets.paths &lt;&lt;  Rails.root.join(\"vendor\",\"externals\",\"pushpop\")\n</code></pre>\n\n<p>For the sake of this example, lets say that the pushpop folder contains two files, pushpop.js and pushpop.css. I include these in the application manifests</p>\n\n<p>Javascript:</p>\n\n<pre><code>//= require pushpop\n</code></pre>\n\n<p>And stylesheets</p>\n\n<pre><code>*= require pushpop\n</code></pre>\n\n<p>In development, I'm expecting &lt;%= javascript_include_tag \"application\" %> and &lt;%= stylesheet_link_tag \"application\", :media => \"all\" %> to create </p>\n\n<pre><code>&lt;script src=\"http://localhost:3000/assets/pushpop.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;link href=\"http://localhost:3000/assets/pushpop.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\"&gt;\n</code></pre>\n\n<p>However, these tags are creating:</p>\n\n<pre><code>&lt;script src=\"http://localhost:3000/assets/pushpop/pushpop.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;link href=\"http://localhost:3000/assets/pushpop/pushpop.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\"&gt;\n</code></pre>\n\n<p>Now whats totally awesome is that if I manually hit <code>http://localhost:3000/assets/pushpop.js</code> in the browser, all is well with the world.</p>\n\n<p>Are my expectations off here, or am I doing something wrong?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1045,"score":8,"question_id":1711547,"title":"How to check if a param is true or false?","body":"<p>This is really racking my brain, but maybe I'm trying to hard.</p>\n\n<p>I'm passing a param via a URL (example.com?debug=true)</p>\n\n<p>So I basically want to say:</p>\n\n<pre><code>if params[:debug] == true\n do xyz\nelse\n do abc\nend\n</code></pre>\n\n<p>But for whatever reason that if statement just isn't doing like it seems like it should.</p>\n\n<p>Is there a better way to do that if/else statement based on a param being true or false?</p>\n\n<p>The debug param will either have a value of true, no value, or a value of false (as far as the URL goes).</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13147616,"title":"Migrate legacy database users to Devise","body":"<p>We have an old PHP app in MySQL that we're currently rewriting in Rails and PostgreSQL.\nI'm looking for a way to migrate users one-by-one when they first sign in to the new system, so that we migrate only active users.</p>\n\n<p>Is there a hook in <strong>Devise</strong> that I can use to catch a failed login towards the new database and check if the user exists in the old MySQL database and migrate the user if found.</p>\n\n<p>BTW, the Rails app can access both databases and the migration code is already in place that accepts old <code>username</code> as input.</p>\n\n<p>Or should I just simply make a separate _migration_assistant_ page that accepts old logins and initiates the migration?</p>\n\n<p>PS. any user can possibly have thousands of database records to migrate so it can take a bit of time, but we already make use of PosgreSQL's <code>COPY FROM</code> to speed it up (about a few secs per account).</p>\n\n<p><strong>EDIT:</strong>\nThere are currently about <strong>5000</strong> users and we expect roughly <strong>1000</strong> of them to return to the new site.</p>\n"},{"tags":["ruby","loops","heroku","naming-conventions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13150881,"title":"heroku re-orders ruby on rails loop output of partials","body":"<p>I have a page which renders several partials; on my local mac everything is fine but after I push to heroku and visit the page the order of the partials is different! </p>\n\n<p>I render partials with the code below and thought I controlled the order with a file naming convention.</p>\n\n<p>html.erb:</p>\n\n<pre><code>&lt;% Dir[\"app/views/partials/ws/*.html.erb\"].each do |ws| %&gt;\n&lt;%= render 'partials/ws/' + File.basename(ws,'.html.erb').slice(1..-1) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The partials use a naming convention:</p>\n\n<pre><code>_ws_01-why.html.erb\n_ws_02-what.html.erb\n_ws_03-who.html.erb\n_ws_04-where.html.erb\n_ws_05-when1.html.erb\n_ws_06-how.html.erb\n</code></pre>\n\n<p>Heroku renders in this order:</p>\n\n<pre><code>_ws_01-why.html.erb\n_ws_02-what.html.erb\n_ws_06-how.html.erb\n_ws_04-where.html.erb\n_ws_05-when1.html.erb\n_ws_03-who.html.erb\n</code></pre>\n\n<p>I'm not sure how heroku is interpreting the naming convention / ruby loop order... Wondering if there is a better naming convection or logic to add in my loop to control the order?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","selenium-webdriver","testunit","pageobjects"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13148057,"title":"Using Test::Unit in an abstraction layer","body":"<p>Is there a way to call assertions from inside an object?  I am writing Selenium tests and using test unit for assertions and easy reporting.  I have an abstraction layer between the top level test ( class that extends Test::Unit::TestCase)  and selenium webdriver.  I have my abstraction layer responsible for all items on the page and I need a way for the top level test to stop if the abstraction layer finds something other than it was expecting.  If I could call a Test::Unit assertion from inside this abstraction layer that would be ideal.  If there are any suggestions about how to better accomplish this I am open to suggestions. \nThanks, \nZach  </p>\n"},{"tags":["ruby","git","ruby-on-rails-3","configuration","heroku"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1112,"score":6,"question_id":4857031,"title":"GIt Deployment + Configuration Files + Heroku","body":"<p>I'm using Heroku to host a Rails app, which means using Git to deploy to Heroku. Because of the \"pure Git workflow\" on Heroku, anything that needs to go upstream to the server has to be configured identically on my local box.</p>\n\n<p>However I need to have certain configuration files be different depending on whether I'm in the local setup or deployed on Heroku. Again, because of the deployment method Heroku uses I can't use .gitignore and a template (as I have seen suggested many times, and have used in other projects).</p>\n\n<p>What I need is for git to somehow track changes on a file, but selectively tell git not to override certain files when pulling from a particular repo -- basically to make certain changes one-way only.</p>\n\n<p>Can this be done? I'd appreciate any suggestions!</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13150432,"title":"Converting a variable with a UTC time to a Seconds integer (Ruby)","body":"<p>I have a variable that has a UTC time tied with it,  example:</p>\n\n<pre><code>   offer_ends_at =&gt; Sun, 25 Nov 2012 07:59:59 UTC +00:00,\n</code></pre>\n\n<p>My goal is to create a new variable, and convert the Time to a seconds integer.   I tried with some methods like  </p>\n\n<pre><code>   seconds = offer_ends_at.to_time.to_i \n</code></pre>\n\n<p>I end up getting a epoc time.  I'm after an actual integer that contains the amount of seconds left until the date happens. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby","amazon-s3","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":65,"score":5,"question_id":13105827,"title":"amazon s3 and carrierwave random image name in bucket does not match in database","body":"<p>I'm using carrier wave, rails and amazon s3. Every time I save an image, the image shows up in s3 and I can see it in the management console with the name like this:</p>\n\n<p><code>https://s3.amazonaws.com/bucket-name/\nuploads/images/10/888fdcfdd6f0eeea_1351389576.png</code></p>\n\n<p>But in the model, the name is this:</p>\n\n<p><code>https://bucket-name.s3.amazonaws.com/\nuploads/images/10/b3ca26c2baa3b857_1351389576.png</code></p>\n\n<p>First off, why is the random name different? I am generating it in the uploader like so:</p>\n\n<pre><code>def filename\n  if original_filename\n    \"#{SecureRandom::hex(8)}_#{Time.now.to_i}#{File.extname(original_filename).downcase}\"\n  end\nend\n</code></pre>\n\n<p>I know it is not generating a random string every call because the wrong url in the model is consistent and saved. Somewhere in the process a new one must be getting generated to save in the model after the image name has been saved and sent to amazon s3. Strange.</p>\n\n<p>Also, can I have the url match the one in terms of s3/bucket instead of bucket.s3 without using a regex? Is there an option in carrierwave or something for that?</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":13149897,"title":"\"and return unless nil\" statement in Ruby","body":"<p>I have the following code:</p>\n\n<pre><code>def test\n  show_msg and return unless nil\n  puts \"This line can not be executed\"\nend\n\ndef show_msg\n puts \"exit here\"\nend\n\ntest\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>exit here\nThis line can not be executed\n</code></pre>\n\n<p>I expected the only on line:</p>\n\n<pre><code>exit here\n</code></pre>\n\n<p>Why?</p>\n"},{"tags":["ruby","thin","dotcloud"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":11700109,"title":"Thin on dotcloud","body":"<p>I have tried to install Thin on dotcloud, following the <a href=\"http://docs.dotcloud.com/tutorials/ruby/thin/\" rel=\"nofollow\">official document</a>, but i failed.<br>\n\"Thin:up...\" appears on the cli, but I can't see it running by opening the url of the webapp<br>\nP.S. I don't run thin with ruby workers, is it relevant?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147972,"title":"Pagination in Ruby when results fetched in a mySQL query","body":"<p>I fetch some rows in my Rails controller using the following query:</p>\n\n<pre><code>@main = connection.execute(\"SELECT code_ver, result FROM mastertest WHERE code_ver NOT LIKE '%DevBld%' AND date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\")\n</code></pre>\n\n<p>Now in my index.html.erb (View) I display these rows in form of a table.</p>\n\n<p>But I want to have next and previous buttons in my html page such that It should display only a few rows at a time. Lets assume a week's data at a time. </p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13149146,"title":"What is the best way to determine if a variable is a number in Ruby?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5661466/test-if-string-is-a-number-in-ruby-on-rails\">Test if string is a number in Ruby on Rails</a>  </p>\n</blockquote>\n\n\n\n<p>Currently I have this (awful) code:</p>\n\n<pre><code>def is_num(num_given)\n  begin\n    num_given.to_i\n    worked = true\n  rescue\n    worked = false\n  ensure\n    return worked\n  end\nend\n</code></pre>\n\n<p>Which I refactored to this:</p>\n\n<pre><code>def is_num(num_given)\n  num_given.to_i.is_a?(Numeric) rescue false\nend\n</code></pre>\n\n<p>This still just doesn't feel right to me, is there a better way to do this?</p>\n\n<p>Both of these implementations work fine for my purposes, I am just looking for some code euphoria. </p>\n"},{"tags":["ruby","irb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13149394,"title":"Why does a file object still exist after it's been closed in Ruby?","body":"<p>Is the object still in memory after it has been closed? If so, is that because garbage collection hasn't kicked in yet? It looks like it was just marked as deleted rather than actually being gone from memory. This was produced in IRB, if that could affect it at all.</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>1.9.3p125 :001 &gt; f = File.open(\"myfile.txt\", \"r\")\n=&gt; #&lt;File:myfile.txt&gt;     \n\n1.9.3p125 :002 &gt; f\n=&gt; #&lt;File:myfile.txt&gt;\n\n1.9.3p125 :002 &gt; f.size\n =&gt; 122 \n\n1.9.3p125 :003 &gt; f.close\n =&gt; nil \n\n1.9.3p125 :004 &gt; f\n =&gt; #&lt;File:myfile.txt (closed)&gt; \n</code></pre>\n"},{"tags":["ruby","file-io"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":18,"score":0,"question_id":13149090,"title":"Open a file with user input Ruby","body":"<p>I take a string variable from a user like this:</p>\n\n<pre><code>mail = gets\n</code></pre>\n\n<p>and I want to use this variable to open a file.</p>\n\n<pre><code>file = File.new(mail, \"r\") ##obviously this isn't working\n</code></pre>\n\n<p>How do I actually use this mail variable to open a file of that name?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","string","integer"],"answer_count":6,"favorite_count":0,"up_vote_count":11,"down_vote_count":0,"view_count":5512,"score":11,"question_id":5661466,"title":"Test if string is a number in Ruby on Rails","body":"<p>I have this in my application controller</p>\n\n<pre><code>def is_number?(object)\n  true if Float(object) rescue false\nend\n</code></pre>\n\n<p>and the following test in my controller</p>\n\n<pre><code>if mystring.is_number?\n\nend\n</code></pre>\n\n<p>It's throwing an undefined method error. I'm guessing I've defined is_number in the wrong place...?</p>\n"},{"tags":["ruby-on-rails","ruby","rubygems","gem"],"answer_count":5,"favorite_count":1,"up_vote_count":10,"down_vote_count":0,"view_count":11232,"score":10,"question_id":1954015,"title":"Installed Rails but the rails command says it's not installed","body":"<p>I'm using Ubuntu 9.10 Karmic Koala and Ruby 1.9.1.</p>\n\n<p>I installed Rails using <code>sudo gem install rails</code>, which installed all the libraries for me.</p>\n\n<p>When I type <code>rails</code> in the terminal it says.</p>\n\n<p>The program 'rails' is currently not installed.  You can install it by typing:\nsudo apt-get install rails\nrails: command not found</p>\n\n<p>I can find rake, which is under rake1.9.1, but Rails is nowhere to be found, can someone point me in the right direction?</p>\n\n<p>Edit: path to ruby isn't the problem, the problem is where is rails? how do I execute it? rails just doesn't work, where does the exectuable lives?</p>\n"},{"tags":["ruby-on-rails","ruby","rvm","zsh"],"answer_count":6,"favorite_count":5,"up_vote_count":15,"down_vote_count":0,"view_count":5258,"score":15,"question_id":7788946,"title":"Rails keeps telling me that it's not currently installed","body":"<p>I use <code>rvm</code> to manage different rubies and their gemsets. My shell is zsh with oh-my-zsh configured with basic settings. Enabled oh-my-zsh plugins are ruby, rails, osx, and git. Here's the command I used to install ruby-1.8.7 and rails-3.0.7.</p>\n\n<pre><code>rvm install 1.8.7\nrvm use 1.8.7\ngem install rails -v=3.0.7\n</code></pre>\n\n<p>and then I typed <code>rails</code> and got:</p>\n\n<pre><code>Rails is not currently installed on this system. To get the latest version, simply type:\n\n    $ sudo gem install rails\n\nYou can then rerun your \"rails\" command.\n</code></pre>\n\n<p>I've tried more thorough installs also, Like reinstall <code>rubygems</code> after switching to ruby-1.8.7, or create a completely new gemset, but with no luck.</p>\n\n<p>Here's the rvm info:</p>\n\n<pre><code>ruby-1.8.7-p352@rails:\n\n  system:\n    uname:       \"Darwin yicai.local 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:32:41 PDT 2011; root:xnu-1504.15.3~1/RELEASE_X86_64 x86_64\"\n    bash:        \"/bin/bash =&gt; GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin10.0)\"\n    zsh:         \"/bin/zsh =&gt; zsh 4.3.9 (i386-apple-darwin10.0)\"\n\n  rvm:\n    version:      \"rvm 1.8.6 by Wayne E. Seguin (wayneeseguin@gmail.com) [https://rvm.beginrescueend.com/]\"\n\n  ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.8.7\"\n    date:         \"2011-06-30\"\n    platform:     \"i686-darwin10.8.0\"\n    patchlevel:   \"2011-06-30 patchlevel 352\"\n    full_version: \"ruby 1.8.7 (2011-06-30 patchlevel 352) [i686-darwin10.8.0]\"\n\n  homes:\n    gem:          \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails\"\n    ruby:         \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352\"\n\n  binaries:\n    ruby:         \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin/ruby\"\n    irb:          \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin/irb\"\n    gem:          \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin/gem\"\n    rake:         \"/Users/nil/.rvm/bin/rake\"\n\n  environment:\n    PATH:         \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails/bin:/Users/nil/.rvm/gems/ruby-1.8.7-p352@global/bin:/Users/nil/.rvm/rubies/ruby-1.8.7-p352/bin:/Users/nil/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/sbin\"\n    GEM_HOME:     \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails\"\n    GEM_PATH:     \"/Users/nil/.rvm/gems/ruby-1.8.7-p352@rails:/Users/nil/.rvm/gems/ruby-1.8.7-p352@global\"\n    MY_RUBY_HOME: \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352\"\n    IRBRC:        \"/Users/nil/.rvm/rubies/ruby-1.8.7-p352/.irbrc\"\n    RUBYOPT:      \"\"\n    gemset:       \"rails\"\n</code></pre>\n\n<p>and the gem version is 1.8.10, the latest.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13149141,"title":"Ruby on rails tests keep giving me errors","body":"<p>I am making a simple social network with Ruby on Rails. I wanted to add a restriction of certain characters for the profile name when signing up. So, in my User.rb file, I have the following:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me,\n                  :first_name, :last_name, :profile_name\n  # attr_accessible :title, :body\n\n  validates :first_name, presence: true\n  validates :last_name, presence: true\n\n  validates :profile_name, presence: true,\n                           uniqueness: true,\n                           format: {\n                             with: /^[a-zA-Z0-9_-]+$/,\n                             message: \"must be formatted correctly.\"\n                           }\n  has_many :statuses\n\n  def full_name\n    first_name + \" \" + last_name\n  end\nend\n</code></pre>\n\n<p>I set up a test to validate that it works, and this is what the test is:</p>\n\n<pre><code>test \"user can have a correctly formatted profile name\" do\nuser = User.new(first_name: '******', last_name: '****', email: '********@gmail.com')\nuser.password = user.password_confirmation = '**********'\nuser.profile_name = '******'\nassert user.valid?\n</code></pre>\n\n<p>end</p>\n\n<p>When I run the test, I keep getting the error saying that something is wrong with my <code>assert user.valid?</code> line. So I am thinking I messed up some syntax in my <code>with: /^[a-zA-Z0-9_-]+$/</code>.</p>\n\n<p>The error I am getting is <code>1) Failure:\ntest_user_can_have_a_correctly_formatted_profile_name(UserTest) [test/unit/user_test.rb:40]:</code></p>\n\n<p>But on line 40, it has this piece of code <code>assert user.valid?</code></p>\n\n<p>Any help is appreciated :)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13149257,"title":"Ruby on Rails: polymorphic association with has_one/belongs_to","body":"<p>In my app I setup the M-N relation between the Item and Property models by using a join model PropertyValuations. Now, in the relation between an item and a property there will exist a value. However, I want that value to be stored a different table (NumericValue, TextualValue, etc).\nIs a polymorphic association a good approach for this?</p>\n\n<p>The idea would be to have something like this:</p>\n\n<pre><code>class PropertyValuation &lt; ActiveRecord::Base\n  attr_accessible :valuable\n  attr_accessor :valuable\n\n  belongs_to :property\n  belongs_to :item\n  belongs_to :valuable, :polymorphic =&gt; true  \nend\n\nclass NumericValue &lt; ActiveRecord::Base\n  attr_accessible :value # plus several other fields\n  has_one :property_valuation, :as =&gt; :valuable  \nend\n\nclass TextualValue &lt; ActiveRecord::Base\n  attr_accessible :value  \n  has_one :property_valuation, :as =&gt; :valuable\nend\n</code></pre>\n\n<p>However, this way I can only associate a value to a property_valuation record if I create the value first (where I was expecting to do something like <code>property_valuation.valuable = NumericValue.new(:value =&gt; 12345)</code>), and to obtain the value I can't use <code>property_valuation.valuable</code>, as it will return nil (even if valuable_id and valuable_type on property_valuation table are filled).\nWhat can I improve in my code to make everything work as expected? My migrations look like this:</p>\n\n<pre><code>class CreatePropertyValuations &lt; ActiveRecord::Migration\n  def change\n    create_table :property_valuations do |t|\n      t.references :item\n      t.references :property\n      t.references :valuable, :polymorphic =&gt; true\n\n      t.timestamps\n    end\n    add_index :property_valuations, :item_id\n    add_index :property_valuations, :property_id\n    add_index :property_valuations, :valuable_id\n  end\nend\n\nclass CreateNumericValues &lt; ActiveRecord::Migration\n  def change\n    create_table :numeric_values do |t|\n      t.decimal :value\n      t.references :property_valuation\n\n      t.timestamps\n    end\n  end\nend\n\n\nclass CreateTextualValues &lt; ActiveRecord::Migration\n  def change\n    create_table :textual_values do |t|\n      t.text :value\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["javascript","ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":13148888,"title":"How to get the current time as 13-digit integer in Ruby?","body":"<p>I have this jQuery function that returns the current time as a <strong>13-digit</strong> integer:</p>\n\n<pre><code>time = new Date().getTime();\n</code></pre>\n\n<p>Is there a way to do the same in Ruby?</p>\n\n<p>Right now, I am using Ruby's <code>Time.now.to_i</code> which works great but returns a <strong>10-digit</strong> integer.</p>\n\n<p>How can I get it to display <strong>13</strong> integers as in jQuery?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1720,"score":2,"question_id":1519413,"title":"Extend model in plugin with \"has_many\" using a module","body":"<p>I have a some code in an engine style plugin which includes some models. In my app I want to extend one of these models. I have managed to add both instance and class methods to the model in question by including a module from within an initializer. </p>\n\n<p>However I cannot seem to add associations, callbacks etc. I get a 'method not found' error.</p>\n\n<p>/libs/qwerty/core.rb</p>\n\n<pre><code>module Qwerty\n  module Core\n    module Extensions\n\n      module User\n        # Instance Methods Go Here \n\n        # Class Methods\n        module ClassMethods\n          has_many  :hits, :uniq =&gt; true # no method found\n\n          before_validation_on_create :generate_code # no method found\n\n          def something # works!\n            \"something\"\n          end\n        end\n\n        def self.included(base)\n          base.extend(ClassMethods)\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>/initializers/qwerty.rb</p>\n\n<pre><code>require 'qwerty/core/user'\n\nUser.send :include, Qwerty::Core::Extensions::User\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","controller","models"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13148793,"title":"Use models for specific actions on Rails?","body":"<p>I'm pretty new on RoR, and I having a hard time to figure out when to use a controller or something else, like a model for specific situations that implies business logic.</p>\n\n<p>Figure that I have a Post model that have a method to share it on Twitter, like this one:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  def send_to_twitter!\n    Twitter.update(\"#{self.title} #{self.url}\")\n  end\nend\n</code></pre>\n\n<p>And then, somewhere I have this:</p>\n\n<pre><code>Post.find(9).send_to_twitter!\n</code></pre>\n\n<p>I'm not supposed to do this, since I have business logic on a model and theoretically it's not allowed (from what I know). But it's the simplest way to do this kind of tasks.</p>\n\n<p>My question is, is this the right way to do it? <strong>Is there any better way?</strong>\nThanks!</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","loops"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13129194,"title":"Ruby include check and iteration","body":"<p>I have an array:</p>\n\n<pre><code>art_groups_arr = []\n</code></pre>\n\n<p>I'm getting it from:</p>\n\n<pre><code>art_groups_arr &lt;&lt; a.art_name (in loop)\n</code></pre>\n\n<p>When I try to check for inclusion, I get <code>can't convert Array into String</code></p>\n\n<p>I tried:</p>\n\n<pre><code>n2.art_group.include?(art_groups_arr.map { |e| e})\n</code></pre>\n\n<p>In my view my array looks like:</p>\n\n<pre><code>[\"Амортизатор\", \"Защитный колпак / пыльник, амортизатор\"]\n</code></pre>\n\n<p>How can I correctly loop and check <code>include?</code>?</p>\n"},{"tags":["ruby","arrays","hash","find"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13147810,"title":"Ruby Finding Something in an Array of Hashes","body":"<p>I am trying to learn Ruby and I have the following code</p>\n\n<pre><code> a[0]={ :artist =&gt; 'Green Day',\n                          :name =&gt; 'Song1',\n                                                   :bitrate =&gt; 192 }\n a[1]={ :artist =&gt; 'U2', :name =&gt; 'Song2' }\n a[2]={:artist =&gt; 'Metallica', :name =&gt; 'Battery' }\n</code></pre>\n\n<p>My question is how do I find in such an array all the songs by Metallica, for example? Thank you! :)</p>\n\n<p>Edit: Ok, another newbie question? How can I find the songs that contain a certain sequence in their titles?</p>\n\n<p>I tried:</p>\n\n<pre><code>a.find { |x| x[:song].include? 'Song' }\n</code></pre>\n\n<p>but it returns an error.</p>\n"},{"tags":["ruby-on-rails","ruby","class","variables"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":47,"score":-1,"question_id":13148587,"title":"How to create variables in class methods in ruby?","body":"<p>I'm working on a project and I came up with a problem. I have the following code:</p>\n\n<pre><code>text.lines.map(&amp;:chomp) do |line|\n  @@movies ||= []\n  @@movies &lt;&lt; Movie.new(line)\nend\nCollection.new(@@songs)\n</code></pre>\n\n<p>I was wondering if there is a way to make this code more Ruby-like? I want to pass a list to the new method of the collection class. The implementation details (I'm parsing a text in a specific format from a file) are irrelevant. My question is regarding the class variable and whether or not should I use it (I'll have more than one collection with different texts to parse).\nThank you.</p>\n"},{"tags":["ruby","prawn"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13071344,"title":"Graphics with Prawn","body":"<p>Looking to a gem that adds gtraphing capabilities to prawn, I found <a href=\"https://github.com/HHRy/prawn-graph/\" rel=\"nofollow\">this one</a> but it seems a litle outdated. Is there any more active gem for that?</p>\n"},{"tags":["ruby","redirect","action","render"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13148160,"title":"Ruby on Rails - Redirect/render via action does not work","body":"<p>I have the following code:</p>\n\n<pre><code>def isLoggedIn\n    if session[:username].nil?\n      puts \"Not logged in!\"\n      return render :controller=&gt;\"admin\", :action=&gt;\"login\"\n    end\n  end\n</code></pre>\n\n<p>And the following code which calls this action at the top to check the status of the user. </p>\n\n<pre><code>def view_gallery\n    isLoggedIn\n       .\n       .\n       .\n       .\n      \\/\n    return render \"view_gallery\"\n  end\n</code></pre>\n\n<p>The problem I am having is that the code continues to execute past isLoggedIn although the console is logging \"Not logged in!\" because as expected the user isn't logged in. This should then render an alternative layout which it doesn't do. If I mispell the action (say \"logib\") then it complains about a missing template - so I can see it running the render function.</p>\n\n<p>The same occurs if I change render to redirect_to and/or if I move the return statement to the end of the line.</p>\n\n<p>Any idea's?</p>\n\n<p>Many thanks</p>\n"},{"tags":["ruby","windows","shell"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":53,"score":4,"question_id":13146056,"title":"ruby Inject a keystroke in windows shell","body":"<p>IS there a way in ruby I can inject a keystroke in shell to have the program go? I need to run a program in shell through</p>\n\n<pre><code>sh \" #{another program}\"\n</code></pre>\n\n<p>And there is a \n\"Press any key to continue\" at the end of the program. How can I make it move on ?</p>\n\n<p>Is there something similar in ruby like java</p>\n\n<p><a href=\"http://alvinalexander.com/java/java-robot-class-example-mouse-keystroke\" rel=\"nofollow\">http://alvinalexander.com/java/java-robot-class-example-mouse-keystroke</a></p>\n"},{"tags":["mysql","ruby","database","innodb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13147395,"title":"Mysql InnoDB and quickly applying large updates","body":"<p>Basically my problem is that I have a large table of about 17,000,000 products that I need to apply a bunch of updates to really quickly. </p>\n\n<p>The table has 30 columns with the id set as int(10) AUTO_INCREMENT.</p>\n\n<p>I have another table which all of the updates for this table are stored in, these updates have to be pre-calculated as they take a couple of days to calculate. This table is in the format of [ product_id int(10), update_value int(10) ].</p>\n\n<p>The strategy I'm taking to issue these 17 million updates quickly is to load all of these updates into memory in a ruby script and group them in a hash of arrays so that each update_value is a key and each array is a list of sorted product_id's.</p>\n\n<pre><code>{ \n   150: =&gt; [1,2,3,4,5,6],\n   160: =&gt; [7,8,9,10]\n}\n</code></pre>\n\n<p>Updates are then issued in the format of</p>\n\n<pre><code>UPDATE product SET update_value = 150 WHERE product_id IN (1,2,3,4,5,6);\nUPDATE product SET update_value = 160 WHERE product_id IN (7,8,9,10);\n</code></pre>\n\n<p>I'm pretty sure I'm doing this correctly in the sense that issuing the updates on sorted batches of product_id's should be the optimal way to do it with mysql / innodb.</p>\n\n<p>I'm hitting a weird issue though where when I was testing with updating ~13 million records, this only took around 45 minutes. Now I'm testing with more data, ~17 million records and the updates are taking closer to 120 minutes. I would have expected some sort of speed decrease here but not to the degree that I'm seeing.</p>\n\n<p>Any advice on how I can speed this up or what could be slowing me down with this larger record set? </p>\n\n<p>As far as server specs go they're pretty good, heaps of memory / cpu, the whole DB should fit into memory with plenty of room to grow.</p>\n"},{"tags":["ruby","watir"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13141035,"title":"Determine the amount of clicks required to reach a specific date using a JQuery calendar?","body":"<p>I have a jquery calendar for the start date of a project.</p>\n\n<p>Using Watir (automated browser driver, a gem for ruby), I have a set date that I would like to enter in.</p>\n\n<p>The calendar start date is always today's date, whatever that may be for the day it is used.  I was wondering if there was a way that ruby can process what today's date is, and use the specified date provided by the user, to calculate the difference of months between them. </p>\n\n<p>Here is an example of the Calendar plugin: <a href=\"http://jqueryui.com/datepicker/\" rel=\"nofollow\">http://jqueryui.com/datepicker/</a></p>\n\n<p>example:</p>\n\n<p>today's date is 30/10/2012, if there was a project that were to start on the 20/12/2012, that would be 2 months from now, so 2 clicks on the next month button.  </p>\n\n<p>Is there a way I could do this? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","actionview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13147000,"title":"Get actual object Rails","body":"<p>I have two forms in my new view, one is for the product and the other is for fotos. \nWhen I upload the fotos with a select.file field, these are created by Ajax call by a file create.js.erb then when I fill the others fields to the product I've another button to create it. So I have two forms and one way to create each one.</p>\n\n<p>The problem is the ID, the solution that I've found was to create an object before the user enter to the new view, so I have this code:</p>\n\n<p>Product's controller:</p>\n\n<pre><code>def new\n      @product = current_user.products.create\nend\n</code></pre>\n\n<p>It creates an object nil, now I can create my Foto to that object, like this:</p>\n\n<p>Painting's controller:</p>\n\n<pre><code>def create\n   @product = Product.last\n   @painting = @product.paintings.create(params[:painting])\nend\n</code></pre>\n\n<p>The problem is the line \"@product = Product.last\", I know that it isn't the right solution, because when I try the edit action, and when I try to create new objects it goes to the last product and not to the actual edit product.</p>\n\n<p>How can I find that current product at my new action???</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["ruby","redirect","sinatra"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13112370,"title":"change sinatras base url for redirects","body":"<p>if I use <code>redirect to(\"/\")</code> in my sinatra app it alwasy redirects me to localhost. But I wan't it to redirect to my domain. How do I set the domain?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147403,"title":"Accessing HTML tags in a RUBY Controller","body":"<p>I have the following code in my HTML.erb</p>\n\n<pre><code>&lt;form&gt;\n   &lt;input id=\"do\" type=\"hidden\" value=\"0\" /&gt;\n   &lt;button type=\"submit\" value=\"Next\"&gt;SUBTRACT&lt;/button&gt;\n&lt;/form&gt;\n&lt;form&gt;\n  &lt;input id=\"do\" type=\"hidden\" value=\"1\" /&gt;\n  &lt;button type=\"submit\" value=\"Next\" &gt;ADD&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Now When I click the any of the 2 buttons, I want to check the value of the input id=\"do\" inside my Ruby Controller. What would the syntax look like ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":20,"score":4,"question_id":13147277,"title":"Rails: path of file","body":"<p>I have inside <code>app</code> a directory called <code>csv</code> and inside this dir I have a file called <code>names.csv</code>\nI want to use <code>File.read(path:string)</code> function to read the file.<br>\nwhat is the relative path to the file?  </p>\n"},{"tags":["asp.net","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13146403,"title":"getting asp.net search results from within a program?","body":"<p>I have a Ruby program that parses HTML data generated by an asp.net page at a government site over which I have no control.  I currently submit a query at the asp.net page by going to the page and clicking \"submit\", then saving the results (which is the file that the Ruby program parses).  Is there any way to trigger the submit from within my Ruby program, so I don't have to manually do that every time?</p>\n\n<p>In case it's useful, this is the address I go to and click \"submit\" and then save:</p>\n\n<p><a href=\"http://www.deq.state.or.us/wq/sisdata/facilitycriteria.asp\" rel=\"nofollow\">http://www.deq.state.or.us/wq/sisdata/facilitycriteria.asp</a></p>\n\n<p>Actually, before saving I click \"Show All Records\" at the results page (http://www.deq.state.or.us/wq/sisdata/facilitylist.asp), so I'd need to figure out how to trigger that from within my program as well, but I figure if there's a way to to the \"submit\" then there's probably a similar way to do the \"Show All Records.\"</p>\n\n<p>Thanks. </p>\n"},{"tags":["ruby","coding-style","namespaces","scope"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":45,"score":0,"question_id":13146910,"title":"For deep namespaces in ruby, how best to manage coding style and scope operator annoyances?","body":"<p>I find myself fighting deep namespaces (>= depth of 4), even when they logically make sense so to avoid some annoyances they cause. </p>\n\n<p>To start, I like my code to fit nicely in the text editor window without it having to be overly wide. Though ruby conventional indent of 2 sp definitely helps, that pushes me to use the scope operator to avoid all the nested indents. But on the otherhand, using the scope operator brings its own set of problems...</p>\n\n<p>First, to use constants somewhere upstream in the current namespace context, you have to use the full namespace of that constant for Ruby to find it. And since when I use the scope operator, the namespace depth is deep, it gets very long to reference constants and classes.</p>\n\n<pre><code>require 'a/b'\nclass A::B::C\n  FOO = 'hi'\nend\nclass A::B::C::D\n  # FOO # can't do this. raises NameError: uninitialized constant; would work fine if classes used nested format, but then the extra indent makes for wide code.\n  A::B::C::FOO # must use full reference when using scopes, ugh. Depending on the real names of A,B,C, this could be rather long as well.\nend\n</code></pre>\n\n<p>Second, I run into a situation where I have to require files after my class definitions, which I prefer not to do (I like my require statements at the top), like so.</p>\n\n<pre><code># File: a/b/c.rb\nrequire 'a/b'\n# require 'a/b/c/d' # can't put it here, otherwise you get uninitialize const A::B::C when a/b/c/d.rb is getting interpreted.\nclass A::B::C\n  def initialize\n    @d = A::B::C::D.new \n  end\nend\nrequire 'a/b/c/d' # it bothers me putting requires anywhere but at the top\n\n# File: a/b/c/d.rb\nrequire 'a/b/c'\nclass A::B::C::D\nend\n</code></pre>\n\n<p>Something has got to give. Maybe I just need to give in and widen my editor and stick with nesting or maybe I'm not understanding how best to work in the context of a namespace using the scope operator.</p>\n\n<p>Does anyone have any recommendations on how I should handle deep namespaces which manages these problems? \n 1. keep code width down by minimizing indents\n 2. be able to reference constants with just the constant name (FOO) when the constant is defined upstream of the current context\n 3. keep all the require statements at the top of source code files</p>\n"},{"tags":["ruby","scraperwiki"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":15,"score":-2,"question_id":13146757,"title":"scraperwiki: ruby not print data when the scraper is running","body":"<p>I can't stop scraperwiki to print data in the 'data' tab during running.</p>\n\n<p>I can't manage to set <code>verbose=0</code> when I use the <code>scraperwiki::save_sqlite</code> function.</p>\n\n<p>Does anybody know how to help me?</p>\n"},{"tags":["ruby-on-rails","ruby","parsing","partials"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13142076,"title":"ruby rails print specific elements from multiple partial files residing in a direcotry","body":"<p>I have a directory filled with partials.  I'm looking to list ONLY the first h1 tags in each partial.  The methods to accomplish this task could probably be modified to grab other elements as well.</p>\n\n<p>Right now I use ruby to open each file, print out the first few characters, close file, and repeat.  My ruby file parsing skills are limiting me.  Here's the code I have at the moment:</p>\n\n<pre><code>    &lt;% Dir[\"app/views/partials/show/*.html.erb\"].each do |f1| %&gt;\n        &lt;% aFile = File.open(f1, \"r\") %&gt;\n        &lt;% if aFile %&gt;\n            &lt;% content = aFile.sysread(20) %&gt;\n            &lt;p&gt;&lt;%= content %&gt;&lt;/p&gt;\n        &lt;% else %&gt;\n            &lt;%= \"Unable to open file!\" %&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I also think I'm opening the entire partial in memory?  Wondering If I can just read up until I find my h1 tag then close file and move on?  Again I'm only reading first 20 characters because I haven't yet grasped a way to search for the first h1 tag.</p>\n\n<p>I'll make edits as I work through the open, parse, piece... I appreciate any guidance and direction you can offer. Thanks!</p>\n\n<p><strong>EDIT:</strong>\nBased on comments below there may be a far better way to accomplish my task.  So I'm providing some additional background to get direction on other solutions.</p>\n\n<p>This is for a slide show based on partials in a directory.  The slide show is controlled with a navigation element  which I would like to populate by the h1 tags in the partials.  I'm not going to manually enter these things every time a change is made!  I want the end user to simply drag and drop partials into a directory (with a certain name convention and h1 tag description for navigation) and let the slide show do everything else.</p>\n\n<p>I could impose a class on the h1 tag \"forNavigation\" and on the content \"sliderContent\" and then use jquery to create a post load <code>&lt;ul&gt;</code> but that doesn't seem right.  Plus they'll all be part of the same rendered div.</p>\n\n<p>I guess I'm not clear why reading the first 50 characters of a partial, copying whats in the h1 tags, and putting it in a  isn't the most elegant solution?</p>\n\n<p>Like I said, above does everything needed except copy and print whats between the first h1 tag... With an xml parser or some regexp it'll be done.  I'm just no good with parsing files.</p>\n\n<p>Please let me know other methods to approach this.  Right now I still think it's best to parse the partial (with or without rendering) and put what I need where I want it as needed.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":132,"score":6,"question_id":13008922,"title":"Testing Response cookie with Rspec v.1","body":"<p>When I login to my app the server sends me back cookies(credentials and some app's cookie):</p>\n\n<pre><code>Response sent 170 bytes of Cookie data:\n Set-Cookie: user_credentials=val; path=/; HttpOnly; Secure\n\nResponse sent 554 bytes of Cookie data:\n Set-Cookie: _app_session=otherVal; path=/; HttpOnly; Secure\n</code></pre>\n\n<p>...and then redirects to the home page;</p>\n\n<p>Cookies include some flags: e.g. <code>httpOnly</code>, <code>Secure</code>, etc.</p>\n\n<p>How can I test whether cookies do include those flags with Rspec?</p>\n\n<p>At least where can I find those cookies?</p>\n\n<pre><code>it \"should generate cookies with proper flags\" do    \n    params = Factory.attributes_for(:user,\n      :username =&gt; \"uname\",\n      :password =&gt; \"upass\"\n    )\n    # login\n    post 'create', params\n\n    response.should redirect_to home_url # =&gt; pass\n\n    puts \"response cookie = #{response.cookies.inspect}\" # =&gt; {} // no cookies in response, why?\nend\n</code></pre>\n"},{"tags":["mysql","ruby","orm","relational-database","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13144198,"title":"DataMapper can't delete record because of relation","body":"<p>I have this many-many DataMapper/MySQL setup with Torrent and Tag, as follows:</p>\n\n<pre><code>class Torrent\n  include DataMapper::Resource\n\n  property :id,          Serial\n  property :name,        String\n  property :magnet,      Text\n  property :created_at,  DateTime\n\n  has n, :tags, :through =&gt; Resource\nend\n\nclass Tag\n  include DataMapper::Resource\n\n  property :id,      Serial\n  property :name,    String\n  property :hits,    Integer\n\n  has n, :torrents, :through =&gt; Resource\nend\n</code></pre>\n\n<p>When trying to destroy a torrent, however, via <code>Torrent.first.destroy</code> or something similar, DataMapper returns <code>false</code>.</p>\n\n<p>I tried straight SQL queries like <code>delete from torrents where name like '%ubuntu%'</code>, which failed because of MySQL error 1451:</p>\n\n<pre><code>ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`brightswipe`.`tag_torrents`, CONSTRAINT `tag_torrents_torrent_fk` FOREIGN KEY (`torrent_id`) REFERENCES `torrents` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION)\n</code></pre>\n\n<p>I figure there's some DataMapper setup whereby when deleting a torrent I can:</p>\n\n<ol>\n<li>Remove the tag associations</li>\n<li>Delete the torrent</li>\n</ol>\n\n<p>And when deleting a tag I can:</p>\n\n<ol>\n<li>Remove the tag association from all torrents with that tag</li>\n<li>Delete the tag</li>\n</ol>\n\n<p>How can I go about this?</p>\n"},{"tags":["ruby-on-rails","ruby","module","forem"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13146303,"title":"Ruby - How to access module's methods?","body":"<p>I'm installing a forum using the Forem gem. There's an option that allows avatar personalization, since it's possible to login with Facebook. You just specify your method in the User model and that's it.</p>\n\n<pre><code># Forem initializer\nForem.avatar_user_method = 'forem_avatar'\n\n# User model\ndef forem_avatar\n  unless self.user_pic.empty?\n    self.user_pic\n  end\nend\n</code></pre>\n\n<p>But I want a fallback on Gravatar for normal, non-facebook accounts. <a href=\"https://github.com/radar/forem/blob/master/app/helpers/forem/posts_helper.rb\" rel=\"nofollow\">I've found the method on Forem</a> and in theory, I need to call the <code>avatar_url</code> method:</p>\n\n<pre><code># User model\ndef forem_avatar\n  unless self.user_pic.empty?\n    self.user_pic\n  else\n    Forem::PostsHelper.avatar_url self.email\n  end\nend\n</code></pre>\n\n<p>However, Forem isn't an instance, but a module and I can't call it nor create a new instance. The easy way is to copy the lines of that method, but that's not the point. Is there a way to do it?</p>\n\n<p>Thanks</p>\n\n<h1>Update</h1>\n\n<p>Both answers are correct, but when I call the method either way, there's this <code>undefined local variable or method 'request'</code> error, which is the last line of the original <code>avatar_url</code>.   </p>\n\n<p>Is there a way  to globalize that object like in PHP? Do I have to manually pass it that argument?</p>\n"},{"tags":["ruby-on-rails","ruby","map","gsub"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":38,"score":1,"question_id":13146774,"title":"Add plus before first symbol in word in string and * after last","body":"<p>I have such string:</p>\n\n<pre><code>Тормозные диски\n</code></pre>\n\n<p>How can i transform it into </p>\n\n<pre><code>+Тормозн* +дис*\n</code></pre>\n\n<p>Now with help of SO i use gsub, but some people say that it could be done via map. But how? \nNote: main trouble is that i have cyrillic symbols... </p>\n\n<p>now:</p>\n\n<pre><code>art_group_search = art_group.gsub(/\\b(\\w+?)\\w{0,2}\\b/, '+\\1*').mb_chars.upcase.to_s\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","postgresql","heroku"],"answer_count":1,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":98,"score":7,"question_id":13145988,"title":"Will UUID as primary key in PostgreSQL give bad index performance?","body":"<p>I have created an app in Rails on Heroku using a PostgreSQL database.</p>\n\n<p>It has a couple of tables designed to be able to sync with mobile devices where data can be created on different places. Therefor I have a uuid field that is a string storing a GUID in addition to an auto increment primary key. The uuid is the one that is communicated between the server and the clients.</p>\n\n<p>I realised after implementing the sync engine on the server side that this leads to performance issues when needing to map between uuid&lt;->id all the time (when writing objects, I need to query for the uuid to get the id before saving and the opposite when sending back data).</p>\n\n<p>I'm now thinking about switching to only using UUID as primary key making the writing and reading much simpler and faster.</p>\n\n<p>I've read that UUID as primary key can sometimes give bad index performance (index fragmentation) when using clustered primary key index. Does PostgreSQL suffer from this problem or is it OK to use UUID as primary key?</p>\n\n<p>I already have a UUID column today so storage wise it will be better because I drop the regular id column.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13146266,"title":"initialized constant <name of my class> (NameError)","body":"<p>here's the CRUD class that's responsible for interacting with the XML file. </p>\n\n<pre><code>require \"rexml/document\"\ninclude REXML  \n\nclass Crud\n  @users = Array.new()\n  def self.get_allusers()\n    xmlfile = File.new(\"Users.xml\")\n    doc = Document.new(xmlfile)\n       XPath.each( doc, \"//user\") do |e|\n         user = {:id =&gt; e.element['id'], :firstname =&gt; e.element['firstname'], :lastname =&gt; e.element['lastname']}\n         @users &lt;&lt; user     \n       end\n    end\n  end\n</code></pre>\n\n<p>And this is how I am trying to access the method from a different file.</p>\n\n<pre><code>users = Crud.new()\nputs users.get_allusers()\n</code></pre>\n\n<p>I'm getting the following error: <strong>\"initialized constant Crud (NameError)\"</strong>. And I have no idea what that means. Because I've also tried to access the method this way:</p>\n\n<pre><code>puts Crud.get_allusers()\n</code></pre>\n\n<p>What's wrong with the code? What am I supposed to initialize?</p>\n\n<p>Thanks for helping.</p>\n"},{"tags":["html","ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13146035,"title":"Changing value of Ruby Variable in Html.erb","body":"<p>I have the following code in my controller: </p>\n\n<pre><code>class TestController &lt; ApplicationController\n\n@@a = 1\n\ndef index\n    @temp = connection.execute(\"select test_id from mastertest limit #{@@a}, 5;\")\nend\n</code></pre>\n\n<p>And I have the following code in my View(Html.erb) File:</p>\n\n<pre><code>&lt;button type=\"submit\" value=\"Next\" form=\"submit_form\"&gt;NEXT&lt;/button&gt;\n&lt;form id=\"submit_form\"&gt;\n&lt;% @@a = @@a + 1 %&gt;\n    &lt;table&gt;\n      &lt;% @temp.each do |row| %&gt;\n        &lt;tr&gt;&lt;td&gt;&lt;%= row[0] %&gt;&lt;/td&gt;&lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>So basically I am trying to change the value of the class variable @@a on clicking the Next button. But it does not change the value of @@aa. Can someone help me how to do that.</p>\n"},{"tags":["ruby-on-rails","ruby","autocomplete","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":17,"score":2,"question_id":13146095,"title":"Mongoid fill out referenced ids","body":"<p>I'm building an autocomplete feature for my rails app. The input form makes an ajax call on keypress which then calls this search method in rails</p>\n\n<pre><code>def search\n    search = Regexp.new(params[:name])\n    @users = User.where(:name=&gt;search)\n\n    render :json =&gt; @users\n  end\n</code></pre>\n\n<p>All works fine... However, the user has a bunch of fields that are foreign keys to other collections.</p>\n\n<p>For example, one of these fields is for rolify. <code>role_ids</code> which looks like <code>\"role_ids\" : [ObjectId(\"508eee5afa0d00b818000001\"), ObjectId(\"508eee92fa0d00b818000002\")]</code> which each map to something like <code>administrator</code> or <code>moderator</code></p>\n\n<p>What I want to do is replace these ids with the actual document from the roles collection. I know I can just manually fill it out, but I was hoping that there would be some way with Mongoid to automatically populate.</p>\n"},{"tags":["python","ruby","pypy"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":60,"score":3,"question_id":13145871,"title":"Calling Python from Ruby - PyPy compatibility","body":"<p>I'm looking to call Python code from Ruby. There are a few existing tools to do this and a few questions on this site recommending <a href=\"http://rubypython.rubyforge.org/\" rel=\"nofollow\">http://rubypython.rubyforge.org/</a>, which works by embedding the Python interpreter in Ruby. I'm working on an app that uses libraries unique to Python (namely graph-tool, which I have reasons for using over, say RGL), but the final project is in Rails so having Ruby code do the controlling work would be ideal. I want it to be speedy so I'm using PyPy. Is there a way to get the PyPy interpreter embedded in Ruby code, or to make the Python interpreter in <code>rubypython</code> run PyPy?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13145696,"title":"Ruby on Rails : add a new route","body":"<p>I'm new with RoR so this is a newbie question:<br>\nif I have a controller <code>users_controller.rb</code> and I add a method <code>foo</code>, shouldn't it create this route?  </p>\n\n<blockquote>\n  <p><a href=\"http://www.localhost:3000/users/foo\" rel=\"nofollow\">http://www.localhost:3000/users/foo</a></p>\n</blockquote>\n\n<p>because when I did that, I got this error:  </p>\n\n<blockquote>\n  <p>Couldn't find User with id=foo</p>\n</blockquote>\n\n<p>I of course added a view <code>foo.html.erb</code></p>\n\n<p><strong>EDIT:</strong><br>\nI added to <code>routes.rb</code> this code but I get the same error:</p>\n\n<pre><code>resources :users do\n    get \"signup\"\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rexml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13145888,"title":"Getting the XML ID using REXML","body":"<p>I have an XML response as included below. How can I obtain the  element?</p>\n\n<p>In rails I have:</p>\n\n<pre><code>xml = REXML::Document.new(contacts_as_xml)\nRails.logger.info xml[1].attributes[\"id\"] \n</code></pre>\n\n<p>Which is not returning 'user@company.com'</p>\n\n<p>Thanks</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;\n&lt;feed xmlns=\"http://www.w3.org/2005/Atom\" xmlns:openSearch=\"http://a9.com/-/spec/opensearch/1.1/\" xmlns:gContact=\"http://schemas.google.com/contact/2008\" xmlns:batch=\"http://schemas.google.com/gdata/batch\" xmlns:gd=\"http://schemas.google.com/g/2005\" gd:etag=\"W/&amp;quot;Ck8BQ38yfyt7I2A9WhNSFk8.&amp;quot;\"&gt;\n    &lt;id&gt;user@company.com&lt;/id&gt;\n    &lt;updated&gt;2012-10-30T18:14:12.197Z&lt;/updated&gt;\n    &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n    &lt;title&gt;Users's Contacts&lt;/title&gt;\n    &lt;link rel=\"alternate\" type=\"text/html\" href=\"http://www.google.com/\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#feed\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#post\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#batch\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/batch\" /&gt;\n    &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full?max-results=10000\" /&gt;\n    &lt;author&gt;\n        &lt;name&gt;User Howdy&lt;/name&gt;\n        &lt;email&gt;user@company.com&lt;/email&gt;\n    &lt;/author&gt;\n    &lt;generator version=\"1.0\" uri=\"http://www.google.com/m8/feeds\"&gt;Contacts&lt;/generator&gt;\n    &lt;openSearch:totalResults&gt;2&lt;/openSearch:totalResults&gt;\n    &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;\n    &lt;openSearch:itemsPerPage&gt;10000&lt;/openSearch:itemsPerPage&gt;\n    &lt;entry gd:etag=\"&amp;quot;QXc5eDVSLit7I2A9WhdSFk8PTgU.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/970a99881a51f3&lt;/id&gt;\n        &lt;updated&gt;2011-07-25T20:31:50.920Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2011-07-25T20:31:50.920Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;Jon Paris&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/970a99881a51f3\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;gd:name&gt;\n            &lt;gd:fullName&gt;Jon Adams&lt;/gd:fullName&gt;\n            &lt;gd:givenName&gt;Jon&lt;/gd:givenName&gt;\n            &lt;gd:familyName&gt;Adams&lt;/gd:familyName&gt;\n        &lt;/gd:name&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"jon@adams.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"jon@adams.com\" /&gt;\n    &lt;/entry&gt;\n    &lt;entry gd:etag=\"&amp;quot;R3YzcTFbKit7I2A9WhJbE00ORQY.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/1229b5e8eeef3e3&lt;/id&gt;\n        &lt;updated&gt;2012-09-22T08:57:06.889Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2012-09-22T08:57:06.889Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/1229b5e8eeef3e3\" gd:etag=\"&amp;quot;UQZOJlcjWit7I2BmGBdVTzBfL2E2GGI5Myk.&amp;quot;\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"person@site.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"person@gmail.com\" /&gt;\n    &lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","load","require"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13146025,"title":"Ruby `require` doesn't find my file in rails lib","body":"<p>I'm trying to load a file from my rails 'lib' dir, but I get the error:</p>\n\n<pre><code>LoadError: cannot load such file -- lib/ss.rb\n</code></pre>\n\n<p>This is odd because in the console:</p>\n\n<pre><code>File::exist? 'lib/ss.rb' # =&gt; true\nload 'lib/ss.rb' # =&gt; true\nrequire 'lib/ss.rb' # =&gt; LoadError\n</code></pre>\n\n<p>What's more, this file should be auto-loading on start because in my application.rb file, I uncommented the line:</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>Can anyone give me insight?</p>\n"},{"tags":["ruby","exception-handling"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13145834,"title":"Errno::ETIMEDOUT not being caught by SystemCallError","body":"<p>I have a section of code in Ruby 1.8.7</p>\n\n<pre><code> rescue SystemCallError \n</code></pre>\n\n<p>But the program occasionally exits with <code>Errno::ETIMEDOUT</code>. Isn't the SytemCallError supposed to catch all Errno errors? </p>\n\n<p>EDIT: The code is </p>\n\n<pre><code> rescue SystemCallError, StandardError\n</code></pre>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby","undefined","runtime-error"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13145611,"title":"Rails/Ruby NoMethodError: undefined method `order' for #<Array:0x718c278>","body":"<p>I want to execute the following:</p>\n\n<p>case 1:</p>\n\n<pre><code>x = Group.all[0].people\nx.class\n=&gt; Array\nx.order\n</code></pre>\n\n<p>fine.\n:)</p>\n\n<p>case 2:</p>\n\n<pre><code>y = Person.all\ny.class\n=&gt; Array\ny.order\n=&gt; NoMethodError: undefined method `order' for #&lt;Array:0x718c278&gt;\n</code></pre>\n\n<p>:(</p>\n\n<p>Both x and y contain the same type of item -  bunch of Person models.\nWhy can't ruby order the array?</p>\n\n<p>Thanks in Advance</p>\n"},{"tags":["ruby","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":50,"score":-2,"question_id":13139476,"title":"Ruby: Example of different exception types and handling them","body":"<p>Please explain with the help of examples, what types of exceptions can occur in a ruby program and how to handle them?</p>\n"},{"tags":["ruby","scope","metaprogramming","visibility"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13140050,"title":"Ruby print current visibility","body":"<p>So, with all the metaprogramming stuff in ruby (using 1.9.3), I guess there is a method which returns the current visibility.\nLets assume it is called <code>visibility</code>.</p>\n\n<pre><code>class Foo\n  puts visibility\n  # =&gt; \"public\"\n\n  private\n  puts visibility\n  # =&gt; \"private\"\nend\n</code></pre>\n\n<p>So, whats <code>visibility</code> - how can I get the current visibility the ruby interpreter uses when he finds new methods definitions?</p>\n"},{"tags":["ruby","ruby-on-rails-3","osx","installation","homebrew"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13143957,"title":"When trying to install pg gem: Brew bad interpreter error and not existing ruby version","body":"<p>I've really made something wrong when re-installing ruby, rails, xcode etc. (maybe even I've deleted my system Ruby installation :/ ) Here's what I have now:</p>\n\n<p>System: OSX 10.8.2 (64-bit)</p>\n\n<p><code>which ruby</code> gives me <code>/usr/local/bin/ruby</code></p>\n\n<p>I have installed <code>ruby 1.9.3p286</code>, <code>Rails 3.2.8</code> and <code>rvm 1.16.17 (stable)</code></p>\n\n<p>I've installed Ruby and Rails by going with this tips: <em>http://hivelogic.com/articles/compiling-ruby-rubygems-and-rails-on-snow-leopard</em> </p>\n\n<p>Next I wanted to run <code>gem install pg</code> but I've got an error: <code>No such file or directory - brew --prefix</code></p>\n\n<p>I've tried hit just the <code>brew</code> command but I've got another error: <code>/usr/local/bin/brew: bad interpreter: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin: no such file or directory</code></p>\n\n<p>So there is my question (I have installed brew earlier) - why it points on this path of 1.8 Ruby if I don't have this version of Ruby installed? Can I somehow change this path to my current one with ruby(that from which ruby command?)? How fix this brew error? Please help!</p>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":5,"down_vote_count":4,"view_count":35,"score":1,"question_id":13145307,"title":"Ruby instance variable","body":"<pre><code>class Polygon\n  attr_accessor :sides\n  @sides = 10\nend\n</code></pre>\n\n<p>When I try to access</p>\n\n<pre><code>puts Polygon.new.sides # =&gt; nil\n</code></pre>\n\n<p>I get nil. How to access sides?\nWhat is wrong here?</p>\n"},{"tags":["c#","ruby","application","hello-world"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":6,"view_count":86,"score":-5,"question_id":13145311,"title":"Understanding Ruby for a C# developer","body":"<p>How exactly is a Ruby application architecture?</p>\n\n<p>What are the different filetypes and their content?\nWhat is the extension for a solution/project file?\nWhich file is analogous to a config file?\nAre there files like DLLS formed?\nIf there is not a main() defined, what is the entrypoint for a program?</p>\n\n<p>I looked up on the internet for all of this. But all I could find are some command line tiny code snippets or some tutorial to put Ruby on Rails.</p>\n"},{"tags":["ruby","internals"],"answer_count":1,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":87,"score":7,"question_id":13128510,"title":"How do string literals in ruby bypass new/initialize, and is there a way to instrument this?","body":"<p>I was playing with an idea this afternoon, and stumbled into something I don't quite understand.  Basically what I'm trying to achieve in this experiment is to somehow know every time a string is created (for later use, such as in some kind of DSL).  The following works fine for any String that is created via String.new:</p>\n\n<pre><code>class ::String\n  class &lt;&lt; self\n    alias_method :new_orig, :new\n    def new(*args)\n      o = new_orig(*args)\n      puts \"newing '#{o}'\"\n      o\n    end\n  end\n  alias_method :initialize_orig, :initialize\n  def initialize(*args)\n    initialize_orig(*args)\n    puts \"initializing '#{self}'\"\n  end\nend\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>irb &gt; String.new(\"foo\")\ninitializing 'foo'\nnewing 'foo'\n =&gt; \"foo\"\n</code></pre>\n\n<p>What I can't figure out is how a String object is created when you use a literal.  For example, why does this not go through the same initialization and setup:</p>\n\n<pre><code>irb &gt; \"literal string\"\n =&gt; \"literal string\"\n</code></pre>\n\n<p>I realize that the compiler is doing something or other differently when a string is literal, but doesn't it need to be initialized, simply to be a fully functional object?  Are there any tricks that I could use to determine when a string is created using a literal, or is that impossible to do?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","bonjour"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":926,"score":1,"question_id":1689515,"title":"Bonjour in Ruby","body":"<p>I'm aware of <a href=\"https://github.com/tenderlove/dnssd\" rel=\"nofollow\">dnssd</a>, being a Ruby library for Apple's Bonjour protocol for network discovery for Mac OS X only, but is there a (relatively recent/complete) library that is cross platform?</p>\n"},{"tags":["ruby-on-rails","ruby","tag-cloud","word-cloud"],"answer_count":2,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":1218,"score":4,"question_id":5492651,"title":"Word cloud generator for Rails","body":"<p>Is there a Ruby/Rails library that I can generate word clouds (output should be an image file) like in <a href=\"http://wordle.net\" rel=\"nofollow\">Wordle.net</a>?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":4,"view_count":49,"score":-3,"question_id":13143992,"title":"`gsub` for sentence","body":"<p>I have a string:</p>\n\n<pre><code>Тормозные диски\n</code></pre>\n\n<p>and with <code>gsub</code>, I must get:</p>\n\n<pre><code>+ТОРМОЗН* +ДИС*\n</code></pre>\n\n<p>I need to:</p>\n\n<ul>\n<li>Convert to uppercase (could do with <code>upcase</code>)</li>\n<li>At the beginning of a word,  add <code>+</code></li>\n<li>For every word, slice the last two symbols</li>\n<li>At the last position, add <code>*</code></li>\n</ul>\n\n<p>It is hard for me to code all that are listed above. Help me, please.</p>\n"},{"tags":["ruby","sublimetext2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":53,"score":-1,"question_id":13144593,"title":"Ruby : Trouble executing a sample program","body":"<p>I downloaded a code sample written in Ruby.</p>\n\n<p>I have the development environment ready on Windows Server 2008 using RailsInstaller and have Sublime Text 2 as my editor.</p>\n\n<p>I tried some basic command line syntax and they seemed to work just fine, however I do not have any idea how to execute this sample which has two classes and no Main function method defined. </p>\n\n<p>I am a C# developer and am unable to locate the entry point for the program. Whenever I build my code in Sublime, it returns the following error:</p>\n\n<pre><code>[Error 2] The system cannot find the file specified\n[cmd:  [u'ruby', u'filepath']]\n[dir:  folderpath]\n[path: C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Program Files\\Sublime Text 2\\]\n[Finished]\n</code></pre>\n\n<p>Can anybody help get me started?</p>\n"},{"tags":["ruby-on-rails","ruby","include"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":67,"score":1,"question_id":13134894,"title":"Detecting similar strings in Ruby.","body":"<p>In my db, there are entries eg. <code>Тормозной диск</code>, <code>Диски тормозные LPR</code> etc. in <code>art_groups_arr</code> array. I would like to find all the entries similar to <code>Тормозной диск</code>, such as <code>Диски тормозные LPR</code></p>\n\n<p>This code:\n</p>\n\n<pre><code>art_groups_arr.each do |artgrarr|\n  if n2.art_group.include?(artgrarr)\n    non_original &lt;&lt; n2\n  end\nend\n</code></pre>\n\n<p>does not find them, obviously. How can I find those similar strings?</p>\n"},{"tags":["ruby","eventmachine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13144134,"title":"ruby-eventmachine use start_server with an instance","body":"<p>I'm new to ruby and maybe this is a very simple question..\nI'd like to use eventmachine to develop a simulator for my tests.\nFollowing example in documentation I can write something like this:</p>\n\n<pre><code>require 'eventmachine'\n\nclass Server&lt; EM::Connection\n   def receive_data data\n     send_data data\n     close_connection_after_writing\n   end\nend\n#Note that this will block current thread.\nEventMachine.run {\n  EventMachine.start_server '127.0.0.1','8080', Server\n}\n</code></pre>\n\n<p>But I wonder if there is a way to use an instance of class, something like:</p>\n\n<pre><code>require 'eventmachine'\nclass Server&lt; EM::Connection\n  attr_accessor :response\n    def receive_data data\n      send_data @response\n      close_connection_after_writing\n    end\nend\n\nserver1 = Server.new\nserver1.response = \"foo\"\n\n#Note that this will block current thread.\nEventMachine.run {\n  EventMachine.start_server '127.0.0.1','8080', server1\n}\n</code></pre>\n\n<p>I try to read source code..but it's too hard for me.\nI'm surely missing something, but I don't know how to do something like this.</p>\n"},{"tags":["ruby","file","sharepoint","upload","auto"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":136,"score":0,"question_id":9225090,"title":"sharepoint upload files by ruby","body":"<p>I want to upload files into \"Share Documents\" by ruby script.</p>\n\n<p>I tried \"savon\" to link sparepoint but it can't succeed.</p>\n\n<p>\" WSDL = \"http://xxx.xx.com/sites/OK/Shared%20Documents\" \" is right? </p>\n\n<p>\" client.request.basic_auth \"user\", \"userpasd\" \"</p>\n\n<p>And it show a error message</p>\n\n<p>'request': Savon::Client#request requires at least one argument (ArgumentError)</p>\n\n<p>How to fix it and how to link/upload/download file from sharepoint by ruby script?</p>\n\n<p>Thanks a lot,</p>\n"},{"tags":["ruby","datetime","iso8601"],"answer_count":2,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":1394,"score":7,"question_id":3635136,"title":"Is there a full implementation for ISO-8601 date parsing for Ruby?","body":"<p>The <code>Time.iso8601</code> method is a restricted subset of ISO-8601. </p>\n\n<ul>\n<li>What are its limitations?</li>\n<li>Does anyone know of a full implementation for Ruby? I'm using MRI 1.8.7.</li>\n</ul>\n\n<h3>Update</h3>\n\n<p>It looks like there isn't a single class that handles all of the various 8601 date and date/time combinations. However, I have managed to work around the problems by using both the <code>Date.parse</code> and <code>Time.iso8601</code> methods. The downside is that you need to decide in code whether the input looks like a date or a date/time.</p>\n\n<h3>Warning : Timezone differences</h3>\n\n<p><code>Time.iso8601</code> and <code>Time.parse</code> behave differently. </p>\n\n<pre><code>&gt;&gt; Time.parse(\"2010-09-06T12:27:00.10-05:00\")\n=&gt; Mon Sep 06 18:27:00 +0100 2010\n\n&gt;&gt; Time.iso8601(\"2010-09-06T12:27:00.10-05:00\")\n=&gt; Mon Sep 06 17:27:00 UTC 2010\n</code></pre>\n\n<h3>Differences between Time.iso8601 and ISO-8601</h3>\n\n<p><a href=\"http://www.w3.org/TR/NOTE-datetime\" rel=\"nofollow\">This document</a> touches on the differences between what is in ISO-8601 and what is supported by Ruby. The short answer is that the number of possible formats is restricted.</p>\n"},{"tags":["ruby-on-rails","ruby","redis","resque"],"answer_count":2,"favorite_count":0,"up_vote_count":7,"down_vote_count":0,"view_count":236,"score":7,"question_id":13059549,"title":"How to lock Resque jobs to one server","body":"<p>I have a \"cluster\" of Resque servers in my infrastructure. They all have the same exact job priorities etc. I automagically scale the number of Resque servers up and down based on how many pending jobs there are and available resources on the servers to handle said jobs. I always have a minimum of two Resque servers up. </p>\n\n<p>My issue is that when I do a quick, one off job, sometimes both the servers process that job. This is bad.</p>\n\n<p>I've tried adding a lock to my job with something like the following:</p>\n\n<pre><code>require 'resque-lock-timeout'\n\nclass ExampleJob\n  extend Resque::Plugins::LockTimeout\n\n  def self.perform\n   # some code\n  end\nend\n</code></pre>\n\n<p>This plugin works for longer running jobs. However for these super tiny one off jobs, processing happens right away. The Resque servers both do not see the lock set by its sister server, both set a lock, process the job, unlock, and are done.</p>\n\n<p>I'm not entirely sure what to do at this point or what solutions there are except for having one dedicated server handle this type of job. That would be a serious pain to configure and scale. I really want both the servers to be able to handle it, but once one of them grabs it from the queue, ensure the other does not run it.</p>\n\n<p>Can anyone suggest some viable solution(s)?</p>\n"},{"tags":["ruby","chef","win32-process"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13144130,"title":"Chef : Create a process as another user","body":"<p>So I have some code for running a batch file as a specific user. This was my attempt to automate the following syntax</p>\n\n<pre><code>runas /user:thisguy \"C:\\ThisGuysScript.bat\"\n</code></pre>\n\n<p>so it looks like this in Ruby</p>\n\n<p><code>Process.create(:command_line =&gt; \"C:\\\\ThisGuysScript.bat \", :domain =&gt; \"MYServer\", :with_logon =&gt; \"thisguy\", :password =&gt; \"thisguyspassword\", :cwd =&gt;\"C:\\\\\")</code></p>\n\n<p>So I try to put this in a recipe in chef and disaster strikes</p>\n\n<pre><code>require 'win32/process'\n\n::Process.create(:command_line =&gt; \"C:\\\\ThisGuysScript.bat \", :domain =&gt; \"MYServer\", :with_logon =&gt; \"thisguy\", :password =&gt; \"thisguyspassword\", :cwd =&gt;\"C:\\\\\")\n</code></pre>\n\n<p>Is failing with the following error</p>\n\n<pre><code>[Tue, 30 Oct 2012 15:57:03 +0000] FATAL: ArgumentError: You must supply a name when declaring a user resource\n</code></pre>\n\n<p>So it seems to not realise that I want to use the win32 flavour process. Chef seems to override the win32 module (I know recipes are the opscode DSL rather than really ruby right?)</p>\n\n<p>Anyone been able to get this working? Or the same function with a different implementation. Checked out the windows cookbook but didn't spot much</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-maps-api-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13143355,"title":"Ruby and Google Maps API","body":"<p>I'm requesting directions with the following url:</p>\n\n<pre><code>http://maps.googleapis.com/maps/api/directions/json?origin=43.656877,-79.32085&amp;destination=Montreal&amp;sensor=false\n</code></pre>\n\n<p>Then, Google sends back a huge JSON and I want to access the steps in a nicer way than this:</p>\n\n<pre><code>response = open(\"http://maps.googleapis.com/maps/api/directions/json?origin=#{lat1},#{lng1}&amp;destination=#{lat2},#{lng2}&amp;sensor=false\").read\nresponse = JSON.parse(response)\n\nresponse[\"routes\"][0][\"legs\"][0][\"steps\"][0][\"end_location\"]\n</code></pre>\n\n<p>Is there a more beautiful way to access the end_location without having to use all these array notation? I thought of using OpenStruct, but it would not be ideal either.</p>\n"},{"tags":["python","ruby","xml-rpc","xmlrpclib"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":100,"score":3,"question_id":13122615,"title":"Errors while converting Python script to Ruby","body":"<p>I am using a Python script which uses <code>xmlrpclib</code>:</p>\n\n<pre><code>import xmlrpclib\nsrv = xmlrpclib.ServerProxy(\"http://demo.myslice.info:7080/\", allow_none=True)\n\n# authentication token\nauth = {\"AuthMethod\": \"password\", \"Username\": \"demo\", \"AuthString\": \"demo\"}\nret = srv.Get(auth, \"slice\", [[\"slice_hrn\", '=', \"ple.upmc.myslicedemo\"]], {}, [\"slice_hrn\", \"resource.network\", \"resource.type\", \"resource.hrn\", \"resource.hostname\"])\nprint ret\n</code></pre>\n\n<p>I want to make a similar XML-RPC call using Ruby. For this purpose I have used the following code:</p>\n\n<pre><code>require \"xmlrpc/client\"\nrequire \"pp\"\n\nXMLRPC::Config.module_eval do\n    remove_const :ENABLE_NIL_PARSER\n    const_set :ENABLE_NIL_PARSER, true\nend\n\nret = XMLRPC::Client.new2(\"http://demo.myslice.info:7080/\")\n\nauth = {\"AuthMethod\" =&gt; \"password\", \"Username\" =&gt; \"demo\", \"AuthString\" =&gt; \"demo\"}\n\npp ret.call(\"Get\", auth, \"slice\", {\"slice_hrn\" =&gt; \"ple.upmc.myslicedemo\"}, [\"slice_hrn\", \"resources.network\", \"resources.type\", \"resources.hrn\", \"resources.hostname\"])\n</code></pre>\n\n<p>When I run this Ruby script I get the following error:</p>\n\n<pre><code>.../xmlrpc/client.rb:414:in `call': error (XMLRPC::FaultException)\n</code></pre>\n\n<p>What can I do to fix this error?</p>\n"},{"tags":["ruby","testing"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":45,"score":2,"question_id":13142788,"title":"simpler way to test my simple Rack app?","body":"<p>i have a Rack app like this:</p>\n\n<pre><code>app = Rack::Builder.new do\n\n    map '/' do\n        # ...\n    end\n\n    map '/edit' do\n        # ...\n    end\n\nend.to_app\n</code></pre>\n\n<p>How would i test it without long-tail installation/setup/learn process.</p>\n\n<p>RSpec and minitest are really great, but i do not really want to learn nor setup them.</p>\n\n<p>Is there something i cat just plug in and write/run tests right away in plain Ruby?</p>\n\n<p>I want to write tests as simple as i wrote the app above, without advanced techniques and gotchas.</p>\n\n<p>In KISS I Trust!</p>\n"},{"tags":["ruby","oop","design-patterns","object-oriented-analysis"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13143407,"title":"Object Oriented Design Patterns for Model Attribute Events","body":"<p>I'm trying to figure out the best way to encapsulate the following scenario with Object Oriented Design principles. What type of design pattern would best suit?</p>\n\n<p>I've added very basic class definitions below, basically a person has a plan and a credit card. When a person changes their plan, we want to bill them the difference (if the plan's cost was more) and create an Event</p>\n\n<p>I <em>could</em> do this in callbacks or an observer, check if the <code>Plan</code> for that <code>Person</code> changed, but in a larger system with lots of cross model behaviour, this becomes unmanageable and difficult to test with lots of unrelated callbacks affecting state.</p>\n\n<pre><code>class Person\n   has_one :plan\n   has_one :credit_card\n   has_many :events\nend\n\nclass Plan\n   attr_accessible :cost\nend\n\nclass CreditCard\n  def charge_card(amount)\n    ...\n  end\nend\n\nclass Event\n  attr_accessible :message\nend\n</code></pre>\n"},{"tags":["ruby","comments"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13130859,"title":"Inline comments in Ruby","body":"<p>Is Ruby able to understand in-line comments like:</p>\n\n<pre><code>my_array = ['first', /* 'second', */ 'third', 'fourth']\n</code></pre>\n\n<p>?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I asked not about what is /* */ in Ruby and why I receive an error, but about presence of in-line comments in any available form at all. /* */ were given only as example of in-line comments known to me.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","osx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12468459,"title":"I want to change my OS X ruby version to 1.9 without using RVM","body":"<p>yeah, you heard me right! I want to nix RVM for the time being and just run off of a system-level installation of Ruby 1.9.3</p>\n\n<p>In other words, I want to just upgrade the old 1.8.7 version of ruby that came with my Mountain Lion installation to 1.9.3.</p>\n\n<p>How would i do this?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13139739,"title":"Keeping rake jobs:work running","body":"<p>I'm using delayed_job to run jobs, with new jobs being added every minute by a cronjob.</p>\n\n<p>Currently I have an issue where the rake jobs:work task, currently started with 'nohup rake jobs:work &amp;' manually, is randomly exiting.</p>\n\n<p>While God seems to be a solution to some people, the extra memory overhead is rather annoying and I'd prefer a simpler solution that can be restarted by the deployment script (Capistrano).</p>\n\n<p>Is there some bash/Ruby magic to make this happen, or am I destined to run a monitoring service on my server with some horrid hacks to allow the unprivelaged account the site deploys to the ability to restart it?</p>\n"},{"tags":["ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":13140155,"title":"in Ruby, how do I push elements to the end of a range?","body":"<p>Is there any way to push elements onto the end of a range without converting it into an array then back to a range?</p>\n\n<pre><code>r = 1..10\n=&gt; 1..10\n\nr &lt;&lt; 11\nNoMethodError: undefined method `&lt;&lt;' for 1..10:Range\n\nr.push 11\nNoMethodError: undefined method `push' for 1..10:Range\n</code></pre>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":42,"score":0,"question_id":13140853,"title":"how to find out whether all array elements match some condition?","body":"<p>I have a big array and I need to know whether all its elements are divisible by 2.</p>\n\n<p>I'm doing it this way, but it's sort of ugly:</p>\n\n<pre><code>_true = true\narr.each { |e| (e % 2).zero? || _true = false }\nif _true == true\n    # ...\nend\n</code></pre>\n\n<p>How to do this without extra loops/assignments?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13142785,"title":"Form for adding children using ancestry gem","body":"<p>I have a user model in Rails and I am trying to use the Ancestry gem to add children to users. I would like to be able to enter one/several user ids (children) into a form and then assign them to be children to a user. I currently have a form for updating the name of the user in a view, but being new to Rails I am struggling to figure out the form should look like for making @user parent of user_ids (the children) entered a form. How can one do this?</p>\n\n<p>edit.html.erb</p>\n\n<pre><code>…\n&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n…\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":2,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":130,"score":16,"question_id":13142326,"title":"What does <%== %> do in rails erb?","body":"<p>I saw this recently, thought it was interesting.  But I don't really understand what it does?</p>\n\n<p>Ex.  I have a rails app and I want to bootstrap some json, so that I don't have to make a second request.  Normally I would write something like this.</p>\n\n<p><code>&lt;%= raw @model.to_json %&gt;</code>\nor\n<code>&lt;%= @model.to_json.html_safe %&gt;</code></p>\n\n<p>I have to send the message <code>raw</code> or <code>html_safe</code> or the json will be html escaped and thus not parsed correctly.  However, this seems to work too.</p>\n\n<p><code>&lt;%== @model.to_json %&gt;</code></p>\n\n<p>But I can't find any documentation.</p>\n\n<p>Does anyone know what this does exactly?  i.e.  Is it the exact same as calling <code>html_safe</code> or <code>raw</code>?  Or is there more to it?</p>\n"},{"tags":["ruby","web-scraping","nokogiri"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":13137297,"title":"Ruby - Write into nested array","body":"<p>I'm trying to scrape information about new album releases of a site, and I'm handling this via Nokogiri. The idea would be to create a nice array that would contain items like so</p>\n\n<pre><code>[ \n  0 =&gt; ['The Wall', 'Pink Floyd', '1979'], \n  1 =&gt; ['Led Zeppelin I', 'Led Zeppelin', '1969']\n ]\n</code></pre>\n\n<p>This is my current code. I'm a total ruby newbie so any suggestion would be greatly appreciated.</p>\n\n<pre><code>@events = Array.new()\n# for every date we encounter\ndoc.css(\"#main .head_type_1\").each do |item|\n\n  date = item.text\n\n  # get every albumtitle\n  doc.css(\".albumTitle\").each_with_index do |album, index|\n    album = album.text\n    @events[index]['album'] = album\n    @events[index]['release_date'] = date\n  end\n\n  #get every artistname\n  doc.css(\".artistName\").each do |artist|\n    artist = artist.text\n    @events[index]['artist'] = artist\n  end\n\nend\n\nputs @events\n</code></pre>\n\n<p>P.S. the format of the page I'm trying to scrape is a bit weird:</p>\n\n<pre><code>&lt;tr&gt;&lt;th class=\"head_type_1\"&gt;20 October 1989&lt;/th&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td class=\"artistName\"&gt;Jean Luc-Ponty&lt;/td&gt;&lt;td class=\"albumTitle\"&gt;Some example album&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td class=\"artistName\"&gt;Some Other Artist&lt;/td&gt;&lt;td class=\"albumTitle\"&gt;Some example album&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td class=\"artistName\"&gt;Some Other Artist&lt;/td&gt;&lt;td class=\"albumTitle\"&gt;Some example album&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;th class=\"head_type_1\"&gt;29 October 1989&lt;/th&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td class=\"artistName\"&gt;Some Other Artist&lt;/td&gt;&lt;td class=\"albumTitle\"&gt;Some example album&lt;/td&gt;&lt;/tr&gt;\n</code></pre>\n\n<p>When I try to run this within the ruby interpreter I get the following errors:</p>\n\n<pre><code>get_events.rb:25:in `block (2 levels) in &lt;main&gt;': undefined method `[]=' for nil:NilClass (NoMethodError)\nfrom /Users/adrian/.rvm/gems/ruby-1.9.3-p286/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:239:in `block in each'\nfrom /Users/adrian/.rvm/gems/ruby-1.9.3-p286/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `upto'\nfrom /Users/adrian/.rvm/gems/ruby-1.9.3-p286/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `each'\nfrom get_events.rb:23:in `each_with_index'\nfrom get_events.rb:23:in `block in &lt;main&gt;'\nfrom /Users/adrian/.rvm/gems/ruby-1.9.3-p286/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:239:in `block in each'\nfrom /Users/adrian/.rvm/gems/ruby-1.9.3-p286/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `upto'\nfrom /Users/adrian/.rvm/gems/ruby-1.9.3-p286/gems/nokogiri-1.5.5/lib/nokogiri/xml/node_set.rb:238:in `each'\nfrom get_events.rb:18:in `&lt;main&gt;'\n</code></pre>\n\n<p>How do I fix this?</p>\n"},{"tags":["ruby-on-rails","ruby","beanstalkd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13142448,"title":"Beanstalkd server not running its jobs","body":"<p>I'm trying to start beanstalk server, and made 1 job to test it, but instead i got nothing.\nHere is my code:</p>\n\n<pre><code>require 'stalker'\ninclude Stalker\n\n\njob 'test.job' do\n  somefile = File.new(\"somefile\")\n\nend\n</code></pre>\n\n<p>Im using stalker gem to connect ruby and beanstalkd. Any ideas what am i doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13140509,"title":"How can I open a link(button) in a separate tab?","body":"<p>I have a button that opens a link in a same window, but I need to open it in a separate tab by doing some scripting. I am working in Ruby and here is my code:  </p>\n\n<pre><code>Given /^User clicks on the New User Link$/ do\n    page.driver.browser.switch_to.window (page.driver.browser.window_handles.last)\n    find(:xpath, \"//*[@id='slideshow']/div[1]/div/a/img, \").click\nend\n</code></pre>\n\n<p>This code won't work for me. Please let me know if you see anything wrong in this code. </p>\n"},{"tags":["sql","ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13142183,"title":"Selecting Areas for Sales Reps","body":"<p>I have an application that is for sales reps. \nI'm trying to pull different institutions information based on 2 things</p>\n\n<ol>\n<li>If they are a client</li>\n<li>If they are in the state that the user (sales rep) is over.</li>\n</ol>\n\n<p>So I want to show all the institutions that are clients in the current_user (sales reps) area. How can I do that? </p>\n\n<p>Since I haven't done this before and I'm newer to rails I'm not sure how to do this.</p>\n\n<p>Here are my models (I've shortened the code):</p>\n\n<p><strong>User(Sales Rep)</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :states, :through =&gt; :rep_areas\n  has_many :institutions, :through =&gt; :company_reps\n  has_many :rep_areas\n  has_many :company_reps\nend\n</code></pre>\n\n<p><strong>States</strong></p>\n\n<pre><code>class State &lt; ActiveRecord::Base\n  has_many :users, :through =&gt; :rep_areas\n  has_many :rep_areas\n  has_many :institutions\n\n  attr_accessible :code, :name\nend\n</code></pre>\n\n<p><strong>Institutions</strong></p>\n\n<pre><code>class Institution &lt; ActiveRecord::Base\n  attr_accessible :company, :phone, :clientdate, :street, :city, :state_id, :zip, :source, :source2, :demodate1, :demodate2, :demodate3, :client, :prospect, :notcontacted\n  belongs_to :state\n  has_many :users, :through =&gt; :company_reps\n  has_many :company_reps\nend\n</code></pre>\n"},{"tags":["ruby","dsl"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1717,"score":4,"question_id":4936146,"title":"Tutorials for writing DSL in Ruby","body":"<p>What are the good online tutorials on how to implement DSLs in Ruby? I am looking for hands-on examples that explain the whole process.</p>\n\n<p>I am aware that there is this question on good books about DSLs and Ruby: <a href=\"http://stackoverflow.com/questions/2772407/good-books-on-ruby-based-dsl\">Good books on Ruby based DSL</a>. </p>\n"},{"tags":["ruby-on-rails","ruby","session","cookies"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":795,"score":1,"question_id":2594676,"title":"Rails session cookie not getting set","body":"<p>I have a rails app that is a CMS that uses dynamic subdomains for each site.  For some reason when I deployed to production the session cookie is not getting set.  I'm thinking this is leading to the \"Invalid Authenticity Token\" errors that are being thrown everywhere.  </p>\n\n<p>I have my production.rb setup so that I can share sessions across subdomains.  What could be going wrong that the cookie isn't being set at all?</p>\n\n<pre><code>#production.rb\nconfig.action_controller.session[:domain] = '.domain.com'\n\n\n#environment.rb\nconfig.action_controller.session = {\n   :session_key =&gt; '_app_session',\n   :secret      =&gt; '.... nums and chars .....'\n }\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13139269,"title":"Rails - Find model under specific category","body":"<p>I have a <code>Business</code> model that :belongs_to <code>Category</code></p>\n\n<p>A sample hierarchy for categories:</p>\n\n<ul>\n<li>root\n<ul>\n<li>Restaurants\n<ul>\n<li>Sushi</li>\n<li>Pizza</li>\n<li>Chinese</li>\n<li>French</li>\n<li>Italian</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>I am using <code>acts_as_tree</code> for <code>Category</code> hierarchy.</p>\n\n<p>How can I find all <code>Businesses</code> under the Restaurants category?</p>\n"},{"tags":["ruby-on-rails","ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13112959,"title":"NoMethodError undefined method 'merge' when running RSpec integration test","body":"<p>I am following <b>Micheal Hartl's Ruby on rails tutorial 2.3 Edition</b> and I have followed the steps for the integration tests correctly. in <b>/sample_app/spec/integration</b> I have a file named <b>layout_links_spec.rb</b> which looks like this.</p>\n\n<pre><code>require 'spec_helper'\ndescribe \"Layout links\" do\n it \"should have a Home page at '/'\" do\n  get '/'\n   response.should render_template('pages/home')\n  end\n end\n</code></pre>\n\n<p>When i do </p>\n\n<pre><code>$ spec spec/\n</code></pre>\n\n<p>I am getting the following error</p>\n\n<pre><code>1)\nNoMethodError in 'Layout links should have a Home page at '/''\nundefined method `merge' for nil:NilClass\n /home/rails_projects/sample_app/spec/integration/layout_links_spec.rb:4:\n\nFinished in 0.060225 seconds\n\n1 example, 1 failure\n</code></pre>\n\n<p>Please help me with this error</p>\n"},{"tags":["ruby","ruby-on-rails-3","routing"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":13140624,"title":"Rails 3 Routing: Resource actions and nested resource with :path => \"/\"","body":"<p>I want to configure my Rails routing such that these cases work:</p>\n\n<pre><code>/username           #=&gt; { :controller =&gt; \"houses\",\n                    #     :action =&gt; \"index\",\n                    #     :user_id =&gt; \"username\" }\n\n/username/housename #=&gt; { :controller =&gt; \"houses\",\n                    #     :action =&gt; \"show\",\n                    #     :user_id =&gt; \"username\",\n                    #     :id =&gt; \"housename\" }\n\n/username/edit      #=&gt; { :controller =&gt; \"users\",\n                    #     :action =&gt; \"edit\",\n                    #     :id =&gt; \"username\" }\n</code></pre>\n\n<p>In other words, I want <code>/:user_id</code> to be a regular user resource, and have a nested resource for it, which is mounted directly on the root. So, I want <code>/username/housename</code> instead of <code>/username/houses/housename</code>. I tried using <code>:path =&gt; \"/\"</code> for the nested resources, but this somehow clashes with other actions such as `:edit. I'm lost - can this be done?</p>\n"},{"tags":["ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13142084,"title":"can i store a class within PStore?","body":"<p>Any way to have a class automatically defined when pstore database restored?</p>\n\n<p>something like this:</p>\n\n<pre><code>db = PStore.new 'db'\ndb.transaction do\n    # define the App class here\nend\n</code></pre>\n\n<p>then loading database on another server:</p>\n\n<pre><code>db = PStore.new 'db'\ndb.transaction\n</code></pre>\n\n<p>and the App class get defined automatically.</p>\n\n<p>i know, it looks awkward, perhaps another way to \"migrate\" classes, not just objects?</p>\n"},{"tags":["ruby","interface","rspec","mocking"],"answer_count":3,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":333,"score":9,"question_id":13105884,"title":"Adopting \"Growing Object-Oriented Software\" techniques to Ruby on Rails","body":"<p>I read <a href=\"http://www.pearsonhighered.com/educator/product/Growing-ObjectOriented-Software-Guided-by-Tests/9780321503626.page\" rel=\"nofollow\">Growing Object-Oriented Software, Guided by Tests</a> by Steve Freeman and Nat Pryce and was impressed very much. I want to adopt the ideas of this book in my Rails projects using RSpec, though its examples are written in Java.</p>\n\n<p>A basic precept of this book is that we should mock <em>interfaces</em> instead of <em>concrete classes</em>. They say we can improve the application <em>design</em> by extracting interfaces and naming them.</p>\n\n<p>But, Ruby doesn't have any syntax equivalent to Java's <code>interface</code>. How can I utilize their techniques for Rails projects?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>For example, in the page 126 the authors introduced <code>Auction</code> interface in order to implement the <code>bid</code> method. Firstly, they mocked <code>Auction.class</code> to make the test pass, then they implemented an <code>Auction</code> class as anonymous inner class in the <code>Main</code> class. Finally, they extracted a new concrete class <code>XMPPAuction</code> from <code>Main</code> (page 131-132).</p>\n\n<p>This incremental approach is the crux of this book in my opinion.</p>\n\n<p>How can I adopt or imitate such a series of code transformation in the Ruby development?</p>\n"},{"tags":["ruby","selenium","captcha","selenium2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":651,"score":0,"question_id":8683106,"title":"Ruby/Selenium WebDriver - Pausing test and waiting for user input, i.e. user inputs captcha","body":"<p>I'm using the Selenium WebDriver and Ruby to perform some automation and I ran into a problem of a captcha around step 3 of a 5 step process.  </p>\n\n<p>I'm throwing all the automation in a rake script so I'm wondering is there a command to pause or break the script running temporarily until I enter data into the captcha and then continue running on the next page.</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":32,"score":4,"question_id":13141480,"title":"Block a file without blocking the Ruby process on failures","body":"<p>Hello I am trying to lock a file by using <code>file.flock(File::LOOK_EX)</code></p>\n\n<p>The problem it is blocking the app if it unable to block the file.</p>\n\n<p>The <code>rescue</code> does not help either.</p>\n\n<p>Is there any way to tell <code>flock</code> to fail if it cannot lock the file on the first try?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13137826,"title":"How to add a method for active record?","body":"<p>I would want to use my method getScheduleFixed() on a Active Record Istance</p>\n\n<pre><code>ps = ProgramSchedule.all\nps.getScheduleFixed\n</code></pre>\n\n<p>the important fact is how to access to \"ps\" array (active record) on my method declaration</p>\n\n<pre><code>class ProgramSchedule &lt; ActiveRecord::Base\n\n  def getScheduleFixed\n\n    array = (HERE ARRAY RETURNED BY ACTIVE RECORD)\n\n    # some stuff...\n\n    return array\n\n  end\nend\n</code></pre>\n"},{"tags":["ruby","rdebug"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13141116,"title":"rdebug continue past breakpoints","body":"<p>I have put some <code>debugger</code> breakpoints in my rails app within some long loops. After hitting the breakpoint and evaluating what I need, is there a way to continue ignoring the rest of my break points?</p>\n"},{"tags":["ruby-on-rails","ruby","loops","partial"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":46,"score":0,"question_id":13032946,"title":"rails ruby iterate through partials in directory","body":"<p>To those helping.. Thanks.  Still no solution but getting closer.  The errors i think are because my \"file\" evaluates to \"app/views/main/show/_partial.html.erb\".  and render adds it's own relative path.  So I guess i need to list the file names.. maybe a dir.foreach or dir.glob type command.. i'll keep digging.  THANKS!</p>\n\n<p>I have a directory full of partials I would like to call in a page.  So I wrote a loop but it yields errors. </p>\n\n<pre><code>&lt;% Dir[\"app/views/main/show/*\"].each do |file| %&gt;\n  &lt;%= render #{file} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I replace the render line with a simple <p>file</p> it lists the file names so i know the loop and Dir location work.  The problem I THINK is that render is looking for a string.  So I've tried all sorts of things from searching google and here like the #{file}, creating a variable first, raw,...etc.</p>\n\n<p>also I think render may be looking in a different directory relative the Dir.  I'll try out some stuff there to.  </p>\n\n<p>How should I be handling this?  I'm up for switching from Dir to Dir.foreach or any other strategy that makes sense.</p>\n\n<p>Thanks.</p>\n\n<p><strong>EDIT</strong>: Here's the solution I've implemented (directory path changed from above):</p>\n\n<pre><code>&lt;% Dir[\"app/views/partials/show/*.html.erb\"].each do |file| %&gt;\n&lt;p&gt; &lt;%= render 'partials/show/' + File.basename(file,'.html.erb').slice!(1..-1) %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","testing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13140883,"title":"How to run a test suite inside the Rails environment","body":"<p>I'm working the <a href=\"https://rubygems.org/gems/finance\" rel=\"nofollow\">Finance</a> gem, and I am having an issue where some of the code fails when run inside Ruby on Rails.</p>\n\n<p>I would like to test for this by running the existing test suite inside the Rails environment, however, I'm not sure how to go about this.  I'm looking for something to the effect of</p>\n\n<pre><code>run_all_tests\ninside_rails do\n  run_all_tests_again\nend\n</code></pre>\n\n<p>inside my <code>Rakefile</code>, or wherever is most appropriate.</p>\n\n<p>I haven't been able to find much on Google; any assistance would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby","api"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12262458,"title":"How to get all factual monetize deals wit ruby driver","body":"<p>I tried to get all deals for a city in the US from the Factual monetize API by the help of the ruby driver </p>\n\n<pre><code>query = factual.monetize.filters(\"place_locality\" =&gt; \"San Francisco\") \n</code></pre>\n\n<p>Is there a limit of 20 results? How is it possible to get more deals? </p>\n"},{"tags":["ruby","metaprogramming"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":60,"score":2,"question_id":13139899,"title":"Detect method call","body":"<p>I'm trying to implement lazy method execution in ruby. Let's say I have a class with two methods which should not be executed immediately after call</p>\n\n<pre><code>class Foo\n  lazy_evaluate :bar, :baz\n\n  def bar(string)\n    puts string\n  end\n\n  def baz(hash)\n    puts hash.inspect\n  end\nend\n\nf = Foo.new\nf.bar('hello world') =&gt; nil\nf.baz(hello: :world) =&gt; nil\n\nf.run_lazy_methods =&gt;\n'hello world'\n'{:hello=&gt;:world}'\n</code></pre>\n\n<p>I wan't use this in my gem <a href=\"http://pastie.org/5137463\" rel=\"nofollow\">http://pastie.org/5137463</a></p>\n\n<p>I'm asking for idea how to implement this behaviour</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","views","content-for"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140596,"title":"How to skip the content_for tag content for some pages in rails?","body":"<p>I have a layout in which i'm using the content_for tag to render some partials(for sidebar). But on several pages I don't need this sidebar. So the question is: How can I tell rails not to render anything for some pages?</p>\n\n<p>I've tried to do it the following way without any result:</p>\n\n<pre><code>&lt;% content_for :sidebar do %&gt;\n  &lt;%= render nothing: true %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Just got an error</p>\n\n<pre><code>You invoked render but did not give any of :partial, :template, :inline, :file or :text option.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":28,"score":5,"question_id":13137036,"title":"rails ActiveRecord::Observer in plugin","body":"<p>I want to add an Observer for Issues to an existing rails application.</p>\n\n<p>I created a plugin, and under plugin's <code>app/model</code> i saved the <code>custom_observer.rb</code></p>\n\n<p>It works when I add <code>:custom_observer</code> to <code>config.active_record.observers</code> in <code>config/application.rb</code></p>\n\n<p>I tried something like </p>\n\n<pre><code>RedmineApp::Application.configure do\n    config.after_initialize do\n             config.active_record.observers &lt;&lt; :custom_observer\n    end\nend\n</code></pre>\n\n<p>in the plugin's init.rb but that doesn't work.</p>\n\n<p>What is a better way to do that?\nthanks</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12137795,"title":"How do i implement factual in Ruby?","body":"<p>I chose \"factual-api\" gem after looking at the factual website. May I know how do I set it up and use the function to get the locations of those areas? Can I write it in the controller/model?</p>\n\n<p>After trying to install the gem, I get this when I look at my gemfile:</p>\n\n<pre><code>Gem \"factual-api\" is unavailable in SDK 'RVM: ruby-1.9.2-p290\n</code></pre>\n\n<p>This inspection warns about unavailable gems inside the current SDK. The IDE needs the gems to provide come completion, navigation and analysis. An appropriate quick-fix is available to install the required gems.</p>\n\n<p>When I run the command bundle install, I do not have any errors. But when I called:</p>\n\n<pre><code>factual = Factual.new(\"YOUR_KEY\", \"YOUR_SECRET\")\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>NameError: uninitialized constant Factual\n</code></pre>\n\n<p>What am I doing wrong now? What should be the right way to do so?</p>\n"},{"tags":["ruby","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":28,"score":-1,"question_id":13139778,"title":"Rspec: is it possible to should_receive on a class?","body":"<p>Question is in the title. Lets say for example I've got a class:</p>\n\n<pre><code>class A\n  def self.something\n    p 'Something'\n  end\n\n  def call_something\n    self.class.something\n  end\nend\n</code></pre>\n\n<p>I want to write a test, that an <code>instance a</code> of <code>class A</code> on method call: <code>a.call_something</code> will actually call <code>A.something</code>. Is this possible?</p>\n"},{"tags":["ruby-on-rails","ruby","helpers","activeadmin"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1108,"score":3,"question_id":8673112,"title":"Rails 3. How to add a helper that ActiveAdmin will use?","body":"<p>I'm creating a helper to be used by Formtastic but I get the <code>undefined local variable or method</code> error. I don't know where to put it so it can work.</p>\n\n<p>I already tried in the application_helper.rb and in app/helpers/active_admin/view_helpers.rb</p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13139640,"title":"How to find out the date of second Monday of each month of given year?","body":"<p>My customer has an event each second Monday of each month.</p>\n\n<p>I need to mark them with red in calendar.</p>\n\n<p>How do i \"cleanly\" find out the date of that Mondays?</p>\n"},{"tags":["ruby","stack","stack-level"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":62,"score":3,"question_id":13139384,"title":"Ruby stack level too deep exception NOT from recursive infinite loop","body":"<p>I was coding and after adding a method I got this :</p>\n\n<pre><code>user_name@the_computer:/media/ECC3-C3B0/Prog/mts/src/mts$ rake test --trace\n** Invoke test (first_time)\n** Execute test\n/home/user_name/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36: stack level too deep (SystemStackError)\nrake aborted!\nCommand failed with status (1): [/home/user_name/.rvm/rubies/ruby-1.9.3-p19...]\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in `block in create_shell_runner'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils.rb:82:in `ruby'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/testtask.rb:99:in `block (2 levels) in define'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:60:in `verbose'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/testtask.rb:98:in `block in define'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/home/user_name/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `load'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `&lt;main&gt;'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'\n/home/user_name/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\nTasks: TOP =&gt; test\n</code></pre>\n\n<p>I'm pretty sure there is no infinite recursive loop involved.</p>\n\n<p>The code is for now somehow gemified, but I also got the error running the ruby file directly.</p>\n\n<p>Thank you for any help on how to (get some information to, run some tests to) fix the problem, if possible without having to rewrite the whole thing...</p>\n\n<h1>Environment :</h1>\n\n<ul>\n<li>ruby 1.9.3p194 / rails 3.2.8, installed via rvm</li>\n<li>the program at this stage only uses rails string inflexions functions</li>\n<li>OS : linux kubuntu i386</li>\n<li>memory 4GO</li>\n<li>'ulimit -s' : 8192 (stack size in kB)</li>\n</ul>\n\n<h1>What I tried unsuccessfully :</h1>\n\n<ul>\n<li>removed the chunk of code where the exception was initially raised, but it was still raised a tiny bit later</li>\n<li>set stack size with command line 'ulimit -s 20000', 'ulimit -s unlimited'. Same error, apparently at the same place (which makes me think the stack size wasn't actually changed)</li>\n<li>downgraded to ruby1.9.2 / rails3.1.3, got the same message</li>\n<li>same error under Windows</li>\n</ul>\n\n<h1>Application context :</h1>\n\n<p>I'm writing an application that heavily uses ruby mixins.</p>\n\n<p>Besides I created a bunch of classes that generate mixins (instance / class methods modules to be included by other classes).</p>\n\n<p>So all in all I end up with quite a bit of generated named modules with some custom generated code, and classes with many ancestors.</p>\n\n<p>But that should eventually save me quite a bit of pain in the as$ when I write the program that sits on top of this lib (that's the plan anyway).</p>\n\n<h1>Resources I used : </h1>\n\n<ul>\n<li><a href=\"http://stackoverflow.com/questions/242617/how-to-increase-stack-size-for-a-ruby-app-recursive-app-getting-stack-level-to\">How to increase stack size for a ruby app. Recursive app getting: Stack level too deep (SystemStackError)</a></li>\n<li><a href=\"http://dalibornasevic.com/posts/5-ruby-stack-level-too-deep-systemstackerror\" rel=\"nofollow\">http://dalibornasevic.com/posts/5-ruby-stack-level-too-deep-systemstackerror</a></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby","regex"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13139157,"title":"regular expression for numerated table of content","body":"<p>I have template like this:</p>\n\n<pre><code>&lt;h1&gt;asd&lt;/h1&gt;\n...\n&lt;h1&gt;asd&lt;/h1&gt;\n...\n    &lt;h2&gt;asd&lt;/h2&gt;\n    ...\n    &lt;h2&gt;asd&lt;/h2&gt;\n    ...\n</code></pre>\n\n<p>How to convert it to</p>\n\n<pre><code>&lt;h1&gt;1. asd&lt;/h1&gt;\n...\n&lt;h1&gt;2. asd&lt;/h1&gt;\n...\n    &lt;h2&gt;2.1. asd&lt;/h2&gt;\n    ...\n    &lt;h2&gt;2.2. asd&lt;/h2&gt;\n    ...\n</code></pre>\n\n<p>with regular expressions in ruby 1.8.7 ?</p>\n"},{"tags":["ruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13139130,"title":"How to track when a variable is initialized and eventually destroyed","body":"<p>Presumably i have a instance var <code>@foo</code></p>\n\n<p>It is set inside <code>def initialize</code> so i can track when it is initialized.</p>\n\n<p>However i also need to track when it is destroyed.</p>\n\n<p>Are there some \"hook\" for this? Just like <code>method_defined</code> or <code>included?</code></p>\n\n<p>Something like <code>instance_variable_destroyed foo</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","rake"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13139253,"title":"nohup rake jobs:work exit with Mysql::Error:","body":"<p>I am getting following error.  With this error the rake exit. </p>\n\n<p>rake aborted!</p>\n\n<p>Mysql::Error: MySQL server has gone away: UPDATE <code>delayed_jobs</code> SET locked_by = null, locked_at = null WHERE (locked_by = 'host:domainname.com pid:2923')</p>\n\n<p>How can I keep the rake jobs:work running or to restart it if it exit.  I found a posting <a href=\"http://stackoverflow.com/questions/1128824/keeping-a-rake-job-running\">Keeping a rake job running</a> but the link in the answer is not working.  Can somebody post the solution? </p>\n\n<p>I have multiple rails application on my VPS for which I want to have  rake jobs:work  running.  How can I do that?</p>\n"},{"tags":["ruby","arrays","hash"],"answer_count":4,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":3470,"score":8,"question_id":9560335,"title":"Ruby Hash to array of values","body":"<p>I have this:</p>\n\n<pre><code>hash  = { \"a\"=&gt;[\"a\", \"b\", \"c\"], \"b\"=&gt;[\"b\", \"c\"] } \n</code></pre>\n\n<p>and I want to get to this: <code>[[\"a\",\"b\",\"c\"],[\"b\",\"c\"]]</code></p>\n\n<p>This seems like it should work but it doesn't:</p>\n\n<pre><code>hash.each{|key,value| value}\n=&gt; {\"a\"=&gt;[\"a\", \"b\", \"c\"], \"b\"=&gt;[\"b\", \"c\"]} \n</code></pre>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby","windows","wsh"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12976734,"title":"Using ruby in WSH (Windows Scripting Host)","body":"<p>Has anyone experience with using ruby in WSH (Windows Scripting Host)?\nThe following doesn't work, Ruby is installed on the system.</p>\n\n<pre><code>&lt;package id = \"hello_world\"&gt;  \n&lt;job&gt;\n&lt;script language=\"VBScript\"&gt;\n  MsgBox \"hello world (from vb)\"\n&lt;/script&gt;\n&lt;script language=\"JScript\"&gt;\n  WSH.echo(\"hello world (from js)\");\n&lt;/script&gt;\n&lt;script language=\"RubyScript\"&gt;\n  puts \"hello world (from ruby)\"\n&lt;/script&gt;\n&lt;/job&gt;\n&lt;/package&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","lambda","closures","proc"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13137304,"title":"How to combine procs to filter a list in ruby?","body":"<p>I am trying to implement a filter-by-criteria approach in a little project of mine. I have a Filter class, in which i have filters for name, year, genre. For example:</p>\n\n<pre><code>Filter.new.name(\"The Shawshank Redemption\")\nFilter.new.year(\"1994\")\nFilter.new.genre(\"drama\")\n</code></pre>\n\n<p>I also have a list of movies, each being an object that has methods name, year and genre. I want to be able to do the following (MoviesContainer is just a class that has a @movies list):</p>\n\n<pre><code>MoviesContainer.filter Filter.new.name(\"The Godfather\") &amp; Filter.new.year(\"1972\") | Filter.year(\"1974\")\n</code></pre>\n\n<p>I can easily overload the |, &amp; and ! operators in my Filter class, but I don't know how to combine the filter object so that they become just one object which I can pass to filter.\nI'm gladly accepting any ideas. :)</p>\n\n<p>My best idea so far is to create a proc for every Filter.new and then combine them in the &amp;,| and ! methods, but I don't know how. I'm thinking something like this could work, however, it doesn't :D</p>\n\n<pre><code>proc { |movie| proc { |movie| movie.name == \"The Godfather\" } &amp;&amp; proc { |movie| movie.year== \"1972\" }\n</code></pre>\n\n<p>and then call this with every of the @movies items.\nCan you please help me with the combining procs thing, or perhaps propose a better solution. Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","plugins","paperclip"],"answer_count":5,"favorite_count":8,"up_vote_count":16,"down_vote_count":0,"view_count":8819,"score":16,"question_id":296952,"title":"Rails Plugin: Paperclip Question","body":"<p>How can I prevent the image tag that calls the associated image from displaying if no image is associated with the record?</p>\n\n<pre><code>&lt;%= image_tag @agent.avatar.url %&gt;\n</code></pre>\n\n<p>...gives me the text \"Missing\" if there is no image associated with that agent.  I want to test to see there is an image available first, then render the above tag if the test returns true.</p>\n\n<p>Better yet, is there anyway for me to specify a default image if no image is specifically provided?</p>\n"},{"tags":["ruby-on-rails","ruby","postgresql","mailer"],"answer_count":5,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":202,"score":3,"question_id":7161219,"title":"How to save mail and send it later","body":"<p>I want to save the mail sent on certain days (eg.sunday) in database and then send them on next day.\nI want to know if it is possible.</p>\n\n<p>And how to save the mail object into database.</p>\n"},{"tags":["ruby-on-rails","ruby","internationalization","rails-i18n"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":46,"score":4,"question_id":13127529,"title":"How to configure Ruby on Rails app to use Buddhist calendar?","body":"<p>In Buddhist Era calendar it's already 2555 year. What is the easiest way to make Date.current show 2555 instead of 2012?</p>\n\n<p>UPDATE</p>\n\n<p>I've found solution for this particular task. It can be easily implemented with just standard rails i18n.</p>\n\n<p>cat config/locales/th.rb</p>\n\n<pre><code>{\n  th: {\n    date: {\n      formats: {\n        default: lambda { |date, _| \"%d.%m.#{date.year + 543}\" }\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>and then just use I18n.l method:</p>\n\n<pre><code>ruby-1.9.3-p194 :032 &gt; I18n.l(Date.current)\n =&gt; \"30.10.2555\"\n</code></pre>\n"},{"tags":["ruby"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13135828,"title":"is it OK to use ruby's implicit return value from []=","body":"<p>I am wandering if it is OK to use ruby's implicit return value when using <code>[]=</code> method </p>\n\n<p><code>[]=</code> uses <code>rb_hash_aset</code> and it is returning <code>val</code> - <a href=\"http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-5B-5D-3D\" rel=\"nofollow\">http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-5B-5D-3D</a></p>\n\n<p>here is a little code to demonstrate what I mean:</p>\n\n<pre><code>require 'benchmark'\nCACHE = {}\ndef uncached_method(key)\n    warn \"uncached\"\n    rand(100)\nend\ndef cached(key)\n  CACHE[key] || (CACHE[key] = uncached_method(key))\nend\ndef longer_cached(key)\n  return CACHE[key] if CACHE[key]\n  CACHE[key] = uncached_method(key)\n  CACHE[key]\nend\n\nBenchmark.bm(7) do |x|\n    y = rand(10000)\n    cached(y)\n    x.report(\"shorter:\") { 10000000.times do cached(y) end }\n    x.report(\"longer:\") { 10000000.times do longer_cached(y) end }\nend\n</code></pre>\n\n<p>of course <code>longer_cached</code> is slower because it does two hash lookups to return cached value, but when you read it line by line it makes more sense then the <code>cached</code> method.</p>\n\n<p>I think using implicit returns is one of the things that makes ruby awesome, but I have always questioned their use when setting values.</p>\n\n<p>So my question is: would you use implicit return from <code>(hash[key] = val)</code>?</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":10,"favorite_count":15,"up_vote_count":31,"down_vote_count":0,"view_count":21999,"score":31,"question_id":453762,"title":"NoMethodError when trying to invoke helper method from Rails controller","body":"<p>I'm getting a <code>NoMethodError</code> when trying to access a method defined in one of my helper modules from one of my controller classes. My Rails application uses the <code>helper</code> class method with the <code>:all</code> symbol as shown below:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  helper :all\n  .\n  .\nend\n</code></pre>\n\n<p>My understanding is that this should make all of my controller classes automatically include all of the helper modules within the app/helpers directory, therefore mixing in all of the methods into the controllers. Is this correct?</p>\n\n<p>If I explicitly <code>include</code> the helper module within the controller then everything works correctly.</p>\n"},{"tags":["ruby","deployment","rake","vlad"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13138552,"title":"Conditional remote_task execution / ignoring remote_tasks w/o corresponding hosts with Vlad","body":"<p>We are using Vlad the Deployer to deploy our application onto our landscape. The deployment consists of multiple remote tasks, some of which make only sense during production deployments, but not during staging deployments, e.g.:</p>\n\n<pre><code>remote_task :git_tag, [:branch], :roles =&gt; :git_master do |t, args|\n  [...]\nend\n</code></pre>\n\n<p>Roles/hosts are defined like this:</p>\n\n<pre><code>task :define_test do\n  host \"#{user}@&lt;hostname&gt;\", :app, :db\nend\n</code></pre>\n\n<p>Unfortunately, Vlad complains when it encounters a remote_task for which no host of the current environment has the corresponding role (like for the above <code>test</code> example):</p>\n\n<pre><code>rake aborted!\nNo target hosts specified on task us:git_tag for roles [:git_master]\n</code></pre>\n\n<p>Is there any way to tell Vlad to ignore the task under such circumstances?</p>\n"},{"tags":["ruby","ssh","provisioning","puppet"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13082996,"title":"Execute puppet file in a remote server via ssh","body":"<p>Is it possible to execute a puppet in a remote server using SSH?\nI don't want to have to install ruby on the remote server.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord","schema"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12879184,"title":"generate activerecord schema from an existing table","body":"<p>Does anyone know of a way to do this?</p>\n\n<p>I have an existing table that I created with sql and I would like to create a schema from it that would reproduce the table (minus the data)</p>\n"},{"tags":["ruby","xml-rpc","xmlrpcclient"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13137390,"title":"ruby xmlrpc client having http error","body":"<p>For using xmlrpc in ruby, I run the following code:</p>\n\n<pre><code>require \"xmlrpc/client\"\n\nserver = XMLRPC::Client.new(\"www.ruby-lang.org\", \"/RPC2\", 80)\nbegin\n    param = server.call(\"michael.add\", 4, 5)\n    puts \"4 + 5 = #{param}\"\nrescue XMLRPC::FaultException =&gt; e\n    puts \"Error:\"\n    puts e.faultCode\n    puts e.faultString\nend\n</code></pre>\n\n<p>When I run this code, I have the following error:</p>\n\n<pre><code>.../client.rb:549:in `do_rpc': HTTP-Error: 404 Not Found (RuntimeError)\n</code></pre>\n\n<p>Could you please let me know how to fix it?</p>\n"},{"tags":["ruby","unit-testing","rspec","dsl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13136377,"title":"The proper style to test a function over a variety of inputs","body":"<p>I need to test a following line:</p>\n\n<pre><code>result = handle(streamOfMessages)\n</code></pre>\n\n<p>Where <code>messages</code> and <code>context</code> are well-populated hashes. I could write the <code>it</code> like this:</p>\n\n<pre><code>messages1 = [ {\"type\"=&gt;\"someType1\",\"value\"=&gt;\"someBigHash1\"}, {\"type\"=&gt;\"someType2\",\"value\"=&gt;\"someBigHash2\"}, {\"type\"=&gt;\"someType1\",\"value\"=&gt;\"someBigHash3\"} ]\nresult1 = handle(messages1)\nresult1.should == [someValue1, someOtherValue1]\n\nmessages2 = [ {\"type\"=&gt;\"someType1\",\"value\"=&gt;\"someBigHash1\"}, {\"type\"=&gt;\"someType2\",\"value\"=&gt;\"someBigHash2\"}, {\"type\"=&gt;\"someType1\",\"value\"=&gt;\"someBigHash3\"} ]\nresult2 = handle(messages1)\nresult2.should == [someValue2, someOtherValue2]\n\n// same about messages3, result3 etc\n</code></pre>\n\n<p>I could make an array of arrays and refer to <code>messages[i]</code> in the loop. However, it all looks to me as a pretty oldskul approach, hence I am looking for a more inspiring (or even should I say <em>DSL</em>-based) programming style. It would be great to have a better syntax both for constructing a stream of messages and for iterating over several streams while expecting different results.</p>\n"},{"tags":["ruby-on-rails","ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":769,"score":3,"question_id":9551986,"title":"uninitialized constant AWS::S3::Base","body":"<p>I have this code which is in lib folder. This code works outside of rails, but when it's called from the rails controller I get the uninitialized constant AWS::S3::Base error</p>\n\n<pre><code>require 'rubygems'\nrequire 'aws/s3'\n\nmodule S3Util\n\n  def self.upload_file(local_file)\n    mime_type = \"application/octet-stream\"\n    bucket = \"test\"\n\n    AWS::S3::Base.establish_connection!(\n      :access_key_id     =&gt; '*****',\n      :secret_access_key =&gt; '****'\n    )\n\n    base_name = File.basename(local_file)\n\n    puts \"**** Uploading #{local_file} as '#{base_name}' to '#{bucket}'\"\n\n    AWS::S3::S3Object.store(\n      base_name,\n      File.open(local_file),\n      bucket,\n      :content_type =&gt; mime_type\n    )\n\n    puts \"***** Uploaded!\"\n\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","queue","resque","jobs"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12268008,"title":"How to find and kill a running Resque job on Rails?","body":"<p>I am using <a href=\"https://github.com/defunkt/resque\" rel=\"nofollow\">Resque</a> to process some background jobs on a Rails application.</p>\n\n<p>The thing is that clients can cancel this jobs, so:</p>\n\n<ul>\n<li><p>If the job is still on the queue: dequeue it</p>\n\n<pre><code>Resque.dequeue(GitHub::Jobs::UpdateNetworkGraph, 'repo:135325')\n</code></pre></li>\n<li><p>If the job has finished: do nothing</p></li>\n<li><p>If the job is running: ???</p></li>\n</ul>\n\n<p>Is there a way to programmatically find the job and in case it is running tell it to stop immediatly? My main concern is to be sure that I kill the desired job, not the current one being processed as it could be a different one form the moment I ask if it is running until the moment I kill it.</p>\n"},{"tags":["php","ruby-on-rails","ruby","apache","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13090988,"title":"Running Rails applications with Passenger alongside PHP applications","body":"<p>I'm setting a server where I will need to run Ruby On Rails 3 applications along with some PHP websites.\nThe server is a CentOS 5.8 machine running Apache 2.4.3. \nThe server is for testing and PRE-production, so performance is not an issue.</p>\n\n<p>I'm using Phusion Passenger for the Rails apps, and I've created a bunch of virtual-hosts (with associated folders and DB accounts).\nThen, I'm planning to use other v-hosts for PHP.</p>\n\n<p>Is it possible? How should I proceed?</p>\n\n<p>Thank you very much  </p>\n\n<hr>\n\n<p>details:<br>\nhttpd.conf:  </p>\n\n<pre><code>LoadModule passenger_module /app/auser/.rvm/gems/ruby-1.9.3-p286/gems/passenger-3.0.17/ext/apache2/mod_passenger.so  \nPassengerRoot /app/auser/.rvm/gems/ruby-1.9.3-p286/gems/passenger-3.0.17  \nPassengerRuby /app/auser/.rvm/wrappers/ruby-1.9.3-p286/ruby  \n</code></pre>\n\n<p>(...)  </p>\n\n<pre><code>##\n## Virtual hosts\nInclude conf/extra/httpd-vhosts-phpmyadmin.conf\nInclude conf/extra/httpd-vhosts-rails01.conf\nInclude conf/extra/httpd-vhosts-rails02.conf\nInclude conf/extra/httpd-vhosts-php01.conf\nInclude conf/extra/httpd-vhosts-php02.conf\n....\n</code></pre>\n\n<hr>\n\n<p>Passenger-managed v-hosts will be like:<br>\nInclude conf/extra/httpd-vhosts-rails01.conf  </p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n   ServerName rails01.lcl\n   DocumentRoot \"/app/auser/apps/rails01/public\"\n   &lt;Directory \"/app/auser/apps/rails01/public\"&gt;\n      AllowOverride all\n      Options -MultiViews\n   &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>PHP-based v-hosts will be like:\nInclude conf/extra/httpd-vhosts-php01.conf  </p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n    ServerName php01.lcl\n    DocumentRoot \"/app/auser/apps/php01/public\"\n    &lt;Directory \"/app/auser/apps/php01/public\"&gt;\n        Options FollowSymLinks MultiViews\n        AllowOverride None\n        Order allow,deny\n        Allow from all\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby","csv","character-encoding","multilingual"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12874612,"title":"Ruby CSV parsing from Excel with multilingual document","body":"<p>I have a csv document exported from Excel and containing both english and non-english (russian) letters.</p>\n\n<p>I've managed to open it with</p>\n\n<pre><code>CSV.open @tmp, \"rb:ISO-8859-1\", {col_sep: \";\"}\n</code></pre>\n\n<p>but it read russian symbols as <code>\\xCE\\xF1\\xF2\\xE0\\xEB\\xFC\\xED\\xFB\\xE5 \\xE7\\xE0\\xEF\\xF7</code> etc.\nI've try \"rb:ISO-8859-1:UTF-8\" but get \"ArgumentError: invalid byte sequence in UTF-8\", same as csv.open runned without mode.</p>\n\n<p>How this could be fixed? Also, how I could find 'mode' argument options - I couldn't understand from docs where it is described.</p>\n\n<p>Main environment is Ubuntu server, if it matters.</p>\n"},{"tags":["java","ruby-on-rails","ruby","java-ee"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":72,"score":2,"question_id":13127944,"title":"How to make a Ruby program work with a Java program?","body":"<p>This is not a question as such, but more like a list of things I would like to know about how to make a Ruby program work with a Java program. </p>\n\n<p>Here's the thing: We have two teams. One works on Java and implements their code and module in Java. We do the same in Ruby. We are supposed to have a set of common interfaces and use some code of theirs in our Ruby program and they are to use some of our Ruby code in their Java program. </p>\n\n<p>What are some of the things to keep in mind while connecting these two modules to give one common module? I guess this would be more like a guide or a set of guidelines than a straight answer. So please, have some patience and not report or close this question. Thank you!</p>\n\n<p><strong>Update:</strong> </p>\n\n<p>Yes, we are to use RESTful services. I do not want any sort of coding help. All I want is your contribution which you might have from your experience with coding modules in two different languages and interconnecting them with a common interface. </p>\n\n<p>That's pretty much all I would like to know. While this is indeed a class project of mine, I thought it would be better if there were guidelines somewhere so it could help other people as well. </p>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13136796,"title":"Why Integer(\"09\") throwing exception in ruby while Integer(\"07\") works pretty well?","body":"<p>I am using ruby 1.9.3</p>\n\n<p>Why Integer(\"09\") throws \"invalid value for Integer exception\" in ruby while Integer(\"07\") works pretty well?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby","eclipse","osx","gem","rvm"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":95,"score":4,"question_id":12799306,"title":"Ruby require 'some-gem' works in console, not in Eclipse?","body":"<p>Well, I'm trying to run a simple web server through \"rack\". So this is my program:</p>\n\n<pre><code>require 'rubygems'\nrequire 'rack'\n\nclass HelloWorld\n  def call(env)\n    [200, {\"Content-Type\" =&gt; \"text/html\"}, [\"Hello Rack!\"]]\n  end\nend\n\nRack::Handler::Mongrel.run HelloWorld.new, :Port =&gt; 9292\n</code></pre>\n\n<p>If I run it in the console, it works fine. If I run it in Eclipse, it ends up with error:</p>\n\n<pre><code>/Users/MY_SUPER_SECRET_USER/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- rack (LoadError)\n    from /Users/MY_SUPER_SECRET_USER/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\n    from /Users/MY_SUPER_SECRET_USER/Sites/service/service.rb:2:in `&lt;main&gt;'\n</code></pre>\n\n<p>The one that is working is called like this:</p>\n\n<pre><code>MY_SUPER_SECRET_USER@MacBook-Pro:~/Sites/service $ which ruby\n/Users/MY_SUPER_SECRET_USER/.rvm/rubies/ruby-1.9.3-p194/bin/ruby\nMY_SUPER_SECRET_USER@MacBook-Pro:~/Sites/service $ ruby service.rb\n</code></pre>\n\n<p>Then when I try to open <code>localhost:9292</code> it shows the expected \"Hello Rack\" code.</p>\n\n<p>I'm on Mac OS X 10.8, with ruby 1.9.3 installed through rvm (this must be obvious). My \"rack\" package has been installed with <code>sudo gem install rack</code></p>\n\n<p>So as you can see, the Eclipse is configured with the very same ruby executable. Any suggestions will be of great help!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13131340,"title":"Using paginate while fetching results by a SQL query in ruby","body":"<p>I have the following query in my Rails Controller:</p>\n\n<pre><code>SELECT CODE_VER FROM MASTERTEST WHERE DATE&gt;= DATE_SUB(CURDATE(), INTERVAL 90 DAY) ORDER BY DATE DESC;\n</code></pre>\n\n<p>This query returns me results from the last 90 days. I display all these results in a table right now. </p>\n\n<p>I want to show only rows from 7 days at a time in some kind of pagination. I have tried will_paginate and kaminari and also paginate_by_sql. But I haven't been successful using any of them so far.</p>\n\n<p>Can someone show me the exact syntax incase of my query?</p>\n"},{"tags":["ruby","unit-testing","jar","warbler"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13136219,"title":"warbler unit tests","body":"<p>I'm using Warbler to build .jar file from my jruby code and run it on platform that does not have ruby installed. \nI want to execute acceptance tests -> for that i use ruby minitest unit tests.\nThe only option i found is to require_relevant this test class from entry point class, but it does not call test methods.</p>\n\n<p>In my unit test class i use require 'minitest/autorun'.\nWhen i execute them in IDE - i get test run log.\nWhen i run them from jar - i get no result/flow.</p>\n\n<p>So question is:\nhow to correctly run unit tests from jar/jruby ?\nhow to point at other entry point.</p>\n\n<p>Thanks. </p>\n"},{"tags":["ruby","math","loops","equation","solver"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13133915,"title":"Equation solver within tolerance","body":"<p>I'm trying to design a Ruby script that will help with RC/RL circuit design by taking values of E24 series resistors and E12 and E6 series capacitors and inductors. Basically just cycling through each possible combination with the equation <code>F = 1 / ( 2 * Pi * R * C )</code> [for the RC circuit for eg].</p>\n\n<p>I'm not after efficiency here, just reliability. I need it to cycle through every single combination of the resistor array and capacitor/inductor array (never all 3) using the values for the equation above and if it is within plus/minus x% of a certain value to return which values in the array it used. I can nest 2 for loops to go through each combination, but I want it to not just return values within a tolerance but tell me which value is the closest (or exact).</p>\n"},{"tags":["ruby-on-rails","ruby","testing","shoulda","backtrace"],"answer_count":3,"favorite_count":2,"up_vote_count":7,"down_vote_count":0,"view_count":321,"score":7,"question_id":4214219,"title":"Is shoulda destroying my backtraces?","body":"<p>I have a test more or less like this:</p>\n\n<pre><code>class FormDefinitionTest &lt; ActiveSupport::TestCase\n  context \"a form_definition\" do\n    setup do\n      @definition = SeedData.form_definition\n      # ...\n</code></pre>\n\n<p>I've purposely added a </p>\n\n<pre><code>raise \"blah\"\n</code></pre>\n\n<p>somewhere down the road and I get this error:</p>\n\n<pre><code>RuntimeError: blah\ntest/unit/form_definition_test.rb:79:in `__bind_1290079321_362430'\n</code></pre>\n\n<p>when I should be getting something along:</p>\n\n<pre><code>/Users/pupeno/projectx/db/seed/sheet_definitions.rb:17:in `sheet_definition': blah (RuntimeError)\n    from /Users/pupeno/projectx/db/seed/form_definitions.rb:4:in `form_definition'\n    from /Users/pupeno/projectx/test/unit/form_definition_test.rb:79\n</code></pre>\n\n<p>Any ideas what is sanitizing/destroying my backtraces? My suspicious is shoulda because the when the exception happens inside a setup or should is whet it happens.</p>\n\n<p>This is a Rails 3 project, in case that's important.</p>\n"},{"tags":["ruby"],"answer_count":5,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":245,"score":1,"question_id":5244507,"title":"Gotchas for redefining methods  in ruby","body":"<p>What are the things to be careful about while redefining methods in Ruby? Is redefining core library methods okay? </p>\n"},{"tags":["ruby","blas","gsl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13130692,"title":"Ruby GSL: _cblas_dnrm2","body":"<p>I'm using osx 10.8 and ruby 1.9.3. \nGSL is correctly installed and I'm also able to install rb-gsl without any problems.</p>\n\n<p>cblas and atlas libs are checked and included:</p>\n\n<pre><code>checking for main() in -lcblas... yes\nchecking for main() in -latlas... yes\nchecking gsl libs... -L/opt/local/lib -lgsl -lcblas -latlas\n</code></pre>\n\n<p>However as soon as i use any gem dependent on rb-gsl i will get this error:</p>\n\n<pre><code>dyld: lazy symbol binding failed: Symbol not found: _cblas_dnrm2\n  Referenced from: /opt/local/lib/libgsl.0.dylib\n  Expected in: flat namespace\n\ndyld: Symbol not found: _cblas_dnrm2\n  Referenced from: /opt/local/lib/libgsl.0.dylib\n  Expected in: flat namespace\n\nTrace/BPT trap: 5\n</code></pre>\n\n<p>About 2 months ago i was able to work with rb-gsl without any problems, I just can't understand how this could happen and how to fix it.\nI have also downloaded and compiled LAPACK + BLAS and I can notice that dnrm2.o is present. Can someone explain me if I need it and if yes how to \"link it\" to GSL?.</p>\n\n<p>EDIT: gsl-config returns correct linking info:</p>\n\n<pre><code>gsl-config  --libs\n-L/opt/local/lib -lgsl -lgslcblas\n</code></pre>\n"},{"tags":["html","ruby","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13134844,"title":"writing HTML in ruby","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10561177/what-does-mean-in-ruby\">What does “&lt;&lt;-” mean in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I saw this in devise_helper.rb</p>\n\n<pre><code>html = &lt;&lt;-HTML\n&lt;div&gt; ... &lt;/div&gt;\nHTML\n\nhtml.html_safe\n</code></pre>\n\n<p>what is this <code>&lt;&lt;-HTML .. HTML</code> notation?</p>\n"},{"tags":["ruby-on-rails","ruby","database","activerecord","schema"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13134191,"title":"How to generate database schema graph for one application using ActiveRecord?","body":"<p>I want to generate graphs to describe the relations within a application using ActiveRecord, is there some gem to accomplish that?</p>\n\n<p>such as this one\n<img src=\"https://upload.wikimedia.org/wikipedia/commons/3/36/Mediawiki_database_Schema.svg\" alt=\"database graph\"></p>\n"},{"tags":["ruby","aptana"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":21,"score":-1,"question_id":13134385,"title":"SWT error in APTANA","body":"<p>Whenever i am opening Aptana i am getting the following error.</p>\n\n<p>'Showing My Aptana' has encountered a problem.</p>\n\n<p>An internal error has occurred.</p>\n\n<p>If i click ok then it displays one more alert.</p>\n\n<p>Like An SWT error has occurred.</p>\n\n<p>You are recommended to exit the workbench.</p>\n\n<p>Please help me to resolve the error. </p>\n"},{"tags":["ruby","rubygems","gem","github-api"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12559969,"title":"Ruby gem which needs to keep track of user's github credentials","body":"<p>I'm writing a ruby gem , which has a command line interface ( making use of Thor ) \nI'm calling it \"myrubygem\" .</p>\n\n<p>User should be able to do the following :</p>\n\n<pre><code>myrubygem init\n</code></pre>\n\n<p>This should ask for a github login and password and create a repository on github using a github api (Apart from some other stuff that I want the gem to do).</p>\n\n<pre><code>myrubygem push \n</code></pre>\n\n<p>This should commit and push some files to the repo . This can be a repetitive operation and I don't want to keep asking the user for his github login and password . Also , storing the password in a textfile won't be a good idea as well . </p>\n\n<p>Is there a way to cache the credentials so that only the first command needs the prompt , and the rest of the commands can remember the credentials ?</p>\n"},{"tags":["mysql","ruby","dbi"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13132251,"title":"How do I connect to a remote mysql server using DBI?","body":"<p>I am having trouble connecting to a MySQL DB on a remote server via Ruby and the DBI gem. </p>\n\n<p>For this example, the DB host's address is 000.00.00.000, and the name of the DB is <code>testdb</code>. </p>\n\n<p>Should <code>username</code> be my personal username I SSH into the server with or a specific MySQL username?\nShould <code>password</code> be my personal password I SSH with or the MySQL password I use once I'm on?\nDo I need to specify the port or anything else along with the IP address?</p>\n\n<p>Here is the code I'm currently trying to use, which I found <a href=\"http://www.kitebird.com/articles/ruby-mysql.html\" rel=\"nofollow\">on this tutorial</a></p>\n\n<pre><code>require 'rubygems'\nrequire 'mysql'\nrequire 'dbi'\n\n#connect to mysql database\n\nbegin\n # connect to the MySQL server\n dbh = DBI.connect(\"DBI:Mysql:testdb:000.00.00.000\", \n                    \"username\", \"password\")\n # get server version string and display it\n row = dbh.select_one(\"SELECT VERSION()\")\n puts \"Server version: \" + row[0]\nrescue DBI::DatabaseError =&gt; e\n puts \"An error occurred\"\n puts \"Error code:    #{e.err}\"\n puts \"Error message: #{e.errstr}\"\nensure\n # disconnect from server\n dbh.disconnect if dbh\nend\n</code></pre>\n\n<p>When I run: </p>\n\n<pre><code>Error code:    2003\nError message: Can't connect to MySQL server on  ... (60)\n</code></pre>\n\n<p>On SSH I am currently getting into MySQL with this command:</p>\n\n<pre><code>mysql -u root testdb -p\n</code></pre>\n\n<p>I have the password for this and that functions in my terminal.</p>\n\n<p>What should I be putting in the DBI connect statement to connect correctly via Ruby?</p>\n"},{"tags":["ruby-on-rails","ruby","pg"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13133334,"title":"How to install \"pg\" gem for rails 3 on ubuntu \"can not build native extensions\"","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6040583/unable-to-install-pg-gem-on-ubuntu-cant-find-the-libpq-fe-h-header\">Unable to install pg gem on ubuntu - Can’t find the &#39;libpq-fe.h header</a>  </p>\n</blockquote>\n\n\n\n<p>Whenever I try to install the pg gem for my Rails project, it gives me <code>Error \"failed to build native extensions\"</code>.</p>\n\n<p>I already used a couple of tricks but failed.</p>\n"},{"tags":["ruby","watir","watir-webdriver"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1504,"score":3,"question_id":5963606,"title":"watir-webdriver checking table size rows and columns count","body":"<p>I am starting the process of converting my WATIR scripts to use WATIR webdriver.\nThere a couple of table methods I was using in my WATIR scripts to check the size (rows and columns) of a HTML table.</p>\n\n<pre><code>myTable.row_count\nmyTable.column_count\n</code></pre>\n\n<p>These methods don't exist in webdriver so I am looking for a good way of doing the same check.</p>\n\n<p>For rows this seems to give the same result as the row_count method</p>\n\n<pre><code>myTable.rows.length\n</code></pre>\n\n<p>For column count of the table I've tried converting the table to an array of strings and getting the length of the first row, but the conversion to the string array is taking a while.</p>\n\n<pre><code>myCols = myTable.strings[0].length\n</code></pre>\n\n<p>Can anyone suggest a better/ quicker method of getting the table size? </p>\n"},{"tags":["ruby","linux"],"answer_count":5,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":13132741,"title":"How do I to run a command in Linux as a Ruby script?","body":"<p>Let's say I have some terminal commands like:</p>\n\n<pre><code>sudo mycommand1\nmycommand2\n#.....\n</code></pre>\n\n<p>What should I do run them via ruby script  (not bash) in Ubuntu?</p>\n\n<p>UPDATE:\nI have a ruby script:</p>\n\n<pre><code>def my_method1()\n  #calculating something.....\nend\n\ndef method2(var1, var2)\n  #how do I sudo mycommand1 and any other Lunix command from here?\nend\n\ndef method3(var4)\n  #calculating something2....\nend\n</code></pre>\n"},{"tags":["ruby","regex"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13132442,"title":"Selecting Content in quotes using regex","body":"<p>If I have:</p>\n\n<pre><code>    [\"eaacbf7e-37b3-509e-b2d1-ddce7f0e1f6e\", \"f9e52e06-697a-57af-9566-d05fabb001a4\", \n     \"19edb822-eccb-5289-8fee-a39cdda66cd5\", \"83d3ad63-b468-5a1e-ba6c-6b69eb4a3dc5\"]\n</code></pre>\n\n<p>(where the entire thing is a string) </p>\n\n<p>Is there a simple regular expression that I can use to select content within the quotes (quotes included)?</p>\n\n<p>Since the above comes out as a string. I want to use regex to select out each id within the quotes (along with the quotes) and store them into a ruby array.</p>\n"},{"tags":["ruby","rexml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13132623,"title":"REXML: How to add the root element in a exiting but empty file?","body":"<p>I have an empty XML page I've called \"users.xml\". I'd like to be able to create all the content using REXML. </p>\n\n<pre><code>require \"rexml/document\"\ninclude REXML  # so that we don't have to prefix everything with REXML::...\n\nxmlfile = File.new(\"users.xml\")\ndoc = Document.new(xmlfile)\n\n//code to save root element here...\n</code></pre>\n\n<p>It looks to me that <code>doc</code> reads first the content of \"users.xml\", but changes that occurred in doc do not propagate back. How do I save changes to the file?  </p>\n"},{"tags":["ruby","shoes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12672786,"title":"Not able to execute Shoes from command","body":"<p>I have installed shoes on my MAC BookPro and tried executing from the terminal and got the following error message.</p>\n\n<p>jfleck-mbp:scripts_in_progress joe.fleck$ shoes just_for_fun.rb </p>\n\n<p>-bash: shoes: command not found</p>\n\n<p>Below you will find the installation of Shoes was successful and according to their instructions the 'shoes just_for_fun.rb' should execute the app.</p>\n\n<p>Installation sudo gem install shoes Password: Fetching:<br>\nshoes-3.0.1.gem (100%) \nSuccessfully installed shoes-3.0.1 1 gem<br>\ninstalled Installing ri documentation for shoes-3.0.1...</p>\n\n<p>Installing    RDoc documentation for shoes-3.0.1...</p>\n\n<p>Here is my code:\nrequire 'Shoes'</p>\n\n<p>Shoes.app {</p>\n\n<pre><code>button(\"Trul?\") {\n        alert(\"Klapaucius!\")\n    }\n}\n</code></pre>\n\n<p>So, I am new to this and not sure were to go from here.  Any help would be greatly appreciated.</p>\n\n<p>Thank you,\nJoe</p>\n"},{"tags":["ruby-on-rails","ruby","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13130913,"title":"HAML loop through has_and_belongs_to_many objects instead of ids","body":"<pre><code>class Team\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  field :name,              :type =&gt; String, :default =&gt; \"My New Team\"\n  validates_presence_of :name\n  has_and_belongs_to_many :users\n\nend\n</code></pre>\n\n<p>In my show.haml for Team, I'm trying:</p>\n\n<pre><code> - @team[:users].each do |user|\n        %tr\n          %td= link_to user.name, user\n          %td= user.email\n</code></pre>\n\n<p>But the problem is that Mongo is storing the users reference as user_ids. So</p>\n\n<ul>\n<li>@team[:user_ids].each do |user|</li>\n</ul>\n\n<p>But now I'll have to execute a query for each user... Before I do so I just wanted to know if there is another way to loop through the users? I was thinking of putting a variable in the controller called @user_objects but not sure how to generate that without looping through all the user_ids and doing a find() call.</p>\n"},{"tags":["ruby","regex"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":55,"score":0,"question_id":13132563,"title":"Regular expression with back reference","body":"<p>Can anybody explain how exactly the back reference works in ruby regular expression? I particularly want to know exactly how <code>(..)</code> grouping works. For example:</p>\n\n<pre><code>s = /(..) [cs]\\1/.match(\"The cat sat in the hat\")\n\nputs s \n</code></pre>\n\n<p>for the code snippet above, the output is: <code>at sat</code>. Why/How is it getting this output ?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13130017,"title":"Simple error in my rails app","body":"<p>I have an error in my rails app telling me that the index method is undefined.\nI have created a such simple form just for inserting data using the (new method page) only\nbut it is not working now for some reason</p>\n\n<pre><code>class PeoplesController &lt; ApplicationController\n\n  def index\n\n  end\n\n  def new\n    @people = People.new\n  end\n\n  def create\n    @people = People.new(params[:@people])\n    if @people.save\n      redirect_to new_people_path\n    end\n  end\nend\n\n\n# new.html.haml\n&lt;h2&gt;Hello there!&lt;/h2&gt;\n&lt;hr &gt;\n&lt;%= form_for @people do |f| %&gt;\n    FirstName:&lt;%= f.text_field :first %&gt;&lt;br /&gt;\n    LastName:&lt;%= f.text_field :last %&gt;&lt;br /&gt;\n    &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the error code:</p>\n\n<pre><code>    NoMethodError in Peoples#new\n\nShowing /Users/kasim/Desktop/form/app/views/peoples/new.html.erb where line #3 raised:\n\nundefined method `people_index_path' for #&lt;#&lt;Class:0x007fa33da58d58&gt;:0x007fa34031c578&gt;\nExtracted source (around line #3):\n\n1: &lt;h2&gt;Hello there!&lt;/h2&gt;\n2: &lt;hr &gt;\n3: &lt;%= form_for @people do |f| %&gt;\n4:  FirstName:&lt;%= f.text_field :first %&gt;&lt;br /&gt;\n5:  LastName:&lt;%= f.text_field :last %&gt;&lt;br /&gt;\n6:  &lt;%= f.submit %&gt;\n</code></pre>\n"},{"tags":["ruby","constructor"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13132010,"title":"Assigning a member variable to the result of a block of code in Ruby","body":"<p>I want to assign a member variable to the result of a lengthy block of code that returns a 2x2 array. This would be done in the constructor. But if in the constructor I do, </p>\n\n<pre><code>def initialize\n@foo = ...\n       ...\nend\n</code></pre>\n\n<p>Then only the first line of code in that block gets assigned to @foo. If I define a method, then I get an unknown method error during compilation, which makes sense because it doesn't know which instance to call it on. I don't think I can do 'self', because it's in the constructor so there is no instance yet.</p>\n\n<p>I don't want the block of code in the class definition, I would like it neatly encapsulated somewhere instead. A class method would require making other variables available to that method that should just belong to each instance.</p>\n"},{"tags":["ruby","multithreading","concurrency","locking","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":12023798,"title":"Odd bug with DataMapper, Mutexes, and Threads?","body":"<p>I have a database full of URLs that I need to test HTTP response time for on a regular basis.  I want to have many worker threads combing the database at all times for a URL that hasn't been tested recently, and if it finds one, test it.</p>\n\n<p>Of course, this could cause multiple threads to snag the same URL from the database.  I don't want this.  So, I'm trying to use Mutexes to prevent this from happening.  I realize there are other options at the database level (optimistic locking, pessimistic locking), but I'd at least prefer to figure out why this isn't working.</p>\n\n<p>Take a look at this test code I wrote:</p>\n\n<pre><code>threads = []\nmutex = Mutex.new\n\n50.times do |i|\n  threads &lt;&lt; Thread.new do\n    while true do \n      url = nil\n\n      mutex.synchronize do\n        url = URL.first(:locked_for_testing =&gt; false, :times_tested.lt =&gt; 150)\n        if url\n          url.locked_for_testing = true\n          url.save \n        end\n      end\n\n      if url\n        # simulate testing the url\n        sleep 1\n\n        url.times_tested += 1\n        url.save\n\n        mutex.synchronize do\n          url.locked_for_testing = false\n          url.save\n        end\n      end\n    end\n\n    sleep 1\n  end\nend\n\nthreads.each { |t| t.join }\n</code></pre>\n\n<p>Of course there is no real URL testing here.  But what <em>should</em> happen is at the end of the day, each URL should end up with \"times_tested\" equal to 150, right?</p>\n\n<p>(I'm basically just trying to make sure the mutexes and worker-thread mentality are working)</p>\n\n<p>But each time I run it, a few odd URLs here and there end up with times_tested equal to a much lower number, say, 37, and locked_for_testing frozen on \"true\"</p>\n\n<p>Now as far as I can tell from my code, if any URL gets locked, it will <em>have</em> to unlock.  So I don't understand how some URLs are ending up \"frozen\" like that.</p>\n\n<p>There are no exceptions and I've tried adding begin/ensure but it didn't do anything.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":142,"score":3,"question_id":7976996,"title":"datamapper many-to-many table name","body":"<p>I'm making blog service with datamapper and defined Article and Tag model like below.</p>\n\n<pre><code>class Article\n  include DataMapper::Resource\n\n  property :id, Serial\n\n  has n, :tags, :through =&gt; Resource\nend\n\nclass Tag\n  include DataMapper::Resource\n\n  property :id, Serial\n\n  has n, :articles, :through =&gt; Resource\nend\n</code></pre>\n\n<p>And these relationships defined in 'article_tags' table.</p>\n\n<ul>\n<li>How is that table name defined?</li>\n<li>Why not 'articles_tags'?</li>\n<li>Can I change table name without create custom table model class?</li>\n</ul>\n\n<p>sorry for my poor english.</p>\n"},{"tags":["ruby","rspec","bdd","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13132228,"title":"How do I actually pre/post-process RSpec example based on the arguments passed to describe or it","body":"<p>Need some help understanding:</p>\n\n<blockquote>\n  <p>In <code>rspec-2</code>, every example and example group comes with metadata\n  information like the file and line number on which it was declared,\n  <em>the arguments passed to <code>describe</code> and <code>it</code></em>, etc. This metadata can be\n  appended to through a hash argument passed to <code>describe</code> or <code>it</code>, allowing\n  us <em>to pre and post-process each example in a variety of ways</em>.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/rspec/rspec-core/blob/master/features/Upgrade.md\" rel=\"nofollow\">https://github.com/rspec/rspec-core/blob/master/features/Upgrade.md</a> — <strong>«Metadata!»</strong> section</p>\n\n<p>I'd like to have the following shortcut:</p>\n\n<pre><code>describe 'DELETE destroy', :as =&gt; :admin do\n  it 'destroys...' do\n    # ...\n  end\nend\n</code></pre>\n\n<p>for</p>\n\n<pre><code>describe 'DELETE destroy as admin' do\n  before { login_as :admin }\n\n  it 'destroys...' do\n    # ...\n  end\nend\n</code></pre>\n\n<p>Is metadata-based example pre/post-processing appropriate in the case or it was made for «external» things like <em>filtering</em>?</p>\n"},{"tags":["ruby-on-rails","ruby","rvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":95,"score":2,"question_id":13131794,"title":"Ruby On Rails libyaml","body":"<p>I'm running rails version 3.2.8 and ruby version 1.9.3-p286 on Linux</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rails -v\nRails 3.2.8\nuser1@company.com [~/rails_apps/myapp]# ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\nuser1@company.com [~/rails_apps/myapp]#\n</code></pre>\n\n<p>I can generate a migration but I cannot run it. I keep getting the following error message</p>\n\n<pre><code>user1@company.com [~/rails_apps/myapp]# rake db:migrate\n/home3/user1/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/yaml.rb:56:in `&lt;top (required)&gt;':\nIt seems your ruby installation is missing psych (for YAML output).\nTo eliminate this warning, please install libyaml and reinstall your ruby.\n/home3/user1/ruby/gems/gems/json-1.7.5/lib/json/common.rb:67: [BUG] unknown type 0x22 (0xc given)\nruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\n&lt;snip&gt;\n</code></pre>\n\n<p>then a lot of debug info\n    </p>\n\n<pre><code>[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAborted\nuser1@company.com [~/rails_apps/myapp]#\n</code></pre>\n\n<p>I installed libyaml</p>\n\n<pre><code>rvm pkg install libyaml\n</code></pre>\n\n<p>then reinstalled ruby</p>\n\n<pre><code>rvm reinstall ruby-1.9.3-p286\n</code></pre>\n\n<p>but that did not help.</p>\n\n<p>Any other ideas why I keep getting this error message?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","validation","model"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13105264,"title":"How do I create a validation that checks if at least one of multiple booleans is true?","body":"<p>I have a Rails 3.2 app that manages tasks.  Here tasks are being assigned to users.  The task model has multiple user variables that are booleans.  How would I add a validation to say that at least one user is set to true?</p>\n\n<p>Original:</p>\n\n<pre><code>class Task &lt; ActiveRecord::Base\n  attr_accessible :title, :user1, :user2, :user3, :user4:\n  validates :title, :presence =&gt; true\n  validates :is_assigned\n\n\n  def is_assigned\n    if #AT_LEAST_ONE_USER_IS_TRUE\n      errors.add(\"The task must be assigned to at least one user.\")\n    end\n  end\n\nend\n</code></pre>\n\n<p>Edited:</p>\n\n<pre><code>class Task &lt; ActiveRecord::Base\n  attr_accessible :title, :user1, :user2, user3, :user4\n\n  validates :title, :presence =&gt; true\n  validate :is_assigned\n\n  def is_assigned\n    unless @user1 || @user2 || @user3 || @user4\n      errors.add(:user1, \"The task must be assigned to at least one user.\")\n    end\n  end\n\nend\n</code></pre>\n\n<p>I'm getting closer I think but this does not work.  The error seems to always appear.</p>\n\n<p>Also it looks like errors.add requires another variable.  How do I give it all users instead of just user1?  </p>\n"},{"tags":["ruby-on-rails","ruby","rake"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13132226,"title":"rake task aborts on unknown attribute","body":"<p>I am running a rake task that imports data from a CSV file into my rails application.</p>\n\n<p>It succesfully imports 546 models, but then it aborts, giving the following error:</p>\n\n<pre><code>rake aborted!\nunknown attribute: \n</code></pre>\n\n<p>The csv row hash that is causing this seems fine:</p>\n\n<pre><code>{\"name\"=&gt;\"Thai \", \"address\"=&gt;\"Av. Principal de Prados del Este. C.C. Galerias Local PB-08\", \"urbanization\"=&gt;\"Prados del Este\", \"phone\"=&gt;\"02129762607\"}\n</code></pre>\n\n<p>Other hashes that were succesfully saved:</p>\n\n<pre><code>{\"name\"=&gt;\"La Propia\", \"address\"=&gt;\"Calle Los Liberales con Av. Los Samanes\", \"urbanization\"=&gt;\"El Paraiso\", \"phone\"=&gt;\"02124841571\"}\n\n{\"name\"=&gt;\"Del Canalito Natural\", \"address\"=&gt;\"Avenida Principal de Los Ruices, entre Avenida Rómulo Gallegos y Avenida Francisco de Miranda\", \"urbanization\"=&gt;\"Los Ruices\", \"phone\"=&gt;\"02122374702\"}\n</code></pre>\n\n<p>I am not entirely sure what is going on. Here is a full trace of the error:</p>\n\n<pre><code>/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/attribute_assignment.rb:88:in `block in assign_attributes'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/attribute_assignment.rb:78:in `each'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/attribute_assignment.rb:78:in `assign_attributes'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/base.rb:498:in `initialize'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/persistence.rb:44:in `new'\n/usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/persistence.rb:44:in `create'\n/Users/alexbrand/Desktop/papaya/lib/tasks/csv.rake:13:in `block (3 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1792:in `each'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1208:in `block in foreach'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1354:in `open'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/csv.rb:1207:in `foreach'\n/Users/alexbrand/Desktop/papaya/lib/tasks/csv.rake:6:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `load'\n/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin/rake:19:in `&lt;main&gt;'\n/usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'\n/usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\nTasks: TOP =&gt; csv:import\n</code></pre>\n"},{"tags":["ruby","install","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":13115189,"title":"Ruby installation issue using RVM","body":"<p>I am having trouble installing Ruby using RVM. I had tried using readline and other suggestions online. None of the solutions worked.</p>\n\n<p>I use Cygwin, Bash and have RVM installed.</p>\n\n<pre><code>rvm install 1.9.2\nNo binary rubies available for: /ruby-1.9.2-p320.\nContinuing with compilation. Please read 'rvm mount' to get more information on    binary  rubies.\nFetching yaml-0.1.4.tar.gz to /home/arvenkataraman/.rvm/archives\nExtracting yaml-0.1.4.tar.gz to /home/arvenkataraman/.rvm/src\nConfiguring yaml in /home/arvenkataraman/.rvm/src/yaml-0.1.4.\nCompiling yaml in /home/arvenkataraman/.rvm/src/yaml-0.1.4.\nError running 'make', please read /home/arvenkataraman/.rvm/log/ruby-1.9.2-p320/yaml/make.log\nInstalling Ruby from source to: /home/arvenkataraman/.rvm/rubies/ruby-1.9.2-p320, this may take a while depending on your cpu(s)...\nruby-1.9.2-p320 - #downloading ruby-1.9.2-p320, this may take a while depending on your connection...\nruby-1.9.2-p320 - #extracting ruby-1.9.2-p320 to /home/arvenkataraman/.rvm/src/ruby-  1.9.2-p320\nruby-1.9.2-p320 - #extracted to /home/arvenkataraman/.rvm/src/ruby-1.9.2-p320\nruby-1.9.2-p320 - #configuring\nruby-1.9.2-p320 - #compiling\nruby-1.9.2-p320 - #installing\nruby-1.9.2-p320 is not installed.\nTo install do: 'rvm install ruby-1.9.2-p320'\n</code></pre>\n\n<p>I see the below in the error log \"/home/arvenkataraman/.rvm/log/ruby-1.9.2-p320/yaml/make.log\"</p>\n\n<pre><code>$ cat /home/arvenkataraman/.rvm/log/ruby-1.9.2-p320/yaml/make.log\nCDPATH=\"${ZSH_VERSION+.}:\" &amp;&amp; cd . &amp;&amp; /bin/sh /home/arvenkataraman/.rvm/src/yaml-0.1.4/config/missing --run aclocal-1.11\ncd . &amp;&amp; /bin/sh /home/arvenkataraman/.rvm/src/yaml-0.1.4/config/missing --run automake-1.11 --foreign\nsrc/Makefile.am:2: Libtool library used but `LIBTOOL' is undefined\nsrc/Makefile.am:2:   The usual way to define `LIBTOOL' is to add `LT_INIT'\nsrc/Makefile.am:2:   to `configure.ac' and run `aclocal' and `autoconf' again.\nsrc/Makefile.am:2:   If `LT_INIT' is in `configure.ac', make sure\nsrc/Makefile.am:2:   its definition is in aclocal's search path.\nMakefile:256: recipe for target `Makefile.in' failed\nmake: *** [Makefile.in] Error 1\n</code></pre>\n"},{"tags":["ruby","activerecord","rubymine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13132157,"title":"Ruby ActiveRecord dynamic methods deprecated?","body":"\n\n<p>I'm writing a small IRC notes system, and have decided to use ActiveRecord an an attempt to learn something about Ruby. Something I've noticed is that AR generates these nifty dynamic methods where if I have a row called <code>recipients</code>, I get a method for free called <code>find_all_by_recipients</code>.</p>\n\n<p>That's great, problem is it makes my IDE (RubyMine) very unhappy. It can't resolve the reference to that <code>find_all_by_recipients</code> method, predictably because it doesn't exist yet and is created at runtime.</p>\n\n<p>I was doing some further research on AR today and stumbled across a slide deck <a href=\"http://www.slideshare.net/rabble/introduction-to-active-record-silicon-valley-ruby-conference-20007\" rel=\"nofollow\">here</a> that suggests the <code>find_all</code> method is deprecated. That would make sense with the IDE behavior.</p>\n\n<p>So, which of these is The Ruby Way© in the year 2012?</p>\n\n<p><code>Note.find(:all, :conditions =&gt; {:recipient =&gt; \"#{m.user.nick}\"})</code></p>\n\n<p>or</p>\n\n<p><code>Note.find_all_by_recipient(#{m.user.nick})</code></p>\n\n<p>I'm partial to the later one, it looks much cleaner.</p>\n"},{"tags":["ruby-on-rails","ruby","activerecord"],"answer_count":3,"favorite_count":6,"up_vote_count":6,"down_vote_count":0,"view_count":1412,"score":6,"question_id":1253426,"title":"What is the difference between build and new on Rails?","body":"<p>Can anyone tell me what is the difference between build and new command on Rails?</p>\n"},{"tags":["ruby","sinatra","omniauth","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":13131862,"title":"Access OmniAuth helper in Sinatra view","body":"<p>I'm new to this, so forgive me if I'm being stupid!</p>\n\n<p>I'm using <a href=\"https://github.com/charliepark/omniauth-for-sinatra\" rel=\"nofollow\">OmniAuth for Sinatra</a> to help authenticate users. In my <code>layout.erb</code>, I'd like to access the <code>current_user</code> helper to check if the user is logged in. The helper goes like this:</p>\n\n<pre><code>def current_user\n    @current_user ||= User.get(session[:user_id]) if session[:user_id]\nend\n</code></pre>\n\n<p>But I'm not sure how to access it in my layout view. I thought this would do the trick:</p>\n\n<pre><code>&lt;% if current_user %&gt; Do stuff here &lt;% end %&gt;\n</code></pre>\n\n<p>But no luck. Any help would be appreciated! Like I said, I'm new to Ruby, and I'm not a strong developer.</p>\n"},{"tags":["ruby","keyboard-shortcuts","comments","text-editor"],"answer_count":3,"favorite_count":4,"up_vote_count":42,"down_vote_count":0,"view_count":15087,"score":42,"question_id":536760,"title":"Block commenting in Ruby","body":"<p>Does Ruby have block comments?</p>\n\n<p>If not, is there an efficient way of inserting <code>#</code> in front of a block of highlighted code in TextMate?</p>\n"},{"tags":["ruby-on-rails","ruby","single-table-inheritance"],"answer_count":6,"favorite_count":13,"up_vote_count":31,"down_vote_count":0,"view_count":3264,"score":31,"question_id":4507149,"title":"Best practices to handle routes for STI subclasses in rails","body":"<p>My Rails views and controllers are littered with <code>redirect_to</code>, <code>link_to</code>, and <code>form_for</code> method calls. Sometimes <code>link_to</code> and <code>redirect_to</code> are explicit in the paths they're linking (e.g. <code>link_to 'New Person', new_person_path</code>), but many times the paths are implicit (e.g. <code>link_to 'Show', person</code>). </p>\n\n<p>I add some single table inheritance (STI) to my model (say <code>Employee &lt; Person</code>), and all of these methods break for an instance of the subclass (say <code>Employee</code>); when rails executes <code>link_to @person</code>, it errors with <code>undefined method employee_path' for #&lt;#&lt;Class:0x000001022bcd40&gt;:0x0000010226d038&gt;</code>. Rails is looking for a route defined by the class name of the object, which is employee. These employee routes are not defined, and there is no employee controller so the actions aren't defined either.</p>\n\n<p>This question has been asked before:</p>\n\n<ol>\n<li>At <a href=\"http://stackoverflow.com/questions/1773367/link-to-issue-with-inherited-active-record-class\">StackOverflow</a>, the answer is to edit every instance of link_to etc in your entire codebase, and state the path explicitly</li>\n<li>On <a href=\"http://stackoverflow.com/questions/702728/get-route-for-base-class-of-sti-class-in-rails\">StackOverflow</a> again, two people suggest using <code>routes.rb</code> to map the subclass resources to the parent class (<code>map.resources :employees, :controller =&gt; 'people'</code>). The top answer in that same SO question suggests type-casting every instance object in the codebase using <code>.becomes</code></li>\n<li>Yet another one at <a href=\"http://stackoverflow.com/questions/4432858/broken-rails-routes-after-implementing-single-table-inheritance\">StackOverflow</a>, the top answer is way in the Do Repeat Yourself camp, and suggests creating duplicate scaffolding for every subclass.</li>\n<li><a href=\"http://stackoverflow.com/questions/943300/single-table-inheritance-routing\">Here's</a> the same question again at SO, where the top answer seems to just be wrong (Rails magic Just Works!)</li>\n<li>Elsewhere on the web, I found <a href=\"http://strugglingwithruby.blogspot.com/2008/10/single-table-inheritance.html\">this blog post</a> where F2Andy recommends editing in the path everywhere in the code.</li>\n<li>On the blog post <a href=\"http://blog.lrdesign.com/2009/03/single-table-inheritance-and-restful-routes/\">Single Table Inheritance and RESTful Routes</a> at Logical Reality Design, it is recommended to map the resources for the subclass to the superclass controller, as in SO answer number 2 above.</li>\n<li>Alex Reisner has a post <a href=\"http://code.alexreisner.com/articles/single-table-inheritance-in-rails.html\">Single Table Inheritance in Rails</a>, in which he advocates against mapping the resources of the child classes to the parent class in <code>routes.rb</code>, since that only catches routing breakages from <code>link_to</code> and <code>redirect_to</code>, but not from <code>form_for</code>. So he recommends instead adding a method to the parent class to get the subclasses to lie about their class. Sounds good, but his method gave me the error <code>undefined local variable or method `child' for #</code>.</li>\n</ol>\n\n<p>So the answer that seems most elegant and has the most consensus (but it's not all <em>that</em> elegant, nor <em>that</em> much consensus), is the add the resources to your <code>routes.rb</code>. Except this doesn't work for <code>form_for</code>. I need some clarity! To distill the choices above, my options are</p>\n\n<ol>\n<li>map the resources of the subclass to the controller of the superclass in <code>routes.rb</code> (and hope I don't need to call form_for on any subclasses)</li>\n<li>Override rails internal methods to make the classes lie to each other</li>\n<li>Edit every instance in the code where the path to an object's action is invoked implicitly or explicitly, either changing the path or type-casting the object.</li>\n</ol>\n\n<p>With all these conflicting answers, I need a ruling. It seems to me like there is no good answer. Is this a failing in rails' design? If so, is it a bug that may get fixed? Or if not, then I'm hoping someone can set me straight on this, walk me through the pros and cons of each option (or explain why that's not an option), and which one is the right answer, and why. Or is there a right answer that I'm not finding on the web?</p>\n"},{"tags":["ruby","hash"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":1,"view_count":63,"score":2,"question_id":13130887,"title":"Could you please explain ruby hashes?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/8189416/why-use-symbols-as-hash-keys-in-ruby\">Why use symbols as hash keys in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>Just wondering what's the difference?</p>\n\n<pre><code>ruby[:key]\n</code></pre>\n\n<p>vs:</p>\n\n<pre><code>ruby[\"key\"]\n</code></pre>\n"},{"tags":["ruby","mechanize","http-authentication","mechanize-ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":25,"score":2,"question_id":13127678,"title":"Ruby Mechanize issues with http authentication","body":"<p>I'm having issues getting around websites that use http authentication, I have a list of sites which I do some scrapping on but some of these have http authentication on them. I'm not looking to get the content of those sites I want to be able to be able to determine if they are guarded by http auth and then move on. For example in the snippet below agent.get never return so it's impossible for me to handle it. How can I handle a case like this?</p>\n\n<pre><code>require 'mechanize'\nagent = Mechanize.new\npage = agent.get('http://freyalovesmusic.co.uk')\n</code></pre>\n"},{"tags":["ruby"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13131523,"title":"Rotating elements i to j in an array","body":"<p>Given an array:</p>\n\n<pre><code>a = [1, 2, 3, 4, 5, 6]\n</code></pre>\n\n<p>I want to rotate elements <code>i</code> through <code>j</code> in some direction <code>n</code> times. So, for example:</p>\n\n<pre><code>i = 2\nj = 3\nn = 1\n</code></pre>\n\n<p>Rotating <code>a</code> will produce:</p>\n\n<pre><code>new_a = [1, 2, 4, 3, 5, 6]\n</code></pre>\n\n<p>This is what I have:</p>\n\n<pre><code>def rotate_sub(a, i, j, n)\n  return a[0...i] + a[i..j].rotate(n) + a[j+1..-1]\nend\n</code></pre>\n\n<p>Is there a better way to do this? Since there is no bound-checks, <code>i</code> or <code>j</code> could very well be outside the bounds of the array.</p>\n"},{"tags":["ruby","arrays"],"answer_count":6,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":4375,"score":11,"question_id":5878697,"title":"How do I remove blank elements from an array?","body":"<p>I have the following array </p>\n\n<pre><code>cities = [\"Kathmandu\", \"Pokhara\", \"\", \"Dharan\", \"Butwal\"]\n</code></pre>\n\n<p>I want to remove blank elements from the array and want the following result:</p>\n\n<pre><code>cities = [\"Kathmandu\", \"Pokhara\", \"Dharan\", \"Butwal\"]\n</code></pre>\n\n<p>Is there any method like <code>compact</code> that will do it without loops? </p>\n"},{"tags":["ruby","http","header","net-library"],"answer_count":3,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1878,"score":2,"question_id":5416902,"title":"Accessing Headers for Net::HTTP::Post in ruby","body":"<p>I have the following bit of code:</p>\n\n<pre><code>    uri = URI.parse(\"https://rs.xxx-travel.com/wbsapi/RequestListenerServlet\")\n    https = Net::HTTP.new(uri.host,uri.port)\n    https.use_ssl = true\n    req = Net::HTTP::Post.new(uri.path)\n    req.body = searchxml\n    req[\"Accept-Encoding\"] ='gzip'\n    res = https.request(req)\n</code></pre>\n\n<p>This normally works  fine but the server at the other side is complaining about something in my XML and the techies there need the xml message AND the headers that are being sent.</p>\n\n<p>I've got the xml message, but I can't work out how to get at the Headers  that are  being sent with the above.</p>\n"},{"tags":["ruby-on-rails","ruby","heroku","delayed-job"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":256,"score":3,"question_id":10438100,"title":"Long running delayed_job jobs stay locked after a restart on Heroku","body":"<p>When a Heroku worker is restarted (either on command or as the result of a deploy), Heroku sends <code>SIGTERM</code> to the worker process. In the case of <code>delayed_job</code>, the <code>SIGTERM</code> <a href=\"https://github.com/collectiveidea/delayed_job/blob/master/lib/delayed/worker.rb#L125\" rel=\"nofollow\">signal is caught</a> and then the worker stops executing after the current job (if any) has stopped. </p>\n\n<p>If the worker takes to long to finish, then Heroku will send <code>SIGKILL</code>. In the case of <code>delayed_job</code>, this leaves a locked job in the database that won't get picked up by another worker.</p>\n\n<p>I'd like to ensure that jobs eventually finish (unless there's an error). Given that, what's the best way to approach this? </p>\n\n<p>I see two options. But I'd like to get other input:</p>\n\n<ol>\n<li>Modify <code>delayed_job</code> to stop working on the current job (and release the lock) when it receives a <code>SIGTERM</code>.</li>\n<li>Figure out a (programmatic) way to detect orphaned locked jobs and then unlock them.</li>\n</ol>\n\n<p>Any thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby","operators","equals-operator"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":8,"view_count":59,"score":-7,"question_id":13131451,"title":"Is ||= a valid ruby operator? If so what is it supposed to do?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/995593/what-does-or-equals-mean-in-ruby\">What does ||= (or equals) mean in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I am working on a RoR project that someone else in another country built. I have a fairly decent grasp of the rails framework, having built several small apps. I came across this line in the code because I found it weird that they were using @logged_in_user and logged_in_user intermittently through the views.</p>\n\n<p>Knowing that instance variables are how to pass variables from controllers to views I was a little confused why in some parts they called the var without the @ symbol. Then I grepped the project to find that they had defined a method with that name, in the application_controller.</p>\n\n<pre><code>def logged_in_user\n    @logged_in_user ||= (session[:user_id] ? User.find(session[:user_id]) : nil)\nend\n</code></pre>\n\n<p>I get that the part on the right of the equals sign is a ternary operator that checks if there is a user_id for the session if there is it returns the user object, if not it returns nil.</p>\n\n<p>What I don't understand is what the ||= is supposed to mean, or be doing. I have never seen an 'or' operator before an equals sign and I couldn't find any ruby references to it when I searched online. If anyone could give me some insight as to what the purpose of this is, and if it is necessary, I would greatly appreciate it. </p>\n\n<p>Thanks for reading.</p>\n"},{"tags":["ruby","variables","selenium","methods","variable-scope"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12518253,"title":"undefined method 'find_element' for Selenium::WebDriver:Module when using method from another module","body":"<p>Hello I am new to programming working on Selenium using Ruby and I'm having some trouble. I am trying to call a method from a class in another module so I can create a sort of method library and every time I am returned the error <code>NoMethodError: undefined method 'find_element' for Selenium::WebDriver:Module</code> I have require_relative \"LeadForm\" to require the other module  and the code works properly when I put the method directly into the class I'm using it in but I would really like to just have it written once because this is something I will be using a lot. </p>\n\n<p>The code is</p>\n\n<blockquote>\n  <p>def self.progCNA </p>\n  \n  <p>Selenium::WebDriver::Support::Select.new(@driver.find_element(:name,\n  \"area_of_study\")).select_by(:text, \"Health &amp; Medical / Nursing\")\n      Selenium::WebDriver::Support::Select.new(@driver.find_element(:name,\n  \"concentration\")).select_by(:text, \"Nursing Assistant (CNA)\")</p>\n  \n  <p>end</p>\n</blockquote>\n\n<p>and when I call it in the the class that runs the test I put</p>\n\n<blockquote>\n  <p>LeadForm.progCNA</p>\n</blockquote>\n\n<p>and it appears to recognize and run the method but then the method errors out. </p>\n\n<p>Any help would be greatly appreciated as this has been a source of a lot of frustration and I can't for the life of me find a solution online. I have looked up, down and sideways. If you require any more information from me please let me know and I will get it to you as soon as possible! Thank you very much.</p>\n\n<p>I'm using\nWindows 7 Pro sp1\nJetBrains RubyMine 4.5.3\nRuby 1.9.3\nselenium-webdriver 2.25.0</p>\n"},{"tags":["ruby","postgresql","sequel"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":75,"score":3,"question_id":13113096,"title":"How do I ROUND an AVERAGE to 2 decimal places in PostgreSQL?","body":"<p>I am using PostgreSQL via the Ruby gem 'sequel'.</p>\n\n<p>I'm trying to round to two decimal places -- that is, to the nearest hundredth.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>SELECT \n  ROUND(AVG(some_column),2)\n\nFROM \n  table\n</code></pre>\n\n<p>When I run that, I get the following error: <code>PG::Error: ERROR:  function round(double precision, integer) does not exist (Sequel::DatabaseError)</code></p>\n\n<p>However, I get no error when I run the following code:</p>\n\n<pre><code>SELECT \n  ROUND(AVG(some_column))\n\nFROM \n  table\n</code></pre>\n\n<p>Does anyone know what I am doing wrong?</p>\n"},{"tags":["ruby","rvm","capistrano","bundler","webistrano"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13131189,"title":"Deploy error in Webistrano with bunder, capistrano and require 'bundler/capistrano' recipe","body":"<p>Recently I've been trying to upgrade Webistrano from a version that did not use bundler to manage the application gems to one that does.  In order to deploy rails applications, we would use <code>require 'bundler/capistrano'</code> in the recipe to have the bundler loaded for the application and other related steps (like precompiling assets, etc.).  However, once bundler is used with a Gemfile to specify and load the appropriate gem environment, having <code>require 'bundler/capistrano'</code> throws the following error:</p>\n\n<blockquote>\n  <p>** loading stage recipe 'bundler'</p>\n  \n  <p>*** defining a task named `install' would shadow an existing method with that name</p>\n</blockquote>\n\n<p>If I exclude the require from the recipe, the deploy continues but does not use bundler (no <code>bundle exec</code>, etc.)</p>\n\n<p>I also have similar issues with <code>require 'rvm/capistrano'</code> when attempting to use <code>rvm</code> to manage the ruby environment.</p>\n\n<p>Any thoughts on how to fix this?</p>\n"},{"tags":["ruby","excel","openxml","rubyxl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13104034,"title":"How do I create a date-formatted cell using RubyXL?","body":"<p>I'm using RubyXL to dynamically generate a spreadsheet file that contains some dates. The documentation is kind of sparse so I've been looking at the source, and it appears the library only has special handling for <code>Date</code> and <code>DateTime</code> when you call <code>change_contents</code>, so that's what I'm doing:</p>\n\n<pre><code>cell = sheet.add_cell_obj RubyXL::Cell.new(sheet, row_index, col_index)\ncell.change_contents(Time.now.to_datetime)\n</code></pre>\n\n<p>When I create a spreadsheet this way, Excel does not format those cells as dates. I'm guessing that I need to set some other field, perhaps <code>cell.datatype</code>, but I'm not sure. Or maybe I'm barking up the wrong tree. Does anybody know what to do?</p>\n"},{"tags":["ruby","authorize.net"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13112753,"title":"Is there an actively maintained ruby library for authorize-net?","body":"<p>It looks like the <a href=\"https://rubygems.org/gems/authorize-net\" rel=\"nofollow\">authorize-net gem</a> is no longer maintained.  The latest (only) release was in January, 2011.  Also, I cannot find an issue tracker, just a <a href=\"http://community.developer.authorize.net/t5/Integration-and-Testing/bd-p/Integration01\" rel=\"nofollow\">forum</a>.  Rails 4 is just around the corner, and they still haven't fixed a <a href=\"http://bit.ly/TNlqjb\" rel=\"nofollow\">simple Rails 3 bug</a>.  Is there a successor to this gem?</p>\n\n<p>I'd like to hear from rubyists who use Authorize.net despite having an apparently dead gem.</p>\n"}]}
