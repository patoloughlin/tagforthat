{"total":34674,"page":1,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","nested","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13298064,"title":"Updating nested models in rails","body":"<p>I have an app where there's a model Animal which has many Packages. I'm trying to create a form where the :true_weight attribute of a subset of the packages associated with a particular animal can be updated. This form is in a custom url/action (not show/new/edit or whatever). I feel like I've done most of it right, but it's just not updating the packages. I'll put my (abbreviated) code below and then explain what has and hasn't been working. Pretty stumped by this:</p>\n\n<p>package.rb</p>\n\n<pre><code>attr_accessible :true_weight # And irrelevant others\nbelongs_to :animal\n</code></pre>\n\n<p>animal.rb</p>\n\n<pre><code>attr_accessible :finalized, :name # And irrelevant others\nhas_many :packages\naccepts_nested_attributes_for :packages\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>match '/animals/:animal_id/log' =&gt; \"animals#log\"\n</code></pre>\n\n<p>animals/log.html.erb</p>\n\n<pre><code>&lt;%= form_for(@animal) do |f| %&gt; \n\n&lt;div style=\"width: 200px\"&gt;\n        &lt;%= f.label :name %&gt;\n        &lt;%= f.text_field :name %&gt;\n&lt;/div&gt;\n\n    # This produces the subset of packages I want to be able to edit. It's an array\n    # of arrays, so that each render produces a separate table made from one of the \n    # inner arrays.\n&lt;% @animal.packages_for_log.each do |bundle| %&gt; \n    &lt;%= render partial: 'package_bundle', locals: {:bundle =&gt; bundle} %&gt;&lt;br&gt;\n&lt;% end %&gt;\n\n&lt;h4&gt;And then you'd allow addition of extra packages here.&lt;/h4&gt;\n\n&lt;%= f.submit \"Submit Animal Log\", :class =&gt; \"btn image-button right\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>_package_bundle.html.erb</p>\n\n<pre><code>&lt;table class=\"table\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n            &lt;th&gt;Notes&lt;/th&gt;\n            &lt;th&gt;Label&lt;/th&gt;\n            &lt;th&gt;True Weight&gt;&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;% bundle.each do |package| %&gt; &lt;!-- Produces for each \"bundle\" the list of identical packages --&gt;\n            &lt;%= fields_for package do |p| %&gt;\n                &lt;% if package.order.user %&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;&lt;%= package.name %&gt;&lt;/td&gt;\n                        &lt;td&gt;&lt;%= package.line.processed_notes %&gt;&lt;/td&gt;\n                        &lt;td&gt;&lt;%= \"#{package.order.user.name.first(3).upcase}-#{package.id}\" %&gt;&lt;/td&gt;\n                        &lt;% if !package.true_weight %&gt;\n                            &lt;td colspan=1&gt;&lt;%= p.text_field :true_weight %&gt;&lt;/td\n                        &lt;% else %&gt;\n                            &lt;td&gt;&lt;%= package.true_weight.round(0) %&gt;lb&lt;/td&gt;\n\n                        &lt;% end %&gt;  \n                    &lt;/tr&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt;   \n        &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>animals_controller.rb (log is an animal action/view)</p>\n\n<pre><code>def log\n    @animal = Animal.find(params[:animal_id])\n\n    if @animal.update_attributes(params[:animal])\n      puts \"Inside If Block\"\n      @animal.toggle!(:finalized)\n    else\n      # I don't know about this. I wanted to redirect to the updated log page, with a flash\n      # but when I last tried that, it had some recursive error, or would update without my \n      # submitting.\n      render action: \"log\"\n    end\n\n  end\n</code></pre>\n\n<p>So. What is working:</p>\n\n<ol>\n<li>The if block in my animals controller is being accessed. But it looks like it's possibly being accessed BEFORE I hit submit on my log page. (I searched for and found that puts line in the server logs). May just be misreading it.</li>\n<li>The form elements look right. I get a whole bunch of text boxes in the right places, and the information about each package that is being printed to the page in the table next to the text fields is correct.</li>\n<li>If I fill in Animal Name attribute at the top of the form, that attribute (of the animal) IS updated. </li>\n</ol>\n\n<p>What isn't working:</p>\n\n<ol>\n<li>When I submit, it redirects me to the animal show page (!?!?), with the flash that's shown after the regular update action.</li>\n<li>The @animal.toggle!(:finalized) action doesn't seem to do anything. Maybe, given 1 above, that boolean is being toggled twice? Back and forth?</li>\n<li>The big one -- it doesn't update my packages, at all. </li>\n</ol>\n\n<p>Any ideas what's going on here, or what I need to add? I'm really confused about what I'm not doing right.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","radio-button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13281194,"title":"Radio Button Selection Sticking After Search","body":"<p>This question is similar to my last question, but instead of a select box I would like to implement it on two radio buttons. I would like a Male radio button and a Female radio button, represented by M and F, and whenever you select one and hit go, the page refreshes with the previously checked button selected. I am using rails 3 and twitter bootstrap I can post my code if necessary. This is a link to my next question: <a href=\"http://stackoverflow.com/questions/13255011/select-box-selected-item-staying-after-search\">Select Box Selected Item Staying After Search</a></p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","safety","soft-delete"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":814,"score":1,"question_id":6354734,"title":"Is there a better version of somthing like acts_as_paranoid for Rails 3?","body":"<p>Does anyone know of a gem that both soft deletes records from a database (just flags them as deleted as opposed to is actually deleted) and...</p>\n\n<p>...also when do you any type of find automatically omits those trashed records with out using any special user-defined scopes. E.g. it all takes place in the gem.</p>\n\n<p>Cheers!</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13297310,"title":"search form in rails 3 not returning as expected","body":"<p>This is my first attempt at trying to implement a simple search form in my rails app, New to rails so forgive me if I have made some major mistakes</p>\n\n<p>I have a search form that looks like this</p>\n\n<pre><code>  &lt;%= form_tag({:controller =&gt; 'search', :action =&gt; 'search'}, {:method =&gt; 'get'})  do |s| %&gt;\n  &lt;%= text_field_tag :search, params[:search] %&gt;\n   &lt;%= submit_tag \"Search\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>My controller</p>\n\n<pre><code>def search\n\n@countrysearch = Recipe.find(params[:search])\nend\n</code></pre>\n\n<p>For now i am outputting my results like so</p>\n\n<pre><code>  &lt;h4&gt;output&lt;/h4&gt;\n  &lt;%= @countrysearch %&gt;\n</code></pre>\n\n<p>I am getting an output but if i search for a word like Wales, i get an error saying could not find by id, but if i search for an id like 17 then i get</p>\n\n<pre><code>  #&lt;Recipe:0x97b0fa8&gt; \n</code></pre>\n\n<p>I have looked into the find_by_sql method but my understanding of this is not there yet, im unsre of the syntax to search dependent on the string I enter, though I guess that doesn’t matter as the params are the content of the search field?</p>\n\n<p>If any can help then it would be much appreciated</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord","order","distinct-on"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13278856,"title":"Applying a different order to postgres \"DISTINCT ON\" using rails","body":"<p>I have a rails app:</p>\n\n<p><code>user has_many :projects</code></p>\n\n<p><code>user has_many :tasks, :through =&gt; :projects</code></p>\n\n<p><code>project has_many :tasks</code></p>\n\n<p>Each task has a milestone date.</p>\n\n<p>To show a table of project details with next milestone date I am using:</p>\n\n<pre><code>@projects = current_user.tasks.joins(:project).select(\"distinct on (projects.id) projects.*, tasks.*\").reorder(\"projects.id, tasks.milestone ASC\")\n</code></pre>\n\n<p>This works fine.</p>\n\n<p>I now want to be able to sort the table columns.</p>\n\n<p>According to Postgres <code>DISTINCT ON</code> is not sortable, you have to wrap it in another select statement, ie <code>SELECT * FROM (SELECT DISTINCT ON....) ORDER BY column_3</code></p>\n\n<p>I did think that the column being ordered could just be worked into the SQL as required, ie (to order by project name DESC):</p>\n\n<pre><code>@projects = current_user.tasks.joins(:project).select(\"distinct on (projects.name) projects.*, tasks.*\").reorder(\"projects.name DESC, tasks.milestone ASC\")\n</code></pre>\n\n<p>which works but I also want to be able to order by milestone and that doesn't work that way.</p>\n\n<p>Can someone tell me how to convert my rails query so that it can be ordered by any of the columns?</p>\n\n<p>UPDATE</p>\n\n<hr>\n\n<p><strong>I suppose my question is simply how do I wrap an activerecord query in a surrounding <code>SELECT</code> and <code>ORDER BY</code>?</strong></p>\n\n<p>I think I've managed to achieve it using:</p>\n\n<pre><code>inner_query = current_user.tasks.select(\"distinct on (projects.id) projects.*, tasks.*\").reorder(\"projects.id, tasks.milestone ASC\").to_sql\n@projects = Task.paginate_by_sql(\"select * from (#{inner_query}) as user_projects order by user_projects.name\", :page =&gt; params[:page])\n</code></pre>\n\n<p>Is that the best way or can someone think of a better way? - find/paginate_by_sql seems like a workaround and I would have preferred to stay within the realms of activerecord query.</p>\n\n<p>Thanks</p>\n"},{"tags":["jquery","ruby-on-rails-3","soundmanager2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":93,"score":3,"question_id":11462242,"title":"soundmanger 2 not working in rails application","body":"<p>Soundmanager 2(http://www.schillmania.com/projects/soundmanager2/doc/download/ ) is not working in my ruby on rails application.</p>\n\n<p>Only If i add ?assets_debug=1 it works\nI tried all the sm .js files and none of them work restarting every time the app.</p>\n\n<p>the error:</p>\n\n<pre><code>soundManager is not defined\n[Break On This Error]   \n\nsoundManager.setup({\n</code></pre>\n\n<p>and in the JS code from inside firebug:</p>\n\n<pre><code>&lt;script&gt;\n//&lt;![CDATA[\nsoundManager.setup({\nurl: '/assets/',\ndebugMode: false,\nonready: function() {\nvar mySound = soundManager.createSound({\nid: 'aSound',\nurl: '/assets/start.mp3',\nonload: function() { console.log('sound loaded!', this); }\n});\nmySound.play();\n},\nontimeout: function() {\n}\n});\n//]]&gt;\n&lt;/script&gt; \n</code></pre>\n\n<p>Anyone an idea why this happens? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13297524,"title":"Hartl's Tutorial Ch. 7 Exercise 3 No explanation on presence: true","body":"<p>I'm completely baffled with Exercise 3 in Chapter 7 of Hartl's Ruby on Rails tutorial. My question is, why do we have to get rid of <code>presence: true</code> in order to prevent error duplication. Don't we need that password exists? Or is this one of those things where <code>has_secure_password</code> handles this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","zurb-foundation","css-frameworks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13297602,"title":"Zurb Foundation radio buttons and checkboxes not working in Rails","body":"<p>I've installed foundation into my Rails project using their gem and running the following 2 commands:</p>\n\n<pre><code>rails g foundation:install\nrails g foundation:layout\n</code></pre>\n\n<p>Everything seems to be working great, the nice CSS markup and grid layout. However, my radio buttons and checkboxes don't look any different. The <a href=\"http://foundation.zurb.com/docs/forms.php#radEx\" rel=\"nofollow\">page that describes radio buttons and checkboxes</a> says, \"Once initialized (they're referring to <code>jquery.foundation.forms.js</code> which was automatically included in every Rails page) it will look for any checkbox, radio button, or select element and replace it with custom markup that Foundation provides styles for.\"</p>\n\n<p>But my radio buttons and checkboxes look standard, not like the beautiful ones on the above example page. They suggest to set <code>display: none;</code> on the inputs with some custom markup to avoid the flash from normal to foundation buttons/checkboxes. That doesn't help. I even did a copy-and-paste from their example webpage to my webpage! Still no luck! Am I missing something?</p>\n\n<p>I'm using Rails 3.2.8</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13297305,"title":"How to remove page title from refinery home page [RAILS]","body":"<p>I'm currently working on a project which I'm building on top of 'refinery cms', I ran in to a problem that in my home page, apart from the page content I added, it shows the page name as 'home', </p>\n\n<p>And I have found out that it returns this from </p>\n\n<pre><code>#app/views/refinery/_content_page.html.erb\n\n&lt;%= render_content_page(@page, {\n      :hide_sections =&gt; local_assigns[:hide_sections],\n      :can_use_fallback =&gt; !local_assigns[:show_empty_sections] &amp;&amp; !local_assigns[:remove_automatic_sections]\n    }) %&gt;\n</code></pre>\n\n<p>can someone tell me how to get rid on this page name from the home page</p>\n\n<p>I'm running on </p>\n\n<ul>\n<li>gem 'refinerycms', '~> 2.0.0' </li>\n<li>gem 'rails', '3.2.8'</li>\n<li>ruby 1.9.2</li>\n</ul>\n\n<p>Thanks for any help</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","openssl","ssl-certificate"],"answer_count":2,"favorite_count":0,"up_vote_count":15,"down_vote_count":0,"view_count":7362,"score":15,"question_id":4505795,"title":"Rails 3: OpenSSL::SSL::SSLError: hostname was not match with the server certificate","body":"<p>When trying to deliver an email via console I receive this error:</p>\n\n<pre><code>OpenSSL::SSL::SSLError: hostname was not match with the server certificate\n</code></pre>\n\n<p>The thing is I really don't know much about certificates and such, or really how to get started troubleshooting this, I tried to do some investigation with <code>openssl</code> and here is the certificate that is returned.</p>\n\n<p>I don't know if its a problem with Postfix which is running on the server, or my rails app, any help or clues is really appreciated.</p>\n\n<pre><code>~% openssl s_client -connect mail.myhostname.com:25 -starttls smtp\nCONNECTED(00000003)\ndepth=0 /CN=myhostname\nverify error:num=18:self signed certificate\nverify return:1\ndepth=0 /CN=myhostname\nverify return:1\n---\nCertificate chain\n 0 s:/CN=myhostname\n   i:/CN=myhostname\n---\nServer certificate\n-----BEGIN CERTIFICATE-----\n[...redacted...]\n-----END CERTIFICATE-----\nsubject=/CN=myhostname\nissuer=/CN=myhostname\n---\nNo client certificate CA names sent\n---\nSSL handshake has read 1203 bytes and written 360 bytes\n---\nNew, TLSv1/SSLv3, Cipher is DHE-RSA-AES256-SHA\nServer public key is 1024 bit\nCompression: NONE\nExpansion: NONE\nSSL-Session:\n    Protocol  : TLSv1\n    Cipher    : DHE-RSA-AES256-SHA\n    Session-ID: 1AA4B8BFAAA85DA9ED4755194C50311670E57C35B8C51F9C2749936DA11918E4\n    Session-ID-ctx: \n    Master-Key: 9B432F1DE9F3580DCC6208C76F96631DC5A4BC517BDBADD5F514414DCF34AC526C30687B96C5C4742E9583555A118232\n    Key-Arg   : None\n    Start Time: 1292985376\n    Timeout   : 300 (sec)\n    Verify return code: 18 (self signed certificate)\n---\n250 DSN\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mass-assignment"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":815,"score":2,"question_id":5659850,"title":"Is there a way to bypass mass assignment protection?","body":"<p>I have a Rails 3 app which JSON encodes objects in order to store them in a Redis key/value store.</p>\n\n<p>When I retrieve the objects, I'm trying to decode the JSON and instantiate them from the data like so:</p>\n\n<pre><code>def decode(json)\n  self.new(ActiveSupport::JSON.decode(json)[\"#{self.name.downcase}\"])\nend\n</code></pre>\n\n<p>The problem is that doing this involves mass assignment which is disallowed (for good reason I'm told!) for attributes I haven't given attr_writer ability to.</p>\n\n<p>Is there a way I can bypass the mass assignment protection just for this operation only?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13296973,"title":"rails model subclassing -> multi table inheritance or polymorphism","body":"<p>Here is my setup, followed by an explanation of what I am trying to accomplish.</p>\n\n<pre><code>class Layer &lt; ActiveRecord::Base\n  has_and_belongs_to_many :components\nend\n\nclass Component &lt; ActiveRecord::Base\n  has_and_belongs_to_many :layers \nend\n\nclass ImageComponent &lt; Component\n  # I want this table to inherit from the Component table\n  # I should be able to add image-specific fields to this table\nend\n\nclass VideoComponent &lt; Component\n  # I want this table to inherit from the Component table\n  # I should be able to add video-specific fields to this table\nend\n</code></pre>\n\n<p>What I want to be able to do:</p>\n\n<pre><code>layer.components &lt;&lt; ImageComponent.create\nlayer.components &lt;&lt; VideoComponent.create\n</code></pre>\n\n<p>In practice, I realize that <code>ImageComponent</code> and <code>VideoComponent</code> will actually have to inherit from <code>ActiveRecord::Base</code>. Is there any way to nicely implement model subclassing in Rails? </p>\n\n<p>Right now I have my <code>Component</code> model setup to be <code>polymorphic</code> such that <code>ImageComponent</code> and <code>VideoComponent</code> each <code>has_one :component, as: :componentable</code>. This adds a layer of annoyance and ugliness to my code though:</p>\n\n<pre><code>image_component = ImageComponent.create\ncomponent = Component.create\ncomponent.componentable = image_component\nlayer.components &lt;&lt; component\n</code></pre>\n\n<p>I guess a simple way to explain this is that I want to implement a habtm relationship between Layers and Components. I have multiple types of Components (i.e. ImageComponent, VideoComponent) that each have the same base structure but different fields associated with them. Any suggestions on ways this can be accomplished? I feel that I am missing something because my code feels hackish.</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","devise","ruby-on-rails-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13293737,"title":"Allow AJAX Through Devise (Rails)","body":"<p>I've just added and configured the devise gem. It's working great except for blocking my form's autosave AJAX calls.</p>\n\n<p>At the top of my controller, I have:</p>\n\n<pre><code>before_filter :authenticate_user!\n</code></pre>\n\n<p>My AJAX call comes to the same controller:</p>\n\n<pre><code>  def autosave\n    #TODO: update relative entry\n    #TODO: verify user logged in\n    #TODO: verify entry belongs to relative user\n    render content_type: 'text/xml', inline: \"&lt;result status='ok' /&gt;\"\n  end\n</code></pre>\n\n<p>Of course I could instead declare my before filter like so:</p>\n\n<pre><code>before_filter :authenticate_user!, except: :autosave\n</code></pre>\n\n<p>..but this offers nothing to prevent anyone from calling this controller function at any time.</p>\n\n<p>What would be the best way to allow this function to be called? I still want to ensure that only logged in users can make the call and that the given record they're editing belongs to them.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","selenium","capybara","minitest"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":571,"score":2,"question_id":5655154,"title":"How do you perform javascript tests with Minitest, Capybara, Selenium?","body":"<p>There are a lot of examples on how to perform javascript tests with Capybara/Selenium/<strong>Rspec</strong> in which you can write a test like so:</p>\n\n<pre><code>it \"does something\", :js =&gt; true do\n  ...\nend\n</code></pre>\n\n<p>However with <strong>minitest</strong> you can't pass a second parameter to instruct selenium to perform the test.</p>\n\n<p>Does anyone have any ideas on how this can be done?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","migration"],"answer_count":8,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":137,"score":6,"question_id":13168450,"title":"Rails creating migration to add columns to table causes error when running rake db:migrate","body":"<p>I have a model created called \"users\" and i created a new migration to add some columns to the  users table. Now when i run rake db:migrate, I get the error below b/c it's trying to create the users table again</p>\n\n<pre><code>$ rake db:migrate\n==  DeviseCreateUsers: migrating ==============================================\n-- create_table(:users)\nrake aborted!\nAn error has occurred, all later migrations canceled:\n\nMysql::Error: Table 'users' already exists: CREATE TABLE `users`.....\n</code></pre>\n\n<p>Why is it trying to create the table again?</p>\n\n<p>Here's the command i used to create the new migration</p>\n\n<pre><code>$ rails generate migration AddDetailsToUsers home_phone:decimal cell_phone:decimal work_phone:decimal birthday:date home_address:text work_address:text position:string company:string\n</code></pre>\n\n<p>The new migration looks like this:</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>20120511224920_devise_create_users</p>\n\n<pre><code>class DeviseCreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table(:users) do |t|\n      ## Database authenticatable\n      t.string :email,              :null =&gt; false, :default =&gt; \"\"\n      t.string :username,           :null =&gt; false, :default =&gt; \"\"\n      t.string :encrypted_password, :null =&gt; false, :default =&gt; \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, :default =&gt; 0\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Encryptable\n      # t.string :password_salt\n\n      ## Confirmable\n      # t.string   :confirmation_token\n      # t.datetime :confirmed_at\n      # t.datetime :confirmation_sent_at\n      # t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, :default =&gt; 0 # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n      ## Token authenticatable\n      # t.string :authentication_token\n\n\n      t.timestamps\n    end\n\n    add_index :users, :email,                :unique =&gt; true\n    add_index :users, :reset_password_token, :unique =&gt; true\n    # add_index :users, :confirmation_token,   :unique =&gt; true\n    # add_index :users, :unlock_token,         :unique =&gt; true\n    # add_index :users, :authentication_token, :unique =&gt; true\n  end\nend\n</code></pre>\n\n<p>20120619023856_add_name_to_users</p>\n\n<pre><code>class AddNameToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :first_name, :string\n    add_column :users, :last_name, :string\n  end\nend\n</code></pre>\n\n<p>20121031174720_add_details_to_users.rb</p>\n\n<pre><code>class AddDetailsToUsers &lt; ActiveRecord::Migration\n  def change\n    add_column :users, :home_phone, :decimal\n    add_column :users, :cell_phone, :decimal\n    add_column :users, :work_phone, :decimal\n    add_column :users, :birthday, :date\n    add_column :users, :home_address, :text\n    add_column :users, :work_address, :text\n    add_column :users, :position, :string\n    add_column :users, :company, :string\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","caching","fragment-caching"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":17,"score":4,"question_id":13295489,"title":"rails3 caching: expire fragment with extension","body":"<p><strong>How do I expire a fragment in the cache with a file extension (.json) from a another controller?</strong></p>\n\n<p>I am using Rails 3.2.8.</p>\n\n<p>I have two controllers for the same models: /admin/books_controller and /api/books_controller.  The admin controller is used to create/update/delete books and requires elevated access.  The api/books_controller is used to search/list view details about a book by users.  I've attempted to cache the api/books_controller</p>\n\n<pre><code>class Api::BooksController &lt; ApiController\n  caches_action :show\n\n  def show    \n    @book = Book.find(params[:id])\n  end\nend\n</code></pre>\n\n<p>This works great.  The first request is slow and the second is fast</p>\n\n<pre><code>Rendered api/books/show.json.rabl (119.7ms)\nWrite fragment views/localhost:3000/api/books/4.json (1.7ms)\nCompleted 200 OK in 568ms (Views: 124.2ms | ActiveRecord: 9.5ms)\n\nRead fragment views/localhost:3000/api/books/4.json (0.2ms)\nCompleted 200 OK in 16ms (ActiveRecord: 2.6ms)\n</code></pre>\n\n<p>Now, I need to expire the the fragments when the Book is updated or destroyed.  I have this:</p>\n\n<pre><code>class Admin::BooksController &lt; AdminController\n\n  def update\n    @book.attributes = params[:book]\n    if (@book.save)\n      expire_action(:controller =&gt; 'api/books', :action =&gt; 'show', :id =&gt; @book.id, :format =&gt; 'json')\n    end\n  end\n\nend\n</code></pre>\n\n<p>However, <strong>this doesn't resolve to the same fragment</strong> (the request is an HTML request now, to a different controller):</p>\n\n<pre><code>Started PUT \"/admin/books/4\" for 127.0.0.1 at 2012-11-08 12:27:11 -0600\nProcessing by Admin::BooksController#update as HTML\n...\nExpire fragment views/localhost:3000/api/books/4 (0.1ms)\n</code></pre>\n\n<p>My API controller with a JSON request reads and writes this fragment:</p>\n\n<pre><code>views/localhost:3000/api/books/4.json\n</code></pre>\n\n<p>My Admin controller tries to expire this fragment:</p>\n\n<pre><code>views/localhost:3000/api/books/4\n</code></pre>\n\n<p><strong>How do I expire views/localhost:3000/api/books/4.json from the other controller with a different request format?</strong>  </p>\n\n<p>This question: <a href=\"http://stackoverflow.com/questions/7076721/rails-3-caching-expire-action-for-named-route\">rails 3 caching: expire action for named route</a> indicates I could use a regex to expire multiple fragments, but that requires the keys in the cache to be enumerable (http://api.rubyonrails.org/classes/ActionController/Caching/Fragments.html#method-i-expire_fragment)</p>\n"},{"tags":["jquery","ruby-on-rails-3"],"answer_count":2,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":3222,"score":6,"question_id":5766055,"title":"Jquery modal windows and edit object","body":"<p>I am trying to create some modal windows to appear whenever the user wants to edit the object. I haven't done this before, and I've looked for tutorials, but instead of getting some straight forward answers, all I got is more confused! There seem to be sooo many libraries one can use.</p>\n\n<p>So I guess this question is in two parts. If I wanted to do this, are there any particular reasons why I would want to choose Jquery over prototype? Are there more options?</p>\n\n<p>Second part is actually doing it, at this point i don't really care using which library. </p>\n\n<p>I have the following, standard crud, edit and update actions. Now, what I would like is when the user clicks edit, instead of going to the page, pop up a window where he can edit the name of the ticket (this is the only attribute for now). </p>\n\n<p>in the controller I have this:</p>\n\n\n\n<pre><code>def edit\n  @ticket = Ticket.find(params[:id])\nend\n\ndef update\n  @ticket = Ticket.find(params[:id])\n  if @ticket.update_attributes(params[:ticket])\n    redirect_to tickets_url, :notice  =&gt; \"Successfully updated ticket.\"\n  else\n    render :action =&gt; 'edit'\n  end\nend\n</code></pre>\n\n<p>Can anyone please help me with this? Also of course advice and links are more than welcome!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","search","ransack"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13284172,"title":"Setting default search parameter on Ransack for rails","body":"<p>I've been wracking my brain over this but can't get it. I feel like the answer is probably obvious</p>\n\n<p>What I'm trying to do is the following:</p>\n\n<p>I have an index controller which lists a series of Jobs which I can search using Ransack. Each job has a completion date which either has a date in it or is null (unfinished). Currently the search itself works great. I would like to make it so that the index page loads up showing only the unfinished work, but I also want it to work so that when someone does run a search, returns results for both finished and unfinished work.</p>\n\n<p>Any help would be greatly appreciated. In the code below :actual is the name of the field with the completion date. I also was looking around the web and thought that maybe something like the DEFAULT_SEARCH_PARAMETER={} that I have in the Job model might work but I couldn't seem to get it to.</p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n  DEFAULT_SEARCH_PARAMETER ={}\n  attr_accessible :items_attributes, :actual\nend\n\ndef index\n   @search = Job.search(params[:q] || Job::DEFAULT_SEARCH_PARAMETER)\n   @search.build_condition\n   @results = @search.result\n   @job = @results.paginate(:per_page =&gt; 10, :page =&gt; params[:page])\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","linecache"],"answer_count":3,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":4298,"score":6,"question_id":5754493,"title":"Ruby on Rails - linecache error while trying to ' bundle install '","body":"<p>Hi im trying to run <strong>bundle install</strong> on my windows machine it runs fine until it reaches the linecache and then spits out a huge error:</p>\n\n<pre><code>Fetching source index for http://rubygems.org/\nUsing rake (0.8.7)\nUsing abstract (1.0.0)\nUsing activesupport (3.0.3)\nUsing builder (2.1.2)\nUsing i18n (0.5.0)\nUsing activemodel (3.0.3)\nUsing erubis (2.6.6)\nUsing rack (1.2.2)\nUsing rack-mount (0.6.14)\nUsing rack-test (0.5.7)\nUsing tzinfo (0.3.26)\nUsing actionpack (3.0.3)\nUsing mime-types (1.16)\nUsing polyglot (0.3.1)\nUsing treetop (1.4.9)\nUsing mail (2.2.17)\nUsing actionmailer (3.0.3)\nUsing arel (2.0.9)\nUsing activerecord (3.0.3)\nUsing activeresource (3.0.3)\nUsing bundler (1.0.12)\nUsing thor (0.14.6)\nUsing railties (3.0.3)\nUsing rails (3.0.3)\nUsing render_component_vho (3.0.3)\nUsing verification (1.0.1)\nUsing active_scaffold_vho (3.0.19)\nUsing columnize (0.3.2)\nInstalling linecache (0.43) with native extensions C:/Ruby192/lib/ruby/site_ruby\n/1.9.1/rubygems/installer.rb:533:in `rescue in block in build_extensions': ERROR\n: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)\n\n        C:/Ruby192/bin/ruby.exe extconf.rb\nCan't handle 1.9.x yet\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/Ruby192/bin/ruby\n\n\nGem files will remain installed in C:/Ruby192/lib/ruby/gems/1.9.1/gems/linecache\n-0.43 for inspection.\nResults logged to C:/Ruby192/lib/ruby/gems/1.9.1/gems/linecache-0.43/ext/gem_mak\ne.out\n        from C:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:511:in `b\nlock in build_extensions'\n        from C:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:486:in `e\nach'\n        from C:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:486:in `b\nuild_extensions'\n        from C:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:159:in `i\nnstall'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/sour\nce.rb:96:in `install'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/inst\naller.rb:55:in `block in run'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/spec\n_set.rb:12:in `block in each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/spec\n_set.rb:12:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/spec\n_set.rb:12:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/inst\naller.rb:44:in `run'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/inst\naller.rb:8:in `install'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/cli.\nrb:225:in `install'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/vend\nor/thor/task.rb:22:in `run'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/vend\nor/thor/invocation.rb:118:in `invoke_task'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/vend\nor/thor.rb:246:in `dispatch'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/lib/bundler/vend\nor/thor/base.rb:389:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.12/bin/bundle:13:in\n `&lt;top (required)&gt;'\n        from C:/Ruby192/bin/bundle:19:in `load'\n        from C:/Ruby192/bin/bundle:19:in `&lt;main&gt;'\n</code></pre>\n\n<p>ive tried googling for the problem and found two posts that explain the problem that i have first is a <a href=\"http://stackoverflow.com/questions/4026096/receiving-error-on-windows-machine-when-installing-linecache-error-failed-to-bui\">Stackoveflow Post</a> which is pritty close to what ive got, but upon further inspection i found that the solution given in that post was not what i needed\nanother is <a href=\"http://www.ruby-forum.com/topic/115061\">this post</a> that seems to discuss the exact problem that i have but dosent give a solution any one have any idea what i should do??</p>\n\n<p><strong>Ruby Version =></strong> 1.9.2</p>\n\n<p><strong>Rails Version =></strong> oh come on it doesnt even tell rails version it just prints out another error </p>\n\n<pre><code>Could not find linecache-0.43 in any of the sources\nTry running `bundle install`.\n</code></pre>\n\n<p>any ideas what im doing wrong?? any help would be immensely appreciated</p>\n"},{"tags":["ruby-on-rails-3","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13295133,"title":"Carrierwave: Extract image from uploaded file and discard original file","body":"<p>We're using CarrierWave for file uploads in the project I'm working on. A new requirement came in that addresses a need to upload DICOM files. <a href=\"http://en.wikipedia.org/wiki/DICOM\" rel=\"nofollow\">DICOM</a> files contain an image (or images) in addition to lots of other data. Using the <a href=\"http://dicom.rubyforge.org/\" rel=\"nofollow\">Ruby DICOM</a> gem, I'm able to extract the images from a file with ease. My problem comes when I try to upload them using CarrierWave.</p>\n\n<p>I want to be able to extract a JPEG from the uploaded file, and store that file instead of the original DICOM file. I tried creating a <code>version</code> of the uploaded file like this:</p>\n\n<pre><code>version :jpeg, :if =&gt; :is_dicom? do\n  process :create_jpeg\nend\n\ndef is_dicom?(file)\n  IO.binread(file.to_file, 4, OFFSET) == 'DICM'\nend\n\ndef create_jpeg\n  Rails.logger.debug \"self is class #{self.class}\"\n  dcm = DICOM::DObject.read(file.path)\n  image = dcm.image.normalize\nend\n</code></pre>\n\n<p>I based my <code>create_jpeg</code> method off another <code>create_thumbnail</code> method I found which, without its exception handling, would be reduced to:</p>\n\n<pre><code>def create_thumbnail(width, height, gravity = 'Center')\n  self.resize_to_fill(width, height, gravity)\nend\n</code></pre>\n\n<p>I can see in the debug console that the DICOM is being read successfully, but it doesn't actually save the JPEG that would be extracted. Instead, I get my original DICOM and a copy with 'jpeg' added to the front of the filename. How can I tell CarrierWave that I want to store this JPEG I extracted, and not store the original file that I processed?</p>\n"},{"tags":["ruby","ruby-on-rails-3","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13294846,"title":"Rails3: one controller many partials for form data submission","body":"<p>I am not sure if this is the best approach but I have a controller that originally I intended to control a show index that renders many partials on it (a header partial and then, has some if else magic to render different partials based on the step the user is in in filling out a form... a form has many sections across several pages).  I think ultimately ajax is the way to go but I am not even to that point yet.  I am not sure this is the right way to do it, so I guess that is what I am asking... is the many different partials to one controller the way ?  or does each \"page\" of form data have to be broken out into its own controller?  allowing the user to fill out form (check boxes, comment section) and click \"next\" passing the model of the data they are filling out along the way and saving that model in each next?</p>\n"},{"tags":["ruby","ruby-on-rails-3","v8","therubyracer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13295473,"title":"Stack trace from javascript error from therubyracer / v8 in rails 3","body":"<p>I am running some javascript inside a rails 3 app using therubyracer and v8</p>\n\n<p>If anything goes wrong, the error message gets sent to me via email through the usual rails 3 exception notification process.</p>\n\n<p>However, the error message I get back is pretty vague and the stack trace doesn't go into the javascript file itself. This is understandable, but makes it pretty hard to debug. Here's an example:</p>\n\n<pre><code>V8::JSError: Cannot read property '0' of undefined\nbacktrace:\n\nlib/libraryname.rb:32:in `function_that_calls_v8'\nlib/libraryname.rb:18:in `fetch_and_update'\napp/models/listing.rb:34:in `fetch'\n</code></pre>\n\n<p>Is there a way I can expose the javascript stacktrace so that when an exception is thrown so that I can tell what line inside the javascript is borking? (at the very least, get the line number)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","nested-forms","saving"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":13256662,"title":"ROR3: Why is this not saving?","body":"<p>This functionality used to work but has suddenly stopped and I have no idea why. I've made changes before I ran the tests but, having retraced my steps I don't know what has changed. Can a fresh pair of eyes tell me why this is saving the posts but not the locations?</p>\n\n<p><em>Model Post.rb</em></p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :title, :body, :tag_list, :locations_attributes\n has_and_belongs_to_many :locations\n accepts_nested_attributes_for :locations, :reject_if =&gt; :all_blank\nend\n</code></pre>\n\n<p>*Controller Posts_controller.rb *</p>\n\n<pre><code>class PostsController &lt; ::Blogit::ApplicationController\n\n...     \n\ndef new\n  @post = current_blogger.blog_posts.new(params[:post])\n  @location = @post.locations.build\nend\n\ndef update\n  @post = current_blogger.blog_posts.find(params[:id])\n  if @post.update_attributes(params[:post])\n    redirect_to @post, notice: 'Blog post was successfully updated.'\n  else\n    render action: \"edit\"\n  end\nend\n\ndef create\n  @post = current_blogger.blog_posts.new(params[:post])\n  if @post.save\n    redirect_to @post, notice: 'Blog post was successfully created.'\n  else\n    render action: \"new\"\n  end\nend\n\nend\n</code></pre>\n\n<p>*View _form.html.erb*</p>\n\n<pre><code>&lt;%= nested_form_for(@post, :html=&gt; {:multipart =&gt; true, :class=&gt; \"new_blog_post\", :id=&gt; \"new_blog_post\"}) do |f| %&gt;\n\n ...\n\n&lt;%= field do %&gt;\n  &lt;%= f.text_field :title, placeholder: \"Give your post a title\", :class=&gt;\"span12\" %&gt;\n&lt;% end %&gt;\n&lt;%= field do %&gt;\n  &lt;%= f.text_area :body, placeholder: \"Write something here...\", :id=&gt;\"blog-text\", :class=&gt;\"span12\" %&gt;\n &lt;% end %&gt;\n\n&lt;%= field id: \"new_blog_post_tag_field\" do %&gt;\n  &lt;%= f.label :tag_list, \"Tags\" %&gt;\n  &lt;%= f.text_field :tag_list, placeholder: \"tag one, tag two, etc...\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= f.label :search_locations, \"Add locations to your post\" %&gt;\n   &lt;%= render :partial =&gt; 'search_locations', :locals =&gt; { :f =&gt; f }  %&gt;\n\n &lt;p&gt;&lt;%= f.link_to_add \"Add a location\", :locations %&gt;&lt;/p&gt;\n\n&lt;%= actions do %&gt;\n&lt;%= f.submit \"Submit\", :class=&gt;\"btn\", :disable_with =&gt; 'Uploading Image...' %&gt; or \n&lt;%= link_to(\"cancel\", @post.new_record? ? root_path : post_path(@post)) %&gt;\n\n&lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>*Form Partial _search_locations.html.erb*</p>\n\n<pre><code> &lt;%= f.fields_for :locations do |m| %&gt;\n\n\n &lt;%= m.text_field :name,:class=&gt;\"localename\", :id=&gt;\"appendedInput\", :placeholder=&gt; \"Name of the location\", :autocomplete =&gt; \"off\" %&gt;\n\n\n &lt;span class=\"add-on\"&gt;&lt;%= m.link_to_remove do %&gt;&lt;i class='icon-trash'&gt;&lt;/i&gt;&lt;/span&gt;&lt;%end%&gt;\n\n\n &lt;% end %&gt;\n</code></pre>\n\n<p>And the actual submission in the logs comes up as this:</p>\n\n<pre><code>Started PUT \"/blog/posts/51-hong-kong\" for 127.0.0.1 at 2012-11-06 17:41:00 +0000\nProcessing by Blogit::PostsController#update as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \n\"authenticity_token\"=&gt;\"s+2117Qi/HzO/D/ORINhqHChMJR3S5XK7y/s3rq3dnc=\", \"post\"=&gt;{\"title\"=&gt;\"Hong \nKong \", \"body\"=&gt;\"Lorem ipsum dolor sit amet, consectetur adipiscing elit. In orci elit,  \nrhoncus quis interdum vel, interdum non nulla. Phasellus nec massa lorem. Duis malesuada   \npellentesque orci, accumsan mollis augue aliquam mollis. Pellentesque luctus orci in enim \nhendrerit adipiscing. Mauris tempor tortor in leo posuere tristique.\", \"tag_list\"=&gt;\"\", \n\"locations_attributes\"=&gt;{\"0\"=&gt;{\"_destroy\"=&gt;\"false\",    \n\"name\"=&gt;\"London\",\"longitude\"=&gt;\"-0.1276831\", \"latitude\"=&gt;\"51.5073346\"}}},\n\"_wysihtml5_mode\"=&gt;\"1\", \"name\"=&gt;\"London\", \"legname\"=&gt;\"London\", \"longitude\"=&gt;\"-0.1276831\",\n\"latitude\"=&gt;\"51.5073346\", \"commit\"=&gt;\"Submit\", \"id\"=&gt;\"51-hong-kong\"}\n</code></pre>\n\n<p>Why is this saving the post but not the locations info? </p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","asset","precompile"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13295377,"title":"Rails 3.2 assets:precompile Permission denied 123","body":"<p>I'm trying to precompile my rails app but get this weird error that I don't know how to follow?</p>\n\n<p>rake assets:precompile --trace</p>\n\n<pre><code>** Invoke assets:precompile:all (first_time)\n** Execute assets:precompile:all\n** Invoke assets:precompile:primary (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke environment (first_time)\n** Execute environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:primary\nrake aborted!\nPermission denied - /123\n/Users/philip/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","before-save"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13295270,"title":"Accessing Variables in Rails 3 before_save Method","body":"<p>I have the following <code>before_save</code> method:</p>\n\n<pre><code>def get_data\n  url = \"http://www.api-fetching-url.com/where_my_data_input_is=#{self.my_data}&amp;output=json\"\n  new_data = HTTParty.get(url)\n  @field_to_update = new_data['one']['two']['here']\n  self.field_to_update = @field_to_update\nend\n</code></pre>\n\n<p>Unfortunately, the <code>self.my_data</code> doesn't appear to be working, because the JSON url doesn't produce any result. But, when I substitute <code>my_data</code> in the hardcoded way, it works just fine. Moreover, I can do a <code>find</code> in the Rails console and get the <code>my_data</code> field just fine. So, it's not an issue with that field not saving or something on the form side.</p>\n\n<p>Is there an issue inserting data this way in a <code>before_save</code> method? If not, is there a different way of doing this that I'm missing?</p>\n"},{"tags":["ruby-on-rails-3","timezone","params"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13276001,"title":"Rails time zone from URL params","body":"<p>I'm trying to allow non-signed-in users to change a time of day display, and it seems like the best way would be through params in the url.  I have:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  around_filter :use_time_zone\n\n  private\n    def use_time_zone(&amp;block)\n      Time.use_zone((params[:time] || Time.zone), &amp;block)\n    end\nend\n</code></pre>\n\n<p>And this works great for something like 'www.mysite.com?time=Hawaii'</p>\n\n<p>However, it cannot handle some of the more intricate ones (e.g. 'Eastern Time (US &amp; Canada)'), plus this looks bad in the address bar.</p>\n\n<p>Is there a way to simply use UTC offset with DST (or any other abbreviated form like 'PDT') with params?</p>\n"},{"tags":["ruby-on-rails-3","devise","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13287435,"title":"Display error messages in rails simple_form","body":"<p>I am new to rails and was wondering if someone could show me some light...</p>\n\n<p>I have a simple form with couple of input fields and need to display field validation messages below the field name. Is there is a straightforward way to say display errors below??? or do i have to check for each field error message and create a span tag?</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13280514,"title":"Devise redirect after signin with username in url","body":"<p>I'm struggling with getting devise to redirect to a user's profile page after signin. My routes file looks like this:</p>\n\n<pre><code>get \"profiles/index\"\n\nget \"users/index\"\n\nget \"users/show\"\n\nauthenticated :user do\n root :to =&gt; 'home#index'\nend\nroot :to =&gt; \"home#index\"\ndevise_for :users\nresources :users\nscope \":username\", :as =&gt; \"user\" do\n match '/', :to =&gt; 'profiles#index'\nend\n</code></pre>\n\n<p>I would like it to redirect to /myusername which the user's profile page.  Thanks for your guys' help.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","file-upload","yaml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13286583,"title":"Why yaml file upload does not work? I think permission problems","body":"<p>I would like to load in the config directory, a yaml file chosen by the user.\nI have a view:</p>\n\n<pre><code>&lt;h1&gt;File Upload&lt;/h1&gt;\n&lt;p&gt;Upload your Yaml Configuration File&lt;/p&gt;\n\n&lt;p style=\"color: green\"&gt;&lt;%= flash[:notice] %&gt;&lt;/p&gt;\n\n&lt;%= form_for :uploadFile, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n  &lt;label for=\"upload_file\"&gt;Select File:&lt;/label&gt;\n  &lt;%= f.file_field :upload %&gt;\n  &lt;%= f.submit \"Upload\", :disable_with =&gt; 'Uploading...' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>and I have a controller:</p>\n\n<pre><code>class UploadController &lt; ApplicationController\ndef uploadFile\n    uploaded_io = params[:uploadFile][:upload]\n    File.open(Rails.root.join('config', uploaded_io.original_filename), 'w') do |file|\n        file.write(uploaded_io.read)\n    end\n\n    flash.now[:notice]=\"File has been uploaded successfully\"\n\nend\nend\n</code></pre>\n\n<p>When the user selects the file and press \"upload\" nothing happens and the file is not in the config folder. What can I do? Maybe I should use \"import yaml\" and load it in a certain way, how?</p>\n\n<p>The log said this: </p>\n\n<pre><code>Started POST \"/upload/uploadfile\" for 127.0.0.1 at 2012-11-08 10:51:46 +0100\nProcessing by UploadController#uploadfile as HTML\n  Parameters: {\"utf8\"=&gt;\"âœ“\",  \"authenticity_token\"=&gt;\"5FKgZJG4gKPCHXe8OqhFVZL0bu2X9zLR3sxd4ELBulA=\", \"uploadFile\"=&gt;{\"upload\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x3b03ad8 @original_filename=\"newCases.yml\", @content_type=\"application/octet-stream\", @headers=\"Content-Disposition: form-data; name=\\\"uploadFile[upload]\\\"; filename=\\\"newCases.yml\\\"\\r\\nContent-Type: application/octet-stream\\r\\n\", @tempfile=#&lt;File:C:/Users/Simo/AppData/Local/Temp/RackMultipart20121108-2664-tb7lxr&gt;&gt;}, \"commit\"=&gt;\"Upload\"}\n  [1m[35mSetting Load (0.0ms)[0m  SELECT \"settings\".* FROM \"settings\" WHERE \"settings\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n  Rendered upload/uploadfile.html.erb within layouts/upload (0.0ms)\nCompleted 200 OK in 0ms (Views: 0.0ms | ActiveRecord: 0.0ms)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-plugins","rails-engines"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":393,"score":0,"question_id":10615067,"title":"Render engine within application layout","body":"<h2>Background</h2>\n\n<p>I am creating a application that is made up of a core and several modules. The modules are rails engines, and provide the actual functionality as the core itself only acts as a host.\nThe engines are hosted from <code>/lib</code> and mounted at their respective paths.</p>\n\n<pre><code>|coreApp\n \\\n  |lib\n  \\\n   |module1\n   |module2\n   |etc\n</code></pre>\n\n<p>The modules are then mounted like this</p>\n\n<pre><code>mount Module1::Engine =&gt; \"/module1\", :as =&gt; \"module1\"\nmount Module2::Engine =&gt; \"/module2\", :as =&gt; \"module2\"\n</code></pre>\n\n<p>The core is also responsible for handeling the session, although the login itself is done by a module.</p>\n\n<h2>Problem</h2>\n\n<p>I have yet to find a great way of sharing the core application layout with the engines. As of now, this is how I make the layout available to the engines:</p>\n\n<pre><code>|coreApp\n \\\n  |app\n  \\\n   |views\n    \\\n     |layouts\n      \\\n       |application.html.erb\n       |core.html.erb\n</code></pre>\n\n<p>The file <code>core.html.erb</code> only contains</p>\n\n<pre><code>&lt;%= render :template =&gt; 'layouts/application' %&gt;\n</code></pre>\n\n<p>Is is then included in each module like this</p>\n\n<pre><code>module Module1\n  class ApplicationController &lt; ActionController::Base\n    layout \"core\"\n  end\nend\n</code></pre>\n\n<p>Although it isn't particularly elegant, it works fine, and the content of the module is rendered where the <code>yield</code> statement in the application layout.</p>\n\n<p>The problems are as follows:</p>\n\n<h3>1. Module specific stylesheets are not included in the header</h3>\n\n<p>I need a way to include the stylesheets of the active module.</p>\n\n<h3>2. The header needs access to information about the logged in user</h3>\n\n<p>The header contains information about the logged in user, like</p>\n\n<pre><code>Logged in as &lt;%= @user[:realname] %&gt;\n</code></pre>\n\n<p>This comes from the cores <code>home_controller</code></p>\n\n<pre><code>def index\n  @user = User.find_by_id(session[:user])\nend\n</code></pre>\n\n<p>But when I try to access the module, I get the following error</p>\n\n<pre><code>NoMethodError in Module1/home#index\n\nYou have a nil object when you didn't expect it!\nYou might have expected an instance of Array.\nThe error occurred while evaluating nil.[]\n</code></pre>\n\n<p>Obviously referring to <code>@user</code>.</p>\n\n<h2>Question</h2>\n\n<p>How can this be solved in as elegantly and DRY as possible without too much tampering on the engine side?</p>\n\n<p>I have Googled this <em>a lot</em> but can't really get my head around how to solve it. It might be total lack of insight in how rails works, so there is a good chance this question doesn't even make sense for someone that knows rails well.</p>\n\n<p>Please comment if anything is unclear or ambiguous, and I'll try to elaborate.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13293917,"title":"how to set value for checkbox in ruby on rails?","body":"<p>I am a newbie, I want to know how to set the value for the check_box from '1' to 'Yes' and '0' to 'NO' in front end of ruby on rails?</p>\n\n<pre><code>  &lt;%= f.check_box :RDSAP_Answer, id: \"enr_rds_surv_rdsap_xref_answer_check\" %&gt;\n</code></pre>\n\n<p>Now, in the browser, If I check the box it's store the value '1' to the database and if unchecked it's store the null value in the database. </p>\n\n<p>I want to store <code>Yes for checked</code> and <code>No for unchecked</code> in the database. Is it possible to do in RoR? or is it easiest in JavaScript? What is the easiest way to set the value. Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13243229,"title":"Why is fields_for creating 2 identical records instead of just 1 upon form submit?","body":"<p>When I submit this form, it is creating 2 identical records in the Members table (the fields_for part of the form).  Please help me understand why that is happening.   </p>\n\n<p>The basic setup is: a Comp has many Teams and a Team has many Members.  When creating a new Team, the first Member created should be the team's secretary (which means the secretary_flag field in the Members table should be set to TRUE.)  This form below is supposed to create a new Team, create the first team member, and mark that team member as the secretary.       </p>\n\n<p>The controller: </p>\n\n<pre><code>def new\n  @comp = Comp.find(params[:comp_id])    \n  @team = @comp.teams.new\n  @team.members.build  \nend\n\ndef create\n  @comp = Comp.find(params[:comp_id])\n  @team = @comp.teams.create(params[:team])\n  if @team.update_attributes(params[:team])\n      flash[:success] = \"Team added successfully.\"\n      redirect_to new_comp_team_member_path(@comp,@team)\n  else\n      render 'new' \n  end\nend\n</code></pre>\n\n<p>The form view:</p>\n\n<pre><code>&lt;%= form_for [@comp,@team] do |builder| %&gt;\n    &lt;%= builder.label :team_name, \"Team name\" %&gt;\n    &lt;%= builder.text_field :team_name %&gt;        \n    &lt;%= builder.fields_for :members do |f| %&gt;\n        &lt;%= f.label :member_email, \"Email address of team secretary\" %&gt;\n        &lt;%= f.text_field :member_email %&gt; \n        &lt;%= f.hidden_field :secretary_flag, :value =&gt; 1 %&gt;\n    &lt;% end %&gt;\n\n&lt;%= builder.submit \"Create new team\" %&gt; \n\n&lt;% end %&gt; \n</code></pre>\n\n<p>And in my routes: </p>\n\n<pre><code>resources :comps do\n    resources :teams do \n        resources :members\n    end \nend\n</code></pre>\n\n<p>And in my models: </p>\n\n<p>comp.rb: </p>\n\n<pre><code>attr_accessible :teams_attributes\nhas_many :teams, :dependent =&gt; :destroy\naccepts_nested_attributes_for :teams, :allow_destroy =&gt; :true\n</code></pre>\n\n<p>team.rb:</p>\n\n<pre><code>attr_accessible :members_attributes\nbelongs_to :comp\nhas_many :members\naccepts_nested_attributes_for :members\n</code></pre>\n\n<p>member.rb:</p>\n\n<pre><code> belongs_to :team\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-routing"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13293241,"title":"Rails controller and routes configuration for website","body":"<p>I have an application in RAILS, it is composed of a set of API, a basic website, and an admin dashboard. \nFor the API routing I have no problems, as they belong to a model and a controller and are compliant with the RAILS RESTful pattern (a controller for each model, and a method for each HTTP method). </p>\n\n<p>What I'm not comfortable with is writing routes and controllers for website. \nThe main website is at / so the default route is <code>root :to =&gt; \"home#index\"</code>and I have\nRoutes for the website pages which look like </p>\n\n<pre><code> get \"home/index\"\n  get \"map/index\"\n  get \"api/index\"\n  get \"cgu/index\"\n  get \"legal/index\"\n</code></pre>\n\n<p>Which I think it is not good, as I have a controller per view and I need to define a get for each views. \nNow for the dashboard I tried a different approach. \nIt is at /dashboard, the default route is   <code>match \"dashboard\" =&gt; \"dashboard#index\"</code> and here is few pages as an examples</p>\n\n<pre><code> get \"dashboard/index\"\n  get \"dashboard/users\"\n  get \"dashboard/users_stats\"\n  get \"dashboard/routes\"\n  get \"dashboard/routes_stats\"\n  get \"dashboard/charts\"\n  get \"dashboard/financial\"\n</code></pre>\n\n<p>So for the dashboard I have a massive dashboard_controller, which contains a <code>def method</code> for each dashboard pages. IE: </p>\n\n<pre><code>#dashboard/users\n  def users\n     @users = User.all\n\n     respond_to do |format|\n      format.html {render :layout =&gt; 'dashboard'}\n    end\n  end\n</code></pre>\n\n<p>the controller of the dashboard is at /controller but for views and assets I have put it in /folder/dashboard/ </p>\n\n<p>Here is 2 questions: </p>\n\n<ul>\n<li>What is the best way to build the home website and dashboard ? Should I have a controller per page or a global controller where I have a method per pages ? (Which I find very convenient, less code). </li>\n<li>How should I organize my routes to avoid to set a get \"something/something\" for each page ? \nOr it is normal with RAILS that I have a route defined for each of my page ? I'm fairly new. </li>\n</ul>\n\n<p>EDIT: \nTo clarify, the dashboard is built around an existing application with API that follow RESTFul Rails pattern:</p>\n\n<pre><code>  resources :users\n  resources :routes\n</code></pre>\n\n<p>But the dashboard is not tied to any existing resources, it only do stats about those resources. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13289522,"title":"How to customize devise such that validation is done only at specified condition?","body":"<p>I have devise for authentication and i have not used validatable and i send the request and along to it i send a type. for example</p>\n\n<pre><code>http://localhost:3000/signup/new?type=twitter \n</code></pre>\n\n<p>in the above shown i have used <code>type=twitter</code>and in case it is twitter i do not want to validate email i.e., do not need <code>validates_presence_of :email</code> but in case i send type=email then i want to check presence of mail and whether mail has not already taken and check mail specified is valid or not? How can i do this? Please help me.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table","twitter-bootstrap","selectbox"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13255011,"title":"Select Box Selected Item Staying After Search","body":"<p>I currently have a table sorted by several select boxes. The select boxes work correctly and sort/filter the table, but whenever the user submits the search, the page refreshes and the select box resets. I would like the selected item to stick after a search, so for example if you select Male then hit go, after the page refreshes, Male is still selected. I currently have infinite scrolling successfully implemented, and I am using rails 3 and twitter-bootstrap for my framework if that helps any. </p>\n\n<p>Here is my code:</p>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code> &lt;form class=\"form-inline\"\n        &lt;p&gt;\n         &lt;label class=\"radio\"&gt;\n          &lt;input type=\"radio\" name=\"gender_search\" value=\"M\"&gt;M\n         &lt;/label&gt;\n        &lt;label class=\"radio\"&gt;\n          &lt;input type=\"radio\" name=\"gender_search\" value=\"F\"&gt;F\n        &lt;/label&gt;\n\n        &lt;select name=\"state_search\" class=\"span2\"&gt;\n          &lt;option value=\"\"&gt;Select a State&lt;/option&gt;\n          &lt;option&gt;----------------&lt;/option&gt;\n          &lt;option&gt;LA&lt;/option&gt;\n          &lt;option&gt;MS&lt;/option&gt;\n          &lt;option&gt;TX&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;select name=\"city_search\" class=\"span2\"&gt;\n          &lt;option value=\"\"&gt;Select a City&lt;/option&gt;\n          &lt;option&gt;----------------&lt;/option&gt;\n          &lt;option&gt;Mandeville&lt;/option&gt;\n          &lt;option&gt;Covington&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;button type=\"submit\" class=\"btn\"&gt;GO&lt;/button&gt;\n        &lt;/p&gt;\n      &lt;/form&gt;\n      &lt;table class=\"table table-striped table-bordered span8 table-condensed\"     \n       id=\"articles_table\" &gt;\n        &lt;thead class=\"header\"&gt;\n          &lt;tr&gt;\n            &lt;th&gt;ID&lt;/th&gt;\n            &lt;th&gt;Title&lt;/th&gt;\n            &lt;th&gt;Description&lt;/th&gt;\n            &lt;th&gt;Created_At&lt;/th&gt;\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n        &lt;tbody&gt;\n          &lt;%= render @articles %&gt;\n        &lt;/tbody&gt;\n</code></pre>\n\n<p><strong>_article.html.erb</strong></p>\n\n<pre><code>&lt;tr&gt;\n      &lt;td&gt; &lt;%= article_counter +1 %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Title %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Description %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Created_At %&gt; &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p><strong>articles_controller.rb</strong></p>\n\n<pre><code>def index\n@articles = Article.state_search(params[:state_search]).gender_search(params[:gender_search]).city_search(params[:city_search]).page(params[:page]).limit(50).order('NTRP DESC', 'Last_Name ASC')\n  respond_to do |format|\n    format.html # index.html.erb\n    format.json { render json: @articles }\n    format.js\n  end\nend\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails-3","hebrew","right-to-left"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":1285,"score":3,"question_id":4866977,"title":"How to allow right to left languages in Ruby on Rails 3","body":"<p>I am interested in creating a website in Hebrew using Ruby on Rails 3. The problem is when I put Hebrew into my view I am told that it is not supported and I should add UTF-8.  </p>\n\n<p>I've been working on this for a while and I Can't seem to find how to do this. I am also using Sqlite3 and I would like to save Hebrew strings there too.  </p>\n\n<p>How would I achieve this?</p>\n\n<p>The error code I am given is:  </p>\n\n<p><code>Your template was not saved as valid UTF-8. Please either specify UTF-8 as the encoding for your template in your text editor, or mark the template with its encoding by inserting the following as the first line of the template:...</code></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Problem was I was working on Notepad++ which did not save my files in UTF-8 format although they  were UTF-8 formated files. Solved by changing file format.</p>\n"},{"tags":["ruby-on-rails-3","rspec","ruby-on-rails-3.1","capybara"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":494,"score":4,"question_id":8423576,"title":"Is it possible to test the order of elements via RSpec/Capybara?","body":"<p>I'm using RSpec/Capybara as my test suite. I have some javascript that dynamically appends <code>&lt;li&gt;</code> to the end of a <code>&lt;ul&gt;</code>. I want to write a request spec to ensure that this is happening. </p>\n\n<p>I tried using the <code>has_css</code> Capybara method and advanced CSS selectors to test for the ordering of the <code>&lt;li&gt;</code> elements, but Capybara doesn't support the <code>+</code> CSS selector.</p>\n\n<p>Example:</p>\n\n<pre><code>page.should have_css('li:contains(\"ITEM #1\")')\npseuo_add_new_li\npage.should have_css('li:contains(\"ITEM #1\")+li:contains(\"ITEM #2\")')\n</code></pre>\n\n<p>Does anyone know of another way to test for ordering?</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3"],"answer_count":4,"favorite_count":10,"up_vote_count":17,"down_vote_count":0,"view_count":10435,"score":17,"question_id":3742785,"title":"Rails 3 devise, current_user is not accessible in a Model?","body":"<p>in my project.rb model, I'm trying to create a scope with a dynamic variable:</p>\n\n<pre><code>scope :instanceprojects, lambda { \n    where(\"projects.instance_id = ?\", current_user.instance_id)\n} \n</code></pre>\n\n<p>I get the following error: \"undefined local variable or method `current_user' for #\"</p>\n\n<p>Where in the controller I can access current_user.instance_id... Is there a reason the model can't access it and a way to get access? Also, is this the right place to create a scope like the above, or does that belong in the controller?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13283195,"title":"How to run single test class using minitest in ROR","body":"<p>My Gemfile looks like this:-</p>\n\n<pre><code>group :test do\n  # Pretty printed test output\n  gem 'capybara'#,'1.1.2'\n  gem 'cucumber-rails','1.2.1'\n  gem 'cucumber','1.1.4'\n  gem 'rspec-rails','2.8.1'\n  gem 'rspec-cells','0.1.2'\n  gem \"factory_girl_rails\"\n  gem \"guard-rspec\"\n  gem \"minitest\"\n  gem 'headless'\n  gem 'minitest-rails'\n  gem 'minitest-rails-capybara'  \n end\n</code></pre>\n\n<p>minitest_helper.rb looks like :-</p>\n\n<pre><code>ENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path(\"../../config/environment\", __FILE__)\nrequire \"minitest/autorun\"\nrequire \"capybara/rails\"\n\n\nclass ControllerTest  &lt; MiniTest::Spec\n include Rails.application.routes.url_helpers\n include Capybara::DSL\n register_spec_type(/integration$/, self)\nend\n</code></pre>\n\n<p>And my products_controller_test.rb looks like this:-</p>\n\n<pre><code>require \"minitest_helper\"\n\n\ndescribe \"Products Controller\" do\n   it \"shows product's name\" do  \n    uname=\"Glasses\"\n\n    product1 = Product.create!(:name =&gt; uname, :description =&gt; uname, :no_of_items =&gt;    3,:fee_percentage =&gt; 4)\n    visit products_path\n    page.text.must_include \"Glasses\"\n  end\n\n   end\n</code></pre>\n\n<p>BUT..after executing ruby <code>-Itest test/controllers/products_controller_test.rb</code></p>\n\n<p>I get no error,no indication to show that this test class has been loaded :-</p>\n\n<pre><code>ruby -Itest test/controllers/products_controller_test.rb\n:public is no longer used to avoid overloading Module#public, use :public_folder instead\n    from /usr/local/rvm/gems/ruby-1.9.2-p290/gems/resque-1.19.0/lib/resque/server.rb:12:in `&lt;class:Server&gt;'\nLoaded suite test/controllers/products_controller_test\nStarted\n\nFinished in 0.004953 seconds.\n\n0 tests, 0 assertions, 0 failures, 0 errors, 0 skips\n</code></pre>\n\n<p><em><strong>its first time i am using Minitest...</em></strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13291501,"title":"Create new many-to-many nested models in rails","body":"<p>I have a typical elementary problems which I cannot find a nice solution for. Let's take the typical many to many relationship in Rails, with the join table used to assign a value:</p>\n\n<pre><code>Recipe\n    has_many :recipe_ingredients\n    has_many :ingredients, :through =&gt; :recipe_ingredients\n    accepts_nested_attributes_for :recipe_ingredients\n\nIngredient\n    has_many :recipe_ingredients\n    has_many :recipes, :through =&gt; :recipe_ingredients\n\nRecipeIngredient\n    belongs_to :recipe\n    belongs_to :ingredient\n    attr_accessible :quantity\n</code></pre>\n\n<p>Nothing strange here. Let's say now I want to to create a new recipe with new ingredients all in one go. I have some JSON sent to the server like this:</p>\n\n<pre><code>{\"recipe\"=&gt;\n    {\"name\"=&gt;\"New Recipe\", \n     \"ingredients\"=&gt;\n        [{\"name\" =&gt; \"new Ingr 1\", \"quantity\"=&gt;0.1},\n         {\"name\" =&gt; \"new Ingr 2\", \"quantity\"=&gt;0.7}]\n    }\n}\n</code></pre>\n\n<p>I reckon I can navigate the params and create the objects one by one but I was looking into leveraging the many-to-many association and above all the <code>accepts_nested_attributes_for</code>, thus being able to do something like <code>Recipe.create(params[:recipe])</code> and have the object tree created for me. If that means changing the JSON being sent, it is not a problem. :)</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","upgrade","form-for"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":586,"score":2,"question_id":7044027,"title":"How to upgrade the :update=>'div_id' option of remote_form_for from Rails 2 to Rails 3?","body":"<p>I can't figure out how to upgrade this code from Rails 2 to Rails 3:</p>\n\n<pre><code>&lt;% remote_form_for(item, :update =&gt; 'div_id') do |f| %&gt;\n... \n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>&lt;%= form_for :item, :remote =&gt; true, :url =&gt; { :controller =&gt; \"items\", :action =&gt; \"create\" }, :update =&gt; 'div_id' do |f| %&gt;\n...\n</code></pre>\n\n<p>It creates the new item but <strong>it fails in updating the content</strong> within <code>&lt;div id=\"div_id\"&gt;&lt;/div&gt;</code> tags. It seems Rails 3 no longer supports the \"<code>:update</code>\" option for a remote <code>form_for</code>. Any suggestion?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13291445,"title":"add self class to models rails 3","body":"<p>I have 3 models:</p>\n\n<pre><code>Class Model1\n\nend\n\nClass Model2\n\nend\n\nClass Model3\n\nend\n</code></pre>\n\n<p>I have this code:</p>\n\n<pre><code>scope :created_between, lambda { |start_time, end_time| where(:created_at =&gt; (start_time...end_time)) }\n\nclass &lt;&lt; self\n ## Class methods for calculating searches\n def created_today\n  today = Time.zone.now\n  created_between(today.beginning_of_day, today.end_of_day)\n end\n\n def created_yesterday\n  yesterday = Time.zone.now - 1.day\n  created_between(yesterday.beginning_of_day, yesterday.end_of_day)\n end\n\n def created_last_week\n  start_time = (Time.zone.now - 1.week).beginning_of_day\n  end_time = Time.zone.now\n  created_between(start_time, end_time)\n end\n\n def created_last_month\n  start_time = (Time.zone.now - 1.month).beginning_of_day\n  end_time = Time.zone.now\n  created_between(start_time, end_time)\n end\n\n def created_last_year\n  start_time = (Time.zone.now - 1.year).beginning_of_day\n  end_time = Time.zone.now\n  created_between(start_time, end_time)\n end\n</code></pre>\n\n<p>end</p>\n\n<p>I need add this code to 3 models but I don't want repeat the code inside each model.</p>\n\n<p>How can I do it?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","sass","bootstrap-sass"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13292021,"title":"Bootstrap-sass installation troubles","body":"<p>I'm trying to install bootstrap-sass by doing</p>\n\n<ol>\n<li><p><code>gem 'bootstrap-sass'</code> in gemfile</p></li>\n<li><p>requiring in application.js <code>//require bootstrap</code></p></li>\n<li><p>as railcasts suggested, having a file called <code>bootstrap_and_overrides.css.scss</code> in /assets/stylesheets</p></li>\n<li><p>having <code>require bootstrap-sass</code> in config.ru</p></li>\n</ol>\n\n<p>I startp my app and get</p>\n\n<pre><code>ArgumentError in Pages#launch\n\nShowing H:/My Dropbox/project/app/views/layouts/application.html.erb where line #5 raised:\n\ndifferent prefix: \"C:/\" and \"H:/My Dropbox/project/app/assets/stylesheets\"\n  (in H:/My Dropbox/project/app/assets/stylesheets/bootstrap_and_overrides.css.scss)\nExtracted source (around line #5):\n\n2: &lt;html&gt;\n3: &lt;head&gt;\n4:   &lt;title&gt;My App&lt;/title&gt;\n5:   &lt;%= stylesheet_link_tag    \"application.css\", :media =&gt; \"all\" %&gt;\n6:   &lt;%= javascript_include_tag \"application\" %&gt;\n7:   \n8:   &lt;%= csrf_meta_tags %&gt;\n</code></pre>\n\n<p>What's going on?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":11824124,"title":"Setting Content-Disposition to attachment using Ruby on Rails and Paperclip","body":"<p>I have a – hopefully small – problem.</p>\n\n<p>I am using Ruby on Rails and Paperclip to handle file uploads.\nNow I want to automatically set the Content-Disposition header to \"attachment\" so that when the user clicks a link, the file is downloaded instead of shown directly in the browser.</p>\n\n<p>I found the following solution for Amazon S3:\n<a href=\"http://stackoverflow.com/questions/4811906/download-file-on-click-ruby-on-rails\">Download file on click - Ruby on Rails</a></p>\n\n<p>But I don't use S3.\nCan anybody help?</p>\n\n<p>Thanks in advance,\n/Lasse</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":34,"score":3,"question_id":13028114,"title":"Navigate nested has_many","body":"<p>I have nested has_many associations</p>\n\n<p>Project has many Parts\nPart has many Tasks\nTask has many jobs</p>\n\n<p>Is there a better way to get all the jobs associated to a project than</p>\n\n<pre><code>project.parts.each do |p|\n  p.tasks.each do |t|\n    t.jobs.each do |j|\n      ...\n    end\n  end\nend \n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","html5-video"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":16,"score":-3,"question_id":13291822,"title":"Play incoming video file, in Rails","body":"<p>I am connecting to a server and receiving live video footage, and this is stored in a file\ndata.mp4. I want a way to play that file continuously, show I can see the footage. I need to test it first using VLC (or any similar program) and then  put in in an HTML5 video tag for the user.</p>\n\n<p>Any help/guidance?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13282246,"title":"How might I render a JSON string for a dynamic rails route?","body":"<p>I've been setting up a tagging system for a post. I am using the awesome Select2 gem. One thing that I've noticed is that when I go to edit a post, <strong>the tags for that post do not show up.</strong> I found a way to <strong>get tags to pre-populate using the val() function</strong>.</p>\n\n<p>However, because my <strong>edit route</strong> which is users/:user_id/post/:id <strong>is</strong> inherently <strong>dynamic</strong>, <strong>it makes it difficult to use a string for the *<em>.getJSON</strong>.</em>* </p>\n\n<p>How might I do this or do it differently?</p>\n\n<p>Please note I purposely did not fill in a correct JSON path for the first .getJSON.. this is where I am having difficulty. </p>\n\n<pre><code>var items = [];\nvar prepopulate = [];\n\n$.getJSON('http://localhost:3000/[JSON PATH HERE]', function(data) {\n    $.each(data, function(i, obj) {\n        return prepopulate.push(obj.name);\n        });\n\n  $.getJSON('http://localhost:3000/tags.json', function(data) {\n      $.each(data, function(i, obj) {\n          return items.push(obj.name);\n          });\n      $(\"#post_tag_ids\").val(prepopulate).select2({\n    width: \"element\",\n    tags: items,\n    tokenSeparators: [\",\", \" \"]\n    });\n  });\n});\n</code></pre>\n"},{"tags":["ruby-on-rails-3","schedule"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":9,"score":0,"question_id":13291174,"title":"schedule vaccinations ahead","body":"<p>For a Ruby 1.9.3 and Rails 3.2.0 application I try to schedule vaccinations ahead.\nFor example: </p>\n\n<p>A cow is born on 1/1/2012:</p>\n\n<ul>\n<li>I select a the date with a datepicker on 1/1/2012</li>\n<li>need vaccine \"a\" after 1_month.from_now</li>\n<li>need vaccine \"b\" after 2_months.from_now </li>\n<li>need vaccine \"c\" after 5_months.from_now</li>\n<li>until 8 vaccines on different times</li>\n</ul>\n\n<p>One Farmer has_many Animals --- One Animal has_many Vaccines --- One Animal has_one Schedule</p>\n\n<p>How do I store the calculated values back into the database? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13290414,"title":"Opening and executing a batch file which is saved in the application","body":"<p>I wrote a batch file, which is stored in my controller, which should write to a .bat file in the public folder. </p>\n\n<p>The code is:</p>\n\n<pre><code>def checkin\n    file_path = \"#{Rails.root}/public/batfiles/#{Time.now.hour}_#{Time.now.min}_#   {Time.now.sec}.bat\"\n    file = File.new(file_path, 'w')\n    svn_path = params[:svn_path]\n    content = ''\n    content += \"@echo off\\n\"\n    content += \"echo.\\n\"\n    content += \"echo. [ SVN Updater ]\\n\"\n    content += \"set SVNURL=#{svn_path}\\n\"\n    content += \"set SOURCE=C:\\\\Users\\\\\"\n    content += \"set SVN=C:\\\\Program Files\\\\TortoiseSVN\\\\bin\\n\"\n    content += \"echo.\\n\"\n    content += '\"%SVN%\\TortoiseProc.exe\" /command:checkout /path:\"%SOURCE%\" /url:%SVNURL% /closeonend:2'\n    content += \"echo. done.\\n\"\n    content += \"echo.\\n\"\n    content += \"echo. Operation complete.\\n\"\n    file.write content\n    file.close\n    send_file(file.path)\n  end\n</code></pre>\n\n<p>When I save the file in public/batfiles/.bat, I want to run the file not on the server but on the user's system. </p>\n\n<p>Right now the user downloads the .bat file and runs it from the browser. Instead, I want the user to do nothing but have the application open his .bat file and run it in his local machine. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13238137,"title":"get counter nested model mongoid","body":"<p>2 models:</p>\n\n<pre><code>Class User\n include Mongoid::Document\n has_many :reports\nend\n\nClass Report\n include Mongoid::Document\n belongs_to :user\nend\n</code></pre>\n\n<p>I need a query to get all users have 6 or more reports, something like:.</p>\n\n<pre><code>Users.where(reports.count &gt; 5)\n</code></pre>\n\n<p>I use mongo id 2.4.12</p>\n\n<p>How can I do it?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails-3","jeditable","edit-in-place","best-in-place","rich-text-editor"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13076653,"title":"Using best_in_place with rich-text editor like TinyMCE","body":"<p>I'm using the <code>best_in_place</code> gem to do in-place editing in a Rails application. However, I need (X)HTML editing on some of the text areas, so I need a rich-text editor. TinyMCE is being used elsewhere on the site. </p>\n\n<p>However, it's not trivial to add an editor to <code>best_in_place</code>. To grossly oversimplify, the gem uses jQuery to insert the <code>textarea</code> tag on the fly, and TinyMCE initializes at page load, replacing available <code>textarea</code>s with an editor, so when <code>best_in_place</code> puts in its <code>textarea</code>, TinyMCE has already come and gone. I've tried re-initializing TinyMCE after <code>best_in_place</code> inserts its textarea, but I don't think I've found the correct place(s) in the code to do that, because so far it hasn't worked.</p>\n\n<p>There's <a href=\"http://railscasts.com/episodes/302-in-place-editing?view=comments#comment_154834\" rel=\"nofollow\">a rumor</a> that this integration is possible, but no documentation was visible in my web searches, so pointers are welcome. (Likewise <a href=\"http://stackoverflow.com/a/452762/306084\">this answer</a> is unhelpful, pointing to two broken links.) I think my preferred order of solutions would be something like</p>\n\n<ul>\n<li>Here's how to integrate TinyMCE with <code>best_in_place</code></li>\n<li>It can't be done with TinyMCE but here's how to do it with another rich-text editor</li>\n<li>It can't be done with <code>best_in_place</code> but here's <a href=\"https://www.ruby-toolbox.com/categories/rails_in_place_editing\" rel=\"nofollow\">another rich-text edit-in-place solution</a> for Rails 3.2.x.</li>\n</ul>\n"},{"tags":["html","css","ruby-on-rails-3","html5","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13271502,"title":"twitter bootstrap typeahead dropdown","body":"<p>Hi i am using twitter bootstrap. I have used typeahead in my model window. My Problem is when I type in textbox the dropdown is coming perfect but its coming at very bottom of textbox. I have observed that there is attribute top set when drop down is coming. But I don't know how to change that at run time. </p>\n\n<p>Here is the Image: <img src=\"http://i.stack.imgur.com/GwXLj.png\" alt=\"enter image description here\"></p>\n\n<p>I am not good in CSS. Can anybody tell me that what should do to resolve this problem ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13287937,"title":"Including helper method in controller test","body":"<p>How do i include some helper into my controller_spec code?\nI have method called \"a_title(ads)\" in dates_ads_helper, and returns self.\nHow do i use this method in my controller_spec test?</p>\n\n<p>When i try to call it in my controller_spec file i'm getting this error</p>\n\n<pre><code>NoMethodError:\n       undefined method `a_title' \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","custom-routes"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":18,"score":2,"question_id":13290121,"title":"How to translate root specific resource declaration from Rails 2 to Rails 3?","body":"<p>I'm migrating an application from Rails 2.3.5 to Rails 3.2.8. \nI have this route from the Rails 2 app that is giving me headaches:</p>\n\n<pre><code>  map.resources :soumission_vt,\n                :path_prefix =&gt; \"/soumission/VT/:page_id\", :as =&gt; 'police/:action/:id',\n                :requirements =&gt; {:page_id =&gt; /\\S+/}\n</code></pre>\n\n<p>wich generates the following:</p>\n\n<pre><code>soumission_vt_index GET    /soumission/VT/:page_id/police/:action/:id(.:format)               {:controller=&gt;\"soumission_vt\"}\n                    POST   /soumission/VT/:page_id/police/:action/:id(.:format)               {:controller=&gt;\"soumission_vt\"}\nnew_soumission_vt   GET    /soumission/VT/:page_id/police/:action/:id/new(.:format)           {:controller=&gt;\"soumission_vt\"}\nedit_soumission_vt  GET    /soumission/VT/:page_id/police/:action/:id/:id/edit(.:format)      {:controller=&gt;\"soumission_vt\"}\nsoumission_vt       GET    /soumission/VT/:page_id/police/:action/:id/:id(.:format)           {:controller=&gt;\"soumission_vt\"}\n                                    PUT    /soumission/VT/:page_id/police/:action/:id/:id(.:format)           {:controller=&gt;\"soumission_vt\"}\n                    DELETE /soumission/VT/:page_id/police/:action/:id/:id(.:format)           {:controller=&gt;\"soumission_vt\"}\n</code></pre>\n\n<p>I translated it this way in Rails 3:</p>\n\n<pre><code>  scope '/soumission/VT/:page_id', :constraints =&gt; {:page_id =&gt; /\\S+/} do\n    resources :soumission_vt, :as =&gt; 'police/:action/:id'\n  end\n</code></pre>\n\n<p>but I am getting an Invalid route name: 'police/:action/:id_index'...</p>\n\n<p>So is there a way to reproduce those routes in Rails 3?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","query","activerecord","random"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13289352,"title":"Rails Active Record Query - find random record that meets a condition","body":"<p>I have a model from which I want to pull a random record that meets a certain criteria. For example: give me a random record from table Thing where column_name = true.</p>\n\n<p>To get a random record from the model I can do the following:</p>\n\n<pre><code>Thing.offset(rand(Thing.count)).first\n</code></pre>\n\n<p>and I want to combine that with the query:</p>\n\n<pre><code>Thing.where(\"column_name = ?\", true).all\n</code></pre>\n\n<p>This doesn't work:</p>\n\n<pre><code>counter = Thing.where(\"column_name = ?\", true).count\nThing.where(\"column_name = ?\", true).offset(rand(counter)).first\n</code></pre>\n\n<p>Any ideas on how to write this query would be greatly appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","geospatial"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":4,"score":0,"question_id":13289679,"title":"Using geoNear with Rails / Mongoid","body":"<p>I'm having problems querying Geospatial indexes with MongoDB / Rails.\nI'm using this gem - <a href=\"https://github.com/kristianmandrup/mongoid_geospatial\" rel=\"nofollow\">https://github.com/kristianmandrup/mongoid_geospatial</a></p>\n\n<p>Here's my fairly basic model:</p>\n\n<pre><code>class Company\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::Geospatial\n\n  field :name, type: String\n\n  field :location, type: Array, spatial: true\n\n  spatial_index :location\n\n  validates :location, location: true\nend\n</code></pre>\n\n<p>Then, in my controller, I have this</p>\n\n<pre><code>    #@vendors = Vendor.where(:location.near =&gt; {:point =&gt; [-2.1294761000000335,57.0507625], :max =&gt; 5})\n</code></pre>\n\n<p>However, this isn't returning expected results (ie- it's returning things from all over the place, not just near that particular lon / lat)</p>\n\n<p>Also, how would I go about doing a geoNear with this?<br>\nSo that I can get back the distances from central point for each result?</p>\n\n<p><strong>Note</strong>\nAfter writing this question, I've seen the gem has been updated, but I'm not sure if there's a better alternative..?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":13259763,"title":"Rails condition where association has_many has count more than one","body":"<p>Package.rb</p>\n\n<pre><code>has_many :deals\n</code></pre>\n\n<p>Deal.rb</p>\n\n<pre><code>belongs_to package\n</code></pre>\n\n<p>Now simple question is I want to get all packages where deals count is more than one.\nWhat is the best method to do it? <code>where(:available_for_purchase =&gt; true)</code>and <code>self.deals.count &gt; 0</code> </p>\n\n<p>(package.rb)</p>\n\n<pre><code>  class &lt;&lt; self\n    def available\n      where(:available_for_purchase =&gt; true)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","localization","floating-point"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":281,"score":2,"question_id":4836536,"title":"rails 3 localized user input","body":"<p>I am developing a web application primarily for the german market. I want my users to be able to input floats the way it is usually in germany, with a comma <code>float = 1,5</code>.</p>\n\n<p>Currently I use a pseudo attribute in the model that switches the comma for a fullstop. But there must be a better way. Any ideas?</p>\n\n<p>Example how I currently do it:</p>\n\n<pre><code>def localized_float\n  vh.number_with_precision(hourly_wage, :precision =&gt; 2)\nend\n\ndef localized_float=(value)\n  self[:float] = value.gsub('.', '').gsub(',', '.')\nend\n</code></pre>\n\n<p>Thank you for any hints!</p>\n\n<p>Daniel</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13289019,"title":"Rails 3.2: Ordering a has_many :through selection, when the through-model has a default_scope","body":"<p>I have a simple time-tracking app, that has projects, tasks, and entries.</p>\n\n<p>The setup is straight-forward:</p>\n\n<pre><code>class Project &lt; ActiveRecord::base\n  has_many :tasks\n  has_many :entries, :through =&gt; :tasks\nend\n\nclass Task &lt; ActiveRecord::base\n  belongs_to :project\n  has_many :entries\n\n  default_scope order(\"name asc\") # this causes problems\nend\n</code></pre>\n\n<p>(<code>Entry</code> is entirely straight-forward, so I've left it out)</p>\n\n<p>However, I'm running into trouble when trying to do custom ordering of entries selected from a project. Specifically, I'm trying to select the latest entry like so:</p>\n\n<pre><code>latest_entry = project.entries.order(\"created_at desc\").first\n</code></pre>\n\n<p>But due to the <code>:through =&gt; :tasks</code> and the <code>default_scope</code> that <code>Task</code> has, the actual query that Rails executes becomes:</p>\n\n<pre><code>SELECT `entries`.* FROM `entries`\nINNER JOIN `tasks` ON `entries`.`task_id` = `tasks`.`id`\nWHERE `tasks`.`project_id` = 23\nORDER BY name asc, entries.date desc LIMIT 1 -- wrong order!\n</code></pre>\n\n<p>Note the <code>ORDER BY clause</code> - it includes the <code>default_scope</code> from <code>Task</code>, and only after that does it include the order I specified.</p>\n\n<p>So basically, I <em>don't</em> get the latest entry of all entries in the project, but only the latest in the first task.</p>\n\n<p>Is there any way around that? Seems like there should be a way to ignore/negate <code>default_scope</code> on a <code>through</code>-model (without completely dropping the <code>default_scope</code>)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13282106,"title":"remote search form in rails 3","body":"<p>I am trying to implement a trivial asynchronous search form that would display the search results on the same page using AJAX. My code is below. The search results are rendered using a partial view. When the form is submitted I recreate an array of results and expect it to be displayed on the page. But this is not happening, the page does not get updated. I have been looking at rails for a day now, and I think it is trivial but I need help.</p>\n\n<p>route:</p>\n\n<pre><code>match 'search' =&gt; 'search#index'\n</code></pre>\n\n<p>controller:</p>\n\n<pre><code>class SearchController &lt; ApplicationController\n  def index\n    @results = params[:search] ? ['test0', 'test1', 'test2'] : []\n  end\nend\n</code></pre>\n\n<p>view <code>index.html.erb</code>:</p>\n\n<pre><code>&lt;%= form_tag search_path, :method =&gt; :get, :remote =&gt; true do %&gt;\n  &lt;%= text_field_tag :search %&gt;\n  &lt;%= submit_tag 'Search' %&gt;\n&lt;% end %&gt;\n&lt;div id=\"results\"&gt;\n  &lt;%= render :partial =&gt; 'results' %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>partial view <code>_results.html.erb</code>:</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% @results.each do |result| %&gt;\n    &lt;li&gt;\n      &lt;%= result %&gt;\n    &lt;/li&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","date","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13288871,"title":"getting error with dates ruby on rails 3","body":"<p>I have this on my model</p>\n\n<pre><code>Class User\n include Mongoid::Document\n  scope :created_between, lambda { |start_time, end_time| where(:created_at =&gt; (start_date...end_time)) }\n\n  class &lt;&lt; self\n    ## Class methods for calculating relative users\n\n    def created_today\n      today = Time.zone.now\n      created_between(today.beginning_of_day, today.end_of_day)\n    end\n\n    def created_yesterday\n      yesterday = Time.zone.now - 1.day\n      created_between(yesterday.beginning_of_day, yesterday.end_of_day)\n    end\n\n    def created_last_week\n      start_time = (Time.zone.now - 1.week).beginning_of_day\n      end_time = Time.zone.now\n      created_between(start_time, end_time)\n    end\n\n    def created_last_month\n      start_time = (Time.zone.now - 1.month).beginning_of_day\n      end_time = Time.zone.now\n      created_between(start_time, end_time)\n    end\n\n    def created_last_year\n      start_time = (Time.zone.now - 1.year).beginning_of_day\n      end_time = Time.zone.now\n      created_between(start_time, end_time)\n    end\n  end\n end\n</code></pre>\n\n<p>In my controller:</p>\n\n<pre><code> def index\n   @users_created_today = User.created_today.all\n   @users_created_today = User.created_today.all\n   @users_created_yesterday = User.created_yesterday.all\n   @users_created_last_week = User.created_last_week.all\n   @users_created_last_month = User.created_last_month.all\n   @users_created_last_year = User.created_last_year.all\n   .\n   .\n   .\n end\n</code></pre>\n\n<p>I get the next error:</p>\n\n<pre><code>undefined local variable or method `start_date' for User:Class\n</code></pre>\n\n<p>Thank you very much</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13287588,"title":"What is the scope of Ruby code in a js.erb file and how can it access controller variables","body":"<p>I have a js.erb file in which I want to use asset_path. It is included in a view like this:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"resources/gallery_resource\" %&gt;\n</code></pre>\n\n<p>This works fine while the asset path is self contained, however I need to use a variable defined in the controller (@resource) inside the asset path:</p>\n\n<pre><code>element.image = \"&lt;%= asset_path 'resources/galleries/'+@resource.uid+'/'+index+'.jpg' %&gt;\"\n</code></pre>\n\n<p>The problem being @resource is not defined. So what is the scope of this Ruby code if it doesn't have access to the controller? And how should I make the variable available here?</p>\n\n<p><em>I understand how to make the variable accessible to the Javascript, but I want to make it available to the embedded Ruby.</em></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":24,"score":2,"question_id":13288812,"title":"Does this hit the db everytime?","body":"<p>If I have in: </p>\n\n<pre><code>config/initializers/foobar.rb \n</code></pre>\n\n<p>which has:</p>\n\n<pre><code>$foos = User.where(:foo =&gt; true).pluck(:id)\n</code></pre>\n\n<p>In my app when i call <code>$foo</code>, does it hit the db everytime?</p>\n\n<p>Or does <code>$foo</code> only hits the db, on server start?</p>\n"},{"tags":["ruby-on-rails-3","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":405,"score":0,"question_id":10918569,"title":"Rails - update nested attributes before saving to database","body":"<p>Long time reader of Stackoverflow but have never found myself in a position to ask a question (that hasn't already been answered).  I guess there's a first time for everything so here it goes...</p>\n\n<p><strong>System Info:</strong> <br />\nRuby Version = 1.8.7 <br />\nRails Version = 3.2.2</p>\n\n<p><strong>Situation:</strong><br />\nWe have an application with a user registration system in place.  In order to hook up and populate all of our tables correctly, we are utilizing Complex/Nested Forms within the registration view.  I actually have the nested forms working perfectly, everything is being populated as it should, its awesome really.</p>\n\n<p>Here is the problem:  I need to set one of the value of one of the nested attributes AFTER the form post but BEFORE the records are saved.</p>\n\n<p>Here is a quick example so you can see what I'm talking about a little bit better:\nA user registers with our site.  When they register a record is created in the Users data table.  Each user is also classified as a team_mate (join table) and assigned to their very own individual team (at first).  But, a 'team' (table) also has an 'alias' field in it which, on the initial creation of the user we would like to set to the users first name (without having to have them enter their first name into an 'alias' field on the form). </p>\n\n<p><strong>So, I guess the question would be:</strong>  How to I manually set the value of a nested attribute after the form post and before the records are saved to the database?</p>\n\n<p>A (simplistic) example of the table schema looks is as follows:<br /></p>\n\n<p>Users (id, first_name, last_name, created_at, updated_at)</p>\n\n<p>Team_mates(id, user_id, team_id, created_at, updated_at) - join table</p>\n\n<p>Teams(id, alias, created_at, updated_at)  </p>\n\n<p><strong>Models:</strong></p>\n\n<p>User.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :team_mates, :dependent =&gt; :destroy\n  has_many :teams, :through =&gt; :team_mates, :foreign_key =&gt; :team_id\n  accepts_nested_attributes_for :team_mates, :allow_destroy =&gt; true\n\n  before_save :set_defaults\n\n  private\n    def set_defaults\n      #want to set :users =&gt; :team_mates_attributes =&gt; :team_attributes =&gt; :alias to @user.first_name here\n\n      # Would prefer to handle this here instead of in the controller.\n    end\n  end\n</code></pre>\n\n<p>Team.rb</p>\n\n<pre><code>class Team &lt; ActiveRecord::Base\n  has_many :team_mates, :dependent =&gt; :destroy\n  has_many :users, :through =&gt; :team_mates, :foreign_key =&gt; :user_id\n\nend\n</code></pre>\n\n<p>Team_mate.rb</p>\n\n<pre><code>class TeamMate &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :team\n\n  accepts_nested_attributes_for :team, :allow_destroy =&gt; true\nend\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<p>Users_controller.rb</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\ndef new\n  @user = User.new\n  @user.emails.build(:is_default_email =&gt; 1)\n  @user.build_login\n\n  @user.team_mates.build.build_team(:alias =&gt; 'Clinton444', :created_at =&gt; Time.new, :updated_at =&gt; Time.new)\n\n  respond_to do |format|\n    format.html\n    format.json { render :json =&gt; @match }\n  end\nend\n\ndef create\n  @user = User.new(params[:user])\n\n  @user.attributes = ({ \"user\" =&gt; { \"team_mates\" =&gt; { \"team\" =&gt; { \"alias\" =&gt; @user.first_name } } } }) #--this doesn't work...\n\n  @user.attributes = ({ :user =&gt; { :team_mates =&gt; { :team =&gt; { :alias =&gt; @user.first_name } } } }) #--neither does this...\n\n\n  respond_to do |format|\n    if @user.save\n      format.html  { redirect_to(@user, :notice =&gt; 'User was successfully created.') }\n      format.json  { render :json =&gt; @user, :status =&gt; :created, :location =&gt; @user }\n    else\n      format.html  { render :action =&gt; \"new\" }\n      format.json  { render :json =&gt; @user.errors, :status =&gt; :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<p>new.html.haml</p>\n\n<pre><code>  = form_for(@user, :html =&gt; {:class =&gt; 'form-horizontal'}) do |f|\n- if @user.errors.any?\n  .alert\n    %h2\n      = pluralize(@user.errors.count, \"error\")\n      prohibited this post from being saved:\n    %ul\n      - @user.errors.full_messages.each do |msg|\n        %li\n          = msg\n%fieldset\n.control-group\n  = f.label :first_name, :class =&gt; \"control-label\"\n  .controls\n    =f.text_field :first_name, :class =&gt; \"span8\"\n\n.control-group\n  = f.label :last_name, :class =&gt; \"control-label\"\n  .controls\n    =f.text_field :last_name, :class =&gt; \"span8\"\n\n= f.fields_for :emails do |e|\n  =e.hidden_field :is_default_email, :class =&gt; \"span8\"\n\n  .control-group\n    = e.label :email, :class =&gt; \"control-label\"\n    .controls\n      =e.text_field :email, :class =&gt; \"span8\"\n\n= f.fields_for :team_mates do |tm|\n  = tm.fields_for :team do |t|\n    =t.hidden_field :alias, :class =&gt; \"span8\"\n    =t.hidden_field :created_at, :class =&gt; \"span8\"\n    =t.hidden_field :updated_at, :class =&gt; \"span8\"\n\n= f.fields_for :login do |e|\n  .control-group\n    = e.label :user_login, :class =&gt; \"control-label\"\n    .controls\n      =e.text_field :user_login, :class =&gt; \"span8\"\n\n  .control-group\n    = e.label :password_encrypted, :class =&gt; \"control-label\"\n    .controls\n      =e.text_field :password_encrypted, :class =&gt; \"span8\"\n\n.control-group\n  .controls\n    =f.submit :class =&gt; 'btn btn-primary btn-medium'\n</code></pre>\n\n<p><strong>And finally</strong></p>\n\n<p>Rails server output on form post</p>\n\n<pre><code>  Parameters: {\"user\"=&gt;{\"team_mates_attributes\"=&gt;{\"0\"=&gt;{\"team_attributes\"=&gt;{\"created_at\"=&gt;\"Wed Jun 06 09:52:19 -0600 2012\", \"alias\"=&gt;\"asfs444\", \"updated_at\"=&gt;\"Wed Jun 06 09:52:19 -0600 2012\"}}}, \"first_name\"=&gt;\"lkjlkjlsdfslkjeowir\", \"last_name\"=&gt;\"ouisodifuoixv\", \"emails_attributes\"=&gt;{\"0\"=&gt;{\"is_default_email\"=&gt;\"1\", \"email\"=&gt;\"lpisfsopf@psflsjdk.com\"}}, \"login_attributes\"=&gt;{\"user_login\"=&gt;\"lkjsdfooiusfd\", \"password_encrypted\"=&gt;\"[FILTERED]\"}}, \"utf8\"=&gt;\"✓\", \"commit\"=&gt;\"Create User\", \"authenticity_token\"=&gt;\"CQLQ93/0VlncSzMlmtLPHgaVrrvjuHFN+lN6CYCsiR8=\"}\n</code></pre>\n\n<p>Please note:  I am very new to rails so bare with me here.  Also, I have searched all through the forums looking for an answer to a question like this.  I have found a few that are similar, but none of them worked when I tested them out.</p>\n\n<p>Finally, after looking at the models you might be wondering where emails/logins are coming from.  They're built within the model on our system, but are not really part of this question so I omitted the code for them.  They are working, so the problem isn't on that side.</p>\n\n<p>Anyway, thank you for your time and please let me know if you need additional information.</p>\n"},{"tags":["ruby-on-rails-3","capybara","resque","capybara-webkit"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":5,"score":1,"question_id":13288526,"title":"Capybara-Webkit close webkit_server","body":"<p>I am using Capybara-Webkit to automate some work on a website.\nThis is done in the background in a Resque task. After some executions there are quiet a lot webkit_server processes, that weren't closed by Capybara. \nSo how can I force Capybara to close it at the end?</p>\n\n<pre><code>session = Capybara::Session.new(:webkit)\nsession.visit URL\nsession.click_button(BUTTON)\n....\n</code></pre>\n"},{"tags":["ruby-on-rails-3","configuration","devise","environment-variables"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":909,"score":4,"question_id":7887932,"title":"Turning off ip spoofing check in Rails 3 application","body":"<p><strong>The problem</strong></p>\n\n<p>I'm getting the error:</p>\n\n<p><code>ActionDispatch::RemoteIp::IpSpoofAttackError (IP spoofing attack?!HTTP_CLIENT_IP=\"203.29.78.157\"HTTP_X_FORWARDED_FOR=\"172.20.19.214, 116.50.58.180\"):</code></p>\n\n<p>when some people visit my Rails 3.0.10 application and log in or confirm their email address. I'm using Devise.</p>\n\n<p><strong>What I've tried</strong></p>\n\n<p><a href=\"http://pivotallabs.com/users/jay/blog/articles/1216-standup-4-7-2010-disabling-rails-ip-spoofing-safeguard\" rel=\"nofollow\">http://pivotallabs.com/users/jay/blog/articles/1216-standup-4-7-2010-disabling-rails-ip-spoofing-safeguard</a></p>\n\n<p>So within <code>production.rb</code> I've added:</p>\n\n<p><code>config.action_controller.ip_spoofing_check = false</code></p>\n\n<p>I've also tried adding it to <code>environment.rb</code>:</p>\n\n<pre><code>Things3::Application.configure do\n  config.action_mailer.delivery_method = :smtp\n  config.action_controller.ip_spoofing_check = false\nend\n</code></pre>\n\n<p>I still get the error. What am I missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13287741,"title":"find_or_initialize_by_title uniqueness","body":"<p>I've got a text_field for tags in a nested form(It's being associated with Trips) that is being split on a comma on save and saving the words in the string seperated by the comma. I've jumped through some hoops to make it happen, and it's happening as I want by now. The only downside is that it seems that it doesn't make the current tag a unique tag(If it exists associate the existing one with the new Trip instead of making a new tag)</p>\n\n<p>Here's the code splitting and saving the tag seperately:</p>\n\n<pre><code>if params[:trip][:tags_attributes].present?\n  params[:trip][:tags_attributes].each do |tag| \n   @a = tag[1]['title']\n   @a.split(',').each do |single|\n      @trip.tags.find_or_initialize_by_title(single)  \n   end\n  end\nend\n</code></pre>\n\n<p>And just in case my Trip.rb:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :user_id, \n  :triplocations_attributes, :photo, :category_ids, \n  :start_city, :tripphotos_attributes, :img_url, :thumb_url, :images,\n  :tags_attributes, :province\n\n  # validates :title, :length =&gt; {:minimum =&gt; 3}\n  # validates :description, :presence =&gt; true\n  # validates_associated :tags\n\n\n  has_many :triplocations, :dependent =&gt; :destroy\n  has_many :tripphotos, :dependent =&gt; :destroy\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :tags\n\n\n  accepts_nested_attributes_for :triplocations, allow_destroy: true\n  accepts_nested_attributes_for :tripphotos, allow_destroy: true\n  accepts_nested_attributes_for :categories\n  accepts_nested_attributes_for :tags\n\nend\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","phusion-passenger","dragonfly-gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13237954,"title":"wrong URLs deploying to a subdirectory","body":"<p>in my view I have:</p>\n\n<pre><code>&lt;a href=\"&lt;%= @project.file.url %&gt;\"&gt;&lt;%= @project.file.name %&gt;&lt;/a&gt;\n</code></pre>\n\n<p>locally, in development, all works fine and I can download the file. But on my VPS in production I get a 404:</p>\n\n<pre><code>[Mon Nov 05 18:28:40 2012] [error] [client 88.7.246.152] File does not exist: \n  /srv/http/media, referer: http://www.stanosas.it/copisteria/projects/1\n</code></pre>\n\n<p>no trace in <code>log/production.log</code></p>\n\n<p><code>link_to</code> works fine.</p>\n\n<p>here is my Apache (Passenger) setup <a href=\"https://gist.github.com/4018657\" rel=\"nofollow\">https://gist.github.com/4018657</a></p>\n\n<p>I access my app in a subfolder like <code>www.myapp.com/copisteria</code></p>\n\n<p>here is <code>config/initializers/dragonfly.rb</code> <a href=\"https://github.com/enricostano/copisteria/blob/master/config/initializers/dragonfly.rb\" rel=\"nofollow\">https://github.com/enricostano/copisteria/blob/master/config/initializers/dragonfly.rb</a></p>\n\n<p>here is <code>config/application.rb</code> <a href=\"https://github.com/enricostano/copisteria/blob/master/config/application.rb\" rel=\"nofollow\">https://github.com/enricostano/copisteria/blob/master/config/application.rb</a></p>\n\n<p>any hint?</p>\n\n<p>EDIT: It seems that Apache or Passenger doesn't recognize the subdirectory in URLs.</p>\n"},{"tags":["database","ruby-on-rails-3","image"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13287849,"title":"How to display an image on gmap stored in a database in rails3?","body":"<p>I want to display an image stored in my database on to a gmap. I am using Rails3, gem 1.9.3 and 'ym4r_gm' plugin. Here is my code:</p>\n\n<pre><code>def show\n    @member = Member.find(params[:id])\n    @map = GMap.new(\"map_div\")\n    @map.control_init(:large_map =&gt; true, :map_type =&gt; true)\n    # create marker for the source location\n    @map.icon_global_init( GIcon.new( :image =&gt; \"#{@member.image}\", \n    :icon_size =&gt; GSize.new(     40,40 ), \n    :icon_anchor =&gt; GPoint.new(12,38), :info_window_anchor =&gt; GPoint.new(9,2) ), \"a_member\") \n     a_member = Variable.new(\"a_member\") \n\n    @marker = GMarker.new([@member.lat, @member.lng],\n    :title =&gt; @member.name, :info_window =&gt; \"#{@member.city_town}, #{@member.country}\",\n    :icon  =&gt; a_member)\n\n    @map.declare_init(@marker , 'marker') # if i put 'a_member', it will display \n                                          #a default  image - pin \n    @map.overlay_init(@marker)\n    @map.center_zoom_init([@member.lat, @member.lng], 12)\n\n      respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @member }\n    end\nend\n</code></pre>\n\n<p>The map gets displayed but not an image. Thank you for your help.</p>\n"},{"tags":["ruby-on-rails-3","image","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13287575,"title":"paperclip image size notations","body":"<p>At the beginning it seemed to me a like a mistype but now as I see more examples I realize its not..</p>\n\n<p>I see <code>:thumb =&gt; \"300x300&gt;\"</code></p>\n\n<p>or <code>:thumb =&gt; \"100x100#\"</code></p>\n\n<p>and even <code>:thumb =&gt; \"180\"</code></p>\n\n<p>what do these mean? Where can I find explanation for that notation?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paypal","paypal-adaptive-payments"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13287615,"title":"Execute preapproval payment with rails & active_paypal_adaptive_payment","body":"<p>How can I execute a preapproved payment using active_paypal_adaptive_payment and rails?\nI have pre-approved payment set up (authorised by user) but I don't know how to execute the payment. Should I use execute_payment method? But what params does it take? I cannot find it in the documentation. Thanks for help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","authentication","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":14,"score":2,"question_id":13285634,"title":"Keeping POST data during sign up with Devise","body":"<p>I might be approaching this problem the wrong way ... so if you have a more elegant solution I'm all ears.</p>\n\n<p>Imagine I'm making a system like Kickstarter. I want my users to be able to specify how much they want to pledge before I ask them to sign up. </p>\n\n<p>Then, if they're not registered I need them to sign up before putting them back in the flow that they would have been on had they just signed in. Devise makes this easy by redirecting a user back to the <code>after_sign_up_path_for</code> which ends up being <code>after_sign_in_path_for</code> by default.</p>\n\n<p>So this will always issue a GET request. But if I have data that I received from the POST with the amount they wanted to pledge, but that's lost.</p>\n\n<p>Is the only way to do this to store that posted data in the session? Or is there a clever way to start creating the pledge record without the user (without needing to run jobs to destroy orphaned pledge records)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13208943,"title":"Rails Devise Strange behaviour with foreign key","body":"<p>I'm trying to create a simple User &amp; Address Model.</p>\n\n<p>I've created a nested form that has an address model nested into the User model. My User Model has the devise attributes etc.</p>\n\n<p>It all works fine, except that there's a strange behaviour happening when the user is created.</p>\n\n<p>If you read below, you'll notice the \"user_id\" which is the address of the owning user is populated when the record is first committed. But then immediately afterward, something that looks like it's in Devise core, is resetting the user_id to null.</p>\n\n<p>Does anyone know what would be causing this? </p>\n\n<blockquote>\n  <p>Started POST \"/users\" for 127.0.0.1 at 2012-11-03 22:45:20 +1100\n  Processing by Member::UsersController#create as HTML   Parameters:\n  {\"utf8\"=>\"✓\",\n  \"authenticity_token\"=>\"Pr8lSEJalWwosuaLPOrYqQ+sOkFCyoNujaUybxpZDAg=\",\n  \"user\"=>{\"address_attributes\"=>{\"first_name\"=>\"HOlley\",\n  \"last_name\"=>\"Hou\"}, \"email\"=>\"HollyHou@hisense.com.au\",\n  \"password\"=>\"[FILTERED]\", \"password_confirmation\"=>\"[FILTERED]\"}}\n  Creating a new user    (0.1ms)  BEGIN    (0.1ms)  COMMIT    (0.0ms) \n  BEGIN   Member::User Exists (0.3ms)  SELECT 1 AS one FROM\n  <code>member_users</code> WHERE <code>member_users</code>.<code>email</code> = BINARY\n  'hollyhou@hisense.com.au' LIMIT 1   SQL (0.2ms)  INSERT INTO\n  <code>member_users</code> (<code>created_at</code>, <code>current_sign_in_at</code>,\n  <code>current_sign_in_ip</code>, <code>email</code>, <code>encrypted_password</code>,\n  <code>last_sign_in_at</code>, <code>last_sign_in_ip</code>, <code>remember_created_at</code>,\n  <code>reset_password_sent_at</code>, <code>reset_password_token</code>, <code>sign_in_count</code>,\n  <code>updated_at</code>) VALUES ('2012-11-03 11:45:20', NULL, NULL,\n  'hollyhou@hisense.com.au',\n  '$2a$10$1JvC/sO85L2esNp8xA9qseTc78.rtOyF3zSBi/fOTiWJRt9.zgYha', NULL,\n  NULL, NULL, NULL, NULL, 0, '2012-11-03 11:45:20')   SQL (0.2ms) \n  INSERT INTO <code>member_addresses</code> (<code>address3</code>, <code>address_1</code>, <code>address_2</code>,\n  <code>address_type</code>, <code>business_name</code>, <code>city</code>, <code>country</code>, <code>created_at</code>,\n  <code>first_name</code>, <code>geo_late</code>, <code>geo_long</code>, <code>is_primary</code>, <code>last_name</code>,\n  <code>middle_name</code>, <code>phone1</code>, <code>phone1_type</code>, <code>phone2</code>, <code>phone2_type</code>,\n  <code>postcode</code>, <code>primary_email</code>, <code>secondary_email</code>, <code>state</code>, <code>status</code>,\n  <code>suburb</code>, <code>title</code>, <code>updated_at</code>, <code>user_id</code>) VALUES (NULL, NULL, NULL,\n  NULL, NULL, NULL, NULL, '2012-11-03 11:45:20', 'HOlley', NULL, NULL,\n  NULL, 'Hou', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,\n  NULL, NULL, NULL, '2012-11-03 11:45:20', 5)    (1.3ms)  COMMIT<br>\n  (0.1ms)  BEGIN    (0.2ms)  UPDATE <code>member_users</code> SET <code>last_sign_in_at</code>\n  = '2012-11-03 11:45:20', <code>current_sign_in_at</code> = '2012-11-03 11:45:20', <code>last_sign_in_ip</code> = '127.0.0.1', <code>current_sign_in_ip</code> = '127.0.0.1',\n  <code>sign_in_count</code> = 1, <code>updated_at</code> = '2012-11-03 11:45:20' WHERE\n  <code>member_users</code>.<code>id</code> = 5    (0.2ms)  COMMIT    (0.1ms)  BEGIN<br>\n  (0.2ms)  UPDATE <code>member_addresses</code> SET <code>user_id</code> = NULL, <code>updated_at</code>\n  = '2012-11-03 11:45:20' WHERE <code>member_addresses</code>.<code>id</code> = 5    (0.2ms)  COMMIT</p>\n</blockquote>\n\n<p>The controller is a custom controller because I eventually (once I get this working), need to be able to redirect to 2 different places after registration depending where the customer logged in from (checkout or header in this case).</p>\n\n<pre><code>class Member::UsersController &lt; Devise::RegistrationsController\n  def create\n    super\n  end\n\n  def new\n    super\n  end\n\n  def edit\n    Rails.logger.debug { \"Editing the user\" }\n    super\n  end\n\n  def show\n    Rails.logger.debug { \"Showing the user controller\" }\n  end\nend\n</code></pre>\n\n<p>and from routes.rb</p>\n\n<pre><code>  devise_for :users, :class_name =&gt; \"Member::User\", :controllers =&gt; {:registrations =&gt; 'member/users', :sessions =&gt; 'member/sessions'}\n</code></pre>\n"},{"tags":["ruby-on-rails-3","gem","feed"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12028201,"title":"\"public_activity\" timelines /feed/log activity gem : how to do permanent saving of timelines?","body":"<p>when destroying one element from my database, the index view</p>\n\n<pre><code>      &lt;% for activity in @activities %&gt;\n\n      &lt;%= activity.text %&gt;  by  &lt;%= current_user.name %&gt; on &lt;%= Time.current%&gt; &lt;br/&gt;\n\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>no longer find the &lt;%=trackable.element_name%> from config/pba.yml</p>\n\n<pre><code>    activity:\n        element:\n              create: '  &lt;%=trackable.element_name%&gt; has been created '\n              update: '  &lt;%=trackable.element_name%&gt; has been edited '\n             destroy: '  &lt;%=trackable.element_name%&gt; has been removed '\n</code></pre>\n\n<p>and display something like:</p>\n\n<pre><code>    element1 has been edited by me on 2012-08-19 16:20:44 UTC\n  Template not defined by me on 2012-08-19 16:20:44 UTC \n</code></pre>\n\n<p>\"template not defined\" being the element i have just deleted....</p>\n\n<p>i would like to store the element name and the action that has been taken though...!? </p>\n"},{"tags":["ruby","ruby-on-rails-3","rubygems","soundcloud"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12323588,"title":"Using the genres filter on Soundcloud's Ruby API","body":"<p>I'm using the <a href=\"https://github.com/soundcloud/soundcloud-ruby\" rel=\"nofollow\">soundcloud gem</a> and it's not quite working as expected.</p>\n\n<p><code>client.get('/me/tracks')</code> returns all my tracks, like I'd expect.</p>\n\n<p><code>client.get('me/tracks', :genres =&gt; \"Jazz\")</code> returns 50 jazz tracks from various users.</p>\n\n<p>Obviously my goal is to get all of my tracks in the Jazz genre. Am I doing something wrong here or is there a bug? Thanks!</p>\n"},{"tags":["ruby-on-rails-3","jquery-ui","backbone.js"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13277948,"title":"Backbone.js and ActiveRecord","body":"<p>This is a Noob question regarding Backbone.JS and ActiveRecord.\nI'd be grateful for a pointer on how to debug this.</p>\n\n<p>I'm trying to use Backbone.Js code to create a \"Trainer\" object, which has a single attribute, \"name\" (a string).\nThe front end of the application is Ruby on Rails. There is a data migration for the Trainer table.</p>\n\n<p>In trainers controller:</p>\n\n<pre><code>def create\n  document = Trainer.create! params[:trainer]\n  render :json =&gt; document\nend\n</code></pre>\n\n<p>Now, in app/assets/javascripts/backbone/views/trainers/new_view.js:</p>\n\n<pre><code>Gym.Views.Trainers.NewView = Backbone.View.extend({\n  el : 'div.trainer_form',\n  template: JST['backbone/templates/trainers/new_template'],\n  model : new window.Gym.Models.Trainer({}),\n  initialize: function() {\n  this.document = this.options.user;\n  Backbone.Validation.bind(this, {\n    invalid: function(view, attr, error) {\n      $(\"form#new-trainer .errors ul\").append(\"&lt;li&gt;\" + error + \"&lt;/li&gt;\")\n    }\n  });\n  this.render();\n},\nrender : function() {\n\n  $(this.el).html(this.template({trainer:this.model.toJSON()}));\n  return this\n},\nevents : {\n  \"click input#submit_button\" : 'create_trainer'\n},\n\n\ncreate_trainer : function(event) {\n  event.preventDefault()\n  params = $(\"form#new-trainer\").formParams()\n  params['user_id'] = Gym.currentUser.userId\n  this.model.save(params, {success : function(model, response) {\n    Gym.trainers.add(model)\n    Objects.views.selectTrainer.render()\n\n    Gym.current_trainer = model\n\n    $(\"select#trainer_selector\").val(Gym.current_trainer.get('id'))\n\n    Objects.views.new_trainer.model = new Gym.Models.Trainer()\n    Objects.views.new_trainer.render()\n\n  }\n  });\n</code></pre>\n\n<p>Now, I can see in the Rails log that I'm getting to the controller:</p>\n\n<pre><code>Started POST \"/trainers\" ...\nProcessing by TrainersController#create as JSON\nParameters: {\"name\"=&gt;\"Lori Stevens\", \"user_id\"=&gt;1, \"trainer\"=&gt;{}}\n</code></pre>\n\n<p>However, when it gets to the SQL, I see this:</p>\n\n<pre><code>[1m^[[36mSQL (0.4ms)^[[0m  ^[[1mINSERT INTO `trainers` (`created_at`, `name`, `updated_at`, `user_id`) VALUES ('2012-11-07 20:33:09', NULL, '2012-11-07 20:33:09', NULL)^[[0m\n</code></pre>\n\n<p>The parameter 'name' - which comes from the template, and is the attribute of the Trainer object- is not getting to the database, even though the parameter \"name\" is set in the JSON.</p>\n\n<p>I'd appreciate a pointer on how to debug this - clearly I am not understanding how Backbone.js and ActiveRecord are connected.</p>\n"},{"tags":["ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":345,"score":1,"question_id":10572969,"title":"Rails simple_form pre-populated input values lost during server side form validation","body":"<p>I have a simple_form in my rails app that I want to pre-populate\nsome of the fields with URL parameters.</p>\n\n<p>Example URL is:</p>\n\n<pre><code>http://localhost:3000/surveys/new?phone=8675309\n</code></pre>\n\n<p>This pre-populate the phone field corretly using this code:</p>\n\n<pre><code>&lt;%= simple_form_for @survey, :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n&lt;%= f.input :state, :required =&gt; true %&gt;\n&lt;%= f.input :zip, :required =&gt; true %&gt;\n&lt;%= f.input :phone, :required =&gt; true, :input_html =&gt; { :value =&gt; params['phone'] } %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem is if the form is submitted without a required field\nthe form is reloaded but the phone input value is not retained.</p>\n\n<p>If the form is submitted without a value for zip\nthe reloaded page with validation errors in red URL is now:</p>\n\n<pre><code>http://localhost:3000/surveys\n</code></pre>\n\n<p>If, say, the state field is correct but no zip code the form is reloaded\nwith an error msg saying zip is required.</p>\n\n<p>The state value is retained however the phone is not.</p>\n\n<p>I guess it has to do with :value => params['phone'] in the f.input for the phone.</p>\n\n<p>Is there anyway I can populate the simple_form with URL paramenters\non it's initial load and have those value retained if the serverside validation fails?</p>\n\n<p>Many thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sinatra","resque"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":78,"score":1,"question_id":10435121,"title":"Resque error - /sinatra_adapter.rb:50:in `included': undefined method `before' for Sinatra::Request:Class (NoMethodError), when i start the rails app","body":"<p>I get error when I start the rails app. Just to give more information what I have done</p>\n\n<p>routes.rb has</p>\n\n<pre><code>mount Resque::Server, :at =&gt; \"/resque\"\nGemfile has \ngem 'rails', \"~&gt; 3.2.0\"\ngem 'resque', :require =&gt; 'resque/server'\n</code></pre>\n\n<p>when I start rails app I get this error</p>\n\n<pre><code>/usr/local/lib/ruby/gems/1.9.1/gems/authlogic-3.1.0/lib/authlogic/\ncontroller_adapters/sinatra_adapter.rb:50:in `included': undefined \nmethod `before' for Sinatra::Request:Class (NoMethodError)\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","web-applications","oauth","oauth-2.0"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13219308,"title":"How to implement a web widget with OAuth 2.0","body":"<p>I want to create a web widget that will display information from my site.</p>\n\n<p>The widget will be included in the client's website HTML using JavaScript, and should only be usable for my clients -- web sites that were registered at my site.</p>\n\n<p>The information in the widget should be specific to the user who is currently visiting the client's site.</p>\n\n<p>So, I need to authenticate both the client (website owner) and the resource owner (website visitor). This seems to map nicely to OAuth 2.0, but I couldn't find a complete example or explanation for such an implementation.</p>\n\n<p>Any resources or pointers to such information will be appreciated.</p>\n\n<p><strong>Update:</strong> I've stumbled upon <a href=\"http://supercollider.dk/2009/01/oauth-and-client-side-widgets-154\" rel=\"nofollow\">this article</a>, which provides an outline for an approach that uses OAuth. However, it is not detailed enough for me to really understand how to use this with OAuth 2.</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13226230,"title":"How can I tell rails where to look for a specific template?","body":"<p>I have an model called Purchase.rb. each purchase is created through a form as follows. </p>\n\n<pre><code>&lt;%= form_for(@purchase) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content, placeholder: \"Describe something you are interested in buying.\", :maxlength=&gt;\"254\" %&gt;\n    &lt;%= f.file_field :photo %&gt;\n\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>when they are created they are displayed with a partial stored in app/views/purchases/_purchase.html.erb. To add photos, I have put </p>\n\n<pre><code>&lt;%= form_for(@purchase) do |f| %&gt;\n    &lt;%= f.file_field :photo %&gt;\n    &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>in the purchase itself. I am using paperclip. So the idea is that people can click on a field that is part of the purchase and add a photo to the view. </p>\n\n<p>the error I get says </p>\n\n<pre><code>Missing template purchases/users#show, application/users#show with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"/home/alex/rails_projects/tradespring!/app/views\"\n</code></pre>\n\n<p>I want it to look at app/views/users#show, not app/views/purchases/users#show</p>\n\n<p>edit:</p>\n\n<p>here is the show action of the userscontroller:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n\n  def show\n    @user = User.find(params[:id])\n    @purchases= @user.purchases\n    @sales= @user.sales\n    @purchase=Purchase.new\n    @sale=Sale.new\n  end\n</code></pre>\n\n<p>and here is the routes.rb</p>\n\n<pre><code>Tradespring::Application.routes.draw do\n  resources :users do\n    resources :pcomments\n    resources :scomments\n  end\n  resources :sessions, only: [:new, :create, :destroy]\n  resources :purchases do\n    resources :pcomments\n  end\n  resources :sales do\n    resources :scomments\n  end\n\n  get \"static_pages/home\"\n\n  get \"static_pages/about\"\n\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new' \n  match '/about',   to: 'static_pages#about'\n  match '/signout', to: 'sessions#destroy', via: :delete\n\n  root to: 'static_pages#home'\n</code></pre>\n\n<p>finally, here is the what I want to happen when I submit the picture form. Im not 100% sure it should be under update. </p>\n\n<pre><code>class PurchasesController &lt; ApplicationController\n def update\n    @purchase = Purchase.find(params[:id])\n    if @purchase.update_attributes(params[:purchase])\n      flash[:success] = \"Picture added\"\n\n      redirect_to :back\n    else\n      render 'users/show'\n    end\n  end\n</code></pre>\n\n<p>also here is the app/views/user/show.html.erb</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;p&gt;\n&lt;%= mail_to(@user.email, name=\"email this user\", :encode =&gt; \"javascript\") %&gt;\n&lt;/p&gt;\n\n&lt;div id=\"purchases\"&gt;\n\n&lt;%= form_for(@purchase) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content, placeholder: \"Describe something you are interested in buying.\", :maxlength=&gt;\"254\" %&gt;\n    &lt;%= f.file_field :photo %&gt;\n    &lt;p1&gt; Note: There is a 254 character limit. Be sure to include useful information such as product specifications, how much you are willing to pay, and shipping info (where you live, if you want to pick it up locally, ect.). Further detail is best left to email.&lt;/p1&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n\n&lt;% if @user.purchases.any? %&gt;\n      &lt;h3&gt;Purchases (&lt;%= @user.purchases.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"purchases\"&gt;\n        &lt;%= render @purchases %&gt;\n      &lt;/ol&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n\n\n&lt;div id=\"sales\"&gt;\n\n&lt;%= form_for(@sale) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content, placeholder: \"Describe something you are interested in selling.\", :maxlength=&gt;\"254\" %&gt;\n    &lt;p1&gt; Note: There is a 254 character limit. Be sure to include useful information such as product specifications, price, payment methods accepted, and shipping info (where you live, if you are willing to ship it, ect.). Further detail is best left to email. &lt;/p1&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n\n&lt;% if @user.sales.any? %&gt;\n      &lt;h3&gt;Sales (&lt;%= @user.sales.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"sales\"&gt;\n        &lt;%= render @sales %&gt;\n      &lt;/ol&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13284726,"title":"How to perform sum and avg on few columns in rails","body":"<p>foo, foo_bar are expressed as ActiveModel classes</p>\n\n<pre><code>create table foo (id, captured_date)\ncreate table foo_bars (id, foo_id, val1, val2)\n\ninsert into foo (1, '2012-11-01')\ninsert into foo (2, '2012-11-02')\n\ninsert into foo_bars (1, 1, 1, 1)\ninsert into foo_bars (1, 1, 2, 2)\ninsert into foo_bars (1, 2, 3, 3)\ninsert into foo_bars (1, 2, 4, 4)\n</code></pre>\n\n<p>I am expected to show the following in a table (date, sum(val1), avg(val2))</p>\n\n<pre><code>2012-11-01 3 1.5\n2012-11-02 7 3.5\n_________________\n           10 2.5\n_________________\n</code></pre>\n\n<p>The above is sum(val1), avg(val2) across dates</p>\n\n<p>What would be the easiest way to achieve this using AR queries in your view. How should my view code look like and what queries should I use.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13283367,"title":"Rails, how do load another page directly to a dashboard","body":"<p>i have a page call /informations which i want to load into my main /home page inside one of my div.</p>\n\n<p>i tried doing render :template, but i need to declare all the variables again in my home controller, is there anyway that i can do it, so that it does not only loads the view, it also loads the informations controller then the view.</p>\n\n<p>one method that i am using is link_to remote, then jquery div.html. but this is on click event and seems hackish to me, is there a proper way?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13284077,"title":"Rails railties gem error \"undefined method: 'less'\"","body":"<p>I've just recently updated my rails app's gems with <code>gem update</code> and <code>bundle update</code>. When I tried to test it out with <code>rails s</code> it gives me this error:</p>\n\n<p><code>/Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/railtie/configuration.rb:85:in</code>method_missing': undefined method <code>less' for #&lt;Rails::Application::Configuration:0x0000010308a300&gt; (NoMethodError)</code></p>\n\n<p>The rest of the error message goes like this:</p>\n\n<pre><code>from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/twitter-bootstrap-rails-2.1.6/lib/twitter/bootstrap/rails/engine.rb:15:in `block in &lt;class:Engine&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /Users/Richard/Code/Rails/rgsimms/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:4:in `require'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:4:in `block in &lt;main&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:1:in `new'\n    from /Users/Richard/Code/Rails/rgsimms/config.ru:1:in `&lt;main&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/server.rb:46:in `app'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands/server.rb:70:in `start'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:50:in `tap'\n    from /Users/Richard/.rvm/gems/ruby-1.9.2-p318/gems/railties-3.2.3/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Is this an error with the Twitter Bootstrap gem? I'm still learning so how would I get this fixed? Any help is awesome.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13283471,"title":"how to make looping days ruby on rails?","body":"<p>I have a code for looping days.this to make leaves. I want column signin and signout on attendance will filling automatically start at startdate and end at enddate. </p>\n\n<pre><code>**exp I input :**\nstartdate: 2012-11-08 01:30:00\nenddate: 2012-11-10 01:30:00\n**i want output like this:** \n\n2012-11-08 01:30:00\n2012-11-09 01:30:00\n2012-11-010 01:30:00\n\n for i in 0..((@leafe.enddate - @leafe.startdate).to_i)\n                 @attendance = Attendance.new\n\n                 @attendance.signin = '2012-11-08 01:30:00' #value must change automatically\n                 @attendance.signout = '2012-11-08 10:30:00'#value must change automatically\n                 @attendance.user_id = @leafe.user_id\n                 @attendance.save\n            end\n</code></pre>\n\n<p>for your answer i say thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":332,"score":0,"question_id":6180882,"title":"Delayed_job suddenly doesn't seem to do anything?","body":"<p>I have a scraper set up to use delayed_job so that it runs in the background.</p>\n\n<pre><code>class Scraper\n  def do_scrape\n    # do some scraping stuff\n  end\n  handle_asynchronously :do_scrape\nend\n</code></pre>\n\n<p>Now I can comment out the <code>handle_asynchronously</code> line, open the console and run the scraper just fine. It does exactly what I expect it to do.</p>\n\n<p>However, when I try to fire the scrape as a delayed job, it doesn't seem to do anything at all. Further to that, it doesn't seem to log anything important either.</p>\n\n<p>Here's how my log looks from enqueueing a job to running <code>rake jobs:work</code>.</p>\n\n<pre><code>County Load (1.0ms)  SELECT \"counties\".* FROM \"counties\" WHERE \"counties\".\"name\" = 'Fermanagh' LIMIT 1\n   (0.1ms)  BEGIN\n  SQL (20.5ms)  INSERT INTO \"delayed_jobs\" (\"attempts\", \"created_at\", \"failed_at\", \"handler\", \"last_error\", \"locked_at\", \"locked_by\", \"priority\", \"run_at\", \"updated_at\") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING \"id\"  [[\"attempts\", 0], [\"created_at\", Mon, 30 May 2011 21:19:25 UTC +00:00], [\"failed_at\", nil], [\"handler\", \"--- \n\n# serialized object omitted for conciseness\n\nnmethod_name: :refresh_listings_in_the_county_without_delay\\nargs: []\\n\\n\"], [\"last_error\", nil], [\"locked_at\", nil], [\"locked_by\", nil], [\"priority\", 0], [\"run_at\", Mon, 30 May 2011 21:19:25 UTC +00:00], [\"updated_at\", Mon, 30 May 2011 21:19:25 UTC +00:00]]\n   (0.9ms)  COMMIT\n  Delayed::Backend::ActiveRecord::Job Load (0.4ms)  SELECT \"delayed_jobs\".* FROM \"delayed_jobs\" WHERE (locked_by = 'host:David-Tuites-MacBook-Pro.local pid:7743' AND locked_at &gt; '2011-05-30 17:19:32.116511') LIMIT 1\n   (0.1ms)  BEGIN\n  SQL (0.3ms)  DELETE FROM \"delayed_jobs\" WHERE \"delayed_jobs\".\"id\" = $1  [[\"id\", 42]]\n   (0.4ms)  COMMIT\n</code></pre>\n\n<p>As you can see, it seems to just inset a job and then delete it straight away? This scraping method should take at least a few minutes.</p>\n\n<p>The worst part is, it was working perfectly last night and I can't think of a single thing I'm doing differently. I tried fixing the gem to a previous version incase it was updated recently but doesn't seem to have fixed the problem.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13282900,"title":"Active Record validation :length error msg to show actual length?","body":"<p>I have a class that I am using a the validates method to check for length, and I want to inject the actual length into the error message. Is this possible?</p>\n\n<p>Here is my current class where I am using the validation:</p>\n\n<pre><code>class Something\n  validates :summary, :detail, :length =&gt; { \n    :in =&gt; 300..500,\n    :too_short =&gt; \"must have at least %{count} letters\",\n    :too_long =&gt; \"must have at most %{count} letters\"\n  }\n</code></pre>\n\n<p>And the error message shows:</p>\n\n<pre><code>2 errors prohibited this job from being saved.\n\nSummary must have at least 300 letters\nDetail must have at least 300 letters\n</code></pre>\n\n<p>But I'd like to show:</p>\n\n<pre><code>...\nSummary is only 250 letters and must have at least 300 letters\n...\n</code></pre>\n"},{"tags":["ruby-on-rails-3","tinymce","asset-pipeline","precompile"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":97,"score":3,"question_id":13055922,"title":"assets:precompile - permission denied - only on one computer","body":"<p>I have a rails app project folder which is on my dropbox folder.</p>\n\n<p>I work on 2 computers - home pc and a laptop (both win 7)</p>\n\n<p>If I do <code>bundle exec rake assets:precompile</code> on the pc it works fine and I see the line</p>\n\n<pre><code>C:/Ruby193/bin/ruby.exe C:/Ruby193/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets\nmkdir -p H:/My Dropbox/project/public/assets\ncp -r C:/Ruby193/lib/ruby/gems/1.9.1/gems/tinymce-rails-3.5.7.1/vendor/assets/javascripts/tinymce H:/My Dropbox/project/public/assets\n</code></pre>\n\n<p>but on the laptop I get persmission denied on one of the tinymce files and the precompilation fails..</p>\n\n<p>the app folder has permissions for everyone.. \nAny ideas why this could happen?</p>\n\n<p>Update:</p>\n\n<p>It seems it stops on files randomly.. not necessarily tinymce.\nI've set all ruby files and project file to have permissions to everyone (win 7) and set all that was read only to not be that.</p>\n\n<p>this is very frustrating</p>\n\n<p>an example of a --trace output. note that everytime I run assets:precompile it stops at a different file. this time it stopped on one of my icons</p>\n\n<pre><code>H:\\My Dropbox\\project&gt;bundle exec rake assets:precompile --trace\n** Invoke assets:precompile (first_time)\n** Execute assets:precompile\nC:/Ruby193/bin/ruby.exe C:/Ruby193/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace\n** Invoke assets:precompile:all (first_time)\n** Execute assets:precompile:all\n** Invoke assets:precompile:primary (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:primary\nrake aborted!\nPermission denied - H:/My Dropbox/project/public/assets/Icons/ArrowDown-335eb652931bdc13061ad1745a25556f.jpg\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/static_asset.rb:47:in `utime'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/static_asset.rb:47:in `write_to'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:41:in `block in write_asset'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:38:in `tap'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:38:in `write_asset'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:24:in `block in compile'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:212:in `block in each_logical_path'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:200:in `block (2 levels) in each_file'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in `each'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in `each_entry'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:198:in `block in each_file'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each_file'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/sprockets-2.1.3/lib/sprockets/base.rb:210:in `each_logical_path'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:18:in `compile'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/assets.rake:56:in `internal_precompile'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/assets.rake:70:in `block (3 levels) in &lt;top (required)&gt;'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `call'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `block in execute'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `each'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `execute'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:158:in `block in invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:151:in `invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:144:in `invoke'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/assets.rake:60:in `block (3 levels) in &lt;top (required)&gt;'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `call'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `block in execute'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `each'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `execute'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:158:in `block in invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:151:in `invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:144:in `invoke'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:116:in `invoke_task'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `block (2 levels) in top_level'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `each'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `block in top_level'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:88:in `top_level'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:66:in `block in run'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:63:in `run'\nC:/Ruby193/bin/rake:32:in `&lt;main&gt;'\nTasks: TOP =&gt; assets:precompile:primary\nrake aborted!\nCommand failed with status (1): [C:/Ruby193/bin/ruby.exe C:/Ruby193/bin/rak...]\nC:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:53:in `block in create_shell_runner'\nC:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:45:in `call'\nC:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:45:in `sh'\nC:/Ruby193/lib/ruby/1.9.1/rake/file_utils_ext.rb:39:in `sh'\nC:/Ruby193/lib/ruby/1.9.1/rake/file_utils.rb:80:in `ruby'\nC:/Ruby193/lib/ruby/1.9.1/rake/file_utils_ext.rb:39:in `ruby'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/assets.rake:12:in `ruby_rake_task'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task'\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/sprockets/assets.rake:29:in `block (2 levels) in &lt;top (required)&gt;'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `call'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:205:in `block in execute'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `each'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:200:in `execute'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:158:in `block in invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:151:in `invoke_with_call_chain'\nC:/Ruby193/lib/ruby/1.9.1/rake/task.rb:144:in `invoke'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:116:in `invoke_task'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `block (2 levels) in top_level'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `each'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:94:in `block in top_level'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:88:in `top_level'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:66:in `block in run'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:133:in `standard_exception_handling'\nC:/Ruby193/lib/ruby/1.9.1/rake/application.rb:63:in `run'\nC:/Ruby193/bin/rake:32:in `&lt;main&gt;'\nTasks: TOP =&gt; assets:precompile\n</code></pre>\n"},{"tags":["jquery","ajax","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13283205,"title":"ajax:success callback doesn't work in rails","body":"<p>I have a small form on the page that looks like</p>\n\n<pre><code>&lt;div id=\"updater\"&gt;\n    &lt;%= form_for current_user,:remote=&gt;true do |f| %&gt;\n        please update your &lt;%= f.label @field %&gt;: \n        &lt;%= f.text_field @field %&gt;\n        &lt;%= f.submit %&gt;\n      &lt;% end %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p>This triggers the Users#update which has <code>respond_to format.js</code></p>\n\n<p>update.js.erb is</p>\n\n<pre><code>$(\"#updater\").bind(\"ajax:success\", function(xhr, data, status) {\n    $(\"#updater\").remove();\n});\n</code></pre>\n\n<p>so the form will disappear once the the field has been updated</p>\n\n<p>I see that the JS is sent on the network tab on the chrome inspect thingy and the field does update in the DB. yet the #updater doesn't disappear, not if I add <code>alert(\"updater\");</code> I don't see the alert.</p>\n\n<p>Am I not catching the ajax:success correctly?</p>\n"},{"tags":["ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":42,"score":-3,"question_id":13222735,"title":"why does this cucumber code fail","body":"<p>I have this code : <a href=\"https://github.com/roelof1967/tamara\" rel=\"nofollow\">https://github.com/roelof1967/tamara</a>\nBut when I do cucumber it fails with this error message : <a href=\"https://gist.github.com/4008123\" rel=\"nofollow\">https://gist.github.com/4008123</a></p>\n\n<p>Can anyone explain to me what's wrong with my code?</p>\n\n<p>Roelof</p>\n\n<p>Edit 1:\nCode that fails:</p>\n\n<pre><code>class Output  \ndef messages    \n   @messages ||= []  \nend    \ndef puts(message)    \n    messages &lt;&lt; message  \nend    \ndef output    \n   @output ||= Output.new  \nend\nend\n\nWhen /^he logs in$/ do   \n   visit(\"/users/sign_in\")  \n   fill_in('Email', :with =&gt; @user.email)  \n   fill_in('Password', :with =&gt; @user.password)  \n   click_button('Sign in')\nend\n\nThen /^he should see \"(.*?)\"$/ do |message|  \n  @output.messages.should include (message)\nend\n</code></pre>\n\n<p>And here is the error message :</p>\n\n<pre><code>undefined method `[]' for nil:NilClass NoMethodError)      \n./features/step_definitions/login_steps.rb:6:in `/^he logs in$/'          \nfeatures/login.feature:5:in `When he logs in'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","delayed-job","worker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13281799,"title":"Heroku Delayed Job error","body":"<p>Google wasn't very helpful on this one, so I was hoping someone here might have an idea.</p>\n\n<p>My app works fine on server (and was recently working fine on heroku), but an hour or so ago, when I went to open a certain page on it (one that involves displaying information that is affected by a delayed_job I have running), I got a heroku error, and the logs say (among many other things):</p>\n\n<pre><code>dyno=web.1 queue=0 wait=5ms service=119ms status=500 bytes=643\n2012-11-07T23:17:44+00:00 app[worker.1]:    (1.3ms)  SELECT COUNT(*) AS count_all, priority AS priority FROM \"delayed_jobs\" WHERE (run_at &lt; '2012-11-07 23:17:44.830238' and failed_at is NULL) GROUP BY priority\n2012-11-07T23:17:44+00:00 app[worker.1]:    (2.5ms)  SELECT COUNT(*) FROM \"delayed_jobs\" WHERE (failed_at is not NULL)\n2012-11-07T23:17:44+00:00 app[worker.1]:    (1.2ms)  SELECT COUNT(*) FROM \"delayed_jobs\" WHERE (locked_by is not NULL)\n</code></pre>\n\n<p>Obviously, a problem with the delayed_job, but I'm not sure where to start looking, particularly considering how it was working before and still functions on my server. </p>\n\n<p>Any ideas what the problem is or how to start debugging?</p>\n"},{"tags":["ruby-on-rails-3","forms","associations","nested-attributes","fields-for"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13282543,"title":"Using nested attributes to easily select associations in a form","body":"<p>I am trying to create a nested attribute form to create a model which is primarily an association \"connector\" between two other models. In my case, the models represent <code>books</code>, <code>awards</code>, and the \"connector\" model <code>book_awards</code>. When I am editing a book, I want to be able to quickly select which awards it has won.</p>\n\n<p>I've been using \n<a href=\"http://railscasts.com/episodes/196-nested-model-form-part-1\" rel=\"nofollow\">http://railscasts.com/episodes/196-nested-model-form-part-1</a>\n to help me get started, but I'm afraid I'm pretty much stuck.</p>\n\n<p>Another SO question which seems similar is\n<a href=\"http://stackoverflow.com/questions/3579924/accepts-nested-attributes-for-with-find-or-create/\">accepts_nested_attributes_for with find_or_create?</a> Unfortunately, it's also not quite what I'm doing and I haven't been able to adapt it.</p>\n\n<p>My models look like this. Each model has additional attributes and validations etc, but I've removed them for clarity.</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n  has_many :book_awards\n  accepts_nested_attributes_for :book_awards, :allow_destroy =&gt; true\nend\n\nclass Award &lt; ActiveRecord::Base\n  has_many :book_awards\nend\n\nclass BookAward &lt; ActiveRecord::Base\n  belongs_to :book, :award\nend\n</code></pre>\n\n<p>In my book controller methods for edit and new, and the failure cases for create and update I have a line <code>@awards = Award.all</code>.</p>\n\n<p>In my view, I would like to see a list of all awards with check boxes next to them. When I submit, I would like to either <em>update, create, or destroy</em> a <code>book_award</code> model. If the check box is selected, I would like to update an existing model or create a new one if it doesn't exist. If the check box isn't selected, then I would like to destroy an existing model or do nothing if the award never existed. I have a partial for <code>book_awards</code>. I'm not sure if the check box selector should be in this partial or not.</p>\n\n<p>I think my check box will be my hook to <code>:_destroy</code> but with its polarity reversed. I think something like this will basically do it:</p>\n\n<pre><code>= f.check_box :_destroy, {}, 0, 1\n</code></pre>\n\n<p>Currently, I have this in my partial but I'm not sure where it really belongs.</p>\n\n<p>Next comes my view which currently doesn't work, but maybe it will help demonstrate what I'm trying to do. I loop through the <code>awards</code> and use a <code>fields_for</code> to set nested attributes for anything that already exists. It's horribly ugly, but I think it somewhat works. However, I don't really know how to get started with the else case.</p>\n\n<pre><code>= f.label :awards\n- @awards.each do |a|\n  - if f.object.awards &amp;&amp; f.object.awards.include?(a)\n    = f.fields_for :book_awards, f.object.book_award.select{|bas| bas.award == a } do |ba|\n      = render 'book_awards', :f =&gt; ba, :a =&gt; a\n  - else\n    = fields_for :book_awards do |ba|\n      = render 'book_awards', :f =&gt; ba, :a =&gt; a\n</code></pre>\n\n<p>I would prefer the awards to be listed in the same order each time (my <code>@awards</code> assignment in the controller will probably specify the order) as opposed to listing the existing awards first or last.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13282445,"title":"Creating a secondary delete option","body":"<p>I've create a table that gets populated with status_updates by the user over time. Each status can be deleted individually. </p>\n\n<p>This is accomplished by calling the destroy method in the status_update_controller and having the particular status_update identified in a private method called correct_user.</p>\n\n<p>So basically it looks like this:</p>\n\n<p>At the top of my status_update_controller</p>\n\n<pre><code>before_filter :correct_user, only: :destroy\n</code></pre>\n\n<p>The destroy method</p>\n\n<pre><code>def destroy\n    @status_update.destroy\n    redirect_to root_url\nend    \n</code></pre>\n\n<p>and the private correct user method</p>\n\n<pre><code>private\n\n    def correct_user\n      @status_update = current_user.status_update.find_by_id(params[:id])\n      redirect_to root_url if @status_update.nil?\n    end  \n</code></pre>\n\n<hr>\n\n<p>My question is this:</p>\n\n<p>How can I select all of the status_updates for a particular user and destroy them using a button or link? </p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","search"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12943918,"title":"Text Link to results page with search parameters passed in Rails","body":"<p>In my database is a column named \"<strong>startDate</strong>\". An example of a stored startDate is <strong>2000-01-01 12:01:01.000000</strong>. (This date is different than the Created_at or modified_at dates. It would be the date of when the event mentioned in this view's show.html.erb occurred.)</p>\n\n<p>In a show view for an article, I would like to link to a results (index) page where similar microposts would be displayed. I am not sure how to do this.</p>\n\n<p>The text with links may say something like:</p>\n\n<blockquote>\n  <p>There are 17 events within 10 days before or after the date Wednesday\n  October 17th, 2009.</p>\n</blockquote>\n\n<p>The words \"<strong>17 events</strong>\" would be a link to a results page. The span of the search in this particular example would be <strong>20 days</strong> in total with <strong>10 days</strong> before <strong>Wednesday October 17th, 2009</strong>, and <strong>10 days after</strong>.</p>\n\n<p>this is my current show.html.erb page.</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n  &lt;div class=\"span2\"&gt;&lt;center&gt;&lt;img src=&lt;%= @micropost.imageURL %&gt; class=\"img-polaroid\"&gt;&lt;/center&gt;&lt;/div&gt;\n\n  &lt;div class=\"span7\"&gt;\n        &lt;h3&gt;&lt;%= @micropost.title %&gt;&lt;/h3&gt;&lt;br&gt;\n        &lt;p&gt;&lt;small&gt;&lt;%= @micropost.loc1T %&gt;&lt;br&gt;\n            &lt;%= @micropost.startTime.strftime('%A, %B %d, %Y') %&gt;&lt;/small&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;%= raw @micropost.content %&gt;&lt;/p&gt;\n    &lt;/div&gt;\n\n  &lt;div class=\"span3\"&gt;&lt;img src=\"http://placehold.it/210x210\" class=\"img-polaroid\"&gt;&lt;br&gt;\n    &lt;small&gt;advertisment&lt;/small&gt;\n    &lt;div class=\"divider\"&gt;&amp;nbsp;&lt;/div&gt;\n    &lt;div class=\"well\"&gt;\n\n    &lt;p&gt;There are &lt;%= link_to(pluralize(\"event\", @microposts.count), \"#{microposts_path} related=#{@micropost.id}\") %&gt; within 10 days...&lt;/p&gt;\n\n\n  &lt;/div&gt;\n\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>models/micropost.rb</p>\n\n<pre><code>class Micropost &lt; ActiveRecord::Base\n  attr_accessible :content, :title,:keyword,:privacy,:groups,:loc1T,:latitude,:longitude,:loc2T,:loc2Lat,:loc2Lon,:startTime,:endTime,:imageURL\n  geocoded_by :loc1T\n  after_validation :geocode#, :if =&gt; :address_changed?\n\n\n  belongs_to :user\n\n  validates :user_id, presence: true\n  validates :title, presence: true\n  validates :keyword, presence: true\n  validates :privacy, presence: true\n  validates :groups, presence: true\n  validates :loc1T, presence: true\n  validates :latitude, presence: true\n  validates :longitude, presence: true\n  validates :loc2T, presence: true\n  validates :loc2Lat, presence: true\n  validates :loc2Lon, presence: true\n  validates :startTime, presence: true\n  validates :endTime, presence: true\n  validates :imageURL, presence: true\n\n  validates :content, presence: true\n\n  default_scope order: 'microposts.created_at DESC'\n\n  def self.from_users_followed_by(user)\n    followed_user_ids = \"SELECT followed_id FROM relationships\n                         WHERE follower_id = :user_id\"\n    where(\"user_id IN (#{followed_user_ids}) OR user_id = :user_id\", \n          user_id: user.id)\n  end\n\n  def related_microposts(this_startTime)\n  @microposts.where('startTime &gt; ? AND startTime &lt; ?', 5.days.since(startTime), 5.days.until(startTime))\n  end\nend\n</code></pre>\n\n<p>microposts_controller.rb</p>\n\n<pre><code>class MicropostsController &lt; ApplicationController\n  before_filter :signed_in_user, only: [:create, :destroy]\n  before_filter :correct_user,   only: :destroy\n\n  def index\n  end\n\n   def show\n    @micropost = Micropost.find(params[:id])\n  end\n\n  def related_microposts(this_startDdate)\n  Micropost.where('startDate &gt; ? AND startDate &lt; ?', 5.days.since(this_startDate), 5.days.until(this_startDate))\n  end\n\n  def create\n    @micropost = current_user.microposts.build(params[:micropost])\n    if @micropost.save\n      flash[:success] = \"Micropost created!\"\n      redirect_to root_url\n    else\n      @feed_items = []\n      render 'static_pages/home'\n    end\n  end\n\n  def destroy\n    @micropost.destroy\n    redirect_to root_url\n  end\n\n  private\n\n    def correct_user\n      @micropost = current_user.microposts.find_by_id(params[:id])\n      redirect_to root_url if @micropost.nil?\n    end\nend\n</code></pre>\n\n<p>this is a screenshot of the database columns...</p>\n\n<p><img src=\"http://i.stack.imgur.com/2ySpi.jpg\" alt=\"DB Screenshot\"></p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13219201,"title":"I woud like to tag my posts, using javascript and json","body":"<p>I am trying to generate a tagging system similar to SO. I am using the Select2 gem. When the user initially goes to the new page the form should only display their tags. When on the page they can create new tags by typing out tag names and separating them by spaces or commas. </p>\n\n<p>My issues is that when I go to submit this form, the tags are not properly linking to an ID. I get the error \"Couldn't find Tag with id = 0\" or if I have the number 12 as the tag, \"Couldn't find Tag with id = 12\"</p>\n\n<p>A user has_many tags; a post has many taggings; a post has many tags through taggings; a tag has many taggings; a tag has many posts through taggings; a tag belongs to an user</p>\n\n<p>How could I specify the tag id name and only have the tag name show up?</p>\n\n<p>My Tags Controller looks like this</p>\n\n<pre><code>  respond_to :json\n  def index\n    @tags = current_user.tags\n    respond_with(@tags.map{|tag| {:id =&gt; tag.id, :name =&gt; tag.name, :user_id =&gt; tag.user_id} })\n  end\n</code></pre>\n\n<p>My JavaScript looks like this</p>\n\n<pre><code>var items = [];\n$.getJSON('http://localhost:3000/tags.json', function(data) {\n        $.each(data, function(i, obj) {\n             return items.push(obj.name);\n        });\n   $(\"#post_tag_ids\").select2({\n        tags: items,\n        tokenSeparators: [\",\", \" \"]\n        });\n   });\n</code></pre>\n\n<p>My form looks like this</p>\n\n<pre><code>= semantic_form_for([@user, @post], :html =&gt; { :class =&gt; 'form-horizontal' }) do |f|\n  = f.inputs do\n    = f.input :summary, :label =&gt; false, :placeholder =&gt; \"Title\"\n    = f.input :tag_ids, :as =&gt; :string, :label =&gt; false, :placeholder =&gt; \"Tags\", input_html: {:id =&gt; \"post_tag_ids\", :cols =&gt; 71}\n  = f.buttons do\n    .action\n  = f.commit_button :button_html =&gt; { :class =&gt; \"btn btn-primary\" }\n</code></pre>\n\n<p>My Post Controller looks a little like this</p>\n\n<pre><code>def create\n @post = Post.new(params[:post])\n @post.user = current_user\n @post.save\n @post.tag!(params[:tag_ids], current_user.id)\nend\n</code></pre>\n\n<p>My Post Model has a tag! method</p>\n\n<pre><code>def tag!(tags, user)\n  tags = tags.split(\",\").map do |tag|\n    Tag.find_or_create_by_name_and_user_id(tag, user)\n  end\nself.tags &lt;&lt; tags\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","jquery-ajax","unobtrusive-javascript"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13272778,"title":":remote => true/data-remote on a form loaded via ajax","body":"<p>In my Rails app, I have a form that is loaded via Ajax using jQuery load method.</p>\n\n<pre><code>function load_sales_form(product_id) {\n    $(\"#sales_form\").load(\"&lt;%= url_for(:action =&gt; :show_sales_form) %&gt;\"/ + product_id);\n}\n</code></pre>\n\n<p>The loaded form has a form_for tag with the <strong>:remote => true</strong> option and it does add the <strong>data-remote=\"true\"</strong> attribute to the form.</p>\n\n<p>But the form isn't submitted using Ajax when the user clicks the submit tag button. It works fine if the form is loaded in the standard, non-ajax way, but it the form is loaded via ajax after the document is ready, is does not submit using ajax, it submits as a standard form.</p>\n\n<p>From what I studied so far, this happens because the rails.js file (which contains the stuff that allow data-remote forms to be submitted via ajax) does not apply it's features to html content loaded via ajax.</p>\n\n<p>Is it possible to force rails.js file to apply it's features to content loaded via Ajax?</p>\n"},{"tags":["ruby-on-rails-3","carrierwave","dup"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13282280,"title":"Duplicating a record with associated images using Carrierwave","body":"<p>I have an app which you can store order/invoices in.  I'm building a simple feature where you can duplicate invoices for my customers.  I wrote this method in my Order.rb model which: </p>\n\n<p>Takes the invoice, duplicates the associated lineitems, adds the new OrderID into them...and does the same for associated images. </p>\n\n<pre><code>def self.duplicate_it(invoice)\n  new_invoice = invoice.dup\n  new_invoice.save\n\n  invoice.lineitems.each do |l|\n    new_lineitem = l.dup\n    new_lineitem.order_id = new_invoice.id\n    new_lineitem.save\n  end\n\n  invoice.images.each do |i|\n    new_image = i.dup\n    new_image.order_id = new_invoice.id\n    new_image.save\n  end\n\n  return new_invoice\nend\n</code></pre>\n\n<p>Unfortunately, you can't just <code>.dup</code> the image because there's all this associate expiration stuff since I'm storing images on S3.  Is there a way to regenerate the image maybe using its image_url?</p>\n\n<p>The error I get when running this is below.  Which tells me not all the associated image information is dup'd correctly.</p>\n\n<pre><code>Showing /Users/bruceackerman/Dropbox/printavo/app/views/orders/_image-display.erb where line #3 raised:\n\nundefined method `content_type' for nil:NilClass\nExtracted source (around line #3):\n\n1:  &lt;% @order.images.each do |image| %&gt;\n2:      &lt;% if image.image &amp;&amp; image.image.file %&gt;\n3:          &lt;% if image.image.file.content_type == \"application/pdf\" %&gt;\n4:              &lt;%= link_to image_tag(\"/images/app/pdf.jpg\", \n5:                      :class =&gt; 'invoice-image'),\n6:                  image.image_url, \n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13278259,"title":"Activerecord 3 eager load association and avoiding n+1 queries","body":"<p>I'm trying to run this query:</p>\n\n<pre><code>sprints = Sprint\n  .includes(:team)\n  .joins(:team)\n  .where(is_private: false)\n</code></pre>\n\n<p>Which work fine except for one thing, I would like to have only one query instead of what I got right now. The inner join is right <strong>but somehow it does one query for every team</strong> instead of using the data within the first query. I can not seem to figure out why.</p>\n\n<p>Here are my models:</p>\n\n<pre><code>class Sprint &lt; ActiveRecord::Base\n  extend FriendlyId\n  friendly_id :name, :use =&gt; :slugged\n  belongs_to :team\n\n\nclass Team &lt; ActiveRecord::Base\n  extend FriendlyId\n  friendly_id :name, :use =&gt; :slugged\n  attr_accessible :name, :timezone\n\n  has_many :sprints, :autosave =&gt; true, :dependent =&gt; :destroy\n</code></pre>\n\n<p>I've tried with or without joins or includes, the best I got so far is a nice inner join select on sprints followed by one select for every team I have. </p>\n\n<p>It looks like this in the log:</p>\n\n<pre><code>EXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"sprints\".\"id\" AS t0_r0, \"sprints\".\"name\" \nAS t0_r1, \"sprints\".\"start_date\" AS t0_r2, \"sprints\".\"duration\" AS t0_r3,\n\"sprints\".\"total_points\" AS t0_r4, \"sprints\".\"created_at\" AS t0_r5,\n\"sprints\".\"updated_at\" AS t0_r6, \"sprints\".\"slug\" AS t0_r7, \"sprints\".\"include_weekend\"\nAS t0_r8, \"sprints\".\"team_id\" AS t0_r9, \"sprints\".\"integration_id\" AS t0_r10,\n\"sprints\".\"type\" AS t0_r11, \"sprints\".\"is_private\" AS t0_r12, \"sprints\".\"note\" AS\nt0_r13, \"sprints\".\"last_sync_date\" AS t0_r14, \"teams\".\"id\" AS t1_r0, \"teams\".\"name\" AS\nt1_r1, \"teams\".\"slug\" AS t1_r2, \"teams\".\"timezone\" AS t1_r3, \"teams\".\"created_at\" AS\nt1_r4, \"teams\".\"updated_at\" AS t1_r5, \"teams\".\"integration_id\" AS t1_r6, \"teams\".\"type\"\nAS t1_r7 FROM \"sprints\" INNER JOIN \"teams\" ON \"teams\".\"id\" = \"sprints\".\"team_id\" WHERE\n\"sprints\".\"is_private\" = 'f'\n</code></pre>\n\n<p>And for the teams</p>\n\n<pre><code>EXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 27 LIMIT 1\nEXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 63 LIMIT 1\nEXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 142 LIMIT 1\nEXPLAIN (0.1ms)  EXPLAIN QUERY PLAN SELECT \"teams\".* FROM \"teams\" WHERE \"teams\".\"id\" = 315 LIMIT 1\n</code></pre>\n\n<p><br>\nIf I don't include the joins I get this query for the sprint:</p>\n\n<pre><code>SELECT \"sprints\".* FROM \"sprints\" WHERE \"sprints\".\"is_private\" = 'f'\n</code></pre>\n\n<p>and then get all queries for the teams.</p>\n\n<p>If I don't include the includes statement I get a normal inner join without the team in the select clause.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13281997,"title":"Rails posts scaffold not parsing html","body":"<p>I'm trying to learn rails, and am using my blog as an excuse to do so. </p>\n\n<p>Right now, I'm playing around with the posts scaffold. I get the MVC and the idea behind it, so I was about to recreate it, when I ran accross the following error. </p>\n\n<p>If I enter content like </p>\n\n<pre><code>text\ntext\ntext\n</code></pre>\n\n<p>in the 'content' tag of posts form, It displays all the text as one block. </p>\n\n<pre><code>text text text\n</code></pre>\n\n<p>I thought I could try doing something like</p>\n\n<pre><code>&lt;p&gt;text&lt;/p&gt;\n&lt;p&gt;text&lt;/p&gt;\n&lt;p&gt;text&lt;/p&gt;\n</code></pre>\n\n<p>but, it shows </p>\n\n<pre><code>&lt;p&gt;text&lt;/p&gt;&lt;p&gt;text&lt;/p&gt;&lt;p&gt;text&lt;/p&gt;\n</code></pre>\n\n<p>What I'd like Rails to do is to actually parse the html in content. What would I do to get that to happen?</p>\n\n<p>Here's the New Form Partial, which I used to submit the content</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n  &lt;% if @post.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt; prohibited this post from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @post.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :content %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :content %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here's the Posts Controller as a whole</p>\n\n<pre><code>class PostsController &lt; ApplicationController\n  # GET /posts\n  # GET /posts.json\n  def index\n    @posts = Post.paginate(page: params[:page])\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @posts }\n    end\n  end\n\n  # GET /posts/1\n  # GET /posts/1.json\n  def show\n    @post = Post.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @post }\n    end\n  end\n\n  # GET /posts/new\n  # GET /posts/new.json\n  def new\n    @post = Post.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @post }\n    end\n  end\n\n  # GET /posts/1/edit\n  def edit\n    @post = Post.find(params[:id])\n  end\n\n  # POST /posts\n  # POST /posts.json\n  def create\n    @post = Post.new(params[:post])\n\n    respond_to do |format|\n      if @post.save\n        format.html { redirect_to @post, notice: 'Post was successfully created.' }\n        format.json { render json: @post, status: :created, location: @post }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /posts/1\n  # PUT /posts/1.json\n  def update\n    @post = Post.find(params[:id])\n\n    respond_to do |format|\n      if @post.update_attributes(params[:post])\n        format.html { redirect_to @post, notice: 'Post was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /posts/1\n  # DELETE /posts/1.json\n  def destroy\n    @post = Post.find(params[:id])\n    @post.destroy\n\n    respond_to do |format|\n      format.html { redirect_to posts_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","session-timeout"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":9,"score":1,"question_id":13281973,"title":"Close session and redirect to login in Ruby on Rails","body":"<p>I am working with <code>session[:hash_name]</code> in ruby on rails to keep session information such as username and stuff.</p>\n\n<p>I am trying to find a way to expire this session without the using having to log out. Specially in two cases: after some time it needs to expire and when the user closes the browser.</p>\n\n<p>So far I have found <a href=\"http://www.tutorialspoint.com/ruby-on-rails/rails-session-cookies.htm\" rel=\"nofollow\">another</a> parameter called <code>cookies[:hash_name]</code> which can expire after some time. But I'm not sure how to check this parameter in every user request and then call reset_session. When the session is reset I need to redirect the user to the login page.</p>\n\n<p>Any suggestion to solve these 2 problems are greatly appreaciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13213911,"title":"Manifest.yml empty","body":"<p>Whenever I run <code>rake assets:precompile</code>, I get a <code>manifest.yml</code> file that looks like:</p>\n\n<pre><code>--- {}\n</code></pre>\n\n<p>Something must be going wrong. Here is my output for <code>rake assets:precompile --trace</code>:</p>\n\n<pre><code>** Invoke assets:precompile (first_time)\n** Execute assets:precompile\n/Users/user/.rvm/rubies/ruby-1.9.3-p194/bin/ruby /Users/user/.rvm/gems/ruby-1.9.3-p194@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace\n** Invoke assets:precompile:all (first_time)\n** Execute assets:precompile:all\n** Invoke assets:precompile:primary (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:primary\n** Invoke assets:precompile:nondigest (first_time)\n** Invoke assets:environment (first_time)\n** Execute assets:environment\n** Invoke tmp:cache:clear (first_time)\n** Execute tmp:cache:clear\n** Execute assets:precompile:nondigest\n</code></pre>\n\n<p>Can someone help?? Thanks!</p>\n\n<h2>UPDATE:</h2>\n\n<p>Feel free to look at my code at <a href=\"http://www.github.com/sambaek/novulty\" rel=\"nofollow\">www.github.com/sambaek/novulty</a></p>\n"}]}
{"total":34674,"page":2,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13280927,"title":"Ruby on Rails - continually looping through the new/create action with AJAX","body":"<p>I have a Rails controller set up that when a user creates a new record, it will redirect again to the new action and populate the form with new data, and this can continue on in a loop, creating a new record and getting redirected to the new action.  What I am having trouble with is adding AJAX to this so that the user can stay in this loop without the page reloading.  Here is my code without AJAX:</p>\n\n<pre><code>class ResponsesController\n def new\n   @response = Response.new\n   @answer_a = Answer.find(rand(1..100))\n   @answer_b = Answer.find(rand(1..100))\n   @answer_c = Answer.find(rand(1..100))\n end\n\n def create\n   @response = current_user.responses.build(params[:response])\n   if @response.save\n      respond_to do |format|\n        format.html { redirect_to new_response_path }\n        format.js\n      end\n   else\n      render 'new'\n   end\n end\nend\n</code></pre>\n\n<p><strong>new.html.erb</strong></p>\n\n<pre><code> &lt;div id=\"response_form\"&gt;\n   &lt;%= render 'form' %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code> &lt;%= form_for @response do |f| %&gt;   \n    &lt;%= f.radio_button :user_answer, @answer_a.id %&gt; \n    &lt;%= @answer_a.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_b.id %&gt; \n    &lt;%= @answer_b.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_c.id %&gt; \n    &lt;%= @answer_c.description %&gt;\n    &lt;%= f.submit \"Answer\" %&gt;                \n &lt;% end %&gt;\n</code></pre>\n\n<p>Below is my attempt to add AJAX.  However, it is going to the show action and doing an update.  How can I fix my code so that it keeps redirecting to the new action and the user can continue to create new records on an infinite loop?</p>\n\n<pre><code> def create\n   @answer_a = Answer.find(rand(1..100))\n   @answer_b = Answer.find(rand(1..100))\n   @answer_c = Answer.find(rand(1..100))\n   @response = current_user.responses.build(params[:response])\n   if @response.save\n      respond_to do |format|\n        format.html { redirect_to new_response_path }\n        format.js\n      end\n   else\n      render 'new'\n   end\n end\n</code></pre>\n\n<p><strong>_form.html.erb</strong></p>\n\n<pre><code> &lt;%= form_for @response, :remote =&gt; true do |f| %&gt;  \n    &lt;%= f.radio_button :user_answer, @answer_a.id %&gt; \n    &lt;%= @answer_a.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_b.id %&gt; \n    &lt;%= @answer_b.description %&gt;\n    &lt;%= f.radio_button :user_answer, @answer_c.id %&gt; \n    &lt;%= @answer_c.description %&gt;\n    &lt;%= f.submit \"Answer\" %&gt;                \n &lt;% end %&gt;\n</code></pre>\n\n<p><strong>create.js.erb</strong></p>\n\n<pre><code> $('#response_form').html('&lt;%= j render(\"form\") %&gt;');\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13280949,"title":"Rails append type to join table with has_many :through and association extensions","body":"<p>I have an AR association with extensions in Rails similar to the example presented in this link:\n<a href=\"http://railsadventures.wordpress.com/2012/08/28/activerecord-association-extensions/\" rel=\"nofollow\">ActiveRecord Association Extensions</a></p>\n\n<pre><code>has_many :issues, :through =&gt; :qbert_issues do\n  def tracking\n    where(\"qbert_issues.kind = ?\", \"tracking\")\n  end\n\n  def blocking\n    where(\"qbert_issues.kind = ?\", \"blocking\")\n  end\nend\n</code></pre>\n\n<p>As shown above, mine is multi-typed... I need to populate a 'kind' column in my join table.  Ideally, this should just work:</p>\n\n<pre><code>q = QBert.find(123)\nq.issues.tracking &lt;&lt; Issue.find(234)\n</code></pre>\n\n<p>So, what the article suggests is overloading <code>&lt;&lt;</code> and doing something like this:</p>\n\n<pre><code>has_many :issues, ... do\n  ...\n  def &lt;&lt;(issue)\n    issue.kind = \"UserAccount\"\n    proxy_association.owner.issues += [issue]\n  end\nend\n</code></pre>\n\n<p>Which would be nice, if kind was static.</p>\n\n<p>It looks like I can do this...</p>\n\n<pre><code>has_many :issues, ... do\n  ...\n  def &lt;&lt;(*args)\n    issue, kind = args.flatten\n    issue.kind = kind\n    proxy_association.owner.issues += [issue]\n  end\nend\n</code></pre>\n\n<p>Which would allow me to do this at the very least:</p>\n\n<pre><code>q = QBert.find(123)\nq.issues.tracking &lt;&lt; [Issue.find(234), :tracking]\n</code></pre>\n\n<p>That doesn't seem very DRY to me...is there a better way?  Bonus points if you take into account that the kind accessor is off a join table <code>qbert_issues</code>.  I'm guessing I just have to add the association manually through the <code>QBertIssue</code> model directly. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13280386,"title":"friendly SEO urls with sunspot and rails 3","body":"<p>How can create SEO friendly url using using sunspot?</p>\n\n<p>I want to convert a search from this:</p>\n\n<pre><code>http://localhost:3000/restaurant?utf8=&amp;search=newyork\n</code></pre>\n\n<p>To something like this:</p>\n\n<pre><code>http://localhost:3000/restaurant/newyork\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","memcached","dalli"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13281488,"title":"uninitialized constant Dalli (NameError) in staging but not production","body":"<p>So I get a <code>uninitialized constant Dalli (NameError)</code> when I push my ruby on rails app to my staging on heroku, but it works fine in production. my <code>production.rb</code> and <code>staging.rb</code> files are the exact same except for a mailer host value. Could someone help? Thanks!</p>\n\n<p>production.rb:</p>\n\n<pre><code>Novulty::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Enable Rails's static asset server\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Compress CSS using yui-compressor gem\n  config.assets.css_compressor = :yui\n\n  # Compress JS using uglifier gem\n  config.assets.js_compressor = :uglifier\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  config.force_ssl = false\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  config.assets.precompile += %w[ *.js *.css ]\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = false\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n\n  # Use SMTP to send mail\n  config.action_mailer.delivery_method = :smtp\n\n  # Use Gmail to send smtp mail\n  config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"novulty.com\",\n    :user_name            =&gt; ENV[\"GMAIL_USERNAME\"],\n    :password             =&gt; ENV[\"GMAIL_PASSWORD\"],\n    :authentication       =&gt; :plain,\n    :enable_starttls_auto =&gt; true\n  }\n\n  # Specify what domain to use for mailer URLs\n  config.action_mailer.default_url_options = {\n    host: \"novulty.com\"\n  }\n\n  # Specify how long an item should stay cached by setting the Cache-Control headers\n  config.static_cache_control = \"public, max-age=2592000\"\n\n  # Specify Dalli as the storage backends for Rails’ built-in Rack::Cache integration\n  config.action_dispatch.rack_cache = {\n    :metastore    =&gt; Dalli::Client.new,\n    :entitystore  =&gt; 'file:tmp/cache/rack/body',\n    :allow_reload =&gt; false\n  }\nend\n</code></pre>\n\n<p>staging.rb:</p>\n\n<pre><code>Novulty::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Enable Rails's static asset server\n  config.serve_static_assets = true\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Compress CSS using yui-compressor gem\n  config.assets.css_compressor = :yui\n\n  # Compress JS using uglifier gem\n  config.assets.js_compressor = :uglifier\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  config.force_ssl = false\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  config.assets.precompile += %w[ *.js *.css ]\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.action_mailer.perform_deliveries = true\n  config.action_mailer.raise_delivery_errors = false\n  config.action_mailer.default :charset =&gt; \"utf-8\"\n\n  # Use SMTP to send mail\n  config.action_mailer.delivery_method = :smtp\n\n  # Use Gmail to send smtp mail\n  config.action_mailer.smtp_settings = {\n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :domain               =&gt; \"novulty.com\",\n    :user_name            =&gt; ENV[\"GMAIL_USERNAME\"],\n    :password             =&gt; ENV[\"GMAIL_PASSWORD\"],\n    :authentication       =&gt; :plain,\n    :enable_starttls_auto =&gt; true\n  }\n\n  # Specify what domain to use for mailer URLs\n  config.action_mailer.default_url_options = {\n    host: \"novultystaging.herokuapp.com\"\n  }\n\n  # Specify how long an item should stay cached by setting the Cache-Control headers\n  config.static_cache_control = \"public, max-age=2592000\"\n\n  # Specify Dalli as the storage backends for Rails’ built-in Rack::Cache integration\n  config.action_dispatch.rack_cache = {\n    :metastore    =&gt; Dalli::Client.new,\n    :entitystore  =&gt; 'file:tmp/cache/rack/body',\n    :allow_reload =&gt; false\n  }\nend\n</code></pre>\n\n<p>production.rb:</p>\n\n<pre><code>require File.expand_path('../boot', __FILE__)\n\nrequire 'rails/all'\n\nif defined?(Bundler)\n  # If you precompile assets before deploying to production, use this line\n  Bundler.require(*Rails.groups(:assets =&gt; %w(development test)))\n  # If you want your assets lazily compiled in production, use this line\n  # Bundler.require(:default, :assets, Rails.env)\nend\n\nmodule Novulty\n  class Application &lt; Rails::Application\n    # Settings in config/environments/* take precedence over those specified here.\n    # Application configuration should go into files in config/initializers\n    # -- all .rb files in that directory are automatically loaded.\n\n    # Custom directories with classes and modules you want to be autoloadable.\n    # config.autoload_paths += %W(#{config.root}/extras)\n\n    # Only load the plugins named here, in the order given (default is alphabetical).\n    # :all can be used as a placeholder for all plugins not explicitly named.\n    # config.plugins = [ :exception_notification, :ssl_requirement, :all ]\n\n    # Activate observers that should always be running.\n    # config.active_record.observers = :cacher, :garbage_collector, :forum_observer\n\n    # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.\n    # Run \"rake -D time\" for a list of tasks for finding time zone names. Default is UTC.\n    # config.time_zone = 'Central Time (US &amp; Canada)'\n\n    # Use dalli cache store in production\n    config.cache_store = :dalli_store\n\n    # The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.\n    # config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]\n    # config.i18n.default_locale = :de\n\n    # Add Font-Awesome support (add app/assets/font to the asset path)\n    config.assets.paths &lt;&lt; Rails.root.join(\"app\", \"assets\", \"fonts\")\n\n    # Configure the default encoding used in templates for Ruby 1.9.\n    config.encoding = \"utf-8\"\n\n    # Configure sensitive parameters which will be filtered from the log file.\n    config.filter_parameters += [:password]\n\n    # Enable escaping HTML in JSON.\n    config.active_support.escape_html_entities_in_json = true\n\n    # Use SQL instead of Active Record's schema dumper when creating the database.\n    # This is necessary if your schema can't be completely dumped by the schema dumper,\n    # like if you have constraints or database-specific column types\n    # config.active_record.schema_format = :sql\n\n    # Enforce whitelist mode for mass assignment.\n    # This will create an empty whitelist of attributes available for mass-assignment for all models\n    # in your app. As such, your models will need to explicitly whitelist or blacklist accessible\n    # parameters by using an attr_accessible or attr_protected declaration.\n    config.active_record.whitelist_attributes = true\n\n    # Enable the asset pipeline\n    config.assets.enabled = true\n\n    # Version of your assets, change this if you want to expire all your assets\n    config.assets.version = '1.0'\n\n    config.assets.initialize_on_precompile = false\n  end\nend\n</code></pre>\n\n<p>Here is the output of <code>heroku logs --tail --remote staging</code>:</p>\n\n<pre><code>2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:571:in `block in &lt;class:Engine&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n2012-11-08T02:04:59+00:00 app[web.1]: /app/config/environments/staging.rb:96:in `block in &lt;top (required)&gt;': uninitialized constant Dalli (NameError)\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:24:in `class_eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:24:in `configure'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config/environments/staging.rb:1:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:4:in `require'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from script/rails:6:in `require'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n2012-11-08T02:04:59+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n2012-11-08T02:04:59+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Feel free to check out my code at <a href=\"http://www.github.com/sambaek/novulty\" rel=\"nofollow\">www.github.com/sambaek/novulty</a></p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-ui","heroku","modal"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13281514,"title":"My Rails App works on localhost but not on Heroku","body":"<p>I'm new to rails and currently I have a working Rails App which works perfectly on localhost but when I deployed it into Heroku.com I can still see the home page and as I navigate to another page it shows me the error. I tried using this command \"heroku logs\" </p>\n\n<p>Here the logs</p>\n\n<pre><code>ActionView::Template::Error (undefined method `link_to_modal' for #&lt;#&lt;Class:0x000000046b8a10&gt;:0x000000046b4500&gt;):\n</code></pre>\n\n<p>Could it be the reason that I have 'link_to_modal' method in my view ??</p>\n\n<pre><code>&lt;p class=\"text\"&gt;&lt;%= link_to_modal \"+Add Album\", \"#addalbum\" %&gt;&lt;p&gt;\n</code></pre>\n\n<p>It works perfectly normally on my computer but not on heroku so I'm wondering what can I do with that and this method came with this gem that I'm using <a href=\"https://github.com/dei79/jquery-modal-rails\" rel=\"nofollow\">\"jquery-modal-rails\"</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":56,"score":-1,"question_id":13281114,"title":"Hashes and Curly Braces in Ruby Methods","body":"<p>I have this method in one of my view files:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, class: \"btn\", id: \"some_id\" %&gt;\n</code></pre>\n\n<p>Is this correct, or would I have to attach the curly braces around the two hashes like so:</p>\n\n<pre><code>&lt;%= link_to \"Sign up now!\", signup_path, { class: \"btn\", id: \"some_id\" } %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13280031,"title":"Rails isn't loading my JS properly - ERROR bad Request-Line `'","body":"<p>I have a Rails 3.2.3 app isn't consistently loading JS files. I just started working on the JS, so I'm not sure if this just started, or if it's been this way since I started it a few days ago.</p>\n\n<p>The two other guys working on the project are not having any problems at all. But sometimes it loads all of my files, sometimes it skips some, there doesn't seem to be any pattern.</p>\n\n<p>Sometimes it loads app.js, sometimes it doesn't. Same thing with the other js files.</p>\n\n<p>I'm seeing the following show up multiple times in my rails log:</p>\n\n<p>ERROR bad Request-Line `'.</p>\n\n<p>I'm at a loss here...</p>\n\n<p>application.js:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require util\n//= require app\n//= require_tree .\n</code></pre>\n\n<p>Here is what the log file is showing:</p>\n\n<pre><code>Started GET \"/assets/user_manager.js?body=1\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /user_manager.js - 200 OK (0ms)\n\n\nStarted GET \"/assets/util.js?body=1\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /util.js - 200 OK (0ms)\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n\n\nStarted GET \"/assets/header/topnav/separator.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /header/topnav/separator.png - 200 OK (0ms)\n\n\nStarted GET \"/assets/header/pagetitle-bg.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /header/pagetitle-bg.png - 200 OK (0ms)\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n\n\nStarted GET \"/assets/header_bg.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /header_bg.png - 404 Not Found (3ms)\n\nActionController::RoutingError (No route matches [GET] \"/assets/header_bg.png\"):\n  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.3) lib/rails/engine.rb:479:in `call'\n  railties (3.2.3) lib/rails/application.rb:220:in `call'\n  rack (1.4.1) lib/rack/c[2012-11-07 18:02:13] ERROR bad Request-Line `'.\nontent_length.rb:14:in `call'\n  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in     start_thread'\n\n\n  Rendered /Users/rob/.rvm/gems/ruby-1.9.3-p125@admin/gems/actionpack-3.2.    3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.1ms)\n\n\nStarted GET \"/assets/background/header_blueprint.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /background/header_blueprint.png - 200 OK (0ms)\n\n\nStarted GET \"/assets/images/ui-icons_454545_256x240.png\" for 127.0.0.1 at 2012-11-07 18:02:13 -0500\nServed asset /images/ui-icons_454545_256x240.png - 404 Not Found (3ms)\n\nActionController::RoutingError (No route matches [GET] \"/assets/images/ui-icons_454545_256x240.png\"):\n  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'\n  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'\n  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\n  rack (1.4.1) lib/rack/runtime.rb:17:in `call'\n  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n  rack (1.4.1) lib/rack/lock.rb:15:in `call'\n  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'\n  railties (3.2.3) lib/rails/engine.rb:479:in `call'\n  railties (3.2.3) lib/rails/application.rb:220:in `call'\n  rack (1.4.1) lib/rack/content_length.rb:14:in `call'\n  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'\n  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in     start_thread'\n\n\n  Rendered /Users/rob/.rvm/gems/ruby-1.9.3-p125@admin/gems/actionpack-3.2.    3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (0.8ms)\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.\n[2012-11-07 18:02:13] ERROR bad Request-Line `'.    \n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13281147,"title":"How to configure Rails 3 for JavaScript development","body":"<p>I'm moving an app from Rails 2 to Rails 3. I have a bunch of JavaScript files in the app, most of which are for working with Google Maps. Previously, my JS files were in public/javascripts/*.js. I noticed that they were not being loaded by any of the pages that used javascript_include_tag, which writes a JavaScript tag that tries to load the JS file from /assets/*.js. (e.g. /assets/application.js).</p>\n\n<p>I read that Rails 3 expects JS files to be located in app/assets/javascripts/*.js. So I moved my JS files there, but they still won't be accessible at /assets/application.js, unless I run <strong>bundle exec rake assets:precompile</strong> first.</p>\n\n<p>I can't have my JS development cycle be:</p>\n\n<ol>\n<li>Make change to JS</li>\n<li>Run bundle exec rake assets:precompile</li>\n<li>Reload browser</li>\n</ol>\n\n<p>Thats just too long. <strong>My question is how can I configure my app so that the development cycle is as follows?</strong></p>\n\n<ol>\n<li>Make change to JS</li>\n<li>Reload browser</li>\n</ol>\n\n<p>So far I've tried:</p>\n\n<ul>\n<li>Enabling the line that reads \"Bundler.require(:default, :assets,\nRails.env)\" in config/application.rb </li>\n<li>Setting config.assets.enabled = false (and true) in config/application.rb</li>\n</ul>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13261762,"title":"Populating Rails Fields Based on Calculation","body":"<p>In my Rails 3.2 app, I want to populate some fields based on calculations where the field values users enter are the variables.  However, with my current code, the calculation seems to only work based on the values already in the database - it doesn't calculate correctly on the initial save, but it will calculate correctly if I go back in the record and save it a second time.</p>\n\n<p>I have these four fields in my model (Trade):</p>\n\n<ol>\n<li>entry_price</li>\n<li>exit_price</li>\n<li>percent_result</li>\n<li>dollar_result</li>\n</ol>\n\n<p>The user creates a trade with an entry price, and then later edits the trade with the exit_price.  When the exit_price is entered, the app should calculate percent_result and dollar_result.  However, right now, these result fields are not populating correctly on the first update - it seems to be because it doesn't read the exit_price from the field (when a user enters it in the form), only once it is saved in the DB.</p>\n\n<p>What is going wrong in my controller?</p>\n\n<p>my controller:</p>\n\n<pre><code>def update\n  @trade = Trade.find(params[:id])\n  exit_price = params[:trade][:exit_price]\n\n  if !exit_price.blank?\n    @trade.percent_result = ((exit_price.to_f - @trade.entry_price)/@trade.entry_price) * 100\n    @trade.dollar_result = exit_price.to_f - @trade.entry_price \n  end\n\n  params[:trade][:exit_date] = Date.strptime(params[:trade][:exit_date], '%m/%d/%Y') unless params[:trade][:exit_date].blank?\n  params[:trade][:entry_date] = Date.strptime(params[:trade][:entry_date], '%m/%d/%Y') unless params[:trade][:entry_date].blank?\n  respond_to do |format|\n    if @trade.update_attributes(params[:trade])\n      format.html { redirect_to @trade, :flash =&gt; {:share =&gt;\"Your trade was successfully updated.  Don't forget to share it with your friends, so you can profit together!\"} }\n      format.json { head :no_content }\n    else\n      format.html { render action: \"edit\" }\n      format.json { render json: @trade.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>the view</p>\n\n<pre><code>&lt;%= simple_form_for(@trade, :html=&gt;{:class=&gt; \"form-horizontal well\"})  do |f| %&gt;  \n  &lt;%= f.text_field :entry_price, :class=&gt;\"input-small\" %&gt;\n  &lt;%= f.text_field :exit_price, :class=&gt;\"input-small\" %&gt;\n\n  &lt;%= submit_tag \"Edit Trade\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13281108,"title":"Parsing structured and semi-structured text with hundreds of tags with Ruby","body":"<p>I will be processing batches of 10,000-50,000 records with roughly 200-400 characters in each record.  I expect the number of search terms I could have would be no more than 1500 (all related to local businesses).</p>\n\n<p>I want to create a function that compares the structured tags with a list of terms to tag the data.  </p>\n\n<p>These terms are based on business descriptions.  So, for example, a <code>[Jazz Bar]</code>, <code>[Nightclub]</code>, <code>[Sports Bar]</code>, or <code>[Wine Bar]</code> would all correspond to queries for <code>[Bar]</code>.</p>\n\n<p>Usually this data has some kind of existing tag, so I can also create a strict hierarchy for the first pass and then do a second pass if there is no definitive existing tag.</p>\n\n<p>What is the most performance sensitive way to implement this?  I could have a table with all the keywords and try to match them against each piece of data.  This is straightforward in the case where I am matching the existing tag, less straightforward when processing free text.</p>\n\n<p>I'm using Heroku/Postgresql</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13277938,"title":"Rails joins query","body":"<p>I have three models</p>\n\n<ul>\n<li><code>Tag</code> => <code>:id</code>, <code>:name</code></li>\n<li><code>Tagging</code> => <code>:id</code>, <code>:tag_id</code>, <code>:post_id</code></li>\n<li><code>Post</code> => <code>:id</code>, <code>:summary</code></li>\n</ul>\n\n<p>I know the id of the tag. I would like to query for all of the posts that have a specific <code>tag_id</code>, through the <code>Taggings</code> model.</p>\n\n<p>Something like</p>\n\n<pre><code>@post = Post.joins(:taggings).where(:tag_id =&gt; 17)\n</code></pre>\n\n<p>but this doesn't work because it is looking for the tag_id in the <code>Post</code> model and not the <code>Tagging</code> model. </p>\n\n<p>I'm not sure how to do this.</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":26,"score":-1,"question_id":13280924,"title":"Generate next month","body":"<p>I have a table that looks like the following  <img src=\"http://i.stack.imgur.com/iLFO6.png\" alt=\"enter image description here\"></p>\n\n<p>I want to be able to generate the next and previous month when I click either of the two buttons. Not entirely sure if this is the right way to go about this. I was thinking I could try do something somewhat similar: </p>\n\n<pre><code>&lt;button id=\"nextmonth\"&gt;Next month&lt;/button&gt;  \n</code></pre>\n\n<p>JS</p>\n\n<pre><code> &lt;script&gt;$('#nextmonth').click(fuction(e) {\n       $.get('/rota_days/show.json?mon=12').success(function(data) \n        { \n\n        /* display response */ \n\n\n        });\n    });\n</code></pre>\n\n<p><strong>rota_days_controller.rb</strong></p>\n\n<pre><code>class RotaDaysController &lt; ApplicationController\n\nrespond_to :json, :html \n\ndef nextmonth \n\n   respond_with(@rota_days) \nend\nend \n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13279979,"title":"Rails: Create a survey with the data in a database table","body":"<p>I'm currently trying to create a survey which will use questions that are stored in a table. I've read <a href=\"http://railscasts.com/episodes/196-nested-model-form-part-1\" rel=\"nofollow\">nested model form part 1</a> from rails casts however i'm not getting anywhere as the questions are not displaying in the survey.</p>\n\n<p>I have three tables, one tables has the text of the questions, another table keeps the record of who entered the survey and a third table which keeps the answers from a user for the questions.</p>\n\n<p><strong>variable table</strong>:\nname: varchar\nid: integer</p>\n\n<p><strong>report table</strong>\nemployee name: varchar\ndate: date\nid: integer</p>\n\n<p><strong>report_variable table</strong>\nquestion_id\nreport_id\nanswer</p>\n\n<p>Code i modified for reports/new:</p>\n\n<pre><code> # GET /reports/new\n # GET /reports/new.json\n def new\n   @report = Report.new\n   #variable = @report.variable.build #dont know what to do here, gives an error with report_id\n   respond_to do |format|\n     format.html # new.html.erb\n     format.json { render json: @report }\n   end\n end\n</code></pre>\n\n<p>modified report/_form.html.erb</p>\n\n<pre><code>   &lt;div &gt;\n     &lt;%= f.fields_for :variable do |builder| %&gt;\n       &lt;%= render variable_fields, :f =&gt; builder %&gt;\n     &lt;% end %&gt;\n   &lt;/div&gt;\n</code></pre>\n\n<p>created report/_variable_fields.html.erb</p>\n\n<pre><code>   &lt;p&gt;\n      &lt;%= f.label :name %&gt;\n      &lt;%= f.text_field :name, :class =&gt; 'text_field' %&gt;\n   &lt;p&gt;\n</code></pre>\n\n<p>model for report_variable</p>\n\n<pre><code>class ReportVariable &lt; ActiveRecord::Base\n  attr_accessible :report_id, :value, :variable_id\n  has_and_belongs to many :reports\n  has_and_belongs to many :variables\nend\n</code></pre>\n\n<p>model for report</p>\n\n<pre><code>class Report &lt; ActiveRecord::Base\n  attr_accessible :employeeName\n  has_many :report_variable\n  has_many :variable\n\n  accepts_nested_attributes_for :report_variable\n  accepts_nested_attributes_for :variable\nend\n</code></pre>\n\n<p>Sorry if it's a simple question, im pretty new to rails.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","asset-pipeline","scss"],"answer_count":7,"favorite_count":2,"up_vote_count":11,"down_vote_count":0,"view_count":3843,"score":11,"question_id":8158987,"title":"rails 3.1 asset pipeline css caching in development","body":"<p>I'm a bit confused as it seems like the application.css is including itself twice, once when it lists the resources from the manifest and then a cache of that.   So when I delete an individual file it still seems to stay alive inside the application.css file.</p>\n\n<h1>application.css (source)</h1>\n\n<pre><code>/*\n*= require twitter/bootstrap\n*= require_self\n*= require_tree ./common\n*= require_tree ./helpers\n*/\n</code></pre>\n\n<p>Which works as expected and outputs in dev mode all the relevant individual files</p>\n\n<h1>development.rb</h1>\n\n<pre><code>  # Do not compress assets\n  config.assets.compress = false\n\n  # Expands the lines which load the assets\n  config.assets.debug = true\n</code></pre>\n\n<h1>output</h1>\n\n<pre><code>&lt;link href=\"/assets/twitter/bootstrap.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/application.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/common/announcement.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/common/button.css?body=1\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;Blah blah&gt;\n</code></pre>\n\n<h1>application.css (output)</h1>\n\n<p>This should be blank?  Since all I have in my application.css file is the manifest and no actual css but instead i get all my concatenated code 106kb long.</p>\n\n<p>IE if I remove a file in the common directory, it doesn't go away.  It is no longer listed in the output but the css still appears from the application.css</p>\n"},{"tags":["jquery","ruby-on-rails-3","wysihtml5"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13280499,"title":"jQuery: function only works if followed by a broken function","body":"<p>It's exactly what it sounds like. I've got <a href=\"https://github.com/jhollingworth/bootstrap-wysihtml5\" rel=\"nofollow\">a groovy little plugin</a> in my Rails app that rich-texts field areas. It works fine, except for the fact that two toolbars appear when there should only be one.</p>\n\n<pre><code>$('#user_address').wysihtml5();\n</code></pre>\n\n<p>If, however, I put beneath it a similar function that refers to nothing:</p>\n\n<pre><code>$('#this_thing').this_is_broken();\n</code></pre>\n\n<p>Then it fixes the two toolbar issues but breaks all the other jQuery functions I've got going on.</p>\n\n<p>Any ideas? Sounds like a bug to me.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook","devise","omniauth"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":248,"score":2,"question_id":7471763,"title":"Omniauth + Facebook Mutual Friends Count","body":"<p>Is there a better/easier way to find mutual friends between users than creating a Friends table and logging the UIDs of each new user's friends? (Using Devise + Omniauth on Rails 3)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":61,"score":5,"question_id":13277077,"title":"Is changing `require` to concatenate Ruby files brilliant or crazy?","body":"<p>When booting a Rails application with lots of dependencies, a lot of time is spent (I think) in <code>require</code>ing files.</p>\n\n<p>Suppose you were to create a deploy process that converted all <code>require</code> statements to file concatenations, using the same rules (don't get the same file twice, etc). Essentially, it would treat Ruby the way the asset pipeline treats javascript.</p>\n\n<p>Would this make a real speed difference? Would it create any issues - for instance, with variable scope - other than making it harder to trace errors to their original source files? </p>\n\n<p>In short, <strong>is this brilliant or crazy?</strong></p>\n\n<h2>Update</h2>\n\n<p>As pst points out, this would be pointless in production, where the server likely loads everything once, then forks to handle new requests.</p>\n\n<p>But consider the test environment, where you boot your Rails app every time you run your tests. Pre-concatenating all your gems could have an effect similar to the Spork gem.</p>\n\n<p>I suppose my real question is <strong>how much time is spent in <code>require</code> vs parsing the contents of the files</strong>.</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13279933,"title":"Trouble Deploying Rails App To Heroku","body":"<p>Below is are the steps I tried to deploy my rails app to heroku. However I'm getting \"Your key with fingerprint is not authorized to access\" my application.</p>\n\n<ol>\n<li>Deleted all existing keys from ~/.ssh</li>\n<li>$ heroku keys:clear</li>\n<li>$ heroku create lunch-tr</li>\n<li>Enter your Heroku credentials.</li>\n<li>Email: adam.aahrens@gmail.com</li>\n<li>Password (typing will be hidden): </li>\n<li>Could not find an existing public key.</li>\n<li>Would you like to generate one? [Yn] Y</li>\n<li>Generating new SSH public key.</li>\n<li>Uploading SSH public key /.ssh/id_rsa.pub... done</li>\n<li>Creating lunch-tr... done, stack is cedar</li>\n<li><a href=\"http://lunch-tr.herokuapp.com/\" rel=\"nofollow\">http://lunch-tr.herokuapp.com/</a> | git@heroku.com:lunch-tr.git Git remote heroku added</li>\n<li>$ git remote -v</li>\n<li>heroku  git@heroku.com:lunch-tr.git (fetch) heroku  git@heroku.com:lunch-tr.git (push)</li>\n<li><p>$ git push heroku master</p>\n\n<p>!  Your key with fingerprint 2f:0b:2c:e9:95:b4:52:af:dc:db:9c:57:e3:f2:57:7f is not authorized to access lunch-tr. fatal: The remote end hung up unexpectedly</p></li>\n</ol>\n\n<p>Not sure what else I should try I'm running out of ideas. Thanks for any suggestions</p>\n"},{"tags":["ruby","ruby-on-rails-3","imagemagick","rmagick"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":9,"score":2,"question_id":13279985,"title":"how to force build vendored gems in rails 3.01 - rmagick issue when vendored","body":"<p>I have vendored rmagick and its not behaving. Works fine when not vendored, but when vendoring using:</p>\n\n<pre><code>gem unpack rmagick --target vendor/gems\n\nFetching: rmagick-2.13.1.gem (100%)\nUnpacked gem: '/Users/joelnylund/Projects/aras/vendor/gems/rmagick-2.13.1'\n</code></pre>\n\n<p>Then When I try to load my server I get:</p>\n\n<pre><code>/Users/joelnylund/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.0.17/lib/active_support/dependencies.rb:242:in `require': no such file to load -- RMagick2.so (LoadError)\n</code></pre>\n\n<p>I used to do \"rake gems:build:force\" to fix this on rails 2.3.5, but this gives me the same error now. How do I tell rails 3 to native build the vendored gem?</p>\n\n<p>Similar question, but no answer here:\n<a href=\"http://stackoverflow.com/questions/7169178/no-such-file-to-load-rmagick2-so\">no such file to load -- RMagick2.so</a></p>\n"},{"tags":["ruby-on-rails-3","validation","customvalidator"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13279674,"title":"rails 3 custom validation error","body":"<p>I am trying to build my own validator. I have created new folder <code>lib/validators</code> and added to <code>application.rb</code>:</p>\n\n<pre><code>config.autoload_paths += %W[\"#{config.root}/lib/validators/\"]\n</code></pre>\n\n<p>Then I have created class in <code>lib/validators</code>:</p>\n\n<pre><code>class ExistInDatabaseValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attribute, value)\n    if attribute[0..-4].constantize.first(value).nil?\n      record.errors[attribute] &lt;&lt; (options[:message] || \"Invalid value for #{attribute}\")\n    end \n  end \nend\n</code></pre>\n\n<p>and in one of my model I have:</p>\n\n<pre><code>validates :donor_id, :exist_in_database =&gt; true\n</code></pre>\n\n<p>The validator should change <code>donor_id</code> into <code>Donor</code> and checks if the record exists in the database by running <code>find()</code> method. Anyway, I get this exception eveyrtime [ no matter on which page I am ]:</p>\n\n<pre><code>NoMethodError in GiftsController#index\nundefined method `key?' for nil:NilClass\n</code></pre>\n\n<p>without any stacktrace etc, so I am not sure what causes the error and what I am doing wrong. I am also not sure if what I am trying to do makes sense, but I wanted to play a little with custom validators anyway ;)</p>\n\n<p>By the way, if I change in my model <code>:exist_in_database</code> to for example <code>:exist_abc</code>, I get error:</p>\n\n<pre><code>ArgumentError in GiftsController#index\n\nUnknown validator: 'ExistAbcValidator'\n\nApplication Trace | Framework Trace | Full Trace\napp/models/gift.rb:8:in `&lt;class:Gift&gt;'\napp/models/gift.rb:1:in `&lt;top (required)&gt;'\napp/controllers/gifts_controller.rb:1:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>so I believe the class is loaded correctly</p>\n"},{"tags":["ruby","arrays","ruby-on-rails-3","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13279312,"title":"Rails 3 Return Array From Collection.each Block","body":"<p>I'm trying to return some json to the calling action. One of the params I want to pass is an array of arrays built from looping through a collection as so: </p>\n\n<pre><code>render :json =&gt; {     \n:rows =&gt; @classrooms.each do |classroom|\n          [classroom.name, classroom.students.count]\n        end    \n}  \n</code></pre>\n\n<p>However, this sets :rows to the entire collection as opposed to what I want:</p>\n\n<blockquote>\n  <p>[[classroom, students],[classroom, students],[classroom, students]]</p>\n</blockquote>\n\n<p>Is there any way of looping through the collection and returning an array in a single block?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":4,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":236,"score":6,"question_id":4045436,"title":"How to make US date format as the default when saving to a model in Rails 3","body":"<p>The US date used to be accepted/parsed correctly, but not anymore in Rails 3. The %Y-%m-%d is accepted but not %m/%d/%Y. </p>\n\n<pre><code>g = Grant.new\ng.budget_begin_date = '12/31/2010'\n#g.budget_begin_date returns nil\ng.budget_begin_date = '2010-12-31'\n#g.budget_begin_date returns Fri, 31 Dec 2010 00:00:00 UTC +00:00\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","meta-search"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":106,"score":3,"question_id":7893349,"title":"Avoiding select * queries in meta_search","body":"<p>I'm using meta_search gem on a rails 3 site and I'm finding some performance problems with the select * queries generated by meta_search fetching the BLOB fields in the DB schema. I am not willing to migrate the underlying schema to solve this problem. Is there a way to include/exclude certain fields from the search query that get generated by meta_search?</p>\n"},{"tags":["ruby-on-rails-3","upload","amazon-s3","paperclip"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":888,"score":3,"question_id":7257745,"title":"Rails 3 - Amazon S3 Paperclip EU Problem","body":"<p>I'm using:</p>\n\n<pre><code>Paperclip 2.3.16\nRails 3.0.9\nRuby 1.9.2\nAWS - S3 0.6.2\n</code></pre>\n\n<p>I'm trying to use paperclip the upload to the EU (Ireland) based bucket. I have the following in my model:</p>\n\n<pre><code>has_attached_file :image, :styles =&gt; { :grid =&gt; '90x128#', :list =&gt; '140x200#', :original =&gt; '400x548'},\n            :storage =&gt; :s3,\n                      :s3_credentials =&gt; \"#{RAILS_ROOT}/config/s3.yml\",\n                      :url  =&gt; 'flyers/:id/:style/:basename.:extension',\n                      :path =&gt; 'flyers/:id/:style/:basename.:extension',\n                      :bucket =&gt; 'fsight'\n</code></pre>\n\n<p>In my environment.rb I have set the write to use the AWS/s3 Default Host to the relevant EU one by using:</p>\n\n<pre><code>require \"aws/s3\"\nAWS::S3::DEFAULT_HOST.replace \"s3-eu-west-1.amazonaws.com\"\n</code></pre>\n\n<p>This works fine, and it allows me to upload the images, and I can verify the image upload / delete using the AWS Management consoler.</p>\n\n<p>However, I have a problem when trying to display the images on my site. The images do not load and I have identified the cause, as the URL generated uses the old default host. Eg:</p>\n\n<p><strong>What it should be:</strong>\n<a href=\"https://s3-eu-west-1.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg\" rel=\"nofollow\">https://s3-eu-west-1.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg</a></p>\n\n<p><strong>What it actually is:</strong> <a href=\"http://s3.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg?1314801178\" rel=\"nofollow\">http://s3.amazonaws.com/fsight/flyers/50/full/4759543368588654950.jpg?1314801178</a></p>\n\n<p>As you can see, it uses the old default host.</p>\n\n<p>I tried placing:</p>\n\n<pre><code>Paperclip.interpolates(:s3_eu_url) do |att, style|\n    \"#{att.s3_protocol}://s3-eu-west-1.amazonaws.com/#{att.bucket_name}/#{att.path(style)}\"\nend\n</code></pre>\n\n<p>But then started receiving the following error:</p>\n\n<pre><code> wrong number of arguments (0 for 1)\n\nExtracted source (around line #9):\n\n &lt;img src= &lt;%= @event.image.url(:original) %&gt;\n</code></pre>\n\n<p>I know Paperclip has some issues with using EU Buckets, but could anybody help me with this?</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","sqlite3","amazon-ec2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":132,"score":3,"question_id":12812721,"title":"Rails: SQLite3::CantOpenException: unable to open database file","body":"<p>I'm trying to use <code>delayed_job</code> to schedule tasks using Sqlite3, and it looks like apache isn't able to read my <code>production.sqlite3</code> file.</p>\n\n<p>Here's my <code>database.yml</code>:</p>\n\n<pre><code>production:\n  adapter: sqlite3\n  database: db/production.sqlite3\n  pool: 5\n  timeout: 5000\n</code></pre>\n\n<p>Here's the error I am getting (in log/production.log):</p>\n\n<pre><code>ActiveRecord::StatementInvalid (SQLite3::CantOpenException: unable to open database file:) \n</code></pre>\n\n<p>I have run <code>RAILS_ENV=production rake db:create</code> and <code>RAILS_ENV=production rake db:migrate</code>. The <code>db/production.sqlite3</code> file exists, and the db directory and all its subfolders are owned by <code>apache:apache</code>, which is who apache runs as. I'm using Phusion Passenger on Amazon EC2.</p>\n"},{"tags":["ruby-on-rails-3","associations"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13278177,"title":"Associations in Rails 3","body":"<p>I have an app which allows users to add recipes and then select their favourite recipes to view in their member area, I can select a favourite and i am getting the user_id, recipe_id and giving it a favourite_id.</p>\n\n<p>What I would like to do is output the actual recipe to my view (as a favourite), like dish name, country_of_origin etc. I can do this with an actual recipe but not the favourite.Do i need to use has_many_through for this?</p>\n\n<p>My models look like this</p>\n\n<p>User</p>\n\n<pre><code>has_many :recipes\nhas_many :favourites\n</code></pre>\n\n<p>recipe</p>\n\n<pre><code>belongs_to :user\nhas_many :ingredients \nhas_many :preperations\nhas_many :favourites\n</code></pre>\n\n<p>favourites</p>\n\n<pre><code>belongs_to :user\nbelongs_to :recipe\n\nattr_accessible :user_id, :recipe_id\n</code></pre>\n\n<p>My controller</p>\n\n<pre><code>  @favourites = current_user.favourites\n</code></pre>\n\n<p>my link_to post</p>\n\n<pre><code> &lt;%= link_to \"Add to favorites\",  {:controller =&gt; 'favourites', :action =&gt; 'create', :recipe_id =&gt; r.id}, {:method =&gt; :post } %&gt;\n</code></pre>\n\n<p>i can list the current users recipes, this is my contoller for this</p>\n\n<pre><code>@recipes = current_user.recipes if current_user.recipes\n</code></pre>\n\n<p>and then output them to the view like so</p>\n\n<pre><code> &lt;% @recipes.each do |r| %&gt;\n &lt;tr&gt;\n &lt;td&gt;&lt;%= r.dish_name %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= r.country_of_origin %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= r.difficulty %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= r.preperation_time %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= ingredient_names(r.ingredients) %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= preperation_steps(r.preperations) %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= image_tag r.avatar.url(:thumb)%&gt;&lt;/td&gt;\n &lt;tr&gt;\n</code></pre>\n\n<p>So if i do this in the view</p>\n\n<pre><code> &lt;li&gt;&lt;%= @favourites %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>I get this outputted</p>\n\n<pre><code> &lt;Favourite id: 16, user_id: 8, recipe_id: 21, created_at: \"2012-11-07 20:24:39\", updated_at: \"2012-11-07 20:24:39\"&gt;]\n</code></pre>\n\n<p>If i try</p>\n\n<pre><code> &lt;%= @favourites.dish_name %&gt;\n</code></pre>\n\n<p>then i get the error undefined  method dish_name</p>\n\n<p>How do i get the params of the recipe model to show in the view. I do apologise just cant work it out, which should be really easy i guess?</p>\n\n<p>Any help appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","globalize3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13265384,"title":"Is it \"advisable\" / \"the right way\" to store all possible translations?","body":"<p>I am using Ruby on Rails v3.2.2 and the <a href=\"https://github.com/svenfuchs/globalize3\" rel=\"nofollow\">Globalize3 v0.2.0</a> gem. At this time I am using Globalize3 in order to translate country, region and city names in two languages but I plan to use it to internationalize my application in many more languages (ideally, all). So, I am populating the database with translation data, but I have some doubts on that: should I populate my <code>country_translations</code>, <code>region_translations</code> and <code>city_translations</code> database tables with <em>all</em> internationalized names (even if it may be that some names are the same as the default ones - in this case the internationalized name is <em>nil</em> or repeated)? that is, in translation tables should I create a translation record <em>for each</em> locale supported by my application (in my current case, two locales) and <em>for each</em> country, region and city?</p>\n\n<p>Making so, in a \"ideal\" scenario supporting all languages, mentioned tables (mostly those related to regions and cities) will be very large and probabily performance less. On the other hand, it makes sure that Globalize3 will properly work since it seems that in some cases when the internationalized record doesn't exist (I avoid to explain my specific case since it is \"hard\" to do, and maybe it'd need a book to be explained) that gem does <em>not</em> properly fallback to the current locale.</p>\n\n<p>How should I proceed?</p>\n"},{"tags":["jquery","ruby-on-rails-3","ujs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13200129,"title":"Which jquery-rails gem version is working with Rails 3.0?","body":"<p>According to the docs, the <a href=\"https://github.com/rails/jquery-ujs#installation\" rel=\"nofollow\">jquery-ujs Installation</a> is as easy as adding</p>\n\n<pre><code>gem 'jquery-rails', '~&gt; 2.1'\n</code></pre>\n\n<p>to the Gemfile, and running:</p>\n\n<pre><code>$ bundle install\n</code></pre>\n\n<hr>\n\n<p>My app is running <strong>Rails 3.0.15</strong>, and <code>jquery-rails</code> seems to be compatible with it:</p>\n\n<blockquote>\n  <p>For Rails 3.0 , run [...]</p>\n</blockquote>\n\n<p>but when bundling <code>jquery-rails</code> 2.1, I seem to need Rails 3.1+: </p>\n\n<pre><code>Bundler could not find compatible versions for gem \"railties\":\n  In Gemfile:\n    jquery-rails (~&gt; 2.1) x86-mingw32 depends on\n      railties (&lt; 5.0, &gt;= 3.1.0) x86-mingw32\n\n    rails (= 3.0.15) ruby depends on\n      railties (3.0.15)\n</code></pre>\n\n<p>What <code>jquery-rails</code> gem version is compatible with Rails 3.0?</p>\n\n<p><em>(also asked <a href=\"https://github.com/rails/jquery-ujs/issues/286\" rel=\"nofollow\">here</a>)</em></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13276783,"title":"get models name and count","body":"<p>I have this in <code>models_name</code>:</p>\n\n<pre><code>model_names = Object.constants.collect { |sym| Object.const_get(sym) }.select { |constant| constant.class == Class &amp;&amp; constant.include?(Mongoid::Document) }.collect { |klass| klass.name }\n</code></pre>\n\n<p>the result is:</p>\n\n<pre><code>[\"Model_name1\",\"Model_name2\",\"Model_name3\"]\n</code></pre>\n\n<p>I need something like:</p>\n\n<pre><code>[{\"Model1\":\"Count\"},{\"Model2\":\"Count\"},{\"Model3\":\"Count\"}]\n</code></pre>\n\n<p>I need show in a chart all models and object counter inside each model is working with <code>morris.js</code></p>\n\n<p>You can see the example:</p>\n\n<p><a href=\"http://jsbin.com/uzosiq/2/embed?javascript,live\" rel=\"nofollow\">http://jsbin.com/uzosiq/2/embed?javascript,live</a></p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13277751,"title":"Ruby code in yaml file?","body":"<p>I am using a gem that have this e-mail method:</p>\n\n<pre><code>  #Sends and email for indicating a reply in an already created conversation\n  def reply_message_email(message,receiver)\n    @message = message\n    @receiver = receiver\n    subject = message.subject.to_s\n    subject = strip_tags(subject) unless subject.html_safe?\n    mail(:to =&gt; receiver.send(Mailboxer.email_method,message), :subject =&gt; t('mailboxer.message_mailer.subject_reply', :subject =&gt; subject)) do |format|\n      format.text {render __method__}\n      format.html {render __method__}\n    end\n  end\nend\n</code></pre>\n\n<p>And I have this in my locale:</p>\n\n<pre><code>da:\n  mailboxer:\n    message_mailer:\n        subject_reply: You have got a new reply \"#{subject}\"\n</code></pre>\n\n<p>Instead of overwriting the email method. Is it not possible to do some ruby code in a YAML file? Now the subject of an e-mail is just You have got a new reply \"#{subject}\" as text and the ruby code is not active.</p>\n"},{"tags":["ruby","ruby-on-rails-3","jruby","jruby-openssl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13277774,"title":"OpenSSL::SSL::SSLError in jruby 1.6.7/1.7.0 1.9 mode","body":"<p>I'm running a rails 3 app with jruby 1.7.0 in 1.9 mode, and when one of my file uploading gems tries to make a https connection, it fails with the following exception:</p>\n\n<pre><code>Excon::Errors::SocketError: write would raise (OpenSSL::SSL::SSLError)\n    from org/jruby/ext/openssl/SSLSocket.java:626:in `syswrite_nonblock'\n    from /home/x/.rvm/gems/jruby-1.7.0@global/gems/jruby-openssl-0.7.7/lib/1.9/openssl/buffering.rb:375:in `write_nonblock'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/socket.rb:139:in `write'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/ssl_socket.rb:84:in `write'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/connection.rb:243:in `request_kernel'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/excon-0.16.7/lib/excon/connection.rb:103:in `request'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/core/connection.rb:20:in `request'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace.rb:71:in `authenticate'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace/storage.rb:146:in `authenticate'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/rackspace/storage.rb:95:in `initialize'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/core/service.rb:68:in `new'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/fog-1.7.0/lib/fog/storage.rb:34:in `new'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:106:in `connection'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:323:in `connection'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:335:in `directory'\n    from /home/x/.rvm/gems/jruby-1.7.0/gems/carrierwave-0.6.2/lib/carrierwave/storage/fog.rb:250:in `store'\n</code></pre>\n\n<p>I found a similar issue on stackoverflow here: <a href=\"http://stackoverflow.com/questions/11859549/jruby-heroku-gem\">JRuby Heroku Gem</a>, but the suggested answer is run jruby in 1.8 mode which I cannot do since our entire app uses 1.9 features and syntax. Does anybody have any ideas or suggesetions on how to fix or get around this exception?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13277204,"title":"rails form add fields dynamically","body":"<p>I'm trying to set a set of fields to be dynamically displayed on demand. In the model, I've the fields:</p>\n\n<pre><code>attr_accessible ... :instruct1, :instruct2, ... :instruct30\n</code></pre>\n\n<p>I would like the form to display just instruct1 with a button to add 1 more field until instruct30 is hit and a button to remove one until instruct 1 is hit. All should happen without refreshing page which i think would include some use of AJAX but I couldn't find anything that is similar.</p>\n\n<p>I've searched for something similar but only able to come up with nested form which is not what im looking for as my model is fixed.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":1108,"score":4,"question_id":9237201,"title":"Getting frequent Gem RemoteFetcher::FetchError. Any workarounds?","body":"<p>I've been getting this error frequently every day for the last few days...</p>\n\n<pre><code>$ gem install rails -v 3.2.1\nERROR:  While executing gem ... (Gem::RemoteFetcher::FetchError)\n    bad response Forbidden 403 (http://production.cf.rubygems.org/gems/rdoc-3.12.gem)\n</code></pre>\n\n<p>My understanding based on a <a href=\"http://stackoverflow.com/questions/8580753/gem-install-rails-failing-any-workaround\">previous question</a> is that this is due to a problem with the remote repository and the solution is to just wait a little while and try again. Indeed, sometimes when I wait a few hours or overnight the install command works.</p>\n\n<p>However, I'm hoping for a more reliable experience.</p>\n\n<p>I thought of downloading files such as <code>rails-3.2.1.gem</code> and then running...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem\n</code></pre>\n\n<p>But that gives me...</p>\n\n<pre><code>$ gem install --local ~/Desktop/rails-3.2.1.gem \nERROR:  While executing gem ... (Gem::DependencyError)\n    Unable to resolve dependencies: rails requires railties (= 3.2.1)\n</code></pre>\n\n<p>I could try downloading railties. Maybe I will. But I sense a plunge down a rabbit hole there of searching out dependency after dependency all day long.</p>\n\n<p>Any alternate efficient ways to install gems? Is there something I could do through my repository specification that would allow gem installation to be more reliable?</p>\n\n<hr>\n\n<pre><code>$ gem environment\nRubyGems Environment:\n  - RUBYGEMS VERSION: 1.8.15\n  - RUBY VERSION: 1.9.2 (2011-07-09 patchlevel 290) [x86_64-darwin11.2.0]\n  - INSTALLATION DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n  - RUBY EXECUTABLE: /Users/ethan/.rvm/rubies/ruby-1.9.2-p290/bin/ruby\n  - EXECUTABLE DIRECTORY: /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86_64-darwin-11\n  - GEM PATHS:\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@rails_3_for_mtc\n     - /Users/ethan/.rvm/gems/ruby-1.9.2-p290@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n     - :sources =&gt; [\"http://rubygems.org\"]\n     - \"gem\" =&gt; \"--no-rdoc --no-ri\"\n     - \"install\" =&gt; \"--no-rdoc --no-ri\"\n     - \"update\" =&gt; \"--no-rdoc --no-ri\"\n  - REMOTE SOURCES:\n     - http://rubygems.org\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","nested-form-for"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13260149,"title":"Rails 3 nested edit form not updating","body":"<p>I have a form for nested attribute. When I click update it redirects properly and says \"successful\" however the attributes are not updated. I have tried several different form_for combinations and have yet to get it to update successfully. </p>\n\n<p>The form I use for a new department is different and the form_for looks like this </p>\n\n<pre><code>&lt;%= form_for([@client,@client.departments.build]) %&gt; \n</code></pre>\n\n<p>This form is nested on the client#show. </p>\n\n<p>Edit Form</p>\n\n<pre><code>    &lt;%= form_for([@client, @department], :url =&gt; client_department_path(@client,@department)) do |f| %&gt; \n      &lt;div class=\"field\"&gt;                                                                               \n        &lt;%= f.label :department_name %&gt;&lt;br /&gt;                                                           \n        &lt;%= f.text_field :department_name %&gt;                                                            \n      &lt;/div&gt;                                                                                            \n      &lt;div class=\"field\"&gt;                                                                               \n        &lt;%= f.label :department_manager %&gt;&lt;br /&gt;                                                        \n        &lt;%= f.text_field :department_manager %&gt;                                                         \n      &lt;/div&gt;                                                                                            \n      &lt;div class=\"actions\"&gt;                                                                             \n        &lt;%= f.submit %&gt;                                                                                 \n      &lt;/div&gt;                                                                                            \n    &lt;% end %&gt;      \n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>    class DepartmentsController &lt; ApplicationController\n\nbefore_filter :get_client\ndef get_client\n  @client = Client.find(params[:client_id])\nend \ndef create\n    @department = @client.departments.create(params[:department])\n    redirect_to client_path(@client)\n\nend\ndef update\n  @department = @client.departments.find(params[:id])\n\n  respond_to do |format|\n  if @department.update_attributes(params[:task])\n  format.html { redirect_to client_path(@client), notice: 'Department was successfully updated.' }\n  format.json { head :no_content }\n  else\n  format.html { render action: \"edit\" }\n  format.json { render json: @department.errors, status: :unprocessable_entity }\n  end\nend\nend\ndef show\n  @department = @client.departments.find(params[:id])\n\n\n    respond_to do |format|\n        format.html # show.html.erb\n        format.json { render json: @client }\n    end\nend\ndef edit\n    @department = @client.departments.find(params[:id])\nend\n\ndef destroy\n    @client = Client.find(params[:client_id])\n    @department = @client.departments.find(params[:id])\n    @department.destroy\n    redirect_to client_path(@client)\nend     \nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13277250,"title":"Does the second boolean after && executes in rails?","body":"<p>I'm still new to rails and lots of it is not what I'm used to. Couldn’t find my answer on this and don’t actually know what to search for so please help.</p>\n\n<p>Is this:</p>\n\n<pre><code>def create\n    @note = Note.new(params[:note])\n    @note.creator = current_user\n    if member_of_project? @note.project_id\n      if @note.save\n        redirect_to @note, :notice =&gt; \"Successfully created note.\"\n      else\n        render :action =&gt; 'new'\n      end\n    else\n      render :action =&gt; 'new'\n    end\n  end\n</code></pre>\n\n<p>Equal to:</p>\n\n<pre><code>def create\n    @note = Note.new(params[:note])\n    @note.creator = current_user\n    if member_of_project? @note.project_id &amp;&amp; @note.save\n      redirect_to @note, :notice =&gt; \"Successfully created note.\"\n    else\n      render :action =&gt; 'new'\n    end\n  end\n</code></pre>\n\n<p>???</p>\n\n<p>What I really want to know is if the second one will call <code>@note.save</code>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","image","heroku","progressive"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13277370,"title":"Why do Images Loaded from Heroku Load Progressively","body":"<p>I have a small (Rails 3.1) app running on Heroku (with images also served from Heroku) The images load progressively (from top to bottom). If I take the same images and place them on another (Apache) server, they seemingly pop into existence once they are loaded. </p>\n\n<p>So why are they loading top-to-bottom on Heroku? Is it just that they are loading really slowly (so the progressive download is obvious) or is it something to do with the way Heroku serves images?</p>\n"},{"tags":["ruby-on-rails-3","gem","ruby-on-rails-2","upgrade-issue"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13275790,"title":"Rails 2 to 3 and deprecated gems","body":"<p>I am planning on initiating an upgrade from Rails 2 to Rails 3 for a rather <em>big</em> app. Problem is the project is relying on some old gems that are no longer supported by Rails 3. </p>\n\n<p>What choices do I have, knowing that deactivating the dependant functionalities is not an option ? Are there any solutions besides looking for alternate gems ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","gem","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":357,"score":1,"question_id":12486894,"title":"Rails: json 1.7.5 bundle install issue","body":"<p>When running bundle I get the following issue...</p>\n\n<blockquote>\n  <p>Installing json (1.7.5) with native extensions\n  Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native\n  extension.</p>\n\n<pre><code>    /usr/local/bin/ruby extconf.rb creating Makefile\n</code></pre>\n  \n  <p>make Makefile:158: <em>*</em> target pattern contains no `%'.  Stop.</p>\n  \n  <p>Gem files will remain installed in\n  /srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/gems/json-1.7.5\n  for inspection. Results logged to\n  /srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/gems/json-1.7.5/ext/json/ext/generator/gem_make.out\n  An error occured while installing json (1.7.5), and Bundler cannot\n  continue. Make sure that <code>gem install json -v '1.7.5'</code> succeeds before\n  bundling.</p>\n</blockquote>\n\n<p>I tried doing the following <code>sudo aptitude install ruby1.9.1-dev</code> but that didn't work.  </p>\n"},{"tags":["ruby-on-rails-3","mongodb","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13276739,"title":"Rails 3 Symbol.gte method","body":"<p>I saw the following code example:</p>\n\n<pre><code>Subscription.where(:created_at.gte =&gt; t0)`\n</code></pre>\n\n<p>To me, this seems a little more ruby/rails-like as opposed to:</p>\n\n<pre><code>Subscription.where(\"created_at &gt; ?\", t0)`\n</code></pre>\n\n<p>However, attempting to reproduce this in my own code on results in:</p>\n\n<blockquote>\n  <p>undefined method `gte' for :created_at:Symbol</p>\n</blockquote>\n\n<p>I'm not certain, but I believe this is a MongoDB method. If so is there any way I can extend ActiveRecord to make use of it?</p>\n"},{"tags":["jquery","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13274481,"title":"Move list item from one unordered list to another","body":"<p>I'm trying to move my list item from one unordered list to another. update.js.erb is called when the update happens ( I can see it being called in the log with no errors).</p>\n\n<p>I'm very new to jQuery so I appologize for my ignorance.</p>\n\n<pre><code>&lt;% if @task.complete? %&gt;\n  $('#task_&lt;%= @task.id%&gt; li').detach().appendTo($('#complete_tasks ul'));\n  $.('#complete_tasks').sortable_list();\n&lt;% else %&gt;\n  $('#task_&lt;%= @task.id %&gt; li').detach().appendTo($('#incomplete_tasks ul'));\n  $.('#incomplete_tasks').sortable_list();\n&lt;% end %&gt;\n</code></pre>\n\n<p>I saw .detach() in <a href=\"http://stackoverflow.com/questions/12956373/how-to-move-an-item-from-one-list-to-another\">How to move an item from one list to another?</a> </p>\n\n<p>I have tried many different forms but my guess is I'm selecting the list or list item wrong. </p>\n\n<p>Any / all feedback is greatly appreciated ! :)</p>\n\n<pre><code>ul id=\"complete_tasks\" data-update-url=\"http://localhost:3000/tasks/sort_incomplete\" class=\"ui-sortable\"\n  li class=\"task\" id=\"task_1\"\n  ...\n</code></pre>\n\n<p>And similarly the incomplete_tasks</p>\n\n<pre><code>ul id=\"incomplete_tasks\" data-update-url=\"http://localhost:3000/tasks/sort_complete\" class=\"ui-sortable\"\n  li class=\"task\" id=\"task_7\"\n  ...\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":400,"score":1,"question_id":11885398,"title":"Is there a fix for the \"Could not find *gem* in any of the sources\" error that doesn't involve deleting Gemfile.lock?","body":"<p>I am trying to get my development environment setup on a new computer.</p>\n\n<pre><code>git clone -o heroku git@heroku.com:theirapp.git\ncd theirapp\nbundle\nFetching gem metadata from https://rubygems.org/......\nFetching gem metadata from https://rubygems.org/..\nCould not find jquery-rails-2.0.0 in any of the sources\n</code></pre>\n\n<p>After googling this error, the response seems to be to delete <code>Gemfile.lock</code>, then running <code>bundle</code> again. This works, but then I have different versions of gems where I haven't specified a version in <code>Gemfile</code>. Is there a way to fix this error without deleting <code>Gemfile.lock</code>? I'm using Rails 3.2 and Ruby 1.9.3.</p>\n"},{"tags":["ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":166,"score":0,"question_id":10819981,"title":"NameError: uninitialized constant CarrierWave::Backgrounder::Delay","body":"<p>I'm using Rails 3.2.3 and Carrierwave 1.8.21</p>\n\n<p>trying to install Carrierwave_backgrounder according to the instructions in <a href=\"https://github.com/lardawge/carrierwave_backgrounder\" rel=\"nofollow\">https://github.com/lardawge/carrierwave_backgrounder</a> result in </p>\n\n<pre><code>NameError: uninitialized constant CarrierWave::Backgrounder::Delay \n</code></pre>\n\n<p>because of the following line which is added to the uploader</p>\n\n<pre><code>include ::CarrierWave::Backgrounder::Delay\n</code></pre>\n\n<p>I tried without including this line and the result is duplicate processing of the images (both delayed and not delayed)</p>\n\n<p>how do I fix that ?</p>\n"},{"tags":["ruby-on-rails-3","formtastic","client-side-validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13276467,"title":"Not seeing custom error output using client_side_validations and formtastict","body":"<p>I can't seem to get the custom error display I would like, I've uncommented the text in config/initializers/client_side_validations.rb and created a rails.validations.actionView.js as described in the documentation but when debugging the form I can't seem to get the customized file to be used (I've also placed some breakpoints on the rails.validations.js file and it isn't hitting the add or remove there so perhaps that is the problem. All files are loaded through the asset pipeline and to my knowledge fully. </p>\n\n<pre><code>gem 'rails', '3.2.8'\ngem 'formtastic'\ngem 'client_side_validations' , '3.2.0'\ngem 'client_side_validations-formtastic'\n</code></pre>\n\n<p>actionView.js</p>\n\n<pre><code>window.ClientSideValidations.formBuilders['ActionView::Helpers::FormBuilder'] = {\nadd: function(element, settings, message) {\n// custom add code here\nconsole.log('added')\n },\nremove: function(element, settings) {\nconsole.log('removed');}}\n</code></pre>\n\n<p>_form.html.erb</p>\n\n<pre><code>&lt;%= semantic_form_for @sponsorship, :validate =&gt; true do |f| %&gt;\n  &lt;%= f.inputs do %&gt;\n    &lt;%= f.input :title, :hint =&gt; \"Give us a title\" %&gt;\n     &lt;%= f.input :bio %&gt;\n    &lt;%= f.input :blurb %&gt;\n    &lt;%= f.input :category_id, :as =&gt; :select, :collection =&gt; Category.all, :label_method =&gt; :title %&gt;\n    &lt;%= f.input :event_id, :as =&gt; :select, :collection =&gt; Event.all, :label_method =&gt; :title %&gt;\n    &lt;%= f.input :date_end, :start_year =&gt; 2012, :as =&gt; :date_picker %&gt;\n    &lt;%= f.input :funds_needed %&gt;\n    &lt;%= f.input :user_id, :as =&gt; :hidden, :input_html =&gt; { :value =&gt; current_user.id } %&gt;\n    &lt;%= f.input :agree_to_terms %&gt;\n    &lt;%= f.validate %&gt;\n  &lt;% end %&gt;\n\n  &lt;%= f.actions do %&gt;\n    &lt;%= f.action :submit, :as =&gt; :input %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>HTML Output in head</p>\n\n<pre><code>&lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery-ui.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.formtastic.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.customValidators.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/rails.validations.actionView.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>client_side_validation.rb</p>\n\n<pre><code>require 'client_side_validations/simple_form' if defined?(::SimpleForm)\nrequire 'client_side_validations/formtastic'  if defined?(::Formtastic)\n\n ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|\n   unless html_tag =~ /^&lt;label/\n     %{&lt;div class=\"toto\"&gt;&lt;div class=\"field_with_errors\"&gt;#{html_tag}&lt;/div&gt;&lt;label for=\"#{instance.send(:tag_id)}\" class=\"message\" style=\"float:right;\"&gt;#{instance.error_message.first}&lt;/label&gt;&lt;/div&gt;}.html_safe\n   else\n     %{&lt;div class=\"toto\"&gt;#{html_tag}&lt;/div&gt;}.html_safe\n   end\n end\n</code></pre>\n\n<p>I'm new to rails so I've probably gaffed somewhere. Any questions let me know! Thanks for reading. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":11668325,"title":"Render custom page/s after validation fails","body":"<p>I'm using the High Voltage gem (https://github.com/thoughtbot/high_voltage/) for a site with masses of static pages. The site has three unique forms all which are handled by the 'forms' controller/model. </p>\n\n<p>Now all is working well when fields which requires validation are populated, but when validation fails it jumps from the 'pages' controller (High Voltage) back to the 'forms' controller and renders /form/new, instead of, for instance, /pages/quotes - which is understandable as it's default behaviour.</p>\n\n<p>I'm also checking for validation in the form:</p>\n\n<pre><code>= form_for @form, :validate =&gt; true do |f|\n  - if @form.errors[:name].present?\n    .control-group.error\n      = f.label \"Your Name\"\n      = f.text_field :name\n  - else\n    = f.label \"Your Name\"\n    = f.text_field :name\n</code></pre>\n\n<p>Any idea how I can re-render the current page (which renders the specific form) after validation fails instead of directing to /forms/new</p>\n\n<p>Any advice appreciated, thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13275821,"title":"Override attributes keys in FactoryGirl","body":"<p>I have a model <code>Post</code> with an attribute <code>published_at</code>.\nHowever, in POST request API requires it to be assigned as <code>published</code>, not <code>published_at</code>.\nSo in my model I override setter method like so</p>\n\n<pre><code>def published=(value)\n  self.published_at = value\nend\n</code></pre>\n\n<p>The problem is, in my API tests, I use FactoryGirl's <code>attributes_for(:post)</code> method to generate attributes for POST request, and it uses old <code>published_at</code> name. How can I workaround this problem and generate attributes with <code>published</code> key instead of <code>published_at</code> without changing the name of this attribute in my model?</p>\n"},{"tags":["ruby-on-rails-3","caching","memcached","activeadmin","sweeper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":11600087,"title":"How do I expire home page cache when an article is updated?","body":"<p>I'm attempting to use a sweeper to clear the home page index action when a new article is published.</p>\n\n<p>The home page cache is working fine in development environment and expires after 1 minute. However when an article is saved, the sweeper action is not triggered.</p>\n\n<pre><code>class HomeController &lt; ApplicationController\n  caches_action :index, :expires_in =&gt; 1.minute\n  cache_sweeper :article_sweeper\n  def index\n    @articles = Article.published.limit(5)\n  end\nend\n\nclass ArticleSweeper &lt; ActionController::Caching::Sweeper\n  observe Article\n  def after_update(article)\n    expire_action(:controller =&gt; 'home', :action =&gt; 'index')\n  end\nend\n</code></pre>\n\n<p>Either I've gone wrong somewhere or a different approach is needed to expire the home page cache.</p>\n\n<p>My app uses ActiveAdmin to update articles, and Dalli for Memcache (as I'll be using Heroku).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13275814,"title":"undefined method `destroy' for nil:NilClass","body":"<p>My app successfully creates rows for a table every time a user submits some stats. Now I want to provide a delete button to be able to delete some rows. </p>\n\n<p>When I click the delete button I get the error: </p>\n\n<pre><code>undefined method `destroy' for nil:NilClass\n</code></pre>\n\n<p>Seems like either rails doesn't understand the destroy method in this case for whatever reason, or rails doesn't see anything to destroy, hence the nil:NilClass. </p>\n\n<p>My first question is in identifying which is the case, if either of those. </p>\n\n<p>My second question is fixing it :D</p>\n\n<p>Here's my show.html:</p>\n\n<pre><code>&lt;% provide(:title, \"Log\" ) %&gt;\n&lt;% provide(:heading, \"Your Progress Log\") %&gt;\n\n&lt;div class=\"row\"&gt;  \n  &lt;div class=\"span8\"&gt;\n    &lt;% if @user.status_update.any? %&gt;\n      &lt;h3&gt;Status Updates (&lt;%= @user.status_update.count %&gt;)&lt;/h3&gt;    \n      &lt;table&gt;\n        &lt;thead&gt;\n          &lt;tr&gt;\n            &lt;th&gt;Entry Date&lt;/th&gt;\n            &lt;th&gt;Weight&lt;/th&gt;\n            &lt;th&gt;BF %&lt;/th&gt;\n            &lt;th&gt;LBM&lt;/th&gt;\n            &lt;th&gt;Fat&lt;/th&gt;\n            &lt;th&gt;Weight Change&lt;/th&gt;\n            &lt;th&gt;BF % Change&lt;/th&gt;\n            &lt;th&gt;Fat Change&lt;/th&gt;\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n      &lt;tbody class = \"status updates\"&gt;\n          &lt;%= render @status_updates %&gt;\n      &lt;/tbody&gt;        \n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The \"&lt;%= render @status_updates %>\" calls the _status_update partial. </p>\n\n<pre><code> &lt;tr&gt;\n .\n .\n .\n . \n &lt;% if current_user==(status_update.user) %&gt; \n &lt;td&gt;\n       &lt;%= link_to \"delete\", status_update, method: :delete %&gt;\n\n &lt;/td&gt;\n &lt;%  end  %&gt;         \n\n&lt;/tr&gt;                                    \n</code></pre>\n\n<p>And then finally, here is the StatusUpdateController</p>\n\n<pre><code>def destroy\n    @status_update.destroy\n    redirect_to root_url\nend\n</code></pre>\n\n<p>Here are the parameters on the error page:</p>\n\n<pre><code>{\"_method\"=&gt;\"delete\",\n \"authenticity_token\"=&gt;\"w9eYIUEd2taghvzlo7p3uw0vdOZIVsZ1zYIBxgfBymw=\",\n \"id\"=&gt;\"106\"}\n</code></pre>\n"},{"tags":["sql","ruby-on-rails-3","postgresql","activerecord","subquery"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":107,"score":3,"question_id":13133553,"title":"Rails 3 Applying limit and offset to subquery","body":"<p>I have a query that goes something like this (in song.rb):</p>\n\n<pre><code>def self.new_songs\n  Song.where(id: Song.grouped_order_published).select_important_stuff\nend\n</code></pre>\n\n<p>Later on in my app, it is then passed the limit and offset, lets say in the controller:</p>\n\n<pre><code>@songs = Song.new_songs.limit(10).offset(10)\n</code></pre>\n\n<p>The way my app is structured, I'd like to keep this method of setting things, but unfortunately it is really slow as it is limiting the outer query rather than the subquery.</p>\n\n<p>Is there a way I can expose the subquery such that it receives the limit and offset rather than the outer query?</p>\n\n<p><strong>Edit</strong>: I should add I am using postgres 9.2.</p>\n\n<p><strong>Edit 2</strong>:  The reason why I want to do it in this fashion is I am doing pagination and I need to get the \"count\" of the total number of rows.  So I do something like this:</p>\n\n<pre><code>@songs = Song.new_songs\n...\n@pages = @songs.count / 10\n...\nrender @songs.limit(params[:page]).offset(0)\n</code></pre>\n\n<p>If I were to change it somehow, I'd have to redo this entirely (which is in a ton of places).  By not limiting it until it's actually called, I can do the count in between and then get just the page at the end.  I guess I'm looking more for advice on how this can be done with the inner query, without becoming horribly slow as the database grows.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","nginx","unicorn"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":413,"score":0,"question_id":10435978,"title":"Error Messages Showing in Production - Ruby on Rails 3.1, Nginx, Unicorn","body":"<p>I have a Rails 3.1 app running in production using Nginx and Unicorn. And for some reason, my custom 404 and 500 html error pages are not showing. Instead I'm getting the actual error message (\"Routing Error\", for example).</p>\n\n<p>In my production.rb file, I have <code>config.consider_all_requests_local = false</code></p>\n\n<p>And on the same server with a nearly identical configuration, I have a 'staging' site that works just fine. The only difference, as far as I can tell, is that the production one has SSL while the staging does not.</p>\n\n<p>Here is the Nginx config for the production app:</p>\n\n<pre><code>upstream unicorn_myapp_prod {\n  server unix:/tmp/unicorn.myapp_prod.sock fail_timeout=0;\n}\n\nserver {\n  listen 80;\n\n  server_name myapp.com;\n\n  root /home/deployer/apps/myapp_prod/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn_myapp_prod;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n\n\nserver {\n  listen 443 default;\n  ssl on;\n  ssl_certificate /home/deployer/apps/myapp_prod/shared/ssl_certs/myapp_prod.crt;\n  ssl_certificate_key /home/deployer/apps/myapp_prod/shared/ssl_certs/myapp_prod.key;\n\n\n  server_name myapp.com;\n\n  root /home/deployer/apps/myapp_prod/current/public;\n\n  location ^~ /assets/ {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  try_files $uri/index.html $uri @unicorn;\n  location @unicorn {\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header Host $http_host;\n    proxy_redirect off;\n    proxy_pass http://unicorn_myapp_prod;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}\n</code></pre>\n\n<p>Any ideas? Thanks!</p>\n"},{"tags":["javascript","ruby-on-rails-3","jquery-ui"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13240776,"title":"How to fix broken JQueryUI Datepicker","body":"<p>I have a JQueryUI datepicker defined as follows:</p>\n\n<pre><code>$(function() {\n  $(\".visit_date\").datepicker({\n    changeMonth: true,\n    changeYear: true,\n    showButtonPanel: true,\n    dateFormat: \"yy-mm-dd\"\n  });\n});\n</code></pre>\n\n<p>The view code which produces the Datepicker text box is</p>\n\n<pre><code>&lt;td&gt;&lt;%= f.label :visit_date %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;%= text_field_tag :visit_date, @visit.visit_date, :class =&gt; 'visit_date'\n</code></pre>\n\n<p>and the view, when rendered, is generated between tags like this:</p>\n\n<pre><code>&lt;div id=\"action_window\"&gt;\n   (rendered HTML to be acted on by user) \n&lt;/div&gt;\n</code></pre>\n\n<p>Why doesn't the Javascript selector \".visit_date\" hook up with this view? In other words, without the \"action_window\" tags it used to work. My thinking was that \".visit_date\" would match anything with class \"visit_date\".</p>\n\n<p>======================\nUPDATE on 11/7/2012. Javascript code:</p>\n\n<pre><code>$(function() {\n  $(\"#visit_date\").datepicker({\n    changeMonth: true,\n    changeYear: true,\n    showButtonPanel: true,\n    dateFormat: \"yy-mm-dd\"\n});   \n</code></pre>\n\n<p>});    </p>\n\n<p>The original place where the user pushes the button:</p>\n\n<pre><code>&lt;%= link_to \"Add Visit\", new_client_visit_path(@client), :remote =&gt; true, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>In VisitsController: </p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.js { }\nend\n</code></pre>\n\n<p>In views/visits/new.js.erb:</p>\n\n<pre><code>$('#action_window').html('&lt;%= escape_javascript render(:partial =&gt; \"new\") %&gt;');\n$('#action_window').show;\n</code></pre>\n\n<p>(#action_window is a div in the Client index view)</p>\n\n<p>In views/visits/_new.html.erb:</p>\n\n<pre><code>&lt;%= render \"form\" %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>In views/visits/_form.html.erb:</p>\n\n<pre><code>%= form_for [@client, @visit] do |f| %&gt;\n&lt;td&gt;&lt;%= text_field_tag :visit_date, @visit.visit_date, :class =&gt; 'visit_date' %&gt;\n</code></pre>\n\n<p>I have not been able to get the Datepicker to work, presumably because the HTML creating the \"New Visit\" view is rendered, and somehow JQueryUI can't associate it without that \"hasDatepicker\" thing added to the class.</p>\n"},{"tags":["ruby-on-rails-3","performance","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13271561,"title":"ActiveRecord: Is it possible to get the number of DB queries executed in addition to total time in the Rails log?","body":"<p>For every request, I get this in the logs:</p>\n\n<pre><code>Completed 200 OK in 854ms (Views: 1.0ms | ActiveRecord: 17.0ms)\n</code></pre>\n\n<p>Is it possible to get it to also include the number of queries?<br>\nSomething like:</p>\n\n<pre><code>Completed 200 OK in 854ms (Views: 1.0ms | ActiveRecord: 17.0ms | Queries: 10)\n</code></pre>\n\n<p>Ideally, I'd like all the \"cached\" ones to show up in that count too. Ie, even if the \"cache\" is saving me from \"N+1\" queries from hitting the DB, I still want to know I have a problem.</p>\n\n<p>I'm fine with monkeypatching / manually editing something, since I really want this just for my dev box. </p>\n\n<p>(If this can be made civilizedly so I can have it in production, that's even better, but if not, I'm fine with just having a manually modified Rails in my own machine)</p>\n\n<p>Thanks!<br>\nDaniel</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13266999,"title":"passing params through a link_to rails 3","body":"<p>Im just looking for some clarification on the following piece of code, well part of it.To give some background i have an app where you can upload recipes, search recipes and save them as favourites, this piece of code is in a controller \"recipes\", action is \"my_recipes\"</p>\n\n<pre><code>&lt;%= link_to \"Add to favorites\",  {:controller =&gt; 'favourites', :action =&gt; 'create', :recipe_id =&gt; recipe.id}, {:method =&gt; :post } %&gt;\n</code></pre>\n\n<p>My understanding is that this creates a link_to (anchor tag if you will) that makes a post request through the create method within the favourites controller. This part I think i underdstand (corrections welcome), the part i am unsure of is </p>\n\n<pre><code>:recipe_id =&gt; recipe.id}\n</code></pre>\n\n<p>I know this is passing the recipe_id for example but I would like to know why we do this? and what relevance of the <code>:</code> before the first recipe_id.May seem obvious to some but you dont know until you learn.</p>\n\n<p>Any help appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pusher"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13267972,"title":"How do I include the users in the result set?","body":"<pre><code>comments = Song.find(65).comments.select('comments.*, users.*').includes(:user).limit(20) \n</code></pre>\n\n<p>How would I include the users in the result set?</p>\n\n<p>Im using the <a href=\"http://pusher.com/\" rel=\"nofollow\">PusherApp</a> and trying to do:</p>\n\n<pre><code>    Pusher[\"foo\"].trigger(\"bar\", { \n      :comments =&gt; comments\n    })\n</code></pre>\n"},{"tags":["ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13273188,"title":"Conditions not working when rendering partial via ajax","body":"<p>In my <strong>index.js.erb</strong></p>\n\n<pre><code>$(\".div\").html(\"&lt;%= escape_javascript(render('something/some_form')) %&gt;\");\n</code></pre>\n\n<p>in <strong>some_form.htm.erb</strong> i have condition which is not working</p>\n\n<pre><code>&lt;% if @variable1 == @variable2 %&gt; \n   show something1\n&lt;% else %&gt;\n   show something2\n&lt;% end %&gt;\n</code></pre>\n\n<p>For some reason when my js.erb renders this partial i always have <em>show something2</em>. So &lt;% if @variable1 == @variable2 %> condition not working</p>\n\n<p>variable1 and variable2 defined in my controller</p>\n\n<p>How can i make this equal condition work?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13271301,"title":"How to configure sequence separator of friendly_id gem","body":"<p>I am using the friendly_id gem version 4.0.9 in Rails 3, and I want to change the default sequence separator from <code>-</code> to <code>_</code>.</p>\n\n<p>I tried  this but it doesn't work:</p>\n\n<pre><code>class Restaurant &lt; ActiveRecord::Base\n   extend FriendlyId\n   friendly_id do |config|\n     config.base = :name\n     config.use :slugged\n     config.sequence_separator = \"_\"\n   end\n  .....\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":35,"score":1,"question_id":13270672,"title":"Parse original email address of the sender of a forwarded email in Ruby","body":"<p>Let's say that below is a sample content of emails I am receiving.</p>\n\n<pre><code> ---------- Forwarded message ----------\n From: Original Sender &lt;original.sender@gmail.com&gt;\n Date: 2012/10/23\n Subject: Lorem Ipsum\n To: recipient@example.com\n</code></pre>\n"},{"tags":["mysql","ruby-on-rails-3","redhat","openshift"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13274681,"title":"Redhat openshift - rails mysql response takes more than 20sec","body":"<p>I have rails (v3.0.9) with mysql running on Redhat open shift. </p>\n\n<p>I have seen that it takes around <strong>35-40 sec</strong> to get JSON response made up of all records from a single table. There are around 10000 records in this single table.</p>\n\n<p>Is there any way to make it faster? i.e To get the response atleast within 10sec.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13274740,"title":"Issues executing Update.js","body":"<p>I have a controller where the update action responds to js. Everything is going fine but I'm experiencing some really bizarre behavior. Her is my code:</p>\n\n<pre><code>&lt;% if @contact.errors.any? %&gt;\n&lt;% else %&gt;\n  alert('What!?!');\n  $(\"li#contact\").replaceWith(\"&lt;%= escape_javascript render @contact %&gt;\");\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I have no errors, I'm able to replace my list item. However nothing before or after this line with run. The alert will not pop, any other manipulation will not run. Even cutting down the code to:</p>\n\n<pre><code>&lt;% if @contact.errors.any? %&gt;\n    &lt;% else %&gt;\n      alert('What!?!');\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I can not get it to alert. I know I don't have error rendering yet but what I'm executing has no errors. Has anyone experienced with wonky behavior before? (create.js, destroy.js all work fine).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13091638,"title":"How to override enumeration data in rail_admin gem","body":"<p>In my models, BookHeader has many Category\nSo, when edit or create new BookHeader, the form show like this\n<a href=\"http://nr7.upanh.com/b3.s32.d2/89392864d0eb4a6e3988ab7b137ff7fa_50339337.catetgoryfix.png\" rel=\"nofollow\">Enum fix?</a></p>\n\n<p>I wanna change the \"category #{id}\" to category name by define a category_enum method but it still don't work. Please help!</p>\n\n<p>Code for BookHeader model</p>\n\n<pre><code>class BookHeader &lt; ActiveRecord::Base\n  attr_accessible :autho, :category_id, :description, :title, :book_type, :year,:publisher_id,:detail\n  has_many :books\n  belongs_to :category\n  belongs_to :publisher\n  TYPE = {:ebook=&gt;\"Ebook\",:paper_book=&gt; \"PaperBook\",:magazine=&gt; \"Magazine\",:media=&gt; \"Media\"}\n  DEFAULT_TAB = :paper_book\n  BOOKS_PER_PAGE = 1 # books to show in a pages (pagination)\n  extend FriendlyId\n  def book_type_enum #it worked here\n    TYPE.map{|key, val| [val]}\n  end\n  def category_enum #but dont' work here\n    [\"a\",\"b\"]\n  end\n</code></pre>\n\n<p>Code for edit form</p>\n\n<pre><code>edit do\n        field :title\n        field :description, :text do\n          ckeditor do true end\n        end\n        field :autho\n        field :book_type\n        field :category\n      end\n</code></pre>\n\n<p>See the Division attribute in <a href=\"http://rails-admin-tb.herokuapp.com/admin/team/73/edit\" rel=\"nofollow\">this link</a></p>\n"},{"tags":["ruby-on-rails-3","gmaps4rails"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":350,"score":1,"question_id":9425816,"title":"gmaps4rails - Drop a marker and update fields attribute in a form","body":"<p>I'm trying to implement this, from the gem wiki <a href=\"https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Javascript-goodies\" rel=\"nofollow\">https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Javascript-goodies</a></p>\n\n<pre><code>&lt;% content_for :scripts do %&gt;\n    &lt;script type=\"text/javascript\" charset=\"utf-8\"&gt;\n        var markersArray = [];\n        // On click, clear markers, place a new one, update coordinates in the form\n        Gmaps.map.callback = function() {\n            google.maps.event.addListener(Gmaps.map.map, 'click', function(event) {\n              clearOverlays();\n              placeMarker(event.latLng);\n              updateFormLocation(event.latLng);\n            });\n        };\n        // Update form attributes with given coordinates\n        function updateFormLocation(latLng) {\n            $('location_attributes_latitude').value = latLng.lat();\n            $('location_attributes_longitude').value = latLng.lng();\n            $('location_attributes_gmaps_zoom').value = Gmaps.map.map.getZoom();\n        }\n        // Add a marker with an open infowindow\n        function placeMarker(latLng) {\n            var marker = new google.maps.Marker({\n                position: latLng, \n                map: Gmaps.map.map,\n                draggable: true\n            });\n            markersArray.push(marker);\n            // Set and open infowindow\n            var infowindow = new google.maps.InfoWindow({\n                content: '&lt;div class=\"popup\"&gt;&lt;h2&gt;Awesome!&lt;/h2&gt;&lt;p&gt;Drag me and adjust the zoom level.&lt;/p&gt;'\n            });\n            infowindow.open(Gmaps.map.map,marker);\n            // Listen to drag &amp; drop\n            google.maps.event.addListener(marker, 'dragend', function() {\n                updateFormLocation(this.getPosition());\n            });\n        }\n        // Removes the overlays from the map\n        function clearOverlays() {\n          if (markersArray) {\n            for (var i = 0; i &lt; markersArray.length; i++ ) {\n              markersArray[i].setMap(null);\n            }\n          }\n          markersArray.length = 0;\n        }\n    &lt;/script&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But with no luck...I'm guessing its more of an issue with the name/id of my field(s), pardon my javascript knowledge.</p>\n\n<p>I've changed the fields to update with the coordinates:</p>\n\n<pre><code>function updateFormLocation(latLng) {\n  $('location[lat]').value = latLng.lat();\n  ...\n}\n</code></pre>\n\n<p>But the field doesn't get updated:</p>\n\n<pre><code>= simple_form_for :location do |l|\n  = l.input :lat\n  ...\n</code></pre>\n\n<p>Am I missing something? Thanks!</p>\n"},{"tags":["ruby-on-rails-3","ubuntu","apache2","passenger","spawning"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13273952,"title":"Ubuntu - Apache - Rails - Passenger - Spawning error","body":"<p>I've got the error where passenger complains that:</p>\n\n<pre><code>*** Passenger ERROR (ext/common/ApplicationPool/../SpawnManager.h:220):\nCould not start the spawn server: /usr/local/rvm/gems/ruby-1.9.3-head/ruby: No such file or directory (2)\n[ pid=8970 thr=139698295748416 file=ext/apache2/Hooks.cpp:865 time=2012-11-07 17:17:32.422 ]: Unexpected error in mod_passenger: Cannot spawn application '/www/lensfinder.se/ruby/lensfinder': Could not read from the spawn server: Connection reset by peer (104)\n  Backtrace:\n     in 'virtual Passenger::SessionPtr Passenger::ApplicationPool::Client::get(const Passenger::PoolOptions&amp;)' (Client.h:750)\n     in 'Passenger::SessionPtr Hooks::getSession(const Passenger::PoolOptions&amp;)' (Hooks.cpp:297)\n     in 'int Hooks::handleRequest(request_rec*)' (Hooks.cpp:566)\n</code></pre>\n\n<p>From what I can read is that it cant access /www/lensfinder.se/ruby/lensfinder though it exist.</p>\n\n<p>And I found this FAQ on <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#_the_apache_error_log_says_that_the_spawn_manager_script_does_not_exist_or_that_it_does_not_have_permission_to_execute_it\" rel=\"nofollow\">Phusion Passengers site</a></p>\n\n<p>The problem is that, when I try to use that command, </p>\n\n<pre><code>passenger-config --root\n</code></pre>\n\n<p>I get this: </p>\n\n<pre><code>-bash: /usr/bin/passenger-config: ruby: bad interpreter: No such file or directory\n</code></pre>\n\n<p>apache config:</p>\n\n<pre><code>LoadModule passenger_module /usr/local/rvm/gems/ruby-1.9.3-head/gems/passenger-3.0.12/ext/apache2/mod_passenger.so\n   PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-head/gems/passenger-3.0.12\n   PassengerRuby /usr/local/rvm/wrappers/ruby-1.9.3-head/ruby\n\n&lt;VirtualHost 10.0.0.37:80&gt;\n    ServerAdmin webmaster@compartment.se\n    DocumentRoot /www/lensfinder.se/htdocs\n    ServerName lensfinder.se\nRedirect 301 / http://www.lensfinder.se/\n    ErrorLog /var/log/apache2/lensfinder.se-error.log\n    CustomLog /var/log/apache2/lensfinder.se-access.log combined\n&lt;/VirtualHost&gt;\n&lt;VirtualHost 10.0.0.37:80&gt;\n    ServerAdmin hostmaster@compartment.se\n    ServerName lensfinder.se\n    ServerAlias www.lensfinder.se\n    ServerAlias *.lensfinder.se\n#   DocumentRoot /www/lensfinder.se/htdocs\n    DocumentRoot /www/lensfinder.se/ruby/lensfinder/script\n    &lt;Directory /&gt;\n        Options FollowSymLinks\n        AllowOverride all\n    &lt;/Directory&gt;\n    &lt;Directory /www/lensfinder.se/htdocs&gt;\n        Options Indexes FollowSymLinks MultiViews\n        AllowOverride None\n        Order allow,deny\n        allow from all\n    &lt;/Directory&gt;\n    ScriptAlias /cgi-bin/ /www/lensfinder.se/cgi-bin/\n    &lt;Directory \"/www/lensfinder.se/cgi-bin\"&gt;\n        AllowOverride None\n        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n        Order allow,deny\n        Allow from all\n        AllowOverride AuthConfig\n#Options Includes\n#Options FollowSymLinks\n#Options +Indexes +Multiviews +FollowSymLinks\n    &lt;/Directory&gt;\n    &lt;Directory \"/www/lensfinder.se/htdocs/usage\"&gt;\n        AllowOverride None\n        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n        Order allow,deny\n        Allow from all\n        AllowOverride AuthConfig\n#Options Includes\n#Options FollowSymLinks\n#Options +Indexes +Multiviews +FollowSymLinks\n    &lt;/Directory&gt;\n    ErrorLog /var/log/apache2/lensfinder.se-error.log\n    # Possible values include: debug, info, notice, warn, error, crit,\n    # alert, emerg.\n    LogLevel warn\n    CustomLog /var/log/apache2/lensfinder.se-access.log combined\n    Alias /doc/ \"/usr/share/doc/\"\n    &lt;Directory \"/usr/share/doc/\"&gt;\n        Options Indexes MultiViews FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n        Allow from 127.0.0.0/255.0.0.0 ::1/128\n    &lt;/Directory&gt;\n\n\nAlias /ruby/ /www/lensfinder.se/ruby/lensfinder/script\n        &lt;Directory /www/lensfinder.se/ruby/lensfinder/script&gt;\n#       Options ExecCGI\n#       AddHandler cgi-script .cgi\n#       Addhandler fastcgi-script .fcgi .fcg .fpl\n        AllowOVerride all\n        Order allow,deny\n        Allow from all\n        &lt;/Directory&gt;\n\n&lt;IfModule passenger_module&gt;\n   PassengerRoot /usr/local/rvm/gems/ruby-1.9.3-head/gems/passenger-3.0.12\n   PassengerRuby /usr/local/rvm/gems/ruby-1.9.3-head/ruby\n&lt;/IfModule&gt;\n\nRailsEnv production\nRailsBaseURI /script\n\n\n\n#\n&lt;Location /&gt;\n# Insert filter\nSetOutputFilter DEFLATE\n\n# Netscape 4.x has some problems...\nBrowserMatch ^Mozilla/4 gzip-only-text/html\n\n# Netscape 4.06-4.08 have some more problems\nBrowserMatch ^Mozilla/4\\.0[678] no-gzip\n\n# MSIE masquerades as Netscape, but it is fine\n# BrowserMatch \\bMSIE !no-gzip !gzip-only-text/html\n\n# NOTE: Due to a bug in mod_setenvif up to Apache 2.0.48\n# the above regex won't work. You can use the following\n# workaround to get the desired effect:\nBrowserMatch \\bMSI[E] !no-gzip !gzip-only-text/html\n\n# Don't compress images\nSetEnvIfNoCase Request_URI \\\n\\.(?:gif|jpe?g|png)$ no-gzip dont-vary\n\n# Make sure proxies don't deliver the wrong content\n#Header append Vary User-Agent env=!dont-vary\n&lt;/Location&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc","asset-pipeline","view-inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13260900,"title":"With Rails 3 view inheritance, is it possible to call \"super\" within a child view, but send the parent variables?","body":"<p>Every <code>show</code> action in my app has the same template for every model (it is an Admin-portal type interface). I have a view <code>show.html.erb</code> that all of these models inherit. </p>\n\n<p>The controllers all use InheritedResources, so I have access to some helper variables such as <code>resource</code>, which I use to display the attributes for the model being shown through <code>resource.attributes</code> in my parent view.</p>\n\n<p>What I would like to be able to do is whitelist which attributes are being shown in each model. I have thought of two ways to do this... the first is to define some method in a class my model's inherit from, say it is called <code>attr_visible</code> and define each attribute in the model. The reason I don't like this approach is that it puts too much of the view logic in the models. I would rather provide my views with the model, and let the view determine what is displayed.</p>\n\n<p>The second approach is what this question is about. I want to have a file <code>/app/views/users/show.html.erb</code>, and set which attributes for a User I would like to be shown, say something like:</p>\n\n<pre><code>@attributes = [:name, :email, :etc]\n</code></pre>\n\n<p>And then pass them to the parent view which I described in the beginning of this question. That view would then be able to loop through <code>@attributes</code> and display the attributes necessary.</p>\n\n<p>Is it possible to use a \"<code>super</code>\"-type method from views? Everything I have read about view inheritance suggests the view is loaded based on where it is located in the directory structure, and then after that you're out of luck.</p>\n\n<p>edit: I have sort of done what I want. I defined a partial _show.html.erb in the /app/views/users directory that looks like:</p>\n\n<pre><code>&lt;% @attributes = ['name', ...] %&gt;\n</code></pre>\n\n<p>And then in the parent view I call <code>&lt;%= render \"show\" %&gt;</code> before looping through <code>@attributes</code>. This works, but feels clunky since I am not actually rendering anything when I call <code>render</code>. Is there a better way?</p>\n"},{"tags":["ruby-on-rails-3","file-upload","carrierwave","rackspace","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":12922980,"title":"Fog::Storage::Rackspace::NotFound error when using Carrierwave to upload to Rackspace","body":"<p>Everyone: I already searched the error before I posted this to Stackoverflow, so no need to point me to this: groups.google.com/forum/?fromgroups=#!topic/carrierwave/ It's not the same problem.</p>\n\n<p>I'm using Carrierwave so users can upload files to my Rackspace container. But when I Submit from my site (on my local machine, still in test mode), I get a <strong>Fog::Storage::Rackspace::NotFound</strong> app/controllers/authors_controller.rb:8:in `update' error. My Rackspace container is called kontainer.ofstuff. Here's my code:</p>\n\n<p>pic_uploader.rb: </p>\n\n<pre><code>class PicUploader &lt; CarrierWave::Uploader::Base\n\n  include Rails.application.routes.url_helpers\n  storage :fog\n\n  def store_dir\n    \"#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n</code></pre>\n\n<p>model author.rb</p>\n\n<pre><code>class Author &lt; ActiveRecord::Base\n  attr_accessible :stuff, :profilepic\n\n  mount_uploader :pic, PicUploader\n\n  def dostuff\n  end\nend\n</code></pre>\n\n<p>carrierwave.rb is in the config/initializers directory</p>\n\n<pre><code>CarrierWave.configure do |config|\n\n  config.storage = :fog\n  config.fog_credentials = {\n    :provider           =&gt; 'Rackspace',\n    :rackspace_username =&gt; 'myusername',\n    :rackspace_api_key  =&gt; '98765asecretnumber3'\n  })\n  config.fog_directory = 'kontainer.ofstuff'\n  config.fog_host = 'https://34567secretnumberiiiii.ssl.cf2.rackcdn.com'\nend\n</code></pre>\n\n<p>controller authors_controller.rb</p>\n\n<pre><code>class AuthorsController &lt; ApplicationController\n\n  def update\n    @author = Author.find(params[:id])\n    @booklist = Book.where(:author_id =&gt; @author.id)\n#line 7\n    if @author.update_attributes(params[:author])\n      sign_in @author\n      redirect_to @author\n    else\n      render 'profileinfo'\n    end\n  end\nend\n</code></pre>\n\n<p>edit.html.erb:</p>\n\n<pre><code>&lt;%= f.file_field :pic %&gt;\n&lt;%= f.submit \"Save Author Info\" %&gt; \n</code></pre>\n\n<p>When I had this code 'uploading'/storing to a file, this worked fine. Perhaps f.submit does not work with Carrierwave? If not...where do I find the correct code for submitting?</p>\n\n<p>Any ideas what the trouble is?</p>\n"},{"tags":["ruby-on-rails-3","rubygems","imagemagick","rvm","rmagick"],"answer_count":7,"favorite_count":4,"up_vote_count":28,"down_vote_count":1,"view_count":18346,"score":27,"question_id":5201689,"title":"rmagick gem install \"Can't find Magick-config\"","body":"<p>I get the error shown below when attempting to install the rmagick gem. I am on Snowleopard 10.6 using RVM, Ruby 1.9.2-head and Rails 3.05. Responses to similar questions recommended installing ImageMagick, which I successfully did. Other suggested installing the \"libmagick9-dev library\", however, I can not figure out how to do this.</p>\n\n<p>I'm a new developer, and any assistance or directions to an existing explanation or resource is greatly appreciated. Thanks!</p>\n\n<pre><code>jjdevenuta(opal)$ gem install rmagick\nFetching: rmagick-2.13.1.gem (100%)\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rmagick:\nERROR: Failed to build gem native extension.\n\n/Users/jjdevenuta/.rvm/rubies/ruby-1.9.2-head/bin/ruby extconf.rb\nchecking for Ruby version &gt;= 1.8.5... yes\nchecking for gcc... yes\nchecking for Magick-config... no\nCan't install RMagick 2.13.1. Can't find Magick-config in /Users/jjdevenuta/.rvm/gems/ruby-1.9.2-head@rails3/bin:/Users/jjdevenuta/.rvm/gems/ruby-1.9.2-head@global/bin:/Users/jjdevenuta/.rvm/rubies/ruby-1.9.2-head/bin:/Users/jjdevenuta/.rvm/bin:/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/git/bin:/usr/X11/bin\n\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/jjdevenuta/.rvm/rubies/ruby-1.9.2-head/bin/ruby\n</code></pre>\n\n<p><strong>UPDATE</strong>\nIf you're a Mac/OS X user I would HIGHLY recommend using Homebrew as your package installer/manager. You can find it <a href=\"http://mxcl.github.com/homebrew/\">HERE</a>. Since originally asking this question I have removed all my prior installs of things like rmagick and imagemagick, and reinstalled them using Homebrew. Super easy with a huge catalog of packages, and updates/uninstalls are a cinch as well!</p>\n"},{"tags":["ruby-on-rails-3","html5","css3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13272118,"title":"twitter bootstrap drop down issue","body":"<p>Hi I am using twitter bootstrap for my website. I have put dropdown in collpsable which is in modal window. My problem is the dropdow I have put in collaspable inner, it cutoff the menu. Here is that Image<img src=\"http://i.stack.imgur.com/FeMgv.png\" alt=\"enter image description here\"></p>\n\n<p>It should show like this :\n <img src=\"http://i.stack.imgur.com/0dScs.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried by changing the z-index attribute but unable to show it. Can anybody know what is  the problem?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13230787,"title":"make variable available in all method of controller when passed in one method","body":"<p>Here i send the user.id as params dd</p>\n\n<pre><code>&lt;h3&gt;&lt;%= link_to(\"Lend Asset\", {:controller =&gt; 'empassets', :action=&gt; 'index', :dd =&gt; user.id})%&gt;&lt;/h3&gt;\n</code></pre>\n\n<p>In controller empassets i fetch it by </p>\n\n<pre><code>  def index\n     @id = params[:dd]\n     @empassets = Empasset.where(:ad =&gt; @id)\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @empassets }\n    end\n  end\n\n  def show\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def new\n     @id = params[:dd]\n    @empasset = Empasset.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @empasset }\n    end\n  end\n\n  def edit\n     @id = params[:dd]\n    @empasset = Empasset.find(params[:id])\n  end\n</code></pre>\n\n<p>I need this @id in all new show edit method. But it takes in index only as i mention it in index. How can i make such that if Lend asset is click then @id= params[:id] have value in all methods. How can it is possible to make it available for another @id = params[:id] is not send in that controller?</p>\n"},{"tags":["ruby-on-rails-3","cookies","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13272069,"title":"IE/Safari not saving/reading cookie properly CSRF?","body":"<p>I have a user model based off of Michael Hartl's Ruby on Rails Tutorial (Second Edition) It works fine in practice locally hosted from a linux box but when I deploy to Heroku there is a problem with IE ans Safari. (Chrome and firefox work great.) I use the cookie to set the value current_user which I call constantly on the site.</p>\n\n<p>here is my sessions_helper.rb</p>\n\n<pre><code>module SessionsHelper\n\n  def sign_in(user)\n    cookies.permanent[:remember_token] = user.remember_token\n    self.current_user = user\n  end\n\n  def signed_in?\n    !current_user.nil?\n  end\n\n  def current_user=(user)\n    @current_user = user\n  end\n\n  def current_user\n    @current_user ||= User.find_by_remember_token(cookies[:remember_token])\n  end\n\n  def current_user?(user)\n    user == current_user\n  end\n\n  def signed_in_user\n    unless signed_in?\n      store_location\n      redirect_to signin_url, notice: \"Please sign in.\" \n    end\n  end\n\n  def sign_out\n    self.current_user = nil\n    cookies.delete(:remember_token)\n  end\n\n  def redirect_back_or(default)\n    redirect_to(session[:return_to] || default)\n    session.delete(:return_to)\n  end\n\n  def store_location\n    session[:return_to] = request.url\n  end\nend\n</code></pre>\n\n<p>My sessions controller is as follows:\n    class SessionsController &lt; ApplicationController</p>\n\n<pre><code>  def new\n  end\n\n  def create\n    user = User.find_by_email(params[:session][:email].downcase)\n    if user &amp;&amp; user.authenticate(params[:session][:password])\n      sign_in user\n      redirect_back_or user\n    else\n      flash.now[:error] = 'Invalid email/password combination'\n      render 'new'\n    end\n  end\n\n  def destroy\n    sign_out\n    redirect_to root_url\n  end\n\nend\n</code></pre>\n\n<p>Again when I create a user/log in it looses my cookie only in IE8> and Safari.\nHere is the log I'm getting.</p>\n\n<pre><code>2012-11-06T19:28:08+00:00 app[web.1]: Started POST \"/sessions\" for XXX.XXX.XXX.XXX at  2012-11-06 19:28:08 +0000\n2012-11-06T19:28:08+00:00 app[web.1]: Processing by SessionsController#create as HTML\n2012-11-06T19:28:08+00:00 app[web.1]: Parameters: {\"utf8\"=&gt;\"â\", \"authenticity_token\"=&gt;\"Eh3xta4VHlHgBVEKiLn3CRKgWb5xFbAx91eNJlYFySs=\", \"session\"=&gt;{\"email\"=&gt;\"A@User.com\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Sign in\"}\n2012-11-06T19:28:08+00:00 app[web.1]: WARNING: Can't verify CSRF token authenticity\n2012-11-06T19:28:08+00:00 app[web.1]: Redirected to https://some-app_1234.herokuapp.com/users/1\n2012-11-06T19:28:08+00:00 app[web.1]: Completed 302 Found in 391ms (ActiveRecord: 16.1ms)\n2012-11-06T19:28:08+00:00 heroku[router]: POST some-app-1234.herokuapp.com/sessions dyno=web.1 queue=0 wait=0ms service=508ms status=302 bytes=114\n2012-11-06T19:28:09+00:00 app[web.1]:\n2012-11-06T19:28:09+00:00 app[web.1]:\n2012-11-06T19:28:09+00:00 app[web.1]: Started GET \"/users/1\" for XXX.XXX.XXX.XXX at     2012-11-06 19:28:09 +0000\n2012-11-06T19:28:09+00:00 app[web.1]: Processing by UsersController#show as HTML\n2012-11-06T19:28:09+00:00 app[web.1]: Parameters: {\"id\"=&gt;\"1\"}\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered shared/_stats.html.erb (205.2ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered microposts/_micropost.html.erb (15.0ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered users/show.html.erb within layouts/application (247.6ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered layouts/_shim.html.erb (0.0ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered layouts/_header.html.erb (1.2ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Rendered layouts/_footer.html.erb (0.3ms)\n2012-11-06T19:28:09+00:00 app[web.1]: Completed 200 OK in 256ms (Views: 52.5ms | ActiveRecord: 202.4ms)\n2012-11-06T19:28:09+00:00 heroku[router]: GET some-app-1234.herokuapp.com/users/1 dyno=web.1 queue=0 wait=0ms service=544ms status=200 bytes=2394\n</code></pre>\n"},{"tags":["ruby-on-rails-3","associations","rails-admin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13273019,"title":"Is it possible to create select field onchange event in rails admin","body":"<p>I have Two models with has_many relation and I am using rails admin.</p>\n\n<p>Well,I want a select field with on change event,which leads to load another select field values according to the selection of first select field in rails admin,should I need to make an ajax call,if so then where should I have to configure it.</p>\n\n<p>Please help me, thanks in advance. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13270656,"title":"Mailbox not sending e-mails: wrong number of arguments (1 for 0)","body":"<p>When sending a message I can see this in my console:</p>\n\n<pre><code>Sent mail to You should add method :mail_email in your Messageable model (2093ms\n)\nDate: Wed, 07 Nov 2012 14:08:50 +0100\nFrom: mail@myemail.com\nto: You should add method :mail_email in your Messageable model\n</code></pre>\n\n<p>And the initializers for the Mailbox gem:</p>\n\n<pre><code>Mailboxer.setup do |config|\n\n  #Configures if you applications uses or no the email sending for Notifications and Messages\n  config.uses_emails = true\n\n  #Configures the default from for the email sent for Messages and Notifications of Mailboxer\n  config.default_from = \"mail@myemail.com\"\n\n  #Configures the methods needed by mailboxer\n  config.email_method = :mail_email\n  config.name_method = :name\n\n  #Configures if you use or not a search engine and wich one are you using\n  #Supported enignes: [:solr,:sphinx] \n  config.search_enabled = false\n  config.search_engine = :solr\nend\n</code></pre>\n\n<p>In my user model I have: </p>\n\n<pre><code>acts_as_messageable\n  def name\n    email\n  end\n\n def mail_email\n    @mail_email = self.email\n end\n</code></pre>\n\n<p>But I get this error in view when sending a message:</p>\n\n<pre><code> ArgumentError in ConversationsController#reply\n\nwrong number of arguments (1 for 0)\n\nRails.root: C:/rails/sitesale\nApplication Trace | Framework Trace | Full Trace\n\napp/models/user.rb:17:in `mail_email'\napp/controllers/conversations_controller.rb:22:in `reply'\n</code></pre>\n\n<p>And the controller method reply:</p>\n\n<pre><code>  def reply\n    current_user.reply_to_conversation(conversation, *message_params(:body, :subject))\n    redirect_to conversation\n  end\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","rest"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13271690,"title":"Why does respond_with JSON not work?","body":"<p>I'm having a problem when trying to use the return to in a rails controller. This is not working:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\nrespond_to :json\n\n    def create\n        @user = User.create params[:user_info] \n        respond_with @user\n    end\nend\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\nrespond_to :json\n\n    def create \n        @user = User.create params[:user_info] \n        respond_with @user do |format|\n              format.json { render json: @user.to_json }\n        end\n    end\nend\n</code></pre>\n\n<p>Why? This is the error I have in the server's log when using the one that doesn't work:</p>\n\n<pre><code>NoMethodError (undefined method `user_url' for #&lt;UsersController:0x007fd44d83ea90&gt;):\napp/controllers/users_controller.rb:7:in `create'\n</code></pre>\n\n<p>My route is:    </p>\n\n<pre><code>resources :users, :only =&gt; [:create]\n</code></pre>\n"},{"tags":["ajax","ruby-on-rails-3","remote-forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13256716,"title":"Rails remote form complete handler fires but success/failure don't","body":"<p>I am submitting a form through rails, and the response is coming backing with 200 OK headers.  My complete event fires, but neither success nor failure fire.  Any ideas?</p>\n\n<p>The JS:</p>\n\n<pre><code>$('form#booking-email').bind('ajax:complete',function(){\n    alert('complete');\n\n});\n\n$('form#booking-email').bind('ajax:success',function(){\n    alert('success');\n});\n\n$('form#booking-email').bind('ajax:failure',function(){\n    alert('failure');\n\n});\n</code></pre>\n\n<p>My Controller</p>\n\n<pre><code> respond_to do |format|\n    format.json { head :ok }\n  end\n</code></pre>\n\n<p>The Response:</p>\n\n<pre><code>Status: 200 OK\n\nCache-Control: max-age=0, private, must-revalidate\n\nConnection: Keep-Alive\n\nContent-Length: 1\n\nContent-Type: application/json; charset=utf-8\n\nDate: Sat, 03 Nov 2012 01:00:11 GMT\n\nEtag: \"7215ee9c7d9dc229d2921a40e899ec5f\"\n\nServer: WEBrick/1.3.1 (Ruby/1.9.2/2012-02-14)\n\nSet-Cookie: _myeasybnb_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFRkkiJWQ3NTE2ODMzZjMyY2RhZTU1NjAwMzk3MWIyYjdhZDMzBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTFNN1hvWGhUdytSSjVRcCtrdWFLVTk5NnBEQWF5QXVxRlR2L1pwV1JjUmM9BjsARkkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsISSIJVXNlcgY7AEZbBmkGSSIiJDJhJDEwJEJ3Uy5lTzI3Ly4xY05xWlhGZzJ3cy4GOwBU--bd4de54c468e9cedc322949bba91adb5a60bb92f; path=/; HttpOnly\n\nX-Request-Id: 0bb75d4727fbe149b868214f39763030\n\nX-Runtime: 2.183082\n\nX-UA-Compatible: IE=Edge\n</code></pre>\n"},{"tags":["ruby-on-rails-3","capistrano","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":12710008,"title":"Could not find mysql2-0.3.11 in any of the sources (Bundler::GemNotFound)","body":"<p>I'm using Capistrano to deploy a Rails application on a staging environment. <code>cap deploy:update</code> works fine, but Passenger keeps reporting this\n<code>Could not find mysql2-0.3.11 in any of the sources (Bundler::GemNotFound)</code></p>\n\n<p>I did perform <code>bundle install</code>, <code>bundle list</code> and <code>gem list</code> both show the gem as installed and operations that require db access under <code>rails console</code> work fine, all of these on the server. On my machine everything is OK.</p>\n\n<p>I'm using RVM, Ruby 1.9.3, Rails 3.2.8 and this is the relevant part of deploy.rb:</p>\n\n<pre><code>set :rvm_ruby_string, ENV['GEM_HOME'].gsub(/.*\\//,\"\") # Read from local system\nrequire \"rvm/capistrano\" # Load RVM's capistrano plugin.\n</code></pre>\n\n<p>Is it a Passenger issue, am I doing something wrong with Capistrano, or is it a problem with gem versions?</p>\n"},{"tags":["ruby-on-rails-3","heroku","scheduled-tasks","rake-task"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13153173,"title":"Run a rake task every 2 hours using \"Heroku Schedular Standard\"","body":"<p>Am using Heroku Schedular add-on to schedule my rake tasks, the Standard plan for \"Heroku Schedular\" will run any number of commands, either every 10 minutes, every hour, or every day.</p>\n\n<p>But I had a thought of running tasks at an interval of every 2 hrs from a start time. Though the Standard plan doesn't helps me to achieve this and the upgrade can definitely make it as easy as a candy, I have figured out a way using the time factor that I have.</p>\n\n<p>I have the schedule date-time attribute named \"date_time\" for my shows. And every day a task is to be executed at an interval of every 2 hrs with respective to this \"date_time\"</p>\n\n<p>What I managed give me the even status for my show date-time</p>\n\n<pre><code>(((show.try(:date_time).to_time - 2.hour.since(Time.at(Time.now.utc)))/2.hour).ceil).even?\n</code></pre>\n\n<p>But this fails to give a proper 2 hr interval, it results like</p>\n\n<pre><code> 1      2      3      4     5     6     7\ntrue  true   false  true  true  false  true\n</code></pre>\n\n<p>What I was expecting is</p>\n\n<pre><code> 1      2      3      4     5     6      7\ntrue  false   true  false  true  false  true\n</code></pre>\n\n<p>Would be delightful if it gets back in action.</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","query","webhooks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13272004,"title":"RnR: Long running query, Heroku timeouts: webhooks? Ajax?","body":"<p>So here's the issue, we have a data that the users want displayed.  The query, we optimized and indexed to be as fast as I think its going get.  We might shave off a second or two but with the amount of data, not much we can do.  </p>\n\n<p>Anyway, so the query runs great when limited to a day or two of data, however the users are running it for a week or two of data.  So the query for two or three weeks of data takes about 40 seconds, with a Heroku timeout of 30 seconds, that doesn't work.  So we need a solution.  </p>\n\n<p>So searching here and Google, I see comments that webhooks or Ajax would work as out solution.  However, I've been unable to find a real concrete example.  I also saw a comment where someone was saying we could send some kind of response that would \"reset the clock.\" But again sounded intriguing but couldn't find an example.  </p>\n\n<p>We're kind of under the gun, the users are unhappy, so we need a solution that is fast and simple.  Thanks in advance for your help! </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","acts-as-taggable-on","posts"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":457,"score":1,"question_id":10274885,"title":"Acts_as_taggable_on implementation tutorial","body":"<p>I've been trying to allow for tags to be placed on posts so that I could partition them into different sections of my app. I've looked through various gems and have found that acts_as_taggable_on seems to be the most popular one. After various attempts of implementation from the examples in the github of the gem I have not been able to successfully use it. I've searched extensively for a tutorial on implementation but have found none and was hoping someone would have one for such a thing. I'm sorry for the simple question as I am still relatively new to programming. </p>\n"},{"tags":["jquery","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13247589,"title":"Rails Nested Resources - create and edit 2 levels away with form_for in partial","body":"<p>Really racking my brain on this one.  I'm relatively new to Rails and trying to do something that I'm sure is not too difficult.</p>\n\n<p>I have a model \"Trip\" which has many \"Days\" which has many \"Activities\"</p>\n\n<p>I am in the show.html.erb view of \"Trip\" and in this view, I am rendering a partial for a form that should allow me to create a new \"Activity\" to be associated with a \"Day\" or edit an existing \"Activity\" which already belongs to a \"Day\"</p>\n\n<p>How do I pass to the form_for in the form partial, the local variable of which \"Day\" I want to create the new \"Activity\" for.  And using that same form partial, how can I retrieve the \"Day\" that the \"Activity\" is associated with? Eventually these will be AJAX loaded objects.\nI've googled for the past several hours and can't find any examples similar to this.  I really appreciate the help.</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>  resources :trips do\n    resources :days    \n  end\n\n  resources :days do\n    resources :activities\n  end \n</code></pre>\n\n<p><strong>show.html.erb for the Trip</strong></p>\n\n<pre><code>&lt;div id=\"activities_list\"&gt;\n  &lt;%= render :partial =&gt; \"activities\" %&gt;\n&lt;/div&gt; \n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :locals =&gt; { :activity =&gt; @activity}  %&gt;\n&lt;/div&gt;\n\n&lt;div id=\"bottom\"&gt;\n&lt;%= link_to 'Edit', edit_trip_path(@trip) %&gt; |\n&lt;%= link_to 'Back', trips_path %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>_activities.html.erb partial</strong></p>\n\n<pre><code>&lt;h1&gt;&lt;%= @trip.title %&gt;&lt;/h1&gt;\n\n&lt;% @trip.days.each do |day| %&gt;\n&lt;div id=\"blech_&lt;%= day.id %&gt;\"&gt;\n  &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n      &lt;% day.activities.each do |activity| %&gt;\n            &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_day_activity_path(day, activity), :remote =&gt; true  %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;%= link_to 'New Activity', new_day_activity_path(day), :remote =&gt; true %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_form.html.erb partial</strong> I know that I need to be calling the day_activity_path with (@day,@activity) variables.  but I don't know how to get the @day variable in here</p>\n\n<pre><code>  &lt;%= form_for([@activity], :remote =&gt; true) do |f| %&gt;\n     &lt;fieldset&gt;\n       &lt;%= f.label :title, \"Activity\" %&gt;&lt;br /&gt;\n       &lt;%= f.text_field :title, :rows =&gt; 1 %&gt;&lt;br /&gt;\n     &lt;/fieldset&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":2435,"score":6,"question_id":6822904,"title":"undefined method `groups' for Rails:Module","body":"<p>As usual I've been an idiot and broken rails on my mac somehow. I think it all started when it said the version of rake wasn't recent enough so I delved down a huge road of different gems etc. and different versions of rails, I ended up getting rails from github but it replaces it with the most recent version.</p>\n\n<p>Now I fear all of my configuration files are incorrect, but when I try to 'rake rails:update' I get the following error with a trace:</p>\n\n<pre><code>rake aborted!\nundefined method `groups' for Rails:Module\n/Users/jamielawrence/Documents/Websites/JaphexPortfolio/config/application.rb:8\n/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'\n/Users/jamielawrence/Documents/Websites/JaphexPortfolio/Rakefile:4\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/rake_module.rb:25:in `load'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/rake_module.rb:25:in `load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:495:in `raw_load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:78:in `load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:129:in `standard_exception_handling'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:77:in `load_rakefile'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:61:in `run'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:129:in `standard_exception_handling'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/lib/rake/application.rb:59:in `run'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2/bin/rake:32\n/usr/bin/rake:19:in `load'\n/usr/bin/rake:19\n</code></pre>\n\n<p>I've pretty much had enough tonight, I've been down a million routes (it all started with trying to get an authentication add on to work).</p>\n\n<p>All i want to do is reset the config files to what they were originally for rails 3.0.9, my gem file went from:</p>\n\n<p>gem 'rails', '3.0.9'</p>\n\n<p>to</p>\n\n<p>gem 'rails', :git => 'git://github.com/rails/rails.git'</p>\n\n<p>back to</p>\n\n<p>gem 'rails', '3.0.9'</p>\n\n<p>...I'm an idiot...but an idiot with a huge headache.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","rdoc"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13261994,"title":"RDoc just my own application?","body":"<p>Is there a way to stop RDoc from going higher than the current directory? i just tried</p>\n\n<pre><code>rdoc -O -x ../\n</code></pre>\n\n<p>but this also stopped it from parsing relative pathes in subdirectories; what I really need is something like:</p>\n\n<p>If absolute path of App is /foo/bar/MyAppDir/, just RDoc all sources inside and below /foo/bar/MyAppDir/ without parsing /foo/bar/OtherRepository/ from wich some classes derive and get functions I dont want to document.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec2","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13261986,"title":"How do you separate test queues and real queues when testing Resque (with rspec and rails?)","body":"<p>I would like to test some resque workers, and the actions that enqueue jobs with these workers. I am using rspec and rails.</p>\n\n<p>Currently I have a model, let's call it Article.rb, that has a before_save method called updates_related_categories that checks if a job with CategoriesSorter needs to be enqueued. If so, it enqueues a job with that worker, with the argument of the category id that the article is related to.</p>\n\n<p>In test, however, these jobs are sent to the same queue as the development server sends jobs to. (i check using the resque server that you can tie into your server at root/redis/overview)</p>\n\n<p>I want to know:</p>\n\n<p>1) How can I send test jobs to a different queue than the development jobs?</p>\n\n<p>If this is possible, any other advice on testing resque is also welcome.</p>\n\n<p>I have seen some related questions that suggest resque-unit and resque-spec but these are pretty undeveloped, and I couldn't get them to a useful working state. Also, I have heard of using Resque.inline but I don't know if that is relevant in this case, as resque isn't called in test specs, it's called from the article model on save of objects created in test.</p>\n\n<p>Sample Code:</p>\n\n<p>Article.rb:</p>\n\n<pre><code> before_save :update_related_categories\n def update_related_categories\n     #some if statements/checks to see if a related category needs updating\n         Resque.enqueue(CategoriesWorker, [category_id])\n     end\n end\n</code></pre>\n\n<p>CategoriesSorter:</p>\n\n<pre><code> class CategoriesSorter\n     @queue=:sorting_queue\n     def self.perform(ids)\n        ids.each do |id|\n           #some code\n        end\n      end\n end\n</code></pre>\n\n<p>Specs:</p>\n\n<pre><code> it \"should do something\" do\n     @article = #set something to enqueue a job\n     @article.save\n     #can i check if a job is enqueued? can i send this job NOT to the development queue but a different one?\n end\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","mvc","cells"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13270785,"title":"Accessing devise helpers from cell's controller and views","body":"<p>I'm using <a href=\"https://github.com/apotonick/cells\" rel=\"nofollow\">cells gem</a> and need access devise helpers from cell controller and view, for example current_user.</p>\n\n<p>In controller i'm done with</p>\n\n<pre><code>include Devise::Controllers::Helpers\nDevise::Controllers::Helpers.define_helpers(Devise::Mapping.new(:student, {}))\n</code></pre>\n\n<p>But in view i should create @variable that assign with devise helper from controller, i can't using current_user directly in my cells view. Is there any elegant solution for my problem ?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3","partial","renderpartial"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13259587,"title":"Using javascript .click inside a partial rails","body":"<p>I have a javascript click function that is called every time my textbox gets clicked on, however for some reason it only works if the textbox is inside the main page, when I move the textbox into the partial I render nothing happens when I click on it.  Does anyone know how to make a click event work inside a partial?</p>\n\n<p>My users.js.coffee file</p>\n\n<pre><code>$ -&gt;\n  $(\"form[data-update-target]\").live \"ajax:success\", (evt, data) -&gt;\n    target = $(this).data(\"update-target\")\n  $(\"#\" + target).html data\n\n  $(\"input.submit\").click -&gt;\n    $(this).parent().submit()\n    true\n\n  $(\"#datepicker\").click -&gt;\n    alert \"hello world\"\n</code></pre>\n\n<p>The new page for users</p>\n\n<pre><code>&lt;%= form_tag({:controller =&gt; 'users', :action =&gt; 'preview'}, :remote =&gt; true, :'data-update-target' =&gt; 'update-container') do %&gt;\n  &lt;%= radio_button_tag(:page_type, 'event', false, :class =&gt; 'submit') %&gt;\n  &lt;%= label_tag(:page_type, \"Event\") %&gt;\n  &lt;br/&gt;\n&lt;% end %&gt;\n&lt;div id=\"update-container\"&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The users controller</p>\n\n<pre><code>def preview\n  if params[:page_type] == \"event\"\n    @event = Event.new\n    render :partial =&gt; 'event', :object =&gt; @event\n  end\nend\n</code></pre>\n\n<p>The events partial called _event.html.erb</p>\n\n<pre><code>&lt;%= form_for(@event) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :description %&gt;\n    &lt;%= f.text_area :description %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :start %&gt;\n    &lt;input id=\"datepicker\" type=\"text\" value=\"\" name=\"event_start\"&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>generated html</p>\n\n<pre><code>&lt;body&gt;\n&lt;p id=\"notice\"&gt;&lt;/p&gt;\n&lt;p id=\"alert\"&gt;&lt;/p&gt;\n  &lt;h1&gt;New page&lt;/h1&gt;\n\n&lt;form accept-charset=\"UTF-8\" action=\"/users/preview\" data-remote=\"true\" data-update-target=\"update-container\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"iIodOQohxJgk1P5ZmFrbgw4W/h4cq45LBxGN3xjyREk=\" /&gt;&lt;/div&gt;\n\n&lt;input class=\"submit\" id=\"page_type_event\" name=\"page_type\" type=\"radio\" value=\"event\" /&gt;\n&lt;label for=\"page_type\"&gt;Event&lt;/label&gt;\n&lt;br/&gt;\n&lt;/form&gt;&lt;div id=\"update-container\"&gt;\n&lt;/div&gt;\n&lt;input id=\"datepicker\" type=\"text\" value=\"\" name=\"event_start\"&gt;\n\n&lt;a href=\"/users\"&gt;Back&lt;/a&gt;\n&lt;/body&gt;\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails-3","coffeescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13270474,"title":"How do I use the new jQuery .on() function (with CoffeeScript)?","body":"<p><code>.on()</code> does not appear to function like <code>.live()</code>. All I want to do is a simple alert to get me going. I have the following element on my page:</p>\n\n<pre><code>&lt;a class=\"add_showcase_item\" href=\"javascript://\"&gt;621015&lt;/a&gt;\n</code></pre>\n\n<p>I have the following CoffeeScript:</p>\n\n<pre><code>$(\"a\").live \"click\", \".add_showcase_item\", -&gt;\n  alert \"hello\"\n  false\n</code></pre>\n\n<p>Unfortunately, this causes the alert to go off on EVERY link. That doesn't make any sense I know. Can anyone help?</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","activerecord","transactions"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":22,"score":3,"question_id":13269109,"title":"ActiveRecord: Concurrent access between validation and writing to the database","body":"<p>Let's say I have on online book store whose data model lookes like that:</p>\n\n<p><img src=\"http://i.stack.imgur.com/FhjaG.png\" alt=\"enter image description here\"></p>\n\n<p>Prior to creating a new order, I want to make sure that enough items are in stock, so I have a method like this</p>\n\n<pre><code>def ensure_enough_in_stock\n    errors.add(:quantity, \"not enough in stock\") if quantity &gt; book.stock\nend\n</code></pre>\n\n<p>To make sure that this method is called prior to saving in the database, I use a validate:</p>\n\n<pre><code>validate :ensure_enough_in_stock, :on =&gt; create\n</code></pre>\n\n<p>So to sum things up, when I create an order:</p>\n\n<ol>\n<li>the validation method is called</li>\n<li>the new order is written into the database (if validation passes)</li>\n</ol>\n\n<p>What happens if between 1. and 2., another process (a concurrent access, another thread, ...) performs a modification on the stock attribute of the same book? Is the exception raised or not?</p>\n\n<p>More generally, how to deal with the cases where something happens <strong>between validation and saving</strong> to the database?</p>\n\n<p>I think that I should put a validation into the database as well, but I don't know what impact it would have on performance. Is there a clever way to deal with this kind of situation?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Locking the transactions as explained <a href=\"http://guides.rubyonrails.org/active_record_querying.html#locking-records-for-update\" rel=\"nofollow\">here</a> prevents write access to stock, but what happens if I also have a \"published\" attribute in the Book model, that can take the values \"public\" or \"private\", and then I want to make sure that you can't buy a book that's private.</p>\n\n<p>But the same way that the stock value could be changed by an external process, the published value can be changed as well: in this case the locking would not be of any help, would it?</p>\n\n<p><img src=\"http://i.stack.imgur.com/Jsb1Y.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","highcharts","wkhtmltopdf"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12621327,"title":"highcharts display in my render html page which i want to convert into PDF using wkhtmltopdf in rails","body":"<p>I have html page with some text data and graph. I am using wkhtmltopdf gem to generate pdf from html page. using highcharts, i am generating graph.</p>\n\n<blockquote>\n  <p>I can able to generate PDF successfully but PDF only contains text\n  data and doesn't have graph in it.</p>\n</blockquote>\n\n<p>I already tried with some options as below</p>\n\n<pre><code> - plotOptions: { series: { enableMouseTracking: false, shadow: false, animation: false } }, in Hightcharts jquery coding..\n</code></pre>\n\n<p>Please assist me to resolve this issue.</p>\n"},{"tags":["jquery","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13268307,"title":"Difference between jquery form submission and remote form submission in Rails 3","body":"<p>I have seen some of applications, In ajax requests are two types </p>\n\n<ol>\n<li><code>link_to :remote =&gt;true</code> like ........</li>\n<li><code>$(ajax).save</code> button click function .......</li>\n</ol>\n\n<p>What is the difference between those? Which one is the best approach for rails?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13258805,"title":"params of the model not being returned rails 3","body":"<p>I have made a few posts before this regarding how to add a favourite recipe to a user..I have an app where you can upload recipes once logged in, users can search the entire table for all recipes and view their own recipes  in a member area.. </p>\n\n<p>Now I want users to be able to save their favourite recipes, so far I can save a favourite recipe as such, the output that I get is </p>\n\n<pre><code>[#&lt;Favourite id: 1, user_id: 8, recipe_id: nil, created_at: \"2012-11-06 19:25:34\", updated_at: \"2012-11-06 19:25:34\"&gt;,\n</code></pre>\n\n<p>so i am getting the correct user_id but no params for the actual recipe, ie dish name, country of origin.</p>\n\n<p>My models are like so </p>\n\n<p><strong>User</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\nhas_many :recipes \nhas_many :favourites\n</code></pre>\n\n<p>Recipe</p>\n\n<pre><code>has_many :ingredients \nhas_many :preperations\nhas_many :favourites\n</code></pre>\n\n<p>Favourite</p>\n\n<pre><code>belongs_to :user\nbelongs_to :recipe\n</code></pre>\n\n<p>My favourite controller looks like so</p>\n\n<pre><code> def create\n\n @favourite = current_user.favourites.new(params[:recipe])\n if @favourite.save\n redirect_to my_recipes_path, :notice =&gt; \"Recipe added to Favourites\"\n end\nend\n</code></pre>\n\n<p>Add to favourites link</p>\n\n<pre><code> &lt;%= link_to \"Add to favorites\",  {:controller =&gt; 'favourites', :action =&gt; 'create'}, {:method =&gt; :post } %&gt;\n</code></pre>\n\n<p>I hope I haven’t missed anything out, any help appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pjax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13088392,"title":"Rails: error with pjax \"Uncaught TypeError: Object [object Object] has no method 'pjax' \"","body":"<p>Gemfile:</p>\n\n<blockquote>\n  <p>gem 'pjax_rails'</p>\n</blockquote>\n\n<p>app/assests/javascripts/application.js :</p>\n\n<pre><code>//= require jquery \n//= require jquery_ujs \n//= require_tree . \n//= require jquery.pjax\n\n\n$(function() {\n $('a').pjax('[data-pjax-container]');\n});\n</code></pre>\n\n<p>app/views/layouts/application.html.erb:</p>\n\n<pre><code>&lt;div id=\"data-pjax-container\" data-pjax-container&gt;\n        &lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The error i'm getting in chrome is:</p>\n\n<blockquote>\n  <p>Uncaught TypeError: Object [object Object] has no method 'pjax'</p>\n</blockquote>\n\n<p>And it refers to the application.js file. What is wrong here?</p>\n"},{"tags":["android","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13269148,"title":"Rails' send_file to make apk file being installed","body":"<p>I'm trying to make my website sending Android <code>APK</code> files with some pre-validation so the user just clicks the link and the application starts to install on the device.</p>\n\n<p>The point is, i'm using the <code>thin</code> webserver, <code>send_file path, :type =&gt; 'application/vnd.android.package-archive', :disposition =&gt; \"attachment\"</code>, set the header <code>headers['Content-Type'] = 'application/vnd.android.package-archive'</code> and checked the <strong>Allow untrusted sources</strong> box at the device' settings. But the <em>apk</em> file is just downloaded instead of being installed.</p>\n\n<p><strong>UPD:</strong> The following trouble issues on Android 4 only. My Galaxy S with Android 2.3.6 works fine.</p>\n\n<p>What am i doing wrong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13268935,"title":"Monkey-patching database adapter in Rails app","body":"<p>I'm using PosgreSQL adapter to connect to Vertica database which is mostly compatible with PostgreSQL but doesn't support options like client_min_messages (which are still passed to <code>PGconn.connect</code> despite not being present in <code>database.yml</code>). I've made a quick and dirty monkey patch for <code>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</code> but the problem is that I guess everything in AR in lazy loaded and the original file is read after my patch. </p>\n\n<p>If I add <code>require 'active_record/connection_adapters/postgresql_adapter'</code> at the top of the monkey patch then ActiveRecord tries to establish connection and fails. Is it possible to alter this behavior to make the monkey patch work or should I just write a full-fledged connection adapter?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13265378,"title":"What happens to rails authenticity token after refersh and when it is ccreated","body":"<p>I want to know when does a authentication token in rails is generated again. Because whenever i refresh the page token doesn't changes?? and i want to know when it will change again</p>\n\n<p>possible duplicate :</p>\n\n<blockquote>\n  <p><a href=\"http://stackoverflow.com/questions/6968106/rails-3-authenticity-token-how-it-is-generated#comment18079544_6968106\">rails 3 authenticity_token how it is generated</a></p>\n</blockquote>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","csv","import"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13266799,"title":"Can't set boolean values when import data from csv to postgresql","body":"<p>I have built a task to import data like this:</p>\n\n<pre><code>CSV.foreach(file, :headers =&gt; true) do |row|  \n  question = Question.new ({  \n  content:   row[0],\n  mark:      row[1],\n  topic_id:  row[2],\n  question_type_id: row[3],\n  answers_attributes: [\n    { content: row[5], correct: row[6] },\n    { content: row[7], correct: row[8] }\n  ]\n})\nquestion.user_id = row[4]\nquestion.save!\n</code></pre>\n\n<p>This is my CSV file:</p>\n\n<pre><code>content, mark, topic_id, question_type_id, user_id, content, correct, content, correct\n_____ are people involved in or affected by project activities, 5, 16, 1, 3, True, 't', False, 'f'\n</code></pre>\n\n<p>But when i run import task, the <code>correct attribute</code> always is FALSE in database, i have tried with different <a href=\"http://www.postgresql.org/docs/9.2/static/datatype-boolean.html\" rel=\"nofollow\">Boolean Data Type</a> of PostgreSQL but not working. What do i wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations","model-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13268580,"title":"How to solve circle associations in rails most elegantly?","body":"<p>Imagine you have these two models containing <strong>a circle reference</strong>:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  has_many :users\n  belongs_to :manager, :class_name =&gt; 'User', :foreign_key =&gt; \"manager_id\"\nend\n\nclass User &lt; ActiveRecord::Base\n  belongs_to :company\n  has_one :managed_company, :class_name =&gt; \"Company\", :foreign_key =&gt; :manager_id\nend\n</code></pre>\n\n<p>Now I create a <strong>new User</strong> with a <strong>new Company</strong> that <strong>manager the user himself is</strong>:</p>\n\n<pre><code>u = User.new\nu.build_company\nu.company.manager = u\nu.save!\n</code></pre>\n\n<p>A Test, if the manager was sucessfully assigned to the company turns out well:</p>\n\n<pre><code>1.9.3p125 :010 &gt; u.company.manager\n =&gt; #&lt;User id: 1548, ...&gt;\n</code></pre>\n\n<p>Yet, the association is not saved:</p>\n\n<pre><code>1.9.3p125 :011 &gt; u.company.manager_id\n =&gt; nil \n</code></pre>\n\n<p>This is, because Rails creates <code>Company</code> first and the <code>User</code> second, being unable to set the <code>manager_id</code> as the <code>user_id</code> is unknown as the company is created:</p>\n\n<pre><code> INSERT INTO \"companies\" (... [\"manager_id\", nil] ...\n INSERT INTO \"users\" (...\n</code></pre>\n\n<p><strong>What is the most elegant solution?</strong></p>\n\n<ol>\n<li>Saving the User and Company two times on creation and having the manager_id assigned on the second time?</li>\n<li>Using some Rails built-in trick that I am unaware of as of now</li>\n<li>Some more advanced magic</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2","habtm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13267860,"title":"Rails 3.2 + Postgres: has_and_belongs_to_many saving even when validation fails","body":"<p>I have a Company model:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n    has_and_belongs_to_many :jobs\n    validates :name, presence: true\nend\n</code></pre>\n\n<p>And a Job model:</p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n    has_and_belongs_to_many :companies\n    validates :name, presence: true\nend\n</code></pre>\n\n<p>All works fine except for the collection.create method. According to the <a href=\"http://guides.rubyonrails.org/association_basics.html#has_and_belongs_to_many-association-reference\" rel=\"nofollow\">Rails documentation</a>:</p>\n\n<blockquote>\n  <p>The collection.create method returns a new object of the associated type. This object will be instantiated from the passed attributes, the link through the join table will be created, and, once it passes all of the validations specified on the associated model, the associated object will be saved.</p>\n</blockquote>\n\n<p>This doesn't seem to work properly for me: even when the child object is invalid (and the validation works because the invalid model doesn't get saved), the association still gets created. I created this unit test to explain how I try to do it:</p>\n\n<pre><code>test \"add invalid job to company\" do\n  company = FactoryGirl.create(:company_with_job)\n\n  # I also tried:\n  # company.jobs &lt;&lt; FactoryGirl.build(:job, name: \"\")\n  company.jobs.create({name: \"\"})\n  company.save\n  assert_equal 1, company.jobs.size\nend\n</code></pre>\n\n<p>Size is instead '2' and if I inspect company.jobs I get this:</p>\n\n<pre><code>[#&lt;Job id: 1, name: \"My Job 1\", created_at: \"2012-11-07 10:26:10\", updated_at: \"2012-11-07 10:26:10\"&gt;, \n#&lt;Job id: nil, name: \"\", created_at: nil, updated_at: nil&gt;]\n</code></pre>\n\n<p>I'm sure I'm missing something stupid, but I've been banging my head on this for a while and can't seem to understand what I'm doing wrong.</p>\n\n<p>Thanks,<br>\ng</p>\n"},{"tags":["ruby-on-rails-3","cucumber","factory-girl"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2359,"score":4,"question_id":6045651,"title":"Using Factory Girl step definitions in Cucumber features (Rails 3)","body":"<p>I'm trying to use Cucumber and Factory Girl. The following lines:</p>\n\n<pre><code>  Given I am not logged in\n  And   the following user exists:\n    | login  | email               | password   | confirmation |\n    | user50 | user50@mydomain.com | secret50   | secret 50    | \n ....\n</code></pre>\n\n<p>raises the following error:</p>\n\n<pre><code>Undefined step: \"the following user exists:\" (Cucumber::Undefined exception)\n/home/user/RubymineProjects/project/features/sign_in.feature:9:in `And the following user exists:\n\nYou can implement step definitions for undefined steps with these snippets:\nAnd /^the following user exists:$/ do |table|\n  # table is a Cucumber::Ast::Table\n  pending # express the regexp above with the code you wish you had\nend\n</code></pre>\n\n<p>'</p>\n\n<p>I've installed factory_girl_rails (even RubyMine's code completion feature works with Factory Girl step ... )</p>\n\n<pre><code>#Gemfile\ngroup :test do\n   gem \"cucumber-rails\", \"&gt;= 0.3.2\"\n   gem \"factory_girl_rails\"\n end\n\n#features/support/env.rb\nrequire 'factory_girl'\nrequire 'factory_girl/step_definitions'\n</code></pre>\n\n<p>Any ideas? Thanks</p>\n\n<hr>\n\n<p>Update: Thanks to @sj26 and @twmills  I realized that I forgot to create a :user factory with Factory Girl. Once I created it, everything worked well.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13266657,"title":"Rails nested_form_for not working when using file_field","body":"<p>When using <code>nested_form_for</code> and having a <code>file_field</code> in <code>fields_for</code> I get the following error from paperclip:</p>\n\n<p><strong>Paperclip::AdapterRegistry::NoHandlerError in ProjectsController#create</strong></p>\n\n<p><code>No handler found for \"scan.pdf\"</code></p>\n\n<p>This is correct, because the params don't show an <code>#&lt;ActionDispatch::Http::UploadedFile&gt;</code> object, but just the file name.</p>\n\n<p>Before using <code>nested_form_for</code> it worked, it works when I uncomment the <code>file_field</code> and it also works when I build the first object for <code>fields_for</code> but this shouldn't be necessary..</p>\n\n<p>My setup is as follows:</p>\n\n<ul>\n<li>ruby 1.9.3</li>\n<li>rails (3.2.8)</li>\n<li>paperclip (3.3.0)</li>\n<li>nested_form (0.3.0)</li>\n</ul>\n\n<p>The code:</p>\n\n<pre><code># @project.schemes.build\n= nested_form_for @project do |f|\n  = f.fields_for :schemes do |ff|\n    = ff.text_field :name\n    = ff.file_field :scan\n</code></pre>\n"},{"tags":["ruby-on-rails-3","whenever"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":121,"score":1,"question_id":8806792,"title":"Rails 3 / whenever cron not firing","body":"<p>I am using <a href=\"https://github.com/javan/whenever\" rel=\"nofollow\">whenever</a> to fire a rake task every 5 minutes for my app.</p>\n\n<p>schedule.rb:</p>\n\n<pre><code>every 5.minutes do   \nrake \"audit\",\n:environment =&gt; 'development'\nend\n</code></pre>\n\n<p>\"whenever\" in console:</p>\n\n<pre><code>0,5,10,15,20,25,30,35,40,45,50,55 * * * * /bin/bash -l -c 'cd /Users/john/Sites/rambler &amp;&amp; RAILS_ENV=development bundle exec rake audit --silent'\n</code></pre>\n\n<p>\"rake audit\" in console works properly.</p>\n\n<p>So all looks good .... except it doesn't work. Nothing happens every five minutes.</p>\n\n<p>Is this because I am trying to run it in development / local?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","passenger","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":25,"score":0,"question_id":13265655,"title":"virtual hosting using phusion passenger","body":"<p>I wish to host two websites on same machine,both are in ruby on rails .\n<br/>I can't find where to write configuration for it and I need to host using standalone phusion passenger. I have followed <a href=\"http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_a_rack_based_ruby_application_including_rails_gt_3\" rel=\"nofollow\">passenger_guide</a> but still can't figure it out?</p>\n"},{"tags":["ruby-on-rails-3","template-engine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13267073,"title":"How to setup a template-engine in ruby rails","body":"<p>I want to customize rails scaffolding. For that I want to set up a custom template engine.</p>\n\n<p>Can anyone guide me to set a custom template-engine. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook-graph-api","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13266883,"title":"How can i use the Facebook authentication in devise and send the iphone app the authentication token to use?","body":"<p>I use devise for authentication and i cloned an example from github which works good and now i want to use this for authenticating users from iPhone app and i have used token authentication so it returns the token for user if valid and then the subsequent requests are made with the help of the token. And the part that i am struggling with is authenticating facebook users from iphone. I have few doubts which i have listed below</p>\n\n<ol>\n<li>After sending the user id and password to facebook from iphone, what does it return? Only access token of user or some other detail along with it.</li>\n<li>As i have told earlier, i am working with devise example from <a href=\"https://github.com/plataformatec/devise_example.git\" rel=\"nofollow\">https://github.com/plataformatec/devise_example.git</a> , so how can the access token be received from iphone and check whether the user is valid by sending it to the <code>graph.facebook.com</code></li>\n<li>If after knowing that user is valid then how can i save the user in the user table so as to provide the authentication token to perform next request.</li>\n<li>When the same user enters next time how can i identify whether the user is already present in the table and send the token.</li>\n</ol>\n\n<p>I searched and i could not find any good help or may be i could not get it and this took about three days and still i am struggling. So please help me also tell me if there is any example so that i can try if there is any.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","yaml","psych"],"answer_count":5,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":4616,"score":6,"question_id":5843104,"title":"Rails 3 - 'Couldn't parse Yaml'","body":"<p>I don't know what I did wrong. I try to run 'rails c,' but it just gives me an error. It was working 10 minutes ago. :\\</p>\n\n<pre><code>C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse': couldn't parse YAML at line 2\n column 12 (Psych::SyntaxError)\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:148:in `parse_stream'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:119:in `parse'\n        from C:/Ruby192/lib/ruby/1.9.1/psych.rb:106:in `load'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/configuration.rb:88:in `database_configuration'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:58:in `block (2 levels) in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `instance_eval'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:36:in `execute_hook'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:43:in `block in run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activesupport-3.0.7/lib/active_\nsupport/lazy_load_hooks.rb:42:in `run_load_hooks'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/base.rb:1904:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/activerecord-3.0.7/lib/active_r\necord/railtie.rb:32:in `block in &lt;class:Railtie&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `call'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/railti\ne.rb:180:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `block in load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation/railties.rb:11:in `all'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/applic\nation.rb:154:in `load_console'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:26:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds/console.rb:8:in `start'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.0.7/lib/rails/comman\nds.rb:23:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n"}]}
{"total":34674,"page":3,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13265427,"title":"checking the form data received in ruby on rails controller","body":"<p>I want to check the form data received from the form in ruby on rails controller.</p>\n\n<p>I tried this but nothing is shown:</p>\n\n<pre><code>@user.to_yaml\n</code></pre>\n\n<p>where <code>@user</code> is the form name(<code>&lt;%=form_for @user</code> )</p>\n"},{"tags":["ruby-on-rails-3","ubuntu-12.04","sslv2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13215779,"title":"SSLv2 error with rails 3 on ubuntu 12","body":"<p>I m using ruby 1.9.2. Whenever i run bundle install, i get the following error.</p>\n\n<pre><code>bundle install\nFetching gem metadata from https://rubygems.org/.Unfortunately, a fatal error has  occurred. Please see the Bundler \ntroubleshooting documentation at http://bit.ly/bundler-issues. Thanks! \n/home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require':    /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/i686-linux/openssl.so: undefined symbol: SSLv2_method - /home/prasad/.rvm/rubies/ruby-1.9.2- p320/lib/ruby/site_ruby/1.9.1/i686-linux/openssl.so (LoadError)\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/openssl.rb:17:in `&lt;top (required)&gt;'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'\nfrom /home/prasad/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/net/https.rb:92:in `&lt;top (required)&gt;'\n....\n</code></pre>\n\n<p>The things i tried to solve are</p>\n\n<p>1) steps in answer at <a href=\"http://stackoverflow.com/questions/12759518/undefined-symbol-sslv2-method-when-running-bundle-install\">undefined symbol: SSLv2_method when running bundle install</a></p>\n\n<p>2) steps by bob at <a href=\"https://groups.google.com/forum/?fromgroups=#!topic/hobousers/80wBJcS0IZk\" rel=\"nofollow\">https://groups.google.com/forum/?fromgroups=#!topic/hobousers/80wBJcS0IZk</a> though the system had no <strong>x86_64-linux-gnu</strong> folder</p>\n\n<p>3) steps in this blog <a href=\"http://awolf.ru/rails-on-ubuntu-with-rvm/\" rel=\"nofollow\">http://awolf.ru/rails-on-ubuntu-with-rvm/</a></p>\n\n<p>i cant understand why one of my machine works fine(upgraded from ubuntu 11.10 to 12.04)\nwhile the other gives a problem(freshly installed ubuntu 12.04)</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>the openssl version used by rvm on the working machine is 0.9.8 while the other one has 1.0.1. Some googling resulted that the 1.0.0 and 1.0.1 doent support the SSLv2 whereas it was supported by 0.9.8.</p>\n\n<p>any fix for the above prob would be much appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth","vkontakte"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12289263,"title":"Rails omniauth and devise trouble with vk","body":"<p>I'm going to implement facebook and vkontakte login(registering) for my rails app, and with facebook all is ok (login and regitering is ok), done as in manual \n<a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">here</a></p>\n\n<p>But with vkontakte something wrong, i'll still get \"empty\" page</p>\n\n<p>here is my code:</p>\n\n<pre><code>class Users::OmniauthCallbacksController &lt; Devise::OmniauthCallbacksController\n  def facebook\n    # You need to implement the method below in your model (e.g. app/models/user.rb)\n    @user = User.find_for_facebook_oauth(request.env[\"omniauth.auth\"], current_user)\n\n    if @user.persisted?\n      flash[:notice] = I18n.t \"devise.omniauth_callbacks.success\", :kind =&gt; \"Facebook\"\n      sign_in_and_redirect @user, :event =&gt; :authentication\n    else\n      session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\n\n  def vkontakte\n    @user = User.find_for_vkontakte_oauth(request.env[\"omniauth.auth\"], current_user)\n    if @user.persisted?\n      flash[:notice] = I18n.t \"devise.omniauth_callbacks.success\", :kind =&gt; \"Vkontakte\"\n      sign_in_and_redirect @user, :event =&gt; :authentication\n    else\n      session[\"devise.vkontakte_data\"] = request.env[\"omniauth.auth\"]\n      redirect_to new_user_registration_url\n    end\n  end\nend\n</code></pre>\n\n<p>And model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable,\n         :token_authenticatable, :lockable, :timeoutable, :omniauthable #:confirmable, \n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me, :provider, :uid, :name\ndef self.find_for_facebook_oauth(auth, signed_in_resource=nil)\n    user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n    unless user\n      user = User.create(name:auth.extra.raw_info.name,\n                           provider:auth.provider,\n                           uid:auth.uid,\n                           email:auth.info.email,\n                           password:Devise.friendly_token[0,20]\n                           )\n    end\n    user\n  end\n\n  def self.new_with_session(params, session)\n    super.tap do |user|\n      if data = session[\"devise.facebook_data\"] &amp;&amp; session[\"devise.facebook_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n      if data = session[\"devise.vkontakte_data\"] &amp;&amp; session[\"devise.vkontakte_data\"][\"extra\"][\"raw_info\"]\n        user.email = data[\"email\"] if user.email.blank?\n      end\n    end\n  end\n\n\n\n  def self.find_for_vkontakte_oauth(auth, signed_in_resource=nil)\n    user = User.where(:provider =&gt; auth.provider, :uid =&gt; auth.uid).first\n    unless user\n      user = User.create(name:auth.info.name,\n                           provider:auth.provider,\n                           uid:auth.uid,\n                           email:auth.extra.raw_info.domain+'@vk.com',\n                           password:Devise.friendly_token[0,20]\n                           )\n    end\n    user\n  end\n</code></pre>\n\n<p>What's wrong? </p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13264337,"title":"How Do I Add Methods To ActiveRecord::Base?","body":"<p>I'm trying to create a customized ActiveRecord::Base that includes additional metadata about the connection.  I see two ways to go about this:</p>\n\n<p>1.)  Inherit from ActiveRecord::Base and add methods &amp; fields in this subclass.</p>\n\n<p>2.)  Encapsulate an ActiveRecord::Base object inside my own class</p>\n\n<p>1 has all kinds of problems with the inability to override initialize, weird problems where it doesn't seem to have custom methods I've added, etc.</p>\n\n<pre><code>undefined method `set_profile' for #&lt;Class:0xf041f0&gt;\n</code></pre>\n\n<p>2 I have not been able to figure out, due to problems with using ActiveRecord::Base.new</p>\n\n<p>I am trying to make an all-purpose ActiveRecord class that I can dynamically establish_connection &amp; set_table_name on, (i.e. not have one underlying table that this ActiveRecord::Base represents) but I can't seem to find a way to accomplish it.  Any ideas?</p>\n\n<p>This works:</p>\n\n<pre><code>  class MyTable &lt; ActiveRecord::Base\n    establish_connection $config['custom-db-config'];\n    set_table_name 'MY_TABLE'\n  end\n</code></pre>\n\n<p>but I need a class I can call these things on repeatedly.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13265178,"title":"How to find out all the \"hidden\" official Rails guides?","body":"<p>For instance, I found <a href=\"http://guides.rubyonrails.org/ajax_on_rails.html\" rel=\"nofollow\">AJAX on Rails</a> via Google, but it is not listed on the <a href=\"http://guides.rubyonrails.org/index.html\" rel=\"nofollow\">Rails Guides index page</a>.</p>\n"},{"tags":["ruby-on-rails-3","rspec","factory-girl"],"answer_count":3,"favorite_count":3,"up_vote_count":5,"down_vote_count":0,"view_count":776,"score":5,"question_id":10032760,"title":"How to define an array / hash in Factory Girl?","body":"<p>I am trying to write a test that simulates some return values from Dropbox's REST service that gives me back data in an Array, with a nested hash.</p>\n\n<p>I am having trouble figuring out how to code my Factory since the return result is an array with a has inside.  What would go here?</p>\n\n<pre><code>Factory.define :dropbox_hash do\n ??\nend\n</code></pre>\n\n<p>Dropbox data looks like this:</p>\n\n<pre><code> [\"/home\", {\"revision\"=&gt;48, \"rev\"=&gt;\"30054214dc\", \"thumb_exists\"=&gt;false, \"bytes\"=&gt;0, \"modified\"=&gt;\"Thu, 29 Dec 2011 01:53:26 +0000\", \"path\"=&gt;\"/Home\", \"is_dir\"=&gt;true, \"icon\"=&gt;\"folder_app\", \"root\"=&gt;\"app_folder\", \"size\"=&gt;\"0 bytes\"}] \n</code></pre>\n\n<p>And I'd like a factory call like this in my RSpec:</p>\n\n<pre><code>Factory.create(:dropbox_hash)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","html5"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13264243,"title":"how to use Use images (html tag)in message body of net smtp in ruby on rails?","body":"<p>I m developing web application using Ruby on Rails. I want to display an image in mail using net/smtp..\nmy code is...</p>\n\n<pre><code>msgstr = &lt;&lt;END_OF_MESSAGE\nFrom: Your Name &lt;your@mail.address&gt;\nTo: Destination Address &lt;someone@example.com&gt;\nMIME-Version: 1.0\nContent-type: text/html\nSubject: test message\nDate: Sat, 23 Jun 2001 16:26:43 +0900\nMessage-Id: &lt;unique.message.id.string@example.com&gt;\n&lt;img src = \"/my_proj/public/images/logo.jpeg\" alt= \"logo\"&gt;\n&lt;b&gt;  This is a test message.&lt;/b&gt;\nEND_OF_MESSAGE\n\nrequire 'net/smtp'\nNet::SMTP.start('your.smtp.server', 25) do |smtp|\n  smtp.send_message msgstr,\n                    'your@mail.address',\n                    'his_addess@example.com'\nend\n</code></pre>\n\n<p>It is sending mail with all tags but not displaying th image while displaying alternate text. I hav put jpeg file every where n tested it.. but its not gettng the path of file and diplying the alternate text. Please anyone help me.. how to define path of file... or where to put this image file.\nI have changed</p>\n\n<pre><code>Content-type: text/html image/jpeg\n</code></pre>\n\n<p>but still its not working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13264111,"title":"Trying to validate a date","body":"<p>I have a form where i'm trying to validate that a field called \"birthday\" is not blank, and that the date is a valid date format that the Chronic gem can parse. I always get the error message \"Birthday is invalid\". I've been trying a simple format \"10/10/2010\".</p>\n\n<p>How can i validate that the birthday field is of a format that chronic can parse?</p>\n\n<p>User.rb model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  validates :birthday, :presence =&gt; true\n  validate :birthday_is_date\n  validate :position, :presence =&gt; true\n\n  # validate the birthday format\n  def birthday_is_date\n    errors.add(:birthday ,Chronic.parse(birthday)) # testing to see the value of :birthday\n    errors.add(:birthday, \"is invalid test message\") if ((Chronic.parse(:birthday) rescue ArgumentError) == ArgumentError)\n  end\nend\n</code></pre>\n\n<p>contacts_controller.rb </p>\n\n<pre><code># POST /contacts/1/edit\n    # actually updates the users data\n    def update_user\n        @userProfile = User.find(params[:id])\n\n        respond_to do |format|\n            if @userProfile.update_attributes(params[:user])\n                format.html {\n                    flash[:success] = \"Information updated successfully\"\n                    redirect_to(profile_path)\n                }\n            else \n                format.html {\n                    flash[:error] = resource.errors.full_messages\n\n                    render :edit\n                }\n            end\n        end\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","csv","fastercsv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13264298,"title":"How to import CSV files in rails?","body":"<p>I am making an application in which it import a csv file names user.csv.But the problem i am facing is that it gives an error</p>\n\n<p>ArgumentError in CsvimportController#import</p>\n\n<p>wrong number of arguments (1 for 0)</p>\n\n<p>And the code of the CsvimportController is</p>\n\n<pre><code>require 'csv'\nclass CsvimportController &lt; ApplicationController\ndef import\n\nresults = import('anas.csv') do\nread_attributes_from_file\nend\n\n\nend\nend\n</code></pre>\n\n<p>And i have also give the specification of csv-mapper and fastercsv in gem file.</p>\n\n<p>Can anyone help me???</p>\n\n<p>Any help would be appreciated..</p>\n\n<p>Thanks </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":103,"score":0,"question_id":11334661,"title":"Why is Campaign Monitor responding with error \"310: HTML Content URL Required\" even though I have provided the URL?","body":"<p>I'm using the <a href=\"https://github.com/campaignmonitor/createsend-ruby\" rel=\"nofollow\">CreateSend API gem</a>, and in my <strong>local dev</strong> environment I am able to successfully create a draft campaign.</p>\n\n<p>In <strong>production (staging), on Heroku</strong>, the exact same code instead returns with an error:</p>\n\n<pre><code>310: HTML Content URL Required\n</code></pre>\n\n<p>I am definitely passing the HTML content URL, as well as all the other required arguments to <code>Campaign.create</code> (I've visually verified the fact by logging the variables). Here's the API call:</p>\n\n<pre><code>cm_campaign_id = CreateSend::Campaign.create client_id, subject, name, from_name, from_email, reply_to, html_url, text_url, list_ids, segment_ids\n</code></pre>\n\n<p>Furthermore, in local dev the API call returns in less than 3 seconds, whereas on Heroku it times out for 30 seconds and returns that error.</p>\n\n<p>Why is this happening on Heroku?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","software-engineering","sti"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187347,"title":"Should I split this model and table?","body":"<p>I would like to create simple ResumeBank app.</p>\n\n<p><strong>Issue</strong>:</p>\n\n<p>As user I would like to add only two Resumes.\nForms for this both Resumes are different with only two fields. \nResumes have 12 the same attributes but 2 are diferent.</p>\n\n<p><strong>Question</strong>:</p>\n\n<p>Should I split that Resume model and tables to ex: PolishResume and EnglishResume, polish_remsumes and english_remsumes?</p>\n\n<p>Or maybe should I use STI and create PolishResume &lt; Resume and use one table.</p>\n\n<p>What are disadvantages of splitting option?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","associations"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":33,"score":3,"question_id":13262543,"title":"Issue with association creates","body":"<p>Here are my associations...</p>\n\n<pre><code>Account has_many :credits\nCredit belongs_to :account\n</code></pre>\n\n<p>And I'm trying to run: <code>account.credits.current</code></p>\n\n<p>So, in that case, I've already got an <code>Account</code> object, and then I want to access a <code>current</code> method within the <code>Credit</code> model.</p>\n\n<p>Here is that method...</p>\n\n<pre><code>def self.current\n   # Find current credit line\n   current = self.where(:for_date =&gt; Time.now.strftime(\"%Y-%m-01\")).first\n\n   # If we couldn't find a credit line for this month, create one\n   current = Credit.create(:account_id =&gt; self.account.id, :for_date =&gt; Time.now.strftime(\"%Y-%m-01\")) if current.blank?\n\n   # Return the object\n   current\nend\n</code></pre>\n\n<p>The problem is on that second line...the one that should create a new credit entry if it can't find one. Specifically, I can't set what account it should be associated with. I just get an <code>undefined method 'account'</code> error.</p>\n"},{"tags":["ruby-on-rails-3","paypal","paypal-api","activemerchant"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13262627,"title":"ActiveMerchant Paypal Gateway/Express","body":"<p>I'm trying to integrate ActiveMerchange and PaypalExpress into my site, but I'm getting confused along the way. I've googled all over the place and watched several RailsCasts, but am still a little confused.</p>\n\n<p>In my app, I'm wanting to sell credits. The \"products\" to purchase are simply credits. They are not actual objects, nor are in the database, but are simply in a hash, for example:</p>\n\n<pre><code># 1 credit is $5, 5 credits are $25\n{\n  '1' =&gt; 5,\n  '5' =&gt; 25\n}\n</code></pre>\n\n<p>I do not want to use a Cart system like it shows in many online tutorials, I simply want the user to be able to select an amount of credits from a dropdown list, click \"Checkout with Paypal\", purchase the credits, and have it update their account.</p>\n\n<p>Can anyone guide me through this? I hope this isn't asking too much.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","asset-pipeline","sprockets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13261616,"title":"How can I access image_path route helper inside a Rails 3 model?","body":"<p>I'm trying to use Sprockets' image_path method from within a Rails 3 model. I've tried including <code>ActionView::Helpers::AssetTagHelper</code> in my model and calling image_path but that does not work (<code>undefined local variable or method 'config'</code>).</p>\n\n<p>Any ideas?</p>\n\n<p><strong>Update - this worked for me:</strong></p>\n\n<pre><code>ActionController::Base.new.view_context.asset_path(\"image.png\")\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13261884,"title":"Rails App not Recognizing Field Acceptance","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4746710/validates-acceptance-always-failing\">Validates acceptance always failing</a>  </p>\n</blockquote>\n\n\n\n<p>I'm using the <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow\">Simple Form</a> and <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow\">Devise</a> gems in my Rails 3.2 app.  In the user registration view, I have added a check box that is for user to check for agreeing to the Terms of Use for the app.  However, now, even when it is checked, the code doesn't realize that it's checked, so it's giving the error message that this required field is not accepted. </p>\n\n<p>It may have to do with me implementing the <code>content_for</code> code in the form based on this <a href=\"http://stackoverflow.com/questions/13053863/simple-form-how-to-make-accept-terms-checkbox-inline\">question</a>.</p>\n\n<p>User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, :validatable, :omniauthable\n\n  validates :agree_to_terms, :acceptance =&gt; true\nend\n</code></pre>\n\n<p>The view:</p>\n\n<pre><code>&lt;%= content_for(:the_links) do %&gt;\n  I agree to the &lt;%= link_to \"Terms of Service\", terms_path,:remote =&gt; true %&gt; \n  and &lt;%=link_to \"Privacy Policy\", privacy_path, :remote =&gt; true%&gt;\n&lt;% end %&gt;\n\n&lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n  &lt;%= f.input :agree_to_terms, :as =&gt; :boolean, :inline_label =&gt; content_for(:the_links), :label =&gt; false %&gt;\n  &lt;%= f.button :submit, \"Sign up\", :class =&gt;\"btn btn-success btn-large\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= render \"devise/shared/links\" %&gt;\n</code></pre>\n\n<p>\n</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13261800,"title":"Rails and Windows 8 - \"%1 is not a valid Win32 application\" error","body":"<h2>The Goal</h2>\n\n<p><strong>I'm trying to get Rails going</strong> for the first time <strong>and connected to MySQL</strong>, all on my local machine. As far as I can tell, Rails is installed according to spec. My setup is:</p>\n\n<ul>\n<li>Ruby 1.9.3 (installed via the latest version of the RubyInstaller)</li>\n<li>Rails 3.2.8</li>\n<li>Windows 8</li>\n<li>WAMP (which has the MySQL database I'd like to connect Rails to)</li>\n</ul>\n\n<h2>The Problem</h2>\n\n<p>When I run the command <code>rails s</code>, I receive the following error:</p>\n\n<pre><code>C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in 'require': 193: %1 is not a valid Win32 application - C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/1.9/mysql2.so (LoadError)\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/\nlib/mysql2/mysql2.rb:2:in '&lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/\nlib/mysql2.rb:9:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/\nlib/mysql2.rb:9:in '&lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:68:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:68:in 'block (2 levels) in require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:66:in 'each'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:66:in 'block in require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:55:in 'each'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/\nruntime.rb:55:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler.\nrb:128:in 'require'\n    from C:/Users/Andrew/Desktop/rails_test/simple_cms/config/application.rb\n:7:in '&lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:53:in 'require'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:53:in 'block in &lt;top (required)&gt;'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:50:in 'tap'\n    from C:/wamp/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/c\nommands.rb:50:in '&lt;top (required)&gt;'\n    from script/rails:6:in 'require'\n    from script/rails:6:in '&lt;main&gt;'\n</code></pre>\n\n<p>So there seems to be a problem with the <code>mysql2</code> gem? My reading has shown me that ~1-2 years ago it was a big issue, but I was of the understanding that the problems with it had been resolved at this point. (And if it is indeed better than <code>mysql</code>, then I'd like to use it!)</p>\n\n<h2>What I've Tried</h2>\n\n<ul>\n<li>I <em>was</em> getting the error \"126: the specified module could not be found\"; while looking up information regarding that, I came across the suggestion to copy \"libmysql.dll\" to Ruby's bin folder. It apparently fixed the 126 error, but now I'm getting this 193 error.</li>\n<li>Completely uninstalling Ruby, Rails, and reinstalling fresh multiple times using various different guides.</li>\n<li>Found <a href=\"http://myrailslearnings.wordpress.com/2012/07/03/error-cdevruby193librubysite_ruby1-9-1rubygemscustom_require-rb36in-require-193-1-is-not-a-valid-win32-application/\" rel=\"nofollow\">this blog post</a> where the author found that another program he had running was preventing <code>rails s</code> from working, so I closed everything and tried again. Nothing.</li>\n<li>Spent the past two days reading blogs and different posts by folks having the same issue, but it seems like <em>all</em> of them are from over a year ago, linking to (apparently successful!) fixes where the links are, unfortunately, now dead.</li>\n</ul>\n\n<p>If any further information is needed, please let me know! I've been Googling this problem for a large part of the past 48 hours to absolutely no avail. Any direction would be appreciated. :) Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13256865,"title":"How to manage multiple Subscriptions using one controller action?","body":"<p>I have following subscription creating system, right now when I`m selection available subscription groups(Marketing, Sales) action <code>Save Subscription</code> create this two subscriptions:</p>\n\n<pre><code>@apps = App.all\nif request.post?\n  if params[:subscription] and params[:subscription][:app_id]                       \n    params[:subscription][:app_id].each do |app_id|                \n      Subscription.create_unique({user_id: current_user.id, app_id: app_id, approved: true})\n    end\n    redirect_to root_path\n  end\nend\n@subscriptions = current_user.subscriptions \n</code></pre>\n\n<p>So I can only add new <code>Subscriptions</code>(in this particular example i can only add <code>Engineering</code>)</p>\n\n<p><img src=\"http://i.stack.imgur.com/5VoyD.png\" alt=\"Subscriptions\"></p>\n\n<p>How to refactor that action to be able also destroy subscription groups by uncheck them(ex. I want to unsubscribe from Marketing group) ?</p>\n\n<p>So when I choose <strong>Marketing</strong> and <strong>Enginnering</strong> then <code>params[:subscription][:app_id]</code> will be equal <code>[marketing.id, engineering.id]</code></p>\n\n<pre><code>  # app_menu.html.erb\n  &lt;%= form_for :subscription do |f| %&gt; # this form goes to app_menu action above\n    &lt;ul&gt;\n        &lt;% @apps.each do |app| %&gt;\n        &lt;li&gt;\n            &lt;%= check_box_tag app.id, current_user.access?(app) %&gt;&lt;span&gt;&lt;%= app.name %&gt;&lt;/span&gt;\n        &lt;/li&gt;\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n    &lt;%= f.submit %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Relations:</p>\n\n<pre><code>App\n  has_many :subscriptions\n  has_many :users, through: :subscriptions\nUser\n  belongs_to :app\n  has_many :subscriptions, :dependent =&gt; :destroy\nSubscription\n  belongs_to :user\n  belongs_to :app\n\n  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>Schema</p>\n\n<pre><code># == Schema Information\n#\n# Table name: subscriptions\n#\n#  admin      :boolean\n#  app_id     :integer\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  updated_at :datetime\n#  user_id    :integer\n#\n# Table name: apps\n#\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  name       :string(255)\n#  updated_at :datetime\n#  user_id    :integer\n#\n# Table name: users\n#\n#  app_id     :integer\n#  created_at :datetime\n#  id         :integer          not null, primary key\n#  updated_at :datetime\n</code></pre>\n\n<p>So the issue is how to find which apps has been unchecked? </p>\n\n<p>Then remove subscription for them and remove Feeds using <code>Feed.app_destroy_items(app)</code></p>\n"},{"tags":["ruby-on-rails-3","github","heroku"],"answer_count":2,"favorite_count":6,"up_vote_count":17,"down_vote_count":0,"view_count":1549,"score":17,"question_id":4840680,"title":"How can I specify a gem to pull from a private github repository?","body":"<p>I have a private repository on Github that I want to use. I deploy my app to Heroku. How can I specify a private repository as the source on my gemfile? I imagine it wouldn't be enough to simply say</p>\n\n<pre><code>gem \"mygem\", :git=&gt;\"my github address\" \n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","jquery-ui"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13241709,"title":"jQuery-UI Autocomplete Widget not binding to ajax loaded partial form in Rails","body":"<p>I have a form with a text field that uses jQuery-UI autocomplete widget. \nI'm loading this form as a partial using AJAX with Ruby on Rails <code>&lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_activity_path(activity), :remote =&gt; true  %&gt;&lt;/li&gt;</code> </p>\n\n<p>Since the form is being loaded after document.ready, the autocomplete jQuery widget is not binding to the DOM element.</p>\n\n<p>Since this isn't a jQuery AJAX call, I don't think that there is a success callback that I can use to bind the autocomplete widget with after the Ajax call. </p>\n\n<p>I'm not sure how to use the .on() function that I've seen around with the autocomplete Widget since the syntax is $('selector').autocomplete</p>\n\n<p>Can someone please help?</p>\n\n<p>This is the edit.js.erb file:</p>\n\n<pre><code>$(\"#activity_form\").html(\"&lt;%= escape_javascript(render(:partial =&gt; \"form\"))%&gt;\");\n</code></pre>\n\n<p>This is my jQuery code to bind the autocomplete widget to my text field.</p>\n\n<pre><code>jQuery -&gt;       \n$('[type=\"text\"][name*=\"[geocode_location]\"]').autocomplete\n  source: (request, response) -&gt;\n    $.ajax \n      url: \"http://ws.geonames.org/searchJSON\"\n      dataType: \"jsonp\"\n      data: \n        featureClass: \"P\"\n        style: \"full\"\n        maxRows: 12\n        name_startsWith: request.term\n\n      success: (data) -&gt;\n        response $.map(data.geonames, (item) -&gt;\n          label: item.name + ((if item.adminName1 then \", \" + item.adminName1 else \"\")) + \", \" + item.countryName\n          value: item.lat + \", \" + item.lng\n        )\n  minLength: 2\n\n  open: -&gt;\n    $(this).removeClass(\"ui-corner-all\").addClass \"ui-corner-top\"\n\n  close: -&gt;\n    $(this).removeClass(\"ui-corner-top\").addClass \"ui-corner-all\"\n  focus: (event, ui) -&gt;\n    event.preventDefault()\n    $(this).val ui.item.label      \n  select: (event, ui) -&gt;\n    event.preventDefault()\n    $(this).val ui.item.label\n    $(this).siblings('[name*=\"[geocode_ll]\"]').val ui.item.value\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","console"],"answer_count":6,"favorite_count":12,"up_vote_count":23,"down_vote_count":0,"view_count":2751,"score":23,"question_id":4736546,"title":"Rails 3 OSX - Speed up Console Loading Time","body":"<p>I am wondering if there is any relatively easy way to speed up my console load time, which is starting to approach 30 seconds.  I have a lot of subclasses whose methods don't seem to be affected by <code>reload!</code> so I end up opening and closing the console a lot.  IRB loads lightning quick.  </p>\n\n<p>Do I have too many gems?  How do I go about timing the load tasks so I can see what is taking up the most time?  As you can see, I've already tried the dev-boost gem to no avail.  The app is fine in Passenger, it's just the console loading that bugs the crap out of me.  Running on MBP OSX 10.6.6 with 2.4GHz and 4GB RAM.  Not using RVM. </p>\n\n<p>Versions:</p>\n\n<pre><code>Ovid$ rails -v\nRails 3.0.3\nOvid$ ruby -v\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10]\n</code></pre>\n\n<p>Memory:</p>\n\n<pre><code>Ovid$ vm_stat\nMach Virtual Memory Statistics: (page size of 4096 bytes)\nPages free:                         118818.\nPages active:                       341320.\nPages inactive:                      99490.\nPages speculative:                  310576.\nPages wired down:                   112527.\n\"Translation faults\":             23097323.\nPages copy-on-write:               1270961.\nPages zero filled:                13836659.\nPages reactivated:                      36.\nPageins:                            165761.\nPageouts:                                0.\nObject cache: 28 hits of 760846 lookups (0% hit rate)\n</code></pre>\n\n<p>Gemfile:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.3'\ngem 'mysql2'\ngem 'foreigner'\ngem 'haml'\ngem 'capistrano'\ngem 'nokogiri'\n\n#web services\ngem 'yammer4r'\ngem 'ruby-freshbooks'\n\n#authentication gems from nifty generator\ngem \"bcrypt-ruby\", :require =&gt; \"bcrypt\"\ngem \"mocha\", :group =&gt; :test\ngem 'authlogic'\n\n#dev\ngroup :development do\n  gem 'rails-dev-boost', :git =&gt; 'git://github.com/thedarkone/rails-dev-boost.git', :require =&gt; 'rails_development_boost'\nend\n\n#testing\ngroup :test do\n  gem 'database_cleaner'\n  gem 'cucumber-rails'\n  gem 'cucumber'\n  gem 'rspec-rails'\n  gem 'spork'\n  gem 'launchy'\n  gem 'machinist'\n  gem 'faker'\n  gem 'capybara'\nend\n</code></pre>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations","model-associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13256607,"title":"What is wrong with my association?","body":"<p>I am looking to setup a relationship where a user can create a post and tag that post. That post and those tags belong to that user. </p>\n\n<p>I've been trying to debug this for the last three days. I don't know why when I save my Post, the user_id does not populate in the Tag model. I added the user_id into the Tag model. </p>\n\n<p>I apologize in advance for the excessive code.</p>\n\n<p>User - has_many posts; has_many tags</p>\n\n<p>Post - belongs_to user; has_many taggings; has_many tags through taggings</p>\n\n<p>Tag - has many taggings; has_many posts through taggings; belongs_to user</p>\n\n<p>Tagging - belongs_to post; belongs_to tag</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121031012555) do\n\n  create_table \"posts\", :force =&gt; true do |t|\n    t.integer  \"user_id\"\n    t.string   \"summary\"\n    t.datetime \"created_at\",  :null =&gt; false\n    t.datetime \"updated_at\",  :null =&gt; false\n  end\n\n  create_table \"taggings\", :force =&gt; true do |t|\n    t.integer  \"post_id\"\n    t.integer  \"tag_id\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  add_index \"taggings\", [\"post_id\"], :name =&gt; \"index_taggings_on_post_id\"\n  add_index \"taggings\", [\"tag_id\"], :name =&gt; \"index_taggings_on_tag_id\"\n\n  create_table \"tags\", :force =&gt; true do |t|\n    t.string   \"name\"\n    t.integer  \"user_id\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"users\", :force =&gt; true do |t|\n    t.string   \"username\"\n    t.string   \"email\"\n    t.string   \"crypted_password\"\n    t.string   \"password_salt\"\n    t.string   \"persistence_token\"\n    t.datetime \"created_at\",        :null =&gt; false\n    t.datetime \"updated_at\",        :null =&gt; false\n    t.string   \"role\"\n  end\n\nend\n</code></pre>\n\n<p>In the post Model:</p>\n\n<pre><code>def tag_ids=(tags_string)\n    self.taggings.destroy_all\n\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    tag_names.each do |tag_name|\n      tag = Tag.find_or_create_by_name(tag_name)\n      tagging = self.taggings.new\n      tagging.tag_id = tag.id\n    end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","gem","jekyll"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13259568,"title":"Heroku push rejected, failed to complie Ruby/Rack app with Jekyll","body":"<p>I have a Jekyll website I created that I want to deploy to Heroku. However, it's not working for me. The terminal responded with</p>\n\n<pre><code>   Running: bundle install --without development:test --path vendor/bundle --binstubs  \n   bin/ --deployment\n   Could not find posix-spawn-0.3.6 in any of the sources\n\n   Failed to install gems via Bundler.\n\n   Heroku push rejected, failed to compile Ruby/rack app\n</code></pre>\n\n<p>My gemfile looks like this...</p>\n\n<pre><code>gem 'rack-jekyll', :git =&gt; 'https://github.com/adaoraul/rack-jekyll.git', :require =&gt; \n'rack/jekyll'\n</code></pre>\n\n<p>And my config.ru looks like...</p>\n\n<pre><code>require 'bundler'\nBundler.require(:default, :production)\n\nrun Rack::Jekyll.new\n</code></pre>\n\n<p>My question is, how do I fix this? I've already tried <code>bundle install</code> and <code>bundle update</code> in my project directory.</p>\n"},{"tags":["arrays","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13259571,"title":"Need save an id from a drop down list of a related tables objects","body":"<p>i have this form that saves the relation between 2 tables in my db</p>\n\n<p>Treatments <code>belongs_to :category</code></p>\n\n<p>Category <code>has_many :treatments</code></p>\n\n<p>When a treatment is created it should save the id of the category and i want the category to be a drop down list, here is my code for the form :</p>\n\n<pre><code>&lt;%= form_for(@treatment) do |f| %&gt;  \n  &lt;div class=\"field\"&gt;\n    &lt;select&gt; \n      &lt;% Category.find(:all).each do |cat| %&gt;   \n        &lt;option&gt;&lt;%= cat.name %&gt;&lt;/option&gt;  \n      &lt;% end %&gt;\n    &lt;/select&gt;\n  &lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :name %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n</code></pre>\n\n  \n\n<p>Okey so i was able to display all the categories names but im kinda lost at how i should save the <code>cat.id</code> with the form</p>\n\n<p>btw im quite new to rails if you haven't noticed :)</p>\n\n<p>any thoughts ?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>here is the html that is generated</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;label for=\"treatment_category\"&gt;Category&lt;/label&gt;\n  &lt;br&gt;\n    &lt;select id=\"category_category_id\" name=\"category[category_id]\"&gt;\n    &lt;option value=\"\"&gt;Velja flokk&lt;/option&gt;\n    &lt;option value=\"1\"&gt;Nudd&lt;/option&gt;\n    &lt;option value=\"2\"&gt;Heilun&lt;/option&gt;\n    &lt;option value=\"3\"&gt;Nálastunga&lt;/option&gt;\n  &lt;/select&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>okey noticed an error in the html changed <code>id=\"treatment_category_id\"</code> and now in my show view i see the categorie connected to the treatment but its name looks like <code>Category:0x3eb7d90</code></p>\n\n<p>here is my view, its just a basic scaffold but i added the <code>.name</code> </p>\n\n<pre><code>&lt;p&gt;\n &lt;b&gt;Category:&lt;/b&gt;\n  &lt;%= @treatment.category.name %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;b&gt;Name:&lt;/b&gt;\n  &lt;%= @treatment.name %&gt;\n&lt;/p&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","formtastic"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13257581,"title":"Formtastic: insert preloaded text in input field","body":"<p>How can I add a preloaded costant string in a classic input field in Formtastic?</p>\n\n<p>I have searched a lot, but I haven't find how to resolve this.</p>\n\n<p>For example I have this line of code in my form:</p>\n\n<pre><code>&lt;%= f.input :url, :hint =&gt; \"Url in the form of: http//www.mysite.com\"  %&gt;\n</code></pre>\n\n<p>and in the input field I want to preload the: \"http://\", so the user must fill only the remaining of the URL. </p>\n"},{"tags":["ruby-on-rails-3","devise","cucumber"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13257059,"title":"unknown attribute username where username does exist","body":"<p>On my rails project I try to swith from email login to username login with the devise gem.\nAs far I did all the steps but when I do cucumber I see this output:</p>\n\n<pre><code>Given a user \"Aslak\" exists         \n# features/step_definitions/login_steps.rb:16\n  unknown attribute: username (ActiveRecord::UnknownAttributeError)\n  ./features/step_definitions/login_steps.rb:17:in `/^a user \"(.*?)\" exists$/'\n  features/login.feature:4:in `Given a user \"Aslak\" exists'\n</code></pre>\n\n<p>The Given a user ¨Aslak¨ exist looks like this :</p>\n\n<pre><code>Given /^a user \"(.*?)\" exists$/ do |user_name|\n  @user = User.create!(:username =&gt; user_name, :password =&gt; \"s3cr3t\")\nend\n</code></pre>\n\n<p>But when I do rails c </p>\n\n<pre><code>u = User.first \n</code></pre>\n\n<p>I see this output:</p>\n\n<pre><code>=&gt; #&lt;User id: 1, email: \"aslak@tamarawobben.nl\", encrypted_password: \"$2a$10$XjYgPtD4Ol4/sEpe934O6.yPcxs.jBF.m9SNTV.qhJp4...\", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 3, current_sign_in_at: \"2012-11-05 20:27:44\", last_sign_in_at: \"2012-11-05 19:35:00\", current_sign_in_ip: \"127.0.0.1\", last_sign_in_ip: \"127.0.0.1\", created_at: \"2012-11-03 20:21:54\", updated_at: \"2012-11-06 07:58:36\", username: \"asLak\"&gt;\n</code></pre>\n\n<p>So it looks like to me that username is existing. </p>\n\n<p>Anyone a idea how to solve this ?</p>\n\n<p>Roelof</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","layout","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13257084,"title":"Categorize webpages for layout and CSS purposes in Rails","body":"<p>I have a lot of different webpages, but most fall into 1 of 6 or 7 categories of pages. For each of these categories of webpages, I have a slightly different look and feel, like different background colors/images. I have the following in <code>views/layout/application.html.erb</code>:</p>\n\n<pre><code>&lt;header class=\"sub&lt;% if content_for?(:page_type) %&gt; &lt;%= yield(:page_type) %&gt;&lt;% end %&gt;\"&gt;\n</code></pre>\n\n<p>And in every single view, I have:</p>\n\n<pre><code>&lt;% content_for :page_type, 'information' %&gt;\n</code></pre>\n\n<p>But it's really a pain to do that for every single webpage and when I want to change things around I keep having to mess with these (I have a ton of pages). So, instead I'm thinking to just use a variable:</p>\n\n<pre><code>&lt;header class=\"sub&lt;%= @page_type ? ' ' + @page_type : '' %&gt;\"&gt;\n</code></pre>\n\n<p>and for views:</p>\n\n<pre><code>&lt;% @page_type = 'information' %&gt;\n</code></pre>\n\n<p>The advantage is I could do a <code>before_filter :set_page_type</code> in the controller and set the page type once for all the views it controls (a big help).</p>\n\n<p>Maybe the best thing for me to do is just use the first folder of the URL as the category of the webpage. I'll have to restructure the URLs, but that might make sense to do so anyway. I do have some top-level pages that would have to remain so.</p>\n\n<p>This has to be a fairly common situation, what is the best way to categorize most pages and use that categorization in layouts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","wordpress"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13114081,"title":"Searching WordPress blog from Rails app","body":"<p>I have a site-wide custom written search controller for my Rails 3 app and would like to include results from the site's WordPress blog. What is the best way for me to perform a keyword search on posts from within my Rails app?</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":65,"score":1,"question_id":13238878,"title":"Look for help on Ruby on Rails","body":"<p>I am new with Ruby on Rails. I just build web application on the existing database. I use rails to generate 2 scaffolds for restaurant and location tables. After that I set relationship for these two tables:</p>\n\n<pre><code> class Restaurant &lt; ActiveRecord::Base\n  attr_accessible :created, :cuisine_fk, :dish_keywords, :dish_names, :factual_id, :first_name, :last_name, :name, :status\n\n\n  has_many :locations \nend\n\nclass Location &lt; ActiveRecord::Base\n  attr_accessible :address1, :address2, :city, :created, :latitude, :longitude, :phone, :restaurant_fk, :state, :status, :url, :zip\n\n  belongs_to :restaurant\n end\n</code></pre>\n\n<p>I didn't use \"rake db:migrate\" after I set up this relationship for these tables, because I was afraid that this action would make changes the existing tables.</p>\n\n<p>When I run this command line</p>\n\n<pre><code>&lt;%= restaurant.location.address1%&gt; \n</code></pre>\n\n<p>it shows error:</p>\n\n<pre><code>undefined method `location'\n\n\" NoMethodError in Restaurants#index\n\nShowing C:/Sites/Dishclips/app/views/restaurants/index.html.erb where line #52 raised:\n\nundefined method `location' for #&lt;Restaurant:0x5853bb8&gt; \"\n</code></pre>\n\n<p>After that I tried to set foreign key for the file:</p>\n\n<pre><code>class Location &lt; ActiveRecord::Base\n  attr_accessible :address1, :address2, :city, :created, :latitude, :longitude, :phone, :restaurant_fk, :state, :status, :url, :zip\n\n  belongs_to :restaurant, :class_name =&gt; \"Restaurant\", :foreign_key =&gt; 'restaurant_fk'\n end\n</code></pre>\n\n<p>but it still doen't work. </p>\n\n<p>Is there any way that we can set foreign keys in stead of using \"rails db:migrate\" after we set up the relationships for tables ?  I appreciate your help a lot.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","seeding"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":3040,"score":4,"question_id":3476987,"title":"appending to rake db:seed in rails and running it without duplicating data","body":"<p>Rake db:seed populates your db with default database values for an app right? So what if you already have a seed and you need to add to it(you add a new feature that requires the seed). In my experience, when I ran rake db:seed again, it added the existing content already so existing content became double.</p>\n\n<p>What I need is to add some seeds and when ran, it should just add the newest ones, and ignore the existing seeds. How do I go about with this? (the dirty, noob way I usually do it is to truncate my whole db then run seed again, but that's not very smart to do in production, right?)</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":11986420,"title":"RubyOnRails3 - event_calendar","body":"<p>I use event_calendar gem and it works probably for me, but I face problem of how to change color of events by type, I mean how to make for example personal events like birthday or trip colored with blue and work events like meetings colored with red etc..\nCan this be done by css or code? I hope you can help me with this -- Thanks.</p>\n"},{"tags":["ruby","ruby-on-rails-3","mailman-gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13259142,"title":"How should I test Mailman app","body":"<p>I'm trying to write some specs for my application aimed to process and resend incoming emails. It's built with Mailman App. I didn't find any good examples on how to do that. What am I actually trying is to create email (with Mail gem) and process it with Mailman. But there is only option of using stding for testing.</p>\n\n<p>So, are there any examples of specs written to test the mailman apps?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13258203,"title":"delayed_job pid file location","body":"<p>Does anyone know how to configure delayed_jobs to place the pid file in another folder?  I see the pid_dir as an option, but not sure how to include the option in an initializer or within the script/delayed_job.</p>\n"},{"tags":["ruby-on-rails-3","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13258406,"title":"Cannot find application.html.haml in a new Rails 3 app","body":"<p>I want to create Rails 3 app just to update myself, but I have strange issue.</p>\n\n<p>I have created <code>welcome#index</code> action using </p>\n\n<pre><code>rails generate controller welcome#index\n</code></pre>\n\n<p>(I have <code>haml-rails</code> gem) and I observe that a new view <code>index.html.haml</code> has been created. This action is my root_path, so in <code>localhost:3000</code> I get content of this view. </p>\n\n<p>I had <code>application.html.erb</code> which I have changed manually to <code>application.html.haml</code> and I have added <code>layout 'application'</code> in ApplicationController, but I get </p>\n\n<pre><code>Template is missing\n\nMissing template layouts/application with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee, :haml]}\n</code></pre>\n\n<p>now, any ideas why ?</p>\n\n<p>Maybe some code snippets:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  layout \"application\"\n  protect_from_forgery\nend\n</code></pre>\n\n<p>the file is in place:</p>\n\n<pre><code>mkk:~/projects/rails/gifts/app/views/layouts$ ls\napplication.html.html\n</code></pre>\n"},{"tags":["ruby-on-rails-3","routing","subdomain","localhost","thin"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13256485,"title":"Subdomain constraint (Rails 3) makes local server (thin) SO SLOW","body":"<p>I recently added a subdomain constraint to my Rails routes file</p>\n\n<pre><code>constraints(:subdomain =&gt; 'new') do\n  devise_for :customers do \n    get \"/customers/sign_up\" =&gt; \"registrations#new\"\n    post \"/customers\" =&gt; \"registrations#create\"\n    put \"/customers/:id\" =&gt; \"registrations#update\"\n  end\n  match '/' =&gt; 'roxy#index'\n  namespace :roxy, :path =&gt; '/' do\n    resources :customers\n    resources :surveys\n  end\nend \n</code></pre>\n\n<p>In order to test the subdomain routing constraint locally, I added this line to my hosts file.</p>\n\n<pre><code>127.0.0.1       new.localhost.local\n</code></pre>\n\n<p>Now, I test my app in my browser at the URL new.localhost.local:3000. It takes about 10 - 15 seconds to load every page, which is unreasonably slow. If I remove the subdomain constraint and just go to 127.0.0.1:3000, everything is zippy and fast again.</p>\n\n<p>What am I doing wrong? I'm new to Rails, so please tell me if there is a better way to do subdomain routing in rails, or if there is a setting I need to configure.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13257596,"title":"Rails 3.2 strict mass assignment defaults","body":"<p>In a new rails project what is the reason mass assignment is not set to strict in production and the reason that it is set to strict in development and test?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","actionmailer","multipart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13256593,"title":"How to see the multipart/alternative email in Rails?","body":"<p>When sending a multipart/alternative email, the body is empty:</p>\n\n<pre><code>m = send_mail\n=&gt; &lt;Mail::Message:70121014358060, Multipart: true, Headers: &lt;Date: Tue, 06 Nov 2012 09:18:06\n-0800&gt;, &lt;From: foo@example.com&gt;, &lt;To: bar@example.com&gt;, \n&lt;Message-ID: &lt;5099464e821ef_71113fc654c35xe065537@Air.local.mail&gt;&gt;, &lt;Subject: \nTest&gt;, &lt;Mime-Version: 1.0&gt;, &lt;Content-Type: \nmultipart/alternative; boundary=\"--==_mimepart_5099422e825b0_71113fc654c34ce068277\";\ncharset=UTF-8&gt;, &lt;Content-Transfer-Encoding: 7bit&gt;&gt;\n\nm.body\n=&gt;\n</code></pre>\n\n<p>How to inspect the body or the different parts?</p>\n\n<p>Rails 3.2.2</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","gem","database-connection"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":123,"score":1,"question_id":10352638,"title":"Rails gem uses the development db instead of the testing one when executing \"rake test\"","body":"<p>I'm using a gem with my rails 3 project, \"rails-settings-cached\", and when I'm in development mode the gem can access the database without any problem.\nHowever, when I run \"rake test\", a lot of tests fails because \"rails-settings-cached\" keeps using the development db instead of the testing one.</p>\n\n<p>The other parts of my application works fine. What should I do to connect the gem to the right database?</p>\n\n<pre><code>development:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: mmdb_development\n  pool: 5\n  username: ***\n  password: ***\n  socket: /var/run/mysqld/mysqld.sock\n\ntest:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: mmdb_test\n  pool: 5\n  username: ***\n  password: ***\n  socket: /var/run/mysqld/mysqld.sock\n</code></pre>\n"},{"tags":["ruby-on-rails-3","facebook","facebook-graph-api","omniauth","koala"],"answer_count":2,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":1043,"score":4,"question_id":9214671,"title":"Deprecated offline_access on facebook with RoR","body":"<p>We have a problem in our RoR app. We are using a facebook authentication with omniauth, and searching the user friends with Koala. But lately, when we try to show a friend photo, we got this error:</p>\n\n<pre><code>Koala::Facebook::APIError in Homes#show\n\nShowing /home/daniel/Homes/app/views/shared/_event.html.erb where line #19 raised:\n\nOAuthException: Error validating access token: Session has expired at unix time 1328727600. The current unix time is 1328802133.\nExtracted source (around line #19):\n\n16:     &lt;img src=\"../assets/friends-icon.png\" alt=\"User  profile apicture\" height=\"33\" width=\"43\"&gt;\n17:         &lt;% if current_user %&gt;\n18:           &lt;% event.friends_in_event(@person).each do |f| %&gt;\n19:             &lt;%= link_to(image_tag(f.fb_picture, :size =&gt; \"43x33\"), person_path(f.id)) %&gt;\n20:           &lt;% end %&gt;\n21:         &lt;% end %&gt;\n22:       &lt;/div&gt;\n</code></pre>\n\n<p>The authentication works good, but facebook has already deprecated the offline_access option, that was working good, but now, we have this issue.\nis It any way to extends the access_token?, or are there another solution?.</p>\n\n<p>This is our omniauth.rb</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :facebook, ENV['FB_KEY'], ENV['FB_SECRET'], \n  { :scope =&gt; 'email,offline_access,user_photos,publish_stream',\n    :client_options =&gt; { :ssl =&gt; { :ca_path =&gt; \"/etc/ssl/certs\" } } }\nend\n</code></pre>\n\n<p>And our koala.rb</p>\n\n<pre><code>Koala.http_service.http_options = {\n  :ssl =&gt; { :ca_path =&gt; \"/etc/ssl/certs\" }\n}\n</code></pre>\n\n<p>Thanks in advance. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13256445,"title":"Devise set different root path per user type","body":"<p>I've created a devise user model. There are 2 types of user:</p>\n\n<ul>\n<li>customer</li>\n<li>admin</li>\n</ul>\n\n<p>I've accomplished bij creating two 'normal' models: customer and admin. These two models are inheriting from the user model, like so:</p>\n\n<pre><code>class Customer &lt; User\n</code></pre>\n\n<p>Does anyone know how I can setup a root path per type of user. I want something like this:</p>\n\n<pre><code>authenticated :customer do\n  root :to =&gt; \"customer/dashboard#index\"\nend\n\nauthenticated :admin do\n  root :to =&gt; \"admin/dashboard#index\"\nend    \n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I've solved the problem:</p>\n\n<pre><code>root :to =&gt; \"pages#home\", :constraints =&gt; lambda { |request|!request.env['warden'].user}\nroot :to =&gt; 'customer/dashboard#index', :constraints =&gt; lambda { |request| request.env['warden'].user.type == 'customer' }\nroot :to =&gt; 'admin/dashboard#index', :constraints =&gt; lambda { |request| request.env['warden'].user.type == 'admin' }\n</code></pre>\n"},{"tags":["ruby-on-rails","testing","ruby-on-rails-3","amazon-s3","shoulda"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":1737,"score":5,"question_id":3657972,"title":"NameError: uninitialized constant Test::Unit::AssertionFailedError when upgrading to rails3","body":"<p>I'm trying to upgrade my rails application to Rails3.</p>\n\n<p>When I run functional tests, I get a lot of <code>NameError: uninitialized constant Test::Unit::AssertionFailedError</code> errors. But unit tests and website itself seems to work fine.</p>\n\n<p>Trace looks like this:</p>\n\n<pre><code>NameError: uninitialized constant Test::Unit::AssertionFailedError\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/gems/aws-s3-0.6.2/lib/aws/s3/extensions.rb:206:in `const_missing_from_s3_library'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:52:in `rescue in redirects_to_url?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:48:in `redirects_to_url?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/action_controller/matchers/redirect_to_matcher.rb:35:in `matches?'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/assertions.rb:53:in `assert_accepts'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:324:in `block in should'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:382:in `call'\n/Users/mantas/.rvm/gems/ruby-1.9.2-p0/bundler/gems/shoulda-02520e4/lib/shoulda/context.rb:382:in `block in create_test_from_should_hash'\n</code></pre>\n\n<p>Both Shoulda and Amazon S3 gems are latest versions.</p>\n\n<p>Any ideas what I am doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13240036,"title":"Why won't my textarea update through Ajax after entry has been re-saved to database?","body":"<p>I am updating a simple <code>text_area</code> in Rails using Ajax:</p>\n\n<p><strong>application.js</strong>:</p>\n\n<pre><code>$(\"#invoice_project_id\").change(function() {\n    var value=$(this).val();\n    $.get('/invoices/get_recipient', {project_id= : value}  function(response) {\n        $('#invoice_recipient').val(response);\n    })\n});​\n</code></pre>\n\n<p><strong>get_recipient.js</strong>:</p>\n\n<pre><code>$('#invoice_recipient').val(\"&lt;%= @recipient.to_s.gsub!(/\\n/, '\\n') %&gt;\");\n</code></pre>\n\n<p><strong>invoices_controller.rb</strong>:</p>\n\n<pre><code>def get_recipient\n  project = Project.find(params[:project_id])\n  @recipient = project.person.address\nend\n</code></pre>\n\n<p>The code works great and replaces the value of the <code>recipient</code> text_area with the correct address, depending on what <code>project</code> gets chosen in the select menu.</p>\n\n<p>The problem is that it works only with the <code>addresses</code> that already exist in the database. (I am using the <a href=\"http://faker.rubyforge.org\" rel=\"nofollow\"><strong>Rails Faker gem</strong></a> to populate my database.) The moment I <strong>re-save</strong> a <code>person</code>'s <code>address</code> manually in my Safari browser, the text_area won't get updated through Ajax anymore when I try to do so using the above code.</p>\n\n<p>How is this possible? </p>\n\n<p>I am already escaping the newline characters using the <code>gsub!</code> method above, so I can't think of anything else I could do.</p>\n\n<p>Can anybody help?</p>\n\n<p>Thanks...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","timezone"],"answer_count":3,"favorite_count":12,"up_vote_count":16,"down_vote_count":0,"view_count":13529,"score":16,"question_id":4362663,"title":"Timezone with rails 3","body":"<p>I have pretty common issue but for some reason i have tried all the suggestions on the web and none seem to work. </p>\n\n<p>I have set the Timezone in config to 'EST'</p>\n\n<pre><code>config.time_zone = 'Eastern Time (US &amp; Canada)'\n</code></pre>\n\n<p>But when the time is shown on the the screen, it continues to show the UTC time that is stored in the DB. I tried the debugger and here is the output</p>\n\n<pre><code>(rdb:1) Time.zone \n#&lt;ActiveSupport::TimeZone:0x1061f4760 @utc_offset=nil, @current_period=nil, @name=\"Eastern Time (US &amp; Canada)\", @tzinfo=#&lt;TZInfo::TimezoneProxy: America/New_York&gt;&gt;\n(rdb:1) Order.first.placed_at\nFri Jan 01 15:00:00 UTC 2010\n</code></pre>\n\n<p>Update: \nHere is another user who has the same question\n<a href=\"http://stackoverflow.com/questions/3203304/rails-timezone-is-wrong-when-shown\">Rails timezone is wrong when shown</a></p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13223146,"title":"Why is response.body is a string instance when testing controller with rspec","body":"<p>In the rspec test for my controller the response's body is always a string representation of an ActiveDispatch::Response instance.</p>\n\n<pre><code>=&gt; #&lt;ActionController::TestResponse:0x00000007863010\n ...\n @body=[\"#&lt;ActionDispatch::Response:0x00000007530d70&gt;\"],...\n</code></pre>\n\n<p>The controller spec  in question:</p>\n\n<pre><code>it 'should not allow invalid email' do\n     json = { :format =&gt; 'json', :patron_profile =&gt; { :email =&gt;   'bogusemail.com', :password =&gt; 'password' } }\n     post :create, json\n     response.status.should eq(302)\n     response.body.to_json.should be_json_eql(%({ 'error' : 'error message'}))\nend\n</code></pre>\n\n<p>What could cause the <code>response.body</code> to be the ActionDispatch string shown above?</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","rubygems","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":471,"score":0,"question_id":9310287,"title":"rails 3.1 Engines Gemspec and config initializers","body":"<p>I am developing an rails 3.1 mountable engine. Build the engine very well and mounted it on a sub-domain. Now what i am having issue is that, in my <code>engine</code> <code>Gemfile</code> i specified a gem:</p>\n\n<pre><code>gem \"show_for\", \"~&gt; 0.2.4\"\n</code></pre>\n\n<p>also in <code>.gemspec</code> file </p>\n\n<pre><code>s.add_dependency \"show_for\", \"~&gt; 0.2.4\"\n</code></pre>\n\n<p>then i used engine's <code>script/rails g show_for:install</code> and it created a <code>initializer file</code> in config/initilizers directory.</p>\n\n<p>When i go to <code>main_app</code> and run <code>bundle install</code> it shows that gem in the list. But when i start the application it show the error:</p>\n\n<pre><code>path_to_my_engine/config/initializers/show_for.rb:2:in `&lt;top (required)&gt;': uninitialized constant ShowFor (NameError)\n</code></pre>\n\n<p>How can we resolve this issue?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-masonry","turbolinks"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13256649,"title":"turbolinks with masonry is not working","body":"<p>I have installed turbolink gem <a href=\"https://github.com/rails/turbolinks\" rel=\"nofollow\">https://github.com/rails/turbolinks</a> in my rails app 3.2.8.</p>\n\n<p>I use this gem, masonry for show elements <a href=\"https://github.com/desandro/masonry\" rel=\"nofollow\">https://github.com/desandro/masonry</a>.</p>\n\n<p>The problem is that masonry elements when I open a new page with turbolinks are not loaded correctly.</p>\n\n<p>How can I fix this problem?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["jquery","ruby-on-rails-3","layout","heroku","jplayer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13253026,"title":"jPlayer working with Rails app locally, but not when deployed to Heroku","body":"<p>I have the jPlayer audio player working fine locally, but when I deploy to Heroku, it no longer works and I get the following error in Chrome's console:</p>\n\n<pre><code>Uncaught TypeError: Object [object Object] has no method 'jPlayer' \n</code></pre>\n\n<p>Here's the Javascript for jPlayer in my application.html.erb layout:</p>\n\n<pre><code>  &lt;script type=\"text/javascript\"&gt;\n  $(document).ready(function(){\n    $(\"#jquery_jplayer_1\").jPlayer({\n      ready: function () {\n        $(this).jPlayer(\"setMedia\", {\n             mp3: \"http://test.com/song.mp3\",\n          // m4a: \"http://www.jplayer.org/audio/m4a/Miaow-07-Bubble.m4a\",\n          // oga: \"http://www.jplayer.org/audio/ogg/Miaow-07-Bubble.ogg\"\n        });\n      },\n      swfPath: \"/javascriptipts\",\n      supplied: \"mp3, m4a, oga\"\n    });\n  });\n</code></pre>\n\n<p></p>\n\n<p>I'm noticing that the way the scripts are included seems to be working differently than it is on Heroku. For my local instance (which works) the scripts included look like this in the source:</p>\n\n<pre><code>   &lt;link href=\"/assets/application.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/bootstrap-responsive.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/bootstrap.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/calls.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/jplayer.blue.monday.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/main.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n   &lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-alert.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-button.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-carousel.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-collapse.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-dropdown.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-modal.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-popover.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-scrollspy.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-tab.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-tooltip.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-transition.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap-typeahead.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/bootstrap.min.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/calls.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/custom.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/google-code-prettify/prettify.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery-ui.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.jplayer.min.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>On Heroku, where jPlayer is not working, the scripts loaded look like this in the source for some reason:</p>\n\n<pre><code>&lt;link href=\"/assets/application-7d9d2071282c290d4dd4bb767188d15f.css\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;script src=\"/assets/application-679ead39cc620e8b5be4723def8305ce.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Here's how I include them in my application.html.erb layout:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>Anyone have any thoughts what might be causing this and how I can fix it?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":98,"score":2,"question_id":12875743,"title":"Heroku installing sqlite3 even though it is not a dependecy","body":"<p>I am trying to deploy my app to Heroku, but it keeps getting rejected with the following output.</p>\n\n<pre><code>waitup$git push staging master\nCounting objects: 4184, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (1033/1033), done.\nWriting objects: 100% (4184/4184), 1.11 MiB | 494 KiB/s, done.\nTotal 4184 (delta 3069), reused 4184 (delta 3069)\n\n-----&gt; Heroku receiving push\n-----&gt; Ruby/Rails app detected\n-----&gt; Installing dependencies using Bundler version 1.2.1\n       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment\n       Fetching gem metadata from http://rubygems.org/.......\n       Fetching https://github.com/stripe/stripe-ruby\n       Installing rake (0.8.7)\n       Installing abstract (1.0.0)\n       Installing activesupport (3.0.4)\n       Installing builder (2.1.2)\n       Installing i18n (0.5.0)\n       Installing activemodel (3.0.4)\n       Installing erubis (2.6.6)\n       Installing rack (1.2.2)\n       Installing rack-mount (0.6.14)\n       Installing rack-test (0.5.7)\n       Installing tzinfo (0.3.27)\n       Installing actionpack (3.0.4)\n       Installing mime-types (1.16)\n       Installing polyglot (0.3.1)\n       Installing treetop (1.4.9)\n       Installing mail (2.2.19)\n       Installing actionmailer (3.0.4)\n       Installing bcrypt-ruby (2.1.4) with native extensions\n       Installing orm_adapter (0.0.5)\n       Installing warden (1.0.4)\n       Installing devise (1.3.4)\n       Installing formtastic (1.2.3)\n       Installing has_scope (0.5.0)\n       Installing responders (0.6.4)\n       Installing inherited_resources (1.2.2)\n       Installing will_paginate (3.0.pre2)\n       Installing inherited_views (0.0.2)\n       Installing arel (2.0.9)\n       Installing activerecord (3.0.4)\n       Installing meta_search (1.0.5)\n       Installing activeresource (3.0.4)\n       Using bundler (1.2.1)\n       Installing thor (0.14.6)\n       Installing railties (3.0.4)\n       Installing rails (3.0.4)\n       Installing sass (3.1.2)\n       Installing activeadmin (0.2.2)\n       Installing addressable (2.2.6)\n       Installing authlogic (2.1.6)\n       Installing celerity (0.8.8)\n       Installing culerity (0.2.15)\n       Installing nokogiri (1.4.4) with native extensions\n       Installing ffi (0.6.3) with native extensions\n       Installing childprocess (0.1.7)\n       Installing json_pure (1.5.1)\n       Installing rubyzip (0.9.4)\n       Installing selenium-webdriver (0.1.3)\n       Installing xpath (0.1.3)\n       Installing capybara (0.4.1.2)\n       Installing configuration (1.2.0)\n       Installing cookiejar (0.3.0)\n       Installing diff-lcs (1.1.2)\n       Installing json (1.5.1) with native extensions\n       Installing gherkin (2.3.7) with native extensions\n       Installing term-ansicolor (1.0.5)\n       Installing cucumber (0.10.2)\n       Installing cucumber-rails (0.3.1)\n       Installing daemons (1.1.6)\n       Installing database_cleaner (0.6.4)\n       Installing hiredis (0.3.2) with native extensions\n       Installing em-hiredis (0.1.0)\n       Installing escape_utils (0.2.4) with native extensions\n       Installing eventmachine (0.12.10) with native extensions\n       Installing em-http-request (0.3.0) with native extensions\n       Installing thin (1.3.1) with native extensions\n       Installing faye (0.7.1)\n       Installing launchy (0.4.0)\n       Installing rest-client (1.6.3)\n       Installing heroku (2.2.8)\n       Installing jquery-rails (1.0.7)\n       Installing jwt (0.1.3)\n       Installing multi_json (1.0.3)\n       Installing mysql2 (0.2.7) with native extensions\n       Installing rspec-core (2.5.1)\n       Installing rspec-expectations (2.5.0)\n       Installing rspec-mocks (2.5.0)\n       Installing rspec (2.5.0)\n       Installing rspec-rails (2.5.0)\n       Installing seed-fu (2.0.1)\n       Installing sequel (3.20.0)\n       Installing sinatra (1.0)\n       Installing spork (0.8.4) with native extensions\n       Installing sqlite3 (1.3.4) with native extensions\n       Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n       /usr/local/bin/ruby extconf.rb\n       checking for sqlite3.h... no\n       sqlite3.h is missing. Try 'port install sqlite3 +universal'\n       or 'yum install sqlite3-devel' and check your shared library search path (the\n       location where your sqlite3 shared library is located).\n       *** extconf.rb failed ***\n       Could not create Makefile due to some reason, probably lack of\n       necessary libraries and/or headers.  Check the mkmf.log file for more\n       details.  You may need configuration options.\n       Provided configuration options:\n       --with-opt-dir\n       --without-opt-dir\n       --with-opt-include\n       --without-opt-include=${opt-dir}/include\n       --with-opt-lib\n       --without-opt-lib=${opt-dir}/lib\n       --with-make-prog\n       --without-make-prog\n       --srcdir=.\n       --curdir\n       --ruby=/usr/local/bin/ruby\n       --with-sqlite3-dir\n       --without-sqlite3-dir\n       --with-sqlite3-include\n       --without-sqlite3-include=${sqlite3-dir}/include\n       --with-sqlite3-lib\n       --without-sqlite3-lib=${sqlite3-dir}/lib\n       --enable-local\n       --disable-local\n       Gem files will remain installed in /tmp/build_qlnbqtp08z3t/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.4 for inspection.\n       Results logged to /tmp/build_qlnbqtp08z3t/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.4/ext/sqlite3/gem_make.out\n       An error occurred while installing sqlite3 (1.3.4), and Bundler cannot continue.\n       Make sure that `gem install sqlite3 -v '1.3.4'` succeeds before bundling.\n !\n !     Failed to install gems via Bundler.\n !     \n !     Detected sqlite3 gem which is not supported on Heroku.\n !     http://devcenter.heroku.com/articles/how-do-i-use-sqlite3-for-development\n !\n !     Heroku push rejected, failed to compile Ruby/rails app\n\nTo git@heroku.com:waiterd2-staging.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to 'git@heroku.com:waiterd2-staging.git'\n</code></pre>\n\n<p>Clearly, the sqlite3 gem is the issue here. The weird part is that it's not included as a dependency in my Gemfile or Gemfile.lock.</p>\n\n<p>My gemfile looks like this:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.1.0'\n\ngem 'pg'\ngem 'thin'\ngem 'authlogic', '3.1.3'\ngem 'twilio-ruby'\ngem 'heroku'\ngem 'activeadmin', :git =&gt; 'https://github.com/gregbell/active_admin.git'\ngem 'stripe', :git =&gt; 'https://github.com/stripe/stripe-ruby'\ngem 'faye'\n\ngroup :assets do\n    gem 'less'\n    gem 'bourbon'\n    gem 'therubyracer'\n    gem 'sass-rails'\n    gem 'coffee-rails'\n    gem 'uglifier'\nend\n</code></pre>\n\n<p>A few things stand out here. The authlogic gem installed by Heroku is not the one specified in the Gemfile. The only reason I'm suspecting the authlogic gem is because it lists sqlite3 as a development dependency. This shouldn't matter though.</p>\n\n<p>When I run the exact command listed in the Heroku output on my local machine, the sqlite3 gem is not installed.</p>\n\n<p>I've tried many suggestions that I found on StackOverflow and elsewhere such as removing the Gemfile.lock file and running bundler again. None of these have worked. Heroku still installs the wrong version of authlogic and attempts to install sqlite3.</p>\n\n<p>How do I get Heroku to stop trying to install the sqlite3 gem?</p>\n\n<p>Your help is much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":10800111,"title":"rails selectbox_tag onchange()","body":"<p>Say we have a select box: <br />\n/app/views/tape/_form.html.erb <br />\n<code>&lt;%= f.select :tape, Tape::LIST_TAPES %&gt;</code><br /></p>\n\n<p>and a <em>.js.coffee</em> file that i would like to trigger when some value is selected in selectbox:<br />\n/app/assets/javascripts/tapes.js.coffee<br /></p>\n\n<pre><code>function selectBoxValue(value){\n  # value -- selected in selectbox;\n  console.log(\"box_value = \", value);\n}\n</code></pre>\n\n<p>How can it be done in RoR 3.2?<br />\n<a href=\"http://jsfiddle.net/7q2s9/7/\" rel=\"nofollow\">Here's</a> what i mean within html+js.</p>\n\n<p><strong>P.S.</strong><br />\nI'm new to Rails. Sorry for my English and thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13254433,"title":"How do I set a catch-remaining default route to a directory?","body":"<p>Perhaps simply due to lack of good keywords, I wasnt able to find any useful solution for a problem that should be almost trivial…</p>\n\n<p>In my <em>routes.rb</em>, how do I tell: \"If no other route matches <strong>request</strong>, then deliver /foo/bar/<strong>request</strong>\"?</p>\n\n<p>(Note: <strong>request</strong> ≠ '/')</p>\n\n<p>To be more specific:</p>\n\n<p>If <em>http://example.com/somedir/test/1/2/3</em> is not matched, try <em>/for/bar/somedir/test/1/2/3</em>, just if that does not exist, deliver *APP_DIR/public/404.html*.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec-rails","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13255284,"title":"Stubbing Gmaps4rails with geocoding.rb","body":"<p>I've reviewed a few of the Gmaps4rails stubbing questions and think I'm very close, but not quite there.  Forgive me: Very new to stubbing and mocking in rails.</p>\n\n<p>All of this code works in the real world, just trying to get it to skip geocoding during testing.  Right now tests <em>sometimes</em> work and <em>sometimes</em> fail with the <strong>Gmaps4rails address Address invalid</strong> error</p>\n\n<p>So, I have a very simple party.rb model that acts_as_gmappable:</p>\n\n<pre><code>def gmaps4rails_address\n   \"#{self.city}, #{self.country}\" \nend \n</code></pre>\n\n<p>I've pasted geocoding.rb from github and placed it in /spec/support unmodified</p>\n\n<p>However, I can't seem to tell my parties_controller_spec to use the stub instead of the real one.  I'm sure I'm missing something simple...  I've tried:</p>\n\n<pre><code>include Geocoding\n</code></pre>\n\n<p>and even</p>\n\n<pre><code>Gmaps4rails.set_gmaps4rails_options!({:msg =&gt; \"quack\"})\n</code></pre>\n\n<p>and I don't see \"quack\" as the error message, I see <strong>Validation failed: Gmaps4rails address Address invalid</strong></p>\n\n<p>Also tried:</p>\n\n<pre><code>Gmaps4rails.set_gmaps4rails_options!({:validation =&gt; false, :check_process =&gt; false, :process_geocoding =&gt; false})\n</code></pre>\n\n<p>But to no effect.</p>\n\n<p>My factories.rb has a straightforward :party define:</p>\n\n<pre><code>Factory.define :party do |party|\nparty.name      \"Thai New Year\"\nparty.city      \"Phuket\"\nparty.country   \"Thailand\"\n...\nend\n</code></pre>\n\n<p>So, I'm pretty sure I haven't properly told rspec to use the stubbed Gmaps4rails.  So, where exactly do I put the code that tells Gmaps4rails to use your stub_geocoding method instead of actually trying to perform geocoding?</p>\n\n<p>Any help would be appreciated... Sorry if this is a mundane question.</p>\n\n<p>Dave</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13255242,"title":"How to clean rails console output when using pry-rails?","body":"<p>I have in my Gemfile pry-rails gem. I would like to use pry as rails console but without that text below.</p>\n\n<p>How to clean my rails console output, now I receive a lot of unnecessary text:</p>\n\n<pre><code>&gt;&gt; Subscription.where(user_id: User.last.id)\n  User Load (1.8ms)  SELECT \"users\".* FROM \"users\" ORDER BY \"users\".\"id\" DESC LIMIT 1\n#&lt;ActiveRecord::Relation:0x7f7f9ad69c70\n  @implicit_readonly = nil,\n  @join_dependency = nil,\n  @order_clause = nil,\n  @records = [],\n  @should_eager_load = nil,\n  attr_accessor :bind_values = [],\n  attr_accessor :create_with_value = {},\n ...\n</code></pre>\n\n<p><a href=\"https://gist.github.com/4025796\" rel=\"nofollow\">https://gist.github.com/4025796</a></p>\n"},{"tags":["ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13254639,"title":"Filtering a Model's associated collections based on a User's CanCan abilities","body":"<p>Users belong to an organization. Users can view all organizations, but can only view users within their organization. When a user views the organization, I have to add filter logic to the view, so <code>@organizations.users</code> becomes <code>@organizations.users.select{|u| can?(:read, u)}</code>.</p>\n\n<p>Is there a way to manage this more transparently or elegantly? Is there a way to get rid of <code>select{|u| can?(:read, u)}</code> or move it to a DRY place?</p>\n\n<p><strong>Relevant code:</strong></p>\n\n<pre><code>class Organization &lt; ActiveRecord::Base\n  has_many :users\n  ...\nend\n\nclass Ability\n  ...\n  can :read, User, :organization =&gt; @user.organization\nend\n</code></pre>\n\n<p>organizations/show.html.erb: (current, sucky version)</p>\n\n<pre><code>&lt;% if @organization.users.select{|u| can?(:read, u)}.any? %&gt;\n  &lt;h4&gt;Contacts&lt;/h4&gt;\n  &lt;ul class=\"unstyled\"&gt;\n    &lt;% for user in @organization.users.select{|u| can?(:read, u)} %&gt;\n      &lt;li&gt;\n        &lt;%= link_to user, user, class: \"user\" %&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want something closer to this view instead:</p>\n\n<p>organizations/show.html.erb:</p>\n\n<pre><code>&lt;% if @organization.users.any? %&gt;\n  &lt;h4&gt;Contacts&lt;/h4&gt;\n  &lt;ul class=\"unstyled\"&gt;\n    &lt;% for user in @organization.users %&gt;\n      &lt;li&gt;\n        &lt;%= link_to user, user, class: \"user\" %&gt;\n      &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;/ul&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>I'm avoiding <code>accessible_by</code> because I have an ability definition that uses a block.</p>\n\n<pre><code>class Ability\n  ...\n  can :read, User, :organization =&gt; @user.organization\n  can :read, User do |user|\n    user.is? :technical_contact\n  end\nend\n</code></pre>\n\n<p>I know that <code>accessible_by</code> can work with blocks, but only if a SQL fragment is provided. Since my users have many roles and are stored as a bitmask, I don't have a SQL fragment.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13254837,"title":"Access items from a nested has_many relationship","body":"<p>I have 3 models: User, School, and Applicant.</p>\n\n<p>A user <code>has_many :schools</code>, a school <code>has_many :applicants</code> and <code>belongs_to :user</code>, and an applicant <code>belongs_to :school</code>. </p>\n\n<p>I'd like to be able to list applicants that belong to any school that belongs to a particular user. I thought I should be able to do it with </p>\n\n<pre><code>current_user.schools.applicants.paginate(page: params[:page])\n</code></pre>\n\n<p>That is not working as it is giving this error:</p>\n\n<pre><code>undefined method `applicants' for #&lt;ActiveRecord::Relation:0x007fb9da274110&gt;\n</code></pre>\n\n<p>How can I access these applicants?</p>\n"},{"tags":["ruby-on-rails-3","actionmailer","email-headers","rfc5322"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":623,"score":3,"question_id":6598343,"title":"Set the Message-ID mail header in Rails3 / ActionMailer","body":"<p>I would like to alter the <code>Message-ID</code> header that is in the header portion of an email sent from a Ruby on Rails v3 application using ActionMailer.</p>\n\n<p>I am using Sendmail on localhost for mail delivery.</p>\n\n<p>Do I configure this in Sendmail or ActionMailer?</p>\n\n<p>Where do I configure this (if it is ActionMailer):  a file in <code>config/</code> folder or a file in app/mailers/ folder?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","html5","contenteditable"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13254460,"title":"make next contenteditable element editable","body":"<p>I have a following structure </p>\n\n<pre><code>&lt;div&gt;\n&lt;ul id='t1'&gt;\n  &lt;li id='l1' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n  &lt;li id='l2' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n  &lt;li id='l3' contenteditable='true' class='editable'&gt; Lorem ipsum &lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>What I want here is when the user edits say li l3 and when he hits enter I want to add new li with contenteditable = true and setfocus on the new li so that user can start typing there. \nI was able to add a new entry on enter by but couldn't set focus on it.</p>\n\n<p><strong>Update</strong></p>\n\n<pre><code> if(e.keyCode == 13){//enter Key or tab key 9\n    e.preventDefault();\n    var taskId = this.id;\n    jQuery.ajax({\n        url : 'update_current',\n        type : 'put',\n        success : function(resp){ //resp is the new li tag\n          var li =  this_is_current_elemtn;\n          jQuery(li).append(resp);\n\n          //$('#t1 .editable').each(function(){\n            // $(this).attr('editable', 'false');\n          //});\n          console.log(jQuery(li).next());\n\n           jQuery(li).next().focus();\n         // $('#t1 .editable').each(function(){\n         //    $(this).attr('contentEditable', 'true');\n         // });\n        }\n    });\n</code></pre>\n\n<p>any help is appreciated</p>\n"},{"tags":["ruby-on-rails-3","week-number"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13253564,"title":"Get calendar week numbers in requested month in RoR","body":"<p>I've been searching for hours now and I just can't find the right answer.<br>\nHope you can help me out.  </p>\n\n<p>Ruby:    <code>1.9.3p194</code><br>\nRails:    <code>3.2.8</code></p>\n\n<h3>Goal:</h3>\n\n<pre><code>1.9.3p194 :001 &gt; get_weeknumbers_in_month 1, 2012\n=&gt; [1, 2, 3, 4]\n1.9.3p194 :002 &gt; get_weeknumbers_in_month 2, 2012\n=&gt; [5, 6, 7, 8]\n1.9.3p194 :003 &gt; get_weeknumbers_in_month 3, 2012\n=&gt; [9, 10, 11, 12, 13]\n1.9.3p194 :004 &gt; get_weeknumbers_in_month 4, 2012\n=&gt; [14, 15, 16, 17]\n</code></pre>\n\n<p>So, I actually want an array of calendar week numbers when the method <code>get_weeknumbers_in_month</code> is called.</p>\n\n<p><br></p>\n\n<h3>Research:</h3>\n\n<p>To get the month numbers from a date:</p>\n\n<pre><code>DateTime.parse(\"2012-01-10\").month\n=&gt; 1\n</code></pre>\n\n<p><br><br>\nTo get the number of days in a month:</p>\n\n<pre><code>Time::days_in_month(1, 2012)\n=&gt; 31\n</code></pre>\n\n<p><br><br>\nTo get the calendar week number of a date:</p>\n\n<pre><code>DateTime.parse(\"2012-04-12\").strftime(\"%W\").to_i\n=&gt; 15\n</code></pre>\n\n<p><br><br>\nCan someone please help me with this issue?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13251487,"title":"How to change Devise authentication attribute","body":"<p>Hey guys im using this Devise model : <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3a-Require-admin-to-activate-account-before-sign_in\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To%3a-Require-admin-to-activate-account-before-sign_in</a></p>\n\n<p>do anyone know where i can change it so that Devise uses my <code>is_approved</code> instead of the default <code>approved</code> ?</p>\n\n<p>for some reason i cant use the default <code>approved</code> since sqlite wont update the bool attribute more info about that here : <a href=\"http://stackoverflow.com/questions/13211811/rails-3-and-sqlite-communications-concerning-boolians/13213314#comment18016617_13213314\">Rails 3 and SQLite communications concerning boolians</a></p>\n\n<p>After i have approved a user on my website Device gives an error \"user not approved\" but i cant find in my app where i can change this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13248758,"title":"Unable to gracefully shutdown unicorn server with QUIT","body":"<p>We're doing zero downtime deploys for our Rails app using unicorn and the usual <a href=\"http://ariejan.net/2011/09/14/lighting-fast-zero-downtime-deployments-with-git-capistrano-nginx-and-unicorn\" rel=\"nofollow\">zero downtime deploy setup.</a> (we don't use the exact setup from the example, but the thing is similiar).</p>\n\n<p>This used to work, but during our upgrade to Rails 3.2 we ran into a weird problem:</p>\n\n<ul>\n<li>Old unicorn master gets <code>USR2</code></li>\n<li>New master is spawned</li>\n<li>However, the old master does <strong>never</strong> terminate and does seem to react to <code>QUIT</code> at all. </li>\n<li>The old master will still react to <code>WINCH</code> and shut down all workers, and it can be shut down with <code>TERM</code> - but graceful shutdown just doesn't work</li>\n</ul>\n\n<p>We do attempt to close the database connection from the master processes, but are not completely if it does still hold Redis connections (and if that would cause a problem).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","mongohq"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":730,"score":1,"question_id":10801977,"title":"MongoDB won't connect to MongoHQ using Mongoid","body":"<p>I've just started a brand new rails project and the first task I'm trying to complete is creating an object and having it save within my database.  I went through the automated way of generating an object, in this case a URL object as follows:</p>\n\n<pre><code>rails generate scaffold Url domain:string\n</code></pre>\n\n<p>I've also tested out two separate mongoid.yml configuration settings.  The first is as follows:</p>\n\n<pre><code>development:\n  sessions:\n    default:\n      # Defines the name of the default database that Mongoid can connect to.\n      # (required).\n      uri: mongodb://[username]:[password]@flame.mongohq.com:27046/[database]\n\n      options:\n        consistency: :strong \n</code></pre>\n\n<p>The result of this configuration is that when a query takes place, I get the following error:</p>\n\n<pre><code>The operation: #&lt;Moped::Protocol::Query\n  @length=39\n  @request_id=5\n  @response_to=0\n  @op_code=2004\n  @flags=[]\n  @full_collection_name=\".urls\"\n  @skip=0\n  @limit=0\n  @selector={}\n  @fields=nil&gt;\n failed with error 13075: \"db name can't be empty\"\n</code></pre>\n\n<p>I also tested with the following configuration:</p>\n\n<pre><code>development:\n  uri: mongodb://[username]:[password]@flame.mongohq.com:27046/[database]\n</code></pre>\n\n<p>When the code gets to the create method of the urls_controller it fails at @url.save with the following error:</p>\n\n<pre><code>mongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:100:in `parse'\nmongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:61:in `create_session'\nmongoid (3.0.0.rc) lib/mongoid/sessions/factory.rb:43:in `default'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:109:in `default'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:354:in `__session__'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:199:in `mongo_session'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:157:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/sessions.rb:25:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations.rb:26:in `collection'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations/insert.rb:27:in `block in persist'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:25:in `block (2 levels) in  prepare'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:403:in `_run__2492706777632263523__create__3276423133299307975__callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_create_callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/callbacks.rb:95:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:24:in `block in prepare'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:403:in  `_run__2492706777632263523__save__3276423133299307975__callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:385:in `_run_save_callbacks'\nactivesupport (3.2.3) lib/active_support/callbacks.rb:81:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/callbacks.rb:95:in `run_callbacks'\nmongoid (3.0.0.rc) lib/mongoid/persistence/insertion.rb:23:in `prepare'\nmongoid (3.0.0.rc) lib/mongoid/persistence/operations/insert.rb:26:in `persist'\nmongoid (3.0.0.rc) lib/mongoid/persistence.rb:49:in `insert'\nmongoid (3.0.0.rc) lib/mongoid/persistence.rb:188:in `upsert'\napp/controllers/urls_controller.rb:46:in `block in create'\n</code></pre>\n\n<p>My assumption is that my mongoid.yml file is incorrect but I'm not sure how to get this to work.  Any thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13253893,"title":"Form not submitting to custom action","body":"<p>I'm still relatively new to Rails and have looked through many similar questions here, but none helped me thus far. So... I have a form that I'd like to send a simple email. It pops up in a Bootstrap modal and looks like:</p>\n\n<pre><code>.form-horizontal\n  = form_tag :url =&gt; { :action =&gt; :share_event }, remote: true, html: {\"data-type\" =&gt; :json} do\n    .control-group\n      = label_tag :to\n      = text_field_tag :to\n    .control-group\n      = label_tag :from\n      = text_field_tag :from\n    .control-group\n      = label_tag :subject\n      = text_field_tag :subject  \n    - hidden_field_tag :event_url, :value =&gt; url\n    .actions\n      = submit_tag 'share event', :class =&gt; \"btn btn-mini submit\"\n</code></pre>\n\n<p>and in my controller:</p>\n\n<pre><code>def share_event\n  @to = params[:to]\n  @from = params[:from]\n  @subject = params[:subject]\n  @url = params[:url]\n  respond_to do |format|\n    EventMailer.share_event(@to, @from, @subject, @url).deliver\n    redirect_to events_path, notice: 'Event sent'\n  end \nend\n\n  EventMailer.share_event(@to, @from, @subject, @url).deliver\nend\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :events do\n  post :share_event, :on =&gt; :collection\nend\n</code></pre>\n\n<p>The problem is when I submit it uses the 'create' action as opposed to 'share_event'. I've tried many approaches, but it keeps on using 'create'. Here are an extract from the logs:</p>\n\n<pre><code>Started POST \"/events?html%5Bdata-type%5D=json&amp;remote=true&amp;url=share_events_path\" for 41.134.48.225 at 2012-11-06 15:34:25 +0100\nProcessing by EventsController#create as HTML\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"7/6pg9XX/N09qUB+SUlWOdpCsgPOAiXM+nC+mq6VtKE=\", \"to\"=&gt;\"to@example.com\", \"from\"=&gt;\"from@example.com\", \"subject\"=&gt;\"gfh\", \"event_url\"=&gt;\"{:value=&gt;\\\"http://events.example.com/events/3\\\"}\", \"commit\"=&gt;\"share event »\", \"html\"=&gt;{\"data-type\"=&gt;\"json\"}, \"remote\"=&gt;\"true\", \"url\"=&gt;\"share_events_path\"}\n</code></pre>\n\n<p>Any help/advice would be appreciated.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13251196,"title":"Clarification of When to use Controllers","body":"<p>Im new to rails and want to understand controllers better (especially when linked with models)</p>\n\n<p>My example is I have Recipe controller and model and then a favourite controller and model. Within the recipe controller I have New, create, update, destroy etc, so that obviously I can perform those actions on a recipe.</p>\n\n<p>Now i want to flag recipes as favourites, so again I can create a new favourite and delete a favourite. So is it best practice to put my  requests for the favourite model in the favourite controller. Not in the same controller as recipe. the reason I ask this is because i have favourite and recipe associated with belongs_to.</p>\n\n<p>Also within my app I want to view favourite recipes within the my_recipes page  (this is in the recipe controller), does it matter that my create/delete methods are in another controller for favourites?</p>\n\n<p>I hope this makes some sense to someone, looking for some clarification really</p>\n"},{"tags":["ruby-on-rails-3","routing","constraints"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":18,"score":-2,"question_id":13252049,"title":"rails routing with constraints","body":"<p>Supposed that we have a CRUD model Movie with attributes: title: string, release_year: string, language: string. In movies controller, there are 3 actions: search, retrieve and filter. <br/><br/>I want a path “/movies/retrieve/:action” to go to the above 3 actions. Conditions is as below:</p>\n\n<ul>\n<li><p>With get method, and action is “search”, or “find”, go to search\naction</p></li>\n<li><p>With get method, and action is “retrieve”, go to retrieve action. And\nretrieve action should be able to find a unique movie based on\nrelease_year and title</p></li>\n<li><p>With post method, and action is “filter”, “check”, “restrict”, go to\nfilter action.</p></li>\n</ul>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13240109,"title":"implement \"Add to favorites\" in rails 3","body":"<p>I am building an app where users can create recipes, see all recipes created, view their own recipes in a member area and finally i would like for users to add \"favorites\" to their account.</p>\n\n<p>I am new to rails but have read through docs and this is my understanding of what it should look like in the back end. Could someone confirm that this looks correct or advise of any errors please, with explanations if i have done something wrong (Which is probably the case)</p>\n\n<p>So this is my code</p>\n\n<p>User Model</p>\n\n<pre><code>has_many :recipes\nhas_many_favorites, :through =&gt; :recipes\n</code></pre>\n\n<p>Recipe Model</p>\n\n<pre><code>belongs_to :user\nhas_many :ingredients #created seperate db for ingredients\nhas_many :prepererations #created seperate db for prep steps\n</code></pre>\n\n<p>Favorite Model</p>\n\n<pre><code>belongs_to :user\nhas_many :recipes, :through =&gt; :user\n#this model has one column for the FK, :user_id\n</code></pre>\n\n<p>Favorites Controller</p>\n\n<pre><code>def create\n@favrecipes =current_user.favorites.create(params[:user_id])\nend\n</code></pre>\n\n<p>I then wanted to have a button to post to the db so have this</p>\n\n<pre><code>&lt;%= button_to(\"Add to Favorites\" :action =&gt; \"create\", :controller =&gt; \"favorites\" %&gt;\n</code></pre>\n\n<p>I think I am probably missing something in my routes but am unsure</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13242315,"title":"Rails remote forms validation","body":"<p>Just a simple question I have followed the railscast -> <a href=\"http://railscasts.com/episodes/136-jquery-ajax-revised\" rel=\"nofollow\">http://railscasts.com/episodes/136-jquery-ajax-revised</a></p>\n\n<p>Its nice how for remote true works, but how I cna validate the model ? </p>\n\n<p>I have this one</p>\n\n<pre><code>&lt;%= form_for [:admin,@course], remote: true  do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title, \"The title:\" %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :description, \"Descripcion:\" %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :description %&gt;\n &lt;/div&gt;\n &lt;div class=\"actions\"&gt;\n   &lt;%= f.submit \"Send\"%&gt;\n &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How I handle te error ??</p>\n\n<pre><code>def create\n\n  @course = Course.new(params[:course])\n\n  respond_to do |format|\n    if @course.save\n      format.html { redirect_to admin_index_url, :notice=&gt; 'Done !!' }\n      format.js\n    else\n      format.html { flash.now[:alert] = \"Not done\" \n                    render \"new\"\n                  }\n      format.js\n    end\n  end        \nend\n</code></pre>\n\n<p>any ideas why this dont works ??</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","scopes"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":27,"score":2,"question_id":13251468,"title":"rails 3 scopes inherited from other models","body":"<p>is there any way to use one model scopes as part of another model scope?</p>\n\n<p>Example</p>\n\n<pre><code>class DocumentVersion &lt; ActiveRecord::Base\n  belongs_to :document\n  scope :are_latest, lambda{ where(latest: true)}\nend\n\nclass Document &lt; ActiveRecord::Base\n  has_many :document_versions\n  scope :are_latest, lambda { ...something... } # I want something that will get documents that have documnet_versions that are_latest\n\n  # I know I can do this \n  scope :are_latest,   lambda{ joins(:document_versions).where('document_versions.latest = true') }  # this works well\n\n  # but I would like to keep that condition its own model\n  scope :are_latest, lambda { joins(:document_versions).are_latest } # this wont obviously work, but something like that \n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13251054,"title":"How do I include the user objects n the json result?","body":"<pre><code>@song.likes.select('likes.*, users.*').includes(:user).to_json \n</code></pre>\n\n<p>Only converts the like objects. Is there a way to include the user objects in the json result? Via Ruby or other.</p>\n"},{"tags":["ruby-on-rails-3","rspec","integration-testing","capybara"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":353,"score":4,"question_id":7940525,"title":"Testing focus with Capybara","body":"<p>I have a simple <code>link_to_function</code> in my view template</p>\n\n<pre><code>&lt;%= link_to_function \"add new category\", \"$('#category_name').focus()\" %&gt;\n</code></pre>\n\n<p>and I want to test this with capybara using request specs. Basically the spec should look something like this</p>\n\n<pre><code>it \"focuses category form when I click 'add new category'\" do\n  visit new_article_path\n  click_link \"add new category\"\n\n  # unfortunately there's nothing like 'has_focus?'\n  find_field(\"category_name\").should have_focus  \nend\n</code></pre>\n\n<p>the problem is, <strong>I wasn't able to find anything, that would check if the element has focus.</strong> \nThe only thing I did find was this</p>\n\n<pre><code>page.evaluate_script('document.focus')[:id]\n</code></pre>\n\n<p>which however isn't supported by the <code>capybara-wekbit</code> driver, which I'm using to avoid opening browser for each test run.</p>\n"},{"tags":["ruby-on-rails-3","sqlite3","boolean","windows-7-x64"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13211811,"title":"Rails 3 and SQLite communications concerning boolians","body":"<p>im using Rails 3.2.8 and SQLite 1.3.6</p>\n\n<p>and im running into troubles changing boolian variables in the database</p>\n\n<p>SQLite translates \"t\" and \"f\" as true and false</p>\n\n<p>this function wont update the <code>:approved</code> attribute (that is default false)</p>\n\n<pre><code>def activate\n  @user = User.find(params[:id])\n\n  if @user.update_attribute(:approved, 't')\n\n    redirect_to \"/\" #this is the return i get so the update returns true\n\n  else\n   render \"/users?approved=false\"\n  end \nend\n</code></pre>\n\n<p>But changing strings like <code>@user.update_attribute(:email,'root@email.org')</code> will update the email</p>\n\n<p>how can i fix this do i need some kind of an sqlite adapter ?</p>\n\n<p>i already installed <code>activerecord-jdbcsqlite3-adapter</code> and it messed up my app because i was too hasty and didnt notice that it was deprecated :P</p>\n\n<p>i found this thread : <a href=\"http://stackoverflow.com/questions/6013121/rails-3-sqlite3-boolean-false\">Rails 3 SQLite3 Boolean false</a>\nbut i dont understand what i need to do in order to make Rails and SQLite communicate correctly as im a newbie in rails :)</p>\n\n<p>also i think its worth mentioning that im running this on windows 7 x64</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Apparently Rails does indeed know how to communicate with Sqlite, but the i have no idea why my code dosnt work for boolians lol</p>\n\n<p>in my view i have :</p>\n\n<pre><code>&lt;% @users.each do |user| %&gt; \n&lt;tr&gt; \n  &lt;td&gt;&lt;%= user.id %&gt;&lt;/td&gt; \n  &lt;td&gt;&lt;%= user.email %&gt;&lt;/td&gt;\n  &lt;td&gt;&lt;%= user.approved? %&gt;&lt;/td&gt;\n  &lt;td&gt;\n&lt;% if !user.approved? %&gt;\n  &lt;%= link_to 'Approve', active_user_path(user), :method =&gt; :put %&gt; \n    &lt;% end %&gt; &lt;/td&gt; \n&lt;/tr&gt; \n&lt;% end %&gt; \n</code></pre>\n\n<p>This lists all the unapproved users and a link to activate them (set the bool to true)</p>\n\n<p>and in my controller i have </p>\n\n<pre><code>    def activate\n      @user = User.find(params[:id])\n\n    if @user.update_attribute(:approved, true)\n\n      redirect_to \"/\" #this is the return i get so the update returns true\n\n    else\n      render \"/users?approved=false\" #this is not rendered\n    end \n  end\n</code></pre>\n\n<p>and my route</p>\n\n<pre><code>match \"users/:id/activate\" =&gt; \"users#activate\", :as =&gt; \"active_user\"\n</code></pre>\n\n<p>This works for other strings like the user name, address etc but not the bool's </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","has-and-belongs-to-many"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":52,"score":2,"question_id":13174104,"title":"Split a string and save with has_and_belongs_to_many association","body":"<p>I have a text_field which the user can type in Tags(Like the ones on stackoverflow). They can seperate the tags with a comma. Now, I know how to split the tags. But the n00b that I am I'm stuck at the next stage. I have a Tag table, a Trip table and a tags_trips in between(A trip can have multiple keywords, but I want the keywords unique in my database so when they exist they can be used again on other Trips).</p>\n\n<p>The real question is; After I've split the string, how can I check if the keyword exists and get the existing ID to be placed in my tags_trips table, and if it doesn't exist how do i get the array I've just split in my tags_trips table in one go?</p>\n\n<p>Here's an overview of my tables: </p>\n\n<pre><code>Trip\n:id =&gt; :integer,\n:title =&gt; :string,\n:description =&gt; :text,\n:user_id =&gt; :integer,\n:created_at =&gt; :datetime,\n:updated_at =&gt; :datetime\n\nTag\n:id =&gt; :integer,\n:title =&gt; :string,\n:created_at =&gt; :datetime,\n:updated_at =&gt; :datetime\n\ntags_trip\n:tag_id =&gt; :integer,\n:trip_id =&gt; :string\n</code></pre>\n\n<p>I'm using a <code>has_and_belongs_to_many</code> association between Tag and Trip in my models and get the text_field via <code>fields_for :tags</code> in my Trip form. (Note: The form works and I've managed to get the keywords string, as it is typed, into my Tag table! Just not split up ;-))</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","logging","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13250665,"title":"how make log rotation rails 3.2.8 version","body":"<p>How can I make log rotation on my production env for rails version 3.2.8?</p>\n\n<p>I have taking a look to <a href=\"http://stackoverflow.com/questions/4883891/ruby-on-rails-production-log-rotation\">Ruby on Rails production log rotation</a>, but is for old rails version.</p>\n\n<p>I use nginx + unicorn</p>\n\n<p>Where can I find more info about this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","declarative-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13250518,"title":"declarative_authorization for field-level control","body":"<p>I want to restrict ability to change the <code>roles</code> field in the <code>user</code> model to a certain role. Of course I could use scoped mass assignment but is it actually possible to use <strong>declarative_authorization</strong> for securing individual fields?</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","rest","html-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13250502,"title":"Paste html form data into url","body":"<p>Assuming i have resource with 2 methods :show and :index. I need :index contain simple form with text field and submit button, when user insert data into text field, this data must be  inserted into url as :id of resource for :show method.</p>\n\n<p>for example page url looks like <code>/s</code> and when user type 123 into field in the form and press submit he must be redirected to <code>/s/123</code>. Can it be done with rails or html forms ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13250014,"title":"set up default routes to common dir","body":"<p>Assume you have a couple of ruby/rails apps running on a server</p>\n\n<p>APP ExmplA:\ndir: /foo/bar/ExmplA\nruns on <a href=\"http://example.com:4111/\" rel=\"nofollow\">http://example.com:4111/</a></p>\n\n<p>APP ExmplB:\ndir: /foo/bar/ExmplB\nruns on <a href=\"http://example.com:4112/\" rel=\"nofollow\">http://example.com:4112/</a></p>\n\n<p>APP ExmplC:\ndir: /foo/bar/ExmplC\nruns on <a href=\"http://example.com:4113/\" rel=\"nofollow\">http://example.com:4113/</a></p>\n\n<p>now i have a common dir\n/pool/common/http/\nwhere i want the default root-routes (\"/\") of the 3 apps to point to.</p>\n\n<p>…so \"http://example.com:4113/somedir/something.txt\" should map to \"/pool/common/http/somedir/something.txt\", if not specified otherwise.</p>\n\n<p>What should I enter in the routes.rb of the 3 Apps?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":5,"up_vote_count":4,"down_vote_count":0,"view_count":2673,"score":4,"question_id":3801324,"title":"Rails 3 - time_ago_in_words says \"ABOUT 2 hours ago\"","body":"<p>Code:</p>\n\n<pre><code>&lt;%=\"#{time_ago_in_words(comment.created_at)} ago \"%&gt;\n</code></pre>\n\n<p>What i'd like is for it not to have \"ABOUT\" in front of the 2 hours ago, which shows up for hours but not for minutes...</p>\n\n<p>Is there another function or a way to remove it without finding and replacing?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13249132,"title":"How to maintain the \"updated_at\" variable in rails application?","body":"<p>I am  making an application in which there is only model that is Project and in the view of the project i can see the table with the variables that generate automatically i.e created\n_at and updated_at.\nI want to keep track the updated_at variable means that if user updates the project 10 times it will show the updated_at variable 10 times so that i can track the project model.</p>\n"},{"tags":["ruby-on-rails-3","prestashop","activeresource"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13176487,"title":"Non rails style format of XML response how to parse with ActiveResource correctly?","body":"<p>Using Rails and ActiveResource i am getting non-rails style of XML response form third-party API. Object which i like to map is basically wrapped in prestahop element. What should i override to get rid of that element to map the object correctly?</p>\n\n<pre><code>&lt;prestashop xmlns:xlink=\"http://www.w3.org/1999/xlink\"&gt;\n&lt;order&gt;\n    &lt;id&gt;&lt;/id&gt; \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13088959,"title":"Why am I getting a 'Factory not registered' error?","body":"<p>I have a model Answer:  </p>\n\n<pre><code>class Answer &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>In my Question model, i have defined <code>has_many :answers</code>. My Answer model have three column: content (text), question_id (integer), correct(boolean). Default value of <code>correct</code> column is <code>false</code>.</p>\n\n<p>I created factories to create Answer object:</p>\n\n<pre><code>factory :answer do\n  content \"Content of an answer\"\n  question\n\n  factory :accept_answer do\n    correct true\n  end\nend\n</code></pre>\n\n<p>In my rspec file, i created new answer object successfully with below code:  </p>\n\n<pre><code>let(:answer) { FactoryGirl.create(:answer, question: question) }\n\nsubject { answer }\nits(:correct) { should be_false }\n</code></pre>\n\n<p>But when i used below code to create accept_answer object: </p>\n\n<pre><code>describe \"an accepted answer\" do\n  let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) } \n  it { accept_answer.correct.should be_true }\nend\n</code></pre>\n\n<p>It has error</p>\n\n<pre><code>Failure/Error: let(:accept_answer) { FactoryGirl.create(:accept_answer, question: question) }\nArgumentError:\n   Factory not registered: accept_answer\n</code></pre>\n\n<p>I don't know what wrong with my code :(</p>\n"},{"tags":["android","ruby-on-rails-3","android-c2dm","android-gcm"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":325,"score":0,"question_id":12091737,"title":"Android Google Cloud Messaging gem for Ruby on Rails 3","body":"<p>Is there a new gem for ruby on rails for GCM earlier known as C2DM.</p>\n\n<p>If not then, should we continue to use the old gem for C2DM like one here on <a href=\"https://github.com/pimeys/c2dm_on_rails\" rel=\"nofollow\">github</a></p>\n\n<p>Thanks in Advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","csv","import"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13247149,"title":"Can't mass-assign protected attributes when import data from csv file","body":"<p>I have a form for import data like this:</p>\n\n<pre><code>&lt;%= form_tag({ controller: 'courses', action: :import }, multipart: true) do %&gt; \n  &lt;%= label_tag 'file', 'Import data' %&gt;\n  &lt;%= file_field_tag 'file' %&gt;\n  &lt;%= submit_tag \"Import\", name: nil, class: 'btn' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is my import action:</p>\n\n<pre><code>def import\n  require 'csv'\n\n  csv_text = File.read(params[:file].tempfile.to_path.to_s)\n  csv = CSV.parse(csv_text, headers: true )\n  csv.each do |row|\n    row = row.to_hash.with_indifferent_access\n    Course.create(row.to_hash.symbolize_keys)\n  end\n  flash[:success] = \"Successfully import data.\"\n  redirect_to courses_url\nend\n</code></pre>\n\n<p>But when i choose a file and press button <code>Import</code> in browser, i got error:</p>\n\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in CoursesController#import\nCan't mass-assign protected attributes: Name, Code\n</code></pre>\n\n<p>In my <code>Course</code> model, <code>name</code> and <code>code</code> already are attr_accessible:</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  attr_accessible :code, :name\nend\n</code></pre>\n\n<p>What's wrong with my code?</p>\n\n<p><strong>Updated</strong><br>\nThis is my csv file:</p>\n\n<pre><code>name, code\nERP System, HT555DV01\nData Mining, HT459DV01\n</code></pre>\n\n<p><strong>New code to create data</strong></p>\n\n<pre><code>csv.each do |row|\n  Course.create!(name: row[0], code: row[1])\nend\n</code></pre>\n"},{"tags":["sql-server","ruby-on-rails-3","freetds"],"answer_count":4,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":2616,"score":4,"question_id":6973371,"title":"FreeTDS problem connecting to SQL Server on Mac (Unexpected EOF from the server)","body":"<p>I have setup FreeTDS to connect to SQL Server database.  When I try to open TSQL in terminal on Mac (lion) I get this error:</p>\n\n<pre><code>locale is \"en_US.UTF-8\"\nlocale charset is \"UTF-8\"\nusing default charset \"UTF-8\"\nError 20017 (severity 9):\n    Unexpected EOF from the server\n    OS error 36, \"Operation now in progress\"\nError 20002 (severity 9):\n    Adaptive Server connection failed\nThere was a problem connecting to the server\n</code></pre>\n\n<p>Does anybody have a clue what could be causing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","browser","soundmanager2"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":15,"score":3,"question_id":13248069,"title":"Soundmanager-rails won't play sound with flash","body":"<p>I am using soundmanager-rails gem in my rails app. I use it to stream radio from stream. While HTML5 audio works fine with mp3, flash won't play a sound. I've tried Firefox, Safari and Chrome and in every browser sound doesn't work via flash. Console log looks fine:</p>\n\n<pre><code>-- SoundManager 2: HTML5 support tests (/^(probably|maybe)$/i): mp3: true (preferring flash), mp4: true (preferring flash), ogg: false (and no flash support), wav: true --\n-- SoundManager 2 V2.97a.20120916 (AS2/Flash 8) + HTML5 audio, normal polling --\nsoundManager::createMovie(): Trying to load /assets/swf/soundmanager2_debug.swf\nsoundManager::initMovie(): Waiting for ExternalInterface call from Flash...\nsoundManager::externalInterfaceOK() (~0 ms)\nsoundManager::init()\nsoundManager: Attempting JS to Flash call...\n(Flash): SM2 SWF V2.97a.20120916 (AS2/Flash 8)\n(Flash): JS to/from Flash OK\nFlash security sandbox type: remote\n(Flash): Enabling polling, 50 ms interval\n-- SoundManager 2 loaded (OK) --\nsoundManager: Firing 1 onready() item\n</code></pre>\n\n<p>Rails server serves swf files fine:</p>\n\n<pre><code>Started GET \"/assets/swf/soundmanager2_debug.swf\" for 127.0.0.1 at 2012-11-06 13:17:01 +0400\nServed asset /swf/soundmanager2_debug.swf - 200 OK (3ms)\n</code></pre>\n\n<p>Soundmanager demos on it's web site work alright in every browser.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13247799,"title":"Does ActiveRecord cache table_name?","body":"<p>I've got an <code>ActiveRecord</code> class that needs to look at two different tables depending on a configuration switch, so I'm planning to do the following:</p>\n\n<pre><code>def table_name\n  config_is_on? ? :table1 : :table2  \nend\n</code></pre>\n\n<p>I'm wondering whether the <code>table_name</code> method is always called when queries are run against this model: the application is <strong>not</strong> going to be restarted when the configuration changes, so this value cannot be cached.</p>\n\n<p>Does <code>ActiveRecord</code> always evaluate the <code>table_name</code> or just once during application startup / initialization? If it's cached how do I force it to evaluate <code>table_name</code> every time?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","caching","rabl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13192550,"title":"Fragment caching in a rabl view?","body":"<p>I read <a href=\"https://github.com/nesquena/rabl/wiki/Caching-in-RABL\" rel=\"nofollow\">rabl caching doc</a> and I don't get how I can cache fragment of code.\nI have a view like this (there more code, but I removed it for simplicity's sake):</p>\n\n<pre><code>object @video\n\nattributes :id, :user_id, :event_id\n\nchild :event do\n  attributes :id\n  node(:name) { |event| event.name }\nend\n\nchild :user do\n  attributes :id\nend\n</code></pre>\n\n<p>And I want to cache :event child for two hours. How can I do that?</p>\n\n<p>I'm using rabl(0.7.6), rails(3.2.0), ruby(1.9.3p125)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":5,"favorite_count":11,"up_vote_count":22,"down_vote_count":0,"view_count":10971,"score":22,"question_id":3873190,"title":"f.error_messages in Rails 3.0","body":"<p>Rails 3.0 deprecated <code>f.error_messages</code> and now requires a plugin to work correctly - I however want to learn how to display error messages the (new) native way. I am following the <a href=\"http://edgeguides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">getting started guide</a>, which uses the deprecated method when implementing the comments form. For example:</p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n&lt;div class=\"field\"&gt;\n  &lt;% f.label :commenter  %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :commenter  %&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :body %&gt;&lt;br /&gt;\n  &lt;%= f.text_area :body %&gt;\n&lt;/div&gt;\n&lt;div class=\"actions\"&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the correct way to do it (as generated by the scaffold):</p>\n\n<pre><code>&lt;%= form_for(@post) do |f| %&gt;\n  &lt;% if @post.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@post.errors.count, \"error\") %&gt; prohibited this post from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @post.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n . . . \n</code></pre>\n\n<p>I understand that I use the <code>@post</code> variable in the latter example, but what variable do I reference in the former to get the error messages for comment creation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13245311,"title":"RoR duplication fields","body":"<p>When an incorrect mandatory fields, the page reloads and you receive an incorrect entry fields and all fields in the form company_form duplicated.</p>\n\n<p>User model(user.rb):</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  ....\n  has_many :companies, :autosave =&gt; true\n  accepts_nested_attributes_for :companies\n  has_and_belongs_to_many :roles\n  def role?(role_name)\n    return !!self.roles.find_by_name(role_name)\n  end\n  def with_company\n    self.companies.build\n    self\n  end\nend\n</code></pre>\n\n<p>Company model:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n  ...\n  belongs_to :user\n  ...\nend\n</code></pre>\n\n<p>views/devise/registration/new.html.haml:</p>\n\n<pre><code>= form_for(resource.with_company, :as =&gt; resource_name, :url =&gt; registration_path(resource_name), :html =&gt; { :class =&gt; 'form-horizontal'}) do |f|\n...\n  = f.fields_for :companies do |company_form|\n  ...\n...\n</code></pre>\n"},{"tags":["ruby-on-rails-3","api","usps","fedex-shipping"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":161,"score":1,"question_id":8373901,"title":"Integrating usps api on rails application","body":"<p>I want to integrate <a href=\"https://www.usps.com/\" rel=\"nofollow\">https://www.usps.com/</a> and also fedex api on my rails application, but I could not understand their documentation. Is there anybody who can help me? Or can any one provide me an easy tutorial of how it should be integrate on web ? I want to calculate the cost of package or gifts of the users on many condition. </p>\n\n<p>Please note: there is a gem for this sevice but it is too old and the application I am going to build it is on rails 3.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13245289,"title":"Writing test cases(Rspec) for existing application","body":"<p>Being Rspec noob, i dont know this question make sense. BUt i am really confused and couldnt get solution for this.</p>\n\n<blockquote>\n  <p>We have one new requirement, asked us to write Rspec test cases for existing project. They have application with rails3 that already working but they want rspec cases to be written now</p>\n</blockquote>\n\n<p>My question is</p>\n\n<blockquote>\n  <p>Writing Rspec cases for existing application does make sense?</p>\n  \n  <p>Can we write spec for already working project</p>\n  \n  <p>Should we follow any guidelines to write specs for already written app</p>\n</blockquote>\n\n<p>Thank you </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13245331,"title":"Collecting only a specific value and selecting as default","body":"<p>I have something like this as a select_tag :</p>\n\n<p><code>&lt;p&gt;&lt;%= setting_select :ui_theme, My::Themes.themes.collect {|t| [t.name, t.id]}, :blank =&gt; :label_default, :label =&gt; :label_theme %&gt;&lt;/p&gt;</code></p>\n\n<p>Rite now it is collecting all the values and displaying but I want to collect only a specific value and make it default. This value has name = \"Test\". </p>\n\n<p>Thus it should look like this and it should be default:</p>\n\n<p><code>&lt;option selected=\"selected\" value=\"Test\"&gt;Test&lt;/option&gt;</code></p>\n\n<p>Note : Here setting_select is a helper which is defined like this:</p>\n\n<pre><code>def setting_select(setting, choices, options={})\n    if blank_text = options.delete(:blank)\n      choices = [[blank_text.is_a?(Symbol) ? l(blank_text) : blank_text, '']] + choices\n    end\n    setting_label(setting, options).html_safe +\n      select_tag(\"settings[#{setting}]\",\n                 options_for_select(choices, Setting.send(setting).to_s),\n                 options).html_safe\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":65,"score":1,"question_id":13025953,"title":"form_for undefined method `model_name' error","body":"<p>I'm having problem with form_for, have searched for the problem for the solutions given does not solve my problem.</p>\n\n<p>I'm trying to do up a form to create new recipes:</p>\n\n<pre><code>**app/views/recipes/new.html.erb**\n&lt;%= form_for @recipe do |f| %&gt;\n  &lt;% if @recipe.errors.any? %&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :recipename %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :recipename %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user_id %&gt;&lt;br /&gt;\n    &lt;%= f.number_field :user_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n</code></pre>\n\n\n\n<pre><code>**routes.rb**\nBaserecipe::Application.routes.draw do\n\n  resources :users\n  resources :recipes\n  ....\n  match '/createrecipe', to: 'recipes#new'\n</code></pre>\n\n<hr>\n\n<pre><code>**recipes_controller.rb**\nclass RecipesController &lt; ApplicationController\n\n  def create\n    @recipe = Recipe.new(params[:recipe])\n  end\nend\n</code></pre>\n\n<p>I'm alway getting the error:</p>\n\n<pre><code>undefined method `model_name' for NilClass:Class\n</code></pre>\n\n<p>Extracted source (around line #1): </p>\n\n<pre><code>1: &lt;%= form_for @recipe do |f| %&gt;\n2:   &lt;% if @recipe.errors.any? %&gt;\n3:   &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>class Recipe &lt; ActiveRecord::Base\n  attr_accessible :recipename, :instruct1, :instruct2, :instruct3, :instruct4, :instruct5,\n  :instruct6, :instruct7, :instruct8, :instruct9, :instruct10, :instruct11, :instruct12,\n  :instruct13, :instruct14, :instruct15, :instruct16, :instruct17, :instruct18, :instruct19,\n  :instruct20, :instruct21, :instruct22, :instruct23, :instruct24, :instruct25, :instruct26,\n  :instruct27, :instruct28, :instruct29, :instruct30, :preptime, :cooktime\n\n  belongs_to :user\n  has_many :ingredients\n  has_many :rcomments\n\n  validates :recipename, presence: true, length: { maximum: 140 }\n  validates :user_id, presence: true\n  validates :preptime, presence: true\n  validates :cooktime, presence: true\n\n  default_scope order: 'recipes.created_at DESC'\nend\n</code></pre>\n\n<p>full trace:</p>\n\n<pre><code>activemodel (3.2.7) lib/active_model/naming.rb:163:in `model_name_from_record_or_class'\nactivemodel (3.2.7) lib/active_model/naming.rb:158:in `param_key'\nactionpack (3.2.7) lib/action_view/helpers/form_helper.rb:369:in `form_for'\napp/views/recipes/new.html.erb:3:in `_app_views_recipes_new_html_erb___168565054_39061080'\nactionpack (3.2.7) lib/action_view/template.rb:145:in `block in render'\nactivesupport (3.2.7) lib/active_support/notifications.rb:125:in `instrument'\nactionpack (3.2.7) lib/action_view/template.rb:143:in `render'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:47:in `block (2 levels) in render_template'\nactionpack (3.2.7) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.7) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:46:in `block in render_template'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:45:in `render_template'\nactionpack (3.2.7) lib/action_view/renderer/template_renderer.rb:18:in `render'\nactionpack (3.2.7) lib/action_view/renderer/renderer.rb:36:in `render_template'\nactionpack (3.2.7) lib/action_view/renderer/renderer.rb:17:in `render'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:110:in `_render_template'\nactionpack (3.2.7) lib/action_controller/metal/streaming.rb:225:in `_render_template'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:103:in `render_to_body'\nactionpack (3.2.7) lib/action_controller/metal/renderers.rb:28:in `render_to_body'\nactionpack (3.2.7) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:88:in `render'\nactionpack (3.2.7) lib/action_controller/metal/rendering.rb:16:in `render'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'\nactivesupport (3.2.7) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'\nactivesupport (3.2.7) lib/active_support/core_ext/benchmark.rb:5:in `ms'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:40:in `block in render'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'\nactiverecord (3.2.7) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:39:in `render'\nactionpack (3.2.7) lib/action_controller/metal/implicit_render.rb:10:in `default_render'\nactionpack (3.2.7) lib/action_controller/metal/implicit_render.rb:5:in `send_action'\nactionpack (3.2.7) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.2.7) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:414:in `_run__22188539__process_action__1016913818__callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.7) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.7) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.7) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.7) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.7) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactiverecord (3.2.7) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.2.7) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.7) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.7) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.7) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.7) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.7) lib/action_dispatch/routing/route_set.rb:600:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/cookies.rb:338:in `call'\nactiverecord (3.2.7) lib/active_record/query_cache.rb:64:in `call'\nactiverecord (3.2.7) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `_run__305680696__call__774818341__callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.7) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.7) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.7) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.7) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.7) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.7) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.7) lib/rails/engine.rb:479:in `call'\nrailties (3.2.7) lib/rails/application.rb:220:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.7) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\nc:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","each"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13244946,"title":".each breaking if only 1 result - rails","body":"<p>For some reason, I keep getting an \"undefined method 'each'\" error every time I try to do the .each do when I have one result in the below.  </p>\n\n<p>If I use .inspect, I can see that there's a match.  Does .each work if there's not more than 1 result?  If not, what should I use instead?</p>\n\n<pre><code>&lt;% friends = graph.get_object(\"/me/friends\").map{ |hash| hash[\"id\"] } %&gt;\n\n&lt;% User.select([:id]).where(fbookid: friends).each do |common| %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>If I just run .inspect on the User.select line (no each), then I get </p>\n\n<pre><code>[#&lt;User id: 1&gt;]\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n\n<p>Thank you!</p>\n\n<p><em>UPDATE</em> </p>\n\n<p>Adding additional parameters seemed to allow me to use each...I have no clue why.  It's the same exact result (only 1).</p>\n\n<pre><code>User.select([:id, :email, :first_name]).where(fbookid: friends).each do |friend|\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13245072,"title":"How do I not use current_user in the model","body":"<p>I have a form to create posts. This form also has tags on the post and it is owned by a user. The form is using a virtual attribute :tag_ids. </p>\n\n<p>I would like to do something like this, where you find_or_create_by_name_and_user_id and then just pass the current_user.id.</p>\n\n<pre><code>def tag_ids=(tags_string)\n    self.taggings.destroy_all\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    tag_names.each do |tag_name|\n      tag = Tag.find_or_create_by_name_and_user_id(tag_name, current_user.id)\n      tagging = self.taggings.new\n      tagging.tag_id = tag.id\n    end\nend\n</code></pre>\n\n<p>From what I read this isn't how it should work. The current user should be called in the PostsContoller create method. </p>\n\n<pre><code>def create\n  @post = Post.new(params[:post])\n  @post.user = current_user\n  respond_to do |format|\n     if params[:commit]\n     @post.save\n</code></pre>\n\n<p>...\nend</p>\n\n<p><em>This is where I'm stuck.</em> <strong>If the params are passing all of the attributes, how can I inject the current_user id into tag model which has a :name and :user_id attribute?</strong> </p>\n\n<p>I also read that this should work because of my associations.</p>\n\n<p>User - has_many posts; has_many tags</p>\n\n<p>Post - belongs_to user; has_many taggings; has_many tags through taggings</p>\n\n<p>Tag - has many taggings; has_many posts through taggings; belongs_to user</p>\n\n<p>Tagging - belongs_to post; belongs_to tag</p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","login","spec"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":15,"score":2,"question_id":13244925,"title":"How to log in as a user in user_controller_spec?","body":"<p>A person is not allowed to look at the users page unless they are an admin. Hence users cannot leave the home page if they aren't logged in. In the user_controller_spec we have several tests on editing personal info or passwords. But the tests will never pass because the user we created in the spec class is not logged in. Is there a way to log in the user in the user_controller_spec?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","introspection","pluralize"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13244176,"title":"Rails: how to see pluralized and single form of names","body":"<p>I has created a model Anonymous with command </p>\n\n<pre><code>rails g model Anonymous section_id:integer aid:string fake:bool active:bool\n</code></pre>\n\n<p>but table name in the migration is called anonymous</p>\n\n<pre><code>class CreateAnonymous &lt; ActiveRecord::Migration\n  def change\n    create_table :anonymous do |t|\n      t.integer :section_id\n      t.string :aid\n      t.bool :fake\n      t.bool :active\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Am i right that pluralized form of Anonymous is Anomymous too ? (English is not my native language). How can i see what pluralized names Rails gives to my models ? Something like <code>rake routes</code> ?</p>\n"},{"tags":["ruby-on-rails-3","authentication"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13226832,"title":"Display edit user link only when that user is logged in","body":"<p>I have a Users resource and I want to display the \"edit\" link in the show.html.erb files only when that user is logged in. See screenshots. </p>\n\n<p><img src=\"http://i.stack.imgur.com/bXHT5.png\" alt=\"Here is a list of users. Notice in the top right that Roger Sterling is logged in.\"></p>\n\n<p>Here is a list of users. Notice in the top right that Roger Sterling is logged in.</p>\n\n<p><img src=\"http://i.stack.imgur.com/1TJM6.png\" alt=\"But if I click on Don Draper, the show.html.erb file displays the &quot;Edit&quot; button. I only want that to appear for Roger Sterling, in this case.\"></p>\n\n<p>But if I click on Don Draper, the show.html.erb file displays the \"Edit\" button. I only want that to appear for Roger Sterling, in this case.</p>\n\n<p>I'm using Devise for authentication. Any ideas on how to accomplish this? Let me know if you need to see any available code. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","login","devise","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13129254,"title":"How to direct user to a specific page after logging in with Devise and Rails","body":"<p>How do I redirect a user to a specific page when they login on a particular form I create with Devise? There's this howto page for Devise on <a href=\"https://github.com/plataformatec/devise/wiki/How-to%3a-redirect-to-a-specific-page-on-successful-sign-in-out\" rel=\"nofollow\">how to redirect to a particular page after sign in</a>. However, I want different forms to sign in to different target pages. Ideally, I can just add another HTML form parameter like this:</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"target\" value=\"/dashboard\"/&gt;\n</code></pre>\n\n<p><em><strong>UPDATE</em></strong>: It's important that I maintain the normal functionality of Devise for a login page. That is, if I click on a link that has a <code>before_filter :authenticate_user!</code> in its controller, then I'll be redirected to a login page. After logging in, then I'm redirected to the original destination page.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13243385,"title":"Can't mass-assign protected attributes: _destroy - Ruby on Rails","body":"<p>I'm getting this error:</p>\n\n<p>\"ActiveModel::MassAssignmentSecurity::Error in DaysController#create</p>\n\n<p>Can't mass-assign protected attributes: _destroy\"</p>\n\n<p>I didn't even know that _destroy is an attribute!</p>\n\n<p>What I have going on:</p>\n\n<p>My model is that I have \"Trips\" which has many \"Days\"</p>\n\n<p>In the \"Show\" view of my Trips model, I'm rendering a partial for a Form to add a new \"Day\":</p>\n\n<pre><code>&lt;div id=\"day_form\"&gt;\n  &lt;%= render :partial =&gt; \"day_form\", :day =&gt; @day %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>My model:</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :title, :days_attributes\n  has_many :days\n  accepts_nested_attributes_for :days, allow_destroy: true\n\nend\n\n\n class Day &lt; ActiveRecord::Base\n  attr_accessible :activity_id, :order, :summary, :trip_id, :activities_attributes\n  belongs_to :trip\n  has_many :activities, :order =&gt; 'position'\n  accepts_nested_attributes_for :activities, allow_destroy: true \nend\n</code></pre>\n\n<p>When I submit the form, I am getting this Mass Assignment error.  Why?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The 'Day' Form looks like this:</p>\n\n<pre><code>    &lt;%= form_for(@day) do |f| %&gt;\n\n      &lt;ul&gt;\n      &lt;% @day.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n        &lt;fieldset&gt;\n          &lt;%= f.label :summary, \"Day Summary\" %&gt;&lt;br /&gt;\n          &lt;%= f.text_area :summary, :rows =&gt; 1 %&gt;&lt;br /&gt;\n          &lt;%= f.hidden_field :_destroy %&gt;\n              &lt;%= link_to \"remove\", '#', class: \"remove_fields\" %&gt;\n        &lt;/fieldset&gt;\n        &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n        &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13238687,"title":"Nesting, is it what I need?","body":"<p>Projects have users.\nUsers have expenses.</p>\n\n<p>I have a screen for the currently signed in user to add new expenses, my controller forces the user key based on current_user.</p>\n\n<p>Now I am needing to allow users to work within a particular project, and enter their expenses for that project all at once, basically \"enter\" a project-expense screen, to limit the scope of the expenses shown in that screen by the project they selected.</p>\n\n<p>(Similar to the way basecamp makes you pick a project you work on)</p>\n\n<p>I do want to use this view for other things, and would like to  make it as DRY as possible.</p>\n\n<p>Was just wondering, what is the proper way to have a user select a project, and then persist that choice through their use of my existing expenses screen.</p>\n\n<p><strong>EDIT</strong> -  I would like to be able to pick a project, and then have all the functionality on the expenses page pass along that project through to the controller methods.</p>\n\n<p>So I could end up with /project/45/expenses .... etc</p>\n\n<p>Thanks!</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  attr_accessible :name, :active\n\n    has_many :expenses, foreign_key: :project_id\n\nend\n\nclass Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :expense_date, :project_id, :expense_type_id, :user_id\n\n  belongs_to :project\n    belongs_to :user\n    belongs_to :expense_type\n    has_one :expense_approval\n\nend\n\nclass User &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :name, :email, :password, :password_confirmation, :remember_me\n\n  has_many :expenses, foreign_key: :user_id\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13243357,"title":"Uploading multiple files to heroku serially locks up all dynos","body":"<p>Its my understanding that when I upload a file to my heroku instance its a synchronous request and I will get a 200 back when the request is done, which means my upload has been processed and stored by paperclip.</p>\n\n<p>I am using plupload which does a serial upload (one file at a time).  On Heroku I have 3 dynos and my app becomes unresponsive and I get timeouts trying to use the app.  My upload should really only tie up at most a single dyno while all the files are being uploaded since its done serially and file 2 doesnt start until a response is returned from file 1.</p>\n\n<p>As a test I bumped my dynos to 15 and ran the upload. Again I see the posts come into the logs and then I start seeing output of paperclip commands (cant remember if it was identify or convert) and I start getting timeouts.  </p>\n\n<p>I'm really lost as to why this is happening.  I do know I 'can' upload directly to s3 but my current approach should be just fine.  Its an admin interface that is only used by a single person and again at most it should tie up a single dyno since all the uploaded files are sent serially.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actionmailer"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2981,"score":0,"question_id":5309304,"title":"How to configure to send email through localhost app server without authentication?","body":"<p>I have configured the Rails mailer under config/initializers/ like following:</p>\n\n<p><strong>/config/initializers/setup_email.rb</strong></p>\n\n<pre><code>config.action_mailer.raise_delivery_errors = true\n\n  ActionMailer::Base.smtp_settings = {\n   :address =&gt; \"smtp.gmail.com\",\n   :port =&gt; 587,\n   :domain =&gt; 'gmail.com',\n   :authentication =&gt; :plain,\n   :user_name=&gt;&lt;username&gt;,\n   :password=&gt;&lt;password&gt;,\n   :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>it works fine, I can send emails and get them received.</p>\n\n<p>But how to configure it to send email from localhost without authentication(without username and password), that's do not use gmail, but send email through the application's local server, how to configure then?</p>\n\n<p>--EDIT---\nWhen using localhost, the error message I got is:</p>\n\n<pre><code>Connection refused - connect(2)\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `initialize'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `open'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `do_start'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/timeout.rb:67:in `timeout'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/timeout.rb:101:in `timeout'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:551:in `do_start'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/net/smtp.rb:525:in `start'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/network/delivery_methods/smtp.rb:127:in `deliver!'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:1967:in `do_delivery'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:228:in `deliver'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:401:in `deliver_mail'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages.rb:52:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages/instrumenter.rb:21:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activesupport-3.0.3/lib/active_support/messages.rb:52:in `instrument'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:399:in `deliver_mail'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@myapp/gems/mail-2.2.15/lib/mail/message.rb:228:in `deliver'\n/home/user1/myapp/app/mailers/my_mailer.rb:9:in `new_car_messages'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `send_action'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `process_action'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/old_api.rb:75:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:446:in `process'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:441:in `initialize'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:425:in `new'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/actionmailer-3.0.3/lib/action_mailer/base.rb:425:in `method_missing'\n/home/user1/myapp/config/../lib/my/new_car_sender.rb:7:in `send_email'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `__send__'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/activerecord-3.0.3/lib/active_record/relation.rb:13:in `each'\n/home/user1/myapp/config/../lib/my/new_car_sender.rb:6:in `send_email'\n/home/user1/myapp/lib/tasks/new_car_messages.rake:8\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:636:in `call'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:636:in `execute'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:631:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:631:in `execute'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:597:in `invoke_with_call_chain'\n/home/user1/.rvm/rubies/ruby-1.8.7-p330/lib/ruby/1.8/monitor.rb:242:in `synchronize'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `each'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2001:in `run'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/lib/rake.rb:1998:in `run'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/gems/rake-0.8.7/bin/rake:31\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/bin/rake:19:in `load'\n/home/user1/.rvm/gems/ruby-1.8.7-p330@global/bin/rake:19\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tags","acts-as-taggable-on"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":9028883,"title":"Using tags for user-set UX details","body":"<p>I'm using <code>acts_as_taggable_on</code> for tagging items across my system so that they're easily searchable.</p>\n\n<p>Now I have a UX problem: I'm noticing lots of places where users choose certain minor states (for example, closing a one-time help box or moving to the next javascript-run step in a given page). We have here situations that are both too minor/numerous/dynamic/fast-changing to be put into a database table (imagine having to migrate with every UX change!), and that there is a need to persist some of these choices beyond the session.</p>\n\n<p>In this case, is there anything wrong with using tags to store these simple decisions? For example, <code>user.set_tags_on(:ui, \"closed_index_help\")</code> or <code>user.set_tags_on(:ui, \"tutorial_1_done\")</code>, then showing/hiding these elements in the future by looking at the user's <code>ui_list</code>.</p>\n\n<p>Are there drawbacks to this I'm not considering or is this a prudent way to go?</p>\n"}]}
{"total":34674,"page":4,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","performance","time-series"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13243137,"title":"Efficiently plot database activity as a time series","body":"<p>I am working on a system where 200,000+ records have been created in the past year and I need to plot their creation on a time series with various added filters. At this present, this requires performing lots of <code>count</code> queries (30 for each month plotted). How should these dates be stored for maximum speed?</p>\n\n<p>One idea: store the most commonly-visualized data in a number of serialized fields containing <code>count</code>s for each day over the past month. Update each day with <code>cron</code> and serve up as necessary. (Where should these be stored - some new database table or a separate file accessible by Heroku cron?)</p>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":539,"score":3,"question_id":6418556,"title":"How do I build an 'embeddable widget'?","body":"<p>My webapp uses both Rails and JS and I would like users to be able to embed the images they upload to any blog/site.</p>\n\n<p>What do I need to know, from a development point-of-view to allow me to create the functionality that generates an 'embed' link. It can be either a link like YouTube does, or a JS snippet or anything.</p>\n\n<p>Just want to get a high-level overview of what I need to be able to do and how to proceed.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13242031,"title":"Rails, PaperClip, S3, Heroku: Model icon fields not being saved","body":"<p>I am using Rails 3.2 + Heroku + S3 + Paperclip to store an icon on my <code>User</code> model. The model is not saving the 4 icon fields though. The images are getting processed and saved on S3 correctly and no errors are occurring. I also have another model that has a document being stored via Paperclip and S3. That model works perfectly in all cases. The <code>User</code> icon works locally but not on Heroku.</p>\n\n<p><code>production.rb</code> relevant configuration</p>\n\n<pre><code>config.paperclip_defaults = {\n  :storage =&gt; :s3,\n  :s3_credentials =&gt; {\n    :bucket =&gt; ENV['AWS_BUCKET'],\n    :access_key_id =&gt; ENV['AWS_ACCESS_KEY_ID'],\n    :secret_access_key =&gt; ENV['AWS_SECRET_ACCESS_KEY']\n  }\n}\n</code></pre>\n\n<p>User model code:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :icon\n\n  has_attached_file :icon, :url =&gt; \"/system/:rails_env/:attachment/:style/:hash.:extension\",\n    :hash_data =&gt; \":class/:attachment/:id\",\n    :hash_secret =&gt; \"superSecretThing\",\n    :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" },\n    :default_url =&gt; \"/blank.png\"\n  ...\n</code></pre>\n\n<p>Controller code: (This code is kind of crazy because I am AJAXing files Base64 encoded.)</p>\n\n<pre><code>  params[:user][:icon_data]\n  decoded_file = Base64.decode64(data)\n  begin\n    split_name = params[:user][:icon_file_name].split(\".\")\n    file = Tempfile.new([split_name[0..-2].join(\".\"), \".#{split_name[-1]}\"])\n    file.binmode\n    file.write(decoded_file)\n    file.close\n    @user.icon = open(file)\n    @user.icon_file_name = params[:user][:icon_file_name]\n  ensure\n    file.unlink\n  end\n  @user.save\n</code></pre>\n\n<p>I do an almost identical process on another model with a Paperclip attachment and it works flawlessly. In both cases the attachment is being saved correctly to S3 and no errors are being raised. <a href=\"https://gist.github.com/4021058\" rel=\"nofollow\">This gist has example output</a> for a controller action from the Heroku logs. </p>\n\n<p>I am pretty baffled because the other model works fine. The only real difference is that the <code>User</code> attachment does image processing but that part appears to be working fine.</p>\n\n<p>The problem is the same as <a href=\"http://stackoverflow.com/questions/4654111/paperclip-w-imagemagick-amazon-s3-and-heroku-imagemagick-s3-work-but-the?rq=1\">this one</a>, but the solution there does not apply.</p>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13238824,"title":"how to test for inserts in database?","body":"<p>I have rspec test of a method that inserts or returns first record if record with given attributes doesn't exists. It looks like this</p>\n\n<pre><code>context 'user doesn't exists' do\n  subject { User.find_or_create(name: \"Jonh\", login: \"john\") }\n\n  it { should be_an_instance_of(User) }\n  //and here I want to test that new user was inserted into database...\n\nend\n</code></pre>\n\n<p>but I can't figure out how to use <code>expect to change</code> in this.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13238105,"title":"Can't mass-assign protected attributes in models with a has_one relation","body":"<p>Hello I have two models </p>\n\n<p>User Model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :user_information\n  attr_accessible :email, :name\nend\n</code></pre>\n\n<p>UserInformation Model</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :business, :phone\nend\n</code></pre>\n\n<p>I create a user record and everthing works fine, but when I try to create the user information I get this this error:</p>\n\n<blockquote>\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in UserInformationsController#create\n\nCan't mass-assign protected attributes: user\n</code></pre>\n</blockquote>\n\n<p>To create the user information record I go to </p>\n\n<blockquote>\n  <p>localhost:3000/users/1/user_informations/new</p>\n</blockquote>\n\n<p>and fill the form. Then I get the error.</p>\n\n<p>Please I need help I'm trying to do this for the last 4 days and now I desperate </p>\n\n<p>Thank you very much for your help.</p>\n\n<hr>\n\n<p>The user information form</p>\n\n<pre><code>&lt;%= form_for(@user_information) do |f| %&gt;\n  &lt;% if @user_information.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@user_information.errors.count, \"error\") %&gt; prohibited this user_information from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @user_information.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :user%&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :address %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :address %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :phone %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :phone %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :business %&gt;&lt;br /&gt;\n    &lt;%= f.check_box :business %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>the user_information_controller</p>\n\n<pre><code>class UserInformationsController &lt; ApplicationController\n  # GET /user_informations\n  # GET /user_informations.json\n  def index\n    @user_informations = UserInformation.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @user_informations }\n    end\n  end\n\n  # GET /user_informations/1\n  # GET /user_informations/1.json\n  def show\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n  # GET /user_informations/new\n  # GET /user_informations/new.json\n  def new\n    @user = User.find(params[:id])\n    @user_information = UserInformation.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @user_information }\n    end\n  end\n\n  # GET /user_informations/1/edit\n  def edit\n    @user_information = UserInformation.find(params[:id])\n  end\n\n  # POST /user_informations\n  # POST /user_informations.json\n  def create\n    @user_information = UserInformation.new(params[:user_information])\n\n    respond_to do |format|\n      if @user_information.save\n        format.html { redirect_to @user_information, notice: 'User information was successfully created.' }\n        format.json { render json: @user_information, status: :created, location: @user_information }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /user_informations/1\n  # PUT /user_informations/1.json\n  def update\n    @user_information = UserInformation.find(params[:id])\n\n    respond_to do |format|\n      if @user_information.update_attributes(params[:user_information])\n        format.html { redirect_to @user_information, notice: 'User information was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @user_information.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /user_informations/1\n  # DELETE /user_informations/1.json\n  def destroy\n    @user_information = UserInformation.find(params[:id])\n    @user_information.destroy\n\n    respond_to do |format|\n      format.html { redirect_to user_informations_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13241978,"title":"Rails private messages how to create a conversation view?","body":"<p>I am using this gem for private messages: <a href=\"https://github.com/jongilbraith/simple-private-messages\" rel=\"nofollow\">https://github.com/jongilbraith/simple-private-messages</a></p>\n\n<p>I want to create a thread conversation instead of the e-mail conversation the scaffold have provided.</p>\n\n<p>Example, User A have sent 10 messages to User B. User A have also sent 10 messages to User C. </p>\n\n<p>Instead of looping through all the messages. (e-mail look) I want to create a threat like:</p>\n\n<p><strong>Inbox</strong></p>\n\n<pre><code>Conversation with User A (10 messages)\nConversation with User C (10 messages) \n</code></pre>\n\n<p>And when clicking on the conversation the messages should be ordered after date. So it would be like a conversation. </p>\n\n<p>The table for messages:</p>\n\n<pre><code>id\nsender_id\nrecipient_id\nsender_deleted\nrecipient_deleted\nsubject\nbody\nread_at\ncreated_at\nupdated_at\n</code></pre>\n\n<p>How do I create these views? How do I group the messages?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":54,"score":-1,"question_id":13241595,"title":"getting undefined method `id' when saving a document","body":"<p>When I try to save a document, I get this error:</p>\n\n<pre><code>undefined method `id' for \"504b6d66493f1b9c18000007\":String\n</code></pre>\n\n<p>with this parameter:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"VkES2ecwdT6dPg3DDPK+O4NRa0mZy7zKALnkBXJ1Hbs=\",\n \"document\"=&gt;{\"name\"=&gt;\"Hoje\",\n \"description\"=&gt;\"## que bla bla bla\",\n \"storage\"=&gt;\"504b6d66493f1b9c18000007\",\n \"pub\"=&gt;\"1\"},\n \"commit\"=&gt;\"Save document\",\n \"id\"=&gt;\"5096d0f2e667079c17000029\"}\n</code></pre>\n\n<p>as you can see, the Id which the error refers, belongs to <code>storage</code> and not to <code>document</code> itself...</p>\n\n<p>this is my relationship</p>\n\n<h1>document.rb</h1>\n\n<pre><code>class Document\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::Versioning\n  include Mongoid::FullTextSearch\n\n  #Fields\n  field :name, type: String\n  field :description, type: String\n  field :pub, type: Boolean, default: true\n  field :file_content, type: String\n\n  mount_uploader :file, FileUploader\n\n  #Validations\n  validates :name, presence: true;\n\n  #Relations\n  belongs_to :user\n  belongs_to :storage\n  belongs_to :organization\n\n  fulltext_search_in :file_content, \n    :index_name =&gt; 'fts_documento.content',\n    :filters =&gt; { \n      :pvt =&gt; lambda { |x| x.pub == true},\n      :org =&gt; lambda {|document| document.organization }\n    }\nend\n</code></pre>\n\n<h1>storage.rb</h1>\n\n<pre><code>class Storage\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  #Fields\n  field :path, type: String\n\n  #Validations\n  validates :path, presence: true\n\n  #Relations\n  belongs_to :user\n  belongs_to :organization\nend\n</code></pre>\n\n<p>and here is my <code>update</code> action</p>\n\n<pre><code>  def update\n    @document = Document.find params[:id]\n    if @document.update_attributes params[:document]\n\n      if params[:document][:file]\n        IndexerWorker.perform_async(@document.id)\n      end\n\n      redirect_to dashboard_path, notice: 'Document updated'\n    else\n      render 'document/edit'\n    end\n  end\n</code></pre>\n\n<p>I have no idea nor where to start...<br>\nIt was working a couple of weeks ago..  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":3784,"score":0,"question_id":4115931,"title":"Rails - Devise - edit_user_registration_path","body":"<p>with Rails there is the path, edit_user_registration_path to allow users to edit their profile.</p>\n\n<p>I'm setting up my own Account Control to present the user with a better UI to edit their profile etc.. which is routed at /account/profile, /account/notices, etc....</p>\n\n<p>Problem is this URL, /users/edit  still works and takes users to the DEVISE edit page.</p>\n\n<p>How can I have that always go to the new edit page /account/profile</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","datetime","postgresql"],"answer_count":1,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":1272,"score":5,"question_id":9571392,"title":"Ignoring timezones altogether in Rails and PostgreSQL","body":"<p>I'm dealing with dates and times in Rails and Postgres and running into this issue:</p>\n\n<p>The database is in UTC.</p>\n\n<p>The user sets a time-zone of choice in the Rails app, but it's only to be used when getting the users local time for comparing times.</p>\n\n<p>User stores a time, say March 17, 2012, 7pm. I don't want timezone conversions or the timezone to be stored. I just want that date and time saved. That way if the user changed their time zone, It would still show March 17, 2012, 7pm.</p>\n\n<p>I only use the users specified time zone to get records 'before' or 'after' the current time in the users local time zone. </p>\n\n<p>I'm currently using 'timestamp without time zone' but when I retrieve the records, rails (?) converts them to the time zone in the app, which I don't want. </p>\n\n<pre><code>Appointment.first.time\n =&gt; Fri, 02 Mar 2012 19:00:00 UTC +00:00 \n</code></pre>\n\n<p>Because the records in the database seem to come out as UTC, my hack is to take the current time, remove the time zone with 'Date.strptime(str, \"%m/%d/%Y\")' and then do my query with that:</p>\n\n<pre><code>.where(\"time &gt;= ?\", date_start)\n</code></pre>\n\n<p>It seems like there must be an easier way to just ignore time zones all around. Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13238530,"title":"rails routing- not going to 404 on wrong address","body":"<p>I'm using this to_param</p>\n\n<pre><code>def to_param\n    [id, [first_name.parameterize,last_name.parameterize].join(\"_\")].join(\"-\")\nend\n</code></pre>\n\n<p>to produce an address that look like</p>\n\n<pre><code>http://www.example.com/users/34-joe_smith\n</code></pre>\n\n<p>but if I change the address to</p>\n\n<pre><code>http://www.example.com/users/34-joe_notsmith\n</code></pre>\n\n<p>It still directs me to user with id 34.</p>\n\n<p>How can I enforce it to go to 404 page or root_path?</p>\n"},{"tags":["linux","ruby-on-rails-3","bash-completion"],"answer_count":2,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":799,"score":11,"question_id":3847603,"title":"bash_completion for Rails 3","body":"<p>Is there any <code>bash_completion</code> script ready for Rails 3?</p>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":163,"score":3,"question_id":10521793,"title":"Allow users to create dynamic model attributes?","body":"<p>In my <code>Rails3</code> app, I am using <code>ActiveRecord</code> and <code>Postgresql</code>.</p>\n\n<p>Say I have a model called <strong>Parts</strong>.  The model has a small list of standard attributes such as price, quantity, etc.</p>\n\n<p>However, Customer A might want to add <code>LotNumber</code> and CustomerB might want to add <code>OriginalLocation</code>.</p>\n\n<p>How would I allow them to do that?</p>\n\n<p>I thought about creating a <strong>PartsDetail</strong> model that allowed them to have a type.</p>\n\n<pre><code>class PartsDetail &lt; ActiveRecord::Base\n    attr_accessible :type, :value, :part_id\n    belongs_to :parts\nend\n</code></pre>\n\n<p>So that \"type\" could be \"LotNumber\", etc.</p>\n\n<p>But I'm not quite sure how that would work in my associations and querying. </p>\n\n<p>Any ideas?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","tags","virtual-attribute","changed"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13241033,"title":"Rails not showing virtual attribute as changed","body":"<p>I am using RocketTag and have the following in my model (other parts removed to keep it simple):</p>\n\n<pre><code>attr_accessible :tags, :tag_list\n\nbefore_update { do_something }\n\ndef tag_list\n  self.tags.join(\",\")\nend\n\ndef tag_list=(new_tags)\n  # split into array (comma and any spaces), ignore empties\n  self.tags = new_tags.split(/,[\\s]*/).reject(&amp;:empty?)\nend\n\nprivate\n\n  def do_something\n    if self.changed_for_autosave?\n      # something happens\n    end\n  end\n</code></pre>\n\n<p>However, \"do_something\" fires if any of the other fields are updated but not if the tags or tag_list are updated.</p>\n\n<p>Can anyone tell me why or suggest a workaround?</p>\n\n<p>I know about putting <code>attribute_will_change!(:tag_list)</code> within the tag_list setter but that is marking tag_list as changed everytime and I only want <code>do_something</code> to fire when something actually changes.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":163,"score":0,"question_id":9964105,"title":"config.fog_host does not works fine for me with cdn's in rails 3.1","body":"<p>I have this in my <strong>fog.rb</strong></p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',\n    :aws_access_key_id      =&gt; 'key',\n    :aws_secret_access_key  =&gt; 'key',\n    :region                 =&gt; 'eu-west-1'\n  }\n\n  config.fog_host = proc { \"http://cdn#{(rand * 4).ceil}.domain.com\" }\n  config.fog_directory = 'pro'\n  config.fog_public = false\n  config.fog_attributes = {'Cache-Control' =&gt; 'max-age=315576000'} \nend\n</code></pre>\n\n<p>But I see the images routes to <a href=\"https://s3-eu-west-1.amazonaws.com/pro\" rel=\"nofollow\">https://s3-eu-west-1.amazonaws.com/pro</a>...</p>\n\n<p>However my assets js, css, and images assets works fine I see: </p>\n\n<p><a href=\"http://cdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png\" rel=\"nofollow\">http://cdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png</a></p>\n\n<p><strong>What am I doing wrong in this config?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13240064,"title":"How to render a \"Edit\" form partial in the \"Show\" page of another model in Rails","body":"<p>I want to display an \"Edit\" form in the \"Show\" view of a parent object.</p>\n\n<p>My model looks like this:\nA Trip has many Days which has many Activities.\nTrip accepts nested attributes for Days.  Days accepts nested Attributes for Activities.</p>\n\n<p>When I am in the \"Show\" view for a Trip, how do I render an \"Edit\" form partial for an \"Activity\"?</p>\n\n<p>I know I need to somehow specify to the Edit Form partial which Activity ID that I want to edit but I'm not sure how to pass along that information from the \"Show\" view of a \"Trip\".</p>\n\n<pre><code>    &lt;% @trip.days.each do |day| %&gt;\n    &lt;div id=\"daydiv_&lt;%= day.id %&gt;\"&gt;\n      &lt;b&gt;&lt;%= day.summary %&gt;&lt;/b&gt;\n        &lt;%= content_tag_for :ol, day do %&gt;\n          &lt;% day.activities.each do |activity| %&gt;\n                &lt;li id=\"activity_&lt;%= activity.id %&gt;\"&gt;&lt;%= link_to activity.address, edit_activity_path(activity) %&gt;&lt;/li&gt;\n          &lt;% end %&gt;\n      &lt;% end %&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n\n&lt;div id=\"activity_form\"&gt;\n  &lt;%= render :partial =&gt; \"/activities/form\", :activity =&gt; @activity  %&gt;\n&lt;/div&gt; \n</code></pre>\n\n<p>my /activities/form partial looks like this:</p>\n\n<pre><code>&lt;%= form_for(@activity) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13239929,"title":"\"nil is not a symbol\" for model count in rspec matcher","body":"<p>I am trying to write an integration test where if a user clicks on a button, it creates a new record in the database (CheckPrice model).</p>\n\n<p>I am running into the error <code>nil is not a symbol</code> when I try to run my test.</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe 'CheckPrice', type: :request, js: true  do\n  it \"should create a new CheckPrice record when user clicks Check Price on topic page\" do\n    city = create :city\n    hotel = create :hotel\n    affiliate_link = create :affiliate_link\n\n    visit '/hotel-bilboa-hotel'\n    sleep 2\n    click_button \"Check Prices\"\n    response.should change(CheckPrice.count).by(1)\n  end\nend\n</code></pre>\n\n<p>When \"Check Prices\" is clicked, there is an event listener that triggers the new method in the checkprices_controller.</p>\n\n<p>The error seems to occur on the last line <code>response.should change(CheckPrice.count).by(1)</code>. It looks like the method does not recognize the model CheckPrice. How do I reference the CheckPrice table?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":476,"score":2,"question_id":10186523,"title":"Full Asset URL in a Rails .js.erb file","body":"<p>I have a bookmarklet that can be loaded on any website.</p>\n\n<p>It works like this;</p>\n\n<ul>\n<li>loads <code>http://my.example.com/assets/bookmarklet.js</code></li>\n<li>includes <code>http://my.example.com/assets/bookmarklet.css</code></li>\n</ul>\n\n<p>The css file is added to the dom via <code>bookmarklet.js</code>, so it needs to know where this is.</p>\n\n<p>My code is as follows;</p>\n\n<pre><code>// assets/javascripts/bookmarklet.js.erb\n\nvar config = {\n  stylesheetUrl: '&lt;%= asset_path(\"bookmarklet.css\", :only_path =&gt; false) %&gt;'\n}\n</code></pre>\n\n<p>But no matter what I try this renders as</p>\n\n<pre><code>var config = {\n  stylesheetUrl: '/assets/bookmarklet.css'\n}\n</code></pre>\n\n<p>I need the <code>asset_path</code> to return a full url.\nBut <code>asset_url</code> doesn't exist, and I can't find an option to <code>asset_path</code> that will prepend the current domain.</p>\n\n<p>Any solution?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":283,"score":0,"question_id":11158850,"title":"Hartl Chapter 10 Undefined local variable or method 'object'","body":"<p>I made the form partial for creating microposts as shown in <a href=\"http://ruby.railstutorial.org/chapters/user-microposts#code%3amicropost_form\" rel=\"nofollow\">Listing 10.33</a> with <code>&lt;%= render 'shared/error_messages', object: f.object %&gt;</code> and updated the respective views files as instructed. However, I cannot get the Rspec tests to pass as I keep getting \"undefined local variable or method 'object' for Class...\" Any ideas?</p>\n\n<p>app/views/shared/_micropost_form.html.erb</p>\n\n<pre><code>&lt;%= form_for(@micropost) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_area :content, placeholder: \"Compose new micropost...\" %&gt;\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>app/views/shared/_error_messages.html.erb</p>\n\n<pre><code>&lt;% if object.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;div class=\"alert alert-error\"&gt;\n      The form contains &lt;%= pluralize(object.errors.count, \"error\") %&gt;.\n    &lt;/div&gt;\n    &lt;ul&gt;\n      &lt;% object.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;* &lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>app/views/users/new.html.erb</p>\n\n<pre><code>&lt;% provide(:title, 'Sign up') %&gt;\n&lt;h1&gt;Sign up&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= render 'fields', f: f %&gt;\n      &lt;%= f.submit \"Create my account\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>app/views/users/edit.html.erb</p>\n\n<pre><code>&lt;% provide(:title, \"Edit user\") %&gt; \n&lt;h1&gt;Update your profile&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(@user) do |f| %&gt;\n      &lt;%= render 'shared/error_messages', object: f.object %&gt;\n      &lt;%= render 'fields', f: f %&gt;\n      &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n\n    &lt;%= gravatar_for @user %&gt;\n    &lt;a href=\"http://gravatar.com/emails\" target=\"_blank\"&gt;change&lt;/a&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Authentication Spec</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Authentication\" do\n\n  subject { page }\n\n  describe \"signin page\" do\n    before { visit signin_path }\n\n    it { should have_selector('h1',    text: 'Sign in') }\n    it { should have_selector('title', text: 'Sign in') }\n  end\n\n  describe \"signin\" do\n    before { visit signin_path }\n\n    describe \"with invalid information\" do\n      before { click_button \"Sign in\" }\n\n      it { should have_selector('title', text: 'Sign in') }\n      it { should have_error_message('Invalid') }\n\n      it { should_not have_link('Users',    href: users_path) }\n      it { should_not have_link('Sign out', href: signout_path) }\n\n      describe \"after visiting another page\" do\n        before { click_link \"Home\" }\n        it { should_not have_selector('div.alert.alert-error') }\n      end      \n    end\n\n    describe \"with valid information\" do\n      let(:user) { FactoryGirl.create(:user) }\n      before { sign_in user }\n\n      it { should have_selector('title', text: user.name) }\n\n      it { should have_link('Users',    href: users_path) }\n      it { should have_link('Profile', href: user_path(user)) }\n      it { should have_link('Settings', href: edit_user_path(user)) }\n      it { should have_link('Sign out', href: signout_path) }\n\n      it { should_not have_link('Sign in', href: signin_path) }\n\n      describe \"followed by signout\" do\n        before { click_link \"Sign out\" }\n        it { should have_link('Sign in') }\n      end      \n    end    \n  end  \n\n  describe \"authorization\" do\n\n    describe \"for non-signed-in users\" do\n      let(:user) { FactoryGirl.create(:user) }\n\n      describe \"in the Users controller\" do\n\n      it { should_not have_link('Profile', href: user_path(user)) }\n      it { should_not have_link('Settings', href: edit_user_path(user)) }\n\n        describe \"visiting the edit page\" do\n          before { visit edit_user_path(user) }\n          it { should have_selector('title', text: 'Sign in') }\n        end\n\n        describe \"submitting to the update action\" do\n          before { put user_path(user) }\n          specify { response.should redirect_to(signin_path) }\n        end\n\n        describe \"visiting the user index\" do\n          before { visit users_path }\n          it { should have_selector('title', text: 'Sign in') }\n        end \n      end\n\n      describe \"when attempting to visit a protected page\" do\n        before do\n          visit edit_user_path(user)\n          fill_in \"Email\",    with: user.email\n          fill_in \"Password\", with: user.password\n          click_button \"Sign in\"\n        end\n\n        describe \"after signing in\" do\n\n          it \"should render the desired protected page\" do\n            page.should have_selector('title', text: 'Edit user')\n          end\n\n      describe \"when signing in again\" do\n        before do\n          visit signin_path\n          fill_in \"Email\", with: user.email\n              fill_in \"Password\", with: user.password\n          click_button \"Sign in\"\n            end\n\n        it \"should render the default (profile) page\" do\n          page.should have_selector('title', text: user.name)\n        end\n          end\n        end\n\n      describe \"in the Microposts controller\" do\n\n        describe \"submitting to the create action\" do\n          before { post microposts_path }\n          specify { response.should redirect_to(signin_path) }\n        end\n\n        describe \"submitting to the destroy action\" do\n          before { delete micropost_path(FactoryGirl.create(:micropost)) }\n          specify { response.should redirect_to(signin_path) }\n        end\n      end   \n    end\n  end\n\n    describe \"as wrong user\" do\n      let(:user) { FactoryGirl.create(:user) }\n      let(:wrong_user) { FactoryGirl.create(:user, email: \"wrong@example.com\") }\n      before { sign_in user }\n\n      describe \"visiting Users#edit page\" do\n        before { visit edit_user_path(wrong_user) }\n        it { should_not have_selector('title', text: full_title('Edit user')) }\n      end\n\n      describe \"submitting a PUT request to the Users#update action\" do\n        before { put user_path(wrong_user) }\n        specify { response.should redirect_to(root_path) }\n      end\n    end  \n\n    describe \"as non-admin user\" do\n      let(:user) { FactoryGirl.create(:user) }\n      let(:non_admin) { FactoryGirl.create(:user) }\n\n      before { sign_in non_admin }\n\n      describe \"submitting a DELETE request to the Users#destroy action\" do\n        before { delete user_path(user) }\n        specify { response.should redirect_to(root_path) }        \n      end\n    end\n  end  \nend\n</code></pre>\n\n<p>User Spec</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"User pages\" do\n\n  subject { page }\n\n  describe \"index\" do\n\n    let(:user) { FactoryGirl.create(:user) }\n\n    before(:all) { 30.times { FactoryGirl.create(:user) } }\n    after(:all)  { User.delete_all }\n\n    before(:each) do\n      sign_in user\n      visit users_path\n    end    \n\n    it { should have_selector('title', text: 'All users') }\n    it { should have_selector('h1',    text: 'All users') }    \n\n    describe \"pagination\" do\n\n      it { should have_selector('div.pagination') }\n\n      it \"should list each user\" do\n        User.paginate(page: 1).each do |user|\n          page.should have_selector('li', text: user.name)\n        end\n      end\n    end\n\n    describe \"delete links\" do\n\n      it { should_not have_link('delete') }\n\n      describe \"as an admin user\" do\n        let(:admin) { FactoryGirl.create(:admin) }\n        before do\n          sign_in admin\n          visit users_path\n        end\n\n        it { should have_link('delete', href: user_path(User.first)) }\n        it \"should be able to delete another user\" do\n          expect { click_link('delete') }.to change(User, :count).by(-1)\n        end\n        it { should_not have_link('delete', href: user_path(admin)) }\n      end\n    end     \n  end\n\n  describe \"signup page\" do\n    before { visit signup_path }\n\n    it { should have_selector('h1',    text: 'Sign up') }\n    it { should have_selector('title', text: 'Sign up') }\n  end\n\n  describe \"profile page\" do\n    let(:user) { FactoryGirl.create(:user) }\n    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: \"Foo\") }\n    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: \"Bar\") }   \n\n    before { visit user_path(user) }\n\n    it { should have_selector('h1',    text: user.name) }\n    it { should have_selector('title', text: user.name) }\n  end  \n\n  describe \"microposts\" do\n      it { should have_content(m1.content) }\n      it { should have_content(m2.content) }\n      it { should have_content(user.microposts.count) }\n    end\n\n  describe \"signup\" do\n\n    before { visit signup_path }\n\n    let(:submit) { \"Create my account\" }\n\n    describe \"with invalid information\" do\n      it \"should not create a user\" do\n        expect { click_button submit }.not_to change(User, :count)\n      end\n\n      describe \"after submission\" do\n        before { click_button submit }\n\n        it { should have_selector('title', text: 'Sign up') }\n        it { should have_content('error') }\n      end      \n    end\n\n    describe \"with valid information\" do\n      before { valid_signup }\n\n      it \"should create a user\" do\n        expect { click_button submit }.to change(User, :count).by(1)\n      end\n\n      describe \"after saving the user\" do\n        before { click_button submit }\n        let(:user) { User.find_by_email('user@example.com') }\n\n        it { should have_selector('title', text: user.name) }\n        it { should have_success_message('Welcome') }\n    it { should have_link('Sign out') }\n      end\n    end\n  end  \n\n  describe \"edit\" do\n    let(:user) { FactoryGirl.create(:user) }\n    before do\n      sign_in user\n      visit edit_user_path(user)\n    end\n\n    describe \"page\" do\n      it { should have_selector('h1',    text: \"Update your profile\") }\n      it { should have_selector('title', text: \"Edit user\") }\n      it { should have_link('change', href: 'http://gravatar.com/emails') }\n    end\n\n    describe \"with invalid information\" do\n      before { click_button \"Save changes\" }\n\n      it { should have_content('error') }\n    end\n\n    describe \"with valid information\" do\n      let(:new_name)  { \"New Name\" }\n      let(:new_email) { \"new@example.com\" }\n      before do\n        fill_in \"Name\",             with: new_name\n        fill_in \"Email\",            with: new_email\n        fill_in \"Password\",         with: user.password\n        fill_in \"Confirm Password\", with: user.password\n        click_button \"Save changes\"\n      end\n\n      it { should have_selector('title', text: new_name) }\n      it { should have_success_message }\n      it { should have_link('Sign out', href: signout_path) }\n      specify { user.reload.name.should  == new_name }\n      specify { user.reload.email.should == new_email }\n    end    \n  end  \nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","solr","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":160,"score":0,"question_id":8366240,"title":"sunspot solr: What is the functional difference between path and solr_home?","body":"<p>I was wondering if somebody can teach me the functional differences between <em>path</em> and *solr_home*. What kind of paths can they take (I know <em>path</em> cannot take filesystem path as parameters).</p>\n\n<p>My current production configuration is:</p>\n\n<pre><code>port: 8080\npath: /solr/\nsolr_home: /usr/share/apache-solr-3.3.0/solr/\n</code></pre>\n\n<p>I was under the impression that the index info is stored in my rails app /solr/ directory and that with every cap deploy they will be erased, but they are not so where are my solr index files stored? And what does that solr_home path do?</p>\n\n<p>Please somebody clear my doubts.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":10850163,"title":"Javascript file is not updated in development with Rails","body":"<p>I changed a JS file under app/assets/javascripts but it is still the same. I deleted the file and re-created but the content is still the old one. This is my development.rb file:</p>\n\n<pre><code>App::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  config.serve_static_assets = false\n\n  # In the development environment your application's code is reloaded on\n  # every request.  This slows down response time but is perfect for development\n  # since you don't have to restart the web server when you make code changes.\n  config.cache_classes = false\n\n  # Log error messages when you accidentally call methods on nil.\n  config.whiny_nils = true\n\n  # Show full error reports and disable caching\n  config.consider_all_requests_local       = true\n  config.action_controller.perform_caching = false\n\n  # Don't care if the mailer can't send\n  config.action_mailer.raise_delivery_errors = false\n\n  # Print deprecation notices to the Rails logger\n  config.active_support.deprecation = :log\n\n  # Only use best-standards-support built into browsers\n  config.action_dispatch.best_standards_support = :builtin\n\n  # Do not compress assets\n  config.assets.compress = false\n\n  # Expands the lines which load the assets\n  config.assets.debug = true\n\n  config.action_mailer.delivery_method = :letter_opener\n\n  config.action_mailer.default_url_options = { :host =&gt; \"lvh.me:3000\" }\n\n  # Raise exception on mass assignment protection for Active Record models\n  # config.active_record.mass_assignment_sanitizer = :strict\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  config.active_record.auto_explain_threshold_in_seconds = 0.5\n\n  config.log_tags = [:uuid, :remote_ip]\nend\n</code></pre>\n\n<p>The JS file is loaded inside the header tag with this code:</p>\n\n<pre><code>&lt;script src=\"/assets/deals.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>which is the normal way JS is loaded in development</p>\n"},{"tags":["javascript","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13235331,"title":"Debugging where rendered JS output is going","body":"<p>I have a Rails 3 application using unobtrusive Javascript on a link_to, to create a small window requiring user input. Here's the original button (for when a Client adds a Cat):</p>\n\n<pre><code>&lt;%= link_to \"New Cat\", new_client_cat_path(@client), :remote =&gt; true, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>In app/controllers/cats_controller.rb:</p>\n\n<pre><code>def new\n  @cat = @client.cats.build\n  @submit_label = \"Create\"\n  respond_to do |format|\n    format.html\n    format.js { }\n  end\nend\n</code></pre>\n\n<p>In app/views/cats/new.js.erb:</p>\n\n<pre><code>$('#&lt;%= dom_id(@cat) %&gt; .details').html('&lt;%= escape_javascript render(\"new\") %&gt;');\n</code></pre>\n\n<p>In app/views/cats/_new.html.erb:</p>\n\n<pre><code>&lt;h2&gt;New Cat&lt;/h2&gt;\n&lt;%= form_for [@client, @cat] do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n&lt;%= f.submit @submit_label, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n&lt;% end %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>My problem is that I don't see the rendered \"new\" window. The log file shows that these pages got rendered:</p>\n\n<pre><code>Rendered cats/_new.html.erb (3.8ms)\nRendered cats/new.js.erb (5.4ms)\n</code></pre>\n\n<p>How can I tell where the output is getting rendered to, so that I can figure out why I don't see it in the same window where the user clicked the \"New Cat\" button?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13059971,"title":"Jquery basic file upload","body":"<p>I been working on a screencast pro proposed by Ryan called the Jquery file uploads. However every time i input images it doesn't get uploaded. I am not sure what i am doing wrong here my code. I am using google and did try to upload it but it doesn't seem to be doing anything</p>\n\n<p>Javascript\napplication.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-fileupload/basic\n//= require jquery-fileupload/vendor/tmpl\n//= require_tree .\n</code></pre>\n\n<p>painting.js.coffee</p>\n\n<pre><code>jQuery -&gt;\n  $('#new_painting').fileupload\n</code></pre>\n\n<p>Views\n_form.html.erb</p>\n\n<pre><code>&lt;%= form_for @painting, :html =&gt; {:multipart =&gt; true} do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.hidden_field :galley_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :image %&gt;&lt;br /&gt;\n    &lt;%= f.file_field :image %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>index.html.erb</p>\n\n<h1>Painting Gallery</h1>\n\n\n  \n\n\n\n\n<pre><code>&lt;%= form_for Painting.new do |f| %&gt;\n  &lt;%= f.label :image, \"Upload paintings:\" %&gt;\n  &lt;%= f.file_field :image, multiple: true, name: \"painting[image]\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>show.html.erb</p>\n\n<pre><code>&lt;p&gt;&lt;%= image_tag @painting.image_url %&gt;&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;%= link_to \"Edit\", edit_painting_path(@painting) %&gt; |\n  &lt;%= link_to \"Destroy\", @painting, :confirm =&gt; 'Are you sure?', :method =&gt; :delete %&gt; |\n  &lt;%= link_to \"Back to Paintings\", paintings_path %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>def index\n    @paintings = Painting.all\n  end\n\n  def show\n    @painting = Painting.find(params[:id])\n  end\n\n  def new\n    @painting = Painting.new\n  end\n\n  def create\n    @painting = Painting.create(params[:painting])\n  end\n\n  def edit\n    @painting = Painting.find(params[:id])\n  end\n\n  def update\n    @painting = Painting.find(params[:id])\n    if @painting.update_attributes(params[:painting])\n      redirect_to paintings_url, notice: \"Painting was successfully updated.\"\n    else\n      render :edit\n    end\n  end\n\n  def destroy\n    @painting = Painting.find(params[:id])\n    @painting.destroy\n    redirect_to paintings_url, notice: \"Painting was successfully destroyed.\"\n  end\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>  attr_accessible :image\n  mount_uploader :image, ImageUploader\n</code></pre>\n\n<p>My main issues is when it comes to upload any picture it just doesn't have a submit button and not sure how to make it work, did i miss something??</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":41,"score":4,"question_id":13182644,"title":"Rails Relation#update_all consumes more memory than Relation#update","body":"<p>The <code>Relation#update(id, attributes)</code> docs mentions that \"The resulting object is returned whether the object was saved successfully to the database or not.\", while the <code>Relation#update_all(updates, conditions = nil, options = {})</code> states that no instantiations, callbacks or validations are made (straight DB query).</p>\n\n<p>Running a simple performance test and replacing <code>Relation#update</code> with <code>Relation#update_all</code>, it looks like the memory consumption have increased.</p>\n\n<p>Any explanation?</p>\n\n<p>Excerpt:</p>\n\n<pre><code>#Before\nMyModel.update(my_hash['id'], special_attrs)\n\n#After (more memory consumed)\nMyModel.where(:id =&gt; my_hash['id']).update_all(special_attrs)\n\n#Update-2 (slightly more memory consumed than with update(id, attrs)\nMyModel.update_all(special_attrs, {:id =&gt; my_hash['id']})\n</code></pre>\n\n<ul>\n<li>Windows XP (yeh - I know)</li>\n<li>JRuby 1.6.8 (1.9)</li>\n<li>Rails 3.2.8</li>\n</ul>\n\n<p><strong>UPDATE</strong> - Some basic numbers for comparison: \nFor around 700 update statements fired, there's a difference of around 0.6MB (0.8kB per statement)</p>\n\n<p><strong>UPDATE 2</strong> - Removed AREL chaining as per @philip-hallstrom suggestion. Slight reduction in memory footprint but still <code>MyModel.update_all(attrs, conditions)</code> is consuming more memory than <code>MyModel.update(id, attrs)</code>.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13230702,"title":"Selecting favourites from DB rails 3","body":"<p>I have a small app which has Users, Recipes, Ingredients and preparation models</p>\n\n<p>A user has many recipes, recipes belong to user and ingredients/preparation belongs to recipes.</p>\n\n<p>Now a user can view all recipes but I would like the option to add the particular recipe to a favourites list. Would I need to set a new DB to hold this and then link by associations or could I add a column to the recipe model called fav for example?</p>\n\n<p>Im looking for the best practice here or if someone has done this before and can offer any advice that would be appreciated</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13234849,"title":"RoR - Time.strptime issues","body":"<p>Here is the method in question. </p>\n\n<pre><code>def published_at_setter\n    self.published_at = Time.strptime(\"#{@date} #{@time}\", \"%m/%d/%Y %I:%M %p\")\n    puts \" ~~~~~~~~~~~~~~~~~~~ #{@date} #{@time} ~~~~~~~~~~~~~~~~ #{self.published_at}\"\nend\n</code></pre>\n\n<p>With @date = \"09/11/2012\" and @time \"01:45 AM\" I get this in the webbrick console. WFT?</p>\n\n<pre><code>~~~~~~~~~~~~~~~~~~~ 09/11/2012 01:45 AM ~~~~~~~~~~~~~~~~ 2012-09-11 06:45:00 UTC\n</code></pre>\n\n<p>When in rails console I get the expected results. \"2012-09-11 01:45:00 -0500\"</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13235986,"title":"Rails - Always have to check exists, and then value?","body":"<p>I am checking to see if a value in a related table exists quite often in my view, in this case, expenses have approvals.  If they have not been submitted, then there is no record of them in the approvals table.  </p>\n\n<p>I am ending up with some really awkward code</p>\n\n<pre><code>&lt;% if !expense_item.expense_approval || expense_item.expense_approval.approval_status == 0 %&gt;\n</code></pre>\n\n<p>Is there a way to do an if statement on a value, without having to check if it exists first?  Or some default way to set it nil?</p>\n"},{"tags":["ruby","ruby-on-rails-3","report"],"answer_count":1,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":149,"score":4,"question_id":12889659,"title":"Ruby or Rails reporting tools?","body":"<p>I am looking for a report generation tool in ruby or rails which allows the user to define a template, then fetch data into the created template.</p>\n\n<p>I have been looking through \"<a href=\"https://www.ruby-toolbox.com/categories/reporting.html\" rel=\"nofollow\">The Ruby Box: reporting section.</a>\"</p>\n\n<p>There are two reporting tools I have looked at:</p>\n\n<ol>\n<li><p><strong><a href=\"http://www.thinreports.org/\" rel=\"nofollow\">Thin Reports</a>:</strong> It is really good. You can create your own report template with the template editor. Then you can produce PDF reports using <a href=\"http://rubygems.org/gems/thinreports/\" rel=\"nofollow\">thinreports</a> gems.</p></li>\n<li><p><strong><a href=\"https://github.com/sandrods/odf-report\" rel=\"nofollow\">ODF Report:</a></strong> You can create a template ODF file using Open Office and MS Word, and you can use that template to generate the report.</p></li>\n</ol>\n\n<p>Both of these solutions lack the ability to draw charts. Does anyone know of similar reporting tools that can draw charts within a given report?</p>\n\n<p>I have tried the <a href=\"http://ruby-rtf.rubyforge.org/\" rel=\"nofollow\">RTF Ruby Library</a>. It works, but shares the limitation that it cannot draw charts and graphs. </p>\n\n<p>The minimum requirements are:</p>\n\n<ol>\n<li><p>Able to create customizable templates. (e.g. design layout, set font size, color, embed images etc.)</p></li>\n<li><p>Able to draw tables and charts.</p></li>\n<li><p>Template could be in Docx or excel or xml or any other common file format.</p></li>\n<li><p>Report output report must be in Docx or RTF format.</p></li>\n</ol>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13229927,"title":"Saving only processed images in paperclip","body":"<p>my paperclip setup is </p>\n\n<pre><code>has_attached_file :avatar, :styles =&gt; { :medium =&gt; \"300x300\", :thumb =&gt; \"100x100\"},\n    :storage =&gt; :s3,\n    :bucket =&gt; ENV['BUCKET'],\n    :s3_credentials =&gt; {\n      :access_key_id =&gt; ENV['ACCESS_KEY'],\n      :secret_access_key =&gt; ENV['SECRET_KEY']\n    }\n</code></pre>\n\n<p>I don't want to have size limitations, since it will hassle the user to resize his/her images.\nso, I put styles in for medium and thumb. \nHowever, the original file is still saved in s3.</p>\n\n<p>How do I avoid saving the original image?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13235716,"title":"Not null fields for ActiveAttr","body":"<p>I'm having issues enforcing a field to not be nil within <code>ActiveAttr::Model</code>.</p>\n\n<p>Is there an elegant way of enforcing this constraint within the model instead of defining it in the controller? Or am I testing incorrectly for the scenario?</p>\n\n<p>Model:</p>\n\n<pre><code>class Message\n  include ActiveAttr::Model\n\n  attribute :name, :presence =&gt; true, :allow_nil =&gt; false, :allow_blank =&gt; false\n  attribute :email, :presence =&gt; true\n  attribute :content, :presence =&gt; true\n\n  validates_format_of :email, :with =&gt; /^[-a-z0-9_+\\.]+\\@([-a-z0-9]+\\.)+[a-z0-9]{2,4}$/i\n  validates_length_of :content, :maximum =&gt; 500\nend\n</code></pre>\n\n<p>RSpec:</p>\n\n<pre><code>module MessageSpecHelper\n  def valid_message_attributes\n    {\n       :name =&gt; \"Walter White\",\n       :email =&gt; \"walter@hailtheking.com\",\n       :content =&gt; \"I am the one who knocks\"\n   }\n  end\nend\n\nit \"should have error on name (alternate with nil)\" do \n  @message.attributes = valid_message_attributes.except(:name =&gt; nil)\n  @message.should have(1).error_on(:name)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","will-paginate","google-books"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13235115,"title":"Pagination and Google Books API","body":"<p>I am working on a Ruby on Rails project, which uses Google Books API. I managed to implement a pagination with <a href=\"https://github.com/mislav/will_paginate\" rel=\"nofollow\">will_paginate gem</a>, but I have a small problem. Google always returns different value of totalItems, which is quite confusing, because I am using it to evaluate the total number of pages.</p>\n\n<p>After researching I have found that <a href=\"http://productforums.google.com/forum/#!topic/books-api/Y_uEJhohJCc\" rel=\"nofollow\">this is not a bug</a>.</p>\n\n<p>So my question is maybe are there other ways to implement pagination or to evaluate total number of pages?</p>\n"},{"tags":["ruby-on-rails-3","heroku","redmine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13234885,"title":"Heroku Error H10 (App crashed) - Install Redmine 2.1","body":"<p>Although read many articles about this problem, I still couldn't solve those error,\nHere is a part of the heroku logs, if it's less-information, I would update others code of the red mine source code.</p>\n\n<pre><code>2012-11-05T14:02:54+00:00 app[web.1]: Plugins in vendor/plugins (/app/vendor/plugins) are no longer allowed. Please, put your     Redmine plugins in the `plugins` directory at the root of your Redmine directory (/app/plugins)    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Booting WEBrick    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Rails 3.2.8 app    lication starting in production on http://0.0.0.0:40115    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Call with -d to     detach    \n2012-11-05T14:02:54+00:00 app[web.1]: =&gt; Ctrl-C to shutd    own ser    ver    \n2012-11-05T14:02:54+00:00 app[web.1]: Exiting    \n2012-11-05T14:02:55+00:00 heroku[web.1]: Proc    ess exited with status 1    \n2012-11-05T14:02:55+00:00 heroku[web.1]: Stat    e changed from starting to crashed    \n2012-11-05T14:02:56+00:00 heroku[router]: Err    or H10 (App crashed) -&gt; GET ceciit    s.herokuapp.com/ dyno= queue= wait= service=     status=503 bytes=    \n2012-11-05T14:06:    04+00:00 heroku[web.1]: State changed from crashed to down    \n2012-11-05T14:06:    04+00:00 heroku[web.1]: Unidling    \n2012-11-05T14:06:    04+00:00 heroku[web.1]: State ch    anged from down to starting    \n2012-11-05T14:06:    07+00:00 heroku[web.1]: Starting     process with command `bundle exec rails server -p 3103`    \n2012-11-05T14:06:    12+00:00 app[web.1]: Plugins in     ve    \nndor/plugins (/ap    p/vendor/plugins) are no longer     al    lowed. Please, put your Redmine plugins in the `plugins` directory at the         root of your Redm    ine directory (/app/plugins)    \n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Boot    ing WEBrick\n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Rail    s 3.2.8 application starting in production on http://0.0.0.0:3103\n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Call     with -d to detach\n2012-11-05T14:06:    12+00:00 app[web.1]: =&gt; Ctrl    -C to shutdown server\n2012-11-05T14:06:12+00:00 app[web.1]: Exiting    \n2012-11-05T14:06:13+00:00 heroku[web.1]: Process exited with status 1\n2012-11-05T14:06:13+00:00 heroku[web.1]: State changed from starting to crashed\n</code></pre>\n\n<p>I can't figure where is the reason that leads app crashed actually,\nThanks for answering...</p>\n"},{"tags":["ruby-on-rails-3","activeadmin"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12996790,"title":"Override html in active_admin gem","body":"<p>I wanna override html code when working with active_admin gem in Rails; because the nav-bar and many elements in these gem's views are different with my views (other pages). I hope that has a way to change html code without changing css manually! Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13232186,"title":"How to open new Rails window in sidebar","body":"<p>I am using Rails 3/Bootstrap/JQuery UI.\nI have a create action which requires the user to enter some parameters before submitting.\nI have tried a Javascript JQuery UI Dialog Modal Form, but that doesn't make use of the already-written action code.\nThe problem is that the user doesn't like having a completely new window open (and then having to hit Back)</p>\n\n<p>So I would like to open the action, but do so in a sidebar, rather than a new window.</p>\n\n<p>What is the best practice for this in Rails 3?</p>\n\n<p>Adding more clarification.\nThe \"action\" I meant is a modal dialog where I collect the parameters which are needed for the create.\nI would like to put that \"modal dialog\" into a sidebar.\nInstead, right now, I open the \"modal dialog\" as a completely new window, and then the user clicks Create, and the new object is created.</p>\n\n<p>I think my main question is - how do I open \"new window in a sidebar\"?</p>\n\n<p>Added edit:\nHere is the code for the button the user is going to push: (to add a Cat to an existing Client)</p>\n\n<pre><code>&lt;%= link_to \"New Cat\", new_client_cat_path(@client), :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>Now, here is cats/new.html.erb:</p>\n\n<pre><code>&lt;h2&gt;New Cat&lt;/h2&gt;\n&lt;%= render \"form\" %&gt;\n&lt;%= link_to \"Cancel\", @client, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n</code></pre>\n\n<p>and then here is cats/_form.html.erb:</p>\n\n<pre><code>&lt;%= form_for [@client, @cat] do |f| %&gt;\n&lt;%= f.error_messages %&gt;\n&lt;%= f.submit @submit_label, :class =&gt; \"btn btn-primary btn-large\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What I want is for \"new.html.erb\" - the form to get the user's OK - to pop up in a sidebar, as opposed to opening a brand new window. I want to be able to put the \"new.html.erb\" into a small box which is located on the main page.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","recurly"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13231115,"title":"Rails and Recurly credit card form not updating expiration month and year info","body":"<p>I was creating a form to interact with Recurly on Rails.</p>\n\n<p>I have this view and this form:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= t('payments.edit') %&gt; &lt;/h1&gt;\n\n\n&lt;%= render(:partial =&gt; 'shared/new_recurly_form', :locals =&gt; {:success_url =&gt; \"#{APP_URL}#{users_credit_card_path}\"}) %&gt;\n\n&lt;%= semantic_form_for current_user, :url =&gt; users_credit_card_path, :html =&gt; {:method =&gt; :put, :class =&gt; 'credit_card'} do |form| %&gt;\n\n    &lt;%= form.inputs do %&gt;\n      &lt;div class=\"field\"&gt;\n        &lt;%= form.label :name %&gt;\n        &lt;%= form.text_field :name %&gt;\n      &lt;/div&gt;  \n      &lt;div class=\"field\"&gt;\n        &lt;%= form.label :first_surname %&gt;\n        &lt;%= form.text_field :surnames %&gt;\n      &lt;/div&gt;  \n      &lt;div class=\"field\"&gt;\n          &lt;%= label_tag :number, \"Credit Card Number \" %&gt;\n          &lt;%= text_field_tag :number %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n          &lt;%= label_tag :verification_value, \"Security Code on Card (CVV)\" %&gt;\n          &lt;%= text_field_tag :verification_value %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :month, \"Expiration month\" %&gt;\n      &lt;%= select_month(Date.today, :use_month_numbers =&gt; true) %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :year, \"Expiration year\" %&gt;\n      &lt;%= select_year(Date.today, :start_year =&gt; Time.now.year, :end_year =&gt; Time.now.year + 20) %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n\n  &lt;%= form.buttons do %&gt;\n    &lt;%= form.commit_button  t('confirm') %&gt;\n  &lt;% end %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>and its respective controller, credit_card_controller.rb</p>\n\n<pre><code>class Users::CreditCardsController &lt; ApplicationController\n\n  skip_before_filter :check_deactivated_user\n  protect_from_forgery :except =&gt; :create\n\n  def create\n    update\n  end\n\n  def edit\n    @user = current_user\n    @price_plan = current_user.price_plans.active.first\n  end\n\n  def update\n    begin\n        update_new_recurly_subscription\n    rescue Exceptions::RecurlyAccountCreateInvalidAccountException =&gt; e\n        puts \"CreditCardsController Exceptions::RecurlyAccountCreateInvalidAccountException\"\n        puts e.message\n    rescue Recurly::Resource::NotFound =&gt; e\n        puts \"CreditCardsController Recurly::Resource::NotFound Creating new account for user\"  \n        puts e.message  \n        begin\n            create_new_recurly_account\n            create_new_recurly_subscription         \n        rescue Exceptions::RecurlyAccountCreateInvalidAccountException =&gt; e\n            puts \"CreditCardsController inside find Recurly::Resource::NotFound\"\n            puts e.message\n            update_new_recurly_account\n            create_new_recurly_subscription\n        end \n    end\n\n    account = update_account_billing_info\n    account.billing_info = {\n        :first_name         =&gt; current_user.name,\n        :last_name          =&gt; \"#{current_user.surnames}\",\n        :number             =&gt; params[:number],\n        :verification_value =&gt; params[:verification_value],\n        :month              =&gt; params[:month],\n        :year               =&gt; params[:year]\n    }\n    puts \"Users::CreditCardsController update Billing info: #{account.billing_info.inspect}\"\n    account.billing_info.save\n    if current_user.credit_card_store!(account.billing_info)\n      if current_user.is_debtor?\n        flash[:alert] = t('flash.price_plans.payed_after_unpay')\n        render :edit\n      else\n        flash[:alert] = t('flash.credit_card.update.success')\n        render :success\n      end\n\n    else\n      flash[:failure] = t('flash.credit_card.update.failure')\n      render :edit\n    end\n\n  end\n\nend\n</code></pre>\n\n<p>When I update the form, using the update function on the former controller, I am able to change the credit card number but I am not able to change the expiration month and the expiration year.</p>\n\n<p>What am I missing here? Why can I change the credit card number and not the month and the year interacting with Recurly?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13231357,"title":"Rails 3.2: multiple nested data from one model","body":"<p>How to create form and action for multiple nested attributes if:</p>\n\n<p>LineItem:</p>\n\n<pre><code>has_many :item_options, :dependent =&gt; :destroy\nhas_many :product_options, :through =&gt; :item_options\n</code></pre>\n\n<p>ProductOption:</p>\n\n<pre><code>belongs_to :product\nbelongs_to :option\nhas_many :item_options\nhas_many :line_items, :through =&gt; :item_options\n</code></pre>\n\n<p>ItemOption:</p>\n\n<pre><code>attr_accessible :line_item_id, :product_option_id  \nbelongs_to :line_item, :foreign_key =&gt; \"line_item_id\"\nbelongs_to :product_option,:foreign_key =&gt; \"product_option_id\"\n</code></pre>\n\n<p>When I'm creating new LineItem, I need to create new ItemOption(s). This is my form:</p>\n\n<pre><code>        &lt;%= form_for(LineItem.new) do |f| %&gt;\n        &lt;%= f.hidden_field :product_id, value: @product.id %&gt;\n        &lt;%= f.fields_for :item_options do |io| %&gt;\n            &lt;% @product.options.uniq.each do |o| %&gt;\n              &lt;%= o.name %&gt;: \n              &lt;%= io.collection_select :product_option_id, o.product_options.where(:product_id =&gt; @product.id), :id, :value %&gt;\n            &lt;% end %&gt;\n        &lt;%= f.submit %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>When I'm clicking on Add To Cart, I've get:</p>\n\n<p>ItemOption(#70296453751440) expected, got Array(#70296430421140)</p>\n\n<p>When Adding accepts_nested_attributes_for :item_options to LineItem, my selects not diplayed :(</p>\n\n<p>With </p>\n\n<pre><code>&lt;%= select_tag \"product_option_id\", options_from_collection_for_select(o.product_options.where(:product_id =&gt; @product.id), :id, :value) %&gt;\n#item_options not created:\nParameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"/WM5/MqPn1yCxjKWoJQmjfko2pR4RiYV0S2KeTTpA3w=\", \"line_item\"=&gt;{\"product_id\"=&gt;\"1\"}, \"product_option_id\"=&gt;\"5\", \"commit\"=&gt;\"add\"}\n</code></pre>\n\n<p>And last one, I've create action like this:</p>\n\n<pre><code>@line_item = LineItem.new(params[:line_item])\n@line_item.item_options.build \n....\n</code></pre>\n\n<p>Where am I wrong? :( I'm totally confused.\nps. similar question <a href=\"http://stackoverflow.com/questions/11199572/rails-3-2-has-many-through-form-submission\">Rails 3.2 has_many through form submission</a>\nThis is form:</p>\n\n<p><img src=\"http://habrastorage.org/storage2/117/b0b/c59/117b0bc59368fa5177efebce896c8670.png\"/></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13232568,"title":"Rails form not using explicit action","body":"<p>I'm a noob that's been struggling with this problem for longer than I care to admit.  I used to have a routing issue with my STI model, but now I think that's solved (thanks to SO).  </p>\n\n<p>My problem is once I update the form at : /kids/1/edit, instead of having the record saved, it seems to get the record again.  I know I'm missing something basic, yet after working the issue a long time the answer eludes me.  You can see I'm explicitly calling the kidupdate action with the form submission.</p>\n\n<p>thanks in advance.</p>\n\n<p>kidedit.html.erb</p>\n\n<pre><code>&lt;% provide(:title, \"Edit user\") %&gt; \n&lt;h1&gt;Update your profile&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span5 offset3\"&gt; \n    &lt;%= form_for(@kid, url: kidedit_path) do |f| %&gt;\n      &lt;#%= render 'shared/error_messages', object: f.object %&gt; \n\n      &lt;%= f.label :fname, \"First Name\" %&gt;\n      &lt;%= f.text_field :fname %&gt; \n\n      &lt;%= f.label :lname, \"Last Name\" %&gt;\n      &lt;%= f.text_field :lname %&gt; \n\n      &lt;%= f.label :email %&gt;\n      &lt;%= f.text_field :email %&gt; \n\n      &lt;%= f.label :type, \"Are you a Kid or Parent\" %&gt;\n      &lt;%= f.select :type, [['Kid','Kid'],['Parent','Parent']] %&gt;\n\n      &lt;%= f.label :password %&gt;\n      &lt;%= f.password_field :password %&gt;\n\n      &lt;%= f.label :password_confirmation, \"Confirmation\" %&gt;\n      &lt;%= f.password_field :password_confirmation %&gt;\n\n      &lt;%= f.submit \"Save changes\", class: \"btn btn-large btn-primary\", :controller =&gt; 'users', :action =&gt; 'kidupdate' %&gt;\n  &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>users_controller.rb</p>\n\n<pre><code>  def kidupdate\n\n    @kid = Kid.find(params[:id])\n    if @kid.update_attributes(params[:kid])\n      flash[:success] = \"Profile updated\"\n      sign_in @kid\n      redirect_to kidshow_path\n    else\n      render kidedit_path(@kid)\n    end\n  end\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Kidtunes::Application.routes.draw do\n\n  root to: 'static_pages#home'\n\n  match '/help',    to: 'static_pages#help'\n  match '/contact', to: 'static_pages#contact'\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout',  to: 'sessions#destroy', via: :delete\n\n  match 'kids/:id' =&gt; 'users#kidupdate', via: :put, :as =&gt; :kidupdate\n  match 'kids/:id' =&gt; 'users#kidshow', via: :get, :as =&gt; :kidshow\n  match 'kids/:id/edit' =&gt; 'users#kidedit', :as =&gt; :kidedit\n\n  resources :users\n  resources :sessions, only: [:new, :create, :destroy]\n</code></pre>\n\n<p>Here's what's in the server log:</p>\n\n<pre><code>Started PUT \"/kids/1/edit\" for 127.0.0.1 at 2012-11-05 07:52:28 -0500\nProcessing by UsersController#kidedit as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"T8RqFt9lxdbZU+1cOh2E5yu2CFbVRDGmRcj2XdDN1ZU=\", \"user\"=&gt;{\"fname\"=&gt;\"Dante\", \"lname\"=&gt;\"Refford\", \"email\"=&gt;\"drefford@example.com\", \"type\"=&gt;\"Kid\", \"password\"=&gt;\"[FILTERED]\", \"password_confirmation\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"Save changes\", \"id\"=&gt;\"1\"}\n  Kid Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"type\" IN ('Kid') AND \"users\".\"id\" = ? LIMIT 1  [[\"id\", \"1\"]]\n  Rendered users/kidedit.html.erb within layouts/application (4.1ms)\n  Rendered layouts/_shim.html.erb (0.0ms)\n  User Load (0.2ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"remember_token\" = '1RZr3qfB6QSh42_jQ9qNWQ' LIMIT 1\n  Rendered layouts/_header.html.erb (2.5ms)\n  Rendered layouts/_footer.html.erb (0.3ms)\nCompleted 200 OK in 67ms (Views: 46.3ms | ActiveRecord: 1.0ms)\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code>$rake routes\n       root        /                         static_pages#home\n       help        /help(.:format)           static_pages#help\n    contact        /contact(.:format)        static_pages#contact\n     signup        /signup(.:format)         users#new\n     signin        /signin(.:format)         sessions#new\n    signout DELETE /signout(.:format)        sessions#destroy\n  kidupdate PUT    /kids/:id(.:format)       users#kidupdate\n    kidshow GET    /kids/:id(.:format)       users#kidshow\n    kidedit        /kids/:id/edit(.:format)  users#kidedit\n      users GET    /users(.:format)          users#index\n            POST   /users(.:format)          users#create\n   new_user GET    /users/new(.:format)      users#new\n  edit_user GET    /users/:id/edit(.:format) users#edit\n       user GET    /users/:id(.:format)      users#show\n            PUT    /users/:id(.:format)      users#update\n            DELETE /users/:id(.:format)      users#destroy\n   sessions POST   /sessions(.:format)       sessions#create\nnew_session GET    /sessions/new(.:format)   sessions#new\n    session DELETE /sessions/:id(.:format)   sessions#destroy\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":99,"score":2,"question_id":10891275,"title":"Gem date_validator not working Ruby 1.9.3 Rails 3.2.1","body":"<p>I've just installed this gem with:</p>\n\n<pre><code>gem install 'date_validation'\n</code></pre>\n\n<p>And I can see it's properly installed, as it appears in the list when I use:</p>\n\n<pre><code>gem list\n</code></pre>\n\n<p>But when I try to validate the content of a field form as a date, I get this error:</p>\n\n<pre><code>ArgumentError in ProductesController#new\nUnknown validator: 'DateValidator'\n</code></pre>\n\n<p>I use this code to validate:</p>\n\n<pre><code>validates :data_caducitat, :date =&gt; { :after =&gt; Proc.new { Time.now } }\n</code></pre>\n\n<p>Any idea of what may be the problem?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13232001,"title":"how to modify devise to login user from terminal using different json?","body":"<p>I use  </p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/login.json  -d \"{\"user\" : { \"email\" : \"sample@gmail.com\", \"password\" : \"password\"}}\"\n</code></pre>\n\n<p>which gives the <code>token</code> and <code>email</code> id as output, but how can i get the same thing with</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/login.json  -d \"{ \"email\" : \"sample@gmail.com\", \"password\" : \"password\"}\"\n</code></pre>\n\n<p>how can i modify devise to get this working?</p>\n"},{"tags":["ajax","ruby-on-rails-3","image"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":18,"score":0,"question_id":13232540,"title":"Loading images with ajax (in rails)","body":"<p>Is there a way to either:</p>\n\n<p>load images via an ajax request </p>\n\n<p>or </p>\n\n<p>put a loading icon instead of where the image should be (or some other placeholder) until the image is fully loaded?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","full-text-search","railscasts"],"answer_count":5,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1698,"score":3,"question_id":8505837,"title":"How to use Elasticsearch on Heroku","body":"<p>I've just finished watching both Railscasts' episodes on <a href=\"http://www.elasticsearch.org/\" rel=\"nofollow\">Elasticsearch</a>. I've also went ahead and implemented it into my rails application (3.1) and everything is working great. How I want to deploy my app to Heroku but I'm unsure how to get Elasticsearch working on <a href=\"http://heroku.com/\" rel=\"nofollow\">Heroku</a> (specifically on a cedar stack). </p>\n\n<p>Any help would be greatly appreciated!</p>\n"},{"tags":["ruby","ruby-on-rails-3","datetime","form-validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13223142,"title":"rails date_select title as a value","body":"<p>I am using date_select like so</p>\n\n<pre><code>&lt;%= f.label :birthday %&gt;\n&lt;%= f.date_select :birthday , :order =&gt; [:month, :day, :year] ,:start_year =&gt; 1900, :end_year =&gt; Time.now.year-10 %&gt;\n</code></pre>\n\n<p>I want to have the very first options in each field to be \"day\" \"month\" and \"year\" and which won't be valid</p>\n\n<p>How do I add these values?</p>\n"},{"tags":["ruby-on-rails-3","gem","ascii","pdf-writer"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":662,"score":1,"question_id":9035666,"title":"pdf-writer invalid multibyte char (US-ASCII) expecting keyword_end content = \"%PDF-#{@version}\\n%âãÏÓ\\n\" Rails 3","body":"<p>I have a problem with the pdf-writer gem on a collaborative project I'm trying to run, I'm using <code>RVM</code>, <code>Ruby 1.9.2p180</code>, <code>Rails 3.1.0</code> on <code>Ubuntu 10.10</code>.</p>\n\n<p>I created a new <code>gemset</code> to install the required gems with Bundler, but when I try to run the app I get the fallowing error;</p>\n\n<pre><code>josethernandezc@DG965WH:~/Desktop/conest31$ rails s\n/home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:240:in `require': /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/pdf-writer-1.1.8/lib/pdf/writer.rb:712: invalid multibyte char (US-ASCII) (SyntaxError)\n/home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/pdf-writer-1.1.8/lib/pdf/writer.rb:712: invalid multibyte char (US-ASCII)\n/home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/pdf-writer-1.1.8/lib/pdf/writer.rb:712: syntax error, unexpected $end, expecting keyword_end\ncontent = \"%PDF-#{@version}\\n%âãÏÓ\\n\"\n                                ^\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:240:in `block in require'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:223:in `block in load_dependency'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:640:in `new_constants_in'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:223:in `load_dependency'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/activesupport-3.1.0/lib/active_support/dependencies.rb:240:in `require'\nfrom /home/josethernandezc/Desktop/conest31/config/application.rb:58:in `&lt;top (required)&gt;'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:52:in `require'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:52:in `block in &lt;top (required)&gt;'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:49:in `tap'\nfrom /home/josethernandezc/.rvm/gems/ruby-1.9.2-p180@conest31/gems/railties-3.1.0/lib/rails/commands.rb:49:in `&lt;top (required)&gt;'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>The problem is in the <code>pdf-writer-1.1.8/lib/pdf/writer.rb:712</code>, especifically; <code>content = \"%PDF-#{@version}\\n%âãÏÓ\\n\"</code></p>\n\n<p>Any suggestions would be great, I tried to Google the error but I have not found anything specific to pdf-writer....</p>\n"},{"tags":["ruby-on-rails-3","flash","swf"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13230565,"title":"How do I embed sfw file in Rails 3 app using swf_fu?","body":"<p>I'm currently developing a Rails 3.2.3 app and I've been given some flash components that the client wants to the site (not my idea). I'm trying to embed them using \n<a href=\"https://github.com/marcandre/swf_fu\" rel=\"nofollow\">swf_fu</a> 2.0.3. I've included the gem and added </p>\n\n<pre><code>\\\\= require swf_fu\n</code></pre>\n\n<p>to my application.js file. </p>\n\n<p>My .swf files are at app/assets/swfs/foo.swf</p>\n\n<p>and then I try to embed the .swf with </p>\n\n<pre><code>&lt;%=  swf_tag \"swfs/foo\", :size =&gt; \"450x200\", :div_id =&gt; \"bar\" %&gt;\n\n&lt;div id=\"bar\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>I see Rails generating the following js</p>\n\n<pre><code>//&lt;![CDATA[\nswfobject.embedSWF('/assets/swfs/foo.swf', 'swfs/foo', '450', '200', '9.0.0', '/assets/expressInstall.swf', null, null, null, null);\n//]]&gt;\n</code></pre>\n\n<p>But other than that the page is blank. Any help will be greatly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","activerecord","select","model","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":9935259,"title":"Rails 3 + ActiveRecord - select with condition for association","body":"<p>I have <code>Car</code> (table <code>cars</code>) method that <code>has_many</code> owners (table <code>owners</code>). How can I choose all cars, that has no owners (== in the table <code>owners</code> is no one row with respective car's ID)?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":28,"score":0,"question_id":13229191,"title":"Ruby on Rails methods","body":"<p>I an looking to delve a little deeper into Ruby On Rails and am interested in seeking more knowledge when it comes to methods. I am aware of the rails api documentation, but not being familiar with a lot of the terminology or where the specific methods can be used it is to big to be useful at this stage (hope that makes sense).</p>\n\n<p>What I was looking for is any particular methods I should pay attention too, more like most commonly used, just so I can practice with them for now, then once I have grasped a better understanding then i can look at more.</p>\n\n<p>Any resources or documentation that has helped anyone, please feel free to let me know</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","facebook","devise","omniauth","koala"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1313,"score":6,"question_id":6127305,"title":"Getting SSL Error Using Koala with Devise & OmniAuth in a Rails 3 App","body":"<p>I'm building a Rails 3 app using Devise/OmniAuth, and Koala and I'm getting the following SSL error:</p>\n\n<pre><code>OpenSSL::SSL::SSLError in Users/omniauth callbacksController#facebook\nSSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed\n</code></pre>\n\n<p>The code that causes this error is:</p>\n\n<pre><code>@graph = Koala::Facebook::GraphAPI.new(@token)\n@friends = @graph.get_connections(\"me\", \"friends\")\n</code></pre>\n\n<p>I am using Devise with OmniAuth to perform authentication, which works.  I then take the returned facebook token, and attempt to use it with Koala as shown above.  That is what causes this error.</p>\n\n<p>It's probably worth noting that I was receiving the same error with Devise &amp; OmniAuth initially. There are a few topics about this error, and I was able to solve it, by setting up my config/initialisers/devise.rb with,</p>\n\n<pre><code>config.omniauth :facebook, APPID, APPKEY, {:client_options =&gt; {:ssl =&gt; {:ca_file =&gt;  \"/opt/local/share/curl/curl-ca-bundle.crt\"}}} \n</code></pre>\n\n<p>I am guessing that I need to supply a similar configuration for Koala so that it knows where to retrieve the local ca_file.  I can't find any indication of how to do so in the documentation though.  Any ideas on how to do this, or how to avoid the error in general?</p>\n\n<p>My dev environment is OSX.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13228604,"title":"Rails LEFT OUTER JOIN to load multiple models","body":"<p>I have a model called Entry that has_many :entry_states. EntryState has an attribute called :read.</p>\n\n<p>I want to get all entries whether or not there is an entry_state so I think a LEFT OUTER JOIN is the best way to go see <a href=\"http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html\" rel=\"nofollow\">Left outer join on Coding Horror</a></p>\n\n<p>However I also want to include an attribute of EntryState in the result. So I have a query that looks like:</p>\n\n<pre><code>entries = Entry.select('entries.*, entry_states.read').\njoins(\"LEFT OUTER JOIN entry_states ON entries.id = entry_states.entry_id AND entry_states.user_id = #{user_id}\")\n</code></pre>\n\n<p>The problem with this is the entry_states object is not available after this.</p>\n\n<p>I can get the read state like:</p>\n\n<pre><code>entries.first.read\n&gt;&gt; t\n</code></pre>\n\n<p>Which gives me the raw column value, but this is a boolean column so it would be great to get back <code>true</code> or <code>false</code></p>\n\n<p>What would be even better is if I could get the whole EntryState object. I've tried using .includes(:entry_state), but I have not found a way to include the outer join condition of <code>AND entry_states.user_id = #{user_id}</code></p>\n"},{"tags":["css","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13222828,"title":"Rendering instance variables in the view -rails 3","body":"<p>I am trying to figure out how to render the same view for each instance of my class when outputting to the view</p>\n\n<p>heres my example</p>\n\n<p>I have an app where you can record your own recipes and in an area called \"my recipes\" view all recipes entered. So far I can render the view for one instance in the style i want it presented</p>\n\n<pre><code> &lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n   &lt;ul class=\"thumbnails\"&gt;\n    &lt;li class=\"span4\"&gt;\n     &lt;div class=\"thumbnail\"&gt;\n     &lt;% @recipes.each do |r| %&gt;\n      &lt;%= image_tag r.avatar.url(:medium)%&gt;\n      &lt;h3 class=\"center\"&gt;&lt;a href=\"#\"&gt;&lt;%= r.dish_name %&gt;&lt;/a&gt;&lt;/h3&gt;\n      &lt;p&gt;Description of dish&lt;/p&gt;\n   &lt;/div&gt;\n  &lt;/li&gt;\n  &lt;% end %&gt;\n  &lt;/ul&gt;    \n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In my controller I have this</p>\n\n<pre><code>  def my_recipes\n\n @recipes = current_user.recipes if current_user.recipes #show recipes if the user has  any recipes\n\n end\n</code></pre>\n\n<p>How do i get every instance to render in the same view, ie as i have specified above/ Sure this is simple but cannot figure this out tonight</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","whenever"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13227855,"title":"Using whenever gem to schedule a cron job","body":"<p>I'm testing whenever to figure out how to use it and am running into trouble even after reading the Github documentation.</p>\n\n<p>I simply want to update the attributes of my model like this (config/schedule.rb)</p>\n\n<p>set :output \"/log/today.log\"</p>\n\n<pre><code>every 10.seconds do\n  runner \"Example.update_all(sample: Time.now)\"\nend\n</code></pre>\n\n<p>I am neither seeing a log file nor seeing the model attributes updated.</p>\n\n<p>Is there anything I am not doing correctly?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":13114901,"title":"test popups with cucumber/capybara in Ruby on Rails","body":"<p>I am writing tests to test that both affirming and dismissing a conformation popup work. However, I get the error:</p>\n\n<pre><code>And I dismiss popup                                     # features/step_definitions/web_steps.rb:74\n  undefined method `switch_to' for #&lt;Capybara::RackTest::Browser:0xa6f0dec&gt; (NoMethodError)\n  ./features/step_definitions/web_steps.rb:75:in `/^I confirm popup$/'\n  features/add_session.feature:121:in `And I confirm popup'\n</code></pre>\n\n<p>when running my tests.</p>\n\n<p>The steps in my .features files look something like this:</p>\n\n<pre><code>And I press \"Delete\"\nAnd I confirm popup\n</code></pre>\n\n<p>Within web_steps.rb, I have the following defined:</p>\n\n<pre><code>When /^I confirm popup$/ do\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('OK')\n  page.driver.browser.switch_to.alert.accept\n  #popup.confirm \nend\n\nWhen /^I dismiss popup$/ do\n  page.driver.browser.switch_to.alert.dismiss\n  #page.evaluate_script('window.confirm = function() { return true; }')\n  #page.click('Cancel')\n  #popup.dismiss\nend\n</code></pre>\n\n<p>I am using the prickle gem which I have included as follows in my Gemfile:</p>\n\n<pre><code>group :test do\n  gem 'cucumber-rails'\n  gem 'prickle'\nend\n</code></pre>\n\n<p>And I added a couple lines to my Gemfile as outlined <a href=\"https://github.com/ExtractMethod/prickle#configuration\" rel=\"nofollow\">here</a> to include prickle. I initially had it as World do, like they show on the github page, but that was giving me errors since World was being used twice (the other time in the cucumber library). Here are the lines I added to my env.rb file:</p>\n\n<pre><code>require 'prickle/capybara'    # require\n\nmodule Prickle_helper\n  include Capybara::DSL\n  include Prickle::Capybara  # include  Prickle\nend\n\nWorld(Prickle_helper)\n</code></pre>\n\n<p>Any ideas as to what could be causing my errors? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13226328,"title":"Rails nested model creation not respecting validation constraints","body":"<p>I have a Customer model that has_many polymorphic Address objects, like so:</p>\n\n<p>Customer Model:</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  has_many :mailing_addresses, :as =&gt; :addressable, :class_name =&gt; 'Address', dependent =&gt; :destroy\n  accepts_nested_attributes_for :mailing_addresses\n\n\n  validates :mailing_addresses, :presence =&gt; true\n  validates_associated :mailing_addresses\nend\n</code></pre>\n\n<p>Address Model:</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :addressable, :polymorphic =&gt; true\n\n  validate  :validate_quota\n  private\n  def validate_quota\n    case addressable_type\n  when \"Customer\"\n    customer = Customer.find(addressable_id)\n    if customer.mailing_addresses.size &gt;= 3\n      puts \"Adding too many records\"\n      errors.add(:addressable, \"Too many records\")\n    end\n  end\nend\n</code></pre>\n\n<p>I am also using RSpec to test that the quota constraint is respected.  So this spec passes, for example:</p>\n\n<pre><code>it \"observes quota limit\" do\n  customer = FactoryGirl.create(:customer, :number_of_mailing_addresses =&gt; 3)\n  expect {\n    address = FactoryGirl.create(:mailing_address, :addressable =&gt; customer)\n  }.to raise_error\n  customer.mailing_addresses.count.should eq(3)\nend\n</code></pre>\n\n<p>Which is good.  However, this fails horribly:</p>\n\n<pre><code>it \"fails add if already 3 addresses\" do\n  customer = FactoryGirl.create(:customer, :number_of_mailing_addresses =&gt; 3)\n  expect {\n    customer.mailing_addresses.create( FactoryGirl.attributes_for(:mailing_address).except(:addressable) )            \n  }.to raise_error\nend\n</code></pre>\n\n<p>I can even see in the spec output that the Address validation is failing, but for some reason it doesn't raise an error in \"customer.mailing_addresses.create()\", nor does that failed validation prevent the 4th Address model from saving to the database.</p>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13226167,"title":"check Cookies are disabled or not in ruby on rails","body":"<p>I m developing web application using Ruby on Rails. I want to check whether cookies are enabled or not. If not then i m displaying an error message and user cant proceed further.</p>\n\n<p>====>>for this in application_controller i did this..\n    before_filter :cookies_required\n    def cookies_required\n        return true unless cookies[\"_no_app\"].blank?<br>\n        render :template => \"shared/cookies_required\", :layout => \"login\"\n    end</p>\n\n<p>====>>And the code in shared/cookies_required.html.erb is...</p>\n\n<pre><code>&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\"&gt;\n&lt;%= stylesheet_link_tag \"login.css\"%&gt;\n&lt;head&gt;\n    &lt;style type=\"text/css\"&gt;\n        body { background-color: #fff; color: #666; text-align: center; font-family: arial, sans-serif; }\n        div.dialog {\n            width: 25em;\n            padding: 0 4em;\n            margin: 4em auto 0 auto;\n            }\n        h1 { font-size: 100%; color: #f00; line-height: 1.5em; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;div class=\"dialog\"&gt;\n&lt;p&gt;&lt;font size=\"4\"&gt;Cookies are disabled. First enable it.&lt;/font&gt; &lt;/p&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>This code is working fynn... but problem is when the browser first loaded the page, displays error msg tht cookies are disabled, even if it is enabled...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12969435,"title":"Ruby delete_if multiple values - only first value being deleted","body":"<pre><code>words.delete_if do |x|\n  x == (\"a\"||\"for\"||\"to\"||\"and\")\nend\n</code></pre>\n\n<p><code>words</code> is an array with many words. My code is deleting \"a\" but not deleting \"for\", \"to\" or \"and\".</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3","fullcalendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13225617,"title":"FullCalendar, Time Zone Issues. Showing events at GMT +8","body":"<p>I have been facing this problem where full calendar shows my event at a time 8 hours later than the event data.\nI figured that it is due to my timezone.</p>\n\n<p>This is my trace message</p>\n\n<pre><code>Started GET \"/events?custom_param1=something&amp;custom_param2=somethingelse&amp;  start=1351958400&amp;end=1352563200&amp;   authenticity_token=XEXpcBRnQuEivJ2NWjR2+OZ+Uscypalxx+hqGTIiwZA=&amp;_=1352086291522\" for 127.0.0.1 at 2012-11-05 11:31:31 +0800\nProcessing by EventsController#index as JSON\n  Parameters: {\"custom_param1\"=&gt;\"something\", \"custom_param2\"=&gt;\"somethingelse\", \"start\"=&gt;\"1351958400\", \"end\"=&gt;\"1352563200\", \"authenticity_token\"=&gt;\"XEXpcBRnQuEivJ2NWjR2 OZ Uscypalxx hqGTIiwZA=\", \"_\"=&gt;\"1352086291522\"}\n  Event Load (0.5ms)  SELECT `events`.* FROM `events` WHERE (starts_at &gt; '2012-11-04T00:00:00+08:00') AND (ends_at &lt; '2012-11-11T00:00:00+08:00')\nCompleted 200 OK in 10ms (Views: 8.2ms | ActiveRecord: 0.5ms)\n</code></pre>\n\n<p>The problem here being the start time in Unix is Sat, 03 Nov 2012 16:00:00 GMT when I had set it to be 04 Nov 2012 0.00.00. </p>\n\n<p>Here are my codes</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  scope :before, lambda {|end_time| {:conditions =&gt; [\"ends_at &lt; ?\",   Event.format_date(end_time)] }}\n  scope :after, lambda {|start_time| {:conditions =&gt; [\"starts_at &gt; ?\", Event.format_date(start_time)] }}\n  def as_json(options = {})\n    {\n      :id =&gt; self.id,\n      :title =&gt; self.title,\n      :description =&gt; self.description || \"\",\n      :start =&gt; starts_at.rfc822,\n      :end =&gt; ends_at.rfc822,\n      :allDay =&gt; false,\n      :recurring =&gt; false,\n      :url =&gt; Rails.application.routes.url_helpers.event_path(id),\n      #:color =&gt; \"red\"\n    }\n\n  end\n\n  def self.format_date(date_time)\n    Time.at(date_time.to_i).to_time.iso8601\n  end\nend\n</code></pre>\n\n<p>changing ignoreTimeZone to true didn't work for me either.\nSo I would appreciate if someone could help me with it.</p>\n\n<p>Maybe something along the lines of parsing time?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":225,"score":2,"question_id":7210563,"title":"rake aborted! ERROR: must be owner of database","body":"<p>I am working through Michael Hartl's excellent <a href=\"http://ruby.railstutorial.org/chapters/modeling-and-viewing-users-one#sec%3auser_validations\" rel=\"nofollow\">tutorial</a> but when trying to prepare the test database with the command: \nbundle exec rake db:test:prepare\nI get this error message: </p>\n\n<p>ERROR:  must be owner of database sample_app_test...</p>\n\n<p>which I never got when using the development database, because I had created the following database role for my Rails app:</p>\n\n<p>CREATE ROLE demo_app WITH CREATEDB LOGIN</p>\n\n<p>(this is using Postgresql)</p>\n\n<p>Does anyone understand why this is failing in the test environment? \nTIA...</p>\n"},{"tags":["ruby-on-rails-3","sorting","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":349,"score":1,"question_id":12065592,"title":"Rails sorting associations with Ransack","body":"<p>first time poster. I am trying to sort a table of users using the Ransack gem and Kaminari for pagination. When I use name, id, etc. sorting works but when I try an association with posts_count, sorting breaks and won't work. Note: in the view, 'u.posts.count' work correctly. I have tried custom scopes in the users model, and creating custom objects for the search params but nothing seems to work. I think I am having trouble either in the default scope or the @search object not having the data. Need help!</p>\n\n<p>Here are some relevant snippets:</p>\n\n<p><strong>models/user.rb</strong></p>\n\n<pre><code>  has_many :posts, :dependent =&gt; :destroy \n</code></pre>\n\n<p><strong>models/post.rb</strong></p>\n\n<pre><code>  belongs_to :user \n\n  default_scope :order =&gt; 'post.created_at DESC'\n</code></pre>\n\n<p><strong>controllers/users_controller.rb</strong></p>\n\n<pre><code>  def index\n    @title = \"User Index\"\n    @search = User.search(params[:q]) # Ransack\n    @total_users = User.all.count\n    # .per(10) is the per page for pagination (Kaminari).\n    @users = @search.result.order(\"updated_at DESC\").page(params[:page]).per(10) #This displays the users that are in the search criteria, paginated.\n  end\n</code></pre>\n\n<p><strong>views/users/index.html.erb</strong></p>\n\n<pre><code>  ..\n  &lt;%= sort_link @search, :posts_count, \"No. of Posts\" %&gt; #Sort links at column headers\n  .. \n  &lt;% @users.each do |u| %&gt; #Display everything in the table\n    &lt;%= u.posts.count %&gt;\n  &lt;% end %&gt;\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13225523,"title":"jQuery AJAX POST to Rails Controller. Error when doing each_with_index (TypeError can't convert Symbol into Integer)","body":"<p>I'm trying to save the position of a jQuery-UI sortable connected list to a Rails backend. I'm having trouble with the Rails Controller action when trying to save the parameters to database.  The error that I am getting is <code>TypeError (can't convert Symbol into Integer):</code></p>\n\n<p>The parameter from the Ajax POST request that I'm sending in looks like this which looks fine:</p>\n\n<pre><code>Activity:[{\"id\":\"65\",\"column\":\"48\"},{\"id\":\"65\",\"column\":\"48\"},{\"id\":\"67\",\"column\":\"48\"}]\n</code></pre>\n\n<p>My Rails controller action is this (I'm trying to update an Activity with an id of 'id' and updating the attributes position with 'position' and day_id with 'column':</p>\n\n<pre><code>  def sort\n    JSON.parse(params[:Activity]).each_with_index do |x, index|\n      id = x[\"id\"]\n      position = index+1\n      column = x[\"column\"]\n      Activity.update_all(position = position, day_id = column, id = id)\n    end\n    render nothing: true\n  end\n</code></pre>\n\n<p>I'm getting this error in  Terminal:</p>\n\n<pre><code>    Started POST \"/trips/sort\" for 10.0.2.2 at 2012-11-04 23:52:30 +0000\nProcessing by TripsController#sort as */*\n  Parameters: {\"Activity\"=&gt;\"[{\\\"id\\\":\\\"66\\\",\\\"column\\\":\\\"49\\\"},{\\\"id\\\":\\\"66\\\",\\\"column\\\":\\\"49\\\"},{\\\"id\\\":\\\"67\\\",\\\"column\\\":\\\"49\\\"}]\"}\nCompleted 500 Internal Server Error in 1ms\n\nTypeError (can't convert Symbol into Integer):\n</code></pre>\n\n<p>This is my jQuery AJAX call if helpful:</p>\n\n<pre><code>    jQuery -&gt;\n  $('[id*=\"day\"]').sortable(\n    connectWith: \".day\"\n    placeholder: \"ui-state-highlight\"\n    update: (event, ui) -&gt;\n      neworder = new Array()\n      $(this).children().each -&gt;\n        column = $(this).parent().attr(\"id\").match(/\\d+/)[0]\n        id = $(this).attr(\"id\").match(/\\d+/)[0]\n        neworder.push(\n          id: id\n          column: column\n        )\n      alert neworder\n      $.ajax\n        url: \"sort\"\n        type: \"POST\"\n        data: { Activity: JSON.stringify(neworder) }\n    ).disableSelection()\n</code></pre>\n\n<p>I've spent the past few hours on this and just can't figure it out.  I really appreciate the time and help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13225476,"title":"Controller method as placeholder","body":"<p>There's a controller method in Rails that I want to do nothing for now, so I write</p>\n\n<pre><code>def hide\nend\n</code></pre>\n\n<p>as a placeholder.</p>\n\n<p>There's a link on a page that invokes this controller. When I click on the link, it says</p>\n\n<pre><code>Missing template posts/hide with {:handlers=&gt;[:erb, :rjs, :builder, :rhtml, :rxml], :formats=&gt;[:html], :locale=&gt;[:en, :en]}\n</code></pre>\n\n<p>Is it possible to have a controller that really does nothing, and does not render any page (so the user can click on the link and nothing happens)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","imagemagick","paperclip","homebrew"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":37,"score":3,"question_id":13223973,"title":"Rails paperclip `is not recognized by the 'identify' command`","body":"<p>I am getting an error when trying to save a <code>png</code> to a model with a paperclip attachment.</p>\n\n<p>My <code>User</code> model:</p>\n\n<pre><code>class User &lt; ActieRecord::Base\n  attr_accessible :icon\n  has_attached_file :icon, :url =&gt; \"/system/users/icon/:hash.:extension\",\n    :hash_secret =&gt; \"superSecretHashSecret\",\n    :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\nend\n</code></pre>\n\n<p>Example of trying to set an icon:</p>\n\n<pre><code>u = User.last\nu.icon = open(Rails.root + \"spec/fixtures/files/example.png\")\nu.save\n</code></pre>\n\n<p>Example model error:</p>\n\n<pre><code>:icon =&gt; [\"/var/folders/43/810gn/T/example20121104-36855-1v7t136.png is not recognized by the 'identify' command.\"]\n</code></pre>\n\n<p>There are a number of people who have posted similar questions to this one, especially <a href=\"http://stackoverflow.com/questions/1996102/rails-paperclip-and-passenger-is-not-recognized-by-the-identify-command\">this one</a> but none of those solutions work for me.</p>\n\n<p>My command_path is set correctly:</p>\n\n<pre><code>O:~ $ which identify\n/usr/local/bin/identify\n</code></pre>\n\n<p>In <code>development.rb</code></p>\n\n<pre><code>Paperclip.options[:command_path] = \"/usr/local/bin/\"\n</code></pre>\n\n<p><strong>This still might be the problem though.</strong> \nWhen trying to use `identify directly I get the following error:</p>\n\n<pre><code>O:~ $ identify workspace/app/spec/fixtures/files/example.png \ndyld: Library not loaded: /usr/lib/libltdl.7.dylib\n  Referenced from: /usr/local/bin/identify\n  Reason: image not found\nTrace/BPT trap: 5\n</code></pre>\n\n<p><strong>Any suggestions as to what is going on here?</strong></p>\n\n<p>I have tried reinstalling ImageMagick</p>\n\n<pre><code>brew unlink imagemagick\nbrew install imagemagick\n</code></pre>\n\n<p>Others have recommended adding <code>Rmagick</code>. It is definitely not a requirement for using Paperclip and it also did not help.</p>\n\n<p>Another solution that has been suggested is removing the <code>:style</code> property. That isn't a solution though. I need to do the processing on the images.</p>\n\n<p>I have Paperclip working on another model in my project that handles documents that are not images/don't do any processing. So I know that it is probably related to that.</p>\n\n<p>Any other suggestions on how to address this problem?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13224854,"title":"Nested forms in rails for existing objects","body":"<p>In my app, I have a page where I want admin users to be able to update a particular characteristic of my \"Package\" model, which belongs to both the \"Order\" model and the \"Item\" model. It's a little complicated, but I basically want to present in a table all of the Packages belonging to a given Item, ordered in a particular way (that's what my packages_for_log method below does), with two blanks for updating the weight of the item. All the updates should ideally be submitted at once, with a single submit button at the bottom of the page. I've attempted a whole bunch of solutions, and my current one is below, but gives this error when I visit the page in my server:</p>\n\n<pre><code>undefined method `actual_lbs' for #&lt;ActionView::Helpers::FormBuilder:0x007ff67df6c9c8&gt;\n</code></pre>\n\n<p>The error's confusing to me, cause I was hoping that I was calling that method on the package instance, not a helper. Bit confused. At any rate, my code is below. The relevant section of the view:</p>\n\n<pre><code>&lt;% form_for(@item) do |a| %&gt;\n  &lt;% @item.packages_for_log.each do |p| %&gt;\n    &lt;%= a.fields_for p do |i| %&gt;\n     &lt;tr&gt;\n        &lt;td&gt;&lt;%= p.order.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= p.order.processed_notes %&gt;&lt;/td&gt;\n      &lt;% if p.order.user %&gt;\n        &lt;td&gt;&lt;%= \"#{p.order.user.name.first(3).upcase}-#{p.id}\" %&gt;&lt;/td&gt;\n      &lt;% else %&gt;\n        &lt;td&gt;&lt;%= p.order.id %&gt;&lt;/td&gt;\n      &lt;% end %&gt;\n        &lt;td&gt;\n          &lt;%= i.text_field :actual_lbs %&gt;\n        &lt;/td&gt;\n        &lt;td&gt;\n          &lt;%= i.text_field :actual_oz %&gt;\n        &lt;/td&gt;\n          &lt;%= i.hidden_field :true_weight, value: (i.actual_lbs + i.actual_oz/16) %&gt;\n     &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Relevant section of the package.rb model file:</p>\n\n<pre><code> attr_accessible :order_id, :price, :true_weight, :actual_lbs, :actual_oz\n attr_accessor :actual_lbs, :actual_oz  # These two are virtual attributes for the above calc\n</code></pre>\n\n<p>And I added resources :packages to my routes file. </p>\n\n<p>Any idea what I'm doing wrong? It's important to me that I loop through to create a table based on \"p\" and then edit that same \"p\" object. Just not sure how to do it. Pretty new to Rails.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13224248,"title":"How to use form builder to add attribute to form helpers in Rails?","body":"<p>I am trying to build a form builder in Rails that adds a <code>disabled</code> attribute to <code>text_field</code> and <code>select</code> helpers. This is the simplified version of my code:</p>\n\n<pre><code>class LabelFormBuilder &lt; ActionView::Helpers::FormBuilder  \n  %w[text_field select].each do |method_name|\n    define_method(method_name) do |name, *args|\n      super(name, :disabled =&gt; true, *args)\n    end  \n  end\nend\n</code></pre>\n\n<p>With <code>text_fields</code> the attribute gets added properly but with <code>selects</code> things get a bit trickier and I keep getting <code>undefined method merge for #&lt;Array:0x10b5229a0&gt;</code> errors.</p>\n\n<p>This is my view code (again simplified): </p>\n\n<pre><code>&lt;%= f.label :name %&gt;\n&lt;%= f.text_field :name %&gt;      # works!\n\n&lt;%= f.label :person %&gt;\n&lt;%= f.select(:person_id, current_user.person_names, :prompt =&gt; 'Please select...') %&gt;  # does not work!\n</code></pre>\n\n<p>How can I get line 4 of my class above to work on <code>select</code> helpers as well?</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13224208,"title":"Is there a way, using paperclip, to upload and attach images to an object after it has been created?","body":"<p>The tutorials I have been reading about using paperclip all include something like this </p>\n\n<pre><code>&lt;% form_for @product, :html =&gt; { :multipart =&gt; true } do |form| %&gt;\n  &lt;ol class=\"formList\"&gt;\n    &lt;!-- Other fields go here... --&gt;\n    &lt;li&gt;\n      &lt;%= form.label :photo, \"Photo\" %&gt;\n      &lt;%= form.file_field :photo %&gt;\n    &lt;li&gt;\n      &lt;%= form.submit \"Submit\" %&gt;\n    &lt;/li&gt;\n  &lt;/ol&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This seems to me like you need to upload a photo before you click submit. On my site, I want users to be able to create a product, then afterwards if they want to add a photo, click on an upload photo button in the product view. Then the uploaded photo would be added to the product. Is this possible using paperclip or anything else? or do I need to have a separate photo/image model and submit it through that?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13224176,"title":"Rails namespacing error?","body":"<p>I have this in my <code>config/routed.db</code>:</p>\n\n<pre><code>namespace :admin do\n  resources :users\n  resources :events\nend\n</code></pre>\n\n<p>I generated the <code>User</code> model by using the scaffolding Rails provides, then I simply generated a admin/admin controller by using Rails' <code>generate</code> and simply moved all the user-related stuff into the admin sub-directories inside the controllers/views/helpers. Yes, I did have to add <code>admin_</code> in a few places and inside the form partial I had to change the <code>form_for(@user)</code> to <code>form_for([:admin, @user])</code>. </p>\n\n<p>When I try to create a new user (this is when I <code>POST</code> the user data) I get the following error message:</p>\n\n<pre><code>undefined method `user_url' for #&lt;Admin::UsersController:0x13f408e0&gt;\n</code></pre>\n\n<p>The application-level trace shows that the error is raised here:</p>\n\n<pre><code>app/controllers/admin/users_controller.rb:47:in `create'\n</code></pre>\n\n<p>The line of code where this error is raised:</p>\n\n<pre><code>format.html { redirect_to @user, :notice =&gt; 'User was successfully created.' }\n</code></pre>\n\n<p>The above line is inside the <code>respond_to</code> block.</p>\n\n<p>So, I have two questions: </p>\n\n<ol>\n<li>How do I fix this issue?</li>\n<li>Is there a smarter, better, rails-way of doing this?</li>\n</ol>\n\n<hr>\n\n<p>Also, bonus points if you suggest I re-do this in the <em>smarter, better, rails-way</em>! Well, I will do that anyway! :D</p>\n\n<hr>\n\n<h2>Update</h2>\n\n<p>Oh, I almost forgot something that might be relevant! I also made <code>Admin::UsersController</code> inherit from <code>Admin::AdminController</code> (which normally in turn inherits from <code>ApplicationController</code>):</p>\n\n<p><code>Admin::UsersController &lt; Admin::AdminController</code></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13222720,"title":"How do I manually set error on a nested attribute in Rails 3?","body":"<p>How do I manually set error on a nested attribute in Rails 3?</p>\n\n<p>The following is some example model code that I tried and isn't working for me.</p>\n\n<pre><code>validate :matching_card_colors\n\nhas_many :cards\naccepts_nested_attributes_for :card\n\ndef matching_card_colors\n  color = nil\n  cards.each do |card|\n    if color.nil?\n      color = card.color\n    elsif card.color != color\n      card.errors.add :color, \"does not match other card colors\"\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13223482,"title":"How to \"exploit\" relationship data already stored in the database?","body":"<p>I am using Ruby on Rails v3.2.2. I have following model classes</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  has_many :regions, :foreign_key =&gt; 'country_id'\nend\n\nclass Region &lt; ActiveRecord::Base\n  belongs_to :country, :foreign_key =&gt; 'country_id'\n  has_many :cities, :foreign_key =&gt; 'region_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  belongs_to :region, :foreign_key =&gt; 'region_id'\nend\n</code></pre>\n\n<p>and <em>I would like to make a <code>City</code> <code>belongs_to :country</code></em>.</p>\n\n<p>I know that the simplest way to make that is to add a <code>country_id</code> database table column to the <code>City</code> database table and to state related ActiveRecord Associations, this way:</p>\n\n<pre><code>class Country &lt; ActiveRecord::Base\n  # ...\n  has_many :cities, :foreign_key =&gt; 'country_id'\nend\n\nclass City &lt; ActiveRecord::Base\n  # ...\n  belongs_to :country, :foreign_key =&gt; 'country_id'\nend\n</code></pre>\n\n<p>However, in order to store <em>less database data</em>, I think I may \"use\" the data already stored in the <code>Region</code> table <em>since a city belongs to a region which in turn belongs to a country (this implies that a city belongs to a country)</em> but, in this case, I have no idea on how to properly state ActiveRecord Associations for <code>City</code> and <code>Country</code> so to \"exploit\" mentioned relationship informations implicitly present \"through\" the <code>Region</code> model class.</p>\n\n<p>How should I proceed?</p>\n\n<hr>\n\n<p><em>Note</em>: I am \"forcing\" to state the <code>belongs_to :country</code> ActiveRecord Association in the <code>City</code> model class because I would like to use the RoR <a href=\"http://guides.rubyonrails.org/association_basics.html#belongs_to-counter_cache\" rel=\"nofollow\"><code>:counter_cache</code></a> feature (available <em>only</em> for <code>belongs_to</code> associations) in order to count cities present in a country.</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":10,"favorite_count":37,"up_vote_count":62,"down_vote_count":0,"view_count":13423,"score":62,"question_id":4820549,"title":"How to empty DB in heroku","body":"<p>Im working on a RoR3 webapp on heroku. How do I empty the database?</p>\n"},{"tags":["ruby-on-rails-3","gem","bluehost"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13220329,"title":"Could not find gem 'uglifier' in the current bundle","body":"<p>My simple web app runs ok on Windows 7. Now I am moving it to bluehost.</p>\n\n<p>Getting this error when starting the app:</p>\n\n<pre><code>ActionView::Template::Error (cannot load such file -- uglifier\n</code></pre>\n\n<p>Trying to resolve it I have run 'gem install uglifier' and seems to mostly work:</p>\n\n<pre><code>SSH# gem install uglifier\nSuccessfully installed uglifier-1.3.0\n1 gem installed\nInstalling ri documentation for uglifier-1.3.0...\nunable to convert \"\\xC2\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII  for README.md, skipping\nInstalling RDoc documentation for uglifier-1.3.0...\nunable to convert \"\\xC2\" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.md, skipping\n</code></pre>\n\n<p>But when I try to locate the gem, it is not found:</p>\n\n<pre><code>bundle show uglifier\n</code></pre>\n\n<p>yields:\n    Could not find gem 'uglifier' in the current bundle</p>\n\n<p>Gemfile includes the following:</p>\n\n<pre><code>group :assets do\n  gem 'therubyracer'\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n</code></pre>\n\n<p>and Gemfile.lock shows that the uglifier gem is installed:</p>\n\n<pre><code>uglifier (1.3.0)\n</code></pre>\n\n<p>$PATH information:</p>\n\n<pre><code>/usr/local/jdk/bin:/home4/mychairs/perl5/bin:/usr/lib64/qt-3.3/bin:/home4/mychairs/perl5/bin:/ramdisk/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11R6/bin:/home4/mychairs/ruby/gems/bin:/home4/mychairs/ruby/gems:/home4/mychairs/bin\n</code></pre>\n"},{"tags":["ruby-on-rails-3","multi-tenant"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13223780,"title":"Multitenancy with scopes – should join tables have tenant_id column?","body":"<p>I'm developing a SaaS using multitenancy with scopes, following this <a href=\"http://railscasts.com/episodes/388-multitenancy-with-scopes\" rel=\"nofollow\">Railscasts</a> (<a href=\"https://github.com/railscasts/388-multitenancy-with-scopes/tree/master/forum-after/\" rel=\"nofollow\">soure code here</a>).</p>\n\n<p>The idea of this approach is adding a tenant_id column to every table for every model and then scope every model as follows:</p>\n\n<pre><code>default_scope { where(despacho_id: Tenant.current_id) }\n</code></pre>\n\n<p>So far, so good. My question now is: <strong>should the join tables for a has_and_belongs_to_many relationship have a tenant_id column?</strong></p>\n\n<p>Since those tables don't have models associated I can't uses scopes with them. However in most articles I've read about single/shared schema multi-tenant apps they always mention that a tenant_id column needs to be added to every table.</p>\n\n<p>Thank you in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","debugging","rack"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1262,"score":4,"question_id":7352635,"title":"Is there any debug toolbar for Rails 3.x","body":"<p>I used <a href=\"https://github.com/brynary/rack-bug\" rel=\"nofollow\">Rack::Bug</a> more than one year ago, now I'd like to use it with a new Rails 3.1 project. I tried to install it, both the master and rails3 branches, but with no luck.</p>\n\n<p>Also tried <a href=\"https://github.com/brynary/rack-bug/network\" rel=\"nofollow\">some github forks</a> but they did not work either.</p>\n\n<p>Is there any alternative with the same features?</p>\n\n<p>P.S. I already know newrelic and its <a href=\"https://support.newrelic.com/help/kb/ruby/developer-mode\" rel=\"nofollow\">developer mode</a>, just looking for something else, more similar to Rack::Bug</p>\n\n<p>Here is a little screen shoot of what is capable of (the green toolbar with debugging informations)</p>\n\n<p><img src=\"http://i.stack.imgur.com/QWSZ2.jpg\" alt=\"rack bub\"></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13222769,"title":"Not able to remove attachment","body":"<p>Looks like it's a known issue but i'm not able to find any solution nor any dirty fix to make it working. The thing is i'm not able to remove attachments uploaded using Carrierwave plugin. </p>\n\n<p>I'm using a special form field called <code>:remove_avatar</code> which should remove a avatar file and clear avatar column but the only thing it does is deleting the file, the file reference in avatar column still exists.</p>\n\n<p>I was trying to remove it in any possible way but without a luck. </p>\n\n<h3>update_attributes</h3>\n\n<p>using <code>u.update_attributes( :avatar =&gt; \"\" )</code> is not removing the reference</p>\n\n<h3>save()</h3>\n\n<pre><code>u = User.find(int)\nu.avatar = \"\"\nu.save\n</code></pre>\n\n<p>is also not removing the reference</p>\n\n<h3>remove_avatar = true</h3>\n\n<pre><code>u.remove_avatar = true\nu.save\n</code></pre>\n\n<p>not working</p>\n\n<h3>remove_avatar!</h3>\n\n<pre><code>u.remove_avatar!\nu.save\n</code></pre>\n\n<p>not working</p>\n\n<h3>f.check_box :remove_avatar</h3>\n\n<p>not working</p>\n\n<p>By 'not working' i mean that the file is removed from filesystem but the reference persists.</p>\n\n<p>Cany you please provide me ANY tip i can use to make it working again? It can be something dirty, this bug shown a day before my deadline and i feel quite desperate. Thanks in advance.</p>\n\n<p>Ruby: 1.8.7<br>\nRails: 3.2.6<br>\nCarrierwave: master branch from git repo</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13223089,"title":"Specify folder for download","body":"<p>In my Rails controller I have the line</p>\n\n<pre><code>send_file(\"#{Rails.root}/test/image.png\")\n</code></pre>\n\n<p>I'd like my web page to have a textbox, that the user can fill in a directory such as <code>C:/OldPictures/All/</code>, and then when the user clicks a link which invokes the controller, it also reads the directory in the textbox, and downloads the file <code>image.png</code> to the specified directory. Can I make it so?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","session","authlogic","session-fixation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":140,"score":4,"question_id":12263152,"title":"Rails 3 with Authlogic and calling reset_session","body":"<p>The <a href=\"http://guides.rubyonrails.org/security.html#session-fixation-countermeasures\" rel=\"nofollow\">RoR Security Guide</a> states that you should \"issue a new session identifier and declare the old one invalid after a successful login\" using the reset_session method to counter session fixation.</p>\n\n<p>I haven't been able to find any guidance on calling reset_session when using Authlogic. Is it simply a case of including the method in the controller method (as below)? </p>\n\n<p>I'm just concerned about causing problems for Authlogic as I can see both user_credentials and user_credentials_id keys and values in the session hash prior to calling reset_session.</p>\n\n<pre><code>class UserSessionsController &lt; ApplicationController\n\n  def create\n    @user_session = current_client.user_sessions.new(params[:user_session])\n    if @user_session.save\n      reset_session\n      flash[:success] = I18n.t(:msg_login_success)\n      redirect_back_or_default application_root_path\n    else\n      render :action =&gt; :new\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","padrino"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":11542840,"title":"From Padrino to Rails 3.2 - skinny controllers","body":"<p>I'm slightly lost in Rails 3.2. I've used to create skinny controllers in Padrino using methods like this:</p>\n\n<pre><code> 15   post :task, :provides =&gt; :js do\n 16     result = execute(params)\n 17     render \"home/task\"\n 18   end\n</code></pre>\n\n<p>Some methods does not exactly interacts with a model. In Rails 3.2, I cannot use helpers in controllers to make them clean (like Rails 2.x or Padrino). I've created a few methods like this one:</p>\n\n<pre><code> 10   def show                                                                                                                                               \n 11     @server = server_details                                                                                                                             \n 12     respond_with(@server) if request_match_server_address?                                                                                               \n 13   end     \n</code></pre>\n\n<p>But moved code from ServersController to ApplicationController, assuming it will be temporarily, and now application_controller is ugly and biggger (sure with three g's). </p>\n\n<p>How can I make my controllers beauty? Where is the right place to put methods like server_details?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":24,"score":0,"question_id":13222685,"title":"Browse folder when downloading file","body":"<p>On my webpage, I have a link which, when clicked, invokes a Rails controller </p>\n\n<pre><code>send_file(\"#{Rails.root}/test/image.png\")\n</code></pre>\n\n<p>When I click on the link, it automatically downloads <code>image.png</code> into my Download folder. What I'd like instead is that it shows a pop-up \"Save File\" that allows me to browse the folders on my computer and choose where to save <code>image.png</code>. How can I do that?</p>\n"},{"tags":["regex","ruby-on-rails-3","routes","syntax-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13222382,"title":"Rails custom route with constraints - regexp anchor characters are not allowed in routing requirements","body":"<p>I have the following route:</p>\n\n<pre><code>  get 'users/:user_id/:name', to: 'profiles#show',\n    :constraints =&gt; { :name =&gt; /[a-zA-Z0-9_]+$/ }, as: 'user_profile'\n</code></pre>\n\n<p>Which produces the error:</p>\n\n<pre><code>Regexp anchor characters are not allowed in routing requirements: /[a-zA-Z0-9_]+$/\n</code></pre>\n\n<p>So I get that the ^ character isn't allowed, but not sure what character is producing this particular routing error.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13222142,"title":"Argument of send_file","body":"<p>I put this in my Rails controller</p>\n\n<pre><code>send_file('/public/images/rails.png')\n</code></pre>\n\n<p>but it gives error</p>\n\n<pre><code>Cannot read file /public/images/rails.png\n</code></pre>\n\n<p>even though the file is there. How can I fix it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rack","amazon-cloudfront","rack-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13155335,"title":"Bypass Rack::Cache for requests coming from a CDN","body":"<p>I have a Rails 3.2 app, deployed to heroku.  I use caching with <a href=\"https://github.com/rtomayko/rack-cache/\" rel=\"nofollow\">Rack::Cache</a> and Amazon CloudFront.</p>\n\n<p>For Requests that are served via CloudFront (assets, mostly), the caching layer with Rack::Cache is redundant and I'd rather not use it there (memcached on heroku is <em>expensive</em>)</p>\n\n<p>What is a good way to skip Rack::Cache for these requests?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","squeel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13177615,"title":"ruby on rails join conditions (with squeel)","body":"<p>I'm trying to use Squeel to compare attributes among the joined tables along with a little math.</p>\n\n<p>Here's an example of the query:</p>\n\n<pre><code>Parent.joins{[child1, child2.grandchildren]}.\nwhere{grandchildren.birth_datetime &gt; Time.now - child1.age.years}\n</code></pre>\n\n<p>I get an error from Squeel saying \"TypeError: can't convert Squeel::Nodes::KeyPath into an exact number\"</p>\n\n<p>Anyone know what I'm doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13221357,"title":"Create a controller and view","body":"<p>Hello I have the following models.</p>\n\n<p>The User Model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :email, :password, :password_confirmation\n  has_one :user_informations\n  has_secure_password\nend\n</code></pre>\n\n<p>The UserInformation Model:</p>\n\n<pre><code>class UserInformation &lt; ActiveRecord::Base\n  belongs_to :user\n  attr_accessible :address, :address2, :business, :descripcion, :identification_number, :mobile_cell, :name, :phone_number\nend\n</code></pre>\n\n<p>Now I need to create the view and the controller to create and update the user information, and I have many questions:</p>\n\n<p>1) how can I generate the controller:</p>\n\n<blockquote>\n  <p>rails g controller UserInformations</p>\n</blockquote>\n\n<p>o </p>\n\n<blockquote>\n  <p>rails g controller UserInformation</p>\n</blockquote>\n\n<p>2) how my new, create and update action know the user ID.</p>\n\n<p>3) how can I set the routes for this user information</p>\n\n<p>Thanks. Maybe these are a basic question, but I'm new in rails and I don't know how to do all of this.</p>\n\n<p>Thanks again for your help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","rails-postgresql"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13214494,"title":"PostgreSQL Error for Select Distinct in Rails","body":"<p>On Mysql it works correctly.</p>\n\n<blockquote>\n  <p>PG::Error: ERROR: for SELECT DISTINCT, ORDER BY expressions must\n  appear in select list LINE 1: ) ORDER BY\n  programs.rating DESC, program_sc... ^ :</p>\n</blockquote>\n\n<p>Query:</p>\n\n<blockquote>\n  <p>SELECT DISTINCT \"programs\".* FROM \"programs\" INNER JOIN\n  \"program_schedules\" ON \"program_schedules\".\"program_id\" =\n  \"programs\".\"id\" WHERE (programs.rating >= 5 AND\n  program_schedules.start >= '2012-11-03 23:14:43.457659') AND (ptype =\n  'movie') ORDER BY programs.rating DESC,\n  program_schedules.start DESC</p>\n</blockquote>\n\n<p>Rails code:</p>\n\n<blockquote>\n  <p>@data =\n  Program.joins(:program_schedules).where('programs.rating >= ?\n  AND program_schedules.start >= ?',5,\n  Time.now).order('programs.rating DESC,\n  program_schedules.start DESC').uniq</p>\n</blockquote>\n\n<p>I have tried with</p>\n\n<blockquote>\n  <p>Program.select(\"programs.*,\n  program_schedules.*).joins(:program_schedules).where(...</p>\n</blockquote>\n\n<p>but, in this way, when I'm going to read </p>\n\n<blockquote>\n  <p>@data.program_schedules</p>\n</blockquote>\n\n<p>I get a nil value (When I know there are no nil values)</p>\n\n<h2>PostgreSQL 9.2 (Heroku), Ruby 1.9.2</h2>\n\n<p>Some info about my DB:</p>\n\n<pre><code>class Program &lt; ActiveRecord::Base\n   has_many :program_schedules\nend\n\n\nclass ProgramSchedule &lt; ActiveRecord::Base\n  belongs_to :program\nend\n</code></pre>\n\n<p>Schema.db</p>\n\n<pre><code> create_table \"program_schedules\", :force =&gt; true do |t|\n        t.integer  \"program_id\"\n        t.datetime \"start\"\n  end\n\n  create_table \"programs\", :force =&gt; true do |t|\n    t.string  \"title\",\n    t.string  \"ptype\"\n  end\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI don't need to order \"programs_schedules\" because I need all programs_schedules in my array related to that program.</p>\n"},{"tags":["ruby-on-rails-3","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":198,"score":0,"question_id":11351041,"title":"Sprockets::CircularDependencyError application.js has already been required","body":"<p>In my application, I receive a Sprockets::CircularDependencyError application.js has already been required. This affects every page in my application because none of the JS loads. Note - this error occurred after a fairly complex merge. </p>\n\n<p>My assumption (please correct me if I'm wrong) is that this error occurs because two different files require application.js. If so, in which files should I look to debug this error? How could I test my application to determine what files are already requiring application.js?</p>\n\n<p>Thank you very much for any help. I'd be more than happy to supply any pertinent information. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13219315,"title":"How to disable all form_for input fields in Ruby on Rails app?","body":"<p>I am trying to DRY up my Rails application a bit, so I would like to render a form in my <code>show</code> view but <em>disable</em> all input fields.</p>\n\n<pre><code>// show.html.erb\n\n&lt;%= form_for(@project) do |f| %&gt;\n  &lt;%= render 'fields', :f =&gt; f %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What would be the best way to do that?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails-3","devise","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13220218,"title":"Paperclip working on sign_out via devise","body":"<p>I've recently added paperclip to add avatar to the users.</p>\n\n<p>When a user sign out (using devise) I see this in the logs</p>\n\n<pre><code>Started DELETE \"/signout\" for 127.0.0.1 at 2012-11-04 17:23:15 +0200\nProcessing by Devise::SessionsController#destroy as HTML   Parameters:\n{\"authenticity_token\"=&gt;\"rHNBynyk546DcWTpGuARt2bdbSTtKPbw2ls+nDaihO8=\"}\nUser Load (1.0ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"id\" =\n18 LIMIT 1    (0.0ms)  BEGIN [paperclip] Saving attachments.   \n(0.0ms)  COMMIT Redirected to http://localhost:3000/\n</code></pre>\n\n<p>my paperclip is really basic..</p>\n\n<p>this in user.rb</p>\n\n<pre><code>has_attached_file :avatar,\n    :storage =&gt; :s3,\n    :bucket =&gt; ENV['BUCKET'],\n    :s3_credentials =&gt; {\n      :access_key_id =&gt; ENV['ACCESS_KEY'],\n      :secret_access_key =&gt; ENV['SECRET_KEY']\n    }\n</code></pre>\n\n<p>on user/_form.html.erb</p>\n\n<pre><code>&lt;%= f.file_field :avatar %&gt;\n</code></pre>\n\n<p>and on users/show.html.erb</p>\n\n<pre><code>&lt;%= image_tag @user.avatar.url %&gt;\n</code></pre>\n\n<p>what is paperclip doing there?\nIs there a way to debug this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":2,"view_count":85,"score":1,"question_id":11189139,"title":"How to keep a transient variable as part of ActiveRecord","body":"<p>I would like to show a variable (which is actually a List) as part of f.select(..) function in Rails3.2, so that the selected value is stored in a different attribute in the ActiveRecord object. How do I declare the above List variable as a transient variable in ActiveRecord, so that ActiveRecord doesn't try to store this.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activesupport"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13218123,"title":"Activesupport titlecase() with bang (.titlecase!)?","body":"<p>I currently have a string with customer names that I am titlecasing with:</p>\n\n<pre><code>@customer_name = @customer_name.titlecase\n</code></pre>\n\n<p>But this seems a bit long-winded. When I try to do:</p>\n\n<pre><code>@customer_name.titlecase!\n</code></pre>\n\n<p>I get a no method error. Does <code>titlecase!</code> exist? It seems odd that there wouldn't be a way to do this, since there is a <code>downcase!</code>, for example.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13219184,"title":"Rails abstract ajax callbacks for resources","body":"<p>What I have are several js files for each of my resources using ajax:</p>\n\n<pre><code>create.js.erb\nshow.js.erb\nupdate.js.erb\ndestroy.js.erb\n</code></pre>\n\n<p>What I am trying to do is abstract this so I don't have these hooks in every single controller. The two ideas I can see:</p>\n\n<p>1) bind requests and place in master js file under <code>assets/javascripts</code>. I'd much prefer this method, but I'm stuck on how to bind these above actions.</p>\n\n<p>2) add these files under <code>views/shared/</code> and trigger them from within the controllers.</p>\n\n<p>What would be the preferred way of abstracting the above? </p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13218540,"title":"Rails abstract custom destroy method (or add exception to model errors by default)","body":"<p>What I am trying to do is return an error, instead of an exception, when a particular model cannot be destroyed. Currently, it raises <code>ActiveRecord::DeleteRestrictionError</code>, but that is not returned to a flash message, or added to the errors collection of the model. </p>\n\n<p>What I have done is setup this in my resourceful controller:</p>\n\n<pre><code>  def destroy\n    begin\n      resource.destroy\n    rescue ActiveRecord::DeleteRestrictionError =&gt; e\n      resource.errors.add(:base, e)\n    end\n  end\n</code></pre>\n\n<p>I'd rather not manage this within every single controller which requires this particular behavior. How can I abstract it? I can't see it being a good idea to overwrite the destroy method for <code>ActiveRecord::Base</code>, but maybe there won't be any gotchas?</p>\n\n<p>I'm using inherited_resources gem, so perhaps there is a way to answer this by extending that?</p>\n\n<p>One other idea I had was to extend <code>ActiveRecord::Base</code> using <code>ActiveSupport::Concern</code> (from here: <a href=\"http://stackoverflow.com/questions/2328984/rails-extending-activerecordbase\">Rails extending ActiveRecord::Base</a>) and then delegate the destroy method to a custom destroy on a model-to-model basis. Thoughts?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","hash","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13218378,"title":"Getting the contents of a hash","body":"<pre><code>{\"test_url\"=&gt;\"http://test.com/123.jpg\"} \n</code></pre>\n\n<p>is my output from</p>\n\n<pre><code>&lt;% @results.each do |t| %&gt;\n    &lt;%= t.image.extract!(\"test_url\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How can i just get the contents of test_url? so <a href=\"http://test.com/123.jpg\" rel=\"nofollow\">http://test.com/123.jpg</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":561,"score":1,"question_id":8047651,"title":"No Javascript runtime on windows when running rails server","body":"<p>I'm completely new to Ruby on Rails, and I'm having trouble setting it up on my <strong>Windows PC</strong>.  I have successfully followed the instructions on <a href=\"http://rubyonrails.org/download\" rel=\"nofollow\">http://rubyonrails.org/download</a>.  However, when I go to run the <code>rails server</code> command I come up with this output:</p>\n\n<pre><code>C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs/runtimes.rb:47:in `a\nutodetect': Could not find a JavaScript runtime. See https://github.com/sstephen\nson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:5:in\n `&lt;module:ExecJS&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/execjs-1.2.9/lib/execjs.rb:4:in\n `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-\nscript.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/coffee-rails-3.1.1/lib/coffee-r\nails.rb:1:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:68:in `block (2 levels) in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:66:in `block in require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `each'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler/runt\nime.rb:55:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.21/lib/bundler.rb:1\n22:in `require'\n        from C:/RoR/tickets/config/application.rb:7:in `&lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `require'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:52:in `block in &lt;top (required)&gt;'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `tap'\n        from C:/Ruby192/lib/ruby/gems/1.9.1/gems/railties-3.1.1/lib/rails/comman\nds.rb:49:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>When i go to the website <a href=\"https://github.com/sstephenson/execjs\" rel=\"nofollow\">https://github.com/sstephenson/execjs</a> I'm still uncertain of how to proceed.  <strong>Can someone point me in the right direction (remember I'm a newbie)?</strong>  Thanks!</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","node.js","ruby-on-rails-3.1"],"answer_count":5,"favorite_count":18,"up_vote_count":31,"down_vote_count":0,"view_count":13362,"score":31,"question_id":7092107,"title":"Rails 3.1 error - Could not find a JavaScript runtime?","body":"<p>I created a new Rails project using <code>rails 3.1.0.rc4</code> on my local machine but when I try to start the server I get:\nCould not find a JavaScript runtime. See <a href=\"https://github.com/sstephenson/execjs\">here</a> for a list of available runtimes. (<code>ExecJS::RuntimeUnavailable</code>)</p>\n\n<p>Note: This is not about Heroku.</p>\n"},{"tags":["ruby-on-rails-3","ubuntu","undefined"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13218035,"title":"Undefined method `write_inheritable_attribute' for Rails","body":"<p>I work with ruby in ubuntu.<br>\nbut I have a problem when creating the project.</p>\n\n<pre><code>atmoner@atmoner:~$ rails new first_app\n/var/lib/gems/1.8/gems/rails-2.3.8/lib/rails_generator/options.rb:32:in `default_options': undefined method `write_inheritable_attribute' for Rails::Generator::Base:Class (NoMethodError)\n    from /var/lib/gems/1.8/gems/rails-2.3.8/lib/rails_generator/base.rb:90\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `require'\n    from /var/lib/gems/1.8/gems/rails-2.3.8/lib/rails_generator.rb:37\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require'\n    from /usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:36:in `require'\n    from /var/lib/gems/1.8/gems/rails-2.3.8/bin/rails:15\n    from /usr/local/bin/rails:19:in `load'\n    from /usr/local/bin/rails:19\n</code></pre>\n\n<p>Version of rails:</p>\n\n<pre><code>atmoner@atmoner:~$ rails -v\nRails 2.3.8\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code> sudo gem install rails\n</code></pre>\n\n<p>But problem is same! I am completely block</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","methods"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":61,"score":3,"question_id":9798237,"title":"What is the difference in \"Processing by Contoller#method as */*\" and \"Processing by BillsController#show as HTML\"","body":"<p>All of my rails 3.2.2 ActiveRecord methods are being executed twice. I noticed that each execution is being processed differently, see the examples I grabbed from the console below...</p>\n\n<pre><code>Started GET \"/api/bills/Jeremy%20Fox\" for 127.0.0.1 at 2012-03-20 23:16:43 -0400\nProcessing by BillsController#show as HTML\n  Parameters: {\"username\"=&gt;\"Jeremy Fox\"}\n  BillsForUsers Load (2.4ms)  SELECT \"bills_for_users\".* FROM \"bills_for_users\" WHERE \"bills_for_users\".\"billusername\" = 'Jeremy Fox'\nCompleted 200 OK in 47ms (Views: 11.2ms | ActiveRecord: 2.4ms)\n\n\nStarted GET \"/api/bills/Jeremy%20Fox\" for 127.0.0.1 at 2012-03-20 23:16:44 -0400\nProcessing by BillsController#show as */*\n  Parameters: {\"username\"=&gt;\"Jeremy Fox\"}\n  BillsForUsers Load (1.1ms)  SELECT \"bills_for_users\".* FROM \"bills_for_users\" WHERE \"bills_for_users\".\"billusername\" = 'Jeremy Fox'\nCompleted 200 OK in 33ms (Views: 28.1ms | ActiveRecord: 1.1ms)\n</code></pre>\n\n<p>Can anyone explain to me why all of my ActiveRecord methods are being executed twice and/or what the difference is between <code>Processing by BillsController#show as HTML</code> and <code>Processing by BillsController#show as */*</code>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","heroku","amazon-s3","carrierwave","fog"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":23,"score":2,"question_id":13217544,"title":"Fog S3 Upload leads to","body":"<p>I am developing a platform that allows merchants to upload a picture of their store. I am using Carrierwave+fog for this. As the app is hosted on heroku, the pictures will need to be stored on amazon s3. </p>\n\n<p>On my local machine, everything works fine if the storage is local, but things go wrong once fog handles the uploading.</p>\n\n<p>I will first post the local storage version (works fine), then my current fog-enabled s3 version together with the error that I am getting.</p>\n\n<p>Local storage version (works fine):</p>\n\n<pre><code># app/uploaders/picture_uploader.rb\nclass PictureUploader &lt; CarrierWave::Uploader::Base\n  storage :file\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n</code></pre>\n\n<p>Fog-enabled s3 version (doesn't work):</p>\n\n<pre><code># app/uploaders/picture_uploader.rb\nclass PictureUploader &lt; CarrierWave::Uploader::Base\n  storage :fog\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n\n# config/initializers/fog.rb\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',       # required\n    :aws_access_key_id      =&gt; 'xxxx',       # required\n    :aws_secret_access_key  =&gt; 'xxxx'       # required\n  }\n  config.fog_directory  = 'yyyy'                     # required\n  config.fog_public     = true                          # optional, defaults to true\nend\n</code></pre>\n\n<p>When I now create or edit a new store, the picture is actually successfully uploaded to s3, but rails gives an Permission denied error message (app/tmp/carrierwave/20121104-0929-5512-8270/04.png could not be accessed).</p>\n\n<p>Full Error Message:</p>\n\n<pre><code>C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1406:in `unlink'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1406:in `block in remove_file'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1414:in `platform_support'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:1405:in `remove_file'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:785:in `remove_file'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:563:in `block in rm'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:562:in `each'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/fileutils.rb:562:in `rm'\ncarrierwave (0.5.8) lib/carrierwave/sanitized_file.rb:217:in `delete'\ncarrierwave (0.5.8) lib/carrierwave/uploader/store.rb:60:in `block in store!'\ncarrierwave (0.5.8) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\ncarrierwave (0.5.8) lib/carrierwave/uploader/store.rb:58:in `store!'\ncarrierwave (0.5.8) lib/carrierwave/mount.rb:347:in `store!'\ncarrierwave (0.5.8) lib/carrierwave/mount.rb:217:in `store_bild!'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:401:in `_run_save_callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactiverecord (3.1.0) lib/active_record/callbacks.rb:264:in `create_or_update'\nactiverecord (3.1.0) lib/active_record/persistence.rb:37:in `save'\nactiverecord (3.1.0) lib/active_record/validations.rb:50:in `save'\nactiverecord (3.1.0) lib/active_record/attribute_methods/dirty.rb:22:in `save'\nactiverecord (3.1.0) lib/active_record/transactions.rb:241:in `block (2 levels) in save'\nactiverecord (3.1.0) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:208:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/transactions.rb:241:in `block in save'\nactiverecord (3.1.0) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'\nactiverecord (3.1.0) lib/active_record/transactions.rb:240:in `save'\nactiverecord (3.1.0) lib/active_record/persistence.rb:163:in `block in update_attributes'\nactiverecord (3.1.0) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:208:in `transaction'\nactiverecord (3.1.0) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nactiverecord (3.1.0) lib/active_record/persistence.rb:161:in `update_attributes'\napp/controllers/stores_controller.rb:62:in `block in update'\nactionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:269:in `call'\nactionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:269:in `retrieve_response_from_mimes'\nactionpack (3.1.0) lib/action_controller/metal/mime_responds.rb:194:in `respond_to'\napp/controllers/stores_controller.rb:61:in `update'\nactionpack (3.1.0) lib/action_controller/metal/implicit_render.rb:4:in `send_action'\nactionpack (3.1.0) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.1.0) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:416:in `_run__16358980__process_action__192134115__callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:386:in `_run_process_action_callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.1.0) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/rescue.rb:17:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.1.0) lib/active_support/notifications.rb:53:in `block in instrument'\nactivesupport (3.1.0) lib/active_support/notifications/instrumenter.rb:21:in `instrument'\nactivesupport (3.1.0) lib/active_support/notifications.rb:53:in `instrument'\nactionpack (3.1.0) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.1.0) lib/action_controller/metal/params_wrapper.rb:201:in `process_action'\nactiverecord (3.1.0) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.1.0) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.1.0) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.1.0) lib/action_controller/metal.rb:193:in `dispatch'\nactionpack (3.1.0) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.1.0) lib/action_controller/metal.rb:236:in `block in action'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:65:in `call'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:65:in `dispatch'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:29:in `call'\nrack-mount (0.8.3) lib/rack/mount/route_set.rb:152:in `block in call'\nrack-mount (0.8.3) lib/rack/mount/code_generation.rb:96:in `block in recognize'\nrack-mount (0.8.3) lib/rack/mount/code_generation.rb:75:in `optimized_each'\nrack-mount (0.8.3) lib/rack/mount/code_generation.rb:95:in `recognize'\nrack-mount (0.8.3) lib/rack/mount/route_set.rb:141:in `call'\nactionpack (3.1.0) lib/action_dispatch/routing/route_set.rb:531:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.3.6) lib/rack/etag.rb:23:in `call'\nrack (1.3.6) lib/rack/conditionalget.rb:35:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/flash.rb:243:in `call'\nrack (1.3.6) lib/rack/session/abstract/id.rb:195:in `context'\nrack (1.3.6) lib/rack/session/abstract/id.rb:190:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/cookies.rb:326:in `call'\nactiverecord (3.1.0) lib/active_record/query_cache.rb:62:in `call'\nactiverecord (3.1.0) lib/active_record/connection_adapters/abstract/connection_pool.rb:477:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/callbacks.rb:29:in `block in call'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:392:in `_run_call_callbacks'\nactivesupport (3.1.0) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.1.0) lib/action_dispatch/middleware/callbacks.rb:28:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/reloader.rb:68:in `call'\nrack (1.3.6) lib/rack/sendfile.rb:101:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/remote_ip.rb:48:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/show_exceptions.rb:47:in `call'\nrailties (3.1.0) lib/rails/rack/logger.rb:13:in `call'\nrack (1.3.6) lib/rack/methodoverride.rb:24:in `call'\nrack (1.3.6) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.1.0) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.3.6) lib/rack/lock.rb:15:in `call'\nactionpack (3.1.0) lib/action_dispatch/middleware/static.rb:53:in `call'\nrailties (3.1.0) lib/rails/engine.rb:455:in `call'\nrailties (3.1.0) lib/rails/rack/content_length.rb:16:in `call'\nrailties (3.1.0) lib/rails/rack/log_tailer.rb:14:in `call'\nrack (1.3.6) lib/rack/handler/webrick.rb:59:in `service'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\nC:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n\n<p>This error confuses me, as typing in app/tmp/carrierwave/20121104-0929-5512-8270/04.png directly into the browser works fine.</p>\n\n<p>For completeness sake, here is the controller &amp; model (same in both versions)</p>\n\n<pre><code>#stores_controller.rb\ndef create\n  @store = Store.new(params[:store])\n\n  respond_to do |format|\n    if @store.save\n      format.html { redirect_to @store, notice: 'Store was successfully created.' }\n      format.json { render json: @store, status: :created, location: @store }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @store.errors, status: :unprocessable_entity }\n    end\n  end\nend\n\n#models/store.rb\nclass Store &lt; ActiveRecord::Base\n  mount_uploader :bild, PictureUploader\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13216976,"title":"What does the initialize method in rails do","body":"<p>I'm trying to wrap my head around the purpose of using the initialize method. In Hartl's tutorial, he uses the example..</p>\n\n<pre><code>def initialize(attributes = {})\n   @name = attributes[:name]\n   @email = attributes[:email]\nend\n</code></pre>\n\n<p>Is initialize setting the instance variables <code>@name</code> and <code>@email</code> to the attributes, and if so why do we have the argument <code>attributes = {}</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13215219,"title":"ActiveRecord: many-to-many and one-to-many between same two models","body":"<p>Looking at guides.rubyonrails.com, I see the syntax for a self join:</p>\n\n<pre><code>class Employee &lt; ActiveRecord::Base\n  has_many :subordinates, :class_name =&gt; \"Employee\",\n    :foreign_key =&gt; \"manager_id\"\n  belongs_to :manager, :class_name =&gt; \"Employee\"\nend\n</code></pre>\n\n<p>What I want to do is something more like this:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :workers, :class_name =&gt; \"Employee\",\n    :foreign_key =&gt; \"manager_id\"\n  belongs_to :manager, :class_name =&gt; \"Employee\"\nend\n</code></pre>\n\n<p>Or perhaps I can define the relationship polymorphically:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  belongs_to :manager, :polymorphic =&gt; true\n  has_many :employees\nend\n\nclass Employee &lt; ActiveRecord::Base\n  has_many :projects, :as =&gt; :manager\nend\n</code></pre>\n\n<p>So I guess the relationship I'm looking for is sort of like a HABTM but with a concrete distinction between having and belonging to.  Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","webrick","foreman"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":12808966,"title":"Rails server log not outputting immediately","body":"<p>We use Foreman to start all of our web processes in development.</p>\n\n<p>A while back, I tried to get the ruby-debugger gem working with this setup, but I couldn't, so I abandoned my effort. Along the way, I must have changed some setting or another, and now when I try to look at the server log in real time when I make a request to my local environment, nothing gets printed out. I have to kill foreman in order to see any output from the request.</p>\n\n<p>This is really slowing down my development, as I have to make a request, kill foreman to get information about what went wrong, then start up and try again.</p>\n\n<p>Any ideas how to get my server log to spit out everything as I'm making requests?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13206313,"title":"Clean folder every hour","body":"<p>I want the Rails server to empty the folder <code>public/photos</code> every hour, so that the folder does not get too full. How can I do that (if it's even a possibility)?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":128,"score":0,"question_id":6861022,"title":"Render view from code in /lib","body":"<p>Let's pretend we have a Rails project with a class named <code>Foo</code> residing in the <code>lib</code> directory.</p>\n\n<p>We want to generate some HTML based on its attributes.</p>\n\n<p>Now, creating a big string by concatenating HTML fragments appropriately doesn't feel right in the least bit.</p>\n\n<p>My question is: is there a blessed way to do it?  </p>\n"},{"tags":["ruby-on-rails-3","routes","ruby-on-rails-2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":416,"score":1,"question_id":9789198,"title":"Migrating from Rails 2.3 to 3.2 over a long period","body":"<p>I'm working on a small project that has been allocated a small amount of time to maintain and update features.  This project is on Rails 2.3.</p>\n\n<p>I'd like to move it to Rails 3.2 but there is little time allocated to this so I would like to do it over a slow gradual process.</p>\n\n<p>I'm thinking that it might be worth moving over to Rails 3.2 on a section-by-section basis.\nThis would mean that I would create a second application that looks the same as the first one but is located somewhere different and accessed from a different subdomain.</p>\n\n<p>Is this feasible if I just update the Rails 2.3 routes file for certain routes to go to the new application?</p>\n\n<p>Has anyone done this before?</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3","random"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":13204634,"title":"Freeze a random number in Ruby","body":"<p>I'm trying to build something that will randomly pick two objects from a list in Ruby (using Rails) and then perform basic operations on those objects. My current set up involves randomly picking numbers at the start - using these numbers to get objects from the database and then rendering those objects to index. However, now I'm trying to edit these objects using AJAX I'm running into a problem.</p>\n\n<p>It seems that, when I click on a link that the random number in being recalculated and is causing my AJAX function not to work.</p>\n\n<p>I've included (what I believe is) all relevant code below but let me know if you need to see anything else to get to the bottom of this. I'm looking to get the titles of the old animals and (ideally their previous ratings and) their new ratings to appear at the bottom of the page.</p>\n\n<p>Thanks,</p>\n\n<p>Matt</p>\n\n<p><code>controllers/static_pages.rb</code></p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\nrespond_to :html, :js\nbefore_filter :pickanimals\n\ndef pickanimals\n    @allAnimals = Animal.all\n    @random_no = rand(@allAnimals.length)\n    @animal = @allAnimals[@random_no]\n    @allAnimals.delete_at(@random_no)\n    @newRandom = rand(@allAnimals.length)\n    @animal2 = @allAnimals[@newRandom]\nend\n\n  def index\n    respond_to do |format|\n        format.html\n        format.js\n    end\nend\n\n  def help\n  end\n\n  def about\n  end\n\n  def contact\n  end\n\ndef league\nend\n\ndef voting\n    @votedAnimal = Animal.find(params[:id])\n    if @votedAnimal == @animal\n        @animal.rating += 1\n        @animal2.rating -= 1\n    else\n        @animal.rating -= 1\n        @animal2.rating += 1    \n    end\n    Animal.transaction do\n        @animal.save!\n        @animal2.save!\n    end\n    respond_to do |format|\n        format.html { redirect_to root_path }\n        format.js  \n    end\nend\nend\n</code></pre>\n\n<p><code>app/views/static_pages/index.html.erb</code></p>\n\n<pre><code>&lt;div class=\"center hero-unit\"&gt;\n&lt;h1&gt;Animal Attack&lt;/h1&gt;\n&lt;p&gt; Who will win when nature collides? &lt;/p&gt;\n&lt;div class=\"animalcontainerright\"&gt;\n&lt;h2&gt; &lt;%= @animal.name %&gt; &lt;/h2&gt; \n&lt;%= link_to image_tag(@animal.attachment.url(:large)), voting_path(@animal.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div class=\"animalcontainerleft\"&gt;\n&lt;h2&gt; &lt;%= @animal2.name %&gt; &lt;/h2&gt;\n&lt;%= link_to image_tag(@animal2.attachment.url(:large)), voting_path(@animal2.id), :remote =&gt; true, :confirm =&gt; \"Rating:  \"+@animal2.rating.to_s  %&gt;\n&lt;/div&gt;\n&lt;div id=\"animalfacts\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><code>routes.rb</code></p>\n\n<pre><code>AnimalAttack::Application.routes.draw do\n\nresources :animals\n\nroot to: 'static_pages#index'\nmatch '/help' =&gt; 'static_pages#help'\nmatch '/about' =&gt; 'static_pages#about'\nmatch '/contact' =&gt; 'static_pages#contact'\nmatch '/league' =&gt; 'static_pages#league'\nmatch '/voting/:id' =&gt; 'static_pages#voting'\n\nend\n</code></pre>\n\n<p><code>rake routes</code></p>\n\n<pre><code>    animals GET    /animals(.:format)          animals#index\n        POST   /animals(.:format)          animals#create\n new_animal GET    /animals/new(.:format)      animals#new\nedit_animal GET    /animals/:id/edit(.:format) animals#edit\n animal GET    /animals/:id(.:format)      animals#show\n        PUT    /animals/:id(.:format)      animals#update\n        DELETE /animals/:id(.:format)      animals#destroy\n   root        /                           static_pages#index\n   help        /help(.:format)             static_pages#help\n  about        /about(.:format)            static_pages#about\ncontact        /contact(.:format)          static_pages#contact\n league        /league(.:format)           static_pages#league\n               /animals(.:format)          animals#new\n               /voting/:id(.:format)       static_pages#voting\n</code></pre>\n"}]}
{"total":34674,"page":5,"pagesize":100,"questions":[{"tags":["ruby-on-rails-3","recaptcha"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":10,"score":1,"question_id":13211686,"title":"recaptcha_tags rendering escaped HTML in erb","body":"<p>I'm migrating my app to Rails 3.2.8 from 2.3.5. One form uses reCAPTCHA (in an erb file). Right now, all the HTML tags that the recaptcha_tags puts out are in escaped HTML. (i.e. &amp;lt;...&amp;gt; instead of &lt;...>). So I see the tags themselves in the HTML page, instead of the reCAPTCHA box.</p>\n\n<p>Here's what my erb looks like. I've verified that it doesn't matter where in the erb I put the recaptcha tags (inside the form_for or outside):</p>\n\n<p>register.html.erb</p>\n\n<pre><code>...\n&lt;%= recaptcha_tags :public_key =&gt; RECAPTCHA_PUBLIC_KEY %&gt;\n...\n</code></pre>\n\n<p>Other things, like form_for don't have this problem. They output straight HTML.</p>\n\n<p>Gemfile</p>\n\n<pre><code>gem \"recaptcha\", :require =&gt; 'recaptcha/rails'\n</code></pre>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","tdd"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13212410,"title":"RSpec with Ruby on Rails - Wrong number of arguments (1 for 0) when testing routes","body":"<p>I tried testing routes and just copied the example from the rspec-rails documentation.</p>\n\n<pre><code>describe \"routing to profiles\" do\n  it \"routes /profile/:username to profile#show for username\" do\n    expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n      :controller =&gt; \"profiles\",\n      :action =&gt; \"show\",\n      :username =&gt; \"jsmith\"\n    )\n  end\nend\n</code></pre>\n\n<p>I got the following error when running RSpec:</p>\n\n<pre><code>Failures:\n\n  1) routing to profiles routes /profile/:username to profile#show for username\n     Failure/Error: expect(:get =&gt; \"/profiles/jsmith\").to route_to(\n     ArgumentError:\n       wrong number of arguments (1 for 0)\n     # ./spec/routing/test_spec.rb:11:in `block (2 levels) in &lt;top (required)&gt;'\n\nFinished in 0.001 seconds\n1 example, 1 failure\n</code></pre>\n\n<p>What's going wrong here?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","css","ruby-on-rails-3","layout","twitter-bootstrap"],"answer_count":3,"favorite_count":11,"up_vote_count":9,"down_vote_count":0,"view_count":4550,"score":9,"question_id":9118923,"title":"twitter-bootstrap-rails gem workflow","body":"<p>How do I use the twitter-bootstrap-rails gem in my Rails 3.2.1 app? What is the workflow?</p>\n\n<p>After I do:</p>\n\n<pre><code>rails g bootstrap:layout [LAYOUT_NAME] [*ﬁxed or ﬂuid] [options]\n</code></pre>\n\n<p>what do I do next? Do I just copy and paste the generated code into my view? Do I do this for every view? If so, how is doing</p>\n\n<pre><code>rails g bootstrap:themed [RESOURCE_NAME] [LAYOUT] [options]\n</code></pre>\n\n<p>any different?</p>\n\n<p>Do you guys even use the rails generators?</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13214704,"title":"set a timeframe on model attribute rails 3","body":"<p>I have an app that allows you to upload a recipe to the db, as part of the app i would like to have a \"Featured Recipe\" that is called randomly from the recipe db. I am using this method to call a random record</p>\n\n<pre><code>   @featurerecipe = Recipe.offset(rand(Recipe.count)).limit(1)\n</code></pre>\n\n<p>As expected when i refresh the page the record changes, however I would like the random record to stay in place for say 24 hours, even when the page is refreshed. I'm looking for some advice on how to go about this or perhaps someone else has done this in a project of their own? I was thinking that you could have a db column called feature and then set a \"true\" value to it, set everything else as false and then somewhere a loop needs to occur to check the time spent at value \"true\", then after 24 hours pick another random recipe? </p>\n\n<p>I may be well off here, any help appreciated</p>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13211608,"title":"get html input into a rails function","body":"<p>I have a piece of html like this:</p>\n\n<pre><code>    &lt;div class=\"row well\"&gt;\n      &lt;form method=\"POST\"&gt;\n        &lt;ol id=\"velArea\"&gt;\n          &lt;li&gt;  Layer velocity: (m/s) &lt;input type=\"text\" name=\"source[]\"&gt; &lt;/li&gt;\n        &lt;/ol&gt;\n        &lt;input type=\"button\" value=\"Add another layer\" name=\"velocity\" onClick=\"addVel('velArea');\"&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>and a javascript function that adds html to the area</p>\n\n<pre><code>    function addVel(area)\n    {\n      var field_area = document.getElementById(area);\n      field_area.innerHTML += \"&lt;li&gt;  Layer velocity: (m/s) &lt;input type='text' name='velocity'&gt; &lt;a style='cursor:pointer;color:grey;' onclick='this.parentNode.parentNode.removeChild(this.parentNode);''&gt;delete&lt;/a&gt; &lt;/li&gt;\";\n    }\n</code></pre>\n\n<p>I need to read the value of each input field in a rails function. And have no idea about how to do that. I've lost days going through active model in rails, thinking that was the way until I finally figured out that is better to keep the browser-related and server related things separated. So I learned a little javascript and made a few functions. Yes, I'm new to web development. I'm using rails 3.2.</p>\n\n<p>The function that I want to uses the fields info is called by a button:</p>\n\n<pre><code>     &lt;%= button_to \"Run single inversion\", {:action =&gt; \"my_func\", }, {:remote =&gt; true, :form =&gt; { \"data-type\" =&gt; \"json\" }, :class =&gt; \"btn btn-primary\"} %&gt;\n</code></pre>\n\n<p>and the function on the controller is:</p>\n\n<pre><code>    def my_func\n      render :nothing =&gt; true\n      vel = params[:velocity]\n      puts vel.class\n      puts 'Hi'\n    end\n</code></pre>\n\n<p>the output I get is</p>\n\n<pre><code>    NilClass\n    Hi\n</code></pre>\n\n<p>so I'm clearly not passing the arguments right. I'm guessing I need to pass the velocity array in the post method when I use the button_to, but have no idea about how to do that.</p>\n\n<p>Also, I'm need the value of the input, not anything database oriented so I cannot look it up using activeRecord properties.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":13212200,"title":"Moving mysql query to model","body":"<p>I have the following mysql query working well. Quick backstory, this lists our customers by total money spent. </p>\n\n<pre><code>SELECT  SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\nFROM customer_order AS co \nJOIN customer AS cu ON (cu.customer_id = co.customer_id) \nGROUP BY co.customer_id\nORDER BY money_spent DESC\n</code></pre>\n\n<p>I attempted moving this to the customer model, as a scope, and subclass  yet I failed both ways.  I'm somewhat new to rails (formerly client-side) but I think I'm close.  Hoping y'all could point me in the right direction. Thanks in advance!!!</p>\n\n<pre><code>def self.high_rollers  \n  options = {\n      :select   =&gt; \"SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\",\n      :from     =&gt; \"customer_order AS co\",\n      :joins    =&gt; \"customer AS cu ON (cu.customer_id = co.customer_id)\",\n      :group_by =&gt; \"co.customer_id\",\n      :order    =&gt; \"money_spent DESC\"\n            }   \n</code></pre>\n\n<p>Putting the following code in my index action for this controller works, but definitely doesn't feel like the right approach!</p>\n\n<pre><code>@high_bidders = Customer.find_by_sql(&lt;&lt;-SQL\n       SELECT  SUM(price) AS money_spent, co.customer_id, cu.first_name, cu.last_name, cu.email_primary\n       FROM customer_order AS co \n       JOIN customer AS cu ON (cu.customer_id = co.customer_id) \n       GROUP BY co.customer_id\n       ORDER BY money_spent DESC\n</code></pre>\n\n<p>SQL\n )</p>\n"},{"tags":["ruby-on-rails-3","postgresql","libpq"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":120,"score":2,"question_id":11171330,"title":"Why is rake aborting because of libpq.5.dylib","body":"<p>I just installed <strong>PostgreSQL</strong> and the <strong>pg</strong> gem for running Rails on Heroku. I'm running </p>\n\n<pre><code>$ rake -T\n</code></pre>\n\n<p>But it's aborting for reason related to \"libpq.5.dylib\"</p>\n\n<pre><code>rake aborted!\ndlopen(/Library/Ruby/Gems/1.8/gems/pg-0.13.2/lib/pg_ext.bundle, 9): Library not loaded: libpq.5.dylib\nReferenced from: /Library/Ruby/Gems/1.8/gems/pg-0.13.2/lib/pg_ext.bundle\nReason: image not found - /Library/Ruby/Gems/1.8/gems/pg-0.13.2/lib/pg_ext.bundle\n</code></pre>\n\n<p>What gives?</p>\n\n<p>How can load the libpq.5.dylib library?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":11667426,"title":"Rails: control ordering of query parameters in url_for?","body":"<p>I'd like to generate a URL where the \"p=1\" query param appears at the end of the URL, like:</p>\n\n<pre><code>/path?foo=X&amp;bar=Y&amp;p=1\n</code></pre>\n\n<p>Is it possible to control the ordering of query parameters when generating URLs via:</p>\n\n<pre><code>url_for(params.merge({ p: page_num }))\n</code></pre>\n\n<p>?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I tried <a href=\"http://stackoverflow.com/users/1396395/chucke\">ChuckE's</a> <a href=\"http://stackoverflow.com/a/11668620/93995\">suggestion below</a>. It turns out that in Ruby 1.9 Hashes are already ordered, so the code in <code>ActiveSupport::OrderedHash</code> is effectively no-op'd. You can verify with Ruby 1.9 that order is preserved:</p>\n\n<pre><code>&gt;&gt; h = {one: 1, two: 2, three: 3 }\n{:one=&gt;1, :two=&gt;2, :three=&gt;3}\n&gt;&gt; f = h.except(:one)\n{:two=&gt;2, :three=&gt;3}\n&gt;&gt; f[:one] = 1\n1\n&gt;&gt; f\n{:two=&gt;2, :three=&gt;3, :one=&gt;1}\n</code></pre>\n\n<p>However, <code>url_for</code> <em>still</em> puts the \"p\" param first. It seems that any potential solution will need to address how <code>url_for</code> iterates the hash.</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13212155,"title":"Array of time to fill a simpleform listbox","body":"<p>I have a time field and would like to have only the following times appear:</p>\n\n<p>09:00\n09:15\n09:30\n09:45\n10:00\n...\n14:00</p>\n\n<p>I'm using Simple_Forms, bootstrap and activerecord.</p>\n\n<p>Last thing I tried was setting up a global initialiser like this:</p>\n\n<pre><code>ValidHours =\n['09:00', '09:15', '09:30', '09:45', '10:00', '10:15', '10:30', '10:45', \n  '11:00', '11:15', '11:30', '11:45', '12:00',\n  '12:15', '12:30', '12:45', '13:00', '13:15', '13:30', '13:45', '14:00']\n</code></pre>\n\n<p>and then in Simple_Forms I used:</p>\n\n<pre><code>  &lt;%= f.input :order_until_hour, :label =&gt; \"Order until\", :collection =&gt; ValidHours %&gt;\n</code></pre>\n\n<p>This displays the values correctly but they don't seem to be saved in the database.</p>\n\n<p>If possible I would also like to have this info in the model where it belongs.</p>\n\n<p>I also tried:</p>\n\n<pre><code>def self.ValidHours\n  ['09:00', '09:15', '09:30', '09:45', '10:00', '10:15', '10:30', '10:45', '11:00',\n    '11:15', '11:30', '11:45', '12:00', '12:15', '12:30', '12:45', '13:00', \n    '13:15', '13:30', '13:45', '14:00']\nend\n</code></pre>\n\n<p>and in the view:</p>\n\n<pre><code>  &lt;%= f.input :order_until_hour, :label =&gt; \"Order until\", :collection =&gt; ValidHours %&gt;\n</code></pre>\n\n<p>but that didn't work either.</p>\n\n<p>Thanks for any clues!</p>\n\n<p>EDIT:</p>\n\n<p>Thanks for the reply uDaY.  I tried your suggestion.</p>\n\n<p>They appear correctly now, I also checked the database and they get saved too.  However if I click on edit (after it's saved) it still appears empty.</p>\n\n<p>This is the code:</p>\n\n<pre><code>class Shop &lt; ActiveRecord::Base\n\n  def self.ValidHours\n      [['09:00', '09:00'], ['09:15', '09:15'], ['09:30', '09:30'], ['09:45', '09:45'], ['10:00', '10:00'],\n       ['10:15', '10:15'], ['10:30', '10:30'], ['10:45', '10:45'], ['11:00', '11:00'], ['11:15', '11:15'],\n       ['11:30', '11:30'], ['11:45', '11:45'], ['12:00', '12:00'],\n       ['12:15', '12:15'], ['12:30', '12:30'], ['12:45', '12:45'], ['13:00', '13:00'], ['13:15', '13:15'],\n       ['13:30', '13:30'], ['13:45', '13:45'], ['14:00', '14:00']]\n  end\n</code></pre>\n\n<p>and in the view:</p>\n\n<pre><code>      &lt;%= f.input :order_until_hour, :label =&gt; \"Order until\", :collection =&gt; Shop.ValidHours %&gt;\n</code></pre>\n\n<p>In the database the values appear as:</p>\n\n<pre><code>order_until_hour: \"2000-01-01 09:00:00\"\n</code></pre>\n\n<p>so I thought I would alter the ValidHours like this:</p>\n\n<pre><code>  def self.ValidHours\n      [['09:00', '2000-01-01 09:00'], ['09:15', '2000-01-01 09:15'] …\n</code></pre>\n\n<p>but that doesn't make any difference.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","model","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13208659,"title":"Add to cart quantity logic RoR","body":"<p>I have a method called add_to_cart created that is being called each time a user adds a product to their cart - the method then checks to see if the item already exists and if it does it increases the quantity by +1. </p>\n\n<p>The issue I am having is that I am unsure how to call my Items 'create' action (in Items controller) from my model if a product does not already exist in the cart. </p>\n\n<p>I think I could use Item.create(...) but I would rather just call the create action that already exists in my Items controller.</p>\n\n<p>Currently I have:</p>\n\n<p>Products#Index View</p>\n\n<pre><code> ...\n &lt;%= button_to \"Add to Cart\", add_to_cart_path(:product_id =&gt; product), :method =&gt; :post %&gt;\n ...\n</code></pre>\n\n<p>Routes</p>\n\n<pre><code> ...\n post '/add_to_cart/:product_id' =&gt; 'carts#add_to_cart', :as =&gt; 'add_to_cart'\n ...\n</code></pre>\n\n<p>Carts Controller</p>\n\n<pre><code> class CartsController &lt; ApplicationController\n\n def show\n   @cart = current_cart\n end\n\n def add_to_cart\n   current_cart.add_item(params[:product_id])\n   redirect_to cart_path(current_cart.id)\n end\n\n end\n</code></pre>\n\n<p>Cart Model</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\nhas_many :items\n\ndef add_item(product_id)\n        item = items.where('product_id = ?', product_id).first\n    if item\n        # increase the quantity of product in cart\n        item.quantity + 1\n        save\n    else\n        save # \"THIS IS WHERE I WANT TO CALL ITEMS CONTROLLER CREATE\"\n    end\nend\n</code></pre>\n\n<p>Items Controller</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\ndef create\n    @product = Product.find(params[:product_id])\n    @item = Item.create!(:cart =&gt; current_cart, :product =&gt; @product, :quantity =&gt; 1, :unit_price =&gt; @product.price)\n    redirect_to cart_path(current_cart.id)\nend\n\nend\n</code></pre>\n\n<p>Any help on how I can achieve this redirect to my create action would really be much appreciated! :)</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13212377,"title":"Rails and mysql. Any way to view tables?","body":"<p>I have just started out on rails and I've been using the mysql2 gem with it.\nI realised that on rails, migrations are used to alter tables in the database. </p>\n\n<p>So I was just wondering if there was anyway I could view the tables in Mysql?\nAnd also some way to make insertions, deletions etc more efficient?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":5463972,"title":"Gift list open source app?","body":"<p>I'm looking for a Rails 2.x/3 application for administrating Gift Lists (weddings, birthdays, etc).</p>\n\n<p>Does anybody know about any?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13212296,"title":"Is it possible to replace string with hash / symbol (:created_at)","body":"<p>Is it possible to write this lines in hash format (:created_at)</p>\n\n<pre><code>User.where(\"created_at &gt; ?\", Time.now - 1.month) \nUser.where(\"created_at &gt;= ?\", DateTime.parse('2012-10-31')\n</code></pre>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","passenger","less","bootswatch"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":800,"score":3,"question_id":9219213,"title":"Cannot call method 'charAt' of undefined - only on server","body":"<p>I have a rails application which is running well in local (OsX, WEBrick).</p>\n\n<p>I've cloned the repo on a server (Ubuntu 10.04, Apache, Passenger), setted up passenger, but now when i try to connect to every page i get</p>\n\n<pre><code>Less::ParseError in Pages#home\n\nShowing /var/www/MYAPP/app/views/layouts/application.html.erb where line #5 raised:\n\nCannot call method 'charAt' of undefined\n  (in /usr/lib/ruby/gems/1.8/gems/twitter-bootstrap-rails-2.0.2/vendor/assets/stylesheets/twitter/bootstrap.css.less)\n</code></pre>\n\n<p>the content of bootstrap.css.less is:</p>\n\n<pre><code>@import \"twitter/bootstrap/bootstrap\";\n</code></pre>\n\n<p>line 5 of application.html.erb is:</p>\n\n<pre><code>&lt;%= stylesheet_link_tag    \"application\" %&gt;\n</code></pre>\n\n<p>ruby 1.8.7 on both machines</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13206463,"title":"retrieving pdf(file) from database in ruby on rails","body":"<p>I am able to successfully store uploaded pdf in database using binary datatype in database. Now i want to retrieve that pdf and store in variable something like mypdf = xxx.pdf , so that i can pass that pdf in few of my methods. I want to do in ruby or rails.</p>\n\n<p>let me rephrase what i mean. i want to retrieve pdf file which is already stored in database. i know for eg this code in controller will render pdf locally.  send_data @attachment.data, :filename => @attachment.filename, :type => @attachment.content_type  but i don't want to show the pdf. i want to assign the pdf to variable and later on pass that pdf to my method </p>\n\n<p>Thanks for help </p>\n"},{"tags":["ruby-on-rails-3","sprockets","tilt"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":12435246,"title":"Sprockets > How to specify a binding for Erb evaluation / rendering?","body":"<p>I've spent a lot of time digging into sprockets' and tit's source code, trying to figure out how to pass variables / bindings to the Erb evaluation context. Here's what I'm trying to do: I need to serve a JS file whose contents change on a per-request basis. The portions that change depend on data stored in the DB, hence the need to route requests through the Rails app and the need to pass variables / bindings. On top of that the JS file uses the <code>require</code> directives to insert other JS files, hence the need to use sprockets.</p>\n\n<p>Here's the code snippet that isn't working:</p>\n\n<p>Controller file:</p>\n\n<pre><code>def ever_changing_js\n  @foobars = Foobar.all\n  MyApp::Application.assets.instance_eval do\n    def foobars\n      @foobars\n    end\n  end\n\n  render :text =&gt; MyApp::Application.assets.find_asset('ever_changing.js').to_s, :content_type =&gt; \"application/javascript\"\nend\n</code></pre>\n\n<p>ever_changing.js:</p>\n\n<pre><code>//= require file1.js\n//= require file2.js\n\n// Some code that uses @foobars\n</code></pre>\n\n<p>How can I get this done? Any help would be appreciated.</p>\n"},{"tags":["ruby","arrays","ruby-on-rails-3","csv","export-to-csv"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":53,"score":2,"question_id":13203470,"title":"Rails: CSV Array to string (convert)","body":"<p>I am new to rails and I would like to export a dictionary (of strings). \nAt the moment I am using this piece of code</p>\n\n<pre><code>    Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \")\n</code></pre>\n\n<p>To generate:</p>\n\n<pre><code>   Build a cage!, Build tha pizza, Demonstrated ability in flying, Demonstrated ability in pizza baking\n</code></pre>\n\n<p>I would like to export this to csv, however the problem is that it is one array. I would like to create separate strings (comma separated) and displaying each string on a different row. Currently everything is displayed on one row when exporting this to csv. </p>\n\n<p>Any clue how to do this? I created an array of the data because there is a lot of duplicate data and this piece of code is filtering all the duplicates out.</p>\n\n<p>In my controller:</p>\n\n<pre><code>   format.csv { render Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n</code></pre>\n\n<p>I hope anyone could help me, much appreciated.</p>\n\n<p>Edit:</p>\n\n<p>Ideally I would like to fetch all competencies and have an output without duplicates, this is my controller:</p>\n\n<pre><code>    def dictionary\n      @competencies = Competency.all\n\n        respond_to do |format|\n        format.html { render html: positions_dictionary_path }\n        format.csv { render Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n        format.xls { send_data Competency.order(:competencies).map(&amp;:competencies).uniq!.join(\", \") }\n\n      end\n    end\n</code></pre>\n\n<p>Usually in a view file you would do:</p>\n\n<pre><code>      &lt;div&gt;\n        &lt;% @posts.each do |competency| %&gt;\n          &lt;%= competency.competencies %&gt;\n        &lt;% end %&gt;\n      &lt;/div&gt;\n</code></pre>\n\n<p>This generates a list of all the competencies, however also the duplicates. My solution was to create an array. However this creates problems when exporting to csv (because I need every output on a different line/row. So my question, how can I generate a list of all the \"competencies\" without duplicates?</p>\n"},{"tags":["ruby-on-rails-3","session"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13211413,"title":"Ability to store Name/Email in a session","body":"<p>I have a form that I want a user to put in their name and email, which get stored in a session.  They can then post text in a chat box.  </p>\n\n<p>In my view, to create the initial session:</p>\n\n<pre><code>&lt;%= simple_form_for(@comments, :url =&gt; guest_login_order_path(@order)) do |f| %&gt;\n        &lt;input name=\"comment[new_user_comment_name]\" /&gt;\n        &lt;input name=\"comment[new_user_comment_email]\" /&gt;\n        &lt;%= f.button :submit, :value =&gt; 'Guest Signin', :class =&gt; '' %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>This goes to my controller:</p>\n\n<pre><code>def guest_login\n    @order = Order.where(:public_hash =&gt; params[:public_hash]).first\n    session[:new_user_account] = params[:new_user]\n\n    respond_to do |format|\n      if session[:new_user_account]\n        format.html { redirect_to @order, notice: 'Your account has been created.' }\n        format.json { render json: @order, status: :created, location: @order }\n      else\n        format.html { render action: \"invoice\" }\n        format.json { render json: @order.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>The params get passed correctly but I'm not quite sure if the cookie is being created.  Is there way to specify a name so I can see if it was created?  Also in the view, would I have a conditional then to see if there is a session present?</p>\n"},{"tags":["ruby-on-rails","reload","rails-engines","ruby-on-rails-3"],"answer_count":9,"favorite_count":15,"up_vote_count":21,"down_vote_count":0,"view_count":6619,"score":21,"question_id":3282655,"title":"Ruby on Rails 3 - Reload lib directory for each request","body":"<p>I'm creating a new engine for a rails 3 application. As you can guess, this engine is in the lib directory of my application.</p>\n\n<p>However, i have some problems developing it. Indeed, I need to restart my server each time I change something in the engine.</p>\n\n<p>Is there a way to avoid this ?</p>\n\n<p>Can I force rails to completely reload the lib directory or a specific file and his requirements for each request ?</p>\n\n<p>Thanks for your help :)</p>\n"},{"tags":["ruby-on-rails-3","omniauth","linkedin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13208449,"title":"omniauth (linkedin) without Device - how to redirect to 'new' with validation messages?","body":"<p>I want users to be able to connect via other services (linked, facebook, google and twitter) without having to fill in another password.</p>\n\n<p>I have been following the amazing 235 &amp; 236 episodes of railscast.com which explain rather nicely how to use OmniAuth with Devise gem.</p>\n\n<p>I am not using Devise which confuses me and I don't manage to get it working as in the videocast. </p>\n\n<p>I tried following Ryan Bates instructions and adapt to my situation. I can't follow his instructions from minute 10 of no236 video where he overrides Devise's registration controller and views. </p>\n\n<p>So my problem happens when no user is signed in and no omniauth authentication available. \nIn that case, I need to create a new user, save, sign in and finally redirect.</p>\n\n<p>If the save fails after validation, I need a redirect to user new form with validation errors.</p>\n\n<p>I do manage to redirect to the new user form, BUT I don't manage to get the validation errors.</p>\n\n<p>CODE authentications controller</p>\n\n<pre><code>def create\n  omniauth = request.env[\"omniauth.auth\"] \n  #current_user = find_current_user\n  authentication = Authentication.find_by_provider_and_uid(omniauth['provider'], omniauth['uid'])\n  if authentication\n    flash[:notice] = \"Signed in successfully.\"\n    login_and_redirect(authentication.user)\n  elsif @current_user \n    @current_user.authentications.create!(:provider =&gt; omniauth['provider'], :uid =&gt; omniauth['uid'])\n    flash[:notice] = \"Authentication successful.\"\n    redirect_to authentications_url\n  else\n    user = User.new\n    puts \"OmniAuth: \" + omniauth[:info].to_s\n    user.apply_omniauth(omniauth)\n\n    if user.save\n      flash[:notice] = \"Signed in successfully.\"\n      login_and_redirect(user)\n    else\n      flash[:notice] = \"Omniauth Extra.\"\n      session[:omniauth] = omniauth.except('extra')\n      user.valid?\n      #redirect_to :controller =&gt; :users, :action =&gt; :new, :plan =&gt; 2\n      redirect_to new_user_url\n    end\n  end \nend\n</code></pre>\n\n<p>QUESTIONS</p>\n\n<p>Question 1: How do I redirect to user new with a pre-filled form using omniauth user info and errors messages?</p>\n\n<p>Question 2: How do I skip validation in my non Devise model when authenticating with another service?</p>\n\n<p>User MODEL</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  has_many :authentications\n  belongs_to :type, :class_name =&gt; \"UserType\", :foreign_key =&gt; \"type_id\"\n  has_many :logins, :class_name =&gt; \"UserLogin\"\n\n  validates :email_address, :email =&gt; { :message =&gt; 'format is incorrect!' }\n\n  validates_presence_of :email_address, :pseudo, :type_id\n  validates_uniqueness_of :email_address, :message =&gt; \"has already been taken\"\n  validates_uniqueness_of :pseudo, :message =&gt; \"has already been taken\"\n\n  attr_accessor :password_confirmation\n  validates_confirmation_of :password\n\n  validate :password_non_blank, :message =&gt; \"Cannot use blank password!\"\n\n  validates :agreed_terms_of_services, :presence =&gt; true, :allow_nil =&gt; false\n\n  attr_protected :password_hash, :password_salt, :active, :activation_token, :activated_at\n\n  ...\n\n  ...\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","requirejs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13211213,"title":"Removing development code during requirejs asset compilation","body":"<p>I am building a Rails 3 application where I use the <code>requirejs-rails</code> gem, which tweaks the asset pipeline according to my requirejs setup.</p>\n\n<p>In my code I have a couple of console.warn/log and other statements I use only for debugging. Is it possible to have these removed when the js is compiled? </p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":91,"score":2,"question_id":12974917,"title":"Get the width and height of an image without downloading it","body":"<p>I need to get the size of an image in Ruby on Rails. The image is in a remote URL.\nI dont want to download the entire image.</p>\n\n<p>Any help?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","model","logic"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13210476,"title":"Quantity in Cart Model Basic Logic Ruby on Rails","body":"<p>I am trying to apply some very basic logic to my view but am so far failing. </p>\n\n<p>What I would like to do is return item.discount_price if there are the following conditions:</p>\n\n<ol>\n<li>The item.product_id is equal to 1</li>\n<li>The Cart.item.quantity count is equal or higher than 2. </li>\n</ol>\n\n<p>Currently I have the following:</p>\n\n<p>Items Model</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\nbelongs_to :product\nbelongs_to :cart\n\ndef price_check\n\n    if  Item.product_id = 1 &amp;&amp; Item.quantity.count &gt;= 2 \n        return Item.discount_price\n    else\n        return Item.unit_price\n    end \n\nend\n</code></pre>\n\n<p>end</p>\n\n<p>View</p>\n\n<pre><code>&lt;% for item in @cart.items %&gt;\n&lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n  ...\n  &lt;td class=\"price\"&gt;&lt;%= gbp(item.price_check) %&gt;&lt;/td&gt;\n  ...\n&lt;/tr&gt;\n</code></pre>\n\n  \n\n<p>The associations are as follows:</p>\n\n<pre><code>Cart - has_many :items\nItems - Belongs_to :cart and :products\nProducts - has_ many :items\n</code></pre>\n\n<p>The error I keep receiving:</p>\n\n<pre><code> NoMethodError in Carts#show\n\nShowing C:/Sites/checkout/app/views/carts/show.html.erb where line #12 raised:\n\nundefined method `quantity' for #&lt;Class:0x50c3058&gt;\n\nExtracted source (around line #12):\n\n9:        &lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n10:       &lt;td&gt;&lt;%=h item.product.name %&gt;&lt;/td&gt;\n11:       &lt;td class=\"qty\"&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n12:       &lt;td class=\"price\"&gt;&lt;%= gbp(item.price_check) %&gt;&lt;/td&gt;\n13:       &lt;td class=\"price\"&gt;&lt;%= gbp(item.full_price) %&gt;&lt;/td&gt;\n14:       &lt;td&gt;&lt;%= button_to 'Remove', item, :method =&gt; :delete %&gt;&lt;/td&gt;\n15:       &lt;/tr&gt;\n\napp/models/item.rb:12:in `price_check'\napp/views/carts/show.html.erb:12:in `block in _app_views_carts_show_html_erb___389237738_48997308'\napp/views/carts/show.html.erb:8:in `_app_views_carts_show_html_erb___389237738_48997308'\n</code></pre>\n\n<p>Any help people can offer to fix this would be much appreciated! Thanks E</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":156,"score":0,"question_id":10366507,"title":"Rails polymorphic association change type","body":"<p>i've a question about a polymophic association in rails. the following model relationships are given:</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\n  has_many :events, :as =&gt; :event_container, :dependent =&gt; :destroy\n end\n\nclass Order &lt; ActiveRecord::Base\n  has_many :events, :as =&gt; :event_container, :dependent =&gt; :destroy\n end\n\nclass Event &lt; ActiveRecord::Base\n  belongs_to :event_container, :polymorphic =&gt; true\nend\n</code></pre>\n\n<p>So, i've events that are first applied to a cart and after checkout, they have to be stored as events that are related to an order. Here's my question: How can i transfer an event object form a cart to an order, so that \"event_container_id\" and \"event_container_type\" are updated? If i'm just trying to copy from on object to another like this:</p>\n\n<pre><code>c = Cart.first\no = Order.first\nc.events.create(...)\no.events &lt;&lt; c.events.first\n</code></pre>\n\n<p>i get an <code>ActiveRecord::AssociationTypeMismatch</code>Exception. </p>\n\n<p>It might also be possible that my association structure is totally wrong - don't hasitate to tell me, if this is the case... ;)</p>\n\n<p>thx in advance!</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13204652,"title":"Relationship between models are not working like expected","body":"<p>I have 3 models that are basically nested.  </p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :birthday, :name\n  has_one :advancement, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :advancement\n  attr_accessible :advancement_attributes\nend\n\nclass Advancement &lt; ActiveRecord::Base\n  attr_accessible :user_id, :rank_name\n  belongs_to :user\n  has_one :rank, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :_rank\n  attr_accessible :rank_attributes\nend\n\nclass Rank &lt; ActiveRecord::Base\n  attr_accessible :advancement_id, :one_li, :one_pi, :one_date, ...\n  belongs_to :advancement\nend\n</code></pre>\n\n<p>Here is the controller code I use to create my models.</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n  def new\n    @user = User.new\n    @user.advancement = Advancement.new\n    @user.advancement.rank = Rank.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n    end\n  end\n\n  def create\n    @user = User.new(params[:user])\n    @user.advancement = Advancement.new\n    @user.advancement.rank = Rank.new\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: 'User was successfully created.' }\n      else\n        format.html { render action: \"new\" }\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the console I can create relations that work like I would expect.  When I try to do this through the browser all of my objects are instantiated, the foreign keys are correct, but if I try to find user.advancement, I get a method missing error.  Am I using new or create wrong and if so what should I do?  Sorry about the amount of code, but I didnt know any other way to explain it.  </p>\n"},{"tags":["ruby-on-rails-3","routes","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13210495,"title":"Rails 3 Routing Error in One Branch but not in the Other","body":"<p>I'm using: Rails 3.1.3, HAML and Passenger</p>\n\n<p>I'm having a route problem in my staging branch, but in the other branch that was merged into staging I have no problem at all. I've tried comparing my routes files and the form files from these two branches using <code>git diff</code> but the two files are the same in the branches.</p>\n\n<p>A weird thing is the rendered error page. Here's a link to an screenshot</p>\n\n<p><a href=\"http://i.stack.imgur.com/DYNSZ.png\" rel=\"nofollow\">Error message</a></p>\n\n<p>And also the error from passenger:</p>\n\n<pre><code>Rendered time_entries/_form_fields.haml (173.2ms)\nRendered time_entries/_form.haml (194.7ms)\nRendered time_entries/edit.haml within layouts/application (196.6ms)\nCompleted 500 Internal Server Error in 448ms\n\nActionView::Template::Error (No route matches {:controller=&gt;\"time_entries\"}):\n    5:     .field\n    6:       = form.submit \"Save\"\n    7:       |\n    8:       = link_to \"Cancel\", project_time_entries_path(@project)\n  app/views/time_entries/_form.haml:8:in `block in     _app_views_time_entries__form_haml__894171410_105032920'\n  app/views/time_entries/_form.haml:3:in   `_app_views_time_entries__form_haml__894171410_105032920'\n  app/views/time_entries/edit.haml:2:in `_app_views_time_entries_edit_haml__805073897_105087770'\n</code></pre>\n\n<p>I attach you the code from my route and my form</p>\n\n<p>form.haml</p>\n\n<pre><code>.app-form\n  = error_messages_for :time_entry\n  = form_for [@project, @time_entry] do |form|\n    = render :partial =&gt; 'form_fields', :locals =&gt; {:form =&gt; form}\n    .field\n      = form.submit \"Save\"\n      |\n      = link_to \"Cancel\", project_time_entries_path(@project)\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>Titi::Application.routes.draw do\n\n  root :to =&gt; 'time_entries#index'\n  match 'home' =&gt; 'home#index', :as =&gt; :home\n\n  match '/api/*other' =&gt; TitiAPI\n\n  resources :projects do\n    member do\n      get 'archive'\n      get 'unarchive'\n    end\n\n    resources :viewers\n    resources :labels\n\n    resources :time_entries do\n      collection do\n        get 'start'\n      end\n      member do\n        get 'new_note'\n        put 'add_note'\n      end\n    end\n\n  end\n\n  resources :bookings\n\n  resources :technical_orientations, except: [:delete]\n\n  match 'merge_labels/:projects_id' =&gt; 'labels#merge_labels', :as =&gt; :merge_labels\n  match 'move_labels/:projects_id' =&gt; 'labels#move_labels', :as =&gt; :move_labels\n\n  resources :time_entries do\n    collection do\n      get 'start'\n    end\n\n    member do\n      get 'new_note'\n      put 'add_note'\n    end\n  end\n\n  resources :users do\n    member do\n      get 'time_entries'\n      get 'edit_password'\n      put 'update_password'\n      get 'suspend'\n      get 'unsuspend'\n    end\n\n    new do\n      get 'invite_form'\n      post 'invite'\n    end\n\n    collection do\n      get 'all'\n    end\n  end\n\n  resources :user_sessions\n\n  match 'reports/timesheet' =&gt; 'reports#timesheet', :as =&gt; :timesheet\n  match 'reports/:week/timesheet' =&gt; 'reports#timesheet', :as =&gt; :timesheet_week\n  match 'reports/timesheet_detail' =&gt; 'reports#timesheet_detail', :as =&gt;     :timesheet_detail\n  match 'reports/dashboard' =&gt; 'reports#dashboard', :as =&gt; :dashboard_report\n  match 'reports/timeentries_irregulars' =&gt;    'time_entries_irregulars#timeentries_irregulars', :as =&gt; :timeentries_irregulars\n  match 'reports/:week/timeirregulars' =&gt; 'time_entries_irregulars#timeentries_irregulars', :as =&gt; :timeirregulars_week\n\n  match 'reports/timesheet/admin' =&gt; 'reports#timesheet_admin', :as =&gt; :timesheet_admin\n  match 'reports/:week/timesheet/admin' =&gt; 'reports#timesheet_admin', :as =&gt; :timesheet_admin_week\n\n  match 'reports/time_entries' =&gt; 'time_entries_reports#landing_report'\n  match 'reports/time_entries/make' =&gt; 'time_entries_reports#index'\n  match 'reports/time_entries/csv' =&gt; 'time_entries_reports#make_csv'\n\n  match 'reports/:token' =&gt; 'reports#index', :as =&gt; :reports\n\n  match 'login' =&gt; 'user_sessions#new', :as =&gt; :login\n  match 'logout' =&gt; 'user_sessions#destroy', :as =&gt; :logout\n  match 'register' =&gt; 'users#register', :as =&gt; :register\n\n  resources :companies do\n    collection do\n      get 'settings'      \n      get \"remove_photo\"\n    end\n  end  \n\n  match 'labels/for_project_id/:id' =&gt; 'labels#for_project_id', :as =&gt; :for_project_id\n\n  match 'holidays_for_company/:token' =&gt; 'holidays#public', :as =&gt; :public_holiday_for_company\n  match 'holidays_by_year' =&gt; 'holidays#by_year', :as =&gt; :holidays_by_year\n\n  resources :holidays \n  resources :clients\n\n  resources :invoices do\n    member do\n      get 'pdf_invoice'\n      get 'cancel'\n    end\n    resources :invoice_lines do\n      collection do\n        get 'add'\n      end\n    end\n    resources :payments\n  end\n\n  resources :tweets do\n    resource :tweet_likes, :path =&gt; 'likes' do\n      collection do\n        get 'names'\n      end\n    end\n  end\n\n  match 'select_invoices' =&gt; 'invoices#select_invoices', :as =&gt; :select_invoices\n\n  match 'pusher/auth' =&gt; 'pusher#auth'\n\n  resources :requests, :only=&gt;[:create]\n  match  '*request', :controller =&gt; 'requests', :action =&gt; 'options', :constraints =&gt; {:method =&gt; 'OPTIONS', :format =&gt; 'json'}\nend\n</code></pre>\n\n<p>Thank's in advance.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13209966,"title":"Building full calendar for week schedule planning","body":"<p>I am trying to build a planner for the schedule for 1 week on Rails.</p>\n\n<p>Right now I am looking into the jquery plug-in <a href=\"http://arshaw.com/fullcalendar/\" rel=\"nofollow\">FullCalendar</a>.</p>\n\n<p>It offers a weekly view with different time slots and draggable events, the functionalities which I needed. However, it does planning for a full time range when I only need it for one week.</p>\n\n<p>I am new to jQuery, so I would appreciate it if someone could give me guidance on whether it is a good idea to use this plug in for my application.\nIf it is, how should I go about doing it and if it isn't are there any other better suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","csv","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13209239,"title":"Problems importing a CSV that has a filename as a string in Rails","body":"<p>I'm trying to import a CSV file to my Rails app that's using CarrierWave to handle file uploads. I'm using the <code>CSV</code> gem and populating the Rails database via a seed data.</p>\n\n<p>The issue I'm having is the import doesn't populate the image field of the database. The image column is a string that holds the filename eg. 'this-is-my-photo.jpg'. </p>\n\n<p>I have a database table that has the following columns:</p>\n\n<pre><code># ProductImage model, product_image table\n\nid |     image    |     tile      | product_id | created_at | updated_at \n--------------------------------------------------------------------------\n 1 | image-1.jpg  | Big shoe      |     11     | 2012-08-01 | 2012-08-01\n 2 | 1-photo.png  | Small hat     |     12     | 2012-08-01 | 2012-08-01\n 3 | jeansb1.gif  | Ankle socks   |     13     | 2012-08-01 | 2012-08-01\n\n\n# Import product_image table backup\nCSV.foreach(Rails.root.join(\"db/seeds/product_image.csv\"), headers: true) do |row|\n  ProductImage.create! do |product_image|\n    product_image.id = row[0]\n    product_image.title = row[1]\n    product_image.image = row[2]\n    product_image.product_id = row[3]\n  end\nend\n</code></pre>\n\n<p>The results of <code>db:seed</code> </p>\n\n<pre><code># ProductImage model, product_image table after population of seed data\n\nid |     image    |     tile      | product_id | created_at | updated_at \n--------------------------------------------------------------------------\n 1 |              | Big shoe      |     11     | 2012-11-01 | 2012-11-01\n 2 |              | Small hat     |     12     | 2012-11-01 | 2012-11-01\n 3 |              | Ankle socks   |     13     | 2012-11-01 | 2012-11-01\n</code></pre>\n\n<p>Everything but the <code>image</code> column was populated.</p>\n\n<p>I was wondering if anyone can give me tips on how to go about resolving this import/population issue. Has anyone experienced this problem before and is it because of the the filename type (eg. .jpg)?</p>\n\n<p>Also, I have the same problem when restoring my user model that has an <code>avatar</code> column which is a string that holds the CarrierWave filename.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":19,"score":2,"question_id":13209490,"title":"Increasing Cart quantity RoR","body":"<p>I am trying to create a basic setup in my cart controller that will allow me to incrementally increase the quantity value of products added to the cart if an Item record already exists. </p>\n\n<p>I currently have:</p>\n\n<pre><code>class ItemsController &lt; ApplicationController\n\ndef create  \n    @product = Product.find(params[:product_id])\n\n    if @item.new_record?\n        @item = Item.create!(:cart =&gt; current_cart, :product =&gt; @product, :quantity =&gt; 1, :unit_price =&gt; @product.price)\n    else\n        @item.increment! :quantity\n    end\n    redirect_to cart_path(current_cart.id)\nend\n\nend\n</code></pre>\n\n<p>However I keep getting the error <code>undefined method</code>new_record?' for nil:NilClass`</p>\n\n<p>Any help people can offer to solve this really would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","twitter-bootstrap-rails","bootswatch"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":188,"score":0,"question_id":12775621,"title":"How to add wrapbootstrap (made with twitter bootstrap) themes to rails application","body":"<p>The website <code>https://wrapbootstrap.com/</code> has themes which were made using Twitter Bootstrap. Each of these themes include different versions of Twitter Bootstrap along with other various libraries and versions (jquery, fontawesome, etc...)</p>\n\n<p>How do I add these themes to my existing Rails app? What are the steps?</p>\n\n<p>I'm especially curious about the conflicts that may arrise if I'm already using a different version of jquery, twitter bootstrap, fontawesome, and others (as declared in the Gemfile).</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails-3","thin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13208965,"title":"Installing thin (1.5.0) with native extensions \"...ERROR: Failed to build gem native extension.\"","body":"<p>I have a new project need to use thin but there is something wrong. \nIn my Gemfile.</p>\n\n<pre><code>gem 'thin'\n</code></pre>\n\n<p>And then I run \"bundle install\". It shows:</p>\n\n<pre><code>......\nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /usr/local/Cellar/ruby/1.9.3-p194/bin/ruby extconf.rb \nchecking for main() in -lc... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/local/Cellar/ruby/1.9.3-p194/bin/ruby\n    --with-thin_parser-dir\n    --without-thin_parser-dir\n    --with-thin_parser-include\n    --without-thin_parser-include=${thin_parser-dir}/include\n    --with-thin_parser-lib\n    --without-thin_parser-lib=${thin_parser-dir}/lib\n    --with-clib\n    --without-clib\n/usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\nYou have to install development tools first.\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:461:in `try_link0'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:476:in `try_link'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:619:in `try_func'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:845:in `block in have_library'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'\n    from /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:840:in `have_library'\n    from extconf.rb:4:in `&lt;main&gt;'\n\n\nGem files will remain installed in /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/thin-1.5.0 for inspection.\nResults logged to /usr/local/Cellar/ruby/1.9.3-p194/lib/ruby/gems/1.9.1/gems/thin-1.5.0/ext/thin_parser/gem_make.out\nAn error occured while installing thin (1.5.0), and Bundler cannot continue.\nMake sure that `gem install thin -v '1.5.0'` succeeds before bundling.\n</code></pre>\n\n<p>Please help me to solve this problem. I once installed thin before, but I don't know why fail this time.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13206638,"title":"Token authentication in devise not working even after adding token_authenticatable to devise","body":"<p>I have devise for authentication and the following are the steps i did and token authentication not working</p>\n\n<ol>\n<li>added <code>devise</code> to gem file</li>\n<li>rails generate devise:install</li>\n<li>rails generate devise User</li>\n<li>rake db:migrate</li>\n<li>rails generate devise:views</li>\n<li>rails generate controller home index</li>\n</ol>\n\n<p>and upto this there is no problem and then i added <code>devise:token_authenticatable</code> to user model and then i added <code>before_save :ensure_authentication_token</code>and then</p>\n\n<ol>\n<li>rails generate migration AddTokenAuthenticatableToUser authentication_token:string</li>\n</ol>\n\n<p>then added attr_accessible :authentication_token to the user model</p>\n\n<p>but</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'xxxxxxxx'}}\"\n</code></pre>\n\n<p>is not working. It displays error in terminal. pls tell me what should i do to get the token of user and use it in subsequent request?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>It saves authentication token in user table when creating new user from web app but could not register a new user from terminal or get the token for the user to authenticate using the token.</p>\n"},{"tags":["jquery","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13201411,"title":"Use jquery .before(); method in rails","body":"<p>I want to repeat a form element using jquery's .before(); method , so that users of the form can add more ingredients in this case to their recipe.</p>\n\n<p>So far I have come up with this, however I cant use ruby code in a js file</p>\n\n<pre><code> $('document').ready(function() {\n  var ingredient = '&lt;%= f.text_field :ingredients, :class =&gt; :ingred %&gt;&lt;br&gt;';\n   $('#addIngredient').click(function(e) {\n    e.preventDefault();\n     $(this).before(ingredient);\n\n   })\n  });\n</code></pre>\n\n<p>I have done it using html5 and had it working doing this </p>\n\n<pre><code>   $('document').ready(function() {\n\n            var ingredient = '&lt;input class=\"ingredients\" name=\"ingredients\" type=\"text\" placeholder=\"Enter Ingredients Here\"&gt;&lt;br&gt;';\n             $('#addingredient').click(function(event) {\n               event.preventDefault();\n                $(this).before(ingredient);\n\n                 })\n               });\n</code></pre>\n\n<p>Im just having trouble getting this to fit in with my ruby form</p>\n\n<p>at the moment i get this outputted to the page rather than the text field</p>\n\n<pre><code>     &lt;%= f.text_field :ingredients, :class =&gt; :ingred %&gt;\n</code></pre>\n\n<p>Can anyone help? Much appreciated</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","nested-forms","simple-form"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":967,"score":1,"question_id":8415934,"title":"Rails simple_form association select with create option","body":"<p>I have a form with a belongs_to assocation, and I'd like the user to be able to either select from their addresses, or create a new one. It breaks when the form has validation errors because of conflicting information in the parameters, i.e.</p>\n\n<pre><code>\"transaction\" =&gt; { \"address_id\" = \"25\", \n    \"address_attributes\" =&gt; { \"id\" =&gt; \"25\" } } \n</code></pre>\n\n<p>I've simplified relevant files:</p>\n\n<p>Transaction.rb</p>\n\n<pre><code>class Transaction &lt; ActiveRecord::Base\n  belongs_to :address\n  accepts_nested_attributes_for :address\nend\n</code></pre>\n\n<p>Address.rb</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  has_many :transactions\nend\n</code></pre>\n\n<p>Transaction#new view</p>\n\n<pre><code>&lt;%= simple_form_for @transaction do |f| %&gt;\n\n  &lt;%= f.association :address, :collection =&gt; current_user.addresses,\n    :include_blank =&gt; \"Enter new address\",\n    :value_method =&gt; :id %&gt;\n\n  &lt;%= f.simple_fields_for :address do |address_fields| %&gt;\n    &lt;%= address_fields.input :line1 %&gt;\n    &lt;%= address_fields.input :line2 %&gt;\n    &lt;%= address_fields.input :city %&gt;\n    &lt;%= address_fields.input :state %&gt;\n    &lt;%= address_fields.input :zip, :label =&gt; \"Zip / Post Code\" %&gt;\n  &lt;% end %&gt;\n\n  &lt;%= f.submit \"Confirm\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Transaction#create controller</p>\n\n<pre><code>def create\n  trans_params = {}\n  if params[:transaction][:address_id].blank? &amp;&amp; !params[:transaction][:address_attributes].nil?\n    trans_params[:address_attributes] = params[:transaction][:address_attributes]\n  elsif !params[:transaction][:address_id].nil?\n    trans_params[:address_id] = params[:transaction][:address_id]\n  end\n\n  @transaction = Transaction.new(trans_params)\nend\n</code></pre>\n\n<p>Of course there is a chunk of code missing but I think these are the only relevant sections. The problem I'm having is, when you submit the form and there is validation errors, simple_form automatically adds <code>&lt;input id=\"transaction_address_attributes_id\" name=\"transaction[address_attributes][id]\" type=\"hidden\" value=\"25\"&gt;</code> to the end of my form, causing the parameters to clash and giving the error:</p>\n\n<pre><code>Couldn't find Address with ID=25 for Transaction with ID=\n</code></pre>\n\n<p>I imagine there is a much better way of dealing with the params in the controller. Any ideas? I have considered using javascript to remove and re-render the \"address attributes\" form but I'd rather not rely on javascript.</p>\n"},{"tags":["ruby-on-rails-3","radio-button"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13208604,"title":"Rails 3, checked radio button with if function","body":"<p>I have a radio button within my form as follows</p>\n\n<pre><code>    &lt;div class=\"btn-group\" data-toggle=\"buttons-radio\"&gt;\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2007' %&gt; 2007\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2008' %&gt; 2008\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2009' %&gt; 2009\n    &lt;/div&gt;\n</code></pre>\n\n<p>I am using twitter bootstrap</p>\n\n<p>I want to do something like the following:</p>\n\n<pre><code>    &lt;div class=\"btn-group\" data-toggle=\"buttons-radio\"&gt;\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2007', if @dates.start_year == 2007 :checked =&gt; true end %&gt; 2007\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2008', if @dates.start_year == 2008 :checked =&gt; true end %&gt; 2008\n      &lt;%= f.radio_button :start_year, :class=&gt; \"btn\", :value=&gt; '2009', if @dates.start_year == 2009 :checked =&gt; true end %&gt; 2009\n    &lt;/div&gt;\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<pre><code>syntax error, unexpected keyword_ensure, expecting ')'\nsyntax error, unexpected keyword_end, expecting ')'\n</code></pre>\n\n<p>I must be making a mistake in the if statement within the radio button, but I'm not sure how exactly to correct this</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","date"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13208413,"title":"Subtracting two dates in ruby on rails","body":"<p>I'm subtracting two dates in my model in this way:-</p>\n\n<pre><code>  def total_days\n      self.to_date - self.from_date\n  end\n</code></pre>\n\n<p>My date is in <code>Mysql  Date</code> (YYYY-MM-DD)format.</p>\n\n<p>When displaying my date in view it is giving me <code>5/1</code> days. Even though 5 is correct it is appending <code>'/1'</code> to the days. How can i remove this. Is there any better way of doing it?</p>\n"},{"tags":["ruby-on-rails-3","video-capture"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":1,"view_count":753,"score":3,"question_id":6978578,"title":"Video Recording with webcam on a webpage","body":"<p>I have a requirement of recording video via web cam, on my webpage. What are the available plugins for the same. My website is developed using Ruby on Rails framework</p>\n\n<p>Regards,\nPankaj</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","font-face","mime-types"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13204752,"title":"Chrome warning: Resource interpreted as Font but transferred with MIME type font/svg","body":"<p>I get the following warning in Chrome dev tools about a base64 encoded font which is embedded in one of the CSS files in a site I'm working on.</p>\n\n<pre><code>Resource interpreted as Font but transferred with MIME type font/svg: \"data:font/svg;charset=utf-8;base64,PD94bWwgd -- big base64 encoded string -- 2RlZnM+PC9zdmc+\"\n</code></pre>\n\n<p>In the CSS, the font is inserted like this:</p>\n\n<pre><code>@font-face {\n  font-family: 'PrintBelt';\n  src: url('data:font/svg;charset=utf-8;base64,PD94bWwgd -- big base64 encoded string -- 2RlZnM+PC9zdmc+\") format('svg'), url('data:font/ttf;charset=utf-8;base64,AAEAAAANAIAA -- other big base64 encoded string -- AAAAzLVVtw==') format('truetype');\n}\n</code></pre>\n\n<p>I've searched around and found some blog posts and SO questions which aim to explain how to fix this problem. None of them seem to deal with fonts which are embedded in the CSS however.</p>\n\n<ol>\n<li><a href=\"http://stackoverflow.com/questions/2871655/proper-mime-type-for-fonts\">Proper mime type for fonts</a></li>\n<li><a href=\"http://danhunter.co.uk/articles/3-ha-in-your-font-face\" rel=\"nofollow\">Ha! In your font-face</a></li>\n</ol>\n\n<p>What can I change in either Rails (3.2.8) or the CSS in order to silence this warning?</p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-ui","jquery-autocomplete","jquery-ui-autocomplete"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13207190,"title":"rails3-jquery-autocomplete - highlight search term in results","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2435964/jqueryui-how-can-i-custom-format-the-autocomplete-plug-in-results\">jQueryUI: how can I custom-format the Autocomplete plug-in results?</a>  </p>\n</blockquote>\n\n\n\n<p>I cannot find my way in the autocomplete-rails.js uncompressed file</p>\n\n<p>What part of the code should I change so I'll have the results have the search term marked?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12891790,"title":"Will returning a nil value from a block passed to Rails.cache.fetch clear it?","body":"<p>Let's suppose I have a method like this:</p>\n\n<pre><code>  def foo\n    Rails.cache.fetch(\"cache_key\", :expires_in =&gt; 60.minutes) do\n      return_something\n    end\n  end\n</code></pre>\n\n<p><code>return_something</code> sometimes returns a <code>nil</code> value. When this happens, I don't want the <code>nil</code> value to be cached for 60 minutes. Instead, the next time I call <code>foo</code>, I want the block passed to <code>fetch</code> to be executed again.</p>\n\n<p>Is <code>Rails.cache.fetch</code> working like this by default? Or do I have to implement this functionality?</p>\n\n<h1>Update (with Answer)</h1>\n\n<p>Turns out, the answer was no, at least when using Memcached.</p>\n"},{"tags":["jquery","ruby-on-rails-3","document-ready"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":68,"score":3,"question_id":13206916,"title":"Why does $(document).ready() never fire but $(window).load() will?","body":"<p>I'm working with Rails 3.2.8 and am running jQuery v1.8.2. </p>\n\n<p>The following works:</p>\n\n<pre><code>$(window).load(function(){\nalert('window load is working');\n});\n</code></pre>\n\n<p>But this does not work:</p>\n\n<pre><code>$(document).ready(function() {\nalert('document ready is working');\n});      \n</code></pre>\n\n<p>In fact, whenever I switch <code>$(document).ready()</code> with <code>$(window).load()</code> for any and all jQuery functions I am testing, they are fired. These include accordions, draggable elements... </p>\n\n<p>Here is my <strong>application.html.erb</strong> file:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;&lt;%= full_title(yield(:title)) %&gt;&lt;/title&gt;\n&lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n&lt;%= javascript_include_tag \"application\" %&gt;\n&lt;%= csrf_meta_tags %&gt;\n&lt;/head&gt;\n&lt;body background=\"&lt;%= image_path(random_bg) %&gt;\"&gt;\n&lt;%= render 'layouts/header' %&gt;\n\n&lt;div id=\"container\"&gt;\n\n&lt;% flash.each do |key, value| %&gt;\n      &lt;div class=\"alert alert-&lt;%= key %&gt;\"&gt;&lt;%= value %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%= yield %&gt;\n&lt;/div&gt;\n &lt;%= render 'layouts/footer' %&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>The resulting html...</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Derp&lt;/title&gt;\n*bunch of css files*\n&lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery-ui.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/collections.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/global.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/derp.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/sessions.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/static_pages.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/test.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/users.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n....\n</code></pre>\n\n<p>I have also gone throw stackoverflow, searched the web neurotically, and tried all the solutions I could find:</p>\n\n<ul>\n<li>I have tried disabling local jQuery and using Google to host jQuery</li>\n<li>I have tried playing around with the placement of <code>javascript_include_tag</code> (moving it above stylesheets, moving it before )</li>\n<li>I tried including <code>$(document).ready()</code> inside <code>$(window).load()</code></li>\n</ul>\n\n<p>But <code>$(document).ready()</code> still does not fire... There are no problems in console (checked on Chrome, Safari, Firefox)</p>\n\n<p>A similar question was asked <a href=\"http://stackoverflow.com/questions/6022357/why-does-window-load-work-but-not-document-ready\">here</a>, but he never received an answer to his main question.</p>\n\n<p><strong>Why does jQuery only work when I replace <code>$(document).ready()</code> with <code>$(window).load()</code>?</strong></p>\n"},{"tags":["ruby-on-rails-3","wkhtmltopdf","pdfkit"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":56,"score":2,"question_id":12312591,"title":"How to use WKhtmltopdf Library without using executable","body":"<p>In ruby on rails project.</p>\n\n<p>I am using <strong>PDFKit</strong> gem for generating pdf reports</p>\n\n<pre><code>PDFKit uses wkhtmltopdf executable which is to be installed on the machine .\n</code></pre>\n\n<ul>\n<li><p>And next step to give the path of the executable .</p></li>\n<li><p>I <strong>dont want  to use the executable file</strong> .because if i use it how to deploy it on server .</p></li>\n<li><p>the server will need to install it on its local and give the path.</p></li>\n</ul>\n\n<p>Is it possible to use only library????</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":6,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":3019,"score":1,"question_id":7526424,"title":"How to start rails server?","body":"<p>I am developing <strong>rails 2.3.2</strong> application.</p>\n\n<p>When I type the command \"<em>rails script/server</em>\"</p>\n\n<p>I got the following output instead of server starting why?</p>\n\n<pre><code>rails script/server\nUsage:\n  rails new APP_PATH [options]\n\nOptions:\n  -J, [--skip-javascript]        # Skip JavaScript files\n      [--dev]                    # Setup the application with Gemfile pointing to your Rails checkout\n      [--edge]                   # Setup the application with Gemfile pointing to Rails repository\n  -G, [--skip-git]               # Skip Git ignores and keeps\n  -m, [--template=TEMPLATE]      # Path to an application template (can be a filesystem path or URL)\n  -b, [--builder=BUILDER]        # Path to a application builder (can be a filesystem path or URL)\n      [--old-style-hash]         # Force using old style hash (:foo =&gt; 'bar') on Ruby &gt;= 1.9\n      [--skip-gemfile]           # Don't create a Gemfile\n  -d, [--database=DATABASE]      # Preconfigure for selected database (options: mysql/oracle/postgresql/sqlite3/frontbase/ibm_db/jdbcmysql/jdbcsqlite3/jdbcpostgresql/jdbc)\n                                 # Default: sqlite3\n  -O, [--skip-active-record]     # Skip Active Record files\n      [--skip-bundle]            # Don't run bundle install\n  -T, [--skip-test-unit]         # Skip Test::Unit files\n  -S, [--skip-sprockets]         # Skip Sprockets files\n  -r, [--ruby=PATH]              # Path to the Ruby binary of your choice\n                                 # Default: /home/xichen/.rvm/rubies/ruby-1.8.7-p352/bin/ruby\n  -j, [--javascript=JAVASCRIPT]  # Preconfigure for selected JavaScript library\n                                 # Default: jquery\n\nRuntime options:\n  -q, [--quiet]    # Supress status output\n  -s, [--skip]     # Skip files that already exist\n  -f, [--force]    # Overwrite files that already exist\n  -p, [--pretend]  # Run but do not make any changes\n\nRails options:\n  -h, [--help]     # Show this help message and quit\n  -v, [--version]  # Show Rails version number and quit\n\nDescription:\n    The 'rails new' command creates a new Rails application with a default\n    directory structure and configuration at the path you specify.\n\nExample:\n    rails new ~/Code/Ruby/weblog\n\n    This generates a skeletal Rails installation in ~/Code/Ruby/weblog.\n    See the README in the newly created application to get going.\n</code></pre>\n\n<p>When I type linux command \"ls\" I got the following directories and files showing:</p>\n\n<pre><code>app  Capfile  config  criptq  db  doc  features  Gemfile  Gemfile.lock  generate  lib  log  nbproject  public  Rakefile  README  script  spec  test  tmp  vendor\n</code></pre>\n\n<p>my <strong>Gemfile</strong> is:</p>\n\n<pre><code>source \"http://rubygems.org\"\n\ngem \"rails\", \"2.3.2\"\ngem \"mysql\", \"2.8.1\"\ngem \"fastercsv\"\ngem \"will_paginate\", \"2.3.16\"\ngem \"chronic\", \"0.6.4\"\ngem \"whenever\", \"0.4.1\"\ngem \"searchlogic\", \"2.4.28\"\n\ngroup :development do\n  gem \"mongrel\", \"1.1.5\"\nend\n\ngroup :test do\n  gem \"rspec\", \"1.3.2\"\n  gem \"rspec-rails\", \"1.3.4\"\n  gem \"factory_girl\", \"1.3.3\"\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","backbone.js"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":136,"score":2,"question_id":12497897,"title":"Testing JSON API in Rails 3.2 using rspec using exact PUT/POST bodies as Backbone would send","body":"<p>I'm trying to write a set of rspec tests for a JSON API written in Rails 3.2 with Backbone as the front end. The tests I'm writing are specifically for the Rails controllers.</p>\n\n<p>Now, the application itself is working fine. When a client issues a PUT request with the body:</p>\n\n<pre><code>{\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n}\n</code></pre>\n\n<p>Everything is great. In the background Rails will take that body, then transform it into:</p>\n\n<pre><code>{\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n  \"model_name\" =&gt; { ... }\n}\n</code></pre>\n\n<p>where the hash \"model_name\" points to contains the attribute values it can automatically figure out from the input. All is well.</p>\n\n<p>When I try the same exact request from the testing environment, all is not well. If I create a hash that is exactly the same PUT body hash as above, but in rspec:</p>\n\n<pre><code>@update_json = {\n  \"id\":1,\n  \"name\":\"updated product set\",\n  ...\n}\nheader \"Accept\",\"application/json\"\nheader \"Content-type\",\"application/json\"\nput :update, @update_json\n</code></pre>\n\n<p>Things do not work out at all. In the controller, if I inspect the params variable I get:</p>\n\n<pre><code>{ \"model_name\" =&gt; {} }\n</code></pre>\n\n<p>If I omit the \"Content-type\" header line, I get instead @update_json, but without the Rails manipulation that creates the \"model_name\" mapping which I require in my controller.</p>\n\n<p>The only way I've gotten a successful test to run is the following:</p>\n\n<pre><code>@update_json = {\n  :format =&gt; \"json\",\n  \"id\":1,\n  \"model_name\" =&gt; {\n      \"id\":1,\n      \"name\":\"updated product set\",\n      ...\n  }\n}\nheader \"Accept\",\"application/json\"\nput :update, @update_json\n</code></pre>\n\n<p>However, this is not a real-world test since it's not testing the exact PUT body that would be sent by my backbone front-end.</p>\n\n<p>Any ideas?</p>\n\n<p>UPDATE:\nFrom looking around it <em>looks</em> like you can't actually do a real HTTP request from rspec; it's just mocked up. For example, you can't get the system to respond with a 404 since Rails throws an Exception that would normally be caught by Rails network stack and turned into a 404 but which isn't with Rspec. So the problem looks deeper than what's above...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13206248,"title":"Sorting table by both column and row Rails","body":"<p>Here, I want to set up a weekly planner where I will later insert plans into.</p>\n\n<p>I have the columns sorted by the days of the week.(Monday, Tuesday...)\nNow, I want the row to be sorted by the time. </p>\n\n<p>However, with my code below. For every column, it loops through the same number of times as the number of items in my time slot.</p>\n\n<p>Would appreciate it if you could give me some guidance on how I should go about fixing it such that each timeslot only appears once throughout the whole table.</p>\n\n<p>The codes</p>\n\n<pre><code>&lt;table class=\"Time Table\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;&lt;%= \"Time\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Monday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Tuesday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Wednesday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Thursday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Friday\" %&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;%= \"Saturday\" %&gt;&lt;/th&gt;\n\n &lt;/tr&gt;\n  &lt;% @time_slots.each do |time_slot| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Monday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Tuesday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Wednesday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Thursday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Friday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;% if time_slot.dayOfWeek = \"Saturday\" %&gt;&lt;%= time_slot.startTime %&gt;&lt;% end %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13190459,"title":"Formatting JSON output using map method - Rails 3","body":"<p>I'm lacking some understanding on using the map method. </p>\n\n<p>Using json output with no mapping</p>\n\n<pre><code>format.json  { render :json =&gt; @categories }\n</code></pre>\n\n<p>gives me the following output</p>\n\n<pre><code>[{\"created_at\":\"2012-10-20T01:16:35+11:00\",\"id\":1,\"name\":\"bathroom renovations\",\"updated_at\":\"2012-10-20T01:16:35+11:00\"}]\n</code></pre>\n\n<p>using json with mapping</p>\n\n<pre><code>format.json  { render :json =&gt; @categories.map(&amp;:name) }\n</code></pre>\n\n<p>gives me this output</p>\n\n<pre><code>[\"bathroom renovations\"]\n</code></pre>\n\n<p>How can I get my output to look like</p>\n\n<pre><code>[{\"id\":\"1\",\"name\":\"bathroom renovations\"}]\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13206348,"title":"Rails flash messages not clearing","body":"<p>Here is my environment: Rails 3.2.0 and Ruby 1.9.2.</p>\n\n<p>After upgrading my session storage to database, none of my flash messages are clearing after any requests.  If I revert back to cookie session storage, flash messages are clearing as expected.  Has anyone encountered this problem?</p>\n\n<p>Thanks!</p>\n\n<p>Paul</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","jquery-autocomplete","acts-as-taggable-on"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13199708,"title":"acts_as_taggable_on and rails autocomplete gem - displaying tag counts","body":"<p>I am using the acts_as_taggable_on gem and the rails jquery autocomplete gem</p>\n\n<p>I know how to get the tag counts via the gem</p>\n\n<p>I know that in order to display something else other than the return search results for the autocomplete I need to do something like this</p>\n\n<pre><code>autocomplete :tag, :name, :class_name =&gt; 'ActsAsTaggableOn::Tag', :full =&gt; true\n</code></pre>\n\n<p>and adding 2 more keys which are </p>\n\n<pre><code>:extra_data , :display_value\n</code></pre>\n\n<p>the extra data will retrieve the more data in the search (not sure it is needed here)\nthe display_value will call a method from within the model which is searched with the autocomplete.</p>\n\n<p><strong>The problem:</strong></p>\n\n<p>I don't know where to put the method for the display_value which should be something like</p>\n\n<pre><code>def tags_with_counts\n \"#{tag.name} x #{tag.count}\nend\n</code></pre>\n\n<p>As I don't have a tag model file to put it in (since the acts_as_taggable_on does not generate such file.</p>\n\n<p>But even if I did have such file, from previous experiments, that method can only use data that is retrieved with the autocomplete search, and I don't have a column with tag counts.</p>\n\n<p>What do I do to solve this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":10,"favorite_count":23,"up_vote_count":51,"down_vote_count":0,"view_count":18809,"score":51,"question_id":5968131,"title":"Upgrading from Rails 3 to Rails 3.1","body":"<p>How do you upgrade from Rails 3 to Rails 3.1 beta?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":818,"score":1,"question_id":5629309,"title":"Passing virtual attribute values through to form elements in Rails 3","body":"<p>I have the following in my model:</p>\n\n<blockquote>\n  <p>before_validation :update_temp</p>\n  \n  <p>attr_accessor :temp_int, :temp_dec</p>\n  \n  <p>def update_temp</p>\n  \n  <blockquote>\n    <p>self.temp = temp_int.to_f + (temp_dec.to_f / 10)</p>\n  </blockquote>\n  \n  <p>end</p>\n</blockquote>\n\n<p>And I have the following in my view:</p>\n\n<blockquote>\n  <p>&lt;%= f.select(:temp_int, [\"97\", \"98\"], { :include_blank => true })%> . </p>\n  \n  <p>&lt;%= f.select(:temp_dec, [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"], { :include_blank => true })%></p>\n</blockquote>\n\n<p>This works great for saving the temperature values. However, there's one issue. Normally on the edit screen, the select helper would have the existing values pre-selected. But using the virtual attributes this isn't happening.</p>\n\n<p>How do I make sure that the temp_int and temp_dec values get passed to the view?</p>\n"},{"tags":["ruby-on-rails-3","model"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13203842,"title":"associated models in rails 3","body":"<p>I think I may be missing something here or my understanding of rails model association isnt quite there yet (still learning). I have two models, a recipe and a ingredient. A recipe has many ingredients, and when i fill my form in i want to post recipe and ingredient params to their respective dbs</p>\n\n<p>Recipe Model</p>\n\n<pre><code> class Recipe &lt; ActiveRecord::Base\n\n attr_accessible :dish_name, :country_of_origin, :difficulty, :preperation_time\n has_many :ingredients\n\n end\n</code></pre>\n\n<p>Ingredients Model</p>\n\n<pre><code> class Ingredient &lt; ActiveRecord::Base\nbelongs_to :recipe\nattr_accessible :ingredients\nend\n</code></pre>\n\n<p>recipe controller</p>\n\n<pre><code> def new \n\n @recipe = Recipe.new\n\n end\n\n def create\n\n @recipe = Recipe.new(params[:recipe])\n if @recipe.valid?\n @recipe.save\n redirect_to recipes_path, :notice =&gt; \"Recipe sucessfully created.\"\n else\n flash.now.alert = \"Please ensure all fields are filled in.\"\n render :new\n\n end\nend\n</code></pre>\n\n<p>Ingredients Controller</p>\n\n<pre><code>  def new\n  @ingredient = recipes.find(params[:recipes_id].ingredients.new\n  @recipe_id = params[:recipe_id]\n  end\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;%= form_for @recipe  do |f| %&gt;\n\n&lt;%= f.label :dish_name, \"Dish Name\" %&gt;\n&lt;%= f.text_field :dish_name, :placeholder =&gt; \"Enter Dish Name\" %&gt;\n\nmore fields here(wanted to keep as short as poss)\n\n&lt;%= f.label :ingredients, \"Ingredients\" %&gt;\n&lt;%= f.text_field :ingredients , :class =&gt; :ingred, :placeholder =&gt; \"Enter Ingredient Here\" %&gt;&lt;br&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Apologies for the size of the code, is anything else needed to see why i cannot create a recipe?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","http","http-headers","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":13205814,"title":"How to make a DELETE link to a rails resource?","body":"<p>If I want to make a DELETE link in rails, I write the following code (in this example case to delete a user session in Devise):</p>\n\n<pre><code>&lt;%= link_to('Logout', destroy_user_session_path, :method =&gt; :delete) %&gt;\n</code></pre>\n\n<p>That will turn into the following HTML:</p>\n\n<pre><code>&lt;a rel=\"nofollow\" data-method=\"delete\" href=\"/users/sign_out\"&gt;Logout&lt;/a&gt;\n</code></pre>\n\n<p>Works great, except I can't simply put that HTML into a static HTML page. It will simply do a GET request. I assume Rails includes some standard Javascript to turn the above link to one that actually does a DELETE request. So what's the proper way to have a link on a static HTML page to a Rails resource that does a DELETE action? Should I find and grab that Javascript Rails includes in all webpages that does this? Is there a better way?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13201522,"title":"Best way to duplicate parent and associated child records in Ruby on Rails?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/6711956/activerecord-how-can-i-clone-nested-associations\">ActiveRecord: How can I clone nested associations?</a>  </p>\n</blockquote>\n\n\n\n<p>I have a table with <code>invoices</code> which in turn can have many <code>items</code>.</p>\n\n<p>Now in my <code>invoices</code> index view I would like to place a link next to each <code>invoice</code> saying <em>Duplicate Invoice</em>.</p>\n\n<p>Without the child records this would be quite easy:</p>\n\n<pre><code>&lt;%= link_to \"Duplicate\", new_invoice_path(invoice.attributes) %&gt;\n</code></pre>\n\n<p>But how can this be done if the invoice's <code>items</code> should be duplicated as well?</p>\n\n<p>As a Rails newbie I can't get my head around this. Can all this be handled by the <code>new</code> action inside my controller?</p>\n\n<pre><code>def new\n  @invoice = current_user.invoices.build(:project_id =&gt; params[:project_id])\n  @title = \"New invoice\"\nend\n</code></pre>\n\n<p>Or do I need to create another function named e.g. <code>copy</code> inside my controller?</p>\n\n<p>What is the best practice?</p>\n\n<p>Thanks for any input...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13202585,"title":"ticket booking engine rails","body":"<p>Im trying o set up an rails application that handles ticket booking system for e venue.\nDoes anybody have any suggestions about architecture, gems or general approach yhat could help? Would be grateful for suggestions.</p>\n"},{"tags":["javascript","arrays","ruby-on-rails-3","view"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13190596,"title":"mongomapper and rails view for array","body":"<p>i have a rails controller grabbing some data from mongodb. the field i'm interested in is actually an array and i would like to expose this in an erb view.</p>\n\n<p>my current hack is to just set the javascript variable in the view directly (where item.array = [ \"one\", \"two\" ]):</p>\n\n<pre><code>var array = &lt;%= item.array %&gt;;\n</code></pre>\n\n<p>however, i see that the code is coming out escaped such that the html is coming out like</p>\n\n<pre><code>var array = [&amp;quot;one&amp;quot;, &amp;quot;two&amp;quot;];\n</code></pre>\n\n<p>is there a helper function i can use so that i can set the array directly in the javascript?</p>\n\n<p>(long term is to move this into a json call, but i just want to get something working for now)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-forms","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13204661,"title":"RoR: Nested forms and dynamic fields","body":"<p>I am struggling with some nested forms which dynamically inserts fields. I have based my code on Ryan Bates great railscasts.  My problem though is that I need to move my \"add fields\" button outside the nested form.  This causes problems because I don't have access to some of the objects required to generate the form.</p>\n\n<p>In the code below the add/remove button is in the same location.  I can change the if statement to do this, but I cannot move the add fields button outside the f.simple_fields_for :fund_levels loop.</p>\n\n<p>Any suggestions for a clean way of doing this?</p>\n\n<p>The view</p>\n\n<pre><code>     = f.simple_fields_for :fund_levels do |fl|\n       - fl.object.id ? headerappend = fl.object.id : headerappend = \"#{i}-notset\"\n       %div{id: \"flheader-#{headerappend}\"}\n         %div\n           = link_to \"Sponsor levels\", \"#\", :class =&gt; \"show_hide\", :id =&gt; \"initiator1_fl#{i}\", :style=&gt;\"margin-bottom:2px;\", :onclick=&gt;\"return false\"\n         %div{:class =&gt; \"slidingDiv #{fund_levels_last?(i, @fund_level_count) ? \"shown\": \"hidd\" } whitebg leftadj\", :id=&gt;\"body_fl#{i}\", :style=&gt;\"width:100%;\" }\n\n           = render :partial =&gt; 'fund_level_fields', :locals =&gt; {:fl =&gt; fl, :ad =&gt; ad, :i =&gt; i, :f =&gt; f}\n           %div{:style =&gt; \"float: right; padding: 20px 20px 20px 0\"}\n             = fund_levels_last?(i, @fund_level_count) ? ( link_to_add_fields \"add new level\", f, :fund_levels, fl, i+1, ad ) : ( link_to \"remove\", accounts_ad_fund_level_path(ad, fl.object.id), {:class =&gt; 'button orange sm', :method =&gt; :delete, :remote =&gt; true, :confirm =&gt; t('q.are_you_sure')} )\n       - i += 1\n     %div#newfields\n       - # THE BUTTON SHOULD GO HERE if it is an ADD FIELDS (remove btn should stay above)\n</code></pre>\n\n<p>the application_helper file</p>\n\n<pre><code>   def link_to_add_fields(name, f, association, sublevel, counter, parent)\n\n     new_object = f.object.class.reflect_on_association(association).klass.new\n     fields = f.fields_for(association, new_object, :child_index =&gt; \"new_#{association}\") do |builder|\n       render(association.to_s.singularize + \"_fields\", :f =&gt; builder, :fl =&gt; sublevel, :i =&gt; counter, :ad =&gt; parent) #fl, i, ad\n     end\n\n     # this bit is required because of some bugs in haml\n     fields.gsub!(/\\&lt;haml\\:newline\\/\\&gt;/, '').html_safe\n\n     link_to name, '#', :id =&gt; \"#{name}|-|#{association}|-|#{fields}\", :class =&gt; \"addfields\", :onclick =&gt; \"return false\"\n   end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","json","internet-explorer","cors"],"answer_count":2,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":1248,"score":3,"question_id":8501021,"title":"Rails JSON request is not parsed correctly into post parameters","body":"<p>I'm trying to debug a problem where Rails isn't decoding the JSON POST data.</p>\n\n<p>The server logs show:</p>\n\n<pre><code>2011-12-14T06:44:44+00:00 app[web.2]: Started POST \n2011-12-14T06:44:44+00:00 app[web.2]:   Processing by PostsController#create as */*\n2011-12-14T06:44:44+00:00 app[web.2]:   Parameters: {\"{\\\"athlete_id\\\":\\\"\\\",\\\"known_as\\\":\\\"abc\\\",\\\"email\\\":\\\"abc@defg.com\\\",\\\"result\\\":\\\"112233\\\",\\\"rx\\\":false,\\\"mods\\\":\\\"thkjth\\\",\\\"notes\\\":\\\"\\\"}\"=&gt;nil, \"affiliate_id\"=&gt;\"testaffiliate\", \"wod_id\"=&gt;\"12345\"}\n</code></pre>\n\n<p>Note that the JSON string is not being parsed - Rails is assigning it as a key in the hash, pointing to a nil value.  Does anyone have any ideas before I write a before_filter that tries to JSON.parse all of the params keys?</p>\n\n<p>I don't think this is relevant since I'm sending and receiving data okay, but this problem occurs during a CORS Request from IE (using XDomainRequest).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13188117,"title":"send_file return value","body":"<p>Does the <code>send_file</code> method in Rails give a return value? I'd like to do one thing if the sending is successful, and another thing if the sending is <em>not</em> successful. I looked at the documentation at <a href=\"http://apidock.com/rails/ActionController/Streaming/send_file\" rel=\"nofollow\">this link</a>, but did not find anything relevant.</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":3,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":1027,"score":8,"question_id":7027518,"title":"No route matches rspec's anonymous controller","body":"<p>Based on my understanding of the <a href=\"http://relishapp.com/rspec/rspec-rails/v/2-1/dir/controller-specs/anonymous-controller\">rspec spec</a>, I would expect the following example to pass.</p>\n\n<pre><code>describe ApplicationController do\n\n  controller do\n    def test\n    end\n  end\n\n  it \"calls actions\" do\n    get :test\n  end\n\nend\n</code></pre>\n\n<p>Instead it fails with:</p>\n\n<pre><code>No route matches {:controller=&gt;\"anonymous\", :action=&gt;\"test\"}\n</code></pre>\n\n<p>I've even tried defining the route for the \"anonymous\" controller in the routes file but to no avail. Is there something I'm missing here? This should work, shouldn't it?</p>\n"},{"tags":["ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":13071804,"title":"simple_form - how do I create radio buttons with nested input text boxes","body":"<p>I'm using simple_form to render my forms and trying to get the following behavior: I want the client to choose from 3 options. In every option he supplies additional field or two.<br>\nSo I'd like something like this:</p>\n\n<pre><code>Please set your preferences:  \n o Pay me on a specific day - [input field to get the day]  \n o Pay me a specific amount of money - [input field for the amount]  \n o Pay me on a regular basis - [radio buttons to choose between weekly/monthly basis]\n</code></pre>\n\n<p>I can create the radio buttons as follows, but can't add nested fields under them:</p>\n\n<pre><code>&lt;%= simple_form_for @client, action: 'edit_payment_method' do |f| %&gt;\n    &lt;%= f.input :payment_type, label: 'Please set your preferences:',\n        collection: [ ['Pay me on a specific day', :specific_day],\n        ['Pay me a specific amount of money', :specific_money],\n        ['Pay me on a regular basis', :regular_basis]\n     ], as: :radio_buttons %&gt;\n\n  &lt;%= f.button :submit, 'Submit' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What would be the best way to create the nested text boxes?<br>\nAs for the fields, I don't need to send them to different controllers (per payment_type), it's fine if I send them all to one method and read the relevant values according to the payment type he chose.</p>\n\n<p>Thanks! Zach   </p>\n"},{"tags":["ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13204422,"title":"Formatting Date with Simple Form","body":"<p>I'm using the <a href=\"https://github.com/plataformatec/simple_form\" rel=\"nofollow\">Simple Form gem</a> in my Rails app.  In my sign-up form, I'm have a field for birth date.  However, the fields are showing in this order: Year/Month/Day.  </p>\n\n<p>What's the best way to get the field order Month - Day - Year?</p>\n\n<p>My form looks like this:</p>\n\n<pre><code> &lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n   &lt;%= f.input :created_at %&gt;          \n   &lt;%= f.button :submit, \"Sign up\" %&gt;      \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","devise","routes"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1247,"score":6,"question_id":6659555,"title":"How to write controller tests when you override devise registration controller?","body":"<p>I wish to override the <code>Devise::RegistrationsController</code> to implement some custom functionalality. To do this, I've created a new <code>RegistrationsController</code> like so:</p>\n\n<pre><code># /app/controllers/registrations_controller.rb\nclass RegistrationsController &lt; Devise::RegistrationsController\n  def new\n    super\n  end\nend\n</code></pre>\n\n<p>and set up my routes like this:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :registrations =&gt; \"registrations\" }\n</code></pre>\n\n<p>and tried to test it like this:</p>\n\n<pre><code>describe RegistrationsController do\n  describe \"GET 'new'\" do\n    it \"should be successful\" do\n      get :new\n      response.should be_success\n    end\n  end\nend\n</code></pre>\n\n<p>but that gives me an error:</p>\n\n<p>1) RegistrationsController GET 'new' should be successful\n     Failure/Error: get :new\n     AbstractController::ActionNotFound:\n       Could not find devise mapping for path \"/users/sign_up\".\n       Maybe you forgot to wrap your route inside the scope block? For example:</p>\n\n<pre><code>       devise_scope :user do\n         match \"/some/route\" =&gt; \"some_devise_controller\"\n       end\n # ./spec/controllers/registrations_controller_spec.rb:13:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>So what am I doing wrong?</p>\n"},{"tags":["ruby-on-rails","regex","ruby-on-rails-3","hyperlink"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13198997,"title":"Regex to Match Urls in Ruby on Rails","body":"<p>I have looked around but I haven't really found an answer that seals the deal 100% for my individual situation.</p>\n\n<p>In my Ruby app, I have a user share system where members can post 'stuff'.  Well, sometimes members post links, and I have noticed as the site grows, more and more users are complaining about there not being clickable links.</p>\n\n<p>How would I utilize regular expressions to match urls for links in posts.  Furthermore, how would I apply this in my Model?</p>\n\n<p>Thanks for you help, out of all my questions, this is a real important one for me ha!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I suppose my init post was too vague...</p>\n\n<p>I am more trying to figure out HOW to IMPLEMENT the use of regular expressions into my model  instead of which regular expression to use.</p>\n\n<p>The model is <code>class Share</code>.  And the member's post is rendered as <code>&lt;%= share.content %&gt;</code> with content being a column in my Share table as well as an accessible attribute...</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","testing","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":75,"score":1,"question_id":13204329,"title":"Setting host/remote_addr and other env properties in Rails 3 controller tests","body":"<p>In Rails 2, you could specify the host and other Rack env properties in controller tests like so:</p>\n\n<pre><code>should \"spoof host and remote_addr\" do\n  get \"/thing/2\", {}, :remote_addr =&gt; \"192.71.1.2\", :host =&gt; \"somewhere.else\"\nend\n</code></pre>\n\n<p>However, for some reason this is not working out on Rails 3. I tried with a regular controller, and <code>env[\"HTTP_HOST\"]</code> isn't being set as expected (same with <code>\"REMOTE_ADDR\"</code>). I also tried this:</p>\n\n<pre><code>should \"use host and remote_addr\" do\n  request.env[\"REMOTE_ADDR\"] = \"192.71.1.2\"\n  request.env[\"HTTP_HOST\"] = \"git.gittit.it\"\n  get \"/thing/1\"\nend\n</code></pre>\n\n<p>This also used to work in Rails 2, but no longer in Rails 3. As a final test, I tried this with a route that resolved to a bare Rack app, same results.</p>\n\n<p>How can I spoof the host and IP address in a Rails 3 controller test?</p>\n"},{"tags":["ruby-on-rails-3","jquery-ui","select","knockout.js","datepicker"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13203167,"title":"Select fields with Knockout.js","body":"<p>When I include the knockout.js library, all of my select fields disappear.  Is there a way for select fields to ignore knockout.js?</p>\n\n<p>It affects not only my drop downs, but also date picker...i.e. I have the following code:</p>\n\n<pre><code>    &lt;center&gt;\n      &lt;%= f.text_field :firstdate, :style=&gt;\"width:150px;\" %&gt; \n      - \n      &lt;%= f.text_field :seconddate, :style=&gt;\"width:150px;\" %&gt;\n      &lt;script&gt;\n      $(function() {\n            $( \"#post_firstdate\" ).datepicker({\n                  changeMonth: true,\n                  changeYear: true,\n                  yearRange: \"-112:+5\"\n            });\n            $( \"#post_seconddate\" ).datepicker({\n                  changeMonth: true,\n                  changeYear: true,\n                  yearRange: \"-112:+5\"\n            });\n      });\n      &lt;/script&gt;\n    &lt;/center&gt;\n</code></pre>\n\n<p>While I can select dates in data picker, typically the Month and Year fields are drop downs as well.  Now they disappear.</p>\n\n<p>Are there any suggestions on how to have certain fields ignore knockout?</p>\n\n<p>Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13184781,"title":"Rails session value being deleted when deleting a line_item","body":"<p>This one has me a perplexed. I'm still a newbie with Rails so it may be simple.</p>\n\n<p>The situation:</p>\n\n<ol>\n<li>I can add items to the cart, no problem. Everything works fine the current_cart method resolves to the same cart each request. </li>\n<li>But as soon as I remove a line item from the cart, it works, the line item is deleted, but the<br>\nvariable \"session[:cart_id]\" becomes null, and a new cart gets<br>\ncreated when current_cart is called the next time.</li>\n</ol>\n\n<p>I'm using Devise so I'm not sure if that has something to do with it, or maybe the line item delete method is cascade deleting the session or something like that.</p>\n\n<p>The question is, can anyone help me understand why the session variable is becoming null after calling line_item delete?</p>\n\n<p>I've created a cart application, following along with Agile web development with rails. Firstly, here's the code for application controller to retrieve the current cart:</p>\n\n<pre><code>  private\n  def current_cart \n    Checkout::Cart.find(session[:cart_id])\n  rescue ActiveRecord::RecordNotFound \n    cart = Checkout::Cart.create \n    session[:cart_id] = cart.id\n    cart\n  end\n</code></pre>\n\n<p>Now the code for my line item controller</p>\n\n<blockquote>\n  <p>class Checkout::LineItemsController &lt; ApplicationController</p>\n  \n  <p># POST /checkout/line_items   # POST /checkout/line_items.json   def\n  create</p>\n\n<pre><code>@cart = current_cart\nproduct = Catalog::Product.find(params[:product_id])\napparel_event_log.info (product.to_json)\n\n\n@checkout_line_item = @cart.line_items.find_or_initialize_by_sku_id(product.part_number)\nnew_quantity = @checkout_line_item.quantity || 0\n@checkout_line_item.quantity = new_quantity+1\n@checkout_line_item.line_item_description = product.name\n@checkout_line_item.image = product.primary_image\n\nrespond_to do |format|\n  if @checkout_line_item.save\n    format.html { redirect_to @checkout_line_item.cart, notice: 'Line item was successfully created.' }\n    format.json { render json: @checkout_line_item, status: :created, location: @checkout_line_item }\n  else\n    format.html { render action: \"new\" }\n    format.json { render json: @checkout_line_item.errors, status: :unprocessable_entity }\n  end\nend   end\n</code></pre>\n  \n  <p># DELETE /checkout/line_items/1   # DELETE\n  /checkout/line_items/1.json   def destroy\n      Checkout::LineItem.delete(params[:id])</p>\n\n<pre><code>respond_to do |format|\n  format.html { redirect_to current_cart, notice: 'Line item removed.' }\n  format.json { head :no_content }\nend   end end\n</code></pre>\n</blockquote>\n\n<p>and also the code for the line items model</p>\n\n<pre><code>class Checkout::LineItem &lt; ActiveRecord::Base\n  before_save :default_values\n\n  attr_accessible :customer_update_date, :inventory_status, :line_item_color, :line_item_description, :line_item_size, :line_item_tagline, :line_item_total, :image, :quantity, :sku_id, :style_id, :tax, :tax_code, :timestamps, :unit_price, :cart, :product\n  belongs_to :cart\n  belongs_to :product, :class_name =&gt; 'Catalog::Product'\n  has_one :image, :class_name =&gt; 'Assets::Medium'\n\n  def default_values\n     Rails.logger.debug { \"Entering default values\" }\n     self.quantity ||= 0\n   end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","login","user"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13204133,"title":"User Can Not Login with Email Address Capitalized","body":"<p>I have build a user model using Michael Hartl tutorial. In his tutorial, he states the model is being built off of falsifying case sensitivity to allow users to login with the combination of:\n\"foo@bar.com, Foo@bar.com, FOO@bar.com\"</p>\n\n<p><strong>User Model</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base \n  attr_accessible :name, :email\n\n  before_save { self.email.downcase! }\n  before_save :create_remember_token\n\n  validates :name, presence: true, length: { maximum: 50 }\n  VALID_EMAIL_REGEX = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :email, presence:   true,\n                format:     { with: VALID_EMAIL_REGEX },\n                uniqueness: { case_sensitive: false }\n\n  validates :password, presence: true, length: { minimum: 6 }, :on =&gt; :create\n  validates :password_confirmation, presence: true\n\nend\n</code></pre>\n\n<p>However when my user tries to login using \"Foo@bar.com\" it does not allow. They have to make the first letter lower case in order for it to authenticate.</p>\n\n<p>Anyone know why case_sensitive false is not working?</p>\n\n<p>TIA</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","typhoeus","hydra"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13203722,"title":"undefined method `cache_getter' for Typhoeus::Hydra","body":"<p>I don't know why I get this error. Both methods are corrects.</p>\n\n<pre><code>hydra = Typhoeus::Hydra.new\n\n             hydra.cache_getter do |request|\n                Rails.cache.read(request.cache_key) rescue nil\n             end\n             hydra.cache_setter do |request|\n               Rails.cache.write(request.cache_key,request.response, expires_in: request.cache_timeout)\n             end\n</code></pre>\n\n<p>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin11.4.2]</p>\n\n<p>Rails 3.2.8</p>\n"},{"tags":["ruby-on-rails-3","routing","subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13017184,"title":"Rails 3 Subdomain For Existing Rails Application","body":"<p>I was recently tasked with segregating my existing Rails 3 application into a standard and premium version. The premium version will have all the existing functionality with the addtion of a new layout, and new functionality. Ideally I want premuim users to access this site byway of prefixing the current url with a subdomain, e.g, \"premium.somesite.com\"/ The standard version of the website I don't want to change and is still accessible by the default url.</p>\n\n<p>If possible I would like to simply add some logic to exiting views and controller to determine how the request is treated on whether or not a subdomain is being used . </p>\n\n<p>I tried following the Railcast <a href=\"http://railscasts.com/episodes/221-subdomains-in-rails-3?view=asciicast\" rel=\"nofollow\">subdomains in rails 3</a>, however he's using subdomains in context of a blog model and database attributes where as I wanted mine to be application-wide. Is this even possible with subdomains? How can I get started?</p>\n\n<hr>\n\n<p><strong>What I've tried:</strong></p>\n\n<p>Added an additional VirtualHost to my apache httpd.conf file used by passenger:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n  ServerName premium.mydomain.com\n  DocumentRoot /somewhere/../myapp\n  &lt;Directory /somewhere/public&gt;\n    Allow from all\n    Options -Multiviews\n  &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>Added the following to my routes.rb</p>\n\n<pre><code>class PremiumSubdomain\n  def self.matches?(request)\n    request.subdomain == \"premium\"\n  end\nend\n\nMyApp::Application.routes.draw do    \n  constraints(PremiumSubdomain) do    \n    #all of my routes...    \n  end    \nend\n</code></pre>\n\n<p><strong>What happens:</strong> </p>\n\n<p>Trying to navigate to my site with the premium subdomain results in a domain not found, adding the constraint to my route.rb prevents the rest of the application from rendering anything on my default url. </p>\n"},{"tags":["ruby-on-rails-3","testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13203750,"title":"NameError: uninitialized constant ActiveRecord::Errors","body":"<p>I'm new to rails, and I am not sure how to proceed. I'm trying to complete the \"RailsSpace\" book but am running into errors in the section about testing.  (page 119 for anyone that may have the book)</p>\n\n<p>Rails 3.2.8</p>\n\n<p>ruby 1.9.3p194</p>\n\n<p>When running this in console:</p>\n\n<pre><code>@error_messages = ActiveRecord::Errors.default_error_messages; 0\n</code></pre>\n\n<p>I get this error:</p>\n\n<p><strong>NameError: uninitialized constant ActiveRecord::Errors</strong></p>\n\n<p>when running <code>rake test:units</code></p>\n\n<p>I get: </p>\n\n<pre><code>DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /Users/home/rails_projects/retrospection/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /Users/home/rails_projects/retrospection/config/environment.rb:5)\nRun options: \n\n\n# Running tests:\n\nEEEEE\n\nFinished tests in 0.108070s, 46.2663 tests/s, 0.0000 assertions/s.\n\n  1) Error:\ntest_screen_name_maximum_length(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  2) Error:\ntest_screen_name_minimum_length(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  3) Error:\ntest_uniqueness_of_screen_name_and_email(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  4) Error:\ntest_user_invalidity(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n  5) Error:\ntest_user_validity(UserTest):\nNameError: uninitialized constant ActiveRecord::Errors\n    /Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\n\n5 tests, 0 assertions, 0 failures, 5 errors, 0 skips\nrake aborted!\nCommand failed with status (5): [/Users/home/.rvm/rubies/ruby-1.9.3-p194/bi...]\n\nTasks: TOP =&gt; test:units\n</code></pre>\n\n<p>My <strong>user_test.rb</strong> file looks like this:</p>\n\n<pre><code>require 'test_helper'\n\nclass UserTest &lt; ActiveSupport::TestCase\n\n\n  def setup \n    @error_messages = ActiveRecord::Errors.default_error_messages\n    @valid_user = users(:valid_user)\n    @invalid_user = users(:invalid_user)\n  end\n\n  #This user should be valid by construction.\n  def test_user_validity\n    assert @valid_user.valid?\n  end\n\n  #This user should be invalid by construction.\n  def test_user_invalidity\n    assert !@invalid_user.valid?\n    attributes = [:screen_name, :email, :password]\n    attributes.each do |attribute|\n      #assert @invalid_user.errors.invalid?(attribute) OLD CODE DOES NOT WORK IN RAILS3\n       assert @invalid_user.invalid?(attribute)\n    end\n  end\n\n  def test_uniqueness_of_screen_name_and_email\n    user_repeat = User.new( :screen_name =&gt; @valid_user.screen_name,\n                            :email       =&gt; @valid_user.email,\n                            :password    =&gt; @valid_user.password)\n    assert !user_repeat.valid?\n    assert_equal @error_messages[:taken], user_repeat.errors.on(:screen_name)\n    assert_equal @error_messages[:taken], user_repeat.errors.on(:email)\n\n  end\n\n  #MAKE SURE THE SCREEN NAME CAN'T BE TO SHORT\n  def test_screen_name_minimum_length\n    user = @valid_user\n    min_length = User::SCREEN_NAME_MIN_LENGTH\n\n    #Screen name is too short.\n    user.screen_name = \"a\" * (min_length - 1)\n    assert !user.valid?, \"#{user.screen_name} should raise a minimum length error\"\n    #Format the error message based on minimum length.\n    correct_error_message = sprintf(@error_messages[:too_short], min_length)\n    assert_equal correct_error_message, user.errors.on(:screen_name)\n\n    #Screen name is minimum length.\n    user.screen_name = \"a\" * min_length\n    assert user.valid?, \"#{user.screen_name} should be just long enough to pass\"\n  end\n\n  #MAKE SURE THE SCREEN NAME CAN'T BE TOO LONG\n  def test_screen_name_maximum_length\n      user = @valid_user\n      max_length = User::SCREEN_NAME_MAX_LENGTH\n\n      # Screen name is too long.\n      user.screen_name = \"a\" * (min_length + 1)\n    assert !user.valid?, \"#{user.screen_name} should raise a maximum length error\"\n    #Format the error message based on maximum length.\n    correct_error_message = sprintf(@error_messages[:too_long], max_length)\n    assert_equal correct_error_message, user.errors.on(:screen_name)\n\n    #Screen name is maximumlength.\n    user.screen_name = \"a\" * max_length\n    assert user.valid?, \"#{user.screen_name} should be just short enough to pass\"\n  end\nend\n</code></pre>\n\n<p>According to the error message <strong>\"/Users/home/rails_projects/retrospection/test/unit/user_test.rb:7:in `setup'\"</strong> The line causing the problem is</p>\n\n<pre><code>@error_messages = ActiveRecord::Errors.default_error_messages\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13201604,"title":"undefined local variable or method `config' for #<Bundler::Dsl:0x7fe2598d56d8>","body":"<p>I'm following the following tutorial:</p>\n\n<p><a href=\"http://railscasts.com/episodes/188-declarative-authorization?view=comments\" rel=\"nofollow\">http://railscasts.com/episodes/188-declarative-authorization?view=comments</a></p>\n\n<p>Also Had a go at following the documentation for the gem on Git:</p>\n\n<p><a href=\"https://github.com/stffn/declarative_authorization\" rel=\"nofollow\">https://github.com/stffn/declarative_authorization</a></p>\n\n<p>But had the same outcome both times which is:</p>\n\n<pre><code>mark@ubuntu:~/RoR Projects/blog$ sudo rake gems:install\nInvalid gemspec in [/var/lib/gems/1.8/specifications/tilt-1.3.3.gemspec]: invalid date format in specification: \"2011-08-25 00:00:00.000000000Z\"\nrake aborted!\nundefined local variable or method `config' for #Bundler::Dsl:0x7fe2598d56d8&gt;\n</code></pre>\n\n<p>I have followed each tutorial to the letter but keep getting the same output so I'm guessing this is a system issue at my end?</p>\n"},{"tags":["ruby-on-rails-3","mongoid","virtual-attribute"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13133092,"title":"Virtual attributes with multiple parameters","body":"<p>I have the following function that works just fine</p>\n\n<pre><code>def holiday_hours_for(holiday)\n  hours[\"holiday_hours\"][holiday.to_s] if hours[\"holiday_hours\"][holiday.to_s]\nend\n</code></pre>\n\n<p>I am just learning about virtual attributes, and am having some trouble figuring out the setter version of this function.  How would I achieve this function...</p>\n\n<pre><code>def holiday_hours_for(holiday)=(hours)\n  self.hours[\"holiday_hours\"][holiday.to_s] = hours if hours[\"holiday_hours\"][holiday.to_s]\nend\n</code></pre>\n\n<p>Thanks!</p>\n\n<p>UPDATE:  I came up with the following, is this the best way?</p>\n\n<pre><code>  def update_holiday_hours_for(holiday, hours_text)\n    self.hours = Hash.new unless hours\n    self.hours[\"holiday_hours\"] = Hash.new unless hours[\"holiday_hours\"]\n    self.hours[\"holiday_hours\"][holiday.to_s] = hours_text.to_s\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13202319,"title":"Can't convert hash to integer - Trying to select random record","body":"<p>I'm trying to select a random record, but the only working method seems like a horrible performance liability.</p>\n\n<p>First attempt, using RANDOM function from Postgres - throws \"Can't convert Hash into Integer\"</p>\n\n<pre><code>   assigned_specialist = User.specialists.legal_for(coach_section).experienced_in(critique.discipline_id).first(:order =&gt; \"RANDOM()\")\n   return assigned_specialist.id\n</code></pre>\n\n<p>Second attempt, using <a href=\"http://stackoverflow.com/questions/2752231/random-record-in-activerecord\">offset method discussed here.</a> Also causes \"Can't convert Hash into Integer\"</p>\n\n<pre><code>  legal_specialists = User.specialists.legal_for(coach_section).experienced_in(critique.discipline_id)\n\n  offset = rand(legal_specialists.count)\n  assigned_specialist = legal_specialists.first(:offset =&gt; offset)\n  return assigned_specialist.id\n</code></pre>\n\n<p>Final attempt, using array sample method, which works but seems bad.</p>\n\n<pre><code>  legal_specialists = User.specialists.legal_for(coach_section).experienced_in(critique.discipline_id)\n  assigned_specialist = legal_specialists.sample\n  return assigned_specialist.id\n</code></pre>\n\n<p>To be fair, there will only be about 20 specialists in the system, so the array sample method might never cause any issues, but I'd still like to understand what's going on here.</p>\n\n<p><strong>Edit</strong>: Here are the scopes I defined:  </p>\n\n<pre><code>scope :specialists, where(:role_id =&gt; 2)\nscope :legal_for, lambda { |coach_section| where(\"section_id != ?\", coach_section) }\nscope :experienced_in, lambda { |discipline_id|\n  discipline = Discipline.find(discipline_id)\n  discipline.users\n} \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","module"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13202690,"title":"Rails doesn't load my module from lib","body":"<p>I have a bunch of custom classes in my Rails 3.2 app in lib folder: i.e. extending ActiveRecord, etc. It all works fine.</p>\n\n<p>However I'm trying to add a couple of custom methods to FileUtils, i.e.</p>\n\n<pre><code>module FileUtils\n  def last_modified_file(path='.')\n     # blah ...    \n  end\nend\n</code></pre>\n\n<p>I put it in lib/file_utils.rb\nIn my application.rb I have</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib)\n</code></pre>\n\n<p>My other custom classed are loaded but not the module.</p>\n\n<p>I read (<a href=\"http://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3\">Best way to load module/class from lib folder in Rails 3?</a> ) that I'm supposed to define a class inside module in order for Rails to pick it up and according to FileUtils.class  - it should be Object &lt; BasicObject.</p>\n\n<p>So I tried</p>\n\n<pre><code>module FileUtils\n  class Object \n    def last_modified_file(path='.')\n       # blah ...    \n    end\n  end\nend\n</code></pre>\n\n<p>But that doesn't work either.</p>\n\n<p>However when I fire up irb and just paste my code which effectivly puts my new code inside object and reinclude my module - it works fine.</p>\n\n<p>Whaat amd I missing here?</p>\n"},{"tags":["ruby-on-rails-3","mvc","design-patterns"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":33,"score":-1,"question_id":13186963,"title":"How does the MVC pattern work in Ruby On Rails","body":"<p>I'm still trying to understand MVC in Rails, but so far I've deduced the following:</p>\n\n<ul>\n<li>The <strong>Controller</strong> is very thin, and uses the <strong>Models</strong> to construct the data to send back to the <strong>View</strong>.</li>\n<li>The <strong>Models</strong> are not like <a href=\"http://en.wikipedia.org/wiki/Data_transfer_object\" rel=\"nofollow\">DTOs</a>, but rather they contain all the necessary biz logic to return data to the Controller.</li>\n<li>The View doesn't receive Models per say, it just receives properties defined in the corresponding <strong>Actions</strong> in the Controller.</li>\n</ul>\n\n<h2>Questions</h2>\n\n<p>So, I have a few questions:</p>\n\n<ol>\n<li><p><strong>Is my assumption of how MVC works in Rails correct</strong>, if not how does it work?</p></li>\n<li><p>If it is correct, that means that <strong>Models</strong> are never sent to the Views?</p></li>\n<li><p>If all the biz logic is in the Models, and so your Models have explicit dependencies then:</p>\n\n<ul>\n<li>how do you abstract say, your data access layer from the Controllers if the Models have explicit dependencies (say on Mongodb) and your Controllers and Models are so closely bound?</li>\n</ul></li>\n</ol>\n\n<p><em><strong>NOTE:</strong> What do I mean by explicit dependencies</em>:</p>\n\n<p>In <a href=\"https://github.com/RailsApps/rails3-mongoid-devise\" rel=\"nofollow\">this best practices Ruby On Rails sample</a> you'll notice the <a href=\"https://github.com/RailsApps/rails3-mongoid-devise/blob/master/app/models/user.rb\" rel=\"nofollow\">Users Model implements Mongoid directly</a>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","omniauth","railscasts"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12252657,"title":"Setting up Omniauth Identity to connect with Existing User Model","body":"<p>I was going through <a href=\"http://railscasts.com/episodes/304-omniauth-identity\" rel=\"nofollow\">this Railscast</a> to setup Omniauth Identity, but I was unclear about one part. He creates a new Model called Identity which then holds the email, name and password fields. However, I already have a user model with those fields, so can I just connect Identity to it? How would I do that?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13202509,"title":"Sleeping in controller","body":"<p>In my Rails controller method, which is executed when the user submits a form, there is a Ruby code <code>sleep(60)</code>, telling it to wait for a minute. One user submits the form, and while the execution is \"sleeping\", another user submits the form. Will the second user have to wait for the first user to finish, or will the execution of the controller start for the second user?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":598,"score":1,"question_id":8957446,"title":"Missing partial Ruby Chapter 8 tutorial","body":"<p>I am using Ruby on Rails Tutorial by Michael Hartl - Chapter 8 - Rails 3\nI use rails 3.1\nIn the file new.html.erb I have:</p>\n\n<pre><code>&lt;h1&gt;Sign up&lt;/h1&gt;\n&lt;%= form_for(@user) do |f| %&gt;\n&lt;%= render 'shared/error_messages' %&gt;\n</code></pre>\n\n<p>Trying to visit <a href=\"http://localhost:3000/signup\" rel=\"nofollow\">http://localhost:3000/signup</a>, it gives me the following message:</p>\n\n<pre><code>ActionView::MissingTemplate in Users#new\n\nMissing partial /shared/error_messages with {:handlers=&gt;[:erb, :builder, :coffee], \n:formats=&gt;[:html], :locale=&gt;[:en, :en]}. Searched in:\n* \"/Users/macbook/rails_projects/sample_app/app/views\"\n</code></pre>\n\n<p>I have googled around but could not find this answer. The same question was posted a while ago at:\n<a href=\"http://stackoverflow.com/questions/6471558/ruby-chapter-8-tutorial-partial-file-not-found\">Ruby Chapter 8 tutorial partial file not found</a></p>\n\n<p>What I tried:\n-putting a / in front of shared\n- putting :partial => after render\n-putting :target => @user</p>\n\n<p>If I don't put it into the shared folder, it works. Is there a different way to do this in rails 3.1.3? Please let me know because I've spent so much time trying to figure it out.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13201789,"title":"Rails where on query result","body":"<p>I have a model- <code>Link</code> - that has many hits. What I'm trying to do is aggregate data on hits per hour over time from a database table - <code>hits</code> - with columns <code>year</code>, <code>month</code>, <code>day</code>, and <code>hour</code>.</p>\n\n<p>Everything is working fine, but when I run the code below, I end up with almost <strong>1,000 queries on the database</strong>, which seems quite excessive.</p>\n\n<pre><code>#before iteration\n@hits = @link.hits.group('year, month, day, hour')\n  .order('year ASC, month ASC, day ASC, hour ASC')\n  .select('year, month, day, hour, count(*) as hits')\n\n\n#inside iteration\n\n#Line breaks are included here for easy reading\nhits_per_hour =\n  @hits.where(\n    :year =&gt; t.year, \n    :month =&gt; t.month,\n    :day =&gt; t.day,\n    :hour =&gt; t.hour\n  ).map(&amp;:hits).first || 0\n</code></pre>\n\n<p>Here <code>t</code> is a <code>Time</code> object that iterates in steps of 1 hour since the first hit a link received.</p>\n\n<p>I would think that rails would store the query result instead of re-querying every time. I also haven't been able to find anything about caching the query results or anything. Am I just missing something completely, or is this really the easiest way?</p>\n\n<p>Here is a sample of what the queries look like (this is what I see in my logs in blocks of a thousand):</p>\n\n<pre><code>SELECT year, month, day, hour, count(*) as hits\nFROM `hits`\nWHERE\n  `hits`.`link_id` = 1 AND\n  `hits`.`year` = 2012 AND\n  `hits`.`month` = 11 AND\n  `hits`.`day` = 2 AND\n  `hits`.`hour` = 14\nGROUP BY year, month, day, hour\nORDER BY year ASC, month ASC, day ASC, hour ASC\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect","rspec","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13201446,"title":"Rspec redirect to testing","body":"<p>In my controller when an user creates a new post, he/she is redirected to the page that contains the newly created post. I'm wanting to create a test in rspec to cover this redirect but am having trouble with it. Specifically, I want to know what to write in the refirst_to argument. Here is the controller code below..</p>\n\n<pre><code>def create\n@micropost = Micropost.new(params[:micropost])\n respond_to do |format|\n  if @micropost.save\n    format.html {redirect_to @micropost}\n  else\n    format.html {render action: 'edit'} \n  end\nend\nend\n</code></pre>\n\n<p>Here is the rspec test...</p>\n\n<pre><code>before do\n  @params = FactoryGirl.build(:micropost)\nend\n\nit \"redirects to index\" do\n  #clearly @params.id doesn't work. its telling me instead of a redirect im getting a \n  #200\n  #response.should redirect_to(@params.id)\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sunspot","sunspot-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13201284,"title":"how to get value selected by using select_tag with options_from_collection_for_select and pass it to controller","body":"<p>I have built a form search like this:</p>\n\n<pre><code>&lt;%= form_tag({ controller: 'questions', action: 'search_topic' }, method: 'get') do %&gt;\n  &lt;%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name) %&gt;\n  &lt;%= submit_tag \"Search\", name: nil, class: 'btn' %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>I want to search all questions of a topic selected from select box, i used sunspot to help for search, so now how can i pass value select from select box to controller for search, i used below code to pass a params[:search]:  </p>\n\n<pre><code>&lt;%= select_tag 'search_topic', options_from_collection_for_select(current_user.get_topics, :id, :name), params[:search] %&gt;\n</code></pre>\n\n<p>but it has error: </p>\n\n<pre><code>undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>this is my controller:</p>\n\n<pre><code>def search_topic\n  @search = Question.search do\n    with(:topic_id, params[:search])\n    paginate page: 1, per_page: 10\n  end\n\n  @questions = @search.results\n  render 'index'\nend\n</code></pre>\n\n<p>so, how can i pass value selected from select box on form to controller for search?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","development-environment"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13201243,"title":"Initializers not called in development environment when class changes","body":"<p>I have a an initializer in my Rails 3.2 app that includes modules at startup based on a configuration file.  It looks something like this:</p>\n\n<pre><code>Array(Settings.site.authentications).map(&amp;:to_sym).each do |sym|\n  AuthAuth.class_eval do\n    include Object.const_get(sym)\n  end\nend\n\nArray(Settings.site.authorizations).map(&amp;:to_sym).each do |sym|\n  AuthAuth.class_eval do\n    include Object.const_get(sym)\n  end\nend\n\n# This exception is never raised when I start the server.  So the includes \n# appear to be working correctly.\nraise \"method not found!\" unless AuthAuth.new.respond_to? :dynamically_included_method\n</code></pre>\n\n<p><code>AuthAuth</code> is used in my <code>ApplicationController</code> in a <code>:before_filter</code> to ensure that users are authenticated and authorized.  It works fine and suites the requirement that I have a configurable way of setting authorization and authentication logic on a per-site basis.</p>\n\n<p>I've noticed, however, that when I am running the server in development mode if I make a code change to any class in the application, <code>AuthAuth</code> reverts to it's default behavior without the included modules.</p>\n\n<p>Is there an appropriate place to include this code other than an initialization file?  </p>\n\n<p>This is a relatively minor issue.  It's easy enough to restart the development server after each code change, but I'm curious. </p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12981749,"title":"How can I use JSON data to feed two different views?","body":"<p>I have rails application that has two view ports that uses the same data. I can get the data in JSON format like this:</p>\n\n<pre><code>$.read(\n    '/en/search/fetch_companies',\n    { current_location_lat: 72, current_location_lng: 10, bounding_box: 10 },\n    function (response) {\n        for (var i = 0; i &lt; response.length; i++) {\n            var markerPosition = new google.maps.LatLng(response[i].latitude, response[i].longitude);\n            var marker = new google.maps.Marker({\n                position:markerPosition,\n                map:map,\n                title:\"AJAX!\"\n                });\n        }\n    }\n);\n</code></pre>\n\n<p>This code above creates Markers on a Google Maps. The second view port is a simple table. </p>\n\n<pre><code>  &lt;% @companies.each do |company| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;address&gt;\n          &lt;strong&gt;&lt;%= company.name %&gt;&lt;/strong&gt;&lt;br&gt;\n          &lt;%= company.address %&gt;\n          &lt;br&gt;\n          &lt;%= company.city %&gt;,&lt;%= company.province %&gt;\n          &lt;br&gt;\n          &lt;%= company.postalcode %&gt;\n        &lt;/address&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= link_to book_appointment_path(:choose_service, :company_id =&gt; company.id), :class =&gt; \"btn btn-info btn-center-col\" do %&gt;\n          &lt;i class=\"icon-time icon-white\"&gt;&lt;/i&gt; Book Appointment\n        &lt;% end %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>For now I've been sending two requests to get the JSON data. One for the table view and one for the Map. This is not acceptable for me. The Map and the Table need to be fed the same data at once, but since Rails is resolved on the server I cannot fill the table with the JSON data.</p>\n\n<p>Do anyone knows about some a table that plays nicely with Rails, Ajax and pagination?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13201115,"title":"Ordering by complex structure in Rails","body":"<p>I have a model called Event that has many EventRegistrations, which belongs to a person.\nAlso the EventRegistration has many EventAtendees, which belongs to a person too.</p>\n\n<p>I want to order in Rails all the people related to a event, which means:\n - Person associated to an event registration\n - Person associated to an event atendee which is associated to a registration..</p>\n\n<p>Any help?</p>\n"},{"tags":["ajax","ruby-on-rails-3","file-upload","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13195546,"title":"remove image from model with rails 3 and carrierwave and jquery","body":"<p>I'm using Carrierwave to add and upload an image to Amazon S3.  this works ok, and once the form is saved I display the image and an x box to remove it.</p>\n\n<p>I would like to use ajax to handle the click event on the 'x' image'  on click I would like to remove the image and clear the field on the form so that the input field is once again displayed</p>\n\n<p>The image field is an attribute of the model class i am editing in the form.</p>\n\n<pre><code>Person &lt; ActiveRecord\n attr_accessible: image\n</code></pre>\n\n<p>the partial for this part of my form shows the image if it exists, otherwise the input file_field if it does not exists</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= image_tag @pass.background_image_url(:thumb) if @pass.background_image? %&gt;\n    &lt;%= f.file_field :background_image if @pass.background_image.to_s == '' %&gt;\n    &lt;%= content_tag :div, '', class: \"delete_image_fields\" if @pass.background_image? %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have some jquery which i can sccessful hide the image field.</p>\n\n<pre><code>jQuery -&gt;\n\n  $('.field .delete_image_fields').click -&gt;\n  $(this).parent().find('img').hide()\n  event.preventDefault()\n</code></pre>\n\n<p>The image field gets hidden no problem</p>\n\n<p>What i would like to happen is </p>\n\n<p>a)  clear the input field from the pass object\nb)  submit the change (remotely)\nc) delete the remote image on S3\ne) re-display the file_input field for the image so it can re-selected if required</p>\n\n<p>Any help or pointers would be appreciated</p>\n\n<p>UPDATE</p>\n\n<p>I've got this partially working to display corect fields and adjust the input link.  but i'm not sure how to actually delete the file from the models attribute</p>\n\n<p>I've updated the partial to the following which dispalsy either the image ro the create file button</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= f.label :background_image %&gt;&lt;br /&gt;\n  &lt;% if @pass.background_image?%&gt;\n     &lt;%= image_tag @pass.background_image_url(:thumb)  %&gt;\n     &lt;%= f.file_field :background_image , style: \"display:none\"%&gt;\n     &lt;%= content_tag :div, '', class: \"delete_image_fields\" %&gt; \n  &lt;% else %&gt;\n     &lt;%= f.file_field :background_image%&gt;       \n  &lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<p>and updated my jquery to this</p>\n\n<pre><code>$('.field .delete_image_fields').click -&gt;\n  $(this).parent().find('img').hide()\n  $(this).hide()\n  $(this).parent().find('input').val('')\n  $(this).parent().find('input').show()\n  event.preventDefault()\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13200629,"title":"Rails Active Record query -- 'or' conditions","body":"<p>I have a jobs table; each job has a start_date and an end_date. For a given month I want to pull all jobs that were \"running\" in any part of, or all of some month. The problem is how to write the query for the 5 different \"or\" conditions needed to capture the notion of a job running in all of or any part of the month. So, I need all jobs that started before the beginning of the month and ended during the month <strong>OR</strong> all jobs that started and ended during the month <strong>OR</strong> all jobs that started in the month and finished after the end  of the month... Well, there is three of the five. So in the Jobs.where clause, how is the \"or\" compactly expressed?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13200604,"title":"Rails: Asynchronous reload on server response","body":"<p>My Rails application has two functions, a user requesting information from an outside server, and the outside server returning that information. The way it is currently structured, the user selects one or more objects from the homepage and click 'update', which is handled by the 'search' method in my home controller, which in turn fires off a request to the server, returning true or false depending on the connection. The server goes through some processes, and returns an answer via a post request to a URL within my application (which is received by the 'answer' method in my party controller. When the answer is received, I would like the objects 'updated' by the user to have their data asynchronously updated.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","passenger"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":11145051,"title":"Rails production.log (using Passenger) being written to by multiple processes, can't be parsed","body":"<p>Here's a snippet of my production.log:</p>\n\n<pre><code>Started GET \"/product/514034/754240\" for XX.XX.202.138 at 2012-06-21 11:52:28 -0700\n\n\nStarted GET \"/product/614409/666897\" for XX.XX.228.38 at 2012-06-21 11:52:28 -0700\nProcessing by ProductsController#show as HTML\n  Parameters: {\"category_id\"=&gt;\"514034\", \"product_id\"=&gt;\"754240\"}\nProcessing by ProductsController#show as HTML\n  Parameters: {\"category_id\"=&gt;\"614409\", \"product_id\"=&gt;\"666897\"}\nLogged in 2940659 via auth cookie\nLogged in 585210 via auth cookie\n[e3e3fc56bb6bd137741b269ee397683c] [2940659] Read fragment views/global-caches/header (0.7ms)\n[e3e3fc56bb6bd137741b269ee397683c] [2940659]   Rendered shared/_email_form.html.haml (0.7ms)\n[d81bb986be5acc0277c0c9e11b414249] [585210] Read fragment views/global-caches/sharebar-message (0.7ms)\n[d81bb986be5acc0277c0c9e11b414249] [585210]   Rendered shared/_email_form.html.haml (0.7ms)\n...\n</code></pre>\n\n<p>As you can see, it's logging two concurrent sessions of two different users simultaneously to the same log file. This makes it impossible to parse my logs and determine, for example, the time it took to generate each kind of page, because the entries are not in the expected order of: </p>\n\n<pre><code>Started GET \"/URL/BLAH\" for IP at DATE\n... stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n</code></pre>\n\n<p>Instead I get an unpredictable interleaved log like this:</p>\n\n<pre><code>Started GET \"/URL/BLAH\" for IP at DATE\n\nStarted GET \"/URL/BLAH\" for IP at DATE\n... stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n...stuff...\nCompleted 200 OK in XXms (ActiveRecord: YY.Yms)\n</code></pre>\n\n<p>So it's impossible to match the \"completeds\" with the \"Started.\"</p>\n\n<p>What I'd like is a way to have each child process write to its own log or something. Or if it's possible a way to write the each pageview's log atomically, but that might be impossible or difficult or hurt performance.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","datatables","pjax"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13196264,"title":"Rails, pjax and DataTables","body":"<p>I've got a Rails app utilizing pjax (pjax.heroku.com/) so that my header and navbar don't ever reload. It's all fine and dandy and working, BUT in one of my views I'm using a data table (datatables.net). The data table works great when you first load up the page, but if you navigate away to another page and then come back, the table doesn't \"reinitiate\", so it doesn't work and everything looks like crap. Apparently it's because the data tables js file isn't getting loaded up again due to pjax.</p>\n\n<p>Here's what I've got:</p>\n\n<p><code>application.js</code>:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require pjax\n//= require_tree .\n</code></pre>\n\n<p>In the head of <code>application.html.erb</code> I have:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>And then wrapped the <code>&lt;%=</code> yield <code>%&gt;</code> in a div with <code>data-pjax-container</code>.</p>\n\n<p>I'm calling the data-tables js file in <code>index.html.erb</code> (hard-coded) underneath the table:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"/data-table.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Then in a separate <code>custom.js</code> file, this is what initiates the table:</p>\n\n<pre><code>$(document).pjax('a[data-pjax]');\n$('.openinside').pjax('.sidebarInner');\n</code></pre>\n\n<p>Any idea what's going on here? I think the table isn't being reinitiated, but how can I make it reinitiate when the header isn't getting loaded every time due to Pjax? I tried putting the JS link right beneath the table even and that didn't work!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12652540,"title":"Combine Show and Edit actions in Ruby on Rails?","body":"<p>I was just wondering if anybody has ever built a Rails application without any <em>Show</em> actions.</p>\n\n<p>In my application, if a user picks, say a Project, from the list he will <em>probably</em> want to not just <em>show</em> it but also <em>edit</em> it.</p>\n\n<p>So is it good practice to <strong>not</strong> implement any show actions and instead link all records to edit forms?</p>\n\n<p>The only caveat I see is that a user might accidentally edit a project. But this could be prevented by setting a default attribute <em>disabled</em> on all form fields using jQuery. That way, a user will have to click a button \"Edit\" in order to unlock the form fields for editing.</p>\n\n<p>Does that make sense or am I completely nuts?</p>\n\n<p>Who knows, maybe this causes conflicts with Rails' RESTful architecture?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13199613,"title":"match two or more object from differents models with mongoid","body":"<p>I have 2 model:</p>\n\n<pre><code>class User\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n\nclass Admin\n include Mongoid::Document\n field :email, :type =&gt; String, :null =&gt; false, :default =&gt; \"\"\n .\n .\nend\n</code></pre>\n\n<p>I want with a mongoid query find all users have a equal email in <code>Admin</code> model, something like:</p>\n\n<pre><code>User.where(:email =&gt; {exist_admin_class?})\n</code></pre>\n\n<p>This is possible? Or I have make a relationship between two model with a <code>has_one User</code> and <code>belongs_to Admin</code></p>\n\n<p>What is the best way to do this?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":191,"score":1,"question_id":11725002,"title":"Rails 3: How to configure Zencoder to work with Amazon S3?","body":"<p>I'm following this tutorial to integrate Zencoder in my Rails 3 app: <a href=\"http://www.nickdesteffen.com/blog/video-encoding-with-uploadify-carrierwave-and-zencoder\" rel=\"nofollow\">http://www.nickdesteffen.com/blog/video-encoding-with-uploadify-carrierwave-and-zencoder</a></p>\n\n<p>The tutorial uses Rackspace for storage, but I'd like to adapt the code so that I can use Amazon S3 for storage instead. I replaced all the Rackspace info with my Amazon S3 info, but whenever I try to upload a video in my form, I get this HTTP error: \"There was an error with the file you tried uploading.Please verify that it is the correct type.\"</p>\n\n<p>What do I need to fix here to make this work?</p>\n\n<p><strong>carrierwave.rb</strong></p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',\n    :aws_access_key_id      =&gt; 'xxx',\n    :aws_secret_access_key  =&gt; 'xxx',\n  }\n  config.fog_directory  = 'mybucket'\n  config.fog_public     = true\n  config.fog_attributes = {'Cache-Control' =&gt; 'max-age=315576000'}\nend\n</code></pre>\n\n<p><strong>video_uploader.rb</strong></p>\n\n<pre><code>class VideoUploader &lt; CarrierWave::Uploader::Base\n  include Rails.application.routes.url_helpers\n\n  Rails.application.routes.default_url_options = ActionMailer::Base.default_url_options\n\n  after :store, :zencode\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  def extension_white_list\n    %w(mov avi mp4 mkv wmv mpg)\n  end\n\n  def filename\n    \"video.mp4\" if original_filename\n  end\n\n  private \n\n  def zencode(args)\n    zencoder_response = Zencoder::Job.create({:input =&gt; 's3://mybucket/key.mp4',\n                      :outputs =&gt; [{:label =&gt; 'vp8 for the web',\n                                    :url =&gt; 's3://mybucket/key_output.webm'}]})\n\n    zencoder_response.body[\"outputs\"].each do |output|\n      if output[\"label\"] == \"web\"\n        @model.zencoder_output_id = output[\"id\"]\n        @model.processed = false\n        @model.save(:validate =&gt; false)\n      end\n    end\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","testing","performance-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":96,"score":0,"question_id":10436808,"title":"Rails 3.0.12 Performance test issues","body":"<p>I'm trying to run benchmark and performance tests and I'm not getting the metrics displaying...</p>\n\n<p>ruby -v:</p>\n\n<p><code>ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-linux]</code></p>\n\n<p>rvm list:</p>\n\n<p><code>=&gt; ruby-1.9.2-p320-perf [ x86_64 ]</code></p>\n\n<p>the result of running <code>rake test:profile</code>:</p>\n\n<pre><code>BrowsingTest#test_homepage (130 ms warmup)\n        process_time: 18446744073.71 sec\n              memory: unsupported\n             objects: unsupported\nBrowsingTest#test_intel_companies_newstats (34 ms warmup)\n        process_time: 26 ms\n              memory: unsupported\n             objects: unsupported\n</code></pre>\n\n<p>and running <code>rake test:benchmark</code></p>\n\n<pre><code>BrowsingTest#test_homepage (103 ms warmup)\n           wall_time: 23 ms\n              memory: 0.00 KB\n             objects: 0\n             gc_runs: 0\n             gc_time: 0.00 ms\nBrowsingTest#test_intel_companies_newstats (31 ms warmup)\n           wall_time: 9 ms\n              memory: 0.00 KB\n             objects: 0\n             gc_runs: 0\n             gc_time: 0.00 ms\n</code></pre>\n\n<p>my gem file</p>\n\n<pre><code>group :test do\n    gem 'capybara'\n\n    # for performance tests\n    gem 'ruby-prof', :git =&gt; 'git://github.com/wycats/ruby-prof.git'\n    gem 'test-unit'\nend\n</code></pre>\n\n<p>When I tried to run:</p>\n\n<p><code>rvm install 1.9.2 --patch gcdata --name perf</code></p>\n\n<p>I got:</p>\n\n<pre><code>Installing Ruby from source to: /home/victor/.rvm/rubies/ruby-1.9.2-p320-perf, this may take a while depending on your cpu(s)...\n\nruby-1.9.2-p320-perf - #fetching \nruby-1.9.2-p320-perf - #extracting ruby-1.9.2-p320 to /home/victor/.rvm/src/ruby-1.9.2-p320-perf\nruby-1.9.2-p320-perf - #extracted to /home/victor/.rvm/src/ruby-1.9.2-p320-perf\nPatch 'gcdata' not found.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","html5","file-upload","carrierwave"],"answer_count":3,"favorite_count":3,"up_vote_count":4,"down_vote_count":0,"view_count":3973,"score":4,"question_id":6447278,"title":"Uploading multiple files at once to Rails app with Carrierwave (HTML5)","body":"<p>I'm close...very close...I'm able to upload single files just fine...but when i change the type of my form's <code>file_field</code> to <code>:multiple =&gt; true</code> so I can upload multiple images at once my uploaded files get wrapped in an array...and the 'magic' of 'accepts_nested_attributes_for` is lost.</p>\n\n<p><strong>Edit:</strong>\nAfter more examination I wonder if I even need to bother with <code>accepts_nested_attributes_for</code>? Perhaps I should just have a <code>file_field, :multiple =&gt; true</code> in my Gallery form (as opposed to a nested form) and then in my create action create the new gallery and then loop through each element in the <code>params[:gallery][:photos_attributes][\"0\"][:image]</code> array by hand, so to speak, calling <code>@gallery.photos.create</code> for each element. ?!?  Seems cumbersome...but it's all I can come up with.</p>\n\n<p>Hoping someone with more experience with Rails can chime in...</p>\n\n<p>Params:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\", \n\"authenticity_token\"=&gt;\"9jXvIwcllct7UyUfo6cvhEucQf2u3SY50SuaCLtFO4c=\", \n\"gallery\"=&gt;{\n  \"name\"=&gt;\"First Gallery\", \n  \"photos_attributes\"=&gt;{\"0\"=&gt;{\n    \"image\"=&gt;[\n      #&lt;ActionDispatch::Http::UploadedFile:0x00000104b78978 \n        @original_filename=\"first_test_image.jpg\", \n        @content_type=\"image/jpeg\", \n        @headers=\"Content-Disposition: form-data; name=\\\"gallery[photos_attributes][0][image][]\\\"; filename=\\\"first_test_image.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", \n        @tempfile=#&lt;File:/var/folders/bQ/bQYZC2ukFZCvbKzEDGRtJE+++TI/-Tmp-/RackMultipart20110622-4459-vz78ee&gt;&gt;, \n      #&lt;ActionDispatch::Http::UploadedFile:0x00000104b78950 \n        @original_filename=\"second_test_image.jpg\", \n        @content_type=\"image/jpeg\", \n        @headers=\"Content-Disposition: form-data; name=\\\"gallery[photos_attributes][0][image][]\\\"; filename=\\\"second_test_image.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", \n        @tempfile=#&lt;File:/var/folders/bQ/bQYZC2ukFZCvbKzEDGRtJE+++TI/-Tmp-/RackMultipart20110622-4459-1jzhhyg&gt;&gt;\n      ]\n    }\n  }\n}, \"commit\"=&gt;\"Save\", \"action\"=&gt;\"create\", \"controller\"=&gt;\"galleries\"}\n\n\n\n#app/models/gallery.rb \nclass Gallery &lt; ActiveRecord::Base \n  has_many :photos, :dependent =&gt; :destroy \n  accepts_nested_attributes_for :photos \nend \n\n#app/models/photo.rb \nclass Photo &lt; ActiveRecord::Base \n  belongs_to :gallery \n  mount_uploader :photo, PhotoUploader \nend \n\n#config/routes.rb\nresources :galleries do\n  resources :photo, :only =&gt; [:create, :destroy]\nend\n</code></pre>\n\n<p>GalleriesController</p>\n\n<pre><code>  def new\n    @gallery = Gallery.new\n    @gallery.photos.build\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @gallery }\n    end\n  end\n\n  ...\n\n  def create\n    @gallery = Gallery.new(params[:gallery])\n\n    respond_to do |format|\n      if @gallery.save\n        format.html { redirect_to @gallery, notice: 'Gallery was successfully created.' }\n        format.json { render json: @gallery, status: :created, location: @gallery }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @gallery.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-engines"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":142,"score":1,"question_id":13183540,"title":"Using layouts from a mountable engine","body":"<p>I am looking for a solution to the following problem:</p>\n\n<p>db_core application contains only models for a small core system. The db_core application will not have any views. </p>\n\n<p>On top of the db_core application we will have an admin interface. This will be a mountable engine. The admin interface will serve assets such as javascripts, css, images, etc.</p>\n\n<p>Finally we will have additional mountable engines; eg. \"blog\", \"forum\", \"authentication\" that will be mounted on the db_core application, and all these mountable engines should have the same layout as the admin interface engine.</p>\n\n<p>I have a test up and running where the db_core application serves assets, but I have not been able to find out how to let another engine serve the assets so the db_core application can remain small and free of any assets and views.</p>\n\n<ul>\n<li>db_core\n<ul>\n<li>Engine A -> admin interface (assets)</li>\n<li>Engine B, C, D, ... -> various other engines using assets from Engine A</li>\n</ul></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":343,"score":0,"question_id":8086638,"title":"Merging db/migration files","body":"<p>Is there a good way to merge rails db migration files into 1 file per table besides splitting <strong>schema.rb</strong> manually?</p>\n\n<p>Most of my migration file was created during development and does not represent real data changes. For historical reasons those files will be still accessible on source control system. I feel uncomfortable keeping those unnecessary files.</p>\n"},{"tags":["ruby-on-rails-3","activerecord","database-connection"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13193742,"title":"Rails 3 connect different databases dynamically based on certain parameter","body":"<p>\nI am having an app where i need to switch the database according to the parameter the user is passing. What exactly my purpose is that user calls an api and passes certain parameter. I am having 2 databases say D1 and D2 to serve the same api. \n</p>\n\n<p>Based on one of the parameter value I want to switch the database from on default database(D1) to another database(D2). If the parameter is not satisfied the default db must be D1</p>\n\n<p><br/><br/><br/>\nIve tried using *self.abstract_class = true* and *establish_connection :D2*, but in this case its get connected to D2 irrespective of the parameter.<br/><br/><br/>\nKindly suggest me what could be the appropriate solution for this.</p>\n\n<p>Any Help is highly appreciated..!!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13196493,"title":"How should I refactor create_unique methods in Rails 3?","body":"<p>I have following ugly create_unique method in few models ex:</p>\n\n<pre><code>  def self.create_unique(p)\n    s = Subscription.find :first, :conditions =&gt; ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]\n    Subscription.create(p) if !s\n  end\n</code></pre>\n\n<p>And then in controllers #create actions I have</p>\n\n<pre><code>s = Subscription.create_unique({:user_id =&gt; current_user.id, :app_id =&gt; app.id})\nif s\n  raise Exceptions::NotAuthorized unless current_user == s.user\n  @app = s.app\n  s.destroy\n  flash[:notice] = 'You have been unsubscribed from '+@app.name+'.'\n  redirect_to '/'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13197359,"title":"Add association (<<) without commiting to database","body":"<p>Is it possible in Rails to add an association to an <strong>existing</strong> record without immediately commiting this change to the database?\nE.g. if I have Post has_many :tags</p>\n\n<pre><code>post.tags &lt;&lt; Tag.first\n</code></pre>\n\n<p>This will commit to database immediately. I've tried other ways instead of &lt;&lt;, but without success (what I want is to create the association when saving the parent object).\nIs it possible to get behavior like when you are adding association to a new record with build?</p>\n\n<pre><code>post.tags.build name: \"whatever\"\n</code></pre>\n\n<p>I think this is kind of inconsistent in Rails, in some cases it would be useful to have an option to do this.</p>\n\n<p>In other words I want</p>\n\n<pre><code>post.tags &lt;&lt; Tag.first # don't hit the DB here!\npost.save # hit the DB here!\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13185761,"title":"Sending downloaded files via Rails controller","body":"<p>On my Rails-based website, I'd like a user to be able to input a URL, which my server downloads using the Unix command <code>wget</code> <em>with the recursive option</em>. My server then zips those downloaded files along with some files already on the server, and sends the zip to the user by using the Rails command <code>send_file</code>.</p>\n\n<p>Now, I'm worried that the <code>send_file</code> will be executed before the <code>wget</code> and zipping finish their job. How do I make sure that sending the file occurs only after the downloading and zipping finish? Will this approach work, or should I take an another approach?</p>\n"}]}
{"total":34674,"page":6,"pagesize":100,"questions":[{"tags":["javascript","ruby-on-rails-3","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":15,"score":-1,"question_id":13197495,"title":"Access the value of attributes of a model in rails3 in backbone.js","body":"<p>I have a model Search which has an attribute :activities.\n:activities is a hash.\nAfter updating its value to something, I want to access the value in a Backbone View and use it in a template.\nHow do I access the value in the view?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":25,"score":3,"question_id":13196881,"title":"Capybara::ElementNotFound: for jquery ui dialog box content","body":"<p>I have my Login form into the Jquery UI Dialog popup box. When I start doing RSpec test, I got an error with </p>\n\n<pre><code>Failure/Error: fill_in \"Username\", with: \"user@example.com\"\nCapybara::ElementNotFound\ncannot fill in, no text field, text area or password field with id, name, or label 'Username' found\n</code></pre>\n\n<p>Here is my spec/request page:</p>\n\n<pre><code>describe \"create user\", :js =&gt; true do\n\n  before { visit new_enr_rds_dea_path }\n\n  let(:submit) { \"Create Dea\" }\n\n  describe \"with invalid information\" do\n    it \"should not create a user\" do\n      expect { click_button submit }.not_to change(Enr::Rds::Dea, :count)\n    end\n  end\n\n  describe \"with valid information\" do\n    before do\n      fill_in \"Username\", with: \"user@example.com\"\n      fill_in \"Password\", with: \"foobar\"\n      fill_in \"Confirm password\", with: \"foobar\"\n      fill_in \"Organisation\", with: \"foobar\"\n    end\n\n    it \"should create a user\" do\n      expect { click_link_or_button submit }.to change(Enr::Rds::Dea, :count).by()\n    end\n  end\n</code></pre>\n\n<p>Factories.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :dea_user do |user|\n    user.dea_user             \"example@in4systems.com\"\n    user.dea_pwd              \"foobar\"\n    user.dea_pwd_confirmation \"foobar\"\n    user.pro_organisation_id  \"NHER\"\n  end\nend\n</code></pre>\n\n<p>I am rendering my new and edit page to the Form partial. Both <code>New</code> and <code>edit</code> button has <code>:remote =&gt; true</code> method to open the JqueryUI dialog box. Thanks..</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13190933,"title":"Syntax error on Heroku on line that doesn't exist","body":"<p>I have a Rails app with Haml views which runs fine locally and also on another host. But after deploying to Heroku, the first request gets an error, se the log below:</p>\n\n<pre><code>Started GET \"/\" for 88.159.5.1 at 2012-11-02 07:03:56 +0000\n- - Processing by SessionsController#new as HTML\n- - Rendered sessions/new.html.haml within layouts/application (403.5ms)\n- - Completed 500 Internal Server Error in 497ms\n- - ActionView::Template::Error (syntax error on line 18, col 4: `all:  all'):                                      \n- -     1: .sixteen.columns\n- -     2:   #loginblock\n- -     3:     .content_title.general\n- -     4:     %h2= I18n.t :login_title\n- -     5:     .content\n- -     6:       = render(\"layouts/message\")\n- -     7:       = form_tag(sessions_path, :class =&gt; 'form') do\n- -   app/views/sessions/new.html.haml:4:in `_app_views_sessions_new_html_haml___1472882735787050115_50827800'\n</code></pre>\n\n<p>Strange thing is: line 18 doesn't exist in that view, it has only 17 lines. And on line 4 I don't see anything wrong? Probably has something to do with Haml or Haml gem not working correctly? See is the view file below. Thanks for any input!</p>\n\n<pre><code>.sixteen.columns\n  #loginblock\n    .content_title.general\n    %h2= I18n.t :login_title\n    .content\n      = render(\"layouts/message\")\n      = form_tag(sessions_path, :class =&gt; 'form') do\n        .field\n          = label_tag I18n.t :form_email\n          = text_field_tag :email\n        .field\n          = label_tag I18n.t :form_password\n          = password_field_tag :password\n        .field\n          = submit_tag I18n.t(:login_title), :class =&gt; 'button white'\n        .clear\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","mongoid","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13187416,"title":"mongoid and devise gives unsual error","body":"<p>Mongoid with devise seems to be throwing up this error for me, where ever devise is being used.</p>\n\n<pre><code>undefined method `-' for nil:NilClass\n</code></pre>\n\n<p>this is the stack trace</p>\n\n<pre><code>moped (1.2.7) lib/moped/cluster.rb:172:in `block in refresh'\nmoped (1.2.7) lib/moped/cluster.rb:179:in `each'\nmoped (1.2.7) lib/moped/cluster.rb:179:in `refresh'\nmoped (1.2.7) lib/moped/cluster.rb:132:in `nodes'\nmoped (1.2.7) lib/moped/cluster.rb:240:in `with_secondary'\nmoped (1.2.7) lib/moped/session/context.rb:104:in `with_node'\nmoped (1.2.7) lib/moped/session/context.rb:43:in `query'\nmoped (1.2.7) lib/moped/query.rb:112:in `first'\nmongoid (3.0.10) lib/mongoid/contextual/mongo.rb:201:in `first'\nmongoid (3.0.10) lib/mongoid/contextual.rb:18:in `first'\norm_adapter (0.4.0) lib/orm_adapter/adapters/mongoid.rb:22:in `get'\ndevise (2.1.2) lib/devise/models/authenticatable.rb:183:in `serialize_from_session'\ndevise (2.1.2) lib/devise/rails/warden_compat.rb:29:in `deserialize'\nwarden (1.2.1) lib/warden/session_serializer.rb:35:in `fetch'\nwarden (1.2.1) lib/warden/proxy.rb:212:in `user'\nwarden (1.2.1) lib/warden/proxy.rb:318:in `_perform_authentication'\nwarden (1.2.1) lib/warden/proxy.rb:127:in `authenticate!'\ndevise (2.1.2) lib/devise/controllers/helpers.rb:48:in `authenticate_user!'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:418:in `_run__532752988157179990__process_action__39271927218028622__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'\nactionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'\njourney (1.0.4) lib/journey/router.rb:68:in `block in call'\njourney (1.0.4) lib/journey/router.rb:56:in `each'\njourney (1.0.4) lib/journey/router.rb:56:in `call'\nactionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'\nmongoid (3.0.10) lib/rack/mongoid/middleware/identity_map.rb:34:in `call'\nwarden (1.2.1) lib/warden/manager.rb:35:in `block in call'\nwarden (1.2.1) lib/warden/manager.rb:34:in `catch'\nwarden (1.2.1) lib/warden/manager.rb:34:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:25:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__4054107343433525264__call__3237741633973160553__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.8) lib/rails/engine.rb:479:in `call'\nrailties (3.2.8) lib/rails/application.rb:223:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'\n/Users/amit/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'\n</code></pre>\n\n<p>The controller has a before_filter :authenticate_user! commenting this, allows the page to work.</p>\n\n<p>What might be wrong here?</p>\n\n<p>I have tried destroying all devise installs by doing</p>\n\n<pre><code>rails d devise user\nrails d devise:views\nrails d devise:install\n</code></pre>\n\n<p>and then re installing devise, it did not help. Any ideas?</p>\n"},{"tags":["mysql","ruby-on-rails","database","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":330,"score":0,"question_id":9779998,"title":"rail servers error? (rails 3) in windows","body":"<p>I created a new project using the command:</p>\n\n<blockquote>\n  <p>rails new simple_cms -d mysql </p>\n</blockquote>\n\n<p>but when I try to launch the web server, this happens:  </p>\n\n<pre><code>C:\\Users\\johnny\\Sites\\simple_cms&gt;rails server\nC:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in `require': 193: %1 is not a valid Win32 application.   - C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/1.9/mysql2.so (LoadError)\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.rb:2:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2.rb:9:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2.rb:9:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:68:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:66:in `each'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:66:in `block in require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:55:in `each'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler/runtime.rb:55:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.1/lib/bundler.rb:119:in `require'\n    from C:/Users/johnny/Sites/simple_cms/config/application.rb:7:in `&lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:53:in `require'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:53:in `block in &lt;top (required)&gt;'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:50:in `tap'\n    from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.2/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n\nC:\\Users\\johnny\\Sites\\simple_cms&gt;\n</code></pre>\n\n<p>Some version info just in case:</p>\n\n<pre><code>C:\\Users\\j\\Sites\\simple_cms&gt;ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mingw32]\n\nC:\\Users\\j\\Sites\\simple_cms&gt;ruby -v\nruby 1.9.3p125 (2012-02-16) [i386-mingw32]\n\nC:\\Users\\j\\Sites\\simple_cms&gt;mysql --version\nmysql  Ver 14.14 Distrib 5.5.21, for Win64 (x86)\n</code></pre>\n\n<p>I've already searched the web looking for solutions, but none of them\nseem to work. Any help would be greatly appreciated, thank you.</p>\n"},{"tags":["ruby-on-rails-3","devise","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13141038,"title":"Update user attributes without changing password in rails_admin","body":"<p>In my app, I use devise to generate User model, add some attributes like job, role,... to this.\nIn rails_admin page, when edit an user, I only show fields: email, job, role, idcard (no include password and password_confirmation fields)\nWhen I click Save, it show error because the password is shorter than 6 characters.\nIn the console, if I try</p>\n\n<pre><code>User.last.update_attributes(:role =&gt; \"admin\", \"idcard\" =&gt; \"1233131\")\n</code></pre>\n\n<p>It'll get the same error!\nHow can I fix this? Because the rails_admin (I think and be sure) didn't use update in registrations_controller to update user!</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13194406,"title":"how to remove single quotes(') in ruby on rails","body":"<pre><code>@content = \"&lt;p&gt;&lt;span style=\\\"font-family: 'trebuchet ms', 'geneva'; font-size: 'large';\\\"&gt;Helo's&lt;/span&gt;&lt;/p&gt;\"\n</code></pre>\n\n<p>I want to remove single quotes (<code>'</code>) from <code>&lt;style&gt;</code> but not from the <code>Helo's</code>. Right now I'm using this but this remove all the single quotes(<code>'</code>).</p>\n\n<pre><code>@content.gsub(/'/,\"\")\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13195839,"title":"image_tag doesn't behave","body":"<p>OK, we are ALL at a loss here. Trying to display an image with image_tag. The path is stored in a sqlite3 varchar(64) field, with quotes around it. The field is called imagepath.</p>\n\n<p>On the show page...</p>\n\n<p>This: &lt;%=@invitem.imagepath%>\ngives me THIS:\n\"/images/5585L.jpg\"\"</p>\n\n<p>This:\n&lt;%=image_tag(@invitem.imagepath) %></p>\n\n<p>gives me THIS:\n5585l (note the lower case L)</p>\n\n<p>This:\n&lt;%=image_tag(\"/images/6287L.jpg\")%>\nRenders the image I want.</p>\n\n<p>Anybody got a clue?\nStuart</p>\n"},{"tags":["ruby-on-rails-3","rvm"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":29,"score":-1,"question_id":13192730,"title":"RVM Installation","body":"<p>I am trying to install rvm on ubuntu 11.10.\nI have installed it using following command through curl.</p>\n\n<p><code>curl -L get.rvm.io | bash -s stable --auto</code></p>\n\n<p>On terminal it specifies that rvm has been installed properly and I have checked .rvm directory has been created properly in my home directory and in .rvm directory version file is present but when I write rvm -v on terminal it gives following msg</p>\n\n<p><code>~$ rvm -v\nThe program 'rvm' is currently not installed.  You can install it by typing: sudo apt-get install ruby-rvm</code></p>\n\n<p>Please help.</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13194003,"title":"Can I use CSS assets and the public folder in the same app?","body":"<p>I have a legacy application that I'd like to migrate to use the Rails 3 asset pipeline. I have upwards of 100 stylesheets which are imported on a template by template basis using a </p>\n\n<pre><code>content_for :stylesheets\n</code></pre>\n\n<p>block.</p>\n\n<p>Compiling them all into a single stylesheet is not currently a goer as the code was written to expect only certain stylesheets on certain pages, so for example the login page imports a stylesheet which redefines <em>article form</em>. It would not be good to redefine this on all pages.</p>\n\n<p>Is there a way to migrate slowly to the assets pipeline having the app look first for a <strong>compiled asset</strong>, and then having it failover to the <strong>public/stylesheets</strong> directory?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13031774,"title":"custom actions inside rails_admin gem","body":"<p>I don't understand very good yet how it works <a href=\"https://github.com/sferik/rails_admin\" rel=\"nofollow\">rails_admin gem</a> for create a new action.</p>\n\n<p>I want create a action with name <strong>balance</strong> in rails_admin root.</p>\n\n<p>I have created a file with name <strong>rails_admin_balance.rb</strong> inside <strong>myapp/lib</strong> folder like:</p>\n\n<pre><code>require 'rails_admin/config/actions'\nrequire 'rails_admin/config/actions/base'\n\nmodule RailsAdminBalance\nend\n\nmodule RailsAdmin\n  module Config\n    module Actions\n      class Balance &lt; RailsAdmin::Config::Actions::Base\n       RailsAdmin::Config::Actions.register(self)\n        register_instance_option :object_level do\n          true\n        end\n        register_instance_option :link_icon do\n         'icon-eye-open'\n        end\n        register_instance_option :root? do\n          true\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>I have created a new file on <strong>/views/rails_admin/main/balance.html.erb</strong></p>\n\n<p>inside my <code>rails_admin.rb</code> file I have</p>\n\n<pre><code>config.actions do\n dashboard                     # mandatory\n # collection actions \n index                         # mandatory\n new\n export\n history_index\n bulk_delete\n # member actions\n show\n edit\n delete\n history_show\n show_in_app\n balance \nend\n</code></pre>\n\n<p>When I try run rails server I get this error:</p>\n\n<p>Exiting</p>\n\n<pre><code>/home/ubuntu/Desktop/myapp/config/initializers/rails_admin.rb:33:in `block (2 levels) in &lt;top (required)&gt;': undefined method `balance' for RailsAdmin::Config::Actions:Module (NoMethodError)....\n</code></pre>\n\n<p>Where have I the error?</p>\n\n<p>What am I doing bad?</p>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12029862,"title":"how add test data to my local sqlite in rails 3?","body":"<p>I need to add rows of test data to my sqlite.</p>\n\n<pre><code>INSERT INTO courses (`name`) VALUES\n(‘java'),\n(‘ruby').......\n</code></pre>\n\n<p>How can i do it with rails3?</p>\n\n<p>Thanks</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13194916,"title":"Act_as_taggable_on tags belonging to user","body":"<p>I am struggling to use act_as_taggable_on and rails3-jquery-autocomplete together.</p>\n\n<p>In my case tage name should belong to different users. So when a user starts typing only tag names created by the user should show up in autocomplete.</p>\n\n<p>For that I somehow have to modify act_as_taggable_on to also save the id of the user.\n(I don't care about the user creating the actual tag. But I need all the tag names the user already used)</p>\n\n<p>Until now all tag names created by all users are shown in autocomplete.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","diacritics"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12005739,"title":"Replace Umlauts in Ruby on Rails","body":"<p>i call a method before i save data and want to replace umlauts in a string like so:</p>\n\n<pre><code>def replace_chars\nself.slug = self.slug.gsub(/[äöüß]/) do |match|\n  case match\n    when \"ä\" 'ae'\n    when \"ö\" 'oe'\n    when \"ü\" 'ue'\n    when \"ß\" 'ss'\n  end\nend\nend\n</code></pre>\n\n<p>my problem is, that i want to save the new string into the slug.\nhow can i do this?</p>\n\n<p>Thanks a lot,</p>\n\n<p>Peter</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":65,"score":2,"question_id":13193905,"title":"jQuery not working on Rails 3.2.8","body":"<p>I'm having an issue with jQuery on Rails 3.2.8. I've installed the jquery-rails gem and my application.js has the following:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require_tree .\n</code></pre>\n\n<p>views/layouts/application.html.erb has</p>\n\n<pre><code>&lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>A simple Javascript test in test.js:</p>\n\n<pre><code>if (jQuery) {\nalert('Jquery is loaded')\n} else {\nalert ('Jquery is not loaded')\n}\n</code></pre>\n\n<p>gives me an alert telling me that jQuery is indeed loaded.</p>\n\n<p>However, no jQuery commands will work, even basic ones are unresponsive:</p>\n\n<pre><code>$(document).ready(function(){\n $(\"a\").click(function(event){\n alert(\"Thanks for visiting!\");\n});\n});\n</code></pre>\n\n<p>I've tried everything -- even reincluding jQuery through the Google API. Any ideas on what might be going on?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13193640,"title":"Rails undefined method for ActiveRecord::Relation error calculating cart items","body":"<p>I'm trying to calculate a total price for all the items contained within a cart. However I'm getting a <code>undefined method total_cart_price for ActiveRecord::Relation:xxx</code></p>\n\n<p><strong>Shop Cart Model (shop_cart.rb)</strong></p>\n\n<pre><code>has_many :shop_cart_items, :dependent =&gt; :destroy\n\n\n  def total_cart_price\n    shop_cart_items.to_a.sum { |item| item.total_price }\n  end\n</code></pre>\n\n<p><strong>Shop Cart Item Model (shop_cart_item.rb)</strong></p>\n\n<pre><code>attr_accessible :quantity, :shop_cart_id, :shop_product_id\n\n  belongs_to :shop_product\n  belongs_to :shop_cart\n\n\n  def total_price\n    shop_product.sell * quantity\n  end\n</code></pre>\n\n<p><strong>Basket View (shop/basket.html.erb)</strong></p>\n\n<pre><code>&lt;tbody&gt;\n    &lt;% @cart_items.each do |item| %&gt;\n        &lt;tr&gt;\n        &lt;td&gt;&lt;%= item.shop_product.name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.shop_product.sell) %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= number_to_currency(item.total_price) %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;% end %&gt;\n    &lt;tr&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;/td&gt;\n    &lt;td&gt;Subtotal:&lt;/td&gt;\n    &lt;td&gt;&lt;%= number_to_currency(@cart_items.total_cart_price) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>The total price, for a single item, works fine; the error is trying to calculate a sum of all the items.</p>\n\n<p>I do not have a shop_cart controller or views as I am calling the methods from a shop#basket view - not sure if this is what is causing the problem?</p>\n\n<p>Any help much appreciated.</p>\n"},{"tags":["ruby","regex","ruby-on-rails-3","substring"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13192578,"title":"Fetching the substring contained between two specific words","body":"<p>I wanted to know how to proceed when I am interested in the text contained between particular words.\neg.</p>\n\n<pre><code>@var = \"Hi, I want to extract container_start ONLY THIS DYNAMIC CONTENT container_end from the message contained between the container_start and container_end \"\n</code></pre>\n\n<p>Now I want to extract the CAPITALIZED content from the string i.e. dynamic but always contained after the two containers (<code>container_start</code> and <code>container_end</code>)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","callback","rails-engines"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13193314,"title":"The customized callbacks in Rails Engine can't be triggered","body":"<p>I meet a problem after I moved some of my code into rails engine. Before, the model file order.rb and some customized callback files were put in the main app folder, like:</p>\n\n<pre><code>MyProject\n|- app\n    |- models\n    |    |- order.rb\n    |\n    |- callbacks\n         |- order_callback.rb\n</code></pre>\n\n<p>And the file contents are: </p>\n\n<pre><code># order.rb\nclass Order &lt; ActiveRecord::Base\n  include OrderCallback\nend\n\n# order_callback.rb\nmodule OrderCallback\n  extend ActiveSupport::Concern\n\n  included do\n    p '-------------- included ----------------'\n    before_create :set_default_values\n  end\n\n  def set_default_values\n    p '------------- set default values ------------'\n  end\nend\n</code></pre>\n\n<p>And I add the app/callbacks dir into the autoload_paths, everything worked fine, the two traces are both printed.</p>\n\n<p>The problem happened after I moved these code into a rails engine. I added the app/callbacks to the engine config.autoload_paths, and can see the first trace which means the callback module is included, but I can't get the second trace when I create an order.</p>\n\n<p>I tried to move the callback to be an observer, it works fine. But I don't want it to be an observer for some reason.</p>\n\n<p>Anyone knows the reason? Thanks! </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":208,"score":1,"question_id":11570924,"title":"Ruby on Rails: How to override the 'show' route of a resource?","body":"<p>Currently I have a route that looks like this:</p>\n\n<pre><code>resources :posts\n</code></pre>\n\n<p>I want to override the 'show' action so that I can display a url like this:</p>\n\n<pre><code>posts/:id/:slug\n</code></pre>\n\n<p>I am currently able to do this by adding a custom <code>match</code> route:</p>\n\n<pre><code>resources :posts\nmatch 'posts/:id/:slug' =&gt; 'posts#show'\n</code></pre>\n\n<p>However, when I use the <code>link_to</code> helper, it does not use my custom show route.</p>\n\n<pre><code>&lt;%= link_to 'show', post %&gt;  # renders /posts/123\n</code></pre>\n\n<p>How can I define my show route so that I can still use the <code>link_to</code> helper?</p>\n\n<p><strong>Update:</strong> As you can read in the following answers, you can override the route to the 'show' action, but it's probably more work than it's worth. It's easier to just create a custom route:</p>\n\n<pre><code># config/routes.rb\nmatch 'posts/:id/:slug' =&gt; 'posts#show', as: 'post_seo'\n\n# app/views/posts/index.html.erb\n&lt;%= link_to post.title, post_seo_path(post.id, post.slug) %&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","remedy"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13192426,"title":"accessing a database from ruby using an odbc driver (Remedy)","body":"<p>I have the Remedy odbc driver installed on my machine. I am able to pull down data from Remedy via excel just fine specifying this driver in my connection.</p>\n\n<p>Is there any way I could use this driver from within Ruby / Ruby on rails to connect to and read from the DB? </p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","nested-resources","nested-routes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13191798,"title":"Nested resource and restricting the Routes Created :only and :except","body":"<p>Good day all,</p>\n\n<p>Can someone kindly assist me with nested resources and its best practice.</p>\n\n<p>I would like to restrict my <code>:events</code> route to only <code>:show</code> and <code>:index</code>, is this the correct way of doing it?</p>\n\n<pre><code>resources :events do\n    resources :registrations, :except =&gt; [:index]\nend\n\nresources :events, :only =&gt; [:index, :show]\n</code></pre>\n\n<p>Is this the best way or the way more Rubyist would handle such thing? I've added two lines of <code>resources :events</code> or is there a way to combine it all in 1 block?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hmvc"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":13066048,"title":"Dissecting ruby on rails model, view, controllers and routes for a large project","body":"<p>I want to  separate model view controllers in HMVC form including routes.After reading i found that ruby on rails  does not support HMVC structure.Is there any alternative of doing it?. I also want to separate routes module wise.\nPlease suggest some best ways of doing it as keeping everything in one place is hard to manage.Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","security","devise","cancan","rails-admin"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13179927,"title":"CanCan and Boolean User Authorization - Security Risk?","body":"<p>For using Multiple \"roles\" on Users in rails_admin CanCan seems to be a great choice. So I added a Boolean Attribute \"admin\" to the User-Model and tell CanCan to allow access to rails_admin only if this is present. </p>\n\n<p>But isn't this a security issue? How can I be sure, that nobody is able to change the attribute?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13184770,"title":"Nested Model Form. Belongs_to class not displaying","body":"<p>I have a Subject Model and a Lesson Model.\nI implemented a nested model form.</p>\n\n<p>After subject creation, I led it to a page where it supposedly shows the lessons associated. However, I fail to see the lessons.</p>\n\n<p>I believe the data for lessons did not get saved properly as \nWhen I did a for example lesson.find_by_subject_id('1'), I get 'nil' in return.</p>\n\n<p>I am trying to figure out how polymorphism works on rails and would appreciate it if someone could either point out where I've gone wrong or give me some guidance on how those to pass the values for belong_to classes to be created.</p>\n\n<p>Subject Model</p>\n\n<pre><code>attr_accessible :subjectCode, :lessons_attributes\nhas_many :lessons, :dependent =&gt; :destroy\naccepts_nested_attributes_for :lessons, :reject_if =&gt; lambda { |a| a[:content].blank? }, :allow_destroy =&gt; true\n</code></pre>\n\n<p>Lesson Model</p>\n\n<pre><code>attr_accessible :lessonName, :subject, :subject_id\nbelongs_to :subject\n</code></pre>\n\n<p>Subject Controller</p>\n\n<pre><code>def new\n3.times {@subject.lessons.build}\nend\n\ndef create\n  @subject = Subject.new(params[:subject])\n  if @subject.save\n    redirect_to @subject, :notice =&gt; \"Successfully created subject.\"\n  else\n    render :action =&gt; 'new'\n  end\nend\n</code></pre>\n\n<p>Form</p>\n\n<pre><code>&lt;%= form_for @subject do |f| %&gt;\n  &lt;%= f.error_messages %&gt;\n  &lt;p&gt;\n    &lt;%= f.label :subjectCode %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :subjectCode %&gt;\n  &lt;/p&gt;\n\n  &lt;%= f.fields_for :lessons do |builder| %&gt;\n    &lt;p&gt;    \n    &lt;%= builder.label :lessonName %&gt; &lt;br/&gt;\n    &lt;%= builder.text_area :lessonName, :rows=&gt;3 %&gt;\n    &lt;/p&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= f.submit \"Submit\" %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Routes\n    resources :subjects do resources :lessons end</p>\n"},{"tags":["ajax","ruby-on-rails-3","mobile","jquery-mobile"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":123,"score":0,"question_id":11408866,"title":"rails 3, jquery mobile: param lost in ajax call (remote => true)","body":"<p>In a rails3 application with jquery mobile I am having a problem when using a link_to with :remote => true because the parameters passed in the link are ignored. I have been looking around in the several posts discussing problems between remote => true and jquery mobile but they don't seem to be exactly the same problem.</p>\n\n<p>Here the code:</p>\n\n<pre><code>&lt;%= link_to _('mobile|contacts|Show next'), mobile_contacts_path(:page =&gt; @my_relations.next.number),\n    :data =&gt; { :role =&gt; 'button', :remote =&gt; true}, :class =&gt; compact' %&gt;\n</code></pre>\n\n<p>When clicking the link in the phone the call is actually working fine and the view is rendered, only thing is that the :page parameter is not passed (so the \"page\" one is rendered again and again).</p>\n\n<pre><code>Started GET \"/de_de/mobile/contacts\" for 10.0.173.62 at Tue Jul 10 09:13:00 +0200 2012\n2012.07.10 09:13:00 - INFO - #14570: Processing by Mobile::ContactsController#index as JS\n2012.07.10 09:13:00 - INFO - #14570:   Parameters: {\"locale\"=&gt;\"de_de\"}\n</code></pre>\n\n<p>On the other hand the link is working fine when trying it in the desktop computer browser:</p>\n\n<pre><code>Started GET \"/de_de/mobile/contacts?page=3\" for 127.0.0.1 at Tue Jul 10 09:12:03 +0200 2012\n2012.07.10 09:12:03 - INFO - #14570: Processing by Mobile::ContactsController#index as JS\n2012.07.10 09:12:03 - INFO - #14570:   Parameters: {\"page\"=&gt;\"3\", \"locale\"=&gt;\"de_de\"}\n</code></pre>\n\n<p>The parameter is also passed when removing :remote => true from the link_to.</p>\n\n<p>Any ideas? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","introspection"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13190724,"title":"Rails: list accepted values of \"validates :inclusion\" field","body":"<p>I have a model like this</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  attr_accessible :kind, :question, :state\n  belongs_to :section\n  validates :question, :kind, :state, :presence =&gt; true\n  validates :question, :uniqueness =&gt; {:scope =&gt; [:section_id]}\n  validates :kind, :inclusion =&gt; {:in =&gt; %w(radio check stars)}\n  validates :state, :inclusion =&gt; {:in =&gt; %w(new active answered canceled)}\nend\n</code></pre>\n\n<p>is it posible to list all accepted values for some field ? For example get the list of %w(radio check stars) from the field \"kind\"</p>\n"},{"tags":["ruby-on-rails-3","capistrano","less-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13190644,"title":"Cannot call method 'charAt' of undefined","body":"<p>I am having rails3 application which running fine in my local ubuntu machine. I deployed my application using capistrano-unicorn to remote server via copy. The remote server is also having a same configuration which I had in local machine like</p>\n\n<pre><code>rvm 1.16.17\nruby 1.9.3p286\nRails 3.2.8\nless 2.2.2\nless-rails 2.2.6\nless-rails-bootstrap 2.2.0\n</code></pre>\n\n<p>My Gemfile </p>\n\n<pre><code>group :assets do\n  gem 'less-rails-bootstrap'\n  gem 'therubyracer'\n  gem 'uglifier'\nend\n</code></pre>\n\n<p>I am getting an error</p>\n\n<blockquote>\n  <p>Less::Error in User/home#index Cannot call method 'charAt' of\n  undefined   (in\n  /home/user/rails_app_development/releases/20121102052832/app/assets/stylesheets/layout.css.less)</p>\n</blockquote>\n\n<p>Where I am doing wrong here?</p>\n"},{"tags":["ruby-on-rails-3","cocoon"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":105,"score":1,"question_id":10730780,"title":"cocoon, link_to_remove_association with confirm?","body":"<p>is there an easy way to add confirm dialog box that would appear when user clicks link_to_remove_association ?</p>\n\n<p>cocoon gem is really great, I wonder if it has such a ready option ?? if not, can I use jQuery to cancel or let go the event ?</p>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13189968,"title":"Display no of listings on a page in Ruby on Rails","body":"<p>I'm working with an RoR project where I've implemented a search page which is working fine, what I'm looking to achieve is <a href=\"http://screencast.com/t/Rp7Ytncbut\" rel=\"nofollow\">the number of listings</a>.</p>\n\n<p>Actually, what I've used here is hardcoded HTML since I don't know what code or gem to use. Any suggestions how I can achieve this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","generate"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":271,"score":1,"question_id":4340682,"title":"How can I generate older rails application when current version is 3.0.3","body":"<p>I have 2 different Rails Rubygems installed on my Linux OS [2.3.8 and 3.0.3] , but the current active Rails version is 3.0.3. So is it possible to generate Rails app using 2.3.8 style generator:<code>rails testapp</code> not new one: <code>rails new testapp</code> ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller","refresh"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":36,"score":2,"question_id":13188055,"title":"Rails controller method execution","body":"<p>Suppose I have a Rails controller method, which is executed when the user submits a form. Now, the user submits the form, and while the method is running (and hasn't rendered the next page to the user), the user hits \"Refresh\". What is going to happen? Will the method stop running and restart, or will there be another thread to run the method once more?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13188163,"title":"Rails Route Configuration","body":"<p>I have a series of items I would wish to edit. When editing the current format of my URL appears as such:</p>\n\n<pre><code>http://mysite/items &lt;---- Lists the items\nhttp://mysite/items/1/ &lt;------ more detailed view of items\nhttp://mysite/items/1/edit &lt;----- Ability to edit the item\n</code></pre>\n\n<p>The routing configuration I would like to try and apply to my structure would like something like this:</p>\n\n<pre><code>http://mysite/items &lt;---- Lists the items\nhttp://mysite/item &lt;---- Detailed view of the item by sending the item ID as POST data\nhttp://mysite/item/edit &lt;---- Edits the item by sending the item ID as POST data\n</code></pre>\n\n<p>Is this strictly an event of the rails route configuration or do I have to configure the links in the <code>items</code> page to structure the URL specifically.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13188154,"title":"Loop dates and list vertically","body":"<p>I am trying to list dates of the month vertically, so far my table looks as followed: </p>\n\n<p><img src=\"http://i.stack.imgur.com/Ek5Lk.png\" alt=\"enter image description here\"></p>\n\n<p>I have today's date however I need to list 18 days from today vertically. As well as generate the cells against these dates. From my index.html.erb I understand that  I have the following <code>@dates</code> variable isn't being set properly in my controller. </p>\n\n<blockquote>\n  <p><code>@dates</code> variable isn't being set properly, if you add the statement\n  &lt;%= debug @dates %> to your view you can inspect what it's being</p>\n</blockquote>\n\n<p>Controller: <a href=\"https://gist.github.com/3998126\" rel=\"nofollow\">Gist - Controller.rb </a></p>\n\n<p>Index: <a href=\"https://gist.github.com/3998129\" rel=\"nofollow\">Gist - Index.html.erb</a></p>\n\n<p>Model: <a href=\"https://gist.github.com/3998134\" rel=\"nofollow\">Gist - Model.rb </a></p>\n\n<p>I understand that I will need to change my controller's index action so it is able to list 18 days from today. I was thinking of doing something somewhat similar.. - <code>Time.now+18.days</code> However I am not sure if something like this would solve my problems? As I'm not fully sure how to implement this into my controller. What is the best possible solution?</p>\n"},{"tags":["ruby-on-rails-3","apache","phusion-passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13188803,"title":"What are all the configurable timeouts in an Apache/Passenger/Rails stack?","body":"<p>I'm really interested in what all the timeout configurations are in my Rails (3.0.0) server's stack, and ideally, what those timeouts mean in plainish English.</p>\n\n<p>The impetus for my curiosity is receiving a \"SocketException: Connection reset\" from a Java client that makes RESTful calls to a Rails server, and trying to figure out what timeouts would cause my server's internal processing to cut short before sending a response (the Rails server itself makes another service call in the code path under question).</p>\n\n<p>So basically I have a broad question (all configurable timeouts) and a narrow question (connection reset issue), and I'm hoping an awesomely thorough and well-written answer to the broad will in turn answer the narrow.</p>\n\n<p>All I know so far:</p>\n\n<p>Apache 2.2:<br>\n<a href=\"http://httpd.apache.org/docs/2.2/mod/core.html#timeout\" rel=\"nofollow\">TimeOut</a>: default = 300 seconds<br>\nSeems like more of a client read/write timeout than waiting on the internals to generate the response.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","where-clause"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1029,"score":2,"question_id":6260288,"title":"How do you do a Rails 3 select IN using where clauses","body":"<p>I am using Rails 3 and I need to do a select where the primary key of the records is IN a resulting previous select.  You can do this easily using straight SQL using an IN.  Here is the obviously incorrect way I have done what I need.  What's the Rails way to do this well:</p>\n\n<pre><code>@task = Link.find(params[:id])\nclients = Client.where('task_id = ?',@task.id).select('DISTINCT(company_id)')\ncompany_list = []\nclients.each do |client|\n  company_ids &lt;&lt; client.company_id\nend\n@companies = Company.where(:id =&gt; company_ids)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13187726,"title":"Cancan authorize custom module","body":"<p>I have a custom module in my lib directory that I load in my Application controller. I started using cancan and now I am getting Access Denied error for all the actions in my custom module. I don't want cancan to check authorization on my custom module. One way to get around this is to use <code>except =&gt; [:action_name_in_my_custom_module]</code> but I have lot of actions that I use in my application at many places. I need a better solution. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":13021586,"title":"\"Failed to load resource\" errors for .js and .css files when running Rails application offline in development environment","body":"<p>I'm trying to get a Rails application to work offline. The application appears to work OK when online.</p>\n\n<p>In Chrome, when the server is running, I see this from the Chrome console when I run the application (portions snipped). :</p>\n\n<pre><code>Document was loaded from Application Cache with manifest\nhttp://localhost:3000/application.manifest\nApplication Cache Checking event\nApplication Cache Downloading event\n...\nApplication Cache Progress event (5 of 16) http://localhost:3000/assets/todos.css.scss\nApplication Cache Progress event (6 of 16) http://localhost:3000/assets/application.css\nApplication Cache Progress event (7 of 16) http://localhost:3000/assets/todos.js.coffee\nApplication Cache Progress event (8 of 16) http://localhost:3000/assets/jquery.tmpl.js\nApplication Cache Progress event (9 of 16) http://localhost:3000/assets/jquery.offline.js\n...\nApplication Cache Progress event (11 of 16) http://localhost:3000/assets/jquery.js\n...\nApplication Cache Progress event (13 of 16) http://localhost:3000/assets/json.js\nApplication Cache Progress event (14 of 16) http://localhost:3000/assets/scaffolds.css.scss\nApplication Cache Progress event (15 of 16) http://localhost:3000/assets/application.js\nApplication Cache Progress event (16 of 16) \nApplication Cache UpdateReady event\n</code></pre>\n\n<p>However, offline I see this (again, some snipped). Note that the <code>GET</code> lines are load errors.:</p>\n\n<pre><code>Document was loaded from Application Cache with manifest http://localhost:3000/application.manifest\nApplication Cache Checking event\nGET http://localhost:3000/assets/application.css?body=1  todos:5\nGET http://localhost:3000/assets/scaffolds.css?body=1  todos:6\nGET http://localhost:3000/assets/todos.css?body=1  todos:7\nGET http://localhost:3000/assets/jquery.js?body=1  todos:8\nGET http://localhost:3000/assets/jquery_ujs.js?body=1  todos:8\nGET http://localhost:3000/assets/jquery.offline.js?body=1  todos:8\nGET http://localhost:3000/assets/jquery.tmpl.js?body=1  todos:8\nGET http://localhost:3000/assets/json.js?body=1  todos:8\nGET http://localhost:3000/assets/offline.js?body=1  todos:8\nGET http://localhost:3000/assets/todos.js?body=1  todos:8\nGET http://localhost:3000/assets/application.js?body=1  todos:8\nApplication Cache Error event: Manifest fetch failed (-1) http://localhost:3000/application.manifest\n</code></pre>\n\n<p>In particular, I notice <code>?body=1</code> is appended to the file name when offline.</p>\n\n<p><strong>Environment:</strong></p>\n\n<ul>\n<li>Rails: 3.2.8</li>\n<li>ruby 1.9.3p194</li>\n<li>WEBrick: 1.3.1</li>\n<li>MySQL: 5.5.28 MySQL Community Server</li>\n<li>Chrome: Version 22.0.1229.94 m</li>\n<li>OS: Windows 7 Enterprise version 6.1 (Build 7601: Service Pack 1)</li>\n</ul>\n\n<p><strong>Gems</strong> (the gems I think are relevant):</p>\n\n<ul>\n<li>jquery-rails (2.1.3)</li>\n<li>json (1.7.5, 1.5.4)</li>\n<li>rack-offline (0.6.4)</li>\n<li>sprockets (2.1.3)</li>\n</ul>\n\n<p><strong>Application Manifest</strong>:</p>\n\n<pre><code>CACHE MANIFEST\n# ef05db1f746b226b3eb8b3673d65d3585eb8a9e1e35f79a6fc9d90693ff9a569\n404.html\n422.html\n500.html\nindex.html\nassets/application.js\nassets/jquery.js\nassets/jquery.offline.js\nassets/jquery.tmpl.js\nassets/json.js\nassets/todos.js.coffee\nassets/application.css\nassets/scaffolds.css.scss\nassets/todos.css.scss\n\nNETWORK:\n/\n</code></pre>\n\n<p><strong>application.html.erb</strong>:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html manifest=\"/application.manifest\"&gt;\n&lt;head&gt;\n    &lt;title&gt;TestOffsite&lt;/title&gt;\n    &lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n    &lt;%= javascript_include_tag \"application\" %&gt;\n    &lt;%= csrf_meta_tags %&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;%= yield %&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>todos_controller.erb</strong> (snipped):</p>\n\n<pre><code>class TodosController &lt; ApplicationController\n  # GET /todos\n  # GET /todos.json\n  respond_to :html, :json   \n\n  def index\n    @todos = Todo.all\nrespond_with(@todos)\n    #respond_to do |format|\n    #  format.html # index.html.erb\n    #  format.json { render json: @todos }\n    #end\n  end\n...\n</code></pre>\n\n<p><strong>Contents of manifest.yml</strong>:</p>\n\n<pre><code>---\nrails.png: rails-be8732dac73d845ac5b142c8fb5f9fb0.png\napplication.js: application-39fb9cbdc400e6885a41059ea60f3851.js\napplication.css: application-0149f820dbdd285aa65e241569d8c256.css\n</code></pre>\n\n<p>Any help is much appreciated.</p>\n"},{"tags":["ruby-on-rails-3","forms","associations","nested-attributes","virtual-attribute"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13168697,"title":"UnknownAttributeError using build for virtual attribute","body":"<p>I have a nested form containing virtual attributes :card_number and :card_verification.  When I try to build with these in the controller update action, I get ActiveRecord::UnknownAttributeError.</p>\n\n<p>The models have a simple has_one relationship, where an appointment has_one order</p>\n\n<pre><code>#/models/appointment.rb\nclass Appointment &lt; ActiveRecord::Base\n  has_one :order\n  accepts_nested_attributes_for :order\n\n  attr_accessible (...)\nend\n\n#/models/order.rb\nclass Order &lt; ActiveRecord::Base\n  belongs_to :appointment\n\n  attr_accessible :email, (...)\n  attr_accessor :card_number, :card_verification\nend\n</code></pre>\n\n<p>I'm generating the form like this:</p>\n\n<pre><code># /views/appointments/edit.html.erb\n&lt;%= form_for @appointment do |f| %&gt;\n  ...\n  &lt;%= f.fields_for @appointment.order do |builder| %&gt;\n    &lt;%= builder.label :email %&gt;\n    &lt;%= builder.text_field :email %&gt; # works fine on its own\n    ...\n    &lt;%= f.label :card_number %&gt;\n    &lt;%= f.text_field :card_number %&gt;\n\n    &lt;%= f.label :card_verification %&gt;\n    &lt;%= f.text_field :card_verification %&gt;\n  &lt;% end %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>And building in the controller:</p>\n\n<pre><code># /controllers/appointments_controller.rb\ndef update\n  @appointment = Appointment.find(params[:id])\n  @order = @appointment.build_order(params[:appointment]['order']) # This line is failing\n\n  if @appointment.update_attributes(params[:appointment].except('order'))\n    # ... Success\n  else\n    # ... Failure\n  end\nend\n</code></pre>\n\n<p>With this, I'm getting the error <code>Can't mass-assign protected attributes: card_number, card_verification</code> when I try to submit for update, with params:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"_method\"=&gt;\"put\",\n \"authenticity_token\"=&gt;\"KowchWLNmD9YtPhWhYfrNAOsDfhb7XHW5u4kdZ4MJ4=\",\n \"appointment\"=&gt;{\"business_name\"=&gt;\"Name\",\n \"contact_method\"=&gt;\"Phone\",\n \"contact_id\"=&gt;\"555-123-4567\",\n \"order\"=&gt;{\"email\"=&gt;\"user@example.com\",\n \"first_name\"=&gt;\"John\",\n \"last_name\"=&gt;\"Doe\",\n \"card_number\"=&gt;\"4111111111111111\", # normally [FILTERED]\n \"card_verification\"=&gt;\"123\", # normally [FILTERED]\n \"card_type\"=&gt;\"visa\",\n \"card_expires_on(1i)\"=&gt;\"2015\",\n \"card_expires_on(2i)\"=&gt;\"11\",\n \"card_expires_on(3i)\"=&gt;\"1\",\n \"address_line_1\"=&gt;\"123 Main St\",\n \"address_line_2\"=&gt;\"\",\n \"city\"=&gt;\"Anywhere\",\n \"state\"=&gt;\"CA\",\n \"country\"=&gt;\"USA\",\n \"postal_code\"=&gt;\"90210\"}},\n \"commit\"=&gt;\"Submit\",\n \"id\"=&gt;\"2\"}\n</code></pre>\n\n<p>Everything works fine without the :card_number and :card_verification values included in the form.</p>\n\n<p>Does anyone know what is going wrong here?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I can get this working with:</p>\n\n<pre><code>@order = @appointment.build_order(params[:appointment]['order'].except('card_number', 'card_verification'))\n</code></pre>\n\n<p>but this seems a bit clunky.  Are there any other ways to get around this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13187076,"title":"Paginating an Array in Ruby with will_paginate","body":"<p>I have an array @level1 which looks like this :</p>\n\n<pre><code>[[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4], ............]\n</code></pre>\n\n<p>I want to apply pagination on this array such each page displays only a few rows at once. I tried this:</p>\n\n<pre><code>@temp1 = @level1.paginate(:page =&gt; params[:page])\n</code></pre>\n\n<p>But it throws the following error: </p>\n\n<pre><code>undefined method `paginate' for [[3.0, 4, 2], [2.0, 48, 3], [2.1, 56, 4]]:Array\n</code></pre>\n\n<p>How can I perform pagination on this using will_paginate?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":120,"score":1,"question_id":10553433,"title":"simple_format and 2+ newline(\\n)","body":"<p>I'm using rails and need to show text, having 3 or more newline characters in a row.</p>\n\n<p>I found <code>simple_format</code> method, but it works with 2,3,4,... symbols identically</p>\n\n<blockquote>\n  <p>Two or more consecutive newlines(\\n\\n) are considered as a paragraph and wrapped in &lt; p > tags. </p>\n</blockquote>\n\n<p>For example, my text is</p>\n\n<pre><code>1.9.3p0 :015 &gt; Article.last.text\n=&gt; \"1\\n\\n2\\n\\n\\n\\n33\" \n</code></pre>\n\n<p>when i do <code>&lt;%= simple_format Article.last.text.html_safe %&gt;</code> it generates me this view:</p>\n\n<pre><code>&lt;p&gt;1&lt;/p&gt;\n&lt;p&gt;2&lt;/p&gt;\n# but i need &lt;br/&gt; or smth else there\n&lt;p&gt;3&lt;/p&gt;\n</code></pre>\n\n<p>Other solutions are welcome, thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13186142,"title":"Modifying a SQL query for use with 'will_paginate' in Ruby","body":"<p>I have the following SQL query which I use to fetch some rows from a mySQL database :</p>\n\n<pre><code>SELECT code_ver, result FROM mastertest WHERE date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\n</code></pre>\n\n<p>This query gives me data from the past 90 days. Now I want to display the data of 10 days at a time in my html.erb page (view). I am aware that pagination can be done using 'will_paginate' and 'kaminari' gems. But I am not sure how to query the database with certain conditions as shown above.</p>\n\n<p>Can someone help me with the code here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13186592,"title":"Rails routes and helper functions","body":"<p>I have defined the following route on my routes file:</p>\n\n<pre><code>match \"/users/:id/courses\", :to =&gt; 'users#courses'\n</code></pre>\n\n<p>Do you know what is the helper function that is generated for that route?</p>\n\n<p>I have tried this:</p>\n\n<pre><code>users_courses_path(current_user)\nuser_courses_path(current_user)\nusers_course_path(current_user)\nuser_course_path(current_user)\n</code></pre>\n\n<p>But none of those works</p>\n\n<p>Regards</p>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13186281,"title":"Stripping Phone Numbers of Non-numeric Values During SQL Query in Rails","body":"<p>I have a list of new restaurants and I want to check them against a database of restaurants using the phone number. The problem with phone numbers is that they have different formatting in the database (i.e. <code>123-345-6789</code> or <code>(123)-456 8988</code>).</p>\n\n<p>So far, I have created an index for the phone so that I search through them quickly. I also stripped the phone number of the new restaurants so that they only contain numeric values (0-9).</p>\n\n<p>Now, I want to strip the databases' numbers right before I compare so that I will strictly comparing numbers.</p>\n\n<pre><code>#strip the phone of non-numeric values and spaces\nformatted_phone = SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\") \n\nRestaurant.where(contact_phone: formatted_phone).each do |r|\n  #irrelevant code here\nend\n</code></pre>\n\n<p>The problem with the above code is that contact_phone (from database) will be in its non-stripped format. My research so far has lead me to believe that I have to use something like <code>REGEXP_LIKE</code>, but I'm not quite sure how to implement this with Rails. I do NOT want to update the database - I simply want to strip the numbers for comparison while still keeping the original formatting in the DB.</p>\n\n<p>How do I strip the phone numbers, <code>contact_phone</code>, of non-numeric values from the database before I compare it with <code>formatted_phone</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","fancybox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13186480,"title":"fancybox ajax rails degrading properly","body":"<p>I have a fancybox.ajax fancybox and in the controller</p>\n\n<pre><code>respond_to do |format|\n  format.html\n  format.js\nend\n</code></pre>\n\n<p>Then I have show.html.erb and _show.html.erb and show.js.erb</p>\n\n<p>But it is taking show.html.erb and putting it in the fancybox (including my application.html layout).</p>\n\n<p>I want both because I want to direct ppl to a url to get the html, and inapp users to have a lightbox.</p>\n\n<p>thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":145,"score":3,"question_id":11598116,"title":"ActiveAdmin display default view content","body":"<p>I am working with ActiveAdmin and need to make customizations to some views and have come across a couple of scenarios I feel I am doing wrong.</p>\n\n<p>I am adding an additional table to a show view (comments on Posts). This requires me to rewrite the whole attributes table and then add my panel. Is there a way to customize views without losing the default content?</p>\n\n<p>I would also like to add a table of associated items on the show view which doesn't need to be customized is there any way to include the default tale that would normally be on the index view with default actions and paging?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","belongs-to","activeadmin"],"answer_count":3,"favorite_count":8,"up_vote_count":12,"down_vote_count":0,"view_count":2032,"score":12,"question_id":7198062,"title":"Nested form in active_admin with select or create option","body":"<p>We are using active_admin for our administration backend. </p>\n\n<p>We have a model \"App\" that :belongs_to model \"Publisher\":</p>\n\n<pre><code>class App &lt; ActiveRecord::Base\n  belongs_to :publisher\nend\n\nclass Publisher &lt; ActiveRecord::Base\n  has_many :apps\nend\n</code></pre>\n\n<p>When creating a new entry for the \"App\" model I want to have the option to either select an existing publisher or (if the publisher is not yet created) to create a new publisher in the same (nested) form (or at least without leaving the page).</p>\n\n<p>Is there a way to do this in active_admin?</p>\n\n<p>Here's what we have so far (in admin/app.rb):</p>\n\n<pre><code>form :html =&gt; { :enctype =&gt; \"multipart/form-data\" } do |f|\n  f.inputs do\n    f.input :title\n    ...\n  end\n\n  f.inputs do\n    f.semantic_fields_for :publisher do |p| # this is for has_many assocs, right?\n      p.input :name\n    end\n  end\n\n  f.buttons\nend\n</code></pre>\n\n<p>After hours of searching, I'd appreciate any hint... Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13107076,"title":"Rails, attribute confirmation","body":"<p>I don't like how Rails confirmation validations attach the message \"doesn't match confirmation\" to the parent attribute...</p>\n\n<pre><code>validates(:password, {confirmation: true})\n</code></pre>\n\n<p>It makes more sense from a UX standpoint that an error should be passed to the confirmation, \"does not match password\", when the two don't match.</p>\n\n<p>Adding any validations to a confirmation attribute seem to be ignored...</p>\n\n<pre><code>validates(:password_confirmation, {my_validation: true, length: {maximum: 3}})\n</code></pre>\n\n<p>**<code>length</code> validation is just for testing purposes. Note that there's no error on the Password Confirmation field in this screenshot:</p>\n\n<p><img src=\"http://i.stack.imgur.com/e7sio.png\" alt=\"form screenshot\"></p>\n\n<p>I created a custom validation, <code>better_validation</code>:</p>\n\n<pre><code>class BetterConfirmationValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attr_name, value)\n    parent_attr = attr_name.to_s\n    parent_attr['_confirmation'] = ''\n    unless value == record.send(parent_attr)\n      record.errors.add(attr_name, :better_confirmation, options.merge(:value =&gt; value))\n    end\n  end\nend\n</code></pre>\n\n<p>But it doesn't work unless I name the confirmation field something different (i.e. add an 's' on the end...<code>:password_confirmations</code>).</p>\n\n<p>Is there a way to tell Rails not to take over and let me apply validations to <code>foo_confirmation</code> attributes?</p>\n\n<p>Thanks!</p>\n\n<h2>Edit</h2>\n\n<p>Model code...</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name, :email, :password, :password_confirmation\n  attr_accessor :password, :password_confirmation\n\n  validates :name,\n    presence: true,\n    length: { maximum: 50 }\n  validates :email,\n    presence: true,\n    format: { with: /\\A.+@[a-z\\d\\-.]+\\z/i },\n    uniqueness: true\n  validates :password,\n    length: { minimum: 6, maximum: 255 },\n    presence: { on: :create }\n  validates :password_confirmation,\n    presence: true,\n    better_confirmation: true\n.\n.\n.\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","memcached"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13186003,"title":"Does the CacheStore session store use memcached if that is my cache store?","body":"<p>What a question, eh?</p>\n\n<p>If you read this article: <a href=\"http://guides.rubyonrails.org/action_controller_overview.html#session\" rel=\"nofollow\">http://guides.rubyonrails.org/action_controller_overview.html#session</a></p>\n\n<p>...you will see it suggest using 'ActionDispatch::Session::CacheStore' instead of '...MemCacheStore'</p>\n\n<p>So, my question is, if memcached is my cache store, and I set my session store to 'CacheStore', will my session data be available to multiple rails/app instances via memcached?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":441,"score":1,"question_id":5207521,"title":"Ruby/Rails Parsing Emails","body":"<p>I'm currently using the following to parse emails:</p>\n\n<pre><code>  def parse_emails(emails)\n    valid_emails, invalid_emails = [], []\n    unless emails.nil?\n      emails.split(/, ?/).each do |full_email|\n        unless full_email.blank?\n          if full_email.index(/\\&lt;.+\\&gt;/)\n            email = full_email.match(/\\&lt;.*\\&gt;/)[0].gsub(/[\\&lt;\\&gt;]/, \"\").strip\n          else\n            email = full_email.strip\n          end\n          email = email.delete(\"&lt;\").delete(\"&gt;\")\n          email_address = EmailVeracity::Address.new(email)\n          if email_address.valid?\n            valid_emails &lt;&lt; email \n          else\n            invalid_emails &lt;&lt; email\n          end\n        end\n      end                    \n    end\n    return valid_emails, invalid_emails\n  end\n</code></pre>\n\n<p>The problem I'm having is given an email like:</p>\n\n<pre><code>Bob Smith &lt;bob@smith.com&gt;\n</code></pre>\n\n<p>The code above is delete Bob Smith and only returning bob@smith.</p>\n\n<p>But what I want is an hash of FNAME, LNAME, EMAIL. Where fname and lname are optional but email is not.</p>\n\n<p>What type of ruby object would I use for that and how would I create such a record in the code above?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","rspec","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":26,"score":2,"question_id":13185552,"title":"How do I test a controller with rspec-rails?","body":"<p>I want to test that my edit recipe page renders using rspec, though it doesn’t route to </p>\n\n<pre><code>    recipes/edit\n</code></pre>\n\n<p>it routes to recipes/id/edit (id being replaced with a number)</p>\n\n<p>my current test looks like this</p>\n\n<pre><code> describe \"Show Edit Recipe Page\" do\n\n  it \"should display edit recipe  page\" do\n    get :edit\n    response.should be_success\n    response.should render_template(:edit)\n  end\nend\n</code></pre>\n\n<p>how can i test this page correctly, at the moment my tests are failing</p>\n"},{"tags":["ruby-on-rails-3","rake","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":178,"score":1,"question_id":12313612,"title":"rake assets:precompile undefined method `[]' for nil:NilClass","body":"<p>I'm trying to get a new production server up and running and it is so close. When I execute</p>\n\n<pre><code>RAILS_ENV=production rake assets:precompile\n</code></pre>\n\n<p>This error is returned</p>\n\n<pre><code>undefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>When I run it with a --trace, this is retuned</p>\n\n<pre><code>$RAILS_ENV=production rake assets:precompile --trace\n** Invoke assets:precompile (first_time)\n** Execute assets:precompile\nrake aborted!\nundefined method `[]' for nil:NilClass\n  (in /home/deploy/pm/app/assets/stylesheets/jquery-ui-1.8.16.custom.css.scss)\n\nTasks: TOP =&gt; assets:precompile\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>I appreciated any help anyone can offer, ideas, etc.</p>\n\n<p>Here is the Gemfile and bundle list</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'cancan'\ngem 'client_side_validations'\ngem 'devise', '~&gt; 1.5.3'\ngem 'execjs'\ngem 'haml'\ngem 'httparty'\ngem 'jquery-rails'\ngem 'mysql2'\ngem 'paperclip', \"~&gt; 2.4\"\ngem 'rails', '3.1.0'\ngem 'rails3-jquery-autocomplete'\ngem 'rake', '0.9.2'\ngem 'remotipart', \"~&gt; 1.0\"\ngem 'simple_datatables'\ngem 'therubyracer'\ngem 'validates_timeliness', '~&gt; 3.0.2'\ngem 'will_paginate', '~&gt; 3.0'\n\ngem 'geocoder', '~&gt; 1.1.2'\n\n#temp for pm.onlinetherapy.com\ngem 'faker'\n\ngroup :test do\n    gem 'capybara'\n    gem 'cucumber-rails', :require =&gt; false\n    gem 'database_cleaner'\n    gem 'factory_girl_rails'\n    gem 'faker'\n    gem 'guard-rspec'\n    gem 'selenium-webdriver', '2.7.0'\n    gem 'webrat'\nend\ngroup :development, :test do\n    gem 'faker'\n    gem 'haml-rails'\n    gem 'hpricot'\n    gem 'rspec-rails'\n    gem 'ruby_parser'\n    gem 'web-app-theme', '~&gt; 0.8.0'\nend\n\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n    gem 'sprockets'\n    gem 'sass', '3.1.20'\n    gem 'sass-rails', '3.1.4' # downgraded to 3.1.4 to avoid a stack overflow error in rake assets:precompile\n    gem 'coffee-rails', \"~&gt; 3.1.0\"\n    gem 'uglifier'\nend\n\n# Use unicorn as the web server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n# gem 'capistrano'\n\n# To use debugger\n# bundle install has a problem installing linecache19, a dependency of ruby-debug19\n# try 'sudo gem install linecache19' to fix the problem, and then do bundle install again \ngem 'ruby-debug19', :require =&gt; 'ruby-debug'\n</code></pre>\n\n<p>And the <code>bundle list</code> gives</p>\n\n<pre><code>Gems included by the bundle:\n  * actionmailer (3.1.0)\n  * actionpack (3.1.0)\n  * activemodel (3.1.0)\n  * activerecord (3.1.0)\n  * activeresource (3.1.0)\n  * activesupport (3.1.0)\n  * archive-tar-minitar (0.5.2)\n  * arel (2.2.3)\n  * bcrypt-ruby (3.0.1)\n  * builder (3.0.2)\n  * bundler (1.2.0)\n  * cancan (1.6.8)\n  * capybara (1.1.2)\n  * childprocess (0.3.5)\n  * client_side_validations (3.1.4)\n  * cocaine (0.3.0)\n  * coffee-rails (3.1.1)\n  * coffee-script (2.2.0)\n  * coffee-script-source (1.3.3)\n  * columnize (0.3.6)\n  * cucumber (1.2.1)\n  * cucumber-rails (1.3.0)\n  * database_cleaner (0.8.0)\n  * devise (1.5.3)\n  * diff-lcs (1.1.3)\n  * erubis (2.7.0)\n  * execjs (1.4.0)\n  * factory_girl (4.0.0)\n  * factory_girl_rails (4.0.0)\n  * faker (1.0.1)\n  * ffi (1.1.5)\n  * geocoder (1.1.3)\n  * gherkin (2.11.2)\n  * guard (1.3.2)\n  * guard-rspec (1.2.1)\n  * haml (3.1.7)\n  * haml-rails (0.3.4)\n  * hike (1.2.1)\n  * hpricot (0.8.6)\n  * httparty (0.8.3)\n  * i18n (0.6.1)\n  * jquery-rails (2.1.2)\n  * json (1.7.5)\n  * json_pure (1.7.5)\n  * jsonify (0.3.1)\n  * jsonify-rails (0.3.2)\n  * libv8 (3.3.10.4)\n  * linecache19 (0.5.12)\n  * listen (0.5.0)\n  * mail (2.3.3)\n  * meta_search (1.1.3)\n  * mime-types (1.19)\n  * multi_json (1.3.6)\n  * multi_xml (0.5.1)\n  * mysql2 (0.3.11)\n  * nokogiri (1.5.5)\n  * orm_adapter (0.0.7)\n  * paperclip (2.7.0)\n  * polyamorous (0.5.0)\n  * polyglot (0.3.3)\n  * rack (1.3.6)\n  * rack-cache (1.0.3)\n  * rack-mount (0.8.3)\n  * rack-ssl (1.3.2)\n  * rack-test (0.6.1)\n  * rails (3.1.0)\n  * rails3-jquery-autocomplete (1.0.9)\n  * railties (3.1.0)\n  * rake (0.9.2)\n  * rdoc (3.12)\n  * remotipart (1.0.2)\n  * rspec (2.11.0)\n  * rspec-core (2.11.1)\n  * rspec-expectations (2.11.3)\n  * rspec-mocks (2.11.2)\n  * rspec-rails (2.11.0)\n  * ruby-debug-base19 (0.11.25)\n  * ruby-debug19 (0.11.6)\n  * ruby_core_source (0.1.5)\n  * ruby_parser (2.3.1)\n  * rubyzip (0.9.9)\n  * sass (3.1.20)\n  * sass-rails (3.1.4)\n  * selenium-webdriver (2.7.0)\n  * sexp_processor (3.2.0)\n  * simple_datatables (0.2.1)\n  * sprockets (2.0.4)\n  * therubyracer (0.10.2)\n  * thor (0.14.6)\n  * tilt (1.3.3)\n  * timeliness (0.3.6)\n  * treetop (1.4.10)\n  * tzinfo (0.3.33)\n  * uglifier (1.3.0)\n  * validates_timeliness (3.0.14)\n  * warden (1.2.1)\n  * web-app-theme (0.8.0)\n  * webrat (0.7.3)\n  * will_paginate (3.0.3)\n  * xpath (0.1.4)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":11983981,"title":"customising sphinx indexes in order to search on nested attributes","body":"<p>Is there a way in sphinx to define indices in a custom way.\nProblem - I have a product model and multiple admins exists in the system. each admin can take their own notes on every product. hence notes is not a simple text field. Rather, it is a separate model. Product as well as admin has_many notes. When a admin searches the product listing, i want to make sure that he is enabled to search only through his notes.</p>\n\n<p>I understand that sphinx indexes are stored in a document (internal to sphinx). For instance, all the indices of a product \"dell xps\" will be in a single document. It means that all the notes will  be in the same document. If only i have a way to store admin_id and notes of each product into separate sphinx documents, i can acheive my requirement of searching on my notes alone. That is, a dell product will have its indices across 3 documents if 3 people has made notes about it. FYI, Similar feature exists in elastic search. any help is appreciated. Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","forms","partial-views","form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13183506,"title":"rails form partial for new and edit on same page","body":"<p>I am running into issues trying to separate a form from a view into a partial. I want to use the same form for the new and edit views. These are both on the same page. The new model form is at the top of the page and uses a variable that I set in the controller.</p>\n\n<pre><code>&lt;%= form_for @new_hire do |f| %&gt;\n&lt;%= render :partial =&gt; 'new_hire_requests/form', :locals =&gt; {:f =&gt; f} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I then have a partial for the pending approvals that gets rendered by another partial</p>\n\n<pre><code>&lt;%= render :partial =&gt; 'pending_approval', :collection =&gt; @pending_approval %&gt;\n</code></pre>\n\n<p>And inside the pending approval partial I have this</p>\n\n<pre><code>&lt;%= form_for pending_approval do |f| %&gt;\n&lt;%= render :partial =&gt; 'new_hire_requests/form', :locals =&gt; {:f =&gt; f} %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is throwing an error</p>\n\n<pre><code>undefined method `new_hire_request_path' for #&lt;#&lt;Class:0x0000010488ac98&gt;:0x0000010223ffc0&gt;\n</code></pre>\n\n<p>Is there a way to re use the form code for both a new and edit form on the same page?</p>\n\n<p>Controller Logic</p>\n\n<pre><code>@new_hire = NewHireRequest.new\n@new_hire_requests = current_user.new_hire_requests\n@pending_approval = @new_hire_requests.select{|p| p.status == 'pending_hr_approval' || p.status == 'pending_exec_approval'}\n</code></pre>\n\n<p>Partial code</p>\n\n<pre><code>&lt;%= render 'shared/error_messages', object: f.object %&gt;\n\n&lt;fieldset class=\"first\"&gt;\n&lt;%= f.label :first_name, \"First Name\" %&gt;\n&lt;%= f.text_field :first_name %&gt;\n&lt;/fieldset&gt;\n&lt;fieldset&gt;\n&lt;%= f.label :last_name, \"Last Name\" %&gt;\n&lt;%= f.text_field :last_name %&gt;\n&lt;/fieldset&gt;\n&lt;%= f.submit \"Submit for Approval &lt;i class='icon-share-alt icon-white'&gt;&lt;/i&gt;\", \n        class: \"button_green\" %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13184960,"title":"No route matches :action => edit rails 3","body":"<p>I don’t understand why I am getting the above error message when trying to update a recipe</p>\n\n<p>This is my output of rake routes</p>\n\n<pre><code>      recipes GET    /recipes(.:format)                recipes#index\n              POST   /recipes(.:format)                recipes#create\n   new_recipe GET    /recipes/new(.:format)            recipes#new\n  edit_recipe GET    /recipes/:id/edit(.:format)       recipes#edit\n       recipe GET    /recipes/:id(.:format)            recipes#show\n              PUT    /recipes/:id(.:format)            recipes#update\n              DELETE /recipes/:id(.:format)            recipes#destroy\n         root        /                                 public_pages#index\n</code></pre>\n\n<p>My controller looks like this</p>\n\n<pre><code>def edit\n  @recipe = Recipe.find(params[:id])\nend\n\ndef update\n  @recipe = Recipe.find(params[:id])\n\n  if @recipe.update_attributes(params[:recipe])\n    redirect_to recipes_path, :notice =&gt; \"Successfully updated recipe\"\n  else \n    render :action =&gt; 'edit'\n  end\nend\n</code></pre>\n\n<p>And my link to edit the post</p>\n\n<pre><code>&lt;%= link_to \"Edit Recipe\", edit_recipe_path(@recipe) %&gt;\n</code></pre>\n\n<p>the full error is (this is when trying to access the recipes page</p>\n\n<pre><code>Routing Error\n\nNo route matches {:action=&gt;\"edit\", :controller=&gt;\"recipes\"}\n\nTry running rake routes for more information on available routes. \n</code></pre>\n\n<p>and finally the form i am using, now the only thing I can think of is that there is an issue with my form, though i thought that you could use the same form for new and edit? though i could be totally wrong</p>\n\n<p>Anyone have any ideas</p>\n"},{"tags":["ruby-on-rails-3","postgresql","roles"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":282,"score":2,"question_id":10213164,"title":"how do I set table ownership in rails with postgresql?","body":"<p>I'm very new to rails, so hope this is not a stupid question. </p>\n\n<p>I am trying to make rails use a postgresql database with two different user accounts. I want however to be able to switch between those accounts, so they have the same permissions on the database (without both of them being a postgresql superuser ideally).</p>\n\n<p>I created a <code>NOLOGIN</code> role in postgres, which is the owner of the database. Then assigned two user accounts to this role. However, whenever I do <code>rake db:migrate</code>, it will make the user account (and not the role) the owner of the <strong>table</strong>. If I then switch users, the second user won't have the right permissions on the tables created by the first user.</p>\n\n<p>The reason for having two account is to be able to switch quickly, e.g. when I need to change the password with no downtime.</p>\n\n<p><strong>Is there a way to tell rails to use a specific role as the owner when creating tables?</strong> (or perhaps there's a better way to accomplish this without two accounts in the same postgresql role?)</p>\n\n<p>UPDATE: So far I found <a href=\"http://stackoverflow.com/a/2686185/305019\">this solution</a> to run manually as an external script and change ownership of all tables to the NOLOGIN role, but am hoping for something more elegant or that fits well with rails.</p>\n"},{"tags":["ruby-on-rails-3","subdomain","reddit"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13184865,"title":"How can I implement reddit style sub instances of my website?","body":"<p>I have a website that I made using ruby on rails at www.tradespring.net. I want to create a bunch of instances, like www.tradespring.net/electronics, www.tradespring.net/automotive, ect. where these sub-sites work exactly the same as the original but each have their own set of posts, but users are the same across all sub-instances. </p>\n\n<p>Where could I start looking? I don't even know good keywords to google at the moment. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":8848672,"title":"Is it possible to update from an action/method other than the update action/method in Ruby on rails?","body":"<p>Is it possible to update from an action/method other than the update action/method?\nFor example in my users controller I already have an update method for other parts of my users account.</p>\n\n<p>I need a separate one for changing my users password. Is it possible to have something like this:</p>\n\n<pre><code>def another_method_to_update\n  user = User.authenticate(current_user.email, params[:current_password])\n  if user.update_attributes(params[:user])\n    login user\n    format.js   { render :js =&gt; \"window.location = '#{settings_account_path}'\" } \n    flash[:success] = \"Password updated\" \n  else\n    format.js   { render :form_errors }\n\n  end\nend\n</code></pre>\n\n<p>Then have my change password form know to use that method to perform the update?</p>\n\n<p>It has 3 fields:\ncurrent password\nnew password\nconfirm new password</p>\n\n<p>and I use ajax to show the form errors.</p>\n\n<p>Kind regards</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13151876,"title":"Paperclip styles not being created","body":"<p>Paperclip works fine in my rails 3 app, but its only creating one file.  The original file is 1600x1280, and only one file sized to 200 is being created.</p>\n\n<pre><code>  :styles =&gt; { :preview =&gt; \"500x500&gt;\", :full =&gt; \"100%\", :pdf_thumbnail =&gt; [\"200x200&gt;\", :jpg] },\n</code></pre>\n\n<p>The style being created is pdf_thumbnail.  And, for some reason paperclip is not creating an original.</p>\n\n<pre><code> paperclip (3.3.0)\n rails 3.2.8\n heroku, s3\n</code></pre>\n\n<p>Has something changed in 3.3.0?  Anyone know why paperclip is not creating the files?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","associations","activeadmin"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13130809,"title":"Custom Active Admin form inputs for has_and_belongs_to_many relationship","body":"<p>I have a very simple model</p>\n\n<pre><code>class Lifestyle &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_and_belongs_to_many :profiles\nend\n</code></pre>\n\n<p>that has a <code>has_and_belongs_to_many</code> relationship with <code>Profile</code></p>\n\n<pre><code>class Profile &lt; ActiveRecord::Base\n  attr_accessible ...\n\n  belongs_to :occupation\n\n  has_and_belongs_to_many :lifestyles\n  accepts_nested_attributes_for :lifestyles\nend\n</code></pre>\n\n<p>I want to use ActiveAdmin to edit the Profile object, but also assign Lifestyles to a profile. It should be similar to dealing with <code>belongs_to :occupation</code>, as this is sorted out automatically by ActiveAdmin to a dropbox with the options pre-filled with available occupations. </p>\n\n<p>I've tried to use the <code>has_many</code> form builder method, but that only got me to show a form to type in the name of the Lifestyle and on submission, it returned an error.</p>\n\n<pre><code>    f.object.lifestyles.build\n    f.has_many :lifestyles do |l|\n      l.input :name\n    end\n</code></pre>\n\n<p>Error I get:</p>\n\n<pre><code>Can't mass-assign protected attributes: lifestyles_attributes\n</code></pre>\n\n<p><strong>The perfect way for me would be to build several checkboxes</strong>, one for each Lifestyle in the DB. Selected means that the lifestyle is connected to the profile, and unselected means to delete the relation. </p>\n\n<p>I'm having great doubts that this is possible using ActiveAdmin and without having to create very complex logic to deal with this. <strong>I would really appreciate it if you'd give your opinion and advise me if I should go this way or approach it differently.</strong></p>\n"},{"tags":["ruby-on-rails-3","couchdb","couchrest","rails-api"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12822884,"title":"how to use rails-api gem with CouchRest model","body":"<p>I'm trying to set up a rails API using the rails-api gem <a href=\"https://github.com/spastorino/rails-api\" rel=\"nofollow\">rails-api</a> and <a href=\"https://github.com/couchrest/couchrest_model\" rel=\"nofollow\">couchrest model</a>.  Using rails-api strips out a lot of the middleware and modules and I believe that is why I'm getting the following error:</p>\n\n<pre><code>Started GET \"/assets\" for 127.0.0.1 at 2012-10-10 16:00:36 +0100\nConnecting to database specified by database.yml\n\nActiveRecord::ConnectionNotEstablished (ActiveRecord::ConnectionNotEstablished):\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:404:in `retrieve_connection'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_specification.rb:170:in `retrieve_connection'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_specification.rb:144:in `connection'\nactiverecord (3.2.8) lib/active_record/query_cache.rb:67:in `rescue in call'\nactiverecord (3.2.8) lib/active_record/query_cache.rb:61:in `call'\nactiverecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__2405051170962911444__call__2117088860059348020__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.8) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'\nrailties (3.2.8) lib/rails/engine.rb:479:in `call'\nrailties (3.2.8) lib/rails/application.rb:223:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/Users/jason/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\n/Users/jason/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\n/Users/jason/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n\n\nRendered /Users/jason/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (0.9ms)\nRendered /Users/jason/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.9ms)\nRendered /Users/jason/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (8.1ms)\n</code></pre>\n\n<p>Can anyone point out what modules and middleware I would need to include to get it working?\nThanks</p>\n"},{"tags":["mysql","ruby-on-rails-3","vps"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":354,"score":0,"question_id":10439949,"title":"Error when running rake db:migrate","body":"<p>I'm following the railscast where Ryan sets up a VPS. But I need to install mysql instead of postgresql.</p>\n\n<p>when I run the cap deploy:cold command, it all seems to run fine, until it runs the bundle, which fails when trying to install the mysql2 gem. </p>\n\n<p>so i logged into the server and installed it manually (the database had already been setup).</p>\n\n<p>but when i run the rake db:migrate command I keep getting this error:</p>\n\n<pre><code>rake aborted!\ndatabase configuration does not specify adapter\n\nTasks: TOP =&gt; db:migrate =&gt; db:load_config\n</code></pre>\n\n<p>in the database.yml file i have the following</p>\n\n<pre><code>production:\n  adapter: mysql2\n  encoding: utf8\n  reconnect: false\n  database: blog_production\n  pool: 5\n  username: blog\n  password: *****\n  host: localhost\n  socket: /var/run/mysqld/mysqld.sock\n</code></pre>\n\n<p>I've edited the socket from default, added and removed the host line, and installed the gem manually, but nothing seems to make it work!</p>\n"},{"tags":["ruby-on-rails-3","json","backbone.js","kendo-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13165999,"title":"Best way to get data from Rails 3 to Kendo UI","body":"<p>What is the best way to get data from Rails 3 to some of Kendo UI's data intensive widgets (mostly grid and graphs)?</p>\n\n<p>Lets say I have a Rails model which has data I want to show in Kendo's grid.  I imagine I will be passing that data via json.  But there seems to be many approaches to passing json data (gon, backbone.js,etc).  There is also the rails api approach (but I need the full rails for the other pages).</p>\n\n<p>I was about to sit down and learn backbone.js.  Is this a good approach?</p>\n\n<p>Thank You</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13184339,"title":"Issues with jQuery UI autocomplete when form added with Javascript","body":"<p>I can't seem to get autocomplete working with forms that I'm adding to the screen with javascript. For example, I am using my new route to render my object's form. Inside my new.js.erb in rails file I have the following:</p>\n\n<pre><code>$(\"div#container\").hide().html(\"&lt;%= escape_javascript render 'form' %&gt;\").fadeIn();\n</code></pre>\n\n<p>Once rendered, if I type into my input element:</p>\n\n<pre><code>&lt;input id=\"object_name\" name=\"object[name]\" placeholder=\"Name\" size=\"30\" type=\"text\"&gt;\n</code></pre>\n\n<p>And listen with it with javascript:</p>\n\n<pre><code>jQuery -&gt;\n  $('input#object_name').autocomplete\n    source: ['Test', 'Testing', 'Test 234']\n</code></pre>\n\n<p>I get nothing as far as autocomplete is concerned. If I copy and paste this form though and have it on the screen at load (and not added dynamically with my rails new path) it will work fine. How do I get autocomplete to listen to things that are added dynamically?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13183454,"title":"Loop and generate table cells","body":"<pre><code>I have a table that looks like the following: \n\n&lt;table class = \"rota\"&gt;\n    &lt;thead&gt;\n        &lt;th&gt;Date&lt;/th&gt; \n        &lt;% @hospitals.each do |hosp| %&gt;\n        &lt;th&gt;&lt;%= hosp.name%&gt;&lt;/th&gt;\n        &lt;% end %&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;%- if @rota_days.blank? %&gt;\n        &lt;tr&gt;\n            &lt;td colspan=\"&lt;%= @hospitals.count %&gt;\"&gt;No rota day&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end -%&gt;\n        &lt;% @dates.each do |date| %&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= date.inspect %&gt;&lt;/td&gt;\n\n            &lt;% end %&gt;\n        &lt;/tr&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>Which outputs the following: <a href=\"http://i.imgur.com/KseiT.png\" rel=\"nofollow\">Imgur</a></p>\n\n<p>I am trying to generate blank rows that contain empty cells. I cannot seem to identify where I am going wrong. What is the best possible solution </p>\n\n<p>Updated version </p>\n\n<pre><code>&lt;table class = \"rota\"&gt;\n    &lt;thead&gt;\n        &lt;th&gt;Date&lt;/th&gt; \n        &lt;% @hospitals.each do |hosp| %&gt;\n        &lt;th&gt;&lt;%= hosp.name%&gt;&lt;/th&gt;\n        &lt;% end %&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;%- if @rota_days.blank? %&gt;\n        &lt;tr&gt;\n            &lt;td colspan=\"&lt;%= @hospitals.count %&gt;\"&gt;No rota day&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end -%&gt;\n        &lt;% @dates.each do |date| %&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= date.inspect %&gt;&lt;/td&gt;\n            &lt;% (1..@hospitals.count).each do %&gt; \n                &lt;td&gt;&lt;/td&gt; \n            &lt;% end %&gt; \n           &lt;/tr&gt; \n            &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13183769,"title":"rails custom rest route with parameter","body":"<p>I have a questions controller and an associated model and a number of rest routes.  Here is how it's set up in routes.rb:</p>\n\n<pre><code>resources :questions \n</code></pre>\n\n<p>I want to add a custom route that has the format /questions/widget/ID (where ID is the id of the question for which I want to generate a widget).  I want this to be processed by the \"widget\" action in my questions controller.  I've tried a number of things such as:</p>\n\n<pre><code>resources :questions  do\n   member do\n      get 'widget/:id'\n   end\nend\n</code></pre>\n\n<p>But nothing is working.  I'm sure I'm missing something simple.  Any ideas?  Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13180317,"title":"Rails 3 - Marking dependent items archived when parent is archived","body":"<p>I'm not sure the title really explains correctly what i'm trying to do so forgive me. I have a table called clients for an invoicing system i've built.  I also have tables called projects and invoices.</p>\n\n<p>Here's an example (not the actual columns in the tables, just for an example) of my database structure.</p>\n\n<pre><code>Clients\n    id\n    name\n    description\n    archive\n\nProjects\n    id\n    client_id\n    name\n    description\n    archive\n\nProjects\n    id\n    client_id\n    project_id\n    name\n    description\n    archive\n</code></pre>\n\n<p>I have created the ability to archive a given invoice, project, or client independently.  However, i wanted to see what the best way to do this would be if i wanted to have say the projects and invoices for a client to be automatically marked as archived when i archive the client.  My process would be this:</p>\n\n<ul>\n<li>Archiving a client would archive the client, all projects with that client id, and all invoices with that same client id.</li>\n<li>Archiving a project would archive the project and all invoices with that project id.</li>\n<li>Archiving an invoice just archives the invoice itself</li>\n</ul>\n\n<p>NOTE: by \"archived\" i mean the archive bit gets flipped to 1 instead of 0 (not archived / active).</p>\n\n<p><strong>By the way</strong>, the way that you archive something is on the edit screen there is an \"Archive?\" checkbox that you would check off to archive the item.</p>\n\n<p>I know that in my edit action in my controller i can just say something like <code>if archive == 1</code> then run additional sql update statements to update dependent items <code>else @object.save</code> to just save the data for the edited item.</p>\n\n<h1>My question?</h1>\n\n<p>Is there a better way to do this? Is the way i mentioned generally the best practice? I am already using <code>:dependent =&gt; :destroy</code> elsewhere in the model to delete rows in associated tables when a \"parent\" item is deleted.  Is there something pre-built in to Rails that will allow me to mark things like i am trying to do through the relationships of the tables?</p>\n\n<p>Thanks for any help with this!  Hope i explained the problem and question well enough, but let me know if you have questions.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","capistrano","phusion-passenger"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13183541,"title":"How to get Rails 3 to run in production mode on server w/ Passenger","body":"<p>Hi I'm running Passenger/mySQL/mongo/Rails 3.2 with a Capistrano deploy script.</p>\n\n<p>I'm trying to get my app to run in production mode on my linux server.</p>\n\n<p>In my apache config file i have the following...</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n ServerName example.com\n ServerAlias www.example.com\n DocumentRoot /srv/www/example.com/current/public\n ErrorLog /srv/www/example.com/current/log/error.log\n CustomLog /srv/www/example.com/current/log/access.log combined\n PassengerDefaultUser www-data\n  &lt;Directory /srv/www/test.example.com/current/public&gt;\n     AllowOverride all\n     Options -MultiViews\n  &lt;/Directory&gt;\n RailsEnv production\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>In my environment.rb file I have the following...</p>\n\n<pre><code>RAILS_ENV=\"production\"\nRAILS_ENV.freeze\n</code></pre>\n\n<p>In my Capistrano deploy.rb I have the following...</p>\n\n<pre><code>set :rails_env, \"production\"\n</code></pre>\n\n<p>But when I deploy via capistrano on my homepage view I have the following line...</p>\n\n<pre><code>Running in &lt;%= Rails.env %&gt; mode\n</code></pre>\n\n<p>And it outputs \"Running in development mode\" when i hit that page after deployment.</p>\n\n<p>Also it is using the development database on my server as well.  What could I be missing to get this to run in production mode?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","architecture","software-engineering","sti"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":29,"score":0,"question_id":13183638,"title":"Software Engineering issue: Simple ResumeBank","body":"<p>I would like to create simple ResumeBank app.</p>\n\n<p><strong>Issue</strong>:</p>\n\n<ol>\n<li>As user I would like to add only two Resumes.</li>\n<li>Forms for this both Resumes are different with only two fields.</li>\n</ol>\n\n<p><strong>Question:</strong> </p>\n\n<ol>\n<li>Should I split that Resume model and tables to ex: PolishResume and EnglishResume, polish_remsumes and english_remsumes?</li>\n<li>Or maybe should I use <strong>STI</strong> and create PolishResume &lt; Resume and use one table.</li>\n<li>What are advantages and disadvantages of this two options? </li>\n</ol>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13183539,"title":"Rails 3 with devise undefined method `users_url`","body":"<p>I'm making some small changes to devise in order to overwrite the layout used and some other things so I decided to create my custom routes with controllers. I only added this to the routes so far:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; {\n    :sessions =&gt; \"sessions/user\",\n    :registrations =&gt; \"registrations/user\"\n}\n</code></pre>\n\n<p>which is supposed to load the login page when accessed by <code>/users/sign_in</code> and it does it very well. When I try to ajax post to that url in order to validate the user input and login I get this error: <code>NoMethodError (undefined method 'users_url' for #&lt;Sessions::UserController:0x000000041bed98&gt;):</code></p>\n\n<p>The controller is basic and nothing was changed to overwrote devise logic:</p>\n\n<pre><code>class Sessions::UserController &lt; Devise::SessionsController\n    layout \"login\" # The only addition. Rest is handled by devise\nend\n</code></pre>\n\n<p>I had this working for a good while but today I decided to use devise for another model (admins) and I generated it's files using the devise command <code>rails generate devise Admin</code> which completely messed my working code of logging in the users.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot","sunspot-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13182815,"title":"Solr Search Stripping Phone Number in Database before Comparison","body":"<p>I have a list of restaurants that I want to match with the restaurants in my database using phone number. The problem is that the numbers are formatted differently (i.e. <code>(123)123-1234</code> or <code>123 123-123</code> or other combinations).</p>\n\n<p>My current Solr search looks like this:</p>\n\n<pre><code>search = Restaurant.solr_search do\n  with(:phone, SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\"))\n  paginate page: 1, per_page: 15\nend\n</code></pre>\n\n<p><code>SunspotHelper.sanitize_term(pr.phone).gsub(/\\s+/, \"\")</code> will strip down my search query to just numbers. However, the values in my database still contain other non-numeric characters and thus, <code>search.hits</code> returns an empty array because I'm not getting any results.</p>\n\n<p>Is there a way to strip my database values (<code>:phone</code>) before Solr does a search?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","polymorphic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13181710,"title":"When using polymorphic relationships in rails, I can't use underscores in my has_many attribute name (Rails)","body":"<p>My application uses a polymorhpic relationship like so:</p>\n\n<pre><code>class Child &lt; ActiveRecord:Base\n  belongs_to :child_owner, polymorphic: true\nend\n\nclass Parent &lt; ActiveRecord:Base\n  has_many :children, as: :child_owner, dependent: :destroy\nend\n</code></pre>\n\n<p>This setup works fine. However, when I change the attribute name of <code>:children</code> to a multiword variable like <code>:kids_of_parent</code>, I get an unintialized constant exception (for Parent::KidsOfParent). In my case, the multiword variable would be much more descriptive. What am I doing wrong? Can someone at least confirm this behaviour?</p>\n\n<p>Thanks,</p>\n\n<p>Chris</p>\n\n<p>Using Rails 3.2.8 with ruby 1.9.3</p>\n"},{"tags":["ruby","ruby-on-rails-3","dojo"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13179556,"title":"Dojo BorderContainer widget won't render","body":"<p>I've created a layout with Maqetta. Now I want to add the logic to the layout. Therefore I have downloaded the whole workspace from Maqetta and imported the files/libaries into a new Rails project. At first I had some problems, that Rails didn't loaded the dojo,js file, but I've solved that problem.<br>\nNow I have another problem. The page won't render. I've commented everything out except one widget (a button) and this works fine. But if I undo this, nothing happens. Unfortunately I also don't get any warnings/errors or anything like that from dojo.<br>\nAfter a little bit trying, I changed the parseOnLoad property and now I get a warning:</p>\n\n<blockquote>\n  <p>Unhandled Error: Tried to register widget with id==appLayout but that id is already registered  </p>\n</blockquote>\n\n<p>Here is the include tag:</p>\n\n<pre><code>&lt;%= javascript_include_tag \"lib/dojo/dojo/dojo\", :'data-dojo-config' =&gt; \"'async':true,\n        'packages':[{'name':'maqetta','location':'../../maqetta'},{'name':'gridx','location':'../gridx'},{'name':'clipart','location':'../../clipart'},{'name':'shapes','location':'../../shapes'},\n        {'name':'maqettaSamples','location':'../../../samples'},{'name':'zazl','location':'../../zazl'},{'name':'widgets','location':'../../custom'}]\" %&gt;\n</code></pre>\n\n<p>Here is the HTML part (I have simplified it, and now I'm just useing the example from the tutorial):</p>\n\n<pre><code>&lt;body class=\"claro\" data-maq-flow-layout=\"true\" data-maq-ws=\"collapse\" id=\"myapp\" data-maq-appstates=\"{}\"&gt;\n\n&lt;input type=\"button\" data-dojo-type=\"dijit.form.Button\" intermediateChanges=\"false\" label=\"Search\" iconClass=\"dijitNoIcon\" onclick=\"alert('hi');\"&gt;&lt;/input&gt;\n&lt;div\nid=\"appLayout\" class=\"demoLayout\"\ndata-dojo-type=\"dijit/layout/BorderContainer\"\ndata-dojo-props=\"design: 'headline'\"&gt;\n    &lt;div\n    class=\"centerPanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'center'\"&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 1 Content&lt;/h4&gt;\n            &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 2 Content&lt;/h4&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;h4&gt;Group 3 Content&lt;/h4&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div\n    class=\"edgePanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'top'\"&gt;Header content (top)&lt;/div&gt;\n    &lt;div\n    id=\"leftCol\" class=\"edgePanel\"\n    data-dojo-type=\"dijit/layout/ContentPane\"\n    data-dojo-props=\"region: 'left', splitter: true\"&gt;Sidebar content (left)&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And here is the parser:</p>\n\n<pre><code>require([\"dojo/parser\",\"dojo/domReady!\"], function(parser){\n     parser.parse();\n});\n</code></pre>\n\n<p>I'm trying for hours now, and I'm still as clueless as at the beginning. Has somebody an idea what I can try?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13180920,"title":"saving on a model with has_many association","body":"<p>Here is my problem, I have three models:</p>\n\n<p>ProductModel</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :photo\n  has_many :votes\n\n  has_attached_file :photo, :styles =&gt; { :medium =&gt; \"300x300\" }\n\n  before_save { |product| product.title = title.titlecase }\n\n  validates :title, presence: true, uniqueness: { case_sensitive: false }\n  validates :photo, :attachment_presence =&gt; true\n\nend\n</code></pre>\n\n<p>UserModel</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    def self.from_omniauth(auth)\n      where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|\n        user.provider = auth.provider\n        user.uid = auth.uid\n        user.name = auth.info.name\n        user.oauth_token = auth.credentials.token\n        user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n        user.save!\n      end\n    end\nend\n</code></pre>\n\n<p>VoteModel</p>\n\n<pre><code>class Vote &lt; ActiveRecord::Base\n  belongs_to :product\n  attr_accessible :user_id\nend\n</code></pre>\n\n<p>Now I need to save on my VoteModel a record with the ProductId and the UserId. But I don't know how to do this, can anyone help me please?</p>\n\n<p>UPDATE</p>\n\n<hr>\n\n<p>here is my vote view</p>\n\n<pre><code>&lt;%= form_for @vote, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n    &lt;%= f.label :user_id %&gt;\n    &lt;%= f.text_field :user_id %&gt;\n\n    &lt;%= f.label :product_id %&gt;\n    &lt;%= f.text_field :product_id %&gt;\n\n    &lt;%= f.submit \"Crear Producto\" %&gt;\n&lt;% end %&gt;\n\n&lt;%= link_to 'Cancel', root_path %&gt;\n</code></pre>\n\n<p>and here is the controller </p>\n\n<pre><code>class VotesController &lt; ApplicationController\n\n    def create\n        @some_product = Product.find(params[:id])\n        some_user = current_user\n        vote = Vote.create(:user =&gt; some_user, :production =&gt; some_product)\n        save!\n    end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","pdfkit"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":459,"score":0,"question_id":8842284,"title":"Rails 3 and PDFKit, how can I convert an HTML file into a landscape orientation PDF?","body":"<p>I can convert HTML pages into PDF documents well. The problem is, I don't know how to convert the HTML file into a landscape orientation PDF. Is there a way to set that in the controller?</p>\n\n<p>From the controller...</p>\n\n<pre><code>def pdf_customer_shipments\n  @customer = Customer.find(params[:id])\n  @shipments = Shipment.where(\"customer_id = ? AND status = 'Open'\", @customer.id)\n  render :layout =&gt; 'pdf'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hosting","amazon-ec2","amazon-web-services"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":6011088,"title":"Setting up Amazon Webservices for Rails","body":"<p>I've been trying to set up a web server using EC2 on Amazon web services. \nUsing the <code>appstack-nginx-passenger-ree</code> AMI, I tried to set up the server.</p>\n\n<p>I put my ruby files in <code>/opt/sites</code> and I installed <em>passenger</em> and <em>apache2-dev</em> &amp; <em>apace2-mpm-fork</em>.\nI had to set up the apache config file. \nAfterwards what should I do?</p>\n\n<p>How do I set the path file of the ruby files and deploy them?\nHow can I start up the server and be able to look at it?</p>\n"},{"tags":["ruby-on-rails-3","entity-attribute-value"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13181604,"title":"has anyone used \"acts_as_eav_model\" gems","body":"<p>All,\nI got the latest gems \"acts_as_eav_model\" fork (for rails 3.2.x). But it looks like some of the rspec tests are failing. Spent the last week trying to fix them, did manage to fix 3 out of 4, but the last was cannot figure it out.\nSo if anyone has worked on this gem and was able to make it run, please let me know. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","guard","spork","minitest"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13166238,"title":"With Minitest+Guard+Spork, all test suites and support files are being reloaded on each run","body":"<p>I'm running into a problem where everything in my test setup, including Spork's prefork block, is being reloaded and invoked on each run. It is taking 5-8 seconds for a test to fire off after guard picks up a change even though this is a new project so there are minimal tests and I even have an SSD.</p>\n\n<p>Before I realized everything was reloading, I profiled it using the technique described by Jo Liss <a href=\"http://www.opinionatedprogrammer.com/2011/02/profiling-spork-for-faster-start-up-time/\" rel=\"nofollow\">here</a> and I've included those hanging requires but obviously that didn't help since it's all being reloaded anyway. However, that's when I noticed this:</p>\n\n<blockquote>\n  <p>Loaded Suite\n  test,test/controllers,test/controllers/manage,test/factories,test/functional/manage,test/helpers,test/helpers/manage,test/integration,test/models,test/support</p>\n</blockquote>\n\n<p>I'm not seeing why it would reload everything. This is my first attempt at setting up minitest+spork+guard (i should have just gone with rspec, sigh) so I'm hoping it's something stupid. I'm including everything in hopes that someone has run into it or can easily spot what I've missed. Thanks in advance! </p>\n\n<p>My files include:</p>\n\n<blockquote>\n  <p><strong>test_helper.rb</strong></p>\n</blockquote>\n\n<pre><code>require 'spork'\nSpork.prefork do\n  #MiniTest::Rails.override_testunit!\n  ENV[\"RAILS_ENV\"] = \"test\"\n  require File.expand_path('../../config/environment', __FILE__)\n  require 'guard'\n  require 'guard/interactors/readline'\n  require 'guard/ui'\n  require 'guard/interactors/coolline'\n  require 'guard/interactor'\n  require 'guard/dsl'\n  require 'guard/notifiers/rb_notifu'\n  require 'guard/notifier'\n  require 'guard/minitest/notifier'\n  require 'guard/minitest/runners/default_runner'\n  Dir[File.expand_path('test/support/*.rb')].each { |file| require file }\n  require \"mocha\"\n  Spork.trap_method(Rails::Application, :reload_routes!)\n  Spork.trap_method(Rails::Application::RoutesReloader, :reload!)\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>Guardfile</strong></p>\n</blockquote>\n\n<pre><code>guard 'bundler' do\n  watch('Gemfile')\n  # Uncomment next line if Gemfile contain `gemspec' command\n  # watch(/^.+\\.gemspec/)\nend\nguard 'spork', :wait =&gt; 65, :test_unit =&gt; false, :minitest =&gt; true, :minitest_env =&gt; { 'RAILS_ENV' =&gt; 'test' }, :bundler =&gt; true do\n  watch('config/application.rb')\n  watch('config/environment.rb')\n  watch(%r{^config/environments/.+\\.rb$})\n  watch(%r{^config/initializers/.+\\.rb$})\n  watch('Gemfile')\n  watch('Gemfile.lock')\n  watch('test/test_helper.rb') { \"test\" }\nend\n\nguard 'minitest' do\n  watch(%r|^test/test_helper\\.rb|)         { \"test\" }\n  watch(%r|^test/support/(.*)\\.rb|)         { \"test\" }\n  watch(%r{^test/.+_test\\.rb$})\n  watch(%r|^app/models/(.*)\\.rb|)          {|m| [\"test/models/#{m[1]}_test.rb\", \"test/integration/#{m[1]}_test.rb\"] }\n  watch(%r|^app/controllers/(.*)\\.rb|)     {|m| [\"test/controllers/#{m[1]}_test.rb\", \"test/integration/#{m[1]}_test.rb\"] }\n  watch(%r|^app/views/(.*)\\.html|)         {|m| \"test/integration/#{m[1]}_test.rb\" }\n  watch(%r|^app/objects/(.*)\\.rb|)         {|m| \"test/objects/#{m[1]}_object_test.rb\" }\nend\n\nguard 'livereload' do\n  watch(%r{app/.+\\.(erb|haml)})\n  watch(%r{app/helpers/.+\\.rb})\n  watch(%r{(public/|app/assets).+\\.(css|js|html)})\n  watch(%r{(app/assets/.+\\.css)\\.scss}) { |m| m[1] }\n  watch(%r{(app/assets/.+\\.js)\\.coffee}) { |m| m[1] }\n  watch(%r{config/locales/.+\\.yml})\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>support/minitest.rb</strong></p>\n</blockquote>\n\n<pre><code>#require \"minitest/autorun\"\nrequire \"minitest/rails\"\nrequire \"minitest/spec\"\nrequire \"minitest/pride\"\nrequire \"minitest/rails/shoulda\"\nrequire \"minitest/autorun\"\nrequire \"capybara/rails\"\n\nclass RequestSpec &lt; MiniTest::Spec\n  include Rails.application.routes.url_helpers\n  include Capybara::DSL\n  include Rails.application.routes.url_helpers\nend\n\nMiniTest::Spec.register_spec_type /integration$/i, RequestSpec\n#MiniTest::Spec.register_spec_type /object$/, MiniTest::Spec\n\nclass MiniTest::Rails::Controller\n  include Devise::TestHelpers\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>support/turn.rb</strong></p>\n</blockquote>\n\n<pre><code>require 'turn'\nrequire 'turn/autorun'\nrequire 'turn/colorize'\nrequire 'turn/reporter'\nrequire 'turn/reporters/pretty_reporter'\nTurn.config do |c|\n  c.natural = true\n  c.ansi = true\n  c.format = :pretty\nend\n</code></pre>\n\n<blockquote>\n  <p><strong>Gemfile</strong></p>\n</blockquote>\n\n<pre><code>source 'https://rubygems.org'\n\n# core\ngem 'rails', '3.2.8'\ngem 'thin'\n\n\n# infrastructure\ngem 'heroku'\ngem 'foreman', :groups =&gt; [:development, :test]\n\n# application monitoring\ngem 'airbrake'\ngem 'newrelic_rpm'\n\n\n# view engine\ngem 'haml', '&gt;= 3.1.7'\ngem 'haml-rails', '&gt;= 0.3.5'\ngem 'redcarpet' # markdown\n\n\n# data persistence\ngem 'mongoid', '&gt;= 3.0.5'\ngem 'redis'\ngem 'redis-store'\ngem 'redis-rails'\n\n\n# email\ngem 'sendgrid'\ngem 'mailcatcher', :group =&gt; [:development]\n\n\n# authentication and authorization\ngem 'devise', '&gt;= 2.1.2'\ngem 'omniauth', '&gt;= 1.0'\n#gem 'authority'\ngem 'cancan'\ngem 'rolify', '&gt;= 3.2.0'\n\n\n# view helpers\ngem 'bootstrap-generators', '~&gt; 2.1', :group =&gt; [:development]\ngem 'jquery-rails'\ngem 'simple_form', '&gt;= 2.0.2'\ngem 'rails3-jquery-autocomplete'\n\n\n# file attachments\ngem 'rmagick'\ngem 'fog'\ngem 'carrierwave'\ngem 'carrierwave-mongoid', :require =&gt; 'carrierwave/mongoid'\n\n\n# url helpers\ngem 'mongoid_slug'\n\n\n# console tools\ngem 'ansi',             :groups =&gt; [:development, :test]\ngem 'rack-livereload',  :groups =&gt; [:development]\ngem 'pry-rails',        :groups =&gt; [:development]\ngem 'growl',            :groups =&gt; [:development, :test]\ngem 'turn',             :groups =&gt; [:test]\ngem 'awesome_print'\ngem 'progress_bar',     :groups =&gt; [:test]\n\n\n# supporting libraries\ngem 'bson_ext'\ngem 'nokogiri',                  :group =&gt; :test\ngem 'ruby_parser', '&gt;= 2.3.1',   :group =&gt; :test\ngem 'rb-fsevent', '~&gt; 0.9.1',    :group =&gt; :development\n\n\n# assets\ngem 'less-rails',                 :group =&gt; :assets\ngem 'therubyracer', '&gt;= 0.10.2',  :group =&gt; :assets\ngem 'uglifier', '&gt;= 1.0.3',       :group =&gt; :assets\n\n\n# guard\ngem 'guard',                     :group =&gt; :development\ngem 'guard-livereload',          :group =&gt; :development\ngem 'guard-spork',               :group =&gt; :development\ngem 'guard-minitest',            :group =&gt; :development\ngem 'guard-bundler',             :group =&gt; :development\n\n\n# minitest\ngem 'spork-minitest',           :group =&gt; :test\ngem 'minitest-rails',           :group =&gt; :test\ngem 'minitest-rails-shoulda',   :group =&gt; :test,  :git =&gt; 'git://github.com/rawongithub/minitest-rails-shoulda.git' \ngem 'capybara_minitest_spec',   :group =&gt; :test\n\n\n# mocking\ngem 'mocha', :group =&gt; :test\n\n\n# http testing\ngem 'vcr',      :group =&gt; :test\ngem 'webmock',  :group =&gt; :test\n\n\n# factories\ngem 'factory_girl_rails'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13180850,"title":"Rails has_many :through with custom attribute?","body":"<p>I currently have a model for a vehicle, which has a custom method for defining an owner attribute:</p>\n\n<pre><code>def owners\n    @owners = sales.map(&amp;:customer) + quotes.map(&amp;:customer)\n    @owners = @owners.uniq\nend\n</code></pre>\n\n<p>This method seems to work just fine, and returns an array of owners for the vehicle.</p>\n\n<p>I am having a problem, however, when I want to use the <code>owners</code> that this method generates in another model. When I do this on another model:</p>\n\n<pre><code>has_many :owners, :through =&gt; :vehicles\n</code></pre>\n\n<p>This generates the error:</p>\n\n<pre><code>ActiveRecord::HasManyThroughSourceAssociationNotFoundError: Could not find the source association(s) :owner or :owners in model Vehicle.\n</code></pre>\n\n<p>I have tried adding <code>:source => :owners</code> but I get the same error.</p>\n\n<p>I should point out that I do have <code>:owners</code> in attr_accessible.</p>\n\n<p>So, can I do a :through association when owners is defined in a custom method, rather than being a normal variable?</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13163555,"title":"bootstrap css doesn't work","body":"<p>I use gem twitter-bootstrap-rails in my ruby on rails project.\nBut the css class \"icon-white\" doesn't work.\nI can see definiton of \"icon-white\" in gem toolkit.But in chrome dev tools,I can't find it.\nWhy?\nHow to solve? </p>\n\n<pre><code>&lt;h2&gt;Sign in&lt;/h2&gt;\n\n&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; session_path(resource_name)) do |f| %&gt;\n&lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;\n&lt;%= f.email_field :email %&gt;&lt;/div&gt;\n\n&lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;\n&lt;div class = \"icon-user icon-white\"&gt;&lt;/div&gt;\n&lt;%= f.password_field :password %&gt;&lt;/div&gt;\n\n&lt;% if devise_mapping.rememberable? -%&gt;\n&lt;div&gt;&lt;%= f.check_box :remember_me %&gt; &lt;%= f.label :remember_me %&gt;&lt;/div&gt;\n&lt;% end -%&gt;\n\n&lt;div&gt;&lt;%= f.submit \"Sign in\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;%= render \"devise/shared/links\" %&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13180710,"title":"Ruby on Rails - How to delegate to polymorphic associations?","body":"<p>Is it possible to use <code>delegate</code> with <code>has_many</code> or <code>has_one</code> association in a polymorphic model? How does that work?</p>\n\n<pre><code>class Generic &lt; ActiveRecord::Base\n    ...\n\n  belongs_to :generable, polymorphic: true\n\n  delegate :file_url, to: :image, allow_nil: true\n  delegate :type_cat, to: :cat, allow_nil: true\nend\n\nclass Image &lt; ActiveRecord::Base\n   ...\n  has_one :generic, as: generable, dependent: :destroy\nend\n\n\nclass Cat &lt; ActiveRecord::Base\n   ...\n  has_one :generic, as: generable, dependent: :destroy\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13171647,"title":"What does changing config.assets.version number do?","body":"<p>What does changing config.assets.version number do?</p>\n\n<p>I understand that the assets expire (as it is written in the comments) but what does it do in the background?</p>\n\n<p>would it delete all the compiled assets? or does it take that version number and uses it somewhere else?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13176037,"title":"undefined method `tripphoto_changed?' for ... Carrierwave","body":"<p>I'm trying to save an image when adding a new Trip via an association. </p>\n\n<p>tripphoto.rb has a <code>belongs_to :trip</code> </p>\n\n<p>and my trip.rb has a <code>has_many :tripphotos</code>. Furthermore the Carrierwave documentation requires a few more things like an uploader and such which I've set up correctly (It worked without the association!). </p>\n\n<p>Along with it I've got <code>mount_uploader :tripphoto, TripphotoUploader</code> in my trip.rb and <code>accepts_nested_attributes_for :tripphotos, allow_destroy: true</code> to get my form working properly as such:</p>\n\n<pre><code>    &lt;%= fields_for :tripphotos do |photo| %&gt;\n      Img &lt;%= photo.file_field :filename %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Nonetheless I get the error <code>undefined method</code>tripphoto_changed?' for #`. A quick Google has no fitting result. Any advice?</p>\n\n<p>P.S here's my Tripphoto table:</p>\n\n<pre><code>class Tripphoto &lt; ActiveRecord::Base {\n    :id =&gt; :integer,\n    :filename =&gt; :string,\n    :trip_id =&gt; :integer,\n    :created_at =&gt; :datetime,\n    :updated_at =&gt; :datetime\n}\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Edit: On request my Codes:</p>\n\n<p>Trip.rb</p>\n\n<pre><code>class Trip &lt; ActiveRecord::Base\n  attr_accessible :description, :title, :user_id, \n  :triplocations_attributes, :photo, :category_ids, \n  :start_city, :tripphotos, :img_url, :thumb_url, :images,\n  :tags_attributes\n\n  # validates :title, :length =&gt; {:minimum =&gt; 3}\n  # validates :description, :presence =&gt; true\n  # validates_associated :tags\n\n\n  has_many :triplocations, :dependent =&gt; :destroy\n  has_many :tripphotos, :dependent =&gt; :destroy\n\n  has_and_belongs_to_many :categories\n  has_and_belongs_to_many :tags\n\n\n  accepts_nested_attributes_for :triplocations, allow_destroy: true\n  accepts_nested_attributes_for :tripphotos, allow_destroy: true\n  accepts_nested_attributes_for :categories\n  accepts_nested_attributes_for :tags\n\n\n  mount_uploader :tripphoto, TripphotoUploader\nend\n</code></pre>\n\n<p>Tripphoto.rb</p>\n\n<pre><code>class Tripphoto &lt; ActiveRecord::Base\n  attr_accessible :filename, :trip_id\n  belongs_to :trip\nend\n</code></pre>\n\n<p>The complete trip form</p>\n\n<pre><code>&lt;%= form_for @trip, :html =&gt; {:multipart =&gt; true} do |a| %&gt; \n    &lt;%= a.label :title, \"Routetitel\" %&gt;\n    &lt;%= a.text_field :title %&gt;\n\n    &lt;%= a.label :description, \"Omschrijving\" %&gt;\n    &lt;%= a.text_area :description %&gt;\n\n    &lt;%= a.label :start_city, \"Stad\" %&gt;\n    &lt;%= a.text_field :start_city, :id =&gt; \"cityName\" %&gt;\n\n    &lt;% for category in Category.find(:all) %&gt;\n        &lt;div&gt;\n          &lt;%= check_box_tag \"trip[category_ids][]\", category.id, @trip.categories.include?(category) %&gt;\n          &lt;%= category.name %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n    &lt;%= a.fields_for :tags do |f| %&gt;\n        &lt;p&gt;\n            &lt;%= f.label :title, 'Steekwoorden:' %&gt;\n            &lt;%= f.text_field :title %&gt;\n        &lt;/p&gt; \n        &lt;div id=\"inputFields\"&gt;&lt;/div&gt;\n\n    &lt;% end %&gt;\n    &lt;div style=\"background: red;\"&gt;\n        &lt;%= fields_for :tripphotos do |photo| %&gt;\n          Img &lt;%= photo.file_field :filename %&gt;\n        &lt;% end %&gt;\n    &lt;/div&gt;\n\n\n    &lt;%= a.submit 'Verstuur' %&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13179695,"title":"Rails TextHelper \"highlight\" method for case-insensitive search","body":"<p>I am using Rails TextHelper \"highlight\" method for highlighting a search string.</p>\n\n<pre><code>&lt;%= simple_format highlight(\"Some test text\", \"some\") %&gt;\n</code></pre>\n\n<p>However, it seems to be case-sensitive. Is there a case-insensitive version of this function? Or maybe some option i'm missing?</p>\n"},{"tags":["ruby-on-rails-3","devise","routes","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13145622,"title":"Setting Devise omniauth_path_prefix doesn't work","body":"<p>I'm working on a Rails-based API. I recently started attempting to version it. (I'm using the <a href=\"https://github.com/bploetz/versionist\" rel=\"nofollow\">Versionist</a> gem, in case it matters) One version ('v2') uses Devise and Omniauth to authenticate users through Facebook/Twitter.</p>\n\n<p>I want all the routes associated with this version to have the appropriate version prefix (so <code>users/:username/foo</code> becomes <code>v2/users/:username/foo</code>, etc.), but I've already found out that putting <code>devise_for</code> inside the <code>api_version</code> block prevents the Devise helpers (<code>current_user</code>, <code>user_signed_in?</code>, etc.) from working, so it continues to live outside the block:</p>\n\n<p>routes.rb:</p>\n\n<pre><code>devise_for :user, :path =&gt; '', :controllers =&gt; {:omniauth_callbacks =&gt; 'users/omniauth_callbacks'}, :skip =&gt; [:registrations, :confirmations, :sessions, :passwords]\n\napi_version(:module =&gt; \"V2\", :path=&gt;\"v2\") do\n\n  resources :authentications, :only =&gt; [:update, :destroy]\n\n  devise_scope :user do\n    post 'login' =&gt; 'sessions#create', :as =&gt; 'user_session'\n    get 'logout' =&gt; 'sessions#destroy'\n    post 'password' =&gt; 'devise/passwords#create'\n    put 'password' =&gt; 'devise/passwords#update'\n  end\n\nend\n</code></pre>\n\n<p>Everything seemed great... except the Devise-generated omniauth routes:</p>\n\n<p>rake routes output:</p>\n\n<pre><code> user_omniauth_authorize      /auth/:provider(.:format)\n user_omniauth_callback       /auth/:action/callback(.:format)\n</code></pre>\n\n<p>Now, some google-fu revealed that there's a devise configuration setting for this, so I added the following to our devise initializer (<code>config/initializers/devise.rb</code>):</p>\n\n<pre><code>Devise.setup do |config|\n  config.omniauth_path_prefix = 'v2/auth'\nend\n</code></pre>\n\n<p>Now, rake routes produces paths that look sensible:</p>\n\n<pre><code>user_omniauth_authorize     /v2/auth/:provider(.:format)          v2/users/omniauth_callbacks#passthru {:provider=&gt;/(?!)/}\nuser_omniauth_callback      /v2/auth/:action/callback(.:format)          v2/users/omniauth_callbacks#(?-mix:(?!))\n</code></pre>\n\n<p>However, when I attempt to access this route by calling <code>api.localhost/v2/auth/facebook</code>, I get a routing error:</p>\n\n<pre><code>ActionController::RoutingError (No route matches [GET] \"/v2/auth/facebook\")\n</code></pre>\n\n<p>Any idea what's going on here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","declarative-authorization"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13148125,"title":"if_attribute doesn't work with multiple hash on declarative_authorization","body":"<p>I use declarative_authorization on Ruby on rails 3.1.</p>\n\n<p>A group has many albums (groupalbum), a group is create by one user (user_id in foreign key for group table).\nOnly the owner of the group can create albums.</p>\n\n<p>Here is my authorization_rules.rb :</p>\n\n<pre><code>has_permission_on [:group_albums], :to =&gt; [:create] do\n    if_attribute :group =&gt;  { :user =&gt; is_in { user.groups } }\nend\n</code></pre>\n\n<p>Here is my GroupAlbumsControler :</p>\n\n<pre><code>class GroupAlbumsController &lt; ApplicationController\n    before_filter :set_group_album_from_params, :only =&gt; :show\n    before_filter :set_group_album_new, :only =&gt; [:index, :new]\n    filter_access_to :all, :attribute_check =&gt; true\n    (...)\nend\n</code></pre>\n\n<p>But it doesn't work :</p>\n\n<pre><code>You are not allowed to access this action.\n</code></pre>\n\n<p>Even if I'm logged in with the owner of the group.</p>\n\n<p>Where is my mistake ?</p>\n"},{"tags":["ruby-on-rails-3","robots.txt"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13155503,"title":"Prevent Search Spiders from accessing a Rails 3 nested resource with robots.txt","body":"<p>I'm trying to prevent Google, Yahoo et al from hitting my /products/ID/purchase page and am unsure on how to do it.</p>\n\n<p>I currently block them from hitting sign in with the following:</p>\n\n<pre><code>User-agent: *\nDisallow: /sign_in\n</code></pre>\n\n<p>Can I do something like the following?</p>\n\n<pre><code>User-agent: *\nDisallow: /products/*/purchase\n</code></pre>\n\n<p>Or should it be:</p>\n\n<pre><code>User-agent: *\nDisallow: /purchase\n</code></pre>\n"},{"tags":["ruby-on-rails","deployment","ruby-on-rails-3","dreamhost"],"answer_count":8,"favorite_count":8,"up_vote_count":18,"down_vote_count":1,"view_count":7043,"score":17,"question_id":2250247,"title":"Rails 3 on dreamhost?","body":"<p>I'd like to deploy a small Rails 3 app on dreamhost (just for testing purposes, nothing serious) and I am wondering if anyone has done it already... Please choose one of the following:</p>\n\n<ol>\n<li>I did it and it's super easy, here's how: ...</li>\n<li>Though I didn't try it, it should be easy, here's how: ...</li>\n<li>It's quite complicated, but this should get you started: ....</li>\n<li>NO WAI!!!1!one!1 Set it up on slicehost or another non-shared hosting or you'll die a painful death trying to force it on DH</li>\n</ol>\n\n<p>Thoughts?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13168131,"title":"Save array of ActiveRecord objects?","body":"<p>In my view I do:</p>\n\n<pre><code>&lt;table border=\"1\"&gt;\n &lt;tr&gt;\n    &lt;th&gt;Question&lt;/th&gt;\n    &lt;th&gt;Counter&lt;/th&gt;\n    &lt;th&gt;Lastsent&lt;/th&gt;\n    &lt;th&gt;Email&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;% @email_stats.each do |email_stat| %&gt;\n&lt;% post = Post.find(email_stat.postId) %&gt;\n  &lt;% if post.posttype == 'Question' %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= post.question %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%=  email_stat.counter%&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= email_stat.lastsent %&gt;&lt;/t&gt;\n    &lt;td&gt;&lt;%=  text_field_tag 'email', email_stat.email%&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;%  end %&gt;\n &lt;/table&gt;\n</code></pre>\n\n<p>This is what I have: For some objects, the email will be \"blank\" so I want to display all the records in the table  and allow the moderator to enter an email and on click on save store it.</p>\n\n<p>I used <code>form_for</code> but it's used to save only a single object.</p>\n\n<p>What is the best way to send an array back to the server for saving?</p>\n"},{"tags":["ruby-on-rails-3","seo","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13177361,"title":"rails mongoid3 and SEO URLs","body":"<p>is there a good way to make \"friendly_ids\" for the mongoid3 gem?</p>\n\n<p><em>slugoid</em>  seems deprecated and <em>KEY</em> is not part of mongoid3 anymore.</p>\n\n<p>Any answer will be very helpful</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13178412,"title":"Using and in active record query","body":"<p>Is is allowed to use AND condition in active record? FOr example</p>\n\n<pre><code>Model.where(a&gt;b AND c&gt;d).all\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1091,"score":2,"question_id":4934194,"title":"\"Resulttype(#-614051528) expected, got String(#-608366078)\" with Many-to-Many association","body":"<p>Currently I'm creating something like a \"sports-managing-and-results-gathering-app\" in Rails 3. In this App I need to create several exercises which itself can have multiple 'resulttypes' (heartrate, distance in km, repititions, ...). And it should be possible to arrange the resulttypes in my prefered order. So, this is a classical many-to-many relationship.</p>\n\n<p>I came up with the following migrations:</p>\n\n<pre><code>    class CreateExercises &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises do |t|\n          t.integer :user_id\n          t.string :name\n          t.text :beschreibung\n          t.integer :resulttype_id\n          t.boolean :active, :default =&gt; true\n          t.timestamps\n        end\n      end\n      def self.down\n        drop_table :exercises\n      end\n    end\n\n    class CreateResulttypes &lt; ActiveRecord::Migration\n      def self.up\n        create_table :resulttypes do |t|\n          t.string :name\n          t.string :einheit\n          t.text :beschreibung\n\n          t.timestamps\n        end\n      end\n\n      def self.down\n        drop_table :resulttypes\n      end\n    end\n\n    class CreateExercisesResulttypesJoin &lt; ActiveRecord::Migration\n      def self.up\n        create_table :exercises_resulttypes, :id =&gt; false do |t|\n          t.integer \"exercise_id\"\n          t.integer \"resulttype_id\"\n        end\n        add_index :exercises_resulttypes, [\"exercise_id\", \"resulttype_id\"]\n      end\n\n      def self.down\n        drop_table :exercises_resulttypes\n      end\n    end\n</code></pre>\n\n<p>which works nicely with this formtastic code:</p>\n\n<pre><code>    &lt;%= semantic_form_for(@exercise) do |f| %&gt;        \n      &lt;%= f.inputs do %&gt;\n        &lt;%= f.input :name %&gt;\n        &lt;%= f.input :beschreibung %&gt;\n        &lt;%= f.input :resulttype %&gt;\n        &lt;%= f.input :active %&gt;\n      &lt;% end %&gt;\n      &lt;%= f.buttons %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>The problem is here, that with this code I can not sort the resulttypes and each exercise can have each resulttype once only.\nSo I changed the formtastic :resulttype form code to this (except the jquery code):</p>\n\n<pre><code>    &lt;div id=\"conn_ctrl\" class=\"float_left center\"&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, @resall.collect{|d| [d.name,d.id]}.sort, {}, { :multiple =&gt; true, :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div class=\"float_left center\"&gt;\n                &lt;%= f.select :resulttypes, '', {}, { :multiple =&gt; true, :id =&gt; \"exercise_resulttypes_save\", :class =&gt; \"conn_select\" } %&gt;&lt;br&gt;\n            &lt;/div&gt;\n            &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"remove\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&lt;&lt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"add\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"&gt;&gt;\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"up\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Up\" }, false) %&gt;\n            &lt;%= tag(\"input\", { :type =&gt; \"button\", :id =&gt; \"down\", :class =&gt; \"dualbuttons\", :name =&gt; \"\", :value =&gt; \"Down\" }, false) %&gt;&lt;br&gt;\n        &lt;/div&gt;\n        &lt;div style=\"clear: both\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Now I have a \"Dual Listbox\" and I can add exercises to this specific workout multiple times and order it how I like it.\nBUT, when I submit the form, I get this error and I have no idea what that means:</p>\n\n<blockquote>\n  <p>Resulttype(#-614051528) expected, got String(#-608366078)</p>\n</blockquote>\n\n<p>The submitted parameters are:</p>\n\n<pre><code>    {\"commit\"=&gt;\"Create Exercise\",\n     \"authenticity_token\"=&gt;\"v1l9zfxdxIJbdjZx6SsZ5tGuKMrlioBg+C9orSmVarA=\",\n     \"utf8\"=&gt;\"✓\",\n     \"exercise\"=&gt;{\"name\"=&gt;\"dddd\",\n     \"beschreibung\"=&gt;\"ddddd\",\n     \"resulttypes\"=&gt;[\"5\",\n     \"3\",\n     \"1\"],\n     \"active\"=&gt;\"1\"}}\n</code></pre>\n\n<p>This currently drives me crazy a little bit. I hope you know why this happens...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","concatenation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13177005,"title":"Rails and Postgreql Concatenate space","body":"<p>I have an search field for user with autocomplete, it was working but I migrated my database from mySQL to Postgresql but cannot get the concatenate working. When I type a first name or a last name is working but when my user are typing Firstname Lastname (with a space between them) it's not working anymore and cannot get it working or figure out what to do.</p>\n\n<p>That's my SQL command : </p>\n\n<pre><code> @users = User.find(:all,:conditions =&gt; ['(last_name LIKE ? OR first_name LIKE ? OR    (first_name || last_name) LIKE ? OR (last_name || first_name) LIKE ?) AND adult = ?', \"%#{params[:term]}%\", \"%#{params[:term]}%\", \"%#{params[:term]}%\", \"%#{params[:term]}%\", false])\n</code></pre>\n\n<p>My issue is here : (first_name || last_name) that will return correct value when the user type FirstNameLastName so the concat works here but when I try to add the space I cannot figure out what is wrong I tried :</p>\n\n<pre><code>(first_name ||' '|| last_name) or (first_name ||\" \"|| last_name)\n</code></pre>\n\n<p>But none of these will work I found another thread on stackoverflow but cannot get it working and I don't understand why...</p>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","comments","posts"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":777,"score":0,"question_id":7000689,"title":"undefined method `comments' for nil:NilClass","body":"<p>I'm trying to create a way to have users comment on my posts. Currently I have All user posts showing up on my home page and then in the user profile only the current users posts. I would like to have it so that the comments appear only on the posts in the users profile. I tried to add a comment form in the user profile but I got an undefined method `comments' for nil:NilClass error. </p>\n\n<p>My comments_controller looks like </p>\n\n<pre><code>class CommentsController &lt; ApplicationController\n  def create\n    @post = Post.find(params[:post])\n    @comment = @post.comments.create(params[:comment])\n    redirect_to post_path(@post)\nend\n</code></pre>\n\n<p>I have a partial (_comment_form.html.erb) that I am rendering in the user profile which looks like </p>\n\n<pre><code>&lt;h2&gt;Add a comment:&lt;/h2&gt;\n&lt;%= form_for ([@post, @post.comments.build]) do |f| %&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :commenter %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :commenter %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n   &lt;/div&gt;\n   &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My Comment model looks like </p>\n\n<pre><code>class Comment &lt; ActiveRecord::Base\n  belongs_to :post\nend\n</code></pre>\n\n<p>My Post model looks like</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n attr_accessible :content\n\n belongs_to :user\n\n validates :content, :presence =&gt; true\n validates :user_id, :presence =&gt; true\n validates :user, :presence =&gt; true\n validates :title, :presence =&gt; true\n\n has_many :comments\n\n default_scope :order =&gt; 'posts.created_at DESC'\nend\n</code></pre>\n\n<p>My User Profile Looks like show.html.erb</p>\n\n<pre><code>&lt;table class=\"profile\" summary=\"Profile information\"&gt;\n  &lt;tr&gt;\n    &lt;td class=\"main\"&gt;\n    &lt;h1&gt;\n        &lt;%= gravatar_for @user %&gt;\n        &lt;%= @user.name %&gt;\n    &lt;/h1&gt;\n    &lt;% unless @user.posts.empty? %&gt;\n        &lt;table class=\"posts\" summary=\"User posts\"&gt;\n            &lt;%= render @posts %&gt;\n            &lt;%= render 'comments/comment_form' %&gt;\n        &lt;/table&gt;    \n    &lt;% end %&gt;\n    &lt;/td&gt;\n    &lt;td class=\"sidebar round\"&gt;\n  &lt;strong&gt;Name&lt;/strong&gt; &lt;%= @user.name %&gt;&lt;br /&gt;\n  &lt;strong&gt;URL&lt;/strong&gt;  &lt;%= link_to user_path(@user), @user %&gt;&lt;br /&gt;\n  &lt;strong&gt;Tasks&lt;/strong&gt; &lt;%= @user.posts.count %&gt;\n    &lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","relational-database"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13176946,"title":"How can I generate this schema with Rails?","body":"<p>I have a schema for a relational database, which I'd like to generate scaffolding for in my Ruby on Rails 3.2.8 project. I've found the documentation pretty confusing though, and my efforts so far have failed, so my question is exactly how I'd go about generating the needed scaffolding/models for the following schema:</p>\n\n<pre><code>USER\nname:string\nemail:string\n-----\nhas_many: posts\n\nTAG\nname:string\n-----\nbelongs_to_and_has_many: series\nbelongs_to_and_has_many: posts\n\nPOST\ntitle:string\nbody:text\n-----\nbelongs_to_and_has_many: tags\nbelongs_to: user\nbelongs_to: category\n\nSERIES\nname:string\nwebsite:string\n-----\nbelongs_to_and_has_many: tags\n\nCATEGORY\nname:string\n-----\nhas_many: posts\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/H93Oz.png\" alt=\"Picture of schema\"></p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13177118,"title":"shrink the form after enter values","body":"<p>I have project and tasks under the projects.have ajax form for task creation.i enter values in task creation partial form.after enter values the partial form should shrink and show the task name alone.because project has more tasks.It keep me to endless scrolling. please can any one give idea.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13176996,"title":"How can I implement a fee-based service in my Rails app?","body":"<p>I have a web app where users will be able to sell their old unused items. What I want to do is collect a fee (commission) for every transaction which occurs in my app when a user sells something. </p>\n\n<p>How could I aim to do this effectively? I.e. Are there any gems which can accomplish this? Note: I'm in the UK so Stripe isn't an option :(</p>\n"},{"tags":["ruby-on-rails-3","performance","redis","ohm"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12730716,"title":"redis ohm slow performance","body":"<p>We're scratching our heads the last couple of days trying to understand why some things seem a bit too slow with redis/ohm on our rails project.</p>\n\n<p>The gist of it is that some requests to ohm/redis take around 100-200 ms, which seem rather high considering our high-expectations of blazing-fast performance.</p>\n\n<p>The command we're running looks like:</p>\n\n<p><code>Stats::TermStats.find(term_slug: 'term_slug', user_id: 123).to_a</code></p>\n\n<p>It seems to us that we're not doing anything extremely complex or crazy. Our profiling (using <a href=\"https://github.com/SamSaffron/MiniProfiler/tree/master/Ruby\" rel=\"nofollow\">miniprofiler</a>) of this single command so far revealed the following:</p>\n\n<ul>\n<li>Some of those calls complete within about 2-4 ms (is this ok/good/bad?)</li>\n<li>Some however take 100-200 ms (this definitely feels bad)</li>\n<li>Using <code>slowlog get</code> on the redis-client does not show anything particularly slow on redis. Most of the redis command complete within less than 20 <strong>microseconds</strong> (0.02 ms)</li>\n<li>Using the rails console and running a quick benchmark using the exact same slug/id in a loop, the same behaviour is observed, i.e. a few of those (same) requests seem to take considerably longer than most others</li>\n</ul>\n\n<p>Our redis config is pretty much out-of-the-box with basically no tweaking. During testing the server is not doing much else.</p>\n\n<p>Any suggestions how to improve performance / test what slows down things so much between redis and ohm/rails ??</p>\n"},{"tags":["ruby-on-rails-3","ruby-datamapper"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13175301,"title":"Maintaining Many to Many relation with checkboxes (e.g. checkboxes for each category a post can be in)","body":"<p>We have a table with Categories containing unique categories. And our posts should link to any of these categories. I tried to add checkboxes for selecting the categories in the following manner: </p>\n\n<ol>\n<li>Add the checkboxes containing the categories in a field called \"post[categoriesss][]\", containing as value the <code>:id</code> of the category.</li>\n<li>Update the <code>new</code> and <code>update</code> method to take these these ids and collect the associated Categories with them, and then add each category to the categories attribute through the <code>&lt;&lt;</code> operator as stated in the <a href=\"http://datamapper.org/docs/associations.html\" rel=\"nofollow\">documentation</a>.</li>\n</ol>\n\n<p>We added the code to <code>new</code> and <code>update</code> to be sure not to have to do this in multiple controllers.</p>\n\n<p>However we get the following error:</p>\n\n<blockquote>\n  <p>undefined property or relationship '&lt;&lt;' on Category</p>\n</blockquote>\n\n<p>What are we doing wrong here? Is there another method to achieve our goal? Our code is below.</p>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code>class Post\n  include DataMapper::Resource  \n\n  property :id,               Serial\n\n  has n, :categories, :through =&gt; Resource\n\n  def self.new(hash={})\n\n\n    if hash.key? :categoriesss\n      hash[:categoriesss].each do |category|\n        categories &lt;&lt; Category.get(category)\n      end\n      hash.delete! :categoriesss\n    end    \n\n    super hash\n  end\n\nend\n\nclass Category\n  include DataMapper::Resource  \n\n  property :id,       Serial\n  property :name,     String,   :required =&gt; true\n\n  has n, :rekenservices, :through =&gt; Resource\nend\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>  &lt;% Category.all.each do |category| %&gt;\n    &lt;label&gt;\n      &lt;input type=\"checkbox\" name=\"post[categoriesss][]\" value=\"&lt;%= category.id %&gt;\" /&gt;\n      &lt;%= category.name %&gt;\n    &lt;/label&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p><strong>UPDATE</strong>:\nI now changed the names for the checkbox back to <code>categories</code> and updated the <code>new</code> and <code>update</code> methods to this:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>  def self.new(hash={})\n      if hash.key? :categories\n        hash[:categories].map! {|id| Category.get id}\n      end    \n      super hash\n  end\n\n  def update(hash={})\n    if hash.key? :categories\n      hash[:categories].map! {|id| Category.get id}\n    end    \n    super hash\n  end\n</code></pre>\n\n<p>Adding categories the first time works. When updating checking an extra category works great as well. Unchecking a category however yields an error message:</p>\n\n<blockquote>\n  <p>columns category_id, post_id are not unique</p>\n</blockquote>\n"},{"tags":["ruby-on-rails-3","webpage","activeadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13175802,"title":"Create public access page dynamically","body":"<p>I have a form that the user must fill (in a restricted area), then a public page will be created with the users input (I use active admin).</p>\n\n<ol>\n<li><p>How can I create publics pages dinamically from the form like: www.mysite.com/?page=someId (or something unique)? The page must be accessible ever.\n(note: I can do with \"the normal\" and not automatic mode (with views and layout), but dynamically?) </p></li>\n<li><p>Is a good idea to use as someId something like: \"3858f62230ac3c915f300c664312c63f\" (i.e.  <code>Digest::MD5.hexdigest('someId')</code>) ?</p></li>\n</ol>\n\n<p>The app is developed in RoR.</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13168695,"title":"Ruby method overriding in rails app","body":"<p>I got a few Classes that include the same module, I want to override one of the methods of the module in one place in my code.\nHow to do this?</p>\n\n<p>I tried </p>\n\n<pre><code>module [Module_name]\n  def [method_to_override]\n</code></pre>\n\n<p>and add it to the autoload path of rails but no success</p>\n"}]}
{"total":34674,"page":7,"pagesize":100,"questions":[{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":20,"score":2,"question_id":13174026,"title":"Rails: Card.id has no value","body":"<p>I'm a newbie in RoR, trying to do the \"Pragmatic Agile Web Development\" depot application.\nThe application needs to keep track of all the items added to the cart by the buyer.</p>\n\n<p>Here is the creation of the Cart model:</p>\n\n<pre><code>rails generate scaffold cart\n</code></pre>\n\n<p>And this is the application controller code:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n\nprotect_from_forgery\n\nprivate\n  def current_cart\n    Cart.find(session[:cart_id])\n  rescue ActiveRecord::RecordNotFound\n    cart = Cart.create\n    session[:cart_id] = cart.id\n    cart\n  end\nend\n</code></pre>\n\n<p>My questions:</p>\n\n<ol>\n<li>In the \"scaffold\" command I didn't specify any column name for this table, but still the Cart seems to have one column called \"id\". Is the scaffold command auto generate an \"id\" column? </li>\n<li>In this rescue block, a new Cart object is created without setting any value to \"Card.id\". on the next line we assign this \"id\" value to \"session[:cart_id] = cart.id\". what is the value that will be stored?  </li>\n</ol>\n\n<p>Your answers will be appreciated,</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","postgresql","heroku","squeel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13157450,"title":"Request on PostgreSQL with Rails and Squeel","body":"<p>I was advised to create a new question based on my previous one so here it is :</p>\n\n<p>I have on my website a list of product, each user can create his own savings based on these products. So several users can create their own savings based on the same product. So when one user create a saving I add in the database a saving with the user_id and the product_id he refers to. Now, on one page I want to display all the savings from the other users (excluding current_user) but, as many user can create a saving based on the same product I want to display these only once.If several users create a saving based on product X I want it only displayed once,thanks</p>\n\n<p>The saving table has these field :</p>\n\n<p>id\nproduct_id\nuser_id\nprice\nsaved</p>\n\n<p>What I did is what is posted on this question : \n<a href=\"http://stackoverflow.com/questions/13145168/squeel-request-and-heroku-postgres-error-using-group-by-and-order/13149437#comment17896678_13149437\">Squeel request and Heroku, Postgres: Error using GROUP BY and ORDER</a></p>\n\n<p>I cannot get it working properly on heroku (postgres). If anyone can help me writing the query for Rails or for Squeel that would be awesome thanks !</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","markitup"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13174858,"title":"Why the content display code html without render it?","body":"<p>I have used <a href=\"http://markitup.jaysalvat.com/\" rel=\"nofollow\">MarkiItUp</a> to build a jquery editor. Now when user type content in textarea with html code, like this:  </p>\n\n<p><code>A new &lt;strong&gt;true&lt;/strong&gt; question</code></p>\n\n<p>When record was saved, it save <code>A new &lt;strong&gt;true&lt;/strong&gt; question</code>. And when it display on page, it also display like content was saved, is <code>A new &lt;strong&gt;true&lt;/strong&gt; question</code> . But i want the content display on web like this: </p>\n\n<p>A new <strong>true</strong> question  </p>\n\n<p>How can i do that?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ckeditor","asset-pipeline","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":11,"score":1,"question_id":13162384,"title":"CKeditor failing in Active Admin in production","body":"<p>I have installed the ckeditor gem, and have <a href=\"https://github.com/gregbell/active_admin/wiki/Ckeditor-integration\" rel=\"nofollow\">followed these instructions</a> to get it integrating with Active Admin in Rails 3.2.3</p>\n\n<p>Works a charm in development, but in production it fails. It seems to stutter when trying to load the config.js. </p>\n\n<p>In development, it loads fine annd has the path <code>/assets/ckeditor/config.js?t=C3HA5RM</code>\nIn production it tried and fails to load the path <code>/admin/pages/3/config.js?t=C3HA5RM</code> (page ID is arbitrary)</p>\n\n<p>The site is deployed using Capistrano, and so it theoretically exactly the same in development as it is in production. </p>\n\n<p>How could these paths be incorrect, how might I change them? Could it have something to do with the asset pipeline perhaps? </p>\n"},{"tags":["ruby-on-rails-3","mongoid","nested-forms","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13137532,"title":"Mongoid Embeds_many won't save on nested form","body":"<p>I've got an embeds_many association I'm trying to set up which I've done successfully before, but I'm trying to do it all in one nested form and I can't figure it out.</p>\n\n<p>Let's say we have a <code>pocket</code> model:</p>\n\n<pre><code>class Pocket\n    include Mongoid::Document\n    field :title, type: String\n    embeds_many :coins, cascade_callbacks: true\nend\n</code></pre>\n\n<p>and a Coin Model:</p>\n\n<pre><code>class Coin\n    include Mongoid::Document\n    field :name, type: String\n    embedded_in :pocket\nend\n</code></pre>\n\n<p>in my form for the pocket, I'm using:</p>\n\n<pre><code>= f.fields_for @pocket.coins do |coin|\n    = coin.text_field :name\n</code></pre>\n\n<p>My controller is the default scaffolded controller.\nWhen I use the console, it saves fine and I can see the new pocket and coin I've created. But when I try to create or update a coin from the form, the pocket saves but the coin remains unchanged.</p>\n\n<p>What am I missing here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","truncate","rails-console"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13173618,"title":"Truncate table(s) with rails console","body":"<p>I have this testingdatabase which, by now, is stuffed with junk. Now I've done a few Table.destroy_all commands in the rails console which deletes all records and dependencies which is awesome. However; I'd like to truncate everything so the ID's etc. start at 1 again. Is there any way in Rails 3?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13173940,"title":"Adding child to parent in rails","body":"<p>I have a user model and would like to add children to parents through a form when the parent is edited, I am using the Ancestry gem to create a hierarchy (previously asked a similar question <a href=\"http://stackoverflow.com/questions/13142785/form-for-adding-children-using-ancestry-gem\">here</a> but was maybe a bit unclear). I have tried to use virtual attributes to do give the child-to-be-added an attribute, in the user model I have added an new_child to attr_accessor. Now that the parent user is updated I would like to update the child user (adding the parent). I have tried this in the controller but get an undefined method `update_attributes!' for nil:NilClass error, any suggestions for how solve this problem?</p>\n\n<p>user_controller.rb</p>\n\n<pre><code>def update\n   User.find_by_id(@new_child).update_attributes!(parent_id: @user)\n   ...\nend\n</code></pre>\n\n<p>user.rb</p>\n\n<pre><code>attr_accessible :new_child\nattr_accessor :new_child\n</code></pre>\n\n<p>edit.html.erb</p>\n\n<pre><code>&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.label :new_child, \"Add child (enter child id)\" %&gt;\n  &lt;%= f.text_field :new_child %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","guard","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":61,"score":2,"question_id":13170077,"title":"Why is guard stopping?","body":"<p>I have a rails application that I just threw guard and minitest and my gaurd file is </p>\n\n<pre><code>guard 'minitest', :cli =&gt; '--drb --format doc --color' do\n  # with Minitest::Unit\n  watch(%r|^test/(.*)\\/?test_(.*)\\.rb|)\n  watch(%r|^lib/(.*)([^/]+)\\.rb|)     { |m| \"test/#{m[1]}test_#{m[2]}.rb\" }\n  watch(%r|^test/test_helper\\.rb|)    { \"test\" }\n\n  # Rails\n  watch(%r|^app/controllers/(.*)\\.rb|) { |m| \"test/functional/#{m[1]}_test.rb\" }\n  watch(%r|^app/helpers/(.*)\\.rb|)     { |m| \"test/helpers/#{m[1]}_test.rb\" }\n  watch(%r|^app/models/(.*)\\.rb|)      { |m| \"test/unit/#{m[1]}_test.rb\" }  \nend\n</code></pre>\n\n<p>but when i run guard i get a command prompt</p>\n\n<pre><code>bundle exec guard\n22:14:12 - INFO - Guard uses TerminalTitle to send notifications.\n22:14:12 - INFO - Guard is now watching at '/Users/trace/Sites/application'\n1.9.3 (main):0 &gt; 2 + 2\n=&gt; 4\n</code></pre>\n\n<p>Why am i getting this prompt. Any ideas... here are some of the gems i am using</p>\n\n<p><strong>UPDATE...</strong></p>\n\n<p>when i run <code>all minitest</code> then the tests run...but why do i have to run that...any ideas</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":225,"score":1,"question_id":10580137,"title":"How to use paperclip to upload files other than images ...like pdf,docs","body":"<p>I am using paperclip to upload resume in my applyforjobs.Its working fine,i mean i can get browse button to upload files.But when i show the view page its not showing the pdf file that i upload,instead its showing just the name of the file. I also checked that folder which gets generated by default and that folder contains the pdfs which i uploaded during create aaction,which means upload thing is working fine.but i am not able to show that pdf.</p>\n\n<hr>\n\n<p>Following is the code in my applyforjob.rb model for paperclip attachment :</p>\n\n<pre><code>has_attached_file :resume,:styles =&gt; { :small =&gt; \"150x150&gt;\" }\n</code></pre>\n\n<p>Following is the code of applyforjobs/form.html.haml for uploading file :</p>\n\n<pre><code>= f.label :resume, \"Upload resume\".html_safe\n= f.file_field :resume\n</code></pre>\n\n<p>Following is the code of applyforjobs/show.html.haml for showing file :</p>\n\n<pre><code>= image_tag @appliedusers.resume.url(:small)\n</code></pre>\n\n<p>but its not showing that pdf file.What am i supposed to write to upload and show files like pdf or docs?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13173594,"title":"Rails 3 Speed up Active Record Callbacks after_commit to send notifications using Private_pub","body":"<p>I am using 3 callbacks after a post is created.</p>\n\n<p>1) Post created</p>\n\n<p>callback#1) <code>after_commit :do_notify, :on =&gt; :create</code>  for crating Notification</p>\n\n<p>2) Notification created</p>\n\n<p>callback#2) <code>after_commit :publish_to_all, :on =&gt; :create</code> for sending out messages/ to user using Private_pub</p>\n\n<p>It is taking more than a minute to complete whole flow.</p>\n\n<blockquote>\n  <p>Question#1: <em>Is the approach wrong</em></p>\n  \n  <p>Question#2: <em>is there a method to send rest of callbacks to background\n  and complete it there.</em></p>\n</blockquote>\n"},{"tags":["ajax","ruby-on-rails-3","devise","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13161146,"title":"Missing template on Devise Registration Form (sign up)","body":"<p>I'm trying to understand as to who I get </p>\n\n<pre><code>Template is missing\n\nMissing template devise/registrations/create, devise/create, application/create with {:locale=&gt;[:en], :formats=&gt;[:js, :html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"C:/project/app/views\" * \"C:/Ruby193/lib/ruby/gems/1.9.1/gems/devise-2.1.2/app/views\"\n</code></pre>\n\n<p>if I try to send the registration information via :remote => true.</p>\n\n<p>As far as I understand, using remote true will ensure that the form is sent with an ajax post, but once I hit submit I see that the server returns the missing template error.</p>\n\n<p>I read somewhere that the registration controller is already using respond_with (I see in the code) which means that it should respond to the ajax. </p>\n\n<p>Can someone clarify that or if I am missing a piece in the puzzle?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":32,"score":-3,"question_id":13161504,"title":"undefined method issue","body":"<pre><code>    Exception NoMethodError -&gt; undefined method `[]' for nil:NilClass\n   lib/push/push_notification.rb:13:in `block in process'\n   lib/push/push_notification.rb:12:in `each'\n   lib/push/push_notification.rb:12:in `process'\n</code></pre>\n\n<p>put_notification:</p>\n\n<pre><code>#require 'enumerator'\n\nclass PushNotification\n\n  attr_reader :ios_notifications\n\n  def initialize\n    @ios_notifications = []\n  end\n\n  def process(device_options = [])\n    device_options.each do |device_option|\n      content_id = device_option[\"options\"][\"other\"][\"content_id\"] if device_option[\"options\"][\"other\"] &amp;&amp; device_option[\"options\"][\"other\"][\"content_id\"]\n\n      case device_option[\"platform\"]\n        when DeviceProfile::Platform::ANDROID\n          device = Gcm::Device.find_or_create_by_registration_id(device_option[\"push_id\"])\n\n          device_profile = DeviceProfile.find_by_android_push_id(device_option[\"push_id\"]) || DeviceProfile.new()\n\n          notification = Gcm::Notification.new\n          notification.device = device\n          notification.collapse_key = \"updates_available\"\n          notification.delay_while_idle = true\n          notification.data = {:registration_ids =&gt; [device.registration_id], :data =&gt; {:message =&gt; device_option[\"options\"][\"alert\"]}}\n          notification.data[:data][:content_id] = content_id if content_id\n          notification.save\n\n          Statistics::Alerts.create(push_notifications: 1, platform: \"android\", message:device_option[\"options\"][\"alert\"], content_id: content_id, udid: device_profile.udid )\n\n        when DeviceProfile::Platform::IOS\n          @ios_notifications &lt;&lt; APNS::Notification.new(device_option[\"push_id\"], device_option[\"options\"].symbolize_keys!)\n\n          device_profile = DeviceProfile.find_by_iphone_push_id(device_option[\"push_id\"]) || DeviceProfile.new()\n\n          Statistics::Alerts.create(push_notifications: 1, platform: \"ios\", message:device_option[\"options\"][\"alert\"], content_id: content_id, udid: device_profile.udid )\n      end\n    end\n\n    @ios_notifications.each_slice(100) do |group|\n      APNS.send_notifications(group)\n    end if !@ios_notifications.empty?\n\n    Gcm::Notification.where(sent_at: nil).joins(:device).readonly(false).find_in_batches(batch_size: 100) do |batch|\n      Gcm::Notification.send_notifications(batch)\n    end\n\n  end\n\n\nend\n</code></pre>\n\n<p>Here where params come from</p>\n\n<pre><code>def send_push_notifications\n    device_profiles = DeviceProfile.all\n    device_options = device_profiles.map { |dp| a = { :platform =&gt; dp.platform,\n      :options =&gt; { :alert =&gt; 'New Offer Available', :sound =&gt; \"default\",\n        :other =&gt; { :content_id =&gt; Content.last } } } \n\n    if dp.platform == DeviceProfile::Platform::IOS\n        a[:push_id] = dp.iphone_push_id\n    elsif dp.platform == DeviceProfile::Platform::ANDROID\n        a[:push_id] = dp.android_pish_id\n    end\n    }\n    puts device_options\n    Stalker.enqueue('dm.push', device_options)\n</code></pre>\n\n<p>Whats wronw with code?</p>\n"},{"tags":["ruby-on-rails-3","rspec","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13132506,"title":"Capybara Ambiguity Resolution","body":"<p>How do I resolve ambiguity in Capybara? For some reason I need links with the same values in a page but I can't create a test since I get the error</p>\n\n<pre><code>Failure/Error: click_link(\"#tag1\")\n     Capybara::Ambiguous:\n       Ambiguous match, found 2 elements matching link \"#tag1\"\n</code></pre>\n\n<p>The reason why I can't avoid this is because of the design. I'm trying to recreate the twitter page with tweets/tags on the right and the tags on the left of the page. Therefore it will be inevitable that identical links page shows up on the same page.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13168912,"title":"How to redirect non existing routes in rails","body":"<p>I have switched from an old site with a good page rank to RubyOnRails. </p>\n\n<p>Of course all links are broken now. When a user visits my site via a google link he will get:</p>\n\n<pre><code>Routing Error\n\nNo route matches [GET] \"/SOME_WRONG/URL/WITH/PARAMETERS\"\n</code></pre>\n\n<p>What is the best way to redirect the user on error like that to my root_url?</p>\n\n<p>And where I have to put this code?</p>\n\n<pre><code>.htaccess?\napplication_controller?\napplication.rb?\nroutes.rb?\n</code></pre>\n\n<p>many many thanks in advance :-)</p>\n"},{"tags":["ruby-on-rails-3","capistrano","unicorn"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13172399,"title":"How to reuse the variables in capistrano unicorn","body":"<p>I configured my deploy.rb with certain variables. For example</p>\n\n<pre><code>set :application, \"rails3\"\n</code></pre>\n\n<p>I am deploying my application using unicorn server which has the configuration under </p>\n\n<blockquote>\n  <p>config/unicorn/development.rb</p>\n</blockquote>\n\n<p>In this file I configured the variable pid_path = \"/home/user/#{application}\".</p>\n\n<p>How to reuse the value from deploy.rb</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","api","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13172125,"title":"How can i allow iphone app to login using facebook using devise?","body":"<p>I want users to login with their facebook account through devise from iphone app. </p>\n\n<p>consider when i send the id and password as</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'asdfghjkl'}}\"\n</code></pre>\n\n<p>then it produces</p>\n\n<pre><code>{\"user\":{\"authentication_token\":\"34734t374hfjeg266272\",\"email\":\"sample@gmail.com\"}}\n</code></pre>\n\n<p>I use the authentication token for the next request as</p>\n\n<pre><code>curl -L 'localhost:3000/posts.json?auth_token=34734t374hfjeg266272'\n</code></pre>\n\n<p>and i get the values from the table as json and similarly how can i do it with facebook account in devise?</p>\n\n<p>I have omniauth used in my web app and i could login as facebook user from my web app but how could i do it for iphone app?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13166373,"title":"Does using multiple databases in Rails 3 affect performance?","body":"<p>I'm currently with a client using a heroku database with a row limit and we have a big table that logs activities, so after trying some solutions I found out that I can use a different connection for a single model.</p>\n\n<p>Will it affect performance by a lot? I think I'm going to create a micro instance with postgres with just this table.</p>\n"},{"tags":["ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13168842,"title":"Rails 3: As json with include option does not takes into account as_json redefinition for included association","body":"<p>I've got two models.</p>\n\n<pre><code>Class ModelA &lt; ActiveRecord::Base\n\n  has_many :model_bs\n\nend\n\nClass ModelB &lt; ActiveRecord::Base\n\n  belongs_to :model_a\n\n  def as_json(options = {})\n    {\n       :whatever =&gt; 'hello world'\n    }\n  end\n\nend\n</code></pre>\n\n<p>When I call <code>model_a.as_json(:include =&gt; :model_b)</code>, I want it to return a json which includes all model_bs, which it does, but employing my as_json redefinition, which it does not as it just uses the default one. Is there any way to use my own method rather than the original one? Thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-api","oauth-2.0","google-calendar"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13165989,"title":"How do I fetch user's Google Calendar persistently with Ruby?","body":"<p>My app already fetches Google Calendar but users has to login every time to get the new calendar. The issue raises from token being expired after a while. </p>\n\n<p>I've already tried the following which is to include user.profile scope:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n    provider :google_oauth2, GOOGLE_APP_KEY, GOOGLE_APP_SECRET, {\n    scope: 'https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.profile',\nredirect_uri: GOOGLE_APP_CALLBACK_URL\n</code></pre>\n\n<p>}\n    end</p>\n\n<p>So, now the token persist so user doesn't have to login every single time to the app, but if the Google Calendar has new entry, my web app won't be able to fetch the new events because the token is expired.</p>\n\n<p>What's the way to solve this problem?</p>\n"},{"tags":["javascript","ruby-on-rails-3","ember.js"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":52,"score":1,"question_id":13146917,"title":"Ember Action - {{action showClinic clinic}} generates link with 'undefined'","body":"<p>I'm working with Ember, Ember-data and Rails.</p>\n\n<p>When I create a link in the handlebars view, it links out to /clinic/undefined. I'm trying to have the View code create a link that looks like: <code>http://localhost:3000/#/clinic/1</code> but instead looks like: <code>http://localhost:3000/#/clinic/undefined</code>.</p>\n\n<p>Any ideas why and how to fix it?</p>\n\n<p>View:</p>\n\n<pre><code>&lt;a {{action showClinic content.clinic href=true}}&gt;Click here&lt;/a&gt;\n</code></pre>\n\n<p>Router:</p>\n\n<pre><code>root: Ember.Route.extend({\nshowClinic: Ember.Route.transitionTo('clinic'),\nshowDoctor: Ember.Route.transitionTo('doctor'),\n\nindex: Ember.Route.extend({\n  route: '/',\n  connectOutlets: function(router) {\n    router.get('applicationController').connectOutlet('main');\n  }\n}),\n\nclinic: Ember.Route.extend({\n  route: '/clinic/:clinic_id',\n  connectOutlets: function(router, clinic) {\n    router.get('applicationController').connectOutlet('clinic', clinic);\n    router.get('clinicController').connectOutlet('doctors', clinic.get('doctors'));\n  }\n}),\n\ndoctor: Ember.Route.extend({\n  route: '/doctor/:doctor_id',\n  connectOutlets: function(router, doctor) {\n    router.get('applicationController').connectOutlet('doctor', doctor);\n  }\n})\n</code></pre>\n\n<p>})</p>\n\n<p>Model:</p>\n\n<pre><code>App.Doctor = DS.Model.extend({\n  name: DS.attr('string'),\n  clinic: DS.belongsTo('App.Clinic')\n});\n</code></pre>\n\n<p>JSON:</p>\n\n<pre><code>{\n  doctor: {\n    id: 1,\n    clinic_id: 1,\n    name: \"Dr. Who\"\n  }\n}\n</code></pre>\n"},{"tags":["jquery","ajax","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":248,"score":3,"question_id":11089315,"title":"How do I get my new registrations Devise form to be AJAXified?","body":"<p>What I want to happen is when the account is successfully created, the form that was submitted should disappear and a message should appear (depending on the status of the registration).</p>\n\n<p>If it was successful, they should see a simple \"Thank you. Please check your email.\"</p>\n\n<p>If it wasn't, then they should see an appropriate message - like \"Sorry, that email has already been taken.\"</p>\n\n<p>This is my form:</p>\n\n<pre><code>&lt;div class=\"nine columns offset-by-three sign-up-form\"&gt;\n  &lt;%= form_for(resource, :as =&gt; resource_name, :class =&gt; \"send-with-ajax\", :url =&gt; user_registration_path(resource), :validate =&gt; true, :html =&gt; { :id =&gt; 'user_new' }) do |f| %&gt;\n    &lt;div class=\"six columns alpha\"&gt; \n       &lt;%= f.text_field :email, :placeholder =&gt; \"your-email@address.com\", :input_html =&gt; {:autofocus =&gt; true}, :validate =&gt; true %&gt;\n    &lt;/div&gt;              \n    &lt;div class=\"three columns sign-up alpha\"&gt;\n      &lt;%= f.submit :label =&gt; \"Submit\", :value =&gt; \"Sign Me Up!\"  %&gt;\n      &lt;div class=\"ajax-response\"&gt;&lt;%= devise_error_messages! %&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This is my <code>create.js.erb</code>:</p>\n\n<pre><code>$(document).ready(function() {    \n  $('#user_new').submit(function() { \n    $(this).fadeOut(600).hide(); \n    $(this).append('&lt;h3&gt;Thank You. You should receive an email shortly.&lt;/h3&gt;').fadeIn(1000);\n  });    \n)}\n</code></pre>\n\n<p>But this doesn't work properly. For instance, when I press submit and the email address is already in the db - nothing happens.</p>\n\n<p>P.S. I know that if it were a 'regular' form, I would do <code>format.js</code> within the controller that is handling this form - and work out the status codes &amp; messages there - but Devise is a different beast and I don't want to generate new controllers and override functionality that I shouldn't, when I am not fully comfortable.</p>\n"},{"tags":["ruby-on-rails-3","mongodb","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13157038,"title":"mongoid instead of mongomapper","body":"<p>when i was using the mongo mapper at that time , in parameter it was showing the BSON Object id and when change it to mongoid it doesnot send the BSON object id ,it simple shows the _id.\nis anybody can help me out. \nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":257,"score":0,"question_id":9674680,"title":"Rails PJAX not working","body":"<p>I have added the pjax javascript.</p>\n\n<p>In my view I have:</p>\n\n<pre><code>&lt;div data-pjax-container&gt;\n&lt;%= yield %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>But still onclick the hole page updates. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":33,"score":2,"question_id":13170314,"title":"Better Rails code for update or create clause?","body":"<p>The code smells and i'm sure i'm missing a helper to do a simple \nupdate or create query like the below snippet :</p>\n\n<pre><code>  @user_answer = current_user.user_answers.find_by_question_id(params[:a_question])\n  if @user_answer.nil?\n    @user_answer = current_user.user_answers.build({ :answer_id =&gt; params[:an_answer] , :question_id =&gt; params[:a_question] })      \n    @user_answer.save  \n  else\n    @user_answer.update_attributes(:answer_id =&gt; params[:an_answer])\n    @user_answer.save \n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","controller","timeout"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":13170637,"title":"Rails setting timeout in controller","body":"<p>In my controller in Rails, I want to download a file into the <code>public</code> folder of the project (using the Linux system command <code>wget</code>). Then I'd like the file to stay there for an hour, before calling the command <code>rm</code> to delete it. Can I set a timeout so that the code execution pauses at some point before resuming later?</p>\n"},{"tags":["javascript","arrays","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":718,"score":1,"question_id":7195943,"title":"Rails 3 passing a rails array to javascript function which uses a javascript array","body":"<p>I am trying to pass a rails array to a javascript function.  The function will then use the array values in javascript so I need to keep it an array.  </p>\n\n<p>Here is how I am passing my array:</p>\n\n<pre><code>\"graphit([&lt;%=@mpg_values.join(\",\") %&gt;])\"\n</code></pre>\n\n<p>This produces this in the HTML</p>\n\n<pre><code>\"graphit([#&amp;lt;Mile:0x6ff0cf0&amp;gt;,#&amp;lt;Mile:0x6ff0c18&amp;gt;,#&amp;lt;Mile:0x6ff0b58&amp;gt;])\"\n</code></pre>\n\n<p>Which are not the values, they should be decimal numbers.  I assume this is because it is a reference to the array so that I why I am getting the messed up values.  If I do something like to_s I see the values but it has other stuff like the table and filed name in there as well.</p>\n\n<p>Anybody know how I can get this rails array to a javascript function as an array?</p>\n\n<p>Thanks in advance for any help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","authorization","unauthorized"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2505,"score":2,"question_id":7297183,"title":"Custom Devise 401 unauthorized response","body":"<p>I'm working on a JSON-based API for my Rails 3.1 app.  I'd like to provide a custom failure response instead of the default, which is:</p>\n\n<pre><code>{\"error\":\"You need to sign in or sign up before continuing.\"}\n</code></pre>\n\n<p>My API controller includes a before_filter call to <code>authenticate_user!</code>, which is what is rendering this JSON response.</p>\n\n<p>While searching, I came across <a href=\"http://stackoverflow.com/questions/4756922/devise-hijacking-a-401-response\">this StackOverflow question</a>, which references <a href=\"https://github.com/plataformatec/devise/wiki/How-To%3a-Provide-a-custom-failure-response-with-Warden\" rel=\"nofollow\">this Devise wiki entry</a>.  Unfortunately, the wiki entry isn't verbose enough for me to understand what it's telling me.  Specifically, I have no clue where I'm supposed to put that code such that Devise/Warden knows to render what I want returned.</p>\n\n<p>From the comments on the other SA question, it sounds like I don't need to call <code>custom_failure!</code> since I'm using a version of Devise above 1.2 (1.4.2 to be specific).  However, the wiki entry doesn't explain where the <code>render</code> call should go such that <code>authenticate_user!</code> knows to use that instead of its own render call.</p>\n\n<p>Where does this <code>render</code> call go?</p>\n\n<p><strong>Edit:</strong> I'm not just trying to change the message itself (a la the devise <code>en.yml</code> config); I'm trying to change the actual format of the response.  Specifically, I want to return this:</p>\n\n<pre><code>render :text =&gt; \"You must be logged in to do that.\", :status =&gt; :unauthorized\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rspec2"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":974,"score":4,"question_id":7284413,"title":"How to test with Rspec if an email is delivered by the controller?","body":"<p>I'd like to test if an email is delivered if I call a controller method with :post. I'll use email_spec so I tried this snipped here: <a href=\"http://rubydoc.info/gems/email_spec/1.2.1/file/README.rdoc#Testing_In_Isolation\" rel=\"nofollow\">http://rubydoc.info/gems/email_spec/1.2.1/file/README.rdoc#Testing_In_Isolation</a></p>\n\n<p>But it dosen't work, because I pass an instance of the model-object to the delivery-method and the instance is saved before the delivery.</p>\n\n<p>I tried to create an other instance of the model-object, but then the id isn't the same.</p>\n\n<p>My controller-method looks like this:</p>\n\n<pre><code>def create\n\n   @params = params[:reservation]\n\n   @reservation = Reservation.new(@params)\n   if @reservation.save\n      ReservationMailer.confirm_email(@reservation).deliver\n      redirect_to success_path\n   else\n      @title = \"Reservation\"\n      render 'new'\n   end\n\nend\n</code></pre>\n\n<p>Do you have any idea to solve this?</p>\n\n<p>(Sorry for my bad english, I'm no native.)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","file","download"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13169494,"title":"Creating file dynamically and downloading onto user's computer","body":"<p>I'm wondering if it's possible to do this in Rails:</p>\n\n<p>Have a link on the webpage. When the user clicks on the link, the controller generates a file dynamically (say, a text file that contains a single random number between 1 and 10), and the file is downloaded onto the user's computer. The file might be temporarily stored on the server, but it shouldn't be permanently there.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13167638,"title":"RSpec test if all models respond_to attribute","body":"<p>I'm trying to write an RSpec test for what seems like a relatively simple test, but it's proving pretty tricky (though I am new to RSpec).</p>\n\n<p>In simple terms, I want to test that all models in my application respond_to :owner or :owners.</p>\n\n<p>My first problem is looping through all of the models - how to do this in RSpec? I can normally loop through the models like:</p>\n\n<pre><code>ActiveRecord::Base.descendants.each { |model|\n    model.should respond_to :owner\n}\n</code></pre>\n\n<p>But not sure how to do this correctly in RSpec? I can't find much documentation about using loops within tests.</p>\n\n<p>My second question is about an \"OR\" clause - how can I achieve \"responds to owner or owners\"? Something like:</p>\n\n<pre><code>model.should respond_to :owner || :owners\n</code></pre>\n\n<p>But again I can find much documentation about using or clauses.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","imagemagick","osx-mountain-lion","rmagick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13169337,"title":"Can't install RMagick on OS X Mountain Lion","body":"<p>I've been struggling with this for a while. I'm running Mac OS 10.7 (Mountain Lion), and I'm trying to install the RMagick gem so I can use it in my Rails 3 app. I already installed imagemagick with homebrew, and that seemed to finish successfully. I also installed the XQuartz package. When I add 'rmagick' to my gemfile and run bundle install, I get this error:</p>\n\n<pre><code>Installing rmagick (2.13.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin/ruby extconf.rb \nchecking for Ruby version &gt;= 1.8.5... yes\nextconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.\nchecking for clang... yes\nchecking for Magick-config... no\nCan't install RMagick 2.13.1. Can't find Magick-config in /Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin:/Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/bin:/Users/Andrew/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin\n\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/Users/Andrew/.rvm/rubies/ruby-1.9.3-p125/bin/ruby\n\n\nGem files will remain installed in /Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/gems/rmagick-2.13.1 for inspection.\nResults logged to /Users/Andrew/.rvm/gems/ruby-1.9.3-p125@global/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\nAn error occured while installing rmagick (2.13.1), and Bundler cannot continue.\nMake sure that `gem install rmagick -v '2.13.1'` succeeds before bundling.\n\nProcess finished with exit code 5\n</code></pre>\n\n<p>Any idea why this is happening?</p>\n"},{"tags":["linux","ruby-on-rails-3","distribution"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":448,"score":0,"question_id":5343153,"title":"Which Linux distro for Developing in Rails?","body":"<p>I'm just starting to learn Rails (Rails 3 specifically), and everything I see leans toward working in Linux to make things easier.  Since I'm bound to Windows for work, I'll be running Linux in a VM.  Are there any Linux distros that are well suited for Rails development?  Please give some kind of justification for your recommendations.</p>\n"},{"tags":["ajax","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13167484,"title":"Remote Form Renders as HTML instead of JS","body":"<p>I have a simple form:</p>\n\n<pre><code>&lt;%= form_for [current_user, @bookcase], :id =&gt; \"shelf_update_form\", :remote =&gt; true, :html =&gt; { :multipart =&gt; true} do |f| %&gt;\n  &lt;input id=\"bookcase_image\" class=\"file\" type=\"file\" name=\"bookcase[image]\" size=\"13\"&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>That automatically uploads when a file has been selected:</p>\n\n<pre><code>$(\"#shelf_update_form\").change(function() {\n  $(\"#shelf_update_form\").submit();\n});\n</code></pre>\n\n<p>I want the update action to render js view, but by default it renders html instead. I try forcing it to render js like so:</p>\n\n<pre><code>respond_to do |format|\n  format.js\nend\n</code></pre>\n\n<p>But then I get this error:</p>\n\n<pre><code>NetworkError: 406 Not Acceptable\n</code></pre>\n\n<p>Even then, my log reports:</p>\n\n<pre><code>Processing by BookcasesController#update as HTML\n</code></pre>\n\n<p>How can I get it to process as JS instead?</p>\n\n<p>UPDATE:</p>\n\n<p>The view:</p>\n\n<pre><code>triggerAjaxHistory(\"&lt;%= @href %&gt;\", false);\n</code></pre>\n\n<p>I get the same results with a more generic view, too:</p>\n\n<pre><code>alert(\"I work now!\")\n</code></pre>\n"},{"tags":["ruby-on-rails-3","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13164064,"title":"Rails cookies with wrong expiring date","body":"<p>recently I've trying to set up a cookie in order to validate a session in a Rails 3.2 app.</p>\n\n<p>The cookie was supposed to expire at the beginning of the next day, this way I would force users to login again (mandatory)</p>\n\n<p>First I changed my app's timezone to the one I was expecting to handle:</p>\n\n<pre><code>config.time_zone = 'Caracas'\n</code></pre>\n\n<p>After that I created the cookie as follows:</p>\n\n<pre><code>cookies[:remember_token] = {value: user.remember_token, \n                            expires: 1.day.from_now.beginning_of_day}\n</code></pre>\n\n<p>The cookie gets created without any problem but the expire date is wrong. In Chromium the date is set to  today a 19:30 PM (Although my machine timezone is set accordingly to the app).</p>\n\n<p>The strange thing comes when I change the definition of the cookie to:</p>\n\n<pre><code>cookies[:remember_token] = {value: user.remember_token, \n                            expires: 1.day.from_now}\n</code></pre>\n\n<p>If I set to cookie only to 1 day from today then the expire date is set properly to exactly 24 hours from now.</p>\n\n<p>Any ideas why beginning_of_date is not setting the date correctly?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","checkout","cart"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13131037,"title":"Adding Cart items Ruby on Rails","body":"<p>I am developing a very basic shopping cart and the issue I am having is that if I add more than one of the same product to my shopping cart I am not seeing the quantity increase and am instead just seeing multiple versions of the item. </p>\n\n<p>For example I see:</p>\n\n<p>1 x green light = £15\n1 x green light = £15</p>\n\n<p>rather than seeing:</p>\n\n<p>2 x green light = £30</p>\n\n<p>How can I make it so that my shopping cart will check for multiple versions in the cart and then add them together?</p>\n\n<p>Currently I have: </p>\n\n<p>Application Controller</p>\n\n<pre><code>  def current_cart\n  if session[:cart_id]\n    @current_cart ||= Cart.find(session[:cart_id])\n  end\n  if session[:cart_id].nil?\n    @current_cart = Cart.create!\n    session[:cart_id] = @current_cart.id\n  end\n  @current_cart\n  end \n</code></pre>\n\n<p>Cart Controller</p>\n\n<pre><code>   def show\n    @cart = current_cart\n   end\n</code></pre>\n\n<p>Cart Model</p>\n\n<pre><code> has_many :items\n\n def total_price\n   items.to_a.sum(&amp;:full_price)\n end\n</code></pre>\n\n<p>Cart View</p>\n\n<pre><code> &lt;table id=\"line_items\"&gt;\n   &lt;tr&gt;\n     &lt;th&gt;Product&lt;/th&gt;\n     &lt;th&gt;Qty&lt;/th&gt;\n     &lt;th class=\"price\"&gt;Unit Price&lt;/th&gt;\n     &lt;th class=\"price\"&gt;Full Price&lt;/th&gt;\n   &lt;/tr&gt;\n\n  &lt;% for item in @cart.items %&gt;\n    &lt;tr class=\"&lt;%= cycle :odd, :even %&gt;\"&gt;\n       &lt;td&gt;&lt;%=h item.product.name %&gt;&lt;/td&gt;\n       &lt;td class=\"qty\"&gt;&lt;%= item.quantity %&gt;&lt;/td&gt;\n       &lt;td class=\"price\"&gt;&lt;%= gbp(item.unit_price) %&gt;&lt;/td&gt;\n       &lt;td class=\"price\"&gt;&lt;%= gbp(item.full_price) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n   &lt;% end %&gt;\n &lt;tr&gt;\n\n  &lt;td class=\"total price\" colspan=\"4\"&gt;\n    Total: &lt;%= gbp(@cart.total_price) %&gt;\n  &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;/table&gt;\n</code></pre>\n\n<p><strong>FURTHER INFORMATION</strong></p>\n\n<p>Products#Index</p>\n\n<pre><code>  &lt;%= link_to \"Add to Cart\", line_items_path(:product_id =&gt; product), :method =&gt; :post %&gt;\n</code></pre>\n\n<p>Any advice people can offer would be much appreciated. Thanks!</p>\n\n<p><strong>New Setup</strong> - Causing Error <code>Uninitialised Constant CartController</code></p>\n\n<p>Routes.rb</p>\n\n<pre><code> Checkout::Application.routes.draw do\n\n   ActiveAdmin.routes(self)\n\n   devise_for :admin_users, ActiveAdmin::Devise.config\n\n   post '/add_to_cart/:product_id' =&gt; 'cart#add_to_cart', :as =&gt; 'add_to_cart'\n\n   resources :carts\n   resources :products\n   resources :items\n\n   root :to =&gt; 'products#index'\n\n end\n</code></pre>\n\n<p>Carts Controller</p>\n\n<pre><code> class CartsController &lt; ApplicationController\n\n   def show\n     @cart = current_cart\n   end\n\n   def add_to_cart\n       current_cart.add_item(params[:product_id])\n       redirect_to carts_path(current_cart.id)\n   end\n\n end\n</code></pre>\n\n<p>Carts Model</p>\n\n<pre><code>class Cart &lt; ActiveRecord::Base\nhas_many :items\n\ndef add_item(product_id)\n        item = items.where('product_id = ?', product_id).first\n    if item\n        # increase the quantity of product in cart\n        item.quantity + 1\n        save\n    else\n        # product does not exist in cart\n        product = Product.find(product_id)\n        items &lt;&lt; product\n    end\n    save\nend\n\ndef total_price\n    items.to_a.sum(&amp;:full_price)\nend\nend\n</code></pre>\n\n<p>Product#Index</p>\n\n<pre><code>&lt;table class=\"jobs\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th scope=\"col\" id=\"name\"&gt;Product Code&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Name&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Price&lt;/th&gt;\n            &lt;th scope=\"col\" id=\"company\"&gt;Action&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n        &lt;% @product.each do |product| %&gt;\n        &lt;tr&gt;    \n            &lt;td&gt;&lt;%= product.product_code %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= product.name %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= gbp(product.price) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= button_to \"Add to Cart\", add_to_cart_path(:product_id =&gt; product), :method =&gt; :post %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;% end %&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":281,"score":0,"question_id":11780215,"title":"form_tag with :remote => true does not update div, skips to separate page","body":"<p>I am trying to update a div based on a form submit. I am on Rails 3.1.1. I am trying to adapt someone else's <a href=\"http://jmvidal.cse.sc.edu/talks/rubyonrails/form_remote_tag.html\" rel=\"nofollow\">recipe</a>. My code in the view is something like this in <code>main.html.erb</code>:</p>\n\n<pre><code>&lt;%= javascript_include_tag :defaults %&gt;\n&lt;div id='seq_search'&gt;\n  &lt;%= form_tag(:remote =&gt; true, :update =&gt; 'seq_select', :action =&gt; 'select')  do %&gt;\n    &lt;p&gt;\n      &lt;%= search_field_tag  :query, '', :size =&gt; 45 %&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;%=submit_tag \"Submit\", :disable_wth =&gt; \"Adding ...\"%&gt;\n    &lt;/p&gt;\n   &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>The controller looks like</p>\n\n<pre><code>class SearchAjaxController &lt; ApplicationController\n  def main\n  end\n  def select\n      render :text =&gt; '&lt;li&gt; '+params[:query] + ' &lt;/li&gt;'\n  end\nend\n</code></pre>\n\n<p>However, when I enter something in the text box and press submit, instead of updating the div, it goes off to another page rendering just the output of the <code>select</code> method of the controller.</p>\n\n<p>If I look at the page source of the form, it is something like this:</p>\n\n<pre><code>&lt;div id='seq_search'&gt;\n  &lt;form accept-charset=\"UTF-8\" action=\"/search_ajax/select?remote=true&amp;amp;update=seq_select\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"wlOm4H7GvZAQoIVpjxPLqHAQLOIpJ4V5r0WYEpvCCrQ=\" /&gt;&lt;/div&gt;\n    &lt;p&gt;\n      &lt;input id=\"query\" name=\"query\" size=\"45\" type=\"search\" value=\"\" /&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input disable_wth=\"Adding ...\" name=\"commit\" type=\"submit\" value=\"Submit\" /&gt;\n    &lt;/p&gt;\n&lt;/form&gt;&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>It seems that the form is simply passing <code>remote=true&amp;amp;update=seq_select</code> as arguments to the controller's method/function. Is this what is supposed to happen?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>So I tried to add to follow Mike Campbell's sugggestion and added the following code to my view (`.html.erb') file</p>\n\n<pre><code>&lt;SCRIPT type='text/Javascript'&gt; \n$(function(){\n  $('#form-id').bind('ajax:success', function(xhr, data, status){\n    $('#seq_select').html(data);\n  });\n}\n&lt;/SCRIPT&gt;\n</code></pre>\n\n<p>and also gave an id to the form:</p>\n\n<pre><code> &lt;%= form_tag(:remote =&gt; true, :update =&gt; 'seq_select', :action =&gt; 'select', :id =&gt; 'form-id')  do %&gt;\n</code></pre>\n\n<p>Submitting the form still doesn't update the page. It simply skips to a new rendered view as before. The generated HTML reads:</p>\n\n<pre><code>&lt;SCRIPT type='text/Javascript'&gt; \n$(function(){\n  $('#form-id').bind('ajax:success', function(xhr, data, status){\n    $('#seq_select').html(data);\n  });\n}\n&lt;/SCRIPT&gt;\n\n&lt;div id='seq_search'&gt;\n  &lt;form accept-charset=\"UTF-8\" action=\"/ajax_search/select/form-id?remote=true&amp;amp;update=seq_select\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"wlOm4H7GvZAQoIVpjxPLqHAQLOIpJ4V5r0WYEpvCCrQ=\" /&gt;&lt;/div&gt;\n    &lt;p&gt;\n      &lt;label&gt; Search by identifiers, accessions, and gene names.. &lt;/label&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input id=\"query\" name=\"query\" size=\"45\" type=\"search\" value=\"\" /&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;input disable_wth=\"Adding ...\" name=\"commit\" type=\"submit\" value=\"Submit\" /&gt;\n    &lt;/p&gt;\n&lt;/form&gt;&lt;/div&gt;\n\n&lt;div id='seq_select'&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>Update:</p>\n\n<p>It seems that the syntax for form_tag was wrong, and the first argument has to be the name of the action. I now have <code>&lt;%= form_tag( 'select', :remote =&gt; true, :id =&gt; 'form_id')  do %&gt;</code> which generates the associated HTML <code>&lt;form accept-charset=\"UTF-8\" action=\"select\" data-remote=\"true\" id=\"form_id\" method=\"post\"&gt;</code>. Which is better, but my Ajax is still not working.</p>\n"},{"tags":["ruby-on-rails-3","error-handling"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":497,"score":3,"question_id":6441018,"title":"Rails 3 Sending errors to email","body":"<p>How do I hijack Rails (3) error handling to email errors with full trace to me?</p>\n"},{"tags":["css","ruby-on-rails-3","forms","twitter-bootstrap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13167535,"title":"how to put icon in rails submit button","body":"<p>I am using Bootstrap and want to put an icon in the submit button for a form.<br>\nhere is the code:</p>\n\n<pre><code>&lt;%= f.submit \"Submit for Approval &lt;i class='icon-share-alt icon-white'&gt;&lt;/i&gt;\", \n                                class: \"button_green\" %&gt;\n</code></pre>\n\n<p>Generated HTML:</p>\n\n<pre><code>&lt;input type=\"submit\" value=\"Submit for Approval &amp;lt;i class='icon-share-alt icon-white'&amp;gt;&amp;lt;/i&amp;gt;\" name=\"commit\" class=\"button_green\"&gt;\n</code></pre>\n\n<p>I tried adding both raw and html_safe to the text but neither one seemed to work.<br>\nI know one solution would be to have the class be an image with the icon in it already but I would like to do this without creating additional images/css. any suggestions?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13166847,"title":"Rails For Loop View","body":"<p>I have the following code:</p>\n\n<pre><code>&lt;tbody&gt;\n   &lt;%= Item.each do |item|=%&gt;\n   &lt;tr&gt;\n      &lt;th&gt;&lt;%= item.rev =%&gt;&lt;/th&gt;      &lt;=========\n      &lt;th&gt;&lt;%= item.name =%&gt;&lt;/th&gt;\n   &lt;/tr&gt;\n   &lt;%= end =%&gt;\n&lt;/tbody&gt;\n</code></pre>\n\n<p>However I am getting a syntax error on the inidcated line. There is data in the database(Test case). No idea what I am doing wrong.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":2575,"score":0,"question_id":9574659,"title":"Rails .where vs .find","body":"<p>I've noticed that the <code>Model.where</code> method always returns an array even if there is only one result where as the <code>Model.find</code> method doesn't. Is there any reason for this? I thought <code>Model.where</code> was the preferred function since Rails 3.X. </p>\n\n<p>Should I be using <code>Model.find</code> when I expect a single result and <code>Model.where</code> when I expect more than one result?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13167897,"title":"Show Query statements in Rails Console with mongo_mapper","body":"<p>With    </p>\n\n<pre><code>ActiveRecord::Base.logger = Logger.new(STDOUT)  \n</code></pre>\n\n<p>you can view SQL statements in Rails Console,related <a href=\"http://www.shanison.com/2012/03/05/show-sql-statements-in-rails-console/\" rel=\"nofollow\">here</a>, but that require ActiveRecord , with mongo_mapper you don't have ActiveRecord, so how view debug of querys ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","form-helpers","select-tag"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13166677,"title":"How to have a default select value that is NOT an option in drop down, using Ruby form select helper method","body":"<p>Ok so I am working on a project that was outsourced and now I get to jump in and fix everything before it gets pushed to production. I am currently trying to modify a line that creates a select form field. I read up on some of the different form helper methods to use in ruby, and over some of the available options for the method.</p>\n\n<p>My problem is I can't seem to figure out how to get a default value to be displayed inside the select element without having it show up in the drop down options. This is what the line currently looks like.</p>\n\n<pre><code>&lt;%= select :profile, :sexual_interest, SEXUAL_INTEREST_ARRAY, {:prompt =&gt; 'sexuality'}, {:class =&gt; 'selectFull'} %&gt;\n</code></pre>\n\n<p>I tried changing some of the options using :default => 'sexuality' and then tried :disabled => 'sexuality'. But I seem to only be able to remove the option entirely from the select element or have it as the first value in the drop down list and being displayed as the default value.</p>\n\n<p>If you are just having issues setting the default value of your select field using a ruby form helper, reference this post <a href=\"http://stackoverflow.com/questions/623458/rails-select-helper-default-selected-value-how\">selecting a default for option field</a></p>\n\n<p>If any one could give me some insight as to how to fix this issue I would greatly appreciate it. Any ideas would help, Thanks for reading.</p>\n\n<p>-Alan</p>\n"},{"tags":["mysql","ruby","ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13167743,"title":"Safe querying by find, sql, or where","body":"<p>I want to find all widgets with their common or internal names in a certain list <code>query_list</code>. I can do</p>\n\n<pre><code># Consider query_list = [\"a\",\"b\",\"c\"]\nqlist = '(' + query_list.join(\",\") + ')'\n# this makes \nwidgets = Widget.find_by_sql(\"SELECT * FROM widgets \n     WHERE common_name IN #{qlist} OR internal_name IN #{qlist}\")\n</code></pre>\n\n<p>Now I have a few questions:</p>\n\n<ol>\n<li>Is the above find_by_sql safe regarding SQL injection attacks? It seems like one could put in something dangerous in <code>query_list</code>.\n<ul>\n<li>How about writing <code>.find_by_sql([\"SELECT * FROM widgets\n     WHERE common_name IN ? OR internal_name IN ?\", [\"a\",\"b\",\"c\"], [\"a\",\"b\",\"c\"] ])</code></li>\n<li>If it isn't safe, can we make it safe?</li>\n</ul></li>\n<li>I prefer not to write raw sql if I don't have to. I know we can write <code>AND</code> conditions in <code>find</code>, as in <code>.find(:conditions=&gt;{:internal_name =&gt; ['a','b','c'], :common_name =&gt; ['a','b','c']})</code>. Can we also write <code>OR</code> conditions using find?</li>\n<li>How about using <code>where</code>? How is this different from using <code>find</code>?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongomapper"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13167053,"title":"rails generate migration error mongo_mapper not found","body":"<p>Follow <a href=\"http://mongomapper.com/documentation/getting-started/rails.html\" rel=\"nofollow\">Installation in Rails 3 of Mongo Mapper</a> i add to config/application.rb file :</p>\n\n<pre><code>config.generators do |g|\n  g.orm :mongo_mapper\nend\n</code></pre>\n\n<p>when <code>rails generate migration my_migration</code> i got :</p>\n\n<pre><code>error  mongo_mapper [not found]\n</code></pre>\n\n<p>but when <code>rails generate model my_model</code>, i got a fine model class with <code>include MongoMapper::Document</code> and this output :</p>\n\n<pre><code>invoke  mongo_mapper\ncreate    app/models/user.rb\ninvoke    test_unit\ncreate      test/unit/user_test.rb\ncreate      test/fixtures/users.yml\n</code></pre>\n"},{"tags":["ruby-on-rails-3","helper","twitter-bootstrap-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":212,"score":1,"question_id":11224276,"title":"rails twitter bootstrap helper methods","body":"<p>I am using the <code>twitter-bootstrap-rails</code> gem in my app. It seems to come with a range of helper methods that create for example the edit and delete buttons in a themed view:</p>\n\n<pre><code>&lt;%= link_to t('.destroy', :default =&gt; t(\"helpers.links.destroy\")),\n                  cohort_path(cohort),\n                  :method =&gt; :delete,\n                  :confirm =&gt; t('.confirm', :default =&gt; t(\"helpers.links.confirm\", :default =&gt; 'Are you sure?')),\n                  :class =&gt; 'btn btn-mini btn-danger' %&gt;\n</code></pre>\n\n<p>Where are these t() methods and helpers defined? How can I alter them? For example, if I want to change the label on the Destroy button to \"Delete\" I can change the above to:</p>\n\n<pre><code>&lt;%= link_to t('.destroy', :default =&gt; \"Delete\"),\n                  cohort_path(cohort),\n                  :method =&gt; :delete,\n                  :confirm =&gt; t('.confirm', :default =&gt; t(\"helpers.links.confirm\", :default =&gt; 'Are you sure?')),\n                  :class =&gt; 'btn btn-mini btn-danger' %&gt;\n</code></pre>\n\n<p>What I would really like to do is change <code>t(\"helpers.links.destroy\")</code> to display \"Delete\" instead of \"Destroy\" in all my views. Can I do that? Appreciate your help!</p>\n"},{"tags":["ruby-on-rails-3","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13166761,"title":"Rails - Associations with API","body":"<p>I'm working on an API in Rails and have hit a wall. I'm missing something stupid I imagine, but I can't see it.</p>\n\n<p><a href=\"https://gist.github.com/3989396\" rel=\"nofollow\">https://gist.github.com/3989396</a></p>\n\n<p>I can not get associations passed in the item.json to create an association. I thought that Rails would hook these up.</p>\n"},{"tags":["ruby-on-rails-3","redirect","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13160619,"title":"Rails 3 routes redirect to named url without hitting controller","body":"<p>According to the <a href=\"http://edgeguides.rubyonrails.org/routing.html#redirection\" rel=\"nofollow\">Rails Routing Redirection guide</a>, there doesn't seem to be an easy way to redirect a matched URL to another named URL within the routes file. </p>\n\n<p>I wish I could redirect like this, or something similar, in my routes.rb without having specify the full url path (<code>\"/articles/%{id}\"</code>) in the redirect function.</p>\n\n<pre><code>match \"articles/:id\" =&gt; \"articles#show\", :as=&gt;'article'\nmatch \"articles/view/:id\", :to =&gt; redirect(article_path) \n</code></pre>\n\n<p>Is there a plugin or gem that might provide this functionality?</p>\n\n<hr>\n\n<p>My final solution included adding a function like the following based on the accepted answer.</p>\n\n<pre><code># handles redirecting a matched URL to a named URL\n# source_match = string to match against\n# dest_name = symbol of the named URL \ndef redirect_to_url(source_match,dest_name)\n    param_symbols = source_match.scan(/:([a-z\\-\\_]+)/i).flatten.map{|i| i.to_sym}\n    match source_match, :to=&gt;redirect{|params,request| \n        Rails.application.routes.url_helpers.send(\"#{dest_name}_path\", params.slice(*param_symbols))\n    }\nend\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ajax"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13161283,"title":"Rails remote form renders json in browser","body":"<p>I have a remote form for creating images. Each time the file input is changed, it submits the form.</p>\n\n<pre><code>&lt;%= form_for Image.new, remote: true, multipart: true do |f| %&gt;\n  &lt;!-- form omitted --&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The automatic submitting:</p>\n\n<pre><code>$(\"#new_image input[type=file]\").on(\"change\", function() {\n  $(\"#new_image\").submit();\n});\n</code></pre>\n\n<p>The image is created and json is rendered in the images controller just fine:</p>\n\n<pre><code>def create\n  @image = Image.new params[:image]\n  if @image.save\n    render json: @image, status: :success\n  else\n    render json: @image.errors, status: :unprocessable_entity\n  end\nend\n</code></pre>\n\n<p>The problem is then the user is redirected to the json output. How could that happen? The form is remote: true, so it shouldn't redirect right? I just want the data available for unobtrusive callbacks. </p>\n\n<p>How do I get this to work?</p>\n\n<p><strong>Edit</strong>: application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require jquery-ui\n//= require_tree .\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","integration-testing","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13165975,"title":"Capybara Not Finding Form Fields","body":"<p>I was trying Capybara for the first time and having trouble with it finding my form. I'm using Rspec, Capybara, Rails 3.2.8, and Twitter Bootstrap.</p>\n\n<p>In my test, I had:</p>\n\n<pre><code>before do\n  choose  \"Residential\"\n  choose  \"Storage\"\n  fill_in \"Customer Location\",  with: 30082\n  fill_in \"datepicker\",         with: 2012-12-02\n  fill_in \"Email\",              with: \"jesse@test.com\"\n  fill_in \"Phone\",              with: \"555-555-5555\"\n end\n</code></pre>\n\n<p>And was getting the error:</p>\n\n<pre><code>Failure/Error: choose  \"Residential\"\n   Capybara::ElementNotFound:\n     cannot choose field, no radio button with id, name, or label 'Residential' found\n</code></pre>\n\n<p>In my form, I had (excerpt):</p>\n\n<pre><code>    &lt;%= quote.radio_button :customer_type, \"Residential\"%&gt;\n    &lt;%= quote.label \"Residential\", class:\"radio inline\" %&gt;\n</code></pre>\n\n<p>When I fired up the server, I could see the form and Firebug showed that I had a label named \"Residential\" associated with the form element.</p>\n\n<p>After searching for the problem and finding this post: <a href=\"http://stackoverflow.com/questions/11356161/capybara-not-finding-form-elements/13165829#13165829\">Capybara not finding form elements</a> (among others), I couldn't figure out why it wasn't working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","amazon-s3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13149240,"title":"Ruby aws-sdk - timeout error","body":"<p>I am trying to upload a file to S3 with the following simple code:</p>\n\n<pre><code>bucket.objects.create(\"sitemaps/event/#{file_name}\", open(file))\n</code></pre>\n\n<p>I get the following:</p>\n\n<p><strong>Your socket connection to the server was not read from or written to within the timeout period. Idle connections will be closed.</strong></p>\n\n<p>What could be going wrong?  Any tips will be appreciated.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13164316,"title":"Making select box a required field in some situations","body":"<p>I have a form which has a select box with categories. If a particular category is selected, another select box/dropdown is displayed to the user. I need this second dropdown to be a required field when this category is selected.</p>\n\n<p>I cannot add <code>validates :course, :presence =&gt; {:message =&gt; 'Course cannot be blank.'}</code> to the model because this field is not always required, I need some other way to make it required only when certain category is selected in the first dropbox.</p>\n\n<p>Thanks for your help</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","hyperlink","download","link-to"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13164063,"title":"file download link in rails","body":"<p>I would like to give visitors the option to download some pdf. \nI have tried:</p>\n\n<pre><code>&lt;%= link_to \"abc\", \"/data/abc.pdf\"%&gt;\n\n&lt;%= link_to \"abc\", \"/data/abc.pdf\", :format =&gt; 'pdf' %&gt;\n</code></pre>\n\n<p>and some variations but they don't seem to work. I keep getting <code>No route matches [GET] \"/data/abc.pdf\"</code></p>\n\n<p>I have the pdf files in a folder called data, located in the assets folder.\nAny help would be appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13146839,"title":"Accessing/setting nested value with a form","body":"<p>I have 30k+ documents in my database with this structure:</p>\n\n<pre><code>{\n  ...,\n  \"hours\" : {\n    \"holiday\" : {\n      \"New Years\" : \"Call\",\n      \"Easter\" : \"Closed\",\n      \"Memorial Day\" : \"Standard\",\n      \"Independence Day\" : \"Standard\",\n      \"Labor Day\" : \"Standard\",\n      \"Thanksgiving\" : \"Closed\",\n      \"Day After Thanksgiving\" : \"Call\",\n      \"Christmas Eve\" : \"Call\",\n      \"Christmas\" : \"Closed\",\n      \"New Years Eve\" : \"Call\"\n    },\n    \"standard\" : {\n      \"mon\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"tue\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"wed\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"thu\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"fri\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"sat\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"11:00 pm\"\n      }],\n      \"sun\" : [{\n        \"open\" : \"8:00 am\",\n        \"close\" : \"10:00 pm\"\n      }]\n    }\n  },\n  ...\n}\n</code></pre>\n\n<p>I am doing a complete rewrite from a php-driven site.  I have been racking my brain and absolutely cannot come up with a way to make a form field that will allow me to set business.hours[\"standard\"][\"mon\"] properly.  The site offers multiple open/close entries per day, for businesses that close for lunch, etc.  That attribute would be set to [{\"open\" : \"8:00 am\", \"close\" : \"12:00 pm},{\"open\" : \"1:00 pm\", \"close\" : \"5:00 pm}] in such a case.  I would like to offer two select boxes for each entry, one for open time and one for close time.  </p>\n\n<p>Here is my Model. including some getters/setters that I was attempting to figure out how to tie into my form...unsuccessfully.</p>\n\n<pre><code>class Business\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  field :ad, type: String\n  field :address, type: String\n  field :city, type: String\n  field :claimed, type: Boolean\n  field :coupons, type: String\n  field :created_at, type: DateTime\n  field :extra_services, type: Array\n  field :hours, type: Hash\n  field :name, type: String\n  field :organization, type: String\n  field :permanently_closed, type: Boolean, :default =&gt; false\n  field :phone, type: String\n  field :state, type: String\n  field :tags, type: Array\n  field :unit, type: String\n  field :updated_at, type: DateTime\n  field :website, type: String\n  field :zip, type: String\n\n  attr_accessible :ad, :address, :city, :claimed, :coupons, :created_at, :updated_at, :extra_services, :hours,\n                  :name, :organization, :permanently_closed, :phone, :state, :tags, :unit, :website, :zip\n\n  index({address: 1, unit: 1, city: 1, state: 1, zip: 1, organization: 1}, {unique: true, name: \"address_unique_index\"})\n\n  after_initialize do |b|\n    b.hours = Hash.new unless b.hours\n    b.hours[\"holiday_hours\"] = {\"New Years\" =&gt; \"Call\",\n                                \"Easter\" =&gt; \"Call\",\n                                \"Memorial Day\" =&gt; \"Call\",\n                                \"Independence Day\" =&gt; \"Call\",\n                                \"Labor Day\" =&gt; \"Call\",\n                                \"Thanksgiving\" =&gt; \"Call\",\n                                \"Day After Thanksgiving\" =&gt; \"Call\",\n                                \"Christmas Eve\" =&gt; \"Call\",\n                                \"Christmas\" =&gt; \"Call\",\n                                \"New Years Eve\" =&gt; \"Call\"} unless b.hours[\"holiday_hours\"]\n\n    b.hours[\"standard_hours\"] = Hash.new unless b.hours[\"standard_hours\"]\n  end\n\n  def holiday_hours\n    hours[\"holiday_hours\"] if hours[\"holiday_hours\"]\n  end\n\n  def holiday_hours=(hours)\n    self.hours[\"holiday_hours\"] = hours if hours.present?\n  end\n\n  def holiday_hours_for(holiday)\n    hours[\"holiday_hours\"][holiday.to_s] if hours[\"holiday_hours\"][holiday.to_s]\n  end\n\n  def update_holiday_hours_for(holiday, hours_text)\n    self.hours = Hash.new unless hours\n    self.hours[\"holiday_hours\"] = Hash.new unless hours[\"holiday_hours\"]\n    self.hours[\"holiday_hours\"][holiday.to_s] = hours_text.to_s\n  end\n\n  def standard_hours\n    hours[\"standard_hours\"] if hours[\"standard_hours\"]\n  end\n\n  def standard_hours_for(day)\n    hours[\"standard_hours\"][day.to_s] if hours[\"standard_hours\"][day.to_s]\n  end\nend\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13163704,"title":"Rails Hide Specific Record From All Select * Type Queries","body":"<p>I have a record in a table that serves as a placeholder of sorts, and doesn't represent actual data. It's bad design, I know, but I have some very awkward requirements that I have to deal with and I saw no other solutions so it's a bit of a hotfix per se. </p>\n\n<p>Now lets say I have a series of SELECT *s throughout my application and I don't want to have to explicitly exclude that single record for each of them. Is there anything I can drop into my model to exclude it from all queries except for the ones where it's explicitly called? Or perhaps some logic I can put directly into my PG database?</p>\n\n<p>It's the very first record in the table with an ID of 0. </p>\n"},{"tags":["ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13128425,"title":"delayed_job randomly disappearing jobs without executing them","body":"<p>Rails 3.2.8, delayed_job (3.0.3), delayed_job_active_record (0.3.3).  Using WEBrick.</p>\n\n<p>I have an initializer that asynchronously populates the cache on startup:</p>\n\n<pre><code>MyModel.delay.get_lots_of_records\nMyModel.delay.get_some_other_records\nMyOtherModel.delay.get_tons_of_records\nMyOtherModel.delay.get_some_other_records\n</code></pre>\n\n<p>In the development environment, this works fine, as evidenced by the delayed_job log and the cache log.</p>\n\n<p>In staging, however, sometimes 1 or 2, or sometimes none of these jobs are executed.  Usually at least one, typically the same one (but not always), is executed.  If I look at the delayed_jobs table after startup, I see <strong>all 4</strong> jobs get written and then vanish 2 seconds later.  </p>\n\n<p>Per the recommendation <a href=\"https://github.com/collectiveidea/delayed_job/wiki/Common-problems#wiki-jobs_are_silently_removed_from_the_database\" rel=\"nofollow\">here</a>, I have </p>\n\n<pre><code># config/initializers/delayed_job_config.rb\nDelayed::Worker.destroy_failed_jobs = false\n</code></pre>\n\n<p>But the jobs are still being very quickly deleted without failing or executing.</p>\n\n<p>If I insert breakpoints at <code>Delayed::PerformableMethod.perform</code>, I see that method called only if the jobs are actually executed, so the problem is upstream of that.  The <code>destroy</code> method is called after <code>perform</code>, though, so I'm not sure what's going on.</p>\n\n<p>I'm looking for troubleshooting recommendations or additional diagnostic actions.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","refactoring"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":72,"score":4,"question_id":13146445,"title":"How to refactor complex method in Rails model with Rspec?","body":"<p>I have the following complex method. I'm trying to find and implement possible improvements. Right now I moved last if statement to <code>Access</code> class.</p>\n\n<pre><code>def add_access(access)\n   if access.instance_of?(Access)\n     up = UserAccess.find(:first, :conditions =&gt; ['user_id = ? AND access_id = ?', self.id, access.id])\n     if !up &amp;&amp; company\n       users = company.users.map{|u| u.id unless u.blank?}.compact\n       num_p = UserAccess.count(:conditions =&gt; ['user_id IN (?) AND access_id = ?', users, access.id])\n       if num_p &lt; access.limit\n         UserAccess.create(:user =&gt; self, :access =&gt; access)\n       else\n         return \"You have exceeded the maximum number of alotted permissions\"\n       end\n     end\n   end\n end\n</code></pre>\n\n<p>I would like to add also specs before refactoring. I added first one. How should looks like others?</p>\n\n<pre><code>  describe \"#add_permission\" do\n    before do\n      @permission = create(:permission)\n      @user = create(:user)\n    end\n\n    it \"allow create UserPermission\" do\n      expect {\n        @user.add_permission(@permission)\n      }.to change {\n        UserPermission.count\n      }.by(1)\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","cucumber","capybara"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13090680,"title":"Cucumber + Capybara Not Executing AJAX Request","body":"<p>My Cucumber + Capybara tests are currently not executing AJAX requests. The test log does NOT contain the AJAX [POST] request, which leads me to believe that the request is never sent. Does anyone know what the problem(s) could be and how to troubleshoot it? </p>\n"},{"tags":["ruby","ruby-on-rails-3","routes","ip","firewall"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":99,"score":0,"question_id":9934545,"title":"Different Rails route if IP not in list?","body":"<p>I have a Rails 3.2.2 application which is a simple company intranet, however although there isn't any private information on there it's probably best if it was fairly secure from the outside world. </p>\n\n<p>We do however have people working from home on fairly regular occasions that don't have a VPN setup. </p>\n\n<p>Currently I have a firewall rule that blocks everyone except a list of our teams/branches static IP addresses. The problem with this is when a team member visits the site from home the site never loads because the firewall rejects them. What I would like to do is serve a simple page within the application explaining why they don't have \"full\" access. </p>\n\n<p>The firewall is serving multiple applications, so I can't put the access denied page on there </p>\n\n<p>I have read a few questions on SO such as <a href=\"http://stackoverflow.com/questions/3887943/ip-address-in-rails\">IP address in rails</a> which show how to get their IP address, but I'm unsure how to alter a default route based on that. </p>\n"},{"tags":["ruby-on-rails-3","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13161424,"title":"Rails 3 - Model Error Message Validation Messages","body":"<p>Currently I have a script that checks to make sure that a test card was not submitted in production (since Authorize.net accepts test credit cards in live mode) and I add an error message to the credit card number if the one submitted is in the <code>Test_Credit_Cards</code> array like so:</p>\n\n<pre><code>TEST_CREDIT_CARDS = ['370000000000002', '6011000000000012', '4007000000027', '4012888818888']\nvalidate :not_a_test_credit_card\n def not_a_test_credit_card\n      self.errors[:cc_number] &lt;&lt; \"number is invalid!\" if TEST_CREDIT_CARDS.include?(cc_number) and Rails.env.production?\n    end\n</code></pre>\n\n<p>Now on the front end the error message appears like so:\n<code>Credit card cc number is invalid!</code></p>\n\n<p>Is there anyway to change the message to read <code>Credit Card number is invalid!</code> I just want to remove the <code>cc</code> portion from the message.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","gem","actionview"],"answer_count":4,"favorite_count":7,"up_vote_count":13,"down_vote_count":0,"view_count":2023,"score":13,"question_id":5791211,"title":"How do I extract Rails view helpers into a gem?","body":"<p>I have a set of rails view helpers that I use regularly, and would like to package them up into a gem, such that I could just put a line in my Gemfile, and have the helpers accessible from my views.</p>\n\n<p>I have created gems before using Bundler, and Jeweler, however, I'm not all all clear on how to organize the Rails view helpers in a gem, and include them into rails.</p>\n\n<p>I would appreciate any pointers, or links to up-to-date tutorials on how to do this for Rails 3</p>\n\n<p>Thanks</p>\n\n<p>Just to clarify:  The question isn't on \"how to create a gem\".  Its \"how to package view helpers in a gem, so I can use them in Rails\"</p>\n\n<p>Edit 2:\nI also agree with the poster below..  A rails engine is waay too much overkill for this kind of (hopefully simple) requirement</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13070658,"title":"First or limit in Rails scope","body":"<p>I have the following scope:</p>\n\n<pre><code>scope :user_reviews, lambda { |user| where(:user_id =&gt; user) }\n</code></pre>\n\n<p>I apply this in the controller:</p>\n\n<pre><code>def show\n  @review = @reviewable.reviews.user_reviews(current_user).first || Review.new\nend\n</code></pre>\n\n<p>The <code>first</code> is to limit to search the current user's one and only review. Now I try to write a new scope <code>user_review</code> which I tried many ways to chain the <code>user_reviews</code> scope with <code>first</code>, but just couldn't get it what. Something like this:</p>\n\n<pre><code>scope :user_reviews, lambda { |user| where(:user_id =&gt; user) }\nscope :user_review, lambda { |user| user_reviews(user).first }\n</code></pre>\n\n<p>I know the above <code>user_review</code> is wrong, but just trying to show you guys what I am trying to do.</p>\n\n<p>How should I write this properly?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","capistrano","asset-pipeline","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12761162,"title":"Cap deploy doesn't work all the sudden; something to do with FactoryGirl and assets","body":"<p>I've been <code>cap deploy</code>ing my app all throughout it development, and this last time I tried to deploy it, it didn't work. Here's what happened:</p>\n\n<pre><code>  * executing `deploy:assets:precompile'\n  * executing \"cd /var/www/oneteam/releases/20121006153136 &amp;&amp; bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile\"\n    servers: [\"electricsasquatch.com\"]\n    [electricsasquatch.com] executing command\n ** [out :: electricsasquatch.com] rake aborted!\n ** [out :: electricsasquatch.com] uninitialized constant OneTeam::Application::FactoryGirl\n ** [out :: electricsasquatch.com] \n ** [out :: electricsasquatch.com] (See full trace by running task with --trace)\n</code></pre>\n\n<p>It looks like it failed on the <code>deploy:assets:precompile</code> command. I don't get why that command would have tried to do anything with FactoryGirl, though. Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13161554,"title":"How to set a blank input form?","body":"<p>I want to create a form where a user is able to update his/her email and password.</p>\n\n<pre><code>&lt;%= form_for @customer do |c| %&gt;\n    &lt;%= c.label :email%&gt;\n    &lt;%= c.text_field :email%&gt;\n    &lt;%= c.label :email_confirmation %&gt;\n    &lt;%= c.text_field :email_confirmation%&gt;\n    &lt;%= c.label :password%&gt;\n    &lt;%= c.password_field :password%&gt;\n    &lt;%= c.label :password_confirmation%&gt;\n    &lt;%= c.password_field :password_confirmation%&gt;\n    &lt;%= c.submit(\"Edit profile\")%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem is that I don't want them to be filled in when just looking at it.\nSo it should have something like:</p>\n\n<pre><code>Email [blank]\nEmail confirmation [blank]\nPassword [blank]\nPassword confirmation [blank]\n</code></pre>\n\n<p>So how do I have this to be blank in stead of pre-filled in by Rails?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec","mocking"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13160324,"title":"How to stub after_create callback save! in model?","body":"<p>I receive following error:</p>\n\n<p>Output:</p>\n\n<pre><code>1) LabelsController#create label is new creates a new label\n   Failure/Error: post :create, attributes[:label], format: :json\n   NoMethodError:\n     undefined method `save!' for nil:NilClass\n   # ./app/models/labeling.rb:17:in `update_target'\n</code></pre>\n\n<p>In Labeling model:</p>\n\n<pre><code>after_create :update_target\n\ndef update_target\n   self.target.save!\nend\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>require 'spec_helper'\ndescribe LabelsController do\n  before(:each) do\n    controller.stub(:current_user).and_return(mock_model(User))\n    stub_request(:any, \"www.example.com\").to_return(status: 200)\n  end\n  describe \"#create\" do\n    context \"label is new\" do\n      it \"creates a new label\" do\n        attributes = {\n          label: {\n            name: \"test\",\n            labeling: {\n              target_type: \"Link\", target_id: 1\n            }\n          }\n        }\n        response.status.should == 200\n        post :create, attributes[:label], format: :json\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Labeling controller:</p>\n\n<pre><code>  def create\n    label = Label.find_by_name(params[:name])\n\n    labeling = label.labelings.build do |lb|\n      lb.user_id     = current_user.id\n      lb.target_type = params[:labeling][:target_type]\n      lb.target_id   = params[:labeling][:target_id]\n    end\n\n    if labeling.save\n      render json: {\n        name: label.name,\n        id: label.id,\n        labeling: {\n          id: labeling.id\n        }\n      }\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":604,"score":2,"question_id":7743059,"title":"How do i get rid of @controller is nil error in my tests","body":"<p>I keep getting</p>\n\n<pre><code> @controller is nil: make sure you set it in your test's setup method.\n</code></pre>\n\n<p>When I run my tests. Any idea what this means?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13160441,"title":"How to remove quotes in active record query","body":"<p>I am trying to retrieve records from multiple tables based on collection of ids suing the \nbelow query, it is working fine.\n<br/><br/><strong>ACTIVE RECORD QUERY:</strong></p>\n\n<blockquote>\n  <p>Song.order(\"songs.id desc\").\n            includes(:artist).includes(:album).\n            joins(\"LEFT JOIN artists ON songs.artist_id = artists.id\").\n            joins(\"LEFT JOIN albums ON songs.album_id = albums.id\").\n            where(\"(songs.id)</p>\n  \n  <blockquote>\n    <p>IN (#{song_ids*','})</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE :term OR LOWER(artists.name) LIKE :term\n  OR LOWER(albums.title) LIKE :term)\",\n            :term => \"%#{terms[index].downcase}%\")</p>\n</blockquote>\n\n<p><strong>PG QUERY OUTPUT:</strong></p>\n\n<blockquote>\n  <p>SELECT \"songs\".* FROM \"songs\" LEFT JOIN artists ON songs.artist_id =\n  artists.id LEFT JOIN albums ON songs.album_id = albums.id WHERE (</p>\n  \n  <blockquote>\n    <p>(songs.id) IN (4,5,28,37,46,48)</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE '%wo%' OR LOWER(artists.name) LIKE\n  '%wo%' OR LOWER(albums.title) LIKE '%wo%')) ORDER BY songs.id desc</p>\n</blockquote>\n\n<p>But while I was trying to modify the query as below\n<br/><br/><strong>ACTIVE RECORD QUERY:</strong></p>\n\n<blockquote>\n  <p>Song.order(\"songs.id desc\").\n            includes(:artist).includes(:album).\n            joins(\"LEFT JOIN artists ON songs.artist_id = artists.id\").\n            joins(\"LEFT JOIN albums ON songs.album_id = albums.id\").\n            where(\"(songs.id)</p>\n  \n  <blockquote>\n    <p>IN (:song_ids)</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE :term OR LOWER(artists.name) LIKE :term\n  OR LOWER(albums.title) LIKE :term)\",</p>\n</blockquote>\n\n<pre><code>      :term =&gt; \"%#{terms[index].downcase}%\",:song_ids =&gt; song_ids*',')\n</code></pre>\n\n<p><strong>PG QUERY OUTPUT:</strong></p>\n\n<blockquote>\n  <p>SELECT \"songs\".* FROM \"songs\" LEFT JOIN artists ON songs.artist_id =\n  artists.id LEFT JOIN albums ON songs.album_id = albums.id WHERE (</p>\n  \n  <blockquote>\n    <p>(songs.id) IN ('4,5,28,37,46,48')</p>\n  </blockquote>\n  \n  <p>AND (LOWER(songs.title) LIKE '%wo%' OR LOWER(artists.name) LIKE\n  '%wo%' OR LOWER(albums.title) LIKE '%wo%')) ORDER BY songs.id desc</p>\n</blockquote>\n\n<p>Because of the single quotes the above query doesn't working.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","arel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":211,"score":0,"question_id":10149485,"title":"How can I build up an ActiveRecord query incrementally, line by line?","body":"<p>I'd like to piece together an ActiveRecord query using runtime data. What I have in mind is something like...</p>\n\n<pre><code>r = Person.where('last_name LIKE ?', foo)\nr.where('created_at &lt; ?', Time.now - 100.days)\nr.where( ...some other conditions... )\n</code></pre>\n\n<p>That doesn't work as intended though. To get it to work you have to chain them together all on one line...</p>\n\n<pre><code>Person.where('last_name LIKE ?', foo) \\\n  .where('created_at &lt; ?', Time.now - 100.days) \\\n  .where( ...some other conditions... )\n</code></pre>\n\n<p>I'm trying to figure out a way to spread it over separate operations on multiple lines.</p>\n"},{"tags":["ruby-on-rails-3","notifications","god"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":6,"score":0,"question_id":13160181,"title":"god.rb how to do multiple notifications?","body":"<p><strong>With below test.god how could one do multiple notifications?\nOnly 1 single notification seems to work.\nThis send 1 prowl notification but how to add a mail notification to this?</strong></p>\n\n<p>My example code:</p>\n\n<pre><code>God::Contacts::Email.defaults do |d|\n  d.from_email = 'noreply@host.com'\n  d.from_name = 'Monitor'\n  d.delivery_method = :smtp\n  d.server_host = 'host.com'\n  d.server_auth = true\n  d.server_domain = 'host.com'\n  d.server_user = 'info@host.com'\n  d.server_password = 'pass'\n end\n\nGod.contact(:email) do |c|\n  c.name = 'me'\n  c.group = 'system'\n  c.to_email = 'info@host.com'\nend\n\nGod.contact(:prowl) do |p|\n   p.name = 'xxx'\n   p.apikey = 'xxx'\nend\n\n\nGod.watch do |w|\n  w.name = \"simple\"\n  w.interval = 5.seconds\n  w.start = \"ruby /tmp/simple.rb\"\n  w.keepalive\n  w.start_grace   = 10.seconds \n  w.restart_grace = 10.seconds \n\n\n w.transition(:init, { true =&gt; :up, false =&gt; :start }) do |on|\n    on.condition(:process_running) do |c|\n      c.running = true\n    end\n  end\n\n  # determine when process has finished starting\n  w.transition([:start, :restart], :up) do |on|\n    on.condition(:process_running) do |c|\n      c.running = true\n    end\n  end\n\n  # start if process is not running\n  w.transition(:up, :start) do |on|\n    on.condition(:process_exits)\n  end\n\n  # # bind the notification via mail when some problems occours\n  w.transition(:up, :start) do |on|\n    on.condition(:process_exits) do |p|\n      p.notify = 'xxx'\n    end\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tablesorter"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13146587,"title":"tablesorter-infoOnly shows the sort icons even when disabled in rails","body":"<p>I am working on a rails application and have two tbody's for a table. I disabled the table-sorter in second tbody by using tablesorter-infoOnly. But still it shows the icons associated with sorting next to the table headers eventhough sort has been disabled. . </p>\n\n<p>Is their any way to remove the sorter images in rails application or handling it in javascript to disable the icons from displaying n the second tbody??</p>\n"},{"tags":["ruby-on-rails-3","header","pdfkit"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":11830114,"title":"Setting header size in PDFKit with Ruby on Rails?","body":"<p>I need a repeating image to be shown on every page of the pdf. The only solution to this I've found so far is putting it into the header using</p>\n\n<p><code>%meta{:name =&gt; 'pdfkit-header_html', :content =&gt; pdf_header_url}</code></p>\n\n<p>Works fine but the image is bigger than the header size. Is there any way I can increase the height of the header or put a repeating image somehow outside the header?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","analytical"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13159707,"title":"Analytical gem on Heroku error","body":"<p>Good morning. I am trying to use this gem:</p>\n\n<p><a href=\"https://github.com/jkrall/analytical\" rel=\"nofollow\">https://github.com/jkrall/analytical</a></p>\n\n<p>On Heroku. It runs dandy on my local environment, but on Heroku busts out with:</p>\n\n<pre><code>2012-10-31T13:52:28+00:00 app[web.1]: /usr/local/lib/ruby/1.9.1/syck.rb:135:in `load': syntax error on line 4, col 5: `' (ArgumentError)\n2012-10-31T13:52:28+00:00 app[web.1]:   from /usr/local/lib/ruby/1.9.1/syck.rb:135:in `load'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/analytical-3.0.12/lib/analytical.rb:14:in `block in analytical'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/analytical-3.0.12/lib/analytical.rb:13:in `open'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/analytical-3.0.12/lib/analytical.rb:13:in `analytical'\n2012-10-31T13:52:28+00:00 app[web.1]:   from /app/app/controllers/api_controller.rb:1:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>The line in \"api_controller.rb\" it is references is simply the \"analytical\" statement that initializes the gem in that controller, per the documentation.</p>\n\n<p>Tried putting \"analytical\" in application_controller instead and it errored out too (in both dev and staging).</p>\n\n<p>Totally stumped. Any help would be much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13120994,"title":"Migrating a Heroku Postgres Database from a Dev to Basic Plan","body":"<p>I've followed Heroku's guide on migrating my postgres database from a Dev to Basic Plan: <a href=\"https://devcenter.heroku.com/articles/migrating-from-a-dev-to-a-basic-database\" rel=\"nofollow\">https://devcenter.heroku.com/articles/migrating-from-a-dev-to-a-basic-database</a></p>\n\n<p>Everything seems to have gone well but i'm a little confused by the info below. Even though the new basic DB is showing some data, it's not showing any tables. The data size is also different. Before I remove my Dev DB, has anyone else seen the same? Can anyone explain what's happening here?</p>\n\n<pre><code>Ryans-MacBook-Pro:dashboard ryanberry$ heroku pg:info -a myapp(replaced with my app name)\n=== HEROKU_POSTGRESQL_BLUE (DATABASE_URL)\nPlan         Basic\nStatus       available\nConnections  4\nPG Version   9.1.5\nCreated      2012-10-29 10:51 UTC\nData Size    111.6 MB\nTables       0\nFork/Follow  Unavailable\n=== HEROKU_POSTGRESQL_CHARCOAL\nPlan         Dev\nStatus       available\nConnections  0\nPG Version   9.1.5\nCreated      2012-10-20 02:26 UTC\nData Size    112.4 MB\nTables       30\nRows         389702/10000 (Write access revoked)\nFork/Follow  Unavailable\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","dsl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":6813118,"title":"How to write a DSL that is not in isolation to the block's environment?","body":"<p>I am trying to write a small Ruby DSL and have stumbled upon an inconvenience. Right now my \"DSL\" code is <a href=\"https://gist.github.com/0379b07f516f4f322204\" rel=\"nofollow\">https://gist.github.com/0379b07f516f4f322204</a> and my implementation code (inside an .html.erb file) is:</p>\n\n<pre><code>html_table_for @users do |t, user|\n  t.field :username, link_to(user.username, :action =&gt; 'show', :id =&gt; user.id)\n  t.field :email\n  t.field :roles, user.roles.map(&amp;:code).join(', ')\nend\n</code></pre>\n\n<p>The implementation code does not look much like a DSL because of the <code>t.field</code> instead of simply <code>field</code>. By replacing <code>@block.call</code> in the DSL code (line 34) with <code>instance_exec(@block)</code> I almost get what I want but then I lose all the ActionView goodness (namely <code>link_to</code>).</p>\n\n<p><strong>Is there a way to make available in the block the instance methods of my little DSL class while at the same time keeping availability of the helper methods of ActionPack included in Rails?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13150334,"title":"How do I stop caching of layout in production with Ruby on Rails?","body":"<p>I'm building a rails app allows the admin to load (and reload) an .erb template that will function as a layout. i.e. the application.html.erb</p>\n\n<p>On occasion when updating an already created template to my hosted app the changes do not take effect. If I load a differently named file to the same template this does show the changes. </p>\n\n<p>This is not an issue in DEV on my local environment but is an issue for PROD. Is there a setting that controls the caching of the layout for a page? The dynamic content is no problem but the static layout does not change unless I restart the app. Please let me know if you have any brilliant insights about this issue, or if it needs greater explanation.</p>\n"},{"tags":["ruby-on-rails-3","image-processing","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13155789,"title":"Carrierwave in modules","body":"<p>This is my model in /app/library/stone.rb</p>\n\n<pre><code>class Library::Stone &lt; ActiveRecord::Base\n   attr_accessible :group, :healing, :life, :logo, :magic, :name, :other, :place,    :structure, :view\n\n   mount_uploader :logo, LogoUploader\n\n   before_save :cap_group\n\n   def cap_group\n     self.name = self.name.mb_chars.capitalize.to_s\n     self.group = self.name[0]\n   end\n\nend\n</code></pre>\n\n<p>This is the uploader /app/uploaders/logo_uploader.rb</p>\n\n<pre><code>class LogoUploader &lt; CarrierWave::Uploader::Base\n  storage :file\n\n  def store_dir\n     \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  version :thumb do\n    process :resize_to_limit =&gt; [200, 300]\n  end\n\nend\n</code></pre>\n\n<p>The problem is that this works in the console, but when I try it in the browser, the image is not uploaded properly. I think it is because somehow the </p>\n"},{"tags":["ruby-on-rails-3","amazon-ec2","hosting","project-management","costs"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":22,"score":0,"question_id":13158168,"title":"What are the costs of running high-load application?","body":"<p>I understand that maybe this question is not related directly to the theme of stack-overflow resource, but I consider this question as very important. </p>\n\n<p>I have prototype application written on ruby on rails. It is simple social network with a storage of files (users share their papers and collaborate on creation of new papers).</p>\n\n<p>So it is a commercial service oriented to scientists and universities, and I expect huge storage and huge traffic. I am expecting 100-200 thousand users with a storage usage of 10-20mb per active user in 2 years. Let's say the share of active users is 10% (10000-20000 users).</p>\n\n<p>I have never had experience of deploying high load projects, so I do not know the typical fixed costs and variable costs and possible pitfalls. \nMaybe you have an empirical evidence of how much such project could cost?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","full-text-search","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13151921,"title":"Does Sphinx provide the capability to extract indexed information rather than hitting the database?","body":"<p>On a successful search will one be able to access the sphinx indexed data instead of hitting the database. </p>\n\n<p>Thinking Sphinx provides the a method to search and retrieve only the document ids through <code>ThinkingSphinx.search_by_ids</code>. Does it provide an API to retrieve only indexed data without hitting the database?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13157902,"title":"How to authenticate facebook user using devise through api?","body":"<p>I have devise for authentication and also i have added omniauth for facebook and twitter and now what i need is allow the user to login from iphone app</p>\n\n<pre><code>curl -H 'Content-Type: application/json'   -H 'Accept: application/json'   -X POST http://localhost:3000/users/sign_in  -d \"{'user' : { 'email' : 'sample@gmail.com', 'password' : 'xxxxxxxx'}}\"\n</code></pre>\n\n<p>it gives out the token and user email if it is valid and incase not valid user it displays</p>\n\n<pre><code>{\"error\":\"Invalid email or password\"}\n</code></pre>\n\n<p>similarly how can i send the facebook id and password to check whether the user is valid or not?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","functional-testing","assert-response"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":95,"score":3,"question_id":11451080,"title":"Why \"assert_response\" ignores the custom message in Rails?","body":"<p>In my functional test I verify the response status like that:</p>\n\n<pre><code>assert_response :error, \"My error message\"\n</code></pre>\n\n<p>However, Rails ignores my custom message and reports:</p>\n\n<blockquote>\n  <p>Expected response to be a &lt;:error>, but was &lt;201></p>\n</blockquote>\n\n<p>Any ideas why?</p>\n\n<p>I use Rails 3.2.6.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13155510,"title":"Add DateTime offset in seconds","body":"<p>I have a DateTime in UTC, and would like add an offset which is provided in seconds</p>\n\n<pre><code>#json parsed - utc offset in seconds - turned into integer\n@utc_offset = result[\"UTCOffsetMillis\"].to_i\n#json parsed - utc date\nstart_date_string = result[\"startDate\"].split(\"-\")\nstart_date = DateTime.new(start_date_string[0].to_i, start_date_string[1].to_i,start_date_string[2].to_i)\n</code></pre>\n\n<p>How do I add this offset in seconds to start_date??</p>\n\n<p>Rails 3.2.3\nRuby 1.9.2p320</p>\n"},{"tags":["ruby-on-rails-3","html5"],"answer_count":1,"favorite_count":2,"up_vote_count":10,"down_vote_count":1,"view_count":256,"score":9,"question_id":11992995,"title":"Example on implementing HTML5 Server Side Event in Rails 3.2","body":"<p>I am trying to introduce HTML5 Server-Side-Event to my Rails 3.2 project. I did some search at Google.com, but most of the examples are using php. There's only one example on Rails that is using <code>Goliath</code>, and I am not using that.</p>\n\n<p>I am using <code>Thin</code> in my development and deploying with <code>passenger</code>. I think it's valid for doing text streaming for SSE. Is there any examples on Rails 3.2 for reference?</p>\n"},{"tags":["ruby-on-rails-3","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13156218,"title":"elasticsearch / tire how to correctly return default recordset?","body":"<p>What would be the best way to approach the return of a default recordset? If no search results are returned. Currently using below code but it feels not the correct way. </p>\n\n<pre><code>def self.search(params)\n\n      puts \"SEARCH PARAM =\"\n      puts params\n\n      if params\n        tire.search(load: true, page: params[:page], per_page: 20, :default_operator =&gt; 'AND', :use_dis_max =&gt; true) do\n          query do\n            boolean do\n              must { string 'gamers:2' } if params[:gamers] == \"2\"\n              must { string 'gamers:4' } if params[:gamers] == \"4\"\n            end\n          end\n          to_curl\n        end\n      else\n        puts \"search params not found\"\n        @gamers = Gamers.where(:level =&gt; \"rookie\")\n      end\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","integration-testing","capybara","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":250,"score":1,"question_id":9755185,"title":"Minitest integration testing: session not tearing down?","body":"<p>I recently switched a very simple rails app from rspec to minitest. I also use capybara and factory_girl.</p>\n\n<p>I have 3 separate integration test files, all of which involve logging the user in using something along the lines of:</p>\n\n<pre><code>before(:each) do\n  user = Factory(:user)\n  visit login_path\n  fill_in \"Email\", :with =&gt; user.email\n  fill_in \"Password\", :with =&gt; user.password\n  click_button \"Log in\"\nend\n</code></pre>\n\n<p>After I switched to minitest, it seems as if the sessions ceased to tear down after each test. For instance, I would test login using the above code in a test file named \"users_integration_test.rb\" and when it begins running another test file, say \"sessions_integration_test.rb\", the user is already logged in before I can log in again using the above code.</p>\n\n<p>My question is: Is this an intentional difference between rspec and minitest, and I simply need to logout the user after each test? Or did I make a mistake setting up minitest? </p>\n\n<p>I am using the same minitest_helper file as in the Minitest Railscast.</p>\n"},{"tags":["ruby-on-rails-3","wkhtmltopdf"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":522,"score":1,"question_id":9567161,"title":"wkhtmltopdf not working (pdfkit)","body":"<p>I'm having trouble generating a PDF out of a html page.</p>\n\n<p>I'm using PDFkit. I installed also wkhtmltopdf following the installation instructions. In 'usr/local/bin/' there is now a file called 'wkhtmltopdf'</p>\n\n<p>When I run a pdf with PDFkit, it now gives an error:</p>\n\n<pre><code>command failed: \"/usr/local/bin/wkhtmltopdf\" \"--margin-right\" \"0.75in\" \"--page-size\" \"Letter\" \"--margin-top\" \"0.75in\" \"--margin-bottom\" \"0.75in\" \"--encoding\" \"UTF-8\" \"--margin-left\" \"0.75in\" \"--quiet\" \"-\" \"-\"\n</code></pre>\n\n<p>Also, when I try to generate a PDF directly it gives an error:</p>\n\n<pre><code>wkhtmltopdf --page-size A4--quiet http://localhost/invoices/22 -\n\n'/usr/local/bin/wkhtmltopdf: cannot execute binary file'\n</code></pre>\n\n<p>Any idea of what this could be?\nThis is how the PDFkit config file looks:</p>\n\n<pre><code>PDFKit.configure do |config|\n  config.wkhtmltopdf = '/usr/local/bin/wkhtmltopdf'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13154177,"title":"Rails test adding unwanted parameter to assert_redirected_to","body":"<p>I have a test in my functional test which asserts the redirect after a remove is correct:</p>\n\n<pre><code>assert_redirected_to terrain_tip_url(terrain_id: entities(:deroos))\n</code></pre>\n\n<p>This should result in testing whether the url is: <a href=\"http://test.host/terrains/:terrain_id/tips\" rel=\"nofollow\">http://test.host/terrains/:terrain_id/tips</a> and in the application that is the exact url that is generated. However, in the test case this results in the url being: <a href=\"http://test.host/terrains/:terrain_id/tips/:id\" rel=\"nofollow\">http://test.host/terrains/:terrain_id/tips/:id</a>, which results in a failing test case:</p>\n\n<pre><code>Expected response to be a redirect to &lt;http://test.host/terrains/446801721/tips/495319887&gt; but was a redirect to &lt;http://test.host/terrains/446801721/tips&gt;\n</code></pre>\n\n<p>Why does the terrain_tip_url include an id parameter that I never set? How can I prevent this from happening?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view","localization"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13153775,"title":"Why I can`t use symbol in Rails 3 view Lazy Lookup?","body":"<p>I have following table in view:</p>\n\n<pre><code># views/students/index.html.haml\n%table.table\n  %thead\n    %tr\n      %th=t :first_name  # doesn`t work\n      %th=t '.last_name' # works\n  %tbody\n    - @students.each do |s|\n      %tr\n        %td=s.first_name\n        %td=s.last_name\n</code></pre>\n\n<p>This is my locales file:</p>\n\n<pre><code>pl:\n  students:\n    index:\n      first_name: \"Imię\"\n      last_name: \"Nazwisko\"\n</code></pre>\n\n<p>Is possible to use symbols instead of string '.first_name' ??</p>\n"},{"tags":["ruby-on-rails","ruby","linux","ruby-on-rails-3","rubygems"],"answer_count":6,"favorite_count":6,"up_vote_count":26,"down_vote_count":0,"view_count":10673,"score":26,"question_id":4922700,"title":"Ruby 1.9.2 and Rails 3 cannot open rails console","body":"<pre><code>[gkaykck@main myApplication]$ rails console\n/usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `require': no such file to load -- readline (LoadError)\n    from /usr/local/lib/ruby/1.9.1/irb/completion.rb:9:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands/console.rb:3:in `&lt;top (required)&gt;'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `require'\n    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.0.3/lib/rails/commands.rb:20:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have installed rails 3 on ruby 1.9.2p136, which is ok i guess. But i cannot start rails console and it gives me the error i copied. The apps worked great with ruby 1.8.7 and i never saw an error like this.</p>\n\n<p>Any ideas what it could be?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13151176,"title":"NameError: undefined local variable or method in rspec for rails 3.2.8","body":"<p>There is a method assign_user_rights which is defined in application controller in rails 3.2.8 app. In applications_controller_spec.rb, there is a test case for the method:</p>\n\n<pre><code>   it \"should assign_user_right\" do\n      .....\n      assign_user_rights\n      session[:index_all_users].should be_true\n    end\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Failure/Error: assign_user_rights\n     NameError:\n       undefined local variable or method `assign_user_rights' for #&lt;RSpec::Core::ExampleGroup::Nested_1::Nested_4:0x57550e0&gt;\n</code></pre>\n\n<p>Since assign_user_rights is defined in application controller, it should be readily visible in its spec file. However it is not the case as we see. What could be the problem with the code? Thanks.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13152751,"title":"error occurred while bundle install","body":"<p>Fetching gem metadata from <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a>.........\nFetching gem metadata from <a href=\"https://rubygems.org/\" rel=\"nofollow\">https://rubygems.org/</a>..\nUsing rake (0.9.2.2) \nUsing i18n (0.6.1) \nUsing multi_json (1.3.6) \nUsing activesupport (3.2.7) \nUsing builder (3.0.3) \nUsing activemodel (3.2.7) \nUsing erubis (2.7.0) \nUsing journey (1.0.4) \nUsing rack (1.4.1) \nUsing rack-cache (1.2) \nUsing rack-test (0.6.2) \nUsing hike (1.2.1) \nUsing tilt (1.3.3) \nUsing sprockets (2.1.3) \nUsing actionpack (3.2.7) \nUsing mime-types (1.19) \nUsing polyglot (0.3.3) \nUsing treetop (1.4.10) \nUsing mail (2.4.4) \nUsing actionmailer (3.2.7) \nUsing arel (3.0.2) \nUsing tzinfo (0.3.33) \nUsing activerecord (3.2.7) \nUsing activeresource (3.2.7) \nUsing coffee-script-source (1.3.3) \nUsing execjs (1.4.0) \nUsing coffee-script (2.2.0) \nUsing rack-ssl (1.3.2) \nUsing json (1.7.5) \nUsing rdoc (3.12) \nUsing thor (0.16.0) \nUsing railties (3.2.7) \nUsing coffee-rails (3.2.2) \nUsing columnize (0.3.6) \nUsing commonjs (0.2.6) \nUsing debugger-ruby_core_source (1.1.3) \nInstalling debugger-linecache (1.1.2) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.</p>\n\n<pre><code>    /home/kapil/.rvm/rubies/ruby-1.9.3-p286/bin/ruby extconf.rb \n</code></pre>\n\n<p>checking for vm_core.h... no\nchecking for vm_core.h... no\nMakefile creation failed</p>\n\n<hr>\n\n<p>No source for ruby-1.9.3-p286 provided with debugger-ruby_core_source gem.</p>\n\n<hr>\n\n<p><strong>* extconf.rb failed *</strong>\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.</p>\n\n<p>Provided configuration options:\n    --with-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/home/kapil/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\n    --with-ruby-dir\n    --without-ruby-dir\n    --with-ruby-include\n    --without-ruby-include=${ruby-dir}/include\n    --with-ruby-lib\n    --without-ruby-lib=${ruby-dir}/lib</p>\n\n<p>Gem files will remain installed in /home/kapil/.rvm/gems/ruby-1.9.3-p286/gems/debugger-linecache-1.1.2 for inspection.\nResults logged to /home/kapil/.rvm/gems/ruby-1.9.3-p286/gems/debugger-linecache-1.1.2/ext/trace_nums/gem_make.out\nAn error occurred while installing debugger-linecache (1.1.2), and Bundler cannot continue.\nMake sure that <code>gem install debugger-linecache -v '1.1.2'</code> succeeds before bundling.</p>\n\n<hr>\n\n<p>such problem occurred while bundle install . pls help </p>\n"},{"tags":["ruby-on-rails-3","apache","nginx"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":308,"score":1,"question_id":7008770,"title":"Nginx or Apache in RoR application?","body":"<p>I would like to ask which server to choose Apache or Nginx to host the application in RoR.\nThe whole works on a dedicated server 8 cores, 16GB of memory. The application is a content reader, with a fairly advanced file management. The most important criterion is the speed of serving content to the user.</p>\n"},{"tags":["ruby-on-rails-3","rails-routing"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13148425,"title":"Avoid index url after failing create","body":"<p>When you create a User in rails through the create action, the url is changed to</p>\n\n<pre><code>http://myapplication.com/users with POST\n</code></pre>\n\n<p>before being redirected elsewhere. If validation fails, it appears that the above URL is retained. If you then refresh, you end up on the index page (as it's now a GET).</p>\n\n<p>I would expect if validation was failed the url would remain as</p>\n\n<pre><code>http://myapplication.com/users/new\n</code></pre>\n\n<p>As i don't have an index page, this is causing me problems. Is there a way to resolve this please?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":172,"score":0,"question_id":12263762,"title":"how to convert doc, docx files to pdf in ruby/rails","body":"<p>I'm working on a web app in rails that uses document files, that I need to convert it to pdf in a place in the project! I wanna a ruby or javascript convert doc, docx, and plain text as well to pdf file.</p>\n\n<p>My search get me to a lot of pdf generators gems like <a href=\"https://github.com/prawnpdf/prawn\" rel=\"nofollow\">prawn</a>, <a href=\"http://railscasts.com/episodes/220-pdfkit\" rel=\"nofollow\">pdfkit</a>. they are generating pdf from templates (html and css or from a code!).</p>\n\n<p>If not, is there any api or a documentations to read doc/docx formats so that I can write the converter myself !?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13133441,"title":"Testing Creation Variable Assignments in Rspec","body":"<p>I'm creating a rspec test to see if the instance variable in the create method retains the data built. However, my test doesn't work since I'm returned with this error...</p>\n\n<pre><code>Failure/Error: assigns[:micropost]should eq(@post)\nexpected: #&lt;Micropost id: 1, content: \"Hello there\", user_id: 1&gt;\ngot: #&lt;Micropost id: 2, content: \"Hello there\", user_id: 1&gt;\n</code></pre>\n\n<p>My rspec test is</p>\n\n<pre><code>describe ::MicropostsController do\n\nbefore :each do\n  @post = FactoryGirl.create(:micropost)\nend\n\nit \"tests the instance variable in create method\" do\n    post :create, micropost: FactoryGirl.attributes_for(:micropost)\n    assigns(:micropost).should eq(@post)\nend\n</code></pre>\n\n<p>My FactoryGirl file is</p>\n\n<pre><code>FactoryGirl.define do\n\n factory :micropost do\n\n  content \"Hello there Bob!\"\n  user_id \"1\"\n  #even if I got rid of the double quotations around 1, the stringify key error still \n  #pops up\n\n end\n\nend\n</code></pre>\n\n<p>Here is the micropost controller create action code...</p>\n\n<pre><code>def create\n\n@micropost = Micropost.new(params[:micropost])\n\n respond_to do |format|\n\n  if @micropost.save\n\n    format.html { redirect_to @micropost, notice: 'Micropost was successfully create.' \n    }\n\n  else\n\n    format.html { render action: \"new\" }\n\n  end\n\n end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13147616,"title":"Migrate legacy database users to Devise","body":"<p>We have an old PHP app in MySQL that we're currently rewriting in Rails and PostgreSQL.\nI'm looking for a way to migrate users one-by-one when they first sign in to the new system, so that we migrate only active users.</p>\n\n<p>Is there a hook in <strong>Devise</strong> that I can use to catch a failed login towards the new database and check if the user exists in the old MySQL database and migrate the user if found.</p>\n\n<p>BTW, the Rails app can access both databases and the migration code is already in place that accepts old <code>username</code> as input.</p>\n\n<p>Or should I just simply make a separate _migration_assistant_ page that accepts old logins and initiates the migration?</p>\n\n<p>PS. any user can possibly have thousands of database records to migrate so it can take a bit of time, but we already make use of PosgreSQL's <code>COPY FROM</code> to speed it up (about a few secs per account).</p>\n\n<p><strong>EDIT:</strong>\nThere are currently about <strong>5000</strong> users and we expect roughly <strong>1000</strong> of them to return to the new site.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13150792,"title":"Rails Query Returns Results First Time Only","body":"<p>I'm having an unusual problem in an application I am developing.</p>\n\n<p>I am writing a controller/view to generate a sitemap.xml resource. It works perfectly the first time I test it by viewing it in the browser.</p>\n\n<p>However the second time, when I refresh the view, no page results are returned and the sitemap is effectively empty.</p>\n\n<p>If I make a change to the code. It could be as little as adding a blank line, or removing it, then the sitemap is correctly generated the first time. Any additional refreshes are empty.</p>\n\n<p>This is the code:</p>\n\n<p>The sitemap controller</p>\n\n<pre><code>class SitemapController &lt; ApplicationController\n    layout nil\n\n    def index\n        @pages = Page.where(:publish =&gt; true)\n        @base_url = \"http://#{request.host_with_port}\"\n        headers['Content-Type'] = 'application/xml'\n        def index\n            respond_to do |format|\n                format.xml\n            end\n        end\n    end\nend\n</code></pre>\n\n<p>Here is sitemap.xml.erb</p>\n\n<pre><code>&lt;?xml version=\"1.0\" ?&gt;\n&lt;urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\n&lt;% @pages.each do |page| %&gt;\n  &lt;url&gt;\n    &lt;loc&gt;&lt;%= \"#{@base_url}/#{page.permalink}\" %&gt;&lt;/loc&gt;\n    &lt;lastmod&gt;&lt;%= page.updated_at %&gt;&lt;/lastmod&gt;\n    &lt;priority&gt;0.5&lt;/priority&gt;\n  &lt;/url&gt;\n&lt;% end unless @pages.nil? %&gt;\n&lt;/urlset&gt;\n</code></pre>\n\n<p>and the route</p>\n\n<pre><code>match \"/sitemap.xml\", :to =&gt; \"sitemap#index\", :defaults =&gt; {:format =&gt; :xml}\n</code></pre>\n\n<p>The odd thing is that it seems to be in the query in the controller.</p>\n\n<pre><code>@pages = Page.where(:publish =&gt; true)\n</code></pre>\n\n<p>This returns nil on consecutive attempts, but a similar query in other parts of the app works every time. I have tried using alternative methods such as Page.all, and Page.find :all but the problem persists.</p>\n\n<p>I also uploaded this to the app on Heroku, wondering if it was something in my environment, but it happens there also.</p>\n"},{"tags":["jquery","ruby-on-rails-3","unobtrusive-javascript"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13150609,"title":"rails unobtrusive js and custom asset manifest files","body":"<p>I have a manifest file that looks as follows:</p>\n\n<pre><code># director.js\n\n//= require jquery\n//= require jquery_ujs\n//= require jquery-ui-1.8.22.custom.min\n//= require_tree ./tablet/director\n</code></pre>\n\n<p>which is pretty much the same as my application.js file except for the require_tree which points to another directory. My layout file looks has the following in the head:</p>\n\n<pre><code>= javascript_include_tag \"director\"\n</code></pre>\n\n<p>and I have pre compiled my assets in my environments/development.rb file using</p>\n\n<pre><code>config.assests.precompile += %w{ director.js }\n</code></pre>\n\n<p>yet for some reason my unobtrusive javascript isn't working. When I try to go to the delete action of a controller it looks for the show action, however opening firebug shows me that all the jquery files have been loaded. I really have no idea what is going on. Also when I change the javascript_include_tag to include \"application\" it works fine. I'm not sure what I have missed thats causing this. Any help would be great.</p>\n"},{"tags":["ruby","git","ruby-on-rails-3","configuration","heroku"],"answer_count":2,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1114,"score":6,"question_id":4857031,"title":"GIt Deployment + Configuration Files + Heroku","body":"<p>I'm using Heroku to host a Rails app, which means using Git to deploy to Heroku. Because of the \"pure Git workflow\" on Heroku, anything that needs to go upstream to the server has to be configured identically on my local box.</p>\n\n<p>However I need to have certain configuration files be different depending on whether I'm in the local setup or deployed on Heroku. Again, because of the deployment method Heroku uses I can't use .gitignore and a template (as I have seen suggested many times, and have used in other projects).</p>\n\n<p>What I need is for git to somehow track changes on a file, but selectively tell git not to override certain files when pulling from a particular repo -- basically to make certain changes one-way only.</p>\n\n<p>Can this be done? I'd appreciate any suggestions!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","attributes","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13150272,"title":"Meaning for attributes_for in FactoryGirl and Rspec Testing","body":"<p>Looking through a tutorial on controller testing the author gives an example of an rspec test testing a controller action. My question is, why did they use the method <code>attributes_for</code> over <code>build</code>? There is no clear explanation why <code>attributes_for</code> is used besides that it returns a hash of values.</p>\n\n<pre><code>it \"redirects to the home page upon save\" do\n  post :create, contact: Factory.attributes_for(:contact)\n  response.should redirect_to root_url\nend\n</code></pre>\n\n<p>The tutorial link is found here: <a href=\"http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html\" rel=\"nofollow\">http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html</a> The example is found at the beginning topic section <code>Controller testing basics</code></p>\n"},{"tags":["ruby-on-rails-3","heroku","authorize.net"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":150,"score":1,"question_id":9322822,"title":"Why does my authorize.net transaction succeed but reports that it fails?","body":"<p>I am using Authorize.net with Rails on Heroku.  I have created a form to submit the request to Authorize.net using the online examples such as: </p>\n\n<p><a href=\"https://developer.authorize.net/integration/fifteenminutes/ruby\" rel=\"nofollow\">https://developer.authorize.net/integration/fifteenminutes/ruby</a></p>\n\n<p>I have created an account on Authorize.net, and built a form that submits to authorize.net like so (in haml):</p>\n\n<pre><code>%h3 Enter your credit card details\n= form_for :sim_transaction, :url =&gt; @gateway_url do |f|\n  = sim_fields(@sim_transaction)\n  = order_details(@order)\n  .fields\n    .field\n      = label_tag 'x_card_num', 'Credit Card Number'\n      = text_field_tag 'x_card_num', params[:x_card_num], :style =&gt; 'width:200px'\n    .field\n      = label_tag 'x_exp_date', 'Expiration Date (MMYY)'\n      = text_field_tag 'x_exp_date', params[:x_exp_date], :style =&gt; 'width:40px'\n    .action\n      = f.submit 'Confirm order'\n</code></pre>\n\n<p>The order_details is a helper method that creates hidden fields for first name, last name, etc. From the purchase order.</p>\n\n<p>When submitted, the order processed by authorize.net and the users credit card is charged, but the POST to the relay response indicates the sim_response failed and was not processed. </p>\n\n<pre><code>if **sim_response.success?**(AUTHORIZE_NET_CONFIG['api_login_id'], AUTHORIZE_NET_CONFIG['merchant_hash_value'])\n  render :text =&gt; sim_response.direct_post_reply(payments_receipt_url(:only_path =&gt; false), :include =&gt; true)\nelse\n  render\nend\n</code></pre>\n\n<p>The sim_response.success? call is false.  Or, more specifically, there are two tests in the success method and this part of the success? method is false:</p>\n\n<pre><code>sim_response.valid_md5?(AUTHORIZE_NET_CONFIG['api_login_id'], AUTHORIZE_NET_CONFIG['merchant_hash_value'])\n</code></pre>\n\n<p>The result code I get back is \"1\" - which means the transaction was processed.  That's the text I see as well.</p>\n\n<p>From my research, the valid_md5 method only happens when there is an incorrect api_login_id, but I don't think that's the case.  Would the transaction succeed if the login_id was incorrect?  Any other suggestions for tracking this down?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","if-statement","checkout"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13143334,"title":"Basket IF arguments ROR","body":"<p>I am developing a rails app that includes a checkout basket and am in need of some basic help. </p>\n\n<p>I am struggling to integrate the logical arguments needed for some product pricing. What I would like to do is lower the price of the product if there are five or more products added to the cart. </p>\n\n<p>I currently have models and controllers for products, line_items, carts and orders with the typical associations.</p>\n\n<p>I am sure there is a simple <code>if and elseif</code> statement that I can define in a method but I would be interested to know how others else would go about implementing this as best practice? </p>\n\n<p>Thanks in advance for your help! Elle</p>\n"}]}
{"total":34674,"page":8,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147972,"title":"Pagination in Ruby when results fetched in a mySQL query","body":"<p>I fetch some rows in my Rails controller using the following query:</p>\n\n<pre><code>@main = connection.execute(\"SELECT code_ver, result FROM mastertest WHERE code_ver NOT LIKE '%DevBld%' AND date &gt;= DATE_SUB( (CURDATE()) , INTERVAL 90 DAY) ORDER BY date DESC;\")\n</code></pre>\n\n<p>Now in my index.html.erb (View) I display these rows in form of a table.</p>\n\n<p>But I want to have next and previous buttons in my html page such that It should display only a few rows at a time. Lets assume a week's data at a time. </p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13149146,"title":"What is the best way to determine if a variable is a number in Ruby?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/5661466/test-if-string-is-a-number-in-ruby-on-rails\">Test if string is a number in Ruby on Rails</a>  </p>\n</blockquote>\n\n\n\n<p>Currently I have this (awful) code:</p>\n\n<pre><code>def is_num(num_given)\n  begin\n    num_given.to_i\n    worked = true\n  rescue\n    worked = false\n  ensure\n    return worked\n  end\nend\n</code></pre>\n\n<p>Which I refactored to this:</p>\n\n<pre><code>def is_num(num_given)\n  num_given.to_i.is_a?(Numeric) rescue false\nend\n</code></pre>\n\n<p>This still just doesn't feel right to me, is there a better way to do this?</p>\n\n<p>Both of these implementations work fine for my purposes, I am just looking for some code euphoria. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13149342,"title":"Rails: how can I write this so it won't fail if it returns nil?","body":"<p>I'm just not sure how best to write it. Cheers!</p>\n\n<pre><code>def get_prices(c)\n  @print_prices = Billing.where(:name =&gt; c).first.attributes.select{ |i| i.match(/^print_/) }\nend\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","authentication","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13149384,"title":"Ruby on Rails: Devise Authentication with JavaScript","body":"<p>In my RoR project, the user could drag and drop a JavaScript link to the browser's bookmark manager/bar.</p>\n\n<p>The JavaScript link calls another JavaScript file, say <code>LoadUserData.js</code>.</p>\n\n<p>I'm using Devise for authentication.</p>\n\n<p>My question is: when the user click the bookmark:</p>\n\n<ol>\n<li>If the user has logged in, the user data will be loaded;</li>\n<li>Otherwise, the bookmark will redirect the user to the login page.</li>\n</ol>\n\n<p>How to implement it?</p>\n\n<p>Peter</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13149257,"title":"Ruby on Rails: polymorphic association with has_one/belongs_to","body":"<p>In my app I setup the M-N relation between the Item and Property models by using a join model PropertyValuations. Now, in the relation between an item and a property there will exist a value. However, I want that value to be stored a different table (NumericValue, TextualValue, etc).\nIs a polymorphic association a good approach for this?</p>\n\n<p>The idea would be to have something like this:</p>\n\n<pre><code>class PropertyValuation &lt; ActiveRecord::Base\n  attr_accessible :valuable\n  attr_accessor :valuable\n\n  belongs_to :property\n  belongs_to :item\n  belongs_to :valuable, :polymorphic =&gt; true  \nend\n\nclass NumericValue &lt; ActiveRecord::Base\n  attr_accessible :value # plus several other fields\n  has_one :property_valuation, :as =&gt; :valuable  \nend\n\nclass TextualValue &lt; ActiveRecord::Base\n  attr_accessible :value  \n  has_one :property_valuation, :as =&gt; :valuable\nend\n</code></pre>\n\n<p>However, this way I can only associate a value to a property_valuation record if I create the value first (where I was expecting to do something like <code>property_valuation.valuable = NumericValue.new(:value =&gt; 12345)</code>), and to obtain the value I can't use <code>property_valuation.valuable</code>, as it will return nil (even if valuable_id and valuable_type on property_valuation table are filled).\nWhat can I improve in my code to make everything work as expected? My migrations look like this:</p>\n\n<pre><code>class CreatePropertyValuations &lt; ActiveRecord::Migration\n  def change\n    create_table :property_valuations do |t|\n      t.references :item\n      t.references :property\n      t.references :valuable, :polymorphic =&gt; true\n\n      t.timestamps\n    end\n    add_index :property_valuations, :item_id\n    add_index :property_valuations, :property_id\n    add_index :property_valuations, :valuable_id\n  end\nend\n\nclass CreateNumericValues &lt; ActiveRecord::Migration\n  def change\n    create_table :numeric_values do |t|\n      t.decimal :value\n      t.references :property_valuation\n\n      t.timestamps\n    end\n  end\nend\n\n\nclass CreateTextualValues &lt; ActiveRecord::Migration\n  def change\n    create_table :textual_values do |t|\n      t.text :value\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["mysql","ruby-on-rails-3","activerecord","imagemagick","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13148448,"title":"rake failure due to imagemagick","body":"<p>I'm seeding a development database (mysql) using <code>rake db:seed</code> in Rails 3. The rake task fails, stating, </p>\n\n<blockquote>\n  <p>Validation failed: Logo /var/folders/.../logo.png is not recognized by the 'identify' command.</p>\n</blockquote>\n\n<p>When I run <code>which identify</code>, I get the expected path <code>/usr/local/bin/identify</code>. ImageMagick is indeed installed (via Homebrew), and <em>appears</em> to work with png images just fine from the command line.</p>\n\n<p>I even rebuilt the app on another machine, thinking that my environment is borked,  and I got the same error.</p>\n\n<p>Is there a poltergeist in my terminal sessions?</p>\n"},{"tags":["ruby-on-rails-3","count","limit","has-many-through","custom-validators"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":13094227,"title":"Rails validation count limit on has_many :through","body":"<p>I've got the following models: Team, Member, Assignment, Role</p>\n\n<p>The Team model has_many Members. Each Member has_many roles through assignments. Role assignments are Captain and Runner. I have also installed devise and CanCan using the Member model.</p>\n\n<p>What I need to do is limit each Team to have a max of 1 captain and 5 runners.</p>\n\n<p>I found this <a href=\"http://stackoverflow.com/questions/9932445/rails-accepts-nested-attributes-count-validation\">example</a>, and it seemed to work after some customization, but on update ('teams/1/members/4/edit'). It doesn't work on create ('teams/1/members/new'). But my other validation (validates :role_ids, :presence => true\n) does work on both update and create. Any help would be appreciated.</p>\n\n<p><strong>Update:</strong> I've found this <a href=\"http://stackoverflow.com/questions/1270663/validate-max-amount-af-associated-objects\">example</a> that would seem to be similar to my problem but I can't seem to make it work for my app.</p>\n\n<p>It seems that the root of the problem lies with how the count (or size) is performed before and during validation. </p>\n\n<p>For Example:</p>\n\n<p>When updating a record... \nIt checks to see how many runners there are on a team and returns a count. (i.e. 5) Then when I select a role(s) to add to the member it takes the known count from the database (i.e. 5) and adds the proposed changes (i.e. 1), and then runs the validation check. (Team.find(self.team_id).members.runner.count > 5) This works fine because it returns a value of 6 and 6 > 5 so the proposed update fails without saving and an error is given.</p>\n\n<p><strong>But</strong> when I try to create a new member on the team...\nIt checks to see how many runners there are on a team and returns a count. (i.e. 5) Then when I select a role(s) to add to the member it takes the known count from the database (i.e. 5) and then runs the validation check <strong>WITHOUT</strong> factoring in the proposed changes. This doesn't work because it returns a value of 5 known runner and 5 = 5 so the proposed update passes and the new member and role is saved to the database with no error.</p>\n\n<p>Member Model:</p>\n\n<pre><code>class Member &lt; ActiveRecord::Base\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  attr_accessible :password, :password_confirmation, :remember_me\n  attr_accessible :age, :email, :first_name, :last_name, :sex, :shirt_size, :team_id, :assignments_attributes, :role_ids\n  belongs_to :team\n  has_many :assignments, :dependent =&gt; :destroy\n  has_many :roles, through: :assignments\n    accepts_nested_attributes_for :assignments\n\n  scope :runner, joins(:roles).where('roles.title = ?', \"Runner\")\n  scope :captain, joins(:roles).where('roles.title = ?', \"Captain\")\n\n  validate :validate_runner_count\n  validate :validate_captain_count\n  validates :role_ids, :presence =&gt; true\n\n  def validate_runner_count\n     if Team.find(self.team_id).members.runner.count &gt; 5\n       errors.add(:role_id, 'Error - Max runner limit reached')\n     end\n  end\n\n  def validate_captain_count\n     if Team.find(self.team_id).members.captain.count &gt; 1\n       errors.add(:role_id, 'Error - Max captain limit reached')\n     end\n  end\n\n  def has_role?(role_sym)\n    roles.any? { |r| r.title.underscore.to_sym == role_sym }\n  end\n\nend\n</code></pre>\n\n<p>Member Controller:</p>\n\n<pre><code>class MembersController &lt; ApplicationController\n  load_and_authorize_resource :team\n  load_and_authorize_resource :member, :through =&gt; :team\n\n  before_filter :get_team\n  before_filter :initialize_check_boxes, :only =&gt; [:create, :update]\n\n  def get_team\n    @team = Team.find(params[:team_id])\n  end\n\n  def index\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @members }\n    end\n  end\n\n  def show\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @member }\n    end\n  end\n\n  def new\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @member }\n    end\n  end\n\n  def edit\n\n  end\n\n  def create\n    respond_to do |format|\n      if @member.save\n        format.html { redirect_to [@team, @member], notice: 'Member was successfully created.' }\n        format.json { render json: [@team, @member], status: :created, location: [@team, @member] }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @member.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def update\n    respond_to do |format|\n      if @member.update_attributes(params[:member])\n        format.html { redirect_to [@team, @member], notice: 'Member was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @member.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def destroy\n    @member.destroy\n\n    respond_to do |format|\n      format.html { redirect_to team_members_url }\n      format.json { head :no_content }\n    end\n  end\n\n  # Allow empty checkboxes\n  # http://railscasts.com/episodes/17-habtm-checkboxes\n  def initialize_check_boxes \n    params[:member][:role_ids] ||= [] \n  end\n\nend\n</code></pre>\n\n<p>_Form Partial</p>\n\n<pre><code>&lt;%= form_for [@team, @member], :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n\n  #...\n\n  # testing the count...\n    &lt;ul&gt;\n    &lt;li&gt;Captain - &lt;%= Team.find(@member.team_id).members.captain.size %&gt;&lt;/li&gt;\n    &lt;li&gt;Runner - &lt;%= Team.find(@member.team_id).members.runner.size %&gt;&lt;/li&gt;\n    &lt;li&gt;Driver - &lt;%= Team.find(@member.team_id).members.driver.size %&gt;&lt;/li&gt;\n    &lt;/ul&gt;\n\n    &lt;div class=\"control-group\"&gt;\n      &lt;div class=\"controls\"&gt;\n      &lt;%= f.fields_for :roles do %&gt;\n      &lt;%= hidden_field_tag \"member[role_ids][]\", nil %&gt;\n        &lt;% Role.all.each do |role| %&gt;\n          &lt;%= check_box_tag \"member[role_ids][]\", role.id, @member.role_ids.include?(role.id), id: dom_id(role) %&gt;\n          &lt;%= label_tag dom_id(role), role.title %&gt;\n        &lt;% end %&gt;\n      &lt;% end %&gt;\n     &lt;/div&gt; \n    &lt;/div&gt;\n\n  #...\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","actionscript-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13125566,"title":"How to read a jpg bytearray from a Flash AS3 file","body":"<p>I'm trying to save an image from a Flash AS3 to my server as a jpg file. I found some PHP code to do this, but I want to do this in Ruby. I'm not quite sure how to convert the following code to Ruby. It's mainly the <code>$GLOBALS[\"HTTP_RAW_POST_DATA\"]</code> part I don't know how to convert.</p>\n\n<pre><code>&lt;?php\n\n   if ( isset ( $GLOBALS[\"HTTP_RAW_POST_DATA\"] )) {\n\n      // get bytearray $im = $GLOBALS[\"HTTP_RAW_POST_DATA\"];\n\n      // save image $f = fopen($_GET['name'], 'wb'); fwrite($f, $jpg); fclose($f);\n\n   } else echo 'An error occured.';\n\n?&gt;\n</code></pre>\n\n<p>source:</p>\n\n<p><a href=\"http://designreviver.com/tutorials/actionscript-3-jpeg-encoder-revealed-saving-images-from-flash/\" rel=\"nofollow\">http://designreviver.com/tutorials/actionscript-3-jpeg-encoder-revealed-saving-images-from-flash/</a></p>\n\n<p>I tried to do the following, but the resulted image file dose not open</p>\n\n<pre><code>temp_file = Tempfile.new(['temp', '.jpg'], :encoding =&gt; 'ascii-8bit')\ntemp_file.write(request.raw_post)\ntemp_file.close\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>The image data is in <code>request.raw_post</code></p>\n\n<p><strong>EDIT2</strong></p>\n\n<p>As for the image being sent, here is how the header is created in AS3</p>\n\n<pre><code>var header:URLRequestHeader = new URLRequestHeader(\"Content-type\", \"application/octet-stream\");\nvar saveJPG:URLRequest = new URLRequest(\"http://127.0.0.1:3000/save_image.xml\");\nsaveJPG.requestHeaders.push(header);\n</code></pre>\n\n<p>saveJPG.method = URLRequestMethod.POST;</p>\n"},{"tags":["ruby-on-rails-3","json"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13148695,"title":"Rails 3: Importing records and their has_many associations from one app to another using json","body":"<p>Let's assume I've got two Rails apps with databases having the exact same schema and models. I want to be able to import some records from one database to the other. For example, what if I've got an Students table, and would like to retrieve one student from one db to the other?</p>\n\n<p>I've been sending the student json representation (<code>self</code> is a student):</p>\n\n<pre><code>student_json = self.as_json(:include =&gt; [\n                                 { :final_grade_batches =&gt; { :include =&gt; { :final_grade =&gt; { :include =&gt; :gradeable } } } }\n                            ])\n</code></pre>\n\n<p>from app 2 to app 1. This works when I don't include associations defined with has_many, but when I do, as in the example above, I receive the following message instantiating the student (<code>Student.new(params[:student])</code>) where params[:student] is the json retrieved from the other app:</p>\n\n<pre><code>ActiveRecord::AssociationTypeMismatch: FinalGradeBatch(#2159093540) expected, got Hash(#2151972720)\n</code></pre>\n\n<p>Of course, I've got <code>has_many :final_grade_batches</code> in the Student Model.</p>\n\n<p>Any help? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":449,"score":2,"question_id":10970973,"title":"mongoid, how to merge result with map/reduce","body":"<p>I try to use out reduce but I do not know how to call output .\nExample: </p>\n\n<pre><code>@results = Article.collection.map_reduce(map, reduce, :out =&gt; 'test')\n\n@results.find()\n =&gt; &lt;Mongo::Cursor:0x2c276c4 namespace='myapp_development.test' @selector={} @cursor_id=&gt; \n</code></pre>\n\n<p>When I try : </p>\n\n<pre><code>@results1 = Article.collection.map_reduce(map, reduce, :out =&gt;{reduce: 'test'}\n</code></pre>\n\n<p>Expected result is duplicate @results. But I run @results1.find().to_a I see it equal with @results</p>\n\n<p>And how can I call result by namespace in rubyrails using mongoid ??</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":3006,"score":0,"question_id":7340448,"title":"Devise & omniauth Facebook authentication in Rails 3.1","body":"<p>I've followed <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">this guide</a> for getting Devise Facebook authentication to work and I've now come to a point where I can't understand and I would like some help.</p>\n\n<p>I get the Sign in with Facebook link but clicking on it I get the following error, telling me there's something wrong with the routes</p>\n\n<blockquote>\n  <p>Unknown action</p>\n  \n  <p>Could not find devise mapping for path \"/users/auth/facebook\". Maybe you forgot to wrap your route inside the scope block? For example: devise_scope :user do match \"/some/route\" => \"some_devise_controller\" end</p>\n</blockquote>\n\n<p>Here is my routes file</p>\n\n<pre><code>  devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" }\n  get '/users/auth/:provider' =&gt; 'users/omniauth_callbacks#passthru'\n  root :to =&gt; 'home#index'\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Solved that issue by changing the routes to</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" } do\n  get '/users/auth/:provider' =&gt; 'users/omniauth_callbacks#passthru'\nend\nroot :to =&gt; 'home#index'\n</code></pre>\n\n<p>Now I got the next error getting the Facebook auth to work but when coming back from the \"Allow app screen\" ruby throws...</p>\n\n<blockquote>\n  <p>undefined method `closed?' for nil:NilClass</p>\n  \n  <p>activesupport (3.1.0.rc8) lib/active_support/whiny_nil.rb:48:in <code>method_missing'\n  /opt/local/lib/ruby/1.8/net/http.rb:1060:in</code>request'\n  faraday (0.6.1) lib/faraday/adapter/net_http.rb:51:in <code>call'\n  faraday (0.6.1) lib/faraday/request/url_encoded.rb:14:in</code>call'\n  faraday (0.6.1) lib/faraday/request.rb:88:in <code>run'\n  faraday (0.6.1) lib/faraday/request.rb:28:in</code>run'\n  faraday (0.6.1) lib/faraday/connection.rb:170:in <code>run_request'\n  oauth2 (0.4.1) lib/oauth2/client.rb:63:in</code>request'</p>\n  \n  <p>...</p>\n</blockquote>\n\n<p>This is using Rails 3.1.0rc8 and ruby 1.9.2</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13147862,"title":"undefined method for nil class in rails 3","body":"<p>I keep getting the above error message when trying to view data from my model in my view (the index page of my controller)</p>\n\n<p>my controller</p>\n\n<pre><code> def index\n\n @recipe = Recipe.all\n\n end\n</code></pre>\n\n<p>my view</p>\n\n<pre><code>   &lt;% @recipes.each do |r| %&gt;\n   &lt;tr&gt;&lt;td&gt;&lt;%= r.dish_name %&gt;&lt;/td&gt;&lt;/tr&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Im new to rails so maybe doing this completely wrong. Could someone also explain what the error means?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails-3","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13147909,"title":"Mongoid Observer for a specific field?","body":"<p>In the model, I know you can assign callbacks to specific fields (i.e. <code>value1</code>), like this:</p>\n\n<pre><code>after_save :run_callback_1, :if =&gt; :value1_changed?\n</code></pre>\n\n<p>Can this happen in the Observer so it's called if <code>user.value1</code> is changed? Or if <code>value1</code> of multiple models have changed?</p>\n\n<pre><code>class UserObserver &lt; Mongoid::Observer\n\n  def after_save(record)\n    logger.debug \"HERE\"\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13147708,"title":"ActiveRecord transaction does not rollback","body":"<p>I'm new to ActiveRecord transactions. In the code below the first update_attributes causes a WARNING: Can't mass-assign protected attributes: account_type_cdx and that is ok. But I was surprised that the next line self.update_attributes!(:purchased => true) is executed and stored in the DB. I was expecting it to ROLLBACK because the first one failed.</p>\n\n<p>I must be missing something...\nAny hints?</p>\n\n<pre><code>def complete_purchase(current_user_id, plan_name)\n    Rails.logger.debug \"COMPLETE PURCHASE\"\n    user = User.find(current_user_id)\n    ActiveRecord::Base.transaction do\n        user.update_attributes!(:account_type_cdx =&gt; plan_name.to_sym)\n        self.update_attributes!(:purchased =&gt; true)\n    end\nend\n</code></pre>\n\n<p>I followed the advices from this post: <a href=\"http://markdaggett.com/blog/2011/12/01/transactions-in-rails/\" rel=\"nofollow\">http://markdaggett.com/blog/2011/12/01/transactions-in-rails/</a></p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","user-interface"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13147846,"title":"Rails sign up, edit more thorough than new","body":"<p>I'd like to make it easy for users to sign up for my rails app (only 2 fields, username and password), but when they edit their information, I'd like to give them the opportunity to store much more data.  I don't want to ask them everything up front as I don't want to dissuade account creation.</p>\n\n<p>What's the rails way of doing this correctly (and best UI way)?  Should I... </p>\n\n<ul>\n<li>Initialize all except username + password with null values, or default values, and display those as incentive to replace with accurate information?  (Seems wrong.)</li>\n<li>Have a nested model, \"Profile,\" belonging to \"User\" that I ask them to fill out after signing up?  What do I display for the Profile for the User before they do that?  (This seems to bring me back to the \"seems wrong\" of (1) above.</li>\n<li>Some sort of wizard thing and force them to answer all my questions before displaying anything?</li>\n<li>Create a basically empty profile that displays nothing, but has in-line editing when they do update the null information?  (Is the data actually null before that, or something else?)  If so, does the form get embedded in the User#show controller then?  How?</li>\n</ul>\n\n<p>Also, if I want my form to be sleek and AJAXy, is that a consideration that changes anything?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mobile","view-helpers"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13147837,"title":"Conditional inclusion of rails view helper file?","body":"<p>I'm developing a mobile version of my site and want to separate out the mobile view helpers from my non-mobile view helpers.</p>\n\n<p>I know I could simply namespace them and include the helper file, or prefix every method with mobile_, but that's simply silly.  What I want to do is something like this:</p>\n\n<pre><code>helper :desktop, unless: is_mobile_device?\nhelper :mobile, if: is_mobile_device?\n</code></pre>\n\n<p>but can't seem to find a way to do this.  This way I can have a <code>def title</code> method in both but they are handled differently depending on mobile or not, for example.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":14,"score":1,"question_id":13147657,"title":"Rails joker has_one username, dancer has_one username","body":"<p>In my rails app, I have a username model that is polymorphically attached to 2 models joker and dancer.</p>\n\n<p>When creating a Joker, form sends a string that is the username for Joker. How should I go about setting this up so that rails does not throw an error when receiving a string instead of an AR object, for username?</p>\n\n<p>Here is the code I have now.</p>\n\n<pre><code>class Joker &lt; ActiveRecord::Base\n  attr_accessible :username\n\n  has_one :username\nend\n</code></pre>\n\n<p>and in create of Jokers_controller</p>\n\n<pre><code>@joker = Joker.new(params[:joker])\n</code></pre>\n\n<p>Rails throws this error:</p>\n\n<pre><code>Username(#19110) expected, got String(#9130)\n</code></pre>\n\n<p>So this is the form field</p>\n\n<pre><code>= form_for @joker do |f|\n  - if @joker.errors.any?\n    #error_explanation\n      h2 = \"#{pluralize(@joker.errors.count, \"error\")} prohibited this joker from being saved:\"\n      ul\n        - @joker.errors.full_messages.each do |message|\n          li = message\n\n\n  = f.text_field :username\n</code></pre>\n"},{"tags":["ruby-on-rails-3","validation","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":16,"score":2,"question_id":13147459,"title":"Rails 3: create_association fails validation and deletes previous associated record","body":"<p>Let's assume I have two models.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_one :blog\nend\n\nclass Blog &lt; ActiveRecord::Base\n  belongs_to :user\n\n  validates_presence_of :user\n  validates_uniqueness_of :user_id\nend\n</code></pre>\n\n<p>Let's assume I have one user with a blog. For some reason, let's pretend I call <code>create_blog</code> for the same user (I know it should not be an option since the user already has a blog). If this blog doesn't pass the validations, and it won't, not only isn't saved, but it deletes the previous blog the user has.</p>\n\n<p>Why is this happening? Why the initial blog gets deleted? Is this behavior expected or is there something I missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13144624,"title":"Use Rails’ form_for but set custom classes, attributes on <form> element?","body":"<p><code>form_for</code> seems to ignore any 'extra' attributes like a <code>data-foo</code> attribute or <code>class</code> passed as <code>options</code> in its second argument.</p>\n\n<pre><code>= form_for @user, {:url =&gt; 'foo', :class =&gt; 'x', 'data-bar' =&gt; 'baz' } do |f|\n  # ...\n</code></pre>\n\n<p>The output is a <code>&lt;form&gt;</code> tag with no <code>x</code> class or <code>data-bar</code> attribute.</p>\n\n<p>What’s the fix?</p>\n\n<p>Or, how can I grab a <code>FormBuilder</code> instance without using <code>form_for</code>?</p>\n"},{"tags":["jquery","html","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":33,"score":1,"question_id":13146318,"title":"How to avoid keeping html elements when saving text from a content editable div","body":"<p>I have a content editable div where users can enter their bio and then save the information. I use a form submit and the data I submit is <code>$('#bio').html()</code> where the bio tag has the attribute content editable. All of this works very well unless the user hits enter and then it creates a div tag and/or a <code>&lt;br&gt;</code>, which are saved as the user's bio and then displayed with the html elements intact, which looks sloppy. </p>\n\n<p>I am looking for either for some way of saving only the text or a way of display only the text. Ideally, I would like to be able to keep the new line without displaying the <code>&lt;div&gt;</code> or <code>&lt;br&gt;</code>. </p>\n\n<p>If this is at all useful, I am using Ruby-on-Rails 3.</p>\n\n<p>Thanks, Welles</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","actionview"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13147000,"title":"Get actual object Rails","body":"<p>I have two forms in my new view, one is for the product and the other is for fotos. \nWhen I upload the fotos with a select.file field, these are created by Ajax call by a file create.js.erb then when I fill the others fields to the product I've another button to create it. So I have two forms and one way to create each one.</p>\n\n<p>The problem is the ID, the solution that I've found was to create an object before the user enter to the new view, so I have this code:</p>\n\n<p>Product's controller:</p>\n\n<pre><code>def new\n      @product = current_user.products.create\nend\n</code></pre>\n\n<p>It creates an object nil, now I can create my Foto to that object, like this:</p>\n\n<p>Painting's controller:</p>\n\n<pre><code>def create\n   @product = Product.last\n   @painting = @product.paintings.create(params[:painting])\nend\n</code></pre>\n\n<p>The problem is the line \"@product = Product.last\", I know that it isn't the right solution, because when I try the edit action, and when I try to create new objects it goes to the last product and not to the actual edit product.</p>\n\n<p>How can I find that current product at my new action???</p>\n\n<p>Thanks a lot.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13120837,"title":"Order by two things in two different styles","body":"<p>Theoretically what I want is this:<br>\n<code>:order =&gt; \"column1 ASC, column2 DESC\"</code></p>\n\n<p>But column1 is actually not a column in my case but an aggregated value:<br>\n<code>:order =&gt; relations.count</code></p>\n\n<p>How can I order by two columns when one of those is actually an aggregated value?</p>\n\n<p>Btw: Counter-Cache is not an option (because it is outdated when I need it)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13147403,"title":"Accessing HTML tags in a RUBY Controller","body":"<p>I have the following code in my HTML.erb</p>\n\n<pre><code>&lt;form&gt;\n   &lt;input id=\"do\" type=\"hidden\" value=\"0\" /&gt;\n   &lt;button type=\"submit\" value=\"Next\"&gt;SUBTRACT&lt;/button&gt;\n&lt;/form&gt;\n&lt;form&gt;\n  &lt;input id=\"do\" type=\"hidden\" value=\"1\" /&gt;\n  &lt;button type=\"submit\" value=\"Next\" &gt;ADD&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Now When I click the any of the 2 buttons, I want to check the value of the input id=\"do\" inside my Ruby Controller. What would the syntax look like ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":21,"score":4,"question_id":13147277,"title":"Rails: path of file","body":"<p>I have inside <code>app</code> a directory called <code>csv</code> and inside this dir I have a file called <code>names.csv</code>\nI want to use <code>File.read(path:string)</code> function to read the file.<br>\nwhat is the relative path to the file?  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13135647,"title":"How to specify a controller and action in form to create new resources","body":"<p>I have QuestionsController and TrueFalseQuestionsController. I built a form to create question true/false, this is my form:</p>\n\n<pre><code>&lt;%= simple_form_for @question, defaults: { error: false } do |question_form| %&gt;\n  &lt;fieldset&gt;\n    &lt;legend&gt;Question&lt;/legend&gt;\n    &lt;%= render 'shared/error_messages', object: question_form.object %&gt;\n    &lt;%= question_form.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n    &lt;%= question_form.input :mark, input_html: { class: 'span1' } %&gt;\n    &lt;%= question_form.association :topic %&gt;\n\n    &lt;%= question_form.simple_fields_for :answers do |answer_form| %&gt;    \n      &lt;%= answer_form.input :correct,\n            collection: [[true, 'True'], [false, 'False']],\n            as: :radio_buttons,\n            label: 'Answer',\n            value_method: :first,\n            label_method: :last,\n            item_wrapper_class: 'inline' %&gt;\n    &lt;% end %&gt;\n  &lt;/fieldset&gt;\n\n    &lt;%= question_form.button :submit, class: 'new_resource' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Now when I submit the form, it uses create action in QuestionsController, so how can I specify form to use create action in TrueFalseQuestionsController?</p>\n"},{"tags":["ajax","ruby-on-rails-3","redirect"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13147070,"title":"Rails 3: redirect_to with :remote => true","body":"<p>I have a delete link that makes a remote call:</p>\n\n<pre><code>&lt;%= link_to image_tag(\"trash.png\"), [current_user, bookcase], method:  :delete, :remote =&gt; true, confirm: \"You sure?\", title:   bookcase.image %&gt;\n</code></pre>\n\n<p>In my controller, I end the delete function with a redirect:</p>\n\n<pre><code>def destroy\n  @bookcase.destroy\n  redirect_to current_user\nend\n</code></pre>\n\n<p>This works, except it's redirecting the user to the 'user/show.html.erb' file instead of the 'user/show.js.erb' file. How can I redirect the user, specifying which format to use?</p>\n"},{"tags":["ruby-on-rails-3","mutual-exclusion"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":13056737,"title":"Mutex in rails API among several client request","body":"<p>I face a problem with mutual exclusion in my rails API.\nI have some Event object in my database which contain the number of person who will attend the event.</p>\n\n<p>Consider my Event method which add a person to the event :</p>\n\n<pre><code>class Event\n    def add_person\n        nb = self.number_of_person + 1\n        # Some stuff\n        self.number_of_person = nb\n        self.save\n    end\nend\n</code></pre>\n\n<p>Now, imagine that client A and B want to participate in the event E.\nRails is gonna receive 2 request and will call the add_person method in parallel.\nAt the end, it is possible that the number of person in the Event E be not incremented by 2 but by 1.</p>\n\n<p>This is what I want to be able to do :</p>\n\n<pre><code>Client A                 | Client B                 | Possible in parallel\n--------------------------------------------------------------------------\nEvent.find(1).show       | Event.find(1).show       | yes\nEvent.find(1).add_person | Event.find(1).add_person | no\nEvent.find(1).add_person | Event.find(2).add_person | yes\n</code></pre>\n\n<p>I only want to queue the <code>add_person</code> method on the same object.</p>\n\n<p>Is there a way to do this ?</p>\n"},{"tags":["ruby-on-rails-3","sendfile"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":2807,"score":0,"question_id":6019522,"title":"Rails 3 - how to send_file in response of a remote form in rails?","body":"<p>I have this coupon form</p>\n\n<pre><code>    &lt;%form_for(:download,:download,:url=&gt;{:controller=&gt;\"coupons\",:action=&gt;\"verifycoupon\"},:remote=&gt;true) do |f| %&gt;\n    &lt;%=text_field :download,:code%&gt;\n    &lt;%=f.submit \"verify\"%&gt;\n    &lt;%end%&gt;\n</code></pre>\n\n<p>and after validating the code on the controller's action i have a confirmation like:</p>\n\n<pre><code>render :update do |page|\n    page.alert \"OK\"\nend\n</code></pre>\n\n<p>Now I want to send a file to the browser with the <code>send_file</code> instruction but nothing seems to happen</p>\n\n<pre><code>send_file(\"/path/to/my/file.extension\")\n</code></pre>\n\n<p>and in the log I can see</p>\n\n<pre><code>\"Sent file /path/to/my/file.extension (0.1ms)\"\n</code></pre>\n\n<p>I was wondering if there's something like</p>\n\n<pre><code>render :update do |page|\n   page.send_file(\"/path/to/my/file.extension\")\nend\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>#### Update #######\n</code></pre>\n\n<p>my Controller's action looks something like</p>\n\n<pre><code>def verifycoupon\n   code = Code.find(params[:download][:code])\n   if code\n     if code.is_active?\n     render :update do |page|\n        page.alert \"ok\"\n     end\n       send_file(\"/path/to/my/file.extension\")\n     else\n       render :update do |page|\n          page.alert \"this code has already been used\"\n       end\n     end\n   else\n   render :update do |page|\n     page.alert \"Code does't exist\"\n   end\n   end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13140604,"title":"Association won't save inside of before_validation","body":"<p>I'm trying to use the before_validation callback to adjust the number of child objects for a record, but for some reason, its not working the way I expect. </p>\n\n<p>LineItem class:</p>\n\n<pre><code> before_validation :adjust_enrollment_count\n\n def adjust_enrollment_count\n    if enrollments.size &lt; quantity \n      (enrollments.size+1..quantity).each do |li|\n        self.enrollments.build(variant: self.variant)\n      end\n      #self.save\n    elsif enrollments.size &gt; quantity\n      enrollments.delete_if do |e| \n        enrollments.size &gt; quantity\n      end\n    end\n  end\n</code></pre>\n\n<p>What happens is that it creates the correct number of Enrollment objects as children to the LineItem, but the Variant gets set to nil (even though the LineItem has a variant defined).</p>\n\n<p>Things I've tried:</p>\n\n<ul>\n<li>Explicitly saving the line_item or the enrollment </li>\n<li>\"pry\"ing into the callback and running the code manually (this actually worked the way\nI expected!)     </li>\n<li>Verifying that \"self\" referred to the LineItem and not the closure</li>\n</ul>\n\n<p>Is there something about the callback lifecycle that I'm missing? Is there a better way to adjust the number of Enrollment objects as the quantity changes on the LineItem?</p>\n"},{"tags":["windows","ruby-on-rails-3","paperclip","crop"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":80,"score":1,"question_id":12559769,"title":"error facing while cropping photo using Paperclip in Rails 3","body":"<p>Hi i am trying to crop photo using paperclip and imagemagick. I am facing some error while cropping photo. following is the error stack:</p>\n\n<pre><code>?[32mCommand?[0m :: convert \"C:/Users/Anand/AppData/Local/Temp/120120924-3568-tx\n2bxy.jpg[0]\" -crop 103x103+0+0 -auto-orient \"C:/Users/Anand/AppData/Local/Temp/1\n20120924-3568-tx2bxy20120924-3568-16dij9c\"\n?[32mCommand?[0m :: file -b --mime \"C:/Users/Anand/AppData/Local/Temp/120120924-\n3568-tx2bxy20120924-3568-16dij9c\"\n[paperclip] Error while determining content type: Cocaine::CommandNotFoundError\n?[32mCommand?[0m :: identify -format %wx%h \"C:/Users/Anand/AppData/Local/Temp/12\n0120924-3568-tx2bxy.jpg[0]\"\n  ?[1m?[36m (0.0ms)?[0m  ?[1mrollback transaction?[0m\nCompleted 500 Internal Server Error in 145552ms\n\nNoMethodError (undefined method `exitstatus' for nil:NilClass):\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/models/user.rb:14:in `reprocess_photo'\n  app/controllers/users_controller.rb:67:in `block in update'\n  app/controllers/users_controller.rb:66:in `update'\n\n\n  Rendered E:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispa\ntch/middleware/templates/rescues/_trace.erb (10.0ms)\n  Rendered E:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispa\ntch/middleware/templates/rescues/_request_and_response.erb (1.0ms)\n  Rendered E:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispa\ntch/middleware/templates/rescues/diagnostics.erb within rescues/layout (51.0ms)\nExiting\n</code></pre>\n\n<p>model/user.rb file:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name,:photo,:crop_x,:crop_y,:crop_w,:crop_h\n  has_attached_file :photo,:styles =&gt; {:small=&gt;\"100x100#\",:large=&gt;\"500x500&gt;\"},:processors =&gt; [:cropper]\n  attr_accessor :crop_x,:crop_y,:crop_w,:crop_h\n  after_update :reprocess_photo,:if=&gt;:cropping?\n\n  def cropping?\n    !crop_x.blank? &amp;&amp; !crop_y.blank? &amp;&amp; !crop_w.blank? &amp;&amp; !crop_h.blank?\n  end\n\n  private \n\n  def reprocess_photo\n    photo.reprocess!\n  end\n\nend\n</code></pre>\n\n<p>my lib/paperclip_processros/cropper.rb</p>\n\n<pre><code>module Paperclip\n  class Cropper &lt; Thumbnail\n    def transformation_command\n      if crop_command   \n        #this generates command :\n        #this is right #convert \"C:/Users/Anand/AppData/Local/Temp/1.jpg[0]\" -crop 102x102+0+0 -auto-orient \"C:/Users/Anand/AppData/Local/Temp/120120924-2336-qbzroo20120924-2336-1jqbiiv.jpg\"\n        crop_command + super.first.sub(/ -crop \\S+/, '')\n      else\n        super\n      end\n    end\n\n    def crop_command\n      target = @attachment.instance\n      if target.cropping?\n        \" -crop #{target.crop_w}x#{target.crop_h}+#{target.crop_x}+#{target.crop_y} \"\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>my config/env./dev.rb</p>\n\n<pre><code> Paperclip.options[:swallow_stderr] = false\n Paperclip.options[:command_path] = \"C:/Program Files/ImageMagick-6.7.9-Q16/\"\n</code></pre>\n\n<p>when m updating a photo after crop, it goes in loop. What could be the solution?</p>\n"},{"tags":["html","ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13146035,"title":"Changing value of Ruby Variable in Html.erb","body":"<p>I have the following code in my controller: </p>\n\n<pre><code>class TestController &lt; ApplicationController\n\n@@a = 1\n\ndef index\n    @temp = connection.execute(\"select test_id from mastertest limit #{@@a}, 5;\")\nend\n</code></pre>\n\n<p>And I have the following code in my View(Html.erb) File:</p>\n\n<pre><code>&lt;button type=\"submit\" value=\"Next\" form=\"submit_form\"&gt;NEXT&lt;/button&gt;\n&lt;form id=\"submit_form\"&gt;\n&lt;% @@a = @@a + 1 %&gt;\n    &lt;table&gt;\n      &lt;% @temp.each do |row| %&gt;\n        &lt;tr&gt;&lt;td&gt;&lt;%= row[0] %&gt;&lt;/td&gt;&lt;/tr&gt;\n      &lt;% end %&gt;\n    &lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>So basically I am trying to change the value of the class variable @@a on clicking the Next button. But it does not change the value of @@aa. Can someone help me how to do that.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13146138,"title":"conception issue with a has_many association","body":"<p>There is something wrong with my associations.<br>\nI want that many VideoPost can refer to the same VideoInformation.\nI then thought that the foreign key should be in VideoPost so I started with the 2 models you can see below.\nBut I can't access to @video_post.video_information (which seems to make sense since there is no association in VideoPost)<br>\nHow should I do ? I'm a little confuse here</p>\n\n<p>Thanks for any help !</p>\n\n<p>My VideoPost model :  </p>\n\n<pre><code># Table name: video_posts\n#\n#  id                   :integer          not null, primary key\n#  user_id              :integer\n#  video_information_id :integer\n#  created_at           :datetime         not null\n#  updated_at           :datetime         not null\nclass VideoPost &lt; ActiveRecord::Base\n  belongs_to :user\n\n  attr_accessible :video_information_id\nend\n</code></pre>\n\n<p>My VideoInformation model :  </p>\n\n<pre><code># Table name: video_informations\n#\n#  id              :integer          not null, primary key\n#  title           :string(255)\n#  description     :text\n#  keywords        :text\n#  duration        :integer\n#  video_url       :string(255)\n#  thumbnail_small :string(255)\n#  thumbnail_large :string(255)\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\nclass VideoInformation &lt; ActiveRecord::Base\n  has_many :video_posts\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rexml"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":11,"score":2,"question_id":13145888,"title":"Getting the XML ID using REXML","body":"<p>I have an XML response as included below. How can I obtain the  element?</p>\n\n<p>In rails I have:</p>\n\n<pre><code>xml = REXML::Document.new(contacts_as_xml)\nRails.logger.info xml[1].attributes[\"id\"] \n</code></pre>\n\n<p>Which is not returning 'user@company.com'</p>\n\n<p>Thanks</p>\n\n<pre><code>&lt;?xml version='1.0' encoding='UTF-8'?&gt;\n&lt;feed xmlns=\"http://www.w3.org/2005/Atom\" xmlns:openSearch=\"http://a9.com/-/spec/opensearch/1.1/\" xmlns:gContact=\"http://schemas.google.com/contact/2008\" xmlns:batch=\"http://schemas.google.com/gdata/batch\" xmlns:gd=\"http://schemas.google.com/g/2005\" gd:etag=\"W/&amp;quot;Ck8BQ38yfyt7I2A9WhNSFk8.&amp;quot;\"&gt;\n    &lt;id&gt;user@company.com&lt;/id&gt;\n    &lt;updated&gt;2012-10-30T18:14:12.197Z&lt;/updated&gt;\n    &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n    &lt;title&gt;Users's Contacts&lt;/title&gt;\n    &lt;link rel=\"alternate\" type=\"text/html\" href=\"http://www.google.com/\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#feed\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#post\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full\" /&gt;\n    &lt;link rel=\"http://schemas.google.com/g/2005#batch\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/batch\" /&gt;\n    &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full?max-results=10000\" /&gt;\n    &lt;author&gt;\n        &lt;name&gt;User Howdy&lt;/name&gt;\n        &lt;email&gt;user@company.com&lt;/email&gt;\n    &lt;/author&gt;\n    &lt;generator version=\"1.0\" uri=\"http://www.google.com/m8/feeds\"&gt;Contacts&lt;/generator&gt;\n    &lt;openSearch:totalResults&gt;2&lt;/openSearch:totalResults&gt;\n    &lt;openSearch:startIndex&gt;1&lt;/openSearch:startIndex&gt;\n    &lt;openSearch:itemsPerPage&gt;10000&lt;/openSearch:itemsPerPage&gt;\n    &lt;entry gd:etag=\"&amp;quot;QXc5eDVSLit7I2A9WhdSFk8PTgU.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/970a99881a51f3&lt;/id&gt;\n        &lt;updated&gt;2011-07-25T20:31:50.920Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2011-07-25T20:31:50.920Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;Jon Paris&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/970a99881a51f3\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/970a99881a51f3\" /&gt;\n        &lt;gd:name&gt;\n            &lt;gd:fullName&gt;Jon Adams&lt;/gd:fullName&gt;\n            &lt;gd:givenName&gt;Jon&lt;/gd:givenName&gt;\n            &lt;gd:familyName&gt;Adams&lt;/gd:familyName&gt;\n        &lt;/gd:name&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"jon@adams.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"jon@adams.com\" /&gt;\n    &lt;/entry&gt;\n    &lt;entry gd:etag=\"&amp;quot;R3YzcTFbKit7I2A9WhJbE00ORQY.&amp;quot;\"&gt;\n        &lt;id&gt;http://www.google.com/m8/feeds/contacts/myuser%40mysite.com/base/1229b5e8eeef3e3&lt;/id&gt;\n        &lt;updated&gt;2012-09-22T08:57:06.889Z&lt;/updated&gt;\n        &lt;app:edited xmlns:app=\"http://www.w3.org/2007/app\"&gt;2012-09-22T08:57:06.889Z&lt;/app:edited&gt;\n        &lt;category scheme=\"http://schemas.google.com/g/2005#kind\" term=\"http://schemas.google.com/contact/2008#contact\" /&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;link rel=\"http://schemas.google.com/contacts/2008/rel#photo\" type=\"image/*\" href=\"https://www.google.com/m8/feeds/photos/media/myuser%40mysite.com/1229b5e8eeef3e3\" gd:etag=\"&amp;quot;UQZOJlcjWit7I2BmGBdVTzBfL2E2GGI5Myk.&amp;quot;\" /&gt;\n        &lt;link rel=\"self\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;link rel=\"edit\" type=\"application/atom+xml\" href=\"https://www.google.com/m8/feeds/contacts/myuser%40mysite.com/full/1229b5e8eeef3e3\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#other\" address=\"person@site.com\" primary=\"true\" /&gt;\n        &lt;gd:email rel=\"http://schemas.google.com/g/2005#home\" address=\"person@gmail.com\" /&gt;\n    &lt;/entry&gt;\n&lt;/feed&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13145840,"title":"Ruby on Rails default option value","body":"<p>I am using an array to store my values for a f.select dropdown in my form</p>\n\n<pre><code>   &lt;%= f.label :country_of_origin %&gt;\n   &lt;%= f.select :country_of_origin, [['Wales'],['Scotland'],['England']] %&gt;\n</code></pre>\n\n<p>Rather than the default value being Wales I would like it to say \"Please Select\" (obviously don’t want to be able to post the value \"please select). Can anyone point me in the right direction please?</p>\n"},{"tags":["ruby","ruby-on-rails-3","osx","installation","homebrew"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13143957,"title":"When trying to install pg gem: Brew bad interpreter error and not existing ruby version","body":"<p>I've really made something wrong when re-installing ruby, rails, xcode etc. (maybe even I've deleted my system Ruby installation :/ ) Here's what I have now:</p>\n\n<p>System: OSX 10.8.2 (64-bit)</p>\n\n<p><code>which ruby</code> gives me <code>/usr/local/bin/ruby</code></p>\n\n<p>I have installed <code>ruby 1.9.3p286</code>, <code>Rails 3.2.8</code> and <code>rvm 1.16.17 (stable)</code></p>\n\n<p>I've installed Ruby and Rails by going with this tips: <em>http://hivelogic.com/articles/compiling-ruby-rubygems-and-rails-on-snow-leopard</em> </p>\n\n<p>Next I wanted to run <code>gem install pg</code> but I've got an error: <code>No such file or directory - brew --prefix</code></p>\n\n<p>I've tried hit just the <code>brew</code> command but I've got another error: <code>/usr/local/bin/brew: bad interpreter: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin: no such file or directory</code></p>\n\n<p>So there is my question (I have installed brew earlier) - why it points on this path of 1.8 Ruby if I don't have this version of Ruby installed? Can I somehow change this path to my current one with ruby(that from which ruby command?)? How fix this brew error? Please help!</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-masonry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":317,"score":0,"question_id":10345508,"title":"Jquery masonry having trouble getting multiple columns","body":"<p>I'm using the Jquery masonry plugin to structure a page so that it has 2 columns.</p>\n\n<p>I am not sure that the plugin is working...it only shows 1 column, and if I alter the column width in the Jquery code, nothing happens.</p>\n\n<p>Code is below - grateful for any advice!</p>\n\n<p>Thanks,</p>\n\n<p>Faisal</p>\n\n<pre><code>script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.js\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery.masonry.min.js\"&gt;&lt;/script&gt;\n\n&lt;style&gt;\n.item {\n width: 480px;\n .....\n }\n\n&lt;/style&gt;\n&lt;div id=\"container\"&gt;\n &lt;div class=\"item\"&gt;\n ......\n &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;script&gt;\n$(function(){\n    var $container = $('#container');\n    $container.imagesLoaded(function(){\n      $container.masonry({\n        itemSelector : '.tile',\n        columnWidth : 100\n      });\n    });\n\n$container.infinitescroll({\n      navSelector  : '.flickr_pagination',    // selector for the paged navigation \n      nextSelector : 'a.next_page',  // selector for the NEXT link (to page 2)\n      itemSelector : '.tile',     // selector for all items you'll retrieve\n      loading: {\n          finishedMsg: 'No more pages to load.',\n          img: 'http://i.imgur.com/6RMhx.gif'\n        }\n      },\n      // trigger Masonry as a callback\n      function( newElements ) {\n        // hide new items while they are loading\n        var $newElems = $( newElements ).css({ opacity: 0 });\n        // ensure that images load before adding to masonry layout\n        $newElems.imagesLoaded(function(){\n          // show elems now they're ready\n          $newElems.animate({ opacity: 1 });\n          $container.masonry( 'appended', $newElems, true ); \n        });\n      }\n    );\n});\n&lt;/script&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","yield","content-for"],"answer_count":5,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1104,"score":4,"question_id":5631302,"title":"Multiple content_for on the same page","body":"<p>I have large block of HTML in my application that I would like to move into a shared template and then use content_for with yields to insert the necessary content. However, if I use it more than once in the same layout file the content_for just appends to the previous making that idea not work so well. Is there a solution to this?</p>\n\n<pre><code>&lt;div class=\"block side\"&gt;\n    &lt;div class=\"block_head\"&gt;\n        &lt;div class=\"bheadl\"&gt;&lt;/div&gt;\n        &lt;div class=\"bheadr\"&gt;&lt;/div&gt;\n        &lt;h2&gt;&lt;%= yield :block_head %&gt;&lt;/h2&gt;\n    &lt;/div&gt;\n    &lt;div class=\"block_content\"&gt;\n        &lt;%= yield :block_content %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"bendl\"&gt;&lt;/div&gt;\n    &lt;div class=\"bendr\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>and I use the following code to set the content for the block</p>\n\n<pre><code>    &lt;%= overwrite_content_for :block_head do -%&gt;\n        My Block\n    &lt;% end -%&gt;\n    &lt;%= overwrite_content_for :block_content do -%&gt;\n        &lt;p&gt;My Block Content&lt;/p&gt;\n    &lt;% end -%&gt;\n    &lt;%= render :file =&gt; \"shared/_blockside\" %&gt;\n</code></pre>\n\n<p>The problem is if I use this multiple times on the same layout the content from the original block is appended to the secondary block</p>\n\n<p>I have tried creating a custom helper method to get around it, however it does not return any content</p>\n\n<pre><code>  def overwrite_content_for(name, content = nil, &amp;block)\n    @_content_for[name] = \"\"\n    content_for(name, content &amp;block)\n  end\n</code></pre>\n\n<p>I may also be going about this completely wrong and if there are any better methods for getting content to work like this I would like to know. Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capybara","will-paginate","railstutorial.org"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":610,"score":0,"question_id":10762896,"title":"Testing views with will_paginate Gem using Capybara/Rspec","body":"<p>Doing Michael Hartl's Rails Tutorial, on <a href=\"http://ruby.railstutorial.org/chapters/user-microposts#sec%3amicropost_exercises\" rel=\"nofollow\">chapter 10, section 5, exercise 2</a>. I am - very simply - trying to write tests to ensure that a pagination div appears on a couple pages using the will_paginate gem (this seems to be Hartl's preferred method of testing whether pagination works), but when I add the following code..</p>\n\n<pre><code>subject { page }\n.\n.\n.\nit { should have_selector('div.pagination') }\n</code></pre>\n\n<p>..it returns..</p>\n\n<pre><code>  1) UserPages profile page \n     Failure/Error: it { should have_selector('div.pagination') }\n       expected css \"div.pagination\" to return something\n</code></pre>\n\n<p>This is especially odd because in this particular _spec file, this same Rspec code is passing in some tests and failing in others (I'll highlight this below). Also the <code>pagination</code> div is present in the source code in my browser, and of course it's working fine.</p>\n\n<p>Because it fails in some places and not others, I got to assuming that this is somehow a \"scope\"- or assignment-type issue related to <code>will_paginate</code> - you see, for the failed tests, the content being paginated is actually part of a \"Microposts\" controller, but the pages/views being tested are handled by the \"Users\" controller. For the passing tests, the view and controller are both \"Users\".</p>\n\n<p>Could that be the problem? It's also possible that my FactoryGirl setup/invocation is broken and not triggering the pagination code in test for some reason. I'm a Rails n00b - and actually totally new to programming - so thanks ya'll. :)</p>\n\n<p>(also, p.s., how do I make my code colorful and pretty on SO?)</p>\n\n<p><strong>/spec/requests/user_pages_spec.rb</strong>\n</p>\n\n<pre><code>require 'spec_helper' # Omitted from below - I don't think this is relevant.\n\ndescribe \"UserPages\" do\n\n  subject { page }\n\n  describe \"index\" do # This is the block where it is PASSING..\n\n    let(:user) { FactoryGirl.create(:user) } # I'll include my /spec/factories.rb file below\n\n    before(:all)  { 30.times { FactoryGirl.create(:user) } }\n    after(:all)   { User.delete_all } # I'll omit my /app/models/user.rb file - I don't think it's relevant to the problem\n\n    before do\n      valid_signin user # References /spec/support/utilities.rb to sign in as a valid user, but I will omit this since this is part of the working tests\n      visit users_path # This is /app/views/users/index.html.erb - this is where SUCCESSFUL pagination testing occurs\n    end\n\n    describe \"pagination\" do\n\n      it { should have_selector('div.pagination') } #PASS!! As I would expect\n  .\n  .\n  .\n  end\n\n  describe \"profile page\" do\n    let(:user) { FactoryGirl.create(:user) }\n    let!(:m1) { FactoryGirl.create(:micropost, user: user, content: \"Awesome\")} # Used for other tests\n    let!(:m2) { FactoryGirl.create(:micropost, user: user, content: \"Sauce\") } # Used for other tests\n\n    before(:all)  { 30.times { FactoryGirl.create(:micropost) } } # Is this constructed properly? Perhaps the posts are not created, and that's why the failure to render the paginate code in test.\n    after(:all)   { user.microposts.delete_all } # I have tested with and without this line of code - it fails both ways.\n\n    before { visit user_path(user) } # /app/views/users/show.html.erb\n\n    it { should have_selector('div.pagination') } # FAIL!!! This is the line in question that generates the error above.\n    .\n   .\n  .\n .\nend\n</code></pre>\n\n<p><strong>/app/views/users/index.html.erb</strong> (pagination working on site, test working also)</p>\n\n<pre><code>&lt;%= provide(:title, 'All users') %&gt;\n&lt;h1&gt;All users&lt;/h1&gt;\n\n&lt;%= will_paginate %&gt;\n\n&lt;ul class=\"users\"&gt;\n  &lt;%= render @users %&gt;\n&lt;/ul&gt;\n\n&lt;%= will_paginate %&gt;\n</code></pre>\n\n<p><strong>/app/views/users/show.html.erb</strong> (pagination working on site, test failing)</p>\n\n<pre><code>&lt;% provide(:title, @user.name) %&gt;\n&lt;div class=\"row\"&gt;\n.\n.\n.\n  &lt;div class=\"span8\"&gt;\n    &lt;% if @user.microposts.any? %&gt;\n      &lt;h3&gt;Microposts (&lt;%= @user.microposts.count %&gt;)&lt;/h3&gt;\n      &lt;ol class=\"microposts\"&gt;\n        &lt;%= render @microposts %&gt;\n      &lt;/ol&gt;\n      &lt;%= will_paginate @microposts %&gt; # Here is where I declare that pagination should occur on @microposts, NOT @users\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>/spec/requests/factories.rb</strong></p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do\n    sequence(:name)   { |n| \"Person #{n}\" }\n    sequence(:email)  { |n| \"person_#{n}@example.com\" }\n    password  \"secret\"\n    password_confirmation \"secret\"\n\n    factory :admin do\n      admin true\n    end\n  end\n\n  factory :micropost do\n    content \"Lorem ipsum\"\n    user\n  end\nend\n</code></pre>\n\n<p><strong>/Gemfile</strong></p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.3'\ngem 'pg', '0.12.2'\ngem 'bootstrap-sass', '2.0.0'\ngem 'bcrypt-ruby', '3.0.1'\ngem 'faker', '1.0.1'\ngem 'will_paginate', '3.0.3'\ngem 'bootstrap-will_paginate', '0.0.6'\n\ngroup :development do\n    gem 'guard-rspec', '0.5.5'\n    gem 'annotate', '~&gt; 2.4.1.beta'\nend\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '3.2.4'\n  gem 'coffee-rails', '3.2.2'\n  gem 'uglifier', '1.2.3'\nend\n\ngem 'jquery-rails', '2.0.0'\n\ngroup :test, :development do\n  gem 'rspec-rails', '2.9.0'\nend\n\ngroup :test do\n    gem 'capybara', '1.1.2'\n    gem 'rb-fsevent', '0.4.3.1', :require =&gt; false\n    gem 'growl', '1.0.3'\n    gem 'guard-spork', '0.3.2'\n    gem 'spork', '0.9.0'\n    gem 'factory_girl_rails', '1.4.0'\nend\n</code></pre>\n\n<p><strong>edit: found <a href=\"http://mislav.uniqpath.com/rails/will_paginate-view-testing/\" rel=\"nofollow\">this article related to will_paginate and view testing</a>, but don't understand it honestly (probably due to the syntax).. could it be somehow related?</strong> </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","coffeescript","stripe-payments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13131632,"title":"How to track down the cause of an error in coffescript and Stripe?","body":"<p>I'm using Stripe in my Rails 3 application to do creditcard payments. I'm roughly following the <a href=\"http://railscasts.com/episodes/288-billing-with-stripe\" rel=\"nofollow\">railscast on Stripe integration</a> though my app is doing just a single charge for now and not subscription billing like Ryan shows.</p>\n\n<p>The problem is, I can't get the <code>processCard()</code> function to fire. I'll be the first to admit I'm not a javascript guru (or any kind of guru for that matter). It doesn't give a javascript error, it instead submits the form to rails (without any credit card details) and fails since <code>stripe_card_token</code> is nil. I've placed some <code>alert()</code> dialogs spaced throughout for some very crude debugging to see where the hangup is. My model name is <code>Payment</code> which is really the only deviation so far from Ryan's code apart from the temporary alert() dialogs.</p>\n\n<p>So my question is twofold: How can I reliably track down what's causing the problem? and Where did I go wrong?</p>\n\n<p>Here's the Javascript:</p>\n\n<pre><code>jQuery -&gt;\n  Stripe.setPublishableKey($('meta[name=\"stripe-key\"]').attr('content'))\n  payment.setupForm()\n\npayment =\n  setupForm: -&gt;\n    $('#new_payment').submit -&gt;\n      $('input[type=submit]').attr('disabled', true)\n      alert(\"before processCard\")\n      payment.processCard()\n      alert(\"after processCard\")\n      false\n      # else\n      #   true\n\n  processCard: -&gt;\n    alert(\"processCard start\")\n    card =\n      number: $('#credit_card_number').val()\n      cvc: $('#cvc').val()\n      expMonth: $('#card_month').val()\n      expYear: $('#card_year').val()\n    alert(\"card values are set\")\n    Stripe.createToken(card, payment.handleStripeResponse)\n    alert(\"After createToken\")\n\n  handleStripeResponse: (status, response) -&gt;\n    if status == 200\n      alert(response.id)\n      # $('#payment_stripe_card_token').val(response.id)\n      # $('#new_payment')[0].submit()\n    else\n      alert(response.error.message)\n      # $('#stripe_error').text(response.error.message)\n      # $('input[type=submit]').attr('disabled', false)\n</code></pre>\n\n<p>And the associated view:</p>\n\n<pre><code>&lt;%= simple_form_for @payment, :html =&gt; { :class =&gt; 'form-horizontal'} do |f| %&gt;\n&lt;fieldset&gt;\n  &lt;legend&gt;Pay via Credit Card&lt;/legend&gt;\n\n    &lt;%= f.input :stripe_card_token, :as =&gt; :hidden, :id =&gt; 'stripe_card_token' %&gt;\n\n    &lt;div class=\"well well-small\"&gt;\n      &lt;%= current_user.full_name %&gt;&lt;br /&gt;\n      &lt;%= current_user.email %&gt;&lt;br /&gt;\n      This is the name we have on file for you. If it's not correct, please &lt;%= link_to \"change it now\", edit_user_registration_path(current_user) %&gt;\n    &lt;/div&gt;\n\n&lt;div id=\"stripe_error\"&gt;\n  &lt;noscript&gt;JavaScript is not enabled and is required for this form. First enable it in your web browser settings.&lt;/noscript&gt;\n&lt;/div&gt;\n\n&lt;div id=\"credit-card\"&gt;\n  &lt;div class=\"control-group string required\"&gt;\n    &lt;%= label_tag :credit_card_number, \"Card Number\", :class =&gt; \"control-label string required\" %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= text_field_tag :credit_card_number, nil, :class =&gt; \"string required\", :name =&gt; nil %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"control-group string required\"&gt;\n    &lt;%= label_tag :cvc, \"Security code (CVC)\", :class =&gt; \"control-label string required\" %&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= text_field_tag :cvc, nil, :class =&gt; \"string required\", :name =&gt; nil %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"control-group date required\"&gt;\n    &lt;%= label_tag :card_month, \"Expiration Date\", :class =&gt; \"control-label date required\"%&gt;\n    &lt;div class=\"controls\"&gt;\n      &lt;%= select_month nil, {add_month_numbers: true}, {name: nil, id: \"card_month\", :class =&gt; \"date required span2\"} %&gt;\n      &lt;%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+25}, {name: nil, id: \"card_year\", :class =&gt; \"date required span2\"} %&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n\n    &lt;h4&gt;Your unpaid courses&lt;/h4&gt;\n    &lt;% @unpaid_subs.each do |sub| %&gt;\n      &lt;%= sub.course.name %&gt;&amp;nbsp;|&amp;nbsp;&lt;%= sub.course.credits %&gt;&lt;br /&gt;\n    &lt;% end %&gt;\n\n&lt;div class=\"form-actions\"&gt;\n&lt;%= f.submit nil, :class=&gt;\"btn btn-primary\" %&gt;\n&lt;%= link_to \"Cancel\", courses_path, :class=&gt;\"btn\" %&gt;\n&lt;/div&gt;\n&lt;/fieldset&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Related Question(No accepted answer): <a href=\"http://stackoverflow.com/questions/11314013\">What is wrong with my CoffeScript in Stripe?</a></p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12643385,"title":"How to make jQuery remember state in a Rails app?","body":"<p>I'd be very grateful for a code snippet showing off jQuery functionality remembering state, e.g. .slideToggle(). </p>\n\n<p>I've read about local storage, session storage, ajax among others - what technique is preferred 2012 and how could an implementation look like in Ruby in Rails 3.2?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design","activerecord","controller"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12961706,"title":"How do I access information from multiple associated models in the Controller in an effiecient manner?","body":"<p>First, some background.</p>\n\n<p>My application models are like so:</p>\n\n<pre><code>  User has_many :subscriptions; has_many :courses, :through =&gt; :subscriptions\nSubscription belongs_to :course, :user\n  Course has_many :subscriptions; has_many :users, :through =&gt; :subscriptions\n</code></pre>\n\n<p>Subscription is a join table used to store information such as state (:active, :inactive, :failed, :passed, :unpaid) as well as serve as a connector to all the information that comes with taking a course (such as the Grade model(not yet added), the Payment model(work in progress), etc).</p>\n\n<p>I want to add the Payment model to store a history of payments on a subscription. Each payment can be for one or more subscriptions. So far, I've tried a <code>Payment has_many :subscriptions</code>, but <strong>I'm having trouble with the controller logic</strong> and I'm thinking maybe there's a better way to associate the models for \"a Payment from a User on a Subscription to a Course.\"</p>\n\n<p>Technically speaking, in a payment show action, I would need information from each of these models (course.name, user_id of user who paid, payment.amount, all of which are connected to a Subscription) and in a Payment.create action, I'd need to set the state of the subscription (that I can do).</p>\n\n<p>If this is a logical/efficient way to associate the various models, how do I access the needed information(some information from each model course, user, payment, and subscription) in the Payment show action with minimal database calls? I'm using <code>Rails 3.2/Ruby 1.9</code> and would like to stick with ActiveRecord/ARel instead of straight sql statements. I'm open to \"you're doing it wrong\" answers as well. If changing the associations will make it more efficient to access the tables from the controller, I'm open to that as well.</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","youtube"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":184,"score":0,"question_id":13130145,"title":"Sharing my page with youtube videos on facebook doesn't show thumbnail","body":"<p>I have a blog on my app and on this blog I usually put some youtube videos and when I share the links of these pages on Facebook there's no thumbnail. Is there a way to do this? </p>\n\n<p>I have tried to put meta-data with open graph protocol, with the youtube link but no luck.</p>\n\n<p>Is this possible?</p>\n\n<p><strong>EDITED</strong></p>\n\n<p>In my app I was including the OG video tag like this:</p>\n\n<pre><code>%meta{ :property =&gt; \"og:title\" , :content =&gt; \"#{post.title}\" }\n%meta{ :property =&gt; \"og:type\" , :content =&gt; \"article\" }\n%meta{ :property =&gt; \"og:url\" , :content =&gt; \"#{post_url(post.slug).sub('https:', 'http:')}\" }\n-if post.video_thumbnail &amp;&amp; post.video_thumbnail != \"\"\n  %meta{ :property =&gt; \"og:video\" , :content =&gt; \"http://www.youtube.com/watch?v=#{post.video_thumbnail}\"}\n</code></pre>\n\n<p>I found the answer on this question: <a href=\"http://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api\">How to get thumbnail of YouTube video link using YouTube API?</a></p>\n\n<p>Youtube API lets you get images from the video if used this URL: </p>\n\n<pre><code>http://img.youtube.com/vi/&lt;insert-youtube-video-id-here&gt;/0.jpg\n</code></pre>\n\n<p>So I included that link as my OG image tag like this:</p>\n\n<pre><code>%meta{ :property =&gt; \"og:image\" , :content =&gt; \"http://img.youtube.com/vi/#{post.video_thumbnail}/0.jpg\" }\n</code></pre>\n\n<p>And it work perfectly.</p>\n"},{"tags":["ruby-on-rails-3","capistrano","asset-pipeline"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":676,"score":3,"question_id":7933141,"title":"Rails 3.1 asset pipeline production w/out javascript runtime environment","body":"<p>I am struggling with the idea of deploying a large app using the the asset pipeline and the precompile Capistrano task. </p>\n\n<ol>\n<li><p>I don't want to install the javascript runtime environment and precompile the assets on each production server. </p></li>\n<li><p>The assets need to be uploaded to two Nginx servers that don't have a copy of the app.  </p></li>\n</ol>\n\n<p>So I have created a Capistrano task that precompiles the assets locally and then uploads the assets to the the Nginx servers, and the manifest files to the app servers. </p>\n\n<p>The problem is the assets on my local machine could differ from the assets the git branch I am deploying from. </p>\n\n<p>Is there a better way or must I just be dillagent to always deploy from the correct clean branch?</p>\n\n<h1>Edit here is the cap task that does the precompile and upload</h1>\n\n<pre><code>namespace :assets do\n  after \"deploy:update_code\", \"assets:precompile\"\n  after \"assets:precompile\", \"assets:upload_assets\"\n  after \"assets:precompile\", \"assets:upload_manifest\"\n\n\n  desc \"precompile assets\"\n  task :precompile do\n    run_locally(\"bundle exec rake assets:clean &amp;&amp; bundle exec rake assets:precompile RAILS_ENV=#{rails_env}\")\n  end\n\n  desc \"precompile and upload assets to webserver\"\n    task :upload_assets, :roles =&gt; :nginx do\n    top.upload( \"public/assets\", \"/usr/local/fieldphone/#{rails_env}/\", :via =&gt; :scp, :recursive =&gt; true)\n  end\n  # \n  desc \"upload manifest file\"\n  task :upload_manifest, :roles =&gt; :app do\n    top.upload( \"public/manifest.yml\", \"#{release_path}/public/\", :via =&gt; :scp )\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","csv","import","sqlite3","rake-task"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":28,"score":2,"question_id":13139567,"title":"After importing a csv file, extra rows are being created in my sqlite db table","body":"<p>I'm importing 17 csv files into my app via rake tasks.  The other files will import fine and not create extra rows, but for some reason this file is creating about 60 empty rows in my database.  The information I'm trying to import is going in fine and it's being associated with it's appropriate tables the way it should.  So if you were to use the app, everything functions properly but its making a mess of my table.</p>\n\n<p>For example, I'm importing 2 rows into the table and right after those two are being created, it's followed by 58 blank rows.  Does anyone have any suggestions about how I can use a conditional statement to keep this from happening and please be specific I'm still relatively new at this.  Thanks</p>\n\n<p>Here is my code:</p>\n\n<pre><code>require 'csv'\n\nnamespace :import_mat_lists_csv do\n\ntask :create_mat_lists =&gt; :environment do\n    puts \"Import Material List\"\n\n    csv_text = File.read('c:/rails/thumb/costrecovery/lib/csv_import/mat_lists.csv')\n    csv = CSV.parse(csv_text, :headers =&gt; true)\n    csv.each_with_index do |row,index|\n        row = row.to_hash.with_indifferent_access\n        MatList.create!(row.to_hash.symbolize_keys)\n        matlist = MatList.last\n        if @report_incident_hash.key?(matlist.report_nr)\n            matlist.incident_id = \"#{@report_incident_hash[matlist.report_nr]}\"\n        end\n\n        #matlist.timesheet_id = @timesheet_id_array[index]\n        matlist.save\n    end\n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":5,"favorite_count":4,"up_vote_count":5,"down_vote_count":0,"view_count":841,"score":5,"question_id":5655071,"title":"Good base app for Rails 3?","body":"<p>Could anybody tell me a good base app for Rails 3?</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-maps-api-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13143355,"title":"Ruby and Google Maps API","body":"<p>I'm requesting directions with the following url:</p>\n\n<pre><code>http://maps.googleapis.com/maps/api/directions/json?origin=43.656877,-79.32085&amp;destination=Montreal&amp;sensor=false\n</code></pre>\n\n<p>Then, Google sends back a huge JSON and I want to access the steps in a nicer way than this:</p>\n\n<pre><code>response = open(\"http://maps.googleapis.com/maps/api/directions/json?origin=#{lat1},#{lng1}&amp;destination=#{lat2},#{lng2}&amp;sensor=false\").read\nresponse = JSON.parse(response)\n\nresponse[\"routes\"][0][\"legs\"][0][\"steps\"][0][\"end_location\"]\n</code></pre>\n\n<p>Is there a more beautiful way to access the end_location without having to use all these array notation? I thought of using OpenStruct, but it would not be ideal either.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2","less","asset-pipeline","precompile"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":94,"score":0,"question_id":12938995,"title":"Excluding files from assets:precompile in rails","body":"<p>I use codekit for writing less which it then converts to css automatically.</p>\n\n<p>I don't want rails to convert my less files to css, I rather codekit do it.</p>\n\n<p>if I precompile the assets via</p>\n\n<pre><code>rake assets:precompile\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>rake aborted!\ncannot load such file -- less\n</code></pre>\n\n<p>How do I <strong>exclude</strong> a specific folder/file types from precompiling? (all my less files are in app/assets/stylesheets/less and the css (which I do want to be precompiled) are in app/assets/stylesheets/css</p>\n\n<p><strong>update</strong></p>\n\n<p>deleting <code>application.less</code> solves this but how do I excluding it from processing in the first place?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","osx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12468459,"title":"I want to change my OS X ruby version to 1.9 without using RVM","body":"<p>yeah, you heard me right! I want to nix RVM for the time being and just run off of a system-level installation of Ruby 1.9.3</p>\n\n<p>In other words, I want to just upgrade the old 1.8.7 version of ruby that came with my Mountain Lion installation to 1.9.3.</p>\n\n<p>How would i do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13142980,"title":"How to group radio button in form created by simple_form?","body":"<p>My Answer model have 2 column, <code>content</code> is text and <code>correct</code> is boolean. My form to create answer here:  </p>\n\n<pre><code>&lt;legend&gt;Answer&lt;/legend&gt;\n&lt;%= question_form.simple_fields_for :answers do |answer_form| %&gt;\n\n  &lt;%= answer_form.input :content, input_html: { rows: 1, class: 'span6' } %&gt;\n  &lt;%= answer_form.input :correct, as: :radio_buttons %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Form is rendered like this:  </p>\n\n<p><img src=\"http://s8.postimage.org/yabhzkr79/answer_fields.png\" alt=\"answer form\"></p>\n\n<p>But i want, with one text content, will have only one radio, to set that content is correct. It means with above image, i would like radio buttons don't have <code>No</code> choice, and only one in two radio buttons is checked, like if content 'True' have radio button checked, content 'False' will have radio button is not checked. How can i do that with simple form?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13142785,"title":"Form for adding children using ancestry gem","body":"<p>I have a user model in Rails and I am trying to use the Ancestry gem to add children to users. I would like to be able to enter one/several user ids (children) into a form and then assign them to be children to a user. I currently have a form for updating the name of the user in a view, but being new to Rails I am struggling to figure out the form should look like for making @user parent of user_ids (the children) entered a form. How can one do this?</p>\n\n<p>edit.html.erb</p>\n\n<pre><code>…\n&lt;%= form_for @user do |f| %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.submit \"Update\", class: \"btn\" %&gt;            \n&lt;% end %&gt;\n…\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":2,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":131,"score":16,"question_id":13142326,"title":"What does <%== %> do in rails erb?","body":"<p>I saw this recently, thought it was interesting.  But I don't really understand what it does?</p>\n\n<p>Ex.  I have a rails app and I want to bootstrap some json, so that I don't have to make a second request.  Normally I would write something like this.</p>\n\n<p><code>&lt;%= raw @model.to_json %&gt;</code>\nor\n<code>&lt;%= @model.to_json.html_safe %&gt;</code></p>\n\n<p>I have to send the message <code>raw</code> or <code>html_safe</code> or the json will be html escaped and thus not parsed correctly.  However, this seems to work too.</p>\n\n<p><code>&lt;%== @model.to_json %&gt;</code></p>\n\n<p>But I can't find any documentation.</p>\n\n<p>Does anyone know what this does exactly?  i.e.  Is it the exact same as calling <code>html_safe</code> or <code>raw</code>?  Or is there more to it?</p>\n"},{"tags":["jquery","ajax","ruby-on-rails-3","ruby-on-rails-3.2","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13142221,"title":"JSON::GeneratorError in a .js.erb file","body":"<p>I don't understand what I'm doing wrong..</p>\n\n<p>I am attempting to catch a 401 unauthorized and inserting a div with a message before the submit button using </p>\n\n<pre><code>$(function() {\n  return $(\"a\").ajaxError(function(event, jqXHR, ajaxSettings, thrownError) {\n    if (jqXHR.status === 401) {\n      $(\".submit\").before(&lt;%=j content_tag :div, \"Does not compute\" %&gt; );\n    }\n  });\n});\n</code></pre>\n\n<p>the name of the file is home.js.erb</p>\n\n<p>even before the page loads I get </p>\n\n<pre><code>JSON::GeneratorError in Pages#home\n\nShowing H:/project/app/views/layouts/application.html.erb where line #6 raised:\n\nonly generation of JSON objects or arrays allowed\n  (in H:/project/app/assets/javascripts/home.js.erb) \n</code></pre>\n\n<p>line #6 refers to </p>\n\n<pre><code>5:   &lt;%= stylesheet_link_tag    \"application.css\", :media =&gt; \"all\" %&gt;\n6:   &lt;%= javascript_include_tag \"application\" %&gt;\n</code></pre>\n\n<p>obviously something is wrong.. but what?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13140509,"title":"How can I open a link(button) in a separate tab?","body":"<p>I have a button that opens a link in a same window, but I need to open it in a separate tab by doing some scripting. I am working in Ruby and here is my code:  </p>\n\n<pre><code>Given /^User clicks on the New User Link$/ do\n    page.driver.browser.switch_to.window (page.driver.browser.window_handles.last)\n    find(:xpath, \"//*[@id='slideshow']/div[1]/div/a/img, \").click\nend\n</code></pre>\n\n<p>This code won't work for me. Please let me know if you see anything wrong in this code. </p>\n"},{"tags":["ruby","ruby-on-rails-3","routing"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":92,"score":3,"question_id":13140624,"title":"Rails 3 Routing: Resource actions and nested resource with :path => \"/\"","body":"<p>I want to configure my Rails routing such that these cases work:</p>\n\n<pre><code>/username           #=&gt; { :controller =&gt; \"houses\",\n                    #     :action =&gt; \"index\",\n                    #     :user_id =&gt; \"username\" }\n\n/username/housename #=&gt; { :controller =&gt; \"houses\",\n                    #     :action =&gt; \"show\",\n                    #     :user_id =&gt; \"username\",\n                    #     :id =&gt; \"housename\" }\n\n/username/edit      #=&gt; { :controller =&gt; \"users\",\n                    #     :action =&gt; \"edit\",\n                    #     :id =&gt; \"username\" }\n</code></pre>\n\n<p>In other words, I want <code>/:user_id</code> to be a regular user resource, and have a nested resource for it, which is mounted directly on the root. So, I want <code>/username/housename</code> instead of <code>/username/houses/housename</code>. I tried using <code>:path =&gt; \"/\"</code> for the nested resources, but this somehow clashes with other actions such as `:edit. I'm lost - can this be done?</p>\n"},{"tags":["ruby-on-rails-3","metric-fu"],"answer_count":2,"favorite_count":0,"up_vote_count":8,"down_vote_count":0,"view_count":514,"score":8,"question_id":9543908,"title":"metric_fu equivalent for ruby 1.9.x","body":"<p><a href=\"https://github.com/jscruggs/metric_fu\">metric</a>_fu doesn't seem to be supported in the latest ruby kernel (1.9.2 | 1.9.3). Are there any gems which offer equivalent functionality.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13137826,"title":"How to add a method for active record?","body":"<p>I would want to use my method getScheduleFixed() on a Active Record Istance</p>\n\n<pre><code>ps = ProgramSchedule.all\nps.getScheduleFixed\n</code></pre>\n\n<p>the important fact is how to access to \"ps\" array (active record) on my method declaration</p>\n\n<pre><code>class ProgramSchedule &lt; ActiveRecord::Base\n\n  def getScheduleFixed\n\n    array = (HERE ARRAY RETURNED BY ACTIVE RECORD)\n\n    # some stuff...\n\n    return array\n\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","deployment","twitter-bootstrap"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13141477,"title":"Rails 3 Production Bootstrap Asset Problems","body":"<p>I have deployed my site which uses Twitter Bootstrap heavily and am having a problem with the difference between local and production, If you have a look at the images below you will see that not only the background from the navbar has gone but also that the padding on some of the other elements has also gone screwy.</p>\n\n<p>Additionally you can see that the Icons also have a black shadow on them.</p>\n\n<p><img src=\"http://i.stack.imgur.com/x9Ws1.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"http://i.stack.imgur.com/MgwLv.png\" alt=\"enter image description here\"></p>\n\n<p>My production.rb is as follows:-</p>\n\n<pre><code>    Build::Application.configure do\n  # Settings specified here will take precedence over those in config/application.rb\n\n  # Code is not reloaded between requests\n  config.cache_classes = true\n\n  # Full error reports are disabled and caching is turned on\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n\n  # Disable Rails's static asset server (Apache or nginx will already do this)\n  config.serve_static_assets = false\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n\n  # Defaults to nil and saved in location specified by config.assets.prefix\n  # config.assets.manifest = YOUR_PATH\n\n  # Specifies the header that your server uses for sending files\n  # config.action_dispatch.x_sendfile_header = \"X-Sendfile\" # for apache\n  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx\n\n  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.\n  # config.force_ssl = true\n\n  # See everything in the log (default is :info)\n  # config.log_level = :debug\n\n  # Prepend all log lines with the following tags\n  # config.log_tags = [ :subdomain, :uuid ]\n\n  # Use a different logger for distributed setups\n  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)\n\n  # Use a different cache store in production\n  # config.cache_store = :mem_cache_store\n\n  # Enable serving of images, stylesheets, and JavaScripts from an asset server\n  # config.action_controller.asset_host = \"http://assets.example.com\"\n\n  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)\n  # config.assets.precompile += %w( search.js )\n\n  # Disable delivery errors, bad email addresses will be ignored\n  # config.action_mailer.raise_delivery_errors = false\n\n  # Enable threaded mode\n  # config.threadsafe!\n\n  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to\n  # the I18n.default_locale when a translation can not be found)\n  config.i18n.fallbacks = true\n\n  # Send deprecation notices to registered listeners\n  config.active_support.deprecation = :notify\n\n  # Log the query plan for queries taking more than this (works\n  # with SQLite, MySQL, and PostgreSQL)\n  # config.active_record.auto_explain_threshold_in_seconds = 0.5\nend\n</code></pre>\n\n<p>I have also run the following from ssh to try and fix it:-</p>\n\n<pre><code>RAILS_ENV=production rake assets:precompile\n</code></pre>\n\n<p>Any help would be appreciated as I am pulling my hair out here.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","auto-increment","infinite-scroll"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13124364,"title":"Endless / Infinite Scroll Counter Column","body":"<p>I currently have a working table that is sorted by several select boxes. I recently implemented endless/infinite scrolling by following this tutorial: <a href=\"http://railscasts.com/episodes/114-endless-page-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/114-endless-page-revised?view=asciicast</a></p>\n\n<p>The tutorial worked after a couple of changes, but I have one problem. I am using a counter for the first column, but the problem is that every time it loads the next page, the counter resets to 1. I am currently displaying 50 records at the start and 50 more each time the user scrolls down to the bottom. I would like the next records to be 51...52...53...etc. Then the next time you scroll to the bottom, start at 101 then 102...103...104...etc.</p>\n\n<p>To get the partial I followed this tutorial which also told me how to make the counter column:\n<a href=\"http://xianese.blogspot.com/2008/06/render-collection.html\" rel=\"nofollow\">http://xianese.blogspot.com/2008/06/render-collection.html</a></p>\n\n<p>Here is my code:</p>\n\n<p><strong>articles.js.coffee</strong></p>\n\n<pre><code>jQuery -&gt;\n   if $('.pagination').length\n      $('#articles_table').scroll -&gt;\n              url = $('.pagination .next_page').attr('href')          \n              if url &amp;&amp;  $('#articles_table')[0].scrollHeight -    \n              $('#articles_table').scrollTop() &lt; 700                  \n                      $('.pagination').text('Fetching more users...')\n                      $.getScript(url)\n$('#articles_table').scroll()\n</code></pre>\n\n<p><strong>index.html.erb</strong></p>\n\n<pre><code>&lt;table class=\"table table-striped table-bordered span8 table-condensed\"     \n id=\"articles_table\" &gt;\n&lt;thead class=\"header\"&gt;\n  &lt;tr&gt;\n      &lt;th&gt;ID&lt;/th&gt;\n      &lt;th&gt;Title&lt;/th&gt;\n      &lt;th&gt;Description&lt;/th&gt;\n      &lt;th&gt;Created_At&lt;/th&gt;\n  &lt;/tr&gt;\n&lt;/thead&gt;\n&lt;tbody&gt;\n&lt;%= render @articles %&gt;\n\n&lt;/tbody&gt;\n</code></pre>\n\n<p><strong>index.js.erb</strong></p>\n\n<pre><code>$('#articles_table').append('&lt;%= j render(@articles) %&gt;');\n&lt;% if @articles.next_page %&gt;\n$('.pagination').replaceWith('&lt;%= j will_paginate(@articles) %&gt;');\n&lt;% else %&gt;\n$('.pagination').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_article.html.erb</strong></p>\n\n<pre><code>&lt;tr&gt;\n      &lt;td&gt; &lt;%= article_counter +1 %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Title %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Description %&gt; &lt;/td&gt;\n      &lt;td&gt; &lt;%= article.Created_At %&gt; &lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["jquery","ruby-on-rails-3","sorting"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13130855,"title":"Sorting Table Function Not Working - Jquery-DataTables-Rails","body":"<p>I am having issues implementing the \"table sort\" feature into my rails application. I have data that is being dynamically added by each model (simple scaffolding). I have followed Ryan Bates tutorial exactly as he stated (#228) and the sortable feature will not just work. I then read and listed to his tutorial DataTables #340 and the feature will still not work.</p>\n\n<p>I know the gem is working correctly because when I add this to my: </p>\n\n<p><strong>network.js.coffee</strong></p>\n\n<pre><code>jQuery -&gt;\n  $('#networks').dataTable\nsPaginationType: \"bootstrap\"\nbServerSide: true\n</code></pre>\n\n<p><strong>networks_controller</strong></p>\n\n<pre><code>def index\n@networks = Network.all\n@networks = Network.paginate(:page =&gt; params[:page], :per_page =&gt; 5)\nrespond_to do |format|\n  format.html # index.html.erb\n  format.json { render json: @networks }\nend\n</code></pre>\n\n<p>end</p>\n\n<p>It will stylize my table giving it the bootstrap toggle arrows and search field box. However, clicking on the arrows to filter does absolutely nothing. I have spent many hours trying to figure this out with no positive results. </p>\n\n<p>Any suggestions??</p>\n\n<p>TIA</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","views","content-for"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13140596,"title":"How to skip the content_for tag content for some pages in rails?","body":"<p>I have a layout in which i'm using the content_for tag to render some partials(for sidebar). But on several pages I don't need this sidebar. So the question is: How can I tell rails not to render anything for some pages?</p>\n\n<p>I've tried to do it the following way without any result:</p>\n\n<pre><code>&lt;% content_for :sidebar do %&gt;\n  &lt;%= render nothing: true %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Just got an error</p>\n\n<pre><code>You invoked render but did not give any of :partial, :template, :inline, :file or :text option.\n</code></pre>\n"},{"tags":["ruby-on-rails-3","validation","model","relationship","validator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13139839,"title":"rails custom validator doesn't seem to work","body":"<p>I wrote a custom validator which sits in lib/readiness_for_completion_validator.rb:</p>\n\n<pre><code>class DisruptionTimeValidator &lt; ActiveModel::Validator\n  def validate(record)\n    # if record.timeline.events[0].event_time &gt; record.timeline.events[1].event_time \n    if true \n      record.errors[:Outage] &lt;&lt; \" end time needs to be after outage begin time\" \n    end\n  end\nend\n</code></pre>\n\n<p>The issue is, I can't get it to trigger ever if I substitute the 'if true' for the commented out line. </p>\n\n<p>I tested the condition in rails console and it works exactly as I would want it to, but it never evaluates to true in the validator...</p>\n\n<p>Any help would be greatly appreciated, I spent a lot of time researching this and this is driving me crazy :(</p>\n\n<p>I have a Timeline that has many events. People can adjust event_time on events but there are two special events that each timeline contains that need to occur in succession.</p>\n\n<p>Below please find what I have in app/models/event.rb:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  attr_accessible :event_description, :event_time, :timeline_id\n\n  belongs_to :timeline\n\n  validates :event_description, :length =&gt; { :in =&gt; 10..255 }\n\n  validates_with DisruptionTimeValidator, :on =&gt; :update\n\nend\n</code></pre>\n\n<p>(I messed around with the :on but it didn't make any difference)</p>\n\n<p>Any help would be greatly appreciated,</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","formtastic"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13139597,"title":"Rails 3 file upload with Carrierwave and Formtastic","body":"<p>I have a Product with many Photos. The relationship is this way:</p>\n\n<p>product.rb</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n  has_many :photos, :dependent =&gt; :destroy\n  attr_accessible :translations_attributes, :active, :category_id, :photos\n  accepts_nested_attributes_for :translations, :photos\n</code></pre>\n\n<p>photo.rb</p>\n\n<pre><code>class Photo &lt; ActiveRecord::Base\n  attr_accessible :photo, :product_id\n  belongs_to :attachable\n  mount_uploader :photo, PhotoUploader\n</code></pre>\n\n<p>and the form looks like this:</p>\n\n<pre><code>form(:html =&gt; { :multipart =&gt; true }) do |f|\nf.inputs \"Details\" do\n  f.input :active\n  f.input :category, :include_blank =&gt; false\nend\n\nf.inputs \"Photos\" do\n    f.input :photos, :as =&gt; :file\nend\n\nf.buttons\n</code></pre>\n\n<p>end</p>\n\n<p>The problem is that I get this error when creating/updating the product with a file attached:</p>\n\n<pre><code>undefined method `each' for #&lt;ActionDispatch::Http::UploadedFile:0x007f93c8549828&gt;\n</code></pre>\n\n<p>I found a question with the same error <a href=\"http://stackoverflow.com/questions/10955501/rails-3-polymorphic-association-with-carrierwave-and-simple-form\">here</a>, but even trying their solution still have the same problem.</p>\n\n<p>I'm using Friendly_Id, ActiveAdmin, Globalize3, maybe it could have some relationship with them, this is my first project with Rails and right now I don't know what could be...</p>\n"},{"tags":["ruby-on-rails-3","csv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13138415,"title":"Rails 3- What is the alternative solution of CSV.parse_line in rails3","body":"<p>In rails 2, I used CSV.parse_line to read csv files.\nIn Rails 3, CSV.parse_line is not present. I used line.split but it is not working when there is comma (,) present in one word. It split it into two columns.</p>\n\n<p>I want to know that is there is any alternative solution of CSV.parse_line in Rails 3?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec","factory-girl"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13129583,"title":"Rspec testing instance variables with user creation","body":"<p>I'm testing to make sure that a created user is assigned to my instance variable <code>@user</code>. I understand what get means, but I'm not sure what to write for the test. I'm returning with an argument error for a bad URI or URL. What's wrong with my test and how do I fix it?</p>\n\n<pre><code>it \"checks @user variable assignment for creation\" do\n\n    p = FactoryGirl.create(:user)\n    get :users\n    # I'm confused on what this line above means/does. What does the hash :users refer \n    #to\n    assigns[:user].should == [p]\n\nend\n</code></pre>\n\n<p>The <code>expected URI object or string error</code> refers to <code>get :users</code> and the error is as follows</p>\n\n<pre><code>Failure/Error get :users\nArgumentError:\n  bad argument: (expected URI object or URI string)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","factory-girl","testunit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13138041,"title":"Can we load multiple factories into the database in one shot?","body":"<p>Just started using factory girl. If one has to save a factory into the db then one has to run\n<code>FactoryGirl.create()</code>.</p>\n\n<p>But is there any way to load a collection of factories into the database without having to call create on each of the factories?</p>\n\n<p>If its of any help i'm using Ruby 1.9.3, Rails 3.2.8 and Factory Girl 4.1.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","naming-conventions","rspec2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13128662,"title":"File name convention in rspec file","body":"<p>I noticed in the Ruby on Rails Tutorial by Hartl that he uses rails generate to create the rspec file. For example, </p>\n\n<pre><code>rails generate integration_test static_pages\n</code></pre>\n\n<p>creates the file <code>static_pages_spec.rb</code>. My question is, is there a naming convention for the name of the file? </p>\n\n<p>Also, is there a naming convention for the text between <code>describe</code> and <code>do</code>? I'm aware that writing something like <code>/people/new</code> will set up the render automatically when testing a view so all I need to do is write <code>render</code>, but what other naming conventions exist out there in rspec?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","date"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13138702,"title":"Ruby on rails implode and explode functions to change date format","body":"<p>How do we explode a string on '-' and again implode it on '-' in ruby on rails.My problem is that i want to convert a date in <code>\"MM-DD-YYYY\"</code> format to <code>'YYYY-MM-DD'</code> coming  from a form and save it to mysql database.As MySQL will only accept <code>'YYYY-MM-DD'</code> format.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","relationship"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13138038,"title":"retrive object id from relation in rails3","body":"<p>i have a model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n  has_many :meetings, :dependent =&gt; :destroy do \n    def find_foreign\n      Meeting.where(\"user_id &lt;&gt; ?\", id)\n    end\n  end\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me\n  # attr_accessible :title, :body\n\nend\n</code></pre>\n\n<p>and when i am trying to get user's foreign meetings like that</p>\n\n<pre><code>some_user.meetings.find_foreign\n</code></pre>\n\n<p>i get an error</p>\n\n<pre><code>NoMethodError (undefined method `id' for []:ActiveRecord::Relation):\n</code></pre>\n\n<p>because self in find_foreign is an Array. How to retrive the User.id from this method ?</p>\n"},{"tags":["ruby-on-rails-3","model"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13138693,"title":"rails before_destroy partial delete","body":"<p>I'm trying to figure out a way to partially delete/destroy dependent models in rails.</p>\n\n<p>Code looks something like this:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  has_many :subscriptions\n  has_many :photos, :dependent =&gt; :destroy\n  has_many :badges, :dependent =&gt; :destroy\n\n  before_destroy :partial_destroy\n\n  def partial_destroy\n    self.photos.destroy_all\n    self.badges.destroy_all\n    return false if self.subscriptions.any? \n  end\n...\n</code></pre>\n\n<p>Essentially, I want to destory the photos and badges, but if the user has any subscriptions, I want to keep those, and also keep the user from being destroyed.</p>\n\n<p>I tried with <code>.each { |obj| obj.destroy }</code> and using <code>delete</code> and <code>delete_all</code>, but it seems to not matter.</p>\n\n<p>It looks like rails is performing some kind of a rollback whenever the <code>before_destroy</code> returns false. Is there a way to destroy part of the dependents but not others?</p>\n"},{"tags":["ruby-on-rails-3","nested-attributes"],"answer_count":3,"favorite_count":5,"up_vote_count":7,"down_vote_count":0,"view_count":12996,"score":7,"question_id":5467158,"title":"WARNING: Can't mass-assign protected attributes","body":"<p>I get this error \"WARNING: Can't mass-assign protected attributes: races_attributes\"\n, when following this <a href=\"http://railscasts.com/episodes/196-nested-model-form-part-1\">http://railscasts.com/episodes/196-nested-model-form-part-1</a> on rails 3.</p>\n\n<p>Where Races are a component of Events. This is my models/race.rb:</p>\n\n<pre><code>class Race &lt; ActiveRecord::Base\nbelongs_to :event\n\nattr_accessible :name, :unit\nend\n</code></pre>\n\n<p>This is my models/event.rb:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\nhas_many :races, :dependent =&gt; :destroy\n\naccepts_nested_attributes_for :races\n\nattr_accessible :name, :date, :description, :location_name, :address_one, :address_two, :city, :state, :zip, :active, :races_attributes\nend\n</code></pre>\n\n<p>Any Ideas?</p>\n"},{"tags":["ruby-on-rails-3","statemachine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13138008,"title":"State_machine throws State is invalid error on initialization","body":"<p>I cannot get state_machine to initialize</p>\n\n<p>I've stripped this down to its bare essentials</p>\n\n<pre><code>class BuddyConnection &lt; ActiveRecord::Base\n\n  attr_accessor :state\n\n  state_machine :state, :initial =&gt; :sent do\n\n  end\n\nend\n</code></pre>\n\n<p>In my controller:</p>\n\n<pre><code>buddy_invite = BuddyConnection.new\n</code></pre>\n\n<p>This does set state = \"sent\" , but buddy_invite.save! throws</p>\n\n<pre><code>ActiveRecord::RecordInvalid (Validation failed: State is invalid):\n</code></pre>\n\n<p>In my Gemfile, the default installation is version 1.0.2 (which wont even set the state on the .new, showing it as nil)</p>\n\n<p>I set the gem version to 1.1.2 and this now sets state correctly on the .new method, but both versions still throw in invalid state error on a .save!</p>\n\n<p>What am I doing wrong here?</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","jquery-ajax"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13116243,"title":"error undefined method `remote_function' (how to make Ajax calls with Rails 3 using remote_function)","body":"<p>I found that this function (remote_function) was part of the Prototype helper which was removed from the framework with Rails 3.1 and how to change on ajax?</p>\n\n<pre><code>      country\n      %select#country{:name =&gt; \"country\", :onchange =&gt; remote_function(:update =&gt; 'region_city', :url =&gt; { :action =&gt; :get_regions_cities_for_country}, :with =&gt; 'Form.Element.serialize(this)')}\n        = options_for_select( Country.find(:all).map {|u| [u.name,u.id]})\n      %div{:id =&gt; \"region_city\"}\n        region\n        %select#region{:name =&gt; \"region\", :onchange =&gt; remote_function(:update =&gt; 'city', :url =&gt; { :action =&gt; :get_cities}, :with =&gt; 'Form.Element.serialize(this)')}\n          = options_for_select(Country.find(:first).regions.find(:all).map {|u| [u.name,u.id]})\n        city\n        #{select_tag(:city, options_for_select( Country.find(:first).regions.find(:first).cities.find(:all).map {|u| [u.name,u.id]} ))}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13137590,"title":"nested attributes with fields_for and jquery","body":"<p>I have created a project where in a single page a project along with its task should be created. for this i have used nested attributes,field_for. Iam facing a issue right now. While creating a project team members are first added to the project. While creating task, these added users should be only displayed under task. As Iam using a single view page I am not able to get the selected members for the multiple tasks..</p>\n\n<p>Kindly help me...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13131340,"title":"Using paginate while fetching results by a SQL query in ruby","body":"<p>I have the following query in my Rails Controller:</p>\n\n<pre><code>SELECT CODE_VER FROM MASTERTEST WHERE DATE&gt;= DATE_SUB(CURDATE(), INTERVAL 90 DAY) ORDER BY DATE DESC;\n</code></pre>\n\n<p>This query returns me results from the last 90 days. I display all these results in a table right now. </p>\n\n<p>I want to show only rows from 7 days at a time in some kind of pagination. I have tried will_paginate and kaminari and also paginate_by_sql. But I haven't been successful using any of them so far.</p>\n\n<p>Can someone show me the exact syntax incase of my query?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13095662,"title":"Rails 3.2.8 Remote Form Not Working","body":"<p>I have this form, which is not bound to any model, that I want to ajaxify. I've tried to figure out how to get it to submit via ajax, but I must be doing something wrong because it is not working (it just does a regular POST).</p>\n\n<p>I can confirm that the form tag renders with a 'remote' attribute, but there is not js added anywhere to the form. I also added the :confirm just to see if that would work as well. It does not.</p>\n\n<p>jquery and jquery_ujs are both loaded on the page.</p>\n\n<pre><code>  %form{ :action =&gt; \"/newsletter\", :confirm =&gt; \"Are you sure?\", :remote =&gt; true, :method =&gt; \"post\", :id =&gt; \"newsletterForm\"}\n    %p\n      = label_tag(:q, \"Subscribe to our newsletter:\")\n    %p\n      = text_field_tag(:q, nil, :placeholder =&gt; \"Your email address\")\n      = button_to(\"Subscribe\", :remote =&gt; true)\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","usps"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":710,"score":0,"question_id":7163280,"title":"How to use the shipping gem in ruby on rails 3 for USPS API?","body":"<p>I've found the <code>shipping</code> gem for ruby here <a href=\"http://shipping.rubyforge.org/\" rel=\"nofollow\">http://shipping.rubyforge.org/</a> searching on google for some information on integrating  <code>USPS</code> API on a Ruby on rails application but when I install the gem and add it to my <code>Gemfile</code> as i run the <code>bundle install</code> whenever a try to run my application or a rake taks i get the following error:</p>\n\n<pre><code>/Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `require': /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping/ups.rb:109: syntax error, unexpected ':', expecting keyword_then or ';' or '\\n' (SyntaxError)\n/Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping/ups.rb:437: syntax error, unexpected keyword_end, expecting $end\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `block in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:225:in `block in load_dependency'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:596:in `new_constants_in'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:225:in `load_dependency'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.7/lib/active_support/dependencies.rb:239:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/shipping-1.6.0/lib/shipping.rb:47:in `&lt;top (required)&gt;'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `each'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `block in require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `each'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/bundler-1.0.18/lib/bundler.rb:120:in `require'\n    from /Users/myusername/railsapps/dbh4/config/application.rb:7:in `&lt;top (required)&gt;'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.7/lib/rails/commands.rb:15:in `require'\n    from /Users/myusername/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.0.7/lib/rails/commands.rb:15:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have removed now the gem from my <code>Gemfile</code> and my application is up and running but, I don't even know if this gem works for <code>Rails 3</code> or even if this gem works for <code>USPS</code> API.</p>\n\n<p>Any help on this? I need to integrate USPS Web Tools with my Ruby on Rails 3 Application.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13135033,"title":"Return all locales for selected field","body":"<p>Say I have a model Book</p>\n\n<pre><code>class Book\n  include Mongoid::Document\n  field :name, localize: true\n  # ... much more fields\nend\n</code></pre>\n\n<p>Now I want to query for only name only, but for all locales. Book.only(:name) seems to return the current locale, and while I could do Book.only(:name, :\"name.ar\"), it requires that I manually add all locales I have. </p>\n\n<p>Is there a way to tell Mongoid I want all locales of selected field?</p>\n"},{"tags":["ruby-on-rails-3","rspec2","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":15,"score":1,"question_id":13102632,"title":"How to write RefineryCMS controller tests without RoutingError","body":"<p>An Rspec test like this (actually taken from RefineryCMS' own test suite)</p>\n\n<pre><code>require File.expand_path(File.dirname(__FILE__) + '/../spec_helper')\n\nmodule Refinery\n  describe FastController do\n    it \"should render the wymiframe template\" do\n      get :wymiframe\n      response.should be_success\n    end\n  end\nend\n</code></pre>\n\n<p>Results in the following error:</p>\n\n<pre><code>Failure/Error: get :wymiframe\nActionController::RoutingError:\n  No route matches {:controller=&gt;\"refinery/fast\", :action=&gt;\"wymiframe\"}\n# ./spec/controllers/fast_controller_spec.rb:6:in `block (2 levels) in &lt;module:Refinery&gt;'\n</code></pre>\n\n<p>In this case, I'm using refinery 2.0.8 with Rspec 2.11, and the relevant section after running rake routes looks like:</p>\n\n<pre><code>wymiframe GET     /wymiframe(/:id)(.:format)        refinery/fast#wymiframe\n</code></pre>\n\n<p>I have tried a few other controller Rspecs which also fail with routing errors. I am of course trying to write tests for my own extra methods I am adding to vanilla Refinery controllers, but just thought I'd see if I could get a controller test working for a totally fresh refinery install. </p>\n\n<p>This must be a simple mistake! Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13135053,"title":"Customise carrierwave validation messages","body":"<p>carrierwave is giving me this validation error:</p>\n\n<blockquote>\n  <p>Image You are not allowed to upload \"pages\" files, allowed types: jpg,\n  jpeg, gif, png</p>\n</blockquote>\n\n<p>any idea how to remove the \"image\" attribute bit from the beginning? it doesn't read very well.</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13135427,"title":"how to make Permissions dynamic?","body":"<p>I am following this tutorial : <a href=\"http://eveloverails.wordpress.com/2011/04/02/183/\" rel=\"nofollow\">How to implement the dynamic authorization with CanCan ?</a></p>\n\n<p>I am making an application which has 5 models </p>\n\n<ol>\n<li>Articles,</li>\n<li>Users</li>\n<li>Permissions, and </li>\n<li>user_type_permission </li>\n</ol>\n\n<p>The schema is as follows:</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121025074809) do\n\ncreate_table \"articles\", :force =&gt; true do |t|\nt.string   \"name\"\nt.datetime \"created_at\", :null =&gt; false\nt.datetime \"updated_at\", :null =&gt; false\nend\n\ncreate_table \"permissions\", :force =&gt; true do |t|\nt.string   \"object_type\"\nt.string   \"action_name\"\nt.string   \"description\"\nt.datetime \"created_at\",  :null =&gt; false\nt.datetime \"updated_at\",  :null =&gt; false\nt.integer  \"user_id\"\nend\n\ncreate_table \"user_permissions\", :force =&gt; true do |t|\nt.integer  \"user_id\"\nt.integer  \"permission_id\"\nt.integer  \"roles_mask\"\nt.datetime \"created_at\",    :null =&gt; false\nt.datetime \"updated_at\",    :null =&gt; false\nend\n\ncreate_table \"user_type_permissions\", :force =&gt; true do |t|\nt.integer  \"user_type_id\"\nt.integer  \"permission_id\"\nt.datetime \"created_at\",    :null =&gt; false\nt.datetime \"updated_at\",    :null =&gt; false\nend\n\ncreate_table \"user_types\", :force =&gt; true do |t|\nt.datetime \"created_at\", :null =&gt; false\nt.datetime \"updated_at\", :null =&gt; false\nend\n\ncreate_table \"users\", :force =&gt; true do |t|\nt.string   \"email\",                  :default =&gt; \"\", :null =&gt; false\nt.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\nt.string   \"reset_password_token\"\nt.datetime \"reset_password_sent_at\"\nt.datetime \"remember_created_at\"\nt.integer  \"sign_in_count\",          :default =&gt; 0\nt.datetime \"current_sign_in_at\"\nt.datetime \"last_sign_in_at\"\nt.string   \"current_sign_in_ip\"\nt.string   \"last_sign_in_ip\"\nt.datetime \"created_at\",                             :null =&gt; false\nt.datetime \"updated_at\",                             :null =&gt; false\nt.string   \"role\"\nend\n\nadd_index \"users\", [\"email\"], :name =&gt; \"index_users_on_email\", :unique =&gt; true\nadd_index \"users\", [\"reset_password_token\"], :name =&gt; \"index_users_on_reset_password_token\", :unique =&gt; true\nend\n</code></pre>\n\n<p>And the associations is as follows:</p>\n\n<pre><code>PERMISSION MODEL\n\nclass Permissions &lt; ActiveRecord::Base\nattr_accessible :action_name, :description, :id, :object_type, :user_id\nhas_many :users, :through =&gt; :user_type_permissions\nhas_many :users, :through =&gt; :user_permissions\nvalidates_presence_of \"object_type\", :action_name\nvalidates_uniqueness_of \"object_type\", :scope =&gt; [:action_name]\nend\n</code></pre>\n\n<p>User model is as follows:\n    class User &lt; ActiveRecord::Base\n     # Include default devise modules. Others available are:\n     # :token_authenticatable, :confirmable,\n     # :lockable, :timeoutable and :omniauthable</p>\n\n<pre><code> ROLES = %w[admin other]\n#  has_many :permissions, :through =&gt; :user_permissions \nbelongs_to :user_type_permissions\ndevise :database_authenticatable, :registerable,\n     :recoverable, :rememberable, :trackable, :validatable\n\n# Setup accessible (or protected) attributes for your model\nattr_accessible :email, :password, :password_confirmation, :remember_me, :role\n # attr_accessible :title, :body\n\n\n\ndef role?(role)\nreturn !!self.role.to_s.camelize\nend\n\n\nend\n</code></pre>\n\n<p>user_type_permission model is as follows:</p>\n\n<pre><code>class UserTypePermissions &lt; ActiveRecord::Base\nattr_accessible :id, :permission_id, :user_id\nhas_many :users\nhas_many :permissions\n\nend\n</code></pre>\n\n<p>article model is as follows:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  attr_accessible :name\nend\n</code></pre>\n\n<p>Ability class is as follows: </p>\n\n<pre><code>class Ability\ninclude CanCan::Ability\n\ndef initialize(user)\nuser ||= User.new # guest user\n\nif user.role? :admin\ncan :manage, Article\ncan :manage, User\nelse\nuser.user_type.permissions.each do |permission|\ncan permission.action_name.to_sym, permission.object_type.constantize\nend\nend\nend\nend\n</code></pre>\n\n<p>Permissions Controller is as follows:</p>\n\n<pre><code>class PermissionsController &lt; ApplicationController\n  def index\n    @permission=Permissions.all\n  end\n\n  def edit\n    @permission = Permissions.find(params[:id])\n  end\n\n  def update\n    @permission = Permissions.find(params[:id])\n    respond_to do |format|\n      if @permission.update_attributes(params[:article])\n        format.html { redirect_to @permission, notice: 'Permission was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @permission.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def show\n    @permission = Permissions.find(params[:id])\n  end\n\n  def destroy\n    @permission = Permissions.find(params[:id])\n    @permission.destroy\n\n    respond_to do |format|\n      format.html { redirect_to permissions_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>its working is like when the user login as as admin it will have the links of list of users and the list of articles when it click on the list of users link he will have the list of registered users with four link edit,show destroy and settings.Now what i want is when the admin click on the settings link of the particular user it will have the permissions of that user only.What i did was on the settings link i gave the permissions_path which displays the Permissions List which i dont want i want the permissions of the that particular user only...</p>\n\n<p>here is the view of the permission </p>\n\n<pre><code>&lt;h1&gt;Listing Permisions&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Id&lt;/th&gt;\n    &lt;th&gt;Object_type&lt;/th&gt;\n    &lt;th&gt;Action_name&lt;/th&gt;\n    &lt;th&gt;Description&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @permission.each do |permission| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= permission.id%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.object_type %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.action_name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.description %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', permission %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_permission_path(permission) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', permission, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>The problem with this permission view is that it is printing all the permissions in the permission model</p>\n\n<p>The users view is as given below:</p>\n\n<pre><code>&lt;h1&gt;Users&lt;/h1&gt;\n&lt;table&gt;\n  &lt;% @users.each do |user| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= link_to user.email, users_path %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', user %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_user_registration_path(user) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Settings', permissions_path %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>And one more thing when i go for the settings link it displays the List of Permissions and there is One Column in the table named User_id which is always NIL this means Permission model and user model is not associating properly. </p>\n\n<p>May be this is the problem  of association??</p>\n\n<p>Any help would be appreciated...\nThanks</p>\n"},{"tags":["ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":11880975,"title":"How to determine ActiveModel::Errors validation type","body":"<p>With the migration from Rails 2 to Rails 3 validation errors were moved from ActiveRecord::Error to ActiveModel::Errors.<br>\nIn rails 2 the validation error had a type and a message (among other things) and you could check the type of the validation error by doing something like the following:</p>\n\n<pre><code>rescue ActiveRecord::RecordInvalid =&gt; e\n  e.record.errors.each do |attr, error|\n    if error.type == :foo\n      do_something\n    end\n  end\nend\n</code></pre>\n\n<p>But with Rails 3 it seems everything but the invalid attribute and message has been lost.  As a result the only way to determine the type is to compare the error message:</p>\n\n<pre><code>rescue ActiveRecord::RecordInvalid =&gt; e\n  e.record.errors.each do |attr, error|\n    if error == \"foobar\"\n      do_something\n    end\n  end\nend\n</code></pre>\n\n<p>Which is not at all ideal (eg. what if you have several validations which use the same message?).</p>\n\n<p><strong>Question:</strong><br>\nIs there a better way in rails 3.0 to determine the type of validation error?</p>\n"},{"tags":["html","ruby","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":13134844,"title":"writing HTML in ruby","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/10561177/what-does-mean-in-ruby\">What does “&lt;&lt;-” mean in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>I saw this in devise_helper.rb</p>\n\n<pre><code>html = &lt;&lt;-HTML\n&lt;div&gt; ... &lt;/div&gt;\nHTML\n\nhtml.html_safe\n</code></pre>\n\n<p>what is this <code>&lt;&lt;-HTML .. HTML</code> notation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13123141,"title":"Giving specific id to FormTagHelper in rails","body":"<p>i've a form written in a <strong>HAML</strong> file  like this </p>\n\n<pre><code>= form_tag \"ratings_form\", movies_path, :method =&gt; :get do\n  Include: \n  - @all_ratings.each do |rating|\n    = rating \n    = check_box_tag \"ratings[#{rating}]\", 'yes', @ratings.keys.include?(rating)\n  = submit_tag 'Refresh'\n</code></pre>\n\n<p>and i want to give each of the <strong>Form</strong> and the <strong>Submit button</strong> a specific <strong>id</strong> </p>\n\n<p>i've checked the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html\" rel=\"nofollow\">documentation</a> and found that the parameters given to </p>\n\n<p><strong>form_tag</strong> or <strong>submit_tag</strong>  doesn't contain id .</p>\n\n<hr>\n\n<p>the correct answer is adding  :id => \"id_u_want\" to any tag and obviously it will work\nit worked when i did </p>\n\n<pre><code>= form_tag movies_path, :id =&gt; \"ratings_form\" , :method =&gt; :get do\n  Include: \n  - @all_ratings.each do |rating|\n    = rating \n    = check_box_tag \"ratings[#{rating}]\", 'yes', @selected_ratings.keys.include?(rating)\n  = submit_tag 'Refresh' , :id =&gt; \"ratings_submit\"\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ssl","configuration"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13130045,"title":"ERROR bad Request-Line - Force ssl - rails","body":"<p>I set force_ssl to true by accident and then when reverting to false and running server I get the following error: </p>\n\n<pre><code>ERROR bad Request-Line \n\nWEBrick 1.3.1\nINFO  ruby 1.9.3 (2012-02-16) [x86_64-darwin11.4.0]\nWEBrick::HTTPServer#start: pid=472 port=3000\nERROR bad Request-Line `\\x16\\x03\\x01\\x00?\\x01\\x00\\x00?\\x03\\x02P?Mf\\x00??C?'.\n</code></pre>\n\n<p>How can I fix this? </p>\n\n<p>When I hit http url on local host it redirects to https and gives me this error: </p>\n\n<pre><code>SSL connection error\nUnable to make a secure connection to the server. This may be a problem with the server, or it may be requiring a client authentication certificate that you don't have.\nError 107 (net::ERR_SSL_PROTOCOL_ERROR): SSL protocol error.\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":13121894,"title":"How do I avoid chains of method calls like @invoice.customer.address.street etc?","body":"<p>I have some models and have views code that look like the following</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :customer\nend\n\nclass Customer &lt; ActiveRecord::Base\n  has_one :address\n  has_many :invoices\nend\n\nclass Invoice &lt; ActiveRecord::Base\n  belongs_to :customer\nend\n</code></pre>\n\n<p>This code shows a simple invoice structure, with a customer who has a single address.\nThe view code to display the address lines for the invoice would be as follows:</p>\n\n<pre><code>&lt;%= @invoice.customer.name %&gt;\n&lt;%= @invoice.customer.address.street %&gt;\n&lt;%= @invoice.customer.address.city %&gt;,\n&lt;%= @invoice.customer.address.state %&gt;\n&lt;%= @invoice.customer.address.zip_code %&gt;\n</code></pre>\n\n<p>above view code is not ideal. For proper encapsulation, the\ninvoice should not reach across the customer object to the street attribute of the\naddress object. Because if, for example, in the future your application were to change\nso that a customer has both a billing address and a shipping address, every place in\nyour code that reached across these objects to retrieve the street would break and\nwould need to change. How can I avoid this problem ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":35,"score":-1,"question_id":13109872,"title":"why i lost radio button created by simple form when submit an form with error?","body":"<p>I have a form like this:  </p>\n\n<p><img src=\"http://s7.postimage.org/djw3k1hsr/new_question.png\" alt=\"new question\"></p>\n\n<p>When i submit form without any content, it shows errors:</p>\n\n<p><img src=\"http://s18.postimage.org/gkaqgv3qh/error_new_question.png\" alt=\"error new question\"></p>\n\n<p>The radio button is lost !</p>\n\n<p>This is in my form view:  </p>\n\n<pre><code>&lt;%= simple_form_for @question, defaults: { error: false } do |q| %&gt;\n\n  &lt;legend&gt;Question&lt;/legend&gt;\n  &lt;%= render \"shared/error_messages\", object: q.object %&gt;\n\n  &lt;%= q.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n  &lt;%= q.input :mark, input_html: { class: 'span1' } %&gt;\n  &lt;%= q.association :topic %&gt;\n  &lt;%= q.association :question_type %&gt;\n\n  &lt;%= q.simple_fields_for :answers do |a| %&gt;\n    &lt;%= a.input :correct, collection: [[true, 'True'], [false, 'False']],\n                                                            as: :radio_buttons,\n                                                            label: 'Answer',\n                                                            value_method: :first,\n                                                            label_method: :last,\n                                                            item_wrapper_class: 'inline'\n                                                            %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;  \n</code></pre>\n\n<p>What's i missed or wrong? I used <code>render 'new'</code> in my create action of Question controller when @question.save is false. This is my question controller:</p>\n\n<pre><code>class QuestionsController &lt; ApplicationController\n  def new\n    @question = Question.new\n    @question.answers.build\n  end\n\n  def create\n    @question = Question.new(content: params[:question][:content])\n    @question.mark = params[:question][:mark]\n    @question.topic_id = params[:question][:topic_id]\n    @question.question_type_id = params[:question][:question_type_id]\n    @question.user_id = current_user.id\n\n    if @question.save\n      if params[:question][:answers_attributes]['0'][:correct] == 'true'\n        answer = @question.answers.build(content: 'True')\n        answer.correct = true\n      else\n        answer = @question.answers.build(content: 'False')\n      end\n      if @question.save\n        flash[:success] = \"Successfully created new question.\"\n        redirect_to root_url\n      else\n        render 'new'\n      end\n    else\n      render 'new'\n    end\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13130017,"title":"Simple error in my rails app","body":"<p>I have an error in my rails app telling me that the index method is undefined.\nI have created a such simple form just for inserting data using the (new method page) only\nbut it is not working now for some reason</p>\n\n<pre><code>class PeoplesController &lt; ApplicationController\n\n  def index\n\n  end\n\n  def new\n    @people = People.new\n  end\n\n  def create\n    @people = People.new(params[:@people])\n    if @people.save\n      redirect_to new_people_path\n    end\n  end\nend\n\n\n# new.html.haml\n&lt;h2&gt;Hello there!&lt;/h2&gt;\n&lt;hr &gt;\n&lt;%= form_for @people do |f| %&gt;\n    FirstName:&lt;%= f.text_field :first %&gt;&lt;br /&gt;\n    LastName:&lt;%= f.text_field :last %&gt;&lt;br /&gt;\n    &lt;%= f.submit %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Here is the error code:</p>\n\n<pre><code>    NoMethodError in Peoples#new\n\nShowing /Users/kasim/Desktop/form/app/views/peoples/new.html.erb where line #3 raised:\n\nundefined method `people_index_path' for #&lt;#&lt;Class:0x007fa33da58d58&gt;:0x007fa34031c578&gt;\nExtracted source (around line #3):\n\n1: &lt;h2&gt;Hello there!&lt;/h2&gt;\n2: &lt;hr &gt;\n3: &lt;%= form_for @people do |f| %&gt;\n4:  FirstName:&lt;%= f.text_field :first %&gt;&lt;br /&gt;\n5:  LastName:&lt;%= f.text_field :last %&gt;&lt;br /&gt;\n6:  &lt;%= f.submit %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13092509,"title":"Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory","body":"<p>I am trying to execute rake db:create command. I get following error</p>\n\n<p>Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory.</p>\n\n<pre><code>Could not open library 'libcurl': libcurl: cannot open shared object file: No such file or directory.\nCould not open library 'libcurl.so': libcurl.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>Can anyone help me with this issue?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":3187,"score":1,"question_id":6843044,"title":"Rails 3 response headers","body":"<p>Wow, what a great site! I hope this question meets the requirements :-)</p>\n\n<p>Generally, this question is about how to set response headers in Rails when using the <code>render</code> method. Specifically, I have a markdown version of a document, which I would like the browser to save as a file by default, rather than display. I have found that you can set headers with the <code>head</code> method, like this:</p>\n\n<pre><code>respond_to do |format|\n  format.html {...\n  format.text { head(:content_disposition =&gt; \"attachment\") }\nend\n</code></pre>\n\n<p>But the options for <code>render</code> don't work like this and I can't find anything to access the headers beforehand from the controller. Could anybody offer advice?</p>\n\n<p>Thanks for taking the time to read my question.</p>\n"},{"tags":["ruby-on-rails-3","heroku","github","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13132265,"title":"github: retaining imgs uploaded using paperclip when pushing an update","body":"<p>I'm currently testing in staging environment (heroku) where I have testers uploading imgs for their profiles using paperclip. However, whenever I do a git push to heroku to update the site (not changing the db), their pictures disappear. Does anyone know why this is happening and how I can get around this?</p>\n\n<p>Here's my configuration for paperclip:</p>\n\n<pre><code> has_attached_file :photo, :styles =&gt; {:thumb =&gt; \"115x100#\", :medium =&gt; \"345x300#\", :large =&gt; \"690x600#\"},\n                        :path =&gt; \":rails_root/public/system/:attachment/:id/:style/:filename\",\n                        :url =&gt; \"/system/:attachment/:id/:style/:filename\"\n</code></pre>\n\n<p>production.rb config:</p>\n\n<pre><code>config.serve_static_assets = true\nconfig.assets.compile = false\n</code></pre>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","json","hash","reference","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13123762,"title":"Mongoid render referenced complete object","body":"<p>I am using mongoid 3 in a rails 3 application.</p>\n\n<p>I have a client class with referenced object 'files' (so instances of a custom 'LocalisedFile' class.)</p>\n\n<p>Client.rb:</p>\n\n<pre><code>class Client\n    include Mongoid::Document\n    include Mongoid::Timestamps\n    store_in collection: 'clients'\n\n    field :name, type: String\n\n    has_many :files, class_name: 'LocalisedFile', inverse_of: :owner\nend\n</code></pre>\n\n<p>LocalisedFile.rb:</p>\n\n<pre><code>class LocalisedFile\n    include Mongoid::Document\n    include Mongoid::Timestamps\n    include Geocoder::Model::Mongoid\n    store_in collection: 'files'\n\n    belongs_to :owner, class_name: 'Client', inverse_of: :files\nend\n</code></pre>\n\n<p>No problem to manage my documents.</p>\n\n<p>But when I want to render an array of files, I just get a \"owner_id\" field with the client string id...</p>\n\n<pre><code>[(2)\n    {\n        \"_id\": \"508e85e412e86a2607000005\",\n        \"created_at\": \"2012-10-29T13:34:29Z\",\n        \"owner_id\": \"508c06e4bcd7ac4108000009\",\n        \"title\": \"Try\",\n        \"updated_at\": \"2012-10-29T13:34:29Z\",\n    },-\n    {\n        \"_id\": \"508e8c5312e86a2607000006\",\n        \"created_at\": \"2012-10-29T14:01:56Z\",\n        \"owner_id\": \"508c06e4bcd7ac4108000009\",\n        \"title\": \"2nd Try\",\n        \"updated_at\": \"2012-10-29T14:01:56Z\",\n    }-\n]\n</code></pre>\n\n<p>That's maybe normal, but I would like to get the clients informations, to use it in a JS application with Google Maps API, like this :</p>\n\n<pre><code>[(2)\n    {\n        \"_id\": \"508e85e412e86a2607000005\",\n        \"created_at\": \"2012-10-29T13:34:29Z\",\n        \"owner\": {\n            \"_id\": \"508c06e4bcd7ac4108000009\",\n            \"name\": \"Client 1\"\n        },\n        \"title\": \"Try\",\n        \"updated_at\": \"2012-10-29T13:34:29Z\",\n    },-\n    {\n        \"_id\": \"508e8c5312e86a2607000006\",\n        \"created_at\": \"2012-10-29T14:01:56Z\",\n        \"owner\": {\n            \"_id\": \"508c06e4bcd7ac4108000009\",\n            \"name\": \"Client 1\"\n        },\n        \"title\": \"2nd Try\",\n        \"updated_at\": \"2012-10-29T14:01:56Z\",\n    }-\n]\n</code></pre>\n\n<p>Anyone have an idea ?\nI would like to test something like the to_hash method but it does not work...</p>\n"},{"tags":["ruby-on-rails-3","memcached","dalli"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":11199396,"title":"Rails.cache.fetch inserting extra values","body":"<p>We have a page which shows the top groups for our application. The calculation of the leader board is expensive so we cache the results for an hour as follows:</p>\n\n<pre><code>@groupboard = Rails.cache.fetch(\"top_groups\", :expires_in =&gt; 1.hour) do  \n  Group.top_groups\nend\n</code></pre>\n\n<p>This is giving an error after the cache has been written the first time. Poking around in the console I see that Group.top_groups returns an array of items that look as follows:</p>\n\n<pre><code>[#&lt;Group id: 4, name: \"IBP\", rank: 6, users_count: 13, leader_id: 4662&gt;, 3887]\n</code></pre>\n\n<p>When I look at the result returned from the cache it looks as follows:</p>\n\n<pre><code>[#&lt;Group id: 4, name: \"IBP\", rank: 6, users_count: 13, leader_id: 4662&gt;, :@new_record_before_save], false, 3887]\n</code></pre>\n\n<p>Does anyone know what would be causing @new_record_before_save and the 'false' value to be inserted into all the entries for this object in the cache?</p>\n\n<p>We are using Dalli, Memcached 1.4.9, Rails 3.2.4, Ruby 1.9.2</p>\n"},{"tags":["ruby-on-rails-3","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":11,"score":0,"question_id":13131845,"title":"Delayed Job character encoding issue","body":"<p>I swear this was working three hours ago when I got up from my desk. I'm using a gem called Vero that inserts some tracking data in a DJ queue to be posted to an email manager later. Now, it seems I get this error (only in development on SQLite):</p>\n\n<pre><code>ArgumentError in FrontController#index\n\ninvalid byte sequence in UTF-8\n</code></pre>\n\n<p>Not sure exactly what would've changed that this error is being thrown. Here's the log:</p>\n\n<pre><code>0.0ms)  begin transaction\n20:57:28 web.1  |   SQL (0.4ms)  INSERT INTO \"delayed_jobs\" (\"attempts\", \"created_at\", \"failed_at\", \"handler\", \"last_error\", \"locked_at\", \"locked_by\", \"priority\", \"queue\", \"run_at\", \"updated_at\") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [[\"attempts\", 0], [\"created_at\", Tue, 30 Oct 2012 00:57:23 UTC +00:00], [\"failed_at\", nil], [\"handler\", \"--- !ruby/struct:Vero::Jobs::RestPostJob\\nurl: http://www.getvero.com/api/v1/track.json\\nparams:\\n  :auth_token: E...1\\n  :development_mode: true\\n  :event_name: viewed_front_page\\n  :identity:\\n    :email: justin@domain.com\\n    :first_name: Justin\\n    :last_name: Mc\\n    :id: 3\\n    :location: Washington, District of Columbia\\n    :gender: male\\n    :_user_type: User\\n  :data:\\n    :link: http://boxfirepress.com\\n\"], [\"last_error\", nil], [\"locked_at\", nil], [\"locked_by\", nil], [\"priority\", 0], [\"queue\", nil], [\"run_at\", Tue, 30 Oct 2012 00:57:23 UTC +00:00], [\"updated_at\", Tue, 30 Oct 2012 00:57:23 UTC +00:00]]\n20:57:28 web.1  |    (0.7ms)  rollback transaction\n20:57:28 web.1  | Completed 500 Internal Server Error in 41ms\n20:57:28 web.1  | ArgumentError (invalid byte sequence in UTF-8):\n20:57:28 web.1  |   app/controllers/front_controller.rb:12:in `index'\n20:57:28 web.1  |   Rendered /Users/justin/.rvm/gems/ruby-1.9.3-p125@rails3-2/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/_trace.erb (3.0ms)\n20:57:28 web.1  |   Rendered /Users/justin/.rvm/gems/ruby-1.9.3-p125@rails3-2/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.0ms)\n20:57:28 web.1  |   Rendered /Users/justin/.rvm/gems/ruby-1.9.3-p125@rails3-2/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (5.9ms)\n</code></pre>\n\n<p>In the controller:</p>\n\n<pre><code>if current_user\n  current_user.track('viewed_front_page', {link: 'http://domain.com'})\nend\n</code></pre>\n\n<p>I use a near identical code in other controllers, and they're all throwing the same error now.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid","eager-loading"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12807228,"title":"Correctly eager loading empty array being ignored","body":"<p>I have a many-to-one relationship <code>images</code> on my <code>vehicle</code> model. I have set up a query similar to <code>Vehicle.includes(:images).find(ids)</code> Several, correctly, have an empty array loaded since these <code>vehicles</code> have no images. However, it goes back to the Mongo server, trying to find out if there are any images. The identity map is enabled and all that jazz. Eager loading seems to work for non-empty arrays.</p>\n\n<p>How would I signal to Mongoid that the empty array is correct and not to try and load them again?</p>\n"},{"tags":["mysql","sql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13125685,"title":"Merging rows with uniqueness constraints","body":"<p>I've got a little time-tracking web app (implemented in Rails 3.2.8 &amp; MySQL). The app has several users who add their time to specific tasks, on a given date. The system is set up so a user can only have 1 time entry (i.e. row) per task per date. I.e. if you add time twice on the same task and date, it'll add time to the existing row, rather than create a new one. The <code>user_id/task_id/date</code> uniqueness is enforced by a <code>UNIQUE</code> index.</p>\n\n<p>Now I'm looking to merge 2 tasks. In the simplest terms, merging task ID 2 into task ID 1 would take this</p>\n\n<pre><code>time  | user_id  | task_id  | date\n------+----------+----------+-----------\n10    | 1        | 1        | 2012-10-29\n15    | 2        | 1        | 2012-10-29\n10    | 1        | 2        | 2012-10-29\n5     | 3        | 2        | 2012-10-29\n</code></pre>\n\n<p>and change it into this</p>\n\n<pre><code>time  | user_id  | task_id  | date\n------+----------+----------+-----------\n20    | 1        | 1        | 2012-10-29 &lt;-- time values merged (summed)\n15    | 2        | 1        | 2012-10-29 &lt;-- no change\n5     | 3        | 1        | 2012-10-29 &lt;-- task_id changed (no merging necessary)\n</code></pre>\n\n<p>I.e. merge by summing the time values, where the given user_id/date/task combo would conflict.</p>\n\n<p>I figure I can use a unique constraint to do a <code>ON DUPLICATE KEY UPDATE ...</code> if I do an insert for every task_id=2 entry. But that seems pretty inelegant.</p>\n\n<p>I've also tried to figure a way to first update all the rows in task 1 with the summed-up times, but I can't quite figure that one out.</p>\n\n<p>Any ideas?</p>\n\n<hr>\n\n<p><strong>Update:</strong> Going off of Olaf's answer below, I came up with this, which seems to be working</p>\n\n<pre><code>INSERT INTO `timetable`\n(`time`, `user_id`, `task_id`, `date`)\n(\n    SELECT\n      SUM(`time`) AS `time`,\n      `user_id`,\n      1 AS `task_id`,\n      `date`\n    FROM `timetable` AS `t1`\n    WHERE `task_id` IN (1,2)\n    GROUP BY `user_id`, `date`\n)\nON DUPLICATE KEY UPDATE `time`=VALUES(`time`);\n\nDELETE FROM `timetable` WHERE `task_id`=2;\n</code></pre>\n\n<p>I'll leave the question open in case someone has a better solution (or if there are any gotchas in my solution that I should know about)</p>\n\n<p><strong>Update 2:</strong> Don't know why I didn't realize this earlier, but my solution may do a lot of redundant INSERTs, because it also finds all the entries that only exist in the target task and don't need merging. In the above example data, the 2nd row will be found, re-inserted, trigger an on-duplicate-key, and set the time to the same as it already is. So if the target task has, say, 10 rows, and the source task 0 rows, it'll still do 10 (completely pointless) INSERTs.</p>\n\n<p>This can be avoided by wrapping the inner SELECT everything in yet another SELECT, and use <code>COUNT(*)</code> to only find those rows that need merging. Of course, this will necessitate another more queries to update the task_id of those rows that <em>don't</em> need merging (which requires a join to figure out, as far as I can tell).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13127206,"title":"Ensuring at least one item in an array exists in another","body":"<p>I have the following models:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n    has_and_belongs_to_many :countries\nend\n\nclass User &lt; ActiveRecord::Base \n    has_many :entitlements\n    has_many :countries, :through =&gt; :entitlements\nend\n</code></pre>\n\n<p>Posts on the Post index page must have at least one country that is the same as one of the Users' countries.</p>\n\n<p>I have tried various scopes in my models and lengthy controller code but I can't figure out how to check what should be a simple relationship: whether at least one item in Post.countries exists in User.countries.</p>\n\n<p>Any help greatly received.</p>\n\n<p><strong>UPDATED:</strong></p>\n\n<p>Ok, so I've got the following in my controller:</p>\n\n<pre><code>  def index\n    @user = current_user\n    @user.countries.each do |user_country|  \n       @user_country_posts += Country.find(user_country.id).posts\n    end\n    @posts = @user_country_posts\n  end\n</code></pre>\n\n<p>Which is iterating through the user.countries and finding each post for those countries. But when I run it I get:</p>\n\n<pre><code>NoMethodError: undefined method `+' for nil:NilClass\n</code></pre>\n\n<p>Any ideas what I'm doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":962,"score":3,"question_id":6009062,"title":"Remove test::unit","body":"<p>I forgot to create my application with the -T argument and now it's installed with test::unit. How do I remove test::unit and stop it from creating tests for each controller / model generated, after I have already created the application? Thank you</p>\n"},{"tags":["ruby-on-rails-3","ssl","rack"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13130867,"title":"Passing an exclude option to Rack::SSL","body":"<p>Following the guidance <a href=\"http://www.simonecarletti.com/blog/2011/05/configuring-rails-3-https-ssl/\" rel=\"nofollow\">here</a>, updated for Rails 3.2.x, I expected to be able to configure Rack::SSL to use the SSL filters only if an <code>https://</code> prefix is included:</p>\n\n<pre><code>config.force_ssl = true\nconfig.ssl_options = { :exclude =&gt; proc { |env| puts 'here? ' + env.to_s; env['HTTPS'] != 'on' } }\n</code></pre>\n\n<p>However, <code>https</code> works, where <code>http</code> fails with the following error:</p>\n\n<pre><code>[2012-10-29 15:37:03] ERROR OpenSSL::SSL::SSLError: SSL_accept returned=1 errno=0 state=SSLv2/v3 read client hello A: http request\n    /Users/user/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/openssl/ssl-internal.rb:164:in `accept'\n</code></pre>\n\n<p>The diagnostic code inserted into the lambda is not executed.  How can I configure Rack:SSL in Rails 3.2.x to respond to both HTTP and HTTPS?</p>\n\n<p>Rails 3.2.8, WEBrick configured for SSL using a self-signed cert.</p>\n"},{"tags":["ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":109,"score":3,"question_id":12943284,"title":"How to detect failing unit test using rake","body":"<p>I am using Ruby 1.9.3 and Rails 3.2.8. This uses rake 0.9.2.2.</p>\n\n<p>I wish to detect a failing unit test and, in Rails 2.3, we did this by checking the exit code. This no longer works.</p>\n\n<p>I try:</p>\n\n<pre><code>rake test:units TEST=test/unit/failing_test.rb RAILS_ENV=test &amp;&amp; echo \"OK\"\n</code></pre>\n\n<p>failing_test.rb consists of a single test which asserts false. I expect to see a test failure and not to see \"OK\", but instead, I see:</p>\n\n<pre><code>Started\nF\n===============================================================================\nFailure: &lt;false&gt; is not true.\ntest: failing test case should fail. (FailingTest)\ntest/unit/failing_test.rb:6:in `block (2 levels) in &lt;class:FailingTest&gt;'\nshoulda-context (1.0.0) lib/shoulda/context/context.rb:398:in `call'\nshoulda-context (1.0.0) lib/shoulda/context/context.rb:398:in `block in create_test_from_should_hash'\nactivesupport (3.2.8) lib/active_support/testing/setup_and_teardown.rb:72:in `block in run'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:425:in `_run__3774233495015181374__setup__985181848351195933__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_setup_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactivesupport (3.2.8) lib/active_support/testing/setup_and_teardown.rb:70:in `run'\n===============================================================================\n\n\nFinished in 0.002753 seconds.\n\n1 tests, 1 assertions, 1 failures, 0 errors, 0 pendings, 0 omissions, 0 notifications\n0% passed\n\n363.24 tests/s, 363.24 assertions/s\nrake aborted!\nCommand failed with status (1): [/Users/chris/.rvm/rubies/ruby-1.9.3-p194/b...]\n\nTasks: TOP =&gt; test:units\n(See full trace by running task with --trace)\nOK\n</code></pre>\n\n<p>Specifically, I see \"Command failed with status (1)\", but this seems to get eaten up by rake as I also see \"OK\". Note that if I do <code>echo $?</code>, I see the exit code is 0 (success). I'm trying to get this to work in the context of our continuous integration and also with our release script, both of which assume the exit code will be non-zero in the case of an error, as happened with Rails 2.3.</p>\n"},{"tags":["ruby-on-rails-3","controller","before-filter","rescue"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13130684,"title":"rails if else check fails then rescue","body":"<p>I have 2 methods in my controller for finding the user (notice the <code>enabled_only</code> scope):</p>\n\n<pre><code>before_filter :find_user, :only =&gt; :show\nbefore_filter :find_any_user, :only =&gt; [:edit, :update, :destroy]\n\ndef find_user\n  @user = User.enabled_only.find(params[:id])\nrescue ActiveRecord::RecordNotFound\n  flash[:alert] = \"The user you were looking for could not be found\"\n  redirect_to root_path\nend\n\ndef find_any_user\n  @user = User.find(params[:id])\nrescue ActiveRecord::RecordNotFound\n  flash[:alert] = \"The user you were looking for could not be found\"\n  redirect_to root_path\nend\n</code></pre>\n\n<p>Surely these could be merged into one method that checks whether <code>:action == 'show'</code> but I couldn't get the rescue to catch the error. I tried something like the following but it didn't work:</p>\n\n<pre><code>before_filter :find_user, :only =&gt; [:show, :edit, :update, :destroy]\n\ndef find_user\n  @user = if :action == 'show'\n    User.enabled_only.find(params[:id])\n  else\n    User.find(params[:id])\n  end\nrescue ActiveRecord::RecordNotFound\n  flash[:alert] = \"The user you were looking for could not be found\"\n  redirect_to root_path\nend\n</code></pre>\n\n<p>Please advise on how this can be done.</p>\n\n<p>Thanks</p>\n"}]}
{"total":34674,"page":9,"pagesize":100,"questions":[{"tags":["ruby-on-rails","sms","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1622,"score":1,"question_id":4652755,"title":"send free sms from rails app","body":"<p>How can i send free sms to US numbers from a rails app. </p>\n\n<p>Is <a href=\"https://github.com/brendanlim/sms-fu\" rel=\"nofollow\">sms_fu</a> working with rails 3?</p>\n\n<p>Its not working for me :--\nAfter installing the gem.</p>\n\n<p>Steps:-\nSpecified this in my environment file</p>\n\n<pre><code> 1. sms_fu = SMSFu::Client.configure(:delivery =&gt; :action_mailer)\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>2.sms_fu.deliver(\"5558675309\",\"at&amp;t\",\"message\") is not working\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","osx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13129536,"title":"Cannot install rails on mac","body":"<p>I've been trying to install rails on my macbook, and have been having so much difficulty!\nI installed RVM, and when I run \"gem install rails,\" I get this message: </p>\n\n<pre><code>gem install rails\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rails:\n    ERROR: Failed to build gem native extension.\n\n    /Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/bin/ruby extconf.rb\ncreating Makefile\n\nmake\n/usr/bin/gcc-4.2 -I. -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1/x86_64-darwin11.4.0 -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1/ruby/backward -I/Users/stephanie/.rvm/rubies/ruby-1.9.2-p320/include/ruby-1.9.1 -I. -DJSON_GENERATOR -I/Users/mpapis/.rvm/usr/include -D_XOPEN_SOURCE -D_DARWIN_C_SOURCE   -fno-common -I/opt/sm/pkg/active/include -fno-common -pipe -O3 -Wall -O0 -ggdb  -o generator.o -c generator.c\n/usr/bin/gcc-4.2 -dynamic -bundle -o generator.bundle generator.o -L. -L/Users/mpapis/.rvm/rubies/ruby-1.9.2-p320/lib -L/Users/mpapis/.rvm/usr/lib -L. -L/opt/sm/pkg/active/lib -L/usr/local/lib -Wl,-undefined,dynamic_lookup -Wl,-multiply_defined,suppress -Wl,-flat_namespace  -lruby.1.9.1  -lpthread -ldl -lobjc \nld: warning: directory not found for option '-L/Users/mpapis/.rvm/rubies/ruby-1.9.2-p320/lib'\nld: warning: directory not found for option '-L/Users/mpapis/.rvm/usr/lib'\nld: warning: directory not found for option '-L/opt/sm/pkg/active/lib'\nld: library not found for -lruby.1.9.1\ncollect2: ld returned 1 exit status\nmake: *** [generator.bundle] Error 1\n</code></pre>\n\n<p>I've tried googling solutions, but haven't found anything. Does anyone have ideas? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13129951,"title":"How can I access rails methods in a ruby script?","body":"<p>I have a ruby script in my rails app in the script directory. How can I access the <code>in_time_zone</code> method in the script?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","encoding","chardet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13129852,"title":"How do i encode files for rails 3?","body":"<p>I've been working on outlook imports (linked in exports to outlook format) but I'm having  troubles with encoding. The outlook format CSV i get from exporting my linkedin contacts are not in UTF-8 so letters like ñ are causing an exception in the mongoid_search gem when str.to_s.mb_chars.normalize is being called. I've deduced that this is because when a string is returned by mb_chars (when ruby 1.9 is used as per the docs: <a href=\"http://apidock.com/rails/String/mb_chars\" rel=\"nofollow\">http://apidock.com/rails/String/mb_chars</a> just below first code example). I guess this is a bug in the gem but regardless i am advised to sanitize the data no matter. My implementation(s) thus far:</p>\n\n<p>File Picker using their new community supported gem to upload csv. I tried three encoding detectors ( and transcoders):</p>\n\n<p>ruby port of a python lib chardet - basically sucked, had python code leftover that prevented it from even running in my app</p>\n\n<p>rchardet19 gem - detected iso-8859 with .8/1 confidence. I then tried to transcode with Iconv. Crashed on \"illegal characters\" at a ñ</p>\n\n<p>a gem Charlock_Holmes (https://github.com/brianmario/charlock_holmes). This detected windows-1252 with 33/100 confidence (i assume thats what is actually is and rchardet got iso-8859 because this ones based of that). This gem uses ICU and has a maintained branch \"bundle-icu\" which supposedly allows it to work on heroku. When i try to transcode using charlock, i get a U_FILE_ACCESS_ERROR. It is a icu error code meaning \"could not open file\" </p>\n\n<p>Anybody know what to do here?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13124575,"title":"How to maintain an order on child records when using Rails' accepts_nested_attributes_for feature?","body":"<p>I am using Rails' nifty <code>accepts_nested_attributes_for</code> for creating <code>invoices</code> and their <code>items</code>. <code>Items</code> can be added dynamically to an <code>invoice</code> with jQuery.</p>\n\n<pre><code>class Invoice &lt; ActiveRecord::Base\n  attr_accessible :project_id, :number, :date, :recipient, :items_attributes\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>This works fine. Except for the <strong>order</strong> in which Rails saves the <code>items</code>.</p>\n\n<p>For example when I create an <code>invoice</code> with these 5 <code>items</code>...</p>\n\n<pre><code>A\nB\nC\nD\nE\n</code></pre>\n\n<p>... everything works fine. But when I then hit <code>Create</code> to save the invoice plus items to the database, the order is completely randomised, for example like this:</p>\n\n<pre><code>D\nA\nC\nE\nB\n</code></pre>\n\n<p>A peek into my database and the <code>created_at</code> column of my <code>items</code> table revealed that Rails (or SQLite?) seemingly saves the <code>items</code> in a random order and not in the order in which I (as a user) added them to the <code>invoice</code>.</p>\n\n<p>Is this normal behaviour and if so how can I maintain a proper ordering on the <code>items</code> that I add to my <code>invoice</code>?</p>\n\n<p>Thanks for any help...</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13129752,"title":"How can I allow multiple Date formats in Ruby on Rails for csv file import?","body":"<p>I have a birthday column in my csv that should allow user to input <strong>multiple date formats</strong> and then the file be imported via web page. At the moment the column is only set to one type of format; <code>:birthday =&gt; (Date.strptime(row[2], \"%mm/%dd/%YY\") rescue nil),</code>.\nIs it possible to have multiple date formats?\nThanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","declarative-authorization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13113094,"title":"Why the :attribute_check in Declarative_Authorization don't found ID's","body":"<p>I have a problem since many days with Declarative_Authorization on Ruby on Rails 3.1.\nI add this on the top of each controller :</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n\n    # Verifies that the user is connected and/or authorized to access the methods\n    filter_access_to :all, :attribute_check =&gt; true\n\n    (...)\nend\n</code></pre>\n\n<p>It allows me to have this on my <code>authorization_rules.rb</code>:</p>\n\n<pre><code>has_permission_on [:albums], :to =&gt; [:adding] do\n    if_attribute :group =&gt; { :user =&gt; is { user } }\nend\n</code></pre>\n\n<p>But when I add <code>:attribute_check =&gt; true</code> I get this error :</p>\n\n<pre><code>Couldn't find {Model} without an ID\n</code></pre>\n\n<p>I'm totally lost, I was starting with this gem.</p>\n"},{"tags":["ruby-on-rails-3","rspec","rspec2","testunit"],"answer_count":2,"favorite_count":6,"up_vote_count":16,"down_vote_count":0,"view_count":2162,"score":16,"question_id":6728618,"title":"How can I tell Rails to use RSpec instead of test-unit when creating a new Rails app?","body":"<p>I have <code>test-unit</code> installed and <code>rspec</code> installed (along with <code>-core</code>, <code>-expectations</code>, <code>-mocks</code> and <code>-rails</code> version 2.6.x). When I run the command <code>rails new foo</code>, it uses <code>test-unit</code> to generate the test stub files instead of <code>rspec</code>.</p>\n\n<p>Is there an option where I can tell rails to use rspec to generate the tests instead?</p>\n"},{"tags":["ruby-on-rails-3","activemodel"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":150,"score":1,"question_id":8936906,"title":"What's the correct way to make before_validation, etc. work in an ActiveModel","body":"<p>Should I extend or include <code>ActiveModel:Validations:Callbacks:ClassMethods</code> or <code>ActiveModel:Validations:Callbacks</code>?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip","production-environment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":1340,"score":-1,"question_id":6904797,"title":"Paperclip in production mode","body":"<p>I am successfully running my Ruby on Rails 3.0.9 application in production mode on a <a href=\"http://www.linode.com/\" rel=\"nofollow\">Linode</a> VPS. The only problem that I have is related to the Paperclip gem: it works in development mode on my local machine (this has Mac Os, Snow Leopard) but it doesn't work on the remote machine in production mode (this has Ubuntu 10.04 LTS).</p>\n\n<p>I made some research on the net and I tried to solve that problem following <a href=\"http://stackoverflow.com/questions/1635840/probem-with-paperclip-accepting-jpg-and-png-on-production\">this solution</a>:</p>\n\n<blockquote>\n  <p>On your production server, try running:</p>\n  \n  <p>which identify</p>\n  \n  <p>...</p>\n  \n  <p>If it returns something like \"/usr/bin/identify\", then you'll want to\n  set the Paperclip options in your production.rb environment file to:</p>\n  \n  <p>Paperclip.options[:command_path] = \"/usr/bin\"</p>\n</blockquote>\n\n<p>Since I get the <code>/usr/bin/identify</code>, in my environment files I have the following scenario:</p>\n\n<pre><code># `config/environments/development.rb`\nPaperclip.options[:command_path] = \"/usr/local/bin\"\n\n# `config/environments/production.rb`\nPaperclip.options[:command_path] = \"/usr/bin\"\n</code></pre>\n\n<p>Anyway in production mode Paperclip doesn't work. In development it works.</p>\n\n<p><strong>How can I solve the problem?</strong></p>\n\n<hr>\n\n<p>Following are some output:</p>\n\n<pre><code>&gt;&gt; $ &lt;project_name&gt; bundle show paperclip\n=&gt; /usr/local/lib/ruby/gems/1.9.1/gems/paperclip-2.3.16\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rest"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12807901,"title":"Should a Rails 3 RESTful PUT call return the JSON representation of the updated resource?","body":"<p>To be most compatible with practice RESTful service development and existing Javascript MVC frameworks like AngularJS and Ember.js that would be used to integrate with a RESTful service, should a resource be deserialized to JSON from a RESTful PUT call that just updates a resource?</p>\n\n<p>For example, Rails 3.2.8 seems to promote just using <code>respond_with @foobar.update_attributes(...)</code> which just returns an HTTP status code 204. However, you can specify that you want respond_with or respond_to to return the resource.</p>\n\n<p>But, this means that another call must be made to get the resource to get any updates that may have occurred on the resource in addition to the ones that were specified in the PUT call. On one hand it is nice not to have anything returned, because you may not care if it has changed, and this isn't like POST in which you are creating a new resource and may want a full representation with the new id. However, having to make another GET call to get the updated resource following the PUT, though nice that it is intentional, is additional overhead (i.e. for a PUT where you need the updated resource, you would have to PUT and then GET).</p>\n\n<p>I understand that REST leaves a lot open as to implementation, but I'd like to understand what people agree is a good practice with regard to this, at least as of October 2012 in the stated context of being used by AngularJS and Ember.js, and why.</p>\n"},{"tags":["ruby-on-rails-3","html5","jquery-ui","twitter-bootstrap","html5boilerplate"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":195,"score":2,"question_id":13118568,"title":"When to use Twitter Bootstrap and when to HTML5 Boilerplate?","body":"<p>I am pretty bad with CSS and HTML5 designing/templates. So, I google around and found two frameworks to start with nice looking layouts, necessary js and html5 support. But I don't know which on to use. </p>\n\n<p>I would appreciate your answers on </p>\n\n<ol>\n<li><p>What is the main different between two except google analytics  ?</p></li>\n<li><p>Which one is more rails friendly ?</p></li>\n<li>Which one fits best to e-commerce sites, i.e. create rich content, integrate with user management frameworks  etc?</li>\n</ol>\n"},{"tags":["ruby-on-rails-3","json","pretty-print","jbuilder"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13128485,"title":"Pretty Print JSON generated with a jbuilder template in Rails 3.2.8","body":"<p>Anyone have a way to pretty print JSON output from jbuilder? </p>\n\n<p>I can pretty print JSON generated within a controller action with something like:</p>\n\n<pre><code>JSON.pretty_generate(some_json_object) \n</code></pre>\n\n<p>but once I pass off to a jbuilder template, I'm not aware of a way to have that output pretty printed.</p>\n\n<p>Right now, my action method's render statement is simple:</p>\n\n<pre><code>render formats: :json    \n</code></pre>\n\n<p>And this successfully forces a rendering with jbuilder, regardless of input format type specified (which is my desired behavior).</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13128151,"title":"Migration files in Rails","body":"<p>I am creating a model in rails (3.2.3) and am defining what columns are to be included (hope thats correct)</p>\n\n<p>for example my first entry is</p>\n\n<pre><code> t.string :Dish_Name\n</code></pre>\n\n<p>My first question is can I use that syntax i.e. Dish_Name ?</p>\n\n<p>My second question is I want to use dropdowns to select options from the input field, so for exampel i would like to have a \"Country of origin\" with multiple options, countries of the world.</p>\n\n<p>Would it be better to have a separate DB with all the countries in and then pull in the data from the dropdown? If so could someone point me in the right direction to see how to do this? not necessarily looking for the answer just a good place to start looking</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ssl","heroku","github"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13127837,"title":"SSL, Github, and Heroku -- is pushing secure?","body":"<p>I just bought an SSL certificate for my Heroku-deployed app. Following <a href=\"https://devcenter.heroku.com/articles/ssl-certificate\" rel=\"nofollow\">their instructions</a>, I downloaded the certificate and private key, saved them in server.crt and server.key files (with some RapidSSL CA deal thrown in there), and am now planning on pushing and deploying. The worry is, my github repo is public, and I feel like it's a bad idea to push my \"private\" keys and certificates to a public site. Sort of defeats the purpose of the SSL, right?</p>\n\n<p>But how else do I get it to work without publishing this info? I'm new to SSL and coding, and I just very much do not want to throw away the security I just spent good money on because I don't understand how this all works. </p>\n\n<p>Sorry if this question wasn't very code-y. Just didn't know where better to ask.</p>\n\n<p>EDIT -- I'm looking at Heroku docs right now that say to add a Heroku SSL Add-On, and then just type </p>\n\n<pre><code>heroku certs:add server.crt server.key\n</code></pre>\n\n<p>to get heroku to pick up on the files and use the SSL Certificate. But that doesn't change the problem that I have two files in my PUBLIC repo with PRIVATE security info. Do I just add them to .gitignore or something?</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","kaminari"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13128002,"title":"How to set up \"Next 10\" and \"Prev 10\" in Kaminari","body":"<p>I am trying to step through a large set of Clients using Kaminari.\nThus far I just do this in index.html.erb:</p>\n\n<pre><code>&lt;%= paginate @clients, :outer_window =&gt; 3 %&gt;\n</code></pre>\n\n<p>which results in:</p>\n\n<pre><code>1 2 3 4 5 ... 588 589 590 Next Last\n</code></pre>\n\n<p>where \"Next\" just advances to the next one.</p>\n\n<p>I would like to get something like this (roughly)</p>\n\n<pre><code>1 2 3 4 5 ... 15 25 35 ...\n</code></pre>\n\n<p>so that the user can step through faster than one at a time. I see \"Kaminari themes\" in the documentation, but couldn't work out how to use it. Thanks...</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-graph-api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13127849,"title":"Rails3 unable to connect to facebook graph","body":"<p>im trying to connect to facebook graph to send a notification to user upon friend request</p>\n\n<p>open(URI.encode(\"https://graph.facebook.com/#{@user.uid}/notifications?access_token=#{ENV['FACEBOOK_KEY']}|#{ENV['FACEBOOK_SECRET']}&amp;template=You have a friend request&amp;href=\"))</p>\n\n<p>returns OpenURI::HTTPError (400 Bad Request) which is bad. Please do note that all other variables are declared properly.</p>\n\n<p>If i edit the url to open(URI.encode(\"https://graph.facebook.com/#{@user.uid}/\")), it works!!!</p>\n\n<p>i'm suspecting that they encode the | which cost the problem, but if i just do a open(\"\") it returns invalid url.</p>\n\n<p>please help, tqvm</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","refactoring"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13127582,"title":"Rails Refactoring: Custom Method & Heavy View","body":"<p>My code current works just fine, but I can tell that it could be done better.  So I figured I would ask for some input.</p>\n\n<p>For a given expense, the user can submit, or un-submit.  This creates a record in the expense_approvals table, and sets the approval_status to 1 or 0.</p>\n\n<p>The complexity comes when someone un-submits an expense, and then later resubmits it, since the record already exists, I had to put in the logic to handle it, and a very ugly view to go with it.</p>\n\n<p>My gut tells me there are things I can do in the model, and/or controller to make this much cleaner.</p>\n\n<p>So my model looks like this:</p>\n\n<pre><code>class Expense &lt; ActiveRecord::Base\n  attr_accessible :amount, :expense_date, :description\n\n  has_one :expense_approval\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class ExpenseApproval &lt; ActiveRecord::Base\n  attr_accessible :approval_date, :approval_status, :approver_id, :expense_id\n\n  belongs_to :expense, foreign_key: :expense_id\n\n  validates_uniqueness_of :expense_id\nend\n</code></pre>\n\n<p>and the controller</p>\n\n<pre><code>def submit_expense\n  @expense_list = Expense.all  \n  expense = Expense.find(params[:id])\n\n  if expense.expense_approval\n    approval = ExpenseApproval.find(expense.expense_approval.id)\n    approval.approval_status = 1\n  else\n    approval = ExpenseApproval.new(approval_status: \"1\", expense_id: expense.id)\n  end\n\n  if approval.save\n    #flash[:success] = \"You have added an submission.\"\n    redirect_to expense_approvals_path\n  else\n    flash[:error] = \"Error\"    \n    redirect_to expense_approvals_path\n  end\nend\n\ndef un_submit_expense\n  @expense_list = Expense.all  \n  @expense = ExpenseApproval.find(params[:id])\n  @expense.approval_status = 0\n\n  if @expense.save\n    #flash[:success] = \"You have un submitted.\"\n    redirect_to expense_approvals_path\n  else\n    flash[:error] = \"Unsubmit Error\"    \n    redirect_to expense_approvals_path\n  end\nend\n</code></pre>\n\n<p>and view</p>\n\n<pre><code> &lt;% if expense_item.expense_approval %&gt;\n              &lt;%#=expense_item.expense_approval.approval_status%&gt;\n\n              &lt;% if expense_item.expense_approval.approval_status == 1 %&gt;\n                        &lt;%= link_to raw('&lt;i class=\"icon-arrow-down icon-white\"&gt; &lt;/i&gt;'), \n                              un_submit_expense_path(expense_item.expense_approval[:id]),\n                              class: \"btn btn-mini btn-warning\", \n                              :confirm =&gt; \"Are you sure you want to un submit this expense?\" %&gt;\n              &lt;% end %&gt;\n\n              &lt;% if expense_item.expense_approval.approval_status == 0 %&gt;\n                        &lt;%= link_to raw('&lt;i class=\"icon-arrow-up icon-white\"&gt; &lt;/i&gt;'), \n                              submit_expense_path(expense_item[:id]),\n                              class: \"btn btn-mini btn-info\", \n                              :confirm =&gt; \"Are you sure you want to submit this expense?\" %&gt;\n              &lt;% end %&gt;\n\n            &lt;% else %&gt;\n\n             &lt;%= link_to raw('&lt;i class=\"icon-arrow-up icon-white\"&gt; &lt;/i&gt;'), \n                              submit_expense_path(expense_item[:id]),\n                              class: \"btn btn-mini btn-info\", \n                              :confirm =&gt; \"Are you sure you want to submit this expense?\" %&gt;\n\n            &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing","tdd","dry"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13124410,"title":"Rails: Repeating unit test - DRY?","body":"<p>Is there any standard practice to DRY-out the repeating unit test cases in rails. For e.g. I have many models with the \"name\" attribute, I want to do same kind of unit tests for each model. I vaguely see that i need to create modules are reuse? Is that possible/correct?</p>\n\n<p>Any pointers/practice to creating DRY unit test? </p>\n\n<p><strong>Example code:</strong> I want to do same kind of testing for many other models with the same named attribute.</p>\n\n<pre><code>require 'test_helper'\n\n\n# Factory class\nclass UserFactory\n\n  # Creates a valid template user\n  def self.create\n    user = User.new do |u|\n      u.name = \"Test User #{rand}\"\n      u.notes = \"test notes\"\n    end\n    user\n  end\n\nend\n\nclass UserTest &lt; ActiveSupport::TestCase\n  # ------------\n  # Init\n  # ------------\n\n  def setup\n    @valid_usr = UserFactory.create\n  end\n\n  def teardown\n    @valid_usr.destroy if @valid_usr.persisted?\n    @valid_usr = nil\n  end\n\n\n  # ------------\n  # Name\n  # ------------\n\n  test \"should not have a dummy user object\" do\n    user = User.new\n    assert !user.save\n  end\n\n  test \"unique user name must be saved\" do\n    assert UserFactory.create.save!, \"First entry must be saved\"\n\n    user = UserFactory.create\n    user.name = \"Different name\"\n    assert user.save!, \"Unique user must be saved\"\n    user.destroy\n  end\n\n  test \"non unique user names must not be saved\" do\n    user1 = UserFactory.create\n    user2 = UserFactory.create\n    user1.name = \"Same User name\"\n    user2.name = \"Same User name\"\n\n    assert user1.save!, \"First entry must be saved\"\n    assert !user2.save, \"Duplicate name should not be saved\"\n\n    user1.destroy\n    user2.destroy\n  end\n\n  test \"should not have user without a valid name\" do\n    # Invalid name\n    @valid_usr.name = \" \"\n    assert !@valid_usr.save\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13124024,"title":"How to get a nested child record to know stuff about its parent during instantiation in Ruby on Rails?","body":"<p>I have a form for creating a new <code>invoice</code> with many <code>items</code>. </p>\n\n<pre><code>class Invoice &lt; ActiveRecord::Base\n  attr_accessible :project_id, :number, :date, :recipient, :items_attributes\n  accepts_nested_attributes_for :items\nend\n</code></pre>\n\n<p>Now when I instantiate a new <code>invoice</code> and a set of containing <code>items</code>, I want these <code>items</code> to <em>know</em> something about the <code>invoice</code> they belong to even before they are saved, so I can do something like this in my <code>Item</code> model:</p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n  belongs_to :invoice\n  after_initialize :set_hourly_rate\n\n  private \n\n    def set_hourly_rate\n      if new_record?\n        self.price ||= invoice.project.hourly_rate\n      end\n    end   \n\nend\n</code></pre>\n\n<p>Right now, my code fails because the child (<code>item</code>) doesn't know anything about its parent (<code>invoice</code>) during instantiation. Only after saving the <code>invoice</code> (and thus its nested <code>items</code>), it all works out. But I want to set a default value on each new item even <strong>before</strong> it gets saved.</p>\n\n<p>How can this be done?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13126798,"title":"Handling nested JSON in Rails without accepts_nested_attributes_for","body":"<p>I am building a Rails application to provide a JSON API to a Backbone.js frontend.</p>\n\n<p>We have a number of cases where we provide data similar to <code>label: { id: 1, name: \"My Label\" }</code>. When this is used in a select box within a form (to specify an association) we currently need to specify <code>label_id: 1</code> in posted data. We'd like the API to be more symmetrical and support the nested <code>label: { id: 1 }</code> form if possible.</p>\n\n<p>So far, I (not surprisingly) get a <code>ActiveRecord::AssociationTypeMismatch</code> error as Rails is expecting a <code>Label</code> object and receives a <code>ActiveSupport::HashWithIndifferentAccess</code> instead. I understand we can use <code>accepts_nested_attributes_for</code> if we want to support nested modification of the labels, but in this case I only want to use the nested form to specify the correct label for the association.</p>\n\n<p>Is there a good way to do this in Rails (3.2.8) that doesn't involve modifying the params hash before passing it off to the model? If not, any recommendations for the best way to robustly transform the params as they come in?</p>\n\n<p>Here's the current code I use to flatten out the params in case it is of help:</p>\n\n<pre><code>def flatten_params(hash)\n  hash.reduce({}) do |memo, (key, value)|\n    if value.class == ActiveSupport::HashWithIndifferentAccess\n      memo[(key.to_s + '_id').to_sym] = value['id']\n    else\n      memo[key] = value\n    end\n    memo\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","plugins","code-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13127203,"title":"Who is responsible of generating the .idea files in Rails?","body":"<p>When I'm looking on my Rails application folder i can find a <strong>.idea</strong> folder, it includes: </p>\n\n<ul>\n<li>.generators</li>\n<li>.rakeTasks</li>\n</ul>\n\n<p>And more... When i open <strong>.generators</strong> for example, i see the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Settings&gt;&lt;!--This file was automatically generated by Ruby plugin.\nYou are allowed to: \n1. Reorder generators\n2. Remove generators\n3. Add installed generators\nTo add new installed generators automatically delete this file and reload the project.\n--&gt;&lt;GeneratorsGroup&gt;&lt;Generator name=\"active_record:migration\" /&gt;&lt;Generator name=\"active_record:model\" /&gt;&lt;Generator name=\"active_record:observer\" /&gt;&lt;Generator name=\"active_record:session_migration\" /&gt;&lt;Generator name=\"controller\" /&gt;&lt;Generator name=\"erb:controller\" /&gt;&lt;Generator name=\"erb:mailer\" /&gt;&lt;Generator name=\"erb:scaffold\" /&gt;&lt;Generator name=\"generator\" /&gt;&lt;Generator name=\"helper\" /&gt;&lt;Generator name=\"integration_test\" /&gt;&lt;Generator name=\"mailer\" /&gt;&lt;Generator name=\"metal\" /&gt;&lt;Generator name=\"migration\" /&gt;&lt;Generator name=\"model\" /&gt;&lt;Generator name=\"model_subclass\" /&gt;&lt;Generator name=\"observer\" /&gt;&lt;Generator name=\"performance_test\" /&gt;&lt;Generator name=\"plugin\" /&gt;&lt;Generator name=\"resource\" /&gt;&lt;Generator name=\"scaffold\" /&gt;&lt;Generator name=\"scaffold_controller\" /&gt;&lt;Generator name=\"session_migration\" /&gt;&lt;Generator name=\"stylesheets\" /&gt;&lt;Generator name=\"test_unit:controller\" /&gt;&lt;Generator name=\"test_unit:helper\" /&gt;&lt;Generator name=\"test_unit:integration\" /&gt;&lt;Generator name=\"test_unit:mailer\" /&gt;&lt;Generator name=\"test_unit:model\" /&gt;&lt;Generator name=\"test_unit:observer\" /&gt;&lt;Generator name=\"test_unit:performance\" /&gt;&lt;Generator name=\"test_unit:plugin\" /&gt;&lt;Generator name=\"test_unit:scaffold\" /&gt;&lt;/GeneratorsGroup&gt;&lt;/Settings&gt;\n</code></pre>\n\n<p>As you can see: \"<strong>This file was automatically generated by Ruby plugin.</strong>\"</p>\n\n<p>So who is responsible of generating those files ? </p>\n\n<p>and how can i call it ? </p>\n\n<p>the IDE need to take care of it ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":17,"score":1,"question_id":13126753,"title":"Rails, construct url for arbitrary controller,action and zero or more params","body":"<p>here is my current workflow:</p>\n\n<pre><code>c = get_some_controller # =&gt; \"fruits\" or nil\na = get_some_action # =&gt; \"list\"\np = get_some_params # =&gt; { :type =&gt; :orange, :price =&gt; 10 }\n\nurl = url_for(:controller =&gt; c, :action =&gt; a) # no option for params ??\n</code></pre>\n\n<p>So, here is my question, <code>url_for</code> seem does not have any option to pass params.</p>\n\n<p>I guess this use case is pretty common, but rails for some reason not support it or i missed something ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13123197,"title":"Rails: each in random order","body":"<p>This is my code:</p>\n\n<pre><code>    &lt;% question.answers.each do |answer| %&gt;\n\n\n      &lt;li&gt;&lt;%= answer.content %&gt;&lt;/li&gt;\n\n\n    &lt;% end %&gt;\n</code></pre>\n\n<p>I want to order the answer objects randomly. What would be the most efficient way to do so considering the amount of possible answers is less than say 10?</p>\n"},{"tags":["ruby-on-rails-3","upload"],"answer_count":2,"favorite_count":11,"up_vote_count":12,"down_vote_count":0,"view_count":9290,"score":12,"question_id":5776252,"title":"Rails 3 - upload files to public directory","body":"<p>I'm looking for a simple way to upload a file (an xml file) to the public directory of Rails 3. Once it's there I want to open it, parse the contents and delete the file after that.</p>\n\n<p>Whenever I searched for file upload I encountered Paperclip. But I don't want to associate the file with an object. I just want to upload it. What's the easiest way to do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","rack","middleware"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":184,"score":3,"question_id":7112604,"title":"Building middleware that grabs the IP","body":"<p>I'm trying to write my firsts rack middleware. And need help. I want middleware that find the requestor's IP and if it is in the allowed list of IP continues the request, otherwise it aborts.</p>\n\n<p>The tricky part is I need this to work on heroku where you can't use request.ip: <a href=\"http://developerhemal.tumblr.com/post/3958107290/client-ip-addresses-on-heroku\" rel=\"nofollow\">http://developerhemal.tumblr.com/post/3958107290/client-ip-addresses-on-heroku</a></p>\n\n<p>So I have the following:</p>\n\n<pre><code>class RestrictIP\n  def initialize(app, message = \"Hello\")\n    @app = app\n    @message = message\n  end\n\n  def call(env)\n    dup._call(env)\n    @ip = env['HTTP_X_REAL_IP'] ||= env['REMOTE_ADDR']\n  end\n\n  def each(&amp;block)\n    block.call(\"&lt;!-- #{@ip} --&gt;\\n\")\n    @response.each(&amp;block)\n  end\nend\n</code></pre>\n\n<p>This errors with:</p>\n\n<pre><code>NoMethodError (You have a nil object when you didn't expect it!\nYou might have expected an instance of Array.\nThe error occurred while evaluating nil.[]=):\n</code></pre>\n\n<p>For my first itteration I just want to make sure I can grab and put the requestor's IP on the html doc. </p>\n\n<p>Any rack middleware experts out there? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13123268,"title":"How to render different partial for different type of an object belongs to other object in controller","body":"<p>I'm built app which allow users create questions are type: True/False, Single and Multiple Choice. So, I have created some models:</p>\n\n<pre><code>class QuestionType &lt; ActiveRecord::Base\n  attr_accessible :name, :shorcut\nend\n\nclass Question &lt; ActiveRecord::Base\n  attr_accessible :content, :mark, :topic_id, :question_type_id, :answers_attributes\n  belongs_to :topic\n  belongs_to :user\n  belongs_to :question_type\n  has_many :answers, dependent: :destroy\n  accepts_nested_attributes_for :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  attr_accessible :content, :question_id, :correct\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>Now i would to build an index page of questions, have 3 link to add question for 3 type of question, when users click a link, they will go to page to create question and page will have appropriate form for type of that question. In Question controller, i want to store question type id to save to question.<br>\nI think the addresses like this:</p>\n\n<p><a href=\"http://example.com/questions/index\" rel=\"nofollow\">http://example.com/questions/index</a> : Index page will have 3 link to create question.</p>\n\n<p><a href=\"http://example.com/question_types/1/questions/new\" rel=\"nofollow\">http://example.com/question_types/1/questions/new</a>: Will render partial form for True/False question</p>\n\n<p><a href=\"http://example.com/question_types/2/questions/new\" rel=\"nofollow\">http://example.com/question_types/2/questions/new</a>: Will render partial form for Single choice question</p>\n\n<p><a href=\"http://example.com/question_types/1/questions/new\" rel=\"nofollow\">http://example.com/question_types/1/questions/new</a>: Will render partial form for Multiple choice question</p>\n\n<p>I think i have to put nested resources in my routes with question type and question model to have above type of link, but i don't know how to build view and separate like above. please help me or give me an idea, better way to do it :(</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","internationalization","ruby-on-rails-3.1"],"answer_count":4,"favorite_count":1,"up_vote_count":7,"down_vote_count":0,"view_count":1742,"score":7,"question_id":8829725,"title":"I18n: How to check if a translation key/value pairs is missing?","body":"<p>I am using Ruby on Rails 3.1.0 and the <a href=\"https://github.com/svenfuchs/i18n\">I18n gem</a>. I (am implementing a plugin and) I would like to check <em>at runtime</em> if the I18n is missing a translation key/value pairs and, if so, to use a custom string. That is, I have:</p>\n\n<pre><code>validates :link_url,\n  :format     =&gt; {\n    :with =&gt; REGEX,\n    :message  =&gt; I18n.t(\n      'custom_invalid_format',\n      :scope =&gt; 'activerecord.errors.messages'\n  )\n}\n</code></pre>\n\n<p>If in the <code>.yml</code> file there is not the following code</p>\n\n<pre><code>activerecord:\n  errors:\n    messages:\n      custom_invalid_format: This is the test error message 1\n</code></pre>\n\n<p>I would like to use the <code>This is the test error message 2</code>. <strong>Is it possible? If so, how can I make that?</strong></p>\n\n<p><em>BTW</em>: For performance reasons, is it advisable to check <em>at runtime</em> if the translation key/value pairs is present?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3","jquery-ui","autocomplete"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1416,"score":0,"question_id":8036143,"title":"JQuery autocomplete - Select first item","body":"<p>I am using jquery autocomplete which I am populating from a ruby on rails application and I am creating a custom autcomplete like so:</p>\n\n<pre><code>  $.widget( \"custom.code_complete\", $.ui.autocomplete, {\n    _renderMenu: function( ul, items ) {\n            var self = this,\n                currentCategory = \"\";\n        $ul = ul;\n            $.each( items, function( index, item ) {\n                if ( item.category != currentCategory ) {\n                    ul.append( \"&lt;li class='ui-autocomplete-category'&gt;\" + item.category + \"&lt;/li&gt;\" );\n                    currentCategory = item.category;\n                }\n                self._renderItem( ul, item );\n            });\n        }\n    });\n\n  $(\"#r-code\").code_complete({\n    source: \"URL\",\n    minLength: 2,\n    select: function(event, ui) {\n      $(\".button-row\").fadeIn();\n      get_details(ui.item.url);\n    }\n  });\n</code></pre>\n\n<p>I am redirecting a user from another page to the page with the autocomplete form with a parameter in the URL which is a code used for the search, here is the JS to do the search:</p>\n\n<pre><code>function ac_search(code) {\n  $(\"#r-code\").val(code);\n  $(\"#r-code\").code_complete('search', code);\n}\n</code></pre>\n\n<p>This performs the search perfectly and displays the drop down list of results.  I am trying to have the script then select the first result in the list.  I have tried doing it via a selector:</p>\n\n<pre><code>$(\".ui-menu-item:first a\").click();\n</code></pre>\n\n<p>This finds the correct element in the autocomplete list but when I try and simulate a click it gives this error:</p>\n\n<pre><code>TypeError: ui.item is null\n</code></pre>\n\n<p>Is it possible to programmatically click the first item in the autocomplete results list?</p>\n\n<p>Cheers</p>\n\n<p>Eef</p>\n"},{"tags":["ruby-on-rails-3","activerecord","namespaces","autoload"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13125036,"title":"Rails namespaced models autoloading issue?","body":"<p>Here's the setup:</p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  has_many :project_subject_areas, class_name: \"Project::SubjectArea\"\n  has_many :subject_areas, through: :project_subject_areas\nend\n\nclass SubjectArea &lt; ActiveRecord::Base\n  has_many :project_subject_areas, class_name: \"Project::SubjectArea\"\n  has_many :projects, through: :project_subject_areas\nend\n\nclass Project::SubjectArea &lt; ActiveRecord::Base\n  belongs_to :project\n  belongs_to :subject_area, class_name: '::SubjectArea'\nend\n</code></pre>\n\n<p>Running this in Rails:</p>\n\n<pre><code>[ SubjectArea.to_s, Project::SubjectArea.to_s ].inspect\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>[\"SubjectArea\", \"SubjectArea\"]\n</code></pre>\n\n<p>but running this (after server restart):</p>\n\n<pre><code>[ Project::SubjectArea.to_s, SubjectArea.to_s ].inspect\n</code></pre>\n\n<p>gives:</p>\n\n<pre><code>[\"Project::SubjectArea\", \"SubjectArea\"]\n</code></pre>\n\n<p>file structure is:</p>\n\n<pre><code>models/project.rb\nmodels/subject_area.rb\nmodels/project/subject_area.rb\n</code></pre>\n\n<p>I can bypass this with <code>require project/subject_area</code> manually, but am I doing something wrong with this namespacing?</p>\n\n<p>Is there any other way to namespace my models?</p>\n\n<p>When Rails generates namespaces <code>rails generate Project::X</code> I get Project as a module, but I need it to be an ActiveRecord class. I also have some other models that belong to Project and I really want them to be namespaced and in models/project/ directory.</p>\n"},{"tags":["ruby-on-rails-3","factory-girl","cancan"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13122807,"title":"CanCan abilities working in application but not in test","body":"<p>I have the following definition in my ability.rb file:</p>\n\n<pre><code>    can :index, Call, :country_id =&gt; user.countries\n</code></pre>\n\n<p>I am trying to only index Calls whose country_id is in current user's countries array.</p>\n\n<p>This seems to be working when I try it: It only shows me calls that have been tagged by countries that the current_user is a member of.</p>\n\n<p>However, I have the following test which I can't seem to get to pass:</p>\n\n<pre><code>  before :each do\n    # Users\n    @admin = FactoryGirl.create(:user, admin: true)\n  end\n\n  it \"should show the call index page with just calls that have the same country tags as them\" do\n    anotheruser1 = FactoryGirl.create(:user)\n    anotheruserscall1 = FactoryGirl.create(:call, user_id: anotheruser1.id)\n    anotheruser2 = FactoryGirl.create(:user)\n    anotheruserscall2 = FactoryGirl.create(:call, user_id: anotheruser2.id)\n    @admin.countries &lt;&lt; anotheruserscall1.country\n    ability = Ability.new(@admin)\n    ability.should be_able_to(:index, anotheruserscall1)\n    ability.should_not be_able_to(:index, anotheruserscall2)\n  end\n</code></pre>\n\n<p>But I get a failure:</p>\n\n<pre><code>Failures:\n\n  1) Admin ability should show the call index page with just calls that have the same country tags as them\n     Failure/Error: ability.should be_able_to(:index, anotheruserscall1)\n       expected to be able to :index #&lt;Call id: 1, subject: \"Natus qui fuga ut.\", description: \"Consequatur aut veritatis earum dolor. Reprehenderi...\", from: \"2012-10-25 18:43:23\", to: \"2012-10-25 19:43:23\", user_id: 7, status: \"Tentative\", created_at: \"2012-10-29 13:41:07\", updated_at: \"2012-10-29 13:41:07\", expert_id: nil, country_id: 1&gt;\n     # ./spec/models/ability_spec.rb:291:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Any help greatly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","full-text-search","elasticsearch","tire"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13125047,"title":"Tire and Elastic Search - Object Associations","body":"<p>I'm having a little difficulty with the Tire and Elastic Search functionality.</p>\n\n<p>I have a Listing that has a Property. I'm trying to get a basic search form working so that I can create a query from the Property.</p>\n\n<pre><code># listings/index.html.erb\n\n&lt;%= form_tag searches_listings_path, method: :get do %&gt;\n  &lt;p&gt;\n    &lt;%= text_field_tag :query, params[:query] %&gt;\n    &lt;%= text_field_tag :property_postcode, params[:property_postcode] %&gt;\n    &lt;%= submit_tag \"Search\", name: nil %&gt;\n  &lt;/p&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>At the moment, whenever I try filtering down the search results, it seems like the property_postcode is being ignored and all results are being returned.</p>\n\n<pre><code>      # Listing.rb\ninclude Tire::Model::Search\n      include Tire::Model::Callbacks\n\n  mapping do\n    indexes :id, type: 'integer'\n    indexes :title, boost: 10\n    indexes :description, analyzer: 'snowball'\n    indexes :posted_at, type: 'date'\n    indexes :property do\n      indexes :postcode, :type =&gt; 'string'\n    end\n  end\n\n  def self.search(params)\n\n    tire.search(page: params[:page], per_page: 5, load: true) do\n      query do\n        boolean do\n          must { string params[:query], default_operator: \"AND\" } if params[:query].present?\n          must { term \"property.postcode\", params[:property_postcode] } if params[:property_postcode].present?\n        end\n      end\n        end\n      end\n\n   def to_indexed_json\n    to_json(:include =&gt; { \n              :property =&gt; {\n                :only =&gt; [:postcode]\n              }\n            })\n    end\n</code></pre>\n\n<p>And finally for the property</p>\n\n<pre><code>#Property.rb\nclass Property &lt; ActiveRecord::Base\n  belongs_to  :listing, touch: true\n  after_touch() { tire.update_index }\nend\n</code></pre>\n\n<p>Then finally </p>\n\n<pre><code>rake environment tire:import CLASS=Listing FORCE=true\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Ryan</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13103206,"title":"Testing rails engine helpers with rspec","body":"<p>I've searched a bit but I can't find a good explanation about it so here is my question.</p>\n\n<p>I'm writing a Rails engine that only adds helpers.</p>\n\n<p>The structure is like this (the important part):</p>\n\n<pre><code>my_engine/\n  -- app/\n     -- helpers/\n        -- my_engine/\n           -- my_engine_helper.rb\n  -- spec/\n     -- dummy/\n     -- spec_helper.rb\n</code></pre>\n\n<p>My <code>spec_helper.rb</code> is the following:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code># Configure Rails Envinronment\nENV['RAILS_ENV'] = 'test'\nrequire File.expand_path('../dummy/config/environment.rb',  __FILE__)\n\nrequire 'rspec/rails'\n\nENGINE_RAILS_ROOT = File.join(File.dirname(__FILE__), '../')\n\n# Requires supporting ruby files with custom matchers and macros, etc,\n# in spec/support/ and its subdirectories.\nDir[File.join(ENGINE_RAILS_ROOT, 'spec/support/**/*.rb')].each { |f| require f }\n\nRSpec.configure do |config|\n  config.use_transactional_fixtures = true\nend\n</code></pre>\n\n<p>So far so good, but I'm not sure about how to test my helper.\nI would like to know what is the best way to:</p>\n\n<ul>\n<li>organize the test files </li>\n<li>test that the dummy app can use the helper</li>\n<li>test the helper itself</li>\n</ul>\n\n<p>For now I get the following error when running the spec:</p>\n\n<pre><code>undefined local variable or method `helper' for #&lt;RSpec::Core::ExampleGroup::Nested_1::Nested_1:0x007fcee8b0f4a0&gt;\n</code></pre>\n\n<p>with the following test:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>require 'spec_helper'\n\nmodule MyEngine\n  describe MyEngineHelper do\n    describe '#something' do\n      it \"does something\" do\n        helper.something.should be_true\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Thank you !</p>\n"},{"tags":["ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13064599,"title":"excel import is not working with spreadsheet gem","body":"<p>I am using Spreadsheet gem to import excel data to database. my view is:-</p>\n\n<pre><code>&lt;% form_for :dump, :url=&gt;{:action=&gt;\"excel_import\"}, :html =&gt; { :multipart =&gt; true } do |f| -%&gt;\n Select an Excel File :\n &lt;%= f.file_field :excel_file -%&gt;\n &lt;%= submit_tag 'Submit' -%&gt;\n&lt;% end -%&gt;\n</code></pre>\n\n<p>and my controller is :-</p>\n\n<pre><code>require 'spreadsheet'\n\ndef excel_import\n Spreadsheet.client_encoding = 'UTF-8'\n book = Spreadsheet.open params[:dump][:excel_file]\n sheet1 = book.worksheet 0\n sheet1.each do |row|\n TimeSheet.new(:ac_no =&gt; row[0]).save\n end\nend\n</code></pre>\n\n<p>Parameters:-</p>\n\n<pre><code> {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"vhyy1pzYJpM9hCdgP5AiFC1Pv0UtbpLSzStZDWiZzs8=\", \"dump\"=&gt;{\"excel_file\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x9a8f5f8 @original_filename=\"SwipeData_DeliveryTeam_Sep12.xls\", @content_type=\"application/vnd.ms-excel\", @headers=\"Content-Disposition: form-data; name=\\\"dump[excel_file]\\\"; filename=\\\"SwipeData_DeliveryTeam_Sep12.xls\\\"\\r\\nContent-Type: application/vnd.ms-excel\\r\\n\", @tempfile=#&lt;File:/tmp/RackMultipart20121025-4534-n7pw14&gt;&gt;}, \"commit\"=&gt;\"Submit\"}\n</code></pre>\n\n<p>when i am trying to upload excel file and click on submit button, I am getting error:-</p>\n\n<pre><code> can't convert ActionDispatch::Http::UploadedFile into String\n</code></pre>\n\n<p>I have taken the reference from <a href=\"http://openrails.blogspot.in/2011/06/xls-import-using-spreadsheet.html\" rel=\"nofollow\">blog</a></p>\n\n<p>can anyone please tell me what is going wrong in this code.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13065741,"title":"Rails app for multiple domains","body":"<p>I need to create a service with the same five sites and one that will unite them, but everyone has to live on a separate domain. Maybe somehow run one instance Rails app redirect users depending on the domain? Or is it better to start on a new Rails app per instance?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table","will-paginate","infinite-scroll"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":13001593,"title":"Rails Endless Page / Infinite Scroll","body":"<p>I asked this same question yesterday, but I do not think I was clear enough with what I wanted. I am using twitter bootstrap and will_paginate, and I have a table on which I would like to implement infinite scrolling. That table is a fixed length and already scrolls. I recently followed the revised version of Railscasts Episode #114, but it does not work for me. When I scroll to the bottom of the table, it says fetching more articles, but it does not actually fetch more articles. Here is my code:</p>\n\n<p><strong>Articles.js.coffee:</strong></p>\n\n<pre><code>    jQuery -&gt;\n  if $('.pagination').length\n          $(articles).scroll -&gt;\n                  url = $('.pagination .next_page').attr('href')\n                  if url &amp;&amp;  $(articles).scrollTop() &gt; $(document).height() -             \n                  $(articles).height() + 585\n                      $('.pagination').text('Fetching more players...')\n                      $.getScript(url)\n    $(articles).scroll()\n</code></pre>\n\n<p><strong>Index.js.erb:</strong></p>\n\n<pre><code>$('#articles').append('&lt;%= j render(@articles) %&gt;');\n&lt;% if @articles.next_page %&gt;\n$('.pagination').replaceWith('&lt;%= j will_paginate(@articles) %&gt;');\n&lt;% else %&gt;\n$('.pagination').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p>My controller and table are both called Articles. I do not know if it is not working because it is a table versus a whole page. </p>\n\n<p>Please let me know if I need to post any more files.\nAny help would be appreciated</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13124082,"title":"tell thinking sphinx to only index the latest element in a has_many relationship","body":"<p>A post has many wiki entries... but only the latests makes sense to be searchable.\nUnfortunately, while the has_many and has_one relationships work fine, Thinking sphinx will always index the OLDEST wikis on each post... any hint ?  </p>\n\n<pre><code>has_many :wikis, :as =&gt; :source, :order =&gt; \"updated_at DESC\"\nhas_one :latest_wiki, :class_name =&gt; \"Wiki\", :conditions =&gt; \"source_type = 'BlogPost'\", :foreign_key =&gt; :source_id, :order =&gt; \"wikis.updated_at DESC\"##used for sphinx to only index the latest revision\n\n\ndefine_index do\n  indexes latest_wiki.data, :as =&gt; :post_data\n  indexes latest_wiki.title , :as =&gt; :post_title\n  indexes blob\n  has published, :type =&gt; :boolean\n  has id\nend\n</code></pre>\n\n<p>this will generate the following conf.. which clearly shows the has_one is not understood properly  :</p>\n\n<pre><code>    source blog_post_core_0\n    {\n      type = mysql\n      sql_host = localhost\n      sql_user = root\n      sql_pass = diveboard\n      sql_db = diveboard\n      sql_query_pre = SET NAMES utf8\n      sql_query_pre = SET TIME_ZONE = '+0:00'\n      sql_query = SELECT SQL_NO_CACHE `blog_posts`.`id` * CAST(10 AS SIGNED) + 0 AS `id` , `wikis`.`data` AS `post_data`, `wikis`.`title` AS `post_title`, `blog_posts`.`blob` AS `blob`, `blog_posts`.`id` AS `sphinx_internal_id`, 0 AS `sphinx_deleted`, 1270887957 AS `class_crc`, `blog_posts`.`published` AS `published`, `blog_posts`.`id` AS `id` FROM `blog_posts` LEFT OUTER JOIN `wikis` ON `wikis`.`source_id` = `blog_posts`.`id` AND source_type = 'BlogPost' WHERE (`blog_posts`.`id` &gt;= $start AND `blog_posts`.`id` &lt;= $end) GROUP BY `blog_posts`.`id` ORDER BY NULL\n      sql_query_range = SELECT IFNULL(MIN(`id`), 1), IFNULL(MAX(`id`), 1) FROM `blog_posts`\n      sql_attr_uint = sphinx_internal_id\n      sql_attr_uint = sphinx_deleted\n      sql_attr_uint = class_crc\n      sql_attr_uint = id\n      sql_attr_bool = published\n      sql_query_info = SELECT * FROM `blog_posts` WHERE `id` = (($id - 0) / 10)\n    }\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","database","ruby-on-rails-3","validation"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":65,"score":5,"question_id":13122791,"title":"Rails: Validation in model vs migration","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/2367281/ruby-on-rails-is-it-better-to-validate-in-the-model-or-the-database\">Ruby on Rails: Is it better to validate in the model or the database?</a>  </p>\n</blockquote>\n\n\n\n<p>I see that it's possible to add same constraint/validation in both Rails model and migration. But which one is the best approach? Is it a good practice to validate both at model and database level (and why)? or they same in rails? </p>\n\n<p>For e.g.  We can do same validation  for name in both model and migration</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  validates :name, :uniqueness =&gt; true, :presense =&gt; true\nend\n\nclass CreateUser &lt; ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n      t.string :name, :unique =&gt; true, :null =&gt; false\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13123130,"title":"Rails + Read json from remote site","body":"<p>I was wondering if it is possible with rails to read in the json content of an external Joomla website?</p>\n\n<p>Would I need to use Nokogiri to complete such a task?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13123451,"title":"Two-tiered models and controllers in Rails","body":"<p>New to Rails and having a hard time envisioning how to proceed with a project.  I would like to create a simple page where users:</p>\n\n<p>a) select a \"project\", sends to project page\nb) from project page, can repeatedly query an API and get results</p>\n\n<p>As I'm still wrapping my head around scaffolding and creating models and controllers, I'm wondering if the following makes sense:</p>\n\n<pre><code>rails generate Project person:string\nrails generate API_call title:string response:text\n</code></pre>\n\n<p>I suppose my question is then, how do I link entries in the API_call table to specific projects?  Is this the \"references\" option?</p>\n\n<p>many thanks in advance... </p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13122991,"title":"on duplicate key wierd issue","body":"<p>I'm using sql query in my project, with next code:</p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(\", \")} on duplicate key update open_counter = open_counter + 1\"\n</code></pre>\n\n<p>I've added </p>\n\n<pre><code>add_index :open_offer_counters, :offer_id, :unique =&gt; true\nadd_index :open_offer_counters, :udid,  :unique =&gt; true\n</code></pre>\n\n<p>into one of migrations. But when i'm trying to add some record with only 1 duplicate key, that doesnt works, but instead update key happens. Basically this code works if only 2 keys(offer_id and udid) are different. If any of them match other one, AR updates my open_counter. How do i make update open_counter if only 2 keys matched(offer_id and udid)?</p>\n"},{"tags":["facebook","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13123293,"title":"My web app not showing on facebook native app","body":"<p>My app is showing on facebook desktop, m.facebook.com, but not on the native app?</p>\n\n<p>I meant not showing on bookmark or favorite. When I search for it within the native app I can find it. </p>\n\n<p>According to the documentation it should also appear on the native Facebook app bookmark?</p>\n\n<p>Can anyone please advise what did I do wrong? I have set the mobile web setting already. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solaris","phusion-passenger","unicorn"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":9,"score":0,"question_id":13123115,"title":"How can i install Unicorn with Apache on Solaris OS in rails 3 application?","body":"<p>I am using,</p>\n\n<pre><code>ruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13\n</code></pre>\n\n<p>I have problem with Phusion passenger it frequently shut down in production enviornment.</p>\n\n<p>So i want to shift my app with <code>Apache + Unicorn combination.</code></p>\n\n<p>So can somebody please help me.</p>\n\n<p>I am premium member of <code>Joyent(Cloud support) with Solaris OS.</code></p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","dynamic-content","html-safe"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13117805,"title":"How to render html from a text column field in database?","body":"<p>I have an column in database as <strong>welcome_emil</strong> of type <strong>TEXT</strong>.</p>\n\n<p>I have saved the following code content saved in column as :</p>\n\n<pre><code>Thanks for Joining in!     \\r\\n\\r\\nYou can loginor refer your friends using your %referral_link%.\"\n</code></pre>\n\n<p>When i try to render this code into my email that is sent to the user. Complete content goes fine but </p>\n\n<pre><code>  \\r\\n\\r\\n\n</code></pre>\n\n<p>this is omitted and all text appear inline.</p>\n\n<p>Here is the code that i use</p>\n\n<pre><code>  &lt;%= p  @company.welcome_email.gsub('%referral_link%',@recipient.referral_link).html_safe %&gt; \n</code></pre>\n\n<p>Here is the screenshot how it looks like in email</p>\n\n<p><img src=\"http://i.stack.imgur.com/oTHlq.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":8,"score":0,"question_id":13122969,"title":"delayed_job: attribute accessor values are not stored in delayed_jobs table in rails 3 after upgrade from rails 2","body":"<p>How we did this in rails2 was: For a job class we set a bunch of attr_accessor methods for the job object and enqueue the object into delayed_jobs table and those accessor values are stored in the table as well. (we were using delayed_job 2.0.3)</p>\n\n<p>But in rails3 even though we follow the same procedure as in rails2, the attr_accessor values are not stored into the table. Can anybody tell me how we persist the accessor values into the table with the new delayed_job gem(3.0.3)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","tdd","bdd"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13121205,"title":"Simplifying and correct RSpec controller tests","body":"<p>I have a few RSpec controller tests.  Some work, some don't, and I'm trying to figure out how on Earth to fix them up and make them more efficient</p>\n\n<p>Ideally, I would like to see if I can get each spec into the following form</p>\n\n<pre><code>subject { ... }\n  it { ... }\n  it { ... }\n  it { ... }\n</code></pre>\n\n<p>Note that for all of my controller specs I've written macros for the actual controller actions.  The macros are all tested and all work, and the names make it fairly obvious what they do.</p>\n\n<p>My \"Create\" test:</p>\n\n<pre><code>formats ||= [\"html\", \"js\"]\nformats.each do |format|\n  context \"valid attributes\" do\n    subject { do_post_create( :customer, valid_attributes, format ) }\n      its(:response_code) { should eq(302)}\n      it { should redirect_to admin_customer_path(Customer.find_by_id(???))}\n      it { expect { subject }.to change(Customer, :count).by(1) }\n  end\n\n  context \"invalid attributes\" do\n    subject { do_post_create( :customer, invalid_attributes, format ) }\n      its(:response_code) { should eq(200)}\n      it { should render_template :new }\n      it { expect { subject }.to_not change(Customer, :count).by(1) }\n  end\nend\n</code></pre>\n\n<p>In that spec, I've been trying to figure out some way to get the ID of the newly created object from the post statement.  I've tried \"Customer.last\", but that doesn't seem to work.  Any thoughts?</p>\n\n<p>My \"Update\" spec:</p>\n\n<pre><code>formats ||= [\"html\", \"js\"]\nformats.each do |format|\n  context \"valid attributes\" do\n    let(:object) { FactoryGirl.create(:customer) }\n    subject { do_put_update( class_to_symbol(model), object.id, attributes, format ) }\n      its(:response_code) { should eq(302)}\n\n    it \"does alter #{model}\" do\n      do_put_update( class_to_symbol(model), object.id, attributes, format )\n      assigns(:customer).should eq(object)\n      flash[:notice].should =~ /Success/\n      object.reload\n      attributes.each do |key, value|\n        object.send(key.to_s).should eq(value)\n      end\n    end\n  end\n  context \"invalid attributes\" do\n    let(:object) { FactoryGirl.create(\"customer\") }\n    let(:invalid_attributes) { {:username =&gt; \"!\"} }\n    subject { do_put_update( class_to_symbol(model), object.id, invalid_attributes, format ) }\n      its(:response_code) { should eq(200)}\n\n    it \"does not alter #{model}\" do\n      do_put_update( class_to_symbol(model), object.id, invalid_attributes, format )\n      assigns(:customer).should eq(object)\n      flash[:notice].should =~ /Fail/\n      object.reload\n      attributes.each do |key, value|\n        object.send(key.to_s).should_not eq(value)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>In the Update test, I would like to try to express the second block in a more concise way, ideally in a way that I can use the same \"subject\" statement for all of the tests.  Is that possible?</p>\n"},{"tags":["ruby-on-rails-3","actionscript-3","encoding","urlencode"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13120419,"title":"whats the encoding type to use to store jpg within http raw post data?","body":"<p>As I am sending a jpg image from Flash Player with a URL request header like this:</p>\n\n<pre><code>var header:URLRequestHeader = new URLRequestHeader(\"Content-type\", \"application/octet-stream\");\n</code></pre>\n\n<p>What would be the encoding type at server side ?</p>\n\n<p>I tried to store the raw post with a temp file :</p>\n\n<pre><code>temp_file = Tempfile.new(['temp', '.jpg'], :encoding =&gt; 'ascii-8bit')\n</code></pre>\n\n<p>but, the resulted file is corrupted&amp; can't be opened, what would be the encoding type to be used with <code>application/octet-stream</code> ?</p>\n\n<p>EDIT:\nHere is the resulted image, which can't be opened:\n<img src=\"http://i.stack.imgur.com/4Bb8V.jpg\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","csv","stylesheet"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13117593,"title":"Two data in same column display above/below when create CSV file in stylesheet using rails","body":"<p><img src=\"http://i.stack.imgur.com/oEwJE.png\" alt=\"enter image description here\"></p>\n\n<p>I am create CSV file using rails coding but i have issue two contact data display in same column in continue.. so data not display in good format.</p>\n\n<p>Currently display data like:</p>\n\n<pre><code>-------------------------------\n|email:1@gmail.comphone:3453453|   \n-------------------------------\n</code></pre>\n\n<p>I want to display like: </p>\n\n<pre><code>-------------------\n|email:1@gmail.com|\n|phone:3453453    | \n-------------------\n</code></pre>\n\n<p>in same column.</p>\n\n<p>I am using below code:</p>\n\n<pre><code>     dpwn_text = \"#{t('email')}: #{d.contact}\" + \"#{t('PhoneNo')}: #{d.phoneno}\" \n\n     tmp_file = \"#{Rails.root}/app/assets/images/temp.csv\"\n\n     File.open(tmp_file, 'wb') do |f|  \n       f.write dpwn_text\n     end\n\n     send_data(dpwn_text, :type =&gt; 'text/csv; charset=utf-8; header=present', :filename =&gt; \"publishers.csv\")\n     return\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13119664,"title":"rails multiple outer joins syntax","body":"<p>I have the following models</p>\n\n<p>user</p>\n\n<pre><code>has_many :leave_balances\n</code></pre>\n\n<p>leave_balance</p>\n\n<pre><code>belongs_to :user\nbelongs_to :leave_type\n</code></pre>\n\n<p>leave_type</p>\n\n<pre><code>has_many :leave_balances\n</code></pre>\n\n<p>I want to output a table format showing user names and their balance by leave type.\nNot every user can have every balance i.e. outer joins required.</p>\n\n<p>I'd like to see something like this:</p>\n\n<pre><code>Employee   Annual Leave   Sick Leave\nBob        10 \nFred                      9\nSara       12             15\n</code></pre>\n\n<p>I am unsure how to get this out as a single statement?</p>\n\n<p>I am thinking something like User.joins(:leave_balances).joins(:leave_type) </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13121928,"title":"factory girl error","body":"<p>Am getting an error when am running my test file.</p>\n\n<pre><code>factory.rb:334:in `factory_by_name': No such factory: user (ArgumentError)\n</code></pre>\n\n<p>I have the user model but still why am getting this error?\nMy factories.rb contains:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do |u|\n    u.sequence(:email) {|n| \"#{n}@email.com\"}\n    u.login 'Joe'\n    u.password 'password'\n    u.password_confirmation 'password'\n    u.phone '1111111111'\n    u.gender 'F'\n    u.active '1'\n    u.social_profile_active '1'\n  end\nend\n</code></pre>\n\n<p>in test_helper.rb</p>\n\n<pre><code>ENV[\"RAILS_ENV\"] = \"test\"\nrequire File.expand_path('../../config/environment', __FILE__)\nrequire 'rails/test_help'\nrequire 'factory_girl'\n#Factory.find_definitions\n\nclass ActiveSupport::TestCase\n  # Setup all fixtures in test/fixtures/*.(yml|csv) for all tests in alphabetical order.\n  #\n  # Note: You'll currently still have to declare fixtures explicitly in integration tests\n  # -- they do not yet inherit this setting\n  #fixtures :all\n\n  # Add more helper methods to be used by all tests here...\nend\n</code></pre>\n\n<p>my ruby version is 1.8.7 and rails3.0.1</p>\n\n<p>And my gemfile looks like this:\ngroup :test do\n  gem 'shoulda'\n  gem 'factory_girl_rails'\n  gem 'mocha'\nend</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13121726,"title":"S3 and Rails 3.2: StringToSign difficulties with DELETE request. \"SignatureDoesNotMatch\" Error","body":"<p>I think my problem stems from my lack of understanding of S3 Policy Documents and StringToSign, and how they fit into a Rails app.</p>\n\n<p>I'm attempting to delete an image from my S3 bucket, and ran into this error. Incidentally, I'm using Transloadit to directly upload the image to S3, so I didn't have this problem on the POST side.</p>\n\n<p>Using the aws-sdk gem.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n\n  belongs_to :article\n  attr_accessible :file_type, :link, :title\n\n\n  def destroy\n      s3 = AWS::S3.new(:access_key_id =&gt; AWS_KEY, :secret_access_key =&gt; AWS_SECRET)\n      bucket = s3.buckets[AWS_BUCKET]\n      s3_link = self.link\n      bucket.objects[s3_link].delete    \n      super()\n  end\nend\n</code></pre>\n\n<p>\"self.link\" is the S3 object key. When I use the Rails console, it works fine, and I'm able to delete images using that key without a problem.</p>\n\n<p>I know I need to create a Policy doc and StringToSign somewhere. I just don't know where I need to do this, and how ?</p>\n\n<p>Any help would be kindly appreciated. Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","heroku","https"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":134,"score":1,"question_id":12387645,"title":"'EOFError: end of file reached' on HEROKU while posting UTF-8 via SSL","body":"<p>I've got strange bug on heroku. To reproduce it I have to make big (over few KB) HTTPS POST with any UTF-8 characters in request body. Here is an example:</p>\n\n<pre><code>require \"net/https\"\nrequire \"uri\"\n\n#Accutally I've ecountered this bug while posting to another server\nurl = URI.parse(\"https://api.heroku.com/myapps\")\n\n#It's Ukrainian 'oiced velar plosive G' letter\npayload = \"ґ\"*10000\nrequest = Net::HTTP::Post.new(url.path)\nrequest.body = payload\nhttp = Net::HTTP.new(url.host, url.port)\nhttp.use_ssl = true\nhttp.read_timeout = 500\nhttp.start {|http| http.request request }\n</code></pre>\n\n<p>Running such script on local machine's irb gives me:</p>\n\n<pre><code>#&lt;Net::HTTPUnauthorized 401 Unauthorized readbody=true&gt; \n</code></pre>\n\n<p>...which is expected, but on heroku cedar, runing it on 'heroku console' ... in about 60sec I get:</p>\n\n<pre><code>EOFError: end of file reached\n    from /usr/local/lib/ruby/1.9.1/openssl/buffering.rb:145:in `sysread_nonblock'\n    from /usr/local/lib/ruby/1.9.1/openssl/buffering.rb:145:in `read_nonblock'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:135:in `rbuf_fill'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:116:in `readuntil'\n    from /usr/local/lib/ruby/1.9.1/net/protocol.rb:126:in `readline'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:2219:in `read_status_line'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:2208:in `read_new'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:1191:in `transport_request'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:1177:in `request'\n    from (irb):32:in `block in irb_binding'\n    from /usr/local/lib/ruby/1.9.1/net/http.rb:627:in `start'\n    from (irb):32\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/console.rb:47:in `start'\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands/console.rb:8:in `start'\n    from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.7/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n</code></pre>\n\n<p>What should I do with it?</p>\n"},{"tags":["ruby-on-rails-3","testing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":888,"score":1,"question_id":6188003,"title":"rails 3 test error:Mysql2::Error: Unknown column","body":"<p>guys,I get an error when I test my rails app following the <a href=\"http://guides.rubyonrails.org/testing.html\" rel=\"nofollow\">http://guides.rubyonrails.org/testing.html</a>,It said :</p>\n\n<blockquote>\n  <p>test_the_truth(ClassroomTypeTest):\n  ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'type' in 'field list': INSERT INTO <code>classroom_types</code> (<code>type</code>, <code>memo</code>, <code>created_at</code>, <code>updated_at</code>, <code>id</code>) VALUES ('MyString', 'MyString', '2011-05-31 08:40:54', '2011-05-31 08:40:54', 980190962)</p>\n</blockquote>\n\n<p>I am confused, I do not have a column in my classroom_types table,why will it appear such an error? \nCan anyone help me? Many Thanks!</p>\n\n<p>Here are my models and the relationship:</p>\n\n<p>The ClassroomType model:</p>\n\n<pre><code>class ClassroomType &lt; ActiveRecord::Base\n  has_many :classrooms\nend\n</code></pre>\n\n<p>The Classroom model:</p>\n\n<pre><code>class Classroom &lt; ActiveRecord::Base\n   belongs_to :classroom_type\n   belongs_to :teaching_building\nend\n</code></pre>\n\n<p>The TeachingBuilding model:</p>\n\n<pre><code>class TeachingBuilding &lt; ActiveRecord::Base\n  has_many :classrooms\nend\n</code></pre>\n\n<p>And here are the corresponding tables:</p>\n\n<p>classrooms:</p>\n\n<ul>\n<li>id </li>\n<li>classroom_no </li>\n<li>classroom_name</li>\n<li>classroom_type_id</li>\n<li>teaching_building_id</li>\n</ul>\n\n<p>classroom_types:</p>\n\n<ul>\n<li>id</li>\n<li>name</li>\n<li>memo</li>\n</ul>\n\n<p>teaching_buildings:</p>\n\n<ul>\n<li>id</li>\n<li>t_no</li>\n<li>name</li>\n</ul>\n"},{"tags":["mysql","sql","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13120729,"title":"On duplicate key update issue","body":"<p>I'm trying to update field on duplicate key, but it just adds new records instead of updating.</p>\n\n<p>Here is what i'm trying to do </p>\n\n<pre><code>ActiveRecord::Base.connection.execute \"insert into open_offer_counters (offer_id, udid, open_counter) values #{opened_events.join(\", \")} on duplicate key update open_counter = open_counter + 1\"\n</code></pre>\n\n<p>In my migration I pointed on 2 unique fields </p>\n\n<pre><code>create_table :open_offer_counters do |t|\n    t.integer :offer_id,            :unique =&gt; true\n    t.string  :udid,                :unique =&gt; true\n    t.integer :open_counter\n  t.timestamps\nend\n</code></pre>\n\n<p>Any ideas whats wrong with code?</p>\n"},{"tags":["ruby-on-rails-3","timezone","cucumber","zonebie"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13062833,"title":"Randomizing time zone in Rails with Zonebie","body":"<p>I'm using <a href=\"https://github.com/highgroove/zonebie\" rel=\"nofollow\">Zonebie</a> to randomize the time zone in my tests. It's all working fine for my rspec tests, but I'm having an issue with my cucumber tests. It works by selecting a random timezone from <code>ActiveSupport</code> and setting <code>Time.zone</code>. I've <a href=\"https://github.com/highgroove/zonebie#cucumber\" rel=\"nofollow\">followed the readme</a> and added <code>Zonebie.set_random_timezone</code> to a support file <code>features/support/zonbie.rb</code>. </p>\n\n<p>If I put a <code>debugger</code> statement in my steps, and I print <code>Time.zone</code>, it produces the correct randomized timezone.  However, if I put a <code>debuggger</code> statement in a model function, it prints the default time zone as set up in my <code>config/application.rb</code>.</p>\n\n<p>Is Time.zone being reset somewhere or does the change go out of scope somehow? Any ideas?</p>\n\n<p><strong>NB</strong>: I'm also using the <a href=\"https://github.com/travisjeffery/timecop\" rel=\"nofollow\">Timecop</a> gem if that has any implications.</p>\n"},{"tags":["ruby","ruby-on-rails-3","video-streaming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13120607,"title":"HTTP Packet Reconstruction using Ruby - Video Streaming","body":"<p>I am asking you guys if it is possible using Ruby, to create a HTTP Packet reconstruction system. I got the server's information, everything is working OK from that side. It is a video streaming server. I will use UDP, but I want to know if this has been done before in Ruby, or if I can use an other package that will build the video for me. \nThanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13116440,"title":"devise forgot password function not working when creating own user controller?","body":"<p>I use devise for authentication and i have created a user controller and specified as shown below in my routes which lets me to create users,edit and delete users,</p>\n\n<pre><code>devise_for :users do\nresources :users, :only =&gt; [:index, :new, :create, :edit, :update, :destroy]\nend\n</code></pre>\n\n<p>but i cannot able to make the forgot password functionality work using this but in case i  specify as</p>\n\n<pre><code>devise_for :users\n</code></pre>\n\n<p>then i can able to use the forgot password function that comes with devise and i could not able to create , edit or delete when i specify like this. So how can i make both to work ? \nplease help me</p>\n"},{"tags":["ruby","ruby-on-rails-3","mongodb","mongoid","mongoid3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":13071380,"title":"How to drop a specific database using Mongoid?","body":"<p><code>Mongoid.default_session.database_names</code> gives me an array of database names. I want to delete a specific database. How would I do that?</p>\n\n<p><code>Mongoid.default_session.drop()</code> always seems to drop the default database even if I override the current database using <code>Mongoid.override_database(\"test_database\")</code></p>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":8,"score":-1,"question_id":13119418,"title":"I keep getting 'undefined method `key?' for nil:NilClass' when Building a Multi-Model Form (chapter 11) with Getting Started with Rails Guide","body":"<p>I've double checked that my code is like instructed but cannot figure out what might be wrong.\nI am using Rails version 3.2.8.\nMany thanks for help.</p>\n\n<p>-Petri</p>\n"},{"tags":["ruby-on-rails","ruby","http","ruby-on-rails-3","plugins"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":528,"score":1,"question_id":5079302,"title":"Typhoeus::Request.new(...) doesn't work, but Typhoeus::Request.get(...) does!","body":"<p>I am using Ruby on Rails 3. I just installed Typhoeus and I am tryng to make a HTTP request like this</p>\n\n<pre><code>  require 'typhoeus'\n\n  ....\n  request = Typhoeus::Request.new(\"http://google.com\",\n              :method        =&gt; :get,\n              :params        =&gt; {\n                :email       =&gt; \"test@test.com\",\n                :password    =&gt; \"test\"\n              }\n            )\n\n  resp = request.response\n</code></pre>\n\n<p>but I have a problem: debug of <code>resp</code> is always blank and this happens also if I don't use options (method, params, ...).</p>\n\n<p>However, if I use the following code, it will work:</p>\n\n<pre><code>   resp = Typhoeus::Request.get(\"http://google.com?email=test@test.com&amp;password=test\")\n</code></pre>\n\n<p>and I will get values for <code>resp</code>.</p>\n\n<p><strong>What can be the problem?</strong></p>\n\n<hr>\n\n<p>What I use</p>\n\n<ul>\n<li><p>Mac OS with \"Snow Leopard\" v 1.1.6</p></li>\n<li><p>MacPorts - The version 7.21.2 of libcurl was already installed from this software</p></li>\n<li><p>RVM (Ruby Version Manager)</p></li>\n</ul>\n\n<hr>\n\n<p>P.S.: if you need more info, let me know.</p>\n\n<hr>\n\n<p>In the <a href=\"https://github.com/dbalatero/typhoeus\" rel=\"nofollow\">official documentation</a> there are some (overwrited) alerts for Mac Os users related to the installation. </p>\n\n<p>Terminal outputs:</p>\n\n<pre><code>$ which ruby\n/Users/&lt;my_user_name&gt;/.rvm/rubies/ruby-1.9.2-p136/bin/ruby\n\n$ which curl\n/opt/local/bin/curl\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13118652,"title":"undefined method `stringify_keys' for \"create\":String in ruby on rails again","body":"<p>I am getting an error</p>\n\n<pre><code>Started POST \"/actions\" for 127.0.0.1 at 2012-10-29 15:04:01 +0600\nProcessing by ActionsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"lfHYF3EQn1/lMReK3alX3NsGa4wSMejC/0fEeoAFYUY=\", \"commit\"=&gt;\"Create Action\"}\nCompleted 500 Internal Server Error in 1ms\n\nNoMethodError (undefined method `stringify_keys' for \"create\":String):\n  app/controllers/actions_controller.rb:43:in `new'\n  app/controllers/actions_controller.rb:43:in `create'\n</code></pre>\n\n<p>This code is totally generated by Rails, and i do not understand why it doesnt work</p>\n\n<p>Here is model</p>\n\n<pre><code>class Action &lt; ActiveRecord::Base\n  attr_accessible :name, :user_id\nend\n</code></pre>\n\n<p>Here is controller part</p>\n\n<pre><code># GET /actions/new\n# GET /actions/new.json\ndef new\n  @action = Action.new\n\n  respond_to do |format|\n    format.html # new.html.erb\n    format.json { render json: @action }\n  end\nend\n\ndef create\n  @action = Action.new(params[:action]) # here we get an error !\n\n  respond_to do |format|\n    if @action.save\n      format.html { redirect_to @action, notice: 'Action was successfully created.' }\n      format.json { render json: @action, status: :created, location: @action }\n    else\n      format.html { render action: \"new\" }\n      format.json { render json: @action.errors, status: :unprocessable_entity }\n    end\n  end\nend\n</code></pre>\n\n<p>And here is the form code</p>\n\n<pre><code>&lt;%= form_for(@action) do |f| %&gt;\n  &lt;% if @action.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@action.errors.count, \"error\") %&gt; prohibited this action from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @action.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :user_id %&gt;&lt;br /&gt;\n    &lt;%= f.number_field :user_id %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When i press post, firebug shows this request parameters </p>\n\n<pre><code>utf8:✓\nauthenticity_token:lfHYF3EQn1/lMReK3alX3NsGa4wSMejC/0fEeoAFYUY=\naction[name]:sdf\naction[user_id]:23\ncommit:Create Action\n</code></pre>\n\n<p>if i understand correctly this must work and rails must turn action[name] and action[user_id] into hash table and place it into parameters[:action], then Action.new get this hash table as parameter. What is wrong ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","get","form-for","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13118467,"title":"dealing with complex GET params in rails","body":"<p>I'm trying to pass params via GET to a form using ransack, it would normally work fine except that the params[:q] is causing a problem when I try to merge it.</p>\n\n<p>controller (using <a href=\"https://github.com/ernie/ransack\" rel=\"nofollow\">ransack</a>)</p>\n\n<pre><code>  def index\n    @search = Record.ransack(params[:q])\n    @records = @search.result.page(params[:page])\n  end\n</code></pre>\n\n<p>view</p>\n\n<pre><code>&lt;ul&gt;\n  &lt;% Genre.all.each do |genre| %&gt;\n    &lt;% category_count = @search.result.joins(:genre).where(\"genres.id = ?\", genre.id).size %&gt;\n    &lt;% unless category_count == 0 %&gt;\n        &lt;li&gt;\n            &lt;%= link_to genre.name, params.merge(:\"q[genre_name_eq]\" =&gt; genre.name) %&gt; (&lt;%= category_count %&gt;)\n        &lt;/li&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>But I keep getting duplication:</p>\n\n<pre><code>q[genre_name_eq]=Rockabilly&amp;q[genre_name_eq]=Rockabilly\n</code></pre>\n\n<p>Without the q[] it manages the params correctly, overwriting the previous one.</p>\n\n<p>Also tried <code>params[:q].merge(:genre_name_eq)</code> which causes the problem when there is no q[] and it also just doesn't work, giving me <code>genre_name_eq=</code> and no q[]</p>\n\n<p>How else can I handle the q[] so that it replaces the value instead of duplicating it several times?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","custom-routes"],"answer_count":2,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2750,"score":9,"question_id":4271023,"title":"Rails3 Routes - Passing parameter to a member route","body":"<p>I would like to pass an extra parameter to a member route of a resource</p>\n\n<p>something like:</p>\n\n<pre><code>resources :events do\n  member do\n    get 'register/:participant_type_id'\n  end\nend\n</code></pre>\n\n<p>I could only accomplish it using a static match statement</p>\n\n<p>Looking around the internet I saw that this might be possible in Rails 3.0.2. I'm using 3.0.1 and it certanlly is not.</p>\n\n<p>Am I doing something wrong? or is it really not possible?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","apache","passenger"],"answer_count":3,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":8340,"score":3,"question_id":6162196,"title":"Setting up Rails app on Apache with passenger - Rails doesn't seem to load","body":"<p>I am trying to set up Rails on a Ubuntu instance by following along with documentation such as <a href=\"https://help.ubuntu.com/community/RubyOnRails\" rel=\"nofollow\">https://help.ubuntu.com/community/RubyOnRails</a>.  I am trying to set up the app from the Rails Getting Started page here: <a href=\"http://guides.rubyonrails.org/getting_started.html\" rel=\"nofollow\">http://guides.rubyonrails.org/getting_started.html</a>.</p>\n\n<p>What I have done so far:</p>\n\n<ul>\n<li>Installation of Ruby/RubyGems/Rails through RVM and GEM (this installed Ruby 1.9.2 and Rails 3.0.7)</li>\n<li>Installation of the mysql and mysql2 module (latter which didn't work)</li>\n<li>Creation of rails app (blog app as tutorial is instructing)</li>\n<li>Sym linking of /home/me/www/blog/public/ from /var/www/blog/</li>\n<li>Creation of DB through rake</li>\n<li>Installation of passenger module for Rails execution in Apache</li>\n<li>Running of <code>passenger-install-apache2-module</code> to configure Apache</li>\n<li>Deletion of public.html file from public/ rails app folder so that my controller/view can fire</li>\n<li>Configuration of sites-available files for virtual hosts</li>\n<li>Configuration of Rails routing</li>\n</ul>\n\n<p>I believe it is the last two steps that are tripping me up, partly due to lack of familiarity with Apache and Rails (I am new to both).</p>\n\n<p>In my virtual host file I am trying to point to the blog public dir in /var/www/blog.  For my Rails route I have <code>root :to =&gt; \"home#index\"</code> as instructed.</p>\n\n<p>When I browse to the http:// url I should normally be seeing my \"Hello, Rails!\" page per section 4.3 of the Getting Started guide, however all I see is the directory listing from Apache.  Static pages work but not Rails processing.</p>\n\n<p>At this point I am unclear if the passenger module is even doing anything or where to look for any evidence of what is happening.  I tried various things like running the Rails app off a different virtual host called \"blog\" at http:///blog and the routing worked (static pages and all) but no Rails as above.</p>\n\n<p>Update: after playing around some more, I now get a new error message (404):</p>\n\n<blockquote>\n  <p>Not Found</p>\n  \n  <p>The requested URL /dispatch.cgi was\n  not found on this server.</p>\n</blockquote>\n\n<p>I have since determined that this cgi 404 was caused by a rewrite rule I had added to .htaccess from guidance from the help.ubuntu.com page I pointed out above.  Looks like it wasn't necessary or applied to an older version of Rails.  The inconsistencies in instructions when looking up help online is disorienting!  Removing the file leaves me with the previous problem though.</p>\n\n<p>Here's the entry in the Apache log that I believe correlates with the first error.  Although I am no longer getting this error it seems, may be related to something else I was trying before...</p>\n\n<pre><code>[Fri May 27 22:49:41 2011] [notice] Apache/2.2.16 (Ubuntu) PHP/5.3.3-1ubuntu9 with Suhosin-Patch Phusion_Passenger/3.0.7 configured -- resuming normal operations\n[Fri May 27 22:51:18 2011] [error] [client 192.168.1.141] File does not exist: /var/www/blog/rails, referer: http://192.168.1.138/blog/\n</code></pre>\n\n<p>Here's the most recent entry with the 404 on the cgi thing:</p>\n\n<pre><code>[Sat May 28 08:01:18 2011] [error] [client 192.168.1.141] File does not exist: /var/www/blog/dispatch.cgi\n</code></pre>\n\n<p>What could I be missing?  Thanks!</p>\n\n<hr>\n\n<p>Additional details as requested.  Apache sites file:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@localhost\n\n        DocumentRoot /var/www/blog/\n    RailsEnv development\n\n        # &lt;Directory /&gt;\n        #       Options FollowSymLinks\n        #       AllowOverride None\n        # &lt;/Directory&gt;\n\n        &lt;Directory \"/var/www/blog/\"&gt;\n        Options Indexes FollowSymLinks -MultiViews +ExecCGI\n                AllowOverride All\n                Order allow,deny\n                allow from all\n        # AddHandler cgi-script .cgi\n        &lt;/Directory&gt;\n\n        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/\n    &lt;Directory \"/usr/lib/cgi-bin\"&gt;\n                AllowOverride None\n                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n                Order allow,deny\n                Allow from all\n        &lt;/Directory&gt;\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n\n        # Possible values include: debug, info, notice, warn, error, crit,\n        # alert, emerg.\n        LogLevel warn\n\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    Alias /doc/ \"/usr/share/doc/\"\n    &lt;Directory \"/usr/share/doc/\"&gt;\n        Options Indexes MultiViews FollowSymLinks\n    AllowOverride None\n        Order deny,allow\n        Deny from all\n        Allow from 127.0.0.0/255.0.0.0 ::1/128\n    &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p><strong>Another update:</strong> I was able to get it working, finally, by using a top level DocumentRoot (/var/www) and basing my Rails app off that using RailsBaseURI.  This maps to the \"Deploying to a sub URI\" section of the Phusion Passenger instructions.  It is used as http:///blog which is not really what I wanted to get, but it's kind of irrelevant as I am using this just to learn Rails in a virtual.  I will need to go and work on getting it working as a top level app again sometime later.  Here's my current (final) VirtualHost file for reference:</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n        ServerAdmin webmaster@localhost\n\n        DocumentRoot /var/www/\n        RailsEnv development\n\n        &lt;Directory /var/www/&gt;\n          Options FollowSymLinks\n          AllowOverride None\n        &lt;/Directory&gt;\n\n    RailsBaseURI /blog\n        &lt;Directory /var/www/blog/&gt;\n                Options Indexes FollowSymLinks -MultiViews +ExecCGI\n                AllowOverride All\n                Order allow,deny\n                allow from all\n                # AddHandler cgi-script .cgi\n        &lt;/Directory&gt;\n\n        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/\n        &lt;Directory \"/usr/lib/cgi-bin\"&gt;\n                AllowOverride None\n                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch\n                Order allow,deny\n                Allow from all\n        &lt;/Directory&gt;\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n\n        # Possible values include: debug, info, notice, warn, error, crit,\n        # alert, emerg.\n        LogLevel warn\n\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n    Alias /doc/ \"/usr/share/doc/\"\n    &lt;Directory \"/usr/share/doc/\"&gt;\n        Options Indexes MultiViews FollowSymLinks\n        AllowOverride None\n        Order deny,allow\n        Deny from all\n        Allow from 127.0.0.0/255.0.0.0 ::1/128\n    &lt;/Directory&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","bundler"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12454217,"title":"Using bundler to manage non-gems","body":"<p>There is a github repo I want to fetch code from which isn't a gem. It is a bunch of javascript files, and it has no gem version. Can I add this to the Gemfile and define where it should be stored (under the lib/assets) directory, or will I have to manage this with a git submodule?</p>\n"},{"tags":["css","ruby-on-rails-3","render"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13118152,"title":"rendering a template while maintaining the css attributes","body":"<p>I am using devise for authentication</p>\n\n<p>under /devise/sessions/new.html.erb I have everything that relates to my sign-in page (form, markup, etc).</p>\n\n<p>In my root page, I'd like to just render new.html.erb instead of copy-paste the code to it.</p>\n\n<p><code>&lt;%= render '/devise/sessions/new' %&gt;</code> gives me a missing template error and its looking for a partial.</p>\n\n<p>However, if I rename new.html.erb to _new.html.erb it gives me the original /devise/sessions/new and not my editting one</p>\n\n<p>So I use <code>&lt;%= render :template =&gt; '/devise/sessions/new' %&gt;</code> to render it and seems to work fine, but the problem is the my root page (pages#home) looks something like this</p>\n\n<pre><code>   &lt;div class=\"landingPageContentWrap signInUpForm\"&gt;\n\n    ...lots of stuff here ...\n     &lt;%= render :template =&gt; '/devise/sessions/new' %&gt;  \n\n    &lt;/div&gt;\n</code></pre>\n\n<p>Is there way to input the css attributes that surround the render to be integrated within the template, such that if I call /devise/sessions/new directly it will be with the same CSS attributes as the root page? Or must I set the sign-in page with a duplicate css tags?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","rvm"],"answer_count":8,"favorite_count":8,"up_vote_count":17,"down_vote_count":0,"view_count":10597,"score":17,"question_id":6278047,"title":"Could not find rails (>= 0) amongst [] (Gem::LoadError)","body":"<p>After installing rvm, updating .gmrc file, updating rubygems and running gem install rails -v \">=3.1.0rc\", I now seem to have a complete mess:</p>\n\n<p>$ rails -v\n/usr/local/lib/site_ruby/1.8/rubygems/dependency.rb:247:in <code>to_specs': Could not find rails (&gt;= 0) amongst [] (Gem::LoadError)\n    from /usr/local/lib/site_ruby/1.8/rubygems/dependency.rb:256:in</code>to_spec'\n    from /usr/local/lib/site_ruby/1.8/rubygems.rb:1182:in `gem'\n    from /var/lib/gems/1.8/bin/rails:18</p>\n\n<p>myhome@myhome-mini:~$ gem env</p>\n\n<p>RubyGems Environment:</p>\n\n<ul>\n<li><p>RUBYGEMS VERSION: 1.6.2</p></li>\n<li><p>RUBY VERSION: 1.9.2 (2011-02-18 patchlevel 180) [i686-linux]</p></li>\n<li><p>INSTALLATION DIRECTORY: /home/myhome/gems</p></li>\n<li><p>RUBY EXECUTABLE: /home/myhome/.rvm/rubies/ruby-1.9.2-p180/bin/ruby</p></li>\n<li><p>EXECUTABLE DIRECTORY: /home/myhome/gems/bin</p></li>\n<li><p>RUBYGEMS PLATFORMS:</p>\n\n<ul>\n<li><p>ruby</p></li>\n<li><p>x86-linux</p></li>\n</ul></li>\n<li><p>GEM PATHS:</p>\n\n<ul>\n<li><p>/home/myhome/gems</p></li>\n<li><p>/usr/lib/ruby/gems/1.8</p></li>\n</ul></li>\n<li><p>GEM CONFIGURATION:</p>\n\n<ul>\n<li><p>:update_sources => true</p></li>\n<li><p>:verbose => true</p></li>\n<li><p>:benchmark => false</p></li>\n<li><p>:backtrace => false</p></li>\n<li><p>:bulk_threshold => 1000</p></li>\n<li><p>\"gemhome\" => \"/home/myhome/gems\"</p></li>\n<li><p>\"gempath\" => [\"/home/myhome/gems\", \"/usr/lib/ruby/gems/1.8\"]</p></li>\n</ul></li>\n<li><p>REMOTE SOURCES:</p>\n\n<ul>\n<li><a href=\"http://rubygems.org/\">http://rubygems.org/</a></li>\n</ul></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization","i18n-gem","rails-i18n"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13028998,"title":"Does Rails engines support i18n","body":"<p>What I am trying to do is have a translation file in my engine. I have placed files in</p>\n\n<blockquote>\n  <p>config</p>\n\n<pre><code> \\locales\n\n     \\fr.yml\n</code></pre>\n</blockquote>\n\n<p>Now I am writing translation for string hello</p>\n\n<p>fr:\n  \"Hello\":\"Bonjour\"\nbut I am getting translation error. When I use same line in my application translate file it works.</p>\n\n<p>I just want to know whether translation files in engines work or not? If yes can you tell the error I am doing. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","haml","actionview"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1784,"score":2,"question_id":6227945,"title":"Rails 3 not loading HAML handler","body":"<p>I'm having some problems with Rails 3 and HAML in my application: for some reason Rails appears not to be loading the handler for dealing with haml files. Every action gives an error message similar to this one:</p>\n\n<hr>\n\n<h2><strong>Template is missing</strong></h2>\n\n<p>Missing template contact_search/index with {:formats=>[:html], :handlers=>[:rjs, :rhtml, :rxml, :builder, :erb], :locale=>[:en, :en]} in view paths \"/var/www/osphonebook/app/views\", \"/var/www/osphonebook/vendor/bundle/ruby/1.8/gems/devise-1.3.4/app/views\"</p>\n\n<hr>\n\n<p>Look at the \"handlers\" options: it does not have :haml...</p>\n\n<p>The thing is that this only happens during production mode on the server set up by my company. On development and test modes it works fine. Also, if I start the application in production mode on my development PC, it works.</p>\n\n<p>Some info about the server:</p>\n\n<p><strong>UPDATE (6/6/2011): upgraded to Ruby 1.9</strong>, and it still does not work.</p>\n\n<pre><code>ruby 1.9.2p0 (2010-08-18 revision 29036) [i486-linux]\n\nGems included by the bundle:\nabstract (1.0.0)\nactionmailer (3.0.7)\nactionpack (3.0.7)\nactivemodel (3.0.7)\nactiverecord (3.0.7)\nactiveresource (3.0.7)\nactivesupport (3.0.7)\narel (2.0.10)\nbcrypt-ruby (2.1.4)\nbuilder (2.1.2)\nbundler (1.0.14)\ndevise (1.3.4)\nerubis (2.6.6)\nhaml (3.1.1)\ni18n (0.5.0)\nkgio (2.4.1)\nmail (2.2.19)\nmime-types (1.16)\norm_adapter (0.0.5)\npg (0.11.0)\npolyglot (0.3.1)\nrack (1.2.3)\nrack-mount (0.6.14)\nrack-test (0.5.7)\nrails (3.0.7)\nrailties (3.0.7)\nrake (0.8.7)\nsass (3.1.2)\nsqlite3 (1.3.3)\nthor (0.14.6)\ntreetop (1.4.9)\ntzinfo (0.3.27)\nunicorn (3.6.2)\nwarden (1.0.4)\n</code></pre>\n\n<p>If more info is needed, please comment the question, and I'll update it. Thanks for any help.</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":30,"score":3,"question_id":13115772,"title":"How do I create a rails migration to remove/change precision and scale on decimal?","body":"<p>I am trying to remove the precision and scale attributes from decimal (PostgreSQL <code>NUMERIC</code>) fields in my database?</p>\n\n<p>The fields:</p>\n\n<pre><code>t.decimal  \"revenue_per_transaction\", :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"item_quantity\",           :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"goal_conversion\",         :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"goal_abandon\",            :precision =&gt; 8, :scale =&gt; 2\nt.decimal  \"revenue\",                 :precision =&gt; 8, :scale =&gt; 2\n</code></pre>\n\n<p>What do I need to add to my migration to change these to unbounded scale and precision, or to increase the scale? At the moment I'm hitting the scale limit and getting errors like:</p>\n\n<pre><code>ERROR:   numeric field overflow\n</code></pre>\n\n<p>Here's the context: <a href=\"http://stackoverflow.com/questions/13115229/pgerror-numeric-field-overflow-on-heroku/13115261\">&quot;PG::Error - numeric field overflow&quot; on Heroku</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":255,"score":2,"question_id":12018799,"title":"MongoID, Heroku, MongoLab/HQ, w/o addons","body":"<p>I currently want to test out heroku mongoid mongolab/mongohq.</p>\n\n<p>however, i don't want to work with heroku addons, instead, i want to config mongoid to directly use a mongolab/mongohq database via uri oder other settings. However, this doesn't really work out well.</p>\n\n<p>Heres what i've done so far:</p>\n\n<pre><code>rails new test-mongoid --skip-active-record\n</code></pre>\n\n<p>Gemfile</p>\n\n<pre><code>gem 'mongoid'\ngem 'haml'\ngem 'sass'\n\nrails g mongoid:config\n</code></pre>\n\n<p>scaffolded a test model</p>\n\n<pre><code>rails g scaffold Article title:string body:string\n</code></pre>\n\n<p>mongoid.yml</p>\n\n<pre><code>production:\n  host: &lt;%= ENV['MONGOID_HOST'] %&gt;\n  port: &lt;%= ENV['MONGOID_PORT'] %&gt;\n  username: &lt;%= ENV['MONGOID_USERNAME'] %&gt;\n  password: &lt;%= ENV['MONGOID_PASSWORD'] %&gt;\n  database: &lt;%= ENV['MONGOID_DATABASE'] %&gt;\n</code></pre>\n\n<p>other try already did with mongoid.yml</p>\n\n<pre><code>production:\n  uri: mongodb://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;database&gt;\n</code></pre>\n\n<p>filled in with my username password etc.</p>\n\n<p>tested it locally with a mongodb, everything worked fine. pushed it to heroku, does not work.</p>\n\n<p>anyone already did it this way to bypass those heroku addons and know how to handle it?</p>\n\n<p>sincerely,\ncschaeffler</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>configured my mongoid.yml like this</p>\n\n<pre><code>production:\n  sessions:\n    default:\n      hosts:\n        - &lt;server&gt;:&lt;port&gt;\n      username: &lt;username&gt;\n      password: &lt;password&gt;\n      database: &lt;dbname&gt;\n</code></pre>\n\n<p>seems to be running... but if i try to go to the scaffolded Article index\napp.herokuapp.com/articles</p>\n\n<p>i get</p>\n\n<pre><code>[2012-08-18 21:54:30] INFO  WEBrick 1.3.1\n[2012-08-18 21:54:30] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]\n[2012-08-18 21:54:30] INFO  WEBrick::HTTPServer#start: pid=2 port=57443\nState changed from starting to up\n=&gt; Booting WEBrick\n=&gt; Rails 3.2.1 application starting in production on http:// 0.0. 0.0:57443\n=&gt; Ctrl-C to shutdown server\n=&gt; Call with -d to detach\nStarted GET \"/articles\" for 79.199.52.102 at 2012-08-18 21:54:31 +0000\nProcessing by ArticlesController#index as HTML\nCompleted 500 Internal Server Error in 264ms\nActionView::Template::Error (undefined method `[]' for nil:NilClass):\n11: \n10:   &lt;/tr&gt;\n\n14:     &lt;td&gt;&lt;%= article.title %&gt;&lt;/td&gt;\n15:     &lt;td&gt;&lt;%= article.body %&gt;&lt;/td&gt;\n13:   &lt;tr&gt;\nRendered articles/index.html.erb within layouts/application (208.2ms)\n9:     &lt;th&gt;&lt;/th&gt;\n12: &lt;% for article in @articles %&gt;\napp/controllers/articles_controller.rb:7:in `index'\n\napp/views/articles/index.html.erb:12:in    _app_views_articles_index_html_erb__1324099721200765517_18939540'\n\ncache: [GET /articles] miss\nGET safe-atoll-7856.herokuapp.com/articles dyno=web.1 queue=0 wait=0ms service=342ms status=500 bytes=643\nStopping remaining processes with SIGKILL\nError R12 (Exit timeout) -&gt; At least one process failed to exit within 10 seconds of SIGTERM\nProcess exited with status 137\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":13,"score":1,"question_id":13115575,"title":"Rails has_many without foreign_key lookup","body":"<p>Is it possible to remove foreign_key lookup on a has_many relationship?</p>\n\n<p>I'm mapping a legacy database, and one of the columns references a belongs_to like so:</p>\n\n<pre><code>'OBJ:123'\n'OBJ:434'\n..etc\n</code></pre>\n\n<p>I have previously obtained this collection:</p>\n\n<pre><code>Article\n  def collection\n      where(\"col = 'OBJ:#{id}'\")\n  end\nend\n</code></pre>\n\n<p>This doesn't work through has_many because active_record insists on a foreign_key:</p>\n\n<pre><code>... WHERE obj_id = 123 AND (col = 'OBJ:123') ...\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>... WHERE col = 'OBJ:123' ...\n</code></pre>\n\n<p>I will eventually create a new column and migrate the data, but there are millions of rows and I just need a quick way to interact with the data.</p>\n"},{"tags":["ruby-on-rails-3","postgresql","datamapper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":10281864,"title":"How do I adjust a column length in postgreSQL DB with a Datamapper migration?","body":"<p>I'm using <a href=\"https://github.com/datamapper/dm-migrations/\" rel=\"nofollow\">dm-migrations</a> to create a custom migration for my database.</p>\n\n<p>However, I can't seem to find an example of modifying the length of a column. Can someone please explain how this done? I'm using a postgresql database on rails 3.</p>\n\n<p>UPDATE:</p>\n\n<p>I've tried the following:</p>\n\n<pre><code>migration 1, :modify_course_url_length do\n  up do\n    modify_table :hotels do\n      change_column :url, String, :length =&gt; 255\n    end\n  end\nend\n</code></pre>\n\n<p>but it looks as though I need to get <code>change_column_type_statement</code> method working since its a postgresql db.</p>\n\n<p>UPDATE 2:</p>\n\n<p>It seems the problem is that the outputted SQL is:</p>\n\n<p>ALTER TABLE \"hotels\" ALTER COLUMN \"url\" VARCHAR(255)</p>\n\n<p>whilst it needs to be</p>\n\n<p>ALTER TABLE \"hotels\" ALTER COLUMN \"url\" TYPE VARCHAR(255)</p>\n\n<p>Anyone have any ideas on this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","nginx","unicorn"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":88,"score":3,"question_id":12596345,"title":"unicorn timeout handling","body":"<p>I'm wondering what is the best way to track unicorn timeouts from my app.</p>\n\n<p>There are some bits of the app which are slow and they currently timeout quietly. I could increase the timeout but that is shoving the problem under the carpet. Ideally, I would like to get an airbrake notification or something of that effect. I'm not looking for a performance guide, just a way to efficiently and reliably get informed about timeouts.</p>\n\n<p>How have other people handled timeouts from their rails app using unicorn? scan the nginx error log? plug in a handler in unicorn config? handler in nginx config?</p>\n\n<p>[Ubuntu 12.04+nginx+unicorn+rails 3.2+ruby 1.9.3]</p>\n"},{"tags":["ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13115049,"title":"Rails: ajax submit form to an action with nested resources","body":"<p>This is a part of the <strong>show</strong> view of the <strong>exercise</strong> model:</p>\n\n<pre><code>&lt;div id=\"smoke_screen\" style=\"min-height:100px\"&gt;\n\n    &lt;% question =  @exercise.random_question %&gt;\n    &lt;b class=\"question\"&gt;&lt;%= question.name %&gt;&lt;/b&gt;\n\n    &lt;ul&gt;\n        &lt;% question.answers.each do |answer| %&gt;\n            &lt;li&gt;&lt;%= answer.content %&gt;&lt;/li&gt;\n\n        &lt;% end %&gt;\n    &lt;/ul&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p>And it looks like this in the browser:</p>\n\n<p><img src=\"http://i.stack.imgur.com/QfzAh.png\" alt=\"enter image description here\"></p>\n\n<p>@answer and @question are nested models of exercise (exercise has_many questions, question has_many answers) and this is all viewed from the show view of the exercise model.</p>\n\n<p>I'm trying to add a radio button to each answer and make an ajax call to an action i'll create named \"save_answer\". This action will receive both the question and answer objects, save the answer and return another question that will replace the #smoke_screen using ajax.</p>\n\n<p>I'm new to rails, tried plenty of things with <code>form_to</code> with the attribute <code>:remote =&gt; true</code> without success. I will appreciate any direction on how to approach this</p>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","activerecord","entity-attribute-value"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13035744,"title":"Advice on handling versioning of an EAV-model table","body":"<p>there are <a href=\"https://www.ruby-toolbox.com/categories/Active_Record_Versioning\" rel=\"nofollow\">many</a> ActiveRecord versioning gems available to Rails but most if not all of them are having <a href=\"https://github.com/laserlemon/vestal_versions/commit/394cf8dd0073af3885aa816af38249c09d725d5a\" rel=\"nofollow\">trouble</a> <a href=\"http://airbladesoftware.com/notes/papertrail-transfer\" rel=\"nofollow\">being</a> <a href=\"https://github.com/technoweenie/acts_as_versioned/graphs/commit-activity\" rel=\"nofollow\">maintained</a>. on top of that, some of them seem to have various <a href=\"https://github.com/airblade/paper_trail/issues/12\" rel=\"nofollow\">foreign</a> <a href=\"https://github.com/airblade/paper_trail/pull/44\" rel=\"nofollow\">key</a> <a href=\"https://github.com/airblade/paper_trail/issues/121\" rel=\"nofollow\">association</a> <a href=\"https://github.com/airblade/paper_trail/issues/148\" rel=\"nofollow\">issues</a>.</p>\n\n<p>I'm in the process of coding a content management system where pages are stored in a tree-like hierarchy and the page fields are stored in a separate table using <a href=\"http://en.wikipedia.org/wiki/Entity-attribute-value_model#Example\" rel=\"nofollow\">EAV model</a>.</p>\n\n<p>keeping that in mind, I'm not looking for an all encompassing revisioning gem because I honestly don't think I'll find one. what I am looking for is some advice on how to handle this as a custom implementation. should I have a separate table for storing revisions and referring to a revision number in my EAV table? I foresee that this may lead to some complex validation problems though. I currently have a problem finding a clean way to validate a regular EAV table anyway so if anyone can comment on this it would be very much appreciated as well.</p>\n\n<p>I hope this question is written well enough to SO standards. if you need any additional information, please do not hesitate to ask and I will try to help you help me. :)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","osx","postgresql","osx-lion"],"answer_count":14,"favorite_count":50,"up_vote_count":112,"down_vote_count":0,"view_count":32733,"score":112,"question_id":6770649,"title":"Repairing Postgresql after upgrading to OSX 10.7 Lion","body":"<p>I recently upgraded to OSX 10.7, at which point my rails installation completely borked when trying to connect to the psql server.   When I do it from the command line using </p>\n\n<pre><code>psql -U postgres\n</code></pre>\n\n<p>it works totally fine, but when I try to run the rails server or console with the same username and password, I get this error </p>\n\n<pre><code>...activerecord-3.0.9/lib/active_record/connection_adapters/postgresql_adapter.rb:950:in `initialize': could not connect to server: Permission denied (PGError) \nIs the server running locally and accepting\n    connections on Unix domain socket \"/var/pgsql_socket/.s.PGSQL.5432\"?\n</code></pre>\n\n<p>Any ideas what might be going on would be super helpful!  Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","devise","cancan"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13075972,"title":"Rspec controller error expecting <\"index\"> but rendering with <\"\">","body":"<p>New to testing, I'm struggling to get some controller tests to pass.</p>\n\n<p>The following controller test throws the error:</p>\n\n<pre><code>   expecting &lt;\"index\"&gt; but rendering with &lt;\"\"&gt;\n</code></pre>\n\n<p>I have the following in one of my controller specs:</p>\n\n<pre><code>  require 'spec_helper'\n\n  describe NasController do\n\n  render_views\n  login_user\n\n  describe \"GET #nas\" do\n      it \"populates an array of devices\" do\n        @location = FactoryGirl.create(:location)\n        @location.users &lt;&lt; @current_user\n        @nas = FactoryGirl.create(:nas, location_id: @location.id )      \n        get :index\n        assigns(:nas).should eq([@nas])\n      end\n\n      it \"renders the :index view\" do\n        response.should render_template(:index)\n      end\n    end\n</code></pre>\n\n<p>In my controller macros, I have this:</p>\n\n<pre><code>  def login_user\n    before(:each) do\n      @request.env[\"devise.mapping\"] = Devise.mappings[:user]\n      @current_user = FactoryGirl.create(:user)\n      @current_user.roles &lt;&lt; Role.first\n      sign_in @current_user\n      User.current_user = @current_user\n      @user = @current_user\n      @ability = Ability.new(@current_user)\n    end\n  end\n</code></pre>\n\n<p>I'm using devise and cancan and have followed their guides re. testing. I believe my users are signed in before and have the ability to view the index action.</p>\n\n<p>What can I do to get the tests to pass?</p>\n\n<p>-- UPDATE 1 --</p>\n\n<p>Controller code:</p>\n\n<pre><code>class NasController &lt; ApplicationController\n   before_filter :authenticate_user!\n   load_and_authorize_resource\n\n   respond_to :js\n\n   def index\n\n     if params[:location_id]\n       ...\n     else\n     @nas = Nas.accessible_by(current_ability).page(params[:page]).order(sort_column + ' ' + sort_direction)\n\n     respond_to do |format|\n      format.html # show.html.erb\n     end    \n    end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","unicorn"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13100330,"title":"Unicorn loading initializers","body":"<p>I'm in the process of migrating from Thin to Unicorn. I've had success with most of the website except loading a specific Gem package. I don't think it's the package itself, but rather how Unicorn interacts with the Initializer files.</p>\n\n<p>Here's my current <code>unicorn.rb</code> setup. I didn't use before_fork or after_fork since I'm using Mongoid.</p>\n\n<pre><code>worker_processes 3\ntimeout 30\npreload_app true\n</code></pre>\n\n<p>The initializer file is in <code>/config/initializers/asin.rb</code></p>\n\n<pre><code>ASIN::Configuration.configure do |config|\n  config.secret        = ENV['AMAZON_SECRET']\n  config.key           = ENV['AMAZON_KEY']\n  config.associate_tag = ENV['AMAZON_TAG']\n  config.version       = ENV['AMAZON_VERSION']\nend\n</code></pre>\n\n<p>Does Rails automatically load the info inside the initializer files?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","payment-processing","stripe-payments"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":236,"score":0,"question_id":11068856,"title":"Integrating stripe with Devise","body":"<p>I am following along with railscast #288 on stripe but I am having some difficulty with setting the stripe hidden token. I am using the most recent version of devise with simple form integration. </p>\n\n<p>Here is my Registrations Controller:</p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n\n  def create\n    build_resource \n    if resource.save_with_payment\n      if resource.active_for_authentication?\n        set_flash_message :notice, :signed_up if is_navigational_format?\n        sign_in(resource_name, resource)\n        respond_with resource, :location =&gt; after_sign_up_path_for(resource)\n      else\n        set_flash_message :notice, :\"signed_up_but_#{resource.inactive_message}\" if is_navigational_format?\n        expire_session_data_after_sign_in!\n        respond_with resource, :location =&gt; after_inactive_sign_up_path_for(resource)\n      end\n    else\n      clean_up_passwords resource\n      respond_with resource\n    end\n  end\n</code></pre>\n\n<p>My form for registering a new user:</p>\n\n<pre><code>&lt;%= simple_form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name), :html =&gt; {:class =&gt; 'well'} ) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n  &lt;%= f.error_messages %&gt;\n  &lt;h3 class=\"center\"&gt;Create your credentials for logging in:&lt;/h3&gt;&lt;hr&gt;\n  &lt;div class=\"inputs\"&gt;\n    &lt;%= f.input :email, :required =&gt; true  %&gt;\n    &lt;%= f.input :password, :required =&gt; true %&gt;\n    &lt;%= f.input :password_confirmation, :required =&gt; true %&gt;\n  &lt;h3 class=\"center\"&gt;Are you a Shipper or a Carrier?&lt;/h3&gt;&lt;hr&gt;\n    &lt;%= f.input :role, :collection =&gt; User::ROLES, :as =&gt; :radio_buttons %&gt;\n    &lt;%= f.input :stripe_card_token, :as =&gt; :hidden %&gt;\n  &lt;/div&gt;\n  &lt;h3 class=\"center\"&gt;Your Credit Card Information:&lt;/h3&gt;&lt;hr&gt;\n  &lt;fieldset&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :card_number, \"Credit Card Number\" %&gt;\n      &lt;div class=\"input-prepend inline-block\"&gt;\n      &lt;span class=\"add-on\"&gt;&lt;strong&gt;#&lt;/strong&gt;&lt;/span&gt;\n      &lt;%= text_field_tag :card_number, nil, name: nil %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :card_code, \"Security Code on Back of Card (CVV)\" %&gt;\n      &lt;div class=\"input-prepend inline-block\"&gt;\n      &lt;span class=\"add-on icon-credit-card\"&gt;&lt;/span&gt;\n      &lt;%= text_field_tag :card_code, nil, name: nil, :size =&gt; 4  %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag :card_month, \"Card Expiration\" %&gt;\n      &lt;%= select_month nil, { add_month_numbers: true }, { name: nil, id: \"card_month\" } %&gt;\n      &lt;%= select_year nil, { start_year: Date.today.year, end_year: Date.today.year+15 },\n  { name: nil, id: \"card_year\" } %&gt;\n    &lt;/div&gt;\n    &lt;div id=\"stripe_error\"&gt;\n      &lt;noscript&gt;JavaScript is not enabled and is required for this form. First enable it in your web browser settings.&lt;/noscript&gt;\n    &lt;/div&gt;\n  &lt;/fieldset&gt;\n  &lt;hr&gt;\n  &lt;%= f.input :terms, :as =&gt; :boolean, label: \"* I have read and agreed to the terms of service\" %&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.button :submit, \"Sign up\", class: \"btn-large icon-thumbs-up\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I have a user model with the following attributes: </p>\n\n<pre><code>attr_accessible :email, :password, :password_confirmation, :remember_me, :role, :terms, :stripe_token, :stripe_card_token\n</code></pre>\n\n<p>And Finally the coffeescript to get this all to work correctly:</p>\n\n<pre><code>jQuery -&gt;\nStripe.setPublishableKey($('meta[name=\"stripe-key\"]').attr('content'))\nsubscription.setupForm()\n\nsubscription = \n  setupForm: -&gt;\n    $('#new_user').submit -&gt;\n        $('input[type=submit]').attr('disabled', true)\n        if $('#card_number').length\n            subsciption.processCard()\n            false\n        else\n            true\n\nprocessCard: -&gt;\n    card =\n        number: $('#card_number').val()\n        cvc: $('#card_code').val()\n        expMonth: $('#card_month').val()\n        expYear: $('#card_year').val()\n    Stripe.createToken(card, subscription.handleStripeResponse)\n\nhandleStripeResponse: (status, response) -&gt;\n    if status == 200\n        $('#user_stripe_card_token').val(response.id)\n        $('#new_user')[0].submit()\n    else \n        $('#stripe_error').text(response.error.message)\n        $('input[type=submit]').attr('disabled', false)\n</code></pre>\n\n<p>When I go to create a new user my action controller is giving me the following error message:</p>\n\n<pre><code>undefined method `stripe_card_token' for #&lt;User:0x00000103fe7b90&gt;\n</code></pre>\n\n<p>However I don't think this should be possible since I have defined this method in my attr_accessible call in my user.rb model. Any explanation would be really helpful, as I think i am 90% of the way to being done with setting this up. </p>\n"},{"tags":["ajax","ruby-on-rails-3","forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13113328,"title":"Disable-with in Rails 3.2 shows for a second then switches button back","body":"<p>I've used the data: {\"disable-with\" => \"Loading...\"} directive on a remote => true form button, but, while it used to work before a rails upgrade (i think rails 3.1) It now doesn't work as expected anymore.</p>\n\n<p>What happens is that after clicking the button, the copy switched briefly (almost too fast to notice) to the expected \"Loading...\" copy, but then switches back to the original state; while the form has clearly not finished processing the data.</p>\n\n<p>How can I fix this?</p>\n\n<h1>Update</h1>\n\n<p>I realize now the problem is due to using a rails gem \"remotipart\", which also handles ajax form submissions.</p>\n\n<p>Is there a possible work-around so both can work together as they used to?</p>\n"},{"tags":["ruby-on-rails-3","paypal","activemerchant"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":846,"score":3,"question_id":9745197,"title":"Recurring billing with Rails - what are my options?","body":"<p>Before jumping in I'd like to know what all of my options are, and, if possible their pros and cons.</p>\n\n<p>The two I know of are using ActiveMerchant, or the paypal_recurring gem, but will they satisfy these requirements?</p>\n\n<ul>\n<li>Ability to accommodate monthly and annual billing</li>\n<li>Ability to suspend, cancel accounts etc</li>\n<li>Deal with out-of-date card details or failed payments</li>\n</ul>\n\n<p>The to-do list for the paypal_recurring gem includes 'adding support for IPN' - how will not having this impact functionality? </p>\n\n<p>I know there is the railskit SaaS but I'd rather code something myself as the railskit is still on 3.2.1.</p>\n\n<p>I know there are services like cheddergedder/chargify etc, but do they tie you in? Are they US only? Are they worth considering - or are they usually just aimed at non-developers?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["sql","ruby-on-rails","ruby","ruby-on-rails-3","helper"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13114199,"title":"Scope Option in Uniqueness Helper in Rails","body":"<p>While reading the Rails Guides, I came across something I'm  unsure about. In the example, it shows that I can write a scope option that adds additional options towards checking uniqueness. My questions is, do I have to write out a method that queries specifically towards a time period. In other words, is there more code necessary than meets the eye in the example below? If not, how does Rails knows to check the right time stamp column in the table database?</p>\n\n<pre><code>class Holiday &lt; ActiveRecord::Base\n   validates :name, \n             :uniqueness =&gt; { :scope =&gt; :year,\n             :message =&gt; \"should happen once per year\" }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","omniauth","statemachine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13113100,"title":"Rails: Implementing multi-step registration processes (with OmniAuth)","body":"<p>I'm trying to implement a multi-step registration process. This particular implementation involves OmniAuth, but for the purposes of this discussion it could well be any OAuth provider.</p>\n\n<p>Here are the registration steps we might implement:</p>\n\n<p><strong>Step 1.</strong> User <em>clicks</em> Connect with <strong><em>_</em>__<em>_</em>__<em>_</em>__</strong>.</p>\n\n<p><strong>Step 2.</strong> Authorize via <strong><em>_</em>__<em>_</em>__<em>_</em>__</strong> and redirect to callback. Pull relevant data from provider and save to your <code>User</code> model.</p>\n\n<p><strong>Step 3.</strong> Pick a username, fill out email address, and any other required data for registering for your app. Also save this to your <code>User</code> model.</p>\n\n<p><strong>The problem</strong> for me lies in the transition from Step 2 to Step 3. <strong>I could</strong> set validations on the data based on state, using something like <a href=\"https://github.com/pluginaweek/state_machine\" rel=\"nofollow\"><strong>state_machine</strong></a>, for example.</p>\n\n<p><strong>However</strong>, I would have to remove not-null constraints at the column level for certain essential pieces of data, like <code>username</code> in my case (which is used for user routes), or <code>email</code>. I'm not super comfortable removing another layer of data integrity.</p>\n\n<p>I'm sure this problem has been solved a thousand times before. How have you handled it and how would you recommend I handle it?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13113829,"title":"create a model in create action from a class","body":"<p>As a newbie to rails I can't find how to solve my issue ^^<br>\nI want to create a VideoPost from a form with a text field containing a video url (like youtube)<br>\nI'm getting information on the video thanks to the gem <a href=\"https://github.com/thibaudgg/video_info\" rel=\"nofollow\">https://github.com/thibaudgg/video_info</a><br>\nAnd I want to save thoses information using a model of mine (VideoInformation).\nBut I don't know how the create process should work.<br>\nThanks for any help !</p>\n\n<p>I'm trying to create a VideoPost in VideoPostsController like this :</p>\n\n<pre><code>def create\n  video_info = VideoInfo.new(params[:video_url])\n  video_information = VideoInformation.create(video_info)      #undefined method `stringify_keys' for #&lt;Youtube:0x00000006a24120&gt;\n  if video_information.save\n    @video_post = current_user.video_posts.build(video_information) \n  end\nend\n</code></pre>\n\n<p>My VideoPost model :  </p>\n\n<pre><code># Table name: video_posts\n#\n#  id                   :integer          not null, primary key\n#  user_id              :integer\n#  video_information_id :integer\n#  created_at           :datetime         not null\n#  updated_at           :datetime         not null\n</code></pre>\n\n<p>My VideoInformation model (which got same attributes name than VideoInfo gem) :  </p>\n\n<pre><code># Table name: video_informations\n#\n#  id              :integer          not null, primary key\n#  title           :string(255)\n#  description     :text\n#  keywords        :text\n#  duration        :integer\n#  video_url       :string(255)\n#  thumbnail_small :string(255)\n#  thumbnail_large :string(255)\n#  created_at      :datetime         not null\n#  updated_at      :datetime         not null\n</code></pre>\n"},{"tags":["ruby-on-rails-3","subscription","recurring-billing"],"answer_count":3,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1026,"score":3,"question_id":5013558,"title":"How do I handle recurring/subscription billing in a Rails App?","body":"<p>I can't use Chargify, Recurly, Spreedly or any of those apps because I am not based in the US. I am in Jamaica, actually...so many of these companies don't support Jamaica.</p>\n\n<p>But I am trying to roll a custom subscription management solution - but given that this is my first web app - I think it might be too big a task for me to take on.</p>\n\n<p>Are there any gems that can handle this? These are the requirements:</p>\n\n<ul>\n<li>All users registered automatically get on a free plan for X days</li>\n<li>Towards the end of X days, they should be prompted to upgrade</li>\n<li>If they don't upgrade, at the end of X days their account gets locked/disabled</li>\n<li>If their account is disabled, they can upgrade and be taken to a checkout page (powered by 2checkout, because that is who I have to use for now).</li>\n<li>Then once they upgrade, and have selected a plan, the system should automatically increase their allocations (# of clients, # of projects, storage space, etc.)</li>\n</ul>\n\n<p>So I don't need the system to actually handle the processing of the credit cards, etc. It's more the logic of the subscription, restrictions on the models, upgrading and downgrading that I need.</p>\n\n<p>The perfect solution would be a well supported Rails gem that I can include in my Gemfile.</p>\n\n<p>If you don't have that, just send any/all possible solutions and I can take it from there.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","vestal-versions"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":271,"score":0,"question_id":3695928,"title":"Vestal Versions -","body":"<p>I'm using the Vestal Version Fork here for Rails 3 support: <a href=\"http://github.com/adamcooper/vestal_versions/\" rel=\"nofollow\">http://github.com/adamcooper/vestal_versions/</a></p>\n\n<p>The issue I'm having is that the updated_by => current_user is not storing in the versions table on update. </p>\n\n<pre><code>def update \n        @book = Book.find(params[:id]) \n  respond_to do |format| \n    if @book.update_attributes(params[:book].merge(:updated_by =&gt; current_user)) \n      format.html { redirect_to(@book, :notice =&gt; 'Book was \nsuccessfully updated.') } \n      format.xml  { head :ok } \n    else \n      format.html { render :action =&gt; \"edit\" } \n      format.xml  { render :xml =&gt; @book.errors, :status =&gt; :unprocessable_entity } \n    end \n  end \nend \n</code></pre>\n\n<p>I checked the logs, there is no error, Rails is INSERTING NULLs in the DB for the user fields, the one I need to populate is user_id</p>\n\n<p>Ideas?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","actionmailer","interceptor"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":567,"score":1,"question_id":6572344,"title":"switch mail delivery method in rails during runtime","body":"<p>I'm trying to setup a rails application so that I can choose between different mail delivery methods depending on whether some condition is true or not.</p>\n\n<p>So, given two delivery methods:</p>\n\n<pre><code>ActionMailer::Base.add_delivery_method :foo\nActionMailer::Base.add_delivery_method :bar\n</code></pre>\n\n<p>I thought I'd be able to just create an email interceptor to do something like this:</p>\n\n<pre><code>class DeliveryMethodChooser\n  def self.delivering_email(message)\n    if some_condition\n      # code to use mail delivery method foo\n    else\n      # code to use mail delivery method bar\n    end\n  end\nend\n</code></pre>\n\n<p>The problem though, is that I'm not sure how to actually set change what mail delivery method is used for a given message. Any ideas? Is it even possible to dynamically choose what delivery_method to use?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13110573,"title":"Rails attributes headache","body":"<p>newbie rails question coming up. </p>\n\n<p>I have a class like this:</p>\n\n<pre><code>class Thing &lt; ActiveRecord::Base\n    attr_accessible :name\n    attr_accessor :name\n    validates_uniqueness_of :name, :case_sensitive =&gt; false\nend\n</code></pre>\n\n<p>I have done a migration and the table looks okay. I then fire up the <code>rails console</code> and try the following:</p>\n\n<pre><code>t = Thing.new(:name =&gt; \"test\")\n=&gt; #&lt;Thing id: nil, name: nil, description: nil, created_at: nil, updated_at: nil&gt; \n</code></pre>\n\n<p>already here it says name is nil, why?\nContinuing on, I try this:</p>\n\n<pre><code>t.name\n =&gt; \"test\"\n</code></pre>\n\n<p>Now name seems to be set anyway?\nIf I try to save:</p>\n\n<pre><code>t.save!\nThing Exists (8.0ms)  SELECT 1 AS one FROM \"things\" WHERE LOWER(\"things\".\"name\") = LOWER('test') LIMIT 1\nSQL (16.0ms)  INSERT INTO \"things\" (\"created_at\", \"description\", \"name\", \"updated_at\") VALUES ('2012-10-28 16:10:12.701000', NULL, NULL, '2012-10-28 16:10:12.701000')\n=&gt; true \n</code></pre>\n\n<p>Why is the name I have specified not being saved?\nWhat I want is to be able to specify attributes as a hash when calling new and then save the instance.</p>\n"},{"tags":["ruby","ruby-on-rails-3","query","views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13111978,"title":"rendering Ruby statements inside of rails views?","body":"<p>So in my DB I want stored a ruby/HTML statement in the Database Table such as - \np This site is owned from 2000 - #{Time.now.year} by Acme Widget Co. /p </p>\n\n<p>Or let's say that I want people to be able to include in other code snippits - e.g. \nA client wants to run in a show view in the middle of a paragraph some magical partial such as  #{render 'my_magical_code'} </p>\n\n<p>On the view I have this being rendered as &lt;%= raw(@page.content) %>  </p>\n\n<p>But its like a double rendering and rails will just put on the page #{render 'my_magical_code'} or #{Time.now.year} </p>\n\n<p>So can / how do I solve this? </p>\n\n<p>Thanks! </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","foreign-keys","nested-attributes","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":57,"score":2,"question_id":13108991,"title":"Ruby on Rails: Simply Can Not Render Nested Attributes","body":"<p>I want to be able to show users who have liked a user's post. I am going to provide a simple amount of information so this issue won't get overwhelming.</p>\n\n<p>I have three classes involved:  User, Share and Opinion.  Their models are set up likewise:</p>\n\n<pre><code>class User\n  has_many :opinions, foreign_key: \"fan_id\", dependent: :destroy\nend\n\nclass Share\n  has_many :opinions, foreign_key: \"like_id\", dependent: :destroy\n  has_many :likes, through: :opinions\n  has_many :agreeables, foreign_key: \"fan_id\", class_name: \"Opinion\", dependent: :destroy\n  has_many :fans, through: :agreeables\nend\n\nclass Opinion\n  belongs_to :fan, class_name: \"User\"\n  belongs_to :like, class_name: \"Share\"\nend\n</code></pre>\n\n<p>In other words:  <code>like_id = share.id</code> &amp; <code>fan_id = user.id</code></p>\n\n<p>Then in my controller:</p>\n\n<pre><code>SharesController\n  def show\n    @share = Share.find(params[:id])\n    @shares = @share.fans.paginate(page: params[:page])\n  end\n</code></pre>\n\n<p>I click the link to <code>share_path</code>, it renders the page but with nothing on it.  When I look at my SQL logs, <strong>I notice the problem:</strong></p>\n\n<p>It is not inner joining opinions correctly to have the rendered share (<code>like_id</code>) match up with the users who liked the share (<code>fan_ids</code>).  </p>\n\n<p>Let's say the <code>share.id</code> was 11 and the <code>current_user.id</code> is 5.  It's query consists primarily of inner joining opinions to have the <code>like_id</code> <strong>AND</strong> <code>fan_id = 11</code>.</p>\n\n<p>Any ideas on how I can fix this problem or an alternate method that is more practical?</p>\n\n<p>Thanks for your help.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>For any future readers, the solution was as followed:</p>\n\n<pre><code>class User\n  has_many :fans, foreign_key: \"fan_id\", class_name: \"Opinion\", dependent: :destroy\nend\n\nclass Share\n  has_many :opinions, foreign_key: \"like_id\", dependent: :destroy\n  has_many :likes, through: :opinions\n  has_many :fans, through: :opinions\nend\n</code></pre>\n\n<p>And the <code>SharesController</code> and Opinion model was left unchanged.  </p>\n"},{"tags":["ruby-on-rails-3","sass","compass-css","scss","zurb-foundation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":13111814,"title":"app/assets/stylesheets/foundation.css.scss does not compile","body":"<p>I'm trying to get Zurb responsive to work with Rails3/Compass on an existing project. I go back and forth from fixing it and breaking it.</p>\n\n<p>It worked in development mode.  I put some effort in getting it to compile assets for production and that broke development.</p>\n\n<p>This seems to be one of those known problems where there is no documented solution\n<a href=\"http://feedback.livereload.com/knowledgebase/articles/113949-how-to-solve-zurb-foundation-import-error-in-sass-\" rel=\"nofollow\">http://feedback.livereload.com/knowledgebase/articles/113949-how-to-solve-zurb-foundation-import-error-in-sass-</a></p>\n\n<p>It chokes on resolving </p>\n\n<pre><code>// Importing all of Foundation\n@import \"ZURB-foundation\";\n</code></pre>\n\n<p>in</p>\n\n<pre><code>/home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss\n</code></pre>\n\n<p>RVM Info\n    marc@tsunami:~/rails_apps/wcaudit> rvm info</p>\n\n<pre><code>ruby-1.9.3-p286@wcaudit:\n\nsystem:\nuname:       \"Linux tsunami.site 2.6.34.10-0.6-desktop #1 SMP PREEMPT 2011-12-13 18:27:38 +0100 x86_64 x86_64 x86_64 GNU/Linux\"\nsystem:      \"unknown/libc-2.11/x86_64\"\nbash:        \"/bin/bash =&gt; GNU bash, version 4.1.7(1)-release (x86_64-suse-linux-gnu)\"\nzsh:         \"/usr/bin/zsh =&gt; zsh 4.3.10 (x86_64-unknown-linux-gnu)\"\n\nrvm:\nversion:      \"rvm 1.16.15 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\"\nupdated:      \"6 days 18 hours 5 minutes 34 seconds ago\"\n\nruby:\ninterpreter:  \"ruby\"\nversion:      \"1.9.3p286\"\ndate:         \"2012-10-12\"\nplatform:     \"x86_64-linux\"\npatchlevel:   \"2012-10-12 revision 37165\"\nfull_version: \"ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-linux]\"\n\nhomes:\ngem:          \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit\"\nruby:         \"/home/marc/.rvm/rubies/ruby-1.9.3-p286\"\n\nbinaries:\nruby:         \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\"\nirb:          \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/irb\"\ngem:          \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/gem\"\nrake:         \"/home/marc/.rvm/gems/ruby-1.9.3-p286@global/bin/rake\"\n\nenvironment:\nPATH:         \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/bin:/home/marc/.rvm/gems/ruby-1.9.3-p286@global/bin:/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin:/home/marc/.rvm/bin:/home/marc/bin:/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/X11R6/bin:/usr/games:/usr/lib64/jvm/jre/bin\"\nGEM_HOME:     \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit\"\nGEM_PATH:     \"/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit:/home/marc/.rvm/gems/ruby-1.9.3-p286@global\"\nMY_RUBY_HOME: \"/home/marc/.rvm/rubies/ruby-1.9.3-p286\"\nIRBRC:        \"/home/marc/.rvm/rubies/ruby-1.9.3-p286/.irbrc\"\nRUBYOPT:      \"\"\ngemset:       \"wcaudit\"\n</code></pre>\n\n<p>GEM LIST</p>\n\n<pre><code>marc@tsunami:~/rails_apps/wcaudit&gt; gem list\n\n*** LOCAL GEMS ***\n\nactionmailer (3.2.8)\nactionpack (3.2.8)\nactivemodel (3.2.8)\nactiverecord (3.2.8)\nactiveresource (3.2.8)\nactivesupport (3.2.8)\narel (3.0.2)\nbuilder (3.0.4)\nbundler (1.2.1)\nchunky_png (1.2.6)\ncoffee-rails (3.2.2)\ncoffee-script (2.2.0)\ncoffee-script-source (1.3.3)\ncompass (0.12.2)\ncompass-rails (1.0.3)\nerubis (2.7.0)\nexecjs (1.4.0)\nfssm (0.2.9)\nhaml (3.1.7)\nhike (1.2.1)\ni18n (0.6.1)\njourney (1.0.4)\njquery-rails (2.1.3)\njson (1.7.5)\nlibv8 (3.3.10.4 x86_64-linux)\nmail (2.4.4)\nmime-types (1.19)\nmodular-scale (1.0.2)\nmulti_json (1.3.6)\npg (0.14.1)\npolyglot (0.3.3)\nrack (1.4.1)\nrack-cache (1.2)\nrack-ssl (1.3.2)\nrack-test (0.6.2)\nrails (3.2.8)\nrailties (3.2.8)\nrake (0.9.2.2)\nrdoc (3.12)\nrubygems-bundler (1.1.0)\nrvm (1.11.3.5)\nsass (3.2.1)\nsass-rails (3.2.5)\nsassy-math (1.2)\nsprockets (2.1.3)\ntherubyracer (0.10.2)\nthor (0.16.0)\ntilt (1.3.3)\ntreetop (1.4.11)\ntzinfo (0.3.33)\nuglifier (1.3.0)\nzurb-foundation (3.1.1)\nmarc@tsunami:~/rails_apps/wcaudit&gt; \n</code></pre>\n\n<p>COMPILE PHASE</p>\n\n<pre><code>marc@tsunami:~/rails_apps/wcaudit&gt; bundle exec rake assets:precompile/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin/ruby /home/marc/.rvm/gems/ruby-1.9.3-p286@global/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets\nrake aborted!\nFile to import not found or unreadable: ZURB-foundation.\nLoad paths:\nSass::Rails::Importer(/home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss)\n/home/marc/rails_apps/wcaudit/app/assets/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/blueprint/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/compass/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/sassy-math-1.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/modular-scale-1.0.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/zurb-foundation-3.1.1/scss\nCompass::SpriteImporter\n(in /home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss)\n\nTasks: TOP =&gt; assets:precompile:primary\n(See full trace by running task with --trace)\nrake aborted!\nCommand failed with status (1): [/home/marc/.rvm/rubies/ruby-1.9.3-p286/bin...]\n\nTasks: TOP =&gt; assets:precompile\n(See full trace by running task with --trace)\n\nFile to import not found or unreadable: ZURB-foundation.\nLoad paths:\nSass::Rails::Importer(/home/marc/rails_apps/wcaudit/app/assets/stylesheets    /foundation.css.scss)\n/home/marc/rails_apps/wcaudit/app/assets/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/blueprint    /stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/compass-0.12.2/frameworks/compass/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/sassy-math-1.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/modular-scale-1.0.2/stylesheets\n/home/marc/.rvm/gems/ruby-1.9.3-p286@wcaudit/gems/zurb-foundation-3.1.1/scss\nCompass::SpriteImporter\n(in /home/marc/rails_apps/wcaudit/app/assets/stylesheets/foundation.css.scss)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","gem","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13111336,"title":"Bundler groups in my Gemfile not being honered","body":"<p>I have</p>\n\n<pre><code>group :production, :staging do\n  gem \"therubyracer\"\nend\n</code></pre>\n\n<p>in my <code>Gemfile</code>. If I run:</p>\n\n<pre><code>bundle install --without production staging test\n</code></pre>\n\n<p>therubyracer is added to my <code>Gemfile.lock</code>. Why is this happening please? I would expect it to be ignored?</p>\n\n<p>For completeness, if I remove the line:</p>\n\n<pre><code>  gem \"therubyracer\"\n</code></pre>\n\n<p>and run the above bundle command, then the therubyracer gem is removed from my <code>Gemfile.lock</code></p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":174,"score":3,"question_id":8690418,"title":"Rails Carrierwave if (:medium).present?","body":"<p>I am currently in the process of trying to move users from version 1 to version 2 of my app. Version 2 is a complete rewrite.</p>\n\n<p>I would like to show the <code>:medium</code> version ONLY if it exists. If it doesn't exist then I would like to show <code>:small</code>.</p>\n\n<p>How would I go about doing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":35,"score":0,"question_id":13108379,"title":"How do I assign one worker to a queu?","body":"<p>In Resque, if I have the following:</p>\n\n<pre><code>bundle exec rake resque:work QUEUE=critical,high,normal,low,aggregate\n</code></pre>\n\n<p>How do I indicate that I only want one, and ONLY ONE worker, for a specific queue (i.e. the aggregate queue)?</p>\n"},{"tags":["ruby","ruby-on-rails-3","devise","google-authenticator"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":382,"score":1,"question_id":6497752,"title":"Rails 3 devise + google authenticator?","body":"<p>I'm trying to integrate the Google Authenticator OATH (<em>not OAuth</em>) one-time password authentication with devise, but can't find any pointers on whether it's already done or how to proceed. (Plenty of tips on how to make it work with OAuth. Which is something completely different.)</p>\n\n<p>Anyone have any experience with this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13108794,"title":"Ruby on rails - How can check a radio button, created by simple form, is checked in controller?","body":"<p>I built an view to create question and answer. This is my Question and Answer model:</p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :topic\n  belongs_to :user\n  belongs_to :question_type\n  has_many :answers, dependent: :destroy\n  accepts_nested_attributes_for :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  attr_accessible :content\n\n  belongs_to :question\nend\n</code></pre>\n\n<p>My answer model also have a attribute called <code>correct</code> type boolean to set true if which answer is correct, default is false. I have built a form to create a True/False question:</p>\n\n<pre><code>&lt;%= simple_form_for @question do |q| %&gt;\n\n  &lt;%= q.input :content, input_html: { rows: 3, class: 'span6' } %&gt;\n  &lt;%= q.input :mark, input_html: { class: 'span1' } %&gt;\n  &lt;%= q.association :topic %&gt;\n  &lt;%= q.association :question_type %&gt;\n\n  &lt;%= q.simple_fields_for :answers do |a| %&gt;\n\n    &lt;%= a.input :correct, collection: [[true, 'True'], [false, 'False']],\n                                                            as: :radio_buttons,\n                                                            label: 'Answer',\n                                                            value_method: :first,\n                                                            label_method: :last,\n                                                            item_wrapper_class: 'inline'\n                                                            %&gt;\n\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The correct attribute when rendered in view have these html:</p>\n\n<pre><code>&lt;label class=\"radio inline\"&gt;&lt;input class=\"radio_buttons optional\" id=\"question_answers_attributes_0_correct_true\" name=\"question[answers_attributes][0][correct]\" type=\"radio\" value=\"true\"&gt;True&lt;/label&gt;\n\n&lt;label class=\"radio inline\"&gt;&lt;input checked=\"checked\" class=\"radio_buttons optional\" id=\"question_answers_attributes_0_correct_false\" name=\"question[answers_attributes][0][correct]\" type=\"radio\" value=\"false\"&gt;False&lt;/label&gt;\n</code></pre>\n\n<p>Now in controller i want to check which radio button is checked and its value. Is there any method to check if <code>correct</code> attribute is checked and its value in controller?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13104869,"title":"how to embed a user created ruby program in rails3","body":"<p>Hi I am a quite a newbie in Rails and few days exp in ruby. I created a stopwatch program using threads.  But now I want to put it inside my Rails app and the view should have buttons to start,stop,resume of the stopwatch coz I am tracking an event. Can someone show <strong>how to embed a ruby program into rails and use it from view?</strong> </p>\n\n<p>The below  program should be invoked from start/stop/resume buttons in view</p>\n\n<p><strong>stopwatch.rb:</strong> (It just has start method and pause method as of now)</p>\n\n<pre><code>class Stopwatch\n\ndef initialize\n    @t_start\n    @t_elapsed \n    @t_total\n    @t_current\nend\n\n\ndef start\n    @t_start = Time.now\n    t = Thread.new do \n          while true do\n            @t_current = Time.now\n            puts @t_current\n            @t_elapsed = @t_current - @t_start\n            puts \"Time elapsed is : #{@t_elapsed.to_i} seconds\"\n            sleep 1\n          end\n\n     end\n\nend\n\ndef pause\n    # Stop the Thread =&gt; Sleep the Thread until Resume is pressed.\n    t.kill\n    # Calculate the elapsed time\n        @t_elapsed = @t_current - @t_start   \n\n    end\n\nend\n\nticker = Stopwatch.new\n\nticker.start\n</code></pre>\n\n<p>Thanks,</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13109099,"title":"rails ActiveRecord includes method with where : where not applied in subsequent calls to get associations","body":"<p>Say I have 2 tables <em>as</em> and <em>bs</em> in a many-to-many relationship with a join table. The join table has an attribute <em>cond</em>.</p>\n\n<p>The records are as follows:</p>\n\n<p>as:</p>\n\n<pre><code>id\n1\n</code></pre>\n\n<p>abs:</p>\n\n<pre><code>id  a_id  b_id  cond\n1   1     1     1\n2   1     1     0\n</code></pre>\n\n<p>bs:</p>\n\n<pre><code>id\n1\n</code></pre>\n\n<p>Now I do:</p>\n\n<blockquote>\n  <p>b = A.find(1).bs.where(:abs => {:cond => 1}).includes(:abs).first</p>\n</blockquote>\n\n<p>Which gives me my <em>b</em> instance, the question is, why does <em>b.abs</em> return <strong>all</strong> <em>abs</em> rows?</p>\n\n<p>I thought the <em>includes</em> method was meant to avoid reloading associations in subsequent calls to the associations methods. Since I used a <em>where</em> in the first call I would expect <em>b.abs</em> to return only the row with <em>cond == 1</em>.</p>\n\n<p>I tried this in the rails console and no SQL request is issued when I perform the <em>b.abs</em> call. What is happening here? Is there a way to do what I want or do I need to put the condition again on <em>b.abs</em> like *b.abs.where(:abs => {:cond => 1}) ?</p>\n\n<p>As requested in the comments, here is the code for the models:</p>\n\n<p>cat app/models/a.rb</p>\n\n<pre><code>class A &lt; ActiveRecord::Base\n    has_many :bs, :through =&gt; :abs\n    has_many :abs   \nend\n</code></pre>\n\n<p>cat app/models/b.rb</p>\n\n<pre><code>class B &lt; ActiveRecord::Base\n    has_many :as, :through =&gt; :abs\n    has_many :abs \nend\n</code></pre>\n\n<p>cat app/models/ab.rb                                                                              </p>\n\n<pre><code>class Ab &lt; ActiveRecord::Base\n    attr_accessible :cond, :a_id, :b_id\n    belongs_to :a\n    belongs_to :b\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","json","parsing","url"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13102171,"title":"Parse embedded string form JSON","body":"<p>I have a Rails 3 application and I am using the following code to parse a JSON post:</p>\n\n<pre><code>email_payload = JSON.parse(params[:payload])\nResult.create(:from =&gt; email_payload['from'], :from_name =&gt; email_payload['from_name'], :from_address =&gt; email_payload['from_address'], :date =&gt; email_payload['date'], :html_body =&gt; email_payload['html_body'], :priority =&gt; email_payload['priority'], :spam_status =&gt; email_payload['spam_status'], :subject =&gt; email_payload['subject'])\n</code></pre>\n\n<p>The JSON post data is as follows:</p>\n\n<pre><code>payload{ \"address_identifier\": null, \"attachments\": [ [ \"twitter.png\", \"image/png\", 3029, \"http://api.deliverhq.com/api/incoming/attachment/7gdd71wo75/5772412/0\" ] ], \"cc\": null, \"date\": \"Thu, 25 Oct 2012 22:04:20 +0100\"\n</code></pre>\n\n<p>I am trying to work out how to parse the URL, in this case <code>http://api.deliverhq.com/api/incoming/attachment/7gdd71wo75/5772412/0</code>, and then enter the URL into the database.</p>\n\n<pre><code>:url =&gt; email_payload['attachments']\n</code></pre>\n\n<p>won't work because there is multiple values within attachment and:</p>\n\n<pre><code>email_attachments_payload = JSON.parse(params[:payload][:attachments])\n:url =&gt; email_attachments_payload['URL']\n</code></pre>\n\n<p>won't work because the URL doesn't have an identifier. For this particular application there should only ever be one attachment, therefore selecting .first may be an option if that's possible.</p>\n\n<p>Any pointers would be appreciated!</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Adding:</p>\n\n<pre><code>email_payload[:attachments][0][4]\n</code></pre>\n\n<p>results in the following exception error:</p>\n\n<pre><code>NoMethodError: undefined method []' for nil:NilClass\n</code></pre>\n\n<p><strong>UPDATE 2</strong></p>\n\n<pre><code>def receive_fax\n    if request.get?\n        render :text =&gt; \"hello\"\n    elsif request.post?   \n      email_payload = JSON.parse(params[:payload])     \n      Fax.create(:from =&gt; email_payload['from'], :from_name =&gt; email_payload['from_name'], :from_address =&gt; email_payload['from_address'], :date =&gt; email_payload['date'], :html_body =&gt; email_payload['html_body'], :priority =&gt; email_payload['priority'], :spam_status =&gt; email_payload['spam_status'], :subject =&gt; email_payload['subject'], :fax =&gt; email_payload[:attachments][0][3])\n      render :text =&gt; \"success\"\n    else\n      render :text =&gt; \"error\"\n    end\n  end\n</code></pre>\n"}]}
{"total":34674,"page":10,"pagesize":100,"questions":[{"tags":["ruby-on-rails-3","ssl","google-analytics","cname"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13096487,"title":"When I am using google analytics to track a rails app deployed to heroku, which url do I use?","body":"<p>There is the initial heroku app name like something.herokuapp.com, then there is the ssl certified heroku app name like somethingelse.herokussl.com, and finally there is the actual website name www.anothername.com that is cname'd to the heroku ssl address. Which url should I ask google analytics to generate the tracking analytics code for?</p>\n"},{"tags":["regex","database","ruby-on-rails-3","json"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13108884,"title":"Strip numbers from JSON response in Rails 3?","body":"<p>I am receiving a JSON post into my Rails 3 application. I am then parsing each of the values and inserting them into the application database. It's all working well but now I would like to modify the received values before inserting them into the database.</p>\n\n<pre><code>:subject =&gt; email_payload['subject']\n</code></pre>\n\n<p>As the above code shows, I am inserting the received value for 'subject' into the column named 'subject'.</p>\n\n<p>In the example above the received value is like this:</p>\n\n<pre><code>Results from Example Company - Surname/Firstname/[12345]\n</code></pre>\n\n<p>What I would like to do is strip everything out except the numerical value between the []. So the value that's inserted into the database is simply:</p>\n\n<pre><code>12345\n</code></pre>\n\n<p>I can, presumably, just select anything from 0-9 but how do I add regex to the received string?</p>\n\n<p>None of the following seem to work:</p>\n\n<pre><code>['subject.gsub!([0-9])']\n['subject'.gsub!([0-9])]\n['subject'].gsub!([0-9])\n</code></pre>\n\n<p>I've tested the Regex here <a href=\"http://rubular.com/r/AVFkm3A440\" rel=\"nofollow\">http://rubular.com/r/AVFkm3A440</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13105841,"title":"Rails 2 tables, 1 model","body":"<p>I am relatively new to ruby/rails and I have the following question:</p>\n\n<p>I am working on a scheduling app and have a model named Classes and another named ClassEntries. The relationship between them is that each user can have multiple class entries per semester, each relating to one class. Each record in the Classes table belongs to a specific University. A User can have multiple entries in the ClassEntries table for 1 semester (typically 5). Their schedule is comprised of all their ClassEntries with the same semester ID.</p>\n\n<p>I am not sure whether I should have a third model called Schedule that brings together the info in the ClassEntries and Classes models for the user at hand. I originally wrote this functionality in PHP and I simply used a MySQL JOIN to gather the necessary information. In Rails it seems that there should be a better way to accomplish this.</p>\n\n<p>What would be the best way of going about this in Rails?</p>\n\n<p>Many thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":7,"score":0,"question_id":13089936,"title":"Tracking/Logging ActiveRecord Callbacks","body":"<p>Is there any way to automatically log everytime an ActiveRecord callback happens? It would help to trace through why certain things are happened when a record has several callbacks in place.</p>\n\n<p>I'd like to see automated log message that indicate which messages are being called in response to which callbacks, e.g.: <code>before_validation: calling update_capitalization</code></p>\n"},{"tags":["ruby-on-rails-3","internationalization","routes","translation"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":159,"score":4,"question_id":8870042,"title":"What is the best way to translate slugs in Rails routes","body":"<p>I'm trying to achieve full internationalization of my routes in a Rails3.1 app. I'm already using Francesc Pla's <a href=\"https://github.com/francesc/rails-translate-routes\" rel=\"nofollow\">rails-translate-routes</a> to localize route actions and resources. The last step is to be able to translate slugs for some of my models. </p>\n\n<p>Route to be translated: </p>\n\n<pre><code>http://myhost.com/products/pharmacy --&gt; http://myhost.com/productos/farmacia\n</code></pre>\n\n<p>I have a nested route of the form</p>\n\n<pre><code># routes.rb\nmatch 'products/:category_slug' =&gt; \"products#index\"\n</code></pre>\n\n<p>I have a model Category with an instance <code>#&lt;Category id: 1, slug: \"pharmacy\"&gt;</code> and I do <code>find_by_slug</code> category in my ProductsController.</p>\n\n<p>Any ideas on how to do translate the <code>:category_slug</code> part of the route?</p>\n"},{"tags":["ruby-on-rails-3","validation","mongoid","aggregation","activemodel"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":134,"score":5,"question_id":13041971,"title":"Rails/ActiveModel passing arguments to EachValidator","body":"<p>I have a very generic validator and I want to pass it arguments.  </p>\n\n<p>Here is an example model:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n\n  field :order_type\n  has_many :orders, inverse_of :user\n  validates: orders, generic: true #i want to pass argument (order_type)\n\n  field :task_type\n  has_many :tasks, inverse_of :user\n  validates: tasks, generic: true #i want to pass argument (task_type)\nend\n</code></pre>\n\n<p>and Example validator:</p>\n\n<pre><code>class GenericValidator &lt; ActiveModel::EachValidator\n  def validate_each(object, attribute, value)\n    if some_validation?(object)\n      object.errors[attribute] &lt;&lt; (options[:message] || \"is not formatted properly\") \n    end\n  end\nend\n</code></pre>\n\n<p>Is there any way to pass arguments to the validator dependant on which field it is validating?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","rspec","actionmailer"],"answer_count":4,"favorite_count":5,"up_vote_count":9,"down_vote_count":0,"view_count":1222,"score":9,"question_id":6487618,"title":"Testing ActionMailer multipart emails with RSpec","body":"<p>I'm currently testing my mailers with RSpec, but I've started setting up multipart emails as described in the Rails Guides here:  <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html#sending-multipart-emails\">http://guides.rubyonrails.org/action_mailer_basics.html#sending-multipart-emails</a></p>\n\n<p>I have both mailer templates in text and html formats, but it looks like my tests are only checking the HTML portion.  Is there a way to check the text template separately?</p>\n\n<p>Is it only checking the HTML view because it's first in the default order?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","jquery-ui","ruby-on-rails-3.1","asset-pipeline"],"answer_count":2,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":110,"score":6,"question_id":12963106,"title":"Copy of environments/development asset path cannot find jquery-ui-rails in gems directories","body":"<p>I copied config/environments/development.rb to config/environments/ci.rb.</p>\n\n<p>When I run with RAILS_ENV=development, the asset search path includes my gem vendor directories, in particular for jquery-ui-rails.  However, when I run with RAILS_ENV=ci it does not.</p>\n\n<p>From the console, Rails.application.config.assets.paths evaluates to the following with development</p>\n\n<pre><code>irb(main):002:0&gt; Rails.application.config.assets.paths\n=&gt; [\"/var/www/ci/conflux/app/assets/images\",\n  \"/var/www/ci/conflux/app/assets/javascripts\",\n  \"/var/www/ci/conflux/app/assets/stylesheets\",\n  \"/var/www/ci/conflux/vendor/assets/stylesheets\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-rails-1.0.19/vendor/assets/javascripts\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-ui-rails-1.0.0/vendor/assets/images\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-ui-rails-1.0.0/vendor/assets/javascripts\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-ui-rails-1.0.0/vendor/assets/stylesheets\"]\n</code></pre>\n\n<p>but for ci I only get the following:</p>\n\n<pre><code>irb(main):002:0&gt; Rails.application.config.assets.paths\n=&gt; [\"/var/www/ci/conflux/app/assets/images\",\n  \"/var/www/ci/conflux/app/assets/javascripts\",\n  \"/var/www/ci/conflux/app/assets/stylesheets\",\n  \"/var/www/ci/conflux/vendor/assets/stylesheets\",\n  \"/opt/comcast/ruby1.9.3/lib/ruby/gems/1.9.1/gems/jquery-rails-1.0.19/vendor/assets/javascripts\"]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate","kaminari"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13105304,"title":"Use Pagination in Ruby when fetching data with a SQL query (mysql2 type)","body":"<p>I have a query in my controller which looks like this:</p>\n\n<pre><code>@temp = connection.execute(\"select test_id from mastertest limit 500;\")\n</code></pre>\n\n<p>Now I display the results fetched here in a table in my view. But I want to limit the results to say 10 rows per page. I know I can use will_paginate and kaminari</p>\n\n<p><a href=\"https://github.com/amatsuda/kaminari\" rel=\"nofollow\">https://github.com/amatsuda/kaminari</a></p>\n\n<p><a href=\"https://github.com/mislav/will_paginate\" rel=\"nofollow\">https://github.com/mislav/will_paginate</a></p>\n\n<p>But can anyone give me the exact syntax or a sample code to apply pagination in my case of an SQL query and how I can display results in the view.</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13102322,"title":"How to get rest of the records after a certain limit with activerecord","body":"<p>I got first 2 record out of 10 using following </p>\n\n<pre><code>News.all.order(\"published_at desc\").limit(2)\n</code></pre>\n\n<p>How do i get rest of the 8 record? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","install","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13107081,"title":"rails 'bundle install' - Do it manually?","body":"<p><strong>Problem:</strong>\nDue to proxy settings i am not able to execute 'bundle install' from comandline. I get the following error. I dont know the proxy settings and i want to continue with rails development.</p>\n\n<pre><code>Fetching source index for http://rubygems.org/\nCould not reach rubygems repository http://rubygems.org/\nCould not find gem 'capybara (&gt;= 0)' in any of the gem sources listed in your Ge\nmfile.\n</code></pre>\n\n<p><strong>Question:</strong>\nHow can we do 'bundle install' manually (downloading gems via browser and install in commandline)? I need to install only handlful of gems.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13095126,"title":"One select_tag and multiple button_to submit buttons","body":"<p>I have one select_tag and multiple button_to buttons on the same page. I'm looking to use the parameters from the select_tag for several of the buttons, is there a non-form way to do this? </p>\n\n<p>The reason I don't want to use a form is two fold:\n1. the number of buttons is dynamic\n2. the positioning of the buttons do not follow the form structure (object at the top and submit at the bottom)</p>\n\n<p>-here is one of the create methods that are linked to one of the buttons</p>\n\n<pre><code>def create\n  params[:options].each do |x|\n    @connector = Connector.find_or_create_by_options_id_and_follow_id(x.id, current_user.follow(@product).id)\n    @connector.save\n  end\nend\n</code></pre>\n\n<p>I checked and this params[:options] is always nil no matter what is selected by me when I test</p>\n\n<pre><code>&lt;%= select_tag :options, options_for_select(@current_user_options.map {|p| [p.name, p.id] }), {:multiple =&gt; true} %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","callback","mongoid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":14,"score":0,"question_id":13106879,"title":"How to build/create mongoid multi-level embedded document upon creation of the root while respecting all natural callbacks?","body":"<p>Let's say I have a structure of models like this:</p>\n\n<pre><code>class User\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embeds_one :personal_data\n  embeds_one :professional_data\n\n  ...\nend\n\nclass PersonalData\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  embeds_one :family_data\n\n  field :stuff, :type =&gt; String\n\n  ...\nend\n\nclass ProfessionalData\n  include Mongoid::Document\n  include Mongoid::Timestamps\n\n  field :stuff, :type =&gt; String\n\n  ...\nend\n</code></pre>\n\n<p>So simply put a user would have a tree of data that would look like this:</p>\n\n<pre><code>User -&gt; PersonalData -&gt; FamilyData\n     -&gt; ProfessionalData\n</code></pre>\n\n<p>As you may have noticed, each of my models uses Mongoid:Timestamps as I want to know when each sub part of the user gets modified.</p>\n\n<p>Now where it gets tricky, is that I want upon creating a new User, that it automatically gets all its embedded model created with it while using the proper callbacks to set the Timestamps.</p>\n\n<p>Ideally I would like to avoid doing multiple writes to the DB, but I haven't found an elegant way of doing this so far.</p>\n\n<p>For the moment I have this in my User model:</p>\n\n<pre><code>after_create :create_personal_data\nafter_create :create_professional_data \n</code></pre>\n\n<p>And in PersonalData model:</p>\n\n<pre><code>after_create :create_family_data\n</code></pre>\n\n<p>However the results are not what I am expecting, it works great for the ProfessionalData model, where it gets created and the TimeStamps callback works, :created_at and :updated_at are set properly.\nHowever for the PersonalData model, it does not work properly:\n- the embedded model gets created\n- but the callback are not called properly, and TimeStamps are not set\n- the embedded FamilyData does not get created un PersonalData</p>\n\n<p>I am using Mongoid 2.4.12 with Rails 3.2</p>\n\n<p>Thx.</p>\n\n<p>Alex</p>\n"},{"tags":["ruby-on-rails-3","resque"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13106631,"title":"Setting up Resque in Rails","body":"<p>When setting up Resque for the first time in Rails, I'm getting an error.  I'm using Foreman and a Procfile to start my app locally, before eventual deployment to Heroku.  Redis and my PostgreSQL database are already running when I try to start my app.  The error is:</p>\n\n<pre><code>$ foreman start\n...\n23:24:32 resque.1 | rake aborted!\n23:24:32 resque.1 | No such file to load -- bootstrap_flash_helper\n23:24:32 resque.1 | Tasks: TOP =&gt; resque:work =&gt; resque:preload\n23:24:32 resque.1 | (See full trace by running task with --trace)\n23:24:32 resque.1 | exited with code 1\n...\n</code></pre>\n\n<p>My app does use Bootstrap, but I'm not explicitly requiring it in any classes using Rescue.  My Rakefile and Procfile are:</p>\n\n<p><strong>Procfile</strong></p>\n\n<pre><code>web: bundle exec rails server -p $PORT\nresque: env TERM_CHILD=1 RESQUE_TERM_TIMEOUT=10 bundle exec rake resque:work\n</code></pre>\n\n<p><strong>Rakefile</strong></p>\n\n<pre><code>require File.expand_path('../config/application', __FILE__)\nrequire 'resque/tasks'\n\ntask \"resque:setup\" do\n  ENV['QUEUE'] = '*'\nend\n\ntask \"jobs:work\" =&gt; \"resque:work\"\n\nMyCoolApp::Application.load_tasks\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization","gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13106082,"title":"How can I internationalize my rails app (not translate)?","body":"<p>First off, yes I've read all the <a href=\"http://guides.rubyonrails.org/i18n.html\" rel=\"nofollow\">rails documentation about I18n</a> but it doesn't help me with what I want to do.</p>\n\n<p>The app I'm developing will be international (in multiple languages) with user-generated content. I don't want to translate the user-generated content to different languages but I need to assign a \"locale\" to every piece of content.</p>\n\n<p>Though, the static pages (about us, how it works, contact us, etc.) will be translated.</p>\n\n<p>I've looked at <a href=\"https://github.com/galetahub/globalize3#readme\" rel=\"nofollow\">globalize3</a> but from what I understand it only solves my problem for static pages.</p>\n\n<p>I guess I could simply add a column \"locale\" to all my user-generated content models but then I would need to chain a \"where locale = current_locale\" to every query. This will end up being heavy in the end.</p>\n\n<p>Does anyone have other ideas? Maybe a filter for certain model queries could be devised, but I am still a new Rails developer and don't know if that is possible.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":4380,"score":2,"question_id":5015685,"title":"Ruby on rails :- Could not find RubyGem rails (>= 0) (Gem::LoadError)","body":"<p>I am very new to Ruby on Rails. I installed ruby on rails on my Windows 7 using the installer in <a href=\"http://railsinstaller.org/\" rel=\"nofollow\">http://railsinstaller.org/</a>. I could create a project once and thereafter I was not (I dont know what did I do in between :-( ). </p>\n\n<p>The complete errors messages are :-</p>\n\n<p><strong>On creating a new project</strong> :-</p>\n\n<pre><code>c:\\Sites&gt;rails new Tickets_Test\nE:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:762:in `report_activate_error': Cou\nld not find RubyGem rails (&gt;= 0) (Gem::LoadError)\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:219:in `activate'\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:1065:in `gem'\n        from E:/Ashish/RailsInstaller/Ruby1.8.7/bin/rails:18:in `&lt;main&gt;'\n</code></pre>\n\n<p><strong>on just getting the version</strong>:- </p>\n\n<pre><code>c:\\Sites&gt;rails --version\nE:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:762:in `report_activate_error': Cou\nld not find RubyGem rails (&gt;= 0) (Gem::LoadError)\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:219:in `activate'\n        from E:/Ashish/Ruby192/lib/ruby/1.9.1/rubygems.rb:1065:in `gem'\n        from E:/Ashish/RailsInstaller/Ruby1.8.7/bin/rails:18:in `&lt;main&gt;'\n</code></pre>\n\n<p>Any idea why the above is happening?</p>\n\n<p><strong>EDIT</strong> </p>\n\n<p>Appearently there are two command prompts :-\n Ruby command prompt :-\n<img src=\"http://i.stack.imgur.com/R0qx3.png\" alt=\"Ruby\">\nand\n Ruby for rails command prompt (The problem is resolved using this command prompt):-\n<img src=\"http://i.stack.imgur.com/A4IPh.png\" alt=\"Ruby on rails\"></p>\n\n<p>I was using ruby command prompt. Sounds like a stupid question, however, I am not sure how there are \"two\" command prompts?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","amazon-s3","asset-pipeline","sprockets"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13105757,"title":"Non-digest .js linking to cache-digested assets","body":"<p>I'm currently using asset_sync to move my assets to S3 from Rails. </p>\n\n<p>We serve our JS library as a <code>bootstrap.js</code> which bootstraps other stylesheets/js that should be cache-controlled via the digest. Since I want to be able to change functionality to our library quickly, <code>bootstrap.js</code> is short-lived and must be therefore very small, whereas the cache-digested css/js should be living forever accordingly to Rails asset pipeline principles.</p>\n\n<p>The Problem now is that when I do the precompilation, the digested <code>bootstrap.js</code> correctly loads the cache-digested other css/js, but the non-digest <code>bootstrap.js</code> only points to the non-digest equivalents, despite me explicitly setting <code>:digest</code> to true</p>\n\n<pre><code>&lt;%= asset_path 'badgelib.js', :digest =&gt; true %&gt;\n</code></pre>\n\n<p>Is there any other way to force the asset to link to the digest-version?</p>\n"},{"tags":["database","ruby-on-rails-3","activerecord","automation","rails-migrations"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":16,"score":1,"question_id":13104649,"title":"Given an array of (sanitized) attribute headers (metatags), how might I automatically create columns for each in my database based on those tags?","body":"<p>So here is the unformatted list (this one, an income statement, has over row headers like these, so yes, automation is the way to go here).</p>\n\n<p>[\"Revenue\", \"Other Revenue, Total\", \"Total Revenue\", \"Cost of Revenue, Total\"...]</p>\n\n<p>Here is the list after I ran each array entity (string) through my simple little sanitizer program, <code>CleanZeeString.new.go(str)</code>.</p>\n\n<p>[\"revenue\", \"other_revenue_total\", \"total_revenue\", \"cost_of_revenue_total\"...]</p>\n\n<p>So, I want to access Rails methods that will allow me to at least partially automate the database column creation process and migration, because this list has over 50 row headers, there are more lists, and I simply do not believe in doing things by hand anymore.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13104980,"title":"using url in a string in ruby","body":"<p>I want to convert urls in a string to workable urls. For example:\n    str = \"Hello, this is the link for yahoo: <a href=\"http://www.yahoo.com\" rel=\"nofollow\">http://www.yahoo.com</a>\"</p>\n\n<pre><code>//in the view i have\n&lt;%= parse_description(r[:description]) %&gt;\n\n//in helper, i am splitting each word in the string and verifying if i have a string which\n//  contains http, if http is present then i am using link_to to make it a valid url:\ndef parse_description(str)\n  s = \"\"\n    str.split.each do |w|\n       a =  w.include?(\"http\") ? (link_to nil,\"#{w}\") : w\n       s += \"#{a} \"\n    end \nend\n</code></pre>\n\n<p>once the string is returned back to the view, the link is not clickable. what wrong i am doing?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","backbone.js","javascript-framework"],"answer_count":3,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":673,"score":4,"question_id":7379525,"title":"Backbone model without collection. Sending duplicate data to server?","body":"<p>I have a Backbone app powered by a rails backend. I have an <code>Invitation</code> resource and I can send invitations by sending a POST request to the create action of the invitation's controller.</p>\n\n<p>My Backbone model looks like this (coffeescript):</p>\n\n<pre><code>class Invitation extends Backbone.Model\n  urlRoot: '/invitations'\n</code></pre>\n\n<p>And the template for the form to send an invitation follows. I tried to make it as close to the normal rails forms as possible as it seems like Rails would deal with that best:</p>\n\n<pre><code>&lt;form action=\"/invitations\" accept-charset=\"UTF-8\" id=\"new_invitation\" class=\"new_invitation\" method=\"post\"&gt;\n  &lt;input id=\"invitation_recipient_name\" class=\"invitation_recipient_name\" type=\"text\" name=\"invitation[recipient_name]\" /&gt;\n  &lt;input id=\"invitation_recipient_email\" class=\"invitation_recipient_email\" type=\"text\" name=\"invitation[recipient_email]\" /&gt;\n  &lt;input type=\"submit\" class=\"btn primary\" name=\"commit\" id=\"invite\" value=\"Send Invitation\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here is my Backbone View for that model and template</p>\n\n<pre><code>class InvitationView extends Backbone.View\n  # this is the template shown above\n  template: JST['backbone/templates/invitation']\n  events:\n    'click #invite': 'sendInvite'\n\n  render: -&gt;\n    $(this.el).html this.template()\n    this\n  sendInvite: (e) -&gt;\n    e.preventDefault()\n    name = this.$('#invitation_recipient_name')\n    email = this.$('#invitation_recipient_email')\n    this.model.save\n      recipient_name: name.val()\n      recipient_email: email.val()\n</code></pre>\n\n<p>The problem is that when I click the submit button and the <code>sendInvite</code> method is called, my server receives data with the following structure:</p>\n\n<pre><code>Parameters: {\"recipient_name\"=&gt;\"A name\", \"recipient_email\"=&gt;\"name@example.com\", \"invitation\"=&gt;{\"recipient_email\"=&gt;\"name@example.com\", \"recipient_name\"=&gt;\"A name\"}}\n</code></pre>\n\n<p>Now this actually works, since my <code>invitations#create</code> action expects to work with parameters of the form: <code>params[:invitations]</code>, this is the standard for rails. However the fact that the name and email are being sent twice in the request seems a sign that something is wrong with my setup.</p>\n\n<p>Am I doing something wrong or is this correct?</p>\n\n<p>Here is my controller action if anyone wants to see it:</p>\n\n<pre><code>  # POST /invitations\n  def create\n    @invitation = current_user.sent_invitations.new params[:invitation]\n\n    respond_to do |format|\n      if @invitation.save\n        format.json { render_for_api :invitation, json: @invitation, status: :created }\n      else\n        format.json { render json: @invitation.errors, status: :unproccessible_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p><strong>Edit</strong> This is what my Invitation model looks like if I set the attributes and log it just before saving:</p>\n\n<pre><code>  Invitation\n    _changed: false\n    _changing: false\n    _escapedAttributes: Object\n      __proto__: Object\n    _previousAttributes: Object\n      recipient_email: \"dave@example.com\"\n      recipient_name: \"Dave\"\n      __proto__: Object\n    attributes: Object\n      recipient_email: \"dave@example.com\"\n      recipient_name: \"Dave\"\n      __proto__: Object\n    cid: \"c17\"\n    __proto__: ctor\n</code></pre>\n\n<p>THat log is produced by the following code btw:</p>\n\n<pre><code>sendInvite: (e) -&gt;\n    e.preventDefault()\n    name = @$('#invitation_recipient_name')\n    email = @$('#invitation_recipient_email')\n    @model.set recipient_name: name.val(), recipient_email: email.val()\n    console.log \"THe model to save\", @model\n</code></pre>\n\n<p><strong>Edit 2</strong><br>\nThis is how I'm instantiating my view in my router. How should I change this so that Backbone automatically keeps track of my models attributes, even though I'm not fetching and setting them from the server?.</p>\n\n<pre><code>  var TeamRouter = Backbone.Router.extend({\n    routes: {\n      'members': 'members'\n    },\n\n    members: function() {\n      @invite = new MoveOutOrg.Models.Invitation();\n      @inviteView = new MoveOutOrg.Views.InvitationView({\n        model: @invite\n      });\n      $('#stage').append(@inviteView.render().el);\n    }\n  });\n</code></pre>\n"},{"tags":["ruby-on-rails-3","jquery-mobile"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13104678,"title":"JQueryMobile list-item goes black upon mouseover","body":"<p>On my own site, when hovering over a list-item, it highlights black, instead of the darker gradiented background which appears when hovering on the <a href=\"http://jquerymobile.com/test/docs/lists/lists-ul.html\" rel=\"nofollow\">JQueryMobile Docs website</a>.</p>\n\n<p><img src=\"http://i.stack.imgur.com/8Uktg.jpg\" alt=\"Black list-item\"></p>\n\n<p>I found my code <a href=\"http://jquerymobile.com/test/docs/lists/docs-lists.html\" rel=\"nofollow\">here</a> under the \"basic linked lists\" right at the top. I have tried giving it other themes etc. but nothing seems to solve this simple issue.</p>\n\n<p>Here is my piece of code:</p>\n\n<pre><code>&lt;ul data-role=\"listview\" data-theme=\"b\"&gt;\n    &lt;li&gt;&lt;a href=\"acura.html\"&gt;Acura&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"audi.html\"&gt;Audi&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"bmw.html\"&gt;BMW&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>The only thing I can think of is the container in which the list is held, or something, but it's not that...</p>\n\n<p>Here's my setup:\nRunning Rails 3.2.6 with the latest JQuery and latest JQueryMobile.</p>\n\n<p>What could possibly cause this, and how can I solve it?</p>\n"},{"tags":["ruby-on-rails-3","for-loop","fields"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13104252,"title":"RoR: Add a blank field to a simple_fields_for loop","body":"<p>I am sure this is a silly question, but I have been searching for some time now without finding an answer.</p>\n\n<p>I have a nested form using simple_forms.  I get all the child objects successfully with</p>\n\n<pre><code> = f.simple_fields_for :fund_levels do |fl|\n     = fl.input :title\n     = fl.input :description\n     = fl.input :maxnumber\n     = fl.input :price\n</code></pre>\n\n<p>This gets all existing fund_levels.  However, I also want to add a blank set at the end of the list.  So that if there are no existing fund_levels, it simply shows a blank \"subform\", if there are two existing fund_levels, it will show those two plus a blank \"subform\".</p>\n\n<p>Is there an easy way of doing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13104299,"title":"Rails model multiple properties of the same model","body":"<p>I'm struggle to find a way to have more than one property of the same model. I've this structure :</p>\n\n<pre><code>class Image &lt; ActiveRecord::Base\n   attr_accessible :name, :content_type\nend\n\nclass MenuImage &lt; ActiveRecord::Base\n   belongs_to :image\n   belongs_to :menu\nend\n\nclass Menu &lt; ActiveRecord::Base\n   has_many :menu_images\n   has_many :images, :through =&gt; :menu_images\n\n   has_one :image, :as =&gt; :thumbnail_image\n\n   attr_accessible :thumbnail_image_id\nend\n</code></pre>\n\n<p>I want to be able to access the images using <code>@menu.images</code> and <code>@menu.thumbnail_image</code>.\nThe code <code>has_one :image, :as =&gt; :thumbnail_image</code> is an example of what i'm trying to obtain. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","facebook-graph-api","koala"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13103916,"title":"How to build a script that auto-post on my Facebook Pages with a non-permanent Access Token?","body":"<p>I'm developing a ruby script that push every new content on my Facebook Page as a post.\nI know about that the access token will expire in two hours, so how I could do that?</p>\n\n<p>Now this piece of code works because I set \"user_access_token\" manually (But after 2 hours it expire). It's my company facebook page linked to my facebook app.\nShould I click every two hours on \"Facebook connect\" and grant a new access token??</p>\n\n<pre><code>@user_graph = Koala::Facebook::API.new(user_access_token)\npages = @user_graph.get_connections('me', 'accounts')\n# get access token for first page\nfirst_page_token = pages.first['access_token']\n\n# or: retrieve access_token for a given page_id\npage_token = @user_graph.get_page_access_token(page_id)\n@page_graph = Koala::Facebook::API.new(page_token)\n\n@page_graph.put_wall_post('post on page wall') # post as page, requires publish_stream permission\n</code></pre>\n\n<p>I have got \"Page Access Token\" from here</p>\n\n<p><img src=\"http://i.stack.imgur.com/HElxt.png\" alt=\"I got PAGE ACCESS TOKEN FROM HERE\"></p>\n\n<p>but in one hour it will expire</p>\n\n<p><img src=\"http://i.stack.imgur.com/0htvq.png\" alt=\"enter image description here\"></p>\n\n<p><strong>[RESOLVED]</strong></p>\n\n<p>To get an extended Page Access Token, exchange the User Access Token for a long-lived one and then request the Page token. This \"extended\" token for Pages will actually not have any expiry time.</p>\n\n<p><a href=\"https://developers.facebook.com/docs/howtos/login/extending-tokens/#step1\" rel=\"nofollow\">https://developers.facebook.com/docs/howtos/login/extending-tokens/#step1</a></p>\n\n<p>I have resolved executing a curl request, and saving \"Page access token\" in my code manually</p>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3","facebook"],"answer_count":6,"favorite_count":30,"up_vote_count":25,"down_vote_count":0,"view_count":35916,"score":25,"question_id":6246449,"title":"Facebook how to check if user has liked page and show content?","body":"<p>I am trying to create a Facebook iFrame app. The app should first show an image and if the user likes the page, he will get access to some content.</p>\n\n<p>I use RoR, therefore I can't use the Facebook PhP SDK.</p>\n\n<p>Here is my iFrame HTML when the user has not liked the page:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"&gt;\n&lt;head&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" /&gt;\n&lt;style type=\"text/css\"&gt;\nbody {\nwidth:520px;\nmargin:0; padding:0; border:0;\nfont-family: verdana;\nbackground:url(repeat.png) repeat;\nmargin-bottom:10px;\n}\np, h1 {width:450px; margin-left:50px; color:#FFF;}\np {font-size:11px;}\n&lt;/style&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html;\ncharset=iso-8859-1\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"container\"&gt;\n&lt;img src=\"welcome.png\" alt=\"Frontimg\"&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And, if the user has liked the page:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\"&gt;\n&lt;head&gt;\n&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\" /&gt;\n&lt;style type=\"text/css\"&gt;\nbody {\nwidth:520px;\nmargin:0; padding:0; border:0;\nfont-family: verdana;\nbackground:url(repeat.png) repeat;\nmargin-bottom:10px;\n}\np, h1 {width:450px; margin-left:50px; color:#FFF;}\np {font-size:11px;}\n&lt;/style&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html;\ncharset=iso-8859-1\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"container\"&gt;\n&lt;img src=\"member.png\" alt=\"Frontimg\"&gt;\n&lt;p&gt;You liked this page&lt;/p&gt;\n</code></pre>\n\n<p></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","frontend"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13104010,"title":"Front-end editing in Rails","body":"<p>My app has a Ruby on Rails back-end (using git and heroku), and a front-end designer (css/jquery) just asked if he could work on the code without install rails (i.e. downloading the code from git, and just ftp'ing it to heroku).</p>\n\n<p>It does not seem like it is possible to FTP to heroku.  Is there some other way that front-end developers can interact with rails without having to install rails on their own?</p>\n\n<p>Thank you!</p>\n\n<p>Greg</p>\n"},{"tags":["ruby-on-rails-3","performance"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":215,"score":2,"question_id":12892937,"title":"Improve Rails loading time","body":"<p>This is a bit of a follow-up from <a href=\"http://stackoverflow.com/q/4736546/305019\">a previous question on improving rails console loading time</a>.</p>\n\n<p>The first great suggestion was to figure out <a href=\"http://stackoverflow.com/a/5071198/305019\">which gems take too long</a>.</p>\n\n<p>Next answer, suggested using <code>:require =&gt; nil</code> and <a href=\"http://stackoverflow.com/a/7146810/305019\">loading those gems later</a>.</p>\n\n<p>With some gems however, it's not entirely clear how to accomplish this without breaking things. Here's a list of our 'biggest offenders', I wonder if someone can suggest the best approach to loading them only when necessary?</p>\n\n<pre><code>require gon: 2.730000 (2.870059)\nrequire omniauth-openid: 1.410000 (1.503858)\nrequire cancan: 2.640000 (2.707467)\nrequire fog: 2.730000 (2.846530)\nrequire activeadmin: 3.650000 (3.923877)\n</code></pre>\n\n<p>and of course there are many more that take around 1 second or less, which also adds up... but at least removing the big ones will already improve things.</p>\n\n<h3>how can I selectively load gems later to make rails load faster?</h3>\n"},{"tags":["sql","ruby-on-rails-3","postgresql","count","sql-update"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":13103529,"title":"UPDATE based on count","body":"<p>I want to update the number_of_votes in the users table based on the poll_records table. In rails, it looks like</p>\n\n<pre><code>User.all.each do |user|\n  user.number_of_votes = user.poll_records.where(\"poll_record_type = 3\").size\n  user.save\nend\n</code></pre>\n\n<p>I am new to PostgreSQL. How can I update users this way?</p>\n"},{"tags":["query","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2656,"score":2,"question_id":5035365,"title":"How to specify multiple values in where with AR query interface in rails3","body":"<p>Per section 2.2 of rails guide on Active Record query interface <a href=\"http://guides.rubyonrails.org/active_record_querying.html#conditions\" rel=\"nofollow\">here</a>:</p>\n\n<p>which seems to indicate that I can pass a string specifying the condition(s), then an array of values that should be substituted at some point while the arel is being built. So I've got a statement that generates my conditions string, which can be a varying number of attributes chained together with either AND or OR between them, and I pass in an array as the second arg to the where method, and I get:</p>\n\n<blockquote>\n  <p>ActiveRecord::PreparedStatementInvalid: wrong number of bind variables (1 for 5)</p>\n</blockquote>\n\n<p>which leads me to believe I'm doing this incorrectly. However, I'm not finding anything on how to do it correctly. To restate the problem another way, I need to pass in a string to the where method such as \"table.attribute = ? AND table.attribute1 = ? OR table.attribute1 = ?\" with an unknown number of these conditions anded or ored together, and then pass something, what I thought would be an array as the second argument that would be used to substitute the values in the first argument conditions string. Is this the correct approach, or, I'm just missing some other huge concept somewhere and I'm coming at this all wrong? I'd think that somehow, this has to be possible, short of just generating a raw sql string.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13085536,"title":"Rails nested form error: undefined method `update_attributes' for nil:NilClass","body":"<p>I'm using Mongoid, awesome_nested_fields gem and rails 3.2.8.</p>\n\n<p>I have the functionality working on the client (adding multiple fields), but when I try to save I get a \"undefined method `update_attributes' for nil:NilClass\" error.</p>\n\n<p>Here is all the relevant info:</p>\n\n<p><strong>profile.rb</strong></p>\n\n<pre><code>class Profile\n    include Mongoid::Document\n    include Mongoid::Timestamps\n\n    has_many :skills, :autosave =&gt; true\n    accepts_nested_attributes_for :skills, allow_destroy: true  \n    attr_accessible :skills_attributes\n\nend\n</code></pre>\n\n<p><strong>skill.rb</strong></p>\n\n<pre><code>class Skill\n    include Mongoid::Document\n    belongs_to :profile \n    field :skill_tag, :type =&gt; String\nend\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>&lt;%= simple_form_for(@profile) do |f| %&gt;\n  &lt;%= f.error_notification %&gt;\n\n  &lt;div class=\"form-inputs\"&gt;\n\n            &lt;div class=\"items\"&gt;\n                &lt;%= f.nested_fields_for :skills do |f| %&gt;\n                &lt;fieldset class=\"item\"&gt;\n                    &lt;%= f.input :skill_tag, :label =&gt; 'Skills:' %&gt;\n                    &lt;a href=\"#\" class=\"remove\"&gt;Remove Skill&lt;/a&gt;\n\n                    &lt;%= f.hidden_field :id %&gt;\n                    &lt;%= f.hidden_field :_destroy %&gt;\n                &lt;/fieldset&gt;\n                &lt;% end %&gt;\n            &lt;/div&gt;\n            &lt;a href=\"#\" class=\"add\"&gt;Add Skill&lt;/a&gt;\n      &lt;/div&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit, :class =&gt; 'btn' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>profiles_controller.rb</strong></p>\n\n<pre><code>  # PUT /profiles/1\n  # PUT /profiles/1.json\n  def update\n    @profile = Profile.find(params[:id])\n\n    respond_to do |format|\n      if @profile.update_attributes(params[:profile])\n        format.html { redirect_to @profile, notice: 'Profile was successfully updated.' } # Notice\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @profile.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p><em><strong></em>**<em>*</em>**<em>*</em>**<em>*</em>**<em></strong> UPDATE <strong></em>**<em>*</em>**<em>*</em>**<em>*</em>***</strong></p>\n\n<p>I ended up switching to Ryan's nested_form gem and it works like a charm.</p>\n"},{"tags":["ruby","ruby-on-rails-3","actionmailer"],"answer_count":1,"favorite_count":2,"up_vote_count":9,"down_vote_count":0,"view_count":2331,"score":9,"question_id":6197190,"title":"How to setup a mail interceptor in rails 3.0.3?","body":"<p>I am using rails 3.0.3, ruby 1.9.2-p180, mail (2.2.13). I m trying to setup a mail interceptor but I am getting the following error</p>\n\n<pre><code> /home/abhimanyu/Aptana_Studio_3_Workspace/delivery_health_dashboard_03/config/initializers/mailer_config.rb:16:in `&lt;top (required)&gt;': uninitialized constant DevelopmentMailInterceptor (NameError)\n</code></pre>\n\n<p>How do i fix it?</p>\n\n<p>The code I am using is shown below:</p>\n\n<pre><code>config/initializer/mailer_config.rb\n\nActionMailer::Base.default_charset = \"utf-8\"\nActionMailer::Base.default_content_type = \"text/html\"\nActionMailer::Base.raise_delivery_errors = true\nActionMailer::Base.perform_deliveries = true\nActionMailer::Base.delivery_method = :smtp\nActionMailer::Base.smtp_settings = {\n:enable_starttls_auto =&gt; true,\n:address =&gt; \"secure.emailsrvr.com\",\n:port =&gt; '25',\n:domain =&gt; \"domain\",\n:user_name =&gt; \"user_name\",\n:password =&gt; \"password\",\n:authentication =&gt; :plain\n</code></pre>\n\n<p>}</p>\n\n<pre><code>ActionMailer::Base.register_interceptor(DevelopmentMailInterceptor) if  Rails.env.development?\n</code></pre>\n\n<p>lib/development_mail_interceptor.rb</p>\n\n<pre><code>class DevelopmentMailInterceptor\n\n  def self.delivering_email(message)\n    message.to = \"email\"\n  end\n\nend\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mysqli","backup","dropbox"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13081839,"title":"Why can't I connect to Dropbox using OAuth?","body":"<p>I want to store my db backup in my dropbox account every night. For this I'm using Backup + dropbox gem. My Ruby version is 1.8.7p358 and Rails 2.3.8 and I'm using a Mysql database.</p>\n\n<p>Here is my error in console</p>\n\n<pre><code>[2012/10/26 11:25:28][error]ModelError: Backup for My Backup (my_backup) Failed!\n[2012/10/26 11:25:28][error]   An Error occured which has caused this Backup to abort before completion.\n[2012/10/26 11:25:28][error]   Please review the Log for this Backup to determine if steps need to be taken\n[2012/10/26 11:25:28][error]   to clean up, based on the point at which the failure occured.\n[2012/10/26 11:25:28][error]   Reason: OAuth::Unauthorized\n[2012/10/26 11:25:28][error]   401 Unauthorized\n</code></pre>\n\n<p>Here is my code </p>\n\n<pre><code>    Backup::Model.new(:my_backup, 'My Backup') do\n\n      database MySQL do |db|\n        db.name               = \"app_development\"\n        db.username           = \"user\"\n        db.password           = \"pass\"\n        db.host               = \"127.0.0.1\"\n      end\n\n      store_with Dropbox do |db|\n        db.api_key    = 'nvpsggrunft0'\n        db.api_secret = '71dvvvdx48hy3'\n        db.path       = '/backups'\n        db.keep       = 80\n        db.timeout    = 443\n      end\n\n\n      store_with FTP do |server|\n        server.username = 'aadddn'\n        server.password = 'tdsddsd'\n        server.ip       = 'Ip Address'\n        server.port     = 21\n        server.path     = ''\n        server.keep     = 30\n        server.passive_mode = true\n      end\n\n      compress_with Gzip do |compression|\n        compression.best = true\n        compression.fast = false\n      end\n\n      notify_by Mail do |mail|\n        mail.on_success           = true\n        mail.on_failure           = true\n\n        mail.from                 = 'xyx@abc.com'\n        mail.to                   = 'sumit.munot@cipher-tech.com'\n        mail.address              = 'mail.abc.com'\n        mail.port                 = 26\n        mail.domain               = 'abc.com'\n        mail.user_name            = 'abc'\n        mail.password             = 'gvgfgxvxv'\n        mail.authentication       = 'login'\n        mail.enable_starttls_auto = false\n      end  \nend\n</code></pre>\n\n<p>I am running the following command in console for taking the backup</p>\n\n<pre><code>backup perform -t my_backup -c /home/xyz/my_workplace/abc/lib/Backup/config.rb \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":18,"score":-1,"question_id":13103030,"title":"Devise + Omniauth with separate email or username","body":"<p>Using devise and omniauth is there a way to allow users to sign up using an email AND omniauth? I would like to allow the user to enter a separate email (not from the omniauth provider) and then create an account using the omniauth  + the email they provide in the form.</p>\n\n<p>In railscasts, Ryan does something similar with the email field, however in his example you need to click the sign up button after receiving a validation error. This presents two usability errors. Frist, you should not plan on forcing every user to see a validation error when signing up. Second, some users may repeatedly click with \"sign up with [provider]\" button and not realize that they now need to click the normal sign up link.</p>\n\n<p>Does anyone know if we are able to pass information to facebook using omniauth and have it returned to use in the callback?</p>\n\n<p>== update ==\nNow playing around with '/auth/:provider/callback/:email'. It looks like the email params will be passed back with the callback. </p>\n"},{"tags":["sql","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":78,"score":6,"question_id":13096558,"title":"How do I query for an Activity that has 3 tags?","body":"<p>I have the following models:</p>\n\n<p><strong>activity.rb</strong></p>\n\n<p><strong>tag.rb</strong></p>\n\n<p><strong>tagging.rb</strong> </p>\n\n<p>Tagging is a join model for activity and tag.</p>\n\n<p>I would like to search an Activity that has 2 or more tags. How do I do this in rails?</p>\n\n<p>For example:</p>\n\n<p>I have tag1 = Christmas, tag2 = Florida, tag3 = John</p>\n\n<p>I want to find the Activity where tag1, tag2 and tag3 are present if it exists.</p>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>What I ended up doing:</p>\n\n<pre><code>tags = [tag1, tag2, tag3]\n\nactivities = []\ntags.each do |tag|\n  activities &lt;&lt; tag.activities\nend\n\nactivities.flatten.group_by { |activity| activity.id }\n</code></pre>\n\n<p>If any of the groups values' size is equal to tags.size then that activity contains all tags.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":4,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":1467,"score":5,"question_id":8552763,"title":"Best way to highlight current page in Rails 3? -- apply a css class to links conditionally","body":"<p>For the following code:</p>\n\n<pre><code>&lt;%= link_to \"Some Page\", some_path %&gt;\n</code></pre>\n\n<p><strong>How do I apply a css class <code>current</code> using the <code>current_page?‎</code> helper method?</strong></p>\n\n<p>Or if some other better way is available?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","paperclip","paperclip-validation"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13102029,"title":"Paperclip gives error when image is not uploaded","body":"<p>Paperclip works fine when I upload an image and then display it with:</p>\n\n<pre><code>&lt;%= image_tag @post.photo.url(:medium) %&gt;\n</code></pre>\n\n<p>The problem is, if an image wasn't uploaded, I get this error:</p>\n\n<pre><code>NoMethodError in Posts#show\n\nShowing /Users/me/RubymineProjects/level_60/app/views/posts/show.html.erb where line #16 raised:\n\nundefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>I try to check and see if the image exists with <code>&lt;% if @post.photo %&gt;</code> or <code>&lt;% if @post.photo != '' %&gt;</code>.  However, both of those always return true even when there's no image uploaded.</p>\n\n<p>How do I display an image through paperclip only if it exists?</p>\n"},{"tags":["ruby-on-rails-3","devise","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":8,"score":-1,"question_id":13102292,"title":"Devise and mongoid - email_changed? not exists","body":"<p>if not defining an email field I get this error, is this normal?\nHow can I fix it the proper way?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","gem"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":314,"score":0,"question_id":10475837,"title":"ruby-debug-base19-0.11.26.gem on WIN x64","body":"<p><strong>Info about my system:</strong></p>\n\n<p><code>ruby -v</code> -> ruby 1.9.3p125 (2012-02-16) [i386-mingw32]</p>\n\n<p><code>gem -v</code> -> 1.8.24</p>\n\n<hr>\n\n<p>when i'm running </p>\n\n<pre><code>bundle install\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Fetching source index for http://rubygems.org/\nCould not find ruby-debug-base19-0.11.26 in any of the sources\n</code></pre>\n\n<p>the firewall is OFF</p>\n\n<p>I downloaded this file: ruby-debug-base19-0.11.26.gem</p>\n\n<p>but when i run:</p>\n\n<pre><code>gem install ruby-debug-base19-0.11.26.gem\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>Temporarily enhancing PATH to include DevKit...\nBuilding native extensions.  This could take a while...\nERROR:  Error installing ruby-debug-base19-0.11.26.gem:\n        ERROR: Failed to build gem native extension.\n\n        C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb\nchecking for rb_method_entry_t.called_id in method.h... no\nchecking for rb_control_frame_t.method_id in method.h... no\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n        --with-opt-dir\n        --without-opt-dir\n        --with-opt-include\n        --without-opt-include=${opt-dir}/include\n        --with-opt-lib\n        --without-opt-lib=${opt-dir}/lib\n        --with-make-prog\n        --without-make-prog\n        --srcdir=.\n        --curdir\n        --ruby=C:/RailsInstaller/Ruby1.9.3/bin/ruby\n        --with-ruby-dir\n        --without-ruby-dir\n        --with-ruby-include\n        --without-ruby-include=${ruby-dir}/include\n        --with-ruby-lib\n        --without-ruby-lib=${ruby-dir}/lib\nextconf.rb:16:in `block in &lt;main&gt;': break from proc-closure (LocalJumpError)\n        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ruby_core_sour\nce-0.1.5/lib/ruby_core_source.rb:18:in `call'\n        from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ruby_core_sour\nce-0.1.5/lib/ruby_core_source.rb:18:in `create_makefile_with_core'\n        from extconf.rb:32:in `&lt;main&gt;'\n\n\nGem files will remain installed in C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9\n.1/gems/ruby-debug-base19-0.11.26 for inspection.\nResults logged to C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/ruby-debu\ng-base19-0.11.26/ext/ruby_debug/gem_make.out\n</code></pre>\n\n<p>what's the problem??</p>\n"},{"tags":["ruby-on-rails-3","link-to","link-to-remote"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":2572,"score":3,"question_id":5872298,"title":"Rails 3 - How to send data on link_to :remote=>true?","body":"<p>I am trying to figure out the new <code>link_to</code> in <code>Rails 3</code> but i still don't get it\nIn Rails 2 I do:</p>\n\n<pre><code>&lt;%= link_to_remote \"My Link\",:url=&gt;{:action=&gt;:myaction},:with=&gt;\"'data='+$('#someField').attr('value')\" %&gt;\n</code></pre>\n\n<p>but with the new syntax in Rails 3 how should it be?</p>\n\n<p>I'm trying something like</p>\n\n<pre><code>&lt;%=link_to \"My Link\",{:action=&gt;\"myaction\"},:with=&gt;\"'data='+$('#someField').attr('value');\",:remote=&gt;true%&gt;\n</code></pre>\n\n<p>but I'm not getting the quantity params in the controller's action</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","configuration","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":29,"score":2,"question_id":13101038,"title":"How to know what config contains in rails","body":"<p>Is there a way to know what is the configuration defined in development.rb and production.rb?</p>\n\n<p>there is a lot of mystery into what is set. </p>\n\n<p>Is there a way to see that?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13060784,"title":"How to reference parent model from Carrierwave Uploader object","body":"<p>I want to run some methods after the upload of a file has been completed via Carrierwave. Carrierwave includes several callback methods detailed <a href=\"https://github.com/jnicklas/carrierwave/wiki/How-to%3a-use-callbacks\" rel=\"nofollow\">here</a>. </p>\n\n<p>I'm planning on using the :store callback.</p>\n\n<p>That's great, but it requires me to run the callback method in the Uploader object instance. This isn't the end of the world, but I want to keep all the logic inside of my parent Model. </p>\n\n<p><strong>My question is: How should I be referencing the parent model from the Uploader? I don't see anything obvious in the documentation?</strong></p>\n\n<p>I suppose I could do something like</p>\n\n<pre><code>ParentModel.last.call_my_method_here\n</code></pre>\n\n<p>but this seems like a very brittle way to code this (not expecting a lot of requests, but still). </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13095955,"title":"Carrierwave yml fixture to upload file","body":"<p>I have carrierwave setup. Its working without any issues. Now, below are the deal_images fixtures:</p>\n\n<pre><code>d1_image1:\n  image: app_images/img1.png\n  usage_tag: thumbnail\n  deal: first_deal\nd1_image2:\n  image: app_images/img2.png\n  usage_tag: thumbnail\n  deal: second_deal\n</code></pre>\n\n<p>Now, what it does is just enter string in image and image.url is not pointing anywhere. I want to use image in app_image/img1.png to be uploaded when i run <code>rake db:fixtures:load</code> into uploads directory. </p>\n\n<p>Is this correct way of doing it?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","deployment","capistrano"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":762,"score":0,"question_id":7133555,"title":"Deploying with Capistrano","body":"<p>I am using Ruby on Rails 3.0.9 and I trying to setup the Capistrano gem (following the <em>Agile Web Development with Rails</em> book - Fourth Edition). I setup git and all related directories\\files on the remote machine (it works) and all \"basic\" things related to Capistrano. Now if I run from my local machine the following commands those work as expected:</p>\n\n<pre><code>cap deploy:setup\n# ...\n\ncap deploy:check\n# ...\n# You appear to have all necessary dependencies installed\n</code></pre>\n\n<p>At this time on the server machine in my project directory I have the following directories (created by Capistrano):</p>\n\n<pre><code>&lt;my_project_dir&gt;/releases\n&lt;my_project_dir&gt;/shared\n</code></pre>\n\n<p><em>Nothing more</em>.</p>\n\n<p><strong>What I should do now?</strong> For example, have I to upload all my application file from my local machine to the remote machine?</p>\n\n<p>P.S.: I also setup my Apache2 server to point to the <code>&lt;my_project_dir&gt;/current/public</code> directory but Capistrano didn't create that folder.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong> for <em>@Alex</em></p>\n\n<p>If I run the <code>cap deploy</code> command I get the following:</p>\n\n<pre><code>  * executing `deploy'\n  * executing `deploy:update'\n ** transaction: start\n  * executing `deploy:update_code'\n    updating the cached checkout on all servers\n    executing locally: \"git ls-remote root@&lt;SERVER_IP_ADDRESS&gt;:/git/&lt;my_project_name&gt;.com.git master\"\n    command finished in 3086ms\n  * executing \"if [ -d /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy ]; then cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git fetch -q origin &amp;&amp; git fetch --tags -q origin &amp;&amp; git reset -q --hard 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1 &amp;&amp; git clean -q -d -x -f; else git clone -q root@&lt;SERVER_IP_ADDRESS&gt;:/git/&lt;my_project_name&gt;.com.git /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git checkout -q -b deploy 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1; fi\"\n    servers: [\"&lt;SERVER_IP_ADDRESS&gt;\"]\n    [&lt;SERVER_IP_ADDRESS&gt;] executing command\n ** [&lt;SERVER_IP_ADDRESS&gt; :: err] Host key verification failed.\n ** [&lt;SERVER_IP_ADDRESS&gt; :: err] fatal: The remote end hung up unexpectedly\n    command finished in 396ms\n*** [deploy:update_code] rolling back\n  * executing \"rm -rf /srv/www/&lt;my_project_name&gt;.com/releases/20110820175634; true\"\n    servers: [\"&lt;SERVER_IP_ADDRESS&gt;\"]\n    [&lt;SERVER_IP_ADDRESS&gt;] executing command\n    command finished in 353ms\nfailed: \"sh -c 'if [ -d /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy ]; then cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git fetch -q origin &amp;&amp; git fetch --tags -q origin &amp;&amp; git reset -q --hard 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1 &amp;&amp; git clean -q -d -x -f; else git clone -q root@&lt;SERVER_IP_ADDRESS&gt;:/git/&lt;my_project_name&gt;.com.git /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; cd /srv/www/&lt;my_project_name&gt;.com/shared/cached-copy &amp;&amp; git checkout -q -b deploy 36ccf7b6f63041ee8dcdf4ca0a7c0b10dbc8bad1; fi'\" on &lt;SERVER_IP_ADDRESS&gt;\n</code></pre>\n\n<p><em>Note</em>: <code>failed: ...</code> on the last line. What is the problem?</p>\n"},{"tags":["ruby-on-rails-3","postgresql","index","group-by"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13099187,"title":"How to know which attributes are used on GROUP_BY in Rails","body":"<p>I am improving the database tables by adding indexes where appropriate.</p>\n\n<p>I'd like to add indexes to attributes that are used on GROUP_BY queries.</p>\n\n<p>Is there a way to automagically know which fields were used by GROUP_BY?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13096536,"title":"Rails path nomenclature not working","body":"<p>I have a Fixer model, but, unlike all the other models in my app, its routing isn't working right, even though there's a resource line for it in the routes file.</p>\n\n<p>The problem is, when I try to link to the basic show path any number of ways, like</p>\n\n<pre><code>&lt;%= link_to \"Fixer\", fixer_path(@fixer) %&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;%= link_to \"Fixer\", @fixer %&gt;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>&lt;%= link_to \"Fixer\", fixer_path(@fixer.id) %&gt; # I got desperate\n</code></pre>\n\n<p>it links to /fixers.[:id] (not a real page) instead of /fixers/[:id]. No idea what's happening, cause my resources line is there, and show is a basic resources action, and all the other similarly resourced models seem to be working just fine.</p>\n\n<p>Any ideas? (I can put more code up if necessary. Just not sure what would be relevant).</p>\n\n<p>EDIT -- The Fixers output in my rake routes:</p>\n\n<pre><code>       fixers GET    /fixers(.:format)           fixers#index\n              POST   /fixers(.:format)           fixers#create\n    new_fixer GET    /fixers/new(.:format)       fixers#new\n   edit_fixer GET    /fixers/:id/edit(.:format)  fixers#edit\n              GET    /fixers/:id(.:format)       fixers#show\n              PUT    /fixers/:id(.:format)       fixers#update\n              DELETE /fixers/:id(.:format)       fixers#destroy\n</code></pre>\n\n<p>Whoa. Just noticed after posting this that the 5th line is missing the \"fixer\" before the show action line that all my other models have. Why would that have happened? How do I fix it?</p>\n\n<p>EDIT -- I figured it out! Really dumb issue. For some reason, back when I was learning how to do all this, I both included a resources line and added this line above it:</p>\n\n<pre><code>match '/fixer', to: 'fixers#new'\n</code></pre>\n\n<p>When I took that line out (cause it was redundant), the problem went away. I guess I was messing with the Rails routing automagic. They really do make those defaults the best option.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":69,"score":1,"question_id":13097993,"title":"Rails - Find all projects of a user","body":"<p>I started to learn Rails a few days ago and also have not much experience with Ruby too. The problem with me now is trying to find all the projects of a certain user, given the relationship below.</p>\n\n<p><strong>User Model</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    has_many :projects_users\n    has_many :projects, :through =&gt; :projects_users\n    attr_accessible :email, :firstname, :id, :lastname, :password, :username, :password\n    has_secure_password\nend\n</code></pre>\n\n<p><strong>Project Model</strong></p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n    has_many :projects_users\n    has_many :users, :through =&gt; :projects_users\n    attr_accessible :date_created, :id, :name\nend\n</code></pre>\n\n<p><strong>Project_User Model</strong></p>\n\n<pre><code>class ProjectsUsers &lt; ActiveRecord::Base\n    belongs_to :project\n    belongs_to :user\nend\n</code></pre>\n\n<p>My attempt so far is:</p>\n\n<pre><code>@projectuserid = ProjectsUsers.find(:all, :conditions =&gt; \"user_id=#{session[:user_id]}\")\n@projects = Project.all(@projectuserid)\n</code></pre>\n\n<p>But it seems like <code>@projectuserid</code> is an array itself so the query doesn't work. I know it could be achieved in one line of code for this HABTM relationship model, but still I have so little knowledge about Rails.</p>\n\n<p>Another approach of mine looks like this, but a blank result returned:</p>\n\n<pre><code>@projects = Project.find :all,\n         :conditions =&gt; \"id in (select distinct project_id from projects_users where user_id=#{session[:user_id]})\"\n</code></pre>\n"},{"tags":["ruby-on-rails-3","sunspot"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":147,"score":1,"question_id":10579744,"title":"Failure starting sunspot solr server","body":"<p>I have a problem with starting the sunspot server. last week it worked like a charm but now i get an error when i run rake sunspot:solr:run </p>\n\n<p>my output using --trace</p>\n\n<pre><code>C:\\contractbeheersysteem2&gt;rake sunspot:solr:run --trace\n** Invoke sunspot:solr:run (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Execute sunspot:solr:run\njava version \"1.7.0_04\"\nJava(TM) SE Runtime Environment (build 1.7.0_04-b22)\nJava HotSpot(TM) Client VM (build 23.0-b21, mixed mode, sharing)\n2012-05-14 10:10:28.077::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog\n2012-05-14 10:10:28.374::INFO:  jetty-6.1.3\n2012-05-14 10:10:28.670::INFO:  Extract jar:file:/H:/RailsInstaller/Ruby1.9.3/li\nb/ruby/gems/1.9.1/gems/sunspot_solr-1.3.1/solr/webapps/solr.war!/ to C:\\DOCUME~1\n\\ksonnema\\LOCALS~1\\Temp\\Jetty_0_0_0_0_8982_solr.war__solr__-2c5peu\\webapp\n[Fatal Error] :107:17: Open quote is expected for attribute \"{1}\" associated wit\nh an  element type  \"name\".\n2012-05-14 10:10:31.577::INFO:  Started SocketConnector @ 0.0.0.0:8982\n</code></pre>\n\n<p>hope someone knows what the problem.</p>\n"},{"tags":["ruby-on-rails-3","custom-data-attribute"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13097447,"title":"how to use data-attribute in rails3?","body":"<p>I have a html select syntax like :</p>\n\n<pre><code>&lt;select id=\"salary_structure_salary_structure_line_items_attributes_0_payhead_id\" class=\"half\" name=\"salary_structure[salary_structure_line_items_attributes][0][payhead_id]\"&gt;\n&lt;option data-payhead=\"Earnings\" value=\"2\"&gt; Basic &lt;/option&gt;\n&lt;option data-payhead=\"Earnings\" value=\"3\"&gt; Daily allowance &lt;/option&gt;\n&lt;option data-payhead=\"Standard deductions\" value=\"4\"&gt; Employee provident fund &lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>How do i get this work in rails syntax? what change should i do in below code to get the above result:</p>\n\n<pre><code>&lt;%= select_tag \"salary_structure[salary_structure_line_items_attributes][#{index}][payhead_id]\", options_from_collection_for_select(@payheads, :id, :payhead_name, :selected =&gt; salary_structure_line_item.payhead_id ), :include_blank =&gt; true, :class =&gt; \"half\"%&gt; \n</code></pre>\n\n<p>also i want to use 'selected' option in this code.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12965132,"title":"Rails Asset Pipeline Path Issue","body":"<p>I have a Rails app running on a shared web host under a folder in my root direction called 'mintrus-ror/'. There is a symbolic link 'public_html/' that points to 'mintrus-ror/public/'. My Rails app loads in the browser but the stylesheets don't load. Looking at the rendered source I noticed the assets path it is using is '/mintrus-ror/assets/application.css'. I am trying to figure out how to change it so it does not include the 'mintrus-ror/' directory in the assets path. Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","variables","metaprogramming"],"answer_count":4,"favorite_count":2,"up_vote_count":0,"down_vote_count":0,"view_count":516,"score":0,"question_id":7079222,"title":"How to set \"dynamically\" variable values?","body":"<p>I am using Ruby on Rails 3.0.9 and I am trying to set \"dynamically\" some variable values. That is...</p>\n\n<p>... in my model file I have:</p>\n\n<pre><code>attr_accessor :variable1, :variable2, :variable3\n\n\n# The 'attributes' argument contains one or more symbols which name is equal to \n# one or more of the 'attr_accessor' symbols.\n\ndef set_variables(*attributes)\n\n  # Here I should set to 'true' all \":variable&lt;N&gt;\" attributes passed as symbol\n  # in the 'attributes' array, but variable names should be interpolated in a \n  # string.\n  # \n  # For example, I should set something like \"prefix_#{':variable1'.to_s}_suffix\".\n\nend\n</code></pre>\n\n<p><strong>How can I set those variable values to <code>true</code>?</strong></p>\n\n<hr>\n\n<p>I tried to use the <code>self.send(...)</code> method, but I did not succeed (but, probably, I don't know how to use at all that <code>send</code> method... is it possible do to that I need by using the <code>send</code> method?!).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","respond-to"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":2616,"score":1,"question_id":5415487,"title":"AbstractController::DoubleRenderError that shouldn't be","body":"<p>I've been getting the following error when I hit this destroy method in a my User controller.</p>\n\n<pre><code>AbstractController::DoubleRenderError (Render and/or redirect were called multiple times in this action. Please note that you may only call render OR redirect, and at most once per action. Also note that neither redirect nor render terminate execution of the action, so if you want to exit an action after redirecting, you need to do something like \"redirect_to(...) and return\".):\n</code></pre>\n\n<p>It's a strange one, because I honestly am only responding once to the call.</p>\n\n<p>Here's my action: </p>\n\n<pre><code>def destroy\n  user = User.find(params[:id])\n  if user.has_role_for? current_client\n\n    # then we remove the role\n    user.has_no_roles_for! current_client\n\n    # was that the users only role?\n    if user.roles.count == 0\n      user.destroy\n    end\n\n    respond_with head :ok\n  else\n    respond_with({:error=&gt;'unauthorised'}, :status =&gt; :forbidden)\n  end\nend\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","testing"],"answer_count":2,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":401,"score":5,"question_id":7633839,"title":"Turn on full backtrace in Ruby on Rails TestCase","body":"<p>Only one line of backtrace is displayed when I run:</p>\n\n<pre><code>rake test\n</code></pre>\n\n<p>Output:</p>\n\n<p>...</p>\n\n<pre><code>ERROR should get search for keywords (1.93s) \n  NoMethodError: undefined method `features' for #&lt;Transcript:0x00000006243780&gt;\n  /usr/lib/ruby/gems/1.9.1/gems/activemodel-3.1.0/lib/active_model/attribute_methods.rb:385:in `method_missing'\n</code></pre>\n\n<p>...</p>\n\n<p>I need more lines of backtrack information.\nI have tried</p>\n\n<ul>\n<li><p>rake test --trace</p></li>\n<li><p><code>Rails.backtrace_cleaner.remove_silencers!</code> in config/initializers/backtrace_silencers.rb</p></li>\n<li><p>setting global $DEBUG=true</p></li>\n</ul>\n\n<p>and it didn't work.</p>\n\n<p>How can I turn it on?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","methods","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13096217,"title":"Representing methods in have_* options in rspec","body":"<p>I created a method within an rb file in my spec folder. I want to use the method in checking if one of my elements has the returned value of the method as it's text. My question is, how would I write the method <code>name</code> into the have_selector text option?</p>\n\n<p>My rspec file</p>\n\n<pre><code>def name\n  user = User.first\n  return user.name\nend\n\ndescribe \"test\" do\n\n  it \"has the name in the file\"\n    visit users_path\n    page.should have_selector('td', text: name)\n    # I need name in the text options to represent the method name created\n  end\n\nend\n</code></pre>\n\n<p>When I run rspec, it tells me that</p>\n\n<pre><code>NoMethodError: private method 'name' called for nil:NilClass\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":13077902,"title":"has_and_belongs_to_many associations in factory_girl 4.1","body":"<p>I'm new to factory_girl and trying to figure out how to effectively generate a factory for the following models:</p>\n\n<pre><code>class Company &lt; ActiveRecord::Base\n    has_and_belongs_to_many :tags\nend\n\nclass Tags &lt; ActiveRecord::Base\n    has_and_belongs_to_many :companies\n\n    validates :type , :inclusion =&gt; { :in =&gt; %w(market location) } \nend\n</code></pre>\n\n<p>I've taken a look at previous answers on StackOverflow (including <a href=\"http://stackoverflow.com/questions/1484374/how-to-create-has-and-belongs-to-many-associations-in-factory-girl\">this one</a>), however most of them are outdated and/or don't have a proper answer to the question.  Is there anybody out there that can help define factories for these two objects with Factorygirl?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's what I've come up wtih so far</p>\n\n<pre><code>FactoryGirl.define do\nfactory :tag do\n    id  448\n        trait :market do\n        type \"market\"\n    end\n    trait :location do\n        type \"location\"\n    end\n    name \"software\"\nend\n\nfactory :company do\n    id  1234\n    name \"Apple Inc.\"\n    factory :company_with_tags do\n        #setting the default # of tags for companies\n        ignore do\n            tag_count   2\n        end\n\n            after(:create) do |company , evaluator|\n                FactoryGirl.create_list(:tag , evaluator.tag_count , company: company)\n            end \n    end\nend\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","heroku","redis","asset-pipeline"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13096531,"title":"Deploying redis on Heroku when manually precompiling assets","body":"<p>I'm following the instructions here: <a href=\"https://devcenter.heroku.com/articles/redistogo\" rel=\"nofollow\">https://devcenter.heroku.com/articles/redistogo</a> to deploy redis on Heroku. I'm however running into some issues while manually precompiling my assets on localhost using:</p>\n\n<pre><code>RAILS_ENV=production bundle exec rake assets:precompile\n</code></pre>\n\n<p>before pushing it out to heroku. The ENV[\"REDISTOGO_URL\"] config variable isn't set when I'm doing the production mode precompile on localhost so I get an URI error when URI.parse is called. </p>\n\n<p>How do I get around this error? I don't want to hardcode the URI in my production.rb since Heroku sets this when starting the redis server. I'm quite new to this whole asset pipeline / deployment processes so any tip would be appreciated. </p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","redirect"],"answer_count":4,"favorite_count":8,"up_vote_count":10,"down_vote_count":0,"view_count":5089,"score":10,"question_id":5454806,"title":"Rails 3: How to \"redirect_to\" in Ajax call?","body":"<p>The following <code>attempt_login</code> method is called using Ajax after a login form is submitted.</p>\n\n<pre><code>class AccessController &lt; ApplicationController\n  [...]\n  def attempt_login\n    authorized_user = User.authenticate(params[:username], params[:password])\n\n    if authorized_user\n      session[:user_id] = authorized_user.id\n      session[:username] = authorized_user.username\n      flash[:notice] = \"Hello #{authorized_user.name}.\"\n      redirect_to(:controller =&gt; 'jobs', :action =&gt; 'index')\n    else\n      [...]\n    end\n  end\nend\n</code></pre>\n\n<p>The problem is that <code>redirect_to</code> doesn't work.</p>\n\n<p>How would you solve this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","model","routing"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":13096229,"title":"Rails Routes with multiple model ids","body":"<p>I've got an app with an Item model and a Fixer model. Each Item belongs to a Fixer, and Fixers can have many items. I want to create a \"log\" page where a particular fixer can update information on a particular Item associated with them. Ideally something like this</p>\n\n<pre><code>www.myappname.com/fixers/&lt;fixer_id&gt;/log/&lt;item_id&gt;\n</code></pre>\n\n<p>I'm fairly new to Rails, so I'm not really sure how to figure out the routing/controller for this one. I looked in the Rails Guide section on routing, and the only thing that looked similar to what I want is Nested Models, but I ideally don't want to nest the models, because while items may technically \"belong_to\" fixers, that's not really the case in the real world (fixers are just associated, and belong_to was the most sensible way), and there's no other part of the relationship that requires/makes sense with nesting. More importantly, I don't really get what nesting the models means or does, and I try to avoid implementing solutions that I don't fully understand. </p>\n\n<p>If nesting's the way to go, let me know, but otherwise, how might I go about routing this? I've tried this in my routes.rb file:</p>\n\n<pre><code>match 'fixers/:id/log/:id' =&gt; 'fixers#log'\n</code></pre>\n\n<p>and created log.html.erb, but I don't know how I'd select the params of that in a controller (how does it know which \":id\" I'm selecting for? Is there a better way to do this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","twitter-bootstrap-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":64,"score":3,"question_id":13096038,"title":"SyntaxError in rails app controller","body":"<p>I used the twitter bootstrap library for my new simple rails app\nand used some scaffold for products model\ni updated the GemFile as well as the bundle command and the rails g bootstrap.\nwhen i run the web page i get the following error:</p>\n\n<pre><code>SyntaxError in ProductsController#index\n\n/Library/Ruby/Gems/1.8/gems/twitter-bootstrap-rails-2.1.4/app/helpers/glyph_helper.rb:9: syntax error, unexpected ':'\n...   content_tag :i, nil, class: names.map{|name| \"icon-#{name...\n</code></pre>\n\n<p>I don't know why this happened!</p>\n\n<p>Here is my GemFile:</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '3.2.7'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\ngem 'sqlite3'\n\ngem 'json'\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\n  gem 'twitter-bootstrap-rails'\nend\n\ngem 'jquery-rails'\n</code></pre>\n\n<p>controller code:</p>\n\n<pre><code>class ProductsController &lt; ApplicationController\n  # GET /products\n  # GET /products.json\n  def index\n    @products = Product.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render :json =&gt; @products }\n    end\n  end\n\n  # GET /products/1\n  # GET /products/1.json\n  def show\n    @product = Product.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render :json =&gt; @product }\n    end\n  end\n\n  # GET /products/new\n  # GET /products/new.json\n  def new\n    @product = Product.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render :json =&gt; @product }\n    end\n  end\n\n  # GET /products/1/edit\n  def edit\n    @product = Product.find(params[:id])\n  end\n\n  # POST /products\n  # POST /products.json\n  def create\n    @product = Product.new(params[:product])\n\n    respond_to do |format|\n      if @product.save\n        format.html { redirect_to @product, :notice =&gt; 'Product was successfully created.' }  \n        format.json { render :json =&gt; @product, :status =&gt; :created, :location =&gt; @product }\n      else\n        format.html { render :action =&gt; \"new\" }\n        format.json { render :json =&gt; @product.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /products/1\n  # PUT /products/1.json\n  def update\n    @product = Product.find(params[:id])\n\n    respond_to do |format|\n      if @product.update_attributes(params[:product])\n        format.html { redirect_to @product, :notice =&gt; 'Product was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render :action =&gt; \"edit\" }\n        format.json { render :json =&gt; @product.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /products/1\n  # DELETE /products/1.json\n  def destroy\n    @product = Product.find(params[:id])\n    @product.destroy\n\n    respond_to do |format|\n      format.html { redirect_to products_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","date","random"],"answer_count":6,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":2393,"score":5,"question_id":4894198,"title":"How to generate a random date in Ruby?","body":"<p>I have a model in my Rails 3 application which has a <code>date</code> field:</p>\n\n<pre><code>class CreateJobs &lt; ActiveRecord::Migration\n  def self.up\n    create_table :jobs do |t|\n      t.date \"job_date\", :null =&gt; false\n      ...\n      t.timestamps\n    end\n  end\n  ...\nend\n</code></pre>\n\n<p>I would like to prepopulate my database with random date values.</p>\n\n<p>What is the easiest way to generate a random date ?</p>\n"},{"tags":["jquery","ruby-on-rails-3","prototypejs","noconflict"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":137,"score":0,"question_id":8026425,"title":"Jquery with other libraries","body":"<p>I am getting an error message as  <code>element.dispatchEvent</code> is not a function. I am using jquery with prototyp in rails 3 application. In my layout file, i have added the js files as below</p>\n\n<pre><code> javascript_include_tag 'jquery','jquery_ujs','prototype','shadowbox/shadowbox.js' \n&lt;script type=\"text/javascript\"&gt;jQuery.noConflict();&lt;/script&gt;\n</code></pre>\n\n<p>I have also added <code>jQuery.noConflict</code> as above and used <code>jQuery</code> instead of <code>$</code> in jquery fuctions. Any idea how to resolve this.?</p>\n\n<p>In my another controller page action i have also mentioned the same thing as there are some js files which needs to be reloaded only for that particalar page. </p>\n\n<p>I am a newbie in js as well as rails also.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":188,"score":0,"question_id":10557309,"title":"Updating user profile without having to enter the password and confirmation each time","body":"<p>I'm trying to create a new page called edit_profile for my User model so that the user can edit his profile(string). I'm following <a href=\"http://railscasts.com/episodes/41-conditional-validations\" rel=\"nofollow\">http://railscasts.com/episodes/41-conditional-validations</a></p>\n\n<p>Here is the form (edit_profile.html.erb):</p>\n\n<pre><code>  &lt;%= form_for @user, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :profile %&gt;&lt;br/&gt;\n    &lt;%= f.text_area :profile, :class =&gt; \"round\" %&gt;&lt;br /&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= submit_tag \"update\", :id =&gt; \"updateSubmit\" %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The problem I'm having is that I have validation for the presence of password and password confirmation. When I load my edit_profile view, I keep getting this message <code>Password is too short (minimum is 6 characters)</code> even before I try to submit a new profile.</p>\n\n<p>Here is my users_controller.rb:</p>\n\n<pre><code>def edit_profile\n  @user = current_user\n  @user.updating_password = false\n  @user.save\n  @title = \"Edit profile\"\nend\n\ndef update\n  @user = User.find(params[:id])\n  if @user.update_attributes(params[:user])\n    flash[:success] = \"Account updated.\"\n    redirect_to @user\n  else\n    @title = \"Edit user\"\n    render 'edit'\n  end\nend\n</code></pre>\n\n<p><strong>How do I bypass my password validation when I just want to edit my profile attribute in the user model?</strong></p>\n\n<p>Thanks!</p>\n\n<p>Other relevant information:</p>\n\n<p>user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n    attr_accessor :password, :updating_password\n    attr_accessible :name, :email, :password, :password_confirmation, :photo, \n                    :profile\n    before_save :downcase_fields\n    before_save :encrypt_password\n    validates_presence_of :password, :if =&gt; :should_validate_password?\n    validates_confirmation_of :password, :if =&gt; :should_validate_password?      \n    def should_validate_password?\n      updating_password || new_record?\n    end\n\n    validates :name, :presence =&gt; true,\n              :name_format =&gt; true,  \n              :uniqueness =&gt; { :case_sensitive =&gt; false }          \n    validates :email, :presence =&gt; true, \n              :email_format =&gt; true,\n              :uniqueness =&gt; { :case_sensitive =&gt; false }\n    validates :password, \n               #:presence =&gt; true,\n              #:confirmation =&gt; true,\n              :length =&gt; { :within =&gt; 6..40 }\n    validates :profile,  :length =&gt; { :maximum =&gt; 160 }\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-many-through","simple-form"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":141,"score":3,"question_id":12832546,"title":"Simple_Form Association with has_many :through extra field","body":"<p>I have two models, Developers and Tasks,</p>\n\n<pre><code>class Developer &lt; ActiveRecord::Base\n  attr_accessible :address, :comment, :email, :name, :nit, :phone, :web\n  has_many :assignments\n  has_many :tasks, :through =&gt; :assignments\nend\n\nclass Task &lt; ActiveRecord::Base\n  attr_accessible :description, :name, :sprint_id, :developer_ids\n  has_many :assignments\n  has_many :developers, :through =&gt; :assignments\nend\n\nclass Assignment &lt; ActiveRecord::Base\n  attr_accessible :accomplished_time, :developer_id, :estimated_time, :status, :task_id\n  belongs_to :task\n  belongs_to :developer\nend\n</code></pre>\n\n<p>im taking care of the relation by adding an Assignment table, so i can add many developers to one task in particular, now i would also like to be able to manipulate the other fields i added to the joining table like the 'estimated_time', 'accomplished_time'... etc... what i got on my Simple_form is\n`</p>\n\n<pre><code>&lt;%= simple_form_for [@sprint,@task], :html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n  &lt;%= f.input :name %&gt;\n  &lt;%= f.input :description %&gt;\n  &lt;%= f.association :developers, :as =&gt; :check_boxes %&gt;\n\n  &lt;div class=\"form-actions\"&gt;\n    &lt;%= f.button :submit, :class =&gt; 'btn-primary' %&gt;\n    &lt;%= link_to t('.cancel', :default =&gt; t(\"helpers.links.cancel\")),\n                project_sprint_path(@sprint.project_id,@sprint), :class =&gt; 'btn' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;`\n</code></pre>\n\n<p>This only allows me to select the developers, i want to be able to modify the estimated_time field right there.</p>\n\n<p>Any Suggestions?</p>\n"},{"tags":["osx","ruby-on-rails-3","imagemagick","rmagick"],"answer_count":1,"favorite_count":5,"up_vote_count":5,"down_vote_count":0,"view_count":2708,"score":5,"question_id":4290759,"title":"Error installing Rmagick on Mac OS X","body":"<p>I followed the installation of <strong><em>RMagick</em></strong> for <strong><em>OSX:</em></strong>\n<a href=\"http://rmagick.rubyforge.org/install-faq.html#osx\">http://rmagick.rubyforge.org/install-faq.html#osx</a></p>\n\n<p>I have done the <strong><em>Imagemagick</em></strong> installation from <strong><em>John Maddux</em></strong> (solution to install <em>ImageMagick</em> on OSX without using <em>MacPorts</em>)</p>\n\n<p>Here's my terminal window:</p>\n\n<pre><code>Suebphatt:~ suebphattleelertphong$ ruby -v\nruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]\n\nSuebphatt:~ suebphattleelertphong$ rails -v\nRails 3.0.3\n\nSuebphatt:~ suebphattleelertphong$ gem -v\n1.3.7\n\nSuebphatt:~ suebphattleelertphong$ gem install rmagick\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rmagick:\nERROR: Failed to build gem native extension.\n\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb\nmkmf.rb can't find header files for ruby at /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/ruby.h\n\n\nGem files will remain installed in /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1 for     inspection.\nResults logged to /Library/Ruby/Gems/1.8/gems/rmagick-2.13.1/ext/RMagick/gem_make.out\nSuebphatt:~ suebphattleelertphong$ \n</code></pre>\n\n<p>Thanks a lot for help,\nSuebphatt</p>\n"},{"tags":["javascript","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":13095167,"title":"Trigger the controller to display view","body":"<p>I have a dropdown in view that is using js I pass the selected item from dropdown to controller, inside the controller I ran a query using the selected item from dropdown to extract some records. Now the problem is that I cannot display the query result to view. Basically I cannot trigger the controller to display in view.  Any help greatly appreciated.</p>\n\n<p>Here is the js to pass the data to controller:</p>\n\n<pre><code>&lt;script type=\"text/JavaScript\"&gt;\n$(function(){\n    $('.defined_call').bind('change', function(){\n        alert($(this).val());\n        $.ajax({\n            url: \"&lt;%= changeowner_path %&gt;\",\n            data: { my_str: $(this).val() }\n        });\n    });\n});\n&lt;/script&gt;\n\n&lt;%= select_tag \"dropdown_cases\", options_for_select(@ownerlist),{:id=&gt;\"defined_Id\",:class \n=&gt; \"defined_call'}  %&gt;\n</code></pre>\n\n<p>Here is the controller:</p>\n\n<pre><code>class ReassignsController &lt; ApplicationController\n  def changeowner\n    i=0\n    $myarr=[]\n    ownerl = Transaction.owner#declaredin model\n    @ownerlist=ownerl.collect { |c| [ c, c ] }#make it for dropdown\n    value=params[:my_str]#return value from dropdown\n    $value1=value.to_s#make it for owner table\n    @owner_records=Transaction.where(:owner =&gt; $value1) \n\n    ===&gt; I would like to display to the view?\n  end\nend\n</code></pre>\n\n<p>Here is the view that I am using:</p>\n\n<pre><code>&lt;table class=\"table table-condensed\" id=\"sortTableExample\"&gt;\n&lt;tr&gt;\n&lt;th style=\"text-align:center\"&gt;Book Name&lt;/th&gt;\n&lt;th style=\"text-align:center\"&gt;Owner&lt;/th&gt;\n\n&lt;/tr&gt;\n\n&lt;% @owner_records.each do |arr_data| %&gt;\n&lt;tr&gt;\n&lt;td style=\"text-align:center\"&gt;&lt;%= arr_data.book%&gt;&lt;/td&gt;\n&lt;td style=\"text-align:center\"&gt;&lt;%= arr_data.owner%&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","cocoon"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":545,"score":1,"question_id":7538518,"title":"Rails 3.1. Cocoon link_to_add_association example needed","body":"<p>pls show any example of using Cocoon's 'link_to_add_association' with html_options.\n<a href=\"https://github.com/nathanvda/cocoon\" rel=\"nofollow\">https://github.com/nathanvda/cocoon</a></p>\n\n<p>Documentation says:</p>\n\n<pre><code>html_options: extra html-options (see link_to) There are two extra options that allow to conrol the placement of the new link-data:\n\n    data-association-insertion-node : the jquery selector of the node\n    data-association-insertion-position : insert the new data before or after the given node.\n</code></pre>\n\n<p>But i can not understand what to do, if i want insert partial just before my \"add element\" link. Not just after parent's div begin. This not gonna work:</p>\n\n<blockquote>\n  <p>&lt;%= link_to_add_association \"add element\", f, :production_years,\n  :position => \"after_all\" %></p>\n</blockquote>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13094855,"title":"Michael Hartl Rails Tutorial - Listing 11.36 (AJAX Unfollow) Error","body":"<p>In <a href=\"http://ruby.railstutorial.org/chapters/following-users#sec-a_working_follow_button_with_ajax\" rel=\"nofollow\">listing 11.36</a> of Michael Hartl's superb tutorial, changes the unfollow form to use AJAX, but I keep getting the following error when I click on the \"Unfollow\" button:</p>\n\n<pre><code>ActionView::Template::Error (undefined method `model_name' for NilClass:Class):\n</code></pre>\n\n<p>The form, however, does work. If I click \"Unfollow\" I unfollow the currently displayed user. So it seems that @user in the form declaration is valid when the form is submitted:</p>\n\n<pre><code>&lt;%= form_for(current_user.relationships.find_by_followed_id(@user),\n         html: { method: :delete },\n         remote: true) do |f| %&gt;\n</code></pre>\n\n<p>but perhaps it's no longer available when the \"Follow\" form tries to load?</p>\n\n<p>I've tried at length to track this down but I can't figure it out, and I haven't seen anyone else post the same issue.</p>\n\n<p>Any clues?</p>\n\n<p>Thanks.</p>\n"},{"tags":["jquery","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":13094867,"title":"Adding 3rd party jQuery code to our Rails RTF text box","body":"<p>I am adding a 3rd party feature into an existing rails app. The 3rd party gave me a piece of code which I am supposed to drop into my codebase but I'm confused as to where this should be posted. </p>\n\n<p>Posted is the 3rd party which I am supposed to add to my codebase:</p>\n\n<pre><code>&lt;script src=\"http://serviceweareusing.com/js/version-latest?cid=ourcompany\"&gt;&lt;/script&gt;\n&lt;script&gt;\n$(\"#textbox\").featureBox('init',{rte:true,userid:'&lt;ENTER CURRENT USERNAME&gt;'});\n&lt;/script&gt;\n</code></pre>\n\n<p>Posted is the existing code in my app for the form.</p>\n\n<p><strong>_post_form.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"create-post-row\"&gt;\n    &lt;label&gt;Body&lt;/label&gt;                     \n    &lt;textarea id=\"textbox\"&gt;\n        &lt;%= @post.body %&gt;\n    &lt;/textarea&gt;\n    &lt;%= form.hidden_field :body, :id =&gt; 'body_hidden_input' %&gt;\n    &lt;%= errors_for_field :body %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Where should this be posted? Does it go in a separate .js file or can I paste it right into the embedded ruby? Any insight would be great. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1034,"score":1,"question_id":6596529,"title":"Ruby on Rails: How to sort a collection_select","body":"<p>I want to sort / order it (desc or asc how i want it) by the database table column \"plays\"\nIm totally confused. Just found a solution for select but not collection_select?</p>\n\n<p>some code of my view</p>\n\n<pre><code>&lt;%= f.collection_select :player1, Player.all, :id, :name %&gt;\n</code></pre>\n\n<p>dont know how to sort / order</p>\n\n<p>there are also columns in the database table like \"plays\", \"goals\" ...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12505014,"title":"collection_select does not display dropdown, does any errors","body":"<p>Consider these simple, Reminder &amp; event models:</p>\n\n<pre><code>class Event &lt; ActiveRecord::Base\n  has_many :reminders\nend\n\n\nclass Reminder &lt; ActiveRecord::Base\n  belongs_to :event\n  accepts_nested_attributes_for :event\nend\n</code></pre>\n\n<p>now, I have build <code>reminders/new.html.haml</code> view in following way:</p>\n\n<pre><code>%h2 Reminders\n= form_for(@reminder, html: {class: \"form-horizontal\"}) do |f|\n  = f.fields_for :event do |event|\n    = event.collection_select :id, Event.all, :id, :name\n  = f.text_field(:issue_date, class: \"datepicker\", data: {\"date-format\" =&gt;\"dd/mm/yyyy\"}, 'date' =&gt; \"#{Time.new.strftime(\"%d/%m/%Y\")}\")\n  = f.text_field(:renewal_date, label:\"Due Date\", class: \"datepicker\", data: {'date-format' =&gt; 'dd/mm/yyyy', 'date' =&gt; \"#{Time.new.strftime(\"%d/%m/%Y\")}\"})\n  = f.submit\n</code></pre>\n\n<p>This view doesn't throw any errors &amp; reminders minus the <code>&lt;options&gt;</code> tag. \n<img src=\"http://screencloud.net/img/screenshots/f990e124f356330a10839b00cd92f75a.png\" alt=\"View\" title=\"View\"></p>\n\n<p>What I want to do is to display <code>Event.name</code> in the <code>&lt;options&gt;</code>. So what am I missing here?</p>\n\n<p>[Update]\nChanged to <code>form_for</code> &amp; it generates following html markup</p>\n\n<pre><code>&lt;form method=\"post\" id=\"new_reminder\" class=\"form-horizontal\" action=\"/reminders\" accept-charset=\"UTF-8\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input type=\"hidden\" value=\"✓\" name=\"utf8\"&gt;&lt;input type=\"hidden\" value=\"Yu7Qj4SW+GAMXx9dEL/ohjsqryEkxUXXGy+SHpN97hc=\" name=\"authenticity_token\"&gt;&lt;/div&gt;\n\n                &lt;input type=\"text\" size=\"30\" name=\"reminder[issue_date]\" id=\"reminder_issue_date\" date=\"20/09/2012\" data-date-format=\"dd/mm/yyyy\" class=\"datepicker\"&gt;\n                &lt;input type=\"text\" size=\"30\" name=\"reminder[renewal_date]\" label=\"Due Date\" id=\"reminder_renewal_date\" data-date=\"20/09/2012\" data-date-format=\"dd/mm/yyyy\" class=\"datepicker\"&gt;\n                &lt;input type=\"submit\" value=\"Create Reminder\" name=\"commit\"&gt;\n              &lt;/form&gt;\n</code></pre>\n\n<p>as you may notice <code>&lt;option&gt;</code> tag is missing for some reason. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13090165,"title":"link_to redirect to a wrong controller","body":"<p>I have a layout for my admin area called 'layout_admin' . In 'layout_admin', I have :</p>\n\n<pre><code>&lt;li&gt;&lt;%= link_to 'Contenu', :action=&gt;'index', :controller=&gt;'contents' %&gt;&lt;/li&gt;\n&lt;li&gt;&lt;%= link_to 'Petitions', :controller =&gt; 'petitions', :action =&gt; 'index' %&gt;&lt;/li&gt;\n</code></pre>\n\n<p>The first link for Contenu works fine, but the second one (for petitions) drives me to a strange error :</p>\n\n<blockquote>\n  <p>Routing Error \n  No route matches {:controller=>\"admin/<strong>edito</strong>\"}</p>\n</blockquote>\n\n<p>In the address bar I have : localhost:3000/admin/petitions</p>\n\n<p>In routes.rb  I have :</p>\n\n<pre><code>namespace :admin do resources :petitions \nend\n</code></pre>\n\n<p>I must also precise that \"edito\" is another controller outside the admin area which has one action \"index\". In routes.rb I have <code>get \"edito/index\"</code> concerning edito_controller.</p>\n\n<p>Does somebody have an idea of the source of the problem ?\nThansk.</p>\n\n<p>Full Rake routes :</p>\n\n<pre><code>        temoignages GET    /temoignages(.:format)              temoignages#index\n\n                POST   /temoignages(.:format)              temoignages#create\n new_temoignage GET    /temoignages/new(.:format)          temoignages#new\nedit_temoignage GET    /temoignages/:id/edit(.:format)     temoignages#edit\n     temoignage GET    /temoignages/:id(.:format)          temoignages#show\n                PUT    /temoignages/:id(.:format)          temoignages#update\n                DELETE /temoignages/:id(.:format)          temoignages#destroy\nadmin_petitions GET    /admin/petitions(.:format)          admin/petitions#index\n                POST   /admin/petitions(.:format)          admin/petitions#create\nnew_admin_petition GET    /admin/petitions/new(.:format)      admin/petitions#new\nedit_admin_petition GET    /admin/petitions/:id/edit(.:format) admin/petitions#edit\n admin_petition GET    /admin/petitions/:id(.:format)      admin/petitions#show\n                PUT    /admin/petitions/:id(.:format)      admin/petitions#update\n                DELETE /admin/petitions/:id(.:format)      admin/petitions#destroy\n admin_contents GET    /admin/contents(.:format)           admin/contents#index\n                POST   /admin/contents(.:format)           admin/contents#create\nnew_admin_content GET    /admin/contents/new(.:format)       admin/contents#new\nedit_admin_content GET    /admin/contents/:id/edit(.:format)  admin/contents#edit\n  admin_content GET    /admin/contents/:id(.:format)       admin/contents#show\n                PUT    /admin/contents/:id(.:format)       admin/contents#update\n                DELETE /admin/contents/:id(.:format)       admin/contents#destroy\n    admin_posts GET    /admin/posts(.:format)              admin/posts#index\n\n                POST   /admin/posts(.:format)              admin/posts#create\n  new_admin_post GET    /admin/posts/new(.:format)          admin/posts#new\n  edit_admin_post GET    /admin/posts/:id/edit(.:format)     admin/posts#edit\n     admin_post GET    /admin/posts/:id(.:format)          admin/posts#show\n                PUT    /admin/posts/:id(.:format)          admin/posts#update\n                DELETE /admin/posts/:id(.:format)          admin/posts#destroy\n                GET    /admin/posts(.:format)              admin/posts#index\n\n                POST   /admin/posts(.:format)              admin/posts#create\n                GET    /admin/posts/new(.:format)          admin/posts#new\n                GET    /admin/posts/:id/edit(.:format)     admin/posts#edit\n                GET    /admin/posts/:id(.:format)          admin/posts#show\n                PUT    /admin/posts/:id(.:format)          admin/posts#update\n                DELETE /admin/posts/:id(.:format)          admin/posts#destroy\n  admin_backend_index GET    /admin/backend(.:format)            admin/backend#index\n                POST   /admin/backend(.:format)            admin/backend#create\n  new_admin_backend GET    /admin/backend/new(.:format)        admin/backend#new\n\n  edit_admin_backend GET    /admin/backend/:id/edit(.:format)   admin/backend#edit\n  admin_backend GET    /admin/backend/:id(.:format)        admin/backend#show\n                PUT    /admin/backend/:id(.:format)        admin/backend#update\n                DELETE /admin/backend/:id(.:format)        admin/backend#destroy\n     lois_index GET    /lois/index(.:format)               lois#index\n      lois_show GET    /lois/show(.:format)                lois#show\n    edito_index GET    /edito/index(.:format)              edito#index\n  reponses_index GET    /reponses/index(.:format)           reponses#index\n  reponses_show GET    /reponses/show(.:format)            reponses#show\n  lettres_index GET    /lettres/index(.:format)            lettres#index\n   lettres_show GET    /lettres/show(.:format)             lettres#show\n       accueils POST   /accueils(.:format)                 accueils#create\n   new_accueils GET    /accueils/new(.:format)             accueils#new\n  edit_accueils GET    /accueils/edit(.:format)            accueils#edit\n                GET    /accueils(.:format)                 accueils#show\n                PUT    /accueils(.:format)                 accueils#update\n                DELETE /accueils(.:format)                 accueils#destroy\n           root        /                                   accueil#index\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","coffeescript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":41,"score":-2,"question_id":13088825,"title":"RAILS3 // JS executes; COFFEE does not","body":"<p>Pleased to get started with coffescript in some rails app.\nBut, after some projects, some difficulties.</p>\n\n<p>The code below translates well, but the coffee one does not do anything</p>\n\n<p>JS :</p>\n\n<pre><code>(function(){\n  var wf = document.createElement('script');\n  wf.src = \"/assets/libraries/webfonts.js\";\n  wf.type = 'text/javascript';\n  wf.async = 'true';\n  var s = document.getElementsByTagName('script')[0];\n  s.parentNode.insertBefore(wf, s);\n})();\nWebFontConfig = {\n  custom:{\n    families: ['tb', 'tr'],\n    urls: [ '/assets/1.fonts.css' ]\n  }\n}\n</code></pre>\n\n<p>COFFEE :</p>\n\n<pre><code>(-&gt;\n  wf = document.createElement(\"script\")\n  wf.src = \"/assets/libraries/webfonts.js\"\n  wf.type = \"text/javascript\"\n  wf.async = \"true\"\n  s = document.getElementsByTagName(\"script\")[0]\n  s.parentNode.insertBefore wf, s\n)()\nWebFontConfig = custom:\n  families: [\"tb\", \"tr\"]\n  urls: [\"/assets/1.fonts.css\"]\n</code></pre>\n\n<p>I could list other examples, but I'm fronting this \"js works / coffee does not\" problem very often</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13093497,"title":"Ruby on Rails - How do I generate random dates?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/4894198/how-to-generate-a-random-date-in-ruby\">How to generate a random date in Ruby?</a>  </p>\n</blockquote>\n\n\n\n<p>How do I generate a random date within a specific timeframe?</p>\n\n<p>Cheers.</p>\n"},{"tags":["html","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":41,"score":3,"question_id":13092800,"title":"Cycle through values in an Ruby Array on a HTML page","body":"<p>I am fetching some rows from the database in my controller with this query :</p>\n\n<pre><code>@main = connection.execute(\"select code_ver, result from mastertest;\")\n</code></pre>\n\n<p>Now in my html.erb, I am displaying the results in a table like this:</p>\n\n<pre><code>&lt;% @level1.each do |row1| %&gt;\n&lt;table id=\"tbl_main1\" name=\"tbl_main1\"&gt;\n    &lt;tr bgcolor=\"#D1D1D1\"&gt;\n        &lt;td width=\"60%\" &lt;%= row1[0] %&gt;&gt;&lt;/td&gt;\n        &lt;td width=\"20%\"&gt;&lt;%= row1[2] %&gt;&lt;/td&gt;\n        &lt;td width=\"20%\"&gt;&lt;%= row1[1] %&gt;&lt;/td&gt; \n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I am fetching a lot of rows here. But I want to show only say 15 results at once, and have some kind of buttons 'next' and 'previous' which would cycle through the results. How would I do that ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","autocomplete","getter-setter"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13079369,"title":"setter and getter result in nil value in FactoryGirl with Rails 3.2.8","body":"<p>In our invoice model, there are two columns - <code>customer_id</code> and <code>customer_name</code>. In order to use auto-complete (JQuery), a setter and getter for <code>customer_name</code> were added to invoice model:</p>\n\n<pre><code>  def customer_name\n    customer.try(:name)\n  end\n\n  def customer_name=(name)\n    self.customer = Customer.find_by_name(name) if name.present?\n  end \n</code></pre>\n\n<p>In invoice model, there is:</p>\n\n<pre><code>  belongs_to :customer\n</code></pre>\n\n<p>However after that, <code>customer_id</code> and <code>customer_name</code> are always <code>nil</code> by <code>FactoryGirl.build(:invoice)</code>. If the getter and setter were removed from the invoice model, then the FactoryGirl assigns the right value to <code>customer_id</code> and <code>customer_name</code>. Here is the FactoryGirl:</p>\n\n<pre><code> factory :invoice do \n.....\n    customer_id             2\n    customer_name           'a customer name'\n...\n\n  end\n</code></pre>\n\n<p>Why does the getter and setter of <code>customer_name</code> result in <code>nil</code> in FactoryGirl? </p>\n"},{"tags":["ruby-on-rails-3","activerecord","ancestry"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":22,"score":2,"question_id":13090848,"title":"Can I create an activerecord association through an activerecord relation (when using the ancestry gem)?","body":"<p>I am using the <a href=\"https://github.com/stefankroes/ancestry\" rel=\"nofollow\" title=\"ancestry gem\">ancestry gem</a> in my rails project to create a hierarchy of groups. A group can belong to a parent group and can have many children groups. Each group can have many users who belong to a group.  The model looks like this:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_ancestry\n\n  has_many :users\nend\n</code></pre>\n\n<p>I would love to be able to get all users for the descendants of a group, something like this:</p>\n\n<pre><code>class Group &lt; ActiveRecord::Base\n  has_ancestry\n\n  has_many :users\n  has_many :descendants_users, through: :descendants\nend\n</code></pre>\n\n<p>which, of course, doesn't work.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","date","timezone"],"answer_count":8,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":5033,"score":6,"question_id":6060436,"title":"Rails 3: How to get today's date in specific timezone?","body":"<p>To get today's date I do:</p>\n\n<pre><code>Date.today    # =&gt; Fri, 20 May 2011\n</code></pre>\n\n<p>I would like to get today's date in a specific timezone, say <code>'Melbourne'</code>.</p>\n\n<p>I have the following setting in my <code>application.rb</code>:</p>\n\n<pre><code>config.time_zone = 'Melbourne'\n</code></pre>\n\n<p>and I set:</p>\n\n<pre><code>Time.zone = 'Melbourne'\n</code></pre>\n\n<p>in my application controller before each action.</p>\n\n<p>However, it doesn't help (I guess because these settings affects only dates that are stored in the database).</p>\n\n<p>How could I get today's date in <code>'Melbourne'</code> ?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13082522,"title":"Writing a database migration that turns datetime null:false to true","body":"<p>I'm trying to write a database migration that changes the datetime fields in my join table from null to true but something isn't working correctly. Here's my code:</p>\n\n<pre><code>class ChangeDateColumnsInCirclesUsers &lt; ActiveRecord::Migration\n  def change\n    change_column :circles_users, :created_at, :datetime, :null =&gt; true\n    change_column :circles_users, :updated_at, :datetime, :null =&gt; true\n  end\nend\n</code></pre>\n\n<p>This isn't working. Any ideas on how to have those null values be set to true instead of false?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13092214,"title":"Rails errors.full_messages rendering square brackets","body":"<p>I'm looping through errors in a <code>user#update</code> using the following HAML:</p>\n\n<pre><code>- if @user.errors.any?\n  .alert.alert-error\n    %ul\n      = @user.errors.full_messages.each do |msg|\n        %li= msg\n</code></pre>\n\n<p>However, instead of just displaying the message, I also get square brackets:</p>\n\n<p><code>First name can't be blank [\"First name can't be blank\"]</code></p>\n\n<p>What am I doing wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If I do <code>p msg</code> then the console tail shows <em>only</em> the message, but within the <code>&lt;li&gt;</code> the brackets still render.</p>\n"},{"tags":["ruby-on-rails-3","redirect"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1651,"score":0,"question_id":6941971,"title":"AbstractController::DoubleRenderError in rails 3","body":"<p>I always get the following error:</p>\n\n<blockquote>\n  <p>AbstractController::DoubleRenderError (Render and/or redirect were\n  called multiple times in this action. Please note that you may only\n  call render OR redirect, and at most once per action. Also note that\n  neither redirect nor render terminate execution of the action, so if\n  you want to exit an action after redirecting, you need to do something\n  like \"redirect_to(...) and return\".):</p>\n</blockquote>\n\n<p>The error happens, when it id is nil the first, but not the second time...</p>\n\n<pre><code>def calc_next\n  id = next()\n  if id.nil?\n    id = next_next()\n    if id.nil?\n      render :layout =&gt; false, :format =&gt; :js\n    else\n      redirect_to :action =&gt; \"view\", :id =&gt; id, :format =&gt; :js\n    end\n  else\n    redirect_to :action =&gt; \"view\", :id =&gt; id, :format =&gt; :js\n  end\nend\n</code></pre>\n\n<p>I don't see the problem in this redirection, as the outer one is fine. Even with the debugger there are not two redirections at the same time...</p>\n\n<p>Any help is appreciated...\nMarkus</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13091416,"title":"Passing in options param for content_for method","body":"<p>I found that you can flush <code>content_for</code> looking at the Rails source. <a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/capture_helper.rb\" rel=\"nofollow\">https://github.com/rails/rails/blob/master/actionpack/lib/action_view/helpers/capture_helper.rb</a></p>\n\n<p><strong>Rails Source:</strong></p>\n\n<pre><code>def content_for(name, content = nil, options = {}, &amp;block)\n  if content || block_given?\n    if block_given?\n      options = content if content\n      content = capture(&amp;block)\n    end\n    if content\n      options[:flush] ? @view_flow.set(name, content) : @view_flow.append(name, content)\n    end\n    nil\n  else\n    @view_flow.get(name)\n  end\nend\n</code></pre>\n\n<p>I am trying to set <code>options[:flush] = true</code>, but am having some trouble. The <code>options[:flush]</code> is not evaluating to true in my code below.</p>\n\n<p><strong>My code</strong>:</p>\n\n<pre><code>content_for(affiliate_link_pos.to_sym, {:flush=&gt;true}) do\n  render page\nend\n</code></pre>\n\n<p><strong>Edit</strong>:\nI have also tried passing a 3rd params (content), but I get <code>wrong number of argument error (3 for 2)</code>.</p>\n\n<pre><code>content_for(affiliate_link_pos.to_sym, \"true\",  {:flush=&gt;true}) do\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","dynamic"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":276,"score":1,"question_id":10351787,"title":"Ruby: Include a dynamic module name","body":"<p>I have a situation in my Rails application where I need to include arbitrary modules depending on the current runtime state. The module provides custom application code that is only needed when certain conditions are true. Basically, I'm pulling the name of a company from the current context and using that as the filename for the module and its definition:</p>\n\n<pre><code>p =  self.user.company.subdomain + \".rb\"\nif File.exists?(Rails.root + \"lib/\" + p)\ninclude self.class.const_get(self.user.company.subdomain.capitalize.to_sym)\n    self.custom_add_url\nend\n</code></pre>\n\n<p>My test module looks like this:</p>\n\n<pre><code>module Companyx\n    def custom_add_url\n    puts \"Calling custom_add_url\"   \nend \nend\n</code></pre>\n\n<p>Now in the console, this actually works fine. I can pull a user and include the module like so:</p>\n\n<pre><code>[1] pry(main)&gt; c = Card.find_by_personal_url(\"username\")\n[2] pry(main)&gt; include c.class.const_get(c.user.company.subdomain.capitalize)=&gt; Object\n[3] pry(main)&gt; c.custom_add_url\n</code></pre>\n\n<p>Calling custom_add_url</p>\n\n<p>If I try to run the include line from my model, I get</p>\n\n<pre><code>NoMethodError: undefined method `include' for #&lt;Card:0x007f91f9094fb0&gt;\n</code></pre>\n\n<p>Can anyone suggest why the include statement would work on the console, but not in my model code? </p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ajax","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13078745,"title":"Rails 3 update two models using ajax","body":"<p>I've been stuck on this for about 2 weeks.  I need help in the proper way to do this.  I have two models.  Model one is Leads.  Model two is Referrals.</p>\n\n<p>Leads belongs_to referrals</p>\n\n<p>Referrals has_many Leads</p>\n\n<p>In the Lead entry screen there is a partial that displays possible Referrals for the lead to select from.  There is an Add Referral link in the partial that brings up a modal using twitter bootstrap as the css framework.  From that I am rendering the New action of the Referral controller.</p>\n\n<p>This all works up to this point.  What I want to have happen is that I can then enter a new referral, it is saved, the modal closes, and the list of referrals in the partial of the Leads edit/new view is then updated to reflect the new referral that has been added.  But at this point I now have nested form_for's.  As well as a Referral form that is working off a different controller.</p>\n\n<p>I am not sure how I should approach this.  I have been searching and trying various methods for a couple of weeks now.  Do I repeat myself and completely rebuild the Referral view and controller under the Leads controller and view?  Repetitive code like that is why I switched to rails, and why I feel I'm not looking at this correctly.  There has to be a simple way around this.  I have looked at using Gems like Draper and Cell, and I've read up on using presenters.  But those seem to all be solutions for a dashboard type of view, not what I am trying to accomplish.</p>\n\n<p>Any help or direction would be much appreciated.</p>\n\n<p>Thank you...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":90,"score":0,"question_id":13079845,"title":"Rails Login with Twitter Bootstrap Navbar (w/ Devise)?","body":"<p>I am trying to use Twitter's Bootstrap (http://twitter.github.com/bootstrap/index.html) with Ruby on Rails (v 3.2.8 with Ruby 1.9.3).  I am using Devise for authentication.</p>\n\n<p>Twitter has a nice sign-in form in their navbar. (see <a href=\"http://twitter.github.com/bootstrap/examples/hero.html\" rel=\"nofollow\">http://twitter.github.com/bootstrap/examples/hero.html</a>?)</p>\n\n<p>How would I set up my Rails application to use that login?  I can set Rails up to login from its own login page, but how do I use the Navbar login?  What would be the controller/model structure?</p>\n\n<p>I found this on github, but it does not implement the navbar signup (https://github.com/RailsApps/rails3-bootstrap-devise-cancan/).</p>\n\n<p>Thanks</p>\n\n<p>UPDATE:</p>\n\n<p>Found the answer :  <a href=\"https://github.com/plataformatec/devise/wiki/How-To:-Display-a-custom-sign_in-form-anywhere-in-your-app\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/How-To:-Display-a-custom-sign_in-form-anywhere-in-your-app</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","google-maps","google","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13091518,"title":"Rails + Google-Maps-for-Rails - reload map and centering the marker","body":"<p>I started to use gem 'gmaps4rails' to show google map in my application.</p>\n\n<p>In my view i use this (note: i use haml):</p>\n\n<p><strong>index.html.haml</strong></p>\n\n<pre><code>  %div.span12.pagination-centered\n    = gmaps(\"map_options\" =&gt; { \"detect_location\" =&gt; true, \"center_on_user\" =&gt; true, \"auto_zoom\" =&gt; false, \"zoom\" =&gt; 16},\"markers\" =&gt; { \"data\" =&gt; @json })\n</code></pre>\n\n<p>I would like to add simple link on the page which would reload the map and centering the marker like gmaps4rails does. But i can't get how to do that. I would appreciate any help! </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":402,"score":2,"question_id":13081868,"title":"Could not find capistrano-2.13.3 in any of the sources","body":"<p>I setup ruby on rails environment using <a href=\"http://jaysonrowe.blogspot.com/2012/04/installing-ruby-and-rails-on-fedora.html\" rel=\"nofollow\">http://jaysonrowe.blogspot.com/2012/04/installing-ruby-and-rails-on-fedora.html</a>. I installed mysql 5.5. Now when I clone a project from bitbucket and run bundle install, I get following error:</p>\n\n<pre><code>[xyz@xyz ruby_repo]$ bundle install\nFetching gem metadata from http://rubygems.org/......\nFetching gem metadata from http://rubygems.org/..\nCould not find capistrano-2.13.3 in any of the sources\n</code></pre>\n\n<p>When I execute rails -v in ruby_repo directory, I get following error:</p>\n\n<pre><code>[xyz@xyz ruby_repo]$  rails -v\nCould not find abstract-1.0.0 in any of the sources\nRun `bundle install` to install missing gems.\n</code></pre>\n\n<p>Below is my Gemfile:</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.10'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\ngem 'rmagick'\ngem \"will_paginate\", \"~&gt; 3.0.pre2\"\ngem 'mysql2','0.2.7'\ngem \"nokogiri\"\ngem 'activemerchant', :require =&gt; 'active_merchant'\ngem \"webrobots\", \"~&gt; 0.0.10\"\ngem 'mixpanel'\ngem 'thinking-sphinx', '2.0.10'\ngem 'whenever', :require =&gt; false\ngem 'json'\ngem 'vimeo'\ngem \"koala\"\ngem 'typhoeus'\ngem 'delayed_job_active_record'\ngem \"delayed_job\"\ngem 'mini_fb'\ngem 'daemons'\ngem 'annotate'\ngem 'capistrano'\ngem 'rvm-capistrano'\ngem 'grosser-ssl_requirement', :require =&gt; 'ssl_requirement'\ngem 'acts-as-taggable-on'\ngem 'capistrano'\ngem 'rvm-capistrano'\n# Use unicorn as the web server\n# gem 'unicorn'\n\n# Deploy with Capistrano\n#gem 'capistrano'\n#gem 'capistrano-ext'\n#To use debugger (ruby-debug for Ruby 1.8.7+, ruby-debug19 for Ruby 1.9.2+)\n# gem 'ruby-debug'\n\n\n# Bundle the extra gems:\n# gem 'bj'\n# gem 'nokogiri'\n# gem 'sqlite3-ruby', :require =&gt; 'sqlite3'\n# gem 'aws-s3', :require =&gt; 'aws/s3'\n\n# Bundle gems for the local environment. Make sure to\n# put test-only gems in this group so their generators\n# and rake tasks are available in development mode:\n# group :development, :test do\n#   gem 'webrat'\n# end\n</code></pre>\n\n<p>When I execute gem list, I get following output</p>\n\n<pre><code>*** LOCAL GEMS ***\n\nactionmailer (3.2.8)\nactionpack (3.2.8)\nactivemodel (3.2.8)\nactiverecord (3.2.8)\nactiveresource (3.2.8)\nactivesupport (3.2.8)\narel (3.0.2)\nbuilder (3.0.4)\nbundler (1.2.1)\ncapistrano (2.13.4)\ncoffee-rails (3.2.2)\ncoffee-script (2.2.0)\ncoffee-script-source (1.4.0)\nerubis (2.7.0)\nexecjs (1.4.0)\nhighline (1.6.15)\nhike (1.2.1)\ni18n (0.6.1)\njourney (1.0.4)\njquery-rails (2.1.3)\njson (1.7.5)\nmail (2.4.4)\nmime-types (1.19)\nmulti_json (1.3.6)\nmysql2 (0.3.11)\nnet-scp (1.0.4)\nnet-sftp (2.0.5)\nnet-ssh (2.6.1)\nnet-ssh-gateway (1.1.0)\npolyglot (0.3.3)\nrack (1.4.1)\nrack-cache (1.2)\nrack-ssl (1.3.2)\nrack-test (0.6.2)\nrails (3.2.8)\nrailties (3.2.8)\nrake (0.9.2.2)\nrdoc (3.12)\nrubygems-bundler (1.1.0)\nrvm (1.11.3.5)\nsass (3.2.1)\nsass-rails (3.2.5)\nsprockets (2.1.3)\nsqlite3 (1.3.6)\nthor (0.16.0)\ntilt (1.3.3)\ntreetop (1.4.11)\ntzinfo (0.3.33)\nuglifier (1.3.0)\n</code></pre>\n\n<p>However when I create a completely new project, I don't face any such issue. Can anyone please tel me what might be the issue?</p>\n"},{"tags":["ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13090425,"title":"Why does Rails demo app give \"uninitialized constant ExecJS::RubyRacerRuntime::Context::V8\"?","body":"<p>Being new to Rails, I'm trying to get a basic \"hello world\" app up and running. Specifically the app in chapter 2 of <a href=\"http://pragprog.com/book/rails4/agile-web-development-with-rails\" rel=\"nofollow\">Agile Web Development with Rails</a>. Loading up the hello world page results in the error given in the title.</p>\n\n<hr>\n\n<p>So far I've done the following:</p>\n\n<pre><code>rails new demo\ncd demo\n</code></pre>\n\n<p>Added <code>gem 'therubyracer'</code> to the <code>Gemfile</code> after <code>ExecJS</code> complained about no JavaScript runtime being available.</p>\n\n<pre><code>bundle install\nrake about         # (see below)\nrails generate controller Say hello goodbye\nrails server\n</code></pre>\n\n<p>At this point WEBrick fires up and I load up <code>http://localhost:3000/say/hello</code>. WEBrick logs the following error (which also appears in the browser):</p>\n\n<pre><code>Started GET \"/say/hello\" for 127.0.0.1 at 2012-10-26 11:45:10 -0400\nConnecting to database specified by database.yml\nProcessing by SayController#hello as HTML\n  Rendered say/hello.html.erb within layouts/application (80.9ms)\nCompleted 500 Internal Server Error in 167ms\n\nActionView::Template::Error (uninitialized constant ExecJS::RubyRacerRuntime::Context::V8\n  (in /home/error/work/demo/app/assets/javascripts/say.js.coffee)):\n    3: &lt;head&gt;\n    4:   &lt;title&gt;Demo&lt;/title&gt;\n    5:   &lt;%= stylesheet_link_tag    \"application\", :media =&gt; \"all\" %&gt;\n    6:   &lt;%= javascript_include_tag \"application\" %&gt;\n    7:   &lt;%= csrf_meta_tags %&gt;\n    8: &lt;/head&gt;\n    9: &lt;body&gt;\n  app/views/layouts/application.html.erb:6:in `_app_views_layouts_application_html_erb___1746644185114933585_70069037653480'\n\n\n  Rendered /home/error/.gem/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (3.7ms)\n  Rendered /home/error/.gem/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (2.2ms)\n  Rendered /home/error/.gem/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/template_error.erb within rescues/layout (18.7ms)\n[2012-10-26 11:45:12] WARN  Could not determine content-length of response body. Set content-length of the response or set Response#chunked = true\n</code></pre>\n\n<p><code>rake about</code> returns:</p>\n\n<pre><code>About your application's environment\nRuby version              1.9.3 (x86_64-linux)\nRubyGems version          1.8.24\nRack version              1.4\nRails version             3.2.8\nJavaScript Runtime        therubyracer (V8)\nActive Record version     3.2.8\nAction Pack version       3.2.8\nActive Resource version   3.2.8\nAction Mailer version     3.2.8\nActive Support version    3.2.8\nMiddleware                ActionDispatch::Static, Rack::Lock, #&lt;ActiveSupport::Cache::Strategy::LocalCache::Middleware:0x0000000276b298&gt;, Rack::Runtime, Rack::MethodOverride, ActionDispatch::RequestId, Rails::Rack::Logger, ActionDispatch::ShowExceptions, ActionDispatch::DebugExceptions, ActionDispatch::RemoteIp, ActionDispatch::Reloader, ActionDispatch::Callbacks, ActiveRecord::ConnectionAdapters::ConnectionManagement, ActiveRecord::QueryCache, ActionDispatch::Cookies, ActionDispatch::Session::CookieStore, ActionDispatch::Flash, ActionDispatch::ParamsParser, ActionDispatch::Head, Rack::ConditionalGet, Rack::ETag, ActionDispatch::BestStandardsSupport\nApplication root          /home/error/work/demo\nEnvironment               development\nDatabase adapter          sqlite3\nDatabase schema version   0\n</code></pre>\n\n<hr>\n\n<p>The workstation is running Fedora 17 x86_64. Despite that, I've pretty much ignored the ruby gems in the yum repositories (I think) and used <code>gem install</code> in my home directory to get everything I need. (Again, I think.)</p>\n\n<p>Being new to Ruby and Rails, I'm pretty sure I've missed some obvious convention that I'm not yet aware of. I'm also not quite sure what additional information I might need to provide, so please let me know that as well.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13087848,"title":"rails: collection_select for current_user","body":"<p>I have a Box which has many Items which belongs to a Category.\nWhen the Box is created it has the user_id.\nItems has a category_id.</p>\n\n<p>I've seen that if you have a user_id in the table concerned it works okay:</p>\n\n<pre><code>&lt;%= f.collection_select :category_id, Category.where(:user_id =&gt; current_user.id), :id , :name %&gt;\n</code></pre>\n\n<p>But how can I get a Category collection_select from what the current_user has entered - do I have to add a user_id to Categories or can I join my tables somehow?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","debugging","thin","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13090124,"title":"how to debug web server on RoR?","body":"<p>I currently have a problem with a project.</p>\n\n<p>it freezes before it shows the \"Started GET ....\" seems like it hits an infinite loop.</p>\n\n<p>now i dont really have much experience with debuggers in ROR, can anyone recommend anything i can use to trace the exact origin of the problem. if i can get an error code somewhere then i might be able to fix it.</p>\n\n<p>currently i am using webrick, i tried thin and it gave the exact same error.but i am willing to use anything to find the exact origin of this error.</p>\n\n<p>it seems to be related to the project because all other projects works fine on my environment.</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":5,"score":0,"question_id":13089877,"title":"Self referential many to many where inverse is unimportant (can be one directional)","body":"<p>If I make a template a sub-template, it can't be a sub-template of any other templates.  I don't think I can do has_and_belongs_to_many as a self reference, so what are my other options?  I don't care about it being bi-directional.</p>\n\n<pre><code>has_many :sub_templates,\n  :class_name =&gt; 'Template',\n  :inverse_of =&gt; :subbed_template,\n  :foreign_key =&gt; \"template_association\"\nbelongs_to :subbed_template,\n  :class_name =&gt; 'Template',\n  :inverse_of =&gt; nil\n</code></pre>\n"},{"tags":["ruby-on-rails-3","soap","savon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12746695,"title":"GET WSDL file using Savon SOAP GEM","body":"<p>I am trying to establish a connection using the ruby gems Savon and execute SOAP requests and responses. The thing is that I am getting the file each time by doing this:</p>\n\n<pre><code>client = Savon.client(\"http://www.webservicex.net/uszip.asmx?WSDL\")\n</code></pre>\n\n<p>Now in the documentation of Savon it says this:</p>\n\n<p>\"You can instantiate a client with or without a (local or remote) WSDL document. Using a WSDL is a little easier because Savon can parse the document for the target namespace, endpoint, available SOAP actions etc. But the (remote) WSDL has to be downloaded and parsed once for every client which comes with a performance penalty.\"</p>\n\n<p>So my question is, can I get the WSDL file by just using the Savon Library? Or do I need to ask for it from the third party application?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":12,"score":0,"question_id":13077512,"title":"Rails merge tags","body":"<p>I need to insert a merge-tag in a text. For example I have the merge tag |NAME|, so, I would like to replace |NAME| in any part of a paragraph. For example if |NAME| = Carlos</p>\n\n<p>Lorep ipsum |NAME| dorel pored = Lorep ipsum Carlos dorel pored</p>\n\n<p>or</p>\n\n<p>|NAME| Lorep ipsum dorel pored = Carlos Lorep ipsum  dorel pored</p>\n\n<p>How can I do that with rails?\nAre there some plugin in rails for that?\nThanks in advance</p>\n\n<hr>\n\n<h2>UPDATE</h2>\n\n<p>Sorry, I think I explained bad. This not have to be hard coded. The user has a textbox where he can decide where to put the merge-tag to appear in any place of the text entered.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cron","rake"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":739,"score":2,"question_id":5518499,"title":"Rails3, Running rake task from cron","body":"<p>I'm having problems running my rake task from cron, I wrap it in shell file and when I execute this shell file from console it works fine.</p>\n\n<pre><code>#!/bin/sh\n\nif ps -ef | grep -v grep | grep create_all_accounts ; then\n    exit 0\nelse\n    cd /home/prosoftstudio/www/prosoftstudio_egabinet &amp;&amp; /home/prosoftstudio/www/.ruby/gems/1.8/bin/rake gabinet:create_all_accounts RAILS_ENV=production --trace\n    exit 0\nfi\n</code></pre>\n\n<p>Entry in crontab looks like this(I set PATH and GEM_PATH)</p>\n\n<pre><code>PATH=/home/prosoftstudio/www/.python/bin:/usr/local/python2.6/bin:/home/prosoftstudio/www/.ruby/gems/1.8/bin/:/usr/local/ruby1.8/bin:/usr/local/bin:/usr/bin:/bin:/us$\nGEM_PATH=/home/prosoftstudio/www/.ruby/gems/1.8:/home/prosoftstudio/www/.ruby/gems/1.8/bundler/gems:/usr/lib/ruby/gems/1.8/\n*/1 * * * * /home/prosoftstudio/www/cron_create_accounts.sh &gt; cron_log.txt 2&gt;&amp;1\n</code></pre>\n\n<p>The output I get is</p>\n\n<pre><code>rake aborted!\ngit://github.com/100hz/rails-settings.git (at master) is not checked out. Please run `bundle install`\n</code></pre>\n\n<p>It seems like it can't find gems installed with</p>\n\n<pre><code>gem \"rails-settings\", :git =&gt; \"git://github.com/100hz/rails-settings.git\"\n</code></pre>\n\n<p>Anyone know how to fix this?</p>\n"},{"tags":["ruby-on-rails-3","json","http","post"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":13086262,"title":"Parse JSON HTTP post in Rails 3 app?","body":"<p>I have a simple Rails 3 example application that I'm trying to work out how to parse a JSON POST and insert the data into my applications database.</p>\n\n<p>I have a basic Activities controller and model, the controller is as follows:</p>\n\n<pre><code>class ActivitiesController &lt; ApplicationController\n  # GET /activities\n  # GET /activities.json\n  def index\n    @activities = Activity.order('created_at DESC').limit(10)\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @activities }\n    end\n  end\n\n  # GET /activities/1\n  # GET /activities/1.json\n  def show\n    @activity = Activity.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @activity }\n    end\n  end\n\n  # GET /activities/new\n  # GET /activities/new.json\n  def new\n    @activity = Activity.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @activity }\n    end\n  end\n\n  # GET /activities/1/edit\n  def edit\n    @activity = Activity.find(params[:id])\n  end\n\n  # POST /activities\n  # POST /activities.json\n  def create\n    @activity = Activity.new(params[:activity])\n\n    respond_to do |format|\n      if @activity.save\n        format.html { redirect_to @activity, notice: 'Activity was successfully created.' }\n        format.json { render json: @activity, status: :created, location: @activity }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @activity.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PUT /activities/1\n  # PUT /activities/1.json\n  def update\n    @activity = Activity.find(params[:id])\n\n    respond_to do |format|\n      if @activity.update_attributes(params[:activity])\n        format.html { redirect_to @activity, notice: 'Activity was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @activity.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /activities/1\n  # DELETE /activities/1.json\n  def destroy\n    @activity = Activity.find(params[:id])\n    @activity.destroy\n\n    respond_to do |format|\n      format.html { redirect_to activities_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>I have also got an example JSON payload from the application I'm trying to receive the POST from:</p>\n\n<pre><code>payload {\"files\":{\"changed\":[],\"removed\":[\".gitmodules\",\"extensions\",\"extensions/markdown\"]},\"project\":{\"permalink\":\"dans-stuff-2\",\"public_key\":\"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCuB80S+kMN1266LvCEXoU5hmjugcuXko61Hl7uD9VVgMgEOrLSkeYktOPshgCOwjQgGhSMVEHWrSuOddOi+V3rOu3v91jiU3vycRM3nK9GMaOFf+tTn0/4ReUvGOFHeir1vluHCmOAmpqsVhGWkCJY6eJE37muvGdTG4nW/VnpWYCTLfSOeaq5MVx5LU+zYLntvB5PXd7h1k5ROO8lW+5QzGVyHHEvilzJOqESIAWpNtcXGBt7clWpFH4lg2AT7JebYFuHl8Sl4LYzIRegcpg718CWJjrck9/xV6CBTGP520ifU6K0x4JOn/qFzVlqwnxmrPXwawptmCiYiJt3X8Oz DeployHQ.com Key for dans-stuff-2\",\"name\":\"Dans Stuff\",\"repository\":{\"port\":null,\"username\":null,\"branch\":\"master\",\"url\":\"git@codebasehq.com:atech/deploytest/test1.git\",\"scm_type\":\"git\",\"cached\":true,\"hosting_service\":{\"name\":\"Codebase\",\"url\":\"http://www.codebasehq.com\",\"commits_url\":\"http://atech.codebasehq.com/projects/deploytest/repositories/test1/commits/master\",\"tree_url\":\"http://atech.codebasehq.com/projects/deploytest/repositories/test1/tree/master\"}}},\"server\":{\"name\":\"cybele\",\"server_path\":\"/home/dan/deploytest\",\"port\":22,\"username\":\"dan\",\"use_ssh_keys\":true,\"last_revision\":\"2ad223b9dd6d006d69909407ac7df322e35b009b\",\"hostname\":\"cybele.phoenixdev.co.uk\",\"identifier\":\"de99437e-da4a-0986-a7ab-e55805261a96\",\"protocol_type\":\"ssh\"},\"start_revision\":{\"timestamp\":\"2011-11-30T13:48:22+00:00\",\"author\":\"Dan Wentworth\",\"ref\":\"a1c1073b85d1662c075d77f5d88be3fd291abd12\",\"message\":\"nested markdown pathg\",\"email\":\"dan@atechmedia.com\"},\"identifier\":\"9d0f9c21-f242-3966-fcd3-e821a65acd45\",\"end_revision\":{\"timestamp\":\"2011-08-30T16:41:32+01:00\",\"author\":\"Dan Wentworth\",\"ref\":\"2ad223b9dd6d006d69909407ac7df322e35b009b\",\"message\":\"arses\",\"email\":\"dan@atechmedia.com\"},\"configuration\":{\"email_notify\":true,\"notification_addresses\":\"dan@atechmedia.com\",\"copy_config_files\":true},\"timestamps\":{\"completed_at\":\"2012-01-17T09:22:15Z\",\"duration\":null,\"queued_at\":\"2012-01-17T09:22:07Z\",\"started_at\":\"2012-01-17T09:22:10Z\"},\"status\":\"completed\"} -------------------------------------------------------------------------------- signature TMjVYhk/+lQigy3hdkgTZjAaaroxAi126XaDzrQ1xWGyMji9oR0F5nfE73Mo kNs7Hk7aY1GQgtDRdBjgPE+C/6etF9nPFXPacWobaxSP35TGOrpoSACNQDAQ Q0wvn0Bm/jMvhBKoQ6YYUSx8KP8nd7VkgQmv4S0cakgixA4LHfg=\n</code></pre>\n\n<p>Because the POST will need to be made to a URL, I would imagine I need to define a new method:</p>\n\n<pre><code>def deploy_receive\n   data = JSON.parse(request.body)\nend\n</code></pre>\n\n<p>What I am unsure of, is where to go from here. How would I cherry pick the attributes from the JSON and put them into various attributes in the Activities table?</p>\n\n<p>Something like this?</p>\n\n<pre><code>def deploy_receive\n   data = JSON.parse(request.body)\n   @activity = Activity.new(params[:fault])\n   @activity.who = data.author    \nend\n</code></pre>\n\n<p>Any pointers would be appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","path","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13077339,"title":"Weird issue with my rails path and its routing","body":"<p>I'm getting a strange error with my routing. I've installed the blogit gem but I don't think this is causing this problem.</p>\n\n<pre><code>undefined local variable or method `locations_path'\n</code></pre>\n\n<p>Here is my routes file:</p>\n\n<pre><code>AppName::Application.routes.draw do\n\n\ndevise_for :users\n\nroot :to =&gt; 'locations#index'\n\n\nmount Blogit::Engine =&gt; \"/blog\", :as =&gt; \"blog\" \n\n\n\nresources :locations do\n  collection do\n  get 'location'\n end\nend\n</code></pre>\n\n<p>and here's my rake routes:</p>\n\n<pre><code>       new_user_session GET    /users/sign_in(.:format)       devise/sessions#new\n        user_session POST   /users/sign_in(.:format)       devise/sessions#create\ndestroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy\n       user_password POST   /users/password(.:format)      devise/passwords#create\n   new_user_password GET    /users/password/new(.:format)  devise/passwords#new\n   edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit\n                     PUT    /users/password(.:format)      devise/passwords#update\n cancel_user_registration GET    /users/cancel(.:format)            devise/registrations#cancel\n\n    user_registration POST   /users(.:format)               devise/registrations#create\nnew_user_registration GET    /users/sign_up(.:format)       devise/registrations#new\nedit_user_registration GET    /users/edit(.:format)          devise/registrations#edit\n                     PUT    /users(.:format)               devise/registrations#update\n                     DELETE /users(.:format)               devise/registrations#destroy\n\n\n                root        /                              locations#index\n                blog        /blog                          Blogit::Engine\n  location_locations GET    /locations/location(.:format)  locations#location\n           locations GET    /locations(.:format)           locations#index\n                     POST   /locations(.:format)           locations#create\n        new_location GET    /locations/new(.:format)       locations#new\n       edit_location GET    /locations/:id/edit(.:format)  locations#edit\n            location GET    /locations/:id(.:format)       locations#show\n                     PUT    /locations/:id(.:format)       locations#update\n                     DELETE /locations/:id(.:format)       locations#destroy\n\nRoutes for Blogit::Engine:\n                     /posts/page/:page(.:format)            blogit/posts#index\n   tagged_blog_posts        /posts/tagged/:tag(.:format)           blogit/posts#tagged\n   post_comments POST   /posts/:post_id/comments(.:format)     blogit/comments#create\n   post_comment DELETE /posts/:post_id/comments/:id(.:format) blogit/comments#destroy\n   posts GET    /posts(.:format)                       blogit/posts#index\n        POST   /posts(.:format)                       blogit/posts#create\n   new_post GET    /posts/new(.:format)                   blogit/posts#new\n   edit_post GET    /posts/:id/edit(.:format)              blogit/posts#edit\n   post GET    /posts/:id(.:format)                   blogit/posts#show\n         PUT    /posts/:id(.:format)                   blogit/posts#update\n              DELETE /posts/:id(.:format)                   blogit/posts#destroy\n   root        /                                      blogit/posts#index\n</code></pre>\n\n<p>Any suggestions as to why this may be happening would be great. </p>\n\n<p>Thanks, </p>\n\n<p>James</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":16,"score":-1,"question_id":13088357,"title":"how to pass the parameter with spaces and access the same value in another page in rails?","body":"<p>I want to pass a value through url to access the same value in the next page. When i pass the value i can see in my url </p>\n\n<blockquote>\n  <p>value=example+value</p>\n</blockquote>\n\n<p>but when i use the following in views it then sends only the first part of the value after it pass to the next page.</p>\n\n<pre><code> &lt;%= link_to edit, edit_post_path(post, :value =&gt; params[:value]) %&gt;\n</code></pre>\n\n<p>when the edit button is clicked it performs the action and when it goes to the next page i see only <code>value=example</code> in the url. what should i do?</p>\n"},{"tags":["ruby-on-rails-3","apache","passenger","carrierwave"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":12049939,"title":"Apache upload progress module with carrierwave","body":"<p>I install Passenger and setup <a href=\"https://github.com/drogus/apache-upload-progress-module\" rel=\"nofollow\">apache upload module</a>. There is my config file.</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code># httpd-vhosts.conf    \n\nNameVirtualHost *:80\n\n&lt;VirtualHost *:80&gt;\n  ServerName localhost\n  DocumentRoot \"/Users/Earth/projects/test/virudson/upload_progress/public\"\n\n  RailsEnv production\n  RailsAllowModRewrite off\n\n  &lt;Directory \"/Users/Earth/projects/test/virudson/upload_progress/public\"&gt;\n    Order allow,deny\n    Allow from all\n  &lt;/Directory&gt;\n\n  # needed for tracking upload progess\n  &lt;Location /&gt;\n    # enable tracking uploads in /\n    TrackUploads On\n  &lt;/Location&gt;\n\n  &lt;Location /progress&gt;\n    # enable upload progress reports in /progress\n    ReportUploads On\n    PassengerEnabled off\n  &lt;/Location&gt;\n\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>After that I create simple rails application for test upload progress is working.</p>\n\n<p>There is my views code.</p>\n\n<pre><code># /app/views/photos/new.html.erb\n\n# @uuid generated at controller level. I'm pretty sure it is unique.\n&lt;%= form_for :photo, :url =&gt; \"/photos?X-Progress-ID=#{@uuid}\", :html =&gt; {:multipart =&gt; true} do |form| %&gt;\n    &lt;%= form.label :photo %&gt;\n    &lt;%= form.file_field :file_name %&gt;\n\n    &lt;%= form.submit 'upload image', :class =&gt; 'submit' %&gt;\n&lt;% end %&gt;\n\n# There is link that I provide for testing apache upload progress module while photo uploading.\n&lt;a href=\"&lt;%= \"/progress/?X-Progress-ID=#{@uuid}\" %&gt;\"&gt;Testing the upload URL&lt;/a&gt;\n</code></pre>\n\n<p>There is a problem while uploading the link always return state 'starting' until upload end.</p>\n\n<pre><code>{ \"state\" : \"starting\", \"uuid\" : \"1e9dae300f42569b4db8\" }\n</code></pre>\n\n<p>Maybe I do some thing wrong. Please leave any suggestion.</p>\n"},{"tags":["xml","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13085906,"title":"How to specify layout in to_xml in rails 3.2.x?","body":"<p>Is there any way to specify the layout option as in the respond_to method?</p>\n\n<p>or is there any way to capture the output of respond_to methods output to file?</p>\n\n<p>Thanks in advance !!</p>\n\n<p><em>UPDATE:</em></p>\n\n<p>Using following function to save the xml to file.</p>\n\n<pre><code>def generate_xml\n xml_data = self.to_xml \n file = File.new(\"public/assets/xmls/#{self.id}.xml\", \"w\")\n file.write(xml_data)\n file.close\nend\n</code></pre>\n\n<p>but it only generate the default element, not as specified in show.xml file, which I can get from browser hit.</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13029953,"title":"how to implement permissions dynamically?","body":"<p>I am following this tutorial : <a href=\"http://eveloverails.wordpress.com/2011/04/02/183/\" rel=\"nofollow\">How to implement the dynamic authorization with CanCan ?</a></p>\n\n<p>I am making an application which has 5 models </p>\n\n<ol>\n<li>Articles,</li>\n<li>Users,</li>\n<li>Users_type,</li>\n<li>Permissions, and </li>\n<li>user_type_permission </li>\n</ol>\n\n<p>The schema is as follows:</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121020104503) do\n\n  create_table \"articles\", :force =&gt; true do |t|\n    t.string   \"name\"\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"permissions\", :force =&gt; true do |t|\n    t.string   \"object_type\"\n    t.string   \"action_name\"\n    t.string   \"description\"\n    t.datetime \"created_at\",  :null =&gt; false\n    t.datetime \"updated_at\",  :null =&gt; false\n  end\n\n  create_table \"user_type_permissions\", :force =&gt; true do |t|\n    t.integer  \"user_type_id\"\n    t.integer  \"permission_id\"\n    t.datetime \"created_at\",    :null =&gt; false\n    t.datetime \"updated_at\",    :null =&gt; false\n  end\n\n  create_table \"user_types\", :force =&gt; true do |t|\n    t.datetime \"created_at\", :null =&gt; false\n    t.datetime \"updated_at\", :null =&gt; false\n  end\n\n  create_table \"users\", :force =&gt; true do |t|\n    t.string   \"email\",                  :default =&gt; \"\", :null =&gt; false\n    t.string   \"encrypted_password\",     :default =&gt; \"\", :null =&gt; false\n    t.string   \"reset_password_token\"\n    t.datetime \"reset_password_sent_at\"\n    t.datetime \"remember_created_at\"\n    t.integer  \"sign_in_count\",          :default =&gt; 0\n    t.datetime \"current_sign_in_at\"\n    t.datetime \"last_sign_in_at\"\n    t.string   \"current_sign_in_ip\"\n    t.string   \"last_sign_in_ip\"\n    t.datetime \"created_at\",                             :null =&gt; false\n    t.datetime \"updated_at\",                             :null =&gt; false\n    t.string   \"role\"\n  end\n\n  add_index \"users\", [\"email\"], :name =&gt; \"index_users_on_email\", :unique =&gt; true\n  add_index \"users\", [\"reset_password_token\"], :name =&gt;     \"index_users_on_reset_password_token\", :unique =&gt; true\n\nend\n</code></pre>\n\n<p>And the associations is as follows:</p>\n\n<pre><code>PERMISSION MODEL\n\nclass Permissions &lt; ActiveRecord::Base\n  attr_accessible :action_name, :description, :id, :object_type\n  has_many :user_type, :through =&gt; :user_typre_permissions\n  validates_presence_of \"object_type\", :action_name\n  validates_uniqueness_of \"object_type\", :scope =&gt; [:action_name]\nend\n</code></pre>\n\n<p>User model is as follows:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n\n  ROLES = %w[admin other]\n\n  belongs_to :user_type\n  devise :database_authenticatable, :registerable,\n         :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me, :role\n  # attr_accessible :title, :body\n\n  def role?(role)\n    return !!self.role.to_s.camelize\n  end\nend\n</code></pre>\n\n<p>user_type_permission model is as follows:</p>\n\n<pre><code>class UserTypePermissions &lt; ActiveRecord::Base\n  attr_accessible :id, :permission_id, :user_type_id\nend\n</code></pre>\n\n<p>user_types model is as follows</p>\n\n<pre><code>class UserTypes &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  has_many :users\n  has_many :permissions, :through =&gt; :user_type_permissions \nend\n</code></pre>\n\n<p>article model is as follows:</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  attr_accessible :name\nend\n</code></pre>\n\n<p>Ability class is as follows: </p>\n\n<pre><code>class Ability\n  include CanCan::Ability\n\n  def initialize(user)\n    user ||= User.new # guest user\n\n    if user.role? :admin\n      can :manage, Article\n      can :manage, User\n    else\n      user.user_type.permissions.each do |permission|\n        can permission.action_name.to_sym, permission.object_type.constantize\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>Permissions Controller is as follows:</p>\n\n<pre><code>class PermissionsController &lt; ApplicationController\n  def index\n    @permission=Permissions.all\n  end\n\n  def edit\n    @permission = Permissions.find(params[:id])\n  end\n\n  def update\n    @permission = Permissions.find(params[:id])\n    respond_to do |format|\n      if @permission.update_attributes(params[:article])\n        format.html { redirect_to @permission, notice: 'Permission was successfully updated.' }\n        format.json { head :no_content }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @permission.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def show\n    @permission = Permissions.find(params[:id])\n  end\n\n  def destroy\n    @permission = Permissions.find(params[:id])\n    @permission.destroy\n\n    respond_to do |format|\n      format.html { redirect_to permissions_url }\n      format.json { head :no_content }\n    end\n  end\nend\n</code></pre>\n\n<p>its working is like when the user login as as admin it will have the links of list of users and the list of articles when it click on the list of users link he will have the list of registered users with four link edit,show destroy and settings.Now what i want is when the admin click on the settings link of the particular user it will have the permissions of that user and also admin can edit the permissions through check box</p>\n\n<p>here is the view of the permission </p>\n\n<pre><code>&lt;h1&gt;Listing Permisions&lt;/h1&gt;\n\n&lt;table&gt;\n  &lt;tr&gt;\n    &lt;th&gt;Id&lt;/th&gt;\n    &lt;th&gt;Object_type&lt;/th&gt;\n    &lt;th&gt;Action_name&lt;/th&gt;\n    &lt;th&gt;Description&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;% @permission.each do |permission| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= permission.id%&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.object_type %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.action_name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= permission.description %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', permission %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_permission_path(permission) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', permission, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>The problem with this permission view is that it is printing all the permissions in the permission model</p>\n\n<p>The users view is as given below:</p>\n\n<pre><code>&lt;h1&gt;Users&lt;/h1&gt;\n&lt;table&gt;\n  &lt;% @users.each do |user| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= link_to user.email, users_path %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Show', user %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Edit', edit_user_registration_path(user) %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= link_to 'Settings', permissions_path %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>May be it is the problem of association???</p>\n\n<p>Any help would be appreciated...\nThanks</p>\n"},{"tags":["javascript","jquery","ruby","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":47,"score":1,"question_id":13087051,"title":"Download file data with AJAX request - ruby on rails 3","body":"<p>I recently learned that I can't download more than 1 file with a single HTTP request in ruby on rails except I do it with AJAX request. I'm now trying to figure out how to do that.</p>\n\n<p>(I'm using Prawn as PDF creator with Ruby on RAils 3)\nI have an action in my controller that render a PDF and use send_data</p>\n\n<pre><code>def download_quote          \npdf = QuotesPdf.new(params)\nsend_data pdf.render, filename: \"foo.pdf\",\n                    type: \"application/pdf\",\n                    disposition: \"download\"\nend\n</code></pre>\n\n<p>Then I have a button in my HTML view that has this working Jscript code</p>\n\n<pre><code>// AJAX, download\nfunction ajaxRequest(){\n    $.ajax({\n      type: 'POST',\n      url: '/download_quote/126',\n      success: function(data){\n        alert(data);\n      }\n    });\n    return false;\n  }\n\n  $(\"#mydownload\").click(ajaxRequest);\n</code></pre>\n\n<p>When I click \"#mydownload\" after few seconds took for rendering PDF, I receive a successful alertbox with inside data, I think, all the PDF file.</p>\n\n<p>Question is: How can I transform data in a pdf file and automatically download it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sqlite3","pg"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":58,"score":1,"question_id":13086073,"title":"I have some trouble with migrate from sqlite3 to pg on rails","body":"<pre><code>$ sudo bundle install\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>Fetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/..\nUsing rake (0.9.2.2) \nUsing i18n (0.6.1) \nUsing multi_json (1.3.6) \nUsing activesupport (3.2.8) \nUsing builder (3.0.4) \nUsing activemodel (3.2.8) \nUsing erubis (2.7.0) \nUsing journey (1.0.4) \nUsing rack (1.4.1) \nUsing rack-cache (1.2) \nUsing rack-test (0.6.2) \nUsing hike (1.2.1) \nUsing tilt (1.3.3) \nUsing sprockets (2.1.3) \nUsing actionpack (3.2.8) \nUsing mime-types (1.19) \nUsing polyglot (0.3.3) \nUsing treetop (1.4.11) \nUsing mail (2.4.4) \nUsing actionmailer (3.2.8) \nUsing arel (3.0.2) \nUsing tzinfo (0.3.33) \nUsing activerecord (3.2.8) \nUsing activeresource (3.2.8) \nUsing bundler (1.2.1) \nUsing coffee-script-source (1.4.0) \nUsing execjs (1.4.0) \nUsing coffee-script (2.2.0) \nUsing rack-ssl (1.3.2) \nUsing json (1.7.5) \nUsing rdoc (3.12) \nUsing thor (0.16.0) \nUsing railties (3.2.8) \nUsing coffee-rails (3.2.2) \nUsing jquery-rails (2.1.3) \nInstalling pg (0.14.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /usr/bin/ruby1.8 extconf.rb \nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/ruby1.8\n    --with-pg\n    --without-pg\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n\nGem files will remain installed in /var/lib/gems/1.8/gems/pg-0.14.1 for inspection.\nResults logged to /var/lib/gems/1.8/gems/pg-0.14.1/ext/gem_make.out\nAn error occurred while installing pg (0.14.1), and Bundler cannot continue.\nMake sure that `gem install pg -v '0.14.1'` succeeds before bundling.\n</code></pre>\n\n<p>I am make <code>$ gem install pg -v '0.14.1'</code> But this is not help</p>\n\n<p>My Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\n#gem 'rails', '3.0.9'\n\n#gem 'sqlite3', '1.3.6', :group =&gt; :development\n\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\n\ngem 'sqlite3'\ngem 'pg'\ngem 'taps'\n\ngem 'json'\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n\n#group :production do\n  #gem 'pg'\n#end\n#group :development do\n  #gem 'sqlite3'\n#end\n</code></pre>\n\n<p>gem_make.out</p>\n\n<pre><code>/usr/bin/ruby1.8 extconf.rb \nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/ruby1.8\n    --with-pg\n    --without-pg\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n</code></pre>\n\n<p>mkmf.log</p>\n\n<pre><code>find_executable: checking for pg_config... -------------------- yes\n\n--------------------\n\nfind_header: checking for libpq-fe.h... -------------------- no\n\n\"gcc -E -I. -I/usr/lib/ruby/1.8/i686-linux -I. -D_FORTIFY_SOURCE=2 -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -I -fno-strict-aliasing -g -g -O2  -fPIC    conftest.c -o conftest.i\"\nconftest.c:1:22: fatal error: libpq-fe.h: No such file or directory\ncompilation terminated.\nchecked program was:\n/* begin */\n1: #include &lt;libpq-fe.h&gt;\n/* end */\n\n--------------------\n</code></pre>\n\n<p>Help me please. Thank you.</p>\n\n<p>Sorry for this text.\nYour post does not have much context to explain the code sections; please explain your scenario more clearly.</p>\n"}]}
{"total":34675,"page":11,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","sqlite3","pg"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":58,"score":1,"question_id":13086073,"title":"I have some trouble with migrate from sqlite3 to pg on rails","body":"<pre><code>$ sudo bundle install\n</code></pre>\n\n<p>Result</p>\n\n<pre><code>Fetching gem metadata from https://rubygems.org/...........\nFetching gem metadata from https://rubygems.org/..\nUsing rake (0.9.2.2) \nUsing i18n (0.6.1) \nUsing multi_json (1.3.6) \nUsing activesupport (3.2.8) \nUsing builder (3.0.4) \nUsing activemodel (3.2.8) \nUsing erubis (2.7.0) \nUsing journey (1.0.4) \nUsing rack (1.4.1) \nUsing rack-cache (1.2) \nUsing rack-test (0.6.2) \nUsing hike (1.2.1) \nUsing tilt (1.3.3) \nUsing sprockets (2.1.3) \nUsing actionpack (3.2.8) \nUsing mime-types (1.19) \nUsing polyglot (0.3.3) \nUsing treetop (1.4.11) \nUsing mail (2.4.4) \nUsing actionmailer (3.2.8) \nUsing arel (3.0.2) \nUsing tzinfo (0.3.33) \nUsing activerecord (3.2.8) \nUsing activeresource (3.2.8) \nUsing bundler (1.2.1) \nUsing coffee-script-source (1.4.0) \nUsing execjs (1.4.0) \nUsing coffee-script (2.2.0) \nUsing rack-ssl (1.3.2) \nUsing json (1.7.5) \nUsing rdoc (3.12) \nUsing thor (0.16.0) \nUsing railties (3.2.8) \nUsing coffee-rails (3.2.2) \nUsing jquery-rails (2.1.3) \nInstalling pg (0.14.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /usr/bin/ruby1.8 extconf.rb \nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/ruby1.8\n    --with-pg\n    --without-pg\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n\nGem files will remain installed in /var/lib/gems/1.8/gems/pg-0.14.1 for inspection.\nResults logged to /var/lib/gems/1.8/gems/pg-0.14.1/ext/gem_make.out\nAn error occurred while installing pg (0.14.1), and Bundler cannot continue.\nMake sure that `gem install pg -v '0.14.1'` succeeds before bundling.\n</code></pre>\n\n<p>I am make <code>$ gem install pg -v '0.14.1'</code> But this is not help</p>\n\n<p>My Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\n#gem 'rails', '3.0.9'\n\n#gem 'sqlite3', '1.3.6', :group =&gt; :development\n\n\ngem 'rails', '3.2.8'\n\n# Bundle edge Rails instead:\n# gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'\n\n\ngem 'sqlite3'\ngem 'pg'\ngem 'taps'\n\ngem 'json'\n\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem 'sass-rails',   '~&gt; 3.2.3'\n  gem 'coffee-rails', '~&gt; 3.2.1'\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem 'therubyracer', :platforms =&gt; :ruby\n\n  gem 'uglifier', '&gt;= 1.0.3'\nend\n\ngem 'jquery-rails'\n\n\n#group :production do\n  #gem 'pg'\n#end\n#group :development do\n  #gem 'sqlite3'\n#end\n</code></pre>\n\n<p>gem_make.out</p>\n\n<pre><code>/usr/bin/ruby1.8 extconf.rb \nchecking for pg_config... yes\nUsing config values from /usr/bin/pg_config\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nYou need to install postgresql-server-dev-X.Y for building a server-side extension or libpq-dev for building a client-side application.\nchecking for libpq-fe.h... no\nCan't find the 'libpq-fe.h header\n*** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n    --with-opt-dir\n    --without-opt-dir\n    --with-opt-include\n    --without-opt-include=${opt-dir}/include\n    --with-opt-lib\n    --without-opt-lib=${opt-dir}/lib\n    --with-make-prog\n    --without-make-prog\n    --srcdir=.\n    --curdir\n    --ruby=/usr/bin/ruby1.8\n    --with-pg\n    --without-pg\n    --with-pg-dir\n    --without-pg-dir\n    --with-pg-include\n    --without-pg-include=${pg-dir}/include\n    --with-pg-lib\n    --without-pg-lib=${pg-dir}/lib\n    --with-pg-config\n    --without-pg-config\n    --with-pg_config\n    --without-pg_config\n</code></pre>\n\n<p>mkmf.log</p>\n\n<pre><code>find_executable: checking for pg_config... -------------------- yes\n\n--------------------\n\nfind_header: checking for libpq-fe.h... -------------------- no\n\n\"gcc -E -I. -I/usr/lib/ruby/1.8/i686-linux -I. -D_FORTIFY_SOURCE=2 -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -I -fno-strict-aliasing -g -g -O2  -fPIC    conftest.c -o conftest.i\"\nconftest.c:1:22: fatal error: libpq-fe.h: No such file or directory\ncompilation terminated.\nchecked program was:\n/* begin */\n1: #include &lt;libpq-fe.h&gt;\n/* end */\n\n--------------------\n</code></pre>\n\n<p>Help me please. Thank you.</p>\n\n<p>Sorry for this text.\nYour post does not have much context to explain the code sections; please explain your scenario more clearly.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13085131,"title":"Join scope in Rails 3","body":"<p>I'd like to write a Rails 3 scope, on Client, to do the following:</p>\n\n<pre><code>select * from clients c, dependents d\nwhere d.last_name like '%ss%' and c.id = d.client_id;\n</code></pre>\n\n<p>Dependent model:</p>\n\n<pre><code>class Dependent &lt; ActiveRecord::Base\n  belongs_to :client\n  scope :by_last_name, (lambda do |name| { :conditions =&gt; ['last_name LIKE ?', \"#{name}%\"]} end )\n</code></pre>\n\n<p>Client model:</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n  has_many :dependents, :dependent =&gt; :destroy\n</code></pre>\n\n<p>I have not yet been able to get a scope join to work syntactically. The dependent's last name needs to be passed in as a parameter.\nThanks.</p>\n"},{"tags":["ruby-on-rails-3","routes","omniauth"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":166,"score":0,"question_id":7923463,"title":"Omniauth can't find route","body":"<p>I'm trying to implement Omniauth with my Rails 3 app. I followed the tutorial from the <a href=\"http://railscasts.com/episodes/235-omniauth-part-1?view=comments\" rel=\"nofollow\">Railscast episod 205</a>, but can't get it to work. When I call the '/auth/twitter' (it doesn't work with any provider) Rails complains it can't find the appropriate route (it tries to load my default route).</p>\n\n<p>I added omniauth.rb under <code>config/initializers/</code>, put <code>gem 'omniauth'</code> in my Gemfile, and ran bundle install.</p>\n\n<p>I'm not sure how to debug this problem nor what information to provide to help understand the problem.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","actionmailer"],"answer_count":3,"favorite_count":5,"up_vote_count":8,"down_vote_count":0,"view_count":2313,"score":8,"question_id":4868205,"title":"Rails - Mail, getting the body as Plain Text","body":"<p>Given: <code>message = Mail.new(params[:message])</code></p>\n\n<p>as seen here: <a href=\"http://docs.heroku.com/cloudmailin\" rel=\"nofollow\">http://docs.heroku.com/cloudmailin</a></p>\n\n<p>It shows how to get the message.body as HTML, how to do you get the plain/text version?</p>\n\n<p>Thanks</p>\n"},{"tags":["javascript","jquery","ruby","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13081795,"title":"Page reload from controller rails 3?","body":"<p>I want to redirect a user to login page if his/her session is timeout. How can I redirect my user to login page if user click on any link of my web page. And link can be a ajax call or page reload call.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":5,"favorite_count":0,"up_vote_count":4,"down_vote_count":1,"view_count":2487,"score":3,"question_id":7753021,"title":"Syntax error when creating a Rails model","body":"<p>I am creating Car model in Rails 3 by using command:</p>\n\n<pre><code>rails generate model Car name:string id_str:string\n</code></pre>\n\n<p>but I got the error:</p>\n\n<pre><code>/home/XX/.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.1.1/lib/active_support/dependencies.rb:234:in `load': /home/XX/myapp/config/initializers/session_store.rb:3: syntax error, unexpected ':', expecting $end (SyntaxError)\n...sion_store :cookie_store, key: '_myapp_session'\n</code></pre>\n\n<p>why?</p>\n\n<p>my <code>session_store.rb</code></p>\n\n<pre><code>Myapp::Application.config.session_store :cookie_store, key: '_myapp_session'\n</code></pre>\n\n<p>What's wrong with my <code>session_store.rb</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching","memcached"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13079125,"title":"Memcached dynamic feed?","body":"<p>I have a dynamic feed of events from users that are being followed by the current user, the partials are all memcached, but I'd also like to do it for the feed itself. My concern is that if I memcache this that it will show the same thing for every user based on the first write to cache rather than being dynamic for each unique user. </p>\n\n<p>How would I memcache the feed and @following? How do I have it update if the current user follows another user? I'm assuming I can't just wrap it with a &lt;% cache \"feed\" do %></p>\n\n<p>NOTE: using Memcached and Dalli</p>\n\n<pre><code>&lt;% @following = current_user.following.collect {|f| f[\"id\"]} %&gt;\n&lt;div class='content'&gt;\n&lt;% unless Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", Time.now, Time.now.strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }.count == 0 %&gt;\n          &lt;div class='date_bar_container'&gt;&lt;div class='date_bar'&gt;Today&lt;/div&gt;&lt;/div&gt;\n          &lt;div class='content_wrapper'&gt;\n    &lt;%= render :partial =&gt; 'events/event', :collection =&gt; Event.where(:id =&gt;  Rsvp.where(:event_id =&gt; Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", Time.now.strftime('%Y-%m-%d 00:00:00.000000'), Time.now.strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }).select(\"DISTINCT event_id\").collect(&amp;:event_id)).order('start_time asc')%&gt;\n          &lt;/div&gt;\n&lt;% end %&gt;\n\n&lt;% unless Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + 1.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + 1.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }.count == 0%&gt;\n          &lt;div class='date_bar_container'&gt;&lt;div class='date_bar'&gt;Tomorrow&lt;/div&gt;&lt;/div&gt;\n          &lt;div class='content_wrapper'&gt;\n    &lt;%= render :partial =&gt; 'events/event', :collection =&gt; Event.where(:id =&gt;  Rsvp.where(:event_id =&gt; Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + 1.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + 1.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }).select(\"DISTINCT event_id\").collect(&amp;:event_id)).order('start_time asc')%&gt;\n    &lt;/div&gt;\n    &lt;% end %&gt;\n\n&lt;% (2..15).each do |f| %&gt;\n    &lt;% unless Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + f.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + f.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }.count == 0 %&gt;\n              &lt;div class='date_bar_container'&gt;&lt;div class='date_bar'&gt;&lt;%= dayofweek((Time.now + f.day).wday) %&gt;, &lt;%= month((Time.now + f.day).month) %&gt; &lt;%= (Time.now + f.day).day %&gt;, 2012&lt;/div&gt;&lt;/div&gt;\n              &lt;div class='content_wrapper'&gt;\n        &lt;%= render :partial =&gt; 'events/event', :collection =&gt; Event.where(:id =&gt;  Rsvp.where(:event_id =&gt; Rsvp.where(:voter_id =&gt; @following, :status =&gt; 'going').where(\"start_time &gt; ? AND start_time &lt; ?\", (Time.now + f.day).strftime('%Y-%m-%d 00:00:00.000000'), (Time.now + f.day).strftime('%Y-%m-%d 23:59:59.000000')).order(\"count_all desc\").count(:group =&gt; :event_id).collect { |f| f[0] }).select(\"DISTINCT event_id\").collect(&amp;:event_id)).order('start_time asc')%&gt;\n         &lt;/div&gt;\n        &lt;% end %&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rake"],"answer_count":4,"favorite_count":17,"up_vote_count":63,"down_vote_count":0,"view_count":18398,"score":63,"question_id":4116067,"title":"Purge or recreate a Ruby on Rails database","body":"<p>I have a dev Ruby on Rails database full of data. I want to delete everything and rebuild the database. I'm thinking of using something like:</p>\n\n<pre><code>rake db:recreate\n</code></pre>\n\n<p>Is this possible?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13075461,"title":"Routes with optional params in Rails","body":"<p>I'm trying to setup a route that looks like this: <code>acme.com/posts/:category/:status</code>. Both <code>:category</code> and <code>:status</code> are optional. I wrote many variations, but none worked:</p>\n\n<pre><code>resources :posts do\n  match '(/:category)(/:status)', to: 'posts#index', as: 'filter', on: :collection\nend\n\n# Category Links\nlink_to \"Questions\", filter_posts_path(:questions)\nlink_to \"Suggestions\", filter_posts_path(:suggestions)\n\n# Status Links\nlink_to \"Published\", filter_posts_path(params[:category], :published)\nlink_to \"Draft\", filter_posts_path(params[:category], :draft)\n</code></pre>\n\n<p>The idea is to be able to <em>1) filter by category</em>, <em>2) filter by status</em>, <em>and 3) filter by both category and status if both are available</em>. The current setup has also broken my <code>/posts/new</code> path, always redirecting to <code>posts#index</code>.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13083068,"title":"Routing error in rails","body":"<p>In my controller I have </p>\n\n<pre><code>def update_project_dates\n  p \"It is end date.....\"\n  @user=User.find(params[:user])\n  @projects=Project.find_all_by_user_id(@user)\nend\n</code></pre>\n\n<p>In the view page (only some part of the code is copied and pasted)</p>\n\n<pre><code>eventDrop: function() \n{ \n  $.ajax({\n    url:'/update_project_dates/',\n    success:function(data)\n    {\n    alert(\"Hello\");\n    }\n  })\n},\n</code></pre>\n\n<p>In my routes.rb I have mentioned</p>\n\n<pre><code>match '/update_project_dates' =&gt; 'users#update_project_dates', :method=&gt; :get\nget 'update_project_dates'\n</code></pre>\n\n<p>But When the ajax request goes, I get the routing error as</p>\n\n<blockquote>\n  <h1>Routing Error</h1>\n  \n  <p><pre>uninitialized constant UsersController</pre></p>\n</blockquote>\n\n<p>Where am I doing wrong here...Please help..</p>\n"},{"tags":["ruby-on-rails-3","authentication","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13020961,"title":"Rails Devise Conditional authentication_keys","body":"<p>Is there any way of making the authentication_keys configuration conditional depending on the user type?</p>\n\n<p>For instance in my User model I have two different user, standard user and student, defined by the value of a bitmask attribute. I want to authenticate Students on the basis of username and school_id. Standard users don't have to have a value for school_id. In order to accommodate this I have two types of login screens, one for students and another for standard users. The student login screen has a hidden school_id field that authenticates them to their school.</p>\n\n<p>In my devise configuration file I have:</p>\n\n<pre><code>config.authentication_keys = [ :username, :school_id ] \n</code></pre>\n\n<p>However with this setup standard users are unable to login, my guess is that it's expecting a school_id for all Users being authenticated. Is it possible to make the authentication keys conditional? Or give an allow_blank option for school_id? I want to be able to keep standard users and students in the same model. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13067382,"title":"Devise: user has to login again each time he closes the browser","body":"<p>I'm using Devise and Omniauth for user authentication.</p>\n\n<p>I want the users to stay signed in for 2 weeks after the authentication. However, whenever the user closes the browser window and reopen it, he gets the login screen again.</p>\n\n<p>What is the correct configuration for the user to stay connected even after the browser was closed and re-opened?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","login","devise","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13079079,"title":"How to put a login form in the header for Devise and Rails","body":"<p>I want to put a login form in the header of my website. I use Rails 3.2.8 and the latest Devise. In the <code>app/views/devise/sessions/new.html.erb</code> file a login form is created with:</p>\n\n<pre><code>  &lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; session_path(resource_name), :html =&gt; {:class =&gt; 'main'}) do |f| %&gt;\n    &lt;div&gt;&lt;%= f.label :login %&gt; &lt;%= f.text_field :login, :placeholder =&gt; 'Enter username' %&gt;&lt;/div&gt;\n    &lt;div&gt;&lt;%= f.label :password %&gt; &lt;%= f.password_field :password, :placeholder =&gt; 'Enter password' %&gt;&lt;/div&gt;\n    &lt;% if devise_mapping.rememberable? -%&gt;\n      &lt;div&gt;&lt;%= f.check_box :remember_me %&gt; &lt;%= f.label :remember_me %&gt;&lt;/div&gt;\n    &lt;% end -%&gt;\n    &lt;%= f.submit \"Go\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>If I try to copy that code and put it in my <code>application.html.erb</code>, I get an error regarding that resource variable referenced above:</p>\n\n<pre><code>undefined local variable or method `resource' for #&lt;#&lt;Class:0x3cb62c8&gt;:0x3c73b00&gt;\n</code></pre>\n\n<p>So can I just use a normal rails form with <code>/users/sign_in</code> as the action? How do I tell devise where to redirect to after logging in?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":5,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":320,"score":5,"question_id":5559980,"title":"What's the best way to do integration testing for a Javascript heavy UI in a rails app?","body":"<p>We have a web application that makes extensive use of AJAXy Javascript in the UI. We have nearly complete code coverage of our backend using Shoulda and Webrat, and would like to extend our test suite to include full integration testing through the Javascript UI.</p>\n\n<p>We tried Selenium but found it brittle and temperamental. Are there more reliable options?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>For those still checking this out, we ended up using Xvfb so we can run Firefox without a screen. Allows us to run the test on a headless Jenkins CI server. We still have to run tests \"live\" locally occasionally to debug, but it works pretty well.</p>\n"},{"tags":["mysql","ruby-on-rails","osx","ruby-on-rails-3"],"answer_count":8,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":5922,"score":4,"question_id":4545701,"title":"'undefined method init for Mysql:Class'","body":"<p>I've been having problems with a MySQL Server installation that got messed up after a power outage. </p>\n\n<h3>Configuration</h3>\n\n<p>Intel i5 Mac running OS X 10.6.5<br>\nRuby 1.9.2 installed<br>\nRails 3.0.1 installed<br>\nMySQL Server (finally) installed and running<br>\nI completely reinstalled MySQL, which deleted the local development/test/production databases. So, I have run <code>create database development;</code> in MySQL to get the dev database ready for a migration.</p>\n\n<h3>Current Goal</h3>\n\n<ul>\n<li>Run <code>rake db:migrate</code> to get my databases back again. (I cannot currently access my databases or Mysql at all from Rails.)</li>\n</ul>\n\n<h3>Error</h3>\n\n<p>Using the gem <code>'mysql', '2.8.1'</code> and run <code>rake db:migrate</code>, I get the error:</p>\n\n<pre><code>rake aborted!\nundefined method 'init' for Mysql:Class\n</code></pre>\n\n<p>Stack Trace:</p>\n\n<pre><code>/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/mysql_adapter.rb:30:in 'mysql_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:230:in 'new_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:238:in 'checkout_new_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:194:in 'block (2 levels) in checkout'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in 'loop'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:190:in 'block in checkout'\n/Users/sscirrus/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/monitor.rb:201:in 'mon_synchronize'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:189:in 'checkout'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:96:in 'connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_pool.rb:318:in 'retrieve_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_specification.rb:97:in 'retrieve_connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/connection_adapters/abstract/connection_specification.rb:89:in 'connection'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:486:in 'initialize'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:433:in 'new'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:433:in 'up'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/migration.rb:415:in 'migrate'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/activerecord-3.0.1/lib/active_record/railties/databases.rake:142:in 'block (2 levels) in &lt;top (required)&gt;'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:636:in 'call'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:636:in 'block in execute'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:631:in 'each'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:631:in 'execute'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:597:in 'block in invoke_with_call_chain'\n/Users/sscirrus/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/monitor.rb:201:in 'mon_synchronize'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:590:in 'invoke_with_call_chain'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:583:in 'invoke'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2051:in 'invoke_task'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2029:in 'block (2 levels) in top_level'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2029:in 'each'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2029:in 'block in top_level'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2068:in 'standard_exception_handling'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2023:in 'top_level'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2001:in 'block in run'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:2068:in 'standard_exception_handling'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/lib/rake.rb:1998:in 'run'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/gems/rake-0.8.7/bin/rake:31:in '&lt;top (required)&gt;'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/bin/rake:19:in 'load'\n/Users/sscirrus/.rvm/gems/ruby-1.9.2-p0/bin/rake:19:in '&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13083757,"title":"Dynamic Canonical URL","body":"<p>Just implemented canonical url feature in my site.</p>\n\n<p>ApplicationController</p>\n\n<pre><code>def canonical_url(canonical_url)\n    @canonical_url = canonical_url\nend\n</code></pre>\n\n<p>ApplicationHelper</p>\n\n<pre><code>def canonical_link_tag\n    tag(:link, :rel =&gt; :canonical, :href =&gt; @canonical_url) if @canonical_url\nend\n</code></pre>\n\n<p>application.html.haml</p>\n\n<pre><code>= canonical_link_tag\n</code></pre>\n\n<p>HousesController</p>\n\n<pre><code>def show \n  @house = House.find(params[:id])\n  canonical_url(house_url(@house))\nend\n</code></pre>\n\n<p>In some cases the location of the houses are the same. So i write one piece of location/area content and link from other houses in the same area (canonical) to the source content. </p>\n\n<p>An example what i want to realize:</p>\n\n<p>House A</p>\n\n<pre><code>page: /en/holidayrentals/house_A/location\ncanonical: &lt;link href=\"/en/holidayrentals/house_A/location\" rel=\"canonical\" /&gt; \n</code></pre>\n\n<p>House B</p>\n\n<pre><code>page: /en/holidayrentals/house_B/location\ncanonical: &lt;link href=\"/en/holidayrentals/house_A/location\" rel=\"canonical\" /&gt; \n</code></pre>\n\n<p>House C</p>\n\n<pre><code>page: /en/holidayrentals/house_C/location\ncanonical: &lt;link href=\"/en/holidayrentals/house_A/location\" rel=\"canonical\" /&gt; \n</code></pre>\n\n<p>What's the best approach is this case...cases/conditions in the view? Extra attribute in de DB? </p>\n\n<p>Ciao..remco</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":959,"score":2,"question_id":9624601,"title":"ActiveRecord Find By Year, Day or Month on a Date field","body":"<p>I have an ActiveRecord model that has a date attribute.  Is it possible to utilize that date attribute to find by Year, Day and Month:</p>\n\n<pre><code>Model.find_by_year(2012)\nModel.find_by_month(12)\nModel.find_by_day(1)\n</code></pre>\n\n<p>or is it simply possible to find_by_date(2012-12-1).</p>\n\n<p>I was hoping I could avoid creating Year, Month and Day attributes. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13082860,"title":"updating data in database on save","body":"<p>I'm trying to update data in database using after_create callback\nI wrote </p>\n\n<pre><code>Dm::Advertisement.where (:type =&gt; Dm::Advertisement).update_all(ads_counter: 0)\n</code></pre>\n\n<p>in my model , but have SyntaxError. Can anyone point me where i did mistake?</p>\n"},{"tags":["ruby-on-rails-3","facebook","facebooker2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":378,"score":0,"question_id":8824028,"title":"getting \"Uncaught TypeError: Cannot call method 'replace' of undefined\" when doing FB.init using Facebooker2","body":"<p>I am using Facebooker2 to create a Facebook IFrame application, which is running as a tab inside a Facebook page.</p>\n\n<p>My goal is to be able to use the social plugins, such as a like button and comments, etc. I tried to define them as follows</p>\n\n<pre><code>&lt;div class=\"fb-like\" data-href=\"http://www.myurl.com\" data-send=\"false\" data-layout=\"button_count\" data-width=\"450\" data-show-faces=\"false\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>and trying to initialize the FB JS SDK by calling</p>\n\n<pre><code>&lt;%= fb_connect_async_js %&gt;\n</code></pre>\n\n<p>which outputs</p>\n\n<pre><code>&lt;div id=\"fb-root\"&gt;&lt;script async=\"\" src=\"http://connect.facebook.net/en_US/all.js\"&gt;&lt;/script&gt;&lt;/div&gt;\n      &lt;script&gt;\n        window.fbAsyncInit = function() {\n          FB.init({\n            appId  : 'APP_ID',\n            status : true, // check login status\n            cookie : true, // enable cookies to allow the server to access the session\n            oauth : true,\n            xfbml  : true  // parse XFBML\n          });\n\n        };\n\n        (function() {\n          var e = document.createElement('script'); e.async = true;\n          e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';\n          document.getElementById('fb-root').appendChild(e);\n        }());\n      &lt;/script&gt;\n</code></pre>\n\n<p>This has worked before, and stopped working after Facebook pushed their last platform update about a month ago. Now the Like button is not being rendered at all. I also tried the XFBML approach, no luck.</p>\n\n<p>note: I am able to publish feeds using FB.publish, and I am also able to create a like button using the IFrame method.</p>\n\n<p>I looked at the documentation and didn't see anywhere where it was mentioned that Social plugins cannot be used inside IFrame apps.</p>\n\n<p>any ideas anyone?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13082173,"title":"Finding folder sizes if i have hierarchy of folders?","body":"<p>I am trying to get the folder sizes exactly..\nmy folders are arranged like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/1Ucg4.png\" alt=\"folder structure\"></p>\n\n<p>m using parent_folder_id for all the folders. if the folder is root folder parent_folder_id is nil. For sub folder parent_folder_id is successive folder/sub folder id. \nNow i want to display the folder sizes exactly i.e including the sub folder sizes. As its a unlimited hierarchy, i am little bit confusing to loop. i want to display sub folder sizes also. </p>\n\n<p>Can any one suggest me the solution.\nThanks in advance..</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13076944,"title":"How to handle each iterator?","body":"<p>I want to print the values taken from two different tables in the database in a table on the view page. I am not getting how to handle two each iterators as it is behaving abnormally i.e Printing a value several times. I am very much confused. Please help.</p>\n\n<p>Here is my code</p>\n\n<p>In the controller:</p>\n\n<pre><code>class ListController &lt; ApplicationController\n\n  def all\n    @books = Book.all   \n    @susers = SUser.all    \n  end\nend\n</code></pre>\n\n<p>In my view page</p>\n\n<pre><code>&lt;tbody&gt;                     \n  &lt;% @books.each do |b| %&gt;\n    &lt;% if b.branch == \"I.T\" %&gt;                                      \n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= b.id %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= b.book_name %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= b.year %&gt;&lt;/td&gt;\n        &lt;td&gt;&lt;%= b.user_id %&gt;&lt;/td&gt;    \n\n        &lt;% @susers.each do |s| %&gt;                   \n          &lt;% if s.user_id == b.user_id %&gt;\n            &lt;td&gt;&lt;%= s.address %&gt;&lt;/td&gt;\n          &lt;% else %&gt;\n            &lt;td&gt;Error..!!&lt;/td&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;                       \n      &lt;/tr&gt; \n    &lt;% else %&gt;\n      &lt;% puts \"No any book of this branch\" %&gt;   \n    &lt;% end %&gt;                                       \n  &lt;% end %&gt;                                 \n&lt;/tbody&gt;\n</code></pre>\n\n<p>The output is displayed like this</p>\n\n<p>The <code>else</code> part of the first <code>if</code> statement is repeating it self again and again. I dont know why it is happening?<img src=\"http://i.stack.imgur.com/dYoT7.png\" alt=\"You can see the error part printing four times since the book table has 4 books in the database.\"></p>\n\n<p>There are 3 models in this project. \n1. User - Made by devise\n2. Book \n3. SUser </p>\n\n<p>One important thing: -\nActually i made SUser model because i want to store user's personal details such as name, address, phone no. I dont want to touch devise model (User) so i made another model SUser which has one to one relation with devise model(User). </p>\n\n<p>User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  # Include default devise modules. Others available are:\n  # :token_authenticatable, :confirmable,\n  # :lockable, :timeoutable and :omniauthable\n  has_and_belongs_to_many :books\n  has_one :s_user\n  devise :database_authenticatable, :registerable,\n       :recoverable, :rememberable, :trackable, :validatable\n\n  # Setup accessible (or protected) attributes for your model\n  attr_accessible :email, :password, :password_confirmation, :remember_me\n  # attr_accessible :title, :body\n\nend\n</code></pre>\n\n<p>Book Model:</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  has_and_belongs_to_many :users\n  belongs_to :s_user, :class_name =&gt; \"SUser\"\n  attr_accessible :id, :user_id, :book_name, :edition, :author, :branch, :publisher,      :year, :details \nend\n</code></pre>\n\n<p>SUser model:</p>\n\n<pre><code>class SUser &lt; ActiveRecord::Base\n  # attr_accessible :title, :body\n  has_one :user\n  has_many :books\n  attr_accessible :user_id, :fullname, :email, :address, :details \nend\n</code></pre>\n\n<p>Migrations files:</p>\n\n<pre><code>class CreateBooks &lt; ActiveRecord::Migration\n  def change\n    create_table :books do |t|\n    t.integer \"user_id\", :limit =&gt;5\n    t.string \"book_name\", :limit =&gt; 50\n    t.integer \"edition\", :limit =&gt; 5\n    t.string \"author\", :limit =&gt; 30\n    t.string \"branch\", :limit =&gt; 30\n    t.string \"publisher\", :limit =&gt; 50\n    t.integer \"year\", :limit =&gt; 10     \n    t.text \"details\"\n    t.timestamps\n  end\n  add_index :books, \"user_id\"\n end\nend\n</code></pre>\n\n<p>SUser migration file</p>\n\n<pre><code>class CreateSUsers &lt; ActiveRecord::Migration\n def change\n  create_table :s_users do |t|\n    t.integer \"user_id\", :limit =&gt; 5\n    t.string \"fullname\", :limit =&gt; 25            \n    t.string \"email\", :default =&gt; \"\", :null =&gt; false\n    t.string \"hashed_password\", :limit =&gt; 40\n    t.string \"salt\", :limit =&gt; 40\n    t.string \"address\",:limit =&gt; 25\n    t.text \"details\"\n    t.timestamps\n  end\n  add_index :s_users, \"user_id\"\n end\nend\n</code></pre>\n\n<p>I made many to many relationship between user and book since one user have many books and one book can be available to many users.\nSo i made a simple join table for many to many association</p>\n\n<pre><code>class CreateBooksUsersJoin &lt; ActiveRecord::Migration\n def up\n   create_table :books_users, :id =&gt; false do |t|\n     t.integer \"book_id\"\n     t.integer \"user_id\"\n   end\n  add_index :books_users, [\"book_id\", \"user_id\"]\n end\n\n def down\n  drop_table :book_users\n end\nend\n</code></pre>\n\n<p>Lol.. I have pasted my whole code over here. Actually i am new to rails.. Please guide me if you find any other flaw to this code.\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13080933,"title":"Ruby on Rails - The way to define answers is true / false in model Answer","body":"<p>I'm building an online test app. In my app, one question can be a True/False question, Single choice (only one answer is accepted), Multi choice (many answers are accepted). I create models:  </p>\n\n<pre><code>class Question &lt; ActiveRecord::Base\n  has_many :answers\nend\n\nclass Answer &lt; ActiveRecord::Base\n  belongs_to :question\nend  \n</code></pre>\n\n<p>The Question model will have a <code>question_type_id</code> to check it is a T/F, Single or Multi choice. </p>\n\n<p>The Answer model will have a column called <code>content</code> typed text, and i will have a boolean column called <code>correct</code> to know which answer is accepted. With single and multi choice questions, i think answers are text will be fine to store in <code>content</code> column, but with True/False question, is it good idea if i only store answers is text like 'True', 'False' in <code>content</code> column and set a True for answer is accepted in <code>correct</code> column? I don't know another better way to deal with True/False question, can anybody help me?</p>\n"},{"tags":["ruby-on-rails-3","configuration","heroku","asset-pipeline"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":13077564,"title":"deploying to heroku asset pipeline Sprockets::fileNotFound","body":"<p>I'm trying to deploy my app to heroku. Heroku did not load my js and css files \nI ran RAILS_ENV=production bundle exec rake assets:precompile\nand it still was not working. </p>\n\n<p>then I ran\nheroku rake assets:precompile </p>\n\n<p>I get this error in Heroku logs: </p>\n\n<pre><code>Error compiling asset application.css:\n Sprockets::FileNotFound: couldn't find file 'jquery.ui.datepicker'\n (in /app/app/assets/stylesheets/application.css.scss:13)\n\nServed asset /application-989f5e5266d9b066eb316183d7db5c77.css - 500 Internal Server Error\n\n\n Error compiling asset application.js:\n Sprockets::FileNotFound: couldn't find file 'jquery.ui.datepicker'\n (in /app/app/assets/javascripts/application.js:16)\nServed asset /application-d81c946c6f47242e5e97de9bca4938be.js - 500 Internal Server Error\n</code></pre>\n\n<p>config production.rb: </p>\n\n<pre><code>config.cache_classes = true\n  config.consider_all_requests_local       = false\n  config.action_controller.perform_caching = true\n  config.serve_static_assets = true\n  config.assets.compress = true\n  config.assets.compile = true\n  config.assets.initialize_on_precompile = false\n\n  config.assets.digest = true\n</code></pre>\n\n<p>IN ASSETS\napplication.css.scss</p>\n\n<pre><code> *= require_self\n *= require bootstrap_and_overrides\n *= require jquery.ui.datepicker\n *= require bootstrap-timepicker\n *= require jquery.fileupload-ui\n *= require_tree .\n*/\n</code></pre>\n\n<p>application.js</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require twitter/bootstrap\n//= require jquery.ui.datepicker\n//= require bootstrap-timepicker\n//= require jquery-fileupload/basic\n//= require jquery-fileupload/vendor/tmpl\n//= require_tree .\n</code></pre>\n\n<p>Any idea how to fix this? thanks in advance for all your help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13079813,"title":"undefined method `text?' for nil:NilClass Validate uniqness rails3 ruby 187","body":"<p>I just updated from rails 2.3 to 3, i'm trying to replace this old method with something cleaner, because it's outputting the model and field name, wtf!</p>\n\n<p><img src=\"http://i.stack.imgur.com/WpomS.jpg\" alt=\"enter image description here\"></p>\n\n<p>However I get the above error when calling <strong>validates_uniqueness_of</strong> (the presence works fine).  I passed in the primary id scope, and still get it.  Any help is welcome. </p>\n\n<pre><code>   def validate\n     if org_name.blank?\n       errors.add(:org_name, :blank, :default =&gt; nil)\n     else\n       if (org = Organization.find_by_org_name(org_name)) &amp;&amp; org != self\n         errors.add(:org_name, :taken, :default =&gt; nil, :value =&gt; org_name)\n       end\n     end\n   end\n</code></pre>\n\n<p>to</p>\n\n<pre><code>validates :org_name, :presence =&gt; true\n  validates_uniqueness_of :org_name, :scope =&gt; :org_id\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","will-paginate"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":13074792,"title":"will_paginate not using current route","body":"<p>We're using will_paginate to display associations of a model. We have some custom routes set up like so:</p>\n\n<pre><code>get '/profile/:slug' =&gt; 'talents#show', :as =&gt; :talent\nget '/profile/:slug/bio' =&gt; 'talents#show', :as =&gt; :talent_bio\nget '/profile/:slug/instagram' =&gt; 'talents#show', :as =&gt; :talent_instagram\n</code></pre>\n\n<p>When we're using talent_instagram route, all pagination links are rendered to the default route instead. That is, instead of:</p>\n\n<pre><code>http:://0.0.0.0:3000/profile/some-talent/instagram?page=5\n</code></pre>\n\n<p>This is what we get:</p>\n\n<pre><code>http:://0.0.0.0:3000/profile/some-talent?page=5\n</code></pre>\n\n<p>If I comment out the first two routes, then the correct link is used. Why is will_paginate defaulting to the first route?</p>\n"},{"tags":["ruby","ruby-on-rails-3","partial-views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13080159,"title":"Rails 3 - Partial Not Rendering","body":"<p>In my view I have the following:</p>\n\n<pre><code>&lt;div class=\"subject edit\"&gt;\n&lt;%= form_for(:subject, :url =&gt; {:action =&gt; 'update', :id =&gt; @subject.id}) do |f| %&gt;\n\n&lt;%= render(:partial =&gt; \"form\", :locals =&gt; {:f =&gt; f}) %&gt;\n\n&lt;div class=\"form-buttons\"&gt;\n    &lt;%= submit_tag(\"Update Subject\") %&gt;\n&lt;/div&gt;\n\n\n&lt;% end %&gt;\n</code></pre>\n\n<p></p>\n\n<p>In the same folder I have created a partial (_form.html.erb). But for some reason it is not rendered. </p>\n\n<p>_form.html.erb:</p>\n\n<pre><code>&lt;table summary=\"Subject form fields\"&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Name&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:name) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Position&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:position) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;th&gt;Visible?&lt;/th&gt;\n        &lt;td&gt;&lt;%= f.text_field(:visible) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n</code></pre>\n\n<p></p>\n\n<p>I'm running rails 3.2.7. Can some see what I'm doing wrong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","custom-routes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13080092,"title":"custom route for failed login","body":"<p>I have a rails app with a quite standard login system (a session resource with new, create and destroy).</p>\n\n<p>When the authentication fails</p>\n\n<pre><code>render \"new\"\n</code></pre>\n\n<p>and the url in the browser bar changes to domain.com/sessions, however I'd like to keep domain.com/ or if this is not possible to define a custom values, such as \"login\". I have played with my routes file but without success. Here my file:</p>\n\n<pre><code>GK::Application.routes.draw do  \n  root :to =&gt; 'sessions#new', as: 'login'\n  get 'logout', to: 'sessions#destroy', as: 'logout'\n\n  resources :users\n  resources :sessions\nend\n</code></pre>\n\n<p>What do I have to change to make it work?</p>\n\n<p>Thanks and have a nice day.</p>\n"},{"tags":["ruby-on-rails","rspec","integration-testing","ruby-on-rails-3","webrat"],"answer_count":4,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":6957,"score":3,"question_id":2131645,"title":"How rspec works with rails3 for integration-tests?","body":"<p>What I'm trying to ahieve is to do <strong>integration tests with webrat in rails3</strong> like Yehuda does with test-unit in <a href=\"http://pivotallabs.com/talks/76-extending-rails-3\" rel=\"nofollow\">http://pivotallabs.com/talks/76-extending-rails-3</a> minute 34.</p>\n\n<p>an example:</p>\n\n<pre><code>describe SomeApp\n  it \"should show the index page\"\n    visit \"/\"\n    body.should =~ /hello world/\n  end\nend\n</code></pre>\n\n<p>Does someone knows a way to do it?</p>\n"},{"tags":["javascript","html","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13061047,"title":"Adding Javascript in Rails","body":"<p>I'm using Rails 3.0. I want to add a Javascript file <code>show_javascript.js</code> that is in <code>/public/javascripts/</code> to a view <code>show.html.erb</code>. </p>\n\n<p>The <code>show.html.erb</code> file takes the <code>&lt;head&gt;...&lt;/head&gt;</code> part from the template <code>application.html.erb</code></p>\n\n<p>I'm wondering how I should add it.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":10273231,"title":"How to call a method after a view has been rendered in rails 3","body":"<p>I have a task which will take around 20 - 30 seconds. I want this task to run immediately after a view is rendered. I want the output of this task to be stored in a session variable. What is the simplest way to do it rails 3. </p>\n\n<p>To explain what i need exactly. I am showing a list of tweets to users (this is the view rendered) They have to go through them. I want a method to be invoked after this view is rendered which will take the same tweets and cluster them (20-30 seconds process). I should have the results of the clustering in the session so that i can display them in the next page. </p>\n\n<p>How do I do this? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","carrierwave","image-upload"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13078921,"title":"Carrierwave fixtures with web url or object.url without store_dir path","body":"<p>I am uploading images with carrierwave! \nnow in fixtures i have to store some urls(from other websites)\nIs there any way i get the url without store_dir path \nor i can use fixtures where i specify to upload file from url??\nwhenever i run <code>object.url</code> it returns </p>\n\n<p><strong>\"/uploads/deal_image/url/1071381712/https:/encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT0m2sjy-kyfC8J6SxECrgafDE-7ztWZ05GBqmIrIDKr2AdjotwuQ\"</strong></p>\n\n<p>and i want </p>\n\n<p><strong>https:/encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT0m2sjy-kyfC8J6SxECrgafDE-7ztWZ05GBqmIrIDKr2AdjotwuQ</strong></p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-plugins","validationengine"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":291,"score":0,"question_id":9107993,"title":"How to enable conditionally validation using ValidationEngine","body":"<p>I am using ValidationEngine for client side validation. I have a scenario</p>\n\n<p>In my form I have 3 text box, now I want to validate \"required\" on all the field only if any one of them is filled, else I can proceed with blank form</p>\n\n<p>How do I do this using Jquery validationEngine </p>\n"},{"tags":["html","css","ruby-on-rails-3","textfield"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13078098,"title":"How can I change the length of a text_field in rails?","body":"<p>So I have this text field </p>\n\n<pre><code>&lt;%= f.text_field :body, placeholder: \"Make an offer \", :maxlength=&gt;\"254\" %&gt; \n</code></pre>\n\n<p>right now it takes up 100% of the width of the box it is in. I want it to take up like 95%. So far I have tried (from other forum posts)</p>\n\n<p>adding <code>:columns =&gt; \"50\"</code> this didn't affect it. I tried\nputting on an html tag , <code>:html =&gt; { :id =&gt; \"offer_form\" }</code> and then putting in my css file </p>\n\n<pre><code>#offer_form { width:50%;} \n</code></pre>\n\n<p>this didn't work</p>\n\n<p>any other suggestions?</p>\n\n<p>edit:</p>\n\n<p>I realized that in my css file I have under /<em>forms</em>/</p>\n\n<pre><code>input, textarea, select, .uneditable-input {\n  border: 1px solid #bbb;\n  width: 98%;\n  padding: 10px;\n  height: auto !important;\n  margin-bottom: 15px;\n\n}\n</code></pre>\n\n<p>and when i change the width here it works. but it affects all of the forms in the entire app (obviously)(ie they are all 98%). Is there a way that I can id just this field so that I can edit its width independently. </p>\n"},{"tags":["ruby-on-rails-3","asset-pipeline","basic-authentication","html5-appcache"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13075867,"title":"HTML5 Offline Application with Basic Authentication","body":"<p>I'm trying to get a Rails 3 project working offline using HTML5 Appcache and Rack::Offline. I am using Rails 3 Asset Pipeline which provides the added luxury of digests (application-dfla33q23jad.js) to keep the manifest files fresh. Theoretically, anytime an asset changes, the manifest will also change to include the new digested versions of the assets.</p>\n\n<p>(application.manifest)</p>\n\n<pre><code>CACHE MANIFEST\nassets/application-785189fec63978372c177135a521e081.js\nassets/application-c69de8169df1ae42a1a4dcafdc5a1af4.css\nassets/application.css\nassets/application.js\n</code></pre>\n\n<p>The new manifest is detected by the browser, and the new assets are cached in the background, but the html does not get updated to reflect the updated assets. It's almost as though all the assets get cached except for the master entry. Notice below how the js and css links do not have the same digest as the new version resulting in a 404 (Not Found) when refreshed.</p>\n\n<p>(index.html)</p>\n\n<pre><code>&lt;html manifest=\"/application.manifest\"&gt;\n&lt;head&gt;\n  &lt;title&gt;Project&lt;/title&gt;\n  &lt;link href=\"/assets/application-cb58254cec63978372c177135a521e081.js\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n  &lt;script src=\"/assets/application-918b26fdf1ae42a1a4dcafdc5a1af4.css\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;p&gt; Content &lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>My first thought to fix this was to add the html explicitly to the manifest so the html gets updated with the rest of the assets.</p>\n\n<pre><code>CACHE MANIFEST\nindex.html\nassets/application-785189fec63978372c177135a521e081.js\nassets/application-c69de8169df1ae42a1a4dcafdc5a1af4.css\nassets/application.css\nassets/application.js\n</code></pre>\n\n<p>I believe this would have worked but index.html is protected using basic authentication so a 401 (Unauthorized) error is thrown when trying to update the appcache. Which leads me to my questions:</p>\n\n<ol>\n<li>Shouldn't the appcache update the master entry (index.html) anytime the explicit entries get updated?</li>\n<li>Does the appcache provide a way to include entries that are protected using basic authentication? </li>\n<li>Shouldn't the appcache request use the same credentials the user entered to view the page in the first place?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":354,"score":0,"question_id":8532171,"title":"IP address format check","body":"<p>I am developing a <strong>Ruby on Rails</strong> application by using <strong>Ruby v1.8.7</strong> . My question is more about <strong>Ruby</strong> language.</p>\n\n<p>I know there is a build-in Ruby library named <a href=\"http://www.ruby-doc.org/stdlib-1.8.7/libdoc/ipaddr/rdoc/IPAddr.html\" rel=\"nofollow\">IPAddr</a> in <strong>Ruby v1.8.7</strong> . It handles IP address related issues well. But, seems it does not provide any method to check IP address format.</p>\n\n<p>Could someone provide me <strong>a good way to check IP address format</strong>(IPv4 and IPv6 addresses) in Ruby? Thank you.</p>\n\n<p><strong>P.S.</strong> </p>\n\n<p>I tried a regular expression way:</p>\n\n<pre><code>ip_regex = ^([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])\\\\.([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])\\\\.\n([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])\\\\.([01]?\\\\d\\\\d?|2[0-4]\\\\d|25[0-5])$\n\nip_addr='127.0.0.3'\nip_addr =~ ip_regex\n</code></pre>\n\n<p>But it does not work...</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ancestry"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13077705,"title":"Include a form _tag helper inside form_for and set errors on validation?","body":"<p>Here's the situation I've wound up in:</p>\n\n<ul>\n<li>I'm using the Ancestry gem</li>\n<li>I want a nested form with n number of children</li>\n<li>I want validation errors to show up with appropriate child fields wrapped in the error class</li>\n</ul>\n\n<p>I have a <code>Book</code> model that can have many child books (using ancestry)</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n    attr_accessible :title, :description\n    has_ancestry\nend\n</code></pre>\n\n<p>Now I want a form that lets you insert any number of new child books. I generated the model with scaffolding so the form partial is the generic <code>form_for(@book)...</code> in which I've added <code>&lt;%= render 'children_form' %&gt;</code></p>\n\n<pre><code>_children_form.rb\n\n&lt;% num = 0 %&gt;\n&lt;% @book.children.each do |child| %&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag \"children[#{num}][title]\", child.title %&gt;\n      &lt;%= text_field_tag \"children[#{num}][title]\", child.title %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"field\"&gt;\n      &lt;%= label_tag \"children[#{num}][description]\", child.description %&gt;\n      &lt;%= text_field_tag \"children[#{num}][description]\", child.description %&gt;\n    &lt;/div&gt;\n    &lt;% num += 1 %&gt;\n&lt;% end %&gt;\n\n.... more stuff for adding a new child book\n</code></pre>\n\n<p>I've taken care of all the logic in the controller for saving this. The relevant portion is probably just adding errors, which happens like so in the controller:</p>\n\n<pre><code>@book.errors.add \"children_#{num}_#{attr}\", message\n</code></pre>\n\n<p>The error gets printed at the top of the form (again, scaffolding in the form partial) but the actual fields and labels don't get wrapped in the <code>field_with_errors</code> class. I've deduced this is because <code>form_for</code> only works if <code>f.text_field</code> helpers are called. </p>\n\n<p>So, my immediate question is how do I associate these errors with a given input and label? And is that even possible since I'm mixing form_for and form_tag helpers? I know I could manually check through the errors and update the classes accordingly, but I'm hoping that can be avoided.</p>\n\n<p>The more interesting question is what is a better approach to getting nested forms working with ancestry? My current solution feels very hacky because <code>accepts_nested_attributes_for</code> does not work with ancestry. I also could not get a book to validate children within the book model due to ancestry limitations of being unable to associate models before they're saved.</p>\n"},{"tags":["ruby-on-rails-3","model","associations"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13057667,"title":"Display volunteers who have donations in past week","body":"<p>I am trying to display the volunteers who have received donations (gifts) in the last week.  A constituent (scoped to volunteers), through fund_solicitor_links, has funds, and through those funds have gifts.  How might I accomplish this?  Here are my models:</p>\n\n<pre><code>class Constituent &lt; ActiveRecord::Base\n  self.primary_key = :constituent_id\n  has_many :fund_solicitor_links\n  has_many :funds, :through =&gt; :fund_solicitor_links\n  scope :volunteers, joins(:funds)\nend\n\nclass FundSolicitorLink &lt; ActiveRecord::Base   # has fields constituent_id and fund_id\n  belongs_to :constituent\n  belongs_to :fund\nend\n\nclass Fund &lt; ActiveRecord::Base\n  self.primary_key = :fund_id\nend\n\nclass Gift &lt; ActiveRecord::Base\n  self.primary_keys = :gift_id, :fund_id\n  belongs_to :fund\n  belongs_to :constituent\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13077087,"title":"learning rails, trying to build blog categorization","body":"<p>I am working on building a blog with categorization. I am a bit stuck on how to implement categorization in the form. I have setup a has many through relationship and want to add check boxes to associate a blog with multiple categories. What I have so far is passing the categories through to the view, and I can list them out, however I cannot get the form_for method working for some reason.</p>\n\n<p>Here is my code.</p>\n\n<p>blog model</p>\n\n<pre><code>class Blog &lt; ActiveRecord::Base\n  attr_accessible :body, :title, :image\n  has_many :categorizations\n  has_many :categories, through: :categorizations\n  has_attached_file :image, :styles =&gt; { :medium =&gt; \"300x300&gt;\", :thumb =&gt; \"100x100&gt;\" }\n\n  validates :title, :body, :presence =&gt; true\n\nend\n</code></pre>\n\n<p>Category Model</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  has_many :categorizations\n  has_many :blogs, through: :categorizations\n  attr_accessible :name\nend\n</code></pre>\n\n<p>Categorization Model</p>\n\n<pre><code>class Categorization &lt; ActiveRecord::Base\n  attr_accessible :blog_id, :category_id\n  belongs_to :blog\n  belongs_to :category\nend\n</code></pre>\n\n<p>Blog new controller</p>\n\n<pre><code> def new\n    @blog = Blog.new\n    @categories = Category.all\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @blog }\n    end\n  end\n</code></pre>\n\n<p>Blog new form view</p>\n\n<pre><code>&lt;%= form_for(@blog, :url =&gt; blogs_path, :html =&gt; { :multipart =&gt; true }) do |f| %&gt;\n  &lt;% if @blog.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@blog.errors.count, \"error\") %&gt; prohibited this blog from being saved:&lt;/h2&gt;\n\n      &lt;ul&gt;\n      &lt;% @blog.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n   &lt;div class=\"field\"&gt;\n    &lt;%= f.file_field :image %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :body %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :body %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    Categories:\n    &lt;% @categories.each do |category| %&gt;\n      &lt;% fields_for \"blog[cat_attributes][]\", category do |cat_form| %&gt;\n        &lt;p&gt;\n          &lt;%= cat_form.check_box :name %&gt;\n        &lt;/p&gt;\n      &lt;% end %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This code is my failing point</p>\n\n<pre><code>&lt;% @categories.each do |category| %&gt;\n          &lt;% fields_for \"blog[cat_attributes][]\", category do |cat_form| %&gt;\n            &lt;p&gt;\n              &lt;%= cat_form.check_box :name %&gt;\n            &lt;/p&gt;\n          &lt;% end %&gt;\n        &lt;% end %&gt;\n</code></pre>\n\n<p>Although I am not positive I am approaching any of it right since I am currently learning. Any advice on how to accomplish this.</p>\n\n<p>Thanks,\nCG</p>\n"},{"tags":["ruby","ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13042182,"title":"2 fields in thinking_sphinx search","body":"<p>I have two fields that I am passing into thinking_sphinx, one is a dropdown, the other a free text.  </p>\n\n<pre><code>&lt;%= select :search, params[:search], Category.joins(:posts).select('distinct           categories.*').collect {|category| [ category.categoryname,category.categoryname ]}, :include_blank =&gt; 'Select a category...' %&gt;\n\n&lt;%= text_field_tag :resume, params[:resume] %&gt;\n</code></pre>\n\n<p>Its working with just the dropdown, but my syntax seems to be wrong to get the 2nd one to work.  </p>\n\n<pre><code>    @posts = Post.search :conditions=&gt;{:search=&gt;params[:search]},{:resume=&gt;params[:resume]}\n</code></pre>\n\n<p>I'm getting :  3: syntax error, unexpected '\\n', expecting tASSOC</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","installation","pdfkit"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":909,"score":1,"question_id":9757235,"title":"How to install PDFKit? (Rails 3.2.1 and PDFKit 0.5.2)","body":"<p>I'm trying to use PDFKit.</p>\n\n<p>It looks fairly straight forward so I'm trying to follow <a href=\"http://railscasts.com/episodes/220-pdfkit?autoplay=true\" rel=\"nofollow\">Ryan's Rails cast</a>.</p>\n\n<p>So I added the gem to my GemFile and updated my <code>application.rb</code> enter code here with:</p>\n\n<pre><code>config.middleware.use \"PDFKit::Middleware\"\n</code></pre>\n\n<p>After that I installed wkhtmltopdf on linux with:</p>\n\n<pre><code>apt-get install wkhtmltopdf\n</code></pre>\n\n<p>And I make sure it works:</p>\n\n<pre><code>[nicolas@Minto]%wkhtmltopdf www.google.com gogole.pdf\nLoading page (1/2)\nPrinting pages (2/2)                                               \nDone\n</code></pre>\n\n<p>Everything looks good until I try to add the .pdf on one of my pages...</p>\n\n<p>The website stays in a loading state forever. When I stop the server with a <code>Ctrl - C</code> in the console, I get the following error:</p>\n\n<pre><code>RuntimeError (command failed: \"/usr/bin/wkhtmltopdf\" \"--page-size\" \"Letter\" \"--margin-top\" \"0.75in\" \"--margin-right\" \"0.75in\" \"--margin-bottom\" \"0.75in\" \"--margin-left\" \"0.75in\" \"--encoding\" \"UTF-8\" \"--print-media-type\" \"--quiet\" \"-\" \"-\"):\n  pdfkit (0.5.2) lib/pdfkit/pdfkit.rb:71:in `to_pdf'\n  pdfkit (0.5.2) lib/pdfkit/middleware.rb:21:in `call'\n</code></pre>\n\n<p><strong>What I'm doing wrong?</strong></p>\n\n<p>Thank you very much for your help.</p>\n\n<p>Nicolas.</p>\n"},{"tags":["ruby","database","ruby-on-rails-3","database-design","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":41,"score":1,"question_id":13050831,"title":"Multiple has_one association to one polymorphic model","body":"<p>I have two models, <code>Address</code> and <code>User</code>:</p>\n\n<pre><code>class Address &lt; ActiveRecord::Base\n  belongs_to :resource, polymorphic: true\nend\n\nclass User &lt; ActiveRecord::Base\n  has_one :contact_address, class_name: \"Address\", as: :resource\n  has_one :billing_address, class_name: \"Address\", as: :resource\nend\n</code></pre>\n\n<p>Problem is if I create <code>billing_address</code> for <code>User</code> it will be automatically set as <code>contact_address</code>, since the <code>addresses</code> table doesn't specify a different <code>resource_type</code> (both are <code>User</code>).\nCan you give me some advice on how I should set up my models?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13073690,"title":"Rails implicit render in templates from multiple controllers","body":"<p>I have code like <code>render @posts</code> to render my posts collection in an index template which the <code>PostsController</code> renders.</p>\n\n<p>Now I have an <code>Admin::PostsController</code> that also should render the collection but when my posts controller renders <code>@posts</code> it looks for the <code>admin/posts/_post.html.erb</code> partial. Do I now have to write the partial path explicity? Is this feature by design or a bug? It doesn't seem to make sense.</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13075617,"title":"Rails 3.2.8 - How do I get the week number from Rails?","body":"<p>I would like to know how to get the current week number from Rails and how do I manipulate it: </p>\n\n<ol>\n<li>Translate the week number into date.</li>\n<li>Make an interval based on week number.</li>\n</ol>\n\n<p>Thanks.</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13072598,"title":"strategies for avoid mysql queries in rails","body":"<p>i have an app (rails 3) that basically is a social network for tv shows. So users can interact with each others and with tv_shows.</p>\n\n<p>What would be the best strategy to avoid quering the database (mysql) every time when showing users/tv_shows profiles pages?</p>\n\n<p>Ex: Inside a tv show profile page, i need to load a lot of information like seasons, episodes, actors etc. To do this a need to join several tables and is getting slower each day.</p>\n\n<p>My first thought was gether all information regarding any tv show and storage in just one table, so i dont need to make those joins every time. </p>\n\n<p>For sure i would have better performance but not best. I know that there are a lot of alternatives out there like memcache, redis even mongodb but what is the best approach to this case?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","unit-testing"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":42,"score":4,"question_id":13036641,"title":"Is it possible to have multiple fixture files per model in rails 3.2?","body":"<p>In Rails 3.2, is it possible to have multiple fixture files for a given ActiveRecord object? </p>\n\n<p>The client is requiring the test data be written in fixtures but also wants them to be manageable. I'd like to split up the fixtures a bit by introducing a 2nd set that the originals would include/require/render whatever. </p>\n\n<p>I haven't been able to find anything via Google on how to do it and fixtures are not my cup of tea. Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","heroku","dns","routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13074734,"title":"Heroku/Rails route example.com to mydomain.com/example","body":"<p>My rails app is a way for users to create their own basic website.  So each of them will have a root folder that is mydomain.com/user/1.  They will have other pages like mydomain.com/user/1/about etc.  How do I configure rails and heroku so that something like www.user1.com points to mydomain.com/user/1, and something like www.user1.com/about directs to mydomain.com/user/1/about?  </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","prawn"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13074355,"title":"Download multiple files with rails","body":"<p>I'm currently using PRAWN with latest release of rails and I can't figure out how to download multiple files with a single HTTP request. in my controller I have the following code:</p>\n\n<pre><code>Fill PDF with my stuffs...\nPDF.render_file \"foo.pdf\"\nsend_file(\"foo.pdf\")\n</code></pre>\n\n<p>And it download correctly the file but - if after that - I put another istance of the same code...it will execute only the last one, foo2</p>\n\n<pre><code>PDF.render_file \"foo.pdf\"\nsend_file(\"foo.pdf\")\nPDF.render_file \"foo.pdf\"\nsend_file(\"foo2.pdf\")\n</code></pre>\n\n<p>Moreover, If at end...I wish to render another view, I can't do it. </p>\n\n<p>Question is: </p>\n\n<p>How can I download 2 different files in a single action inside controller and, finally, render a view?</p>\n"},{"tags":["ruby-on-rails-3","authentication","devise"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":269,"score":1,"question_id":5632628,"title":"Previous user picked up with auth_token login in Devise","body":"<p>Here's my scenario.</p>\n\n<p>First, I log in as Alice:\n<a href=\"http://localhost:3000/?auth_token=eMXBk8cuJMA1ETZfMIgB\" rel=\"nofollow\">http://localhost:3000/?auth_token=eMXBk8cuJMA1ETZfMIgB</a>\nThen, without logging out, I log in as Bob:\n<a href=\"http://localhost:3000?auth_token=Z9Ui7Cw_xCnOmGWOEUEH\" rel=\"nofollow\">http://localhost:3000?auth_token=Z9Ui7Cw_xCnOmGWOEUEH</a></p>\n\n<p>What happens is, after the second GET request, I'm still logged in as Alice, not Bob.\nIf I do a <a href=\"http://localhost:3000/users/sign_out\" rel=\"nofollow\">http://localhost:3000/users/sign_out</a> in between the two auth_token logins, everything's OK.\nWithout the sign_out, Bob can't login using his token.</p>\n\n<p>Is this a bug, or the way things should be due to some security issues I'm ignorant of?\nCan this behavior be overriden through hooks?</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3","carrierwave"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":13049633,"title":"rails carrierwave / s3 signature doesn't match. Wrong private key","body":"<p>I'm trying to get carrierwave working with S3, and I am getting a signature doesn't match error.  The weird thing is that it doesn't look like carrierwave is sending the right secret key.  In the error, the post is given as:</p>\n\n<pre><code>\"Authorization\"=&gt;\"AWS AKIAIOLWQKSJFH6E3I5Q:vKgyAw2z4c8zzqGWoxLUbw7I5oI=\"\n</code></pre>\n\n<p>Which I assume is supposed to be my publickey:privatekey.  The thing is that vKgyAw2z4c8zzqGWoxLUbw7I5oI= is not the private key I have stored in fog.rb.  Is that right?  </p>\n\n<p>Any help is appreciated. </p>\n\n<p>Request/Response:</p>\n\n<pre><code> request =&gt; {:chunk_size=&gt;1048576, :connect_timeout=&gt;60, :headers=&gt;{\"Content-Length\"=&gt;1557, \"Content-Type\"=&gt;\"image/\ngif\", \"x-amz-acl\"=&gt;\"public-read\", \"Date\"=&gt;\"Wed, 24 Oct 2012 12:45:17 +0000\", \"Authorization\"=&gt;\"AWS AKIAIOLWQKSJFH6E3\nI5Q:vKgyAw2z4c8zzqGWoxLUbw7I5oI=\", \"Host\"=&gt;\"s3.amazonaws.com:443\"}, :instrumentor_name=&gt;\"excon\", :mock=&gt;false, :nonb\nlock=&gt;true, :read_timeout=&gt;60, :retry_limit=&gt;4, :ssl_ca_file=&gt;\"/home/tim/.rvm/gems/ruby-1.9.3-p194/gems/excon-0.16.5\n/data/cacert.pem\", :ssl_verify_peer=&gt;true, :write_timeout=&gt;60, :host=&gt;\"myeasybnb.s3.amazonaws.com\", :host_port=&gt;\"s3.\namazonaws.com:443\", :path=&gt;\"/images%2Fb1bb6639-dc08-4981-9a9b-7175093ac970.gif\", :port=&gt;\"443\", :query=&gt;nil, :scheme=\n&gt;\"https\", :body=&gt;#&lt;File:/home/tim/Dropbox/myeasybnb/tmp/uploads/20121024-0845-20225-1170/240x240.gif&gt;, :expects=&gt;200\n, :idempotent=&gt;true, :method=&gt;\"PUT\"}\n  response =&gt; #&lt;Excon::Response:0xa7a1098 @body=\"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\\n&lt;Error&gt;&lt;Code&gt;SignatureD\noesNotMatch&lt;/Code&gt;&lt;Message&gt;The request signature we calculated does not match the signature you provided. Check your\n key and signing method.&lt;/Message&gt;\n</code></pre>\n\n<p>fog.rb:</p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               =&gt; 'AWS',       # required\n    :aws_access_key_id      =&gt; 'AKIAIOLWQKSJFH6E3I5Q',       # required\n    :aws_secret_access_key  =&gt; '[my secret key]'      # required\n\n  }\n  config.fog_directory  = 'myeasybnb'                             # required\n  config.fog_public     = true                                   # optional, defaults to true\n\nend\n</code></pre>\n\n<p>Uploader.rb: </p>\n\n<pre><code># encoding: utf-8\n\nclass PhotoUploader &lt; CarrierWave::Uploader::Base\n\n\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  # Include the Sprockets helpers for Rails 3.1+ asset pipeline compatibility:\n   include Sprockets::Helpers::RailsHelper\n   include Sprockets::Helpers::IsolatedHelper\n\n  # Choose what kind of storage to use for this uploader:\n  # storage :file\n   storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"images\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\nclass MyUploader &lt; CarrierWave::Uploader::Base\n  def default_url \n     asset_path(\"seeds/\" + [version_name, \"default.png\"].compact.join('_'))\n  end\nend\n\n  # Process files as they are uploaded:\n  # process :scale =&gt; [200, 300]\n  #\n\n\n  # Create different versions of your uploaded files:\n\n  process :convert =&gt; 'jpg'\n  version :sidecarousel, :if =&gt; :is_side_carousel? do\n      process :resize_to_fit =&gt; [2000,1000]\n  end\n    version :thumbnail, :if =&gt; :is_thumbnail? do\n       process :resize_to_fill =&gt; [240,240]        \n    end\n\n    version :linetext, :if =&gt; :is_line? do\n         process :resize_to_fill =&gt; [400,200]\n    end\n    version :carousel, :if =&gt; :is_carousel? do\n      process :resize_to_fit =&gt; [2200, 1000]\n    end  \n\n    version :phone do\n      process :resize_to_fit =&gt; [900,900]\n    end\n  # def scale(width, height)\n  #   # do something\n  # end\n\n\n\n\n  def is_side_carousel? photo\n    model.location == 1\n  end\n\n  def is_thumbnail? photo\n  model.location == 2\n  end\n  def is_line? photo\n    model.location == 3\n  end\n  def is_carousel? photo\n    model.location == 4\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n\n\n  # Override the filename of the uploaded files:\n  # Avoid using model.id or version_name here, see uploader/store.rb for details.\n def filename\n    file.nil? ?  @filename = nil : @filename = \"#{secure_token}.#{file.extension}\" \n\n\n end \n\n    def secure_token\n    var = :\"@#{mounted_as}_secure_token\"\n    model.instance_variable_get(var) or model.instance_variable_set(var, SecureRandom.uuid)\n  end\n  def cache_dir\n\"#{Rails.root}/tmp/uploads\"\nend\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rounding-error"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13074090,"title":"Rails 3 Float Rounding Error","body":"<p>Running ruby 1.8.7.  </p>\n\n<p>(1.005 * 100).round\nresult:  100</p>\n\n<p>(1.006 * 100).round\nresult:  101</p>\n\n<p>100.5.round\nresult: 101</p>\n\n<p>(1.005 * 100)\nresult: 100.5</p>\n\n<p>What is going on here?  Can someone try this in the latest version of ruby please? \nThanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sql-update","find-and-replace"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13072791,"title":"Can't find a row in my table sqlite3 table","body":"<p>I'm trying to set up a simple edit feature for an object in one of my tables.  Here is my current code which I've seen online and in books but it doesn't work</p>\n\n<pre><code>def edit\n    @fire_chief = FireChief.find(params[:id])\n end\n</code></pre>\n\n<p>All I have to do is figure out how to edit a specific Fire Chief in list view and I can keep programming, but I'm stuck.</p>\n\n<p>The error I'm recieving is \"Couldn't find FireChief without an ID\"</p>\n\n<p>If I use this little snippet of code it finds the edit form fine</p>\n\n<pre><code>def edit\n    @fire_chief = FireChief.last\n end\n</code></pre>\n\n<p>But it always pulls up the last entry to be edited.  I need it to pull the entry that i click...might be the 1st, 3rd, or 5th, etc.  I know a lot of this is redundant, but I just want to be clear on what I'm trying to do.</p>\n\n<p>This is my routes file:</p>\n\n<pre><code>resource :timesheet do\n    resource :command_officer\n    resources :fire_chief\n    resources :fire_fighters\n    resource :safety_officer\n    resources :emts\n    resources :hazmat_specialists\n    resources :command_vehicles\n    resources :engines\n    resources :emergency_supports\n    resources :hazmat_units\n    resources :field_units\n    resources :pumpers\n    resources :tankers\n    resources :rescue_units\nend\nend\n</code></pre>\n\n<p>I just changed the resource :fire_chief to be plural, so now its this resources :fire_chief</p>\n\n<p>But I'm getting this error now:</p>\n\n<p>Routing Error</p>\n\n<p>uninitialized constant FireChiefController</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","gem","paperclip"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13073107,"title":"I want to understand how the Paperclip gem handles s3 down time","body":"<p>I hope that this question does not have an extremely simple answer that I have completely overlooked.  </p>\n\n<p>My question is how does the paperclip gem handle s3 down time?  What is the flow if a user uploads an asset and s3 is not responding due to it becoming unavailable.  The specifics; I am using paperclip 2.7 gem with rails 3.  I tried looking through the documentation and tests but could not see that this was being handled.  If s3 downtime is not being handled by the paperclip gem what is the best practice for me to handle it in my model.  Ideally I don't want a save to occur and an error to be transmitted to the user.</p>\n\n<p>How have others handled this?</p>\n\n<p>Any insight into this will be helpful,</p>\n\n<p>Slan</p>\n"},{"tags":["ruby-on-rails-3","activeadmin","formtastic"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12703987,"title":"How to display only the value in edit page in Active Admin","body":"<p>I have a edit form in Active Admin. I need some field as read only. </p>\n\n<p>My current edit page is like</p>\n\n<p><img src=\"http://i.stack.imgur.com/u3f6z.png\" alt=\"enter image description here\"></p>\n\n<p>I need the page look like this</p>\n\n<p><img src=\"http://i.stack.imgur.com/XFAXS.png\" alt=\"enter image description here\"></p>\n\n<p>How can this be done. My code for the edit form page is like</p>\n\n<pre><code>    form :html =&gt; { :enctype =&gt; \"multipart/form-data\" } do |f|  \n      f.inputs \"Users\" do\n        f.input :device, :label =&gt; 'Device', :as =&gt; :select, :collection =&gt; DEVICE, :include_blank =&gt; false\n        f.input :current_address, :label =&gt; 'Current Address', :as =&gt; :string\n      end\n    end\n</code></pre>\n\n<p>Please help.</p>\n"},{"tags":["ruby-on-rails-3","internationalization","activeadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13072416,"title":"Translation text editor gem with active admin integration","body":"<p>I want to be able to edit rails 3 translations using <a href=\"http://activeadmin.info/\" rel=\"nofollow\">activeadmin</a>, I've seen that <a href=\"https://github.com/grosser/fast_gettext\" rel=\"nofollow\">fast_gettext</a> looks like a good option with it's database backend setup. However as far as I can tell it doesn't integrate into activeadmin without a bunch of work to have it setup nicely.</p>\n\n<p>Are there any alternatives that would integrate more easily with activeadmin? Ideally there would be an easy way to switch between the different languages available.</p>\n"},{"tags":["ruby-on-rails-3","json","rest","activemodel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12485404,"title":"How to implement multiple different serializers for same model using ActiveModel::Serializers?","body":"<p>Let's say you're implementing a REST API in Rails.  When serving a collection, you might want to only include a few attributes:</p>\n\n<pre><code>/people\n</code></pre>\n\n<p>But when serving a single resource, you want to include all the attributes:</p>\n\n<pre><code>/people/1\n</code></pre>\n\n<p>I don't see how to do that using ActiveModel::Serializers, since the examples all use the pattern of defining one serializer per model (with a standard naming convention) and having AMS automatically use the right one in the controller when you do:</p>\n\n<pre><code>render json: @people\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>render json: @person\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","acts-as-taggable-on"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":49,"score":-1,"question_id":13023670,"title":"Acts as taggable on Rails","body":"<p>How can I make an index route/action to see all the tags that I've created!, I'm using the gem at <a href=\"https://github.com/mbleigh/acts-as-taggable-on\" rel=\"nofollow\">https://github.com/mbleigh/acts-as-taggable-on</a></p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email-integration"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":13016965,"title":"\"Unsubscribe\" for email categories/types through Sendgrid, Mailchimp, SES","body":"<p>I've got a Rails 3.2 app that will need to send various transactional &amp; bulk (marketing) types of emails. Ideally I'd be able to use a service (like Sendgrid or Amazon SES) to improve deliverability and for unsubscribe support. I've mostly used Sendgrid in the past, but I need the 'unsubscribe' to be just for a specific category of the email (there are around 6 categories). I can't have someone unsubscribing from a marketing email and miss out on notification or invitation emails. Does anyone know of an service that supports this, or does this just have to be done internally? It seems like there's a lot to deal with related to best practices for deliverability, list-unsubscribe, etc. if you manage it yourself. </p>\n\n<p>I see this discussion on sendgrid, but seems to be pending still:\n<a href=\"http://community.sendgrid.com/sendgrid/topics/unsubscribe_and_categories\" rel=\"nofollow\">http://community.sendgrid.com/sendgrid/topics/unsubscribe_and_categories</a></p>\n\n<p>I'm happy to go with any service if it integrates relatively easily with Rails and can support category/type based subscription management. Or perhaps a hybrid approach with different services or separate accounts on the same service, if they allow that for the same domain? </p>\n\n<p>I very much appreciate any feedback on how others have tackled this.</p>\n\n<p>Thanks! </p>\n"},{"tags":["ruby-on-rails-3","datetime","view","dry","helper"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":13071531,"title":"Tidiest way of highlighting record if older than X days?","body":"<p>What is the tidiest DRY way in a Rails 3 application of highlighting a table row depending on its age?</p>\n\n<pre><code>&lt;% @faults_open.each do |fault| %&gt;\n  &lt;tr&gt;\n    &lt;td&gt;&lt;%= fault.name %&gt;&lt;/td&gt;  \n    &lt;td&gt;&lt;%= fault.faulttype %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= fault.priority %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= time_ago_in_words(fault.created_at) %&gt; ago&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', fault %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I would like a class applied to the table row with an indication of its age which I can then style using CSS.</p>\n\n<pre><code>&lt;% @faults_open.each do |fault| %&gt;\n  &lt;tr &lt;% if fault.created_at &gt; Date.1.week.ago %&gt;class=\"weekold\"&lt;% end %&gt;&gt;\n    &lt;td&gt;&lt;%= fault.name %&gt;&lt;/td&gt;  \n    &lt;td&gt;&lt;%= fault.faulttype %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= fault.priority %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= time_ago_in_words(fault.created_at) %&gt; ago&lt;/td&gt;\n    &lt;td&gt;&lt;%= link_to 'Show', fault %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Something like the above but obviously adding them to the view would be messy. I plan on adding a couple of ages, such as:</p>\n\n<pre><code>weekold\ntwoweeksold\nmonthold\nsixmonthold\nyearold\nancient\n</code></pre>\n\n<p>I imagine a helper is the tidiest way, but I'm unsure on how the helper would work. Any pointers would be appreciated.</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13058228,"title":"How to select appropriate Association in Rails?","body":"<p>I'm trying to learn Rails by creating a very simple application which just creates a website where someone can create a list of authors and books with an association that the book is written by an author. I was hoping this would be simple and DRY, but I've been having an unexpected amount of trouble with it.</p>\n\n<p>First looking at my models, I've set up the association and made every data point required (author.name, book.title, and book.author). I do not want to add :author or :author_id to the attr_accessible lists because I want to use the appropriate Rails conventions.</p>\n\n<p>app/models/author.rb:</p>\n\n<pre><code>class Author &lt; ActiveRecord::Base\n  attr_accessible :name\n  validates_presence_of :name\n  has_many :books\nend\n</code></pre>\n\n<p>app/models/book.rb:</p>\n\n<pre><code>class Book &lt; ActiveRecord::Base\n  attr_accessible :title\n  validates_presence_of :title\n  belongs_to :author\n  validates_associated :author\nend\n</code></pre>\n\n<p>The books controller and view I think is exactly from the scaffolding and very uninteresting. What is interesting is the books controller. Looking at the new method, all I did was add a collector which gets the array of author names with ids to pass to the view. (Honestly, I think I would prefer to not pass the id at all.)</p>\n\n<p>app/controllers/books_controller.rb</p>\n\n<pre><code>  # GET /books/new\n  # GET /books/new.json\n  def new\n    @book = Book.new\n    @authors = Author.all.collect {|a| [a.name, a.id]}\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @book }\n    end\n  end\n</code></pre>\n\n<p>Now over to the views, I used the default new.html.haml, but made changes to _form.html.haml. I added a select field using the values in @authors.</p>\n\n<p>app/views/books/_form.html.haml</p>\n\n<pre><code>= form_for @book do |f|\n  - if @book.errors.any?\n    #error_explanation\n      %h2= \"#{pluralize(@book.errors.count, \"error\")} prohibited this book from being saved:\"\n      %ul\n        - @book.errors.full_messages.each do |msg|\n          %li= msg\n\n  .field\n    = f.label :name\n    = f.text_field :name\n  .field\n    = f.label :author\n    = f.select(:author, @authors, {:include_blank =&gt; \"\"})\n .actions\n    = f.submit 'Save'\n</code></pre>\n\n<p>Lastly, back to my controller for the create method. I try to save the basic parameters and create an author association from the selected author.</p>\n\n<p>app/controllers/books_controller.rb</p>\n\n<pre><code>  # POST /books\n  # POST /books.json\n  def create\n    @book = Book.new(params[:book])\n    @book.author = Author.find_by_id(params[:author])\n\n    respond_to do |format|\n      if @book.save\n        format.html { redirect_to @book, notice: 'Book was successfully created.' }\n        format.json { render json: @book, status: :created, location: @book }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @book.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>When I click 'Save' I get the following error:</p>\n\n<pre><code>Can't mass-assign protected attributes: author\n</code></pre>\n\n<p>I understand that this is because the value I selected was put in params[:book] instead of params[:author]. So I have two questions.</p>\n\n<p>1) How do I fix my select statement to have it send in params[:author] instead of params[:book]?</p>\n\n<p>2) Is there an even better way to do this that completely hides the id association?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","reserved-words"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13064434,"title":"creating a model with name \"import\" is it reserved word in rails 3?","body":"<p>having all kind of strange stuff happening with a model and form named \"import\"\nis this a reserved word in rails somehow? I could not find it in some old webposts on reserved words in rails.</p>\n\n<p>EDIT:\nSome code example to Illustrate, seem to be unable to pinpoint the problem</p>\n\n<p>Works:</p>\n\n<pre><code>- @profile = Profile.new\n  = form_for @profile, :method =&gt; :get,  :html =&gt; { :class =&gt; 'form-horizontal' } do |f|\nthrows error # embed raw\n</code></pre>\n\n<p>Fails:</p>\n\n<pre><code>- @import = Import.new\n  = form_for @import, :method =&gt; :get,  :html =&gt; { :class =&gt; 'form-horizontal' } do |f|\n</code></pre>\n\n<p>With error:</p>\n\n<pre><code>undefined method `imports_path' for #&lt;#&lt;Class:0x007fe4e0369468&gt;:0x007fe4e25410e0&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rest"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":226,"score":1,"question_id":9843294,"title":"Search action in ReSTful rails model","body":"<p>So, I'm quite new to Rails and still working my way through the principles. I suppose like most people, I have started creating that basic CRUD. Okay. Done.</p>\n\n<p>Now I want a new action: search. As it turns out, it is not one of the 7 rest sacred (!) actions (if got it right). While I know I could implement new custom actions and resource it and everything, I read in a few places to try my best to stick to the standard ones as long as possible. Okay. What would be the correct way?</p>\n\n<p>Again a few sources like <a href=\"http://www.slideshare.net/calamitas/restful-best-practices\" rel=\"nofollow\">this guy</a> suggest thinking of my scenarios in therms of <strong>nouns</strong>, case in which seems I'd need a \"search\" controller...? It just doesn't convince me that I'd have to create a whole class whereas I'd normally do <code>def search</code> just to keep it ResTful. </p>\n\n<p>What did I get wrong? What would be the common solution here?</p>\n\n<p>thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rails-admin"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":12,"score":1,"question_id":13070784,"title":"Fail to integrate CKeditor in rails_admin gem (use gem rich)","body":"<p>I follow the link <a href=\"https://github.com/bastiaanterhorst/rich#readme\" rel=\"nofollow\">GitHub gem rich</a> to install CKeditor to rails_admin\nbut I get the error: <code>Unsupported field datatype: rich_editor</code></p>\n\n<p>My model </p>\n\n<pre><code>edit do\n        field :title\n        field :description, :rich_editor do\n          config({\n            :insert_many =&gt; true\n          })\n        end\n        field :autho\n        field :book_type\n      end\n</code></pre>\n\n<p>How can I fix this error? Or that's an issue?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":257,"score":0,"question_id":6580252,"title":"What about peepcode?","body":"<p>I would like to watch some Rails video tutorials. Browsing on the web, I found the site <code>peepcode.com</code>. I would like to know more about the testing of a Rails app (Cucumber, Rspec and so on). I would also like to extend my experience buying more Rails' general videos to keep me up to date. Peepcode  sells video tutorials for $12 per video. I don't have a problem with  $12 but I would like to know if somebody already had experience on the site and tell me more about its quality.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","performance","where"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":47,"score":2,"question_id":13054759,"title":"Rails efficiency of where clause","body":"<p>I'm worried about the efficiency of this line in the controller of my Rails project</p>\n\n<pre><code>posts_list = Post.where(:title =&gt; params[:title])\n</code></pre>\n\n<p>If the number of \"Posts\" in the database grows, will the line become slow to execute? Is there any possible optimization?</p>\n"},{"tags":["ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":13070025,"title":"managing complex JSON","body":"<p>I have a complex input JSON, something like this:</p>\n\n<pre><code>@json = {\"project\":\"bla\",\n    \"analysis\": {\"id\":\"123\",\"title\":\"Test\"}, \n    \"data\":{\"axis\": {\"name\":\"column\", \"label\":\"demo\",\"values\": [\"one\", \"two\"]},\n           \"series\": [{\"label\":\"text\", \"values\":[\"1\", \"2\", \"3\"]}, \n                    {\"label\":\"text2\", \"values\":[\"4\", \"5\", \"6\"]}\n]}}\n</code></pre>\n\n<p>(more complex and length that this example)</p>\n\n<p>two question:</p>\n\n<ol>\n<li><p>it exists a RoR method that can delete on the fly something in the json? something like\n<code>@json.destroy['analysis']</code> that eliminate only the \"analysis\" key-value couple?</p></li>\n<li><p>how can i navigate (for example) in the values of the series? I can do if the json is simple with a <code>do each</code>, but here must I do a concecation of <code>do each</code>?</p></li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":13070164,"title":"Optimizing activerecord queries for displaying attendees of an event","body":"<p>I'm currently hacking on an events site and have never had a problem optimizing queries/scaling my db in the past as there was never that much data, but now there's almost a million rows in the db and it's taking ~15,000 m/s to render a feed of events, in particular the partial (within each _event.html.erb) that's really slow is where all the users that youre currently following that are attending that event are displayed. I've looked up a lot of possibilities to improve performance including eager loading, indexing, memcache, etc...but was wondering how this can be rewritten to perform faster? Thank you!</p>\n\n<p>_attending.html.erb</p>\n\n<pre><code>&lt;% if user_signed_in? %&gt;\n        &lt;% @rsvp = Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going') %&gt;\n        &lt;% if @rsvp.count == 0 %&gt;\n            &lt;%= eventcount(event) %&gt; going.\n        &lt;% elsif @rsvp.count == 1 %&gt;\n            &lt;% if eventcount(event) - 1 == 0 %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; is going.\n                &lt;% end %&gt;\n            &lt;% else %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and &lt;%= eventcount(event) - 1 %&gt; going.\n              &lt;% end %&gt;\n            &lt;% end %&gt;\n        &lt;% elsif @rsvp.count == 2 %&gt;\n            &lt;% if eventcount(event) - 2 == 0 %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and\n                &lt;% end %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; are going.\n                &lt;% end %&gt;\n            &lt;% else %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n              &lt;% end %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and &lt;%= eventcount(event) - 2 %&gt; going.\n              &lt;% end %&gt;\n                &lt;% end %&gt;\n        &lt;% elsif @rsvp.count == 3 %&gt;\n            &lt;% if eventcount(event) - 3 == 0 %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n                &lt;% end %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;, and\n                &lt;% end %&gt;\n                &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[2..2].each do |f| %&gt;\n                    &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; are going.\n                &lt;% end %&gt;\n            &lt;% else %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[0..0].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n              &lt;% end %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[1..1].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt;,\n              &lt;% end %&gt;\n              &lt;% Rsvp.where(:voter_id =&gt; current_user.following, :event_id =&gt; event.id, :status =&gt; 'going')[2..2].each do |f| %&gt;\n                  &lt;%= link_to User.find(f.voter_id).name, User.find(f.voter_id).slug %&gt; and &lt;%= eventcount(event) - 3 %&gt; are going.\n              &lt;% end %&gt;\n            &lt;% end %&gt;\n            &lt;% end %&gt;\n    &lt;% else %&gt;\n        &lt;%= eventcount(event) %&gt; going.\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Schema for RSVP</p>\n\n<pre><code>create_table \"rsvps\", :force =&gt; true do |t|\n  t.string    \"status\"\n  t.integer   \"event_id\"\n  t.integer   \"voter_id\"\n  t.string    \"voter_name\"\n  t.string    \"voter_type\"\n  t.timestamp \"created_at\", :null =&gt; false\n  t.timestamp \"updated_at\", :null =&gt; false\nend\n\nadd_index \"rsvps\", [\"voter_id\", \"voter_type\", \"event_id\"], :name =&gt; \"fk_one_rsvp_per_user_per_entity\", :unique =&gt; true\nadd_index \"rsvps\", [\"voter_id\", \"voter_type\"], :name =&gt; \"index_rsvps_on_voter_id_and_voter_type\"\n</code></pre>\n\n<p>Schema for Relationship</p>\n\n<pre><code>create_table \"relationships\", :force =&gt; true do |t|\n  t.integer   \"follower_id\"\n  t.integer   \"followed_id\"\n  t.timestamp \"created_at\",  :null =&gt; false\n  t.timestamp \"updated_at\",  :null =&gt; false\nend\n\nadd_index \"relationships\", [\"followed_id\"], :name =&gt; \"index_relationships_on_followed_id\"\nadd_index \"relationships\", [\"follower_id\"], :name =&gt; \"index_relationships_on_follower_id\"\n</code></pre>\n\n<p>Relevant part of User model</p>\n\n<pre><code>has_many :relationships, :foreign_key =&gt; \"follower_id\",\n:dependent =&gt; :destroy\n\nhas_many :following, :through =&gt; :relationships, :source =&gt; :followed\n\nhas_many :reverse_relationships, :foreign_key =&gt; \"followed_id\",\n       :class_name =&gt; \"Relationship\",\n       :dependent =&gt; :destroy\nhas_many :followers, :through =&gt; :reverse_relationships, :source =&gt; :follower\n</code></pre>\n"},{"tags":["ruby-on-rails-3","apache","ubuntu","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":129,"score":0,"question_id":10506959,"title":"Passenger crashes, hangs at apache start","body":"<p>On a fresh installation of Ubuntu, with Ruby/Rails/RVM with Apache via Passenger, apache will come up on a clean reboot, but crash at the first request to the Rails app.</p>\n\n<p>I have done all of this many times before ... except RVM installed in multi-user mode.</p>\n\n<p>It seems like maybe there's some library conflict?</p>\n\n<p>Details below.</p>\n\n<ul>\n<li>64-bit Ubuntu 11.10 installation</li>\n<li>created a release user, and group</li>\n<li>uninstall the default apache, ruby, passenger (sudo apt-get remove ...)</li>\n<li>installed RVM using the system version (multiple users) </li>\n<li>installed ruby 1.9.3p194 using RVM (installed as the release user)</li>\n<li>add release user to group <code>rvm</code></li>\n<li>ruby and gems are under /usr/local/rvm/ and are all in group <code>rvm</code> and readable</li>\n<li>install apache2 and various supporting libraries (<code>sudo apt-get install apache2</code>)</li>\n<li>add apache2 user (<code>www-data</code>) to group <code>rvm</code></li>\n<li>install passenger from gem (<code>gem install passenger</code>)</li>\n<li>use passenger to make passenger module (<code>passenger-install-apache2-module</code>). No errors.</li>\n<li>configure apache to load the correct module (under /usr/local/rvm...)</li>\n<li>configure apache to reference the correct PassengerRoot and PassengerRuby</li>\n<li>note: this is all without any reference to the Rails app</li>\n<li>start apache (<code>sudo apache2ctl start</code>) ... this hangs</li>\n</ul>\n\n<p>Apache error.log shows</p>\n\n<pre><code>[ pid=1303 thr=140033289561952 file=ext/apache2/Hooks.cpp:1389 time=2012-05-07 19:54:15.497 ]: Initializing Phusion Passenger...\n[ pid=1303 thr=140033289561952 file=ext/apache2/Hooks.cpp:1664 time=2012-05-07 19:54:15.536 ]: Shutting down Phusion Passenger...\n[ pid=1312 thr=140533444790112 file=ext/common/LoggingAgent/Main.cpp:283 time=2012-05-07 19:54:15.537 ]: Logging agent online, listening at unix:/tmp/passenger.1.0.1303/generation-0/logging.socket\n</code></pre>\n\n<p>In other words, passenger terminates moments after it starts.  <code>/var/log/syslog</code> shows a stack dump for PassengerWatchd.</p>\n\n<p>I tried running passenger in standalone mode.  Nada.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13059514,"title":"How to remove characters from tsv file during parsing?","body":"<p>I am parsing a tsv file and loading it into MySQL. I got this to work then found there are back slashes in the tsv file that are being interpreted as line breaks. I would like to remove the \\ from all fields before the data is sent to the database. This is a shortened example, there are 300 columns in the file and many of them will be blank.</p>\n\n<pre><code>begin              \n  CSV.foreach(file, :col_sep =&gt; \"\\t\") do |row|\n      row.map!{ |e| e.gsub(/\\\\/, '')} \n      d = Datafeed.new\n      d.id = row[0]\n      d.description = row[1]\n      d.save!\n  end\nend\n</code></pre>\n\n<p>When I run this example, I get an error: undefined method `gsub' for nil:NilClass. I think this error is being generated by blanks in the file. However, when I try adding </p>\n\n<pre><code>row.map!{ |e| unless e.blank e.gsub(/\\\\/, '') } \n</code></pre>\n\n<p>it will not execute and I get an error for an unexpected }.</p>\n\n<p>Is this the right direction to eliminate the back slashes? What is the best approach?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":13069871,"title":"Increasing counter in database","body":"<p>I have field called ads_counter in my database, and i need to increase its value each time when this ad is rendered.\nI tried to write custom method and use it in controller which responsible for this data, but that didnt work. Is there any built in methods to increase value in field in database?</p>\n"},{"tags":["mysql","ruby-on-rails-3","api","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13018635,"title":"Ignore modules from Model","body":"<p>I have in my application a few controllers that i want to use as a api. In this api i need to use versioning.</p>\n\n<p>in my <code>routes.rb</code> i`m using this:</p>\n\n<pre><code>require 'api_constraints'\n</code></pre>\n\n<p>(...)</p>\n\n<pre><code>  scope '/:target/:version', :module =&gt; :api, :constraints =&gt; { :version =&gt; /[0-z\\.]+/ } , :defaults =&gt; { :format =&gt; 'json' } do\n    scope :module =&gt; :v1, :constraints =&gt; ApiConstraints.new(:version =&gt; 1, :default =&gt; true) do\n      match '/list' =&gt; 'sample#list'\n    end\n  end\n</code></pre>\n\n<p>my <code>api_constraints.rb</code>:</p>\n\n<pre><code>class ApiConstraints\n\n  def initialize(options)\n    @version = options[:version]\n    @default = options[:default]\n  end\n\n  def matches?(req)\n    @default || req.headers['Accept'].include?(\"application/waytaxi.api.v#{@version}\")\n  end\n\n  def self.version\n    @version\n  end\n\nend\n</code></pre>\n\n<p>in my <code>SampleController.rb</code>:</p>\n\n<pre><code>module Api\n  module V1\n    class SampleController &lt; ApiBaseController\n\n      def list\n        render json: Model.find_by_id(params[:id])\n      end\n\n    end    \n  end\nend\n</code></pre>\n\n<p>the <code>ApiBaseController</code>:</p>\n\n<pre><code>module Api\n  class ApiBaseController &lt; ApplicationController\n    before_filter :authenticate\n    skip_before_filter :verify_authenticity_token\n\n  private\n\n    def authenticate\n      # if params[:target] == \"ios\"\n      #   render :json =&gt; {status: 404}\n      #   return false        \n      # end\n    end\n  end  \nend\n</code></pre>\n\n<p>the problem is:</p>\n\n<p>whenever i try to call <code>Model</code> i get this error:</p>\n\n<pre><code>uninitialized constant Api::V1::SampleController::Model\n</code></pre>\n\n<p>If i use: <code>::Model</code> i get this error:</p>\n\n<pre><code>uninitialized constant Model\n</code></pre>\n\n<p>And yes, i do have this models on my database. If i use <code>Model.all</code> outside the <code>SampleController</code> i get the objects.</p>\n\n<p>Please i need help, urgent help</p>\n\n<p>P.S.: I'm using rails 3.2.8</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache2","phusion-passenger"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":1,"view_count":31,"score":-1,"question_id":13069059,"title":"Why this error occurred my server is not started and site is down?","body":"<p>In my rails application, I am using</p>\n\n<pre><code>Apache + ruby 1.9.2p180 + Rails 3.0.5 + Phusion Passenger version 3.0.13\n</code></pre>\n\n<p>Here is my error</p>\n\n<blockquote>\n  <p>This application process is currently running as user 'nobody' and group 'nobody' and must be able to access its application root directory '/home/mystore /mystore '. However the parent directory '/home/mystore ' has wrong permissions, thereby preventing this process from accessing its application root directory. Please fix the permissions of the directory '/home/mystore ' first. </p>\n</blockquote>\n\n<p>and when i look into my app it's empty but my database got the sample from spree. whats seems to be the problem? </p>\n\n<p>Please somebody help me </p>\n\n<p>I am using \nruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","jquery-ajax","ajax-on-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13069256,"title":"undefine method submit_to_remote","body":"<pre><code>&lt;%= submit_to_remote(:category, :url =&gt; params[:id].blank? ? {:action =&gt; 'create'} : {:action =&gt; \"update\", :id =&gt; @category}) do %&gt;\n    &lt;table&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n\n        &lt;/tr&gt;\n\n        &lt;tr&gt;\n            &lt;td&gt;&lt;%= text_field(:category, :name, :size =&gt; 20) %&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;%= submit_tag(params[:id].blank? ? \"New\": \"Edit\") %&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to create new record using Ajax. I got <strong>error undefined method submit_to_remote</strong> I declared prototype file in layout. \n                  waiting for ans....... </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13068487,"title":"Rails: pass has_many or belongs_to attribute in 'generate' command","body":"<p>I'm trying to make a scaffold but want to pass a has_many attribute to the generate command as follows:</p>\n\n<pre><code>rails generate scaffold grade name:string {has_many :sections}\n</code></pre>\n\n<p>This generates the broken model:</p>\n\n<pre><code>class Grade &lt; ActiveRecord::Base\n  attr_accessible :, :name, :{has_many\nend\n</code></pre>\n\n<p>instead of what i need:</p>\n\n<pre><code>class Grade &lt; ActiveRecord::Base\n  attr_accessible :name\n  has_many :sections\nend\n</code></pre>\n\n<p>How can i pass a relationship attribute to the generate command?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13062534,"title":"if cancan access is denied it displays an error page or movie to another page, how to stay on same page?","body":"<p>I have used cancan and i have used</p>\n\n<pre><code>rescue_from CanCan::AccessDenied do |exception|  \n  flash[:error] = \"Access denied!\"  \n  redirect_to root_url  \nend  \n</code></pre>\n\n<p>in my application controller but i want to stay on the same page where i perform that action and if possible a pop up window  just showing </p>\n\n<p><code>you are not authorised to perform this action</code></p>\n\n<p>How to customize so as to stay in the same page wherever the unauthorized action is performed? please help me doing this.</p>\n"},{"tags":["ruby","ruby-on-rails-3","foreman","god"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13056164,"title":"how to make foreman start god","body":"<p>I have a Procfile like this:</p>\n\n<pre><code>web: bundle exec unicorn -c config/unicorn.rb -E production\ngod: god -c services.god\n</code></pre>\n\n<p>but <code>foreman start god</code> doesn't start...it's just say this:</p>\n\n<pre><code>17:14:32 god.1  | started with pid 29506\n17:14:32 god.1  | exited with code 0\n17:14:32 system | sending SIGTERM to all processes\nSIGTERM received\n</code></pre>\n\n<p>if I run <code>god -c services.god</code>, all services run fine...<br>\nAny ideas?<br>\nThanks </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache2","phusion-passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":333,"score":1,"question_id":6213129,"title":"Apache + passenger or passenger_standalone","body":"<p>I have an environment where my app is running on multiple machines on mongrel and is getting load balanced by Apache. I am switching mongrel to passenger. Would passenger standalone be a better idea or Apache+passenger on every machine? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13065130,"title":"Rails write a csv file column wise","body":"<p>I like to export a dataset from my rails application as a csv file using the builtin csv library of rails. Usually a csv file is written row wise like in my example below which comes from my datasets_controller.rb:</p>\n\n<pre><code>require 'csv'\n\ndataset = Dataset.find(6)\ndataset_headers = dataset.datacolumns.collect { |dc| dc.columnheader }\n\ncsv_file = CSV.generate do  |csv|                                                                                                           \n   csv &lt;&lt; dataset_headers\nend\n</code></pre>\n\n<p>And now my question is if I could also write my csv files column wise like this?</p>\n\n<pre><code>require 'csv'    \n\ndataset_columns = Datacolumn.all(:conditions =&gt; [\"dataset_id = ?\", 6], :order =&gt; \"columnnr ASC\").uniq \n\ncsv_file = CSV.generate do  |csv|                                                                                                           \n   csv &lt;&lt; \"here put one after another all my data columns\"\nend\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Based on Douglas suggestion I came up with the colde below.</p>\n\n<pre><code> data_columns=Datacolumn.all(:conditions =&gt; [\"dataset_id = ?\", dataset.id], :order =&gt; \"columnnr ASC\").uniq\n\n    CSV.generate do |csv|\n        value=Array.new \n        data_columns.each do |dc|\n          value &lt;&lt; dc.columnheader\n          dc.sheetcells.each do |sc|\n            if sc.datatype &amp;&amp; sc.datatype.is_category? &amp;&amp; sc.category \n              value &lt;&lt; sc.category.short\n            elsif sc.datatype &amp;&amp; sc.datatype.name.match(/^date/) &amp;&amp; sc.accepted_value\n              value &lt;&lt; sc.accepted_value.to_date.to_s\n            elsif sc.accepted_value\n              value &lt;&lt; sc.accepted_value\n            else\n              value &lt;&lt; sc.import_value\n            end \n          end \n          csv &lt;&lt; value\n          value = Array.new \n        end \n      end \n</code></pre>\n\n<p>The output is not transposed for this case and looks like this:</p>\n\n<pre><code>height,10,2,&lt;1,na\nfullauthor,Fortune,(Siebold &amp; Zucc.) Kuntze,Fortune,(Siebold &amp; Zucc.) Kuntze\nYear,1850,1891,1850,1891\nfullname,Mahonia bealei,Toxicodendron sylvestre,Mahonia bealei,Toxicodendron sylvestre\n</code></pre>\n\n<p>But when I change the line which writes the csv to</p>\n\n<pre><code>csv &lt;&lt; value.transpose\n</code></pre>\n\n<p>I get an error which tells me that it could not convert a string to array to do that.\nAnybody an Idea how to fix this?</p>\n\n<p>Any help with this would be appreciated.</p>\n\n<p>Best Claas</p>\n"},{"tags":["ruby","ruby-on-rails-3","html5","cramp","eventsource"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":13064323,"title":"Real time updates through Cramp(Ruby) and SSE(HTML5)","body":"<p>I have prepared a sample application to get updates from server in real time using <a href=\"http://cramp.in/\" rel=\"nofollow\">Cramp(Ruby)</a> and <a href=\"http://www.html5rocks.com/en/tutorials/eventsource/basics/\" rel=\"nofollow\">SSE(HTML5)</a>.</p>\n\n<p>I am getting following errors while accessing the html through <code>http://localhost/sse_time.html</code></p>\n\n<pre><code>Errors:\nChrome:\n  Uncaught Error: SECURITY_ERR: DOM Exception 18 sse_time.html:9\n  Uncaught TypeError: Cannot read property 'key-preview' of undefined \n\nFirefox:\n  Error: The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must to be declared in the document or in the transfer protocol.\nLine: 0\n\n  Error: The connection to http://localhost:3000/time was interrupted while the page was loading.\n  Line: 9\n</code></pre>\n\n<p><strong>sse_time.html</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n&lt;h1&gt;Getting server updates&lt;/h1&gt;\n&lt;div id=\"result\"&gt;&lt;/div&gt;\n&lt;script&gt;\n  if (!!window.EventSource) {\n\n    var source = new EventSource('http://localhost:3000/time');\n\n    source.addEventListener('message', function(e) {\n      console.log(e.data);\n    }, false);\n\n    source.addEventListener('open', function(e) {\n      // Connection was opened.\n      console.log('Connection was opened.');\n    }, false);\n\n    source.addEventListener('error', function(e) {\n      if (e.readyState == EventSource.CLOSED) {\n        // Connection was closed.\n        console.log('Connection was closed.');\n      }\n    }, false);\n\n  } else {\n    document.getElementById(\"result\").innerHTML=\"Sorry, your browser does not support server-sent events...\";\n  }\n&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>app/actions/time_action.rb</strong></p>\n\n<pre><code>class TimeAction &lt; Cramp::Action\n  self.transport = :sse\n\n  periodic_timer :send_latest_time, every: 5\n\n  def send_latest_time\n    render \"Current time : #{Time.now}\"\n  end\nend\n</code></pre>\n\n<p>where <code>line 9</code> is <code>var source = new EventSource('http://localhost:3000/time');</code></p>\n\n<p>If I hit <code>http://localhost:3000/time</code> in chrome, it shows time after each 5 seconds without any errors.</p>\n\n<p>However with PHP code it works fine replacing URI <code>http://localhost:3000/time</code> with <code>stream.php</code> in <code>sse_time.html</code></p>\n\n<p><strong>stream.php</strong></p>\n\n<pre><code>&lt;?php\nheader('Content-Type: text/event-stream');\nheader('Cache-Control: no-cache'); // recommended to prevent caching of event data.\n\n/**\n * Constructs the SSE data format and flushes that data to the client.\n *\n * @param string $id Timestamp/id of this connection.\n * @param string $msg Line of text that should be transmitted.\n */\nfunction sendMsg($id, $msg) {\n  echo \"id: $id\" . PHP_EOL;\n  echo \"data: $msg\" . PHP_EOL;\n  echo PHP_EOL;\n  ob_flush();\n  flush();\n}\n\n$serverTime = time();\n\nsendMsg($serverTime, 'server time: ' . date(\"h:i:s\", time()));\n</code></pre>\n\n<p>Here <code>stream.php</code> and <code>sse_time.html</code> resides at same locaation.</p>\n\n<p>Would anyone please guide me to fix this issue?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":67,"score":0,"question_id":13047877,"title":"Reset password link asks user to sign in","body":"<p>I am using devise for authentication. When forgot password is called it asks for mail address and it sends a link to the mail, but when I click on the link in the mail I get: </p>\n\n<blockquote>\n  <blockquote>\n    <p>You need to sign in or sign up before continuing.</p>\n  </blockquote>\n</blockquote>\n\n<p>How can I change this so that when clicking on the link it asks for a new password?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I have changed my routes as follows:</p>\n\n<pre><code>devise_for :users do\n  resources :users, :only =&gt; [:index, :new, :create, :edit, :update, :destroy] \nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":13055753,"title":"Passing variables inside rails internationalization yml file","body":"<p>I want to use variables declared in yml file right there.\nFor example, I declared <code>site_name</code> and want to use it below in <code>description</code>.</p>\n\n<pre><code>en:\n  site_name: &amp;site_name \"Site Name\"\n  static_pages:\n    company:\n      description: *site_name #this works fine\n      description: \"#{*site_name} is an online system\" #this doesn't work\n</code></pre>\n\n<p>How can I combine <code>*site_name</code> variable with additional text?</p>\n"},{"tags":["sql","ruby-on-rails-3","activerecord","arel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13067573,"title":"Arel: How to write attr = NULL in arel speak?","body":"<p>I have an issue with arel: I want to force something like \"attr = NULL\" using Arel. Arel allows me to do something like this:</p>\n\n<pre><code>table = obj.arel_table # obj has attr\ntable[:attr].eq(nil) # returns ''objs'.'attr' IS NULL'\n</code></pre>\n\n<p>this is fair, since in queries this is the right thing to do. But on updates, I want to be able to set something to NULL, and preferably without having to write the SQL myself (update_all from AR doesn't support ARel-like functionality on collections: objs.things.update_all(:created_at => nil). this breaks). I'm trying basically to do that code block inside the update_all call recurring to arel and to_sql functionalities. Can this be possible? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13066922,"title":"rails_admin javascript error when toggle add_filter menu","body":"<p>I found this html for <strong>add_filter</strong> menu:</p>\n\n<pre><code>&lt;li class=\"dropdown\" style=\"float:right\"&gt;\n  &lt;a class=\"dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"&gt;\n    Add filter\n    &lt;b class=\"caret\"&gt;&lt;/b&gt;\n  &lt;/a&gt;\n&lt;ul class=\"dropdown-menu\" id=\"filters\" style=\"left:auto; right:0;\"&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Title\" data-field-name=\"title\" data-field-options=\"\" data-field-type=\"string\" data-field-value=\"\" href=\"#\"&gt;Title&lt;/a&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Book type\" data-field-name=\"book_type\" data-field-options=\"\" data-field-type=\"string\" data-field-value=\"\" href=\"#\"&gt;Book type&lt;/a&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Category\" data-field-name=\"category\" data-field-options=\"\" data-field-type=\"belongs_to_association\" data-field-value=\"\" href=\"#\"&gt;Category&lt;/a&gt;\n  &lt;/li&gt;\n  &lt;li&gt;\n    &lt;a data-field-label=\"Detail\" data-field-name=\"detail\" data-field-options=\"\" data-field-type=\"text\" data-field-value=\"\" href=\"#\"&gt;Detail&lt;/a&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p><img src=\"http://i.stack.imgur.com/ShESZ.png\" alt=\"Addfilter\"></p>\n\n<p>When I click on Add Filter the console logs:</p>\n\n<p><code>Uncaught TypeError: Object [object Object] has no method 'tooltip'</code> </p>\n\n<ul>\n<li>When I create a new empty project and install rails_admin gem, it works.</li>\n<li>My project is using bootstrap for css and js.</li>\n</ul>\n\n<p>Please give me some advice for this issue.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","templates","erb","partial"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":13067089,"title":"Passing markup into a Rails Partial","body":"<p>Is there any way of doing something equivilant to this:</p>\n\n<pre><code>&lt;%= render partial: 'shared/outer'  do %&gt;\n    &lt;%= render partial: 'shared/inner' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Resulting in</p>\n\n<pre><code>&lt;div class=\"outer\"&gt;\n    &lt;div class=\"inner\"&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Obviously there would need to be a way of marking up 'shared/outer.html.erb' to indicate where the passed in partial should be rendered:</p>\n\n<pre><code>&lt;div class=\"outer\"&gt;\n     &lt;% render Here %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>In my specific case I have a generic page header, consisting of a header and subheader, that is shared across all pages, but would like the option of passing in page-specific markup to that header to be rendered below the title and subtitle.</p>\n"},{"tags":["ruby-on-rails-3","oauth","salesforce"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13067140,"title":"Trying to access Salesforce throuth Rails with OAuth and getting a 404 error","body":"<p>I think my title sets up the context fairly well.  Here is my controller code:</p>\n\n<pre><code>  def sign_in_salesforce\n    consumer = OAuth::Consumer.new(ENV['JETWAY_SALESFORCE_CONSUMER_KEY'], ENV['JETWAY_SALESFORCE_CONSUMER_SECRET'], :site =&gt; 'https://login.salesforce.com/services/OAuth/c/17')\n    request_token = consumer.get_request_token\n    session[:request_token] = request_token\n    redirect_to request_token.authorize_url\n  end\n</code></pre>\n\n<p>I keep getting a 404 error back after I try to get_request_token.  I am new to OAuth and want to know the direction I should go in trying to debug.  Any help would be great.  Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view-helpers"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":1,"view_count":27,"score":1,"question_id":13066891,"title":"Custom caption text for file_field helper","body":"<p>Is it possible to provide your own caption for the button that the file_field helper generates?</p>\n"},{"tags":["ruby-on-rails-3","routing","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12792377,"title":"Rails 3 Route Nesting","body":"<p>My Rails app routing looks something like this:</p>\n\n<pre><code>match 'Events/New' =&gt; 'event#new'\nmatch 'Events/:date' =&gt; 'event#show', :date =&gt; /[A-Z][a-z]{2}-\\d{2}-\\d{4}/\nmatch 'Events/:date/Venue' =&gt; 'event#venue', :date =&gt; /[A-Z][a-z]{2}-\\d{2}-\\d{4}/\nmatch 'Events/:date/Speakers' =&gt; 'event#speakers', :date =&gt; /[A-Z][a-z]{2}-\\d{2}-\\d{4}/\n</code></pre>\n\n<p>Is there some way to nest this and clean it up?  I suspect it's running the regex on :date multiple times, while nesting could theoretically make it run once.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":26,"score":1,"question_id":13050152,"title":"Rails 3 virtual attributes not saving","body":"<p>I have a model with virtual attributes:</p>\n\n<pre><code>attr_accessible :published_at\n\ndef published_at_text\n  I18n.localize(published_at, format: :long_no_day_with_seconds) if published_at\nend\n\ndef published_at_text=(text)\n  self.published_at = Chronic.parse(text)\nend\n</code></pre>\n\n<p>This works fine in the unit tests, but does not save when the published_at_text field is changed in the view. I've tried using <code>attr_accessible :published_at_text</code>, and adding <code>published_at_will_change!</code> to the setter method, but I can't get this to work.</p>\n\n<p>The <code>development.log</code> shows that the changed value of published_at_text is being passed in, but adding a call to Rails.logger in the setter seems to indicate that it's not even getting called.</p>\n\n<p>What am I missing here?</p>\n"},{"tags":["ruby","ruby-on-rails-3","web-services","http","video"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":13029666,"title":"HTTP Video Streaming in Rails 3+","body":"<p>I need some help with the below:</p>\n\n<p>Ok the scenario is this: I am contacting a server and from the server I am getting this URI:</p>\n\n<pre><code>http://&lt;camera_ip_address&gt;/&lt;type_ID&gt;/&lt;part_ID&gt;\n</code></pre>\n\n<p>The documentation of this webservice says:</p>\n\n<pre><code>\"The part_ID will vary from part_start and part_end.\"\n</code></pre>\n\n<p>I got all the data needed. Now what I dont get is how this is related to HTTP video streaming?</p>\n\n<p>If I have part_start = 1 and part_end = 10, that means that I will \"download\" 10 frames?\nHow? with curl? wget? Rails?</p>\n\n<p>Should a loop be implemented like (example):</p>\n\n<pre><code>for i=1; i&lt;10 i++\n   download \"http://127.0.0.1/34/i\"\nend\n</code></pre>\n\n<p>What will \"http://127.0.0.1/34/10\" for example be? a png/jpeg frame file?\nAny help will be very useful. Thanks very much.</p>\n"},{"tags":["ruby-on-rails-3","devise","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13051669,"title":"Passing params through omniauth and facebook connect","body":"<p>I am trying to pass a params to omniauth callback but I am having issues.\nWhen the user choose to signup onto my website he has to choose if he is an adult on a teen then the signup form is displayed. If he choose to go with with facebook connect, after he click on facebook connect the signup form is displayed on the callback page but with all the field filled with his info except for the password.\nI would also like to retrieve his adult/teen choice but don't really know how to do it.\nI am using devise with omniauthable and here is what I did :</p>\n\n<p>Facebook Connect link :</p>\n\n<pre><code>&lt;%= link_to image_tag(\"connect-w-facebook.jpg\", alt: \"Connect with Facebook\"),      omniauth_authorize_path(:user,:facebook,{var: 'adult'}), :id =&gt;\"logo\", :class =&gt;'connect-face- img'  %&gt;\n</code></pre>\n\n<p>So I hard coded the variable for now to test how it's working.\nOn my callback page I have :</p>\n\n<pre><code>  &lt;%= debug request.env['omniauth.auth'] %&gt;\n  &lt;%= debug request.env['omniauth.params'] %&gt;\n</code></pre>\n\n<p>These two are nul and don't display anything except --- ... for these two field...\nThanks,</p>\n"},{"tags":["ruby","ruby-on-rails-3","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":649,"score":3,"question_id":8176104,"title":"How do you handle serialized edit fields in an Active Admin resource?","body":"<p>I have a model, <code>Domain</code>, which has a text field, <code>names</code>. </p>\n\n<pre><code>&gt; rails g model Domain names:text\n  invoke  active_record\n  create    db/migrate/20111117233221_create_domains.rb\n  create    app/models/domain.rb\n&gt; rake db:migrate\n==  CreateDomains: migrating ==================================================\n-- create_table(:domains)\n   -&gt; 0.0015s\n==  CreateDomains: migrated (0.0066s) =========================================\n</code></pre>\n\n<p>I set this field as <strong>serialized</strong> into an array in the model. </p>\n\n<pre><code># app/models/domain.rb\nclass Domain &lt; ActiveRecord::Base\n  serialize :names, Array\nend\n</code></pre>\n\n<p>Create the ActiveAdmin resource for this model</p>\n\n<pre><code>&gt; rails g active_admin:resource Domain\n    create  app/admin/domains.rb\n</code></pre>\n\n<p>then, in the app/admin/domains.rb, I setup the various blocks to handle the serialized field as such</p>\n\n<pre><code># app/admin/domains.rb\nActiveAdmin.register Domain do\n\n  index do\n    id_column\n    column :names do |domain|\n      \"#{domain.names.join( \", \" ) unless domain.names.nil?}\"\n    end\n    default_actions\n  end\n\n  show do |domain|\n    attributes_table do\n      row :names do\n        \"#{domain.names.join( \", \" ) unless domain.names.nil?}\"\n      end\n    end\n  end\n\n  form do |f|\n    f.inputs \"Domain\" do\n      f.input :names\n    end\n    f.buttons\n  end\n\n  # before we save, take the param[:domain][:name] parameter,\n  # split and save it to our array\n  before_save do |domain|\n    domain.names = params[:domain][:names].split(\",\") unless params[:domain].nil? or params[:domain][:names].nil?\n  end\nend\n</code></pre>\n\n<p>Nearly everything works great -- my names are displayed as comma separated in the index and show views. When I update a record with my names field set to \"a,b,c\", the before_save works to turn that into an array that is then saved via the ActiveRecord serialize.</p>\n\n<p>What I can not solve is how to make the edit form put in a comma-separated list into the text field. I tried using a partial and using formtastic syntax directly as well as trying to make it work via the active_admin DLS syntax. Does anyone know how to make this work?</p>\n\n<p><strong>Specifically, if I have the following array saved in my domain.names field:</strong></p>\n\n<pre><code># array of names saved in the domain active_record\ndomain.names = [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p><strong>how to change:</strong></p>\n\n<pre><code>      form do |f|\n        f.inputs \"Domain\" do\n          f.input :names\n        end\n        f.buttons\n      end\n</code></pre>\n\n<p><strong>so that when the <code>edit</code> form is loaded, in the text field instead of seeing <code>abc</code>, you see <code>a,b,c</code>.</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","passenger","phusion-passenger"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":13063234,"title":"What are the main reasons for passenger server shut down periodically?","body":"<p>In my rails application, I am using </p>\n\n<p><code>Apache + ruby 1.9.2p180 + Rails 3.0.5 + Phusion Passenger version 3.0.13</code> </p>\n\n<p>Can somebody please tell me why my passenger shut down periodically. Somebody please help </p>\n\n<pre><code>This is the last error after which the application stops working\n\n[Fri Aug 31 02:07:23 2012] [error] [client 141.212.121.10] Premature end \nof script headers: \n[ pid=17952 thr=1 file=ext/apache2/Hooks.cpp:817 time=2012-08-31 \n02:07:23.257 ]: The backend application (process 13680) did not send a \nvalid HTTP response; instead, it sent nothing at all. It is possible \nthat it has crashed; please check whether there are crashing bugs in \nthis application. \n[Fri Aug 31 04:20:55 2012] [notice] child pid 27795 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:20:56 2012] [notice] child pid 22071 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:21:03 2012] [notice] child pid 13025 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:21:04 2012] [notice] child pid 24538 exit signal \nSegmentation fault (11) \n[Fri Aug 31 04:21:06 2012] [notice] child pid 17065 exit signal \nSegmentation fault (11)\n\nI am using \nruby 1.9.2p180 \nRails 3.0.5 \nPhusion Passenger version 3.0.13\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","routing","rails-routing"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13064844,"title":"Rails routing - :on => :collection","body":"<p>The rails routing guide doesn't specify what <code>:on =&gt; :collection</code> means..</p>\n\n<p>I cannot find an explanation to what the :on key is what is a :collection in that context</p>\n"},{"tags":["ruby-on-rails-3","exception-handling","error-handling","custom-error-pages"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":241,"score":2,"question_id":10316675,"title":"Exception notifier - how to display own error pages?","body":"<p>I use <strong>exception_notification</strong> gem for handling an errors in an app.\nMy <strong>ApplicationController</strong> looks like this:</p>\n\n<pre><code>unless Rails.application.config.consider_all_requests_local\n    rescue_from Exception,\n                :with =&gt; :render_error\n    rescue_from ActiveRecord::RecordNotFound,\n                :with =&gt; :render_not_found\n    rescue_from ActionController::RoutingError,\n                :with =&gt; :render_not_found\n    rescue_from ActionController::UnknownController,\n                :with =&gt; :render_not_found\n    rescue_from ActionController::UnknownAction,\n                :with =&gt; :render_not_found\n  end\n\n  def render_not_found(exception)\n    ExceptionNotifier::Notifier\n      .exception_notification(request.env, exception)\n      .deliver\n    render :template =&gt; \"/errors/404.html.erb\",\n      :layout =&gt; 'errors.html.erb'\n    return     \n  end\n\n  def render_error(exception)\n    ExceptionNotifier::Notifier\n      .exception_notification(request.env, exception)\n      .deliver\n    render :template =&gt; \"/errors/500.html.erb\",\n           :layout =&gt; 'errors.html.erb'\n    return\n  end\n</code></pre>\n\n<p>In <strong>/config/enviroments/productions.rg</strong> in the end of the file I have:</p>\n\n<pre><code>config.middleware.use ExceptionNotifier,\n  :email_prefix =&gt; \"[MY APP| Error Report] \",\n  :sender_address =&gt; %{\"MY APP\" &lt;err@my-app.com&gt;},\n  :exception_recipients =&gt; 'my_email@gmail.com'\nend\n</code></pre>\n\n<p>I have two problems:</p>\n\n<ol>\n<li><p>when I get the error on the app - eg. <code>Article.find(not-existing-ID)</code>, I'll get the standard error page (ERROR 500) from <code>/public/500.html</code> and not from the file specified  in application controller... How is that possible? Past hours I tried to find the problem, but I still don't know the issue.</p></li>\n<li><p>when I set to the url un-existing page, I get the error number 404 - but in this case I don't get the email notification about this problem. Is there any way to handle that? And the second thing, again is displayed the standard error 404 page, not the page from <code>/errors/404.html.erb</code></p></li>\n</ol>\n\n<p>Could anyone give me some advice, how to solve these problems?</p>\n"},{"tags":["ruby-on-rails-3","heroku","safari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":10773897,"title":"Safari can't get HEROKU's cookie","body":"<p>I am sorry that I am not able to provide much info because I totally have no idea about this weird problem.</p>\n\n<p>I have a fb canvas app which is written by rails 3.2.2 .</p>\n\n<p>There is not any problem on my local machine (Mac OS X 10.7.4).</p>\n\n<p>When I deploy it to heroku, it is fine with chrome and firefox. However, when I use Safari to browse it, Safari can't get any cookie from heroku. (it shows \"This site has no cookies\" in developer tool, but it works well on my local machine.)</p>\n\n<p>I have googled this problem, and I get something like <a href=\"http://viget.com/extend/rails-sessions-not-working-with-safari-a-solution\" rel=\"nofollow\">this</a> and <a href=\"http://www.litespeedtech.com/support/forum/showthread.php?t=2037\" rel=\"nofollow\">this</a>, but I don't think these are the case of mine.</p>\n\n<p>any suggestion?</p>\n\n<p>If you need any specific info about my code to solve this problem, please let me know.</p>\n\n<p>I will appreciate it very very much!!</p>\n"},{"tags":["ruby-on-rails-3","nginx","rvm","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":34,"score":0,"question_id":13063778,"title":"Error installing Phusion Passenger","body":"<p>I've been trying to install Phusion Passenger on my Centos VPS hosting a rails 3 app but I keep getting the following error: </p>\n\n<pre><code>Installing Phusion Passenger Standalone...\n[********************************             ] Preparing Nginx... \\           \nchecking for OS\n + Linux 2.6.18-238.12.1.el5xen x86_64\nchecking for C compiler ... found but is not working\n\n./configure: error: C compiler gcc is not found\n</code></pre>\n\n<p>I've followed all the instructions from <a href=\"http://stackoverflow.com/questions/12770501/c-compiler-gcc-not-found-while-installing-passenger-and-nginx/12998464#12998464\">here</a> but it doesn't seem to make any difference. Among other things I've tried is downloading the nginx-1.2.3 source and compiling them manually using a different source directory and they compile and install correctly. But when I try to run passenger start from my rails app, it will trigger the installation all over again. Running nginx -v does show it as installed. Any help would be appreciated ! I'm running Ruby 1.9.2.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","exception"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13063433,"title":"undefined method `is_current' for #<ActiveRecord::Relation:0x38622a8> in ruby on rails update data","body":"<p>I'm trying to update some data in database but I'm getting this error:</p>\n\n<pre><code>undefined method `is_current' for #&lt;ActiveRecord::Relation:0x38622a8&gt;\n</code></pre>\n\n<p>My controller:</p>\n\n<pre><code>@user = User.where(\"user_id = #{user_id} and is_current = 1\") \n\nif @user.nil?\n  puts\"xxxxxxxxxxxxxxxxxxxxxxxxxxx\"\nelse \n  @user.is_current = 0\n  @user.to = Time.now\n  @user.save\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","oop","class"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13061001,"title":"Ruby on Rails 3: Toggle Boolean with Forms","body":"<p>Users are able to send each other messages on my Ruby app.  The table is as followed:</p>\n\n<pre><code>t.string   \"content\"\nt.integer  \"from_id\"\nt.integer  \"reply_to_id\"\nt.boolean  \"read\",       :default =&gt; false\n</code></pre>\n\n<p>I have recently added the boolean, :read, and I have the form linked to messages in their inbox.  When they click \"Mark Read\" (the link provided via the form) I want it to toggle :read => true.  </p>\n\n<p>I am currently unable to accomplish this.  This is my current setup.</p>\n\n<pre><code>_mark_read.html.erb\n  &lt;%= form_for(:message, :mark_read =&gt; {read: true}) do |f| %&gt;\n    &lt;div&gt;&lt;%= f.hidden_field :read %&gt;&lt;/div&gt;\n    &lt;%= f.submit \"Mark Read\", class: \"btn-link\" %&gt;\n  &lt;% end %&gt;\n\nClass MessagesController &lt; ApplicationController\n  def mark_read\n    @message = current_user.messages.build\n    @message.toggle!(:read)\n  end\n\nconfig/routes.rb\n match '/mark_read' =&gt; 'messages#mark_read', :via =&gt; :post, :as =&gt; :mark_read\n</code></pre>\n\n<p>When I click \"Mark Read\", here is my debug info:</p>\n\n<pre><code>--- !ruby/hash:ActiveSupport::HashWithIndifferentAccess\nutf8: ✓\nauthenticity_token: ---\nmessage: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n  read: 'false'\ncommit: Mark Read\ncontroller: static_pages\naction: connect\n</code></pre>\n\n<p>I can see it is not even using my controller... and even so; I don't think I have it set up correctly.</p>\n\n<p>Any advise as to how this should be set up would be kindly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","paypal","ipn"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":13008814,"title":"Rails PayPal IPN notify_url is not called","body":"<p>So, I have a router with global IP address (Yeah, I know it will NOT work with the local ones, like 192.168.xx.xx) address and I've triple checked that it IS accessible from the outside. </p>\n\n<p>I'm currently working in the sandbox environment.</p>\n\n<p>I have all my payment options in the hidden :encrypted field (see appropriate railscast) that are being posted to PayPal. On the PayPal side everything is running pretty much smooth - I complete my payment and so on, but IPN is never called. There is simply no log-entry for my action being triggered (no errors/warnings or whatsoever), however there should be at least something.  </p>\n\n<p>I've tried to pass the notify_url 2 ways: 1) in the options hash in my purchase model, before being encrypted to :encrypted field; <code>:notify_url =&gt; notify_url</code> 2) notify_url as a separate hidden field explicitly => <code>&lt;%= hidden_field_tag :notify_url, notify_url %&gt;</code> 3) Combination of pts 1 and 2.</p>\n\n<p>But it is hopeless - nothing seems to be working. :(  </p>\n\n<p>I have also tried to enabling the IPN in my sandbox business account settings, but that didn't do any help either.</p>\n\n<p>What should I do in this situation ? </p>\n\n<p>P.S I have also tried out the IPN Simulator service, and it seems to be working. What is wrong with it then ? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","deployment","nginx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13049096,"title":"Changes made in rails app /public directory not reflecting on server","body":"<p>I have an replica of the live app that is deployed on the server. I have made some changes: like inserted 2 css and js files in /public directory that serves my assets and included in the views where they are required .It is working fine on my Local machine but when I pushed the changes to the server it is not reflecting over there. I am Using Nginx and I have tried restarting it as well but it didn't help either. \nAs I am new to NGINX and the App is deployed on a centos I dont know how it works. \nI already have precompiled assets, So I don't know how to make it run. I have tried </p>\n\n<blockquote>\n  <p>Clearing the cache from tmp directory but didn't work.</p>\n</blockquote>\n\n<p>I have set my </p>\n\n<blockquote>\n  <p>config.serve_static_assets = false</p>\n</blockquote>\n\n<p>in my production.rb and tried restarting but didn't work either</p>\n\n<p>Any help ??</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":1,"view_count":26,"score":0,"question_id":13062063,"title":"Run rails application without installing rails gem","body":"<p>Is it possible to run a rails application without installing rails gem in your system.?? If yes, please provide me some reference for it. </p>\n"}]}
{"total":34675,"page":12,"pagesize":100,"questions":[{"tags":["ruby-on-rails-3","capistrano","bundler","dreamhost"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":181,"score":1,"question_id":9913308,"title":"Deploying Rails on dreamhost shared server","body":"<p>Im trying to deploy my Rails app on dreamhost shared server. Been following this article </p>\n\n<p><a href=\"http://railstips.org/blog/archives/2008/12/14/deploying-rails-on-dreamhost-with-passenger/\" rel=\"nofollow\">http://railstips.org/blog/archives/2008/12/14/deploying-rails-on-dreamhost-with-passenger/</a></p>\n\n<p>But in the last step ,  </p>\n\n<pre><code>cap deploy:migrations\n</code></pre>\n\n<p>i get this error</p>\n\n<pre><code>Could not find rake-0.9.2.2 in any of the sources \n</code></pre>\n\n<p>First time I am trying to deploy rails app ever so im pretty lost..</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capistrano"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":972,"score":2,"question_id":9573614,"title":"rails / capistrano - error compiling assets","body":"<p>When I deploy with capistrano I get an error (and rollback) when capistrano attempts to run assets:precompile.</p>\n\n<p>I'm using rails 3.2.1, bundler 1.0.22, capistrano 2.11.2</p>\n\n<p>If I run rake assets:precompile from /webapps/myapp/current it runs successfully.</p>\n\n<p>error:</p>\n\n<pre><code>failed: \"sh -c 'cd /webapps/myapp/releases/20120304160347 &amp;&amp; bundle exec rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'\"\n</code></pre>\n\n<p>deploy.rb</p>\n\n<pre><code>require \"bundler/capistrano\"\nload 'deploy/assets'\nset :application, \"myapp\"\nset :domain, '24.17.71.95'\nset :repository,  \".\" \nset :deploy_via, :copy\nset :local_repository, '/home/me/myapp/.git'\nset :deploy_to, '/webapps/myapp/'\nset :scm, :none #:git\nset :user, 'me'\nset :password, 'me$pw'\n# Or: `accurev`, `bzr`, `cvs`, `darcs`, `git`, `mercurial`, `perforce`, `subversion` or `none`\ndefault_run_options[:pty] = true \nrole :web, domain                       # Your HTTP server, Apache/etc\nrole :app, domain                          # This may be the same as your `Web` server\nrole :db, domain, :primary =&gt; true # This is where Rails migrations will run\nset :branch, 'master'\n# if you're still using the script/reaper helper you will need\n# these http://github.com/rails/irs_process_scripts\nbefore \"deploy:assets:precompile\", \"bundle:install\"\n# If you are using Passenger mod_rails uncomment this:\n namespace :deploy do\n   task :start do ; end\n   task :stop do ; end\n   task :restart, :roles =&gt; :app, :except =&gt; { :no_release =&gt; true } do\n     run \"#{try_sudo} touch #{File.join(current_path,'tmp','restart.txt')}\"\n   end\n end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","jquery-plugins","file-upload","csrf"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":240,"score":2,"question_id":12074200,"title":"Can't verify CSRF token IE 9 only, Rails 3 app","body":"<p>So I am using jquery file upload in a rails 3 app, and everything works beautifully, well except in IE 9 that is.  Only in IE9, when I try to upload a file, I keep getting the 'cant verify csrf token' error in my console. I installed Firebug lite to inspect it, and the correct csrf token is correct and is in the right place in the document (and yes I have my &lt;%= csrf_meta_tags %> tag in the header of layout file). Not sure why it is only doing this in IE 9, has anyone seen this before?</p>\n"},{"tags":["ruby-on-rails-3","deployment","rvm","capistrano"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":714,"score":0,"question_id":8674957,"title":"Capistrano can't find a JavaScript runtime","body":"<p>I have a problem with Capistrano deploying to a server with RVM and gemsets</p>\n\n<pre><code>executing `deploy:assets:precompile'\n* executing \"cd /var/app/releases/20111229233555 &amp;&amp; rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile\"\n*** [err ::] rake aborted!\n*** [err ::] Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes.\n*** [deploy:update_code] rolling back\nfailed: \"rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell '1.9.2@mygemset' -c 'cd /var/app/releases/20111229234715 &amp;&amp; rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'\"\n</code></pre>\n\n<p>This is my Capfile</p>\n\n<pre><code>  $:.unshift(File.expand_path('./lib', ENV['rvm_path']))\n  require 'rvm/capistrano'\n  set :rvm_bin_path, \"$HOME/.rvm/bin\"\n  set :rvm_ruby_string, '1.9.2@mygemset'\n  set :rvm_type, :user\n  load 'deploy/assets'\n</code></pre>\n\n<p>When I log in as the very same user which is used by Capistrano the failing command is executed without any problems.</p>\n\n<p>It seems that Capistrano is using some other environment. </p>\n\n<p>Here is my <code>~/.rvmrc</code> file:</p>\n\n<pre><code>   rvm_gemset_create_on_use_flag=1 rvm_trust_rvmrcs_flag=1\n</code></pre>\n\n<p>Is there a way how to check which ruby and gemset is used at the execution time?</p>\n\n<p>node.js is and V8 are installed on the system, and all needed gems are in Gemfile:</p>\n\n<p>here is my <code>rvm info</code>:</p>\n\n<pre><code>   ruby:\n    interpreter:  \"ruby\"\n    version:      \"1.9.2p290\"\n    date:         \"2011-07-09\"\n    platform:     \"x86_64-linux\"\n    patchlevel:   \"2011-07-09 revision 32553\"\n    full_version: \"ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-linux]\"\n\n  homes:\n    gem:          \"/home/capistrano/.rvm/gems/ruby-1.9.2-p290@mygemset\"\n    ruby:         \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290\"\n\n  binaries:\n    ruby:         \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290/bin/ruby\"\n    irb:          \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290/bin/irb\"\n    gem:          \"/home/capistrano/.rvm/rubies/ruby-1.9.2-p290/bin/gem\"\n    rake:         \"/home/capistrano/.rvm/gems/ruby-1.9.2-p290@mygemset/bin/rake\"\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13061206,"title":"Javascript default in Rails 3.0","body":"<p>In the file <code>application.html.erb</code>, I see the line</p>\n\n<pre><code>  &lt;%= javascript_include_tag :defaults %&gt;\n</code></pre>\n\n<p>What does <code>:defaults</code> mean here? What Javascript files does it include?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect","route"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13060991,"title":"routing & routes in rails","body":"<p>I currently have an app that when a user signs up, it is being routed to index (basic/\"Welcome Aboard\" rails page)</p>\n\n<p>In the users_controller.rb I have a create method with the following redirect:</p>\n\n<pre><code>redirect_to root_url, :notice =&gt; \"Signed up!\"\n</code></pre>\n\n<p>And in the routes files I have the following:</p>\n\n<pre><code>root :to =&gt; \"users#new\"\n</code></pre>\n\n<p>When a user creates a valid signup, it is to redirect to the users#new (basically the same page)  However, it is redirecting to the default index file in rails.</p>\n\n<p>Any thoughts as to why it is doing this, what may I be missing?  I am pretty sure this is all the necessary info, but if more is need please let me know.  Thanks</p>\n"},{"tags":["ruby-on-rails-3","heroku","amazon-s3","carrierwave","fog"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13057621,"title":"Heroku taking too much time to upload to S3 (carrierwave and fog)","body":"<p>I have a Rails app, when the user calls one action from the web the heroku app generates a random image, upload that image to S3 and the returns to the user the public url of that image (stored in s3)... </p>\n\n<p>The \"upload that image to S3\" takes literately ages, it takes for a file of 27kb 20 seconds, that's not possible... I really don't know how to fix this, because the thing is working, it's uploading to s3 but taking way too much...</p>\n\n<p>I was thinking in just storing the image in the tmp folder from the rails app but I don't know how long is going to be there before being deleted... Any idea?</p>\n\n<p>thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":911,"score":2,"question_id":4707471,"title":"Render template and change url string in browser?","body":"<p>I have 2 actions - Edit and Update. Form in Edit submits the values to Update action. When saving a model fails I render edit teplate, where user sees errors and fields are prepopulated with what he filled before. There's a huge but for me - in URL panel in user's browser there's /user/update, even when (and because) I <strong>rendered</strong> edit template. Can I somehow change that with passing some parameters to render method in update action? I don't want the user to see that there's any (update) action aside of edit. Is it possible?</p>\n"},{"tags":["javascript","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":13060503,"title":"Automatically adding numbers in Rails form_for","body":"<p>This is a <code>form_for</code> in my Rails view:    </p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n  &lt;%= f.label :num1 %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :num1 %&gt;\n  &lt;%= f.label :num2 %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :num2 %&gt;\n  &lt;%= f.label :sum %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :sum %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I would like to make it so that, when the user inputs numbers into the first two fields, the third field automatically shows the sum of the two numbers, but the user can manually change the third field. I'm not sure how I could do this, maybe with some Javascript?</p>\n"},{"tags":["ruby-on-rails-3","url","internationalization","locale"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1061,"score":3,"question_id":8390394,"title":"Switch language with URL rails 3","body":"<p>I have a site in both french and english.  I want the user to be able to switch language on the fly when they click a link in the header.  Pretty straigforward.</p>\n\n<p>i have followed the rails 3 guide and i have this:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\nbefore_filter :set_locale\ndef set_locale\n    I18n.locale = params[:locale] || I18n.default_locale\nend\n\nprotect_from_forgery\n\n  def default_url_options(options={})\n  logger.debug \"default_url_options is passed options: #{options.inspect}\\n\"\n  { :locale =&gt; I18n.locale }\n   end\nend\n</code></pre>\n\n<p>my routes look like this:</p>\n\n<pre><code>scope \"(:locale)\", :locale =&gt; /en|fr/ do\n\nmatch 'home' =&gt; 'home#index'\nmatch 'home/ajax_twitter' =&gt; 'home#ajax_twitter'\nmatch 'equipe' =&gt; 'equipe#index'\nmatch 'equipe/sylvain' =&gt; 'equipe#sylvain'\nmatch 'equipe/benoit' =&gt; 'equipe#benoit'\nmatch 'equipe/stephane' =&gt; 'equipe#stephane'\nmatch 'equipe/suemarie' =&gt; 'equipe#suemarie'\nmatch 'equipe/regis' =&gt; 'equipe#regis'\nmatch 'equipe/fred' =&gt; 'equipe#fred'\n\nmatch 'equipe/callback' =&gt; 'equipe#callback'\nmatch 'equipe/auth' =&gt; 'equipe#auth'\nmatch 'equipe/ajax_contact' =&gt; 'equipe#ajax_contact'\n\nmatch 'linkedinauth/callback' =&gt; 'linkedinAuth#callback'\nmatch 'linkedinauth/init_auth' =&gt; 'linkedinAuth#init_auth'\n\nmatch 'mission' =&gt; 'mission#index'\nmatch 'service' =&gt; 'service#index'\nmatch 'developmen' =&gt; 'developmen#index'\n\nmatch 'contact' =&gt; 'contact#index'\n\nmatch 'mandats' =&gt; 'mandats#index'\nend\n\nmatch '/:locale' =&gt; \"home#index\"\n</code></pre>\n\n<p>and in my view i do this:</p>\n\n<pre><code>&lt;% if I18n.locale == I18n.default_locale %&gt;\n  &lt;%= link_to \"English\", '/en'%&gt;\n\n&lt;% else %&gt;\n  &lt;%= link_to \"Français\", '/fr'%&gt;\n\n&lt;%end%&gt;\n</code></pre>\n\n<p>All works well in the home page, but if i try to switch language while i'm in a specific controller, i get returned to the home page.  I tried to add this:</p>\n\n<pre><code>&lt;% if I18n.locale == I18n.default_locale %&gt;\n  &lt;%= link_to \"English\", '/en/' + params[:controller]%&gt;\n\n&lt;% else %&gt;\n  &lt;%= link_to \"Français\", '/fr/' + params[:controller]%&gt;\n\n&lt;%end%&gt;\n</code></pre>\n\n<p>this fix the controller, but if we are in a specific action and switch again language, i get back to the 'index' of this controller.</p>\n\n<p>My Question:  what is the best way to deal with this?</p>\n\n<p>i guess i could implement something in the ApplicationController (filter) to check if a controller / action / id is passed and append it to the locale.  Or can i do this in the routes.rb?</p>\n\n<p>Regards</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","daemon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13060339,"title":"Ruby script not running when Process.daemon is added","body":"<p>I have the following simple script, which checks an email account and if there is new mail it forwards the email and sends an SMS. This happens as expected when the script is run without <code>Process.daemon</code>. When it is added, and email is received at the email account, nothing happens (nothing is forwarded and no SMS is sent) and there are no error messages in the console. Any suggestions?</p>\n\n<pre><code>#!/usr/bin/env ruby\nrequire \"bundler/setup\"\nrequire \"mailman\"\nrequire \"twilio-ruby\"\n\nMailman.config.pop3 = {\n  :username =&gt; 'address@gmail.com',\n  :password =&gt; 'password',\n  :server   =&gt; 'pop.gmail.com',\n  :port     =&gt; 995,\n  :ssl      =&gt; true\n}\n\nMailman.config.poll_interval = 60\n\nMailman::Application.run do  \n  default do\n    begin\n      Ticket.receive_mail(message)\n      MailForwarder.forwarded_email(message).deliver\n      @account_sid = 'xxxxxxxxxxx'\n      @auth_token = 'xxxxxxxxxx'\n      @client = Twilio::REST::Client.new(@account_sid, @auth_token)\n      @account = @client.account\n      @sms = @account.sms.messages.create(\n        :from =&gt; '+1111111111',\n        :to =&gt; '+122222222',\n        :body =&gt; message.subject\n      )\n      puts @sms\n      puts \"#{message.subject}\"\n    rescue Exception =&gt; e\n      Mailman.logger.error \"Exception occurred whle receiving message:\\n#{message}\"\n      Mailman.logger.error [e, *e.backtrace].join(\"\\n\")\n    end\n  end\n  Process.daemon\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13059478,"title":"Rails - track user's \"actions\" with relationship models","body":"<p>I'm building a math exercise app. I want to store questions that are separated into exercises and each exercise belongs to a different section. Also there are multiple sections for each grade (12 grades in total).</p>\n\n<p>How do i track a user's answer (action)? For instance, when a user browses the app, decides to answer question 7 from exercise 'G1' in section 'G' of Grade 'Pre-K' and provides a correct answer i want to track that and in the future provide him with statistics about his performance.</p>\n\n<p>Currently there isn't a connection between my User model to the questions and i wanted to hear from others as to what would be the most efficient way to tackle this (maybe the models right now are completely wrong)</p>\n\n<p>This is the model diagram for now with has_many, belongs_to relationship (i'll add 'the_question':string and 'answer':string later on to the question model):\n<img src=\"http://i.stack.imgur.com/RAJzT.png\" alt=\"enter image description here\"></p>\n"},{"tags":["ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13059351,"title":"AJAX with Rails 3.0","body":"<p>I read in <a href=\"http://guides.rubyonrails.org/ajax_on_rails.html\" rel=\"nofollow\">this guide</a> about AJAX with Rails that \"Rails 3.1 ships with jQuery as the default JavaScript library\". If I'm using Rails 3.0, how would the use of AJAX differ from what's specified in this guide? (It's hard for me to upgrade Rails version right now.)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13059225,"title":"Getting totals deep in associations?","body":"<p>I'm trying to get into the Rails3 mindset, and had an interesting problem.</p>\n\n<p>I have the following structure:</p>\n\n<ul>\n<li>User has_many Tasks</li>\n<li>Task has_many Assets</li>\n<li>Asset has a score attribute between 0 and 99</li>\n</ul>\n\n<p>I'd like to get a sum of all scores for each user, and I suspect scopes might be something useful...</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","url","title"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13059156,"title":"Rails fetch title tag from HTML","body":"<p>In my Rails controller, I have a URL that the user provides. I would like to extract the title from the <code>&lt;title&gt;...&lt;/title&gt;</code> tag in the HTML of that URL, and assign it to a variable <code>title</code>. How can I do that?</p>\n\n<p>EDIT: It would be a plus to do it without use of external package/library</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","sorting","virtual-attribute"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13058279,"title":"insert reblogged articles in the right place in blog.articles array ordered by created_at","body":"<p>EDIT:\nActually I just decided against my way of reblogging and instead decided to implement it by copying and making a whole new record from the article and then add a reblogged: true column to it. A bit cleaner in logic in my opinion and it avoids all the problems listed below.</p>\n\n<hr>\n\n<p>In a blog app I've implemented the possibility of reblogging an article of someone else's blog through a join reblog model with two foreign keys. </p>\n\n<p>In my blogs show action I am then adding blog.articles with blog.reblogged_articles to one single array of articles. I then sort this array by the created_at attribute of each element. </p>\n\n<p>However, for the reblogged articles, I'd rather like to use the created_at attribute of their reblog join model, so that a reblogged article will initially appear on the top of the blog. A reblogged article should always get its position in the blog as if it was created by the owner of the blog. But currently, a reblogged article might appear on the bottom of the blog, if the article was created 3 years ago.</p>\n\n<p>I probably need to modify the created_at attributes of my reblogged_articles array before I put the two arrays together. But how do I do that?</p>\n\n<p>Edit:\nJust an example to clarify:</p>\n\n<p>Blog id 1:<br>\nArticle id 1, created_at: A year ago.<br>\nArticle id 2, created_at: A month ago.<br>\nArticle id 3, created_at: A week ago.<br>\nArticle id 4, created_at: A day ago.</p>\n\n<p>Blog id 2:<br>\nArticle id 5, created_at: A day ago.<br>\nArticle id 6, created_at: An hour ago.<br>\nArticle id 7, created_at: 30 minutes ago.<br>\nArticle id 8, created_at: About 10 minutes ago.  </p>\n\n<p>Now, Blog 2 reblogs Article 1 of Blog 1.\nI want this article to be displayed on the top of Blog 2, as if it has been created just now. However, since that article in fact was created a year ago, it will be displayed on the bottom of Blog 2. How can I get around this?</p>\n\n<p>What's the smartest approach to bring reblogged articles in their \"correct\" position based upon the created_at of the join model Reblog instead of the created_at of the article itself?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","whitespace"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13059707,"title":"Rails print whitespace from controller","body":"<p>I'd like to debug a variable <code>@num</code> in my Rails controller, so I'm evaluating </p>\n\n<pre><code>&lt;%= @num %&gt; \n</code></pre>\n\n<p>in my Rails view. However, I cannot distinguish between <code>@num</code> being <code>'', ' '</code>, and <code>'  '</code> (and other different types of whitespace) when it's printed in the HTML. Is there any way to print it out clearly?</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13058999,"title":"Paperclip with Attachment_on_the_Fly setup","body":"<p>I want to display multiple images on one of my web pages.  These images are on my server so I don't need to upload them.  I just want to build something like a method like <code>showThumb(image)</code> and inside the method use the Attachment_on_the_Fly to display it like so:</p>\n\n<pre><code>def showThumb(image)\n    image.attachment.s_640_width\nend\n</code></pre>\n\n<p>So that in my view I can do this to display the image with <code>&lt;%= @object.showThumb(pic.jpg) %&gt;</code>\nBut in the Attachment_on_the_Fly documentation it says 'Setup your models the same way you normally do with Paperclip'.  But in the Paperclip documentation it only shows how to upload a file, create a database and a controller.  I don't know how to set up the model and/or controller for what I want to do.</p>\n\n<p>thanks,</p>\n\n<p>mike </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":13058737,"title":"Rails not use application.html.erb","body":"<p>I know that by default, views in Rails use the template provided in <code>application.html.erb</code>. However, there's one view that I wouldn't like to use the template provided in <code>application.html.erb</code>, but rather write all the HTML in that view itself. Is that possible to do?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":13041279,"title":"Ruby On Rails: One-to-Many with One-to-One","body":"<p>I have templates and template versions. A template can have many template_versions, but only one active template_version at any given time. I have the following two models:</p>\n\n<pre><code>class Template &lt; ActiveRecord:Base\n    has_many :template_versions, :class_name =&gt; 'TemplateVersion'\n    belongs_to :active_version, :class_name =&gt; 'TemplateVersion'\nend\n\nclass TemplateVersion &lt; ActiveRecord:Base\n    belongs_to :template\n    has_one :template\nend\n</code></pre>\n\n<p>It's critical that a template only have one active template_version, which is why the key to the active_template is on the template model. This all seems fine until I test it in a rails console:</p>\n\n<pre><code>t = Template.new()\ntv = TemplateVersion.new()\nt.active_version = tv\nt.save\n\nversion = t.active_version //returns version\nversion.template_id //returns nil\n</code></pre>\n\n<p>The template knows about its active template_version, but the problem is that the template_version doesn't know what template it belongs to. I'm guessing this is because on the insert to the DB, the template_version is created to get the id to associate the template with, which would then have to be saved to hand back the template id to populate the template version.</p>\n\n<p>Is there a way of accomplishing all this? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13057736,"title":"Using Ruby to Parse through JSON when the JSON object is nested?","body":"<p>I have a JSON object that is posted to my rails controller. For some reason Rails is unable to parse the JSON object.</p>\n\n<p>This is resulting in null: <code>Rails.logger.info params[:payload][\"commits\"]</code></p>\n\n<p>Here is the rails code:</p>\n\n<pre><code>before_filter :set_payload\n\ndef create\n    params[:payload] = @payload\n    Rails.logger.info params[:payload][\"commits\"]\n .........\n\nprotected\n\n  def set_payload\n    @payload = {\n      \"data\" =&gt; {\n        \"api_version\" =&gt; \"2.0.alpha1\",\n        \"username\" =&gt; \"jamie.winsor\",\n        \"password\" =&gt; \"passw0rd\",\n        \"server_url\" =&gt; \"http://jira\"\n      },\n\n      \"payload\" =&gt; {\n        \"after\"   =&gt; \"a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\",\n        \"ref\"     =&gt; \"refs/heads/master\",\n        \"before\"  =&gt; \"4c8124ffcf4039d292442eeccabdeca5af5c5017\",\n        \"compare\" =&gt; \"http://github.com/mojombo/grit/compare/4c8124ffcf4039d292442eeccabdeca5af5c5017...a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\",\n        \"forced\"  =&gt; false,\n        \"created\" =&gt; false,\n        \"deleted\" =&gt; false,\n\n        \"repository\" =&gt; {\n          \"name\"  =&gt; \"grit\",\n          \"url\"   =&gt; \"http://github.com/mojombo/grit\",\n          \"owner\" =&gt; { \"name\" =&gt; \"mojombo\", \"email\" =&gt; \"tom@mojombo.com\" }\n        },\n\n        \"pusher\" =&gt; {\n          \"name\" =&gt; \"rtomayko\"\n        },\n\n        \"commits\" =&gt; [\n          {\n            \"distinct\"  =&gt; true,\n            \"removed\"   =&gt; [],\n            \"message\"   =&gt; \"[#WEB-249 status:31 resolution:1] stub git call for Grit#heads test\",\n            \"added\"     =&gt; [],\n            \"timestamp\" =&gt; \"2007-10-10T00:11:02-07:00\",\n            \"modified\"  =&gt; [\"lib/grit/grit.rb\", \"test/helper.rb\", \"test/test_grit.rb\"],\n            \"url\"       =&gt; \"http://github.com/mojombo/grit/commit/06f63b43050935962f84fe54473a7c5de7977325\",\n            \"author\"    =&gt; { \"name\" =&gt; \"Tom Preston-Werner\", \"email\" =&gt; \"tom@mojombo.com\" },\n            \"id\"        =&gt; \"06f63b43050935962f84fe54473a7c5de7977325\"\n          },\n          {\n            \"distinct\"  =&gt; true,\n            \"removed\"   =&gt; [],\n            \"message\"   =&gt; \"clean up heads test\",\n            \"added\"     =&gt; [],\n            \"timestamp\" =&gt; \"2007-10-10T00:18:20-07:00\",\n            \"modified\"  =&gt; [\"test/test_grit.rb\"],\n            \"url\"       =&gt; \"http://github.com/mojombo/grit/commit/5057e76a11abd02e83b7d3d3171c4b68d9c88480\",\n            \"author\"    =&gt; { \"name\" =&gt; \"Tom Preston-Werner\", \"email\" =&gt; \"tom@mojombo.com\" },\n            \"id\"        =&gt; \"5057e76a11abd02e83b7d3d3171c4b68d9c88480\"\n          },\n          {\n            \"distinct\"  =&gt; true,\n            \"removed\"   =&gt; [],\n            \"message\"   =&gt; \"add more comments throughout\",\n            \"added\"     =&gt; [],\n            \"timestamp\" =&gt; \"2007-10-10T00:50:39-07:00\",\n            \"modified\"  =&gt; [\"lib/grit.rb\", \"lib/grit/commit.rb\", \"lib/grit/grit.rb\"],\n            \"url\"       =&gt; \"http://github.com/mojombo/grit/commit/a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\",\n            \"author\"    =&gt; { \"name\" =&gt; \"Tom Preston-Werner\", \"email\" =&gt; \"tom@mojombo.com\" },\n            \"id\"        =&gt; \"a47fd41f3aa4610ea527dcc1669dfdb9c15c5425\"\n          }\n        ]\n      }\n    }\n\n  end\n\nend\n</code></pre>\n\n<p>Any ideas why nil is being returned? Am I handling the JSON object incorrectly? Thanks</p>\n"},{"tags":["ruby-on-rails-3","activerecord","checkbox","submit"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13056318,"title":"how to correctly store values of selected checkboxes in rails?","body":"<p>After searching long time Im unable to find any information on how to best store values of selected checkboxes in rails.</p>\n\n<p>I do something like:</p>\n\n<pre><code>  = form_for @profile, :url =&gt; request.fullpath, :method =&gt; :get,  :html =&gt; { :class =&gt; 'form-  horizontal' } do |f|\n      - @contacts.each do |contact|\n        = check_box_tag \"contact[#{ contact.slug }]\", contact.id, true\n        //= label_tag \"contact[#{contact.id}]\", contact.slug\n     = f.submit t('forms.go')\n</code></pre>\n\n<p>On form submit this gives me params:</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"✓\", \"contact\"=&gt;{\"1\"=&gt;\"bladadie\", \"2\"=&gt;\"jolanteds03\",\n    \"3\"=&gt;\"jannie6674\", \"4\"=&gt;\"henriette1305\",\n    \"5\"=&gt;\"amy6456\", \"6\"=&gt;\"jacquelyn9001\", \"7\"=&gt;\"florencio4872\",\n    \"8\"=&gt;\"angel410\", \"9\"=&gt;\"rita558\", \"10\"=&gt;\"chadd2684\", \"11\"=&gt;\"ilene8219\",\n    \"12\"=&gt;\"sonny664\", \"13\"=&gt;\"monique7912\", \"14\"=&gt;\"merritt28103744\",\n    \"15\"=&gt;\"sunny80771258\", \"16\"=&gt;\"lavinia31942066\", \"17\"=&gt;\"jada29655747\",\n    \"18\"=&gt;\"johan16227289\", \"19\"=&gt;\"cristobal9746087\",\n    \"20\"=&gt;\"meggie3447530\"}, \"commit\"=&gt;\"Go »\"}\n</code></pre>\n\n<p>How Would I correctly store the values of those checked, checkboxes?</p>\n\n<p>I'm unable to find any info on this. Hope someone can shed some light!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13054380,"title":"No route matches {:controller=>\"artifacts\", :action=>\"edit\"}","body":"<p>I keep getting these errors for no route matches for actions 'edit'</p>\n\n<p>controller:</p>\n\n<pre><code>def remove_artifact_from_collection\n\n... do my stuff ..\n\nrender(:action=&gt;:show)\nend\n</code></pre>\n\n<p>view: the line on which it errors</p>\n\n<pre><code>&lt;p&gt;&lt;%= link_to 'Edit Evidence Item', edit_artifact_path, :class =&gt; 'edit_button' %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :artifacts do\n    collection do\n    get 'remove_artifact_from_collection'\n    end\nend\n</code></pre>\n\n<p>bundle exec rake routes</p>\n\n<pre><code> remove_artifact_from_collection_artifacts GET    /artifacts/remove_artifact_from_collection(.:format)      {:controller=&gt;\"artifacts\", :action=&gt;\"remove_artifact_from_collection\"}\n                                 artifacts GET    /artifacts(.:format)                                      {:controller=&gt;\"artifacts\", :action=&gt;\"index\"}\n                                           POST   /artifacts(.:format)                                      {:controller=&gt;\"artifacts\", :action=&gt;\"create\"}\n                              new_artifact GET    /artifacts/new(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"new\"}\n                             edit_artifact GET    /artifacts/:id/edit(.:format)                             {:controller=&gt;\"artifacts\", :action=&gt;\"edit\"}\n                                  artifact GET    /artifacts/:id(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"show\"}\n                                           PUT    /artifacts/:id(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"update\"}\n                                           DELETE /artifacts/:id(.:format)                                  {:controller=&gt;\"artifacts\", :action=&gt;\"destroy\"}\n</code></pre>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","hover"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13055584,"title":"HTML title attribute in Rails displaying only first word","body":"<p>Got a weird little problem. </p>\n\n<p>I want to create the text hover on an item to display that item's \"description,\" which is an attribute of that item's model. So I basically did this in my view:</p>\n\n<pre><code>&lt;div title=&lt;%= item.description %&gt; &gt;&lt;%= item.name %&gt;&lt;/div&gt;\n</code></pre>\n\n<p>The weird thing is, while all the model calls are working correctly (item.name and item.description are calling up the right things), only the first word of item.description is showing up when I hover. In other words, if item.description is \"This is a super cool item!\", when I hover over that div with item.name, the hover just says \"This\". </p>\n\n<p>This may have something to do with the :description attribute, which is currently of type text, (which I thought was for long strings, like my descriptions). But maybe not. </p>\n\n<p>Any idea why this might be happening, and how to fix it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-one"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13055000,"title":"How do you override the getter method for a Rails has_one association?","body":"<p>I want to override/extend a Rails <code>has_one</code> association method so that it <em>always</em> returns an instance of the associated class. (If none already exists in the database, I want to create a new one and assign it to the parent instance.)</p>\n\n<p>Ideally, I'd like to do this through the <a href=\"http://guides.rubyonrails.org/association_basics.html#association-extensions\" rel=\"nofollow\">built-in Rails association extension mechanism</a>. However, I don't know the name of the \"getter\" method, and so I don't know what to override.</p>\n\n<p>How do I override the association getter so that I can instantiate a new object when it's nil?</p>\n"},{"tags":["ruby-on-rails-3","heroku","delayed-job","background-process","sidekiq"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13055084,"title":"how to correctly use background job for file upload rails app heroku","body":"<p>i am working on a rails app that takes uploaded files from a user and pushes them to box. the issue is that this times out on some requests because the api call takes too long. i want to move this process to a worker process, but am not sure how to persist the file between the time the user uploads the file and the time the worker takes the job off the queue. all of the examples i have seen seem to skip this part or don't deal with using an api that is not s3. i thought about storing the file in the database, but the box api expects a file object (curl -F @file) and not just the contents of the file. any pointers on how this would be accomplished? i am looking to use sidekiq for performance reasons but delayed_job would be ok as well</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","image","cloud"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":13054278,"title":"Simplest solution for uploading images to cloud service","body":"<p>What is the simplest way to allow people to upload an image to a cloud server (in a Rails 3 app)? I want to include an \"upload image\" button in the form, and store the address in my model. I'd also like to be able to constrain the file size.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13055046,"title":"Rails 3 Drag and drop between folders","body":"<p>I have tree structure in my application like folders when I click on folders on same page its going to show all files under that folder\nwith an ajax call.</p>\n\n<p>Folders has many files.</p>\n\n<p>So now my problem is, I want to drag file from one folder to another folder. So that if files folder_id which I am dragging is 1, when I drop it to Folder 2, in back end it should update as folder_id= 2</p>\n\n<p>I am not getting any idea to do this, </p>\n\n<ol>\n<li>How can I enable user to drag file and drop in any folders</li>\n<li>Once he dragged and dropped, how should I update in back end</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13054206,"title":"Comparison on boolean fields not working in Rails","body":"<p>I have a <code>Post</code> model, with a <code>posted</code> boolean field.</p>\n\n<p>I created a new Post, without assigning anything to <code>posted</code>.</p>\n\n<pre><code>irb(main):012:0&gt; Post.first.posted\n  Post Load (9.0ms)  SELECT \"posts\".* FROM \"posts\" LIMIT 1\n=&gt; nil\n</code></pre>\n\n<p>Now, I want to select all posts where <code>posted</code> is not equal to <code>true</code>.</p>\n\n<p>I tried this, but it doesn't work:</p>\n\n<pre><code>irb(main):016:0&gt; Post.where(\"posted != ?\", true)\n  Post Load (2.5ms)  SELECT \"posts\".* FROM \"posts\" WHERE (posted != 't')\n=&gt; []\n</code></pre>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13054718,"title":"Using gmaps4rails with Active Admin, no maps","body":"<p>I am trying to get <a href=\"https://github.com/apneadiving/Google-Maps-for-Rails\" rel=\"nofollow\">gmaps4rails</a> with <a href=\"http://activeadmin.info/\" rel=\"nofollow\">Active Admin</a> in Rails Rails 3.2.8.</p>\n\n<p>I have been trying to follow <a href=\"http://kalapun.com/blog/2012/05/17/rails-maps-and-activeadmin/\" rel=\"nofollow\">this tutorial</a> but have needed to adapt it as I am using mysql in my stack.</p>\n\n<p>I am not getting any errors (which might help!) but I am also not getting any maps. </p>\n\n<p>My model (<strong>location</strong>) has the attributes <em>longitude:float, langitude:float</em> and <em>gmaps:boolean</em></p>\n\n<p>I have added the following to the locations model, which is different to the tutorial:</p>\n\n<pre><code>def location\n    [:latitude, :longitude]\nend\n</code></pre>\n\n<p>and this to the active admin locations model, also different from the tutorial:</p>\n\n<pre><code>f.input :location do |o|\n           gmaps(\"markers\" =&gt; {data: o.to_gmaps4rails}, \"map_options\" =&gt;  { auto_zoom: false, zoom: 15 })\n     end\n</code></pre>\n\n<p>As far as I can tell (by scanning through the rendered source files) the CSS and JavaScript seem to be loading.</p>\n\n<p>The whole app is available <a href=\"https://bitbucket.org/mildfuzz/aperture_current\" rel=\"nofollow\">here</a></p>\n\n<p>Other that those changes, I think I have stuck to the tutorial.</p>\n"},{"tags":["ruby-on-rails-3","cron","rake","email-integration"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13054329,"title":"Rails 3: Rake output for emails from cron -- \"puts\" in my model code?","body":"<p>We have a bunch of periodic tasks that we run with custom rake tasks via cron (which is generated by the mos' excellent <a href=\"https://github.com/javan/whenever\" rel=\"nofollow\">whenever gem</a>.  Output from these tasks is emailed to a mailing list.</p>\n\n<p>I want to standardize the email format, not to be fancy, just so we can set up filters in mail clients to detect when there are either good or bad things we might care about -- subjects, such as an error processing a file \"[ERROR] (db_backup) file foo.bar not found\", or \"[INFO] (widget_sender) 240 widgets sent to 32 customers\".  The email should have details like start time, total execution, and useful outputs and should be easy enough to scan.</p>\n\n<p>Several problems:</p>\n\n<ul>\n<li>We use sendgrid for email, and it joins lines of text when it converts to HTML.  We have found that adding a <code>\\r</code> (newline) to the end of <code>puts</code> output causes, but this seems ... yuck!</li>\n<li>Some of the output is generated from our rake tasks themselves. <code>puts \"something happened\\r\"</code> seems ... yuck.</li>\n<li>Many of the tasks call methods defined within our regular libraries or models.  Seems like <code>Rails.logger.info \"something else happened\"</code> would seem to be the best solution -- in some cases the same methods are called as part of application execution as well as from the periodic rake task so it would be nice for the logger to do the right thing depending on context -- either write to the log, or send to STDOUT.</li>\n<li>I would like a formatted subject on the email -- probably done easily enough within <code>whenever</code></li>\n</ul>\n\n<p>Are there any good patterns I might follow to handle these special kinds of tasks and reporting that anyone can recommend?  Gems?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","rails-admin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":13054093,"title":"Heroku and Rails Admin 404 Error","body":"<p>I seem to be getting a very long series of errors when trying to load Rails Admin on my app. The entire app works fine on Heroku except for this one element. </p>\n\n<p>The error seems to be so long that my console will only display a certain length of lines (even if using <code>heroku logs -n 3000</code>). </p>\n\n<p>The error is as follows:</p>\n\n<pre><code> 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:213:in `aggregate_column'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:234:in `execute_simple_calculation'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:208:in `perform_calculation'\n\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:159:in `calculate'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/relation/calculations.rb:58:in `count'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/adapters/active_record.rb:53:in `count'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/config/actions/dashboard.rb:26:in `block (3 levels) in &lt;class:Dashboard&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/config/actions/dashboard.rb:24:in `each'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/lib/rails_admin/config/actions/dashboard.rb:24:in `block (2 levels) in &lt;class:Dashboard&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:   (eval):8:in `instance_eval'\n 2012-10-24T16:39:55+00:00 app[web.1]:   (eval):8:in `dashboard'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/implicit_render.rb:4:in `send_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/base.rb:167:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/rendering.rb:10:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/notifications.rb:123:in `block in instrument'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/callbacks.rb:18:in `block in process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-pjax-0.6.0/lib/rack/pjax.rb:12:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/notifications.rb:123:in `instrument'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/instrumentation.rb:29:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/params_wrapper.rb:205:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/railties/controller_runtime.rb:18:in `process_action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:35:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `catch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/base.rb:121:in `process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/rendering.rb:45:in `process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal.rb:203:in `dispatch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal.rb:246:in `block in action'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:66:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:66:in `dispatch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:30:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/head.rb:14:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/remotipart-1.0.2/lib/remotipart/middleware.rb:30:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:570:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/rack/logger.rb:26:in `call_app'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:479:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/rack/logger.rb:16:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:570:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/static.rb:53:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/params_parser.rb:21:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/flash.rb:242:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:479:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/cookies.rb:338:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/query_cache.rb:64:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:79:in `pre_process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:39:in `receive_data'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/backends/base.rb:63:in `start'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:81:in `block in pre_process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/controllers/controller.rb:86:in `start'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:79:in `catch'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/application.rb:220:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/connection.rb:54:in `process'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `_run__3119720662384712530__call__3373774757668482244__callbacks'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `__run_callback'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/bin/thin:6:in `&lt;top (required)&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/server.rb:159:in `start'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:152:in `run!'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/thin-1.5.0/lib/thin/runner.rb:187:in `run_command'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:81:in `run_callbacks'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in`&lt;main&gt;'\n 2012-10-24T16:39:55+00:00 app[web.1]:\n 2012-10-24T16:39:55+00:00 app[web.1]: cache: [GET /admin] miss\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/bin/thin:19:in`load'\n 2012-10-24T16:39:55+00:00 app[web.1]:   vendor/bundle/ruby/1.9.1/gems/eventmachine-1.0.0/lib/eventmachine.rb:187:in `run_machine'\n 2012-10-24T16:39:55+00:00 app[web.1]:\n 2012-10-24T16:39:55+00:00 heroku[router]: GET rocky-depths-5693.herokuapp.com/admin dyno=web.1 queue=0 wait=0ms service=447ms status=500 bytes=643\n 2012-10-24T16:39:46+00:00 heroku[web.1]: State changed from starting to up\n</code></pre>\n\n<p>Everything seems to work fine in Development so I am not sure why it's not working in Production. </p>\n\n<p>If anyone has any suggestions on what might be causing this with Rails_admin then they would be much appreciated!</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","dns","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13043043,"title":"Rails: accessing network.domain.com renders root for domain.com","body":"<p>I'm trying to set up a subdomain <code>network</code> for my domain. In my <code>config/routes.rb</code> I have:</p>\n\n<pre><code>constraints :subdomain =&gt; /network.*/ do\n  ...\n\n  # Root\n  match '/' =&gt; 'questions#index'\n  match '' =&gt; 'questions#index'\n  root :to =&gt; 'questions#index', :as =&gt; 'network_root'\nend\n\nroot :to =&gt; 'frontend#home'\n</code></pre>\n\n<p>However, sometimes when I access network.domain.com (in production) it shows the root for the whole application (frontend#home). Accessing the subdomain in development works as expected.</p>\n\n<p>EDIT: I've just noticed that requests to the app root (domain.com/) and subdomain root (network.domain.com/) do not get logged in my production.log. Any other page loads work as expected.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","asset-pipeline"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":1384,"score":8,"question_id":7267651,"title":"How can I reference images in the asset pipeline from a model?","body":"<p>I have a model with a method to return a url to a person's avatar that looks like this:</p>\n\n<pre><code> def avatar_url\n   if self.avatar?\n     self.avatar.url # This uses paperclip\n   else\n     \"/images/avatars/none.png\"\n   end\n end\n</code></pre>\n\n<p>I'm in the midst of upgrading to 3.1, so now the hard-coded none image needs be referenced through the asset pipeline. In a controller or view, I would just wrap it in <code>image_path()</code>, but I don't have that option in the model. How can I generate the correct url to the image?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","web-services","api"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":78,"score":0,"question_id":10638078,"title":"Building a gateway between two web applications?","body":"<p>I'm interested in building a gateway that serves as a secure channel between a Ruby on Rails application (A) and some other application (B).  Communication between the applications will be bidirectional, authenticated, and encrypted.  I'm a bit new to building web apps though, and I'm not sure exactly how to begin.  </p>\n\n<p>Do you think a web service would solve this problem?  If so, the service will have to send requests to B; does this mean that B will have to build some kind of proxy to push/pull data from the gateway service?  This will require the gateway service to have a DB of its own to store requests from A and responses from B, correct?</p>\n\n<p>Any input here would be awesome.  Thank you for your time.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13052308,"title":"Using array in routes.rb","body":"<p>Using Rails 3. I have the following:</p>\n\n<pre><code># shop.rb\nSHOP_TYPES = %w(cafe restaurant station)\n\n# routes.rb\nresources :shops do\n  member do\n    get :nearby_cafes, :nearby_restaurants, :nearby_stations\n  end\nend\n</code></pre>\n\n<p>Instead of updating my <code>routes.rb</code> everytime I add another member in the <code>SHOP_TYPES</code> array, is there anyway to read the array in the <code>routes.rb</code>?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":337,"score":3,"question_id":9644786,"title":"How to translate timezone full names to tz abbreviations?","body":"<p>In a Rails 3.x app I need to display time zone abbreviations (EST, PST, CST, etc.) rather than the full time zone name.  I've seen a number of discussions that seem to address the issue, but in overly verbose manners.</p>\n\n<p><strong>Is there a gem or a very concise method to handle this that could be used to map them properly?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13049973,"title":"rails namespace caching before filter method?","body":"<p>Rails 3, Ruby 1.9.3</p>\n\n<p>hey guys, our app has three namespaces: admin, store and account. Each one has your own application controller but only store and account call a before_filter method named foo, defined inside the main application controller.</p>\n\n<p>Just to clarify, this method loads a collection to fill a select tag inside the app layout.</p>\n\n<p>Sometimes while we are navigating through the app and we switch from namespaces, ex:</p>\n\n<p>We go from store/products/index to account/orders/index</p>\n\n<p>The before_filter is not called, the collection is never loaded and because of this we got a nil error in the view because the variable was never set.</p>\n\n<p>The weirdest thing is if we open the main application controller (where foo method is defined) and just save it, with no modifications and reload the page, the error is gone.</p>\n\n<p>Seems like somehow the application controller is being cached or something else.</p>\n\n<p>Does anyone have a clue of what is going on here? </p>\n"},{"tags":["ruby","ruby-on-rails-3","sass","rack","scss"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13043420,"title":"Render SASS files correctly in File.read (inside PDF file)","body":"<p>I generate a pdf and have to include css in the generated file so that the styling is correct in the pdf.  To do this I have</p>\n\n<pre><code>&lt;%= File.read(Rails.root.join(\"app\", \"assets\", \"stylesheets\", \"application.css.scss\")) %&gt;\n&lt;%= File.read(Rails.root.join(\"app\", \"assets\", \"stylesheets\", \"app.css.scss\")) %&gt;\n</code></pre>\n\n<p>But the sass isn't templated correctly.  Does anyone know what the correct code to render the files right are?</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":460,"score":0,"question_id":8015382,"title":"Log out all user with Devise","body":"<p>I'm using devise in my ruby-on-rails app. I have a User class and an AdminUser class using devise. In my admin panel I would like to logout all Users but not AdminUsers.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","documentation","yard"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":8914710,"title":"How can I state and display documentation related to constant values in a proper way?","body":"<p>I am using Ruby on Rails 3.1.0 and I am trying to use YARD 0.7.4. I would like to document constant values, so in my class I state this:</p>\n\n<pre><code># [Fixnum] Test constant documentation.\nTEST_CONSTANT = 1\n</code></pre>\n\n<p>but the HTML output after I run the <code>yardoc</code> (or <code>yard doc</code>) command is the following:</p>\n\n<p><img src=\"http://i.stack.imgur.com/R6gqS.png\" alt=\"enter image description here\"></p>\n\n<p>In the above image is shown that the HTML documentation is not good rendered/generated, at least not as I would expect. I read the <a href=\"http://rubydoc.info/docs/yard/0.7.4/file/docs/GettingStarted.md\" rel=\"nofollow\">YAML documentation</a> but I still have some problem on that: <strong>how can I better state and display documentation related to constant values?</strong></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13051416,"title":"What is a call back method in rails?","body":"<p>What the heck is a call back method in rails? I see this term being used everywhere while I learn about controllers and models. Can someone provide examples please?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":231,"score":3,"question_id":6453267,"title":"How to disable db:schema:dump for migrations","body":"<p>I dont want Rails 3 to generate my schema every time I do migration. How to properly disable it?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","actionmailer","rspec-rails","sendgrid"],"answer_count":1,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":395,"score":6,"question_id":10961982,"title":"ActionMailer sending real emails in test mode! - How to turn off?","body":"<p>Newly signed up users to my little app must be approved by the admin (me) before they can gain access to the site.  I've succeeded in generating such emails in development with an <code>after_create :send_admin_email</code> in my user model which works great.  My problem is that I'm  generating multiple users during my tests (using FactoryGirl) and each test user created  sends off a real email.  Running my tests is like pouring molasses in January and I've got to delete hundreds of emails sent to my inbox.  How do I turn that off?</p>\n\n<p><a href=\"http://guides.rubyonrails.org/action_mailer_basics.html\" rel=\"nofollow\">Action Mailer Basics</a> in the <a href=\"http://guides.rubyonrails.org/index.html\" rel=\"nofollow\">Rails Guides</a> tells me that \"By default Action Mailer does not send emails in the test environment. They are just added to the ActionMailer::Base.deliveries array.\"</p>\n\n<p>Moreover, in <code>config/environments/test.rb</code> I've got:</p>\n\n<pre><code>config.action_mailer.delivery_method = :test\n</code></pre>\n\n<p>That's in addition to in <code>config/environment.rb</code> having:</p>\n\n<pre><code># Configuration for using SendGrid on Heroku\nActionMailer::Base.smtp_settings = {\n  :address        =&gt; 'smtp.sendgrid.net',\n  :port           =&gt; '587',\n  :authentication =&gt; :plain,\n  :user_name      =&gt; 'app[my app number]@heroku.com',\n  :password       =&gt; '[something super secret]',\n  :domain         =&gt; '[let's get this party started!.com]',\n  :enable_starttls_auto =&gt; true\n}\nActionMailer::Base.delivery_method = :smtp\n</code></pre>\n\n<p>I'm sure that I'm missing something simple and basic.  I've searched around and related questions and posts deal with how to test that ActionMailer actually sent email.</p>\n\n<p>Humble gratitude in advance for any thoughts or help.</p>\n\n<p>Addendum:  Following answer to similar question found at <a href=\"http://stackoverflow.com/questions/10609113/is-it-possible-to-turn-off-actionmailer-emails-when-cucumber-testing-is-happenin\">Is it possible to turn off ActionMailer emails when cucumber testing is happening on development?</a> I was able to stop the email sending madness.  Still, I had to add <code>ActionMailer::Base.delivery_method = :test</code> to several rspec files.  Is there a way I can shut this down globally?  Anyone have any thoughts on what's going on?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":13051528,"title":"How to redirect two different routes by single controller?","body":"<p>I have two same routes <code>resources :errors</code> with different url's in different folders inside the <code>routes.rb</code>. </p>\n\n<pre><code>Routes:\n---------\n\nnamespace :enr do\n  namespace :locations do #( url: enr/locations/:location_id/errors)\n    resources: errors \n  end\n\n  namespace :rds do\n    resources :errors #(url: enr/rds/errors)\n  end\nend\n\ncontroller:\n------------\n\nI have a controller for `enr/rds/errors` only. \n</code></pre>\n\n<p>how to change these two url's by <code>IF</code> condition. For example,  </p>\n\n<p>if location_id is nil\n  i need to show this #<code>(url: enr/rds/errors)</code>\nelse\n  I need to show <code>(url: enr/locations/:location_id/errors)</code>\nend</p>\n\n<p>So it will change depends upon the <code>location_id</code>. Where should i write this condition to change the url's by the <code>location_id</code>. Any Example would be more appreciated. Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13051924,"title":"Better way in adding sequence index in id attribute","body":"<p>Using Rails 3. I am using the <code>each_with_index</code> to generate the sequence:</p>\n\n<pre><code>&lt;% @shops.each_with_index do |shop, i| %&gt;\n  &lt;div class=\"item map-marker\" id=\"shop_&lt;%= i+1 %&gt;\"&gt;\n</code></pre>\n\n<p>I tried using <code>div_for</code>, but it takes the <code>shop.id</code> instead. Is there any better way to do this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":3,"favorite_count":0,"up_vote_count":9,"down_vote_count":0,"view_count":5793,"score":9,"question_id":10133783,"title":"How can I change cols of textarea in twitter-bootstrap?","body":"<p>If I change the value of :rows, it works. But it stays at the default cols whatever value I set with ':cols =>'. Column width won't change.</p>\n\n<p>I viewed the html source and it reflected the change. I wonder that bootstrap's CSS might be the suspect...</p>\n\n<p>HTML (there is a \"cols=\" in the final HTML, but column width stays at the default value, which is 30. I can't believe my eyes!)</p>\n\n<pre><code>&lt;textarea cols=\"100\" id=\"comment_body\" name=\"comment[body]\" rows=\"5\"&gt;&lt;/textarea&gt;\n</code></pre>\n\n<p>Rails:</p>\n\n<pre><code>&lt;%= form_for([@post, @post.comments.build]) do |f| %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;i class=\"icon-user\"&gt;&lt;/i&gt;\n    &lt;%= f.text_field :commenter %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;i class=\"icon-comment\"&gt;&lt;/i&gt;\n    &lt;%= f.text_area :body, :rows =&gt; 5, :cols =&gt; 100 %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;div&gt; \n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","session","authentication","before-filter"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":743,"score":0,"question_id":7743861,"title":"Rails 3 - authenticate and :before_filter","body":"<p>I am a newbie in Rails. I try to build a simple authenticate system, to <strong>application_controller</strong> I put following lines:</p>\n\n<pre><code>  def check_session\n    if session[:user]\n      if session[:expiry_time] &lt; 10.minutes.ago\n        reset_session\n      flash[:warning] = 'You was logout.' \n        redirect_to root_url\n      else\n        session[:expiry_time] = Time.now\n      end\n    else\n      #... authenticate\n      session[:expiry_time] = Time.now\n      flash[:warning] = 'You was logout.' \n      redirect_to root_url\n    end\n  end  \n</code></pre>\n\n<p>My problem is in one action - in this action I check, if the user is log in or not. And if the user is log in, so I will render one template, and if not, so I will render the second one. It looks like:</p>\n\n<pre><code>&lt;% unless session[:user].nil? %&gt;\n  &lt;%= render :template =&gt; 'template_for_login_user' %&gt;\n&lt;% else %&gt;\n  &lt;%= render :template =&gt; 'template_for_not_login_user' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>And here is the problem - this doesn't works me. At least... well - if I am not log in, so will be render the template <strong>template_for_not_login_user</strong> and if I am, so <strong>template_for_login_user</strong>. This is right.</p>\n\n<p>But if I am log in and I am on the <strong>template_for_login_user</strong>, but I am 15min idle => the session will be expired => I should be redirect to login form. But here is the problem - I am 15 minutes idle and I refresh this page, so I am still on the action <strong>template_for_login_user</strong> - and this is the problem...</p>\n\n<p>I would like to ask you - can you help me please, where could be a problem? What I'm doing wrong?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":20,"score":1,"question_id":13051400,"title":"RoR : articles appears two many times","body":"<p>I've started using Ruby on Rails for a few days now, but I have a problem with the \"each do\" loops.</p>\n\n<p>Here's my AccueilController's code :</p>\n\n<pre><code>def index\n\n@postsTest = Post.last(1)\n@articles = Article.last(1)\n@articlesList = Article.last(2)\n\n    respond_to do |format|\n    format.html # index.html.erb\n    format.json { render json: @users }\nend\n</code></pre>\n\n<p>Here's my application.html.erb's code :</p>\n\n<pre><code>&lt;div id=\"container\"&gt;\n    &lt;div id=\"col1\"&gt;\n        &lt;%= render :partial =&gt; 'shared/listArticles', :collection =&gt; @articlesList %&gt;\n        &lt;div class=\"clear\"&gt;&lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div id=\"col2\"&gt;\n        &lt;%= yield %&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And now my shared/listArticles's code :</p>\n\n<pre><code>&lt;% @articlesList.each do |article| %&gt;\n        &lt;div id=\"blocArticle\"&gt;\n            &lt;div id=\"pic\"&gt;\n                &lt;%= image_tag (article.photo.url(:thumb)) %&gt;\n            &lt;/div&gt;\n            &lt;div id=\"contentArticle\"&gt;\n                &lt;div id=\"titleArticle\"&gt;\n                    &lt;%= link_to article.title, article %&gt;\n                    &lt;div class=\"clear\"&gt;&lt;/div&gt;\n                &lt;/div&gt;\n                &lt;div id=\"contentArticleDesc\"&gt;\n\n                        &lt;%= link_to article.desc, article %&gt;\n\n                    &lt;div class=\"clear\"&gt;&lt;/div&gt;\n                &lt;/div&gt;\n\n                &lt;div class=\"clear\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"clear\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;   \n</code></pre>\n\n<p>And my problem is that if I write <code>@articlesList = Article.last(2)</code> then the last two articles will appear two times; if I write <code>@articlesList = Article.last(3)</code> then the last three articles will appear three times etc...</p>\n\n<p>Of course, I would like that each of them appear just one time.</p>\n\n<p>Does someone have any ideas about the source of the problem ?</p>\n\n<p>Thanks a lot :)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":65,"score":-2,"question_id":13047969,"title":"Don't understand the difference between variable declarations, symbols, methods, instance variables, class variables","body":"<p>Updated this post as per post recommendations:\nInconsistent naming conventions in rails is confusing the heck out of me. IT SEEMS LIKE THE SYNTAX IS ALL OVER THE PLACE IN RAILS...  </p>\n\n<p><strong>Here are some examples:</strong></p>\n\n<p>Why are there commas in the migration below ? And why is keyword \"default\" not with a colon before it? What is this default keyword? a method, or a variable, a symbol.. What is that darn thing??:</p>\n\n<pre><code>add_column :zombies, :rotting, :boolean, default: false\n</code></pre>\n\n<p><strong>Here is another example:</strong></p>\n\n<p>Why age not :age (with a colon)? WHY IS make_rotting CALLED WITH A \" <strong>:</strong> \" BEFORE IT?? </p>\n\n<pre><code> class Zombie &lt; ActiveRecord::Base\n       before_save :make_rotting\n\n   def make_rotting\n      if age &gt; 20\n         self.rotting = true\n      end\n    end\n end\n</code></pre>\n\n<p>I am a Java guy, yes java is verbose but at-least its consistent I feel like going back :(</p>\n"},{"tags":["ruby","ruby-on-rails-3","plugins","redmine","redmine-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":11607405,"title":"Plugin migrations for Redmine: place plugin in db/migrate instead of plugin folder","body":"<p>I'm a newbie in ruby on rails and creating a redmine plugin. I created a model <code>Allissue</code> without using any column. Now I wanted to add a column <code>project_name</code> with the help of migration <code>./script/generate migration AddRoleToAllissue project_name:string</code>.</p>\n\n<p>But it places migration in folder <code>db/migrate</code> named <code>20120722192815_add_role_to_allissue.rb</code> instead of plugin migrate folder. I followed <a href=\"http://stackoverflow.com/questions/1221154/plugin-migrations-for-redmine\">stack-overflow question</a> and move migrated file to plugin folder <code>mv ./db/migrate/20120722192815_add_role_to_allissue.rb ./vendor/plugins/redmine_allissues/db/migrate/002_add_role_to_allissue.rb</code>.</p>\n\n<p>I just wanted to know alternative for plugin migration in which no need of moving migrated file to plugin folder. I'm not sure but there may be a command for plugin migration. Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","puma"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13042372,"title":"Puma .state file","body":"<p>I'm attempting to deploy my rails application w/ puma using Capistrano. Towards the end ofthe deployment it attempts to run </p>\n\n<p><code>bundle exec pumactl -S /home/deployer/production/shared/sockets/puma.state restart</code> </p>\n\n<p>which fails w/ </p>\n\n<pre><code>undefined method `has_key?' for false:FalseClass. \n</code></pre>\n\n<p>I have simply created a empty file for <code>puma.state</code>. My question is what exactly is this file and what is supposed to be in it? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":13050778,"title":"Creating a specific custom route in rails 3","body":"<p>I have several levels of nested routing. </p>\n\n<pre><code> resources :departments do\n  resources :tasks do\n    collection do\n      get \"report\" =&gt; \"tasks#report\"\n    end\n end\n</code></pre>\n\n<p>This a piece of it. </p>\n\n<p>What I am attempting to do is create a custom route for a report.html.erb file. However, this route creates the path /department/:id/tasks/report</p>\n\n<p>I would like to create the path /department/:id/tasks/:id/report</p>\n\n<p>Is this possible? I considered creating a new controller and model for report but this seems to be inefficient. </p>\n"},{"tags":["ruby","ruby-on-rails-3","design-patterns","documentation-generation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":10,"score":0,"question_id":13050947,"title":"Ruby doc generators that account for observers","body":"<p>Do any of the Ruby Doc Generators document the occurance of the ActiveRecord observer pattern?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":32,"score":2,"question_id":13050224,"title":"ActionMailer sometimes not sending?","body":"<p>I have a problem where ActionMailer sometimes doesn't send emails. It is reproducible and affects certain people at certain times, although what is causing it is a mystery.</p>\n\n<p>It fails silently, although <code>config.action_mailer.raise_delivery_errors = true</code> is set.</p>\n\n<p>It enters the mail() routine, claims it has rendered the template:</p>\n\n<pre><code>Rendered notifier/notify_comment.html.erb (0.9ms)\n</code></pre>\n\n<p>And then skips the delivery and moves onto the next one. The next one is rendered &amp; delivered no problem. When emails are delivered, they are also printed to the console, so I can see it. The content of every email is the same, only the recipient is different.</p>\n\n<p>I cannot understand why this would be intermittent.</p>\n\n<p>How can I go about debugging this?</p>\n"},{"tags":["ruby-on-rails-3","mongodb","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1106,"score":0,"question_id":4942012,"title":"MongoDB : Mongoid and I18n translations","body":"<p>I am going to start a new project based on the top of MongoDB.</p>\n\n<p>My application will need to handle fields translations.</p>\n\n<p>I discovered a plugin named : <a href=\"https://github.com/Papipo/mongoid_i18n\" rel=\"nofollow\">Mongoid_i18n</a></p>\n\n<p>Is it the only one plugin interesting ? Or other plugins are available ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13050253,"title":"how will rails app create a db in server either from migration file or schema?","body":"<p>I have a rails <code>app</code> which i ran so far in my local system and now i got to move it to the <code>server</code> so what i need to know is how will it create a <code>database</code> either using the migration files or the schema? </p>\n\n<p>Also i would like to know if from migration, i added new fields and removed few migration file so how will it create the missing fields?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":18,"score":-2,"question_id":13050067,"title":"Call javascript function on update in remote_function","body":"<p>I am working in rails 2 and making an ajax call to controller using remote_function</p>\n\n<pre><code>&lt;%= select_tag \"leave_type\", list_of_leave_type() , :onchange =&gt;  remote_function(:url =&gt; { :controller =&gt; \"requests\" ,:action =&gt; 'getUserLeaveQuota'}, :update =&gt; \"leave_quota\")%&gt;\n</code></pre>\n\n<p>in :update i want to call a javascript function, Please help me out.\nThanks</p>\n"},{"tags":["ruby-on-rails-3","activerecord","mongoid","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13048692,"title":"RoR3 + Mongoid: Filtering has_many relations while returning a collection of parents","body":"<p>I want to be able to return all instances of a model that contains a has_many association, while filtering those children using some arbitrary criteria passed by the user.</p>\n\n<p>A simplistic example:</p>\n\n<ol>\n<li>I have a list of countries which has a has_many relationship with a user model.</li>\n<li>The user specifies some search criteria.</li>\n<li>I want to be able to list the users that match that criteria grouped by country, while also displaying the countries that does not contain any users matching that criteria.</li>\n</ol>\n\n<pre class=\"lang-rb prettyprint-override\"><code>class Country\n    include Mongoid::Document\n\n    field :name\n\n    has_many :users\nend\n\nclass User\n    include Mongoid::Document\n\n    field :name\n\n    belongs_to :country\nend\n</code></pre>\n\n<p>Sample output given the user entered \"John\":</p>\n\n<pre><code>Australia (2 users):\n    - John Smith\n    - John Doe\nIndia (0 users)\nPoland (1 user):\n    - John Citizen\n</code></pre>\n\n<p>Any help will be much appreciated!</p>\n"},{"tags":["ruby-on-rails-3","devise","multi-tenant"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13046788,"title":"Can I use acts_as_tenant in the devise user model?","body":"<p>My devise MODEL name is User. When I use it in combination with acts_as_tenant,</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n   acts_as_tenant(:tenant)\n</code></pre>\n\n<p>I get some weird behaviour: When users log into one tenant, everything is fine. As soon somebody signs into another tenant, the users of the first tenant are kicked out.</p>\n\n<p>I would like to set the User model to acts_as_tenant, as the users should be administered within each tenant.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13047469,"title":"Undefined local variable or method error","body":"<p>In my ruby on rails project, I found this error in <code>update</code>.</p>\n\n<pre><code>undefined local variable or method ` ' for #&lt;ProfileController:0x007fd904dc8568&gt;.\n</code></pre>\n\n<p>However, I can't find <strong>(` ')</strong> in my controller.</p>\n\n<p><strong>ProfileController#update</strong></p>\n\n<pre><code>def update       \n   unless params[:sport_name].nil? \n     ps_array = params[:sport_name]\n     level =[params[:level1],params[:level2],params[:level3]]\n     # play_sports id \n     sp_id = [params[:sp_id1], params[:sp_id2], params[:sp_id3]]\n\n     arr = [ps_array[\"1\"],ps_array[\"2\"],ps_array[\"3\"]]\n     sport_id = [params[:sport_id1],params[:sport_id2],params[:sport_id3]]\n     check = [params[:check1], params[:check2], params[:check3]]\n\n     if @user.play_sports.count != 0\n\n       (0..2).each do |i|\n           if (check[i].to_i == 1)\n           PlaySport.where(\"id = ?\", sp_id[i]).update_all(:is_active=&gt;false)\n           # new save \n           newuser_ps = PlaySport.new\n           newuser_ps.sport_id = arr[i]\n           newuser_ps.is_active = true\n           newuser_ps.level = level[i]\n           newuser_ps.user_id = current_user.id\n           newuser_ps.save\n         end\n       end\n     else         \n       (0..2).each do |i|    \n         newuser_ps = PlaySport.new\n         newuser_ps.sport_id = arr[i]\n         newuser_ps.level = level[i]\n         newuser_ps.is_active = true\n         newuser_ps.user_id = current_user.id\n         newuser_ps.save\n       end\n     end        \n   end\n\n\n   respond_to do |format|        \n   end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":18,"score":1,"question_id":13047082,"title":"Stopping Post to external service looking for User ID","body":"<p>I'm not really sure how to describe this issue so will try to be clear.</p>\n\n<p>We have a page in our Rails application where our customers can update their credit card details. The form posts to an external service to verify the details. Then redirects back to us transparently.</p>\n\n<p>Initially I had the form in it's own controller for testing (working perfectly) but I've just moved it within my users_controller.</p>\n\n<p>The form posts and redirects to a confirm action which does some checks. When I post from within the users controller, I get an error:</p>\n\n<pre><code> Couldn't find User with id=k2hx5p36w3g9rxsz\n</code></pre>\n\n<p>Which in fact is the id of the transaction. Not the user.</p>\n\n<p>The url looks like this:</p>\n\n<pre><code> http://localhost:8080/settings/confirm?http_status=200&amp;id=k2hx5p36w3g9rxsz&amp;kind=update_payment_method&amp;hash=9c85b12c1242cd58de27b2582c934e34a0e9455e6\n</code></pre>\n\n<p>In my controller, I have this:</p>\n\n<pre><code>def billing\n  @user = current_user \n  @credit_card = current_user.default_credit_card  \n  @tr_data = CreditCard::TransparentRedirect.update_credit_card_data(:redirect_url =&gt; confirm_credit_card_info_url, :payment_method_token =&gt; @credit_card.token)\n  ...\nend\n\ndef credit_card_confirm\n  @user = current_user \n  @result = CreditCard::TransparentRedirect.confirm(request.query_string)\n\n  if @result.success?\n    redirect_to user_billing_path, :notice =&gt; \"Credit card updated\"\n  else\n    render :action =&gt; \"billing\"\n  end\nend\n</code></pre>\n\n<p>And in my routes:</p>\n\n<pre><code>match '/settings/confirm' =&gt; 'users#credit_card_confirm', :as =&gt; :confirm_credit_card_info\n</code></pre>\n\n<p>What can I do to avoid it taking the ID as the User ID?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","redirect"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":840,"score":0,"question_id":5658291,"title":"construct url without subdomain in rails 3","body":"<p>I'm currently detecting whether a user has a certain subdomain and redirecting the user to the url without the subdomain as such:</p>\n\n<pre><code>subdom = request.subdomains.first\nif subdom == \"redirectme\"\n  redirect_to(request.protocol + request.domain + \":\" + request.port.to_s)\nend\n</code></pre>\n\n<p>As you can see, I'm reconstructing the domain manually to not include the subdomain to replace something like:\n<a href=\"http://redirectme.example.com:3000\" rel=\"nofollow\">http://redirectme.example.com:3000</a>\nto:\n<a href=\"http://example.com:3000\" rel=\"nofollow\">http://example.com:3000</a></p>\n\n<p>However, I have to keep in mind that sometimes there won't be a port (and so the colon after the domain is redundant) and I suspect there are other things I didn't account for.\nWhat's a better way of getting the full domain without its subdomain component?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13036179,"title":"Running total in Rails and Active Record","body":"<p>I have a table with workouts with the following key columns:</p>\n\n<p><strong>workout_id</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>distance</strong><br>\n1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3<br>\n2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1<br> </p>\n\n<p>Let's say I want to write a Rails active record query so that I get these columns plus a running total of the distance, like so:</p>\n\n<p><strong>workout_id</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>distance</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>running_total</strong><br>\n1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3<br>\n2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4<br></p>\n\n<p>How could I do such a thing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12862076,"title":"Rails wicked gem redirect with params","body":"<p>I am using the wicked gem to build a form wizard. In the documentation it is using the current_user object but I want to use a different object. I am struggling with adding a parameter to redirect_to so I can use this object.</p>\n\n<p>products_controller.rb</p>\n\n<pre><code>def create\n  @product = current_user.product.build(params[:product])\n  @product.ip_address = request.remote_ip\n\n  if @product.save\n    redirect_to product_steps_path # This is where I think I need to pass product object but not sure how\n  else\n    render 'new'\n  end\nend\n</code></pre>\n\n<p>product_steps_controller.rb</p>\n\n<pre><code>class ProductStepsController &lt; ApplicationController\n  include Wicked::Wizard\n  steps :apps, :templates\n\n  def show\n    @product = Product.find(params[:id])\n    render_wizard\n  end\nend\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :products\nresources :product_steps\n</code></pre>\n\n<p>The error I get with the above code is:</p>\n\n<pre><code>ActiveRecord::RecordNotFound in ProductStepsController#show\n\nCouldn't find Product with id=apps\n</code></pre>\n\n<p>How do I use the wicked gem on a specific object like this instead of the current_user example in the documentation?</p>\n\n<p>Thank You</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","stored-procedures","sybase"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":13046191,"title":"how to handle the dummy stored procedure using CURSOR to return value to the front end?","body":"<p>I want to create a CURSOR in a stored procedure to handle some dummy value. In the store I need to write a dummy query like if Select 1..... to display successful message and if its not 1 or some negative value it should handle the error as what it is and display into the front-end. </p>\n\n<p>I am using Ruby on Rails in front end and Sybase 11 is the database. Thanks in advance! Any Example will be more appreciated. </p>\n\n<p>Here the example of What I tried....</p>\n\n<pre><code>ALTER PROCEDURE \"DBA\".\"sp_ProcessRDSAPBatch\"( in UserID char(10) ) \nbegin\n\n    declare cur_location_reference dynamic scroll cursor for select Lo_Code\n      from dba.RDSAPbatchLocation where User_ID = UserID;\n\n    open cur_location_reference with hold;\n      locloop: loop\n        fetch next cur_location_reference into Location_code;\n        if sqlstate = err_notfound then\n          leave locloop\n        end if;\n\n        if Location_code is not null then\n            //do some query\n        else\n           raiserror 99999 \"Location ID: %1! not found.\", @Location_Code\n        end if\n\n      end loop locloop;\n      close cur_location_reference;\n    // end of new cursor\nend\n</code></pre>\n"},{"tags":["javascript","html","ruby-on-rails-3","angularjs"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":222,"score":1,"question_id":12244774,"title":"Dynamic Add attribute in <form> angularJs","body":"<p>I am trying to add Dynamic add attribute in  using angularJs Directive\nI want to add html tag in form dynamically </p>\n\n<p>My view : </p>\n\n<pre><code>&lt;div ng-show=\"edit_tasks\"&gt;   \n   &lt;edittask-form&gt;&lt;edittask-form&gt; \n&lt;/div&gt;\n</code></pre>\n\n<p>My Form Html</p>\n\n<pre><code>{\n&lt;div&gt;\n  &lt;form ng-submit=\"submitFrom()\" csrf-tokenized&gt;\n    Task Name&lt;input type=\"text\" placeholder=\"Name\" ng-model=\"newtask.name\" required /&gt;\n    Task Description&lt;input type=\"text\" placeholder=\"Description\" ng-model=\"newtask.description\" required /&gt;\n    Start Date &lt;input type=\"text\" placeholder=\"Start date\" ng-model=\"newtask.start_date\" required /&gt;\n    Start Date &lt;input type=\"text\" placeholder=\"End date\" ng-model=\"newtask.end_date\" required /&gt;\n    &lt;input type=\"submit\" value=\"submit\" /&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n}\n</code></pre>\n\n<p>My Directives</p>\n\n<pre><code>module.directive(\"edittaskForm\", function() {\n  return {\n    restrict: \"E\",\n    templateUrl: \"&lt;%=asset_path 'tasks/task_form.html' %&gt;\",\n    controller: tasksCtrl,\n    replace: false,\n    link: function(scope, elt, attrs, controller) {\n          scope.form = elt.find(\"form\");\n          console.log(scope.form);\n\n          scope.taskEdit = function(task) {\n            scope.task =  task;\n            scope.show_tasks = false;\n            scope.edit_tasks = true;\n            scope.newtask = task;\n          };\n        }\n  }\n});\n</code></pre>\n\n<p>How Can I add <code>&lt;input type=\"text\" name=\"xyz\" /&gt;</code>\nin form</p>\n\n<p>Thk's in Advance</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":109,"score":0,"question_id":13045989,"title":"Could not find gem 'mocha (= 0.12.3) x86-mingw32'","body":"<p>I try to launch redmine from IDE:</p>\n\n<blockquote>\n  <p>rails/redmine/script/rails server -b 127.0.0.1 -p 3000 -e development</p>\n</blockquote>\n\n<p>but I am getting error:</p>\n\n<blockquote>\n<pre><code>/resolver.rb:287:in `resolve': Could not find gem 'mocha (= 0.12.3) x86-mingw32' in the gems available on this machine. (Bundler::GemNotFound)\n</code></pre>\n</blockquote>\n\n<p>I installed mocha:</p>\n\n<pre><code>gem install mocha\n</code></pre>\n\n<p>But error still appear.</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","simple-form"],"answer_count":1,"favorite_count":3,"up_vote_count":9,"down_vote_count":0,"view_count":2202,"score":9,"question_id":10547502,"title":"Append/prepend bootstrap icons with simple_form","body":"<p>Twitter Bootstrap icons are pretty deadly <a href=\"http://twitter.github.com/bootstrap/base-css.html#icons\" rel=\"nofollow\">seen here</a>. </p>\n\n<p>Look at the bottom right hand corner of that section. See that email with an icon prepended? That is what I want to do. I want to make simple_form and boostrap play nicely.</p>\n\n<p>Here's what I've found that will prepend the icon to the input:</p>\n\n<pre><code>= f.input :email, :wrapper =&gt; :append do\n  = f.input_field :email\n  &lt;span class=\"add-on\"&gt;&lt;i class=\"icon-envelope\"&gt;&lt;/i&gt;&lt;/span&gt;\n</code></pre>\n\n<p>But it isn't flush (that could be fixed by changing offsets in CSS) and it's pretty ugly. For reference, here is the CSS fix (add it to your bootstrap_overrides.css.less file):</p>\n\n<pre><code>.input-prepend .add-on,\n.input-append input {\n  float: left; }\n</code></pre>\n\n<p>Does someone know a less hacky way to make simple_form prepend or append an icon with bootstrap?</p>\n\n<h3>Update:</h3>\n\n<p>The answer below made me have another look at it. HAML usually adds whitespace everywhere, but there is a <a href=\"http://haml.info/docs/yardoc/file.HAML_REFERENCE.html#whitespace_removal__and_\" rel=\"nofollow\">workaround</a></p>\n\n<p>Here is an update for the original HAML which removes the whitespaces and doesn't require the CSS hack:</p>\n\n<pre><code>= f.input :email, :wrapper =&gt; :append do\n  = f.input_field :email\n  %span.add-on&gt;\n    %i.icon-envelope\n</code></pre>\n\n<p>That little greater than (>) makes all the difference. The output HTML has no newlines between the input and the span.</p>\n"},{"tags":["javascript","ruby-on-rails-3","aurigma"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13042868,"title":"Aurigma 7, How to hide checkAll checkbox in the folderpane header","body":"<p>Is there a way to hide checkAll checkbox in the aurigma uploader ver 7 (folder pane header)</p>\n\n<p>i tried this way, but it doesn't take any effects </p>\n\n<blockquote>\n  <p>iu.addParam(\"ButtonCheckAllText\", \"\");<br>\n  iu.addParam(\"ButtonUncheckAllText\", \"\");</p>\n</blockquote>\n\n<p>FYI</p>\n\n<p>i use Ruby on Rails, and call the aurigma with javascript</p>\n"},{"tags":["ruby-on-rails-3","activeadmin","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13041404,"title":"How to hide the resource in activeadmin gem","body":"<p>I create an admin page by using activeadmin gem <a href=\"http://activeadmin.info/\" rel=\"nofollow\">http://activeadmin.info/</a>\nI use cancan to authorize the privilege for 2 kind of user, user manage and book manage user.</p>\n\n<p>My question is: How I hide the resource User when a book manage user log in to admin page? \n<img src=\"http://i.stack.imgur.com/1C9zx.png\" alt=\"Active admin\"> </p>\n\n<p>I tried something like that but it didn't work</p>\n\n<pre><code> menu false  if can? :manage, BookHeader \n</code></pre>\n\n<p>or  </p>\n\n<pre><code> menu false  if authorize! :manage, BookHeader\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["ruby-on-rails-3","internationalization","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13043635,"title":"Strange url's generated - i18n_routing","body":"<p>Use rails 3.2, i18n, i18n_routing. </p>\n\n<p>An example of my url's </p>\n\n<pre><code>domain/nl/vakantiehuizen/house-property-name\ndomain/nl/vakantiehuizen/house-property-name/reviews\ndomain/en/ferienwohnung/house-property-name\ndomain/en/ferienwohnung/house-property-name\n</code></pre>\n\n<p>controller names (vakantiehuizen, ferienwohnung) are translated by the locales (de.yml, en.yml). The name of the controller is this example is houses controller/model </p>\n\n<p>Just a week ago i get warning messages google webmastertools! with this url's </p>\n\n<pre><code>nltarget/houses/le-carpine/\nnltarget/houses/le-carpine/reviews\n</code></pre>\n\n<p>500 responses because this page doesn't exist. </p>\n\n<p>What is wrong here? bad/slow server response? </p>\n\n<p>part of logfile:</p>\n\n<pre><code> House::Translation Load (0.4ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 17 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 20 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 24 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.4ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 13 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 2 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 4 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  House::Translation Load (0.3ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 25 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n\n  House::Translation Load (0.5ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 19 AND `house_translations`.`locale` = 'nltarget' LIMIT 1\n  Appartment::Translation Load (0.5ms)  SELECT `appartment_translations`.* FROM `appartment_translations` WHERE `appartment_translations`.`appartment_id` = 22 AND `appartment_translations`.`locale` = 'nltarget' LIMIT 1\n</code></pre>\n\n<p>i have seen that locale parameter is set to \"nltarget\" and not \"nl\"</p>\n\n<p>Mostly the locale params is set correct like this:</p>\n\n<pre><code> House::Translation Load (0.4ms)  SELECT `house_translations`.* FROM `house_translations` WHERE `house_translations`.`house_id` = 13 AND `house_translations`.`locale` = 'nl' LIMIT 1\n  Amenity::Translation Load (0.3ms)  SELECT `amenity_translations`.* FROM `amenity_translations` WHERE `amenity_translations`.`amenity_id` = 13 AND `amenity_translations`.`locale` = 'nl' LIMIT 1\n  Review::Translation Load (0.3ms)  SELECT `review_translations`.* FROM `review_translations` WHERE `review_translations`.`review_id` IS NULL AND `review_translations`.`locale` = 'nl' LIMIT 1\n  Amenity::Translation Load (0.4ms)  SELECT `amenity_translations`.* FROM `amenity_translations` WHERE `amenity_translations`.`amenity_id` = 13 AND `amenity_translations`.`locale` = 'nl' LIMIT 1\n</code></pre>\n\n<p>How is it possibly that locale \"nl\" is set to \"nltarget\"?</p>\n\n<p>Ciao..remco</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13044868,"title":"Ruby on Rails: Can't insert content into yield block","body":"<p>I have a partial called <code>_main_nav.html.erb</code> in views/layout folder, this is content file:  </p>\n\n<pre><code>&lt;% content_for :main_navigation do %&gt;\n  &lt;h1&gt;Something must here&lt;/h1&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In my <code>_header.html.erb</code> file, i used <code>yield</code> to insert content:  </p>\n\n<pre><code>... \n&lt;%= yield :main_navigation %&gt;  \n&lt;nav id=\"utility\" class=\"nav-collapse\"&gt;\n...  \n</code></pre>\n\n<p>But when i visit home page, it does'n appear h1 element, i have wrong somewhere?</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-javascript-sdk","omniauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":13044698,"title":"Facebook app stay login on canvas","body":"<p>i have a facebook app that can be access through facebook canvas or directly via the url.</p>\n\n<p>so everytime my user revisit my app, they have to click on sign in again, even if within the same session(For fb canvas only, session works fine for direct)</p>\n\n<p>Is there any tutorial or scripts that i can add to my webpage using javascript to check if user is a register user, and if yes, auto sign them in?</p>\n\n<p>I'm using rails3 and omniauth facebook gem. Thanks.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","socket.io"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":466,"score":4,"question_id":7551630,"title":"Rails 3.1 - JS - Socket.io-emit in *.js.erb gets not executed and prevents execution of jQuery-Function","body":"<p>I want to use node.js with my Rails-Project to serve asynchronous io. I don't want to use juggernaut, faye or something like this, because I need clean connections with web-socket, server-sent events and spdy without an alternative. My first try to use node.js is now to use Socket.io, just to get in use with serving data to a node.js-module with JavaScript. But it doesn't work at all.</p>\n\n<p>My application.js looks like this:</p>\n\n<pre><code>// This is a manifest file that'll be compiled into including all the files listed below.\n// Add new JavaScript/Coffee code in separate files in this directory and they'll automatically\n// be included in the compiled file accessible from http://example.com/assets/application.js\n// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the\n// the compiled file.\n//\n//= require jquery\n//= require jquery_ujs\n//= require_tree .\n\nwindow.socket = io.connect('http://localhost:8080/');\n</code></pre>\n\n<p>The requirements for io get correctly loaded in my application.html.erb:</p>\n\n<pre><code> &lt;%= javascript_include_tag \"application\", \"http://localhost:8080/socket.io/socket.io.js\" %&gt;\n</code></pre>\n\n<p>Now I want to use the socket to emit a event sent to all listening clients like this in a create.js.erb:</p>\n\n<pre><code>$(function() {\n  window.socket.emit('message', &lt;%= @message =&gt;);\n};\n$(\"#new_article\")[0].reset();\n</code></pre>\n\n<p>The message gets created in the ArticlesCrontroller this way:</p>\n\n<pre><code>def create\n  @article = current_user.articles.build(params[:article])\n  if @article.save\n    msg = {:data =&gt; @article.to_json}\n    @message = msg.to_json\n  end\nend\n</code></pre>\n\n<p>I listen at this event in an other view called index.js.erb this way:</p>\n\n<pre><code>$(function() {\n  window.socket.on('message', function (msg) {\n    $(\"#articles\").prepend(&lt;%= escape_javascript render(Article.new.from_json(msg.data)) %&gt;);\n  });\n});\n</code></pre>\n\n<p>The Socket.io looks like this: </p>\n\n<pre><code>var io = require('socket.io').listen(8080);\n\nio.sockets.on('connection', function (socket) {\n  socket.on('message', function () { });\n  socket.on('disconnect', function () { });\n});\n</code></pre>\n\n<p>and seems to work right, because it tells me right how it serves the requested js-File:</p>\n\n<pre><code>info  - socket.io started\ndebug - served static /socket.io.js\n</code></pre>\n\n<p>But it doesn't work at all, although the create.js.erb gets rendered without an error:</p>\n\n<pre><code>Rendered articles/create.js.erb (0.5ms)\nCompleted 200 OK in 268ms (Views: 70.0ms | ActiveRecord: 14.6ms)\n</code></pre>\n\n<p>Even the jQuery-Function for resetting the form gets not executed, what works without the try to emit the socket-event. The article gets saved to the database correctly, so that isn't the problem. Can someone tell me where the problem might be?</p>\n\n<p><strong>Update:</strong> I figured out by using the JavaScript-debugger of chrome, that the problem starts with the definition of <em>window.socket</em> in the application.js. The error-code is:</p>\n\n<pre><code>Uncaught ReferenceError: io is not defined\n  (anonymous function)\n</code></pre>\n\n<p>But <em>io</em> is defined in the socket.io.js-File I load in my application.html.erb. I did a workaround for application.js this way:</p>\n\n<pre><code>$.getScript('http://localhost:8080/socket.io/socket.io.js', function(){\n  window.socket = io.connect('http://localhost:8080/');\n});\n</code></pre>\n\n<p>The question is now: Why do I have to get the script this way, although it is loadet in the application.html.erb? But despite this workaround the create.js.erb still doesn't work yet. I will try to workaround that after having a bit of sleep.</p>\n"},{"tags":["ruby-on-rails-3","amazon-s3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12939903,"title":"Allowing User to Download File from S3 Storage","body":"<p>Right now I am using Amazon S3 and Paperclip which is allowing my users to upload an image that is associated with the event they are creating. My ultimate goal is since others can view this event, to be able to click on the image and have it prompt a SAVE TO their computer. As of now, clicking the link will open the image in a browser window. I rather have it ask for them to download instead. All images only saved on S3, not local. Need to hide exposed s3 url as well if possible or camouflage it</p>\n\n<p>Here is my current setup</p>\n\n<p><strong>Index.html</strong></p>\n\n<pre><code>&lt;%= link_to 'Download Creative', event.creative.url, class: \"btn btn-info\" %&gt;\n</code></pre>\n\n<p><strong>Event.rb</strong></p>\n\n<pre><code>has_attached_file :creative,\n                :styles =&gt; { :thumb =&gt; \"150x150\", :custcreative =&gt; \"250x75\" },\n                :path =&gt; \":attachment/:id/:style.:extension\",\n                :s3_domain_url =&gt; \"******.s3.amazonaws.com\",\n                :storage =&gt; :s3,\n                :s3_credentials =&gt; Rails.root.join(\"config/s3.yml\"),\n                :bucket =&gt; '*****',\n                :s3_permissions =&gt; :public_read,\n                :s3_protocol =&gt; \"http\",\n                :convert_options =&gt; { :all =&gt; \"-auto-orient\" },\n                :encode =&gt; 'utf8'\n</code></pre>\n\n<p>Hoping someone can help me out.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nginx","gzip","assets"],"answer_count":1,"favorite_count":9,"up_vote_count":7,"down_vote_count":0,"view_count":2017,"score":7,"question_id":6952639,"title":"Get NGINX to serve .gz compressed asset files","body":"<p>Rails 3.1 has a convenient system which can compress files into .gz files. However, instead what I've done is I've moved all the asset files that are created with assets:precompile to a static webserver. This all works, but how can I get nginx to serve the .gz files normally?</p>\n"},{"tags":["ruby-on-rails-3","backgroundworker","resque"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":86,"score":2,"question_id":8681079,"title":"Is it safe to pass objects into a Resque job?","body":"<p>Is it safe to pass objects into a Resque job? For example:</p>\n\n<pre><code>Resque.enqueue(Foobar, @foo, @bar)\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>Resque.enqueue(Foobar, @foo.id, @bar.id)\n</code></pre>\n\n<p>Any disadvantage if I pass the object(s) in?</p>\n"},{"tags":["ruby-on-rails-3","rails-migrations"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":13021129,"title":"What is the Rails way to handle adding a required attribute on an existing model","body":"<p>For example, I recently added 'address' fields to my user model. They are being validated by presence. So now, when I went to update a different attribute, email for example, I can't save the user because it has invalid fields (the address is still blank).</p>\n\n<p>Do you just have to migrate the data with blank strings or something?</p>\n\n<p>What is the Rails way to handle this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":13038322,"title":"unknown locale ? redirect to 404 page not working","body":"<p>use code below for redirecting 404/500 pages</p>\n\n<p>application_controller.rb</p>\n\n<pre><code>def render_404(exception)\n    @not_found_path = exception.message\n    respond_to do |format|\n      format.html { render template: 'errors/error_404', layout: 'layouts/index', status: 404 }\n      format.all { render nothing: true, status: 404 }\n    end\n  end\n\n  def render_500(exception)\n    logger.info exception.backtrace.join(\"\\n\")\n    respond_to do |format|\n      format.html { render template: 'errors/error_500', layout: 'layouts/index', status: 500 }\n      format.all { render nothing: true, status: 500}\n    end\n  end\n\n  if Rails.env.production?\n    unless Rails.application.config.consider_all_requests_local\n      rescue_from Exception, with: :render_500\n      rescue_from ActionController::RoutingError, with: :render_404\n      rescue_from ActionController::UnknownController, with: :render_404\n      rescue_from ActionController::UnknownAction, with: :render_404\n      rescue_from ActiveRecord::RecordNotFound, with: :render_404\n    end\n  end\n</code></pre>\n\n<p>This works fine for al the url paths after the locale (nl/de/en). But when i do a domain.com/errorblabla i get the standard rails page. How can i change this to the correct template? </p>\n\n<p>route.rb</p>\n\n<pre><code>resources :events do\n  collection do\n     get 'preview'\n  end\nend  \n\n\n\n\nActiveAdmin.routes(self)\n\ndevise_for :admin_users, ActiveAdmin::Devise.config\n\nscope \"/:locale\" do\nresources :leads do\n  member do \n  get \"info\"\n   end\n  end\nend\n\n\nlocalized(['en', 'nl', 'de']) do\nscope \"/:locale\" do\nresources :regions do \n  resources :events do\n  collection do\n     get 'all'\n  end\nend \n  resources :generals\n  resources :cities do\n    member do\n    get 'photo'\n  end\n  resources :events  \n  resources :restaurants do\n    member do\n    get 'photo'\n    get 'reviews'\n    get 'location'\n  end\nend\n  resources :things do\n    member do\n    get 'photo'\n    get 'reviews'\n    get 'location'\n  end\nend\n\n resources :activities do\n    member do\n    get 'photo'\n    get 'reviews'\n    get 'location'\n      end\n  end\n\n      end\n    end\n  end\nend\nresources :orders\n\nlocalized do\nscope \"/:locale\" do\nresources :houses do\n  collection do\n    get 'luxe_villa'\n    get 'zwembad'\n    get 'familie'\n    get 'groot'\n    get 'aanbiedingen'\nend\n  resources :locations\n  resources :assets\n  resources :prices\n  resources :leads\n  member do\n    get 'description'\n    get 'photo'\n    get 'price'\n    get 'location'\n    get 'reviews'\n    get 'lastminutes'\n\nend\nend\nend\nend\n\nlocalized do\nscope \"/:locale\" do\nresources :appartments do\n  collection do\n    get 'culinair'\n    get 'familie'\n    get 'justfortwo'\n    get 'lux'\n\n  end\n  resources :locations\n  resources :assets\n  resources :prices\n  resources :leads\n  member do\n    get 'description'\n    get 'photo'\n    get 'price'\n    get 'location'\n    get 'reviews'\n  end\nend\nend\nend\n\n\n  scope \"/:locale\" do\n    root :to =&gt;'homepage#index'\n    match \"/homepage\", :to =&gt; redirect(\"/nl\")\n\n\n  end\n\n\n\nmatch \"/\", :to =&gt; redirect(\"/nl\")\n\nmatch '*a', :to =&gt; 'application#render_404'\n\nend\n</code></pre>\n\n<p>Ciao..remco</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","partials","kaminari"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13042930,"title":"Partial rendering in the wrong part of the page","body":"<p>I'm using the kaminari app for pagination and when I use the <code>paginate</code> helper, the actual html renders in a completely different part of the page from where it ought to be based on the location of the helper) (though it does shift depending on where I put it).</p>\n\n<p>So for example, my page looks something like this:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;p&gt; Some text &lt;/p&gt;\n    &lt;table&gt;\n      &lt;thead&gt;\n        &lt;tr&gt;Text&lt;/tr&gt;\n      &lt;/thead&gt;\n      &lt;tfoot&gt;\n        &lt;tr&gt; &lt;%= paginate @model %&gt; &lt;/tr&gt;\n      &lt;/tfoot&gt;\n      &lt;tbody&gt;\n        &lt;tr&gt;&lt;/tr&gt;\n      &lt;/tbody&gt;\n    &lt;/table&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Except that, when the pagination is actually rendered into the template, it doesn't end up in the tfoot > tr, but rather ends up outside the table entirely.  Literally, the HTML becomes something like:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    &lt;p&gt; Some text &lt;/p&gt;\n     &lt;div class=\"paginator&gt; Kaminari html... &lt;/div&gt;\n    &lt;table&gt;\n      &lt;thead&gt;\n        &lt;tr&gt;Text&lt;/tr&gt;\n      &lt;/thead&gt;\n      &lt;tfoot&gt;\n        &lt;tr&gt; &lt;/tr&gt;\n      &lt;/tfoot&gt;\n      &lt;tbody&gt;\n        &lt;tr&gt;&lt;/tr&gt;\n      &lt;/tbody&gt;\n    &lt;/table&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I'm totally confused about why this would happen. How can the partial even output its HTML to a different location on the page??</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13042906,"title":"Rails 3 related models and date_select multiparameter attribute","body":"<p>I'm using the act_as_relation gem to create effective polymorphic relationships between my models.  <a href=\"https://github.com/hzamani/acts_as_relation/\" rel=\"nofollow\">https://github.com/hzamani/acts_as_relation/</a></p>\n\n<p>I created a date_select for one of my submodels and, when I submit, I get the following error:</p>\n\n<pre><code>2 error(s) on assignment of multiparameter attributes\n</code></pre>\n\n<p>Parameters:</p>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"authenticity_token\"=&gt;\"1vZfRC4avX6E/KQIeObEdo9F0sr89hR3IIDbTgweAx4=\",\n \"employment\"=&gt;{\"employer\"=&gt;\"\",\n \"position\"=&gt;\"\",\n \"time_start(3i)\"=&gt;\"1\",\n \"time_start(2i)\"=&gt;\"10\",\n \"time_start(1i)\"=&gt;\"2012\",\n \"time_end(3i)\"=&gt;\"1\",\n \"time_end(2i)\"=&gt;\"10\",\n \"time_end(1i)\"=&gt;\"2012\",\n \"description\"=&gt;\"\"},\n \"commit\"=&gt;\"Add\"}\n</code></pre>\n\n<p>When I add the params to Console for the parent class (where the fields are located), it works.  What gives?</p>\n"},{"tags":["ruby-on-rails-3","paypal","paypal-ipn","paypal-sandbox","paypal-subscriptions"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13042638,"title":"how to apply encryption with paypal-recurring gem?","body":"<p>Here is my usage to the paypal-recurring gem in the checkout code:</p>\n\n<pre><code>ppr = PayPal::Recurring.new(\n      return_url: new_subscription_url(:plan_id=&gt;plan_id, :accounts_number =&gt; accounts_number),\n      cancel_url: root_url,\n      description: description,\n      amount: price,\n      currency: \"USD\"\n    )\n</code></pre>\n\n<p>But, how to send parameters above encrypted to Paypal ?\nI tried to encrypt them like this:</p>\n\n<pre><code>ppr = PayPal::Recurring.new(\n      cmd: '_s-xclick',\n      encrypted: paypal_encrypted(new_subscription_url(:plan_id=&gt;plan_id, :accounts_number =&gt; accounts_number), root_url)\n    )\n</code></pre>\n\n<p>But, I got this error:</p>\n\n<pre><code>undefined method `cmd=' for #&lt;PayPal::Recurring::Base:0xbf9e4fc&gt;\n</code></pre>\n\n<p>Any idea ?</p>\n"},{"tags":["ruby-on-rails-3","selenium","cucumber"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13042446,"title":"activating Authlogic::Session::Base.controller with a controller object before creating objects","body":"<p>I've been searching for a solution for this for a while and can't seem to find anything. Whenever I run cucumber tests with the @javascript tag and try to create a user session I get a </p>\n\n<pre><code>Internal Server Error. You must activate the Authlogic::Session::Base.controller \nwith a controller object before creating objects\n</code></pre>\n\n<p>Here is my support/authlogic.rb file</p>\n\n<pre><code>require 'authlogic/test_case'\nWorld(Authlogic::TestCase)\n\nApplicationController.skip_before_filter :activate_authlogic\n\nbefore do\n  activate_authlogic\nend\n</code></pre>\n\n<p>I can not seem to figure out what is going on and it is only happening when I use the @javascript tag. Any help on how to fix this would be greatly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","thinking-sphinx"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":71,"score":0,"question_id":7475612,"title":"Sphinx server turning off/stopping on its own","body":"<p>Has anyone else had problems with a sphinx search just stopping or turning off on its own? I've set up a delta index to keep the index up to date. Every few days Sphinx will shut down and I'll have to go back and restart it. </p>\n\n<p>Can a delta index some how trigger Sphinx to turn off? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","authorization","seed"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":31,"score":1,"question_id":13041938,"title":"Rails seed.rb as admin","body":"<p>I've rolled out my own authentication/authorization system based on Hartl's for my app. I wanted to allow admins to make other users admins, so I did this in my user.rb file:</p>\n\n<pre><code>attr_accessible :name, :email, :password, :password_confirmation, :order_id\nattr_accessible :name, :email, :password, :password_confirmation, :order_id, :admin, :as =&gt; :administrator\n</code></pre>\n\n<p>and put this in my user update action:</p>\n\n<pre><code>def update\n   if current_user.admin?\n      if @user.update_attributes(params[:user], :as =&gt; :administrator)\n</code></pre>\n\n<p>This works great for me, but it's getting annoying to have to go into console and type </p>\n\n<pre><code>User.find(2).toggle!(:admin)\n</code></pre>\n\n<p>or whatever, whenever I want to make my first admin user after a db reset, or, for that matter, to have to use the console or individual edits to make other admins. I'd love it if I could seed \":as => administrator\", so I tried this in my seed.rb file, but it doesn't work (mass-assign error):</p>\n\n<pre><code>    admin = User.create(\n    :name =&gt; \"My Name\",\n    :email =&gt; \"my email\",\n    :password =&gt; \"password\",\n    :password_confirmation =&gt; \"password\",\n    :admin =&gt; true,\n    :as =&gt; :administrator\n)\n</code></pre>\n\n<p>Any idea if there's a way to do this? It'd make my life a lot easier.</p>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-javascript-sdk"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":13041699,"title":"Facebook Javascript SDK parent and popup page both redirecting in facebook login page","body":"<p><img src=\"http://i.stack.imgur.com/Wc2T1.png\" alt=\"Here is the print screen of my problem\"></p>\n\n<p>I'm having problem with my facebook Javascript SDK.... It's working but. when you click login... There will be popup show that sign you in  facebook (which is okay)..The problem is, when you signin the popup login the window do not close it stocks there... and the second problem is, the parent page is also redirect into facebook login page.. how can I fix that?\nBTW, I'm using ruby on rails.</p>\n\n<p><b>Heres my facebook.js:</b></p>\n\n<pre><code>window.fbAsyncInit = function() {\n  FB.init({\n    appId      : \"XXXXXXXXXXXXXXXX\", // App ID\n    status     : true, // check login status\n    cookie     : true, // enable cookies to allow the server to access the session\n    xfbml      : true  // parse XFBML\n\n  });\n\n\n    $(function() {\n      $(\"#signin\").click(function() {\n        FB.login(function(response, event) {\n           if (response.authResponse) {\n             $.cookie(\"user_id\", response.authResponse.userID);\n             $.cookie(\"access_token\", response.authResponse.accessToken);\n             window.location = \"#{auth_facebook_callback_url}\";\n          } else {\n          }\n        }, {scope: 'email,read_stream,publish_stream,offline_access'});\n      });\n    });\n\n\n    $(function() {\n        $(\"#signout\").click(function(){\n            FB.getLoginStatus(function(response){\n                if(response.authResponse){\n                    FB.logout();\n                }\n            });\n        });\n    }); \n };\n// Load the SDK Asynchronously\n(function(d){\n   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];\n   if (d.getElementById(id)) {return;}\n   js = d.createElement('script'); js.id = id; js.async = true;\n   js.src = '//connect.facebook.net/en_US/all.js';\n   ref.parentNode.insertBefore(js, ref);\n }(document));\n</code></pre>\n\n<p>Thanks in Advance :)</p>\n"},{"tags":["ruby-on-rails-3","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13041362,"title":"FactoryGirl attributes_for and associations","body":"<p>I'm trying to test associations in my Rspec controller tests. Problem is that Factory doesn't produce associations for the attributes_for command. So, following the suggestion in <a href=\"http://stackoverflow.com/questions/5103572/factorygirl-attributes-for-not-giving-me-associated-attributes\">this post</a> I defined my validate attributes in my controller spec like so:</p>\n\n<pre><code>def valid_attributes\n   user = FactoryGirl.create(:user)\n   country = FactoryGirl.create(:country)\n   valid_attributes = FactoryGirl.build(:entitlement, user_id: user.id, country_id: country.id, client: true).attributes.symbolize_keys\n   puts valid_attributes\nend\n</code></pre>\n\n<p>However, when the controller test runs I still get the following errors:</p>\n\n<pre><code> EntitlementsController PUT update with valid params assigns the requested entitlement as @entitlement\n    Failure/Error: entitlement = Entitlement.create! valid_attributes\n    ActiveRecord::RecordInvalid:\n    Validation failed: User can't be blank, Country can't be blank, Client  &amp; expert are both FALSE. Please specify either a client or expert relationship, not both\n</code></pre>\n\n<p>Yet the the valid_attributes output in the terminal clearly shows that each valid_attribute has a user_id, country_id and expert is set to true:</p>\n\n<pre><code>  {:id=&gt;nil, :user_id=&gt;2, :country_id=&gt;1, :client=&gt;true, :expert=&gt;false, :created_at=&gt;nil, :updated_at=&gt;nil}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave","fog"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":144,"score":0,"question_id":13041498,"title":"undefined method `fog_host='","body":"<p>When i'm trying to run my application, i'm getting the following error:</p>\n\n<blockquote>\n  <p>config/initializers/carrierwave.rb:4: undefined method `fog_host=' for\n  CarrierWave::Uploader::Base:Class (NoMethodError)</p>\n</blockquote>\n\n<p>Here is my <strong>initializers/carrierwave.rb</strong> file:</p>\n\n<pre><code>CarrierWave.configure do |config|\n  config.storage = :fog\n  config.fog_directory = 'media.domain.pl'\n  config.fog_host = 'http://s3-eu-west-1.amazonaws.com/media.domain.pl'\n\n  config.fog_credentials = {\n    :provider =&gt; 'AWS',\n    :aws_access_key_id =&gt; '***',\n    :aws_secret_access_key =&gt; '***',\n    :region =&gt; 'eu-west-1',\n  }\nend\n</code></pre>\n\n<p>I have <code>carrierwave</code> and <code>fog</code> included in my <code>Gemfile</code> and it was working until last use of <code>bundle update</code>. Have you any idea what can be wrong with my code? I can't find anything about it in google</p>\n\n<p>ruby v. 1.8.7<br>\nrails v. 3.2.6<br>\nfog v. 1.6.0<br>\ncarrierwave v. 0.7.0</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":941,"score":2,"question_id":10208927,"title":"Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id","body":"<p>I would like to know if someone could help me. I'm learning now ROR and have run in some troubles.\nI have created other_users and post model using scaffold. other_users has many:posts and so one.\nThe idea is that, when the user is logged in and creates a Post, in show action shows the name of the user which created this post.\n I would like to know if someone can tel me with this.</p>\n\n<p>Post controller</p>\n\n<pre><code>def new\n    @post = Post.new(:other_user_id =&gt; @other_user.id)\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @post }\n    end\n  end\ndef create\n    @post = Post.new(params[:post])\n\n    respond_to do |format|\n      if @post.save\n        format.html { redirect_to @post, notice: 'Post was successfully created.' }\n        format.json { render json: @post, status: :created, location: @post }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @post.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>Post view _form:</p>\n\n<pre><code>&lt;%= form_for(:post, :url =&gt; {:action =&gt; 'create', :other_user_id =&gt; @other_user.id}) do |f| %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :title %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :content %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :content %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I know that something is wrong with that, but i'm quite new with that so i can't figure it out on my own</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13041028,"title":"Rails, how to get 1.day.from_now at a set time (morning)?","body":"<p>I currently queue my DelayedJob like so:</p>\n\n<pre><code>Delayed::Job.enqueue MyJob.new, 5, 1.day.from_now\n</code></pre>\n\n<p>I'm looking for a way to set a different execution time:</p>\n\n<pre><code>Tomorrow morning at 9:30am PST\n</code></pre>\n\n<p>Does Rails have a helper that can take care of this? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","apache","nginx","webserver"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":13041320,"title":"What is the fastest Rails production environment?","body":"<p>I've read a little about deploying applications with Rails but it is all very confusing, there are so many possibilities. Therefore, I'd like to know (not based on your opinion, but rather on your experience or benchmarks you may know) what is the best performance setup you can have for a RoR 3.2 app ?</p>\n\n<p>What I mean by this is the setup for webserver like should I use Apache or Nginx, is it possible to run Nginx with Passenger or is it better to run it with Mongrel or Unicorn.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design","postgresql","multi-tenant"],"answer_count":3,"favorite_count":3,"up_vote_count":2,"down_vote_count":0,"view_count":973,"score":2,"question_id":7003024,"title":"Multi-tenant rails application: what are the pros and cons of different techniques?","body":"<p>I originally wrote my Ruby on Rails application for one client. Now, I am changing it so that it can be used for different clients. My end-goal is that some user (not me) can click a button and create a new project. Then all the necessary changes (new schema, new tables, handling of code) are generated without anyone needing me to edit a database.yml file or add new schema definitions. I am currently using the SCOPED access. So I have a project model and other associated models have a project_id column.</p>\n\n<p>I have looked at other posts regarding multi-tenant applications in Rails. A lot of people seem to suggest creating a different schema for each new client in Postgres. For me, however, it is not much useful for a new client to have a different schema in terms of data model. Each client will have the same tables, rows, columns, etc. </p>\n\n<p>My vision for each client is that my production database first has a table of different projects/clients. And each one of those tables links to a set of tables that are pretty much the same with different data. In other terms a table of tables. Or in other terms, the first table will map to a different set of data for each client that has the same structure.</p>\n\n<p>Is the way I explained my vision at all similar to the way that Postgres implements different \"schemas\"? Does it look like nested tables? Or does Postgres have to query all the information in the database anyway? I do not currently use Postgres, but I would be willing to learn if it fits the design. If you know of database software that works with Rails that fits my needs, please do let me know.</p>\n\n<p>Right now, I am using scopes to accomplish multi-tenant applications, but it does not feel scalable or clean. It does however make it very easy for a non-technical user to create a new project provided I give them fillable information. Do you know if it is possible with the multi-schema Postgres defintion to have it work automatically after a user clicks a button? And I would prefer that this be handled by Rails and not by an external script if possible? (please do advise either way)</p>\n\n<p>Most importantly, do you recommend any plugins or that I should adopt a different framework for this task? I have found Rails to be limited in some cases of abstraction as above and this is the first time I have ran into a Rails-scaling issue.</p>\n\n<p>Any advice related to multi-tenant applications or my situation is welcome. Any questions for clarification or additional advice are welcome as well.</p>\n\n<p>Thanks,\n--Dave</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13040629,"title":"In ActiveRecord, validate that an attribute is present but may be empty","body":"<p>I'm trying to set up my model in Rails 3.2.8 such that particular values must be present, but are allowed to be the empty string. Does anyone know how to do this?</p>\n\n<p>The behavior I'm looking for looks like:</p>\n\n<pre><code>@foo.value = \"this is a real value\"\n@foo.valid? # =&gt; true\n\n@foo.value = nil\n@foo.valid? # =&gt; false\n\n@foo.value = \"\"\n@foo.valid? # =&gt; true\n</code></pre>\n\n<p>If I use </p>\n\n<pre><code>validates :foo, :presence =&gt; true\n</code></pre>\n\n<p>then I get what I want for 1 and 2, but not 3. And, helpfully, <code>:allow_blank =&gt; true</code> is <a href=\"http://guides.rubyonrails.org/active_record_validations_callbacks.html#allow_blank\" rel=\"nofollow\">ignored</a> when validating presence.</p>\n\n<p>I also tried</p>\n\n<pre><code>validates :foo, :length =&gt; { :minimum =&gt; 0 }, :allow_nil =&gt; false\n</code></pre>\n\n<p>Same behavior: get what I want for 1 and 2, but not 3.</p>\n\n<p>I suppose I could just mark the column as <code>NOT NULL</code> in the database, but then I have to deal with catching the exception; I'd really rather catch this at the validation stage.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongoid","activemodel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13034879,"title":"How to hook into an embedded array in Mongoid?","body":"<p>In a rails 3 app with a mongoid backend, I have a class owner, that embeds many items. Items are arbitrarily sortable by a numeric field \"index\".\nHowever whenever I add a new item to my owner, the item’s index should be the highest index of the existing items +1.</p>\n\n<p>I can think of different ways on how to implement that, but would want to know which one you consider the best.</p>\n\n<p>This sortability is refactored out into a module like so:</p>\n\n<pre><code>module ComparableByIndex\n\n  include Comparable\n\n  def self.included(o)\n    o.class_eval do\n      field :index, :type =&gt; Integer, :default =&gt; -1\n      scope :sorted, asc(:index)\n    end\n  end\n\n  def &lt;=&gt;(other)\n    return 0 if !index &amp;&amp; !other.index\n    return 1 if !index\n    return -1 if !other.index\n    index &lt;=&gt; other.index\n  end\n\nend\n\nclass Owner\n  include Mongoid::Document\n  embeds_many :items, cascade_callbacks: true\nend\n\nclass Item\n  include Mongoid::Document\n  include ComparableByIndex\nend\n</code></pre>\n\n<p>In the best case, I would be able to put the code here (but I have no idea, how this could be possible)</p>\n\n<p>O course, it would be ideal, if, upon removing an item, eventual \"holes\" in the range of indices in the would be closed. But this is more for code esthetic reasons, I guess.</p>\n\n<p>PS: I know, that naming a field \"index\" is a bad idea, but so far, I have no troubles with it…</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","google-maps","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13024920,"title":"gmaps4rails isn't displaying given coordinates","body":"<p>I have gotten the entire map to display correctly with no issues.  However, the map always loads at coordinates of <code>0,0</code>.  I know I'm passing the longitude and latitude correctly as well.</p>\n\n<p>Here's the printed json which the <code>gmaps4rails</code> method receives:</p>\n\n<p><code>[{\"lat\":40.7142,\"lng\":74.0064}]</code></p>\n\n<p>Below is also the code used in various areas of production...</p>\n\n<p><strong>VIEW</strong></p>\n\n<pre><code>&lt;%= @maps %&gt;\n&lt;%= gmaps4rails(@maps) %&gt;\n</code></pre>\n\n<p><strong>MODEL</strong></p>\n\n<pre><code>acts_as_gmappable :process_geocoding =&gt; false, :lat =&gt; :lat, :lng =&gt; :lng\n\ndef lat\n  40.7142\nend\n\ndef lng\n  74.0064\nend\n</code></pre>\n\n<p><strong>CONTROLLER</strong></p>\n\n<p><code>@maps = Event.find(params[:id]).to_gmaps4rails</code></p>\n\n<p>I've decided as you'll see in my model to explicitly pass a latitude and longitude.  I do have my database setup with columns <code>latitude</code> and <code>longitude</code>, however, I'm working with test data at the moment and cannot expect a reliable result.  Until then, I'll use the coordinates for New York City, NY.</p>\n\n<p>Here's the outputted Javascript:</p>\n\n<pre><code>Gmaps.map = new Gmaps4RailsGoogle();\nGmaps.load_map = function() {\nGmaps.map.map_options.auto_adjust = true;\nGmaps.map.initialize();\nGmaps.map.markers = [{\"lat\":40.7142,\"lng\":74.0064}];\nGmaps.map.markers_conf.do_clustering = true;\nGmaps.map.create_markers();\nGmaps.map.adjustMapToBounds();\nGmaps.map.callback();\n};\nGmaps.oldOnload = window.onload;\n window.onload = function() { Gmaps.triggerOldOnload(); Gmaps.loadMaps(); };\n</code></pre>\n\n<p>I do get an error <code>Uncaught TypeError: Object #&lt;Gmaps4RailsGoogle&gt; has no method create_markers</code>.</p>\n\n<p>Also, here is a picture of the issue (notice the printed json above the map as done in the view code above):</p>\n\n<p><img src=\"http://i.stack.imgur.com/RzPt2.png\" alt=\"A lovely little description!\"></p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","activerecord","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13039106,"title":"Select all rows from three nested tables","body":"<pre><code>class Channel &lt; ActiveRecord::Base\n  has_many :programs\n\nend\n\nclass Program &lt; ActiveRecord::Base\n  belongs_to :channel\n  has_many :program_schedules\n\nend\n\nclass ProgramSchedule &lt; ActiveRecord::Base\n  belongs_to :program\nend\n</code></pre>\n\n<p>I would want to get an array of data like this:</p>\n\n<ul>\n<li><p>Channel 1:</p>\n\n<ul>\n<li><p>Program 1 </p>\n\n<ul>\n<li>Schedule 1</li>\n</ul></li>\n<li><p>Program 2 </p>\n\n<ul>\n<li>Schedule 1</li>\n<li>Schedule 2</li>\n<li>Schedule 3</li>\n</ul></li>\n</ul></li>\n<li><p>Channel 2:</p>\n\n<ul>\n<li>Program 1 \n<ul>\n<li>Schedule 1</li>\n<li>Schedule 2</li>\n<li>Schedule 3</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>I have tried with this query, but it retrieve only \"channel\"-rows (without Programs and Schedules)</p>\n\n<pre><code> @data = Channel.joins(:programs =&gt; :program_schedules).group(\"channel_id\")\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":13040088,"title":"Does anyone know a js lib for dynamic tables with pagination?","body":"<p>I have created a rails controller that returns JSON data. So, I cannot render the data on the server as usual with rails.</p>\n\n<p>I can create a simple JS that can just take the JSON and create a table. But I which to support pagination. I looked a few such tables from jquery plugins but they do not use Bootstrap css, so it looks pretty nasty in my layout.</p>\n\n<p>Has anyone encountered such a problem?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3","coffeescript"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":107,"score":1,"question_id":13039830,"title":"How to port Javascript project to Coffeescript","body":"<p>If I wanted to port an existing project from Javascript to Coffeescript (in my case, within a Rails application), would I need to convert existing Javascript files?  I'm worried about converting really large and CDN hosted files like jQuery and jQueryUI.  How would I work around that?</p>\n"},{"tags":["ruby","ruby-on-rails-3","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":13033749,"title":"How to access validation error messages in RSpec files?","body":"<p>I am writing up some code for my first Rails app and can't seem to find the best way to look up my validation errors so that I can easily put them in without repeating myself.</p>\n\n<p>I would like to turn this:</p>\n\n<pre><code>let(:error_messages) { page.find 'div#error_explanation ul' }\nspecify { error_messages.should have_content \"Name can't be blank\" }\nspecify { error_messages.should have_content \"Email can't be blank\" }\nspecify { error_messages.should have_content \"Email is invalid\" }\nspecify { error_messages.should have_content \"Password can't be blank\" }\nspecify { error_messages.should have_content \"Password is too short (minimum is 6 characters)\" }\nspecify { error_messages.should have_content \"Email is invalid\" }\n</code></pre>\n\n<p>Into something like this:</p>\n\n<pre><code>let(:error_messages) { page.find 'div#error_explanation ul' }\nspecify { error_messages.should have_content \"errors.name_blank\" }\nspecify { error_messages.should have_content \"errors.email_blank\" }\nspecify { error_messages.should have_content \"errors.email_invalid\" }\nspecify { error_messages.should have_content \"errors.password_invalid\" }\nspecify { error_messages.should have_content \"errors.password_short\" }\nspecify { error_messages.should have_content \"errors.email_invalid\" }\n</code></pre>\n\n<p>Thanks!</p>\n"}]}
{"total":34675,"page":13,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13039274,"title":"Perform different field validation for the same model from 2 different controllers","body":"<p>I am trying to generate a quick registration form to use Facebook, Twitter and Linked sign in on my app. But I do have user model that validates some fields on the previous sign up procedure.</p>\n\n<p>I am trying to extend the Registration controller, based on Devise, in order to use the same database for quick registration from the external sign in. This question is formulated because I am running a trial and then I have the sign up form asking for the credit card. </p>\n\n<p>I have this controller:</p>\n\n<pre><code>class Users::QuickRegistrationController &lt; Users::RegistrationsController\n\n  self.model_class = Users::RegistrationsController\n\nend\n</code></pre>\n\n<p>And then I have this user model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base  \n  validates :name, :presence =&gt; true\n  validates :first_surname, :presence =&gt; true\n  validates :prefered_language, :presence =&gt; true\n  validates :dni, :presence =&gt; true, :uniqueness =&gt; true #, :format =&gt; {:with =&gt; /(^\\d{7,8}[a-zA-Z]$)|(^[a-zA-Z]\\d{7}[a-zA-Z]$)/, :unless =&gt; \"dni.blank?\"}\n  validates :phone_number, :presence =&gt; true, :format =&gt; { :with =&gt; /^((\\d{9})|([+]\\d{11}))$/, :unless =&gt; \"phone_number.blank?\"}, :uniqueness =&gt; true\n  validates :birthdate, :presence =&gt; true, :age =&gt; {:adult =&gt; :over}\n  validates :legal_conditions, :acceptance =&gt; {:accept =&gt; true}\n  validates :email, :confirmation =&gt; true\n  validates :email_confirmation, :presence =&gt; true\n  validates :password_confirmation, :presence =&gt; true, :if =&gt; \"new_record?\"\n  validates :country, :presence =&gt; true\n</code></pre>\n\n<p>Can I say something like validates :first_surname, :presence => false for the Users::QuickRegistrationController and :first_surname, :presence => true for Users::RegistrationsController?</p>\n\n<p>Additionally, there's a solution to solve this issue on Ruby, can you provide any tutorial or related link?</p>\n"},{"tags":["javascript","html","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":13039429,"title":"Returning javascript from rails helper","body":"<p>I am having problems returning javascript from helper functions. I am unable to get the following test case to work:</p>\n\n<p>function in helpers/application_helper.rb</p>\n\n<pre><code>def show_stuff\n    return '$(\"div#flash\").html(\"&lt;p&gt; stuff &lt;/p&gt;\");'\nend\n</code></pre>\n\n<p>now I try to call this helper function in general.js.erb</p>\n\n<pre><code>&lt;%= show_stuff %&gt;\n</code></pre>\n\n<p>Here is the output</p>\n\n<pre><code>$(&amp;quot;div#flash&amp;quot;).html(&amp;quot;&amp;lt;p&amp;gt; stuff &amp;lt;/p&amp;gt;&amp;quot;);\n</code></pre>\n\n<p>I've also tried show_stuff.html_safe and raw show_stuff and had no luck. I feel the issue is Rails auto-escaping html but have been unable to find a solution.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","bundler"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":126,"score":0,"question_id":9490781,"title":"Rails 3 / Passenger - uninitialized constant Bundler","body":"<p>running: ruby 1.8.7-p358, rails 3.0.3, rvm 1.10.3, passenger, apache</p>\n\n<p>I copied a rails project directory from one server to another.  Created its database - imported dump.sql,  Updated apache.conf for passenger link, ran touch tmp/restart.txt</p>\n\n<p>Receiving error: </p>\n\n<pre><code>uninitialized constant Bundler \n</code></pre>\n\n<p>I have already tried:</p>\n\n<pre><code>'gem install bundler'\n'bundle install' \n deleting Gemfile.lck file, 'bundle install'\n</code></pre>\n\n<p>Any other ideas?  Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13038560,"title":"Rails 3 view sytax error","body":"<p>Ruby 1.9.3-p194</p>\n\n<p>Rails 3.0.3</p>\n\n<p>I was having libcrypt errors today, and after hours of troubleshooting, I uninstalled rvm, ruby and gems.  I reinstalled everything, but now my application throws errors.  I made no changes to my code, but this worked fine before reinstallation:</p>\n\n<pre><code>ActionView::Template::Error (/home/username/apps/vits/app/views/layouts/application.html.erb:19: syntax error, unexpected ',', expecting ')'\nif (current_user.admin == true, \"Admin Menu\", adminmenu_path...\n/home/username/apps/vits/app/views/layouts/application.html.erb:19: syntax error, unexpected ',', expecting ')'\n...er.admin == true, \"Admin Menu\", adminmenu_path) );@output_bu....\n/home/username/apps/vits/app/views/layouts/application.html.erb:22: syntax error, unexpected keyword_do_block, expecting keyword_end\n');@output_buffer.append_if_string=  flash.each do |name, msg|\n/home/username/apps/vits/app/views/layouts/application.html.erb:22: syntax error, unexpected '|', expecting '='\n');@output_buffer.append_if_string=  flash.each do |name, msg|\n/home/username/apps/vits/app/views/layouts/application.html.erb:44: syntax error, unexpected keyword_ensure, expecting $end):\n16:     &lt;div id=\"header\"&gt;\n17:             &lt;div class=\"wrap clear\"&gt;                        \n18:                 &lt;% if current_user %&gt;  \n19:                     &lt;%= link_to \"Logout\", logout_path %&gt;  |  &lt;%= link_to \"Main Menu\", usermenu_path %&gt;  |  &lt;%= link_to_if (current_user.admin == true, \"Admin Menu\", adminmenu_path) %&gt;\n20:                 &lt;% end %&gt;\n21:             &lt;/div&gt;\n22: &lt;%- flash.each do |name, msg| -%&gt;\napp/controllers/user_sessions_controller.rb:29:in `new'\n</code></pre>\n\n<p>Any ideas?  This is a bad RoR day for me.<br>\nThanks in advance.  -Katie</p>\n\n<p>Edited to add entire application.html.erb:</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\n  \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;title&gt;&lt;%= h(yield(:title) || \"Vendor Invoice Tracking System (VITS)\") %&gt;&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" href=\"stylesheets/scaffold.css\" type=\"text/css\" media=\"all\" charset=\"utf-8\" /&gt;\n    &lt;%= stylesheet_link_tag 'scaffold' %&gt;\n    &lt;%= javascript_include_tag :defaults %&gt;\n    &lt;%= javascript_include_tag \"tablesort.js\" %&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;div id=\"siteholder\"&gt;\n\n    &lt;div id=\"header\"&gt;\n            &lt;div class=\"wrap clear\"&gt;                        \n                &lt;% if current_user %&gt;  \n                    &lt;%= link_to \"Logout\", logout_path %&gt;  |  &lt;%= link_to \"Main Menu\", usermenu_path %&gt;  |  &lt;%= link_to_if ((current_user.admin == true, \"Admin Menu\", adminmenu_path)) %&gt;\n                &lt;% end %&gt;\n            &lt;/div&gt;\n&lt;%- flash.each do |name, msg| -%&gt;\n&lt;%= content_tag :div, msg, :id =&gt; \"flash_#{name}\" %&gt;&lt;/p&gt;\n&lt;div class=\"clear\"&gt;&lt;/div&gt;\n&lt;%- end -%&gt; \n\n        &lt;% if current_user %&gt;       \n            &lt;div id=\"content1\"&gt;             \n                &lt;%= yield %&gt;\n            &lt;/div&gt;\n\n        &lt;% else %&gt;\n\n            &lt;div id=\"content\"&gt;\n                &lt;div id=\"content1\"&gt;\n                &lt;/div&gt;\n                &lt;%= yield %&gt;\n            &lt;/div&gt;\n        &lt;% end %&gt;\n\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rack","unicorn"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":162,"score":1,"question_id":12007727,"title":"Unicorn + Rack Lint Error - content header","body":"<p>I keep getting the follow server error when running unicorn on my local machine:</p>\n\n<pre><code>E, [2012-08-17T10:25:11.961002 #95265] ERROR -- : app error: Content-Length header was 780958, but should be 781014 (Rack::Lint::LintError)\nE, [2012-08-17T10:25:11.961578 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/lint.rb:19:in `assert'\nE, [2012-08-17T10:25:11.961893 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/lint.rb:501:in `verify_content_length'\nE, [2012-08-17T10:25:11.962173 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/lint.rb:525:in `each'\nE, [2012-08-17T10:25:11.962806 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/body_proxy.rb:26:in `method_missing'\nE, [2012-08-17T10:25:11.963116 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/unicorn-4.3.1/lib/unicorn/http_response.rb:41:in `http_response_write'\nE, [2012-08-17T10:25:11.963416 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:539:in `process_client'\nE, [2012-08-17T10:25:11.963702 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:606:in `worker_loop'\nE, [2012-08-17T10:25:11.963985 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:487:in `spawn_missing_workers'\nE, [2012-08-17T10:25:11.964288 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:137:in `start'\nE, [2012-08-17T10:25:11.964744 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/gems/unicorn-4.3.1/bin/unicorn:121:in `&lt;top (required)&gt;'\nE, [2012-08-17T10:25:11.965043 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/bin/unicorn:19:in `load'\nE, [2012-08-17T10:25:11.965339 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/bin/unicorn:19:in `&lt;main&gt;'\nE, [2012-08-17T10:25:11.965624 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'\nE, [2012-08-17T10:25:11.966223 #95265] ERROR -- : /Users/cscairns/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>Has anyone run into the same issue?</p>\n"},{"tags":["ruby-on-rails-3","rspec","mocking","helper","stub"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":13036718,"title":"Stub helper method for request spec in rails / rspec","body":"<p>I have a helper method called get_books_from_amazon that does an API call and returns an array of books.  I can't figure out how to stub it out in my request specs.</p>\n\n<pre><code>module BooksHelper\n  def get_books_from_amazon(search_term)\n    ...\n  end\nend\n\nclass StaticController &lt; ApplicationController\n  include BooksHelper\n  def resources\n    @books = get_books_from_amazon(search_term)\n  end\nend\n</code></pre>\n\n<p>I have tried the following in my spec, each to no avail:</p>\n\n<pre><code># spec/requests/resource_pages_spec.rb\n...\ndescribe \"Navigation\" do\n  it \"should do such and such\" do\n    BooksHelper.stub!(:get_books_from_amazon).and_return(book_array)\n    StaticHelper.stub!(:get_books_from_amazon).and_return(book_array)\n    ApplicationHelper.stub!(:get_books_from_amazon).and_return(book_array)\n    StaticController.stub!(:get_books_from_amazon).and_return(book_array[0..4])\n    ApplicationController.stub!(:get_books_from_amazon).and_return(book_array[0..4])\n    request.stub!(:get_books_from_amazon).and_return(book_array)\n    helper.stub!(:get_books_from_amazon).and_return(book_array)\n    controller.stub!(:get_books_from_amazon).and_return(book_array)\n    self.stub!(:get_books_from_amazon).and_return(book_array)\n    stub!(:get_books_from_amazon).and_return(book_array)\n\n    visit resources_path\n    save_and_open_page\n  end\n</code></pre>\n\n<p>Any ideas on what the problem is?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13038648,"title":"Inserting a column value with null in ruby on rails","body":"<p>I want to customize the value inserted in the column in the controller and i want to insert a null value in it. In this way :</p>\n\n<pre><code>@users.to = null\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","rails-admin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13038582,"title":"Rails Admin Username and Password once deployed ROR","body":"<p>I have finally managed to launch my app after many days of trying but am now facing a problem. </p>\n\n<p>The app uses rails admin to allow an admin user (me hopefully...) to control the objects being output in the app. </p>\n\n<p>However I have pushed the app to Heroku having removed all devise sign up options (I don't want other people to be able to sign up) and as the database has brand new tables and a clean slate, the login details I was using on my localhost are no longer working. </p>\n\n<p>Is there a way for me to create a username and password in my new Heroku database using just the console?</p>\n\n<p>If this isn't the right approach then how can I best set-up my admin user?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":51,"score":8,"question_id":13036550,"title":"Rails invalid datetime on model results in nil","body":"<p>I have a model with a datetime attribute. I am trying to validate incoming JSON which would update the model. But ActiveRecord seems to be setting the value of the attribute to nil if it is an invalid datetime. I can't respond with the appropriate error because the attribute is allowed to be nil. What am I doing wrong?</p>\n\n<p>Code:</p>\n\n<pre><code>class DatetimeValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attribute, value)\n    value.to_datetime rescue record.errors[attribute] &lt;&lt; (options[:message] || \"must be a date.\")\n  end\nend\n\nclass Foo\n   # column :my_date, :datetime\n   validates :my_date, :allow_nil =&gt; true, :datetime =&gt; true\nend\n</code></pre>\n\n<p>Console:</p>\n\n<pre><code>1.9.3p125 :001 &gt; x = Foo.new\n=&gt; #&lt;Foo id: nil, my_date: nil&gt;\n1.9.3p125 :001 &gt; x.my_date = 'bad value'\n=&gt; 'bad value'\n1.9.3p125 :001 &gt; x.my_date\n=&gt; nil\n1.9.3p125 :001 &gt; x.valid?\n=&gt; true\n</code></pre>\n\n<p>As far as ActiveRecord is concerned, setting the datetime attribute to 'bad_value' is equivalent to setting it to nil, so I can't validate it, since my_date is not required. This seems like a bug to me. What is the best workaround?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":13037475,"title":"to_sql not working on update_attributes or .save","body":"<p>I'm looking for a way to store the sql string that is generated in an update or create action. I've tried appending <code>.to_sql</code> to the end of <code>update_attributes</code> but it returns a <code>TrueClass</code> error (or something like that). Is there something that I am missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","ruby-on-rails-3.2","cpanel"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12926876,"title":"creating email accounts for cpanel using ruby on rails","body":"<p>Does anybody know how i can go about creating email accounts and maybe read mails from my cpanel using a rails app without going directly to the cpanel to create the email accounts. This is really help and it can save me a lot a time logging into the cpanel. Which means i should be able to create the email accounts with my rails app. Thank You</p>\n"},{"tags":["ruby-on-rails-3","will-paginate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":131,"score":0,"question_id":8530373,"title":"will_paginate with a variable per_page is loading lazily on test or production","body":"<p>I'm handling the results per page dynamically like this:</p>\n\n<pre><code>class Entry &lt; ActiveRecord::Base\n\n  self.per_page = GeneralSetting.where(:key =&gt; 'default_message_number').first.value\n  #...\n</code></pre>\n\n<p>In development env. is working correctly, but if I change <code>default_message_number</code> on test or production env., it keeps showing the previous number of records. If I restart the machine, it takes the new changes.\nIs there a way to make this query always, regardless of the environment?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","internationalization","activeadmin","mongoid3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13037463,"title":"ActiveAdmin + Mongoid localized fields","body":"<p>I'm using Mongoid as a storage and ActiveAdmin as an admin backend in my Rails project. And I need to support a couple of languages.</p>\n\n<p>Native Rails i18n works perfectly for static texts. But I need also translate db content. I've found that mongoid natively support localized fields: <a href=\"http://mongoid.org/en/mongoid/docs/documents.html#localized_fields\" rel=\"nofollow\">http://mongoid.org/en/mongoid/docs/documents.html#localized_fields</a> .</p>\n\n<p>Is there any good way to use ActiveAdmin and this cool feature together?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","naming-conventions","ruby-on-rails-3.2","convention-over-configur"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13037223,"title":"Where to put constraint classes in Rails project","body":"<p>Just curious about the best practices for Rails in where I put a custom constraints class that's used as a constraint in config/routes.rb. Seems like <code>Rails.root/lib</code> is where all user classes go. Is that appropriate for this? Should I be creating a directory inside for constraints? 2 empty directories exist there now, <code>assets</code> and <code>tasks</code>. Are there conventions for this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","find-by-sql"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1495,"score":2,"question_id":7145645,"title":"Rails, how to sanitize SQL in find_by_sql","body":"<p>Is there a way to sanitize sql in rails method <code>find_by_sql</code>?</p>\n\n<p>I tried that solution:\n<a href=\"http://stackoverflow.com/questions/2497757/ruby-on-rails-how-to-sanitize-a-string-for-sql-when-not-using-find\">Ruby on Rails: How to sanitize a string for SQL when not using find?</a></p>\n\n<p>But it fails at</p>\n\n<pre><code>Model.execute_sql(\"Update users set active = 0 where id = 2\")\n</code></pre>\n\n<p>It throws error, but sql code is executed and user with ID 2 now have disabled account.</p>\n\n<p>Simple <code>find_by_sql</code> also don't work:</p>\n\n<pre><code>Model.find_by_sq(\"UPDATE user set active = 0 where id = 1\")\n# =&gt; code executed, user with id 1 have now ban\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Well my client requested to make that function(select by sql) in admin panel to make some complex query(joins, special conditions etc). So I really want to find_by_sql that.</p>\n\n<p><strong>Second Edit:</strong></p>\n\n<p>I want to achieve that 'evil' SQL code won't be executed.</p>\n\n<p>In admin panel you can type query -> <code>Update users set admin = true where id = 232</code> and I want to block any UPDATE / DROP / ALTER SQL command.\nJust want to know, that here you can ONLY execute SELECT.</p>\n\n<p>After some attempts I conclude <code>sanitize_sql_array</code> unfortunatelly don't do that.</p>\n\n<p>Is there a way to do that in Rails??</p>\n\n<p>Sorry for the confusion..</p>\n"},{"tags":["ruby-on-rails-3","coffeescript"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":13036370,"title":"How to namespace coffeescript in a Rails project","body":"<p>In my Rails project, in which I am using Coffeescript, I want to be able to do something like this in a view:</p>\n\n<pre><code>f.text_area :content, :size =&gt; \"77x4\", :oninput =&gt; 'Helpers.expandTextarea(300)'\n</code></pre>\n\n<p>This would call a coffeescript function that would expand the textarea when required. My problem is that I can't seem to properly namespace the coffeescript to get this to work. I tried to do it like this</p>\n\n<pre><code># site.js.coffee\nHelpers =\n  expandTextarea: -&gt;\n    alert \"function found!\"\n</code></pre>\n\n<p>This doesn't work. Trying to call <code>Helpers</code> in the browser console will throw an <code>undefined</code> error. My question is this:</p>\n\n<p><strong>What code would I use in site.js.coffee to achieve the namespacing I want?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","ruby-on-rails-3.2","bundler"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":13025919,"title":"bundle install not working on rails fork","body":"<p>If I checkout or fork <a href=\"https://github.com/rails/rails\" rel=\"nofollow\">the rails project on github</a>, I get an error when running <code>bundle install</code> that sprockets-rails can't be found. How do I get these gems installed?</p>\n\n<pre><code>new-host-4:rails scott$ bundle install\nUpdating git://github.com/rails/arel.git\nUpdating git://github.com/brynary/rack-test.git\nUpdating git://github.com/rails/jquery-rails.git\nUpdating git://github.com/rails/coffee-rails.git\nUpdating git://github.com/rails/journey.git\nUpdating git://github.com/rails/activerecord-deprecated_finders.git\nUpdating git://github.com/rails/sprockets-rails.git\nUpdating git://github.com/fxn/sdoc.git\nFetching gem metadata from https://rubygems.org/.\nError Bundler::HTTPError during request to dependency API\nFetching full source index from https://rubygems.org/\nCould not find gem 'sprockets-rails (~&gt; 2.0) ruby', which is required by gem 'rails (&gt;= 0) ruby', in any of the sources.\n</code></pre>\n"},{"tags":["ajax","ruby-on-rails-3","updates"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13036684,"title":"update action href with ajax rails","body":"<p>hello I'm getting started with ajax and Im a little confuse about how to use it.\ntrying to do something easy I have this: a playlist model and a song model </p>\n\n<p>playlist model </p>\n\n<pre><code>has_and_belongs_to_many :songs\n</code></pre>\n\n<p>and I created a table play_lists_songs</p>\n\n<p>well, in the show song view I can a new playlist and add that song(done) or add the song to an existing playlist. the paly lists are show in the view like this:</p>\n\n<pre><code>&lt;% unless @play_lists.empty?%&gt;\n    &lt;% @play_lists.each do |play_list| %&gt;\n      &lt;ul&gt;\n        &lt;li&gt;&lt;a href=\"&lt;%=play_list_path(play_list.id)%&gt;\" &gt;&lt;span class=\"count\"&gt;(&lt;%=play_list.song_ids.count%&gt;)&lt;/span&gt;&lt;%=play_list.name%&gt;&lt;/a&gt;&lt;/li&gt;\n          &lt;%=hidden_field_tag \"playlist_\"+play_list.id.to_s, :value=&gt; song.id%&gt;\n      &lt;/ul&gt;\n    &lt;% end %&gt; \n  &lt;%end%&gt;\n</code></pre>\n\n<p>as you see I pass the value through a hidden field, so I need when the user click on the playlist'name then the ajax update that play list. how do I can do that with href? or there is a better way to do it</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","tdd","jasmine"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13016890,"title":"What code quality / code coverage tools are available for checking Javascript tests in Jasmine?","body":"<p>What code quality / code coverage tools are available for Jasmine?</p>\n\n<p>Working in Rails 3.2.2.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12951370,"title":"How to customize active admin comments feature in rails 3","body":"<p>I need to send an email whenever the admin add a comment to a user. \nI am using active admin 0.4.3</p>\n\n<p><img src=\"http://i.stack.imgur.com/A5FOI.png\" alt=\"enter image description here\"></p>\n\n<p>How can I get this event and send email.  When I post a comment, In my console I can see the following actions performed</p>\n\n<pre><code>Started POST \"/admin/comments\"\nRedirected to http://localhost:3000/admin/comments/182\nStarted GET \"/admin/comments/182\"\nStarted GET \"/admin/accounts/227\"\n</code></pre>\n\n<p>I dont know how to access these functions. Please help.</p>\n"},{"tags":["ruby-on-rails-3","acts-as-taggable-on"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13034936,"title":"Getting tag count with Act_as_taggable_on not working","body":"<p>I've implemented the acts_as_taggable_on gem and I can see on the db the tag table which tags I have.</p>\n\n<p>I am tagging the model Card, and when I do <code>Card.tag_counts</code></p>\n\n<p>all I get is </p>\n\n<pre><code> [#&lt;ActsAsTaggableOn::Tag id: 1, name: \"test4\"&gt;, #&lt;ActsAsTaggableOn::Tag id: 2, name: \"you\"&gt;, #&lt;ActsAsTaggableOn::Tag id: 3, name: \"test\"&gt;, #&lt;ActsAsTaggableOn::Tag id: 4, name: \"tyy\"&gt;, #&lt;ActsAsTaggableOn::Tag id: 5, name: \"tetes\"&gt;]\n</code></pre>\n\n<p>even though I have some cards with the same tag</p>\n\n<p>I've verified this by  <code>Card.all.map{|c| c.tags}</code></p>\n\n<p>and got </p>\n\n<pre><code>[#&lt;ActsAsTaggableOn::Tag id: 1, name: \"test4\"&gt;], [#&lt;ActsAsTaggableOn::Tag id: 2, name: \"you\"&gt;,  #ActsAsTaggableOn::Tag id: 1, name: \"test4\"&gt;], [#&lt;ActsAsTaggableOn::Tag id: 3, name: \"test\"&gt;,  #ActsAsTaggableOn::Tag id: 2, name: \"you\"&gt;], [#&lt;ActsAsTaggableOn::Tag id: 4, name: \"tyy\"&gt;], [#ActsAsTaggableOn::Tag id: 5, name: \"tetes\"&gt;], [#&lt;ActsAsTaggableOn::Tag id: 2, name: \"you\"&gt;], [#ActsAsTaggableOn::Tag id: 2, name: \"you\"&gt;], [#&lt;ActsAsTaggableOn::Tag id: 2, name: \"you\"&gt;]]\n</code></pre>\n\n<p>so obivously I have a tag for more than once card.</p>\n\n<p>Why won't <code>Card.tag_counts</code> show me the count, and if its not the way how can I get the tag_count?</p>\n"},{"tags":["ruby","ruby-on-rails-3","http","video-streaming"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13035054,"title":"HTTP video packet information and Rails 3 reconstruction","body":"<p>How is an HTTP video packet interpreted by a computer? I know that the width and the height are in different parts but what about the rest of the frame? How about the rest of the pixels' colors and picture format? how are these interpreted?\nAlso,\nIs there a way to retrieve HTTP Packets and reconstruct them by using Rails Framework?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","partial-views"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":13033725,"title":"Forem Gem: Create a new topic on the fly from different model & load a forem partials in other views","body":"<p>In my app, I have a model called 'Protocols' that just your basic rails model. I have the forem gem installed and working just fine on it's own. What I am trying to do basically add 'comments' to each protocol, but have those comments actually be a 'topic' in forem.</p>\n\n<p>I'm not really sure of the best way to go about doing this. I was thinking of having a \"discuss this protocol\" button at the bottom of each protocol. clicking the button would then load the new topic form (which is actually just the new post form, i think), but with the title hidden (and filled automatically with the name of the protocol) and then just the main text area. Clicking post would create the topic and first post and reload the protocol page with the first comment showing, and the 'discuss this protocol' button replace with the 'reply' form.  </p>\n\n<p>i'm sure this is all possible, but i'm just too much of noob to figure it all out. \nI can't seem to get the forem partials to show up on any other views besides forem views. </p>\n\n<p>i set up the models so that topic is <code>belongs_to :protocol</code> and protocol <code>has_one :topic</code> and added the <code>protocol_id</code> field to the topics table. after that i'm a bit stumped. </p>\n\n<p>i guess some questions to get me started/ tl;dr:</p>\n\n<ol>\n<li><p>How to put a forem new topic form in another view?</p></li>\n<li><p>Once i submit that form, how do i create the topic, post, and redirect back to the protocol instead of to the topic in the forum?</p></li>\n<li><p>How do i show a forum topic thread in another model's view?</p></li>\n</ol>\n\n<p>Thanks in advance for all your help and insight? I'm sure i left out some relevant information, so please let me know what else i'm missing. </p>\n\n<p>cheers,</p>\n\n<p>--\nsimilar topic that i've checked out:\n<a href=\"http://stackoverflow.com/questions/8567971/forem-gem-how-to-link-a-forum-to-other-models\">Forem gem: how to link a forum to other models</a></p>\n"},{"tags":["ruby","database","ruby-on-rails-3","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13033680,"title":"heroku HTTP CODE 503","body":"<p>I'm trying to run heroku db:push [git@github.com..... to push database updates to my heroku account.  It begings to upload the schema and then kick back the HTTP CODE 503 Error (or whatever it is).  I'm trying to upload a development database and currently their development database isn't operational.  But it's been this way for about 24 hours now which seems unusual.</p>\n\n<p>I'm new to rails and heroku and I'm starting to get paranoid that I can't upload the changes because I'm not using toolbelt or I missed an update or something like that.  Can anyone help me shed some light on this.  In the past I've always done the same precedence to get changes successfully pushed to heroku. </p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":476,"score":1,"question_id":7685691,"title":"Complex subqueries in activerecord","body":"<p>I'm doing a rails app. I have to do a comparison engine abit complex. I'm currently trying to do a prototype. My query can vary widely so i have to work with a lot of scopes, but that's not my problem.</p>\n\n<p>My query have to compare candidats. These candidats have answered some tests. These tests belongs to category. Theses tests have different max value, and i have to be able to compare candidats by categories.</p>\n\n<p>So i have to calculate a % of good answers. I have to be able to compare candidats in all posible use cases in one category. So, i have to be able to compare the average good answer rate for all this category. </p>\n\n<p>In a nutshell : I have to be able to use subqueryies in order to compare some candidats. I have to be able to compare them for a test or a category. My problem is using a subquery able to return a good answer rate for all tests a candidats may have passed in a category.</p>\n\n<p>And i have to be able to use this subquery in an order_by or having clause.</p>\n\n<p>How can i construct this subquery ? I have no problem to handle complex conditionnal queries with some scopes. This has to be a real subquery, because i am working with 6 or 7 models here. </p>\n\n<p>I ask for an active record way, cause this must work with whatever database supported by rails.</p>\n\n<p>Excuse my poor english. </p>\n\n<p>Edit :</p>\n\n<p>An exemple is worth  1000 words so how could do something like this :</p>\n\n<pre><code>Sessiontest.find(Candidat.where(:firstname =&gt; 'toto'))\n</code></pre>\n\n<p>This example is stupid, ok. So, is it possible to do something like this ?</p>\n\n<p>Edit2 :</p>\n\n<p>I saw some posts about AREL. I wish to know if it is possible to do this withouth a third party plugin.</p>\n\n<p>Is it possible to do some sub queries in subqueries with arel ? Because for example, my number of points per test, is the sum of the points of all his questions. (Sad, but i have to keep it.). And i need this, so my subquery can calculate my good answers %. </p>\n\n<p>So you got the idea. That's something, which has to be really powerful, so i need something powerful, and not too much error prone.</p>\n\n<p>Edit3 : i did some progress, but i can't for a while post an answer.</p>\n\n<p>It seem possible to get this work withouth any plugin. I have some success in buildings some subqueries like this :</p>\n\n<pre><code> toto = Candidat.where(:lastname =&gt; Candidat.select(:lastname).where(:lastname =&gt; \"ulysse\").limit(1))\n</code></pre>\n\n<p>The request :</p>\n\n<pre><code>Candidat Load (1.0ms)[0m  SELECT \"candidats\".* FROM \"candidats\"    WHERE \"candidats\".\"lastname\" IN (SELECT \"candidats\".\"id\" FROM \"candidats\" WHERE \"candidats\".\"lastname\" = 'ulysse' LIMIT 1\n</code></pre>\n\n<p>This works and create a real subquery. I will try some more advanced experiences, in order to get the level i actually need.</p>\n\n<p>Just tried sub-subquery works wonder too.</p>\n\n<p>Edit 5 :  </p>\n\n<p>I am trying some more advanced things, and there is a lot of things, i still don't understand. </p>\n\n<pre><code>- toto = Candidat.where(\"id = ? / ? \", Sessiontest.select(:id).where(:id =&gt; 6), Sessiontest.select(:id).where(:id =&gt; 2))\n</code></pre>\n\n<p>This is just a stupid example in order to get an object with an id of 3.  This code works, but not as i expected.</p>\n\n<p>See, the sql :</p>\n\n<pre><code>1m[35m (1.0ms)[0m  SELECT COUNT(\"sessiontests\".\"id\") FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 6\n [1m[36mSessiontest Load (0.0ms)[0m  [1mSELECT id FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 6[0m\n [1m[35m (1.0ms)[0m  SELECT COUNT(\"sessiontests\".\"id\") FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 2\n [1m[36mSessiontest Load (1.0ms)[0m  [1mSELECT id FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 2[0m\n [1m[35mCandidat Load (1.0ms)[0m  SELECT \"candidats\".* FROM \"candidats\" WHERE (id = 6 / 2)\n</code></pre>\n\n<p>So, it does not use a subqueries. I tried with .to_sql. But it introduce my sql this way :\n    1m[36mCandidat Load (0.0ms)[0m  [1mSELECT \"candidats\".* FROM \"candidats\" WHERE (id = 'SELECT id FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 6' / 2 )[0m</p>\n\n<p>So active record quoted the subreust for security purpose. this is closer to my wish, but not really what i want.</p>\n\n<p>This does not work </p>\n\n<pre><code>Candidat.where(\"id = (?) / ? \", Sessiontest.select(:id).where(:id =&gt; 6).to_sql, Sessiontest.select(:id).where(:id =&gt; 2))\n</code></pre>\n\n<p>Quotes prevents the subquery to work.</p>\n\n<p>But this work :</p>\n\n<pre><code>Candidat.where(\"id = (\" + Sessiontest.select(:id).where(:id =&gt; 6).to_sql + \") / (\" + Sessiontest.select(:id).where(:id =&gt; 2).to_sql + \") \")\n\n[1m[36mCandidat Load (1.0ms)[0m  [1mSELECT \"candidats\".* FROM \"candidats\" WHERE (id = (SELECT id FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 6) / (SELECT id FROM \"sessiontests\" WHERE \"sessiontests\".\"id\" = 2) )[0m\n</code></pre>\n\n<p>But i find this ugly. I will try to get these subqueries working in a more dynamic way. I mean replace the integer values by columns name.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13033111,"title":"Rail Application Template - Causing Error on Server Start","body":"<p>I used a Rails Application Template on a quick app I was knocking up for someone.  It installed a new Ruby version through RVM, and everything was fine.  I've pushed it to Github, and it is being served via Heroku fine.</p>\n\n<p>The problem comes when I tried to update it.  I am using the right Ruby version it installed, but when I start the server locally, I get an error, which I think relates to a Ruby version issue.</p>\n\n<pre><code>/Users/tomallen/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/psych.rb:203:in `parse': (&lt;unknown&gt;): found character that cannot start any token while scanning for the next token at line 2 column 1 (Psych::SyntaxError)\n    from /Users/tomallen/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/psych.rb:203:in `parse_stream'\n    from /Users/tomallen/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/psych.rb:151:in `parse'\n    from /Users/tomallen/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/psych.rb:127:in `load'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/application/configuration.rb:115:in `database_configuration'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/railtie.rb:78:in `block (2 levels) in &lt;class:Railtie&gt;'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:36:in `instance_eval'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:36:in `execute_hook'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:26:in `block in on_load'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:25:in `each'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/lazy_load_hooks.rb:25:in `on_load'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.8/lib/active_record/railtie.rb:74:in `block in &lt;class:Railtie&gt;'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /Users/tomallen/Documents/Sites/videoapp/config/environment.rb:5:in `&lt;top (required)&gt;'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n    from /Users/tomallen/Documents/Sites/videoapp/config.ru:4:in `block in &lt;main&gt;'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n    from /Users/tomallen/Documents/Sites/videoapp/config.ru:1:in `new'\n    from /Users/tomallen/Documents/Sites/videoapp/config.ru:1:in `&lt;main&gt;'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands/server.rb:46:in `app'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands/server.rb:70:in `start'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n    from /Users/tomallen/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Any ideas what could be causing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","arel","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12949915,"title":"Ransack: How to use existing scope?","body":"<p>Converting a Rails 2 application to Rails 3, I have to replace the gem <a href=\"https://github.com/binarylogic/searchlogic\" rel=\"nofollow\">searchlogic</a>. Now, using Rails 3.2.8 with the gem <a href=\"https://github.com/ernie/ransack\" rel=\"nofollow\">Ransack</a> I want to build a search form which uses an existing scope. Example:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  scope :year, lambda { |year| \n    where(\"posts.date BETWEEN '#{year}-01-01' AND '#{year}-12-31'\") \n  }\nend  \n</code></pre>\n\n<p>So far as I know, this can be achieved by defining a custom <a href=\"http://rdoc.info/github/ernie/ransack/Ransack/Ransacker\" rel=\"nofollow\">ransacker</a>. Sadly, I don't find any documentation about this. I tried this in the <code>Post</code>class:</p>\n\n<pre><code>ransacker :year, \n          :formatter =&gt; proc {|v| \n            year(v)\n          }\n</code></pre>\n\n<p>But this does not work:</p>\n\n<pre><code>Post.ransack(:year_eq =&gt; 2012).result.to_sql\n=&gt; TypeError: Cannot visit ActiveRecord::Relation\n</code></pre>\n\n<p>I tried some variations of the <code>ransacker</code> declaration, but none of them work. I Need some help...</p>\n\n<p><strong>UPDATE:</strong> The scope above is just on example. I'm looking for a way to use every single existing scope within Ransack. In MetaSearch, the predecessor of Ransack, there is a feature called <code>search_methods</code> for using scopes. Ransack has <a href=\"https://github.com/ernie/ransack/issues/61\" rel=\"nofollow\">no support for this</a> out of the box yet.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":7,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":247,"score":1,"question_id":12900057,"title":"URL with two forward slashes","body":"<p>In my Rails project, in my <code>index</code> view, I have a link</p>\n\n<pre><code>&lt;%= link_to 'Show all posts', show_all_path %&gt;\n</code></pre>\n\n<p>In <code>routes.rb</code>, I have a route:</p>\n\n<pre><code>match \"show_all\" =&gt; \"Posts#show_all\"\n</code></pre>\n\n<p>When I click on that link, it goes from</p>\n\n<pre><code>http://&lt;domain name&gt;/my_rails_project\n</code></pre>\n\n<p>to</p>\n\n<pre><code>http://&lt;domain name&gt;/my_rails_project//show_all\n</code></pre>\n\n<p>It works. However, having two forward slashes doesn't look very nice. Can I make it so that only one forward slash appear?</p>\n\n<p>EDIT: These are some of my files:</p>\n\n<p>config/environment.rb</p>\n\n<pre><code>require File.expand_path('../application', __FILE__) \nBlog::Application.initialize!\n</code></pre>\n\n<p>config/environments/development.rb </p>\n\n<pre><code>Blog::Application.configure do \n  config.cache_classes = false \n  config.whiny_nils = true \n  config.consider_all_requests_local = true \n  config.action_view.debug_rjs = true \n  config.action_controller.perform_caching = false \n  config.action_mailer.raise_delivery_errors = false \n  config.active_support.deprecation = :log \n  config.action_dispatch.best_standards_support = :builtin \n  config.action_controller.asset_host = \"//pauls.scripts.asu.edu/blog/public\" \nend\n</code></pre>\n\n<p>config/routes.rb: </p>\n\n<pre><code>Blog::Application.routes.draw \n  do resources :posts match \"show_all\" =&gt; \"Posts#show_all\" \nend\n</code></pre>\n\n<p>Output of <code>rake routes</code></p>\n\n<pre><code>show_all        /show_all(.:format)             {:action=&gt;\"show_all\", :controller=&gt;\"Posts\"}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","angularjs"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13024090,"title":"AngularJS not listening to all my fields","body":"<p>I'm using AngularJS with Rails and creating dynamic nested form items which are not registering in the AngularJS scope. They are assigned the 'ng-dirty' class.</p>\n\n<p>I have an investor which has three houses, in my Angular controller I only assign the first 2 as I really want to set these through Rails instead.</p>\n\n<pre><code>$ (event) -&gt;\n  app = angular.module \"investor\", []\n\n  app.controller(\"InvestorCtrl\", [\"$scope\", ($scope) -&gt;\n    $scope.houses = [\n      { cost: \"295000\", value: \"450000\" },\n      { cost: \"600000\", value: \"620000\"  }    \n    ]\n    $scope.calc_totals = -&gt;\n      # Initialise variables\n      cost = 0\n      value = 0\n\n      # Go through each house and calculate the total cost\n      for h in $scope.houses\n        cost = parseInt(cost) + parseInt(h.cost)\n        value = parseInt(value) + parseInt(h.value)\n\n      # Set the total\n      $scope.total_cost = cost\n      $scope.total_value = value  \n\n    # Run the calculation at the start  \n    # $scope.calc_totals()\n  ])\n\n  angular.bootstrap document, ['investor']\n</code></pre>\n\n<p>Here is my form</p>\n\n<pre><code>%div{\"ng-controller\" =&gt; \"InvestorCtrl\"}\n    = form_for(@investor) do |f|\n        - if @investor.errors.any?\n            #error_explanation\n                %h2\n                    = pluralize(@investor.errors.count, \"error\")\n                    prohibited this investor from being saved:\n                %ul\n                    - @investor.errors.full_messages.each do |msg|\n                        %li= msg\n        .field\n            = f.label :name\n            = f.text_field :name, \"ng-model\" =&gt; \"name\"\n\n        - i = 0\n        = f.fields_for :houses do |builder|\n            .field\n                = render :partial =&gt; \"house\", :locals =&gt; {:f =&gt; builder, :i =&gt; i}\n                - i = i + 1\n\n        .field\n            = f.label :total_cost\n            = f.number_field :total_cost, \"ng-model\" =&gt; \"total_cost\"\n        .field\n            = f.label :total_value\n            = f.number_field :total_value, \"ng-model\" =&gt; \"total_value\"\n        .actions\n            = f.submit\n</code></pre>\n\n<p>If I type in the first or second house 'cost' or 'value' then it updates the total_cost, but if I update the third house it will not update the total_cost. </p>\n\n<p>Is there a way to dynamically tell angularjs to listen to these elements without assigning them in the controller?</p>\n"},{"tags":["ruby-on-rails-3","number-to-currency"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":13031475,"title":"number_to_currency Removing the Demical Point","body":"<p>Is there any way to change the value in the display to the following:</p>\n\n<p>$100.25 to 10025 </p>\n\n<p>Need this to be in this format to go through a payment gateway.</p>\n"},{"tags":["ruby","ruby-on-rails-3","http","video-streaming"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13030222,"title":"How to stream video through http in Rails 3","body":"<p>How do I add video streaming functionality in my Rails application given the fact that another server will send me the video http packets, and I just need to stream them to the client? any guidance ? tutorials help?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12975428,"title":"Agile Web Development on Rails. 10.4 -undefined method `price' for nil:NilClass","body":"<p>I am stuck here and it seems that there is no answer anywhere online. The exercise says:</p>\n\n<p>Create a migration that copies the product price into the line item, and change the add_product method in the Cart model to capture the price whenever a new line item is created.</p>\n\n<p>My code:</p>\n\n<pre><code>class AddPriceToLineItem &lt; ActiveRecord::Migration\n  def self.up\n    add_column :line_items, :price, :decimal\n    say_with_time \"Updating prices...\" do\n    LineItem.find(:all).each do |li|\n      li.update_attribute :price, li.product.price\n    end\n    end\n  end\n\n  def self.down\n    remove_column :line_items, :price\n  end\nend\n</code></pre>\n\n<p>I also tried: </p>\n\n<pre><code>class AddPriceToLineItem &lt; ActiveRecord::Migration\n  def self.up\n    add_column :line_items, :price, :decimal\n    LineItem.all.each do |li|\n      li.price = li.product.price\n    end\n  end\n\n  def self.down\n    remove_column :line_items, :price\n  end\nend\n</code></pre>\n\n<p>I keep getting this error:</p>\n\n<pre><code> rake db:migrate\n==  AddPriceToLineItem: migrating =============================================\n-- add_column(:line_items, :price, :decimal)\n   -&gt; 0.0010s\n-- Updating prices...\nrake aborted!\nAn error has occurred, this and all later migrations canceled:\n\nundefined method `price' for nil:NilClass\n</code></pre>\n\n<p>It is weird that it is saying undefined nil:nilClass, as price has just been defined in the line before. </p>\n\n<p>Im using rails (3.2.1), ruby 1.9.3p125.</p>\n\n<p>Anyone can help?</p>\n"},{"tags":["javascript","html","css","ruby-on-rails-3","themes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":13030795,"title":"Rails: Integrating an html css js theme","body":"<p>Is there an easy way to integrate a special theme to my rails application?\nMy theme has only js/css/images but i dont't know the best way to integrate it for my application.</p>\n\n<p>the theme is mooncake from themeforest.com</p>\n\n<p><img src=\"http://i.stack.imgur.com/KWuOU.png\" alt=\"structure of theme\"></p>\n\n<p>My first try was to integrate step by step functionality. This worked fine until I cam to special js jquery etc...</p>\n"},{"tags":["facebook","ruby-on-rails-3","facebook-graph-api","oauth","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":13025189,"title":"oauth not firing auth/facebook on production","body":"<p>I have built a rails app with both facebook and twitter integration, everything was working fine on development but after moving to production (I have changed the url on fb and twitter settings to my site url subdomain.domain.com) oauth is not triggering only. It is pointing to unicorn corn file name and giving invalid URI error. I have pasted the error below. Any help is highly appreciated... </p>\n\n<p>URI::InvalidURIError (the scheme http does not accept registry part: unicorn_txt_browser (or bad hostname?)):\n  /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/generic.rb:213:in <code>initialize'\n  /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/http.rb:84:in</code>initialize'\n  /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/common.rb:214:in <code>new'\n  /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/common.rb:214:in</code>parse'\n  /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/uri/common.rb:747:in <code>parse'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:404:in</code>full_host'\n  omniauth-oauth2 (1.0.3) lib/omniauth/strategies/oauth2.rb:34:in <code>callback_url'\n  omniauth-facebook (1.4.0) lib/omniauth/strategies/facebook.rb:106:in</code>callback_url'\n  omniauth-oauth2 (1.0.3) lib/omniauth/strategies/oauth2.rb:46:in <code>request_phase'\n  omniauth-facebook (1.4.0) lib/omniauth/strategies/facebook.rb:94:in</code>request_phase'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:207:in <code>request_call'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:174:in</code>call!'\n  omniauth (1.1.1) lib/omniauth/strategy.rb:157:in <code>call'\n  omniauth (1.1.1) lib/omniauth/builder.rb:48:in</code>call'\n  actionpack (3.2.5) lib/action_dispatch/middleware/best_standards_support.rb:17:in <code>call'\n  rack (1.4.1) lib/rack/etag.rb:23:in</code>call'\n  rack (1.4.1) lib/rack/conditionalget.rb:25:in <code>call'\n  actionpack (3.2.5) lib/action_dispatch/middleware/head.rb:14:in</code>call'\n  actionpack (3.2.5) lib/action_dispatch/middleware/params_parser.rb:21:in <code>call'\n  actionpack (3.2.5) lib/action_dispatch/middleware/flash.rb:238:in</code>call'</p>\n"},{"tags":["ruby-on-rails-3","validation","model"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":792,"score":2,"question_id":7004008,"title":"Rails 3 validate uniqueness of one value against a column?","body":"<p>I have a model with an <code>active</code> column, which is a boolean. I want to validate the uniqueness of all newly added records against <code>company_id</code>, such that I can add as many records as I want with the same <code>company_id</code> to the table so long as <code>active</code> is set to <code>false</code>. There should only be one <code>active</code> record for each <code>company_id</code>.</p>\n\n<p>How would I write this? I've already tried:</p>\n\n<pre><code>validates :company_id, :uniqueness =&gt; { :scope =&gt; :active }\n</code></pre>\n\n<p>But that seems to also validate against unique combinations of <code>active</code> being <code>false</code> (such that I can never have more than two <code>company_id</code>'s in the table with the same <code>active</code> status, regardless of what <code>active</code> is)--the validation above allows two records for <code>company_id</code>, one with <code>active = false</code> and the other with <code>active = true</code>. Once those two records are in, the validation blocks everything else.</p>\n\n<p>I then tried adding this:</p>\n\n<pre><code>scope :active, where(:active =&gt; true)\n</code></pre>\n\n<p>But that doesn't seem to have changed the validation at all (same issue as above).</p>\n\n<p>How can I write this validation so that I can add as many records with the same <code>company_id</code> so long as <code>active</code> is false, and only allowing one <code>active = true</code> per <code>company_id</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","view","model-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13029225,"title":"Retrieving data in ruby on rails through association","body":"<p>I have three tables  Users(contains users details)  users_shifts(contains users shift mapping) and shift(it's id is in users_shift table). \nWhat I'm doing is assigning multiple shifts to users and i want to retrieve all the data from users, users_shift and shift table.\nI have done the following thing :</p>\n\n<p>In user model:</p>\n\n<pre><code>has_many :users_shifts, :dependent =&gt; :destroy\n</code></pre>\n\n<p>In users_shift model :</p>\n\n<pre><code>has_one :shift\nbelongs_to :user\n</code></pre>\n\n<p>In Shift Model</p>\n\n<pre><code>belongs_to :users_shift\n</code></pre>\n\n<p>In controller i have :</p>\n\n<pre><code>User.all\n</code></pre>\n\n<p>Now i want to fetch all the data in a table in view.\nI have to display users and his shift. Users detail will come from users table and shifts details will come from shifts table. Users_shift is used for users shift mapping.</p>\n"},{"tags":["ruby-on-rails-3","crontab"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13029013,"title":"How to load a ruby file (main.rb) in cronjob using whenever gem?","body":"<p>I have just installed whenever gem in my rails3 application. It is fantastic to use and i can \nsend emails on regular time. But unable to load any ruby file with command in cronjob. Here is code i have done so far:</p>\n\n<p>In my schedule.rb:</p>\n\n<pre><code>set :environment, :development\n\n\nevery 1.days, :at =&gt; '6pm' do\n runner \"User.hello_user\", :output =&gt; 'log/cron.log'\nend\n\nevery 2.minutes do\n  command \"load(File.read('app/models/summary_created.rb'))\", :output =&gt; 'log/cron.log'\nend\n</code></pre>\n\n<p>and here is my cronjob list:</p>\n\n<pre><code># Begin Whenever generated tasks for: myapp\n0 18 * * * /bin/bash -l -c 'cd /home/ruby-projects/myapp &amp;&amp; script/rails runner -e development '\\''User.hello_user'\\'' &gt;&gt; log/cron.log 2&gt;&amp;1'\n\n0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58 * * * * /bin/bash -l -c 'load(File.read('\\''app/models/summary_created.rb'\\'')) &gt;&gt; log/cron.log 2&gt;&amp;1'\n\n# End Whenever generated tasks for: myapp\n</code></pre>\n\n<p>in above file my first task works well but it is not running second task. Can i get the list of command it is supporting or any other way to run that file. For now i run it manually from rails console:</p>\n\n<pre><code> irb(main):030:0&gt; load \"summary_created.rb\"\n</code></pre>\n\n<p>Please help me to find out what i am missing here.</p>\n"},{"tags":["ruby","ruby-on-rails-3","mapreduce","mongoid","mongoid3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12975046,"title":"map/reduce is failing on Mongoid","body":"<p>I have a class like this</p>\n\n<pre><code>class Todo\n\n  TAG_REGEX = /(?:^|\\s)#(\\w+)/i\n\n  include Mongoid::Document\n  include Mongoid::Timestamps\n  include Mongoid::FullTextSearch\n\n  field :desc, type: String\n  field :done, type: Boolean, default: false\n  field :tags, type: Array\n\nend\n</code></pre>\n\n<p>which I'm trying to map/reduce tags like this</p>\n\n<pre><code>map = %Q{\n  function() {\n    this.tags.forEach(function(tag){\n      emit(tag, { count: 1 });\n    }\n  }\n}\n\nreduce = %Q{\n  function(key, values) {\n    var result = { count: 0 };\n    values.forEach(function(value) {\n      result.count += value.count;\n    });\n    return result;\n  }\n}\n\n@map = Todo .map_reduce(map, reduce).out(replace: \"tags\")\n</code></pre>\n\n<p>When I try to iterate over the results, I see this exception</p>\n\n<pre><code>The operation: #&lt;Moped::Protocol::Command\n  @length=480\n  @request_id=316\n  @response_to=0\n  @op_code=2004\n  @flags=[]\n  @full_collection_name=\"todozen_development.$cmd\"\n  @skip=0\n  @limit=-1\n  @selector={:mapreduce=&gt;\"todos\", :map=&gt;\"\\n      function() {\\n        this.tags.forEach(function(tag){\\n          emit(tag, { count: 1 });\\n        }\\n      }\\n    \", :reduce=&gt;\"\\n      function(key, values) {\\n        var result = { count: 0 };\\n        values.forEach(function(value) {\\n          result.count += value.count;\\n        });\\n        return result;\\n      }\\n    \", :query=&gt;{}, :sort=&gt;{\"created_at\"=&gt;-1}, :out=&gt;{:replace=&gt;\"tags\"}}\n  @fields=nil&gt;\nfailed with error \"ns doesn't exist\"\n</code></pre>\n\n<p>What am I missing here?<br>\nAnyone need more information?<br>\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capistrano"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":13029545,"title":"capistrano cannot find previous release","body":"<p>I just deployed an old project using my capistrano and it deployed ok but I need to rollback. When I try to roll back using the command 'cap deploy:rollback' I get this error:</p>\n\n<pre><code>[Deprecation Warning] Naming tasks with before_ and after_ is deprecated, please see the new before() and after() methods. (Offending task name was before_update_code)\n[Deprecation Warning] Naming tasks with before_ and after_ is deprecated, please see the new before() and after() methods. (Offending task name was after_update_code)\n  * executing `deploy:rollback'\n  * executing `deploy:rollback:revision'\n  * executing \"ls -x /home/&lt;my user&gt;/&lt;my project&gt;/releases\"\n    servers: [\"www.my_webserver.com\"]\n    [www.my_webserver.com] executing command\n    command finished\n  * executing \"rm /home/&lt;my user&gt;/&lt;my project&gt;/current; ln -s /home/&lt;my user&gt;/&lt;my project&gt;/releases/20121023110110 /home/&lt;my user&gt;/&lt;my project&gt;/current\"\n    servers: [\"www.my_webserver.com\"]\n    [www.my_webserver.com] executing command\n    command finished\n    triggering after callbacks for `deploy:rollback:revision'\n  * executing `bundler:install'\n  * executing \"cd /home/&lt;my user&gt;/&lt;my project&gt;/releases/20121023112609 &amp;&amp; bundle install\"\n    servers: [\"www.my_webserver.com\"]\n    [www.my_webserver.com] executing command\n ** [out :: www.my_webserver.com] bash: line 0: cd: /home/&lt;my user&gt;/&lt;my project&gt;/releases/20121023112609: No such file or directory\n    command finished\nfailed: \"rvm_path=$HOME/.rvm/ $HOME/.rvm/bin/rvm-shell '1.9.2' -c 'cd /home/&lt;my user&gt;/&lt;my project&gt;/releases/20121023112609 &amp;&amp; bundle install'\" on www.my_webserver.com\n</code></pre>\n\n<p>If I start 'cap shell' and have a quick look I cannot find the 20121023112609 directory which it's looking for. </p>\n\n<pre><code>cap&gt; ls -x /home/&lt;my user&gt;/&lt;my project&gt;/releases\n ** [out :: www.my_webserver.com] 20120418231223    20120419004108  20120421030033  20120422072111  20120422101603\n ** [out :: www.my_webserver.com] 20120526035027    20120526113216  20120528100439  20120528102509  20120528135335\n ** [out :: www.my_webserver.com] 20120604090722    20120724142113  20121008114048  20121008114947  20121008125600\n ** [out :: www.my_webserver.com] 20121015121531    20121015122225  20121023110110  20121023111648\n</code></pre>\n\n<p>I can see my latest deploy is there but it's called '20121023111648' and the previous deploy which I want to revert back to is called '20121023110110'.</p>\n\n<p>It seems like there is a time difference or something?</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","activeadmin","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":13028649,"title":"kaminari-bootstrap conflicts with active admin","body":"<p>My rails project utilizes Twitter Bootstrap for the main site's look and feel. In order to make kaminari fit in a bit better, I added the kaminari-bootstrap gem.  So far, so good.</p>\n\n<p>The problem is that the kaminari-bootstrap HTML breaks the pagination in active_admin.</p>\n\n<p>The ideal thing would be to find a way to only enable kaminari-bootstrap for the main site, and not for active admin.</p>\n"},{"tags":["ruby-on-rails-3","backbone.js","coffeescript","backbone-relational"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":13027988,"title":"Creating children objects of not saved model in Backbone using Backbone-relational","body":"<p>I'm new to backbone. I have rails3 app. These are my backbone models:</p>\n\n<pre><code>class AppName.Models.Order extends Backbone.RelationalModel\n  paramRoot: 'order'\n\n  relations: [\n    type: Backbone.HasMany\n    key: 'order_services'\n    relatedModel: 'AppName.Models.OrderService'\n    collectionType: 'AppName.Collections.OrderServicesCollection'\n    includeInJSON: false\n    reverseRelation:\n      key: 'order_id',\n      includeInJSON: 'id'\n  ]\n\nclass AppName.Models.OrderService extends Backbone.RelationalModel\n  paramRoot: 'order_service'\n</code></pre>\n\n<p>I have new order model which is not saved at server yet. How can I create new order_service as a child of that order, so I could access order with order_service.get('order')?</p>\n\n<p>I need to build order step by step: add order_services, add other models, and then save the order. Is that possible to store locally not saved order with its order_services (which also have not saved children of other models) and then save all this stuff at server?</p>\n"},{"tags":["ruby-on-rails-3","activerecord","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12891615,"title":"Rails, gem with functionality in between enum and many to many","body":"<p>i have im my rails app model which has few options (no more than 10 i think).\nSomething like Product - Category, where product can be part of 1 or many categories.\nBut i think i have too few categories to engage fully fledged many-to-many construct.\nMoreover the list of categroies is predefined and will almost never change.</p>\n\n<p>I think from sql side this could look like string field <code>categories</code> with such content:<code>\"Fruits|Vegetables|...\"</code></p>\n\n<p>Maybe someone know preexisting gem for such functionality, or maybe it is no real advantage doing so and i should choose standart <code>many-to-many</code> ?</p>\n\n<p>I checked <code>acts-as-taggable-on</code> plugin, but it is i think fits not very well for this task.</p>\n\n<p>Enum gems like <code>enumerize</code> i think fit just best, but they are allow only single single value to be choosen.</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":13024788,"title":"How to implement check boxesd in index view?","body":"<p>I am building an application in which when the user log in as an admin it will have the list of registered users and have four links show,edit destroy and settings.What i want is when the admin click on the settings link it will have the view of check boxes in which admin decides the permission of users to read,edit,create and destroy of the model available in an application.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nginx","ruby-on-rails-3.2","passenger"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13026120,"title":"Rails can't find asset after page reload","body":"<p>I face a problem with a rails (3.2.6)  application on our production server (nginx + passenger 3). After a </p>\n\n<pre><code>rake assets:precompile\n</code></pre>\n\n<p>one static page works like a charm but after a few minutes I receive an asset not found error for an existing image. If I recompile the assets again it works but a few minutes later rails raise the file-not-found error again.</p>\n\n<p>Here you can see production.rb and Gemfile: <a href=\"https://gist.github.com/3937589\" rel=\"nofollow\">https://gist.github.com/3937589</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","simple-form"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":783,"score":3,"question_id":10036050,"title":"How to name the blank value in select?","body":"<p>I use simple_form in my app.</p>\n\n<p>How do i give the blank value in my selects a different text than \"\" ?</p>\n\n<p>I just find an option to include blank or not.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13023799,"title":"how to query for activerecord's select_value method?","body":"<p>can anyone please tell me how to write query in select_value.</p>\n\n<p>I have tried, </p>\n\n<pre><code>    ActiveRecord::Base.connection.select_value(\"select count(*) from leave_details where status= 'Pending' and 'employeedetails_id'=25\")\n</code></pre>\n\n<p>but it showing error</p>\n\n<pre><code>   invalid input syntax for integer: \"employeedetails_id\".\n</code></pre>\n\n<p>I am using PostgreSQL.</p>\n"},{"tags":["ruby-on-rails-3","apache","phusion-passenger"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":82,"score":1,"question_id":13005439,"title":"Rails server goes down frequently in production mode","body":"<p>I'm using Rails 3.0.5 version and Ruby 1.9.2 in my application.</p>\n\n<p>Its working fine in development mode but in production mode server goes down after every 3-4 days.</p>\n\n<p>It gives below error in <code>/var/log/https/error.log file</code>.</p>\n\n<pre><code>[Sun Oct 21 09:39:03 2012] [error] [IP_ADDRESS] **Premature end of script headers:** \n[ pid=24971 thr=1 file=ext/apache2/Hooks.cpp:817 time=2012-10-21 09:39:03.371 ]:\n</code></pre>\n\n<p>The backed application (process 29805) did not send a valid HTTP response; instead, it sent nothing at all. It is possible that it has crashed; please check whether there are crashing bugs in this application.</p>\n\n<p>I am not getting what's the reason for server down.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mongodb","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":13019255,"title":"MongoDB error 'host is not a valid option for Mongo::Connection' when rails development server is starting","body":"<p>I am getting an error when I start my rails development server. I run rails 3.0.6 and ruby 1.8.7 (2012-06-29 patchlevel 370) [i686-linux]</p>\n\n<p>The console output is like this when I execute rails s</p>\n\n<pre><code>=&gt; Booting Mongrel\n=&gt; Rails 3.0.6 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\nhost is not a valid option for Mongo::Connection\n</code></pre>\n\n<p>My main concern is this error \"host is not a valid option for Mongo::Connection\". I integrate devise 1.5.2 to run Facebook, Twitter and LinkedIn login via Omniauth and this mongoDB error is appearing now. </p>\n\n<p>The GemFile I use in this Rails App.</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.6'\ngem 'rake', '0.8.7'\n\ngem 'mysql'\ngem 'mysql2', \"0.2.11\"\n\ngem 'mongrel'\ngem 'jquery-rails', '&gt;= 0.2.7' \ngem 'active_scaffold_vho' \ngem 'inherited_resources', '~&gt; 1.2.1' \ngem 'has_scope', '~&gt; 0.5.0' \ngem 'json_pure' \ngem 'formtastic', '~&gt; 1.2.3' \ngem \"devise\", \"1.5.2\"\ngem 'omniauth'\ngem 'omniauth-twitter'\ngem 'omniauth-facebook'\ngem 'omniauth-linkedin'\ngem 'omniauth-openid'\ngem 'recaptcha', :require =&gt; 'recaptcha/rails' \n\ngem 'uuidtools', '~&gt; 2.1.2'\n\ngem 'capistrano', '~&gt; 2.6.0' \n\ngem 'cgi_multipart_eof_fix'\ngem 'fastthread'\n\ngem 'mongoid', \"~&gt;2.0\" #Mongoid\ngem 'bson_ext', \"~&gt;1.3\" #Mongoid\n\ngem 'redis', \"~&gt; 2.2.0\"\ngem 'resque'\ngem 'resque-scheduler'\n\ngem 'SystemTimer', \"~&gt; 1.2.3\" \n\ngem 'ar_mailer_rails3' \ngem 'lazy_high_charts', \"~&gt; 1.1.1\" \n\ngem 'rails-breadcrumbs', \"~&gt; 1.0.0\"\n\ngem 'curb' \n\ngem 'geonames', \"~&gt; 0.2.2\" \n\ngem 'activemerchant'\n\ngem 'savon', \"~&gt; 0.9.7\"\n\ngem 'rack-ssl'\ngem 'state_machine'\n\ngem \"http_accept_language\", '~&gt; 1.0.2'\n\ngem 'recurly', '~&gt; 2.1.0'\ngem 'newrelic_rpm'\n\ngroup :test, :development do\n  gem 'rspec-rails', \"~&gt; 2.8\"\n  gem 'rspec-mocks', \"~&gt; 2.8\"\n  gem 'capybara', \"~&gt; 0.4.1.2\"\n  gem 'database_cleaner', \"~&gt; 0.6.7 \"\n  gem 'cucumber', \"~&gt; 0.10.2\"\n  gem 'spork', \"~&gt; 0.9.0\"\n  gem 'launchy', \"~&gt; 0.4.0\"\n  gem 'machinist', \"~&gt; 1.0.6\"\n  gem 'factory_girl_rails', \"1.3.0\"\n  gem 'faker', \"~&gt; 0.9.5\"\n  gem 'email_spec'  \n  gem 'rails-erd'  \n  gem 'ruby-debug'\nend\n\ngroup :development do\n  gem \"hirb\"\n  gem \"awesome_print\"\nend\n</code></pre>\n\n<p>The mongoid.yml file is as follows:</p>\n\n<pre><code>defaults: &amp;defaults\n  host: localhost\n  database: teenscrio\n\ndevelopment:\n  &lt;&lt;: *defaults\n  database: teenscrio_dev\n\nstaging:\n  &lt;&lt;: *defaults\n  database: teenscrio_stg\n\ntest:\n  &lt;&lt;: *defaults\n  database: teenscrio_tst\n\n# set these environment variables on your prod server\nproduction:\n  host: &lt;%= ENV['MONGOID_HOST'] %&gt;\n  port: &lt;%= ENV['MONGOID_PORT'] %&gt;\n  username: &lt;%= ENV['MONGOID_USERNAME'] %&gt;\n  password: &lt;%= ENV['MONGOID_PASSWORD'] %&gt;\n  database: &lt;%= ENV['MONGOID_DATABASE'] %&gt;\n</code></pre>\n\n<p>Why this error is appearing now? What is the relation between devise and mongoid? How can I fix this issue?</p>\n"},{"tags":["ruby-on-rails-3","csv","postgresql-9.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":13021145,"title":"Rails and Postgres - COPY from .cvs to table while skipping created_at column","body":"<p>My client has given me a  list of vehicles for a project.  I need to get them into a table I can use, but they're currently in a .cvs file.  I've <a href=\"http://www.postgresql.org/docs/9.1/interactive/sql-copy.html\" rel=\"nofollow\">read</a> <a href=\"http://wiki.postgresql.org/wiki/COPY\" rel=\"nofollow\">around</a> and <a href=\"http://stackoverflow.com/questions/2987433/how-to-import-csv-file-data-into-a-postgres-table\">found</a> some info, but nothing that solves my particular problem.  </p>\n\n<p>I've generated a model that matches the info in the .cvs file(id, year, make, model, trim), run the migration, and now have the table I need.  The issue comes up when I try to use psql COPY.  Here's what I've read will work:</p>\n\n<pre><code>copy list_vehicles from '/path/to/list.csv' DELIMITERS ',' CSV;\n</code></pre>\n\n<p>but it gives me</p>\n\n<pre><code>ERROR:  missing data for column \"created_at\"\n</code></pre>\n\n<p>Fine, so I try this:</p>\n\n<pre><code>copy list_vehicles (id, year, make, model, trim)  from '/path/to/list.csv' DELIMITERS ',' CSV;\n</code></pre>\n\n<p>and I get back </p>\n\n<pre><code>ERROR:  null value in column \"created_at\" violates not-null constraint\n</code></pre>\n\n<p>Ok, so then this should work:</p>\n\n<pre><code>copy list_vehicles (id, year, make, model, trim)  from '/path/to/list.csv' DELIMITERS ',' WITH NULL AS ' ' CSV FORCE NOT NULL created_at;\n</code></pre>\n\n<p>nope, </p>\n\n<pre><code>ERROR:  FORCE NOT NULL column \"created_at\" not referenced by COPY\n</code></pre>\n\n<p>I'm not sure where to go from here.  I was thinking of trying to take the created_at column back out for now, then add it in another migration?  Any guidance would be much appreciated. </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","model"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13023672,"title":"how to perform a complex validation check on related model prior to performing an action on a model?","body":"<p>I am building a simple Ruby on Rails app for problem management. I have a problem model as follows: </p>\n\n<pre><code>class Problem &lt; ActiveRecord::Base\n  attr_accessible :active, :impact, :incident_number, :issue_description, :root_cause, :user_id, :problem_summary, :incident_priority, :timeline_enabled\n  attr_accessor :enable_timeline\n\n  validates :problem_summary, :length =&gt; { :in =&gt; 10..100 }\n\n  belongs_to :user\n  has_one :timeline\n  has_many :actionitems\n\nend\n</code></pre>\n\n<p>which has a has_many belongs_to association with the model for actionitems:</p>\n\n<pre><code>class Actionitem &lt; ActiveRecord::Base\n  attr_accessible :completion_date, :description, :initial_due_date, :notes, :problem_id, :revised_due_date, :status, :user_id\n\n  belongs_to :problem\nend\n</code></pre>\n\n<p>I would like to be able to update the problem record and save it with some set of limited validations (I still need to add those). However, I would like to have a \"Complete problem investigation\" button that would trigger a method on the problem controller to set the :active attribute on the problem record to false. I would like to be able to run a different, more complete set of validations on the problem record prior to performing this action and also to validate that all actionitems (if any) that were associated with this problem record are in :status \"completed\". </p>\n\n<p>The two questions that I have:</p>\n\n<ol>\n<li>How do I perform a specific set of validations only on a given action?</li>\n<li>How can I validate that related instances of Actionitem are in status \"complete\" prior to performing an action on Problem?</li>\n</ol>\n\n<p>This task seems very complex to me. If you could please point me to what I need to utilize in order to be able to achieve this that would be greatly appreciated! (I read on validates :on => :save etc and accepts_nested_attributes_for but I am not sure how to put all of this together to achieve the behavior that I want).</p>\n\n<p>Many thanks for all your help!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":41,"score":0,"question_id":13023161,"title":"$ rvm get head && rvm reload","body":"<p>I inserted the following \"$ rvm get head &amp;&amp; rvm reload\" and got the output below.  It says that directories are missing and to run rvmsudo to fix my issues.  Can someone explain what directories am I supposed to create?  What is \"rvmsudo\"? </p>\n\n<p>Based on the output, does this mean that this did not run properly? at the end, it notes.. \"Upgrade of RVM in /usr/local/rvm/ is complete.\"</p>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   185  100   185    0     0    199      0 --:--:-- --:--:-- --:--:--   417\n100 10009  100 10009    0     0   7016      0  0:00:01  0:00:01 --:--:-- 78811\nDownloading RVM from wayneeseguin branch master\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   125  100   125    0     0    261      0 --:--:-- --:--:-- --:--:--  1179\n100 1125k  100 1125k    0     0   640k      0  0:00:01  0:00:01 --:--:-- 1238k\n\nUpgrading the RVM installation in /usr/local/rvm/\nmkdir: /usr/local/share/man/man1: Permission denied\nstat: /usr/local/share/man/man1: stat: No such file or directory\nchown: /usr/local/share/man/man1: No such file or directory\ncp: /usr/local/share/man/man1/rvm.1: No such file or directory\n\n\n    Please run the installer using rvmsudo to fix file permissions\n\nstat: /usr/local/share/man/man1/rvm.1: stat: No such file or directory\nchown: /usr/local/share/man/man1/rvm.1: No such file or directory\nmkdir: /usr/local/share/man/man1: Permission denied\nstat: /usr/local/share/man/man1: stat: No such file or directory\nchown: /usr/local/share/man/man1: No such file or directory\ncp: /usr/local/share/man/man1/rvm.1.gz: No such file or directory\n\n\n    Please run the installer using rvmsudo to fix file permissions\n\nstat: /usr/local/share/man/man1/rvm.1.gz: stat: No such file or directory\nchown: /usr/local/share/man/man1/rvm.1.gz: No such file or directory\n    RVM PATH line found in /Users/XXXXXX/.bashrc /Users/XXXXXX/.zshenv.\n    RVM sourcing line found in /Users/XXXXXX/.bash_profile /Users/XXXXXX/.zprofile.\n\nUpgrade Notes:\n\n  * No new notes to display.\n\n.....\n\n# In case of any issues read output of 'rvm requirements' and/or 'rvm notes'\n\nUpgrade of RVM in /usr/local/rvm/ is complete.\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":157,"score":0,"question_id":11782969,"title":"Rails: How to use before_save to change a field value based on another field?","body":"<p>I'm trying to set a boolean field to false based on the value of another boolean field.  I tried the following with an ActiveRecord model:</p>\n\n<pre><code>  before_save :reconcile_xvent\n\n  def reconcile_xvent\n    self.xvent_hood = false if !self.xvent_plenum?\n  end\n</code></pre>\n\n<p>But this doesn't work.  Now, many of my unit tests fail with:</p>\n\n<pre><code>ActiveRecord::RecordNotSaved: ActiveRecord::RecordNotSaved\n</code></pre>\n\n<p>How can I set xvent_hood to be false if xvent_plenum is false?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's what works (some of which comes from the comments/answers below):</p>\n\n<pre><code>before_validation :reconcile_xvent\n\ndef reconcile_xvent\n  if self.xvent_hood?\n    self.xvent_hood = false unless xvent_plenum?\n  end\nend\n</code></pre>\n\n<p>I couldn't figure out to make it work without the \"if self.xvent_hood?\" part....</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-1.9.3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":13023025,"title":"Ruby Version Display","body":"<p>when I typed in <code>$ ruby -v</code> the output appeared as below: </p>\n\n<pre><code>ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin11.4.0] \n</code></pre>\n\n<p>In the past, I used to see the output as:</p>\n\n<pre><code>ruby 1.9.3\n</code></pre>\n\n<p>Why is my ruby version appearing with more data now?  I am new to programming and am wondering if I messed up my computer.  Help!  Thank you in advance!  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":30,"score":2,"question_id":13022499,"title":"Caching evaluated result in rails helper methods","body":"<p>When implementing some helper methods, sometimes, I want to store some computed result somewhere accessible from the helper method as a cache.</p>\n\n<p>If I store it into instance variable, it will pollute instances, so it looks like not wise to do that.</p>\n\n<p>Any good place to store such value?\nOr doing such heavy weight computing in a helper is a bad idea?</p>\n"},{"tags":["ruby","ruby-on-rails-3","autotest","minitest"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13018975,"title":"MiniTest ruby class queries return nil","body":"<p>I am running Rails 3.2.8 and using MinitTest spec for my testing. I have autotest manage my testing suite and everything works great except for one thing. I have a Contacts table that is managed by ActiveRecord with MySQL and a CsvImport custom ruby class that does not have a database table. When I run the application in IRB everything works as expected but when the test is ran through the test suite all the Contact.find / Contact.where / Contact.map query type calls that are in the Ruby class are returned nil.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>require 'test_helper'\n\nclass CsvRowManagerTest &lt; MiniTest::Spec\n  describe 'import tests' do\n    let(:row) { Hash['name' =&gt; 'test'] }\n    let(:rm) { CsvRowManager.new(row) }\n    it \"should return an array of stuff\" do\n      rm.contacts.wont_be_nil\n    end\n  end\nend\n\nclass CsvRowManager\n  attr_accessor :row, :contacts\n\n  def initialize(row)\n    @row = row\n    @contacts = Contact.all.map(&amp;:name) #&lt;-- returns nil\n  end\n\nend\n</code></pre>\n\n<p>More of a demonstration than anything. Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","hashes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":13022452,"title":"Rails: accessing the values of columns selected with column_names","body":"<p>Any ideas what it takes to get this to work? I can't for the life of me figure it out.</p>\n\n<pre><code>def get_prices(c)\n  @print_prices = {}\n  Billing.where(:name =&gt; c).column_names.each do |d|\n    if d.match(/^print_/)\n      @print_prices[d] = d.value\n    end\n  end\n  return @print_prices\nend\n</code></pre>\n\n<p>I've got no idea what to substitute <code>d.value</code> for.</p>\n\n<p>Cheers for any help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","logging"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":13018848,"title":"Rails development log file - time of writing","body":"<p>In my Rails project, I noticed that sometimes actions are not written into the log file <code>development.log</code> immediately after they are done, but rather after some other actions are done (or maybe just after some amount of time, I'm not sure.) Exactly when is the <code>development.log</code> file written?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","coffeescript","angularjs","nested-forms"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13005702,"title":"Rails with AngularJS calculations over nested forms","body":"<p>I have a Rails 3.2.8 app in which I'm applying some AngularJS for calculations dynamically within a form. </p>\n\n<p>I have a basic test application which maps an investor to multiple houses and each house has a cost and a value in which I would like to total at the end.</p>\n\n<p>Here is my form</p>\n\n<pre><code>&lt;div ng-controller=\"InvestorCtrl\"&gt;\n  &lt;%= form_for(@investor) do |f| %&gt;\n  &lt;% if @investor.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;h2&gt;&lt;%= pluralize(@investor.errors.count, \"error\") %&gt; prohibited this investor from being saved:&lt;/h2&gt;\n\n    &lt;ul&gt;\n      &lt;% @investor.errors.full_messages.each do |msg| %&gt;\n      &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :name %&gt;\n  &lt;/div&gt;\n\n  &lt;% i = 0 %&gt;\n  &lt;%= f.fields_for :houses do |builder| %&gt;\n  &lt;%= builder.label :address %&gt;\n  &lt;%= builder.text_field :address %&gt;\n\n  &lt;%= builder.label :suburb %&gt;\n  &lt;%= builder.text_field :suburb %&gt;\n\n  &lt;%= builder.label :cost %&gt;\n  &lt;%= builder.text_field :cost, \"ng-model\" =&gt; \"timesheets[#{i}].cost\", \"ng-change\" =&gt; \"calc_cost()\" %&gt;\n\n  &lt;%= builder.label :value %&gt;\n  &lt;%= builder.text_field :value, \"ng-model\" =&gt; \"timesheets[#{i}].value\" %&gt;\n\n  &lt;% i = i + 1 %&gt;\n\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :total_cost %&gt;\n    &lt;%= f.number_field :total_cost, \"ng-model\" =&gt; \"total_cost\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :total_value %&gt;\n    &lt;%= f.number_field :total_value, \"ng-model\" =&gt; \"total_value\" %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the angularjs coffeescript I'm using</p>\n\n<pre><code>$ (event) -&gt;\n  app = angular.module \"investor\", []\n\n  app.controller(\"InvestorCtrl\", [\"$scope\", ($scope) -&gt;\n    $scope.timesheets = [\n      { cost: 295000, value: 450000 },\n      { cost: 600000, value: 620000  },\n      { cost: 1000000, value: 900000 },    \n    ]\n    $scope.calc_cost = -&gt;\n      total = 0\n      for ts in $scope.timesheets\n        total = total + ts.cost\n      $scope.total_cost = total\n\n    $scope.calc_cost()\n  ])\n\n  angular.bootstrap document, ['investor']\n</code></pre>\n\n<p>When I load a new form I'm building three houses in the controller like so:</p>\n\n<pre><code>  def new\n    @investor = Investor.new\n    3.times { @investor.houses.build }\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @investor }\n    end\n  end\n</code></pre>\n\n<p>The total cost is calculated correctly when going to a new form, however when I change any of the houses 'cost' values the 'total_cost' field is set to blank.</p>\n\n<p>Am I binding correctly?\nIs there an easier way to bind nested forms using AngularJS with Rails templates?</p>\n\n<p>At the moment I'm just trying to get a sum of houses 'cost' value into the 'total_cost' field using AngularJS.</p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-ui"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":13021259,"title":"jQuery button click does not work in Rails 3.2.2 rendered partial","body":"<p>Here is my partial (_lookup.html.erb) that has the append button</p>\n\n<pre><code>&lt;div class=\"lookupbtnrow\"&gt;\n    &lt;button id=\"lookupappend\" type=\"button\" class=\"ui-corner-all\"&gt;Append&lt;/button&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the test jquery function, in lookup.js</p>\n\n<pre><code>$(\"#lookupappend\").click(function(){\n     alert(\"testing...\");\n});\n</code></pre>\n\n<p>If I put the <strong>div</strong> contents in the index page, the button click works fine, but when I put the <strong>div</strong> contents into the partial, the button does not work at all.  </p>\n\n<p>Do I have to put a &lt;%= javascript_include_tag %> in the partial?  </p>\n"},{"tags":["ruby-on-rails-3","activerecord","model","associations","single-table-inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13002537,"title":"complex find SQL using active record to associate records from two different tables with has_many relationship","body":"<p>I have been looking up the web to find a solution but to no avail. I am working on a problem where we have two tables in a has_many association, here are the model names</p>\n\n<pre><code> class Employee &lt; ActiveRecord::Base     # main table stores all the employee details\n       has_many :work_orders\n       attributes :id, :name\n\n class WorkOrder &lt; ActiveRecord::Base   # Work Orders are created by a form\n       belongs_to :employee\n       attributes :id, :work_details, :employee_id\n</code></pre>\n\n<p>The software specification was to have a form for WorkOrders to be created mentioning all the work details by a separate entity ( lets say a customer <strong>so employee_id is nil upon saving the form details</strong>  ). At this point upon saving the details of the WorkOrder in the database we need to trigger an auto dispatch system which will automatically assign an employee with minimum number of work_orders giving preference in the following order below;</p>\n\n<h3>Employee with no associated WorkOrders   (first condition, if not found then next)</h3>\n\n<h3>Employee with minimum number of associated WorkOrders he is working (or second condition)</h3>\n\n<p>I am trying to couple the above conditions in one single FIND SQL using active record which will return a set with <strong>only one Employee record</strong> so that we can associate the employee.id with work_orders.employee_id of this new work_order.</p>\n\n<p>I wrote an admin panel to find all the work_orders with no associated employee_id and can update the work_orders records with the next available employee by giving the employee.id manually (using the above preference) but i want to automate this to some extent.</p>\n\n<p>Any suggestions or pseudo code will be helpful ? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13020382,"title":"How to get relationship data value in my HAML template","body":"<p>This is a part of my house model. </p>\n\n<pre><code>class House &lt; ActiveRecord::Base\n\n    has_many :amenity_appartment\n    has_many :amenities, :through =&gt; :amenity_appartment\n\n    has_many :category_join_table\n    has_many :categories, :through =&gt; :category_join_table\n\n    has_one :price\nend\n</code></pre>\n\n<p>Because we get more than 100 houses in our listing i want to add filtering. After searching i find great way to do that. <a href=\"http://www.webegg.co.uk/jquery-multiple-filter/\" rel=\"nofollow\">http://www.webegg.co.uk/jquery-multiple-filter/</a></p>\n\n<p>i want to start with 3 filter options...price, category (country home, vila ect) and amenties (dishwasher, beertap ect)</p>\n\n<p>I just need to fill my template with the data value from my house relationships. </p>\n\n<p>Example: </p>\n\n<pre><code>#holderwrap\n  %ul#holder.filterThis\n   %li.1200.design-villa.dishwasher.barbecue.wifi\n</code></pre>\n\n<p>(1200 euro per week - design villa with the amenities a dishwasher, barbeque and wifi)</p>\n\n<p>How can i fill in the values in the LI tag? </p>\n\n<p>Ciao..remco</p>\n"},{"tags":["ruby-on-rails","regex","ruby-on-rails-3"],"answer_count":8,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":8514,"score":1,"question_id":4770133,"title":"rails - REGEX for email validation","body":"<p>I'm looking for a regex to validate an email to learn if it's valid or not.. I have the following:</p>\n\n<pre><code>def is_a_valid_email?(email)\n    email_regex = %r{\n      ^ # Start of string\n      [0-9a-z] # First character\n      [0-9a-z.+]+ # Middle characters\n      [0-9a-z] # Last character\n      @ # Separating @ character\n      [0-9a-z] # Domain name begin\n      [0-9a-z.-]+ # Domain name middle\n      [0-9a-z] # Domain name end\n      $ # End of string\n    }xi # Case insensitive\n\n    (email =~ email_regex)\nend\n</code></pre>\n\n<p>Problem with the above is <code>XXX_XXX@Xxx.com</code> does not return as valid when it should be. Any thoughts or suggestions for a better regex?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","file"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":13019592,"title":"Rails add file via controller","body":"<p>In the controller my Rails project, I would like to create a new file <code>/public/my_files/welcome.txt</code> with content </p>\n\n<pre><code>Welcome to my website!\n</code></pre>\n\n<p>(The folder <code>my_files</code> does not exist yet.) </p>\n\n<p>How can I do that?</p>\n\n<p>(Edit: I know that to make a static page, I don't need to do it via a controller. I'm actually making a dynamic page, but I'm just simplifying the example.)</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","sqlite"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13018881,"title":"Ruby on Rails MySQL to SQLite export/dump","body":"<p>Is it possible to export or dump a MySQL database that can be easily imported into SQLite? The export would be initiated by the logged in user of the application so a command line script probably wouldn't be feasible here. Any suggestions or gems that can achieve this?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","encoding","utf-8","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12985608,"title":"ActionMailer string encoding","body":"<p>Been banging my head against this for a while. I have this string:</p>\n\n<pre><code>[18] pry(main)&gt; p.title\n=&gt; \"Human meat – Wesker and Son butchers at Smithfield Market\"\n[19] pry(main)&gt; p.title.encoding\n=&gt; #&lt;Encoding:UTF-8&gt;\n[20] pry(main)&gt; p.title.force_encoding(\"ascii\").encode\n=&gt; \"Human meat ��� Wesker and Son butchers at Smithfield��Market\"\n</code></pre>\n\n<p>This is called in my email template through ActionMailer, and--as you can probably guess--shows up in my email client equally garbled:</p>\n\n<pre><code>&lt;a href=3D\"http://localhost:3000/stuff/12072\" =\nstyle=3D\"color: #D84D3F; text-decoration: none;\"&gt;Human meat =EF=BF=BD=EF=BF=\n=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD Wesker=\n and Son butchers at Smithfield=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=BD=EF=BF=\n=BD=EF=BF=BDMarket&lt;/a&gt;\n</code></pre>\n\n<p>Despite my headers seemingly setting the <code>Content-Type</code> correctly to <code>UTF-8</code>:</p>\n\n<pre><code>----==_mimepart_5082362f64bbe_36cb3feb84c5a7386303d\nDate: Fri, 19 Oct 2012 22:27:11 -0700\nMime-Version: 1.0\nContent-Type: text/html;\n charset=UTF-8\nContent-Transfer-Encoding: quoted-printable\nContent-ID: &lt;5082362f6a388_36cb3feb84c5a738632e9@MacBook-Air.local.mail&gt;\n</code></pre>\n\n<p>I've <a href=\"http://www.joelonsoftware.com/articles/Unicode.html\" rel=\"nofollow\">read</a> <a href=\"http://yehudakatz.com/2010/05/05/ruby-1-9-encodings-a-primer-and-the-solution-for-rails/\" rel=\"nofollow\">lots</a> on the subject, and despite being very informative, I still have no clue how to get rid of these pesky question marks. What do I have to do to get rid of them (with <code>ruby 1.9.3-p194</code>)?</p>\n"},{"tags":["ruby-on-rails-3","javafx-2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13017904,"title":"Rails 3 URL issues","body":"<p>I am working on an app that using a javafx 2 applet embedded in a webpage.</p>\n\n<p>That works fine with this url: <code>/applets/chat-client.jnlp</code></p>\n\n<p>The problem come with I try to add an option to launch via web start the above url is appended with the current path. <code>/chat_rooms/:id/applets/chat-client.jnlp</code> which gives a no route matches error, since the applets directory is under public.</p>\n\n<p>Here is the script:</p>\n\n<pre><code> function deployIt() {\n        dtjava.launch(\n        {         \n          url: \"/applets/chat-client.jnlp\",\n\n          params: {\n            url: \"&lt;%= @url  %&gt;\",\n            user_name: \"&lt;%= @user.handle %&gt;\"\n          }\n        },             \n        { javafx: \"2.2+\" },\n        {}\n      );\n      }\n</code></pre>\n\n<p>What am I missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","solr","sunspot-solr"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":188,"score":0,"question_id":10989488,"title":"Sunspot Solr error on rake sunspot:index","body":"<p>I am trying to use Sunspot gem for Solr on a Rails 3 app.  I have followed RailsCast #278, since I am using Windows I have to do rake sunspot:solr:run and that seems to start with no error.  However when I try to run rake sunspot:reindex I get the error:</p>\n\n<pre><code>No connection could be made because the target machine actively refused it. - connect(2)\n</code></pre>\n\n<p>I am using mysql2 gem for mysql.  Please advise. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","applicationcontroller","load-order"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":376,"score":0,"question_id":11348332,"title":"How can I extend ApplicationController in a gem?","body":"<p>I thought I'd come up with a slick way to extend ApplicationController in a Rails 3.x gem.</p>\n\n<p>In my gem's lib/my_namespace/my_controller.rb, I had:</p>\n\n<pre><code>class MyNamespace::MyController &lt; ApplicationController\n\n  before_filter :some_method\n  after_filter :another_method\n\n  def initialize\n    # getting classname of the subclass to use for lookup of the associated model, etc.\n    # and storing the model_class in an instance variable\n    # ...\n  end\n\n  # define :some_method, :another_method, etc.\n  # ...\n\nprivate\n  attr_accessor :subclass_defined_during_initialize # etc.\n\n  # etc.\nend\n</code></pre>\n\n<p>but when the Gem is loaded, app/controllers/application_controller.rb is not yet loaded, so it fails:</p>\n\n<pre><code>/path/to/rvm/gemset/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:\nin `require': cannot load such file -- my_gem_name/application_controller (LoadError)\n</code></pre>\n\n<p>As a workaround, I had defined ApplicationController in my gem's lib/gem_namespace/application_controller.rb as:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\nend\n</code></pre>\n\n<p>I assumed that even though I had defined it there, it would be redefined in my Rails 3 application's app/controllers/application_controller.rb, such that both controllers in the application that extended ApplicationController and controllers that extended MyNamespace::MyController would directly or indirectly extend the ApplicationController defined in app/controllers/application_controller.rb.</p>\n\n<p>However, we noticed that after loading the gem, controllers that extend ApplicationController were unable to access methods defined in app/controllers/application_controller.rb. Also, the ApplicationHelper (app/helpers/application_helper.rb) module was no longer being loaded by other helper modules.</p>\n\n<p>How can I extend ApplicationController within the controller in my gem for the purpose of defining a before_filter and after_filter to and use initialize to access the class's name to determine the associated model's class that it could then store and use within its methods?</p>\n\n<p><em>Update 2012/10/22</em>:</p>\n\n<p>Here's what I came up with:</p>\n\n<p>In lib/your_gem_name/railtie.rb:</p>\n\n<pre><code>module YourGemsModuleName\n  class Railtie &lt; Rails::Railtie\n    initializer \"your_gem_name.action_controller\" do\n    ActiveSupport.on_load(:action_controller) do\n      puts \"Extending #{self} with YourGemsModuleName::Controller\"\n      # ActionController::Base gets a method that allows controllers to include the new behavior\n      include YourGemsModuleName::Controller # ActiveSupport::Concern\n    end\n  end\nend\n</code></pre>\n\n<p>and in lib/your_gem_name/controller.rb:</p>\n\n<pre><code>module YourGemsModuleName\n  module Controller\n    extend ActiveSupport::Concern\n\n    # note: don't specify included or ClassMethods if unused\n\n    included do\n      # anything you would want to do in every controller, for example: add a class attribute\n      class_attribute :class_attribute_available_on_every_controller, instance_writer: false\n    end\n\n    module ClassMethods\n      # notice: no self.method_name here, because this is being extended because ActiveSupport::Concern was extended\n      def make_this_controller_fantastic\n        before_filter :some_instance_method_available_on_every_controller # to be available on every controller\n        after_filter :another_instance_method_available_on_every_controller # to be available on every controller\n        include FantasticStuff\n      end\n    end\n\n    # instance methods to go on every controller go here\n    def some_instance_method_available_on_every_controller\n      puts \"a method available on every controller!\"\n    end\n\n    def another_instance_method_available_on_every_controller\n      puts \"another method available on every controller!\"\n    end\n\n    module FantasticStuff\n      extend ActiveSupport::Concern\n\n      # note: don't specify included or ClassMethods if unused\n\n      included do\n        class_attribute :class_attribute_only_available_on_fantastic_controllers, instance_writer: false\n      end\n\n      module ClassMethods\n        # class methods available only if make_this_controller_fantastic is specified in the controller\n        def some_fanastic_class_method\n          put \"a fantastic class method!\"\n        end\n      end\n\n      # instance methods available only if make_this_controller_fantastic is specified in the controller\n      def some_fantastic_instance_method\n        puts \"a fantastic instance method!\"\n      end\n\n      def another_fantastic_instance_method\n        puts \"another fantastic instance method!\"\n      end\n    end\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":13016132,"title":"bootstrap for rails do we need to keep all files?","body":"<p>Hi i downloaded bootstrap from their website. it is a zip file with the different css js img files. do we need to paste in both bootstrap.css and bootstrap.min.css? isnt it the same file and i'm including them twice?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":13016288,"title":"Throw a 404 error on unsuccessful authentication: devise + rails custom auth strategy","body":"<p>I have a custom auth strategy (it is the default strategy), which has an authenticate! function.</p>\n\n<pre><code>def authenticate!\n  if validation_success\n    success!(resource)\n  else\n    fail(:invalid_token)\n  end\nend\n</code></pre>\n\n<p>I want to modify it so that in the 'else' part of the loop, I directly return a 404 from this code itself.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13016417,"title":"dynamically include rails modules","body":"<p>I'm using Ruby on Rails, and I want to know how to include a module, from modules that have the same name.</p>\n\n<p>So, I have a ActiveRecord model called Course</p>\n\n<p>it needs to include CourseModuleFactory depending on the course.level\nThere are 2 CourseModuleFactory modules both with the same name but in different folders.</p>\n\n<p>So I need code something like this:</p>\n\n<pre><code>after_initialize :course_module_factory_level\n\ndef course_module_factory_level\n  if self.level == \"A\"\n    self.class.send(:include, CourseModuleFactory ) #from folder A\n  else\n    self.class.send(:include, CourseModuleFactory ) #from folder B\n  end\nend\n</code></pre>\n\n<p>This code would be in the Course model</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","serialization","update-attributes","dirty"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":385,"score":4,"question_id":8745213,"title":"Is there a way to prevent serialized attributes in rails from getting updated even if there are not changes?","body":"<p>This is probably one of the things that all new users find out about Rails sooner or later.  I just realized that rails is updating all fields with the serialize keyword, without checking if anything really changed inside.  In a way that is the sensible thing to do for the generic framework.</p>\n\n<p>But is there a way to override this behavior? If I can keep track of whether the values in a serialized fields have changed or not, is there a way to prevent it from being pushed in the update statement?  I tried using \"update_attributes\" and limiting the hash to the fields of interest, but rails still updates all the serialized fields.</p>\n\n<p>Suggestions?</p>\n"},{"tags":["ruby-on-rails-3","actionmailer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":13016116,"title":"rails mailer route error with two controllers","body":"<p>I have two controllers for which I want to send an email notification whenever a new item is created.  I created the first one for controller one \"train\" using \"Notifier\" as the mailer name. It worked just fine.  However, when I added controller two \"plane\", using the same code structure, it fails on sending a controller_two email with the error </p>\n\n<pre><code>\"No route matches {:controller=&gt;\"planes\", :action=&gt;\"show\"} (ActionView::Template::Error)\"\n</code></pre>\n\n<p>rake routes shows that is not a true statement:</p>\n\n<pre><code>plane GET    /planes/:id(.:format)      {:action=&gt;\"show\", :controller=&gt;\"planes\"}\n</code></pre>\n\n<p>Notifier code is pretty straight-forward:</p>\n\n<pre><code>class Notifier &lt; ActionMailer::Base\n  default :from =&gt; \"me@example.com\"\n\n  def new_train(train, addr)\n    @train = train\n    mail(:to =&gt; addr, :subject =&gt; 'New train reported')\n  end\n\n  def new_plane(plane, addr)\n    @plane = plane\n    mail(:to =&gt; addr, :subject =&gt; 'New plane reported')\n  end\n\nend\n</code></pre>\n\n<p>What's strange is that if I reference the train controller in the plane mailer, it works?!</p>\n\n<p>Is there some requirement that I create a unique mailer for each controller I wish to support?</p>\n"},{"tags":["ruby-on-rails-3","solr","sunspot-rails","fuzzy-search","exact-match"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13015856,"title":"Is there a way with Solr to search fuzzy AND exact?","body":"<p>thank you for taking your time</p>\n\n<h2>Problem</h2>\n\n<p>I have a problem with searching records based on a fuzzy name search and an exact Regio search. This is what I have now:</p>\n\n<h2>What I have now</h2>\n\n<pre><code># :klantnaam is a param from a search-form\n@param = Staffingcustomer.search do\n    fulltext params[:klantnaam]\nend\n@staffingcustomers = @param.results\n</code></pre>\n\n<p>There is another field, 'Regio'.<br>\nThe results should only be with a certain 'Regio'.</p>\n\n<h2>Example requirements</h2>\n\n<p>So for example,<br>\nI'm a user with Regio 3.\nI want to visualize/select all Staffingcustomers with Fuzzy name search Anne and my own Regio 3. So, I don't want to see Staffingcustomers with Regio 2.</p>\n\n<p>What happens now is:</p>\n\n<pre><code>@param = Staffingcustomer.search do\n     fulltext 'anne'\nend\n@staffingcustomers = @param.results\n</code></pre>\n\n<p>Will return all Staffingcustomers with all different Regios...</p>\n\n<h2>After some research / logic thinking</h2>\n\n<p>I think it could be something like the following:</p>\n\n<pre><code>@param = Staffingcustomer.search do\n    fulltext params[:klantnaam]\nend\n@staffingcustomers = @param.results.find(:all, :conditions =&gt; {:regio =&gt; 3})\n</code></pre>\n\n<p>or</p>\n\n<pre><code>@param = Staffingcustomer.search do\n    fulltext params[:klantnaam] and fulltext '3'   ## or 3, without the quotes\nend\n@staffingcustomers = @param.results\n</code></pre>\n\n<p>But that just doesn't seem to work.</p>\n\n<p>Can you help me with this issue?</p>\n\n<h3>The logic problem</h3>\n\n<p>Actually this is a fuzzy search on an 'exact selected' part of a huge table.</p>\n\n<p>Hope you can help.</p>\n\n<p>Thanks in advance.  </p>\n\n<p>Kers.</p>\n"},{"tags":["ruby","ruby-on-rails-3","http","savon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":13015838,"title":"Rails, SOAP, and HTTP Video Streaming","body":"<p>I was given an API to work with that sends through SOAP responses HTTP links, that stream video. From what I understood it sends frame by frame but I am not sure yet. It is a bit strange to explain but the main question is, is there a tutorial or a any source that talks about HTTP Video streaming and Rails? Or could somebody guide me a bit? Thanks !</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","has-many-through"],"answer_count":4,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":529,"score":3,"question_id":5363702,"title":"has_many through additional attributes","body":"<p>How do we set additional parameters in has_many through associations?</p>\n\n<p>Thanks.\nNeelesh</p>\n"},{"tags":["ruby-on-rails-3","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":13014538,"title":"Why won't my new Ruby on Rails site start in development?","body":"<p>I'm using user-per-app configuration on an Ubuntu server running ruby 1.9.3 and rails 3.2.8.</p>\n\n<p>When I create a new site using <code>rails new test_app</code> in the home directory of one user (my main user) and then run <code>rails s</code> from the app directory I get </p>\n\n<pre><code>Rails 3.2.8 application starting in development on http://0.0.0.0:3000\n</code></pre>\n\n<p>but when I <code>su</code> to another user and run the same commands in the home directory of that user, I get</p>\n\n<pre><code>Rails 3.2.8 application starting in production on http://0.0.0.0:3000\n</code></pre>\n\n<p>and the same thing even if I run</p>\n\n<pre><code>rails s -e development\n</code></pre>\n\n<p>No matter what I do as the other user, I cannot get WEBrick to start in development. What's going on here?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":13014122,"title":"How to count unique records through an association using a scope in Rails 3","body":"<p>I wrote this to count the number of responses (to a post) by unique users:</p>\n\n<pre><code>p = Post.find 1\nr = p.responses.count(:user_id, distinct: true)\n</code></pre>\n\n<p>I tried translating it to a scope, but it throws an error: <code>undefined method 'default_scoped?' for 30:Fixnum</code></p>\n\n<pre><code>class Response &lt; ActiveRecord::Base\n  belongs_to :author, class_name: 'User', foreign_key: 'user_id'\n  belongs_to :post\n\n  scope :by_unique_users, joins(:post).count(:user_id, distinct: true)\nend\n\nclass Post &lt; ActiveRecord::Base\n  belongs_to :user\n  has_many :responses\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :posts\n  has_many :responses\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":742,"score":2,"question_id":10489314,"title":"How can I use \"Form_tag\" as opposed to \"Form_for\" in this file","body":"<p>I am new to Ruby on Rails and have been helped immensely by Michael Hartl's excellent book: Ruby on Rails Tutorial. I have gotten to Chapter 8 and am now on the exercises in that chapter. I am having ( I assume a typical \"newbie\") problem with exercise 1.  In this exercise it is asked \"1.Refactor the signin form to use form_tag in place of form_for.\" I have tried to searching for assistance with this in Stackoverflow, Google, Railscast, and many other \"web searches\" for two days now and I do not seem to find the assistance that I need to answer this problem.  The file I am trying to modify with form_tag is below:</p>\n\n<pre><code>&lt;% provide(:title, \"Sign in\") %&gt;\n&lt;h1&gt;Sign in&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_for(:session, url: sessions_path) do |f| %&gt;\n\n      &lt;%= f.label :email %&gt;\n      &lt;%= f.text_field :email %&gt;\n\n      &lt;%= f.label :password %&gt;\n      &lt;%= f.password_field :password %&gt;\n\n      &lt;%= f.submit \"Sign in\", class: \"btn btn-large btn-primary\" %&gt;\n     &lt;% end %&gt;\n\n    &lt;p&gt;New user? &lt;%= link_to \"Sign up now!\", signup_path %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I am using Rails 3.2.3 in this application. Can anybody point me in the correct direction? Can anyone help me with this problem?  I would be most appreciative.</p>\n\n<p>This is the implementation that uses form_tag:</p>\n\n<pre><code>&lt;% provide(:title, \"Sign in\") %&gt;\n&lt;h1&gt;Sign in&lt;/h1&gt;\n\n&lt;div class=\"row\"&gt;\n  &lt;div class=\"span6 offset3\"&gt;\n    &lt;%= form_tag( url: sessions_path ) do  %&gt;\n\n      &lt;%= label_tag :email %&gt;\n      &lt;%= text_field_tag :email %&gt;\n\n      &lt;%= label_tag :password %&gt;\n      &lt;%= password_field_tag :password %&gt;\n\n      &lt;%= submit_tag \"Sign in\", class: \"btn btn-large btn-primary\" %&gt;\n    &lt;% end %&gt;\n\n    &lt;p&gt;New user? &lt;%= link_to \"Sign up now!\", signup_path %&gt;&lt;/p&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I am using Rspec 2.9.0 and below are the failing tests:</p>\n\n<pre><code>describe \"signin page\" do\n    before { visit signin_path }\n\n    it { should have_selector('h1',    text: 'Sign in') }\n    it { should have_selector('title', text: 'Sign in') }\n  end \n</code></pre>\n\n<p>and</p>\n\n<pre><code>describe \"with invalid information\" do\n            before { click_button \"Sign in\" }\n\n            it { should have_selector('title', text: 'Sign in') }\n            it { should have_selector('div.alert.alert-error', text: 'Invalid') }\n\n            describe \"after visiting another page\" do\n              before { click_link \"Home\" }\n              it { should_not have_selector('div.alert.alert-error') }\n            end\n      end\n</code></pre>\n\n<p>and</p>\n\n<pre><code>describe \"with valid information\" do\n            let(:user) { FactoryGirl.create(:user) }\n            before do\n              fill_in \"Email\",    with: user.email\n              fill_in \"Password\", with: user.password\n              click_button \"Sign in\"\n            end\n\n            it { should have_selector('title', text: user.name) }\n            it { should have_link('Profile', href: user_path(user)) }\n            it { should have_link('Sign out', href: signout_path) }\n            it { should_not have_link('Sign in', href: signin_path) }\n\n            describe \"followed by signout\" do\n                    before { click_link \"Sign out\" }\n                    it { should have_link('Sign in') }\n            end\n      end\n</code></pre>\n\n<p>Here's my routes file:</p>\n\n<pre><code>SampleApp::Application.routes.draw do\n  resources :users\n  resources :sessions, only: [:new, :create, :destroy]\n\n\n  get \"users/new\"\n\n  root to: 'static_pages#home'\n\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout', to: 'sessions#destroy', via: :delete\n\n  match '/help',    to: 'static_pages#help'\n  match '/about',   to: 'static_pages#about'\n  match '/contact', to: 'static_pages#contact'\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","amazon-s3","paperclip","basecamp"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":13014305,"title":"Upload directly to S3 in Rails app through REST API","body":"<p>I am trying to implement an API similar to the way 37Signals implements it in their new Basecamp Attachment API</p>\n\n<p><a href=\"https://github.com/37signals/bcx-api/blob/master/sections/attachments.md\" rel=\"nofollow\">https://github.com/37signals/bcx-api/blob/master/sections/attachments.md</a></p>\n\n<p>So far I figured out I can:</p>\n\n<ul>\n<li>create an S3 post signed URL</li>\n<li>return it to the client to then upload the file directly to S3</li>\n<li>get a response from Amazon that the upload has been completed and return a JSON response with the new ID of the attachment (which will in return send it to the client)</li>\n</ul>\n\n<p>All is working well. The problem I am having is that I dont want to expose the signed URL. I want to implement like Basecamp does. I want the client to do a POST request to MY url <a href=\"http://mywebsite.com/upload.json\" rel=\"nofollow\">http://mywebsite.com/upload.json</a></p>\n\n<pre><code>curl --data-binary @logo.png \\\n   -u user:pass \\\n   -H 'Content-Type: image/png' \\\n   -H 'User-Agent: Rapp (david@37signals.com)' \\\n   https://basecamp.com/999999999/api/v1/attachments.json\n</code></pre>\n\n<p>I looks like they may be redirecting the user to upload directly to S3? Any ideas?</p>\n"},{"tags":["ruby","ruby-on-rails-3","forms","generics","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":13013846,"title":"Creating a Generic Form in Rails","body":"<p>I have a user model with attributes(not all required) first_name, last_name, birthday, profession, pet_name.</p>\n\n<p>for registration the user needs to enter first_name and birthday.</p>\n\n<p>I want to somehow get the attributes which are nil (in this case - last_name and profession) and randomly pick one of them and make a form asking the user to fill it in. </p>\n\n<p>if I do <code>@user.attributes.map{|k,v| v==nil ? k : nil}.compact</code> I can get the attributes which are nil.</p>\n\n<p>How do I make a form generic enough so that this method can be used on any attribute?</p>\n"},{"tags":["mysql","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":13013186,"title":"Rails 3: Writing a Joins Statement for a HABTM Relationship","body":"<p>I have a has_and_belongs_to_many relationship between :users and :books. They're joined by the :owned_books model. One feature of my app is to connect users that have read the same books. At the moment, I inefficiently process this in my model:</p>\n\n<pre><code>  users_hash = Hash.new\n  users = User.all\n  users.each do |user|\n    if user != current_user\n      users_hash[user.id] = 0\n      user.books.each do |book|\n        if current_user.books.include?(book)\n          users_hash[user.id]+=1\n        end\n      end\n    end\n  end\n  users_hash = users_hash.sort {|a,b| b[1]&lt;=&gt;a[1]}\n  @users = Array.new\n  users_hash[0..max].each do |id|\n    user = User.find(id[0])\n    @users &lt;&lt; user\n  end\nend\n</code></pre>\n\n<p>I believe there's a way I can get the database to do this work. I've been toying with a MySQL query that looks like this:</p>\n\n<pre><code>@users = User.select(\"users.*, COUNT(books) AS shared_books\").joins(\"LEFT JOIN books ON ???\").order(\"shared_books DESC\").limit(100)\n</code></pre>\n\n<p>My intention is to join the books that the current_user has read, and then get a count for all other users to see how many of those books they have read. I'll then order the results by this count and limit to the top 100 results.</p>\n\n<p>Unfortunately, my MySQL skills aren't up to snuff. In particular, I'm unsure how to write conditions for joined models. I also doubt that the select statement will work, though I can probably figure that out once I have a solid joins statement.</p>\n"},{"tags":["ruby-on-rails-3","mvc","view","model","partials"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":13012635,"title":"How to stay MVC and have dynamic partials calls in rails?","body":"<p>I was wondering if it was correct to do the following in the model:</p>\n\n<pre><code>get_partial\n    #logic...\n      return \"_partial_name1\"\n    #more logic\n      return  \"_partial_name2\"\n    #more logic\n      return  \"_partial_name3\"\n    else\n      \"_partial_name4\"\n    end\nend\n</code></pre>\n\n<p>and in the view :</p>\n\n<pre><code>&lt;%= render @product.get_partial %&gt;\n</code></pre>\n\n<p>There is NO erb code in the model, only logic choosing wich partial it should display.\nI tested it and it works, but I wanted to know if it is correct from an MVC point of view. If not, where should this logic be placed?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13012904,"title":"RoR polymorphic association stack level too deep error","body":"<p>I've got polymorphic association which looks like</p>\n\n<pre><code>class Certificate &lt; ActiveRecord::Base\n  attr_accessible :certification_id, :certified_id, :certified_type\n  belongs_to :certification\n  belongs_to :certified, :polymorphic =&gt; true\nend\n\nclass Certification &lt; ActiveRecord::Base\n  attr_accessible :name, :slug\n  belongs_to :association\nend\n\nclass Association &lt; ActiveRecord::Base\n  has_many :certifications\n  attr_readonly :name, :id\n  attr_protected :name\nend\n</code></pre>\n\n<p>assuming <code>User</code> model</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :certificates, :as =&gt; :certified\nend\n</code></pre>\n\n<p>i am trying to access <code>association</code> object from within polymorphic association </p>\n\n<p><code>u = User.first</code></p>\n\n<p><code>u.certificates</code> returns array of instances of <code>Certificate</code></p>\n\n<p><code>u.certificates.first.certification</code> returns instance of <code>Certification</code></p>\n\n<p>but</p>\n\n<p><code>u.certificates.first.certification.association</code> returns <code>stack level too deep</code> error and on the second run console/server crashes with <code>illegal hardware instruction</code> message</p>\n\n<p>I do realize that this expression is hardly a queen of code beauty, but it should work, shouldn't it?  </p>\n"},{"tags":["javascript","ruby-on-rails-3","pusher"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":13000521,"title":"Pusher messages not received","body":"<p>I followed a few tutorials (all looking very similar) on using Pusher for realtime messaging to my Rails app.</p>\n\n<p>What I am trying:</p>\n\n<pre><code>// Javascript on my clientside receiving html page\n$(function(){\n  var pusher = new Pusher('xxxx-mykey-xxxx');\n  var myChannel = pusher.subscribe('survey-channel');\n\n  myChannel.bind('data-changed', function(data){ \n           alert(data);\n      });\n  // Some useful debug msgs\n  pusher.connection.bind('connecting', function() {\n      alert('Connecting to Pusher...');\n    });\n    pusher.connection.bind('connected', function() {\n      alert('Connected to Pusher!');\n    });\n    pusher.connection.bind('failed', function() {\n      alert('Connection to Pusher failed :(');\n    });\n    myChannel.bind('subscription_error', function(status) {\n      alert('Pusher subscription_error');\n    });\n});\n</code></pre>\n\n<p>And I call this inside a controller method in my Rails app:</p>\n\n<pre><code>Pusher['survey-channel'].trigger('data-changed', \"Busy creating new Call\") \nrender :text =&gt; \"Pusher sent\"\n</code></pre>\n\n<p>Nothing happens when the method gets called, except that it renders \"Pusher sent\".</p>\n\n<p>In my chrome developer tools' console, I get the following:</p>\n\n<pre><code>(x) Uncaught TypeError: Cannot call method 'bind' of undefined calls:31\n(3) WebSocket is closed before the connection is established. :3000:1\n</code></pre>\n\n<p>What could I be missing? Please help!</p>\n\n<hr>\n\n<h2>Edit #1</h2>\n\n<p>I added this piece of code to the client:</p>\n\n<pre><code>Pusher.log = function(message) {\n  if (window.console &amp;&amp; window.console.log) window.console.log(message);\n};\n</code></pre>\n\n<p>and it logged the following to the console:</p>\n\n<pre><code>Pusher : Connecting : ws://ws.pusherapp.com:80/app/e5d0f1ae2cab03dc3aa9?client=js&amp;version=1.8.6 calls:44    \nPusher : Event recd (event,data) : pusher:connection_established : {\"socket_id\":\"14299.674628\"} calls:44    \nPusher : Event sent (channel,event,data) :  : pusher:subscribe : {\"channel\":\"survey-channel\"} calls:44\n</code></pre>\n\n<hr>\n\n<h2>Edit #2</h2>\n\n<p>Whenever I send \"messages\" it does not even appear in die Pusher <em>Debug Console</em> even if I send it with the <em>Event Creator</em>. But what's really strange is that on the <em>Stats</em> page it indicates the <em>Message Rate</em> and <em>Connections</em> to be greater than zero, e.g. 2 connections etc.</p>\n\n<hr>\n\n<h2>Edit #3</h2>\n\n<p>I have tested Pusher's testing page. (http://test.pusher.com/1.12)\nIt connects perfectly, but the \"Say Hello\" feature does nothing. This brings me to think that it might be my browser setup.</p>\n\n<p>I am currently running the latest version of Chrome on a Win7 PC.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":69,"score":-2,"question_id":13001780,"title":"Rails 3.2.8 - How to get methods form application_controller.rb inside of a module?","body":"<p>I have the following method in my controllers/application_controller.rb</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery\n\n  private\n\n  def check_api_credential(api_key)\n    if Credential.find_by_key(api_key)\n      true\n    else\n      false\n    end\n  end\n\nend\n</code></pre>\n\n<p>In all the controllers located directly under controllers folder, this method is reachable.</p>\n\n<p>But the controllers files at controllers/api/v1/photos_controller.rb</p>\n\n<pre><code>module Api\n  module V1\n    class PhotosController &lt; ActionController::Base\n      respond_to :json\n\n      def create\n        redirect_to root_url if check_api_credentials(params[:params][2])\n        if Photo.create(params[:params][0])\n          render 'success'\n        else\n          render 'failure'\n        end\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>When I try to save I get \n     undefined method 'check_api_credentials'</p>\n\n<p>How can I access those methods from application_controllers.rb? They are inside of controllers folder.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":63,"score":0,"question_id":13005342,"title":"how to assign all the projects to belong to user?","body":"<p>I use devise for authentication and i have another model called project and how can i assign user to have all the projects and how can i assign as shown below?</p>\n\n<pre><code>user_id     project_id  role1_id  \n----------  ----------  ----------\n1           5           2                     \n1           6           1\n2           5           3\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":13011943,"title":"Rails - Paperclip and Audited","body":"<p>Anyone has used <a href=\"https://github.com/collectiveidea/audited\" rel=\"nofollow\">audited</a> gem along with paperclip? Can you elaborate the technique that you used?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":13009410,"title":"When using class_eval in ruby, how to access the constant in the original class?","body":"<p>I want to extend a class using class_eval, and while trying to access the constant from the original class, I got an error saying:</p>\n\n<p>NameError: uninitialized constant HIS_CONSTANT\n    from ./my_module.rb:35:in `show_his_constant'\n    from (irb):4</p>\n\n<p>I tested with a sample program, and can't make it work. Can someone pls check and see why this is not working? Thanks!</p>\n\n<pre><code>module MyModule\n  puts \"start my module\"\n  def mytest\n    puts \"mytest\"\n  end\n\n  module YourModule\n    def yourtest\n      puts \"yourtest\"\n    end\n  end\nend\n\nmodule MyModule\n  module YourModule\n    module HisModule\n      HIS_CONSTANT = 'THIS_IS_A_CONSTANT'\n    end\n  end\nend\n\nmodule MyModule\n  module YourModule\n    class HisClass\n      include HisModule\n      def show_constant\n        puts HIS_CONSTANT\n      end\n    end\n  end\nend\n\nMyModule::YourModule::HisClass.class_eval do\n  def show_his_constant\n    puts HIS_CONSTANT\n  end\nend\n</code></pre>\n\n<p>BTW, I know this way can work:</p>\n\n<pre><code>MyModule::YourModule::HisClass.class_eval do\n  def show_his_constant\n    puts MyModule::YourModule::HisModule::HIS_CONSTANT\n  end\nend\n</code></pre>\n\n<p>But I don't want to use namespace to access, since it should already be included.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","puts"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":13011184,"title":"Printing an array or object in Ruby on rails. Also vew the structure of the data","body":"<p>I'm executing an Active Record query in controller.And now i want to view all of its contents weather it is in the form of array or object.I want to see the structure in which the data is being returned.I'm new to ruby on rails,Please help. In PHP we use var_dump() or print_r(). </p>\n"},{"tags":["ruby-on-rails-3","oauth"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":3425,"score":2,"question_id":5374470,"title":"URI::InvalidURIError (bad URI(is not URI?): ):","body":"<p>I am trying to implement an OAuth provider in rails 3. When I try to authorize a client app I get this error.  I am using the restful auth plugin and pelles oauth-plugin.  When I was testing via the rails console and getting this error I thought that I simply needed to encode the urls but I get the same error when testing in browser so I am not sure what is wrong.  Any help is greatly appreciated.</p>\n\n<p>--thx</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12998987,"title":"Data and compution in rails. How would you design this app?","body":"<p>I want to write a computation intensive machine learning app that runs algorithms on data input.\nAn end user submits a file, and I want to be able to parse it and run huge algorithms on it – basically statistical analysis – and give results back to the user. How do I design this architechture in rails? What controllers, and models and views? How would you design such an app? </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":298,"score":0,"question_id":10840899,"title":"rails 3.2 We're sorry, but something went wrong in production. log file doesn't log errors","body":"<p>i'm using apache + passenger</p>\n\n<pre><code>&lt;VirtualHost *:80&gt;\n      RailsEnv production\n      ErrorLog /home/rails/project_error.log\n      CustomLog /home/rails/project_access.log combined\n\n      DocumentRoot /home/rails/project/public\n      &lt;Directory /home/rails/project/public&gt;\n         AllowOverride all\n         Options -MultiViews\n      &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n\n<p>it works fine in development but when i switch to production i got famous \"We're sorry, but something went wrong.\" text. </p>\n\n<p>the strange thing is development.log doesn't show any errors. if i precompile assets or do database migrations then it's all placed in log file but nothing on 500 errors. i have </p>\n\n<pre><code>config.log_level = :debug\n</code></pre>\n\n<p>in production.rb</p>\n\n<p>project_error.log is also empty and the errors are logged in projest_access.log</p>\n\n<pre><code>[31/May/2012:22:22:35 +0200] \"GET / HTTP/1.1\" 500 393 \"-\" \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0\"\n</code></pre>\n\n<p>what have i screwed up this time?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":130,"score":1,"question_id":11643769,"title":"How to install debugger in my NetBeans 6.9.1","body":"<p>I want to install debugger in my NetBeans 6.9.1.</p>\n\n<p>I am using web applications which are communicating to each other and I am also using <em>RVM</em> with 2 different gemset which are having same version of Ruby and Rails install separately.</p>\n\n<p>So how can I install debugger </p>\n\n<p>I tried with this but not able to install this gem </p>\n\n<pre><code> ruby-debug-base19 (0.11.25)\n ruby-debug-ide (0.4.16)\n linecache19 (0.5.12) \n</code></pre>\n\n<p>Getting this error</p>\n\n<pre><code>bash: syntax error near unexpected token `('\nsamarth:~/project/MyECF-Pacer-Service$ gem install ruby-debug-base19\n/home/samarth/.rvm/rubies/ruby-1.9.2-p320/bin/gem:4: warning: Insecure world writable     dir /home/samarth/.rvm/gems/ruby-1.9.2-p320@persi/bin in PATH, mode 042777\nWARNING:  Error fetching data: Errno::ETIMEDOUT: Connection timed out - connect(2)         (http://rubygems.org/latest_specs.4.8.gz)\nERROR:  Could not find a valid gem 'ruby-debug-base19' (&gt;= 0) in any repository\nERROR:  Possible alternatives: ruby-debug-base19\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","devise","csrf"],"answer_count":5,"favorite_count":5,"up_vote_count":12,"down_vote_count":0,"view_count":6321,"score":12,"question_id":9362910,"title":"rails - \"WARNING: Can't verify CSRF token authenticity\" for json devise requests","body":"<p>do you know how it is possible to correctly retrieve the CSRF token to pass with a JSON request?</p>\n\n<p>I know that for security reason now Rails is enforcing CSRF check on all the request type (including JSON/XML).</p>\n\n<p><a href=\"http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails\">http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails</a></p>\n\n<p>I could put in my controller <code>skip_before_filter :verify_authenticity_token</code> ,but I would loose the CRSF protection (not advisable :-) ).</p>\n\n<p>In this similar (still not accepted) question </p>\n\n<p><a href=\"http://stackoverflow.com/questions/9044141/rails-devise-creating-new-users-via-json-request\">Rails/Devise - Creating new users via json request</a></p>\n\n<p>It is suggested to </p>\n\n<pre><code>Retrieve the token with &lt;%= form_authenticity_token %&gt;\n</code></pre>\n\n<p>The question is how? Do I need to do a first call to any of my pages to retrive the token and then do my real authentication with Devise? Or it is an information one-off that I can get from my server and then use consistently (until I manually change it on the server itself)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec2","rspec-rails"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13010749,"title":"ActionController::RoutingError when test custom devise controller","body":"<p>I'm trying to add a custom action to Devise's registration controller which allows users to change their passwords (I cannot use default <code>registrations#edit</code> since I need a form for changing only password, not email/username). The implementation I wrote below works in development mode but I get this error when I test controller.</p>\n\n<pre><code>Failure/Error: get 'password'\nActionController::RoutingError:\n  No route matches {:controller=&gt;\"registrations\", :action=&gt;\"password\"}\n</code></pre>\n\n<p>There is my code (I tried to skip unrelated parts)</p>\n\n<p><code>spec/controllers/registrations_controller_spec.rb</code></p>\n\n<pre><code>describe RegistrationsController do\n  include Devise::TestHelpers\n\n  before :each do\n    request.env[\"devise.mapping\"] = Devise.mappings[:users]\n  end\n\n  describe \"GET 'password'\" do\n    it \"...\" do\n                     # The problem is here,\n      get 'password' # it raises ActionController::RoutingError\n    end\n  end\nend\n</code></pre>\n\n<p><code>app/controllers/registrations_controller.rb</code></p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n  # ...\n  def password\n  end\nend\n</code></pre>\n\n<hr>\n\n<p><code>config/routes.rb</code></p>\n\n<pre><code>devise_for :users, path: 'account', \n  controllers: { registrations: 'registartions' }, \n  skip: [:registartions, :sessions]\n\ndevise_scope :user do\n  # ...\n  scope '/account' do\n    get 'password' =&gt; 'devise/registartions#password', as: \"change_password\n  do\nend\n</code></pre>\n\n<p><code>spec_helper.rb</code></p>\n\n<pre><code># ...\nRSpec.configure do |config|\n  # ...\n  config.include Devise::TestHelpers, :type =&gt; :controller\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","task","whenever"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":13009165,"title":"Scheduling recurring task in ruby on rails 3.2","body":"<p>I have ruby on rails website,in which I want to perform some task at fixed interval such as 'sending report by email every sunday',for example.<br/>\nI have examined using <code>whenever</code> gem but since it is wrapper for the *nix utility cron,it may not work on windows.<br/></p>\n\n<p>I am asking for which gem or method to use to do for scheduling such above task that is not depend on underlying platform?</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":13008751,"title":"Active Model MassAssignmentSecurity Error","body":"<p>I'm Getting an Error: I'm developing a web with Facebook Integration.. I'm new in ruby on rails. can you help with my problem.</p>\n\n<pre><code>ActiveModel::MassAssignmentSecurity::Error in SessionsController#create\n\nCan't mass-assign protected attributes: name\n</code></pre>\n\n<p><b>This is my controller:</b></p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def create\n    #render :json =&gt; request.env['omniauth.auth'].to_yaml\n   auth = request.env['omniauth.auth']\n    unless @auth = Authorization.find_from_hash(auth)\n      @auth = Authorization.create_from_hash(auth, current_user)\n    end\n\n    self.current_user = @auth.user  \n    render :text =&gt; \"Welcome, #{current_user.name}.\"\n   end\nend\n</code></pre>\n\n<p><b>This is my user model:</b></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :authorizations\n  attr_accessor :name, :uid, :provider\n\n  def self.create_from_hash!(hash)\n    #create(:name =&gt; hash['user_info']['name'])\n   create(:name =&gt; hash.info.name)\n  end\nend\n</code></pre>\n\n<p><b>This is my authorization model:</b></p>\n\n<pre><code>class Authorization &lt; ActiveRecord::Base\n  belongs_to :user\n  validates_presence_of :user_id, :uid, :provider\n  validates_uniqueness_of :uid, :scope =&gt; :provider\n\n  def self.find_from_hash(hash)\n    find_by_provider_and_uid(hash['provider'], hash['uid'])\n  end\n\n  def self.create_from_hash(hash, user = nil)\n    user ||= User.create_from_hash!(hash)\n    Authorization.create(:user =&gt; user, :uid =&gt; hash['uid'], :provider =&gt; hash['provider'])\n  end\nend\n</code></pre>\n\n<p>how can I fix this .. Thanks in advance :)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":13000533,"title":"Heroku Missing Template Error RoR","body":"<p>I have been trying to get this app to deploy correctly to Heroku for over a day now and having solved one error after another I am stuck on this one. </p>\n\n<p>I am being served a <code>We're Sorry something went wrong</code> 500 error and I have the following log:</p>\n\n<pre><code> 2012-10-21T17:40:32+00:00 app[web.1]: [2012-10-21 17:40:32] INFO  WEBrick 1.3.1\n 2012-10-21T17:40:32+00:00 app[web.1]: [2012-10-21 17:40:32] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]\n 2012-10-21T17:40:32+00:00 app[web.1]: [2012-10-21 17:40:32] INFO  WEBrick::HTTPServer#start: pid=2 port=18894\n 2012-10-21T17:40:33+00:00 heroku[web.1]: State changed from starting to up\n 2012-10-21T17:41:55+00:00 heroku[web.1]: State changed from up to starting\n 2012-10-21T17:41:57+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 44537`\n 2012-10-21T17:41:58+00:00 heroku[web.1]: Stopping all processes with SIGTERM\n 2012-10-21T17:41:58+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'\n 2012-10-21T17:41:58+00:00 app[web.1]: [2012-10-21 17:41:58] ERROR SignalException: SIGTERM\n 2012-10-21T17:41:59+00:00 app[web.1]: =&gt; Booting WEBrick\n 2012-10-21T17:41:59+00:00 app[web.1]: =&gt; Rails 3.2.0 application starting in production on http://0.0.0.0:18894\n 2012-10-21T17:41:59+00:00 app[web.1]: =&gt; Call with -d to detach\n 2012-10-21T17:41:59+00:00 app[web.1]: =&gt; Ctrl-C to shutdown server\n 2012-10-21T17:41:59+00:00 app[web.1]:\n 2012-10-21T17:41:59+00:00 app[web.1]:\n 2012-10-21T17:41:59+00:00 app[web.1]: Started GET \"/\" for 86.9.116.69 at 2012-10-21 17:41:59 +0000\n 2012-10-21T17:42:00+00:00 app[web.1]:\n 2012-10-21T17:42:00+00:00 app[web.1]: ActionView::MissingTemplate (Missing template /404 with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee, :haml]}. Searched in:\n 2012-10-21T17:42:00+00:00 app[web.1]:   * \"/app/app/views\"\n 2012-10-21T17:42:00+00:00 app[web.1]:   * \"/app/vendor/bundle/ruby/1.9.1/gems/rails_admin-0.1.2/app/views\"\n 2012-10-21T17:42:00+00:00 app[web.1]:   * \"/app/vendor/bundle/ruby/1.9.1/gems/kaminari-0.14.1/app/views\"\n 2012-10-21T17:42:00+00:00 app[web.1]:   * \"/app/vendor/bundle/ruby/1.9.1/gems/devise-2.1.2/app/views\"\n 2012-10-21T17:42:00+00:00 app[web.1]: ):\n 2012-10-21T17:42:00+00:00 app[web.1]:   app/controllers/application_controller.rb:10:in `render_404'\n 2012-10-21T17:42:00+00:00 app[web.1]:\n 2012-10-21T17:42:00+00:00 app[web.1]:\n 2012-10-21T17:42:00+00:00 app[web.1]: cache: [GET /] miss\n 2012-10-21T17:42:00+00:00 heroku[router]: GET secure-ocean-9819.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=340ms status=500 bytes=643\n</code></pre>\n\n<p>Everything works perfectly on Localhost so I am confused why it seems to be struggling on Heroku. </p>\n\n<p>Any help people can offer really would be much appreciated :)</p>\n"},{"tags":["ruby-on-rails-3","devise","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13009753,"title":"How can devise allowing me to update password without passing current password?","body":"<p>I am using the rails 3.2.x with devise to authenticate the user password.\nOn one page I am updating allowing user to update the his password. But even after providing the wrong current password, user can be able to update his/her password.</p>\n\n<p>Same thing is happening with the rails console.</p>\n\n<pre><code>@user = user.update_attributes :password =&gt; \"some_password\"\n</code></pre>\n\n<p>updates the @user's password.</p>\n\n<p>How to get away with this trouble? </p>\n\n<p><strong>UPDATE</strong>:\nI can update user password with wrong current_password parameter to update_attributes method like,</p>\n\n<pre><code>@user = user.update_attributes :password =&gt; \"some_password\", :current_password =&gt; \"wrong_password\"\n</code></pre>\n"}]}
{"total":34675,"page":14,"pagesize":100,"questions":[{"tags":["ruby-on-rails-3","postgresql","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":13009060,"title":"Heroku run rake db:migrate role error?","body":"<p>I've just managed to successfully push my app to Heroku. However, when trying to run <code>heroku run rake db:migrate</code>, I get this weird error:</p>\n\n<pre><code>heroku run rake db:migrate --remote staging --trace                                                                                                                                        [ruby-1.9.3-p125@ramen]\nRunning `rake db:migrate --trace` attached to terminal... up, run.1\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required)&gt; at /app/Rakefile:7)\n** Invoke db:migrate (first_time)\n** Invoke environment (first_time)\n** Execute environment\nrake aborted!\nFATAL:  role \"ngbmsmmcogkdfv\" is not permitted to log in\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `initialize'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `new'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `connect'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:329:in `initialize'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:309:in `new_connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:319:in `checkout_new_connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:241:in `block (2 levels) in checkout'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:236:in `loop'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:236:in `block in checkout'\n/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:233:in `checkout'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:96:in `block in connection'\n/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:95:in `connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:404:in `retrieve_connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:170:in `retrieve_connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:144:in `connection'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:308:in `clear_cache!'\n/app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/railtie.rb:97:in `block (2 levels) in &lt;class:Railtie&gt;'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:418:in `_run__988607377061129518__prepare__148721129126176046__callbacks'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'\n/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/reloader.rb:74:in `prepare!'\n/app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application/finisher.rb:47:in `block in &lt;module:Finisher&gt;'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n/app/config/environment.rb:29:in `&lt;top (required)&gt;'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'\n/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:103:in `require_environment!'\n/app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:295:in `block (2 levels) in initialize_tasks'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'\n/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `block in invoke_prerequisites'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `block in invoke_with_call_chain'\n/usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/app/vendor/bundle/ruby/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n/app/vendor/bundle/ruby/1.9.1/bin/rake:19:in `load'\n/app/vendor/bundle/ruby/1.9.1/bin/rake:19:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate =&gt; environment\n</code></pre>\n\n<p>Anybody know why I could be getting this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","datetime","squeel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13009163,"title":"Time calculations in Rails where statement","body":"<p>I'm trying to make some time calculations in where statement. I would like to select offers which life time has already past. </p>\n\n<pre><code>select_offers = Offer.where { (published_time + life_time) &lt; DateTime.now }\n</code></pre>\n\n<p>It doesn't throw any error but it also doesn't return objects. I'm using squeel gem. What is the best approach to this?</p>\n"},{"tags":["ruby","ruby-on-rails-3","jruby","jrubyonrails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":13008699,"title":"Getting error while generation of model in JRuby","body":"<p>Hi I am getting error while I am generating the model. Following the error stack i am facing. </p>\n\n<pre><code>   rails generate model id:string name:string userid:string groupid:string bookmarktype:string typeid:string additionaldata:string\n    include_class is deprecated. Use java_import.\n    include_class is deprecated. Use java_import.\n    Resolved collector.newrelic.com to 204.93.223.153\n          invoke  active_record\n    NameError: wrong constant name Id:string\n                const_defined? at org/jruby/RubyModule.java:2608\n              class_collisions at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/railties-3.2.3/lib/rails/generators/base.rb:267\n                          each at org/jruby/RubyArray.java:1612\n              class_collisions at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/railties-3.2.3/lib/rails/generators/base.rb:249\n         check_class_collision at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/railties-3.2.3/lib/rails/generators/named_base.rb:183\n                      __send__ at org/jruby/RubyBasicObject.java:1667\n                          send at org/jruby/RubyKernel.java:2060\n                           run at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/task.rb:21\n                   invoke_task at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/invocation.rb:118\n                    invoke_all at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/invocation.rb:124\n                          each at org/jruby/RubyHash.java:1192\n                           map at org/jruby/RubyEnumerable.java:715\n                    invoke_all at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/invocation.rb:124\n                      dispatch at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/group.rb:226\n                      __send__ at org/jruby/RubyBasicObject.java:1694\n                          send at org/jruby/RubyKernel.java:2072\n                        invoke at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/invocation.rb:109\n      _invoke_for_class_method at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/group.rb:269\n                  with_padding at /home/anand/.rvm/gems/jruby-1.7.0.preview2/gems/thor-0.14.6/lib/thor/shell.rb:74\n</code></pre>\n\n<p>Following is the output of rvm list</p>\n\n<pre><code>rvm list\n\nrvm rubies\n\n=* jruby-1.7.0.preview2 [ i386 ]\n   ruby-1.9.3-p194 [ i686 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p>I am using Ubuntu 12.04. How to resolve this problem?</p>\n"},{"tags":["ruby-on-rails-3","sqlite","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":13009277,"title":"Rails 3 console and db:console are different","body":"<p>I have a rails app and when I have both the console and db:console open, they have different values for what is supposed to be the same field.  I am using the send function to change the value.  Here is the method in the model:</p>\n\n<pre><code>  def toggle_approve(field)\n    self.send(field)\n    if(self.send(field).blank?)\n        self.send(field + '=', \"new_value\")\n        puts self.send(field)\n    else\n        self.send(req + '=', \"\")\n    end\n    rank.save\n  end\n</code></pre>\n\n<p>In my db:console (sqllite) everything is always correct, but in my regular erb console it is wrong.  My view will then show what is in the erb console and not the sqllite.  I dont understand what is going on in the background that would causing this issue.  Any help would be great.  </p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":270,"score":0,"question_id":11819455,"title":"Change Bootstrap Color of Links in Navbar","body":"<p>In my navbar I have the following: </p>\n\n<pre><code>Signed in as &lt;%= link_to current_user.name, edit_password_path(current_user) %&gt; | \n&lt;%= link_to \"Sign out\", destroy_user_session_path, :method =&gt; :delete %&gt;\n</code></pre>\n\n<p>But the text appears black for the link. I have the following in my bootstrap and overrides CSS file:</p>\n\n<pre><code>@navbarLinkColor: @grayLight;\n@navbarLinkColorHover: @grayLight;\n@navbarLinkColorActive: @grayLight;\n</code></pre>\n\n<p>The resulting html looks like: </p>\n\n<blockquote>\n<pre><code>&lt;p class=\"navbar-text pull-right\"&gt;\n   Signed in as &lt;a href=\"/password/8/edit\"&gt;Test&lt;/a&gt; | \n   &lt;a href=\"/users/sign_out\" data-method=\"delete\" rel=\"nofollow\"&gt;Sign out&lt;/a&gt;\n&lt;/p&gt; \n</code></pre>\n</blockquote>\n\n<p>So why isn't it working? I am using Twitter Bootstrap Rails Gem in my application if that helps.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","rspec","mocha"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":790,"score":0,"question_id":7211176,"title":"Using rspec the ensure logger is called","body":"<p>I am trying to test a controller in my rails app under a specific condition that should raise an error and log it. I got the raise test working great but I would like to make sure the logger gets called, so far I tried this, but it is not working</p>\n\n<pre><code>  it 'logs the error' do\n    get 'edit', {:id =&gt; 'banana'}\n    Logger.any_instance.expects(:error)\n  end\n</code></pre>\n\n<p>ps i am using Mocha</p>\n"},{"tags":["ruby-on-rails-3","formtastic"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":13007397,"title":"Formtastic on Checkboxes Setting a Default Checked checkboxes","body":"<p>Making use of Formtastic in my App on a Many to many Relationship.</p>\n\n<p>All perfect.</p>\n\n<p>What i need to do is have some checkboxes created by default in the create action.</p>\n\n<p>Anyone know what the best route to go on this is.\ncurrent have the following:</p>\n\n<pre><code>&lt;%= hidden_field_tag \"company[client_ids][]\", nil %&gt;\n&lt;% Client.all.each do |client| %&gt;\n&lt;tr&gt;\n&lt;td&gt;&lt;%= check_box_tag \"company[client_ids][]\", client.id, @compeny.client_ids.include? (client.id) %&gt;&lt;/td&gt;\n&lt;td&gt;&lt;%= client.name %&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Can it be changed by the Nil function?</p>\n"},{"tags":["ruby","ruby-on-rails-3","parsing","yaml"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13006202,"title":"Managing a changing text file in Rails","body":"<p>I'd like to be able to have a text file (which is not in the developer's control of the content) and have my code pick entries from that file and display them in the web app (or do something else with them)</p>\n\n<p>for example, this text file could be a list of people, or famous quotes that keep displaying on the screen, in order or randomize.</p>\n\n<p>my question is what is the easiest way of implementing this? \nShould I put it in XML and parse it? put it in YAML? Where do I do the parsing? in the controller or in the initializers?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","ruby-on-rails-plugins"],"answer_count":8,"favorite_count":6,"up_vote_count":9,"down_vote_count":0,"view_count":1744,"score":9,"question_id":5410681,"title":"Which Ruby on Rails admin plugin do you use and why? What are the pros and cons of different admin gems?","body":"<p>We need a dead simple, but secure, admin plugin for Rails. We're on 2.x but are considering a port to 3.x.</p>\n\n<p>Which admin plugin do you use, and why? What are the pros and cons of others? There are a few admin plugins available, and we would like to draw on the experience of others before choosing one.</p>\n\n<p>And by admin plugin, I mean a plugin to help us manage the data and users of the application.</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","debugging","ruby-on-rails-3.2","footnotes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12996166,"title":"Rails Footnotes partials count is always zero","body":"<p>I'm using the <a href=\"https://github.com/josevalim/rails-footnotes\" rel=\"nofollow\">rails-footnotes</a> gem in my Rails 3.2 applications, but I can't seem to get the footnotes to register the existence of any partials: it always shows a zero partial count.  </p>\n\n<p>To be able to know how many and what partials are being displayed on a view easily like this is, I think, immensely useful, so I would really like to get this working (the rest works great), but I'm not sure what the problem is and am hoping someone else has had the same problem and was able to resolve it.  Is there a setting I've potentially missed?</p>\n\n<p>I don't think it's relevant, but I'm using OSX 10.6.8 and had some issues getting the gem to work with Sublime Text 2 properly, but they did get resolved (details in <a href=\"http://stackoverflow.com/a/11619954/567863\">this StackOverflow answer</a>).</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>It seems that the issue only exists for haml templates, as I am getting expected output for erb templates.  It would seem that only erb templates are counted/recognized...?</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":13005307,"title":"How to implement the dynamic authorization with CanCan?","body":"<p>i am following this tutorial <a href=\"http://eveloverails.wordpress.com/2011/04/02/183/\" rel=\"nofollow\">http://eveloverails.wordpress.com/2011/04/02/183/</a>. I have created the users through devise and i want when the user log in as an admin he should have the list of users in which it can edit the permissions of the users like edit destroy,etc.</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","ruby-on-rails-3.1","migration"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":243,"score":4,"question_id":8935350,"title":"Rails 3.1: can't write to column in same migration that adds it","body":"<p>I had an add_column migration that would run fine.  However, after running it and firing up a console, I would find the first_name and last_name columns completely empty.  I tried using <code>save!</code> instead and it had the same effect--no errors reported.  Here's the original:</p>\n\n<pre><code>class UserAddFirstNameAndLastName &lt; ActiveRecord::Migration\n  def change\n    # add column first name, last name string\n    add_column :users, :first_name, :string\n    add_column :users, :last_name, :string\n\n    User.all.each do |u|\n      u.first_name = 'first name'\n      u.last_name = 'last name'\n      u.save\n    end\n  end\nend\n</code></pre>\n\n<p>I also thought this might be some class loading issue, so I inserted the line <code>User</code> to force the user class to reload before the loop.  No dice.</p>\n\n<p>When I split this up into two migrations, the desired effect was achieved.  Does someone have an explanation for this?  I swear I've even done this in the same project with past migrations.</p>\n\n<p>Other notes: Devise for user engine, added the new columns to <code>attr_accessible</code> in User class before running migration.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":66,"score":4,"question_id":12994144,"title":"Rails/Postgresql SQL differences w/ Dates","body":"<p>When running the following query in psql I get back 7 results:</p>\n\n<pre><code>SELECT generate_series('2012-10-14', CURRENT_DATE, interval '1 day'); # 7\n</code></pre>\n\n<p>However when I run the exact same query in my rails application, I get 8 results:</p>\n\n<pre><code>result = ActiveRecord::Base.connection.execute \"SELECT generate_series('2012-10-14', CURRENT_DATE, interval '1 day');\"\nputs result.count # 8\n</code></pre>\n\n<p>It seems like this has something to do w/ timezones but I don't know what the problem could be. I have the following in my application.rb</p>\n\n<pre><code>config.time_zone = 'Eastern Time (US &amp; Canada)'\n</code></pre>\n\n<p>This is the same time zone setting that I have in my postgresql.conf</p>\n\n<p>I'm confused at to why my rails application is adding an additional day to my results. Can anyone provide some insight?</p>\n\n<p>This only seems to happen towards the end of the day (after 8PM) so this is what makes me think it's something w/ time zone offsets.</p>\n"},{"tags":["ruby-on-rails-3","testing","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":13004522,"title":"Setting default_url_options in test environment doesn't seem to work","body":"<p>I've put the following code into my <code>config/environments/test.rb</code> file:</p>\n\n<pre><code>config.action_mailer.default_url_options = { :host =&gt; \"localhost:3000\" }\n</code></pre>\n\n<p>however when I run my tests, all routes use <code>http://test.host</code>. I'm trying to work with an API that won't accept <code>http://test.host</code> as a valid callback URI, so I need to change this to properly receive the API response. Any idea why this isn't working? (I'm using RSpec, Guard, and Spork in my testing suite).</p>\n\n<p><strong>EDIT</strong>: Possibly relevant - this is being done inside of a controller spec.</p>\n\n<p><strong>EDIT2</strong>: It seems that it changes after a request is made via <code>get</code>, <code>post</code>, etc. Running the following code within the test:</p>\n\n<pre><code>Rails.logger.debug users_url\nget 'http://google.com'\nRails.logger.debug users_url\n</code></pre>\n\n<p>would produce the following output:</p>\n\n<pre><code>http://localhost:3000/users\n...get request related response here\nhttp://google.com/users\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","facebook-graph-api","koala"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13004999,"title":"Having Issues Returning A Value Based on a Hash Key","body":"<p>I'm having difficulty accessing a particular value from a Koala <code>GraphCollection</code> object<BR> (represented as a Ruby hash). I am successfully returning the following data from a Facebook test user (This is a page object connected with the User):</p>\n\n<pre><code>[{\"name\"=&gt;\"Product Name\", \"access_token\"=&gt;\"--Access Token Goes Here--\", \n\"category\"=&gt;\"Baby goods/kids goods\", \"id\"=&gt;\"244624772329824\", \"perms\"=&gt;[\"ADMINISTER\", \n\"EDIT_PROFILE\", \"CREATE_CONTENT\", \"MODERATE_CONTENT\", \"CREATE_ADS\", \"BASIC_ADMIN\"]}]\n</code></pre>\n\n<p>What I would like to do is present the ID Value in my Rails view be accessing a class method from the view. The method in the model looks like this:</p>\n\n<pre><code>accounts = facebook.get_connection(\"me\", \"accounts\")\naccounts.each { |f| f['id'] }\n</code></pre>\n\n<p>The code in the view simply calls the method: </p>\n\n<pre><code>&lt;%= current_user.my_page_id %&gt; \n</code></pre>\n\n<p>The result of this attempt is simply returning the full data collection outlined above. I've tried several other Ruby Hash techniques, but most result in \"Can't Convert String to Integer\".</p>\n\n<p>I'm using Rails 3.2, Ruby 1.9.3p125. </p>\n\n<p>Thanks much!</p>\n"},{"tags":["ruby-on-rails-3","validation","error-handling","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":27,"score":1,"question_id":13004924,"title":"Mongoid Revert if fail","body":"<p>I have a validations in mongoid that I want to revert if it fails while saving the error message.  </p>\n\n<p>Example</p>\n\n<pre><code>if @thing.update_attributes(params[:thing])\n  format.html { redirect_to @thing, notice: 'Thing was successfully updated.' }\n  format.json { head :no_content }\nelse\n  #revert the fields that have changed and keep @thing.errors\n  format.html { render action: \"edit\" }\n  format.json { render json: @thing.errors, status: :unprocessable_entity }   \nend\n</code></pre>\n\n<p>when I save off the document and reinsert it, it seems to not want to assign <code>@thing.errors = errors</code></p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","search"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":37,"score":0,"question_id":13004830,"title":"searching with join table , ruby on rails","body":"<p>I have a question about searching code table reimburse and entered by username in table user.\nthis is form searching:</p>\n\n<pre><code>&lt;%= form_tag reimburses_searchreimburse_path, method: :get do %&gt;\n                    &lt;%= text_field_tag :reimburse, params[:reimburse] %&gt;\n                    &lt;%= submit_tag \"Search\", name: nil%&gt;\n                    &lt;% end %&gt;\n</code></pre>\n\n<p>this the controller</p>\n\n<pre><code> def searchreimburse\n @users = User.where(\"username LIKE ? \", \"%#{params[:reimburse]}%\")  \n @reimburses = Reimburse.all  \n @project = Project.all\nend\n</code></pre>\n\n<p>I want output like this:</p>\n\n<pre><code>&lt;tr&gt;                      \n                    &lt;th &gt;#&lt;/th&gt;\n                    &lt;th &gt;Date&lt;/th&gt; \n                    &lt;th &gt;Project name&lt;/th&gt;\n                    &lt;th &gt;Title&lt;/th&gt;\n                    &lt;th &gt;User name&lt;/th&gt;   #*this from table user*\n                    &lt;th &gt;Status&lt;/th&gt;\n                    &lt;th &gt;Action&lt;/th&gt;\n                &lt;/tr&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","database","ruby-on-rails-3","data-binding","obfuscation"],"answer_count":4,"favorite_count":4,"up_vote_count":3,"down_vote_count":0,"view_count":335,"score":3,"question_id":9305036,"title":"How do I obfuscate the ids of my records in rails?","body":"<p>I'm trying to figure out how to obfuscate the ids of my records in rails.</p>\n\n<p>For example: a typical path might look like <a href=\"http://domain/records/1\" rel=\"nofollow\">http://domain/records/1</a>, so it's pretty easy for people to deduce how much traffic the site is getting if they just create a new record. </p>\n\n<p>One solution that I've used is to hash the id with a salt, but since I'm not sure whether that function is bijective, I end up storing it in another column in my database and double check for uniqueness. </p>\n\n<p>Another option I was thinking about was generating a random hash and storing that as another column. If it isn't unique ... just generate another one. </p>\n\n<p>What's the best way of doing this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","templates","dry"],"answer_count":2,"favorite_count":0,"up_vote_count":12,"down_vote_count":0,"view_count":1043,"score":12,"question_id":6550103,"title":"In which folder should I put \"global\" shared partial templates?","body":"<p>I am using Ruby on Rails 3.0.7 and I am planning to use partial templates. All classes in my application would use same partials so I have to decide where to located all those.</p>\n\n<p>Is it a good idea to put \"global\" shared partial templates in the <code>lib</code> folder? If no, what is a common practice to choose the folder where to put those? Any advice on how to properly name and load that folder?</p>\n"},{"tags":["ruby-on-rails-3","mongoid","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":306,"score":4,"question_id":11159873,"title":"Mongoid and simple_form, Boolean type does not create checkbox","body":"<p>I'm starting with mongoid and simple_form.  If I have a model with :type => Boolean and render it in a (haml) view with =f.input, it creates a text input field not a checkbox.  </p>\n\n<p>The doc says that boolean maps to a checkbox but I suspect that Boolean and boolean are not handled the same.</p>\n\n<p>I can work around with adding :as => boolean to the simple_form.</p>\n\n<p>1) Is that expected or am I doing something wrong?\n2) Is there a way to add a general mapping of Boolean to simple_form?\n3) Should I generate an issue for simple_form to correct this?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","sqlite3","rake","dbmigrate"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":10477860,"title":"rake db:migrate is not working - continuously pending","body":"<pre><code>&gt;C:\\rails_projects\\sample_app&gt;rake db:migrate\n&gt;-- create_table(\"users\", {:force=&gt;true})\n&gt;   -&gt; 0.5100s\n&gt;-- add_index(\"users\", [\"email\"], {:name=&gt;\"index_users_on_email\", :unique=&gt;true})\n&gt;   -&gt; 0.0170s\n&gt;-- initialize_schema_migrations_table()\n&gt;   -&gt; 0.0340s\n&gt;-- assume_migrated_upto_version(20120428165946, [\"C:/rails_projects/sample_app/db/migrate\"\n&gt;])\n&gt;   -&gt; 0.0560s\n&gt;You have 1 pending migrations:\n&gt;  20120507063126 AddAdminToUsers\n&gt;Run `rake db:migrate` to update your database then try again.\n</code></pre>\n\n<p>every time I run \"rake db:migrate\" this is what I get. The migration is continuously pending and I can't get it to go? I'm a newb and I'm sure it's an easy fix, but I can't figure it out.</p>\n"},{"tags":["ruby","ruby-on-rails-3","csv","encoding"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":13004318,"title":"ruby sanitizing uploaded csv","body":"<p>I am uploading a CSV file in RoR application (1.9.2) like this:</p>\n\n<pre><code>CSV.foearch(file.path, :col_sep =&gt; \";\", :encoding =&gt; \"utf-8\") do |row|\n  first_col = row[0]\nend\n</code></pre>\n\n<p>The problem is that the file sometimes comes with weird characters, so i get </p>\n\n<pre><code>invalid byte sequence in UTF-8\n</code></pre>\n\n<p>Changing the encoding to <strong>windows-1251:utf-8</strong> ignores this issue, but when performing some operation with the database, it throws a collation exception, telling that the encoding of the db must be UTF-8.</p>\n\n<p>So, my question is.. Is there anyway to replace all weird characters to blank character, or sanitizing the incoming file in order to continue the operation.</p>\n"},{"tags":["ruby-on-rails-3","devise","actionmailer","devise-confirmable"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":176,"score":0,"question_id":11026228,"title":"devise config.action_mailer.default_url_options not working","body":"<p>I have switched over to pow in order to use ssl in development and I want to switch the host configuration in development, however devise continues to send email prefixed with the localhost:3000 domain. Here is what I have in my config/environments/development.rb file:</p>\n\n<pre><code>config.action_mailer.default_url_options = { :host =&gt; 'want_freight.dev' }\n</code></pre>\n\n<p>I have restarted my server and I have grepped my entire application looking for the offending use of localhost:3000 however my search turned up nothing outside of tmp and log files. Does anyone know why this would not be working??</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12876445,"title":"How can I override destroy_if_previously_invited in devise_invitable?","body":"<p>I'm using <code>devise_invitable</code> with <code>devise</code> in my Rails 3 app.  I want to give my users the ability to invite other users and group those invited users in advance of the invitees signing up.</p>\n\n<p>My problem is that once the invitee comes along and signs up (but doesn't use the invite URL), the <code>destroy_if_previously_invited</code> around_filter comes along, destroys the original user record and recreates a new record for the user, retaining the invitation data but not transferring the user_groups records along with it.  </p>\n\n<p>I'd like to simply override this around_filter by doing a search for any user_groups that match the originally invited user_id and saving them with the newly created user_id.</p>\n\n<p>I keep getting the error:</p>\n\n<pre><code>LocalJumpError in Users::RegistrationsController#create\n\nno block given (yield)\n</code></pre>\n\n<p>My route looks like this:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :registrations =&gt; \"users/registrations\" }\n</code></pre>\n\n<p>I've set this as the override in app/controllers/users/registrations_controller.rb:</p>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n\n  around_filter :destroy_if_previously_invited, :only =&gt; :create\n\n\n  private    \n\n  def destroy_if_previously_invited\n    invitation_info = {}\n\n    user_hash = params[:user]\n    if user_hash &amp;&amp; user_hash[:email]\n      @user = User.find_by_email_and_encrypted_password(user_hash[:email], '')\n      if @user\n        invitation_info[:invitation_sent_at] = @user[:invitation_sent_at]\n        invitation_info[:invited_by_id] = @user[:invited_by_id]\n        invitation_info[:invited_by_type] = @user[:invited_by_type]\n        invitation_info[:user_id] = @user[:id]\n        @user.destroy\n      end\n    end\n\n    # execute the action (create)\n    yield\n    # Note that the after_filter is executed at THIS position !\n\n    # Restore info about the last invitation (for later reference)\n    # Reset the invitation_info only, if invited_by_id is still nil at this stage:\n    @user = User.find_by_email_and_invited_by_id(user_hash[:email], nil)\n    if @user\n      @user[:invitation_sent_at] = invitation_info[:invitation_sent_at]\n      @user[:invited_by_id] = invitation_info[:invited_by_id]\n      @user[:invited_by_type] = invitation_info[:invited_by_type]\n      user_groups = UserGroup.find_all_by_user_id(invitation_info[:user_id])\n      for user_group in user_groups do\n        user_group.user_id = @user.id\n        user_group.save!\n      end\n      @user.save!\n    end\n  end\nend\n</code></pre>\n\n<p>I may also just be going about this all wrong.  Any ideas would be appreciated.</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12998347,"title":"How can I capture a return value from a ruby load?","body":"<p>I would like to load a theme for a cms I'm building.. I was thinking of having a file called name_of_theme.themespec  .. I would load this.. similar to what Bundler dues with gemspecs.. I was thinking that inside this file I would have something like:</p>\n\n<pre><code>Theme.new do |t|\n  t.value = 'hi'\nend\n</code></pre>\n\n<p>I'd like to capture this theme instance after loading the script.. Should I just grab the contents of the file and eval them?  This leads me to a follow up question is there any difference between loading a file.. and reading the contents and eval'ing.. I know that 'eval' is often considered to be the harbinger of destruction... maybe this use case is ok?</p>\n\n<h1>FOLLOW UP</h1>\n\n<p>Based on the selected answer.. why is it that I get:</p>\n\n<pre><code>evaluationContext = Fiber.new {$SAFE = 4; Fiber.yield binding}.resume\n =&gt; #&lt;Binding:0x007f85fc8a0fc8&gt; \na = evaluationContext.eval('puts $SAFE')\n=&gt; 0\n</code></pre>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","railscasts"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":13003469,"title":"Using omniauth-facebook Railscast #360","body":"<p>I'm trying to authenticate my application using the <a href=\"https://github.com/mkdynamic/omniauth-facebook\" rel=\"nofollow\">omniauth-facebook</a></p>\n\n<p>as you can see on railscast #360. I have the following problems:</p>\n\n<p>I don't know how to work with rails variables enviroment. For example I need to create a fill </p>\n\n<blockquote>\n  <p>config/initializers/omniauth.rb</p>\n</blockquote>\n\n<p>with this code: </p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n  provider :facebook, ENV['FACEBOOK_KEY'], ENV['FACEBOOK_SECRET']\nend\n</code></pre>\n\n<p>I changed the code like this:</p>\n\n<pre><code>Rails.application.config.middleware.use OmniAuth::Builder do\n provider :facebook, \"FACEBOOK_KEY\", \"FACEBOOK_SECRET:\nend\n</code></pre>\n\n<p>but I know this is a very bad practice, but I don't how to do it, but it works.</p>\n\n<p>Then I have to create a session controller to store the facebook credentials on the model. Here I have to code something like this:</p>\n\n<pre><code>class SessionsController &lt; ApplicationController\n  def create\n    user = User.from_omniauth(env[\"omniauth.auth\"])\n    session[:user_id] = user.id\n    redirect_to root_url\n  end\n\n  def destroy\n    session[:user_id] = nil\n    redirect_to root_url\n  end\nend\n</code></pre>\n\n<p>As you can see on the first line of the create I have to work again with an variable enviroment, but with this one I don't know how to work.</p>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>LoadError in SessionsController#create</p>\n  \n  <p>Expected /Users/jeanosorio/rails_projects/andinitos/app/models/user.rb\n  to define User</p>\n</blockquote>\n\n<p>Can someone help me with this variables enviroment to create a facebook authentication for my app, Please??? Because I know that all my problems are because of the variable enviroments. </p>\n\n<p>Thanks!!!</p>\n\n<hr>\n\n<p>Here it's the user model:</p>\n\n<pre><code>def self.from_omniauth(auth)\n  where(auth.slice(:provider, :uid)).first_or_initialize.tap do |user|\n    user.provider = auth.provider\n    user.uid = auth.uid\n    user.name = auth.info.name\n    user.oauth_token = auth.credentials.token\n    user.oauth_expires_at = Time.at(auth.credentials.expires_at)\n    user.save!\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":9520691,"title":"how to fill in form_tag option to correspond routes","body":"<p>routes.rb:</p>\n\n<pre><code>match ':x/:y/zzz/:n' =&gt; 'onecontroller#oneaction', :via =&gt; :get,\n:x =&gt; /\\w+/,\n:y =&gt; /\\w+/,\n:n =&gt; /\\d+/\n</code></pre>\n\n<p>in views:</p>\n\n<pre><code>&lt;%= form_tag({:controller =&gt; \"onecontroller\", :action =&gt; \"oneaction\",  :x =&gt; 'aa', :y =&gt; 'bb',  :n =&gt;'123' }, :method =&gt; \"get\") do %&gt;\n&lt;%= text_field_tag \"n\" %&gt;\n&lt;%= submit_tag(\"Search\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How can I have <code>form_tag</code> generate the correct path to <code>/aa/bb/zzz/123</code> when text field <code>n</code> contains '123'? </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":13002847,"title":"Rails 3.2.8 - How do I do recursive has_one check?","body":"<p>I have the following model:</p>\n\n<pre><code>class Point &lt; ActiveRecord::Base\n ...\n\n has_one :next_point, class_name: \"Point\", foreign_key: \"next_point_id\"\n belongs_to :previous_point, class_name: \"Point\", foreign_key: \"next_point_id\"\n\n # It should return an array with the next remaining points\n def next_remaining_points\n end\n\nend\n</code></pre>\n\n<p>How do I do a method that returns the next_point until the next_point is nil?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","routing","form-submit"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":378,"score":1,"question_id":10414514,"title":"Rails change routing of submit in form_for","body":"<p>I have a model 'Article' and a model 'Ratings' nested within articles.</p>\n\n<p>/articles/123/ratings</p>\n\n<p>I want to change the routing of the f.submit in ratings/_form.html.erb\nnow it is so, that after pressing submit, my application routs to </p>\n\n<p>/ratings/111</p>\n\n<p>but I want to route it to</p>\n\n<p>/article/123</p>\n\n<p>How can I change the routing in a form_for f.submit button.\nI have found here something like this:</p>\n\n<pre><code>&lt;% form_for :thing, :url =&gt; \n url_for(:action =&gt; \"update\", :id =&gt; @thing) do |f| %&gt;\n</code></pre>\n\n<p>But this do not work for my rails 3.2. Thanks for your help,</p>\n"},{"tags":["ruby-on-rails-3","postgresql-9.1","arel","sequel","hstore"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":12284273,"title":"Rails: How can I use Squeel with hstore?","body":"<p>I would like to use the Squeel gem (based on Arel) for my Rails app (v 3.2.6). My hstore column is called properties.</p>\n\n<p>These work perfectly fine:</p>\n\n<pre><code>User.where{(firstname == 'Ryan') &amp; (lastname == 'Bates')}\nUser.where{\"properties @&gt; ('male' =&gt; '1')\"}\n</code></pre>\n\n<p>The second example is a plain Postgres query, because Squeel doesn't seem to support hstore functions.</p>\n\n<p>These don't work:</p>\n\n<pre><code>User.where{\"properties @&gt; ('male' =&gt; '1')\" &amp; firstname == 'Ryan'}\nUser.where{(\"properties @&gt; ('male' =&gt; '1')\") &amp; (firstname == 'Ryan')}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>NoMethodError: undefined method `&amp;' for \"properties @&gt; ('male' =&gt; '1')\":String\n</code></pre>\n\n<p>I do understand the error, but I don't know how to capsule my hstore query. Is there a better way to build hstore queries with Squeel or Arel?</p>\n\n<p>Thanks for any help!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capistrano","mediatemple"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":60,"score":1,"question_id":13002232,"title":"Deploying Rails app with Capistrano","body":"<p>I just acquired a Media Temple (dv) 4.0 server to deploy a Rails app I created via a git repository.  I'm new to Rails but Capistrano deployment seemed pretty straightforward.  Nonetheless, I've been working all day on getting my first Rails project deployed.  Here's the error I'm getting when I execute \"cap production deploy -v\" after setup and check:</p>\n\n<pre><code>** [out :: 64.207.184.51] rake aborted!\n** [out :: 64.207.184.51] no such file to load -- rubygems\n</code></pre>\n\n<p>I have been installing gems all day on the server, so I don't think rubygems isn't installed.  This is after hours of debugging why it was telling me my public key is invalid.</p>\n\n<p>Here are my configuration files:</p>\n\n<p>Capfile:</p>\n\n<pre><code>require 'capistrano/ext/multistage'\n\nload 'deploy'\nload 'deploy/assets'\nload 'config/deploy'\nset :application, 'snippet'\nset :domain, '[server IP address]'\nset :user, 'root'\n</code></pre>\n\n<p>config/deploy.rb</p>\n\n<pre><code>require 'capistrano/ext/multistage'\ndefault_run_options[:pty] = true\nset :stages, [\"production\"]\nset :default_stage, \"production\"\nset :application, \"[app name]\"\nset :scm, :git\nset :repository, \"git@github.com:[github.com repository]\"\nset :branch, \"master\"\nset :user, \"root\"\nset :use_sudo, false\nset :deploy_via, :remote_cache\nset :scm_passphrase, \"[public ssh key passphrase]\"\n</code></pre>\n\n<p>config/deploy/production.rb</p>\n\n<pre><code>server \"[server IP]\", :app, :web, :db, :primary =&gt; true\nset :deploy_to, \"/var/www/vhosts/[domain]/httpdocs\"\n</code></pre>\n\n<p>output of error:</p>\n\n<pre><code>vespertine:snippet nporteschaikin$ cap production deploy -v\n** transaction: start\n/Users/nporteschaikin/.rvm/gems/ruby-1.9.2-p320/gems/capistrano-2.13.4/lib/capistrano/recipes/deploy.rb:107: warning: Insecure world writable dir /Users/nporteschaikin/.rvm/gems/ruby-1.9.2-p320/bin in PATH, mode 040777\nPassword: \n** [IP-ADDRESS :: out] Enter passphrase for key '/root/.ssh/id_rsa':\n** [IP-ADDRESS :: out]\n** [IP-ADDRESS :: out] Enter passphrase for key '/root/.ssh/id_rsa':\n** [IP-ADDRESS :: out]\n** [out :: IP-ADDRESS] (in /var/www/vhosts/[domain.com]/httpdocs/releases/20121021210706)\n** [out :: IP-ADDRESS] rake aborted!\n** [out :: IP-ADDRESS] no such file to load -- rubygems\n** [out :: IP-ADDRESS] /var/www/vhosts/[domain.com]/httpdocs/releases/20121021210706/Rakefile:5:in `require'\n** [out :: IP-ADDRESS] (See full trace by running task with --trace)\n*** [deploy:update_code] rolling back\nfailed: \"sh -c 'cd /var/www/vhosts/[domain.com]/httpdocs/releases/20121021210706 &amp;&amp; rake RAILS_ENV=production RAILS_GROUPS=assets assets:precompile'\" on IP-ADDRESS\n</code></pre>\n\n<p>Please help!  I installed RVM, Ruby, Passenger, and Rails on the server.</p>\n"},{"tags":["ruby-on-rails-3","facebook-comments"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":21,"score":1,"question_id":13001911,"title":"How to save the facebook comment in database after posting it to facebook in rails application?","body":"<p>I want to save the facebook comment in my database of rails application after user posts it on facebook from my application.</p>\n\n<p>Say there is facebook comment box added to my site. \nNow when user enters facebook post and clicks on \"comment\" or \"post\" button provided by facebook. The comment is currently posted on facebook but i want it to post in facebook as well as  save it to my application's database.</p>\n\n<p>Thanks in advance for any help,</p>\n"},{"tags":["ruby-on-rails-3","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12999968,"title":"Rails 3.2.8 - instance variables disappearing after a render call","body":"<p>In users_controller, the code for create looks like this</p>\n\n<pre><code>@user = User.new(params[:user])\n...\n@client = the client this user belongs to\n@account = the account this user belongs to\nif @user.save\n ...\nelse\n render :new\nend\n</code></pre>\n\n<p>When the validation fails it starts rendering new.html.erb, but @client and @account did not survive the render call and are nil. Strangely enough @user survived just fine. What is going on here? Is this a side effect of cancan?</p>\n\n<p>Here the new.html.erb view. Variables @client and @account are used in the partial. Upon entering the new form, @client and @account are nil.</p>\n\n<pre><code>&lt;% puts \"***TRACE NEW.HTML.ERB @user:#{@user.inspect}\"%&gt;\n&lt;% puts \"***TRACE NEW.HTML.ERB @client:#{@client.inspect}\"%&gt;\n&lt;% puts \"***TRACE NEW.HTML.ERB @account:#{@account.inspect}\"%&gt;\n&lt;%= simple_form_for(@user, :url =&gt; {:action =&gt; 'create', :id =&gt; @user.id}, :html =&gt; {:class =&gt; 'form-horizontal'}) do |f| %&gt;\n  &lt;%= render(:partial =&gt; 'form', :locals =&gt; {:f =&gt; f, :legend =&gt; \"Add a New User\", :label =&gt; \"Create\", :ph =&gt; \"set this user's password\"}) %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You can view the full trace <a href=\"http://dl.dropbox.com/u/9264368/full_trace.txt\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","recursion"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":89,"score":0,"question_id":13000549,"title":"What is wrong with this recursive loop in Ruby?","body":"<p>Ok so i have this loop </p>\n\n<pre><code>def page_children(page)\n  content_tag :li do\n    link_to page.url, \"/#{page.url_path}/#{page.url}\"\n    if page.children.any?\n      content_tag :ul do\n        page_children(page)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>And I keep getting <code>stack level too deep</code></p>\n\n<p>I am using this <a href=\"https://github.com/mceachen/closure_tree\" rel=\"nofollow\">gem</a> for my tree structure and my model and haml is the following</p>\n\n<pre><code>class Page &lt; ActiveRecord::Base  \n  acts_as_tree :order =&gt; 'sort_order'\n  belongs_to :parent, :class_name =&gt; \"Page\" \n  scope :parent_nav, lambda{ |navigation| where(:parent_id =&gt; nil, :is_home =&gt; 0, :nav =&gt; navigation).order(\"sort_order\") }\nend\n</code></pre>\n\n<p>My haml is the following</p>\n\n<pre><code>%ul\n - Page.parent_nav(\"Attend\").each do |page|\n = page_children(page)\n</code></pre>\n\n<p>Basically i want a li for each page and if the page has children then i want another ul with an li for all the children...ext....but my loop is off somehow...any ideas on what im doing wrong</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":5,"favorite_count":8,"up_vote_count":8,"down_vote_count":1,"view_count":6041,"score":7,"question_id":4911607,"title":"Is it possible to set ENV variables for rails development environment in my code?","body":"<p>I know that I can set my ENV variables in bash via</p>\n\n<pre><code>export admin_password = \"secret\"\n</code></pre>\n\n<p>But is there a way to do it in my rails source code somewhere? My first attempt was something like this in <code>environment/development.rb</code></p>\n\n<pre><code>ENV['admin_password'] = \"secret\"\n</code></pre>\n\n<p>But it didn't work. Is there a way to do this?</p>\n"},{"tags":["jquery","ruby-on-rails-3","pagination","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12966591,"title":"Kaminari endless paging issue","body":"<p>I am trying to use Kaminari + jQuery to do endless pagination / infinite scrolling.  I am trying to append the paginated results (rows) within a table.  Unfortunately, the results (row markup) appear above the table.  Here's my existing setup:</p>\n\n<p>events_controller.rb</p>\n\n<pre><code>class EventsController &lt; ApplicationController\n  respond_to :html, :js\n\n  def index\n    @events = Event.all\n    respond_with(@events)\n  end\n\nend\n</code></pre>\n\n<p>events/index.html.erb</p>\n\n<pre><code>&lt;div id=\"events-container\"&gt;\n\n  &lt;table cellpadding=\"3\" cellspacing=\"0\"&gt;\n    &lt;thead&gt;\n      ...\n    &lt;/thead&gt;\n\n    &lt;tbody&gt;\n      &lt;% if @events.blank? %&gt;\n        &lt;tr&gt;&lt;td&gt; No events yet&lt;/td&gt;&lt;/tr&gt;\n      &lt;% else %&gt;\n        &lt;div id=\"events\"&gt;\n          &lt;%= render @events %&gt;\n        &lt;/div&gt;\n      &lt;% end %&gt;\n    &lt;/tbody&gt;\n  &lt;/table&gt;\n\n  &lt;nav class=\"pagination-container\"&gt;\n    &lt;%= paginate @events %&gt;\n  &lt;/nav&gt;​\n\n&lt;/div&gt;​\n</code></pre>\n\n<p>events/index.js.erb</p>\n\n<pre><code>$('#events').append('&lt;%= j render(@events) %&gt;');\n\n&lt;% if (@events.current_page &lt; @events.num_pages) %&gt;\n    $('.pagination').replaceWith('&lt;%= j paginate(@events) %&gt;');\n&lt;% else %&gt;\n    $('.pagination-container').remove();\n&lt;% end %&gt;\n</code></pre>\n\n<p>events/_event.html.erb</p>\n\n<pre><code>&lt;tr&gt;\n  &lt;td&gt;&lt;%= event.time %&gt;&lt;/td&gt;\n  ...\n&lt;/tr&gt;\n\n&lt;tr&gt;\n  &lt;td&gt;&lt;%= event.location %&gt;&lt;/td&gt;\n  ...\n&lt;/tr&gt;\n</code></pre>\n\n<p>events_endless_paging.js</p>\n\n<pre><code>jQuery(function() {\n  var isScrolledIntoView;\n  isScrolledIntoView = function(elem) {\n    var docViewBottom, docViewTop, elemBottom, elemTop;\n    docViewTop = $(window).scrollTop();\n    docViewBottom = docViewTop + $(window).height();\n    elemTop = $(elem).offset().top;\n    elemBottom = elemTop + $(elem).height();\n\n    return (elemTop &gt;= docViewTop) &amp;&amp; (elemTop &lt;= docViewBottom);\n  };\n\n  if ($('.pagination').length) {\n    $(window).scroll(function() {\n      var url;\n      url = $('.pagination .next a').attr('href');\n      if (url &amp;&amp; isScrolledIntoView('.pagination')) {\n        $('.pagination').text('Fetching more...');\n\n        var script = $.getScript(url);\n        return script;\n      }\n    });\n\n    return $(window).scroll();\n  }\n});\n</code></pre>\n\n<p>Everything seems to be wired properly, but what ends up happening is that table rows are inserted between #event-container div and the table.  So row styles are all wonky because the tags aren't being properly inserted within the context of a table.  I have the feeling that I need to insert table markup within the js response, but am not sure.</p>\n"},{"tags":["ajax","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":13000823,"title":"Ajax test not working","body":"<p>Am having real probs trying to use Ajax with my Rails app.  I have set up a test as follows:</p>\n\n<p>in javascript file:</p>\n\n<pre><code>window.onload = function() {\n    $('#test').bind('ajax:success', function() {\n        alert(\"success\");\n    };\n}\n</code></pre>\n\n<p>in view:</p>\n\n<pre><code>&lt;%= link_to \"test\", { :action =&gt; :getDiagram }, :remote =&gt; true, :id =&gt; \"test\" %&gt;\n</code></pre>\n\n<p>in controller:</p>\n\n<pre><code>def getDiagram\n\nend\n</code></pre>\n\n<p>Now I know this looks odd with the empty controller action, but I would expect this code to  just show a popup window with 'success' and leave the current page loaded when the link is clicked?  Instead i get the missing template message like its trying to load a page synchronously rather than using ajax?</p>\n\n<p>Can anyone get my test to work?  Do I need to upgrade or add a gem file?</p>\n\n<p>Thanks in advance</p>\n\n<p>Jason</p>\n"},{"tags":["ruby-on-rails-3","authentication","controller","routes"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12996951,"title":"Rails routes and authentication?","body":"<p>I am working on a simple Intranet application, although there are some users, there is no requirement for the general staff to login. They should be able to visit the Intranet from any computer and access what they need without logging in.</p>\n\n<p>A number of our users are remote and they should be able to interact in the same way.</p>\n\n<p>What I am trying to achieve is the following; a list of IPs &amp; subnets that go straight to the root URL without logging in (admins can still login). Any visitor not on the list of whitelisted IPs &amp; subnets should see the static access denied page. On that page should be a login link. Once logged in they can interact with the Intranet just as they can if they are in our whitelisted subnet. Once they log out they see the access denied page again.</p>\n\n<p>I have the following code in my application controller:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_filter :protect\n  protect_from_forgery\n  private  \n\n  def current_user\n    @current_user ||= User.find(session[:user_id]) if session[:user_id]\n    rescue ActiveRecord::RecordNotFound\n  end\n\n  helper_method :current_user\n\n  def authorized?\n    not current_user.nil?\n  end\n\n  def authorize\n    redirect_to login_url, alert: \"Not authorized\" unless authorized?\n  end\n\n  def authorize_admin\n    redirect_to login_url, alert: \"Not authorized\" unless authorized? &amp;&amp; current_user.admin?\n  end\n\n  def protect\n    @ips = ['127.0.0.1','123.123.123.12','192.168.5.0/24']\n    allowed = false\n      bremote_ip = 0\n      request.remote_ip.split('.').each { |x| bremote_ip = (bremote_ip &lt;&lt; 8) + x.to_i }\n      @ips.each do |ipstring|\n        ip, mask = ipstring.split '/'\n        mask = mask ? mask.to_i : 32\n        bip = 0\n        ip.split('.').each { |x| bip = (bip &lt;&lt; 8) + x.to_i }\n        bmask = ((1 &lt;&lt; mask) - 1) &lt;&lt; (32 - mask)\n        if bip &amp; bmask == bremote_ip &amp; bmask\n          allowed = true\n          break\n        end\n    end\n\n    if not allowed\n       render :template =&gt; \"static/protect\", :layout =&gt; \"static\"\n       return\n    end\n  end\n\nend\n</code></pre>\n\n<p>Any pointers on how to achieve this would be appreciated. Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":3,"up_vote_count":10,"down_vote_count":0,"view_count":6370,"score":10,"question_id":3901619,"title":"How to comment lines in rails html.erb files?","body":"<p>Am a newbie to rails ,\n please let me know the way to comment out a single line and also to comment out\n a block of lines  in *.html.erb files.</p>\n"},{"tags":["ruby-on-rails-3","heroku","delayed-job"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":143,"score":0,"question_id":9496501,"title":"Heroku: delayed job sending email multiple times","body":"<p>We have one application(Rails 3) deployed in Heroku.\nFor sending email digest to nearly about 500 users, we are using delayed_job.</p>\n\n<pre><code>Notifier.delay.send_email_digest(digest_content, @user)\n</code></pre>\n\n<p>My application has 3 web dynos and 2 worker dynos.\nThough the task is sending only one Email digest per user in local, \nIn heroku (production) it's sending two email digests for some users (strange).</p>\n\n<p>Is it due to two worker dynos (but why?? or mere coincidence).\nCan anybody help me solve the problem?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","authentication","activerecord","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12974028,"title":"Assign Devise/Authlogic user to nested form elements","body":"<p>I have a <code>Document</code> with several <code>Line</code>s. I'm using a nested_form to allow users to create some lines while creating the doc.</p>\n\n<p>Some other users may access the doc later and create some other lines inside (still using a nested edit form for the doc).</p>\n\n<p>At save time, I want to keep a trace from the author of each new line.</p>\n\n<p>I'm affraid that browsing all my doc's lines in the controller kind of defeats the whole purpose of Rails-handled nested_forms (especially if you can have variable levels of nesting), e.g., in <code>document_controller.rb</code> :</p>\n\n<pre><code>@document.lines.each { |l| l.author = current_user }\n@document.sections.each { |s| s.lines.each { |l| l.author = current_user } }\n</code></pre>\n\n<p>And I've read on <a href=\"http://stackoverflow.com/questions/4854019/how-to-access-devise-current-user-from-model\">some</a> <a href=\"http://stackoverflow.com/questions/4854019/how-to-access-devise-current-user-from-model\">other</a> <a href=\"http://stackoverflow.com/questions/4149326/rails-devise-get-object-of-the-currently-logged-in-user\">SO posts</a> (looks like a popular topic) that access to Devise/Authlogic user doesn't really belong in the model either. Otherwise I could have done this in <code>Line.rb</code> :</p>\n\n<pre><code>before_create { self.author = current_user if self.new_record? }\n</code></pre>\n\n<p>Is there any <em>clean</em> way to assign a user (or check a permission) for each nested elements of a nested form ? Either in model or in controller ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","bourbon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12999472,"title":"Box-shadow issue when use bourbon in rails 3.2 with twitter bootstrap","body":"<p>I have a file called <code>bootstrap_and_overides.css.scss</code> contains style for my app. Now i installed bourbon gem to use sass mixin. But when i used add-ons buttons, sites had error:  </p>\n\n<pre><code>Mixin box-shadow takes 1 argument but 2 were passed.  \n(in   /home/hkthanh89/rails_apps/online_test_app/app/assets/stylesheets/application.css.scss)\n</code></pre>\n\n<p>This is my <code>application.css.scss</code>:  </p>\n\n<pre><code>@import \"bourbon\";  \n@import \"bootstrap_and_overrides\";\n</code></pre>\n\n<p>I defined a link in my view file:  </p>\n\n<pre><code>&lt;p&gt;\n  &lt;%= link_to \"Add new course\", new_course_path, class: \"new_resource\" %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>My bootstrap style file don't have any box-shadow. I defined new_resource class in my bootstrap style:  </p>\n\n<pre><code>/* Buttons */  \n.new_resource {\n@include button(pill, #3FB344)\n}\n</code></pre>\n\n<p>I don't know why error with mixin box-shadow. Can anybody help? Thanks so much !</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","api","unit-testing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12999344,"title":"Grab Rails requests/responses to test API client","body":"<p>I have a Rails API and an iPhone app. I'd like to add tests to the iPhone app to verify the API client functionality. The tests will have to work offline, i.e. without the Rails API server. I was thinking about capturing requests and responses from Rails API to produce an offline mock API server. Ideally, I'd like to automate that process (e.g. starting up a Rails server and using cURL won't work).</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","web-services","widget"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":43,"score":1,"question_id":12998701,"title":"How to control who uses my web widget","body":"<p>I've created a web widget that displays user specific information from my site. This widget is java script based (I followed <a href=\"http://emphaticsolutions.com/2011/01/21/functional-widgets-with-rails-javascript-jsonp.html\" rel=\"nofollow\">this example</a>), and can be embedded in other sites.</p>\n\n<p>I'm looking for a way to control who can embed the widget in his site. Any ideas/references are welcome.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","railtie"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12998872,"title":"Heroku Push Error H10","body":"<p>I have been trying for the past couple of days to fix an error that keeps occuring once I have pushed my app to Heroku. </p>\n\n<p>The app works fine in development when booted up on Webrick but for some reason I keep receiving an <code>Application Error</code> page when trying to load my app on Heroku. </p>\n\n<p>I have the following log report - does anyone know how I can fix this?</p>\n\n<pre><code> 2012-10-21T14:17:52+00:00 app[web.1]: =&gt; Rails 3.2.0 application starting in production on http://0.0.0.0:23771\n 2012-10-21T14:17:52+00:00 app[web.1]: /app/app/uploaders/cv_uploader.rb:3:in `&lt;top (required)&gt;': uninitialized constant CarrierWave (NameError)\n 2012-10-21T14:17:52+00:00 app[web.1]: =&gt; Call with -d to detach\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/inflector/methods.rb:225:in `constantize'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/inflector/methods.rb:256:in `safe_constantize'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/core_ext/string/inflections.rb:66:in `safe_constantize'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/params_wrapper.rb:152:in `_default_wrap_model'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/params_wrapper.rb:169:in `_set_wrapper_defaults'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/abstract_controller/railties/routes_helpers.rb:7:in `block(2 levels) in with'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/metal/params_wrapper.rb:133:in `inherited'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:438:in `each'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.0/lib/action_controller/railties/paths.rb:7:in `block (2 levels)in with'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:439:in `block (2 levels) in eager_load!'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/app/controllers/apps_controller.rb:1:in `&lt;top (required)&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:438:in `block in eager_load!'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/application.rb:136:in `initialize!'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:54:in `each'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:54:in `run_initializers'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:436:in `each'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:436:in `eager_load!'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/application/finisher.rb:54:in `block in &lt;module:Finisher&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:30:in `instance_exec'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:30:in `run'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:55:in `block in run_initializers'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/config/environment.rb:5:in `&lt;top (required)&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/config.ru:4:in `block in &lt;main&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/config.ru:1:in `new'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/config.ru:1:in `&lt;main&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/commands/server.rb:46:in `app'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/commands/server.rb:70:in `start'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from script/rails:6:in `require'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from script/rails:6:in `&lt;main&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\n 2012-10-21T14:17:52+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.0/lib/rails/commands.rb:50:in `tap'\n 2012-10-21T14:17:53+00:00 heroku[web.1]: Process exited with status 1\n 2012-10-21T14:17:53+00:00 heroku[web.1]: State changed from starting to crashed\n 2012-10-21T14:17:54+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET secure-ocean-9819.herokuapp.com/ dyno= queue= wait= service= status=503 bytes=\n</code></pre>\n\n<p>Any help on this really would be much appreciated :)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12990047,"title":"multipage form with validation via sessions","body":"<p>Good day, I have an app which creates a user via a multipage form (no interactions with db  except the last step are allowed!)</p>\n\n<p>So on the first page user enters his email\nsecond his address\nthird company info (or whatsoever)\nfourth page - it's all the info is displayed &amp; user is saved into db.</p>\n\n<p>my solution was as follows:\nstep one: new action of users_controller. it's view</p>\n\n<pre><code>- if notice\n  p[class='notice'] = notice\np Enter your personal data\n= form_tag step2_path do \n  p\n    = label_tag 'Email'\n    = text_field_tag 'user[email]'\n  p  \n    = submit_tag 'Continue'\n</code></pre>\n\n<p>users#create</p>\n\n<pre><code>def create\n    session[:user] = {}\n    redirect_to step2_path\n  end\n</code></pre>\n\n<p>step2,3,4 are the same action. \nroutes.rb</p>\n\n<pre><code>  match 'step2' =&gt; 'user_signup#steps'\n  match 'step3' =&gt; 'user_signup#steps'\n  match 'step4' =&gt; 'user_signup#steps'\n\nclass UserSignupController &lt; ApplicationController\n\n  def steps\n    @check = true\n    path = request.env['PATH_INFO'][1..-1]\n    update\n    if path == 'step4' \n      @user = User.create(session[:user])\n    end\n    render \"user_signup/#{path}\"\n  end\ndef update\n    session[:user] = if session[:user].present?\n      session[:user].merge(params[:user]) { |key, old, new| new } \n    else\n      params[:user]\n    end\n  end\n</code></pre>\n\n<p>and on each step (2,3,4) params[:user][xxx] is created...\nwill there be any hints?</p>\n\n<p><strong>UPDATE</strong>\nI've decided to apply <a href=\"http://bassistance.de/jquery-plugins/jquery-plugin-validation/\" rel=\"nofollow\">http://bassistance.de/jquery-plugins/jquery-plugin-validation/</a>\nAnd after that to use Presenter pattern <a href=\"http://blog.jayfields.com/2007/03/rails-presenter-pattern.html\" rel=\"nofollow\">http://blog.jayfields.com/2007/03/rails-presenter-pattern.html</a> </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":905,"score":2,"question_id":6022902,"title":"How to remove Set-Cookie header from response in rails 3?","body":"<p>I have some actions that respond with static content. I also need them cached on client.</p>\n\n<p>Similar question was asked in the past for rails 2</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4129436/is-it-possible-to-omit-set-cookie-header-from-the-response-in-rails-2-3\">Is it possible to omit set-cookie header from the response in Rails 2.3?</a></p>\n"},{"tags":["ruby","windows","ruby-on-rails-3","imagemagick","rmagick"],"answer_count":2,"favorite_count":3,"up_vote_count":0,"down_vote_count":0,"view_count":3422,"score":0,"question_id":4873276,"title":"I can't install rmagick gem on windows","body":"<p>I used ruby 1.9.2 and rails 3.0.3. iam trying to install rmagick gem but when i run <code>bundle install</code> I got an error tells me: </p>\n\n<pre><code>Installing rmagick (2.12.1) with native extensions c:/Ruby192/lib/ruby/site_ruby\n/1.9.1/rubygems/installer.rb:529:in `rescue in block in build_extensions': ERROR\n: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)\n\n       c:/Ruby192/bin/ruby.exe extconf.rb\nchecking for Ruby version &gt;= 1.8.5... yes\nchecking for stdint.h... *** extconf.rb failed ***\nCould not create Makefile due to some reason, probably lack of\nnecessary libraries and/or headers.  Check the mkmf.log file for more\ndetails.  You may need configuration options.\n\nProvided configuration options:\n       --with-opt-dir\n       --without-opt-dir\n       --with-opt-include\n       --without-opt-include=${opt-dir}/include\n       --with-opt-lib\n       --without-opt-lib=${opt-dir}/lib\n       --with-make-prog\n       --without-make-prog\n       --srcdir=.\n       --curdir\n       --ruby=c:/Ruby192/bin/ruby\nc:/Ruby192/lib/ruby/1.9.1/mkmf.rb:368:in `try_do': The complier failed to genera\nte an executable file. (RuntimeError)\nYou have to install development tools first.\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:452:in `try_cpp'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:834:in `block in have_header'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:693:in `block in checking_for'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:280:in `block (2 levels) in postp\none'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:280:in `block in postpone'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:254:in `open'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:276:in `postpone'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:692:in `checking_for'\n       from c:/Ruby192/lib/ruby/1.9.1/mkmf.rb:833:in `have_header'\n       from extconf.rb:171:in `&lt;main&gt;'\n\n\nGem files will remain installed in c:/Ruby192/lib/ruby/gems/1.9.1/gems/rmagick-2\n.12.1 for inspection.\nResults logged to c:/Ruby192/lib/ruby/gems/1.9.1/gems/rmagick-2.12.1/ext/RMagick\n/gem_make.out\n       from c:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:507:in `b\nlock in build_extensions'\n       from c:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:482:in `e\nach'\n       from c:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:482:in `b\nuild_extensions'\n       from c:/Ruby192/lib/ruby/site_ruby/1.9.1/rubygems/installer.rb:156:in `i\nnstall'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/sour\nce.rb:96:in `install'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/inst\naller.rb:55:in `block in run'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/spec\n_set.rb:12:in `block in each'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/spec\n_set.rb:12:in `each'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/spec\n_set.rb:12:in `each'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/inst\naller.rb:44:in `run'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/inst\naller.rb:8:in `install'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/cli.\nrb:226:in `install'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/vend\nor/thor/task.rb:22:in `run'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/vend\nor/thor/invocation.rb:118:in `invoke_task'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/vend\nor/thor.rb:246:in `dispatch'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/lib/bundler/vend\nor/thor/base.rb:389:in `start'\n       from c:/Ruby192/lib/ruby/gems/1.9.1/gems/bundler-1.0.10/bin/bundle:13:in\n`&lt;top (required)&gt;'\n       from c:/Ruby192/bin/bundle:19:in `load'\n       from c:/Ruby192/bin/bundle:19:in `&lt;main&gt;'\n</code></pre>\n\n<p>I installed ruby from <a href=\"http://rubyinstaller.org/downloads/\" rel=\"nofollow\">http://rubyinstaller.org/downloads/</a> with development kit and the latest version of ImageMagick. I tried to set rmagick configurations (lib and include directories) but I still get the same error</p>\n\n<p>any help? any thoughts to solve the issue?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","localization","tooltip"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12859752,"title":"Rails Twitter Bootstrap Tooltip localization","body":"<p>I am using Twitter-Bootstrap Tooltips and I want to know if there is a way or best practice of localize them? e.g.: in config/locales</p>\n\n<p>My setup is:</p>\n\n<p>Gemfile</p>\n\n<pre><code>gem 'twitter-bootstrap-rails', '~&gt; 2.1.3'\n</code></pre>\n\n<p>bootstrap.js.coffee</p>\n\n<pre><code>jQuery -&gt;\n  $('#plugin_description').tooltip({'trigger':'hover', 'title': 'ToolTip Text'})\n</code></pre>\n\n<p>Tooltips work fine, but is there a way to load the strings from config/locales? \nThat would really be awesome :)</p>\n\n<p>Update:\nI want to use the tooltip with input fields in a form. Right now I have it like this:</p>\n\n<pre><code>= f.input :name\n</code></pre>\n\n<p>and call it with:</p>\n\n<pre><code>$('#application_name').tooltip({\n    'placement':'top',\n    'trigger':'hover', \n    'title': 'has to be unique and between 4 an 20 signs'})\n</code></pre>\n\n<p>but I couldn't find a way to localize the title attribute.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","postgresql","postgis"],"answer_count":2,"favorite_count":4,"up_vote_count":7,"down_vote_count":0,"view_count":1944,"score":7,"question_id":5298797,"title":"Rails with PostGIS","body":"<p>First of all, I'm using Rails3 with Ruby 1.9.2.</p>\n\n<p>I have a problem using PostgreSQL with PostGIS. I've tried two gems:</p>\n\n<ul>\n<li><a href=\"https://github.com/nofxx/georuby\">https://github.com/nofxx/georuby</a></li>\n<li><a href=\"https://github.com/dazuma/activerecord-postgis-adapter\">https://github.com/dazuma/activerecord-postgis-adapter</a></li>\n</ul>\n\n<p>The problem is, that the first one from nofxx works well, but it doesn't provide rake tasks, so that the postgis.sql and spatial_ref_sys.sql get inserted into the database. I need this, because it's comfortable and essential using tests (create automatically the database, insert the postgis sql and perform the migrations when running \"rake test\"). The strange thing is, that in the README on github the author writes something about PostGIS helpers and rake tasks. But they are not implemented (or I'm blind).</p>\n\n<p>The second gem listed above provides this functionality for rake perfectly! But I ran into an issue that I can't solve. I followed the instructions in the README, but everytime when I try to set a position on a spatial column, i get the following output:</p>\n\n<pre><code>ruby-1.9.2-p136 :010 &gt; v = Venue.new :location =&gt; \"POINT(102.0, 47.2)\"\n=&gt; #&lt;Venue id: nil, last_updated: nil, created_at: nil, updated_at: nil, location: nil&gt;\nruby-1.9.2-p136 :011 &gt; v.location\n=&gt; nil \n</code></pre>\n\n<p>As you can see, I set a location using WKT (well known text), but it's always nil. I also tried to save it to the database, but it's also nil.\nI figured out, that when I try to use the Objects provided by RGeo</p>\n\n<pre><code>RGeo::Geos.factory.point(-122, 47)\n</code></pre>\n\n<p>it says, that the factory is nil. So, there must be a problem by creating the factory provided by RGeo. As mentioned in the README of the activerecord-postgis-adapter I used the following line in my Venue model to provide this support:</p>\n\n<pre><code>self.rgeo_factory_generator = RGeo::Geos.factory_generator\n</code></pre>\n\n<p>but it doesn't work.</p>\n\n<p>So to find a solution, there are two ways: Finding a way to get the rake tasks into the georuby gem of nofxx, or solve the problem with the factory of the activerecord-postgis-adapter.</p>\n\n<p>Hope someone can help me,\nthx!</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12994623,"title":"pending migrations vs heroku rake db:seed","body":"<p>I'm trying to deploy to heroku and I'm having an issue:\nwhen i run heroku rake db:seed (which creates the admin user in my db), rails returns that I have pending migrations.\nI've deleted these migrations manually (which I shouldn't have, I know), how can I go around this ?</p>\n\n<pre><code>Charlie@CHARLIE-PC /c/rails/rails_projects/METACRITIC (master)\n$ rake db:migrate\n\nCharlie@CHARLIE-PC /c/rails/rails_projects/METACRITIC (master)\n$ heroku run rake db:seed\nRunning `rake db:seed` attached to terminal... up, run.1\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support\n for these plugins will be removed in Rails 4.0. Move them out and bundle them i\nn your Gemfile, or fold them in to your app as lib/myplugin/* and config/initial\nizers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonr\nails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required\n)&gt; at /app/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support\n for these plugins will be removed in Rails 4.0. Move them out and bundle them i\nn your Gemfile, or fold them in to your app as lib/myplugin/* and config/initial\nizers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonr\nails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required\n)&gt; at /app/Rakefile:7)\nDEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support\n for these plugins will be removed in Rails 4.0. Move them out and bundle them i\nn your Gemfile, or fold them in to your app as lib/myplugin/* and config/initial\nizers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonr\nails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from &lt;top (required\n)&gt; at /app/Rakefile:7)\nYou have 2 pending migrations:\n  20121013054027 Addcolumnimagetoshow\n  20121013063205 AddAttachmentToShows\nRun `rake db:migrate` to update your database then try again.\n\nCharlie@CHARLIE-PC /c/rails/rails_projects/METACRITIC (master)\n$\n</code></pre>\n"},{"tags":["ruby-on-rails-3","associations","has-many","belongs-to"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12996802,"title":"Rails Association (belongs_to) dilema","body":"<p>I have a User model:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\n  has_many :cards\n\nend\n</code></pre>\n\n<p>and a Card model:</p>\n\n<pre><code>   class Card&lt; ActiveRecord::Base\n\n      belongs_to :user, :foreign_key =&gt; \"owner_id\"\n\n   end\n</code></pre>\n\n<p>the card model also has an attribute called \"owner_id\", which I'd like to use in way like this:\nCard.first.owner which will retrieve the User which owns that card</p>\n\n<p>my problem as that, I know that rails will automagically connect the id's in the association but that doesnt happen.</p>\n\n<p>in the CardController, rails get stuck in the create action on the line</p>\n\n<pre><code>@card=current_user.cards.new(params[:card])\n</code></pre>\n\n<p>and says <code>unknown attribute: user_id</code></p>\n\n<p>I've done <code>db:migrate</code> and it still won't work.</p>\n\n<p>must I do as follows for it to work?</p>\n\n<pre><code>@card = Card.new(params[:card])\n@card.owner_id=current_user.id\n</code></pre>\n\n<p>or am I missing something?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","tagging","acts-as-taggable-on"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12992236,"title":"association or tagging for conception in rails 3","body":"<p>I'm facing a conception problem in developping a website for my videogame.<br>\nI have a Model named VideoLink which contain a title, a description and a link to a webvideo (for example youtube).<br>\nI have other models such as User, Map, Mission etc.<br>\nI want my users to be able to say that a video was made on those maps, during this mission, and those users appears.</p>\n\n<p>I'm wondering if I should go with associations (with has_many relationships) or tagging (with acts_as_taggable_on and 3 attributes maps_list, users_list, mission).<br>\nI find associations a little heavy for this as it is a tagging thing not really a relation.<br>\nBut maybe I'm wrong and tagging could not be the best choice.</p>\n\n<p>Which solution you think is the most relevant to my situation ?<br>\nIf you have other solutions or questions please tell me, I'm in fact a noob at ror ^^</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3","json"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12539492,"title":"Redirecting to another page via a json call","body":"<p>I'm using the <a href=\"https://github.com/blueimp/jQuery-File-Upload/wiki\" rel=\"nofollow\">jquery file upload</a> utility in my app.  If I have some code like the following normally in rails...</p>\n\n<pre><code>if @course_module.save\n  flash[:success] = \"Class created!\"\n  redirect_to course_course_modules_path(@course)\nelse\n  render 'new'\nend\n</code></pre>\n\n<p>It will display error messages if there are errors in my form, or redirect to another page if it saved successfully.  But this is not so when the page is submitted through the jquery\nplugin.  The reason is it requires a json object to be returned....something like</p>\n\n<pre><code>         format.json {  \n          render ':json =&gt; [@course_module.to_jq_upload].to_json ' \n        }\n</code></pre>\n\n<p>How would I instead of returning json, do the first code snippet instead?  Either by redirecting if the save is successful, or display error messages if it is not?  I've tried something like the following...</p>\n\n<pre><code>render 'new'\n</code></pre>\n\n<p>But that didn't work.</p>\n"},{"tags":["ruby-on-rails-3","rvm","unicorn"],"answer_count":4,"favorite_count":4,"up_vote_count":6,"down_vote_count":0,"view_count":2088,"score":6,"question_id":6254782,"title":"RVM & Unicorn deploy","body":"<p>My RVM is installed as root.\nWhen I'm trying to start unicorn socket, it prints</p>\n\n<pre><code>user@9001-3:~$ /etc/init.d/unicorn start\nStarting myapp app: /usr/bin/env: ruby: No such file or directory\nunicorn.\n</code></pre>\n\n<p>But if I type</p>\n\n<pre><code>user@9001-3:~$ ruby -v\nruby 1.9.2p180 (2011-02-18 revision 30909) [x86_64-linux]\n</code></pre>\n\n<p><code>/usr/local/rvm/gems/ruby-1.9.2-p180/bin/unicorn</code> path exists.</p>\n\n<p>My unicorn config: <a href=\"https://gist.github.com/1010519\">https://gist.github.com/1010519</a></p>\n"},{"tags":["ruby-on-rails-3","haml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":11862709,"title":"How to remove whitespace from this code in haml?","body":"<p>This is the code</p>\n\n<pre><code>  .meta\n    = time_ago_in_words(discussion.created_at)\n    ago by\n    = discussion.user.username\n    |\n    = link_to \"Edit\", edit_discussion_path(discussion), class: \"meta\"\n    |\n    = link_to \"Delete\", discussion_path(discussion), method: :delete, confirm: \"Are you sure?\", class: \"meta\"\n</code></pre>\n\n<p>And this is the output:</p>\n\n<pre><code>    &lt;div class='meta'&gt;\n      about 7 hours\n      ago by\n      foo\n      |\n      &lt;a href=\"/discussions/2/edit\" class=\"meta\"&gt;Edit&lt;/a&gt;\n      |\n      &lt;a href=\"/discussions/2\" class=\"meta\" data-confirm=\"Are you sure?\" data-method=\"delete\" rel=\"nofollow\"&gt;Delete&lt;/a&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>This makes the output have unbalanced space on either sides of the <code>|</code>.</p>\n\n<p>Is it possible to remove the whitespace between these statements, without adding a <code>span</code> to everything, or just using <code>erb</code> or <code>string interpolation</code>?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","initialization"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":364,"score":0,"question_id":8420932,"title":"Where to Put Global Constant in Rails 3","body":"<p>I want to define Global Constant in Rails 3 but I am confuse looking so many differnet answer on Google.</p>\n\n<p>I was trying <a href=\"http://stackoverflow.com/questions/3856737/where-how-to-code-constants-in-rails-3-application/5814314#5814314\">this solution</a> but it did not work and gave error:</p>\n\n<pre><code>Undefined method `music_type' for #&lt;Rails::Application::Configuration:0xb7ac0230&gt;\n</code></pre>\n\n<p>In /config/application.rb</p>\n\n<pre><code>module RailsRoot\n Class Application &lt; Rails :: Application\n config.music_type = '2'\n end\nend\n</code></pre>\n\n<p>In Controller</p>\n\n<pre><code>RailsRoot::Application::config.music_type\n</code></pre>\n\n<p>not sure what I am doing wrong.</p>\n\n<p>Thanks</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","payment-gateway","stripe-payments"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12988530,"title":"How can i email invoice of payment to customer from stripe gem in rails?","body":"<p>I have implemented <code>stripe gem</code> into my application. I want to send, Invoice and payment receipt to the customer through email. </p>\n\n<p>How can i do that?</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","payment-gateway","stripe-payments"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12974241,"title":"How to capture web hooks from stripe gem in rails 3?","body":"<p>How to capture <code>Web Hooks</code> from stripe when <code>customer card processes</code> ?</p>\n\n<p>Please help</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","paperclip"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":286,"score":0,"question_id":8514100,"title":"Paperclip with rails 3.1 error with routes","body":"<p>So I've followed the instructions here: <a href=\"http://doganberktas.com/2010/09/14/amazon-s3-and-paperclip-rails-3/\" rel=\"nofollow\">http://doganberktas.com/2010/09/14/amazon-s3-and-paperclip-rails-3/</a></p>\n\n<p>In my profile model I have:</p>\n\n<pre><code>  attr_accessor  :pic_file_name (this was requested on first attempt)\n  has_attached_file :pic,\n       :styles =&gt; {\n       :thumb=&gt; \"100x100#\",\n       :small  =&gt; \"400x400&gt;\" },\n     :storage =&gt; :s3,\n     :s3_credentials =&gt; \"#{Rails.root}/config/s3.yml\",\n     :path =&gt; \"/:style/:id/:filename\"\n</code></pre>\n\n<p>I have resources :profiles in my routes.</p>\n\n<p>my view has the following:</p>\n\n<pre><code>&lt;%= form_for :profile, @profile, :url =&gt; profile_path, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n&lt;%= f.file_field :pic %&gt;\n&lt;%= f.submit :class =&gt; \"button-style\", :value =&gt; \"Upload File\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>When I view the page, I get this error: No route matches {:action=>\"show\", :controller=>\"profiles\"}. Although I can assure you, I have a profiles controller with a show action.</p>\n\n<p>If I change the view to </p>\n\n<pre><code>&lt;%= form_for :profile, @profile, :url =&gt; @profile, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n&lt;%= f.file_field :pic %&gt;\n&lt;%= f.submit :class =&gt; \"button-style\", :value =&gt; \"Upload File\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It tells me I have the wrong number of arguments (3 for 2)</p>\n\n<p>Then if I change the view to</p>\n\n<pre><code>&lt;%= form_for @profile, :url =&gt; profile_path, :html =&gt; { :multipart =&gt; true } do |f| %&gt;\n&lt;%= f.file_field :pic %&gt;\n&lt;%= f.submit :class =&gt; \"button-style\", :value =&gt; \"Upload File\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The page loads, and I can upload an image. However trying to print it later using:</p>\n\n<p>&lt;%= current_user.profile.pic %> gives me: /pics/original/missing.png (as does profile.pic.url)</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12995476,"title":"Resizing thumbnails in Rails","body":"<p>Does anyone know what I can use to resize all images to the same width (and proportional height) within Rails?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12995230,"title":"How to get rid of necessarily reloading in RSpec?","body":"<p>I encountered a strange behavior when I run specs.</p>\n\n<p>This code doesn't work (<code>baz.viewed</code> is not updated) unless I uncomment line <code>baz.reload</code>.</p>\n\n<pre><code>describe \"#...\" do\n  it \"...\" do\n    baz = user.notifications.create!(title: \"baz\")\n    baz.update_attribute(:created_at, Time.now + 3.day)\n\n    # it sets `viewed` to `true` in the model to which `baz` is referred.\n    user.dismiss_latest_notification!\n\n    # baz.reload\n    baz.viewed.should == true\n  end\nend\n</code></pre>\n\n<p>I don't run specs using <code>Spork</code> or <code>Guard</code>, but this model isn't reloaded anyway.</p>\n\n<p>Why it might happening? Or, is it normal practice to invoke <code>.reload</code> methods in specs? </p>\n"},{"tags":["ruby-on-rails-3","raspberry-pi","bcrypt-ruby"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12995404,"title":"installing bcrypt-ruby (rails 3.2.8 using devise) on a raspberry pi","body":"<p>I'm having fun trying to get my raspberry pi setup as a staging server.  It's a rails app 3.2.8 using devise for authentication.</p>\n\n<p>When it's bundling the install is failing with </p>\n\n<pre><code>Installing bcrypt-ruby (3.0.1) with native extensions \nGem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension\n</code></pre>\n\n<p>If I \"sudo gem install  bcrypt-ruby -v '3.0.1' \" then it installs fine, but the capistrano deploy is always failing.</p>\n\n<p>Any ideas?  I'd rather not deploy as sudo as that's not how it works in production.</p>\n"},{"tags":["ruby-on-rails-3","sencha-touch-2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12995128,"title":"Sencha touch with rails backend","body":"<p>I have a rails app and now I'd like to provide a mobile UI so now I'm evaluating Sencha Touch. \nMy goal is to create Sencha Touch views and serve them through the rails not roller through js format. However I have hard ime to make it work or find any sample. So, I'm wondering if it is even possible to achieve so. </p>\n\n<p>Anyone knows how o achieve so?</p>\n\n<p>Thanks and have a good one. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":124,"score":0,"question_id":12994485,"title":"Rails 3.2.8 form_for submit button is using the 'new' action instead of 'create' action","body":"<p>After filling in my form with values. Clicking on f.submit just refreshes my view (new.html.erb). I am attempting to save the form to my db and redirect to my index view.</p>\n\n<p>I have tried the following:</p>\n\n<ol>\n<li>Removed conditional statement from posts_controller create action.</li>\n<li>Changed my nested resources into a singular resource (of posts).</li>\n<li>Passed routing options via the url hash in my form.</li>\n</ol>\n\n<p>I have also followed the pertinent advice in these SO questions with no success.</p>\n\n<ol>\n<li><p><a href=\"http://stackoverflow.com/questions/12429097/rails-create-action-not-working?rq=1\">Rails Create Action Not Working</a>http://stackoverflow.com/editing-help</p></li>\n<li><p><a href=\"http://stackoverflow.com/questions/10956346/rails-form-for-never-invokes-the-create-controller-action-to-use-redirect-to\">rails form_for never invokes the create controller action to use redirect_to</a></p></li>\n<li><p><a href=\"http://stackoverflow.com/questions/10180862/rails-form-posting-to-new-instead-of-create\">Rails form posting to /new instead of /create?</a></p></li>\n</ol>\n\n<p>Here is my code: </p>\n\n<pre><code>-- views/posts/index.html.erb\n&lt;h5&gt;Posts#index&lt;/h5&gt;\n&lt;small&gt;&lt;i&gt;Find me in app/views/posts/index.html.erb&lt;/i&gt;&lt;/small&gt;\n&lt;hr /&gt;\n\n&lt;div class=\"hero hero-unit\"&gt;\n    &lt;button&gt;&lt;%= link_to \"Create a post\", new_post_path %&gt;&lt;/button&gt;\n    &lt;hr /&gt;\n\n    &lt;ul class=\"unstyled\"&gt;\n        &lt;% @posts.each do |post| %&gt;\n\n        &lt;h5&gt;&lt;small&gt;post ID: &lt;/small&gt;&lt;%= post.id %&gt;&lt;/h5&gt;\n        &lt;li&gt;&lt;%= post.URL %&gt;&lt;/li&gt;\n        &lt;li&gt;\n            &lt;%= link_to post.description, post %&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n            &lt;ul class=\"unstyled\"&gt;\n                &lt;li&gt;&lt;small&gt;&lt;i&gt;submitted &lt;%= time_ago_in_words(post.created_at) %&gt; ago.&lt;/i&gt;&lt;/small&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n            &lt;%= pluralize(post.comments.count, 'comment') %&gt;\n        &lt;/li&gt;\n        &lt;!-- votes moved to votes/index.html.erb --&gt;\n        &lt;li&gt;\n            &lt;button class=\"btn btn-mini btn-success\"&gt;\n                &lt;%= link_to '', post_votes_path(post, vote: \"true\"), method: :post, remote: true, class: 'icon-arrow-up' %&gt;\n            &lt;/button&gt;\n\n            &lt;button class=\"btn btn-mini btn-danger\"&gt;\n                &lt;%= link_to '', post_votes_path(post, vote: \"false\"), method: :post, remote: true, class: 'icon-arrow-down' %&gt;\n            &lt;/button&gt;\n            &lt;p&gt;&lt;%= post.vote_total.to_s + \" votes\" %&gt;&lt;/p&gt;\n            &lt;!-- \n                &lt;span id=\"post_&lt;%= post.id %&gt;_votes\"&gt;&lt;%= post.vote_total.to_s + \" votes\" %&gt;&lt;/span&gt;\n            --&gt;\n        &lt;/li&gt;\n        &lt;% end %&gt;\n        &lt;hr /&gt;\n    &lt;/ul&gt;\n&lt;/div&gt;&lt;!-- END hero, hero-unit CLASS --&gt;\n\n\n\n-- views/posts/new.html.erb\n\n    &lt;h5&gt;Posts#new&lt;/h5&gt;\n&lt;small&gt;&lt;i&gt;Find me in app/views/posts/new.html.erb&lt;/i&gt;&lt;/small&gt;\n&lt;hr /&gt;\n\n&lt;div class=\"hero hero-unit\"&gt;\n    &lt;form class=\"form-horizontal\"&gt;\n        &lt;%= form_for @post do |f| %&gt;\n        &lt;div class=\"control-group\"&gt;\n            &lt;label class=\"control-label\"&gt;\n                &lt;%= f.label \"Select post type\" %&gt; \n            &lt;/label&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;%= f.select :is_link, options_for_select([[\"Link\", true], [\"Text\", false]]) %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"control-group\"&gt;\n            &lt;label class=\"control-label\" for=\"URL\"&gt;&lt;%= f.label :URL %&gt;&lt;/label&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;%= f.text_field :URL %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"control-group\"&gt;\n            &lt;label class=\"control-label\" for=\"description\"&gt;&lt;%= f.label :description %&gt;&lt;/label&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;%= f.text_area :description, rows: 5 %&gt;\n            &lt;/div&gt;&lt;br /&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;%= f.submit 'save post' %&gt;\n                &lt;% end %&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/form&gt; \n&lt;/div&gt;&lt;!-- end hero, hero-unit CLASS --&gt;\n\n\n\n-- posts_controller.rb\n\nclass PostsController &lt; ApplicationController\n  def index\n    @posts = Post.find(:all)\n  end\n\n  def new\n    @post = Post.new\n  end\n\n  def create\n    @post = Post.new(params[:post])\n\n    redirect_to root_path\n  end\n\n  def show\n    # Post \n    @post = Post.find(params[:id])\n\n    # Comments assiciated by :post_id \n    @comments = @post.comments.all\n    @comment = @post.comments.build(params[:comment])\n    @comment.save\n  end\n\n  def edit\n    @post = Post.find(params[:id])\n  end\nend\n\n\n\n\n-- config/routes.rb\n\n  root to: 'posts#index'\n\n  resources :posts do\n    resources :comments\n    resources :votes\n  end\n.\n.\n.\n#match ':controller(/:action(/:id))(.:format)'\n\n--Terminal rake routes\n\n             root        /                                           posts#index\n    post_comments GET    /posts/:post_id/comments(.:format)          comments#index\n                  POST   /posts/:post_id/comments(.:format)          comments#create\n new_post_comment GET    /posts/:post_id/comments/new(.:format)      comments#new\nedit_post_comment GET    /posts/:post_id/comments/:id/edit(.:format) comments#edit\n     post_comment GET    /posts/:post_id/comments/:id(.:format)      comments#show\n                  PUT    /posts/:post_id/comments/:id(.:format)      comments#update\n                  DELETE /posts/:post_id/comments/:id(.:format)      comments#destroy\n       post_votes GET    /posts/:post_id/votes(.:format)             votes#index\n                  POST   /posts/:post_id/votes(.:format)             votes#create\n    new_post_vote GET    /posts/:post_id/votes/new(.:format)         votes#new\n   edit_post_vote GET    /posts/:post_id/votes/:id/edit(.:format)    votes#edit\n        post_vote GET    /posts/:post_id/votes/:id(.:format)         votes#show\n                  PUT    /posts/:post_id/votes/:id(.:format)         votes#update\n                  DELETE /posts/:post_id/votes/:id(.:format)         votes#destroy\n            posts GET    /posts(.:format)                            posts#index\n                  POST   /posts(.:format)                            posts#create\n         new_post GET    /posts/new(.:format)                        posts#new\n        edit_post GET    /posts/:id/edit(.:format)                   posts#edit\n             post GET    /posts/:id(.:format)                        posts#show\n                  PUT    /posts/:id(.:format)                        posts#update\n                  DELETE /posts/:id(.:format)                        posts#destroy\n\n\n--WEBrick \n\nStarted GET \"/posts/new?utf8=%E2%9C%93&amp;authenticity_token=Z8LuvU7i5ytFi1OxiIGpgwYOy%2BWE%2BfiAZv7m7T%2BwYRI%3D&amp;post%5Bis_link%5D=true&amp;post%5BURL%5D=http%3A%2F%2Ffirsttimers.co&amp;post%5Bdescription%5D=My+first+time.&amp;commit=save+post\" for 127.0.0.1 at 2012-10-20 22:37:52 -0400\nProcessing by PostsController#new as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"Z8LuvU7i5ytFi1OxiIGpgwYOy+WE+fiAZv7m7T+wYRI=\", \"post\"=&gt;{\"is_link\"=&gt;\"true\", \"URL\"=&gt;\"http://firsttimers.co\", \"description\"=&gt;\"My first time.\"}, \"commit\"=&gt;\"save post\"}\n  Rendered posts/new.html.erb within layouts/application (2.0ms)\nCompleted 200 OK in 12ms (Views: 11.8ms | ActiveRecord: 0.0ms)\n</code></pre>\n\n<p>Any help towards a solution and/or explanation as to what I am overlooking and whats going on (I hope it's not a typo... lol) will be greatly appreciated.</p>\n\n<pre><code>-- EDIT. HTML Generated code for posts/new.html.erb\n\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;PostEmHigh&lt;/title&gt;\n  &lt;link href=\"/assets/application.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/custom.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/posts.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n&lt;link href=\"/assets/scaffolds.css?body=1\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n  &lt;script src=\"/assets/jquery.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/posts.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"/assets/application.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n  &lt;script src=\"/assets/jquery_ujs.js?body=1\" type=\"text/javascript\"&gt;&lt;/script&gt;\n  &lt;meta content=\"authenticity_token\" name=\"csrf-param\" /&gt;\n&lt;meta content=\"Z8LuvU7i5ytFi1OxiIGpgwYOy+WE+fiAZv7m7T+wYRI=\" name=\"csrf-token\" /&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n    &lt;h5&gt;Posts#new&lt;/h5&gt;\n&lt;small&gt;&lt;i&gt;Find me in app/views/posts/new.html.erb&lt;/i&gt;&lt;/small&gt;\n&lt;hr /&gt;\n\n&lt;div class=\"hero hero-unit\"&gt;\n    &lt;form class=\"form-horizontal\"&gt;\n        &lt;form accept-charset=\"UTF-8\" action=\"/posts\" class=\"new_post\" id=\"new_post\" method=\"post\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input name=\"utf8\" type=\"hidden\" value=\"&amp;#x2713;\" /&gt;&lt;input name=\"authenticity_token\" type=\"hidden\" value=\"Z8LuvU7i5ytFi1OxiIGpgwYOy+WE+fiAZv7m7T+wYRI=\" /&gt;&lt;/div&gt;\n        &lt;div class=\"control-group\"&gt;\n            &lt;label class=\"control-label\"&gt;\n                &lt;label for=\"post_Select post type\"&gt;Select post type&lt;/label&gt; \n            &lt;/label&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;select id=\"post_is_link\" name=\"post[is_link]\"&gt;&lt;option value=\"true\"&gt;Link&lt;/option&gt;\n&lt;option value=\"false\"&gt;Text&lt;/option&gt;&lt;/select&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"control-group\"&gt;\n            &lt;label class=\"control-label\" for=\"URL\"&gt;&lt;label for=\"post_URL\"&gt;Url&lt;/label&gt;&lt;/label&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;input id=\"post_URL\" name=\"post[URL]\" size=\"30\" type=\"text\" /&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n        &lt;div class=\"control-group\"&gt;\n            &lt;label class=\"control-label\" for=\"description\"&gt;&lt;label for=\"post_description\"&gt;Description&lt;/label&gt;&lt;/label&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;textarea cols=\"40\" id=\"post_description\" name=\"post[description]\" rows=\"5\"&gt;\n&lt;/textarea&gt;\n            &lt;/div&gt;&lt;br /&gt;\n            &lt;div class=\"controls\"&gt;\n                &lt;input name=\"commit\" type=\"submit\" value=\"save post\" /&gt;\n&lt;/form&gt;         &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/form&gt; \n&lt;/div&gt;&lt;!-- end hero, hero-unit CLASS --&gt;\n\n    &lt;pre class='debug_dump'&gt;--- !ruby/hash:ActiveSupport::HashWithIndifferentAccess\nutf8: ✓\nauthenticity_token: Z8LuvU7i5ytFi1OxiIGpgwYOy+WE+fiAZv7m7T+wYRI=\npost: !ruby/hash:ActiveSupport::HashWithIndifferentAccess\n&amp;nbsp; is_link: &amp;#x27;true&amp;#x27;\n&amp;nbsp; URL: http://firsttimers.co\n&amp;nbsp; description: My first time.\ncommit: save post\naction: new\ncontroller: posts\n&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12994566,"title":"Rails 3 - Do I need to specify attr_accessible in my models for each attribute I want to use in create()?","body":"<p>I'm fairly new to rails and I am viewing some other's code. I notice that if I attempt to create an instance of a model object using create() I get an error telling me that I cannot create model objects using mass assignment. I am aware of the dangers associated with mass assignment in object creation. However this does not seem to be necessary in some of the source I am using as a reference. Is this new to rails 3.2.7?? Or am I doing something incorrectly?</p>\n\n<p>So if I have a model called \"Person\" and I want to create a new one:</p>\n\n<pre><code>person = Person.create(:first_name =&gt; \"Some\", :last_name =&gt; \"Dude\") #throws exception\n</code></pre>\n\n<p>What I have been doing is adding this to the Person class definition:</p>\n\n<pre><code>attr_accessible :first_name, :last_name\n\nperson = Person.create(:first_name =&gt; \"Some\", :last_name =&gt; \"Dude\") #now this is OK\n</code></pre>\n\n<p>Is defining the accessible attributes on each model class the correct way?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","validation","activerecord","activemodel"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12991522,"title":"Validate presence before custom validation","body":"<pre><code>validates :place_id, :title, :level, :start_at, :end_at, :presence =&gt; true\nvalidate :event_takes_place_in_one_day, :event_is_not_in_past\n\ndef event_takes_place_in_one_day\n    binding.pry\n    self.start_at.day == self.end_at\nend\n</code></pre>\n\n<p>and bang! error, when start_at or end_at  is nil.</p>\n\n<pre><code>undefined method `to_datetime' for nil:NilClass\n-\napp/models/meeting.rb:22:in `cover?'\napp/models/meeting.rb:22:in `event_is_not_in_past'\napp/controllers/meetings_controller.rb:18:in `create'\n</code></pre>\n\n<p>Afaik it is also possible to implemnt this with custom validator, but I suppose this is not the case, because of there is only one validator per class, so I should do three classes for 3 checks, isn't it?</p>\n\n<p>P.s.</p>\n\n<p>Application have a Meeting model with start_at and end_at DateTime type \nattributes, which indicate a start and the end of the meeting \nrespectively.\nI need to implement next logic\nstart_at &lt; end_at (that it starts after than end)\nstart_at.day == end_at.day (meeting ends within one day)\nand also meeting can be created only for the current month.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":4,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":4593,"score":6,"question_id":4954876,"title":"Setting Devise Login to be root page","body":"<p>I am using the following code for my routes:</p>\n\n<pre><code>  devise_for :user, \n    :as =&gt; '', \n    :path_names =&gt; { \n      :sign_in =&gt; \"\", \n      :sign_out =&gt; \"logout\", \n      :sign_up =&gt; \"register\" \n    }\n</code></pre>\n\n<p>But when I'm logged out and I goto <code>/logout</code> I get the following error:</p>\n\n<blockquote>\n  <p>No route matches {:action=>\"new\",\n  :controller=>\"devise/sessions\"}</p>\n</blockquote>\n\n<p>How do I setup the root path to be to <code>:sign_in</code> action?</p>\n"},{"tags":["ruby-on-rails-3","routing","subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12983072,"title":"Rails 3 Subdomain Testing Using lvh.me","body":"<p>I've been looking at the <a href=\"http://railscasts.com/episodes/221-subdomains-in-rails-3\" rel=\"nofollow\">Railscast Subdomains in Rails 3</a> to get started with adding a sub-domain to my Rails application and he mentions that localhost:3000 won't play nicely with subdomains so instead we use lvh.me:</p>\n\n<blockquote>\n  <p>If we go to <a href=\"http://lvh.me:3000/\" rel=\"nofollow\">http://lvh.me:3000/</a> we’ll see the homepage of our\n  application because lvh.me resolves to the IP address 127.0.0.1.</p>\n</blockquote>\n\n<p>Well my application is running in WEBrick under development mode on 127.0.0.1 and navigating to that link doesn't bring me to my application, instead I'm greeted with:</p>\n\n<blockquote>\n  <p>Firefox can't find the server at www.lvh.me.</p>\n</blockquote>\n\n<p>I've also tried <a href=\"http://lvh.me/\" rel=\"nofollow\">http://lvh.me/</a>, &amp; <a href=\"http://xyz.lvh.me:3000/\" rel=\"nofollow\">http://xyz.lvh.me:3000/</a> with no dice.</p>\n\n<p>Is this just a problem on my end or is lvh.me out of commission nowadays? If so are there any alternatives?</p>\n"},{"tags":["ruby-on-rails-3","jquery-mobile","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12968531,"title":"How to disable AJAX in a Rails app using JQueryMobile","body":"<p>I've built a Rails 3 app and I'm trying to get it working with JQueryMobile. I've gone ahead and required <code>query_mobile_rails</code> and that works just fine, but I need to disable the AJAX loading as it seems to get in the way of many things. Looking at the <a href=\"http://jquerymobile.com/demos/1.2\" rel=\"nofollow\">jquerymobile</a> docs, they recommend adding the following javascript after loading JQuery, but before loading JQueryMobile:</p>\n\n<pre><code>$(document).bind(\"mobileinit\", function(){\n  $.mobile.ajaxEnabled = false;\n});\n</code></pre>\n\n<p>I've been reading through the docs on the <a href=\"http://guides.rubyonrails.org/asset_pipeline.html#what-is-fingerprinting-and-why-should-i-care\" rel=\"nofollow\">Asset Pipeline</a>, but I cannot figure out how I can manage to get my code (the above) inserted after JQuery and before JQueryMobile. Where do I place such a .js file so that it will be loaded at the proper time?</p>\n\n<p>Any help would be greatly appreciated!</p>\n"},{"tags":["ruby","ruby-on-rails-3","debugging","rubymine","jetbrains"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1008,"score":1,"question_id":10323119,"title":"cannot load such file -- script/rails : Getting this error while remote debugging through RubyMine","body":"<p>I am getting following error while remote debugging through RubyMine IDE.</p>\n\n<pre><code>$ bundle exec rdebug-ide --port 1234 -- script/rails server\nFast Debugger (ruby-debug-ide 0.4.9) listens on :1234\n    /home/amit/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-ide19-0.4.12/lib/ruby-debug-ide.rb:123:in `debug_load'\n    /home/amit/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-ide19-0.4.12/lib/ruby-debug-ide.rb:123:in `debug_program'\n    /home/amit/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-ide19-0.4.12/bin/rdebug-ide:87:in `&lt;top (required)&gt;'\n    /home/amit/.rvm/gems/ruby-1.9.3-p125/bin/rdebug-ide:19:in `load'\n    /home/amit/.rvm/gems/ruby-1.9.3-p125/bin/rdebug-ide:19:in `&lt;main&gt;'\nUncaught exception: cannot load such file -- script/rails\n</code></pre>\n\n<p>I followed <a href=\"http://rails.vandenabeele.com/blog/2011/12/21/installing-ruby-debug19-with-ruby-1-dot-9-3-on-rvm/\" rel=\"nofollow\">this link</a> to install require gems for remote debug.</p>\n\n<p>Here is Gemfile configuration for remote debug</p>\n\n<pre><code>#To Debug\n  gem 'linecache19', '0.5.13', :path =&gt; \"~/.rvm/gems/ruby-1.9.3-p125/gems/linecache19-0.5.13/\"\n  gem 'ruby-debug-base19', '0.11.26', :path =&gt; \"~/.rvm/gems/ruby-1.9.3-p125/gems/ruby-debug-base19-0.11.26/\"\n  gem 'ruby-debug19', :require =&gt; 'ruby-debug'\n  gem 'ruby-debug-ide19'\n</code></pre>\n\n<p>The application is running with <strong>Ruby 1.9.3</strong> and <strong>Rails 3.0.11</strong></p>\n\n<p>Please help me to resolve this problem.</p>\n\n<p>Thanks,\nAmit Patel</p>\n"},{"tags":["ruby","ruby-on-rails-3","rake","ruby-1.9.3"],"answer_count":3,"favorite_count":4,"up_vote_count":14,"down_vote_count":0,"view_count":2551,"score":14,"question_id":7957330,"title":"Ruby 1.9.3 breaks rake test","body":"<p>I have an existing rails 3 project that works just fine on ruby 1.9.2-p290. However upgrading to ruby 1.9.3-p0 causes <code>rake test</code> to spit out the following error:</p>\n\n<pre><code>/Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:167:in `block in non_options': file not found: test/unit/**/*_test.rb (ArgumentError)\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:146:in `map!'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:146:in `non_options'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:207:in `non_options'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:52:in `process_args'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/minitest/unit.rb:891:in `_run'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/minitest/unit.rb:884:in `run'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:21:in `run'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:326:in `block (2 levels) in autorun'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:27:in `run_once'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:325:in `block in autorun'\n/Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:167:in `block in non_options': file not found: test/functional/**/*_test.rb (ArgumentError)\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:146:in `map!'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:146:in `non_options'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:207:in `non_options'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:52:in `process_args'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/minitest/unit.rb:891:in `_run'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/minitest/unit.rb:884:in `run'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:21:in `run'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:326:in `block (2 levels) in autorun'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:27:in `run_once'\nfrom /Users/zmanji/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/test/unit.rb:325:in `block in autorun'\n</code></pre>\n\n<p>It seems to be a consequence of this <a href=\"https://github.com/jimweirich/rake/issues/51\">rake issue</a>. However when I create a simple rails project on ruby 1.9.3 so such error occurs. What can I do to get my rails project to run on ruby 1.9.3?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","group-by"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":12993287,"title":"How would I sort and group this and loop over it with rails?","body":"<p>Ok so i have a pages table with all the static with this schema</p>\n\n<pre><code>create_table \"pages\", :force =&gt; true do |t|\n  t.string   \"name\"\n  t.text     \"html\"\n  t.string   \"url\"\n  t.integer  \"position\"\n  t.boolean  \"is_home\"\n  t.integer  \"parent_id\",  :default =&gt; 0, :null =&gt; false\n  t.string   \"nav\"\nend\n</code></pre>\n\n<p>A page can have another page as its parent. The idea is that I want the user to have complete control of the navigation and the pages. So my question what is the best way to group these pages so in the html i can loop over all the pages and their subpages</p>\n\n<p>Here is what i have so far</p>\n\n<pre><code>grouped_pages = Page.where(:is_home =&gt; 0).group_by(&amp;:nav).each do |key, group|\n group.sort_by(&amp;:parent_id)\nend\n</code></pre>\n\n<p>I was hoping to group them in some array and or hash combination with another layer for ever page that has a parent_id of another page</p>\n\n<p>the page structure can look like this</p>\n\n<pre><code>Page1\n  Page3\n    Page7\n  Page4\n  Page5\nPage2\n  Page5\n  Page6\n</code></pre>\n\n<p>Any ideas of the best way to sort and loop over to print out the uls for the html</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12993436,"title":"RAILS 3.1 - unknown attribute: id on build","body":"<p>When I want to use build for a many-to-many through association, I get the following error in my controller:</p>\n\n<p><strong>unknown attribute: fte_report_option_id</strong></p>\n\n<p>In my controller:</p>\n\n<blockquote>\n  <p>def edit_clients_reports<br>\n     @fte_report_option = FteReportOption.find(params[:id])<br>\n     <strong>@fte_report_option.fte_report_client_options.build</strong><br>\n     end</p>\n</blockquote>\n\n<p>In my first model, I have:</p>\n\n<blockquote>\n  <p>class FteReportOption &lt; ActiveRecord::Base</p>\n  \n  <p>has_many :fte_report_client_options, :dependent => :destroy<br>\n     has_many :clients, :through => :fte_report_client_options<br>\n     end  </p>\n</blockquote>\n\n<p>In my second model:</p>\n\n<blockquote>\n  <p>class FteReportClientOption &lt; ActiveRecord::Base<br>\n     self.primary_key = \"client_report_id\"</p>\n  \n  <p>belongs_to :fte_report_option, :foreign_key => :option_id, :class_name => \"FteReportOption\"\n     belongs_to :client, :foreign_key => :client_id, :class_name => \"Client\"<br>\n     end</p>\n</blockquote>\n\n<p>And my third model:</p>\n\n<blockquote>\n  <p>class Client &lt; ActiveRecord::Base<br>\n     set_primary_key \"client_id\"  </p>\n  \n  <p>has_many :fte_report_client_options, :dependent => :destroy<br>\n     has_many :fte_report_options, :through => :fte_report_client_options  </p>\n</blockquote>\n\n<p>In my migration for the join table, I have:</p>\n\n<blockquote>\n  <p>create_table :fte_report_client_options, :primary_key => \"client_report_id\", :force => true do |t|<br>\n       t.integer :option_id<br>\n       t.integer :client_id<br>\n       t.timestamps<br>\n     end</p>\n</blockquote>\n\n<p>Is anyone know what's happen?</p>\n\n<p>Thanks for your help</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":546,"score":1,"question_id":5667719,"title":"Using a seprate template for devise","body":"<p>Is there a way i can use a separate template for devise login view(devise gem)</p>\n"},{"tags":["ruby-on-rails-3","validation","password-confirmation"],"answer_count":2,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":6951,"score":5,"question_id":4697536,"title":"Validators, password confirmation","body":"<p>I can't figure out why the model doesen't check for the password confirmation, this is the code of the model:</p>\n\n<p>*</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessor :password_confirmation\n  validates :email, :presence =&gt;true,\n                    :uniqueness=&gt;true\n  validates :password, :presence =&gt;true,\n                    :length =&gt; { :minimum =&gt; 5, :maximum =&gt; 40 },\n                    :confirmation =&gt;true\n  validates_confirmation_of :password\nend\n</code></pre>\n\n<p>*</p>\n\n<p>The controller is intended take the data from the view and try to perform a save, this is the code of the view:</p>\n\n<p>*</p>\n\n<pre><code>&lt;h1&gt;Registration process&lt;/h1&gt;\n&lt;%= form_for(@new_user) do |f|%&gt;\n&lt;% if @new_user.errors.any? %&gt;\n  &lt;div id=\"errorExplanation\"&gt;\n    &lt;h2&gt;&lt;%= pluralize(@new_user.errors.count, \"error\") %&gt; prohibited this article from being saved:&lt;/h2&gt;\n    &lt;ul&gt;\n    &lt;% @new_user.errors.full_messages.each do |msg| %&gt;\n      &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n  &lt;% end %&gt;\n    &lt;%= f.label :email %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :email %&gt;&lt;br /&gt;\n    &lt;%= f.label :password %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password %&gt;&lt;br /&gt;\n    &lt;%= f.label :password_confirmation %&gt;&lt;br /&gt;\n    &lt;%= f.password_field :password_confirmation %&gt;\n    &lt;%#TODO Confirm password%&gt;\n\n    &lt;%= f.submit 'Join' %&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>*</p>\n\n<p>No errors come out if the password doesn't match.</p>\n"},{"tags":["ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12961624,"title":"Correct way to model has_many through style relationship in mongoid?","body":"<p>I need to figure out how to model this best in mongoid, I have a galleries model and an images model.  I need to be able to have images be able to be referenced in multiple documents and I need each gallery to allow the images to be sortable within the gallery.  In mysql I would do this with a join table but I can't seem to figure out how best to do this with mongodb/mongoid.  Any help would be greatly appreciated. </p>\n"},{"tags":["ruby-on-rails-3","logging"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":66,"score":1,"question_id":11522223,"title":"logging info with rails","body":"<p>Moving over from django / python, I am having a little trouble getting the rails logger to log all the information I want. I am wondering how/if the following can be achieved:</p>\n\n<ol>\n<li>Having in the log format(ter) include the specific <strong>file, function name and line</strong> where the logging statement itself was found. Essentially the equivalent of <code>LOG_MSG_FORMAT = '%(asctime)s %(levelname)s %(filename)s:%(funcName)s(%(lineno)d) : %(message)s'</code> in python logger?</li>\n<li>Being able to log all requests, via something similar to a django <a href=\"http://djangosnippets.org/snippets/2624/\" rel=\"nofollow\">request logging middleware</a>. Particularly, being able to log the <strong>username</strong> (if logged in) of every request.</li>\n</ol>\n\n<p>Am I missing something obvious? or does this require (lots of) custom code?</p>\n"},{"tags":["ruby","ruby-on-rails-3","scope"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":413,"score":0,"question_id":7318073,"title":"Scopes is not missing constant Product?","body":"<p>I want to use 'scope' in my project. </p>\n\n<p>i create a folder under lib, see</p>\n\n<p><img src=\"http://i.stack.imgur.com/J3Zj3.jpg\" alt=\"the directory structure\"></p>\n\n<p>The file 'product.rb' include some methods, like </p>\n\n<pre><code>module Scopes::Product\n  #TODO: change this to array pairs so we preserve order?\n\n  SCOPES = {\n    # Scopes for selecting products based on taxon\n    :taxon =&gt; {\n      :taxons_name_eq =&gt; [:taxon_name],\n      :in_taxons =&gt; [:taxon_names],\n    },\n    # product selection based on name, or search\n    :search =&gt; {\n      :in_name =&gt; [:words],\n      :in_name_or_keywords =&gt; [:words],\n      :in_name_or_description =&gt; [:words],\n      :with_ids =&gt; [:ids]\n    },\n...\n</code></pre>\n\n<p>I use it in my model 'product.rb'</p>\n\n<pre><code>include ::Scopes::Product\n</code></pre>\n\n<p>error message:</p>\n\n<pre><code>pry(main)&gt; Product\nArgumentError: Scopes is not missing constant Product!\nfrom /usr/local/ruby/lib/ruby/gems/1.9.1/gems/activesupport-3.0.9/lib/active_support/dependencies.rb:479:in `load_missing_constant'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","auto-increment","autoincrement","column"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12991941,"title":"Rails Auto-Increment Column","body":"<p>I asked this same question about a week ago, but I might not have been clear with what I wanted.\nI already have a table created that is sorted/filtered by several different select boxes.\nI need the first column in my table to increment, for example:</p>\n\n<p>1 | </p>\n\n<p>2 | </p>\n\n<p>3 |</p>\n\n<p>etc.</p>\n\n<p>I know that this is a simple  problem that has an easy explanation, but I have not been able to figure it out. I would like it to function something like the teams in this website: <a href=\"http://espn.go.com/college-football/rankings\" rel=\"nofollow\">http://espn.go.com/college-football/rankings</a></p>\n\n<p>Any help is greatly appreciated</p>\n\n<p>Thanks,</p>\n\n<p>Jack</p>\n"},{"tags":["jquery","html","ruby-on-rails","ruby-on-rails-3","html5"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12992596,"title":"Ajax call happening 2 times in a row?","body":"<p>I have a rails application that I am working on that exhibiting behavior I cant understand.  I have an html file:</p>\n\n<pre><code>&lt;h1&gt;Hello World&lt;/h1&gt;\n  &lt;table&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Hello&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Hello&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Hello&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Hello&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I then have a javascript(jquery really) file that I hit when someone clicks on a row in the table.  </p>\n\n<pre><code>$(document).ready(function(){\n  $(\"tr\", \"table\").click(function(){\n    console.log(\"TEST\");\n  });\n});\n</code></pre>\n\n<p>Everytime I click on a row in the table, the function is called 2 times.  I get 'TEST' in the console twice.  I am new to jquery and rails, so I know that I am missing something simple.  Someone please show me what I am doing wrong.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","sendgrid"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":86,"score":1,"question_id":12414506,"title":"How to send multiple emails with SendGrid?","body":"<p>The following code seems to work if there is one user, but truncate the email for multiple users:</p>\n\n<pre><code>users.each do |user|\n  mail(\n    :to =&gt; user.email,\n    :subject =&gt; 'Hi',\n    :template_name =&gt; 'notification'\n  ).deliver\n</code></pre>\n\n<p>Is this the proper way to send a few emails?</p>\n\n<ul>\n<li>Ruby on Rails 3.2.2</li>\n<li>Heroku</li>\n<li>SendGrid</li>\n</ul>\n"},{"tags":["ruby-on-rails-3","heroku","cron","redis","delayed-job"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12523587,"title":"What is the best practice for running a scheduler or delayed job on Heroku?","body":"<p>I've seen several solutions for doing this:</p>\n\n<ol>\n<li>Redis / Resque</li>\n<li>Delayed Job</li>\n<li>Heroku Scheduler</li>\n<li>Clockwork</li>\n</ol>\n\n<p>Heroku scheduler won't work because it runs at random times and only once per 10 minutes at its most frequent.</p>\n\n<p>Running on Cedar. Running multiple web dynos.</p>\n\n<p>EDIT: Here's what I want to do:<br />\nCall an arbitrary method with params at an arbitrary point in the future. Something like <code>Schedule.set(Notification.send_update_to_user(574), Time.now + 1.days)</code></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":60,"score":4,"question_id":12991586,"title":"how to use a span tag for form fields in ruby on rails?","body":"<p>In my form, I used the span tag like the following:</p>\n\n<pre><code>`&lt;%= content_tag :span`, f.object.User, class: 'username' %&gt;`\n</code></pre>\n\n<p>Its look like the following in HTML after i selected the value:</p>\n\n<p><code>&lt;span class=\"user\" style=\"\"&gt;Antony&lt;/span&gt;</code></p>\n\n<p>The problem is id doesn't get the value to the database when we create a form. I don't know the exact problem is. I want to use this content tag instead of text_field to get the value.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12969293,"title":"I don't want any specific role.I want to assign permission to any user from GUI by check boxes. So that user can do whatever permissions he have","body":"<p>i just want an application through which i can dynamically assign roles to users through check boxes.\nAny answer will be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12991067,"title":"Filter records by virtual attribute rather than database field?","body":"<p>I am using this function in my <code>User</code> model to populate a select box in a form:</p>\n\n<pre><code>def outstanding_invoices\n  invoices.to_a.select { |invoice| invoice.balance &lt; 0 }\nend\n</code></pre>\n\n<p>The problem is that <code>balance</code> is not a database field but a method that calculates something.</p>\n\n<p>So it takes an awful lot of SQL queries to generate the select box because the function above iterates over every single <code>invoice</code> that the <code>user</code> has.</p>\n\n<p>Is there a faster way to generate the select box, ideally using one SQL query only? </p>\n\n<p>A simple alternative would probably be storing the <code>balance</code> of each <code>invoice</code> in the database, but I am somehow reluctant to do that because I want to keep my database to a minimum.</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails-3","rvm"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":3080,"score":2,"question_id":5959387,"title":"RVM Ruby on Snow Leopard","body":"<p>I installed RVM and then the most recent version of Ruby with it. Now when I try to generate a new rails app I get the following error message.</p>\n\n<pre><code>    NOTE: Gem::Specification#default_executable= is deprecated with no replacement. It will be removed on or after 2011-10-01.\n    Gem::Specification#default_executable= called from /Users/local/.rvm/gems/ruby-1.9.2-p180@global/specifications/rake-0.8.7.gemspec:10.\n    NOTE: Gem::Specification#default_executable= is deprecated with no replacement. It will be removed on or after 2011-10-01.\n    Gem::Specification#default_executable= called from /Users/local/.rvm/gems/ruby-1.9.2-p180/specifications/rake-0.8.7.gemspec:10.\n    NOTE: Gem::Specification#default_executable= is deprecated with no replacement. It will be removed on or after 2011-10-01.\n    Gem::Specification#default_executable= called from /Users/local/.rvm/gems/ruby-1.9.2-p180/specifications/rubygems-update-1.8.1.gemspec:11.\n    /Library/Ruby/Site/1.8/rubygems/dependency.rb:247:in `to_specs': Could not find rails (&gt;= 0) amongst [rake-0.8.7, rake-0.8.7, rubygems-update-1.8.1] (Gem::LoadError)\n        from /Library/Ruby/Site/1.8/rubygems/dependency.rb:256:in `to_spec'\n        from /Library/Ruby/Site\n\n/1.8/rubygems.rb:1182:in `gem'\n    from /usr/bin/rails:18\n</code></pre>\n\n<p>Any idea on why this is happening?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12990567,"title":"Calling a windows .exe (compiler) from Rails app on Heroku","body":"<p>I would like to know if this is even feasible. And if so, what a possible approach would be.\nI am thinking that the .exe would have to be made available through a web service running on a windows stack (asp.net or php) and that a direct heroku solution would not be the way to go.</p>\n"},{"tags":["ruby","ruby-on-rails-3","sti"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":42,"score":3,"question_id":12461806,"title":"Using scope, defined in parent model, inside it's child (STI pattern)","body":"<p>I implement a class hierarchy using STI pattern</p>\n\n<pre><code>class A\n  scope :aaa, where([someField]:[someValue])\nend\n\nclass B &lt; A\nend\n</code></pre>\n\n<p>The problem is that when I try to call something like:</p>\n\n<pre><code>B.limit(5).aaa\n=&gt; SELECT \"[table]\".* FROM \"[table]\" WHERE \"[table]\".\"type\" IN ('A') AND ([someField] = [someValue]) LIMIT 5\n</code></pre>\n\n<p>So I am getting 5 objects of type A, which satisfies scope :aaa\nBut I need to do the same with rows where type = \"B\"</p>\n\n<p>Is there any way to use scopes from parent, without redifinning it in childs in STI pattern?</p>\n\n<p>Thanks in advance</p>\n\n<p><strong>EDITED</strong></p>\n\n<p>I just discussed it with my frind and he showed me one important thing. A in not the root class of STI. IN fact whole hierarchy looks like</p>\n\n<pre><code>class O &lt; ActiveRecord::Base\nend\n\nclass A &lt; O\n  scope ..... .....\nend\n\nclass B &lt; A\nend\n</code></pre>\n\n<p>maybe the reason is in hierarchy itself?...</p>\n"},{"tags":["ruby","ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":29,"score":1,"question_id":12990159,"title":"Cannot create indexes for PG in rake migration - Rails","body":"<p>I am trying to write a migration that will create a table and add a couple of indexes.</p>\n\n<p>This is the migration:</p>\n\n<pre><code>class CreatePages &lt; ActiveRecord::Migration\n  def change\n    create_table :pages do |t|\n        t.string \"name\", :limit =&gt; 50\n        t.string \"permalink\"\n        t.integer \"position\"\n        t.boolean \"visible\"\n        t.integer \"subject_id\"\n\n        add_index(\"pages\",\"subject_id\")\n        add_index(\"pages\",\"name\")\n\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>When I trying and run this migration I get the following error:</p>\n\n<blockquote>\n  <p>PG::Error: ERROR:  relation \"pages\" does not exist\n  : CREATE  INDEX \"index_pages_on_subject_id\" ON \"pages\" (\"subject_id\")</p>\n</blockquote>\n\n<p>Can someone tell me what I'm doing wrong?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1024,"score":0,"question_id":7453981,"title":"Devise rake db:migrate fails because of duplicate column in my User's table - Rails 3.1","body":"<p>This is the error I get when I am first installing Devise and running <code>rake db:migrate</code>:</p>\n\n<pre><code>==  AddDeviseToUsers: migrating ===============================================\n-- change_table(:users)\nrake aborted!\nAn error has occurred, this and all later migrations canceled:\n\nSQLite3::SQLException: duplicate column name: email: ALTER TABLE \"users\" ADD \"email\" varchar(255) DEFAULT '' NOT NULL\n</code></pre>\n\n<p>Given that this is just test data, I could just delete that column in my db and re-run it, but that doesn't seem very Railsy - if only for the reason that it will making my staging server (the only other server with my app) out-of-sync with my <code>localhost</code>.</p>\n\n<p>Also, what if there is a conflict with another column.</p>\n\n<p>So given that this is the schema of my <code>User</code> table before running the migration, how should I handle this? With a migration of some sort that does a rename?</p>\n\n<pre><code># == Schema Information\n#\n# Table name: users\n#\n#  id         :integer         not null, primary key\n#  email      :string(255)\n#  f_name     :string(255)\n#  l_name     :string(255)\n#  username   :string(255)\n#  role_id    :integer\n#  picture    :string(255)\n#  about_me   :string(255)\n#  website    :string(255)\n#  created_at :datetime\n#  updated_at :datetime\n#\n</code></pre>\n"},{"tags":["database","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12989851,"title":"Rails 3: Updating Database Data","body":"<p>I'm trying to follow the instructions <a href=\"https://github.com/twitter/activerecord-reputation-system/wiki/Migrate-to-Version-2.0\" rel=\"nofollow\">here</a>. The final step is to update my database data by using this line of code:</p>\n\n<pre><code>UPDATE rs_reputation_messages SET sender_type = 'ReputationSystem::Evaluation' WHERE sender_type = 'RSEvaluation'\n</code></pre>\n\n<p>I can't figure out where to put this code. Typically, I'd update the database with a migration, but this looks like a MySQL command. I'm certain there's a very, very simple answer to this question, but despite scouring Google, I can't even figure out how to phrase the question right.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","wiki","markdown"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12988789,"title":"handling wiki links with markdown in ruby","body":"<p>I'm building a simple app with Rails using Markdown for storing content.  My question is how to build internal [[wiki]] style links?  Either by pre-processing before they get to markdown or some markdown derivative?  I release I could probably preprocess using regex, but I'm guessing there are others with ready built solutions.</p>\n\n<p>For example I know Instiki uses both markdown and [[wiki|Wiki]] links and I've looked but couldn't figure out how they're handling it.</p>\n\n<p>Any tips?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12988543,"title":"Grouping created_at by date only?","body":"<p>I have the following in my Product model.</p>\n\n<pre><code>def grouped_created_at\n  @created_ats = @products.group_by { |c| c.created_at }\nend\n</code></pre>\n\n<p>Works fine, but I want to group by the date only. As this is a timestamp, i'm not getting the results I need. Can anyone advise how to modify this?</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sinatra","rack","flowplayer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12962603,"title":"Sinatra and flowplayer issue","body":"<p>I try to set local videos to play in Sinatra with flowplayer, but with no success. Sinatra can't see js files and I don't know why. Here is files:</p>\n\n<pre><code>#layout.erb  \n&lt;script src=\"../public/javascripts/flowplayer-3.2.11.min.js\"&gt;&lt;/script&gt;  \n\n#index.erb  \n &lt;a href=\"http://pseudo01.hddn.com/vod/demo.flowplayervod/flowplayer-700.flv\"\n style=\"display:block;width:537px;height:320px;\"\n id=\"player\"&gt;&lt;/a&gt;\n &lt;script language=\"JavaScript\"&gt;\n flowplayer(\"player\", \"../public/javasripts/flowplayer-3.2.14.swf\");\n &lt;/script&gt;  \n\n#app.rb\n require 'sinatra'\n require 'rubygems'\n\n get '/' do\n erb :index\n end\n</code></pre>\n\n<p>What do I miss??</p>\n\n<p>P.S. I have made security settings for flash to play as local videos. Thank you for help.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12987108,"title":"HAML Error - 2 spaces were used for indentation","body":"<p>Use a HAML and partition in the site</p>\n\n<p>show.html.haml</p>\n\n<pre><code>%ul\n  =render :partial =&gt; \"layouts/brand\", :collection =&gt; @main_foreign_brands, :as =&gt; :brand\n</code></pre>\n\n<p>layouts/_brand.html.haml</p>\n\n<pre><code>%li=link_to brand.name, brand.url\n</code></pre>\n\n<p>but I have an error:\n Showing /my_site/app/views/mains/show.html.haml where line #11 raised:</p>\n\n<p>Inconsistent indentation: 2 spaces were used for indentation, but the rest of the document was indented using 4 spaces.</p>\n\n<p>What's wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cookies","signed-cookies"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12988263,"title":"Signed cookies in Rails 3","body":"<p>I set a signed cookie like this:</p>\n\n<pre><code>cookies.permanent.signed[:remember_me] = [user.id, user.salt]\n</code></pre>\n\n<p>When reading the cookie:</p>\n\n<pre><code>cookies.signed[:remember_me]\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>14cc5d64cd84f96f8847726a6ed0e280235025379\n</code></pre>\n\n<p>What does this value mean? How could I get user's <code>id</code> back?</p>\n\n<p>I use Rails 3.2.6.</p>\n"},{"tags":["ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":111,"score":0,"question_id":7651607,"title":"XML Parsing Error: no element found when using rjs in rails","body":"<p>I implemented destroy functionality using rjs template in rails. i got an error \"XML Parsing Error: no element found\" when destroy one record from database. is this right my coding?</p>\n\n<p>I used the following versions ruby and rails:\n     Ruby version: 1.8.7\n     Rails Version: 2.3.8</p>\n\n<pre><code>Controller file:\n\n  def destroy\n    begin\n      @task = Task.find(params[:id])\n      @task.destroy\n\n      respond_to do |format|\n      #format.html { redirect_to(tasks_url) }\n      format.js\n     format.xml  { head :ok }\n      end\n   rescue Exception =&gt; e\n  puts e\n  end\n\nend\n</code></pre>\n\n<p>partial template file _task.html.erb:</p>\n\n<pre><code>&lt;tr id=\"&lt;%= dom_id(task) %&gt;\"&gt;\n &lt;td&gt;&lt;%= task.name %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= task.note %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= task.priority %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= link_to 'Show', task %&gt;&lt;/td&gt;\n &lt;td&gt;&lt;%= link_to 'Edit', edit_task_path(task) %&gt;&lt;/td&gt;\n&lt;td&gt;\n&lt;%= link_to 'Destroy', task, :confirm =&gt; 'Are you sure?', :method =&gt;:delete,:remote =&gt; :true %&gt;      \n</code></pre>\n\n<p>\n    </p>\n\n<p>index.rhtml file:</p>\n\n<pre><code>&lt;div id='newform'&gt;\n    &lt;% form_for([@task, Task.new]) do |f| %&gt;\n&lt;div&gt;\n  &lt;%= f.label 'Add a new task: ' %&gt;\n  &lt;%= f.text_field :name %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n  &lt;%= f.submit %&gt;\n&lt;/div&gt;\n  &lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;table id=\"alltasks\"&gt;\n&lt;tr id=\"tablehead\"&gt;\n &lt;th&gt;Name&lt;/th&gt;\n &lt;th&gt;Note&lt;/th&gt;\n &lt;th&gt;Priority&lt;/th&gt;\n &lt;th&gt;&lt;/th&gt;\n &lt;th&gt;&lt;/th&gt;\n &lt;th&gt;&lt;/th&gt;\n &lt;/tr&gt;\n\n&lt;%= render @tasks  %&gt;\n &lt;!-- expanded: render :partial =&gt; \"task\", :collection =&gt; @tasks --&gt;\n  &lt;/table&gt;\n  &lt;br /&gt;\n &lt;%= link_to 'New Task', new_task_path %&gt;\n</code></pre>\n\n<p>destroy.js.rjs file:</p>\n\n<pre><code>page.alert('Hi')\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","nested-attributes","fields-for"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12987967,"title":"Plural for fields_for has_many association not showing in view","body":"<p>Currently, an <strong>Item</strong>  <em>belongs_to</em> a <strong>Company</strong> and <em>has_many</em> <strong>ItemVariants</strong>.</p>\n\n<p>I'm trying to use nested fields_for to add ItemVariant fields through the Item form, however using :item_variants does not display the form. It is only displayed when I use the singular.</p>\n\n<p>I have check my associations and they seem to be correct, could it possibly have something to do with item being nested under Company, or am I missing something else?</p>\n\n<p>Thanks in advance.</p>\n\n<p><em>Note: Irrelevant code has been omitted from the snippets below.</em></p>\n\n<p><strong>EDIT:</strong> Don't know if this is relevant, but I'm using CanCan for Authentication.</p>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>resources :companies do\n  resources :items\nend\n</code></pre>\n\n<p><strong>item.rb</strong></p>\n\n<pre><code>class Item &lt; ActiveRecord::Base\n  attr_accessible :name, :sku, :item_type, :comments, :item_variants_attributes\n\n\n  # Associations\n  #-----------------------------------------------------------------------\n  belongs_to :company\n  belongs_to :item_type\n  has_many   :item_variants\n\n  accepts_nested_attributes_for :item_variants, allow_destroy: true\n\nend\n</code></pre>\n\n<p><strong>item_variant.rb</strong></p>\n\n<pre><code>class ItemVariant &lt; ActiveRecord::Base\n  attr_accessible :item_id, :location_id\n\n  # Associations\n  #-----------------------------------------------------------------------\n  belongs_to :item\n\nend\n</code></pre>\n\n<p><strong>item/new.html.erb</strong></p>\n\n<pre><code>&lt;%= form_for [@company, @item] do |f| %&gt;\n  ...\n  ...\n  &lt;%= f.fields_for :item_variants do |builder| %&gt;\n    &lt;fieldset&gt;\n      &lt;%= builder.label :location_id %&gt;\n      &lt;%= builder.collection_select :location_id, @company.locations.order(:name), :id, :name, :include_blank =&gt; true %&gt;\n    &lt;/fieldset&gt;\n  &lt;% end %&gt;\n  ...\n  ...\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","paperclip","rspec-rails"],"answer_count":3,"favorite_count":2,"up_vote_count":1,"down_vote_count":2,"view_count":72,"score":-1,"question_id":12987211,"title":"File Upload Using Paperclip With Rspec Testing (ruby on rails)","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/7260394/test-a-file-upload-using-rspec-rails\">test a file upload using rspec - rails</a>  </p>\n</blockquote>\n\n\n\n<p>I don't know how to write test cases for file uploads. can you please help me</p>\n\n<p>I have form with user_photo, name, email. i write test cases for name and email</p>\n\n<p>like</p>\n\n<pre><code> fill_in \"user_name\", :with =&gt; \"xyz\"\n fill_in \"user_email\", :with =&gt; \"test@test.com\"\n</code></pre>\n\n<p>but how can i write test cases for select photo ?</p>\n"}]}
{"total":34675,"page":15,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12981912,"title":"Public folder permission in Rails project","body":"<p>In my Rails project, I noticed that when I put some files into my <code>public</code> folder, such as <code>.html, .pdf, .jpg</code>, they can be opened via a browser. But when I put other files, such as <code>.txt</code> or files with no file type, permission is denied. </p>\n\n<pre><code>Forbidden\n\nYou don't have permission to access /blog/public/test.txt on this server.\n</code></pre>\n\n<p>Where is this permission controlled?</p>\n\n<p>Actually, it's interesting that the file <code>robots.txt</code>, which came automatically when the Rails project was set up, <strong>can</strong> be accessed! But <code>test.txt</code>, which I created, cannot be accessed.</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12982163,"title":"Rails 3 Active Record object re-initalize","body":"<p>Here is my problem:\nI have an old user object and a new user object.\nI'm trying to create a new User object and want to assign all the attributes to the old user object and keep the id (primary key) same without creating a new row in the User table.</p>\n\n<pre><code>old_user = User.find(20)\nold_user.id # this is 20\nold_user.name # this displays \"old_name\"\nnew_user = User.new\nnew_user.name = \"new_name\"\nold_user = new_user\nold_user.save # this doesn't work since the new_user.id is nil and so is old_user.id is nil\nold_user.id = 20 and save #this won't work either.\n</code></pre>\n\n<p>How can I save the state of new_user to old_user object but maintain the same primary key id.</p>\n\n<p>Please let me know if you have any questions.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12984316,"title":"Rails database add column","body":"<p>When creating a model in Rails, I forgot to add a column <code>amount</code> that I want. How can I add it to the model later?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":12987745,"title":"HTML encode blog post","body":"<p>I have a Rails 3 blog and the text is stored in the database with markup tags inside it, but when I show the post, I see the markup tags instead of the expected output. So instead of some bold text, I see <b>some text</b> in the blog post.</p>\n\n<p>How can I get the text to become bold? Thanks!</p>\n"},{"tags":["ruby-on-rails-3","forms","nested-attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12942650,"title":"rails accepts_nested_attributes_for - Error: Mysql2::Error: Unknown column 'offers.' in 'where clause'","body":"<p>Code is:</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n  ...\n  has_one :offer, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :offer\n  ...\nend\n\nclass Offer &lt; ActiveRecord::Base\n  ...\n  belongs_to :client\n  ...\nend\n\n\n&lt;%= simple_form_for [:admin, @client], :html=&gt;  {:multipart =&gt; true } do |f| %&gt;\n..some input fields\n&lt;%= f.simple_fields_for :offer, @client.new_record? ? Offer.new : \"\"  do |o| %&gt;\n..some input fields\n</code></pre>\n\n<p>This works for new entries, but does not update.</p>\n\n<blockquote>\n  <p>Error: Mysql2::Error: Unknown column 'offers.' in 'where clause': DELETE FROM <code>offers</code> WHERE <code>offers</code>.`` = 718</p>\n</blockquote>\n\n<p>When I change the client model to:</p>\n\n<pre><code>accepts_nested_attributes_for :offer, :reject_if =&gt; lambda {|a| a[:name].blank?}\n</code></pre>\n\n<p>The error message is gone,it updates the client table but not the offer table.</p>\n\n<p>This is working:</p>\n\n<pre><code>  has_one :offer, :dependent =&gt; :destroy\n  accepts_nested_attributes_for :offer, allow_destroy: true\n\n  belongs_to :client\n\n  &lt;%= f.simple_fields_for :offer, @client.new_record? ? Offer.new : @client.offer  do |o| %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12987237,"title":"How to implement the dynamic authorization with CanCan?","body":"<p>I am following this tutorial: <a href=\"http://eveloverails.wordpress.com/2011/04/02/183/\" rel=\"nofollow\">http://eveloverails.wordpress.com/2011/04/02/183/</a>. </p>\n\n<p>I have four models as in the tutorial, but the problem is that I just don't understand how the admin changes the permission of user dynamically. In the tutorial, permissions are generated dynamically and I don't know how to delete the permissions. </p>\n\n<p>One more thing; I have generated the model, but not the scaffolds.</p>\n"},{"tags":["ruby-on-rails-3","heroku","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12986107,"title":"Can I easily limit which files a user can download from an Amazon S3 server?","body":"<p>I have tried looking for an answer to this but I think I am perhaps using the wrong terminology so I figure I will give this a shot.</p>\n\n<p>I have a Rails app where a company can have an account with multiple users each with various permissions etc.  Part of the system will be the ability to upload files and I am looking at S3 for storage.  What I want is the ability to say that users from Company A can only download the files associated with that company?</p>\n\n<p>I get the impression I can't unless I restrict the downloads to my deployment servers IP range (which will be Heroku) and then feed the files through a controller and a send_file() call.  This would work but then I am reading data from S3 to Heroku then back to the user vs. direct from S3 to the user.</p>\n\n<p>If I went with the send_file method can I close off my S3 server to the outside world and have my Heroku app send the file direct?</p>\n\n<p>A less secure idea I had was to create a unique slug for each file and store it under that name to prevent random guessing of files i.e. <code>http://mys3server/W4YIU5YIU6YIBKKD.jpg</code> etc. This would be quick and dirty but not 100% secure.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":39,"score":1,"question_id":12983938,"title":"Sending custom email message on devise user creation","body":"<p>So I need to send a confirmation email every time a user signs up. There are two ways of signing up -- either when a user hits my login page, or when he is invited by another user. In both cases, I want to send separate types of email (in the second case, I also want to tell them that you were sent invitation by foo@bar.com person etc.). What is the best way to do this? I am using devise for rails.</p>\n"},{"tags":["ruby-on-rails-3","openlayers","openstreetmap"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":249,"score":1,"question_id":10844012,"title":"Openlayers examples / tutorials / books to create maps?","body":"<p>I am working on a Rails app that has some Geo data and would like to add some mapping functionality.</p>\n\n<p>I would also like to add the ability to draw polygons / polylines and store them in a model for future reference and editing etc.  basically I want the user to be able to drop an associated marker on a map linked to a location or draw a path and alth link that to a another model.</p>\n\n<p>Is the a good site / tutorial / book on this?</p>\n"},{"tags":["ruby","ruby-on-rails-3","devise"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12978516,"title":"Validate uniqueness of two columns","body":"<p>I am trying to validate that two columns are unique in my User model.  I've searched Google and from what I understand the following code will not work:</p>\n\n<pre><code>validates :login, :uniqueness=&gt;true\nvalidates :email, :uniqueness=&gt;true\n</code></pre>\n\n<p>In my case doing that will validate the uniqueness of email, but will not validate the uniqueness of login.  I set that login must be unique on the database.  However, all that will do is generate a runtime error if it already exists.  I don't want that error in production because it would result in a 500 internal server error, which the user would not understand.</p>\n\n<p>Any ideas on how I could validate the uniqueness of both of these fields?</p>\n\n<p><strong>Authentication Used:</strong></p>\n\n<ul>\n<li>CanCan</li>\n<li>Devise</li>\n<li>Devise Invitable</li>\n</ul>\n\n<p><strong>Update:</strong></p>\n\n<p>From what I can tell the problem is being caused by Devise, specifically the validatable module, which validate email and password.</p>\n\n<p><strong>Update 2:</strong></p>\n\n<p>Removing the validatable module from Devise will result in neither checking for uniqueness.</p>\n\n<p><strong>Update 3:</strong></p>\n\n<p>It appears that devise is not causing the problem.  Rather, a gem called Devise Invitable is.  Removing this gem results in the validation being triggered.  It also appears that this gem tries to force validations of the email field.  It makes sense due to the nature of this gem, but  shouldn't be blocking. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":58,"score":2,"question_id":12982846,"title":"redirect_to @ syntax meaning","body":"<p>What does the code </p>\n\n<pre><code>redirect_to @user\n</code></pre>\n\n<p>when used in a controller method, mean in Rails?</p>\n\n<p>Where exactly does it redirect to? Does it redirect to a Users controller (If so, which method of the controller), or does it not go through the controller and instead go directly to a view? </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12983143,"title":"undefined method `stringify_keys' for \"test\":String","body":"<p>I was following this railscast to implement a simple solution to deal with static pages: <a href=\"http://railscasts.com/episodes/117-semi-static-pages-revised?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/117-semi-static-pages-revised?view=asciicast</a></p>\n\n<p>The specific problem I'm having is getting the update method in my pages controller to work. </p>\n\n<p>My routes file:</p>\n\n<pre><code>Jog::Application.routes.draw do\nroot :to =&gt; 'categories#index'\ndevise_for :categories\ndevise_for :users\nresources :categories do\n  resources :gists\nend\nresources :sub_categories, :gists, :pages, except: \"show, edit, update, destory\" \nget ':id', to: 'pages#show', as: :page \nget ':page/edit', to: 'pages#edit', as: :edit_page \nput ':page', to: 'pages#update', as: :update_page\ndelete ':page', to: 'pages#destroy', as: :destroy_page  \nend\n</code></pre>\n\n<p>Here is my model:</p>\n\n<pre><code>class Page &lt; ActiveRecord::Base\nresourcify\nattr_accessible :content, :name, :permalink\nvalidates_uniqueness_of :permalink\n\ndef to_param\npermalink\nend\nend\n</code></pre>\n\n<p>My controller update method:</p>\n\n<pre><code>def update\n@page = Page.find_by_permalink!(params[:page])\n\nrespond_to do |format|\n  if @page.update_attributes(params[:page])\n    format.html { redirect_to @page, notice: 'Page was successfully updated.' }\n    format.json { head :no_content }\n  else\n    format.html { render action: \"edit\" }\n    format.json { render json: @page.errors, status: :unprocessable_entity }\n  end\nend\nend\n</code></pre>\n\n<p>My error: undefined method `stringify_keys' for \"test\":String</p>\n\n<p>I've researched other 'stringify_keys' errors but couldn't find anything similar to this. Thanks for your help.</p>\n"},{"tags":["ruby-on-rails-3","join","scope"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12984230,"title":"Rails 3: Using scope on a joins statement","body":"<p>I'm working with some old code where major refactoring isn't an option. The following line of code:</p>\n\n<pre><code>Address.joins(:contact =&gt; :user).where('users.organization_id = ?', session[:org_id])\n</code></pre>\n\n<p>produces a list of addresses. Addresses are linked to the Contacts table, which is in turn linked to the Users table.</p>\n\n<p>I need a way to only join on certain users within a certain scope, say User.active or User.inactive.</p>\n\n<p>Is there a way I can do this without major refactors to my database?</p>\n"},{"tags":["ruby-on-rails-3","nested-forms","simple-form"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":321,"score":1,"question_id":10791927,"title":"Can't mass-assign protected attributes for nested form using cocoon and simple_forms in Rails 3 App","body":"<p><strong>The Problem:</strong> </p>\n\n<p>I am getting an error message when submitting my form that says:</p>\n\n<blockquote>\n  <p>ActiveModel::MassAssignmentSecurity::Error in AdmissionRecordsController#create</p>\n  \n  <p>Can't mass-assign protected attributes: admission_record</p>\n</blockquote>\n\n<p><strong>My Setup:</strong> </p>\n\n<p>I am using Rails 3.2.3, with extra gems including Cocoon 1.0.14 and Simple_Form 2.0.2</p>\n\n<p><strong>The View:</strong></p>\n\n<p>My <code>app/views/admission_records/_form.html.haml</code> looks like:</p>\n\n<pre><code>= simple_form_for [@admission, @record] do |f|\n  = f.simple_fields_for :vital_signs, @record.vital_signs.build do |vs|\n    = render :partial =&gt; \"vital_sign_fields\", :locals =&gt; { :f =&gt; vs }\n    = link_to_add_association \"Add Vital Signs\", f, :vital_signs\n  = f.submit\n</code></pre>\n\n<p>And my <code>app/views/admission_records/_vital_sign_fields.html.haml</code> looks like:</p>\n\n<pre><code>.nested-fields\n  = f.label :sbp\n  = f.text_field :sbp\n  ...\n  = link_to_remove_association \"Remove Vital Sign\"\n</code></pre>\n\n<p>What I am basically trying to do is that I have a resource called AdmissionRecord nested within another resource called PatientAdmission (<code>route.rb</code> shown below). I have another resource called <code>VitalSign</code> which I want to be able to create via a nested form (using cocoon and simple_form) when creating the <code>AdmissionRecord</code></p>\n\n<p>My <code>config/routes.rb</code> file looks like:</p>\n\n<pre><code>resources :patient_admissions do\n  resources :admission_records\nend\n</code></pre>\n\n<p><strong>The Models:</strong></p>\n\n<p>My <code>app/models/patient_admission.rb</code> looks like:</p>\n\n<pre><code>class PatientAdmission &lt; ActiveRecord::Base\n  has_many :admission_records, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>My <code>app/models/admission_record.rb</code> looks like:</p>\n\n<pre><code>class AdmissionRecord &lt; ActiveRecord::Base\n  belongs_to :patient_admission\n  has_many :vital_signs, :dependent =&gt; :destroy\n\n  accepts_nested_attributes_for :vital_signs, :rejects_if =&gt; :all_blank, :allow_destroy =&gt; true\n  attr_accessible :vital_signs_attributes\nend\n</code></pre>\n\n<p>And my <code>app/models/vital_sign.rb</code> looks like:</p>\n\n<pre><code>class VitalSign &lt; ActiveRecord::Base\n  belongs_to :admission_record\n  attr_accessible # just fields that appear in the form\nend\n</code></pre>\n\n<p><strong>The Controller:</strong></p>\n\n<p>The <code>new</code> and <code>create</code> methods in my <code>AdmissionRecordsController</code> looks like:</p>\n\n<pre><code>before_filter do\n  @admission = PatientAdmission.find(params[:patient_admission_id])\nend\n\ndef new\n  @record = @admission.admission_records.build\nend\n\ndef create\n  @record = @admission.admission_records.build(params[:admission_record])\n  @vital_sign = @record.vital_signs.build(params[:vital_signs])\n  @vital_sign.save\n  if @record.save\n    # Flash success and redirect to the right place\n  else\n    # Flash error and render :new\n  end\nend\n</code></pre>\n\n<p><strong>The Plea:</strong></p>\n\n<p>Please help me find where I'm going wrong. I've googled for hours and have looked at other examples and source code for demo apps such as those found in <a href=\"https://github.com/nathanvda/cocoon_simple_form_demo/blob/master/app/views/projects/_form.html.slim\" rel=\"nofollow\">cocoon_simple_form_demo</a>, but still can't seem to fix this error. If there's any other piece of information needed to debug this problem, please let me know. Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","helpers"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":117,"score":0,"question_id":4867775,"title":"Need clarification, why the wrapper methods? Ruby on Rails Tutorial chapter 9 section 9.3.3 current-user -","body":"<p>I understand that the helpers are not generally accessible in controllers.  But why all the wrapping around a instance variable @current_user?</p>\n\n<p>Why does the helper have \"current_user=\" and \"current_user\" defined as methods?  Why can @current_user be all that is needed for this section?</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":441,"score":1,"question_id":5266281,"title":"Have Devise failed validation remain on same URL?","body":"<p>I'm trying to do this <a href=\"http://stackoverflow.com/questions/1083798/use-custom-route-upon-model-validation-failure\">Use custom route upon model validation failure</a> with <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow\">Devise</a>, and I'm not having any luck.</p>\n\n<p>I've got my routes specified like this:</p>\n\n<pre><code># authentication routing\ndevise_for :users do\n  get \"/login\" =&gt; \"devise/sessions#new\"\n  get \"/logout\" =&gt; \"devise/sessions#destroy\"\n  get \"/register\" =&gt; \"devise/registrations#new\"\nend\n</code></pre>\n\n<p>But when validation fails, say on the <code>/register</code> page, the URL changes back to <code>/users</code>.</p>\n\n<p>I want the URL to stay at <code>/register</code> when validation fails. How would I do this?</p>\n"},{"tags":["ruby-on-rails-3","rmagick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12981232,"title":"Displaying a thumbnail with RMagick in Rails","body":"<p>I just installed RMagick and am trying to display a thumbnail of any image I throw at it on my webpage.  But the code from the tutorial opens up a new window in order to show my image.  Here's what I have.</p>\n\n<pre><code>require 'RMagick'\n\nclass StaticPagesController &lt; ApplicationController\n  include Magick\n\n  def home\n    @cat = ImageList.new(\"app/assets/images/me.jpg\")\n  end\nend\n</code></pre>\n\n<p>and the view:</p>\n\n<pre><code>&lt;%= @cat.display %&gt;\n</code></pre>\n\n<p>I want the image to be displayed on the page instead a new window pops up displaying the image and this is displayed on the page: </p>\n\n<p><code>#&lt;Magick::ImageList:0x007f564804bb18&gt;</code></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I need to resize the image before I display it.</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12983156,"title":"Can i change the default scope depending on the type of operation","body":"<p>Is it possible to change my default scope if i'm looking for a single result rather than a collection?</p>\n\n<p>i.e. Model.find(id) vs Model.all</p>\n\n<p><code>default_scope lambda { where({:language_id =&gt; Language.default_or_first.id}) }</code> </p>\n\n<p>I really only want to scope my index views this way when i find a whole segment of records.</p>\n\n<p>When i do a Model.find(3) i'd like it to give it to me even if the its not in the default language.</p>\n"},{"tags":["ruby-on-rails-3","email","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":34,"score":2,"question_id":12984652,"title":"ActionMailer debugging","body":"<p>I'm trying to use <a href=\"http://railscasts.com/episodes/206-action-mailer-in-rails-3\" rel=\"nofollow\">Action Mailer</a> in Rails to send email to users.    </p>\n\n<pre><code>def create\n  ...\n  if @post.save\n    UserMailer.archive_confirmation(@site).deliver\n  end\nend\n</code></pre>\n\n<p>But when I try it, I don't get any email, and I have no idea how to debug (since the <code>create</code> method runs successfully, and everything else goes as expected, there's no error message) Where could <code>ActionMailer</code> go wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","gmail"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12984447,"title":":domain, :user_name, and :password in ActionMailer","body":"<pre><code>ActionMailer::Base.smtp_settings = {\n  :address              =&gt; \"smtp.gmail.com\",\n  :port                 =&gt; 587,\n  :domain               =&gt; ???,\n  :user_name            =&gt; ???,\n  :password             =&gt; ???,\n  :authentication       =&gt; \"plain\",\n  :enable_starttls_auto =&gt; true\n}\n</code></pre>\n\n<p>I'm trying to use <a href=\"http://railscasts.com/episodes/206-action-mailer-in-rails-3\" rel=\"nofollow\">Action Mailer</a> in Rails to send email to users. I don't quite understand what should go into <code>:domain</code>, <code>:user_name</code>, and <code>:password</code>. Should it be <code>gmail.com</code>, my Gmail username, and my Gmail password?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","vps","linode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12979183,"title":"after deploy with delayed_job, all memory is occupied","body":"<p>I have a linode 512 mb ram with ubuntu 10.04 64 bits with a rails app + mongodb + nginx + unicorn.</p>\n\n<p>I use <a href=\"http://sunspot.github.com/\" rel=\"nofollow\">sunspot solr gem</a> and <a href=\"https://github.com/collectiveidea/delayed_job\" rel=\"nofollow\">delayed_job gem</a></p>\n\n<p>When I make a new deploy with delayed job: </p>\n\n<pre><code>after \"deploy:restart\",   \"delayed_job:start\"\n</code></pre>\n\n<p>The server go very very slow and very very bad.</p>\n\n<p>If I write in terminal:</p>\n\n<pre><code>free -m\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>             total       used       free     shared    buffers     cached\nMem:           487        481          5          0          1         16\n-/+ buffers/cache:        463         23\nSwap:          255        226         29\n</code></pre>\n\n<p>I get errors like <code>Errno::ENOMEM (Cannot allocate memory...</code> on my rails log.</p>\n\n<p><strong>My question is if I need upgrade my linode or change to dedicated server to work with delayed_job gem</strong></p>\n\n<p>I have been taking a look to <a href=\"http://www.hetzner.de/en/\" rel=\"nofollow\">http://www.hetzner.de/en/</a> for dedicated server.</p>\n\n<p><strong>If I need upgrade my linode, How much memory do I need to run properly delayed_job gem?</strong></p>\n\n<p>Delayed job in my local ubuntu machine with 4GB ram is working fine.</p>\n\n<p>Thank you very much</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":6,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":1250,"score":2,"question_id":3910131,"title":"Rails 3 - How to Not to Error if no record is found","body":"<p>In my permissions controller, I use Active record to look for a permission:</p>\n\n<pre><code>@permission = Permission.find(params[:user_id])\n</code></pre>\n\n<p>If this returns a result I then look up the permission.name And pass this to my controller.</p>\n\n<p>Problem is sometimes this does returna result, othertimes it does not. When it does not, it errors. How can I prevent that from occuring?</p>\n\n<p>Use Case:\n1. If the user does have a permission record, show it and let the user change it\n2. If not, show they don't have a permission record and allow the user to set a permission.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12983815,"title":"How do I use an array of an array of strings to match another string?","body":"<p>I have a list of messy titles (lets say 1000 of them). These titles I want to analyze for \"keywords\" that match a small number of genres that I have created (the titles arent a model, but the genres are).  </p>\n\n<p>For example, say the first title string is <code>\"awesome playlist of house, EDM and ambient\"</code></p>\n\n<p>Now, say I also have 15 <code>Genres</code>, each with an attribute <code>name</code></p>\n\n<p>My end goal is I want to assign genres to that title string. This is easy enough by doing some string normalization, and then using <code>.include?</code></p>\n\n<p>But it doesnt help if there are synonyms. For example, my @genre.name is called <code>chill</code>, which SHOULD apply to <code>ambient</code> on the string above. Likewise, my @genre.name for dance music is called <code>dance</code>, and should include <code>EDM</code> in the string above (edm = electronic dance music)</p>\n\n<p>So what I'd love to do is for each genre add in 10 or so synonyms so it can check for those as well.</p>\n\n<p>The problem is I'm not sure how to go about doing this in the loop.. I guess a loop inside a loop?</p>\n\n<p>This is my code for a 'single level', without synonyms</p>\n\n<pre><code>  def determine_genres(title)\n    relevant_genres = []\n    @genres.each do |genre|\n      if normalize_string(title).include? normalize_string(genre.name)\n        relevant_genres &lt;&lt; genre.id\n      end\n    end\n    relevant_genres\n  end\n</code></pre>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","sass","sprockets"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12973508,"title":"Page Specific Sass files and Duplication","body":"<p>I am really struggling to structure the Sass files in a Rails 3.1 project to avoid massive duplication ...</p>\n\n<p>I have the following structure, with application.css.scss being imported as part of my main layout:</p>\n\n<pre><code>application.css.scss\n  - [*= require] main.css.scss\n      - [@import] 'variables';\n      - [@import]'bootstrap_overrides';\n      - [@import]'bootstrap';\n      - [@import]'base_elements';\n      - [@import]'superstructure';\n      - [@import]'modules';\n</code></pre>\n\n<p>So far so good. All these files are combined by sprockets into a single document. However I then want to modularise my Sass further, with page-specific files or files shared across regions of my site.</p>\n\n<p>So on my GalleryResource#show page I need to use additional Sass files:</p>\n\n<pre><code>resource.scss\ngallery_resource.scss\nbadges.scss\n</code></pre>\n\n<p>And maybe a css file from a lib:</p>\n\n<pre><code>gallery_lib.scss\n</code></pre>\n\n<p>These files need to reference a number of the files already imported in application.css. They need to make use of variables defined in variables.css.scss and of mixins defined in bootstrap. So I am forced to reimport these files in each file that uses them, causing massive duplication. I could write a manifest file for each and every page, but this is a maintenance nightmare and still results in duplication and two css files; application.css and page_specific.css.</p>\n\n<p>So what is the solution? Do I need to dispence with application.css and move its imports into each page-specific file? So using the above example I would end up with a single manifest file that looks like this:</p>\n\n<pre><code>gallery_resource_manifest.css.scss\n      - [*= require] gallery_lib.css\n      - [*= require] gallery_resource.css.scss\n         - [@import] 'variables';\n         - [@import]'bootstrap_overrides';\n         - [@import]'bootstrap';\n         - [@import]'base_elements';\n         - [@import]'superstructure';\n         - [@import]'modules';\n         - [@import]'resource';\n         - [@import]'gallery_resource';\n         - [@import]'gallery';\n         - [@import]'badges';\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12981273,"title":"Pass arguments into redirect_to(@post)","body":"<p>From my Rails controller, in the <code>create</code> method I want to do</p>\n\n<pre><code>redirect_to @post(:notice =&gt; \"Post successful', :status =&gt; \"Success!\")\n</code></pre>\n\n<p>and access the parameters in <code>show.html.erb</code> by using <code>&lt;%= notice %&gt;</code> and <code>&lt;%= status %&gt;</code></p>\n\n<p>But it doesn't work. How can I fix it?</p>\n\n<p><code>routes.rb</code> file:</p>\n\n<pre><code>Archive::Application.routes.draw do\n  resources :posts\n  root :to =&gt; \"Posts#new\"\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","subdomain","subdomains","wildcard-subdomain"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":477,"score":0,"question_id":8421635,"title":"rails subdomain","body":"<p>I went to this tutorial <a href=\"http://railscasts.com/episodes/221-subdomains-in-rails-3?autoplay=true\" rel=\"nofollow\">http://railscasts.com/episodes/221-subdomains-in-rails-3</a> and trying to implement in <a href=\"http://ngtv2.info\" rel=\"nofollow\">http://ngtv2.info</a> </p>\n\n<p>but after I place the code in routes.rb </p>\n\n<p><i>match '/' => 'projects#show', :constraints => { :subdomain => /.+/ }</i></p>\n\n<p>and then typed <a href=\"http://kingpangilinan.ngtv2.info\" rel=\"nofollow\">kingpangilinan.ngtv2.info</a> </p>\n\n<p>the browser says that \"Server not found\", <i>Firefox can't find the server at kingpangilinan.ngtv2.info</i></p>\n\n<p>Any help is appreciated.</p>\n"},{"tags":["ruby-on-rails-3","oauth"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12963233,"title":"Rails Doorkeeper - Redirect to homepage instead of authorize page","body":"<p>I have a weird problem when I try to use door_keeper gem with rails app. The problem occurs when I use Oauth2 gem to get the token. But at the part I have url : </p>\n\n<p><code>http://0.0.0.0:3000/oauth/authorize?response_type=code&amp;client_id=199f27a02764f1ef1d31c2860b83ef93c0cc3dc26886d2b3d76b8ef1e935f3ae&amp;redirect_uri=http%3A%2F%2F0.0.0.0%3A3000%2Fcallback</code></p>\n\n<p>it doesn't redirect to the page we authorize and get token but it redirects directly to <code>http://0.0.0.0:3000</code></p>\n\n<p>what's the problem I have here, it should redirect to application authorize page first, shouldn't it ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","partial-views"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12969415,"title":"How can I render an HTML view while constructing a JSON response in Rails?","body":"<p>I have a controller method that returns JSON. But sometimes part of that JSON object should include a rendered, serialized HTML view. So my controller method has a line like this:</p>\n\n<pre><code>html = render_to_string :partial =&gt; 'foo/bar'\n# ...\nrender json: {x: 'y', html: html}\n</code></pre>\n\n<p>But that fails because Rails is only looking for JSON views!</p>\n\n<blockquote>\n  <p>ActionView::MissingTemplate (Missing partial foo/bar with {:locale=>[:en], :formats=>[:json], :handlers=>[:erb, :builder, :coffee, :slim, :haml]}. […]</p>\n</blockquote>\n\n<p>How can I solve this?</p>\n\n<hr>\n\n<p><strong>Update</strong>: I have gotten one \"level\" of layout to <code>render_to_string</code> as html using the below syntax, but the same error persists when that layout renders its own partials!</p>\n\n<pre><code>html = render_to_string :partial =&gt; \"foo/bar.html.haml\"\n</code></pre>\n\n<p>Surely there’s a solution here, right?</p>\n\n<hr>\n\n<p><strong>Update 2</strong>: <code>render_to_string :action =&gt; 'method_in_this_controller'</code> seems to be doing the trick.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","datetime"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":698,"score":2,"question_id":7621322,"title":"Ruby find next Thursday (or any day of the week)","body":"<p><strong>OBJECTIVE:</strong> What is the best way to calculate the Date, Month, and Year of the next Thursday (or any day) from today in Ruby?</p>\n\n<p>SOLUTION: DateTime.now.next_week.next_day(3)</p>\n\n<p><strong>UPDATE</strong> In order to create dummy objects, I'm trying to figure out how to calculate a random time. In all, I'd like to produce a random time between 5 and 10 PM on the next Thursday of the week.</p>\n\n<p>SOLUTION TO UPDATE: See comment on accepted answer.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12982083,"title":"Recent item - Routing error","body":"<p>I'm encountering a really strange behaviour in my rails app. Basicaly, user is able to upload photo. The model for those photos is called user_photo. The thing is that allways, when i'll try to access the most recently added item (using the URL generated by <code>user_photo_path(@user_photo)</code>, let's say it's <code>http://localhost:3000/user_photos/20</code>), i'm getting this error:</p>\n\n<blockquote>\n  <p>No route matches {:action=>\"show\", :controller=>\"user_photos\", :id=>nil}</p>\n</blockquote>\n\n<p>This happens <strong>just to most recently added item</strong> which means that if i have a recently added <code>user_photo</code> with <code>:id =&gt; 20</code> it will cause the routing error; however, if i'll create the new one (with <code>:id =&gt; 21</code>), the previous user_photo which id is 20 will start to work.</p>\n\n<p>Have you any idea what can be causing this strange behaviour? I'm running my rails app in dev env using apache2 + passenger</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12982136,"title":"how to process a file exactly once for an rspec suite?","body":"<p>I've got what is essentially a fixture in the form of an XML file that needs to be loaded exactly once at the beginning of my test suite.</p>\n\n<p>I know before(:all) is meant for situations like this, but using it for some reason causes the database state to be preserved across rspec runs for the test suite.</p>\n\n<p>Right now I have this at the top of the test file:</p>\n\n<pre><code>describe MyTests do\n  before do\n    DataImporter.parse RULE_IMPORT_FILE\n  end\n</code></pre>\n\n<p>This works but it's really slow and re-processes the XML file and makes fresh inserts into the test DB over and over and over and over again.</p>\n\n<pre><code>describe MyTests do\n  before(:all) do\n    DataImporter.parse RULE_IMPORT_FILE\n  end\n</code></pre>\n\n<p>What happens here is that the DB doesn't clear between runs, so becomes polluted with lots of extra data which causes the tests to fail. I have to run a rake db:test:prepare to reset the DB.</p>\n\n<p>I thought it might be because I'm using spork, but even without spork running the database still maintains state across rspec runs.</p>\n\n<p>Anyone seen this before?</p>\n\n<p>The solution that I'm using currently is to use the DatabaseCleaner gem right before the tests:</p>\n\n<pre><code>describe MyTests do\n  before(:all) do\n    DatabaseCleaner.clean\n    DataImporter.parse RULE_IMPORT_FILE\n  end\n</code></pre>\n\n<p>Anyone else see this? Is there a better way to handle this situation?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12980545,"title":"How to set a foreign key in an association that is further away?","body":"<p>I have an application where a <code>user</code> can have many <code>people</code> which can have many <code>projects</code> which can have many <code>invoices</code>.</p>\n\n<p>in my <code>invoice</code>controller I have this action:</p>\n\n<pre><code>def create\n  project = current_user.projects.find(params[:invoice][:project_id])    \n  @invoice = project.invoices.build(params[:invoice])\n  if @invoice.save\n    flash[:success] = \"Invoice created.\"\n    redirect_to invoices_path\n  else\n    render :action =&gt; \"new\"\n  end\nend\n</code></pre>\n\n<p>The problem is that it throws an error whenever there is no <code>project_id</code>.</p>\n\n<p>I understand that and tried something like this instead...</p>\n\n<pre><code>@invoice = current_user.people.projects.invoices.build(params[:invoice])\n</code></pre>\n\n<p>...but I get an <code>undefined method projects</code> error then.</p>\n\n<p>I just want to make sure that a new <code>invoice</code> will automatically associated with the correct <code>user</code> and that nobody can tamper with it.</p>\n\n<p>Is there any way to do that?</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":3232,"score":0,"question_id":3983716,"title":"Ruby On Rails 3 submit form AJAX update results in div","body":"<p>I am stuck; I did a search and I can't find a pointer on how to get this project to work. I have a form on my index.html.erb as:</p>\n\n<pre><code>&lt;html&gt;   &lt;head&gt;\n    &lt;title&gt;Ajax List Demo&lt;/title&gt;   &lt;h1&gt;Listing posts&lt;/h1&gt; \n\n    &lt;%= javascript_include_tag \"prototype\" %&gt;   &lt;/head&gt;   &lt;body&gt;\n    &lt;h3&gt;Add to list using Ajax&lt;/h3&gt;\n    &lt;% form_tag (  :remote=&gt;true, :update =&gt; 'my_list', :action =&gt; :list , :method=&gt;:post, :format =&gt;:xml ) do %&gt;\n\n      Enter the url:\n      &lt;%= text_field_tag 'url' ,'', :size =&gt; 80 %&gt;\n      &lt;%= submit_tag \"Find\" %&gt;\n    &lt;% end %&gt;\n    &lt;div id=\"my_list\"&gt;&lt;%= render :partial =&gt; 'profiles/list' %&gt;&lt;/div&gt;   &lt;/body&gt; &lt;/html&gt;\n</code></pre>\n\n<p>Now I have a div with this called my_list. When I submit the form I want my partial _list.html.erb (inside profiles dir, tried home dir too) to update with the results of list.</p>\n\n<p>My home controller has this method:</p>\n\n<pre><code>def list\n    puts \"here!!!!\"\n   reader = Reader.new\n  @profiles =  reader.processURL(params[:url])\n    render :partial=&gt;'profiles/list', :locals =&gt; { :profiles =&gt; @profiles}\nend\n</code></pre>\n\n<p>I end up getting this error:</p>\n\n<pre><code>ActionView::MissingTemplate (Missing partial profiles/list with {:locale=&gt;[:en, :en], :handlers=&gt;[:rjs, :builder, :rhtml, :rxml, :\nerb], :formats=&gt;[:xml]} in view paths \"C:/Users/....tree/app/views\"):\n  app/controllers/home_controller.rb:22:in `list'\n\nRendered C:/Ruby187/lib/ruby/gems/1.8/gems/actionpack-3.0.0/lib/action_dispatch/middleware/templates/rescues/missing_template.erb\nwithin rescues/layout (1.0ms)\n</code></pre>\n\n<p>Could anyone help me or send me in the right direction to understand how to update a div rendering via Rails on form submit?  Thanks again.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12981398,"title":"Unpredictable routing error for 'show' action","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/12982083/recent-item-routing-error\">Recent item - Routing error</a>  </p>\n</blockquote>\n\n\n\n<p>I'm encountering a really strange behaviour in my rails app. Basicaly, user is able to upload photo (using carrierwave, basic scaffold-generated form). The model for those photos is called <code>user_photo</code>. Here is my routing file:</p>\n\n<p><strong>routing.rb</strong></p>\n\n<pre><code>Myapp::Application.routes.draw do\n  #...\n\n  match 'profiles/:profile_id/photos' =&gt; 'user_photos#index_profile', :as =&gt; :profile_user_photos\n  match 'user_photos/vote/:id'   =&gt; 'user_photos#vote',       :as =&gt; :user_photo_vote\n  resources :user_photos do\n    resources :comments\n  end\n\n  #...\nend\n</code></pre>\n\n<p>And now, when i'm trying to access some of photos uploaded by users using the following URL pattern:</p>\n\n<pre><code>http://localhost:3000/user_photos/31 (this is just an example)\n</code></pre>\n\n<p>i'm getting this error:</p>\n\n<blockquote>\n  <p>No route matches {:action=>\"show\", :controller=>\"user_photos\",\n  :id=>nil}</p>\n</blockquote>\n\n<p>The strange thing is that some of user_photos works, it's totally unpredictable! I'm not sure what is probably causing this error so i have posted just my routing file (cause it's the first thing that comes to my mind). If you have any ideas or need anything more to understand what's going on, please just let me know. Thanks in advance.</p>\n\n<hr>\n\n<h3>Edit:</h3>\n\n<p>Ok, actually it's predictable. Only the last uploaded user_photo is not working, when i'll upload the next one, previous one which was not working starts to work. Any ideas?</p>\n\n<p>This thread is continued here: <a href=\"http://stackoverflow.com/questions/12982083/recent-item-routing-error\">Recent item - Routing error</a></p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":12980998,"title":"Rails model associates another model more than once","body":"<p>I got a model called Pages that looks like this:</p>\n\n<pre><code>title\ndescription\nimage_id\nbackground_image\nlogo\n</code></pre>\n\n<p>I also got a model calles Images that looks like this:</p>\n\n<pre><code>id\ntitle\n</code></pre>\n\n<p>What I would like to be able to is to associate these three fields with the image model.</p>\n\n<pre><code>image_id\nbackground_image\nlogo\n</code></pre>\n\n<p>image_id works perfectly because of the Page model association:</p>\n\n<pre><code>has_many :images\n</code></pre>\n\n<p>How do I make it work with background_image and logo?\n Hope my question makes any sense. Thanks</p>\n\n<p><strong>UPDATE</strong>\n<img src=\"http://i.stack.imgur.com/nIMMH.gif\" alt=\"enter image description here\"></p>\n"},{"tags":["ruby-on-rails-3","activeadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12395012,"title":"activeadmin formatting error on rails 3 app","body":"<p>I recently migrated a rails 3 app from a Mac OS X environment to a Debian server. The migration succeeded, the app is running through the WEBrick server but the formatting that had originally come with the activeadmin gem has disappeared from most views. The form is still accessible and functioning but it is in the default html formatting.</p>\n\n<p>However <a href=\"http://domainexample.com:3000/admin\" rel=\"nofollow\">http://domainexample.com:3000/admin</a> still has the custom formatting, any ideas of why this has happened?</p>\n\n<p>In my troubleshooting:\nreinstalled activeadmin with</p>\n\n<pre><code>rails generate active_admin:install\n</code></pre>\n\n<p>When I run </p>\n\n<pre><code>rake db:migrate\n</code></pre>\n\n<p>got devise errors so dropped the databases and ran</p>\n\n<pre><code>rake db:create\n</code></pre>\n\n<p>rails s still works and boots the server but</p>\n\n<p>rake db:migrate throws an error:</p>\n\n<pre><code>Mysql2::Error: Table 'admin_users' already exists \n</code></pre>\n\n<p>UPDATE:\nThis fixed the problem, but I don't understand why.</p>\n\n<p>had to copy the active_admin.css as active_admin.css.dup.css file from my local and upload it to the server version in app/assets/stylesheets. The server version was implementing namespaces for some reason.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12978447,"title":"Can 'rails g controller' generate restful routes?","body":"<p>Is there a way, using rails generators, to create a controller with RESTful routes?</p>\n\n<p>Generating a controller and specifying the action name creates a controller and adds a route to <code>config/routes.rb</code>, but <code>create</code> is a <code>get</code>:</p>\n\n<pre><code>$ rails g controller foos new create\n  create  app/controllers/foos_controller.rb\n   route  get \"foos/create\"\n   ...\n</code></pre>\n\n<p>I'd prefer to see <code>route post \"foos\"</code>, but don't see anything useful in <code>rails g controller --help</code></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","roles"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12972280,"title":"How can a user with same role can access different posts with different permission?","body":"<p>I use devise for authentication and i have assigned a role for each user and i have one more model <code>posts</code> which contain number of posts and i want to restrict one user of the role <code>employee</code> to view the specific post and the same user to view and create the different post. How can i do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","deployment","ruby-on-rails-3.2","unicorn"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":104,"score":4,"question_id":12510386,"title":"Can't launch rails app via unicorn due to kgio_ext (LoadError)","body":"<p>I am trying to run a rails app via </p>\n\n<pre><code>unicorn -c config/environments/&lt;env&gt;/unicorn.rb -e &lt;env&gt;\n</code></pre>\n\n<p>but I keep getting this error.</p>\n\n<pre><code>&lt;app_root&gt;/vendor/bundle/ruby/1.9.1/gems/kgio-2.7.4/lib/kgio.rb:21:in `require': cannot load such file -- kgio_ext (LoadError)\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>I am running unicorn (4.3.1) with kgio (2.7.4) in a rails (3.2.3) app.</p>\n"},{"tags":["ruby-on-rails-3","form-helpers"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":353,"score":0,"question_id":7827138,"title":"Rails 3 - Make a \"link_to\" using selected value from collection select","body":"<hr>\n\n<p>Hello everyone.</p>\n\n<p>I have a form in my rails 3 app, and one of the fields is a \"collection select\" like this</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n&lt;%= f.label :provider_id, \"Provider\" %&gt;\n&lt;%= collection_select( :purchase_document, :provider_id, Provider.all, :id, :name) %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The idea, is to be able to add a \"link_to\" using the selected value from the \"collection select\" i.e.:</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;%= f.label :provider_id, \"Provider\" %&gt;\n    &lt;%= collection_select( :purchase_document, :provider_id, Provider.all, :id, :name) %&gt; &lt;%= link_to \"Show\", provider_path(***selected option from collection select***)%&gt;\n</code></pre>\n\n<p>But, I don't know how to get the selected value.\nIs there a rails way to do that?</p>\n\n<p>Hope you can help me, thanks\n    </p>\n"},{"tags":["ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":298,"score":1,"question_id":9188503,"title":"Reading Excel/xls ,csv,ods file in rails 3","body":"<p>I am using paperclip to upload the (Excel/xls , csv, ods) files. Now i want to import the data from those files. Which gem to use ??? </p>\n\n<p>I am using gem spreadsheet but is there any alternate gem for doing so ??</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","excel","rake-task"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":176,"score":0,"question_id":7605991,"title":"Rails to_xls in rake task","body":"<p>I am trying to use the rails to_xls gem in my rake task. My code is:</p>\n\n<pre><code>tmp_file = Tempfile.new(['export_test', '.xls'])\nToXls::ArrayWriter.new(@logins_report, :name =&gt; 'export_test').write_io(tmp_file)\n</code></pre>\n\n<p>I receive an error that says \"rake aborted! uninitialized constant ToXls\" Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","csv","data-import"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":447,"score":0,"question_id":10121961,"title":"Rails import from csv to model","body":"<p>I have a csv file with dump data of table and I would like to import it directly into my database using rails.</p>\n\n<p>I am currently having this code:</p>\n\n<pre><code>csv_text = File.read(\"public/csv_fetch/#{model.table_name}.csv\")\nActiveRecord::Base.connection.execute(\"TRUNCATE TABLE #{model.table_name}\")\nputs \"\\nUpdating table #{model.table_name}\"\ncsv = CSV.parse(csv_text, :headers =&gt; true)\ncsv.each do |row|\n  row = row.to_hash.with_indifferent_access\n  ActiveRecord::Base.record_timestamps = false\n  model.create!(row.to_hash.symbolize_keys)\nend\n</code></pre>\n\n<p>with help from <a href=\"http://stackoverflow.com/a/4410880/985051\">here</a>..</p>\n\n<p>Consider my Sample  csv:</p>\n\n<pre><code>id,code,created_at,updated_at,hashcode\n10,00001,2012-04-12 06:07:26,2012-04-12 06:07:26,\n2,00002,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode\n13,00007,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode\n43,00011,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode\n5,00012,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode\n</code></pre>\n\n<p>But problem with this code is :</p>\n\n<ul>\n<li>It is generating `id' as autoincrement 1,2,3,.. instead of what in \ncsv file.</li>\n<li>The timestamps for records where there is <code>0000-00-00 00:00:00</code> defaults to null automatically and throws error as the column created_at cannot be null...</li>\n</ul>\n\n<p>Is there any way I can do it in <strong>generic way to import from csv to models</strong>?\nor would i have to write custom code for each model to manipulate the attributes in each row manually??</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12979784,"title":"Devise not authenticating in Rails 3.2.8 or without account_id field","body":"<p>After signing in, a user is redirected a controller that is protected by authenticate_user!:</p>\n\n<pre><code>before_filter :authenticate_user! \n</code></pre>\n\n<p>In Rails 3.2.8, this does not authenticate and returns 'Completed 401 Unauthorized'.</p>\n\n<p>However, it works with Rails 3.2.7, but ONLY if I add the account_id to the form (HAML)</p>\n\n<pre><code>= f.hidden_field :account_id, :value =&gt; @account.id\n</code></pre>\n\n<p>With that hidden field added, I see this query in the log:</p>\n\n<pre><code>User Load (0.5ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"email\" = 'email@gmail.com' AND \"users\".\"account_id\" = 41 LIMIT 1\n</code></pre>\n\n<p>However, when I remove the account_id hidden field, no query for the user is performed, and the logs show same 'Completed 401 Unauthorized' message.</p>\n\n<p>It doesn't work in Rails 3.2.8, with or without the account_id.</p>\n\n<p>I'm on the latest Devise (2.1.2)</p>\n\n<p>This issue has been bugging me for a long time, so any help is greatly appreciated.</p>\n\n<p>EDIT:</p>\n\n<p>I have this in my routes.rb:</p>\n\n<pre><code>devise_for :users, :controllers =&gt; { :passwords =&gt; \"passwords\", :sessions =&gt; \"sessions\", :omniauth_callbacks =&gt; \"users/omniauth_callbacks\" }\n</code></pre>\n\n<p>and my initializers/devise.rb:</p>\n\n<pre><code>Devise.setup do |config|\n  # ==&gt; Mailer Configuration\n  # Configure the e-mail address which will be shown in DeviseMailer.\n  config.mailer_sender = \"info@mydomain.com\"\n\n  # Configure the class responsible to send e-mails.\n  # config.mailer = \"Devise::Mailer\"\n\n  # ==&gt; ORM configuration\n  # Load and configure the ORM. Supports :active_record (default) and\n  # :mongoid (bson_ext recommended) by default. Other ORMs may be\n  # available as additional gems.\n  require 'devise/orm/active_record'\n\n  # omniauth stuff\n  require \"omniauth-facebook\"\n  require 'openid/store/filesystem'\n  config.omniauth :facebook, \"#key\", \"#secret\"\n  config.omniauth :open_id, :store =&gt; OpenID::Store::Filesystem.new('/tmp'), :name =&gt; 'google', :identifier =&gt; 'https://www.google.com/accounts/o8/id', :require =&gt; 'omniauth-openid'\n\n  # ==&gt; Configuration for any authentication mechanism\n  # Configure which keys are used when authenticating a user. The default is\n  # just :email. You can configure it to use [:username, :subdomain], so for\n  # authenticating a user, both parameters are required. Remember that those\n  # parameters are used only when authenticating and not when retrieving from\n  # session. If you need permissions, you should implement that in a before filter.\n  # You can also supply a hash where the value is a boolean determining whether\n  # or not authentication should be aborted when the value is not present.\n  config.authentication_keys = [ :email, :account_id ]\n\n\n  # Configure which authentication keys should be case-insensitive.\n  # These keys will be downcased upon creating or modifying a user and when used\n  # to authenticate or find a user. Default is :email.\n  config.case_insensitive_keys = [ :email ]\n\n  # Configure which authentication keys should have whitespace stripped.\n  # These keys will have whitespace before and after removed upon creating or\n  # modifying a user and when used to authenticate or find a user. Default is :email.\n  config.strip_whitespace_keys = [ :email ]\n  config.stretches = 10\n\n  config.reset_password_within = 2.hours\n  config.navigational_formats = [:\"*/*\", \"*/*\", :html, :mobile]\n\n  config.sign_out_via = :delete\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","xml","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":255,"score":1,"question_id":8159073,"title":"Import from XML and CSV with Rails","body":"<p>I'm building a website that is going to import products from several different sources. I will start with some XML import and later I might have to implement CSV import as well. It will fetch the XML from a URL and then check each post and see if the product already exists, if it does, check the price and update it if it has changed. I have heard good things about Nokogiri and will use that for the XML parsing. I will use Rails 3.1.1.</p>\n\n<p>I am pretty new to Rails and have some questions. I'm trying to build this app for learning Rails and also try some TDD.</p>\n\n<p>Should I build the import scripts as rake tasks? Is that a good approach?\nHow do I run these periodically then? Do I set up a cronjob as I do in PHP?</p>\n\n<p>The XML sources will differ some in structure, element names and so on so I guess I will have to create an import script for each source. Is this a good approach or can I somehow create a more generic import script and somehow map the different elements to the correct column in my database?</p>\n\n<p>Lots of questions... I hope someone can give me some tips and kick me in the right direction.</p>\n\n<p>Thanks,\nLinus</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","ruby-on-rails-3","multidimensional-array"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12931025,"title":"Copy a 2-D array to another array in Ruby","body":"<p>I have a statement like this in Ruby:</p>\n\n<pre><code>@mastertest = connection.execute(\"select code_ver from mastertest\")\n</code></pre>\n\n<p>So now I want to make a copy of this 2-D array, because if I do something like <code>@temp = @mastertest</code>, it makes changes to <code>@mastertest</code> when I make any changes to <code>@temp</code>.</p>\n\n<p>I tried using the following:</p>\n\n<pre><code>@temp = Marshal.load(Marshal.dump(@mastertest))\n</code></pre>\n\n<p>But this gives me an error saying <code>\"no marshal_dump is defined for class Mysql2::Result\"</code>. So I am assuming that the <code>@mastertest</code> is of some other type than a 2-D array. </p>\n\n<p>Can someone help me how to make a copy of this array?</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","csv"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":85,"score":0,"question_id":11547872,"title":"Parsing a CSV file with HTML tags into a Rails database?","body":"<p>I have a CSV file that I'm trying to import into a Rails database. I've written a rake task to do the parsing for me.</p>\n\n<pre><code>task :csv2, [:file] =&gt; :environment do |t, args|\n  CSV.foreach(args[:file]) do |row|\n    issue = {\n      \"element1\" =&gt; row[0],\n      \"element2\" =&gt; row[3]\n    }\n\n  Issue.create(issue)\nend\n</code></pre>\n\n<p>It works great, except for one problem. Sometimes, fields in the CSV have html tags and special characters (e.g. &lt; p> and &amp;QUOT ;). When I dump each column into the database, Rails just reads everything in as straight text. How do I get Rails to understand the HTML and adjust accordingly?</p>\n\n<p>Or, if this is a better option, I'll dump the HTML into the database, and just use the View to understand the HTML?</p>\n\n<p>Ruby 1.9.3, Rails 3.2.6, SQLite3 3.6.20.</p>\n\n<p>Thanks in advance for the help!</p>\n"},{"tags":["ruby-on-rails-3","file-upload","csv"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":139,"score":0,"question_id":10198556,"title":"parse csv files in rails","body":"<p>My app is a surveybuilder, and the user needs to upload their databases,I need to parse my csv data, I followed a lot of tutorials...but almost all of it are outdated, I could upload a file and save it in my mysql database, using javascript, but in js is not posible to parse it,I need to read the data inside my csv file to not allow bad formated data, when I use fastercsv or csv plugin...doesn´t works because I get some errors, somebody could help me, step by step?, thanks in advance, here is my code: </p>\n\n<p><strong>CONTROLLER</strong></p>\n\n<pre><code>class BdsController &lt; ApplicationController\n  def index\n    @bds = Bd.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render json: @bds }\n    end\n  end\n\n   def show\n    @bd = Bd.find(params[:id])\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @bd }\n    end\n  end\n\n  def new\n    @bd = Bd.new\n\n    respond_to do |format|\n      format.html # new.html.erb\n      format.json { render json: @bd }\n    end\n  end\n\n   def edit\n    @bd = Bd.find(params[:id])\n  end\n\n  def create\n    @bd = Bd.new(params[:bd])\n\n    respond_to do |format|\n      if @bd.save\n        format.html { redirect_to @bd, notice: 'Bd was successfully created.' }\n        format.json { render json: @bd, status: :created, location: @bd }\n      else\n        format.html { render action: \"new\" }\n        format.json { render json: @bd.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n   def update\n    @bd = Bd.find(params[:id])\n\n    respond_to do |format|\n      if @bd.update_attributes(params[:bd])\n        format.html { redirect_to @bd, notice: 'has subido tu base de datos exitosamente.' }\n        format.json { head :ok }\n      else\n        format.html { render action: \"edit\" }\n        format.json { render json: @bd.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  def destroy\n    @bd = Bd.find(params[:id])\n    @bd.destroy\n\n    respond_to do |format|\n      format.html { redirect_to bds_url }\n      format.json { head :ok }\n    end\n  end\ndef up    \n    file=params[:qqfile]\n    if request.xhr?\n      if request.body.length == request.headers['CONTENT_LENGTH'].to_i\n        file_data = request.body.read \n        file_name = file\n      end\n    else\n      if file.instance_of?(File)\n        file_data = file.read \n        file_name = file.original_filename\n      end\n    end    \n   @bd = Bd.new\n   @bd.filename = file_name\n   File.open(\"./public/images\" + file_name, 'wb') do |of|\n    of.write(file_data)\n   @bd.save\n    render :json =&gt; { :success =&gt; true }\n\n    end\n    end\n\n   def upload\n\n  end\n end\n</code></pre>\n\n<p><strong>VIEW</strong> generated by scaffold (_form, new, index, etc.) and this.</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n&lt;div id=\"demo\"&gt;&lt;/div&gt;\n&lt;ul id=\"separate-list\"&gt;&lt;/ul&gt;\n\n    &lt;script&gt;        \n        function createUploader(){            \n            var uploader = new qq.FileUploader({\n                element: document.getElementById('demo'),\n                listElement: document.getElementById('separate-list'),\n                action: 'up'\n                ,\n          params: {\n            authenticity_token: '#{ form_authenticity_token }'\n          }\n            });           \n        }        \n        window.onload = createUploader;     \n    &lt;/script&gt; \n\n&lt;%= link_to \"ver mis bases de datos\", bds_path %&gt; \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12979883,"title":"Using logger from Rack middleware","body":"<p>How do I properly log something from my own middleware which runs in a context of Rails application? Or, more generally, how do I detect that there's some logging middleware on the stack and use it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12979844,"title":"Rails 3.1, get No route matches [GET] \"/\" when trying to link_to XLS document in public directory","body":"<p>I use link_to helper with a XLS document in PUBLIC directory.</p>\n\n<p>I have migrated recently my rails APP from version 3.0.10 to version 3.1.8</p>\n\n<p>since migration, I live problem when I refer my XLS document with the link_to helper.</p>\n\n<p>I get the following error: \n<strong>Started GET \"/public/IMCClients.xls\" for 127.0.0.1 at 2012-10-19 13:11:35 -0400\nActionController::RoutingError (No route matches [GET] \"/public/IMCClients.xls\"):</strong></p>\n\n<p>How can I resolve my problem?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12979856,"title":"Migrating existing authentication to has_secure_password","body":"<p>In my application, I have two different user accounts. The old account type was using a custom built authentication system. The newer one implements has_secure_password. Now I'm ready to move the old account type to the same system. In the database, that user type has a hashed_password column. </p>\n\n<p>I have it working so that creating new users works, and they can login just fine on the new system. The problem is that I need existing users to be able to migrate their passwords from the hashed_password to password_digest. What is the best way to go about doing this?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12975395,"title":"Url missing action after model failure","body":"<p>I have a profile controller action UPDATE which updates a user's account information.  If the model is deemed invalid, I want to render my EDIT action like this:</p>\n\n<pre><code>if @user.valid?\n  #update\nelse\n  render 'edit'\nend\n</code></pre>\n\n<p>The URL for the EDIT action is /my_profile/edit.  However, when the <i>render 'edit'</i> code is processed upon failure, even though the correct view is displayed with appropriate errors, the URL that is loaded is /my_profile.</p>\n\n<p>When I'm editing a profile on /my_profile/edit, how can I get the URL /my_profile/edit to be loaded when I call the EDIT action upon model failure?</p>\n\n<p>Here are the current, applicable routes:</p>\n\n<pre><code>get 'my_profile' =&gt; 'my_profile#show'\nget 'my_profile/edit' =&gt; 'my_profile#edit', as: 'edit_my_profile'\nput 'my_profile' =&gt; 'my_profile#update'\n</code></pre>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":69,"score":0,"question_id":12960132,"title":"How to lock some rows in PostgreSQL when updating and let others to read?","body":"<p>I want to update some rows in a table, and I want to lock them so other processes don't update them as well at the same time. But I'd like other processes to read them.</p>\n\n<p>The way I'm trying to accomplish it is like this:</p>\n\n<pre><code>MyTable.where(mycolumn: \"some value\").lock(true).update_all(mycolumn: \"other value\")\n</code></pre>\n\n<p>I think that <code>lock(true)</code> is locking the selected rows (it's what the documentation says), but I don't know if they are available for other selects at the same time. So I think I should force a \"SHARE MODE\".</p>\n\n<p>I'm trying this:</p>\n\n<pre><code>MyTable.where(mycolumn: \"some value\").lock(\"LOCK IN SHARE MODE\").update_all(mycolumn: \"other value\")\n</code></pre>\n\n<p>But it raises this error:</p>\n\n<pre><code>STATEMENT:  SELECT  \"my_table\".* FROM \"my_table\"  WHERE \"my_table\".\"mycolumn\" = $1 LIMIT 1 LOCK IN SHARE MODE\nERROR:  syntax error at or near \"LOCK\" at character 74\n</code></pre>\n\n<p>It works on SQLite though.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":79,"score":1,"question_id":12947501,"title":"Refresh a partial after submiting form_for with remote: true","body":"<p>I have a form in a side bar, and when the form submits, I need to refresh only that particular partial from the side bar, not the entire page. The partial has a div id = \"class-id\" on it. </p>\n\n<p>partial.html.haml</p>\n\n<pre><code>- if class\n // display some stuff\n- else\n  = form_for [Class.new], remote: true do |f| \n    .field\n      = f.label :description\n      = f.text_field :description      \n    .actions\n      = f.submit\n</code></pre>\n\n<p>I need to reload this partial after the submit is finished, so that the first if will be accessed.  </p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","engine"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12978999,"title":"Using another gem's javascript in a Rails Engine","body":"<p>I'm trying to create a rails engine that will use javascript from a gem dependency that I have added.  However I keep getting \"couldn't find file 'fullcalendar'\" when I put the following line in my application.js for my engine:</p>\n\n<pre><code>//= require fullcalendar\n</code></pre>\n\n<p>This same line will work when the gem is installed on a normal rails app (not engine).  What am I missing here? Can an engine load javascript from another engine/gem?</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12691733,"title":"RefineryCMS with mutliple associated model in rails","body":"<p>I searched everything about how to generate association between two or more model using \"RefineryCMS\". I followed everything from this URL <a href=\"https://github.com/refinery\" rel=\"nofollow\">https://github.com/refinery</a> .\nI want to create two model with association. </p>\n\n<p>Anyone can please help me</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","ruby-on-rails-3","hash"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":3,"view_count":76,"score":-2,"question_id":12965791,"title":"Split an Array of arrays into 2 separate arrays in Ruby","body":"<p>I have a hash with some key value pairs as below:</p>\n\n<pre><code>@level2 = @l2.inject(Hash.new(0)) { |hash,element|\nhash[element] +=1\nhash }\n</code></pre>\n\n<p>I perform some sorting on the hash based on the keys. </p>\n\n<pre><code>@level2 = @level2.sort_by { |x, _| x }.reverse\n</code></pre>\n\n<p>Now I assume that the sort_by gives me an Array of Arrays. I want to split this into 2 arrays such that my first array should contain all keys and second array should contain all values. </p>\n\n<p>The hash#keys and hash#values are not accessible after sorting the hash. So that does not work in this case.</p>\n"},{"tags":["ruby-on-rails-3","query","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":174,"score":2,"question_id":6399058,"title":"Order by polymorphic belongs_to attribute","body":"<p>How do I make an ActiveRecord query that orders by an attribute of a polymorphic belongs_to association?</p>\n\n<p>For example I have model called <code>Tagging</code> that has a polymorphic belongs_to association named <code>tagged_item</code>.</p>\n\n<p>Unfortunately <code>Tagging.joins(:tagged_item)</code> throws a <code>ActiveRecord::EagerLoadPolymorphicError</code>. So I can't do something like <code>Tagging.joins(:tagged_item).order(\"tagged_item.created_at DESC\")</code>.</p>\n\n<p>Any suggestions?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","global-variables"],"answer_count":3,"favorite_count":3,"up_vote_count":11,"down_vote_count":0,"view_count":9670,"score":11,"question_id":3598785,"title":"Where to put Global variables in Rails 3","body":"<p>I used to put Global variables in environment.rb with my Rails 2.3.8 application such as:</p>\n\n<pre><code>MAX_ALLOWD_ITEMS = 6\n</code></pre>\n\n<p>It doesn't seem to work in Rails 3. I tried putting it in application.rb and that didn't help.</p>\n\n<p>What do you suggest?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":12978295,"title":"passing variables in redirect_to","body":"<p>In my Rails application, in <code>routes.rb</code> I have</p>\n\n<pre><code>match \"show_fail\" =&gt; \"Posts#show_fail\"\n</code></pre>\n\n<p>In <code>posts_controller.rb</code>:</p>\n\n<pre><code>def create\n  ...\n  return redirect_to show_fail_path, :title =&gt; @post.title\nend\n\ndef show_fail\nend\n</code></pre>\n\n<p>In <code>show_fail.html.erb</code>:</p>\n\n<pre><code>Unsuccessful posting of post title &lt;%= title %&gt;\n</code></pre>\n\n<p>But I got an error <code>undefined local variable or method 'title'</code>. Why does it not know about the <code>title</code> variable, and how can I fix it?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":245,"score":0,"question_id":6990808,"title":"Make Ruby/Rails continue method after encountering error","body":"<pre><code>def checkdomains\n  @domains = Domain.all\n\n  #@domains.where(:confirmed =&gt; \"yes\").each do |f|\n  @domains.each do |f|\n    r = Whois.whois(f.domain)\n    if r.available? == true\n      EmailNotify.notify_email(f).deliver\n    end\n  end\nend\n</code></pre>\n\n<p>This method crashes when it comes upon an invalid url (the whois gem gives an error), and doesn't keep on checking the rest of the domains. Is there any way I can have it continue to check the rest of the domains even if it crashes on one? At least until I can sort out phising out each domain.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":3,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":220,"score":4,"question_id":11474835,"title":"Rails 3 with Devise: No route matches /d/users/sign_out","body":"<p>I am getting the following error when I try to sign out of devise error:</p>\n\n<blockquote>\n  <p>No route matches [GET] \"/d/users/sign_out\"</p>\n</blockquote>\n\n<p>My tag is correct, it is as follows:</p>\n\n<pre><code>&lt;%= link_to \"Sign Out\", destroy_session_path, :method=&gt;:delete %&gt;\n</code></pre>\n\n<p>My route for devise is:</p>\n\n<pre><code>devise_for :users, :path_prefix=&gt;\"d\", :controllers=&gt;{:sessions=&gt;\"sessions\"}\n</code></pre>\n\n<p>Other routes are:</p>\n\n<pre><code>resources :users#For CRUD defined after devise_for like in Devise Wiki\n</code></pre>\n\n<p>With a custom controller sessions for ajax login like on the Devise wiki page:</p>\n\n<pre><code>class SessionsController &lt; Devise::SessionsController\n\n def create\n  respond_to do |format|\n    format.html{ super }\n    format.json do\n     resource = warden.authenticate!(:scope =&gt; resource_name, :recall =&gt; \"#{controller_path}#failure\")\n     #resource = warden.authenticate!(:scope =&gt; resource_name, :recall =&gt; :failure)\n     return sign_in_and_redirect(resource_name, resource)\n    end\n   end\n  end\n\ndef sign_in_and_redirect(resource_or_scope, resource=nil)\n  scope = Devise::Mapping.find_scope!(resource_or_scope)\n  resource ||= resource_or_scope\n  sign_in(scope, resource) unless warden.user(scope) == resource\n  return render :json =&gt; {:success =&gt; true, :redirect =&gt; stored_location_for(scope) || after_sign_in_path_for(resource)}\nend\n\ndef failure\n  return render:json =&gt; {:success =&gt; false, :errors =&gt; [\"Login failed.\"]}\nend\n\nend\n</code></pre>\n\n<p>The devise initializer has:</p>\n\n<pre><code>config.sign_out_via = :delete\n</code></pre>\n\n<p>Any ideas on what could be causing the problem?  I've searched Google and am still stumped.</p>\n\n<h3>Update:</h3>\n\n<p>Here is a screenshot of the rails routes file for the devise users.  Sorry, it is small, but you can right-click then view it by itself for a larger screen.</p>\n\n<p><img src=\"http://i.stack.imgur.com/lGcMR.png\" alt=\"enter image description here\"></p>\n\n<h3>Update #2:</h3>\n\n<p>The jquery_ujs file is included.</p>\n\n<h3>Update #3:</h3>\n\n<p>It appears in the console that delete is indeed being passed, but it is jumping from the sessions_controller to / then to d/users/sign_out...Not sure how to fix this.</p>\n\n<h3>Update #4:</h3>\n\n<p>When redirecting it goes first to d/users/sign_out as DELETE, as it should.  It then redirects to <code>root_url</code> which then gives the error <code>ERROR Errno::ECONNABORTED: An established connection was aborted by the software in your host machine.</code>  It then tries to redirect to d/users/sign_out as GET where it is failing.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","spree"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12963382,"title":"Can Spree allow me to have 'Vendors' in my e-commerce app?","body":"<p>Rather than the typical one store app, where I (as a user) go and add products that one seller (the owner of the Spree app) is selling, what I want to do is to create an ecommerce site that has multiple vendors.</p>\n\n<p>So you could see an overview of all vendors, and then you can buy multiple products from multiple vendors.</p>\n\n<p>Does Spree allow me to customize it to that extent?</p>\n\n<p>If so, are there any docs for that?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12976031,"title":"FTP server functionality in Ruby/Rails","body":"<p>I need to be able to receive ftp files from users from a desktop app and was wondering if there could be a way for Rails to process these requests despite being based on HTTP.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","documentation","comments"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":55,"score":3,"question_id":12894839,"title":"Document partial parameters in Rails","body":"<p>Is there any standard or emerging standard to document the parameters that can be passed into a Rails partial ?</p>\n\n<p>When <code>_my_partial.html.erb</code> expects a <code>title</code> and an <code>elements</code> local var passed with <code>render 'my_partial', title: t, elements: e</code>, there must be a common way to document their names, expected types and roles, without reading the whole partial code. Something like RDoc or Tomdoc for methods and classes. Isn't there ?</p>\n\n<p>Edit: I've found <a href=\"http://killswitchcollective.com/articles/13_best_practices_for_rails_partials\" rel=\"nofollow\">a post</a> whose author advocates initializing parameters with <code>&lt;% var ||= 'default_val' %&gt;</code> in the first lines of the partial, which is indeed a safe practice and a kind of in-code doc. Is there really no comment/parameter-declaration solution for this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","globalization","has-many-through","globalize3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":73,"score":0,"question_id":12976524,"title":"Rails3: Globalize3 - M to N table with attribute translation","body":"<p>Another Globalize3 problem I can't resolve:</p>\n\n<p>I have Products and AttributeFields. And I have a n-to-m table AttributeFieldInProduct with an extra :value. This value gets translated. Without the translation everything works fine, but with the translation I don't have this attribute on table attribute_field_in_product when I'm joining my has_many</p>\n\n<p>So an error occurs:</p>\n\n<pre><code>SQLite3::SQLException: no such column: attribute_field_in_product.value: SELECT attribute_fields.*, attribute_field_in_product.value as value FROM \"attribute_fields\" INNER JOIN \"attribute_field_in_products\" ON \"attribute_fields\".\"id\" = \"attribute_field_in_products\".\"attribute_field_id\" WHERE \"attribute_field_in_products\".\"product_id\" = 1\n</code></pre>\n\n<p>My code:</p>\n\n<p>product.rb</p>\n\n<pre><code>class Product &lt; ActiveRecord::Base\n    ...\n\n    has_many :attribute_field_in_products, dependent: :destroy\n    has_many :attribute_fields, :through =&gt; :attribute_field_in_products, :select =&gt; 'attribute_fields.*, attribute_field_in_product.value as value'\n    ...\nend\n</code></pre>\n\n<p>attribute_field.rb</p>\n\n<pre><code>class AttributeField &lt; ActiveRecord::Base\n    ...\n    has_many :attribute_field_in_products, :dependent =&gt; :destroy\n     has_many :products, :through =&gt; :attribute_field_in_products, :select =&gt; 'products.*, attribute_field_in_product.value as value'\n\n    ...\nend\n</code></pre>\n\n<p>attribute_field_in_product.rb</p>\n\n<pre><code>class AttributeFieldInProduct &lt; ActiveRecord::Base\n    attr_accessible :product_id, :attribute_field_id, :value\n\n    belongs_to :product\n    belongs_to :attribute_field\n\n    #translation doings\n    attr_accessible :translations_attributes\n    translates :value\n    accepts_nested_attributes_for :translations\n\n    class Translation\n        attr_accessible :locale, :value\n    end\n</code></pre>\n\n<p>end</p>\n\n<p>Please help or give ideas for the 'has_many :attribute_fields' select. This globalize3 gem makes me really angry :)</p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12965754,"title":"ddslick rails form_for doesn't save","body":"<p>I got problems with ddslicks in my edit form</p>\n\n<pre><code>&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name), :html =&gt; { :method =&gt; :put , :multipart =&gt; true }) do |f| %&gt;\n\n#some code\n&lt;div class=\"field multi-select three cf\"&gt;\n        &lt;%= f.label :date_of_birth %&gt;\n        &lt;%= f.date_select(:date_of_birth, {:order =&gt; [:year, :month, :day],:start_year =&gt;Time.now.year-50, :end_year =&gt; Time.now.year }) %&gt;\n&lt;/div&gt;\n&lt;%= f.submit \"Update\", :class=&gt;\"btn-container submit\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>that generates the next html:</p>\n\n<pre><code>&lt;select id=\"user_date_of_birth_1i\" name=\"user[date_of_birth(1i)]\"&gt;\n&lt;option value=\"1962\"&gt;1962&lt;/option&gt;\n&lt;option value=\"1963\"&gt;1963&lt;/option&gt;\n....\n&lt;select id=\"user_date_of_birth_2i\" name=\"user[date_of_birth(2i)]\"&gt;\n&lt;option value=\"1\"&gt;January&lt;/option&gt;\n&lt;option value=\"2\"&gt;February&lt;/option&gt;\n&lt;option value=\"3\"&gt;March&lt;/option&gt;\n....\n&lt;select id=\"user_date_of_birth_3i\" name=\"user[date_of_birth(3i)]\"&gt;\n&lt;option value=\"1\"&gt;1&lt;/option&gt;\n&lt;option value=\"2\"&gt;2&lt;/option&gt;\n....\n</code></pre>\n\n<p>at this point everything is good, but when I apply the ddslick it doesn't work</p>\n\n<p>here is my global.js</p>\n\n<pre><code>$('#user_date_of_birth_1i').ddslick({selectText: \"Year\", height: 200 });\n$('#user_date_of_birth_2i').ddslick({selectText: \"Month\", height: 200});\n$('#user_date_of_birth_3i').ddslick({selectText: \"Day\", height: 200});\n</code></pre>\n\n<p>it generates the next html</p>\n\n<pre><code>&lt;div id=\"user_date_of_birth_1i\" class=\"dd-container\" style=\"width: 260px; \"&gt; \n&lt;div class=\"dd-select\" style=\"width: 260px; background-color: rgb(238, 238, 238);     background-position: initial initial; background-repeat: initial initial; \"&gt;\n&lt;input class=\"dd-selected-value\" type=\"hidden\" value=\"1992\"&gt;\n&lt;a class=\"dd-selected\"&gt;&lt;label class=\"dd-selected-text\"&gt;1992&lt;/label&gt;&lt;/a&gt;\n&lt;span class=\"dd-pointer dd-pointer-down\"&gt;&lt;/span&gt;\n &lt;/div&gt;\n &lt;ul class=\"dd-options dd-click-off-close\" style=\"width: 260px; height: 200px; overflow: auto; \"&gt;\n &lt;li&gt;&lt;a class=\"dd-option\"&gt;&lt;input class=\"dd-option-value\" type=\"hidden\" value=\"1962\"&gt;\n&lt;label class=\"dd-option-text\"&gt;1962&lt;/label&gt;&lt;/a&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;a class=\"dd-option\"&gt; &lt;input class=\"dd-option-value\" type=\"hidden\" value=\"1963\"&gt; \n&lt;label class=\"dd-option-text\"&gt;1963&lt;/label&gt;&lt;/a&gt;\n&lt;/li&gt;\n....rest of years\n&lt;/div&gt;\n</code></pre>\n\n<p>the same for user_date_of_birth_2i(month), user_date_of_birth_3i(days)</p>\n\n<p>when I submit that, it doesn't save that field. (Im using devise), any help will be appreciate</p>\n"},{"tags":["ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":56,"score":1,"question_id":12955288,"title":"Trouble with Paperclip and Ajax with Rails 3.2.8","body":"<p>I am writting an application 100% ajax with rails 3.2.8</p>\n\n<p>Everything was going great until I tried to upload photos of the employees to the employee management module.</p>\n\n<p>This is part of my code:</p>\n\n<p><strong>At the Controller:</strong></p>\n\n<pre><code>class EmpleadosController &lt; ApplicationController\n  respond_to :js\n  before_filter :require_user\n\n  def index\n    @empleados = Empleado.paginate( page: params[ :page ],\n                                    joins: [:user,:contacto],\n                                    select: 'empleados.id as id, empleados.user_id, empleados.contratado_el, empleados.despedido_el, empleados.nss, empleados.sueldo_base_semanal, empleados.comentarios, empleados.foto_file_name, empleados.foto_content_type, empleados.foto_file_size, empleados.foto_updated_at, users.username as username, contactos.salutacion_id as salutacion_id, contactos.id as contacto_id, contactos.nombres as nombres, contactos.apellidos as apellidos'\n                                  ).sorted( params[ :sort ] )\n  end\n\n\n  def new\n    @empleado = Empleado.new\n  end\n\n  def create\n    @empleado = Empleado.new(params[:empleado])\n    @empleado.sueldo_base_semanal = params[:empleado][:sueldo_base_semanal].gsub(',','').gsub('$','').to_f\n    if @empleado.save\n      redirect_to empleados_path\n    else\n      render action: 'new'\n    end\n  end\n...\n</code></pre>\n\n<p><strong>Now for the view (I am using HAML):</strong></p>\n\n<pre><code>= form_for( @empleado, remote: true, html: {multipart: true} ) do |f|\n  = show_me_the_errors @empleado\n\n  %table.captura\n    %tr\n      %td.etiqueta\n        = f.label :user_id\n      %td.campo\n        = f.select  :user_id,\n                    User.usuarios_no_asignados,\n                    { include_blank: true },\n                    { tabindex: 1 }\n        = image_tag 'nuevo_24.png',\n                    style: 'vertical-align: bottom;',\n                    id: 'empleado_nuevo_usuario'\n... ( 5 more text fields ) ...\n\n    %tr\n      %td.etiqueta\n        = f.label :foto\n      %td.campo\n        = f.file_field :foto,\n                       accept: 'image/png,image/gif,image/jpeg'\n</code></pre>\n\n<p>The thing is that while there is not selected file for upload, everything works fine, the command <code>respond_to :js</code> works as it should be in all interactions between <code>create</code> with <code>index</code> and <code>new</code>.</p>\n\n<p>But, when you select an image, all the interactions after <code>create</code> with <code>index</code> and <code>new</code> become <code>HTML</code> completely ignoring the <code>respond_to :js</code>, I mean, the <code>form for</code> behaves just like if the <code>remote: true</code> wasn't there</p>\n\n<p>When everything works well, the URL is localhost:3000 and never changes, but when I select an image to upload, the URL after <code>crete</code> becomes localhost:3000/empleados</p>\n\n<p>Does any one have any clue about this? I have been trying to solve this for the last 3 dyas and failed.</p>\n\n<p>Thaks in advance.</p>\n"},{"tags":["ruby-on-rails-3","routing","sti"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12974719,"title":"STI routing error","body":"<p>Newbie working on his first rails application after studying Hartl's Rails Tutorial book &amp; video cast.</p>\n\n<p>I'm using a STI model where:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\nclass Kid &lt; User\nclass Parent &lt; User\n</code></pre>\n\n<p>User has the basic elements: name, email, etc.</p>\n\n<p>The problem I'm having is with routing.  I continue to work in determining which model will ultimately work best in this situation (STI or polymorphic). I've started with STI and I think I can get this to work if I can nail down the routing issues.  </p>\n\n<p><strong>My problem is my edit is looking for an \"update\" action in the users controller when I want it to route to kidupdate</strong> I've been reading many SO posts about STI routing but I can't seem to figure out why this won't route correctly.</p>\n\n<p>Rspec test. It the error comes from the \"click_button\"</p>\n\n<pre><code>describe \"with valid information\" do\n  let(:new_first)   { \"New First\" }\n  let(:new_last)    { \"New Last\" }\n  let(:new_email)   { \"new@example.com\" }\n  before do\n    fill_in \"First Name\",               with: new_first\n    fill_in \"Last Name\",                with: new_last\n    fill_in \"Email\",                    with: new_email\n    select  \"Kid\",  from: \"Are you a Kid or Parent\"\n    fill_in \"Password\",                 with: kid.password\n    fill_in \"Confirmation\",             with: kid.password\n    click_button \"Save changes\"\n  end\n</code></pre>\n\n<p>Rspec error:</p>\n\n<pre><code>     KidPages edit with valid information \n     Failure/Error: click_button \"Save changes\"\n     AbstractController::ActionNotFound:\n       The action 'update' could not be found for UsersController\n     # (eval):2:in `click_button'\n     # ./spec/requests/kids_pages_spec.rb:32:in `block (4 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>Routes:</p>\n\n<pre><code>       root        /                         static_pages#home\n       help        /help(.:format)           static_pages#help\n    contact        /contact(.:format)        static_pages#contact\n     signup        /signup(.:format)         users#new\n     signin        /signin(.:format)         sessions#new\n    signout DELETE /signout(.:format)        sessions#destroy\n    kidshow        /kids/:id(.:format)       users#kidshow\n  kidupate PUT    /kids/:id(.:format)       users#kidupdate\n    kidedit        /kids/:id/edit(.:format)  users#kidedit\n      users GET    /users(.:format)          users#index\n            POST   /users(.:format)          users#create\n   new_user GET    /users/new(.:format)      users#new\n  edit_user GET    /users/:id/edit(.:format) users#edit\n       user GET    /users/:id(.:format)      users#show\n            PUT    /users/:id(.:format)      users#update\n            DELETE /users/:id(.:format)      users#destroy\n   sessions POST   /sessions(.:format)       sessions#create\nnew_session GET    /sessions/new(.:format)   sessions#new\n    session DELETE /sessions/:id(.:format)   sessions#destroy\n</code></pre>\n\n<p>routes.rb</p>\n\n<pre><code>  root to: 'static_pages#home'\n  match '/help',    to: 'static_pages#help'\n  match '/contact', to: 'static_pages#contact'\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout',  to: 'sessions#destroy', via: :delete\n  match 'kids/:id', to: 'users#kidshow',  :as =&gt; 'kidshow'\n  match 'kids/:id', to: 'users#kidupdate', :via =&gt; 'put', :as =&gt; 'kidupdate'\n  match 'kids/:id/edit', to: 'users#kidedit',  :as =&gt; 'kidedit'\n  resources :users\n  resources :sessions, only: [:new, :create, :destroy]\n</code></pre>\n\n<p>I've been struggling with these concepts and this problem for weeks and I appreciate the help.</p>\n"},{"tags":["ruby","ruby-on-rails-3","image","carrierwave"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12975698,"title":"Rails 3.2.8 - How to receive image, video and sound file without form on Rails?","body":"<p>I'm making an API that deals with mobile devices interactions.</p>\n\n<p>I know how to deal with simple variables handling such as this:</p>\n\n<pre><code>curl -XPOST -H \"Content-Type: application/json\" \"http://localhost:3000/api/v1/registrations\" -d \"{registration: {\"nickname\":\"john_doe\", \"password\":\"secret\", \"confirmed\":\"true\", \"email\":\"john.doe@gmail.com\",\"blood_type\":\"B+\"}}\"\n</code></pre>\n\n<p>This POST call will go to my controller:</p>\n\n<pre><code>class RegistrationController &lt; ApplicationController\n    def create\n      Registration.create!(params[:registration])\n    end\nend\n</code></pre>\n\n<p>It's just a very simple way to post information to my Registration model.</p>\n\n<p>However, if I'm handling image, sound and video upload using a JSON through a POST request, besides having to use an uploaded like Carrierwave, is there anything else I need to do?</p>\n\n<p>For example, would it work a request like this?</p>\n\n<pre><code>curl -XPOST -H \"Content-Type: application/json\" \"http://localhost:3000/api/v1/registrations\" -d \"{registration: {\"nickname\":\"john_doe\", \"password\":\"secret\", \"confirmed\":\"true\", \"email\":\"john.doe@gmail.com\",\"blood_type\":\"B+\", \"image\": IMAGE_FILE_IN_BINARY_OR_SOME_OTHER_FORMAT?}}\"\n</code></pre>\n\n<p>Should the image file be trasmitted as a binary or there's a specific format for it?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":985,"score":4,"question_id":3894962,"title":"Rails 3 - Building a Table, Want to Alternate colors every row","body":"<p>Desired Output:</p>\n\n<pre><code>&lt;ul&gt;\n &lt;li class=\"odd\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"even\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"odd\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"even\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"odd\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"even\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"odd\"&gt;stuff&lt;/li&gt;\n &lt;li class=\"even\"&gt;stuff&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>CSS:</p>\n\n<pre><code>.odd {color:blue}\n.even{color:red;}\n</code></pre>\n\n<p>In rails 3 is there a clean way to do this without counters etc?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails-3","git","thin"],"answer_count":4,"favorite_count":9,"up_vote_count":19,"down_vote_count":0,"view_count":6957,"score":19,"question_id":9605430,"title":"Thin web server: `start_tcp_server': no acceptor (RuntimeError) after git branch checkout","body":"<p>A Rails 3.2.0 app, working fine with Thin web server, both locally and on Heroku cedar stack.</p>\n\n<p>After:</p>\n\n<pre><code>$ git branch work\n$ git checkout work\n$ rails server\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>=&gt; Booting Thin\n=&gt; Rails 3.2.0 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\n&gt;&gt; Thin web server (v1.3.1 codename Triple Espresso)\n&gt;&gt; Maximum connections set to 1024\n&gt;&gt; Listening on 0.0.0.0:3000, CTRL+C to stop\nExiting\n/Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:572:in `start_tcp_server': no acceptor (RuntimeError)\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:572:in `start_server'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/backends/tcp_server.rb:16:in `connect'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/backends/base.rb:53:in `block in start'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `call'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run_machine'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/eventmachine-0.12.10/lib/eventmachine.rb:256:in `run'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/backends/base.rb:61:in `start'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/thin-1.3.1/lib/thin/server.rb:159:in `start'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/handler/thin.rb:13:in `run'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/rack-1.4.1/lib/rack/server.rb:265:in `start'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.0/lib/rails/commands/server.rb:70:in `start'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.0/lib/rails/commands.rb:55:in `block in &lt;top (required)&gt;'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.0/lib/rails/commands.rb:50:in `tap'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.0/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Also, when I do:</p>\n\n<pre><code>sudo bundle exec rails server thin -p 3000\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>/Users/peter/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': Could not find bundler (&gt;= 0) amongst [bigdecimal-1.1.0, io-console-0.3, json-1.5.4, minitest-2.5.1, rake-0.9.2.2, rdoc-3.9.4] (Gem::LoadError)\nfrom /Users/peter/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:256:in `to_spec'\nfrom /Users/peter/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/site_ruby/1.9.1/rubygems.rb:1210:in `gem'\nfrom /Users/peter/.rvm/gems/ruby-1.9.3-p125/bin/bundle:18:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have bundler 1.0.22 installed. Updated and installed it. Nothing seems to work. Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin","sweeper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12974262,"title":"Rails cache sweeper fails on create","body":"<p>I have a controller where:</p>\n\n<pre><code>caches_action :show\ncache_sweeper :the_model_sweeper, :only =&gt; [:update, :destroy]\n</code></pre>\n\n<p>and sweeper:</p>\n\n<pre><code>observe TheModel\n\ndef after_save(the_model)\n  expire_cache(the_model)\nend\n\ndef after_destroy(the_model)\n  expire_cache(the_model)\nend\n\ndef expire_cache(the_model)\n  expire_action :controller =&gt; '/the_model', :action =&gt; 'show'\nend\n</code></pre>\n\n<p>and am getting:</p>\n\n<pre><code>ActionController::RoutingError (No route matches {:controller=&gt;\"/the_model\", :action=&gt;\"show\"}):\n</code></pre>\n\n<p>The problem I'm guessing is becuase the sweeper is called after_save, when on a new record there will be nothing to destroy, even though I have specifically said for it only to sweep on update or delete.</p>\n\n<p><em>(I have obviously renamed the model to \"The Model\" for example purposes)</em></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","roles"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12956329,"title":"How can i allow user with admin role to edit the role of the other users?","body":"<p>I use devise for authentication and only an admin can create a user.</p>\n\n<p>I use cancan to assign roles to the user during user creation. </p>\n\n<p>I want the admin to view all the users roles and <strong>the admin should be able to edit the roles of the users.</strong></p>\n\n<p>How can I do this?</p>\n"},{"tags":["ruby-on-rails-3","devise","cancan"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":19,"score":0,"question_id":12974084,"title":"i want to customize the user's view such that we have a matrix of check boxes","body":"<p>i want to customize the user's view such that we have a matrix of check boxes in which the user can select many check boxes like create,update ,destroy and read and then maintain the ability class dynamically.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","aasm"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":515,"score":3,"question_id":4912619,"title":"AASM: Transitions from any state?","body":"<p>I am using <a href=\"https://github.com/rubyist/aasm\" rel=\"nofollow\">AASM</a>. Is it possible to transition from any state? For example:</p>\n\n<pre><code>aasm_event :publish do\n  transitions :to =&gt; :publish, :from =&gt; ANY_STATE\nend\n</code></pre>\n\n<p>I know that it is possible to pass an array of states to <code>:from</code>, but this isn't what I'm after. I have tried omitting the <code>:from</code> completely, but that didn't work.</p>\n"},{"tags":["ruby-on-rails-3","query-string","tracking","actionmailer","sendgrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":79,"score":0,"question_id":8362534,"title":"ActionMailer changing my url params?","body":"<p>I implemented kissmetrics beacon API to track opens on emails, but something is changing the url params such that it breaks. Here is what it winds up as</p>\n\n<pre><code>&lt;img src='http://trk.kissmetrics.com/e?_k=9bd1b491600ee5f03e32916388b8516c2dbc2118&amp;amp;_n=viewed+notification&amp;amp;_p=bob%40hotmail.com&amp;amp;email_type=new+follower&amp;amp;notification_type=email'&gt;\n</code></pre>\n\n<p>The problem seems to be that the <code>&amp;</code> separator is becoming <code>&amp;amp;</code></p>\n\n<p>The method I created uses <code>to_params</code> and generates the url fine:</p>\n\n<pre><code>http://trk.kissmetrics.com/e?_k=9bd1b491600ee5f03e32916388b8516c2dbc2118&amp;_n=viewed+notification&amp;_p=bob%40hotmail.com&amp;email_type=new+follower&amp;notification_type=email\n</code></pre>\n\n<p>Somewhere between the mailer view and the actual sending of the email, something is changing the url. Is this actionmailer? I am using sendgrid, could that be causing the problem?</p>\n\n<p>Just to be clear, here are the methods involved</p>\n\n<pre><code>%img{ :src =&gt; km_tracking_pixel }\n\ndef km_tracking_pixel\n  query = { :_p =&gt; @user.email,\n            :_n =&gt; 'viewed notification',\n            :_k =&gt; AppConfig['kissmetrics_api_key'],\n            :notification_type =&gt; 'email',\n            :email_type =&gt; @email_type }\n  add_params_to_url('http://trk.kissmetrics.com/e', query)\nend\n\ndef add_params_to_url(url, *options)\n  url.split('?').first.chomp('/') + '?' + options.to_param\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-1.8.7","aasm"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":92,"score":0,"question_id":11066659,"title":"AASM is not working with my rails 3 and ruby 1.8.7 ( undefined method `name' for nil:NilClass )","body":"<p>I'm using Rails 3.2.2, with aasm gem, I have <code>Document</code> model this way: </p>\n\n<pre><code>class Document &lt; ActiveRecord::Base\n  include AASM\n\n  aasm do  \n    state :unread, :initial =&gt; true\n    state :read\n    state :closed\n\n    event :view do\n      transitions :to =&gt; :read, :from =&gt; [:unread]\n    end\n\n    event :close do\n      transitions :to =&gt; :closed, :from =&gt; [:read, :unread]\n    end\n  end\n</code></pre>\n\n<p>now on my console: </p>\n\n<pre><code>➜  ✗ bundle exec rails c\nLoading development environment (Rails 3.2.2)\nirb(main):006:0&gt; Document.create!(:title =&gt; 'test')\n   (0.2ms)  BEGIN\n  SQL (0.3ms)  INSERT INTO `documents` (`aasm_state`, `checklist_id`, `created_at`, `description`, `dir`, `planned_date`, `procedure_id`, `section`, `subsection`, `title`, `updated_at`) VALUES (0, NULL, '2012-06-16 20:03:18', NULL, NULL, NULL, NULL, NULL, NULL, 'test', '2012-06-16 20:03:18')\n   (0.4ms)  COMMIT\n=&gt; #&lt;Document id: 28, title: \"test\", description: nil, dir: nil, section: nil, subsection: nil, planned_date: nil, procedure_id: nil, checklist_id: nil, created_at: \"2012-06-16 20:03:18\", updated_at: \"2012-06-16 20:03:18\", aasm_state: 0&gt;\nirb(main):007:0&gt; doc = Document.last\n  Document Load (0.3ms)  SELECT `documents`.* FROM `documents` ORDER BY `documents`.`id` DESC LIMIT 1\n=&gt; #&lt;Document id: 28, title: \"test\", description: nil, dir: nil, section: nil, subsection: nil, planned_date: nil, procedure_id: nil, checklist_id: nil, created_at: \"2012-06-16 20:03:18\", updated_at: \"2012-06-16 20:03:18\", aasm_state: 0&gt;\nirb(main):008:0&gt; doc.view!\nNoMethodError: undefined method `name' for nil:NilClass\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/supporting_classes/state.rb:15:in `=='\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/aasm.rb:143:in `aasm_state_object_for_state'\n    from (irb):8:in `find'\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/aasm.rb:143:in `each'\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/aasm.rb:143:in `find'\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/aasm.rb:143:in `aasm_state_object_for_state'\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/aasm.rb:158:in `aasm_fire_event'\n    from /Library/Ruby/Gems/1.8/gems/aasm-3.0.6/lib/aasm/base.rb:48:in `view!'\n    from (irb):8    \n</code></pre>\n\n<p>As you can see I keep getting</p>\n\n<blockquote>\n  <p>undefined method `name' for nil:NilClass</p>\n</blockquote>\n\n<p>I'm using Ruby 1.8.7.</p>\n"},{"tags":["ruby-on-rails-3","devise","subdomain"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12972729,"title":"Devise, Rails 3 : save what subdomain was used when registering account","body":"<p>Please, any help for problem: I have Rails3 application that uses Devise for user management. application has domain name with one subdomain. For eg, example.com and new.example.com. That domains are points to one IP. When new user creates account I just want to save to 'domain' column in users table what domain was used when user register.</p>\n\n<p>Thank for any help!</p>\n"},{"tags":["ruby-on-rails-3","routes"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12972441,"title":"Rails 3 Routing error - Resources route on custom match","body":"<p>I want to add member routes on a custom match.</p>\n\n<p>These are my routes:</p>\n\n<pre><code>resources :shows\nmatch \"/show/:permalink\" =&gt; \"shows#show\", :as =&gt; \"show\" do\n    resources :show_attribute_votes, :as =&gt; :votes\nend\n</code></pre>\n\n<p>This url works fine:</p>\n\n<pre><code>/show/big-bang-theory/votes\n</code></pre>\n\n<p>But I'm getting this error:</p>\n\n<pre><code>&lt;p&gt;&lt;%= link_to \"New Vote\", new_show_show_attribute_vote_path %&gt;&lt;/p&gt;\n\nRouting Error\nNo route matches {:action=&gt;\"new\", :controller=&gt;\"show_attribute_votes\"}\n</code></pre>\n\n<p>But this urls donesn't work, and I'm not seeing any of them when running <code>rake routes</code></p>\n\n<pre><code>/show/big-bang-theory/votes/new\n</code></pre>\n\n<p>Please help :)</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":12821518,"title":"Create new user works with ruby 1.9.2 but fails with ruby 1.9.3","body":"<p>I am using Rails 3.2.8 and Devise 2.1.2 (latest) and am baffled as to why I can create a user just fine with Ruby 1.9.2 but not with Ruby 1.9.3, using <em>exactly</em> the same codebase.</p>\n\n<p>Rails console:</p>\n\n<pre><code>User.find_or_create_by_email('example@example.com', :password =&gt; 'example', :first_name =&gt; 'Super', :last_name =&gt; 'Admin', :terms_and_conditions =&gt; true)\n</code></pre>\n\n<p>The output in 1.9.3 shows ROLLBACK (see below), but I just can't seem to figure out why.</p>\n\n<p>Output (partial) when using 1.9.2:</p>\n\n<pre><code>SQL (0.3ms)  INSERT INTO \"versions\" (\"created_at\", \"event\", \"item_id\", \"item_type\", \"object\", \"whodunnit\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"created_at\", Wed, 10 Oct 2012 13:57:07 UTC +00:00], [\"event\", \"create\"], [\"item_id\", 20], [\"item_type\", \"OrderType\"], [\"object\", nil], [\"whodunnit\", nil]]\n  Currency Load (1.1ms)  SELECT \"currencies\".* FROM \"currencies\" WHERE \"currencies\".\"code\" = 'USD' LIMIT 1\nSQL (2.4ms)  INSERT INTO .. \n(continues with the next insert statement)\n</code></pre>\n\n<p>Output (partial) when using 1.9.3:</p>\n\n<pre><code>SQL (0.3ms)  INSERT INTO \"versions\" (\"created_at\", \"event\", \"item_id\", \"item_type\", \"object\", \"whodunnit\") VALUES ($1, $2, $3, $4, $5, $6) RETURNING \"id\"  [[\"created_at\", Wed, 10 Oct 2012 12:29:49 UTC +00:00], [\"event\", \"create\"], [\"item_id\", 16], [\"item_type\", \"OrderType\"], [\"object\", nil], [\"whodunnit\", nil]]\n  Currency Load (0.3ms)  SELECT \"currencies\".* FROM \"currencies\" WHERE \"currencies\".\"code\" = 'USD' LIMIT 1\n(0.1ms)  ROLLBACK\n=&gt; #&lt;User id: 4, first_name: \"Super\", last_name: \"Admin\", admin_notes: nil, email: \"example@example.com\", ... \n(stops)\n</code></pre>\n\n<p>I am thinking this could be an issue with Devise but am not sure.</p>\n\n<p>Would appreciate any help!</p>\n\n<hr>\n\n<p>Update Oct 19:</p>\n\n<p>I found out that the cause of the problem is an <code>after_create</code> callback in user.rb that creates a \"broker\" (through the broker model) where it sets commission = 9.95</p>\n\n<p>From the annotation in broker.rb:</p>\n\n<pre><code>#  commission :decimal(, )\n</code></pre>\n\n<p>And more from broker.rb:</p>\n\n<pre><code>belongs_to :user\nPRICE_REGEX = /^([1-9]\\d{0,20}|0)(\\.\\d{0,3})?$/\nPRICE_ERROR_MESSAGE = \"Must be a number. If you want to include decimals, please use comma as decimal separator. Periods (.) = thousand separator cannot be used.\"\nvalidates :commission, :format =&gt; {:with =&gt; PRICE_REGEX, :message =&gt; PRICE_ERROR_MESSAGE }, :allow_blank =&gt; true\n</code></pre>\n\n<p>As written above, setting broker commission to 9.95 works fine with ruby 1.9.2 but fails with ruby 1.9.3. </p>\n\n<p>When saving it through rails console in 1.9.3, I get an \"ActiveRecord::RecordInvalid: Validation failed...\" error. No error in 1.9.2.</p>\n\n<p>If I set it to 10 instead of 9.95 it works in both 1.9.2 and 1.9.3 (broker commission is set to 10). </p>\n\n<p>If I set it to 9,95 (comma, not period) the user and broker is created fine but the broker commission is set to 0.</p>\n\n<p>As the validation error message says, periods (.) are not allowed so it makes sense that the validation fails, but then it would have been a bug in ruby 1.9.2 that had it work before I switched to 1.9.3.</p>\n\n<p>Any good explanation would be welcome :-)</p>\n"},{"tags":["ruby-on-rails-3","view","devise","notice"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12969403,"title":"Devise: Load a partial instead of showing a notice for non confirmed members","body":"<p><strong>Is there a way to load a view for no confirmed users that login? \nDefault behaviour is to show a notice: \" You have to confirm your account before continuing.\"</strong></p>\n\n<p>I tried</p>\n\n<ul>\n<li>overrule the sessions#create method of devise checking for current_user.confirmed_at.blank?</li>\n<li>in the after_singin_path check for current_user.confirmed_at.blank? and render the view instead</li>\n</ul>\n\n<p>My goal is to render a custom view instead of the notice but cannot hook into the right location. Who knows how to accomplish this? thx!</p>\n"},{"tags":["javascript","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":23,"score":1,"question_id":12967987,"title":"jCarouselLite autoscroll not show one enty","body":"<p>I'm using jCarouselLite for showing important event in show page, but when I add only single event it does not show(while more than one event display on show page and auto scroll work properly)..</p>\n\n<p>Here is my code:-</p>\n\n<pre><code>       .scroll{:style=&gt;\"margin:5px 0 0 10px;\"}\n         -if @individual.important_events.present?\n           %ul\n             -@individual.important_events.each do |event|\n               %li\n                 = link_to event.title, important_events_path\n                 %br\n                 = event.date  \n</code></pre>\n\n<p>And script is:-</p>\n\n<pre><code>:javascript     \n  $(function() {\n    $(\".scroll\").jCarouselLite({\n      auto: 800,\n      speed: 1000,\n      vertical: true,\n      circular: true\n    });\n  });\n</code></pre>\n\n<p>How can I show single entry of event in my show page??</p>\n"},{"tags":["ruby-on-rails-3","backbone.js"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12971679,"title":"backbone.js newcomer - error creating collection in app namespace initialize method","body":"<p>I'm following the the book, Backbone.js on Rails and am creating the basic todo application alongside reading it but I am getting the following javascript error trying to initialize a collection inside the applications namespace:</p>\n\n<p>Error: TodoApp.Collections.Notes is not a constructor\nSource File: localhost:3000/assets/todo_app.js?body=1\nLine: 13</p>\n\n<p>todo_app.js</p>\n\n<pre><code>var TodoApp = {\n  Models: {},\n  Collections: {},\n  Views: {},\n  Routers: {},\n  initialize: function(data) {\n    console.log(\"INITIALIZE\");\n    var notes = new TodoApp.Collections.Notes(data.notes); \n    new TodoApp.Routers.Notes({ notes: notes }); \n    Backbone.history.start();    \n  }\n};\n</code></pre>\n\n<p>I've followed the instructions so far and created a Note model, Notes collection and router and this is how the initialize method is called on index.html.erb:</p>\n\n<pre><code>&lt;%= javascript_tag do %&gt;\n  TodoApp.initialize({ notes: &lt;%== @notes.to_json %&gt; });\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is the order I'm including all of the files:</p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require underscore\n//= require json2\n//= require backbone\n//= require backbone-support\n//\n//= require todo_app\n//\n//= require_tree ./models \n//= require_tree ./collections \n//= require_tree ./views \n//= require_tree ./routers \n//= require_tree ../templates\n//= require_tree .\n</code></pre>\n\n<p>Can anyone help with this? What have I missed out here?\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12971201,"title":"How to loop through an array and save data","body":"<p>In my project, I have this following code</p>\n\n<pre><code>scenario = Scenario.new\nscenarioTranslation = ScenarioTranslation.new\n\nparams[:title].each do | index |\n      scenario.position = last_position + 1\n      scenario.analysis_id = scenarioTranslation.scenario_id\n      scenario.save\n    end\n</code></pre>\n\n<p>Here the <code>params[:title]</code> is an array and I have to loop through number of array elements and save the scenario</p>\n\n<p>Currently its saving only once. Can anyone tell me how to fix this error</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12969637,"title":"Rails: Creating a form where user specifies association and one that is based on current resource","body":"<p>I have an article model and a comment model. I currently have two separate forms to create new comments: one that allows the user to specify the name of the article their comment is for and a one underneath an article show view that creates new comments for that article. I am using form_for @comment in the first case and form_for [@article, @comment] in the second case. When a user specifies an article name as a string I convert it to an article id before saving the comment.</p>\n\n<p>My routes are </p>\n\n<pre><code>resources :comments\n\nresources :articles do\n  resources :comments \nend\n</code></pre>\n\n<p>For the second form how can I redirect back to the article on a failed comment save (validations and errors should be displayed)? For the first form I just redirect to the homepage as that is where my first comment form is.</p>\n\n<p>Also, I have a validation on the first form that the article name field cannot be empty. How can I remove this validation for the second form as the user does not need to specify an article name?</p>\n\n<p>My new function in the comments_controller handles both forms. How do I determine which form is being submitted in the controller?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby","ruby-on-rails-3","google-maps"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12966638,"title":"Rails - How to calculate the distance of two gps coordinates without having to use Google Maps on Rails?","body":"<p>I'm wondering if there's a way to calculate the distance of two gps coordinates on Rails without relying on Google Maps API.</p>\n\n<p>My app may receive the coordinates in float or I would have to do reverse GEO on the addresses.</p>\n\n<p>Is there a gem that doesn't rely on GMaps?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12968418,"title":"Where should I start reading to learn how to build a good Rails gem?","body":"<p>I'm feeling fairly seasoned in Ruby on Rails by now, and have attempted to build my own Rails plugins. Going through that process, however, I realized that I really have not found very many good resources that clearly spell out what the conventions are for creating Rails gems/plugins, and how to efficiently accomplish some of the things that I wanted to do with my plugin.</p>\n\n<p>It seems to me that the documentation for buildings Rails gems is not very good, but maybe I'm not looking in the right places. In an attempt to gain insight into how other gems are built, I've read through some of the source code of the Devise plugin for user authentication. I have found virtually nothing describing a procedure similar to how Devise injects its own methods into an existing model, even though this seems like it may be a very useful thing for a lot of good gems to do.</p>\n\n<p>My question is this: Where should I go to learn how to build good Rails gems? Are there spelled out conventions for how to do certain things?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","api","httparty"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":119,"score":0,"question_id":11155032,"title":"Dealing with Custom Exceptions Codes from Failed API Call","body":"<p>I'm connecting our Rails (3.2) application to an external web service (campaign monitor) which requires a few calls to their system to set a client up.</p>\n\n<p>I've put each action into separate rescue blocks and wrapped in a transaction but things aren't looking so great. I need it to escape after each error and display the correct message. Currently it just escapes.</p>\n\n<p>I have a list of possible errors per action - how is it possible to read these and format as a flash message?</p>\n\n<p>For example, the following error:</p>\n\n<pre><code> CreateSend::BadRequest: The CreateSend API responded with the following error - 172: You can create a maximum of five (5) clients per thirty (30) minutes\n</code></pre>\n\n<p>I currently have this in my controller:</p>\n\n<pre><code>  def create_send_setup\n     ...\n      begin\n\n       client = CreateSend::Client.create(@user.company_name, @user.username, @user.email, \"(GMT) Dublin, Edinburgh, Lisbon, London\", @user.country)\n\n       rescue\n        flash[:notice] = \"Uh oh, there's been a problem. Please try again. Client\"\n       end\n\n       begin\n         @client = CreateSend::Client.new(@user.createsend_client_api)\n         @client.set_access(@user.username, @password, @user.createsend_access_level)\n         @client.set_monthly_billing(@user.createsend_currency, true, @user.createsend_markup)\n\n       rescue\n          flash[:notice] = \"Uh oh, there's been a problem. Please try again. Access\"\n       end\n\n          flash[:notice] = \"Great, now you just need to choose a plan\"\n          redirect_to edit_user_registration_path    \n\n end\n</code></pre>\n\n<p>In a previous integration, I've used something like </p>\n\n<pre><code>case bla.code.to_s\n     when /2../\n     when '403'\n       raise \"Could not update subscriber: new-customer-id is already in use.\"\n     ...\n end\n</code></pre>\n\n<p>What's the best way to extract the error code from the response and display as a flash message?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","nginx"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12950903,"title":"Is it possible to run two different Rails apps on the same domain (using a subdirectory)?","body":"<p>I have a game that I developed in Rails 3.1 that I would like to add to my existing Rails 2.3.8 without having to upgrade it.  Is it possible to have this 3.1 game app exist on the same domain, something like <a href=\"http://mydomain.com/game\" rel=\"nofollow\">http://mydomain.com/game</a>?  So any url with /game would direct to the Rails 3.1 app and all other urls would direct to the regular 2.3 app?  How would I approach this using nginx using a subdirectory (I'd rather not use a subdomain and lose seo)? </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","mvc","redirect"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12967735,"title":"Redirect action not working","body":"<p>I'm guessing this one's pretty easy to do, but I don't know how, so I figured I'd ask. </p>\n\n<p>I have a delay job in my app that calls a roll_back method in my Order model if something hasn't happened within five minutes. That method both destroys the instance it's called on and, before doing so, does a bunch of related things to associated models. The method is working just great.</p>\n\n<p>The trouble is, once the method is done running, most users will be on the show page for the Order that has just been deleted, and I was hoping to redirect users to a different page once the time ran out and that roll_back method was called. </p>\n\n<p>So I originally just tried this in the rollback method, right after the \"self.destroy\" line.</p>\n\n<pre><code>redirect_to \"/orders/new\", :notice =&gt; \"Blah\"\n</code></pre>\n\n<p>Didn't work, though. And at any rate, some poking around on the internet informed me that actions like redirect should be in the controller instead. </p>\n\n<p>So I instead went and put that line in the Orders Controller's destroy method, right after @order.destroy. I figured when the roll_back method called self.destroy, it'd then do the redirect -- but that didn't work either, I'm guessing because the model destroy doesn't go through the controller. </p>\n\n<p>So I'm not really sure how to do this. All the delay job/rollback stuff is in my model, but I'm apparently not supposed / unable to redirect users from the model. Any idea how to do this?</p>\n\n<hr>\n\n<p>Tried this again, with this in my method, in case it was a routing error (I know orders_path to exist). </p>\n\n<pre><code>def destroy\n    @order = Order.find(params[:id])\n    @order.destroy\n    redirect_to orders_path, notice: \"blah\"\nend\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","iframe","paypal"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":132,"score":1,"question_id":12860161,"title":"Paypal Embedded Flow not using returnUrl or cancelUrl","body":"<p>I am using Paypals Adaptive Payments and Embedded flow feature to provide checkout via a minibrowser. Everything seems to be working correctly in the sandbox environment except that when the payment is completed successfully, the user is never redirected to my returnUrl set in the PAY API request. Same goes for my cancelUrl. </p>\n\n<p>After the payment is complete, the user is shown an order overview in the minibrowser and a button labelled \"close\". If a user clicks this button, the minibrowser is closed. </p>\n\n<p>If a user clicks cancel at any time, the minibrowser is closed. </p>\n\n<p>There doesn't seem to be a way to have my page aware of the change besides setting up some polling or something which doesn't make sense, my returnUrl and cancelUrl should be used somewhere, right?</p>\n\n<p>this is my code to get the redirect url (using adaptive payments gem):</p>\n\n<pre><code>pay_request = PaypalAdaptive::Request.new\ndata = {\n  'requestEnvelope' =&gt; {'errorLanguage' =&gt; 'en_US'},\n  'currencyCode' =&gt; 'USD',\n  'receiverList' =&gt;\n          { 'receiver' =&gt; [\n            {'email' =&gt; '...', 'amount'=&gt; 10.00}\n          ]},\n  'actionType' =&gt; 'PAY',\n  'returnUrl' =&gt; 'http://www.example.com/paid',\n  'cancelUrl' =&gt; 'http://www.example.com/cancelled',\n  'ipnNotificationUrl' =&gt; 'http://www.example.com/ipn'\n}\n\npay_response = pay_request.pay(data)\nredirect_to pay_response.approve_paypal_payment_url \"mini\"\n</code></pre>\n\n<p>And here is how I am setting up the paypal js:</p>\n\n<pre><code>var dg = new PAYPAL.apps.DGFlowMini({ trigger: \"buyit\", expType: \"mini\" });\n</code></pre>\n\n<p>It all seems pretty straight forward, not sure what I am missing.</p>\n"},{"tags":["ruby-on-rails-3","validation","callback","update-attribute"],"answer_count":3,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":76,"score":2,"question_id":12936873,"title":"Rails update_attribute replacement?","body":"<p>Is there a replacement for <code>update_attribute</code>? I know you can still use it in Rails 3 but you get deprecation messages.</p>\n\n<p>The reason why I need to use <code>update_attribute</code> is because I need to skip validations but run callbacks.</p>\n\n<p>The only way that I've found of doing this (and avoid deprecation messages), is by simply extracting the code from <code>update_attribute</code>:</p>\n\n<pre><code>Object.send(\"#{attribute}=\", value)\nObject.save(:validate =&gt; false)\n</code></pre>\n\n<p>I'd like to know if there is another (proper) way of doing this.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":544,"score":0,"question_id":8332572,"title":"flash notice is lost on redirect, how to find out what's removing it?","body":"<p>There are many posts on SO about this ( <a href=\"http://stackoverflow.com/questions/6101631/respond-with-redirect-with-notice-flash-message-not-working\">respond_with redirect with notice flash message not working</a>  <a href=\"http://stackoverflow.com/questions/4799395/why-is-notice-not-showing-after-redirect-in-rails-3\">Why is :notice not showing after redirect in Rails 3</a>, among others) , I've read at least 4 and still can't solve this issue. </p>\n\n<p>I've got a portion of my site that lets people do some things before they create an account. I prefer this from a UX perspective. So they're allowed to do X and Y then they get redirected to the \"Create account\" page (uses Devise). </p>\n\n<p>The redirect looks like: </p>\n\n<pre><code>if userIsNew \n  ... stow information in a cookie to be retrieved later ...     \n  redirect_to \"/flash\", flash[:notice]  \n    =&gt; \"Ok, we'll get right on that after you sign up (we need your email).\" \n      and return # this has to be here, since I'm terminating the action early\nend \n</code></pre>\n\n<p>So <code>\"/flash\"</code> is a plain page that I made to test this. It doesn't do anything, has no markup of its own, just has the basic html from the application.html, which has this line in the body: </p>\n\n<pre><code> &lt;% if flash[:notice] %&gt;\n    &lt;p&gt;&lt;%= notice %&gt;&lt;/p&gt;\n &lt;% else %&gt;\n  No notice!\n &lt;% end %&gt;\n</code></pre>\n\n<p>It says 'No notice' every time. </p>\n\n<p>I have tried: </p>\n\n<ul>\n<li>adding in a flash.keep to my <code>before_filter</code> in the static controller </li>\n<li>using <code>:notice =&gt;</code> instead of <code>flash[:notice] =&gt;</code></li>\n<li>putting the notice in a cookie and pulling that text out of the cookie and into a flash in the before_filter of my application controller</li>\n<li><code>redirect_to :back</code> with the <code>flash[:notice] =&gt;</code></li>\n</ul>\n"},{"tags":["ruby-on-rails-3","redis","leaderboard"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":66,"score":2,"question_id":12874181,"title":"Redis zrevrangebyscore, sorting other than lexicographical order","body":"<p>I have implemented a leader board using sorted sets in redis. I want users with same scores to be ordered in chronological order, i.e., user who came first should be ranked higher. Currently redis supports lexicographical order. Is there a way to override that. Mobile numbers are being used as members in sorted set.</p>\n\n<p>One solution that I thought of is appending timestamp in front of mobile numbers and maintaining a hash to map mobile number and timestamp.</p>\n\n<pre><code>$redis.hset('mobile_time', '1234567890', \"#{Time.now.strftime('%y%m%d%H%M%S')}\")\npref = $redis.hget('mobile_time, '1234567890'')\n$redis.zadd('myleaderboard', \"1234567890:#{pref}\")\n</code></pre>\n\n<p>That way I can get rank for a given user at any instance by adding a prefix from hash.</p>\n\n<p>Now this is not exactly what I want. This will return opposite of what I want. User who comes early will be placed below user who comes later(both with same score).</p>\n\n<pre><code>Key for user1 = 201210121953**23**01234567890    score: 400\nkey for user2 = 201210121253**26**09313123523    score: 400 (3 seconds later)\n</code></pre>\n\n<p>if I use zrevrangebyscore, user2 will be placed higher than user1. </p>\n\n<p>However, there's a way to get the desired rank:</p>\n\n<pre><code>users_with_higher_score_count = $redis.zcount(\"mysset\", \"(400\", \"+inf\")\nusers_with_same_score = $redis.zrangebyscore(\"mysset\", \"400\", \"400\")\n</code></pre>\n\n<p>Now I have the list <strong>users_with_same_score</strong> with correct ordering. Looking at index I can calculate rank of the user.</p>\n\n<p>To get leader board. I can get members in intervals of 50 and order them through ruby code. But it doesn't seems to be a good way.</p>\n\n<p>I want to know if there's a better approach to do it. Or any improvements that can be made in solution I purposed.</p>\n\n<p>Thanks in advance for your help.</p>\n\n<p>P.S. <strong>Scores are in multiples of 50</strong></p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12968397,"title":"PG::Error: ERROR: null value in column \"created_at\" when inserting records into associated model","body":"<p>I have a <code>Job</code> model and a <code>Category</code> model which I've joined using a HABTM association.</p>\n\n<p>I'm getting an error when trying to assign to <code>Categories_Jobs</code> model.</p>\n\n<p><code>PG::Error: ERROR:  null value in column \"created_at\" violates not-null constraint</code></p>\n\n<pre><code>j = Job.first\nJob Load (0.7ms)  SELECT \"jobs\".* FROM \"jobs\" LIMIT 1\n=&gt; #&lt;Job id: 7, user_id ...(removed rest of details for sake of clarity)\n\nj.categories\nCategory Load (0.8ms)  SELECT \"categories\".* FROM \"categories\" INNER JOIN \"categories_jobs\" ON \"categories\".\"id\" = \"categories_jobs\".\"category_id\" WHERE \"categories_jobs\".\"job_id\" = 7\n=&gt; [] \n\nj.category_ids = [1]\nCategory Load (6.1ms)  SELECT \"categories\".* FROM \"categories\" WHERE \"categories\".\"id\" =   $1 LIMIT 1  [[\"id\", 1]]\n(0.2ms)  BEGIN\n(0.6ms)  INSERT INTO \"categories_jobs\" (\"job_id\", \"category_id\") VALUES (7, 1)\n(0.1ms)  ROLLBACK\nActiveRecord::StatementInvalid: PG::Error: ERROR:  null value in column \"created_at\" violates not-null constraint\n</code></pre>\n\n<p>Should I remove the timestamps from my <code>Categories_Jobs</code> model?</p>\n\n<pre><code>class CreateCategoriesJobs &lt; ActiveRecord::Migration\n  def change\n    create_table :categories_jobs, :id =&gt; false do |t|\n      t.integer :category_id\n      t.integer :job_id\n      t.timestamps\n    end\n  end\nend\n</code></pre>\n\n<p>Should I be doing this another way?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","osx","postgresql"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12947005,"title":"Postgres Auth failed, no pg_hba.conf","body":"<p>I've got an app that seems to be running just fine for the most part on Postgres (for Heroku), but now that I'm trying to do some fancier stuff like starting a delayed_job worker with </p>\n\n<pre><code>RAILS_ENV=production script/delayed_job\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>FATAL:  password authentication failed for user \"&lt;myusername&gt;\" (PG::Error)\n</code></pre>\n\n<p>This is troublesome, because </p>\n\n<ol>\n<li><p>Installing postgres was a huge, confusing mess for me, as a Rails newbie, and I never remember setting a password. (I've got a password for PGAdminII, but I know that one, and this isn't it). When I go into my database.yml file and try to change the password to everything I can think of it being, it doesn't work.</p></li>\n<li><p>Fishing around on the internet, it looks like I should do something to a pg_hba.conf file, but I don't have one anywhere, apparently. </p></li>\n<li><p>I've been working on this app for weeks, and I really don't want to erase what I've got going on, so I'm wary of initdb'ing in another directory.</p></li>\n<li><p>Database stuff makes no sense to me. I've tried to figure it out, but I think I'm just too new to this stuff. And I never know where to start to fix things.</p></li>\n</ol>\n\n<p>This question is sort of vague cause I don't know enough to know what specific question to ask -- but can can anybody help me with this? Like: How do I figure out my password? What do I do about pg_hba.conf? Will I have to start a new database?</p>\n\n<p>EDIT -- Per the below suggestions (Thanks!), I ran both \"ps -A | grep postgres\" and \"ps -A | grep pg_ctl\". The output of each, respectively, is </p>\n\n<pre><code>85 ??         0:06.94 postgres: logger process    \n  101 ??         0:32.04 postgres: writer process    \n  102 ??         0:23.98 postgres: wal writer process    \n  103 ??         0:06.70 postgres: autovacuum launcher process    \n  104 ??         0:07.60 postgres: stats collector process    \n 6337 ttys002    0:00.01 grep postgres\n</code></pre>\n\n<p>and</p>\n\n<pre><code>6340 ttys002    0:00.00 grep pg_ctl\n</code></pre>\n\n<p>neither of which, unfortunately, appears to have anything preceded by -D.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","automated-tests"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12966416,"title":"Rails testing - current_account causing controller method to return nil","body":"<p>I have the following controller and test.  I keep getting</p>\n\n<pre><code>class CirclesController &lt; ApplicationController\n  before_filter :authenticate\n\n  # GET /circles\n  # GET /circles.json\n  def index\n    @circles = current_account.circles.all\n\n    respond_to do |format|\n      format.html # index.html.erb\n      format.json { render :json =&gt; @circles }\n    end\n  end\nend\n</code></pre>\n\n<p>I'm trying to test it with </p>\n\n<pre><code>require 'test_helper'\n\nclass CirclesControllerTest &lt; ActionController::TestCase\n  setup do\n    @circle = circles(:facebook)\n  end\n\n  test \"should get index\" do\n    login_as(:paul)\n    current_account(:paul)\n    get :index\n    assert_response :success\n\n    assert_not_nil assigns(:circles)\n  end\nend\n</code></pre>\n\n<p>I keep getting the following error:</p>\n\n<pre><code>test_should_get_index(CirclesControllerTest):\nNoMethodError: undefined method `circles' for nil:NilClass\n</code></pre>\n\n<p>I understand that it would be because I'm not setting current_account somehow.  So my question is, is how do I \"simulate\" current_account?</p>\n\n<p>This is current_account</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery\n\n  protected\n\n    # gets ID of current account\n    def current_account\n      return unless session[:account_id]\n      @current_account ||= Account.find_by_id(session[:account_id])\n    end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","rubygems","prawn","ransack"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":45,"score":-1,"question_id":12968062,"title":"ransack gem that i cant get searchable raw data and display in pdf file","body":"<blockquote>\n  <p>Blockquote</p>\n</blockquote>\n\n<p>In my pdf.prawn file can't get searchable data that search from ransack , and  display on the first time data that come '@search1' object same after search ..  rails 3.2.6   </p>\n\n<p>report_controller.rb </p>\n\n<pre><code> def assetregisterreports\n    @search = AssetRegister.search(params[:q])\n    @search1 = @search.where(:Asset_Name =&gt; \"os\")\n    @search.build_condition if @search.conditions.empty?\n    @search.build_sort if @search.sorts.empty?\n\n   assetregisterreports.html.erb\n&lt;h1&gt;Asset Register &lt;/h1&gt;\n\n&lt;div id = \"search\"&gt;\n&lt;%= search_form_for @search, url: search_assetregisterreports_path, :method =&gt;:post do |f| %&gt;\n  &lt;%= f.condition_fields do |c| %&gt;\n    &lt;%= render \"condition_fields\", f: c %&gt;\n  &lt;% end %&gt;\n  &lt;p&gt;&lt;%= link_to_add_fields \"Add Conditions\", f, :condition %&gt;&lt;/p&gt;\n  &lt;div class=\"field\"&gt;\n    Sort:\n    &lt;%= f.sort_fields do |s| %&gt;\n      &lt;%= s.sort_select %&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;&lt;%= f.submit \"Search\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n\n&lt;div id = \"reportpdf\"&gt;\n&lt;table id=\"products\"&gt;\n  &lt;tr&gt;\n      &lt;th&gt;Name&lt;/th&gt;   \n      &lt;th&gt;specification&lt;/th&gt;      \n      &lt;th&gt;Classification&lt;/th&gt;     \n      &lt;th&gt;Location&lt;/th&gt;   \n      &lt;th&gt;Owner&lt;/th&gt;      \n      &lt;th&gt;custodian&lt;/th&gt;      \n      &lt;th&gt;Live_Since&lt;/th&gt;     \n      &lt;th&gt;Disposed&lt;/th&gt;\n  &lt;/tr&gt;\n\n&lt;% @search1.each do |assetregister| %&gt;\n   &lt;tr class=\"&lt;%= cycle('odd','even') %&gt;\"&gt; \n         &lt;td&gt;&lt;%= assetregister.Asset_Name %&gt;&lt;/td&gt;\n         &lt;td&gt;&lt;%= assetregister.Asset_Specification %&gt;&lt;/td&gt;       \n         &lt;td&gt;&lt;%= assetregister.Asset_Classification %&gt;&lt;/td&gt;      \n         &lt;td&gt;&lt;%= assetregister.Asset_Location %&gt;&lt;/td&gt;        \n         &lt;td&gt;&lt;%= assetregister.Asset_Owner %&gt;&lt;/td&gt;        \n         &lt;td&gt;&lt;%= assetregister.Asset_Custodian %&gt;&lt;/td&gt;       \n         &lt;td&gt;&lt;%= assetregister.Asset_Live_Since %&gt;&lt;/td&gt;          \n         &lt;td&gt;&lt;%= assetregister.Asset_Disposed %&gt;&lt;/td&gt;    \n  &lt;/tr&gt;\n&lt;% end %&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n&lt;div class=\"pdf_link\"&gt;\n&lt;%= link_to \"E-version\", {:controller =&gt; 'reports', :action =&gt; 'assetregisterreports', :id =&gt; '@search1', :format =&gt; \"pdf\"} %&gt;   \n  &lt;/div&gt;\n\n\nassetregisterreports.pdf.prawn\n\npdf.text \"Asset  Register\", :align =&gt; :center, :size =&gt; 30, :style =&gt; :bold\npdf.move_down(30)\n\npdf.text \"Asset_Name Asset_Specification Asset_Classification Asset_Location Asset_Owner Asset_Custodian\" , :size =&gt; 10.5\n\n\n\nitems = @search1.map do |item|\n\n[\n    item.Asset_Name ,\n    item.Asset_Specification ,\n    item.Asset_Classification ,\n    item.Asset_Location,\n    item.Asset_Owner ,\n    item.Asset_Custodian\n    ]\n\nend\n\npdf.table items \n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":31,"score":-2,"question_id":12967983,"title":"Edit page is not populating with nested classes","body":"<p>I have 3 classes EmployeeDetails, which belong to ContactDetails, which belong to Address.\nMy requirement is to save all the values from EmployeeDetails create page.</p>\n\n<pre><code> class EmployeeDetail &lt; ActiveRecord::Base\n   acts_as_authorization_object :role_class_name =&gt; 'Role', :subject_class_name =&gt; 'User'\n\n   STATUS_ACTIVE = 'ACTIVE'\n   STATUS_INACTIVE  = 'INACTIVE'\n\n   STATUSES = {\n     STATUS_ACTIVE =&gt; 'ACTIVE',\n     STATUS_INACTIVE  =&gt; 'INACTIVE'\n   }\n\n   belongs_to :Designation\n   belongs_to :Department\n   belongs_to :ContactDetails\n   belongs_to :EmployeeType\n   belongs_to :User\n   belongs_to :manager , :class_name=&gt;'EmployeeDetail'\n   has_many :employee , :class_name=&gt;'EmployeeDetail', :foreign_key =&gt; \"manager_id\"\n   has_many :leave_details \n   attr_accessible :bloodGroup, :dob, :doc, :doj, :empId, :name, :panNo, :status,:EmployeeType_id,:manager_id,:Designation_id,:Department_id, :ContactDetails_id\n\n end\n\n\n\nclass ContactDetails &lt; ActiveRecord::Base\n  acts_as_authorization_object :role_class_name =&gt; 'Role', :subject_class_name =&gt; 'User'\n  attr_accessible :emergencyContactNo, :homeContactNo, :personalContactNo, :communicationAddress, :permanentAddress\n  belongs_to :communicationAddress, :class_name=&gt;'Address'\n  belongs_to :permanentAddress, :class_name=&gt;'Address'\n  validates :emergencyContactNo, presence: true\n  validates :homeContactNo, presence: true\n  validates :personalContactNo, presence: true\nend\n\n\nclass Address &lt; ActiveRecord::Base\n  attr_accessible :city, :country, :pin, :state, :street\nend\n</code></pre>\n\n<p>This is some part of _form.html.erb</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n    &lt;!--div class=\"edlabel\"&gt;&lt;%= f.label :name, 'Name' %&gt;&lt;/div--&gt;\n&lt;span&gt;Name&lt;/span&gt;\n    &lt;div&gt;&lt;%= f.text_field :name, :class =&gt; 'phcolor', 'data-validation' =&gt; 'required' %&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"field\"&gt;\n    &lt;!--div class=\"edlabel\"&gt;&lt;%= f.label :Designation %&gt;&lt;/div--&gt;\n&lt;span&gt;Designation&lt;/span&gt;\n    &lt;div&gt;&lt;%=f.collection_select :Designation_id, Designation.all, :id, :name, :include_blank =&gt; 'Designation '%&gt;&lt;/div&gt;\n&lt;/div&gt;\n\n&lt;%= f.fields_for :contact_detail do |contact_fields| %&gt;\n\n&lt;div style=\"float:left;width:350px;\"&gt;\n    &lt;%= contact_fields.fields_for :communicationAddress do |communication_fields| %&gt;\n    &lt;span class=\"myh1\"&gt;Communication Address&lt;/span&gt;&lt;hr class=\"myline2\"&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= communication_fields.label :street, 'Street' %&gt;&lt;/div--&gt;\n            &lt;span&gt;Street&lt;/span&gt;\n                &lt;div&gt;&lt;%= communication_fields.text_field :street %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= communication_fields.label :city, 'City' %&gt;&lt;/div--&gt;\n            &lt;span&gt;City&lt;/span&gt;\n                &lt;div&gt;&lt;%= communication_fields.text_field :city %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= communication_fields.label :state, 'State' %&gt;&lt;/div--&gt;\n            &lt;span&gt;State&lt;/span&gt;\n                &lt;div&gt;&lt;%= communication_fields.text_field :state %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= communication_fields.label :country, 'Country' %&gt;&lt;/div--&gt;\n            &lt;span&gt;Country&lt;/span&gt;\n                &lt;div&gt;&lt;%= communication_fields.text_field :country %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= communication_fields.label :pin, 'Pin' %&gt;&lt;/div--&gt;\n            &lt;span&gt;Pin&lt;/span&gt;\n                &lt;div&gt;&lt;%= communication_fields.text_field :pin %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;% end %&gt;\n\n &lt;%= contact_fields.fields_for :permanentAddress do |permanent_fields| %&gt;\n    &lt;span class=\"myh1\"&gt;Permanent Address&lt;/span&gt;&lt;hr class=\"myline2\"&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= permanent_fields.label :street, 'Street' %&gt;&lt;/div--&gt;\n            &lt;span&gt;Street&lt;/span&gt;\n                &lt;div&gt;&lt;%= permanent_fields.text_field :street %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= permanent_fields.label :city, 'City' %&gt;&lt;/div--&gt;\n            &lt;span&gt;City&lt;/span&gt;\n                &lt;div&gt;&lt;%= permanent_fields.text_field :city %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= permanent_fields.label :state, 'State' %&gt;&lt;/div--&gt;\n            &lt;span&gt;State&lt;/span&gt;\n                &lt;div&gt;&lt;%= permanent_fields.text_field :state %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class=\"edlabel\"&gt;&lt;%= permanent_fields.label :country, 'Country' %&gt;&lt;/div--&gt;\n            &lt;span&gt;Country&lt;/span&gt;\n                &lt;div&gt;&lt;%= permanent_fields.text_field :country %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"field\"&gt;\n                &lt;!--div class\"edlabel\"&gt;&lt;%= permanent_fields.label :pin, 'Pin' %&gt;&lt;/div--&gt;\n            &lt;span&gt;Pin&lt;/span&gt;\n                &lt;div&gt;&lt;%= permanent_fields.text_field :pin %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>This is create action of my controller:-</p>\n\n<pre><code> def create\n@user=User.new(params[\"employee_detail\"][\"user\"])\n@user.username=params[\"employee_detail\"][\"user\"][\"email\"]\n\n@permanent_address=Address.new(params['employee_detail']['contact_detail']['permanentAddress'])\n@permanent_address.save\n@communication_address=Address.new(params['employee_detail']['contact_detail']['communicationAddress'])\n@communication_address.save\n\nparams[\"employee_detail\"]['contact_detail'].delete(\"permanentAddress\")\nparams[\"employee_detail\"]['contact_detail'].delete(\"communicationAddress\")\n@contact_detail=ContactDetails.new(params[\"employee_detail\"][\"contact_detail\"])\n@contact_detail.permanentAddress_id=@permanent_address.id\n@contact_detail.communicationAddress_id=@communication_address.id\n@contact_detail.save\nparams[\"employee_detail\"].delete(\"contact_detail\")\nparams[\"employee_detail\"].delete(\"user\")\n\n@employee_detail = EmployeeDetail.new(params[\"employee_detail\"])\n\n@employee_detail.ContactDetails_id=@contact_detail.id\n\nif @user.save\n    @employee_detail.User_id=@user.id\nUser.find(@user.id).has_role!(params[\"role\"] )\nend\n\nrespond_to do |format|\n  if @employee_detail.save\n    format.html { redirect_to @employee_detail, notice: 'Employee detail was successfully created.' }\n    format.json { render json: @employee_detail, status: :created, location: @employee_detail }\n  else\n @user.destroy\n     @permanent_address.destroy\n     @communication_address.destroy\n     @contact_detail.destroy\n    format.html { render action: \"new\" }\n    format.json { render json: @user.errors, status: :unprocessable_entity }\n    format.json { render json: @employee_detail.errors, status: :unprocessable_entity }\n   end\n  end\n end\n</code></pre>\n\n<p>I am able to create and edit EmployeeDetails along with, ContactDetails, Address and Users but my problem is that when i go to the edit page, ContactDetails information are not getting populated with the values. I have to fill all the address informations at the time of edit. Other values like name, dob, doc, doj are getting populated. At the time of edit if i refresh the edit page all the information filled for ContactDetails get cleared and i see only blank textboxes. Can any one tell me what is going wrong in this code. thnks for ur help.</p>\n"}]}
{"total":34675,"page":16,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":35,"score":2,"question_id":12967809,"title":"Passing arguments when using redirect_to","body":"<p>In my Rails controller, in one method I do a <code>redirect_to</code> to another path (i.e. another method). I want to also pass arguments from the first method, so that the second method can use them. Is that possible?</p>\n"},{"tags":["ruby-on-rails-3","heroku","rake","dbmigrate"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12967083,"title":"Can Push to Heroku But Can't Run Migration","body":"<p>I can push a Rails app to Heroku with ...\n<code>\n    git push heroku\n</code>\nbut when I try to migrate with ...\n<code>\n    heroku run rake db:migrate\n</code>\nI get ...</p>\n\n<p><code>\n    Running rake db:migrate attached to terminal... failed\n     !    You do not have access to the app my-app-name-1234.\n</code></p>\n\n<p>Edit: my .git/config contains ...\n<code>\n    [remote \"heroku\"]\n            url = git@heroku.com:young-mist-1198.git\n            fetch = +refs/heads/*:refs/remotes/heroku/*\n</code></p>\n\n<p>Any ideas? Things look reasonable on the Heroku side and it seems like if my ssh key were bad, it wouldn't even let me push.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sphinx","thinking-sphinx"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12967379,"title":"ThinkingSphinx & Rails 3 - How to add a conditional to a sphinx attribute?","body":"<p>I have the following index on my Ad model:</p>\n\n<pre><code>has_many :listings\n\ndefine_index do\n    indexes :name\n    indexes :category\n\n    has listings.grades.id, :as =&gt; :listings_grades, :facet =&gt; true\nend\n</code></pre>\n\n<p>However I need sphinx to:</p>\n\n<ol>\n<li>Index all Ad models, regardless weather the Ad has any listings entries</li>\n<li>index :listings_grades only when the listing.pub_end_date date field is not nil i.e. I am only interested in :listings_grades which have a non-nil pub_end_date value.</li>\n</ol>\n\n<p>For the last part, I have no idea how to put a conditional statement / filter onto the :listings_grades attribute to do this. Does anyone have any ideas?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3","slideshow","asset-pipeline"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12967049,"title":"routing/asset pipeline issue - undefined javascript method","body":"<p>I'm getting back into Rails (it's been a few years) so I'm pretty sure I'm just missing something simple.  Tho it could also be my lack of understand of how javascript works within Rails.</p>\n\n<p>I think I have my view (in haml) set up correctly. I have added the javascript to a file that I made sure was included in the layout.  (And the css looks right.)  I'm just not getting the javascript function (a slideshow I found online) to connect to the view.  I'm trying to use <code>%body{ :onload =&gt; setUpslideShow() }</code></p>\n\n<p>Here's my view:</p>\n\n<pre><code>%body{ :onload =&gt; setUpSlideShow() }\n\n%script{type: 'text/javascript'}\n  if ( ! window.CMFmainmenu ) { CMFmainmenu = {}; }\n  var s                   = CMFmainmenu;\n  s.user_id               = \"#{@user.id.to_s}\";\n  s.partial_mainmenu_path = \"/users/\" + s.user_id + \"/xx/mainmenu\";\n  s.add_new_senior        = \"#{UsersController::ADD_NEW_SENIOR}\"\n  s.add_new_senior_path   = \"#{new_seniors_settings_path(@locale,@user,@senior)}\"\n\n#mainmenu\n\n... (edited out to save space) ...\n\n #slideshow.greenBorder\n        #slides\n          = image_tag '/assets/newlook/div_1_img.png', class: 'slide'\n          %p\n            Everyone loves photo albums.\n            Get your user ready to brag, and\n            populate and arrange albums by\n            event, special people, year or any\n            category you can imagine.\n            =link_to \"Learn how.\", ''\n          = image_tag '/assets/newlook/div_2_img.png', class: 'slide'\n          %p\n            If typing is difficult for your\n            loved one, remove the frustration\n            of a typed response. They can\n            respond with a voice message, or\n            with auto replies that you set up.\n            =link_to \"Learn how.\", ''\n          = image_tag '/assets/newlook/div_3_img.png', class: 'slide'\n          %p\n            Arms too short? You can specify\n            the minimum font size used for\n            your user's email.\n            =link_to \"Learn how.\", ''\n        #slides-controls\n          1\n          2\n          3\n</code></pre>\n\n<p>Here's my javascript:</p>\n\n<pre><code>if (! window.CMFuser) { CMFuser = {}; }\n\n$(function() {\n\n    var s = CMFuser;\n\n... (edited out to save space) ...\n\n       // slideshow\n\n       slidePrefix            = \"slide-\";\n       slideControlPrefix     = \"slide-control-\";\n       slideHighlightClass    = \"highlight\";\n       slidesContainerID      = \"slides\";\n       slidesControlsID       = \"slides-controls\";\n\n       setUpSlideShow =  function()\n       {\n... lots of code that doesn't get called so I'm leaving it out to save space ...\n</code></pre>\n\n<p>And here's what I think the relevant line is in the layout: <code>= javascript_include_tag \"lib/modernizr-2.0.6.min\", \"lib/respond.min\",\"application\", \"users\"</code> where \"users\" is the javascript file.  When I comment out the  <code>%body{ :onload =&gt; setUpslideShow() }</code>, the javascript file appears in the html source.</p>\n\n<p>The full text of the error:</p>\n\n<pre><code>NoMethodError in Users#mainmenu\n\nShowing /opt/cmf/app/views/users/mainmenu.html.haml where line #4 raised:\n\nundefined method `setUpSlideShow' for #&lt;#&lt;Class:0x007fe054fa0a28&gt;:0x007fe05594ae20&gt;\nExtracted source (around line #4):\n\n2: - # users/mainmenu\n3: \n4: %body{ :onload =&gt; setUpSlideShow() }\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","amazon-s3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12909315,"title":"Ruby aws-sdk - grant permission to all users","body":"<p>I am writing the code to grant READ permissions to all users using <strong>aws-sdk</strong> gem.  In the documentation for the gem, I found the following:</p>\n\n<pre><code>bucket.objects.each do |object|\n  puts object.key\n  acl = object.acl\n  acl.grant(:read).to(\"TODO: how can I specify 'ALL'???\")\n  object.acl = acl.to_xml\nend\n</code></pre>\n\n<p>It all makes sense, however I'm not quite sure how can I tell the grant read permission to <strong>ALL</strong> users?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","partial-views","renderpartial"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12965624,"title":"how do I break f.submit from form builder into a partial layout in rails 3?","body":"<p>I am building a multi step form, and I'd like to reuse the button code across multiple views. here is the code I'd like to break out into a partial layout:</p>\n\n<pre><code>&lt;div class=\"actions\"&gt;\n&lt;%= link_to \"Back\", previous_wizard_path, :class =&gt; 'btn btn-large' %&gt;\n&lt;%= f.submit \"Next\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I have copied this code into a new partial layout called \"_action_buttons.html.erb\".</p>\n\n<p>I am trying to render this partial with the following code:</p>\n\n<pre><code>&lt;%= render 'multi_form/action_buttons' %&gt;\n</code></pre>\n\n<p>However, when I try to run this, I get the following error due to the f.submit:</p>\n\n<pre><code>undefined local variable or method `f' for #&lt;#&lt;Class:0x007fbae16c1dc8&gt;:0x007fbae13b33e8&gt;\n</code></pre>\n\n<p>Extracted source (around line #3):</p>\n\n<pre><code>1: &lt;div class=\"actions\"&gt;\n2:     &lt;%= link_to \"Back\", previous_wizard_path, :class =&gt; 'btn btn-large' %&gt;\n3:     &lt;%= f.submit \"Next\", class: \"btn btn-large btn-primary\" %&gt;\n4:   &lt;/div&gt;\n</code></pre>\n\n<p><strong>how can I modify my render call so that this error doesn't happen?</strong> I realize this is probably a common issue; help a noob out!</p>\n"},{"tags":["ruby-on-rails-3","carrierwave"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":12966769,"title":"fine upload rails carrierwave photo not being renamed","body":"<p>Ok, so I am using fine uploader to ajax upload some images with carrierwave.  The upload works, but it does not generate the uuid, rather saving it as Uploaded.xx.  My controller is:</p>\n\n<pre><code>def create\n ajax_upload = params[:qqfile].is_a?(String)\n filename = ajax_upload  ? params[:qqfile] : params[:qqfile].original_filename        \n extension = filename.split('.').last\n  # Creating a temp file\n  tmp_file = \"#{Rails.root}/tmp/uploaded.#{extension}\"      \n  id = 0\n while File.exists?(tmp_file) do\n    tmp_file = \"#{Rails.root}/tmp/uploaded-#{id}.#{extension}\"  \n    id += 1\n end\n# Save to temp file\nFile.open(tmp_file, 'wb') do |f|\n   if ajax_upload\n      f.write  request.body.read\n   else\n      f.write params[:qqfile].read\n   end\n end    \npage = Page.find(2)\n if params[:overwrite] == true\n  previous ||= Page.find.photos.where(\"location = ?\", params[:location])\nend \n\nphoto = page.photos.build(location: params[:location], order: params[:order])\nphoto.image = File.open(tmp_file)\nif photo.save\n    render text: '{\"success\":true}'\n end\n end\n\n\n\n\n # encoding: utf-8\n\n   class PhotoUploader &lt; CarrierWave::Uploader::Base\n\n  # Include RMagick or MiniMagick support:\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  # Include the Sprockets helpers for Rails 3.1+ asset pipeline compatibility:\n  # include Sprockets::Helpers::RailsHelper\n  # include Sprockets::Helpers::IsolatedHelper\n\n  # Choose what kind of storage to use for this uploader:\n   storage :file\n  # storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"storage5\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url\n  #   # For Rails 3.1+ asset pipeline compatibility:\n  #   # asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n  #\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process :scale =&gt; [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  version :phone do\n     process :resize_to_fit =&gt; [1300, 1300]\n  end\n  version :small, :from_version =&gt; :phone do\n     process :resize_to_fit =&gt; [350, 350]\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_white_list\n          %w(jpg jpeg gif png)\n        end\n\n        # Override the filename of the uploaded files:\n        # Avoid using model.id or version_name here, see uploader/store.rb for details.\n      def filename\n\n        @filename ||= \"#{secure_token}.#{file.extension}\" if original_filename.present?\n\n     end \n      protected\n      def secure_token\n      var = :\"@#{mounted_as}_secure_token\"\n    model.instance_variable_get(var) or model.instance_variable_set(var, SecureRandom.uuid)\n    end\n\n    end\n</code></pre>\n\n<p>The photos model is: </p>\n\n<pre><code> class Photo &lt; ActiveRecord::Base\n  attr_accessible :image, :location, :order, :title, :caption\n belongs_to :page\n mount_uploader :image, PhotoUploader\nend\n</code></pre>\n\n<p>The location stores where the photo goes on a page, order is for sorting, title stores the title, and caption stores a caption.  </p>\n\n<p>I've been working on this most of the day and I am ready to punch my computer.  Any help would be appreciated.  </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":565,"score":5,"question_id":8566703,"title":"Can not allocate memory","body":"<p>For some reason processing images (carrierwave + minimagick) stops working about a week after the service is started. There is no unusual increase in traffic or upload processes. Once the ENOMEM error occurs everything seems to 'lock up' and any following processes fail as well.</p>\n\n<p><strong>How can I 'rescue' the system once it is in that behavior or even prevent this from happening?</strong> </p>\n\n<p>Some of the errors:</p>\n\n<pre><code>Errno::ENOMEM (Cannot allocate memory - export LANG=C &amp;&amp; identify -ping /tmp/mini_magick20111219-18047-1dhmawm.jpg 2&gt;&amp;1):\n   app/uploaders/photo_uploader.rb:70:in `custom_thumbnail'\n   app/controllers/upload_controller.rb:186:in `process_upload'\n   app/middleware/flash_session_cookie_middleware.rb:17:in `call'\n   app/middleware/flash_session_cookie_middleware.rb:17:in `call'\n\n\nErrno::ENOMEM (Cannot allocate memory - export LANG=C &amp;&amp; mogrify -format jpg /tmp/mini_magick20111219-18047-1c43qpf.jpg 2&gt;&amp;1):\n   app/controllers/upload_controller.rb:186:in `process_upload'\n   app/middleware/flash_session_cookie_middleware.rb:17:in `call'\n   app/middleware/flash_session_cookie_middleware.rb:17:in `call'\n\n...\n...\n\nErrno::ENOMEM (Cannot allocate memory - export LANG=C &amp;&amp; mogrify -resize \"120x180\" -gravity \"Center\" -extent \"120x120\" /tmp/mini_magick20111219-18047-155ofje.jpg 2&gt;&amp;1):\n   app/controllers/upload_controller.rb:186:in `process_upload'\n   app/middleware/flash_session_cookie_middleware.rb:17:in `call'\n   app/middleware/flash_session_cookie_middleware.rb:17:in `call'\n</code></pre>\n\n<p>Memory and swap space info:</p>\n\n<pre><code>Mem:   8193476k total,  7907152k used,   286324k free,     5968k buffers\nSwap: 12396808k total,  9494924k used,  2901884k free,   180308k cached\n</code></pre>\n\n<p>Version information:</p>\n\n<ul>\n<li>Rails 3.0.6</li>\n<li>ruby 1.9.2p290</li>\n<li>Apache 2.2.14</li>\n<li>passenger 3.0.9</li>\n</ul>\n\n<p><strong>Thank you!</strong></p>\n"},{"tags":["ruby-on-rails-3","friendly-id"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12953508,"title":"Rails 3: hiding model ids from generated forms with friendly_id","body":"<p>Whenever I use form_for, say for an edit view, the generated HTML directs to the correct action (ie the slugged URL). But the form's id tag still contains the object's numeric id:</p>\n\n<pre><code>&lt;form ... action=\"/characters/captain-falcon\" ... id=\"edit_character_15\"&gt;\n</code></pre>\n\n<p>Is there any way to hide the numeric ID entirely? What I'm trying to accomplish here is tell Rails to set the form's id to \"edit_character_captain-falcon\" rather than \"edit_character_15\". Or to not set the form's id at all.</p>\n\n<p>I considered overriding the form_for helper. Unfortunately, this problem also shows up with the fields_for helper, and probably in other places too, so I was wondering if anyone knew of a solution that would address the root of the problem.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching","varnish","rack-cache"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":74,"score":0,"question_id":12927095,"title":"What is the point of Varnish and Rack-Cache for a Rails app?","body":"<p>I am a bit confused about the purpose of Varnish and Rack-Cache for a Rails app. In <code>config/environments/production.rb</code> caching can be set with something like</p>\n\n<p><code>config.static_cache_control = \"public, max-age=3600\"</code></p>\n\n<p>Given that, what exactly is the purpose of Varnish and Rack-Cache if you can set caching in the Rails app itself?</p>\n\n<p>And what causes the default Rails app to use rack-cache?</p>\n"},{"tags":["database","ruby-on-rails-3","image","blob","render"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12966128,"title":"Rails 3 Display multiple images from database","body":"<p>I have several images stored in the database in Binary format (BLOB) and need them to be displayed in a single view.</p>\n\n<p>I know that you can load a single image from the database and display it using:</p>\n\n<pre><code>send_data (data, :type =&gt; filetype,\n                 :filename =&gt; filename,\n                 :disposition =&gt; 'inline')\n</code></pre>\n\n<p>I don't know how I could make it render more than one image at a time.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actioncontroller"],"answer_count":3,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3365,"score":5,"question_id":5691727,"title":"How to set config.action_controller.default_url_options = {:host = '#''} on per environment basis","body":"<p>Right now I'm using this which works for the development host, but I have to manually change the {:host => \"\"} code when I move to production.</p>\n\n<h3>post.rb</h3>\n\n<pre><code>def share_all\n  url =  Rails.application.routes.url_helpers.post_url(self, :host =&gt; 'localhost:3000')\n  if user.authentications.where(:provider =&gt; 'twitter').any?\n    user.twitter_share(url)  \n  end\nend\n</code></pre>\n\n<p>I'd like to use this and then define the default_url_options per environment:</p>\n\n<h3>post.rb</h3>\n\n<pre><code>def share_all\n  url =  Rails.application.routes.url_helpers.post_url(self)\n  if user.authentications.where(:provider =&gt; 'twitter').any?\n    user.twitter_share(url)  \n  end\nend\n</code></pre>\n\n<p>I've tried adding this to my config/environments/development.rb but I still get the \"Missing host to link to! Please provide :host parameter or set default_url_options[:host]\" error </p>\n\n<h3>development.rb</h3>\n\n<pre><code>config.action_controller.default_url_options = {:host =&gt; \"localhost:3000\"}\n</code></pre>\n\n<p>And I even tried it this way:</p>\n\n<h3>development.rb</h3>\n\n<pre><code>config.action_controller.default_url_options = {:host =&gt; \"localhost\", :port =&gt; \"3000\"}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I've now also followed this and still the same error guide <a href=\"http://edgeguides.rubyonrails.org/action_controller_overview.html#default_url_options\">http://edgeguides.rubyonrails.org/action_controller_overview.html#default_url_options</a></p>\n\n<h3>application controller</h3>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery\n  include ApplicationHelper\n  def default_url_options\n    if Rails.env.production?\n      { :host =&gt; \"example.com\"}\n    else\n      {:host =&gt; \"example1.com\"}\n    end\n  end\nend\n</code></pre>\n\n<p>This is driving me crazy, what am I missing here???</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","model","polymorphic-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12947692,"title":"Polymorphic association form tag_list","body":"<p>With the code:</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n&lt;%= form_for [@tagable, Tag.new] do |f| %&gt;\n    &lt;p&gt;\n        &lt;%= f.label :Tag %&gt;&lt;br /&gt;\n        &lt;%= f.text_field :tag_list %&gt;\n    &lt;p&gt;\n    &lt;div class=\"actions\"&gt;\n        &lt;%= f.submit \"Create Product\", class: \"btn btn-large btn-primary\" %&gt;\n\n    &lt;/div&gt;\n&lt;% end %&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p>I've defined at my Tag model the method:</p>\n\n<pre><code>def tag_list\n tags.map(&amp;:name).join(\", \")\nend\n\ndef tag_list=(tags_string)\n\n    tag_names = tags_string.split(\",\").collect{|s| s.strip.downcase}.uniq\n    logger.debug \"#{tag_names}\\n\\n\\n\\n\\n\\n\"\n\n    tag_names.each do |tag_name|\n      #tag = Tag.find_or_initialize_by_name(tag_name)\n      #tag.save\n      tag = Tag.find_or_create_by_name(tag_name)\n\n      logger.debug \"#{tag}\\n\\n\\n\\n\\n\\n\"\n\n    end\n end\n</code></pre>\n\n<p>The line of code at \"find_or_create....\" doesn't work, at the console it seems to work, but finally the code brings a name attribute nil. Like this:</p>\n\n<pre><code>  INSERT INTO \"tags\" (\"created_at\", \"name\", \"tagable_id\", \"tagable_type\", \"updated_at\") VALUES (?, ?, ?, ?, ?)  [[\"created_at\", Fri, 19 Oct 2012 01:04:31 UTC +00:00], [\"name\", nil], [\"tagable_id\", 19], [\"tagable_type\", \"Product\"], [\"updated_at\", Fri, 19 Oct 2012 01:04:31 UTC +00:00]]\n</code></pre>\n\n<p>Before that code I've print at the console the content of the \"tag\" that I'would like to save:</p>\n\n<pre><code>Tag Load (0.1ms)  SELECT \"tags\".* FROM \"tags\" WHERE \"tags\".\"name\" = 'musica' LIMIT 1\n  (0.0ms)  begin transaction\n  (0.1ms)  commit transaction\n</code></pre>\n\n<p>How can I create each tag of the \"tag_list\"?\nPS: I've also tried the comment code at the \"Tag Model\"</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rspec"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":129,"score":1,"question_id":7793414,"title":"How to put a value in flash when testing an action","body":"<p>I'm trying to test an action that needs a value stored in flash.</p>\n\n<pre><code>def my_action\n  if flash[:something].nil?\n    redirect_to root_path if flash[:something]\n    return\n  end\n\n  # Do some other stuff\nend\n</code></pre>\n\n<p>In my test I do something like:</p>\n\n<pre><code>before(:each) do\n  flash[:something] = \"bob\"\nend\n\nit \"should do whatever I had commented out above\" do\n  get :my_action\n  # Assert something\nend\n</code></pre>\n\n<p>The problem I'm running into is that flash has no values inside of my_action.  I'm guessing this is because no request actually happens.</p>\n\n<p>Is there a way to set flash up for a test like this?</p>\n"},{"tags":["ruby-on-rails-3","methods","gem","documentation-generation"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":23,"score":0,"question_id":12077074,"title":"Rails - Generators Module - How to insert method to application_controller?","body":"<p>I would love to clean this code up:</p>\n\n<pre><code>  def insert_general_methods\n    inject_into_file \"app/controllers/application_controller.rb\", after: \"protect_from_forgery\"  do\n      a = \"\\n\\n  private\\n\\n  def current_user\\n\"\n      b = \"    @current_user ||= User.find_by_auth_token!(cookies[:auth_token]) if cookies[:auth_token]\\n\"\n      c = \"  end\\n\"\n      d = \"\\n  helper_method :current_user\\n\\n\"\n      e = \"  def authorize\\n\"\n      f = \"    redirect_to login_url, alert: 'Not authorized. Please login.' if current_user.nil?\\n\"\n      g = \"  end\\n\"\n      a+b+c+d+e+f+g\n    end\n  end\n</code></pre>\n\n<p>Is there any method on Thor or Generator Module in Rails that allows me to inject this method in a more elegant form?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","full-text-search","sphinx","thinking-sphinx"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":84,"score":0,"question_id":10924604,"title":"thinking_sphinx ERROR: index column number 1 has no name","body":"<p>I have followed RailsCast #120 to setup Sphinx and thinking_sphinx for a Rails 3 app. I am however using Windows.  The index definition in my model looks like this:</p>\n\n<pre><code>define_index do\nindexes miniresume, :as =&gt; :miniresume\nindexes categories.categoryname, :as =&gt; :category_name\nend\n</code></pre>\n\n<p>However when I try to run rake:ts --trace, I am getting an error about column 1 not having any name.  Any help appreciated.</p>\n\n<pre><code>$ rake ts:index --trace\n** Invoke ts:index (first_time)\n** Invoke thinking_sphinx:index (first_time)\n** Invoke thinking_sphinx:app_env (first_time)\n** Execute thinking_sphinx:app_env\n** Execute thinking_sphinx:index\nGenerating Configuration to C:/rails32/pa02/config/development.sphinx.conf\nSphinx 2.0.4-release (r3135)\nCopyright (c) 2001-2012, Andrew Aksyonoff\nCopyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)\n\nusing config file 'C:/rails32/pa02/config/development.sphinx.conf'...\nindexing index 'post_core'...\nERROR: index 'post_core': column number 1 has no name.\ntotal 0 docs, 0 bytes\ntotal 0.083 sec, 0 bytes/sec, 0.00 docs/sec\nskipping non-plain index 'post'...\ntotal 0 reads, 0.000 sec, 0.0 kb/call avg, 0.0 msec/call avg\ntotal 0 writes, 0.000 sec, 0.0 kb/call avg, 0.0 msec/call avg\n** Execute ts:index\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12965573,"title":"Force paperclip to rename files when custom interpolation change","body":"<p>I use Paperclip to manage uploaded images for a certain Model in Rails 3. This model <code>belongs_to</code> another model. I want my image path to reflect this relationship, so I created a custom interpolation for this.</p>\n\n<p>The problem is that, I also want to be able to edit the name of the <code>belongs_to</code> objects, and I would like Paperclip to rename the files accordingly.</p>\n\n<p>Here is a simple example:</p>\n\n<pre><code>class Make &lt; ActiveRecord:Base\n  attr_accessible :name\n\n  has_many :models\nend\n\nclass Model &lt; ActiveRecord:Base\n  attr_accessible :img, :make, :name\n\n  belongs_to :make\n  has_attached_file :img, :style =&gt; { :thumb =&gt; \"100x100\" },\n                    :path =&gt; \"/cars/:make_name/:name/:style/:hash.png\",\n                    :hash_secret =&gt; \"blabla\"\n\n  Paperclip.interpolates :make_name do |attachment, style|\n    attachment.instance.make.name\n  end\n\n  Paperclip.interpolates :name do |attachment, style|\n    attachment.instance.name\n  end\nend \n</code></pre>\n\n<p>So let's say I create a make <code>Chevrolet</code> and a Model <code>Camaro</code>, my image path will be <code>/cars/chevrolet/camaro/thumb/my_hash.png</code></p>\n\n<p>If I decide to change the <code>Chevrolet</code> entry name to <code>Chevy</code>, Rails try to locate the image at <code>/cars/chevy/camaro/thumb/my_hash.png</code>, but as the image was not renamed, it's not found.</p>\n\n<p>How do I force Paperclip to update all the images paths when an entry is renamed?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby","ruby-on-rails-3","json","parsing"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12965501,"title":"Parse JSON redirect to Init point Ruby","body":"<p>With this code: </p>\n\n<pre><code>result = JSON.parse(mp_data.to_json)\n</code></pre>\n\n<p>I got the follow JSON saved at result:</p>\n\n<pre><code>{\"payment_methods\"=&gt;{}, \"init_point\"=&gt;\"https://www.mercadopago.com/mla/checkout/pay?pref_id=126967384-e4abf2e6-79c5-47c6-8c0d-fce045278336\", \"collector_id\"=&gt;126967384, \"back_urls\"=&gt;{\"failure\"=&gt;\"http://www.site.com/failure\", \"pending\"=&gt;\"https://www.site.com/pending\", \"success\"=&gt;\"http://www.site.com/success\"}, \"sponsor_id\"=&gt;nil, \"expiration_date_from\"=&gt;nil, \"additional_info\"=&gt;\"\", \"marketplace_fee\"=&gt;0, \"date_created\"=&gt;\"2012-10-18T19:46:13.791-04:00\", \"subscription_plan_id\"=&gt;nil, \"id\"=&gt;\"126967384-e4abf2e6-79c5-47c6-8c0d-fce045278336\", \"expiration_date_to\"=&gt;nil, \"expires\"=&gt;false, \"external_reference\"=&gt;\"OPERATION-ID-14288\", \"payer\"=&gt;{\"email\"=&gt;\"buyer@email.com\", \"name\"=&gt;\"John\", \"surname\"=&gt;\"Mikel\"}, \"items\"=&gt;[{\"id\"=&gt;\"123\", \"currency_id\"=&gt;\"ARS\", \"title\"=&gt;\"Example T-Shirt\", \"picture_url\"=&gt;\"http://www.site.com/image/123.png\", \"description\"=&gt;\"Red XL T-Shirt\", \"quantity\"=&gt;1, \"unit_price\"=&gt;10.5}], \"client_id\"=&gt;\"963\", \"marketplace\"=&gt;\"NONE\"}\n</code></pre>\n\n<p>How can I make a \"redirect_to\" call to the \"init_point\" url??</p>\n\n<p>Thanks!</p>\n"},{"tags":["html","css","ruby-on-rails-3","heroku","github"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12965173,"title":"Why is localhost:3000 rendering css differently than my app hosted on Heroku?","body":"<p>When checking out my GUI in localhost:3000 running locally (rails server) everything looks right, but when I push the code up to Github and then to Heroku, the CSS appears to be rendering differently. Specifically, the problem I'm having is with this bit of css:</p>\n\n<pre><code>#searchfield {\n    float: left;\n    left: 10%;\n    top: 1em;\n    position:relative;\n}\n</code></pre>\n\n<p>and the code in the view:</p>\n\n<pre><code>&lt;div id=\"searchfield\"&gt;\n    &lt;form method=\"get\" action=\"http://www.amongu.com/search.rb\"&gt; \n        &lt;input type=\"text\" name=\"search\" size=\"40px\" placeholder=\"Search\"&gt; \n    &lt;/form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>For whatever reason, the css in the page online seems to be getting partially ignored, and thus the search-box is overlapping other elements. Does anyone have any idea what could be causing this?</p>\n\n<p>Thanks</p>\n\n<p>EDIT: Here's my layout helper:</p>\n\n<pre><code># These helper methods can be called in your template to set variables to be used in the layout\n# This module should be included in all views globally,\n# to do so you may need to add this line to your ApplicationController\n#   helper :layout\nmodule LayoutHelper\n  def title(page_title, show_title = true)\n    content_for(:title) { h(page_title.to_s) }\n    @show_title = show_title\n  end\n\n  def show_title?\n    @show_title\n  end\n\n  def stylesheet(*args)\n    content_for(:head) { stylesheet_link_tag(*args) }\n  end\n\n  def javascript(*args)\n    content_for(:head) { javascript_include_tag(*args) }\n  end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","testing","fixtures"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12965040,"title":"How to make rails test fixtures be processed by \"create\" controller action before use?","body":"<p>I have a rails app with two models: Data and Request.  Data has a property called \"path\" that gets assigned during the \"create\" controller action.  Request belongs_to Data.</p>\n\n<p>My test fixture for Data does not specify the path attribute.</p>\n\n<p>When I test creation of Request, it finds the appropriate test fixture for Data in the database but the \"path\" attribute is not set.  So it seems the test fixture just goes straight into the database.  Is it possible to force the test fixtures to get processed by the controller \"create\" action instead?  Or am I missing something bigger?</p>\n\n<p>I'm using ActionController::TestCase and am new to testing in rails.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":436,"score":1,"question_id":7488396,"title":"How do you get the app name when running Rails on Heroku?","body":"<p>This means app-name.heroku.com.</p>\n\n<p>Note this is different from <code>Rails.application.class.parent_name</code>.</p>\n\n<p><code>Rails.application.class.parent_name</code> is defined in the application.</p>\n\n<p>Working in Rails 3.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":469,"score":1,"question_id":7053235,"title":"How do I get the Rails application name within a rake task?","body":"<p>I'm trying to write a Rails 3 <code>rake</code> task to generate <code>config/initializers/secret_token.rb</code>. I want to pull the application's name instead of hard-coding it in the rake task, but <code>@app_name</code> is not yet populated, nor is <code>ENV['APP_NAME']</code>. Here's the task's code:</p>\n\n<pre><code>desc \"Regenerate the server secret\"\ntask :generate_secret do\n    include ActiveSupport\n    File.open('config/initializers/secret_token.rb', 'w') do |f|\n        f.puts \"#{@app_name}::Application.config.secret_token = '#{SecureRandom.hex(30)}'\"\n    end\nend\n</code></pre>\n\n<p>It all works except that <code>@app_name</code> is blank. How can I retrieve the application name here?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12963458,"title":"passing an array from controller to view in ruby","body":"<p>I have the following code in my Ruby Controller :</p>\n\n<p><strong>mastertest_controller.rb</strong></p>\n\n<pre><code>def index\n\n ......\n\n @mastertest = connection.execute(\"select code_ver from mastertest\")\n result_array = { sometihng }\n\n ......\n\n respond_to do |format|\n  format.html # index.html.erb\n  format.json { render :json =&gt; @mastertest}\n  format.json { render :json =&gt; result_array}\n\n end\n</code></pre>\n\n<p>But it just allows me to access <code>@mastertest</code> in the view(<code>index.html.erb</code>). How do I pass the array to the view ???</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","spree"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12963469,"title":"Admin section for Spree doesn't work, because seeds.rb didn't fully execute during setup","body":"<p>When it got to <code>rake db:seed</code> this is the message that returned:</p>\n\n<pre><code>rake  db:seed \nCREATING ROLES\nSETTING UP DEFAULT USER LOGIN\nrake aborted!\nValidation failed: Email has already been taken\n\nTasks: TOP =&gt; db:seed\n(See full trace by running task with --trace)\n     loading  sample data\n</code></pre>\n\n<p>As a result of that, when I go to /admin in my Spree App, it just redirects to home and this is what I see in the log:</p>\n\n<pre><code>Started GET \"/admin\" for 127.0.0.1 at 2012-10-18 15:44:50 -0500\nProcessing by Spree::Admin::OverviewController#index as HTML\n  Spree::Preference Exists (0.2ms)  SELECT 1 AS one FROM \"spree_preferences\" WHERE \"spree_preferences\".\"key\" = 'spree/app_configuration/allow_ssl_in_development_and_test' LIMIT 1\n  Spree::Preference Load (0.1ms)  SELECT \"spree_preferences\".* FROM \"spree_preferences\" WHERE \"spree_preferences\".\"key\" = 'allow_ssl_in_development_and_test' LIMIT 1\n   (0.2ms)  SELECT COUNT(*) FROM \"spree_roles\" INNER JOIN \"spree_roles_users\" ON \"spree_roles\".\"id\" = \"spree_roles_users\".\"role_id\" WHERE \"spree_roles_users\".\"user_id\" IS NULL AND \"spree_roles\".\"name\" = 'admin'\nRedirected to http://localhost:3000/\nCompleted 302 Found in 585ms (ActiveRecord: 11.1ms)\n</code></pre>\n\n<p>I have a <code>user</code> that is already assigned the role of <code>admin</code>:</p>\n\n<pre><code> u\n =&gt; #&lt;User id: 1, email: \"user@example.com\", encrypted_password: \"$6CjAuPU3i1F1sHxFB6TC...\", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 1, current_sign_in_at: \"2012-10-18 08:50:41\", last_sign_in_at: \"2012-10-18 08:50:41\", current_sign_in_ip: \"127.0.0.1\", last_sign_in_ip: \"127.0.0.1\", created_at: \"2012-10-18 06:44:12\", updated_at: \"2012-10-18 08:50:41\", name: \"First User\"&gt; \n1.9.3p194 :017 &gt; u.has_role?(:admin)\n   (13.2ms)  SELECT COUNT(*) FROM \"roles\" INNER JOIN \"users_roles\" ON \"roles\".\"id\" = \"users_roles\".\"role_id\" WHERE \"users_roles\".\"user_id\" = 1 AND (((roles.name = 'admin') AND (roles.resource_type IS NULL) AND (roles.resource_id IS NULL)))\n =&gt; true \n</code></pre>\n\n<p>How do I fix this?</p>\n"},{"tags":["ruby-on-rails-3","has-and-belongs-to-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12962797,"title":"Rails 3 HABTM Join Table Re-use With Extra Field","body":"<p>So I have a HABTM relationship between my Students and Classrooms using a join table called ClassroomStudents to handle many students belonging to many classrooms. </p>\n\n<p>A recent business requirement came up that students should be able to request memberships to a classroom, so I thought that I would just create another invitation table containing classroom_id and student_id but quickly realized my classroomstudents table already handled this so I thought about simply re-using this table. I added a boolean accepted field to my classroomstudents table, true representing a membership that has been confirmed and false being the default.</p>\n\n<p>There are multiple ways in which students can be added to classrooms, one of which I want them to be accepted automatically when the relationship is built. So with the following code:</p>\n\n<pre><code>@classroom &lt;&lt; @students\n</code></pre>\n\n<p>How can I also specify a true value for this boolean accepted field instead of the default of false?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","scope","arel"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12958933,"title":"Why is Rails 3 not excluding 'or'-ed condition when overriding scopes?","body":"<p>Consider these scopes on an ActiveRecord model:</p>\n\n<pre><code>scope :onsale, where(:sales_state =&gt; \"onsale\")\nscope :outdated, where(:sales_state =&gt; \"outdated\")\nscope :onsale_or_outdated, where(\" sales_state = 'onsale' OR sales_state = 'outdated' \")\n</code></pre>\n\n<p><strong>Why is it that Rails knows to override <code>:onsale</code> with <code>:outdated</code>, but not <code>:onsale</code> with <code>:onsale_or_outdated</code>?</strong></p>\n\n<p><strong>My use case:</strong> </p>\n\n<p>I have a relation object with many scopes (let's say it's a saved search), and one of those is <code>:onsale</code>. I want to make another relation starting from that, but this time I want the <code>sales_state</code> to be either <code>onsale</code> or <code>outdated</code>. </p>\n\n<p>If I use <code>relation.onsale_or_outdated</code>, the <code>sales_state</code> is not overridden, it just adds a new condition.</p>\n\n<pre><code>[...] WHERE \"cars\".\"sales_state\" = 'onsale' [...] AND ((\"cars\".\"sales_state\" = 'onsale' OR \"cars\".\"sales_state\" = 'outdated'))\n</code></pre>\n\n<p><strong>How can I use my 'or'-ed condition in this context?</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12961811,"title":"Rails Radio Button for Two Boolean DB Attributes","body":"<p>I have an <code>Attendance</code> model that has two <code>Boolean</code> database attributes (<code>:late</code> and <code>:absent</code>) and they both have <code>:default =&gt; false</code>.</p>\n\n<p>I am trying to make a form that simply has 2 radio buttons.  One for late and one for absent.  Of course, the user can select only one of the two.</p>\n\n<p>I've tried so many variations but can't get anything to work.</p>\n\n<p>Can anyone lend me a hand?  I know I could do collection select pretty easily but radio buttons will help the user experience.  Also, I need to keep with the db schema for a bunch of reasons...</p>\n\n<p>Thanks a million!!!</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3","google-chrome"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12962435,"title":"Chrome form submit requests sometimes processed as html, or javascript","body":"<p>I have a form, with several buttons alongside of it, that are 'controlled' via Javascript.</p>\n\n<p>For instance, the one I'm concerned with does this:</p>\n\n<pre><code>    $('.edit_document').submit();\n</code></pre>\n\n<p>So far so good.  I got a few bug reports, from people on Chrome, with Windows, who were having problems with this form.  Turns out that Rails was receiving it as JS, not HTML.</p>\n\n<pre><code>Started PUT \"/documents/1236\" for xxxxxxxxxx at 2012-10-18 08:45:41 +0000\nProcessing by DocumentsController#update as HTML\n\nStarted PUT \"/documents/1229\" for yyyyyyyyyy at 2012-10-18 08:46:08 +0000\nProcessing by DocumentsController#update as JS\n\nStarted PUT \"/documents/1229\" for yyyyyyyyyy at 2012-10-18 09:06:25 +0000\nProcessing by DocumentsController#update as JS\n\nStarted PUT \"/documents/18\" for xxxxxxxxx at 2012-10-18 09:27:15 +0000\nProcessing by DocumentsController#update as HTML\n</code></pre>\n\n<p>Now, I suppose it's easy enough to add a .js handler, but I'd like to understand better why it's seemingly randomly switching back and forth between the two!</p>\n\n<p>Using: jquery 1.8.2, Rails 3.2.8, Chrome Version 22.0.1229.94 on Ubuntu (works as HTML) and Windows (works as JS).</p>\n"},{"tags":["mysql","ruby-on-rails","ruby","arrays","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":38,"score":2,"question_id":12960697,"title":"Converting a mysql2 type to an array and sorting it in ruby","body":"<p>I have a query in my ruby file :</p>\n\n<pre><code>@mastertest = connection.execute(\"select code_ver,date from mastertest\")\n</code></pre>\n\n<p>And I print the result of the query as below:</p>\n\n<pre><code>@mastertest.each do |row|\n  puts row[0] : row[1]\nend\n</code></pre>\n\n<p>This will print all the <code>code_ver</code> and 'date' which looks like this</p>\n\n<pre><code>2.0 : 2012/12/10\n3.1 : 2012/11/03\n2.5 : 2012/07/08\n1.8 : 2012/12/11\n2.5 : 2012/03/01\n</code></pre>\n\n<p>Now I want to sort this array based on my <code>code_ver</code>, but the problem is ruby does not consider this as an array, it says it is some mysql2 type. </p>\n\n<p>How do I proceed further? I want to either convert this thing to 2-d array or I would want to sort it based on the <code>row[0]</code>.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","text","nlp"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12959124,"title":"Loop through text and extract pre-defined words and word pairs in Rails","body":"<p>I have a large string of text <code>description</code>, up to 500 words long. I would like to do the following:</p>\n\n<ol>\n<li>Loop through <code>description</code> and look for a large number of pre-defined words from array <code>keywords</code>, which contains single words, word pairs and word triplets.</li>\n<li>Every time a match is found, add this match to a new array <code>matches</code> (unless already added earlier in the process) and remove the matched word(s) from <code>description</code>.</li>\n</ol>\n\n<p>I've had a look around for solutions, but most of them seem to either dive in at the deep end of natural language processing, which would be too complex for my current needs, or simply split the text string on spaces which means that it's then impossible to look for word pairs.</p>\n\n<p>Would greatly appreciate any ideas as to how to do this efficiently.</p>\n"},{"tags":["ios","ruby-on-rails-3","devise","mobile-safari"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12941714,"title":"Rails 3.2 app on Heroku with Devise: Can't log in with Mobile Safari","body":"<p>I've built an simple rails app and am deploying it to heroku. The app uses devise for authentication. Everything works fine in development and production environment, ACCEPT when one tries to log in via the Mobile Safari browser on iOS. </p>\n\n<p>Heroku logs say the following:</p>\n\n<pre><code>2012-10-17T18:56:52+00:00 app[web.1]: Started POST \"/users/sign_in\" for 87.123.175.106 at 2012-10-17 20:56:52 +0200\n2012-10-17T18:56:52+00:00 app[web.1]: Processing by Devise::SessionsController#create as HTML\n2012-10-17T18:56:52+00:00 app[web.1]:   Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"SHHVgAxRFJ8VFu2cnbh/YGn6s6q0L9Mnp24x9Whu2mk=\", \"user\"=&gt;{\"name\"=&gt;\"test\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"anmelden\"}\n2012-10-17T18:56:52+00:00 app[web.1]: WARNING: Can't verify CSRF token authenticity\n2012-10-17T18:56:53+00:00 app[web.1]: Redirected to http://xxxxxxxx.herokuapp.com/\n</code></pre>\n\n<p>The problem doesn't occur with other iOS browsers such as Opera.\nI didn't do any custom stuff to devise (except for adding a user name), it is implemented pretty much out of the box.</p>\n\n<p>I have read several posts where the issue with iOS and CSRF token is vaguely addressed, but I'm pretty new to rails and don't really know how to fix this. Can anyone help, please?</p>\n\n<p>UPDATE:</p>\n\n<p>As advised in <a href=\"http://stackoverflow.com/questions/11619683/session-nil-with-rails-3-2-6-and-authlogic-3-1-3/11654771#11654771\">this</a> post, I commented out <code>protect_from_forgery</code> in application_controller.rb as well as the <code>csrf_meta_tags</code> in application.html.erb.\nAlso, I added <code>:domain =&gt; :all</code> to config/session_store.rb.</p>\n\n<p>Nothing helped. Obiously, I don't get the <code>Can't verify CSRF token authenticity</code> error anymore, but the following logs:</p>\n\n<pre><code>2012-10-18T18:19:03+00:00 app[web.1]: Started POST \"/users/sign_in\" for 87.123.130.136 at 2012-10-18 20:19:03 +0200\n2012-10-18T18:19:03+00:00 app[web.1]: Processing by Devise::SessionsController#create as HTML\n2012-10-18T18:19:03+00:00 app[web.1]:   Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"Q+fF+9Sj2Q+X2VV34Jkrt1K8C3u4/NB6YC3yslYjkyQ=\", \"user\"=&gt;{\"name\"=&gt;\"test\", \"password\"=&gt;\"[FILTERED]\"}, \"commit\"=&gt;\"anmelden\"}\n2012-10-18T18:19:03+00:00 heroku[router]: POST pacific-beyond-5428.herokuapp.com/users/sign_in dyno=w\neb.1 queue=0 wait=0ms service=783ms status=302 bytes=107\n2012-10-18T18:19:03+00:00 app[web.1]: Redirected to http://pacific-beyond-5428.herokuapp.com/\n2012-10-18T18:19:03+00:00 app[web.1]: Completed 302 Found in 577ms (ActiveRecord: 0.0ms)\n2012-10-18T18:19:04+00:00 app[web.1]: \n2012-10-18T18:19:04+00:00 app[web.1]: \n2012-10-18T18:19:04+00:00 app[web.1]: Started GET \"/\" for 87.123.130.136 at 2012-10-18 20:19:04 +0200\n2012-10-18T18:19:04+00:00 app[web.1]: Processing by HomeController#index as HTML\n2012-10-18T18:19:04+00:00 app[web.1]: Completed 401 Unauthorized in 0ms\n2012-10-18T18:19:04+00:00 heroku[router]: GET pacific-beyond-5428.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=12ms status=302 bytes=120\n2012-10-18T18:19:04+00:00 app[web.1]: \n2012-10-18T18:19:04+00:00 app[web.1]: Started GET \"/users/sign_in\" for 87.123.130.136 at 2012-10-18 20:19:04 +0200\n2012-10-18T18:19:04+00:00 app[web.1]: Processing by Devise::SessionsController#new as HTML\n2012-10-18T18:19:04+00:00 app[web.1]: \n2012-10-18T18:19:04+00:00 app[web.1]:   Rendered layouts/_navigation.html.erb (1.4ms)\n2012-10-18T18:19:04+00:00 app[web.1]:   Rendered devise/shared/_links.html.erb (0.7ms)\n2012-10-18T18:19:04+00:00 app[web.1]:   Rendered devise/sessions/new.html.erb within layouts/application (25.8ms)\n2012-10-18T18:19:04+00:00 app[web.1]:   Rendered layouts/_messages.html.erb (0.4ms)\n2012-10-18T18:19:04+00:00 app[web.1]:   Rendered layouts/_sidebar.html.erb (0.3ms)\n2012-10-18T18:19:04+00:00 app[web.1]: Completed 200 OK in 33ms (Views: 31.9ms | ActiveRecord: 0.0ms)\n2012-10-18T18:19:04+00:00 heroku[router]: GET pacific-beyond-5428.herokuapp.com/users/sign_in dyno=web.1 queue=0 wait=0ms service=44ms status=200 bytes=2361\n2012-10-18T18:19:04+00:00 app[web.1]: \n2012-10-18T18:19:04+00:00 app[web.1]: \n2012-10-18T18:19:04+00:00 app[web.1]: Started GET \"/assets/foundation/app.js\" for 87.123.130.136 at 2012-10-18 20:19:04 +0200\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/app.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Served asset /foundation/app.js - 304 Not Modified (282ms)\n2012-10-18T18:19:05+00:00 heroku[router]: GET pacific-beyond-5428.herokuapp.com/assets/foundation/app.js dyno=web.1 queue=0 wait=0ms service=297ms status=304 bytes=0\n2012-10-18T18:19:05+00:00 app[web.1]: \n2012-10-18T18:19:05+00:00 app[web.1]: \n2012-10-18T18:19:05+00:00 app[web.1]: Started GET \"/assets/foundation/index.js\" for 87.123.130.136 at 2012-10-18 20:19:05 +0200\n2012-10-18T18:19:05+00:00 heroku[router]: GET pacific-beyond-5428.herokuapp.com/assets/foundation/index.js dyno=web.1 queue=0 wait=0ms service=905ms status=304 bytes=0\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/modernizr.foundation.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.placeholder.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.alerts.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.accordion.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.buttons.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.tooltips.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.forms.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.tabs.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.navigation.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.topbar.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.reveal.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.orbit.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/jquery.foundation.mediaQueryToggle.js  (0ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Compiled foundation/index.js  (86ms)  (pid 2)\n2012-10-18T18:19:05+00:00 app[web.1]: Served asset /foundation/index.js - 304 Not Modified (616ms)\n</code></pre>\n\n<p>Somebody an Idea?</p>\n"},{"tags":["ruby-on-rails-3","web-applications"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12960936,"title":"Ruby on Rails Calendar using Table_Builder Month Change Not Functioning","body":"<p>I am trying to add a calendar to my rails app using <a href=\"http://railscasts.com/episodes/213-calendars\" rel=\"nofollow\">table_builder</a>. I based my implementation off of their readme and this highly recommended <a href=\"http://railscasts.com/episodes/213-calendars\" rel=\"nofollow\">tutorial</a>.</p>\n\n<p>On the initial load, the calendar works beautifully. Each assignment is shown on the correct day. However, when the month is changed by clicking \">\" or \"&lt;\" which surround the month name, while the name of the month in the header is changed, the calendar itself is unchanged. Here is the block of code from my view that renders the calendar:</p>\n\n<pre><code>  &lt;div id=\"calendar\"&gt;  \n  &lt;h2 id=\"month\"&gt;  \n    &lt;%= link_to \"&lt;\", :month =&gt; (@date.beginning_of_month-1).strftime(\"%Y-%m-01\") %&gt;  \n    &lt;%= h @date.strftime(\"%B %Y\") %&gt;  \n    &lt;%= link_to \"&gt;\", :month =&gt; (@date.end_of_month+1).strftime(\"%Y-%m-01\") %&gt;  \n  &lt;/h2&gt;   \n    &lt;%= calendar_for(@assignments) do |calendar| %&gt;\n        &lt;%= calendar.head('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday') %&gt;\n        &lt;% calendar.day(:day_method =&gt; :due_date) do |day, assignments| %&gt;\n            &lt;%= day.day %&gt;\n            &lt;ul&gt;\n                &lt;% for assignment in assignments %&gt;\n                    &lt;li&gt;\n                        &lt;%= assignment.course.name %&gt;: &lt;%= link_to assignment.name, assignment_type_assignment_path(assignment.assignment_type, assignment)%&gt;\n                    &lt;/li&gt;\n                &lt;% end %&gt;\n            &lt;/ul&gt;\n        &lt;% end %&gt;\n    &lt;% end %&gt;\n&lt;/div&gt;  \n</code></pre>\n\n<p>@assignments returns a complete list of all assignments associated with a given user. Each assignment as an attribute due_date which is the date we want the assignment to appear under in the calendar.</p>\n\n<p>Here is the controller code:</p>\n\n<pre><code>class HomeController &lt; ApplicationController\n    def index\n        @user = @current_user\n        @assignments = @user.assignments\n        @date = params[:month] ? Date.parse(params[:month]) : Date.today\n    end\nend\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","module","activesupport"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":60,"score":3,"question_id":12957743,"title":"What should I not include in the `included do ... end` block?","body":"<p>I am using Ruby on Rails 3.2.2. I am implementing a module and including that in a my class by using the RoR <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/Concern.html\" rel=\"nofollow\">ActiveSupport::Concern</a> feature. It makes available the <code>included do ... end</code> block making code stated inside that to be executed in the class context of the class where the module is included.</p>\n\n<p>My doubt is: <em>What should I <strong>not</strong> include in the <code>included do ... end</code> block?</em> That is, for instance, is it a \"common\" / \"good\" practice to make the following?</p>\n\n<pre><code>module MyModule\n  extend ActiveSupport::Concern\n\n  class MyModuleClass\n    attr_accessor :attr1, :attr2, :attr3\n\n    def initialize(attrs)\n     @attr1 = attrs[:attr1]\n     @attr2 = attrs[:attr2]\n     @attr3 = attrs[:attr3]\n    end\n  end\n\n  included do\n    @my_module_class = MyModuleClass.new(some_attrs)\n  end\nend\n</code></pre>\n\n<p><em>More</em>, will be the <code>@my_module_class</code> variable available as an attribute in the including class of <code>MyModule</code> (<em>BTW</em>: I would like to make the <code>@my_module_class</code> to be \"visible\" <em>only</em> internally to <code>MyModule</code> since it is intended to be used only in that module)? Are there some \"advanced\" examples or tutorials on how to handle situations like that I am trying to instantiate in the <code>included do ... end</code> block of the above code? What do you advice about?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","loops"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":40,"score":-1,"question_id":12960514,"title":"Loop over Object attributes with except attributes in Ruby on Rails","body":"<p>I can get object attributes with:</p>\n\n<pre><code>Class Object\n field :name\n field :email\n field :second_name\nend\n</code></pre>\n\n<p>With this loop:</p>\n\n<pre><code>&lt;% @object.attributes.each do |attr_name| %&gt;\n....\n&lt;% end %&gt;\n</code></pre>\n\n<p>If i have 3 attributes I get 3 attributes.</p>\n\n<p>I want only get <code>attr_name</code> of <code>name</code> and <code>email</code> attributes</p>\n\n<p><strong>How can I in this loop discard or exclude the <code>field :second_name</code></strong></p>\n\n<p>Thank you</p>\n"},{"tags":["ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":5,"up_vote_count":6,"down_vote_count":0,"view_count":169,"score":6,"question_id":11932265,"title":"Top level constant referenced by warning for Mongoid model","body":"<p>I have the following mongoid model that inherits from the Entry model:</p>\n\n<pre><code>class Entry::Twitter &lt; Entry\n\n  field :retweet_count, :type =&gt; Integer, :default =&gt; 0\n  field :retweeted, :type =&gt; Boolean, :default =&gt; false\n  field :favorited, :type =&gt; Boolean, :default =&gt; false\n\n  # in_reply_to_screen_name, in_reply_to_status_id_str, in_reply_to_user_id_str\n  field :reply, :type =&gt; Hash\n\n  field :from, :type =&gt; Hash # user: id_str, name, screen_name\n  field :time, :type =&gt; Time # created_at\n  field :data, :type =&gt; Hash # entities (hashtags and user_mentions)\n  field :assets, :type =&gt; Hash # urls from original entities\n  field :service, :type =&gt; String, :default =&gt; \"twitter\"\n\n  attr_accessible :assets\n\n  # validations\n  validates_presence_of :retweet_count, :from, :time, :data\n\n  # override set_service cause of https://github.com/sferik/twitter/issues/303\n\n  def set_service\n    self.service = \"twitter\"\n  end\nend\n</code></pre>\n\n<p>When i try to reference it i get the following warning:</p>\n\n<pre><code>ruby-1.9.3-p125 :001 &gt; Entry::Twitter\n(irb):1: warning: toplevel constant Twitter referenced by Entry::Twitter\n=&gt; Twitter\n</code></pre>\n\n<p>Instead of referencing to my model it references to the Top Level Constant Twitter that is defined by a gem.</p>\n\n<p>What can i do to fix this? I don't want to use another name for my class.</p>\n"},{"tags":["ruby","ruby-on-rails-3","arel","visitor"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":329,"score":3,"question_id":6358852,"title":"Rails3 Arel visits to custom classes","body":"<p>I have a custom class, but I want to be able to pass it to Arel and let it resolve its <em>queryable</em> part.</p>\n\n<pre>\nmodule Custom\n  class Item\n    attr_accessor :name\n\n    def initialize(name)\n      self.name = name\n    end\n  end\nend\n\ncustom_item = Custom::Item.new(\"Bill\")\nUser.where(:name => custom_item)\n</pre>\n\n<p>is there anything I can define in custom_item, so it would understand that Arel wants name from it?</p>\n\n<p>Currently I workaround with:</p>\n\n<pre>\nmodule Arel\n  module Visitors\n    class ToSql\n      def visit_Custom_Item o\n        \"'#{o.name}'\"\n      end\n    end\n  end\nend\n</pre>\n"},{"tags":["ruby-on-rails","ruby","arrays","ruby-on-rails-3","string"],"answer_count":4,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":73,"score":4,"question_id":12959998,"title":"Remove numbers from array of strings","body":"<p>I have an array that looks like this:</p>\n\n<pre><code>[\"lorem\", \"ipsum\", \"1734\", \"dolor\", \"1\", \"301\", \"et\", \"4102\", \"92\"]\n</code></pre>\n\n<p>Is there a way to remove all the numbers in the array, even though they're stored as strings, so that I'd be left with this:</p>\n\n<pre><code>[\"lorem\", \"ipsum\", \"dolor\", \"et\"]\n</code></pre>\n\n<p>Thanks for any hints.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12959873,"title":"RoR, Calling column names from a module","body":"<p>I'm using Ruby on Rails. and I have a module called PatientFactory and it will be included in a Patient model.</p>\n\n<p>I need to access a Patient's id, from this module.</p>\n\n<pre><code>module PatientFactory\n\n  def self.included(base)\n\n    # need to access instance variable here\n    ...\n\n  end\nend\n</code></pre>\n\n<p>But more importantly, I need it in the self.included(base)\nI can easily access it outside of this method but how do I access it inside?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12959365,"title":"Moving MySQL routine to model","body":"<p>I have a PHP-driven website that I am converting to Rails.  I currently have the following logic in a MySQL routine.</p>\n\n<pre><code>DECLARE FirstWeighinDate DATE;\nDECLARE FirstWeighinWeight DECIMAL(5,1);\nDECLARE MostRecentWeighinDate DATE;\nDECLARE MostRecentWeighinWeight DECIMAL(5,1);\nDECLARE NumberOfWeighins INT(11);\nDECLARE NumberOfDeficitRecords INT(11);\nDECLARE AverageDeficit INT(11);\nDECLARE UserHeight INT(11);\nDECLARE MostRecentBMI DECIMAL(5,1);\n\nSELECT date INTO FirstWeighinDate FROM tblDeficitEntries WHERE weight IS NOT NULL AND user_id = inUserId ORDER BY date ASC LIMIT 1;\nSELECT weight INTO FirstWeighinWeight FROM tblDeficitEntries WHERE weight IS NOT NULL AND user_id = inUserId ORDER BY date ASC LIMIT 1;\nSELECT date INTO MostRecentWeighinDate FROM tblDeficitEntries WHERE weight IS NOT NULL AND user_id = inUserId ORDER BY date DESC LIMIT 1;\nSELECT weight INTO MostRecentWeighinWeight FROM tblDeficitEntries WHERE weight IS NOT NULL AND user_id = inUserId ORDER BY date DESC LIMIT 1;\nSELECT Height INTO UserHeight FROM tblLogins WHERE id = inUserId LIMIT 1;\nSELECT COUNT(id) INTO NumberOfWeighins FROM tblDeficitEntries WHERE weight IS NOT NULL AND user_id = inUserId;\nSELECT COUNT(id) INTO NumberOfDeficitRecords FROM tblDeficitEntries WHERE user_id = inUserId;\nSELECT (SUM(deficit) / NumberOfDeficitRecords) INTO AverageDeficit FROM tblDeficitEntries WHERE user_id = inUserId;\nSELECT ((MostRecentWeighinWeight * 703) / (UserHeight * UserHeight)) INTO MostRecentBMI;\n\nSELECT FirstWeighinDate, FirstWeighinWeight, MostRecentWeighinDate, MostRecentWeighinWeight, NumberOfWeighins, NumberOfDeficitRecords, AverageDeficit, MostRecentBMI;\n</code></pre>\n\n<p>I believe in a MVC situation, that logic belongs in the Model.  I am unsure how to achieve this.  I was thinking it should be done with a virtual accessor that is a hash.  Is that correct?  If I should have this somewhere besides the Model, where should it go?   I don't expect the entire code to be converted in the answer, but I would greatly appreciate a couple of the lines to be converted so that I can get the idea.  Thanks!</p>\n"},{"tags":["ruby-on-rails-3","haml","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12789873,"title":"Accesing to my carrierwave model object with an attribute name","body":"<p>I'm trying to put a file link with a partial render, something like this:</p>\n\n<pre><code>#Main haml file\n= render :partial =&gt; 'file_upload', :locals =&gt; {:f =&gt; f, :file_download =&gt; 'residence_cert'}\n#Inside the partial\n%a{:href =&gt; @postulant_info[file_download]}\n</code></pre>\n\n<p>But this is making a link just with the file name, not the full path to the file. Then realized that <code>@postulant_info[file_download]</code> is just giving me a String with the file name, not the carrierwave object</p>\n\n<pre><code>-logger.debug @postulant_info.residence_cert #this is returning my carrierwave object -&gt; 'DocumentUploader'\n-logger.debug @postulant_info['residence_cert'] #but this one is just returning a String, the DB record with the file name\n</code></pre>\n\n<p>One solution could be put the url in the render as a local like <code>= render :partial =&gt; 'file_upload', :locals =&gt; {:f =&gt; f, :file_download =&gt; 'residence_cert', :url =&gt; @postulant_info.residence_cert.url}</code> but I think \"should\" be unnecessary when you have the  attribute name inside the partial template.<br>\nAny thought would be appreciated. Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","git","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":822,"score":0,"question_id":9909373,"title":"Heroku Error H10 (App crashed)","body":"<p>My Heroku app has crashed, and all i'm getting out of the logs is Error H10 (App crashed)</p>\n\n<pre><code>2012-03-28T14:11:56+00:00 heroku[router]: Error H10 (App crashed) -&gt; GET www.devsite.com/ dyno= queue= wait= service= status=503 bytes=\n2012-03-28T14:11:56+00:00 heroku[nginx]: 109.145.58.15 - - [28/Mar/2012:14:11:56 +0000] \"GET / HTTP/1.1\" 503 607 \"-\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.83 Safari/535.11\" www.devsite.com\n</code></pre>\n\n<p>Any idea how to draw more information out of heroku logs - or find out what is wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","sitemap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12912097,"title":"Sitemap_generator produces sitemap at unknown URL","body":"<p>I'm using the <a href=\"https://github.com/kjvarga/sitemap_generator\" rel=\"nofollow\" title=\"sitemap_generator\">sitemap_generator</a> gem to produce sitemaps for my site.</p>\n\n<p>Producing a sitemap locally works fine, and I can access the sitemap at <code>http://localhost:3000/sitemap1.xml.gz</code>.</p>\n\n<p>After deploying to Heroku and running</p>\n\n<pre><code>heroku run rake sitemap:refresh --app myapp-prod\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>In /app/public/\n+ sitemap1.xml.gz                                        254 links /    4.74 KB\n+ sitemap_index.xml.gz                                  1 sitemaps /  231 Bytes\nSitemap stats: 254 links / 1 sitemaps / 0m06s\n</code></pre>\n\n<p>So far so good - however, when trying to access my sitemap at <code>https://myapp.com/sitemap1.xml.gz</code>, I get a 404 error. I've tried the following ways to resolve this but none have worked:</p>\n\n<ol>\n<li>Call <code>git add</code> for the two locally generated xml files, push them to Heroku, and call <code>heroku run rake sitemap:refresh --app myapp-prod</code> to update the locally generated URLs with my production URLs. However the file is not being refreshed, it stays exactly the same as generated locally, even though the same message as above is being returned.</li>\n<li>Producing the sitemap into a custom path, e.g. public/shared/. But the error persists when accessing <code>https://myapp.com/shared/sitemap1.xml.gz</code>.</li>\n<li>All possible and impossible URL combinations, like <code>https://myapp.com/public/sitemap1.xml.gz</code> (which of course were never going to work, but wanted to leave no stone unturned)</li>\n</ol>\n\n<p>Any ideas as to what could cause this behaviour, and where the sitemap might be stored?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12958980,"title":"Can I iterate over every instance variable of a controller with rails?","body":"<p>How would I loop over every instance variable \"@anything\" in a controller? I dont want to loop over one, I want to loop over them as a collection. Ideally scoped to the ones my controller method defines.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12897750,"title":"How to get a carrierwave instance giving the attribute name to the model","body":"<p>In my controller I'm trying to do something like:</p>\n\n<pre><code>  uploader = object[params[:attribute]]\n  uploader.retrieve_from_store!(params[:file])\n  uploader.cache_stored_file!\n  send_file uploader.file.path\n</code></pre>\n\n<p>But the problem is that <code>object[params[:attribute]]</code> is returning a String(the DB record with the filename), not my carrierwave object (I already checked that object.attribute is returning the uploader, it works). How can I get the uploader or maybe how can I initialize it? </p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","validation","mongoid","one-to-many","activemodel"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12947656,"title":"Rails 3/Mongoid: calling a validator on a collection when updated","body":"<p>I am working in Mongoid 3 and Rails 3.</p>\n\n<p>I want a validator to be called on a model after its collection is modified:</p>\n\n<pre><code>class TooManyValidator &lt; ActiveModel::EachValidator\n  def validate_each(record, attribute, value)\n    puts \"validate called\"\n    if value.size &gt; 4\n      puts \"too many???\"\n      record.errors[attribute] &lt;&lt; 'too many'\n    end\n  end\nend    \n\nclass Task\n  include Mongoid::Document\n\n  has_many :parts, inverse_of: :task\n  validates :parts, too_many: true\nend\n\nclass Part\n  include Mongoid::Document\n\n  belongs_to :task, inverse_of: :parts\nend\n</code></pre>\n\n<p>The test i have is:</p>\n\n<pre><code>it \"should not have too many parts\" do    \n  task = Task.create!\n\n  puts \"ADDING PARTS\"\n  6.times { task.parts &lt;&lt; Part.create }\n  #task.save\n\n  puts \"task.errors['parts'] = #{task.errors[\"parts\"]}\"\n\n  Task.find(task._id).parts.size.should == 4\nend\n</code></pre>\n\n<p>The output I get is:</p>\n\n<pre><code>validate called\nADDING PARTS\ntask.errors['parts'] = []\n</code></pre>\n\n<p>And the test fails with <code>6 != 4</code>.  </p>\n\n<p>Also to be noted when I comment in the <code>task.save</code> line in the test I get</p>\n\n<pre><code>validate called\nADDING PARTS\nvalidate called\ntoo many???\ntask.errors['parts'] = [\"too many\"]\n</code></pre>\n\n<p>but it still fails with <code>6 != 4</code></p>\n\n<p>How do I call the validator for :parts on Task after the parts collection is modified and get it not to update the collection after it fails?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise","routes"],"answer_count":4,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1972,"score":0,"question_id":8234023,"title":"Devise after_sign_in_path_for ... sending to .... root_path - query","body":"<p>I need help with a routes issue with devise authentication gem to redirect to a custom page after successful login so as to create a new record by entering a test person name and age ( test data ) </p>\n\n<p>I am using Rails 3 with devise version 1.4.9</p>\n\n<p>My routes are as below</p>\n\n<pre><code>    new_user_session GET    /users/sign_in(.:format)       {:action=&gt;\"new\", :controller=&gt;\"devise/sessions\"}\n        user_session POST   /users/sign_in(.:format)       {:action=&gt;\"create\", :controller=&gt;\"devise/sessions\"}\ndestroy_user_session DELETE /users/sign_out(.:format)      {:action=&gt;\"destroy\", :controller=&gt;\"devise/sessions\"}\n       user_password POST   /users/password(.:format)      {:action=&gt;\"create\", :controller=&gt;\"devise/passwords\"}\n   new_user_password GET    /users/password/new(.:format)  {:action=&gt;\"new\", :controller=&gt;\"devise/passwords\"}\n  edit_user_password GET    /users/password/edit(.:format) {:action=&gt;\"edit\", :controller=&gt;\"devise/passwords\"}\n                     PUT    /users/password(.:format)      {:action=&gt;\"update\", :controller=&gt;\"devise/passwords\"}\n   cancel_user_registration GET    /users/cancel(.:format)        {:action=&gt;\"cancel\", :controller=&gt;\"devise/registrations\"}\n   user_registration POST   /users(.:format)               {:action=&gt;\"create\", :controller=&gt;\"devise/registrations\"}\n   new_user_registration GET    /users/sign_up(.:format)       {:action=&gt;\"new\", :controller=&gt;\"devise/registrations\"}\n   edit_user_registration GET    /users/edit(.:format)          {:action=&gt;\"edit\", :controller=&gt;\"devise/registrations\"}\n                     PUT    /users(.:format)               {:action=&gt;\"update\", :controller=&gt;\"devise/registrations\"}\n                     DELETE /users(.:format)               {:action=&gt;\"destroy\", :controller=&gt;\"devise/registrations\"}\n             testers GET    /testers(.:format)             {:action=&gt;\"index\", :controller=&gt;\"testers\"}\n                     POST   /testers(.:format)             {:action=&gt;\"create\", :controller=&gt;\"testers\"}\n          new_tester GET    /testers/new(.:format)         {:action=&gt;\"new\", :controller=&gt;\"testers\"}\n         edit_tester GET    /testers/:id/edit(.:format)    {:action=&gt;\"edit\", :controller=&gt;\"testers\"}\n              tester GET    /testers/:id(.:format)         {:action=&gt;\"show\", :controller=&gt;\"testers\"}\n                     PUT    /testers/:id(.:format)         {:action=&gt;\"update\", :controller=&gt;\"testers\"}\n                     DELETE /testers/:id(.:format)         {:action=&gt;\"destroy\", :controller=&gt;\"testers\"}\n                root        /                              {:controller=&gt;\"testers\", :action=&gt;\"index\"}\n</code></pre>\n\n<p>In applications controller i tried to override the method like below but to no avail i still get routed back to tester index</p>\n\n<p>class ApplicationController &lt; ActionController::Base</p>\n\n<p>protect_from_forgery</p>\n\n<p>def after_sign_in_path_for(resource) </p>\n\n<pre><code>  new_tester_path\n</code></pre>\n\n<p>end</p>\n\n<p>end</p>\n\n<p>In my routes.rb file i have the below lines</p>\n\n<p>Testing::Application.routes.draw do</p>\n\n<p>devise_for :users </p>\n\n<p>resources :testers</p>\n\n<p>root :to => 'testers#index'</p>\n\n<p>While much of the code was done with scaffolding I was still not be able to figure how to redirect to <strong>new_tester_path</strong> or route <strong>/testers/new</strong> after <strong>successful sign_in</strong> by user email and password.</p>\n\n<p>Can someone please let me know what i am missing..... while writing the override function, I  would like to know the exact route i need to specify. </p>\n\n<p>While testing i tried something stupid like this but the google page is also not opening ... :( </p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base \n\nprotect_from_forgery \n\nhelper ApplicationHelper\n\ndef after_sign_in_path_for(resource) \n\n\"www.google.com\" \n\nend \n\ndef after_sign_up_path_for(resource) \n\n\"www.google.com\" \n\nend \n\ndef after_update_path_for(resource) \n\n\"www.google.com\" \n\nend \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12950802,"title":"In what order is code in Embedded Ruby executed?","body":"<p>I've done a little bit of Ruby on Rails magic today which somehow works but I don't know how. </p>\n\n<p>I'm writing an application which is supposed to have a navigation bar on top of every page, so I've written a partial which I render in my default layout:</p>\n\n<p><code>views/layouts/application.html.erb</code>:</p>\n\n<pre><code>...\n&lt;%= render 'shared/navbar' %&gt;\n&lt;%= yield %&gt;\n...\n</code></pre>\n\n<p>But I wanted the link to the currently selected section to be highlighted. I decided that a series of <code>if</code> statements in every link would be ugly so I wrote a helper class or two which manage the links displayed on the navbar. I'll spare you details how they work, because they're trivial and irrelevant right now, but they're used like this:</p>\n\n<p><code>views/shared/_navbar.html.erb</code>:</p>\n\n<pre><code>...\n&lt;% navbar_manager.each_entry do |entry, active| %&gt;\n  &lt;li &lt;% if active %&gt;class=\"active\"&lt;%end%&gt;&gt;\n    &lt;%= link_to entry.label, entry.url %&gt;\n  &lt;/li&gt;\n&lt;% end %&gt;\n...\n</code></pre>\n\n<p>Now I only needed to let the <code>navbar_manager</code> know which entry is active. Manipulating the navigation bar is closely linked to the view so I decided against putting an appropriate code in the controller and to do it in a view file instead, like this:</p>\n\n<p><code>views/foo/index.html.erb</code></p>\n\n<pre><code>&lt;% navbar_manager.set_active_entry(:home) %&gt;\n...\n</code></pre>\n\n<p>A big surprise: it works. But now that I think of it: <code>render 'shared/navbar'</code> appears in the layout file before <code>yield</code>. So how does it happen that <code>navbar_manager.set_active_entry</code> is called before <code>navbar_manager.each_entry</code>? More generally: in what order is Embedded Ruby processed?</p>\n\n<p>And in case that I'm simply lucky: is there a way to ensure the order I want?</p>\n\n<p>I'm using Ruby 1.9.3 and Rails 3.2</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":1473,"score":0,"question_id":6537324,"title":"Skipping callbacks and validation","body":"<p>Is there a way to skip callbacks and validation by doing something along these lines in Rails 3?</p>\n\n<pre><code>Object.save(:validate =&gt; false, :skip_callbacks =&gt; true)\n</code></pre>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","formtastic"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":747,"score":0,"question_id":6648455,"title":"Formtastic Collection Select Dropdown","body":"<p>When using formtastic in my rails3 application, I can't get the dropdown menus to work. Instead they appear as a selection list.</p>\n\n<p>My code looks like this:</p>\n\n<pre><code>&lt;%= f.label :slas, \"Service\" %&gt;&lt;/td&gt;&lt;td&gt;&lt;%= f.input :slas, :collection =&gt; @slas %&gt;\n</code></pre>\n\n<p>Is this something I need to change in the css?</p>\n"},{"tags":["ruby-on-rails-3","activerecord","group-by","sql-order-by"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12958696,"title":"Rails 3 has_many order_by and group_by not working as expected","body":"<p>I have the following association in my <code>Group</code> model:</p>\n\n<pre><code>has_many :subscriptions, :order =&gt; 'subscriptions.expiration_date DESC', :group =&gt; 'subscriptions.product_name', :conditions =&gt; ['subscriptions.status IN (?)', [:active, :canceled]]\n</code></pre>\n\n<p>The Models (User, Subscription, Group) break down like this:</p>\n\n<pre><code>**User**\nhas_many :groups, :before_add =&gt; :validates_group, :through =&gt; :group_users, :conditions =&gt; [\"groups_users.status = ?\", 'active']\n**Group**\nhas_many :users, :through =&gt; :group_users, :conditions =&gt; ['groups_users.status = ?', 'active']\nhas_many :subscriptions, :order =&gt; 'subscriptions.expiration_date DESC', :group =&gt; 'subscriptions.product_name', :conditions =&gt; ['subscriptions.status IN (?)', [:active, :canceled]]\n**Subscription**\nbelongs_to :group\n</code></pre>\n\n<p>So, a group could have multiple subscriptions (for different products; subscription.product_name) for the same product (depending on if they renewed or it was just an old one in the system). The <code>has_many :subscriptions</code> order_by is not working properly.</p>\n\n<p><strong>For Example:</strong><br />\nIf the user has 3 subscriptions (One for product X and 2 for product Y). And you run the following </p>\n\n<p>Subscriptions Method in User Model:</p>\n\n<pre><code> def subscriptions\n    subs = []\n    groups.collect(&amp;:subscriptions).each do |sub|\n      if sub\n        subs &lt;&lt; sub\n      end\n    end\n    subs.flatten!\n  end\n\nu = User.last\nu.subscriptions\n</code></pre>\n\n<p>The one for product X comes back fine, but when it pulls back product Y it is pulling back the first one in the list (the one with the expiration date in the past).</p>\n\n<p>Sorry if this doesn't make sense, I am trying to explain it the best I can. Anyone run into this situation where order and group are not working properly on an association? </p>\n"},{"tags":["ruby-on-rails-3","string","methods","integer","type-conversion"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12957210,"title":"Rails 3 to_i method susbtitute","body":"<p>I have a string variable <code>codigo = \"0001\"</code> that I want to convert to an integer and increment its value by 1, I used to do this with <code>codigo.to_i += 1</code> but apparently that method has been deprecated in Rails 3. Which is the Rails 3 way to do this now?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3","unobtrusive-javascript"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":85,"score":0,"question_id":12789920,"title":"adding value again and again in javascript","body":"<p>In my JavaScript I have three <code>Links</code>. The <code>second link</code> is open depends upon the <code>first link id</code> selected. Everything works fine. But After selecting the <code>second link</code>, if i want to change the <code>first link</code>, the <code>second link</code> is still opens for the old <code>id</code>.If I want to change the <code>first link</code>, all the <code>fields</code> should change and opens as per the <code>first link.</code> </p>\n\n<pre><code> var generic_lookup_Enr_Rds_Section2009_selected = function(id, to_s) {\n      var question_link = $('#question_picker').attr('href');\n      question_link = question_link.replace(/\\?+$/, '');\n      question_link = question_link + '?columns[enr_rds_section_id]=' + id;\n      $('#question_picker').attr('href', question_link);\n      $(\"#modal_popup\").dialog(\"destroy\");\n\n  };\n\n  var generic_lookup_Enr_Rds_Question2009_selected = function(id, to_s) {\n      var answer_link = $('#answer_picker').attr('href');\n      answer_link = answer_link.replace(/\\?+$/, '');\n      answer_link = answer_link + '?columns[enr_rds_question_id]=' + id;\n      $('#answer_picker').attr('href', answer_link);\n      $(\"#modal_popup\").dialog(\"destroy\");\n  };\n</code></pre>\n\n<h2>html</h2>\n\n<pre><code>&lt;div class=\"question\"&gt;\n      &lt;%= f.label :Section %&gt;\n      &lt;%= link_to pro_generic_lookup_data_path(\"Enr::Rds::Section2009\", format: :js), data: {remote: true} do %&gt;\n        &lt;%= image_tag(\"Search-icon.gif\", border: 0, :alt =&gt; \"Look up Sections\", title: 'Lookup Sections') %&gt;\n      &lt;% end %&gt;\n &lt;/div&gt;\n\n  &lt;div class=\"question\"&gt;\n      &lt;%= f.label :Question %&gt;\n      &lt;%= link_to pro_generic_lookup_data_path(\"Enr::Rds::Question2009\", format: :js), data: {remote: true}, id: \"question_picker\" do %&gt;\n        &lt;%= image_tag(\"Search-icon.gif\", border: 0, :alt =&gt; \"Look up Questions\", title: 'Lookup Questions', :class =&gt; \"image_section_search\") %&gt;\n      &lt;% end %&gt;\n &lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","inheritance","polymorphic-associations","has-one"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12957308,"title":"Polymorphic has_one association and multiple inheritance with Rails 3","body":"<p>I've seen some posts dealing with this, and am trying to determine the best solution.</p>\n\n<p>Semantically, I want a Client model with a one-to-one relationship with a Survey.  There are different kinds of surveys that have different fields but I want to share a significant amount of code between them.  Because of the different fields I want different database tables for the surveys.  There is no need to search across different types of surveys.  It feels like I want the foreign key in the Client table for fast retrieval and potential eager-loading of the Survey.</p>\n\n<p>So theoretically I <em>think</em> I want polymorphic has_one and multiple inheritance something like this:</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n  has_one :survey, :polymorphic =&gt; true\nend\n\nclass Survey\n  # base class of shared code, does not correspond to a db table\n  def utility_method\n  end\nend\n\nclass Type1Survey &lt; ActiveRecord::Base, Survey\n  belongs_to :client, :as =&gt; :survey\nend\n\nclass Type2Survey &lt; ActiveRecord::Base, Survey\n  belongs_to :client, :as =&gt; :survey\nend\n\n# create new entry in type1_surveys table, set survey_id in client table\n@client.survey = Type1Survey.create()\n\n@client.survey.nil?            # did client fill out a survey?\n@client.survey.utility_method  # access method of base class Survey\n@client.survey.type1field      # access a field unique to Type1Survey\n\n@client2.survey = Type2Survey.create()\n@client2.survey.type2field     # access a field unique to Type2Survey\n@client2.survey.utility_method\n</code></pre>\n\n<p>Now, I know Ruby does not support multiple inheritance, nor does :has_one support :polymorphic.  So is there a clean Ruby way to achieve what I'm getting at?  I feel like it's right there almost...</p>\n"},{"tags":["ruby-on-rails-3","datetime"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1002,"score":2,"question_id":6786318,"title":"Rails: Get the time from a datetime","body":"<p>If I have a datetime value of something like 1/10/2011 9:00:00,  how do I get the 9:00 am from that datetime?  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12957954,"title":"How to use filters in mutiple active admin pages under one resource","body":"<p>I have one resource asset, which contains multiple audio,video,photo,document,contact features.I have created multiple pages under Admin/assets.rb and all the created pages have one parent assets.The default filter in the index page works fine when I click to assets in the active admin part, but when I provide filters to other pages I get error:</p>\n\n<pre><code>   undefined method `filter' for #&lt;ActiveAdmin::PageDSL:0x9d4aae0&gt;\n</code></pre>\n\n<p>Here's my code sample under admin/assets.rb:</p>\n\n<pre><code>  ActiveAdmin.register Asset  do\n\n  menu :label =&gt; 'Assets'\n\n     ActiveAdmin.register_page \"Video Gallery\" do\n        filter :asset, :as =&gt; :check_boxes, :collection =&gt; proc { Asset.all }\n        menu parent:  \"Assets\"\n     end\n  end\n</code></pre>\n\n<p>Please help, as I am a newbie to Active Admin</p>\n"},{"tags":["ruby-on-rails-3","apache","linode"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":9501709,"title":"Multiple pages on a same machine (Linode)","body":"<p>Im planning to get a Linode plan and i need to run 3 web pages 2 on Ruby on Rails and a simple html is it possible?\ni need to have a different URL for each RoR app and for the simple html page also</p>\n"},{"tags":["ruby-on-rails-3","heroku","nokogiri"],"answer_count":4,"favorite_count":0,"up_vote_count":6,"down_vote_count":0,"view_count":1184,"score":6,"question_id":4964800,"title":"Heroku app crashes, logs say \"No such file to load -- nokogiri (LoadError)\"","body":"<p>I had a working app, added Nokogiri, to parse some xml, runs fine locally.</p>\n\n<p>My Gemfile includes: <code>gem 'nokogiri'</code></p>\n\n<p>I ran <code>bundle install</code> and verified my Gemfile.lock includes <code>DEPENDENCIES</code> ... <code>nokogiri</code></p>\n\n<p>In my controller class I added (didnt thinkI had to but got an error locally if I didnt):</p>\n\n<pre><code>class MydealController &lt; ApplicationController\n  require 'rubygems'\n  require 'open-uri'\n  require 'nokogiri'\n</code></pre>\n\n<p>when I use my browser to get the url in MydealController that uses nokogiri <code>doc = Nokogiri::XML(getresult)</code> Heroku crashes.</p>\n\n<p><code>heroku logs</code> shows this error <code>No such file to load -- nokogiri (LoadError)</code></p>\n\n<p>Looking at what happens when I <code>git push heroku</code> I do not see nokogiri on the list of many many gems that get installed. Heroku says the push was fine, but nokogiri is not listed and I get the aforementioned error...</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":2,"view_count":69,"score":-2,"question_id":12933392,"title":"How to get the other fields values by the id in Javascript or RoR?","body":"<p>In the database, I have a table called <code>Questions</code>. It has <code>four columns</code> like</p>\n\n<pre><code>Id, Question_text, Question_type, Answer_table\n</code></pre>\n\n<p>The user can select only the <code>id</code> and <code>question_text</code>. I am able to get the <code>Id</code> and <code>question_text</code> value. I need to get the value of <code>Question_type</code> and <code>Answer_table</code> from that <code>Id</code>.</p>\n\n<p>For example,</p>\n\n<p>If the user selects the <code>question_text = 'City'</code> with <code>Id = 5</code>.</p>\n\n<p>I want the values for other columns of <code>question_type</code> and <code>Answer_table</code> by the <code>params</code> of this <code>id</code>. to store in a separate variable.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","boolean"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12954252,"title":"Should I use boolean fields or state_machine gem in rails 3?","body":"<p>I have a e-mail system and I want that an user can decide with checkboxes what message want receive when happen determinate events, e.g.</p>\n\n<pre><code>field :when_receive_order, :type =&gt; Boolean, :default =&gt; \"true\"\nfield :when_accept_order, :type =&gt; Boolean, :default =&gt; \"true\"\nfield :when_cancel_order, :type =&gt; Boolean, :default =&gt; \"true\"\nfield :when_reject_order, :type =&gt; Boolean, :default =&gt; \"true\"\n.\n.\n.\nmore...\n</code></pre>\n\n<p>I want to know <strong>if is good use <code>Boolean</code> values or use <a href=\"https://github.com/pluginaweek/state_machine\" rel=\"nofollow\">state_machine gem</a> in these case.</strong></p>\n\n<p>In this link <a href=\"http://railstips.org/blog/archives/2012/10/10/booleans-are-baaaaaaaaaad/\" rel=\"nofollow\">http://railstips.org/blog/archives/2012/10/10/booleans-are-baaaaaaaaaad/</a> is  argued that <code>Boolean</code> values are bad. So I make this question.</p>\n\n<p>Note: My database is mongodb and my odm es mongoid</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","background-process"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":43,"score":3,"question_id":12956661,"title":"Controller Action to Delayed Job","body":"<p>I am uploading a tab-delimited document and processing in the controller.  Everything works fine, but can take some time on a large file.  I want to move this to a delay_job, which I have working elsewhere in my app, but as this is in the controller, cannot be called in the same way.</p>\n\n<p>The form calls on the process_file action, which in turn calls on the salesupload action.  How should I turn this into a background job?</p>\n\n<pre><code>class SalesController &lt; ApplicationController\n\n  def salesupload(file)\n    uploaded_io = file.read\n    numrows = \"uploaded_io.size\"\n    FasterCSV.parse(uploaded_io, {:headers =&gt; true, :col_sep =&gt;\"\\t\"}).each do |row_data|\n        full, upc, _discard, isrc = row_data[26].match(/^([^_]+)(_(.+))?/).to_a\n          new_record = AppleSale.new(\n              'provider' =&gt;  row_data[0],\n              'provider_country' =&gt; row_data[1],\n              'vendor_identifier' =&gt; row_data[2]\n          )\n      new_record.save\n    end\n  end\n\n    def process_file\n        file = params[:apple_sale][:tsv_file]\n        salesupload(file)\n    end\n\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","activerecord","decorator"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12956285,"title":"Decorator pattern and type mismatch on ActiveRecord association","body":"<p>I'm using a decorator class to add some functionality to a model of mine. I only want this information to be used to process some values but not to save anything to the database.</p>\n\n<p>I have my decorator class, something like:</p>\n\n<pre><code>class Deco\n\n   def initialize o\n     @target = o\n   end\n   def method_missing method, *args, &amp;block\n     @target.send(method, *args, &amp;block)\n   end\n   #my extra methods\nend\n</code></pre>\n\n<p>And I use it like so:</p>\n\n<pre><code>deco_model = Deco.new(model)\n</code></pre>\n\n<p>There problem here is when I want to associate this <code>deco_mode</code> to another one, I get a type mismatch error, which makes sense, but if I add the following method to my decorator class:</p>\n\n<pre><code>def class\n   @target.class\nend\n</code></pre>\n\n<p>I still get the same error, but it says: Model(#aaaaaa) expected, got Model(#aaaaa)\nYes, the \"Model\" would be the class of my model, and the object id is the same in both cases... so if the object id is the same, why am I still getting the exception?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12956250,"title":"Rails server is not starting?","body":"<p>i have succesfully installed rails 3.2.8, ruby 1.9.3, gems are also updated.\nwhen rails server command is entered in myapp folder following error is displayed</p>\n\n<p>←[31mCould not find gem 'jquery-rails (>= 0) x86-mingw32' in the gems available\non this machine.←[0m\n←[33mRun <code>bundle install</code> to install missing gems.←[0m</p>\n"},{"tags":["unit-testing","ruby-on-rails-3","tutorials","rspec","video-tutorials"],"answer_count":4,"favorite_count":8,"up_vote_count":20,"down_vote_count":0,"view_count":11104,"score":20,"question_id":5255506,"title":"Good tutorial for RSpec With Rails 3","body":"<p>I am looking for a good <em>free</em> tutorial which implements RSpec with Rails 3. I have found many tutorials which work for Rails 2.x but leads you into issues when trying the same in Rails 3. Rspec Gem also has updated , coming off the age.. Leading into compatibility issues.</p>\n\n<p>I am able to setup RSpec in my app but I can't fix issues I am getting into. Its like i am implementing a customized app without get an overall idea of what changes I would have to carefully incorporate due to usage of the latest Rails ( say 3.0 ) and the latest RSpec gem 2.5. I am also making use of rspec-rails 2.5 gem.</p>\n\n<p>Such tutorials( based on earlier versions of Rails and Rspec ) I have seen so far include:</p>\n\n<p><a href=\"http://fr.ivolo.us/posts/rspec-tutorial-part-2-a-simple-test\" rel=\"nofollow\">http://fr.ivolo.us/posts/rspec-tutorial-part-2-a-simple-test</a></p>\n\n<p><a href=\"http://blog.davidchelimsky.net/2007/05/14/an-introduction-to-rspec-part-i/\" rel=\"nofollow\">http://blog.davidchelimsky.net/2007/05/14/an-introduction-to-rspec-part-i/</a></p>\n\n<p>I am unable to find Part 2 of David's tutorial also. I wonder where I could find that.</p>\n\n<p>I also have seen a similar questions on stackoverflow.com like:-</p>\n\n<p><a href=\"http://stackoverflow.com/questions/4618241/rails-good-rspec2-example-usage-also-cucumber-pickle-capybara/4618392#4618392\">Rails: Good Rspec2 example usage? (Also: Cucumber, Pickle, Capybara)</a></p>\n\n<p>The only free tutorial relevant to Rspec with Rails 3 that I could find so far is:-</p>\n\n<p><a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book\" rel=\"nofollow\">http://ruby.railstutorial.org/ruby-on-rails-tutorial-book</a></p>\n\n<p>I am using ruby 1.9.2 and rails 3.0.3 along with Ubuntu 10.04 .</p>\n\n<p>Thanks for any suggestions you can help me with.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":64,"score":0,"question_id":12849234,"title":"Rails 3 respond_with for create returning json or location for JSON format when controller is in different module","body":"<p>In Rails 3.2.8. If you have this route:</p>\n\n<pre><code>  namespace :some_module do\n    resources :some_models\n  end\n</code></pre>\n\n<p>And the corresponding SomeModel is not in a module, then in SomeModule::SomeModelsController if you specify the location as the model instance (like in the create), then its assumption about the url will be wrong:</p>\n\n<pre><code>respond_with @some_model, location: @some_model\n</code></pre>\n\n<p>as it will assume that the url is some_model_instance_url instead of some_module_some_model_instance_url.</p>\n\n<p>For some reason, when I try to get tricky and make a generic evaluation of what I think is the correct url in the create method (since this is in a generic module for inclusion in a controller):</p>\n\n<pre><code>respond_with @some_model, location: send(\"#{self.class.name.chomp('Controller').gsub('::','_').underscore.singularize}_url\")\n</code></pre>\n\n<p>It results in: <code>No route matches {:action=&gt;\"show\", :controller=&gt;\"some_module/some_models\"}</code> (which is plural, so there is no route)</p>\n\n<p>This seems kind of confusing.</p>\n\n<p>But just doing:</p>\n\n<pre><code>respond_with @some_model\n</code></pre>\n\n<p>when the controller is set to respond with json via:</p>\n\n<pre><code>respond_to :json\n</code></pre>\n\n<p>for me returns a 204 with no indication of the created instance's id, and it seems you need some indication that includes an ID for the client to make use out of it (creating something without returning an id is not good practice).</p>\n\n<p>What is the right way to be using respond_with in a create method in a controller that is in a different module than the model and we want to return some indication of the created object's id?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12954878,"title":"Products In Groups under Clients","body":"<p>I would like to know if it is possible what I am trying to do here.</p>\n\n<p>I have three models:</p>\n\n<ul>\n<li>Client</li>\n<li>Group</li>\n<li>Product</li>\n</ul>\n\n<p>Relations:</p>\n\n<pre><code>Group has_many :products, :through =&gt; :groupings\nProduct has_many :groups, through =&gt; :groupings\nClient has_many groups, :through =&gt; :client_groupings\nGroup has_many :clients, :through =&gt; :clientgroupings.\n</code></pre>\n\n<p>Now, when I go to the client view, will I be able to see only the products that the client groups it belongs too?</p>\n\n<p>Example:<br>\nClient A (Has Group A) - Can only see products that belong to Group A<br>\nClient B (Has Group G) - Can only see products that belongs to Group G<br>\nClient C (Has Group A and G) - Can See products from A and G all together</p>\n\n<p>How should I code the view to make this happen?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","methods","nil"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":107,"score":1,"question_id":12943362,"title":"Ruby undefined method `strftime' for nil:NilClass","body":"<p>I've only been working with Ruby for a short time and I've hit a wall today while working on a calendar to put requests on. I spent time searching through different undefinied method error documents on stackoverflow, the ruby guides, etc. as well as looking into strftime. I found a solution that partially solved my problem using try, but now it is not actually passing the strftime through to show on the request, even though the rails server is picking it up in the post. I can get to my calendar fine, and hit the new request button, fill out the form, but when I go to post that form the browsers gives me this:</p>\n\n<pre><code>undefined method `strftime' for nil:NilClass\n\nExtracted source (around line #3):\n\n1: &lt;h1&gt;&lt;%= @vacationrequest.request_name %&gt;&lt;/h1&gt;\n2: \n3: &lt;p class=\"info\"&gt;Requested For &lt;%= @vacationrequest.request_date.strftime(\"%B %e, %Y\") %&gt;&lt;/p&gt;\n4: \n5: &lt;%= simple_format @vacationrequest.message %&gt;\n6: \n</code></pre>\n\n<p>And I get this error on the Rails server:</p>\n\n<pre><code>Started GET \"/vacationrequests/1\" for 127.0.0.1 at 2012-10-17 15:18:14 -0400\nProcessing by VacationrequestsController#show as HTML\nParameters: {\"id\"=&gt;\"1\"}\n←[1m←[35mVacationrequest Load (0.0ms)←[0m SELECT \"vacationrequests\".* FROM \"v\nacationrequests\" WHERE \"vacationrequests\".\"id\" = ? LIMIT 1 [[\"id\", \"1\"]]\nRendered vacationrequests/show.html.erb within layouts/application (15.6ms)\nCompleted 500 Internal Server Error in 31ms\n\nActionView::Template::Error (undefined method strftime' for nil:NilClass):\n1: &lt;h1&gt;&lt;%= @vacationrequest.request_date %&gt;&lt;/h1&gt;\n2:\n3: &lt;p class=\"info\"&gt;Requested For &lt;%= @vacationrequest.request_date.strftime(\n\"%B %e, %Y\") %&gt;&lt;/p&gt;\n4:\n5: &lt;%= simple_format @vacationrequest.message %&gt;\n6:\napp/views/vacationrequests/show.html.erb:3:inapp_views_vacationrequests_sho\nw_html_erb_217743956_18446544'\n</code></pre>\n\n<p>This is my show view:</p>\n\n<pre><code>&lt;h1&gt;&lt;%= @vacationrequest.request_name %&gt;&lt;/h1&gt;\n\n&lt;p class=\"info\"&gt;Requested For &lt;%= @vacationrequest.request_date.strftime(\"%B %e, %Y\") %&gt;&lt;/p&gt;\n\n&lt;%= simple_format @vacationrequest.message %&gt;\n\n&lt;p&gt;\n  &lt;%= link_to \"Edit Request\", edit_vacationrequest_path(@vacationrequest) %&gt; |\n  &lt;%= link_to \"Back to Requests\", vacationrequests_path %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>and this is the _form that the user puts the request information into:</p>\n\n<pre><code>&lt;%= form_for @vacationrequest do |f| %&gt;\n  &lt;% if @vacationrequest.errors.any? %&gt;\n    &lt;div id=\"error_explanation\"&gt;\n      &lt;h2&gt;&lt;%= pluralize(@vacationrequest.errors.count, \"error\") %&gt; prohibited this request from being saved: if this continue to happens please email the error to alex@allsafeindustries.com&lt;/h2&gt;\n      &lt;ul&gt;\n      &lt;% @vacationrequest.errors.full_messages.each do |msg| %&gt;\n        &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n      &lt;% end %&gt;\n      &lt;/ul&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :request_name %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :request_name %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :request_date %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :request_date %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :message %&gt;&lt;br /&gt;\n    &lt;%= f.text_area :message %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Finally here are my show and index methods in my controller:</p>\n\n<pre><code>  def index\n    @vacationrequests = Vacationrequest.all\n    @vacationrequests_by_date = @vacationrequests.group_by(&amp;:request_date)\n    @date = params[:date] ? Date.parse(params[:date]) : Date.today\n  end\n\n  def show\n    @vacationrequest = Vacationrequest.find(params[:id])\n  end\n</code></pre>\n\n<p>Can anybody direct me to what is out of place or why this is nil? Thank you.</p>\n\n<p>In response to the answer here is what I am now getting from the server:</p>\n\n<pre><code>Started POST \"/vacationrequests\" for 127.0.0.1 at 2012-10-17 20:18:00 -0400\nProcessing by VacationrequestsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"√\", \"authenticity_token\"=&gt;\"E1+xXP0pAIQpwMZruswxIZIrTZB3b\nc3NlW3iRv9OLqU=\", \"vacationrequest\"=&gt;{\"request_name\"=&gt;\"One more time\", \"request_\ndate\"=&gt;\"10/31/2012\", \"message\"=&gt;\"Lucky number 7?\"}, \"commit\"=&gt;\"Create Vacationre\nquest\"}\n  ←[1m←[35m (0.0ms)←[0m  begin transaction\n  ←[1m←[36mSQL (15.6ms)←[0m  ←[1mINSERT INTO \"vacationrequests\" (\"created_at\", \"\nmessage\", \"request_date\", \"request_name\", \"updated_at\") VALUES (?, ?, ?, ?, ?)←[\n0m  [[\"created_at\", Thu, 18 Oct 2012 00:18:00 UTC +00:00], [\"message\", \"Lucky nu\nmber 7?\"], [\"request_date\", nil], [\"request_name\", \"One more time\"], [\"updated_a\nt\", Thu, 18 Oct 2012 00:18:00 UTC +00:00]]\n  ←[1m←[35m (109.2ms)←[0m  commit transaction\nRedirected to http://localhost:3000/vacationrequests/7\nCompleted 302 Found in 125ms (ActiveRecord: 124.8ms)\n\n\nStarted GET \"/vacationrequests/7\" for 127.0.0.1 at 2012-10-17 20:18:01 -0400\nProcessing by VacationrequestsController#show as HTML\n  Parameters: {\"id\"=&gt;\"7\"}\n  ←[1m←[36mVacationrequest Load (0.0ms)←[0m  ←[1mSELECT \"vacationrequests\".* FRO\nM \"vacationrequests\" WHERE \"vacationrequests\".\"id\" = ? LIMIT 1←[0m  [[\"id\", \"7\"]\n]\n  Rendered vacationrequests/show.html.erb within layouts/application (15.6ms)\n    Completed 500 Internal Server Error in 16ms\n\nActionView::Template::Error (undefined method `strftime' for nil:NilClass):\n    1: &lt;h1&gt;&lt;%= @vacationrequest.request_name %&gt;&lt;/h1&gt;\n    2: &lt;%= debug @vacationrequest %&gt;\n    3: &lt;p class=\"info\"&gt;Requested For &lt;%= @vacationrequest.request_date.strftime(\n\"%B %e, %Y\") %&gt;&lt;/p&gt;\n    4:\n    5: &lt;%= simple_format @vacationrequest.message %&gt;\n    6:\n  app/views/vacationrequests/show.html.erb:3:in `_app_views_vacationrequests_sho\nw_html_erb___377763931_36688344'\n</code></pre>\n\n<p>I also used the view debug and checked my scheme and all of the attributes seemed to line up correctly.</p>\n\n<p>As for the request in the comments here is my Vacationrequest model:</p>\n\n<pre><code>class Vacationrequest &lt; ActiveRecord::Base\n  attr_accessible :message, :request_name, :request_date\nend\n</code></pre>\n\n<p>Once again I can't thank you enough for your help.</p>\n\n<p>Here is the schema:</p>\n\n<pre><code>ActiveRecord::Schema.define(:version =&gt; 20121016194123) do\n\n  create_table \"vacationrequests\", :force =&gt; true do |t|\n    t.string   \"request_name\"\n    t.date     \"request_date\"\n    t.text     \"message\"\n    t.datetime \"created_at\",   :null =&gt; false\n    t.datetime \"updated_at\",   :null =&gt; false\n  end\nend\n</code></pre>\n\n<p>and the create controller action code:</p>\n\n<pre><code>def create\n  @vacationrequest = Vacationrequest.new(params[:vacationrequest])\n  if @vacationrequest.save\n    redirect_to @vacationrequest, notice: \"Created Request!\"\n  else\n    render :new\n  end\nend\n</code></pre>\n\n<p>As I'm looking at this, is part of the problem my schema being plural and my controller being singular? Thanks again.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku"],"answer_count":6,"favorite_count":7,"up_vote_count":19,"down_vote_count":1,"view_count":2682,"score":18,"question_id":4217759,"title":"Is Heroku worth it?","body":"<p>I'm trying to decide between Heroku and Engineyard.</p>\n\n<p>Heroku seems so much better but they charge for everything and their prices are crazy!</p>\n\n<p>Why one should use Heroku over EY or vice versa?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12927350,"title":"Rails: how to count number of users?","body":"<p>here is my models.</p>\n\n<p><strong>User</strong>\nunit_id</p>\n\n<p><strong>Unit</strong>\nblock_id</p>\n\n<p><strong>Block</strong>\npostalcode_id</p>\n\n<p><strong>Postalcode</strong>\nneighbourhood_id</p>\n\n<p><strong>Neighbourhood</strong>\nname</p>\n\n<p>the relations is for all is top belongs to bottom</p>\n\n<p>this is my current index.html.erb file, i wish to output the number of user in each neighbourhood.</p>\n\n<pre><code>&lt;% provide(:title, 'Neighbourhoods') %&gt;\n&lt;ul class=\"thumbnails\"&gt;\n    &lt;% @neighbourhoods.each do |neighbourhood| %&gt;\n    &lt;li class=\"span3\"&gt;\n        &lt;div class=\"thumbnail\"&gt;\n            &lt;div style=\"position:relative;\"&gt;\n                &lt;%= link_to \"Join\", '#', class: \"btn-join\" %&gt;\n                &lt;%= image_tag(neighbourhood.name+\".jpg\", alt: neighbourhood.name) %&gt;\n            &lt;/div&gt;\n            &lt;h2 style=\"margin-bottom:0px\"&gt;&lt;%= neighbourhood.name.titleize %&gt;&lt;/h2&gt;\n            &lt;% neighbourhood.postalcodes.each do |postalcode| %&gt;\n            &lt;%= postalcode.blocks.map(&amp;:block).join(\", \") %&gt;\n            &lt;% end %&gt;\n            &lt;br&gt;\n            &lt;%= neighbourhood.streetname.titleize %&gt;\n        &lt;/div&gt;\n    &lt;/li&gt;\n    &lt;% end %&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","delayed-job","worker"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12945638,"title":"Delay Job Worker keeps turning off?","body":"<p>New to Rails and very new to Delayed Jobs. </p>\n\n<p>Got one that's supposed to be triggered after 5 minutes. I finally got it to work so that if I run </p>\n\n<pre><code>rake jobs:work\n</code></pre>\n\n<p>in my terminal, the job starts up and works correctly. If I CTRL-C and exit that action in my terminal, the delayed job stops working correctly. This is one thing on my local server and another on Heroku, where I have to start up the delayed job using</p>\n\n<pre><code>heroku run rake jobs:work\n</code></pre>\n\n<p>I looked into the new Heroku toolbelt and downloaded the gem they suggest for worker maintenance, foreman, but when I run \"foreman start\", I get this error</p>\n\n<pre><code>ERROR: procfile does not exist\n</code></pre>\n\n<p>I don't know what a procfile is, I'm afraid of breaking things after spending pretty much a day debugging my delayed_jobs actions, and I want to do this right to make sure it works instead of figuring out some hacky fix that breaks down later -- so I figured I should ask this question, however obnoxiously vague it may be. </p>\n\n<p>Should I be using foreman for this? Or workless? (Saw that in another SO question). Where's my procfile? Should I do anything with it?</p>\n\n<p>Thanks,</p>\n\n<p>Sasha</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12952979,"title":"Rails non-standard asset types precompilation","body":"<p>We now are developing one Rails project and we have binary files served by our system. So we decided (well, not <em>we</em> but my <em>senior team-mate</em>, actually) to store those files within the <strong>/app/assets/binaries</strong> (let's call it so) folder. </p>\n\n<p>For some reasons our administrator get fired and I started administrating the half of our server by my own. And what I found out was something interesting: while starting the server and precompiling the assets, some very large amount of operations took place. And our hard-drive free space began to decrease incredibly fast (<em>because of Capistrano deploys frequently too, of course</em>).</p>\n\n<p>So, what i am asking is: how Rails assets precompilation works? Does it serves <strong>all files within the /app/assets/ directory</strong> or does it serves only those which are <em>\"understandable\"</em> by Rails?</p>\n\n<p>My theory is: <code>rake assets:precompile</code> handles our binary files and makes some kind of copy of those files. Am i wrong or am i right?</p>\n"},{"tags":["ruby-on-rails-3","cookies"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12953368,"title":"Rails 3: Detect if cookies are disabled on server side","body":"<p>Whats the best way to do this (if possible at all)?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-attributes","thinking-sphinx","sti"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12904678,"title":"accepts_nested_attributes_for for STI Model","body":"<p>Here is my current model structure</p>\n\n<pre><code>class Customer &lt; ActiveRecord::Base\n  self.inheritance_column = 'customer_type'\n\n  has_one :contact\n  accepts_nested_attributes_for :contact\nend\n\nclass Vendor &lt; Customer\n\n  has_many :domains\n  accepts_nested_attributes_for :domains\nend\n\nclass Club &lt; Customer\nend\n</code></pre>\n\n<p>When i create a form for vendor </p>\n\n<pre><code>= form_for @vendor do |f|\n  = f.fields_for :contact do |c|\n    ....\n  = f.fields_for :domains do |d|\n    ...\n</code></pre>\n\n<p>it renders properly. Same thing with club without the domains. Now when i edit it and click update for vendor for it gives me the following error</p>\n\n<pre><code>NoMethodError: undefined method `[]' for nil:NilClass\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/nested_attributes.rb:327:in `assign_nested_attributes_for_one_to_one_association'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/nested_attributes.rb:288:in `contact_attributes='\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/attribute_assignment.rb:94:in `block in assign_attributes'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/attribute_assignment.rb:93:in `each'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/attribute_assignment.rb:93:in `assign_attributes'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/persistence.rb:212:in `block in update_attributes'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/connection_adapters/abstract/database_statements.rb:190:in `transaction'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/transactions.rb:208:in `transaction'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/persistence.rb:211:in `update_attributes'\napp/controllers/vendors_controller.rb:34:in `update'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/implicit_render.rb:4:in `send_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/abstract_controller/base.rb:167:in `process_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/rendering.rb:10:in `process_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/abstract_controller/callbacks.rb:18:in `block in process_action'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:514:in `block in _run__551367052__process_action__739945711__callbacks'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:215:in `block in _conditional_callback_around_1211'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:326:in `around'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:310:in `_callback_around_13'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:214:in `_conditional_callback_around_1211'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:403:in `_run__551367052__process_action__739945711__callbacks'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `__run_callback'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:81:in `run_callbacks'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/abstract_controller/callbacks.rb:17:in `process_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/rescue.rb:29:in `process_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/notifications.rb:123:in `block in instrument'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/notifications.rb:123:in `instrument'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/instrumentation.rb:29:in `process_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/params_wrapper.rb:205:in `process_action'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/railties/controller_runtime.rb:18:in `process_action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/abstract_controller/base.rb:121:in `process'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/abstract_controller/rendering.rb:45:in `process'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal.rb:203:in `dispatch'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_controller/metal.rb:246:in `block in action'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:66:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:66:in `dispatch'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:30:in `call'\n[GEM_ROOT]/gems/journey-1.0.0/lib/journey/router.rb:60:in `block in call'\n[GEM_ROOT]/gems/journey-1.0.0/lib/journey/router.rb:48:in `each'\n[GEM_ROOT]/gems/journey-1.0.0/lib/journey/router.rb:48:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/routing/route_set.rb:570:in `call'\n[GEM_ROOT]/gems/sass-3.1.12/lib/sass/plugin/rack.rb:54:in `call'\n[GEM_ROOT]/gems/warden-1.1.1/lib/warden/manager.rb:35:in `block in call'\n[GEM_ROOT]/gems/warden-1.1.1/lib/warden/manager.rb:34:in `catch'\n[GEM_ROOT]/gems/warden-1.1.1/lib/warden/manager.rb:34:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/etag.rb:23:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/conditionalget.rb:35:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/head.rb:14:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/params_parser.rb:21:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/flash.rb:242:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/cookies.rb:338:in `call'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/query_cache.rb:64:in `call'\n[GEM_ROOT]/gems/activerecord-3.2.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `_run__575954635__call__637953697__callbacks'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:405:in `__run_callback'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/callbacks.rb:81:in `run_callbacks'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/callbacks.rb:27:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/sendfile.rb:102:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\n[GEM_ROOT]/gems/railties-3.2.0/lib/rails/rack/logger.rb:26:in `call_app'\n[GEM_ROOT]/gems/railties-3.2.0/lib/rails/rack/logger.rb:14:in `block in call'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/tagged_logging.rb:25:in `tagged'\n[GEM_ROOT]/gems/railties-3.2.0/lib/rails/rack/logger.rb:14:in `call'\n[GEM_ROOT]/gems/actionpack-3.2.0/lib/action_dispatch/middleware/request_id.rb:22:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\n[GEM_ROOT]/gems/activesupport-3.2.0/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n[GEM_ROOT]/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'\n[GEM_ROOT]/gems/rack-cache-1.1/lib/rack/cache/context.rb:132:in `forward'\n[GEM_ROOT]/gems/rack-cache-1.1/lib/rack/cache/context.rb:139:in `pass'\n[GEM_ROOT]/gems/rack-cache-1.1/lib/rack/cache/context.rb:151:in `invalidate'\n[GEM_ROOT]/gems/rack-cache-1.1/lib/rack/cache/context.rb:70:in `call!'\n[GEM_ROOT]/gems/rack-cache-1.1/lib/rack/cache/context.rb:50:in `call'\n[GEM_ROOT]/gems/railties-3.2.0/lib/rails/engine.rb:479:in `call'\n[GEM_ROOT]/gems/railties-3.2.0/lib/rails/application.rb:220:in `call'\n[GEM_ROOT]/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/rack/request_handler.rb:96:in `process_request'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_request_handler.rb:513:in `accept_and_process_next_request'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_request_handler.rb:274:in `main_loop'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:206:in `start_request_handler'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:171:in `block in handle_spawn_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/utils.rb:479:in `safe_fork'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:166:in `handle_spawn_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:180:in `start'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/rack/application_spawner.rb:129:in `start'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:253:in `block (2 levels) in spawn_rack_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:246:in `block in spawn_rack_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb:82:in `block in synchronize'\n:\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server_collection.rb:79:in `synchronize'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:244:in `spawn_rack_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:137:in `spawn_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'\n[GEM_ROOT]/gems/passenger-3.0.11/lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'\n[GEM_ROOT]/gems/passenger-3.0.11/helper-scripts/passenger-spawn-server:99:in `&amp;lt;main&amp;gt;'\n</code></pre>\n\n<p>If I take <code>domains</code> association and move that into customer, it works fine.. but it does seem to like having that association in the child model.</p>\n\n<p>Am I doing something wrong or is this a peculiar bug?</p>\n\n<p><strong>Update:</strong> We recently installed thinking sphinx into the application. It could be related to that as well. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","condition","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12953600,"title":"has_many conditions with an argument","body":"<p>I have the following models:</p>\n\n<pre><code>Trip -&gt; has_many trip_members &amp; belongs_to user\nTrip -&gt; has_many shares\nShare -&gt; belongs_to user\n</code></pre>\n\n<p>In my trip model, I'm setting up a relationship like this</p>\n\n<pre><code>has_many :shares, :conditions =&gt; proc { |user| {:user_id =&gt; user.id} }\n</code></pre>\n\n<p>so that I always have a user associated with the share. I'm trying to access this by passing in a user object in the call to trip.shares(user), but that doesn't seem to work. How does this passing argument to proc work ?</p>\n\n<p>Also, is this the right way to setup a condition ? I thought of overriding the generated methods (such as trip.shares&lt;&lt; etc) to include the user passed in as an argument, but that doesn't feel right.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","rails-routing"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12953136,"title":"Rails 3 routing constraint based on format and subdomain","body":"<p>Here is my scenario</p>\n\n<ul>\n<li>I have a bottle model which is routed as a resource</li>\n<li>I have a subdomain \"foo\"</li>\n</ul>\n\n<p>My requirement is the following</p>\n\n<ul>\n<li><p>A request to the /bottles/*whatever with \"www\" or no subdomain, made via html format should be redirected to <code>/bottles/*whateve</code>r to the \"sub\" subdomain</p></li>\n<li><p>A request to <code>/bottles/*whatever</code> with \"foo\" subdomain made via html format should just go straight to /bottles/*whatever without any redirection</p></li>\n<li><p>Any request to <code>/bottles/*whatever</code> with \"www\" or no subdomain made via json format shoudl go straight to /bottles/*whatever without any redirection</p></li>\n<li><p>A request to <code>/bottles/*whatever</code> with \"foo\" subdomain made via json format should just go straight to /bottles/*whatever without any redirection</p></li>\n</ul>\n\n<p>Here is my routes.rb</p>\n\n<pre><code>scope :constraints =&gt; lambda{|req| ((req.subdomain ==\"\" || req.subdomain==\"www\") &amp;&amp; req.format == \"html\") } do\n    match \"/bottles/*whatever\" =&gt; redirect{|p,req| URI.parse(req.url).tap { |x| x.host = \"foo.#{x.host}\" }.to_s}\n    match \"/bottles/\" =&gt; redirect{|p,req| URI.parse(req.url).tap { |x| x.host = \"foo.#{x.host}\" }.to_s} \n  end\n\nresources :bottles\n</code></pre>\n\n<p>the redirection part is constrained to make sure that we only redirect if we have \"\" or \"Www\" subdomain and format is html, otherwise directly use <code>resources :bottles</code>.</p>\n\n<p>The above works perfectly in the below cases</p>\n\n<ul>\n<li><code>me.com/bottles/*whatever with</code> html is redirected to <code>sub.me.com/bottles/*whatever</code></li>\n<li><code>sub.me.com/bottles/*whatever</code> with html directly routed to <code>sub.me.com/bottles/*whatever</code></li>\n<li><code>sub.me.com/bottles/*whatever</code> with json directly routed to <code>sub.me.com/bottles/*whatever</code></li>\n</ul>\n\n<p>but it fails in the following case</p>\n\n<ul>\n<li><p><code>me.com/bottles/*whatever</code> with <code>json</code> is not redirected as expected but it messes up my <code>params</code>, <code>/bottles/1</code> should be matched with <code>resource :bottles</code> and take me to <code>bottles#show</code> with <code>params[:id]=1</code>, but it takes me to <code>bottles#show</code> with <code>params[:whatver] = 1</code>,why does it put my <code>id</code> param in the <code>whatever</code> field ? when it was never redirected and never matched the routes inside the constraint part.. Any Ideas, Some server logs below</p>\n\n<p>Started GET \"/bottles/1.json\" for 127.0.0.1 at 2012-10-18 15:55:49 +0500\nProcessing by BottlesController#show as JSON\n  Parameters: {\"whatever\"=>\"1\"}\nCompleted 500 Internal Server Error in 1ms</p>\n\n<p>ActiveRecord::RecordNotFound (Couldn't find Bottle without an ID):\n  app/controllers/bottles_controller.rb:16:in `show'</p></li>\n</ul>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","logging"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12952694,"title":"Rails Development Logging - Clamping Request Values","body":"<p>I am developing a Rails application where I pass certain image data through request (base64). I need to do it that way since I do some processing on the client side. The problem with this approach is that it spams my server log a lot.</p>\n\n<p>Is there a nice way to clamp the parts of request that contain the long base64 strings somehow?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","wicked-pdf"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":3,"view_count":68,"score":-3,"question_id":12947055,"title":"How to convert an image file to PDF using Wicked PDF?","body":"<p>Right now I am working on Rails 3 version. I want to convert an image file to PDF format. I am using the Wicked PDF gem, but it is not working. Please help me. How to do this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12951967,"title":"Move search logic from controller to model","body":"<p>Now i do search logic in controller:</p>\n\n<pre><code>def index\n    @title = \"All cars\"\n    #show manufacturers only with cars\n    @manufacturers = Manufacturer.select('*')\n    @manufacturers = @manufacturers.where('count_cars &gt; ?', 0)\n\n    @cars = Car.select('*')\n    #manufacturer\n    @cars = @cars.where('manufacturer_id = ?', params[:filter_manufacturer]) if not params[:filter_manufacturer].blank?\n    #model\n    @models = Model.select('*')\n    @models = @models.where('manufacturer_id = ?', params[:filter_manufacturer]) if not params[:filter_manufacturer].blank? and not params[:filter_model].blank?\n    @models = @models.where('count_cars &gt; ?', 0)\n\n    @cars = @cars.where('model_id = ?', params[:filter_model]) if not params[:filter_model].blank?\n    #years\n    @cars = @cars.where('year &gt;= ?', params[:filter_year_from]) if not params[:filter_year_from].blank?\n    @cars = @cars.where('year &lt;= ?', params[:filter_year_to]) if not params[:filter_year_to].blank?\n    #district\n    @cars = @cars.where('district_id = ?', params[:filter_district]) if not params[:filter_district].blank?\n    #body type\n    @cars = @cars.where('car_body_type_id = ?', params[:filter_body_type]) if not params[:filter_body_type].blank?\n    #fuel\n    @cars = @cars.where('car_fuel_id = ?', params[:filter_fuel]) if not params[:filter_fuel].blank?\n    #transmission\n    @cars = @cars.where('car_transmission_id = ?', params[:filter_transmission]) if not params[:filter_transmission].blank?\n    #wheel drive\n    @cars = @cars.where('car_drive_wheel_id = ?', params[:filter_drive_wheel]) if not params[:filter_drive_wheel].blank?\n    #doors\n    @cars = @cars.where('doors = ?', params[:filter_doors]) if not params[:filter_doors].blank?\n    #without damage\n    @cars = @cars.where('damage = ?', false) if params[:filter_damage]\n    #with customs\n    @cars = @cars.where('customs = ?', true) if params[:filter_customs]\n    #not crashed\n    @cars = @cars.where('crash = ?', false) if params[:filter_crash]\n    #price\n    @cars = @cars.where('price &gt;= ?', params[:filter_price_from]) if not params[:filter_price_from].blank?\n    @cars = @cars.where('price &lt;= ?', params[:filter_price_to]) if not params[:filter_price_to].blank?\n\n    @cars = @cars.paginate(:page =&gt; params[:page], :per_page =&gt; 20)\nend\n</code></pre>\n\n<p>Do i have to move this logic to model? And if yes, please help me with markup.</p>\n"},{"tags":["ruby","ruby-on-rails-3","email","pony"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":10198035,"title":"Intercepting mail sent with the Pony gem, in a development environment","body":"<p>I'm using the Pony gem for ruby on rails, and am wondering if there's a way to intercept mail in the development and staging environments (any non-production environment) and send it to a controlled address, like you can do with ActionMailer.</p>\n\n<p>I know with ActionMailer you just can just use an interceptor...</p>\n"},{"tags":["sql","ruby-on-rails-3","sql-order-by","activeadmin"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12951724,"title":"Order by count of a has_many association","body":"<p>My models are:</p>\n\n<p>service_provider has_many questions,\nquestion belongs_to service_provider</p>\n\n<p>In Activeadmin, i want to index my service_providers and sort them by their questions_count. </p>\n\n<p>So, to get a field, i can sort by, i define my default_scope like this:</p>\n\n<pre><code>scope \"all\", :default =&gt; true do |sp|\n  sp.joins(\"LEFT JOIN questions on questions.service_provider_id = service_providers.id\")\n    .select(\"service_providers.*, COUNT(service_provider_id) as questions_count\")\n    .group(\"service_providers.id\")\nend\n</code></pre>\n\n<p>and my column definitions looks like:</p>\n\n<pre><code>column :questions, :sortable =&gt; \"questions_count\" do |sp|\n  sp.questions_count\nend\n</code></pre>\n\n<p>When indexing my serviceproviders, everything looks fine. But when i oder by their questions_count, i get the following error:</p>\n\n<pre><code> SQLite3::SQLException: no such column: service_providers.questions_count: SELECT  service_providers.*, COUNT(service_provider_id) as questions_count FROM \"service_providers\" LEFT JOIN questions on questions.service_provider_id = service_providers.id GROUP BY service_providers.id ORDER BY \"service_providers\".\"questions_count\" desc LIMIT 30 OFFSET 0\n</code></pre>\n\n<p>So, he tries to ORDER BY \"service_providers\".\"questions_count\" desc. Infact, he should ORDER BY \"questions_count\" desc.</p>\n\n<p>Any suggestions, how i can tell him to use the right fieldname in his order-statement?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12948195,"title":"Should I use Polymorphic association for this scenario?","body":"<p>I have 3 models. <code>Jobs</code>, <code>Businesses</code>, &amp; <code>Categories</code>.</p>\n\n<p><code>Jobs</code> have many <code>categories</code>.</p>\n\n<p><code>Businesses</code> have many <code>categories</code>. </p>\n\n<p><code>Categories</code> have many <code>jobs</code>.</p>\n\n<p><code>Categories</code> have many <code>businesses</code>.</p>\n\n<p>Is a polymorphic association the most appropriate for this scenario?</p>\n\n<hr>\n\n<p><em>category.rb</em></p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  attr_accessible :name\n  belongs_to :categorised, polymorphic: true\nend\n</code></pre>\n\n<p><em>business.rb</em></p>\n\n<pre><code>class Business &lt; ActiveRecord::Base\n  has_many :categories, as: :categorised\nend\n</code></pre>\n\n<p><em>job.rb</em></p>\n\n<pre><code>class Job &lt; ActiveRecord::Base\n  has_many :categories, as: :categorised\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12951121,"title":"Error while starting WEBrick server using rails","body":"<p>I have an existing application with database ready I have made all the changes in database.yml and did bundle install when I am trying to do rails s to start the WEBrick server I am getting the following error </p>\n\n<pre><code>/usr/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': File exists - /home/username/appname/app/releases/20120831125545/tmp (Errno::EEXIST)\nfrom /usr/lib/ruby/1.9.1/fileutils.rb:247:in `fu_mkdir'\nfrom /usr/lib/ruby/1.9.1/fileutils.rb:221:in `block (2 levels) in mkdir_p'\nfrom /usr/lib/ruby/1.9.1/fileutils.rb:219:in `reverse_each'\nfrom /usr/lib/ruby/1.9.1/fileutils.rb:219:in `block in mkdir_p'\nfrom /usr/lib/ruby/1.9.1/fileutils.rb:205:in `each'\nfrom /usr/lib/ruby/1.9.1/fileutils.rb:205:in `mkdir_p'\nfrom /home/username/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.10/lib/rails/commands/server.rb:62:in `block in start'\nfrom /home/username/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.10/lib/rails/commands/server.rb:61:in `each'\nfrom /home/username/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.10/lib/rails/commands/server.rb:61:in `start'\nfrom /home/username/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.10/lib/rails/commands.rb:30:in `block in &lt;top (required)&gt;'\nfrom /home/username/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.10/lib/rails/commands.rb:27:in `tap'\nfrom /home/username/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.10/lib/rails/commands.rb:27:in `&lt;top (required)&gt;'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Am I missing some step , Do I have to re run the migration (I have the database ready with me with data in it)\nany help?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","papertrail"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12951209,"title":"Papertrail versioning & storing current versions?","body":"<p>I've added the Papertrail gem to my app after approx 1000 records have already been created. </p>\n\n<p>Does anyone know how to populate the versions table with the current versions of my data? </p>\n\n<p>Without doing this it seems only the second change for each will allow me to properly make comparisions / flag what has changed via diffing etc.</p>\n\n<p>Many thanks!</p>\n"},{"tags":["ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12729627,"title":"CanCan Current_Client Error","body":"<p>Hi Have the following setup</p>\n\n<p>I have a login system for clients to login into the system. They can edit thier details on the system. I need to block them editing other clients details. This can be do by changing the Id in the URL.</p>\n\n<p>There is a Namespace in Place and it is called 'Profile'</p>\n\n<p>I have done this before with Users on the system, Does CanCan only support current_user or can i change this to current_client. As i am getting an error in the log file of the following:</p>\n\n<p>NameError (undefined local variable or method `current_user' for #):</p>\n\n<p>Code is as Follows:</p>\n\n<p>Application Controller</p>\n\n<pre><code>protect_from_forgery  \n  helper_method :current_client\n\n  rescue_from CanCan::AccessDenied do |exception|\n    redirect_to profile_url\n  end\n\n  private\n\n  def current_client\n    @current_client ||= Client.find(session[:client_id]) if session[:client_id]\n  end\n\n  def logged_in?\n    unless session[:client_id]\n      flash[:notice] = \"You need to log in first.\"\n      redirect_to login_path\n      return false\n    else\n      return true\n    end\n  end\n</code></pre>\n\n<p>Profile/clients_controller</p>\n\n<pre><code>  before_filter :logged_in?\n  load_and_authorize_resource\n\n  # GET /clients/1/edit\n  def edit\n    @client = Client.find(params[:id])\n  end\n\n  # PUT /clients/1\n  # PUT /clients/1.json\n  def update\n    @client = Client.find(params[:id])\n\n    respond_to do |format|\n      if @client.update_attributes(params[:client])\n        format.html { redirect_to [:profile,@client], :notice =&gt; 'Client was successfully updated.' }\n        format.json { head :ok }\n      else\n        format.html { render :action =&gt; \"edit\" }\n        format.json { render :json =&gt; @client.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>Any idea why it is coming up with this error.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization","rails-i18n"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12931840,"title":"Rails: i18n, variable gets printed if translation is not there","body":"<p>I am facing a weird problem. In my rails 3 app I am supporting internationalization with english and french. Here in my template I wrote something like this</p>\n\n<pre><code>&lt;%= t \"Hi %{person}!\", :person =&gt; \"Simpson\" %&gt;\n</code></pre>\n\n<p>When I set locale as french everything works fine, since it has got translation for this but when I set locale as english then it gives output as</p>\n\n<pre><code>Hi %{person}!\n</code></pre>\n\n<p>in my browser. When I add translation to en.yml, it works fine. I don't understand why there is need to add translation in en.yml for this. Moreover  I don't want this to happen, is there any work around for this?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12903980,"title":"Belongs_To / Has Many Relationship","body":"<p>I have the following:</p>\n\n<p>Clients have many Reports and Reports belong to a client.</p>\n\n<p>However on the creation of the Report it is not assigning the client_id into the database, but not sure why?</p>\n\n<p>Am i doing something wrong here?</p>\n\n<p>Client Model</p>\n\n<pre><code>class Client &lt; ActiveRecord::Base\n  has_many :reports, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>Report Model</p>\n\n<pre><code>class Report &lt; ActiveRecord::Base\n  has_attached_file :report\n  belongs_to :client\n\nend\n</code></pre>\n\n<p>Client Controller (Update)</p>\n\n<pre><code>  # PUT /clients/1\n  # PUT /clients/1.json\n  def update\n    @client = Client.find(params[:id])\n\n    respond_to do |format|\n      if @client.update_attributes(params[:client])\n        format.html { redirect_to [:admin,@client], :notice =&gt; 'Client was successfully updated.' }\n        format.json { head :ok }\n      else\n        format.html { render :action =&gt; \"edit\" }\n        format.json { render :json =&gt; @client.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>Report Controller (Create)</p>\n\n<pre><code>  # POST /reports\n  # POST /reports.json\n  def create\n    @report = Report.new(params[:report])\n    @report.client_id = params[:client][:client_id]\n\n    respond_to do |format|\n      if @report.save\n        format.html { redirect_to '/admin/clients', :notice =&gt; 'Report was successfully created.' }\n        format.json { render :json =&gt; @report, :status =&gt; :created, :location =&gt; @report }\n      else\n        format.html { render :action =&gt; \"new\" }\n        format.json { render :json =&gt; @report.errors, :status =&gt; :unprocessable_entity }\n      end\n    end\n  end\n</code></pre>\n\n<p>Client Edit View</p>\n\n<pre><code>&lt;%= form_for([:admin, @client.reports.build]) do |f| %&gt;\n   &lt;label class=\"formlabel\"&gt;Report Upload&lt;/label&gt;\n   &lt;%= f.file_field :report, :class=&gt;\"text-input small-input\"  %&gt; \n  &lt;div class=\"actions\"&gt;\n    &lt;br /&gt;\n   &lt;%= f.submit 'Upload', :class =&gt; 'button' %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;   \n</code></pre>\n\n<p>Assistance would be appreciated!</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12950495,"title":"rails complex table","body":"<p>i'm having a huge problem with creating this table.</p>\n\n<p>I have a model</p>\n\n<p><strong>Unit</strong>\nid\nfloor\nunitnumber</p>\n\n<p>here is my current code for view</p>\n\n<pre><code>&lt;% block.units.each do |unit| %&gt;\n....\n&lt;% end %&gt;\n</code></pre>\n\n<p>I need to loop through the entire block, get all the unique unitnumber and floor. Create a table like this.</p>\n\n<pre><code>BLOCKNO  Unitnumber1  Unitnumber2  Unitnumber3  Unitnumber4  Unitnumber5  Unitnumber6\nFloor10   unit_id      unit_id      unit_id      unit_id\nFloor9\nFloor8\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12950267,"title":"record of one index page is not shown in another index page, rails","body":"<p>I want to display record(title) from one index page to another, for this I do </p>\n\n<p>In index.haml:- </p>\n\n<pre><code>-if @individual.important_event.present?\n  -@individual.important_event.each do |event|\n    %p\n     = link_to event.title, important_events_path\n</code></pre>\n\n<p>In individual.rb:-</p>\n\n<pre><code>has_many :important_event\n</code></pre>\n\n<p>In important_event.rb:-</p>\n\n<pre><code>belongs_to :individual\n</code></pre>\n\n<p>But it do not work. It gives error \"undefined method `each' for #&lt; ImportantEvent:0xbb729c8>\"</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":22,"score":1,"question_id":12949827,"title":"rails 3 Duplicated Code Multiple Projects","body":"<p>I am working on multiple projects, which most of them have common controllers and views.</p>\n\n<p>Is there a way to be able to copy all the common code in a script or something?</p>\n\n<p>Any ideas on this</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","spring-roo"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12949349,"title":"Ruby on Rails or Spring Roo","body":"<p>I was asked to do research on a scaffolding structure for a 'campus management' web solution. It consists of many modules and needs add-ons like PDF creator, graph creator, etc.</p>\n\n<p>During my research I stumbled on RoR and Spring Roo. Can you tell me which is easier when it comes to plugins and developing a web app quickly, with less strain?</p>\n\n<p>This project will be done as a team, so that is also something to be considered.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","form-validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12883325,"title":"Show ruby on rails server side form validation on a particular input element","body":"<p>I'm able to show all the errors on the top of the form. What i want is that i want to show error just below every input fields. For example i have two fields name and description,then it should display error relating to name just below the name input fields and description just below the description input field. Any help will be appreciated,thanks in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","haml"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12927237,"title":"Correct HAML for linking an image to another page in my Ruby on Rails app","body":"<p>Trying to figure out how to use haml \"link_to\" with Ruby code in order to make an image on a page link to another page on the site. If possible I'd like to keep the nav static and fade the two pages in and out via a \"Forward\" and \"Back\" image. Any ideas? Just want to get the linking right first and then can go in and figure out the JQuery. Currently have the code below...</p>\n\n<p>Thanks!!</p>\n\n<pre><code>    .pad-bottom50\n    %div{:style =&gt; \"position: absolute; top: 620px; left: 830px;\"}\n        =link_to (image_tag(@page.photos[1].image_url(:full), :id =&gt; \"#fade1\", :class =&gt; \"animated\") if @page.photos[1].image? \n    .pad-top20  \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","roles","user-roles"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12948455,"title":"how can i assign each user to have access to the projects on different condition?","body":"<p>I have devise for authentication and i have to make specific users to have only view permission for that particular projects and create and read permission for the same user for different projects similarly the rest of the users should have permissions for projects. And this permission should be editable so that the user with role admin has to edit the permission for the users. How can i do this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12916251,"title":"how to deal with the situation while DB Down?","body":"<h3>how to deal with the situation while DB Down!</h3>\n\nDescription:\n\nServer:Passenger\n\n<p>Imagine:\nWhile you app'running,one of the dbs down,so this rails goes wrong,when new request to the website,there will be new rails to answer the request(but DB still down),so it's keeping going wrong till all rails go wrong!</p>\n\n<h3>so whats the solution under this situation?</h3>\n"},{"tags":["ruby-on-rails-3","rspec2","email-spec"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12947790,"title":"rails rspec email_spec fails but real emailing works","body":"<p>Real emailing works but the test fails. Not sure whats going wrong. Does anyone know what could be the problem?</p>\n\n<p>TasksController\n  POST create\n    with valid params\n      emails the collaborators (FAILED - 1) </p>\n\n<pre><code>  it 'emails the collaborators' do\n    post :create, { :task =&gt; valid_attributes }\n\n    Emailer.should_receive(:send_email).with(user, :new_task, assigns(:task).project)\n  end\n</code></pre>\n\n<p>Failures:    </p>\n\n<p>1) TasksController POST create with valid params emails the collaborators\n     Failure/Error: Emailer.should_receive(:send_email).with(user, :new_task, assigns(:task).project)\n       ().send_email(#, :new_task, 'blah')<br>\n           expected: 1 time<br>\n           received: 0 times</p>\n\n<p>I have the following gems:<br>\nrails (3.2.7)<br>\nrspec-rails (2.11.4)<br>\nemail_spec (1.2.1)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","inheritance","multiple-inheritance","class-table-inheritance"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12945254,"title":"Ruby on Rails inheritance","body":"<p>I want to I achieve the following model structure in my Rails application having 3 separate tables - Value, DecimalValue and TextValue - in which DecimalValue and TextValue inherit from Value. The idea is that Value should contain only the id, and the child tables should refer to that id.\nHow can I implement this based o ROR?</p>\n\n<p>Value model (id, type)\nDecimalValue (value_id, value:decimal)\nTextValue (value_id, value:string)</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":25,"score":1,"question_id":12947406,"title":"Check whether wget succeeds in Rails","body":"<p>In my Rails 3 project, in the controller, I use the command <code>wget</code> to download files from the Internet and place them on my server. In the controller, I want to check whether <code>wget</code> succeeds in downloading the files. How can I perform that check?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":2,"view_count":51,"score":-1,"question_id":12945650,"title":"Rails 3: form_for missing closing </form> tag","body":"<p>I am using a form_for in one of my views in my rails app, but for some reason the closing tag  is not being generated, and this will be handled safely in most browsers, except IE 8 and lower. </p>\n\n<p>Here's some sample code: </p>\n\n<pre><code>&lt;%= form_for object, :remote =&gt; true, :url =&gt; remote_update_path, :html =&gt; {:name =&gt; \"form_#{id_number}\", :id =&gt; \"form_#{id_number}\"} do |f| %&gt;\n    &lt;%= hidden_field_tag \"field_a\", object[:field_a] %&gt;\n    &lt;ul class=\"class1\"&gt;\n        &lt;li&gt; &lt;%= f.check_box :field_b, :class =&gt; \"class2\", :id =&gt; \"b\"  %&gt; B&lt;/li&gt;\n        &lt;li&gt; &lt;%= f.check_box :field_c, :class =&gt; \"class2\", :id =&gt; \"c\" %&gt; C&lt;/li&gt;\n    &lt;/ul&gt;\n &lt;% end %&gt;\n</code></pre>\n\n<p>For some reason this isn't generating the closing <code>&lt;/form&gt;</code> tag where <code>&lt;% end %&gt;</code> is located. (I know there is now submit button in the form, this does not affect the missing <code>&lt;/form&gt;</code>.)</p>\n\n<p>Is this a bug? or is there something that I'm doing wrong?</p>\n"},{"tags":["ruby-on-rails-3","button","form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12946823,"title":"Multiple Buttons (not submit) in form rails 3","body":"<p>This is a generalized question. I'm not asking one to write any code for me, I just can't quite wrap my head around this. </p>\n\n<p>I know about f.button but from what I can tell that just acts as a submit button and refreshes things. I've also tried button_tag, but I can't get that working properly either. </p>\n\n<p>I have a Rating form that user's use to submit information (duh). I have 3 different categories that a user can rate \"Good\" \"Ok\" \"Bad\". The \"Good\", \"Ok\", \"Bad\" I would like to be buttons that the user can click and then once that form is submitted this rating goes into the database next to the category. Each time a user submits the rating form they will rate all 3 categories as either \"Good\", \"Ok\", \"Bad\".</p>\n\n<p>A rating belongs to a user and a user has_many ratings.</p>\n\n<p>Example When someone submits the rating form I'd want it to look like this:</p>\n\n<pre><code>ID  Category 1      Category 2     Category 3    User ID\n1    Good              Ok             Good         1\n</code></pre>\n\n<p>Does this make sense? Is this possible to do?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rails-migrations","rails-models"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":67,"score":1,"question_id":12944962,"title":"Ruby on Rails: how to migrate changes made on models?","body":"<p>In a Rails application, how can I migrate the changes I make in models? For instance, I know that if I create a model with command \"rails g model Person name:string\", a migration will be created as well. However, if after this step I go to the created model \"Person\" and add a new attribute, will this new attribute be automatically added to a migration for later persistance in database?\nOr am I looking at this from the wrong side, and an attribute should be added to a migration, and then added to a model?</p>\n\n<p>Regards</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12943578,"title":"generating a hash lookup table for indexes of objects in array","body":"<p>I want to create a lookup table to find the index of an object in an array:</p>\n\n<p>Eet an array <code>[\"a\", \"b\", \"c\"]</code> and generate a lookup hash table for each object's indexes <code>{\"a\"=&gt;0, \"b\"=&gt;1, \"c\"=&gt;2}</code></p>\n\n<p>The simplest ways I can come up with are:</p>\n\n<pre><code>i = 0\nlookup = array.each_with_object({}) do |value,hash|\n  hash[value] = i\n  i += 1\nend\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>i = -1\nlookup = Hash[array.map {|x| [x, i+=1]}]\n</code></pre>\n\n<p>I feel there are more elegant solutions to doing this, any idea is welcome!</p>\n"}]}
{"total":34675,"page":17,"pagesize":100,"questions":[{"tags":["ruby-on-rails-3","render","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12944183,"title":"Rails ERB -- get the generated HTML content to a variable I can access in a controller","body":"<p>I am doing an online contract agreement which is generated dynamically based on the current state of our contract language (stored in an ERB partial).  </p>\n\n<p>When the user clicks \"I Agree\" we save the variable data, but I also want to store the contents of the rendered partial (html fragment) in the database.</p>\n\n<p>I tried using <code>ActionView::Helpers::CaptureHelper.capture</code> -- wrapping the whole partial in a block and rendering at the end, like</p>\n\n<pre><code>&lt;% @saved_output = capture do %&gt;\n...\nThe rest of the erb with instance variable &lt;%= @my_class.name %&gt; and so on\n...\n&lt;% end %&gt;\n&lt;%= @saved_output %&gt;\n&lt;% logger.debug \"Rendered output is: #{@saved_output}\" %&gt;\n</code></pre>\n\n<p>And this produced the same result and also sent the correct text to the log.  But it appears to go out of scope -- even if I declare <code>@saved_output = nil</code> prior to render it's <code>nil</code> when I end the block.</p>\n\n<p>I tried using <code>content_for</code> as well ... which makes some sense to me, but ... huh, just not getting it.  Any helpful pointers appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12925764,"title":"Devise - override redirect for the custom login page","body":"<p>I have the following interesting problem.  I've created a secondary login form.  From that secondary form I want the user always to be redirected to the specific form.  I believe Devise is handling redirects in the following function in <strong>ApplicationController</strong>:</p>\n\n<pre><code>def after_sign_in_path_for(resource)\n  # custom redirect stuff\nend\n</code></pre>\n\n<p>What would be the best way to tell devise <em>\"if I am coming from the custom redirect path, always take me to some specific page and disregard what ever is in params[:redirect]\"</em>.  I was thinking of either inspecting referrer url string or storing stuff on the session, but I am not sure.</p>\n\n<p>What would be the best way to achieve this behaviour? Any suggestions would be appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","richtextbox","richtexteditor"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":114,"score":1,"question_id":11532240,"title":"Rich Text Field for Rails-App like Basecamp","body":"<p>We are currently using ckeditor for getting a rich text field in a rails application. This is not working very well, e.g. if you paste some text you never know what will happen after saving it.\nI would love to have the same text areas like basecamp has. Any idea or pointers how to get there?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","activerecord","arel"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":48,"score":3,"question_id":12946004,"title":"Issue when retriving records with empty array","body":"<p>I have a table of around 100 Users and i also have an array of user ids. What i wanted to do is show all users who are not apart of this array of user ids i have generated. When i do something like this</p>\n\n<pre><code> User.where('id NOT IN (?)', [9, 2, 3, 4])\n</code></pre>\n\n<p>It successfully returns me the records where the user's id does not belong in that array. However if that array is empty like so</p>\n\n<pre><code> User.where('id NOT IN (?)', [])\n</code></pre>\n\n<p>It does not return any users back and the sql query looks like this</p>\n\n<pre><code> SELECT \"users\".* FROM \"users\" WHERE (id NOT IN (NULL))\n</code></pre>\n\n<p>Does anyone know why this happens or could this be a bug? I am using rails 3.2.5 with postgres</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12932244,"title":"How to iterate a text value to Active Record Model name format in ruby on rails?","body":"<p>I have a <code>dialog popup</code> comes by <code>model name</code>. For example, </p>\n\n<pre><code>&lt;%= link_to pro_generic_lookup_data_path(\"Enr::Rds::Question2009\", format: :js), data: {remote: true}, id: \"question_picker\" do %&gt;\n      &lt;%= f.label :Question, class: 'question_label'%&gt;\n      &lt;%= f.text_field :Question, class: 'question_label'%&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I have the three <code>section</code> like this. I am getting the value in <code>javascript</code> and insert into the <code>fields</code> inside the <code>link_to</code> method.</p>\n\n<p>But the last <code>section</code>, would get the <code>question_id</code> and match the text in <code>answer_column</code>. The <code>answer_column</code> has the values of the <code>Model's</code> name like <code>enr_rds_question_t</code>. So, I should get this text and change into the model name like Enr::Rds::Question and make the <code>link_to</code> like to open the <code>dialog popup</code> box for <code>answers</code>. </p>\n\n<p>I am new to RoR, So apologize for that am not able to explain clearly.</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12945100,"title":"Calling and passing parameters from view to controller w/ select box and button","body":"<p>I'm trying to order a table (without any plugin) in a Rails app. The idea is to retrieve a table from database and order it with 3 select box. After I click on the \"Order\" button and refresh page with ordered data.</p>\n\n<p>I'm trying something and get this code:</p>\n\n<pre><code>def order\n  @clients = Client.all(:order =&gt; 'parameter1, parameter2, parameter 3')\nend\n</code></pre>\n\n<p>but, I have two questions:</p>\n\n<ol>\n<li>How can I pass parameters from a <code>&lt;select&gt;</code> box to controller's method <code>order</code>?</li>\n<li>How can I call this method and refresh the page with ordered data when I click the button?</li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","irb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12945447,"title":"Rails Console Doesn't Load .irbrc While Irb Does On Windows","body":"<p>I installed Rails 3.2.8 using RailsInstaller on Windows 7 64bit (Ruby 1.9.3). I then created a .irbrc file in my %HOME% directory - <code>C:\\Users\\Username</code> with the following content:</p>\n\n<pre><code>def h obj\n    puts \"This object is #{obj}\"\nend\n</code></pre>\n\n<p>If I use irb in the command line, I can access that method in .irbrc. However, when I fire up <code>rails c</code>, the method is not accessible, which means the .irbrc file is not loaded by <code>rails c</code>.</p>\n\n<p>Could anyone please help me figure out why is irb able to load the .irbrc file, but rails console is not loading it at all?</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails-3","cancan"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":40,"score":1,"question_id":12945634,"title":"The different ways of using CanCan abilities","body":"<p>I have four scenarios I want to get some feedback on so I can better understand how CanCan works with abilities.</p>\n\n<p>1 - Is using the object from an iteration acceptable for passing the model to CanCan.  It seems to work fine.  It seems this will define a very specific ability from the object passed.</p>\n\n<pre><code> @users.each do |user|\n    link_to user.name, user_path(user) if can? :edit, user\n</code></pre>\n\n<p>2 - @user is not a variable that is set in the controller.  This, I'm assuming, is the same as #1 since load_and_authorize_resource creates the @user instance.</p>\n\n<pre><code> @users.each do |user|\n    link_to user.name, user_path(user) if can? :edit, @user\n</code></pre>\n\n<p>But, what about when an instance variable exists in a view that is not related to the current model and is not deliberately set in the controller.  For instance the following inside the show user page when the @account instance is NOT set in the show action.  How does CanCan use @account when it shouldnt know what it even is?</p>\n\n<pre><code>  link_to \"view user account\", account_path(1) if can? :read, @account\n</code></pre>\n\n<p>3 - What about defining the ability using the model?  I assume this is a very broad \"can edit users\" ability...when would you ever use this?</p>\n\n<pre><code> @users.each do |user|\n    link_to user.name, user_path(user) if can? :edit, User\n</code></pre>\n\n<p>4 - Using an association.  Doesn't break the page...but, Im not sure if it is working as expected.</p>\n\n<pre><code> @users.each do |user|\n    link_to \"view user account\", account_path(1) if can? :read, user.account\n</code></pre>\n"},{"tags":["ruby-on-rails-3","devise","omniauth"],"answer_count":1,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":9221390,"title":"What does \":event => :authentication\" do?","body":"<p>This is actually a pretty simple question but I can't seem to find the answer. In the <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview\" rel=\"nofollow\">Omniauth Overview on Github</a>, there is actually an explanation but I don't get it:</p>\n\n<pre><code>We pass the :event =&gt; :authentication to the sign_in_and_redirect method\nto force all authentication callbacks to be called.\n</code></pre>\n\n<p>I already have authentication working using an action similar to this one:</p>\n\n<pre><code>def facebook\n  @user = User.find_for_facebook_oauth(request.env[\"omniauth.auth\"], current_user)\n\n  if @user.persisted?\n    sign_in_and_redirect @user, :event =&gt; :authentication\n  else\n    session[\"devise.facebook_data\"] = request.env[\"omniauth.auth\"]\n    redirect_to new_user_registration_url\n  end\nend\n</code></pre>\n\n<p>All I really want to know is what good is <code>:event =&gt; :authentication</code> for?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12941204,"title":"Is it possible for Rails to have a Model that can contain two types of models: Itself and Another model?","body":"<p>Essentially I'd like to have the following structure:</p>\n\n<p>class Group &lt; ActiveRecord::Base</p>\n\n<p>end</p>\n\n<p>class Person &lt; ActiveRecord::Base</p>\n\n<p>end</p>\n\n<pre><code>Group_1 (parent)\n  Group_2 (child)\n    Person_1 (grandchild)\n    Person_2 (grandchild)\n  Person_3 (child)\n  Group_3 (child)\n    Person_4 (grandchild)\n    Group_4 (grandchild)\n      Person_5 (great grandchild)\n</code></pre>\n\n<p>I've done research by trying out the following gems: acts_as_tree, ancestry, nested_sets and closure_tree.</p>\n\n<p>They are able to keep a tree which is one half of the challenge I have; but they are unable to add another model to the tree structure as they are always expecting the children to be of the same model. [Ex: ActiveRecord::AssociationTypeMismatch: Group (#2179078840) expected, got Person(#2171128160) from closure_tree gem]</p>\n\n<p>Is it in anyway possible to have the structure defined above to work with two different models inside the tree?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","network-programming","geolocation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":127,"score":0,"question_id":9584601,"title":"How reliable is Rails' ActionPack remote_ip for requests?","body":"<p>I have always been leery of methods that return public ip addresses.  They seem to be generally faulty unless you use an external service such as whatismyip.com.</p>\n\n<p><strong>How reliable is Rails remote_ip method at determining the external public ip 100% of the time?</strong> <a href=\"https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/remote_ip.rb\" rel=\"nofollow\">https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/remote_ip.rb</a></p>\n\n<p>I just discovered that the issue I was fighting was CloudFlare and it having a different header available of <code>CF-Connecting-IP</code>.  It appears that I have to yank that out via something along the lines of <code>(headers[\"CF-Connecting-IP\"] || remote_ip)</code> in order to overcome this particular situation.</p>\n\n<p>So it appears that either I need to monkey patch <code>remote_ip</code> or take this into consideration without drying up my code everywhere.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","customization","generate","scaffold"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":309,"score":3,"question_id":4696954,"title":"how to have the scaffold to generate another partial view template file","body":"<p>I'm trying to customize my <strong>scaffold generator</strong>, and I would like to have a new <strong>partial</strong> for the view in the same directory, in particular <code>_item</code> to be called both <strong>inside index and show</strong>. I can get all the templates but I'm not able to generate this file through</p>\n\n<pre><code>rails g scaffold foo name:string\n</code></pre>\n\n<p>I tried to put _item.erb in <code>/lib/templates/erb/scaffold/</code> (together with the other files) but it is ignored- Does anybody have a clue?</p>\n\n<p>I use ruby on rails 3, but please let me know if the solution is valid for rails 2 as well.\nI also use simple_form (thus I already have the _form partial), but I think the solution should be valid even without it.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","simple-form"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":1321,"score":0,"question_id":9449481,"title":"Multiple inputs on a single line with Twitter Bootstrap and Simple Form 2.0","body":"<p>I am using simple_form 2.0 with twitter bootstrap.</p>\n\n<p>I am trying to determine what is the proper wrapper format in order to get something like\n[city] [State] [Zip]</p>\n\n<p>I believe my form needs to be </p>\n\n<pre><code>&lt;div class=\"control-group\"&gt;\n  &lt;%= f.input :city,:wrapper =&gt; :small, :placeholder =&gt; \"City\", :input_html =&gt; { :class=&gt;\"span2\", :maxlength =&gt; 10},:label =&gt; false %&gt;\n  &lt;%= f.input :region, :wrapper =&gt; :small , :placeholder =&gt; \"Region\", :input_html =&gt; { :class=&gt;\"span1\", :maxlength =&gt; 5}, :label =&gt; false %&gt;\n  &lt;%= f.input :postal_code, :wrapper =&gt; :small,  :placeholder =&gt; \"Postal Code\",:input_html =&gt; { :class=&gt;\"span2\", :maxlength =&gt; 10},:label =&gt; false %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I tried this wrapper</p>\n\n<pre><code>  config.wrappers :small, :tag =&gt; 'div', :class =&gt; 'controls inline-inputs', :error_class =&gt; 'error' do |b|\n    b.use :placeholder\n    b.use :label_input\n  end\n</code></pre>\n\n<p>I believe I would need to define the CSS as well, but before I go down a rabbit hole I thought I would ask if this is built in somewhere.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12918783,"title":"count > 0 mongoid criteria","body":"<pre><code>Class User\nhas_many :gifts\nend\n\nClass Gift\nbelongs_to :user\nend\n</code></pre>\n\n<p>I want find if one or more users have one or more gifts something like:</p>\n\n<pre><code>User.any_of(gift: &gt; 0).count\n</code></pre>\n\n<p>How is the correct query?</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec-rails"],"answer_count":2,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12943090,"title":"RSpec test doesn't work but it's works great in browser","body":"<p>I don't know what I'm doing wrong so please help me out.</p>\n\n<p>So as the title says all works great in the browser. So I guess it's the spec I'm not able to get right.</p>\n\n<p>I've rewrote code in my helpers, controllers and spec several times to.</p>\n\n<p>Here's my spec for now:</p>\n\n<pre><code>describe \"visit as admin\" do\n    before do\n      sign_in admin\n      visit organization_users_path # row 20 of users_controller_spec\n    end\n    it \"should display right page\" do\n      page.should have_selector('title', text: \"Users\") \n    end\n  end\n</code></pre>\n\n<p>When i run it i get:</p>\n\n<pre><code>1) Organization::UsersController visit as admin should display right page\n     Failure/Error: visit organization_users_path\n     NoMethodError:\n       undefined method `users' for nil:NilClass\n     # ./app/controllers/organization/users_controller.rb:5:in `index'\n     # ./spec/controllers/organization/users_controller_spec.rb:20:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>And heres my controller and helper:</p>\n\n<pre><code># helper\ndef current_organization\n  @current_organization ||= current_user.organization\nend\n\ndef admin_user\n  unless current_user.admin?\n    redirect_to root_path\n  end\nend\n\n#controller\nclass Organization::UsersController &lt; ApplicationController\n  before_filter :admin_user\n\n  def index\n    @users = current_organization.users\n  end\nend\n</code></pre>\n\n<p>Edit 1: From <code>rake routes</code>:</p>\n\n<pre><code>organization_users GET    /organization/users(.:format)          organization/users#index\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":46,"score":1,"question_id":12926129,"title":"How would I group a list of appointments by date?","body":"<p>I'm returning a list of appointments.</p>\n\n<p>Right now they look like this:</p>\n\n<pre><code>-Jan 1\n--appointment @230\n-Jan 1\n--appointment @3\n-Jan 1\n--appointment @4\n-Jan 2\n--appointment @4\n-Jan 2\n--appointment @5\n</code></pre>\n\n<p>I'd like to return the list like</p>\n\n<pre><code>-Jan 1\n--appointment @230\n--appointment @3\n--appointment @4\n-Jan 2\n--appointment @4\n--appointment @5\n</code></pre>\n\n<p>The appointments have a \"start_at\" field which is a DateTime. Relatively simply. Jut not sure how to iterate over the collection and then grouping it in the sanest way.</p>\n\n<p>Thanks.</p>\n\n<p>User (is a user or a trainer)\nhas_many :appointments\nhas_many :trainer_appointments, :class_name => \"Appointment\", :foreign_key => \"trainer_id\"</p>\n\n<p>Appointment</p>\n\n<pre><code># Table name: appointments\n#\n#  id         :integer          not null, primary key\n#  trainer_id :integer\n#  start_at   :datetime\n#  created_at :datetime         not null\n#  updated_at :datetime         not null\n#  user_id    :integer\n</code></pre>\n\n<p>Here's some play code:\nu.trainer_appointments</p>\n\n<pre><code>=&gt; [#&lt;Appointment id: 6, trainer_id: 1, start_at: \"2012-11-18 13:08:00\", created_at: \"2012-10-17 02:01:42\", updated_at: \"2012-10-17 02:01:42\", user_id: 2&gt;, #&lt;Appointment id: 7, trainer_id: 1, start_at: \"2012-11-18 13:08:00\", created_at: \"2012-10-17 02:02:00\", updated_at: \"2012-10-17 02:02:00\", user_id: 2&gt;, #&lt;Appointment id: 8, trainer_id: 1, start_at: \"2012-11-24 13:08:00\", created_at: \"2012-10-17 02:03:28\", updated_at: \"2012-10-17 02:03:28\", user_id: 2&gt;] \n</code></pre>\n\n<p>Returns 3 appointments. Two are on the same day. 1 on a different day.</p>\n\n<p>Would like to return that in a way where it's grouped by a Date. \nI tried something like this to figure it out but got lost:</p>\n\n<pre><code>u.trainer_appointments.collect {|each| each.start_at}.uniq.collect {|each| u.trainer_appointments.find_by_start_at(each.to_date.beginning_of_day..each.to_date.end_of_day)}\n</code></pre>\n\n<p>Which returned two appointments. Between both dates. Missing the 2nd on the first day.</p>\n\n<p>I know that code is wrong on so many levels. I was just trying to toy with the iteration. Didn't get what I wanted though. Probably because the uniq limits the return size in some way even though I was expecting a range to be returned in the final array.</p>\n\n<p>I'm not sure what actual structure I need to iterate over the groupings. This isn't my expertise. An array inside an array grouped? How would I iterate over that in a view?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":17,"score":0,"question_id":12943327,"title":"A Dry way to share the users language with the model","body":"<p>I know, I know, sharing information about the user's session with the model is bad practice. I don't want to do it but what would be the dry-est way to inform models about a users language preference. The idea was to create a scope that would return items scoped to a language selection. It seems WET to write that scope in every data call. My models will always need this information, and if it can't find it in the session it would use the default language, or could take a parameter in the scope. I can't come up with a clean way to this other than change all the controllers, I am creating a translation gem and would like existing system to have to change as much code as possible.</p>\n\n<pre><code>default_scope lambda { where({:language_id =&gt; Language.default_or_first.id}) }\nscope :for_language_id, lambda { |language| where({:language_id =&gt; language}) }\n</code></pre>\n\n<p>Perhaps this something I can pass to the model in the controller but then I worried about race conditions and setting model class variables etc.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","json","caching"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":51,"score":1,"question_id":12868352,"title":"caches_page in rails, json format","body":"<p>I have an application that is setup to cache a json call. I've tried various code syntaxes and it seems to only cache correctly when I have the following:</p>\n\n<pre><code>    caches_page :index, :gzip =&gt; true\n    cache_sweeper :institutes_sweeper\n\n    respond_to :json, :js\n\n    def index\n      @institutes = Institute.select([:id, :name]).all\n      render :json =&gt; { :institutes =&gt; @institutes }\n    end\n</code></pre>\n\n<p>Now when this gets hit, it renders an html file and the caching works as expected. The Rails stack doesn't get hit.</p>\n\n<p>If I would throw a format block and have the render respond to json, the caching will create the files; however, it will create another file the next time around and ignore the file already there. </p>\n\n<p>Does apache have to be configured differently to work as expected?</p>\n\n<p>Also, I would like to use public/cache/ as the directory to store the cache. I have rails configured correctly; however, I was wondering how to configure apache to serve up those cached files (the same problem above happens where the files get created, but not served).</p>\n\n<p>Thanks for all your help! </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","irb","actionviewhelper"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12942836,"title":"Rails console (and irb) can't use text helpers","body":"<p>Probably something wrong with my setup:</p>\n\n<pre><code>irb(main):001:0&gt; truncate(\"Once upon a time in a world far far away\", :length =&gt; 17)\nNoMethodError: undefined method `truncate' for main:Object\n        from (irb):1\n        from /usr/lib64/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'\n        from /usr/lib64/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'\n        from /usr/lib64/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n        from script/rails:6:in `require'\n        from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>Looks like I cannot use any text helpers (both in irb and rails console).</p>\n\n<p>What should I check?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delete","dependencies","nested"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1336,"score":1,"question_id":5405884,"title":"How to define allow_destroy and :dependent => :destroy in Rails?","body":"<p>Given the following database model, <strong>how and where</strong> would you define the deletion relationships between the models? I figured out the basic table association setup but when I want to add dependencies to enable the <strong>deletion of nested objects</strong> I get lost.</p>\n\n<p><img src=\"http://i.stack.imgur.com/vxce7.png\" alt=\"Database relationship model\"></p>\n\n<p>Here is the relationship model I created.</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :studies\nend\n\nclass Study &lt; ActiveRecord::Base\n  has_many :internships\n  belongs_to :student, :class_name =&gt; \"User\", :foreign_key =&gt; \"user_id\"\n  belongs_to :subject\n  belongs_to :university, :class_name =&gt; \"Facility\", :foreign_key =&gt; \"facility_id\"\n  accepts_nested_attributes_for :subject, :university, :locations\nend\n\nclass Subject &lt; ActiveRecord::Base\n  has_many :studies\nend\n\nclass Internship &lt; ActiveRecord::Base\n  belongs_to :study\n  belongs_to :company, :class_name =&gt; \"Facility\", :foreign_key =&gt; 'facility_id'\n  accepts_nested_attributes_for :company, :study\nend\n\nclass Facility &lt; ActiveRecord::Base\n  has_many :internships\n  has_many :locations\n  has_many :studies\n  accepts_nested_attributes_for :locations\nend\n\nclass Location &lt; ActiveRecord::Base\n  belongs_to :facility\nend\n</code></pre>\n\n<p>Where would you put <code>:dependent =&gt; :destroy</code> and <code>:allow_destroy =&gt; true</code> to enable the following scenarios? I do not want to confuse you. Therefore, I leave out my tryings.</p>\n\n<p><strong>Internship scenario:</strong> A user wants to delete an internship.</p>\n\n<ul>\n<li>Its associated company (facility) can be deleted if the company is not related to another internship.</li>\n<li>If so, the locations of the associated company can be deleted.</li>\n<li>The related study will not be affected.</li>\n</ul>\n\n<p><strong>Study scenario</strong>: A user wants to delete a study.</p>\n\n<ul>\n<li>Its associated subject can be deleted if no other study refers to this subject.</li>\n<li>Its associated university (facility) can be deleted if no other study refers to this university.</li>\n<li>Its associated internships can be deleted. The company can only be deleted if no other internship refers to it.</li>\n</ul>\n\n<p>I am totally unsure whether I can add <code>:dependent =&gt; :destroy</code> only after <code>has_one</code> and <code>has_many</code> or also after <code>belongs_to</code>.</p>\n\n<hr>\n\n<p>Edit: To simplify the problem please stick to the following (reduced) example implementation.</p>\n\n<pre><code>class Study &lt; ActiveRecord::Base\n  belongs_to :subject\n  accepts_nested_attributes_for :subject, :allow_destroy =&gt; true\nend\n\nclass Subject &lt; ActiveRecord::Base\n  has_many :studies, :dependent =&gt; :destroy\nend\n</code></pre>\n\n<p>In my view I provide the following link.</p>\n\n<pre><code>&lt;%= link_to \"Destroy\", study, :method =&gt; :delete, :confirm =&gt; \"Are you sure?\" %&gt;\n</code></pre>\n\n<p>The path is based on the named routes given by a restful configuration in <code>routes.rb</code>.</p>\n\n<pre><code>resources :studies\nresources :subjects\n</code></pre>\n\n<p>The study will be deleted when I click the link - the subjects stays untouched. Why?</p>\n"},{"tags":["ruby-on-rails-3","popup","link-to"],"answer_count":4,"favorite_count":3,"up_vote_count":3,"down_vote_count":0,"view_count":4165,"score":3,"question_id":5208412,"title":"How to use the link_to helper to open a popup?","body":"<p>I just want to use <code>link_to</code> to open a popup. I tried something but it doesn't work:</p>\n\n<pre><code> &lt;%= link_to 'Create a new company',\n             new_company_path,\n             :popup =&gt; ['create_company', 'height=600, width=600'] %&gt; &lt;br/&gt;\n</code></pre>\n\n<p>Any idea?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","methods"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12940577,"title":"Find most recent donation excluding funds beginning with X","body":"<p>I'm trying to grab the gift date of the most recent donation (in $USD) to my organization that has a fund ID not beginning in X (those are Canadian donations).  Here's the code (in the controller) that I've used to pull out the gift date of the most recent overall donation, but it's a Canadian gift (fund_id = XP05).  How do I get the most recent donation with a fund ID not beginning with an X?</p>\n\n<pre><code>@income_batch = Gift.between(Date.today - 2.weeks, Date.today, :field =&gt; :gift_date).order('gift_date DESC').first.gift_date\n</code></pre>\n"},{"tags":["ruby-on-rails-3","postgresql","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":85,"score":2,"question_id":12737075,"title":"ActiveRecord/PostgreSQL - GROUP BY clause or be used in an aggregate function","body":"<p>I'm trying to do this <a href=\"http://railscasts.com/episodes/382-tagging\" rel=\"nofollow\">Railscast</a> on Tagging with my Rails 3.2 app on Postgres.  I have it working excepting for the tag cloud functionality.  However, I'm adding a layer by looking to form tag clouds based on tags an user created.</p>\n\n<p>I'm trying to adapt/revise the code from the Railscast:</p>\n\n<pre><code>def self.tag_counts\n  Tag.select(\"tags.*, count(taggings.tag_id) as count\").\n    joins(:taggings).group(\"taggings.tag_id\")\nend\n</code></pre>\n\n<p>but when I run this, I get the PG error:</p>\n\n<pre><code>PG::Error: ERROR:  column \"tags.id\" must appear in the GROUP BY clause or be used in an aggregate function\nLINE 1: SELECT tags.*, count(taggings.tag_id) a...\n</code></pre>\n\n<p>Here's how the models look:</p>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>has_many :trades\nhas_many :taggings, :through =&gt; :trades\nhas_many :tags, :through =&gt; :taggings\n</code></pre>\n\n<p><strong>trade.rb</strong></p>\n\n<pre><code>has_many :taggings\nhas_many :tags, :through =&gt; :taggings\n</code></pre>\n\n<p><strong>tagging.rb</strong></p>\n\n<pre><code>belongs_to :tag\nbelongs_to :trade\n</code></pre>\n\n<p><strong>tag.rb</strong></p>\n\n<pre><code>has_many :taggings\nhas_many :trades, through: :taggings\n</code></pre>\n\n<p>If someone could help lend a hand in revising the query to do a count on a user's tags that would be most appreciated.  Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12940124,"title":"In Rails, how can I take a GET string and parse it into an object?","body":"<p>I’m positive this is a dupe, but I couldn’t find the original.</p>\n\n<p>Given a GET-style string like <code>foo=bar&amp;x[0]=baz</code>, how can I decode this into a <code>params</code>-like array in a Rails app?</p>\n\n<hr>\n\n<p><strong>Updated to add</strong>: Note that <code>CGI.parse</code> seems to do much less than whatever magic Rails does:</p>\n\n<pre><code>1.9.3p194 :006 &gt; CGI::parse 'foo=bar&amp;x[foo][bar]=baz'\n =&gt; {\"foo\"=&gt;[\"bar\"], \"x[foo][bar]\"=&gt;[\"baz\"]} \n</code></pre>\n\n<p>CGI.parse didn’t unpack the nested objects into a mult-level hash. In Rails, at some level, this is actually examined.</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","simple-form"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":93,"score":0,"question_id":12926330,"title":"Searchable drop down list for rails 3.2.8?","body":"<p>On new order form, a user needs to select a customer from a drop down list which contains dozens of customers and is hard to find and select by scrolling up and down. That's why we want to build a searchable <code>drop down list</code>. When a user enter a few letters of customer's name, the drop down list filters out all others and is left with only the names of the customers containing the letters just keyed in. We are using <code>simple_form</code> and <code>rails 3.2.8</code>. One way we can do is to add a <code>text box</code> for entering search string and call <code>ajax</code> to load the drop down list accordingly. This requires additional text field which is redundant. Is there any solution which a user can directly type in drop down box and the list filters out accordingly? Thanks. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":2,"view_count":155,"score":0,"question_id":8024320,"title":"Which Ruby on Rails active record model method can be used to look for a particular value in the model's column?","body":"<p>Let's say I have a model, <code>Animal</code>, and a column, <code>animal_name</code>. When a user enter chicken, I want to check in the Animal model if there is <code>animal_name</code> \"chicken\". Assuming the <code>@animal</code> variable carries a value that user entered, how do I check that value exists in the <code>animal_name</code> column?</p>\n\n<pre><code>def check_animal\n    if @animal......... #Exists in Animal model\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","link-to"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12902769,"title":"link_to post ID in Rails","body":"<p>In my feed I have this:</p>\n\n<pre><code>&lt;span class=\"title\"&gt;&lt;strong&gt;&lt;%= link_to feed_item.title, @micropost %&gt;&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;\n</code></pre>\n\n<p>I cannot figure out how to make it link to the individual pages for posts.</p>\n\n<p>Right now it links to: <code>http://localhost:3000/microposts</code> and I get an error: <strong>No route matches [GET] \"/microposts\"</strong></p>\n\n<p>if I manually type the URL: <code>http://localhost:3000/microposts/25</code> I can see the indivual page for the post.</p>\n\n<p>This works fin linking to a user profile, but I can't get the link working to a micropost's page.\n&lt;%= link_to feed_item.user.name, feed_item.user %><br></p>\n\n<p>I'm new to rails and I'm trying to figure this out. Any help would be appreciated.</p>\n\n<p>microposts_controller.rb</p>\n\n<pre><code>class MicropostsController &lt; ApplicationController\n  before_filter :signed_in_user, only: [:create, :destroy]\n  before_filter :correct_user,   only: :destroy\n\n  def index\n  end\n\n  def show\n    @micropost = Micropost.find(params[:id])\n  end\n\n  def create\n    @micropost = current_user.microposts.build(params[:micropost])\n    if @micropost.save\n      flash[:success] = \"Micropost created!\"\n      redirect_to root_url\n    else\n      @feed_items = []\n      render 'static_pages/home'\n    end\n  end\n\n  def destroy\n    @micropost.destroy\n    redirect_to root_url\n  end\n\n  private\n\n  def correct_user\n    @micropost = current_user.microposts.find_by_id(params[:id])\n    redirect_to root_url if @micropost.nil?\n  end\nend\n</code></pre>\n\n<p>config/routes.rb</p>\n\n<pre><code>SampleApp::Application.routes.draw do\n  resources :users do\n    member do\n      get :following, :followers\n    end\n  end\n  resources :sessions, only: [:new, :create, :destroy]\n  resources :microposts, only: [:create, :destroy, :show]\n  resources :relationships, only: [:create, :destroy]\n\n  root to: 'static_pages#home'\n\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout', to: 'sessions#destroy', via: :delete\n\n  match '/help',    to: 'static_pages#help'\n  match '/about',   to: 'static_pages#about'\n  match '/contact', to: 'static_pages#contact'\nend\n</code></pre>\n\n<p>_feed_item.html.erb</p>\n\n<pre><code>&lt;li id=\"&lt;%= feed_item.id %&gt;\"&gt;\n  &lt;%= link_to gravatar_for(feed_item.user), feed_item.user %&gt;\n  &lt;span class=\"title\"&gt;&lt;strong&gt;&lt;%= link_to feed_item.title, micropost_path(@micropost) %&gt;&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;\n    &lt;span class=\"user\"&gt;\n      &lt;p&gt;&lt;small&gt;Created by: &lt;%= link_to feed_item.user.name, feed_item.user %&gt;&lt;br&gt;\n        &lt;%= feed_item.loc1T %&gt;&lt;br&gt;\n         &lt;%= feed_item.startTime.strftime('%A, %B %d, %Y') %&gt;&lt;/small&gt;&lt;/p&gt;\n    &lt;/span&gt;\n    &lt;span class=\"content\"&gt;&lt;%= feed_item.content %&gt;&lt;/span&gt;\n    &lt;span class=\"timestamp\"&gt;\n      Posted &lt;%= time_ago_in_words(feed_item.created_at) %&gt; ago.\n    &lt;/span&gt;\n  &lt;% if current_user?(feed_item.user) %&gt;\n    &lt;%= link_to \"delete\", feed_item, method: :delete,\n                                     data: { confirm: \"Are you sure?\" },\n                                     title: feed_item.content %&gt;\n  &lt;% end %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>feed.html.erb</p>\n\n<pre><code>&lt;% if @feed_items.any? %&gt;\n  &lt;ol class=\"microposts\"&gt;\n    &lt;%= render partial: 'shared/feed_item', collection: @feed_items %&gt;\n  &lt;/ol&gt;\n  &lt;%= will_paginate @feed_items %&gt;\n&lt;% end %&gt;`\n</code></pre>\n\n<p>static_pages_controller</p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\n  def home\n    if signed_in?\n      @micropost  = current_user.microposts.build\n      @feed_items = current_user.feed.paginate(page: params[:page])\n    end\n  end\n\n  def help\n  end\n\n  def about\n  end\n\n  def contact\n  end\nend\n</code></pre>\n"},{"tags":["html","ruby","string","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":3057,"score":5,"question_id":7414267,"title":"Strip html from string Ruby on Rails","body":"<p>Is there a way to strip html from a string using sanitize or equal method and keep only text inside value attribute on input tag?</p>\n"},{"tags":["ruby-on-rails-3","exception-handling","transactions"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12902053,"title":"Rails 3 Render In Rescue Block","body":"<p>I'm creating a series of objects on the fly using transaction and exception handling. Right now it handles the rollback and everything as expected but my rescue block doesn't attempt to render the action I tell it to.</p>\n\n<p>Here's my code that handles the transaction</p>\n\n<pre><code>def post_validation\n  ActiveRecord::Base.transaction do\n    begin\n      params[:users].each do |user|\n          #process each user and save here   \n      end \n      redirect_to root_path #success\n      rescue ActiveRecord::RecordInvalid\n      # something went wrong, roll back          \n      raise ActiveRecord::Rollback \n      flash[:error] = \"Please resolve any validation errors and re-submit\"          \n      render :action =&gt; \"validation\"          \n    end\n  end    \nend\n</code></pre>\n\n<p><strong>What's expected upon failure:</strong> Rolls back transaction and renders the action \"validation\". </p>\n\n<p><strong>What's happening upon failure:</strong> Rolls back transaction and attempts to render the view \"post_validation\" which doesn't exist.</p>\n"},{"tags":["ruby-on-rails-3","activerecord","infinite-loop","after-save"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12938565,"title":"Rails 3: Model After Filter causing infinite loop","body":"<p>I have the following After Filters:</p>\n\n<p>User Model:</p>\n\n<pre><code>  def check_for_custom_district\n    unless self.custom_district.blank?\n      district = District.new(:name =&gt; custom_district, :state_id =&gt; state_id, :school_type_id =&gt; school_type_id)\n\n      if district.save(false)\n        school = School.new(:name =&gt; custom_school, :state_id =&gt; state_id, :country_id =&gt; 1, :source =&gt; \"User\")\n        if school.save(false)\n          district.schools &lt;&lt; school\n          update_attribute(:school_id, school.id)\n        end\n      end\n    end\n  end\n\n  def check_for_custom_school\n    if self.custom_district.blank? and self.custom_school.present?\n      school = School.new(:name =&gt; custom_school, :state_id =&gt; state_id, :country_id =&gt; 1, :source =&gt; \"User\", :school_district_id =&gt; district_id)\n      school.save(false)\n      update_attribute(:school_id, school.id)\n    end\n  end\n</code></pre>\n\n<p>I ran some debugging to output the results to the console and the code is hitting the <code>check_for_custom_district</code> method and causing an infinite loop for some reason. Not sure how to stop this... any ideas?</p>\n"},{"tags":["ruby-on-rails-3","jquery-ajax","ujs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12939751,"title":"Rails 3 Trying to get select working using Ajax and UJS","body":"<p>First off, I've seen railscast 205 and I still cannot get my code to work.  FWIW I am using Rails 3.2.2.  Here is my index.html.erb</p>\n\n<pre><code>&lt;%= form_tag(\"lookup\", :method =&gt; \"get\", :remote =&gt; \"true\") do %&gt;\n  &lt;%= label_tag(:q, \"Pub Year :\") %&gt;\n  &lt;%= collection_select(:lookup, :pubyear, @pubyears, :pubyear, :pubyear) %&gt;\n  &lt;%= submit_tag(\"Search\") %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is the same file (index.html.erb) but below the form where I want to display the results</p>\n\n<pre><code>&lt;% if @lookuprows.present? %&gt;\n   &lt;div id=\"lkuptable\"&gt;\n   &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>In my application.js </p>\n\n<pre><code>//= require jquery\n//= require jquery_ujs\n//= require_tree\n</code></pre>\n\n<p>Here is my index method in the LookupController</p>\n\n<pre><code>@lookuprows = Lookup.return_rows(params[:lookup][:pubyear]) unless params[:lookup].nil?\n\nrespond_to do |format|\n   format.html\n   format.js\nend\n</code></pre>\n\n<p>My index.js.erb</p>\n\n<pre><code>$(\"#lkuptable\").html(\"&lt;%= escape_javascript(render 'lkupshow') %&gt;\");\n</code></pre>\n\n<p>My parial, _lkupshow.html.erb, that is being rendered above </p>\n\n<pre><code>&lt;table&gt;\n  &lt;% @lookuprows.each do |lkup| %&gt;\n    &lt;tbody&gt;\n      &lt;tr&gt;\n         &lt;td&gt;&lt;input type=\"text\" value=\"&lt;%= lkup.codetype %&gt;\" /&gt;&lt;/td&gt; \n         &lt;td&gt;&lt;input type=\"text\" value=\"&lt;%= lkup.codedesc %&gt;\" /&gt;&lt;/td&gt; \n         &lt;td&gt;&lt;input type=\"text\" value=\"&lt;%= lkup.parameters %&gt;\" /&gt;&lt;/td&gt; \n      &lt;/tr&gt;\n    &lt;/tbody&gt;\n  &lt;% end %&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I think I am really close because I do not get any errors.  Also, in the Firebug console I can see the results but they do not appear on the web page itself.  An aside, in the form can I specify the data to be sent as HTML?  Just wondering...Thanks for the help</p>\n"},{"tags":["ruby-on-rails-3","caching","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12147498,"title":"Key based cache expiration with Mongoid embedded documents","body":"<p>How would you set up a Russian doll like key based cache expiration with embedded documents?\nAs described by <a href=\"http://37signals.com/svn/posts/3112-how-basecamp-next-got-to-be-so-damn-fast-without-using-much-client-side-ui\" rel=\"nofollow\">37 signals</a></p>\n\n<p>I believe <code>touch</code> was added for <code>belongs_to</code> in Mongoid 3.0 but how would you deal with it for embedded documents?</p>\n\n<p>Example classes:</p>\n\n<pre><code>class House\n  embeds_many :persons\nend\n\nclass Person\n  embedded_in :house\nend\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;% cache ['v1', house] do %&gt;\n  &lt;%= house.some_attribute %&gt;\n  &lt;% house.persons.each |person| %&gt;\n    &lt;% cache ['v1' person] do %&gt; \n      &lt;%= render 'houses/person', person: person %&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;    \n</code></pre>\n\n<p>What would be the simplest way to generalize the touching? So that when I update a person, the house it's embedded in gets touched.</p>\n\n<p>EDIT: Or maybe the thinking here is that it's relatively cheap to re-render all the embedded items? Of course I could just do this:</p>\n\n<pre><code>class Person\n  after_save :touch_house\n  def touch_house\n    house.touch\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2703,"score":5,"question_id":7911014,"title":"ActiveRecord find and only return selected columns","body":"<p>I have a fairly large custom dataset that I'd like to return to be echoe'd out as json. One part is:  </p>\n\n<pre><code>l=Location.find(row.id)\ntmp[row.id]=l\n</code></pre>\n\n<p>but I'd like to do something like:  </p>\n\n<pre><code>l=Location.find(row.id).select(\"name, website, city\")\ntmp[row.id]=l\n</code></pre>\n\n<p>but this doesn't seem to be working. How would I get this to work?</p>\n\n<p>thx</p>\n\n<p><strong>edit 1</strong><br>\nalternatively, is there a way that I can pass an array of only the attributes I want included?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","json","api"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":145,"score":4,"question_id":12789525,"title":"Render Dynamic Variables in JSON Feed with Ruby on Rails","body":"<p>I'm just looking at creating an API for our customers to interact with our main Rails 3 application. </p>\n\n<p>For one part, I wanted the json response to contain some a form. Basically some form code that we control and appears on their site.</p>\n\n<p>I have this working ok (simplified):</p>\n\n<pre><code>def login_form\n  @response = Form.find_by_something(params[:something_else])\n  if @response \n    render :status=&gt;200, :json=&gt;{:response =&gt; @response} \n  end\nend\n</code></pre>\n\n<p>And on the client side, I can fetch:</p>\n\n<pre><code>@logins = HTTParty.get(\"#{set_auth_url}/api/v1/logins.json?auth_token=xyz&amp;something_else=abc\").parsed_response\n</code></pre>\n\n<p>And display the form</p>\n\n<pre><code>= @logins[\"response\"].html_safe\n</code></pre>\n\n<p>The problem is, the form code has some dynamic variables:</p>\n\n<p>For example:</p>\n\n<pre><code>&lt;div class=\"login\"&gt;\n  &lt;FORM name=\"form1\" METHOD=\"get\" action=\"&lt;%= request.path %&gt;?\"&gt;\n  &lt;INPUT TYPE=\"HIDDEN\" NAME=\"chal\" VALUE=\"&lt;%= params['challenge'] %&gt;\"&gt;\n  &lt;% if @current_location['success_url'] %&gt;\n    &lt;INPUT TYPE=\"HIDDEN\" NAME=\"userurl\" VALUE=\"/success\"&gt;\n  &lt;% end %&gt;\n  &lt;input type=\"hidden\" name=\"UserName\" placeholder=\"Username\" value=\"&lt;%= @user['username']['username'] %&gt;\"&gt;\n  &lt;input type=\"submit\" name=\"login\" value=\"Login\" class=\"btn\"&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>I'm wondering if this is a good idea? And if so, how can I break those variables out in the html??</p>\n\n<p>If it's not, could someone recommend a nicer way to go about it.</p>\n"},{"tags":["ruby-on-rails-3","slim-lang"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":11766813,"title":"Rails field_error_proc - Change default error target","body":"<p>I have the following desired html (slim template):</p>\n\n<pre><code>li\n    label\n        span\n            | Password\n            small.error ERROR MESSAGE\n        br\n        = f.password_field :password\n</code></pre>\n\n<p><strong>I wanna put the error (small.error) within the \"span\" above.</strong></p>\n\n<p>My solution (so far) is:</p>\n\n<pre><code>ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|\n    if instance.error_message.kind_of?(Array)\n        %(#{html_tag}&lt;small class=\"error\"&gt;\n        #{instance.error_message.join(',')}&lt;/small&gt;).html_safe\n    else\n        %(#{html_tag}&lt;small class=\"error\"&gt;\n        #{instance.error_message}&lt;/small&gt;).html_safe\n    end\nend\n</code></pre>\n\n<p>But in this fashion the small tag has been placed right under the input tag.</p>\n\n<p>Could I change that target location?</p>\n"},{"tags":["ruby-on-rails-3","github","slim-lang"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":145,"score":0,"question_id":7901524,"title":"GitHub shows incorrect tab/space formatting for Rails Slim views/template","body":"<p>I have a rails 3.1 app and I am using Slim template for views. I noticed that code on GitHub dot com does not show the correct tab/spacing for my slim templates. Even the raw format shows incorrect  tabbing. However when I do a copy of the code from both raw and normal github code view and paste it to a file, it retains the correct tabbing. Any clue why this could be happening?</p>\n\n<p>This problem is only for *.slim templates, rest of the code shows up fine on github.</p>\n\n<p>Here's what I have -</p>\n\n<ul>\n<li>TextMate as the editor</li>\n<li>using \"Ruby Slim\" TextMate bundle</li>\n<li>tab spacing = 2 spaces</li>\n</ul>\n\n<p>I thought of putting this here instead of GitHub support, because I saw some public repos /rails app on GitHub with slim templates and there the tabbing was alright. So I wanted to know if theres something that I need to fix on my side.</p>\n"},{"tags":["ruby-on-rails-3","slim-lang"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":86,"score":0,"question_id":11385684,"title":"Why doesn't my partial work with slim and Rails 3.2?","body":"<p>I'm using Rails 3.2 and instead of ERB, I am using <code>slim</code>.</p>\n\n<p>Here is my form partial:</p>\n\n<pre><code>= simple_form_for @game, :html =&gt; { :class =&gt; 'form-horizontal' } do |f|\n</code></pre>\n\n<p>The syntax error I am getting is:</p>\n\n<pre><code>_form.html.slim:1: syntax error, unexpected ')' ... =&gt; 'form-horizontal' } do |f|))).to_s)); \n</code></pre>\n\n<p>But I don't know where it expects to put the ')'?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","slim-lang"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":326,"score":0,"question_id":7372293,"title":"How to use Slim inside assets? with Rails 3.1","body":"<p>I'm trying to use Slim template inside assets.</p>\n\n<p>I placed slim file in /app/assets/template/test.html.slim</p>\n\n<p>and when I access /assets/test.html it say </p>\n\n<p>\"No route matches [GET] \"/assets/login.html\"</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","slim-lang"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":116,"score":0,"question_id":12061678,"title":"Slim Syntax for Inline Div/Table Classes with Embedded Ruby","body":"<p>I have a table defined in slim:</p>\n\n<pre><code> table\n    tr\n       td\n          =_(\"Some Content\")\n       td\n          =_(\"Some Content\")\n</code></pre>\n\n<p>I would like to add some classes to certain td tags. I can do so like this:</p>\n\n<pre><code> table\n    tr\n       td.extraclass\n          =_(\"Some Content\")\n       td\n          =_(\"Some Content\")\n</code></pre>\n\n<p>This adds \"extraclass\" to that td:</p>\n\n<pre><code> &lt;td class=\"extraclass\"&gt; Some Content &lt;/td&gt;\n</code></pre>\n\n<p>How can I add a class by embedding some rails/ruby into this? In normal rails I could do:</p>\n\n<pre><code> &lt;td class=\"&lt;%=@article.attribute%&gt;\"&gt;\n</code></pre>\n\n<p>How do I do this here? I don't think I can do:</p>\n\n<pre><code>        td.=_(@article.attribute)\n</code></pre>\n\n<p>But I would like to add classes in some similar way here. Anybody have any advice? if I have not been clear in what I'm attempting to do, please let me know what I can add.</p>\n"},{"tags":["html","css","ruby-on-rails","ruby-on-rails-3","slim-lang"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":77,"score":1,"question_id":12851843,"title":"Ruby Slim - How do you define an element's class with a rails helper or variable?","body":"<p>In rails slim (http://slim-lang.com/) the syntax for defining a new div with a class name \"sample\" is the following:</p>\n\n<pre><code> .sample\n      = \"Content goes here\"\n</code></pre>\n\n<p>this will create:</p>\n\n<pre><code> &lt;div class=\"sample\"&gt;\n      Content goes here\n &lt;/div&gt;\n</code></pre>\n\n<p>I want to define a div's class according to a rail's helper, a variable, or other things.. such as, in rails:</p>\n\n<pre><code> &lt;div class=\"sample #{@variable.name}\"&gt;\n   Content goes here\n &lt;/div&gt;\n</code></pre>\n\n<p>I have no idea how to do this in slim:</p>\n\n<pre><code> .sample #what else goes here?\n   Content goes here\n</code></pre>\n\n<p>Anyone know how?</p>\n"},{"tags":["javascript","ruby-on-rails-3","parsing","jeditable","slim-lang"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":195,"score":1,"question_id":9858299,"title":"slim file is not executing the js inside it","body":"<p>i am using gem 'jeditable-rails' in my rails 3.2 application for inplace editting\nIn my controller, i have </p>\n\n<pre><code>def update\n@article = Article.find(params[:id])\n@article.update_attributes(params[:article])\nrender :layout =&gt; false if request.xhr?\nend\n</code></pre>\n\n<p>ANd in my articles/update.js.slim</p>\n\n<p>i have </p>\n\n<pre><code>- unless @article.errors.empty?\n  | $(\"#error_msg\").html(@article.errors);\n- else\n  | $(\"#success_msg\").html(\"updated successfully\");\n</code></pre>\n\n<p>But when i do an update it updates and going to the js file and renders it like as it is.\nlike <code>$(\"#error_msg\").html(@comment.errors);</code> is printed as such or <code>$(\"#success_msg\").html(\"updated successfully\")</code></p>\n\n<p>EDIT :</p>\n\n<p>i am using the jeditable plugin for edit in place for my article title alone. It updates the article title and renders the js file as it is</p>\n\n<p>the response which i got here is json. how to resolve this. GIve  suggestions</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","coffeescript","haml","slim-lang"],"answer_count":4,"favorite_count":8,"up_vote_count":11,"down_vote_count":0,"view_count":4968,"score":11,"question_id":8108511,"title":"How to access instance variables in CoffeeScript engine inside a Slim template","body":"<p>I have a Rails controller in which I am setting a instance variable -</p>\n\n<pre><code>@user_name = \"Some Username\"\n</code></pre>\n\n<p>In my .slim template I am using coffee engine to generate javascript and want to print out the user name from client-sie javascript code -</p>\n\n<pre><code>coffee:\n  $(document).ready -&gt;\n    name = \"#{@user_name}\"\n    alert name\n</code></pre>\n\n<p>But this is the javascript that is being generated??</p>\n\n<pre><code>$(document).ready(function() {\n    var name;\n    name = \"\" + this.my_name;\n    alert(name);\n}\n</code></pre>\n\n<p><strong>How do I access controller instance variables in my CoffeeScript code??</strong></p>\n\n<p>I am tagging this as haml since I am guessing haml will have the same issue when using CoffeeScript .</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","slim-lang"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":202,"score":1,"question_id":7888258,"title":"Does Ruby/Slim have support for markdown?","body":"<p>I cant get markdown to work with Slim (Rails 3.1 app), I get this error:</p>\n\n<pre><code>Unknown line indicator\n   :markdown\n</code></pre>\n\n<p>I have the following gems in my Gemfile:</p>\n\n<pre><code>gem 'bluecloth'\ngem 'rdiscount'\ngem 'slim'\n</code></pre>\n\n<p>This is how my template looks like:</p>\n\n<pre><code>:markdown\n  #hello\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2","mechanize"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12935691,"title":"Rails: printing a list to a view using Mechanize","body":"<p>Hopefully this is a basic rails question. I'm just learning the broad strokes. </p>\n\n<p>I am using rails 3.2.8 with Mechanize 2.5.1 to screen scrape and I'm using Mechanize's basic tutorial model for scraping Google.com (here: <a href=\"http://mechanize.rubyforge.org/GUIDE_rdoc.html\" rel=\"nofollow\">http://mechanize.rubyforge.org/GUIDE_rdoc.html</a> ). In the console it works like a charm. I get the full list of google page links. Now I want that list on my web page. The way I'm hacking on it, my instance variable either prints the first or last link only because its ether just running for one link, or being re-assigned each run (if I understand correctly). I am not currently using a model b/c it not hitting my db (is that wrong?). Only the controller and view with the route...</p>\n\n<p>\"views/listing/results.html.erb\" includes:</p>\n\n<pre><code>&lt;ul&gt;\n&lt;li&gt;&lt;%= link_to @listings %&gt;&lt;/li&gt;\n&lt;/ul&gt; \n</code></pre>\n\n<p>\"controllers/listing_controller.rb\" has only:</p>\n\n<pre><code>class ListingController &lt; ApplicationController \n  def results\n    require 'rubygems'\n    require 'mechanize'\n    agent = Mechanize.new\n    page = agent.get('http://google.com')\n    page.links.each do |link| # for each link print out the link.\n      puts link.text\n      @listings = link.text # this is getting re-assigned each time so ends up as last one\n      # return @listings # returns first item on list \n    end\n  end\nend\n</code></pre>\n\n<p>\"config/routes.rb\" file includes:</p>\n\n<pre><code>match '/listing/results' =&gt; 'listing#results', :as =&gt; 'listing_button'\n</code></pre>\n\n<p>I know there's a way to do this but I must be searching in all the wrong places for an answer. I've tried several different scenarios with assigning the instance variable but maybe I'm doing this all wrong, I donno.</p>\n\n<p>Thanks</p>\n\n<p>Mike</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3","activerecord","amazon-rds"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":91,"score":3,"question_id":12904829,"title":"SQL Insert committed but not found on next request?","body":"<p>I have placed an after_commit callback in the RequestToken model that outputs \"Committed Request Token xx\". You can see in the log I included below, that the token record is committed and the next request the lookup on the object says it cannot be found. The issue occurs intermittently and if I refresh the page the record is found and the request goes through.</p>\n\n<p><strong>Environment</strong>\nAWS EC2 + RDS, Ubuntu 10.04, Rails 3.2.8, MySQL2 0.3.11 gem, apache2 2.2.14, phusion passenger 3.0.11</p>\n\n<p>Has anyone seen this before? Any suggestions?</p>\n\n<pre><code>Committed Request Token S8j311QckvEjnDftNW0e7FPHsavGWTelONcsE3X1\n  Rendered text template (0.0ms)\nCompleted 200 OK in 28ms (Views: 0.6ms | ActiveRecord: 21.8ms | Sphinx: 0.0ms)\n\nStarted GET \"/oauth/authorize?oauth_token=S8j311QckvEjnDftNW0e7FPHsavGWTelONcsE3X1\" for 96.236.148.63 at 2012-10-15 22:07:32 +0000\nProcessing by OauthController#authorize as HTML\n  Parameters: {\"oauth_token\"=&gt;\"S8j311QckvEjnDftNW0e7FPHsavGWTelONcsE3X1\"}\nCompleted 500 Internal Server Error in 5ms\n\nActiveRecord::RecordNotFound (Couldn't find RequestToken with token = S8j311QckvEjnDftNW0e7FPHsavGWTelONcsE3X1):\n</code></pre>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":131,"score":2,"question_id":12876875,"title":"Rails 3.2 :remote => true, Bind to After Submit","body":"<p>I have a form field that I would like to empty immediately the submit.  Usually I would do something like:</p>\n\n<pre><code>$(\"#form\").submit(function(e){\n  e.preventDefault();\n  $.post(/* custom craft request */);\n  $(\"#field\").val('');\n});\n</code></pre>\n\n<p>Rails handles all the custom crafting when I add the <code>:remote =&gt; true</code>, but I can't find a way to bind to immediately after the submission.</p>\n\n<p>The documentation ( <a href=\"http://guides.rubyonrails.org/ajax_on_rails.html\" rel=\"nofollow\">http://guides.rubyonrails.org/ajax_on_rails.html</a> ) insists there's an ajax:after event, but that doesn't seem to exist.  Apparently this documentation is completely outdated, since other functions like remote_form_for don't exist in 3.2</p>\n\n<p>Any help is appreciated.  The setTimeout I'm using really doesn't sit well.</p>\n\n<p>EDIT: Adding the working setTimeout solution that I want to replace:</p>\n\n<pre><code>$(\"#form_id\").submit(function(e){\n    setTimeout(function(){ \n        //this will happen after submission     \n    }, 15);\n});\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","mongoid"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12937547,"title":"object with latest date mongoid","body":"<p>I have 2 objects with <code>created_at</code> attribute.</p>\n\n<p>I want to know the query with Which of these two objects is the most recent date</p>\n\n<p>object 1:</p>\n\n<pre><code>#&lt;User _id: 504726081d41c809e5000003, _type: \"User\", created_at: 2012-09-05 10:14:33 UTC &gt;\n</code></pre>\n\n<p>object 2:</p>\n\n<pre><code>#&lt;User _id: 503fb40f1d41c8255a000007, _type: \"User\", created_at: 2012-08-30 18:42:24 UTC &gt;\n</code></pre>\n\n<h2>Edited</h2>\n\n<p><strong>This 2 object are inside array: something like:</strong></p>\n\n<pre><code> [#&lt;User _id: 504726081d41c809e5000003, _type: \"User\", created_at: 2012-09-05 10:14:33&gt;, #&lt;User _id: 503fb40f1d41c8255a000007, _type: \"User\", created_at: 2012-08-30 18:42:24&gt;]\n</code></pre>\n\n<p><strong>I can not use <code>.last</code>. I need use lastest date.</strong></p>\n\n<p>Thank you very much</p>\n"},{"tags":["ruby-on-rails-3","amazon-ec2","jruby","trinidad-gem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":216,"score":1,"question_id":8872378,"title":"Creating a production Rails Server on Amazon AWS","body":"<p><strong>This is some background to my problem...</strong></p>\n\n<p>I have been using 3rd Party as a platform to host my rails application, and its great. So easy to get started and leverage the full power of AWS!</p>\n\n<p>However for some of the tasks I wanted to do there were conflicts with gems / server / ruby versions that I could control locally through development, but never worked on my 3rd Party as there is a certain amount control over the environments you can't change. Which means its a stable platform but you can't really go outside the box. I am using Trinidad / Jruby which has great performance advantages! </p>\n\n<p><strong>This is what I am doing</strong></p>\n\n<p>So I decided to launch my own EC2 instance. This is going really well. However I am interested in knowing what everyone would do in terms of deployment. At the moment I am downloading the git into the EC2 server and running rails from command. Ideally I would like rails to run in the background, and launch at start up. </p>\n\n<p><strong>Question</strong></p>\n\n<p>How would you configure the EC2 instance to be a full on production server and not just a server run from command through SSH. Is there anyway to set up your own deploy tool for example?</p>\n\n<p>Thanks</p>\n\n<p>Charlie</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","authentication","architecture"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12937116,"title":"Ruby on Rails application/REST API authentication architecture","body":"<p>I'm going to develop a Ruby on Rails application (basically a back-office) which at the same time will serve data for an Android mobile app via the REST interface Rails provides.\nMy concerns here are the following: how should I manage and structure my ROR application so that REST calls from Android are authenticated with an API Key + user ID (I was also thinking in using OAuth) and, on the other side, users can interact with via back-office.\nShould I use for example different controllers for the same resources (thus, increasing complexity) for BO accesses and Mobile client accesses (so I can implement different auth logic)?\nIs there any standard/common way (aka gem) to manage and implement this behavior?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails-3","email","parameters","get","tld"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":16,"score":0,"question_id":12936284,"title":"Rails 3: GET request with email crops off TLD","body":"<p>I am trying to use a controller and action to do a simple check to see if a user account with that email address exists or not.</p>\n\n<p>The controller's action looks like this:</p>\n\n<pre><code>def checkEmail\n    email = params[\"email\"]\n    if Account.find_by_email(email).blank?\n      render :inline=&gt;\"true\"\n    else\n      render :inline=&gt;\"false\"\n    end\n  end\n</code></pre>\n\n<p>And to test this action, I can go to:</p>\n\n<pre><code>http://localhost:3000/home/checkEmail/email@website.com\n</code></pre>\n\n<p>When I do so, I can see in the Ruby console the following being queried:</p>\n\n<pre><code>Parameters: {\"email\"=&gt;\"email@website\"}\n  Account Load (0.0ms)  SELECT `accounts`.* FROM `accounts` WHERE `accounts`.`email` = 'email@website' LIMIT 1\n</code></pre>\n\n<p>You can see that the TLD of the email address has been cropped off.</p>\n\n<p>However, when I go to:</p>\n\n<pre><code>http://localhost:3000/home/checkEmail/email@website.co.uk\n</code></pre>\n\n<p>I get a routing error:</p>\n\n<pre><code>No route matches [GET] \"/home/checkEmail/email@website.co.uk\"\n</code></pre>\n\n<p>My routes.rb file looks like this:</p>\n\n<pre><code>Gallery::Application.routes.draw do\n\n  #Match home URL\n  match 'home(/:file)' =&gt; \"home#index\"\n  match 'home/checkUser/:username' =&gt; \"home#checkUser\"\n  match 'home/checkEmail/:email' =&gt; \"home#checkEmail\"\n\n  root :to=&gt; \"home#index\"\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","capistrano","rack"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":102,"score":0,"question_id":11598645,"title":"rackup server with ability to stop and restart","body":"<p>i'm planning to add some tasks to my capistrano recipes file to give ability for admins to remote start/stop/restart <a href=\"https://github.com/ryanb/private_pub\" rel=\"nofollow\">private_pub</a> server. But if for start i can use something like</p>\n\n<pre><code>  desc \"Start private_pub server\"\n  task :start do\n    run \"cd #{current_path};rackup private_pub.ru -s thin -E production -D\"\n  end\n</code></pre>\n\n<p>i cannot find any documentation how to stop or restart rackup server. i see option </p>\n\n<pre><code>  -P, --pid FILE           file to store PID (default: rack.pid)\n</code></pre>\n\n<p>but maybe use kill command to stop server - not good idea?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12935800,"title":"what is the difference between these validations with conditions?","body":"<p>I've seen some different styles of validation and I wonder what are the differences between them? Which one is recommended and why?</p>\n\n<pre><code># 1.\nvalidates :name, :presence =&gt; true, :if =&gt; -&gt; { self.must_validate_name? }\n\n# 2.\nvalidates :name, :presence =&gt; true, :if =&gt; -&gt;(record) { record.must_validate_name? }\n\n# 3.\nvalidate  :name, :presence =&gt; true, :if =&gt; :must_validate_name?\n</code></pre>\n"},{"tags":["ruby-on-rails-3","integration-testing","rspec2","capybara"],"answer_count":4,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":1787,"score":4,"question_id":8801845,"title":"How to make Capybara check for visibility after some JS has run?","body":"<p>After loading a page I have code that runs and hides and shows various items based on data returned by an xhr.</p>\n\n<p>My integration test looks something like this:</p>\n\n<pre><code>it \"should not show the blah\" do\n    page.find('#blah').visible?.should be_true\nend \n</code></pre>\n\n<p>When I manually go to the page in the context this test runs, #blah is <em>not</em> visible as I expect. I suspect that Capybara is looking at the initial state of the page (invisible in this case), evaluating the state of the DOM and failing the test before the JS runs. </p>\n\n<p>Yes, I set the :js => true on the containing describe block :)</p>\n\n<p>Any ideas would be greatly appreciated! I'm hoping I don't have to put an intentional delay in here, that feels flaky and will slow things down.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12935228,"title":"how to find the value by param id in View?","body":"<p>I have a field in the View like,</p>\n\n<pre><code>&lt;%= f.text_field :question_id, class: \"cross-reference-question-value\"  %&gt;\n</code></pre>\n\n<p>Now, I tried to use this <code>question_id</code> that match the other column from the same table like the following:</p>\n\n<pre><code>&lt;%= text_field :question_id, Question2009.all.map{|an| [an.answer_table]} %&gt;\n</code></pre>\n\n<p>I could get all the values here from that table. But, I just need to get the value that match the <code>params</code> of <code>question_id</code>. </p>\n"},{"tags":["mysql","sql","ruby-on-rails-3","postgresql","database-design"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":69,"score":2,"question_id":12934611,"title":"SELECT multiple single (LIMIT 1) records based on a variable condition","body":"<p>I have two tables, <code>charts</code> and <code>chart_entries</code> and I want to get the current top 5 chart positions (based on selecting the latest <code>chart_entries</code> at a given position).</p>\n\n<p>Is there a way of making this a single query? Ideally my charts will have anything up to 500 positions so it's not really feasible to have multiple queries like this.</p>\n\n<p>In rails I'm currently using this method in <code>Chart.rb</code></p>\n\n<pre><code>def table\n  (1..5).each do |i|\n    chart_entries.where(position: i).order('entered_at DESC').first\n  end\nend\n</code></pre>\n\n<p>to generate the following SQL</p>\n\n<pre><code>SELECT \"chart_entries\".* FROM \"chart_entries\" WHERE \"chart_entries\".\"chart_id\" = 1 AND \"chart_entries\".\"position\" = 1 ORDER BY entered_at DESC LIMIT 1\nSELECT \"chart_entries\".* FROM \"chart_entries\" WHERE \"chart_entries\".\"chart_id\" = 1 AND \"chart_entries\".\"position\" = 2 ORDER BY entered_at DESC LIMIT 1\nSELECT \"chart_entries\".* FROM \"chart_entries\" WHERE \"chart_entries\".\"chart_id\" = 1 AND \"chart_entries\".\"position\" = 3 ORDER BY entered_at DESC LIMIT 1\nSELECT \"chart_entries\".* FROM \"chart_entries\" WHERE \"chart_entries\".\"chart_id\" = 1 AND \"chart_entries\".\"position\" = 4 ORDER BY entered_at DESC LIMIT 1\nSELECT \"chart_entries\".* FROM \"chart_entries\" WHERE \"chart_entries\".\"chart_id\" = 1 AND \"chart_entries\".\"position\" = 5 ORDER BY entered_at DESC LIMIT 1\n</code></pre>\n\n<p>This is the table structure (postgresql)</p>\n\n<pre><code>CREATE TABLE chart_entries (\n  id integer NOT NULL,\n  chart_id integer,\n  entity_id integer,\n  \"position\" integer,\n  entered_at timestamp without time zone,\n  locale character varying(255)\n);\n\nCREATE TABLE charts (\n  id integer NOT NULL,\n  name character varying(255)\n);\n</code></pre>\n\n<p>This was my final solution</p>\n\n<pre><code>chart_entries.where(position: [1..5]).group('position, id').having('entered_at = MAX(entered_at)').order('position ASC')\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","hash"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12934152,"title":"undefined method [] for nil:NilClass in ruby hash","body":"<p>I have an hash consisting of:</p>\n\n<pre><code>flow = [\"a\", \"b\", \"c\"]\nh = [{\"case_id\"=&gt;1, \"a\"=&gt;{\"x\"=&gt;\"text\", \"option\"=&gt;\"...\" },\"b\"=&gt;{\"report\"=&gt;\"text\", \"option\"=&gt;\"...\" } ,\"c\"=&gt;{\"y\"=&gt;\"text\", \"option\"=&gt;\"...\" }},{\"case_id\"=&gt;2, \"a\"=&gt;{\"x\"=&gt;\"text\", \"option\"=&gt;\"...\" },\"b\"=&gt;{\"report\"=&gt;\"text\", \"option\"=&gt;\"...\" } ,\"c\"=&gt;{\"y\"=&gt;\"text\", \"option\"=&gt;\"...\" }}]\n@case = 0\n@report = \"\"\nflow.each do |step|\n  if h[@case][step]['report']\n    @report = h[@case][step]['report']\n  end\nend\n</code></pre>\n\n<p>the console gives me the following error:</p>\n\n<pre><code>NoMethodError in MainController#index\nundefined method `[]' for nil:NilClass\n</code></pre>\n\n<p>Why?! In a previous program, but using ruby 187, gave no problem. But now, with ruby ​​193, gives this error.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12934533,"title":"How we can upload Large file in chunks in rails?","body":"<p>I am trying to upload a zip file of 350mb -  500mb to server. It gives \"ENOSPC\" error. \nIs it possible to upload file in chunks and receive it on server as one file ? \nor \nUse custom location for tmpfs, so that it will be independent of system tmp, because in my case tmp is of 128MB only.</p>\n"},{"tags":["ruby-on-rails-3","devise","omniauth","twitter-oauth"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12932470,"title":"authenticating with auth-twitter","body":"<p>I am working on a rails 3 app. Here I am using omniauth for authentication. \nI followed the document <a href=\"https://github.com/plataformatec/devise/wiki/OmniAuth%3A-Overview\" rel=\"nofollow\">https://github.com/plataformatec/devise/wiki/OmniAuth%3A-Overview</a> . And The authentication for facebook and twitter went well. Then I tried to authenticate through twitter. Set a callback URL as \"http://127.0.0.1:3000/auth/twitter/callback\" in twitter app. While clicking on the link it is going to the API sign in page. After giving the data and click on sign in not showing any type of error. But the user is not added and not going to the user signed in page. It going to the device sign up page. </p>\n\n<p>Please any one can tell the problem or what I did wrong.</p>\n\n<p>Thanks \nRegards.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":24,"score":1,"question_id":12934846,"title":"i can't rails s with redis-store","body":"<p>my rails is 3.2.8</p>\n\n<p>i have gem like below</p>\n\n<pre><code>#gemfile\ngem 'redis', '3.0.2'\ngem 'redis-store', '1.1.3'\ngem 'redis-rails'\n\n#session_store.rb\nApplication.config.session_store :redis_session_store\n</code></pre>\n\n<p>then rails s</p>\n\n<p>it report error like below</p>\n\n<pre><code>=&gt; Booting Thin\n=&gt; Rails 3.2.8 application starting in development on http://0.0.0.0:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\nExiting\n/Users/magicstudio/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/application/configuration.rb:140:in `const_get': uninitialized constant ActionDispatch::Session::RedisSessionStore (NameError)\n    from /Users/magicstudio/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/application/configuration.rb:140:in `session_store'\n</code></pre>\n\n<p>why?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12933502,"title":"modifying ransack gem","body":"<p>I am using \"Ransack gem\". but i want to modify it. so i am copy ransack gem folder from c drive to vendor/plugins/static_gem folder and try to edit it but when i starts server it gives me error as </p>\n\n<pre><code>    D:/Shrikant/Ruby Projects/fIT_Arms/vendor/static_gem/ransack-0.7.0/ransack.gemsp\n     ec:25:in ``': No such file or directory - git ls-files (Errno::ENOENT)\n     from D:/Shrikant/Ruby Projects/fIT_Arms/vendor/static_gem/ransack-0.7.0/\n     ransack.gemspec:25:in `block in &lt;main&gt;'\n\n\n          from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:1368:\n    in `initialize'\n            from D:/Shrikant/Ruby Projects/fIT_Arms/vendor/static_gem/ransack-0.7.0/\n    ransac\n\nk.gemspec:5:in `new'\n        from D:/Shrikant/Ruby Projects/fIT_Arms/vendor/static_gem/ransack-0.7.0/\nransack.gemspec:5:in `&lt;main&gt;'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:28\n0:in `eval'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:28\n0:in `rescue in block in load_gemspec'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:27\n5:in `block in load_gemspec'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:27\n3:in `chdir'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:27\n3:in `load_gemspec'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/sourc\ne.rb:340:in `block in load_spec_files'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/sourc\ne.rb:339:in `each'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/sourc\ne.rb:339:in `load_spec_files'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/sourc\ne.rb:372:in `local_specs'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:430:in `block in converge_locked_specs'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:419:in `each'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:419:in `converge_locked_specs'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:180:in `resolve'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:127:in `specs'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:172:in `specs_for'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/defin\nition.rb:161:in `requested_specs'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/envir\nonment.rb:23:in `requested_specs'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/runti\nme.rb:11:in `setup'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler.rb:10\n7:in `setup'\n        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.1.5/lib/bundler/setup\n.rb:7:in `&lt;top (required)&gt;'\n        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:i\nn `require'\n        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:60:i\nn `rescue in require'\n        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:35:i\nn `require'\n        from D:/Shrikant/Ruby Projects/fIT_Arms/config/boot.rb:6:in `&lt;top (requi\nred)&gt;'\n        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:i\nn `require'\n        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:i\nn `require'\n        from script/rails:5:in `&lt;main&gt;'\n</code></pre>\n\n<p>it gives me error at lines</p>\n\n<pre><code>s.files         = `git ls-files`.split(\"\\n\")\n  s.test_files    = `git ls-files -- {test,spec,features}/*`.split(\"\\n\")\n  s.executables   = `git ls-files -- bin/*`.split(\"\\n\").map{ |f| File.basename(f) }\n  s.require_paths = [\"lib\"]\n</code></pre>\n\n<p>what can i do .</p>\n"},{"tags":["ruby","ruby-on-rails-3","haml"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12915652,"title":"object.new_record? in fields_for is rendering HTML","body":"<p>This is a Rails 3 application with HAML.\nI have the following:</p>\n\n<pre><code>= f.fields_for :bar_memberships do |bar_membership_fields|\n  = 'FIELD'\n</code></pre>\n\n<p>I have encapsulated the problem. This code prints:\nFIELD \nFIELD\nFIELD\nas expected.</p>\n\n<p>But the following code:</p>\n\n<pre><code>= f.fields_for :bar_memberships do |bar_membership_fields|\n  - if bar_membership_fields.object.new_record?\n    = 'FIELD'\n</code></pre>\n\n<p>Shows a lot of hidden inputs, and shows them as strings in the HTML!</p>\n\n<pre><code>'&lt;input id=\"person_bar_memberships_attributes_0_id\" name=\"person[bar_memberships_attributes][0][id]\" type=\"hidden\" value=\"824\" /&gt;\n&lt;input id=\"person_bar_memberships_attributes_1_id\" name=\"person[bar_memberships_attributes][1][id]\" type=\"hidden\" value=\"825\" /&gt;'\nFIELD\n</code></pre>\n\n<p>Any idea?</p>\n"},{"tags":["ruby-on-rails-3","form-helpers"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":110,"score":0,"question_id":10449101,"title":"Rails: Adding options to collection_select","body":"<p>I am using a collection_select field, but need to prepend the options with some default one, wich does not represent a particular model record and is used to set the appropriet field to NULL. But I just can't find any way to do that.</p>\n\n<p>If you need any more information, don't hasitate to ask.\nUsing Rails 3.2.3 with standard form helpers.</p>\n\n<p>P.S. I know I can do something like this:</p>\n\n<pre><code>@parents = ['default_name','nil']\n@parents &lt;&lt; Model.all.map {|item| [item.name,item.id]}\n</code></pre>\n\n<p>But I think there is a more elegant way.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","geolocation","gmaps4rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12933460,"title":"gmaps4rails detect_location jumps on refresh","body":"<p>I'm using gmaps4rails in a Rails 3.1.3 app and I've set detection of location on in the gmaps4rails.base.js.coffee file like so;</p>\n\n<pre><code>@default_map_options =\n  id: 'map'\n  draggable: true\n  detect_location: true  # should the browser attempt to use geolocation detection features of HTML5?\n  center_on_user: true   # centers map on the location detected through the browser\n  center_latitude: 0\n  center_longitude: 0\n  zoom: 7\n  maxZoom: null\n  minZoom: 10\n  auto_adjust : true      # adjust the map to the markers if set to true\n  auto_zoom: true         # zoom given by auto-adjust\n  bounds: []              # adjust map to these limits. Should be [{\"lat\": , \"lng\": }]\n  raw: {}                  # raw json to pass additional options\n</code></pre>\n\n<p>This works half the time. I notice that when I hit F5 or Ctrl+r to refresh the browser it sometimes places me in Broken Hill, when I'm supposed to be in Melbourne (840kms difference).</p>\n\n<p>Sometimes I see it quickly go to Broken Hill then switches to Melbourne whilst loading. Here are all the other plugins I have installed:</p>\n\n<pre><code>#= require gmaps4rails/gmaps4rails.base\n#= require gmaps4rails/gmaps4rails.googlemaps\n#= require jquery\n#= require jquery_ujs\n#= require jquery.ui.datepicker\n#= require jquery-ui-timepicker-addon\n#= require jquery.ui.autocomplete\n#= require jquery.ui.slider\n#= require jquery.flexslider\n#= require jquery.ui.widget\n#= require jquery.ui.mouse\n#= require jquery.ui.touch-punch.min\n#= require jQuery.BlackAndWhite\n#= require form-accordion\n#= require modernizr\n#= require lovesjavascript\n#= require jquery.tokeninput\n#= require authentications\n#= require inquiries\n#= require registrations\n#= require search\n#= require tinymce-jquery\n#= require jquery.sticky\n#= require_self\n</code></pre>\n\n<p>I have tried with only gmaps4rails base &amp; googlemaps in and still have the problem.</p>\n"},{"tags":["ruby-on-rails-3","variables","hash","params"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12933226,"title":"How to get these params from params string","body":"<p>Try to get a value from a param hash but its in inregular different format than regular params. I had to screenshot it because cannot pastie it here with preservation.</p>\n\n<p>To no avail, what would be the correct way to get those values from the below params string? It seems a mixed mess of all kind of types.</p>\n\n<p>I try to grabb these values to do some checks on: \n* filename\n* @tempfile</p>\n\n<p>tried params[:photo]['orginal_filename'] and ['photo'][orginal_filename' to no avail</p>\n\n<hr>\n\n<p><img src=\"http://i.stack.imgur.com/eSnix.png\" alt=\"enter image description here\"></p>\n\n<hr>\n"},{"tags":["ruby-on-rails-3","facebook-graph-api","koala"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12933088,"title":"Can I create Page Tab through Graph API?","body":"<p>I am currently developing an web application on Rails. I want the user to be able to create his own facebook page. I thought of creating custom Tab for him on my main application or page.</p>\n\n<p>Can Graph API create Page Tabs programatically?</p>\n"},{"tags":["ruby","ruby-on-rails-3","rubygems"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12933185,"title":"How to define asset dependency in a gem?","body":"<p>I'm wondering if there is a way to define a gem dependency \"bound\" to a bundler group.</p>\n\n<p>I assume that <code>add_development_dependency</code> acts somehow like <code>gem \"foo\", group: [:test, :development]</code></p>\n\n<p>So if I make a gem which depends on jquery (bad example, I know) for example should I add this dependency? My thoughts on that:</p>\n\n<ul>\n<li>normal dependency: The gem is only needed on asset compiling stages but a normal dependency would get installed even if not needed</li>\n<li>development dependency: would at least indicate what is needed but it does not solve the actual problem</li>\n<li>no dependency: the user have to take care</li>\n</ul>\n\n<p>What can or should I do? I know that the asset pipeline is very rails related but is there a way of using bundler groups for gem dependencies?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","radiant"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12933150,"title":"NoMethodError (undefined method `service_options' for nil:NilClass)","body":"<p>i am using rails 2.3.4 and i am facing \"no method error\"</p>\n\n<p>there is possibility to not find method but my question is - is there possibility to error occurred because of empty table? or error in another controller or helper?</p>\n\n<p>error trace:</p>\n\n<p>Processing QuoteRequestsController#create (for 127.0.0.1 at 2012-10-17 16:07:34) [POST]\n  Parameters: {\"controller\"=>\"quote_requests\", \"quote_request\"=>{\"packing_required\"=>\"\", \"move_steps_number\"=>\"\", \"phone_day\"=>\"\", \"pickup_region_id\"=>\"\", \"email\"=>\"\", \"move_to_street\"=>\"\", \"move_from_suburb\"=>\"\", \"title\"=>\"\", \"quick_estimate\"=>\"true\", \"room_counts\"=>{\"9\"=>\"0\", \"8\"=>\"0\", \"5\"=>\"0\", \"2\"=>\"0\", \"3\"=>\"0\", \"6\"=>\"0\", \"7\"=>\"0\", \"1\"=>\"0\", \"4\"=>\"\", \"11\"=>\"0\"}, \"arrive_parking_notes\"=>\"\", \"first_name\"=>\"\", \"arrive_date_flexible\"=>\"false\", \"insurance_value\"=>\"\", \"arrive_steps_number\"=>\"\", \"move_parking_notes\"=>\"\", \"last_name\"=>\"\", \"move_region_id\"=>\"\", \"move_date_flexible\"=>\"false\", \"move_type_id\"=>\"26\", \"move_to_city\"=>\"\", \"arrive_date\"=>\"\", \"move_from_street\"=>\"\", \"move_date\"=>\"\", \"move_to_suburb\"=>\"\", \"move_from_city\"=>\"\", \"phone_mobile\"=>\"\"}, \"authenticity_token\"=>\"U42qF1c0FJXvnC1SCNNYWzxKN3Pem7dC6L01LbTQD7E=\", \"commit\"=>\"Submit\", \"action\"=>\"create\"}</p>\n\n<p>NoMethodError (undefined method <code>service_options' for nil:NilClass):\n  vendor/extensions/smartmove/app/controllers/quote_requests_controller.rb:136:in</code>load_regions'</p>\n\n<p>vendor/radiant/vendor/plugins/haml/rails/./lib/sass/plugin/rails.rb:19:in `process'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:162:in `start'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:95:in `start'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:92:in `each'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:92:in `start'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:23:in `start'</p>\n\n<p>/home/bacancy/.rvm/rubies/ruby-1.8.7-p370/lib/ruby/1.8/webrick/server.rb:82:in `start'</p>\n\n<p>in  \"vendor/extensions/smartmove/app/controllers/quote_requests_controller.rb\" line no:136 is </p>\n\n<p>@regions = ServiceDescription.find_by_name('region').service_options</p>\n\n<p>in my database  table is there service_descriptions and service_options. is there related to mysql or controller? \nplease guide me i am very much confuse. this is existing application i have to configure in local as well as on server</p>\n\n<p>Thank you in advance</p>\n\n<p>Thanking You\nNirav</p>\n"},{"tags":["ruby-on-rails-3","associations","squeel"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":219,"score":0,"question_id":7670108,"title":"How do I search through associations using Squeel in Rails 3?","body":"<p>I am trying to search through the model contacts associated by user_id but list the companies.</p>\n\n<pre><code>@companies_user = Company.joins{contacts}.where{:contact =&gt; {user_id =&gt; current_user}}.uniq\n</code></pre>\n\n<p>What I want is to search for the names of companies where there is a contact that has a user_id the same as current_user.</p>\n\n<p>I haven't found an example...I used to use searchlogic, but am now in Rails 3....thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","carrierwave"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":1645,"score":2,"question_id":6139909,"title":"Rails3 carrierwave not uploading","body":"<p>I tried this tutorial: <a href=\"http://railscasts.com/episodes/253-carrierwave-file-uploads?autoplay=true\" rel=\"nofollow\">http://railscasts.com/episodes/253-carrierwave-file-uploads?autoplay=true</a>.\nI can't get this to work. My file is not uploaded but I can see that data has been sent to the controller. </p>\n\n<pre><code>class PublicationsController &lt; ApplicationController\n  respond_to :html, :js, :json, :xml\n  def create\n    @publication = Publication.create(params[:publication])\n    ...\n  end\nend\n</code></pre>\n\n<p>UPDATE:</p>\n\n<pre><code>&lt;form novalidate=\"novalidate\" method=\"post\" id=\"new_publication\" enctype=\"multipart/form-data\" class=\"simple_form publication\" action=\"/sl/publications\" accept-charset=\"UTF-8\"&gt;&lt;div style=\"margin:0;padding:0;display:inline\"&gt;&lt;input type=\"hidden\" value=\"✓\" name=\"utf8\"&gt;&lt;input type=\"hidden\" value=\"vny2UjREsnQLZkUjH3zNxC8Cz5tvG/sAcllyjzZ+PWo=\" name=\"authenticity_token\"&gt;&lt;/div&gt;\n          &lt;div class=\"inputs\"&gt;\n            &lt;div class=\"input string required\"&gt;&lt;label for=\"publication_full_name\" class=\"string required\"&gt;&lt;abbr title=\"obvezno\"&gt;*&lt;/abbr&gt; Name&lt;/label&gt;&lt;input type=\"text\" size=\"50\" required=\"required\" name=\"publication[full_name]\" maxlength=\"255\" id=\"publication_full_name\" class=\"string required\"&gt;&lt;/div&gt;\n            &lt;div class=\"input string email required\"&gt;&lt;label for=\"publication_email\" class=\"email required\"&gt;&lt;abbr title=\"obvezno\"&gt;*&lt;/abbr&gt;Mail&lt;/label&gt;&lt;input type=\"email\" size=\"50\" required=\"required\" name=\"publication[email]\" maxlength=\"255\" id=\"publication_email\" class=\"string email required\"&gt;&lt;/div&gt;\n            &lt;div class=\"input string required\"&gt;&lt;label for=\"publication_subject\" class=\"string required\"&gt;&lt;abbr title=\"obvezno\"&gt;*&lt;/abbr&gt;Subject&lt;/label&gt;&lt;input type=\"text\" size=\"50\" required=\"required\" name=\"publication[subject]\" maxlength=\"255\" id=\"publication_subject\" class=\"string required\"&gt;&lt;/div&gt;\n            &lt;div class=\"input text required\"&gt;&lt;label for=\"publication_text\" class=\"text required\"&gt;&lt;abbr title=\"obvezno\"&gt;*&lt;/abbr&gt;Text&lt;/label&gt;&lt;textarea rows=\"20\" required=\"required\" name=\"publication[text]\" id=\"publication_text\" cols=\"40\" class=\"text required\"&gt;&lt;/textarea&gt;&lt;span class=\"hint\"&gt;You can uncomment the line below if you need to overwrite.&lt;/span&gt;&lt;/div&gt;\n            &lt;div class=\"input file required\"&gt;&lt;label for=\"publication_attachment\" class=\"file required\"&gt;&lt;abbr title=\"obvezno\"&gt;*&lt;/abbr&gt; Attachment&lt;/label&gt;&lt;input type=\"file\" required=\"required\" name=\"publication[attachment]\" id=\"publication_attachment\" class=\"file required\"&gt;&lt;/div&gt;\n          &lt;/div&gt;\n          &lt;div class=\"buttons\"&gt;\n            &lt;input type=\"submit\" value=\"Create Publication\" name=\"commit\" id=\"publication_submit\" class=\"button\"&gt;\n          &lt;/div&gt;\n        &lt;/form&gt;\n</code></pre>\n\n<p>I can see that params are passed to the controller like this:</p>\n\n<pre><code>Started POST \"/en/publications\" for 127.0.0.1 at Thu May 26 16:17:25 +0200 2011\n  Processing by PublicationsController#create as HTML\n  Parameters: {\"commit\"=&gt;\"Create Publication\", \"authenticity_token\"=&gt;\"vny2UjREsnQLZkUjH3zNxC8Cz5tvG/sAcllyjzZ+PWo=\", \"utf8\"=&gt;\"\\342\\234\\223\", \"publication\"=&gt;{\"attachment\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0x106d660a8 @headers=\"Content-Disposition: form-data; name=\\\"publication[attachment]\\\"; filename=\\\"photo.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", @content_type=\"image/jpeg\", @original_filename=\"photo.jpg\", @tempfile=#&lt;File:/var/folders/yX/yXe3dRdgGO8II-+SWIzLRE+++TI/-Tmp-/RackMultipart20110526-35653-1sr4hnw-0&gt;&gt;, \"text\"=&gt;\"asd\", \"subject\"=&gt;\"asd\", \"full_name\"=&gt;\"asd\", \"email\"=&gt;\"asd@lol.com\"}, \"locale\"=&gt;\"en\"}\n</code></pre>\n\n<p>Model:</p>\n\n<pre><code>class Publication &lt; ActiveRecord::Base\n  mount_uploader :attachment, PublicationUploader\n\n  validates :subject, \n            :presence =&gt; true\n  validates :text, \n            :presence =&gt; true\n  validates :full_name, \n            :presence =&gt; true\n  validates :email, \n            :presence =&gt; true,\n            :email =&gt; { :if =&gt; 'email.present?' }\n  # validates :attachment, \n  #           :integrity =&gt; true,\n  #           :processing =&gt; true\nend\n</code></pre>\n\n<p>Uploader class (default):</p>\n\n<pre><code>class PublicationUploader &lt; CarrierWave::Uploader::Base\n\n  # Include RMagick or ImageScience support:\n  # include CarrierWave::RMagick\n  # include CarrierWave::ImageScience\n\n  # Choose what kind of storage to use for this uploader:\n  storage :file\n  # storage :s3\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process :scale =&gt; [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  # version :thumb do\n  #   process :scale =&gt; [50, 50]\n  # end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_white_list\n    %w(jpg jpeg gif png pdf doc txt)\n  end\n\n  # Override the filename of the uploaded files:\n  # def filename\n  #   \"something.jpg\" if original_filename\n  # end\n\nend\n</code></pre>\n\n<p>Gemfile</p>\n\n<pre><code>source 'http://rubygems.org'\n\ngem 'rails', '3.0.7'\ngem \"hirb\"\ngem \"haml\"\ngem \"compass\"\ngem \"asset_tags\"\ngem \"js_erb\"\ngem \"jammit\"\ngem 'cat_router', '&gt;=0.2.0'\ngem 'devise'\ngem 'i18n_routing'\ngem 'simple_form', '&gt;=1.4'\ngem 'carmen'\ngem 'carrierwave', '&gt;=0.5.4'\n\ngroup :development, :test do\n  gem 'sqlite3'\n  gem 'capistrano'\n  gem \"win32-open3\", :platforms =&gt; :mswin\n  gem 'seed-fu'\nend\ngroup :staging, :production do\n  gem 'mysql'\nend\n</code></pre>\n\n<p>Help?</p>\n"},{"tags":["ruby","ruby-on-rails-3","devise"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":15,"score":0,"question_id":12931582,"title":"Instantiating Devise user models manually using contents of params hash","body":"<p>I'm losing my mind trying to figure this out:</p>\n\n<p>There's a registration module which side-steps the main devise registrations controller, and I have to manually instantiate the Devise-generated user model using User.new(...). I'm using a form_tag to submit all of the necessary parameters necessary for User.new(). Here's a truncated version of my code:</p>\n\n<pre><code>def registration_three\n\n  @user = User.new(:email =&gt; params[:email], :password =&gt; params[:password], :password_confirmation =&gt; params[:password_confirmation])\n  @user.save\n\n  @user = User.new(:email =&gt; 'patlopez@yahoo.com', :password =&gt; 'qwertyui', :password_confirmation =&gt; 'qwertyui')\n  @user.save\n\nend\n</code></pre>\n\n<p>The second @user.save works, but the first one doesn't. params[:email], params[:password], and params[:password_confirmation] certainly exist, according to the print statements in stdout. </p>\n\n<p>Anyone have any ideas? </p>\n\n<p>EDIT:\nSo I tried changing all of the single-quote strings in the second User.new(...) to double-quote strings like the ones stored in the params hash...and the second instantiation failed as well. So I'm fairly sure that the issue involves double- vs single-quote strings. Anyone know how to convert double-quote strings to single-quote ones? Thanks in advance. </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","internationalization","rails-i18n"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":71,"score":1,"question_id":12914019,"title":"Rails: Remove missing translation errors","body":"<p>I am using internationalization for <strong>english (en)</strong> and <strong>french (fr)</strong>, I have used en.yml for limited use and most of the translations I am writing in fr.yml.</p>\n\n<p>With <strong>locale as fr</strong> everything works good, but with <strong>en it shows me error</strong> as missing translation span.</p>\n\n<p>For eg if I have got something like</p>\n\n<pre><code>&lt;%= text_field_tag( \"search\", params[:search], :placeholder=&gt;t(\"Search\"), :class=&gt;\"search_input\") %&gt;\n</code></pre>\n\n<p>and i get output for en is:</p>\n\n<pre><code>&lt;input class=\"search_input\" id=\"search\" name=\"search\" placeholder=\"&lt;span class=\" translation_missing\"=\"\" title=\"translation missing: en.Search\"&gt;\n</code></pre>\n\n<p>What I want is that it should <strong>turn off translation errors for english</strong>, since english is my default language, but for some cases I've used en.yml.</p>\n\n<p>Or if this is not possible then whole error message should be removed.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","books"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":3,"view_count":76,"score":-1,"question_id":12930132,"title":"Good book for beginner on ruby on rails beginners","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/55574/learning-ruby-on-rails\">Learning Ruby on Rails</a>  </p>\n</blockquote>\n\n\n\n<p>I'm a beginner on ruby on rails. The documentation is spinning my head. Can you please give me a good book with which i can start. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","openid","ruby-1.9"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":68,"score":1,"question_id":12908608,"title":"Connection failed for google open_id using omniauth","body":"<p>I am trying to add open-id functionality to my app, I am using omniauth and omniauth-openid gems for same. </p>\n\n<p>I have done the installation steps added it to initializer as middleware,</p>\n\n<pre><code>require 'omniauth-openid'\nrequire 'openid/store/filesystem'\n\nRails.application.config.middleware.use OmniAuth::Builder do \n  provider :open_id, :store =&gt; OpenID::Store::Filesystem.new('/tmp')\nend\n</code></pre>\n\n<p>and a routes for andling callback</p>\n\n<pre><code>match '/auth/:provider/callback' =&gt; 'callback#myauthentication'\n</code></pre>\n\n<p>when I try to hit this url, to connect to <strong>google provider</strong></p>\n\n<pre><code>http://[mydomain]/auth/open_id?openid_url=https%3A%2F%2Fwww.google.com%2Faccounts%2Fo8%2Fid\n</code></pre>\n\n<p>I get connection failed error everytime</p>\n\n<p><strong>For Yahoo</strong>\nhttp://[mydomain]/auth/open_id?openid_url=http%3A%2F%2Fme.yahoo.com%2F</p>\n\n<p>Furthur if I try with yahoo open id , even after authenticating correctly I get invalid_credentials error\nUpdate 1: \n  I am using apache web server, and thin/webrick app server. I verified that if I am not behind a apache web server and run directly as localhost:3000 it works fine. Why does omniauth behave differently </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","coffeescript","angularjs"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":80,"score":3,"question_id":12927126,"title":"Error: Unknown provider: aProvider <- a","body":"<p>I'm using AngularJS in a Ruby on Rails 3.2.8 project with assets.</p>\n\n<p>When I load up my form which is using AngularJS on my development machine I don't have a problem. However when I load the same form up on my production server I get this error in the Javascript console:</p>\n\n<pre><code>Error: Unknown provider: aProvider &lt;- a\n</code></pre>\n\n<p>I've tracked it back to my coffeescript file where I setup AngularJS for use within a form:</p>\n\n<pre><code>$ (event) -&gt;\n  $(\"#timesheet_description\").autocomplete({source: '/autocomplete/work_descs'})\n\n  # Create AngularJS module\n  app = angular.module 'timesheetApp', []\n\n  # Create a AngularJS controller\n  app.controller \"TimesheetCtrl\", ($scope) -&gt;\n    $scope.costed_amount = 0\n                                                                                                # Bind my module to the global variables so I can use it.\n  angular.bootstrap document, [\"timesheetApp\"]  \n</code></pre>\n\n<p>If I comment all this out the page will load without errors and without AngularJS abilities.</p>\n\n<p>Is the problem due to Rails assets compiling and minify?\nIs there a way to fix this and still use coffeescript and Rails assets?</p>\n"},{"tags":["html","ruby-on-rails","ruby-on-rails-3","haml"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12928159,"title":"Select tag rails to follow key punched for numerics","body":"<p>I have a select tag for time.</p>\n\n<pre><code>  = select_tag \"depart-minute\", options_for_select('00'..'59', dep_minute), :include_blank =&gt; true'\n</code></pre>\n\n<p>When this select field is on focus and i press 5 two time, it show 51 that's the second item in the list starts with 5.</p>\n\n<p>what i want is, when i press 5 two times, it should show 55.</p>\n\n<p>can it be possible?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","email","email-headers","mailman-gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":10689941,"title":"RoR display email without redundant information","body":"<p>I use Mailman in my RoR projekt </p>\n\n<p>I want to receive mails and display the body ..... but ther is a format error</p>\n\n<p>i get the mail and want to save it as text </p>\n\n<pre><code>message = message.body.encoded\n</code></pre>\n\n<p>that works!!!</p>\n\n<p>But the output is not only the body of the mail it also includes\nsome more infos like</p>\n\n<pre><code>f46d04451843a6499e04c08f212a Date: Mon, 21 May 2012 19:29:19 +0200 Mime-Version: 1.0 Content-Type: text/plain; charset=ISO-8859-1 Content-Transfer-Encoding: 7bit Content-ID: &lt;4fba7b6fa56a0_1e194c540145299d@ubuntu.mail&gt;\n</code></pre>\n\n<p>but that i do not want to disply that infos like Mime, Date .... can someone tell me how in only get the body of the email or how i can cut away the other infos???</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","json","rest","content-negotiation"],"answer_count":0,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12915653,"title":"How to make Rails parse a posted string as json without sending the 'Content-type: application/json' header?","body":"<p>Rails changes behaviour at several levels when the header 'Content-type: application/json' is sent:</p>\n\n<ul>\n<li>submitted post body is parsed as json instead of just a string parameter</li>\n<li>wrap_parameters :format => [:json] in config/initializers/wrap_parameters.rb is used when parsing posted mentioned parameters (so you can either send json with or without a root element)</li>\n</ul>\n\n<p>What if I cannot trust the (external) client in passing the right header?  In other words, I want to have my application behave as if the client <em>always</em> passes the 'Content-type: application/json' header, even if the client actually does not?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12850480,"title":"refactor code to a loop","body":"<p>Currently I have </p>\n\n<pre><code>    &lt;b&gt;Step 1&lt;/b&gt;    \n      &lt;%= @recipe_records.instruct_1 %&gt;\n     &lt;/p&gt;   \n    &lt;p&gt; \n    &lt;b&gt;Step 2&lt;/b&gt;       \n      &lt;%= @recipe_records.instruct_2 %&gt;\n      &lt;/p&gt;\n    .....\n    &lt;b&gt;Step 30&lt;/b&gt;      \n      &lt;%= @recipe_records.instruct_30 %&gt;\n      &lt;/p&gt;\n</code></pre>\n\n<p>How do I put it in a loop instead of listing all 30 steps and to not display empty steps?</p>\n\n<pre><code>    &lt;% 30.times do |n|%&gt;\n        &lt;% ri = @recipe_records.instruct_#{n+1}%&gt;\n        &lt;%= if !ri.empty? %&gt;\n            &lt;p&gt;\n            &lt;%= ri %&gt;\n        &lt;% end%&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<p>Tried but unable to work.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching"],"answer_count":2,"favorite_count":5,"up_vote_count":10,"down_vote_count":0,"view_count":376,"score":10,"question_id":8177011,"title":"Is there a workaround for ignored content_for blocks with caches_action and :layout => false?","body":"<p>When you use <code>caches_action :layout =&gt; false</code> in Rails 3, any content_for blocks that are populated in the cached view and used in your layout wind up empty. Is there any workaround for this?</p>\n\n<p>E.g. in my application I have the following rather typical setup.</p>\n\n<p>A helper method called from my views which sets the page title:</p>\n\n<pre><code># application_helper.rb\ndef page_title(title)\n    content_for(:page_title) { title }\nend\n</code></pre>\n\n<p>A line in my layout file as follows</p>\n\n<pre><code># application.html.erb\n&lt;head&gt;\n&lt;title&gt;&lt;%= yield(:page_title) %&gt;&lt;/title&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>And in a view I might call</p>\n\n<pre><code># index.html\n&lt;% page_title 'Hello!' %&gt;\n</code></pre>\n\n<p>Of course, if you cache your action with <code>:layout =&gt; false</code>, this results in having blank page titles, since action caching ignores all content_for blocks.</p>\n\n<p>Is there no workaround for this?  Action caching with <code>:layout =&gt; false</code> is so close to being brilliantly useful, but this glitch renders it quite awkward.</p>\n\n<p>Other folks asking or commenting about this same issue:</p>\n\n<ol>\n<li><a href=\"http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/d8d72f050701d44b\">http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/d8d72f050701d44b</a></li>\n<li><a href=\"http://www.golygon.com/2011/04/tips-and-tricks-in-ruby-on-rails/\">http://www.golygon.com/2011/04/tips-and-tricks-in-ruby-on-rails/</a></li>\n<li><a href=\"https://rails.lighthouseapp.com/projects/8994/tickets/4140-action-caching-with-caches_action-and-layout-false\">https://rails.lighthouseapp.com/projects/8994/tickets/4140-action-caching-with-caches_action-and-layout-false</a></li>\n</ol>\n\n<p>And the <a href=\"http://rubydoc.info/github/rails/rails/master/ActionView/Helpers/CaptureHelper#content_for-instance_method\">Rails documentation</a> that notes this behavior:</p>\n\n<p>\"WARNING: content_for is ignored in caches. So you shouldn’t use it for elements that will be fragment cached.\" </p>\n"},{"tags":["ruby-on-rails-3","report"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":19,"score":1,"question_id":12930875,"title":"Report generation in rails","body":"<p>I want to generate reports in ruby on rails what would be the suggested way to do report generation in rails and i want to fetch data from multiple tables and give a customized output and the report generated should be in XLS format.Pretty new to rails </p>\n"},{"tags":["facebook","ruby-on-rails-3","facebook-graph-api","oauth","cron"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12914854,"title":"How to login into Facebook/Twitter programatically?","body":"<p>I am assigned to come up with a plan where an user can access facebook/twitter/emails through mobile SMS (offline). Here an offline user text his credentials to mobile network operator who in turn make a request to our application(rails) with given credentials to get the requested information of the user in text. My basic doubt is there a way to login into facebook/twitter/emails programatically ?</p>\n\n<p>One alternative is to use Nokogiri like tools to send a post request. But I feel this is not a good idea. Please can anyone suggest on this ? Any APIs for this ?</p>\n"},{"tags":["ruby-on-rails-3","rspec","capybara"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":503,"score":4,"question_id":8382252,"title":"Rails 3 rspec + capybara - current_path is nil?","body":"<p>I have this in my users_spec.rb</p>\n\n<pre><code>  scenario \"Go to contact page\" do\n    visit \"/contact\"\n    current_path.should == contact_path\n  end\n</code></pre>\n\n<p>After running rspec, I get</p>\n\n<pre><code>Failure/Error: current_path.should == contact_path\n       expected: \"/contact\"\n            got: nil (using ==)\n</code></pre>\n\n<p>For some reason, current_path seem to be returning nil. Is there a configuration that I am missing?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin","carrierwave","image-uploading"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":76,"score":1,"question_id":12869953,"title":"ActiveAdmin loses image when validation fails","body":"<p>I've just installed ActiveAdmin and created a form like:</p>\n\n<pre><code>form do |f|\n  f.inputs \"Details\" do\n    f.input :title\n    f.input :published_on, as: :datepicker\n  end\n  f.has_many :images do |images_f|\n    images_f.input :image, as: :file, hint: images_f.template.image_tag(images_f.object.image.url)\n    images_f.input :description, as: :text, input_html: { rows: 3 }\n  end\n  f.has_many :topics do |t_f|\n    t_f.input :maker\n    t_f.input :title\n    t_f.input :text\n    t_f.input :image, as: :file, hint: t_f.template.image_tag(t_f.object.image.url)\n    t_f.input :sort_order\n  end\n  f.buttons\nend\n</code></pre>\n\n<p>I got quite a few mandatory feels so when I pick an image for within has_many :images and I click on save (knowing it will fail to validate), it shows me the image I picked in the hint which is fine. However, the image input is still shown and if I don't fill in any form and click submit again, it will again fail to validate but this time the image is gone.</p>\n\n<p>Does anyone know how to prevent this? It's kinda annoying.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":90,"score":4,"question_id":12929738,"title":"Ruby / Rails syntax","body":"<p>How does this syntax work?</p>\n\n<pre><code>before_validation { |user| user.email = email.downcase }\n</code></pre>\n\n<p>I would think that it would need to be this:</p>\n\n<pre><code>before_validation { |user| user.email = user.email.downcase }\n</code></pre>\n\n<p>Thanks for your help!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":11922335,"title":"Ruby on rails - #<Resource:0x007f1004593600> weird message","body":"<p>I don't know why I get some weird message on my view when I try to assign a variable.</p>\n\n<pre><code>&lt;%= column = local_assigns[:param] %&gt;\n</code></pre>\n\n<p>This is what I get on my view:</p>\n\n<pre><code>#&lt;Resource:0x007f1004593600&gt; \n\n#&lt;Resource:0x007f1004592e08&gt; \n\n#&lt;Resource:0x007f1004889eb8&gt; \n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":11909903,"title":"Dynamically generate forms to edit an item in Rails","body":"<p>I have an Item model, with a few attributes, which I show as a list on the home page.</p>\n\n<p>I want to be able to make that <code>&lt;li&gt;</code>'s content into an edit form for that Item, and on submitting, if there were no validation errors, restore <code>&lt;li&gt;</code>'s contents (with updated values).</p>\n\n<p>You can assume that the Item just has one string attribute named <code>title</code>, that should be enough for me to adapt into a bigger model.</p>\n\n<p>How should I approach this? I'm guessing I need to somehow generate the forms on the server side, and bring them into the <code>li</code>, as it would be easy to integrate error handling with that, but I'm not sure how I can do that elegantly.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":408,"score":0,"question_id":10134881,"title":"why rails generate controller is not working?","body":"<p>I am trying to run this in the terminal: </p>\n\n<pre><code>rails generate controller welcome index\n</code></pre>\n\n<p>but, there isn't any file created! the process finished with exit code 0\nI am using rails 3.2.3</p>\n\n<p>any idea please ?</p>\n\n<p>EDIT</p>\n\n<pre><code>RUBYGEMS VERSION: 1.8.10\nRUBY VERSION: 1.9.3 (2011-10-30 patchlevel 0) [i686-linux]\nINSTALLATION DIRECTORY: /home/sam/.rvm/gems/ruby-1.9.3-p0@dcaclab\nRUBY EXECUTABLE: /home/sam/.rvm/rubies/ruby-1.9.3-p0/bin/ruby\nEXECUTABLE DIRECTORY: /home/sam/.rvm/gems/ruby-1.9.3-p0@dcaclab/bin\nRUBYGEMS PLATFORMS:\n  ruby\n  x86-linux\nGEM PATHS:\n   /home/sam/.rvm/gems/ruby-1.9.3-p0@dcaclab\n   /home/sam/.rvm/gems/ruby-1.9.3-p0@global\nGEM CONFIGURATION:\n   :update_sources =&gt; true\n   :verbose =&gt; true\n   :benchmark =&gt; false\n   :backtrace =&gt; false\n   :bulk_threshold =&gt; 1000\nREMOTE SOURCES:\n   http://rubygems.org/\n----------------------\nIDE: JetBrains RubyMine 4.0.3, build #RM-117.159\nOS: Linux 3.0.0-17-generic[i386]\nJava: 1.7.0-b147\nRubyMine SDK Environment:\nSdk: RVM: ruby-1.9.3-p0 [dcaclab]\nSdk Version: ver.1.9.3p0 ( revision 33570) p0\nRuby Interpreter: /home/sam/.rvm/rubies/ruby-1.9.3-p0/bin/ruby\nRVM Sdk: yes, gemset:dcaclab\nRVM Home: /home/sam/.rvm\nSdk Language Level: 1.9\nSdk Load Path:\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/i686-linux\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/vendor_ruby/1.9.1\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/vendor_ruby/1.9.1/i686-linux\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/vendor_ruby\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1\n     ~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/i686-linux\n     /opt/RubyMine-4.0.3/rubystubs19\nSdk Gem paths: \n     ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/bundler/gems\n     ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems\n     ~/.rvm/gems/ruby-1.9.3-p0@global/gems\nGems used for 'dcaclab':\n     rspec-mocks (2.9.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rspec-mocks-2.9.0\n     heroku (2.24.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/heroku-2.24.1\n     multi_json (1.2.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/multi_json-1.2.0\n     actionmailer (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/actionmailer-3.2.3\n     capybara-webkit (0.11.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/capybara-webkit-0.11.0\n     thor (0.14.6)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/thor-0.14.6\n     rspec (2.9.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rspec-2.9.0\n     orm_adapter (0.0.7)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/orm_adapter-0.0.7\n     netrc (0.7.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/netrc-0.7.1\n     rspec-rails (2.9.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rspec-rails-2.9.0\n     sprockets (2.1.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/sprockets-2.1.2\n     uglifier (1.2.4)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/uglifier-1.2.4\n     capybara (1.1.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/capybara-1.1.2\n     execjs (1.3.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/execjs-1.3.0\n     mime-types (1.18)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/mime-types-1.18\n     tilt (1.3.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/tilt-1.3.3\n     childprocess (0.3.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/childprocess-0.3.1\n     i18n (0.6.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/i18n-0.6.0\n     mocha (0.10.5)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/mocha-0.10.5\n     activesupport (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/activesupport-3.2.3\n     diff-lcs (1.1.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/diff-lcs-1.1.3\n     coffee-rails (3.2.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/coffee-rails-3.2.2\n     bcrypt-ruby (3.0.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/bcrypt-ruby-3.0.1\n     rack-test (0.6.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rack-test-0.6.1\n     on_the_spot (1.0.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/on_the_spot-1.0.0\n     nokogiri (1.5.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/nokogiri-1.5.2\n     selenium-webdriver (2.21.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/selenium-webdriver-2.21.0\n     erubis (2.7.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/erubis-2.7.0\n     cocoon (1.0.20)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/cocoon-1.0.20\n     sass (3.1.15)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/sass-3.1.15\n     rdoc (3.12)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rdoc-3.12\n     activeresource (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/activeresource-3.2.3\n     rubyzip (0.9.7)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rubyzip-0.9.7\n     factory_girl (3.1.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/factory_girl-3.1.0\n     validate_url (0.2.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/validate_url-0.2.0\n     mini_magick (3.4)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/mini_magick-3.4\n     addressable (2.2.7)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/addressable-2.2.7\n     journey (1.0.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/journey-1.0.3\n     rails (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/rails-3.2.3\n     hike (1.2.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/hike-1.2.1\n     factory_girl_rails (3.1.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/factory_girl_rails-3.1.0\n     tzinfo (0.3.32)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/tzinfo-0.3.32\n     eventmachine (0.12.10)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/eventmachine-0.12.10\n     pg (0.13.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/pg-0.13.2\n     metaclass (0.0.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/metaclass-0.0.1\n     libwebsocket (0.1.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/libwebsocket-0.1.3\n     builder (3.0.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/builder-3.0.0\n     json_pure (1.6.6)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/json_pure-1.6.6\n     activemodel (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/activemodel-3.2.3\n     carrierwave (0.6.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/carrierwave-0.6.1\n     activerecord (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/activerecord-3.2.3\n     thin (1.3.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/thin-1.3.1\n     rest-client (1.6.7)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rest-client-1.6.7\n     devise (2.0.4)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/devise-2.0.4\n     bundler (1.0.21)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/bundler-1.0.21\n     jquery-rails (2.0.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/jquery-rails-2.0.1\n     rspec-core (2.9.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rspec-core-2.9.0\n     mail (2.4.4)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/mail-2.4.4\n     rspec-expectations (2.9.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rspec-expectations-2.9.1\n     rack (1.4.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rack-1.4.1\n     actionpack (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/actionpack-3.2.3\n     xpath (0.1.4)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/xpath-0.1.4\n     launchy (2.1.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/launchy-2.1.0\n     arel (3.0.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/arel-3.0.2\n     rb-fsevent (0.9.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rb-fsevent-0.9.1\n     subexec (0.2.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/subexec-0.2.1\n     json (1.6.6)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/json-1.6.6\n     cancan (1.6.7)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/cancan-1.6.7\n     rack-cache (1.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rack-cache-1.2\n     coffee-script (2.2.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/coffee-script-2.2.0\n     rake (0.9.2.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/rake-0.9.2.2\n     guard (1.0.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/guard-1.0.1\n     sass-rails (3.2.5)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/sass-rails-3.2.5\n     polyglot (0.3.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/polyglot-0.3.3\n     warden (1.1.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/warden-1.1.1\n     spork (0.9.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/spork-0.9.0\n     simple_form (2.0.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/simple_form-2.0.1\n     guard-spork (0.6.1)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/guard-spork-0.6.1\n     treetop (1.4.10)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/treetop-1.4.10\n     rack-ssl (1.3.2)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/rack-ssl-1.3.2\n     daemons (1.1.8)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/daemons-1.1.8\n     coffee-script-source (1.2.0)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/coffee-script-source-1.2.0\n     haml (3.1.4)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/haml-3.1.4\n     ckeditor (3.6.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@dcaclab/gems/ckeditor-3.6.3\n     ffi (1.0.11)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/ffi-1.0.11\n     railties (3.2.3)\n         ~/.rvm/gems/ruby-1.9.3-p0@global/gems/railties-3.2.3\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","roles"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":31,"score":2,"question_id":12928674,"title":"how to restrict user to only particular action and modify when needed?","body":"<p>I am using devise for authentication and i want only user named <code>admin</code> having permission to edit or delete all the posts. The other users can view all the posts specific to any project. And only the users corresponding to that project can edit the posts. \nAlso we should able to change the user from one project to another. How can i do this?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":16,"score":0,"question_id":12928754,"title":"How can I restrict password to be accessed in controller in rails 3","body":"<p>In my rails application :-</p>\n\n<p>While creating a user/changing password etc password is always sent to the controller.\nHow can I restrict the password from being accessed in the controller?</p>\n"},{"tags":["ruby-on-rails-3","sprockets"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":11461736,"title":"Environment specific variables in sprockets","body":"<p>I'm use Rails 3.2 built in sprockets functionality to compile static assets. Is it possible to compile javascript with environment specific variables?</p>\n\n<p>So I would like to do something like this</p>\n\n<p>/assets/javascripts/myfile.js</p>\n\n<hr>\n\n<pre><code> //lots of code\n script.src =\n        ('https:' == document.location.protocol ? 'https://' : 'http://') +\n                'some.metrics.site/projects/&lt;%=ENV_SPECIFIC_TOKEN%&gt;.js';\n  //lots of other code\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12927063,"title":"How to upload large file in Ruby on rails?","body":"<p>I am Using Rails 3.0.9 , Ruby 1.9.3p0 \nI am trying to upload a zip/tar file to server.\nWhen i am uploading file 2.5mb. Evey thing works fine. But when i am uplaoing a zip file of 350mb. It creates error.(network error connection time out/ or \"aborted\" in response of firebug) .\nIn apache config, i had increased timeout from 300 from 300000 but nothing happened.\nIs this possibly an apache setting? Or could it be something on their end? Any suggestions on where I should look would be greatly appreciated.</p>\n"},{"tags":["ruby-on-rails-3","routes","paperclip"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":13,"score":0,"question_id":12928240,"title":"Rails - Setting routes for custom paperclip url's","body":"<p>I've set a custom paperclip path and url as follows:</p>\n\n<pre><code>path: \":rails_root/storage/:rails_env/photos/:id/:style/:basename.:extension\",\nurl: \"/storage/:rails_env/photos/:id/:style/:basename.:extension\"\n</code></pre>\n\n<p>But now I need to work out how to create a route so that I can access every photo for every instance of the model with this attachment with the url (e.g.):</p>\n\n<pre><code>http://0.0.0.0:3000/storage/development/photos/1/original/_MG_7918.JPG\n</code></pre>\n\n<p>Everything I've tried so far has ended with the same error:</p>\n\n<pre><code>No route matches [GET] \"/storage/development/photos/1/original/_MG_7918.JPG\"\n</code></pre>\n\n<p>Can someone help me out as to what structure my routes are going to need to take to get access to files in this directory structure?</p>\n"},{"tags":["sql","ruby-on-rails","ruby-on-rails-3","postgresql","postgresql-performance"],"answer_count":4,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":103,"score":2,"question_id":12905312,"title":"Order BY turns a 30ms query into a 7120ms query. Known performance issue?","body":"<p>I have a User table with 1m records:</p>\n\n<pre><code>User (id, fname, lname, deleted_at, guest)\n</code></pre>\n\n<p>I have the following query which is being run against a postgres 9.1 db:</p>\n\n<pre><code>SELECT \"users\".* \nFROM \"users\" \nWHERE (users.deleted_at IS NULL) AND (SUBSTRING(lower(fname), 1, 1) = 's') \nORDER BY guest = false, fname ASC \nLIMIT 25 OFFSET 0\n</code></pre>\n\n<p>Using pgAdmin 3, this SQL is taking <strong>7120ms</strong> to return 25 rows. If I remove the 'ORDER BY guest = false, fname ASC' the query takes just <strong>31ms</strong>. </p>\n\n<p>I have the following indexes:</p>\n\n<pre><code>add_index \"users\", [\"fname\"], :name =&gt; \"index_users_on_fname\"\nadd_index \"users\", [\"guest\", \"fname\"], :name =&gt; \"index_users_on_guest_and_fname\"\nadd_index \"users\", [\"deleted_at\"], :name =&gt; \"index_users_on_deleted_at\"\nadd_index \"users\", [\"guest\"], :name =&gt; \"index_users_on_guest\"\n</code></pre>\n\n<p>Any ideas? Thank you!</p>\n\n<p><strong>UPDATED with Explain</strong></p>\n\n<pre><code>\"Limit  (cost=43541.55..43541.62 rows=25 width=1612) (actual time=1276.777..1276.783 rows=25 loops=1)\"\n\"  -&gt;  Sort  (cost=43541.55..43558.82 rows=6905 width=1612) (actual time=1276.775..1276.777 rows=25 loops=1)\"\n\"        Sort Key: ((NOT guest)), fname\"\n\"        Sort Method: top-N heapsort  Memory: 37kB\"\n\"        -&gt;  Seq Scan on users  (cost=0.00..43346.70 rows=6905 width=1612) (actual time=5.143..1272.563 rows=475 loops=1)\"\n\"              Filter: ((deleted_at IS NULL) AND pubic_profile_visible AND ((fname)::text ~~ 's%'::text))\"\n\"Total runtime: 1276.967 ms\"\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","postgresql","postgresql-performance"],"answer_count":2,"favorite_count":2,"up_vote_count":4,"down_vote_count":0,"view_count":82,"score":4,"question_id":12906264,"title":"Faster search for records where 1st character of field doesn't match [A-Za-z]?","body":"<p>I currently have the following:</p>\n\n<pre><code>User (id, fname, lname, deleted_at, guest)\n</code></pre>\n\n<p>I can query for a list of user's by their <code>fname</code> initial like so:</p>\n\n<pre><code>User Load (9.6ms)  SELECT \"users\".* FROM \"users\" WHERE (users.deleted_at IS NULL) AND (lower(left(fname, 1)) = 's') ORDER BY fname ASC LIMIT 25 OFFSET 0\n</code></pre>\n\n<p>This is fast thanks to the following index:</p>\n\n<pre><code>  CREATE INDEX users_multi_idx\n  ON users (lower(left(fname, 1)), fname)\n  WHERE deleted_at IS NULL;\n</code></pre>\n\n<p>What I want to do now is be able to query for all Users that do not start with the letter's A-Z. I got this to work like so: </p>\n\n<pre><code>SELECT \"users\".* FROM \"users\" WHERE (users.deleted_at IS NULL) AND (lower(left(fname, 1)) ~ E'^[^a-zA-Z].*') ORDER BY fname ASC LIMIT 25 OFFSET 0\n</code></pre>\n\n<p>But the problem is this query is very slow and does not appear to be using the index to speed up the first query. Any suggestions on how I can elegantly make the 2nd query (non a-z) faster?</p>\n\n<p>I'm using Postgres 9.1 with rails 3.2</p>\n\n<p>Thanks</p>\n"},{"tags":["rubygems","ruby-on-rails-3"],"answer_count":4,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":13731,"score":8,"question_id":3001425,"title":"Uninstall Rails 3 with dependencies?","body":"<p>I like that Rails 3 is so easy to install: <code>gem install rails --pre</code>, and all of the dependencies are automatically installed for you. But, what about uninstalling it? If I just do <code>gem uninstall rails</code>, I still have</p>\n\n<pre><code>actionmailer (3.0.0.beta3)\nactionpack (3.0.0.beta3)\nactivemodel (3.0.0.beta3)\nactiverecord (3.0.0.beta3)\nactiveresource (3.0.0.beta3)\nactivesupport (3.0.0.beta3)\n</code></pre>\n\n<p>which I want to get rid of. What's the easiest way to do so?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":96,"score":2,"question_id":12863135,"title":"Reporting data from view in rails after_filter","body":"<p>I want to log the number of cache misses for certain blocks in my views.  I do the log storing in an after_filter in my controller.</p>\n\n<p>It doesn't seem possible to manipulate instance variables inside of views. What's the best way to store information during view rendering that is then made available to a controller's after_filter?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubymine","ruby-debug"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":64,"score":1,"question_id":12924473,"title":"RubyMine 4.5: How to drop into a context-aware Rails Console during debugging?","body":"<p>How do you drop into a rails console session during, say, a breakpoint pause while debugging in RubyMine?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","callback","delayed-job"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12927071,"title":"Delay job not triggering callback","body":"<p>I'm using a delay job to trigger an action 5 minutes after another.</p>\n\n<p>Specifically, I'm using delay to destroy an \"Order\" 5 minutes after it has been created, if that order has not been paid for. </p>\n\n<p>Because orders are associated with several other models, I created a before_destroy callback in the order model to make sure that when the order is destroyed, it takes down the other necessary model instances with it. My order.rb file has the following:</p>\n\n<pre><code>  has_many :cuts\n  has_many :lines, :dependent =&gt; :destroy\n\n  after_create :schedule_check_payment\n  before_destroy :roll_back\n\n  accepts_nested_attributes_for :lines\n\n  def roll_back\n    puts \"Doing rollback for #{self.id}\"\n    self.lines.each do |l|\n      l.packages each do |p|\n        p.update_attributes(:sold =&gt; false, :line_id =&gt; nil)\n      end\n    end\n  end\n\n  def schedule_check_payment\n    self.delay(:run_at =&gt; 5.minutes.from_now).check_payment\n  end\n\n  def check_payment\n    self.reload\n    if self.status == 0 \n      self.destroy\n    end\n  end\n</code></pre>\n\n<p>The problem is, even though I got the delay method to work (it destroys the order after five minutes), it doesn't seem to call my before_destroy. Pretty perplexed. Am I doing something wrong?</p>\n\n<p>EDIT That \"puts\" line is there for diagnostics. I wanted to see if the method was being called by looking for that puts in my server logs. It isn't.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","jsf-2","jruby"],"answer_count":2,"favorite_count":1,"up_vote_count":3,"down_vote_count":1,"view_count":400,"score":2,"question_id":11132309,"title":"How to achieve UI magic driven by JSF 2.0 (Primefaces) In Ruby on Rails","body":"<p><strong>Question 1)</strong>\nI would like to know whether ruby on rails have gems with functionality similar to primefaces.\nwhy i am asking is </p>\n\n<p>if you go with primefaces ( <a href=\"http://www.primefaces.org/showcase-labs/ui/home.jsf\" rel=\"nofollow\">http://www.primefaces.org/showcase-labs/ui/home.jsf</a> ) developer no need to worry about javascript or jquery stuffs.</p>\n\n<p>As far as my knowledge JSF is an spec , on based the spec various implementations available , primefaces is an ui framework for those implementations , primefaces has so many components based on jquery and javascript libs. More or less primefaces simply serves as a javascript wrapper.\nI you use primefaces , you mainly concentrate on business logic no need to worry about UI.</p>\n\n<p>i was heavily inspired by ruby on rails approach and there are lot of gems available.</p>\n\n<p><em><strong>what my question is , Is there an gem or UI framework available for ruby on rails similar to UI magic driven by primefaces</em></strong></p>\n\n<p>note: i am not looking for pure jquery or dojo stuffs, i am looking for UI component driven stuffs for ruby on rails. Guys who worked on projects using primefaces and projects using rails will understand my question 100 %.</p>\n\n<p><strong>Question 2)</strong>\nI would like to know list of  gems related to user interface. what i am asking is inorder to create very niche user interface on ruby on rails what are the stuffs(frameworks or gems) needed.</p>\n"},{"tags":["ruby","xml","ruby-on-rails-3","soap","savon"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12913527,"title":"How do you deal with nested namespaces in Savon?","body":"<p>If I have the following SOAP request:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://test.org/\" xmlns:hon=\"http://schemas.datacontract.org/2004/07/TEST.RVU.Entity\"&gt;\n   &lt;soapenv:Header/&gt;\n   &lt;soapenv:Body&gt;\n      &lt;tem:Authenticate&gt;\n         &lt;!--Optional:--&gt;\n         &lt;tem:authenticationDet&gt;\n            &lt;!--Optional:--&gt;\n            &lt;hon:AccountType&gt;0&lt;/hon:AccountType&gt;\n            &lt;!--Optional:--&gt;\n            &lt;hon:Password&gt;bacon&lt;/hon:Password&gt;\n            &lt;!--Optional:--&gt;\n            &lt;hon:UserName&gt;smith&lt;/hon:UserName&gt;\n         &lt;/tem:authenticationDet&gt;\n      &lt;/tem:Authenticate&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>How do I write down a valid soap request using the Savon gem that includes the tem: and hon: namespaces?</p>\n\n<p>Thanks</p>\n"}]}
{"total":34675,"page":18,"pagesize":100,"questions":[{"tags":["ruby","xml","ruby-on-rails-3","soap","savon"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12913091,"title":"Convert this XML request to a proper Savon request","body":"<p>Can somebody convert this:</p>\n\n<pre><code>&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://test.org/\" xmlns:hon=\"http://schemas.datacontract.org/2004/07/TEST.RVU.Entity\"&gt;\n   &lt;soapenv:Header/&gt;\n   &lt;soapenv:Body&gt;\n      &lt;tem:Authenticate&gt;\n         &lt;!--Optional:--&gt;\n         &lt;tem:authenticationDet&gt;\n            &lt;!--Optional:--&gt;\n            &lt;hon:AccountType&gt;0&lt;/hon:AccountType&gt;\n            &lt;!--Optional:--&gt;\n            &lt;hon:Password&gt;bacon&lt;/hon:Password&gt;\n            &lt;!--Optional:--&gt;\n            &lt;hon:UserName&gt;smith&lt;/hon:UserName&gt;\n         &lt;/tem:authenticationDet&gt;\n      &lt;/tem:Authenticate&gt;\n   &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>now using Soap gem SAVON, how can I write this in a correct syntax that the  client.request method can deal with it?</p>\n\n<p>I tried this:</p>\n\n<pre><code>client.request :tem, :authenticate, body: { \"authenticationDet\" =&gt; { \"AccountType\" =&gt; 0, \"Password\" =&gt; \"bacon\", \"UserName\" =&gt; \"smith\"}}\n</code></pre>\n\n<p>but I get a HTTP 400 error.</p>\n\n<p>Any advice?</p>\n"},{"tags":["ruby-on-rails-3","paypal","activemerchant","express-checkout"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":66,"score":0,"question_id":12926956,"title":"Rails3 ActiveMerchant Paypal Express Checkout Money Transfer","body":"<p>I am trying to implement PaypalExpressCheckout in my e-commerce application which is built on Rails3.</p>\n\n<p>There will be two roles in the application - Seller and Buyer </p>\n\n<ul>\n<li>Seller can create products and he can add his valid Paypal Email address to get amount on behalf of his sold products.</li>\n<li>Buyer able to purchase items and can checkout through Paypal, amount shall transfer to the seller account once the user transaction is successful.</li>\n</ul>\n\n<p>The issue I'm facing here, when buyer checking out, the amount is successfully transfer to the seller account but not deducting same from the buyer account. </p>\n\n<p>I configured API credentials from Paypal sandbox and here are the methods I'm using from ActiveMerchant gem:</p>\n\n<p>From Controller:</p>\n\n<pre><code>def checkout    \nvalues = {:ip =&gt; request.remote_ip, \n          :return_url =&gt; confirm_paypal_url(@payment), \n          :cancel_return_url =&gt; root_url, :shipping =&gt; 0, \n          :handling =&gt; 0, :tax =&gt; 0, \n          :items =&gt; get_items(session[:cart])}\n\nresponse = @payment.setup_purchase(values)                         \nredirect_to @payment.redirect_url_for(response.token)   \nend    \n\n## CALL BACK\ndef paypal\n# session[:product_users] = [{:amount =&gt; '100', :email =&gt; 'xx@x.com'}]\nsession[:product_users].each do |user|\n  @payment = if user.last.nil?\n    @payment.purchase(:token =&gt; params[:token], :payer_id =&gt; params[:PayerID], :ip =&gt; request.remote_ip)\n  else\n    @payment.transfer(user[:amount], user[:email])        \n  end\n  @payment.save  \nend\n\nredirect_to billing_thank_you_url(@payment)  \nend\n</code></pre>\n\n<p>From Model:</p>\n\n<pre><code>def setup_purchase(options)\n  gateway.setup_purchase(amount * 100, options)\nend\n\ndef transfer(amount, receiver)\n response = gateway.transfer(amount * 100, receiver, :subject =&gt; \"Payment from XXX\")\nend\n</code></pre>\n\n<p>I'd be grateful if anyone help me on this.</p>\n\n<p>Thank You</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","rspec-rails","railstutorial.org"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12919835,"title":"How to test for successful password change?","body":"<p>I've put together a basic application with user authentication using <code>bcrypt-ruby</code> and <code>has_secure_password</code>. The result is essentially a barebones version of the application from the <a href=\"http://ruby.railstutorial.org\" rel=\"nofollow\">Rails Tutorial</a>. In other words, I have a RESTful user model as well as sign-in and sign-out functionality. </p>\n\n<p>As part of the tests for editing a user's information, I've written a test for changing a password. Whereas changing the password works just fine in the browser, my test below is not passing. </p>\n\n<pre><code>subject { page }\n\ndescribe \"successful password change\"\n  let(:new_password) { \"foobaz\" }\n  before do\n    fill_in \"Password\",               with: new_password\n    fill_in \"Password Confirmation\",  with: new_password\n    click_button \"Save changes\"\n  end\n\n  specify { user.reload.password.should == new_password }\nend\n</code></pre>\n\n<p>Clearly, I'm misunderstanding some basic detail here. </p>\n\n<p>In short:</p>\n\n<p>1) Why exactly is the code above not working? The change-password functionality works in the browser. Meanwhile, <code>rspec</code> continues to reload the old password in the last line above. And then the test fails.</p>\n\n<p>2) What is the better way to test the password change?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>With the initial password set to <code>foobar</code>, the error message is: </p>\n\n<pre><code>Failure/Error: specify { user.reload.password.should == new_password }\n   expected: \"foobaz\"\n        got: \"foobar\" (using ==)\n</code></pre>\n\n<p>Basically, it looks like the <code>before</code> block is not actually saving the new password.</p>\n\n<p>For reference, the related controller action is as follows:</p>\n\n<pre><code>def update\n  @user = User.find(params[:id])\n  if @user.update_attributes(params[:user])\n    flash[:success] = \"Profile Updated\"\n    sign_in @user\n    redirect_to root_path\n  else\n    render 'edit'\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","paperclip"],"answer_count":1,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":215,"score":3,"question_id":12791764,"title":"How to save a raw_data photo using paperclip","body":"<p>I'm using jpegcam to allow a user to take a webcam photo to set as their profile photo. This library ends up posting the raw data to the sever which I get in my rails controller like so: </p>\n\n<pre><code>def ajax_photo_upload\n  # Rails.logger.info request.raw_post\n  @user = User.find(current_user.id)\n  @user.picture = File.new(request.raw_post)\n</code></pre>\n\n<p>This does not work and paperclip/rails fails when you try to save request.raw_post.</p>\n\n<pre><code>Errno::ENOENT (No such file or directory - ????JFIF???\n</code></pre>\n\n<p>I've seen solutions that make a temporary file but I'd be curious to know if there is a way to get Paperclip to automatically save the request.raw_post w/o having to make a tempfile. Any elegant ideas or solutions out there?</p>\n\n<p><strong>UGLY SOLUTION (Requires a temp file)</strong></p>\n\n<pre><code>class ApiV1::UsersController &lt; ApiV1::APIController\n\n  def create\n    File.open(upload_path, 'w:ASCII-8BIT') do |f|\n      f.write request.raw_post\n    end\n    current_user.photo = File.open(upload_path)\n  end\n\n private\n\n  def upload_path # is used in upload and create\n    file_name = 'temp.jpg'\n    File.join(::Rails.root.to_s, 'public', 'temp', file_name)\n  end\n\nend\n</code></pre>\n\n<p>This is ugly as it requires a temporary file to be saved on the server. Tips on how to make this happen w/o the temporary file needing to be saved? Can StringIO be used?</p>\n"},{"tags":["ruby-on-rails-3","postgresql","heroku"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12926193,"title":"heroku pg:reset breaks everything","body":"<p>I was trying to reset the seed data in my heroku database for an app i'm building and the developer site from heroku says to use <code>heroku pg:reset DATABASE</code> to do so. </p>\n\n<p>After doing this and migrating my database again <code>heroku run rake db:migrate</code> followed by re-seeding with <code>heroku run rake db:seed</code> I cannot migrate any apps. even new ones. I don't know if a schema will help. It was not a database problem I was trying to fix, just a removal of repeated records.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sqlite","encoding"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":37,"score":1,"question_id":12926153,"title":"Why request.remote_ip.encoding is ASCII-8BIT?","body":"<p>The output of <code>&lt;%= request.remote_ip.encoding %&gt;</code> is <code>ASCII-8BIT</code>. </p>\n\n<p>When I store the <code>request.remote_ip</code> value in SQLite, there is a \"<a href=\"http://stackoverflow.com/questions/12912285/binary-data-inserted-for-string-type-on-column-remote-ip/\">Binary data inserted for <code>string</code> type on column 'remote_ip'</a>\" message.</p>\n\n<p>So, should I 'force_encoding' before storing in SQLite? Or, is there a config I can make <code>request.remote_ip</code> default to <code>UTF-8</code> (or maybe <code>ASCII-7BIT</code>)?</p>\n\n<pre><code>OS X Lion\nruby 1.9.3p194 \nRails 3.2.8\nsqlite3 (1.3.6)\nsqlite3-ruby (1.3.2)\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","json","ruby-on-rails-3.2","erb"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12925883,"title":"Rails erb Json view conditional rendering","body":"<p>When I try this, I get {a: 1, b:} for c not present. When c is present I get {a:1,b:1} which is right. But how can I hide the node b conditionally so that I could only get {a:1}?</p>\n\n<pre><code>{\"a\":   &lt;%= json @teams.count %&gt;\n,\"b\":   &lt;%= json @teams.num if @c.present? %&gt;}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","link-to","actioncontroller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12915685,"title":"Rails URL parameters not able to be used","body":"<p>I'm passing a <code>suggestion_id</code> parameter via <code>link_to</code> so that it can be saved as part of a <code>create</code> action in a different controller.</p>\n\n<pre><code>&lt;%= link_to \"I'm interested\", new_interested_path(:controller =&gt; :interested, \n    :suggestion_id =&gt; suggestion.id, :method =&gt; :get), :class =&gt; 'btn btn-mini' %&gt;\n</code></pre>\n\n<p>Here is the resultant URL: </p>\n\n<pre><code>http://localhost:3000/interesteds/new?controller=interested&amp;method=get&amp;suggestion_id=1\n</code></pre>\n\n<p>According to <a href=\"http://guides.rubyonrails.org/v2.3.11/action_controller_overview.html\" rel=\"nofollow\">this</a>, I should be able to use the following code to access the <code>suggestion_id</code> parameter in my create action in this other controller:</p>\n\n<pre><code>@interested.suggestion_id = params[:suggestion_id]\n</code></pre>\n\n<p>This is not true, however. Whenever an \"interested\" object is created the suggestion_id is nil. What gives and why can't I find documentation to help me with this? And don't tell me to look <a href=\"http://api.rubyonrails.org/classes/ActionController/Base.html\" rel=\"nofollow\">here</a> because I've already done that as well. It was not super helpful.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":4451,"score":1,"question_id":5919110,"title":"Rails 3 Tutorial 10.4.2 : NoMethodError undefined method `admin?' for nil:NilClass","body":"<p>i am doing and using for building my own authentication system, <a href=\"http://ruby.railstutorial.org/chapters/updating-showing-and-deleting-users#sec%3athe_destroy_action\" rel=\"nofollow\">the Michael Hartls Tutorial for Rails 3</a> and came to an issue while doing it. I completed the whole section of 10.4.2 but when i got to the end and ran the test i always get this one error. </p>\n\n<pre><code> 1) UsersController GET 'index' DELETE 'destroy' as a non-signed-in user should deny access\n     Failure/Error: delete :destroy, :id =&gt; @user\n     NoMethodError:\n       undefined method `admin?' for nil:NilClass\n     # ./app/controllers/users_controller.rb:68:in `admin_user'\n     # ./spec/controllers/users_controller_spec.rb:245:in `block (5 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>I think it has something to do with my users controller in the admin area:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n    before_filter :authenticate, :only =&gt; [:index,:show,:edit, :update]\n    before_filter :correct_user, :only =&gt; [:edit, :update]\n    before_filter :admin_user,   :only =&gt; :destroy\n        .\n        .\n        .\n        .\n        .\n    def destroy\n        User.find(params[:id]).destroy\n        flash[:success] = \"USER DELETED.\"\n        redirect_to users_path\n    end\n\n\n    private\n\n        def authenticate\n            deny_access unless signed_in?\n        end\n\n        def correct_user\n            @user = User.find(params[:id])\n            redirect_to(root_path) unless current_user?(@user)\n        end\n\n        def admin_user\n            redirect_to(root_path) unless current_user.admin?\n        end                \nend\n</code></pre>\n\n<p>What is the problem and how do i fix this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":61,"score":1,"question_id":12889204,"title":"Rails way of breaking down a large form into multiple steps?","body":"<blockquote>\n  <p><strong>Possible Duplicate:</strong><br>\n  <a href=\"http://stackoverflow.com/questions/3619551/what-is-the-best-way-to-structure-a-multi-page-form-to-create-and-edit-models-in\">What is the best way to structure a multi-page form to create and edit models in a database?</a>  </p>\n</blockquote>\n\n\n\n<p>Is there a \"Rails\" way of breaking down a large form for a model into multiple steps?</p>\n\n<p>For example, in my HR software, <code>User</code> model has many attributes such as experiences, educations, addresses etc. It would be overwhelming for the user to see all these forms in one page. I would like to break them into pieces and present them step by step instead. </p>\n\n<p>Is there a preferred way of doing this in Rails?</p>\n"},{"tags":["ruby-on-rails-3","datetime","timezone"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12923943,"title":"Rails 3.2.8 - How to handle Time zones?","body":"<p>I've participated the Rails Rumble this year and I found myself tangled by time zone issues.</p>\n\n<p>I uploaded my app in linode and I live in EST time zone or -4 to UTC.</p>\n\n<p>I have a model and it saves things by doing the following:</p>\n\n<pre><code>def self.processing_creation(user_id, home_id, chore_id)\n  registered_chore = RegisteredChore.where(\"DATE(created_at) = ?\", Date.today).find_by_user_id_and_home_id_and_chore_id(user_id, home_id, chore_id)\n  unless registered_chore\n    registered_chore = RegisteredChore.create(user_id: user_id, home_id: home_id, chore_id: chore_id, created_at: Time.zone.now)\n    user = registered_chore.user\n    user.add_one_chore_point\n  end\n  registered_chore\nend\n</code></pre>\n\n<p>RegisteredChore.where(\"DATE(created_at) = ?\", Date.today).find_by_user_id_and_home_id_and_chore_id(user_id, home_id, chore_id)</p>\n\n<p>returns false even if the data was just created. </p>\n\n<p>I noticed that \"create\" saves in UTC but Date.today uses user's local time zone. </p>\n\n<p>What's the best way to handle this?</p>\n\n<p>Another example to illustrate the issue:</p>\n\n<ol>\n<li>I want to register a chore at 11 PM in EST time.</li>\n<li>The server is already in the next day (e.g: 12).</li>\n<li>Rails saves the data in the next day date (12).</li>\n<li>But user is still in day 11.</li>\n<li>Technically, user with the current method, could save the entry again because the days are different from the db and user interface.</li>\n</ol>\n\n<p>How to solve this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12922099,"title":"rails Multiple models in a single file","body":"<p>I would know if there is a way to have two or model model classes in a single file.</p>\n\n<p>Here is a simple and very basic example:</p>\n\n<p>dia_actividad.rb</p>\n\n<pre><code>class DiaActividad &lt; ActiveRecord::Base\n\n    self.table_name =  \"dbo.DIAACTIVIDAD\"\n  self.primary_keys = :CASINO_ID, :DIAACTIVIDAD_ID\n\n  attr_accessible :CASINO_ID, :DIAACTIVIDAD_ID, :DFECHAHORAINICIO, :ESTADODIA_ID\n\n  belongs_to :dia_actividad_estado, :foreign_key =&gt; :ESTADODIA_ID\n\nend\n</code></pre>\n\n<p>dia_actividad_estado.rb</p>\n\n<pre><code>class DiaActividadEstado &lt; ActiveRecord::Base\n\n    self.table_name =  \"dbo.ESTADODIA\"\n  self.primary_key = :ESTADODIA_ID\n\n  attr_accessible :ESTADODIA_ID, :CESTADODIA\n\nend\n</code></pre>\n\n<p>I would like to have a file like this:</p>\n\n<pre><code>  class DiaActividad &lt; ActiveRecord::Base\n\n        self.table_name =  \"dbo.DIAACTIVIDAD\"\n      self.primary_keys = :CASINO_ID, :DIAACTIVIDAD_ID\n\n      attr_accessible :CASINO_ID, :DIAACTIVIDAD_ID, :DFECHAHORAINICIO, :ESTADODIA_ID\n\n      belongs_to :dia_actividad_estado, :foreign_key =&gt; :ESTADODIA_ID\n\n    end\n\n    class DiaActividadEstado &lt; ActiveRecord::Base\n\n        self.table_name =  \"dbo.ESTADODIA\"\n      self.primary_key = :ESTADODIA_ID\n\n      attr_accessible :ESTADODIA_ID, :CESTADODIA\n\n    end\n</code></pre>\n\n<p>The two classes in a single file. But i get uninitialized constant errors. When a i trying to make a reference DiaActividadEstado.</p>\n\n<p>Is there any way to do that?</p>\n\n<p>Thanks in advance</p>\n"},{"tags":["ruby-on-rails-3","forms","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12328783,"title":"How to get typeahead/autocomplete text to refer to foreign id in Rails?","body":"<p>So I have been working on getting this Twitter Bootstrap typeahead to work and right now I can get a list of all my data when I start typing it into the form, but when I submit, the values do not get passed in as IDs. Is there any way for me to pass in an id number based on the autocomplete selection?</p>\n\n<p>Here's the code I'm using...</p>\n\n<pre><code>  &lt;%= f.text_field :cargo_to_load_id, :data =&gt; { provide: \"typeahead\", source: Cargo.order(:name).map(&amp;:name) , items: \"9\" } %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","performance","passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12923373,"title":"Rails startup performance: how to trace and debug","body":"<p>Our Rails 3.2.8 app is taking around 30 seconds to load after restarting, with similar load time for <code>rails console</code> -- this is on an Amazon EC2 <code>m1.small</code> instance with Ubuntu 11, 64-bits.  The server seems perfectly suitable under load (we have several).  The startup time, which effectively occurs only after a deploy is a problem.</p>\n\n<p>Is there a way to get a timed trace of what is loading as the Rails instance loads?</p>\n"},{"tags":["ruby-on-rails-3","json","curl"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12923183,"title":"Post json to rails using curl without save?","body":"<p>I've managed to post data to my rails app using the following command:</p>\n\n<pre><code>curl -v -u apitest:apitest -H \"Accept: application/json\" -H \"Content-Type: \napplication/json\" -X POST -d '{\"user\":{\"name\":\"json_api_test_user\", \n\"email\":\"json_test@example.com\", \"password\":\"apitest\", \n\"password_confirmation\":\"apitest\"}}' localhost:3000/users\n</code></pre>\n\n<p>But I'd like to be able to confirm this works without actually saving the entry in the database (this way I can provide the command for testing without creating a new user every time we use it).  Is this possible?</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":127,"score":1,"question_id":7437789,"title":"Heroku doesn't set boolean field in rails app","body":"<p>It's passing the parameter as replacement_emails, which is correct. From the log:</p>\n\n<pre><code>Parameters: {\"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt; ... \"replacement_emails\"=&gt;\"1\"}, \"commit\"=&gt;\"submit\", \"id\"=&gt;\"1\"}\n</code></pre>\n\n<p>But it's not getting set in the database. No error message in the log, nothing. It works in development with SQLite.</p>\n\n<p>Any thoughts? On why it works in development but no in production on Heroku?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","strftime"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12921715,"title":"strftime is not recognizing american format in ruby on rails","body":"<p>I have a date coming in this format \"MM-DD-YYY\" from view and i want to save it in datetime format. \nI'm trying to convert to datetime format  using <code>strftime</code> but it is recognizing the date in \"DD-MM-YYYY\" format and therefore whenever my date exceeds 12 my code breaks.Please help.</p>\n\n<p>After debugging i found another issue,the date is not coming when the date exceeds 12,which means if the date is not in \"DD-MM-YYYY\"fomat, it is not shown in the controller.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","factory-girl"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2003,"score":5,"question_id":6913171,"title":"Rails 3.1, Factory girl bug","body":"<p>Fixed. There was a bug in Rails. See <a href=\"https://github.com/rails/rails/issues/2333\" rel=\"nofollow\">https://github.com/rails/rails/issues/2333</a></p>\n\n<p>I have a problem with Factory Girl Rails and Rails 3.1.0.rc5</p>\n\n<p>When I do more than once <code>user = FactoryGirl.create(:user)</code> I have an error.</p>\n\n<pre><code> Failure/Error: user = FactoryGirl.create(:user)\n NameError:\n   uninitialized constant User::User\n # ./app/models/user.rb:17:in `generate_token'\n # ./app/models/user.rb:4:in `block in &lt;class:User&gt;'\n # ./spec/requests/users_spec.rb:20:in `block (3 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>I can create as many user as I want using Factory but only in rails console. </p>\n\n<p>Tests:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe \"Users\" do\n\n  describe \"signin\" do\n\n    it \"should sign in a user\" do\n      visit root_path\n      user = FactoryGirl.create(:user)\n      within(\"div#sign_in_form\") do\n        fill_in \"Name\", with: user.name\n        fill_in \"Password\", with: user.password\n      end\n      click_button \"Sign in\"\n      current_path.should eq(user_path(user))\n      page.should have_content(\"signed in\")\n    end\n\n    it \"should not show new user form on /\" do\n      user = FactoryGirl.create(:user)\n          visit root_path\n      page.should_not have_css(\"div#new_user_form\")\n    end\n  end\nend\n</code></pre>\n\n<p>factories.rb</p>\n\n<pre><code>FactoryGirl.define do\n  factory :user do |f|\n    f.sequence(:name) { |n| \"john#{n}\" }\n    f.fullname  'Doe'\n    f.sequence(:email) { |n| \"test#{n}@example.com\" }\n    f.password 'foobar'\n  end\nend\n</code></pre>\n\n<p>model/user.rb</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_secure_password\n  attr_accessible :name, :fullname, :email, :password\n  before_create { generate_token(:auth_token) }\n\n  email_regex = /\\A[\\w+\\-.]+@[a-z\\d\\-.]+\\.[a-z]+\\z/i\n  validates :name, presence: true, length: { maximum: 20 },\n            uniqueness: { case_sensitive: false }\n  validates :fullname, presence: true, length: { maximum: 30 }\n  validates :email, format: { with: email_regex },\n            uniqueness: { case_sensitive: false }, length: { maximum: 30 }\n  validates :password, length: { in: 5..25 }\n\n  def generate_token(column)\n    begin\n      self[column] = SecureRandom.urlsafe_base64\n    end while User.exists?(column =&gt; self[column])\n  end\nend\n</code></pre>\n\n<p><code>User.exists?(column =&gt; self[column])</code> causes the problem. </p>\n"},{"tags":["ruby","ruby-on-rails-3","rubygems","shopify"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":108,"score":0,"question_id":12920956,"title":"Ruby error (Socket)","body":"<p>I am trying to install a ruby gem called shopify_theme which lets you locally push edits to the main folder of a shopify server using their api key.</p>\n\n<p>Whilst trying to download the theme to my hardrive via command line I got this error:</p>\n\n<pre><code>/Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:762:in `initialize': getaddrinfo: nodename nor servname provided, or not known (SocketError)\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:762:in `open'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:762:in `block in connect'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/timeout.rb:54:in `timeout'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/timeout.rb:99:in `timeout'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:762:in `connect'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:755:in `do_start'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:744:in `start'\nfrom /Users/mdunbavan/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/net/http.rb:1284:in `request'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/httparty-0.9.0/lib/httparty/request.rb:81:in `perform'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/httparty-0.9.0/lib/httparty.rb:438:in `perform_request'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/httparty-0.9.0/lib/httparty.rb:385:in `get'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/shopify_theme-0.0.7/lib/shopify_theme.rb:10:in `asset_list'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/shopify_theme-0.0.7/lib/shopify_theme/cli.rb:30:in `download'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/task.rb:27:in `run'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:120:in `invoke_task'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor.rb:275:in `dispatch'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/base.rb:425:in `start'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/gems/shopify_theme-0.0.7/bin/theme:24:in `&lt;top (required)&gt;'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/bin/theme:19:in `load'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/bin/theme:19:in `&lt;main&gt;'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'\nfrom /Users/mdunbavan/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `&lt;main&gt;'\n</code></pre>\n\n<p>Are there any ruby experts out there that would happen to know what this error is and how I could go about it in a different manner?</p>\n\n<p>Cheers,\nMark</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12922497,"title":"Specify a route without subdomains","body":"<p>I'm running Rails 3.0.17.\nI currently have the following defined in my routes:</p>\n\n<pre><code>constraints :subdomain =&gt; \"\" do\n    get 'faq'     =&gt; 'static_pages#faq'\nend\n</code></pre>\n\n<p>The problem is that it allows any faq url with a subdomain (e.g. anysubdomain.mypage.com/faq)to route to the faq page when I only want the url without a subdomain (mypage.com/faq) to route to the faq page.</p>\n\n<p>Any tips/insights?</p>\n\n<p>Thank you in advance.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":57,"score":0,"question_id":12922064,"title":"Tips for debugging ruby on rails code flow","body":"<p>I'm having hard time debugging the flow of the  code on \"Ruby on Rails\". Please give me some tips. I'm new to \"Ruby on rails\". Like in php we use <code>var_dump,print_r and die</code>, just to check where the data has reached.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","routing","subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":10341331,"title":"Is there a way to specify a default subdomain in Rail's named routes?","body":"<p>I'm working with subdomains in my Rails 3.2 app where request.subdomain is meaningful and is used to populate an Account resource.</p>\n\n<p>A default behavior I expected of named routes was that regardless of what subdomain I was at, a named route would always use 'www' before hostname unless I used the subdomain option.</p>\n\n<p>Example, if I were at <a href=\"http://www.example.com/path/to/something\" rel=\"nofollow\">http://www.example.com/path/to/something</a>, the following is true:</p>\n\n<pre><code>root_url                          # http://www.example.com/\nroot_url(subdomain: 'subdomain')  # http://subdomain.example.com/ \n</code></pre>\n\n<p>Even though it makes sense what I didn't exact was that if I were at <a href=\"http://subdomain.example.com/path/to/something\" rel=\"nofollow\">http://subdomain.example.com/path/to/something</a>, the following would be the case:</p>\n\n<pre><code>root_url                          # http://subdomain.example.com/\n</code></pre>\n\n<p>This is fine, but a lot of my controller redirects and view helper links are for urls outside of my subdomain constraint which omits 'www' and ''. So I really don't want to have new_session_url(subdomain: 'www'), thing_url(subdomain: 'www') and etc. all over my application. </p>\n\n<p>Is there a way to have named routes default to 'www' if no subdomain option is passed in, regardless of what the current subdomain is? </p>\n"},{"tags":["ruby-on-rails-3","activerecord","rspec","polymorphic-associations","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12903703,"title":"Mass assignment error in polymorphic favourite model setup","body":"<p>I am trying to adding favouriting to my app so that users can select favourite projects.</p>\n\n<p>I have tried to use the code that I found here: <a href=\"http://snippets.aktagon.com/snippets/588-How-to-implement-favorites-in-Rails-with-polymorphic-associations\" rel=\"nofollow\">http://snippets.aktagon.com/snippets/588-How-to-implement-favorites-in-Rails-with-polymorphic-associations</a></p>\n\n<p>Here's my current situation:</p>\n\n<p><strong>user.rb</strong></p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  has_many :projects\n  has_many :favourites\n  has_many :favourite_projects, :through =&gt;  :favourites, :source =&gt; :favourable, :source_type =&gt; \"Project\"\nend\n</code></pre>\n\n<p><strong>project.rb</strong></p>\n\n<pre><code>class Project &lt; ActiveRecord::Base\n  belongs_to :user\n  has_many :tasks\n  accepts_nested_attributes_for :tasks\n  has_many :favourites, :as =&gt; :favourable\n  has_many :fans, :through =&gt; :favourites, :source =&gt; :user\nend\n</code></pre>\n\n<p><strong>task.rb</strong></p>\n\n<pre><code>class Task &lt; ActiveRecord::Base\n  belongs_to :project\nend\n</code></pre>\n\n<p><strong>favourite.rb</strong></p>\n\n<pre><code>class Favourite &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :favourable, :polymorphic =&gt; true\n  attr_accessible :user, :favourable\nend\n</code></pre>\n\n<p><strong>favourite_spec.rb</strong></p>\n\n<pre><code>require 'spec_helper'\n\ndescribe Favourite do\n  let(:user) { FactoryGirl.create(:user) }\n  let(:project) { FactoryGirl.create(:project_with_task) }\n  let(:favourite_project) do\n    user.favourite_projects.build(favourable: project.id)\n  end\n\n  subject { favourite_project }\n\n  it { should be_valid }\n\n  describe \"accessible attributes\" do\n    it \"should not allow access to user_id\" do\n      expect do\n        Favourite.new(user_id: user.id)\n      end.to raise_error(ActiveModel::MassAssignmentSecurity::Error)\n    end\n  end\n\nend\n</code></pre>\n\n<p>When I run the test though, the user_id test passes but I get the following for <code>it { should be_valid }</code>:</p>\n\n<pre><code>Failure/Error: user.favourite_projects.build(favourable: project.id)\n     ActiveModel::MassAssignmentSecurity::Error:\n       Can't mass-assign protected attributes: favourable\n</code></pre>\n\n<p>Am I doing something wrong in my test? </p>\n\n<p>Or the way I am calling <code>.build</code>? </p>\n\n<p>Or in the <code>attr_accessible</code> on the Favourite model?</p>\n\n<p>Hope someone can help!</p>\n"},{"tags":["ruby-on-rails-3","activerecord","associations"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":37,"score":1,"question_id":12920848,"title":"What's the right way to query multiple associations in Rails?","body":"<p>My application models a writing competition, with <code>Users</code>, <code>Stories</code>, <code>Competitions</code> and <code>Submissions</code>.</p>\n\n<p>Users can participate in competitions through submissions, or as owners. I'd like one query or method that returns all competitions owned or participated in by a user. I've got a method returning those as an array, <code>competitions | owned_competitions</code>, but I'd really like to keep them ActiveRecord entities so I can chain, apply scopes, etc.</p>\n\n<p>Is there a way to do that, or a better way to setup these relationships?</p>\n\n<p>My models look like this:</p>\n\n<p>user.rb:</p>\n\n<pre><code>has_many :stories\nhas_many :submissions\nhas_many :competitions, :through =&gt; :submissions\nhas_many :owned_competitions, :class_name =&gt; \"Competition\"\n</code></pre>\n\n<p>story.rb:</p>\n\n<pre><code>belongs_to :user\nhas_many :submissions\nhas_many :competitions, :through =&gt; :submissions\n</code></pre>\n\n<p>competition.rb:</p>\n\n<pre><code>belongs_to :owner, :class_name =&gt; \"User\", :foreign_key =&gt; 'user_id'\nhas_many :submissions\nhas_many :competitors, :through =&gt; :submissions, :source =&gt; :user\nhas_many :stories, :through =&gt; :submissions\n\nscope :expiring_today, lambda { where(\"deadline = ?\", Date.today) }\n</code></pre>\n\n<p>submission.rb:</p>\n\n<pre><code>belongs_to :user\nbelongs_to :story\nbelongs_to :competition\n</code></pre>\n"},{"tags":["ruby-on-rails-3","deployment","capistrano","asset-pipeline","precompile"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":83,"score":0,"question_id":12919509,"title":"Capistrano deploy assets precompile never compiles assets, why?","body":"<p><strong>Using deploy.rb to precompile rails assets only when they change, this task is always skipping the compile of my assets :(</strong></p>\n\n<pre><code>namespace :assets do\n  task :precompile, :roles =&gt; :web, :except =&gt; {:no_release =&gt; true} do\n    from = source.next_revision(current_revision)\n    if capture(\"cd #{latest_release} &amp;&amp; #{source.local.log(from)} vendor/assets/ app/assets/ | wc -l\").to_i &gt; 0\n      run %Q{cd #{latest_release} &amp;&amp; #{rake} RAILS_ENV=#{rails_env} #{asset_env} assets:precompile}\n    else\n      logger.info \"Skipping asset pre-compilation because there were no asset changes\"\n    end\n  end\nend\n</code></pre>\n\n<p>What could causing this complete task not compiling? It always thinks there are no asset changes and throws that message. </p>\n\n<p>I also never really understanded the task, for example what does below source.log.local refer to?</p>\n\n<pre><code>source.local.log\n</code></pre>\n\n<p>Anyone could clarify what the task commands do and has some pointers why it never sees any asset changes? Thank you</p>\n"},{"tags":["ruby-on-rails","ruby","arrays","ruby-on-rails-3","mongoid"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":34,"score":1,"question_id":12920840,"title":"most efficient solution for this array ruby and mongoid","body":"<p>My question is:</p>\n\n<p><strong>is there some most efficient solution for this code in ruby on rails and mongoid odm?</strong></p>\n\n<pre><code>messages_without_responses = Message.all.select{|message| message.sender == current_user || message.receiver == current_user}\nmessages = Array.new\nmessages_without_responses.each do |m|\n  if m.message_responses.count &gt; 0 \n   messages &lt;&lt; m\n  else\n   messages &lt;&lt; m if m.receiver_id == current_user.id &amp;&amp; m.place_receiver == \"inbox\"\n  end\nend\n</code></pre>\n\n<p>Thank you very much!</p>\n"},{"tags":["ruby","ruby-on-rails-3","unobtrusive-javascript","infinite-scroll","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":340,"score":0,"question_id":10166040,"title":"Getting Infinite Scroll and link_to_next_page working with Kaminari on Rails 3.2","body":"<p>I've got infinite scroll working via Kaminari per the <a href=\"https://github.com/amatsuda/kaminari/wiki/How-To%3a-Create-Infinite-Scrolling-with-jQuery\" rel=\"nofollow\">wiki</a> in a rails 3.2 app, and wanted to add a \"more\" button. </p>\n\n<p>The link_to_next_page helper is great, but what's the best way to share page number across the two approaches? </p>\n\n<p>Right now, everything works except that loading the second page of data via the button doesn't increment the page variable I'm using in the javascript to track which page to load for infinite scroll.</p>\n\n<p>What's the best approach to sharing state across the two methods?</p>\n\n<p>Other relevant information:</p>\n\n<ul>\n<li>each page is rendering a partial with a bunch of <code>li</code>s and appending it to a <code>ul</code></li>\n<li>the 'more' button is rerendered on each ajax request</li>\n</ul>\n"},{"tags":["ruby-on-rails-3","heroku","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12920559,"title":"Twitter-bootstrap-rails does not seem to load some default bootstrap css","body":"<p>I'm using <code>gem 'twitter-bootstrap-rails, '2.1.4'</code> for a project.  Rails 3.2.6</p>\n\n<p>I first noticed a problem when deploying to heroku, but I also have the problem on my local machine.  It seems some of the twitter defaults are not being loaded.  For example, the navbar is white instead of the default dark gray/black.  The fonts are bigger than bootstrap's defaults.</p>\n\n<p>Here's what the navbar looks like, even though I never changed bootstrap's default navbar colors.\n<img src=\"http://i.stack.imgur.com/mQsU6.png\" alt=\"enter image description here\"></p>\n\n<p>I have my assets set up this way:</p>\n\n<p><img src=\"http://i.stack.imgur.com/CWSue.png\" alt=\"enter image description here\"></p>\n\n<p>An <code>application controller</code> method determines which layout to use which then loads either <code>application.css</code> or <code>blog_admin.css</code> because the admin layout is different from the regular site layout.</p>\n\n<pre><code>application.css\n /*\n *= require_self\n *= require_tree ./application\n */\n\nblog_admin.css\n /*\n *= require_self\n *= require_tree ./blog_admin\n */\n</code></pre>\n\n<p>Each directory, <code>application</code> and <code>blog_admin</code> have a <code>bootstrap_and_overrides.css.less</code>.</p>\n\n<p>What's even stranger is on my laptop, the styling is correct in the dev environment.  On my iMac, it's not and has missing styling.  When deployed to Heroku, it always has missing styling, even if deployed from my laptop which has the correct styling in the dev environment.</p>\n\n<p>Any idea what could be going wrong?  If it's just not finding bootstrap's default variables, how can I ensure that they're loading?</p>\n\n<p>This is also a tough one to debug, so any advice there would also be appreciated.</p>\n"},{"tags":["ruby","ruby-on-rails-3","activerecord","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":42,"score":1,"question_id":12919905,"title":"ActiveRecord to_json specifying options for included methods","body":"<p>I've got the following to_json in my view:\n<code>&lt;%=raw @forums.to_json(:methods =&gt; [:topic_count, :last_post]) %&gt;;</code></p>\n\n<p>and in the model I've got the following method:</p>\n\n<pre><code>def last_post\n    post = ForumPost.joins(:forum_topic).where(:forum_topics =&gt; {:forum_id =&gt; self.id}).order(\"forum_posts.created_at DESC\").first\n    return post\nend\n</code></pre>\n\n<p>However ForumPost contains a relation to a ForumTopic (<code>belongs_to :forum_topic</code>) and I want to include this ForumTopic in my json so I end up with {..., \"last_post\":{..., \"forum_topic\":{...}...}, ...}. How can I accomplish this?</p>\n"},{"tags":["ruby-on-rails-3","apache","centos","phusion-passenger"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12920175,"title":"setting up passenger: keeps showing apache default page instead","body":"<p>I am trying to get passenger to work but i keep seeing the apache default page instead. I am using centos 6.3 on an inmotion VPS. Here is what I've done so far:</p>\n\n<ol>\n<li>gem install passenger. </li>\n<li>rvmsudo passenger-install-apache2-module</li>\n<li><p>pasted the following code into /usr/local/apache/conf/includes/post_virtualhost_global.conf (this gets loaded into httpd.conf)</p>\n\n<p><code>LoadModule passenger_module /home/username/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.17/ext/apache2/mod_passenger.so\nPassengerRoot /home/username/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.17\nPassengerRuby /home/username/.rvm/wrappers/ruby-1.9.3-p194/ruby</code></p>\n\n<p><code>&lt;VirtualHost 123.123.123.123:80&gt;\n    ServerName http://XXXXXX.inmotionhosting.com\n    # !!! Be sure to point DocumentRoot to 'public'!\n    DocumentRoot /home/username/rails/current/public\n    &lt;Directory /home/username/rails/current/public&gt;\n       # This relaxes Apache security settings.\n       AllowOverride all\n       # MultiViews must be turned off.\n       Options -MultiViews\n    &lt;/Directory&gt;\n&lt;/VirtualHost&gt;</code> </p>\n\n<p>edit: not sure why this isnt formatting properly. its lined and tabbed fine in the text editor. </p></li>\n<li><p>in etc/hosts there is the line:</p>\n\n<p><code>123.123.123.123 XXXXXX.inmotionhosting.com XXXXXX</code></p></li>\n<li><p>i restarted apache via sudo service httpd restart in /etc/init.d</p></li>\n<li>still shows apache default page</li>\n</ol>\n\n<p>Any ideas? thanks</p>\n"},{"tags":["ruby-on-rails","ajax","ruby-on-rails-3","json","instagram"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12918432,"title":"Instagram: untagging photo removal","body":"<p>We're using the Instagram API to fetch a list of photos tagged with a certain hashtag and displayed in real-time. Building this using Rails.</p>\n\n<p>Our problem: How do I construct a query that removes the photos from my displayed fetch when the user untags the photos without refreshing the browser?</p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":3,"favorite_count":5,"up_vote_count":13,"down_vote_count":0,"view_count":6280,"score":13,"question_id":8361475,"title":"Heroku push rejected, no Cedar-supported app detected","body":"<p>Rails app, Rails 3.1.3</p>\n\n<pre><code>git init\ngit remote add heroku &lt;my heroku repo&gt;\ngit add .\ngit commit -a -m \"First commit\"\ngit push heroku master\n</code></pre>\n\n<p>Got:</p>\n\n<pre><code>Counting objects: 102, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (86/86), done.\nWriting objects: 100% (102/102), 315.47 KiB, done.\nTotal 102 (delta 3), reused 0 (delta 0)\n\n**-----&gt; Heroku receiving push\n !     Heroku push rejected, no Cedar-supported app detected**\n\nTo git@heroku.com:electric-dusk-3217.git\n ! [remote rejected] master -&gt; master (pre-receive hook declined)\nerror: failed to push some refs to &lt;my heroku rep&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":44,"score":0,"question_id":12862540,"title":"Rails 3 Error when using OR with a where clause","body":"<p>I'm having a strange issue when using the Where clause in Rails. I imagine it has something to do with my OR operator syntax.  Here is my query:</p>\n\n<pre><code>  Cookie.where(\"ID = ? OR ID = ? OR ID = ? OR ID = ?\", chocolate.to_s, sugar.to_s, peanut_butter.to_s, oatmeal.to_s)\n</code></pre>\n\n<p>When I attempt to execute the query my application just hangs endlessly. However, If I submit a query that looks like this:</p>\n\n<pre><code>  Cookie.where(\"ID = ?\", chocolate.to_s)\n</code></pre>\n\n<p>I get the expected result. Any help with the proper format to this where clause would be greatly appreciated.  Thanks.</p>\n\n<p><strong>UPDATE</strong>\nI went into the rails console and did as you suggested. This was the result:</p>\n\n<pre><code>  SELECT \\\"TBLCookies\\\".* FROM \\\"TBLCookies\\\"  WHERE (ID in ('4','3','2','1'))\n</code></pre>\n\n<p>This seems correct.  I opened up SQL Developer, pasted this query in, and ran it.  I got the expected result. So everything seems to be fine there.  However, when I try to run the query in the rails console I get nothing back.  The console just hangs indefinitely.  Any insight into what could be going wrong would be great.</p>\n"},{"tags":["ruby-on-rails-3","arguments","basic-authentication","savon"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":57,"score":-1,"question_id":12919015,"title":"Rails Savon with Authentication, Data Source Key, and one or more Argument","body":"<p>I am making a Rails App using Savon with Authentication, a Data Source Key, and one or more Arguments. I have searched high and low for the answer. I am a noob when it comes to Web Services, although I do pretty good in VB.net.</p>\n\n<pre><code>    Pull Request :\n        &lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:dat=\"http://www.blahblah.com/DataSource\"&gt;\n          &lt;soapenv:Header/&gt;\n          &lt;soapenv:Body&gt;\n            &lt;dat:ExecuteDataSource&gt;\n              &lt;dat:ExecuteDataSourceRequest&gt;\n                &lt;dat:DataSourceKey&gt;201999&lt;/dat:DataSourceKey&gt;\n                &lt;dat:InputParameters&gt;\n                  &lt;dat:InputParameter&gt;\n                    &lt;dat:Value&gt;28376D&lt;/dat:Value&gt;\n                    &lt;dat:Name&gt;@Num_No&lt;/dat:Name&gt;\n                  &lt;/dat:InputParameter&gt;\n                &lt;/dat:InputParameters&gt;\n              &lt;/dat:ExecuteDataSourceRequest&gt;\n            &lt;/dat:ExecuteDataSource&gt;\n          &lt;/soapenv:Body&gt;\n        &lt;/soapenv:Envelope&gt;\n\nPull Response :\n        &lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n          &lt;soap:Body&gt;\n            &lt;ExecuteDataSourceResponse xmlns=\"http://www.blahblah.com/DataSource\"&gt;\n              &lt;ExecuteDataSourceResult&gt;\n                &lt;StatusNo&gt;0&lt;/StatusNo&gt;\n                &lt;Error&gt;false&lt;/Error&gt;\n                &lt;ErrorNo&gt;1&lt;/ErrorNo&gt;\n                &lt;Message&gt;Success&lt;/Message&gt;\n                &lt;InstanceNo&gt;0101012&lt;/InstanceNo&gt;\n                &lt;DataSourceKey&gt;201999&lt;/DataSourceKey&gt;\n                &lt;QuarantinedForDevelopment xsi:nil=\"true\"/&gt;\n                &lt;LastPrimaryDeployment xsi:nil=\"true\"/&gt;\n                &lt;LastTestDeployment xsi:nil=\"true\"/&gt;\n                &lt;Version xsi:nil=\"true\"/&gt;\n                &lt;DataSourceName&gt;This is the DS Name&lt;/DataSourceName&gt;\n                &lt;ResultSets&gt;\n                  &lt;ResultSet&gt;\n                    &lt;RowCount&gt;1&lt;/RowCount&gt;\n                    &lt;Rows&gt;\n                      &lt;Row&gt;\n                        &lt;Columns&gt;\n                          &lt;Column&gt;\n                            &lt;Value&gt;H02345&lt;/Value&gt;\n                            &lt;Name&gt;Hop_No&lt;/Name&gt;\n                          &lt;/Column&gt;\n                          &lt;Column&gt;\n                            &lt;Value&gt;South-12&lt;/Value&gt;\n                            &lt;Name&gt;Location&lt;/Name&gt;\n                          &lt;/Column&gt;\n                          &lt;Column&gt;\n                            &lt;Value&gt;OK&lt;/Value&gt;\n                            &lt;Name&gt;Container_Status&lt;/Name&gt;\n                          &lt;/Column&gt;\n                          &lt;Column&gt;\n                            &lt;Value&gt;JX14&lt;/Value&gt;\n                            &lt;Name&gt;Bin&lt;/Name&gt;\n                          &lt;/Column&gt;\n                        &lt;/Columns&gt;\n                      &lt;/Row&gt;\n                    &lt;/Rows&gt;\n                  &lt;/ResultSet&gt;\n                &lt;/ResultSets&gt;\n                &lt;OutputParameters&gt;\n                  &lt;OutputParameter&gt;\n                    &lt;Value&gt;False&lt;/Value&gt;\n                    &lt;Name&gt;@Result_Error&lt;/Name&gt;\n                  &lt;/OutputParameter&gt;\n                  &lt;OutputParameter&gt;\n                    &lt;Value&gt;1&lt;/Value&gt;\n                    &lt;Name&gt;@Result_Code&lt;/Name&gt;\n                  &lt;/OutputParameter&gt;\n                  &lt;OutputParameter&gt;\n                    &lt;Value&gt;Success&lt;/Value&gt;\n                    &lt;Name&gt;@Result_Message&lt;/Name&gt;\n                  &lt;/OutputParameter&gt;\n                &lt;/OutputParameters&gt;\n              &lt;/ExecuteDataSourceResult&gt;\n            &lt;/ExecuteDataSourceResponse&gt;\n          &lt;/soap:Body&gt;\n        &lt;/soap:Envelope&gt;\n\n\n\n        client = Savon::Client.new do\n          http.auth.ssl.cert_key_file = '201999'\n          http.auth.ssl.cert_key_username = 'user'\n          http.auth.ssl.cert_key_password = 'C3rtP@ssw0rd'\n          http.auth.ssl.verify_mode = :none\n          http.read_timeout = 90\n          http.open_timeout = 90\n          http.headers = { \"Accept-Encoding\" =&gt; \"gzip, deflate\", \"Connection\" =&gt; \"Keep-Alive\" }\n          http.body = {\"Value\" =&gt; \"28376D\", \"Name\" =&gt; \"Num_No\" }\n        end\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","jquery-ui","autocomplete"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12918875,"title":"jQueryUI - issue with autocomplete, 'PAGE_UP' error","body":"<p>At my Ruby on Rails app I was using simple autocomplete field. After some period of time without any reason it stopped to working, Couple of months ago everything was OK.</p>\n\n<p>Error from Google Chrome console:</p>\n\n<pre><code>Uncaught TypeError: Cannot read property 'PAGE_UP' of undefined\n</code></pre>\n\n<p>The way I'm including js/css libraries:</p>\n\n<pre><code>&lt;script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script src=\"http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.22/jquery-ui.min.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p></p>\n\n<p>JS:</p>\n\n<pre><code>        $('#game_title').autocomplete({\n            source: \"/ajax/games\",\n            select: function( event, ui ) {\n                    $(\"#game_id\").val(ui.item.id)\n                    }\n    });\n</code></pre>\n\n<p>JSON output for term=Knight:</p>\n\n<pre><code>[{\"label\":\"Knight Online\",\"title\":\"Knight Online\",\"id\":39},{\"label\":\"BattleKnight\",\"title\":\"BattleKnight\",\"id\":558},{\"label\":\"Remnat Knights\",\"title\":\"Remnat Knights\",\"id\":2088},{\"label\":\"Spiral Knights\",\"title\":\"Spiral Knights\",\"id\":2113},{\"label\":\"Knight Age\",\"title\":\"Knight Age\",\"id\":2466}]\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms","checkboxes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12916934,"title":"Looping through a list of checkboxes array to insert multiple record in ruby on rails 3.1 in controller","body":"<p>I have a list of check boxes created with <code>check_box_tag</code> (<code>&lt;%= check_box_tag \"user_ids[]\", user.id %&gt;</code>).\nNow i want to loop through all the check-boxes based on users_ids in controller and insert data of all the users selected.</p>\n"},{"tags":["ruby-on-rails-3","has-many-through"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12918499,"title":"Rails 3 - WARNING: Can't mass-assign protected attributes: user_ids","body":"<p>I have a has_many through relationship between Course and User.</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  belongs_to :user\n\n  has_many :enrollments, :dependent =&gt; :delete_all\n  has_many :users, :through =&gt; :enrollments\n\n  attr_accessible :description, :duration, :name, :prerequisites, :short_name, :start_date, :user_id\n\n  accepts_nested_attributes_for :users, :allow_destroy =&gt; true\n  attr_accessible :users_attributes\n</code></pre>\n\n<p>and User:</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n\nhas_many :subjects, :class_name =&gt; \"Course\"  # to get this call user.subjects\nhas_many :enrollments, :dependent =&gt; :delete_all\nhas_many :courses, :through =&gt; :enrollments\n</code></pre>\n\n<p>and Enrollment:</p>\n\n<pre><code>class Enrollment &lt; ActiveRecord::Base\n\nbelongs_to :course\nbelongs_to :user\n\nattr_accessible :course_id, :user_id\n\nend\n</code></pre>\n\n<p>Now I'm trying to set user_ids from inside Course, using a nested form. It keeps giving me that Mass Assignment warning, and nothing is saved. I read I was supposed to add attr_accessible user_id but it still doesn't work.</p>\n\n<p>Even if I do something like this from the rails console:</p>\n\n<pre><code>@c.update_attributes({:user_ids =&gt; [7,8]})\n</code></pre>\n\n<p>with @c being the course</p>\n\n<p>Any help would be greatly appreciated,\nThank you.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","cookies"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12918167,"title":"Force Rails cookie to send for any kind of connection (secure/nonsecure)","body":"<p>I'm setting a cookie in the browser like so:</p>\n\n<pre><code>def set_browser_cookie\n  cookies.permanent[:ignore_stats_cookie] = {\n    :value =&gt; STAT_COOKIE,\n    :domain =&gt; :all,\n    :secure =&gt; false,\n    :httponly =&gt; false\n  }\n  redirect_to settings_path\nend\n</code></pre>\n\n<p>When I look at the cookie in Chrome in DEVELOPMENT, the cookie allows for any kind of connection.</p>\n\n<p><img src=\"http://i.stack.imgur.com/6rIXs.jpg\" alt=\"localhost\"></p>\n\n<p>When I look at the cookie in Chrome in PRODUCTION, the cookie is only allowing secure connections (the app itself is https).</p>\n\n<p><img src=\"http://i.stack.imgur.com/oZDWT.jpg\" alt=\"production\"></p>\n\n<p>I'm setting the cookie to <code>:secure =&gt; false,</code> so why is the cookie being set for secure connections only in production?</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","production-environment"],"answer_count":1,"favorite_count":2,"up_vote_count":1,"down_vote_count":0,"view_count":72,"score":1,"question_id":12905013,"title":"bootstrap-rails gem production error","body":"<p>Hi I have a basic devise signup form using twitter bootstrap that I am trying launch into production. It works fine in development. There is a problem with the bootstrap assets in production. </p>\n\n<p>I have tried it without the group => assets, and the:git => ... part but it still does not work. </p>\n\n<p>When I have </p>\n\n<pre><code>config.assets.compile = true\n</code></pre>\n\n<p>The site loads without the bootstrap styling. when it is set to false, I get an error = We're sorry, but something went wrong.</p>\n\n<p>this is the gem I am using: </p>\n\n<pre><code>gem 'twitter-bootstrap-rails', :group =&gt; :assets, :git =&gt; 'http://github.com/seyhunak/twitter-bootstrap-rails.git': \n</code></pre>\n\n<p>My production.log: </p>\n\n<p>Processing by HomeController#index as HTML</p>\n\n<pre><code>    Rendered home/index.html.erb within layouts/application (21.8ms)\nCompiled bootstrap_and_overrides.css  (916ms)  (pid 31389)\nCompiled home.css  (1ms)  (pid 31389)\nCompiled application.css  (1209ms)  (pid 31389)\nCompiled jquery.js  (5ms)  (pid 31389)\nCompiled jquery_ujs.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-transition.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-alert.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-modal.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-dropdown.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-scrollspy.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-tab.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-tooltip.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-popover.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-button.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-collapse.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-carousel.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-typeahead.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap/bootstrap-affix.js  (0ms)  (pid 31389)\nCompiled twitter/bootstrap.js  (211ms)  (pid 31389)\nCompiled home.js  (136ms)  (pid 31389)\nCompiled application.js  (426ms)  (pid 31389)\n  Rendered layouts/_navigation.html.erb (1.7ms)\n  Rendered layouts/_messages.html.erb (0.4ms)\nCompleted 200 OK in 5535ms (Views: 5520.6ms | ActiveRecord: 12.9ms)\n\n\nStarted GET \"/users/sign_in\" for  at 2012-10-15 14:57:24 -0400\nProcessing by Devise::SessionsController#new as HTML\n  Rendered devise/shared/_links.html.erb (2.1ms)\n  Rendered devise/sessions/new.html.erb within layouts/application (213.0ms)\n  Rendered layouts/_navigation.html.erb (1.7ms)\n  Rendered layouts/_messages.html.erb (0.6ms)\nCompleted 200 OK in 337ms (Views: 295.6ms | ActiveRecord: 11.8ms)\n\n\nStarted GET \"/users/sign_in\" fo at 2012-10-15 15:38:17 -0400\nProcessing by Devise::SessionsController#new as HTML\n  Rendered devise/shared/_links.html.erb (2.0ms)\n  Rendered devise/sessions/new.html.erb within layouts/application (211.1ms)\nCompiled bootstrap_and_overrides.css  (871ms)  (pid 415)\nCompiled home.css  (1ms)  (pid 415)\nCompiled application.css  (1199ms)  (pid 415)\nCompiled jquery.js  (5ms)  (pid 415)\nCompiled jquery_ujs.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-transition.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-alert.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-modal.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-dropdown.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-scrollspy.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-tab.js  (0ms)  (pid 415)\nCompiled twitter/bootstrap/bootstrap-tooltip.js  (0ms)  (pid 415)\n\"production.log\" 755L, 39196C\n</code></pre>\n\n<p>I'm running a linode ubunto 10.04 lts server, nginx, unicorn and deploying with capistrano</p>\n\n<p>I've been trying to solve this issue for a couple of days. Your help is much appreciated. thanks in advance. </p>\n"},{"tags":["ruby-on-rails-3","rubygems","filepicker.io"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":12762581,"title":"Using filepicker-rails gem, how can I show my users a confirmation that their avatar has been succesfully uploaded?","body":"<p>After uploading an avatar with filepicker.io (filepicker-rails gem) I don't receive any confirmation that it was accepted by the filepicker server.  Anyone know a trick to show my users that their avatar has been uploaded and they can continue filling out their profile form?</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3"],"answer_count":2,"favorite_count":3,"up_vote_count":13,"down_vote_count":0,"view_count":6085,"score":13,"question_id":4224600,"title":"Can you do greater than comparison on a date in a Rails 3 search?","body":"<p>I have this search in Rails 3:</p>\n\n<pre><code>Note.where(:user_id =&gt; current_user.id, :notetype =&gt; p[:note_type], :date =&gt; p[:date]).order('date ASC, created_at ASC')\n</code></pre>\n\n<p>But I need the <code>:date =&gt; p[:date]</code> condition to be equivilent to <code>:date &gt; p[:date]</code>. How can I do this? Thanks for reading.</p>\n"},{"tags":["ruby-on-rails-3","rspec"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":41,"score":2,"question_id":12915641,"title":"my rspec example is passing even though I would expect it to fail","body":"<p>I can't figure out why my 2nd example is passing even though it should be failing</p>\n\n<p>this is my person_spec.rb:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe Person do\n  it \"must have a first name\" do\n    subject { Person.new(first_name: \"\", last_name: \"Kowalski\") }\n    subject.should_not be_valid\n  end\n\n  it \"must have a last name\" do\n    subject { Person.new(first_name: \"Jan\") }\n    subject.should_not be_valid\n  end\nend\n</code></pre>\n\n<p>this is my person.rb</p>\n\n<pre><code>class Person &lt; ActiveRecord::Base\n  attr_accessible :first_name, :last_name\n\n  validates :first_name, presence: true\n\n  def full_name\n    return \"#{@first_name}  #{@last_name}\"\n  end\nend\n</code></pre>\n\n<p>My rspec output:</p>\n\n<pre><code>Person\n  must have a last name\n  must have a first name\n\nFinished in 0.09501 seconds\n2 examples, 0 failures\n\nRandomized with seed 51711\n</code></pre>\n\n<p>What is even worse is that my further examples are failing/passing in a very unexpected way. It seems that somehow my subject is an instance of Person but with neither the first_name nor last_name assigned</p>\n"},{"tags":["ruby","ruby-on-rails-3","survey"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":1706,"score":1,"question_id":6395242,"title":"Is any suitable gem for surveys in rails?","body":"<p>I want to create a application in that customers create own surveys and user take surveys . For the above requirement any survey gem is available . I used surveyor it supports static survey, but i want dynamic surveys, it means customer can create own  surveys as their wish. Let me know any one ?</p>\n\n<p>Thanks in Advance,\nPRASAD.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":80,"score":2,"question_id":12902033,"title":"Rails 3: Creating post model with different post types (image, link, text, video). What kind of inheritance should I use?","body":"<p>I am putting together an app that allows users to make posts.  Each post will have a type (image, video, link, text) with both similar and unique variables.  I want to submit these through different forms in a \"composer\" that's available throughout the site.</p>\n\n<p>Here is the post model, Gallery:</p>\n\n<pre><code>class Gallery &lt; ActiveRecord::Base\n    attr_accessible :name, :asset\n    has_attached_file :asset, :styles =&gt; { :small =&gt; '160x120#', :medium =&gt; \"500x\", :thumb =&gt; \"300x200#\" }\n    belongs_to :user\n    has_many :likes\n    validates :user_id, presence: true\n    validates :type, presence: true\n    validates :name, presence: true, length: { maximum: 140, minimum: 1 }\nend\n</code></pre>\n\n<p>I was thinking of using Single Table Inheritance, like this:</p>\n\n<pre><code>class Image &lt; Gallery\nend\n\nclass Link &lt; Gallery\nend\n\nclass Video &lt; Gallery\nend\n\nclass Text &lt; Gallery\nend\n</code></pre>\n\n<p>But I'm not achieving the result I want.  For one, I'd like to use the methods in my Gallery controller, such as:</p>\n\n<pre><code># galleries_controller.rb\ndef like \n    @gallery = Gallery.find(params[:id])\n    @like = @gallery.likes.build(:user_id =&gt; current_user.id)\n    respond_to do |format|\n        if @like.save\n        format.html { redirect_to @gallery }\n        format.js\n    end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>Moreover, I want to create a \"publisher\" form that contains a form for each post type and lets you create any kind of post.</p>\n\n<p>How would you approach this?  I'm new to Rails and I want to take advantage of all the conveniences it offers.  Much appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":51,"score":2,"question_id":12914440,"title":"how to pass params from radio_button_tags to controller","body":"<p>Here is my form that displays all the <code>feedbacks</code> that was not reviewed yet by admin:</p>\n\n<p>I have 2 radio buttons next to each <code>feedback</code> to select accept or denied with values <code>1</code> or <code>2</code>.</p>\n\n<pre><code>&lt;% form_tag moderate_feedbacks_path, :method =&gt; :put do %&gt;\n  &lt;table&gt;\n    &lt;% @all_feedbacks.each do |feedback| %&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= radio_button_tag :review_option, '1', false, :name =&gt; feedback.id %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= radio_button_tag :review_option, '2', false, :name =&gt; feedback.id %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= feedback.name %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= feedback.email %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= feedback.message %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;% end %&gt;\n   &lt;/table&gt;\n&lt;%= submit_tag 'Apply' %&gt;\n&lt;% end -%&gt;\n</code></pre>\n\n<p>what I want to do is when I click <code>submit_tag</code>, to update the <code>review_option</code> field for each selected <code>feedback</code> with the value of that <code>radio_button_tag</code>, <code>1</code> or <code>2</code></p>\n\n<p>I have by now the form as you see it, works good, but I am stuck at the controller part:</p>\n\n<pre><code>def moderate_feedbacks\n  Feedback.update_all([\"review_option = ?\", ????])\n  redirect_to admin_feedbacks_path\nend\n</code></pre>\n\n<p>how do I pass the params from those radio buttons to the controller.\nThank you.</p>\n\n<p><strong>p.s.</strong> html source:</p>\n\n<pre><code>&lt;input id=\"review_option_1\" name=\"3\" type=\"radio\" value=\"1\"&gt;\n&lt;input id=\"review_option_2\" name=\"3\" type=\"radio\" value=\"2\"&gt;\n</code></pre>\n\n<p>name is taken from <code>feedback.id</code></p>\n\n<p>logs when I press the submit_tag looks like this;</p>\n\n<pre><code>Processing Admin::FeedbacksController#moderate_feedbacks (for 127.0.0.1 at 2012-10-16 15:36:20) [PUT]\n  Parameters: {\"commit\"=&gt;\"Apply\", \"3\"=&gt;\"2\", \"4\"=&gt;\"1\"}\n</code></pre>\n\n<p>where 3 is the id of feedback - 2 the radio value, 4 is the id of feedback - 1 the radio value</p>\n\n<p>after <code>raise.params[\"feedback.is\"].inspect</code></p>\n\n<pre><code>Parameters:\n\n    {\"commit\"=&gt;\"Apply\",\n     \"3\"=&gt;\"1\",\n     \"4\"=&gt;\"1\",\n     \"_method\"=&gt;\"put\"}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","amazon-s3"],"answer_count":1,"favorite_count":1,"up_vote_count":5,"down_vote_count":0,"view_count":3603,"score":5,"question_id":6581502,"title":"Problem in accessing bucket of my AWS S3 account","body":"<p>I tried to establish connection to my aws s3 account like this in my irb console -</p>\n\n<pre><code>AWS::S3::Base.establish_connection!(:access_key_id =&gt; 'my access key', :secret_access_key =&gt; 'my secret key', :server =&gt; \"s3-ap-southeast-1.amazonaws.com\")\n</code></pre>\n\n<p>And it works well and prompt this -</p>\n\n<pre><code>=&gt; #&lt;AWS::S3::Connection:0x8cd86d0 @options={:server=&gt;\"s3-ap-southeast-1.amazonaws.com\", :port=&gt;80, :access_key_id=&gt;\"my access key\", :secret_access_key=&gt;\"my secret key\"}, @access_key_id=\"my access key\", @secret_access_key=\"my secret key\", @http=#&lt;Net::HTTP s3-ap-southeast-1.amazonaws.com:80 open=false&gt;&gt;\n</code></pre>\n\n<p>I have a bucket which is based on \"Singapore Region\" and for that endpoint i.e. server is: s3-ap-southeast-1.amazonaws.com So when I try to access it using this command -</p>\n\n<pre><code>AWS::S3::Service.buckets\n</code></pre>\n\n<p>it fetches all buckets in my account correctly -</p>\n\n<pre><code>=&gt; [#&lt;AWS::S3::Bucket:0x8d291fc @attributes={\"name\"=&gt;\"bucket1\", \"creation_date\"=&gt;2011-06-28 10:08:58 UTC}, @object_cache=[]&gt;,\n#&lt;AWS::S3::Bucket:0x8d291c0 @attributes={\"name\"=&gt;\"bucket2\", \"creation_date\"=&gt;2011-07-04 07:15:21 UTC}, @object_cache=[]&gt;,\n#&lt;AWS::S3::Bucket:0x8d29184 @attributes={\"name\"=&gt;\"bucket3\", \"creation_date\"=&gt;2011-07-04 07:39:21 UTC}, @object_cache=[]&gt;]\n</code></pre>\n\n<p>where as bucket1 belongs to Singapore Region and other 2 to US Region. So, when I do this -</p>\n\n<pre><code>AWS::S3::Bucket.find(\"bucket1\")\n</code></pre>\n\n<p>it shows me this error:</p>\n\n<pre><code>AWS::S3::PermanentRedirect: The bucket you are attempting to access must be addressed using the specified endpoint. Please send all future requests to this endpoint.\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/error.rb:38:in `raise'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/base.rb:72:in `request'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/base.rb:88:in `get'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/bucket.rb:102:in `find'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/bucket.rb:145:in `objects'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/bucket.rb:313:in `reload!'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/bucket.rb:242:in `objects'\n    from /home/surya/.rvm/gems/ruby-1.9.2-p180/gems/aws-s3-0.6.2/lib/aws/s3/bucket.rb:253:in `each'\n    from (irb):5\n    from /home/surya/.rvm/rubies/ruby-1.9.2-p180/bin/irb:16:in `&lt;main&gt;'\n</code></pre>\n\n<p>I don't understand the reason why this is happening cause yesterday same thing was working well. Any guess?? am I missing something here??</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":73,"score":1,"question_id":12911482,"title":"how to select the row by using checkbox in ruby on rails?","body":"<h2>This is the <code>Units</code> Table:</h2>\n\n<pre><code>&lt;div id=\"table_header\"&gt;Units&lt;/div&gt;\n&lt;table class=\"gridView location\"&gt;\n  &lt;tr class=\"gridViewHeader\"&gt;\n  &lt;th&gt;&lt;%= check_box(\"select\", \"all\", {class: 'location'}) %&gt;&lt;/th&gt;\n  &lt;th&gt;Location Code&lt;/th&gt;\n  &lt;th&gt;Location Reference&lt;/th&gt;\n  &lt;th&gt;Address&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;tr class=\"&lt;%= cycle('gridViewclickableRowDialog', 'gridViewAltclickableRowDialog') %&gt; current_location\"&gt;\n    &lt;td&gt;&lt;%= check_box(\"select\", \"all\", {class: 'current_location'}) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= current_location_id %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= current_location.Lo_Reference %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= current_location %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<h2>This is the <code>Selected Units</code> Table:</h2>\n\n<pre><code>&lt;div id=\"table_header\"&gt;Selected Units&lt;/div&gt;\n&lt;table class=\"gridView location\"&gt;\n  &lt;tr class=\"gridViewHeader\"&gt;\n  &lt;th&gt;&lt;%= check_box(\"select\", \"all\", {class: 'location'}) %&gt;&lt;/th&gt;\n  &lt;th&gt;Location Code&lt;/th&gt;\n  &lt;th&gt;Location Reference&lt;/th&gt;\n  &lt;th&gt;Address&lt;/th&gt;\n  &lt;/tr&gt;\n\n  &lt;tr class=\"&lt;%= cycle('gridViewclickableRowDialog', 'gridViewAltclickableRowDialog') %&gt; current_location\"&gt;\n    &lt;td&gt;&lt;%= check_box(\"select\", \"all\", {class: 'current_location'}) %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= current_location_id %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= current_location.Lo_Reference %&gt;&lt;/td&gt;\n    &lt;td&gt;&lt;%= current_location %&gt;&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<h2>Image <code>button</code> to push</h2>\n\n<pre><code>&lt;%= image_tag(\"blue_right_arrow.png\", id: 'blue_right_arrow', :alt =&gt; \"arro\", title: 'Move to Selected Units') %&gt;\n</code></pre>\n\n<p>By clicking this <code>button</code>, the selected row from the <code>Units</code> table should transferred to the <code>Selected Units</code> table. </p>\n\n<p>Thanks in advance!.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","multiple-inheritance","mixins"],"answer_count":1,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12913922,"title":"Mixing in module with attr_accessible, has_one, has_many","body":"<p>Can I do somehting like this in Rails ?</p>\n\n<pre><code>module Authored\n  belongs_to :user\n  attr_accessible creation_date\nend\n\nclass Line &lt; ActiveRecord::Base\n  include Authored\nend\n\nclass Document &lt; ActiveRecord::Base\n  include Authored\nend\n\nclass User &lt; ActiveRecord::Base\n  has_many :creations, :class_name =&gt; 'Authored'\nend\n</code></pre>\n\n<p>Or do I need to use simple inheritance, even if my Authored classes have different class hierarchies ?</p>\n"},{"tags":["ruby-on-rails-3","scss"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":28,"score":1,"question_id":12912433,"title":"Rails CSS loads, but style isn't applied","body":"<p>I'm following the book <a href=\"http://pragprog.com/book/rails4/agile-web-development-with-rails\" rel=\"nofollow\">http://pragprog.com/book/rails4/agile-web-development-with-rails</a> and my scss files aren't working.</p>\n\n<p>The css file is this one:</p>\n\n<pre><code>.store {\n  h1 {\n    margin: 0;\n    padding-bottom: 0.5em;\n    font:  150% sans-serif;\n    color: #226;\n    border-bottom: 3px dotted #77d;\n  }\n\n  /* An entry in the store catalog */\n  .entry {\n    overflow: auto;\n    margin-top: 1em;\n    border-bottom: 1px dotted #77d;\n    min-height: 100px;\n\n    img {\n      width: 80px;\n      margin-right: 5px;\n      margin-bottom: 5px;\n      position: absolute;\n    }\n\n    h3 {\n      font-size: 120%;\n      font-family: sans-serif;\n      margin-left: 100px;\n      margin-top: 0;\n      margin-bottom: 2px;\n      color: #227;\n    }\n\n    p, div.price_line {\n      margin-left: 100px;\n      margin-top: 0.5em; \n      margin-bottom: 0.8em; \n    }\n\n    .price {\n      color: #44a;\n      font-weight: bold;\n      margin-right: 3em;\n    }\n  }\n}\n</code></pre>\n\n<p>and the html file the following:</p>\n\n<pre><code>&lt;% if notice %&gt;\n&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n&lt;% end %&gt;\n\n&lt;h1&gt;Your Pragmatic Catalog&lt;/h1&gt;\n\n&lt;% @products.each do |product| %&gt;\n  &lt;div class=\"entry\"&gt;\n    &lt;%= image_tag(product.image_url) %&gt; \n    &lt;h3&gt;&lt;%= product.title %&gt;&lt;/h3&gt;\n    &lt;p&gt;&lt;%= sanitize(product.description) %&gt;&lt;/p&gt;\n    &lt;div class=\"price_line\"&gt;\n      &lt;span class=\"price\"&gt;&lt;%= product.price %&gt;&lt;/span&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>The CSS is loading properly, but not being applied. However if add a surrounding div with the class \"store\" it works. The book doesn't refer this situation, and I believe it should \"automatically\" apply the style, right?</p>\n\n<p>Thanks.</p>\n\n<p><em><strong></em>**</strong><em>EDIT</em><strong><em>*</em>**<em>*</em>****</strong></p>\n\n<p>I found the problem. For those who may encounter the same issue, check the file:</p>\n\n<p>app/assets/views/layouts/application.html.erb</p>\n\n<p><strong>body</strong> tag should have the following code:</p>\n\n<pre><code>&lt;body class=\"&lt;%= controller.controller_name %&gt;\"&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","firefox","selenium","cucumber","capybara"],"answer_count":2,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":296,"score":3,"question_id":12760803,"title":"Firefox version supported by selenium webdriver 2.25.0","body":"<p>I restarted working on an older rails project today. One problem driving me crazy is that I can't get my javascript test cases to run, although I remember them all passing when I left the project. I am using</p>\n\n<p>selenium-webdriver 2.25.0\ncapybara 1.1.2\ncucumber 1.2.1</p>\n\n<p>but firefox doesn't start when I run the tests. All I get is </p>\n\n<blockquote>\n  <p>unable to start Firefox cleanly, args: [\"-silent\"] \n  (Selenium::WebDriver::Error::WebDriverError)</p>\n</blockquote>\n\n<p>I guess this is because of updating firefox and I tried to install several older versions but none of them works. Which version is supported by selenium-webdriver 2.25.0?</p>\n"},{"tags":["ruby-on-rails-3","amazon-ec2","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":65,"score":0,"question_id":12903707,"title":"Amazon SES Email from EC2 - Timeout","body":"<p>I'm using Amazon SES to send email from a Ruby on Rails (version 3.2.3) app hosted on Amazon's EC2 infrastructure, and I'm getting repeated Timeouts while sending email.</p>\n\n<pre><code>Timeout::Error: execution expired\n</code></pre>\n\n<p>I do this using a delayed_job queue, and it fails several times before being successful (Some email addresses require up to 4 or 5 re-tries).</p>\n\n<p>I have production access on Amazon SES. Any reason why these timeouts are happening? Do I need to apply to have my Amazon EC2 sending limitations removed?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter","routing","gem"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":178,"score":1,"question_id":10705329,"title":"Twitter's activerecord-reputation-system gem + Devise","body":"<p>I am working with Twitter's new <a href=\"https://github.com/twitter/activerecord-reputation-system/issues?state=open\" rel=\"nofollow\">activerecord-reputation-system</a> gem, yet it doesn't seem to be registering in my app.</p>\n\n<p>I ran to install (docs have a typo):</p>\n\n<pre><code>gem install activerecord-reputation-system &amp;&amp; rails generate reputation_system &amp;&amp; rake db:migrate\n</code></pre>\n\n<p>I've included it in my gemfile and tried pulling directly from github, as well as restarting my local server. The error is the following:</p>\n\n<blockquote>\n  <p>ActionController::RoutingError (undefined method <code>has_reputation' for #&lt;Class:0x007fa7ed783ec0&gt;):\n    app/models/post.rb:18:in</code>'\n    app/models/post.rb:1:in <code>&lt;top (required)&gt;'\n    app/controllers/posts_controller.rb:1:in</code>'</p>\n</blockquote>\n\n<p>when I try to add votes to posts with this code:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  belongs_to :user\n  has_reputation :votes,\n    :source =&gt; :user,\n    :aggregated_by =&gt; :sum\nend\n</code></pre>\n\n<p>When I try to add votes to users with the same code I get:</p>\n\n<pre><code>undefined method `has_reputation' for #&lt;Class:0x007fa7efb70388&gt;\n\napp/models/user.rb:17:in `&lt;class:User&gt;'\napp/models/user.rb:1:in `&lt;top (required)&gt;'\nconfig/routes.rb:4:in `block in &lt;top (required)&gt;'\nconfig/routes.rb:1:in `&lt;top (required)&gt;'\n\nThis error occurred while loading the following files:\n   /Users/username/appname/config/routes.rb\n</code></pre>\n\n<p>routes.rb, Line 4:</p>\n\n<blockquote>\n  <p>devise_for :users, :controllers => { :omniauth_callbacks => \"users/omniauth_callbacks\" }</p>\n</blockquote>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12862668,"title":"re render fields_for with ajax","body":"<p>I have a problem refreshing a partial with fields_for inside.</p>\n\n<p>Here is the code of the partial ('table_detalle')</p>\n\n<pre><code>&lt;table class=\"table\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;&lt;%= t('.denominacion') %&gt;&lt;/th&gt;\n            &lt;th&gt;&lt;%= t('.cantidad_ingreso') %&gt;&lt;/th&gt;\n            &lt;th&gt;&lt;%= t('.importe') %&gt;&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n\n        &lt;%= f.fields_for :operacion_detalles do |builder| %&gt;\n        &lt;tr&gt;\n            &lt;%= render 'table_detalle_operacion', f: builder %&gt;\n        &lt;/tr&gt;\n        &lt;% end unless @operacion.nil? %&gt;\n\n    &lt;/tbody&gt;\n&lt;/table&gt;\n&lt;%= content_tag :h3, t('.total', :value=&gt; number_to_currency(@operacion.R_IMPORTE)).html_safe, :class =&gt; 'pull-right', style: 'display:inline'  %&gt;\n</code></pre>\n\n<p>when the user change a value of a combo i would like to refresh the partial above (because the details objects must change and are editable)</p>\n\n<p>Here is the javascript code:</p>\n\n<pre><code>$('#operacion_TIPOVALOR_ID').change(function(){\n                      $.ajax({\n                      url: '&lt;%= cambiar_tipo_valor_movimientos_path %&gt;',\n                      data: {tipo_valor_id: $('#operacion_TIPOVALOR_ID').val()},\n                      complete: function(){\n                        $('#tipo_valor_loader').css('display','none');\n                      },\n                      beforeSend: function(){\n                        $('#tipo_valor_loader').css('display','inline');\n                      },\n                      success: null,\n                      dataType: 'script'\n                    });\n            });\n</code></pre>\n\n<p>the controller code:</p>\n\n<pre><code>def cambiar_tipo_valor\n        @operacion = Operacion.new\n        denominaciones = TipoValorDenominacion.all_from_tipo_valor params[:tipo_valor_id]\n        denominaciones.each do |deno|\n            @operacion.operacion_detalles.build :tipo_valor_denominacion =&gt; deno, :I_CANTIDAD =&gt; 0, :R_IMPORTE =&gt; 0\n        end\n    end\n</code></pre>\n\n<p>as you can see the \"operacion_detalles\" change depending on the user selection.</p>\n\n<p>the .js.erb code:</p>\n\n<pre><code>$('#detalle').html('&lt;%= escape_javascript(render :partial =&gt; 'table_detalle') %&gt;');\n</code></pre>\n\n<p>But, i get:</p>\n\n<pre><code>undefined local variable or method `f' for #&lt;#&lt;Class:0x45ae1c8&gt;:0x5062338&gt;\n</code></pre>\n\n<p>So, i need the f variable to render the partial. Is there any way to emulate the f variable?</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["ruby-on-rails-3","sqlite3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12912285,"title":"Binary data inserted for `string` type on column `remote_ip`?","body":"<p>What is the meaning of <code>Binary data inserted for</code>string<code>type on column ...</code>? </p>\n\n<p>When loggin remote ip addresses in a SQLite table, there is a message in debug console:</p>\n\n<pre><code>Started GET \"/test?name=abcde\" for 127.0.0.1 at 2012-10-16 18:02:01 +0800\nProcessing by TestController#index as HTML\n  Parameters: {\"name\"=&gt;\"abcde\"}\n   (0.1ms)  begin transaction\nBinary data inserted for `string` type on column `query`\nBinary data inserted for `string` type on column `remote_ip`\n  SQL (0.6ms)  INSERT INTO \"requests\" (\"controller\", \"query\", \"remote_ip\") VALUES (?, ?, ?)  [[\"controller\", \"test\"], [\"query\", \"name=abcde\"], [\"remote_ip\", \"127.0.0.1\"]]\n   (2.5ms)  commit transaction\n</code></pre>\n\n<p>The table is defined as:</p>\n\n<pre><code>class CreateRequests &lt; ActiveRecord::Migration\n  def change\n    create_table :requests do |t|\n      t.string   :controller, :limit =&gt; 128\n      t.string   :remote_ip,  :limit =&gt; 128\n      t.string   :query,      :limit =&gt; 2048\n    end\n  end\nend\n</code></pre>\n\n<p>Configuration:</p>\n\n<pre><code>OS X Lion\nruby 1.9.3p194 \nRails 3.2.8\nsqlite3 (1.3.6)\nsqlite3-ruby (1.3.2)\n</code></pre>\n"},{"tags":["ruby-on-rails-3","testing","rspec2"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":20,"score":0,"question_id":12911642,"title":"RSpec indicating error in a separate view","body":"<p>I have a simple request spec that looks like this:</p>\n\n<pre><code>describe \"Projects\" do\n  it \"Visit Projects Index\" do\n    visit projects_path\n    page.should have_content(\"Projects\")\n  end\nend\n</code></pre>\n\n<p>When I run the test, it indicates I have an error in my application view:</p>\n\n<pre><code>  1) Projects Visit Projects Index\n     Failure/Error: visit projects_path\n     ActionView::Template::Error:\n       undefined method `role?' for nil:NilClass\n     # ./app/views/layouts/application.html.erb:36:in `_app_views_layouts_application_html_erb___4349647608132133042_70284426968400'\n     # ./spec/requests/projects_spec.rb:6:in `block (2 levels) in &lt;top (required)&gt;'\n</code></pre>\n\n<p>The offending code is this:</p>\n\n<pre><code>&lt;% if current_user.role?('Administrator') %&gt;\n  &lt;li class=\"divider\"&gt;&lt;/li&gt;\n  &lt;li&gt;&lt;%= link_to \"Billing\", admin_billings_path %&gt;&lt;/li&gt;\n  &lt;li&gt;&lt;%= link_to \"Configure\", admin_configurations_path %&gt;&lt;/li&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>But the code seems to work just fine.  Any suggestion on how I fix this error?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails-3","nested-attributes","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":153,"score":0,"question_id":11565204,"title":"rails nested attributes has_many through","body":"<p>I have three models.  Parent, Child, Type, and Relationship.  Relationship is the rich join model referencing the Parent, Child, and Type.</p>\n\n<p>The problem is that while a child is created and the relationships table is created, the parent_id in the relationships table is not populated.  Only the child and type is is automatically populated.</p>\n\n<p>parent.rb</p>\n\n<pre><code>attr_acccessible :relationships_attributes\n\nhas_many :relationships\nhas_many :children, :through =&gt; :relationships\nhas_many :types, :through =&gt; :relationships\n</code></pre>\n\n<p>child.rb</p>\n\n<pre><code>attr_acccessible :relationships_attributes\n\nhas_many :relationships\nhas_many :parents, :through =&gt; :relationships\nhas_many :types, :through =&gt; :relationships\n\naccepts_nested_attributes_for :relationships\n</code></pre>\n\n<p>relationship.rb</p>\n\n<pre><code>attr_accessible :parent_id, :child_id, :type_id\nbelongs_to :parent\nbelongs_to :child\nbelongs_to :type\n</code></pre>\n\n<p>children.controller</p>\n\n<pre><code>def new\n @child = Child.new\n @child.relationships.build\nend\n\ndef create\n @child = Child.new(params[:child])\n if @child.save\n  redirect_to current_user\n else\n  render \"new\"\n end\nend\n</code></pre>\n\n<p>new.html.erb</p>\n\n<pre><code>&lt;%= simple_form_for @child do |f| %&gt;\n  &lt;%= f.input :first_name, :label =&gt; 'First Name' %&gt;\n  &lt;%= f.input :gender, :as =&gt; :select, :collection =&gt; ['Male', 'Female'] %&gt;\n  &lt;%= f.association :relation_types, :as =&gt; :collection_select %&gt;\n\n\n  &lt;%= f.button :submit, :class =&gt; \"primary\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Please help.</p>\n\n<p>Thank you!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12901893,"title":"Database in Rails application","body":"<p>I cannot find where the database in my Rails application is located. I looked in folders like <code>/db</code>, <code>/db/migrate</code>, and <code>/app/models</code>, but cannot find the actual database that I can open to examine the data. Where is it located?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":101,"score":1,"question_id":12906181,"title":"DRY in Rails 3 if else elsif","body":"<p>Second week on RoR (with no programming background). And I have a bit of an issue, I'm doing a Metacritic type of a website. And there are going to be ratings everywhere. I decided on 0 to 33 = red 34 to 66 = orange 67 to 100 = green which looks like that</p>\n\n<p>index (controller:show)</p>\n\n<pre><code> &lt;td&gt;&lt;% if show.reviews.count == 0 %&gt;0\n    &lt;% elsif show.reviews.average(\"rating\").between?(33, 66) %&gt;\n    &lt;table class=\"orange\"&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;b&gt;&lt;%= number_with_precision(show.reviews.average(\"rating\"), :precision =&gt; 0) %&gt;&lt;/b&gt;&lt;/td&gt;\n     &lt;/tr&gt;\n    &lt;/table&gt;\n    &lt;% elsif show.reviews.average(\"rating\").between?(66, 100) %&gt;\n    &lt;table class=\"green\"&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= number_with_precision(show.reviews.average(\"rating\"), :precision =&gt; 0) %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n    &lt;% elsif show.reviews.average(\"rating\").between?(00, 33) %&gt;\n    &lt;table class=\"red\"&gt;\n      &lt;tr&gt;\n        &lt;td&gt;&lt;%= number_with_precision(show.reviews.average(\"rating\"), :precision =&gt; 0) %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;/table&gt;\n    &lt;% end %&gt;\n  &lt;/td&gt;\n</code></pre>\n\n<p>My issue is that I'm gonna need to repeat that code, a lot, see (I'm only getting started:\nshow (controller show)</p>\n\n<pre><code>&lt;p&gt;\n  Note: &lt;% if @ratings == 0 %&gt;0\n  &lt;% elsif @ratings.between?(33, 66) %&gt;\n  &lt;table class=\"orange\"&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;b&gt;&lt;%= number_with_precision(@ratings, :precision =&gt; 0) %&gt;&lt;/b&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n  &lt;% elsif @ratings.between?(66, 100) %&gt;\n  &lt;table class=\"green\"&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= number_with_precision(@ratings, :precision =&gt; 0) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n  &lt;% elsif @ratings.between?(00, 33) %&gt;\n  &lt;table class=\"red\"&gt;\n    &lt;tr&gt;\n      &lt;td&gt;&lt;%= number_with_precision(@ratings, :precision =&gt; 0) %&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n  &lt;% end %&gt;\n&lt;/p&gt;\n</code></pre>\n\n<p>Somebody told me this should be a model but I don't really know how to write it. Any help ?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":380,"score":0,"question_id":5678227,"title":"How can I run a command five times using Ruby?","body":"<p>How can I run a command five times in a row? </p>\n\n<p>For example:</p>\n\n<pre><code>5 * send_sms_to(\"xxx\");\n</code></pre>\n"},{"tags":["ruby-on-rails","facebook","ruby-on-rails-3","facebook-oauth"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12911245,"title":"Oauth inside Facebook tab with Rails 3","body":"<p>although authorizing a client inside Facebook using Facebook Oauth gem works pretty good, there is a problem when you have to develop an application inside a Facebook tab. The problem is that the oauth response always redirects outside the Facebook tab.</p>\n\n<p>I.E: if your app inside the tab is www.example.com/app after oauth you'll find yourself in that address and not in the Facebook tab.</p>\n\n<p>I've spent some time trying to figure out how to solve this and finally I only could avoid this issue through client login. But there is a problem also with that. Using JavaScript and cookies, Safari blocks these cookies as third party cookies.\nPlease, do you know if there is a proper solution for this? In PHP it's quite easy using the Facebook PHP framework.</p>\n\n<p>If you know also if there is a way to solve the cookies problem with Safari, please let me know. All the info I found about this is outdated.</p>\n\n<p>Thanks a lot in advance.</p>\n"},{"tags":["ruby","ruby-on-rails-3","spree"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":261,"score":0,"question_id":7530532,"title":"Sort product listings in Spree based on created_at","body":"<p>I'm using spree and I want to sort product listing based on <code>created_at</code> of the product. </p>\n\n<p>I tried to find the way to override the spree default scope under <strong>lib/scopes/product.rb</strong> but couldn't find it. </p>\n\n<p>I want to list recently created products on public panel. How can I do it with spree?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gmaps4rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12908561,"title":"Add marker to center location with gmaps4rails","body":"<p>I have an application where I'm showing a business listing and then displaying various jobs related to that business. The job locations are working great but I'd like to add a marker for the business which should be in the center which I can then customise. </p>\n\n<p>Here is my controller/business_controller</p>\n\n<pre><code>def show\n  @business = Business.find(params[:id])\n  @distance = @business.service_area\n  @jobs = Job.near(@business.location, @distance, {:order =&gt; :distance, :units =&gt; :km})\n  @json = @jobs.to_gmaps4rails\n  @mapoptions = {\n       \"map_options\" =&gt; {\"center_latitude\" =&gt; @business.latitude, \n                         \"center_longitude\" =&gt; @business.longitude,\n                         \"auto_zoom\" =&gt; true}\n                 }\n  respond_to do |format|\n    format.html\n  end\nend\n</code></pre>\n\n<p>In my view views/businesses/show</p>\n\n<pre><code>&lt;p&gt;&lt;%= gmaps(:map_options =&gt; @mapoptions,\"markers\" =&gt; { \"data\" =&gt; @json }) %&gt;&lt;/p&gt;\n</code></pre>\n\n<p>How can I create a marker for the business location?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12909492,"title":"include multiple column value in Ruby on rails Collection_select. Also format the date","body":"<p>Earlier i was using This code </p>\n\n<pre><code>&lt;%= select \"selected_payment\", \"id\", @shifts.map {|u| [' ' +u.start_time.strftime(\"%I:%M %p\") + '-' + u.end_time.strftime(\"%I:%M %p\")+' ',u.id]} %&gt;   to make a dropdown.\n</code></pre>\n\n<p>Now i have to do same thing with collection_select. But i'm not able to figure how to do it.\nIt will be something like the one given below :</p>\n\n<pre><code>&lt;%= f.collection_select :shift_id, @shifts,:id, :start_time, :prompt =&gt; true %&gt;\n</code></pre>\n\n<p>I can not even format the date and use two values at the same time.\nPlease help,Thanks in Advance</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","acceptance-testing","faye","foreman"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":77,"score":0,"question_id":11864122,"title":"Rails acceptance tests - run foreman","body":"<p>My application to run properly using faye, redis, resque and other services, that I am starting every time with foreman. Now I am writing acceptance tests(with capybara+rspec) and i wonder how could I start foreman(or even a faye alone) (with capybara in spec_helper) to test live features. Thanks in advice.</p>\n"},{"tags":["mysql","ruby-on-rails-3","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12908560,"title":"Refinery cms with mysql database","body":"<p>I am running command..</p>\n\n<pre><code> $ refinerycms rickrockstar -d=mysql -U=root -P=root\n</code></pre>\n\n<p>and getting error like this..</p>\n\n<pre><code> Access denied for user 'root'@'localhost' (using password: NO). \n Please provide the root password for your mysql installation\n</code></pre>\n\n<p>what i am doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","ruby-on-rails-3.2","ransack"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12908564,"title":"Editng gem Ransack?","body":"<p><strong>How I can edit gem Ransack ?</strong></p>\n\n<p>as I know the steps are :</p>\n\n<ol>\n<li>unpack gem (done) </li>\n<li>modify the code as require (done)</li>\n<li><p>build the gem ( <em>got problem</em> )</p>\n\n<p>how to build gem ransack which I modified ? </p>\n\n<p>I am refering this <a href=\"http://docs.rubygems.org/read/chapter/10#page29\" rel=\"nofollow\">http://docs.rubygems.org/read/chapter/10#page29</a></p>\n\n<p>in cmd project root dir I typed : \ngem build ransack.gemspec</p>\n\n<p><em>got error :  couldn`t find file ransack.gemspec</em></p></li>\n</ol>\n\n<p><strong>solution please...</strong></p>\n"},{"tags":["ruby-on-rails-3","rake","rake-task"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12481624,"title":"rake db:migrate error Don't know how to build task 'rails_env'","body":"<p>I am getting am error when running rake db:migrate. I have recently added a gem <a href=\"https://github.com/dondeng/gcm_on_rails/\" rel=\"nofollow\">gcm_on_rails</a> after this only I am getting the error.</p>\n\n<pre><code> rake aborted!\n Don't know how to build task 'rails_env'\n\n Tasks: TOP =&gt; db:migrate =&gt; db:load_config\n</code></pre>\n\n<p>Please help</p>\n\n<pre><code>   rake aborted!\n   Don't know how to build task 'rails_env'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task_manager.rb:49:in `[]'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:60:in `lookup_prerequisite'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:56:in `block in prerequisite_tasks'\n   /Users/qburst/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:56:in `collect'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:56:in `prerequisite_tasks'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `block in invoke_with_call_chain'\n  /Users/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:176:in `block in invoke_prerequisites'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `each'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:174:in `invoke_prerequisites'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:157:in `block in invoke_with_call_chain'\n  /Users/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'\n  /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n   /Users/.rvm/gems/ruby-1.9.2-p320@global/gems/rake-0.9.2.2/bin/rake:33:in `&lt;top (required)&gt;'\n   /Users/qburst/.rvm/gems/ruby-1.9.2-p320@global/bin/rake:19:in `load'\n   /Users/qburst/.rvm/gems/ruby-1.9.2-p320@global/bin/rake:19:in `&lt;main&gt;'\n   Tasks: TOP =&gt; db:migrate =&gt; db:load_config\n</code></pre>\n"},{"tags":["ruby-on-rails-3","etag","http-etag"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12908052,"title":"Expiring/busting Etag in Rails","body":"<p>When doing HTTP caching in rails, once would use:<br>\nfresh_when etag: @user, public: true</p>\n\n<p>The problem with that is that if you chance your html for the page, the cached page is no longer going to be valid. Therefor we need a way to invalidate the page/etag every time we change something.</p>\n\n<p>One way to do that is to change RAILS_CACHE_ID every time you deploy as per\n<a href=\"http://ninjasandrobots.com/how-to-bust-your-rails-etag-cache-on-deployment%20Etag%20busting%20on%20deployment\" rel=\"nofollow\">Etag busting on deployment</a> .However doing that will results in all etags, for all the pages getting expired for every deployment. </p>\n\n<p>I would rather have a solution where  I can expire individual tags, for individual pages.</p>\n\n<p>I could generate my own etag with a version like this:\nfresh_when etag: (@user.updated_at.to_s + \"V1\"), public: true     </p>\n\n<p>But this just doesn't feel like the \"Rails way\". Any more elegant solutions?  </p>\n"},{"tags":["ruby-on-rails-3","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12908039,"title":"Polymorphic has_many with an additional user_id column","body":"<p>I have a polymorphic has_many relationship setup and working correctly.</p>\n\n<p>The set up is as</p>\n\n<pre><code>Trip -&gt; has_many :places, :through =&gt; :plans, :source =&gt; :plannable, :source_type =&gt; 'Place'\n</code></pre>\n\n<p>Uptil recently, I was simply associating a new place object by</p>\n\n<pre><code>@trip.places &lt;&lt; Place.find(:id)\n</code></pre>\n\n<p>And everything worked as natural. Today I had to add a new column user_id to the plan model, just to associate which user has created this plan for the trip.</p>\n\n<p>I want to know what is the way to add this user information as well at the time of associating the Place object. I have thought of adding before_create filters, but that doesn't sound like a good idea. The other way I've worked is by manually creating the plan object with the relevant data from the place object.</p>\n\n<p>Would be great if someone could point me in the right direction.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","dynamic-finders"],"answer_count":2,"favorite_count":4,"up_vote_count":4,"down_vote_count":0,"view_count":7367,"score":4,"question_id":5578625,"title":"find_or_create_by in Rails 3 and updating for creating records","body":"<p>I'm not sure if I should be updating records this way or if I'm missing something.</p>\n\n<p>I have a table with 5 columns (not including timestamps and id) 3 of which are distinct, and 2 which will get updated.  The 3 distinct which I will find or create by are room_id, date, and source.  The other 2 are price and spots available (these change hourly, daily etc.)</p>\n\n<p>My question is, should I first find or create the record, then update (or create) the price and spots or can I do it all at once?  You can see the two ways I'm doing it now, and I'm not sure if its actually doing what I'm expecting.</p>\n\n<p>Also, is there any downside to do a find_and_create_by like this?</p>\n\n<p>Thanks</p>\n\n<pre><code>  private\n\n  def self.parse_data(params,data)\n    data.beds.each do |bed|\n      room = Room.find_or_create_room(bed.title, params[:id])\n\n      #find clones somehow\n      #puts bed.nights.first.price\n      bed.nights.each_with_index do |night,index|\n        available = Available.find_or_create_by_room_id_and_bookdate_and_source(\n          :room_id =&gt; room.id, \n          :bookdate =&gt; (params[:date].to_date)+index, \n          :source =&gt; data.class.to_s#,\n          #:price =&gt; night.price\n        )\n        #available.price = night.price\n        #available.spots = night.spots\n        #available.save\n      end\n\n    end\n</code></pre>\n"},{"tags":["javascript","jquery","ruby-on-rails","ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":12907582,"title":"Onscreen javascript countdown timer in Rails","body":"<p>I'm trying to create a timer that visibly ticks down the seconds (from 5 minutes or something -- though here I'm using 5 seconds just so have quicker feedback on the alert) after somebody's placed an order on my site til when they pay. If they haven't paid by the time the timer runs out, a delay_job I made will roll back the order.</p>\n\n<p>I'm bad at javascript, and what I tried isn't working at all. Here's my shot at it (this is within a document.ready function):</p>\n\n<pre><code>function countdown() {\n    setInterval(function(){myTimer()},1000);\n  };\n\n  function myTimer() {\n    var parentTr = $(this).parents(\"tr\");\n    var status = $(parentTr).find(\".js-status\").attr('data-status');\n    if (status === 0) {\n      var timeLeft = 30000;\n      document.getElementById(\".js-timer\").html=timeLeft;\n      if (timeLeft === 0) {\n         alert(\"Time Out\");\n      };\n    };\n  };\n</code></pre>\n\n<p>In my view, I've got these lines that I was hoping the JS would pick up and use. But it isn't working. (And won't work when I arbitrarily say that var status = 0). </p>\n\n<pre><code>    &lt;tr&gt;\n       &lt;th class=\"js-timer\"&gt;&lt;/th&gt;\n       &lt;th class=\"js-status\"  data-status=&lt;%= @order.status %&gt; &gt;&lt;/th&gt;\n    ...\n    &lt;/tr&gt;\n</code></pre>\n\n<p>Any idea what I'm doing wrong or how to do this better?</p>\n"},{"tags":["image","ruby-on-rails-3","upload"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1012,"score":1,"question_id":4349348,"title":"bulk image upload - Rails3","body":"<p>I have a requirement of bulk uploading images. More precisely, I want to upload all the images  for a web site (static images like back ground, logo, corner images , images required by css etc..)</p>\n\n<p>As I think uploading these images one after another is not looks like quite practical (As it might have 60-70 images). So my questions are..</p>\n\n<ol>\n<li>What is the standard way of doing these kind of a staff ?</li>\n<li>Is it possible to let users to upload a .zip (images) file and\nextract it from the server side.</li>\n<li>If 2 is possible, can i do it with Rails3 and standard shared host</li>\n</ol>\n\n<p>thanks in advance</p>\n\n<p>cheers</p>\n\n<p>sameera </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12906642,"title":"How would you model different post types in Rails 3?","body":"<p>I am stuck.  I am trying to create an app in Rails 3 that allows Users to create a Post, which is either a Image, Photo, or Text.  I want my Posts index to show all three types of posts and to create a \"publisher\" that allows the User to create ONE OF an Image, Photo, or Text Post.  I have tried everything, including STI and has_one relationships, but nothing seems to come out in an Rails-optimized way and it's driving me crazy!  There must be something I'm missing.  Please help!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":63,"score":2,"question_id":12892593,"title":"conditions in css fle?","body":"<p>use rails 3.2. </p>\n\n<p>Part of my css file:</p>\n\n<pre><code>#accordion1 .slide_handle {\n    background:url(/assets/handles-1.png);\n    bottom:0;\n    cursor:pointer;\n    left:0;\n    position:absolute;\n    top:0;\n    width:40px;\n}\n</code></pre>\n\n<p>Shows a accordion with text writen in handles.1.png. I am developing the site in 4 languages. How can i change the png file based on the language (locale) parameter? Is this possible ? or load a complete new css file based on the language? (not suggested)</p>\n\n<p>Ciao..remco </p>\n"},{"tags":["ruby-on-rails-3","deployment","production-environment","airbrake"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":79,"score":1,"question_id":12907034,"title":"ERROR -- : uninitialized constant Airbrake (NameError)","body":"<p>I'm working on a rails 3.2.8 project, I've just installed the airbrake gem to track errors, In development I did the airbrake installation steps, then when I did the deployment with capistrano, I got the following error in the unicorn production log:</p>\n\n<pre><code>E, [2012-10-16T03:02:51.588084 #3645] ERROR -- : reaped #&lt;Process::Status: pid 3846 exit 1&gt; worker=3\nI, [2012-10-16T03:02:51.588434 #3645]  INFO -- : worker=3 spawning...\nI, [2012-10-16T03:02:51.708539 #3858]  INFO -- : worker=3 spawned pid=3858\nI, [2012-10-16T03:02:51.708986 #3858]  INFO -- : Refreshing Gem list\nE, [2012-10-16T03:02:52.793217 #3849] ERROR -- : uninitialized constant Airbrake (NameError)\n/home/ubuntu/apps/nimrod/releases/20121011033552/config/initializers/airbrake.rb:1:in `&lt;top (required)&gt;'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:588:in `block (2 levels) in &lt;class:Engine&gt;'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:587:in `each'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:587:in `block in &lt;class:Engine&gt;'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n/home/ubuntu/apps/nimrod/releases/20121011033552/config/environment.rb:5:in `&lt;top (required)&gt;'\nconfig.ru:4:in `require'\nconfig.ru:4:in `block in &lt;main&gt;'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\nconfig.ru:1:in `new'\nconfig.ru:1:in `&lt;main&gt;'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn.rb:44:in `eval'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn.rb:44:in `block in builder'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:696:in `call'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:696:in `build_app!'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:569:in `init_worker_process'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:589:in `worker_loop'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:487:in `spawn_missing_workers'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:498:in `maintain_worker_count'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:272:in `join'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/gems/unicorn-4.3.1/bin/unicorn:121:in `&lt;top (required)&gt;'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/bin/unicorn:19:in `load'\n/home/ubuntu/apps/nimrod/shared/bundle/ruby/1.9.1/bin/unicorn:19:in `&lt;main&gt;'\n</code></pre>\n\n<p>I've noticed the airbrake gem is installed in shared/bundle/ruby/1.9.1/gems with all other gems.</p>\n\n<p>In production I'm running a Ubuntu 12.04 x64 with unicorn running with nginx and ruby 1.9.3-p194, with this gems</p>\n\n<pre><code>Using airbrake (3.1.4) \nUsing capistrano (2.12.0)    \nUsing bundler (1.1.4) \nUsing rails (3.2.8) \nUsing unicorn (4.3.1) \n</code></pre>\n\n<p>And also tried to stop nginx, unicorn and then start them all again, but it didn't worked</p>\n\n<p>I hope someone can help me with this</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12879350,"title":"Why does authenticate_admin give an undefined method error for a Rails Engine mountable app integration?","body":"<p>I'm trying to setup Devise inside a Rails Engine to handle auth for the main app.  The engine is a mountable isolated engine mounted at '/ryte'.  When I run my specs I get an undefined method \"authenticate_admin\" error.  My engines routes file looks like:  </p>\n\n<pre><code>Ryte::Engine.routes.draw do\n  devise_for :admins, {\n    class_name: \"Ryte::Admin\",\n    module: :devise\n  }\nend\n</code></pre>\n\n<p>I have included:</p>\n\n<pre><code>config.include Devise::TestHelpers, :type =&gt; :controller\n</code></pre>\n\n<p>In my devise.rb initializer I have:</p>\n\n<pre><code>config.router_name = :ryte\n</code></pre>\n\n<p>In the spec_helper.rb.  I've also mounted the app inside the engine's dummy app.  The model for admins is Ryte::Admin.  Lastly I am placing the before_filter for authenticate_admin inside my application controller. I'm confused why this error is coming up.  Help is appreciated.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12906758,"title":"DoubleRenderError error and would like to return a partial as a string to be sent back in json","body":"<p>I'd like to do something like the following:</p>\n\n<pre><code>def return_item\n  item_id=params[:item_id]\n  @item=Item.find(item_id)\n  str=render :partial =&gt; 'headers/item'\n\n  r={}\n  r[:status]='success'\n  r[:data]=str\n  render :json =&gt; r.to_json\nend\n</code></pre>\n\n<p>but I am getting a DoubleRender error (which IMHO, I'm not doing). How would / could I get the values from a render and save it to a string that could then be rendered out as part of a JSON response?</p>\n\n<p>thx in advance</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12905837,"title":"Best way to generate a migration timestamp","body":"<p>I am trying to generate a timestamp for rails migration that I am copying into my app from an engine as part of rake task.</p>\n\n<p>The following works fine, but since rails already does the same thing, i didn't know if there is a better way to do this?</p>\n\n<p><code>\nTime.now.to_s.split(\" \")[0..1].join(\" \").gsub!(/\\D/, \"\")\n</code></p>\n"},{"tags":["ruby-on-rails-3","text-field"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12906152,"title":"Rails3, use on_change with remote_function and pass parameters to the controller in a text_field","body":"<p>So .. is it possible? somthing like that:</p>\n\n<p>in a view </p>\n\n<blockquote>\n  <p>f.text_field\n  :amount,:onchange=>remote_function(:url=>{:controller=>:expenses,:action=>:sum_total,:amount\n  => \"¿¿ this.value() ???\"}) %></p>\n</blockquote>\n\n<p>and in expenses controller, action sum_total get a parameter \"amount\". </p>\n\n<p>I know I maybe need to add to routes.rb.. <code>match 'expenses/sum_total/:amount' =&gt; \"expenses#sum_total\", :as=&gt;:sum_total, :via=&gt;:post</code> </p>\n\n<p>I have done somthing like this with a colection_select, and passing parameters like <code>\"with=\"'parameter='+this.value()\")</code> but with text_field seems no work</p>\n\n<p>Thanks a lot</p>\n\n<p>I have tried all combinations but with no result.</p>\n"},{"tags":["arrays","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12903937,"title":"Rails, evaluate if numbers are in sequence","body":"<p>Is there a way to evaluate the order of an array?  I want to find an array of records ordered by created_at date and then see if the numbers in that array are in sequence?  </p>\n\n<p>For instance:</p>\n\n<pre><code>  Model.all.order(&amp;:created_at).select(\"lesson_number)\n  [1, 2, 4, 3, 5]\n</code></pre>\n\n<p>should fail because the numbers are not in sequence</p>\n\n<p>I could execute two finds.  One that is ordered by \"lesson_number\" and one that is ordered by created_at date.  Convert them both the a string then compare the two.  But, seems like a lot of work if a rails method exists to handle such a thing.</p>\n"},{"tags":["ruby-on-rails-3","osx","mongodb","osx-lion","homebrew"],"answer_count":2,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":1600,"score":4,"question_id":10424872,"title":"brew install mongodb error: Cowardly refusing to `sudo brew install' Mac OSX Lion","body":"<p>I am not sure why I'm getting this error:</p>\n\n<pre><code>$ brew install mongodb\n==&gt; Downloading http://fastdl.mongodb.org/osx/mongodb-osx-x86_64-2.0.4.tgz\n######################################################################## 100.0%\nError: Permission denied - /usr/local/var/log/mongodb\n</code></pre>\n\n<p>So I try to run it with sudo:</p>\n\n<pre><code>$ sudo brew install mongodb\nPassword:\nCowardly refusing to `sudo brew install'\n</code></pre>\n\n<p>If I try to create the file myself I get this:</p>\n\n<pre><code>Error: File exists - /usr/local/var/log/mongodb\n</code></pre>\n\n<p>It gets even more interesting when you read this thread on homebrew's github about the error:</p>\n\n<p><a href=\"https://github.com/mxcl/homebrew/issues/9953\" rel=\"nofollow\">https://github.com/mxcl/homebrew/issues/9953</a></p>\n\n<p>They state that brew can't write the file because it's not root, then they say it's because they think it shouldn't run as root. </p>\n\n<p>These are the official install instructions, what's up?</p>\n\n<p>If you have a better suggestion for installing it, then I'll forget about homebrew.</p>\n"},{"tags":["ruby-on-rails","ruby","linux","ruby-on-rails-3"],"answer_count":5,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":108,"score":2,"question_id":12887694,"title":"Install Rails won't start","body":"<p>I have installed ruby on rails following the 310 railcasts on railcast.com. Now I was able to run and create a new rails and run it using rail s. The issue comes as soon has I close the terminal and restarted it i get the following error</p>\n\n<pre><code>The program 'rails' is currently not installed.  You can install it by typing:\nsudo apt-get install rails\n</code></pre>\n\n<p>Here ruby version</p>\n\n<pre><code>ruby -v\nruby 1.9.3p286 (2012-10-12 revision 37165) [i686-linux]\n</code></pre>\n\n<p>if i do rails -v i get following</p>\n\n<pre><code>The program 'rails' is currently not installed.  You can install it by typing:\nsudo apt-get install rails\n\nwhereis rails\nrails:\n</code></pre>\n\n<p>gem environment gives me this</p>\n\n<pre><code>  - RUBYGEMS VERSION: 1.8.24\n  - RUBY VERSION: 1.9.3 (2012-10-12 patchlevel 286) [i686-linux]\n  - INSTALLATION DIRECTORY: /home/john/.rvm/gems/ruby-1.9.3-p286\n  - RUBY EXECUTABLE: /home/john/.rvm/rubies/ruby-1.9.3-p286/bin/ruby\n  - EXECUTABLE DIRECTORY: /home/john/.rvm/gems/ruby-1.9.3-p286/bin\n  - RUBYGEMS PLATFORMS:\n    - ruby\n    - x86-linux\n  - GEM PATHS:\n     - /home/john/.rvm/gems/ruby-1.9.3-p286\n     - /home/john/.rvm/gems/ruby-1.9.3-p286@global\n  - GEM CONFIGURATION:\n     - :update_sources =&gt; true\n     - :verbose =&gt; true\n     - :benchmark =&gt; false\n     - :backtrace =&gt; false\n     - :bulk_threshold =&gt; 1000\n  - REMOTE SOURCES:\n     - http://rubygems.org/\n</code></pre>\n\n<p>I also believe the answer his the path and seem to the same has this questions <a href=\"http://stackoverflow.com/questions/1954015/installed-rails-but-the-rails-command-says-its-not-installed\">Installed Rails but the rails command says it&#39;s not installed</a>. But i do not know how to place the path. Any help would be appreciated</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12905363,"title":"Rails 3 - Record.send not working","body":"<p>I have a view that shows all of my customers.  I have a Customer model that is backing this view.  There is a method in the model that will change an attribute from \"\" to a persons initials, \"jh\".  Here is the method.</p>\n\n<pre><code>def print(item, attribute)\n  value = item.send(attribute)\n  if(value.blank?)\n    item.send(attribute + '=', \"jh\")\n  else\n    item.send(attribute + '=', \"\")\n  end\nend\n</code></pre>\n\n<p>When I run this code from the console, it works perfectly.  When I try it in the app, nothing changes.  I am getting the proper 'value' that I expect, but it is never turned into an empty string.  I am sure I am missing something simple here, but please help.  Thanks.  </p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":7,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":446,"score":1,"question_id":5160232,"title":"Rails - given an array of Users - how to get a output of just emails?","body":"<p>I have the following:</p>\n\n<pre><code>@users = User.all\n</code></pre>\n\n<p>User has several fields including email.</p>\n\n<p>What I would like to be able to do is get a list of all the @users emails.</p>\n\n<p>I tried:</p>\n\n<pre><code>@users.email.all but that errors w undefined\n</code></pre>\n\n<p>Ideas? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","prawn"],"answer_count":1,"favorite_count":1,"up_vote_count":4,"down_vote_count":0,"view_count":771,"score":4,"question_id":9565412,"title":"Add image in pdf using Prawn","body":"<p>I've a problem for adding images into a PDF using Prawn as pdf generator. I'm trying to add image using the following code:</p>\n\n<pre><code>def header\n  text \"something\"\n  image \"#{Prawn::DATADIR}/images/logo_small.png\"\nend\n</code></pre>\n\n<p>But app replies to me with the following error:</p>\n\n<pre><code> uninitialized constant Prawn::DATADIR\n</code></pre>\n\n<p>Where is the mistake?</p>\n\n<p>P.S. My app is running on Rails 3.1 &amp; Ruby 1.9.2.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","haml","handlebars.js","slim-lang"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12888371,"title":"Using handlebarsjs as a template for Rails instead of HAML or Slim?","body":"<p>I'm potentially looking to standardize view/design templates for projects across the board with a singular template framework.  Given that we are starting to see work for JS frameworks that can leverage Handlebars, it would seem potentially prudent to likewise begin using Handlebars to replace our usage of HAML (via <a href=\"https://github.com/cowboyd/handlebars.rb\" rel=\"nofollow\">Handlebars.rb</a> and <a href=\"https://github.com/leshill/handlebars_assets\" rel=\"nofollow\">handlebars_assets</a>).  </p>\n\n<p>Does this, experientially, work effectively?  Or can you provide a link to some explanation of why or why not this will work or an example of such a use case?  </p>\n\n<p>Obviously HAML and (more sexy) Slim offer a cleaner template syntax for the most part, but Handlebars.js does have advantages that it carries from Liquid in that it's much more like plain HTML and therefore more \"designer friendly.\"</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2","ruby-on-rails-plugins"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12904831,"title":"How can I make my plugins work in a location other than \"vendor\" in Rails 3.2.8?","body":"<p>I followed some instructions, which I'm unable to locate again, to move my plugins to the \"lib\" directory.</p>\n\n<p>So I have this structure now:</p>\n\n<pre><code>/lib\n/lib/plugins\n/lib/plugins/plugin1\n/lib/plugins/plugin1/lib\n/lib/plugins/plugin1/lib/plugin1.rb\n</code></pre>\n\n<p>I had tried this in my <code>application.rb</code>:</p>\n\n<pre><code>config.autoload_paths += %W(#{config.root}/lib #{config.root}/lib/plugins)\n</code></pre>\n\n<p>But that isn't working. What am I doing wrong?</p>\n\n<p>UPDATE:</p>\n\n<p>Trashing the <code>plugins</code> part of the path and putting the plugins directory directly in doesn't work either. Each plugin has an <code>init.rb</code> file that basically requires the main library, also.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","ruby-on-rails-3.2","railtie"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12783860,"title":"Railtie: How to access initializer and lib loading hooks?","body":"<p>I am developing a gem for my Rails application, which be loaded into it through Railtie. I'm basically inserting models into into, plus libraries and a few initializers, in the old Rails app style. My main concern is not knowing exactly in the whole Rails application loading logic where I should best insert them. My requirement for it is: the gem initializers have to be loaded before the app initializers, same thing with the libs, and the initializers access lib information. In the Rails app workflow, it somehow works. My short-term workaround was the following:</p>\n\n<pre><code>module Gemname\n  def self.initialize_railtie\n    ActiveSupport.on_load :active_record do\n      require 'gemname/lib'\n      require 'gemname/initializers'\n    end\n  end\n  class Railtie &lt; Rails::Railtie\n  initializer 'gemname.insert_into_app' do\n    Gemfile.initialize_railtie\n  end\nend \n</code></pre>\n\n<p>So this way, I'm sure that the libs are loaded before the initializers. Just I'm pretty sure there is a better way to do it, namely, access some railtie hook which allows me to load my libs with the app libs and the initializers with the app initializers. Just I can't seem to be able to find them. </p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12904199,"title":"Assign user_id with http basic authorization","body":"<p>I switched to http basic authorization in my API for now to make testing easier, but now I can't get a user_id... Here's the code in my ThingController that worked with devise:</p>\n\n<pre><code>  def create\n    @thing = Thing.new(params[:thing])\n    @thing.user_id = current_user.id\n    @thing.save\n    if @thing.save\n      redirect_to user_path\n    else\n      render :new\n    end\n  end\n</code></pre>\n\n<p>This now gives me the following error:</p>\n\n<blockquote>\n  <p>Called id for nil, which would mistakenly be 4 -- if you really wanted the id of nil, use object_id</p>\n</blockquote>\n\n<p>and it references the line </p>\n\n<pre><code>@thing.user_id = current_user.id\n</code></pre>\n\n<p>I'm not sure how to assign a user_id to my Things when creating.. Any help would be much appreciated. </p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.1","rake","ruby-on-rails-plugins"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":181,"score":2,"question_id":10532942,"title":"How do I create a rake task for a Rails engine which is not exposed to the host application?","body":"<pre><code># lib/tasks/test.rake\ntask :hello do\n  puts 'hello'\nend\n</code></pre>\n\n<p>$ rake app:hello</p>\n\n<p>To run the task I need to prefix it with \"app:\" and it runs in the context of the dummy app. It is also exposed to the host application (i.e when used as a plugin in a parent Rails app) as <code>rake hello</code>. </p>\n\n<p>I want to run a rake task which does not require a Rails environment and runs some command, but it is run from the engine root, not the dummy app root.</p>\n"},{"tags":["ruby-on-rails-3","persistence","has-many-through"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12904291,"title":"Rails 3.1.0 has_many :through needs to work without looking at database","body":"<p>I have constructed an AJAX query that takes all the current field values on a form, mocks up a Contract (which must not be saved), and returns an aggregate of data on models associated with that Contract via a <code>has_many :through</code> association.</p>\n\n<p>The problem is, the association doesn't work on an unsaved record.</p>\n\n<p>These are my models:</p>\n\n<pre><code>class Contract\n  has_many :plans, :inverse_of =&gt; :contract\n  has_many :planned_items, :through =&gt; :plans, :source =&gt; :items\n  # it's renamed because there is another (irrelevant) link to items\n\n  # this is what the AJAX query returns\n  def unallocated_dates\n    date_range.to_a - planned_items.collect { |i| i.date_range.to_a }.flatten\n    #                 ^ this is what isn't working\n  end\nend\n\nclass Plan\n  belongs_to :contract, :inverse_of =&gt; :plans\n  has_many :items, :inverse_of =&gt; :plan\n\n  def generate_items\n    # builds items on the plan, without saving them\n  end\nend\n\nclass Item\n  belongs_to :plan, :inverse_of =&gt; :items\n  belongs_to :contract, :inverse_of =&gt; :planned_items\nend\n</code></pre>\n\n<p>And here's what I get in a console, looking at that association:</p>\n\n<pre><code>:1 &gt; @mock_up = Contract.new(params[:contract])\n =&gt; #&lt;Contract ... &gt;\n:2 &gt; @mock_up.plans.each(&amp;:generate_items)\n =&gt; [#&lt;Plan ... &gt;, #&lt;Plan ... &gt;, #&lt;Plan ... &gt;]\n:3 &gt; @mock_up.plans.collect(&amp;:items).flatten\n =&gt; [#&lt;Item ... &gt;, #&lt;Item ... &gt;, #&lt;Item ... &gt;, #&lt;Item ... &gt;, ... ]\n:4 &gt; @mock_up.planned_items # should be the same as line 3, but...\n =&gt; []\n</code></pre>\n\n<p>I've used <code>:inverse_of</code> a lot because it has worked for a similar problem before - but I think that was a 'many-to-one-to-many' join rather than a 'one-to-many-to-lots'. Is there any option on the associations to make sure the planned_items get returned as they should, or do I need to set up an alias by hand? Here's the hack I'm thinking of:</p>\n\n<pre><code>alias original_items planned_items\ndef planned_items\n  if original_items.present?\n    original_items\n  else\n    plans.collect(&amp;:items).flatten # returns an array, not an association\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12893693,"title":"Why is my create function redirecting to an index function?","body":"<p>I have an model called purchase.rb that includes a controller and view. There is a form where the purchase is created (like a new post) and then it gets displayed. I am trying to set a character limit on this form. In my purchase.rb file I have -</p>\n\n<p>validates :content, presence: true, length: { maximum: 140 }</p>\n\n<p>So it works perfectly except when I try and enter more than 140 characters. In my view I have </p>\n\n<pre><code>&lt;%= form_for(@purchase) do |f| %&gt;\n  &lt;%= render 'shared/error_messages', object: f.object %&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.text_field :content %&gt;\n\n  &lt;/div&gt;\n  &lt;%= f.submit \"Post\", class: \"btn btn-large btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>So when I submit it it should go to the create action of the purchases controller. Instead it goes to the index action of the purchases controller. Here are the relevant parts of that </p>\n\n<pre><code>class PurchasesController &lt; ApplicationController\n  before_filter :signed_in_user, only: [:create, :destroy]\n\n  def index\n    @purchases=Purchase.search(params[:search])\n    @sales=Sale.all\n  end\n\n  def home \n    @purchases = Purchase.all\n    @sales = Sale.all\n    @user= User.find(params[:id])\n  end\n\n  def create\n    @purchase = current_user.purchases.build(params[:purchase])\n\n    if @purchase.save\n      flash[:success] = \"Purchase created!\"\n      redirect_to :back\n    else\n      render \"users#show\" //(I am not sure if this line is correct. I want it to render the users profile page that it was at before, except with an error message)\n    end\n  end\n</code></pre>\n\n<p>I think what is happening is in @purchase.save can't happen because there are too many characters. So it goes to else -> render users#show. But then I have no idea why it trys to redirect to the index action of the purchases controller. One thing is that I have a search function on another page that displays results in the index action of the purchases controller. So, when the (too long) purchase is submitted, it loads a page showing the search bar with the purchase info in the search and the search results below. Finally, here is shared/error_messages. I don't think this is relevant because rails isn't finding an error with any of this, just doing the wrong thing, but here it is. </p>\n\n<pre><code>&lt;% if object.errors.any? %&gt;\n  &lt;div id=\"error_explanation\"&gt;\n    &lt;div class=\"alert alert-error\"&gt;\n      The form contains &lt;%= pluralize(object.errors.count, \"error\") %&gt;.\n    &lt;/div&gt;\n    &lt;ul&gt;\n    &lt;% object.errors.full_messages.each do |msg| %&gt;\n      &lt;li&gt;* &lt;%= msg %&gt;&lt;/li&gt;\n    &lt;% end %&gt;\n    &lt;/ul&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":51,"score":0,"question_id":12903491,"title":"Purchase Timer in Rails","body":"<p>I'm looking to create one of those purchase timers sort of like what they've got on Ticketmaster, where you have x minutes to pay for your order before it is rolled back.</p>\n\n<p>I'm not quite sure how to do this, though. Looked at the <a href=\"https://github.com/collectiveidea/delayed_job\" rel=\"nofollow\">delayed_job</a> gem and the railscast about it after somebody suggested those, and it seemed like the functionality is different -- delayed job allows you to delay an action, but doesn't make that delay conditional on anything else's happening, and I can't figure out how to do so.</p>\n\n<p>I'm basically looking for something that allows me to </p>\n\n<p>a) have (pseudo)code sort of like this</p>\n\n<pre><code>if job_timer == 0\n   @order.destroy\n   #Some redirect/flash stuff\nend\n</code></pre>\n\n<p>b) display that timer on the page (ie, \"You have 3 min, 25 seconds left to pay before your order is reversed.\")</p>\n\n<p>Any ideas what to do/where to look?</p>\n\n<p>Thanks,</p>\n\n<p>Sasha</p>\n"},{"tags":["ruby-on-rails-3","csv"],"answer_count":2,"favorite_count":2,"up_vote_count":2,"down_vote_count":0,"view_count":1217,"score":2,"question_id":8174299,"title":"Tab delimited file parsing in Rails","body":"<p>I have a file that looks like this</p>\n\n<pre><code>ID Name  Car\n1  Mike  Honda\n2  Adam  Jim\n</code></pre>\n\n<p>These values are tab delimited, and from this I want to parse it in Ruby and put it into my database. </p>\n\n<p>I have tried the following</p>\n\n<pre><code>require 'csv'\n\nCSV.foreach(\"public/files/example.tab\", {:col_sep =&gt; \"\\t\"}) do |row|\n  @stuff = row[0]\nend\n</code></pre>\n\n<p>but <code>@stuff</code> just returns the whole entire object, and doesn't seem to be using the column separator I specified.</p>\n\n<p>It also does not take into account that the first row is a header.</p>\n\n<p>How can I parse a tab delimited file in Ruby and how do I tell it that the first row is a header?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12903767,"title":"ActiveRecord select from two models, sorted by date?","body":"<p>Given 2 ActiveRecord::Base models <code>User</code> and <code>InviteRequest</code>, where</p>\n\n<pre><code>User(id: integer, username: string, email: string, market_id: integer) # lots more omitted fields, etc.\nInviteRequest(id: integer, email: string, market_id: integer)\n</code></pre>\n\n<p>How can I find all users and invite requests, so that the entire returned set can be sorted by date and paginated (single AR scope)?</p>\n"},{"tags":["javascript","ruby-on-rails","ruby-on-rails-3"],"answer_count":4,"favorite_count":20,"up_vote_count":45,"down_vote_count":0,"view_count":9697,"score":45,"question_id":3437585,"title":"Best way to add page specific javascript in a Rails 3 app?","body":"<p>Rails 3 has some unobtrusive javascript which is pretty cool.</p>\n\n<p>But I was wondering what the best way is to include additional JS for a particular page.</p>\n\n<p>For example, where I might have previously done:</p>\n\n<pre><code>&lt;%= f.radio_button :rating, 'positive', :onclick =&gt; \"$('some_div').show();\" %&gt;\n</code></pre>\n\n<p>We can now make it unobtrusive with something like</p>\n\n<pre><code>&lt;%= f.radio_button :rating, 'positive' %&gt;\n\n# then in some other file\n$('user_rating_positive').click(function() {\n  $('some_div).show();\n}\n</code></pre>\n\n<p>So I guess my question is where/how to include that JS?  I don't want to fill up the application.js file because this JS is only applicable to this one view.  Should I include a custom JS file for each page somehow, or stick it in an instance variable that the header looks for?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":18,"score":0,"question_id":12903095,"title":"Can inner parameters of a URL router be optional?","body":"<p>i have the following route</p>\n\n<p><code>/admin(/:language_code)/languages(.:format)                                admin/languages#index {:language_code=&gt;\"en\"}</code></p>\n\n<p>but it won't seem to match without a language code inplace event tho the parenthesis should make it optional.</p>\n\n<p>Is this possible?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","sqldatatypes"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12902221,"title":"Rails NullBoolean?","body":"<p>Does Rails have a built-in equivalent to the Django NullBoolean, accepting three values (nil, true, false)? If not, how would you recommend implementing it?</p>\n\n<p>In my case I have a table of <code>Overrides</code> and a table of <code>Objects</code>. <code>Objects</code> can have many <code>Overrides</code>. <code>Overrides</code> are nearly identical in structure to <code>Objects</code>. Before reading the value of an <code>Object</code>, I'm pulling its <code>Overrides</code>, conditionally picking through them, and then applying those values on top of the <code>Object</code>.</p>\n\n<p>Any field of an <code>Override</code> that is nil does not apply any changes. This system is working well for me, but I just added a boolean field to <code>Objects</code>, so I need to put a nullable boolean on <code>Overrides</code>. Django's <code>NullBoolean</code> works well in this type of scenario, but I'm having trouble finding a rails equivalent.</p>\n"},{"tags":["ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12902052,"title":"Rails 3 - set the filename in a respond_to","body":"<p>This seems like it should be simple, but I can't seem to find a straight answer.</p>\n\n<p>I have added a csv mime-type, and the following seems to work, <strong>except</strong> that the downloaded file is always named \"report.csv\".</p>\n\n<p>In my controller:</p>\n\n<pre><code>def report\n  respond_to do |format|\n    format.html\n    format.csv do\n      render :template =&gt; \"summary/report.csv.erb\",\n             :filename =&gt; \"foo\" #doesn't work\n    end\n  end\nend\n</code></pre>\n\n<p>I think it's using the default renderer (I haven't implemented an alternate renderer), but I can't seem to find complete docs on the options available.</p>\n\n<p>Isn't there something like a \"filename\" option or something that I can use?  Is there a better approach?</p>\n"},{"tags":["ruby-on-rails-3","bash","rvm","command-prompt"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":69,"score":0,"question_id":12898205,"title":"Display in bash prompt","body":"<p>I am working with bash and still unfamiliar with the difference between <code>.profile</code>, <code>.bashrc</code>, <code>.bash_profile</code>.</p>\n\n<p>My desired result is to have the ruby version and <code>rvm gemset</code> show up on my bash prompt.</p>\n\n<p>I added <code>PS1=\"\\$(~/.rvm/bin/rvm-prompt) $PS1\"</code> to .bash_profile (via xcode) and it displays </p>\n\n<pre><code>ruby-1.9.3-p286 John-MacBook-Air:~ john$\n</code></pre>\n\n<p>What I trying to get is </p>\n\n<pre><code>ruby-1.9.3-p286@rails3 $\n</code></pre>\n\n<p>With \"rails3\" being the output of <code>rvm gemset</code>.</p>\n\n<p><strong>How do I get <code>John-MacBook-Air:~ john</code> removed from the prompt?</strong></p>\n\n<p>I tried adding the line in the .profile, and .bashrc with no luck but it seems to work in the .bash_profile.  Any clarification between these files would be greatly appreciated.  I am running rvm on a Mac.</p>\n\n<p><strong>SOLUTION</strong></p>\n\n<p>include the following to the .bash_profile</p>\n\n<pre><code>PS1='\\W \\$ '\nPS1=\"\\$(~/.rvm/bin/rvm-prompt) $PS1\"\n</code></pre>\n\n<p>the prompt looks like</p>\n\n<pre><code>ruby-1.9.3-p286@rails3 ~ $ \n</code></pre>\n"}]}
{"total":34675,"page":19,"pagesize":100,"questions":[{"tags":["ruby","ruby-on-rails-3","heroku","ruby-1.9.3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":110,"score":2,"question_id":12886648,"title":"Heroku with ruby 1.9.3 causing many different crashes","body":"<p>I go to redeploy my heroku apps with a new gem in Gemfile and it crashes on startup </p>\n\n<pre><code>/app/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require': libruby.so.1.9: cannot open shared object file: No such file or directory - /app/vendor/bundle/ruby/1.9.1/gems/bcrypt-ruby-3.0.1/lib/bcrypt_ext.so (LoadError)\n</code></pre>\n\n<p>This is happening no matter what branch I deploy (old stable ones...) and only fixes by doing a <code>heroku rollback</code>.</p>\n\n<p>I believe this is caused by heroku recently updating their ruby 1.9.3 because I was having this issue <a href=\"http://stackoverflow.com/questions/12880632/heroku-app-crashes-with-libruby-so-1-9-cannot-open-shared-object-file\">Heroku app crashes with &#39;libruby.so.1.9: cannot open shared object file&#39;</a> . Removing the nokogiri gem stopped the exception I was getting but then there's still this. More similar errors occur when I add new gems. </p>\n\n<p>The whole problem was solved by deploying to a new heroku app but that's not something I can just do on my production server. </p>\n\n<p>Any ideas on fixing the issue or somehow \"refreshing\" my app?</p>\n\n<p>my gemfile:</p>\n\n<pre><code>source \"https://rubygems.org\"\n\nruby \"1.9.3\"\ngem \"rails\", \"3.2.3\"\ngem \"thin\"\n\n# Bundle edge Rails instead:\n# gem \"rails\", :git =&gt; \"git://github.com/rails/rails.git\"\n\ngem \"mongoid\"\ngem \"devise\"\ngem \"haml\"\ngem \"sass\"\ngem \"exceptional\"\ngem \"kaminari\"\ngem \"mongoid_search\"\n#gem \"nokogiri\"\ngem \"bson_ext\"\ngem \"heroku-mongo-backup\"\ngem \"aws-s3\"\n# Gems used only for assets and not required\n# in production environments by default.\ngroup :assets do\n  gem \"haml-rails\",   \"~&gt; 0.3.4\"\n  gem \"sass-rails\",   \"~&gt; 3.2.3\"\n  gem \"coffee-rails\", \"~&gt; 3.2.1\"\n\n  # See https://github.com/sstephenson/execjs#readme for more supported runtimes\n  # gem \"therubyracer\", :platform =&gt; :ruby\n\n  gem \"uglifier\", \"&gt;= 1.0.3\"\nend\n\ngem \"jquery-rails\"\n\ngroup :test do\n  gem \"mongoid-rspec\"\nend\n\n# To use ActiveModel has_secure_password\n# gem \"bcrypt-ruby\", \"~&gt; 3.0.0\"\n\n# To use Jbuilder templates for JSON\n# gem \"jbuilder\"\n\n# Use unicorn as the app server\n# gem \"unicorn\"\n\n# Deploy with Capistrano\n# gem \"capistrano\"\n\n# To use debugger\n# gem \"ruby-debug19\", :require =&gt; \"ruby-debug\"\n\n#\ngroup :development do\n  gem \"letter_opener\"\nend\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3","web-applications","asynchronous","thrift"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12850761,"title":"How do I asynchronously access my Java back end service from Rails app thorugh Apache Thrift?","body":"<p>So I have a pretty heavy back end service written in Java that is connected to a Rails app through Apache Thrift. I am using TCP connection to access the back end service which is running on a remote machine.</p>\n\n<p>For each incoming request, my Rails Controller does the following:</p>\n\n<pre><code>transport = Thrift::BufferedTransport.new(Thrift::Socket.new(SERVER_ADDRESS, SERVER_PORT))\nprotocol = Thrift::BinaryProtocol.new(transport)\nclient = MyService::Client.new(protocol)\ntransport.open()\n\n@result = client.processUserRequest(query)\n\ntransport.close()\n</code></pre>\n\n<p>Now the above service call clearly blocks for the entire time the back end server processes the request. Is there a way I can make this asynchronous? So that while a request is being serviced by the back end server the Web Front End can continue to accept incoming HTTP requests. What are my options to accomplish this?</p>\n\n<p>I am using Phusion Passenger with Apache. I expect to see few dozens to few hundred concurrent connections at most. My Web server is on a small ec2 instance with 1.7 GB RAM.</p>\n\n<p>I am quite new to Ruby/Rails (coming from a Java/C++ background), so still trying to grasp how things work in the Ruby land.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","ruby-on-rails-3.2","route"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":68,"score":2,"question_id":12847809,"title":"Rails route constraint not working","body":"<p>I want to match all URLs that begin with <code>/company/</code>, so I have this route:</p>\n\n<pre><code>match '/*id' =&gt; 'high_voltage/pages#show', :constraints =&gt; { id: /^company\\/.*/ }\n</code></pre>\n\n<p>But the constraint doesn't do anything. The URL <code>/abc</code> also matches this route and the <code>PagesController</code> throws an error.</p>\n\n<p>How should I specify this?</p>\n\n<p>I need the <code>id</code> parameter to contain <code>company/</code> in the beginning, so please don't say to just make the route <code>match '/company/*id'</code>. That will give the controller an <code>id</code> parameter without the <code>company/</code>.</p>\n\n<p><em><strong>UPDATE</em></strong>: I did try the regex above in normal Ruby and it works. I also tried without the ^ in front of company (though I do need company to be the first word), no luck.</p>\n\n<p><em><strong>UPDATE 2</em></strong>: It seems the problem is with the wildcard, do wildcard routes work with constraints? I can't get ANY constraint to work when there's a wildcard in the route.</p>\n\n<p><em><strong>UPDATE 3</em></strong>: Turns out this is simply a <a href=\"https://github.com/rails/rails/issues/7924#issuecomment-9421227\" rel=\"nofollow\">bug in Ruby on Rails</a>.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12902244,"title":"Email notifications in Rails","body":"<p>In my Rails 3.2 project, I have a form to create a new post in <code>new.html.erb</code> in <code>app/views/posts/</code></p>\n\n<pre><code>&lt;%= form_for(@post) do |post_form| %&gt;\n  ...\n  &lt;div class=\"field\"&gt;\n    &lt;%= post_form.label :email %&gt;&lt;br /&gt;\n    &lt;%= post_form.text_field :email %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= post_form.label :title %&gt;&lt;br /&gt;\n    &lt;%= post_form.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= post_form.label :content %&gt;&lt;br /&gt;\n    &lt;%= post_form.text_field :content %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= post_form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then the <code>create</code> function in <code>posts_controller.rb</code></p>\n\n<pre><code>def create\n  @post = Post.new(params[:post])  \n  if @post.save\n    format.html { redirect_to @post }\n  else\n    format.html { render action: \"new\" }\n  end\nend\n</code></pre>\n\n<p>When the user submits a post, I want to send an email notification to <code>email</code> that \"You have submitted a post with title <code>title</code> and content <code>content</code>.\" How can I do that?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","table"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":557,"score":2,"question_id":7560965,"title":"In Rails 3.1, how can I create an HTML table generator that uses block style formatting.","body":"<p>I'm developing an application that displays tabular data in many different areas and I find myself constantly using the same HTML table structure over and over. For example a particular table looks like this:</p>\n\n<pre><code>%table.zebra-striped#user-table{ :cellspacing =&gt; \"0\" }\n  %colgroup\n    %col{:id =&gt; \"email\"}\n    %col{:id =&gt; \"username\"}\n    %col{:id =&gt; \"sign-in-count\"}\n    %col{:id =&gt; \"last-sign-in-at\"}\n\n  %thead\n    %tr\n      %th{:id =&gt; \"email-head\", :scope =&gt; \"col\"} E-mail\n      %th{:id =&gt; \"username-head\", :scope =&gt; \"col\"} Username\n      %th{:id =&gt; \"sign-in-count-head\", :scope =&gt; \"col\"} Sign Ins\n      %th{:id =&gt; \"last-sign-in-at-head\", :scope =&gt; \"col\"} Last Sign In\n\n  %tbody\n    - @users.each do |user|\n      %tr{ :class =&gt; zebra }\n        %td\n          =h user.email\n        %td\n          =h user.username\n        %td\n          =h user.sign_in_count\n        %td\n          =h user.last_sign_in_at\n</code></pre>\n\n<p>Ideally, I would like to create some kind of helper method where I could do something like:</p>\n\n<pre><code>= custom_table_for @users do\n  = column :email\n  = column :username do |user|\n    = link_to user.username, user_path(user)\n  = column \"Sign Ins\", :sign_in_count\n  = column :last_sign_in_at\n</code></pre>\n\n<p>This way I can change the formatting of the data in the columns and the column header names if I'm not happy with default values, but have the table generated for me. </p>\n\n<p>I suppose I could create a normal helper, but I'd have to use arrays and I have no idea how I could include custom data formatting per column. </p>\n\n<p>active_admin has something similar to this which you can see here: <a href=\"http://activeadmin.info/docs/3-index-pages/index-as-table.html\" rel=\"nofollow\">http://activeadmin.info/docs/3-index-pages/index-as-table.html</a></p>\n\n<p>Any leads or ideas would be greatly appreciated. </p>\n"},{"tags":["ruby-on-rails-3","factory-girl","rspec-rails"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12849167,"title":"FactoryGirl string together has_many relationships (i.e. User -> Blog -> Post )","body":"<p>Let's say I have three models: User, Blog, and Post.  My user model will have:</p>\n\n<pre><code>User Model\n  has_one :blog\n  has_many :posts through: :blog\n\n\nBlog Model\n  belongs_to :user\n  has_many :posts\n\nPost \n  belongs_to :blog\n</code></pre>\n\n<p>When I do a factory, I can do something like this: </p>\n\n<pre><code>FactoryGirl.define do\n  factory :post do\n    title \"something\"\n    content \"long text\"\n    blog \n  end\nend\n</code></pre>\n\n<p>Which creates a post belonging to a blog.  What I don't see is what I should put in :post so that FactoryGirl creates the user, then creates a blog belonging to that user, and then creates a post belonging to that blog/user.  I didn't really see anything in FactoryGirl's documentation to address this.  </p>\n"},{"tags":["ruby-on-rails-3","heroku"],"answer_count":0,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12902253,"title":"Rails 3 + Heroku: Find out dyno's memory usage","body":"<p>Is there any way to find out how much memory a heroku web dyno is using? Let's say I wanna write a rake task that runs periodically and checks every dyno's memory usage. How could I do this? Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":45,"score":1,"question_id":12887036,"title":"Merge an object with an Activerecord::Relation","body":"<p>In my current project, I need to add a record to an ActiveRecord::Relation. I can't use it as an array, because I need to apply an ordering scope after the \"merge\" (and then, also pagination). The problem is that I can't find the way to do it in a \"nice\" way.</p>\n\n<p>The relation that I need to merge is very simple: a typical friendship association. Essentially, I need a relation with all the friends of a user AND the user. If I could use Arrays, it would be something as simple as:</p>\n\n<pre><code>user.friends + [user]\n</code></pre>\n\n<p>But I need a Relation. Now I'm using this scope:</p>\n\n<pre><code>scope :user_and_friends, lambda { |user| includes(:friendships).where(Friendship.arel_table[\"friend_id\"].eq(user.id).or(arel_table[\"id\"].eq(user.id))) }\n</code></pre>\n\n<p>But it's terribly slow. Can you help me?</p>\n"},{"tags":["ruby-on-rails-3","rspec","mongoid","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12898409,"title":"Setting up Embedded Mongoid Models with Factory_Girl","body":"<p>So I'm playing with Mongoid, Rspec and Factory_Girl and I had some issues with an embedded document.</p>\n\n<p>I had the following models:</p>\n\n<pre><code>class Profile    \n   include Mongoid::Document\n\n   #Fields and stuff\n      embeds_one :address\n\n   validates :address, presence: true \nend\n\nclass Address    \n   include Mongoid::Document\n\n   #Fields and stuff\n      embedded_in :profile \nend\n</code></pre>\n\n<p>So when I defined a factory like this:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :profile do\n    #fields\n\n    address\n  end\nend\n</code></pre>\n\n<p>I got an error like this:</p>\n\n<pre><code>Failure/Error: subject { build :profile }\n     Mongoid::Errors::NoParent:\n\n       Problem:\n         Cannot persist embedded document Address without a parent document.\n       Summary:\n         If the document is embedded, in order to be persisted it must always have a reference to it's parent document. This is most likely cause by either calling Address.create or Address.create! without setting the parent document as an attribute.\n       Resolution:\n         Ensure that you've set the parent relation if instantiating the embedded document direcly, or always create new embedded documents via the parent relation.\n</code></pre>\n\n<p>I got it working by changing the factory to something like this:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :profile do\n    #fields\n\n    after(:build) do |p| \n      p.create_address(FactoryGirl.attributes_for(:address))\n    end\n  end\nend\n</code></pre>\n\n<p>This works but I'm hoping there's a more native Factory_Girl way of doing this. It seems like there should be. </p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","associations","has-many-through","mass-assignment"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":70,"score":0,"question_id":12901072,"title":"rspec: Can't mass-assign protected attributes when model already have attr_accessible on column","body":"<p>My User model:\n</p>\n\n<pre><code>class User &lt; ActiveRecord::Base\n  attr_accessible :name, :email, :password, :password_confirmation\n  has_many :course_relationships\n  has_many :courses, through: :course_relationships\nend\n</code></pre>\n\n<p>My Course model:<br>\n</p>\n\n<pre><code>class Course &lt; ActiveRecord::Base\n  attr_accessible :code, :name\n\n  has_many :course_relationships\n  has_many :users, through: :course_relationships\n\n  validates :code, presence: true, uniqueness: true\n  validates :name, presence: true\nend  \n</code></pre>\n\n<p>My CourseRelationship model:</p>\n\n<pre><code>class CourseRelationship &lt; ActiveRecord::Base\n  attr_accessible :course_id\n  attr_protected :user_id\n\n  belongs_to :user\n  belongs_to :course\n\n  validates :course_id, presence: true\n  validates :user_id, presence: true\nend\n</code></pre>\n\n<p>My Rspec test:\n</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe CourseRelationship do\n\n  let!(:role_student) { FactoryGirl.create(:role_student) }\n  let!(:role_teacher) { FactoryGirl.create(:role_teacher) }\n  let!(:student) { FactoryGirl.create(:user, email:      \"student@sinhvien.hoasen.edu.vn\") }\n  let!(:teacher) { FactoryGirl.create(:user, email: \"teacher@hoasen.edu.vn\") }\n  let(:course) { FactoryGirl.create(:course) }\n  let(:course_relationship) { teacher.courses.build(course_id: course.id) }\n\n  subject { course_relationship }\n\n  it { should respond_to(:user_id) }\n  it { should respond_to(:course_id) }\n\n  it { should be_valid }\nend  \n</code></pre>\n\n<p>The code <code>let(:course_relationship) { teacher.courses.build(course_id: course.id) }</code> raise an error <code>ActiveModel::MassAssignmentSecurity::Error:\n       Can't mass-assign protected attributes: course_id</code>but i don't know why when i have already attr_accessible on course_id. I have restarted rspec several times but it still error. I've set up another <code>role_relationships</code> between User and Role model with <code>has_many through:</code> but it work fine. Can somebody help? :(</p>\n"},{"tags":["authentication","openid","ruby-on-rails-3","openid-provider"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":361,"score":3,"question_id":4575740,"title":"Create an own \"OpenID-like system\" Provider","body":"<p>I know that Facebook use their own OpenID-like system called \"Facebook connect\", which you can use to authenticate users on your site, among other features.</p>\n\n<p>In my case I have multiple Ruby on Rails applications:</p>\n\n<ul>\n<li>users.example.com</li>\n<li>profiles.example.com</li>\n<li>photos.example.com</li>\n<li>...</li>\n</ul>\n\n<p>I would like to use 'users.example.com' as a <em>web service</em> that allows users to authenticate to all my other applications the same way as works \"Facebook connect\" or OpenID. In few words, <strong>'users.example.com' must works as a \"OpenID-like system\"</strong> for my applications in 'example.com'.</p>\n\n<p>Can anyone give me tips and links to some useful resources?</p>\n\n<p><em>P.S.</em>: since I am a newbie in this matter, I do not know if I'm saying things that make sense. So someone could help me to understand (if I am wrong) ...</p>\n"},{"tags":["ruby-on-rails-3","form-for","nested-routes"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12901270,"title":"Rails 3 new action error","body":"<p>I know this is kind of weird, perhaps I'm so tired but today I was opened my project and when I try to see the new form it show's me a show error, i ran rake routes and everything is ok:</p>\n\n<p>I got a EmailLayout scaffold inside a namespace called \"mailing\"</p>\n\n<p>my routes.rb file has:</p>\n\n<pre><code>namespace :mailing do \n  resources :email_layouts do\n    member do\n      get \"preview\"\n    end\n  end\nend\n</code></pre>\n\n<p>and if I run rake routes:</p>\n\n<pre><code>mailing_email_layouts \nGET    /mailing/email_layouts(.:format)          mailing/email_layouts#index\nPOST   /mailing/email_layouts(.:format)          mailing/email_layouts#create\nGET    /mailing/email_layouts/new(.:format)      mailing/email_layouts#new\nGET    /mailing/email_layouts/:id/edit(.:format) mailing/email_layouts#edit\nGET    /mailing/email_layouts/:id(.:format)      mailing/email_layouts#show\nPUT    /mailing/email_layouts/:id(.:format)      mailing/email_layouts#update\nDELETE /mailing/email_layouts/:id(.:format)      mailing/email_layouts#destroy\n\nBut… when i write http://localhost:3000/mailing/email_layouts/new\n</code></pre>\n\n<p>I have the following error:</p>\n\n<pre><code>No route matches {:action=&gt;\"show\", :controller=&gt;\"mailing/email_layouts\", \n:id=&gt;#&lt;EmailLayout id: nil, name: nil, created_at: nil, updated_at: nil&gt;}\n</code></pre>\n\n<p>Why does rails taking me to the show action?</p>\n\n<p>I've noticed that error was rised from the form_for tag:</p>\n\n<pre><code>&lt;%= form_for [:mailing, @email_layout], \n:html =&gt; { :class =&gt; 'form-horizontal' } do |f| %&gt;\n</code></pre>\n\n<p>But the really weird thing is that all actions works fine, even /mailing/email_layouts/1/edit</p>\n\n<p>Hope you can help me...\nThanks from now!</p>\n"},{"tags":["ruby","ruby-on-rails-3","imagemagick","ubuntu-12.04","rmagick"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":88,"score":0,"question_id":12887575,"title":"error when installing rmagic gem on Ubuntu 12.04 for Ruby on Rails","body":"<p>I am trying to get my Ruby on Rails application working and installing RMagic gem.\nBut I get an error that says \"Can't install RMagick 2.13.1. Can't find the ImageMagick library or one of the dependent libraries.\" Altough I have ImageMagick installed with its dependences. ( <a href=\"http://i46.tinypic.com/2vdl1g6.png\" rel=\"nofollow\">http://i46.tinypic.com/2vdl1g6.png</a> )</p>\n\n<p>terminal log <a href=\"http://pastebin.com/vcgkbwZR\" rel=\"nofollow\">http://pastebin.com/vcgkbwZR</a></p>\n\n<p>I even tried to installed RMagic from Synaptic, but I get the same error when I run \"bundle\" command.</p>\n\n<p>Through my search, some people had problem with lib dependencies, but I believed I have them all installed.</p>\n\n<p>Another solution I found is this ( <a href=\"http://stackoverflow.com/questions/131179/error-installing-rmagick-from-gem\">error installing RMagick from gem</a> ) a little bit old and not sure if it is going to work for 12.04. BUT, I don't know where those configurations should go.</p>\n"},{"tags":["javascript","ruby-on-rails","ruby","ruby-on-rails-3","partial-views"],"answer_count":3,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":82,"score":0,"question_id":12900226,"title":"How to pass a variable from controller to javascript within a view?","body":"<p>I have an array @fields which has text and an id, asset_id.\nTo pass local variables from controller to view in render we use</p>\n\n<pre><code>render(:template =&gt; \"assets/invalid\", :locals =&gt; {:asset_id =&gt; params[:id], :fields =&gt; @fields})\n</code></pre>\n\n<p>The view is</p>\n\n<pre><code>&lt;div id=\"panel\"&gt;\n  &lt;script&gt;\n    alert('Invalid values for ')\n    window.location = \"../assets/\" \n  &lt;/script&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This should generate a popup box. However, I want the popup box to redirect to \"../assets/asset_id\" and also display 'Invalid values for + fields'</p>\n\n<p>The following doesn't work,</p>\n\n<pre><code>&lt;div id=\"panel\"&gt;\n  &lt;script&gt;\n    var fields = fields\n    var asset_id = asset_id \n    alert('Invalid values for ' + fields )\n    window.location = \"../assets/\" + asset_id \n  &lt;/script&gt;\n&lt;/div&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","fancybox","simple-form"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12900532,"title":"js.erb file is not fired up when try upload a image","body":"<p>I have inside a fancybox box this form:</p>\n\n<pre><code>&lt;%= simple_form_for(@message, :remote =&gt; true, :html =&gt; {:multipart =&gt; true}, :url =&gt; { :controller =&gt; \"users/messages\", :action =&gt; \"create\"} ) do |f| %&gt;\n &lt;%= f.error_notification %&gt;\n &lt;%= f.input :subject, :input_html =&gt; { :maxlength =&gt; 500} %&gt;\n &lt;%= f.input :message_image, :as =&gt; :file %&gt;\n &lt;%= f.button :submit, t('.send_message'), :class =&gt; 'btn-large btn-primary', \"data-disable-with\" =&gt; t('.send_message'), :confirm =&gt; t('.sure_send_message') %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>This is my create action:</p>\n\n<pre><code>def create\n @message = Message.new(params[:message])\n respond_to do |format|\n  if @message.save\n   format.js { render :partial =&gt; \"users/messages/templates/sent_by_user/create\" }\n  else\n   format.js { render :partial =&gt; \"users/messages/templates/sent_by_user/nosave\" }\n  end\n end \nend\n</code></pre>\n\n<p>The files <code>create.js.erb</code> or <code>nosave.js.erb</code> file is working fine if I don't try upload a image</p>\n\n<p>If I try  upload a image this files is not rendered.</p>\n\n<p>However in my log I can see:</p>\n\n<pre><code>Processing by Users::MessagesController#create as JS\n  Parameters: {\"message\"=&gt;{\"message_image\"=&gt;#&lt;ActionDispatch::Http::UploadedFile:0xf7a85c8 @original_filename=\"cara_enfadada.jpg\", @content_type=\"image/jpeg\", @headers=\"Content-Disposition: form-data; name=\\\"message[message_image]\\\"; filename=\\\"cara_enfadada.jpg\\\"\\r\\nContent-Type: image/jpeg\\r\\n\", @tempfile=#&lt;File:/tmp/RackMultipart20121015-21710-6oxtn2&gt;&gt;, \"subject\"=&gt;\"estrella de neutronessssssssssss\"}, \"commit\"=&gt;\"Enviar mensaje\", \"utf8\"=&gt;\"✓\", \"authenticity_token\"=&gt;\"mfSsl0HafWoW86YiO2Hj7zMepAITZlHHBtUqW0wzubU=\", \"remotipart_submitted\"=&gt;\"true\", \"X-Requested-With\"=&gt;\"IFrame\", \"X-Http-Accept\"=&gt;\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01\", \"locale\"=&gt;\"es\"}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Rendered users/messages/templates/sent_by_user/_nosave.js.erb (0.2ms)\nCompleted 200 OK in 498ms (Views: 1.5ms | Solr: 0.0ms)\n</code></pre>\n\n<p>On google chrome console I get the next alert:</p>\n\n<pre><code>Resource interpreted as Document but transferred with MIME type text/javascript:\n</code></pre>\n\n<p><strong>I'm using remotipart gem but I dont find the error...\nWhere is the error?\nThank you</strong></p>\n"},{"tags":["ruby-on-rails-3","timezone"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12900437,"title":"In Rails, Turn Off Time Zone Conversion for Specified Column","body":"<p>Pretty simple, I need to disable time zone conversion for specific columns. I will handle any TZ conversion manually, but I need Rails 3 to forego conversion in both <em>writing</em> and <em>reading</em>, and any AREL functions. But, I don't want to disable the conversion for non-specified attributes.</p>\n\n<p>Ok, I know how to disable it for reading:</p>\n\n<pre><code>self.skip_time_zone_conversion_for_attributes = [:test_timestamp]\n</code></pre>\n\n<p>But this only works for <em>reading</em>. When writing the attribute, it still converts to UTC (yes, I tested this in 3.2.8).</p>\n"},{"tags":["ruby-on-rails-3","activerecord","polymorphic-associations"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12899191,"title":"Rails 3: Include specific associations","body":"<p>I have some problems with the eager loading functionality:</p>\n\n<p>Having the following (simplified) associations</p>\n\n<pre><code>class Reservation &lt; ActiveRecord::Base\n  has_and_belongs_to_many :alleys\nend\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Alley &lt; ActiveRecord::Base\n  has_and_belongs_to_many :reservations\nend\n</code></pre>\n\n<p>I want to include reservations to alleys which have a specific property (in this case I want to load all reservations for a given date per alley).</p>\n\n<p>Something like</p>\n\n<pre><code>Alley.includes(:reservations).where(\"reservations.date = ?\", Date.today)\n</code></pre>\n\n<p>but this filters all the alley which don't have valid reservations.</p>\n\n<p>Is there any way to apply a filter to the include mechanism in order to \"fill\" the association an_alley.reservations for every alley (even for those without valid reservations).</p>\n\n<p>I sadly removed all my previous attempts to achieve this which i mainly found here, but I did try to Left Outer Join my alleys table with the reservations table which obviously resulted in getting multiple entries for each alley. </p>\n\n<p>Any piece of advise or references would help me.</p>\n\n<p>Thanks in advance.</p>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":208,"score":0,"question_id":7392846,"title":"Rails 3 SQL query select with joins","body":"<p>I have a problem with select fonction and joins.</p>\n\n<p>here is my current query.</p>\n\n<pre><code>@search = Building.joins('INNER JOIN \"floors\" ON \"floors\".\"building_id\" = \"buildings\".\"id\" INNER JOIN \"spaces\" ON \"spaces\".floor_id = \"floors\".id')\n</code></pre>\n\n<p>but i want to have more option in my select to use floors.number, space.number i tried this</p>\n\n<pre><code>@search = Building.select('buildings.name, floors.number, spaces.number).joins('INNER JOIN \"floors\" ON \"floors\".\"building_id\" = \"buildings\".\"id\" INNER JOIN \"spaces\" ON \"spaces\".floor_id = \"floors\".id')\n</code></pre>\n\n<p>in my view i got erreor.. here is my view</p>\n\n<pre><code>&lt;% for b in @building do %&gt;\n\n&lt;div style='width:100%;margin-left:auto;margin-right:auto;margin-top:5px;'&gt;\n\n    &lt;div style=\"float:left;width:50%\"&gt;&lt;%= b.name %&gt;&lt;/div&gt;\n    &lt;div&gt;&lt;%= link_to 'view', building_path(b) %&gt;&lt;/div&gt;\n\n&lt;/div&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>this is the error i get</p>\n\n<pre><code>ActionController::RoutingError in Search_engine#show\n\nShowing /Users/stephanebaribeau/Sites/cadifice/app/views/search_engine/show.html.erb where line #21 raised:\n\nNo route matches {:action=&gt;\"show\", :controller=&gt;\"buildings\", :id=&gt;#&lt;Building name: \"gigi\"&gt;}\n\nExtracted source (around line #21):\n\n18:     &lt;div style='width:100%;margin-left:auto;margin-right:auto;margin-top:5px;'&gt;\n19:     \n20:         &lt;div style=\"float:left;width:50%\"&gt;&lt;%= b.name %&gt;&lt;/div&gt;\n21:         &lt;div&gt;&lt;%= link_to 'view', building_path(b) %&gt;&lt;/div&gt;\n22:         \n23:     &lt;/div&gt;\n24: \n</code></pre>\n\n<p>thanks</p>\n\n<p>After adding building.id, floors.id and spaces.id on my select i try to show the floors.number and spaces.number</p>\n\n<pre><code>&lt;%= debug @building %&gt;\n</code></pre>\n\n<p>give me </p>\n\n<pre><code>[#&lt;Building id: 9, name: \"234234\"&gt;]\n</code></pre>\n\n<p>i dont know why i have only 2 elements, maybe it's because the select are on a Building.select?</p>\n\n<p>thanks</p>\n\n<p>-- Update 14/09</p>\n\n<p>Here is my new controller</p>\n\n<pre><code>  @search = Building.select('buildings.id, buildings.slug, floors.id, spaces.id, buildings.name, floors.number, spaces.number').joins('INNER JOIN floors ON floors.building_id = buildings.id INNER JOIN spaces ON spaces.floor_id = floors.id')\n  @search = @search.where(\"buildings.name like '%#{params[:building_name]}%'\") if !params[:building_name].blank?\n  #@search = @search.where(\"buildings.name like ?\", params[:building_name]) if !params[:building_name].blank?\n  if params[:space_type].present?\n    @search = @search.where(\"spaces.space_type_id = ?\", params[:space_type][:space_type_id]) if !params[:space_type][:space_type_id].blank?\n  end\n  @search = @search.where(\"floors.min_net_rent &gt;= #{params[:floor_min_rent]}\") if !params[:floor_min_rent].blank?\n  @search = @search.where(\"floors.max_net_rent &lt;= #{params[:floor_max_rent]}\") if !params[:floor_max_rent].blank?\n\n  @building = @search\n</code></pre>\n\n<p>The problem i have now is what debug give me. only 2 fields from the building. Is it because of the Building.select? How can i get all inside my selectfield?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","activerecord","encoding"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":35,"score":0,"question_id":12673395,"title":"Weird encoding error when saving ActiveRecord record","body":"<p>I have the following situation: My webservice is receiving JSON data and creating models (typical REST scenario). Sometimes I get a </p>\n\n<pre><code>Encoding::CompatibilityError Exception: incompatible character encodings: ASCII-8BIT and UTF-8\n</code></pre>\n\n<p>error message when saving the records, which can only be (or is) bound to two attributes. Firing up the debugger, setting ANY of those two attributes to an empty string and saving works, like so:</p>\n\n<pre><code>model = Model.new(params[:model])\nmodel.save! # Fails with above error message\n\nmodel = Model.new(params[:model])\nmodel.attribute1 = \"\"\nmodel.save! # Works\n\nmodel = Model.new(params[:model])\nmodel.attribute2 = \"\"\nmodel.save! # Works too!\n</code></pre>\n\n<p>Now the params are parsed from the http request, how can they be dependent on each other?</p>\n\n<p>Anyone with the same scenario?</p>\n\n<p><strong>Edit:</strong>\nWe've found the reason for the compability error: <a href=\"https://github.com/jruby/activerecord-jdbc-adapter/issues/229\" rel=\"nofollow\">https://github.com/jruby/activerecord-jdbc-adapter/issues/229</a> As it seems, the JDBC adapter has some errors with utf-8 encoding, something which has been fixed for a long time in traditional rubies.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","actionmailer"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12898883,"title":"Set header in mail interceptor in Rails 3","body":"<p>I want to set a header value for all the mails. I want to do it in interceptor, so that I don't have to repeat the code for all the mails.</p>\n\n<p>If I do it inside the mailer function, the code will be like following,</p>\n\n<pre><code>headers['X-Mailgun-Campaign-Id'] = \"1234\"\n</code></pre>\n\n<p>But how I can achieve the same using interceptor?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12898844,"title":"Rails: Dealing with validation for multiple models","body":"<p>We have models like the following and are trying to implement validation for those models. The challenge is that we have multiple controllers to deal with these models and error messages and validation rules will be different between controllers.  </p>\n\n<pre><code>class Deal &lt; ActiveRecord::Base\n    has_many :transactions\nend\nclass Transaction &lt; ActiveRecord::Base\n    has_many :line_items\n    belongs_to :deal\nend\nclass LineItem &lt; ActiveRecord::Base\n    belongs_to :transaction\nend\n</code></pre>\n\n<p>We are currently trying to implement this by leveraging ActivePresenter. However, the problem about ActivePresenter is that you need to fix number of instances you will have in the presenter first and it is not easy to dynamically accept different number of child associations. What is the best way to deal with this challenge? </p>\n\n<p>Basically, our question is;</p>\n\n<ol>\n<li><p>Is there any good way for ActivePresenter to deal with has_many associations? Say, we do not know how many line_items a transaction will have. Can ActivePresenter deal with that situation well? What will the implementation look like? </p></li>\n<li><p>Alternatively, is there any simple way for ActivePresenter to implement something like accept_nested_attributes_for of ActiveRecord?</p></li>\n<li><p>Is there any other good way to deal with our challenge - validation for multiple models that are different across controllers? </p></li>\n</ol>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12898388,"title":"upgrading from rails 3.0.8 to 3.0.17 produces \"undefined method `reputation_value_for'\" for active record-reputation-system 2.0.1","body":"<p>Everything was running great in rails 3.0.8. I am upgrading to rails 3.2 eventually but to get things ready Ryan Bates in a Railscast recommends first upgrading to the latest rails 3.0 version which is 3.0.17. After upgrading to 3.0.17 I got:</p>\n\n<pre><code>undefined method `reputation_value_for'\n</code></pre>\n\n<p>I am running rails in a rvm installed Ruby version 1.9.2. To be sure that it wasn't a problem with gems, I uninstalled 1.9.2 and reinstalled it. I installed the bundler gem and then ran bundle install. It still got the same error.</p>\n\n<p>I then renamed the database migrations and ran rails g reputation_system. The old and new migration files were exactly the same.</p>\n\n<p>Gist of full backtrace, Gemfile and Gemfile.lock <a href=\"https://gist.github.com/3893009\" rel=\"nofollow\">here</a>.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":5,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":205,"score":1,"question_id":10075167,"title":"Rails and class variables: will this persist across users and server calls?","body":"<p>We're on Rails 3.0.6.</p>\n\n<p>Will the following code persist across page loads and users in Rails? Or does it get redefined with every request? The code lives at the top of a controller.</p>\n\n<pre><code>@@list = []\n\nhero = {}\nhero['name'] = 'so'\nhero['superpowers'] = ['coding', 'qa', 'spec_writing']\n@@list.push hero\n\nhero2 = {}\nhero2['name'] = 'so2'\nhero2['superpowers'] = ['coding']\n@@list.push hero2\n... more Hashes pushed into @@list\n</code></pre>\n\n<p>The list only changes once a month, and we would like to efficiently and quickly make this data available to page requests. We will eventually use Rails.cache to read from the database, but we're using the following approach for now (assuming it works).</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","apache","production-environment"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":55,"score":1,"question_id":12898084,"title":"Assets not showing Rails ENV production","body":"<p>I have just pushed some changes to my deployed app (only some view changes which all worked just fine), ran <code>bundle exec rake assets:precompile RAILS_ENV=production</code> and all of a sudden my stylesheets and images are not being served?</p>\n\n<p>I have checked the html source which shows that the styelsheets and javascripts are being loaded.</p>\n\n<pre><code>&lt;link href=\"/virtual-piano/assets/application-a98a08ba4b9c8c54d0ac4103a8bf4bdf.css\" media=\"all\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n  &lt;script src=\"/virtual-piano/assets/application-23f71043aa7578f758b9d6244d5bd9b1.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>The production.log doesn't mention anything about failing to load assets.</p>\n\n<p>I have cleared the cache on my browsers.</p>\n\n<p>Restarted the apache2 server and touched the restart.txt file.</p>\n\n<p>production.rb</p>\n\n<pre><code># Disable Rails's static asset server (Apache or nginx will already do this)\n  config.serve_static_assets = false\n\n  # Compress JavaScripts and CSS\n  config.assets.compress = true\n\n  # Don't fallback to assets pipeline if a precompiled asset is missed\n  config.assets.compile = false\n\n  # Generate digests for assets URLs\n  config.assets.digest = true\n</code></pre>\n\n<p>Im a bit stumped, if anyone has an idea of whats going on it would be greatly appreciated!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","tags","jquery-tokeninput"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":107,"score":0,"question_id":11464872,"title":"How to create a token input where the user also can add new tag","body":"<p>Currently, I'm using the gem <code>\"acts_as_taggable_on_steroids\".</code><br>\nEverything working fine. Now I'd like to add <code>tokeninput</code> to this \"tag input box\"<br>\nAll the tags existing should be displayed here as <code>candidate tag.</code> when the user input 1st word.<br>\nand those tags have to be delimited by <code>\" \"(space)</code>  </p>\n\n<p>How can I make both <code>\"acts_as_taggable_on_steroids\"</code> and token input working??<br>\nAny good instruction to archive these?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12895884,"title":"how to call action from link_to","body":"<p>i have index page users_controller:</p>\n\n<pre><code>  def index\n    @companies = Company.where(:is_confirmed =&gt; \"f\")\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @companies }\n    end\n  end\n</code></pre>\n\n<p>and I want at the touch of a button, the company changed the status to confirmed</p>\n\n<pre><code>   def confirm\n    company = Company.find(params[:id])\n    company.is_confirmed = \"t\"\n    company.save\n    redirect_to users_path\n  end\n</code></pre>\n\n<p>button which should call confirmation</p>\n\n<pre><code>= link_to '&lt;i class=\"icon-ok icon-white\"&gt;&lt;/i&gt; '.html_safe + t('Confirm'), users_path, confirm: t('Are you sure'), :controller =&gt; \"users\", :action =&gt; \"confirm\", :class =&gt; 'btn btn-small btn-success'\n</code></pre>\n\n<p>please tell me how to fix or tell me where you can see a working version</p>\n"},{"tags":["jquery","ruby-on-rails-3","jquery-ajax","phonegap","cross-domain"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":43,"score":0,"question_id":12881115,"title":"Phonegap make Post Call to rest service on rails3","body":"<p>I have a rails3 rest service and I am developing a phonegap app in which I can only use HTML5 and Jquery javascript.</p>\n\n<p>I am not able to make a POST rest call with ajax jquery to my rail3 rest service because of the cross domain security.</p>\n\n<p>How can I resolve it. If you can point me to the code for both client and server side I will really appreciate it</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","session-state","session-variables"],"answer_count":1,"favorite_count":2,"up_vote_count":5,"down_vote_count":0,"view_count":2863,"score":5,"question_id":6397573,"title":"Rails 3 additional session configuration options (key, expires_after, secure)","body":"<p>Can someone point out what the new Rails 3.x session configuration options are?</p>\n\n<p>I'm trying to duplicate the same configuration that I have in my Rails 2.3.x application.</p>\n\n<p>This is the configuration that I used in the application:</p>\n\n<pre><code>#environment.rb\nconfig.action_controller.session_store = :active_record_store\n\nconfig.action_controller.session = {\n    :key         =&gt; '_something', #non-secure for development\n    :secret      =&gt; 'really long random string'\n  }\n\n\n# production.rb - override environment.rb for production\nconfig.action_controller.session = {\n  :key            =&gt; '_something_secure',\n  :secret         =&gt; 'really long random string',\n  :expire_after   =&gt; 60*60,#time in seconds\n  :secure         =&gt; true #The session will now not be sent or received on HTTP requests.\n}\n</code></pre>\n\n<p>However, in Rails 3.x, I can only find mention of the following:</p>\n\n<pre><code>AppName::Application.config.session_store :active_record_store\n\nAppName::Application.config.secret_token = 'really long random string'\n\nAppName::Application.config.cookie_secret = 'another really long random string'\n</code></pre>\n\n<p>Are there other config settings to control the key, expire_after time, and secure option?</p>\n\n<p>Regarding the latter, if \"config.force_ssl = true\" is set in production.rb, I assume the secure option is no longer required?</p>\n\n<p>Thanks very much!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","postgresql","travis-ci"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":841,"score":2,"question_id":8394266,"title":"Travis CI: FATAL: role does not exist","body":"<p>I'm trying to get my application working w/ Travis CI but I keep getting: <code>FATAL: role \"skateparks\" does not exist</code>. Any ideas on what I could be doing wrong? I've followed their <a href=\"http://about.travis-ci.org/docs/user/database-setup/\" rel=\"nofollow\">documentation</a>.</p>\n\n<p><a href=\"https://github.com/kyledecot/skateparks-web/blob/master/.travis.yml\" rel=\"nofollow\">https://github.com/kyledecot/skateparks-web/blob/master/.travis.yml</a></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem","bundler","gemspecs"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2879,"score":1,"question_id":5381681,"title":"In Rails 3's \"bundle install\" of local gem (frozen gem), keep getting \"Source does not contain any versions of ...\"?","body":"<p>I am using a gem which is in <code>vendor/gems/some-api-0.1.0</code>, copied over from another project, and added to <code>Gemfile</code>:</p>\n\n<pre><code>gem 'some-api', :path =&gt; '~/development/myproj/vendor/gems/some-api-0.1.0'\n</code></pre>\n\n<p>but if I do the following, it will fail with the message:</p>\n\n<pre><code>$ bundle install\nFetching source index for http://rubygems.org/\nCould not find gem 'some-api (&gt;= 0)' in source at ~/development/myproj/vendor/gems/some-api-0.1.0.\nSource does not contain any versions of 'some-api (&gt;= 0)'\n</code></pre>\n\n<p>Searching on the net seem to suggest needing a gemspec?  So I need to write up a <code>.gemspec</code> some where, is that true?  Can someone shred light of how it is done in this situation?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","facebook-graph-api","fb-graph"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12895850,"title":"Rails 3 + fb_graph how to get access token to post to my own FB page","body":"<p>I am using Rails 3 + fb_graph to post to my own Facebook page. I have code that works, but it uses an access token that only works for a couple of hours. And it is very annoying to refresh this access token a couple of times a day. So I registrated for a FB app. I now have:</p>\n\n<pre><code>  my_app = FbGraph::Application.new(\"App ID\");\n  acc_tok = my_app.get_access_token(\"App Secret\");\n  me = FbGraph::User.me(acc_tok)\n  me.fetch\n  me.accounts\n  account = me.accounts.select {|account| account if account.name == \"BoaJobs.com\"}.first\n\n  page = FbGraph::Page.new(account.identifier)\n\n  note = page.note!(:access_token =&gt; account.access_token, :subject =&gt; @title, :message =&gt; @message, :link =&gt; @url)\n</code></pre>\n\n<p>But I am getting an error on the me.fetch line:</p>\n\n<pre><code>  OAuthException :: An active access token must be used to query information about the current user.\n</code></pre>\n\n<p>Can somebody post some code that helps me solve this problem. Thank you very much in advance.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","caching"],"answer_count":0,"favorite_count":1,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12895794,"title":"Rails 3 - Caching configuration from dynamoDB","body":"<p>I have a controller where every action requires a configuration, I stored all the configurations in dynamoDB. Do I need to fetch configuration data from dynamoDB every time an action gets executed? </p>\n\n<p>I would like to know if caching would solve that problem. Can someone throw light on this to use best <a href=\"http://guides.rubyonrails.org/caching_with_rails.html\" rel=\"nofollow\">caching mechanism</a> provided by rails, to avoid calling dynamoDB for every action.</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","database-design","associations","model-associations"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12894696,"title":"Define associations when multiple models belongs to the same model in Rails 3","body":"<p>I'm building an online test application. I built associations of my models in my app are:</p>\n\n<p><img src=\"https://dl.dropbox.com/u/51096044/online_test_diagram.png\" alt=\"Database diagram\">  </p>\n\n<p>Sorry for small image :(  </p>\n\n<p>Now i want to build these associations:</p>\n\n<ul>\n<li>A user(have role 'teacher') have many courses, a course belongs to one or more users who can created topics and questions for that course. (as i designed 'course_relationships' but i don't know it is good or not)</li>\n<li>A topic belongs_to a user who created it.</li>\n<li>A question belongs to a user who created it. </li>\n</ul>\n\n<p>My solution now is: </p>\n\n<ul>\n<li>Puts <code>belongs_to user</code> association in Topic and Question models.</li>\n<li>Puts <code>has_many :through</code> association in User and Course models.  </li>\n</ul>\n\n<p>But i see i have created many <code>belongs to</code> associations (as Question model already belongs to Topic and Question_Type models, and Topic model already belongs to Course model), so i want to eliminate associations. I have seen <code>polymorphic association</code> but maybe it is not to solve in my case.  </p>\n\n<p>Anyone can suggest me some better way to eliminate associations (or some way to design better database), or i should do my solution. Thanks so much for helps.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","integer","part"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12893985,"title":"Rails 3 - Compare part of integer with other integer","body":"<p>I'm working for almost 4 weeks with Ruby on Rails now, so consider me as a beginner.</p>\n\n<p>When performing a conditional find query, I need to compare a part of an integer (put in a string..) with another integer.</p>\n\n<p><code>@invs = Inv.find(:all, :conditions =&gt; {:cnr =&gt; INTEGER_TO_BE_COMPARED_TO })</code></p>\n\n<p>Well, I found a way to get a certain part of an integer and wrote the following method:</p>\n\n<pre>\ndef get_part_of_int\n    @r = Integer((@cnr % 10000000)/100000.0)\n    @r = \"%02d\" % @r\n    @r.to_s\nend\n</pre>\n\n<p>This should give the output <code>@r = 01</code> from <code>@cnr = 40138355</code></p>\n\n<p>The target is to only show <code>invs</code> with e.g. <code>01</code> as second and third digit.</p>\n\n<p>I'm using:<br />\nRails 3.2.8<br />\nRuby 1.9.3p194</p>\n\n<p>Thank you all in advance.</p>\n\n<p>== Edit: ==<br />\nI realised there is no question mark in my post.. And there is some confusion.</p>\n\n<p>The value of the column name <code>cnr</code> should be stripped to the 2nd and 3rd digit and be compared to a string e.g. <code>01</code>.<br />\nThank you @Salil for you suggestion.<br/>\nHowever this doesn't work.. But I understand the way of using it. The following will convert the string <code>:cnr</code> to <code>:nr</code>.\n<code>Inv.find(:all, :conditions =&gt; {:cnr.to_s[1,2] =&gt; '01' })</code>\nIs there a way to compare a part of the value of the column with e.g. <code>01</code>?</p>\n\n<p>Maybe I should think the other way around. Is it possible to search for <code>cnrs</code> with the 2nd and 3rd digit e.g. <code>01</code>? The trick is that these numbers are always as 2nd and 3rd digit. I assume a fuzzy search with e.g. Solr doesn't work, because when searching for <code>01</code> I don't want the <code>cnr</code> <code>40594013</code>.</p>\n\n<p>Can this be done in some way?</p>\n\n<p>Thank you in advance and my apologies for confusing you.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":36,"score":1,"question_id":12894127,"title":"rails Routing Error in Rails 3.1","body":"<p>I want to see a list of all companies when pass by reference /users</p>\n\n<p>users_controller.rb:</p>\n\n<pre><code>  def index\n    @companies = Company.all\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @companies }\n    end\n  end\n</code></pre>\n\n<p>users/index.html.haml:</p>\n\n<pre><code>%div{:style =&gt; \"margin:10px\" }  \n  %table{ :class =&gt; \"table table-striped\"}\n    %thead\n      %tr\n        %th \n          = t(\"Logo\")\n        %th \n          = t(\"company_name\")\n        %th \n          = t(\"website\")\n        %th\n    %tbody\n      - @companies.each do |company| \n        %tr\n          %td \n            - if company.logo?\n              = link_to image_tag( company.logo.url, :width =&gt; \"60\", :height =&gt; \"60\"), company\n            - else\n              = link_to image_tag( \"/lg.png\", :width =&gt; \"60\", :height =&gt; \"60\"), company\n          %td \n            = link_to company.name, company_path\n          %td\n            - if company.website?\n              = link_to company.website, company.website\n            - else\n              = link_to company.name, company_path\n          %td\n            - if can? :read, company\n              = link_to '&lt;i class=\"icon-info-sign icon-white\"&gt;&lt;/i&gt; '.html_safe + t('Show'), company, :class =&gt; 'btn btn-small btn-info'\n            - if can? :update, company\n              = link_to '&lt;i class=\"icon-pencil icon-white\"&gt;&lt;/i&gt; '.html_safe + t('Edit'), edit_company_path(company), :class =&gt; 'btn btn-small btn-pencil'\n            - if can? :destroy, company \n              = link_to '&lt;i class=\"icon-trash icon-white\"&gt;&lt;/i&gt; '.html_safe + t('Destroy'), company, confirm: t('Are you sure'), method: :delete, :class =&gt; 'btn btn-small btn-danger'\n</code></pre>\n\n<p>but when the link get the error:<br>\n<code>No route matches {:action=&gt;\"show\", :controller=&gt;\"companies\"}</code></p>\n"},{"tags":["ruby-on-rails-3","refinerycms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":32,"score":0,"question_id":12768922,"title":"Set up RefineryCMS with Passenger","body":"<p>I'm trying to get a RefineryCMS install running on my CentOS VPS (which has DirectAdmin installed, which I don't think makes any difference for my problem) but somehow I cannot get it to host.</p>\n\n<p>In my httpd.conf I've added the following:</p>\n\n<pre><code>RailsEnv development\nPassengerHighPerformance on\n|?DOCROOT=/home/user/domains/domain.name/public_html/rails/refinery_test_install/| \n</code></pre>\n\n<p>The paths are all correct and my normal Rails 3 applications work perfectly when I put these lines in my httpd.conf yet now it will just load the index.html file I've put in the directory pure for testing.</p>\n\n<p>Any ideas on how I could get this up and running?</p>\n"},{"tags":["ruby-on-rails-3","unit-testing","actioncontroller"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12894013,"title":"How can I test ActionController extensions within Rails 3.2?","body":"<p>I wrote an extension for ActionController::Base in Rails 3.2. Now I want to test it. But because the gem I created is no application it has neither specific controllers nor routes, so I cannot use \"get\" or \"post\" to call any action.<br>\nIs there any module which can create generic controllers on the fly (like <a href=\"https://github.com/nakajima/acts_as_fu\" rel=\"nofollow\">acts_as_fu</a> does with ActiveRecord models)? Or is there any testing pattern I can relate to?</p>\n\n<p>I have found this <a href=\"http://stackoverflow.com/questions/251225/how-to-test-controller-filters-in-ruby-on-rails-and-testunit\">article</a> which explains how to test a before_filter. So far so good although the solutions are to some extend heavy-weight or unclean.</p>\n\n<p>Edit: In particular I want to test an around_filter (if it works and if it redirects correctly) which is created by my extension.</p>\n\n<p>I'm looking forward to your answers.<br>\nThanks and kind regards.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":98,"score":0,"question_id":12821260,"title":"Is there something wrong with the distance_of_time_in_words_to_now helper?","body":"<p>Doesn't seem to be working for me. I'd open an issue on Github but I want to double check I'm not doing something stupid first. Using Rails 3.2.8 and Ruby 1.9.3. <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-distance_of_time_in_words_to_now\" rel=\"nofollow\">Here's the API reference</a></p>\n\n<pre><code>» bundle exec rails c\nLoading development environment (Rails 3.2.8)\n1.9.3-p194 :001 &gt; helper.distance_of_time_in_words_to_now(\"2012-10-18\")\nArgumentError: wrong number of arguments (2 for 1)\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/letters-0.2.6/lib/letters/core_ext.rb:155:in `t'\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_view/helpers/date_helper.rb:93:in `block in distance_of_time_in_words'\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.8/lib/active_support/core_ext/object/with_options.rb:41:in `with_options'\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_view/helpers/date_helper.rb:73:in `distance_of_time_in_words'\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_view/helpers/date_helper.rb:133:in `time_ago_in_words'\n    from (irb):1\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'\n    from /Users/davidtuite/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:41:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","humanize"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":693,"score":0,"question_id":4846841,"title":"Forcing \"humanized\" names of fields to be lowercase in Rails 3","body":"<p>As far as I know, the accepted way to set the \"humanized\" names of fields in Rails 3 is to use locales:</p>\n\n<pre><code># config/locales/en.yml\nen:\n  activerecord:\n    attributes:\n      member:\n        username: 'username' # rather than 'Username'\n</code></pre>\n\n<p>However, I simply want Rails 3 to use lowercase versions of its default humanized names. Is there an easy, built-in way to do this?</p>\n\n<p>An example to help clarify: When inside of a <code>form_for</code>, <code>&lt;%= f.label :username %&gt;</code> displays \"Username\" by default. I want it to display \"username\".</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12860016,"title":"how to call devise methods","body":"<p>i create controller:</p>\n\n<pre><code>class SigninController &lt; ApplicationController\n  def index\n  end\n  def create\n    @user = User.find_by_email(params[:user][:email])\n    if @user \n      ....\n      sign_in(:user, @user)\n    else\n      @user = User.new(params...)\n      @user.save\n      ...\n    end\n  end\nend\n</code></pre>\n\n<p>Correctly i call sign_in method?</p>\n\n<p>signin/index.html.erb:</p>\n\n<pre><code>&lt;h2&gt;Sign in&lt;/h2&gt;\n&lt;%= form_for(User.new, :as =&gt; :user, :url =&gt; \"signin\") do |f| %&gt;\n  &lt;div&gt;&lt;%= f.label :email %&gt;&lt;br /&gt;\n  &lt;%= f.email_field :email %&gt;&lt;/div&gt;\n  &lt;div&gt;&lt;%= f.label :password %&gt;&lt;br /&gt;\n  &lt;%= f.password_field :password %&gt;&lt;/div&gt;\n  &lt;br&gt;\n  &lt;div&gt;&lt;%= f.submit \"Sign in\" %&gt;&lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>How to call devise sign_in and sign_up methods of devise?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":75,"score":0,"question_id":12837151,"title":"Redirect_to Updating Dropdown Value","body":"<p>I have created a simple form with some drop down values, you can also add a new value to this drop down by creating a new value on a different page. On completion this page uses the redirect_to method to return to the previous page.</p>\n\n<pre><code>if @sweet_type.save\n    format.html { redirect_to session[:return_to], notice: 'Sweet type was successfully created.' }\n</code></pre>\n\n<p>This all works fine, but I was wondering if it is possible to highlight the newly created record in the drop down box once the redirect is complete?</p>\n\n<p>Any hints or tips on this are more than welcome.</p>\n\n<p>Thanks</p>\n\n<p>Edit: Adding Images for perhaps more clarification.</p>\n\n<p>Clicking Add a Sweet Type here</p>\n\n<p><a href=\"http://i.imgur.com/8W3Go.png\" rel=\"nofollow\">http://i.imgur.com/8W3Go.png</a></p>\n\n<p>Adding a new type here</p>\n\n<p><a href=\"http://i.imgur.com/Nbl7t.png\" rel=\"nofollow\">http://i.imgur.com/Nbl7t.png</a></p>\n\n<p>To then return to the previous screen with the newly created item being the 'default' value.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":30,"score":1,"question_id":12893362,"title":"Disable div tag using ruby on rails","body":"<p>I am making a employee assessment app where each employee has specific task, if the task is not completed within the deadline the employer will click complete button which will fetch him reward points otherwise click fail button the task will be locked and no further change is allowed.</p>\n\n<p>I want back end code for the disable button when clicked the task should be locked.</p>\n\n<p>pls help me with your answer.</p>\n"},{"tags":["ruby-on-rails-3","events","asynchronous"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":100,"score":0,"question_id":8682649,"title":"Events in rails (such reminders, stopwatch, etc)","body":"<p>my app has a timer (like an egg boiling timer)</p>\n\n<p>The user enters a time to countdown to, and I'd like some action in a controller to occur once the timer is zero.</p>\n\n<p>as requested - I'd like to have the capability of a user following several timers or timed events such as calendar. Since each user can time their events as they wish, the reminder/time's up functionality needs to give a notice to the user (by pop up message, email, etc)</p>\n\n<p>using DelayedJob and whenever won't help here since they are all predefined times to events\nOne option to use those gems is to poll an action that will test all timers every second for all users but that doesn't scale very well or efficient..</p>\n\n<p>How would I call an action exactly when the timer is up?</p>\n"},{"tags":["javascript","jquery","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":55,"score":0,"question_id":12892561,"title":"Radio button in a group is making form submit button unresponsive","body":"<p>I have this radio button group in a form:</p>\n\n<pre><code>&lt;%= form_for(@question) do |f| %&gt;\n\n    ....\n\n    &lt;div class=\"field\"&gt;\n        &lt;%= f.radio_button :status, \"open\", { :checked =&gt; true } %&gt;\n        &lt;%= f.label :status, \"Open\" %&gt;\n        &lt;%= f.radio_button :status, \"closed\" %&gt;\n        &lt;%= f.label :status, \"Closed\" %&gt;\n    &lt;/div&gt;&lt;br /&gt;\n\n    ....\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>There is no Javascript code error, but the form submit button works only if either I remove one of the radio buttons from the group or disable Javascript on the browser or I delete ALL the Javascript files in the project directory. The following is the only JQuery code that makes any conditional changes to the radio buttons:</p>\n\n<pre><code>....\n\n$('#hide_question_form').click( function(e) {\n  $('.new_question_form').slideUp(500);\n  $('#question_title').val(null);\n  $('#question_description').val(null);\n  $('input:radio[name=\"question[status]\"]')[0].checked = true;\n  $('input:radio[name=\"question[status]\"]')[1].checked = false;\n});\n\n....\n</code></pre>\n\n<p>I tried commenting/deleting all Javascript files one by one to see where the problem is, but unless I delete ALL of them, the button does not works. Any specific suggestions? Thanks!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Resulting HTML, as requested:</p>\n\n<pre><code>&lt;div class=\"field\"&gt;\n        &lt;input checked=\"checked\" id=\"question_status_open\" name=\"question[status]\" required=\"required\" type=\"radio\" value=\"open\" /&gt;\n        &lt;label for=\"question_status\"&gt;Open&lt;/label&gt;\n        &lt;input id=\"question_status_closed\" name=\"question[status]\" required=\"required\" type=\"radio\" value=\"closed\" /&gt;\n        &lt;label for=\"question_status\"&gt;Closed&lt;/label&gt;\n&lt;/div&gt;&lt;br /&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-1.9"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12892260,"title":"Implementing Open-id server with multiple provider","body":"<p>I want to implement an openid server which could interact with multiple providers to authenticate users. Basically I am looking for something like StackOverflow does for login. </p>\n\n<p>I was looking into ruby-openid but it does not seem to be maintained with last commit 2-3 years back. \nCan someone suggest me good gem /plugin or resource for implementing Open-id in Rails 3.2</p>\n\n<p><strong>Requirement :</strong></p>\n\n<ol>\n<li>Should be able to host my own open id server</li>\n<li>Allow user to use multiple options like(google/ blogger / yahoo..etc) </li>\n<li>Should work well with Rails 3.2 / ruby 1.9.3</li>\n</ol>\n"},{"tags":["mysql","ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":80,"score":0,"question_id":12892056,"title":"trouble with rake db:migrate","body":"<p>Hi every one i'm new on ruby on rails so i got this problem with rake db:migrate \nSo i use --trace up on it to understand but i didn't get a clue of what to do .\ni put my migrate  .rb file below.</p>\n\n<pre><code> $ rake db:migrate --trace\n** Invoke db:migrate (first_time)\n** Invoke environment (first_time)\n** Execute environment\n** Invoke db:load_config (first_time)\n** Execute db:load_config\n** Execute db:migrate\n==  AlterUsers: migrating =====================================================\n-- rename_table(\"users\", \"admin_users\")\nrake aborted!\nAn error has occurred, all later migrations canceled:\n\nMysql2::Error: Table 'admin_users' already exists: RENAME TABLE `users` TO `admin_users`\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `query'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `execute'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `log'\n/Library/Ruby/Gems/1.8/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:245:in `execute'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/mysql2_adapter.rb:211:in `execute'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:457:in `rename_table'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:466:in `send'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:466:in `method_missing'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:438:in `say_with_time'\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/benchmark.rb:293:in `measure'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:438:in `say_with_time'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:458:in `method_missing'\n/Users/seydoukonate/Sites/simple_cms/db/migrate/20121015072622_alter_users.rb:3:in `up'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:410:in `send'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:410:in `migrate'\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/benchmark.rb:293:in `measure'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:410:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:123:in `with_connection'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:389:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:528:in `__send__'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:528:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:720:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:777:in `call'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:777:in `ddl_transaction'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:719:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:700:in `each'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:700:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:570:in `up'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/migration.rb:551:in `migrate'\n/Library/Ruby/Gems/1.8/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:153\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `execute'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `invoke_with_call_chain'\n/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/monitor.rb:242:in `synchronize'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `top_level'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `run'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'\n/Library/Ruby/Gems/1.8/gems/rake-0.9.2.2/bin/rake:33\n/usr/bin/rake:23:in `load'\n/usr/bin/rake:23\nTasks: TOP =&gt; db:migrate\n</code></pre>\n\n<p>Here is whats inside my _create_user.rb file.</p>\n\n<pre><code>class CreateUsers &lt; ActiveRecord::Migration\n  def change\n    create_table :users do |t|\n\n      t.string \"first_name\", :limit =&gt; 25\n      t.string \"last_name\", :limit =&gt; 50\n      t.string \"email\", :default =&gt; \"\", :null =&gt; false\n      t.string \"password\", :limit =&gt; 40\n      t.timestamps\n    end\n  end\n  def self.down\n    drop_table :users\n  end\nend\n</code></pre>\n\n<p>and here is what is inside alter_user.rb file</p>\n\n<pre><code>class AlterUsers &lt; ActiveRecord::Migration\n  def up\n    rename_table(\"users\", \"admin_users\")\n    add_column(\"admin_users\", \"username\", :string, :limit =&gt; 25)\n    change_column(\"admin_users\", \"email\", :string, :limit =&gt; 100)\n    rename_column(\"admin_users\", \"password\", \"hashed_password\")\n    add_column(\"admin_users\", \"salt\", :string, :limit =&gt; 40)\n    puts \"*** About to add and index ***\"\n    add_index(\"admin_users\", \"username\")\n  end\n\n  def down\n    remove_index(\"admin_users\", \"username\")\n    remove_column(\"admin_users\", \"salt\")\n    rename_column(\"admin_users\", \"hashed_apssword\", \"password\")\n    change_column(\"admin_users\", \"email\", :string, :default =&gt; \"\", :null =&gt; false)\n    remove_column(\"admin_users\", \"username\")\n    rename_table(\"admin_users\", \"users\")\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12892069,"title":"Uniqueness validator issue on update","body":"<p>I'm finding an issue while updating records.My scenario goes like this,</p>\n\n<p>Project has_many questions and each question has a field called Position(integer).</p>\n\n<p>If I add 3 questions and give position to 3 questions then questions has to be sorted according to position.</p>\n\n<p>But on updating am getting an error \"Position has already been taken\".</p>\n\n<p>In my question model my code is:\nvalidates :position, :uniqueness => {:scope => :project_id}</p>\n\n<p>Can anyone help to solve this issue?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":67,"score":2,"question_id":12891046,"title":"Insert record in assosiated model through console","body":"<p>I have 2 tables User and Member and there relation is \nIn user</p>\n\n<blockquote>\n  <p>has_one :member, :class_name => 'User::Member'\n  Member\n  belongs_to :user</p>\n</blockquote>\n\n<p>I am trying to insert data using console and I am using this code</p>\n\n<pre><code> u = User.create(\n    :group         =&gt; UserGroup.find_by_slug(:members),\n    :first_name    =&gt; 'abc',\n    :last_name     =&gt; 'fgh',\n    :company_name  =&gt; 'xyz',\n    :email         =&gt; 'test@test.com',\n    :password      =&gt; '123456',\n    :password_confirmation =&gt; '123456'\n    )   \n m = User::Member.create(\n    :user           =&gt; u,\n    :pricing_plan   =&gt; PricingPlan.order('RANDOM()').first,\n    :state          =&gt; UserState.order('RANDOM()').first,\n    :industry       =&gt; Industry.order('RANDOM()').first,\n    :fy_start_month =&gt; 7\n    )\n</code></pre>\n\n<p>It is throwing this error </p>\n\n<blockquote>\n  <p>syntax error, unexpected tIDENTIFIER, expecting $end\n                  )  m = User::Member.create(</p>\n</blockquote>\n\n<p>I am wondering what is wrong with my syntax.Thanks in advance</p>\n"},{"tags":["javascript","ruby","ruby-on-rails-3","google-charts-api"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":134,"score":0,"question_id":11940392,"title":"Passing array with data to Google Chart Tools","body":"<p>I am trying to draw a chart using Google Chart Tools.</p>\n\n<pre><code>  google.load(\"visualization\", \"1\", {packages:[\"corechart\"]});\n  google.setOnLoadCallback(drawChart);\n  function drawChart() {\n    var data = new google.visualization.DataTable();\n    data.addColumn('number', 'Month');\n    data.addColumn('number', 'Money');\n    data.addRows([\n        [&lt;%= @months %&gt;, &lt;%= @money %&gt;] \n        ]);\n\n    var options = {\n      title: 'Title'\n    };\n\n    var chart = new google.visualization.LineChart(document.getElementById('chart_div_2'));\n    chart.draw(data, options);\n  }\n</code></pre>\n\n<p>@months and @money are arrays. Unfortunately, probably I can't pass an array in this way, because the chart does not show up. What is the right dealing with this kind of situation?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Ok, I've use Gon and setCell function in for loop and it works</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":60,"score":0,"question_id":12870973,"title":"Calling a parent::method from a child::method","body":"<p>Good day, i'm new to ruby. I want to know how to run a parent method from a method of a child class ?\nin java it would be like</p>\n\n<pre><code>class Child\n  ..\n  def something_else\n    super.something\n  end\nend\n</code></pre>\n\n<p>and in php</p>\n\n<pre><code>parent::method_name();\n</code></pre>\n\n<p>And could you tell me how to do it in Ruby?\nfound only this, and it's kind of ugly using <strong>alias_method_chain</strong></p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","error-handling"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12890364,"title":"Why does rails app return 406 instead of 404 in some cases?","body":"<p>I have a huge Rails app that is running quit well but I have a problem with google because of some nasty behavior of the app. When I call</p>\n\n<p><a href=\"http://railsapp.com/index.html\" rel=\"nofollow\">http://railsapp.com/index.html</a> </p>\n\n<p>Which doesnt exist the app returns an 404 error which is correct. But when I call</p>\n\n<p><a href=\"http://railsapp.com/index.htm\" rel=\"nofollow\">http://railsapp.com/index.htm</a></p>\n\n<p>It returns an 406 error wich isnt that great. This problem appears every time a non existing file with .htm extension is requested. How can I make my rails app return 404 instead of 406?</p>\n"},{"tags":["ruby-on-rails-3","image","carrierwave","rmagick"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12890460,"title":"Getting the dimensions of a resized image in carrierwave","body":"<p>I can't find a question that tackles this specific issue, so here goes...</p>\n\n<p>I need to get the dimensions of a processed image in carrierwave.  I'm using rmagick and resize_to_fill or resize_to_limit.  I currently use a get_geometry method to save the original image height and width.  With this info and the type of transformation I'm using, is there a way to predict the output size? I need to feed this data to jquery to help make the descriptions I'm adding to some overlays a little more elegant. </p>\n\n<pre><code>version :figure_portrait do\n  process :resize_to_fill =&gt; [500, 500]\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12889586,"title":"Better way to default Rails form instead of using ternary?","body":"<p>I have some code like this:</p>\n\n<pre><code>&lt;input type=\"text\" value=\"&lt;%= params[:first_name] ? params[:first_name] : 'John' %&gt;&gt;\n</code></pre>\n\n<p>Obviously this is not ideal as it repeats params[:first_name] twice. Is there a better way to have a form default to param, but if there is no param value for it use a default value?</p>\n"},{"tags":["html","ruby-on-rails-3","textformat"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":31,"score":0,"question_id":12889463,"title":"message format in rails3","body":"<p>i want to save my text message in same format as it is typed ans display it in the same format.</p>\n\n<p>Suppose i type:</p>\n\n<pre><code>Hi,\n   How r u? how is your daddy?\n\n Thanks &amp; regards\n Your friend\n</code></pre>\n\n<p>but it will dispalyed as</p>\n\n<pre><code>Hi, How r u? how is your daddy? Thanks &amp; Regards Your friend\n</code></pre>\n\n<p>in my view file i have something like this:</p>\n\n<pre><code>&lt;table class=\"display stylized\" id=\"act_details\"&gt;\n       &lt;thead&gt;\n          &lt;tr&gt;\n                 &lt;th&gt;Message Details&lt;/th&gt;\n\n          &lt;/tr&gt;\n        &lt;/thead&gt;\n            &lt;tbody&gt; \n               &lt;!--&lt;tr&gt;\n                  &lt;td colspan=\"2\"&gt;Message from &lt;strong&gt;&lt;%= @message.from %&gt;&lt;/strong&gt;&lt;/td&gt;\n               &lt;/tr&gt;--&gt;\n               &lt;tr&gt;\n                 &lt;td colspan=\"2\"&gt;&lt;label&gt;Subject:&lt;/label&gt; &lt;%= @message.subject %&gt;&lt;/td&gt;\n               &lt;/tr&gt;\n              &lt;!-- &lt;tr&gt;\n                 &lt;td colspan=\"2\" wrap&gt;&lt;label&gt;Message:&lt;/label&gt; &lt;%= word_wrap(@message.description, :line_width =&gt; 80 ) %&gt;&lt;/td&gt;\n               &lt;/tr&gt;--&gt;\n                &lt;% @replies.each do |reply|%&gt;\n                  &lt;tr&gt;\n                    &lt;td colspan =\"2\" wrap&gt;&lt;label&gt; Sent by &lt;%= reply.from.capitalize %&gt; on &lt;%= reply.created_at %&gt; &lt;/label&gt; &lt;br/&gt;&lt;%= word_wrap(reply.description, :line_width =&gt; 80)%&gt;&lt;/td&gt;\n                  &lt;/tr&gt;\n                &lt;%end%&gt;\n        &lt;/tbody&gt;      \n&lt;/table&gt;\n</code></pre>\n\n<p>I am using rails 3.0.6. Is their any way to show the message as it is typed, i am sure their is something as i want but unable to get those. Any help will be thankful.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","variable-scope","prawn"],"answer_count":1,"favorite_count":0,"up_vote_count":4,"down_vote_count":0,"view_count":53,"score":4,"question_id":12889857,"title":"How do I keep my current model in scope inside my method","body":"<p>I have a Rails model and in one of the methods I am generating a pdf using prawn like so;</p>\n\n<pre><code>class Report &lt; ActiveRecord::Base\n\n  def pdf_output\n    Prawn::Document.new do\n      text \"Start date: #{start_date.strftime('%e %b %Y').squish}\"\n    end\n  end\n\nend\n</code></pre>\n\n<p>In that text method I am trying to output the start_date attribute of my report model. Instead I get the following error</p>\n\n<pre><code>NoMethodError in ReportsController#show\n\nundefined method `start_date' for #&lt;Prawn::Document:0x007fdafbce6930&gt;\n</code></pre>\n\n<p>So my start_date method is referring to my Document object instead of my Report object. How do I access the variables and methods of my report object from inside this block?</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12889013,"title":"Specify column for model attributes in Rails3?","body":"<p>Is it possible to specify the column for an attribute? I have something like:</p>\n\n<pre><code>NAME, COUNTRY\n</code></pre>\n\n<p>The database is quite large and I have over a thousand columns which are capitalized like this. I want to refer to them as so:</p>\n\n<pre><code>attr_accessible :name, :country\n</code></pre>\n\n<p>Where :name = column NAME. I'd prefer Model.name rather than Model.NAME. It isn't possible to downcase every column name in the structure file.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","delayed-job","mixpanel"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":432,"score":2,"question_id":6899706,"title":"Not able to hit mixpanel in delayed job?","body":"<p>I am using delayed_job to do some background task. In between I want to track some events. I am using <a href=\"https://github.com/zevarito/mixpanel\" rel=\"nofollow\">mixpanel gem</a> to track the events. In controller its working perfectly fine. But not in Delayed Job.</p>\n\n<p>Code I am using</p>\n\n<pre><code>@original_message = Message.find(message_id)\n@mixpanel= Mixpanel::Tracker.new(\"43242637426346287482\", message_id, true)\n@mixpanel.track_event(\"blank_body\", {:reset_result =&gt; \"sucess\" })\n//message_id is a unique for every request.\n</code></pre>\n\n<p>I have specified</p>\n\n<pre><code>  gem 'mixpanel' in gemfile\n\n              {undefined method `[]=' for 45:Fixnum\n</code></pre>\n\n<p>/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/mixpanel-0.9.0/lib/mixpanel/tracker.rb:38:in <code>clear_queue'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/mixpanel-0.9.0/lib/mixpanel/tracker.rb:13:in</code>initialize'\\n/Users/mohit/projects/textadda/lib/message_job.rb:109:in <code>new'\\n/Users/mohit/projects/textadda/lib/message_job.rb:109:in</code>perform'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/backend/base.rb:87:in <code>invoke_job'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:120:in</code>run'\\n/Users/mohit/.rvm/rubies/ruby-1.8.7-p334/lib/ruby/1.8/timeout.rb:67:in <code>timeout'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:120:in</code>run'\\n/Users/mohit/.rvm/rubies/ruby-1.8.7-p334/lib/ruby/1.8/benchmark.rb:308:in <code>realtime'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:119:in</code>run'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:177:in <code>reserve_and_run_one_job'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:104:in</code>work_off'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:103:in <code>times'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:103:in</code>work_off'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:78:in <code>start'\\n/Users/mohit/.rvm/rubies/ruby-1.8.7-p334/lib/ruby/1.8/benchmark.rb:308:in</code>realtime'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:77:in <code>start'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:74:in</code>loop'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/worker.rb:74:in <code>start'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/delayed_job-2.1.4/lib/delayed/tasks.rb:9\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:205:in</code>call'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:205:in <code>execute'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:200:in</code>each'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:200:in <code>execute'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:158:in</code>invoke_with_call_chain'\\n/Users/mohit/.rvm/rubies/ruby-1.8.7-p334/lib/ruby/1.8/monitor.rb:242:in <code>synchronize'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:151:in</code>invoke_with_call_chain'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/task.rb:144:in <code>invoke'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:112:in</code>invoke_task'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:90:in <code>top_level'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:90:in</code>each'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:90:in <code>top_level'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:129:in</code>standard_exception_handling'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:84:in <code>top_level'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:62:in</code>run'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:129:in <code>standard_exception_handling'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/lib/rake/application.rb:59:in</code>run'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/gems/rake-0.9.2/bin/rake:32\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/bin/rake:19:in `load'\\n/Users/mohit/.rvm/gems/ruby-1.8.7-p334/bin/rake:19</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have implemented mixpanel in background process using standard get request. But I am still looking for the solution how can I use Mixpanel gem in background process.</p>\n"},{"tags":["ruby-on-rails","activerecord","ruby-on-rails-3"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":4863,"score":1,"question_id":3795135,"title":"Rails 3 LIKE query raises exception when using a double colon and a dot","body":"<p>In rails 3.0.0, the following query works fine:</p>\n\n<pre><code>Author.where(\"name LIKE :input\",{:input =&gt; \"#{params[:q]}%\"}).includes(:books).order('created_at')\n</code></pre>\n\n<p>However, when I input as search string (so containing a double colon followed by a dot):</p>\n\n<blockquote>\n  <p>aa:.bb</p>\n</blockquote>\n\n<p>I get the following exception:</p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: SQLite3::SQLException: ambiguous column name: created_at</p>\n</blockquote>\n\n<p>In the logs the these are the sql queries:</p>\n\n<pre><code>with aa as input:\nAuthor Load (0.4ms)  SELECT \"authors\".* FROM \"authors\" WHERE (name LIKE 'aa%') ORDER BY created_at\nBook Load (2.5ms)  SELECT \"books\".* FROM \"books\" WHERE (\"books\".author_id IN (1,2,3)) ORDER BY id\n\nwith aa:.bb as input:\nSELECT DISTINCT \"authors\".id FROM \"authors\" LEFT OUTER JOIN \"books\" ON \"books\".\"author_id\" = \"authors\".\"id\" WHERE (name LIKE 'aa:.bb%') ORDER BY created_at DESC LIMIT 12 OFFSET 0\nSQLite3::SQLException: ambiguous column name: created_at\n</code></pre>\n\n<p>It seems that with the aa:.bb input, an extra query is made to fetch the distinct author id_s.</p>\n\n<p>I thought Rails would escape all the characters. Is this expected behaviour or a bug?</p>\n\n<p>Best Regards,</p>\n\n<p>Pieter</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12889304,"title":"font colour with if and else ruby on rails tutorial?","body":"<p>So i'm a ror beginner and I'm trying to do this:\nI have ratings out of 100\nI'd like to do\nif rating is between 66 and 100, background colour is green\nif rating is between 33 and 66, background colour is orange\nif rating is between 00 and 33, background colour is red</p>\n\n<p>also my ratings are the average of other ratings so the number aren't actually in the DB, they're just the result of this: </p>\n\n<pre><code>&lt;%= number_with_precision(show.reviews.average(\"rating\"), :precision =&gt; 0)\n</code></pre>\n\n<p>any tutorials around that might explain how to do this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","query-parameters","url-for"],"answer_count":2,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":2265,"score":5,"question_id":5031591,"title":"Query parameters with url_for?","body":"<pre><code>url_for([:edit, @post])\n</code></pre>\n\n<p>is working and generating <code>/comments/123/edit</code>. Now I need to add a query parameter, so that instead of</p>\n\n<pre><code>/comments/123/edit\n</code></pre>\n\n<p>it is</p>\n\n<pre><code>/comments/123/edit?qp=asdf\n</code></pre>\n\n<p>I tried <code>url_for([:edit, @post], :qp =&gt; \"asdf\")</code> but no go.</p>\n"},{"tags":["ruby","ruby-on-rails-3","resque","sidekiq"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":842,"score":2,"question_id":11580954,"title":"Resque vs Sidekiq?","body":"<p>I am currently using <code>Resque</code> for my background process but recently I heard a lot of huff-buff about <code>sidekiq</code>. Could anybody compare/differentiate? </p>\n\n<p>In particular I would like to know is there a way to monitor programmatically whether a job is completed in <code>sidekiq</code></p>\n"},{"tags":["ruby","ruby-on-rails-3","smtp","actionmailer"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":11790954,"title":"sending email with attachments in rails 3","body":"<p>I have followed the <a href=\"http://guides.rubyonrails.org/action_mailer_basics.html\" rel=\"nofollow\">Action Mailer Basics</a>, but I still have the following problems:</p>\n\n<ol>\n<li>I'm unable to send e-mail to a server outside my organization such as gmail</li>\n<li>I'm unable to send attachments over size 195 <b>b</b></li>\n</ol>\n\n<p>Is there anything wrong, why are these problems occurring?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":112,"score":0,"question_id":12887816,"title":"Problems installing Ruby gem \"ffi\" on Ubuntu Server 12.04","body":"<p>I'm trying to use <code>bundle</code> to install gems required for my new project, but I'm having trouble installing version 1.1.5 of the 'ffi' gem.</p>\n\n<p>I'm using Ruby 1.9.3 running on a virtualised install of 64-bit Ubuntu Server 12.04. When running the <code>bundle</code> command, I receive the following error message:</p>\n\n<pre><code>Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\n\n        /home/alex/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb\nchecking for ffi.h... no\nchecking for ffi.h in /usr/local/include,/usr/include/ffi... no\nchecking for rb_thread_blocking_region()... yes\nchecking for ruby_native_thread_p()... yes\nchecking for rb_thread_call_with_gvl()... yes\ncreating extconf.h\ncreating Makefile\n\nmake\nConfiguring libffi\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux\"SampleRails\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux'ems/ruby-1.9.3-p194@SampleRails\nmake \"AR_FLAGS=\" \"CC_FOR_BUILD=\" \"CFLAGS=-Wall -fexceptions\" \"CXXFLAGS=\" \"CFLAGS_FOR_BUILD=\" \"CFLAGS_FOR_TARGET=\" \"INSTALL=/usr/bin/install -c\" \"INSTALL_DATA=/usr/bin/install -c -m 644\" \"INSTALL_PROGRAM=/usr/bin/install -c\" \"INSTALL_SCRIPT=/usr/bin/install -c\" \"JC1FLAGS=\" \"LDFLAGS=\" \"LIBCFLAGS=\" \"LIBCFLAGS_FOR_TARGET=\" \"MAKE=make\" \"MAKEINFO=/b/gems/ffi-1.1.5/ext/ffi_c/libffi/missing --run makeinfo \" \"PICFLAG=\" \"PICFLAG_FOR_TARGET=\" \"RUNTESTFLAGS=\" \"SHELL=/bin/bash\" \"exec_prefix=/usr/local\" \"infodir=/usr/local/share/info\" \"libdir=/usr/local/lib\" \"mandir=/usr/local/share/man\" \"prefix=/usr/local\" \"AR=ar\" \"AS=as\" \"CC=gcc\" \"CXX=g++\" \"LD=/usr/bin/ld -m elf_x86_64\" \"NM=/usr/bin/nm -B\" \"RANLIB=ranlib\" \"DESTDIR=\" all-recursive\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux'ems/ruby-1.9.3-p194@SampleRails\nMaking all in include\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux/include'-1.9.3-p194@SampleRails\nmake[3]: Nothing to be done for `all'.\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux/include'1.9.3-p194@SampleRails\nMaking all in testsuite\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux/testsuite'.9.3-p194@SampleRails\nmake[3]: Nothing to be done for `all'.\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux/testsuite'9.3-p194@SampleRails\nMaking all in man\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux/man'ruby-1.9.3-p194@SampleRails\nmake[3]: *** No rule to make target `ffi.3', needed by `all-am'. Stop.\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux/man'uby-1.9.3-p194@SampleRails\nmake[2]: *** [all-recursive] Error 1\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux'ms/ruby-1.9.3-p194@SampleRails\nmake[1]: *** [all] Error 2\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux'ms/ruby-1.9.3-p194@SampleRails\n/gems/ffi-1.1.5/ext/ffi_c/libffi-x86_64-linux\"/.libs/libffi_convenience.a] Error 2\n\n\n/gems/ffi-1.1.5 for inspection. in /home/alex/.rvm/gems/ruby-1.9.3-p194@SampleRails\n/gems/ffi-1.1.5/ext/ffi_c/gem_make.out/ruby-1.9.3-p194@SampleRails\nAn error occurred while installing ffi (1.1.5), and Bundler cannot continue.\nMake sure that `gem install ffi -v '1.1.5'` succeeds before bundling.\n</code></pre>\n\n<p>The error seems to be caused by the line <code>make[3]: *** No rule to make target 'ffi.3', needed by 'all-am'</code> but I'm none the wiser as to what this means.</p>\n\n<p>Can anybody help me out? Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12888709,"title":"print html entity in rails view using times method","body":"<p>I am trying to print Rating for bookmarks in rails view. I am trying to take out the <strong>rating</strong> (\"3\") from a hash and then convert that string to an int and then print solid star (html entity) that many times. Here is what I have been trying but it just prints the number. I am very new to ruby-on-rails, so I might be missing something very trivial here.</p>\n\n<pre><code>&lt;% @bookmarks.each_with_index do |bookmark, index| %&gt;\n  &lt;div class=\"bookmark\"&gt;\n    &lt;%= link_to bookmark_path(index) do %&gt;\n        &lt;ul&gt;    \n            &lt;li&gt;&lt;%= bookmark[:type] %&gt;&lt;/li&gt;\n            &lt;li&gt;&lt;%= bookmark[:title] %&gt;&lt;/li&gt;\n            &lt;li&gt;\n              &lt;%= bookmark[:rating].to_i.times do print \"&amp;bigstar;\" end %&gt;\n\n              &lt;%= bookmark[:rating].to_i.times do print \"&amp;bigstar;\" end %&gt;\n            &lt;/li&gt;\n        &lt;/ul&gt;\n    &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rails-engines"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12888512,"title":"Rails Engines--how to bypass main_app for named routes","body":"<p>In <a href=\"http://stackoverflow.com/questions/8000536/how-do-i-access-all-routes-when-an-app-and-an-included-appengine-gem-define-con\">this Stack Overflow question</a>, the end of the question begins to address this issue, but it wasn't the main question, which was answered there already.</p>\n\n<p>I have a module that's included both in <code>ApplicationController</code> and in <code>MyEngineController</code>.  Suppose some of the module's instance methods use <code>login_url</code> or some other named route.  It works from ApplicationController but not from <code>MyEngineController</code>.  I could replace that with <code>main_app.login_url</code>, which will make it work for both, but that seems very verbose, and anyway, what if the code is already part of a gem dependency?  How do I make it work post-facto from the engine I'm coding?</p>\n\n<p>When I try using any named helper, here's what I get:</p>\n\n<pre><code>ActionController::RoutingError: \n    No route matches {:action=&gt;\"new\", :controller=&gt;\"sessions\"}\nactionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:532:in `raise_routing_error'\nactionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:528:in `rescue in generate'\nactionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:520:in `generate'\nactionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:561:in `generate'\nactionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:586:in `url_for'\nactionpack-3.2.8/lib/action_dispatch/routing/url_for.rb:148:in `url_for'\nactionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:213:in `login_url'\n</code></pre>\n\n<p>Note that <code>:controller=&gt;\"sessions\"</code> would have to be <code>:controller=&gt;\"/sessions\"</code> (with the slash to put it at root namespace), but that's not an option I can pass to named routes AFAIK.  I tried adding this code:</p>\n\n<pre><code>extend ActiveSupport::Concern\nincluded do\n  main_app.install_helpers(self)\nend\n</code></pre>\n\n<p>in MyEngineController, but it didn't help.  (<code>install_helpers</code> is very poorly documented.  Can anyone explain what it's supposed to do?)</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sorting"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":63,"score":1,"question_id":12879040,"title":"How can I sort on a calculated value?","body":"<p>I'm currently building an NFL pick'em league site.  I have a Users model, a Games model, and join table which captures each user's individual picks.  The games model has a \"result\" attribute which either consists of \"W\" for win, \"L\" for loss, \"P\" for push (tie).</p>\n\n<p>I am running into issues building a standings page.  I currently have two methods in my Users model: </p>\n\n<pre><code>def correct_games\n  self.games.where(result: \"W\").count \nend\n\ndef total_games\n  self.games.where('result != ?', \"P\").count \nend\n</code></pre>\n\n<p>The correct_games method counts the user's picks that were correct.  The total_games methods counts the number of total games (not counting games that resulted in a push).</p>\n\n<p>Then in my view I currently have for each user: <code>&lt;%= number_to_percentage(current_user.correct_games.to_f / current_user.total_games) %&gt;</code></p>\n\n<p>This division gives me that user's win percentage (# correct/total picks). For my standings table, I obivously want a descending order on win percentage.  The issue is the only solutions to sorting seem to be using the .order method which usually requires some attribute to already be in the database which you can then call in the controller.</p>\n\n<p>I've also tried adding this win percentage attribute to the database, but I can't seem to figure out a callback that will update the User's score whenever the game results are updated.</p>\n\n<p>Any solutions to either sorthing on an attribute that is calculated in the view  or a way to add this win percentage to the users model?</p>\n\n<p>Thanks in advance!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","jquery-ajax","partial-views"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":92,"score":-1,"question_id":12869507,"title":"How can I reload page without refreshing using Ajax in Rails3","body":"<p>I tried these codes below. But it gives error back :(\nI'm pretty sure that I have mistake in \"set_follow.js.erb\" but I have no idea what it is.\nCan anybody show me what's wrong there?</p>\n\n<p>Here's my codes</p>\n\n<p>users_controller.rb </p>\n\n<pre><code>  def set_follow\n    friend = User.find_by_username(params[:username])\n    if f = Friendship.find(:first, :conditions =&gt; { :user_id =&gt; current_user.id, :friend_id =&gt; friend.id})\n      f.destroy\n      flash[:notice] = \"Now added to follow list\"\n      respond_to do |format|\n        format.html { redirect_to set_follow }\n        format.js\n      end\n      #redirect_to :back\n    else\n      Friendship.create(:user_id =&gt; current_user.id, :friend_id =&gt; friend.id)\n      flash[:error] = \"Now deleted from follow list\"\n      respond_to do |format|\n        format.html { redirect_to set_follow }\n        format.js\n      end\n      #redirect_to :back\n    end    \n  end\n</code></pre>\n\n<p>users/index.html.erb</p>\n\n<pre><code>        &lt;div id=\"follow_status\"&gt;\n        &lt;% if user_signed_in? &amp;&amp; current_user.friends.find_by_id(user.id) %&gt; \n                &lt;%= link_to sanitize('&lt;i class=\"icon-remove icon-white\"&gt;&lt;/i&gt; ') + 'Un-Follow', follow_user_path(user.username), :class =&gt; 'btn', remote: true %&gt;              \n        &lt;% elsif current_user != user %&gt;\n                &lt;%= link_to sanitize('&lt;i class=\"icon-ok icon-white\"&gt;&lt;/i&gt; ') + 'Follow', follow_user_path(user.username), :class =&gt; 'btn btn-primary', remote: true %&gt;             \n        &lt;% end %&gt;\n        &lt;/div&gt;\n</code></pre>\n\n<p>set_follow.js.erb</p>\n\n<pre><code>$(\"#follow_status\").html(\"&lt;%= escape_javascript(render f) %&gt;\");\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","devise"],"answer_count":3,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":608,"score":1,"question_id":11219670,"title":"devise_error_messages! causes undefined method `errors' for nil:NilClass","body":"<p>I have a form on my layouts/application.html.erb that is posted below and and if i add the line <code>&lt;%= devise_error_messages! %&gt;</code> I get the error below.</p>\n\n<p>How can i add the devise_error_messages without having the page break?</p>\n\n<p>/app/views/layouts/application.html.erb</p>\n\n<pre><code>&lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n    &lt;%= devise_error_messages! %&gt;  &lt;!-- this line causes issues --&gt;\n    &lt;h3&gt;Add new contact&lt;/h3&gt;\n    First Name&lt;br /&gt;\n    &lt;%= f.text_field :username %&gt;&lt;br /&gt;\n    Last Name&lt;br /&gt;\n    &lt;%= f.text_field :password %&gt;&lt;br /&gt;\n    &lt;%= f.text_field :password_confirmation %&gt;&lt;br /&gt;                                \n    Email&lt;br /&gt;\n    &lt;%= f.text_field :email %&gt;\n    &lt;hr /&gt;\n    &lt;%= f.submit \"Add Contact\" %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>NoMethodError in My_devise/sessions#index\n\nShowing /app/views/layouts/application.html.erb where line #59 raised:\n\nundefined method `errors' for nil:NilClass\n\nExtracted source (around line #59):\n\n56:                             &lt;a href=\"#\" class=\"has-popupballoon button button-blue\"&gt;&lt;span class=\"add\"&gt;&lt;/span&gt;New Contact&lt;/a&gt;\n57:                             &lt;div class=\"popupballoon top\"&gt;\n58:                             &lt;%= form_for(resource, :as =&gt; resource_name, :url =&gt; registration_path(resource_name)) do |f| %&gt;\n59:   &lt;%= devise_error_messages! %&gt;\n60:                                 &lt;h3&gt;Add new contact&lt;/h3&gt;\n61:                                 First Name&lt;br /&gt;\n62:                                 &lt;%= f.text_field :username %&gt;&lt;br /&gt;\n</code></pre>\n\n<p>This is the url i'm using <code>http://localhost:3000/admin/home</code> and here's my routes.rb</p>\n\n<pre><code>devise_for :users do \n    get '/users/sign_out' =&gt; 'devise/sessions#destroy' \n    get \"/users/sign_in\", :to =&gt; \"my_devise/sessions#new\"\n    get 'admin/home', :to =&gt; 'my_devise/sessions#index'\n    get 'users/sign_up', :to =&gt; 'my_devise/registrations#new'\n  end \n\n  devise_for :users, :controllers =&gt; {:sessions =&gt; \"my_devise/sessions\", :registrations =&gt; \"my_devise/registrations\"}\n  get \"home/index\"\n  root :to =&gt; \"home#index\"\n</code></pre>\n\n<p>/app/controllers/my_devise/sessions_controller.rb</p>\n\n<pre><code>class MyDevise::SessionsController &lt; Devise::SessionsController\n    layout false\n\n    before_filter :authenticate_user!\n\n    def index\n        render :layout =&gt; 'application'\n    end\n\n    def new\n        super\n    end\n\n    def create\n        super\n    end\n\nend\n</code></pre>\n\n<p>/app/controllers/my_devise/registrations_controller.rb</p>\n\n<pre><code>class MyDevise::RegistrationsController &lt; Devise::RegistrationsController\n\n    def index\n\n    end\n\nend\n</code></pre>\n\n<p>Rake routes:</p>\n\n<pre><code>users_sign_out GET    /users/sign_out(.:format)      {:controller=&gt;\"devise/sessions\", :action=&gt;\"destroy\"}\n           users_sign_in GET    /users/sign_in(.:format)       {:controller=&gt;\"my_devise/sessions\", :action=&gt;\"new\"}\n              admin_home GET    /admin/home(.:format)          {:controller=&gt;\"my_devise/sessions\", :action=&gt;\"index\"}\n           users_sign_up GET    /users/sign_up(.:format)       {:controller=&gt;\"my_devise/registrations\", :action=&gt;\"new\"}\n        new_user_session GET    /users/sign_in(.:format)       {:action=&gt;\"new\", :controller=&gt;\"devise/sessions\"}\n            user_session POST   /users/sign_in(.:format)       {:action=&gt;\"create\", :controller=&gt;\"devise/sessions\"}\n    destroy_user_session DELETE /users/sign_out(.:format)      {:action=&gt;\"destroy\", :controller=&gt;\"devise/sessions\"}\n           user_password POST   /users/password(.:format)      {:action=&gt;\"create\", :controller=&gt;\"devise/passwords\"}\n       new_user_password GET    /users/password/new(.:format)  {:action=&gt;\"new\", :controller=&gt;\"devise/passwords\"}\n      edit_user_password GET    /users/password/edit(.:format) {:action=&gt;\"edit\", :controller=&gt;\"devise/passwords\"}\n                         PUT    /users/password(.:format)      {:action=&gt;\"update\", :controller=&gt;\"devise/passwords\"}\ncancel_user_registration GET    /users/cancel(.:format)        {:action=&gt;\"cancel\", :controller=&gt;\"devise/registrations\"}\n       user_registration POST   /users(.:format)               {:action=&gt;\"create\", :controller=&gt;\"devise/registrations\"}\n   new_user_registration GET    /users/sign_up(.:format)       {:action=&gt;\"new\", :controller=&gt;\"devise/registrations\"}\n  edit_user_registration GET    /users/edit(.:format)          {:action=&gt;\"edit\", :controller=&gt;\"devise/registrations\"}\n                         PUT    /users(.:format)               {:action=&gt;\"update\", :controller=&gt;\"devise/registrations\"}\n                         DELETE /users(.:format)               {:action=&gt;\"destroy\", :controller=&gt;\"devise/registrations\"}\n        new_user_session GET    /users/sign_in(.:format)       {:action=&gt;\"new\", :controller=&gt;\"my_devise/sessions\"}\n                         POST   /users/sign_in(.:format)       {:action=&gt;\"create\", :controller=&gt;\"my_devise/sessions\"}\n    destroy_user_session DELETE /users/sign_out(.:format)      {:action=&gt;\"destroy\", :controller=&gt;\"my_devise/sessions\"}\n                         POST   /users/password(.:format)      {:action=&gt;\"create\", :controller=&gt;\"devise/passwords\"}\n                         GET    /users/password/new(.:format)  {:action=&gt;\"new\", :controller=&gt;\"devise/passwords\"}\n                         GET    /users/password/edit(.:format) {:action=&gt;\"edit\", :controller=&gt;\"devise/passwords\"}\n                         PUT    /users/password(.:format)      {:action=&gt;\"update\", :controller=&gt;\"devise/passwords\"}\n                         GET    /users/cancel(.:format)        {:action=&gt;\"cancel\", :controller=&gt;\"my_devise/registrations\"}\n                         POST   /users(.:format)               {:action=&gt;\"create\", :controller=&gt;\"my_devise/registrations\"}\n                         GET    /users/sign_up(.:format)       {:action=&gt;\"new\", :controller=&gt;\"my_devise/registrations\"}\n                         GET    /users/edit(.:format)          {:action=&gt;\"edit\", :controller=&gt;\"my_devise/registrations\"}\n                         PUT    /users(.:format)               {:action=&gt;\"update\", :controller=&gt;\"my_devise/registrations\"}\n                         DELETE /users(.:format)               {:action=&gt;\"destroy\", :controller=&gt;\"my_devise/registrations\"}\n              home_index GET    /home/index(.:format)          {:controller=&gt;\"home\", :action=&gt;\"index\"}\n                    root        /                              {:controller=&gt;\"home\", :action=&gt;\"index\"}\n                    root        /                              {:controller=&gt;\"home\", :action=&gt;\"index\"}\n</code></pre>\n"},{"tags":["ruby-on-rails-3","search","activerecord","datagrid"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12888067,"title":"Ruby on Rails - Displaying advanced search results in a Wice Grid","body":"<p>I'm working on this real challenge for a week now and hope somebody here have a solution.</p>\n\n<p>In a web application, I have a \"Customer\" model, which is in relation with a lot of other table like for example \"Address\", \"Contacts\", \"Transaction\", \"Products\", etc. Now I want to permits my users to search for customers based on a bunch of related models attributes, like the transaction type, the product expiration date, etc. Also, in a lot of other place in the application, we are using \"Wice Grid\" to display data, and we love the filters and sorting capabilities of this grid.</p>\n\n<p>Even if it might work, I think it would be a bad idea to display all the search attributes in separate columns of a big Wice Grid because the grid will be 4 feet wide!</p>\n\n<p>So basically, what I want to achieve is to have a big advanced search form containing the related models attributes where the user would kind_of \"pre_filter\" (scope) the \"Customers\" to be displayed in the Wice Grid. And in this results Wice Grid, I would only show the \"Customers\" attributes, so the user will be able to use the built in filters and sorting features of Wice Grid on those \"Customer\" attributes. But very unfortunately, we are unable to tell Wice Grid to use a particular subset (scope) of data. Well, I can't find how!</p>\n\n<p>So any idea how to resolve my problem would be VERY appreciated. Even if your suggestion doesn't include Wice Grid, I will consider it cause I'm in a dead end.</p>\n\n<p>Thanks a lot for reading</p>\n"},{"tags":["ruby-on-rails-3","foreign-keys","has-many-through","belongs-to","nesting"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":49,"score":1,"question_id":12754829,"title":"Frustrated With Nesting in Ruby on Rails","body":"<p>This is my first post here and to be honest, I don't tend to ask many questions, but something has been irritating me for quite some time involving nesting in Ruby on Rails.</p>\n\n<p>I have a <code>class Thought</code> (which are members' individual posts) that are paginated as <code>@share_items</code>.  I am including a like button that will allow members to like other members' posts (like Facebook).  The like button has the <code>class Opinion</code>.</p>\n\n<p>My code thus far:</p>\n\n<pre><code>Class Member\nhas_many :thoughts, dependent: :destroy\nhas_many :opinions, foreign_key: \"fan_id\", dependent: :destroy\nhas_many :fans, through: :opinions\n\nClass Thought\nbelongs_to :member\n\nhas_many :opinions, foreign_key: \"like_id\", dependent: :destroy\nhas_many :likes, through: :opinions\n\nvalidates :member_id, presence: true\n\nClass Opinion\nattr_accessible :like_id\n\nbelongs_to :fan, class_name: \"Member\"\nbelongs_to :like, class_name: \"Thought\"\n\nvalidates :fan_id, presence: true\nvalidates :like_id, presence: true\n\nMember Model\ndef share\nThought.from_members_authenticated(self)\nend\n\nMemberPages Controller\ndef homepage\n@share_items = registered_member.share.paginate(page: params[:page])\nend\n</code></pre>\n\n<p>Partial <code>_share.html.erb</code>:</p>\n\n<pre><code>&lt;% if @share_items.any? %&gt;\n&lt;ol class=\"member_shares\"&gt;\n&lt;%= render 'shared/share_item', collection: @share_items %&gt;\n&lt;/ol&gt;\n&lt;%= will_paginate @share_items %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Which renders partial <code>_share_item.html.erb</code>:</p>\n\n<pre><code>&lt;li id=\"&lt;%= share_item.id %&gt;\"&gt;\ncontent...\n&lt;%= render 'thoughts/like_form' %&gt;\n...content\n&lt;/li&gt;\n</code></pre>\n\n<p>Everything goes smoothly until I try to render the form <code>thoughts/like_form</code> inside paginated <code>@share_items</code> (<code>class Thought</code>). It has bizarre and unexplainable results (to me).  Here are the codes leading up to the form.</p>\n\n<pre><code>Member Model\n\ndef liked?(random_thought)\nopinions.find_by_like_id(random_thought.id)\nend\n\ndef like!(random_thought)\nopinions.create!(like_id: random_thought.id)\nend\n\ndef unlike!(random_thought)\nopinions.find_by_like_id(random_thought.id).destroy\nend\n\nOpinionsController\n\nrespond_to :html, :js\n\ndef create\n@thought = Thought.find(params[:opinion][:like_id])\nregistered_member.like!(@thought)\nrespond_with @thought\nend\n\ndef destroy\n@thought = Opinion.find(params[:id]).like\nregistered_member.unlike!(@thought)\nrespond_with @thought\nend\nend\n</code></pre>\n\n<p>And finally the form <code>thoughts/like_form</code>:</p>\n\n<pre><code>&lt;div id=\"like_form\"&gt;\n&lt;% if registered_member.liked?(@thought) %&gt;\n&lt;%= render 'thoughts/unlike' %&gt;\n&lt;% else %&gt;\n&lt;%= render 'thoughts/like' %&gt;\n&lt;% end %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>which will render either <code>thoughts/unlike</code>:</p>\n\n<pre><code>&lt;%= form_for(registered_member.opinions.find_by_like_id(@thought),\nhtml: { method: :delete },\nremote: true) do |f| %&gt;\n&lt;%= f.submit \"Unlike\", class: \"btn btn-small btn-default\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>or: <code>thoughts/like</code>:</p>\n\n<pre><code>&lt;%= form_for(registered_member.opinions.build(like_id: @thought.id),\nremote: true) do |f| %&gt;\n&lt;div&gt;&lt;%= f.hidden_field :like_id %&gt;&lt;/div&gt;\n&lt;%= f.submit \"Like\", class: \"btn btn-small btn-primary\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Concluding with <code>opinions/create.js.erb</code>:</p>\n\n<pre><code>$(\"#like_form&lt;%= @thought.id %&gt;\").html(\"&lt;%= escape_javascript(render('shared/unlike')) %&gt;\")\n$(\"#likes\").html('&lt;%= @thought.likes.count %&gt;')\n</code></pre>\n\n<p>and <code>opinions/destroy.js.erb</code>:</p>\n\n<pre><code>$(\"#like_form&lt;%= @thought.id %&gt;\").html(\"&lt;%= escape_javascript(render('shared/like')) %&gt;\")\n$(\"#likes\").html('&lt;%= @thought.likes.count %&gt;')\n</code></pre>\n\n<p>Notice I do something fishy to the js... I try to tell the like form to target a specific thought (member's share).  Note:  This has been the most successful thus far, but no cigar.  It adds fan_id (member) and like_id (thought) to the database and renders the unlike button.  But it has unpredicted results.  For example:  Sometimes, no matter which of the members' shares I like, it will always render unlike on the first share of the page, although it will add the correct data to the database.  Other times it will work correctly, but after refreshing the page, it will either render the like button (even though it was currently liked) or it will render the correct button, but it will raise an error when trying to \"unlike\" the share saying that there is no match to \"destroy /opinions\" which indicates it is not targeting specific shares.</p>\n\n<p>So to reiterate my my intentional question:  How  would I \"successfully\" render a like button (with the <code>class Opinion</code>) inside a member's UNIQUE share (<code>class Thought</code>) when it is inside a paginated list defined as <code>@share_items</code>.</p>\n\n<p>Sorry if I was confusing, first time posting here and I am new to Ruby.  Thank you for any help you may give.</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":29,"score":0,"question_id":12617173,"title":"ajax:before clearing input","body":"<p>I have a form. </p>\n\n<pre><code>  &lt;%= simple_form_for(@something, :remote =&gt; true ) do |f| %&gt;\n    &lt;%= f.input :name, :label =&gt; false, :placeholder =&gt; \"Add new something\" %&gt;\n  &lt;% end %&gt;\n</code></pre>\n\n<p>It has no button, the submission is achieved through hitting return. </p>\n\n<p>There's some javascript to act on the submission of the form.</p>\n\n<pre><code>$('form.new_something')\n  .on(\"ajax:before\", function(){\n    $text_box = $('input:text', this);\n    $text_box.prop('disabled', true);\n    $text_box.val('Loading...');\n  })\n</code></pre>\n\n<p>This results in 'name' property of my my new Something model <strong>being set to 'null'</strong> instead of the value of the text box.</p>\n\n<p>I presume this is because I'm using \"ajax:before\" which is triggered just before the post is made.</p>\n\n<p>Any advice on what I should do?</p>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","ujs"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12683524,"title":"With Rails UJS, how to submit a remote form from a function","body":"<p>I'm using Rails UJS. I have a form setup to do a remote submit like so:</p>\n\n<pre><code>&lt;form accept-charset=\"UTF-8\" action=\"/subscriptions\" class=\"new_subscription form-horizontal\" id=\"new_subscription\" data-remote=\"true\" data-type=\"json\" method=\"POST\"&gt;\n</code></pre>\n\n<p>I'm trying to find a way to submit this form from a JavaScript function. I've tried: </p>\n\n<pre><code>var form$ = $(\"#new_subscription\");\nform$.get(0).submit();\n</code></pre>\n\n<p>but the problem with this is that it submits the form w/o the remote, it posts to the server and refreshes the page. Any idea why that is? Is there a different way to submit a remote form?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":48,"score":0,"question_id":12887222,"title":"How can I make sure that a user can only edit his own entries?","body":"<p>I have <code>Users</code> that have many <code>People</code> that have many <code>Projects</code>.</p>\n\n<p>For example, a new project can be created like this:</p>\n\n<pre><code>def new\n  @project = Project.new(:person_id =&gt; params[:person_id])\n  @title = \"New project\"\nend\n</code></pre>\n\n<p>How can I make sure that a user can only insert a <code>person_id</code> here that really belongs to him?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","forum"],"answer_count":2,"favorite_count":2,"up_vote_count":3,"down_vote_count":0,"view_count":1259,"score":3,"question_id":3847588,"title":"An app forum for rails 3","body":"<p>I'm looking for a forum app for rails 3.\nAll the forums is for rails2.</p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","windows","ruby-on-rails-3","jruby"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":52,"score":0,"question_id":12851746,"title":"Windows - JRuby on Rails - ActionView::Template::Error invalid encoding","body":"<p>I want to try jruby 1.7.0.RC2 on Windows with Rails 3.2. I'm able to start the server, but each time I try to access a page that requires a css (javascript_include_tag), I get the following error:</p>\n\n<pre><code>invalid encoding in marshaling stream: I\"co\n</code></pre>\n\n<p>Here is the stack trace, if it helps:</p>\n\n<pre><code>ActionView::Template::Error (invalid encoding in marshaling stream: I\"◄co):\n    9:     = stylesheet_link_tag \"application\", :media =&gt; \"all\"\n  app/views/layouts/application.html.haml:9:in `_app_views_layouts_application_h\ntml_haml__357561048_13162'\n\n  Rendered C:/jruby-1.7.0.RC2/lib/ruby/gems/shared/gems/actionpack-3.2.8/lib/act\nion_dispatch/middleware/templates/rescues/_trace.erb (7.0ms)\n  Rendered C:/jruby-1.7.0.RC2/lib/ruby/gems/shared/gems/actionpack-3.2.8/lib/act\nion_dispatch/middleware/templates/rescues/_request_and_response.erb (6.0ms)\n  Rendered C:/jruby-1.7.0.RC2/lib/ruby/gems/shared/gems/actionpack-3.2.8/lib/act\nion_dispatch/middleware/templates/rescues/template_error.erb within rescues/layo\nut (41.0ms)\n</code></pre>\n\n<p>My application.css is only the result of the default asset pipeline, nothing fancy. I even get the same error with an empty application.css.scss file...</p>\n\n<p>Everything works fine with Ruby MRI 1.9.2 and 1.9.3.</p>\n\n<p>I must say that when it comes to encoding, I'm clueless. Any idea?</p>\n"},{"tags":["javascript","ruby-on-rails","ajax","ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":104,"score":2,"question_id":12885265,"title":"Rails: Populating bootstrap dropdown with ajax","body":"<p>I currently have a dropdown that will display notifications</p>\n\n<pre><code>&lt;li class=\"notifications dropdown\"&gt; \n  &lt;a class=\"dropdown-toggle\" id=\"dLabel\" role=\"button\" data-remote=\"true\" data-toggle=\"dropdown\" data-target=\"#\" href=\"/notifications\"&gt;&lt;i class=\"icon-user\"&gt;&lt;/i&gt; Notifications&lt;/a&gt;\n  &lt;ul class=\"dropdown-menu\" role=\"menu\" aria-labelledby=\"dLabel\"&gt;\n  &lt;/ul&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>The ul dropdown is empty but on click of the link I want to populate the menu with data from rails. </p>\n\n<p>I currently have this in notifications.js.erb</p>\n\n<pre><code>$(\".nav li.notifications .dropdown-menu\").remove();\n$(\".nav li.notifications\").append(\"&lt;%= escape_javascript(render('users/notifications', notifications: @notifications)) %&gt;\");\n</code></pre>\n\n<p>Normally I would set the dropdown link to remote but since I am using a bootstrap's dropdown no request is being sent to notifications.js.erb. How can I manually call the code there?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","validation","error-handling"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12886378,"title":"404 Error on model validation redirect RoR","body":"<p>I am trying to add some basic validation to my newsletter sign up process in RoR. </p>\n\n<p>The issue I am having is that I keep receiving the following error:</p>\n\n<pre><code>Missing template /404 with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee, :haml]}. Searched in: * \"C:/Sites/jobapp_v3/app/views\" * \"C:/RailsInstaller/Ruby1.9.2/lib/ruby/gems/1.9.1/gems/rails_admin-0.1.1/app/views\" * \"C:/RailsInstaller/Ruby1.9.2/lib/ruby/gems/1.9.1/gems/kaminari-0.14.1/app/views\" * \"C:/RailsInstaller/Ruby1.9.2/lib/ruby/gems/1.9.1/gems/devise-2.1.2/app/views\"\n</code></pre>\n\n<p>At the moment I have the following: </p>\n\n<p>Controller: </p>\n\n<pre><code>class NewslettersController &lt; ApplicationController\n\ndef new\n  @newsletter = Newsletter.new\nend\n\ndef create\n @newsletter = Newsletter.create(params[:newsletter])\nif @newsletter.save\n  redirect_to jobs_path\nelse\n  flash.now.alert = \"Invalid email\"\n  render :action =&gt; \"new\"\nend\nend\n\nend\n</code></pre>\n\n<p>In my routes I have <code>resources :newsletters</code> and can correctly see newsletter/new as a route when rake routes is run.</p>\n\n<p>In my model I have:</p>\n\n<pre><code>class Newsletter &lt; ActiveRecord::Base\n\nvalidates_presence_of :email\n\nvalidates_length_of :email, :within =&gt; 6..50\nvalidates_uniqueness_of :email, :case_sensitive =&gt; false, :on =&gt; :create\nvalidates_format_of :email,     :with =&gt; /^[A-Z0-9_.%-]+@([A-Z0-9_]+\\.)+[A-Z]{2,4}$/i,\n                    :message =&gt; \"must be a valid e-mail address\"\n\nend\n</code></pre>\n\n<p>I am very confused why this is happening as I believe it should work but I can't even navigate directly to localhost:3000/newsletters/new without receiving this error. </p>\n\n<p>Any help really would be much apprecaited!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sass","jammit"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":25,"score":0,"question_id":12886080,"title":"Jammit::PackageNotFound error - does not recognize new css file","body":"<p>I keep getting an error: <code>assets.yml does not contain a \"user_correction\" CSS package</code> when I try to load a new stylesheet in my view.</p>\n\n<p>My view contain the following snippet at the top of the file:</p>\n\n<pre><code>- content_for :stylesheet_includes do\n  = include_stylesheets :user_correction\n</code></pre>\n\n<p>and my assets.yml file contain this following snippet:</p>\n\n<pre><code>embed_assets: off\njavascript_compressor: yui\ncompress_assets: on\nallow_debugging: on\n\nstylesheets:\n  user_correction_submit:\n    - public/stylesheets/pages/user_correction.css\n</code></pre>\n\n<p>I am also using SASS and made to watch my sass file so that the CSS is being updated. I checked to make sure the user_correction.css is in the correct directory. I also restarted my server just to make sure.</p>\n\n<p>Any clue why Jammit does not recognize my newly created css file?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12885929,"title":"Unordered list within anchor tag Rails","body":"<p>I am trying to put anchor tag around an unordered list in rails. I can't find anything online. Is it not possible to do that in rails or is it very trivial and I am missing an obvious thing. I am not much familiar with the ruby-on-rails syntax because I am newbie in rails.</p>\n\n<p>Here is what I am trying to achieve:</p>\n\n<pre><code>&lt;article id=\"bookmark-list\"&gt;\n    &lt;h1&gt;Popular Bookmark List&lt;/h1&gt;\n\n    &lt;div class=\"bookmark\"&gt;\n        &lt;a href=\"../bookmarks/show.html\"&gt;\n            &lt;ul&gt;    \n                &lt;li&gt;Article&lt;/li&gt;\n                &lt;li&gt;How did they find that monkey?&lt;/li&gt;\n                &lt;li&gt;&amp;bigstar;&amp;bigstar;&amp;bigstar;&amp;star;&amp;star;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/a&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"bookmark\"&gt;\n        &lt;a href=\"../bookmarks/show.html\"&gt;\n            &lt;ul&gt;    \n                &lt;li&gt;Article&lt;/li&gt;\n                &lt;li&gt;How did they find that monkey?&lt;/li&gt;\n                &lt;li&gt;&amp;bigstar;&amp;bigstar;&amp;bigstar;&amp;star;&amp;star;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/a&gt;\n    &lt;/div&gt;\n&lt;/article&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12885908,"title":"Rails map options_from_collection_for_select","body":"<p>I have the following code for generating a select box</p>\n\n<pre><code>options_from_collection_for_select(@ticket_types, :id, :name)\n\n&lt;select id=\"ticket_ticket_type_id\" name=\"ticket[ticket_type_id]\"&gt;\n&lt;option value=\"1\"&gt;VIP&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>My model TicketType has the attributes id,name, and price.\nI would like to concatenate name and price so that it is shown on the select.\nSomething like this:</p>\n\n<pre><code>options_from_collection_for_select(@ticket_types, :id, :name + :price)\n\n&lt;select id=\"ticket_ticket_type_id\" name=\"ticket[ticket_type_id]\"&gt;\n&lt;option value=\"1\"&gt;VIP - $100&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","backbone.js"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12885640,"title":"Backbone and Rails Fetching","body":"<p>So I am pulling in a model with model.fetch</p>\n\n<p>That model has a collection.  The json contains an array (of stops).\nThe collection in the model is being overridden by the array since that is what the json returned by model.fetch contains.  Is there any way around this?</p>\n\n<pre><code>App.Models.Itinerary = Backbone.Model.extend({\n    url: '',\n    ID: \"\",\n    Name: \"\",\n    stops: new App.Collections.StopCollection(),\n</code></pre>\n\n<p>Then I call window.Itinerary.fetch()</p>\n\n<p>and stops is now an array (with the correct data)</p>\n\n<p>JSON I get back is</p>\n\n<p>(model)</p>\n\n<pre><code>{\"ID\":\"7cd9dcdc-54f1-4704-a8be-393d67559b7e\",\"Name\":\"China\",\"stops\":\n</code></pre>\n\n<p>(collection)</p>\n\n<pre><code>    [{\"ID\":\"1\",\"Name\":\"Jordan Stop\",\"Notes\":\"Ayo Notes!\",\"OrderNumber\":null},\n{\"ID\":\"5\",\"Name\":\"Another Jordan Stop\",\"Notes\":\"Aya Notes :-!\",\"OrderNumber\":null}]}\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":4,"favorite_count":0,"up_vote_count":1,"down_vote_count":1,"view_count":129,"score":0,"question_id":12880951,"title":"No route matches [GET] \"/\"","body":"<p>I'm new to rails so it may sound quite naive.I'm getting this error</p>\n\n<pre><code>No route matches [GET] \"/\"\n</code></pre>\n\n<p>Here is my routes.rb</p>\n\n<pre><code>MyApp::Application.routes.draw do\n    match 'welcome/contact' =&gt; 'welcome#index'\nend\n</code></pre>\n\n<p>Here is my controller</p>\n\n<pre><code>class WelcomeController &lt; ApplicationController\n   def index\n      redirect_to :action =&gt; :contact\n   end\n   def contact\n\n   end\nend\n</code></pre>\n\n<p>And i have a contact.html.erb in my app/view/welcome/.What am i doing wrong?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activeadmin"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":45,"score":0,"question_id":12860767,"title":"Active Admin with sub-uri: redirects to wrong login path","body":"<p>I've an application that is deployed on a sub uri \"rails-app\":  www.example.com/rails-app. I'm using active_admin for the admin part.</p>\n\n<p>The redirection to the login page does not work properly. \nHere my Scenario:</p>\n\n<ul>\n<li>given: I'm NOT logged in</li>\n<li>I visit the dashboard page www.example.com/rails-app/dashboard</li>\n<li>Since I'm not logged in, authentication fails (before_filter :authenticate_active_admin_user) </li>\n<li>Rails redirects to the login page. Here is the problem. Rails doesn't reflect the sub-uri \"rails-app\" and redirects to 'www.example.com/admin/login' which is wrong. It should be 'www.example.com/*<em>rails-app/</em>*admin/login'</li>\n</ul>\n\n<p>I've configured the relative_url_root setting in production.rb</p>\n\n<pre><code>config.action_controller.relative_url_root = '/rails-app'\n</code></pre>\n\n<p>And I saw the patch for the root_path here: <a href=\"https://github.com/gregbell/active_admin/pull/1173\" rel=\"nofollow\">https://github.com/gregbell/active_admin/pull/1173</a> and implemented it. The other parts of the application works well with the sub-uri.</p>\n\n<p>I wasn't able to debug what actually happens on authentication. Any ideas?</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":119,"score":0,"question_id":11812946,"title":"Bootstrap Carousel in Rails suddenly stopped working","body":"<p>The carousel I had in my rails application was working until a short while ago, now the next and previous buttons don't work. No changes made to this view, or the carousel in the CSS.</p>\n\n<p>Here's my code: </p>\n\n<pre><code>.carousel.slide#myCarousel\n .carousel-inner\n  .active.item\n    =image_tag(\"/assets/1.jpg\")\n    .carousel-caption\n      %h4 Caption\n  .item\n    =image_tag(\"/assets/2.jpg\")\n    .carousel-caption\n      %h4 Caption\n  .item\n    =image_tag(\"/assets/3.jpg\")\n    .carousel-caption\n      %h4 Caption\n\n %a.carousel-control.left{\"data-slide\" =&gt; \"prev\", :href =&gt; \"#myCarousel\"} ‹\n %a.carousel-control.right{\"data-slide\" =&gt; \"next\", :href =&gt; \"#myCarousel\"} ›\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":84,"score":2,"question_id":12883537,"title":"How to calculate a default value for a form text field in Ruby on Rails?","body":"<p>I have a form for <code>payments</code> like this:</p>\n\n<pre><code>&lt;%= f.label :invoice_id %&gt;\n&lt;%= f.select(:invoice_id, current_user.outstanding_invoices_collection) %&gt;\n\n&lt;%= f.label :amount %&gt;\n&lt;%= f.text_field :amount %&gt;\n</code></pre>\n\n<p>I wonder if there's a way to populate the value of the <code>amount</code> text field somehow, e.g. with the open balance of the associated <code>invoice</code>?</p>\n\n<p>In my <code>Invoice</code> model have this function:</p>\n\n<pre><code>def balance\n  payments.map(&amp;:amount).sum - total\nend\n</code></pre>\n\n<p>How can this be done?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":39,"score":0,"question_id":12884667,"title":"association through many models","body":"<p>I have the following models:</p>\n\n<pre><code>class Song &lt; ActiveRecord::Base\n\n  belongs_to :albums\n\nend\n\nclass Album &lt; ActiveRecord::Base\n\n  belongs_to :artist\n  has_many :songs\n\nend\n\nclass Artist &lt; ActiveRecord::Base\n\n  belongs_to :user\n  has_many :albums\n\nend\n</code></pre>\n\n<p>I need to determine which user a specific song belongs to on a regular basis. Is it better form to add a belongs_to :user relationship in the Song model or to call song.album.artist.user every time ?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","boolean","default"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":43,"score":2,"question_id":12884743,"title":"Rails setting default boolean in model","body":"<p>I'm writing a simple blog app in Rails, version 3.2.8. I've scaffolded the \"posts\" resource as follows:</p>\n\n<pre><code>rails g scaffold post title:string body:string islive:boolean\n</code></pre>\n\n<p>I want to set islive to be false by default and I'm trying to do so in my model. I also decided I don't want it available to mass assignment so I've coded up my model as follows:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\n  attr_accessible :body,  :title\n\n  before_save :default_values\n\n  def default_values\n    self.islive = false\n  end\nend\n</code></pre>\n\n<p>I've also removed the <code>islive</code> field from my form. The trouble is when I try to create a new post with the model as above, it doesn't save. The  console looks like this:</p>\n\n<pre><code>Started POST \"/posts\" for 127.0.0.1 at 2012-10-14 18:23:30 +0100\nProcessing by PostsController#create as HTML\n  Parameters: {\"utf8\"=&gt;\"✓\",\n\"authenticity_token\"=&gt;\"/lNa21JBeBz/H2cYLqAsF8uWr1frLV88WsOVKzOqwb4=\", \"post\"=&gt;\n {\"title\"=&gt;\"sample title\", \"body\"=&gt;\"the body\"}, \"commit\"=&gt;\"Create Post\"}\n(0.1ms)  begin transaction\n(0.0ms)  rollback transaction\nRendered posts/_form.html.erb (1.8ms)\nRendered posts/new.html.erb within layouts/application (2.5ms)\nCompleted 200 OK in 29ms (Views: 26.3ms | ActiveRecord: 0.1ms)\n</code></pre>\n\n<p>And nothing is saved. I simply get the <code>begin transaction</code> <code>rollback transaction</code> However, if I change <code>default_values</code> to this:</p>\n\n<pre><code>def default_values\n    self.islive = 'false'\nend\n</code></pre>\n\n<p>everything works and it saves fine, with a <code>falsey</code> value for <code>islive</code>. Even if I just do something like this:</p>\n\n<pre><code>def default_values\n    self.islive = false\n    Rails.logger.debug self.islive\nend\n</code></pre>\n\n<p>then the save works.</p>\n\n<p>Can somebody shed some light on why this behaves as it does?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routing","blogs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":56,"score":0,"question_id":12876418,"title":"Rails 3: Create and Delete action gives 'Template not found' error","body":"<p>I've come across a really strange error. I've installed '<a href=\"https://github.com/KatanaCode/blogit\" rel=\"nofollow\">Blogit</a>' and am trying to add on a few bits and pieces. I'm encountering a strange error when I submit a new entry:</p>\n\n<pre><code>Template is missing\n\nMissing template blogit/posts/create, blogit/application/create, application/create with \n{:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \n\"/Users/James/Documents/Websites/Backpack Bug/app/views\" * \"/Users/James/.rvm/gems/ruby-\n1.9.3-p0/gems/blogit-0.4.8/app/views\" * \"/Users/James/.rvm/gems/ruby-1.9.3-\np0/gems/kaminari-0.14.1/app/views\" * \"/Users/James/.rvm/gems/ruby-1.9.3-p0/gems/devise-\n2.1.2/app/views\"\n</code></pre>\n\n<p>I have a feeling this is to do with my routing. Here is routes.rb</p>\n\n<pre><code>appname::Application.routes.draw do\n\nroot :to =&gt; 'locations#index'\n\ndevise_for :users\n\n\nresources :locations do\n   collection do\n   get 'location'\n  end\nend\n\nmount Blogit::Engine =&gt; \"/blog\", :as =&gt; \"blog\" \n\nend\n</code></pre>\n\n<p>Here is the posts controller:</p>\n\n<pre><code>module Blogit\n\nclass PostsController &lt; ApplicationController\n\nunless blogit_conf.include_admin_actions\n  before_filter :raise_404, except: [:index, :show, :tagged]\nend\n\nblogit_authenticate(except: [:index, :show, :tagged])\n\nblogit_cacher(:index, :show, :tagged)\nblogit_sweeper(:create, :update, :destroy)\n\ndef index\n  respond_to do |format|\n    format.xml {\n      @posts = Post.order('created_at DESC')\n    }\n    format.html {\n      @posts = Post.for_index(params[:page])\n    }\n    format.rss {\n      @posts = Post.order('created_at DESC')\n    }\n  end\nend\n\ndef show\n  @post    = Post.find(params[:id])\n  @comment = @post.comments.new\nend\n\ndef tagged\n  @posts = Post.for_index(params[:page]).tagged_with(params[:tag])\n  render :index\nend\n\ndef location\n  @georesult = Geocoder.search(params[:location])\n\n respond_to do |format|\n  format.html {render :layout=&gt;false}# venues.html.erb\n end\nend\n\ndef new\n  @post = current_blogger.blog_posts.new(params[:post])\n  @location = @post.locations.build\nend\n\ndef edit\n  @post = current_blogger.blog_posts.find(params[:id])\n  @location = @post.locations.new\nend\n\ndef create\n  @post = current_blogger.blog_posts.new(params[:post])\n\nrespond_to do |format|\n  if @post.save\n    format.html { redirect_to @post, :method =&gt; :get, notice: 'Blog post was successfully created.' }\n    format.json { render json: @post, status: :created, location: @post }\n  else\n    format.html { render action: \"new\" }\n    format.json { render json: @post.errors, status: :unprocessable_entity }\n  end\nend\n\n\n\nend\n\ndef update\n  @post = current_blogger.blog_posts.find(params[:id])\n  if @post.update_attributes(params[:post])\n    redirect_to @post, notice: 'Blog post was successfully updated.'\n  else\n    render action: \"edit\"\n  end\nend\n\ndef destroy\n  @post = current_blogger.blog_posts.find(params[:id])\n  @post.destroy\n  redirect_to posts_url, notice: \"Blog post was successfully destroyed.\"\nend\n\nprivate\n\ndef raise_404\n  # Don't include admin actions if include_admin_actions is false\n  render file: \"#{Rails.root}/public/404.html\", status: :not_found, layout: false\nend\n\nend\n\nend\n</code></pre>\n\n<p>All I've changed from the source so far is, I've basically created a multipart form which allows searches for locations and submits them to a locations table in the same post action. Not sure if this has anything to do with it. I can post up all this code but it's pretty lengthy. Let me know if you think this would be useful too.</p>\n\n<p>Thanks a lot for all your help! Frankly, I'm stumped.</p>\n\n<p>James</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","grails-controller","respond-with"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12665220,"title":"rails respond_with associated record","body":"<p>for example, there's a <code>Question</code> model that <code>has_many :answers</code></p>\n\n<p>I'd like to show a form for new answer on the <code>questions#show</code> ( just like stackoverflow does )</p>\n\n<p>routes would be something like:</p>\n\n<pre><code>resources :questions do\n  resources :answers\nend\n</code></pre>\n\n<p>What is the best way to show the errors for an invalid record under these circumstances?</p>\n\n<p>The problem is that I can't <code>render</code> an action I need from within <code>AnswersController</code> ( since it would be <code>questions#show</code> ), the only way seem to be <code>redirect_to</code> and store errors in <code>flash</code> hash.</p>\n\n<p>It just looks like a pretty much common scenario, I believe there should be some better way</p>\n"},{"tags":["ruby-on-rails","namespaces","ruby-on-rails-3","authlogic"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":554,"score":2,"question_id":3866404,"title":"Authlogic, Namespace and private methods in ApplicationController","body":"<p>I am troubleshooting why my ApplicationController's methods don't seem to work in my namespaced admin area and it seems like when I'm in a namespace I cannot access my ApplicationController's private methods, is this right?</p>\n\n<p>If it is like that, what's the best practise to reuse something like Authlogic's example ApplicationController methods in my namespaced controller? I could easily copy and paste the methods to an AdminController or something, and I could also un-private these methods - but this doesn't seem like such a good way to do it.</p>\n\n<p>Here's what the example ApplicationController from Authlogic (and mine) looks like:</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  protect_from_forgery\n\n  helper_method :current_user_session, :current_user\n\n  private\n    def current_user_session\n      return @current_user_session if defined?(@current_user_session)\n      @current_user_session = UserSession.find\n    end\n\n    def current_user\n      return @current_user if defined?(@current_user)\n      @current_user = current_user_session &amp;&amp; current_user_session.user\n    end  \n\n    def require_user\n      unless current_user\n        store_location\n        flash[:notice] = \"You must be logged in to access this page\"\n        redirect_to new_user_session_url\n        return false\n      end\n    end\n\n    # and some more methods here...\n\nend\n</code></pre>\n\n<p>And that's how I inherit from it in my namespace:</p>\n\n<pre><code>class Admin::DashboardController &lt; ApplicationController\n  layout 'administration'\n\n  require_user # fails\n\n  def index\n  end\n\nend\n</code></pre>\n\n<p>Thanks for your help,</p>\n\n<p>Arne</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","date"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12884196,"title":"rails db won't save string as date with m/d/y format?","body":"<p>saving a string to my db as a date and having some strange results </p>\n\n<p>if the date is formatted like, </p>\n\n<p>dd/mm/yy it will save</p>\n\n<p>if date is formatted like, </p>\n\n<p>mm/dd/yy it will fail to save silently</p>\n\n<p>in my console if i go </p>\n\n<pre><code>'20/10/2012'.to_date \n =&gt; Sat, 20 Oct 2012 \n</code></pre>\n\n<p>it works</p>\n\n<p>if i go</p>\n\n<pre><code>'10/20/2012'.to_date\n=&gt; ArgumentError: invalid date ...\n</code></pre>\n\n<p>it breaks</p>\n\n<p>i used an initializer to set up my default date format to %m/%d/%Y which you can see is accurately reflected in my DATE_FORMATS hash.</p>\n\n<pre><code>Date::DATE_FORMATS\n=&gt; {:short=&gt;\"%e %b\", :long=&gt;\"%B %e, %Y\", :db=&gt;\"%Y-%m-%d\", :number=&gt;\"%Y%m%d\", :long_ordinal=&gt;#&lt;Proc:0x007f8663f1aae0@/Users/ian/.rvm/gems/ruby-1.9.3-p0@rails-3.2/gems/activesupport-3.2.1/lib/active_support/core_ext/date/conversions.rb:12 (lambda)&gt;, :rfc822=&gt;\"%e %b %Y\", :default=&gt;\"%m/%d/%Y\"}\n</code></pre>\n\n<p>Uncertain what is the cause of the issue here, as things seem to be configured correctly. How to resolve?</p>\n\n<p>thank you!</p>\n"},{"tags":["html","ruby-on-rails-3","html5","layout","twitter-bootstrap"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12883527,"title":"Why is the display of labels and data not aligned using twitter bootstrap 2 if the content of a <dd> element is blank?","body":"<p>I am seeing unexpected behavior with the description list <code>&lt;dl&gt;</code> tag.</p>\n\n<p>I am using twitter bootstrap 2 and with this example code:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;dl class=\"dl-horizontal\"&gt;\n  &lt;dt&gt;Item1&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item1&lt;/dd&gt;\n  &lt;dt&gt;Item2&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item2&lt;/dd&gt;\n  &lt;dt&gt;Item3&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item3&lt;/dd&gt;\n  &lt;dt&gt;Item4&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item4&lt;/dd&gt;\n  &lt;dt&gt;Item5&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item5&lt;/dd&gt;\n&lt;/dl&gt;\n</code></pre>\n\n<p>... all works as expected and I see this:</p>\n\n<pre><code>Item1 This is a description of Item1  \nItem2 This is a description of Item2  \nItem3 This is a description of Item3  \nItem4 This is a description of Item4  \nItem5 This is a description of Item5  \n</code></pre>\n\n<p>With this code though:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;dl class=\"dl-horizontal\"&gt;\n  &lt;dt&gt;Item1&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item1&lt;/dd&gt;\n  &lt;dt&gt;Item2&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;&lt;/dd&gt;\n  &lt;dt&gt;Item3&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item3&lt;/dd&gt;\n  &lt;dt&gt;Item4&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item4&lt;/dd&gt;\n  &lt;dt&gt;Item5&lt;/strong&gt;&lt;/dt&gt;&lt;dd&gt;This is a description of Item5&lt;/dd&gt;\n&lt;/dl&gt;\n</code></pre>\n\n<p>I see this problematic display:</p>\n\n<pre><code>Item1 This is a description of Item1\nItem2 This is a description of Item3\nItem3 This is a description of Item4\nItem4 This is a description of Item5 \nItem5 \n</code></pre>\n\n<p>And the <code>&lt;dt&gt;</code> and <code>&lt;dd&gt;</code> tags do not match-up as expected.</p>\n\n<p>Reading the w3.org working draft here <a href=\"http://www.w3.org/TR/html-markup/dl.html#dl\" rel=\"nofollow\">http://www.w3.org/TR/html-markup/dl.html#dl</a></p>\n\n<p>... it's not clear to me if the browser or the programmer are responsible for matching up the <code>&lt;dt&gt;</code> and <code>&lt;dd&gt;</code> elements when the content for <code>&lt;dd&gt;</code> is blank.</p>\n\n<p>I tested the above code in firefox and Safari and see the same output.</p>\n\n<p>Is this a matter of opinion, a bug in twitter bootstrap 2, or am I misunderstanding the use of the HTML5 description list?  This use of <code>&lt;dl&gt;</code> appears in show.html.erb code auto generated by </p>\n\n<p><code>rake g bootstrap:themed model</code>  </p>\n\n<p>If a data element is blank, the displayed output does not match the label.  It's unfortunate, because the themed option is pretty useful otherwise.</p>\n\n<p>I can partially 'fix the problem' by modifying the themed output to look like this:</p>\n\n<pre><code>&lt;dt&gt;&lt;strong&gt;&lt;%= model_class.human_attribute_name(:name) %&gt;:&lt;/strong&gt;&lt;/dt&gt;\n&lt;dd&gt;&lt;%= @server.name %&gt; &lt;%= \"-blank-\" if @server.name.blank? %&gt; &lt;/dd&gt;\n</code></pre>\n\n<p>... but I am left seeing \"-blank-\" to display the blank elements.  If I use something like a string containing a space, like \" \", I still see the same label-description misalignment problem.</p>\n\n<p>Please try to focus your answer on describing which entity, the HTML5 <code>&lt;dl&gt;</code> tag, bootstrap, or my understanding, is off target here and why.</p>\n\n<p>Thanks very much!</p>\n\n<p>-EDIT-\nFor those working with bootstrap, using css like this works fine:</p>\n\n<pre><code>dt, dd {\n  line-height: 20px;\n  /* Keep this the same as line-height */\n  min-height: 20px;\n }\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails-3","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12879735,"title":"rails form dynamic field selector","body":"<p>I'm using nested_form in rails 3 and i have a dynamic field which the user can add or remove.</p>\n\n<p>I need to know the jquery selector for those fields so i can do some javascript calculation between the fields, currently the dynamic field has a the current datetime set as a field, how do people normally handle dynamic field validations?</p>\n\n<pre><code>&lt;%= nested_form_for [@project, @quote], :html =&gt; {:class =&gt;'form-inline'} do |f| %&gt;\n&lt;div&gt;\n  &lt;%= f.hidden_field :project_id %&gt;\n  &lt;%= f.label :name %&gt;\n  &lt;%= f.text_field :name %&gt;\n  &lt;%= f.label :status %&gt;\n  &lt;%= f.text_field :status %&gt;\n&lt;/div&gt;\n  &lt;p&gt;\n    &lt;h4&gt; Labour Items &lt;/h4&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\n    &lt;%= f.fields_for :labouritems, :html =&gt; { :class =&gt; 'form-vertical' } do |builder| %&gt;\n\n    &lt;%= builder.label :description %&gt;\n    &lt;%= builder.text_field :description, :class =&gt; \"input-medium\" %&gt;\n    &lt;%= builder.label :hours %&gt;\n    &lt;%= builder.text_field :hours, :class =&gt; \"input-mini\" %&gt;\n    &lt;%= builder.label :total %&gt;\n    &lt;%= builder.text_field :total, :class =&gt; \"input-mini\" %&gt;\n    &lt;%= builder.label \"Mup/Hr\" %&gt;\n    &lt;%= builder.text_field :muphourrate, :class =&gt; \"input-mini\" %&gt;\n      &lt;%= builder.label \"Mup/Total\" %&gt;\n    &lt;%= builder.text_field :muptotal, :class =&gt; \"input-mini\" %&gt;\n    &lt;%= builder.label \"Mup/%\" %&gt;\n    &lt;%= builder.text_field :muppercent, :class =&gt; \"input-mini\" %&gt;\n    &lt;%= builder.label \"Contractor\" %&gt;\n\n    &lt;%= builder.autocomplete_field :contractor_name, autocomplete_contractor_firstname_contractors_path, :update_elements =&gt; {:id =&gt; \"##{form_tag_id(builder.object_name, :contractor_id)}\" , :hourly_rate =&gt; \"##{form_tag_id(builder.object_name, :contractor_rate)}\"   },:class =&gt; \"input-small\",:placeholder =&gt; \"Seach\" %&gt;\n    &lt;%= builder.hidden_field :contractor_id  %&gt;\n    &lt;%= builder.label \"Rate/hr\"  %&gt;\n    &lt;%= builder.text_field :contractor_rate,:class =&gt; \"input-mini\" %&gt;\n    &lt;%= builder.label \"Work %\" %&gt;\n    &lt;%= builder.text_field :progress_percent, :class =&gt; \"input-mini\" %&gt;\n    &lt;%= builder.label \"Work $\" %&gt;\n    &lt;%= builder.text_field :progress_payment, :class =&gt; \"input-mini\" %&gt;\n\n    &lt;%= builder.link_to_remove \"Delete\",:class =&gt; 'btn btn-small btn-danger'   %&gt;\n\n  &lt;% end %&gt;\n\n  &lt;%= f.link_to_add \"Add Item\", :labouritems, :class =&gt; 'btn btn-small btn-primary' %&gt;\n&lt;/p&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rspec","rspec-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12878985,"title":"RSpec - Do I need to keep non-request specs?","body":"<p>I have generated a few controllers and models to my app and now I want to add testing (I know it's a little backwards but at least I am starting fairly early in my project).  Anyway, every time I generated a controller/model I did not include the --no-test-framework so now I have a bunch of specs related to controllers, helpers, models, and views.  Do I need these?  And, if not, is it okay to just delete them?  I am noticing from some tutorials (Hartl, Bates) that they are using request specs, are these all I need?</p>\n\n<p>Thanks!</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","webrick"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":7039,"score":5,"question_id":4455359,"title":"Starting a rails server in Rails 3","body":"<p>I have created a new rails project with the command:</p>\n\n<pre><code>rails project_name\n</code></pre>\n\n<p>but now in that project if I run:</p>\n\n<pre><code>rails server\n</code></pre>\n\n<p>I just creates a new project call server, it doesn't start webrick.</p>\n\n<p>How do I start the server and get rails running?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12882381,"title":"Rails: find with constraints on polymorphic association","body":"<p>Two models:</p>\n\n<pre><code>User has_one :location, as: locatable\nLocation belongs_to :locatable, polymorphic: true\n</code></pre>\n\n<p>So far so good. Now say I want to find a User with a certain name and city:</p>\n\n<pre><code>User.joins(:location).where(name: 'Eddie Explosion', location: { city: 'Kaboom' })\n</code></pre>\n\n<p>...but when I run that, boom, </p>\n\n<blockquote>\n  <p>ActiveRecord::StatementInvalid: PG::Error: ERROR:  missing FROM-clause entry for table \"location\".</p>\n</blockquote>\n\n<p>Any idea what's going on here / how to fix this? Can't seem to figure it out.</p>\n"},{"tags":["ruby-on-rails-3","postgresql","postgresql-9.1"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12879248,"title":"postgresql version won't change from default","body":"<p>mac os x lion 10.7.4</p>\n\n<p>psql --version -> psql (PostgreSQL) 9.0.5</p>\n\n<p>I want to install latest version and run my rails app with it. </p>\n\n<p>I do </p>\n\n<pre><code>brew install postgresql\n\nit is installed here: /usr/local/Cellar/postgresql/9.1.4  \n\ninitdb /usr/local/var/postgres\n\npg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start\n</code></pre>\n\n<p>I get: </p>\n\n<pre><code>pg_ctl: another server might be running; trying to start server anyway\n</code></pre>\n\n<p>running postgres --version </p>\n\n<pre><code> -&gt; 9.1.4\n</code></pre>\n\n<p>postgres -p 5433</p>\n\n<pre><code> postgres does not know where to find the server configuration file.\n You must specify the --config-file or -D invocation option or set the PGDATA environment variable.\n</code></pre>\n"},{"tags":["ruby-on-rails-3","query","activerecord","active-relation"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":277,"score":0,"question_id":10042270,"title":"Rails 3 query in multiple date ranges","body":"<p>Suppose we have some date ranges, for example:</p>\n\n<pre><code>ranges = [\n          [(12.months.ago)..(8.months.ago)],\n          [(7.months.ago)..(6.months.ago)],\n          [(5.months.ago)..(4.months.ago)],\n          [(3.months.ago)..(2.months.ago)],\n          [(1.month.ago)..(15.days.ago)]\n         ]\n</code></pre>\n\n<p>and a <code>Post</code> model with <code>:created_at</code> attribute.</p>\n\n<p>I want to find posts where <code>created_at</code> value is in this range, so the goal is to create a query like:</p>\n\n<pre><code>SELECT * FROM posts WHERE created_at \n    BETWEEN '2011-04-06' AND '2011-08-06' OR\n    BETWEEN '2011-09-06' AND '2011-10-06' OR\n    BETWEEN '2011-11-06' AND '2011-12-06' OR\n    BETWEEN '2012-01-06' AND '2012-02-06' OR\n    BETWEEN '2012-02-06' AND '2012-03-23';\n</code></pre>\n\n<p>If you have only one range like this:</p>\n\n<pre><code>range = (12.months.ago)..(8.months.ago)\n</code></pre>\n\n<p>we can do this query:</p>\n\n<pre><code>Post.where(:created_at =&gt; range)\n</code></pre>\n\n<p>and query should be:</p>\n\n<pre><code>SELECT * FROM posts WHERE created_at \n    BETWEEN '2011-04-06' AND '2011-08-06';\n</code></pre>\n\n<p>Is there a way to make this query using a notation like this <code>Post.where(:created_at =&gt; range)</code>?</p>\n\n<p>And what is the <em>correct</em> way to build this query?</p>\n\n<p>Thank you</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12881485,"title":"Devise, can't use custom controller action","body":"<p>I followed the instructions given on <a href=\"https://github.com/plataformatec/devise\" rel=\"nofollow\">devise page</a>. Only thing different is that I am customizing registrations and their example is on sessions.</p>\n\n<p>When I hit <code>/users/sign_up</code> page, devise is using <code>Devise::RegistrationsController#new</code> action instead of <code>new</code> action from <code>users_controller.rb</code></p>\n\n<p>As you can see from the server log below, <code>XXXXXXXXXX\\nxxxxxxxxxxx</code> is not seen, even though user controller has <code>new</code> action that <code>puts \"XXXXXXXXXX\\nxxxxxxxxxxx\"</code></p>\n\n<pre><code>Started GET \"/users/sign_up\" for 127.0.0.1 at 2012-10-14 03:29:52 -0700\nProcessing by Devise::RegistrationsController#new as HTML\n  Rendered /Users/jasonkim/.rvm/gems/ruby-1.9.3-p0/gems/devise-2.1.2/app/views/devise/shared/_links.erb (0.4ms)\n  Rendered users/registrations/new.html.haml within layouts/application (4.8ms)\nCompleted 200 OK in 88ms (Views: 12.3ms | ActiveRecord: 0.7ms)\n</code></pre>\n\n\n\n<h2>users_controller.rb</h2>\n\n<pre><code>class Users::RegistrationsController &lt; Devise::RegistrationsController\n  def new\n    @user = User.new\n    address = @user.address.build\n    puts \"XXXXXXXXXX\\nxxxxxxxxxxx\"\n  end\nend\n</code></pre>\n\n<h2>routes.rb</h2>\n\n<pre><code>devise_for :users, :controllers =&gt; { :registration =&gt; \"users/registration\" }\ndevise_for :employers\n</code></pre>\n\n<h2>only thing i added in devise.rb</h2>\n\n<pre><code>config.scoped_views = true\n</code></pre>\n\n<p>What am I missing?</p>\n"},{"tags":["jquery","ruby-on-rails-3","rest","jquery-ajax","http-post"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":124,"score":-1,"question_id":12880882,"title":"Cross domain json POST rails 3 rest service","body":"<p>How can i make a cross domain POST call for a rails 3 rest service.</p>\n\n<p>I have read a lot about jsonp but its only for GET method. Are there any other way to do it on rails 3. Can anybody provide me with the exact steps to make a cross domain json POST call to rails rest service.</p>\n\n<p>I want to make a POST call through ajax jquery to rails server side rest service. </p>\n\n<p>I tried using JSONP but it didn't work for me</p>\n"}]}
{"total":34675,"page":20,"pagesize":100,"questions":[{"tags":["ruby-on-rails","ruby-on-rails-3","git","gitignore"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":135,"score":0,"question_id":12878794,"title":"Ignoring .gitignore","body":"<p>My brother and I are collaborating on an app from two different computers -- one mac and one pc. I can't for the life of me get Postgres to work on his computer, and after a whole bunch of hours, I decided to just have his computer run sqlite3 for development (which is easy as pie), and basically have all the production stuff happen on my mac, while still allowing him to make functional changes from his pc. And merge them to github.</p>\n\n<p>The trouble is, this involves having two different database.yml files, two different db/schema.rb files (I think), and different gemfiles, one with sqlite and the other with pg. </p>\n\n<p>My thought was just to do all that on his computer and add those files to the  gitignore file. But if THAT isn't ignored, then when I pull back to my mac, won't I be merging his incorrect configurations to my machine? </p>\n\n<p>At any rate, that's why I was thinking of adding .gitignore to .gitignore. Will this work? Will it create universe-bending paradoxes? Is there a better way to do this that I don't know about?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.1","wkhtmltopdf"],"answer_count":1,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":343,"score":1,"question_id":11167427,"title":"ruby on rails (wkhtmltopdf header footer issue)","body":"<p>In local environment pdf with header footer generated successfully. but in hosting linux server environment pdf generated without header and footer.Below is my wkhtmltopdf (WickedPdf) config</p>\n\n<pre><code>WickedPdf.config = {\n    #:wkhtmltopdf =&gt; \"#{RAILS_ROOT}/pdfbin/wkhtmltopdf-amd64\",\n    :exe_path =&gt; \"/home/software/.gems/bin/wkhtmltopdf\",\n    :layout =&gt; \"layouts/pdf.html.erb\",\n    :margin =&gt; {    :top=&gt; 40,\n                    :bottom =&gt; 20,\n                    :left=&gt; 30,\n                    :right =&gt; 30},\n    :header =&gt; {:html =&gt; { :template=&gt; 'layouts/pdf_header.html.erb'}},\n    :footer =&gt; {:html =&gt; { :template=&gt; 'layouts/pdf_footer.html.erb'}}\n    #:exe_path =&gt; '/usr/bin/wkhtmltopdf'\n}\n</code></pre>\n\n<p><strong>for additional info :</strong></p>\n\n<p>this is my dir structure i am on linux rails hosting app\\views\\layouts , inside layouts i am having pdf.html.erb , pdf_footer.html.erb , pdf_header.html.erb \nThe above stuff works perfectly on my local windows development environment , but in production pdf generated without headers and footers.so guys please help me to produce pdf with headers and footers</p>\n\n<p><strong>app/views/layouts/pdf.html.erb</strong></p>\n\n<pre><code>&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\n  \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n&lt;html dir=\"&lt;%= (rtl?) ? 'rtl' : 'ltr' %&gt;\"&gt;\n  &lt;head&gt;\n    &lt;% @direction = (rtl?) ? 'rtl/' : '' %&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/&gt; \n    &lt;%= stylesheet_link_tag([@direction+'application', @direction+'_styles/ui.all'])%&gt;\n    &lt;%= stylesheet_link_tag(*get_stylesheets) %&gt;\n    &lt;%= stylesheet_link_tag  @direction+\"_layouts/pdf\" %&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"&lt;%=\"#{RAILS_ROOT}/public/stylesheets/#{@direction}_layouts/pdf.css\" %&gt;\" media=\"all\" /&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"&lt;%=\"#{RAILS_ROOT}/public/stylesheets/#{get_stylesheets}.css\"%&gt;\" media=\"all\" /&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"&lt;%= \"#{RAILS_ROOT}/public/stylesheets/#{@direction}_styles/ui.all.css\"%&gt;\" media=\"all\" /&gt;\n\n\n  &lt;/head&gt;\n  &lt;body&gt;\n\n    &lt;%= yield %&gt;\n\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>app/views/layouts/pdf_header.html.erb</strong></p>\n\n<pre><code>&lt;div id=\"pdf-header\"&gt;\n      &lt;div class=\"logo\"&gt;\n        &lt;% if FileTest.exists?(\"#{RAILS_ROOT}/public/uploads/image/institute_logo.jpg\") %&gt;\n            &lt;%= image_tag  \"#{request.protocol}#{request.host_with_port}/uploads/image/institute_logo.jpg\" ,:width =&gt; \"90\",  :height=&gt;\"85\" %&gt;\n          &lt;% else %&gt;\n\n          &lt;div class=\"fed_logo\"&gt;\n            &lt;%= image_tag  \"#{request.protocol}#{request.host_with_port}/images/application/app_fedena_logo.jpg\" ,:width =&gt; \"90\",  :height=&gt;\"85\" %&gt;\n    &lt;/div&gt;\n          &lt;% end %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"header-content\"&gt;\n        &lt;p&gt;&lt;%=Configuration.get_config_value('InstitutionName'); %&gt;&lt;/p&gt;\n        &lt;p&gt;&lt;%=Configuration.get_config_value('InstitutionAddress'); %&gt;&lt;/p&gt;\n      &lt;/div&gt;\n\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>app/views/layouts/pdf_footer.html.erb</strong></p>\n\n<pre><code>&lt;div id=\"pdf-footer\"&gt;\n  &lt;%= t('signature') %&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>Note*</strong> The above codes working perfectly on my windows development environment (ie) PDF generated properly with header and footers. <strong>But when i hosted my application in linux production server PDF generated without headers and footers.*</strong></p>\n\n<hr>\n\n<h2>Resolved Header Footer Issue , the above is the working code. The above problem is due to my files don't have enough executable permissions in production Linux environment.</h2>\n\n<hr>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":3,"down_vote_count":0,"view_count":83,"score":3,"question_id":12880066,"title":"Rails: Keeping count of users unread notifications","body":"<p>I currently have an activity model that handles a user activity notification system. An activity observer creates a new activity when some action happens (such as a new article being created). Now I want to keep a record of how many of these activity notifications the current user has not seen (similar to the notification jewel on facebook). Every time the user clicks on their notifications link the number should reset to 0 and every notification created should increase the count by 1. Where would I store this data for each user? Would using a session work or is something else better?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":50,"score":2,"question_id":12878765,"title":"CSS in Rails 3.0","body":"<p>I'm using Rails 3.0. How I can include a CSS that I put in <code>/public/stylesheets</code> into a View file in <code>/app/views/posts</code>?</p>\n"},{"tags":["ruby-on-rails-3","localization","gem","translation"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12879799,"title":"how to speed up fixing translation in rails 3 application?","body":"<p>I have a Rails 3 application, it contains absolute text in its views\n<code>&lt;p&gt;this is what i mean with absolute text&lt;/p&gt;</code> </p>\n\n<p>I have to change this to be <code>&lt;p&gt;&lt;%= t(:translation_of_absolute_text) %&gt;&lt;p&gt;</code>\n. I also have to go through the localization file to update it with the new entry!</p>\n\n<p>This is a very long process. I'm looking for a gem that can make it easier.</p>\n\n<p>Thanks!</p>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","forms","styles"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":87,"score":1,"question_id":12878918,"title":"User's Personal CSS Stylesheet in Ruby on Rails","body":"<p>I have looked around but I can't find a lead on what I need to do to make the following possible:</p>\n\n<p>This question assumes I have all model controllers working properly and the named CSS attributes are defined in the default stylesheet.</p>\n\n<p>I am wanting users to be able to  select a few CSS attributes to personalize their own theme when they login.  The basics attributes would be the \"body\" and \"page-wrapper\" colour. (foreground)</p>\n\n<p>I am wanting them to be able to select these attributes (from a form?) in the user's edit page.  (which is already created)</p>\n\n<p>Any ideas as to how I could make this work or a good lead in the right direction?</p>\n\n<p>Thanks for your help.</p>\n"},{"tags":["facebook","ruby-on-rails-3","omniauth"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":970,"score":1,"question_id":5562119,"title":"Facebook Application Setting: Site URL Without Trailing slash","body":"<p>Is it possible in a Facebook application to set the Site URL to a value <em>without</em> a trailing slash? Facebook appears to be doing everything in it's power to ensure Site URL has a trailing slash.</p>\n\n<p>I'm asking because I'm using OmniAuth in a Rails 3 application always strips trailing slashes from the redirect_uri parameter. Thus giving me a \"Invalid redirect_uri: Given URL is not allowed by the Application configuration.\" error.</p>\n"},{"tags":["ruby-on-rails-3","merge","sunspot","sunspot-rails"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":37,"score":0,"question_id":12879487,"title":"how to merge two or more columns in sunspot solr","body":"<p>I have four models. That is brands, departments, categories and product_details. brands table contains id, name. departments contains id, name. categories contains id and name. product_details contains name, price, image_url, discount, brand_id, department id and category_id. </p>\n\n<p>brand.rb</p>\n\n<pre><code>class Brand &lt; ActiveRecord::Base\n  has_many :product_details, :dependent=&gt;:destroy\nend\n</code></pre>\n\n<p>department.rb</p>\n\n<pre><code>class Brand &lt; ActiveRecord::Base\n  has_many :product_details, :dependent=&gt;:destroy\nend\n</code></pre>\n\n<p>category.rb</p>\n\n<pre><code>class Category &lt; ActiveRecord::Base\n  has_many :product_details, :dependent=&gt;:destroy\nend\n</code></pre>\n\n<p>product_detail.rb</p>\n\n<pre><code>class ProductDetail &lt; ActiveRecord::Base\n  set_primary_key :id\n  belongs_to :department\n  belongs_to :category\n  belongs_to :brand\n  searchable do\n    text :name\n    text :brand do\n      brand.name\n    end\n    integer :department_id\n    integer :category_id\n    integer :brand_id\n    string :department_id_str do\n      department_id.to_s\n    end\n    string :category_id_str do\n      category_id.to_s\n    end\n    string :brand_id_str do\n      brand_id.to_s\n    end\n  end\nend\n</code></pre>\n\n<p>I want to get details from product_details table for all combinations of brand_id, department_id and category_id but only once. I tried to do this using sunspot group by method, below I have given the code for what I tried. But am not getting the expected output. </p>\n\n<p>product_details_controller.rb</p>\n\n<pre><code>def index\n    @idproducts=ProductDetail.search do\n        group :category_id_str, :brand_id_str, :department_id_str\n    end\nend\n</code></pre>\n\n<p>In product_details/index.html.erb</p>\n\n<pre><code>&lt;% @idproducts.group(:category_id_str,:brand_id_str,:department_id_str).groups.each do |group| %&gt;\n    &lt;% group.results.each do |result| %&gt;\n        &lt;%= debug(result)%&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>For the above code am getting wrong number of arguments (3 for 1) error</p>\n\n<pre><code>&lt;% @idproducts.group([:category_id_str,:brand_id_str,:department_id_str]).groups.each do |group| %&gt;\n    &lt;% group.results.each do |result| %&gt;\n        &lt;%= debug(result)%&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt; \n</code></pre>\n\n<p>Please anybody help me solve this issue or suggest me any other approach to do this.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":70,"score":2,"question_id":12878703,"title":"Rails: Generated URL has double backslash","body":"<p>In my Rails project, in my <code>index</code> view, I have a link</p>\n\n<pre><code>&lt;%= link_to 'Show all posts', show_all_path %&gt;\n</code></pre>\n\n<p>In <code>routes.rb</code>, I have a route:</p>\n\n<pre><code>match \"show_all\" =&gt; \"Posts#show_all\"\n</code></pre>\n\n<p>When I click on that link, it goes from</p>\n\n<pre><code>http://&lt;domain name&gt;/my_rails_project\n</code></pre>\n\n<p>to</p>\n\n<pre><code>http://&lt;domain name&gt;/my_rails_project//show_all\n</code></pre>\n\n<p>It works fine, but I'm wondering why there are two backslashes in front of <code>show_all</code> instead of one. And can I make it so that only one backslash appear?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12066129,"title":"$ rails server... undefined method `gem' for main:Object (NoMethodError)","body":"<p>I'm new to Rails trying to complete this tutorial, but I can;t even get started.\n<a href=\"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-rails_server\" rel=\"nofollow\">http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-rails_server</a></p>\n\n<p>I am at Step 1.2.5</p>\n\n<p>I am supposed to start the server using: $ rails server</p>\n\n<p>I'm getting this error whenever I try to run any rails command.</p>\n\n<pre><code>localhost:first_app home$ rails server\n/usr/bin/rails:22: undefined method `gem' for main:Object (NoMethodError)\n</code></pre>\n\n<p>Running rails commands used to work, because I had completed other tutorials from other books in the past. However, somewhere along the steps in this tutorial something was messed up.</p>\n\n<p>Is it possible that editing my bash_profile caused this?</p>\n\n<p>My bash_profile looks like this now:</p>\n\n<pre><code>export PATH=/bin:/usr/bin:\"$PATH\"\n[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\"  # This loads RVM into a shell session. \n</code></pre>\n\n<p>I added this line to it: <strong>export PATH=/bin:/usr/bin:\"$PATH\"</strong> after following directions in step <strong>Listing 1.1. Creating a gem configuration file.</strong></p>\n\n<p>I'm not sure if this helps, but If I type:</p>\n\n<pre><code>$ which rails\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>/Users/home/.rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/rails\n</code></pre>\n"},{"tags":["ruby-on-rails-3","mvc","rails-routing","railstutorial.org"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":57,"score":1,"question_id":12878821,"title":"Extending ROR Tutorial: Microposts with their own page","body":"<p>I'm extending the functionality in Michael Hartl's ROR Tutorial, and I am trying to create individual pages for microposts. My question is very similar to <a href=\"http://stackoverflow.com/questions/10859118/ruby-on-rails-app-tutorial-cant-display-micropost-page\">this question</a>, but the answers to that question did not work for me.</p>\n\n<p>In the feed, when a title of a post is clicked I want it to go to a page for that post. For starters, every single post title links to the same URL: <strong>http://localhost:3000/microposts</strong> where I get a <strong>No route matches [GET] \"/microposts\"</strong> message.  I know something is missing that would make the link unique and take it to the the individual post. </p>\n\n<p>This is my <strong>_feed_item.html.erb:</strong></p>\n\n<pre><code>&lt;li id=\"&lt;%= feed_item.id %&gt;\"&gt;\n  &lt;%= link_to gravatar_for(feed_item.user), feed_item.user %&gt;\n  &lt;span class=\"title\"&gt;&lt;strong&gt;&lt;%= link_to feed_item.title, @micropost %&gt;&lt;/strong&gt;&lt;/span&gt;&lt;br&gt;\n    &lt;span class=\"user\"&gt;\n      &lt;p&gt;&lt;small&gt;Created by: &lt;%= link_to feed_item.user.name, feed_item.user %&gt;&lt;br&gt;\n        &lt;%= feed_item.loc1T %&gt;&lt;br&gt;\n         &lt;%= feed_item.startTime.strftime('%A, %B %d, %Y') %&gt;&lt;/small&gt;&lt;/p&gt;\n    &lt;/span&gt;\n    &lt;span class=\"content\"&gt;&lt;%= feed_item.content %&gt;&lt;/span&gt;\n    &lt;span class=\"timestamp\"&gt;\n      Posted &lt;%= time_ago_in_words(feed_item.created_at) %&gt; ago.\n    &lt;/span&gt;\n  &lt;% if current_user?(feed_item.user) %&gt;\n    &lt;%= link_to \"delete\", feed_item, method: :delete,\n                                     data: { confirm: \"Are you sure?\" },\n                                     title: feed_item.content %&gt;\n  &lt;% end %&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>I added \"<code>:show</code>\" to <code>resources :microposts, only: [:create, :destroy, :show]</code></p>\n\n<p>This is my <strong>config/routes.rb:</strong></p>\n\n<pre><code>SampleApp::Application.routes.draw do\n  resources :users do\n    member do\n      get :following, :followers\n    end\n  end\n  resources :sessions, only: [:new, :create, :destroy]\n  resources :microposts, only: [:create, :destroy, :show]\n  resources :relationships, only: [:create, :destroy]\n\n  root to: 'static_pages#home'\n\n  match '/signup',  to: 'users#new'\n  match '/signin',  to: 'sessions#new'\n  match '/signout', to: 'sessions#destroy', via: :delete\n\n  match '/help',    to: 'static_pages#help'\n  match '/about',   to: 'static_pages#about'\n  match '/contact', to: 'static_pages#contact'\n</code></pre>\n\n<p>I added </p>\n\n<pre><code>def index\n      end\n</code></pre>\n\n<p>to my <strong>microposts_controller.rb:</strong></p>\n\n<pre><code>class MicropostsController &lt; ApplicationController\n  before_filter :signed_in_user, only: [:create, :destroy]\n  before_filter :correct_user,   only: :destroy\n\n  def index\n  end\n\n  def create\n    @micropost = current_user.microposts.build(params[:micropost])\n    if @micropost.save\n      flash[:success] = \"Micropost created!\"\n      redirect_to root_url\n    else\n      @feed_items = []\n      render 'static_pages/home'\n    end\n  end\n\n  def destroy\n    @micropost.destroy\n    redirect_to root_url\n  end\n\n  private\n\n    def correct_user\n      @micropost = current_user.microposts.find_by_id(params[:id])\n      redirect_to root_url if @micropost.nil?\n    end\nend\n</code></pre>\n\n<p><strong>$ rake routes</strong> regarding microposts looks like this:</p>\n\n<pre><code>    microposts POST   /microposts(.:format)          microposts#create\n     micropost DELETE /microposts/:id(.:format)      microposts#destroy\n               DELETE /relationships/:id(.:format)   relationships#destroy\n               GET    /microposts(.:format)          microposts#index\n               POST   /microposts(.:format)          microposts#create\n new_micropost GET    /microposts/new(.:format)      microposts#new\nedit_micropost GET    /microposts/:id/edit(.:format) microposts#edit\n               GET    /microposts/:id(.:format)      microposts#show\n               PUT    /microposts/:id(.:format)      microposts#update\n               DELETE /microposts/:id(.:format)      microposts#destroy\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":200,"score":0,"question_id":7795207,"title":"overwrite authenticate_user! in devise gem","body":"<p>I'm overwriting my authenticate method in my application controller</p>\n\n<pre><code>def authenticate_worker!\n  if user_signed_in? &amp;&amp; current_user.worker?\n    authenticate_user!\n  else\n    super\n  end\nend \n</code></pre>\n\n<p>I keep getting </p>\n\n<pre><code>wrong number of arguments (1 for 0)\napp/controllers/application_controller.rb:51:in `authenticate_worker!'\n</code></pre>\n\n<p>Any idea what i'm missing? Thanks!</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":54,"score":1,"question_id":12877983,"title":"different controllers and methods","body":"<p>I'm a beginner and there is something I'm a bit confused with.</p>\n\n<p>I have a website that is similar to Metacritic for TV Shows, my two tables are  shows and reviews.</p>\n\n<p>There is my show (as in tv show) controller</p>\n\n<pre><code>  def show\n    @show = Show.find(params[:id])\n    @reviews = @show.reviews.paginate(page: params[:page])\n    @ratings = @show.reviews.average(\"rating\")\n\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @show }\n\n    end\n  end\n</code></pre>\n\n<p>and my show view</p>\n\n<pre><code>&lt;p id=\"notice\"&gt;&lt;%= notice %&gt;&lt;/p&gt;\n\n\n&lt;div class=\"row\"&gt;\n  &lt;aside class=\"span4\"&gt;\n    &lt;section&gt;\n      &lt;h1&gt;\n&lt;p&gt;\n  &lt;%= @show.name %&gt; (  &lt;%= @show.year %&gt;\n)\n&lt;/p&gt;\n\n\n&lt;p&gt;\n  &lt;b&gt;Synopsys:&lt;/b&gt;\n  &lt;%= @show.synopsys %&gt;\n&lt;/p&gt;\n&lt;p&gt;\n  &lt;b&gt;Note:&lt;/b&gt;\n  &lt;%= @ratings %&gt;\n&lt;/p&gt;\n&lt;%= image_tag @show.avatar.url %&gt;\n\n      &lt;/h1&gt;\n\n    &lt;/section&gt;\n    &lt;section&gt;\n    &lt;/section&gt;\n  &lt;/aside&gt;\n\n&lt;div class=\"span8\"&gt;\n&lt;% if @show.reviews.any? %&gt;\n&lt;h3&gt;Reviews (&lt;%= @show.reviews.count %&gt;)&lt;/h3&gt;\n\n\n&lt;ol class=\"reviews\"&gt;\n&lt;% @reviews.each do |review| %&gt;\n\n   &lt;%= review.content %&gt; &lt;br&gt; &lt;%= review.source %&gt; | &lt;b&gt;&lt;%= review.rating %&gt; &lt;/b&gt;&lt;br&gt;&lt;br&gt;\n&lt;br&gt;&lt;br&gt;\n&lt;% end %&gt;\n&lt;/ol&gt;\n\n&lt;%= will_paginate @reviews %&gt;\n</code></pre>\n\n<p>Now, I'm trying to do a similar thing on my home view (controller home). I want to add all the shows to the database and their overall ratings. The issue if that when I copy the content of my show controller to my home controller, review is undefined and I don't understand why.\nAnyone can help ?</p>\n\n<pre><code>class HomeController &lt; ApplicationController\n  def index\n    @shows = Show.all\n    @ratings = @show.reviews.average(\"rating\")\n\n    respond_to do |format|\n      format.html # show.html.erb\n      format.json { render json: @show }\n\n    end\n\n      def about\n    end\n\n\n      def contact\n    end\n  end\n  end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","rspec","routes","capybara","params"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":46,"score":0,"question_id":12878635,"title":"Passing params through route.rb breaks Rspec","body":"<p>I have a routes.rb file with a simple route:</p>\n\n<pre><code>get \"/search\" =&gt; \"static#search\", as: \"search\"\n</code></pre>\n\n<p>and a simple controller action:</p>\n\n<pre><code>def search\nend\n</code></pre>\n\n<p>which I can test very simply in Rspec with:</p>\n\n<pre><code>describe \"GET 'search' succeeds\" do\n  get 'search'\n  response.should be_success\nend\n</code></pre>\n\n<p>This all works fine.  Now when I try to pass a param through routes.rb:</p>\n\n<pre><code>get \"/search\" =&gt; \"static#search\", search_term: \"Default Term\", as: \"search\"\n</code></pre>\n\n<p>-OR-</p>\n\n<pre><code>get \"/search\" =&gt; \"static#search\", as: \"search\", search_term: \"Default Term\"\n</code></pre>\n\n<p>Rspec throws the error:</p>\n\n<pre><code>Failure/Error: get 'search'\nActionController::RoutingError:\n  No route matches {:controller=&gt;\"static\", :action=&gt;\"search\"}\n</code></pre>\n\n<p>Any idea why this is the case and how to fix it?</p>\n\n<p>There are no problems in development or production, and I can pick up and use the param just fine.  Why does it break in Rspec?</p>\n"},{"tags":["mysql","ruby-on-rails-3","transactions"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":48,"score":2,"question_id":12878176,"title":"Rails skipping ID, possible database MySQL transactions issues?","body":"<p>I have two application servers running Ruby on Rails sharing the same MySQL database server, using InnoDB engine.</p>\n\n<p>Sometimes under heavy load I find that IDs from the records are skipped in the table Users, X and Y and are not sequential.</p>\n\n<p>This is the pseudo code:</p>\n\n<pre><code>user = Create user x in table Users\n\nuser_x = Find user x\n\nInsert a tuple into an auxiliary table X\n\nInsert a tuple into an auxiliary table Y\n\nUpdate the tuple that was inserted in table X\n\nInsert a tuple into an auxiliary table Z\n</code></pre>\n\n<p>Tables X, Y, Z, are all related in someway, and I am not deleting any records.</p>\n\n<p>However, I find that sometimes record IDs will skip one or two during heavy load.</p>\n\n<p>Would transaction help with this case?</p>\n\n<pre><code>Start transaction\n\n  user = Create user x\n\n  user_x = Find user x\n\n  Insert a tuple into an auxiliary table X\n\n  Insert a tuple into an auxiliary table Y\n\n  Update the tuple that was inserted in table X\n\n  Insert a tuple into an auxiliary table Z\n\nCommit\n</code></pre>\n\n<p>Noobie question, this code works fine when there is no load, but once if there is a load. ie multiple users hitting the same resource at the exact same time, then the above happens. Would a transaction help?</p>\n\n<p>What disadvantages would there be to wrap everything in transaction blocks?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","routes","ruby-on-rails-3.2","subdomain"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":53,"score":1,"question_id":12876472,"title":"Rails Subdomain routing with resources not working as expected","body":"<p>In a standard blog app I have added this route to my existing routes:</p>\n\n<pre><code>match '', to: 'blogs#show', constraints: { subdomain: /.+/ }\n</code></pre>\n\n<p>And these were/are my already existing routes:</p>\n\n<pre><code>resources :blogs do\n  member { get :settings }\n  member { get :stats }\n  member { match ':year/:month/:day/:article_id', to: 'blogs#show_article', :constraints =&gt; { year: /\\d{4}/, month: /\\d{2}/, day: /\\d{2}/ } }\nend\n</code></pre>\n\n<p>In my controller I do @blog = Blog.find(request.subdomain), just to make it simple I use the id. Later I would use the blogs slug or an extra domain attribute.</p>\n\n<p>This works fine insofar that <a href=\"http://17.lvh.me:3000\" rel=\"nofollow\">http://17.lvh.me:3000</a> will show blog 17. But my member actions aren't routed as expected. Being on a blog subdomain, I would expect <a href=\"http://8.lvh.me:3000/settings\" rel=\"nofollow\">http://8.lvh.me:3000/settings</a>, but only <a href=\"http://17.lvh.me:3000/blogs/17/settings\" rel=\"nofollow\">http://17.lvh.me:3000/blogs/17/settings</a> works.</p>\n\n<p>So how can I tell my blog resource member actions that they should be routed under the subdomain without the extra redundant /blogs/:id? Do I really need to do this all manually?\nI feel like I'm missing something.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rspec","cucumber","vcr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":507,"score":0,"question_id":5312553,"title":"Where to put VCR config when using both rspec and cucumber","body":"<p>I'm using both rspec and cucumber.  Cucumber of integration level tests, but rspec for unit tests.</p>\n\n<p>I'm using vcr for cucumber already, but want to use it for rspec, too.  Where's the right place to put the vcr configuration?  I'd rather not replicate it in both features/support and rspec/support.  </p>\n"},{"tags":["ruby","ruby-on-rails-3","testing","rspec","vcr"],"answer_count":1,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":98,"score":3,"question_id":9816152,"title":"Filtering sensitive data with VCR","body":"<p>I'm using VCR gem to record http interactions and replay them in future.  I want to filter-out my actual password value in the uri request.  Here's sample of what the uri looks like:</p>\n\n<pre><code>http://services.somesite.com/Services.asmx/Cabins\nUsername=long&amp;Password=john&amp;StartDate=03%2F22%2F2012&amp;EndDate=03%2F29%2F2012\n</code></pre>\n\n<p>Though an explanation is provided here, I'm still not sure how to do it after a few attempts myself:</p>\n\n<p><a href=\"https://www.relishapp.com/myronmarston/vcr/v/2-0-0/docs/configuration/filter-sensitive-data\" rel=\"nofollow\">https://www.relishapp.com/myronmarston/vcr/v/2-0-0/docs/configuration/filter-sensitive-data</a></p>\n\n<p>Any help would be appreciated.</p>\n"},{"tags":["ruby","ruby-on-rails-3","cucumber","vcr"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":106,"score":0,"question_id":11854839,"title":"How can I tag cucumber scenario outline examples for use with VCR cassettes?","body":"<p>I'd like to apply a different VCR cassette based on the tag on the example.  As far as I can tell, tagging cucumber scenario outline examples is possible, but I can't get VCR to recognize any of the tags.  Is this possible?</p>\n\n<pre><code>VCR.cucumber_tags do |t|\n  t.tag '@premium-successful-payment'\n  t.tag '@premium-card-declined'\nend\n\n\nFeature:\n\n  Background:\n    Given I am signed in \n    And I am on the premium payment page\n\n  @javascript\n  Scenario Outline: Submitting payment information\n    When I fill in \"Credit Card Number\" with \"&lt;card_number&gt;\"\n    And I fill in \"Security Code\" with \"&lt;security_code&gt;\"\n    And I select \"&lt;expires_month&gt;\" from \"credit_card_expires_month\"\n    And I select \"&lt;expires_year&gt;\" from \"credit_card_expires_year\"\n    And I press \"Activate Premium\"\n    Then I should see a payment success message\n\n    @premium-successful-payment\n    Examples:\n      | card_number      | security_code | expires_month | expires_year |\n      | 4242424242424242 | 123           | 6             | 2020         |\n\n    @premium-card-declined\n    Examples:\n      | card_number      | security_code | expires_month | expires_year |\n      | 4000000000000002 | 123           | 6             | 2020         |\n</code></pre>\n"},{"tags":["ruby-on-rails-3","cucumber","delayed-job","webmock","vcr"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":89,"score":1,"question_id":12287336,"title":"Test response of Rails 3 background job (API-Request) with VCR in Cucumber feature","body":"<p>I have a Rails 3 background job (delayed_job) which sends a hipchat / Campfire message to their API and I want to check the response in my Cucumber feature. Is there a way to get the last HTTP response(s) which VCR have recorded?</p>\n\n<p>The feature looks like this</p>\n\n<pre><code>    @vcr\n    Scenario: Send hipchat message when task created\n      Given an hipchat_sample integration exists with app: app \"teamway\"\n      When I create an \"ActionMailer::Error\" task to \"Teamway\"\n      And all jobs are worked off # invoke Delayed::Worker.new.work_off\n      Then a hipchat message should be sent \"ActionMailer::Error\"\n</code></pre>\n\n<p>In my step definition I want to check the response body:</p>\n\n<pre><code>    Then /^a hipchat message should be sent \"(.*?)\"$/ do |arg1|\n      # Like this:\n      # VCR::Response.body.should == arg1\n    end\n</code></pre>\n\n<p>VCR already records the request and response, but I do not know how to take them. I think of something similar to catching the emails sent with Pickle's steps. Does anybody have an idea how to do this?</p>\n\n<p>I use rails 3.2.8, cucumber-rails 1.3 and vcr 2.2.4 (with webmock).</p>\n\n<p>Best regards\nTorsten</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rubygems","bundler"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12877276,"title":"Bundle install repeated errors","body":"<p>Things were buggy on my system, so I uninstalled my old ruby directory and am now trying to reinstall things. I downloaded and installed the newest ruby version.</p>\n\n<p>When I tried to run Rails server, though, it said that I needed to install a number of gems. So I ran bundle install, and it turned out that had also been uninstalled.</p>\n\n<p>So I did gem install bundler, but now, whenever I run bundle install, it doesn't work. I keep getting some version of this error: </p>\n\n<pre><code>Gem::RemoteFetcher::FetchError: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed ...\nAn error occurred while installing ThisGem ('0.3.4'), and Bundler cannot continue. \nMake sure that \"gem install ThisGem '0.3.4' \" succeeds before bundling.\n</code></pre>\n\n<p>The \"gem install\" command works, every time, but when I install a single gem, it just moves onto erroring at the next, which has to be installed by hand, which kind of ruins the point of Bundler. </p>\n\n<p>Any ideas why this is happening?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":26,"score":0,"question_id":12877053,"title":"Rails assets keep CSS license comments when stylesheet assets are minified","body":"<p>How do I preserve CSS comments in Rails stylesheet assets that are minified?</p>\n\n<p>This is similar to <a href=\"http://stackoverflow.com/questions/8896969/rails-assets-keep-license-comments\">this question</a>, but for CSS instead of JavaScript.</p>\n"},{"tags":["jquery","ruby-on-rails","ajax","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12872843,"title":"rails ajax post works inconsistently","body":"<p>OK, this one is driving me crazy.  First of all, everything works fine in my development environment.  In production, however, the behavior is inconsistent across multiple browsers.  Sometimes it works, sometimes it doesn't.  I'm using Rails 3.1 and jQuery 1.8.2.  I had been using jQuery 1.4.1 and it wasn't working then, either.</p>\n\n<p>Here's what should happen: the user clicks a \"Save\" button and the client sends JSON-formatted data to rails which uses it to create several new \"response\" items and then redirects the user to the controller \"show\" action (the user answers the poll and then sees the results for all users).  </p>\n\n<p>Here is the relevant code from my view (answer.html):</p>\n\n<pre><code>$.ajaxSetup({\n    'beforeSend': function(xhr) {\n        xhr.setRequestHeader(\"Accept\", \"text/javascript\")\n    }\n});\n\n$(document).ajaxSend(function(e, xhr, options) {\n  var token = $(\"meta[name='csrf-token']\").attr(\"content\");\n  xhr.setRequestHeader(\"X-CSRF-Token\", token);\n});\n\nvar plot;\nvar dataseries = [[[null,null]],[[null,null]],[[null,null]],[[null,null]],[[null,null]],[[null,null]],[[null,null]],[[null,null]],[[null,null]]];\n\n$(document).ready(function(){\n$('.save_button').click(function(event){\n    event.preventDefault();\n    var numItems = dataseries.length;\n    var item;\n    var sequence;\n    var question = &lt;%=@question.id%&gt;;\n\n    var dataArray = new Array();\n\n    for (i=0;i&lt;numItems;i++){\n        var requestObj = {\n          question_id: \"&lt;%=@question.id%&gt;\",\n          user_id: \"&lt;%= @user %&gt;\",      \n    }\n        item = $('.item_list li[data-seq='+i+']').attr('id');\n        requestObj[\"item_id\"] = item;\n        requestObj[\"x\"]= dataseries[i][0][0];\n        requestObj[\"y\"]= dataseries[i][0][1];\n\n    if (requestObj[\"item_id\"]&gt;0 &amp;&amp; requestObj[\"x\"]!=null &amp;&amp; requestObj[\"y\"]!=null ){\n        dataArray.push(requestObj);\n    }\n\n\n    }\n    var dataString = JSON.stringify(dataArray);\n    var a = $.ajax({\n    url: \"/responses/batchCreate\",\n    data: dataString,\n    type: \"POST\",\n    dataType: 'json',\n    success: function(data, textStatus, jqXHR) {\n    },\n    error: function(jqXHR, textStatus, errorThrown) {\n      alert('error:');\n    },\n    headers: {\n      'X-CSRF-Token': '&lt;%= form_authenticity_token.to_s %&gt;'\n    }\n    })\n\n\n    window.location.replace(\"&lt;%=question_path(@question)%&gt;\");\n});\n</code></pre>\n\n<p>The $('.save_button').click(function(event) fires every time.  The \"error\" callback fires every time, too - but sometimes it works!</p>\n\n<p>Here is the relevant controller code:</p>\n\n<pre><code>def batchCreate\n        logger.info \"RECEIVED AJAX DATA!!!!\"\n        responses = ActiveSupport::JSON.decode(request.body.read)\n        responses.each do |resp|\n          if (resp[\"item_id\"]!=:null &amp;&amp; resp[\"x\"]!=:null &amp;&amp; resp[\"y\"]!=:null )\n            @response = Response.new()\n            if resp[\"user_id\"]!=\"\"\n              @response.user_id=resp[\"user_id\"];\n            else\n              u = User.where(:token =&gt; cookies[:user]).first\n              if u.nil?\n                u = User.create!(:email =&gt; \"guest_#{Time.now.to_i}#{rand(99)}@example.com\", :password =&gt; cookies[:user], :token =&gt; cookies[:user])\n                @response.user_id=u.id\n              else\n                @response.user_id = u.id\n              end\n            end\n\n            @response.question_id=resp[\"question_id\"].to_i\n            @response.item_id = resp[\"item_id\"].to_i\n            @response.x = resp[\"x\"].to_i\n            @response.y = resp[\"y\"].to_i\n            @response.save\n          end\n        end\n\n    respond_to do |format|\n\n        format.html { redirect_to @response, :notice =&gt; 'Question was successfully created.' }\n        format.json { render :json =&gt; response, :status =&gt; :created, :location =&gt; @response }\n        format.js \n\n    end\n\n  end\n</code></pre>\n\n<p>Sometimes the data are saved, new responses are created in my DB, and the page redirects to the show action.  Other times, it just reloads the page.  In these instances, it doesn't appear that the post data are reaching the server - I see nothing in production.log.  </p>\n\n<p>I'm a complete beginner to ajax and only slightly more competent at Rails.  Any insight you can provide on even how to begin to troubleshoot this issue would be much appreciated.  Thank you.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gmail","actionmailer","mail-gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":81,"score":0,"question_id":12874555,"title":"Rails 3 - ActionMailer/Mail gem - 'from' address is being over ridden","body":"<p>I have a simple contact form on a site.</p>\n\n<p>There is an email account just to handle the mail being sent through the contact form. This is 'mycompany.noreply@gmail.com'</p>\n\n<h2>The problem</h2>\n\n<p>When a user fills in the form and sends it, two emails are sent. One confirmation email to the user of the site and the actual filled in form to the company.</p>\n\n<p>The company wants it so when they receive the email from the user, they hit reply and the users email address is automatically in the 'to' field. But when they do that at the moment, what they see is \"Senders name 'mycompany.noreply@gmail.com'\" instead of \"Senders name 'sender_email_address'\".</p>\n\n<h2>The code</h2>\n\n<pre><code>class Notifications &lt; ActionMailer::Base\n\n  def enquiry(user)\n    @user = user\n    mail(to: \"employee@mycompany.com\", subject: \"website enquiry\", from: \"#{@user.name} &lt;#{@user.email}&gt;\")\n  end\n\n  def no_reply(user)\n    @user = user\n    mail(to: @user.email, from: \"My Company &lt;mycompany.noreply@gmail.com&gt;\", subject: \"Message received at mycompany.com\")\n  end\nend\n</code></pre>\n\n<h2>Tests</h2>\n\n<p>The test for the from field passes.</p>\n\n<pre><code>require \"spec_helper\"\n\ndescribe Notifications do\n\n  let(:contact_form) { FactoryGirl.build(:contact_form) }\n\n  context \"enquiry\" do\n\n    let(:mail) { Notifications.enquiry(contact_form) }\n\n    it \"renders the headers\" do\n      mail.from.should eq([contact_form.email])\n    end\n  end\nend\n</code></pre>\n\n<p>Also, I am using mailcatcher.</p>\n\n<p>Mailcatcher also shows the correct <code>user.email</code> in the from field.</p>\n\n<p>It only seems to be when the <em>actual</em> email is received (using gmail) that the wrong address appears.</p>\n\n<p>Any help appreciated.</p>\n\n<h2>EDIT</h2>\n\n<p>Default mail settings:</p>\n\n<pre><code> # mail config settings\n  config.action_mailer.delivery_method = :smtp\n  config.action_mailer.smtp_settings = { \n    :address              =&gt; \"smtp.gmail.com\",\n    :port                 =&gt; 587,\n    :user_name            =&gt; 'mycompany.noreply@gmail.com',\n    :password             =&gt; 'password',\n    :authentication       =&gt; 'plain',\n    :enable_starttls_auto =&gt; true  }\n</code></pre>\n\n<p>mail header from mailcatcher</p>\n\n<pre><code>Date: Sat, 13 Oct 2012 21:08:02 +0100\nFrom: Joe Bloggs &lt;joebloggs@gmail.com&gt;\nTo: mycomany.noreply@gamil.com\nMessage-ID: &lt;5079ca229969b_67c23fc061434ed023056@Mark-Charless-iMac-2.local.mail&gt;\nSubject: website enquiry\nMime-Version: 1.0\nContent-Type: multipart/alternative;\n boundary=\"--==_mimepart_5079ca226fb17_67c23fc061434ed02277b\";\n charset=UTF-8\nContent-Transfer-Encoding: 7bit\n\n\n\n----==_mimepart_5079ca226fb17_67c23fc061434ed02277b\nDate: Sat, 13 Oct 2012 21:08:02 +0100\nMime-Version: 1.0\nContent-Type: text/plain;\n charset=UTF-8\nContent-Transfer-Encoding: 7bit\nContent-ID: &lt;5079ca227ec80_67c23fc061434ed02288a@Mark-Charless-iMac-2.local.mail&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails-3","sass","assets"],"answer_count":5,"favorite_count":1,"up_vote_count":8,"down_vote_count":0,"view_count":2485,"score":8,"question_id":6269420,"title":"SASS global variables not being passed to partials","body":"<p>Basically I have a structure that used to work perfectly in 3.0.x and now it breaks with <code>undefined variable</code> errors.</p>\n\n<ul>\n<li>partials\n<ul>\n<li>_base.css.sass</li>\n<li>_header.css.sass</li>\n</ul></li>\n<li>main.css.sass</li>\n<li>application.css.sass</li>\n</ul>\n\n<p>the <code>application.css.sass</code>:</p>\n\n<pre><code>//=require 'main'\n</code></pre>\n\n<p>the <code>main.css.sass</code>:</p>\n\n<pre><code>@import 'partials/base'\n@import 'partials/header'\n</code></pre>\n\n<p>Pretty simple stuff.</p>\n\n<p>I get an error on <code>_header.css.sass</code>\nbecause it uses a variable defined on <code>_base.css.sass</code></p>\n\n<p>I didn't have this error before, and it makes no sense to me, since we're importing those variables on the <code>_base.css.sass</code> in the same context we are importing the <code>_header.css.sass</code>.</p>\n\n<p>Am I going to have to import the <code>_base.css.sass</code> on every partial too? \nWhat is the point of the <code>main.css.sass</code> requiring global variables if they cannot be used in the own partials you are requiring?</p>\n\n<p>If my structure is completely wrong, please give me an alternative, I'd love suggestions.</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":59,"score":2,"question_id":12868691,"title":"Rails: Adding to model after user submits form","body":"<p>In my Rails 3.2 project, I have a form to create a new post in <code>new.html.erb</code> in <code>app/views/posts/</code></p>\n\n<pre><code>&lt;%= form_for(@post) do |post_form| %&gt;\n  ...\n  &lt;div class=\"field\"&gt;\n    &lt;%= post_form.label :title %&gt;&lt;br /&gt;\n    &lt;%= post_form.text_field :title %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= post_form.label :content %&gt;&lt;br /&gt;\n    &lt;%= post_form.text_field :content %&gt;\n  &lt;/div&gt;\n  &lt;div class=\"actions\"&gt;\n    &lt;%= post_form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then the <code>create</code> function in <code>posts_controller.rb</code></p>\n\n<pre><code>def create\n  @post = Post.new(params[:post])  \n  if @post.save\n    format.html { redirect_to @post }\n  else\n    format.html { render action: \"new\" }\n  end\nend\n</code></pre>\n\n<p>When the user submits a post, the <code>title</code> and <code>content</code> of the post are added to the <code>Post</code> model. However, I also want to add to another field of that post. For the field <code>random_hash</code> (which the user doesn't get to specify), I want to make it a string of 8 lowercase letters, the first 2 of which are the first 2 letters of the title, and the last 6 are random lowercase letters. How can I do that?</p>\n"},{"tags":["ajax","ruby-on-rails-3","layout"],"answer_count":0,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":39,"score":2,"question_id":12846350,"title":"return to default layout behavior using a Proc","body":"<p>I'm adding unobtrusive ajax to my site, so I need to set the layout depending on the request type :</p>\n\n<pre><code># app/controllers/application_controller.rb\nlayout Proc.new { |controller| controller.request.xhr? ? 'ajax' : 'application' }\n\n# app/views/layout/ajax.html.erb\n&lt;%= render :partial =&gt; \"shared/flash\", :object =&gt; flash %&gt;\n&lt;%= yield %&gt;\n</code></pre>\n\n<p>But I also want to use nested layout and have my javascript deal with where to insert ajax retrieved content. According to the <a href=\"http://api.rubyonrails.org/classes/AbstractController/Layouts/ClassMethods.html#method-i-layout\" rel=\"nofollow\">rails api</a> layout nil force default layout behavior with inheritance, so I tried this :</p>\n\n<pre><code>layout Proc.new { |controller| controller.request.xhr? ? 'ajax' : nil }\n</code></pre>\n\n<p>Which doesn't work, I get no layout at all. The only piece of information I found is an old chat log saying that this, indeed, doesn't work due to the way Rails handle layout.</p>\n\n<p>Is there a way to achieve this ?</p>\n\n<p>Since a proc returning nil doesn't work, is their a way to set the layout on a condition beeing met (request.xhr? here). Something like layout_if.</p>\n\n<p>Or should I just add</p>\n\n<pre><code>layout Proc.new { |controller| controller.request.xhr? ? 'ajax' : 'controller_name' }\n</code></pre>\n\n<p>to every controllers with a different layout ?</p>\n\n<p>My ajax request actually return html, should I cheat a little and return those html elements in .xml files and use respond_to to set the layout ?\n(This may be great, for another reason, having differents urls to access with and without layout content could allow for page cache, but there are other way to achieve this.)</p>\n\n<p>Or maybe there is a way better solution.</p>\n"},{"tags":["ruby","ruby-on-rails-3","refactoring"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":1,"view_count":56,"score":1,"question_id":12867791,"title":"Ruby Conditional If Else Assignment","body":"<p>So I have the following code that I wanted to make a little more readable:</p>\n\n<pre><code>user = User.find_by_username(username)\nuser = User.new(credentials) if user.nil?\n</code></pre>\n\n<p>Essentially the first line is the default, the following line instantiates itself if it's not already set.</p>\n\n<p>Is there a way I can clean this up a bit and get it onto a single line of code? Something like this maybe:</p>\n\n<pre><code>user = User.find_by_username(username) || User.new(credentials)\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong></p>\n\n<p>I now realize the the code I provided does exactly what I need, sorry for wasting cyberspace but feel free to suggest alternative solutions.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":344,"score":0,"question_id":5746633,"title":"define character in rails migration","body":"<p>All tables and fields created with Rails migrations have <code>latin1_swedish_ci</code> collate.\nBecause my project use russian language, this collation is improper.</p>\n\n<p>Is it possible to use migrations with <code>utf8_general_ci</code>?</p>\n\n<p>P.S. My database.yml:</p>\n\n<pre><code>development:\n  adapter: mysql2\n  encoding: utf8\n  collation: utf8_general_ci\n  reconnect: false\n  database: my_development\n  pool: 5\n  username: username\n  password: 'heavy'\n  host: localhost\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","windows","ruby-on-rails-3","rubygems"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":44,"score":1,"question_id":12875082,"title":"Rails server errors on windows computer","body":"<p>I'm trying to install the Rails environment on my brother's computer so that we can collaborate on my app.</p>\n\n<p>I think I've installed everything correctly, but now I'm running into major problems, I think because he's got a Windows computer. Basically, although everything is (I think) installed correctly, rails server won't run, because it produces the following errors:</p>\n\n<p>It complains that there's a problem with </p>\n\n<pre><code>Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in 'require':\n</code></pre>\n\n<p>Then points to this file.</p>\n\n<pre><code>config/environments/development.rb:3: syntax error unexpected ':', expecting '}'\n</code></pre>\n\n<p>It also complains that that line has an </p>\n\n<pre><code>odd number list for Hash (SyntaxError)\n</code></pre>\n\n<p>That line is</p>\n\n<pre><code>config.action_mailer.default_url_options = { host: \"localhost:3000\" }\n</code></pre>\n\n<p>More importantly, that line works just fine on my Mac. The error goes away when I delete it. (But I don't want to delete it, and I especially don't want to delete the next one). Same with this error</p>\n\n<pre><code>Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in 'load':\n</code></pre>\n\n<p>of this line in my session_store initializer file:</p>\n\n<pre><code>&lt;appname&gt;::Application.config.session_store :cookie_store, key: '_&lt;appname&gt;_session'\n</code></pre>\n\n<p>Any idea what's going on?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12863848,"title":"Rails 3.2 routing error with scope","body":"<p>This problem has taken all day of mine...</p>\n\n<p>Well;</p>\n\n<p>I'm just trying to put all of my administration pages inside an /admin directory and to receive them via domain/admin style only. I've tried to make it run with <a href=\"http://guides.rubyonrails.org/routing.html#controller-namespaces-and-routing%20this\" rel=\"nofollow\">this</a> guide.</p>\n\n<p>According to that official guide, what I'm looking for is using <code>scope</code> in my <code>routes.rb</code> file. BECAUSE, I have used named routes tones of times inside my pages. I do not want my <code>program_path</code> named route to change <code>admin_program_path</code> since I have 28 different usage of it. </p>\n\n<p>So I'm supposed to use <code>scope</code> instead of <code>namespace</code>. </p>\n\n<p>Issue is: I can not make <code>scope</code> work with my project.</p>\n\n<p>Here is my routes.rb</p>\n\n<pre><code> scope \"/admin\" do\n\n  get \"access/login\"\n  get \"access/index\"\n\n  match \"access/login_attempt\", to: \"access#login_attempt\"\n  match \"access/logout\", to: \"access#logout\"\n\n  resources :admin_users\n\n  root to: 'programs#index'\n\n  resources :programs\n  resources :program_categories\n  resources :program_subcategories\n\n  resources :articles\n  resources :pictures\n\n\n\n  match '/kategoriler/:id' =&gt; 'program_categories#show'\n  match '/kategoriler' =&gt; 'program_categories#index'\n  match '/kategori/yeni' =&gt; 'program_categories#new'\n  match 'program/yeni' =&gt; 'programs#new'\n  match 'programlar' =&gt; 'programs#index'\n  match '/progam_categories/select_category/:program_id' =&gt; 'program_categories#select_category'\n  match '/program_subcategories/select_subcategory' =&gt; 'program_subcategories#select_subcategory'\n  match '/program_subcategory/add_subcategory' =&gt; 'program_subcategories#add_subcategory'\n\n  end\n</code></pre>\n\n<p>Here is my controller beginning :</p>\n\n<pre><code>class ProgramsController &lt; ApplicationController\n</code></pre>\n\n<p>Just like told here: </p>\n\n<pre><code>If you want to route /admin/posts to PostsController (without the Admin:: module prefix), you could use\nscope \"/admin\" do\n  resources :posts, :comments\nend\n</code></pre>\n\n<p>As a result, what am I getting?</p>\n\n<p>This error message:</p>\n\n<pre><code>Routing Error\n\nuninitialized constant ProgramsController\n</code></pre>\n\n<p>Whichever controller I try to access, error changes that way.. Such like <code>uninitialized constant ProgramCategoriesController</code> , <code>uninitialized constant ProgramSubcategoriesController</code> etc...</p>\n\n<p>I've tried to place <code>application_controller</code> both inside admin folder and root of controllers directory... No way.</p>\n\n<p>Where is my mistake here? :(</p>\n\n<p>Thanks in advance...</p>\n"},{"tags":["ruby-on-rails-3","twitter-bootstrap","breadcrumbs"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":68,"score":0,"question_id":12875007,"title":"breadcrumbs_on_rails with twitter bootstrap","body":"<p>I am using breadcrumbs_on_rails 2.2.0 with bootstrap 2.  Im confused.  It is not really creating breadcrumbs.  It is only creating the first level link.  In other words, as I navigate it isn't adding new breadcrumbs to the stack.  </p>\n\n<p>I am setting a default breadcrumb in the application controller</p>\n\n<pre><code>  before_filter :set_initial_breadcrumbs\n  def set_initial_breadcrumbs\n       add_breadcrumb 'cPanel', :controlpanel_path\n  end\n</code></pre>\n\n<p>In controllers I am creating breadcrumbs in each action...something like:</p>\n\n<pre><code>  def show\n      @model = Model.find(params[:id])\n      add_breadcrumb \"View Model\", model_path(@model)\n  end\n\n def edit\n      @model = Model.find(params[:id])\n      add_breadcrumb \"Edit Model\", edit_model_path(@model)\n end\n</code></pre>\n\n<p>If I navigate to the show page, then click on the edit link from there...the breadcrumb only shows the default crumb (back to the cPanel) and the \"Edit Model\" crumb (my current page).  But, the \"Show Model\" crumb (where my breadcrumb path originated) is not there.  </p>\n\n<p>This gem seems very easy to set up and configure.  But, I am evidently missing something.  I did notice an issue about 5 months ago alleging that breadcrumbs_on_rails has some conflicting method names with bootstrap (add_breadcrumb and render_breadcrumb).  I did some digging, and could only determine that bootstrap supplies styles for breadcrumbs but no methods for generating them.</p>\n\n<p>Thanks for help</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":1482,"score":1,"question_id":5375407,"title":"removing field name from validation error message","body":"<p>in rails 3 i don't want to show field names in error messages. Anyone know how to do that ?</p>\n\n<pre><code>validates_presence_of :title, :message =&gt; \"no title\"\n</code></pre>\n\n<p>it shows </p>\n\n<pre><code>Title no title \n</code></pre>\n\n<p>i want </p>\n\n<pre><code>no title\n</code></pre>\n"},{"tags":["javascript","ruby-on-rails-3","nested-forms"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12874610,"title":"Nested_form inside table rows","body":"<p>I'm using nested_form inside one of my Rails forms.  I saw you can generate <code>tr</code> 's instead of of <code>div</code> 's using this article <a href=\"https://github.com/ryanb/nested_form/wiki/How-To:-Render-nested-fields-inside-a-table\" rel=\"nofollow\">https://github.com/ryanb/nested_form/wiki/How-To:-Render-nested-fields-inside-a-table</a></p>\n\n<p>Where would the javascript go though that they suggest?  </p>\n\n<pre><code>window.nestedFormEvents.insertFields = function(content, assoc, link) {\n  var $tr = $(link).closest('tr');\n  return $(content).insertBefore($tr);\n}\n</code></pre>\n"},{"tags":["ruby-on-rails-3","authentication","authlogic"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12874197,"title":"undefined local variable or method `config' for main:Object (NameError) when running rails server","body":"<p>Hi I've been following a tutorial for <strong>authlogic</strong> gem in railscasts... <a href=\"http://railscasts.com/episodes/160-authlogic?view=asciicast\" rel=\"nofollow\">http://railscasts.com/episodes/160-authlogic?view=asciicast</a></p>\n\n<p>From the tutorial, I was asked to add <code>config.gem \"authlogic\"</code> in my environment.rb</p>\n\n<p>Is it the old way in installing a gem? or the right way to make authlogic work?</p>\n\n<p>I removed the <code>config.gem \"authlogic\"</code> and tried to install the gem using <code>gem install authlogic</code> and by putting <code>gem 'authlogic'</code> inside my Gemfile (then bundle it)</p>\n\n<p>Authlogic gives automatic form validation (when there's no input or what)</p>\n\n<p>But it is not working. It could be possibly that I didn't install the authlogic gem properly?</p>\n\n<p>What do you think is the problem why my Authlogic gem is not working..</p>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":1,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":44,"score":2,"question_id":12874577,"title":"Rails 3.2 CRUD : .where with 'or' conditionnal","body":"<p>I'm new to ruby on rails and i want to do something like :</p>\n\n<pre><code> @tasks = Task.where(:def =&gt; true || :house_id =&gt; current_user.house_id)\n</code></pre>\n\n<p>What is the most efficient/clean way to do this ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12874134,"title":"How to make use 'Typo' gem in an existing rails application, now it runs as separate blog engine?","body":"<p>I am often pointed to the source of typo blog engine i.e., <a href=\"http://typosphere.org/stable.tar.gz\" rel=\"nofollow\">http://typosphere.org/stable.tar.gz</a> But, if I download and perform the following: bundle install etc. it runs as a separate engine.</p>\n\n<p>I tried installing typo as a gem, I tried the following:</p>\n\n<pre><code>gem install typo\n\ntypo install /some/path this fails, saying 'Typo command not found'\n</code></pre>\n\n<p>How to integrate typo blog engine with existing app, any pointers would be welcome.</p>\n"},{"tags":["ruby-on-rails-3","authentication","login","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":154,"score":2,"question_id":5802885,"title":"additional logic in devise authentication","body":"<p>please how and where can i place additional authentication logic in devise?</p>\n\n<p>i have added a custom column called expire_date in my users table and it is a date column.</p>\n\n<p>i want an additional requirement that the date there must not be later than todays date before allowing them to be authenticated.</p>\n\n<p>please where can i add this logic?</p>\n\n<p>thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12873948,"title":"Rails Recursive Search Helper","body":"<p>Is there a rails helper for this case?</p>\n\n<p>You have a <code>Survey</code>, which <code>has_many</code> Questions, which <code>has_many</code> Answers.</p>\n\n<pre><code>s = Survey.first\ns.answers # =&gt; Returns the answers of all the survey questions\n</code></pre>\n\n<p>I didn't want to recreate the wheel here. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":3,"favorite_count":1,"up_vote_count":1,"down_vote_count":0,"view_count":2459,"score":1,"question_id":5418454,"title":"How to get request's target controller and action with Rails 3?","body":"<p>In the application controller before filter.</p>\n\n<pre><code>class ApplicationController &lt; ActionController::Base\n  before_filter :authenticate\n\n  def authenticate\n    # How do we know which controller and action was targetted?\n  end\nend\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","will-paginate"],"answer_count":3,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":76,"score":0,"question_id":9625489,"title":"Why cant I do this in my controller","body":"<pre><code>def search\n  @location = Location.find(params[:location_id])\n  start_date = DateTime.strptime(params[:start_date], \"%m-%d-%Y\")\n  end_date = DateTime.strptime(params[:end_date], \"%m-%d-%Y\")\n  @songs = @location.songs.find(:all, :conditions =&gt; {:play_date =&gt; start_date..end_date}).paginate(:page =&gt; params[:page], :per_page =&gt; 40)\n  render 'show'\nend\n</code></pre>\n\n<p>Here is my error</p>\n\n<pre><code>undefined method `paginate' for #&lt;Array:0x007fb00e49e6c8&gt;\n</code></pre>\n\n<p>all works if i remove the will_paginate but i need it...any ideas or is there a better way to write this controller</p>\n"},{"tags":["ruby-on-rails-3","node.js","hadoop"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":47,"score":0,"question_id":12873255,"title":"Node.js or Ruby+Pusher for a real-time, distributed application?","body":"<p>I'm starting a application that basically should listen to an message coming via an API, stores it and updates to everybody who's visualizing the page (websockets). There are two essential requirements for this project: 1) it must deal with heavy processing, so it should be distributed (Hadoop, Storm); and 2) it should be event based, i.e, listen to events in the database and display it to everybody who's viewing the page. </p>\n\n<p>I know that there are pros and cons but, for example, there are more things developed for Ruby+Hadoop than to Node.js, and Rails has also a lot of plugins that makes the app development really fast (messaging, oauth, payment, etc). On the other hand, Node.js seems more adapted to the real-time stuff. Can you tell me which alternative would fit the best? </p>\n\n<p>Ruby on Rails + Pusher (or EventMachine)</p>\n\n<p>Node.js</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord","associations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":57,"score":0,"question_id":12872682,"title":"How to properly use a has_many :through with an alias_method?","body":"<p>I am using Ruby on Rails v3.2.2. I have following associations with an <code>alias_method</code> used for a <code>has_many :through</code> association, this way:</p>\n\n<pre><code>class Resource &lt; ActiveRecord::Base\n  has_many :article_associations\n  alias_method :post_associations, :article_associations\n\n  has_many :users, :through =&gt; :post_associations\nend\n</code></pre>\n\n<p>When I execute the <code>@article.users</code> I get the following error:</p>\n\n<pre><code>ActiveRecord::HasManyThroughAssociationNotFoundError\nCould not find the association :post_associations in model Article\n</code></pre>\n\n<p>Why it happens? Is there a way to make it to work as expected? That is, how to properly return <code>@article.users</code> through the \"aliased\" <code>:post_associations</code>?</p>\n\n<hr>\n\n<p><em>Note</em>: I would like to \"state\" / \"use\" the <code>:post_associations</code> in the <code>has_many :users, :through =&gt; :post_associations</code> statement because I am trying to \"dynamically build\" (that is, metaprogramming) the <code>has_many :through</code> association.</p>\n\n<hr>\n\n<p>The Ruby on Rails <em>Framework Trace</em> is:</p>\n\n<pre><code>activerecord (3.2.2) lib/active_record/reflection.rb:501:in `check_validity!'\nactiverecord (3.2.2) lib/active_record/associations/association.rb:26:in `initialize'\nactiverecord (3.2.2) lib/active_record/associations/collection_association.rb:24:in `initialize'\nactiverecord (3.2.2) lib/active_record/associations/has_many_through_association.rb:10:in `initialize'\nactiverecord (3.2.2) lib/active_record/associations.rb:157:in `new'\nactiverecord (3.2.2) lib/active_record/associations.rb:157:in `association'\nactiverecord (3.2.2) lib/active_record/associations/builder/association.rb:44:in `block in define_readers'\n...\n</code></pre>\n"},{"tags":["css","ruby-on-rails","ruby-on-rails-3","twitter-bootstrap","styles"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12865192,"title":"Page specific css stylesheets in Rails (using two different versions of twitter bootstrap)","body":"<p>I've started a Rails project and implemented bootstrap-sass into it. A short time later I found a theme/template using a different version of twitter bootstrap. I've added the template to the app but the view doesn't align perfectly as was intended. I then added the specific assets that came with the theme/template to my project (such as jquery version, ANOTHER older bootstrap version) and the result is almost perfect. However, there are still some alignment issues. When I inspect the CSS I can see it's happening because of conflicts between the two versions of bootstrap.</p>\n\n<p>I'm thinking I should make it so that this template only uses the version of twitter bootstrap that came with it. If so, how do I do this? How do I make it so that a rails view will only use a certain css stylesheet and not read from others?</p>\n\n<p>(If this is not the best solution, what are some alternatives I should consider?)</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","activerecord","relationship","has-many"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":33,"score":0,"question_id":12599299,"title":"has_many delete associations on update","body":"<p>I think this one is pretty simple… But i don´t get it. I have a has_many-relationship between two models (combination and canvas_price):</p>\n\n<p>combination.rb:</p>\n\n<pre><code>class Combination &lt; ActiveRecord::Base\n  has_many :canvas_prices, :dependent =&gt; :delete_all\n\n  accepts_nested_attributes_for :canvas_prices,\n                                :allow_destroy =&gt; true,\n                                :reject_if =&gt; lambda { |a| a[:name].blank? }\nend\n</code></pre>\n\n<p>canvas_price.rb:</p>\n\n<pre><code>class CanvasPrice &lt; ActiveRecord::Base\n    belongs_to :combination\nend\n</code></pre>\n\n<p>In my form i have links which delete inputs in the nested CanvasPrice-form via JavaScript.</p>\n\n<p>My problem is that when i delete one or more of these fields and update the combination, the associated CanvasPrices aren´t deleted, though the CanvasPrices which i want to delete are NOT in my params. How do i achieve this?</p>\n"},{"tags":["ruby-on-rails-3","devise"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":59,"score":0,"question_id":12872521,"title":"Devise current_user in Application Helper? Rails 3","body":"<p>I have a partial in which a user can set his current status. Since this partial is always showing, I'm moving the logic behind it to application_helper.rb, but for some reason I cannot access the Devise current_user from there. I get:</p>\n\n<pre><code>undefined local variable or method `current_user' for ApplicationHelper:Module (NameError)\n</code></pre>\n\n<p>What measures should I take for it to be accessible in the helper? \nOr is there a more philosophical(?) reason that it's not accessible, e.g. is there another design pattern that would be more suitable?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","count","each"],"answer_count":3,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":74,"score":5,"question_id":12870431,"title":"Counting in View Rails","body":"<p>I've got a list of items I'm looping in an each in my show view. This is all perfectly fine. However, I would like to get a number infront of each item which increments with every loop ( i = 0, i++ you know the drill ).</p>\n\n<p>Now, how can i do this in Rails? This is what I get by now:</p>\n\n<pre><code>&lt;% i = 0 %&gt;\n&lt;% @trip.triplocations.each do |tl| %&gt;\n  &lt;article id=\"&lt;%= dom_id(tl)  %&gt;\"&gt;\n    &lt;strong&gt; &lt;%= tl.title %&gt; &lt;/strong&gt;\n      &lt;p&gt;\n        &lt;%= tl.description %&gt;\n      &lt;/p&gt;\n  &lt;/article&gt;\n&lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":61,"score":0,"question_id":12871336,"title":"Open up a pop-up window, select an item and go back to main window in Rails 3.2","body":"<p>Inside a page called <code>Program edit</code>, there will be a button named <code>Select image</code> and as it is clicked, a Pop-up window will open which shows list of images. After selecting an image from the list and click to the <code>Add</code> button, pop-up will close up and selected pictures ID will be passed to main window. It should be available to use at program's params after closing image list popup.</p>\n\n<p>Here is the scenario I would like to have.</p>\n\n<p>Which way should I follow while doing this?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","nested-forms","has-many","belongs-to"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":48,"score":-1,"question_id":12870661,"title":"Nested form can't mass assign, create action","body":"<p>I had to add the pen attributes to the paper model to stop the error \"can't mass assign :pen\", even thought I had the attr_accessible for pen_attributes.</p>\n\n<p>Now, I'm getting a \"unknown attribute: pen\" error. It's pointing me to the second line of the create action. I can't figure it out.</p>\n\n<p>I basically want to have to have the Paper New action create the pen and assign it to the paper.</p>\n\n<pre><code>Paper model\n\nattr_accessible  :name, :size, :line, \n                    :pen_attributes,\n                        :pen, :colour, :style\n\nhas_many :pens\naccepts_nested_attributes_for :pens\n</code></pre>\n\n<hr>\n\n<pre><code>Pens model\n\nattr_accessible :name, :size, :line, :paper_attributes, :paper_id\n\nbelongs_to :paper\n</code></pre>\n\n<hr>\n\n<pre><code>&lt;%= simple_nested_form_for @paper do |f| %&gt;\n        &lt;%= f.input :name %&gt;\n        &lt;%= f.input :size, :placeholder =&gt; \"text\" %&gt;\n        &lt;%= f.input :line %&gt;\n\n            &lt;%= f.fields_for @pen do |h| %&gt;\n            &lt;%= h.input :pen,  %&gt;\n            &lt;%= h.input :colour %&gt;\n            &lt;%= h.button :submit, :label =&gt; \"create\" %&gt;\n    &lt;% end %&gt;\n    &lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>Paper Controller\n\n\n  def new\n    @user = current_user\n    @paper = @user.paper.build(params[:paper])\n            @pen = Pen.new(params[:pen])\n  end\n</code></pre>\n\n<hr>\n\n<pre><code>  def create\n    @user = current_user\n    @paper = @user.papers.build(params[:paper])\n    @pen = @paper.pens.build(params[:pen])\n\n\n    if @paper.save\n        flash[:notice] = \"#{@paper.name} Created\"\n        redirect_to(:action =&gt; \"index\")\n    else\n        flash.now[:notice] = \"Error\"\n        render 'new'    \n    end\n  end\n</code></pre>\n\n<hr>\n\n<pre><code>{\"utf8\"=&gt;\"✓\",\n \"authenticity_token\"=&gt;\"Z8vncB9ewDM1bWiKfsPHOGlkxcGpfhPjv0xpamudIIs=\",\n \"paper\"=&gt;{\"name\"=&gt;\"three\",\n \"size\"=&gt;\"three\",\n \"colour\"=&gt;\"red\",\n \"pen\"=&gt;{\"colour\"=&gt;\"test\",\n \"pen\"=&gt;\"test\"}},\n \"commit\"=&gt;\"Create\"}\n</code></pre>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":38,"score":1,"question_id":12870364,"title":"Add Image to a table Ruby on Rails","body":"<p>I'm a RoR beginner and I can't seem to find a tutorial on the following thing:</p>\n\n<p>I want to add a picture for each of the tv shows in my database and then want to display the image by calling @show.image in my view (show being a tv show).\nFirst, what's the column content ? (I would assume a string, but I'm thinking there might be something more appropriate)\nSecond, is there a way that I won't need to add URL's manually to the DB ? Like if I could somehow specify that the image name is the same as the tv show's name ?</p>\n\n<p>My questions might be a bit confusing so please let me know if you cant understand what I mean!</p>\n\n<p>Cheers</p>\n"},{"tags":["ruby-on-rails-3","attributes"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12868400,"title":"check for updated attributes","body":"<p>How would i fix this code to update only if something has changed.\ni am updating using csv, i need to change the confirmation field but only if something in the record has changed.</p>\n\n<pre><code> CSV.parse(atdecode,{headers: true, col_sep:  \"|\", force_quotes:  true, quote_char: \"~\", converters: :date}) do |row|\n                                   @contracts = Contract.unscoped.where(:unique3 =&gt; row[0]).first_or_create\n                                   @contracts.update_attributes( {\n                                    unique3: row[0],\n                                    prntkey23: row[1],\n                                    prntkey13: row[2],\n                                    act_code: row[3],\n                                    accounting_confirmation_date: row[4],\n                                    act_form: row[5],\n                                    act_net: row[6],\n                                    agent: row[7],\n                                    act_booked: row[8]\n                                         })\n                                     if @contracts.changed?\n                           @contracts.update_attribute( {\n                           confirmation: 0\n                         })\n                       end\n                         end\n</code></pre>\n"},{"tags":["ruby-on-rails-3","paperclip","fields-for"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":49,"score":0,"question_id":12858528,"title":"Rails - Attaching image through paperclip on nested fields causes unwanted/unavoidable redirect_to","body":"<p>I have a form in my project for a model <code>Artworks</code> where I am using <code>fields_for</code> for a resource <code>Photo</code> where Artworks <code>has_many :photos</code>.</p>\n\n<p>The <code>Photo</code> model uses paperclip to attach images.</p>\n\n<p>All my forms are AJAX based, meaning the page should never be reloaded, and I shouldn't be using <code>redirect_to</code> anywhere in my controllers (and I'm not).</p>\n\n<p>When I include the <code>fields_for</code> in my form with the paperclip file_field, if I create or update the photo when I submit the form, I get the following error:</p>\n\n<pre><code>Template is missing\n\nMissing template artworks/show, application/show with {:locale=&gt;[:en], :formats=&gt;[:html], :handlers=&gt;[:erb, :builder, :coffee]}. Searched in: * \"/home/david/rails/piml_artwork/app/views\" * \"/home/david/.rvm/gems/ruby-1.9.3-p194/gems/devise-2.1.2/app/views\"\n</code></pre>\n\n<p>The destroy image checkbox functions as expected. Updating the rest of the details on the form and submitting it functions as expected, just returning an AJAX response and filling out the page.</p>\n\n<p>My artworks controller is as follows:</p>\n\n<pre><code>  class ArtworksController &lt; ApplicationController\n    before_filter :load\n\n    authorize_resource\n\n    respond_to :html, :json, :js\n\n    def load\n    end\n\n    def show\n      @artwork = Artwork.find(params[:id])\n    end\n\n    def index\n      @artworks = Artwork.all\n    end\n\n    def new\n      @artwork = Artwork.new\n      @artwork.photos.build unless @artwork.photos.count &gt; 0\n    end\n\n    def create\n      @artwork = Artwork.new(params[:artwork])\n      if @artwork.save\n        flash[:notice] = \"Artwork saved\"\n        @artworks = Artwork.all\n        respond_with @artwork\n      end\n    end\n\n    def edit\n      @artwork = Artwork.find(params[:id])\n      @artwork.photos.build unless @artwork.photos.count &gt; 0\n    end\n\n    def update\n      @artwork = Artwork.find(params[:id])\n      if @artwork.update_attributes(params[:artwork])\n        flash[:notice] = \"Artwork updated\"\n        @artworks = Artwork.all\n        respond_with @artwork\n      end\n    end\n\n    def destroy\n      @artwork = Artwork.find(params[:id])\n      @artwork.destroy\n      flash[:notice] = \"Artwork destroyed\"\n      @artworks = Artwork.all\n    end\n  end\n</code></pre>\n\n<p>The form causing the strife is this:</p>\n\n<pre><code>&lt;%= form_for( @artwork, remote: true, mutlipart: true ) do |f| %&gt;\n    &lt;%= render 'layouts/error_messages', object: f.object %&gt;\n    &lt;div id=\"artwork-title\"&gt;TITLE: &lt;%= f.text_field :title %&gt;&lt;/div&gt;\n    &lt;div id=\"artwork-title-underline\"&gt;&lt;/div&gt;\n    &lt;div id=\"artwork-show-picture\"&gt;&lt;%= image_tag @artwork.photos.first.photo.url(:medium) unless @artwork.photos.first.new_record? %&gt;\n        &lt;div id=\"artwork-picture-upload\"&gt;\n            &lt;%= f.fields_for :photos, remote: true, multipart: true do |p| %&gt;\n                &lt;% if p.object.new_record? %&gt;\n                    UPLOAD PHOTO\n                    &lt;%= p.file_field :photo, value: 'Upload Image' %&gt;\n                &lt;% else %&gt;\n                    REPLACE PHOTO\n                    &lt;%= p.file_field :photo, value: 'Replace Image' %&gt;\n                    &lt;br /&gt;\n                    &lt;br /&gt;\n                    &lt;%= p.check_box :_destroy %&gt;\n                    &lt;%= p.label :_destroy, 'Delete Image' %&gt;\n                &lt;% end %&gt;\n            &lt;% end %&gt; \n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div id=\"artwork-public\"&gt;\n        ARTIST&lt;br /&gt;\n        &lt;%= f.select :artist_id, Artist.select_list, include_blank: \"SELECT ARTIST\" %&gt;&lt;br /&gt;\n        &lt;br /&gt;\n        DATE OF WORK &lt;br /&gt;\n        &lt;%= f.text_field :date_of_work %&gt;&lt;br /&gt;\n        &lt;br /&gt;\n    &lt;div id=\"artwork-modify-buttons\"&gt;\n        &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>My JS file for update is:</p>\n\n<pre><code>    &lt;% if !@artwork.errors.any? %&gt;\n      $(\"#facebox .content\").html(\"&lt;%= escape_javascript(render(partial: \"/artworks/show\")) %&gt;\");\n      $(\"#artworks-col\").html(\" &lt;%= escape_javascript(render(partial: \"/admin/artworks_list\" )) %&gt;\")\n    &lt;% else %&gt;\n      $(\"#facebox .content\").html(\"&lt;%= escape_javascript(render(partial: \"/artworks/form\")) %&gt;\");\n    &lt;% end %&gt;\n</code></pre>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":3,"favorite_count":3,"up_vote_count":6,"down_vote_count":0,"view_count":1521,"score":6,"question_id":3954867,"title":"Rails - how to count lines of code?","body":"<p>I tried <code>rake stats</code> but that seems highly inaccurate. Perhaps it ignores several directories?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":2,"favorite_count":1,"up_vote_count":6,"down_vote_count":0,"view_count":1636,"score":6,"question_id":5240181,"title":"rails 3 route alias","body":"<p>In older version 2.x I was doing something like:</p>\n\n<pre><code>map.resources :jobs, :as =&gt; 'vagas'\n</code></pre>\n\n<p>and this way, I can use jobs_path to create a link to.</p>\n\n<p>But in rails 3, I still can use :as to define an alias, but I cannot\nuse jobs_path anymore, because it forces me to use vagas_path.</p>\n\n<p>So I was wondering if have any way to define an alias and still use\nthe original resource name to create a link. </p>\n"},{"tags":["ruby-on-rails-3","rails-migrations"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":42,"score":0,"question_id":12869117,"title":"Why is the user_id column of the database not being filled?","body":"<p>I have a table in the database called pcomment. Each pcomment belongs_to a purchase. A purchase has_many pcomments. additionally, each user has_many pcomments and each pcomment belongs_to user. In the database, the pcomments table has id/user_id/purchase_id/body/created_at/updated_at</p>\n\n<p>Everything is getting filled in correctly except for user_id is still always blank. I want it to be filled in with the user_id of the current signed in user (ie the one who is creating the pcomment.) Both the user_id and pcomment_id are indexed in the table with add_index (during the migration)</p>\n\n<p>Here is the form for the pcomment</p>\n\n<pre><code>  &lt;%= form_for([purchase, purchase.pcomments.build]) do |f| %&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;h4&gt;What deal are you offering?&lt;/h4&gt;\n      &lt;%= f.text_field :body %&gt;\n\n\n    &lt;/div&gt;\n\n\n  &lt;% end %&gt;\n</code></pre>\n\n<p>Here is the pcomments_controller.rb</p>\n\n<pre><code>class PcommentsController &lt; ApplicationController\n  before_filter :signed_in_user\n  def create\n    @purchase = Purchase.find(params[:purchase_id])\n    @pcomment = @purchase.pcomments.build(params[:pcomment])\n\n    @pcomment.purchase = @purchase\n\n    if @pcomment.save\n       flash[:success] = \"Offer submited!\"\n       redirect_to :back\n    else\n      render 'shared/_pcomment_form'\n    end\n  end\n\n  def new\n@pcomment=purchase.pcomments.new\n\n  end\n\n\nend\n</code></pre>\n\n<p>If you need more of my code it is at <a href=\"https://github.com/tradespring1/tradespring/\" rel=\"nofollow\">https://github.com/tradespring1/tradespring/</a></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2","form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":58,"score":1,"question_id":12869270,"title":"label in form_for","body":"<p>In my Rails 3.2 project, I have a form to create a new post in <code>new.html.erb</code> in <code>app/views/posts/</code></p>\n\n<pre><code>&lt;%= form_for(@post) do |post_form| %&gt;\n  ...\n  &lt;div class=\"field\"&gt;\n    &lt;%= post_form.label :title %&gt;&lt;br /&gt;\n    &lt;%= post_form.text_field :title %&gt;\n  &lt;/div&gt;\n ...\n  &lt;div class=\"actions\"&gt;\n    &lt;%= post_form.submit %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>I want to display the <code>title</code> label as <code>TITLE</code>, so I changed the code to <code>post_form.label :TITLE %&gt;</code>, but it still displays <code>Title</code>. How can I display it as <code>TITLE</code>?</p>\n"},{"tags":["ruby-on-rails-3","routing"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12868906,"title":"Rails - Cancelling a redirect_to call","body":"<p>I have a problem as per another open question I have <a href=\"http://stackoverflow.com/questions/12858528/rails-attaching-image-through-paperclip-on-nested-fields-causes-unwanted-unavo\">here</a> which I just need a quick fix for in the meantime so I can get onto the next bit of the project, and I'll move back to fix this properly later.</p>\n\n<p>I want to know, is there a way in rails to 'cancel' a <code>redirect_to</code> action if it was called earlier in a controller method? I don't want to do <code>redirect_to :nothing</code>, I just want to make it as if redirect_to wasn't called.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","rubygems","gem","bundler"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":48,"score":1,"question_id":12868488,"title":"Local Gem assets not updating","body":"<p>I've forked a gem, and in trying to change it, decided to change the the gemfile from my git repository (which had been updating fine):</p>\n\n<pre><code>gem 'bootstrap-wysihtml5-rails', :git =&gt; 'git://github.com/Asherlc/bootstrap-wysihtml5-rails.git'\n</code></pre>\n\n<p>to the local directory (just the cloned git repository):</p>\n\n<pre><code>gem 'bootstrap-wysihtml5-rails', :path =&gt; '/Users/ashercohen/Documents/bootstrap-wysihtml5-rails'\n</code></pre>\n\n<p>Upon running either <code>bundle update</code> or <code>bundle install</code>, it shows the correct version number (updated since switching gem sources) in the readout. However, none of the files in the <code>/vendor/assets</code>path seem to be getting updated in my Rails app. Is there some kind of caching thing I need to clear out?</p>\n\n<p>I don't have a <code>/vendor/cache</code> file in my Rails app, and I'm confident that since the gem version is updating correctly in the bundler readout that the path is correct.</p>\n\n<p>Is there some step I'm missing here?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":34,"score":0,"question_id":12867362,"title":"How do I assign a new object to both current_user and a has_one association?","body":"<p>I have a <code>Score</code> that belongs_to <code>Client</code> - and <code>Client</code> has_one <code>Score</code>. </p>\n\n<p>I also want to assign the <code>Score</code> to <code>User</code> on creation. So every time a <code>current_user</code> creates a score for a particular client, I want the <code>current_user.id</code> to be stored with that <code>Score</code> record.</p>\n\n<p>What is the best way to do that?</p>\n\n<p>I was thinking that an elegant way might be a <code>Score belongs_to User, :through Client</code> but that can't work.</p>\n\n<p>So I am assuming the best way is to just add <code>user_id</code> to the <code>Score</code> model, and do it like that.</p>\n\n<p>But then how do I assign the <code>user_id</code> in the <code>Score#create</code>?</p>\n\n<p>This is how my create action looks:</p>\n\n<pre><code>def create\n    @score = current_user.scores.new(params[:score])\n\nrespond_to do |format|\n  if @score.save\n    format.html { redirect_to @score, notice: 'Score was successfully created.' }\n    format.json { render json: @score, status: :created, location: @score }\n  else\n    format.html { render action: \"new\" }\n    format.json { render json: @score.errors, status: :unprocessable_entity }\n  end\nend\n</code></pre>\n\n<p>end</p>\n\n<p>This automatically assigns the current score to the <code>client_id</code> that is in the <code>params[:score]</code> hash - but it doesn't do the same for <code>user_id</code>.</p>\n\n<p>What gives?</p>\n"},{"tags":["ruby-on-rails-3","activerecord","database-connection","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":72,"score":0,"question_id":12864005,"title":"Rails connects to the database during the start of a HTTP/rack request","body":"<p>Is there a way to change this behavior? i.e make Rails lazily get the connection from the pool and not when the request comes in.</p>\n\n<p>We are using Postgres as a secondary source of data, so if that secondary source is down, app should not be affected and we want to rescue from that.</p>\n\n<p>Right now when postgres goes down, all requests get affected.</p>\n\n<p>Any inputs would be appreciated.</p>\n\n<pre><code>vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `initialize'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `new'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `connect'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:329:in `initialize'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:309:in `new_connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:319:in `checkout_new_connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:241:in `block (2 levels) in checkout'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:236:in `loop'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:236:in `block in checkout'\nvendor/ruby-1.9.3/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:233:in `checkout'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:96:in `block in connection'\nvendor/ruby-1.9.3/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:95:in `connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:404:in `retrieve_connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:170:in `retrieve_connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_specification.rb:144:in `connection'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/query_cache.rb:67:in `rescue in call'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/query_cache.rb:61:in `call'\nvendor/bundle/ruby/1.9.1/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nvendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `_run__1061097989250305020__call__4547997776545495741__callbacks'\nvendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'\nvendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nvendor/bundle/ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nvendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/rack/logger.rb:26:in `call_app'\nvendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/rack/logger.rb:16:in `call'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/request_id.rb:22:in `call'\nvendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'\nvendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'\nvendor/bundle/ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/middleware/static.rb:62:in `call'\nvendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/engine.rb:479:in `call'\nvendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/application.rb:223:in `call'\nvendor/bundle/ruby/1.9.1/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\nvendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/deflater.rb:13:in `call'\nvendor/bundle/ruby/1.9.1/gems/unicorn-4.4.0/lib/unicorn/http_server.rb:535:in `process_client'\nvendor/bundle/ruby/1.9.1/gems/unicorn-4.4.0/lib/unicorn/http_server.rb:610:in `worker_loop'\n</code></pre>\n"},{"tags":["ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":74,"score":1,"question_id":12859229,"title":"Rails not accounting for daylight savings time","body":"<pre><code>ActiveSupport::TimeZone.new(\"Pacific Time (US &amp; Canada)\")\n=&gt; (GMT-08:00) Pacific Time (US &amp; Canada)\n</code></pre>\n\n<p>...but right now, in LA it's GMT-07:00 because of DST. See <a href=\"http://www.timeanddate.com/worldclock/city.html?n=137\" rel=\"nofollow\">http://www.timeanddate.com/worldclock/city.html?n=137</a></p>\n\n<p>Is this a bug, an error in my settings, or am I creating the TimeZone object improperly? Can't seem to figure it out</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","gem"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":89,"score":2,"question_id":7882669,"title":"Rails is there a way to manage a ordered list? so that each item has a position, and if an element is deleted the positions automatically update?","body":"<p>Given the following:</p>\n\n<p>ListItem (position, title)</p>\n\n<pre><code>1,hello\n2,hello2\n3,hello3\n4,hello4\n5,hello5\n</code></pre>\n\n<p>If the 3rd item, 3,hello3 was deleted, is there a way for the positions to automatically update, ie, position 5 would now be position 4?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","salesforce","databasedotcom-gem"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":41,"score":0,"question_id":12863922,"title":"Salesforce: Possible to use \"describeLayout\" function from REST API?","body":"<p>I know <code>describeLayout</code> is accessible from the SOAP API, but is it possible to access it from the REST API as well? I'm particularly interested in accessing this function using the <a href=\"https://github.com/heroku/databasedotcom\" rel=\"nofollow\">databasedotcom</a> Ruby gem.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","devise"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":234,"score":0,"question_id":9778452,"title":"How to skip the need to confirm an email address update with devise?","body":"<p>I'm using Rails 3 with the new devise confirmable.</p>\n\n<p>I want to have users generally confirm their email address. When creating a new user I can skip the confirmation email with:</p>\n\n<pre><code>user.skip_confirmation!\n</code></pre>\n\n<p>However, sometimes I need to manually change an email on behalf of a user. And this does not appear to work when changing emails. example:</p>\n\n<pre><code>@user = User.find_by_email('bob@site.com')\n@user.email = 'dead@site.com'\n@user.skip_confirmation!\n@user.save!\n</code></pre>\n\n<p>This still requires the user to confirm the email. THe email is not being updated. And devise is sending out an email.</p>\n\n<p>Any ideas? Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","ruby-on-rails-3.2"],"answer_count":1,"favorite_count":0,"up_vote_count":5,"down_vote_count":0,"view_count":89,"score":5,"question_id":12867072,"title":"String length difference between ruby 1.8 and 1.9","body":"<p>I have a website thats running on ruby 1.8.7 . I have a validation on an incoming post that checks to make sure that we allow  upto max of 12000 characters. The spaces are counted as characters and tab and carriage returns are stripped off before the post is subjected to the validation.</p>\n\n<p>Here is the post that is subjected to validation <a href=\"http://pastie.org/5047582\">http://pastie.org/5047582</a></p>\n\n<p>In ruby 1.9 the string length shows up as 11909 which is correct. But when I check the length on ruby 1.8.7 is turns out to be 12044.</p>\n\n<p>I used codepad.org to run this ruby code which gives me <a href=\"http://codepad.org/OxgSuKGZ\">http://codepad.org/OxgSuKGZ</a> ( which outputs the length as 12044 which is wrong) but when i run this same code in the console at codeacademy.org the string length is 11909.</p>\n\n<p>Can anybody explain me why this is happening ???</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":50,"score":1,"question_id":12867481,"title":"Evaluating iterator inside each do block in controller","body":"<p>I am trying to iterate through my array separated by white space:</p>\n\n<pre><code>diff_attr = []\n\n%w[name hours].each do |a|\n  if @old_place.a != new_place[a.to_sym]\n    diff_attr &lt;&lt; a\n  end\nend\n</code></pre>\n\n<p>I want to compare attributes (name and hours) of two different objects. Right now, I'm getting an undefined method 'a' error. Right now, a is being evaluated as a method of @old_place instead of as a variable.</p>\n\n<p>How do I evaluate the iterator inside the block so that I'm comparing:</p>\n\n<p><code>@old.place.name != new_place[:name]</code></p>\n\n<p>instead of</p>\n\n<p><code>@old.place.a != new_place[:a]</code></p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","rake"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":42,"score":2,"question_id":12865776,"title":"Rake task for installing gem migrations executing only once","body":"<p>Why does this rake task</p>\n\n<pre><code>gems = %w(gem1 gem2 gem3)\nnamespace :gems do\n  namespace :install do\n    desc \"Runs install:migrations for all gems\"\n    task :migrations do\n      gems.each do |gem_name|\n        print \"\\nInstalling migrations for the #{gem_name} gem...\\n\"\n        Rake::Task[\"#{gem_name}:install:migrations\"].invoke\n      end\n      print \"\\n\\nGem migrations installed.\"\n    end\n  end\nend\n</code></pre>\n\n<p>only actually run the first set of migrations, no matter the gems/gem ordering/random calls to reenable I use?</p>\n\n<pre><code>Installing migrations for the gem1 gem...\nCopied migration whatever from gem1\nCopied migration whatever from gem1\nCopied migration whatever from gem1\nCopied migration whatever from gem1\n\nInstalling migrations for the gem2 gem...\n(nothing)\n\nInstalling migrations for the gem3 gem...\n(nothing)\n\nGem migrations installed.\n</code></pre>\n"},{"tags":["jquery","ruby-on-rails","ruby-on-rails-3","form-for"],"answer_count":1,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":64,"score":2,"question_id":12830733,"title":"Creating and passing array from a form to controller using jquery","body":"<p>I have a form (form_for) and I want the user to be able to select multiple \"categories\" using the select method.</p>\n\n<pre><code>= form_for @place, :url=&gt;{:action=&gt;\"#\"} do |f|\n  #appended_wrapper\n  .categories\n    = f.label :categories, \"Categories: \"\n    = f.select :categories, %w(Active Art Auto Food), {:include_blank =&gt; true}\n  = f.submit \"Submit\"\n</code></pre>\n\n<p>Everytime the user selects a category, I have jQuery append a div with the value of the category so that users can see and remove the categories they've added.</p>\n\n<pre><code>$('#hotel_categories').change(function(){\n  value = $(this).val();\n  $('#appended_wrapper').append( '&lt;div class=\"appended\"&gt; '+value+' &lt;a class=\"remove\" href=\"#\"&gt;Remove&lt;/a&gt;&lt;/div&gt;' );\n\n  $('.remove').click(function(){\n    $(this).parent(\".appended\").remove();\n  });\n\n});\n</code></pre>\n\n<p>When I press the submit button, I want all the selected categories to be passed to my controller in an array.</p>\n\n<p>How do I achieve this?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","mvc","redirect","controller"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":24,"score":0,"question_id":12867272,"title":"Rails 310 Redirect Loop","body":"<p>I'm going back to write a basic app with projects that have tasks.  In my show view of a project I want to list the tasks and also include a form.  When I wire this all up I get 310 Redirect loop.  It's been a while since I've written anything from scratch so would appreciate some help looking at my code.</p>\n\n<p>controller code:</p>\n\n<pre><code>def show\n     @project = Project.find(params[:id])\n     @task = @project.tasks.new(params[:task])\n\n     if @task.save\n         redirect_to @project, :notice =&gt; \"Task added\"\n       else\n         render action: :show\n       end\n   end\n</code></pre>\n\n<p>view code:</p>\n\n<pre><code>&lt;%= @project.project_name %&gt;\n&lt;%= form_for(@task) do |m| %&gt;\n&lt;%= m.label :Task %&gt;\n&lt;%= m.text_field :task_name %&gt;\n&lt;%= m.button :submit %&gt;\n&lt;% end %&gt;\n&lt;% @project.tasks.each do |t| %&gt;\n  &lt;%= t.task_name %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>project.rb</p>\n\n<pre><code>has_many :tasks\n</code></pre>\n\n<p>task.rb</p>\n\n<pre><code>belongs_to :project\n</code></pre>\n"},{"tags":["ruby-on-rails-3","forms","activerecord","select"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":21,"score":0,"question_id":12861110,"title":"Select all or single objects from collection_select in Rails","body":"<p>I have an app that sends \"pages\" via actionmailer.  In my view code I have it setup to select a particular unit which then has medics assigned who get the email/page.  I want to include an option to page all units in my select statement but am not sure how to do it.</p>\n\n<p>view/form code:</p>\n\n<pre><code>&lt;%= form_for(@page) do |f| %&gt;\n\n  &lt;%= f.label :message %&gt;\n  &lt;%= f.text_field :message %&gt;\n\n  &lt;%= f.label 'Medic'%&gt;\n\n  &lt;%= f.collection_select(:unit_id, Unit.order(\"unit_name ASC\"), :id, :unit_name, {}, {:class =&gt; 'select'})%&gt;\n\n&lt;%= f.button :send, :class =&gt; 'btn btn-info' %&gt;\n\n&lt;% end %&gt;\n</code></pre>\n\n<p>controller code:</p>\n\n<pre><code>def create\n\n    @page = Paging.new(params[:paging])\n    unit = Unit.find(params[:paging][:unit_id])\n    message = params[:paging][:message]\n\n\n     if @page.save\n       PagingsMailer.paging(unit.incharge, unit, message).deliver\n       PagingsMailer.paging(unit.attendant, unit, message).deliver\n       redirect_to pagings_path, notice: \"Page was successfully sent.\"\n      else\n        redirect_to pagings_path\n     end\n  end\n</code></pre>\n\n<p>The option can be in the select itself or as another select/checkbox so long as the original select is ignored.</p>\n\n<p>Any help with this is appreciated.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":38,"score":0,"question_id":12866778,"title":"Does a Rails plugin exist to build a show page (like a formbuilder)","body":"<p>I'm looking for a Rails plugin providing a builder for <code>show.html.erb</code> pages.</p>\n\n<p>For example, with SimpleForm, an <code>new.html.erb</code> page might look like this :</p>\n\n<pre><code>&lt;%= simple_form_for(@user, :url =&gt; user_registration_path, :html =&gt; ... }) do |f| %&gt;\n  &lt;%= f.input :email, :required =&gt; true %&gt;\n  &lt;%= f.input :password, :required =&gt; true %&gt;\n  &lt;%= f.input :password_confirmation, :required =&gt; true %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>But I was not able to find an equivalent for just displaying fields.</p>\n\n<p>A generated <code>show.html.erb</code> page looks like :</p>\n\n<pre><code>&lt;p&gt;\n  &lt;b&gt;Email:&lt;/b&gt;\n  &lt;%= @user.email %&gt;\n&lt;/p&gt;\n...\n</code></pre>\n\n<p>But I'd like something like :</p>\n\n<pre><code>&lt;%= simple_display_for(@user, :html =&gt; ... }) do |d| %&gt;\n  &lt;%= d.output :email %&gt;\n  &lt;%= d.output :name %&gt;\n  ...\n&lt;% end %&gt;\n</code></pre>\n\n<p>Does this kind of builder exist?</p>\n\n<p>Thanks</p>\n\n<p><strong>EDIT</strong> : If the builder use Twitter Bootstrap, that's even better :)</p>\n"},{"tags":["ruby-on-rails-3","cucumber"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":59,"score":1,"question_id":12828414,"title":"Cucumber: undefined method error for path on visit","body":"<p>I have a cucumber step </p>\n\n<pre><code>When /^I go to the Add Suggestions form$/ do\n  visit new_manage_suggestions_path\nend\n</code></pre>\n\n<p>and a route</p>\n\n<pre><code>namespace \"manage\" do\n  resource :suggestions\nend\n</code></pre>\n\n<p>rake routes outputs</p>\n\n<pre><code>manage_suggestions POST /manage suggestions(.:format) manage/suggestions#create\n</code></pre>\n\n<p>When I run cucumber I get</p>\n\n<pre><code>undefined method `suggestions_path' for #&lt;#&lt;Class:0x000000064a4768&gt;:0x000000064accd8&gt; (ActionView::Template::Error)\n</code></pre>\n\n<p>Why is cucumber trying that path?</p>\n\n<p>The <code>new_manage_suggestions_path</code> works fine in my app, I have a link that uses it and that is working fine.</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":28,"score":0,"question_id":12866804,"title":"Insert lots of records in one go in a many to many relationship with additional attributes on the join table","body":"<p>I have two models <strong>A</strong> and <strong>B</strong> that are in a many-to-many relationship with a join table <strong>AB</strong>. The <strong>AB</strong> table also has an attibute, <strong><em>attr</em></strong>, in addition to the usual <strong>a_id</strong> and <strong>b_id</strong>.</p>\n\n<p>I have about 10,000 records to insert. I tried the naïve way: take one <em>a</em>, loop through the <em>bs</em>, create the <em>ab</em> association, populate the association's <em>attr</em>, save the association, go to next item... but this takes forever as there are 10,000 separate insertions that cannot go into one big transaction. </p>\n\n<p>Is there a way to speed this up? I'm using sqlite as DBMS at the moment but if switching to another DBMS is part of the solution this is totally an option.</p>\n"},{"tags":["ruby-on-rails","ruby","linux","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":283,"score":1,"question_id":12136900,"title":"Cannot run rails server","body":"<p>I am starting to learn Ruby on Rails but have been stuck at the basic installation part for 2 days now. I was following a tutorial which mentions starting the server with the <code>rails server</code> command.</p>\n\n<p>Running this command, I get the following output:</p>\n\n<pre><code>$ rails server\n/home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect': Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs.rb:5:in `&lt;module:ExecJS&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/execjs-1.4.0/lib/execjs.rb:4:in `&lt;top (required)&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `&lt;top (required)&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `&lt;top (required)&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `&lt;top (required)&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in `require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in `block (2 levels) in require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in `each'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in `block in require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:55:in `each'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:55:in `require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler.rb:119:in `require'\n    from /home/niranjan/fourth_app/config/application.rb:7:in `&lt;top (required)&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:53:in `require'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:53:in `block in &lt;top (required)&gt;'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'\n    from /home/niranjan/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.8/lib/rails/commands.rb:50:in `&lt;top (required)&gt;'\n    from script/rails:6:in `require'\n    from script/rails:6:in `&lt;main&gt;'\n</code></pre>\n\n<p>I have been having several different problems and I have done <code>rvm implode</code> and reinstall several times. I have the rvm scripts in the PATH variable. </p>\n\n<pre><code>$ rvm -v\n\nrvm 1.15.7 (stable) by Wayne E. Seguin &lt;wayneeseguin@gmail.com&gt;, Michal Papis &lt;mpapis@gmail.com&gt; [https://rvm.io/]\n\n $ ruby -v\nruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]\n\n\n$ rails -v\nRails 3.2.8\n</code></pre>\n\n<p>I am using Linux Mint 12. Any help/suggestion would be appreciated.</p>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","github","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":32,"score":1,"question_id":12864986,"title":"How to unpack a gem from github and specify the branch?","body":"<p>in my gemfile I use a gem that points to git and a specific branch. How can I unpack a gem in my vendors/gem folder and specify the branch like so?</p>\n\n<pre><code>gem 'devise-async', :git =&gt; 'git://github.com/mhfs/devise-async.git', :branch =&gt; 'master'\n</code></pre>\n\n<p>Thanks</p>\n"},{"tags":["ruby-on-rails-3","pagination","kaminari"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":505,"score":1,"question_id":6809951,"title":"Paginate by most recent post with kaminari","body":"<p>I'm using the rails gem kaminari (https://github.com/amatsuda/kaminari) in order to paginate my posts database. Currently I have the code <code>@posts = Post.order('id').page(params[:page]).per(5)</code> in my controller, but this orders the pages from earliest to most recent. How do I reverse this and order from most recent to earliest?</p>\n"},{"tags":["ruby-on-rails-3"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":1,"view_count":43,"score":-1,"question_id":12856297,"title":"Why am I getting this error: undefined method `user_id' for nil:NilClass","body":"<p>I have a form that creates a pcomment on a purchase (kind of like a comment on a post) Here is the form </p>\n\n<pre><code>  &lt;%= form_for([purchase, purchase.pcomments.build(:user_id =&gt; @user.user_id)], :html =&gt; { :id =&gt; \"blah_form\" }) do |f| %&gt;\n\n    &lt;div class=\"field\"&gt;\n      &lt;h4&gt;What deal are you offering?&lt;/h4&gt;\n      &lt;%= f.text_field :body %&gt;\n\n\n    &lt;/div&gt;\n\n\n  &lt;% end %&gt;\n</code></pre>\n\n<p>I am trying to fill in the :user_id which is a column in the pcomments table in the database. It tells me that the user_id is undefined for nil:Nil class. So This means that the @user is not being well defined. I want @user to represent the current user. Here is what I have in the pcomments_controller.rb I feel like @user is defined under the create action (create a pcomment). </p>\n\n<pre><code>class PcommentsController &lt; ApplicationController\n  before_filter :signed_in_user\n  def create\n    @purchase = Purchase.find(params[:purchase_id])\n    @pcomment = @purchase.pcomments.build(params[:pcomment])\n    @user= User.find(params[:id])\n    @pcomment.purchase = @purchase\n\n    if @pcomment.save\n       flash[:success] = \"Offer submited!\"\n       redirect_to :back\n    else\n      render 'shared/_pcomment_form'\n    end\n  end\n\n  def new\n    @pcomment=purchase.pcomments.new\n    @user=User.find(params[:id])\n  end\n\n\nend\n</code></pre>\n\n<p>If you need any more of the code it is at <a href=\"https://github.com/tradespring1/tradespring/\" rel=\"nofollow\">https://github.com/tradespring1/tradespring/</a></p>\n"},{"tags":["javascript","sql","ruby-on-rails-3","jruby","user-tracking"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":30,"score":0,"question_id":12865727,"title":"How to implement user tracking in JRuby on Rails?","body":"<p>In our rails app we wish to track which pages a user visits, how often they visit a page, which page they came from and how often they perform specific actions in our app (save/load/edit/etc).</p>\n\n<p>We plan to wipe our ActiveRecord database very often, likely every few days, so storing that kind of data using ActiveRecord probably won't work for us, unless ActiveRecord can add entries to an entirely different database from our production database. I understand that multiple databases are possible in ActiveRecord but from everything I've read about it, it seems hacky and overlycomplicated.</p>\n\n<p>My initial thought was to add entries to a sql database using jruby and run queries on the db to get what we need out of it. The database would remain persistent and entirely separate from our production database. I don't know how this may effect performance. We don't yet know the size of our user base or the frequency of their usage.</p>\n\n<p>Of the gems I looked at for this task, most were concerned with tracking how the models change inside the production db which probably isn't what we want.</p>\n\n<p>What's a good way to go with all of this?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":2,"up_vote_count":6,"down_vote_count":1,"view_count":119,"score":5,"question_id":8091063,"title":"What are some good resources for learning the Rails codebase internals?","body":"<p>I have been developing in Rails for about 3 years now, and would like to learn more about the Rails internals themselves.  Rails 3 supposedly provides nice API's for integrating more closely with Rails, but I'm having a hard time finding documentation on how to use them.  Here are some examples of what i'm looking for:</p>\n\n<p>Rails Initialization Process\n<a href=\"http://guides.rubyonrails.org/initialization.html\">http://guides.rubyonrails.org/initialization.html</a></p>\n\n<p>Arel Walkthrough\n<a href=\"http://railscasts.com/episodes/239-activerecord-relation-walkthrough\">http://railscasts.com/episodes/239-activerecord-relation-walkthrough</a></p>\n\n<p>Routing Walkthrough\n<a href=\"http://railscasts.com/episodes/231-routing-walkthrough\">http://railscasts.com/episodes/231-routing-walkthrough</a>\nhttp://railscasts.com/episodes/232-routing-walkthrough-part-2</p>\n\n<p>Crafting Rails Applications\n<a href=\"http://pragprog.com/book/jvrails/crafting-rails-applications\">http://pragprog.com/book/jvrails/crafting-rails-applications</a></p>\n\n<p>Are there any other good resources that an help as a guided tour of how Rails works?\n(and please don't say read the source code..    I'm looking for a more guided explanation)</p>\n"},{"tags":["ruby-on-rails-3","webserver","rubymine","webrick"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":53,"score":0,"question_id":12865006,"title":"Rails server fails to start with exit code 1 in rubymine","body":"<p>I was using my server yesterday no problem. Came back today with an error when starting the server</p>\n\n<pre><code>runnerw.exe C:\\Ruby187\\bin\\ruby.exe -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) \"C:/Users/Stefan/RubymineProjects/gallery/gallery-app/script/rails\" server -b 127.0.0.1 -p 3000 -e development\n=&gt; Booting WEBrick\n=&gt; Rails 3.2.8 application starting in development on http://127.0.0.1:3000\n=&gt; Call with -d to detach\n=&gt; Ctrl-C to shutdown server\nExiting\nC:/Ruby187/lib/ruby/gems/1.8/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:278:in `eval_block': C:/Ruby187/lib/ruby/gems/1.8/gems/actionpack-3.2.8/lib/action_dispatch/routing/mapper.rb:1508: syntax error, unexpected kEND, expecting $end (SyntaxError)\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:297:in `clear!'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:297:in `each'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:297:in `clear!'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:35:in `clear!'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:33:in `each'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:33:in `clear!'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:15:in `reload!'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:26:in `updater'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/file_update_checker.rb:78:in `call'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/file_update_checker.rb:78:in `execute'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:27:in `updater'\n    from C:0:in `execute_if_updated'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/finisher.rb:66\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `run_initializers'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `send'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from C:/Users/Stefan/RubymineProjects/gallery/gallery-app/config/environment.rb:5\n    from C:/Users/Stefan/RubymineProjects/gallery/gallery-app/config.ru:4:in `require'\n    from C:/Users/Stefan/RubymineProjects/gallery/gallery-app/config.ru:4\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'\n    from C:/Ruby187/lib/ruby/gems/1.8/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'\n    from C:/Users/Stefan/RubymineProjects/gallery/gallery-app/config.ru:1:in `new'\n    from C:/Users/Stefan/RubymineProjects/gallery/gallery-app/config.ru:1\n\nProcess finished with exit code 1\n</code></pre>\n\n<p>Not sure what could be causing this and it's baffling me why its only now decided to pop up.</p>\n"},{"tags":["ruby-on-rails-3","date","timezone"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":243,"score":2,"question_id":10100456,"title":"Rails daylight savings time not accounted for when using DateTime.strptime","body":"<p>I've been working on parsing strings and I have a test case that has been causing problems for me. When parsing a date/time string with strptime, Daylight Savings Time is NOT accounted for. This is a bug as far as I can tell. I can't find any docs on this bug. Here is a test case in the Rails console. This is ruby 1.9.3-p215 and Rails 3.2.2.  </p>\n\n<pre><code>1.9.3-p125 :049 &gt;   dt = DateTime.strptime(\"2012-04-15 10:00 Central Time (US &amp; Canada)\", \"%Y-%m-%d %H:%M %Z\")  \n=&gt; Sun, 15 Apr 2012 10:00:00 -0600  \n1.9.3-p125 :050 &gt; dt = DateTime.strptime(\"2012-04-15 10:00 Central Time (US &amp; Canada)\", \"%Y-%m-%d %H:%M %Z\").utc  \n=&gt; Sun, 15 Apr 2012 16:00:00 +0000  \n1.9.3-p125 :051 &gt; dt = DateTime.strptime(\"2012-04-15 10:00 Central Time (US &amp; Canada)\", \"%Y-%m-%d %H:%M %Z\").utc.in_time_zone(\"Central Time (US &amp; Canada)\")  \n=&gt; Sun, 15 Apr 2012 11:00:00 CDT -05:00  \n</code></pre>\n\n<p>As you can see, I have to convert to utc and then back to the timezone to get DST to be properly interpreted, but then the time is shifted one hour as well, so it's not what I parsed out of the string. Does someone have a workaround to this bug or a more robust way of parsing a date + time + timezone reliably into a DateTime object where daylight savings time is properly represented? Thank you.  </p>\n\n<p>Edit:\nOk, I found a workaround, although I'm not sure how robust it is.</p>\n\n<p>Here is an example: </p>\n\n<pre><code>ActiveSupport::TimeZone[\"Central Time (US &amp; Canada)\"].parse \"2012-04-15 10:00\"  \n</code></pre>\n\n<p>This parses the date/time string into the correct timezone. I'm not sure how robust the parse method is for handling this so I'd like to see if there is a better workaround, but this is my method so far.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12864426,"title":"Rails 3 sessions not lazy loading","body":"<p>I've read that sessions in Rails 3 are lazy loaded, but I'm not seeing that behavior. To test this, I created a new Rails 3.2 app using MySQL and the activerecord session store. No gems added except the V8 JavaScript engine. Then I created an empty controller called welcome with an index action. No code in here at all. When I hit the index page, I see a session created in the sessions table in MySQL. </p>\n\n<p>Am I doing something wrong? I thought a session would only be created if I accessed it.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","twitter-bootstrap"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":58,"score":0,"question_id":12706962,"title":"Extend rails simpleform functionality","body":"<p>I have a rails app with the \"simpleform\" and \"bootstrap-datepicker-rails\" gems.</p>\n\n<p>I try to make the view code more readable like this: </p>\n\n<pre><code>f.input :birthday, :mydatefield, :options =&gt; {:icon =&gt; \"calendar\", :data-date =&gt; \"21.12.2012\", :data-format =&gt; \"dd-mm-yyyy\"}\n</code></pre>\n\n<p>At this moment I write this:</p>\n\n<pre><code>&lt;div class=\"input-append date\" id=\"user_birthday\" data-date=\"12-02-2012\" data-date-format=\"dd-mm-yyyy\"&gt;\n    &lt;%= f.input_field :birthday, :disabled =&gt; true %&gt;\n    &lt;span class=\"add-on\"&gt;\n        &lt;i class=\"icon-calendar\"&gt;&lt;/i&gt;\n    &lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>or this</p>\n\n<pre><code>&lt;%= f.input :birthday, :wrapper =&gt; :datepicker, :wrapper_html=&gt; {id: \"user-birthday\", class: \"date\"} do %&gt;\n    &lt;%= f.input_field :birthday, :disabled =&gt; true %&gt;\n    &lt;%= content_tag :span, :class =&gt; \"add-on\" do %&gt;\n        &lt;%= content_tag :i, :style =&gt; \"color:grey\", :class =&gt; \"icon-calendar\" do\n        end %&gt;\n    &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>to get my result:</p>\n\n<p><img src=\"http://i.stack.imgur.com/P2C6i.png\" alt=\"Simpleform with bootstrap icon and datepicker\"></p>\n\n<p>Both of above are making this result, which works well:</p>\n\n<pre><code>&lt;div class=\"control-group string required date\" id=\"user-birthday\"&gt;\n    &lt;label class=\"string required control-label\" for=\"user_birthday\"&gt;&lt;abbr title=\"required\"&gt;*&lt;/abbr&gt; Birthday&lt;/label&gt;\n    &lt;div class=\"controls\"&gt;\n        &lt;div class=\"input-append\"&gt;\n            &lt;input class=\"string required disabled\" disabled=\"disabled\" id=\"user_birthday\" name=\"user[birthday]\" size=\"50\" type=\"text\" /&gt;\n            &lt;span class=\"add-on\"&gt;\n                &lt;i class=\"icon-calendar\" style=\"color:grey\"&gt;&lt;/i&gt;\n            &lt;/span&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>When I try to parse variables to the wrapper</p>\n\n<pre><code>:wrapper_html=&gt; =&gt; {:data-date =&gt; \"21-12-2012\"}\n</code></pre>\n\n<p>it throw errors...</p>\n\n<p>What I have to do? I am quite new on extending gems.</p>\n\n<p>What I have to write to get this working?</p>\n\n<ul>\n<li>SimpleForm Wrapper?</li>\n<li>app/inputs/datepickerInput.rb?</li>\n<li>initializer/datepicker.rb?</li>\n<li>Helper Method?</li>\n</ul>\n\n<p>An example will be VERY helpful!</p>\n\n<p>Many thanks in advance!</p>\n"},{"tags":["ruby-on-rails-3","rspec","factory-girl"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":50,"score":0,"question_id":12860293,"title":"Destroy method failing in controller test","body":"<p>I'm experiencing a bizarre issue testing a <code>destroy</code> method. I'm using FactoryGirl and Rspec.</p>\n\n<p>Here's a look at the method in question. As you can see, it doesn't actually destroy the dealer, just set it and it's dependent object's <code>active</code> attributes to <code>false</code>:</p>\n\n<p>dealers_controller.rb</p>\n\n<pre><code>def destroy\n  @dealer = Dealer.find(params[:id])\n  @dealer.active = false\n  @dealer.save!\n  @dealer.leads.each { |lead|\n    lead.active = false\n    lead.save!\n  }\n  @dealer.users.each { |user|\n    user.active = false\n    user.save!\n  }\n  redirect_to dealers_path\nend\n</code></pre>\n\n<p>When I run this method in the application it does exactly what it should do. Now, on to the test.</p>\n\n<p>dealers_controller_spec.rb</p>\n\n<pre><code>describe \"#destroy\" do\n  context \"when deleting a valid record\" do\n    let(:dealer) { FactoryGirl.create(:dealer_with_stuff) }  \n\n    before do\n      @user = FactoryGirl.build(:admin_user)\n      login_user  \n      delete :destroy, :id =&gt; dealer.id\n    end\n    it { should assign_to(:dealer).with(dealer) }\n    it { should redirect_to(dealers_path) }\n    it { should set_the_flash }\n    it \"is no longer active\" do\n      dealer.active.should be_false\n    end\n    it \"has no active users\" do\n      dealer.users.each do |user|\n        user.active.should be_false\n      end\n    end\n    it \"has no active leads\" do\n      dealer.leads.each do |lead|\n        lead.active.should be_false\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>The first 3 tests pass, but the last 3 all fail (weirdly, the <code>user.active.should be_false</code> test only fails if I put a <code>sleep(10)</code> after <code>delete :destroy</code> up above, but let's not get into that issue now). So when I check the test log, it goes through the entire destroy process, but then does a <code>ROLLBACK</code>, so for some reason it doesn't save any of the records; but it doesn't give me any more information than that.</p>\n\n<p>Does anyone have any thoughts on this? I've tried everything I can possibly think of.</p>\n"},{"tags":["jquery","ajax","ruby-on-rails-3","edit-in-place"],"answer_count":2,"favorite_count":0,"up_vote_count":2,"down_vote_count":0,"view_count":2159,"score":2,"question_id":4136948,"title":"Rails 3 In-Place Editing","body":"<p>I'm trying to implement in-place editing in a Rails 3 app that takes the edited value and revises a calculation based on that value.  For example:</p>\n\n<blockquote>\n  <p>Before edit of the \"credits to donate\" field:<br>\n  You have 10 credits remaining.  Credits to donate: 0.</p>\n  \n  <p>After edit of the \"credits to donate\" field:<br>\n  You have 5 credits remaining.  Credits to donate: 5.</p>\n</blockquote>\n\n<p>I have looked into various options, and it looks like the jquery-in-place-editor does what I'm looking for.  For reference:</p>\n\n<ul>\n<li><a href=\"http://code.google.com/p/jquery-in-place-editor/\" rel=\"nofollow\">jQuery-in-place-editor code</a></li>\n<li><a href=\"http://simple-autumn-67.heroku.com/\" rel=\"nofollow\">Sample Rails app</a></li>\n<li><a href=\"https://github.com/curiousyogurt/in_place_editing\" rel=\"nofollow\">Github Repo of Sample Rails app</a></li>\n</ul>\n\n<p>The demo works.  But I think what I need to do is use the callback function to call a ruby script, so I can do some more processing.  I'm not entirely sure if that's what I need to do though, so I'm looking for some guidance.</p>\n\n<p>Here is the jQuery javascript (from <a href=\"https://github.com/curiousyogurt/in_place_editing/blob/master/public/javascripts/application.js\" rel=\"nofollow\">/public/javascripts/application.js</a> in the Sample app) that I think is relevant:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>// Using a callback function to update 2 divs\n$(\"#editme4\").editInPlace({\n    callback: function(original_element, html, original){\n        $(\"#updateDiv1\").html(\"The original html was: \" + original);\n        $(\"#updateDiv2\").html(\"The updated text is: \" + html);\n        return(html);\n    }\n});\n</code></pre>\n\n<p>It looks like what I need to do is take <code>original</code> and <code>html</code> and play around with them a bit, then feed them back to the appropriate divs.  The question is, how do I do this?  I'm thinking of two possibilities:</p>\n\n<p><strong>A.</strong> There is a facility in the jquery-in-place-editor to call a url.  Could I use this to call a ruby script and get a result?  How would I do this in rails?  Here is code to call a url (again from <code>/public/javascripts/application.js</code>); but it calls a php script.</p>\n\n<pre><code>$(\"#editme1\").editInPlace({\n    // callback: function(unused, enteredText) { return enteredText; },\n    url: 'server.php',\n    show_buttons: true\n});\n</code></pre>\n\n<p><strong>B.</strong> Modify the updated text directly in javascript, and pass it to the appropriate divs.  I'd prefer to use a ruby script, but maybe this would be easier.</p>\n"},{"tags":["javascript","ruby-on-rails-3","deferred-execution"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":40,"score":0,"question_id":12863905,"title":"Rails 3 - how to defer parsing of JavaScript","body":"<p>I am trying to optimize my website and one of the suggestions I got was to defer parsing of JavaScript. I have googled it for a couple of hours but I haven't come across an elegant solution to do this in Rails 3. I am using the standard </p>\n\n<pre><code>&lt;%= javascript_include_tag :application -%&gt;\n</code></pre>\n\n<p>tag in my code, just before . Does anybody know a relatively simple way to defer the loading of all the Javascript of the application.js file? Thanks.</p>\n"},{"tags":["performance","ruby-on-rails-3","windows-7","cygwin","mingw"],"answer_count":2,"favorite_count":1,"up_vote_count":2,"down_vote_count":0,"view_count":880,"score":2,"question_id":7276993,"title":"Improve Ruby on Rails Performance Windows 7","body":"<p>I'm pursuing Ruby on Rails development but using windows to perform rake and rails tasks is PAINFULLY slow, but I heard it's quite the opposite on Linux.</p>\n\n<p>I'm using a Netbook (Acer Aspire One 722) for development and using VirtualBox to run Ubuntu is out of the question. Doing the whole dual boot thing is also not an option because I run into severe processor load balancing and heating issues that I really do not have the luxury of time to troubleshoot right now.</p>\n\n<p>What I would like to know is: is there anything I can install or any settings I can change that will give me linux-like speed when performing these rake and rails tasks on windows 7?</p>\n\n<p>I've heard that Cygwin and Mingw are \"linux emulators\", is there any way I could leverage them?</p>\n\n<p>Thanks.</p>\n"},{"tags":["ruby-on-rails-3","nginx","unicorn"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":104,"score":0,"question_id":12828693,"title":"Nginx and Unicorn, multiple rails apps","body":"<p>How can I host multiple rails apps with nginx and unicorn? I currently got one site up and running thanks for Rayen Bates screencasts (<a href=\"http://railscasts.com/episodes/335-deploying-to-a-vps\" rel=\"nofollow\">http://railscasts.com/episodes/335-deploying-to-a-vps</a>), without it I would probably not even have a server up.\nI have searched but i need a step by step guide to get this working. The results i have found are not so well explained to make me understand how to accomplish this.\nThanks</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":54,"score":0,"question_id":12862734,"title":"Pass arguments to Ruby when running Rails","body":"<p>When I run <code>rails server</code>, <code>rails console</code>, <code>rails runner</code>, etc., I want to pass some command-line switches to the Ruby binary. (In my case it's JRuby and I want to make sure Java starts up with more memory, but this question seems like it could apply to any Ruby implementation.) Surprisingly I can't find any documentation about this. Anyone know how to do it?</p>\n"},{"tags":["ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":27,"score":0,"question_id":12718385,"title":"destroy belongs_to leaves FK","body":"<p>I have a model:</p>\n\n<pre><code>class Merchant &lt; ActiveRecord::Base\n    belongs_to :billing_address, class_name: Address, dependent: :destroy\n    belongs_to :other_address1, class_name: Address, dependent: :destroy\n    belongs_to :other_address2, class_name: Address, dependent: :destroy\n    belongs_to :other_address3, class_name: Address, dependent: :destroy\n    belongs_to :other_address4, class_name: Address, dependent: :destroy\n    ...\nend\n</code></pre>\n\n<p><code>Address</code> has no associations. </p>\n\n<p>When I do this:</p>\n\n<pre><code>merchant.billing_address.destroy\n</code></pre>\n\n<p>In the database, the address record is gone, but <code>merchants.billing_address_id</code> keeps a bogus value.  This is mysql, so no referential integrity.</p>\n\n<p>What am I doing wrong?  </p>\n\n<p>NOTE: I realize this might be better modeled as a <code>has_one</code> association. I might have to go there, but I prefer not to.</p>\n\n<p>UPDATE: Added a little more code to show the multiple Address associations.</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","activerecord","active-relation"],"answer_count":4,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":276,"score":3,"question_id":6067327,"title":"Rails 3: How to get all Posts which ids are not in a given list?","body":"<p>To get all posts with <code>publisher_id</code> equals to 10, 16, or 17, I do:</p>\n\n<pre><code>Post.where(:publisher_id =&gt; [10, 16, 17])\n</code></pre>\n\n<p>How would I get all posts with <code>publisher_id</code> <strong>not equals</strong> to 10, 16, or 17 (i.e. all possible ids besides those three) ?</p>\n"},{"tags":["ruby-on-rails-3","copyright-display"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":163,"score":0,"question_id":5244135,"title":"Give copyright in Ruby on Rails files","body":"<p>I want provide to copyright notice at start of files in my Ruby on Rails project. <strong>Can I give copyright notice in all Ruby on Rails files including auto generated files like application.rb, routes.rb. ?</strong></p>\n"},{"tags":["ruby-on-rails-3","rails-3-upgrade","acts-as-audited"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":36,"score":0,"question_id":12787656,"title":"When using Audit in Rails 3, I get \"uninitialized constant User::Audit\"","body":"<p>I was using acts_as_audited in my Rails 2 app and am in the process of updating it to Rails 3. I have updated a couple of models to call <code>audited</code> instead of <code>acts_as_audited</code> and those seem to work successfully. However, I am updating the User model of my app now and when I try to create a User (either from the console or from the app), I get the following error:</p>\n\n<pre><code>uninitialized constant User::Audit\n</code></pre>\n\n<p>The trace down the where it seems relevant is:</p>\n\n<pre><code>activerecord (3.2.8) lib/active_record/inheritance.rb:111:in `compute_type'\nactiverecord (3.2.8) lib/active_record/reflection.rb:172:in `klass'\nactiverecord (3.2.8) lib/active_record/associations/collection_association.rb:148:in `transaction'\nactiverecord (3.2.8) lib/active_record/associations/collection_association.rb:431:in `create_record'\nactiverecord (3.2.8) lib/active_record/associations/collection_association.rb:119:in `create'\nactiverecord (3.2.8) lib/active_record/associations/collection_proxy.rb:46:in `create'\naudited (3.0.0) lib/audited/auditor.rb:216:in `block in write_audit'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:403:in `_run__3460157709255055264__audit__3867610640799995319__callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_audit_callbacks'\nactivesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'\naudited (3.0.0) lib/audited/auditor.rb:216:in `write_audit'\naudited (3.0.0) lib/audited/auditor.rb:198:in `audit_create'\n</code></pre>\n\n<p>The line that creates the issue in my controller simply states:</p>\n\n<pre><code>if @editing_user.save\n</code></pre>\n\n<p>I've looked through the support list of audited's github account and can't find anything that fits my issue. I thought I'd ask here to see if someone has had a similar issue. I've also searched here and google to find an answer to this specific question but can't find anything relevant.</p>\n\n<p>Any ideas?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","heroku","scss"],"answer_count":3,"favorite_count":0,"up_vote_count":3,"down_vote_count":0,"view_count":467,"score":3,"question_id":10473403,"title":"Import SCSS files from parent directory on Heroku Cedar","body":"<p>I'm trying to deploy a Rails 3.1 app I was working on locally. But once deployed to Heroku (Cedar stack), I encounter an issue I wasn't having locally, and I can't find any solution to this.</p>\n\n<p>Actually, in some of my SCSS files, I import other SCSS files located in the parent directory. Among the several syntaxes I tried :</p>\n\n<pre><code> @import \"file.css.scss\";\n @import \"file\";\n @import \"/file.css.scss\";\n @import \"/file\";\n @import \"../file.css.scss\";\n @import \"../file\";\n</code></pre>\n\n<p>Most of these work locally, but none work on my heroku Cedar app. I also tried renaming my imported file into \"_file.css.scss\" with an underscore, as it seems it's the standard format for SCSS files made to be imported. But didn't change anything.</p>\n\n<p>The error heroku logs are giving me is :\n<code>ActionView::Template::Error (File to import not found or unreadable: /mixins.css.scss.</code> </p>\n\n<p>I'm getting out of ideas right now, so would be thankful if you had any clues to solve this.</p>\n\n<p>Thanks a lot,\nCheers !</p>\n"},{"tags":["ruby-on-rails-3","forms"],"answer_count":0,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":22,"score":0,"question_id":12851876,"title":"Is there a better datetime form solution for very early historical dates?","body":"<p>In rails built site I have a form that has:</p>\n\n<pre><code>&lt;%= f.datetime_select :startTime %&gt;\n</code></pre>\n\n<p>This presents itself as 5 select drop-down menus on the site. </p>\n\n<p>The first drop-down is for the year, and is limited between 2007 and 2017 (5 years in either direction of the current year).\nThe second is the Month.\nThe third is the year.\nThe forth is the hour, and fifth is the minutes.</p>\n\n<p>This is stored in the dabase like this: <strong>2000-01-01 12:01:01.000000</strong></p>\n\n<p>What I really need is something that is not so limiting with the years. I need to somehow be able to record a date that may be as far back as -9999 B.C. and possibly farther. (Its for a site that records significant historical events, like for instance the building of the pyramids). </p>\n\n<p>However, the dates need to be searchable as well.</p>\n\n<p>I think in this instance it might be a better user experience for the user to type the year in a textfield rather than scroll through 20,000 or more years in a drop-down.</p>\n\n<p>I'm not concerned with hours, minutes or seconds, and those can be scrapped entirely.</p>\n\n<p>Ideally it would be perfect if a user could just type -5679 for a B.C. year or 1492 for a A.D. year, and then select the month and date from the drop downs.</p>\n\n<p>Is there a way this might be possible?</p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","validation"],"answer_count":2,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":147,"score":0,"question_id":12770018,"title":"Ruby on Rails: How to validate nested attributes on certain condition?","body":"<p>I have these models:</p>\n\n<pre><code>class Organisation &lt; ActiveRecord::Base\n\n  has_many    :people\n  has_one     :address, :as         =&gt; :addressable,\n                        :dependent  =&gt; :destroy\n  accepts_nested_attributes_for :address, :allow_destroy =&gt; true\n\nend\n\nclass Person &lt; ActiveRecord::Base\n\n  attr_accessible :first_name, :last_name, :email, :organisation_id, :address_attributes\n\n  belongs_to  :user\n  belongs_to  :organisation\n  has_one     :address, :as         =&gt; :addressable,\n                        :dependent  =&gt; :destroy\n  accepts_nested_attributes_for :address, :allow_destroy =&gt; true\n\n  # These two methods seem to have no effect at all!\n  validates_presence_of :organisation,  :unless =&gt; \"address.present?\"\n  validates_associated  :address,       :unless =&gt; \"organisation.present?\"\n\nend\n\nclass Address &lt; ActiveRecord::Base\n\n  belongs_to :addressable, :polymorphic =&gt; true\n\n  validates_presence_of :line1, :line2, :city, :zip\n\nend\n</code></pre>\n\n<p>...and these views:</p>\n\n<p><strong>_fields.html.erb</strong>:</p>\n\n<pre><code>&lt;%= render 'shared/error_messages', :object =&gt; f.object %&gt;\n&lt;fieldset&gt;\n&lt;div class=\"left\"&gt;\n    &lt;%= f.label :first_name %&gt;&lt;br/&gt;\n    &lt;%= f.text_field :first_name %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;%= f.label :last_name %&gt;&lt;br/&gt;\n    &lt;%= f.text_field :last_name %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;%= f.label :email %&gt;&lt;br/&gt;\n    &lt;%= f.text_field :email %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;%= f.label :organisation_id %&gt;&lt;br/&gt;\n    &lt;%= f.select(:organisation_id, current_user.organisation_names, {:include_blank =&gt; \"--- None ---\"}, :id =&gt; 'organisation_select') %&gt;\n&lt;/div&gt;\n&lt;/fieldset&gt;\n\n&lt;%= f.fields_for :address do |address| %&gt;\n  &lt;%= render 'shared/address', :f =&gt; address %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p><strong>_address.html.erb:</strong></p>\n\n<pre><code>&lt;fieldset id=\"address_fields\"&gt;\n&lt;div&gt;\n    &lt;%= f.label :line1 %&gt;\n    &lt;%= f.text_field :line1 %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;%= f.label :line2 %&gt;\n    &lt;%= f.text_field :line2 %&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;%= f.label :zip %&gt;\n    &lt;%= f.text_field :zip %&gt;\n&lt;/div&gt;  \n&lt;div&gt;\n    &lt;%= f.label :city %&gt;\n    &lt;%= f.text_field :city %&gt;\n&lt;/div&gt;  \n&lt;/fieldset&gt;\n</code></pre>\n\n<p><strong>people_controller.rb</strong>:</p>\n\n<pre><code>def new\n  puts params.inspect\n  @person = Person.new(:organisation_id =&gt; params[:organisation_id])\n  @person.build_address\n  @title = \"New person\"\nend\n\n{\"action\"=&gt;\"new\", \"controller\"=&gt;\"people\"}\n\ndef edit\n  puts params.inspect\n  @title = @person.name\nend\n\n{\"action\"=&gt;\"edit\", \"id\"=&gt;\"69\", \"controller\"=&gt;\"people\"}\n\ndef create\n  puts params.inspect\n  if params[:organisation_id]\n    @person = current_user.organisations.build_person(params[:person])\n  else\n    @person = current_user.people.build(params[:person])\n  end\n  if @person.save\n    flash[:success] = \"Person created.\"\n    redirect_to people_path\n  else\n    render :action =&gt; \"new\"\n  end\nend\n\n{\"commit\"=&gt;\"Create\", \"action\"=&gt;\"create\", \"person\"=&gt;{\"last_name\"=&gt;\"Doe\", \"organisation_id\"=&gt;\"9\", \"email\"=&gt;\"john.doe@email.com\", \"first_name\"=&gt;\"John\", \"address_attributes\"=&gt;{\"city\"=&gt;\"Chicago\", \"zip\"=&gt;\"12345\", \"line2\"=&gt;\"Apt 1\", \"line1\"=&gt;\"1 Main Street\"}}, \"authenticity_token\"=&gt;\"Jp3XVLbA3X1SOigPezYFfEol0FGjcMHRTy6jQeM1OuI=\", \"controller\"=&gt;\"people\", \"utf8\"=&gt;\"✓\"}\n</code></pre>\n\n<p>Inside my <code>Person</code> model I need to make sure that only if a person's <code>organisation_id</code> is blank, that person's address fields have to be present.</p>\n\n<p>I tried something like this:</p>\n\n<pre><code>validates :address, :presence =&gt; true, :if =&gt; \"organisation_id.blank?\"\n</code></pre>\n\n<p>But it's not working.</p>\n\n<p>How can this be done?</p>\n\n<p>Thanks for any help.</p>\n"},{"tags":["ruby-on-rails-3","post","https","xmlhttprequest","httpresponse"],"answer_count":1,"favorite_count":0,"up_vote_count":0,"down_vote_count":0,"view_count":62,"score":0,"question_id":12844277,"title":"getting bad request from ruby on rails ssl post","body":"<p>Looked at: <a href=\"http://stackoverflow.com/questions/6903748/escaping-parameters-in-set-form-data-post\">Escaping parameters in set_form_data POST</a>, and <a href=\"http://stackoverflow.com/questions/1719809/ruby-on-rails-https-post-bad-request\">Ruby on Rails HTTPS Post Bad Request</a></p>\n\n<pre><code>  def send_request(params)\n     host = \"https://hc.mercurydev.net\"\n     uri = URI.parse(host)\n     http = Net::HTTP.new(uri.host, uri.port)\n     http.use_ssl = true\n     http.verify_mode = OpenSSL::SSL::VERIFY_NONE\n\n     xml = build_xml_for_checkout(params)\n\n\n     http.start do |http|\n        req = Net::HTTP::Post.new('http://www.mercurypay.com/InitializePayment')\n        header = {'Host' =&gt; 'hc.mercurydev.net',  'Content-Type' =&gt;  'text/xml; charset=utf-8', 'Content-Length' =&gt; 'length', 'SOAPAction' =&gt; 'http://www.mercurypay.com/InitializePayment'}\n        req.set_form_data(header, xml)\n        response = http.request(req)\n\n     end\n  end\n</code></pre>\n\n<p>This is the first time I have had to build my own post request in ruby, I am sure that I am missing something simple, but what?</p>\n\n<p>-- I have confirmation that the xml is 100% good, so it has to be something in my header or in how I'm building the request. </p>\n\n<p><strong>Edit:</strong> After looking at <a href=\"http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html\" rel=\"nofollow\">ruby-api-doc</a>: I came up with this:</p>\n\n<pre><code>uri = URI.parse(host)\n\nNet::HTTP.start(uri.hostname, uri.port,\n      :use_ssl =&gt; uri.scheme == 'https').start do |http|\n\n  req = Net::HTTP::Post.new uri.path\n  req.body = xml\n  req.set_form_data(header)\n\n res =  http.request req\nend\n</code></pre>\n\n<p>Which returns (even if I restart my server) that I have an open HTTP session. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","activerecord"],"answer_count":2,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":35,"score":1,"question_id":12859893,"title":"What ruby construct allows as to do user.articles.create (...) where \"articles\" returns an array and create is called on association object?","body":"<p>I'm seeing the above on rails and doesn't feel natural to me. </p>\n"},{"tags":["ruby-on-rails","ruby","ruby-on-rails-3","gem"],"answer_count":1,"favorite_count":0,"up_vote_count":1,"down_vote_count":0,"view_count":62,"score":1,"question_id":11301000,"title":"Why use GemSpec + GemFile when checking for dependencies?","body":"<p>Whenever developing gems, I don't see any reasons why Gemfile is not directly inspected for dependencies.</p>\n\n<p>Indeed, why use a <code>.gemspec</code> file in order to list them ? Is there a real benefit ?</p>\n"},{"tags":["ruby-on-rails","ruby-on-rails-3","sass","ruby-on-rails-3.1"],"answer_count":3,"favorite_count":2,"up_vote_count":6,"down_vote_count":0,"view_count":1468,"score":6,"question_id":6091865,"title":"'sass' in a non thread-safe way","body":"<p>I'm getting these <em>warnings</em> when trying to use <em>sass</em> in Rails 3.1 rc1.</p>\n\n<pre><code>WARN: tilt autoloading 'sass' in a non thread-safe way; explicit require 'sass' suggested.\nWARN: tilt autoloading 'sass/plugin' in a non thread-safe way; explicit require 'sass/plugin' suggested.\n</code></pre>\n\n<p>This is my Gemfile.</p>\n\n<pre><code>gem \"rails\", \"~&gt; 3.1.0.rc1\"\ngem \"haml\"\ngem \"sass\"\n</code></pre>\n\n<p>I've tried to create a file called <code>sass.rb</code> inside the <code>config/initializers</code> containing this code.</p>\n\n<pre><code>require \"sass\"\n</code></pre>\n\n<p>Changing the Gemfile to this.</p>\n\n<pre><code>gem \"rails\", \"~&gt; 3.1.0.rc1\"\ngem \"haml\"\ngem \"sass\", require: false\n</code></pre>\n\n<p>But the warnings remains.\nAnyone knows how to solve it?</p>\n\n<p>I found <a href=\"https://github.com/tenderlove/tilt/blob/master/lib/tilt.rb#L155\">the code</a> that is printing the warnings, if that is to any help.</p>\n"}]}
